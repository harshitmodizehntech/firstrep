'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[15],{1571:function(y,C,a){a.d(C,"a",function(){return d});y=a(0);var c=a(80);class b{constructor(e,h,n){this.slideId=e;this.shapes=h;this.sn=n}}Object(y.a)(b,"SerializablePresenceData",null,[]);class d{constructor(e,h,n=0){if(!d.isValid(e))throw Error.create("Invalid Presence Data");this.GL=e;this.vTh=h;this.Bhm=n?n:++d.E6m}get Pw(){return this.GL}get OUa(){return this.vTh}toString(){return this.GL.toString()+" : "+
(this.OUa&&this.OUa.length?this.OUa[0].toString():"")+" : "+this.Bhm}eqj(){return new b(this.GL.Bpc,this.vTh,this.Bhm)}static isValid(e){return!!e}static kIh(e){return new d(new c.a(e.slideId),e.shapes,e.sn)}}d.E6m=0;Object(y.a)(d,"PresenceData",null,[])},1901:function(y,C,a){a.r(C);y=a(0);var c=a(50),b=a(232);const d=()=>c.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),e=()=>c.a.instance.eb("Common.ICoauthoringTelemeryInfoProvider"),h=()=>c.a.instance.eb("Common.IPeopleInfoProvider");
class n{constructor(Eb,jc){this.lhd=null;this.rab=()=>{n.URl(this.lhd.IXd())&&(this.lhd.PZk(this.rab),this.lQm.IsRealCoauthSession=!0)};this.Zof=Eb;this.lQm=jc}init(){this.Zof.continueWith(()=>{this.lhd=this.Zof.result;this.lhd.CTe(this.rab)})}static URl(Eb){let jc=null;for(const ea of Eb)if(ea)if(Eb=ea.isAnonymous||!ea.email?ea.clientId:ea.email.toUpperCase(),!jc)jc=Eb;else if(jc!==Eb)return!0;return!1}}Object(y.a)(n,"CoauthTelemetry",null,[1169]);var m=a(405),k=a(1187),l=a(1703),u=a(41),r;(function(Eb){Eb[Eb.yvo=
0]="badStatePreventedTelemetry";Eb[Eb.notImplemented=1]="notImplemented";Eb[Eb.Eyo=2]="renderHandled";Eb[Eb.Fyo=3]="renderHandledWithVeto"})(r||(r={}));Object(y.b)("CoauthorGalleryTelemetryEndResult",r);var x=a(118),v=a(17),z=a(1502),A=a(3);class B{constructor(Eb,jc,ea,ua,Da,Cb,Nb,fc,fb){this.OMl=this.hJl=this.Jva=null;this.VVh=()=>{this.rab()};this.m_g=()=>{const Ub=this.QM.vh("AppInitStatus_interactivityReady");m.ULS.shipAssertTag(42259235,325,!!this.cFh);const Ec=this.cFh-Ub,Lc={};Lc.InteractiveTime=
Ub;Lc.ReactRenderComplete=this.cFh;Lc.HadTabSwitch=this.Xvd();Lc.IsModernGallery=this.Ghd;m.ULS.sendTraceTag(594883104,325,20,v.a.toJSON(Lc));this.Ghd?(m.ULS.sendTraceTag(42062997,325,15,Ec.toString()),this.XEh.EY(this.loo(Ec)?3:2)):m.ULS.sendTraceTag(594883103,325,15,Ec.toString())};this.peb=Eb;this.XEh=new k.a;this.Ga=ea;this.W8h=jc;this.Aga=ua;this.QM=Da;this.Bhi=Cb;this.ehd=Nb;this.cMm=fc;this.DKl=this.CKl=!1;this.cFh=0;this.fJl=1;this.Xvd=fb;this.Ghd=this.Ga.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled");
this.hgd=Object(l.a)(String,u.AFrameworkApplication.rd.Application)||""}get yBm(){return this.XEh.task}init(){A.Task.WAA.call(null,this.ehd,this.W8h,this.Bhi).continueWith(()=>{this.Jva=this.ehd.result;this.hJl=this.W8h.result;this.OMl=this.Bhi.result;A.Task.WAA.call(null,this.W8h.result.rfb,this.Bhi.result.l1h).continueWith(()=>{this.fJl=this.hJl.rfb.result;this.cFh=this.OMl.l1h.result;this.Jva.CTe(this.VVh);this.Jva.IXd().length&&this.rab()})})}rab(){this.cMm(this.Jva.IXd())?(this.Jva.PZk(this.VVh),
this.JRn(this.CKl)):this.XEh.EY(1);this.CKl=!0}JRn(Eb){this.DKl?this.yBm.continueWith(()=>{m.ULS.sendTraceTag(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",r[this.yBm.result])}):(this.DKl=!0,this.S1n(0===this.fJl&&!Eb))}S1n(Eb){Eb?this.Aga.Ai(4,this.m_g):this.XEh.EY(1)}loo(Eb){const jc=Eb>this.Ga.Ac("CoauthorGalleryTimeToRenderDurationMs",1E4);var ea="Word"===this.hgd;const ua="PowerPoint"===this.hgd;if(this.Xvd())return m.ULS.sendTraceTag(50455714,325,50,jc.toString()),
!1;ea&&x.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",z.b.FailureBased,"wordcollabrel",null);jc&&(ea&&x.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded","CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),ea=u.AFrameworkApplication.ha.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTClientCoauthorGalleryRenderLatencyQoSError"),ua&&ea&&Eb<this.Ga.Ac("CoauthorGalleryTimeToRenderCutoffThresholdMs",3E4)&&x.Health.instance.recordQosError("CoauthorGalleryTimeToRenderDurationIsTooLong",
["CoauthGalleryExperienceDegraded"],!1,!0,!0,!1,null),m.ULS.sendTraceTag(42062998,325,15,Eb.toString()));return jc}}Object(y.a)(B,"CoauthorGalleryTelemetry",null,[1167]);class G{constructor(Eb){this.Jva=null;this.HCh={};this.sEh={};this.Kif=null;this.rab=()=>{this.yEm()};this.U1m=(jc,ea)=>jc.W2b>ea.W2b?1:jc.W2b<ea.W2b?-1:0;this.ehd=Eb}ZLh(Eb){const jc=new k.a;this.init().continueWith(()=>{Eb in this.HCh?jc.EY(this.HCh[Eb]):this.sEh[Eb]=jc});return jc.task}init(){if(this.Kif)return this.Kif.task;this.Kif=
new k.a;this.ehd.continueWith(()=>{this.Jva=this.ehd.result;this.Jva.CTe(this.rab);this.yEm();this.Kif.lj(null)});return this.Kif.task}yEm(){const Eb=this.Jva.IXd();Eb.sort(this.U1m);this.HCh={};for(let jc=0;jc<Eb.length&&Eb[jc]&&Eb[jc].W2b;jc++)this.iUm(this.HCh,Eb[jc].clientId,jc)}iUm(Eb,jc,ea){Eb[jc]=ea;jc in this.sEh&&(this.sEh[jc].EY(ea),delete this.sEh[jc])}}Object(y.a)(G,"CoauthorPositionFinder",null,[1168]);var w=a(35),F=a(36),H=a(1707),E=a(21),P=a(132);class T{constructor(){this.dXa=null;
this.scf=Array(32)}xor(Eb){if(!Eb)throw Error.argumentNull("Guid argument cannot be null");const jc=new T,ea=new Sys.StringBuilder;for(let ua=0;ua<Eb.scf.length;ua++){const Da=this.scf[ua]^Eb.scf[ua];jc.scf[ua]=Da;ea.append(Da.toString(16));7!==ua&&11!==ua&&15!==ua&&19!==ua||ea.append("-")}jc.dXa=P.a.Vf(ea.toString());return jc}toString(){return this.dXa.toString()}equals(Eb){if(!Eb)throw Error.argumentNull("Guid argument cannot be null");return this.dXa.equals(Eb.dXa)}static fromString(Eb){if(!Eb)throw Error.argumentNull("String input cannot be null");
const jc=new T;jc.dXa=P.a.Vf(Eb);const ea=jc.dXa.toString();let ua=0;for(let Cb=0;Cb<ea.length;Cb++){var Da=Eb.charAt(Cb);if(T.oxn(Da))Da=T.Lqn(Da,Eb.charCodeAt(Cb)),jc.scf[ua++]=Da;else if(!T.ixn(Da))throw Error.argument("String contains characters not valid in Guids");}return jc}static oxn(Eb){return"0"<=Eb&&"9">=Eb||"A"<=Eb&&"F">=Eb||"a"<=Eb&&"f">=Eb}static ixn(Eb){return"{"===Eb||"}"===Eb||"-"===Eb}static Lqn(Eb,jc){if("0"<=Eb&&"9">=Eb)return jc-48;if("A"<=Eb&&"F">=Eb)return jc-65+10;if("a"<=
Eb&&"f">=Eb)return jc-97+10;throw Error.argument("Char is not valid hex digit");}}Object(y.a)(T,"Guid",null,[]);var K=a(204);class M{constructor(Eb,jc,ea,ua){this.lhd=null;this.vJl=this.nMl=!1;this.FLl=0;this.rab=()=>{this.F1m(this.lhd.IXd())};this.Zof=Eb;this.Dli=jc;this.Ga=ea;this.Ufi=ua;this.WLm=u.AFrameworkApplication.RLb||u.AFrameworkApplication.WS;this.PLl=new w.a(F.a.Co())}get oWi(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1)}init(){this.Zof.continueWith(()=>
{this.lhd=this.Zof.result;this.lhd.CTe(this.rab)})}F1m(Eb){var jc=0;const ea=new H.a(F.a.Co());for(const ua of Eb)if(ua&&ua.isAnonymous){K.a.DH("70eb6120;2gfeb930");if(ea.Sb(ua.userName))ea.ka(ua.userName).add(ua.clientId);else{let Da;ea.add(ua.userName,(Da=new E.a,Da.add(ua.clientId),Da))}ua.clientId!==this.Ufi?(jc++,2<=jc&&!this.nMl&&this.dCn()):!this.vJl&&this.oWi&&"Guest"===ua.userName&&(m.ULS.sendTraceTag(509726851,302,50,"User was assigned 'Guest' name"),this.vJl=!0)}if(this.oWi&&this.FLl!==
jc){m.ULS.sendTraceTag(512553562,302,50,"Total guests updated to: {0}",jc+(this.WLm?1:0));this.FLl=jc;for(const ua of ea.keys)2<=ea.ka(ua).count&&(Eb=this.Agn(ea.ka(ua)),this.PLl.contains(Eb)||(jc={},jc.guestsWithSameName=ea.ka(ua).count,jc.identifier=Eb,m.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected: {0}",jc),this.PLl.add(Eb)))}}dCn(){m.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.nMl=!0;this.oWi&&this.Dli&&this.Dli.continueWith(()=>
{window.setTimeout(()=>{this.Dli.result.logActivity("MultipleGuestsCoauthoring",null)},15E3)})}Agn(Eb){if(!Eb||1>=Eb.count)return"";let jc=T.fromString(Eb.ka(0));for(let ea=1;ea<Eb.count;ea++)jc=jc.xor(T.fromString(Eb.ka(ea)));return jc.toString()}}Object(y.a)(M,"GuestCoauthTelemetry",null,[]);var N=a(38);class I{constructor(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}}Object(y.a)(I,"PL",null,[]);var O=a(15);class Q{constructor(){this.ct=this.vt=this.d=0}static zxm(Eb,
jc,ea){const ua=new Q;ua.d=Eb;ua.vt=jc;ua.ct=ea;return O.c(ua)}}Object(y.a)(Q,"VD",null,[]);class U{constructor(Eb,jc,ea,ua,Da,Cb,Nb,fc,fb){this.$l=0;this.NNl=!1;this._id=Eb;this.fOl=jc;this.yx=ea;this.Vfi=ua;this.pmi=Da;this.vId=Cb;this.pxd=Nb;this.GMm=fc;this.Xvd=fb;this.hgd=Object(l.a)(String,u.AFrameworkApplication.rd.Application)||""}qQe(Eb){A.Task.WAA(this.fOl,this.Vfi,this.pmi).continueWith(()=>{if(this.Vfi.result<=this.pmi.result)Eb.EY(!1);else{this.$l=this.fOl.result;var jc=this.yx-this.$l,
ea=new I;ea.id=this._id;ea.et=this.yx;ea.st=this.$l;ea.d=this.yx-this.$l;ea.mp=this.Vfi.result;ea.tp=this.pmi.result;ea.ct=this.Yen(this.GMm);ea.vc=this.Xvd();var ua=O.c(ea),Da="Word"===this.hgd,Cb="PowerPoint"===this.hgd;m.ULS.sendTraceTag(42078597,302,15,ua);if(Da){const Nb=new Map;Nb.set("data",ua);x.Health.instance.recordKpiUsage("PresenceExperienceDegraded",z.b.FailureBased,"wordcollabrel",Nb)}jc>this.vId.value&&!this.NNl&&!ea.vc&&(this.NNl=!0,Eb.EY(!0),ea={inStaging:!0,extendedProperties:new Map},
ea.extendedProperties.set("data",ua),Da&&x.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,ea),jc<this.pxd.value&&(m.ULS.sendTraceTag(42078598,302,15,Q.zxm(jc,this.vId.value,this.pxd.value)),jc=u.AFrameworkApplication.ha.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTClientThumbnailPresenceRenderLatencyQoSError"),Cb&&jc&&(ea.inStaging=!1,x.Health.instance.recordQosError("PresenceRenderDurationIsTooLong",["PresenceExperienceDegraded"],
!1,!0,!0,!1,ea))));Eb.task.isCompleted||Eb.EY(!1)}})}Yen(Eb){switch(Eb){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}}Object(y.a)(U,"PresenceLatencyActivityLogger",null,[]);class ba{constructor(Eb,jc,ea){this.$Il=this.eJl=this.FCh=this.GCh=this.ERe=0;this._id=Eb;this.vId=jc;this.pxd=ea;this.hgd=Object(l.a)(String,u.AFrameworkApplication.rd.Application)||""}get dRl(){return this.ERe}set dRl(Eb){this.ERe=Eb;this.JHi()}get LUl(){return this.GCh}set LUl(Eb){this.GCh=
Eb;this.JHi()}get ITl(){return this.FCh}set ITl(Eb){this.FCh=Eb;this.JHi()}get MUl(){return 0!==this.eJl}get JTl(){return 0!==this.$Il}JHi(){!this.MUl&&this.ERe&&this.GCh&&(this.eJl=this.qQe(this.GCh,"CoauthGalleryLightupDurationTooLong"));!this.JTl&&this.ERe&&this.FCh&&(this.$Il=this.qQe(this.FCh,"CanvasPresenceLightupDurationTooLong"))}qQe(Eb,jc){const ea=Eb-this.ERe;var ua=new I;ua.id=this._id;ua.et=Eb;ua.st=this.ERe;ua.d=ea;var Da=O.c(ua);Eb="Word"===this.hgd;ua="CanvasPresenceLightupDurationTooLong"===
jc?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===jc?m.ULS.sendTraceTag(572289499,302,15,Da):m.ULS.sendTraceTag(571524118,302,15,Da);if(Eb){var Cb=new Map;Cb.set("data",Da);x.Health.instance.recordKpiUsage(ua,z.b.FailureBased,"wordcollabrel",Cb)}return ea>this.vId.value?(Cb=Object.assign({},{inStaging:!0,extendedProperties:new Map}),Cb.extendedProperties.set("data",Da),Da=ea<this.pxd.value,Cb.extendedProperties.set("cash",Da?"true":"false"),
Eb&&x.Health.instance.recordKpiFailure(ua,jc,!1,!0,Cb),m.ULS.sendTraceTag(572289500,302,15,Q.zxm(ea,this.vId.value,this.pxd.value)),Da?2:1):3}}Object(y.a)(ba,"PresenceLightupLatencyLogger",null,[]);class aa{constructor(Eb,jc,ea,ua,Da,Cb,Nb,fc=null,fb=null,Ub=null){this.dNl={};this.U8h={};this.pLl=new E.a;this.wCh=this.Lif=this.Jva=this.FEh=null;this.eOl=this.dOl=0;this.MTn=(Ec,Lc)=>{if(!this.PIl&&2===Lc.newState){var vb=this.g3l();vb.continueWith(()=>{var ec=vb.result;ec=Date.now()-ec;const lb={};
lb.clientId=this.Vjm;lb.bootTime=ec;this.PIl=!0;this.FEh.qDb(15,lb)})}};this.IQn=(Ec,Lc)=>{if(15===Lc.type){Ec=Date.now();Lc=Lc.tpc;var vb=Lc.bootTime;this.Akj(Lc.clientId).dRl=Ec-vb}};this.VVh=()=>{this.rab()};this.vId=new N.a(()=>fc.F7("PresenceBootLatencyThreshold",1E4));this.pxd=new N.a(()=>fc.F7("PresenceBootLatencyCutoffThreshold",6E4));this.xSm=new N.a(()=>fc.F7("PresenceLightupLatencyThreshold",2E3));this.dNm=new N.a(()=>fc.F7("PresenceLightupLatencyCutoffThreshold",1E4));this.Aga=ua;this.nQm=
Da;this.gJl=Eb;this.zNl=jc;this.ehd=ea;this.QM=Cb;this.Ufi=fb;this.Xvd=Nb;this.EKl=Ub;this.PIl=!1;this.init()}h$m(Eb,jc=0){var ea=new Date;const ua=new k.a;this.init().continueWith(()=>{this.nTn(Eb);this.i$m(ua,Eb,ea,jc)})}get Vjm(){return this.Ufi||"{"+u.AFrameworkApplication.userSessionId+"}"}init(){if(this.Lif)return this.Lif.task;this.Lif=new k.a;this.Xvd()&&m.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.gJl.continueWith(()=>{const Eb=this.gJl.result,jc=Eb.rfb,ea=Eb.m1e;ea.continueWith(()=>
{jc.continueWith(()=>{this.EKl&&this.EKl.addQosPillar("RealTimeCoauth");this.Qgo(jc.result,ea.result);this.Lif.lj(null)})})});this.zNl.continueWith(()=>{this.FEh=this.zNl.result;this.FEh.SJd(this.MTn);this.FEh.Myc(this.IQn)});this.ehd.continueWith(()=>{this.Jva=this.ehd.result;this.Jva.CTe(this.VVh);0<this.Jva.IXd().length&&this.rab()});return this.Lif.task}g3l(){this.wCh||(this.wCh=new k.a,this.Aga.Ai(4,()=>{this.wCh.EY(this.QM.vh("AppInitStatus_interactivityReady"))}));return this.wCh.task}rab(){const Eb=
Date.now();var jc=this.Jva.IXd();const ea=new E.a;for(const ua of jc)this.pLl.contains(ua.clientId)||(this.pLl.add(ua.clientId),ea.add(ua.clientId));if(0<ea.count)for(const ua of ea)jc=this.Akj(ua),jc.MUl||(jc.LUl=Eb)}nTn(Eb){Eb=this.Akj(Eb);Eb.JTl||(Eb.ITl=Date.now())}Akj(Eb){return Eb in this.U8h?this.U8h[Eb]:this.U8h[Eb]=new ba(Eb,this.xSm,this.dNm)}Qgo(Eb,jc=0){this.dOl=Eb;this.eOl=jc?jc:(new Date).getTime()}i$m(Eb,jc,ea,ua){ea=ea?ea.getTime():(new Date).getTime();jc in this.dNl?Eb.Mea():(ua=
new U(jc,this.Nln(),ea,this.ZLh(this.Vjm),this.ZLh(jc),this.vId,this.pxd,ua,this.Xvd),this.dNl[jc]=ua,ua.qQe(Eb))}Nln(){return 1===this.dOl?A.Task.zG(this.eOl):this.g3l()}ZLh(Eb){return this.nQm.ZLh(Eb)}}Object(y.a)(aa,"PresenceBootTelemetry",null,[1164]);var La=a(178),Z=a(95),la=a(288),da=a(298),J=a(407),Ca=a(363);class Fa{get name(){return"Common.App.CoauthTelemetry"}oc(Eb){Eb.register(n,"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").oa().pa(()=>
new n(Ca.a.kH(h()),u.AFrameworkApplication.Ng));Eb.register(B,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").oa().pa(()=>new B(u.AFrameworkApplication.ub,Ca.a.kH(e()),u.AFrameworkApplication.ha,La.a.get_instance(),da.a.instance,Ca.a.kH(c.a.instance.eb("Common.IPeoplesWell")),Ca.a.kH(h()),n.URl,()=>this.wSl()));Eb.register(aa,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").oa().pa(()=>new aa(Ca.a.kH(e()),
Ca.a.kH(c.a.instance.eb("Common.IRealtimeChannelBasic")),Ca.a.kH(h()),La.a.get_instance(),d(),da.a.instance,()=>this.wSl(),u.AFrameworkApplication.ha,null,x.Health.instance));Eb.register(G,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").oa().pa(()=>new G(Ca.a.kH(h())));Eb.register(M,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").oa().pa(()=>new M(Ca.a.kH(h()),Ca.a.kH(Object(b.a)()),u.AFrameworkApplication.ha,"{"+u.AFrameworkApplication.userSessionId+
"}"))}init(){u.AFrameworkApplication.ha.Wf(()=>{c.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();c.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();u.AFrameworkApplication.ha.getBooleanAppSetting("CoauthorGalleryTelemetryIsEnabled")&&c.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();u.AFrameworkApplication.ha.getBooleanAppSetting("CashTelemetryIsEnabled")&&(c.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),
d())})}dispose(){}wSl(){return J.a.wXa&&da.a.instance.nk(la.a.efd)?0<da.a.instance.vh(la.a.efd)[la.a.wQe]:!1}static main(){Z.a.instance.Jc(new Fa)}}Object(y.a)(Fa,"CoauthTelemetryPackage",null,[4,5]);var ya=a(315),Ua=a(10);class Ia{constructor(Eb,jc,ea,ua,Da){this.je=Eb;this._clientId=jc;this.oNm=Da;this.fOm=ea||(()=>null);this.gOm=ua||(()=>null)}get id(){return this.je.id}get Lhd(){return this.je.Lhd}get Phd(){return this.je.Phd}get Ohd(){return this.je.Ohd}get Nhd(){return this.je.Nhd}get Mhd(){return this.je.Mhd}get XId(){return this.je.XId}get hTe(){return this.je.hTe}get Lgc(){return this.je.Lgc}get VJe(){return this.je.VJe}get Yre(){return this.je.Yre}get clientId(){return this._clientId}get y_b(){return this.fOm}get A5a(){return this.gOm}get C8m(){return this.oNm}static createInstance(Eb,
jc,ea,ua,Da=!1){return new Ia(Eb,jc,ea,ua,Da)}}Object(y.a)(Ia,"PeoplesWellSettings",null,[]);var Oa=a(6),ma=a(40);class za{constructor(Eb){this.rq=Eb}get rfb(){return this.rq.rfb}get m1e(){return this.rq.m1e}}Object(y.a)(za,"CoauthoringTelemetryInfoProvider",null,[616]);var Qa=a(829),Xa=a(30),Tb=a(131),Kb=a(1189),nb=a(798),Ka=a(71);class Sb{constructor(Eb,jc,ea,ua,Da){this.c1e=new Xa.a;this.U5=null;this.rq=Eb;this.Yne=ea;this.Ofa=ua;this.Ofa.sxf(Object(Oa.a)(this,this.AVh,"onEditorTableUpdate"));
this.qEn=u.AFrameworkApplication.ha.getBooleanAppSetting(Ka.a.Hqd);this.zkk=Da;jc&&jc.execute(Cb=>{this.U5=Cb})}dispose(){this.c1e&&(Tb.a.k5e([this.c1e]),this.c1e=null);this.Ofa.jYh(Object(Oa.a)(this,this.AVh,"onEditorTableUpdate"))}CTe(Eb){this.c1e.addHandler("UsersUpdatedEvent",Eb)}PZk(Eb){this.c1e.removeHandler("UsersUpdatedEvent",Eb)}IXd(){return this.K1l(!1)}aen(){return this.K1l(!0)}K1l(Eb){const jc=[];this.rq.Idd(this.rq.CR).returnValue||ma.a.$(512497499,814,50,"PeopleInfoProvider::GetAllUsers - current editor({0}) missing in editortable",
this.rq.CR);var ea=null;this.U5&&(ea=this.U5.XKh());const ua=this.zkk.Chj();let Da=!1;for(const Cb of this.rq.B$)Eb&&Sb.zGh(ua,Cb.EmailAddress)?Da=!0:Array.add(jc,this.h5m(Cb,ea));ea={};ea.fExcludeCurrent=Eb;ea.fCurrentExcluded=Da;ea.CurrentID=this.rq.CR;ea.EditorCount=this.rq.B$.length;ea.IsRtcNull=!this.U5;ea.UserCount=jc.length;ma.a.$(512497498,814,50,"PeopleInfoProvider::GetAllUsers:{0}",O.c(ea));return jc}h5m(Eb,jc){const ea=this.Yne.z5a(new Qa.a(Eb.EmailAddress,void 0,Eb.Name),Eb.ID,1),ua=new Kb.a;
ua.p$c(0);let Da=0,Cb=!1,Nb=!1;if(jc&&Eb.ID in jc){ua.p$c(1);if(this.qEn){const fc=jc[Eb.ID];fc&&fc.capabilities&4&&ua.p$c(4);Cb=!0;fc&&(Da=fc.capabilities,Nb=fc.isAnonymous)}delete jc[Eb.ID]}ma.a.$(512497495,814,50,"PeopleInfoProvider::GetAllUsers; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities: {6}; fIssuserinrtc: {7}; isAnonymous: {8}",Eb.ID,ea,ua.jPa(1),ua.jPa(4),this.rq.CR,
!Eb.EmailAddress,Da,Cb,Nb);return new nb.a(Eb.ID,Eb.Name,ea,ua,null,Eb.EmailAddress,void 0,void 0,Nb,void 0,void 0,Eb.JoinCoauthTime)}AVh(){ma.a.$(512497494,814,50,"PeopleInfoProvider::OnEditorTableUpdate");this.c1e.raiseEvent("UsersUpdatedEvent",this)}static zGh(Eb,jc){return!!Eb&&!!jc&&Eb.toLowerCase()===jc.toLowerCase()}}Object(y.a)(Sb,"PeopleInfoProvider",null,[1186]);var ab=a(99),ub=a(240),Aa=a(156),tb=a(341),kc=a(291);class dc extends ub.a{constructor(){super();this.JoinTimeInMS=0;this.IsAnonymous=
!1;this.ImageUrl=null;this.CanJump=this.ActiveStatus=!1;this.CoauthorPresenceDescription=this.Upn=null}get ControlType(){return 5}}Object(y.a)(dc,"PeopleButtonProps",ub.a,[]);var Db=a(1192),sb=a(64),Qb=a(23);class $a{constructor(Eb){this.Rzh=new Qb.a;this.iWi=null;this.clientId=Eb}kco(Eb){this.G5n();this.nao(Eb);for(const jc of Eb)jc.clientId!==this.clientId&&this.xPl(jc)}get s2h(){const Eb=[];for(const jc of this.Rzh.values){const ea=this.exm(jc);Array.add(Eb,ea)}return Eb}get Ymc(){return this.Rzh.count}ksi(Eb,
jc){Eb=Eb.toUpperCase();let ea;({value:ea}=this.Rzh.Ph(Eb)).returnValue||(ea=[],this.Rzh.fa(Eb,ea));Array.add(ea,jc)}G5n(){this.Rzh=new Qb.a}nao(Eb){for(const jc of Eb)if(jc.clientId===this.clientId){this.iWi=jc;break}}}Object(y.a)($a,"UserTracker",null,[1903]);class X extends $a{constructor(Eb,jc){super(Eb);this.hOm=jc}xPl(Eb){Eb.isAnonymous||!Eb.email?this.ksi(Eb.clientId,Eb):this.iWi&&F.a.Co().equals(this.iWi.email,Eb.email)||this.ksi(Eb.email,Eb)}exm(Eb){let jc=new Date(0),ea=0<Eb.length?Eb[0]:
null;for(const ua of Eb)(Eb=this.hOm(ua.clientId))&&jc.getTime()<Eb.LZe.getTime()&&(jc=Eb.LZe,ea=ua);return ea}}Object(y.a)(X,"UniqueUserTracker",$a,[]);class Ta extends $a{constructor(Eb){super(Eb)}xPl(Eb){this.ksi(Eb.clientId,Eb)}exm(Eb){return Eb[0]}}Object(y.a)(Ta,"UserInstanceTracker",$a,[]);const ca=(Eb,jc,ea)=>ea?new X(Eb,jc):new Ta(Eb);var Ma=a(98),Ba=a(740),wa=a(57),pa=a(59);class ta{constructor(Eb,jc=null,ea=null){this.Jva=null;this.tmi=new k.a;this.JQn=(ua,Da,Cb,Nb,fc)=>{this.tmi.EY(fc.RenderTime);
return 32};this.je=Eb;this.wWh=jc;ea&&ea.continueWith(()=>{this.Jva=ea.result;this.Jva.CTe(Object(Oa.a)(this,this.rab,"onUsersUpdated"));this.VXh()});new nb.a(this.settings.clientId,"Anonymous user","#cccccc",new Kb.a(7));this.IRj=this.Pdi=!0;this.Gbi=this.Ahi=!1;this.geb=ca(this.settings.clientId,this.settings.A5a,Eb.C8m)}get settings(){return this.je}get Ewn(){return u.AFrameworkApplication.ha?u.AFrameworkApplication.ha.getBooleanAppSetting("ColorPresenceHashIsEnabled"):!1}get Cwn(){return u.AFrameworkApplication.ha?
u.AFrameworkApplication.ha.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled"):!1}zfn(){let Eb,jc,ea,ua;var Da=this.Afn();this.geb.Ymc?1===this.geb.Ymc?(Eb=!0,jc=this.settings.Lgc.cluster,ea=this.settings.Lgc.Tjd,ua=this.geb.s2h[0].color):(Eb=!0,jc=this.settings.Yre.cluster,ea=this.settings.Yre.Tjd,ua=""):(Eb=!1,ua=ea=jc="");const Cb=Da[0];Da=Da.slice(1);return{IVn:Cb,JVn:Da,EVn:Eb,dyo:jc,GVn:ea,FVn:ua}}Afn(){if(2<=this.geb.Ymc)return[String.format(Object(pa.a)("PeoplesWellStateNumberOfOtherPeopleEditingHere"),
this.geb.Ymc)];if(1===this.geb.Ymc){const Eb=this.geb.s2h[0],jc=this.settings.A5a(Eb.clientId);return jc&&2===jc.status?[Object(pa.a)("PeoplesWellStateUserIsInactive"),Eb.userName]:[Eb.isReadOnly?Object(pa.a)("PeoplesWellStateUserIsAlsoViewing"):Object(pa.a)("PeoplesWellStateUserIsAlsoEditing"),Eb.userName]}return[Object(pa.a)("PeoplesWellStateYouAreAllByYourself")]}onn(Eb){return this.pnn(Eb)}DTl(Eb,jc,ea){return jc?this.L_m(jc)?(Eb=this.settings.A5a(Eb))&&2===Eb.status?!1:!0:(ea&&m.ULS.sendTraceTag(4482394,
325,50,"User has presence data but app can't use it"),!1):(ea&&m.ULS.sendTraceTag(4482393,325,50,"User does not have any presence data"),!1)}Rln(Eb){return Eb.isReadOnly?Object(pa.a)("PeoplesWellUserStatusIsViewingOffline"):Object(pa.a)("PeoplesWellUserStatusLocationUnknown")}pnn(Eb){var jc,ea;if(!Eb.capabilities.jPa(1))return this.Rln(Eb);const ua=Eb.isReadOnly,Da=this.settings.A5a(Eb.clientId);Eb=this.settings.y_b(Eb.clientId);if(!Da)return Object(pa.a)("PeoplesWellUserStatusLocationUnknown");switch(Da.status){case 1:if(!Eb)return Object(pa.a)("PeoplesWellUserStatusLocationUnknown");
if(u.AFrameworkApplication.ha.isChangeGateEnabled("OfficeVSO:8350444_RealTimeViewPresenceState")){if(1!==(null===(ea=null===(jc=null===u.AFrameworkApplication||void 0===u.AFrameworkApplication?void 0:u.AFrameworkApplication.Ha)||void 0===jc?void 0:jc.Ib)||void 0===ea?void 0:ea.Dm)&&ua)return Object(pa.a)("PeoplesWellUserStatusIsViewingOnline")}else if(ua)return Object(pa.a)("PeoplesWellUserStatusIsViewingOnline");return this.i3m(Eb)||Object(pa.a)("PeoplesWellUserStatusLocationUnknown");case 2:return Object(pa.a)("PeoplesWellUserStatusIsInactive");
default:return Object(pa.a)("PeoplesWellUserStatusLocationUnknown")}}Qhn(Eb){if(this.wWh.sbe)return this.wWh.cWb(Eb.email,"O365",u.AFrameworkApplication.Fh,0)}jnn(Eb){Eb=this.settings.A5a(Eb.clientId);return!Eb||Eb&&1===Eb.status?!0:!1}knn(Eb){var jc=String.format("buttonPeoplesWellUser-{0}",Eb.clientId),ea=Eb.clientId,ua=this.onn(Eb);const Da=Eb.userName,Cb=Eb.color;var Nb=Object,fc=Nb.assign,fb=new dc,Ub=this.settings.XId.toString(),Ec=this.settings.VJe.cluster,Lc=this.settings.VJe.Tjd,vb=this.C2l(),
ec=Eb.isAnonymous,lb;if(lb=[Da],lb.length){var Zb=new Sys.StringBuilder("STRARRY@");for(const qc of lb)Zb.append(qc?qc.length:0),Zb.append(","),Zb.append(qc),Zb.append(",");lb=Zb.toString().slice(0,-1)}else lb=null;jc=fc.call(Nb,fb,{Id:jc,Command:Ub,LabelText:"{0}",Image32by32:Ec,Image32by32Class:Lc,MenuItemId:ea,CommandValueId:ea,Alt:Da,DisplayMode:vb,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",Description:ua,ImageBackColor:Cb,IsAnonymous:ec,LabelTextUserGeneratedPlaceholderReplacements:lb,
Upn:Eb.email});u.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseCustomStylesForCoauthorDescription",!1)&&(ea=this.efn(Eb),jc.CoauthorPresenceDescription=ea);u.AFrameworkApplication.ha.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled")&&this.wWh&&(ea=this.Qhn(Eb),ua=this.jnn(Eb),jc.ImageUrl=ea,jc.ActiveStatus=ua,jc.JoinTimeInMS=Eb.W2b,Eb=this.DTl(Eb.clientId,this.settings.y_b(Eb.clientId),!1),jc.CanJump=Eb,""===ea&&m.ULS.sendTraceTag(40969413,302,50,"ImageURL collection failed"));
return jc}Ahn(){return Object.assign(new ub.a,{Id:"BasicChat",Command:"2288458806",LabelText:Object(pa.a)("StartGroupChat"),LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word"})}C2l(){return this.Ewn?"Initials":"Menu32"}lnn(Eb){const jc=[];for(const ea of Eb)Eb=this.knn(ea),Array.add(jc,Eb);return jc}qOh(){return 0<this.geb.Ymc}G2n(Eb){if(!this.Pdi)return!0;this.IRj||(Eb[Ba.a.Visible]=!0);const {IVn:jc,JVn:ea,EVn:ua,GVn:Da,FVn:Cb}=this.zfn();Eb[Ba.a.LabelText]=
jc;ea&&ea.length&&(Eb[Ba.a.LabelTextUserGeneratedPlaceholderReplacements]=ea);Eb[Ba.a.ImageIsVisible]=ua;Eb[Ba.a.Image16by16Class]=Da;Eb[Ba.a.ImageBackColor]=Cb;this.Pdi=!1;return!0}hYn(Eb){if(0>=this.geb.Ymc)return!1;var jc=this.lgo(this.geb.s2h),ea=this.lnn(jc);jc=Object.assign(new tb.a,{Id:"menuCoauthors",MaxWidth:"220px",MenuSectionList:[]});ea=Object.assign(new kc.a,{Id:"msCoauthors",ControlsId:"msCoauthorsControls",DisplayMode:this.C2l(),ControlList:ea});u.AFrameworkApplication.ha.getBooleanAppSetting("WordEditorDisplayPeoplesWellLabelIsEnabled")&&
this.wWh&&(ea.Title=Object(pa.a)("PeoplesWellFlyoutLabel"),ea.TitleId="menuCoauthorsTitle",ea.Theme="Light");Array.add(jc.MenuSectionList,ea);u.AFrameworkApplication.ha.getBooleanAppSetting("DocChatIsEnabled")&&u.AFrameworkApplication.ha.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled")&&u.AFrameworkApplication.Ha&&u.AFrameworkApplication.Ha.Ib.az&&(ea=[],Array.add(ea,this.Ahn()),ea=Object.assign(new kc.a,{Id:"msGroupChat",ControlsId:"msGroupChatControl",ControlList:ea}),Array.add(jc.MenuSectionList,
ea));u.AFrameworkApplication.Ha&&u.AFrameworkApplication.Ha.Ib.az?Eb.MenuItems=jc:Eb.PopulationXML=Aa.l(jc);return!0}Jno(Eb){m.ULS.sendTraceTag(4482395,325,50,"PeoplesWell: Received user button click");Eb=Eb.MenuItemId;if(!Eb)return!1;const jc=this.settings.y_b(Eb);if(!this.DTl(Eb,jc,!0))return!1;this.Lzn(Eb,jc);return!0}o4n(){const Eb=this.den();this.geb.kco(Eb);this.IRj&&1<=this.geb.Ymc&&(m.ULS.sendTraceTag(6092429,325,50,"PeoplesWell: User is no longer forever alone."),this.IRj=!1);this.Pdi=!0}rab(){this.Gbi||
(window.setTimeout(()=>{this.VXh();this.Gbi=!1},3E3),this.Gbi=!0)}den(){let Eb;Eb=this.ben()||[];for(const jc of Eb)this.n9n(jc);return Eb}n9n(Eb){Eb.clientId||(Eb.clientId=P.a.create().toString());Eb.userName||(Eb.userName="Anonymous user");Eb.capabilities||(Eb.capabilities=new Kb.a);Eb.color||(Eb.color="#cccccc");Eb.W2b||(Eb.W2b=0)}lgo(Eb){const jc=[];Array.addRange(jc,Eb);jc.sort(ta.wVn);return jc}h5n(){u.AFrameworkApplication.ha.getBooleanAppSetting("CoauthorGalleryTelemetryIsEnabled")&&!this.Ahi&&
(u.AFrameworkApplication.ub.IV(wa.a.jLi)&&Db.a.isSharedUxGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DoNotRegisterCoauthorsRenderedMultiplTimes")||u.AFrameworkApplication.ub.ua(wa.a.jLi,Ma.a.frame,this.JQn,96));this.i5n();this.Ahi=!0;this.VXh()}get l1h(){return this.tmi.task}VXh(){if(!this.Ahi&&(this.tmi.EY((new Date).getTime()),m.ULS.sendTraceTag(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),this.Cwn))return;this.o4n();this.p4n()}dispose(){this.Jva&&
(this.Jva.PZk(Object(Oa.a)(this,this.rab,"onUsersUpdated")),this.Jva=null)}static wVn(Eb,jc){return u.AFrameworkApplication.ha.isChangeGateEnabled("OfficeVSO:8425872_SortUsersByEditorsViewersInactive")?Eb.capabilities.jPa(1)&&!jc.capabilities.jPa(1)?-1:!Eb.capabilities.jPa(1)&&jc.capabilities.jPa(1)?1:!Eb.isReadOnly&&jc.isReadOnly?-1:Eb.isReadOnly&&!jc.isReadOnly?1:sb.a.localeCompare(Eb.userName,jc.userName):Eb.capabilities.jPa(1)&&jc.capabilities.jPa(1)||!Eb.capabilities.jPa(1)&&!jc.capabilities.jPa(1)?
sb.a.localeCompare(Eb.userName,jc.userName):Eb.capabilities.jPa(1)?-1:1}efn(Eb){var jc,ea;null===(jc=this.settings)||void 0===jc||jc.y_b(Eb.clientId);null===(ea=this.settings)||void 0===ea||ea.A5a(Eb.clientId)}}Object(y.a)(ta,"APeoplesWell",null,[1876,40]);var Wa=a(52);class Pa extends ta{constructor(Eb,jc,ea=null,ua=null){super(Eb,ea,ua);this.Orc=()=>!0;this.Aa=jc}I2n(Eb){return this.G2n(Eb)}jYn(Eb){return this.hYn(Eb)}Lno(Eb){return this.Jno(Eb)}gna(Eb,jc,ea,ua,Da,Cb){Eb=!1;switch(ea){case 1:Eb=
Da(ua);break;case 2:Eb=Cb(ua)}return Pa.yYm(Eb)}Mwn(Eb,jc,ea,ua,Da){return this.gna(Eb,jc,ea,Da,()=>this.qOh(),this.Orc)}H2n(Eb,jc,ea,ua,Da){return this.gna(Eb,jc,ea,Da,Object(Oa.a)(this,this.I2n,"queryUsersProxy"),this.Orc)}iYn(Eb,jc,ea,ua,Da){return this.gna(Eb,jc,ea,Da,this.Orc,Object(Oa.a)(this,this.jYn,"populateFlyoutContentsProxy"))}M1m(Eb,jc,ea,ua,Da){return this.gna(Eb,jc,ea,Da,this.Orc,this.Orc)}L1m(Eb,jc,ea,ua,Da){return this.gna(Eb,jc,ea,Da,this.Orc,this.Orc)}Kno(Eb,jc,ea,ua,Da){return this.gna(Eb,
jc,ea,Da,this.Orc,Object(Oa.a)(this,this.Lno,"userButtonClickProxy"))}KWn(Eb,jc,ea,ua,Da){return this.gna(Eb,jc,ea,Da,this.Orc,()=>{this.VXh();return!0})}i5n(){this.Aa.Ba(this.settings.Lhd,Wa.a.application,Object(Oa.a)(this,this.Mwn,"isControlEnabledHandler"));this.Aa.ua(this.settings.Phd,Wa.a.application,Object(Oa.a)(this,this.H2n,"queryUsersHandler"),96);this.Aa.ua(this.settings.Nhd,Wa.a.application,Object(Oa.a)(this,this.M1m,"commandMenuOpenHandler"),96);this.Aa.ua(this.settings.Mhd,Wa.a.application,
Object(Oa.a)(this,this.L1m,"commandMenuCloseHandler"),96);this.Aa.ua(this.settings.Ohd,Wa.a.application,Object(Oa.a)(this,this.iYn,"populateFlyoutContentsHandler"),96);this.Aa.Ba(this.settings.XId,Wa.a.application,Object(Oa.a)(this,this.Kno,"userButtonClickHandler"));this.Aa.ua(this.settings.hTe,Wa.a.application,Object(Oa.a)(this,this.KWn,"peoplesWellRefreshControlHandler"),96)}dispose(){super.dispose()}static yYm(Eb){return Eb?32:8}}Object(y.a)(Pa,"ABox4PeoplesWell",ta,[]);var ib=a(1571);class Ib extends Sys.EventArgs{constructor(Eb){super();
this.controlId=Eb}}Object(y.a)(Ib,"RibbonControlStatusChangedEventArgs",Sys.EventArgs,[]);var hc=a(42);class yc extends Pa{constructor(Eb,jc,ea,ua,Da,Cb,Nb,fc,fb,Ub,Ec,Lc,vb,ec,lb,Zb,qc,pc,ac){super(Eb,jc,Zb,pc?A.Task.zG(pc):null);this.U5=null;this.Odk=!1;if(!Da)throw Error.argumentNull("coauthStateGetter");if(!Cb)throw Error.argumentNull("appFrame");if(!Nb)throw Error.argumentNull("taskManager");this.rq=Da;this.Gb=Cb;this.Yb=Nb;ua&&ua.execute(gb=>{this.U5=gb});ea&&ea.execute(gb=>{gb.BVm(Object(Oa.a)(this,
this.j1n,"presenceChanged"))});this.rc=fc;this.Nf=fb;this.Oe=Ub;this.lke=vb;this.CDn=Ec;this.Yne=Lc;this.y_e=ec;this.XYa=lb;this.zkk=qc;this.Ngm=pc;this.Cda=ac;this.l1h.continueWith(()=>{this.XYa.XZl(this.l1h.result)})}Lzn(Eb,jc){let ea=null;({data:ea}=this.Jvl(jc)).returnValue&&ea&&ea.Pw&&(ma.a.$(512497493,814,50,"PowerPointPeoplesWell : JumpToUserLocation; clientId: {0}; slideId: {1}; MyClientId: {2};",Eb,ea.Pw,this.rq.CR),(Eb=this.rc.agb(ea.Pw))?hc.a("CollabGoToLocationFix")?this.Cda.value.Z$(Eb.Dh):
this.Nf.Z$(Eb.Dh):ma.a.$(512497492,814,15,"PowerPointPeoplesWell : JumpToUserLocation; failed to find slide by id: {0}; ",ea.Pw))}Jvl(Eb){let jc;jc=null;if(!Eb)throw ma.a.$(512497491,814,10,"PowerPointPeoplesWell : TryGetPresenceData; Presence was null; MyClientId: {0};",this.rq.CR),Error.argumentNull("presence");return Eb?(jc=ib.a.kIh(Eb.data))?{returnValue:!0,data:jc}:{returnValue:!1,data:jc}:{returnValue:!1,data:jc}}L_m(Eb){let jc=null;return({data:jc}=this.Jvl(Eb)).returnValue&&jc&&jc.Pw?!0:!1}ben(){if(this.Ngm)return this.Ngm.aen();
ma.a.$(512497490,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - PeopleInfoProvider is null.");const Eb=this.cen();0<Eb.length&&ma.a.$(512497489,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - non-empy editor count {0}.",Eb.length);return Eb}cen(){const Eb=[],jc=this.zkk.Chj();this.rq.Idd(this.rq.CR).returnValue||ma.a.$(512497488,814,50,"PowerPointPeoplesWell : GetAllUsersInfo, there is no current editorId:{0} in the editortable",this.rq.CR);let ea=null;this.U5&&(ea=this.U5.XKh());var ua=u.AFrameworkApplication.ha.getBooleanAppSetting(Ka.a.Hqd);
for(var Da of this.rq.B$){var Cb=this.Yne.z5a(new Qa.a(Da.EmailAddress,void 0,Da.Name),Da.ID,1),Nb=new Kb.a;Nb.p$c(0);let fc=0,fb=!1;if(yc.rzn(Da.ID,ea)){Nb.p$c(1);if(ua){const Ub=ea[Da.ID];Ub&&(fc=Ub.capabilities);fb=!0;Ub&&Ub.capabilities&4&&Nb.p$c(4)}delete ea[Da.ID]}yc.zGh(jc,Da.EmailAddress)||(Array.add(Eb,new nb.a(Da.ID,Da.Name,Cb,Nb,null,Da.EmailAddress)),ma.a.$(8958496,814,50,"PowePointPeoplesWell : GetAllUsersInfo; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities:{6}; fIssuserinrtc{7};",
Da.ID,Cb,Nb.jPa(1),Nb.jPa(4),this.rq.CR,!Da.EmailAddress,fc,fb))}if(!ua&&this.lke&&ea)for(const fc in ea)ua=ea[fc],!yc.zGh(jc,ua.email)&&ua&&ua.userName&&(Da=new Kb.a,Da.p$c(1),ua.capabilities&4&&Da.p$c(4),Cb=this.y_e.sLh(ua.email)||ua.email,Nb=this.Yne.z5a(new Qa.a(Cb,void 0,ua.userName),ua.clientId,1),Array.add(Eb,new nb.a(ua.clientId,ua.userName,Nb,Da,null,Cb)),ma.a.$(38897818,814,50,"PowePointPeoplesWell : GetAllUsersInfo; Get info from RTC when user is not in editor table and username is provided; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcPresenceCapabilities: {6};",
ua.clientId,Nb,Da.jPa(1),Da.jPa(4),this.U5.clientId,!ua.email,ua.capabilities));return Eb}i3m(Eb){let jc=null,ea=" ";({data:jc}=this.Jvl(Eb)).returnValue&&jc&&jc.Pw&&(Eb=this.rc.agb(jc.Pw))&&(ea=String.format(ResourceStrings.l_PeoplesWellUserStatusIsEditingSlide,Eb.Dh+1));return ea}j1n(){this.Gb.Tv.XPa?this.Odk||(this.Yb.Rb(new ab.a(2,1,0,Object(Oa.a)(this,this.handlePendingRefresh,"handlePendingRefresh"),90,"70")),this.Odk=!0):this.Aa.Eb(wa.a.nob,2)}p4n(){this.Oe.usm(new Ib(this.settings.id,!0));
const Eb=1<this.geb.Ymc||1===this.geb.Ymc&&this.geb.s2h[0].clientId!==this.settings.clientId;this.CDn.execute(jc=>{Eb&&this.XYa&&this.XYa.Jbm();jc.uic()});Eb&&this.XYa.mi(14,Date.now())}handlePendingRefresh(){this.Odk=!1;this.Aa.Eb(wa.a.nob,2)}dispose(){super.dispose()}static rzn(Eb,jc){return jc&&Eb in jc?!0:!1}static zGh(Eb,jc){return!!Eb&&!!jc&&Eb.toLowerCase()===jc.toLowerCase()}}Object(y.a)(yc,"PowerPointPeoplesWell",Pa,[]);class ob{constructor(Eb){this.zNg=null;Eb.execute(jc=>{this.zNg=jc})}y_b(Eb){return this.zNg?
this.zNg.y_b(Eb):null}A5a(Eb){return this.zNg?this.zNg.A5a(Eb):null}}Object(y.a)(ob,"PresenceUserInfoGetterProxy",null,[1151]);var Bc=a(90);class rb{constructor(){this.ohb=this.Ofa=this.vn=this.ga=null}get name(){return"PowerPointWebEditor.PeoplesWell"}oc(Eb){rb.dsg=Date.now();this.ga=Eb;this.ohb=this.ga.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.vn=this.ohb.GIb(6,this.name);this.ga.register(1151,"PowerPointWebEditor.IPresenceUserInfoGetter").oa().pa(()=>new ob(this.ga.eb("PowerPointWebEditor.IDelayedPresenceUserInfoGetter")));
this.ga.register(616,"Common.ICoauthoringTelemeryInfoProvider").oa().pa(()=>new za(this.ga.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.ga.register(Sb,"PowerpointPresence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").oa().pa(()=>new Sb(this.ga.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.ga.eb("Common.IRealtimeChannelBasic"),this.ga.resolve("PowerpointPresence.IPresenceColorProvider"),this.ga.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.ga.resolve("PowerpointPresence.IPresencePrepCacheParser")));
if(hc.a("PeoplesBaseUlrConfiguredForPods")&&(Eb=this.ga.resolve("Common.App.People.IExternalPeopleAPI"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").li)){const jc=this.ga.resolve("Common.IAppSettingsManager").Ma(Bc.a.daa);Eb.MCk(jc+"p")}ma.a.$(509669911,814,50,"PPTWebEditorPeoplesWellPackage:Configure")}init(){this.ga.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").qfa("pptedit.presence1",null,null,()=>a.e(20).then(a.bind(null,1902)));this.ga.resolve("Common.ICoauthoringTelemeryInfoProvider");
this.ga.resolve("Common.IPeopleInfoProvider");u.AFrameworkApplication.wZ.Ofb?(this.Ofa=this.ga.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),Ua.a.bqd("ribbon","coauthorGallery"),this.Ofa.EFh(Object(Oa.a)(this,this.A8l,"initializePeoplesWellHandler"))):this.z8l()}A8l(){try{u.AFrameworkApplication.wZ.Ofb||(this.z8l(),this.Ofa.iYh(Object(Oa.a)(this,this.A8l,"initializePeoplesWellHandler")))}catch(Eb){ma.a.$(8958610,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",
Eb)}}z8l(){const Eb=this.vn.CJ("peoplewell");this.gvn(this.ga.resolve("PowerPointWebEditor.IPresenceUserInfoGetter"),this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.AppFrame"),this.ga.resolve("Common.ITaskManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerpointPresence.RtcParams").clientId);this.vn.FJ(Eb)}gvn(Eb,jc,ea,ua,Da,Cb){var Nb=this.ga.resolve("PowerpointPresence.IPresencePerfLogger");Nb.mi(10,rb.dsg);Nb.mi(9,rb.hOg);
Nb.mi(11,(new Date).getTime());Nb=Date.now();const fc=ya.a.TLh(u.AFrameworkApplication.Ln,"per_SingleCollabUserGlyph_16x16x32",u.AFrameworkApplication.Ln,"per_SingleCollabUserGlyph_32x32x32",u.AFrameworkApplication.Ln,"per_MoreUsersGlyph_16x16x32");Eb=Ia.createInstance(fc,Cb,Object(Oa.a)(Eb,Eb.y_b,"getUserPresence"),Object(Oa.a)(Eb,Eb.A5a,"getUserStatusInfo"),!0);(Cb=this.ga.resolve("PowerpointPresence.PeopleInfoProvider"))||ma.a.$(509669910,814,10,"InitializePeoplesWellInternal; null PeopleInfoProvider");
ma.a.$(509669909,814,50,"InitializePeoplesWellInternal; creating peopleswell");const fb=new yc(Eb,jc,this.ga.eb("PowerpointPresence.IPresenceManager"),this.ga.eb("Common.IRealtimeChannelBasic"),this.ga.resolve("PowerPointWebEditor.ICoauthStateGetter"),ea,ua,this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.ga.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.ga.eb("Box4.IBox4BridgeCommandUi"),this.ga.resolve("PowerpointPresence.IPresenceColorProvider"),
Da.Jab,this.ga.resolve("PowerpointPresence.IPresenceEmailConverter"),this.ga.resolve("PowerpointPresence.IPresencePerfLogger"),this.ga.resolve("Common.App.People.IPeopleManager"),this.ga.resolve("PowerpointPresence.IPresencePrepCacheParser"),Cb,this.ga.he("PowerPointWebEditor.ISorterViewActorLazy"));fb.h5n();this.ga.register(yc,"PowerpointPresence.PowerPointPeoplesWell").as("Common.IPeoplesWell").oa().pa(()=>fb);this.ga.resolve("Common.IPeoplesWell");this.ga.eb("Box4.IBox4BridgeCommandUi").execute(Ub=>
{Ub.uic()});ma.a.$(8958615,814,50,"PresencePackage::InitializePeoplesWell; People's Well loaded and initialized. Time cost: {0}",Date.now()-Nb);this.ga.resolve("PowerpointPresence.IPresencePerfLogger").a_l()}dispose(){}static main(){rb.hOg=Date.now();if(u.AFrameworkApplication.ha&&u.AFrameworkApplication.ha.getBooleanAppSetting("IsSyncConfigPresenceEnabled")){const Eb=new rb;Eb.oc(c.a.instance);Eb.init()}else Z.a.instance.Jc(new rb)}}rb.hOg=0;rb.dsg=0;Object(y.a)(rb,"PPTWebEditorPeoplesWellPackage",
null,[4,5]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.PeoplesWell");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("RealtimePresenceUI");window.g_hermesPresenceJS=new Date;Type.registerNamespace("Common.App.CoauthTelemetry");Fa.main();Type.registerNamespace("RealtimePresenceUI");rb.main()},294:function(y,C,a){a.r(C);a.d(C,"CuiHelperStatic",function(){return b});y=a(0);var c=a(156);class b{static addButton(d,e,h,n,m,k,l,u){e=c.a(d,
e,h,n,null,null,null,k,null,null,void 0,void 0,m);(d=u.hostControl(d,e,k))&&l.appendChild(d);return d}}b.mxa="btnReplyWithChanges";Object(y.a)(b,"CuiHelperStatic",null,[])},315:function(y,C,a){a.d(C,"a",function(){return T});y=a(0);a(172);var c=a(50),b=a(405),d=a(416);a(560);var e=a(41),h=a(111),n=a(57),m=a(59);class k{}Object(y.a)(k,"RibbonUpsellButtonCreator",null,[]);class l extends Sys.EventArgs{constructor(K){super();this.ZAh=K}}Object(y.a)(l,"TopRowCreatedEventArgs",Sys.EventArgs,[]);var u=
a(472),r=a(366);a(169);var x=a(156);a(300);a(109);var v=a(254),z=a(162),A=a(88);class B{constructor(K,M){this.cluster=K;this.Tjd=M}}Object(y.a)(B,"ImageInfo",null,[]);class G{constructor(K,M,N,I,O,Q,U,ba,aa,La,Z,la,da,J,Ca=null,Fa=null){this.id=K;this.Lhd=M;this.Phd=N;this.Ohd=I;this.Nhd=O;this.Mhd=Q;this.XId=U;this.hTe=ba;this.Lgc=new B(aa,La);this.VJe=new B(Z,la);this.Yre=new B(da,J);Ca&&Fa&&new B(Ca,Fa)}}Object(y.a)(G,"PeoplesWellBaseSettings",null,[]);class w{constructor(){this.STb=null}}Object(y.a)(w,
"BreadcrumbControls",null,[]);class F{constructor(K){this.id=K}}new F("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32","WACSkypeDocChatUnread_16x16x32");Object(y.a)(F,"ChatButtonSettings",null,[]);class H{constructor(){this.id=this.image=this.label=this.command=null}}Object(y.a)(H,"SkypeButtonInfo",null,[]);class E{constructor(){this.feb=this.Rhc=this.C2a=null}}Object(y.a)(E,"TopRowControls",null,[]);var P=a(206);a(64);class T{constructor(K,M,N=null,I=null,O=null){this.Maa=K;this.HOb=
P.a.kVg(M,O);"undefined"!==typeof CommonUiStrings&&this.HOb.push(CommonUiStrings);"undefined"!==typeof CommonUIStrings&&this.HOb.push(CommonUIStrings);d.b();T.Aa=void 0===N||null===N?e.AFrameworkApplication.ub:N;void 0!==I&&null!==I||this.HMd()}HMd(){Object(m.a)("SignoutLink");Object(m.a)("SignIn")}static get y3d(){return T.Kma||(T.Kma=c.a.instance.resolve("Common.App.Header.HeaderEventSource"))}static TLh(K,M,N,I,O,Q){return new G(T.rKb,n.a.jIf,n.a.PBc,n.a.nIf,n.a.lIf,n.a.kIf,n.a.oIf,n.a.nob,K,M,
N,I,O,Q,null,null)}static rQf(K){K.C2a&&(T.hTd(K.C2a),K.C2a=null);K.Rhc&&(T.gTd(),K.Rhc=null);K.feb&&(T.iTd(K.feb),K.feb=null);T.y3d.O9g();let M;({kgb:M}=r.a.Rib(!1)).returnValue&&h.a.Uza(M)}static YIb(){e.AFrameworkApplication.ub.Eb(n.a.YIb,2)}static gTd(){e.AFrameworkApplication.ZWb&&z.EventHandlerManager.instance.ric(e.AFrameworkApplication.ZWb)}static addButton(K,M,N,I,O,Q,U,ba){M=x.a(K,M,N,I,null,null,null,Q,null,null,void 0,void 0,O);(K=ba.hostControl(K,M,Q))&&U.appendChild(K);return K}static OVb(K,
M,N,I,O){let Q;I?(Q=document.createElement("a"),Q.href=I,Q.target="_top",v.a.instance.aib(A.a.click,Q,T.Fte,null,!0)):O?(Q=document.createElement("div"),Q.tabIndex=0):Q=document.createElement("span");Q.className="BreadcrumbItem"+(O?" Selectable":"");Q.id=M;Q.innerText=N;Q.setAttribute("dir","auto");K.appendChild(Q);return Q}static hTd(K){K.STb&&z.EventHandlerManager.instance.zwh(K.STb)}static Fte(K){const M=u.a.instance.Vo(n.a.DCf);M.properties.add("id",K.Wj.id);M.end();b.ULS.sendTraceTag(595732178,
207,50,"Breadcrumb link clicked: {0}",{["id"]:K.Wj.id});return T.zMb?T.zMb(K):!1}static iTd(K){v.a.instance.IOe(A.a.click,K,T.pve,!0)}static pve(){e.AFrameworkApplication.Lic?(e.AFrameworkApplication.Ha.FEb(e.AFrameworkApplication.Ha.Ib.X0d()),e.AFrameworkApplication.Lic=!1):window.top.location=e.AFrameworkApplication.signInUrl;return!0}static eub(){return!!e.AFrameworkApplication.Ha&&e.AFrameworkApplication.Ha.Ib.eub}}T.Kma=null;T.Klh="ShareServerWhite_20x20x32";T.Tkc="ExternalHeaderFullTopBars";
T.OXe="HeaderTopBars";T.pkc="BreadcrumbBrand";T.qkc="BreadcrumbFolder";T.rkc="BreadcrumbTitle";T.Pkd="FolderSeparator";T.j7e="sbTellMe";T.w6e="TellMe-SearchBox";T.Cqd="btnOpenInClient";T.Noc="btnFileSharing";T.woh="BasicChat";T.mxa="btnReplyWithChanges";T.Jkd="jbtnGiveFeedback";T.rKb="PeoplesWellControl";T.ORf="EditableBreadcrumbItem";T.Aa=null;T.zMb=null;T.ked=50;T.mag=null;Object(y.a)(T,"CuiHelper",null,[725])},370:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);var c;(function(b){b[b.unknown=
0]="unknown";b[b.excel=1]="excel";b[b.powerPoint=2]="powerPoint";b[b.word=3]="word";b[b.oneNote=4]="oneNote";b[b.LAh=5]="visio"})(c||(c={}));Object(y.b)("OfficeAppType",c)},401:function(y,C,a){a.d(C,"a",function(){return d});a.d(C,"b",function(){return e});a.d(C,"c",function(){return h});var c=a(41),b=a(370);const d=()=>{const n=c.AFrameworkApplication.Ha.Ib.Dm;return(3===n||1===n||2===n||4===n)&&c.AFrameworkApplication.ha.getBooleanAppSetting("PremiumUpsellIsEnabled")},e=(n,m,k,l=!1)=>{m=1===m;1===
n&&(m=2===c.AFrameworkApplication.Ha.mode);return String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",b.a[n],m?"Editor":"Viewer",l?"Dime":"Unknown",k?k:"dimedefault")},h=n=>{switch(n){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";default:return null}}},416:function(y,C,a){a.d(C,"b",function(){return m});a.d(C,"h",function(){return k});a.d(C,"d",function(){return l});a.d(C,"g",function(){return u});a.d(C,"f",
function(){return x});a.d(C,"e",function(){return v});a.d(C,"c",function(){return z});a.d(C,"a",function(){return A});var c=a(41);a(500);var b=a(559),d=a(401);a(10);var e=a(69),h=a(59),n;const m=()=>c.AFrameworkApplication.XV,k=()=>{const B=c.AFrameworkApplication.Ha.Ib.PO;return!m()&&!c.AFrameworkApplication.hideHeader&&d.a()&&(B||1===c.AFrameworkApplication.yWe)},l=()=>c.AFrameworkApplication.ha.getBooleanAppSetting("DiscoverPremiumButtonEnabled"),u=()=>c.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AnonymousSignInButtonExperiment",
!1)&&c.AFrameworkApplication.ha.getBooleanAppSetting("IsAnonymousUser"),r=()=>c.AFrameworkApplication.Wsd&&!m()&&!c.AFrameworkApplication.hideHeader,x=()=>r()&&"officecomhwa"!==(c.AFrameworkApplication.ha.Ma(c.AFrameworkApplication.DF)||"").toLowerCase()&&!c.AFrameworkApplication.pmd&&!e.a.oZe,v=()=>!c.AFrameworkApplication.Alc&&r(),z=()=>!m()&&!c.AFrameworkApplication.hideHeader&&c.AFrameworkApplication.ha.getBooleanAppSetting("BasicChatIsEnabled"),A=()=>{if(c.AFrameworkApplication.smd)return null;
var B=!!c.AFrameworkApplication.Ha&&c.AFrameworkApplication.Ha.Ib.PO;if((c.AFrameworkApplication.Ulc&&c.AFrameworkApplication.nxa||c.AFrameworkApplication.Vib)&&B)return Object.assign(new b.a,{command:"1197060601",label:Object(h.a)("ReplyWithChanges"),id:a(294).CuiHelperStatic.mxa});if(c.AFrameworkApplication.VLb){B="";switch(c.AFrameworkApplication.ajb){case "Assign":B=Object(h.a)("Assign");break;case "Submit":B=Object(h.a)("Submit")}if(""!==B)return Object.assign(new b.a,{command:"2988588587",label:B,
id:"btnWorkflow"})}return null};null===(n=c.AFrameworkApplication.ha)||void 0===n||n.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HeaderPlaceholderAddNewUx",!1)},559:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.keytip=this.id=this.image=this.label=this.command=null}}Object(y.a)(c,"HeaderButtonInfo",null,[])},560:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}Object(y.a)(c,"RibbonPeripheralSection",null,[])},740:function(y,C,a){a.d(C,"a",
function(){return c});y=a(0);a=a(295);class c{}c.LabelText=a.a.labelText;c.LabelTextUserGeneratedPlaceholderReplacements=a.a.tPh;c.Visible=a.a.visible;c.ImageIsVisible="ImageIsVisible";c.ImageUsesSpaceWhileInvisible="ImageUsesSpaceWhileInvisible";c.Image16by16Class=a.a.RIb;c.Image32by32Class=a.a.TBa;c.Image48by48Class=a.a.ZLc;c.ImageBackColor="ImageBackColor";c.On="On";c.SourceControlId="SourceControlId";Object(y.a)(c,"FlyoutAnchorCommandProperties",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25649181/wdjs/ppteditDS.presence.js.map