'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[17],{1116:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.Collapse=this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(y.a)(c,"GallerySectionProps",null,[])},1119:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}c.taskPaneWidth="TaskPaneWidth";c.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";c.UC="TaskPaneTitle";c.nonPersistedSettings=
"NonPersistedSettings";c.onTaskPaneClose="OnTaskPaneClose";c.onExtensionLaunchCallback="OnExtensionLaunchCallback";c.UW="OnRenderedCallback";c.akd="DialogIsModal";c.bkd="DialogShowTitleBar";c.dialogWidth="DialogWidth";c.dialogHeight="DialogHeight";c.dialogLeft="DialogLeft";c.wEc="DialogRight";c.dialogTop="DialogTop";c.qEc="DialogBottom";c.nfa="DialogTitle";c.sEc="DialogCloseCallback";c.vEc="DialogResizeCallback";c.GSd="DialogParentId";c.showLoadingSpinner="ShowLoadingSpinner";c.actionName="ActionName";
Object(y.a)(c,"PropertyNames",null,[])},1129:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}c.Gse="Listening";c.$pd="Warning";c.eKb="Error";Object(y.a)(c,"VoiceNotificationResourceStrings",null,[])},1138:function(y,C,a){function c(vb,ec){var lb=document.getElementById(vb);lb?ec?lb.innerHTML=ec:lb.remove():ec&&(lb=document.createElement("style"),lb.id=vb,lb.type="text/css",lb.innerHTML=ec,document.head.appendChild(lb))}function b(){var vb=document.querySelectorAll("[data-unique-id^='Ribbon-'][data-unique-id$='SubMenuAnchor']");
if(vb&&0<vb.length)for(var ec=0;ec<vb.length;ec++)vb[ec].removeAttribute("aria-selected")}function d(vb){vb=vb.map(ec=>`[data-icon-name=${"AddinFlyoutControl"+ec}]::after {
      content: "";
      position: absolute;
      top: 9px;
      right: 18px;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: #CC4A31;
    }`).join("");c("RedDotNotification",vb)}function e(vb){vb=vb.map(ec=>`[data-icon-name=${"AddinFlyoutControl"+ec}]::after {
        content: "New";
        position: absolute;
        top: 6px;
        right: 10px;
        width: 30px;
        height: 16px;
        border-radius: 50%/100%;
        border: white 1px solid;
        background-color: #185abd;
        color: white;
        font-size: 10px;
        font-style: normal;
    }`).join("");c("NewStringNotification",vb)}function h(vb,ec){vb=vb.map((lb,Zb)=>`        [id="InsertAddInFlyoutMenuIdsection-${Zb+ec}-title"]>div>span:after,
      [id="Ribbon-InsertAddInFlyoutDropdownsection-${Zb+ec}-title"]>div>span:after {
    content: "${lb}";
    display: block;
    font-size: 12px;
    font-weight: 400;
    line-height: initial;
  }
  [id="InsertAddInFlyoutMenuIdsection-${Zb+ec}-title"]>div>span,
  [id="Ribbon-InsertAddInFlyoutDropdownsection-${Zb+ec}-title"]>div>span{
    display: flex;
    flex-direction: column;
    padding-top: 5px;
    padding-bottom: 5px;
    line-height: 20px;
  }
  [id="InsertAddInFlyoutMenuIdsection-${Zb+ec}-title"],
  [id="Ribbon-InsertAddInFlyoutDropdownsection-${Zb+ec}-title"]{
    height: unset;
  }`).join("");c("CategoryDescription",vb)}function n(vb){vb=vb.map(ec=>{var [lb,Zb]=ec;return`[name="${lb}"]>div>span:after {
    content: "${Zb}";
    display: block;
    font-size: 12px;
    font-weight: 400;
    line-height: initial;
  }
  [name="${lb}"]>div>span {
    display: flex;
    flex-direction: column;
    padding-top: 5px;
    padding-bottom: 5px;
    line-height: 20px;
  }
  [name="${lb}"]>div {
    height: unset;
  }
  [id="Ribbon-InsertAddInFlyoutDropdown"] button[aria-haspopup="true"][name="${lb}"],
  [id="InsertAddInFlyoutMenuId"] button[aria-haspopup="true"][name="${lb}"]{
    height: unset;
  }
  `}).join("");c("CategoryDescriptionAnchor",vb)}function m(vb){return aq(function*(){let ec;for(let uc=0;10>uc;++uc)(ec=document.getElementById("fluent-default-layer-host"))||(yield new Promise(Cc=>setTimeout(Cc,1E3)));if(!ec)throw Error("Cannot find the flyout container.");let lb=!1,Zb=performance.now(),qc;const pc=uc=>{const Cc=performance.now();uc?(lb=!0,vb(!0,0),Zb=Cc):lb&&(lb=!1,vb(!1,Cc-Zb))},ac=uc=>{qc&&qc.disconnect();const Cc=uc.querySelector('[id="InsertAddInFlyoutMenuId"]');Cc?(qc=new MutationObserver(Gc=>
{for(const dd of Gc)"attributes"===dd.type&&dd.target instanceof HTMLElement&&("InsertAddInFlyoutMenuId"!==dd.target.id?pc(!1):pc(!0))}),qc.observe(Cc,{attributes:!0,attributeFilter:["id"]}),pc(!0)):(qc=new MutationObserver(Gc=>{for(const dd of Gc)"attributes"===dd.type&&dd.target instanceof HTMLElement&&("hidden"===dd.target.style.visibility?pc(!1):pc(!0))}),qc.observe(uc,{attributes:!0,attributeFilter:["style"]}),"hidden"!==uc.style.visibility&&pc(!0))},gb=new WeakSet,Jb=new MutationObserver(uc=>
{for(const Gc of uc){for(uc=0;uc<Gc.addedNodes.length;++uc){var Cc=Gc.addedNodes.item(uc);Cc instanceof HTMLElement&&(Cc.querySelector('[id="Ribbon-InsertAddInFlyoutDropdown"]')||Cc.querySelector('[id="InsertAddInFlyoutMenuId"]'))&&(ac(Cc.querySelector(".ms-Callout-container")),gb.add(Cc))}for(uc=0;uc<Gc.removedNodes.length;++uc)Cc=Gc.removedNodes.item(uc),gb.has(Cc)&&(gb.delete(Cc),pc(!1))}});Jb.observe(ec,{attributes:!1,childList:!0});return{dispose:()=>{Jb.disconnect();null===qc||void 0===qc?void 0:
qc.disconnect()}}})}function k(vb,ec){if(!vb)switch(ec){case "Word":return["wa200001011"];case "Excel":return["wa200005502"];case "PowerPoint":return["wa200005566"];default:return[]}return vb.split("|")}function l(vb){c("FREBanner",vb?'\n  [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {\n    [class^="container-"] {\n      >ul>li:first-child {\n        width: 330px;\n        background-color: var(--colorBrandBackground2);\n        border-radius: 8px;\n        margin-left: 18px;\n        margin-bottom: 5px;\n\n        [id^="AddInFlyoutFREBannerMenuLaunchAddin"][role="menuitem"] {\n          margin-left: 0px;\n          width: 100%;\n          padding: 15px 13px;\n          box-sizing: border-box;\n\n          >i {\n            border: none;\n            min-width: 36px;\n            height: 36px;\n            padding: 3px;\n            background-color: #fff;\n          }\n\n          >div>div>span {\n            white-space: normal;\n            text-align: left;\n            margin-bottom: 5px;\n          }\n\n          &:hover {\n            background-color: transparent;\n            border: none;\n          }\n\n          &:focus {\n            background-color: transparent;\n          }\n        }\n      }\n    }\n  }\n\n  [id="FREBannerErrorView"] {\n    width: 100%;\n    height: 102px;\n    display: flex;\n    flex-direction: row;\n\n    >i {\n      width: 100%;\n      height: 102px;\n      margin-left: 20px;\n\n      >svg {\n        width: 330px;\n        border-radius: 8px 8px 0px 0px;\n      }\n    }\n    >div {\n      margin-top: 0;\n\n      >label {\n        font-weight: 600;\n        text-align: left;\n        color: var(--colorNeutralForeground1);\n      }\n    }\n  }\n  ':
"")}function u(vb,ec){const lb=[];ec=new M(ec);for(var Zb=0;30>Zb;Zb++)Array.add(lb,ec.next(vb.count));ec=0;for(const qc of vb){Zb=!1;for(const pc of lb)if(ec===pc){Zb=!0;break}ec++;if(Zb){let pc;(pc=qc.addinInfo).AUP=20*pc.AUP}else if(1===qc.addinInfo.priority){let pc;(pc=qc.addinInfo).AUP=4*pc.AUP}else if(2===qc.addinInfo.priority){let pc;(pc=qc.addinInfo).AUP=2*pc.AUP}}vb.Sc((qc,pc)=>qc.addinInfo.AUP<pc.addinInfo.AUP?1:-1);return vb}function r(vb){return Telemetry.PrivacyRules.GetPrivacyCompliantId(vb.solutionId,
vb.storeType,vb.assetId,null,null,vb.storeId)}function x(vb,ec){return Object.assign(new vb,ec)}a.d(C,"a",function(){return Lc});y=a(0);var v=a(405),z=a(1119),A=a(158),B=a(143),G=a(41),w=a(173),F=a(1534);class H{constructor(vb){this.Ga=vb}get host(){var vb;const ec=null===(vb=this.Ga)||void 0===vb?void 0:vb.Ma("Application");return"Word"===ec||"Excel"===ec||"PowerPoint"===ec?ec:""}get A2(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutContentExpEnabled",
!1)}get Xeb(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREButtonGroupExpEnabled",!1)}get $Sb(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutContentExpandExpEnabled",!1)}get cyf(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutOpenCloseTelemetryEnabled",!1)}get ZSb(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinCategoryDescriptionExpEnabled",
!1)}get nid(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinContextMenuShareButtonEnabled",!1)}get q2g(){return this.Ga?this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableFRECategoryIds",""):""}get r2g(){return this.Ga?this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableFRECategoryNames",""):""}get p2g(){return this.Ga?this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableCategoryAddinIdsMapping",""):""}get lfc(){return!!this.Ga&&
this.Ga.isChangeGateEnabled("OfficeVSO:8668457_SeeMoreSeeLessEnabled")}get B2(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)}get eyf(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchWithOmexEnabled",!1)}get dyf(){return this.Ga?this.Ga.getIntFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchRequestSentTimeoutMs",2E4):2E4}get s2g(){return this.Ga?this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableSearchQueryParameters",
""):""}get aTb(){return!!this.Ga&&this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREBannerEnabled","0")}get ayf(){return!!this.Ga&&this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREBannerAddins","")}get mMd(){return!!this.Ga&&"Dev Box"===this.Ga.Ma("StatusBarEnvironmentNameToUse")}get byf(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFreeLabelExpEnabled",!1)}get bTb(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutRedDotExpEnabled",
!1)}get Yeb(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutNotificationExpEnabled",!1)}get wxa(){return!!this.Ga&&this.Ga.isChangeGateEnabled("StoreDisabledErrorViewFixEnabled")}get hWa(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}}Object(y.a)(H,"AppsFlyoutGeneratorContext",null,[]);var E=a(59);const P=()=>({["APIC"]:Object(E.a)("AddInCategoryTitleAddingPicturesIconsAndCharts"),["APID"]:Object(E.a)("AddInCategoryTitleAddingPicturesIconsAndDiagrams"),
["BBM"]:Object(E.a)("AddInCategoryTitleBuildByMicrosoft"),["CAIP"]:Object(E.a)("AddInCategoryTitleDesigningAnInteractivePresentation"),["DA"]:Object(E.a)("AddInCategoryTitleDataSyncAndAnalysis"),["DWT"]:Object(E.a)("AddInCategoryTitleDesigningWithTemplates"),["ER"]:Object(E.a)("AddInCategoryTitleEducationalPurpose"),["FA"]:Object(E.a)("AddInCategoryTitleFinancialAnalytics"),["IPWAI"]:Object(E.a)("AddInCategoryTitleImprovingProductivityWithAI"),["TD"]:Object(E.a)("AddInCategoryTitleTrendingAddins"),
["WN"]:Object(E.a)("AddInCategoryTitleNewAddins"),["WF"]:Object(E.a)("AddInCategoryTitleWritingFluently"),["PAIYO"]:Object(E.a)("AddInCategoryTitlePopularAddinsInYourOrg"),default:Object(E.a)("PopularAddins")}),T=()=>({["Word"]:{["IPWAI"]:Object(E.a)("AddInCategoryShortTitleImprovingProductivityWithAI")||"Add-ins with AI",["WF"]:Object(E.a)("AddInCategoryShortTitleWritingFluently")||"Perfect your writing",["ER"]:Object(E.a)("AddInCategoryShortTitleEducationalResources")||"Education",["APID"]:Object(E.a)("AddInCategoryShortTitleAddingPicturesIconsDiagrams")||
"Unlock your creativity"},["Excel"]:{["IPWAI"]:Object(E.a)("AddInCategoryShortTitleImprovingProductivityWithAI")||"Add-ins with AI",["APID"]:Object(E.a)("AddInCategoryShortTitleAddingPicturesIconsDiagrams")||"Unlock your creativity",["FA"]:Object(E.a)("AddInCategoryShortTitleFinancialAnalytics")||"Manage your finances"},["PowerPoint"]:{["IPWAI"]:Object(E.a)("AddInCategoryShortTitleImprovingProductivityWithAI")||"Add-ins with AI",["APID"]:Object(E.a)("AddInCategoryShortTitleAddingPicturesIconsDiagrams")||
"Unlock your creativity",["CAIP"]:Object(E.a)("AddInCategoryShortTitleCreatingAnInteractivePresentation")||"Elevate your presentations",["DWT"]:Object(E.a)("AddInCategoryShortTitleDesigningWithTemplates")||"Templates"},shared:{["BBM"]:Object(E.a)("AddInCategoryShortTitleBuildByMicrosoft")||"Built by Microsoft",["TD"]:Object(E.a)("AddInCategoryShortTitleTrending")||"Trending",["WN"]:Object(E.a)("AddInCategoryShortTitleWhatsNew")||"Just released",["PAIYO"]:Object(E.a)("AddInCategoryShortTitlePopularAddinsInYourOrg")||
"Popular"}}),K=()=>({["Word"]:{["APID"]:Object(E.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsWord")||"Add photos, icons, and diagrams to your documents.",["ER"]:Object(E.a)("AddInCategoryDescriptionEducationalResources")||"Resources for educators and students.",["IPWAI"]:Object(E.a)("AddInCategoryDescriptionImprovingProductivityWithAIWord")||"Draft and summarize with the power of generative AI.",["WF"]:Object(E.a)("AddInCategoryDescriptionWritingFluently")||"Get help with spelling, grammar, and more."},
["Excel"]:{["APID"]:Object(E.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsExcel")||"Add photos, icons, and diagrams to spreadsheets.",["DA"]:Object(E.a)("AddInCategoryDescriptionDataAnalytics")||"Get key insights about the data in your speadsheets",["IPWAI"]:Object(E.a)("AddInCategoryDescriptionImprovingProductivityWithAIExcel")||"Use the power of AI to capture and understand your data.",["FA"]:Object(E.a)("AddInCategoryDescriptionFinancialAnalytics")||"Track expenses, budget, and more."},
["PowerPoint"]:{["IPWAI"]:Object(E.a)("AddInCategoryDescriptionImprovingProductivityWithAIPowerPoint")||"Use the power of AI in your presentations.",["APID"]:Object(E.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsPowerPoint")||"Add photos, icons, and diagrams to slides.",["CAIP"]:Object(E.a)("AddInCategoryDescriptionCreatingAnInteractivePresentation")||"Add polls, timers, and more.",["DWT"]:Object(E.a)("AddInCategoryDescriptionDesigningWithTemplates")||"Create beautiful slides with templates you can customize."},
shared:{["BBM"]:Object(E.a)("AddInCategoryDescriptionBuildByMicrosoft")||"Create surveys, visualize data, and more, all from Microsoft.",["TD"]:Object(E.a)("AddInCategoryDescriptionTrending")||"Recently added by others.",["WN"]:Object(E.a)("AddInCategoryDescriptionWhatsNew")||"Brand new or updated add ins.",["PAIYO"]:Object(E.a)("AddInCategoryDescriptionPopularAddinsInYourOrg")||"Add ins people add and use the most in your organization."}});class M{constructor(vb){this.ELa=vb}next(vb){this.ELa=(9301*
this.ELa+49297)%233280;return Math.floor(this.ELa/233280*vb)}}Object(y.a)(M,"Random",null,[]);class N{constructor(vb){this.HF=vb;this.h3b=new Set;this.Tva=[];this.Wxf=F.a.instance;this.context=new H(G.AFrameworkApplication.ha)}hUg(vb){(this.context.bTb||this.context.Yeb)&&this.Tva.includes(vb)&&(this.h3b.add(vb),vb={["solutionId"]:[r(this.HF.HO(vb))],["IsUpgraded"]:this.HF.getUpgradedAddinsOfOmex().has(vb).toString()},this.rib(vb,"ClickNotificationAddins"))}eZf(vb){const ec=this.HF.getUpgradedAddinsOfOmex(),
lb=this.Wxf.Xpd,Zb=vb.filter(qc=>lb.has(qc)&&!this.h3b.has(qc));vb=vb.filter(qc=>ec.has(qc)&&!this.h3b.has(qc));return{Byf:Zb,ozh:vb}}addNotification(vb){if(this.context.bTb||this.context.Yeb){var {Byf:ec,ozh:lb}=this.eZf(vb.map(Zb=>Zb.solutionId));this.Tva=[];this.context.bTb&&(d(lb),this.Tva.push(...lb));this.context.Yeb&&(d(lb),this.Tva.push(...lb),e(ec),this.Tva.push(...ec));0!==this.Tva.length&&(vb={["Upgraded"]:this.context.Yeb?lb.map(Zb=>r(this.HF.HO(Zb))):[],["AdminInstalled"]:ec.map(Zb=>
r(this.HF.HO(Zb)))},this.rib(vb,"ShowNotificationAddins"))}}rib(vb,ec){B.a.sendTelemetryEvent(Object.assign(new w.a,{name:`Office.Extensibility.Host.${ec}`,dataFields:A.a.Gt(vb)}))}}Object(y.a)(N,"AppsInFlyoutNotificationManager",null,[]);var I=a(21),O=a(57),Q=a(240),U=a(742),ba=a(411),aa=a(598);class La{constructor(vb,ec,lb){this.amountToShowWhenCollapsed=vb;this.expandButton=ec;this.collapseButton=lb}}Object(y.a)(La,"GallerySectionCollapse",null,[]);var Z=a(1116),la=a(1099);class da{constructor(){this.text=
this.href=null}}Object(y.a)(da,"LinkProps",null,[]);class J{constructor(){this.icon=this.text=this.href=null}}Object(y.a)(J,"LinkWithLabelProps",null,[]);var Ca=a(341),Fa=a(291),ya=a(743),Ua=a(741),Ia=a(142),Oa=a(64),ma=a(620),za=a(496);const Qa="wa102927044 wa102957661 wa102957665 wa103147117 wa103296784 wa103304320 wa103651566 wa103863850 wa103982217 wa103982219 wa103982221 wa103985973 wa103996219 wa104003812 wa104006972 wa104017332 wa104032712 wa104036095 wa104038832 wa104041485 wa104051163 wa104092360 wa104096858 wa104099688 wa104100404 wa104104476 wa104114212 wa104150553 wa104151288 wa104152457 wa104152459 wa104152461 wa104152463 wa104152465 wa104152467 wa104152469 wa104152471 wa104152876 wa104152878 wa104152880 wa104152882 wa104152884 wa104157773 wa104160363 wa104181413 wa104184267 wa104187975 wa104190317 wa104191381 wa104192851 wa104195705 wa104198124 wa104199815 wa104212571 wa104225427 wa104311014 wa104356783 wa104363180 wa104363616 wa104367607 wa104368114 wa104371266 wa104374243 wa104374368 wa104376997 wa104379036 wa104379039 wa104379040 wa104379121 wa104379169 wa104379190 wa104379193 wa104379231 wa104379279 wa104379471 wa104379481 wa104379498 wa104379502 wa104379518 wa104379533 wa104379534 wa104379558 wa104379572 wa104379601 wa104379629 wa104379638 wa104379640 wa104379673 wa104379710 wa104379714 wa104379716 wa104379751 wa104379790 wa104379804 wa104379806 wa104379830 wa104379842 wa104379850 wa104379852 wa104379857 wa104379861 wa104379873 wa104379912 wa104379941 wa104379942 wa104379951 wa104379952 wa104379955 wa104379999 wa104380006 wa104380081 wa104380084 wa104380090 wa104380099 wa104380100 wa104380101 wa104380110 wa104380123 wa104380126 wa104380142 wa104380186 wa104380211 wa104380256 wa104380257 wa104380263 wa104380274 wa104380281 wa104380330 wa104380379 wa104380386 wa104380392 wa104380393 wa104380415 wa104380479 wa104380548 wa104380590 wa104380711 wa104380801 wa104380839 wa104380848 wa104380862 wa104380871 wa104380961 wa104380977 wa104380991 wa104380992 wa104381030 wa104381039 wa104381071 wa104381080 wa104381100 wa104381177 wa104381207 wa104381208 wa104381227 wa104381270 wa104381350 wa104381500 wa104381504 wa104381514 wa104381516 wa104381558 wa104381567 wa104381587 wa104381641 wa104381695 wa104381701 wa104381705 wa104381761 wa104381821 wa104381856 wa104381859 wa104381885 wa104381893 wa104381955 wa104382017 wa104382019 wa104382048 wa104382054 wa200000004 wa200000025 wa200000075 wa200000113 wa200000125 wa200000142 wa200000176 wa200000190 wa200000193 wa200000209 wa200000310 wa200000387 wa200000388 wa200000541 wa200000775 wa200000934 wa200001032 wa200001086 wa200001383 wa200001387 wa200001565 wa200001627 wa200001657 wa200001672 wa200001685 wa200001709 wa200001788 wa200001789 wa200001816 wa200001847 wa200001937 wa200001947 wa200001997 wa200002110 wa200002197 wa200002205 wa200002346 wa200002378 wa200002381 wa200002407 wa200002427 wa200002445 wa200002494 wa200002503 wa200002575 wa200002577 wa200002628 wa200002631 wa200002648 wa200002698 wa200002736 wa200002772 wa200002797 wa200002808 wa200002929 wa200002934 wa200003035 wa200003082 wa200003087 wa200003098 wa200003121 wa200003225 wa200003269 wa200003324 wa200003369 wa200003386 wa200003402 wa200003476 wa200003520 wa200003595 wa200003599 wa200003637 wa200003648 wa200003666 wa200003670 wa200003692 wa200003693 wa200003696 wa200003731 wa200003732 wa200003812 wa200003821 wa200003903 wa200003987 wa200003990 wa200004040 wa200004043 wa200004078 wa200004096 wa200004133 wa200004136 wa200004285 wa200004415 wa200004426 wa200004465 wa200004466 wa200004483 wa200004571 wa200004577 wa200004580 wa200004597 wa200004600 wa200004602 wa200004618 wa200004622 wa200004651 wa200004684 wa200004687 wa200004702 wa200004703 wa200004707 wa200004713 wa200004749 wa200004755 wa200004798 wa200004835 wa200004858 wa200004866 wa200004867 wa200004884 wa200004894 wa200004899 wa200004923 wa200004931 wa200004946 wa200004977 wa200004983 wa200004993 wa200005010 wa200005018 wa200005040 wa200005075 wa200005095 wa200005105 wa200005148 wa200005172 wa200005178 wa200005186 wa200005194 wa200005222 wa200005223 wa200005228 wa200005233 wa200005264 wa200005299 wa200005332 wa200005334 wa200005400 wa200005409 wa200005410 wa200005416 wa200005426 wa200005429 wa200005433 wa200005478 wa200005481 wa200005496 wa200005503 wa200005505 wa200005506 wa200005577 wa200005582 wa200005611 wa200005647 wa200005653 wa200005694 wa200005695 wa200005702 wa200005705 wa200005777 wa200005783 wa200005794 wa200005810 wa200005813 wa200005862 wa200005866 wa200005920 wa200005962 wa200006007 wa200006008 wa200006010 wa200006068 wa200006083 wa200006111 wa200006113 wa200006141 wa200006150 wa200006170 wa200006179 wa200006191 wa200006220 wa200006229 wa200006242".split(" "),
Xa="wa104281577 wa104295828 wa104323558 wa104356783 wa104363477 wa104363616 wa104379193 wa104379231 wa104379264 wa104379474 wa104379481 wa104379673 wa104379714 wa104379772 wa104379790 wa104379804 wa104379806 wa104379830 wa104379852 wa104379951 wa104379987 wa104379997 wa104380121 wa104380181 wa104380256 wa104380274 wa104380278 wa104380375 wa104380510 wa104380781 wa104380844 wa104380848 wa104380862 wa104380871 wa104380907 wa104381025 wa104381029 wa104381139 wa104381331 wa104381335 wa104381350 wa104381526 wa104381558 wa104381814 wa104382059 wa104382064 wa200000113 wa200000125 wa200000410 wa200000724 wa200000729 wa200000745 wa200001086 wa200001661 wa200001937 wa200001943 wa200002185 wa200002197 wa200002274 wa200002329 wa200002388 wa200002433 wa200003233 wa200003251 wa200003520 wa200003574 wa200003599 wa200003602 wa200003619 wa200003666 wa200003732 wa200003821 wa200003903 wa200003912 wa200003915 wa200004040 wa200004465 wa200004497 wa200004551 wa200004578 wa200004648 wa200004675 wa200004677 wa200004764 wa200004771 wa200004784 wa200004798 wa200004858 wa200004984 wa200005030 wa200005040 wa200005159 wa200005220 wa200005264 wa200005359 wa200005373 wa200005496 wa200005503 wa200005542 wa200005559 wa200005566 wa200005628 wa200005638 wa200005653 wa200005694 wa200005793 wa200005801 wa200005812 wa200005921 wa200005928 wa200006046 wa200006179".split(" "),
Tb="wa103296784 wa103863850 wa104051163 wa104099688 wa104374368 wa104376108 wa104379279 wa104379345 wa104379572 wa104379601 wa104379640 wa104379673 wa104379714 wa104379752 wa104379764 wa104379772 wa104379790 wa104379806 wa104379821 wa104379852 wa104379860 wa104379861 wa104379874 wa104379931 wa104379944 wa104379951 wa104379984 wa104379987 wa104379988 wa104379997 wa104380006 wa104380094 wa104380099 wa104380121 wa104380140 wa104380256 wa104380274 wa104380278 wa104380284 wa104380302 wa104380375 wa104380500 wa104380677 wa104380778 wa104380788 wa104380802 wa104380829 wa104380844 wa104380848 wa104380862 wa104380914 wa104380941 wa104380973 wa104380974 wa104380976 wa104380992 wa104380997 wa104381005 wa104381029 wa104381062 wa104381232 wa104381269 wa104381302 wa104381321 wa104381328 wa104381335 wa104381350 wa104381408 wa104381439 wa104381471 wa104381519 wa104381603 wa104381612 wa104381648 wa104381658 wa104381684 wa104381739 wa104381769 wa104381774 wa104381821 wa104381860 wa104381904 wa104381905 wa104381923 wa104381926 wa104381963 wa104381967 wa104382059 wa104382081 wa104382089 wa200000011 wa200000030 wa200000031 wa200000040 wa200000048 wa200000086 wa200000113 wa200000125 wa200000137 wa200000149 wa200000156 wa200000171 wa200000194 wa200000204 wa200000310 wa200000398 wa200000410 wa200000540 wa200000680 wa200000729 wa200000741 wa200000776 wa200001000 wa200001042 wa200001066 wa200001086 wa200001169 wa200001177 wa200001298 wa200001361 wa200001482 wa200001491 wa200001524 wa200001547 wa200001629 wa200001806 wa200001937 wa200001943 wa200001998 wa200002029 wa200002125 wa200002172 wa200002197 wa200002237 wa200002291 wa200002296 wa200002420 wa200002424 wa200002442 wa200002476 wa200002477 wa200002492 wa200002500 wa200002573 wa200002609 wa200002643 wa200002654 wa200002694 wa200002730 wa200002864 wa200002866 wa200002910 wa200002912 wa200003026 wa200003128 wa200003143 wa200003144 wa200003275 wa200003334 wa200003416 wa200003418 wa200003500 wa200003520 wa200003523 wa200003543 wa200003553 wa200003554 wa200003574 wa200003578 wa200003590 wa200003599 wa200003623 wa200003626 wa200003634 wa200003648 wa200003654 wa200003666 wa200003702 wa200003732 wa200003773 wa200003812 wa200003817 wa200003821 wa200003829 wa200003846 wa200003871 wa200003901 wa200003902 wa200003903 wa200003912 wa200003915 wa200003947 wa200003951 wa200003962 wa200003975 wa200003988 wa200003994 wa200004002 wa200004010 wa200004011 wa200004014 wa200004040 wa200004044 wa200004046 wa200004097 wa200004098 wa200004104 wa200004111 wa200004131 wa200004178 wa200004195 wa200004216 wa200004316 wa200004382 wa200004420 wa200004424 wa200004427 wa200004448 wa200004466 wa200004471 wa200004475 wa200004510 wa200004535 wa200004537 wa200004547 wa200004567 wa200004591 wa200004606 wa200004623 wa200004635 wa200004685 wa200004696 wa200004702 wa200004713 wa200004753 wa200004786 wa200004819 wa200004845 wa200004858 wa200004865 wa200004872 wa200004923 wa200004942 wa200004996 wa200005040 wa200005041 wa200005063 wa200005082 wa200005097 wa200005114 wa200005154 wa200005177 wa200005191 wa200005208 wa200005248 wa200005260 wa200005264 wa200005279 wa200005283 wa200005298 wa200005302 wa200005321 wa200005323 wa200005327 wa200005328 wa200005332 wa200005339 wa200005347 wa200005351 wa200005357 wa200005373 wa200005377 wa200005414 wa200005444 wa200005451 wa200005458 wa200005496 wa200005503 wa200005567 wa200005644 wa200005653 wa200005694 wa200005736 wa200005779 wa200005804 wa200005826 wa200005849 wa200005869 wa200005874 wa200005896 wa200005903 wa200005957 wa200005973 wa200006057 wa200006060 wa200006081 wa200006093 wa200006108 wa200006135 wa200006164 wa200006167 wa200006179 wa200006209 wa200006213 wa200006240".split(" ");
var Kb=a(25),nb=a(198),Ka=a(181);class Sb{constructor(vb,ec,lb){this.izf="appsource";this.primaryKey="f45d712d6617b7e2b2f1fb0fc9757fa1eb384d7f03f6740a1a474b3ccf95b5d8";this.thh="99b3e3778ca726c8bd5b4b1b6aa137358f0902d731079ca80e28f79a25d3870a";this.Ga=vb;this.LY=ec;this.mlf=void 0===lb?"en":lb;this.ng=new H(this.Ga);this.ahd=this.nDf();this.FF={};this.Zgf=this.ng.dyf}ssd(vb,ec,lb,Zb,qc){Zb=void 0===Zb?15:Zb;qc=void 0===qc?!1:qc;var pc=new nb.QueryStringBuilder("search"),ac={"api-version":"2023-01-01-preview",
gallery:"AppSourceApps",productTypes:"Office365",Market:"ALL",select:"UniqueProductId,DisplayName,LongSummary,SmallIconUri,Popularity"};ac.applicableProducts=this.LY;ac.Language=this.mlf;ac.searchQuery=vb;ac.top=Zb.toString();this.Aid("AppSource",ac);for(const Jb in ac)pc.ej(Jb,ac[Jb]);pc="https://catalogapi.azure.com/"+pc.toString();ac={};ac["X-API-Key"]=qc?this.thh:this.primaryKey;ac["X-ms-app"]=this.izf;const gb=window.performance.now();this.executeRequest(pc,1,ac,Jb=>{let uc="Query Succeeded",
Cc=!0,Gc=0;const dd=[],ld=[];Jb=Jb.data.responseData;try{var bc=JSON.parse(Jb);Gc=bc.totalCount;const cc=bc.results;for(bc=0;bc<cc.length;bc++){const Vc=cc[bc],td={};td.solutionId=Vc.uniqueProductId.toLowerCase();td.displayName=Vc.displayName;td.description=Vc.longSummary;td.iconUrl=Vc.smallIconUri;td.assetId=td.solutionId;td.storeId="en-US";td.storeType="omex";td.assetStoreId="omex";dd.push(td);this.FF[td.solutionId]=td;ld.push(Vc.popularity)}}catch(cc){uc="Exception thrown from Json parse for responseData: "+
Jb+". Exception: "+cc,Cc=!1}this.Mgb(0<vb.length,lb,"AppSource",Cc,uc,window.performance.now()-gb,Gc,dd,ld);ec(Cc,dd)},Jb=>{const uc=[];this.Mgb(0<vb.length,lb,"AppSource",!1,`Query Failed, httpStatus: ${Jb.data.Je}, responseData: ${Jb.data.responseData}`,window.performance.now()-gb,0,uc);qc||Jb.data.Je!==Ka.a.COe?ec(!1,uc):this.ssd(vb,ec,lb,Zb,!0)})}ohh(vb){var ec=void 0===ec?15:ec;return new Promise((lb,Zb)=>{this.ssd(vb,(qc,pc)=>{qc?lb(pc):Zb()},Date.now(),ec)})}tsd(vb,ec,lb,Zb,qc){Zb=void 0===
Zb?"":Zb;qc=void 0===qc?15:qc;const pc=new nb.QueryStringBuilder("api/addins/search"),ac={apiversion:"1.0"};0<vb.length&&(ac.qu=vb);0<Zb.length&&(ac.assetids=Zb);ac.client="WAC_"+this.LY;ac.cv=G.AFrameworkApplication.buildVersion;ac.top=qc.toString();this.Aid("OMEX",ac);for(const Jb in ac)pc.ej(Jb,ac[Jb]);Zb="https://api.addins.omex.office.net/"+pc.toString();const gb=window.performance.now();this.executeRequest(Zb,1,null,Jb=>{let uc="Query Succeeded",Cc=!0,Gc=0;const dd=[];Jb=Jb.data.responseData;
try{var ld=JSON.parse(Jb);Gc=ld.TotalCount;const bc=ld.Values;for(ld=0;ld<bc.length;ld++){const cc=bc[ld],Vc={};Vc.solutionId=cc.Id.toLowerCase();Vc.displayName=cc.Title;Vc.description=cc.ShortDescription;Vc.iconUrl=cc.IconUrl;Vc.assetId=Vc.solutionId;Vc.storeId="en-US";Vc.storeType="omex";Vc.assetStoreId="omex";Vc.version=cc.Version;Vc.targetType=cc.Shape-1;Vc.height=cc.Height;Vc.width=cc.Width;dd.push(Vc);this.FF[Vc.solutionId]=Vc}}catch(bc){uc="Exception thrown from Json parse for responseData: "+
Jb+". Exception: "+bc,Cc=!1}this.Mgb(0<vb.length,lb,"OMEX",Cc,uc,window.performance.now()-gb,Gc,dd);ec(Cc,dd)},Jb=>{const uc=[];this.Mgb(0<vb.length,lb,"OMEX",!1,`Query Failed, httpStatus: ${Jb.data.Je}, responseData: ${Jb.data.responseData}`,window.performance.now()-gb,0,uc);ec(!1,uc)})}phh(vb){var ec=void 0===ec?"":ec;var lb=void 0===lb?15:lb;return new Promise((Zb,qc)=>{this.tsd(vb,(pc,ac)=>{pc?Zb(ac):qc()},Date.now(),ec,lb)})}HO(vb){return this.FF[vb.toLowerCase()]?this.FF[vb.toLowerCase()]:null}executeRequest(vb,
ec,lb,Zb,qc){return G.AFrameworkApplication.$d.ik(vb,ec,null,void 0===lb?null:lb,!1,2,Zb,qc,null,null,!1,null,this.Zgf)}Mgb(vb,ec,lb,Zb,qc,pc,ac,gb,Jb){vb={["hasSearchValue"]:null===vb||void 0===vb?void 0:vb.toString(),["searchStartTime"]:null===ec||void 0===ec?void 0:ec.toString(),["apiSource"]:lb,["responseSuccess"]:null===Zb||void 0===Zb?void 0:Zb.toString(),["responseInfo"]:qc,["timeElapsed"]:null===pc||void 0===pc?void 0:pc.toString(),["totalCount"]:null===ac||void 0===ac?void 0:ac.toString(),
["solutionIds"]:gb.map(uc=>this.SJf(uc)),["popularity"]:Jb?Jb:[]};B.a.sendTelemetryEvent(Object.assign(new w.a,{name:"Office.Extensibility.Host.SearchApiMetrics",dataFields:A.a.Gt(vb)}))}SJf(vb){return Telemetry.PrivacyRules.GetPrivacyCompliantId(vb.solutionId,vb.storeType,vb.assetId,null,null,vb.storeId)}nDf(){let vb=this.ng.s2g;if(1>=vb.length)return{};v.ULS.sendTraceTag(507785891,220,50,"BuildSearchQueryParametersOverrides: overrideString: {0}.",vb);const ec={};let lb=!0,Zb="";vb=vb.trim();try{const qc=
vb.split("$");for(let pc=0;pc<qc.length&&lb;pc++){const ac=qc[pc].split(":");if(2!==ac.length){Zb="Invalid override string format: "+qc[pc];lb=!1;break}const gb=ac[0].trim(),Jb=[],uc=ac[1].split("|");for(let Cc=0;Cc<uc.length&&lb;Cc++){const Gc=uc[Cc],dd=Gc.split("\\");if(2<dd.length){Zb="Invalid override string format: "+Gc;lb=!1;break}const ld=dd[0].trim(),bc=2===dd.length?dd[1].trim():null;Array.add(Jb,new Kb.a(ld,bc))}ec[gb]=Jb}}catch(qc){Zb="Failed in parsing the overrideString: "+vb+". Exception: "+
qc.toString(),lb=!1}if(lb)return ec;v.ULS.sendTraceTag(507785890,220,10,"Build override failed: {0}.",Zb);return{}}Aid(vb,ec){if(this.ahd[vb]){vb=this.ahd[vb];for(let lb=0;lb<vb.length;lb++){const Zb=vb[lb].key,qc=vb[lb].value;qc?ec[Zb]=qc:delete ec[Zb]}}}}Object(y.a)(Sb,"AddinSearchApiManager",null,[]);var ab=a(340);class ub{constructor(){this.r1=vb=>{var ec;if(null===vb||null===vb.Pb)return!1;vb=vb.Pb.target;for(this.gYb=void 0;null!=vb&&vb.getAttribute;){void 0===this.gYb&&0<(null===(ec=vb.id)||
void 0===ec?void 0:ec.length)&&(this.gYb=vb.id);if(null!=vb.getAttribute("data-contextmenu-id"))break;vb=vb.parentNode}return!1}}get currentTarget(){return this.gYb}fng(){ab.a.instance.Ub(window.document.body,this.r1,null)}dispose(){ab.a.instance.hc(window.document.body,this.r1)}}Object(y.a)(ub,"AppFlyoutGeneratorContextMenuListener",null,[]);var Aa;(function(vb){vb[vb.KHl=0]="S_OK";vb[vb.KGl=-2147471590]="E_REQUEST_TIME_OUT";vb[vb.LGl=-2147208619]="E_USER_NOT_SIGNED_IN";vb[vb.CGl=-2147471591]="E_CATALOG_ACCESS_DENIED";
vb[vb.EGl=-2147471589]="E_CATALOG_REQUEST_FAILED";vb[vb.HGl=-2147208640]="E_OEM_NO_NETWORK_CONNECTION";vb[vb.JGl=-2147208617]="E_PROVIDER_NOT_REGISTERED";vb[vb.GGl=-2147208637]="E_OEM_CACHE_SHUTDOWN";vb[vb.IGl=-2147209421]="E_OEM_REMOVED_FAILED";vb[vb.DGl=-1]="E_CATALOG_NO_APPS";vb[vb.MGl=-2]="E_USER_NO_MAILBOX";vb[vb.FGl=-1E3]="E_GENERIC_ERROR";vb[vb.JHl=10]="S_HIDE_PROVIDER"})(Aa||(Aa={}));Object(y.b)("InvokeResultCode",Aa);class tb{constructor(vb,ec){this.Ga=ec;this.HA=vb}get Tnh(){return this.Ga?
this.Ga.isChangeGateEnabled("OfficeVSO:8511220_showPopularOnFailForGuests"):!1}ctd(vb){return this.Tnh?vb.failure?-2147208619===vb.failure.invokeResultCode:!1:!1}Cld(vb,ec){return`invokeFailure/${3===vb.errorCode&&vb.failure?Aa[vb.failure.invokeResultCode]:""}/${3===ec.errorCode&&ec.failure?Aa[ec.failure.invokeResultCode]:""}`}Cnd(vb,ec,lb,Zb){vb={["Source"]:this.HA,["MRUListNumber"]:vb.toString(),["MyAddinsErrorCode"]:za.a[ec.errorCode],["MyAddInsResult"]:ec.Io.length.toString(),["MyAddinsInvokeResultCode"]:ec.failure?
ec.failure.invokeResultCode:"N/A",["AdminManagedErrorCode"]:za.a[lb.errorCode],["AdminManagedResult"]:lb.Io.length.toString(),["AdminManageInvokeResultCode"]:lb.failure?lb.failure.invokeResultCode:"N/A",["PopularAddinsErrorCode"]:Zb?za.a[Zb.errorCode]:"N/A",["PopularAddinsResult"]:Zb?Zb.Io.length.toString():"N/A",["PopularAddinsInvokeResultCode"]:Zb&&Zb.failure?Zb.failure.invokeResultCode:"N/A"};this.ymh&&(vb.MyAddinsQueryStart=this.Xfb(ec.failure),vb.AdminManagedQueryStart=this.Xfb(lb.failure),vb.PopularQueryStart=
this.Xfb(Zb.failure));B.a.sendTelemetryEvent(Object.assign(new w.a,{name:"Office.Extensibility.Host.AddinEntryPointDisplayMetrics",dataFields:A.a.Gt(vb)}))}Bnd(vb,ec,lb,Zb,qc){lb={["MyAddinsResult"]:this.VTb(lb),["AdminManagedResult"]:this.VTb(Zb),["PopularResult"]:this.VTb(qc)};vb={["Source"]:this.HA,["Abnormals"]:ec.join("|"),["NumAddinsInMRU"]:vb.toString(),["DiagnosticDetails"]:JSON.stringify(lb)};B.a.sendTelemetryEvent(Object.assign(new w.a,{name:"Office.Extensibility.Host.AddinEntryPointAceMetrics",
dataFields:A.a.Gt(vb)}))}VTb(vb){return{["Count"]:vb.Io.length.toString(),["QueryStart"]:this.Xfb(vb.failure),["ErrorCode"]:za.a[vb.errorCode],["InvokeResultCode"]:vb.failure?vb.failure.invokeResultCode:"N/A"}}get utd(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8393563_FlyoutTelemetryOptimizationEnabled")}get znd(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8581842_LogAceMetricsEnabled")}Xfb(vb){let ec="N/A";vb&&vb.queryStart&&window.performance.timeOrigin&&(ec=(new Date(window.performance.timeOrigin+
vb.queryStart)).toISOString());return ec}get ymh(){return this.Ga?this.Ga.isChangeGateEnabled("OfficeVSO:8546535_LogQueryStartEnabled"):!1}}Object(y.a)(tb,"AddinEntryPointCommon",null,[]);const kc={["WF"]:"wa200004216 wa200005106 wa200005817 wa200005983 wa104380122 wa200001011 wa104381727 wa200001361 wa104382081 wa200000011 wa200000199 wa200000368".split(" "),["IPWAI"]:"wa104381714 wa200005107 wa200005287 wa200005312 wa200005313 wa200005444 wa200005826 wa200006000 wa200006001 wa200005826 wa200005502 wa200001011 wa200001361 wa200000368".split(" "),
["ER"]:"wa104380848 wa104380917 wa104381909 wa200001482 wa200002334 wa200002534 wa200002891 wa200004257".split(" "),["APID"]:"wa104051163 wa104178141 wa104379279 wa104379370 wa104379997 wa104380118 wa104380121 wa104381063 wa104381411 wa200000113 wa200002281".split(" ")};class dc{constructor(vb,ec,lb){this.ng=vb;this.uO=ec;this.gK={};this.YJa={};this.rQb={};if(this.ng.A2||this.ng.Xeb){this.gK=lb;this.lAf();this.fAf();vb=this.ng.r2g;try{const Zb=vb.split("|");vb={};for(ec=0;ec<Zb.length;ec+=2)vb[Zb[ec]]=
Zb[ec+1];this.rQb=vb}catch(Zb){}}}get cGf(){return this.gK}lAf(){const vb={};var ec=this.ng.p2g;if(!(1>=ec.length)){v.ULS.sendTraceTag(507589127,220,50,"BuildCategoryAddinDetailOverrides: overrideString: {0}.",ec);var lb=!0,Zb="";ec=ec.trim();try{const qc=ec.split("$");for(let pc=0;pc<qc.length&&lb;pc++){const ac=qc[pc].split(":");if(2<ac.length){Zb="Invalid override string format: "+qc[pc];lb=!1;break}const gb=ac[0].trim(),Jb=[];if(2===ac.length){const uc=ac[1].split("|");for(let Cc=0;Cc<uc.length&&
lb;Cc++){const Gc=uc[Cc],dd=Gc.split("\\");if(2>dd.length||5<dd.length){Zb="Invalid override string format: "+Gc;lb=!1;break}const ld=dd[0].trim(),bc={};for(let cc=1;cc<dd.length&&lb;cc++)if(0<dd[cc].trim().length)switch(cc){case 1:bc.priority=parseInt(dd[cc].trim());break;case 2:bc.AUP=parseInt(dd[cc].trim());break;case 3:bc.diffAUP=parseInt(dd[cc].trim());break;case 4:const Vc=dd[cc].trim();if(8!==Vc.length){Zb="Invalid override string format: "+Vc;lb=!1;break}bc.releaseDate=(new Date(parseInt(Vc.substring(0,
4)),parseInt(Vc.substring(4,6))-1,parseInt(Vc.substring(6)))).getTime();break;default:Zb="Invalid override string format: "+Gc,lb=!1}if(!lb)break;Array.add(Jb,{solutionId:ld,addinInfo:bc})}}this.gK[gb]&&(vb[gb]=Jb)}}catch(qc){Zb="Failed in parsing the overrideString: "+ec+". Exception: "+qc.toString(),lb=!1}if(lb){for(const qc in vb){if(!this.gK[qc])continue;const pc=vb[qc];ec=this.gK[qc].filter(ac=>!pc.some(gb=>gb.solutionId.toLowerCase()===ac.solutionId.toLowerCase()));Array.addRange(pc,ec)}this.gK=
vb}else v.ULS.sendTraceTag(507589126,220,10,"Override Failed: {0}.",Zb)}}fAf(){for(const vb in this.gK){const ec=this.gK[vb];for(let lb=0;lb<ec.length;lb++){const Zb=ec[lb];Zb.addinInfo||(Zb.addinInfo={});if(!Zb.addinInfo.priority||isNaN(Zb.addinInfo.priority))Zb.addinInfo.priority=0;if(!Zb.addinInfo.AUP||isNaN(Zb.addinInfo.AUP))Zb.addinInfo.AUP=0;if(!Zb.addinInfo.diffAUP||isNaN(Zb.addinInfo.diffAUP))Zb.addinInfo.diffAUP=0;if(!Zb.addinInfo.releaseDate||isNaN(Zb.addinInfo.releaseDate))Zb.addinInfo.releaseDate=
0}}}QZf(){if(!this.gK||0===Object.keys(this.gK).length)return v.ULS.sendTraceTag(507589125,220,15,"The category add-in ids mapping is empty."),{};if(Object.keys(this.YJa).length!==Object.keys(this.gK).length){const ec=[],lb={};for(const Zb in this.gK){if("PAIYO"===Zb){var vb=this.uO.CD(1);0===vb.errorCode&&(vb=vb.Io)&&0<vb.length&&(lb[Zb]=vb);continue}if(this.YJa[Zb]){lb[Zb]=this.YJa[Zb];continue}vb=this.gK[Zb];if(!vb||0===vb.length){v.ULS.sendTraceTag(507589124,220,15,"The addin content list is empty for category: {0}.",
Zb);continue}const qc=[];for(let pc=0;pc<vb.length;pc++){const ac=vb[pc],gb=this.uO.HO(ac.solutionId);if(!ac.addinInfo||-1===ac.addinInfo.priority||!gb||-1===gb.addinInfo.priority)continue;if(!gb){Array.add(ec,ac.solutionId);continue}const Jb={};Jb.solutionId=gb.solutionId;Jb.version=gb.version;Jb.storeType=gb.storeType;Jb.storeId=gb.storeId;Jb.assetId=gb.assetId;Jb.assetStoreId=gb.assetStoreId;Jb.displayName=gb.displayName;Jb.provider=gb.provider;Jb.description=gb.description;Jb.targetType=gb.targetType;
Jb.height=gb.height;Jb.width=gb.width;Jb.iconUrl=gb.iconUrl;Jb.webApplicationId=gb.webApplicationId;Jb.highResolutionIconUrl=gb.highResolutionIconUrl;Jb.addinInfo=ac.addinInfo;Array.add(qc,Jb)}0<qc.length&&("WN"===Zb?qc.sort((pc,ac)=>pc.addinInfo.releaseDate<ac.addinInfo.releaseDate?1:-1):"TD"===Zb?qc.sort((pc,ac)=>pc.addinInfo.diffAUP<ac.addinInfo.diffAUP?1:-1):qc.sort((pc,ac)=>pc.addinInfo.AUP<ac.addinInfo.AUP?1:-1),lb[Zb]=qc)}this.YJa=lb;0<ec.length&&v.ULS.sendTraceTag(507589123,220,10,"{0} AddinIds not found in mapping: {1}, collection length: {2}",
ec.length,ec.toString())}return this.YJa}Lrd(vb,ec,lb){return lb&&0<lb.length&&"PAIYO"!==vb?lb.filter(Zb=>!ec.some(qc=>qc.toLowerCase()===Zb.solutionId.toLowerCase())):lb}P_f(vb){let ec=null;var lb=this.QZf();if(lb&&0<Object.keys(lb).length){ec={};for(const qc in lb){const pc=lb[qc];ec[qc]=this.Lrd(qc,vb.map(ac=>ac.solutionId),pc)}const Zb=[];for(const qc in ec)if((vb=ec[qc])&&0<vb.length){vb=vb.filter(pc=>!Zb.some(ac=>ac.toLowerCase()===pc.solutionId.toLowerCase()));for(lb=0;lb<vb.length&&3>lb;lb++)Zb.push(vb[lb].solutionId);
ec[qc]=vb}}else v.ULS.sendTraceTag(507589122,220,15,"Category addins details dict is empty");return ec}xld(){const vb=this.ng.host,ec=this.ng.q2g;return ec?ec.split("|"):"Word"===vb?["WF","IPWAI","APID"]:"Excel"===vb?["DA","IPWAI","FA"]:"PowerPoint"===vb?["CAIP","IPWAI","ER"]:[]}W0f(vb,ec){var lb;const Zb=(null===(lb=kc[vb])||void 0===lb?void 0:lb.map(qc=>this.uO.HO(qc)))||[];return ec?this.Lrd(vb,ec,Zb):Zb}TZf(vb){if(this.rQb[vb])return this.rQb[vb];switch(vb){case "APIC":return"Insert Charts";case "APID":return"Insert Graphics";
case "BBM":return"Microsoft";case "CAIP":return"Interactive";case "DA":return"Data";case "DWT":return"Templates";case "ER":return"Education";case "FA":return"Financial";case "IPWAI":return"AI";case "PAIYO":return"Org";case "TD":return"Trending";case "WF":return"Writing Fluently";case "WN":return"New"}return"Popular"}lld(vb){var ec;const lb=this.ng.host;return this.ng.ZSb?(null===(ec=T()[lb])||void 0===ec?void 0:ec[vb])||T().shared[vb]||P()[vb]||P().default:P()[vb]||P().default}kld(vb){var ec;const lb=
this.ng.host;return(null===(ec=K()[lb])||void 0===ec?void 0:ec[vb])||K().shared[vb]||""}}Object(y.a)(dc,"AppFlyoutCategories",null,[]);var Db=a(232),sb=a(197),Qb=a(394);class $a{constructor(vb,ec){this.Xsf=vb;this.Ysf=ec}umg(){null==Qb.a.instance.getItem("AddinEntryPointSurveyShowed")&&window.setTimeout(()=>{this.zhd=Object(Db.a)();null!=this.zhd&&this.zhd.execute(vb=>{if(null==Qb.a.instance.getItem("AddinEntryPointSurveyShowed")){var ec=this.q1f();this.rZf()||ec&&(!ec||"hidden"!==ec.visibility)||
(vb.DEb(this.Xsf,null),Qb.a.instance.setItem("AddinEntryPointSurveyShowed","1"))}})},this.Ysf)}q1f(){let vb=null;try{const ec=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");ec&&(vb=sb.a.ps(ec.parentNode.parentNode.parentNode))}catch(ec){v.ULS.sendTraceTag(508343957,220,10,"AddinFlyout get parent and parent get exception "+(ec?ec.toString():""))}return vb}rZf(){let vb=null;try{vb=document.getElementById("BackstageGetAddIns")}catch(ec){v.ULS.sendTraceTag(508343956,220,10,"Backstage get parent and parent get exception "+
(ec?ec.toString():""))}return vb}}Object(y.a)($a,"FpsHelper",null,[]);class X{constructor(vb,ec,lb,Zb,qc,pc,ac,gb,Jb,uc){gb=void 0===gb?{}:gb;var Cc,Gc;this.$rd=uc;this.iOb={};this.web={};this.Igd=0;this.Fgd=null;this.Bgf=3E4;this.OJa={};this.zga=void 0;this.sgd=this.PJa=null;this.qhd="All";this.Kva="";this.Ieb=null;this.phd=100;this.Jeb=!1;this.DLa=[];this.jla=(dd,ld)=>{this.SS?this.Nah(ld):(this.Mah(ld),!this.ng.hWa&&this.ggd&&this.ggd.jla(dd,ld))};this.uO=ec;this.n2=null;this.Wlf=Zb;this.trf=qc;
this.ggd=void 0===ac?null:ac;this.Ga=(void 0===pc?null:pc)||G.AFrameworkApplication.ha;this.ng=new H(this.Ga);this.Gif=Jb;this.GX=new dc(this.ng,ec,gb);this.uO.cib(this.jla);(null===appChrome||void 0===appChrome?0:appChrome.addInApi)&&appChrome.addInApi.loadOfficeAddInIcons();this.ng.cyf&&m((dd,ld)=>{B.a.sendTelemetryEvent(x(w.a,{name:"Office.Extensibility.Host.AddInFlyoutOpenCloseChanged",dataFields:A.a.RCe({["PerformanceNow"]:performance.now(),["DateNow"]:new Date,["IsOpened"]:dd,["OpenDuration"]:ld})}))}).catch(dd=>
{v.ULS.sendTraceTag(507799683,220,15,"Failed to listen flyout open close event: "+((null===dd||void 0===dd?void 0:dd.toString())||void 0))});this.ng.B2&&(this.PJa=new Sb(this.Ga,this.Ga.Ma("Application")),this.phd=null!==(Gc=null===(Cc=this.Ga)||void 0===Cc?void 0:Cc.getIntFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchDebouncing",100))&&void 0!==Gc?Gc:100);this.ng.nid&&(this.sgd=new ub,this.sgd.fng());this.ng.B2&&this.ajh()}get zjd(){return this.web}Mah(vb){if(vb.Io)for(let ec=0;ec<
vb.Io.length;ec++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+vb.Io[ec].solutionId,vb.Io[ec].iconUrl);else 0===vb.errorCode&&v.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get SS(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8332954_FlyoutNotifyObserverFailuresEnabled")&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}njd(){if(this.ng.mMd)return!0;let vb=this.uO.CD(0);if(1!==
vb.errorCode)return!0;vb=this.uO.CD(1);return 1!==vb.errorCode}zZb(vb){const ec=this.ng.lfc,lb=ec?"more"===vb?"AddinFlyoutMoreButton":"AddinFlyoutLessButton":"AddinFlyoutMoreButton",Zb=ec?"more"===vb?Object(E.a)("AddinsFlyoutSeeAllButtonText"):Object(E.a)("AddinsFlyoutSeeLessButtonText"):Object(E.a)("AddinsFlyoutSeeAllButtonText");vb=ec?"more"===vb?Object(E.a)("AddinsPickerGalleryButtonMoreArialText"):Object(E.a)("AddinsPickerGalleryButtonLessArialText"):Object(E.a)("AddinsPickerGalleryButtonMoreArialText");
return Object.assign(new la.a,{Id:lb,ExternalId:lb,Icon:"AllApps_16",Command:this.trf,LabelText:Zb,FullIconStyle:{root:{maxWidth:"16px",maxHeight:"16px",minWidth:"16px",minHeight:"16px",border:"1px solid var(--border-color, #c8c8c8)",borderRadius:"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Role:"menuitem",Alt:vb})}f3f(vb,ec){var lb=void 0===lb?G.AFrameworkApplication.isRtl:lb;lb={["root"]:{["width"]:"32px",["height"]:"32px",["border-radius"]:"6px",["overflow"]:"hidden",["padding"]:"7px",
["border"]:"1px solid var(--border-color, #c8c8c8)",["direction"]:lb?"ltr":void 0}};return Object.assign(new la.a,{Id:ec,ExternalId:ec,Icon:"AddinFlyoutControl"+vb.solutionId,Command:this.Wlf,LabelText:vb.displayName,Role:"menuitem",FullIconStyle:lb,Alt:vb.description})}g3f(vb,ec){vb=this.Eld("MRUAddinsGalleryControl",vb,ec);return Object.assign(new Fa.a,{Id:"MRUAddinsSection",ControlsId:"MRUAddinsSection.Controls",ControlList:[vb],Title:Object(E.a)("MyAddinSection")})}Eld(vb,ec,lb,Zb){Zb=void 0===
Zb?this.ng.lfc:Zb;const qc=x(Z.a,{SectionId:vb+"Section",GalleryButtons:ec.map(pc=>this.f3f(pc,this.E1f(pc)))});Zb&&3<ec.length?qc.Collapse=new La(2,this.zZb("more"),this.zZb("less")):lb&&qc.GalleryButtons.push(this.zZb("more"));return x(aa.a,{Id:vb,ExternalId:vb,GalleryStyle:{["galleryStack"]:{["root"]:{margin:"0px",marginLeft:"12px",width:"100%",maxWidth:"unset"},["inner"]:{margin:"-4px",marginLeft:"0px",maxWidth:"333px",minWidth:"333px"}},["galleryButtonInExpanded"]:{["root"]:{width:100,height:100,
backgroundColor:"transparent"},["flexContainer"]:{flexDirection:"column"},["label"]:{marginTop:"4px",maxWidth:"86px",fontSize:"12px",textOverflow:"ellipsis"}}},Width:3,Type:4,GallerySections:[qc],GalleryContextMenu:this.ng&&this.ng.nid?{["primaryMenuId"]:"AddInFlyoutMRUContextMenu"}:null})}l3f(){const vb=x(Fa.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[x(Q.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:Object(E.a)("AddinsPickerFooterButtonMoreArialText")})]});
appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",Object(E.a)("AddinPickerButtonMore")));return vb}V0f(vb){var ec;vb=null===(ec=vb.map(Zb=>{const qc="AddInFlyoutFREBannerMenuLaunchAddin_"+Zb,pc=this.uO.HO(Zb);if(pc){var ac=ya.a,gb="1"===this.ng.aTb?null:{default:"AddinFlyoutControl"+pc.solutionId},Jb=O.a.Zlc.toString();a:{var uc,Cc,Gc;switch(this.ng.host){case "Excel":var dd=null!==(uc=Object(E.a)("AddinsFlyoutFREDescriptionExcel"))&&void 0!==uc?uc:"Boost your Excel expertise with these time-saving add-ins.";
break a;case "PowerPoint":dd=null!==(Cc=Object(E.a)("AddinsFlyoutFREDescriptionPPT"))&&void 0!==Cc?Cc:"Elevate your slides! Add-ins for flawless presentations.";break a;default:dd=null!==(Gc=Object(E.a)("AddinsFlyoutFREDescriptionWord"))&&void 0!==Gc?Gc:"Polish with precision! Add-ins perfect your grammar. Try now!"}}Zb=x(ac,{Id:qc,iconSet:gb,ExternalId:qc,CommandId:qc,CommandIdMapped:Jb,SecondaryLabel:null,Label:dd,ActionText:Object(E.a)("AddinListAdd"),Links:[x(da,{text:Object(E.a)("AddinOneLink"),
href:"https://appsource.microsoft.com/en-us/product/office/"+pc.solutionId})],ActionId:qc+"Add",ActionIdMapped:O.a.Nlc.toString(),ActionCommandValueId:Zb,CommandValueId:Zb})}else Zb=null;return Zb}))||void 0===ec?void 0:ec.filter(Zb=>!!Zb);if(0>=(null===vb||void 0===vb?void 0:vb.length))return null;if("1"===this.ng.aTb){ec=U.a;a:switch(this.ng.host){case "Word":var lb="FREWordBannerGrammarly";break a;case "Excel":lb="FREBannerGPTForExcelWord";break a;default:lb="FlyoutBannerCommon"}ec=x(ec,{Id:"FREBanner",
ExternalId:"FREBanner",IconName:lb,Label:null});return x(Fa.a,{ControlList:[ec,...vb]})}return x(Fa.a,{ControlList:[...vb]})}SZf(){this.qhd="All";c("ButtonGroupHighlight",`#${`${"AddinFREButton"}${this.qhd}`}[type="button"] { font-weight: 600; background-color: var(--legacy_themeDark); color: white; }`);var vb=["All",...this.GX.xld()];vb=x(Z.a,{SectionId:"AddinFlyoutButtonGroupSection",GalleryButtons:vb.map(ec=>{const lb=this.GX.TZf(ec);return Object.assign(new la.a,{Id:"AddinFREButton"+ec,ExternalId:"AddinFREButton"+
ec,Command:O.a.L0h.toString(),LabelText:lb,FullIconStyle:{["root"]:{position:"absolute",["border-radius"]:"10px",width:"100%",height:"100%"}},Role:"menuitem",Alt:lb})})});vb=x(aa.a,{Id:"AddinFlyoutButtonGroup",ExternalId:"AddinFlyoutButtonGroup",GalleryStyle:{["galleryStack"]:{["root"]:{margin:"0px",width:"100%",maxWidth:"unset"},["inner"]:{k1l:2,maxWidth:"333px",minWidth:"333px",flexFlow:"nowrap",paddingLeft:15}},["galleryButtonInExpanded"]:{["root"]:{backgroundColor:"transparent",width:"unset",
height:"unset",borderRadius:"10px",borderColor:"var(--border-color)",borderWidth:"1px !important",padding:"4px 8px"},["flexContainer"]:{},["label"]:{fontSize:"12px",textOverflow:"ellipsis"}}},Type:4,GallerySections:[vb],DismissHostingSurfaceOnExecute:!1});return x(Fa.a,{ControlList:[vb]})}n3f(vb){var ec,lb,Zb;const qc=[],pc=[],ac=this.uO.CD(0);Array.addRange(pc,ac.Io);const gb=this.uO.CD(1);let Jb=!1;this.ng.A2&&this.GX.cGf.PAIYO||(Jb=!0);Jb&&Array.addRange(pc,gb.Io);vb||pc.sort((Ja,Lb)=>{Ja=Ia.d(Ja.displayName);
Lb=Ia.d(Lb.displayName);return Oa.a.localeCompare(Ja,Lb)});null===(ec=this.Gif)||void 0===ec?void 0:ec.addNotification(pc);let uc=pc.length,Cc=!1;!this.ng.lfc&&3<uc&&(uc=2,Cc=!0);let Gc=[];ec=null;this.ng.wxa||this.SS||!this.n2?(ec=this.uO.CD(2),0!==ec.errorCode&&5!==ec.errorCode||ec.Io.forEach(Ja=>{-1!==Ja.addinInfo.priority&&Gc.push(Ja)})):Gc=this.n2;v.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}, popularAddins: {5}|{6}",uc,za.a[ac.errorCode],
ac.Io.length,za.a[gb.errorCode],gb.Io.length,this.ng.wxa?za.a[ec.errorCode]:"undefined",Gc.length);G.AFrameworkApplication.ha.isChangeGateEnabled("OfficeVSO:8365528_FlyoutAddinEntryPointDisplayMetrics")&&this.AK.Cnd(uc,ac,gb,ec);let dd=!0;if(this.ng.A2||!Gc.length||vb)dd=!1;let ld=null;this.ng.A2&&!vb&&(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyEnabled",!1)&&(this.Fgd=new $a("AddinFlyoutFeedbackSurvey",this.Ga.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutSurveyTriggerTime",
this.Bgf)),this.Fgd.umg()),ld=this.GX.P_f(pc));var bc=[],cc=[];vb&&(Array.addRange(bc,this.SVf(this.Kva,pc)),Array.addRange(cc,this.Bid(this.DLa,pc)));const Vc=Object.assign(new Fa.a,{Id:"HeaderSection",ControlsId:"HeaderSection.Controls",ControlList:[]}),td=Object.assign(new Ca.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuHeaderSection:this.ng.B2?Vc:void 0,MenuFooterSection:this.l3f(),UpdateDynamically:!0,IsFlexLayout:!0});if((2===ac.errorCode||this.ng.wxa&&2===ec.errorCode)&&!pc.length){qc.push("storeDisabled");
v.ULS.sendTraceTag(509687427,220,10,"dataProvider storeDisabled error hit");var Xc=this.Nfb({iconName:"StoreDisabled",zwa:Object(E.a)("AddinPickerDisableError")});Array.add(td.MenuSectionList,Xc)}else if(3!==ac.errorCode||this.AK.ctd(ac)||3!==gb.errorCode)if(4!==ac.errorCode||pc.length){var ne=0>=bc.length&&0>=cc.length;if(this.ng.B2){const Ja=vb?String.format(ne?null!==(lb=Object(E.a)("AddInSearchNoResultsAriaText"))&&void 0!==lb?lb:"":null!==(Zb=Object(E.a)("AddInSearchResultsAriaText"))&&void 0!==
Zb?Zb:"",this.Kva):null;Array.add(Vc.ControlList,this.VYf(Ja))}if(vb)ne&&(Xc=this.Nfb({iconName:"NoSearchResults",zwa:Object(E.a)("AddInSearchNoResultsHint")}),Array.add(td.MenuSectionList,Xc)),0<bc.length&&this.yLf(td,bc),0<cc.length&&this.ELf(td,cc),Xc={},Xc.MRUAddins=bc.map(Ja=>r(Ja)),Xc.MoreAddins=cc.map(Ja=>r(Ja)),Xc.HasResults=!ne,B.a.sendTelemetryEvent(Object.assign(new w.a,{name:"Office.Extensibility.Host.SearchingAddinsFromFlyout",dataFields:A.a.Gt(Xc)}));else{0<uc&&(td.MenuSectionList.push(this.g3f(pc.slice(0,
uc),Cc)),G.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&Jb&&(bc={["solutionIds"]:gb.Io.map(Ja=>r(Ja))},B.a.sendTelemetryEvent(Object.assign(new w.a,{name:"Office.Extensibility.Host.ShowAdminAddinFromFlyout",dataFields:A.a.Gt(bc)}))));if(this.ng.A2&&ld&&0<Object.keys(ld).length){bc=[];cc=td.MenuSectionList.length;for(var Vd in ld)(ne=ld[Vd])&&0<ne.length&&(lb=this.GX.lld(Vd),Zb=this.GX.kld(Vd),bc.push(Zb),Array.add(td.MenuSectionList,
this.dZf(ne,3<ne.length?3:ne.length,lb,Vd)));this.ng.ZSb&&(h(bc,cc),n(Object.keys(ld).map(Ja=>[this.GX.lld(Ja),this.GX.kld(Ja)])))}if(dd){let Ja=this.SS?this.d7f(Gc,pc,30):this.Bid(Gc,pc);Ja=Ja.slice(0,30);if(this.ng.Xeb){Vd=this.GX.xld();for(Xc of Vd)Vd=this.GX.W0f(Xc,pc.map(Lb=>Lb.solutionId)),Ja=Ja.concat(Vd.filter(Lb=>!Ja.some(fa=>fa.solutionId===Lb.solutionId)));B.a.sendTelemetryEvent(x(w.a,{name:"Office.Extensibility.Host.AddInFlyoutSwitchCategory",dataFields:A.a.RCe({["Category"]:"All"})}))}Xc=
this.u4f(Ja);this.ng.Xeb&&(td.MenuSectionList.push(this.SZf()),Xc.Title="");td.MenuSectionList.push(Xc)}}}else qc.push("serviceDisabled"),v.ULS.sendTraceTag(508598107,220,10,"dataProvider serviceDisabled error hit"),Xc=this.Nfb({iconName:"StoreDisabled",zwa:Object(E.a)("AddinPickerServiceDisconnectedError")}),Array.add(td.MenuSectionList,Xc);else qc.push(this.AK.Cld(ac,gb)),v.ULS.sendTraceTag(509687426,220,10,"dataProvider invokeFailure error hit"),Xc=this.Nfb({iconName:"Common",zwa:Object(E.a)("AddinPickerGeneralError")}),
Array.add(td.MenuSectionList,Xc);if("0"!==this.ng.aTb)if(0!==ac.Io.length||0!==gb.Io.length||vb)l(!1);else if(vb=k(this.ng.ayf,this.ng.host),Xc=this.V0f(vb))l(!0),td.MenuSectionList.unshift(Xc),vb={["freAddins"]:vb},B.a.sendTelemetryEvent(Object.assign(new w.a,{name:"Office.Extensibility.Host.ShowFREBanner",dataFields:A.a.Gt(vb)}));this.ng.A2&&td.MenuSectionList.every(Ja=>"ErrorSection"!==Ja.Id)&&(vb=td.MenuSectionList.some(Ja=>"MRUAddinsSection"===Ja.Id),c("CategoryTitleEnhanced",this.ng.$Sb?'[id="InsertAddInFlyoutMenuId"] button[aria-haspopup="true"], [id="Ribbon-InsertAddInFlyoutDropdown"] button[aria-haspopup="true"] {font-size: 12px;\n  font-weight: 700;\n  padding: 0px 12px 0px 18px;\n  height: 28px;\n  line-height: 28px;}':
vb?'[id="Ribbon-InsertAddInFlyoutDropdown"] div[role="group"]>ul>li:nth-child(1)>div:not(#Ribbon-InsertAddInFlyoutDropdownsection-0-title) {font-weight: 700; padding-left: 12px;}\n      [id="InsertAddInFlyoutMenuId"] div[role="group"]>ul>li:nth-child(1)>div:not(#Ribbon-InsertAddInFlyoutDropdownsection-0-title) {font-weight: 700; padding-left: 12px;}':'[id="Ribbon-InsertAddInFlyoutDropdown"] div[role="group"]>ul>li:nth-child(1)>div {font-weight: 700; padding-left: 12px;}\n      [id="InsertAddInFlyoutMenuId"] div[role="group"]>ul>li:nth-child(1)>div {font-weight: 700; padding-left: 12px;}'),
this.ng.$Sb&&b());this.RGf();0===td.MenuSectionList.length&&(td.IsFlexLayout=!1,qc.push("emptyMenuSection"),v.ULS.sendTraceTag(508340124,220,15,"The menu section list length is 0"));this.AK.utd&&v.ULS.sendTraceTag(508047442,220,15,`${qc.join("|")}`);this.AK.znd&&this.AK.Bnd(pc.length,qc,ac,gb,ec);return td}RGf(){window.setTimeout(()=>{var vb=document.querySelector('#Ribbon-InsertAddInFlyoutDropdown > .ms-FocusZone > div[class^="root"] > div[class^="container"]');vb&&(vb=vb.scrollTop,0<vb&&(vb={["scrollTopValue"]:vb.toString()},
B.a.sendTelemetryEvent(Object.assign(new w.a,{name:"Office.Extensibility.Host.ScrollableListView",dataFields:A.a.Gt(vb)}))))},6E4)}u4f(vb){const ec=x(Fa.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:this.ng.Xeb?vb.map(lb=>this.pOa("AddInsListItem"+lb.solutionId.toLowerCase(),lb)):vb.map((lb,Zb)=>this.pOa("PopularAddInsListItem"+Zb,lb)),Title:Object(E.a)("PopularAddins")});G.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",
!0)&&(vb={["solutionIds"]:vb.map(lb=>r(lb))},B.a.sendTelemetryEvent(Object.assign(new w.a,{name:"Office.Extensibility.Host.ShowPopularAddinFromFlyout",dataFields:A.a.Gt(vb)})));return ec}dZf(vb,ec,lb,Zb){var qc=this.ng.$Sb&&vb.length>ec;const pc=Object.assign(new Fa.a,{Id:`${Zb}CategoryAddinListSection`,ControlsId:`${Zb}CategoryAddinListSection.Controls`,ControlList:vb.slice(0,ec).map((ac,gb)=>this.pOa(`${Zb}_CategoryAddinListItem${gb}`,ac)),Title:qc?void 0:lb});qc&&(qc=Object.assign(new Fa.a,{Id:`${Zb}CategoryAddinListSectionExtra`,
ControlsId:`${Zb}CategoryAddinListSectionExtra.Controls`,ControlList:vb.slice(ec,vb.length).map((ac,gb)=>this.pOa(`Extra_${Zb}_CategoryAddinListItem${gb}`,ac))}),lb=Object.assign(new ba.a,{Id:`${Zb}SubMenuAnchor`,ExternalId:`${Zb}SubMenuAnchor`,LabelText:lb,Command:O.a.dU.toString(),Menu:Object.assign(new Ca.a,{MenuSectionList:[qc],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:"",KeyTip:"",Alt:""}),pc.ControlList.unshift(lb));vb={["category"]:Zb,["solutionIds"]:vb.slice(0,
ec).map(ac=>r(ac))};B.a.sendTelemetryEvent(Object.assign(new w.a,{name:"Office.Extensibility.Host.ShowCategoryAddinsFromFlyout",dataFields:A.a.Gt(vb)}));return pc}pOa(vb,ec){const lb={default:"AddinFlyoutControl"+ec.solutionId},Zb=this.mOa(ec),qc=[],pc=[],ac=ec.solutionId.toLowerCase(),gb=Object.assign(new da,{text:Object(E.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+ac});if(this.ng.byf){const Jb=Object.assign(new J,{text:Object(E.a)("AddInFreeLabel")});switch(this.ng.host){case "Word":Tb.includes(ac)&&
Array.add(qc,Jb);break;case "PowerPoint":Xa.includes(ac)&&Array.add(qc,Jb);break;case "Excel":Qa.includes(ac)&&Array.add(qc,Jb)}Array.add(qc,gb)}else Array.add(pc,gb);return Object.assign(new ya.a,{Id:vb,ExternalId:vb,CommandId:vb,CommandIdMapped:O.a.Zlc.toString(),iconSet:lb,SecondaryLabel:null,Details:qc,Label:ec.displayName,ActionText:vb.includes("PAIYO_CategoryAddinListItem")?Object(E.a)("AddinListOpen"):Object(E.a)("AddinListAdd"),Description:this.ng.A2&&this.ng.ZSb?"":ec.description,Links:pc,
ActionId:vb+"Add",ActionIdMapped:O.a.Nlc.toString(),ActionCommandValueId:Zb,CommandValueId:Zb})}mOa(vb){return this.SS?String.format("{0}#{1}",vb.solutionId,vb.storeId):vb.solutionId}JYb(vb){if(!vb)return null;var ec=vb.split("#");if(1!==ec.length&&2!==ec.length)return v.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;vb=ec[0].trim();ec=2===ec.length?ec[1].trim():G.AFrameworkApplication.uiCulture;return this.uO.HO(vb,ec)}o5f(vb){return vb?this.PJa.HO(vb):
null}ojd(vb){return vb&&vb.hasOwnProperty("solutionId")&&vb.hasOwnProperty("version")&&vb.hasOwnProperty("storeType")&&vb.hasOwnProperty("storeId")&&vb.hasOwnProperty("assetId")&&vb.hasOwnProperty("assetStoreId")&&vb.hasOwnProperty("targetType")&&vb.hasOwnProperty("displayName")&&vb.hasOwnProperty("width")&&vb.hasOwnProperty("height")?!0:!1}YWf(vb){return new Promise((ec,lb)=>{if(this.ojd(vb))return ec(vb);this.PJa.tsd("",(Zb,qc)=>Zb?1!==qc.length||qc[0].solutionId.toLowerCase()!==vb.solutionId.toLowerCase()?
lb(Error("The search add-in and result add-in don't match.")):this.ojd(qc[0])?ec(qc[0]):lb(Error("The result add-in details are still not ready for install.")):lb(Error("Failed to query add-in details for install.")),(new Date).getTime(),vb.solutionId)})}E1f(vb){if(!(vb.solutionId in this.iOb)){const ec="AddinGalleryButton"+this.Igd.toString();this.iOb[vb.solutionId]=ec;vb=this.mOa(vb);this.web[ec]=vb;this.web[ec+"Add"]=vb;this.Igd++;return ec}return this.iOb[vb.solutionId]}Uld(vb){return vb?this.web[vb]:
null}Nfb(vb){var {iconName:ec,zwa:lb,nAm:Zb=!1,lDm:qc=Object(E.a)("AddinPickerTryAgain"),kDm:pc="ReloadAddInPicker",q_l:ac="ReloadAddInPicker"}=vb;vb=Object.assign(new Fa.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});let gb=null;gb=lb===Object(E.a)("AddinPickerDisableError")&&this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8668453_StoreDisabledErrorViewWithDocumentLink")?Object.assign(new U.a,{Id:"ErrorView",ExternalId:"ReloadAddInPickerStoreDisabled",IconName:ec,Label:lb,
RetryButtonTitle:Zb?Object(E.a)("AddinPickerTryAgain"):"",OnRetryCommandId:"ReloadAddInPicker",AriaDescription:"StoreDisabled"===ec?lb:Object(E.a)("AddinPickerTryAgainAriaLabel"),LinkText:Object(E.a)("AddinPickerDisableErrorDocumentText"),LinkUrl:String.format("https://learn.microsoft.com/{0}/microsoft-365/admin/manage/manage-addins-in-the-admin-center?view=o365-worldwide#manage-add-in-downloads-by-turning-onoff-the-office-store-across-all-apps-except-outlook",G.AFrameworkApplication.uiCulture),OnLinkClicked:()=>
{v.ULS.sendTraceTag(507875925,220,15,"User has clicked link on add-in picker error view")}}):Object.assign(new U.a,{Id:"ErrorView",ExternalId:ac,IconName:ec,Label:lb,RetryButtonTitle:Zb?qc:"",OnRetryCommandId:pc,AriaDescription:"StoreDisabled"===ec?lb:Object(E.a)("AddinPickerTryAgainAriaLabel")});Array.add(vb.ControlList,gb);return vb}Bid(vb,ec){var lb=new I.a;for(let Zb=0;Zb<vb.length;Zb++)lb.add(vb[Zb]);if(this.ng.wxa||!this.n2)30<lb.count&&(lb=u(lb,(new Date).getDate())),this.n2=lb.toArray();for(vb=
0;vb<this.n2.length;vb++)for(lb=0;lb<ec.length;lb++)if(this.n2[vb].solutionId.toLowerCase()===ec[lb].solutionId.toLowerCase()){Array.remove(this.n2,this.n2[vb--]);break}return this.n2}v4f(vb,ec,lb){lb>vb.length&&(lb=vb.length);var Zb=new M(ec);for(ec=new Set;ec.size<lb;){const qc=Zb.next(vb.length);ec.add(qc)}for(lb=0;lb<vb.length;lb++)Zb=vb[lb].addinInfo,ec.has(lb)?Zb.AUP*=20:Zb.AUP=1===Zb.priority?4*Zb.AUP:2===Zb.priority?2*Zb.AUP:1*Zb.AUP;vb.sort((qc,pc)=>qc.addinInfo.AUP<pc.addinInfo.AUP?1:-1);
return vb}d7f(vb,ec,lb){vb=vb.filter(Zb=>!ec.some(qc=>qc.solutionId.toLowerCase()===Zb.solutionId.toLowerCase()));return this.v4f(vb,(new Date).getDate(),lb).slice(0,lb)}Nah(vb){if(0===vb.errorCode||2===vb.Y0&&5===vb.errorCode)vb.Io?this.Frd(vb.Io):v.ULS.sendTraceTag(509687429,220,10,`fail to register icons for addin collection: ${ma.a[vb.Y0]}`)}Frd(vb){return Promise.all(vb.map(ec=>{var lb,Zb;if(ec&&ec.solutionId&&ec.iconUrl)return appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+ec.solutionId,
ec.iconUrl);v.ULS.sendTraceTag(508352214,220,10,"failed to register icon for addin: solutionId: {1}, iconUrl: {2}",null!==(lb=null===ec||void 0===ec?void 0:ec.solutionId)&&void 0!==lb?lb:"null",null!==(Zb=null===ec||void 0===ec?void 0:ec.iconUrl)&&void 0!==Zb?Zb:"null");return Promise.resolve()}))}VYf(vb){return Object.assign(new Ua.a,{ExternalId:"SearchAddinInFlyout",Label:Object(E.a)("AddInSearchBoxPlaceholder"),ShowIcon:!0,Underlined:!0,Value:this.Kva,ResultAriaLiveText:vb,OnChangeCommandId:"SearchAddinInFlyout"})}yLf(vb,
ec){const lb=Object.assign(new Fa.a,{Id:"MRUAddinsSearchResutlsSection",ControlsId:"MRUAddinsSearchResutlsSection.Controls",ControlList:[]});Array.add(vb.MenuSectionList,lb);vb=this.Eld("MRUAddinsSearchResutlsGalleryControl",ec,!1,!1);Array.add(lb.ControlList,vb)}ELf(vb,ec){const lb=Object.assign(new Fa.a,{Id:"PopularAddinsListSearchResutlsSection",ControlsId:"PopularAddinsSearchResutlsSection.Controls",ControlList:[],Title:Object(E.a)("AddInSearchResultsDivider")});for(let Zb=0;Zb<ec.length;Zb++)lb.ControlList.push(this.pOa("PopularAddinsSearchResultsItem"+
Zb,ec[Zb]));Array.add(vb.MenuSectionList,lb)}SVf(vb,ec){const lb=vb.toLocaleLowerCase();vb=ec.filter(Zb=>{this.OJa[Zb.solutionId]||(this.OJa[Zb.solutionId]=Zb.displayName.toLocaleLowerCase());return this.OJa[Zb.solutionId].includes(lb)});vb.sort((Zb,qc)=>this.OJa[Zb.solutionId].indexOf(lb)-this.OJa[qc.solutionId].indexOf(lb));return vb}lhh(vb){const ec=this;return aq(function*(){ec.DLa=ec.ng.eyf?yield ec.PJa.phh(vb):yield ec.PJa.ohh(vb);yield ec.Frd(ec.DLa)})}mhh(vb){this.Kva=vb;appChrome.api.dispatch(appChrome.actions.updateSearchBoxValue("SearchAddinInFlyout",
vb));this.Ieb&&window.clearTimeout(this.Ieb);this.Ieb=window.setTimeout(()=>{var ec;this.Ieb=null;vb?this.lhh(vb).catch(()=>{this.DLa=[];v.ULS.sendTraceTag(507577680,220,10,"Failed to call search addins API")}).finally(()=>{var lb;this.Kva===vb&&(this.Ypd=!0,null===(lb=this.$rd)||void 0===lb?void 0:lb.call(this))}):(this.Ypd=!1,null===(ec=this.$rd)||void 0===ec?void 0:ec.call(this))},this.phd)}set Ypd(vb){this.ng.B2||(this.Jeb=!1);this.Jeb=vb}get eNf(){let vb=!1;this.Jeb&&(this.Jeb=!1,vb=this.ng.B2);
vb||(this.Kva="",this.DLa=[]);return vb}ajh(){let vb;m(ec=>{const lb=document.getElementById("Ribbon-InsertAddInFlyoutDropdown")||document.getElementById("InsertAddInFlyoutMenuId");lb&&ec&&(vb=()=>{var Zb;null===(Zb=document.getElementById("SearchAddinInFlyout"))||void 0===Zb?void 0:Zb.focus();lb.removeEventListener("focus",vb);vb=void 0},lb.addEventListener("focus",vb))})}Mbc(vb){if(vb)try{vb.MenuItems=this.n3f(this.eNf)}catch(ec){v.ULS.sendTraceTag(509687425,220,10,`GetReactGalleryMenu hit exception ${ec.message}; stack: ${ec.stack}`)}else v.ULS.sendTraceTag(509687424,
220,10,"PopulateMenu menuProps is null")}dispose(){}get AK(){this.zga||(this.zga=new tb("Flyout",this.Ga));return this.zga}}Object(y.a)(X,"AppsFlyoutGenerator",null,[40]);var Ta=a(35),ca=a(36);class Ma{constructor(){this.addInDetails=this.title=null}}Object(y.a)(Ma,"AddInCategoryData",null,[]);class Ba{constructor(){this.links=this.description=this.displayName=this.uniqueId=this.solutionId=null}}Object(y.a)(Ba,"AddInDetailData",null,[]);class wa{constructor(){this.href=this.text=null}}Object(y.a)(wa,
"AddInLinkData",null,[]);var pa=a(160);class ta{constructor(vb,ec,lb){this.FX=0;this.Lgd=!1;this.JLa=[];this.zga=void 0;this.Ga=vb;this.EX=ec;this.JQb=lb;v.ULS.sendTraceTag(508396508,220,50,"AddInCategoryManager Initialized")}jla(vb,ec){vb&&ec&&this.Imh(ec)&&this.Rqd()}Imh(vb){0===vb.Y0&&(this.FX|=1);1===vb.Y0&&(this.FX|=2);2===vb.Y0&&(this.FX|=4);return!!this.FX}Rqd(){const vb=[];let ec=null;const lb={},Zb=this.Zig,qc=this.vWg,pc=this.EX.CD(0),ac=this.EX.CD(1),gb=this.EX.CD(2);(2===pc.errorCode||
this.wxa&&2===gb.errorCode)&&!qc.length?(ec=this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8668453_StoreDisabledErrorViewWithDocumentLink")?{ariaDescription:Object(E.a)("AddinPickerDisableError"),iconName:"StoreDisabled",label:Object(E.a)("AddinPickerDisableError"),title:Object(E.a)("AddInBackstageErrorViewTitle"),linkText:Object(E.a)("AddinPickerDisableErrorDocumentText"),linkUrl:String.format("https://learn.microsoft.com/{0}/microsoft-365/admin/manage/manage-addins-in-the-admin-center?view=o365-worldwide#manage-add-in-downloads-by-turning-onoff-the-office-store-across-all-apps-except-outlook",
G.AFrameworkApplication.uiCulture),onLinkClicked:()=>{v.ULS.sendTraceTag(507875924,220,15,"User has clicked link on add-in backstage error view")}}:{ariaDescription:Object(E.a)("AddinPickerDisableError"),iconName:"StoreDisabled",label:Object(E.a)("AddinPickerDisableError"),title:Object(E.a)("AddInBackstageErrorViewTitle")},vb.push("storeDisabled")):3!==pc.errorCode||this.AK.ctd(pc)||3!==ac.errorCode?4!==pc.errorCode||qc.length?!this.Ymd&&(!this.SS||0!==gb.errorCode&&5!==gb.errorCode)||gb.Io.length||
(v.ULS.sendTraceTag(508396506,220,50,"get popular add-ins for backstage error: empty category, Flag: {0} Popular error code: {1}",this.FX,gb.errorCode),vb.push("emptyCategory")):(ec={ariaDescription:Object(E.a)("AddinPickerServiceDisconnectedError"),iconName:"StoreDisabled",label:Object(E.a)("AddinPickerServiceDisconnectedError"),title:Object(E.a)("AddInBackstageErrorViewTitle")},vb.push("serviceDisabled")):(ec={ariaDescription:Object(E.a)("AddinPickerGeneralError"),iconName:"Common",label:Object(E.a)("AddinPickerGeneralError"),
title:Object(E.a)("AddInBackstageErrorViewTitle")},vb.push(this.AK.Cld(pc,ac)));this.hWa&&this.AK.Cnd(qc.length,pc,ac,gb);const Jb=!ec;!Jb||Zb||qc.length?(Jb?(lb.mruAddIns=qc,Zb&&(lb.categories=this.c5g)):lb.errorViewProps=ec,appChrome.api.dispatch(appChrome.actions.setFileMenuAddInsData(lb,Jb)),Zb&&Jb&&!this.Lgd&&(this.Lgd=!0,v.ULS.sendTraceTag(508396504,220,50,"Set Popular Add-ins List to Backstage Success. Flag: {0}",this.FX))):vb.push("emptyPage");this.hWa&&(this.AK.utd&&v.ULS.sendTraceTag(508047441,
220,15,`${vb.join("|")}`),this.AK.znd&&this.AK.Bnd(qc.length,vb,pc,ac,gb))}get Ymd(){return!!(this.FX&4)}get hWa(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}get Zig(){const vb=this.EX.CD(2);return(this.Ymd||this.SS||this.hWa)&&(0===vb.errorCode||5===vb.errorCode)&&!!vb.Io.length}get c5g(){var vb=this.n0f();0<vb.length&&(this.JQb=vb);if(pa.b(this.JQb))return[];var ec=JSON.parse(this.JQb);vb=[];for(var lb of ec)ec=Object.assign(new Ma,
{title:lb.title,addInDetails:[]}),this.WCf(ec,lb.solutionIds),0<ec.addInDetails.length&&Array.add(vb,ec);0<this.JLa.length&&(lb=this.EX.CD(2),v.ULS.sendTraceTag(508396503,220,15,"{0} SolutionIds not found in mapping: {1}, collection length: {2}",this.JLa.length,this.JLa,lb.Io.length),this.JLa=[]);return vb}get vWg(){var vb=[],ec=this.EX.CD(0);Array.addRange(vb,ec.Io);ec=this.EX.CD(1);Array.addRange(vb,ec.Io);vb.sort((lb,Zb)=>{lb=Ia.d(lb.displayName);Zb=Ia.d(Zb.displayName);return Oa.a.localeCompare(lb,
Zb)});ec=[];for(const lb of vb)vb=Object.assign(new Ba,{description:lb.description,displayName:lb.displayName,solutionId:lb.solutionId,uniqueId:this.mOa(lb)}),Array.add(ec,vb);return ec}WCf(vb,ec){const lb=this.wWg;let Zb=0;for(const qc of ec){if(4===Zb)break;if(lb.contains(qc))continue;ec=this.EX.HO(qc);if(!ec){this.JLa.push(qc);continue}const pc=Object.assign(new Ba,{description:ec.description,displayName:ec.displayName,solutionId:ec.solutionId,uniqueId:this.mOa(ec)});pc.links=[Object.assign(new wa,
{text:Object(E.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+ec.solutionId})];Array.add(vb.addInDetails,pc);++Zb}}get wWg(){const vb=[];var ec=this.EX.CD(0);Array.addRange(vb,ec.Io);ec=this.EX.CD(1);Array.addRange(vb,ec.Io);ec=new Ta.a(ca.a.Co());for(const lb of vb)ec.add(lb.solutionId);return ec}mOa(vb){return this.SS?String.format("{0}#{1}",vb.solutionId,vb.storeId):vb.solutionId}get SS(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8332954_FlyoutNotifyObserverFailuresEnabled")&&
this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}n0f(){return this.Ga?this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.BackstageCustomizablePopularAddins",""):""}get wxa(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8362324_StoreDisabledErrorViewFixEnabled")}get AK(){this.zga||(this.zga=new tb("Backstage",this.Ga));return this.zga}}Object(y.a)(ta,"AddInCategoryManager",null,[]);var Wa=a(1398),Pa=a(274),ib=a(6),Ib=a(1703),hc=a(573),
yc=a(54),ob=a(96),Bc=a(51);class rb{constructor(){this.idField=null;this.stateField=0}}Object(y.a)(rb,"CT_OsfBackgroundAppData",null,[]);class Eb{constructor(){this.currentStoreTypeField=this.bkgdDataField=this.assetStoreIdField=this.assetIdField=this.appVersionField=null;this.heightField=0;this.heightFieldSpecified=!1;this.idField=null;this.isAddinCommandsField=!1;this.storeIdField=null;this.widthField=this.targetTypeField=0;this.widthFieldSpecified=!1}}Object(y.a)(Eb,"CT_OsfInsertionInfo",null,
[]);var jc=a(68),ea=a(841),ua=a(842),Da=a(372),Cb=a(42),Nb=a(44),fc=a(75);const fb={["TD"]:[],["WN"]:[]},Ub={["PAIYO"]:[],["BBM"]:[{solutionId:"wa200003233",addinInfo:{AUP:143978}},{solutionId:"wa104381526",addinInfo:{AUP:50753}},{solutionId:"wa104295828",addinInfo:{AUP:8127}},{solutionId:"wa104380862",addinInfo:{AUP:459}}]},Ec={["IPWAI"]:[{solutionId:"wa200003964",addinInfo:{AUP:2308}},{solutionId:"wa200005107",addinInfo:{AUP:786}},{solutionId:"wa200005669",addinInfo:{AUP:247}},{solutionId:"wa200006067",
addinInfo:{AUP:148}},{solutionId:"wa200006000",addinInfo:{AUP:861}}],["APIC"]:[{solutionId:"wa104381155",addinInfo:{AUP:4724}},{solutionId:"wa104221182",addinInfo:{AUP:3054}},{solutionId:"wa104178141",addinInfo:{AUP:2656}},{solutionId:"wa104381909",addinInfo:{AUP:2153}},{solutionId:"wa104380907",addinInfo:{AUP:1945}},{solutionId:"wa200000113",addinInfo:{AUP:1715}},{solutionId:"wa104380121",addinInfo:{AUP:1275}},{solutionId:"wa200000729",addinInfo:{AUP:1132}},{solutionId:"wa104379370",addinInfo:{AUP:688}},
{solutionId:"wa104381411",addinInfo:{AUP:562}},{solutionId:"wa104381063",addinInfo:{AUP:515}},{solutionId:"wa104379997",addinInfo:{AUP:307}},{solutionId:"wa200003220",addinInfo:{AUP:306}},{solutionId:"wa200003891",addinInfo:{AUP:293}},{solutionId:"wa200001766",addinInfo:{AUP:68}},{solutionId:"wa104380902",addinInfo:{AUP:280}},{solutionId:"wa104381637",addinInfo:{AUP:137}},,{solutionId:"wa104380848",addinInfo:{AUP:150}}],["CAIP"]:[{solutionId:"wa104379261",addinInfo:{AUP:13796}},{solutionId:"wa200000094",
addinInfo:{AUP:6789}},{solutionId:"wa200001661",addinInfo:{AUP:6596}},{solutionId:"wa200002908",addinInfo:{AUP:2861}},{solutionId:"wa104381682",addinInfo:{AUP:2742}},{solutionId:"wa104382064",addinInfo:{AUP:2671}},{solutionId:"wa104218073",addinInfo:{AUP:2577}},{solutionId:"wa200004709",addinInfo:{AUP:601}},{solutionId:"wa200004643",addinInfo:{AUP:517}},{solutionId:"wa200003676",addinInfo:{AUP:361}},{solutionId:"wa200001313",addinInfo:{AUP:219}},{solutionId:"wa104381448",addinInfo:{AUP:127}},{solutionId:"wa200003706",
addinInfo:{AUP:122}},{solutionId:"wa104380667",addinInfo:{AUP:24}}],["DWT"]:[{solutionId:"wa200001625",addinInfo:{AUP:3193}},{solutionId:"wa104380526",addinInfo:{AUP:1790}},{solutionId:"wa104380602",addinInfo:{AUP:1500}},{solutionId:"wa104380050",addinInfo:{AUP:1102}},{solutionId:"wa200002334",addinInfo:{AUP:869}},{solutionId:"wa200001409",addinInfo:{AUP:566}},{solutionId:"wa104380955",addinInfo:{AUP:341}},{solutionId:"wa104380278",addinInfo:{AUP:228}},{solutionId:"wa200003157",addinInfo:{AUP:222}},
{solutionId:"wa200001396",addinInfo:{AUP:168}},{solutionId:"wa200006046",addinInfo:{AUP:71}},{solutionId:"wa200003052",addinInfo:{AUP:132}}]};class Lc{constructor(vb,ec,lb,Zb,qc,pc,ac,gb,Jb,uc,Cc,Gc,dd,ld){this.Jwa=0;this.Wod=this.Und=this.N6b=this.Ood=this.Aod=!1;this.Spg="g_InstallOrigin";this.upd=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAddIns","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],["InsertMoreAddInsFromFooter","InsertMoreAddInsFromFooter"],
["InsertMoreAddInsFromBackstageFooter","InsertMoreAddInsFromBackstageFooter"],["LaunchMyAddInsFromBackstage","BackstageSeeAll"]]);this.sEf=`[{"title":"${CommonUIStrings.l_AddInCategoryTitleAddingPicturesIconsAndCharts}","solutionIds":["wa104178141","wa104381909","wa104380907","wa200003233","wa104221182","wa104381411","wa104380121","wa104379997","wa104379370","wa104381063","wa104295828","wa200000113","wa200000729"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleDesigningAnInteractivePresentation}","solutionIds":["wa104379261","wa200001661","wa200002908","wa104381526","wa200004709","wa200004643","wa104380667","wa104218073","wa104382064","wa104381682"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleDesigningWithTemplates}","solutionIds":["wa104380050","wa200001396","wa200003964","wa200001625","wa200003157","wa200001409","wa200002334"]}]`;
this.fmd=()=>Cb.a("DelayQueryAddinFlyoutRegister")&&this.uYa?this.kMa&&!this.Jb.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")&&this.wv?32:8:this.kMa&&!this.Jb.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")&&this.wv&&this.wv.njd()?32:8;this.K9f=(bc,cc,Vc,td,Xc)=>{if(2!==Vc)return this.wv&&this.wv.njd()?32:8;if(!this.wv)return 8;Cb.a("ShowUserSegmentInformationEnabled")&&(bc={["UserSegment"]:this.sDf()},cc=new w.a,cc.name="Office.Extensibility.Host.UserSegmentInformation",cc.dataFields=
A.a.Gt(bc),B.a.sendTelemetryEvent(cc));this.wv.Mbc(Xc);return 32};this.cih=(bc,cc,Vc)=>{bc={["solutionId"]:Lc.twa(cc.solutionId,cc.storeType,cc.assetId,cc.storeId),["href"]:bc,["UILocation"]:Vc};B.a.sendTelemetryEvent(Object.assign(new w.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:A.a.Gt(bc)}))};this.r9f=(bc,cc,Vc,td,Xc)=>2!==Vc?32:Xc&&"LinkClickedPayload"===Xc.Type?((bc=this.bld(Xc.CommandValueId))&&this.cih(Xc.Href,bc,Xc.UILocation),32):this.amd(bc,cc,Vc,td,Xc);
this.p9f=(bc,cc,Vc,td,Xc)=>{var ne;if(2!==Vc)return 32;if(this.B2&&(null===(ne=Xc.SourceControlId)||void 0===ne?0:ne.startsWith("PopularAddinsSearchResultsItem")))return this.q9f(bc,Vc,Xc);if(cc=this.bld(Xc.CommandValueId))this.$ld(bc,Xc,cc);else return v.ULS.sendTraceTag(509109065,344,10,"No add-in details."),8;return 32};this.$ld=(bc,cc,Vc)=>{const td={};td.solutionId=Vc.solutionId;td.version=Vc.version;td.storeType=Vc.storeType;td.storeId=Vc.storeId;td.assetId=Vc.assetId;td.assetStoreId=Vc.assetStoreId;
td.targetType=Vc.targetType;td.displayName=Vc.displayName;td.width=Vc.width;td.height=Vc.height;this.Yc.dnc("handleInsertAppForOffice",td);this.N_b(bc,td);bc={["solutionId"]:Lc.twa(Vc.solutionId,Vc.storeType,Vc.assetId,Vc.storeId)};bc.UILocation=cc.UILocation;bc.ControlId=cc.SourceControlId;B.a.sendTelemetryEvent(Object.assign(new w.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:A.a.Gt(bc)}))};this.s9f=(bc,cc,Vc,td,Xc)=>{var ne;if(!this.xR||!Xc)return 8;if(1===
Vc)return this.Yc?32:8;if(!this.Yc)return this.Jwa||(this.Jwa=window.performance.now()),this.jA.rZ(),this.jA.afa(bc,Xc),8;bc=Xc[hc.a.JAa];cc=Xc[hc.a.Ota];Vc=cc.gt;Xc={};Xc.UC=Vc.TaskPaneTitle;Xc.assetId=bc.getId();Xc.UW=Vc.OnRenderedCallback;Xc.nonPersistedSettings=cc.gIa;Xc.akd=Vc.DialogIsModal;Xc.bkd=Vc.DialogShowTitleBar;Xc.dialogWidth=Vc.DialogWidth;Xc.dialogHeight=Vc.DialogHeight;Xc.dialogLeft=Vc.DialogLeft;Xc.wEc=Vc.DialogRight;Xc.dialogTop=Vc.DialogTop;Xc.qEc=Vc.DialogBottom;Xc.nfa=null!==
(ne=Vc.DialogTitle)&&void 0!==ne?ne:"";Xc.sourceLocationOverrideResourceId=Vc.SourceLocationOverrideResourceId;Xc.GSd=Vc.DialogParentId;Xc.sEc=Vc.DialogCloseCallback;Xc.vEc=Vc.DialogResizeCallback;ne=this.Yc.nOa(Xc);if(ne=this.Yc.EV(ne))Xc.mq=ne.mq;this.Yc.t_k(Xc);return 32};this.a$f=(bc,cc,Vc,td,Xc)=>{if(2!==Vc)return 32;if(!this.Yc)return 8;cc=Xc[hc.a.JAa];Vc=Xc[hc.a.Ota].gt;bc={};bc.UC=Vc.TaskPaneTitle;bc.assetId=cc.getId();bc.sourceLocationOverrideResourceId=Vc.SourceLocationOverrideResourceId;
bc.UW=Vc.zHl;bc.nonPersistedSettings=Vc.gIa;cc=this.Yc.nOa(bc);cc=this.Yc.EV(cc);Xc=Xc[hc.a.VHb];return cc&&"taskpane"==Xc.toLowerCase()?(this.Yc.t$k(cc.mq,bc),32):8};this.W9f=(bc,cc,Vc,td,Xc)=>{var ne;if(1===Vc)return 32;this.wv.mhh(null!==(ne=null===Xc||void 0===Xc?void 0:Xc.SearchBoxNewValue)&&void 0!==ne?ne:"");return 32};this.t9f=(bc,cc,Vc,td,Xc)=>{var ne;if(2!==Vc)return 32;if(!this.wv)return 8;cc=td=void 0;Vc=Xc.SourceControlId;if(this.wv.SS){const Vd=this.wv.JYb(this.wv.Uld(Vc));null!=Vd&&
(td=Vd.solutionId,cc=Vd.storeId)}else td=(td=Xc.CommandValueId)?td:this.Qgb.zjd[Vc];if(!td)return v.ULS.sendTraceTag(509383066,220,10,"SourceControlId (solutionId) is empty in handleLaunchUserInstalledAddIn"),8;this.Yc?(bc=Xc.SqmControlId,this.Yc.T0j(td,cc,Xc.UILocation,null!==bc&&void 0!==bc?bc:Vc),null===(ne=this.Dod)||void 0===ne?void 0:ne.hUg(td)):(this.jA.rZ(),this.jA.afa(bc,Xc));return 32};this.amd=(bc,cc,Vc,td,Xc)=>{if(2!==Vc)return 32;if(!this.wv)return 8;cc=this.f6f(Xc);if(!cc)return v.ULS.sendTraceTag(509383065,
220,10,"SourceControlId (solutionId) is empty in LaunchAddinInstallDialog"),8;this.Yc?this.Yc.g3b(cc,Xc.UILocation,Xc.SourceControlId):(this.jA.rZ(),this.jA.afa(bc,Xc));return 32};this.bmd=(bc,cc,Vc,td,Xc)=>{cc=this.ya.Ia;td=this.jc.Tf;if(!(this.xR&&cc&&td)||this.qf.Hd(cc))return 8;if(!this.kMa)return v.ULS.sendTraceTag(512288602,802,50,"Web add-in insert blocked by doc IRM"),8;if(1===Vc)return 32;Vc=Xc?Xc.SourceControlId:void 0;window[this.Spg]=this.upd.get(Vc)?this.upd.get(Vc):"Unknown";this.Yc?
(Cb.a("UpdateLaunchInsertDialog")?(bc=Xc?Xc.SourceControlId:void 0,Xc=Xc?Xc.CommandValueId:null,"InsertMoreAddInsFromFooter"===bc||"InsertMoreAddInsFromBackstageFooter"===bc?this.Yc.PZe("{98143890-AC66-440E-A448-ED8771A02D52}"):"AddinFlyoutMoreButton"===bc||"LaunchMyAddInsFromBackstage"===bc?this.Yc.PZe("0"):"LaunchAddinDialogFromTellMe"==bc&&Xc?this.Yc.d1j(Xc):this.Yc.launchInsertDialog()):this.Yc.launchInsertDialog(),Cb.a("LogTelemetryForStoreDialog")&&(Xc={["controlId"]:Vc},bc=new w.a,bc.name=
"Office.Extensibility.Host.ShowStoreDialog",bc.dataFields=A.a.Gt(Xc),B.a.sendTelemetryEvent(bc))):(this.jA.rZ(),this.jA.afa(bc,Xc));return 32};this.Zld=(bc,cc,Vc,td,Xc)=>{if(!Xc)return 8;null!=this.Yc&&this.Jb.isChangeGateEnabled("OnInsertAgaveStartedEnabled")&&this.Yc.dnc("handleInsertAppForOffice",Xc);return this.N_b(bc,Xc)};this.n9f=(bc,cc,Vc,td,Xc)=>Xc?this.N_b(bc,Xc):8;this.N_b=(bc,cc)=>{if(!this.kMa)return v.ULS.sendTraceTag(512288601,802,50,"Web add-in insert blocked by doc IRM"),16;if(0===
cc.targetType)return this.$cg(cc,bc);if(1===cc.targetType){if(this.qf.Hd(this.jc.Tf))return 16;this.tyg?cc.isAddinCommands?Cb.a("AddinCommandsActionTypeUndefinedCheck")?void 0===cc.addinCommandsActionType||null===cc.addinCommandsActionType||0===cc.addinCommandsActionType?this.Qib(cc):1===cc.addinCommandsActionType?this.sgb(cc):v.ULS.sendTraceTag(512288600,802,50,"HandleInsertAppForOfficeUpload invalid AddinCommandsActionType of "+cc.addinCommandsActionType.toString()):0===cc.addinCommandsActionType?
this.Qib(cc):1===cc.addinCommandsActionType&&this.sgb(cc):(bc={},bc.solutionId=cc.solutionId,bc.version=cc.version,bc.storeType=cc.storeType,bc.storeId=cc.storeId,bc.targetData=cc,this.Yc.Qq.isAddinCommandsAsync(bc,(Vc,td,Xc)=>{td?this.Qib(Xc.targetData):this.sgb(Xc.targetData);Vc||(Vc=Xc.targetData,v.ULS.sendTraceTag(512288599,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Vc.solutionId,Vc.storeType,Vc.assetId,null,null,Vc.storeId),Vc.storeType))})):
this.sgb(cc);ea.a.add(cc.solutionId,cc.targetType,cc.storeId,cc.storeType,cc.version);return 32}return 8};this.e9f=(bc,cc,Vc)=>{if(2!==Vc)return this.Yc&&this.Yc.HF?32:8;if(!this.Yc)return v.ULS.sendTraceTag(507818185,220,10,"appForOfficeManager is null"),8;this.Und||(this.Yc.HF?(this.Yc.HF.cib(this.Ech),this.Und=!0):v.ULS.sendTraceTag(507818184,220,10,"appForOfficeManager.addinDetailsProvider is null"));return 32};this.Ech=()=>{this.Ngb?this.Ngb.Rqd():v.ULS.sendTraceTag(507896194,220,10,"_addInCategoryManager is null")};
this.na=vb;this.Jb=ec;this.xR=this.na.DKb;this.tyg=this.na.u6a;this.Do=lb;this.la=Zb;this.jc=qc;this.ya=pc;this.Tod=gb;this.Tb=ac;this.jA=Jb;this.Ld=uc;this.Vb=Cc;this.qf=Gc;this.zj=dd;this.SSg=ld}get kMa(){return this.xR&&G.AFrameworkApplication.jMa}get uYa(){return this.Jb.isChangeGateEnabled("OfficeVSO:8332954_FlyoutNotifyObserverFailuresEnabled")}Kb(){this.la.ua(Nb.a.BIa,jc.a.application,this.bmd,516);this.la.ua(Nb.a.zmd,jc.a.application,this.n9f,4);this.la.Ba(Nb.a.omd,jc.a.application,Object(ib.a)(this,
this.m9f,"handleHideAppForOfficeTaskPane"));this.la.ua(Nb.a.uZa,jc.a.application,Object(ib.a)(this,this.R9f,"handleRenderAppForOfficeTaskPane"),4);this.la.ua(Nb.a.pZa,jc.a.application,Object(ib.a)(this,this.pZa,"queryEntitledAppsForOffice"),96);this.la.Ba(Nb.a.kJa,jc.a.application,Object(ib.a)(this,this.imd,"handleShowFirstPartyTaskPane"));this.la.Ba(Nb.a.YUb,jc.a.application,Object(ib.a)(this,this.R8f,"handleCloseAppsForOfficeTaskPane"));this.la.Ba(O.a.l6e,jc.a.application,Object(ib.a)(this,this.d$f,
"handleShowExtensionTaskPane"));this.la.Ba(O.a.MUe,jc.a.application,Object(ib.a)(this,this.S8f,"handleCloseExtensionTaskPane"));this.la.Ba(O.a.X4e,jc.a.application,Object(ib.a)(this,this.S9f,"handleRestartExtensionTaskPane"));this.la.Ba(Nb.a.L7e,jc.a.application,Object(ib.a)(this,this.o$f,"handleUpdateBackgroundAppData"));this.la.Ba(O.a.QZe,jc.a.application,this.s9f);Cb.a("EnabledTellMeAddinOnPPTO")&&(this.la.ua(O.a.Ycg,jc.a.application,this.Zld,4),this.la.ua(O.a.OZe,jc.a.application,this.bmd,4));
this.THa&&(this.la.Ba(O.a.g3b,jc.a.application,this.amd),this.la.Ba(O.a.sYe,jc.a.application,this.Zld),this.la.Ba(O.a.JQc,jc.a.application,this.t9f),this.B2&&this.la.ua(O.a.m5e,jc.a.application,this.W9f,4),Cb.a("DelayQueryAddinFlyoutRegister")&&this.kMa&&!this.Jb.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")&&this.uYa&&this.THa?(this.jA.rZ(),this.Ld.execute(()=>{this.L8f()})):(this.la.ua(O.a.eBe,jc.a.application,this.fmd,4),this.N6b=!0),this.uYa||this.Grd());if(this.L$b||this.THa)this.la.Ba(O.a.Zlc,
jc.a.application,this.r9f),this.la.Ba(O.a.Nlc,jc.a.application,this.p9f);this.L$b&&this.euh&&this.la.Ba(O.a.$Ve,jc.a.application,this.e9f);Cb.a("EnableSetTitleExtensionTaskPane")&&this.la.Ba(O.a.R5e,jc.a.application,this.a$f)}L8f(){!this.Qgb&&this.Yc&&this.Fjd()}Grd(){this.Ood||(this.la.Ba(O.a.PWh,jc.a.application,this.K9f),this.Ood=!0,v.ULS.sendTraceTag(508560274,220,50,"Register succeed"))}Vah(){this.N6b||(this.la.ua(O.a.eBe,jc.a.application,this.fmd,4),this.N6b=!0)}jla(){Cb.a("DelayQueryAddinFlyoutRegister")&&
this.Vah();this.Grd()}Fjd(){if(this.Yc.HF){this.Dod=new N(this.Yc.HF);if(!Cb.a("DelayQueryAddinFlyoutRegister")||fc.c()&&appChrome.addInApi)this.Qgb=new X(this.la,this.Yc.HF,O.a.g3b.toString(),O.a.JQc.toString(),this.Kjg?O.a.ke.toString():Nb.a.BIa.toString(),this.Jb,this.swf,this.A2?this.RZf():{},this.Dod,()=>{var vb;return null===(vb=this.SSg)||void 0===vb?void 0:vb.call(this,"InsertAddInFlyout")});this.uYa&&!this.Wod&&(this.Yc.HF.cib(Object(ib.a)(this,this.jla,"onAddinDetailsRefreshed")),this.Wod=
!0)}else v.ULS.sendTraceTag(509379480,220,10,"this.appForOfficeManager.addinDetailsProvider is null")}get wv(){if(!this.THa)return null;if(!this.Yc)return this.jA.rZ(),null;this.Qgb||this.Fjd();return this.Qgb}get swf(){this.L$b&&!this.Ngb&&(this.Ngb=new ta(this.Jb,this.Yc.HF,this.sEf));return this.Ngb}get L$b(){var vb;return!(null===(vb=this.Jb)||void 0===vb||!vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewBackstageEnabled",!1))}get THa(){return this.Jb.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")&&
this.Jb.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}get A2(){return this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutContentExpEnabled",!1)}get AQf(){return this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DistinguishUserSegmentForContentExpEnabled",!1)}get Kjg(){return this.Jb.isChangeGateEnabled("OfficeVSO:8668457_SeeMoreSeeLessEnabled")}get B2(){return!!this.Jb&&this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",
!1)}f6f(vb){if(vb)if(this.wv.SS){if(vb=this.wv.JYb(this.n7f(vb)))return vb.solutionId}else{const ec=vb.CommandValueId;return null!=ec?ec:this.wv.zjd[vb.SourceControlId]}}n7f(vb){var ec;return null!==(ec=vb.CommandValueId)&&void 0!==ec?ec:this.wv.Uld(vb.SourceControlId)}sDf(){try{const vb=JSON.parse(this.Jb.Ma("SessionStartInfoJson"));return`IsBusinessUser: ${vb.IsBusinessUser}, IsEduUser: ${vb.IsEduUser}, IsAnonymousUser: ${"true"===vb.IsAnonymousUser}`}catch(vb){return v.ULS.sendTraceTag(507881032,
220,10,"Exception thrown from JSON parse for sessionStartInfoJson:{0}. Exception:{1}",this.Jb.Ma("SessionStartInfoJson"),vb),""}}get isBusinessUser(){try{const vb=JSON.parse(this.Jb.Ma("SessionStartInfoJson"));return vb.IsBusinessUser?vb.IsBusinessUser:!1}catch(vb){return v.ULS.sendTraceTag(507811937,220,10,"Exception thrown from JSON parse for sessionStartInfoJson:{0}. Exception:{1}",this.Jb.Ma("SessionStartInfoJson"),vb),!1}}RZf(){const vb=this.AQf&&this.isBusinessUser?Ub:fb;for(const ec in Ec)vb[ec]=
Ec[ec];return vb}Ae(){}get Yc(){return this.Ld.instance}bld(vb){return this.wv.SS?this.wv.JYb(vb):this.Yc.HF.HO(vb)}static twa(vb,ec,lb,Zb){return Telemetry.PrivacyRules.GetPrivacyCompliantId(vb,ec,lb,null,null,Zb)}q9f(vb,ec,lb){if(2!==ec)return 32;ec=this.wv.o5f(lb.CommandValueId);if(!ec)return v.ULS.sendTraceTag(507631072,220,10,"No search add-in details."),8;this.wv.YWf(ec).then(Zb=>{this.$ld(vb,lb,Zb)}).catch(Zb=>{v.ULS.sendTraceTag(507631071,220,10,Zb.message)});return 32}d$f(vb,ec,lb,Zb,qc){if(2!==
lb)return 32;const pc=qc[hc.a.JAa];qc=qc[hc.a.Ota];const ac={};ac.UC=qc.gt[z.a.UC];ac.assetId=pc.getId();ac.UW=qc.gt[z.a.UW];ac.showLoadingSpinner=qc.gt[z.a.showLoadingSpinner];ac.nonPersistedSettings=qc.gIa;return this.imd(vb,ec,lb,Zb,ac)}S8f(vb,ec,lb,Zb,qc){if(2!==lb)return 32;vb=qc[hc.a.JAa];qc=qc[hc.a.Ota];ec={};ec.UC=qc.gt[z.a.UC];ec.assetId=vb.getId();ec.sourceLocationOverrideResourceId=qc.gt[z.a.sourceLocationOverrideResourceId];ec.UW=qc.gt[z.a.UW];ec.nonPersistedSettings=qc.gIa;qc=this.Yc.nOa(ec);
return(qc=this.Yc.EV(qc))&&this.Yc.JOd(qc.mq)?32:8}S9f(vb,ec,lb,Zb,qc){if(2!==lb)return 32;vb=qc[hc.a.JAa];ec=qc[hc.a.Ota];qc={};qc.UC=ec.gt[z.a.UC];qc.assetId=vb.getId();qc.sourceLocationOverrideResourceId=ec.gt[z.a.sourceLocationOverrideResourceId];qc.UW=ec.gt[z.a.UW];qc.nonPersistedSettings=ec.gIa;vb=this.Yc.nOa(qc);return(vb=this.Yc.EV(vb))?(this.Yc.n4e(vb.mq,qc),32):8}m9f(vb,ec,lb,Zb,qc){if(!this.xR)return 16;if(!qc)return 8;if(1===lb)return 32;vb=Object(Ib.a)(String,qc);if(!vb||!vb.length)return 8;
if((ec=this.Yc.sWe(vb))&&ec.taskpane){if(this.Yc.dJb(vb))return this.Yc.Y9c(vb,!1),32;if(ec.Ty&&OSF.OsfControl.isFirstPartyStoreString(ec.Ty.storeType))return this.Yc.dkd(vb),this.Yc.HPk(vb),32;ec=ec.taskpane.ownerAddinSolutionId;if(this.Yc.bNj(vb)||ec)this.Yc.dkd(vb);else if(ec=this.Yc.eld(),lb=this.Vb.Lc(ec),vb=this.Yc.sKh(vb)){lb.Rk(Object(Ib.a)(ob.a,vb));vb=this.Tb.Kd(4,void 0,void 0,void 0,!0);try{vb.tc(ec),lb.Ui()}finally{vb&&vb.dispose()}}}return 32}R9f(vb,ec,lb,Zb,qc){if(!this.xR)return 16;
if(!qc)return 8;if(1===lb)return 32;ec=Object(Ib.a)(String,qc);if(!ec||!ec.length)return 8;this.Yc?this.Yc.uZa(ec):this.jA.afa(vb,qc);return 32}imd(vb,ec,lb,Zb,qc){if(!this.xR)return 16;if(!qc)return 8;if(1===lb)return 32;if(this.Yc){if(!qc||!qc.assetId||!G.AFrameworkApplication.dnd(qc.assetId))return 8;qc.nonPersistedSettings||(qc.nonPersistedSettings={});qc.nonPersistedSettings.ShowFeedback=G.AFrameworkApplication.Ny;!this.Aod&&this.Jwa&&(this.Aod=!0,vb=window.performance.now()-this.Jwa,v.ULS.sendTraceTag(512288597,
220,50,"Apps for office load time {0}",vb));vb=this.Yc.nOa(qc);if(vb=this.Yc.EV(vb))return this.Yc.n4e(vb.mq,qc),32;this.Yc.g_k(qc)}else this.Jwa||(this.Jwa=window.performance.now()),this.jA.rZ(),this.jA.afa(vb,qc);return 32}get euh(){return this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}o$f(vb,ec,lb,Zb,qc){if(1===lb)return this.xR?32:8;if(!this.xR)return 16;if(!(qc&&qc.EK&&-1!==qc.EK.state&&qc.EK.oib&&this.Yc))return 8;vb=this.Yc.cqb(qc.Ty.id);if(!vb)return 8;
ec=this.Tb.Kd(4,void 0,void 0,void 0,!0);try{ec.tc(vb),vb.setValue(Bc.a.tXa,qc.EK.state),vb.setValue(Bc.a.oMa,qc.EK.oib),vb.setValue(yc.a.zHb,qc.Ty.storeType)}finally{ec&&ec.dispose()}return 32}R8f(vb,ec,lb,Zb,qc){return this.xR?qc?1===lb?32:this.Yc&&qc&&qc.length?this.Yc.JOd(qc)?32:8:8:8:16}pZa(vb,ec,lb,Zb,qc){var pc;if(2===lb){ec=qc.callback;if(!ec)return 16;Cb.a("AllowQueryAddinsForStoreTypes")?this.Yc?this.T8g(ec,null!==(pc=qc.storeType)&&void 0!==pc?pc:OSF.StoreTypeEnum.MarketPlace):(qc=Object.assign({},
qc),this.jA.afa(vb,qc)):this.S8g(ec)}return 32}T8g(vb,ec){const lb=new Wa.a;lb.callbackFunc=vb;lb.storeType=ec;lb.fromInsertDialog=!1;lb.refresh="true"===Qb.a.instance.getItem(Pa.a.pid);this.Yc.Qq.queryEntitlementDetails(lb)}S8g(vb){const ec=new Wa.a;ec.callbackFunc=vb;ec.storeType=OSF.StoreTypeEnum.MarketPlace;ec.fromInsertDialog=!1;ec.refresh="true"===Qb.a.instance.getItem(Pa.a.pid);this.Yc.Qq.queryEntitlementDetails(ec)}Qib(vb){const ec=new I.a;ec.add(vb);vb={};vb[Pa.a.gKd]=ec;vb[Pa.a.Veb]=3;this.la.Ra(O.a.gce,
2,vb)}$cg(vb,ec){const lb=this.ya.Ia;if(!lb||this.qf.Hd(lb))return 16;if(!this.zj.KD(lb,1))return this.zj.qJ(lb),16;try{return this.F5d(vb,lb,lb.fc,ec)}catch(Zb){return 8}}F5d(vb,ec,lb,Zb){lb=ec.qIh(0,vb.width,vb.height,ec.Av()+1);ua.a.Yhd(lb,vb,this.Yc);this.Do.EO([Object(Ib.a)(351,lb)],ec,Zb);ea.a.add(vb.solutionId,vb.targetType,vb.storeId,vb.storeType,vb.version);return 32}sgb(vb){if(!this.Yc.EV(vb.solutionId)){var ec=this.Yc.cqb(vb.solutionId),lb=this.Yc.eld();if(ec){lb=new Da.a(ec);if(!lb.visibility){const Zb=
this.Tb.Kd(4,void 0,void 0,void 0,!0);try{Zb.tc(ec),ec.setValue(yc.a.akc,!0),ec.setValue(yc.a.zHb,vb.storeType)}finally{Zb&&Zb.dispose()}}this.Yc.uZa(lb.id)}else{ec=ua.a.PKf(this.Tod.value,vb,this.Yc);vb=this.Tb.Kd(4,void 0,void 0,void 0,!0);try{vb.tc(lb),ua.a.uza(lb,ec,19)}finally{vb&&vb.dispose()}}}}}Object(y.a)(Lc,"AppForOfficeActor",null,[502])},1157:function(y,C,a){a.d(C,"a",function(){return k});y=a(0);var c=a(410);C=a(562);class b extends C.a{constructor(l,u,r){u=void 0===u?null:u;r=void 0===
r?null:r;super("DeferredContentType");this.title=this.isDeferred=this.messageText=null;this.title=u;this.messageText=l;this.isDeferred=r}}Object(y.a)(b,"DeferredContentProps",C.a,[]);var d=a(40),e=a(831),h=a(832);const n=(l,u)=>Object.assign(new e.a,{target:".EditingRibbonPanel",content:l,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new h.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,preventDismissOnScroll:!0,onDismiss:u,preventDismissOnResize:!0})});var m=a(66);class k{constructor(){this.p_=
new b(ResourceStrings.l_DeferredContentDownloadACopyWaitToastMessage,ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle,!0)}hJh(l,u,r,x){x=Object.assign(new c.a,{onShow:()=>{r.jZ(m.a.fEb)}});u=l.callout(u);return x=l.addNotification(u,x)}eYh(l,u){l.removeNotification(u);d.a.$(523871964,843,10,"DownloadACopy Toast can not be removed!");return u}rIh(l){return n(this.p_,()=>{l.ns(m.a.fEb)})}}Object(y.a)(k,"DownloadACopyDeferred",null,[1004])},1177:function(y,C,a){a.d(C,"a",function(){return v});
y=a(0);var c=a(21),b=a(41),d=a(1722),e=a(360),h=a(158),n=a(143),m=a(173),k=a(372),l=a(51);class u{constructor(z,A){this.actionId=z;this.Wc=A}}Object(y.a)(u,"CommandActionData",null,[]);var r=a(44),x=a(42);class v{constructor(z,A,B,G,w){this.Epd=[];this.Vmd=!1;this.OQa=null;this.Tgb=new c.a;this.la=z;this.b8b=A;this.Evf=!1;this.Vb=B;this.qe=G;this.tSa=w;this.Qnd=this.Vwa=null;Object(x.a)("EnhancementOfSDXPaneBootTime")&&this.dcg()}dcg(){this.Vwa||(this.Vwa=b.AFrameworkApplication.oh("officeExtensionMerge.js",
5));this.Qnd||(this.Qnd=b.AFrameworkApplication.oh("appforoffice.hermes"+this.qe.FZe,1));if(!this.OQa){const z=[this.tSa.XVb(this.V$b)];this.OQa=d.a.create("pptedit.appforoffice",z,()=>a.e(22).then(a.bind(null,1896)))}}get Hxa(){return this.Epd}get V$b(){this.Vwa||(this.Vwa=b.AFrameworkApplication.oh("officeExtensionMerge.js",5));return this.Vwa}set V$b(z){this.Vwa=z}get czf(){if(!this.OQa){const z=[this.tSa.XVb(this.V$b)];this.OQa=d.a.create("pptedit.appforoffice",z,()=>a.e(22).then(a.bind(null,
1896)))}return this.OQa}zFh(z){this.Hxa.push(z)}rZ(){this.Vmd||(e.a.RK(this.czf),this.Vmd=!0)}Ful(){for(var z of this.Hxa)z.sEb();if(this.uhc&&0<this.Hxa.length){z={["solutionIds"]:this.Hxa.map(B=>B.$Lh())};const A=new m.a;A.name="Office.Extensibility.Host.ContentAddinsWithinFile";A.dataFields=h.a.Gt(z);n.a.sendTelemetryEvent(A)}this.Epd=[]}Gul(){var z=this.Vb.Lc(this.b8b.Tf).Fb(18);z=this.Vb.Lc(z);var A=z.Fb(19);if(A){const B=[];do{A=z.Bq;if(this.uhc){const G=new k.a(A);B.push(Telemetry.PrivacyRules.GetPrivacyCompliantId(G.hJa,
this.xfb(G.storeType),G.assetId,null,null,G.store))}this.la.Ra(r.a.uZa,2,A.jb(l.a.f7))}while(z.Df(19));this.uhc&&(z={["solutionIds"]:B},A=new m.a,A.name="Office.Extensibility.Host.TaskpaneAddinsWithinFile",A.dataFields=h.a.Gt(z),n.a.sendTelemetryEvent(A))}}get uhc(){var z;return null===(z=b.AFrameworkApplication.ha)||void 0===z?void 0:z.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TelemetryForAddinsWithinFileEnabled",!1)}xfb(z){switch(z){case 0:z="spcatalog";break;case 1:z="filesystem";break;
case 2:z="omex";break;case 3:z="spapp";break;case 4:z="registry";break;case 5:z="inmemory";break;case 6:z="uploadfiledevcatalog";break;case 7:z="excatalog";break;case 8:z="firstparty";break;case 9:z="sdxcatalog";break;default:throw Error.create(`[${z}] is not the valid store type int value.`);}return z}afa(z,A){this.Tgb.add(new u(z,A))}Lxj(){if(0<this.Tgb.count){for(const z of this.Tgb)this.la.Ra(z.actionId,2,z.Wc);this.Tgb.clear()}}x$f(){const z=!!this.Hxa&&0<this.Hxa.length;let A=!1;if(this.b8b.Tf&&
!z){const B=this.Vb.Lc(this.b8b.Tf).Fb(18);B&&0<this.Vb.Lc(B).A5(19)&&(A=!0)}return z||A}}Object(y.a)(v,"AppForOfficeManagerFactory",null,[968])},1241:function(y,C,a){a.d(C,"a",function(){return c});y=a(44);a=a(48);const c=[a.a.knb,a.a.TLd,a.a.VLd,a.a.bAf,a.a.hzc,a.a.fnb,y.a.Eza,y.a.Kpa,a.a.WKd,a.a.wxi,a.a.Vva,a.a.kzc,a.a.lzc,y.a.Sma,y.a.o2a,y.a.bLd,y.a.Z0,y.a.XHa,y.a.YHa,y.a.Wva,y.a.qXa,y.a.WTe,a.a.oV,a.a.HP,a.a.NLd,a.a.knb,a.a.PLd,a.a.QLd,a.a.RLd,a.a.backspace,a.a.Iza,a.a.Izc,a.a.Wzi,y.a.pMa,a.a.bold,
y.a.bold,y.a.bringForward,y.a.bringToFront,y.a.cDi,a.a.centerJustify,a.a.n7,a.a.o7,a.a.vS,a.a.clearFormatting,a.a.rBc,a.a.GMa,a.a.sOd,y.a.L2a,y.a.$Ac,y.a.ZHa,y.a.lfb,y.a.mfb,y.a.uH,y.a.clearFormatting,y.a.HMa,y.a.Bkc,y.a.Vjd,a.a.sNa,a.a.uG,y.a.vNa,y.a.editSlideTitle,a.a.enter,a.a.IFc,y.a.AGc,a.a.font,y.a.Uba,y.a.flc,y.a.bHc,a.a.fullJustify,a.a.Cia,a.a.HD,y.a.Ffa,a.a.insertHyperlink,y.a.Cmd,a.a.xsb,a.a.sLj,a.a.Emd,y.a.Fmd,y.a.Gmd,a.a.insertOnlinePicture,y.a.insertOnlinePicture,a.a.insertPicture,y.a.insertPicture,
a.a.bja,a.a.S7,y.a.$Ib,y.a.IMc,y.a.L0b,y.a.LMc,y.a.PMc,y.a.QMc,y.a.RMc,y.a.SMc,y.a.TMc,y.a.UMc,y.a.M0b,y.a.N0b,y.a.pna,y.a.Mlc,y.a.aJb,a.a.tgb,a.a.insertTable,a.a.kQc,a.a.kub,a.a.lub,a.a.mub,a.a.lQc,a.a.nQc,a.a.oQc,a.a.nub,a.a.oub,a.a.pub,a.a.pQc,a.a.qub,a.a.rub,a.a.tub,a.a.leftJustify,a.a.j8,y.a.mergeTableCells,y.a.Mre,y.a.vta,a.a.YB,a.a.qbc,y.a.Pna,y.a.pnc,y.a.qnc,y.a.Gqd,a.a.m0,y.a.tbc,y.a.d4c,y.a.d4c,y.a.yKb,y.a.vY,y.a.Bnc,y.a.Tbc,y.a.Cye,y.a.Qna,y.a.XTa,y.a.dX,y.a.eX,y.a.Cnc,a.a.cH,y.a.ZKb,y.a.$Kb,
y.a.fLb,a.a.fLb,a.a.I1k,y.a.yeh,y.a.oGa,y.a.nib,y.a.isd,y.a.sendBackward,y.a.yoc,y.a.sendToBack,y.a.NC,y.a.Up,y.a.Gfc,a.a.Ap,a.a.setItalic,y.a.uxa,y.a.zk,y.a.xLb,y.a.Aib,y.a.Tsd,a.a.hEb,y.a.EJe,y.a.Hgc,a.a.subscript,a.a.superscript,y.a.XLe,y.a.T9,y.a.Hib,a.a.EFb,a.a.mH,a.a.sJ,a.a.VA,a.a.underline]},1242:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);var c=a(50);class b{createAuthProviderAsync(d){c.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").rZ();return new Promise(e=>
{c.a.instance.eb("PowerPointWebEditor.IAppForOfficeAuthFactory").execute(h=>{h=h.kWl(d);e(h)})})}}Object(y.a)(b,"SlideShowAppForOfficeAuthFactory",null,[])},1243:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c extends Sys.EventArgs{constructor(b){super();this.slideId=b.SlideId;this.slideIndex=b.SlideIndex;this.ztd=b.TimeLineMappings}}Object(y.a)(c,"OnPositionChangedEventArgs",Sys.EventArgs,[])},1244:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}c.CoachButton="coachButton";
c.MicButton="micButton";c.PrevButton="prevButton";c.NextButton="nextButton";c.GridButton="gridButton";c.InkButton="inkButton";c.SubtitlesButton="subButton";c.LiveButton="liveButton";c.MoreButton="moreButton";c.ExitButton="exitButton";c.CameraButton="cameraButton";c.OptionsButton="optionsButton";c.SlideIndex="slideIndex";Object(y.a)(c,"SlideshowToolbarButtonIDs",null,[])},1246:function(y,C,a){a.d(C,"a",function(){return b});var c=a(50);const b=()=>c.a.instance.eb("Common.App.SharedFilePicker.ISharedFilePicker")},
1247:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);var c;(function(b){b[b.notSupported=0]="notSupported";b[b.rAn=1]="launchByLocalCacheInitializer";b[b.nAn=2]="launchByAnonymousApiInitializer";b[b.pAn=3]="launchByInsertion";b[b.sAn=4]="launchByRefresh";b[b.qAn=5]="launchByLastUpdateInitializer";b[b.oAn=6]="launchByDynamicCall"})(c||(c={}));Object(y.b)("AddinCommandsLaunchOperationType",c)},1250:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}Object(y.a)(c,"OnlineMediaSearchResult",
null,[])},1251:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(b,d){this.QFn=b;this.sGn=d}get LOh(){return this.QFn}get a8n(){return this.sGn}}Object(y.a)(c,"ReportSuggestionSessionActionData",null,[])},1252:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}c.lZl="Provider.UCI.Editor";c.gZl="EntityGroup.UCI.Editor";c.DAm="Provider.Designer.Slide";c.CAm="EntityGroup.Designer.Slide.Suggestion";c.KAm="Provider.Designer.TextToSmartArt";c.IAm="EntityGroup.Designer.TextToSmartArt.Suggestion";
Object(y.a)(c,"InfraredConstant",null,[])},1397:function(y,C,a){a.d(C,"a",function(){return d});y=a(0);var c=a(205),b=a(124);class d{constructor(e){this.kq=e;this.eM=Array.indexOf(this.kq,this.rfa)}dispose(){this.kq=null}get T2(){return this.kq[this.eM]}qO(e){this.uib(e,!1);return!0}G4a(e){this.uib(e,!0)}uib(e,h){e&&(this.T2!==e||h)&&(e.tabIndex=0,b.FocusManager.vz(e));Array.contains(this.kq,e)&&(this.eM=Array.indexOf(this.kq,e))}get L3e(){let e=this.eM;do if(e)if(0<e&&e<this.kq.length)e--;else break;
else e=this.kq.length-1;while(!c.DOMFocusListing.Jba(this.kq[e])&&e!==this.eM);return this.kq[e]}get w1e(){let e=this.eM;do if(e===this.kq.length-1)e=0;else if(0<=e&&e<this.kq.length-1)e++;else break;while(!c.DOMFocusListing.Jba(this.kq[e])&&e!==this.eM);return this.kq[e]}get rfa(){let e=0;for(;!c.DOMFocusListing.Jba(this.kq[e])&&e<this.kq.length;)e++;return c.DOMFocusListing.Jba(this.kq[e])?this.kq[e]:null}get Aub(){let e=this.kq.length-1;for(;!c.DOMFocusListing.Jba(this.kq[e])&&0<e;)e--;return c.DOMFocusListing.Jba(this.kq[e])?
this.kq[e]:null}}Object(y.a)(d,"DialogFocusListing",null,[141])},1398:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}Object(y.a)(c,"AppsForOfficeEntitlementQueryInfo",null,[])},1416:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);var c=a(91);class b{constructor(d){this.fwb=this.G5b=null;this.kj=d}dispose(){this.clear();this.G5b.parentNode.removeChild(this.G5b)}YTb(d){this.G5b=this.VKf(d,"prContainerHr");this.fwb=this.VKf(this.G5b,"prGlyph")}clear(){this.lec()}setImage(d,e){d&&
(this.lec(),this.fwb.appendChild(d),this.fwb.style.backgroundColor=e,this.G5b.style.visibility=c.a.visible)}VKf(d,e){const h=this.kj.kg();this.kj.addCssClass(h,e);d.appendChild(h);return h}lec(){this.fwb.firstChild&&this.fwb.removeChild(this.fwb.firstChild)}}Object(y.a)(b,"ShapePawnGlyph",null,[])},1418:function(y,C,a){a.d(C,"a",function(){return k});y=a(0);var c=a(405),b=a(1263),d=a(1703),e=a(6),h=a(21),n=a(53),m=a(42);class k{constructor(l,u,r,x,v,z,A,B,G){this.gO=new b.a;this.qS=w=>w.isDecorative?
ResourceStrings.L_AccMessageDecorative:w.get_altTitle();this.ANg=l;this.Xb=u;this.J5=v;this.La=r;this.Ld=z;this.SRc=A;this.uq=x;this.Rj=B;this.na=G;this.FIj()}get Yc(){return this.Ld.instance}get D2(){return this.SRc.value}FIj(){var l;this.gO.fa(0,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.gO.fa(1,[ResourceStrings.l_PhTypeBody,ResourceStrings.l_ClickToAddText]);this.gO.fa(2,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.gO.fa(3,[ResourceStrings.l_PhTypeSubTitle,
ResourceStrings.l_ClickToAddSubTitle]);this.gO.fa(8,[ResourceStrings.l_PhTypeObject,ResourceStrings.l_ClickToAddText]);this.gO.fa(9,[ResourceStrings.l_PhTypeGraph,ResourceStrings.l_InsertContent]);this.gO.fa(10,[ResourceStrings.l_PhTypeTable,ResourceStrings.l_InsertContent]);this.gO.fa(11,[ResourceStrings.l_PhTypeClipArt,ResourceStrings.l_InsertContent]);this.gO.fa(12,[ResourceStrings.l_PhTypeSmartArt,ResourceStrings.l_ClickToAddSmartArt]);this.gO.fa(13,[ResourceStrings.l_PhTypeMedia,ResourceStrings.l_InsertContent]);
this.gO.fa(15,[ResourceStrings.l_PhTypePicture,ResourceStrings.l_ClickToAddPicture]);this.gO.fa(6,[ResourceStrings.l_PhTypeFooter,ResourceStrings.l_ClickToAddFooter]);this.gO.fa(5,[ResourceStrings.l_PhTypeSlideNumber,ResourceStrings.l_ClickToAddSlideNumber]);(null===(l=this.na)||void 0===l?0:l.qYa)&&this.gO.fa(16,[ResourceStrings.l_PhTypeCameo,ResourceStrings.l_ClickToAddCameo])}pqj(l,u){l&&(this.MV(l,u),l.Gwa?u.insert(0,document.createTextNode(ResourceStrings.l_ShapeObject)):this.b0d(l,null,u));
return null}t4l(l){if(!this.ANg.instance||!l)return null;l=this.ANg.instance.Bqj(l);if(!l||!l.length)return null;const u=l.length;return 1===u?String.format(ResourceStrings.l_ShapePresenceForOneUser,l[0].userName):2===u?String.format(ResourceStrings.l_ShapePresenceForTwoUsers,l[0].userName,l[1].userName):3===u?String.format(ResourceStrings.l_ShapePresenceForThreeUsers,l[0].userName,l[1].userName,l[2].userName):String.format(ResourceStrings.l_ShapePresenceForFourOrMoreUsers,u)}wMh(l){let u="";l&&l.YV&&
l.image.title&&0<l.image.title.length&&(u=l.image.title);l&&(u=String.format(ResourceStrings.l_ThumbnailInfoNew,l.slideIndex+1,this.Xb.zl(),u),l=this.ptj(l),0<l.length&&(u+=l));return u}ptj(l){const u=new Sys.StringBuilder;l.isSelected&&u.append(ResourceStrings.L_SlideIsSelected);l.Kl&&u.append(ResourceStrings.l_SlideIsHidden);const r=Object(d.a)(22,l.Ed);if(r){var x=r.HOa();x&&!this.uq.nZe(x)&&u.append(ResourceStrings.l_SlideHasNotes);(x=r.TX())&&this.J5.instance&&this.J5.instance.WMh(x)&&(x=this.J5.instance.OWe(x),
u.append(1===x?ResourceStrings.l_SlideHasOneComment:String.format(ResourceStrings.l_SlideHasCommentsWithCount,x)))}l.RZ&&u.append(ResourceStrings.l_SlideHasAnimationOrTransition);if(l.HKb&&(l=l.HKb.hYa())&&0<l.length)if(1===l.length)u.append(String.format(ResourceStrings.l_SlideHasPresenceForOneUser,l[0].userName));else{x="";for(const v of l)x+=v.userName+",";u.append(String.format(ResourceStrings.l_SlideHasPresenceForTwoOrMoreUsers,x))}r&&r.isUnread&&u.append(ResourceStrings.l_RevisionTracking_SlideHasUnreadChanges);
return u.toString()}Hld(l,u){return String.format(ResourceStrings.l_MultipleSlidesSelected,l,u)}z2l(l,u){return String.format(ResourceStrings.l_DesignerSuggestionSelected,l+1,u)}A4l(){return ResourceStrings.l_SlidePanel}s3l(){return ResourceStrings.l_MultipleShapes}otm(l){l&&(this.na.zMa&&l.b6(Object(e.a)(this,this.aej,"getCameoAccMessage")),l.b6(Object(e.a)(this,this.ssj,"getTableAccMessage")),l.b6(Object(e.a)(this,this.vjj,"getImageAccMessage")),l.b6(Object(e.a)(this,this.olj,"getMediaAccMessage")),
l.b6(Object(e.a)(this,this.pej,"getChartAccMessage")),this.vad?(l.b6(Object(e.a)(this,this.a6f,"getSmartArtAccMessage")),l.b6(Object(e.a)(this,this.b0d,"getPlaceHolderAccMessage"))):(l.b6(Object(e.a)(this,this.b0d,"getPlaceHolderAccMessage")),l.b6(Object(e.a)(this,this.a6f,"getSmartArtAccMessage"))),l.b6(Object(e.a)(this,this.htj,"getTextboxAccMessage")),l.b6(Object(e.a)(this,this.sqj,"getShapeGroupAccMessage")),l.b6(Object(e.a)(this,this.oqj,"getShapeAccMessage")),l.b6(Object(e.a)(this,this.Hcj,
"getAddinAccMessage")),l.b6(Object(e.a)(this,this.vcj,"get3DAccMessage")))}b0d(l,u,r,x){x=void 0===x?null:x;if(l&&r&&l.Bl&&(this.nKc(l,r),this.gO.Sb(l.placeholderType))){x&&x(String.format("{0} {1}",this.gO.ka(l.placeholderType)[0],ResourceStrings.l_Placeholder));if(l.rU||!r.count){r=this.gO.ka(l.placeholderType)[0];u="";if(!this.vad||l.rU)u=this.gO.ka(l.placeholderType)[1];return String.format(l.get_alt()?ResourceStrings.l_AccMessagePlaceHolderPromptAlt:ResourceStrings.l_AccMessagePlaceHolderPrompt,
r,this.qS(l),u,l.get_alt())}l=String.format(l.get_alt()?ResourceStrings.l_AccMessagePlaceHolderTextAlt:ResourceStrings.l_AccMessagePlaceHolderText,this.gO.ka(l.placeholderType)[0],this.qS(l),l.get_alt());r.insert(0,document.createTextNode(l))}return null}htj(l,u,r,x){x=void 0===x?null:x;if(l&&r&&l.yr)if(this.nKc(l,r),x&&x(ResourceStrings.L_TextBox),0<r.count)l=String.format(l.get_alt()?ResourceStrings.l_AccMessageTextboxHasTextAlt:ResourceStrings.l_AccMessageTextboxHasText,this.qS(l),l.get_alt()),
r.insert(0,document.createTextNode(l));else return String.format(l.get_alt()?ResourceStrings.l_AccMessageTextboxNoTextAlt:ResourceStrings.l_AccMessageTextboxNoText,this.qS(l),l.get_alt());return null}a6f(l,u,r,x){x=void 0===x?null:x;if(l&&r&&l.xg)if(this.nKc(l,r),x&&x(ResourceStrings.L_SmartArt),0<r.count)l=String.format(l.get_alt()?ResourceStrings.l_AccMessageSmartArtHasTextAlt:ResourceStrings.l_AccMessageSmartArtHasText,this.c6f(l)||"",this.qS(l),l.get_alt()),r.insert(0,document.createTextNode(l));
else return String.format(l.get_alt()?ResourceStrings.l_AccMessageSmartArtNoTextAlt:ResourceStrings.l_AccMessageSmartArtNoText,this.c6f(l)||"",this.qS(l),l.get_alt());return null}MV(l,u){l&&u&&this.La.fJ(l,r=>{r.Va(n.a.Tq)&&this.D2f(r,u)})}nKc(l,u){if(l&&u){const r=this.vad?new h.a:u;let x=!1;this.La.fJ(l,v=>{const z=this.Rj.gY(v),A=this.Rj.gbc(v);z&&r.add(document.createTextNode(String.format(ResourceStrings.l_AccMessageTextLevel,A)));x=this.D2f(v,r)||x});this.vad&&x&&u.addRange(r);u.count||(l=l.xMe)&&
u.add(document.createTextNode(l))}}get vad(){return m.a("AriaMessageHelper.FixAccMessageForEmptyList")}D2f(l,u){let r;const x=l.ra(n.a.Bhc,null),v=l.ra(n.a.Tq,"");if(v&&u){if(x){let z=0,A=null,B;for(let G=0;G<x.length+1;G++)B=this.La.UIc(l,G),A&&A!==B&&(r=document.createElement("span"),r.setAttribute("lang",A),r.innerText=v.substring(z,x[G-1]),z=x[G-1],u.add(r)),A=B;r=document.createElement("span");A&&r.setAttribute("lang",A);r.innerText=v.substring(z,v.length)}else r=document.createElement("span"),
(l=this.La.UIc(l,0))&&r.setAttribute("lang",l),r.innerText=v;u.add(r)}return!!v&&0<v.length}ssj(l,u,r,x){x=void 0===x?null:x;return l&&l.gd?(x&&x(ResourceStrings.L_Table),String.format(l.get_alt()?ResourceStrings.l_AccMessageTableAlt:ResourceStrings.l_AccMessageTable,this.qS(l),l.get_alt())):null}vjj(l,u,r,x){x=void 0===x?null:x;return l&&l.Pg?(x&&x(ResourceStrings.l_Image),String.format(l.get_alt()?ResourceStrings.l_AccMessageImageAlt:ResourceStrings.l_AccMessageImage,this.qS(l),l.get_alt())):null}aej(l,
u,r,x){x=void 0===x?null:x;if(!l||!l.RB)return null;x&&x(ResourceStrings.l_Cameo);return l.get_alt()?String.format(ResourceStrings.l_AccMessageCameoAlt,this.qS(l),l.get_alt(),ResourceStrings.l_CameoLearnMoreMessage):String.format(ResourceStrings.l_AccMessageCameo,this.qS(l),ResourceStrings.l_CameoLearnMoreMessage)}olj(l,u,r,x){x=void 0===x?null:x;if(l){if(0===l.mediaType)return null;if(1===l.mediaType)return x&&x(ResourceStrings.l_Audio),this.na.JP?String.format(ResourceStrings.l_AccMessageCanvasAudio,
l.shapeName):String.format(l.get_alt()?ResourceStrings.l_AccMessageAudioAlt:ResourceStrings.l_AccMessageAudio,this.qS(l),l.get_alt());if(2===l.mediaType)return x&&x(ResourceStrings.l_Video),String.format(l.get_alt()?ResourceStrings.l_AccMessageVideoAlt:ResourceStrings.l_AccMessageVideo,this.qS(l),l.get_alt())}return null}pej(l,u,r,x){x=void 0===x?null:x;return l&&l.Im?(x&&x(ResourceStrings.l_Chart),String.format(l.get_alt()?ResourceStrings.l_AccMessageChartAlt:ResourceStrings.l_AccMessageChart,this.qej(l)||
"",this.qS(l),l.get_alt())):null}sqj(l,u,r,x){x=void 0===x?null:x;return l&&l.Ge?(x&&x(ResourceStrings.L_GroupObjects),m.a("GroupShapeAltTitleFixEnabled")?String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,l.Mu().length,l.get_alt()):String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,this.qS(l),l.get_alt())):null}oqj(l,u,r,x){x=void 0===x?null:x;if(l&&r&&l.Gwa&&!l.yr)if(this.nKc(l,r),u=this.La.L5f(l),
l.Cwa&&(u=ResourceStrings.l_DecorativeLabel),x&&x(u||ResourceStrings.l_TextShape),0<r.count)l=String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeHasTextAlt:ResourceStrings.l_AccMessageShapeHasText,u||ResourceStrings.l_TextShape,this.qS(l),l.get_alt()),r.insert(0,document.createTextNode(l));else return String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeNoTextAlt:ResourceStrings.l_AccMessageShapeNoText,u||ResourceStrings.l_TextShape,this.qS(l),l.get_alt());return null}Hcj(l,u,r,x){x=
void 0===x?null:x;return l&&l.au&&this.Yc&&this.D2?(l=this.D2.VMa(l),l=this.Yc.OXd(l.id),x&&x(l?l.bfb:null),l?l.bfb:null):null}vcj(l,u,r,x){x=void 0===x?null:x;return l&&l.E5?(x&&x(ResourceStrings.l_3DModel),String.format(l.get_alt()?ResourceStrings.l_AccMessage3DAlt:ResourceStrings.l_AccMessage3D,this.qS(l),l.get_alt())):null}c6f(l){return l.smartArtInfo?k.Q0d(l.smartArtInfo.SmartArtLayout,1,177,"L_SAType"):(c.ULS.sendTraceTag(509092052,815,10,"SmartArt {0}#{1} has no SmartArtInfo",l.slideId?l.slideId.toString():
"",l.get_shapeId()),null)}qej(l){return k.Q0d(l.chartType,0,102,"L_ChartType")}u4l(l,u){return(l=this.La.Nld(l))&&u?String.format(ResourceStrings.l_RevisionTracking_ShapeHasUnreadChanges,u,l):null}static $4l(l){return k.Q0d(l,1,177,"L_SAType")}static Q0d(l,u,r,x){return l>=u&&l<=r&&(l=ResourceStrings[x+l])?l:null}}Object(y.a)(k,"AriaMessageHelper",null,[530])},1432:function(y,C,a){a.d(C,"b",function(){return b});a.d(C,"a",function(){return d});var c=a(50);const b=()=>c.a.instance.Db("Common.IEventEmitter<Common.IGetMoreInfoResult>"),
d=()=>c.a.instance.eb("Common.IEventEmitter<Common.IGetMoreInfoResult>")},1433:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}Object(y.a)(c,"ProviderActionInfo",null,[])},1434:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.Label=this.CorrelationId=null;this.ShapeId=this.ReplaceObjectType=0;this.SmartArtSubNodeId=null;this.SuggestionSid=0}}Object(y.a)(c,"ReplaceObjectSuggestionApplyInfo",null,[])},1460:function(y,
C,a){a.d(C,"a",function(){return Kb});var c=a(81);y=a(0);var b=a(595),d=a(30),e=a(143),h=a(41),n=a(114),m=a(88),k=a(340),l=a(64),u=a(69),r=a(50),x=a(132),v=a(118),z=a(46),A=a(15),B=a(40),G=a(42),w=a(108),F=a(848);class H extends Sys.EventArgs{constructor(nb){super();this.clientX=nb.ClientX;this.clientY=nb.ClientY}}Object(y.a)(H,"OnBrowserEventArgs",Sys.EventArgs,[]);class E extends Sys.EventArgs{constructor(nb){super();this.slideId=nb.SlideId;this.slideIndex=nb.SlideIndex;this.n9l=nb.IsBeforeReady;
this.M9l=nb.IsFromEndOfSlideshow;this.summary=nb.Summary}}Object(y.a)(E,"OnExitSlideshowEventArgs",Sys.EventArgs,[]);class P extends Sys.EventArgs{constructor(nb){super();this.slideId=nb.SlideId;this.slideIndex=nb.SlideIndex;this.ztd=nb.TimeLineMappings}}Object(y.a)(P,"OnGetCurrentPositionEventArgs",Sys.EventArgs,[]);class T extends Sys.EventArgs{constructor(nb){super();this.slideHeight=nb.SlideHeight;this.slideWidth=nb.SlideWidth;this.Jll=nb.SlideLeftBound;this.yll=nb.SlideBottomBound}}Object(y.a)(T,
"OnGetCurrentSlideDimensionsEventArgs",Sys.EventArgs,[]);class K extends Sys.EventArgs{constructor(nb){super();this.code=nb.Code;this.reason=nb.Reason;this.podSessionId=nb.PodSessionId}}Object(y.a)(K,"OnPodSessionExpiredEventArgs",Sys.EventArgs,[]);var M=a(1243);class N extends Sys.EventArgs{constructor(nb){super();this.clientX=nb.ClientX;this.clientY=nb.ClientY}}Object(y.a)(N,"OnSlideshowContextMenuEventArgs",Sys.EventArgs,[]);class I extends Sys.EventArgs{constructor(nb){super();this.key=nb.Key;
this.shiftKey=nb.ShiftKey;this.altKey=nb.AltKey}}Object(y.a)(I,"OnSpecialKeyEventArgs",Sys.EventArgs,[]);var O=a(1703);class Q extends Sys.EventArgs{constructor(nb){super();this.C1h=null;this.C1h="string"===typeof nb?Object(O.a)(String,nb):nb.TranscriberSessionId}}Object(y.a)(Q,"OnTranscriberStartedEventArgs",Sys.EventArgs,[]);class U extends Sys.EventArgs{constructor(nb){super();this.isVisible=nb.IsVisible}}Object(y.a)(U,"OnVisibilityChangeEventArgs",Sys.EventArgs,[]);var ba=a(1242),aa=a(6);class La{}
La.speechMode="Subtitles";La.tNf=[La.speechMode];La.sourceLanguage=null;La.targetLanguages=null;La.speechFDBase=null;La.podSessionId=null;La.NAh=null;La.docId=null;La.webServiceBase=null;La.userSessionId=h.AFrameworkApplication.userSessionId;Object(y.a)(La,"PPTSpeechClientConfig",null,[]);class Z{constructor(){this.xa=new d.a}onFinalRecognitionText(nb){this.xa.raiseEvent("OnFinalRecognitionText",nb)}onPartialRecognitionText(nb){this.xa.raiseEvent("OnPartialRecognitionText",nb)}onError(nb){this.xa.raiseEvent("OnError",
nb)}onSpeechRecognitionStarted(nb){this.xa.raiseEvent("OnSpeechRecognitionStarted",nb)}onEventUpdate(nb){this.xa.raiseEvent("OnEventUpdate",nb)}Psi(nb){this.xa.addHandler("OnFinalRecognitionText",nb)}CYk(nb){this.xa.removeHandler("OnFinalRecognitionText",nb)}aui(nb){this.xa.addHandler("OnPartialRecognitionText",nb)}pZk(nb){this.xa.removeHandler("OnPartialRecognitionText",nb)}Lsi(nb){this.xa.addHandler("OnError",nb)}yYk(nb){this.xa.removeHandler("OnError",nb)}Bui(nb){this.xa.addHandler("OnSpeechRecognitionStarted",
nb)}LZk(nb){this.xa.removeHandler("OnSpeechRecognitionStarted",nb)}Msi(nb){this.xa.addHandler("OnEventUpdate",nb)}AYk(nb){this.xa.removeHandler("OnEventUpdate",nb)}}Object(y.a)(Z,"PPTSpeechClientObserverController",null,[]);var la=a(405);class da{constructor(){this.accessToken=null}}Object(y.a)(da,"IAuthenticationProvider",null,[]);class J{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(y.a)(J,"IDocumentDownloadConfig",null,[]);class Ca{constructor(){this.documentDownloadConfig=
this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.microphoneDeviceId=null}}Object(y.a)(Ca,"ISpeechConfig",null,[]);class Fa{constructor(nb){this.x4=nb}onFinalText(){}onFragmentText(){}onFinalRecognitionText(nb,Ka){this.x4.onFinalRecognitionText(nb,Ka)}onPartialRecognitionText(nb,Ka){this.x4.onPartialRecognitionText(nb,
Ka)}onError(nb){if("ErrorNone"!==nb)switch(nb){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.x4.onError("AccessDenied");break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.x4.onError("FailedToConnect");break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.x4.onError("Timeout");
break;case "ErrorInitialSilenceTimeout":this.x4.onError("InitialSilenceTimeout");break;case "ErrorSpeechRecognitionFailure":case "ErrorTranslationFailure":case "ErrorFailedToGetSupportedTextLanguages":case "ErrorUnknown":this.x4.onError("UnknownError");break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":this.x4.onError("MicrophoneError");break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":this.x4.onError("NotAllowedError");
break;case "ErrorAudioNotFoundError":this.x4.onError("NotFoundError");break;case "ErrorAudioNotReadableError":this.x4.onError("NotReadableError");break;default:this.x4.onError("CustomError-"+nb)}}onSpeechRecognitionStarted(nb){la.ULS.sendTraceTag(507843283,830,50,"PPTSpeechClientObserver::OnSpeechRecognitionStarted {0}",nb);this.x4.onSpeechRecognitionStarted(nb)}onEventUpdate(nb){this.x4.onEventUpdate(nb)}}Object(y.a)(Fa,"PPTSpeechClientObserver",null,[726]);class ya{constructor(nb){this.U8=null;
this.AEa=0;this.microphoneDeviceId="";this.Zmk=new Fa(nb)}CYj(){return 2===this.AEa}pKj(){const nb=this.ZKf(),Ka=Object.assign(new da,{accessToken:""});this.U8&&0!==this.AEa&&(this.U8.stopSpeechRecognition(),this.AEa=0);this.U8=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(nb,this.Zmk,Ka,null,new b.a);return this.U8?!0:(la.ULS.sendTraceTag(507843219,830,10,"Speech client was not successfully created"),!1)}Eph(){this.U8&&(0===this.AEa?(this.U8.startSpeechRecognition(),this.AEa=2):1===
this.AEa&&(this.U8.resumeSpeechRecognition(),this.AEa=2))}Snl(){this.U8&&(this.U8.stopSpeechRecognition(),this.AEa=0)}WEk(){this.U8&&(this.U8.pauseSpeechRecognition(),this.AEa=1)}setCustomSetting(nb,Ka){this.U8&&this.U8.setCustomSetting(nb,Ka)}ZKf(){return Object.assign(new Ca,{speechMode:La.speechMode,sourceLanguage:La.sourceLanguage,targetLanguages:La.targetLanguages,speechFDBase:La.speechFDBase,captureAudioPauseResumeRecordingState:!0,clientApp:0,documentDownloadConfig:Object.assign(new J,{docId:La.docId,
podsSessionId:La.podSessionId,userDataCenterClusterId:La.NAh,webServiceBase:La.webServiceBase}),userSessionId:La.userSessionId,microphoneDeviceId:this.microphoneDeviceId})}}Object(y.a)(ya,"PPTSpeechClientProxy",null,[]);var Ua;(function(nb){nb[nb.none=0]="none";nb[nb.singleLineRibbon=1]="singleLineRibbon";nb[nb.multipleLineRibbon=2]="multipleLineRibbon";nb[nb.slideShowToolbar=3]="slideShowToolbar";nb[nb.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";nb[nb.liveBroadcast=5]="liveBroadcast"})(Ua||
(Ua={}));Object(y.b)("TranscriptionEntryPoint",Ua);var Ia=a(1129),Oa=a(89),ma=a(90);class za{constructor(){this.Kf=this.V8=this.AC=this.h$a=this.nr=this.Ad=this.na=this.Yd=this.xf=null;this.Hwb=!1;this.Hv=null;this.p$a=this.Dpd=0;this.fAg=!1;this.DEa=this.CEa="";this.zTc=!1;this.Npe="";this.yfe=0;this.gUc=this.Zwa=this.$Zc="";this.M3=null;this.ita={};this.Dka=new Z;this.N8=new ya(this.Dka);za.sKj()}init(nb,Ka,Sb,ab,ub,Aa,tb){B.a.$(512495707,830,50,"SlideshowSubtitles.Init");this.Kf=Ka;this.na=nb;
this.xf=Sb;this.Ad=ab;this.Hv=ub;this.Yd=Aa;this.M3=tb;this.nr=document.createElement("div");this.nr.id="SubtitleContainer";this.nr.className="SubtitleContainer";this.nr.style.display=Oa.a.Uf;this.nr.style.visibility=Oa.a.ht;this.h$a=document.createElement("div");this.h$a.id="SubtitleResultDiv";this.h$a.className="SubtitleResultDiv";this.xf.Q_l&&(this.h$a.style.direction="rtl");this.AC=document.createElement("span");this.AC.id="SubtitleResultSpan";this.AC.className="SubtitleResultSpan";this.AC.setAttribute("aria-hidden",
"true");this.V8=document.createElement("span");this.V8.id="SubtitleAccessibilitySpan";this.V8.className="SubtitleAccessibilitySpan";this.V8.innerText="";this.V8.setAttribute("lang",this.xf.Rdb);this.V8.setAttribute("aria-live","assertive");this.V8.setAttribute("aria-label",ResourceStrings.L_SubtitleAccessibilityWindow);this.V8.setAttribute("aria-atomic","true");this.h$a.appendChild(this.AC);this.h$a.appendChild(this.V8);this.nr.appendChild(this.h$a);this.Kf.appendChild(this.nr);k.a.instance.Ub(this.AC,
()=>!1);h.AFrameworkApplication.ha.fY?this.uu():h.AFrameworkApplication.ha.Wf(Object(aa.a)(this,this.uu,"onFullAppSettingsReady"))}uu(){this.$Zc=this.getUserId();this.Zwa=h.AFrameworkApplication.ha.Ma("TenantId");this.gUc=this.na.hostAuthType||h.AFrameworkApplication.ha.Ma("HostAuthType")||"Unknown"}getUserId(){let nb=h.AFrameworkApplication.ha.Ma("PptEditingUserId");l.a.wb(nb)&&(nb=h.AFrameworkApplication.ha.Ma("LoggableUserId"),B.a.$(512495706,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",
l.a.wb(nb)));return nb}hYk(){this.nr.style.display=Oa.a.Uf;this.nr.style.visibility=Oa.a.ht}cWa(nb,Ka,Sb,ab,ub,Aa){this.Ztb()&&(this.Hv.instance.show(ResourceStrings.L_SubtitleDetection_SoundReminder,Ia.a.Gse),this.Dpd=window.setTimeout(Object(aa.a)(this,this.Kag,"hideSoundReminderNotification"),3E3));this.tAl(Ka,Sb,ab,this.xf);this.N8&&(this.N8.microphoneDeviceId=this.M3.microphoneDeviceId);this.xf.Jt&&this.N8.pKj()?(this.ita.StartTime=Aa,this.ita.LastError="ErrorNone",this.ita.EntryPoint=Ua[ub],
this.Dka.Psi(Object(aa.a)(this,this.RZg,"onFinalRecognitionTextHandler")),this.Dka.aui(Object(aa.a)(this,this.Z_g,"onPartialRecognitionTextHandler")),this.Dka.Lsi(Object(aa.a)(this,this.e1g,"onSpeechProxyErrorHandler")),this.Dka.Msi(Object(aa.a)(this,this.f1g,"onSpeechProxyEventUpdateHandler")),this.Dka.Bui(Object(aa.a)(this,this.g1g,"onSpeechRecognitionStartedHandler")),this.N8.Eph(),this.N8.setCustomSetting("clientMetadata",JSON.stringify(this.q0f())),this.AC.innerText="["+ResourceStrings.L_SubtitleInitMessage+
"]",this.AC.style.color="rgba( 255, 255, 0, 1 )",this.setVisibility(5!==ub),this.oKd(),this.Ad.Dxf(Object(aa.a)(this,this.nac,"onGetCurrentSlideDimensionsHandler")),this.Ad.Pjc(Object(aa.a)(this,this.qve,"onSlideChangedHandler"))):this.Yph()}q0f(nb){nb=void 0===nb?"":nb;const Ka=A.b(h.AFrameworkApplication.ha.appSettings.SessionStartInfoJson.toString()),Sb={};Sb.userID=this.$Zc;Sb.tenantId=this.Zwa;Sb.identityProvider=this.gUc;Sb.audienceChannel="";Sb.audienceGroup=Ka.Ring||"Unknown";Sb.buildVersion=
h.AFrameworkApplication.buildVersion||"Unknown";Sb.locale=this.na.EAb||"Unknown";Sb.wacHost=Ka.Host||"Unknown";Sb.wacDatacenter=Ka.WACDatacenter||"Unknown";Sb.livePragueSessionInfo=nb;return Sb}Yph(){this.nr?(this.nr.style.display=Oa.a.Uf,this.nr.style.visibility=Oa.a.ht,this.N8.Snl(),this.Dka.CYk(Object(aa.a)(this,this.RZg,"onFinalRecognitionTextHandler")),this.Dka.pZk(Object(aa.a)(this,this.Z_g,"onPartialRecognitionTextHandler")),this.Dka.yYk(Object(aa.a)(this,this.e1g,"onSpeechProxyErrorHandler")),
this.Dka.AYk(Object(aa.a)(this,this.f1g,"onSpeechProxyEventUpdateHandler")),this.Dka.LZk(Object(aa.a)(this,this.g1g,"onSpeechRecognitionStartedHandler")),this.Ad.lch(Object(aa.a)(this,this.nac,"onGetCurrentSlideDimensionsHandler")),this.Ad.F7c(Object(aa.a)(this,this.qve,"onSlideChangedHandler")),this.Ztb()&&this.Hv.instance.hide(),this.ita.EndTime=Date.now(),B.a.$(512495705,817,15,JSON.stringify(this.ita,za.qxl)),this.ita={},this.xf.nWe=!1):B.a.$(508063889,817,50,"SlideshowSubtitles::stopTranscribe SubtitleContainer is null")}oKd(){let nb=
3;this.ita.LastPosition=this.xf.a5;"AboveSlide"===this.xf.a5&&this.nr.style.visibility===Oa.a.xx?(this.nr.style.display=Oa.a.H1,this.nr.style.backgroundColor="black",this.nr.style.bottom="auto"):"BelowSlide"===this.xf.a5&&this.nr.style.visibility===Oa.a.xx?(this.nr.style.display=Oa.a.H1,this.nr.style.backgroundColor="black",this.nr.style.bottom="3%",nb=-1):"TopOverlay"===this.xf.a5?(this.nr.style.display=Oa.a.H1,this.nr.style.backgroundColor="transparent",this.nr.style.bottom="auto",nb=5):"BottomOverlay"===
this.xf.a5&&(this.nr.style.display=Oa.a.H1,this.nr.style.backgroundColor="transparent",this.nr.style.bottom="5%",nb=-1);this.Hwb&&document.getElementById("LiveURLBarLayerHost")?this.nr.style.top=-1<nb?String.format("calc({0}% + {1})",nb.toString(),"26px"):"auto":(this.nr.style.top=-1<nb?nb.toString()+"%":"auto",this.wyf())}isVisible(){return this.nr.style.visibility===Oa.a.xx}etl(nb,Ka){Ka=void 0===Ka?"":Ka;La.tNf=nb?["Live","Subtitles"]:["Subtitles"];this.Hwb=nb;this.setVisibility(this.nr.style.visibility===
Oa.a.xx);this.oKd();this.N8.setCustomSetting("clientMetadata",JSON.stringify(this.q0f(Ka)));this.N8.setCustomSetting("slideIndex",this.yfe);this.N8.setCustomSetting("currentSpeechModes",JSON.stringify(La.tNf))}uEb(nb){this.nr.style.cursor=nb?"default":"none"}wyf(){this.AC.style.fontSize=Math.floor(this.nr.clientHeight/2/1.5).toString()+"px";this.Npe=Math.floor(this.nr.clientHeight/12-2)+"px";this.AC.style.display="inline"}setVisibility(nb){this.nr?(null===nb&&(nb=this.nr.style.visibility===Oa.a.ht),
this.nr.style.visibility=nb?Oa.a.xx:Oa.a.ht):B.a.$(509703457,817,50,"SlideshowSubtitles::setVisibility SubtitleContainer is null")}nac(){this.wyf()}qve(nb,Ka){this.yfe=Ka.slideIndex;this.N8.CYj()&&this.Hwb&&(this.N8.setCustomSetting("currentSlideIndex",this.yfe),B.a.$(512495704,817,50,"SlideshowSubtitles::OnSlideChangedHandler Updated current slide index for live"))}K5e(nb){nb?(this.N8.WEk(),this.Lec(),this.zTc=!0,this.Yd&&this.Yd.instance&&this.Yd.instance.tym()):(this.N8.Eph(),this.Yd&&this.Yd.instance&&
this.Yd.instance.uym())}Kag(){this.Ztb()&&(window.clearTimeout(this.Dpd),this.Hv.instance.hide())}tAl(nb,Ka,Sb,ab){La.sourceLanguage=ab.Fib;La.targetLanguages=ab.kpc;La.podSessionId=nb;La.NAh=Ka;La.docId=Sb;La.webServiceBase=this.na.ym;La.speechFDBase=h.AFrameworkApplication.ha.Ma(ma.a.EKb);nb=!!this.Yd&&!!this.Yd.instance&&(this.Yd.instance.cGc||this.Yd.instance.kM);La.speechMode=this.Yd&&this.Yd.instance&&this.Yd.instance.FO&&this.Yd.instance.Ukc||nb?"Live":"Subtitles"}kQf(nb,Ka){this.fAg||(this.AC.style.color=
"rgba( 255, 255, 255, 1 )",window.clearTimeout(this.p$a),this.AC.innerText=this.Ftj(nb,Ka),this.AC.scrollTop=this.AC.scrollHeight,this.p$a=window.setTimeout(Object(aa.a)(this,this.Lec,"resetSubtitlesToEmpty"),1E4),Ka&&(this.V8.innerText=nb,this.V8.focus()),this.AC.style.padding=l.a.wb(nb)?"0px":this.Npe)}kE(nb){this.fAg||(this.AC.style.color="rgba( 255, 255, 0, 1 )",l.a.wb(nb)&&(nb=ResourceStrings.L_SubtitleGenericErrorMessage),window.clearTimeout(this.p$a),this.AC.innerText="["+nb+"]",this.AC.scrollTop=
this.AC.scrollHeight,this.p$a=window.setTimeout(Object(aa.a)(this,this.Lec,"resetSubtitlesToEmpty"),1E4),this.AC.style.padding=this.Npe,this.V8.innerText="",this.V8.focus())}kCj(nb){if(null!==nb)switch(nb){case "NotAllowedError":case "NotFoundError":case "NotReadableError":case "MicrophoneError":this.kE(ResourceStrings.L_SubtitleAudioDeviceErrorMessage);this.ita.LastError="MicrophoneError";break;case "FailedToConnect":this.kE(ResourceStrings.L_SubtitleRetryErrorMessage);this.ita.LastError="FailedToConnect";
break;case "AccessDenied":case "UnknownError":case "Timeout":this.kE(ResourceStrings.L_SubtitleGenericErrorMessage);this.ita.LastError="FailedToCreateSpeechSession";break;default:B.a.$(512495703,830,15,"HandleSpeechProxyError {0}",nb)}}RZg(nb,Ka){this.nr.style.visibility!==Oa.a.ht&&this.kQf(Ka[this.xf.kpc],!0)}Z_g(nb,Ka){this.nr.style.visibility!==Oa.a.ht&&this.kQf(Ka[this.xf.kpc],!1)}e1g(nb,Ka){B.a.$(512495702,830,10,"OnSpeechProxyErrorHandler {0}",Ka);(nb=Ka.toString())&&(-1<nb.indexOf("NotAllowedError")||
-1<nb.indexOf("NotFoundError")||-1<nb.indexOf("NotReadableError")||-1<nb.indexOf("MicrophoneError"))&&this.Ztb()&&this.Hv.instance.show(ResourceStrings.L_SubtitleDetection_NoMicrophone,Ia.a.eKb);this.kCj(nb)}g1g(nb,Ka){B.a.$(512495701,830,50,"OnSpeechRecognitionStartedHandler {0}",Ka.toString());this.Ad.bBk(Ka.toString());this.Lec();this.Ztb()&&this.Hv.instance.hide()}f1g(nb,Ka){if(this.Ztb())switch(nb=Ka.eventName,nb){case "MediaEvent":"AudioDeviceConnected"===Ka.mediaStatus&&this.Hv.instance.show(ResourceStrings.L_SubtitleDetection_MicReady,
Ia.a.Gse);break;case "ConnectionRetry":this.Hv.instance.show(ResourceStrings.L_SpeechGenericRetryErrorMessage,Ia.a.eKb);this.kE(ResourceStrings.L_SubtitleGenericErrorMessage);break;case "QualityStatusUpdate":const Sb=Ka.shortCode;nb=Ka.longCode;const ab=Ka.shortString,ub=Ka.longString;switch(Ka.severity){case 0:this.Hv.instance.hide();break;case 1:(Ka=0<Sb?za.gea[Sb]:ab)&&this.Hv.instance.show(Ka,Ia.a.$pd);break;case 2:(Ka=0<Sb?za.gea[Sb]:ab)&&this.Hv.instance.show(Ka,Ia.a.eKb),Ka=null===nb?ub:za.gea[nb],
l.a.wb(Ka)||(window.clearTimeout(this.p$a),this.kE(Ka),this.p$a=window.setTimeout(Object(aa.a)(this,this.Lec,"resetSubtitlesToEmpty"),3E4))}break;default:B.a.$(512495700,830,50,"OnSpeechProxyEventUpdateHandler Event {0}",nb)}}Ztb(){return this.na.FFa&&!!this.Hv&&!!this.Hv.instance}Lec(){this.AC.style.color="rgba( 255, 255, 255, 1 )";this.AC.innerText="";this.AC.scrollTop=this.AC.scrollHeight;this.DEa=this.CEa="";this.zTc=!1;this.p$a=0;this.AC.style.padding="0px"}Ftj(nb,Ka){this.zTc?this.Rwi(nb):this.S_k(nb);
this.zTc=Ka;return l.a.wb(this.CEa)||l.a.wb(this.DEa)?l.a.wb(this.CEa)?this.DEa:this.CEa:this.CEa+"\n"+this.DEa}Rwi(nb){this.CEa=l.a.wb(this.DEa)?this.CEa:this.DEa;this.DEa=nb}S_k(nb){l.a.wb(this.CEa)||l.a.wb(this.DEa)?this.CEa=nb:this.DEa=nb}static get instance(){return za.Bu}static sKj(){za.gea[1]=ResourceStrings.L_SubtitleDetection_Listening;za.gea[2]=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;za.gea[3]=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;za.gea[4]=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;
za.gea[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet}static qxl(nb,Ka){return"undefined"===typeof Ka?null:Ka}}za.gea=Array(20);za.Bu=new za;Object(y.a)(za,"SlideshowSubtitles",null,[677]);var Qa=a(1241),Xa=a(48),Tb=a(80);class Kb{constructor(nb,Ka,Sb,ab,ub,Aa,tb,kc,dc,Db,sb,Qb,$a,X,Ta,ca,Ma,Ba,wa,pa,ta){this.Jg=this.QN=this.Lxb=null;this.GH=new b.a;this.xa=new d.a;this.Smc="";this.ap=null;this.XJb="";this.whb=this.$xg=this.h9b=this.oB=this.T8=this.S8=this.M5b=this.ga=null;this.i9b=!0;this.z_=
Date.now();this.BW=Date.now();this.cka=this.Uoe=this.fRg=0;this.ude=this.Hwb=!1;this.yda=new Set;this.ele=this.C8=!1;this.NWc=0;this.Ina=null;this.s$a=void 0;this.vpe=0;this.mpe={};this.Lme=0;this.yEa=this.x4b=this.v4b=!1;this.YPg={};this.Hna=!1;this.B_g=(Wa,Pa)=>{this.Vyk(Pa)};this.zxk=()=>{B.a.$(512309270,830,50,`SlideShowCoreFrame::OnEditHappened,, Edit time elapsed between two edits:${Date.now()-this.BW} `);this.BW=Date.now();this.NWc++};this.Lyk=(Wa,Pa)=>{var ib;B.a.$(512309269,830,50,"SlideShowCoreFrame::OnLastMergeEditUTCChangedHandler");
this.BW=Date.now();this.v4b=!0;this.yEa&&this.Bda.I7e();this.na.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled")&&(this.na.getBooleanAppSetting("CoauthEditSlideInfoEnabled")?(null===Pa||void 0===Pa?0:Pa.isPresentationChange)?this.ele=!0:0<(null===(ib=null===Pa||void 0===Pa?void 0:Pa.hM)||void 0===ib?void 0:ib.length)&&Pa.hM.forEach(Ib=>{Ib=JSON.stringify({Sid:Ib.Sid,Cid:Ib.Cid});this.yda.has(Ib)||this.yda.add(Ib)}):this.C8=!0)};this.Rzk=(Wa,Pa)=>{var ib;B.a.$(512309268,830,50,"SlideShowCoreFrame::OnRealTimeEditHandler");
this.BW=Date.now();this.x4b=!0;this.yEa&&this.Bda.I7e();this.na.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled")&&(this.na.getBooleanAppSetting("CoauthEditSlideInfoEnabled")?0<(null===(ib=null===Pa||void 0===Pa?void 0:Pa.hM)||void 0===ib?void 0:ib.length)&&Pa.hM.forEach(Ib=>{Ib=JSON.stringify({Sid:Ib.Sid,Cid:Ib.Cid});this.yda.has(Ib)||this.yda.add(Ib)}):this.C8=!0)};this.FAk=(Wa,Pa)=>{var ib;this.Uoe=Date.now();B.a.$(507799770,830,50,"SlideShowCoreFrame::onSlideEditHandler");this.yEa&&
this.Bda.Q1h(Pa.hM.map(Ib=>new Tb.a(Ib)),this.yM);this.C8||((null===Pa||void 0===Pa?0:Pa.isPresentationChange)?(B.a.$(507799769,830,15,"SlideShowCoreFrame::onSlideEditHandler SlideShow cache flushed by this edit"),this.C8=!0):0<(null===(ib=null===Pa||void 0===Pa?void 0:Pa.hM)||void 0===ib?void 0:ib.length)&&Pa.hM.forEach(Ib=>{Ib=JSON.stringify({Sid:Ib.Sid,Cid:Ib.Cid});this.yda.has(Ib)||this.yda.add(Ib)}))};this.jFf=(Wa,Pa)=>{var ib,Ib;"Error"==Pa&&this.xa.raiseEvent("OnCameraErrorEventId");this.c$a&&
(window.clearTimeout(this.c$a),this.c$a=void 0);Wa=this.bZi(Wa);null===(Ib=null===(ib=this.g9b)||void 0===ib?void 0:ib.instance)||void 0===Ib?void 0:Ib.show(Wa,Pa);this.c$a=window.setTimeout(()=>{var hc,yc;null===(yc=null===(hc=this.g9b)||void 0===hc?void 0:hc.instance)||void 0===yc?void 0:yc.hide();this.c$a=void 0},3E3)};this.IUk=Wa=>{Object(c.b)(this,void 0,void 0,function*(){if(this.Tnd){var Pa=(new Date).getTime();try{const ib=yield this.Tnd.hP("Hubble",Wa);ib.IsSuccess?this.Jg.setAadToken(ib.Token):
this.Jg.setAadToken("");B.a.$(508949124,830,50,`SlideShowCoreFrame::Hubble token requested by: ${"PowerPoint Slideshow"} successful: ${ib.IsSuccess} time: ${(new Date).getTime()-Pa}`)}catch(ib){B.a.$(508949123,830,10,`SlideShowCoreFrame::Hubble token requested by: ${"PowerPoint Slideshow"} successful: false time: ${(new Date).getTime()-Pa} error: ${ib}`),this.Jg.setAadToken("")}}else B.a.$(508949125,830,10,"SlideShowCoreFrame::Refresh token requested without IOAuthManager. Setting AAD token as empty for SlideShow."),
this.Jg.setAadToken("")})};this.Kf=nb;this.na=Ka;this.xf=Sb;this.u_e=ab;this.Hv=ub;this.g9b=Ba;this.Yd=Aa;this.M3=kc;this.TO=tb;this.$wa=dc;this.mf=Db;this.tW=sb;this.Nh=Qb;this.yM=$a;this.Iq=X;this.Rmc=Ta;this.Xb=ca;this.Bda=ta;if(this.na.getBooleanAppSetting("SlideShowGetPresInfoFromClient")){if(!Ma)throw"PresInfo client not present";this.uNg=Ma}this.ZQg=pa;this.yEa=this.na.getBooleanAppSetting("SnapUrlUpdateAfterEditEnabled");wa&&(this.Ina=wa);this.Unk=e.a.getInstance();this.tW&&this.tW.execute(Wa=>
{Wa.Cza(this.zxk)});if(!this.Xb)throw Error.argumentNull("presReader");this.Rmc.IFh(this.B_g);this.Nh&&(this.Nh.Ojc(this.Lyk),this.Nh.Rjc(this.Rzk),this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",!1)&&this.Nh.xui(this.FAk));if(this.na.isAnimationPreviewEnabled)this.Iy=this.Ina.getSettings(),this.$wa=this.Ina.$wa;else try{const Wa=this.Iy=JSON.parse(this.na.Ma("Settings"))||{};Wa.slideshowcore||(Wa.slideshowcore={});Wa.slideshowcore&&Wa.slideshowcore.forceSvg&&
"true"===Wa.slideshowcore.forceSvg.toString().toLowerCase()?this.$wa=!0:this.$wa&&(Wa.slideshowcore.forceSvg="True");Wa.slideshowcore.enableCameoInPPTOSlideShow=this.na.DZ.toString()}catch(Wa){B.a.$(512495906,830,10,"SlideShowCoreFrame::Exception in parsing settings:{0}",Wa),this.Iy={}}this.YPg=A.b(h.AFrameworkApplication.ha.appSettings.SessionStartInfoJson.toString())}kYj(nb){return null==nb||G.a("CacheRetentionExperimentReversedCommands")&&-1<(this.na.Ma("CacheRetentionExperimentReversedCommands")||
"").indexOf(nb+";")?!1:Qa.a.includes(nb)?!0:G.a("CacheRetentionExpCommandsFromBRS")?-1<(this.na.Ma("CacheRetentionExperimentCommands")||"").indexOf(nb.toString()+";"):!1}Vyk(nb){var Ka;Object(c.b)(this,void 0,void 0,function*(){if(!this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",!1)&&nb.actionId!==Xa.a.ona&&(this.yEa&&this.Bda.Q1h(null===nb||void 0===nb?void 0:nb.hM,this.yM),this.na.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled"))){var Sb=
this.Xb.i1(null===(Ka=null===nb||void 0===nb?void 0:nb.hM[0])||void 0===Ka?void 0:Ka.sid);Sb=null===Sb||void 0===Sb?void 0:Sb.slideIndex;B.a.$(508297357,830,50,`SlideShow:: Edit Command triggered  ::${nb.actionId}, SlideIndex Edited:: ${Sb},Edit time elaplsed between two edits:${Date.now()-this.BW}`);nb&&nb.hM&&1==nb.hM.length&&this.kYj(null===nb||void 0===nb?void 0:nb.actionId)&&!this.C8?(Sb=JSON.stringify({Sid:nb.hM[0].sid,Cid:nb.hM[0].cid}),this.yda.has(Sb)||(this.yda.add(Sb),this.mpe[this.W5f(nb.hM[0].sid,
nb.hM[0].cid)]=nb.actionId)):!this.C8&&G.a("TelemetryForSSCacheFlushCommand")&&(B.a.$(508063836,830,15,`SlideShowCoreFrame::onMarkedUndoWithSlidesAsync SlideShow cache flushed by this edit. Command triggered::${nb.actionId}, SlideIndex Edited:: ${Sb}`),this.C8=!0,this.Lme=nb.actionId)}})}preloadShaders(){this.cad();this.Zfc();SlideShowCore.SlideShowCore.preloadShaders()}init(nb,Ka,Sb,ab){return Object(c.b)(this,void 0,void 0,function*(){this.Smc=Sb;this.yM=ab;this.XJb=Ka;if(this.ap)B.a.$(509636752,
830,50,"SlideShowCoreFrame::init - initPromise {0}",this.pRa),yield this.pRa;else{this.M5b=document.getElementById("HiddenFocusTrapAnchor");this.ap=document.createElement("div");this.ap.id="SlideShowBackground";this.ap.className="SlideShowBackground";this.ap.style.visibility=Oa.a.ht;this.ap.tabIndex=-1;this.ga=document.createElement("div");this.ga.id="SlideShowContainer";this.ga.className="SlideShowContainer";this.ga.tabIndex=-1;this.ga.style.width=window.screen.width+"px";this.ga.style.height=window.screen.height+
"px";n.a.addHandler(this.ap,m.a.tta,tb=>{this.fzk(tb)});k.a.instance.Ub(this.ap,tb=>this.N1c(tb));this.ap.appendChild(this.ga);this.M5b?this.Kf.insertBefore(this.ap,this.M5b):this.Kf.appendChild(this.ap);var ub=this.na.Ma("pptSlideShowCoreCssUrl"),Aa=document.createElement("link");Aa.setAttribute("rel","stylesheet");Aa.setAttribute("type","text/css");Aa.setAttribute("href",ub);this.ga.appendChild(Aa);za.instance.init(this.na,this.ap,this.xf,this,this.Hv,this.Yd,this.M3);this.S8=document.getElementById("slideshowBeginningFocusTrap");
this.T8=document.getElementById("slideshowEndFocusTrap");this.S8||this.T8||(this.S8=document.createElement("div"),this.S8.id="slideshowBeginningFocusTrap",this.S8.className="FocusTrap",this.S8.tabIndex=0,n.a.addHandler(this.S8,m.a.focus,()=>{this.X0g()}),this.T8=document.createElement("div"),this.T8.id="slideshowEndFocusTrap",this.T8.className="FocusTrap",this.T8.tabIndex=0,n.a.addHandler(this.T8,m.a.focus,()=>{this.X0g()}),this.M5b?(this.Kf.insertBefore(this.S8,this.Kf.firstChild),this.Kf.insertBefore(this.T8,
this.M5b.nextSibling)):(ub=document.getElementById("slideshow-toolbar"),this.Kf.insertBefore(this.S8,this.ap),this.Kf.insertBefore(this.T8,ub)));this.na.getBooleanAppSetting("IsSnapUrlFetchedEarlyOnBootEnabled")&&this.ZQg?(ub=yield this.ZQg.trj())&&!l.a.wb(ub.$Qf)?(this.oB=ub.$Qf,this.Hna=ub.q5e,this.z_=Date.now(),yield this.R4d()):(this.pRa=this.d1d(1),yield this.pRa):(this.pRa=this.d1d(1),yield this.pRa)}})}ZOj(){return this.v4b||this.x4b}d1d(nb){return Object(c.b)(this,void 0,void 0,function*(){let Ka=
String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.na.ym,this.yM);if(G.a("AddCallerQueryParam")){const ab=this.na.getBooleanAppSetting("PPTOPresentFrontDoorEnabled");Ka+=`&caller=Slideshow&pptoPresentFrontDoorEnabled=${ab}`}const Sb=new Date;return new Promise((ab,ub)=>{const Aa={};Aa.startTime=Sb;if(this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.UseXMLHttpRequestForSSSnap",!1)){const tb=this.Ina.faa(Ka);tb.onreadystatechange=()=>Object(c.b)(this,void 0,
void 0,function*(){tb.readyState===XMLHttpRequest.DONE&&(Aa.correlationId=tb.getResponseHeader("X-CorrelationId"),yield this.bJa(JSON.parse(tb.response),Aa),ab())});tb.onerror=()=>Object(c.b)(this,void 0,void 0,function*(){Aa.requestStatus=tb.status;Aa.correlationId=tb.getResponseHeader("X-CorrelationId");yield this.aJa(nb,Aa);ub()});tb.send()}else{const tb={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};tb["X-UserSessionId"]=h.AFrameworkApplication.userSessionId;this.Iq.ik(Ka,
1,"",tb,!1,0,kc=>Object(c.b)(this,void 0,void 0,function*(){var dc,Db,sb,Qb,$a;Aa.correlationId=null===(dc=null===kc||void 0===kc?void 0:kc.data)||void 0===dc?void 0:dc.gj["X-CorrelationId"];Aa.enqueueTime=null===(Db=null===kc||void 0===kc?void 0:kc.data)||void 0===Db?void 0:Db.Wy;Aa.invokedTime=null===(sb=null===kc||void 0===kc?void 0:kc.data)||void 0===sb?void 0:sb.Oo;Aa.completedTime=null===(Qb=null===kc||void 0===kc?void 0:kc.data)||void 0===Qb?void 0:Qb.Gp;yield this.bJa(JSON.parse(null===($a=
null===kc||void 0===kc?void 0:kc.data)||void 0===$a?void 0:$a.responseData),Aa);B.a.$(509636751,830,15,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlSucceeded");ab()}),kc=>Object(c.b)(this,void 0,void 0,function*(){var dc,Db;Aa.requestStatus=null===(dc=null===kc||void 0===kc?void 0:kc.data)||void 0===dc?void 0:dc.Je;Aa.retryCount=nb;Aa.correlationId=null===(Db=null===kc||void 0===kc?void 0:kc.data)||void 0===Db?void 0:Db.gj["X-CorrelationId"];yield this.aJa(nb,Aa);B.a.$(509636750,830,10,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlFailed");
ub()}),null,null)}})})}bJa(nb,Ka){return Object(c.b)(this,void 0,void 0,function*(){Ka.timeTaken=+new Date-+Ka.startTime;B.a.$(512309283,830,15,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded : {0}",Ka);this.oB=nb.downloadUrl;void 0!==nb.sendGetItemsRequestToPFD&&(this.Hna=nb.sendGetItemsRequestToPFD);l.a.wb(this.oB)?B.a.$(512309282,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty - {0}",nb):(this.z_=Date.now(),yield this.R4d())})}f0d(){const nb={};nb.settings=
this.Iy;nb.retryCount=this.na.Ac("GetItemsRetryCount",3);nb.retryOnCategories=this.na.Ma("GetItemsRetryCategories").split(";");const Ka={};Ka.Slide=ResourceStrings.l_Slide;Ka.AnimNum=ResourceStrings.l_AccSsAnimNum;Ka.SldNameWithTooltip=ResourceStrings.l_AccSsSldNameWithTooltip;Ka.SldNameWithoutTooltip=ResourceStrings.l_AccSsSldNameWithoutTooltip;Ka.AnimTotalSingular=ResourceStrings.l_AccSsAnimTotalSingular;Ka.AnimTotalPlural=ResourceStrings.l_AccSsAnimTotalPlural;nb.localizedStrings=Ka;return nb}R4d(){return Object(c.b)(this,
void 0,void 0,function*(){this.cad();this.Zfc();G.a("UseNewPodsProxyConstructor")?this.xcg():this.Lxb=new PodsProxy.PodsProxy(this.na.rwa?this.na.Ufb:this.na.ym,{DownloadUrl:this.oB,DocID:h.AFrameworkApplication.Fh,CustomFontCatalogUrl:this.na.Ma("CustomFontCatalogURL")},this.na.t1?l.a.GJ(this.na.t1).toLowerCase():"",this.GH,this.krb(),this.lrb());this.QN=new SlideShowCore.DefaultResourceProviders(this.Lxb,this.GH,this.f0d());const nb={};nb.initTime=Kb.lU();nb.uiHost="Unified App";nb.serverUrl=l.a.yj(this.na.ym);
nb.userSessionId=this.Smc;nb.jsScriptsBasePath=this.na.Ma("StaticContentHost")+"pptscripts/ssapp/";nb.fileHost=this.na.Ma("FileHost");nb.isRtl=h.AFrameworkApplication.isRtl;nb.applicationLcid=h.AFrameworkApplication.lcid;nb.applicationLocaleName=h.AFrameworkApplication.uiCulture;nb.areThirdPartyAddInsAllowed=h.AFrameworkApplication.jMa;nb.theWsaClient=h.AFrameworkApplication.Di;nb.appForOfficeContextActivationParameters=F.a.pXe(this.mf);nb.hubbleVideoEndpoint=this.na.ZIb;nb.acceptLanguage=h.AFrameworkApplication.uiCulture;
nb.appForOfficeAuthFactory=new ba.a;const Ka={};Ka.settings=this.Iy;Ka.transitionResourceCDNPath=this.na.DIh;Ka.transitionDisabledList=this.na.eWa;Ka.clickTargetEnabled=!0;Ka.mediaEnabled=!0;Ka.gifEnabled=!0;Ka.convertGifToVideo=!0;Ka.crossSlideAudioEnabled=!0;Ka.editAudioEnabled=this.na.getBooleanAppSetting("PPTOAudioPlaybackOptionsEnabled");Ka.flipgridVideoEnabled=this.na.getBooleanAppSetting("PptModernSlideShowFlipgridVideoEnabled");Ka.useNewYoutubePlayer=!0;Ka.useNewVimeoPlayer=!0;Ka.useOnlineVideoPlayer=
!0;Ka.tedVideoEnabled=this.na.getBooleanAppSetting("PptModernSlideShowTEDVideoEnabled");Ka.isStream2Enabled=!0;Ka.endOfShowText=ResourceStrings.l_EndOfSlideShowMessage;Ka.enableSVGAsWebGLTexture=!u.a.Yf&&this.na.getBooleanAppSetting("SlideShowShapeBuilderSVGEnabled");Ka.maxSvgTextureSize=this.na.Ac("ShapeBuilderMaxSvgTextureSize",2048);Ka.enableSlideSizeAdjust=this.na.getBooleanAppSetting("EnableSlideSizeAdjust");Ka.slideSizeMax={["x"]:this.na.Ac("SlideShowMaxWidth",1504),["y"]:this.na.Ac("SlideShowMaxHeight",
849)};Ka.slideSizeMin={["x"]:this.na.Ac("SlideShowMinWidth",348),["y"]:this.na.Ac("SlideShowMinHeight",261)};Ka.slideSizeDefault={["x"]:this.na.Ac("SlideShowDefaultWidth",1504),["y"]:this.na.Ac("SlideShowDefaultHeight",849)};Ka.streamVideoUseThinEmbed=this.na.getBooleanAppSetting("StreamVideoUseThinEmbed");Ka.slideMetadataEnabled=this.na.getBooleanAppSetting("PptModernSlideShowSlideMetadataEnabled");Ka.disabledChangeGates=this.na.Ma("PPTDisabledChangeGates");Ka.isMultiSlideshowcoreEnabled=this.na.getBooleanAppSetting("MultiSlideshowcoreEnabled");
Ka.combineBootRequest=!0;Ka.localVideoTelemetryEnabled=this.na.getBooleanAppSetting("IsGFXVideoLocalTelemetryEnabled");Ka.imageSettings={["imageAppendOption"]:"all"};Ka.SlideShowCacheRetentionExperimentEnabled=this.na.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled");Ka.usePresInfoFromClient=this.na.getBooleanAppSetting("SlideShowGetPresInfoFromClient");const Sb={};G.a("addFlightToSSC")&&(Sb.verifyGlyphAsynchronously=h.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.verifyGlyphAsynchronously",
!1));const ab={["slideShowCoreSettings"]:Ka,["appSettings"]:nb};G.a("addFlightToSSC")&&(ab.flights=Sb);G.a("AddInstanceSourceIdentifier")?this.Jg=new SlideShowCore.SlideShowCore(this.ga,this.QN,this.GH,ab,1):this.Jg=new SlideShowCore.SlideShowCore(this.ga,this.QN,this.GH,ab);new SlideShowCore.PrefetchAddon(this.Jg,this.GH,{["forwardPrefechCount"]:this.na.Ac("PptModernSlideShowForwardPrefetchCount",10),["backwardPrefechCount"]:this.na.Ac("PptModernSlideShowBackwardPrefetchCount",5),["forwardPrerenderCount"]:this.na.Ac("PptModernSlideShowForwardPrerenderCount",
2),["backwardPrerenderCount"]:this.na.Ac("PptModernSlideShowBackwardPrerenderCount",2)});new SlideShowCore.SlideAdvanceAddon(this.Jg,this.GH);this.fRg=Date.now();this.whb=this.Jg.init();this.Jg.events.on("slideLocationChanged",()=>{this.nqd()});this.Jg.events.on("animationStateChanged",()=>{this.nqd()});this.Jg.events.on("slideDimensionsChanged",()=>{this.RWe()});this.Jg.events.on("exitFromEndOfShow",()=>{this.DZg(!0)});this.Jg.events.on("blankSlideStateChanged",ub=>{this.Kwk(ub)});this.Jg.events.on("slideshowError",
ub=>{this.G1e(ub)});this.na.getBooleanAppSetting("IsStream2VideoEnabled")&&(this.Tnd=r.a.instance.resolve("Common.App.OAuth.IOAuthManager"),this.Jg.events.on("aadTokenRequest",ub=>{this.IUk(ub)}));return new Promise(ub=>Object(c.b)(this,void 0,void 0,function*(){yield this.whb;this.i9b=!1;this.$xg=new SlideShowCore.InputsAddon(this.Jg,this.ga,h.AFrameworkApplication.isRtl);new SlideShowCore.AnimationLoggerAddon(this.Jg,ab,this.GH);new SlideShowCore.TransitionLoggerAddon(this.Jg,ab,this.GH);new SlideShowCore.PerfCheckerAddon(this.Jg,
ab,this.GH);this.h9b=new SlideShowCore.SlideShowInkAddon(this.Jg,this.GH,this.ga,()=>this.u_e.loadScript("slideshowink"),{["telemetryLogger"]:this.Unk});this.na.DZ&&(this.f9b=new SlideShowCore.CameoWebcamAddon(this.Jg,{notificationCallback:this.jFf}));this.$xg.events.on("keydown",Aa=>{this.tac(Aa)});B.a.$(509636749,830,15,"SlideShowCoreFrame - initSlideShowCore Finshed Initializing");ub()}))})}lrb(){const nb={};nb.timeout=this.na.Ac("PptModernSlideShowGetItemsTimeoutMs",3E4);nb.throwHttpErrors=!1;
nb.enableServerSpecificErrorCode=G.a("SSCore.EnableServerSpecificErrorCode");nb.pptoPresentFrontDoorEnabled=this.h$d();return nb}Zfc(){try{const nb=this.Iy;if(nb.slideshowcore){const Ka={};Ka.settings=nb;Ka.logger=this.GH;Ka.disabledChangeGates=this.na.Ma("PPTDisabledChangeGates");window.SlideShowCore.setupGlobals_SlideShowCore(Ka)}}catch(nb){B.a.$(509703488,830,10,"SlideShowCoreFrame::Exception in passing settings to slideshowcore:{0}",nb)}}cad(){try{const nb=this.Iy;if(nb.podsproxy){const Ka={};
Ka.settings=nb;window.PodsProxy.setupGlobals_PodsProxy(Ka)}}catch(nb){B.a.$(512309267,830,10,"SlideShowCoreFrame::Exception in passing settings to podsproxy:{0}",nb)}}CPe(nb,Ka,Sb){return Object(c.b)(this,void 0,void 0,function*(){this.cad();this.Zfc();if(this.Jg){G.a("UseNewPodsProxyConstructor")?this.xcg():this.Lxb=new PodsProxy.PodsProxy(this.na.rwa?this.na.Ufb:this.na.ym,{DownloadUrl:this.oB,DocID:h.AFrameworkApplication.Fh,CustomFontCatalogUrl:this.na.Ma("CustomFontCatalogURL")},this.na.t1?l.a.GJ(this.na.t1).toLowerCase():
"",this.GH,this.krb(),this.lrb());var ab=this.QN;this.QN=new SlideShowCore.DefaultResourceProviders(this.Lxb,this.GH,this.f0d());var ub=this.xpe;G.a("RockyV2NavigationFix")&&Sb&&ub<this.Xb.zl()-1&&ub++;if(G.a("UpdateSlideShowCoreRefractoringEnabled")){let tb=!1;if(this.na.getBooleanAppSetting("SlideShowGetPresInfoFromClient")&&ab&&(!G.a("DisabledPresInfoClientInCoauth")||!this.ZOj())){var Aa=ab.presInfo.getLoadResultInCache("");(null===Aa||void 0===Aa?0:Aa.resource)&&this.uNg&&(Aa.resource=this.uNg.T3l(Aa.resource),
null===Aa||void 0===Aa?0:Aa.resource)&&(this.QN.presInfo.add(Aa),tb=!0)}Aa=!Sb&&h.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SaveRenderCallForLaunchAfterEdit",!1);ub={shouldRerenderSlide:!0,startSlideIndex:this.d8()?ub:this.xpe,isCacheRetentionEnabled:this.d8(),updateSlideShowCoreAfterLaunch:this.d8()&&Sb,isPresInfoFromClient:tb,fSetBlankSlideToBlack:Aa};yield this.Jg.updateResourceProviders(this.QN,ub)}else this.d8()?yield this.Jg.updateResourceProviders(this.QN,
{shouldRerenderSlide:!0,updateSlideShowCoreAfterLaunch:Sb,startSlideIndex:ub,isCacheRetentionEnabled:this.d8()}):yield this.Jg.updateResourceProviders(this.QN,{shouldRerenderSlide:!0,startSlideIndex:this.xpe,isCacheRetentionEnabled:this.d8()});ab&&ab.dispose();B.a.$(508162582,830,50,`SlideShowCoreFrame::Number of edits happened::${this.NWc}`);G.a("RockyV2Telemetry")?this.o1k():(this.yda.clear(),this.C8=!1,this.NWc=0);B.a.$(593827098,830,15,"SlideShowCoreFrame::Done updating ResourceProvider. StartUrl:{0}, downloadUrl:{1}, updatedResourceProvider:{2}, IsSlideShowVisible:{3}",
nb,Ka,Date.now(),this.Ggb())}else B.a.$(508908737,830,10,"SlideShowCoreFrame - updateSlideShowCore: m_slideshowCore is null")})}xcg(){try{this.Lxb=new PodsProxy.PodsProxy(this.na.rwa?this.na.Ufb:this.na.ym,{DownloadUrl:this.oB,DocID:h.AFrameworkApplication.Fh,CustomFontCatalogUrl:this.na.Ma("CustomFontCatalogURL")},this.na.t1?l.a.GJ(this.na.t1).toLowerCase():"",this.GH,this.krb(),this.lrb())}catch(nb){if(nb instanceof TypeError)this.Lxb=new PodsProxy.PodsProxy(this.na.rwa?this.na.Ufb:this.na.ym,{DownloadUrl:this.oB,
DocID:h.AFrameworkApplication.Fh,CustomFontCatalogUrl:this.na.Ma("CustomFontCatalogURL")},this.na.t1?l.a.GJ(this.na.t1).toLowerCase():"",this.GH,this.h$d()?this.na.Ma("PresentUrlEndpoint"):void 0,this.krb(),this.lrb());else throw B.a.$(507811592,830,10,"SlideShowCoreFrame::Error in PodsProxy initialization:{0}",nb),nb;}}o1k(){this.yda.clear();this.C8=!1;this.NWc=this.Lme=0;this.x4b=this.v4b=!1;this.mpe={};this.ele=!1}aJa(nb,Ka){return Object(c.b)(this,void 0,void 0,function*(){0<nb--?(B.a.$(512309281,
830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, {1}",nb,Ka),yield this.d1d(nb)):B.a.$(512309280,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : {0}",Ka)})}d8(){return this.na.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled")&&G.a("SlideCacheExperimentV2")}o0h(nb,Ka,Sb,ab,ub,Aa,tb,kc,dc){Object(c.b)(this,void 0,void 0,function*(){var Db=0;this.xpe=0>=Ka?0:Ka-1;var sb={};G.a("SSLaunchRefactoredLaunchLogs")&&
(sb.id=x.a.create().toString(),sb.additionalMetrics={});const Qb={};G.a("CoauthEditSlideInfoEnabledTelemetryEnabled")&&(Qb.CoauthEditSlideInfoEnabled=this.na.getBooleanAppSetting("CoauthEditSlideInfoEnabled"));if(G.a("SSNetworkInfo")&&"connection"in navigator){var $a=navigator.connection,X={};"effectiveType"in $a&&(X.type=$a.effectiveType);"downlink"in $a&&(X.downlink=$a.downlink);"rtt"in $a&&(X.rtt=$a.rtt);Qb.network=X}this.pRa&&(B.a.$(509617947,830,15,"SlideShowCoreFrame::StartFrom - initPromise {0}",
this.pRa),$a=Kb.lU(),yield this.pRa,Db=Kb.lU()-$a,this.Ggb()||this.show());if(l.a.wb(this.oB))B.a.$(508924042,830,10,"SlideShowCoreFrame::StartFrom DownloadUrl is null or empty - {0}",this.oB),this.Ggb()&&(sb=w.a.Ji(410),h.AFrameworkApplication.Ds(sb),v.Health.instance.recordQosError(w.a.Vma(sb),["SlideShowACE"],!1,!0,!0,!0,null),this.Jg&&this.Jg.recordSessionStats({["errorName"]:"ErrorSlideShowGetItemsFailedDownloadFile"}),this.exit());else if(this.Jg){$a={sr:"ss"};G.a("SSLaunchUnifiedTelemetry")&&
(Qb.initPromiseTimeMs=Db);this.BW>this.z_||this.i9b?(this.Iy.slideshowcore.vetoBootDurationMs=this.na.Ac("PptModernSlideShowEditVetoBootDurationMs",8E3),$a.BootScenario=this.BW>this.z_?"AfterEdit":"Init",B.a.$(509703459,830,15,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.na.Ac("PptModernSlideShowEditVetoBootDurationMs",8E3),this.BW,this.z_,this.i9b)):(this.Iy.slideshowcore.vetoBootDurationMs=this.na.Ac("PptModernSlideShowCachedVetoBootDurationMs",
2E3),$a.BootScenario="Relaunch",B.a.$(509703458,830,15,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.na.Ac("PptModernSlideShowCachedVetoBootDurationMs",2E3),this.BW,this.z_,this.i9b));this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",!1)&&this.Z3j();this.Zfc();X=0;Db=this.d8()&&!this.Xjg(nb)&&this.BW>this.z_;const Ta=this.d8()?this.Xjg(nb)&&this.BW>this.z_:this.BW>
this.z_;G.a("RockyV2Telemetry")&&this.d8()&&(Qb.updateSlideShowCoreBeforeLaunch=Ta,Qb.updateSlideShowCoreAfterLaunch=Db,Ta&&(Qb.slideEditSource=this.brj(nb),Qb.slideFirstEditCommand=this.crj(nb)),G.a("PPTOPresentFrontDoorTelemetry")&&(Qb.pptoPresentFrontDoorEnabled=this.na.getBooleanAppSetting("PPTOPresentFrontDoorEnabled"),Qb.isGetItemsRequestRoutedtoPFD=this.h$d()));Ta&&(X=Kb.lU(),this.Jg.showLoadingSpinner(),this.yEa&&this.Bda.oPh(this.BW)?yield this.Vyh(Db,sb):yield this.DPe(1,Db),X=Kb.lU()-X,
G.a("SSLaunchRefactoredLaunchLogs")&&(sb.additionalMetrics.isUpdateResourceProviderCalled=!0));G.a("SSLaunchUnifiedTelemetry")&&($a.SSCoreUpdateAfterEditMs=X);$a.startFromTime=dc-window.performance.timing.navigationStart;$a.SSCoreFrameStartTime=Kb.lU();G.a("SSLaunchRefactoredLaunchLogs")&&(Qb.CacheRetentionExpEnabled=this.d8());G.a("SSSnapUrlUpdateAfterEditEnabled")&&(Qb.SnapUrlUpdateAfterEditEnabled=this.yEa);G.a("SSRockySlideEditEnhancementEnabled")&&(Qb.RockySlideEditEnhancement=this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",
!1));G.a("IsGetPresInfoClientEnabled")&&(Qb.IsGetPresInfoClientEnabled=this.na.getBooleanAppSetting("SlideShowGetPresInfoFromClient"));G.a("IsSnapUrlonBootEnabled")&&(Qb.IsSnapUrlonBootEnabled=this.na.getBooleanAppSetting("IsSnapUrlFetchedEarlyOnBootEnabled"));G.a("SSEUPLBugTelemetry")&&(Qb.SlideShowClickTime=dc);za.instance.hYk();this.ga.style.top="0";this.S8&&this.T8&&(this.S8.tabIndex=0,this.T8.tabIndex=0);X={["slideId"]:{["sid"]:nb,["cid"]:0}};X.slideIndex=Ka-1;this.vpe+=1;G.a("SSLaunchNumberInSession")&&
(Qb.SlideShowLaunchNumber=this.vpe);G.a("SSLaunchSlideIndexTelemetry")&&(Qb.SlideShowIndex=Ka-1);G.a("SSLaunchRefactoredLaunchLogs")&&(Qb.id=sb.id,B.a.$(508072012,830,15,JSON.stringify(Qb)));h.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SSRemoveCheckFullScreenChecker",!1)||!this.TO.aZe||this.TO.sYa?this.JWf(X,$a,Db,sb):this.gIi(X,$a,Db,sb);this.yEa&&this.Bda.yvm()}else B.a.$(512495901,830,10,"SlideShowCoreFrame::SlideshowCore is undefined")})}Vyh(nb,Ka){return Object(c.b)(this,
void 0,void 0,function*(){this.z_=this.Bda.eXh;this.oB=this.Bda.urm;this.Hna=this.Bda.q5e;yield this.CPe(new Date(this.Bda.vrm),new Date(this.Bda.eXh),nb);B.a.$(507884896,830,15,"SlideShowCoreFrame::updateSlideShowCoreWithPrefetchedSnapUrl served prefethed snap url with updateSlideShowCoreAfterLaunch:{0}, actionId:{1}",nb,Ka.id)})}h$d(){return G.a("SimplifyChecksAndReturnValueInSnapResponse")?this.Hna:this.na.getBooleanAppSetting("PPTOPresentFrontDoorEnabled")&&G.a("AddCallerQueryParam")&&this.YPg.FileSizeBytes<=
this.na.Ac("PresentFrontdoorMaxAllowedFileSizeInBytes",1E8)&&!h.AFrameworkApplication.Mz}Xjg(nb){nb=-1==nb?this.Xb.Uw(0):this.Xb.i1(nb);nb=JSON.stringify({Sid:nb.sid,Cid:nb.cid});return this.C8||this.yda.has(nb)||this.na.getBooleanAppSetting("CoauthEditSlideInfoEnabled")&&this.ele}Z3j(){this.Uoe<this.BW&&(B.a.$(507793607,830,15,"SlideShowCoreFrame: User launched before server response. ServerResponseTime:{0}, LastEditTime:{1}",this.Uoe,this.BW),G.a("ToggleMultiSlideEditOnServerResponseTime")||(this.C8=
!0))}brj(nb){if(this.v4b)return 2;if(this.x4b)return 3;if(this.C8)return 1;nb=-1==nb?this.Xb.Uw(0):this.Xb.i1(nb);nb=JSON.stringify({Sid:nb.sid,Cid:nb.cid});return this.yda.has(nb)?0:4}W5f(nb,Ka){return nb+"_"+Ka}crj(nb){if(this.x4b||this.v4b)return-2;if(this.C8)return this.Lme;nb=-1==nb?this.Xb.Uw(0):this.Xb.i1(nb);return this.mpe[this.W5f(nb.sid,nb.cid)]}prev(){return Object(c.b)(this,void 0,void 0,function*(){this.Jg&&(this.d8()&&this.s$a&&(this.Jg.showLoadingSpinner(),yield this.s$a,this.Jg.hideLoadingSpinner()),
yield this.Jg.prevStep("0_anim"))})}next(){return Object(c.b)(this,void 0,void 0,function*(){this.Jg&&(this.d8()&&this.s$a&&(this.Jg.showLoadingSpinner(),yield this.s$a,this.Jg.hideLoadingSpinner()),yield this.Jg.nextStep("0_anim",3))})}show(){this.Dtd(!0)}Ggb(){return this.ap&&this.ap.style.visibility===Oa.a.xx?!0:!1}Dtd(nb){za.instance.setVisibility(nb&&this.xf.Jt);this.ap&&(nb?(this.ap.style.visibility=Oa.a.xx,$addHandler(window,"visibilitychange",Ka=>{this.q3c(Ka)})):(this.ap.style.visibility=
Oa.a.ht,$removeHandler(window,"visibilitychange",Ka=>{this.q3c(Ka)})))}exit(){this.DZg(!1)}cWa(nb,Ka,Sb,ab,ub,Aa,tb){const kc=!!this.Yd&&!!this.Yd.instance&&(this.Yd.instance.cGc||this.Yd.instance.kM);(this.Yd&&this.Yd.instance&&this.Yd.instance.FO&&this.Yd.instance.Ukc||kc)&&!this.Yd.instance.kWe()?B.a.$(512495900,830,10,"SlideShowCoreFrame::Transcribe - LivePresenter prevented transcriber from starting"):(za.instance.cWa(nb,Ka,Sb,ab,ub,Aa,tb),this.xf.Jt&&this.Jg.recordSessionStats({["metadata"]:"subtitles"}),
this.oTd())}JWf(nb,Ka,Sb,ab){Object(c.b)(this,void 0,void 0,function*(){this.na.isAnimationPreviewEnabled&&(yield this.Jg.refreshViewControllerSSC());this.na.getBooleanAppSetting("EnsureNavigationStateConsistency")||this.Jg.clearNavigationState();ab.navigationType="init";ab.startFromTime=Ka.startFromTime;Ka.waitedForInit=this.i9b;Ka.startInitTime=this.fRg;Ka.beforeInitPromise=Kb.lU();yield this.whb;Ka.afterInitPromise=Kb.lU();ab.bootMetrics=Ka;if(0>nb.slideIndex){var ub=this.na.getBooleanAppSetting("EnsureNavigationStateConsistency")?
yield this.Jg.gotoFirstSlideOptions(!0,{Nd:ab,xan:!0}):yield this.Jg.gotoFirstSlide(!0,ab);G.a("AddLogsForGotoFirstSlideFailure")&&ub&&!ub.fSucceeded&&B.a.$(507799685,830,10,"SlideShowCoreFrame::finishStartFrom: slide show core gotoSlide failed with error {0}",null===ub||void 0===ub?void 0:ub.error);this.ga.style.height="100%";this.ga.style.width="100%";B.a.$(508924041,830,15,"SlideShowCoreFrame::finishStartFrom - Sending slideshowReadyEvent. slideLocation: {0}",JSON.stringify(nb))}else ub={},ub.actionContext=
ab,ub.fSkipTransition=!0,this.na.getBooleanAppSetting("EnsureNavigationStateConsistency")&&(ub.fClearNavigationState=!0),G.a("FixForGotoSlideTelemetryMinify"),ub=yield this.Jg.gotoSlide(nb,ub),!G.a("AddLogsForGotoSlideFailure")||(null===ub||void 0===ub?0:ub.fSucceeded)||B.a.$(507863835,830,10,"SlideShowCoreFrame::finishStartFrom: slide show core gotoSlide failed with error {0}",null===ub||void 0===ub?void 0:ub.error),this.ga.style.height="100%",this.ga.style.width="100%",B.a.$(508924040,830,15,"SlideShowCoreFrame::finishStartFrom - Sending slideshowReadyEvent. slideLocation: {0}",
JSON.stringify(nb));this.d8()&&Sb&&(this.s$a=this.yEa&&this.Bda.oPh(this.BW)?this.Vyh(Sb,ab):this.DPe(1,Sb),yield this.s$a,this.s$a=void 0);this.xa.raiseEvent("OnSlideshowReady",new Sys.EventArgs)})}gIi(nb,Ka,Sb,ab){const ub=this.na.Ac("PptModernSlideShowCheckFullscreenCounter",10),Aa=Kb.lU();let tb=ub,kc=4;G.a("fixEUPLBugEnabled")&&0!=this.cka&&(B.a.$(508411976,830,15,"Clearing check full screen interval if it is already running:{0}.",this.cka),this.na.getBooleanAppSetting("FixSlideShowEUPLBugEnabled")&&
(window.clearInterval(this.cka),this.cka=0));this.cka=window.setInterval(()=>{if(this.na.getBooleanAppSetting("FixSlideShowEUPLBugEnabled")&&this.ude)B.a.$(508404055,830,15,"SlideShowCoreFrame::checkFullscreenBeforeFinishStartFrom - Already CheckingFullScreen, exiting this iteration. checkFullscreenCounter: {0}.",tb);else{this.ude=!0;tb--;B.a.$(512495899,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen counter: {0}.",tb);var dc=Kb.lU();if(this.TO.sYa||0>=tb){const sb=Kb.lU();window.clearInterval(this.cka);
this.cka=0;if(G.a("fixEUPLBugEnabled")&&0==tb%5&&0<=kc){kc--;var Db=z.a.$t();B.a.$(508409102,830,15,"CallStack before checkFullscreenBeforeFinishStartFrom : {0}",Db)}Db=20*(ub-tb);G.a("SSLaunchUnifiedTelemetry")||(Ka.checkFullscreenMs=Db);B.a.$(512495898,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen duration: {0} ms. Time taken in FullScreen API: {1}ms",Db,(sb-dc).toString());G.a("SSLaunchUnifiedTelemetry")&&!Ka.checkFullscreenMs&&(Ka.checkFullscreenMs=Kb.lU()-Aa);this.JWf(nb,Ka,Sb,ab)}this.ude=
!1}},20)}oTd(){let nb=0,Ka=100;this.xf.Jt&&za.instance.isVisible()&&("AboveSlide"===this.xf.a5?(nb=15,Ka=85):"BelowSlide"===this.xf.a5&&(Ka=85));const Sb=document.getElementById("LiveURLBarLayerHost");this.Hwb&&Sb?(this.ga.style.top=String.format("calc({0}% + {1})",nb.toString(),"26px"),this.ga.style.height=String.format("calc({0}% - {1})",Ka.toString(),"26px")):(this.ga.style.top=nb.toString()+"%",this.ga.style.height=Ka.toString()+"%")}K5e(nb){za.instance.K5e(nb)}sTl(){this.jFf("NotAllowedError",
"Error")}bZi(nb){return nb&&"string"===typeof nb&&-1===nb.indexOf("unknown")?-1!==nb.indexOf("CameraStarted")?ResourceStrings.l_CameraReady:-1!==nb.indexOf("NotAllowedError")||-1!==nb.indexOf("SecurityError")||-1!==nb.indexOf("TypeError")?ResourceStrings.l_CameraPermissionError:-1!==nb.indexOf("NotFoundError")||-1!==nb.indexOf("OverconstrainedError")||-1!==nb.indexOf("ErrorStreamStartFailure")||-1!==nb.indexOf("ErrorNoVideoTracks")?ResourceStrings.l_CameraDetectionError:-1!==nb.indexOf("NotReadableError")?
ResourceStrings.l_CameraInUseByAnotherAppError:ResourceStrings.l_CameraError:ResourceStrings.l_CameraUnknownError}setCameraState(nb){var Ka;null===(Ka=this.f9b)||void 0===Ka?void 0:Ka.setCameraState(nb)}XDm(nb){this.f9b&&nb&&this.f9b.updateWebcamDevice(nb)}getDefaultCameraLabel(){var nb,Ka;return null!==(Ka=null===(nb=this.f9b)||void 0===nb?void 0:nb.getDefaultCameraLabel())&&void 0!==Ka?Ka:""}u7e(nb,Ka){this.Hwb=nb;za.instance.etl(nb,void 0===Ka?"":Ka);this.oTd()}r1h(nb){za.instance.setVisibility(nb);
za.instance.oKd();this.oTd()}dtl(){this.xa.raiseEvent("OnFullscreenClick",new Sys.EventArgs)}hga(){this.ap&&this.ap.style.visibility!==Oa.a.ht&&!this.yQj()&&this.ga.focus()}getCurrentPosition(){if(this.Jg){const nb=this.Jg.getSlideLocation();nb?this.xa.raiseEvent("OnGetCurrentPosition",new P({["SlideId"]:nb.slideId.sid,["SlideIndex"]:nb.slideIndex})):B.a.$(512495897,830,10,"SlideShowCoreFrame::GetCurrentPosition: currentLocation is null")}}t2l(){if(this.Jg){const nb=this.Jg.getSlideLocation();if(nb){const Ka=
this.Jg.getAnimationState(!0),Sb=Ka.timelineStates,ab=[];for(let ub=0;ub<Sb.length;ub+=1)ab.push({["TimeLineId"]:Sb[ub].timelineId,["Step"]:Sb[ub].step,["LastClickTime"]:Sb[ub].lastClickTime,["StartTimeOffset"]:Ka.startTimeOffset});this.xa.raiseEvent("OnGetCurrentPosition",new P({["SlideId"]:nb.slideId.sid,["SlideIndex"]:nb.slideIndex,["TimeLineMappings"]:ab}))}else B.a.$(512495896,830,10,"SlideShowCoreFrame::GetCurrentPositionWithTimeLines: currentLocation is null")}}RWe(){if(this.Jg&&this.ap&&this.ap.style.visibility!==
Oa.a.ht){const nb=document.getElementById(this.$wa?"svg-canvas":"webgl-canvas");nb&&this.xa.raiseEvent("OnGetCurrentSlideDimensions",new T({["SlideHeight"]:nb.offsetHeight,["SlideWidth"]:nb.offsetWidth,["SlideLeftBound"]:nb.offsetLeft,["SlideBottomBound"]:nb.offsetTop+nb.offsetHeight}))}}Xld(nb){Object(c.b)(this,void 0,void 0,function*(){if(this.Jg){let Ka;G.a("FixForGotoSlideTelemetryMinify");Ka=yield this.Jg.gotoSlide({["slideIndex"]:nb},{actionContext:{navigationType:"goto"},fSkipTransition:!1});
!G.a("AddLogsForGotoSlideFailure")||(null===Ka||void 0===Ka?0:Ka.fSucceeded)||B.a.$(507863834,830,10,"SlideShowCoreFrame::goToSlide: slide show core gotoSlide failed with error {0}",null===Ka||void 0===Ka?void 0:Ka.error)}})}x5l(nb,Ka){Object(c.b)(this,void 0,void 0,function*(){if(this.Jg){var Sb={},ab=[];let ub=0;for(let Aa=0;Aa<Ka.length;Aa+=1){const tb={};tb.timelineId=Ka[Aa].TimeLineId;tb.step=Ka[Aa].Step;tb.lastClickTime=Ka[Aa].LastClickTime;ub=Ka[Aa].StartTimeOffset;ab.push(tb)}Sb.timelineStates=
ab;Sb.startTimeOffset=ub;ab={actionContext:{navigationType:"goto"}};ab.animationState=Sb;ab.fSkipTransition=!1;G.a("FixForGotoSlideTelemetryMinify");Sb=yield this.Jg.gotoSlide({["slideIndex"]:nb},ab);!G.a("AddLogsForGotoSlideFailure")||(null===Sb||void 0===Sb?0:Sb.fSucceeded)||B.a.$(507863833,830,10,"SlideShowCoreFrame::GoToSlideWithTimeLines: slide show core gotoSlide failed with error {0}",null===Sb||void 0===Sb?void 0:Sb.error)}})}DPe(nb,Ka){return Object(c.b)(this,void 0,void 0,function*(){B.a.$(512309260,
830,15,"SlideShowCoreFrame::updateSlideShowCoreAfterEdit: CurrentPodSessionId:{0}",this.yM);let Sb=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.na.ym,this.yM);if(G.a("AddCallerQueryParam")){const ub=this.na.getBooleanAppSetting("PPTOPresentFrontDoorEnabled");Sb+=`&caller=Slideshow&pptoPresentFrontDoorEnabled=${ub}`}const ab=new Date;return new Promise((ub,Aa)=>{const tb={};tb.startTime=ab;if(this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.UseXMLHttpRequestForSSSnap",
!1)){const kc=this.Ina.faa(Sb);kc.onreadystatechange=()=>Object(c.b)(this,void 0,void 0,function*(){kc.readyState===XMLHttpRequest.DONE&&(tb.correlationId=kc.getResponseHeader("X-CorrelationId"),yield this.a_g(JSON.parse(kc.response),Ka,tb),ub())});kc.onerror=()=>Object(c.b)(this,void 0,void 0,function*(){tb.httpStatus=kc.status;tb.correlationId=kc.getResponseHeader("X-CorrelationId");yield this.ZZg(nb,Ka,tb);Aa()});kc.send()}else{const kc={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};
kc["X-UserSessionId"]=h.AFrameworkApplication.userSessionId;this.Iq.ik(Sb,1,"",kc,!1,0,dc=>Object(c.b)(this,void 0,void 0,function*(){var Db,sb,Qb,$a,X;tb.correlationId=null===(Db=null===dc||void 0===dc?void 0:dc.data)||void 0===Db?void 0:Db.gj["X-CorrelationId"];tb.enqueueTime=null===(sb=null===dc||void 0===dc?void 0:dc.data)||void 0===sb?void 0:sb.Wy;tb.invokedTime=null===(Qb=null===dc||void 0===dc?void 0:dc.data)||void 0===Qb?void 0:Qb.Oo;tb.completedTime=null===($a=null===dc||void 0===dc?void 0:
dc.data)||void 0===$a?void 0:$a.Gp;yield this.a_g(JSON.parse(null===(X=null===dc||void 0===dc?void 0:dc.data)||void 0===X?void 0:X.responseData),Ka,tb);B.a.$(509636748,830,15,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlSucceededAfterEdit");ub()}),dc=>Object(c.b)(this,void 0,void 0,function*(){var Db,sb;tb.httpStatus=null===(Db=null===dc||void 0===dc?void 0:dc.data)||void 0===Db?void 0:Db.Je;tb.correlationId=null===(sb=null===dc||void 0===dc?void 0:dc.data)||void 0===sb?void 0:
sb.gj["X-CorrelationId"];yield this.ZZg(nb,Ka,tb);B.a.$(509636747,830,10,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlFailedAfterEdit");Aa()}),null,null)}})})}a_g(nb,Ka,Sb){return Object(c.b)(this,void 0,void 0,function*(){const ab=new Date;Sb.timeTaken=+ab-+Sb.startTime;B.a.$(512309279,830,15,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit : {0}",Sb);this.oB=nb.downloadUrl;void 0!==nb.sendGetItemsRequestToPFD&&(this.Hna=nb.sendGetItemsRequestToPFD);l.a.wb(this.oB)?
B.a.$(512309278,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit but downloadUrl is null or empty : {0}",nb):(this.z_=Date.now(),yield this.CPe(Sb.startTime,ab,Ka))})}ZZg(nb,Ka,Sb){return Object(c.b)(this,void 0,void 0,function*(){0<nb--?(B.a.$(512309277,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : Retrying to Get Snapped Download Url. Current Retry Count: {0}, {1}",nb,Sb),yield this.DPe(nb,Ka)):B.a.$(512309276,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : {0}",
Sb)})}uah(nb,Ka,Sb){Sb=void 0===Sb?1:Sb;return Object(c.b)(this,void 0,void 0,function*(){B.a.$(512309259,830,15,"SlideShowCoreFrame::RefreshPodSession: CurrentPodSessionId:{0}, UpdatedPodSessionId:{1}",this.yM,nb);this.yM=nb;this.XJb=Ka;let ab=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.na.ym,this.yM);if(G.a("AddCallerQueryParam")){const Aa=this.na.getBooleanAppSetting("PPTOPresentFrontDoorEnabled");ab+=`&caller=Slideshow&pptoPresentFrontDoorEnabled=${Aa}`}const ub=
new Date;return new Promise((Aa,tb)=>{const kc={};kc.startTime=ub;if(this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.UseXMLHttpRequestForSSSnap",!1)){const dc=this.Ina.faa(ab);dc.onreadystatechange=()=>Object(c.b)(this,void 0,void 0,function*(){dc.readyState===XMLHttpRequest.DONE&&(kc.correlationId=dc.getResponseHeader("X-CorrelationId"),yield this.b_g(JSON.parse(dc.response),kc),Aa())});dc.onerror=()=>Object(c.b)(this,void 0,void 0,function*(){kc.httpStatus=dc.status;kc.correlationId=
dc.getResponseHeader("X-CorrelationId");yield this.$Zg(Sb,kc);tb()});dc.send()}else{const dc={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};dc["X-UserSessionId"]=h.AFrameworkApplication.userSessionId;this.Iq.ik(ab,1,"",dc,!1,0,Db=>Object(c.b)(this,void 0,void 0,function*(){var sb,Qb,$a,X,Ta;kc.correlationId=null===(sb=null===Db||void 0===Db?void 0:Db.data)||void 0===sb?void 0:sb.gj["X-CorrelationId"];kc.enqueueTime=null===(Qb=null===Db||void 0===Db?void 0:Db.data)||
void 0===Qb?void 0:Qb.Wy;kc.invokedTime=null===($a=null===Db||void 0===Db?void 0:Db.data)||void 0===$a?void 0:$a.Oo;kc.completedTime=null===(X=null===Db||void 0===Db?void 0:Db.data)||void 0===X?void 0:X.Gp;yield this.b_g(JSON.parse(null===(Ta=null===Db||void 0===Db?void 0:Db.data)||void 0===Ta?void 0:Ta.responseData),kc);Aa()}),Db=>Object(c.b)(this,void 0,void 0,function*(){var sb,Qb;kc.httpStatus=null===(sb=null===Db||void 0===Db?void 0:Db.data)||void 0===sb?void 0:sb.Je;kc.correlationId=null===
(Qb=null===Db||void 0===Db?void 0:Db.data)||void 0===Qb?void 0:Qb.gj["X-CorrelationId"];yield this.$Zg(Sb,kc);tb()}),null,null)}})})}b_g(nb,Ka){return Object(c.b)(this,void 0,void 0,function*(){var Sb=new Date;B.a.$(512309275,830,15,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession : {0}",Ka);this.oB=nb.downloadUrl;void 0!==nb.sendGetItemsRequestToPFD&&(this.Hna=nb.sendGetItemsRequestToPFD);l.a.wb(this.oB)?(B.a.$(512309274,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession but downloadUrl is null or empty : {0}",
nb),this.Ggb()&&(Sb=w.a.Ji(413),h.AFrameworkApplication.Ds(Sb),v.Health.instance.recordQosError(w.a.Vma(Sb),["SlideShowACE"],!1,!0,!0,!0,null),this.Jg&&this.Jg.recordSessionStats({["errorName"]:"ErrorSlideShowRehydrationFailed"}),this.exit())):(this.z_=Date.now(),yield this.CPe(Ka.startTime,Sb),G.a("prefetchOnPodSessionRefreshEnabled")&&this.Jg.prefetchOnPodSessionRefresh())})}$Zg(nb,Ka){return Object(c.b)(this,void 0,void 0,function*(){0<nb--?(B.a.$(512309273,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : Retrying to Get Snapped Download Url. Current Retry Count: {0}, {1}",
nb,Ka),yield this.uah(this.yM,this.XJb,nb)):(B.a.$(512309272,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : {0}",Ka),this.Ggb()&&this.exit())})}setVisibility(nb){this.Dtd(nb)}uEb(nb){this.ap&&(this.ap.style.cursor=nb?"default":"none");za.instance.uEb(nb)}YGk(nb){if(this.h9b)this.h9b.onInkManagerActivity(nb)}tac(nb){this.jZh(nb)}jZh(nb){this.xa.raiseEvent("OnSpecialKey",new I({["Key"]:nb.keyCode,["ShiftKey"]:nb.shiftKey,["AltKey"]:nb.altKey}))}X0g(){this.ap&&this.hga()}krb(){const nb=
new Map;nb.set("X-UserSessionId",this.Smc);nb.set("X-WacNoAuth","1");nb.set("X-WacCluster",this.XJb);nb.set("Client","Unified App");G.a("AddHostInfoTelemetry")&&nb.set("HostName",h.AFrameworkApplication.rd.Host);this.na.JLh&&nb.set("UseDocCache","True");return nb}DZg(nb){nb=void 0===nb?!1:nb;var Ka,Sb,ab;B.a.$(507773716,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler");this.cka&&(B.a.$(512495890,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler m_fullscreenCheckerId is not zero: {0}",
this.cka),window.clearInterval(this.cka),this.cka=0);this.h9b&&this.h9b.resetInkCanvas();null===(Ka=this.f9b)||void 0===Ka?void 0:Ka.setCameraState(!1);this.c$a&&(null===(ab=null===(Sb=this.g9b)||void 0===Sb?void 0:Sb.instance)||void 0===ab?void 0:ab.hide(),window.clearTimeout(this.c$a),this.c$a=void 0);this.S8&&this.T8&&(this.S8.tabIndex=-1,this.T8.tabIndex=-1);this.Jg?(Ka=this.Jg.getSlideLocation(),this.Jg.endSession(Kb.lU()),G.a("ssExitTelemetryEnabled")&&B.a.$(508071949,830,15,"SlideShowCoreFrame::OnExitFromSlideShowHandler: Exiting the SlideShow"),
Ka?this.xa.raiseEvent("OnExit",new E({["SlideId"]:Ka.slideId.sid,["IsBeforeReady"]:!1,["SlideIndex"]:Ka.slideIndex,["IsFromEndOfSlideshow"]:nb})):(this.xa.raiseEvent("OnExit",new E({["IsFromEndOfSlideshow"]:nb})),B.a.$(512495889,830,10,"SlideShowCoreFrame::OnExitFromSlideShowHandler: currentLocation is null")),B.a.$(507773715,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler: Exit event raised")):G.a("SendExitEventOnSlideShowTimeout")&&(this.xa.raiseEvent("OnExit",new E({["IsFromEndOfSlideshow"]:nb})),
B.a.$(507605470,830,15,"SlideShowCoreFrame::OnExitFromSlideShowHandler: m_slideshowCore is null, sending exit event"));this.ga&&(this.ga.style.width=window.screen.width+"px",this.ga.style.height=window.screen.height+"px");this.Dtd(!1);za.instance.Yph()}nqd(){if(this.Jg&&this.ap&&this.ap.style.visibility!==Oa.a.ht){const nb=this.Jg.getSlideLocation();if(nb){const Ka=this.Jg.getAnimationState(!0),Sb=Ka.timelineStates,ab=[];for(let ub=0;ub<Sb.length;ub+=1)ab.push({["TimeLineId"]:Sb[ub].timelineId,["Step"]:Sb[ub].step,
["LastClickTime"]:Sb[ub].lastClickTime,["StartTimeOffset"]:Ka.startTimeOffset});this.xa.raiseEvent("OnPositionChangeEventId",new M.a({["SlideId"]:nb.slideId.sid,["SlideIndex"]:nb.slideIndex,["TimeLineMappings"]:ab}))}else B.a.$(512495888,830,10,"SlideShowCoreFrame::OnPositionChangedHandler: currentLocation is null")}}Kwk(nb){if(this.Jg&&this.ap&&this.ap.style.visibility!==Oa.a.ht)switch(nb){case "Hidden":this.xa.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty);break;case "EndOfShow":this.xa.raiseEvent("OnEnterEndOfShowEventId",
Sys.EventArgs.Empty);break;default:B.a.$(512495887,830,15,"SlideshowCoreFrame.OnBlankSlideStateChangedHandler {0}",nb)}}G1e(nb){if(this.Jg){B.a.$(512495886,830,10,"SlideshowCoreFrame.OnErrorHandler {0}",nb);let Ka;nb.startsWith("Server")&&(nb="GetItemsRequestFailed");switch(nb){case "GetItemsFailedDownloadFile":B.a.$(512495885,830,10,"SlideshowCoreFrame.OnErrorHandler ErrorSlideShowFailedToDownloadFile PodSessionId {0}",this.yM);this.xa.raiseEvent("OnPodSessionExpired",new K({["Code"]:5341407,["Reason"]:"Failed To Download File",
["PodSessionId"]:this.yM}));return;case "LoadFailed":Ka=407;break;case "GetItemsFailedInvalidResponse":Ka=408;break;case "GetItemsRequestFailed":Ka=409;break;case "GetItemsTimeout":Ka=411;break;case "EnsureSlideFailed":Ka=412;break;case "SetupWebGLContextFailed":case "RestoreWebGLContextFailed":Ka=414;break;default:Ka=359}if(0!==Ka)if(this.Ggb()){const Sb=w.a.Ji(Ka);h.AFrameworkApplication.Ds(Sb);nb=409===Ka?nb:w.a.Vma(Sb);v.Health.instance.recordQosError(nb,["SlideShowACE"],!1,!0,!0,!0,null);this.Jg.recordSessionStats({["errorName"]:nb})}else B.a.$(512495884,
830,15,"SlideshowCoreFrame.OnErrorHandler received error when frame is hidden. ErrorCode:{0}",nb)}}bBk(nb){B.a.$(512495883,830,50,"SlideshowCoreFrame.OnTranscriberStartedHandler");this.Jg&&this.ap&&this.ap.style.visibility!==Oa.a.ht&&this.xa.raiseEvent("OnTranscriberStartedEventId",new Q({["TranscriberSessionId"]:nb}));this.xf.nWe=!0}q3c(){B.a.$(512495882,830,50,"SlideshowCoreFrame.OnVisibilityChangeHandler");window.document.hidden&&this.xa.raiseEvent("OnVisibilityChangeEventId",new U(!1))}yQj(){return!!this.Yd&&
!!this.Yd.instance&&this.Yd.instance.V_l}NFh(nb){this.xa.addHandler("OnSlideshowReady",nb)}pYh(nb){this.xa.removeHandler("OnSlideshowReady",nb)}rti(nb){this.xa.addHandler("OnBrowserEvent",nb)}WYk(nb){this.xa.removeHandler("OnBrowserEvent",nb)}RPl(nb){this.xa.addHandler("OnFullscreenClick",nb)}fum(nb){this.xa.removeHandler("OnFullscreenClick",nb)}vti(nb){this.xa.addHandler("OnSlideshowContextMenu",nb)}YYk(nb){this.xa.removeHandler("OnSlideshowContextMenu",nb)}TSb(nb){this.xa.addHandler("OnExit",nb)}aLb(nb){this.xa.removeHandler("OnExit",
nb)}NPl(nb){this.xa.addHandler("OnSlideshowError",nb)}cum(nb){this.xa.removeHandler("OnSlideshowError",nb)}Dxf(nb){this.xa.addHandler("OnGetCurrentSlideDimensions",nb)}lch(nb){this.xa.removeHandler("OnGetCurrentSlideDimensions",nb)}Cxf(nb){this.xa.addHandler("OnGetCurrentPosition",nb)}WDe(nb){this.xa.removeHandler("OnGetCurrentPosition",nb)}OFh(nb){this.xa.addHandler("OnSpecialKey",nb)}qYh(nb){this.xa.removeHandler("OnSpecialKey",nb)}qQl(nb){this.xa.addHandler("OnVisibilityChangeEventId",nb)}oZk(nb){this.xa.removeHandler("OnVisibilityChangeEventId",
nb)}Qti(nb){this.xa.addHandler("OnPodSessionExpired",nb)}kZk(nb){this.xa.removeHandler("OnPodSessionExpired",nb)}YPl(nb){this.xa.addHandler("OnLogEndOfTranscriptionSession",nb)}num(nb){this.xa.removeHandler("OnLogEndOfTranscriptionSession",nb)}Pjc(nb){this.xa.addHandler("OnPositionChangeEventId",nb)}F7c(nb){this.xa.removeHandler("OnPositionChangeEventId",nb)}WPl(nb){this.xa.addHandler("OnLiveSubtitlesDockedViewEventId",nb)}kum(nb){this.xa.removeHandler("OnLiveSubtitlesDockedViewEventId",nb)}Cti(nb){this.xa.addHandler("OnEnterEndOfShowEventId",
nb)}bZk(nb){this.xa.removeHandler("OnEnterEndOfShowEventId",nb)}Mti(nb){this.xa.addHandler("OnLeaveEndOfShowEventId",nb)}iZk(nb){this.xa.removeHandler("OnLeaveEndOfShowEventId",nb)}mQl(nb){this.xa.addHandler("OnSubtitleUpdatedEventId",nb)}vum(nb){this.xa.removeHandler("OnSubtitleUpdatedEventId",nb)}nQl(nb){this.xa.addHandler("OnTranscriberStartedEventId",nb)}wum(nb){this.xa.removeHandler("OnTranscriberStartedEventId",nb)}wQl(nb){this.xa.addHandler("RecordQosErrorEventId",nb)}Dum(nb){this.xa.addHandler("RecordQosErrorEventId",
nb)}JPl(nb){this.xa.addHandler("OnCameraErrorEventId",nb)}Ztm(nb){this.xa.removeHandler("OnCameraErrorEventId",nb)}fzk(nb){this.xa.raiseEvent("OnBrowserEvent",new H({["ClientX"]:nb.clientX,["ClientY"]:nb.clientY}))}N1c(nb){this.xa.raiseEvent("OnSlideshowContextMenu",new N({["ClientX"]:nb.clientPoint.x,["ClientY"]:nb.clientPoint.y}));return!0}static lU(){return Math.round(window.performance.now())}}Object(y.a)(Kb,"SlideShowCoreFrame",null,[519])},1534:function(y,C,a){a.d(C,"a",function(){return m});
y=a(0);var c=a(405);class b{constructor(){this.Ver=1}}Object(y.a)(b,"CacheItem",null,[]);class d{constructor(){}}Object(y.a)(d,"AppsDataCacheManager",null,[703]);var e=a(274),h=a(15),n=a(394);class m{constructor(){this.Xpd=new Set;new d(n.a.instance)}pZh(k,l){k=e.a.n1f()+k;n.a.instance.setItem(k,l.toString())}Tnj(){var k=e.a.d0d();c.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",k);k=n.a.instance.getItem(k);return h.a(k)}zbl(k){const l=e.a.d0d();c.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",
l);n.a.instance.setItem(l,h.c(k))}Oal(k){this.Xpd=k}PTj(){return!!n.a.instance.localStorage}static get instance(){m.Qa||(m.Qa=new m);return m.Qa}}m.Qa=null;Object(y.a)(m,"AddInCommandsCacheManager",null,[678])},1609:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=
!0;this.supportsAuthToken=!1}static U1l(b){switch(b){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(y.a)(c,"WopiAuthContext",null,[869])},1628:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c extends Sys.EventArgs{constructor(b,d,e){e=void 0===e?null:e;super();this.shapeId=b;this.tHj=d;this.Q9=e}}Object(y.a)(c,"ReplaceObjectSuggestionPointerOverEventArgs",Sys.EventArgs,[])},1629:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c extends Sys.EventArgs{constructor(b,
d){d=void 0===d?null:d;super();this.shapeId=b;this.Q9=d}}Object(y.a)(c,"ReplaceObjectSuggestionPointerOutEventArgs",Sys.EventArgs,[])},1630:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.wGh=null}}Object(y.a)(c,"IdeasSmartArtSuggestionWrapper",null,[])},1892:function(y,C,a){a.r(C);var c=a(0),b=a(95),d=a(638),e=a(405),h=a(6),n=a(41),m=a(247),k=a(143),l;(function(Y){Y[Y.error=0]="error";Y[Y.warning=1]="warning";Y[Y.tip=2]="tip";Y[Y.intelligentService=3]="intelligentService"})(l||
(l={}));Object(c.b)("AccessibilityRuleCategory",l);var u=a(98),r=a(57),x=a(144),v=a(173),z=a(120);class A{constructor(Y,Sa,Mb){this.E6h=null;this.YKl=this.VKl=!1;this.Zxc=Y;this.nCh=Sa;this.Aa=void 0===Mb?null:Mb;this.Ft.Ba(r.a.FUl,u.a.frame,Object(h.a)(this,this.ifa,"closePane"))}get Ft(){return this.Aa||(this.Aa=n.AFrameworkApplication.ub)}set Ft(Y){this.Aa=Y}r$m(){this.VKl||(this.Zxc.initialize(this),this.nCh.initialize(this),this.VKl=!0)}Uwk(){z.c(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});
this.nCh.a9n()}vo(Y,Sa,Mb){if(1===Mb)return m.SessionStatusManager.instance.iPa?8:32;this.Zxc.isVisible||this.r$m();this.Veo();return 32}ifa(Y,Sa,Mb){1!==Mb&&this.Zxc.Tx();return 32}cAk(){this.Zxc.Nzm(!0)}A_i(Y){if(Y){if(Y.AccessibilityRules&&Object.keys(Y.AccessibilityRules).length){const Mb=Y.AccessibilityRules;for(const oc in Mb){var Sa=oc;const Oc=Mb[oc].RuleId+"";Sa!==Oc&&z.c(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",Sa,Oc)}this.E6h=Mb}else!this.E6h&&
Y.Results&&0<Y.Results.length?(z.c(18993251,200,15,"No accessibility rule definitions available"),Y.IsSuccess=!1):Y.AccessibilityRules=this.E6h;Y.IsSuccess||z.c(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.Y5n(Y);this.rCn(Y);this.Zxc.A_i(Y)}}Y5n(Y){const Sa=Y.AccessibilityRules;if(Y=Y.Results)for(let Mb=Y.length-1;0<=Mb;Mb--){const oc=Y[Mb];let Oc="";const nd=oc.RuleId;oc.ContentName||(Oc+="Result does not have content name. ");nd in Sa||(Oc+=String.format("No accessibility check rule exists for ID {0}.",
nd));0<Oc.length&&(z.c(36214999,200,15,"Omitting invalid accessibility check result: "+Oc),Array.removeAt(Y,Mb))}}Rkn(){return n.AFrameworkApplication.ha.getBooleanAppSetting("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):Object(d.a)().SU.loadScript("accessibility-checker-pane-strings")}Veo(){this.YKl?this.Zxc.vo():this.Rkn().then(()=>{this.YKl=!0;this.Zxc.vo()}).catch(Y=>e.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
Y))}rCn(Y){var Sa={};const Mb={};var oc=Y.Results,Oc=[];Array.add(Oc,Object.assign(new x.a,{name:"FinalViolationCount",int64:0}));Array.add(Oc,Object.assign(new x.a,{name:"FinalErrorCount",string:"0"}));Array.add(Oc,Object.assign(new x.a,{name:"FinalWarningCount",string:"0"}));Array.add(Oc,Object.assign(new x.a,{name:"FinalTipCount",string:"0"}));Array.add(Oc,Object.assign(new x.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(oc){for(const Zd of oc)if(Y.AccessibilityRules){var nd=Y.AccessibilityRules[Zd.RuleId];
if(nd){if(Sa[l[nd.Category]]){let we=Sa[l[nd.Category]];Sa[l[nd.Category]]=++we}else Sa[l[nd.Category]]=1;Mb[Zd.RuleId]?(nd=Mb[Zd.RuleId],Mb[Zd.RuleId]=++nd):Mb[Zd.RuleId]=1}}Oc[0].int64=oc.length;for(var Cd in Sa)switch(Y=Sa[Cd],oc=Cd,oc="Final"+oc.charAt(0).toUpperCase()+oc.substring(1,oc.length)+"Count",oc){case "FinalErrorCount":Oc[1].string=Y.toString();break;case "FinalWarningCount":Oc[2].string=Y.toString();break;case "FinalTipCount":Oc[3].string=Y.toString();break;case "FinalIntelligentServiceCount":Oc[4].string=
Y.toString()}}k.a.sendTelemetryEvent(Object.assign(new v.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:Oc}));for(const Zd in Mb)Sa=Zd,Oc=Mb[Zd],Cd=[],Array.add(Cd,Object.assign(new x.a,{name:"RuleID",string:Sa})),Array.add(Cd,Object.assign(new x.a,{name:"FinalViolationCount",string:Oc.toString()})),k.a.sendTelemetryEvent(Object.assign(new v.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Cd}))}dispose(){this.Zxc&&
this.Zxc.dispose();this.nCh&&this.nCh.dispose()}}Object(c.a)(A,"AAccessibilityCheckManager",null,[86,40]);var B=a(99),G=a(1703),w=a(80),F=a(339),H=a(40);class E extends A{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we){super(Y,Sa);this.hoe=this.sXc=null;this.Na=Mb;this.Yb=oc;this.pr=Oc;this.gEa=nd;this.ya=Cd;this.sa=Zd;this.Xb=we;this.Cmk=!1}Dao(Y){if(!Y)return H.a.$(507843714,334,15,"Cannot navigate since violation data is null"),!1;if(Y.sldIdField){var Sa=new w.a(Object.assign(new F.a,{Sid:Y.sldIdField.sidField,
Cid:Y.sldIdField.cidField}));Sa=this.Xb.agb(Sa);if(!Sa)return!1;let Mb=null;if(Y.spIdFieldSpecified&&(Mb=Sa.ED(Y.spIdField),!Mb&&this.Cmk))return!1;this.V9n(Sa,Mb)}else H.a.$(507843713,334,15,"There is no slide id info in violation data");return!0}Uwk(){this.Cmk=!1;super.Uwk()}cAk(){this.Cmk=!0;super.cAk()}V9n(Y,Sa){if(Y){const Mb=this.ya.Ia!==Y?!0:!1;Sa&&(this.hoe=Sa,Mb?this.pr.Hha(Object(h.a)(this,this.C1e,"onActiveSlideDomChanged")):this.dxm());Mb&&(this.gEa.Ia=Y);this.sa.Rx();this.Na.ee()}}C1e(){this.pr.Cbb(Object(h.a)(this,
this.C1e,"onActiveSlideDomChanged"));this.sXc||(this.sXc=new B.a(2,1,0,Object(h.a)(this,this.Ezk,"onPostActiveSlideDomChangedTask"),90,"20"),this.Yb.Rb(this.sXc))}Ezk(){this.sXc=null;this.dxm()}ee(){this.gEa.AJ.Kp||this.Na.ee()}dxm(){if(this.hoe){const Y=Object(G.a)(112,this.hoe.Vg(this.gEa.AJ.Ua));Y?Y.isDisposed?H.a.$(507843712,334,50,"Shape view element of node {0} has been disposed",this.hoe.id):Y.isLocked?Y.xEb():this.sa.selectShape(this.hoe,!0):H.a.$(507843683,334,50,"Try select node {0} but cannot find its shape view element",
this.hoe.id);this.ee();this.hoe=null}}}Object(c.a)(E,"PptAccCheckManager",A,[]);class P{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(Y){Y=Sys.Serialization.JavaScriptSerializer.deserialize(Y);const Sa=Y.AccessibilityRules,Mb={};if(Sa)for(let oc=0;oc<Sa.length;++oc){const Oc=Sa[oc];Mb[Oc.Key]=Oc.Value}Y.AccessibilityRules=Mb;return Y}}Object(c.a)(P,"AccessibilityCheckResultCollection",null,[]);class T{}Object(c.a)(T,"AccessibilityCheckResult",
null,[]);class K{}Object(c.a)(K,"AccessibilityCheckRule",null,[]);class M{constructor(Y){this.egd=null;this.sKl=Y}get fileId(){return this.sKl?this.sKl():null}initialize(Y){this.egd=Y}glm(Y){this.egd.A_i(Y)}}Object(c.a)(M,"AAccessibilityCheckService",null,[296,40]);var N=a(21),I=a(133);class O extends I.a{constructor(){super()}lo(){return 56}}Object(c.a)(O,"AccCheckRequest",I.a,[]);var Q=a(283);class U extends M{constructor(Y,Sa){super(null);this.Jm=Y;this.dpd=Sa}a9n(){const Y=new Q.a(new O,Object(h.a)(this,
this.JPn,"onAccCheckSucceed"),Object(h.a)(this,this.IPn,"onAccCheckFailed"));this.Jm.Rb(Y)}dispose(){}get Zvn(){return 0<this.dpd.gTe.length}JPn(Y){if(Y&&Y.ACResult&&(Y=this.GYm(Y.ACResult))){this.glm(Y);H.a.$(19227935,334,50,"Acc-check succeeded");return}this.Tim("Succeeded but response is invalid")}IPn(Y){this.Tim(Y.toString());return!0}Tim(Y){H.a.$(19227937,334,50,String.format("Acc-check failed: {0}",Y));Y=new P;Y.IsSuccess=!1;this.glm(Y)}GYm(Y){if(Y){var Sa=null;try{Sa=JSON.parse(Y)}catch(Mb){return H.a.$(19227939,
334,10,"Cannot parse acc-check result json: {0}",Mb.toString()),null}if(Sa){Y=new P;Y.IsSuccess=!0;Y.IsPartialResult=Sa.isPartialResultField;Y.AccessibilityRules={};if(Sa.violatedRulesField){const Mb=new N.a;for(const oc of Sa.violatedRulesField)if(Sa=this.HYm(oc)){Y.AccessibilityRules[Sa.RuleId]=Sa;for(const Oc of oc.violationsField){const nd=new T;nd.RuleId=Sa.RuleId;nd.ContentName=Oc.labelField;nd.ContentId=Oc;Mb.add(nd)}}Y.Results=Mb.toArray()}return Y}}return null}HYm(Y){if(!Y)return null;if(Y.ruleIdField>=
this.dpd.gTe.length)return H.a.$(19227971,334,10,"Rule id {0} is bigger than total rule info list count {1}",Y.ruleIdField,this.dpd.gTe.length),null;const Sa=new K;Sa.RuleId=Y.ruleIdField.toString();Sa.RuleName=this.dpd.gTe[Y.ruleIdField].ruleTextField;switch(this.dpd.gTe[Y.ruleIdField].ruleTypeField){case 0:Sa.Category=0;break;case 1:Sa.Category=1;break;case 2:Sa.Category=2;break;case 3:Sa.Category=3}return Sa}}Object(c.a)(U,"PptAccCheckService",M,[806,296,40]);var ba=a(59);class aa{get G2m(){return Object(ba.a)("AccCheckerContentNotFoundDialogActionButton")}get H2m(){return Object(ba.a)("AccCheckerContentNotFoundDialogBody")}get I2m(){return Object(ba.a)("AccCheckerContentNotFoundDialogTitle")}get HVn(){return Object(ba.a)("AccCheckerOutOfSyncNotificationMessageBody")}get Z1e(){return Object(ba.a)("AccCheckerPaneTitle")}get uWn(){return Object(ba.a)("AccCheckerPartialResultNotification")}}
Object(c.a)(aa,"AccessibilityCheckStringsProvider",null,[295]);class La{constructor(){this.jwm=this.contentId=null}}Object(c.a)(La,"ResultIds",null,[]);var Z=a(88),la=a(215);class da{constructor(Y,Sa){this._element=null;this.ov=Sa;this.Tj=Y}get element(){this._element||(this._element=this.gLf(),this.Oz());return this._element}Jcb(Y){this._element=Y}dispose(){this.element&&(this.wJa(),this.Jcb(null))}Oz(){this.ov&&this.Tj?(this.ov.Ub(Z.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),
this.Tj.Ub(Z.a.oi,this.element,Object(h.a)(this,this.hmm,"onKeyPress"))):e.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}wJa(){this.ov&&this.Tj&&(this.ov.hc(Z.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.Tj.hc(Z.a.oi,this.element,Object(h.a)(this,this.hmm,"onKeyPress")))}onClick(){this.emm();return!0}hmm(Y){return this.Axn(Y.Pb.keyCode)?(this.emm(),!0):!1}Axn(Y){return Y===
la.a.dud||Y===la.a.nv}}Object(c.a)(da,"AInteractivePaneElement",null,[381,40]);const J=(Y,Sa,Mb)=>{Y=document.createElement(Y);Sa&&(Y.id=Sa);Mb&&(Y.className=Mb);Y.setAttribute("Unselectable","on");return Y};var Ca=a(109),Fa=a(221),ya=a(111);class Ua extends da{constructor(Y,Sa,Mb){super(Y,Sa);this.OPm=Mb}hide(){this.element.removeAttribute(Fa.a.ii);Fa.a.vea(this.element,Fa.a.CK,Fa.a.iE);this.element.style.display="none"}show(){Fa.a.vea(this.element,Fa.a.CK,Fa.a.Npa);Fa.a.vea(this.element,Fa.a.ii,
Fa.a.aUe);this.element.style.display="block"}gLf(){const Y=J("div",this.mkm,"AccCheckerNotification");Fa.a.vea(Y,Fa.a.AGh,Fa.a.iE);Fa.a.vea(Y,Fa.a.nba,this.$uk);Y.tabIndex=0;const Sa=J("span",this.lkm,"AccCheckerNotificationIcon");var Mb=Ca.a(16,16,"Info_16x16x32","",!0,"");Sa.appendChild(Mb);Mb=J("span",this.$uk,"AccCheckerNotificationText");ya.a.CB(Mb,this.nkm);Y.appendChild(Sa);Y.appendChild(Mb);return Y}emm(){this.OPm()}}Object(c.a)(Ua,"APopupNotification",da,[481,381,40]);class Ia extends Ua{constructor(Y,
Sa,Mb,oc){super(Y,Sa,Mb);this.lHb=oc}get mkm(){return"AccCheckerOutOfSyncNotificationId"}get lkm(){return"AccCheckerOutOfSyncNotificationIconId"}get $uk(){return"AccCheckerOutOfSyncNotificationTextId"}get nkm(){return this.lHb.HVn}}Object(c.a)(Ia,"OutOfSyncNotification",Ua,[]);class Oa extends Ua{constructor(Y,Sa,Mb,oc){super(Y,Sa,Mb);this.lHb=oc}get mkm(){return"AccCheckerPartialResultNotificationId"}get lkm(){return"AccCheckerPartialResultNotificationIconId"}get $uk(){return"AccCheckerPartialResultNotificationTextId"}get nkm(){return this.lHb.uWn}}
Object(c.a)(Oa,"PartialResultNotification",Ua,[]);var ma=a(187),za=a(164);class Qa{constructor(Y,Sa,Mb,oc,Oc,nd,Cd){Oc=void 0===Oc?null:Oc;nd=void 0===nd?null:nd;this.sNl=this.o$=this.Tj=this.egd=null;this.Xlc=void 0===oc?null:oc;this.ov=Y;this.Fe=Sa;this.HX=Mb;this.lHb=(void 0===Cd?null:Cd)||new aa;this.Rgi=Oc||new Ia(this.Xlc,this.ov,Object(h.a)(this,this.j8m,"dimissOutOfSyncNotification"),this.lHb);this.lhi=nd||new Oa(this.Xlc,this.ov,Object(h.a)(this,this.k8m,"dimissPartialResultNotification"),
this.lHb)}show(){}hide(){}get Xlc(){return this.Tj||(this.Tj=n.AFrameworkApplication.Ha.OH)}set Xlc(Y){this.Tj=Y}bVe(){}Tx(){}dispose(){}KDm(){}D5e(){}Vvn(Y){var Sa=this.sNl[Y];Y=Sa.contentId;if((Sa=Sa.jwm+"")&&Sa.length){const Mb=[];Array.add(Mb,Object.assign(new x.a,{name:"RuleID",string:Sa}));k.a.sendTelemetryEvent(Object.assign(new v.a,{name:String.format("{0}.{1}",Qa.Uql,"ViolationSelected"),dataFields:Mb}))}this.IOn(Y)}IOn(Y){Y&&this.egd.Dao(Y)||(this.Fe.haa(ma.AFrame.u5,!1),this.ieo())}j8m(){this.Nzm(!1);
this.D5e()}k8m(){this.Pzm(!1);this.D5e()}ieo(){const Y=Object.assign(new za.a(!0),{Vw:n.AFrameworkApplication.zra,Ue:1,AEb:!1});Y.scb(1);Y.vg(1,this.lHb.G2m);Y.vg(0,Object(ba.a)("DialogCancel"));Y.h6(this.lHb.I2m,this.lHb.H2m,Sa=>{1===Sa&&this.KMj()})}zZm(Y){let Sa=null;if(Y.Results&&0<Y.Results.length){Sa={};let Mb=0;for(const oc of Y.Results)oc.ResultId=Qa.HSm+ ++Mb,Y=new La,Y.contentId=oc.ContentId,Y.jwm=oc.RuleId,Sa[oc.ResultId]=Y}return Sa}yCn(){k.a.addNamespaceMapping(Qa.Uql,Qa.eio);k.a.sendTelemetryEvent(Object.assign(new v.a,
{name:String.format("{0}.{1}",Qa.Uql,"ShowTaskpane")}))}}Qa.HSm="AccCheckResult";Qa.Uql="Office.UX.AccChecker";Qa.eio="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(c.a)(Qa,"BaseAccessibilityCheckPane",null,[297,40]);class Xa{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=
this.updateLastScanTime=null}}Object(c.a)(Xa,"AccCheckerTaskPaneProps",null,[]);var Tb=a(1835),Kb=a(407);class nb{constructor(){this.DCh=new N.a}m7c(Y){this.DCh.add(Y)}fkh(Y){for(const Sa of this.DCh)Sa(Y)}}Object(c.a)(nb,"ReactTaskPaneManager",null,[379]);var Ka=a(1026),Sb=a(192);class ab extends Qa{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we){Oc=void 0===Oc?null:Oc;we=void 0===we?null:we;super(Sa,Mb,oc,void 0===nd?null:nd,void 0,void 0,void 0===Zd?null:Zd);this.rIl=null;this.jNl=this.khi=this.oEh=this.GEh=
this.DEh=!1;this.lni=null;this.Wli=!!n.AFrameworkApplication.Ha&&!!n.AFrameworkApplication.Ha.Ib&&n.AFrameworkApplication.Ha.Ib.ykg;this.sgf=this.peb=null;this.Ohf=0;this.xDh=null;this.t7h=Oc;we&&(this.peb=we.OSm,this.sgf=we.Sbn,this.Ohf=we.Gqn);this.xjc=new nb}get isVisible(){return this.jNl}Ssd(Y){this.jNl=Y}A_i(Y){Y&&(this.rIl=Y,Y.IsSuccess&&(this.sNl=this.zZm(Y),Y.IsPartialResult&&this.Pzm(!0)),this.DEh=!0,this.GEh=!1,this.uyh())}Nzm(Y){this.isVisible&&Y!==this.oEh&&(this.oEh=Y,this.uyh())}Pzm(Y){this.khi=
Y;this.uyh()}vo(){this.GEh||Sb.a.Gz().then(Y=>{Kb.a.instance.KX(ab.Iud+":PaneOpen:Start");Y.showTaskPane(ab.Iud,this.x3a());this.KMj();return null});this.isVisible?Sb.a.Gz().then(Y=>{var Sa;Y.setSelectedTaskPane(ab.Iud);(null===(Sa=n.AFrameworkApplication.ha)||void 0===Sa?0:Sa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.PPTOAccessibilityPaneFocusFix"))&&this.hym();return null}):this.yCn()}uyh(){Sb.a.Gz().then(Y=>{Y.updateTaskPane(ab.Iud,this.x3a());return null})}x3a(){var Y=new Xa;
this.xjc.fkh(Y);Y=Object.assign(new Ka.a,{title:this.lHb.Z1e,hideHeader:!1,width:320,location:2,contentProps:Y,onOpen:()=>{this.hym();this.Ssd(!0);n.AFrameworkApplication.Ha.fg()},onClose:()=>{this.HZh();this.Ssd(!1);this.GEh=this.DEh=!1;this.uyh();n.AFrameworkApplication.Ha.fg()},isModernPane:!0});this.Wli&&(Y.enableResize=!0,Y.minResizeWidth=268,Y.maxResizeWidth=920);return Y}initialize(Y){const Sa=this.Fe.Uc(ab.Iud);Sa.parent=ma.AFrame.Wl;Sa.US=!0;this.egd=Y;this.VSm()}dispose(){this.KDm();this.Rgi&&
(this.Rgi.dispose(),this.Rgi=null);this.lhi&&(this.lhi.dispose(),this.lhi=null);super.dispose()}VSm(){this.xjc.m7c(this.onRecheckExecute());this.xjc.m7c(this.Hdn());this.xjc.m7c(this.Ekn());this.xjc.m7c(this.onInvokeNavigateExecute());this.xjc.m7c(this.Chn());this.xjc.m7c(this.ujn());this.xjc.m7c(this.Kjn());this.xjc.m7c(this.updateLastScanTime());this.xjc.m7c(this.showHelpPane())}onRecheckExecute(){return Y=>{Y.onRecheckExecute=()=>{this.KMj()}}}Hdn(){return Y=>{Y.accessibilityCheckResultCollection=
this.rIl}}Ekn(){return Y=>{Y.resultsReady=this.DEh}}onInvokeNavigateExecute(){return Y=>{Y.onInvokeNavigateExecute=Sa=>{this.Vvn(Sa)}}}Chn(){return Y=>{Y.helpLink=this.kan}}ujn(){return Y=>{Y.outOfSync=this.oEh}}Kjn(){return Y=>{Y.partialResult=this.khi}}updateLastScanTime(){return Y=>{Y.updateLastScanTime=Sa=>{this.lni=Sa}}}showHelpPane(){return Y=>{Y.showHelpPane=()=>{n.AFrameworkApplication.ha&&n.AFrameworkApplication.ha.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?
n.AFrameworkApplication.hIa||this.RRl()?this.xDh?this.xDh():this.peb.value&&this.sgf&&this.Ohf&&this.peb.value.Ra(this.Ohf,2,this.sgf):this.pAm():this.RRl()?this.xDh?this.xDh():this.peb.value&&this.sgf&&this.Ohf&&this.peb.value.Ra(this.Ohf,2,this.sgf):this.pAm()}}}RRl(){return!this.t7h||!this.t7h.value}pAm(){const Y=this.t7h.value;if(Y){var Sa={};Sa.query=ab.BQm+ab.Ibi;Sa=Object.assign(new Tb.a,{nonPersistedSettings:Sa});Y.kJa(ab.Hbi,Sa)}}KMj(){this.khi=this.oEh=this.DEh=!1;this.lni&&this.lni();this.uyh();
this.GEh=!0;this.egd.Uwk()}hym(){this.Fe.Ag(ab.Iud)}HZh(){this.gZj()&&this.Fe.Ag(this.Fe.Eba)}gZj(){return!!this.Fe.currentScope&&this.Fe.currentScope.name===ab.Iud}}ab.Iud="AccessibilityCheckerPane";ab.Ibi="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";ab.Hbi="FA000000012";ab.BQm="AssetID=";Object(c.a)(ab,"ReactAccessibilityCheckPane",Qa,[]);class ub{constructor(Y,Sa,Mb){this.OSm=Y;this.Sbn=Sa;this.Gqn=Mb}}Object(c.a)(ub,"HelpPaneProperties",null,[]);var Aa=a(103),tb=a(44);class kc extends ab{constructor(Y,
Sa,Mb,oc,Oc,nd,Cd,Zd){super(null,Sa,Mb,oc,void 0,null,void 0,void 0,new ub(Cd,kc.i1f(),tb.a.kJa));this.OIg=Y;this.dDn=Oc;this.MW=nd;this.uDg=Cd;this.Gy=Zd}get isVisible(){return!!this.OIg&&this.OIg.isVisible}Ssd(Y){this.OIg&&(this.OIg.isVisible=Y)}get kan(){return this.dDn}vo(){this.Ssd(!0);this.MW.M9(this.OIg,!0,ResourceStrings.l_AccessibilityCheckerTaskPaneToolTip,ma.AFrame.u5);super.vo();if(this.uDg){var Y=this.uDg.value;if(Y){Y.Eb(tb.a.VId,1);Y=!1;try{this.Gy.selectRibbonTabById("AccessibleAuthoring"),
Y=!0}catch(Sa){H.a.$(507843655,822,10,"PptReactAccCheckControl: can't select ribbon tab AccessibleAuthoring: {0}",Sa.toString())}Aa.a("AccessibleAuthoringTab",Y)}else H.a.$(507843656,822,10,"PptReactAccCheckControl: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else H.a.$(507843657,822,10,"PptReactAccCheckControl: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab")}hqd(){}onBeforeLoadContent(){}onAfterLoadContent(){this.egd&&this.egd.cAk()}onAfterFirstSaveContent(){}static i1f(){const Y=
{};Y.UC=ResourceStrings.L_Help;Y.assetId="FA000000012";Y.nonPersistedSettings={query:"AssetID=a16f6de0-2f39-4a2b-8bd8-5ad801426c7f"};return Y}}Object(c.a)(kc,"PptReactAccCheckControl",ab,[214]);class dc{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.Accessibility"}oc(Y){this.ga=Y;this.ga.register(U,"PowerPointWebEditor.Accessibility.PptAccCheckService").as("PowerPointWebEditor.Accessibility.IPptAccCheckService").as("Common.App.AccessibilityChecker.IAccessibilityCheckService").oa().pa(()=>
new U(this.ga.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.ga.resolve("PowerPointWebEditor.IPresentationResourcesManager")));this.ga.register(297,"Common.App.AccessibilityChecker.IAccessibilityCheckPane").oa().pa(()=>new kc(this.ga.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.ga.resolve("Common.IClickInputManager"),this.ga.resolve("Common.IFocusManager"),this.ga.resolve("Common.IF6Manager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").z2e,this.ga.resolve("PowerPointWebEditor.ITaskPaneManager"),
this.ga.he("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.IRibbonUser")));this.ga.register(86,"Common.App.AccessibilityChecker.IAccessibilityCheckManager").oa().pa(()=>new E(this.ga.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),this.ga.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("Common.ITaskManager"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.ga.resolve("PowerPointWebEditor.IPPTWorkspace"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.IPresentationReader")))}init(){}dispose(){this.ga.resolve("PowerPointWebEditor.IApplicationSettings").WAb&&(this.ga.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService").dispose(),this.ga.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane").dispose(),this.ga.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager").dispose())}static main(){b.a.instance.Jc(new dc)}}
Object(c.a)(dc,"PptAccessibilityPackage",null,[4,5]);var Db=a(178),sb=a(1722),Qb=a(360),$a=a(237),X=a(616),Ta=a(68),ca=a(149);class Ma{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we){this.la=Y;this.na=Sa;this.eDn=Mb;this.fDn=oc;this.evb=Oc;this.Gy=Cd;this.dpd=nd;this.Na=Zd;this.rc=we;this.dpd.HPl(Object(h.a)(this,this.Vsm,"refreshAccCheckButtonStatus"))}Kb(){this.na.WAb&&(this.la.ua(tb.a.q5g,Ta.a.application,Object(h.a)(this,this.h0m,"checkAccessibility"),4),this.la.ua(tb.a.Xrm,Ta.a.application,Object(h.a)(this,
this.c2n,"queryCheckAccessibility"),97))}Ae(){this.na.WAb&&this.Na.Uc(ca.a.$Gh).bindAction($a.a.hb(la.a.agd,$a.a.Ne|1),tb.a.q5g)}h0m(Y,Sa,Mb,oc,Oc){return 1===Mb?this.rc.zl()?this.fDn.Zvn?32:8:8:this.eDn.vo(Y,Sa,Mb,oc,Oc)}c2n(Y,Sa,Mb,oc,Oc){Oc[X.a.On]=this.evb.isVisible;return 32}dispose(){this.dpd.Wtm(Object(h.a)(this,this.Vsm,"refreshAccCheckButtonStatus"))}Vsm(){this.Gy.JC()}}Object(c.a)(Ma,"AccCheckActor",null,[502,40]);class Ba{constructor(){this.Gpg=this.ga=null}get name(){return"PowerPointWebEditor.LazyActors"}oc(Y){this.ga=
Y}init(){this.ga.resolve("PowerPointWebEditor.IAppBootCompletedListener").vra(()=>{this.jYe()})}jYe(){const Y=this.ga.resolve("Common.AFrameworkApplication").Xm.Pd,Sa=this.ga.resolve("Common.IActionManagerExtended");Y.WAb&&(this.Gpg=new Ma(Sa,Y,this.ga.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager"),this.ga.resolve("PowerPointWebEditor.Accessibility.IPptAccCheckService"),this.ga.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.ga.resolve("PowerPointWebEditor.IPresentationResourcesManager"),
this.ga.resolve("PowerPointWebEditor.IRibbonUser"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("PowerPointWebEditor.IPresentationReader")),this.Gpg.Kb(),this.Gpg.Ae());Y.IPh&&Db.a.get_instance().Ai(7,Object(h.a)(this,this.IPh,"loadInternalSlice"))}IPh(){const Y=sb.a.create("pptedit.internal",null,()=>a.e(31).then(a.bind(null,1916)));Qb.a.RK(Y)}dispose(){this.Gpg&&this.Gpg.dispose()}static main(){b.a.instance.Jc(new Ba)}}Object(c.a)(Ba,"PptLazyActorsPackage",null,[4,5]);var wa=
a(374),pa=a(304),ta=a(654),Wa=a(211),Pa=a(194),ib=a(77),Ib=a(67),hc=a(91),yc=a(89),ob=a(608);class Bc{constructor(Y,Sa,Mb,oc,Oc,nd,Cd){this.ef=1;this.U$=new Wa.a;this.Gx=new Wa.a;this.wt=!1;this.gfm="";this.Cfk=this.Efk=this.Ufa=this.qmc=this.vyb=!1;this.cWl=()=>{this.Ufa||this.Efk||(this.s_e||(this.s_e=new B.a(3,1,this.na.yjl,this.dismissImageDescriptionBarTask,90,"19")),this.Ufa=!0,this.Yb.Rb(this.s_e))};this.DXl=()=>{this.Ufa&&(this.Ufa=!1,this.Yb.Sh(this.s_e),this.s_e=void 0)};this.MSn=()=>{this.Efk=
!0;this.DXl();return!0};this.NSn=()=>{this.Efk=!1;this.cWl();return!0};this.jSn=Zd=>this.vlm(Zd);this.jQn=()=>{this.la.Eb(tb.a.mLd,2);this.BVe();return!0};this.vlm=()=>{this.la.Eb(tb.a.lkd,2);this.BVe();return!0};this.onSelectionChange=()=>{this.BVe()};this.dismissImageDescriptionBarTask=()=>{this.BVe()};if(!Y)throw Error.argumentNull("shapeNode");if(!Sa)throw Error.argumentNull("taskManager");if(!oc)throw Error.argumentNull("appSettings");if(!nd)throw Error.argumentNull("clickInputManager");if(!Cd)throw Error.argumentNull("pptSelectionManager");
this.ta=Y;this.Yb=Sa;this.mf=Mb;this.na=oc;this.la=Oc;this.kf=nd;this.rb=Cd}Z3m(){this.u8=Ib.a.kg();this.u8.className="ImageDescriptionBarNew";this.kf.Ub(Z.a.click,this.u8,this.jSn);pa.a.instance.Ub(Z.a.d0,this.u8,this.MSn);pa.a.instance.Ub(Z.a.e0,this.u8,this.NSn);this.ibk=Ib.a.yy();this.Efe=document.createElement(Ib.a.lAc);this.Efe.className="ImageDescriptionBarNewButton";this.Efe.appendChild(Object(ob.b)("M 768 1660 l -666 -666 l 73 -72 l 593 593 l 1105 -1105 l 73 72 z",20,20).va);var Y=Ib.a.yy();
Y.innerText=ResourceStrings.L_ImageDescriptionBarApprove;this.Efe.appendChild(Y);this.kf.Ub(Z.a.click,this.Efe,this.jQn);this.Vsg=document.createElement(Ib.a.lAc);this.Vsg.className="ImageDescriptionBarNewButton";this.Vsg.appendChild(Object(ob.b)("M 1879 169 q 39 39 59 88 q 20 50 20 102 q 0 51 -20 100 q -20 50 -59 89 l -1221 1215 l -556 183 l 195 -574 l 1203 -1203 q 38 -38 86 -57 q 48 -19 99 -19 h 4 q 53 0 103 19 q 49 19 87 57 m -1440 1206 q 85 26 147 87 q 61 62 87 147 l 995 -995 l -234 -234 m -1194 1428 l 345 -127 q -6 -43 -24 -80 q -19 -37 -48 -66 q -29 -29 -66 -48 q -37 -18 -80 -24 m 1440 -987 q 24 -24 37 -55 q 12 -30 12 -62 q 0 -33 -13 -63 q -13 -30 -35 -53 q -23 -22 -53 -36 q -31 -13 -66 -13 q -32 0 -63 12 q -31 12 -54 35 l -66 66 l 235 235 z",
20,20).va);Y=Ib.a.yy();Y.innerText=ResourceStrings.L_ImageDescriptionBarEdit;this.Vsg.appendChild(Y);this.kf.Ub(Z.a.click,this.Efe,this.vlm);this.u8.appendChild(this.ibk);this.u8.appendChild(this.Efe);this.u8.appendChild(this.Vsg)}mEm(Y){const Sa=Y.indexOf("\n");this.gfm=-1===Sa?Y:Y.substring(0,Sa);this.ibk.innerText=ResourceStrings.L_ImageDescriptionBarFormatString.replace("{0}",this.gfm);this.ezl(!0)}ezl(Y){this.fq=this.ta.ju;this.qmc=Y;this.RWh();this.u8.style.display=this.qmc?yc.a.H1:yc.a.Uf;
this.cWl()}BVe(){if(this.vyb){this.qmc=this.vyb=!1;this.rb.gib(this.onSelectionChange);this.DXl();this.OPg&&this.OPg.contains(this.u8)&&this.OPg.removeChild(this.u8);const Y=Date.now()-this.ZGn,Sa=new x.a;Sa.name="IsMisaligned";Sa.int64=this.Cfk?1:0;Aa.a("AltTextBar",!0,Y,[Sa])}}RWh(){if(this.vyb&&this.fq){var Y=this.fq.copy();this.U$.yl(Y);this.Gx.yl(Y);var Sa=ta.a.$O(ib.a.sH(Y.ka(0),Y.ka(1))),Mb=Y.Pj(new Pa.a(6)),oc=Y.Pj(new Pa.a(4));Y=Y.Pj(new Pa.a(2));Y=ib.a.pn(oc,Y)*this.ef;Mb=ib.a.pn(Mb,oc)*
this.ef;this.u8.style.position=yc.a.rJa;if(45<=Sa&&135>Sa||225<=Sa&&315>Sa){if(150>Y||70>Mb){this.qmc=!1;return}this.u8.style.marginLeft=(.5*(Mb-Y)).toString()+"px";this.u8.style.marginTop=(.5*(Mb+Y)-this.u8.offsetHeight).toString()+"px";this.u8.style.width=Y.toString()+"px"}else{if(150>Mb||70>Y){this.qmc=!1;return}this.u8.style.marginLeft="0";this.u8.style.marginTop=(Y-this.u8.offsetHeight).toString()+"px";this.u8.style.width=Mb.toString()+"px"}this.Cfk=0!=Sa%90}}Ceo(Y){this.ZGn=Date.now();this.u8&&
this.OPg&&(this.vyb=!0,this.Cfk=!1,this.OPg.appendChild(this.u8),this.rb.AO(this.onSelectionChange),this.mEm(Y))}emo(Y){this.ta===Y&&this.vyb&&this.mEm(this.ta.xKd)}get visible(){return this.qmc}set visible(Y){this.vyb&&(this.qmc!==Y&&(this.qmc=Y,this.u8.style.display=this.qmc?yc.a.H1:yc.a.Uf),this.qmc||this.BVe())}Yq(Y){this.OPg=Y.va;this.Z3m()}setPosition(){}qj(Y){this.ef=Y;this.vyb&&this.RWh()}Ov(Y){this.U$=Y;this.vyb&&this.RWh()}SA(Y){this.Gx=Y;this.vyb&&this.RWh()}setZIndex(Y){this.vyb&&(this.u8.style.zIndex=
Y.toString())}NT(Y){if(this.vyb&&!this.wt)switch(Y){case 1:this.mf&&(Y=this.mf.Eq("formatpainterobject.cur"),this.u8.style.cursor=Ib.a.BZ(Y,hc.a.Qbd));break;case 0:this.u8.style.cursor=hc.a.Qbd}}pR(){return null}tH(){}ER(Y,Sa){this.vyb&&(this.ezl(!Y&&Sa||!Sa),!Y&&this.s_e&&this.Yb.Yla(this.s_e,this.na.yjl))}zu(){return null}k1(){return!1}vE(Y){this.wt=Y}setSelection(){}DM(){return[]}draw(){this.vyb&&this.ezl(!0)}dispose(){this.BVe();this.u8&&(this.Vsg=this.Efe=this.ibk=this.u8=void 0)}}Object(c.a)(Bc,
"ImageDescriptionBarViewNew",null,[966,558,267,40]);var rb=a(1263),Eb=a(64),jc=a(51);class ea{constructor(Y,Sa,Mb,oc){this.shapeNode=Y;this.sVf=Sa;this.Yxn=Mb;this.imageDescription=oc}}Object(c.a)(ea,"ImageDescriptionCache",null,[]);var ua=a(234);class Da{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf){this.jwb=new rb.a;this.hwn=Vf=>{[Vf]=Object(ob.c)(Vf);return Vf};this.zb=Y;this.Jm=Sa;this.pr=Cd;this.j_e=Mb;this.rb=oc;this.K5=nd;this.mRa=Oc;this.QA=Zd;this.Tb=we;this.zc=Qe;this.QRh=kf}initialize(){this.QA.Rm(Object(h.a)(this,
this.Qh,"onPropertyChanged"));this.pr.MFh(Object(h.a)(this,this.knc,"onShapeImageFirstDraw"));this.pr.XPl(Object(h.a)(this,this.tmm,"onLocalImageViewDismissed"));this.j_e.UPl(Object(h.a)(this,this.Wlm,"onImageDescriptionReady"))}dispose(){this.QA.rr(Object(h.a)(this,this.Qh,"onPropertyChanged"));this.pr.z4e(Object(h.a)(this,this.knc,"onShapeImageFirstDraw"));this.pr.mum(Object(h.a)(this,this.tmm,"onLocalImageViewDismissed"));this.j_e.ium(Object(h.a)(this,this.Wlm,"onImageDescriptionReady"))}Qh(Y,
Sa){if((Y=Sa.node)&&Y.Pg)if(Sa=Sa.property,Sa===jc.a.alt){Sa=Object(G.a)(112,Y.yc(this.zb.Ua));const Mb=Y.get_alt();Mb&&this.hwn(Mb)&&(Sa&&Sa.oM&&Y.get_alt()&&(Sa=this.QRh.fca(Y))&&Sa.emo(Y),this.mRa.wlo(Y),Y.get_alt()&&this.H_h(Y,Y.get_alt()))}else Sa===jc.a.GG?Y.GG&&(Sa=Object(G.a)(112,Y.yc(this.zb.Ua)))&&Sa.oM&&(Y=this.QRh.fca(Y))&&(Y.visible=!1):Sa===jc.a.$g&&Y.$g!==ua.a.nU?(Sa=Object(G.a)(112,Y.yc(this.zb.Ua)))&&Sa.oM&&!Y.yna&&this.jwb.ka(Y.id)&&this.jwb.ka(Y.id).sVf&&(this.QYf(Y,Sa),this.jwb.remove(Y.id)):
Sa===jc.a.isDecorative&&(Y=this.QRh.fca(Y))&&(Y.visible=!1)}Wlm(Y,Sa){if(Y=Sa.o2d){var Mb=Sa.confidence,oc=Sa.imageDescription,Oc=Sa.N9l;Sa=Sa.sVf;var nd=this.K5.Oia(Y),Cd=nd?Object(G.a)(112,nd.yc(this.zb.Ua)):null;Sa?Cd&&Cd.oM&&!nd.isLocal&&!nd.GG?this.QYf(nd,Cd):this.jwb.add(Y,new ea(nd,!0,!0,oc)):!oc||!Oc&&60>Mb?H.a.$(509092041,815,15,"isGenerateSuggestion: {0}, confidence: {1}",Oc,Mb):(oc=this.Y1m(Mb,oc),Oc?this.Y8k(nd,oc,!1):(H.a.$(509092040,815,50,"Image description ready for show and save"),
Cd&&Cd.oM?(H.a.$(509092039,815,50,"Show image description immediately, GraphNodeId: {0}, TimeMs: {1}",Y.toString(),(new Date).getTime()),this.H_h(nd,oc),nd.isLocal?this.jwb.add(Y,new ea(nd,!1,!1,oc)):(H.a.$(509092038,815,50,"Save image description immediately"),this.Y8k(nd,oc,!0))):this.jwb.add(Y,new ea(nd,!1,!0,oc))))}else H.a.$(509092042,815,15,"Graph node id is null")}knc(Y,Sa){Y=Sa.o2d;H.a.$(509092037,815,50,"OnShapeImageFirstDraw, GraphNodeId: {0}, TimeMs: {1}",Y?Y.toString():"",(new Date).getTime());
this.jwb.Sb(Y)?this.Jrm(Y):(Y=this.K5.Oia(Y))&&Y.get_alt()&&this.H_h(Y,Y.get_alt())}Y1m(Y,Sa){Sa+=String.fromCharCode(10,10);return Sa=80<=Y?Sa+ResourceStrings.L_ImageDescriptionWithVeryHighConfidence:60<=Y?Sa+ResourceStrings.L_ImageDescriptionWithHighConfidence:40<=Y?Sa+ResourceStrings.L_ImageDescriptionWithMediumConfidence:20<=Y?Sa+ResourceStrings.L_ImageDescriptionWithLowConfidence:Sa+ResourceStrings.L_ImageDescriptionWithVeryLowConfidence}tmm(Y,Sa){(Y=Sa.TAm)&&this.jwb.Sb(Y.id)&&this.Jrm(Y.id)}Jrm(Y){const Sa=
this.jwb.ka(Y).shapeNode;if(Sa){var Mb=this.jwb.ka(Y).sVf,oc=this.jwb.ka(Y).Yxn,Oc=this.jwb.ka(Y).imageDescription;Mb?(Mb=Object(G.a)(112,Sa.yc(this.zb.Ua)))&&this.QYf(Sa,Mb):(oc&&this.H_h(Sa,Oc),Sa.isLocal?H.a.$(509092035,815,15,"Try to save alt text for local picture"):this.Y8k(Sa,Oc,!0));this.jwb.remove(Y)}else H.a.$(509092036,815,15,"ProcessImageDescriptionInCache, shape node has been changed")}QYf(Y,Sa){this.Jm.generateImageDescription(Y.id,Sa.G6e,Y.get_isSVGBlipFilled(),!1)}Y8k(Y,Sa,Mb){const oc=
Date.now();if(!Mb||!Y.get_alt()){var Oc=this.Tb.xe(Mb?7:15);Oc.tc(Y);Y.Cib=Mb;Y.set_alt(Eb.a.gsb(Sa));Oc.dispose();Mb&&this.Jm.forceOutbound();Y=Date.now()-oc;Aa.a("UpdateAltText",!0,Y)}}H_h(Y,Sa){if(Y.Pg){this.zc.Hd(Y)&&H.a.$(509092033,815,50,"Graph node or parents blocked");var Mb=this.rb.zd();Mb&&this.rb.G3(Y)?(H.a.$(509092003,815,50,"ImageDescriptionManager::ShowImageDescriptionBar, GraphNodeId: {0}, TimeMs: {1}",Y.id.toString(),(new Date).getTime()),(Y=this.QRh.fca(Y))&&Y.Ceo(Sa)):H.a.$(509092032,
815,50,"Is selected shapes empty: {0}",!Mb)}else H.a.$(509092034,815,50,"ShapeNode.IsPicture: {0}",Y.Pg)}}Object(c.a)(Da,"ImageDescriptionManager",null,[40]);var Cb=a(124),Nb=a(356),fc=a(66),fb=a(42);class Ub{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg,yh){this.pc=!1;this.nek=new rb.a(0);this.Qh=(qg,Ug)=>{qg=Ug.node;this.V5&&this.V5.includes(qg)&&[jc.a.alt,jc.a.Jha,jc.a.isDecorative].includes(Ug.property)&&this.DNh()};this.fen=()=>{if(!this.V5||0===this.V5.length)return"";let qg="",Ug=!0;
for(const Zh of this.V5){const Ii=Zh.xKd;if(!Ug&&Ii!==qg)return"";qg=Ii;Ug=!1}return qg};this.Zfn=()=>{if(!this.V5||0===this.V5.length)return[!1,!1];let qg=!0,Ug=!0;for(const Zh of this.V5)Zh.isDecorative?Ug=!1:qg=!1;return[qg,!(qg||Ug)]};this.DNh=()=>{if(this.V5&&0!==this.V5.length){this.mfm=this.$7a.checked;[this.Fod,this.TYa.indeterminate]=this.Zfn();this.TYa.checked=this.Fod;this.TYa.disabled=!1;this.vme.style.display=yc.a.zn;this.vek=this.fen();this.m8.value=this.Fod?ResourceStrings.L_ImageDescriptionPaneAltTextBoxDecorative:
this.vek;this.m8.disabled=this.Fod;this.hgk=this.Kyn();var qg=!1;if(this.hgk){let Ug;[qg,Ug]=Object(ob.c)(this.m8.value);qg=qg&&0<Ug}this.kmc.style.display=qg||this.$7a.checked?yc.a.zn:yc.a.Uf;this.dwb.style.display=!this.hgk||qg||this.$7a.checked?yc.a.Uf:yc.a.zn;this.dwb.disabled=this.Fod;this.vmc.style.display=yc.a.Uf;""!==this.ewb.innerText&&(this.ewb.innerText="");this.yHf()}else this.m8.value="",this.m8.disabled=!0,this.dwb.style.display=yc.a.Uf,this.vmc.style.display=yc.a.Uf,""!==this.ewb.innerText&&
(this.ewb.innerText=""),this.yHf(),this.kmc.style.display=yc.a.Uf,this.vme.style.display=yc.a.Uf};this.Kyn=()=>this.V5?1===this.V5.length&&this.V5[0].Pg&&!this.V5[0].get_isSVGBlipFilled():!1;this.NBl=()=>{this.epi(this.Wb);this.MW&&this.MW.M9(this,this.pc,ResourceStrings.L_ShapeAltTextNew,fc.a.Z5a)};this.sKi=()=>{0!==this.YTh&&(window.clearTimeout(this.YTh),this.YTh=0)};this.yHf=()=>{0!==this.uRh&&(window.clearTimeout(this.uRh),this.uRh=0)};this.sRl=()=>{var qg=Date.now();const Ug=this.kmc.style.display===
yc.a.zn;Ug&&(this.$7a.checked=!1,this.kmc.style.display=yc.a.Uf,this.dwb.style.display=yc.a.zn,this.vmc.style.display=yc.a.Uf,""!==this.ewb.innerText&&(this.ewb.innerText=""),this.yHf(),this.Dtm());this.sKi();this.YTh=window.setTimeout(()=>{this.tjh()},500);if(!this.Pem){qg=Date.now()-qg;const Zh=new x.a;Zh.name="ApproveImplicitly";Zh.int64=Ug?1:0;Aa.d(tb.a.yDm,!0,"AltTextPane",1,12,qg,[Zh]);this.Pem=!0}};this.qko=()=>{this.IZh();Cb.FocusManager.vz(this.qw)||H.a.$(509092104,815,50,"Fail to set focus on close button")};
this.gym=()=>{this.IZh();window.setTimeout(()=>{if(Cb.FocusManager.vz(this.m8))return this.m8.selectionStart=0,this.m8.selectionEnd=0,!0;H.a.$(509092103,815,50,"Fail to set focus on alt text box");return!1},0)};this.IZh=()=>{this.Na&&this.Na.lJ(fc.a.Z5a)};this.LUe=()=>{this.ifa();return!0};this.Dtm=()=>{const [qg,Ug]=Object(ob.c)(this.m8.value);if(qg){const Zh=this.m8.selectionStart,Ii=this.m8.selectionEnd;this.m8.value=this.m8.value.substring(0,Ug).trimEnd();this.m8.setSelectionRange(Zh,Ii)}};this.$xi=
(qg,Ug)=>{var Zh=Date.now();const Ii=!this.mfm;(this.$7a.checked=Ii)?(this.nQh=this.m8.value,this.Dtm()):this.m8.value=this.nQh;this.tjh();Ug&&(Ug=Date.now()-Zh,Zh=new x.a,Zh.name="CustomData1",Zh.int64=Ii?1:0,Aa.d(tb.a.mLd,!0,"AltTextPane",qg,12,Ug,[Zh]))};this.NRl=qg=>{qg.Pb.preventDefault();qg.Pb.stopPropagation();this.$xi(2,!0);window.setTimeout(()=>{this.$7a.checked=this.mfm},0);return!0};this.ORl=qg=>qg.Pb.keyCode===la.a.nv||qg.Pb.keyCode===la.a.P1?(qg.Pb.preventDefault(),qg.Pb.stopPropagation(),
this.$xi(1,!0),!0):!1;this.Yim=qg=>{var Ug=Date.now();const Zh=!this.Fod;this.TYa.indeterminate=!1;this.TYa.checked=Zh;this.dwb.disabled=Zh;this.kmc.style.display=yc.a.Uf;(this.m8.disabled=Zh)?(this.nQh=this.m8.value,this.m8.value=ResourceStrings.L_ImageDescriptionPaneAltTextBoxDecorative):this.m8.value=this.nQh;this.tjh();Ug=Date.now()-Ug;const Ii=new x.a;Ii.name="CustomData1";Ii.int64=Zh?1:0;Aa.d(tb.a.Vqe,!0,"AltTextPane",qg,12,Ug,[Ii])};this.Wim=qg=>{console.log("[markAsDecorativeClickHandler]",
this.TYa.checked);qg.Pb.preventDefault();qg.Pb.stopPropagation();this.Yim(2);window.setTimeout(()=>{this.TYa.checked=this.Fod},0);return!0};this.Xim=qg=>{console.log("[markAsDecorativeKeyDownHandler]",this.TYa.checked);return qg.Pb.keyCode===la.a.nv||qg.Pb.keyCode===la.a.P1?(qg.Pb.preventDefault(),qg.Pb.stopPropagation(),this.Yim(1),!0):!1};this.ifa=()=>{if(this.pc){var qg=Date.now();this.xJi();H.a.$(509092102,815,50,"ImageDescriptionPaneNew.closePane - Image Description pane close button clicked.");
qg=Date.now()-qg;const Ug=new x.a;Ug.name="CustomData1";Ug.int64=0;Aa.d(tb.a.vid,!0,"AltTextPane",0,12,qg,[Ug])}};this.p1l=()=>{this.QYf();return!0};this.QYf=()=>{var qg=Date.now();const Ug=this.V5[0]?this.V5[0].yc(0):void 0;this.Jm&&Ug?(this.dwb.style.display=yc.a.Uf,this.vmc.style.display=yc.a.H1,this.ewb.innerText=ResourceStrings.L_ImageDescriptionPaneInProgress,this.yHf(),this.uRh=window.setTimeout(()=>{this.vmc.style.display=yc.a.Uf;""!==this.ewb.innerText&&(this.ewb.innerText="");Aa.a("GeneratingAltTextMessageTimeout")},
15E3),this.qko(),this.nek.add(this.V5[0].id.toString(),this.V5[0].$g),this.Jm.generateImageDescription(this.V5[0].id,Ug.G6e,this.V5[0].get_isSVGBlipFilled(),!0),qg=Date.now()-qg,Aa.d(tb.a.m1l,!0,"AltTextPane",0,12,qg)):H.a.$(509092101,815,15,"ImageDescriptionPaneNew.generateDescriptionForMe - Is shape node null or undefined {0}",!this.V5[0])};this.vlo=qg=>{qg=qg.Ie();this.nQh="";this.tjh();this.V5=qg;this.Pem=this.$7a.checked=!1;this.DNh()};this.onSelectionChange=qg=>{this.vlo(qg);this.Hj&&this.Hj.ns(fc.a.Z5a)};
this.epi=qg=>{n.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(qg,"ImageDescriptionPaneRTL"):Sys.UI.DomElement.addCssClass(qg,"ImageDescriptionPaneLTR")};this.tjh=()=>{this.sKi();if(this.V5&&0!==this.V5.length){var qg=this.TYa.checked,Ug=qg?"":this.m8.value;if(Ug!==this.vek||qg!==this.Fod){var Zh=this.Tb.xe(15);if(Zh){Zh.tc(this.rb.ut());if(qg)for(const Ii of this.V5)Ii.Cib=!1,Ii.isDecorative=!0;else for(const Ii of this.V5)Ii.Cib=!1,Ii.set_alt(Ug),Ii.set_altTitle("");Zh.dispose()}this.Fod=
qg;this.vek=Ug;this.Gy&&this.Gy.JC()}}};this.$vm=qg=>qg.Pb.keyCode===la.a.R0||qg.Pb.keyCode===la.a.RZa?(qg.Pb.preventDefault(),qg.Pb.stopPropagation(),this.Na.ee(),!0):!1;this.qjl=qg=>{const Ug=this.pc;qg?Ug?(this.NBl(),this.gym()):this.Mun():Ug&&this.xJi();qg!==Ug&&(this.Gy&&this.Gy.JC(),this.Q$&&this.Q$.JC());H.a.$(509092099,815,50,"ImageDescrptionPaneNew.showHideAltTextPaneInternal {0} to {1}",Ug,qg)};this.Mun=()=>{this.Na&&this.Na.Gm(fc.a.Z5a,!0);this.V5=this.rb.Ie();this.DNh();this.pc=!0;this.Wb.appendChild(this.CJb);
this.Wb.style.display=yc.a.zn;this.NBl();this.rb.AO(this.onSelectionChange);H.a.$(509092098,815,50,"ImageDescriptionPaneNew.initializeAndShowAltTextPane");if(this.uDg){try{var qg=this.uDg.value}catch(Ug){H.a.$(509092096,822,10,"ImageDescriptionPaneNew: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab: {0}",Ug.toString());return}if(qg){qg.Eb(tb.a.VId,1);qg=!1;try{this.Gy.selectRibbonTabById("AccessibleAuthoring"),qg=!0}catch(Ug){H.a.$(509092066,822,10,"ImageDescriptionPaneNew: can't select ribbon tab AccessibleAuthoring: {0}",
Ug.toString())}Aa.a("AccessibleAuthoringTab",qg);this.gym()}else H.a.$(509092067,822,10,"ImageDescriptionPaneNew: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else H.a.$(509092097,822,10,"ImageDescriptionPaneNew: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab"),fb.a("UpdateAltTextState")&&this.TDm()};this.xJi=()=>{this.pc&&(this.Na&&this.Na.Gm(fc.a.Z5a,!1),this.rb.gib(this.onSelectionChange),this.tjh(),this.pc=!1,this.Wb.removeChild(this.CJb),
this.Wb.style.display=yc.a.Uf,this.NBl(),H.a.$(509092100,815,50,"ImageDescriptionPaneNew.cleanUpAndHideAltTextPane"),fb.a("UpdateAltTextState")&&this.TDm())};this.dispose=()=>{this.xJi();this.QF&&this.QF.hc(Z.a.oi,this.Wb,this.$vm);this.kf.hc(Z.a.click,this.qw,this.LUe);this.Hje.removeHandler(this.m8,Z.a.input,this.sRl);this.kf.hc(Z.a.click,this.dwb,this.p1l);this.kf.hc(Z.a.click,this.Rnd,this.NRl);this.QF&&this.QF.hc(Z.a.oi,this.$7a,this.ORl);this.kf.hc(Z.a.click,this.Uod,this.Wim);this.QF&&this.QF.hc(Z.a.oi,
this.TYa,this.Xim);this.QA&&this.QA.rr(this.Qh);this.ODg=this.phk=this.TYa=this.Uod=this.vme=this.pqg=this.i$j=this.$7a=this.Rnd=this.kmc=this.vmc=this.ewb=this.dwb=this.m8=this.kek=this.RRh=this.SRh=this.qw=this.Gxg=this.Fxg=this.CJb=this.Wb=void 0;this.sKi();this.yHf();H.a.$(509092065,815,50,"ImageDescriptionPaneNew.dispose")};this.layout=(qg,Ug)=>{const Zh=Ug?qg.$Q(this.width):qg.aR(this.width);this.pc&&(Ug?(Sys.UI.DomElement.addCssClass(this.Wb,"ImageDescriptionPaneRTL"),Zh.$Q(1)):(Sys.UI.DomElement.addCssClass(this.Wb,
"ImageDescriptionPaneLTR"),Zh.aR(1)));Ib.a.kga(this.Wb,Zh,!1);return qg};this.wlo=qg=>{this.hgk&&qg===this.V5[0]&&this.pc&&(this.nek.Sb(qg.id.toString())&&this.V5[0].$g!==this.nek.ka(qg.id.toString())&&H.a.$(509092064,815,50,"ImageDescriptionPaneNew.updateAltTextbox - Image version have been changed after generate description"),this.DNh())};this.Jzm=()=>{this.qjl(!this.pc)};this.MRl=()=>{this.qjl(!0);this.$7a.checked||this.$xi(0,!1)};this.rJh=()=>{this.qjl(!0)};if(!Sa)throw Error.argumentNull("frameContext");
if(!oc)throw Error.argumentNull("clickInputManager");if(!nd)throw Error.argumentNull("selectionManager");if(!Cd)throw Error.argumentNull("focusManagerHelper");if(!Zd)throw Error.argumentNull("inputHandlerManager");if(!we)throw Error.argumentNull("transactionFactory");this.Hj=Y;this.Gb=Sa;this.Na=Qe;this.Jm=Mb;this.kf=oc;this.QF=Oc;this.rb=nd;this.fT=Cd;this.Hje=Zd;this.Tb=we;this.MW=kf;this.uDg=Vf;this.Gy=eg;this.Q$=zg;this.QA=yh;this.Wb=Ib.a.kg();this.Wb.className="ImageDescriptionPaneNew";this.Wb.id=
"ImageDescriptionPaneNew";this.Wb.style.position=yc.a.rJa;this.Wb.setAttribute(Fa.a.ii,Fa.a.EHb);this.Wb.setAttribute(Fa.a.nba,"ImageDescriptionPaneLabel");this.QF&&this.QF.Ub(Z.a.oi,this.Wb,this.$vm);this.CJb=Ib.a.kg();this.CJb.className="ImageDescriptionPaneLayoutRootNew";this.Fxg=Ib.a.kg();this.Fxg.className="ImageDescriptionPaneHeader";this.CJb.appendChild(this.Fxg);this.Gxg=Ib.a.kg();this.Gxg.id="ImageDescriptionPaneLabel";this.Gxg.className="ImageDescriptionPaneTitle";this.Gxg.innerText=ResourceStrings.L_ShapeAltTextNew;
this.Fxg.appendChild(this.Gxg);this.qw=document.createElement(Ib.a.lAc);this.qw.type="button";this.qw.setAttribute(Fa.a.IA,CommonUIStrings.l_DialogClose);this.qw.appendChild(Object(ob.b)(ob.a,20,20).va);this.qw.className="ImageDescriptionPaneCloseButtonNew";fb.a("SvgCloseButton")&&(this.qw.className+=" SvgCloseButton");this.Fxg.appendChild(this.qw);this.kf.Ub(Z.a.click,this.qw,this.LUe);this.SRh=Ib.a.kg();this.SRh.innerText=ResourceStrings.L_ImageDescriptionPaneLabelRefresh;this.SRh.className="ImageDescriptionLabelNew";
this.CJb.appendChild(this.SRh);this.RRh=Ib.a.kg();this.RRh.innerText=ResourceStrings.L_ImageDescriptionPaneHint;this.RRh.className="ImageDescriptionHintNew";this.CJb.appendChild(this.RRh);this.kek=Ib.a.kg();this.m8=document.createElement(Ib.a.pCm);this.m8.className="AltTextTextAreaNew";this.m8.setAttribute(Fa.a.IA,ResourceStrings.L_ShapeAltTextNew);this.kek.appendChild(this.m8);this.CJb.appendChild(this.kek);this.Hje.addHandler(this.m8,Z.a.input,this.sRl);Y=Ib.a.yy();Y.className="GenerateDescriptionButtonText";
Y.innerText=ResourceStrings.L_ImageDescriptionPaneButtonTooltipNew;this.dwb=document.createElement(Ib.a.lAc);this.dwb.type="button";this.dwb.className="ImageDescriptionPaneGenerateButtonNew";this.dwb.appendChild(Y);this.CJb.appendChild(this.dwb);this.kf.Ub(Z.a.click,this.dwb,this.p1l);Y=Object(ob.b)("M1039.84,0.126321c261.41,4.108,517.2,108.271,709.24,300.861c292.63,293.471,379.52,734.393,220.11,1116.953c-154.43,370.6,-510.5,615.63,-909.38,629.51l-34.61,0.55l-16.1,-0.67c-72.623,-7.38,-129.295,-68.71,-129.295,-143.29c0,-74.57,56.672,-135.9,129.295,-143.28l12.8,-0.64c0,-0.07,0,-0.13,0,-0.19c297.81,0.84,566.77,-177.91,681.33,-452.82c114.55,-274.92,52.11,-591.774,-158.18,-802.668c-210.29,-210.893,-526.96,-274.235,-802.182,-160.458c-275.227,113.778,-454.739,382.239,-454.739,680.066l-288.129,0c0,-414.442,249.801,-788.021,632.795,-946.349c131.654,-54.426,270.122,-79.727,407.045,-77.575z",
16,16).va;this.ewb=Ib.a.yy();this.ewb.setAttribute(Fa.a.ii,Fa.a.FGh);this.ewb.setAttribute(Fa.a.TAf,Fa.a.EGh);this.vmc=Ib.a.kg();this.vmc.className="ImageDescriptionPaneGeneratingMessage";this.vmc.appendChild(Y);this.vmc.appendChild(this.ewb);this.CJb.appendChild(this.vmc);this.kmc=Ib.a.kg();this.kmc.className="ImageDescriptionCheckboxContainer";this.Rnd=document.createElement(Ib.a.B0j);this.Rnd.setAttribute("for","ImageDescriptionCheckboxApprove");this.Rnd.innerText=ResourceStrings.L_ApproveAltText;
this.kmc.appendChild(this.Rnd);this.$7a=Ib.a.IQd();this.$7a.setAttribute("type","checkbox");this.$7a.setAttribute(Fa.a.h7,"ImageDescriptionTipApprove");this.$7a.id="ImageDescriptionCheckboxApprove";this.Rnd.appendChild(this.$7a);this.i$j=Ib.a.yy();this.i$j.className="checkmark";this.Rnd.appendChild(this.i$j);this.pqg=Ib.a.kg();this.pqg.className="ImageDescriptionInlineTip";this.pqg.innerText=ResourceStrings.L_ApproveAltTextTip;this.pqg.id="ImageDescriptionTipApprove";this.kmc.appendChild(this.pqg);
this.CJb.appendChild(this.kmc);this.kf.Ub(Z.a.click,this.Rnd,this.NRl);this.QF&&this.QF.Ub(Z.a.oi,this.$7a,this.ORl);this.vme=Ib.a.kg();this.vme.className="ImageDescriptionCheckboxContainer";this.Uod=document.createElement(Ib.a.B0j);this.Uod.setAttribute("for","ImageDescriptionCheckboxDecorative");this.Uod.innerText=ResourceStrings.L_MarkAsDecorative;this.vme.appendChild(this.Uod);this.TYa=Ib.a.IQd();this.TYa.setAttribute("type","checkbox");this.TYa.setAttribute(Fa.a.h7,"ImageDescriptionTipDecorative");
this.TYa.id="ImageDescriptionCheckboxDecorative";this.Uod.appendChild(this.TYa);this.phk=Ib.a.yy();this.phk.className="checkmark";this.Uod.appendChild(this.phk);this.ODg=Ib.a.kg();this.ODg.className="ImageDescriptionInlineTip";this.ODg.innerText=ResourceStrings.L_MarkAsDecorativeTip;this.ODg.id="ImageDescriptionTipDecorative";this.vme.appendChild(this.ODg);this.CJb.appendChild(this.vme);this.kf.Ub(Z.a.click,this.Uod,this.Wim);this.QF&&this.QF.Ub(Z.a.oi,this.TYa,this.Xim);this.fT.nYa(fc.a.Z5a,fc.a.Wl,
this.Wb,()=>{},()=>{},!0);this.QA&&this.QA.Rm(this.Qh);this.uRh=this.YTh=0}TDm(){this.Gb.CE({AlternativeText:"ToggleButtonModel"})}get width(){return this.pc?264+Nb.a.sGa:0}get va(){return this.Wb}get order(){return 10}get isVisible(){return this.pc}}Object(c.a)(Ub,"ImageDescriptionPaneNew",null,[782,488,40]);var Ec=a(575);class Lc{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.ImageDescription"}oc(Y){this.ga=Y;this.ga.register(525,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>").oa().pa(()=>
new Ec.a(Sa=>{let Mb=null;const oc=Object(G.a)(112,Sa.yc(Y.resolve("Box4.IPageView").Ua));oc&&!oc.isDisposed&&(Mb=new Bc(Sa,this.ga.resolve("Common.ITaskManager"),this.ga.resolve("PowerPoint.IPathManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("Common.IClickInputManager"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager")),Mb.Yq(oc.Cua),oc.uHb(Mb,4));return Mb}));this.ga.register(782,"PowerPointWebEditor.IImageDescriptionPane").oa().pa(()=>
new Ub(this.ga.resolve("Common.IF6Manager"),this.ga.resolve("Box4.IAppFrame"),this.ga.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.ga.resolve("Common.IClickInputManager"),this.ga.resolve("Common.IKeyInputManager"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.ga.resolve("PowerPointWebEditor.IInputHandlerManager"),this.ga.resolve("Common.Transaction.ITransactionFactory"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),
this.ga.resolve("PowerPointWebEditor.ITaskPaneManager"),this.ga.he("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.IRibbonUser"),this.ga.resolve("PowerPointWebEditor.IContextMenuUser"),this.ga.resolve("Box4.Graph.IGraphInstance").Xd(10)));this.ga.register(Da,"PowerPointWebEditor.ImageDescriptionManager").oa().pa(()=>new Da(this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"),this.ga.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.ga.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),
this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.IImageDescriptionPane"),this.ga.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.ga.resolve("Box4.Graph.IGraphInstance").Xd(10),this.ga.resolve("Common.Transaction.ITransactionFactory"),this.ga.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.ga.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>")))}init(){this.ga.resolve("PowerPointWebEditor.ImageDescriptionManager").initialize()}dispose(){this.ga.resolve("PowerPointWebEditor.ImageDescriptionManager").dispose()}static main(){b.a.instance.Jc(wa.a(new Lc,
0))}}Object(c.a)(Lc,"PPTWebEditorImageDescriptionPackage",null,[4,5]);var vb=a(50);const ec=()=>vb.a.instance.Db("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo");var lb=a(119),Zb=a(30);class qc extends Zb.a{constructor(){super()}static instance(){return qc.Qa||(qc.Qa=new qc)}}qc.FUn="OnTextSelectionHighlightChangeEvent";qc.Qa=null;Object(c.a)(qc,"TextSelectionHighlightChangeEvent",Zb.a,[]);class pc extends lb.a{constructor(Y,Sa){super(!1,!1,!0);this.Tec=(Mb,oc)=>{1===Mb&&(this.Nud.QFj=
oc.tooltipPersistenceEnabled,Mb=oc.textSelectionChangeEnabled,this.Nud.zsh!==Mb&&this.bSm.raiseEvent(qc.FUn),this.Nud.zsh=Mb)};this.Nud=Y;this.bSm=Sa}start(){const Y={["tooltipPersistenceEnabled"]:this.Nud.QFj};Y.textSelectionChangeEnabled=this.Nud.zsh;this.qp("",this.Tec,{["id"]:"AccessibilitySettingsDialog",["bodyControls"]:Y});e.ULS.sendTraceTag(507905246,324,50,"User opened the Accessibility Settings Dialog")}}Object(c.a)(pc,"AccessibilitySettingsDialog",lb.a,[]);class ac{constructor(Y,Sa){this.Sdo=
()=>{(new pc(this.Nud,qc.instance())).start();return 32};this.Aa=Y;this.Nud=Sa}Kb(){this.Aa.Ba(r.a.wzm,u.a.frame,this.Sdo)}}Object(c.a)(ac,"AccessibilitySettingsDialogActor",null,[831]);var gb=a(1187);const Jb=Y=>{const Sa=new gb.a;n.AFrameworkApplication.$d.ik(Cc(Y),1,null,null,!0,2,Mb=>{200===Mb.data.Je?Sa.lj("true"===Mb.data.responseData.toLowerCase()):Sa.lj(!1)},()=>{Sa.lj(!1)},null,void 0,void 0,void 0,void 0,"7");return Sa.task},uc=(Y,Sa)=>{n.AFrameworkApplication.$d.ik(Cc(Y),2,Sa.toString().toLowerCase(),
null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8")},Cc=Y=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",n.AFrameworkApplication.ha.appSettings.RoamingServiceHandlerWebServiceBase||"",Y,n.AFrameworkApplication.Fh);var Gc=a(75);class dd{constructor(){this.XSe=this.fSe=null}get QFj(){return!!this.fSe}set QFj(Y){Y!==this.fSe&&(this.fSe=Y,Gc.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Y),this.XOh()&&uc("saveHoverableRibbonTooltipIsEnabled",Y))}get zsh(){return!!this.XSe}set zsh(Y){Y!==
this.XSe&&(this.XSe=Y,this.XOh()&&uc("saveTextSelectionHighlightChangeIsEnabled",Y))}cBn(){const Y=new gb.a;if(this.fSe)Y.lj(this.fSe);else if(this.XOh()){const Sa=Jb("getHoverableRibbonTooltipIsEnabled");Sa.continueWith(()=>{this.fSe=Sa.result;Gc.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Sa.result);Y.lj(Sa.result)},8)}else Y.lj(!1)}kBn(){const Y=new gb.a;if(this.XSe)Y.lj(this.XSe);else if(this.XOh()){const Sa=Jb("getTextSelectionHighlightChangeIsEnabled");
Sa.continueWith(()=>{this.XSe=Sa.result;Y.lj(Sa.result)},8)}else Y.lj(!1)}XOh(){const Y=n.AFrameworkApplication.ha.getBooleanAppSetting("IsRoamingServiceEnabled"),Sa=n.AFrameworkApplication.ha.getBooleanAppSetting("IsAnonymousUser");return Y&&!Sa}}Object(c.a)(dd,"AccessibilitySettingsInfo",null,[830]);class ld{constructor(){this.Oa=null}get name(){return"Common.App.AccessibilitySettings"}oc(Y){this.Oa=Y;this.Oa.register(dd,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").pa(()=>
new dd).oa();this.Oa.register(ac,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").pa(()=>new ac(n.AFrameworkApplication.ub,ec())).oa()}init(){const Y=ec(),Sa=vb.a.instance.Db("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");Y&&Sa?(Sa.Kb(),Y.cBn(),Y.kBn(),z.c(508827098,200,50,"Text Selection Highlight Change Setting value on boot: {0}",Y.zsh)):z.c(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){b.a.instance.Jc(new ld)}}
Object(c.a)(ld,"AccessibilitySettingsPackage",null,[4,5]);var bc=a(114),cc=a(287),Vc=a(1397),td=a(100),Xc=a(1153);class ne extends za.a{constructor(Y,Sa,Mb,oc){oc=void 0===oc?null:oc;super();this.Feb=this.gR=this.Agd=null;this.kq=[];this.j1g=Oc=>{this.gR&&(this.gR.target="_blank",this.gR.submit());Oc.preventDefault()};this.MYl=()=>{e.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1};this.v1n=()=>{e.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");
this.Jwc&&this.Jwc.stop()};this.rEh=Sa;this.IX=Y;this.oOm=Mb;this.KEh=oc;this.Jwc=new Xc.a("LoadResource","LoadPrintablePdf")}opb(){this.Ue=5;this.width=40;const Y=document.createElement("span");Y.id=this.jl("DirectPrintHeaderContent");const Sa=document.createElement("span");Sa.innerText=Object(ba.a)("DirectPrintDialogHeader");Sys.UI.DomElement.addCssClass(Sa,"DirectPrintHeader");this.Feb=document.createElement("iframe");this.Feb.name="pdfObjectFrame";this.Feb.title=Object(ba.a)("DirectPrintDialogIFrame");
this.Feb.onload=this.v1n;if(this.KEh&&0<this.KEh.count){var Mb=td.a.SLh(this.rEh,this.KEh);const oc=td.a.fYh(this.rEh,this.KEh);this.gR=document.createElement("form");this.gR.id="printPreviewPostForm";this.gR.method="POST";this.gR.target=this.Feb.name;this.gR.action=oc;for(const Oc of Mb)Mb=document.createElement("input"),Mb.type="hidden",Mb.name=Oc.key,Mb.value=Oc.value,this.gR.appendChild(Mb)}else this.Feb.setAttribute("src",this.rEh);Sys.UI.DomElement.addCssClass(this.Feb,cc.a.jEh);this.oOm?(Sys.UI.DomElement.addCssClass(this.Feb,
"DirectPrintPdfObjectHidden"),Sa.innerText=Object(ba.a)("DirectPrintDialogSuccessText"),Fa.a.vea(this.Feb,Fa.a.CK,Fa.a.iE)):(Sys.UI.DomElement.addCssClass(this.Feb,"DirectPrintPdfObject"),this.kq.push(this.Feb));Y.appendChild(Sa);Y.appendChild(document.createElement("br"));Y.appendChild(this.Feb);this.gR&&Y.appendChild(this.gR);Y.appendChild(document.createElement("br"));Y.appendChild(this.x2m(this.gR?"#":this.rEh));this.Jwc.start();this.Umc(Object(ba.a)("AppTitle"),null,null,null,null,Y);this.Gua(this.jl("DirectPrintHeaderContent"));
this.gR&&this.gR.submit();this.o4m();e.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}x2m(Y){const Sa=document.createElement("span");var Mb=document.createElement("span");Mb.innerText=Object(ba.a)("DirectPrintDialogDownloadPDFHeader");Sa.appendChild(Mb);n.AFrameworkApplication.ha&&(2===n.AFrameworkApplication.Ha.Ib.Dm&&n.AFrameworkApplication.ha.getBooleanAppSetting("PPTDisableDirectPrintDialogDownloadPDFLink")||1===n.AFrameworkApplication.Ha.Ib.Dm&&n.AFrameworkApplication.ha.getBooleanAppSetting("XLODisableDirectPrintDialogOpenPDFLink"))?
(Y=document.createElement("span"),2===n.AFrameworkApplication.Ha.Ib.Dm?Y.innerText=Object(ba.a)("DirectPrintDialogDownloadPDFLabel"):1===n.AFrameworkApplication.Ha.Ib.Dm&&(Y.innerText=Object(ba.a)("InternalError_Directive"),e.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.Agd=Y,Sa.appendChild(document.createElement("br")),Sa.appendChild(Y)):(Mb=document.createElement("a"),Mb.innerText=Object(ba.a)("DirectPrintDialogDownloadPDFLink"),Mb.href=Y,Mb.target=
"_blank",Mb.id="PrintPDFLink",Mb.className="AllowBrowserClick",this.Agd=Mb,Sa.appendChild(document.createElement("br")),Sa.appendChild(Mb),this.gR&&bc.a.addHandler(Mb,"click",this.j1g),this.IX.Ub(Z.a.click,this.Agd,this.MYl,null));this.kq.push(this.Agd);return Sa}o4m(){if(0<this.kq.length){const Y=new Vc.a(this.kq),Sa=Cb.FocusManager.instance().yu();Sa&&(this.Agd.focus(),Sa.fm=Y,Sa.J3=!0)}}Sce(){e.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}dispose(){this.Agd&&
(this.IX.hc(Z.a.click,this.Agd,this.MYl),this.Agd=null);ya.a.cP(this.Feb);this.Feb=null;super.dispose()}}Object(c.a)(ne,"DirectPrintDialog",za.a,[895]);class Vd{constructor(Y){this.IX=Y}ugn(Y,Sa,Mb){return new ne(this.IX,Y,Sa,void 0===Mb?null:Mb)}}Object(c.a)(Vd,"DirectPrintDialogFactory",null,[861]);var Ja=a(38),Lb=a(85);class fa{constructor(Y,Sa){this._url=Y;this.ZPm=Sa}FYl(){this.ZPm?Lb.a.KYl(this._url):Lb.a.Go(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}
Object(c.a)(fa,"OpenUrlInTabDialogDownloadBehavior",null,[894,40]);var Na=a(69);class ha extends za.a{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd){Sa=void 0===Sa?!0:Sa;Mb=void 0===Mb?!1:Mb;oc=void 0===oc?null:oc;Oc=void 0===Oc?null:Oc;nd=void 0===nd?!1:nd;Cd=void 0===Cd?null:Cd;Zd=void 0===Zd?!1:Zd;super();this.$Re=this.ZRe=this.gR=this.bHb=null;this.MPn=eg=>{this.u_l(eg);return!0};this.NPn=eg=>this.IZe(eg,this.u_l);this.u_l=eg=>{this.gR&&this.gR.submit();this.GXb(eg.Hc)};this.mfa=eg=>{1===eg?(this.Sce(),
this.gR?ha.eeb&&this.Gsm():this.E$h.FYl()):2===eg?(this.Pbm(),this.jfg?this.lQi():(this.H9l||this.Wfg)&&this.M9m()):0==eg&&this.qbm();this.dispose()};var we=this.Jsl?this.Jsl:Object(ba.a)("DefaultDialogTitle");ha.QXe=nd;this.zMm=Cd;this.JNm=Zd;this.E$h=oc||new fa(Y,!0);const Qe=[],kf=[];ha.eeb&&(this.eGh&&this.eGh.forEach(eg=>{Array.add(Qe,eg)}),this.aRl&&this.aRl.forEach(eg=>{Array.add(kf,eg)}));Sa?Mb?this.jfg?(this.Ue=12,this.vg(1,this.buttonText),this.vg(2,Object(ba.a)("DownloadAsPdfDialog_CopyALinkButton")),
this.vg(3,Object(ba.a)("DialogClose"))):this.Wfg?(this.Ue=12,this.vg(1,this.buttonText),this.vg(2,Object(ba.a)("DownloadAsPdfDialog_EmailALinkButton")),this.vg(3,Object(ba.a)("DialogClose"))):this.H9l?(this.Ue=12,this.vg(1,this.buttonText),this.vg(2,Object(ba.a)("DownloadACopyDialog_EmailALinkButton")),this.vg(3,Object(ba.a)("DialogClose"))):(this.Ue=4,this.vg(1,this.buttonText),this.vg(2,Object(ba.a)("DialogClose"))):(this.Ue=6,this.vg(0,Object(ba.a)("DialogClose"))):this.Ue=5;nd=document.createElement("span");
this.RMf&&(nd.className=this.RMf);oc=document.createElement("a");oc.innerText=this.SZe;oc.href=Y;oc.target="_blank";oc.id=this.Qmg;oc.className=ma.AFrame.cwi;if(Cd=!Na.a.WV&&!Na.a.olg&&!!Oc&&0<Oc.count){Zd=td.a.SLh(Y,Oc);Oc=td.a.fYh(Y,Oc);oc.href="#";oc.target="_self";this.gR=document.createElement("form");this.gR.id="printPreviewPostForm1";this.gR.method="post";this.gR.target="_blank";this.gR.action=Oc;for(var Vf of Zd)Oc=document.createElement("input"),Oc.type="hidden",Oc.name=Vf.key,Oc.value=Vf.value,
this.gR.appendChild(Oc)}else this.gR=null;this.gR||ha.QXe?ha.QXe||Array.add(kf,{["type"]:"AppLinkProps",["id"]:this.Qmg,["text"]:this.SZe,["onExecute"]:()=>{this.Gsm()}}):Array.add(kf,{["type"]:"AppLinkProps",["id"]:this.Qmg,["text"]:this.SZe,["handler"]:{["href"]:Cd?"#":Y,["target"]:Cd?"_self":"_blank"}});this.t$b&&Array.add(Qe,this.t$b);Mb?(Y=document.createElement("span"),Y.innerText=this.t$b.replace("{0}",""),nd.appendChild(Y)):this.sjm?(Y=document.createElement("span"),Y.id=this.jl("message"),
Vf=document.createElement("span"),Oc=document.createElement("span"),Cd=this.t$b.split("{0}"),Vf.innerText=Cd[0],Oc.innerText=Cd[1],Y.appendChild(Vf),Y.appendChild(oc),Y.appendChild(Oc),nd.appendChild(Y)):(Y=document.createElement("span"),Y.innerText=this.t$b,nd.appendChild(Y),nd.appendChild(document.createElement("br")),nd.appendChild(document.createElement("br")),nd.appendChild(oc),ha.QXe||Array.add(Qe,"{0}"));this.gR&&nd.appendChild(this.gR);ha.eeb&&(this.bmc&&(this.Emg?this.wFh(this.bmc,this.Emg):
(Array.add(Qe,"{0}"),Array.add(kf,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.bmc,["onExecute"]:()=>{this.DPh()}}))),this.dJd(Qe,kf));this.Umc(we,null,this.rGj,null,this.mfa,ha.eeb?null:nd);this.Gua(this.jl("message"));!ha.eeb&&this.Emg&&this.bmc&&(we=document.createElement("div"),we.className="WACDialogLearnMoreLinkContainer",this.bHb=document.createElement("a"),this.bHb.innerText=this.bmc,this.bHb.href=this.Emg,this.bHb.target="_blank",this.bHb.id=this.jl("LearnMoreLinkId"),
this.bHb.className=ma.AFrame.cwi,we.appendChild(this.bHb),Sa?this.Cc.insertBefore(we,this.Cc.lastChild):this.Cc.appendChild(we),this.Gua(String.format("{0} {1}",this.jl("message"),this.jl("LearnMoreLinkId"))));this.Zef=oc;Mb?this.f6(this.aK):this.f6(this.Zef);this.WZe();n.AFrameworkApplication.Ha.L0.Ub(Z.a.click,this.Zef,Object(h.a)(this,this.LYl,"downloadLinkClicked"),null);this.bHb&&n.AFrameworkApplication.Ha.L0.Ub(Z.a.click,this.bHb,Object(h.a)(this,this.DPh,"learnMoreLinkClicked"),null);this.$Ch=
!1}get rGj(){return null}get Jsl(){return null}get t$b(){return null}get rTl(){return this.zMm}get s_l(){return this.JNm}get Emg(){return null}get bmc(){return null}get sjm(){return!1}get buttonText(){return Object(ba.a)("Open")}get RMf(){return null}get eGh(){return null}get aRl(){return null}get jfg(){return!1}get Wfg(){return!1}get H9l(){return!1}lQi(){const Y={SourceControlId:"CopyLink"};this.jfg&&(Y.shareOverrideDefaultPermission=!0);this.NAa(Y,{ControlId:"CopyLink"})}M9m(){const Y={SourceControlId:"Share"};
this.Wfg&&(Y.shareOverrideDefaultPermission=!0);this.NAa(Y,{ControlId:"Share"})}NAa(Y,Sa){const Mb=n.AFrameworkApplication.ub;Mb.np=8;Mb.Ra(r.a.NAa,2,Y,Sa)}s2a(){this.gR&&(this.ZRe||(this.ZRe=this.MPn,this.pv.Ub(Z.a.click,this.aK,this.ZRe)),this.$Re||(this.$Re=this.NPn,this.Tj.Ub(Z.a.jn,this.aK,this.$Re)));super.s2a()}Pbm(){}qbm(){}Sce(){}LYl(){this.bog();this.gR?this.gR.submit():this.E$h.FYl();return!0}DPh(){return!1}dispose(){this.E$h.dispose();this.Zef&&(n.AFrameworkApplication.Ha.L0.hc(Z.a.click,
this.Zef,Object(h.a)(this,this.LYl,"downloadLinkClicked")),this.Zef=null);this.bHb&&(n.AFrameworkApplication.Ha.L0.hc(Z.a.click,this.bHb,Object(h.a)(this,this.DPh,"learnMoreLinkClicked")),this.bHb=null);this.pv&&this.ZRe&&(this.pv.hc(Z.a.click,this.aK,this.ZRe),this.ZRe=null);this.Tj&&this.$Re&&(this.Tj.hc(Z.a.jn,this.aK,this.$Re),this.$Re=null);super.dispose()}Gsm(){this.gR&&(document.body.appendChild(this.gR),this.gR.submit(),document.body.removeChild(this.gR))}static get eeb(){return n.AFrameworkApplication.Ha.Ib.rR&&
n.AFrameworkApplication.Ha.Ib.SOh}static get QXe(){return ha.FKl}static set QXe(Y){ha.FKl=Y}}ha.FKl=!1;Object(c.a)(ha,"ADialogWithLinkToResource",za.a,[]);class sa extends ha{constructor(Y,Sa,Mb,oc,Oc,nd,Cd){Mb=void 0===Mb?null:Mb;oc=void 0===oc?!0:oc;Oc=void 0===Oc?!1:Oc;nd=void 0===nd?null:nd;Cd=void 0===Cd?!1:Cd;super(Y,!0,!(sa.$td&&oc),new fa(Y,Sa),Mb,Oc,nd,Cd);sa.$td=sa.$td&&oc;if(sa.$td){Sa=document.createElement("iframe");oc=null;Oc=this.ZXl;Sa.name="pdfObjectFrame";Sa.id="pdfObjectIFrame";
if(Mb&&0<Mb.count){nd=td.a.SLh(Y,Mb);Y=td.a.fYh(Y,Mb);oc=document.createElement("form");oc.id="printPreviewPostForm";oc.method="POST";oc.target=Sa.name;oc.action=Y;for(const Zd of nd)Y=document.createElement("input"),Y.type="hidden",Y.name=Zd.key,Y.value=Zd.value,oc.appendChild(Y)}else Sa.src=Y;Oc.appendChild(Sa);oc&&(Oc.appendChild(oc),oc.submit());Sys.UI.DomElement.addCssClass(Sa,"DirectPrintPdfObjectHidden");Fa.a.vea(Sa,Fa.a.CK,Fa.a.iE)}}get rGj(){return"Print_32x32x32"}get Jsl(){return sa.$td?
Object(ba.a)("PrintDialogDocumentIsReadyToPrint"):null}get t$b(){return sa.$td?null:Object(ba.a)("PrintDialogDocumentIsReadyToPrint")}get eGh(){const Y=[];Array.add(Y,Object(ba.a)("PrintDialogCanCloseDocument"));if(ha.QXe){let Sa=Object(ba.a)("DirectPrintDialogFallbackSuggestion");""!==n.AFrameworkApplication.Ha.Ib.rWi&&(Sa=n.AFrameworkApplication.Ha.Ib.rWi);Array.add(Y,Sa)}return sa.$td?Y:null}get SZe(){return Object(ba.a)("DirectPrintDialogDownloadPDFLink")}get Qmg(){return"PrintPDFLink"}get buttonText(){return Object(ba.a)("PrintDialogOpenPDF")}get RMf(){return n.AFrameworkApplication.gIb?
"UIFontDialogTextLarge":null}WZe(){e.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}bog(){n.AFrameworkApplication.Di.pgb(9540,1);e.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}Pbm(){Object(Aa.a)("PrintDialogSecondaryButtonClicked",!0)}qbm(){Object(Aa.a)("PrintDialogCancelButtonClicked",!0)}Sce(){e.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get $td(){return!!n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.rR&&n.AFrameworkApplication.ha.getBooleanAppSetting("DirectPrintDialogAsStandardDialogIsEnabled")&&
!(Na.a.WV||Na.a.ek||Na.a.Yf||Na.a.o2b)&&!n.AFrameworkApplication.lnd&&n.AFrameworkApplication.ha.getBooleanAppSetting("ShouldHostDefaultToNativeBrowserPrintExperience")&&sa.AOl}static set $td(Y){sa.AOl=Y}}sa.AOl=!1;Object(c.a)(sa,"PrintDialogWithLinkToPdf",ha,[]);class xa{constructor(Y){this.isEnabled=Boolean.parse(Y.DirectPrintIsEnabled||"false");this.fyn=Boolean.parse(Y.DirectPrintProbeIsEnabled||"false");this.yxn=Boolean.parse(Y.DirectPrintEnabledForInternetExplorer||"false");this.tLe=(Y.DirectPrintSupportedMimeTypes||
"").split(xa.RZi);this.ntd=(Y.DirectPrintSupportedPlugins||"").split(xa.RZi);this.Ktn=(Y.DirectPrintImmersivePreviewPlugins||"").split(xa.RZi);this.G9l=Boolean.parse(Y.DirectPrintEnabledForEdge||"false");this.ywn=Boolean.parse(Y.ChromePrintLayoutFixIsEnabled||"false");this.C0m=parseInt(Y.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.osk=14;this.tjm=14394;if(Y=Y.DirectPrintMinimalSupportedEdgeVersion){const Sa=Y.split(".");2===Sa.length?(this.osk=parseInt(Sa[0]),this.tjm=parseInt(Sa[1])):
e.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",Y)}else e.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}xa.RZi=",";Object(c.a)(xa,"DirectPrintBrsSettings",null,[]);class pb{constructor(Y,Sa){this.Dol=Y;this.ntd=Sa}}Object(c.a)(pb,"DirectPrintProbeResults",null,[]);var Rb=a(206),Fc=a(17);class Kc{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe){this.lFh=null;this.hkn=
()=>{var kf=this.kmn();const Vf=this.B2n(),eg={},zg={};for(let yh=0;yh<this.hwa.tLe.length;yh++)eg[this.hwa.tLe[yh]]=kf[yh];for(kf=0;kf<this.hwa.ntd.length;kf++)zg[this.hwa.ntd[kf]]=Vf[kf];return new pb(eg,zg)};this.nNm=Y;this.pnf=Sa;this.Yfi=Mb;this.LOm=oc;this.XOm=Oc;this.vpf=new Ja.a(this.hkn);this.q$h=nd;this.ILl=we;this.Msf=Cd;this.YOm=Zd;this.dPm=Qe}get hwa(){return this.nNm}start(){}w1n(){this.hwa.fyn&&this.hCn()}A2n(){const Y=Array(this.hwa.tLe.length);if(void 0!==this.pnf&&null!==this.pnf)for(let Sa=
0;Sa<this.hwa.tLe.length;Sa++)Y[Sa]=this.hwa.tLe[Sa]in this.pnf&&this.LOm(this.pnf[this.hwa.tLe[Sa]]);return Y}B2n(){const Y=Array(this.hwa.ntd.length),Sa=!(void 0===this.Yfi||null===this.Yfi);for(let Mb=0;Mb<this.hwa.ntd.length;Mb++){const oc=this.hwa.ntd[Mb];Y[Mb]=Sa&&oc in this.Yfi?!0:this.XOm(oc)}return Y}kmn(){const Y=this.A2n(),Sa=Array(Y.length);for(let Mb=0;Mb<Y.length;Mb++)Sa[Mb]=Y[Mb]?this.oan(this.pnf[this.hwa.tLe[Mb]]):null;return Sa}oan(Y){if(void 0===Y||null===Y)return null;Y=Y.enabledPlugin;
return void 0===Y||null===Y?null:Y.name}hCn(){e.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.vpf.value.Dol,this.vpf.value.ntd)}Kdo(){return this.dPm||!this.hwa.isEnabled||n.AFrameworkApplication.lnd?!1:this.Kho()}vzm(){if(null!=this.lFh)return this.lFh;const Y=Kc.F9l(this.hwa);return this.lFh=this.hwa.G9l&&Y||this.xwn()}xwn(){return Na.a.Ek&&this.hwa.ywn&&Na.a.pjd>=this.hwa.C0m?!0:!1}Kho(){if(!this.YOm(this.hwa))return!1;var Y=Fc.a.vuj(this.vpf.value.Dol);for(const Sa of Y)if(void 0!==
Sa&&null!==Sa)return!0;Y=Fc.a.vuj(this.vpf.value.ntd);for(const Sa of Y)if(Sa)return!0;return!1}qqn(){const Y=Fc.a.vuj(this.vpf.value.Dol);for(const Sa of Y)if(Rb.a.contains(this.hwa.Ktn,Sa))return!0;return!1}eAm(Y){var Sa=void 0===Sa?!1:Sa;var Mb=void 0===Mb?null:Mb;n.AFrameworkApplication.Ha&&n.AFrameworkApplication.ha.getBooleanAppSetting("DirectPrintDialogAsStandardDialogIsEnabled")?this.ILl(Y,Mb):this.Kdo()?this.A8m(Y,this.qqn()&&!Sa,Mb):this.ILl(Y,Mb)}A8m(Y,Sa,Mb){Mb=void 0===Mb?null:Mb;const oc=
this.Msf.Xl("UserAction","OpenDirectPrintDialog");this.q$h.ugn(Y,Sa,Mb).opb();oc.stop()}static bzn(Y){try{return new ActiveXObject(Y),!0}catch(Sa){e.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",Y)}return!1}static Zwn(Y){return void 0===Y||null===Y?!1:!(void 0===Y.enabledPlugin||null===Y.enabledPlugin)}static create(){const Y=new xa(n.AFrameworkApplication.ha.appSettings);let Sa=null;try{Sa=window.navigator.mimeTypes}catch(Qe){e.ULS.sendTraceTag(573923532,328,
15,"Failed to get Window.Navigator.mimeTypes")}let Mb=null;try{Mb=window.navigator.plugins}catch(Qe){e.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const oc=Kc.Zwn,Oc=Kc.bzn,nd=vb.a.instance.resolve("Common.App.DirectPrint.DirectPrintDialogFactory"),Cd=n.AFrameworkApplication.Ha.Iea,Zd=Kc.czn,we=!!n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.rR&&!n.AFrameworkApplication.ha.getBooleanAppSetting("PrintDialogFallbackLinkEnabled");return new Kc(Y,Sa,Mb,oc,Oc,
nd,Cd,Zd,(Qe,kf)=>new sa(Qe,!1,kf,!0,we),n.AFrameworkApplication.XV)}static czn(Y){return Na.a.Ek||Na.a.ek&&Y.yxn||Y.G9l&&Kc.F9l(Y)?!0:!1}static F9l(Y){var Sa=Na.a.SXa;if(Sa){var Mb=Sa.split(".");if(2===Mb.length)return Sa=parseInt(Mb[0]),Mb=parseInt(Mb[1]),Sa>Y.osk||Sa===Y.osk&&Mb>=Y.tjm}return!1}}Object(c.a)(Kc,"DirectPrintManager",null,[829]);class jb{constructor(){this.IJl=this.Oa=null}get name(){return"Common.App.DirectPrint"}oc(Y){this.Oa=Y;Y.register(Vd,"Common.App.DirectPrint.DirectPrintDialogFactory").oa().pa(()=>
new Vd(n.AFrameworkApplication.Ha.L0));Y.register(829,"Common.App.DirectPrint.IDirectPrintManager").oa().pa(()=>Kc.create(this.Oa))}init(){this.IJl=vb.a.instance.resolve("Common.App.DirectPrint.IDirectPrintManager");this.IJl.start()}dispose(){}}Object(c.a)(jb,"PackageManager",null,[4,5]);var zb=a(1225),ic=a(295);class bb{constructor(Y,Sa){this.Eff=null;this.Zlo=(Mb,oc,Oc,nd,Cd)=>{if(1===Oc)return 32;Cd[zb.a.Value]=this.Eff;Cd[ic.a.labelText]=this.Eff;Cd[zb.a.Visible]=!0;return 32};this.Aa=Y;this.Ga=
Sa}Kb(){(this.Eff=this.Ga.Ma("StatusBarEnvironmentNameToUse"))&&""!==this.Eff&&this.Aa.ua(r.a.T3e,u.a.frame,this.Zlo,96)}}Object(c.a)(bb,"DisplayEnvironmentName",null,[]);class Pb{constructor(){this.Oa=null}get name(){return"Common.App.DisplayEnvironmentName"}oc(Y){this.Oa=Y;this.Oa.register(bb,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").oa().pa(()=>new bb(n.AFrameworkApplication.ub,n.AFrameworkApplication.ha))}init(){vb.a.instance.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").Kb()}dispose(){}static main(){b.a.instance.Jc(new Pb)}}
Object(c.a)(Pb,"DisplayEnvironmentNamePackage",null,[4,5]);const wc=()=>vb.a.instance.resolve("Common.App.InProductMessaging.InProductMessagingUIManager");var Dc=a(172),ed=a(169),ad=a(625);class Gd extends ad.a{constructor(Y){super(Y)}get XHb(){return!1}createElement(){const Y=document.createElement("link");Y.setAttribute("rel","stylesheet");Y.setAttribute("type","text/css");Y.setAttribute("href",this.Cu);return Y}Jjd(){return null}coc(){this.element.setAttribute("href","");this.element.setAttribute("href",
this.FM.Cu)}}Object(c.a)(Gd,"CssResource",ad.a,[]);var Od=a(375),Ld=a(3);class ee{constructor(){this.wEh=this.nDh=null}$An(){this.nDh||(e.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.nDh=Ld.Task.WAA(ee.eBn(),ee.YAn()),this.nDh.continueWith(Y=>{e.ULS.sendTraceTag(21030599,324,10,"{0}",Eb.a.wLh(Y.Cj))},5));return this.nDh}aBn(){if(!this.wEh)try{e.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.wEh=Ld.Task.WAA(ee.f3i(Od.a.create(n.AFrameworkApplication.ha.Ma("DimeUrl"),
null,null))),this.wEh.continueWith(Y=>{e.ULS.sendTraceTag(39978391,324,10,"{0}",Eb.a.wLh(Y.Cj))},5)}catch(Y){e.ULS.sendTraceTag(594874951,324,10,"{0}",Eb.a.wLh(Y))}return this.wEh}static eBn(){var Y=ee.yXe("inproductmessaging.js");Y=Od.a.create(Y,null,null);return ee.f3i(Y)}static YAn(){var Y=ee.yXe("inproductmessaging.css");Y=new Gd(Y);return ee.f3i(Y)}static yXe(Y){return ed.a.UHb(String.format("ipm/{0}",Y))}static f3i(Y){Qb.a.RK(Y);return Y.K7a}}Object(c.a)(ee,"DependencyDownloader",null,[834]);
class Ce{}Ce.NVn="inProductMessagingOverlayDiv";Ce.eXn="PlayButtonImage";Ce.C7n="ReplayButtonImage";Object(c.a)(Ce,"Constants",null,[]);class Pc{constructor(){this.UNl=this.iMl=this.GIl=!0;this.D7n=this.gXn=null;this.DOn=!1;this.locale=null;this.ADm={}}get autoPlay(){return this.GIl}set autoPlay(Y){this.GIl=Y}get Cjm(){return this.iMl}set Cjm(Y){this.iMl=Y}get Wzm(){return this.UNl}set Wzm(Y){(this.UNl=Y)&&this.mbo()}mbo(){this.wPl(Ce.eXn,this.gXn);this.wPl(Ce.C7n,this.D7n)}wPl(Y,Sa){Sa&&(this.ADm[Y]=
Sa)}}Object(c.a)(Pc,"FirstRunExperienceUISettings",null,[833]);class Yc{constructor(){this.completed=this.B5n=!1}}Object(c.a)(Yc,"FirstRunExperienceViewData",null,[832]);var Bd=a(228);class Dd{constructor(Y,Sa,Mb){this.Tbn=(oc,Oc,nd,Cd,Zd)=>{2===nd&&this.BDh.yAn(Zd);return 32};this.i8m=(oc,Oc,nd,Cd,Zd)=>{2===nd&&this.BDh.uAn(Zd);return 32};this.Ptn=(oc,Oc,nd)=>2===nd?this.BDh.Psk():32;this.Otn=(oc,Oc,nd)=>2===nd?this.BDh.Ksk():32;this.Aa=Y;this.yo=Sa;this.BDh=Mb}Kb(){this.Aa.ua(r.a.M0l,u.a.frame,
this.Tbn,64);this.Aa.Ba(r.a.H9i,u.a.frame,this.Ptn);this.Aa.Ba(r.a.G9i,u.a.frame,this.Otn);this.Aa.Ba(r.a.lYl,u.a.frame,this.i8m);this.Aa.Ba(r.a.s0k,u.a.frame,Bd.ActionManager.Wi);this.Aa.Ba(r.a.hvm,u.a.frame,Bd.ActionManager.Wi);this.Aa.Ba(r.a.ivm,u.a.frame,Bd.ActionManager.Wi);this.yo&&this.yo.fg()}}Object(c.a)(Dd,"InProductMessagingActor",null,[]);class Sd{constructor(){this.Atm=this.$la=this.aCm=this.APh=this.instance=null}}Object(c.a)(Sd,"DimeExperienceUISettings",null,[]);var He=a(401);class ge{constructor(Y,
Sa,Mb,oc,Oc){this.OKh=!1;this.wPf=null;this.Aa=Y;this.Djc=Sa;this.FSe=Mb;this.LY=oc;this.ooa=Oc}Yun(Y){Gc.b("getHeaderApi")?(Y.tam()&&appChrome.getHeaderApi().then(Sa=>{Sa.updateAnonymousStatus(!0);return null}),Y.isFeatureEnabled("MsoPremiumBadge",!0).then(Sa=>{const Mb=Y.isFreemiumUpsellEnabled();Mb&&(appChrome.getHeaderApi().then(oc=>{oc.updatePremiumStatus(Sa,Mb);return null}),Y.UKb("MsoPremiumBadge",oc=>{appChrome.getHeaderApi().then(Oc=>{Oc.updatePremiumStatus(oc.isEnabled,Mb);return null})}));
return null})):e.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}yAn(Y){this.FSe.$An().continueWith(()=>{this.Djc.pfo(Y)})}uAn(Y){let Sa="gopremium",Mb=null,oc=()=>{};Y?(Y.experience&&""!==Object(G.a)(String,Y.experience)&&(Sa=Object(G.a)(String,Y.experience)),Y.onTaskComplete&&(oc=Y.onTaskComplete),Y.campaignId&&""!==Object(G.a)(String,Y.campaignId)&&(Mb=Object(G.a)(String,Y.campaignId))):e.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.Y0j(Sa,
oc,Mb)}Y0j(Y,Sa,Mb){Mb=void 0===Mb?null:Mb;if(this.OKh&&this.wPf){const oc={};oc.experience=Y||"gopremium";oc.campaignId=Mb||He.b(this.LY,this.ooa,Object(G.a)(String,oc.experience),!0);this.Aa.Eb(r.a.s0k,2);e.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+oc.experience);try{const Oc=Object.assign(new Sd,{instance:this.wPf,APh:oc,aCm:Sa||(()=>{}),$la:nd=>{e.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+nd.status)},Atm:()=>{e.ULS.sendTraceTag(51675406,324,10,"Dime launch error");
this.OKh=!1;this.wPf=null}});this.Djc.yeo(Oc)}catch(Oc){e.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Oc.message),this.OKh=!1,this.wPf=null,this.Aa.Ra(r.a.mXd,2,{["experience"]:oc.experience})}}else e.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Aa.Ra(r.a.mXd,2,{["experience"]:Y})}bBn(){this.FSe.aBn().continueWith(()=>{try{var Y=Eb.a.ph(n.AFrameworkApplication.uiCulture);const oc=He.c(this.LY);if(oc){var Sa={};Sa.partnerId=oc;Sa.language=Y;Sa.sessionId=
n.AFrameworkApplication.userSessionId;Sa.authHint=n.AFrameworkApplication.ha.Ma("UserPrincipalName");var Mb=n.AFrameworkApplication.ha.Ma("Puid")||"";""!==Mb&&(Y={},Y.puid=Mb,Sa.userInfo=Y);this.wPf=new Dime(Sa);this.OKh=!0;e.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else e.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(oc){e.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+oc.message)}},3)}Psk(){return this.Djc.Psk()}Ksk(){return this.Djc.Ksk()}}
Object(c.a)(ge,"InProductMessagingUIManager",null,[828]);class ve{constructor(){this.tOl=0;this.qSe=Array(5);this.qSe[0]=10;this.qSe[1]=15;this.qSe[2]=50;this.qSe[3]=100;this.qSe[4]=200}Init(Y){this.tOl=Y}SendTrace(Y,Sa){e.ULS.sendTraceTag(34182235,this.tOl,this.qSe[Y],"{0}",Sa)}}Object(c.a)(ve,"DefaultNetworkingManager",null,[860]);var ze=a(205);class bf{constructor(Y){this.Fe=Y}pfo(Y){Y&&(InProductMessaging.Networking.NetworkingMgr=new ve,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(Y.Wzm,
Y.Cjm,Y.autoPlay,Y.DOn,Y.locale,Object(h.a)(this,this.xRn,"onDismissFirstRunExperience"),Y.ADm),this.aoa(Ce.NVn,!0))}yeo(Y){if(Y&&Y.instance&&Y.APh){let Sa=document.getElementById("wacDimeContainer");Sa||(Sa=document.createElement("div"),Sa.id="wacDimeContainer",document.body.appendChild(Sa));n.AFrameworkApplication.ha.getBooleanAppSetting("DimeFocusManagerIsEnabled")&&this.aoa("wacDimeContainer",!1);Y.APh.parentElementId="wacDimeContainer";Y.instance.launch(Y.APh,Y.aCm).then(Mb=>{this.fGa();document.body.removeChild(Sa);
Y.$la(Mb)}).catch(Mb=>{this.fGa();document.body.removeChild(Sa);Y.Atm(Mb)})}else throw Error.argument("DimeExperienceUISettings");}aoa(Y,Sa){if(this.Fe&&Y&&(Y=document.getElementById(Y),this.Vun(Y),Y=this.Fe.YX("InProductMessagingFocusId"))){const Mb=this.Fe.currentScope;Mb&&"InProductMessagingFocusId"===Mb.name||this.Fe.haa("InProductMessagingFocusId",!1);Sa&&this.H3n(Y.scope)}}Vun(Y){var Sa=!1;Sa=void 0===Sa?!0:Sa;const Mb=this.Fe.Uc("InProductMessagingFocusId");Mb.parent=ma.AFrame.lC;const oc=
new ze.DOMFocusListing(()=>Y);oc.WKb=Sa;oc.Xq(3);oc.Xq(2);oc.Xq(4);Sa=this.Fe.Upa(()=>Y,Mb,oc);Sa.XKb();Sa.J3=!0;Sa.vfb=!0}H3n(Y){Y.kD(Cb.FocusManager.instance().mHb);Y.kD(Cb.FocusManager.instance().nHb);Y.bindAction(Cb.FocusManager.instance().mHb,r.a.H9i);Y.bindAction(Cb.FocusManager.instance().nHb,r.a.G9i)}fGa(){this.Fe&&(this.Fe.$da("InProductMessagingFocusId"),this.Fe.hoc("InProductMessagingFocusId"))}xRn(Y,Sa){this.fGa();Y=Object.assign(new Yc,{completed:Y,B5n:Sa});n.AFrameworkApplication.ub.Ra(r.a.L0l,
2,Y)}Psk(){const Y=document.activeElement,Sa=this.Fe.yu();return Y&&Sa&&Sa.fm&&Y===Sa.fm.Aub?(Sa.fm.qO(Y),Sa.o0c()?32:8):4}Ksk(){const Y=document.activeElement,Sa=this.Fe.yu();return Y&&Sa&&Sa.fm&&Y===Sa.fm.rfa?(Sa.fm.qO(Y),Sa.n0c()?32:8):4}}Object(c.a)(bf,"InProductMessagingUIWrapper",null,[827]);class Of{constructor(){this.Oa=null}get name(){return"Common.App.InProductMessaging"}oc(Y){Y.register(ee,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").oa().pa(()=>
new ee);Y.register(bf,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").oa().pa(()=>new bf(Cb.FocusManager.instance()));Y.register(ge,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").oa().pa(()=>new ge(n.AFrameworkApplication.ub,vb.a.instance.resolve("Common.IInProductMessagingUIWrapper"),vb.a.instance.resolve("Common.App.InProductMessaging.IDependencyDownloader"),n.AFrameworkApplication.Ha.Ib.Dm,
n.AFrameworkApplication.Ha.Ib.pTa));Y.register(Dd,"Common.App.InProductMessaging.InProductMessagingActor").oa().pa(()=>new Dd(n.AFrameworkApplication.ub,n.AFrameworkApplication.Ha,vb.a.instance.resolve("Common.IInProductMessagingUIManager")));Y.register(Pc,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").oa().pa(()=>new Pc);Y.register(Yc,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").oa().pa(()=>
new Yc);this.Oa=Y}init(){vb.a.instance.resolve("Common.App.InProductMessaging.InProductMessagingActor").Kb();n.AFrameworkApplication.ha.Wf(()=>{n.AFrameworkApplication.Ha.Ib.PO&&Db.a.get_instance().Ai(15,()=>{Object(Dc.a)().execute(Y=>{wc().Yun(Y)})});n.AFrameworkApplication.ha.getBooleanAppSetting("FreemiumUpsellShowDialogIsEnabled")&&He.a()&&!Na.a.$y&&1!==n.AFrameworkApplication.Ha.Ib.Dm&&Object(Dc.a)().execute(Y=>{Y.isFeatureEnabled("MsoPremiumBadge",!0).then(Sa=>{!Sa&&Y.isFreemiumUpsellEnabled()&&
wc().bBn();return null})})})}dispose(){}static main(){b.a.instance.Jc(new Of)}}Object(c.a)(Of,"InProductMessagingPackage",null,[4,5]);const Qf=()=>vb.a.instance.eb("Common.IEventEmitter<Common.IMruResult>");var Oe=a(1432),tg=a(628),Cf=a(795);class oe{static $9m(Y){return oe.JSl("New",Y)}static a$m(Y){return oe.JSl("Open",Y)}static BSl(Y,Sa){return oe.IMd("LoadingMenuSection",oe.mBn,Y,oe.eDf("lblLoading",Sa))}static gDf(Y,Sa,Mb,oc){return oe.IMd("MessageMenuSection",oe.Kjm,Sa,oe.eDf("lblMessage",Y,
void 0===Mb?null:Mb,void 0===oc?null:oc))}static oZm(Y){return oe.BSl(Y,Object(ba.a)("VoicedLoadingText"))}static pZm(Y,Sa){return oe.gDf(Object(ba.a)("NewCreationLocationMessage"),Y.labelText,Sa.aga,Sa.QEb)}static nZm(Y,Sa){return oe.gDf(String.format(Object(ba.a)("NewProvisioningStorageMessage"),Sa.QEb,"\n\n"),Y.labelText)}static CSl(Y){return oe.gDf(Object(ba.a)("NewGenericErrorMessage"),Y.labelText)}static lZm(Y,Sa,Mb){return oe.IMd("menuNewBlank",oe.Dqn,Mb?Y.labelText:null,oe.VCf(Y.XMh,Y.YMh,
Y.ZMh,null,Y.TBa,Y.YLc,Sa,"blank"))}static HZm(){return oe.eDf("lblTemplatesLoading",Object(ba.a)("VoicedLoadingText"))}static GSl(){return oe.eDf("lblTemplatesError",Object(ba.a)("NewTemplateErrorMessage"))}static IZm(Y,Sa){return oe.IMd("menuNewTemplates",Y,null,Sa)}static jZm(Y,Sa){return oe.IMd("menuNewMoreTemplates",oe.X0l,null,oe.VCf("menuNewMoreTemplatesButton",Object(ba.a)("NewMoreTemplates"),Object(ba.a)("NewMoreTemplates"),null,null,null,Y,Sa))}static OYm(Y,Sa,Mb){let oc="";Mb&&Sa&&(oc=
oe.IMd("BrowseMoreMenuSection",oe.X0l,null,oe.VCf("btnBrowseMore",Sa,Sa,null,null,null,Y||"1959943459",Mb)));return oc}static eDf(Y,Sa,Mb,oc){Mb=void 0===Mb?null:Mb;let Oc=oc=void 0===oc?null:oc;Sa&&0<Sa.length&&(Oc=oe.Zjm.OTa(Sa).trimEnd(),Oc=0<=Oc.indexOf("{0}")?String.format(Oc,oc):String.format("{0} {1}",Oc,oc));Mb=Mb&&oc?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',Eb.a.We(Mb),Eb.a.We(oc),Eb.a.We(Oc)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',
Eb.a.We(Y||""),oe.Zjm.OTa(Eb.a.We(Sa||"")),Mb)}static VCf(Y,Sa,Mb,oc,Oc,nd,Cd,Zd){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',Eb.a.We(Y||""),Eb.a.We(Sa||""),Eb.a.We(Mb||""),oc||"32by32",Eb.a.We(Oc||""),Eb.a.We(nd||""),Cd,Eb.a.We(Zd||""))}static JSl(Y,Sa){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
Y,Sa)}static IMd(Y,Sa,Mb,oc){Mb=Mb?String.format('Title="{0}"',Eb.a.We(Mb)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',Eb.a.We(Y||""),Eb.a.We(Sa||""),Mb,oc)}}oe.Kjm="MenuMru";oe.mBn="MenuLoading";oe.Dqn="MenuHeader";oe.X0l="MenuFooter";oe.Zjm=Cf.a.Cx("\n","&#10;");Object(c.a)(oe,"NewAndOpenXmlUtilities",
null,[]);var Rf=a(118);class Uf{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(c.a)(Uf,"HostInformation",null,[]);var gf=a(224),gg=a(150),Ve=a(557),hf=a(370),ef=a(512),Ga=a(1502),hb=a(204),Hb=a(319),mc=a(341),Nc=a(291),db=a(240);const Wb={qNe:"CreateNewDocument_FileMenu",featureName:"New",cNa:"wwbootperf",qfd:"Boot",dkc:"Boot",HYl:!1};class Jc{get gKb(){this.Mnf||(this.Mnf=vb.a.instance.Db("Common.App.SaveToCloudStorage.ODCXStackOperationManager"));return this.Mnf}constructor(Y,
Sa,Mb,oc,Oc,nd){var Cd,Zd;this.mtf=this.GE=this.ACh=null;this.TEh=this.Iki=!1;this.dMl=0;this.Gdi=!1;this.a9g=()=>this.j9.ZGa&&!this.GE?2:32;this.nUe=(we,Qe,kf,Vf,eg)=>{if(1===kf)return 32;eg.MenuItemId=this.Yin();return this.j9.$Ia.Ra(r.a.lFa,kf,eg,Vf)};this.gYn=(we,Qe,kf,Vf,eg)=>{if(1===kf)return 32;this.j9.ZGa&&!this.GE&&this.akm.Qi("Opened New menu",!0);eg.MenuItems=Object.assign(new mc.a,{Id:"NewSection",MenuSectionList:[],UpdateDynamically:!0});we=this.l4m();eg.MenuItems.MenuSectionList.push(we);
return 32};this.Tqd=(we,Qe,kf,Vf,eg)=>{if(1===kf)return 32;2!==kf||this.Gdi||(this.dMl=(new Date).getTime(),this.JDh&&this.fDh.Bja({mw:"CreateNewDocument_FileMenuRender",uQc:Ga.b.FailureBased}),e.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.y_h,["CachedNewMenuXmlExists"]:!!this.ACh,["ShouldCallGetMoreInfo"]:this.j9.ZGa}));return this.JOm&&3===this.j9.Z5&&Hb.a.instance.Kra(n.AFrameworkApplication.Ao)?(e.ULS.sendTraceTag(507863243,202,15,"CreateNewActor: session is expired"),
this.fJh(),32):this.sYn(eg)};this.dLa=Y;this.egf=Sa;this.jOb=new Ja.a(()=>new tg.a(Mb.value,Object(h.a)(this,this.dJc,"getMoreInfoEventReceived")));this.DPm=oc;this.ZPb=Oc;this.wRm=nd;this.Zrf=this.y_h;this.ODh=!!n.AFrameworkApplication.ha&&n.AFrameworkApplication.ha.getBooleanAppSetting("GateTemplateRenderingByGetMoreInfoResponse");this.POm=!!n.AFrameworkApplication.ha&&n.AFrameworkApplication.ha.getBooleanAppSetting("PremiumTemplateEnabled");this.JOm=null!==(Zd=null===(Cd=n.AFrameworkApplication.ha)||
void 0===Cd?void 0:Cd.getBooleanFeatureGate("Microsoft.Office.WordOnline.CreateNewButtonGrayOutForExpiredSessionEnabled",!1))&&void 0!==Zd?Zd:!1;this.JDh=!!n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.NewKpiForCreateNew",!1);this.fDh=ef.a.getInstance(Wb)}get pXa(){switch(this.j9.Z5){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Kb(){const Y=this.j9.$Ia;Y.Ba(r.a.a9g,u.a.frame,this.a9g);Y.Ba(r.a.bZa,u.a.frame,
Object(h.a)(this,this.bZa,"newDocument"));Y.Ba(r.a.Tqd,u.a.frame,this.Tqd);Y.Ba(r.a.cqm,u.a.frame,this.gYn);Y.Ba(r.a.nUe,u.a.frame,this.nUe)}bZa(Y,Sa,Mb,oc,Oc){if(1===Mb)return 32;if(2===Mb&&Oc){this.JDh&&this.fDh.Bja({mw:"CreateNewDocument_FileMenuExec",uQc:Ga.b.FailureBased});if(n.AFrameworkApplication.ha.getBooleanAppSetting("BackstagePremiumTemplateExperienceEnabled")&&Oc.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),n.AFrameworkApplication.ub.Eb(r.a.wrm,
2);if(Oc.MenuItemId&&Oc.SourceControlId)return"NewDocumentHome"===Oc.SourceControlId&&Aa.a("NewDocumentFromHomeTab"),this.Kjd(Oc.MenuItemId,Oc.SourceControlId)}return 8}Yin(){switch(this.j9.Z5){case 3:return"https://www.office.com/template/Word";case 1:return"https://www.office.com/template/Excel";case 2:return"https://www.office.com/template/PowerPoint"}return null}Kjd(Y,Sa){var Mb=this.kVh.ILf;if(null===Mb)return this.tog("RelativePathIsNull",!0),8;var oc=n.AFrameworkApplication.ha.getBooleanAppSetting("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");
const Oc=n.AFrameworkApplication.una;"blank"===Y&&this.Nxn()&&(e.ULS.sendTraceTag(508687196,202,50,"Updating blank document id with new template id for appId={0}",this.pXa),Y="blankNew");if(Oc&&oc){e.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const nd={};nd[gf.a.Wql]=Y;nd[gf.a.pXa]=this.pXa;nd[gf.a.lcid]=n.AFrameworkApplication.lcid.toString();nd[gf.a.reason]=Ve.a.oTi;nd[gf.a.uiCulture]=n.AFrameworkApplication.uiCulture;nd[gf.a.dataCulture]=
n.AFrameworkApplication.dataCulture;n.AFrameworkApplication.ZP().execute(Cd=>{Cd.sendMessage(gg.a.Kjd,nd)})}else oc=(new Date).getTime(),Sa=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Mb,Eb.a.yj(this.cZa),Eb.a.yj(Y),Eb.a.yj(this.pXa),Eb.a.yj(n.AFrameworkApplication.lcid.toString()),Eb.a.yj(oc.toString()),Eb.a.yj(Sa),Eb.a.yj(n.AFrameworkApplication.ZC),n.AFrameworkApplication.Fh),(Mb=n.AFrameworkApplication.ha.Ma("ScenarioId"))&&
""!==Mb&&(Sa+="&wdscenarioid="+Eb.a.yj(Mb)),Sa+="&"+n.AFrameworkApplication.r5a(),Mb=this.GE?this.GE.aga:null,this.gKb&&this.gKb.jaf&&(Mb=this.gKb.PersonalFileStorageUrl),Mb?Sa+="&DestinationUrl="+Eb.a.yj(Mb):3===this.j9.Z5&&this.j9.ZGa&&(this.tog("GetMoreInfoOrPersonalFileStorageUrlIsEmpty",!0),e.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty")),"SharePoint"===this.cZa?hb.a.DH("6f63j813;9a66f561"):"OneDriveWopi"===this.cZa&&hb.a.DH("b8jd0489;3228j491"),
(Mb=Na.a.Rlc||Na.a.WV||Na.a.olg)&&e.ULS.sendTraceTag(507569058,202,15,"CreateNewDocument: Opening window via form POST is blocked, isMobileBrowser: {0}, isElectron: {1}, isWebview2: {2}",Na.a.Rlc,Na.a.WV,Na.a.olg),Mb||!n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForCreateNew",!1)&&!n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForOneDriveConsumerCreateNew",!1)?Lb.a.Go(Sa,"_blank",void 0,"CreateNewDocument"):
(Mb={ugfu:"1"},Mb.wacAadToken=n.AFrameworkApplication.$d.Q1,Lb.a.N4c("_blank",Sa,Mb));2!==this.j9.Z5&&3!==this.j9.Z5||e.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:hf.a[this.j9.Z5],["Template"]:Y});n.AFrameworkApplication.ha&&n.AFrameworkApplication.ha.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.j9.Z5&&("blank"===Y||"blankNew"===Y?Aa.b("ConsumerTemplateNewBlank"):(Y=[Object.assign(new x.a,{name:"TemplateId",string:Y})],
Aa.b("ConsumerTemplateNew",null,0,!0,0,Y)));this.Ebm(!0);return 32}Nxn(){let Y=!1;switch(this.j9.Z5){case 3:Y=n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefaultsUpdate",!1);break;case 2:Y=n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTODefaultThemeChange",!1);break;case 1:Y=n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)}return Y}MCn(Y){let Sa=Number.MAX_VALUE,Mb=Number.MIN_VALUE;
const oc=window.performance;if(oc&&"undefined"!==typeof oc.getEntriesByName){for(let nd=0;nd<Y.length;nd++){var Oc=oc.getEntriesByName(Y[nd]);Oc&&0<Oc.length&&(Oc=Oc[0],Sa=Math.min(parseInt(String(Oc.fetchStart)),Sa),Mb=Math.max(parseInt(String(Oc.responseEnd)),Mb))}Mb>Sa&&e.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:Mb-Sa,["MinFetchStart"]:Sa,["MaxResponseEnd"]:Mb})}}l4m(){const Y=Object.assign(new Nc.a,{Title:"",Id:"FileMenuNewSection",DisplayMode:"Menu",
ShowMenuSectionSeparator:!0,ControlList:[]});Y.ControlList.push(Object.assign(new db.a,{ExternalId:"btnBlankDocument",Command:r.a.bZa,CommandValueId:r.a.bZa,QueryCommand:r.a.a9g,LabelText:"Blank document",Alt:"Blank document",AriaDescription:"Blank document",ExternalImageId:"DocumentAddColorFluent_20",MenuItemId:"blank"}));Y.ControlList.push(Object.assign(new db.a,{ExternalId:"btnBrowseTemplates",Command:r.a.nUe,CommandValueId:r.a.nUe,LabelText:"Browse templates",Alt:"Browse templates",AriaDescription:"Browse templates",
ExternalImageId:"TemplateBrowseColorFluent_20"}));return Y}sYn(Y){Y&&(this.ACh?Y.PopulationXML=this.ACh:(this.j9.ZGa&&!this.GE&&this.akm.Qi("Opened New menu",!0),Y.PopulationXML=this.zdn(this.ymn())));return 32}x$l(){return!this.j9.ZGa||!!this.GE&&3===this.GE.state&&!!this.GE.QEb&&!!this.GE.aga||this.gKb&&this.gKb.jaf&&!!this.gKb.PersonalFileStorageUrl}ZWj(){return n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.wYa&&!this.ODh?!0:this.x$l()}ymn(){if(!this.y_h&&!this.ODh&&!this.ZWj())return null;
if(this.Zrf&&!this.TEh){let Sa=!1;var Y="9";const Mb=n.AFrameworkApplication.ha.appSettings;"NumberOfTemplatesInBackstage"in Mb&&(Y=Mb.NumberOfTemplatesInBackstage);let oc=this.pXa;"TemplateCollectionId"in Mb&&(oc=Mb.TemplateCollectionId);this.POm&&"PowerPointWAC"===oc&&(Sa=!0);Y=String.format(this.j9.o1+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",Eb.a.yj(n.AFrameworkApplication.lcid.toString()),Eb.a.yj(oc),Y);Boolean.parse(Mb.AppendOriginQueryParam||"false")&&(Y+="&org=backstage");Boolean.parse(Mb.BackstagePremiumTemplateExperienceEnabled||
"false")&&"TemplateTier"in Mb&&(Y+="&templateTier="+Mb.TemplateTier);Y=Sa?Y+"&p=1":Y+"&p=0";Y+="&"+n.AFrameworkApplication.r5a();this.j9.aKb.ik(Y,1,null,null,!1,2,Oc=>{this.j9.O$("CreateNewActor.GetTemplateListJson",Oc.data);this.kio(Oc.data.responseData)},Oc=>{this.j9.O$("CreateNewActor.GetTemplateListJson",Oc.data);this.jio()},null,void 0,void 0,void 0,void 0,"5");this.Zrf=!1}return this.mtf}kio(Y){this.mtf=Y;this.Zrf=!1;this.pah();this.ODh?this.ZWj()?this.q_i():this.GE&&(e.ULS.sendTraceTag(508867410,
202,10,"GetMoreInfo Received but info is missing"),this.tog("GetMoreInfoReceivedButInfoIsMissing",!1),this.fJh()):this.q_i()}q_i(){if(n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.wYa&&Gc.c()){const Y=n.AFrameworkApplication.ha.getBooleanAppSetting("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),Sa=n.AFrameworkApplication.una;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.mtf,!0,Y&&Sa));this.Ebm(!1);3===this.j9.Z5&&e.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}jio(){this.TEh=
this.Zrf=!0;this.pah();this.tog("TemplateServiceFailed",!1);this.fJh();Rf.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}fJh(){n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.wYa&&Gc.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.j9.Z5&&e.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}Ebm(Y){this.JDh&&this.fDh.FYa({mw:Y?"CreateNewDocument_FileMenuExec":"CreateNewDocument_FileMenuRender"})}tog(Y,
Sa){this.JDh&&this.fDh.Hwa({mw:Sa?"CreateNewDocument_FileMenuExec":"CreateNewDocument_FileMenuRender",errorName:Y})}Kmn(Y){var Sa=0;for(var Mb=0;Mb<Y.length;Mb++)if("ST"===Y[Mb].ImageType){Sa=Mb;break}const oc=Y.length?Y[Sa]:null;Y=oc?oc.Url||"":"";var Oc;let nd=Mb=Sa=!1;if(oc&&(Oc=oc.AspectRatio))Oc=parseFloat(Oc),1>Oc?Sa=!0:1.5<Oc?Mb=!0:1===Oc&&(nd=!0);else switch(e.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:Y}),this.j9.Z5){case 3:Sa=!0;break;case 2:Mb=!0;break;
case 5:nd=!0}return{returnValue:Y,LS:Sa?"95by123":Mb?"123by69":nd?"100by100":"123by95"}}zdn(Y){let Sa;const Mb=this.kVh.QMd||"1056925771",oc=(()=>{let Oc=this.mZm(Y,this.kVh,Mb);({u_h:Sa}=Oc);return Oc})().returnValue;Sa&&(this.ACh=oc,e.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:(new Date).getTime()-this.dMl}));return oc}dJc(Y,Sa){e.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.GE||3!==Y.state?2===Y.state&&
(e.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.Iki=!0,this.pah()):(this.GE=Y,Sa||this.pah(),n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.wYa&&Gc.c()&&Gc.d("setFileMenuHostInformation")&&(Y=Object.assign(new Uf,{hostUrl:this.GE.aga,hostName:this.GE.QEb,folderUrl:n.AFrameworkApplication.breadcrumbFolderUrl,folderName:n.AFrameworkApplication.breadcrumbFolderName}),this.gKb&&this.gKb.jaf&&(Y.hostUrl=this.gKb.PersonalFileStorageUrl),e.ULS.sendTraceTag(590964758,
202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(Y)),this.ODh&&this.mtf&&this.mtf.length&&(this.ZWj()?this.q_i():(this.tog("PersonalFileStorageInfoIsMissing",!1),this.fJh()),e.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}mZm(Y,Sa,Mb){let oc;oc=!1;const Oc=this.x$l();let nd="";this.j9.ZGa&&(this.Iki?(nd=oe.CSl(Sa),this.Iki=!1,e.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):
this.GE?Oc?nd=oe.pZm(Sa,this.GE):this.GE.N8l?(oc=!0,this.Zrf=!1,nd=oe.nZm(Sa,this.GE),e.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(oc=!0,nd=oe.CSl(Sa),e.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.GE.aga,["StorageServiceDisplayNameIsSet"]:!!this.GE.QEb})):(nd=oe.oZm(Sa.labelText),e.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));
Oc&&(nd+=oe.lZm(Sa,Mb,!nd)+(()=>{let Cd=this.GZm(Y,Mb);({u_h:oc}=Cd);return Cd})().returnValue);return{returnValue:oe.$9m(nd),u_h:oc}}GZm(Y,Sa){let Mb;Mb=!1;if(!this.y_h)return Mb=!0,e.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",u_h:Mb};let oc="",Oc="",nd="MenuTemplate";if(this.TEh)oc=oe.GSl(),this.TEh=!1,e.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(Y){try{const Cd=Sys.Serialization.JavaScriptSerializer.deserialize(Y,
!0);oc=this.FZm(Cd,Sa);e.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");n.AFrameworkApplication.buk&&"OneDrive"===this.cZa&&(Oc=oe.jZm(this.UOn,n.AFrameworkApplication.buk))}catch(Cd){e.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:Y}),oc=oe.GSl()}Mb=!0}else nd="MenuLoading",oc=oe.HZm(),e.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:oe.IZm(nd,oc)+Oc,
u_h:Mb}}FZm(Y,Sa){let Mb="";const oc=[];for(let nd=0;nd<Y.length;nd++){var Oc=Y[nd];let Cd="";if(Oc){const Zd=Oc.Title,we=Oc.AssetId;Oc=Oc.Thumbnails;we&&Zd&&Oc&&({LS:Oc,returnValue:Cd}=this.Kmn(Oc),Mb+=oe.VCf("jbtnNewTemplate"+nd,Zd,null,Oc,null,Cd,Sa,we))}oc[nd]=Cd}Y=new B.a(4,1,5E3,()=>{this.MCn(oc)},106);this.j9.K$b.Rb(Y);return Mb}pah(){this.Gdi=!0;this.j9.jVh.FY(this.kVh.TGc);this.Gdi=!1}get j9(){return this.dLa.value}get kVh(){return this.egf.value}get akm(){return this.jOb.value}get UOn(){return this.DPm.value}get cZa(){return this.gKb&&
this.gKb.jaf?this.gKb.kJm:this.ZPb.value}get y_h(){return this.wRm.value}}Object(c.a)(Jc,"CreateNewActor",null,[]);class jd{constructor(){this._initialized=!1;this.yli={}}j1(Y){this.k_l();return this.get(Y)}contains(Y){this.k_l();return Y.toString()in this.yli}k_l(){this._initialized||(this.AUm(),this._initialized=!0)}rTe(Y,Sa){this.yli[Y.toString()]=Sa}get(Y){return this.yli[Y.toString()]}}Object(c.a)(jd,"AIntlHelper",null,[]);class xd extends jd{constructor(){super()}AUm(){this.rTe(0,Object(ba.a)("OpenMenuEmptyMruMessage"));
this.rTe(1,Object(ba.a)("OpenMenuServerErrorMessage"));this.rTe(2,Object(ba.a)("Open"));this.rTe(3,Object(ba.a)("OpenMenuRecentDocuments"));this.rTe(4,Object(ba.a)("OpenMenuMoreOnHost"));this.rTe(5,Object(ba.a)("VoicedLoadingText"))}static get instance(){return xd.Qa||(xd.Qa=new xd)}static qVn(Y){return xd.instance.j1(Y)}}xd.Qa=null;Object(c.a)(xd,"MruActorIntlHelper",jd,[]);var Ad;(function(Y){Y[Y.success=0]="success";Y[Y.failure=1]="failure";Y[Y.spinner=2]="spinner";Y[Y.none=3]="none"})(Ad||(Ad=
{}));Object(c.b)("DisplayState",Ad);var de=a(15),De=a(773);class Le{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd){this.l8h=null;this.Pni=!0;this.zCh="";this.dSm=0;this.pSe=null;this.pei=3;this.eEh=new Map;this.udi=null;this.vFm="SaveAsWordDocx_32";this.A_n="SaveAsPowerPointPptx_32";this.K$m="SaveAsExcelXlsx_32";this.xoo="LayerDiagonalColorFluent_20";this.fno="DesktopArrowUpColorFluent_20";this.hEl="View all files";this.sCl="Open files from this device";this.gJn="Fetching recent files info...";this.fJn="Recently Opened";
this.Ljm="MruNoDataSection";this.hJn="MruSection";this.wx="SourceControlId";this.menuItemId="MenuItemId";this.Jjm="Mru";this.nVn=(we,Qe,kf,Vf,eg)=>{if(1==kf)return 32;if(!eg[this.wx]||!this.eEh.has(eg[this.wx]))return e.ULS.sendTraceTag(507605730,324,15,"Unable to get the url for the document"),2;eg[this.menuItemId]=this.eEh.get(eg[this.wx])[1];eg[this.wx]="";return this.Mw.$Ia.Ra(r.a.Mac,kf,eg,Vf)};this.QWh=(we,Qe,kf,Vf,eg)=>{if(!this.N$d)return 2;if(1===kf)return 32;eg.MenuItems=Object.assign(new mc.a,
{Id:"MruList",MenuSectionList:[],UpdateDynamically:!0});return this.qYn(eg,De.a.instance.uSe)};this.w2e=(we,Qe,kf,Vf,eg)=>1!==kf&&eg?this.rYn(eg):32;this.Ga=Zd;this.dLa=Y;this.lHb=Sa;this.QNm=Mb;this.wMm=oc;this.vMm=Oc;this.jOb=new Ja.a(()=>new tg.a(nd.value,null));this.aOm=new Ja.a(()=>new tg.a(Cd.value,Object(h.a)(this,this.eJn,"mruEventResultReceived")));this.Ga.getBooleanAppSetting("WacInTabOpenMRUIsEnabledForUiHost");this.Ga.getBooleanAppSetting("UiHostSupportsDocRebootFeatures")}eJn(Y,Sa){this.pSe=
Y;Sa||this.Zsm()}n5n(){const Y=this.Mw.$Ia;Y.ua(r.a.w2e,u.a.frame,this.w2e,96);Y.Ba(r.a.aWh,u.a.frame,this.nVn);Y.Ba(r.a.QWh,u.a.frame,this.QWh)}qYn(Y,Sa){(Sa=this.R4m(Sa))?(e.ULS.sendTraceTag(507605729,324,50,"Mru flyout data loaded successfully in file menu"),Y.MenuItems.MenuSectionList.push(Sa)):this.eYn(Y);Sa=this.l6m();Y.MenuItems.MenuSectionList.push(Sa);return 32}R4m(Y){if(Y){var Sa=this.XRi(this.hJn,!0);Y=JSON.parse(Y);this.eEh.clear();Y.forEach((Mb,oc)=>{this.eEh.set(this.Jjm+oc.toString(),
[Mb.FileName,Mb.DocumentUrl]);const Oc=this.$in(Mb.FileName);Sa.ControlList.push(Object.assign(new db.a,{ExternalId:this.Jjm+oc.toString(),Command:r.a.aWh,CommandValueId:r.a.aWh,LabelText:Oc,Alt:Mb.FileName,AriaDescription:Mb.FileName,ExternalImageId:this.Lhn(this.Mw.Z5),KeyTip:Mb.FileName}))});return Sa}}l6m(){const Y=this.XRi("ViewAllFilesAndUploadSection",!1);if(!this.Mgd){let Mb=this.tSl;var Sa=this.sSl;Mb&&Sa||!this.Mw.ZGa||(Sa=this.v3f.Qi("File Open",!1),3===Sa.state&&(Mb=Sa.aga));this.Mgd=
Mb}this.Mgd&&Y.ControlList.push(Object.assign(new db.a,{ExternalId:"btnViewMoreFiles",Command:r.a.lFa,CommandValueId:r.a.lFa,LabelText:this.hEl,Alt:this.hEl,AriaDescription:this.hEl,ExternalImageId:this.xoo,MenuItemId:this.Mgd}));Y.ControlList.push(Object.assign(new db.a,{ExternalId:"btnUploadDocument",Command:r.a.qCl,CommandValueId:r.a.qCl,LabelText:this.sCl,Alt:this.sCl,AriaDescription:this.sCl,ExternalImageId:this.fno}));return Y}XRi(Y,Sa){Sa=void 0===Sa?!1:Sa;return Object.assign(new Nc.a,{Title:Sa?
this.fJn:"",Id:Y,DisplayMode:"Menu",ShowMenuSectionSeparator:!0,ControlsId:"Ctrl_"+Y,ControlList:[]})}eYn(Y){e.ULS.sendTraceTag(507605728,324,50,"Mru data could not load in file menu flyout");Y.MenuItems.MenuSectionList.push(this.S4m())}S4m(){const Y=this.XRi(this.Ljm,!1);Y.ControlList.push(Object.assign(new db.a,{ExternalId:this.Ljm,LabelText:this.gJn}));return Y}$in(Y){return Y&&Y.length<=Le.lMl?Y:Y.substring(0,Le.lMl-3)+"..."}Lhn(Y){let Sa=this.vFm;switch(Y){case 3:Sa=this.vFm;break;case 2:Sa=
this.A_n;break;case 1:Sa=this.K$m}return Sa}rYn(Y){this.n$m();this.m$m();Y.PopulationXML=oe.a$m(this.zCh+this.l8h);return 32}n$m(){let Y=3,Sa=!1;if(this.zCh&&this.dSm===this.pSe.Hsl)e.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),Y=this.pei;else{e.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var Mb=this.Mw.getCurrentTime();this.pSe=this.dJn.Qi("File Open opened",
!0);if(this.zCh&&2!==this.pei&&3!==this.pSe.state)Sa=!0;else{const oc=this.iln(this.pSe);n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.wYa&&Gc.c()&&oc&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(oc,!0));this.zCh=(()=>{let Oc=this.Adn(this.pSe);({NOn:Y}=Oc);return Oc})().returnValue}Mb=this.Mw.getCurrentTime()-Mb;e.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:Mb})}2!==Y&&(Mb={["DisplayState"]:Ad[Y]},
1!==Y&&(Mb.IsStale=Sa),e.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Mb));this.pei=Y}iln(Y){let Sa;try{Sa=de.c(Y.xWg)}catch(Mb){Sa=null,e.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",Mb)}return Sa}m$m(){this.Pni?(e.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.l8h=(()=>{let Y=this.GHn();({Roo:this.Pni}=Y);return Y})().returnValue):e.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");
e.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.Pni,["NotDisplayingLink"]:!this.l8h})}Adn(Y){let Sa;1===Y.state||0===Y.state?(e.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),Y=2,Sa=oe.BSl(this.rKc(2),this.rKc(5))):3===Y.state&&Y.xWg?(Sa=this.kZm(Y.xWg),Y=0):(e.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),Sa=oe.gDf(this.rKc(1),this.rKc(2)),Y=1);return{returnValue:Sa,NOn:Y}}kZm(Y){let Sa;
const Mb=this.$Ug.QMd||"2155708348";if(Y.length){Sa=oe.eDf("lblRecentDocuments",this.rKc(3));let oc=0;for(let Oc=0;Oc<Y.length;Oc++){const nd=Y[Oc];"FileName"in nd&&"DocumentUrl"in nd&&"Path"in nd&&(Sa+=oe.VCf("MruButton"+Oc,nd.FileName.toString(),nd.Path.toString(),null,this.$Ug.TBa,this.$Ug.YLc,Mb,nd.DocumentUrl.toString()),nd.IsPinned&&oc++)}Sa=oe.IMd("RecentDocumentsMenuSection",oe.Kjm,this.rKc(2),Sa);e.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:Y.length,
["NumPinnedDocuments"]:oc})}else Sa=oe.gDf(this.rKc(0),this.rKc(2)),e.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return Sa}GHn(){let Y;Y=!0;let Sa=this.tSl;var Mb=this.sSl;if(Sa&&Mb||!this.Mw.ZGa)Y=!1;else{const oc=this.v3f.Qi("File Open",!1);3===oc.state&&(Sa=oc.aga,Mb=oc.QEb,Y=!1)}Mb=Mb?String.format(this.rKc(4),Mb):null;return{returnValue:oe.OYm(this.$Ug.QMd,Mb,Sa),Roo:Y}}Zsm(){this.Mw.jVh.FY(this.$Ug.TGc)}get Mw(){return this.dLa.value}get rKc(){return this.lHb.value}get $Ug(){return this.QNm.value}get tSl(){return this.wMm.value}get sSl(){return this.vMm.value}get v3f(){return this.jOb.value}get dJn(){return this.aOm.value}get N$d(){this.udi||
(this.udi=this.Ga?this.Ga.getBooleanAppSetting("IsO365CommercialHost")||this.Ga.getBooleanAppSetting("IsO365ConsumerHost"):!1);return this.udi}}Le.lMl=35;Object(c.a)(Le,"MruRenderer",null,[]);var Xe=a(181),ie=a(1135);class If{constructor(Y,Sa,Mb,oc,Oc,nd,Cd){this.GE=null;this.FNl=!1;this.Cgd=this.VIl=0;this.dJc=Zd=>{if(!this.GE&&3===Zd.state)this.GE=Zd;else if(2===Zd.state){this.FNl?e.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.v3f.Qi("NewDocumentFromStream",
!0),this.FNl=!0);return}this.LWl()};this.QOn=Zd=>{if(Zd&&Zd.data&&Zd.data.responseData){var we;let Qe=de.d(Zd.data.responseData);({NB:we}=Qe);Qe.returnValue?(Zd=we,Zd.StatusCode!==Xe.a.KB&&Zd.StatusCode!==Xe.a.sDc?(e.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.pXa,this.Cgd,Zd.StatusCode),this.wSe(null)):Zd.NewDocumentUrl&&""!==Zd.NewDocumentUrl?(e.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.pXa,this.Cgd,(new Date).getTime()-this.VIl),this.HPm(Zd.NewDocumentUrl)):(e.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.pXa,this.Cgd),this.wSe(null))):(e.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.pXa,this.Cgd,{["ResponseData"]:ie.a.xuh(Zd.data.responseData)}),this.wSe(null))}else e.ULS.sendTraceTag(24904473,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.pXa,this.Cgd),this.wSe(null)};this.POn=Zd=>{Zd&&Zd.data&&e.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.pXa,this.Cgd,Zd.data.status);this.wSe(null)};this.HPm=Y;this.wSe=Sa;this.fEh=Mb;this.egf=oc;this.ZPb=Oc;this.dLa=nd;this.jOb=new Ja.a(()=>new tg.a(Cd.value,this.dJc))}Kjd(){!this.GE&&this.Ytk.ZGa?this.v3f.Qi("NewDocumentFromStream",
!0):this.LWl()}LWl(){this.VIl=(new Date).getTime();var Y=this.gbn.ILf;if(null===Y)this.wSe(null);else{var Sa=this.fEh.menuItemId,Mb=this.fEh.wx,oc=this.fEh.sho,Oc=this.fEh.hbn;this.Cgd="streamBase64"===oc?Oc.length/1024:0;e.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.pXa,this.Cgd);var nd=(new Date).getTime();Y=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",Y,Eb.a.yj(this.cZa),Eb.a.yj(Sa),Eb.a.yj(this.pXa),
Eb.a.yj(n.AFrameworkApplication.lcid.toString()),Eb.a.yj(nd.toString()),Eb.a.yj(Mb),Eb.a.yj(n.AFrameworkApplication.ZC),n.AFrameworkApplication.Fh,Eb.a.yj(oc));Y+="&"+n.AFrameworkApplication.r5a();(Sa=this.GE?this.GE.aga:null)&&(Y+="&DestinationUrl="+Eb.a.yj(Sa));this.Ytk.aKb.ik(Y,2,Oc,{"Content-Type":"application/json; charset=utf-8"},!0,2,this.QOn,this.POn,null,void 0,void 0,void 0,void 0,"31")}}get pXa(){switch(this.Ytk.Z5){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";
case 5:return"VisioWAC"}return null}get gbn(){return this.egf.value}get cZa(){return this.ZPb.value}get Ytk(){return this.dLa.value}get v3f(){return this.jOb.value}}Object(c.a)(If,"NewDocumentFromStreamOperation",null,[]);class qf{constructor(Y,Sa,Mb,oc){this.egf=Y;this.ZPb=Sa;this.dLa=Mb;this.$Nm=oc}create(Y,Sa,Mb){return new If(Y,Sa,Mb,this.egf,this.ZPb,this.dLa,this.$Nm)}}Object(c.a)(qf,"NewDocumentFromStreamOperationFactory",null,[859]);var lf=a(363);class qe{get name(){return"Common.App.NewAndOpen.UX"}oc(Y){Y.register(qf,
"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").oa().pa(()=>new qf(new Ja.a(()=>n.AFrameworkApplication.Ha.Ib.a1f()),new Ja.a(()=>n.AFrameworkApplication.cZa),new Ja.a(()=>vb.a.instance.Db("Common.INewAndOpenCommonHelpers")),new Ja.a(()=>Object(Oe.b)())))}init(){n.AFrameworkApplication.ha.Wf(()=>{this.A0b()})}A0b(){const Y=lf.a.kH(vb.a.instance.eb("Common.INewAndOpenCommonHelpers")),Sa=lf.a.kH(Object(Oe.a)());
n.AFrameworkApplication.cZa&&Ld.Task.WAA.call(null,Y,Sa).continueWith(()=>{const Mb=new Jc(new Ja.a(()=>Y.result),new Ja.a(()=>n.AFrameworkApplication.Ha.Ib.a1f()),new Ja.a(()=>Sa.result),new Ja.a(()=>n.AFrameworkApplication.Ha.Ib.b1f().QMd||"1959943459"),new Ja.a(()=>n.AFrameworkApplication.cZa),new Ja.a(()=>n.AFrameworkApplication.e$l));Mb.Kb();Mb.pah()});if(n.AFrameworkApplication.i4e){const Mb=lf.a.kH(Qf());Ld.Task.WAA.call(null,Y,Sa,Mb).continueWith(()=>{const oc=new Le(new Ja.a(()=>Y.result),
new Ja.a(()=>xd.qVn),new Ja.a(()=>n.AFrameworkApplication.Ha.Ib.b1f()),new Ja.a(()=>n.AFrameworkApplication.qom),new Ja.a(()=>n.AFrameworkApplication.pom),new Ja.a(()=>Sa.result),new Ja.a(()=>Mb.result),n.AFrameworkApplication.ha);oc.n5n();oc.Zsm()})}}dispose(){}}Object(c.a)(qe,"UXPackageManager",null,[4,5,40]);class Ne extends za.a{constructor(){super();this.Ue=0;this.vg(1,Object(ba.a)("DialogClose"))}kE(Y){this.fE(Y,Object(ba.a)("DefaultDialogTitle"),Object(ba.a)("OneDriveContactError"),null)}Kkc(Y){this.fE(Y,
Object(ba.a)("DefaultDialogTitle"),Object(ba.a)("OneDriveContactError"),null,!0)}}Object(c.a)(Ne,"ErrorDialog",za.a,[836]);class pe{O1l(){e.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const Y=new gb.a;Y.lj("api.onedrive.com");return Y.task}}Object(c.a)(pe,"OneDriveConsumerEndpointHelper",null,[805]);var Wf=a(225);class ye{constructor(Y,Sa,Mb,oc){this.ODd=this.mac=null;this.Xji=this.Yji=!1;this.xSe=null;this.Ga=Y;this.FRe=Sa;this.yCd=Mb;this.Yea=oc}get yRl(){return this.FRe}get ha(){return this.Ga}dXe(){this.xSe||
(this.xSe=this.T1e?Od.a.create(this.T1e,null,null,null,!1):null);return this.xSe}setup(Y){this.ODd=Y;this.Yji||this.Xji?this.Yji&&this.ODd&&this.ODd(!0):(Y=this.dXe())?(this.Xji=!0,Y.K7a.continueWith(Sa=>{this.RSn(Sa)}),Qb.a.RK(Y)):(e.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.ODd(!1))}Gyk(Y){e.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",Y.Cj?Y.Cj.toString():"No error detail.")}RSn(Y){this.Xji=
!1;if(Y.Om)this.Gyk(Y),this.ODd(!1);else try{this.Yji=!0,e.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.eJj(),e.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.ODd(!0)}catch(Sa){e.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",Sa.toString()),this.ODd(!1)}}zph(Y){this.mac=Y;this.yCd?e.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(e.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(h.a)(this,this.qwk,"onApiReady")))}qwk(Y){Y?this.BPh():this.ZF()}ZF(){this.Yea().kE(Wf.a.iom)}px(Y){e.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.mac&&this.mac(!0,Y)}dispose(){this.xSe&&this.xSe.dispose()}}Object(c.a)(ye,"AOneDriveFilePickerApiManager",null,[870,40]);class Xf extends ye{constructor(Y,Sa,Mb,oc,Oc,nd){super(Sa,Mb,oc,nd);this.jq=null;this.bXa=Y;this.yRm=Oc}get T1e(){return this.ha.Ma("OneDriveApiUrl")}start(Y,Sa){this.jq=
Y;this.zph(Sa)}eJj(){WL.init(1===this.yRl||2===this.yRl?{["client_id"]:this.ha.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.ha.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}zph(Y){this.mac=Y;!this.yCd&&this.bXa.xeg?(e.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(h.a)(this,this.qwk,"onApiReady"))):(e.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.yRm())}BPh(){try{e.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.jq).then(Object(h.a)(this,this.px,"onSuccess"),Object(h.a)(this,this.$G,"onFailure"))}catch(Y){e.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Y,Y.stack),this.ZF()}}$G(Y){if(Y&&Y.error){if("user_canceled"===Y.error.code){e.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}e.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",Y.error.code,Y.error.message)}else e.ULS.sendTraceTag(17909060,
352,50,"File Dialog returned with no response");this.mac&&this.mac(!1,Y);this.ZF()}}Object(c.a)(Xf,"OneDriveFilePickerApiManagerV5",ye,[]);class uh extends ye{constructor(Y,Sa,Mb,oc,Oc){super(Y,Sa,Mb,oc);this.yDh=this.HMl=null;this.p1h=()=>{this.yDh.style.visibility="hidden"===this.yDh.style.visibility?"":"hidden"};this.DNm=Oc;this.options={};this.options.clientId=this.ha.Ma("OneDriveApiV7ClientId");this.options.cancel=this.p1h}get T1e(){return this.ha.Ma("OneDriveApiV72Url")}start(Y,Sa){this.yDh=
Sa;const Mb=this.DNm.O1l();Mb.continueWith(()=>{e.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.HMl=Mb.result;this.zph((oc,Oc)=>{this.p1h();Y(oc,Oc)})},3);Mb.continueWith(()=>{e.ULS.sendTraceTag(24134242,352,15,Mb.Cj.message);this.p1h()},5)}eJj(){this.options.success=Y=>{const Sa={};Sa.data=Y;this.px(Sa)};this.options.error=Y=>{const Sa={};Sa.error=Y;this.$G(Sa)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.HMl;this.options.advanced.iframeParentDiv=this.yDh}BPh(){try{e.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.p1h(),OneDrive.open(this.options)}catch(Y){e.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",Y.message),this.ZF()}}$G(Y){this.mac&&this.mac(!1,Y);this.ZF()}}Object(c.a)(uh,"OneDriveFilePickerApiManagerV7",ye,[]);class fg extends ye{constructor(Y,Sa,Mb,oc){super(Y,Sa,Mb,oc);this.ZLm=Y;this.options={};this.options.advanced=
{};this.options.action="query";this.options.clientId=this.ha.Ma("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get T1e(){return this.ha.Ma("OneDriveApiV72Url")}start(Y,Sa,Mb,oc){this.options.advanced.iframeParentDiv=Mb;this.options.advanced.endpointHint=oc;this.options.cancel=Sa;this.ZLm.getBooleanAppSetting("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.zph(Y)}zph(Y){this.mac=Y;this.yCd?e.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(e.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(h.a)(this,this.qwk,"onApiReady")))}eJj(){this.options.success=Y=>{const Sa={};Sa.data=Y;this.px(Sa)};this.options.error=Y=>{const Sa={};Sa.error=Y;this.$G(Sa)}}BPh(){try{e.ULS.sendTraceTag(23881879,216,50,
"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(Y){e.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",Y.message,Y.stack),this.ZF()}}Gyk(Y){e.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",Y.Cj?Y.Cj.toString():"No error detail.");Qb.a.Ltm(this.T1e);this.xSe=null}ZF(){this.Yea().Kkc(Wf.a.zwm)}$G(Y){this.mac&&this.mac(!1,Y)}}Object(c.a)(fg,"OneDriveFilePickerApiManagerV72",ye,[]);class pg{constructor(Y){this.olsSessionId=
this.value=this.key=null;this.olsSessionId=Y}}Object(c.a)(pg,"IExtraData",null,[]);class Kf extends fg{constructor(Y,Sa,Mb,oc){super(Y,Sa,Mb,oc);this.options.advanced.filter=Y.Ma("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=n.AFrameworkApplication.qGh;Y.getBooleanAppSetting("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=Y.Ma("OneDriveApiV72CommandMode")||"none");Y.getBooleanAppSetting("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new pg(n.AFrameworkApplication.userSessionId))}get T1e(){return this.ha.Ma("OneDriveApiV72Url")}BPh(){try{e.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",n.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(Y){e.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",Y.message,Y.stack),this.ZF()}}}Object(c.a)(Kf,"OneDriveFilePickerApiOpenManagerV72",fg,[]);class hh{constructor(Y){this.qH=null;this.Win=Sa=>{if(Sa.data.Je===Xe.a.GKb&&"X-NewKey"in Sa.data.gj){e.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const Mb={};Mb["X-Key"]=Sa.data.gj["X-NewKey"];this.N7k(Mb)}else 0<this.eji?(e.ULS.sendTraceTag(24134237,352,
50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.eji),this.eji--,this.N7k()):(e.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.qH.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};this.Xin=Sa=>{"PersonalFileStorageUrl"in Sa.data.gj&&""!==Sa.data.gj.PersonalFileStorageUrl?(e.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.qH.lj(Sa.data.gj.PersonalFileStorageUrl)):
(e.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.qH.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};this.Dn=Y;this.eji=3}O1l(){this.qH=new gb.a;e.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.N7k();return this.qH.task}N7k(Y){Y=void 0===Y?null:Y;const Sa=String.format("GetMoreInfoHandler.ashx?{0}",n.AFrameworkApplication.Yma);this.Dn.lZ(Sa,
1,null,Y,["PersonalFileStorageUrl","X-NewKey"],!1,2,this.Xin,this.Win,null,void 0,void 0,void 0,void 0,"21")}}Object(c.a)(hh,"OneDriveForBusinessEndpointHelper",null,[805]);var zh=a(482);class cg{constructor(){this.Oa=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}oc(Y){this.Oa=Y;this.Oa.register(Xf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").oa().pa(()=>new Xf(zh.a.instance,n.AFrameworkApplication.ha,
n.AFrameworkApplication.Qkc,n.AFrameworkApplication.WS,za.a.L_h,()=>new Ne));n.AFrameworkApplication.x2b?this.Oa.register(805,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").oa().pa(()=>new pe):this.Oa.register(805,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").oa().pa(()=>new hh(n.AFrameworkApplication.$d));this.Oa.register(uh,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").oa().pa(()=>new uh(n.AFrameworkApplication.ha,n.AFrameworkApplication.Qkc,
n.AFrameworkApplication.WS,()=>new Ne,vb.a.instance.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.Oa.register(fg,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").oa().pa(()=>new fg(n.AFrameworkApplication.ha,n.AFrameworkApplication.Qkc,n.AFrameworkApplication.WS,()=>new Ne));this.Oa.register(Kf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").oa().pa(()=>new Kf(n.AFrameworkApplication.ha,n.AFrameworkApplication.Qkc,n.AFrameworkApplication.WS,
()=>new Ne))}static main(){b.a.instance.Jc(new cg)}}Object(c.a)(cg,"PackageManager",null,[4,5]);var le=a(799),ke=a(158),ag=a(231);class Ef{constructor(Y){this.Cee=this.ijk=this.Mne=this.cSh=0;this.mhk=this.Lgm=null;this.jTn=Sa=>{"pen"!==Sa.pointerType||this.Mne||(this.Mne=Math.floor(this.PNf()/1E3),this.Mne<=this.cSh&&(this.Mne=this.cSh),this.ijk=0)};this.kTn=()=>{this.o6l()};this.X2d=(Sa,Mb)=>{0!==Mb.newState&&this.o6l()};this.fCn=()=>{0<this.Cee&&this.uxm(this.Cee);this.Cee=0};Y?(this.Yb=Y,this.PNf=
Date.now,this.Y4m(),this.g5n()):e.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}lbo(){this.Lgm="Office.PowerPoint.Online.Data.Activity.PenInputMinutes"}g5n(){window.document.body.addEventListener("pointerenter",this.jTn);window.document.body.addEventListener("pointerleave",this.kTn);Object(le.a)().execute(Y=>{Y.eid(this.X2d)})}o6l(){const Y=Math.ceil(this.PNf()/1E3);this.Mne&&Y>this.cSh&&(this.ijk=Y,this.Cee+=this.ijk-this.Mne);this.cSh=Y;this.Mne=
0}Y4m(){this.mhk=new B.a(4,2,6E4,this.fCn);this.Yb.Rb(this.mhk)}uxm(Y){const Sa=new ag.a;Sa.name=this.Lgm;const Mb=[];(Y=ke.a.yfa("PenInputSec",Y.toString(),3))&&Array.add(Mb,Y);Sa.dataFields=Mb;k.a.sendActivityEvent(Sa)}dispose(){0<this.Cee&&this.uxm(this.Cee);this.Yb.Sh(this.mhk)}}Object(c.a)(Ef,"PenMinutesManager",null,[803]);class lg{constructor(){this.whi=this.Oa=null}get name(){return"Common.App.PenMinutesManager"}oc(Y){this.Oa=Y;const Sa=n.AFrameworkApplication.Zd;this.Oa.register(803,"Common.App.PenMinutesManager.IPenMinutesManager").oa().pa(()=>
new Ef(Sa))}init(){this.whi=vb.a.instance.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.whi&&this.whi.dispose()}static main(){b.a.instance.Jc(new lg)}}Object(c.a)(lg,"PenMinutesManagerPackage",null,[4,5]);const Hf=()=>vb.a.instance.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),Lg=()=>vb.a.instance.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory");class Vg extends za.a{constructor(Y,Sa){super();this.zSe=!1;this.Ioa=null;this.f3k=Mb=>{1===Mb?(e.ULS.sendTraceTag(8194010,
216,50,"User click to retry button in error dialog."),this.Ioa?this.Aa.Ra(r.a.W8c,2,[this.Ioa,this.zSe]):this.Aa.Eb(r.a.W8c,2)):e.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")};this.Aa=Y;this.Qff=Sa;this.AEb=!1}kE(Y,Sa,Mb){this.Ioa=Sa;this.zSe=Mb;e.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",Y,Mb);Y=this.YHi(Y);0===Y?(this.Ue=6,this.vg(0,Object(ba.a)("DialogClose"))):(this.Ue=0,this.vg(1,Object(ba.a)("DialogClose")));0===Y&&e.ULS.sendTraceTag(8194009,
216,50,"Show standard error dialog.");this.fE(Wf.a.ywm,this.qgn(Y),this.pgn(Y,Sa),this.f3k,!0)}YHi(Y){return 0>Y||6<Y?(e.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",Y),0):Y}pgn(Y,Sa){Y=this.YHi(Y);return this.Qff?[Object(ba.a)("FailToSaveFile"),Object(ba.a)("InvalidFileNameAllowPercentOctothorpe"),Object(ba.a)("EmptyNameText"),Object(ba.a)("InvalidPermissionText"),String.format(Object(ba.a)("OverwriteTargetText"),Sa),Object(ba.a)("LockTargetText"),Object(ba.a)("InvalidFileNameDisallowPercentOctothorpe")][Y]:
[Object(ba.a)("FailToSaveFile"),Object(ba.a)("InvalidFileNameText"),Object(ba.a)("EmptyNameText"),Object(ba.a)("InvalidPermissionText"),String.format(Object(ba.a)("OverwriteTargetText"),Sa),Object(ba.a)("LockTargetText"),Object(ba.a)("InvalidFileNameText")][Y]}qgn(Y){Y=this.YHi(Y);return[Object(ba.a)("GeneralFailTitle"),Object(ba.a)("InvalidFileNameTitle"),Object(ba.a)("EmptyNameTitle"),Object(ba.a)("GeneralFailTitle"),Object(ba.a)("GeneralFailTitle"),Object(ba.a)("GeneralFailTitle"),Object(ba.a)("InvalidFileNameTitle")][Y]}}
Object(c.a)(Vg,"ErrorRetryDialog",za.a,[874]);class uf{constructor(Y,Sa){this.Ga=Y;this.Aa=Sa;this.Qff=this.Ga.getBooleanAppSetting("SaveToHostWithExtraCharsInFileName")}create(){return new Vg(this.Aa,this.Qff)}}Object(c.a)(uf,"ErrorRetryDialogFactory",null,[838]);class dg extends lb.a{constructor(Y,Sa,Mb,oc,Oc,nd,Cd){Cd=void 0===Cd?null:Cd;super();this.XGb=null;this.Aa=Sa;this.jjc=oc;this.Ehd=nd;this.Ga=Y;this.Yea=Oc;this.yo=Mb;this.Qff=this.Ga.getBooleanAppSetting("SaveToHostWithExtraCharsInFileName");
this.jq=Cd;this.vg(1,Object(ba.a)("SaveButtonLabel"))}get Ha(){return this.yo}s8m(Y,Sa){this.xY(1,!!Y&&Y!==Sa);this.XGb=document.getElementById(dg.n0l);bc.a.addHandler(this.XGb,"change",Object(h.a)(this,this.CVh,"onFileNameChange"));bc.a.addHandler(this.XGb,"input",Object(h.a)(this,this.CVh,"onFileNameChange"));this.XGb.focus()}fbn(Y){return this.Qff?(new RegExp("["+this.r_l('\\/:*?"<>|')+"]")).test(Y):(new RegExp("["+this.r_l('\\/:*?"<>|#{}%~&')+"]")).test(Y)}r_l(Y){return Y.replace(RegExp("[.*+?|()\\[\\]{}\\\\]",
"g"),"\\\\$&")}uon(){const Y=Eb.a.aca(n.AFrameworkApplication.Dz.LP);this.xY(1,!!this.XGb&&""!==this.XGb.value&&this.XGb.value!==Y)}CVh(){this.XGb&&window.setTimeout(()=>{this.uon()},0)}JVf(Y,Sa){if(1!==Y)e.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{Y=Sa[dg.n0l];Sa=dg.Com in Sa?Sa[dg.Com]:!1;e.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Eb.a.SXh(Y),Sa);const Mb=Eb.a.GJ(n.AFrameworkApplication.fileName);
(Y=Y?Y.trim():null)&&""!==Y&&""!==Mb||1===this.Ha.state?this.fbn(Y)?this.Yea.create().kE(1,Y,Sa):this.Ehd.O9(Y+Mb,Sa,this.jq):this.Yea.create().kE(2,Y,Sa)}}dispose(){this.XGb&&(bc.a.removeHandler(this.XGb,"change",Object(h.a)(this,this.CVh,"onFileNameChange")),bc.a.removeHandler(this.XGb,"input",Object(h.a)(this,this.CVh,"onFileNameChange")),this.XGb=null);super.dispose()}}dg.n0l="txtFileName";dg.Com="chkOverwrite";Object(c.a)(dg,"FileNameDialogBase",lb.a,[]);class Fg{static get Vl(){return lb.a.jU(Fg.Sx,
Object(ba.a)("SaveACopyFileName"),Object(ba.a)("SaveAsToHostOverwrite"))}}Fg.Sx="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(c.a)(Fg,"FileNameDialogHtml",null,[]);class Gh extends dg{constructor(Y,Sa,Mb,oc,Oc,nd){super(Y,Sa,Mb,oc,Oc,nd);this.Vl=Fg.Vl;this.rj="FileNameDialog-SaveAsToHost"}opb(Y,Sa){const Mb=Eb.a.aca(n.AFrameworkApplication.Dz.LP);Sa={["txtFileName"]:Y||Mb,["lblFolderName"]:Object(ba.a)("ToCurrentFolder"),["chkOverwrite"]:Sa};this.qp(Object(ba.a)("SaveAs"),Object(h.a)(this,this.JVf,"fileNameDialogHandler"),Sa);this.s8m(Y,Mb)}}Object(c.a)(Gh,"FileNameDialog",dg,[873]);class Vh{constructor(Y,Sa,Mb,oc,
Oc,nd){this.Aa=Sa;this.Ga=Y;this.jjc=oc;this.Ehd=nd;this.Yea=Oc;this.yo=Mb}create(){return new Gh(this.Ga,this.Aa,this.yo,this.jjc,this.Yea,this.Ehd)}}Object(c.a)(Vh,"FileNameDialogFactory",null,[837]);class Qg{constructor(Y,Sa,Mb){this.xwm=(oc,Oc,nd,Cd,Zd)=>Oc.contextId!==u.a.frame||oc!==r.a.W8c?2:this.Ga.getBooleanAppSetting("SaveAsToHostBrsIsEnabled")?1===nd?m.SessionStatusManager.instance.iPa||n.AFrameworkApplication.tna?8:32:2===nd?(e.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),
oc=this.xai.create(),Zd&&Object.getType(Zd)===Array&&2===Zd.length?oc.opb(Zd[0],!!Zd[1]):oc.opb(null,!1),32):8:8;this.Ehd=Mb;this.xai=Sa;this.Ga=Y}Kb(){2===n.AFrameworkApplication.Ha.Ib.Dm?n.AFrameworkApplication.ub.ua(r.a.W8c,u.a.frame,this.xwm,4):n.AFrameworkApplication.ub.Ba(r.a.W8c,u.a.frame,this.xwm)}}Object(c.a)(Qg,"SaveAsToHostActor",null,[]);class mh{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd){this.Rv=null;this.zSe=this.veb=!1;this.jq=this.Ioa=null;this.Fya=!1;this.Gxc=null;this.Ga=Sa;this.Meb=this.Ga.appSettings.SaveAsToHostWebServiceBase;
this.TKl=oc;this.f1a=Oc;this.Dn=Mb;this.Yea=nd;this.zo=Zd;this.yo=Cd;this.Aa=Y;this.xeb=Sa.Ma("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx";this.Fya=Sa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopyFileInNewTabEnabled",!1)}foh(){1!==this.yo.state&&(this.Rv=this.f1a(),this.Rv.message=Object(ba.a)("CommentProgressTooltip"),this.Rv.Ue=5,this.Rv.Vw=!1,this.Rv.SGa(Object(ba.a)("DefaultDialogTitle"),null,null))}EZa(Y){Y=void 0===Y?0:Y;1!==this.yo.state&&this.Yea.create().kE(Y,Eb.a.aca(this.Ioa),
this.zSe)}VCe(){const Y=this.Ga.appSettings.BreadcrumbFolderUrl;this.Fya?e.ULS.sendTraceTag(8194016,219,15,"UploadToHostManager.RedirectToFolder: Opening Saved Document Folder in new tab."):e.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");Lb.a.Go(Y,Lb.a.DJa(this.Fya?4:3),void 0,"UploadToHostManager.RedirectToFolder")}UCe(Y){let Sa=!1,Mb=!1;this.Ga&&(Sa=this.Ga.getBooleanAppSetting("SaveACopyIsEnabledForUiHost"),Mb=this.Ga.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"));
e.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url. IsEnabledForUiHost {0} uiHostSupportsFeature {1}",Sa,Mb);if(Sa&&Mb){e.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const oc={};oc[gf.a.Xnc]="1";oc[gf.a.documentUrl]=Y;oc[gf.a.reason]=Ve.a.zgh;n.AFrameworkApplication.ZP().execute(Oc=>{Oc.sendMessage(gg.a.RXa,oc)})}else Sa&&!Mb&&n.AFrameworkApplication.zgb||this.Fya?(this.Fya&&e.ULS.sendTraceTag(507594581,219,15,"UploadToHostManager.RedirectToEditUrl: Opening Saved Document URL in new tab."),
Lb.a.Go(Y,Lb.a.DJa(4),void 0,"UploadToHostManager.RedirectToEditUrl")):Lb.a.Go(Y,Lb.a.DJa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}O9(Y,Sa,Mb){Mb=void 0===Mb?null:Mb;e.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.TKl&&!this.TKl()&&this.Dn&&(this.zo&&(this.Gxc=this.zo.Xl("DialogShown","SaveAsToHostUploadTime")),this.foh(),this.zSe=Sa,this.Ioa=Y,(this.jq=Mb)&&"true"===this.jq.SkipSaveToHost?this.MJh():this.Hfb())}Hfb(){32!==this.Aa.Eb(r.a.Y8c,1)?(e.ULS.sendTraceTag(18989378,
219,15,"The save file change is not supported, this operation may exist data losting."),this.MJh()):this.Aa.Ra(r.a.Y8c,2,[()=>{e.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.MJh()},(Y,Sa)=>{e.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.EZa(Sa)}])}QUn(Y){this.EEc();this.veb=!1;if(Y&&Y.data&&Y.data.responseData){let Mb=de.d(Y.data.responseData);({NB:Sa}=Mb);if(Mb.returnValue)if(Y=
Sa,Y.StatusCode!==Xe.a.KB&&Y.StatusCode!==Xe.a.sDc){e.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var Sa={};Sa.FailureReason=Y.StatusCode.toString();Sa.ExtraInfo=Y.ExtraInfo;this.noc(Sa);this.EZa(parseInt(Y.ExtraInfo))}else{e.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.F0k();try{Y.NewDocumentUrl&&""!==Y.NewDocumentUrl?this.UCe(Y.NewDocumentUrl):this.VCe()}catch(oc){e.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",
oc.toString())}this.c4g()}else e.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:ie.a.xuh(Y.data.responseData)}),this.noc({["FailureReason"]:"Failed to deserialize response"}),this.EZa()}else e.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),this.noc({["FailureReason"]:"null response"}),this.EZa()}PUn(Y){5!==Y.data.status&&12!==Y.data.status||this.veb?(e.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",
{["Status"]:Y.data.status,["HttpStatus"]:Y.data.Je}),this.noc({["FailureReason"]:Y.data.Je.toString()}),this.EEc(),this.EZa(),this.c4g()):(e.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.veb=!0,this.jq&&"true"===this.jq.SkipSaveToHost?this.MJh():this.Hfb())}EEc(){this.Rv&&(this.Rv.close(),this.Rv=null)}c4g(){this.Gxc&&(this.Gxc.stop(),this.Gxc=null)}F0k(){this.jq&&"VersionHistory"===this.jq.SaveEntryPoint&&this.Aa.Eb(r.a.Udh,2)}noc(Y){this.jq&&"VersionHistory"===
this.jq.SaveEntryPoint&&this.Aa.Ra(r.a.EYh,2,Y)}MJh(){let Y=this.Meb+this.xeb;Y=td.a.xl(Y,"qs",Eb.a.yj(n.AFrameworkApplication.Fh));Y=td.a.xl(Y,"n",Eb.a.yj((new Date).getTime().toString()));Y=td.a.xl(Y,"ov",Eb.a.yj(this.zSe.toString()));Y=td.a.xl(Y,"fn",Eb.a.yj(this.Ioa));this.jq&&this.jq.FileDownloadUrl&&(Y=td.a.xl(Y,"furl",Eb.a.yj(this.jq.FileDownloadUrl)));this.Dn.ik(Y,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(h.a)(this,this.QUn,"onUploadFinished"),Object(h.a)(this,this.PUn,
"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(c.a)(mh,"UploadToHostManager",null,[823]);var Mf=a(1019);class Gg{constructor(){this.Oa=null;this.uu=()=>{n.AFrameworkApplication.ha.getBooleanAppSetting("SaveAsToHostBrsIsEnabled")&&vb.a.instance.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Kb()}}get name(){return"Common.App.SaveAsToHost"}init(){n.AFrameworkApplication.ha.Wf(this.uu)}oc(Y){this.Oa=Y;this.Oa.register(uf,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").pa(()=>
new uf(n.AFrameworkApplication.ha,n.AFrameworkApplication.ub)).oa();this.Oa.register(mh,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").pa(()=>new mh(n.AFrameworkApplication.ub,n.AFrameworkApplication.ha,n.AFrameworkApplication.$d,()=>n.AFrameworkApplication.Ch,()=>(new Mf.a).create(),Lg(),n.AFrameworkApplication.Ha,n.AFrameworkApplication.Ha.Iea)).oa();this.Oa.register(Vh,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").pa(()=>
new Vh(n.AFrameworkApplication.ha,n.AFrameworkApplication.ub,n.AFrameworkApplication.Ha,n.AFrameworkApplication.Ha.Ib,Lg(),Hf())).oa();this.Oa.register(Qg,"Common.App.SaveAsToHost.SaveAsToHostActor").pa(()=>new Qg(n.AFrameworkApplication.ha,vb.a.instance.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),Hf())).oa()}dispose(){}static main(){b.a.instance.Jc(new Gg)}}Object(c.a)(Gg,"SaveAsToHostPackage",null,[4,5]);const dh=()=>vb.a.instance.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
Jh=()=>vb.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),Wg=()=>vb.a.instance.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),Ra=()=>vb.a.instance.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),vc=()=>vb.a.instance.resolve("Common.App.SaveToSharePoint.IUploadToSharePointManager");var Uc=a(1246);class id extends za.a{constructor(){super();this.Ue=0;this.vg(1,Object(ba.a)("DialogClose"))}kE(Y,Sa){this.CYl(Y,Sa,Wf.a.Awm)}CYl(Y,
Sa,Mb){e.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Mb);this.fE(Mb,Y,Sa,null)}Kkc(Y,Sa){e.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.fE(Wf.a.Cwm,Y,Sa,null,!0)}}Object(c.a)(id,"ErrorDialog",za.a,[880]);const Jd=()=>vb.a.instance.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager");var $d=a(1707),re=a(36),Re=a(827),Be=a(1831);class rf{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;
this.saveLocations=this.scenario=null}}Object(c.a)(rf,"SaveAsDialogInput",null,[]);class qa{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(c.a)(qa,"SaveLocation",null,[]);class Fb{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we){this.Eei=null;this.Ioa="";this.ogn=()=>{const Qe=new N.a;Qe.add(this.Nfn());const kf=this.zln();kf&&Qe.addRange(kf);return Object.assign(new rf,{enableMoreLocations:!n.AFrameworkApplication.ha.getBooleanAppSetting("HideSaveToAnotherFolderButtonforUIHost"),
fileName:this.Ioa,extension:Eb.a.GJ(this.Gaa.LP),saveLocations:Qe.toArray(),scenario:this.ZGb?"SaveToSharePoint":"SaveToCloudStorage"})};this.Bji=Y;this.Yea=Sa;this.jq=we;this.Ehd=Mb;this.yo=Oc;this.Gaa=oc;this.lId=Cd;this.LSe=Zd;nd&&(this.Eei=new Ja.a(()=>new tg.a(nd.value,null)));this.ZGb=!(null!==this.jq&&this.jq.hasOwnProperty("caller")&&"SaveToCloudManager"===this.jq.caller.toString())}get OEm(){this.Hxc||(this.Hxc=Jd());return this.Hxc}get Hfg(){var Y;void 0===this.CJl&&(this.CJl=null===(Y=
n.AFrameworkApplication.ha)||void 0===Y?void 0:Y.getBooleanAppSetting("SaveAsDialogImprovementsEnabled"));return this.CJl}get Jin(){if(null!=this.hIl)var Y=this.hIl;else{var Sa;Y=this.hIl=null===(Sa=n.AFrameworkApplication.ha)||void 0===Sa?void 0:Sa.Ac("MaxSizeForMRUPathListInSaveAsDialog",4)}return Y}Nfn(){const Y=new $d.a(re.a.Co());let Sa=this.Gaa.breadcrumbFolderName,Mb=this.Gaa.breadcrumbBrandName;this.ZGb||null!=Sa&&""!=Sa||(Sa=Object(ba.a)("MyFiles"));this.Hfg&&Mb===Object(ba.a)("OneDriveName")&&
(Mb=Object(ba.a)("YourOneDrive"));Y.fa("type","currentHost");return Object.assign(new qa,{folderName:Sa,friendlyPath:Mb,properties:Y})}Eyn(Y){return!!Y&&"ClassicMru"===Y.type&&!!Y.service_info&&!!Y.service_info.service_id&&-1!==Y.service_info.service_id.indexOf("SHAREPOINT")}zln(){if(!this.Eei||!this.lId)return null;var Y=this.Eei.value.Qi("SaveAsToSharePointDialog",!1);if(!Y||3!==Y.state||!Y.DUh)return null;Y=Y.DUh;const Sa=new N.a;let Mb=0,oc=0;for(var Oc=0;Oc<Y.length&&!(this.Hfg&&Sa.count>=this.Jin);Oc++){var nd=
Y[Oc];if(this.ZGb&&!this.Eyn(nd))continue;Mb++;const Cd=nd.title,Zd=Re.b(nd,n.AFrameworkApplication.isRtl);if(!Cd||!Zd)continue;if(this.ZGb&&!nd.sharepoint_info)continue;const we=nd.url,Qe=this.ZGb?nd.sharepoint_info.site_url:null;if(!we||this.ZGb&&!Qe)continue;let kf="",Vf="";nd.onedrive_info&&(kf=nd.onedrive_info.drive_id,Vf=nd.onedrive_info.item_id);oc++;nd=new $d.a(re.a.Co());this.ZGb?nd.fa("type","SharePoint"):nd.fa("type","OneDrive");nd.fa("siteUrl",Qe);nd.fa("folderUrl",we);nd.fa("driveId",
kf);nd.fa("folderId",Vf);oc++;Sa.add(Object.assign(new qa,{folderName:Cd,friendlyPath:Zd,properties:nd}))}Oc=new Map;Oc.set("NumPlaces",Y.length.toString());Oc.set("NumSharepointPlaces",Mb.toString());Oc.set("placesWithMetadata",oc.toString());Rf.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",Ga.b.FailureBased,"smartfio",Oc);0<Mb&&(oc?.5>1*oc/Mb&&Rf.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Rf.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru",
"AllPlacesMetadataMissing",!1,!1,null));return Sa}ngn(){const Y={};Y.inputPropsCallback=this.ogn;return Y}opb(Y){this.Ioa=Y;this.Ioa||(this.Ioa=String.format(Object(ba.a)("SaveACopy_Filename"),Eb.a.aca(this.Gaa.LP)));if(this.ZGb||n.AFrameworkApplication.ha.getBooleanAppSetting("UserCanWriteRelative")){Y={["id"]:"SaveAsDialog",["bodyControls"]:this.ngn(),["dialogImprovementsEnabled"]:this.Hfg};var Sa=Object(ba.a)("SaveAs");2===this.yo.Ib.Dm&&(Sa=Object(ba.a)("SaveACopy"));this.Hfg&&(Sa=Object(ba.a)("CreateACopyOnline"));
var Mb=new lb.a(!1,!1,!0);Mb.Ue=1;Mb.rj="SaveAsDialog";Mb.vg(1,this.Hfg?Object(ba.a)("CreateACopy"):Object(ba.a)("SaveButtonLabel"));Mb.qp(Sa,Object(h.a)(this,this.r9n,"saveAsDialogHandler"),Y)}else e.ULS.sendTraceTag(507593120,216,50,"load file picker directly"),Y=Eb.a.GJ(this.Gaa.LP),this.jbm(this.Ioa,Y)}Qeo(Y,Sa){Y&&""!==Y&&""!==Sa||1===this.yo.state?this.U$l()?this.jbm(Y,Sa):this.ZGb?(""!==Sa&&(Y+=Sa),this.Bji.start(Y,this.jq)):(e.ULS.sendTraceTag(507593119,216,10,"Shared Picker not enabled"),
this.Yea.create().kE(0,Y,!1)):(e.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.Yea.create().kE(2,Y,!1))}jbm(Y,Sa){Rf.Health.instance.recordKpiUsage("SaveACopySFP",Ga.b.FailureBased,"smartfio",null);var Mb=this.ZGb?2:0;Mb=this.LSe.lIh(Object(ba.a)("PickerSaveACopyOkButton"),Object(ba.a)("PickerSaveACopyTitle"),!1,!0,!1,null,"SaveACopy",Mb);this.LSe.c1f(Mb).then(oc=>{if(oc&&0<oc.length){const Oc=oc[0][gf.a.Fpm]||"root",nd=oc[0][gf.a.Epm],
Cd=oc[0][gf.a.Gpm];oc=oc[0][gf.a.LWh];if(this.ZGb?""!==Cd&&""!==oc:""!==oc)this.ZGb?this.lId.O9(oc,Y+Sa,Cd,Oc,nd,this.jq):(e.ULS.sendTraceTag(507593118,216,50,"UploadToCloudManager called from shared"),this.OEm.O9(Oc,oc,Y+Sa,this.jq)),Rf.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.Yea.create().kE(0,Y,!1);const Zd=Be.a.Bx();Zd&&(Zd.set("FolderIdAvailable",""===Oc?"false":"true"),Zd.set("DriveIdAvailable",""===nd?"false":"true"),Zd.set("SiteUrlAvailable",""===Cd?"false":"true"),
Zd.set("FolderUrlAvailable",""===oc?"false":"true"));Rf.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign({},{extendedProperties:Zd}))}}else this.Yea.create().kE(0,Y,!1),Rf.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(oc=>{"Canceled"===oc?((oc=Be.a.Bx())&&oc.set("IsCanceled","true"),Rf.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign({},{extendedProperties:oc}))):Rf.Health.instance.recordKpiFailure("SaveACopySFP",
oc,!1,!1,null)})}U$l(){return this.LSe?this.LSe.bYj():(e.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}r9n(Y,Sa){if(Sa&&1===Y){Y=Sa.fileName;var Mb=Eb.a.GJ(this.Gaa.LP);Sa.moreLocationsSelected&&this.Qeo(Y,Mb);if(Sa.locationCallback)if(Sa=Sa.locationCallback())if(Sa.properties&&"currentHost"===Sa.properties.ka("type"))this.Ehd.O9(Y+Mb,!1,this.jq);else if(Sa.properties&&"SharePoint"===Sa.properties.ka("type")){var oc=Sa.properties.ka("folderId");var Oc=Sa.properties.ka("driveId");
var nd=Sa.properties.ka("siteUrl");Sa=Sa.properties.ka("folderUrl");this.lId.O9(Sa,Y+Mb,nd,oc,Oc,this.jq)}else Sa.properties&&"OneDrive"===Sa.properties.ka("type")?(nd=null===(Oc=Sa.properties)||void 0===Oc?void 0:Oc.ka("folderId"),Sa=null===(oc=Sa.properties)||void 0===oc?void 0:oc.ka("folderUrl"),e.ULS.sendTraceTag(507593117,216,50,"UploadToCloudManager called from dialog box"),this.OEm.O9(nd,Sa,Y+Mb,this.jq)):e.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back");else e.ULS.sendTraceTag(579179798,
216,10,"selected location is empty");else e.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(c.a)(Fb,"SaveAsDialog",null,[915]);class oa{constructor(Y,Sa,Mb,oc,Oc,nd,Cd){this.Ehd=Mb;this.Yea=Sa;this.yo=Y;this.bRm=oc;this.kPm=void 0===Oc?null:Oc;this.lId=void 0===nd?null:nd;this.LSe=void 0===Cd?null:Cd}create(Y){return new Fb(this.bRm,this.Yea,this.Ehd,n.AFrameworkApplication.Dz,this.yo,this.kPm,this.lId,this.LSe,Y)}}Object(c.a)(oa,"FileNameDialogFactory",null,[879]);class eb{constructor(Y,
Sa,Mb,oc){this.GE=this.iQb=null;this.dJc=Oc=>{this.GE||3!==Oc.state||(this.GE=Oc)};this.Myd=Y;this.yo=Mb;this.iQm=oc;this.jOb=new Ja.a(()=>new tg.a(Sa.value,this.dJc))}get U1e(){this.iQb||(this.jOb.value.Qi("Save As",!0),this.GE&&this.GE.aga&&this.GE.aga.length&&(this.iQb=this.Emj(this.GE.aga)));return this.iQb}start(Y){if(!this.U1e)if(n.AFrameworkApplication.breadcrumbFolderUrl&&n.AFrameworkApplication.breadcrumbFolderUrl.length)this.iQb=n.AFrameworkApplication.breadcrumbFolderUrl;else return e.ULS.sendTraceTag(23881884,
216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.GE),!1;const Sa=this.iQm();Sa.Ujl();const Mb=Sa.qnj();if(!Mb)return e.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.Myd.start((oc,Oc)=>{Sa.hide();Y(oc,Oc)},()=>{this.Nwk(Sa)},Mb,this.iQb);return!0}Nwk(Y){Y.hide();e.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}Emj(Y){Y=Y.toLowerCase();
Y.endsWith("/")||(Y+="/");const Sa=Y.indexOf("/documents/");return-1!==Sa?Y.substring(0,Sa+1)+"_layouts/15/onedrive.aspx":""}}Object(c.a)(eb,"OneDriveFilePickerHelper",null,[843]);class Bb extends lb.a{constructor(){super()}Ujl(){this.kxd="FilePickerDialog";this.Vl="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.rj="PickerDialog-MsoSp";this.showDialog("",null)}qnj(){return document.getElementById("FilePickerDiv")}X4(){}gJa(){}}Object(c.a)(Bb,"PickerDialog",lb.a,[842]);var $b=a(975);class tc{constructor(Y,
Sa,Mb,oc,Oc,nd,Cd){this.Ga=Y;this.xai=Mb;this.Aa=Sa;this.Bji=oc;this.Myd=Oc;this.Kgi=nd;this.DMm=Cd}Kb(){const Y=this.Myd.dXe();Y?Na.a.$y||this.Ga.getBooleanAppSetting("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.Aa.ua(r.a.lLb,u.a.frame,Object(h.a)(this,this.Mwm,"saveToSharePointActionDispatcher"),64):(Y.K7a.continueWith(Sa=>{Sa.Om&&this.Myd.Gyk(Sa)}),this.pHh()):e.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}pHh(){Qb.a.Fah(Object(h.a)(this,
this.Mwm,"saveToSharePointActionDispatcher"));Qb.a.AUd([new $b.a(r.a.lLb,u.a.frame,0)],this.Myd.dXe())}get pbe(){return this.Ga.getBooleanAppSetting("SaveToAnotherFolderBrsIsEnabled")}get FTl(){return this.Ga.getBooleanAppSetting("UserCanWriteRelative")}Mwm(Y,Sa,Mb,oc,Oc){return Sa.contextId!==u.a.frame||Y!==r.a.lLb?2:this.pbe&&(this.Kgi.U1e||this.FTl)?1===Mb?m.SessionStatusManager.instance.iPa||n.AFrameworkApplication.tna?8:this.DMm()?32:8:2===Mb?(e.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+
(Oc&&Oc.SaveEntryPoint&&"VersionHistory"===Oc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.FTl?(e.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.xai.create(Oc).opb(null)):(e.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.Bji.start(null,Oc)),32):8:8}}Object(c.a)(tc,"SaveToSharePointActor",null,[]);class xc{constructor(Y,Sa,Mb,oc){this.jq=this.pMl=null;this.lId=Y;this.Yea=Sa;this.Kgi=Mb;
this.yo=oc}start(Y,Sa){e.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.pMl=Y;this.jq=Sa;this.Kgi.start((Mb,oc)=>{this.processResponse(Mb,oc)})||this.Vjl()}processResponse(Y,Sa){Y?this.px(Sa):this.$G(Sa)}Vjl(){1!==this.yo.state&&this.Yea().Kkc(Object(ba.a)("DefaultDialogTitle"),Object(ba.a)("OneDriveContactError"))}px(Y){e.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");let Sa="",Mb="";Y&&Y.data&&Y.data.value&&Y.data.value.length&&
Y.data.value[0].parentReference?(Sa=Y.data.value[0].id,Mb=Y.data.value[0].parentReference.driveId,Sa&&Mb||e.ULS.sendTraceTag(508040406,216,15,"Picker return invalid data, folder id is null: {0}, drive id is null: {1}.",!Sa,!Mb)):e.ULS.sendTraceTag(508040405,216,15,"Picker return invalid data or empty parent reference.");if(Y&&Y.data&&Y.data.value&&Y.data.value.length&&Y.data.value[0].sharePoint){const oc=Y.data.value[0].sharePoint.url;Y=Y.data.value[0].sharePoint.listUrl;let Oc=null;if(oc&&(Oc=Y?
this.Dln(Y):this.Cln(oc))){this.lId.O9(oc,this.pMl,Oc,Sa,Mb,this.jq);return}e.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!oc,!Oc)}e.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.Vjl()}Cln(Y){Y.endsWith("/")||(Y+="/");let Sa=0;for(let Mb=0;Mb<Y.length;Mb++)if("/"===Y.charAt(Mb)&&5===++Sa)return Y.substr(0,Mb);return null}Dln(Y){Y.endsWith("/")&&(Y=Y.substring(0,Y.length-1));const Sa=
Y.lastIndexOf("/");return-1!==Sa?Y.substring(0,Sa):null}$G(Y){e.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");Y&&Y.error?e.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",Y.error.errorCode,Y.error.message):e.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.Vjl()}}Object(c.a)(xc,"SaveToSharePointManager",null,[841]);class cd{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe){this.Meb=Y;this.Ioa=Sa;this.XRe=
oc;this.pii=Zd;this.tkb=Mb;this.Oki=Oc;this.pjc=nd;this.bDh=Cd;this.xeb=we;this.jq=Qe}execute(Y,Sa){if(!n.AFrameworkApplication.Ch&&n.AFrameworkApplication.$d){var Mb={"Content-Type":"application/json; charset=utf-8"},oc=this.Meb+this.xeb;hb.a.DH("d6454864;54012657");n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForSharePointSaveAsHandler",!1)&&(Mb["X-UseGraphFileUploader"]="1",Mb["X-AADToken"]=n.AFrameworkApplication.$d.Q1);this.pjc&&(oc=td.a.xl(oc,
"fo",Eb.a.yj(this.pjc)));this.bDh&&(oc=td.a.xl(oc,"dr",Eb.a.yj(this.bDh)));oc=td.a.xl(oc,"fu",Eb.a.yj(this.tkb));oc=td.a.xl(oc,"su",Eb.a.yj(this.Oki));oc=td.a.xl(oc,"fn",Eb.a.yj(this.Ioa));oc=td.a.xl(oc,"n",Eb.a.yj((new Date).getTime().toString()));this.jq&&this.jq.FileDownloadUrl&&(oc=td.a.xl(oc,"furl",Eb.a.yj(this.jq.FileDownloadUrl)));oc=oc+"&"+this.pii;this.XRe&&this.XRe.length?oc=td.a.xl(oc,"fnn",Eb.a.yj(this.XRe)):e.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");e.ULS.sendTraceTag(23881920,
216,50,"Trying send SharePointSaveAsHandler.ashx request.");n.AFrameworkApplication.$d.ik(oc,1,"",Mb,!1,2,Y,Sa,null,void 0,void 0,void 0,void 0,"9")}}}Object(c.a)(cd,"SharePointSaveAsCaller",null,[878]);class od{constructor(Y){this.qHb=Y.appSettings.SaveAsToHostWebServiceBase;this.Ioa=Y.appSettings.FileName;this.xeb=Y.Ma("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(Y,Sa,Mb,oc,Oc,nd){return new cd(this.qHb,this.Ioa,Y,Sa,Mb,oc,Oc,n.AFrameworkApplication.Fh,this.xeb,nd)}}Object(c.a)(od,
"SharePointUploadCallerFactory",null,[840]);var sd=a(653);class wd{constructor(Y,Sa,Mb,oc,Oc){this.Rv=this.Dcf=null;this.i7h=!1;this.Aji=this.tkb=null;this.Fya=!1;this.oni=Sa;this.f1a=Mb;this.Yea=oc;this.yo=Oc;this.Aa=Y;this.Fya=n.AFrameworkApplication.ha?n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopyFileInNewTabEnabled",!1):!1}O9(Y,Sa,Mb,oc,Oc,nd){this.i7h=!1;e.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");
this.foh();this.tkb=Y;nd&&nd.SaveEntryPoint&&(this.Aji=nd.SaveEntryPoint);this.Dcf=this.oni.create(Y,Sa,Mb,oc,Oc,nd);nd&&"true"===nd.SkipSaveToHost?this.Hfb():this.mcn()}mcn(){const Y=()=>{e.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.Hfb()};32!==this.Aa.Ra(r.a.Y8c,2,[()=>{e.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.Hfb()},Y])&&Y()}Hfb(){e.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");
this.Dcf.execute(Object(h.a)(this,this.QTn,"onSaveToSharePointUploadFinished"),Object(h.a)(this,this.PTn,"onSaveToSharePointUploadFailed"))}QTn(Y){if(Y&&Y.data&&Y.data.responseData){var Sa;let Mb=de.d(Y.data.responseData);({NB:Sa}=Mb);if(Mb.returnValue)if(Sa.StatusCode!==Xe.a.KB&&Sa.StatusCode!==Xe.a.sDc)e.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",Y.data.status,Sa.StatusCode),Sa.StatusCode!==Xe.a.J0k&&this.IYl(Y.data.status)||(this.noc(Sa.StatusCode.toString()),
this.reo(Sa.StatusCode));else{e.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.F0k();try{Sa.NewDocumentUrl?this.UCe(Sa.NewDocumentUrl):this.VCe()}catch(oc){e.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",oc.toString())}}else e.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:ie.a.xuh(Y.data.responseData)}),this.iJh()||(this.noc("Failed to deserialize response"),this.coh())}else e.ULS.sendTraceTag(23881925,
216,10,"Upload failure. Response data is null"),this.iJh()||(this.noc("Unknown"),this.coh())}PTn(Y){Y&&Y.data?this.IYl(Y.data.status)||(e.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.noc(sd.a[Y.data.status]),this.coh()):(e.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.iJh()||(this.noc("Unknown"),this.coh()))}iJh(){if(!this.i7h)return e.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.i7h=!0,this.Hfb(),!0;e.ULS.sendTraceTag(23881931,216,10,
"Upload fail. Already retry once but still fail.");return!1}IYl(Y){e.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",Y);return this.iJh()}VCe(){this.Fya?e.ULS.sendTraceTag(23881933,216,15,"UploadToSharePointManager.RedirectToFolder: Opening Saved Document Folder in new tab."):e.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Lb.a.Go(this.tkb,Lb.a.DJa(this.Fya?4:3),void 0,"UploadToSharePointManager.RedirectToFolder")}UCe(Y){var Sa=!1;let Mb=!1;n.AFrameworkApplication.ha&&
(Sa=n.AFrameworkApplication.ha.getBooleanAppSetting("SaveACopyIsEnabledForUiHost"),Mb=n.AFrameworkApplication.ha.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"));e.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url. IsEnabledForUiHost {0}",Sa);if(Sa&&Mb){e.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const oc={};oc[gf.a.Xnc]="1";oc[gf.a.documentUrl]=Y;oc[gf.a.reason]=Ve.a.zgh;n.AFrameworkApplication.ZP().execute(Oc=>
{Oc.sendMessage(gg.a.RXa,oc)})}else Sa=this.Fya?4:3,this.Fya&&e.ULS.sendTraceTag(507594579,216,15,"UploadToSharePointManager.RedirectToEditUrl: Opening Saved Document URL in new tab."),Lb.a.Go(Y,Lb.a.DJa(Sa),void 0,"UploadToSharePointManager.RedirectToEditUrl")}foh(){this.yo&&1===this.yo.state||(this.Rv=this.f1a(),this.Rv.message=Object(ba.a)("CommentProgressTooltip"),this.Rv.Ue=5,this.Rv.Vw=!1,this.Rv.SGa(Object(ba.a)("DefaultDialogTitle"),null,null))}EEc(){this.Rv&&(this.Rv.close(),this.Rv=null)}coh(){this.ZF(Object(ba.a)("SaveFailedDialogTitle"),
Object(ba.a)("FailToSaveFile"))}Teo(){this.ZF(Object(ba.a)("NoSavePermissionDialogTitle"),Object(ba.a)("NoSavePermissionDialogMessage"))}ueo(){const Y=String.format(Object(ba.a)("SaveAsFileTooLargeMessage"),250);this.ZF(Object(ba.a)("SaveAsFileTooLargeTitle"),Y,Wf.a.wwm)}ZF(Y,Sa,Mb){Mb=void 0===Mb?Wf.a.Bwm:Mb;e.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",Y,Sa);this.EEc();1!==this.yo.state&&this.Yea().CYl(Y,Sa,Mb)}reo(Y){e.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",
Y);switch(Y){case Xe.a.COe:this.Teo();break;case Xe.a.J0k:this.ueo();break;default:this.coh()}}F0k(){this.Fya&&this.EEc();"VersionHistory"===this.Aji&&this.Aa.Eb(r.a.Udh,2)}noc(Y){this.Fya&&this.EEc();"VersionHistory"===this.Aji&&this.Aa.Ra(r.a.EYh,2,{["FailureReason"]:Y})}}Object(c.a)(wd,"UploadToSharePointManager",null,[839]);class Hd{constructor(){this.uhd=this.Sfi=this.Ofi=this.Oa=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}oc(Y){this.Oa=Y;this.Ofi=lf.a.kH(Object(Oe.a)());
this.Sfi=lf.a.kH(Qf());this.uhd=lf.a.kH(Object(Uc.a)());Ld.Task.WAA.call(null,this.Ofi,this.Sfi,this.uhd).continueWith(()=>{this.D4n()})}D4n(){this.Oa.register(od,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").pa(()=>new od(n.AFrameworkApplication.ha)).oa();this.Oa.register(wd,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").pa(()=>new wd(n.AFrameworkApplication.ub,
vb.a.instance.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Mf.a).create(),()=>new id,n.AFrameworkApplication.Ha)).oa();this.Oa.register(xc,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").pa(()=>new xc(vc(),()=>new id,Ra(),n.AFrameworkApplication.Ha)).oa();this.Oa.register(eb,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").pa(()=>new eb(Wg(),
new Ja.a(()=>this.Ofi.result),n.AFrameworkApplication.Ha,()=>new Bb)).oa();this.Oa.register(oa,"Common.App.SaveToSharePoint.FileNameDialogFactory").pa(()=>new oa(n.AFrameworkApplication.Ha,Lg(),Hf(),Jh(),new Ja.a(()=>this.Sfi.result),vc(),this.uhd?this.uhd.result:null)).oa();this.Oa.register(tc,"Common.App.SaveToSharePoint.SaveToSharePointActor").pa(()=>new tc(n.AFrameworkApplication.ha,n.AFrameworkApplication.ub,dh(),Jh(),Wg(),Ra(),()=>n.AFrameworkApplication.Ha.bjd)).oa();n.AFrameworkApplication.ha.getBooleanAppSetting("SaveToAnotherFolderBrsIsEnabled")&&
vb.a.instance.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Kb()}static main(){b.a.instance.Jc(new Hd)}}Object(c.a)(Hd,"PackageManager",null,[4,5]);const Wd=()=>vb.a.instance.resolve("Common.App.SaveToCloudStorage.ODCXStackOperationManager"),mb=()=>vb.a.instance.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),lc=()=>vb.a.instance.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Mc=()=>vb.a.instance.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
md=()=>vb.a.instance.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager");class ud extends za.a{constructor(){super();this.Ue=0;this.vg(1,Object(ba.a)("DialogClose"))}kE(Y){this.fE(Y,Object(ba.a)("DefaultDialogTitle"),Object(ba.a)("ErrorSavingToOneDrive"),null)}}Object(c.a)(ud,"ErrorDialog",za.a,[937]);class Qd{}Qd.default=0;Object(c.a)(Qd,"SaveToCloudErrorCodes",null,[]);class kb{}kb.voc="SaveToCloudStorage";kb.ZCb="SaveACopy";Object(c.a)(kb,"SaveToCloudStorageConstants",null,
[]);class Xb{constructor(Y,Sa,Mb,oc,Oc,nd,Cd){this.jq=null;this.zRm=Y;this.bXa=Sa;this.Hxc=Mb;this.Ga=oc;this.FRe=Oc;this.Yea=nd;this.Mnf=Cd}get q9n(){this.BNl||(this.BNl=dh());return this.BNl}start(Y){this.jq=Y;this.Mnf.jaf?this.Mnf.Start(Y):(Y=null!==this.jq&&this.jq.hasOwnProperty("SaveEntryPoint")&&this.jq.SaveEntryPoint.toString()===kb.voc,this.bXa.xeg?(Object(G.a)(String,n.AFrameworkApplication.rd.Host),n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib&&1===n.AFrameworkApplication.Ha.Ib.Dm&&
Y?(e.ULS.sendTraceTag(508852051,216,15,"User is signed in. We will initiate a save for this file to user's root OneDrive location"),this.Hxc.O9("root","https://onedrive.live.com",null,this.jq)):(e.ULS.sendTraceTag(6590559,216,n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib&&1===n.AFrameworkApplication.Ha.Ib.Dm?15:50,"User is signed in. We will show file picker."),null!==this.jq&&this.jq.hasOwnProperty("showSaveAsDialog")&&"true"===this.jq.showSaveAsDialog?this.B_m():this.pTl())):(e.ULS.sendTraceTag(6590560,
216,n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib&&1===n.AFrameworkApplication.Ha.Ib.Dm?15:50,"User is not signed in. We will show sign in dialog."),this.ffo()))}B_m(){this.jq.caller="SaveToCloudManager";const Y=this.q9n.create(this.jq);Y.U$l()?(e.ULS.sendTraceTag(507646752,216,50,"Call SaveAs dialog box"),Y.opb(null)):(e.ULS.sendTraceTag(507646753,216,50,"SharedSaveACopyPicker not enabled"),this.pTl())}ffo(){this.zRm.create().opb()}ZF(){this.Yea().kE(Qd.default)}pTl(){try{e.ULS.sendTraceTag(6590561,
216,50,"Initializing OneDrive API");let Y={["client_id"]:this.Ga.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.FRe||2===this.FRe)Y={["client_id"]:this.Ga.appSettings.UploadToSkyDriveClientId};WL.init(Y);e.ULS.sendTraceTag(6590562,216,n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib&&1===n.AFrameworkApplication.Ha.Ib.Dm?15:50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(h.a)(this,this.px,"onSuccess"),
Object(h.a)(this,this.$G,"onFailure"))}catch(Y){e.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Y,Y.stack),this.ZF()}}px(Y){e.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");Y&&Y.data&&Y.data.folders&&this.Hxc.O9(Y.data.folders[0].id,Y.data.folders[0].urls.viewInBrowser,null,this.jq)}$G(Y){if(Y&&Y.error){if("user_canceled"===Y.error.code){e.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");
return}e.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",Y.error.code,Y.error.message)}else e.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.ZF()}}Object(c.a)(Xb,"SaveToCloudManager",null,[936]);class sc{constructor(Y,Sa,Mb,oc){this.CEh=null;this.aRm=Y;this.Ga=Mb;this.IMl=Sa;this.JLl=new gb.a;this.zo=oc}pbe(){return this.Ga.getBooleanAppSetting("SaveToCloudStorageUIIsEnabled")}D1l(){return r.a.voc}get qyn(){return null!=
this.iIl?this.iIl:this.iIl=(()=>{var Y;return null===(Y=this.Ga)||void 0===Y?void 0:Y.getBooleanAppSetting("SaveAsDialogEnabledForOneDrive")})()}pHh(){Qb.a.Fah(Object(h.a)(this,this.Lwm,"saveToCloudActionDispatcher"));Qb.a.AUd([new $b.a(r.a.voc,u.a.frame,0)],this.IMl.dXe())}Kb(){const Y=this.IMl.dXe();Y?(Y.s$(()=>{this.JLl.lj(!0)}),this.pHh()):e.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}Psm(){e.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}Lwm(Y,
Sa,Mb,oc,Oc){oc=n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib&&1===n.AFrameworkApplication.Ha.Ib.Dm;var nd="";switch(Y){case r.a.voc:nd=kb.voc;break;case r.a.ZCb:nd=kb.ZCb;break;default:e.ULS.sendTraceTag(508372377,216,50,"SaveToCloudStorageActor Entry Point other than SaveToCloudStorage or SaveACopy")}if(Sa.contextId!==u.a.frame||Y!==this.D1l())return 2;if(!this.pbe())return 8;if(1===Mb)return m.SessionStatusManager.instance.iPa||n.AFrameworkApplication.tna?8:32;if(2===Mb){this.Psm();
let Cd=oc&&nd===kb.voc&&null===Oc?{}:Oc;Cd&&(Cd.SaveEntryPoint=nd);Cd&&Cd.FileDownloadUrl&&e.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there");this.qyn&&nd===kb.ZCb&&(null==Cd&&(Cd={}),Cd.showSaveAsDialog="true");this.zo&&(this.CEh=this.zo.Xl("DialogShown","SaveToOneDriveReponseTime"));this.JLl.task.continueWith(()=>{this.CEh&&(this.CEh.stop(),this.CEh=null);this.aRm.start(Cd)});return 32}return 8}}Object(c.a)(sc,"SaveToCloudStorageActor",null,[893]);var Rc=a(198);
class Zc extends za.a{constructor(Y,Sa,Mb){super();this.tvn=oc=>{0===oc?(e.ULS.sendTraceTag(6590598,216,n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib&&1===n.AFrameworkApplication.Ha.Ib.Dm?15:50,"User dismissed SignIn Dialog."),this.hide()):this.Wwe()};this.unm=()=>{this.sU&&this.hide();e.ULS.sendTraceTag(7143885,216,n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib&&1===n.AFrameworkApplication.Ha.Ib.Dm?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");
this.Aa.Eb(r.a.voc,2)};this.Aa=Y;this.bXa=Sa;this.jjc=Mb;this.j$=!1;this.Ue=1;this.scb(1);this.vg(1,Object(ba.a)("SignIn"));this.vg(0,Object(ba.a)("SignInToSaveDialogCancelButton"))}opb(){this.bXa.DFh(this.unm);this.GC(Object(ba.a)("SignInToSaveDialogTitle"),Object(ba.a)("SaveToCloudSignInDialog"),0,this.tvn)}k0m(){let Y="2";if(this.jjc)switch(this.jjc.Dm){case 3:Y="0";break;case 2:Y="3";break;case 1:Y="1"}return Y}hide(){this.bXa.Qtm(this.unm);super.hide()}Wwe(){var Y=n.AFrameworkApplication.ha.getBooleanAppSetting("SignInAspxInWebAppsPortalIsEnabled")?
"/start/signin.aspx":"Signin.aspx";Y=new Rc.QueryStringBuilder(Y);Y.ej("prompt","1");Y.ej("cbcxt",this.k0m());n.AFrameworkApplication.Peb(Y);Lb.a.Go(Y.toString(),"LoginWindow",void 0,"SignInDialog")}}Object(c.a)(Zc,"SignInDialog",za.a,[918]);class Id{constructor(Y,Sa,Mb){this.Aa=Y;this.bXa=Sa;this.jjc=Mb}create(){return new Zc(this.Aa,this.bXa,this.jjc)}}Object(c.a)(Id,"SignInDialogFactory",null,[887]);class Td{constructor(Y,Sa,Mb,oc,Oc,nd,Cd){this.Meb=Y;this.Ioa=Sa;this.XRe=Mb;this.pjc=oc;this.pii=
Oc;this.xeb=nd;this.jq=Cd}execute(Y,Sa){if(!n.AFrameworkApplication.Ch&&n.AFrameworkApplication.$d){var Mb={"Content-Type":"application/json; charset=utf-8"};hb.a.DH("ib994913;b48ce942");var oc=n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForSkyDriveUploadHandler",!1),Oc=n.AFrameworkApplication.$d.Q1,nd=!!Oc,Cd=oc&&nd;Cd?(Mb["X-UseGraphFileUploader"]="1",Mb["X-AADToken"]=Oc):(this.Meb="/start/",this.xeb.startsWith("/start/")&&(this.xeb=this.xeb.substring(7)));
e.ULS.sendTraceTag(507908319,216,50,"Use GraphFileUploader:{0}, flight enabled:{1}, token available:{2}",Cd,oc,nd);oc=this.Meb+this.xeb;oc=td.a.xl(oc,"fo",Eb.a.yj(this.pjc));oc=td.a.xl(oc,"fn",Eb.a.yj(this.Ioa));oc=td.a.xl(oc,"qs",Eb.a.yj(this.pii));oc=td.a.xl(oc,"n",Eb.a.yj((new Date).getTime().toString()));this.jq&&this.jq.FileDownloadUrl&&(oc=td.a.xl(oc,"furl",Eb.a.yj(this.jq.FileDownloadUrl)));this.XRe&&(oc=td.a.xl(oc,"fnn",Eb.a.yj(this.XRe)));n.AFrameworkApplication.$d.ik(oc,1,"",Mb,!1,2,Y,Sa,
null)}}}Object(c.a)(Td,"SkyDriveUploadCaller",null,[917]);class he{constructor(Y){this.Ga=Y;this.qHb=Y.appSettings.SkyDriveUploadWebServiceBase;this.Ioa=Y.appSettings.FileName;this.xeb=Y.Ma("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(Y,Sa,Mb){return new Td(this.qHb,this.Ioa,Sa,Y,n.AFrameworkApplication.Fh,this.xeb,Mb)}}Object(c.a)(he,"SkydriveUploadCallerFactory",null,[886]);class be{constructor(Y,Sa,Mb,oc,Oc){this.tkb=this.Rv=this.Dcf=null;this.Fya=this.veb=!1;this.jq=this.Gxc=
null;this.oni=Y;this.f1a=Sa;this.Yea=Mb;this.yo=oc;this.zo=Oc;this.Fya=n.AFrameworkApplication.ha?n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopyFileInNewTabEnabled",!1):!1}foh(){this.yo&&1===this.yo.state||(this.Rv=this.f1a(),this.Rv.message=Object(ba.a)("CommentProgressTooltip"),this.Rv.Ue=5,this.Rv.Vw=!1,this.Rv.SGa(Object(ba.a)("DefaultDialogTitle"),null,null))}EEc(){this.Rv&&(this.Rv.close(),this.Rv=null)}EZa(){1!==n.AFrameworkApplication.Ha.state&&this.Yea().kE(Qd.default)}VCe(){this.Fya?
e.ULS.sendTraceTag(6590599,216,15,"UploadToCloudManager.RedirectToFolder: Opening Saved Document Folder URL in new tab."):e.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");Lb.a.Go(this.tkb,Lb.a.DJa(this.Fya?4:3),void 0,"UploadToCloudManager.RedirectToFolder")}UCe(Y){var Sa=null!==this.jq&&this.jq.hasOwnProperty("SaveEntryPoint")&&this.jq.SaveEntryPoint.toString()===kb.voc;n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib&&1===n.AFrameworkApplication.Ha.Ib.Dm&&Sa&&(Y+="&wdsvodm=true");
let Mb=Sa=!1;n.AFrameworkApplication.ha&&(Sa=n.AFrameworkApplication.ha.getBooleanAppSetting("SaveACopyIsEnabledForUiHost"),Mb=n.AFrameworkApplication.ha.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"));e.ULS.sendTraceTag(6654163,216,n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib&&1===n.AFrameworkApplication.Ha.Ib.Dm?15:50,"Redirecting to edit url. IsEnabledForUiHost {0}",Sa);if(Sa&&Mb){e.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const oc={};oc[gf.a.Xnc]="1";oc[gf.a.documentUrl]=Y;n.AFrameworkApplication.ZP().execute(Oc=>{Oc.sendMessage(gg.a.RXa,oc)})}else Sa=this.Fya?4:3,this.Fya&&e.ULS.sendTraceTag(507594583,216,15,"UploadToCloudManager.RedirectToEditUrl: Opening Saved Document URL in new tab."),Lb.a.Go(Y,Lb.a.DJa(Sa),void 0,"UploadToCloudManager.RedirectToEditUrl")}O9(Y,Sa,Mb,oc){Mb=void 0===Mb?null:Mb;oc=void 0===oc?null:oc;e.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.zo&&(this.Gxc=this.zo.Xl("DialogShown",
"SaveToOneDriveUploadTime"));this.foh();this.tkb=Sa;this.Dcf=this.oni.create(Y,Mb,oc);this.jq=oc;this.Hfb()}Hfb(){e.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.Dcf.execute(Object(h.a)(this,this.OTn,"onSaveToCloudUploadFinished"),Object(h.a)(this,this.NTn,"onSaveToCloudUploadFailed"))}OTn(Y){this.EEc();this.veb=!1;if(Y&&Y.data&&Y.data.responseData){var Sa;let Mb=de.d(Y.data.responseData);({NB:Sa}=Mb);if(Mb.returnValue)if(Y=Sa,Y.StatusCode!==Xe.a.KB&&Y.StatusCode!==Xe.a.sDc)e.ULS.sendTraceTag(6590602,
216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.EZa();else{e.ULS.sendTraceTag(6590603,216,n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib&&1===n.AFrameworkApplication.Ha.Ib.Dm?15:50,"UploadToCloudManager upload success.");try{Y.NewDocumentUrl&&""!==Y.NewDocumentUrl?this.UCe(Y.NewDocumentUrl):this.VCe()}catch(oc){e.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",oc.toString())}this.c4g()}else e.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",
{["ResponseData"]:ie.a.xuh(Y.data.responseData)}),this.EZa()}else e.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.EZa()}NTn(Y){5!==Y.data.status&&12!==Y.data.status||this.veb?(e.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",Y.data.status),this.EEc(),this.EZa(),this.c4g()):(e.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.veb=!0,this.Hfb())}c4g(){this.Gxc&&(this.Gxc.stop(),this.Gxc=
null)}}Object(c.a)(be,"UploadToCloudManager",null,[885]);class Ue{constructor(Y){this.Ga=Y;this.Meb=Y.appSettings.SkyDriveUploadWebServiceBase;this.xeb=Y.Ma("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx";Y.Wf(()=>{this.lIm()})}get jaf(){if(!this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseODCXStackOperationManager",!1)||!this.fhd)return!1;var Y=this.Ga.Ma("FileSource");return!Y||"SharePointOnlineConsumer"!=Y&&"OneDriveWOPI"!=Y?!1:Y!=this.fhd||"SharePointOnlineConsumer"==Y}get kJm(){return"OneDriveWOPI"==
this.fhd?"OneDriveWopi":"SharePointOnlineConsumer"==this.fhd?"SharePoint":n.AFrameworkApplication.cZa}get PersonalFileStorageUrl(){return this.gQm}Start(Y){Object(Uc.a)().execute(Sa=>{const Mb=Sa.lIh(Object(ba.a)("PickerSaveACopyOkButton"),Object(ba.a)("PickerSaveACopyTitle"),!1,!0,!1,null,"SaveACopy",0);Sa.c1f(Mb).then(oc=>{oc&&0<oc.length?(e.ULS.sendTraceTag(507867474,216,50,"Got data from file picker"),oc=oc[0],(new mf(Y,this.fhd,oc.id,oc.name,oc.url,oc.driveId,oc.siteUrl,this.vJm)).opb()):e.ULS.sendTraceTag(507867473,
216,10,"Got null/empty data from file picker")}).catch(oc=>{e.ULS.sendTraceTag(507867472,216,50,"File picker failed with error {0}",oc)})})}vJm(Y,Sa,Mb,oc,Oc,nd,Cd,Zd){"OneDriveWOPI"==Y?mb().O9(Mb,Oc,Sa,Zd):vc().O9(Oc,Sa,Cd,Mb,nd,Zd)}lIm(){var Y=this.Ga.Ma("FileSource");this.fhd=Y;if("SharePointOnlineConsumer"==Y||"OneDriveWOPI"==Y){var Sa=this.Ga.Ma("LoggableUserId");if(this.Ga.Ma("LoggableOwnerId")!=Sa||"OneDriveWOPI"!=Y){Y=null;"MsaCid"==n.AFrameworkApplication.ha.Ma("LoggableUserIdSpace")?Y=Sa:
"Windows Live"==n.AFrameworkApplication.ha.Ma("PresenceProvider")&&(Y=n.AFrameworkApplication.ha.Ma("PresenceUserId"));Sa=this.Meb+this.xeb;var Mb={};Mb.Cid=Y;n.AFrameworkApplication.$d.ik(Sa+"?cpfsi=1",1,"",Mb,!1,2,oc=>{this.gQm=oc.data.gj.PersonalFileStorageLocation;this.fhd=oc.data.gj.PersonalFileStorageHost},()=>{},null,null,!1,1E4,2E4,"CheckConvergedUserStatus",null,!1,null,["PersonalFileStorageLocation","PersonalFileStorageHost"])}}}}Object(c.a)(Ue,"ODCXStackOperationManager",null,[]);class cf{static get Vl(){return lb.a.jU(cf.Sx,
Object(ba.a)("SaveACopyFileName"))}}cf.Sx="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(c.a)(cf,"FileNameDialogHtml",null,[]);class mf extends lb.a{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd){super();this.pjc=
this.tkb=null;this.vg(1,Object(ba.a)("SaveButtonLabel"));this.Vl=cf.Vl;this.rj="FileNameDialog-SaveACopy";this.jq=Y;this.fhd=Sa;this.fK=Zd;this.pjc=Mb;this.tkb=Oc;this.Oki=Cd;this.oKl=oc;this.bDh=nd}opb(){const Y={["txtFileName"]:Eb.a.aca(n.AFrameworkApplication.Dz.LP),["lblFolderName"]:String.format(Object(ba.a)("DestinationFolder"),this.oKl)};this.qp(Object(ba.a)("SaveToOneDrive"),Object(h.a)(this,this.JVf,"fileNameDialogHandler"),Y);e.ULS.sendTraceTag(507867471,216,50,"The file name dialog is initialized and shown.");
document.getElementById("txtFileName").focus()}JVf(Y,Sa){1!==Y?e.ULS.sendTraceTag(507867470,216,50,"User clicked cancel to cancel upload file in file name dialog."):(Y=Sa.txtFileName.trim(),e.ULS.sendTraceTag(507867469,216,50,"User clicked save to upload file with new name."),Sa=Eb.a.GJ(n.AFrameworkApplication.fileName),Y&&""!==Y&&""!==Sa&&(Y+=Sa),this.fK(this.fhd,Y,this.pjc,this.oKl,this.tkb,this.bDh,this.Oki,this.jq))}}Object(c.a)(mf,"FileNameDialog",lb.a,[]);class ig{constructor(){this.Oa=null}get name(){return"Common.App.SaveToCloudStorage"}init(){n.AFrameworkApplication.ha.getBooleanAppSetting("SaveToCloudStorageUIIsEnabled")&&
vb.a.instance.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Kb()}dispose(){}oc(Y){this.Oa=Y;this.Oa.register(Id,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").pa(()=>new Id(n.AFrameworkApplication.ub,zh.a.instance,n.AFrameworkApplication.Ha.Ib)).oa();this.Oa.register(he,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").pa(()=>new he(n.AFrameworkApplication.ha)).oa();
this.Oa.register(sc,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").pa(()=>new sc(vb.a.instance.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),md(),n.AFrameworkApplication.ha,n.AFrameworkApplication.Ha.Iea)).oa();this.Oa.register(be,"Common.App.SaveToCloudStorage.UploadToCloudManager").pa(()=>new be(Mc(),()=>(new Mf.a).create(),()=>new ud,n.AFrameworkApplication.Ha,n.AFrameworkApplication.Ha.Iea)).oa();this.Oa.register(Xb,"Common.App.SaveToCloudStorage.SaveToCloudManager").pa(()=>
new Xb(lc(),zh.a.instance,mb(),n.AFrameworkApplication.ha,n.AFrameworkApplication.Qkc,()=>new ud,Wd())).oa();this.Oa.register(Ue,"Common.App.SaveToCloudStorage.ODCXStackOperationManager").pa(()=>new Ue(n.AFrameworkApplication.ha)).oa()}static main(){b.a.instance.Jc(new ig)}}Object(c.a)(ig,"PackageManager",null,[4,5]);class ug{static get Vl(){return lb.a.jU(ug.Sx,Object(ba.a)("SaveACopyFileName"))}}ug.Sx="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(c.a)(ug,"FileNameDialogHtml",null,[]);class Pf extends lb.a{constructor(Y,Sa,Mb,oc){super();this.pjc=this.tkb=null;this.Aa=Y;this.jjc=Sa;this.Hxc=Mb;this.vg(1,Object(ba.a)("SaveButtonLabel"));this.Vl=ug.Vl;this.rj="FileNameDialog-SaveACopy";this.jq=oc}opb(Y,Sa,Mb){this.pjc=Y;this.tkb=Mb;Y={["txtFileName"]:Eb.a.aca(n.AFrameworkApplication.Dz.LP),["lblFolderName"]:String.format(Object(ba.a)("DestinationFolder"),Sa)};this.qp(Object(ba.a)("SaveToOneDrive"),Object(h.a)(this,this.JVf,"fileNameDialogHandler"),
Y);e.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}JVf(Y,Sa){1!==Y?e.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(Y=Sa.txtFileName.trim(),e.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),Sa=Eb.a.GJ(n.AFrameworkApplication.fileName),Y&&""!==Y&&""!==Sa&&(Y+=Sa),this.Hxc.O9(this.pjc,this.tkb,Y,this.jq))}}Object(c.a)(Pf,"FileNameDialog",
lb.a,[978]);class mg{constructor(Y,Sa,Mb){this.Aa=Y;this.jjc=Sa;this.Hxc=Mb}create(Y){return new Pf(this.Aa,this.jjc,this.Hxc,Y)}}Object(c.a)(mg,"FileNameDialogFactory",null,[942]);class Lf extends za.a{constructor(Y){super();this.f3k=Sa=>{1===Sa?(e.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.Aa.Eb(r.a.ZCb,2)):e.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};this.Ue=1;this.vg(1,Object(ba.a)("RetryButtonLabel"));this.vg(0,Object(ba.a)("DialogClose"));
this.Aa=Y}kE(Y){e.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",Y);this.fE(Y,Object(ba.a)("DefaultDialogTitle"),Object(ba.a)("ErrorSavingToOneDrive"),this.f3k)}}Object(c.a)(Lf,"RetryDialog",za.a,[937]);class Nd extends sc{constructor(Y,Sa,Mb,oc){super(Y,Sa,Mb,oc);this.TPm=Sa}pbe(){return this.Ga.getBooleanAppSetting("SaveACopyBrsIsEnabled")}D1l(){return r.a.ZCb}pHh(){Qb.a.Fah(Object(h.a)(this,this.Lwm,"saveToCloudActionDispatcher"));Qb.a.AUd([new $b.a(r.a.ZCb,u.a.frame,0)],this.TPm.dXe())}Psm(){hb.a.DH("CreateCopy_cf;CreateCopy_tf");
e.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(c.a)(Nd,"SaveACopyActor",sc,[]);class ih extends Xb{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd){super(Sa,Mb,oc,Oc,nd,Cd,Zd);this.PNm=Y}px(Y){Y&&Y.data&&Y.data.folders?(e.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.PNm.create(this.jq).opb(Y.data.folders[0].id,Y.data.folders[0].name,Y.data.folders[0].urls.viewInBrowser)):(e.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),
this.ZF())}$G(Y){Y&&Y.error&&"user_canceled"===Y.error.code&&e.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.$G(Y)}ZF(){e.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.ZF()}}Object(c.a)(ih,"SaveACopyManager",Xb,[]);class Yg extends be{constructor(Y,Sa,Mb,oc,Oc,nd){super(Sa,Mb,oc,Oc,nd);this.Aa=Y}DXj(){return!!this.jq&&!!this.jq.SaveEntryPoint&&"VersionHistory"===this.jq.SaveEntryPoint.toString()}EZa(){e.ULS.sendTraceTag(7205459,
216,50,"Display Error for Save A Copy.");this.DXj()&&this.Aa.Ra(r.a.EYh,2,{["FailureReason"]:"Unknown"});super.EZa()}VCe(){e.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.DXj()&&this.Aa.Eb(r.a.Udh,2);super.VCe()}UCe(Y){e.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url for Save A Copy.");this.DXj()&&this.Aa.Eb(r.a.Udh,2);super.UCe(Y)}Hfb(){this.jq&&"true"===this.jq.SkipSaveToHost?super.Hfb():32!==this.Aa.Eb(r.a.Y8c,1)?(e.ULS.sendTraceTag(8741711,216,
15,"The save file change is not supported, this operation may result in data loss"),super.Hfb()):this.Aa.Ra(r.a.Y8c,2,[()=>{e.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");be.prototype.Hfb.call(this)},()=>{e.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.EZa()}])}}Object(c.a)(Yg,"SaveACopyUploadToCloudManager",be,[]);class Ah{constructor(){this.Oa=null;this.uu=()=>{n.AFrameworkApplication.ha.getBooleanAppSetting("SaveACopyBrsIsEnabled")&&
vb.a.instance.resolve("Common.App.SaveACopy.SaveACopyActor").Kb()}}get name(){return"Common.App.SaveACopy"}init(){n.AFrameworkApplication.ha.Wf(this.uu)}dispose(){}oc(Y){this.Oa=Y;this.Oa.register(Yg,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").pa(()=>new Yg(n.AFrameworkApplication.ub,Mc(),()=>(new Mf.a).create(),()=>new Lf(n.AFrameworkApplication.ub),n.AFrameworkApplication.Ha,n.AFrameworkApplication.Ha.Iea)).oa();this.Oa.register(mg,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").pa(()=>
new mg(n.AFrameworkApplication.ub,n.AFrameworkApplication.Ha.Ib,Jd())).oa();this.Oa.register(Nd,"Common.App.SaveACopy.SaveACopyActor").pa(()=>new Nd(vb.a.instance.resolve("Common.App.SaveACopy.SaveACopyManager"),md(),n.AFrameworkApplication.ha,n.AFrameworkApplication.Ha.Iea)).oa();this.Oa.register(ih,"Common.App.SaveACopy.SaveACopyManager").pa(()=>new ih(vb.a.instance.resolve("Common.App.SaveACopy.FileNameDialogFactory"),lc(),zh.a.instance,Jd(),n.AFrameworkApplication.ha,n.AFrameworkApplication.Qkc,
()=>new Lf(n.AFrameworkApplication.ub),Wd())).oa()}static main(){b.a.instance.Jc(new Ah)}}Object(c.a)(Ah,"PackageManager",null,[4,5]);var Bh=a(839),Kh=a(394);class Mg{constructor(Y){this.Qfm=null;this.Qln=()=>{e.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")};this.Sln=Sa=>{e.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");Sa=de.a(Sa.data.responseData).state+"";Kh.a.instance.setItem("AccountLinkedStatusCache",
Sa)};e.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.NFg=n.AFrameworkApplication.ha.Ma("PhoneLinkServiceEndpoint");(this.Uwa=Y)||e.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.NFg&&this.NFg.length||e.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}Yan(Y){Y&&(this.NFg="https://dcg-df.microsoft.com/",e.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));
this.Xan()}Xan(){e.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.Qfm)e.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.Qfm=new Date;var Y=new Date;this.Uwa.hP("BayBridge",this.NFg).then(Sa=>{const Mb=+new Date-+Y;Sa.IsSuccess?(e.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",Mb),this.Van(Sa.Token,this.qen())):
e.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",Mb,Sa.ErrorCode,Sa.ErrorMessage)}).catch(Sa=>{e.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",Sa,+new Date-+Y)})}}Van(Y,Sa){const Mb={};Mb.Authorization="Bearer "+Y;Mb["Authorization-Type"]="AAD";Mb.Accept="application/json";Mb["DCG-SessionId"]=n.AFrameworkApplication.userSessionId;
n.AFrameworkApplication.$d.ik(Sa,1,null,Mb,!1,2,this.Sln,this.Qln,null,void 0,void 0,void 0,void 0,"39");Aa.a("FetchAccountLinkedStatus")}Oen(){const Y=Kh.a.instance.getItem("AccountLinkedStatusCache");return Y&&Y.length?"true"===Y.toLowerCase()?!0:!1:!1}qen(){return this.NFg+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}}Object(c.a)(Mg,"PhoneLinkManager",null,[800]);class jg{constructor(){this.Oa=null}get name(){return"Common.App.PhoneLink"}oc(Y){this.Oa=Y;this.Oa.register(800,"Common.App.PhoneLink.IPhoneLinkManager").oa().pa(()=>
new Mg(Object(Bh.a)()))}init(){n.AFrameworkApplication.ha.Wf(()=>{this.A0b()})}A0b(){vb.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){b.a.instance.Jc(new jg)}}Object(c.a)(jg,"PhoneLinkPackage",null,[4,5]);var jh=a(333),Yf;(function(Y){Y[Y.Qxo=0]="myFiles";Y[Y.recent=1]="recent";Y[Y.Vvo=2]="currentFolder";Y[Y.Tzo=3]="yourPhone"})(Yf||(Yf={}));Object(c.b)("SharedFilePickerLandingLocation",Yf);class jf{constructor(Y){this.QIb=this.Inc=null;this._initialized=!1;
this.MFj=Y}P3i(Y){this._initialized||(Y.Yt(gg.a.ySk),Y.hD(gg.a.ySk,Object(h.a)(this,this.yTn,"onReceivedPickerResponse")),this._initialized=!0)}c1f(Y){return this.QIb=new Promise((Sa,Mb)=>{const oc={};oc[gf.a.rFk]=Y;this.Inc=(Oc,nd)=>{""===nd?(e.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Sa(Oc)):("Canceled"===nd?e.ULS.sendTraceTag(572548164,306,50,nd):e.ULS.sendTraceTag(556901065,306,10,nd),Mb(nd))};this.MFj.execute(Oc=>{this.P3i(Oc);Oc.sendMessage(gg.a.vom,oc)})})}yTn(Y){this.Inc(Y.Values[gf.a.gxm],
void 0===Y.Values[gf.a.EWh]||null===Y.Values[gf.a.EWh]?"":Y.Values[gf.a.EWh])}bYj(){return n.AFrameworkApplication.ha.getBooleanAppSetting("UiHostCommonFilePicker")}lIh(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we){we=void 0===we?null:we;const Qe={};Qe[gf.a.$wm]=Y;Qe[gf.a.titleText]=Sa;Qe[gf.a.lRl]=Mb;Qe[gf.a.mRl]=oc;Qe[gf.a.nRl]=Oc;Qe[gf.a.BYl]=!0;Qe[gf.a.r0l]=nd;Qe[gf.a.Ipm]=Cd;Qe[gf.a.Hpm]=Yf[Zd];Gc.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Qe[gf.a.tFk]="Dark");we&&(null!=we.wKd&&(Qe[gf.a.wKd]=
we.wKd),null!=we.y4d&&(Qe[gf.a.y4d]=we.y4d),we.uNh&&(Qe[gf.a.uNh]=we.uNh));return Qe}}Object(c.a)(jf,"SharedFilePickerManager",null,[819]);class ci{constructor(){this.Oa=null}get name(){return"Common.App.SharedFilePicker"}oc(Y){this.Oa=Y;Y.register(jf,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").oa().pa(()=>new jf(Object(jh.a)()))}init(){n.AFrameworkApplication.ha.Wf(()=>{this.A0b()})}A0b(){vb.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){b.a.instance.Jc(new ci)}}
Object(c.a)(ci,"SharedFilePickerPackage",null,[4,5]);class bi{constructor(Y,Sa){this.gjo=9E5;this.jjo=1E4;this.Wcm=this.o0e=null;this.I$j=0;this.PNf=Date.now;this.Pmn=Y;this.s1h=void 0===Sa?3E4:Sa;this.ZKh()}e5l(Y){Y=void 0===Y?!0:Y;const Sa=this.PNf();if(Sa<this.I$j+this.gjo)return Sa>this.I$j+this.jjo&&this.ZKh(),this.Wcm;Y&&this.ZKh();return null}getToken(Y){return(Y=this.e5l(void 0===Y?!0:Y))?Promise.resolve(Y):this.ZKh()}ZKh(){return this.o0e=this.o0e||new Promise(Y=>{this.Pmn().then(Sa=>{this.o0e=
null;""!==Sa&&Sa&&(this.Wcm=Sa,this.I$j=this.PNf(),Y(Sa));Y(null)}).catch(()=>{this.o0e=null;Y(null)});window.setTimeout(()=>{this.o0e=null;Y(null)},this.s1h)})}}Object(c.a)(bi,"OAuthCacheManager",null,[]);class Rh{constructor(){this.Uwa=null;this.aKl={};this.v7e=new $d.a(re.a.Co())}getToken(Y,Sa){if(this.v7e.Sb(Sa))return this.v7e.ka(Sa).getToken();const Mb=new bi(()=>this.f5l(Y,Sa));this.v7e.fa(Sa,Mb);return Mb.getToken()}Omn(Y,Sa){if(this.v7e.Sb(Sa))return this.v7e.ka(Sa).e5l();const Mb=new bi(()=>
this.f5l(Y,Sa));this.v7e.fa(Sa,Mb);return null}f5l(Y,Sa){if(!this.Uwa)try{this.Uwa=Object(Bh.a)()}catch(Mb){e.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+Mb)}return this.Uwa?new Promise(Mb=>{const oc=Date.now();this.Uwa.hP(Y,Sa).then(Oc=>{const nd=Oc.Token;!Oc.IsSuccess||this.nzn(nd)?(this.r5e("GetTokenInternalImplicitJS",!1,Date.now()-oc,Y,Oc.ErrorCode,Oc.ErrorMessage,Sa),Mb(null)):(this.r5e("GetTokenInternalImplicitJS",!0,Date.now()-oc,Y,Oc.ErrorCode,Oc.ErrorMessage,Sa),
Mb(nd))}).catch(Oc=>{Oc=Oc?de.c(Oc):"";this.r5e("GetTokenInternalImplicitJS",!1,Date.now()-oc,Y,"Caught Exception",Oc,Sa);Mb(null)})}):new Promise(Mb=>{this.r5e("GetTokenInternalImplicitJS",!1,0,Y,"Null OAuthManager","OAuthManager not set");Mb(null)})}r5e(Y,Sa,Mb,oc,Oc,nd,Cd){Oc=void 0===Oc?"":Oc;nd=void 0===nd?"":nd;Cd=void 0===Cd?"":Cd;var Zd="Search"===oc;const we=[];Y=ke.a.yfa(Zd?"Event":"EventName",Y,2);oc=ke.a.yfa("AppName",oc,2);Array.add(we,Y);Array.add(we,oc);Zd&&(oc=ke.a.yfa("LatencyType",
"FetchToken",2),Array.add(we,oc));Oc&&""!==Oc&&(Oc=ke.a.yfa("ErrorCode",Oc,2),Array.add(we,Oc));nd&&""!==nd&&(nd=ke.a.yfa("ErrorMessage",nd,2),Array.add(we,nd));Cd&&""!==Cd&&(nd=!(Cd in this.aKl),this.aKl[Cd]=nd,nd=ke.a.yfa("WarmUpCall",nd.toString(),1),Array.add(we,nd),Cd=ke.a.yfa("Service",this.M0d(Cd),2),Array.add(we,Cd));Zd=Zd?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";Sa=Object.assign(new ag.a,{name:Zd,samplingPolicy:2,dataFields:we,succeeded:Sa,durationMs:Mb});
k.a.sendActivityEvent(Sa)}M0d(Y){return Y===n.AFrameworkApplication.ode?"Loki":Y===n.AFrameworkApplication.oLe?"Substrate":n.AFrameworkApplication.ha&&Y===n.AFrameworkApplication.ha.Ma("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}nzn(Y){return!Y||!Y.length}}Object(c.a)(Rh,"SearchOAuthManager",null,[799]);class di{constructor(){this.Oa=null}get name(){return"Common.App.SearchOAuthManager"}oc(Y){this.Oa=Y;this.Oa.register(799,"Common.App.SearchCommon.ISearchOAuthManager").oa().pa(()=>new Rh)}init(){}dispose(){}static main(){b.a.instance.Jc(new di)}}
Object(c.a)(di,"SearchOAuthPackage",null,[4,5]);var Dg;(function(Y){Y[Y.$cn=0]="generalException";Y[Y.invalidArgument=1]="invalidArgument";Y[Y.iPn=2]="notAllowed";Y[Y.OWm=3]="apiNotAvailable";Y[Y.nlo=4]="unresolvedPendingRequest";Y[Y.timeout=5]="timeout";Y[Y.Joi=6]="adalTimeout";Y[Y.Rno=7]="userNotSignedIn";Y[Y.r2h=8]="userAborted";Y[Y.qAm=9]="silentSignInFailed";Y[Y.QNh=10]="invalidResourceUrl";Y[Y.S8l=11]="invalidGrant";Y[Y.mVl=12]="connectionLost";Y[Y.AKi=13]="clientError";Y[Y.Dua=14]="serverError"})(Dg||
(Dg={}));Object(c.b)("ErrorCodes",Dg);class Oh{}Object(c.a)(Oh,"HostApplicationType",null,[]);class zf{constructor(Y,Sa){this.requestCallback=this.requestParameters=null;this.requestParameters=Y;this.requestCallback=Sa}}Object(c.a)(zf,"OutstandingRequest",null,[]);class bh{}bh.ePn="AADSTS50058";bh.QNh="AADSTS50001";bh.bPn="AADSTS65001";bh.jPn="AADSTS70011";bh.r2h="13002";bh.AYn="Popup Window is null";bh.zYn="Popup Window closed";bh.Joi="Token renewal operation failed due to timeout";bh.kjo="tokenRevoked";
Object(c.a)(bh,"WopiHostErrorType",null,[]);var Ph=a(238),Lh=a(380),wi=a(1609);class Zg{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(c.a)(Zg,"WopiIdentityInfo",null,[868]);class Rg{constructor(Y,Sa,Mb){this.expiration=this.authority=this.accessToken=null;this.accessToken=Y;this.authority=Sa;this.expiration=Mb}}Object(c.a)(Rg,"WopiIdentityToken",null,[845]);class ji{constructor(Y){this._initialized=!1;this.xTn=Sa=>{let Mb=null;
try{const Oc=Sa.Values[gf.a.l0h],nd=Sa.Values[gf.a.aBm],Cd=Sa.Values[gf.a.bnl],Zd=Sa.Values[gf.a.iBm];let we=null,Qe=null;const kf=this.X1e[Oc];if("undefined"!==typeof kf&&kf){var oc=[];Array.add(oc,Object.assign(new x.a,{name:gf.a.k0h,string:kf.requestParameters.correlationId}));k.a.sendTelemetryEvent(Object.assign(new v.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:oc}));Mb=kf.requestCallback;delete this.X1e[Oc];"undefined"!==typeof nd&&nd&&nd.length?Qe=new Rg(nd,
Cd,Zd):we=Dg[this.WHn(Sa)];oc="getAccessToken_"+Oc;oc in this.t0h&&(this.t0h[oc].stop(),delete this.t0h[oc]);Mb(Qe,we)}else e.ULS.sendTraceTag(37856066,344,10,de.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:Oc}))}catch(Oc){Sa=Sa.Values[gf.a.l0h],Sa in this.X1e&&delete this.X1e[Sa],this.PPh(),e.ULS.sendTraceTag(37856067,344,10,de.c({["error"]:Oc.message,["stack"]:Oc.stack})),Mb&&Mb(null,"generalException")}};this.X1e={};this.t0h={};this.qJa=n.AFrameworkApplication.Ha.Iea;
this.MFj=Y}P3i(Y){this._initialized||(Y.Yt(gg.a.postAuthToken),Y.hD(gg.a.postAuthToken,this.xTn),this._initialized=!0)}getAccessToken(Y,Sa,Mb){Mb=void 0===Mb?null:Mb;this.rJb(Y,Sa);return new Promise((oc,Oc)=>{if(this.fNj(Sa))if(Sa in this.X1e)Oc("unresolvedPendingRequest");else{var nd=window.setTimeout(()=>{e.ULS.sendTraceTag(37856032,344,10,de.c({["error"]:"Request timeout.",["callerId"]:Sa}));Oc("timeout")},12E4);this.ycj(Y,Sa,Mb,(Cd,Zd)=>{window.clearTimeout(nd);Cd?oc(Cd):(e.ULS.sendTraceTag(37856033,
369,15,de.c({["error"]:Dg[Zd]})),Oc(Zd))})}else e.ULS.sendTraceTag(37856034,344,10,de.c({["error"]:"Caller is not allowed."})),Oc("notAllowed")})}getPrimaryIdentityInfo(Y){return new Promise((Sa,Mb)=>{this.fNj(Y)?this.fkn((oc,Oc)=>{oc?Sa(oc):(e.ULS.sendTraceTag(37856064,369,10,de.c({["error"]:Oc.toString()})),Mb(Oc))}):(e.ULS.sendTraceTag(37856065,344,10,de.c({["error"]:"Caller is not allowed."})),Mb("notAllowed"))})}getAuthContext(Y){return new Promise((Sa,Mb)=>{const oc=this.getAuthContextSync(Y);
oc?Sa(oc):Mb("notAllowed")})}getAuthContextSync(Y){if(this.fNj(Y)){const Sa=new wi.a;Sa.upn=n.AFrameworkApplication.ha.Ma("UserPrincipalName");Sa.userId=n.AFrameworkApplication.ha.Ma("LoggableUserId");Sa.authority=n.AFrameworkApplication.ha.Ma("HostAuthAuthority");Sa.tenantId=n.AFrameworkApplication.ha.Ma("TenantId");Sa.isAnonymous=n.AFrameworkApplication.ha.getBooleanAppSetting("IsAnonymousUser");Sa.supportsAuthToken=this.vtn(Y);Y=n.AFrameworkApplication.ha.Ma("HostAuthType");Sa.authorityType="aad"===
Y.toLowerCase()?2:"msa"===Y.toLowerCase()?1:0;return Sa}e.ULS.sendTraceTag(40751647,344,10,de.c({["error"]:"Caller is not allowed."}));return null}vtn(Y){const Sa=Ph.a.esb;return Na.a.pQa?Sa&&Ph.a.Jql?Array.contains(Ph.a.Jql,Y.toLowerCase()):!1:Sa}ycj(Y,Sa,Mb,oc){var Oc=[];Array.add(Oc,Object.assign(new x.a,{name:"CallerId",string:Sa}));Array.add(Oc,Object.assign(new x.a,{name:gf.a.k0h,string:Y.correlationId}));k.a.sendTelemetryEvent(Object.assign(new v.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",
dataFields:Oc}));Oc=Lh.a.create().toString();const nd="getAccessToken_"+Oc,Cd=this.qJa.Xl("ComponentAttach",nd);this.t0h[nd]=Cd;const Zd={};Zd[gf.a.l0h]=Oc;Zd[gf.a.fBm]=Y.resource;Zd[gf.a.gBm]=Y.scope;Zd[gf.a.bnl]=n.AFrameworkApplication.ha.Ma("HostAuthType");Zd[gf.a.jBm]=n.AFrameworkApplication.ha.Ma("UserPrincipalName");Zd[gf.a.hBm]=Y.silentLogin;Zd[gf.a.cBm]=Y.options;Zd[gf.a.k0h]=Y.correlationId;Zd[gf.a.dBm]=Sa;Mb&&(Zd[gf.a.addinName]=Mb.AddinName,Zd[gf.a.bBm]=Mb.AddinTrustId);this.MFj.execute(we=>
{this.P3i(we);we.sendMessage(gg.a.getAuthToken,Zd)});this.X1e[Oc]=new zf(Y,oc)}fkn(Y){const Sa=n.AFrameworkApplication.ha.Ma("UserName"),Mb=n.AFrameworkApplication.ha.Ma("UserPrincipalName"),oc=n.AFrameworkApplication.ha.Ma("LoggableUserIdSpace"),Oc=new Zg;Oc.email=Mb;Oc.displayName=Sa;switch(oc){case "OrgIdPuid":Oc.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Oc.authority="MicrosoftAccount";break;default:Oc.authority=oc}Y(Oc,null)}fNj(Y){var Sa=n.AFrameworkApplication.t5l();
Y=Y.toLowerCase();for(const Mb of Sa)if(Y===Mb.toLowerCase())return!0;Sa=Ph.a.OTe;for(const Mb in Sa)if(Y===Sa[Mb].toLowerCase())return!0;return!1}WHn(Y){Y=Y.Values[gf.a.eBm];this.PPh();e.ULS.sendTraceTag(39068821,344,50,de.c({["error"]:Y}));return Y?-1<Y.indexOf(bh.ePn)?9:-1<Y.indexOf(bh.AYn)||-1<Y.indexOf(bh.zYn)?12:-1<Y.indexOf(bh.QNh)?10:-1<Y.indexOf(bh.r2h)?8:-1<Y.indexOf(bh.jPn)||-1<Y.indexOf(bh.bPn)||Y===bh.kjo?11:-1<Y.indexOf(bh.Joi)?6:0:13}rJb(Y,Sa){Y=this.i4n(Y.resource);e.ULS.sendTraceTag(39921882,
344,50,de.c({["callerId"]:Sa,["resource"]:Y}))}PPh(){e.ULS.sendTraceTag(39068822,344,50,de.c({["userAgent"]:window.navigator.userAgent}))}i4n(Y){return(Y?Y:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(c.a)(ji,"WopiIdentityManager",null,[818]);class Xh{constructor(){this.Oa=null;this.uu=()=>{try{vb.a.instance.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(Y){e.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+
Y)}}}get name(){return"Common.App.WopiIdentity"}oc(Y){this.Oa=Y;Y.register(ji,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").oa().pa(()=>new ji(Object(jh.a)()))}init(){n.AFrameworkApplication.ha&&n.AFrameworkApplication.ha.Wf(this.uu)}dispose(){}static main(){b.a.instance.Jc(new Xh)}}Object(c.a)(Xh,"WopiIdentityPackage",null,[4,5]);class kh extends lb.a{constructor(Y,Sa){super(!1,!1,!0);this.Tec=(Mb,oc)=>{if(1===Mb){Mb=oc.showRibbonChoice;if(this.vNl!==
oc.ribbonLayoutChoice)appChrome.onRibbonModeToggle();this.VNl!==Mb&&("AlwaysShow"===Mb?appChrome.api.getAlwaysShowCommandHandler():appChrome.api.getHideCommandHandler())()}};this.vNl=Y;this.VNl=Sa}start(){this.qp("",this.Tec,{["id"]:"RibbonSettingsDialog",["bodyControls"]:{["ribbonLayoutChoice"]:this.vNl,["showRibbonChoice"]:this.VNl}})}}Object(c.a)(kh,"RibbonSettingsDialog",lb.a,[]);class mi{constructor(Y){this.Aa=Y}Kb(){this.Aa.Ba(r.a.gAm,u.a.frame,this.efo)}efo(){let Y="SingleLineRibbon";"Multiline"===
appChrome.selectors.getRibbonMode()&&(Y="ClassicRibbon");const Sa=appChrome.selectors.getShyState().isActive?"AutomaticallyHide":"AlwaysShow";(new kh(Y,Sa)).start();return 32}}Object(c.a)(mi,"RibbonSettingsDialogActor",null,[817]);class rg{constructor(){this.Oa=null}get name(){return"Common.App.RibbonSettings"}oc(Y){this.Oa=Y;this.Oa.register(mi,"Common.App.RibbonSettings.RibbonSettingsDialogActor").as("Common.App.RibbonSettings.IRibbonSettingsDialogActor").pa(()=>new mi(n.AFrameworkApplication.ub)).oa()}init(){const Y=
vb.a.instance.Db("Common.App.RibbonSettings.IRibbonSettingsDialogActor");Y?Y.Kb():z.c(508436678,200,15,"Failed to resolve IRibbonSettingsDialogActor. Ribbon dialog feature is not enabled.")}dispose(){}static main(){b.a.instance.Jc(new rg)}}Object(c.a)(rg,"RibbonSettingsPackage",null,[4,5]);var Ji=a(735);class Ki extends Ji.a{constructor(Y,Sa){super(Y,td.a.getOrigin(Sa))}$nc(Y,Sa){this.isEnabled()&&this.rHb(this.Iib)&&(this.Yt(Y),this.hD(Y,Sa))}}Object(c.a)(Ki,"InsertMediaCrossDocumentMessenger",Ji.a,
[994,973,40]);class Li{getInstance(Y,Sa){return new Ki(Y,Sa)}}Object(c.a)(Li,"InsertMediaCrossDocumentMessengerFactory",null,[977]);class jj{constructor(Y,Sa,Mb){this.correlationId=null;this.kzb=0;this.GMc=null;this.aJh=0;this.qOm=Y;this.Ttf=[];this.pOm=Sa;this.kOl=Mb.split(";")}FJe(Y,Sa){Array.clear(this.Ttf);Y=this.qOm.value;Y.LDm(Sa.XXe);Y.rHb(this.pOm);Y.Yt(Sa.XXe);Y.hD(Sa.XXe,Mb=>{this.zyk(Mb,Sa)});e.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");
Y.sendMessage(Sa.iXl,{["FileExtensionFilterList"]:this.kOl})}JUm(Y){Array.contains(this.Ttf,Y)||Array.add(this.Ttf,Y)}zyk(Y,Sa){e.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");Y=Sa.dpm(Y);const Mb=[];for(let oc=0;oc<Y.length;oc++){const Oc=Y[oc];Sa.COh(Oc,this.kOl)?Array.add(Mb,Oc):this.JUm(Sa.i4l(Oc))}Mb&&Mb.length?Sa.Klc(Mb):e.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.Ttf.length&&(Sa=this.Ttf.join(", "),
e.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",Sa),this.rfo(Sa))}rfo(Y){const Sa=new za.a;Sa.Ue=0;Sa.h6(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,Y),null)}dispose(){}}Object(c.a)(jj,"InsertMediaFromHostManager",null,[824,40]);class aj{constructor(Y){this.wOm=Y}getInstance(){return this.wOm}}Object(c.a)(aj,"InsertMediaFromHostManagerFactory",null,[975,976]);class mj{constructor(){this.Wff=
document.createElement("iframe");this.Wff.src="about:blank";this.Wff.style.visibility="hidden";this.Wff.style.position="absolute";this.Wff.style.zIndex="-100"}get BVd(){return this.Wff}}Object(c.a)(mj,"InsertMediaFromHostOneDriveHostFrame",null,[974]);class ri extends Ji.a{constructor(Y,Sa){super(Y,"*"===Sa?Sa:td.a.getOrigin(Sa));this.Qoi(gg.a.rYe);this.Qoi(gg.a.HNh)}reportDocumentLoadedTime(){}}Object(c.a)(ri,"InsertMediaFromOneDriveCrossDocumentMessenger",Ji.a,[972,973,40]);var xi=a(324),yi=a(1250);
class vh{pGh(Y){switch(Y){case 1:Y=8;break;case 4:Y=3;break;case 2:Y=0;break;default:Y=0}return Y}eZm(Y,Sa){return String.format(Sa,this.pGh(Y))}zSl(Y,Sa,Mb,oc,Oc,nd,Cd){Y=this.pGh(Y);const Zd=xi.a.Le(n.AFrameworkApplication.lcid).name,we=n.AFrameworkApplication.buildVersion;hb.a.DH("ShIns226;ShIns226cf");return String.format(Sa,n.AFrameworkApplication.lcid,Zd,we,Oc,Y,nd,Mb,oc,Cd)}gZm(Y,Sa){Y=this.pGh(Y);const Mb=n.AFrameworkApplication.buildVersion,oc=0<Mb.indexOf(".")?Mb.substring(0,Mb.indexOf(".")):
"16";return String.format(Sa,n.AFrameworkApplication.lcid,n.AFrameworkApplication.lcid,n.AFrameworkApplication.lcid,Y,oc,Mb,"Video",0,0)}fZm(Y,Sa,Mb,oc,Oc,nd){Y=String.format(Sa,n.AFrameworkApplication.lcid,n.AFrameworkApplication.uiCulture,n.AFrameworkApplication.buildVersion,Mb,this.pGh(Y),oc);Y+="&flipgrid=1";Oc&&(Oc=new Rc.QueryStringBuilder(Y),Oc.ej("stream2","1"),Oc.ej("enablegetcustomheader","1"),Y=Oc.toString());"defaultModal"!=nd&&(Oc=new Rc.QueryStringBuilder(Y),Oc.ej("modalvariation",nd),
Y=Oc.toString());return Y}gpm(Y){if(!Y||!Y.Values)return null;Y=Y.Values;if(!Y)return null;let Sa="";"sourceProvider"in Y&&(Sa=Y.sourceProvider||"");return Object.assign(new yi.a,{Action:Y.action||"",Caption:Y.caption||"",ContentType:Y.contentType||"",Type:Y.extension||"",PageUrl:Y.pageUrl||"",OriginalUrl:Y.sourceUrl||"",ContentProvider:Sa,ThumbnailUrl:Y.thumbnailUrl||"",LicenseUrl:Y.licenseUrl||"",LicenseDisplayName:Y.licenseDisplayName||"",Height:Y.height||0,Width:Y.width||0,SvgContent:Y.svgContent||
"",Description:Y.description||"",ProviderName:Y.providerName||"",StartInsertTime:Y.startInsertTime||0})}jWn(Y){const Sa=[];if(!Y||!Y.Values||!Y.Values.Items)return Sa;Y=Y.Values.Items;for(let oc=0;oc<Y.length;oc++){var Mb=Y[oc];Mb&&(Mb=Object.assign(new yi.a,{Type:Mb.Extension||"",OriginalUrl:Mb.SourceUrl||"",Caption:Mb.caption,Description:Mb.description||"",Height:Mb.Height||0,Width:Mb.Width||0}),Array.add(Sa,Mb))}return Sa}COh(Y,Sa){if(!Y)return!1;for(let Mb=0;Mb<Sa.length;Mb++)if(0<=Y.toLowerCase().indexOf(Sa[Mb]))return!0;
return!1}f1n(Y){let Sa="";if(Y)for(let Mb=0;Mb<Y.length;Mb++){const oc=Y[Mb];oc&&(Sa+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',oc.OriginalUrl,oc.Width,oc.Height))}return Sa}tnn(Y){return(Y=vh.h9n.exec(Y))&&2<Y.length?Y[2].trim():""}kTm(Y,Sa){Y.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCreateWithAI",!1)?Sa.ej("dallecore","1"):Y.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertDalle",!1)&&Sa.ej("dalle","1")}}vh.h9n=RegExp("<iframe\\s(.*\\s)*src=[\\\"|'](.*?)[\\\"|'].*/(iframe)?>",
"im");Object(c.a)(vh,"InsertMediaHelper",null,[971]);var Hg=a(48);class Zf{constructor(Y){this.Qif=Hg.a.insertHyperlink;this.Aa=Y}get XZ(){return this.Qif}set XZ(Y){this.Qif=Y}Klc(Y){try{e.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",Y.length);for(let Sa=0;Sa<Y.length;Sa++)this.Aa.Ra(this.XZ,2,Y[Sa]);e.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",Y.length)}catch(Sa){e.ULS.sendTraceTag(21612193,
352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",Sa.toString())}}}Object(c.a)(Zf,"InsertOneDriveFileHandler",null,[826]);class Ci extends Zf{constructor(Y){super(Y)}get iXl(){return gg.a.HNh}get XXe(){return gg.a.E8l}dpm(Y){return Y&&Y.Values&&"Items"in Y.Values?Y.Values.Items:null}i4l(){z.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}COh(){return!0}Krm(Y,Sa,Mb){Y=Mb(Y);Y.length&&(Mb=
{},Mb.Items=Y,Sa.sendMessage(this.XXe,Mb))}fpm(Y){const Sa=[];for(let Mb=0;Mb<Y.data.value.length;Mb++){const oc=Y.data.value[Mb];if(oc){const Oc={};Oc.DisplayText=oc.name;Oc.Url=oc.urls.download;Oc.sourceUrl=oc.urls.download;Oc.caption=oc.name;Array.add(Sa,Oc)}}return Sa}}Object(c.a)(Ci,"InsertOneDriveFileHelper",Zf,[825,826]);class wh extends lb.a{constructor(){super()}Ujl(){this.kxd="FilePickerDialog";this.Vl="<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>";this.rj="PickerDialog-Livebooks";
this.showDialog("",null)}qnj(){return document.getElementById("OpenFilePickerDiv")}X4(){}gJa(){}}Object(c.a)(wh,"PickerDialog",lb.a,[993]);class xh{constructor(Y,Sa,Mb){this.GE=this.iQb=null;this.Myd=Y;this.oQm=Mb;this.jOb=new Ja.a(()=>new tg.a(Sa.value,Object(h.a)(this,this.dJc,"getMoreInfoEventReceived")))}get U1e(){this.iQb||(this.jOb.value.Qi("InsertFromOneDrive",!0),this.GE&&this.GE.aga&&this.GE.aga.length&&(this.iQb=this.Emj(this.GE.aga)));return this.iQb}Emj(Y){Y=Y.toLowerCase();Y.endsWith("/")||
(Y+="/");const Sa=Y.indexOf("/documents/");return-1!==Sa?Y.substring(0,Sa+1)+"_layouts/15/onedrive.aspx":""}dJc(Y){this.GE||3!==Y.state||(this.GE=Y)}start(Y){if(!this.U1e)if(n.AFrameworkApplication.breadcrumbFolderUrl&&n.AFrameworkApplication.breadcrumbFolderUrl.length)this.iQb=n.AFrameworkApplication.breadcrumbFolderUrl;else{e.ULS.sendTraceTag(26071185,352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",
!this.GE);return}const Sa=new wh;Sa.Ujl();const Mb=Sa.qnj();Mb?this.Myd.start((oc,Oc)=>{Sa.hide();this.processResponse(oc,Oc,Y)},()=>{this.Nwk(Sa)},Mb,this.iQb):e.ULS.sendTraceTag(26071186,352,10,"Picker container is null, will not show picker.")}Nwk(Y){Y.hide();e.ULS.sendTraceTag(26071187,352,50,"User cancelled to insert picture from onedrive.")}processResponse(Y,Sa,Mb){e.ULS.sendTraceTag(26071188,352,50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",
Y);Y&&Sa&&Sa.data&&Sa.data.value&&0<Sa.data.value.length?(Y=this.oQm.getInstance(window.frames[0].parent,window.document.URL),Mb.Krm(Sa,Y,Object(h.a)(Mb,Mb.fpm,"parseOneDriveV7Response"))):e.ULS.sendTraceTag(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")}}Object(c.a)(xh,"OneDriveFilePickerHelperV7",null,[969,970]);class vg{constructor(Y,Sa,Mb,oc){this.la=Sa;this.na=Y;this.xR=this.na.u6a;this.jA=Mb;this.ecm=oc}get SHa(){return this.ecm?this.ecm.instance:null}Kb(){this.la.ua(r.a.gce,
Ta.a.application,Object(h.a)(this,this.lpc,"triggerCommandforAddinCommands"),4);this.la.ua(r.a.iyc,Ta.a.application,Object(h.a)(this,this.lpc,"triggerCommandforAddinCommands"),4);this.la.ua(r.a.lah,Ta.a.application,Object(h.a)(this,this.lpc,"triggerCommandforAddinCommands"),4);this.la.ua(r.a.R5c,Ta.a.application,Object(h.a)(this,this.R5c,"queryAddInCommandsLoadStatus"),96);this.la.Ba(r.a.pnh,Ta.a.application,Object(h.a)(this,this.lpc,"triggerCommandforAddinCommands"));this.la.ua(r.a.Jla,Ta.a.application,
Object(h.a)(this,this.lpc,"triggerCommandforAddinCommands"),64);this.la.ua(r.a.gFe,Ta.a.application,Object(h.a)(this,this.lpc,"triggerCommandforAddinCommands"),64);this.la.Ba(r.a.t6e,Ta.a.application,Object(h.a)(this,this.lpc,"triggerCommandforAddinCommands"));this.la.ua(r.a.WXe,Ta.a.application,Object(h.a)(this,this.lpc,"triggerCommandforAddinCommands"),64);this.la.Ba(r.a.rJe,Ta.a.application,Object(h.a)(this,this.lpc,"triggerCommandforAddinCommands"));this.la.Ba(r.a.cWe,Ta.a.application,Object(h.a)(this,
this.lpc,"triggerCommandforAddinCommands"))}Ae(){}lpc(Y,Sa,Mb,oc,Oc){if(!this.xR)return 16;if(1===Mb)return Sa=Y===r.a.iyc&&(!this.SHa||!this.SHa.Tnn(Oc)),Y=Y===r.a.iyc&&!!this.SHa&&this.SHa.Wco(Oc),Sa||Y?8:32;if(this.SHa)switch(Y){case r.a.gce:this.SHa.yPh(Oc);break;case r.a.iyc:this.SHa.K8f(Oc);break;case r.a.R5c:this.SHa.Rrm(Oc);break;case r.a.pnh:this.SHa.Vdo();break;case r.a.Jla:this.SHa.b2n(Oc);break;case r.a.gFe:this.SHa.gFe(Oc);break;case r.a.lah:this.SHa.k4n();break;case r.a.t6e:this.SHa.t6e(Oc);
break;case r.a.WXe:this.SHa.WXe(Oc);break;case r.a.rJe:this.SHa.rJe(Oc);break;case r.a.cWe:this.SHa.cWe(Oc)}else this.jA.rZ(),this.jA.afa(Y,Oc);return 32}R5c(Y,Sa,Mb,oc,Oc){if(!this.xR)return 16;this.SHa&&this.SHa.Rrm(Oc);return 32}}Object(c.a)(vg,"AddinCommandsActor",null,[502]);var Tf=a(1138),ei=a(229),yg=a(107),Hj=a(218),zi=a(55),Mi=a(1157),sf=a(483);class ki{constructor(Y,Sa,Mb,oc){this.NSm=Y;this.i1n=Sa;this.Bj=Mb;this.ha=oc;this.L2b=!1;this.Btd=0;this.xpn=(Oc,nd,Cd)=>{if(this.NSm.Hd(this.i1n))return 16;
if(1===Cd)return 32;!this.L2b&&this.Btd<ki.ajo&&3===n.AFrameworkApplication.ub.mode&&(this.Ydo(),this.Btd++,this.L2b=!0,n.AFrameworkApplication.Zd.Rb(new B.a(5,1,this.ha.Ac("DelayInResettingIsToastShownInMs",ki.Tcd),()=>{this.L2b=!1},0,"AutoSaveToastShownResetTask")));return 32}}Ydo(){var Y=Object(fb.a)("NewStringIconAutoSave")?ki.lJm:ki.JGb;const Sa=Math.floor(Math.random()*Y.length);Y=this.Bj.notificationBar.OX(Y[Sa],!1);H.a.$(508122977,806,50,"Autosave toast message is shown");Y.image=5;Y.aY=Object(fb.a)("NewStringIconAutoSave")?
ki.ZOn[Sa]:ki.Zio[Sa];this.Bj.notificationBar.mi(Y)}}ki.JGb=[ResourceStrings.l_FileIOCtrlSToastMessageString1,ResourceStrings.l_FileIOCtrlSToastMessageString2,ResourceStrings.l_FileIOCtrlSToastMessageString3,ResourceStrings.l_FileIOCtrlSToastMessageString4];ki.lJm=[ResourceStrings.l_FileIOCtrlSToastMessageString5,ResourceStrings.l_FileIOCtrlSToastMessageString6,ResourceStrings.l_FileIOCtrlSToastMessageString7,ResourceStrings.l_FileIOCtrlSToastMessageString8];ki.Tcd=7E3;ki.Zio=["AnimFxEntranceScale_16",
"Snow_DOL_16","Wand1_16","AutoSave2_16"];ki.ZOn=["SaveFluent_20","FlashFluent_20","VictoryHandFluent_20","WandFluent_20"];ki.ajo=10;Object(c.a)(ki,"AutoSaveToast",null,[]);var qh=a(249);class Hh{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg,yh,qg,Ug,Zh,Ii,Jl,Tl,jm,Pj,Gj,dk,ql,yl){this.lug=null;this.wcm=!1;this.Cod=null;this.kem=fb.a("PartialDoc.SkipCutCopyCallout");this.Ecm=null;if(!ql)throw Error.argumentNull("calloutNotificationAdapter");this.la=Y;this.qf=Sa;this.Jb=Ii;this.Na=Mb;this.sa=
oc;this.Kw=Oc;this.N_=nd;this.whm=Cd;this.Tem=Zd;this.cGn=we;this.zQh=Qe;this.Gb=kf;this.I_e=Zh.mNh;this.UG=Vf;this.rc=Jl;this.cDn=Zh.WWh;this.WFn=eg;this.LQh=zg;this.pb=Ug;this.J0e=!Zh.li;this.Vgm=Tl;this.Phm=Pj;this.Kfm=Gj;this.PF=dk;this.Ddm=!Zh.lZa||Ii.getBooleanAppSetting("DisablePrint");this.Edm=yh;this.en=qg;this.dEn=Ii.Ma("DownloadPdfFromPodsUrl");this.m_printUrl=Ii.Ma("PrintPdfFromPodsUrl");this.cEn=Ii.Ma("DownloadOdpFromPodsUrl");this.Jdm=Ii.Ma("DownloadImagesFromPodsUrl");this.kGn=Ii.getBooleanAppSetting("UseToastForDeferredBlobsEnabled");
this.HGn=Zh.W2e;Y=(n.AFrameworkApplication.fileName||"").toLowerCase();Zh.li&&Zh.D9l?(this.wcm=!0,this.lug=Ii.Ma("DownloadACopyPodsUrl")):!Zh.li&&Zh.B$l&&(Y.endsWith(".pptx")||Y.endsWith(".ppsx"))?this.lug=this.HHn():this.lug=n.AFrameworkApplication.upb;this.Wdk=jm;this.dFn=Zh.T$d;this.Y$=vb.a.instance.eb("Common.ISystemInitiatedFeedback");this.WEn=Ii.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1);this.PJ=ql;this.Ecm=new ki(Sa,Oc,kf,Ii);this.D5b=fb.a("EnableFileDownloadTelemetry")?
new qh.a("DocumentOperationActor::FileDownload",tb.a.downloadACopy):void 0;this.Jm=yl}Kb(){const Y=!!this.Edm&&!this.Vgm();H.a.$(512500629,801,50,"Limited printing access: {0}, Message shown: {1}",this.Ddm,Y);this.Ddm?Y&&this.en.Szm(this.Edm):(this.la.Ba(tb.a.print,Ta.a.application,Object(h.a)(this,this.bpn,"handlePrint")),this.la.Ba(tb.a.downloadACopy,Ta.a.application,Object(h.a)(this,this.downloadACopy,"downloadACopy")),this.la.Ba(tb.a.ikd,Ta.a.application,Object(h.a)(this,this.ikd,"downloadACopyAsPdf")),
this.la.Ba(tb.a.hkd,Ta.a.application,Object(h.a)(this,this.hkd,"downloadACopyAsOdp")),this.la.Ba(tb.a.jkd,Ta.a.application,Object(h.a)(this,this.jkd,"downloadAsImages")),this.la.Ba(tb.a.XYh,Ta.a.application,Object(h.a)(this,this.XYh,"saveSlidesAsImages")),this.la.Ba(tb.a.crd,Ta.a.application,Object(h.a)(this,this.M0n,"pptoSaveACopy")),this.la.Ba(tb.a.P2e,Ta.a.application,Object(h.a)(this,this.N0n,"pptoSaveAsToHost")),this.la.Ba(tb.a.Q2e,Ta.a.application,Object(h.a)(this,this.O0n,"pptoSaveToSharePoint")),
this.la.Ba(tb.a.N3e,Ta.a.application,Object(h.a)(this,this.dpn,"handlePrintNotes")),this.la.Ba(tb.a.M3e,Ta.a.application,Object(h.a)(this,this.cpn,"handlePrintHandouts")));this.la.Ba(tb.a.JBf,Ta.a.application,this.Ecm.xpn);this.la.Ba(r.a.Y8c,Ta.a.application,Object(h.a)(this,this.Y8c,"saveFileChange"));this.whm&&this.la.ua(tb.a.c4e,Ta.a.application,Object(h.a)(this,this.c4e,"querySaveStatus"),96);this.Wdk.execute(Object(h.a)(this,this.pac,"onHostPostmessengerCreated"))}Ae(){const Y=this.Na.Uc(ca.a.RSl);
Y.bindAction($a.a.hb(la.a.$Lb,$a.a.Ne),tb.a.print);Y.bindAction($a.a.hb(la.a.SWa,$a.a.Ne),r.a.ke);Y.bindAction($a.a.hb(la.a.xRe,$a.a.Ne),tb.a.JBf);Y.bindAction($a.a.hb(la.a.xaa,$a.a.Ne),r.a.ke);Y.bindAction($a.a.hb(la.a.xaa,$a.a.Ne|4),r.a.ke)}N0n(Y,Sa,Mb){return this.X4k(Mb,r.a.W8c,"SaveAsToHost")}M0n(Y,Sa,Mb){return this.X4k(Mb,r.a.ZCb,"SaveACopy")}O0n(Y,Sa,Mb){return this.X4k(Mb,r.a.lLb,"SaveToSharePoint")}X4k(Y,Sa,Mb){if(1===Y)return n.AFrameworkApplication.Mz||n.AFrameworkApplication.tna?8:this.la.Eb(Sa,
1);if(this.PF.hasDeferredContent()&&(H.a.$(512500628,843,15,"{0} is triggered while document has deferred content",Mb),!this.kGn))return this.PF.C_h(Mb,null,null),8;this.jTe(Mb);return this.pb.P6a?(H.a.$(512500627,801,50,"DocumentOperationsActor:SaveAsImpl - Inline Repair Case , ActionId: {0}",Sa),this.la.Ra(tb.a.kLb,2,Sa)):this.la.Eb(Sa,2)}downloadACopy(Y,Sa,Mb,oc,Oc){var nd,Cd,Zd,we,Qe,kf,Vf,eg,zg;null===(nd=this.D5b)||void 0===nd?void 0:nd.Gf("ST");if(this.qf.Hd(this.Kw))return 16;if(1===Mb)return!this.rc.zl()||
n.AFrameworkApplication.tna?8:Hh.U_l()?32:this.GUe();if(this.PF.hasDeferredContent())return H.a.$(512500626,843,15,"DownloadACopy is triggered while document has deferred content"),this.kem&&this.PJ.VPf(),null===(Cd=this.D5b)||void 0===Cd?void 0:Cd.Gf("DismissCalloutTime"),this.PF.C_h("DownloadACopy",new Mi.a,()=>{this.zdd(Oc)}),this.PF.$La("DownloadACopyRequestedTime",zi.a.Pf(new Date)),8;this.sa.nj();null===(Zd=this.D5b)||void 0===Zd?void 0:Zd.Gf("RemoveShapeTime");this.Na.ee();null===(we=this.D5b)||
void 0===we?void 0:we.Gf("EnsureFocusTime");H.a.$(512500625,801,50,"PPT save and download a copy");this.pb.P6a?this.zdd(Oc):(this.UG.show(!0,Y),null===(Qe=this.D5b)||void 0===Qe?void 0:Qe.Gf("SpinnerShowTime"),Y=null===(kf=this.Jm)||void 0===kf?void 0:kf.jlc(),!this.Jb.getBooleanAppSetting("EnableConditionalForceSaveInDownload")||Y&&Y.lN()&&(null===(Vf=this.Tem)||void 0===Vf?0:Vf.dY(this.Kw))?(null===(eg=this.D5b)||void 0===eg?void 0:eg.Gf("ExecutedForceSave"),this.N_.jOa(!1,!0,this.J0e,()=>{this.zdd(Oc)},
Object(h.a)(this,this.jLb,"saveFailureCallback"))):this.zdd(Oc),null===(zg=this.D5b)||void 0===zg?void 0:zg.Gf("ForceSaveCallTime"));this.jTe("DownloadACopy");return 32}zdd(Y){var Sa,Mb,oc,Oc;null===(Sa=this.D5b)||void 0===Sa?void 0:Sa.Gf("TriggerStart");this.UG.hide();null===(Mb=this.D5b)||void 0===Mb?void 0:Mb.Gf("SpinnerHideTime");Sa=Hh.U_l()?n.AFrameworkApplication.upb:this.wcm?this.STe(this.lug):this.lug;Y&&Y.FileDownloadUrl&&(Sa=Y.FileDownloadUrl.toString());this.KBn();this.Kfm&&!this.Kfm()&&
this.Phm&&this.Phm("3555692408")?this.Cod.sendMessage(gg.a.download,{}):this.cDn?(this.WFn.Yeo(Sa),this.PF.$La("DownloadModalTime",zi.a.Pf(new Date))):this.Gb.aO(!0,Sa,!0);null===(oc=this.D5b)||void 0===oc?void 0:oc.Gf("ET");null===(Oc=this.D5b)||void 0===Oc?void 0:Oc.hO()}KBn(){this.WEn&&this.Y$&&this.Y$.execute(Y=>{Y.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})}c4e(Y,Sa,Mb,oc,Oc){Y="";this.whm&&(Y=this.Tem.dY(this.Kw)?String.format(ResourceStrings.L_SavingStatus):
this.I_e?String.format(CommonUIStrings.l_SavedToStatus,this.I_e):String.format(ResourceStrings.L_SavedStatus));Oc[zb.a.Value]=Y;return 32}bpn(Y,Sa,Mb){return this.gMk(Mb,0,Y)}dpn(Y,Sa,Mb){return this.gMk(Mb,8,Y)}cpn(Y,Sa,Mb){return this.gMk(Mb,4,Y)}gMk(Y,Sa,Mb){if(this.qf.Hd(this.Kw))return 16;if(1===Y)return!this.rc.zl()||n.AFrameworkApplication.tna?8:this.GUe();if(this.Vgm())return H.a.$(512500624,328,50,"Printing not allowed for IRM protected documents"),16;H.a.$(512500623,328,50,"PPT Editor print. PublishOption: {0}",
Sa);this.sa.nj();this.Na.ee();this.pb.P6a?this.Gwm(Sa):(this.UG.show(!0,Mb),this.N_.jOa(!1,!0,this.J0e,()=>{this.Gwm(Sa)},Object(h.a)(this,this.jLb,"saveFailureCallback")));this.jTe("Print-"+Mb);return 32}Gwm(Y){this.UG.hide();this.cGn.print(this.pb.ei.string,this.STe(this.m_printUrl),Y)}ikd(Y,Sa,Mb){if(this.qf.Hd(this.Kw))return 16;if(1===Mb)return!this.rc.zl()||n.AFrameworkApplication.tna?8:this.GUe();this.LQh.OYl=new Date;H.a.$(508065485,328,50,"PPT Editor download a copy as PDF");this.sa.nj();
this.Na.ee();this.pb.P6a?this.Dwm():(this.UG.show(!0,Y),this.N_.jOa(!1,!0,this.J0e,()=>{this.Dwm()},Object(h.a)(this,this.jLb,"saveFailureCallback")));this.jTe("DownloadACopyAsPDF");this.fUm();return 32}Dwm(){this.UG.hide();this.LQh.Jwm=new Date;this.zQh.convert(this.pb.ei.string,1,this.STe(this.dEn))}jkd(Y,Sa,Mb){if(this.qf.Hd(this.Kw))return 16;if(1===Mb)return!this.rc.zl()||n.AFrameworkApplication.tna?8:this.GUe();H.a.$(508065484,801,50,"PPT Editor download as images");this.sa.nj();this.Na.ee();
this.pb.P6a?this.Ewm():(this.UG.show(!0,Y),this.N_.jOa(!1,!0,this.J0e,()=>{this.Ewm()},Object(h.a)(this,this.jLb,"saveFailureCallback")));this.jTe("DownloadAsImages");return 32}XYh(Y,Sa,Mb){if(this.qf.Hd(this.Kw))return 16;if(1===Mb)return!this.rc.zl()||n.AFrameworkApplication.tna?8:this.GUe();H.a.$(508065483,801,50,"PPT Editor save slides as images");this.sa.nj();this.Na.ee();this.pb.P6a?this.NYl():(this.UG.show(!0,Y),this.N_.jOa(!1,!0,this.J0e,()=>{this.NYl()},Object(h.a)(this,this.jLb,"saveFailureCallback")));
this.jTe("SaveSlidesAsImages");return 32}Ewm(){this.UG.hide();this.zQh.convert(this.pb.ei.string,2,this.STe(this.Jdm))}NYl(){this.UG.hide();var Y=this.STe(this.Jdm),Sa=this.sa.rg();0<Sa.length&&(Sa=Hj.c(Sa,Mb=>Mb.sid.toString()).join(","),Y=new Rc.QueryStringBuilder(Y),Y.ej(yg.a.AAm,Sa),this.zQh.convert(this.pb.ei.string,2,Y.toString()))}hkd(Y,Sa,Mb){if(this.qf.Hd(this.Kw))return 16;if(1===Mb)return!this.rc.zl()||n.AFrameworkApplication.tna?8:this.GUe();if(this.PF.hasDeferredContent())return this.kem&&
this.PJ.VPf(),H.a.$(512500622,843,15,"DownloadACopyAsOdp is triggered while document has deferred content"),this.PF.C_h("DownloadACopyAsOdp",new Mi.a,()=>{this.Z4k()}),8;this.sa.nj();this.Na.ee();this.pb.P6a?this.Z4k():(this.UG.show(!0,Y),this.N_.jOa(!1,!0,this.J0e,()=>{this.Z4k()},Object(h.a)(this,this.jLb,"saveFailureCallback")));return 32}jLb(){this.UG.hide();return!1}Z4k(){this.UG.hide();this.zQh.convert(this.pb.ei.string,0,this.STe(this.cEn))}Y8c(Y,Sa,Mb,oc,Oc){if(this.qf.Hd(this.Kw))return 16;
if(1===Mb)return 32;H.a.$(508065482,801,50,"PPT Editor save file change");this.sa.nj();this.Na.ee();this.N_.jOa(!1,!0,!0,nd=>{if(Oc&&1<=Oc.length)Oc[0](nd)},nd=>Oc&&2<=Oc.length?(Oc[1](nd,nd.ServerError.Code),!0):!1);return 32}HHn(){const Y=new Rc.QueryStringBuilder(td.a.ZAa("DownloadACopyHandler.ashx"));Y.ej(yg.a.Eqd,this.pb.ei.string);Y.ej(yg.a.Ona,this.pb.sessionInfo);Y.ej("fn",n.AFrameworkApplication.fileName);n.AFrameworkApplication.Peb(Y);return Y.toString()}STe(Y){if(Y){const Sa=new Rc.QueryStringBuilder(Y);
this.pb&&this.pb.podSessionId&&0>Y.indexOf(this.pb.podSessionId)&&(Sa.Xhd(yg.a.caa+"="+this.pb.podSessionId),H.a.$(512500620,801,50,"Append PodSessionId in url: {0}",this.pb.podSessionId));this.HGn&&n.AFrameworkApplication.Dz.LP&&0<n.AFrameworkApplication.Dz.LP.length&&(Sa.ej(yg.a.zDk,n.AFrameworkApplication.Dz.LP),H.a.$(512500619,801,50,"Appended FileName in url"));this.dFn&&(Sa.ej(yg.a.Rom,"true"),H.a.$(512500618,801,50,"Appended IsPasswordProtectedFile param"));n.AFrameworkApplication.Peb(Sa);
return Sa.toString()}return null}jTe(Y){const Sa=ei.a.vfa(sf.a.Enc,!0);H.a.$(509448414,801,15,"DocOperation={0};SimplifiedRibbonON={1}",Y,Sa)}fUm(){const Y=new x.a;Y.name="IsLabeled";const Sa=this.Jb.Ma("AppliedPolicyId");Y.bool=!!(Sa&&0<Sa.length);Aa.a("PdfProtectionUsage",!0,void 0,[Y])}pac(Y){this.Cod=Y}GUe(){return n.AFrameworkApplication.Mz?8:32}static U_l(){const Y=n.AFrameworkApplication.Mz,Sa=!Eb.a.wb(n.AFrameworkApplication.upb),Mb=n.AFrameworkApplication.ha.getBooleanAppSetting("SupportsOfficeClientCoauthoring"),
oc=n.AFrameworkApplication.ha.getBooleanAppSetting("PPTClpSwitchEnabled");H.a.$(512500617,801,50,"FIsClpProtectedFileAndDownloadEnabled - fProtected:{0} fHasDownload:{1} fClpTenantSwitchEnabled:{2} fClpPPTSwitchEnabled:{3}",Y,Sa,Mb,oc);return Y&&Sa&&Mb&&oc}}Object(c.a)(Hh,"DocumentOperationsActor",null,[502]);class Ei{}Ei.Vl="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(c.a)(Ei,
"EmbedDialogHtml",null,[]);class Xg{constructor(Y,Sa,Mb,oc){this.fCk=Y;this.lra=Sa;this.xom=Mb;this.value=oc}}Object(c.a)(Xg,"OptionInfo",null,[]);class Ee{constructor(Y,Sa,Mb){this.p6k=Y;this.dYe=Sa;this.lra=Mb}}Object(c.a)(Ee,"SectionInfo",null,[]);var Jf=a(340);class Ze extends lb.a{constructor(Y,Sa){Sa=void 0===Sa?!1:Sa;super(!1,!1,Sa);this.VJl=476;this.cDh=288;this.jNm=798;this.vQm=476;this.tQm=288;this.mWh={};this.vsd=[];this.JHa=this.tvc=this.Ngi=this.ZCh=this.mEh=this.BSe=null;this.xXm=Mb=>
{this.RTl(Mb);return!0};this.yXm=Mb=>this.IZe(Mb,this.RTl);this.RTl=Mb=>{Mb=Mb.DE;"visible"===Mb.p6k.style.visibility?(Mb.p6k.style.visibility="hidden",Mb.lra.className=Ca.d(Ze.NJl),Mb.lra.title=Object(ba.a)("Expand"),Mb.dYe.title=Object(ba.a)("Expand")):(Mb.p6k.style.visibility="visible",Mb.lra.className=Ca.d(Ze.mSm),Mb.lra.title=Object(ba.a)("Collapse"),Mb.dYe.title=Object(ba.a)("Collapse"))};this.uVn=Mb=>{this.wom(Mb);return!0};this.vVn=Mb=>this.IZe(Mb,this.wom);this.wom=Mb=>{const oc=this.mWh[Mb.DE.toString()];
oc.value?(oc.value=0,oc.lra.className=Ca.d(Ze.jSm),oc.xom.setAttribute(Fa.a.Cyi,Fa.a.Npa)):(oc.value=1,oc.lra.className=Ca.d(Ze.FMm),oc.xom.setAttribute(Fa.a.Cyi,Fa.a.iE));this.Xlo(Mb.DE.toString(),oc.value.toString())};this.xio=()=>{this.JHa.select()};this.sff=n.AFrameworkApplication.LLc;this.yEh=Y;this.lEh=this.uVn;this.Mgi=this.vVn;this.w7h=this.xXm;this.GRe=this.yXm;this.$Eh=this.xio;this.QOm=Sa;this.Vl=Ei.Vl;this.Ue=0;this.rj="EmbedDialog"}get pOb(){return this.cDh}set pOb(Y){this.cDh=Y}fAm(Y){const Sa=
{["id"]:this.rj,["bodyControls"]:{},["embedPreviewSectionTitle"]:Object(ba.a)("Preview"),["embedCodeSectionTitle"]:Object(ba.a)("EmbedCode"),["dimensionsSectionTitle"]:Object(ba.a)("Dimensions"),["interactionSectionTitle"]:Object(ba.a)("Interaction"),["initialPreviewUrl"]:td.a.xl(this.yEh,"wdPreview","1"),["initialEmbedUrl"]:this.sff,["getEmbedCode"]:Ze.K2l,["codeCopiedText"]:Object(ba.a)("EmbedCodeCopied")};for(const Mb of Object.keys(Y))Sa[Mb]=Y[Mb];this.Ue=1;this.vg(1,Object(ba.a)("CopyAction"));
this.vg(0,Object(ba.a)("Close"));this.qp(Object(ba.a)("Embed"),null,Sa)}Nad(){if(this.QOm)this.fAm({});else{this.showDialog(Object(ba.a)("Embed"),null);this.BSe=document.getElementById("embedpreviewpane");this.mEh=document.getElementById("embedoptionpane");this.BSe.style.width=String.format("{0}px",this.vQm);this.tvc=document.createElement("iframe");this.tvc.className=Ze.sQm;this.tvc.frameBorder="0";this.tvc.style.height=String.format("{0}px",this.tQm);this.tvc.tabIndex=-1;this.BSe.appendChild(this.uIh(Object(ba.a)("Preview"),
this.tvc,Ze.bNl,Ze.uQm,Ze.bNl,!0));this.JHa=document.createElement("textarea");this.JHa.className=Ze.xNm;Sys.UI.DomElement.addCssClass(this.JHa,Jf.a.VHa);this.JHa.id=Ze.yNm;Na.a.Fj||(this.JHa.readOnly=!0);this.JHa.rows=4;this.JHa.style.fontFamily=Object(ba.a)("UserInterfaceFontName");this.JHa.style.fontSize=Object(ba.a)("UserInterfaceFontSize");this.JHa.setAttribute(Fa.a.nba,String.format("{0} {1}",Ze.UJl,Ze.TJl));this.BSe.appendChild(this.uIh(Object(ba.a)("EmbedCode"),this.JHa,Ze.UJl));bc.a.addHandler(this.JHa,
"focus",this.$Eh);var Y=document.createElement("span");Y.className=Ze.WNm;Y.innerText=Object(ba.a)("CopyText");Y.id=Ze.TJl;this.BSe.appendChild(Y);this.ZCh=document.createElement("div");this.ZCh.className=Ze.mNm;this.mEh.appendChild(this.uIh(Object(ba.a)("Dimensions"),this.ZCh));this.Ngi=document.createElement("div");this.mEh.appendChild(this.L3m(Ze.$Pm,Object(ba.a)("Interaction"),this.Ngi));this.Ue=0;this.vg(1,Object(ba.a)("Close"));this.jEm();this.AEm();Na.a.Fj||this.JHa.focus()}}dispose(){if(this.mWh){var Y=
this.mWh;for(const Sa in Y){const Mb=Y[Sa];this.pv.hc(Z.a.click,Mb.fCk,this.lEh);this.Tj.hc(Z.a.oi,Mb.fCk,this.Mgi);this.Tj.hc(Z.a.jn,Mb.fCk,this.Mgi)}this.Mgi=this.lEh=this.mWh=null}if(this.vsd){for(Y=0;Y<this.vsd.length;++Y)this.pv.hc(Z.a.click,this.vsd[Y].dYe,this.w7h),this.Tj.hc(Z.a.oi,this.vsd[Y].dYe,this.GRe),this.Tj.hc(Z.a.hA,this.vsd[Y].dYe,this.GRe),this.Tj.hc(Z.a.jn,this.vsd[Y].dYe,this.GRe);this.Tj=this.w7h=this.vsd=null}this.$Eh&&this.JHa&&(bc.a.removeHandler(this.JHa,"focus",this.$Eh),
this.$Eh=null);this.JHa=this.tvc=this.Ngi=this.ZCh=this.mEh=this.BSe=null;super.dispose()}gJa(){super.gJa();this.Cc.style.width=String.format("{0}px",this.jNm);this.OHb()}kEm(Y,Sa){const Mb=td.a.xl(this.sff,Y,Sa);return this.sff!==Mb?(this.sff=Mb,this.yEh=td.a.xl(this.yEh,Y,Sa),!0):!1}jEm(){this.JHa&&(this.JHa.innerText=Ze.K2l(this.sff,this.VJl,this.cDh))}AEm(){this.tvc&&this.tvc.contentWindow.location.replace(td.a.xl(this.yEh,"wdPreview","1"))}Xlo(Y,Sa){this.kEm(Y,Sa)&&(this.jEm(),this.AEm())}uIh(Y,
Sa,Mb,oc,Oc,nd){Mb=void 0===Mb?null:Mb;oc=void 0===oc?null:oc;Oc=void 0===Oc?null:Oc;nd=void 0===nd?!1:nd;const Cd=document.createElement("div");Cd.className=Ze.cRm;oc&&(Cd.id=oc);Oc&&Cd.setAttribute(Fa.a.nba,Oc);nd&&(Cd.tabIndex=0);oc=document.createElement("span");oc.className=Ze.dRm;oc.innerText=Y;Mb&&(oc.id=Mb);Cd.appendChild(oc);Cd.appendChild(Sa);return Cd}L3m(Y,Sa,Mb){Sa=this.uIh(Sa,Mb);const oc=this.Pi.createElement("div");oc.className=Ze.eMm;oc.id=Ze.gMm+Y;oc.setAttribute(Fa.a.ii,Fa.a.fM);
oc.tabIndex=0;Sa.insertBefore(oc,Mb);Y=Ca.a(16,16,Ze.fMm,Ze.hMm,!0,"");oc.appendChild(Y);Y=Y.childNodes[0];Y.className=Ca.d(Ze.NJl);Y.title=Object(ba.a)("Expand");oc.title=Object(ba.a)("Expand");Mb.style.visibility="hidden";Mb=new Ee(Mb,oc,Y);Array.add(this.vsd,Mb);this.pv.u0(Z.a.click,oc,this.w7h,Mb);this.Tj.u0(Z.a.oi,oc,this.GRe,Mb);this.Tj.u0(Z.a.hA,oc,this.GRe,Mb);this.Tj.u0(Z.a.jn,oc,this.GRe,Mb);return Sa}static K2l(Y,Sa,Mb){if(!Ze.igi){const oc=String.format('<a target="_blank" href="{0}">{1}</a>',
Eb.a.Y3d("https://office.com"),Object(ba.a)("Office")),Oc=String.format('<a target="_blank" href="{0}">{1}</a>',Eb.a.Y3d("https://office.com/webapps"),Object(ba.a)("WebAppName"));Ze.igi=String.format(Object(ba.a)("NoFrames"),oc,Oc)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',Eb.a.Y3d(Y),Sa,Mb,Ze.igi)}}Ze.igi=null;Ze.FMm="CheckboxChecked_16x16x32";Ze.jSm="CheckboxUnchecked_16x16x32";Ze.mSm="OutlookSearchChevronUp_16x16x32";Ze.NJl="OutlookSearchChevronDown_16x16x32";
Ze.fMm="UpArrowServer";Ze.cRm="EmbedSectionHeader";Ze.dRm="EmbedSectionName UIFontBold";Ze.WNm="EmbedCodeFooter";Ze.sQm="EmbedPreviewFrame";Ze.xNm="EmbedCodeTextArea";Ze.mNm="EmbedDimensionSection";Ze.hMm="EmbedArrowIcon";Ze.eMm="WACGlyph EmbedArrowHolder";Ze.yNm="EmbedCode";Ze.UJl="EmbedCodeHeader";Ze.bNl="Preview";Ze.uQm="PreviewHeader";Ze.$Pm="Options";Ze.gMm="Arrow";Ze.TJl="EmbedCodeFooter";Object(c.a)(Ze,"EmbedDialog",lb.a,[]);class Xj extends Ze{constructor(Y,Sa){super(Y,!0);Sa&&Sa&&!isNaN(Sa)||
H.a.$(507843799,820,10,"Invalid aspectRatio in ReactEmbedDialog");this.kEm(yg.a.Qom,Sa.toString())}Nad(){const Y=[];Y.push({["id"]:"wdEaaCheck",["checkboxInitialValue"]:!1,["checkboxLabel"]:ResourceStrings.l_AutoAdvanceLabel,["urlTransformFunctionOnChange"]:Xj.x3n});this.fAm({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.VJl,["defaultHeight"]:this.cDh,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:ResourceStrings.l_EmbedSlideWidth,["heightLabel"]:ResourceStrings.l_EmbedSlideHeight},
["interactionOptions"]:Y})}static x3n(Y,Sa,Mb){return"wdEaaCheck"===Sa?td.a.xl(Y,Sa,Mb?"1":"0"):Y}}Object(c.a)(Xj,"ReactEmbedDialog",Ze,[]);class Ij{constructor(Y,Sa,Mb,oc,Oc){this.Rgb=null;this.$bk=!1;this.Cod=null;this.Gb=Y;this.adk=Sa;this.vug=Mb;this.Wdk=oc;this.pb=Oc}Nad(Y,Sa,Mb){(Y=(Y=n.AFrameworkApplication.zB)||this.pb.P6a)||this.$bk||(Y=!this.jDm());return 1===Mb?Y?2:32:this.peo()}peo(){if(!this.$bk)return 8;if(n.AFrameworkApplication.LLc&&this.vug)this.Fzm();else{const Y=n.AFrameworkApplication.g8e?
this.Cod.sendMessage(gg.a.l0l,null)?32:8:2;return 32!==Y?this.Gb.aO(!0,n.AFrameworkApplication.oWe):Y}return 32}oeo(Y){Y.Values.HostEmbeddedViewUrl&&(this.vug=n.AFrameworkApplication.LLc=Y.Values.HostEmbeddedViewUrl.toString(),this.Fzm())}jDm(){return!1}qTm(Y,Sa){this.Rgb=Sa;this.$bk=!!this.Gb&&!!this.adk&&!(void 0===this.vug||null===this.vug)&&!!Y&&!!Sa}Fzm(){(new Xj(this.vug,this.Rgb)).Nad()}}Object(c.a)(Ij,"EmbedManager",null,[]);class xj{constructor(Y,Sa,Mb){this.Rgb=null;this.BEn={};for(Sa=0;Sa<
Y.length;Sa++)this.BEn[Y[Sa].Format.toString()]=Sa;this.Rgb=Mb&&!isNaN(Mb)&&isFinite(Mb)?Mb:0}}Object(c.a)(xj,"FormatPicker",null,[]);class nh extends Ij{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd){super(Y,Sa,Mb,nd,Cd,Zd);this.la=oc;this.Xb=Oc}Kb(){this.la.Ba(tb.a.Nad,Ta.a.application,Object(h.a)(this,this.Nad,"showEmbedDialog"));this.Wdk.execute(Object(h.a)(this,this.pac,"onHostPostmessengerCreated"))}Ae(){}jDm(){var Y=this.Xb.qC();if(!this.adk||!Y.height)return!1;Y=Y.width/Y.height;const Sa=new xj(this.adk,
!1,Y);this.qTm(Sa,Y);return!0}pac(Y){this.Cod=Y;n.AFrameworkApplication.XV||n.AFrameworkApplication.LLc||!this.Cod||(this.Cod.Yt(gg.a.cGi),this.Cod.hD(gg.a.cGi,Object(h.a)(this,this.oeo,"showEmbedDialogPostMessage")))}}Object(c.a)(nh,"EmbedActor",Ij,[502]);var fh=a(1704),ng=a(52),R=a(859),Ha=a(843);class wb{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf){this.la=Y;this.Bxb=Sa?Sa.va:null;this.ya=Mb;this.zc=oc;this.rb=Oc;this.rw=nd;this.Tb=Cd;this.il=Zd;this.le=we;this.e_e=null;this.Na=Qe;this.Kw=Mb.presentation;
this.Me=kf;this.rf=null;this.mxb=Vf}Kb(){this.la.ua(tb.a.EJe,ng.a.application,Object(h.a)(this,this.Ypn,"handleUploadAudioDialog"),4)}Ae(){}Ypn(Y,Sa,Mb){const oc=this.ya.Ia;if(!oc||this.zc.Hd(oc))return 16;if(1===Mb)return 32;if(this.Bxb){this.rf=zi.a.Xk("Audio::Insert");try{return Ha.a.u6e("audio/*",R.e,()=>R.d(Y,Object(h.a)(this,this.wvn,"insertAudioSuccessAfterUploadUsingMediaUpload"),"audio",this.Me,oc),"audio",oc,this.ya.presentation,this.zc,this.le,this.rf,!1,this.mxb,50,10,3),this.rf&&this.rf.Za("AudioDialogInitialized",
"true"),32}catch(Oc){H.a.$(509724633,818,10,"Error while rendering new audio selection dialog.")}}else return H.a.$(512500560,822,15,"Insert Audio initialization failed."),8;this.showErrorMessage(446,null);return 8}showErrorMessage(Y,Sa){this.rf&&(this.rf.finish(),this.rf=null);this.le.nM(Y,Mb=>{Mb.UE=1;Mb.Ifb=Sa;return!1})}wvn(Y,Sa,Mb,oc,Oc,nd,Cd){oc.NO(Mb)&&H.a.$(512500553,822,15,"Audio::InsertAudioSuccessAfterUploadUsingMediaUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-
+Mb.Zha);oc.BE(Mb);Oc&&Oc.Za("AudioUploadToRC","true");Object(fb.a)("FixForInsertMediaSlideNavigationIssue")||(Cd=this.ya.Ia);Mb=Cd.Av();var Zd=this.Kw.slideWidth,we=this.Kw.slideHeight;oc=fh.a.Bf(32,0);const Qe=fh.a.Bf(32,1);Zd=Zd/2-fh.a.Bf(16,0);we=we/2-fh.a.Bf(16,1);if(Cd&&Cd.isConnected){var kf=this.Tb.Kd(15,void 0,void 0,()=>{this.rw.MJ=this.e_e;this.rb.selectShape(this.e_e,!0);this.Na.ee()});try{kf.tc(Cd);kf.wc=Y;Oc&&Oc.Za("CreatingAudioShape","true");this.e_e=this.il.eIa(!1,Cd.fc.cid,Cd.fc.sid,
0,10,Zd,we,oc,Qe,Mb+1);const Vf=nd.files[0].name;this.e_e.lkc=Sa;this.e_e.kkc=Vf;Cd.BJ(this.e_e)}finally{kf&&kf.dispose()}Oc&&(Oc.Za("AudioShapeSuccessfullyCreated","true"),Oc.finish(),Oc=null)}}}Object(c.a)(wb,"InsertAudioActor",null,[502]);var Yb=a(132);class zc{constructor(){this.y4d=this.wKd=null}}Object(c.a)(zc,"CreatePickerCustomizationDictionaryOptions",null,[1864]);var Ic=a(176),Wc=a(43);class rd{}rd.Vl="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(c.a)(rd,"InsertMediaDialogHtml",null,[]);class vd{}vd.Vl="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(c.a)(vd,"InsertMediaM365DialogHtml",null,[]);var Rd=a(376);class me{static get Vl(){return lb.a.jU(me.Sx,ResourceStrings.l_InsertOnlineVideoDescription,ResourceStrings.l_InsertOnlineVideoPrivacy,ResourceStrings.L_LearnMore,
"http://go.microsoft.com/fwlink/?linkid=2010177")}}me.Sx="<div class='VideoUrl' id='videourl'> <label id='labelVideoUrl' class='WACDialogLabel' for='url' >{0}</label> </div> <div class='VideoUrl' id='videourl'> <input type='text' id='url' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='VideoOutput' id='videooutput'> <label id='privacyandtos' class='WACDialogLabel' >{1}</label> </div> <div class='LearnMore' id='learnmore'> <a id='learnmore' class='LearnMore' href={3} target='newtab' >{2}</a> </div> <div class='VideoOutput' id='videooutput'> <label id='labelmessage' class='WACDialogLabel' >message</label> </div>";
Object(c.a)(me,"InsertOnlineVideoDialogHtml",null,[]);class ce extends lb.a{constructor(Y){super();this.xY(1,!0);this.vg(1,ResourceStrings.L_Insert);this.Vl=me.Vl;this.SYa=Y;this.j$=!1}rEb(){this.width=50;this.qp(ResourceStrings.L_OnlineVideo,Object(h.a)(this,this.Bvn,"insertOnlineVideoDialogHandler"),{["url"]:""});document.getElementById("labelmessage").innerText="";document.getElementById("labelmessage").setAttribute(Fa.a.TAf,Fa.a.VRl);const Y=document.getElementById("url");this.xY(1,!!Y&&0<Y.value.length);
bc.a.addHandler(Y,Z.a.input,Object(h.a)(this,this.KVh,"onPatternChanged"));bc.a.addHandler(Y,Z.a.change,Object(h.a)(this,this.KVh,"onPatternChanged"));this.f6(Y)}hide(){const Y=document.getElementById("url");Y&&(bc.a.removeHandler(Y,Z.a.input,Object(h.a)(this,this.KVh,"onPatternChanged")),bc.a.removeHandler(Y,Z.a.change,Object(h.a)(this,this.KVh,"onPatternChanged")));super.hide()}Bvn(Y,Sa){if(1===Y){if(Sa){var Mb=zi.a.Xk("InsertOnlineVideo",1);Mb.Oq=!0;Y=Sa.url.trim();(Y=this.SYa.L_l(Y))?this.SYa.qPh(Y)&&
this.SYa.zam(Y)?(H.a.$(512500548,352,50,"[Insert Online Video] Creating Hubble request for {0}",this.SYa.fhj(Y)),this.SYa.requestVideoData(Y,oc=>{zi.a.PB(Mb,()=>{this.C0(oc)})},Object(h.a)(this,this.Lan,"failCallback"))):(H.a.$(512500547,352,10,"[Insert Online Video] Dialog url doesn't match, given url: "+this.SYa.fhj(Y)),this.fail(null,ResourceStrings.l_InsertOnlineVideoUnsupportedProvider)):(H.a.$(512500549,352,10,"[Insert Online Video] Dialog url is null!"),this.fail(null,ResourceStrings.l_InsertOnlineVideoIframeError))}}else this.hide()}C0(Y){this.hide();
this.SYa.NNh(Y)}Lan(Y){this.fail(Y,ResourceStrings.l_CannotInsertOnlineVideo)}fail(Y,Sa){if(document.getElementById("labelmessage")){var Mb=+new Date-+this.SYa.startTime;document.getElementById("labelVideoUrl").removeAttribute("for");document.getElementById("labelmessage").innerText=Sa;document.getElementById("labelmessage").setAttribute("for","url");document.getElementById("url").focus();Y&&H.a.$(512500545,352,10,"InsertOnlineVideoDialog:Fail {0}",JSON.stringify({["TimeMs"]:Mb,["ResponseCode"]:Y.data.Je}))}else H.a.$(512500546,
352,15,"[Insert Online Video] Request failed after the dialog dissapeared!")}KVh(){zi.a.vQa();const Y=document.getElementById("url");this.xY(1,!!Y&&0<Y.value.length)}}Object(c.a)(ce,"InsertOnlineVideoDialog",lb.a,[1005]);var yb=a(83),Tc=a(1316),bd=a(74);class kd{constructor(Y,Sa,Mb){this.Qif=Hg.a.u$;this.dM=null;this.Aa=Y;this.sci=Sa;this.cXa=Mb}get Ft(){return this.Aa}get ffa(){return this.dM||(this.dM=vb.a.instance.resolve("Common.Utils.IAriaNotifier"))}get XZ(){return this.Qif}set XZ(Y){this.Qif=
Y}Klc(Y){try{e.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",Y.length);const Sa=this.sci.f1n(Y);let Mb=2;if(Sa&&0<Sa.length){const oc=new Tc.a;oc.setValue(bd.a.uY,Sa);oc.setValue(bd.a.Pmd,!0);if(this.cXa){const Oc=this.cXa.H6e("ClipboardOperation");Oc.yid("insertOnlineImage");oc.setValue(bd.a.BXa,Oc)}n.AFrameworkApplication.ha.getBooleanAppSetting("OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.ffa.maa(Box4Intl.Box4Strings.l_ImageUploading,
!0);Mb=this.Aa.Ra(this.XZ,2,oc)}e.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",Y.length,32===Mb,""===Sa)}catch(Sa){e.ULS.sendTraceTag(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",Sa.toString())}}}Object(c.a)(kd,"InsertOnlineImageHandler",null,[826]);class zd extends kd{constructor(Y,Sa,Mb){super(Y,Sa,void 0===Mb?null:Mb)}get iXl(){return gg.a.rYe}get XXe(){return gg.a.H8l}dpm(Y){return this.sci.jWn(Y)}i4l(Y){return Y.Type}COh(Y,
Sa){return this.sci.COh(Y.Type,Sa)}fpm(Y){const Sa=[];if(Y&&Y.data&&Y.data.value&&0<Y.data.value.length)for(let oc=0;oc<Y.data.value.length;oc++)if(Y.data.value[oc]&&Y.data.value[oc].urls&&Y.data.value[oc].urls.download){var Mb=Y.data.value[oc];Mb=Object.assign(new yi.a,{OriginalUrl:Mb.urls.download,Type:Mb.extension||"",Caption:Mb.name,ContentType:"",Height:Mb.driveItem||Mb.driveItem.image?Mb.driveItem.image.height:0,Width:Mb.driveItem||Mb.driveItem.image?Mb.driveItem.image.width:0});Array.add(Sa,
Mb)}Sa.length||e.ULS.sendTraceTag(26071184,352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found");return Sa}Krm(Y,Sa,Mb){Mb=Mb(Y);if(Mb.length){Y=[];for(let oc=0;oc<Mb.length;oc++){const Oc=Mb[oc],nd={};nd.Extension=Oc.Type;nd.SourceUrl=Oc.OriginalUrl;nd.SourceUrl=Oc.OriginalUrl;nd.Width=Oc.Width;nd.Height=Oc.Height;Array.add(Y,nd)}Mb={};Mb.Items=Y;Sa.sendMessage(this.XXe,Mb)}}}Object(c.a)(zd,"InsertOnlineImageHelperBox4",kd,[825,826]);class fe extends zd{constructor(Y,
Sa,Mb){super(Y,Sa);this.$Sg=Mb.qgb;this.XZ=tb.a.vYe}Klc(Y){if(Y&&0<Y.length){var Sa=td.a.VK(Y[0].OriginalUrl);Sa=this.lkg(Sa)?Sa:"unsupported";H.a.$(512517837,352,50,"InsertMediaCallback: Insert online video called for {0}",Sa);this.Ft.Ra(this.XZ,2,Y[0])}}lkg(Y){if(!Y)return!1;Y=Y.trim();for(const Sa of this.$Sg)if((new RegExp(Sa)).test(Y))return!0;return!1}}Object(c.a)(fe,"InsertOnlineVideoHelper",zd,[]);class Ye{static get Vl(){return lb.a.jU(Ye.Sx,ResourceStrings.l_InsertSocialMediaDialogMsg)}}
Ye.Sx="<div class='WACDialogRow' id='block1'> <div class='WACDialogGroupBox' id='SocialmediaLabelDiv' style=\"width:300px;word-wrap: break-word;\"> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> </div>";Object(c.a)(Ye,"InsertSocailMediaDialogHtml",null,[]);var pf=a(108),Je=a(285);class Ff extends Sys.EventArgs{constructor(Y,Sa,Mb,oc){super();this.slideId=Y;this.Q9=Mb;this.shapeId=Sa;this.iconName=oc}}Object(c.a)(Ff,"IconChangedEventArgs",Sys.EventArgs,[]);var Cg=a(597),sh=a(71);
class Og{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg,yh,qg,Ug,Zh,Ii,Jl,Tl,jm,Pj,Gj,dk,ql,yl,rl,qi){this.zCg=this.IVc=this.zOh=!1;this.S0e=this.g7b=null;this.BLb=($i,Cj,wm)=>{if(!this.nEb(this.ya.Ia,$i,this.na.H0b))return 8;if(1===wm)return 32;let cm,Ym;n.AFrameworkApplication.zB||n.AFrameworkApplication.Mz||!this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCreateWithAI",!1)?n.AFrameworkApplication.zB||n.AFrameworkApplication.Mz||!this.na.getBooleanAppSetting("CopilotDalleLicenseCheckEnabled")?
this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertDalle",!1)&&(Ym="dalle"):this.Pgb.execute(Ul=>{Ul.isFeatureEnabled("Copilot",!1).then(Zm=>{Zm&&(Ym="dallecore")})}):Ym="dallecore";Cj=new Rc.QueryStringBuilder(this.Khn($i));Cj.ej("entryPoint",tb.a.gv($i));Ym&&Cj.ej(Ym,"1");switch($i){case tb.a.DMc:case tb.a.E5d:cm=1;this.swb.XZ=tb.a.uYe;break;case tb.a.pYe:case tb.a.qYe:Cj.Cz("initpivot","dalle");cm=1;this.swb.XZ=tb.a.uYe;break;case tb.a.Bmd:cm=1;this.swb.XZ=tb.a.Gmd;break;case tb.a.wUb:fb.a("ChangePictureFromIconsFixEnabled")?
this.p4b.XZ=tb.a.EUe:this.p4b.XZ=tb.a.DUe;cm=0;break;case tb.a.tkc:cm=0;this.p4b.XZ=tb.a.EUe;break;case tb.a.kjd:Cj.Cz("initpivot","dalle");cm=0;this.p4b.XZ=tb.a.EUe;break;case tb.a.zYb:Cj.ej("disabledpivots","stockvideos");cm=0;this.swb.XZ=tb.a.YXf;break;default:return H.a.$(512517955,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : unrecognized actionId",$i.toString()),16}this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableGettyApiExperiment",!1)&&(Cj.ej("gae","1"),hb.a.rJb("0fecb342;2aaje503"));
this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableGettyIngestionExperiment",!1)&&(Cj.ej("gie","1"),Cj.ej("semsearch","1"),hb.a.rJb("421a8839;gjbhf574"));this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnableHubbleSemanticSearchExperiment",!1)&&(Cj.ej("ss","1"),hb.a.rJb("fdfb7742;909ce823"));this.na.WMc&&Cj.ej("sv","1");const Jm=Cj.toString();if(!Jm||!Jm.length)return 16;H.a.$(512517954,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog.");try{const Ul=
Yb.a.create(),Zm=Eb.a.tS(this.na.ZTa).toString();this.Pgb.execute($m=>{var gn=this.na.uLj&&$m.isFreemiumUpsellEnabled();gn=this.IVc?1:gn?0:-1;var ln=this.Jb.getBooleanAppSetting("InsertOnlineM365ExperimentEnabled")?1:0;ln=this.vsa.zSl(Wc.App.mode,Jm,gn,cm,Ul.toString(),Zm,ln);$m=this.N_e.getInstance(ln,this.M_e,this.vsa,$m,vd.Vl);$m.correlationId=Ul;$m.kzb=2;$m.aJh=gn;$m.FJe(CommonUIStrings.L_PictureInsertTitle,$i===tb.a.wUb||$i===tb.a.tkc?this.p4b:this.swb,void 0);H.a.$(512517953,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog success.")});
return 32}catch(Ul){return H.a.$(512517952,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Exception = [{0}]",Ul.toString()),Og.ZF(pf.a.EWe,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}};this.na=Y;this.la=Sa;this.zc=Mb;this.sa=oc;this.Na=Oc;this.ya=nd;this.Tb=Cd;this.N_e=Zd;this.QEn=we;this.M_e=Qe;this.vsa=kf;this.Pgb=Vf;this.swb=eg;this.p4b=zg;this.Xb=yh;this.il=qg;this.La=Ug;this.zb=Zh;this.rw=Ii;this.zj=Jl;this.ene=Tl;this.Y5b=dk;this.GCg=ql;this.Fd=
yl;this.N5=Y.ucc;this.OA=Y.QK;this.Jb=qi;this.ene&&(this.ene.BVd.removeAttribute("style"),this.ene.BVd.style.display="none");this.mik=jm;this.REn=Pj;this.SYa=Gj;this.m8a=rl;this.Pgb.execute($i=>{$i.isFeatureEnabled("MsoPremiumStockImages",!1).catch(Cj=>H.a.$(593627152,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",Cj)).then(Cj=>{this.IVc=Cj;this.IVc||(this.g7b=$i.UKb("MsoPremiumStockImages",()=>{this.IVc=!0;H.a.$(512517962,352,50,"InsertMediaActor::Constructor - Thanks for purchasing!")}));
return null});$i.isFeatureEnabled("OmgStreamTwo",!1).then(Cj=>{this.zCg=Cj;this.zCg||(this.gim=$i.UKb("OmgStreamTwo",()=>{this.zCg=!0}))})})}Kb(){this.NTm();this.la.ua(tb.a.Gmd,ng.a.application,Object(h.a)(this,this.gno,"uploadIcon"),4);fb.a("ChangePictureOnMultiSelectFixEnabled")?this.la.ua(tb.a.DUe,ng.a.application,Object(h.a)(this,this.b0m,"changeToIcon"),4):this.la.ua(tb.a.DUe,ng.a.application,Object(h.a)(this,this.c0m,"changeToIcon"),4);this.la.ua(tb.a.Llc,ng.a.application,Object(h.a)(this,this.m2h,
"uploadOnlinePicture"),4);fb.a("ChangePictureOnMultiSelectFixEnabled")?this.la.ua(tb.a.$Ac,ng.a.application,Object(h.a)(this,this.yHh,"changeToOnlinePicture"),4):this.la.ua(tb.a.$Ac,ng.a.application,Object(h.a)(this,this.zHh,"changeToOnlinePicture"),4);this.la.ua(tb.a.uYe,ng.a.application,Object(h.a)(this,this.m2h,"uploadOnlinePicture"),4);fb.a("ChangePictureOnMultiSelectFixEnabled")?this.la.ua(tb.a.EUe,ng.a.application,Object(h.a)(this,this.yHh,"changeToOnlinePicture"),4):this.la.ua(tb.a.EUe,ng.a.application,
Object(h.a)(this,this.zHh,"changeToOnlinePicture"),4);this.la.ua(tb.a.Zcg,ng.a.application,Object(h.a)(this,this.m2h,"uploadOnlinePicture"),4);fb.a("ChangePictureOnMultiSelectFixEnabled")?this.la.ua(tb.a.FUe,ng.a.application,Object(h.a)(this,this.yHh,"changeToOnlinePicture"),4):this.la.ua(tb.a.FUe,ng.a.application,Object(h.a)(this,this.zHh,"changeToOnlinePicture"),4);this.MTm();this.la.ua(tb.a.rLj,ng.a.application,Object(h.a)(this,this.m2h,"uploadOnlinePicture"),4);fb.a("ChangePictureOnMultiSelectFixEnabled")?
this.la.ua(tb.a.vHh,ng.a.application,Object(h.a)(this,this.yHh,"changeToOnlinePicture"),4):this.la.ua(tb.a.vHh,ng.a.application,Object(h.a)(this,this.zHh,"changeToOnlinePicture"),4);this.OTm();this.la.ua(tb.a.vYe,ng.a.application,Object(h.a)(this,this.kno,"uploadOnlineVideo"),4);this.la.ua(tb.a.Fmd,ng.a.application,Object(h.a)(this,this.jno,"uploadOnlineHubbleVideo"),4);this.la.ua(tb.a.Lnc,Ta.a.application,Object(h.a)(this,this.Ylo,"updateEntryPoints"),96)}NTm(){this.la.ua(tb.a.Bmd,ng.a.application,
this.BLb,4);this.la.ua(tb.a.wUb,ng.a.application,this.BLb,4);this.la.ua(tb.a.insertOnlinePicture,ng.a.application,Object(h.a)(this,this.Ajl,"showInsertPictureDialog"),4);this.la.ua(tb.a.hjd,ng.a.application,Object(h.a)(this,this.Ajl,"showInsertPictureDialog"),4);fb.a("InsertSocialMediaVideoIcon")&&this.la.ua(tb.a.LNh,ng.a.application,Object(h.a)(this,this.Eeo,"showInsertSocialMediaDialog"),4);fb.a("InsertDalleIcon")&&(this.la.ua(tb.a.pYe,ng.a.application,this.BLb,4),this.la.ua(tb.a.qYe,ng.a.application,
this.BLb,4));this.la.ua(tb.a.DMc,ng.a.application,this.BLb,4);this.la.ua(tb.a.tkc,ng.a.application,this.BLb,4);fb.a("ChangePictureCreateWithAI")&&this.la.ua(tb.a.kjd,ng.a.application,this.BLb,4);this.la.ua(tb.a.E5d,ng.a.application,this.BLb,4);this.la.ua(tb.a.zYb,ng.a.application,this.BLb,4);this.na.Yse&&this.la.v7c("ppt_insertOnlinePictures",!0,tb.a.zYb,ng.a.application,this.BLb,Y=>{Wc.App.Zb.vpc(Y,this.m8a.AIb)});this.la.ua(tb.a.EMc,ng.a.application,Object(h.a)(this,this.Bjl,"showInsertPictureFromHostDialog"),
4);this.la.ua(tb.a.ijd,ng.a.application,Object(h.a)(this,this.Bjl,"showInsertPictureFromHostDialog"),4);this.na.Yse&&(this.la.v7c("ppt_insertOnlinePictures",!0,tb.a.insertOnlinePicture,ng.a.application,Object(h.a)(this,this.Ajl,"showInsertPictureDialog"),Y=>{Wc.App.Zb.vpc(Y,Object(h.a)(this.m8a,this.m8a.AIb,"getCommandById"))}),this.la.v7c("ppt_insertOnlinePictures",!0,tb.a.DMc,ng.a.application,this.BLb,Y=>{Wc.App.Zb.vpc(Y,Object(h.a)(this.m8a,this.m8a.AIb,"getCommandById"))}),this.la.v7c("ppt_insertOnlinePictures",
!0,tb.a.E5d,ng.a.application,this.BLb,Y=>{Wc.App.Zb.vpc(Y,Object(h.a)(this.m8a,this.m8a.AIb,"getCommandById"))}),this.la.v7c("ppt_insertOnlinePictures",!0,tb.a.EMc,ng.a.application,Object(h.a)(this,this.Bjl,"showInsertPictureFromHostDialog"),Y=>{Wc.App.Zb.vpc(Y,Object(h.a)(this.m8a,this.m8a.AIb,"getCommandById"))}))}MTm(){this.na.xYe&&this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)&&(this.la.ua(tb.a.wYe,ng.a.application,Object(h.a)(this,this.I_h,
"showInsertPictureFromMobileDeviceDialog"),4),this.la.ua(tb.a.ljd,ng.a.application,Object(h.a)(this,this.I_h,"showInsertPictureFromMobileDeviceDialog"),4),this.na.Yse&&(this.la.v7c("mso_insertMobileDevicePictures",!0,tb.a.wYe,ng.a.application,Object(h.a)(this,this.I_h,"showInsertPictureFromMobileDeviceDialog"),Y=>{Wc.App.Zb.vpc(Y,Object(h.a)(this.m8a,this.m8a.AIb,"getCommandById"))}),this.la.v7c("mso_insertMobileDevicePictures",!0,tb.a.ljd,ng.a.application,Object(h.a)(this,this.I_h,"showInsertPictureFromMobileDeviceDialog"),
Y=>{Wc.App.Zb.vpc(Y,Object(h.a)(this.m8a,this.m8a.AIb,"getCommandById"))})))}OTm(){this.la.ua(tb.a.CIa,ng.a.application,Object(h.a)(this,this.Hgc,"showInsertVideoDialog"),4);this.na.Yse&&this.la.v7c("ppt_insertOnlineVideos",!0,tb.a.CIa,ng.a.application,Object(h.a)(this,this.Hgc,"showInsertVideoDialog"),Y=>{Wc.App.Zb.vpc(Y,Object(h.a)(this.m8a,this.m8a.AIb,"getCommandById"))})}g1n(){n.AFrameworkApplication.xOc()&&n.AFrameworkApplication.pil()&&(n.AFrameworkApplication.Ha.get_element().appendChild(this.ene.BVd),
bc.a.addHandler(this.ene.BVd.contentWindow,"message",Object(h.a)(this,this.bAm,"showOneDriveFilePickerDialog")),this.zOh=!0)}bAm(Y){if(Y.rawEvent&&(Y=Y.rawEvent.data))try{H.a.$(512517961,352,50,"User select images.");const Sa=Sys.Serialization.JavaScriptSerializer.deserialize(Y,!0),Mb=Sa.MessageId?Sa.MessageId.toString():null;Sa&&Mb&&(Mb===gg.a.rYe||Mb===gg.a.HNh)&&this.mik.start(Mb===gg.a.rYe?this.swb:this.REn)}catch(Sa){H.a.$(512517960,352,10,"malformatted postmessage here.")}}Ae(){}Ylo(){return 32}Ajl(Y,
Sa,Mb){if(!this.nEb(this.ya.Ia,Y,this.na.cga))return 8;if(1===Mb)return 32;H.a.$(512517959,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog.");try{const oc=Yb.a.create(),Oc=Eb.a.tS(this.na.ZTa).toString(),nd=Y===tb.a.insertOnlinePicture&&this.na.Pqm?1:0;let Cd=String.format(this.na.FMc,n.AFrameworkApplication.lcid,xi.a.Le(n.AFrameworkApplication.lcid).name,n.AFrameworkApplication.buildVersion,oc.toString(),3,Oc,nd);0<this.na.FMc.search(RegExp("insertmedia.bing.office.net","gi"))&&(Cd=
this.vsa.eZm(Wc.App.mode,this.na.p3e?this.na.tYe:this.na.FMc));this.Pgb.execute(Zd=>{Zd=this.N_e.getInstance(Cd,this.M_e,this.vsa,Zd,rd.Vl);Zd.GMc=this.na.GMc;Zd.correlationId=oc;Zd.kzb=1;switch(Y){case tb.a.hjd:this.p4b.XZ=tb.a.$Ac;break;default:this.swb.XZ=tb.a.Llc}Zd.FJe(CommonUIStrings.L_PictureInsertTitle,Y===tb.a.insertOnlinePicture?this.swb:this.p4b,void 0);H.a.$(512517958,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog success.")});return 32}catch(oc){return H.a.$(512517957,
352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",oc.toString()),Og.ZF(pf.a.EWe,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}Eeo(Y,Sa,Mb){if(1===Mb)return 32;Y=new lb.a(void 0,void 0,!1);Y.Ue=5;Y.Vl=Ye.Vl;Y.qp(ResourceStrings.l_InsertSocialMediaDialogTitle,null,{["id"]:"SocialMediaExperimentDialog"});H.a.$(512517956,352,15,"InsertMediaActor::ShowInsertSocialMediaDialog : Show dialog.");return 32}Khn(Y){switch(Y){case tb.a.DMc:case tb.a.E5d:case tb.a.pYe:case tb.a.qYe:case tb.a.zYb:return this.na.JNh;
case tb.a.Bmd:return this.na.D5d;case tb.a.wUb:return fb.a("ChangePictureFromIconsFixEnabled")?this.na.D5d:this.na.STl;case tb.a.tkc:case tb.a.kjd:return this.na.TTl;default:return this.na.JNh}}Bjl(Y,Sa,Mb){if(!this.nEb(this.ya.Ia,Y,n.AFrameworkApplication.xOc()&&(Og.M6l?!!this.mik.U1e&&9<this.mik.U1e.length:!0)))return 8;if(1===Mb)return 32;H.a.$(512517923,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog.");try{Sa=!0;let oc=0;if(this.Jb.getBooleanAppSetting("InsertMediaSharedFilePickerEnabled")){const nd=
vb.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(nd.bYj()){Sa=!1;const Cd=this.na.yLj;Mb=!1;this.na.xYe&&(Mb=this.Jdn());const Zd=Object.assign(new zc,{wKd:Mb,y4d:!0}),we=nd.lIh(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,!0,Cd,"InsertPicture",0,Zd);nd.c1f(we).then(Qe=>{if(Qe&&0<Qe.length){const kf=[];for(let Vf=0;Vf<Qe.length;Vf++){const eg=Qe[Vf][gf.a.LWh],zg={};zg.Extension=Qe[Vf][gf.a.sFk];zg.OriginalUrl=gf.a.GWh in Qe[Vf]?Qe[Vf][gf.a.GWh]:
eg;zg.Type=gf.a.HWh in Qe[Vf]?Qe[Vf][gf.a.HWh]:"";zg.Caption=gf.a.KWh in Qe[Vf]?Qe[Vf][gf.a.KWh]:"";zg.Description=gf.a.FWh in Qe[Vf]?Qe[Vf][gf.a.FWh]:"";zg.Width=gf.a.JWh in Qe[Vf]?Qe[Vf][gf.a.JWh]:0;zg.Height=gf.a.IWh in Qe[Vf]?Qe[Vf][gf.a.IWh]:0;Array.add(kf,zg)}this.Xhn(Y).Klc(kf);H.a.$(512517922,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : SharedFilePicker Show dialog success.")}oc=32}).catch(Qe=>{H.a.$(512517921,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",
Qe.toString());Og.ZF(pf.a.EWe,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture);oc=8})}}if(!Sa)return oc;Og.M6l=!0;this.zOh||this.g1n();const Oc=this.QEn.getInstance();Oc.kzb=4;switch(Y){case tb.a.ijd:this.p4b.XZ=tb.a.FUe;break;default:this.swb.XZ=tb.a.Zcg}Oc.FJe(CommonUIStrings.L_PictureInsertTitle,Y===tb.a.EMc?this.swb:this.p4b,void 0);H.a.$(512517920,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog success.");return 32}catch(oc){return H.a.$(512517919,
352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",oc.toString()),Og.ZF(pf.a.EWe,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}Xhn(Y){if(!fb.a("ChangePictureFromOneDriveFixEnabled"))return this.swb;const Sa=(Y=Y===tb.a.EMc)?this.swb:this.p4b;Sa.XZ=Y?tb.a.Zcg:tb.a.FUe;return Sa}Jdn(){return vb.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").Oen()}I_h(Y,Sa,Mb){if(!this.nEb(this.ya.Ia,Y,this.na.xYe&&this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",
!1)))return 8;if(1===Mb)return 32;vb.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").Yan(this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));try{let oc=0;const Oc=vb.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(Oc.bYj()){const nd=Y===tb.a.wYe,Cd=this.na.yLj,Zd=Object.assign(new zc,{wKd:!0,y4d:!0}),we=Oc.lIh(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,nd,Cd,"InsertPictureFromMobile",
3,Zd);Oc.c1f(we).then(Qe=>{if(Qe&&0<Qe.length){const kf=[];let Vf=!1;const eg=this.Jb.Ma("PhoneLinkServiceEndpoint");for(let zg=0;zg<Qe.length;zg++){const yh=Qe[zg][gf.a.LWh],qg=Qe[zg],Ug={};Ug.Extension=Qe[zg][gf.a.sFk];Ug.OriginalUrl=this.j4e(qg,gf.a.GWh,yh);Ug.Type=this.j4e(qg,gf.a.HWh,"");Ug.Caption=this.j4e(qg,gf.a.KWh,"");Ug.Description=this.j4e(qg,gf.a.FWh,"");Ug.Width=this.j4e(qg,gf.a.JWh,0);Ug.Height=this.j4e(qg,gf.a.IWh,0);Array.add(kf,Ug);Vf||(Vf=-1!==Ug.OriginalUrl.indexOf(eg))}Qe=nd?
this.swb:this.p4b;Qe.XZ=Vf?nd?tb.a.rLj:tb.a.vHh:nd?tb.a.Zcg:tb.a.FUe;Qe.Klc(kf);H.a.$(512517918,352,50,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : SharedFilePicker Show dialog success.")}oc=32}).catch(Qe=>{H.a.$(512517917,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",Qe.toString());oc=8})}return oc}catch(oc){return H.a.$(512517916,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",oc.toString()),8}}j4e(Y,
Sa,Mb){return Sa in Y?Y[Sa]:Mb}m2h(Y,Sa,Mb,oc,Oc){Sa=this.ya.Ia;if(!Sa)return H.a.$(512517915,352,50,"Active Slide is null"),8;if(!this.nEb(Sa,Y,this.na.cga))return 8;if(1===Mb)return 32;if(!this.zj.KD(Sa,1))return this.zj.KJe(Sa),16;try{const nd=Sa.C$(this.sa.zd());if(nd&&this.zc.Hd(nd))return 16;const Cd=this.VJc(Sa,nd);let Zd=null;const we=this.Tb.Kd(15,void 0,()=>{this.sa.Rx();this.sa.nj();this.Na.ee()},()=>{this.sa.selectShape(Cd,!0);Zd&&this.sa.selectShape(Zd,!1)});try{we.tc(Sa);we.wc=tb.a.insertOnlinePicture;
we.mE[Je.a.Dfb]=Je.a.t3c;Mb=null;Y={["actionId"]:Y};if(this.na.hcc)if(Oc.LicenseUrl&&Oc.LicenseDisplayName){const qg=Og.xLk(Oc);Mb=Ic.c(qg);if(this.na.jrd){const Ug=Sa.fc;Zd=this.il.JXa(!0,Ug.cid,Ug.sid,0,0,0,yb.a.F4,yb.a.g9,Sa.Av()+1,!1)}}else Y["result.LicenseDisplayName"]=Oc.LicenseDisplayName,Y["result.LicenseUrl"]=Eb.a.tS(Oc.LicenseUrl);else Y.IsEnabled=this.na.hcc;H.a.$(512517914,352,50,"InsertMediaActor::UploadOnlinePicture: {0}.",Y);const Qe=Oc.LicenseUrl?null:Oc.Caption,kf=this.Jb.getBooleanAppSetting("InsertPictureSizeIncreaseEnabled"),
Vf=this.Jb.g1("OnlinePictureSlideWidthAdjustmentFactor",0),eg=this.Jb.g1("OnlinePictureSlideHeightAdjustmentFactor",0),zg=kf&&!nd?Sa.To*Vf:0,yh=kf&&!nd?Sa.xk*eg:0;H.a.$(508077772,352,50,`InsertMediaActor::UploadOnlinePicture:
          boundsWidth = ${zg}, and boundsHeight: ${yh},
          slideNode.renderedWidth = ${Sa.To}, and slideNode.renderedHeight: ${Sa.xk}`);Cd.AHe(Oc.OriginalUrl,Qe,Mb,Oc.PageUrl,zg,yh);nd&&Sa.w1([nd]);Sa.BJ(Cd);Zd&&(Sa.BJ(Zd),Cd.GHb=Zd.id,Zd.SIb=!0)}finally{we&&we.dispose()}this.rw.MJ=Cd;return 32}catch(nd){return H.a.$(512517913,352,10,"InsertMediaActor::UploadOnlinePicture : Exception = [{0}].",nd.toString()),8}}zHh(Y,Sa,Mb,oc,Oc){Sa=this.ya.Ia;if(!Sa)return H.a.$(512517912,352,50,"Active Slide is null"),8;if(!this.nEb(Sa,Y,this.na.YTa))return 8;
if(1===Mb)return 32;H.a.$(512517910,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Start changing.");if(!Oc)return 16;try{const nd=this.fZd()||this.BLh();this.PJh(nd);if(!nd||this.zc.Hd(nd))return 16;let Cd=null;const Zd=this.Tb.Kd(15,void 0,void 0,()=>{this.sa.selectShape(nd,!0);Cd&&this.sa.selectShape(Cd,!1);H.a.$(512517908,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Finish changing.")});try{Zd.tc(Sa);Zd.wc=tb.a.$Ac;Zd.mE[Je.a.Dfb]=Je.a.t3c;Y=null;if(this.na.hcc&&
Oc.LicenseUrl&&Oc.LicenseDisplayName){const we=Og.xLk(Oc);Y=Ic.c(we);if(this.na.jrd){const Qe=Sa.fc;Cd=this.il.JXa(!0,Qe.cid,Qe.sid,0,0,0,yb.a.F4,yb.a.g9,Sa.Av()+1,!1);H.a.$(512517907,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Adding license info to attributionShapeNode.")}}nd.AHe(Oc.OriginalUrl,Oc.LicenseUrl?null:Oc.Caption,Y,Oc.PageUrl);nd.set_isSVGBlipFilled(!1);Cd&&(Sa.BJ(Cd),nd.GHb=Cd.id,Cd.SIb=!0)}finally{Zd&&Zd.dispose()}this.rw.MJ=nd;return 32}catch(nd){return H.a.$(512517905,
352,10,"InsertMediaActor::changeToOnlinePictureSingleImage : Exception = [{0}].",nd.toString()),8}}yHh(Y,Sa,Mb,oc,Oc){Sa=this.ya.Ia;if(!Sa)return H.a.$(512517911,352,50,"Active Slide is null"),8;if(!this.nEb(Sa,Y,this.na.YTa))return 8;if(1===Mb)return 32;H.a.$(512517909,352,50,"InsertMediaActor::ChangeToOnlinePicture : Start changing.");if(!Oc)return 16;try{var nd=this.sa.zd();Y=[];for(var Cd of nd)Cd.Ge||Y.push(Cd);for(const we of Y)if(this.PJh(we),!we||this.zc.Hd(we))return 16;nd=null;const Zd=
this.Tb.Kd(15,void 0,void 0);try{Zd.tc(Sa);Zd.wc=tb.a.$Ac;Zd.mE[Je.a.Dfb]=Je.a.t3c;Cd=null;if(this.na.hcc&&Oc.LicenseUrl&&Oc.LicenseDisplayName){const Qe=Og.xLk(Oc);Cd=Ic.c(Qe);if(this.na.jrd){const kf=Sa.fc;nd=this.il.JXa(!0,kf.cid,kf.sid,0,0,0,yb.a.F4,yb.a.g9,Sa.Av()+1,!1);H.a.$(512517906,352,50,"InsertMediaActor::ChangeToOnlinePicture : Adding license info to attributionShapeNode.")}}const we=Oc.LicenseUrl?null:Oc.Caption;for(const Qe of Y)Qe.AHe(Oc.OriginalUrl,we,Cd,Oc.PageUrl),Qe.set_isSVGBlipFilled(!1),
nd&&(Sa.BJ(nd),Qe.GHb=nd.id,nd.SIb=!0)}finally{Zd&&Zd.dispose()}this.rw.MJ=Y[0];return 32}catch(Zd){return H.a.$(512517904,352,10,"InsertMediaActor::ChangeToOnlinePicture : Exception = [{0}].",Zd.toString()),8}}gno(Y,Sa,Mb,oc,Oc){const nd=this.ya.Ia;if(!nd)return H.a.$(512517903,352,50,"Active Slide is null"),8;if(!this.nEb(nd,Y,this.na.H0b))return 8;if(1===Mb)return 32;H.a.$(512517902,352,50,"InsertMediaActor::UploadIcon : Start inserting.");if(!Oc||!Oc.length)return 16;if(!this.zj.KD(nd,Oc.length))return this.zj.KJe(nd),
16;try{let Cd=null,Zd=null;if(!(()=>{let Qe=this.Sjn(Oc,nd);({cXn:Zd,XWn:Cd}=Qe);return Qe})().returnValue)return 16;const we=this.Tb.Kd(15,void 0,()=>{this.sa.Rx();this.sa.nj();this.Na.ee()},()=>{this.sa.Wna(Cd,!0)});try{for(we.tc(nd),we.wc=Y,we.mE[Je.a.Dfb]=Je.a.icon,Zd&&nd.w1(Zd),Y=0;Y<Cd.length;Y++)nd.BJ(Cd[Y])}finally{we&&we.dispose()}this.rw.MJ=Cd[Cd.length-1];return 32}catch(Cd){return H.a.$(512517901,352,10,"InsertMediaActor::UploadIcon : icon count = [{0}], Exception = [{1}].",Oc.length,
Cd.toString()),8}}Sjn(Y,Sa){const Mb=Array(Y.length),oc=Array(Y.length);var Oc=Sa.UXd(this.sa.zd());if(Oc&&0<Oc.length){var nd=0;for(const Cd of Oc)if(Cd&&!this.zc.Hd(Cd)&&nd<Y.length&&(Mb[nd]=Cd,nd++,nd===Y.length))break}Oc=!0;for(nd=0;nd<Mb.length;nd++)this.na.Gib&&Y[nd].SvgContent&&0<Y[nd].SvgContent.length&&(!Mb[nd]||Mb[nd]&&15!==Mb[nd].placeholderType)?oc[nd]=this.Qjn(Sa,Mb[nd],Y[nd],nd):(oc[nd]=this.gMh(Sa,Mb[nd],Y[nd],!0,nd),Oc=!1),Oc&&zi.a.KR(!0,!0),oc[nd].AHe(Y[nd].OriginalUrl,Y[nd].Caption,
null,null);return{returnValue:!0,cXn:Mb,XWn:oc}}Qjn(Y,Sa,Mb,oc){if(!Y)return null;var Oc=Y.fc,nd=Y.Av();Y=Object(G.a)(107,Y.yc(this.zb.Ua));const {CVf:Cd,PT:Zd}=this.Y5b.cJf(Sa,Mb.Width,Mb.Height,Y.rM,void 0,void 0,void 0);oc=Sa?0:oc*Rd.a.GK;Oc=this.il.JXa(!0,Oc.cid,Oc.sid,0,Zd.x+oc,Zd.y+oc,Cd.width,Cd.height,nd+1,!1);nd=this.Y5b.uCf(this.zb.Cd,Cd,Zd,Y.rM);Oc.jX=nd;Oc.isResizable=!0;Oc.MOc=!0;Oc.kL=!0;Oc.ela=!0;Oc.set_isSVGBlipFilled(!0);Mb=this.GCg.vwm(Mb.SvgContent);Oc.yna=Mb?String.format("data:image/svg+xml;charset=utf8,{0}",
encodeURIComponent(Mb)):"";Sa&&(Oc.Yva=Sa.id);return Oc}PJh(Y){fb.a("ExitCropAfterReplaceImageChange")&&Y&&Y.Yw&&(Y=Y.yc(this.zb.Ua))&&Y.yY(!1)}b0m(Y,Sa,Mb,oc,Oc){Sa=this.ya.Ia;if(!Sa)return H.a.$(512517900,352,50,"Active Slide is null"),8;if(!this.nEb(Sa,Y,this.na.m5c))return 8;if(1===Mb)return 32;H.a.$(512517898,352,50,"InsertMediaActor::ChangeToIcon : Start changing.");if(!Oc||!Oc.length)return 16;try{const nd=this.sa.zd(),Cd=[];for(const Qe of nd)Qe.Ge||Cd.push(Qe);const Zd=Oc[0].Caption;for(const Qe of Cd){this.PJh(Qe);
if(!Cd||this.zc.Hd(Qe))return 16;const kf=this.La.Wv(Qe);Zd&&kf&&this.Fd.QPk(new Ff(Sa.fc,Qe.get_shapeId(),Qe.get_smartArtModelId(),Zd))}const we=this.Tb.Kd(15,void 0,void 0,()=>{for(const Qe of Cd){const kf=this.La.Wv(Qe);kf&&(this.Fd.B9g(Sys.EventArgs.Empty),this.sa.selectShape(kf,!0),this.Fd.A9g(Sys.EventArgs.Empty))}H.a.$(512517896,352,50,"InsertMediaActor::ChangeToIcon : Finish changing.")});try{we.tc(Cd[0]);we.wc=Y;we.mE[Je.a.Dfb]=Je.a.icon;for(const Qe of Cd)Qe.set_isSVGBlipFilled(!0),Qe.AHe(Oc[0].OriginalUrl,
Zd,null,null)}finally{we&&we.dispose()}for(const Qe of Cd)this.zc.snb(Sa,Qe,this.zb.Ua,Y);return 32}catch(nd){return H.a.$(512517894,352,10,"InsertMediaActor::ChangeToIcon : icon count = [{0}], Exception = [{1}].",Oc.length,nd.toString()),8}}c0m(Y,Sa,Mb,oc,Oc){Sa=this.ya.Ia;if(!Sa)return H.a.$(512517899,352,50,"Active Slide is null"),8;if(!this.nEb(Sa,Y,this.na.m5c))return 8;if(1===Mb)return 32;H.a.$(512517897,352,50,"InsertMediaActor::changeToIconSingleIcon : Start changing.");if(!Oc||!Oc.length)return 16;
try{const nd=this.BLh()||this.fZd();this.PJh(nd);if(!nd||this.zc.Hd(nd))return 16;const Cd=Oc[0].Caption,Zd=this.La.Wv(nd);Cd&&Zd&&this.Fd.QPk(new Ff(Sa.fc,nd.get_shapeId(),nd.get_smartArtModelId(),Cd));const we=this.Tb.Kd(15,void 0,void 0,()=>{Zd&&(this.Fd.B9g(Sys.EventArgs.Empty),this.sa.selectShape(Zd,!0),this.Fd.A9g(Sys.EventArgs.Empty));H.a.$(512517895,352,50,"InsertMediaActor::changeToIconSingleIcon : Finish changing.")});try{we.tc(nd),we.wc=Y,we.mE[Je.a.Dfb]=Je.a.icon,nd.set_isSVGBlipFilled(!0),
nd.AHe(Oc[0].OriginalUrl,Cd,null,null)}finally{we&&we.dispose()}(Mb=Zd||nd)&&this.zc.snb(Sa,Mb,this.zb.Ua,Y);return 32}catch(nd){return H.a.$(512517893,352,10,"InsertMediaActor::changeToIconSingleIcon : icon count = [{0}], Exception = [{1}].",Oc.length,nd.toString()),8}}BLh(){let Y=null;const Sa=this.sa.zd();for(const Mb of Sa)if(Mb&&Mb.get_isSVGBlipFilled()&&(!this.OA||!Mb.RB))if(Y)break;else Y=Mb;return Y}fZd(){if(this.N5){const Y=this.sa.zd();return Y&&Y.length?this.jyi(Y)?Y[0]:this.VWe():null}return this.VWe()}jyi(Y){return null===
Y||void 0===Y?void 0:Y.filter(Sa=>!!Sa).every(Sa=>this.dig(Sa)||1===Sa.mediaType)}VWe(){const Y=this.sa.zd();for(const Sa of Y)if(Sa&&this.dig(Sa))return Sa;return null}dig(Y){return Y.Pg&&!(this.OA&&Y.RB)}Sbm(Y,Sa){const Mb=this.Jb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");"defaultModal"!==Mb&&H.a.$(Y,352,15,`${Sa}::Modal:${Mb}`)}Hgc(Y,Sa,Mb){if(!this.nEb(this.ya.Ia,Y,this.na.GFa))return 8;if(1===Mb)return 32;this.S0e=zi.a.Xk("ShowInsertVideoDialog",
1);const oc=this.Jb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");try{if(this.na.O0b){H.a.$(512517890,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video using Hubble");const nd=Yb.a.create(),Cd=Eb.a.tS(this.na.ZTa).toString();let Zd;const we=this.zCg&&this.na.getBooleanAppSetting("InsertStream2FlowEnabled")&&this.na.KPc;we&&(Zd=vb.a.instance.resolve("Common.App.OAuth.IOAuthManager"));H.a.$(508822735,352,50,"InsertMediaActor::ShowInsertVideoDialog : Licensing enabled for user: {0} with correlationId: {1}",
this.zCg,nd);this.Pgb.execute(Qe=>{Qe=this.N_e.getInstance(this.vsa.fZm(Wc.App.mode,this.na.I8l,nd.toString(),Cd,we,oc),this.M_e,this.vsa,Qe,vd.Vl);Qe.correlationId=nd;Qe.kzb=5;const kf=new fe(this.la,this.vsa,this.na);kf.XZ=tb.a.Fmd;Qe.FJe(CommonUIStrings.L_VideoInsertTitle,kf,Zd)})}else this.na.yYe?(H.a.$(512517889,352,50,"[Insert Online Video] Insert online video from URL, creating dialog"),(new ce(this.SYa)).rEb()):(H.a.$(512517888,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video"),
this.Pgb.execute(nd=>{this.N_e.getInstance(this.vsa.gZm(Wc.App.mode,this.na.zYe),this.M_e,this.vsa,nd,rd.Vl).FJe(CommonUIStrings.L_VideoInsertTitle,new fe(this.la,this.vsa,this.na),void 0)}));this.Sbm(512557208,"ShowInsertOnlineVideoDialog");null!=this.S0e&&Object(Cg.a)(this.S0e.actionName,(new Date).getTime()-this.S0e.Nx.getTime(),"InsertOnlineVideoDialog",this.S0e.actionId,this.S0e.pj);const Oc=this.Jb.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoToolTipMessage","InsertOnlineVideo");
fb.a("LogInsertOnlineVideoCustomToolTip")&&"InsertOnlineVideo"!==Oc&&H.a.$(512517859,352,15,"InsertOnlineVideo::ToolTipMessage : "+Oc);if("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo"in this.Jb.clc){const nd=this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo",!1)?"Visible":"NotVisible";H.a.$(512517858,352,15,"InsertOnlineVideo::SocialMediaIconIs"+nd)}H.a.$(512517857,352,50,"InsertMediaActor::ShowInsertVideoDialog : Show dialog success.");return 32}catch(Oc){return H.a.$(512517856,
352,10,"InsertMediaActor::ShowInsertVideoDialog : Exception = [{0}]",Oc.toString()),Og.ZF(pf.a.EWe,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlineVideo),8}}kno(Y,Sa,Mb,oc,Oc){Sa=this.ya.Ia;if(!Sa)return H.a.$(512517853,352,50,"Active Slide is null"),8;if(!this.nEb(Sa,Y,this.na.GFa))return 8;if(1===Mb)return 32;if(!this.zj.KD(Sa,1))return this.zj.qJ(Sa),16;try{const nd=Sa.C$(this.sa.zd());if(nd&&this.zc.Hd(nd))return 16;const Cd=this.VJc(Sa,nd),Zd=this.vsa.tnn(Oc.OriginalUrl);
Cd.Njh(Zd,Oc.ThumbnailUrl,Oc.Caption,Oc.Description,0<Oc.Width?Oc.Width:0,0<Oc.Height?Oc.Height:0);const we=this.Tb.Kd(15,void 0,()=>{this.sa.Rx();this.sa.nj();this.Na.ee()},()=>{this.sa.selectShape(Cd,!0)});try{we.tc(Sa),we.wc=Y,nd&&Sa.w1([nd]),Sa.BJ(Cd)}finally{we&&we.dispose()}H.a.$(512517852,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video is done.");this.rw.MJ=Cd;return 32}catch(nd){return H.a.$(512517851,352,10,"InsertMediaActor::UploadOnlineVideo : Exception = [{0}].",nd.toString()),
8}}jno(Y,Sa,Mb,oc,Oc){Sa=this.ya.Ia;if(!Sa)return H.a.$(512517850,352,50,"Active Slide is null"),8;if(!this.nEb(Sa,Y,this.na.O0b))return 8;if(1===Mb)return 32;H.a.$(512517849,352,50,"InsertMediaActor::UploadOnlineHubbleVideo : Start inserting.");if(!this.zj.KD(Sa,1))return this.zj.qJ(Sa),16;try{const nd=Sa.C$(this.sa.zd());if(nd&&this.zc.Hd(nd))return 16;const Cd=this.VJc(Sa,nd);(this.na.getBooleanAppSetting(sh.a.vGb)||this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.VideoLoadingExperience",
!1))&&Cd.setValue(jc.a.pq,!0);const Zd=0<Oc.Width?Oc.Width:0,we=0<Oc.Height?Oc.Height:0;let Qe=Oc.PageUrl;this.na.KPc&&"odspbusiness"===Oc.ProviderName.toLocaleLowerCase()&&(Qe=Oc.OriginalUrl);Cd.Njh(Qe,Oc.ThumbnailUrl,Oc.Caption,Oc.Description,Zd,we);const kf=this.Tb.Kd(15,void 0,()=>{this.sa.Rx();this.sa.nj();this.Na.ee()},()=>{this.sa.selectShape(Cd,!0)});try{kf.tc(Sa),kf.wc=Y,nd&&Sa.w1([nd]),Sa.BJ(Cd)}finally{kf&&kf.dispose()}this.Sbm(512557200,"InsertOnlineHubbleVideo");H.a.$(512517848,352,50,
"InsertMediaActor::UploadOnlineVideo : Inserting online video is done in {0} ms.",Date.now()-Oc.StartInsertTime);this.rw.MJ=Cd;return 32}catch(nd){return H.a.$(512517847,352,10,"InsertMediaActor::UploadOnlineHubbleVideo : Exception = [{0}].",nd.toString()),8}}nEb(Y,Sa,Mb){Y=!!Y&&Mb&&!this.zc.Hd(Y);switch(Sa){case tb.a.wUb:return Y&&(!!this.fZd()||!!this.BLh());case tb.a.hjd:case tb.a.ijd:case tb.a.ljd:case tb.a.tkc:return Y&&this.v0m();default:return Y}}v0m(){const Y=this.fZd()||this.BLh();return!Y||
this.na.QK&&Y.RB?!1:this.La.Wv(Y)?!1:!0}VJc(Y,Sa){return this.gMh(Y,Sa,null,!1,0)}gMh(Y,Sa,Mb,oc,Oc){if(!Y)return null;var nd=Y.fc;Y=Y.Av();let Cd;oc?{width:Mb,height:Cd}=Og.lmn(Sa,Mb):(Mb=yb.a.F4,Cd=yb.a.g9);let Zd;Zd=Sa?Sa.FZb(Mb,Cd):this.Xb.dna(Mb,Cd);Oc=Sa?0:Oc*Rd.a.GK;nd=this.il.JXa(!0,nd.cid,nd.sid,0,Zd.x+Oc,Zd.y+Oc,Mb,Cd,Y+1,!0);nd.set_isSVGBlipFilled(oc);Sa&&(nd.Yva=Sa.id);return nd}dispose(){this.Pgb.instance&&(this.g7b&&this.Pgb.instance.kec("MsoPremiumStockImages",this.g7b),this.gim&&this.Pgb.instance.kec("OmgStreamTwo",
this.gim));this.zOh&&this.ene.BVd.contentWindow&&(bc.a.removeHandler(this.ene.BVd.contentWindow,"message",Object(h.a)(this,this.bAm,"showOneDriveFilePickerDialog")),this.zOh=!1)}static BZm(){const Y=CommonUIStrings.l_AttributionText.split(/[{}]+/);return Hj.e(Y,Sa=>!!Sa)}static cZm(Y,Sa){const Mb=document.createElement("body");var oc="";let Oc="",nd=CommonUIStrings.L_CCYYSA;void 0!==Sa&&null!==Sa&&(void 0!==Sa.PageUrl&&null!==Sa.PageUrl&&(oc=Sa.PageUrl),void 0!==Sa.LicenseDisplayName&&null!==Sa.LicenseDisplayName&&
0<Sa.LicenseDisplayName.length&&(nd=Sa.LicenseDisplayName),void 0!==Sa.LicenseUrl&&null!==Sa.LicenseUrl&&(Oc=Sa.LicenseUrl));for(const Cd of Y){switch(Cd){case "L_ThePhoto":Y=Og.ySl(CommonUIStrings.l_ThePhoto,oc);break;case "L_CCYYSA":Y=Og.ySl(nd,Oc);break;case "L_PhotoAuthor":Y=Og.HSl(CommonUIStrings.l_PhotoAuthor);break;default:Y=Og.HSl(Cd)}Y&&Mb.appendChild(Y)}oc=document.createElement("html");oc.appendChild(Mb);return oc}static HSl(Y){const Sa=document.createElement("span");Sa.innerText=Y;return Sa}static ySl(Y,
Sa){const Mb=document.createElement("A");Mb.setAttribute("href",Sa);Mb.setAttribute("target","_blank");Mb.setAttribute("rel","noreferrer");Sa=document.createElement("span");Sa.innerText=Y;Mb.appendChild(Sa);return Mb}static xLk(Y){const Sa=Og.BZm();return Og.cZm(Sa,Y)}static ZF(){}static lmn(Y,Sa){let Mb;Y&&15===Y.placeholderType?(Mb=fh.a.te(Y.RQe,0,!1),Y=fh.a.te(Y.A3d,0,!1)):Sa&&0<Sa.Width&&0<Sa.Height?(Mb=Sa.Width,Y=Sa.Height):(Mb=fh.a.te(2,0,!1),Y=fh.a.te(2,0,!1));return{width:Mb,height:Y}}}Og.M6l=
!1;Object(c.a)(Og,"InsertMediaActor",null,[502]);var Ch=a(1247);class Pg{}Pg.Pio=864E5;Pg.YVm=3;Pg.HPn=144E5;Object(c.a)(Pg,"AddinConstantsNum",null,[]);var ch=a(274),Fi=a(850),Gi=a(849);class $g{constructor(Y,Sa,Mb,oc){this.ha=(oc=void 0===oc?null:oc)?oc:n.AFrameworkApplication.ha;this.pci=2;this.P4d=Y;this.tSm=Sa;this.TC=Mb}get pMc(){return this.pci}get Nno(){return this.tSm}L2k(Y){if(this.ha.getBooleanAppSetting("AgaveSupportsLiveIdSpoofing"))this.P4d(Y,this.pMc,{["ak0"]:(new Date).getTime()});
else if(Gi.a.pzm(Y)){var Sa=String.format(n.AFrameworkApplication.Ha.Ib.o1+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",n.AFrameworkApplication.Ha.Ib.Dm,this.Nno,n.AFrameworkApplication.Fh);const Mb=n.AFrameworkApplication.$d;let oc=null;this.TC&&(oc=this.TC.Xl("ComponentAttach",Fi.a[Y]+Ch.a[this.pMc]));Mb.ik(Sa,1,null,null,!0,4,Oc=>{this.VUn(Y,Oc.data.responseData);oc&&oc.stop()},Oc=>{e.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",Oc.data.Je);
this.O1e(Y,1,"request failed");oc&&oc.stop()},null)}else Gi.a.TCj(Y)?(Sa=Gi.a.Icj(Y),this.P4d(Y,this.pMc,{["ak0"]:Sa})):this.ha.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&(this.Gqa?this.O1e(Y,1,"no local timestamp"):this.P4d(Y,this.pMc,null))}VUn(Y,Sa){if(Sa&&""!==Sa)if(Sa=Sys.Net.XMLDOM(Sa)){Gi.a.Xdd(ch.a.aGh,((new Date).getTime()+Pg.HPn).toString(),Y);let Mb=Sa.getElementsByTagName("update");Mb&&Mb.length||(Mb=Sa.getElementsByTagName("o:update"));Mb&&0<Mb.length?
(Sa=Date.parse(Mb[0].firstChild.nodeValue),Gi.a.Icj(Y)<Sa||Gi.a.TCj(Y)?this.P4d(Y,this.pMc,{["ak0"]:Sa}):this.O1e(Y,1,"outdate timestamp in reponse")):this.O1e(Y,2,"no timestamp in response")}else this.O1e(Y,1,"response data is invalid");else this.O1e(Y,1,"no responseData")}O1e(Y,Sa,Mb){this.Gqa&&this.P4d(Y,this.pMc,{["AddinServiceUserState"]:Sa,["DiagnosticInfo"]:Mb})}get Gqa(){return this.ha.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.ha.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}}
Object(c.a)($g,"AddinCommandsAnonymousAPIInitializer",null,[274]);class gh{constructor(Y,Sa,Mb){this.pci=Mb;this.P4d=Y;this.zo=Sa}get pMc(){return this.pci}L2k(Y){let Sa=null;this.zo&&(Sa=this.zo.Xl("ComponentAttach",Fi.a[Y]+Ch.a[this.pMc]));(null==this.rhl(Y)?0:this.rhl(Y))&&this.P4d(Y,this.pMc,{["ak0"]:(new Date).getTime()-Pg.YVm*Pg.Pio});Sa&&Sa.stop()}}Object(c.a)(gh,"AddinCommandsInitializerBase",null,[274]);class Wi extends gh{constructor(Y,Sa){super(Y,Sa,5)}rhl(){return!0}}Object(c.a)(Wi,"AddinCommandsInitializer",
gh,[]);class yj extends gh{constructor(Y,Sa){super(Y,Sa,1)}rhl(Y){try{const Sa=ch.a.n1f()+Y;return Boolean.parse(this.Nen(Sa)||"false")}catch(Sa){e.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",Sa.toString())}return null}Nen(Y){const Sa=localStorage;return void 0!==Sa&&null!==Sa?Sa.getItem(Y):null}}Object(c.a)(yj,"AddinCommandsLocalCacheInitializer",gh,[]);class qk{constructor(Y,Sa){Sa=void 0===Sa?null:Sa;this.TC=Y;this.ha=Sa?Sa:n.AFrameworkApplication.ha}get appUILocale(){return xi.a.Le(n.AFrameworkApplication.lcid).name}Kun(){const Y=
this.ndj();if(Y)if(this.ha.getBooleanAppSetting("OcpsIsEnabled"))Object(Dc.a)().execute(Sa=>{Sa.isFeatureEnabled("ConnectedServices",!0).then(Mb=>{for(const oc of Y){if(!Mb&&0===oc.key){this.Gqa&&this.aDm(0,oc.value,{["AddinServiceUserState"]:3,["DiagnosticInfo"]:"connected services is off"});continue}const Oc=this.s1l(oc.value);Oc&&Oc.L2k(oc.key)}return null})});else for(const Sa of Y){const Mb=this.s1l(Sa.value);Mb&&Mb.L2k(Sa.key)}}M2k(Y,Sa,Mb){Mb&&Mb[ch.a.qid]?(Mb[ch.a.vHb]=Y,Mb[ch.a.Veb]=Sa,this.yMk(r.a.gFe,
Mb),Gi.a.Xdd(ch.a.qid,Mb[ch.a.qid].toString(),Y)):this.Gqa?this.aDm(Y,Sa,Mb):this.ha.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&0===Y&&(Mb={},Mb[ch.a.vHb]=Y,Mb[ch.a.Veb]=Sa,this.yMk(r.a.Jla,Mb))}s1l(Y){let Sa=null;switch(Y){case 1:Sa=new yj(Object(h.a)(this,this.M2k,"retrieveAddinFlagCompleted"),this.TC);break;case 2:Sa=new $g(Object(h.a)(this,this.M2k,"retrieveAddinFlagCompleted"),this.appUILocale,this.TC,this.ha);break;case 5:Sa=new Wi(Object(h.a)(this,this.M2k,
"retrieveAddinFlagCompleted"),this.TC)}return Sa}aDm(Y,Sa,Mb){0===Y&&Mb&&Mb[ch.a.gyf]&&(Mb[ch.a.vHb]=Y,Mb[ch.a.Veb]=Sa,e.ULS.sendTraceTag(508829835,220,50,"AddinServiceUserState: {0}, addinCommandsInitFlagInfo: {1}",Mb[ch.a.gyf].toString(),JSON.stringify(Mb)),this.yMk(r.a.Jla,Mb))}get Gqa(){return this.ha.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.ha.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}}Object(c.a)(qk,"AddinCommandsInitializerHost",
null,[]);var Jj=a(1396),Ai=a(90),Rk=a(184);class dj extends qk{constructor(Y,Sa){super(Y.qMh());this.OF=Y;this.Jb=Sa;Jj.a.JLc=Jj.a.ZHk}xko(){this.Kun()}ndj(){const Y=new Rk.a;this.Jb.getBooleanAppSetting(Ai.a.xid)&&(Y.fa(0,2),Y.fa(16,5));this.Jb.getBooleanAppSetting(Ai.a.bLj)&&Y.fa(1,1);this.OF.Pd.u6a&&Y.fa(8,1);this.Jb.getBooleanAppSetting(Ai.a.Eid)&&Y.fa(10,5);return Y}yMk(Y,Sa){this.OF.kU().Ra(Y,2,Sa)}}Object(c.a)(dj,"AddinCommandsInitService",qk,[991]);class Bi{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.AddinCommands"}oc(Y){this.ga=
Y;vb.a.instance.register(dj,"PowerPointWebEditor.AddinCommandsInitService").as("PowerPointWebEditor.IAddinCommandsInitService").pa(()=>new dj(this.ga.resolve("PowerPointWebEditor.IApplicationContext"),this.ga.resolve("Common.IAppSettingsManager"))).oa()}init(){this.ga.resolve("PowerPointWebEditor.IApplicationSettings").gOh&&this.ga.resolve("Common.IAppSettingsManager").Wf(()=>{vb.a.instance.resolve("PowerPointWebEditor.IAddinCommandsInitService").xko()})}dispose(){}}Object(c.a)(Bi,"AddInCommandsInitPackage",
null,[4,5]);class sj extends sa{constructor(Y,Sa,Mb,oc){super(Y,!0,void 0===Sa?null:Sa,!1,void 0,void 0===Mb?null:Mb,void 0===oc?!1:oc)}get rGj(){return null}get t$b(){return this.jfg?Object(ba.a)("DownloadAsPdfDialog_CopyALinkText"):this.Wfg?Object(ba.a)("DownloadAsPdfDialog_EmailALinkText"):n.AFrameworkApplication.gIb?Object(ba.a)("DownLoadACopyDialogMessage"):Object(ba.a)("PrintDialogDocumentIsPrinting")}get SZe(){return Object(ba.a)("DownloadAsPdfDialogLinkSuggestion")}get buttonText(){return Object(ba.a)("Download")}get eGh(){return null}get jfg(){return"VersionHistory"===
this.rTl||1===n.AFrameworkApplication.Ha.mode||this.s_l?!1:1==n.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfShareLinkState",0)}get Wfg(){return"VersionHistory"===this.rTl||1===n.AFrameworkApplication.Ha.mode||this.s_l?!1:2==n.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfShareLinkState",0)}WZe(){e.ULS.sendTraceTag(508875466,324,50,"Download as PDF dialog displayed");hb.a.DH("tshrepdf;tshrepdf2;cshrepdf")}}Object(c.a)(sj,
"DownloadAsPdfDialog",sa,[]);class tl extends sj{constructor(Y){super(Y)}get t$b(){return n.AFrameworkApplication.gIb?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}WZe(){H.a.$(507905935,801,50,"Images download dialog displayed")}bog(){H.a.$(507905934,801,50,"Images download dialog link clicked")}Sce(){H.a.$(507905933,801,50,"Images download dialog button clicked")}}Object(c.a)(tl,"DownloadACopyAsImagesDialog",sj,[]);var El=a(253);class ej extends ha{constructor(Y){super(Y,
void 0,n.AFrameworkApplication.gIb)}get t$b(){return ResourceStrings.l_DownloadAsOdpDialogOdpReady}get SZe(){return ResourceStrings.l_DownloadAsOdpDialogLinkSuggestion}get Qmg(){return"DownloadOdpLink"}get buttonText(){return ResourceStrings.L_Download}get RMf(){return n.AFrameworkApplication.gIb?"UIFontDialogTextLarge":null}WZe(){H.a.$(8958087,801,50,"ODP download dialog displayed")}bog(){H.a.$(8958089,801,50,"ODP download dialog link clicked")}Sce(){H.a.$(19505496,801,50,"ODP download dialog button clicked")}DPh(){El.a.showHelp("PPTODF");
return!0}get Emg(){return n.AFrameworkApplication.ha&&n.AFrameworkApplication.ha.getBooleanAppSetting("EnableReactDialogs")&&fb.a("ReactDialogsODPDialogFix")?null:"#"}get bmc(){return ResourceStrings.l_DownloadAsOdpDialogLearnMoreLinkText}get sjm(){return!n.AFrameworkApplication.gIb}}Object(c.a)(ej,"DownloadACopyAsOdpDialog",ha,[]);class Fl extends sj{constructor(Y){super(Y)}get t$b(){return n.AFrameworkApplication.gIb?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}WZe(){H.a.$(507905941,
801,50,"PDF download dialog displayed")}bog(){H.a.$(507905940,801,50,"PDF download dialog link clicked")}Sce(){H.a.$(507905939,801,50,"PDF download dialog button clicked")}}Object(c.a)(Fl,"DownloadACopyAsPdfDialog",sj,[]);var fj=a(1555),Th=a(584);class Ih extends Th.a{constructor(Y,Sa,Mb){super();this.Wfa=null;this.EQh=0;this.le=this.wgm=null;this.eGn=Y;this.hEn=Sa;this.bDn=Mb;this.Uzb=Object(h.a)(this,this.Jhb,"onRequestComplete");this.onError=Object(h.a)(this,this.JTn,"onRequestError")}get k1g(){return this.wgm}set k1g(Y){this.wgm=
Y}get Rq(){return this.le}set Rq(Y){this.le=Y}start(){this.Igc()}Igc(){1!==n.AFrameworkApplication.Ha.state&&(this.Wfa=new fj.a,this.Wfa.Vw=!1,this.Wfa.Ue=5,this.Wfa.message=this.eGn,this.Wfa.SGa(ResourceStrings.l_GenericDialogTitle,null,null),this.EQh=0)}$X(){this.Wfa&&(this.Wfa.close(),this.Wfa=null)}Jhb(Y){this.$X();Y.uia?this.k1g(Y):this.EZa()}JTn(Y){Y.N_l&&this.EQh<Ih.i9n?(this.EQh+=1,Y.start()):this.EZa()}EZa(){this.$X();if(1!==n.AFrameworkApplication.Ha.state){const Y=new za.a;Y.Ue=0;Y.fE(this.bDn,
ResourceStrings.l_GenericDialogTitle,this.hEn,this.Rq)}}}Ih.i9n=3;Object(c.a)(Ih,"UIBlockingTask",Th.a,[]);var Uh=a(349);class si extends Ih{constructor(Y){super(ResourceStrings.l_ConvertingToOdpProgressString,ResourceStrings.l_ConvertingToOdpErrorString,pf.a.ykm);this.CL=Y}start(){super.start();Uh.a.QVl(this.CL,Object(h.a)(this,this.JBa,"handleWebserviceResponse"),Object(h.a)(this,this.IBa,"handleWebserviceError"))}}Object(c.a)(si,"ConvertToOdpTask",Ih,[]);class bj extends Ih{constructor(Y){super(ResourceStrings.L_PrintingProgressString,
ResourceStrings.l_ConvertingToPdfErrorString,pf.a.upm);this.CL=Y}start(){super.start();Uh.a.RVl(this.CL,Object(h.a)(this,this.JBa,"handleWebserviceResponse"),Object(h.a)(this,this.IBa,"handleWebserviceError"))}}Object(c.a)(bj,"ConvertToPdfTask",Ih,[]);class Dh{constructor(Y,Sa,Mb){this.LQh=Y;this.tg=Sa;this.Wbk=Mb}get KVe(){return this.LQh.value}convert(Y,Sa,Mb){let oc=null;0===Sa?this.Wbk?new ej(Mb):(oc=new si(Y),oc.k1g=Object(h.a)(this,this.XQn,"onConvertOdpRequestSucceeded"),oc.start()):1===Sa?
this.tg.Pd.URj&&this.Wbk?new Fl(Mb):zi.a.SK(zi.a.Bb,()=>{oc=new bj(Y);oc.k1g=Object(h.a)(this,this.YQn,"onConvertPdfRequestSucceeded");oc.start()}):2===Sa?this.tg.Pd.POh&&this.Wbk&&new tl(Mb):Error.invalidOperation(String.format("Convert task type '{0}' is not supported",Sa))}XQn(Y){Y=Y.result;1!==n.AFrameworkApplication.Ha.state&&(Y=td.a.ZAa(Y.PrintUrl),new ej(Y))}YQn(Y){Y=Y.result;1!==n.AFrameworkApplication.Ha.state&&(Y=td.a.ZAa(Y.PrintUrl),this.KVe.NVl=new Date,new Fl(Y),this.KVe.$Xl=new Date,
H.a.$(21050908,801,50,"DownloadACopyAsPdf-StartTime: {0}, DownloadACopyAsPdf-SaveEnd: {1}, DownloadACopyAsPdf-ConvertEnd: {2}, DownloadACopyAsPdf-DialogShowEnd: {3}.",this.KVe.OYl.toString(),this.KVe.Jwm.toString(),this.KVe.NVl.toString(),this.KVe.$Xl.toString()))}}Object(c.a)(Dh,"Converter",null,[1001]);class lk{constructor(){this.OYl=this.Jwm=this.NVl=this.$Xl=Wc.App.Qp}}Object(c.a)(lk,"DownloadACopyAsPdfContext",null,[]);class vk extends Ih{constructor(Y,Sa){super(ResourceStrings.L_PrintingProgressString,
ResourceStrings.L_PrintingErrorString,pf.a.Grm);this.CL=Y;this.xHn=Sa}start(){super.start();Uh.a.print(this.CL,this.xHn,Object(h.a)(this,this.JBa,"handleWebserviceResponse"),Object(h.a)(this,this.IBa,"handleWebserviceError"))}}Object(c.a)(vk,"PrintTask",Ih,[]);class Xi{constructor(Y,Sa,Mb){if(!Y)throw Error.argumentNull("directPrintManager");this.Ntg=Y;this.tg=Sa;this.rEn=Mb}pTn(Y){this.Ntg.w1n();Y=Y.result;1!==n.AFrameworkApplication.Ha.state&&(Y=td.a.ZAa(Y.PrintUrl),this.Ntg.eAm(Y))}print(Y,Sa,
Mb){this.tg.Pd.URj&&this.rEn?(Y=new Rc.QueryStringBuilder(Sa),Y.ej(yg.a.Zom,this.Ntg.vzm().toString()),Y.ej(yg.a.Wom,Mb.toString()),this.Ntg.eAm(Y.toString())):(Mb=new vk(Y,this.Ntg.vzm()),Mb.k1g=Object(h.a)(this,this.pTn,"onPrintRequestSucceeded"),Mb.start())}}Object(c.a)(Xi,"Printer",null,[992]);class wk{get name(){return"PowerPointWebEditor.PrintPackage"}oc(){vb.a.instance.register(Xi,"PowerPointWebEditor.Printer").as("PowerPointWeb.IPrinter").oa().pa(()=>new Xi(vb.a.instance.Db("Common.App.DirectPrint.IDirectPrintManager"),
vb.a.instance.Db("PowerPointWebEditor.IApplicationContext"),vb.a.instance.Db("PowerPointWebEditor.IApplicationSettings").li));vb.a.instance.register(Dh,"PowerPointWeb.Converter").as("PowerPointWeb.IConverter").oa().pa(()=>new Dh(vb.a.instance.he("PowerPointWebEditor.DownloadACopyAsPdfContext"),vb.a.instance.Db("PowerPointWebEditor.IApplicationContext"),vb.a.instance.Db("PowerPointWebEditor.IApplicationSettings").li));vb.a.instance.register(lk,"PowerPointWebEditor.DownloadACopyAsPdfContext").oa().pa(()=>
new lk)}init(){}dispose(){}}Object(c.a)(wk,"PrintPackage",null,[4,5]);var Fk=a(1177);class Kk extends zd{constructor(Y,Sa,Mb){super(Y,Sa);this.na=Mb;this.XZ=tb.a.ZAc}Klc(Y){if(Y&&Y.length){var Sa=tb.a.gv(this.XZ),Mb=this.vwn(Y[0]);try{H.a.$(512517845,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images, from command: {0} to command: {1}.",Sa,Mb?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload");if(32!==(Mb?this.Ft.Ra(tb.a.DUe,2,Y):this.Ft.Ra(this.XZ,2,Y[0])))throw Error.invalidOperation(String.format("Failed to change online images, command: {0}.",
Mb?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload"));H.a.$(512517844,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images successfully, from command: {0} to command: {1}.",Sa,Mb?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload")}catch(oc){H.a.$(512517843,352,10,"ChangeOnlineImageHelper: InsertMediaCallback() - {0}: Exception = [{1}].",Sa,oc.toString())}}}vwn(Y){(Y=!!Y&&!!Y.OriginalUrl&&0<Y.OriginalUrl.length&&this.na.m5c&&!!this.na.Sbc&&0<this.na.Sbc.length&&0<=Y.OriginalUrl.toLowerCase().indexOf(this.na.Sbc.toLowerCase())&&
Y.OriginalUrl.toLowerCase().indexOf(".svg")===Y.OriginalUrl.length-4)||H.a.$(512517842,352,50,"isChangeSvg = false");return Y}}Object(c.a)(Kk,"ChangeOnlineImageHelper",zd,[]);class rk extends zd{constructor(Y,Sa,Mb){super(Y,Sa);this.VTh=this.Ogm=this.zim=0;this.na=Mb;this.XZ=tb.a.Llc}Klc(Y){var Sa;if(Y&&Y.length){var Mb=tb.a.gv(this.XZ),oc=new Map;oc.set("InsertMediaCommand",Mb);Rf.Health.instance.recordKpiUsageForAlertableKpi("InsertOnlineImage",null,oc);try{const nd=[],Cd=[],Zd=[];for(let Qe=0;Qe<
Y.length;Qe++){const kf=Y[Qe];this.V9l(kf)?Array.add(nd,kf):this.na.WMc&&this.pPh(kf)?Array.add(Zd,kf):Array.add(Cd,kf)}this.VTh=this.VTh+Cd.length+nd.length;H.a.$(512517841,352,50,"InsertMediaCallback:  Insert {0} pictures {1} svg images, command: {2}.",Cd.length,nd.length,Mb);let we=this.XZ;we===tb.a.Gmd?we=tb.a.uYe:this.na.WMc&&we===tb.a.Mlc&&(we=tb.a.uYe);for(Y=0;Y<Cd.length;Y++){var Oc=this.Ft.Ra(we,2,Cd[Y]);if(32!==Oc)throw Error.invalidOperation(String.format("Failed to upload picture {0} with command {1}.",
Cd.toString(),Mb));}if(this.na.WMc&&0<Zd.length){this.rf||(this.Hxm(zi.a.Xk("StockVideos::Insert")),null===(Sa=this.rf)||void 0===Sa?void 0:Sa.Za("StockVideoInitiatedByRibbon","false"));this.rf&&this.rf.Za("totalVideosSelected",Zd.length.toString());const Qe=performance.now();for(Sa=0;Sa<Zd.length;Sa++)if(Oc=this.Ft.Ra(tb.a.Mlc,2,Zd[Sa]),32!==Oc)throw this.MZl("videosInsertedBeforeFailure",Sa,Qe),Error.invalidOperation(String.format("Failed to upload video {0} with command {1}.",Zd.toString(),Mb));
this.MZl("videosInsertedSuccess",Zd.length,Qe)}if(this.V9l(nd[0])&&(Oc=we===tb.a.YXf?this.Ft.Ra(we,2,nd[0]):this.Ft.Ra(tb.a.Gmd,2,nd),32!==Oc))throw Error.invalidOperation(String.format("Failed to insert M365 svg images {0}",nd.toString()));H.a.$(512517840,352,15,"InsertMediaCallback: Insert {0} pictures {1} svg images {2} videos success, command: {3}.",Cd.length,nd.length,Zd.length,Mb)}catch(nd){H.a.$(512517839,352,10,"InsertMediaActor::{0}: Exception = [{1}].",this.XZ.toString(),nd.toString()),
oc.set("Exception",nd.toString()),Rf.Health.instance.recordKpiFailure("InsertOnlineImage","InsertMediaException",!1,!0,{extendedProperties:oc})}}}Hxm(Y){this.rf=Y}MZl(Y,Sa,Mb){if(this.rf){const oc=performance.now();this.rf.Za("VideosInsertionTimeInMilliseconds",(oc-Mb).toString());this.rf.Za(Y,Sa.toString());this.rf.finish();this.rf=null}}V9l(Y){(Y=!!Y&&!!Y.OriginalUrl&&0<Y.OriginalUrl.length&&this.na.H0b&&!!this.na.Sbc&&0<this.na.Sbc.length&&0<=Y.OriginalUrl.toLowerCase().indexOf(this.na.Sbc.toLowerCase())&&
Y.OriginalUrl.toLowerCase().indexOf(".svg")===Y.OriginalUrl.length-4)||H.a.$(512517838,352,50,"isInsertSvg = false");return Y}pPh(Y){return!!Y&&!!Y.OriginalUrl&&0<Y.OriginalUrl.length&&Y.OriginalUrl.toLowerCase().indexOf(".mp4")===Y.OriginalUrl.length-4}get gva(){return this.zim}set gva(Y){this.zim=Y}get CAb(){return this.UFn}set CAb(Y){this.UFn=Y}get w4g(){return this.Ogm}set w4g(Y){this.Ogm=Y}get Gth(){return this.VTh}set Gth(Y){this.VTh=Y}}Object(c.a)(rk,"InsertOnlineImageHelper",zd,[]);var fi=
a(854);class Af{constructor(Y,Sa){this.yke=!1;this.Ule=new Date(0);this.Tle=new Date(0);this.Ilk=Y;this.Yb=Sa}J5l(){this.yke=!0}b9c(){this.yke?H.a.$(593884831,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.Ule>this.Tle?H.a.$(593884829,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.Ule+". Last scan at "+this.Tle+"."):(this.Ule=new Date,this.Yb.Rb(new B.a(3,
1,0,Object(h.a)(this,this.S3k,"runJob"),90,"112")))}S3k(){this.Tle=new Date;this.yke?H.a.$(593884827,813,100,"PrefetchScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.Ilk()&&this.b9c()}}Object(c.a)(Af,"PrefetchScheduler",null,[]);class Gl{constructor(Y,Sa,Mb){this.oQh=null;this.Fem=Sa;this.Hcm=Mb;this.$Ze=Y}K$n(Y){this.$Ze!==Y&&(this.$Ze=Y,this.oQh=null)}Gln(){this.oQh||(this.oQh=this.z_m());return this.oQh}z_m(){const Y=[];Array.add(Y,this.$Ze);for(let Sa=
1;Sa<=this.Fem||Sa<=this.Hcm;Sa++)Sa<=this.Fem&&Array.add(Y,this.$Ze+Sa),Sa<=this.Hcm&&0<=this.$Ze-Sa&&Array.add(Y,this.$Ze-Sa);return Y}}Object(c.a)(Gl,"SlideWindow",null,[]);class Ni{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd){this.Cyb=!1;this.qc=Oc;this.Zr=oc;this.ZYa=Zd;this.b_e=new fi.a;this.SF=new Af(Object(h.a)(this,this.zwl,"tryScan"),nd);this.HTg=new Gl(oc&&oc.Ia?oc.Ia.slideIndex:0,Cd?Cd.HBm:10,Cd?Cd.GBm:5);this.nel(Y,Sa,Mb)}start(){this.Cyb?H.a.$(507843731,813,100,"StreamVideoPrefetchOrchestrator::Start: Trying to start StreamVideoPrefetchOrchestrator twice."):
(H.a.$(507843730,813,100,"StreamVideoPrefetchOrchestrator Starting."),this.Cyb=!0,this.SF.b9c())}nel(Y,Sa,Mb){Y&&Y.cU(Object(h.a)(this,this.zVh,"onEditSlideChanged"));Sa&&Sa.Rva(Object(h.a)(this,this.JVh,"onPageContentLoaded"));Mb&&Mb.Pjc(Object(h.a)(this,this.uUn,"onSlideshowSlideChanged"))}JVh(Y,Sa){this.Cyb&&(Y=Object(G.a)(22,Sa.node))&&Y.JD&&(this.b_e.remove(Y.fc),this.SF.b9c())}zVh(Y,Sa){Sa&&Sa.aab&&this.zT(Sa.aab.slideIndex)}uUn(Y,Sa){Sa&&this.zT(Sa.slideIndex)}zT(Y){this.HTg.K$n(Y);this.Cyb&&
this.SF.b9c()}zwl(){const Y=this.orj();0<Y.length&&this.D5k(Y[0]);return 1<Y.length}orj(){const Y=[];var Sa=this.Zr.presentation;if(!Sa)throw Error.argumentNull("Presentation is null");Sa=Sa.slides||[];for(const Mb of this.HTg.Gln()){const oc=Sa[Mb];this.odo(oc)&&Array.add(Y,oc)}return Y}odo(Y){return!!Y&&Y.JD&&!Y.qR&&!this.b_e.contains(Y.fc)}D5k(Y){this.b_e.add(Y.fc);Y=this.Uln(Y);0<Y.length&&(H.a.$(507843729,813,100,"StreamVideoPrefetchOrchestrator::ScanSlide: Found {0} videos.",Y.length),this.ZYa?
this.ZYa.orm(Y):H.a.$(507843728,813,10,"StreamVideoPrefetchOrchestrator::ScanSlide: Found videos to prefetch, but StreamPreFetchService is null."))}Uln(Y){if(!this.qc)return H.a.$(507843727,813,10,"StreamVideoPrefetchOrchestrator::GetStreamVideosToLoadForSlide: SlideReader is null, so we cannot scan slides for Stream videos."),this.SF.J5l(),[];const Sa=[];if(!Y)return Sa;Y=Object(G.a)(22,Y);if(!Y)return Sa;for(const Mb of Y.Nj())(Y=Mb.yva)&&this.ZYa&&this.ZYa.Igb(Y)&&Array.add(Sa,Y);return Sa}static cyn(Y){return!!Y&&
Y.fPh&&!Na.a.Fj&&!Na.a.wgb&&!Na.a.cY&&!Na.a.DZe}}Object(c.a)(Ni,"StreamVideoPrefetchOrchestrator",null,[]);class sk{static addAppPLTEventToLog(Y){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Y)}catch(Sa){}}static setIsPageLoadForFirstTime(Y){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Y)}catch(Sa){}}}Object(c.a)(sk,"VersionHistoryLogConnector",null,[]);class Qj{constructor(Y,Sa,Mb,oc){this.WSa=null;this.svm=this.ResetAppVersionController;
this.RSa=Y;this.qk=Sa;this.Ea=Mb;this.rc=oc;this.Bpd={}}OnVersionHistorySelected(Y,Sa){try{H.a.$(39105290,822,50,"PPTVersionHistorySelectionHandler:OnVersionHistorySelected");const Mb=document.getElementById("VersionHistoryViewerSpinner");Mb&&(Mb.style.display="none");if(this.WSa)this.WSa.onVersionSelected(Y,Sa,this.Bpd)}catch(Mb){H.a.$(39146258,822,50,"PPTVersionHistorySelectionHandler: OnVersionHistorySelected failed due to exception. {0}",Mb)}}ResetAppVersionController(Y){try{if(this.WSa)sk.setIsPageLoadForFirstTime(!1),
this.WSa.switchParentViewContainer(Y);else{sk.setIsPageLoadForFirstTime(!0);const Sa=new PowerPointVersionHistory.AppBootSettings;Sa.RenderServiceBase="";Sa.IsRtl=!1;const Mb=new PowerPointVersionHistory.AppCallbackBag;Mb.animationDecoratorCallback=Object(h.a)(this.RSa,this.RSa.YQi,"createAnimationOrTransitionStar");Mb.notesIconDecoratorCallback=Object(h.a)(this,this.CreateNotesIcon,"CreateNotesIcon");Sa.IsHighContrast=!1;this.qk&&(Sa.IsHighContrast=this.qk.isInHighContrastMode);Sa.IsHighContrast&&
(Sa.ClientColorSettings=this.qk.highContrastColors.foregroundTextColor+"_"+this.qk.highContrastColors.backgroundColor+"_"+this.qk.highContrastColors.linkColor);if(this.rc){const oc=this.rc.m5a();Sa.DefaultSlideWidth=oc.width;Sa.DefaultSlideHeight=oc.height}Sa.UserSessionId=n.AFrameworkApplication.userSessionId;Sa.VersionViewerCssUrl=this.Ea.pQe;Sa.ProgressImageResourceUrl=ed.a.NX(yb.a.mZa);this.WSa=new PowerPointVersionHistory.AppVersionController(Sa,Y,Mb)}}catch(Sa){H.a.$(39146260,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",
Sa)}}CreateNotesIcon(){return Ca.a(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,"Notes")}}Object(c.a)(Qj,"PPTVersionHistorySelectionHandler",null,[807]);class Bf extends ha{constructor(Y){super(Y,void 0,n.AFrameworkApplication.gIb)}get t$b(){return CommonUIStrings.l_DownLoadACopyDialogMessage}get SZe(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get Qmg(){return"PowerPointDownloadCopyLink"}get buttonText(){return CommonUIStrings.l_Download}get RMf(){return n.AFrameworkApplication.gIb?
"UIFontDialogTextLarge":null}WZe(){H.a.$(507905890,801,50,"Download a copy dialog displayed")}bog(){H.a.$(507905889,801,50,"Download a copy dialog clicked")}Sce(){H.a.$(507905888,801,50,"Download a copy dialog button clicked")}}Object(c.a)(Bf,"PowerPointDownloadACopyDialog",ha,[]);class Ej{Yeo(Y){new Bf(Y)}}Object(c.a)(Ej,"PowerPointDownloadACopyDialogFactory",null,[777]);var Rj=a(81),Zk;(function(Y){Y[Y.OK=0]="OK";Y[Y.cancel=1]="cancel";Y[Y.error=2]="error";Y[Y.open=3]="open"})(Zk||(Zk={}));Object(c.b)("HubbleAction",
Zk);var na=a(737);const Ya={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net","https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net","https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};class nc{constructor(Y){this.Tnd=
Y}static dtb(){return Date.now()>nc.swm}getToken(Y){return Object(Rj.b)(this,void 0,void 0,function*(){return nc.dtb()?yield this.refreshToken(Y):nc.j5e})}refreshToken(Y){return Object(Rj.b)(this,void 0,void 0,function*(){nc.j5e="";if(!this.Tnd)return e.ULS.sendTraceTag(508872861,352,50,"Refresh token requested without IOAuthManager."),nc.j5e;try{const Sa=yield this.Tnd.hP("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");Sa.IsSuccess&&(nc.swm=Sa.Telemetry.expiresOn?1E3*(Sa.Telemetry.expiresOn-
10):0,nc.j5e=Sa.Token);e.ULS.sendTraceTag(509096264,352,50,`Hubble token requested by: ${"PowerPointInsertMediaDialog"} successful: ${!!nc.j5e} time: ${(new Date).getTime()-Y}`)}catch(Sa){e.ULS.sendTraceTag(509096262,352,10,`Hubble token requested by: ${"showInsertMediaDialog"} successful: false time: ${(new Date).getTime()-Y} error: ${Sa}`)}return nc.j5e})}}nc.swm=0;nc.j5e="";Object(c.a)(nc,"TokenCache",null,[]);class Qc extends lb.a{constructor(Y,Sa,Mb,oc,Oc){super();this.RD=null;this.cRh=!1;this.Cxg=
this.g7b=this.RYa=null;this.UDi="KeepFocusDiv";this.VDi="KeepFocusStartDiv";this.correlationId=null;this.kzb=0;this.GMc=null;this.aJh=0;if(!Y)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.pfm=Y;this.OIa="";this.vsa=Mb;this.Ogb=oc;this.lpd=[];this.VFn=Sa;this.Vl=Oc||rd.Vl;this.rj="InsertMediaDialog";this.C$f=!1;this.Ue=5}FJe(Y,Sa,Mb){Object(Rj.b)(this,void 0,void 0,function*(){this.OIa=Y;this.NZc=new nc(Mb);this.vk=(new Date).getTime();yield this.NZc.getToken(this.vk);
this.cRh=!1;this.showDialog(this.OIa,null);this.RYa=this.nLh(this.jl("insertmediaframe"));if(!this.RYa)throw this.GXb(this.oUe),Error.invalidOperation("Couldn't get InsertMediaIframe.");var oc=document.getElementById(this.jl("WACDialogPanel"));oc&&oc.setAttribute(Fa.a.ii,Fa.a.ekc);oc=document.createElement("div");oc.setAttribute("Id",this.VDi);oc.setAttribute("tabindex","0");oc.setAttribute("position","absolute");oc.setAttribute("width","-1000px");oc.setAttribute("top","-1000px");this.RYa.parentNode.insertBefore(oc,
this.RYa.parentNode.firstChild);oc=document.createElement("div");oc.setAttribute("Id",this.UDi);oc.setAttribute("tabindex","0");this.RYa.parentNode.appendChild(oc);oc.setAttribute("position","absolute");oc.setAttribute("width","-1000px");oc.setAttribute("top","10000px");$addHandler(this.$Ih,"keydown",Object(h.a)(this,this.LJ,"keyDownHandler"));this.RYa.setAttribute("src",this.pfm);this.RYa.setAttribute("width","100%");this.RYa.setAttribute("height","100%");this.RYa.setAttribute("frameborder","0");
n.AFrameworkApplication.ha.getBooleanAppSetting("ShowInsertMediaIframeWhenIframeIsReady")&&(Na.a.Yf||Na.a.o2b)?(this.RYa.style.visibility="hidden",this.Cxg=Object(h.a)(this,this.pSn,"onInsertMediaIframeLoaded"),bc.a.addHandler(this.RYa,"load",this.Cxg)):this.RYa.style.visibility="visible";this.nLh(this.jl("WACDialogTitleText")).style.display="none";if(2===this.kzb||5===this.kzb)this.nLh(this.jl("WACDialogTitlePanel")).style.display="none",this.nLh(this.jl("WACDialogBodyPanel")).style.padding="0";
Cb.FocusManager.instance().yu().scope.US=!0;oc=this.pfm;const Oc=new URL(oc),nd=Ya[Oc.protocol+"//"+Oc.host];nd?oc=nd:e.ULS.sendTraceTag(508937633,352,10,`Target URL: ${Oc.host} not found`);this.RD=this.VFn.getInstance(this.RYa.contentWindow,oc);this.RD.rHb("https://osiziwuspersimmon002.blob.core.windows.net");this.RD.rHb("https://osizewuspersimmon001.blob.core.windows.net");this.RD.rHb("https://osizpscuspersimmon000.blob.core.windows.net");this.RD.rHb("https://cdn.hubblecontent.msit.osi.office.net");
this.RD.rHb("https://cdn.hubblecontent.osi.office.net");this.RD.$nc(gg.a.gXa,Cd=>{this.QPn(Cd,Object(h.a)(Sa,Sa.Klc,"insertMediaCallback"))});this.RD.$nc(gg.a.insert,Cd=>{this.zyk(Cd,Object(h.a)(Sa,Sa.Klc,"insertMediaCallback"))});this.RD.$nc(gg.a.kPl,Cd=>{this.USn(Cd)});this.RD.$nc(gg.a.v2l,Object(h.a)(this,this.PRn,"onGetCustomHeaders"));this.RD.$nc(gg.a.q4l,Object(h.a)(this,this.XRn,"onGetSessionId"));this.RD.$nc(gg.a.a2l,Object(h.a)(this,this.ORn,"onGetCID"));this.RD.$nc(gg.a.GTl,Object(h.a)(this,
this.yQn,"onCancelDialog"));2===this.kzb&&0===this.aJh&&(this.RD.$nc(gg.a.Xam,Object(h.a)(this,this.ASn,"onLaunchM365Upsell")),this.g7b=this.Ogb.UKb("MsoPremiumStockImages",Cd=>{e.ULS.sendTraceTag(512497694,352,50,"OnCompleteM365Upsell: Thanks for purchasing!");this.RD.sendMessage(gg.a.NEm,{["LicenseTier"]:Cd.toString()})}));this.rib(3)})}pSn(){this.RYa&&(this.RYa.style.visibility="visible",window.setTimeout(()=>{if(this.Pi){const Y=this.Pi.getElementById("insertmediaframe");Y&&Y.focus()}},0))}LJ(Y){Y.keyCode===
Sys.UI.Key.tab&&(Y.target.id!==this.UDi||Y.shiftKey?Y.target.id===this.VDi&&Y.shiftKey&&(Y.preventDefault(),this.Pi.getElementById(this.UDi).focus()):(Y.preventDefault(),this.Pi.getElementById(this.VDi).focus()))}dispose(){this.Ogb&&this.g7b&&this.Ogb.kec("MsoPremiumStockImages",this.g7b);this.RD&&(this.RD.dispose(),this.RD=null);this.Cxg&&(bc.a.removeHandler(this.RYa,"load",this.Cxg),this.Cxg=null);super.dispose()}QPn(Y,Sa){e.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(Y=this.vsa.gpm(Y))50<
this.lpd.length?e.ULS.sendTraceTag(7135753,352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(this.lpd,Y),this.cRh&&(Sa(this.lpd),this.cRh=!1))}yQn(){e.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.GXb(this.oUe);this.rib(1)}rib(Y){if(2===this.kzb||5===this.kzb){const oc=n.AFrameworkApplication.ha.Ma("InsertMediaDialogAriaTenantNameSpace");if(oc&&""!==oc){var Sa=[],Mb="InsertUnknownContent";2===this.kzb?(Array.add(Sa,Object.assign(new x.a,{name:"DialogMode",
string:"M365Content"})),Array.add(Sa,Object.assign(new x.a,{name:"Provider",string:"M365Content"})),Mb="InsertM365Content"):5===this.kzb&&(Array.add(Sa,Object.assign(new x.a,{name:"DialogMode",string:"HubbleVideo"})),Array.add(Sa,Object.assign(new x.a,{name:"Provider",string:"HubbleVideo"})),Mb="InsertHubbleVideo");Array.add(Sa,Object.assign(new x.a,{name:"InsertedFiles",int64:this.lpd.length}));Array.add(Sa,Object.assign(new x.a,{name:"DialogResult",string:Zk[Y]}));Array.add(Sa,Object.assign(new x.a,
{name:"CorrelationId",string:this.correlationId.toString()}));k.a.sendTelemetryEvent(Object.assign(new v.a,{name:String.format("{0}.{1}",oc,Mb),dataFields:Sa}))}}}nLh(Y){const Sa=document.getElementById(Y);if(!Sa)throw Error.invalidOperation(String.format("Couldn't get {0}.",Y));return Sa}zyk(Y,Sa){e.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.GXb(this.oUe);Sa?this.lpd&&0<this.lpd.length?(Sa(this.lpd),this.rib(0)):(e.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.cRh=
!0,Sa(this.lpd),this.rib(2)):this.rib(2)}PRn(){return Object(Rj.b)(this,void 0,void 0,function*(){if(this.RD){var Y=yield this.NZc.getToken(this.vk);e.ULS.sendTraceTag(509096025,352,50,`onGetCustomHeaders : Token available: ${!!Y} time: ${(new Date).getTime()-this.vk}`);this.RD.sendMessage(gg.a.Xxm,{["CustomHeaders"]:Y||""})}})}XRn(){this.RD&&(e.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.RD.sendMessage(gg.a.Kym,{["SessionId"]:n.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))}ORn(){this.RD&&
(e.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.RD.sendMessage(gg.a.Sxm,{["CID"]:""}))}USn(Y){Y&&Y.Values&&(Y=Y.Values,delete Y.m_Origin,delete Y.m_Source,delete Y.m_ReceivedTime,e.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+Y.eventName||!1),k.a.sendOtelEvent(Object.assign(new na.a,{otelEvent:Y})))}ASn(){this.Ogb&&(e.ULS.sendTraceTag(512497693,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.Ogb.launchUpsellExperience("stockimages"))}}
Object(c.a)(Qc,"InsertMediaDialog",lb.a,[824,40]);class pd{getInstance(Y,Sa,Mb,oc,Oc){return new Qc(Y,Sa,Mb,oc,Oc)}}Object(c.a)(pd,"PptInsertMediaDialogFactory",null,[802]);var Xd=a(122);class Fe{constructor(Y){this.$ie=Y;this.nel(this.$ie.Ri,this.$ie.Dgm)}nel(Y,Sa){Y&&Y.cU(Object(h.a)(this,this.zVh,"onEditSlideChanged"));Sa&&Sa.Rva(Object(h.a)(this,this.JVh,"onPageContentLoaded"))}$5n(Y,Sa){Y&&Y.Qla(Object(h.a)(this,this.zVh,"onEditSlideChanged"));Sa&&Sa.Fbb(Object(h.a)(this,this.JVh,"onPageContentLoaded"))}JVh(Y,
Sa){(Y=Object(G.a)(22,Sa.node))&&Y.JD&&(this.$ie.b_e.remove(Y.fc),this.$ie.SF.b9c())}zVh(Y,Sa){Sa&&Sa.aab&&(this.$ie.god=Sa.aab,this.$ie.SF.b9c(),this.$ie.H9j=new Date)}}Object(c.a)(Fe,"SlideEventListener",null,[]);class df{constructor(Y,Sa,Mb){this.qim="";this.yke=!1;this.Ule=new Date(0);this.Tle=new Date(0);this.Ilk=Y;this.Yb=Sa;Mb&&(this.qim=Mb)}J5l(){this.yke=!0}b9c(){this.yke?H.a.$(591003664,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):
this.Ule>this.Tle?H.a.$(591003662,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.Ule+". Last scan at "+this.Tle+"."):(this.Ule=new Date,this.Yb.Rb(new B.a(3,1,0,Object(h.a)(this,this.S3k,"runJob"),90,this.qim)))}S3k(){this.Tle=new Date;this.yke?H.a.$(591003660,813,100,"BackgroundJobScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.Ilk()&&this.b9c()}}
Object(c.a)(df,"BackgroundJobScheduler",null,[]);class xf{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf){this.ATh=null;this.H9j=new Date;this.god=null;this.yem={};this.xim={};this.Eim={};this.Xdm={};if(!Mb)throw Error.argumentNull("graphTopologyManager");if(!oc)throw Error.argumentNull("fontUtilsManager");this.Zr=Mb;this.OG=oc;this.Ri=Y;this.Dgm=Sa;this.SYc=Zd;this.X8b=we;this.TYc=Qe;this.xTh=kf;this.b_e=new fi.a;this.SF=new df(Object(h.a)(this,this.zwl,"tryScan"),Oc,"");0<nd&&window.setInterval(Object(h.a)(this,
this.Fbm,"logMissingFonts"),nd);this.sFn=Cd;Y=Mb.Ia?Mb.Ia.slideIndex:0;if(Sa=this.Zr.presentation)Sa=Sa.slides||[],Y<Sa.length&&(this.god=Sa[Y],this.H9j=new Date)}dispose(){this.stop();this.Fbm()}start(){this.stop();this.ATh=new Fe(this);this.SF.b9c()}stop(){this.ATh&&this.ATh.$5n(this.Ri,this.Dgm);this.ATh=null}orj(){const Y=[];this.god&&Y.push(this.god);return Y}zwl(){const Y=this.orj();0<Y.length&&(this.D5k(Y[0]),this.b_e.add(Y[0].fc));return 1<Y.length}Q4j(Y,Sa,Mb,oc){const Oc=[];for(const nd of Object.keys(Y))Y[nd]||
this.Xdm[nd]||(Oc.push(nd),this.Xdm[nd]=!0);Y=Oc.length;0<Y&&(H.a.$(Mb,820,15,"{0}",Y),Sa&&H.a.$(oc,820,15,"{0}",Oc.join(",")))}D5k(Y){const Sa=Y.l_b();if(Sa&&(this.SYc||this.TYc||this.X8b||fb.a("ShouldLogMissingThirdPartyFontCount"))){var Mb={},oc={},Oc={};Y.vKh.split(",").forEach(Qe=>{Qe&&(Qe=this.OG.$I(Qe),Mb[Qe]=!1)});Y.k1h.split(",").forEach(Qe=>{Qe&&(Qe=this.OG.$I(Qe),oc[Qe]=!1)});Y.U1h.split(",").forEach(Qe=>{Qe&&(Qe=this.OG.$I(Qe),Oc[Qe]=!1)});Y=[];var nd=[],Cd=[];for(let Qe=0;Qe<Sa.length;Qe++){var Zd=
Sa[Qe];Zd=Array.isArray(Zd.HJ())?Zd.HJ():null;for(const kf of Zd)for(Zd=0;kf.$a&&Zd<kf.$a.length;){var we=kf.$a.ka(Zd);we=we.formatting?this.OG.$I(Xd.Font.tIa(we.formatting.cache.UK.trim().toLowerCase())):"";Eb.a.wb(we)||(we in Mb&&!Mb[we]?(Y.push(we),Mb[we]=!0):we in oc&&!oc[we]?(nd.push(we),oc[we]=!0):we in Mb||we in oc||Oc[we]||(Cd.push(we),Oc[we]=!0));Zd++}}this.SYc&&(xf.CJj(this.yem,Y,this.OG),this.Q4j(Mb,!0,555886295,555886296));if(this.X8b||fb.a("ShouldLogMissingThirdPartyFontCount"))xf.CJj(this.xim,
nd,this.OG),this.Q4j(oc,this.X8b||this.xTh,555886297,555886298);this.TYc&&(xf.CJj(this.Eim,Cd,this.OG),this.Q4j(Oc,this.xTh,555886299,555886300))}}Fbm(){+new Date-+this.H9j<this.sFn||(this.SYc&&xf.l6j(this.yem,this.OG,591003669,!0,"MissingFirstPartyFonts"),(this.X8b||fb.a("ShouldLogMissingThirdPartyFontCount"))&&xf.l6j(this.xim,this.OG,591003667,this.X8b||this.xTh,"MissingThirdPartyFonts"),this.TYc&&xf.l6j(this.Eim,this.OG,587337796,this.xTh,"MissingNonLoggableFonts"))}static CJj(Y,Sa,Mb){Sa.forEach(oc=>
{fb.a("ShouldNormalizeFontNamesBeforeLogging")&&(oc=Mb.$I(oc));if(void 0===Y[oc]||null===Y[oc])Y[oc]=!1})}static Rin(Y,Sa){if(!Y)throw Error.argumentNull("fonts");const Mb=[];for(const oc of Object.keys(Y))Y[oc]||(Sa.Ifa(oc)||Sa.Ifa('"'+oc+'"')||Mb.push(oc),Y[oc]=!0);return Mb}static l6j(Y,Sa,Mb,oc,Oc){Sa=xf.Rin(Y,Sa);Y=Sa.length;0<Y&&(Sa=Sa.join(","),oc&&587337796===Mb?H.a.$(Mb,820,15,"{0}",Sa):H.a.$(Mb,820,15,"{0}",oc?Sa:Y.toString()),Mb=new Map,oc&&Mb.set("Fonts",Sa),Mb.set("FontsCount",Y.toString()),
Rf.Health.instance.recordQosError(Oc,["MissingFont"],!1,!1,!0,!1,{extendedProperties:Mb}))}}Object(c.a)(xf,"FontLogger",null,[40]);var Nf=a(844),nf=a(764),Ig=a(220);class bg{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg,yh,qg,Ug,Zh,Ii,Jl,Tl,jm){this.IVc=!1;this.g7b=null;this.hnc=(Pj,Gj)=>{var dk,ql;null!==(dk=Gj.Ly)&&void 0!==dk&&dk.Id&&this.nFn===(null===(ql=Gj.Ly)||void 0===ql?void 0:ql.Id)&&H.a.$(507884387,846,50,`InsertLocalVideo: ${this.mFn};InsertVideoTimeFromServer:${Date.now()}`)};
this.ifo=(Pj,Gj,dk)=>{var ql;Gj=this.ya.Ia;if(!Gj||this.zc.Hd(Gj))return 16;if(1===dk)return 32;H.a.$(508941190,846,50,"InsertVideoActor::InsertStockVideos Initiated");this.rf=zi.a.Xk("StockVideos::Insert");dk=new Rc.QueryStringBuilder(this.Ea.JNh);dk.Cz("initpivot","stockvideos");dk.ej("entryPoint",tb.a.gv(Pj));dk.ej("sv","1");fb.a("AddDalleTabToStockVideoDialog")&&this.vsa.kTm(this.Ea,dk);const yl=new rk(this.la,this.vsa,this.Ea);yl.XZ=tb.a.Mlc;null===(ql=this.rf)||void 0===ql?void 0:ql.Za("StockVideoInitiatedByRibbon",
"true");yl.Hxm(this.rf);const rl=dk.toString();if(!rl||!rl.length)return 16;try{const qi=Yb.a.create(),$i=Eb.a.tS(this.Ea.ZTa).toString();this.Pgb.execute(Cj=>{var wm=this.Ea.uLj&&Cj.isFreemiumUpsellEnabled();wm=this.IVc?1:wm?0:-1;var cm=this.Ea.getBooleanAppSetting("InsertOnlineM365ExperimentEnabled")?1:0;cm=this.vsa.zSl(Ig.App.mode,rl,wm,1,qi.toString(),$i,cm);Cj=this.N_e.getInstance(cm,this.M_e,this.vsa,Cj,vd.Vl);Cj.correlationId=qi;Cj.kzb=2;Cj.aJh=wm;Cj.FJe(CommonUIStrings.L_VideoInsertTitle,
yl,void 0);this.rf&&this.rf.Za("StockVideoDialogInitialized","true");H.a.$(509100040,846,50,"InsertVideoActor::showStockVideosDialog : Show dialog success.")});return 32}catch(qi){H.a.$(509100039,846,10,"InsertVideoActor::showStockVideosDialog : Exception = [{0}]",qi.toString())}return 8};this.Gvn=(Pj,Gj,dk,ql,yl)=>{Pj=this.ya.Ia;if(!Pj||this.zc.Hd(Pj))return 16;if(1===dk)return 32;if(!this.zj.KD(Pj,1))return this.zj.qJ(Pj),16;if(!yl||!yl.OriginalUrl)return 16;try{const rl=Pj.C$(this.rb.zd());if(rl&&
this.zc.Hd(rl))return 16;const qi=this.gMh(Pj,rl),$i=this.Tb.Kd(15,void 0,()=>{this.rb.Rx();this.rb.nj();this.Na.ee()},()=>{this.rb.selectShape(qi,!0)});try{$i.tc(Pj);$i.wc=tb.a.Mlc;$i.mE[Je.a.Dfb]=Je.a.t3c;H.a.$(509100038,846,50,"InsertVideoActor::UploadStockVideo");qi.setValue(jc.a.Jha,yl.LicenseUrl?null:yl.Caption);qi.Uic=yl.Caption;qi.setValue(jc.a.mediaType,2);qi.setValue(jc.a.xm,!0);qi.setValue(jc.a.lJa,!0);qi.setValue(jc.a.yva,yl.OriginalUrl);qi.setValue(jc.a.pq,!0);const Cj=String.format("{0}{1}",
"video",Yb.a.create().toString());qi.Vic=Cj;rl&&Pj.w1([rl]);Pj.BJ(qi)}finally{$i&&$i.dispose()}this.rw.MJ=qi;return 32}catch(rl){return H.a.$(509100037,846,10,"InsertVideoActor:: Error while creating video shape node : Exception = [{0}].",rl.toString()),8}};this.Kwm=(Pj,Gj)=>{Pj=Gj.node;null!=Pj&&Pj==this.Ufm&&(this.nFn=Gj.revisionId.toString(),this.Ufm=void 0)};this.AY=(Pj,Gj)=>{var dk;this.rf&&(this.rf.Za("MediaFileValidationPassedOnUI","false"),this.rf.Za("ErrorMessage",null===(dk=Gj.Message)||
void 0===dk?void 0:dk.toString()),this.rf.finish(),this.rf=null);Pj=Gj.ExtraErrorParam?String.format(Gj.Message,Gj.ExtraErrorParam):Gj.Message;Gj=Object.assign(new nf.a,{title:Gj.Title,message:Pj,timeoutInSeconds:120});this.PJ.sJe(Gj)};if(!Y)throw Error.argumentNull("applicationSettings");if(!Sa)throw Error.argumentNull("actionManager");if(!Mb)throw Error.argumentNull("graphTopologyManager");if(!oc)throw Error.argumentNull("graphActionBlockingManager");if(!Oc)throw Error.argumentNull("pptSelectionManager");
if(!nd)throw Error.argumentNull("ribbonChangeManager");if(!Cd)throw Error.argumentNull("transactionFactory");if(!Zd)throw Error.argumentNull("shapeEditor");if(!we)throw Error.argumentNull("errorHandler");if(!Qe)throw Error.argumentNull("focusManager");if(!kf)throw Error.argumentNull("sessionInfo");if(!Vf)throw Error.argumentNull("mediaUploaderFactory");if(!eg)throw Error.argumentNull("calloutNotificationAdapter");if(null===Y||void 0===Y?0:Y.WMc){if(!zg)throw Error.argumentNull("appFeatureHelper");
if(!yh)throw Error.argumentNull("insertMediaHelper");if(!Ug)throw Error.argumentNull("insertMediaCrossDocumentMessengerFactory");if(!qg)throw Error.argumentNull("insertMediaDialogFactory");if(!Zh)throw Error.argumentNull("shapeCountValidator");if(!Ii)throw Error.argumentNull("pageView");if(!Jl)throw Error.argumentNull("presReader");}if(null===Y||void 0===Y?0:Y.getBooleanAppSetting("RecordLocalVideoUploadInboundTime")){if(!jm)throw Error.argumentNull("graphOperationEventHandler");if(!Tl)throw Error.argumentNull("shapeGraphNodeEventHandlers");
}this.Ea=Y;this.la=Sa;this.ya=Mb;this.zc=oc;this.rb=Oc;this.rw=nd;this.Tb=Cd;this.il=Zd;this.le=we;this.Na=Qe;this.Kw=Mb.presentation;this.Me=kf;this.mxb=Vf;this.PJ=eg;this.Pgb=zg;this.vsa=yh;this.M_e=Ug;this.N_e=qg;this.zj=Zh;this.zb=Ii;this.Xb=Jl;this.thb=Tl;this.nh=jm;Nf.a.sDl=this.Ea.aEl;Nf.a.XDl=this.Ea.aFm;(null===Y||void 0===Y?0:Y.WMc)&&this.s0m()}Kb(){this.la.ua(tb.a.Hgc,ng.a.application,this.bqn.bind(this),4);this.la.ua(tb.a.MNh,ng.a.application,this.ifo,4);this.la.ua(tb.a.Mlc,ng.a.application,
this.Gvn,4);fb.a("EnableCalloutNotificationsForVideos")&&R.b(this.AY);this.Ea.getBooleanAppSetting("RecordLocalVideoUploadInboundTime")&&(this.nh.Jpa(this.hnc),this.thb.cfa(this.Kwm))}Ae(){}bqn(Y,Sa,Mb){const oc=this.ya.Ia;if(!oc||this.zc.Hd(oc))return 16;if(1===Mb)return 32;this.rf=zi.a.Xk("Video::Insert");try{return H.a.$(509650205,846,50,"InsertLocalVideo: flow initiated"),Ha.a.u6e(this.Ea.aEl.toString(),R.e,()=>R.d(Y,this.Kvn.bind(this),"video",this.Me,oc),"video",oc,this.ya.presentation,this.zc,
this.le,this.rf,!0,this.mxb,this.Ea.Apc,this.Ea.zpc,this.Ea.ypc),this.rf&&this.rf.Za("VideoDialogInitialized","true"),32}catch(Oc){H.a.$(509724677,818,10,"Exception {0} while rendering file selection dialog.",Oc)}R.a("video")?R.c(ResourceStrings.l_FileInsertFailedMessageTitle,ResourceStrings.l_FileInsertFailedMessage,null):this.showErrorMessage(446,null);return 8}dispose(){this.Pgb.instance&&this.g7b&&this.Pgb.instance.kec("MsoPremiumStockImages",this.g7b);this.Ea.getBooleanAppSetting("RecordLocalVideoUploadInboundTime")&&
(this.thb.fib(this.Kwm),this.nh.hib(this.hnc))}showErrorMessage(Y,Sa){this.rf&&(this.rf.finish(),this.rf=null);this.le.nM(Y,Mb=>{Mb.UE=1;Mb.Ifb=Sa;return!1})}Kvn(Y,Sa,Mb,oc,Oc,nd,Cd){oc.NO(Mb)&&H.a.$(509724676,822,15,"Video::insertVideoSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+Mb.Zha);oc.BE(Cd);Mb=Cd.Av();var Zd=this.Kw.slideHeight;oc=this.Kw.slideWidth/2-fh.a.Bf(yb.a.F4/2,0);Zd=Zd/2-fh.a.Bf(yb.a.F4/2,1);if(Cd&&Cd.isConnected){var we=this.Tb.Kd(15,void 0,
void 0,()=>{this.rw.MJ=this.Ipd;this.rb.selectShape(this.Ipd,!0);this.Na.ee()});try{we.tc(Cd);we.wc=Y;Oc&&Oc.Za("CreatingVideoShape","true");this.Ipd=this.il.eIa(!1,Cd.fc.cid,Cd.fc.sid,0,10,oc,Zd,yb.a.F4,yb.a.g9,Mb+1);const Qe=nd.files[0].name;this.Ipd.Vic=Sa;this.Ipd.Uic=Qe;fb.a("SetMediaTypeAsVideoForEmbeddedVideo")&&this.Ipd.setValue(jc.a.mediaType,2);(this.Ea.getBooleanAppSetting(sh.a.vGb)||this.Ea.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.VideoLoadingExperience",!1))&&this.Ipd.setValue(jc.a.pq,
!0);Cd.BJ(this.Ipd);this.Ufm=this.Ipd}finally{we&&we.dispose()}Oc&&(Oc.Za("VideoShapeSuccessfullyCreated","true"),Y=Date.now(),Oc.Za("successTime",Y.toString()),this.mFn=Oc.Dxa(),Oc.finish(),Oc=null)}}s0m(){this.Pgb.execute(Y=>{Y.isFeatureEnabled("MsoPremiumStockImages",!1).catch(Sa=>H.a.$(509100036,846,10,"InsertVideoActor::Constructor - Failed to load the premium state from application feature helper: {0}",Sa)).then(Sa=>{this.IVc=Sa;this.IVc||(this.g7b=Y.UKb("MsoPremiumStockImages",()=>{this.IVc=
!0;H.a.$(509100035,846,50,"InsertVideoActor:: setting isUserLicensed=1")}));return null})})}gMh(Y,Sa){if(!Y)return null;var Mb=Y.fc;Y=Y.Av();const oc=this.Xb.dna(yb.a.F4,yb.a.g9);Mb=this.il.JXa(!0,Mb.cid,Mb.sid,0,oc.x,oc.y,yb.a.F4,yb.a.g9,Y+1,!0);Sa&&(Mb.Yva=Sa.id);return Mb}}Object(c.a)(bg,"InsertVideoActor",null,[502]);class oh{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we){if(!Y)throw Error.argumentNull("transactionHelper");if(!Sa)throw Error.argumentNull("actionManager");if(!oc)throw Error.argumentNull("graphTopologyManager");
if(!oc.presentation)throw Error.argumentNull("graphTopologyManager.presentation");if(!Mb)throw Error.argumentNull("graphActionBlockingManager");if(!Oc)throw Error.argumentNull("ribbonChangeManager");if(!nd)throw Error.argumentNull("shapeEditor");if(!Cd)throw Error.argumentNull("shapeCountValidator");if(!Zd)throw Error.argumentNull("appSettings");if(!we)throw Error.argumentNull("selectionManager");this.Do=Y;this.la=Sa;this.ya=oc;this.zc=Mb;this.rw=Oc;this.Kw=oc.presentation;this.il=nd;this.zj=Cd;this.na=
Zd;this.sa=we}Kb(){this.na.QK&&this.la.ua(tb.a.Dmd,ng.a.application,this.Hon.bind(this),4)}Ae(){}Hon(Y,Sa,Mb){Sa=this.ya.Ia;if(!Sa)return 16;if(w.a.By(Sa.fc))return 8;if(this.zc.Hd(Sa))return 16;if(1===Mb)return 32;if(!this.zj.KD(Sa,1))return this.zj.qJ(Sa),16;var oc=Math.min(Math.min(this.Kw.a0h,this.Kw.X_h),100);Mb=Sa.Av();var Oc=this.Kw.slideWidth,nd=this.Kw.slideHeight,Cd=fh.a.Bf(oc,0);oc=fh.a.Bf(oc,1);Oc=Oc/2-fh.a.Bf(50,0);nd=nd/2-fh.a.Bf(50,1);Mb=this.il.eIa(!1,Sa.fc.cid,Sa.fc.sid,0,10,Oc,nd,
Cd,oc,Mb+1);this.na.qYa&&(Cd=Sa.UXd(this.sa.zd()).filter(Zd=>!!Zd&&!this.zc.Hd(Zd)).find(Zd=>16===Zd.placeholderType))&&(Mb.Yva=Cd.id);Mb.RB=!0;this.Do.EO([Mb],Sa,Y);H.a.$(508303115,352,50,"InsertCameoActor::handleInsertCameo : Inserting cameo is done.");this.rw.MJ=Mb;return 32}}Object(c.a)(oh,"InsertCameoActor",null,[502]);const rh="18 54 94 166 192 193 394 395 472 642 716 782 783 869 1004 1014 1024 1068 access_token access_token_ttl AccessTokenExpirationInMs AccessTokenTtl AriaEndpointTarget AriaOneCollectorUrlClient BuildVersion BulsEndpointUrl ClientManifestURL CoachImagesBaseFilePath CreateNew CreateNewTemplateLcid CreateNewTemplateName CustomResourceConfigProxyUrl DarkModeIsDefaultOn DarkModeIsOn DelayContentEditableViewActionIdsList DocID DocId EditingJSRestructuringForCreateNewEnabled HashedResourceClientManifest HealthOfflineWorkerScriptUrl HideWorkflowInHeaderByUiHost HostDisableChat HostProvidedClickTime IrmProtected IsCreateNewBlankPPT IsUnifiedHostMode jsapiversionminor newFromBlank OAuthManagerServiceSettings PodsFileGetUrl PodsFileName PodSID PostMessageToken PresentUrlEndpoint RenderBlankThumbnailPlaceholderEnabled RenderGridThumbnailPlaceholderEnabled RootQuerySignature sc SessionId SessionOrigin SessionStartInfoJson SharedStaticContentHost SharedUxSafeVelocityReleasedFlights Slice1Name StaticContentHost StatusBarEnvironmentNameToUse SuiteOrigin TemplateLcid ThumbnailPaneHeight UiHost UiHostIntegrationType UpdatePodsDocumentSettingsEndpoint WacCluster WACDatacenter WacSessionStartTime WacWebFrontEnd wdparams WOPISrc WsaData".split(" "),
Mh="0 43 44 343 786 access_token access_token_ttl AccessTokenExpirationInMs AccessTokenTtl AppCatalogUrl AppliedPolicyId AugloopACLPUserDataSignature BaseDocQuerySignatureWithoutVersion BaseFileName BreadcrumbDocName Canary DownloadACopyUrl EditDocInClientUrl EnableExportForProtectedFile EnableExtractForProtectedFile EnableFullControlForProtectedFile EnableMacrosForProtectedFile FileName FileSharingUrl HostEditUrl HostEmbeddedViewUrl HostResponseStats HostUrl HostWsaData IrmPolicyTitle LokiUserDataSignature OAuthManagerDocumentSettings ProtectedFile ServerDocId ServicesControlsMicrosoftControllerServicesList SessionStartInfoJson UnauthenticatedClientUrl UserCanWriteRelative UserDataSignature WOPISrc".split(" ");
var gi=a(698);class Si{constructor(Y){this.Jb=Y}TBn(){this.fho(this.Jb);n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.StoreAndLogSettingsDataIsEnabled",!1)&&this.gho()}fho(Y){try{const Sa=JSON.stringify(Y.clc),Mb=n.AFrameworkApplication.buildVersion,oc=localStorage.getItem("flightsData"),Oc=localStorage.getItem("buildVersion");if(oc)Si.GCn(oc,Sa,Oc,Mb),Si.$lo(Sa,Mb);else try{localStorage.setItem("flightsData",Sa),localStorage.setItem("buildVersion",Mb)}catch(nd){H.a.$(507581084,
809,10,"Failed to store flights data to local storage. Exception: {0}",nd.toString())}}catch(Sa){H.a.$(507581083,809,10,"Failed to access local storage. Exception: {0}",Sa.toString())}}static GCn(Y,Sa,Mb,oc){Y=JSON.parse(Y);Sa=JSON.parse(Sa);let Oc=0,nd=0,Cd=0;const Zd=[];for(const we in Y)Sa[we]?Y[we]!==Sa[we]&&(Oc++,Zd.push(we)):nd++;for(const we in Sa)Y[we]||Cd++;H.a.$(507581082,809,50,"cachedBuildVersion: {0}, currentBuildVersion: {1}, cacheHit: {2}, buildVersion: {3}, countOfFlightsWithDifferentValue: {4}, countOfNewFlights: {5}, countOfRemovedFlights: {6}",
Mb,oc,0===Oc&&0===nd?"true":"false",oc===Mb?"same":"different",Oc,Cd,nd);H.a.$(507581081,809,50,"Flights with different value: {0}",Zd)}static $lo(Y,Sa){try{localStorage.setItem("flightsData",Y),localStorage.setItem("buildVersion",Sa)}catch(Mb){H.a.$(507581080,809,10,"Failed to update flights data to local storage. Exception: {0}",Mb.toString())}}gho(){try{const Y=GetApplicationSettings(),Sa=globalThis.k4h;globalThis.k4h=null;const Mb={},oc={},Oc=Date.now();for(const yh in Y)!Array.contains(rh,yh)&&
Y[yh]&&(Mb[yh]=Object(gi.c)(Y[yh]));const nd=Date.now()-Oc,Cd=Date.now();for(const yh in Sa)!Array.contains(Mh,yh)&&Sa[yh]&&(oc[yh]=Object(gi.c)(Sa[yh]));const Zd=Date.now()-Cd;H.a.$(507581079,809,50,"Hashing app settings took {0} ms, Hashing doc settings took {1} ms",nd,Zd);const we=n.AFrameworkApplication.buildVersion,Qe=localStorage.getItem("settingsBuildVersion"),kf=JSON.stringify(Mb),Vf=JSON.stringify(oc),eg=localStorage.getItem("serviceWorkerAppSettings"),zg=localStorage.getItem("serviceWorkerDocSettings");
if(eg)Si.ECn(eg,kf,Qe,we),Si.FCn(zg,Vf,Qe,we),Si.Kmo(kf,Vf,we);else try{localStorage.setItem("serviceWorkerAppSettings",kf),localStorage.setItem("serviceWorkerDocSettings",Vf),localStorage.setItem("settingsBuildVersion",we)}catch(yh){H.a.$(507581078,809,10,"Failed to store settings data to local storage. Exception: {0}",yh.toString())}}catch(Y){H.a.$(507581077,809,10,"Failed to access local storage. Exception: {0}",Y.toString())}}static ECn(Y,Sa,Mb,oc){Y=JSON.parse(Y);Sa=JSON.parse(Sa);let Oc=0,nd=
0,Cd=0;const Zd=[];for(const we in Y)!Sa[we]&&Y[we]?nd++:Y[we]!==Sa[we]&&(Oc++,Zd.push(we));for(const we in Sa)!Y[we]&&Sa[we]&&Cd++;H.a.$(507581076,809,50,"cachedSettingsBuildVersion: {0}, currentSettingsBuildVersion: {1}, cacheHit: {2}, buildVersion: {3}, countOfAppSettingsWithDifferentValue: {4}, countOfNewAppSettings: {5}, countOfRemovedAppSettings: {6}",Mb,oc,0===Oc?"true":"false",oc===Mb?"same":"different",Oc,Cd,nd);H.a.$(507581075,809,50,"App settings with different value: {0}",Zd)}static FCn(Y,
Sa,Mb,oc){Y=JSON.parse(Y);Sa=JSON.parse(Sa);let Oc=0,nd=0,Cd=0;const Zd=[];for(const we in Y)!Sa[we]&&Y[we]?nd++:Y[we]!==Sa[we]&&(Oc++,Zd.push(we));for(const we in Sa)!Y[we]&&Sa[we]&&Cd++;H.a.$(507581074,809,50,"cachedSettingsBuildVersion: {0}, currentSettingsBuildVersion: {1}, cacheHit: {2}, buildVersion: {3}, countOfDocSettingsWithDifferentValue: {4}, countOfNewDocSettings: {5}, countOfRemovedDocSettings: {6}",Mb,oc,0===Oc?"true":"false",oc===Mb?"same":"different",Oc,Cd,nd);H.a.$(507581073,809,
50,"Doc settings with different value: {0}",Zd)}static Kmo(Y,Sa,Mb){try{localStorage.setItem("serviceWorkerAppSettings",Y),localStorage.setItem("serviceWorkerDocSettings",Sa),localStorage.setItem("settingsBuildVersion",Mb)}catch(oc){H.a.$(507581072,809,10,"Failed to update settings data to local storage. Exception: {0}",oc.toString())}}}Object(c.a)(Si,"FlightsAndSettingsTelemetryLogger",null,[]);class Sj{constructor(){this.tSa=this.vn=this.ohb=this.ga=null;this.ugm=[];this.m_=!1;this.Qsg=[new wk];
this.Vfa=[]}get name(){return"PowerPointWebEditor.Chronos2"}oc(Y){this.ga=Y;this.ohb=this.ga.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.vn=this.ohb.GIb(5,this.name);this.tSa=this.ga.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");this.m_=Y.resolve("PowerPointWebEditor.IApplicationSettings").getBooleanAppSetting("blockWebsocketConnectionForPAS");for(let Oc=0;Oc<this.Qsg.length;++Oc)Array.add(this.Vfa,wa.a(this.Qsg[Oc],5));for(const Oc of this.Vfa)Oc.oc(Y);const Sa=
this.ga.resolve("PowerPointWebEditor.IApplicationContext"),Mb=n.AFrameworkApplication.ha.getBooleanAppSetting("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled"),oc=lf.a.kH(this.ga.eb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));Object(fb.a)("EnhancementOfSDXPaneBootTime")||this.ga.register(Fk.a,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").pa(()=>new Fk.a(this.ga.resolve("Common.IActionManager"),this.ga.resolve("PowerPointWebEditor.IPPTWorkspace"),
this.ga.resolve("Box4.Graph.IGraphIteratorFactory"),this.ga.resolve("PowerPointWebEditor.IPPTApp"),this.ga.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"))).oa();this.ga.register(Qj,"PowerPointWebEditor.PPTVersionHistorySelectionHandler").as("Common.IVersionHistorySelectionHandler").oa().pa(()=>new Qj(this.ga.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.ga.resolve("Common.Utils.IHighContrastDetector"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.IPresentationReader")));
this.ga.register(xh,"Box4.Media.OneDriveFilePickerHelperV7").as("Box4.Media.IImageFilePickerHelper").oa().pa(()=>new xh(Y.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72"),new Ja.a(()=>oc.result),Y.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory")));this.ga.register(Ci,"Box4.Media.InsertOneDriveFileHelper").oa().pa(()=>new Ci(n.AFrameworkApplication.ub));this.ga.register(vh,"Box4.Media.InsertMediaHelper").as("Box4.Media.IInsertMediaHelper").oa().pa(()=>
new vh);this.ga.register(rk,"PowerPointWebEditor.InsertOnlineImageHelper").oa().pa(()=>new rk(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("Box4.Media.InsertMediaHelper"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings")));this.ga.register(Kk,"PowerPointWebEditor.ChangeOnlineImageHelper").oa().pa(()=>new Kk(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("Box4.Media.InsertMediaHelper"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings")));this.ga.register(aj,
"Box4.Media.InsertMediaFromHostManagerFactory").as("Box4.Media.IInsertMediaFromHostManagerFactory").oa().pa(()=>new aj(new jj(new Ja.a(()=>{if(n.AFrameworkApplication.pil()){var Oc=this.ga.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").BVd;Oc=new ri(Oc.contentWindow,"*")}else Oc=Sa.Y2l();return Oc}),Mb?td.a.getOrigin(window.document.URL):td.a.getOrigin(n.AFrameworkApplication.bga),n.AFrameworkApplication.ha.appSettings.ImageFetcherSupportedExtensions)));this.ga.register(Li,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").oa();
this.ga.register(mj,"Box4.Media.InsertMediaFromHostOneDriveHostFrame").as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").oa().pa(()=>new mj);this.ga.register(pd,"PowerPointWebEditor.PptInsertMediaDialogFactory").as("PowerPointWebEditor.IPptInsertMediaDialogFactory").oa();this.ga.register(777,"PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory").oa().pa(()=>new Ej);this.ga.register(Ni,"PowerPointWebEditor.StreamVideoPrefetchOrchestrator").oa().pa(()=>new Ni(this.ga.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.ga.resolve("Box4.Graph.IGraphInstance").Xd(8),this.ga.resolve("PowerPointWebEditor.ISlideshowFrame"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.ISlideReader"),this.ga.resolve("Common.ITaskManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.Video.IStreamPreFetchService")))}init(){let Y=this.vn.CJ("resolvechronos2");const Sa=this.ga.resolve("Common.AFrameworkApplication"),Mb=this.ga.resolve("PowerPointWebEditor.IApplicationContext"),
oc=Mb.Pd,Oc=Sa.Bj,nd=this.ga.resolve("PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory"),Cd=this.ga.resolve("Common.IActionManagerExtended"),Zd=this.ga.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");var we=this.ga.resolve("PowerPointWebEditor.IGraphTransactionHelper");const Qe=this.ga.resolve("PowerPointWebEditor.IFocusManager"),kf=Oc.Sd,Vf=this.ga.resolve("Common.Transaction.ITransactionFactory"),eg=this.ga.resolve("PowerPointWebEditor.IShapeEditor"),zg=this.ga.he("PowerPointWebEditor.IClassFactory"),
yh=this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),qg=this.ga.resolve("Box4.Graph.IGraphIteratorFactory"),Ug=this.ga.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Zh=this.ga.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),Ii=this.ga.resolve("PowerPointWebEditor.IPresentationReader"),Jl=Oc.pKb,Tl=this.ga.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),jm=this.ga.resolve("PowerPointWebEditor.IGraphHotColdManager"),Pj=this.ga.resolve("PowerPointWebEditor.ISaveBlockingUI"),
Gj=this.ga.resolve("PowerPointWebEditor.IRibbonChangeManager"),dk=this.ga.resolve("PowerPointWebEditor.IShapeReader"),ql=this.ga.resolve("PowerPointWebEditor.View.IPPTPageView");this.vn.FJ(Y);Y=this.vn.CJ("regactorschronos2");const yl=!Object(fb.a)("EnhancementOfSDXPaneBootTime");let rl;if(n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)){const qi=this.ga.resolve("Box4.IAppFrame");rl=$i=>null===qi||void 0===qi?void 0:qi.FY($i)}else rl=
()=>{};we=[...(yl?[new Tf.a(oc,this.ga.resolve("Common.IAppSettingsManager"),we,Cd,kf,this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Vf,zg,Zd,this.ga.eb("PowerPointWebEditor.IAppForOfficeManager"),qg,Ug,Zh,rl)]:[]),new vg(oc,Cd,Zd,this.ga.eb("PowerPointWebEditor.IAddinCommandsManager")),new Og(oc,Cd,Ug,yh,Qe,this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Vf,this.ga.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),this.ga.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),
this.ga.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),this.ga.resolve("Box4.Media.InsertMediaHelper"),this.ga.eb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.ga.resolve("PowerPointWebEditor.InsertOnlineImageHelper"),this.ga.resolve("PowerPointWebEditor.ChangeOnlineImageHelper"),Ii,eg,dk,ql,Gj,Zh,this.ga.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),this.ga.resolve("Box4.Media.IImageFilePickerHelper"),this.ga.resolve("Box4.Media.InsertOneDriveFileHelper"),
this.ga.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),this.ga.resolve("PowerPointWebEditor.IInsertImageHelper"),this.ga.resolve("PowerPointWebEditor.IJSanityHelper"),this.ga.resolve("PowerPointWebEditor.View.IViewEventSource"),this.ga.resolve("Common.IExternalUICommandDefinitionMapping"),this.ga.resolve("Common.IAppSettingsManager")),new wb(Cd,this.ga.resolve("PowerPointWebEditor.ISlidePane"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ug,yh,Gj,this.ga.resolve("Common.Transaction.ITransactionFactory"),
eg,this.ga.resolve("PowerPointWebEditor.IErrorHandler"),Qe,this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.ga.resolve("PowerPointWebEditor.IMediaUploader")),new oh(we,Cd,Ug,this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Gj,eg,Zh,this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),yh),new bg(this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),Cd,this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ug,yh,Gj,this.ga.resolve("Common.Transaction.ITransactionFactory"),
eg,this.ga.resolve("PowerPointWebEditor.IErrorHandler"),Qe,this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.ga.resolve("PowerPointWebEditor.IMediaUploader"),this.ga.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),this.ga.eb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.ga.resolve("Box4.Media.InsertMediaHelper"),this.ga.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),this.ga.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),
this.ga.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("Box4.Graph.IGraphInstance").Xd(10),this.ga.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"))];for(const qi of we)qi.Kb(),qi.Ae();Zd.Evf=!0;this.vn.FJ(Y);n.AFrameworkApplication.ha.Wf(()=>{Y=this.vn.CJ("regfullactorschronos2");const qi=[new Hh(Cd,Ug,Qe,yh,this.ga.resolve("PowerPointWebEditor.IPPTWorkspace").Tf,
Tl,Mb.Wfb().J$l,jm,this.ga.resolve("PowerPointWeb.IPrinter"),this.ga.resolve("PowerPointWeb.IConverter"),this.ga.resolve("Box4.IAppFrame"),Pj,nd,this.ga.resolve("PowerPointWebEditor.DownloadACopyAsPdfContext"),Sa.dOh,this.ga.resolve("PowerPointWebEditor.IBusinessBarController"),this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("Common.IAppSettingsManager"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"),
()=>n.AFrameworkApplication.zB,Mb.EZd(),$i=>n.AFrameworkApplication.Ha.Ib.$5e($i),()=>n.AFrameworkApplication.lnd,this.ga.resolve("PowerPointWebEditor.IDeferredContentManager"),this.ga.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),this.ga.resolve("PowerPointWebEditor.Storage.IOutboundHelper")),new nh(Oc,oc.a1l,Jl.VVe,Cd,Ii,Mb.EZd(),this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"))];for(const $i of qi)$i.Kb(),$i.Ae();
this.vn.FJ(Y)});H.a.$(512360593,809,50,"Chronos2Package::Init");for(const qi of this.Vfa)this.vn.CJ(qi.name),qi.init(),this.vn.FJ(qi.name);Y=this.vn.CJ("al");this.m_||this.Pun();this.vn.FJ(Y);n.AFrameworkApplication.ha.Wf(()=>{if(oc.TTa){Y=this.vn.CJ("idea");var qi=this.avn();this.$un(qi);this.vn.FJ(Y)}oc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1)&&(Y=this.vn.CJ("fastcards"),this.Uun(),this.vn.FJ(Y));oc.kZa&&(Y=this.vn.CJ("smartLookup"),this.mvn(),this.vn.FJ(Y));n.AFrameworkApplication.CZe()&&
(Y=this.vn.CJ("versionhistory"),this.ovn(),this.vn.FJ(Y));Ni.cyn(oc)&&Db.a.get_instance().Ai(7,()=>{this.ga.resolve("PowerPointWebEditor.StreamVideoPrefetchOrchestrator").start()});const $i=this.ga.resolve("PowerPointWebEditor.IApplicationSettings");if($i&&($i.Qgl||$i.Ngl||$i.Rgl)){const Cj=!Eb.a.wb(n.AFrameworkApplication.ha.Ma("TenantId"))&&Array.contains($i.oCm,n.AFrameworkApplication.ha.Ma("TenantId"));this.ga.register(xf,"PowerPointWebEditor.Text.FontLogger").oa().pa(()=>new xf(this.ga.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.ga.resolve("Box4.Graph.IGraphInstance").Xd(8),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.IFontUtilsManager"),this.ga.resolve("Common.ITaskManager"),$i.xjm,$i.wjm,$i.Qgl,$i.Ngl&&n.AFrameworkApplication.ha.getBooleanAppSetting("IsO365ConsumerHost"),$i.Rgl,$i.EZl&&Cj));qi=this.ga.resolve("PowerPointWebEditor.Text.FontLogger");this.ugm.push(qi);qi.start()}});n.AFrameworkApplication.hIa||(Y=this.vn.CJ("appforoffice"),this.Oun(),this.vn.FJ(Y));
Object(fb.a)("StoreAndLogFlightsData")&&this.ga.resolve("PowerPointWebEditor.IAppBootCompletedListener").vra(()=>{this.ga.register(Si,"PowerPointWebEditor.FlightsAndSettingsTelemetryLogger").oa().pa(()=>new Si(this.ga.resolve("Common.IAppSettingsManager")));this.ga.resolve("PowerPointWebEditor.FlightsAndSettingsTelemetryLogger").TBn()})}dispose(){for(const Y of this.Vfa)Y.dispose();for(const Y of this.ugm)try{Y&&Y.dispose()}catch(Sa){H.a.$(512360592,306,10,"Exception disposing a disposable. {0} {1}",
Sa.message,Sa.stack)}}Pun(){H.a.$(512360591,809,50,"Start to download augloop.hermes.js file and its dependency files");try{const Y=sb.a.create("pptedit.augloop",null,()=>a.e(11).then(a.bind(null,1897)));if(this.ga.resolve("PowerPointWebEditor.IApplicationSettings").Gye){const Sa=this.ga.resolve("Common.ISharedDependencyLoader"),Mb=n.AFrameworkApplication.oh("augloop-runtime-shim-ie",2);Sa.dmc(Mb).continueWith(()=>{Qb.a.RK(Y)})}else Qb.a.RK(Y)}catch(Y){H.a.$(512360590,306,10,"Failure downloading the augloop js with its depdencies: Message: {0}, Callstack: {1}",
Y.message,Y.stack)}}avn(){H.a.$(512360588,809,50,"Start to download infrared.hermes.js file");var Y=[this.tSa.XVb(n.AFrameworkApplication.oh("ir-plugin-ski.min.js",5))];Y=sb.a.create("pptedit.infrared",Y,()=>a.e(28).then(a.bind(null,1905)));Qb.a.RK(Y);return Y}$un(Y){H.a.$(512360587,809,50,"Start to download ideas.hermes.js file");Y=this.tSa.hVe(n.AFrameworkApplication.oh("microsoft.ideas.runtime.js",5),[Y],null,null,null,!1);Y=sb.a.create("pptedit.ideas",[Y],()=>a.e(18).then(a.bind(null,1908)));
Qb.a.RK(Y)}Uun(){H.a.$(508958302,809,50,"Start to download fastcards.hermes.js file");const Y=sb.a.create("pptedit.fastcards",null,()=>a.e(24).then(a.bind(null,1909)));Qb.a.RK(Y)}mvn(){H.a.$(512360586,809,50,"Start to download smartlookup.hermes.js file");const Y=sb.a.create("pptedit.smartlookup",null,()=>a.e(10).then(a.bind(null,1900)));Qb.a.RK(Y)}ovn(){var Y=n.AFrameworkApplication.oh("pptVersionHistory.js",5);Y=this.tSa.XVb(Y);try{Qb.a.RK(Y)}catch(Sa){H.a.$(512360585,809,10,"ChronosPackage::InitializeVersionHistory - Failed to download VersionHistory script, Exception: {0}",
Sa.toString())}}Oun(){const Y=this.ga.resolve("PowerPointWebEditor.IApplicationSettings");vb.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").x$f()?Sj.kIj():Y.li?n.AFrameworkApplication.ha.Wf(Sj.o8l):Db.a.get_instance().Ai(8,()=>{Sj.o8l()})}static main(){n.AFrameworkApplication.Ch&&Na.a.Yf?H.a.$(512360584,809,15,"Firefox attempts to load chronos2 package when App is disposing"):b.a.instance.Jc(wa.a(new Sj,5))}static kIj(){vb.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").rZ();
b.a.instance.Jc(new Bi)}static o8l(){let Y=!1;try{window.self.requestIdleCallback(Sj.kIj)}catch(Sa){Y=!0}Y&&window.setTimeout(Sj.kIj,0)}}Object(c.a)(Sj,"Chronos2Package",null,[4,5]);var mk=a(235),Fj;(function(Y){Y[Y.unsupported=0]="unsupported";Y[Y.designer=1]="designer";Y[Y.blank=2]="blank"})(Fj||(Fj={}));Object(c.b)("AgendaSlideThemeType",Fj);var Oi=a(134);class ti{constructor(){this.AgendaSlideSid=this.AgendaSlideCid=0;this.CorrelationId=null}}Object(c.a)(ti,"AgendaApplyInfo",null,[]);class Dj{constructor(){this.DeckSuggestionId=
this.CorrelationId=this.AgendaSessionId=null;this.FIsBlankOption=!1}}Object(c.a)(Dj,"AgendaThemeApplyInfo",null,[]);class $h{constructor(Y,Sa){this.J6i=!1;this.SLk=[];this.rXl=Y;this.Can=Sa}}Object(c.a)($h,"DeckOptionInformation",null,[]);class $k{constructor(){this.Cim=this.Dim=0;this.wdm=[]}get J1h(){return this.Dim}set J1h(Y){this.Dim=Y}get I1h(){return this.Cim}set I1h(Y){this.Cim=Y}get TRd(){return this.wdm}set TRd(Y){this.wdm=Y}Zpm(Y,Sa,Mb){const oc=new N.a;if(Y)for(let Oc=0;Oc<Mb-1&&Oc<Y.length;Oc++)oc.add(new $h(Y[Oc],
!1));Eb.a.wb(Sa)||oc.add(new $h(Sa,!0));this.TRd=oc.toArray()}}Object(c.a)($k,"AgendaDeckSessionInformation",null,[]);class xk{constructor(){this.Tpg=this.Upg=this.mcm=0;this.Plk=this.$Ph=this.Zhk=this.xSh=null}P$n(Y){Y&&(this.mcm=Y.body.slideIndex)}ibo(Y){Y.body&&Y.body.outlineRequestContent&&(this.xSh=JSON.stringify(Y.body.outlineRequestContent))}L$n(Y){Y.body&&(this.Tpg=Y.body.slideCId)}O$n(Y){Y.body&&(this.Upg=Y.body.slideSId)}M$n(Y){this.$Ph=Y.id}gwn(Y){return Y===this.$Ph?(this.$Ph=this.xSh=
null,!0):!1}szn(){return!Eb.a.wb(this.xSh)&&!Eb.a.wb(this.$Ph)}fbo(Y){Y.body&&Y.body.outlineRequestContent&&Y.body.outlineRequestContent.Slides&&(this.Zhk=Y.body.outlineRequestContent.Slides.length)}N$n(Y){this.Plk=Y.body.score}}Object(c.a)(xk,"AgendaDetection",null,[]);var ui=a(1645);class gj{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf){this.jmc=this.P$=null;this.gQh=0;this.X7a=null;this.M0e="";this.aRh=!1;this.W3b=0;this.ivb=new N.a;this.rfm=!1;this.Jm=Y;this.Xb=Sa;this.ya=Mb;this.zc=oc;this.Ea=
Oc;this.As=nd;this.Nf=Zd;this.rb=we;this.k_=Qe;this.doe=kf;this.Jb=Vf;this.k_.zRn(this.Ea)}RCm(){this.Uym();this.v3m();this.jWe()?(this.X7a=new $k,this.X7a.J1h=this.xfa(),this.Rjo()):1!==this.W3b||this.Ea.gSf?2===this.W3b&&this.Ea.fSf&&(this.X7a=new $k,this.X7a.J1h=this.xfa(),this.lko()):this.kko()}v3m(){this.jmc=Yb.a.create().toString();this.k_.H7n(this.jmc);this.k_.RPn()}nul(Y,Sa){if(this.P$){if(!this.P$.Upg||!this.P$.Tpg){var Mb=this.Xb.Uw(this.P$.mcm);this.P$.Upg=Mb.fc.sid;this.P$.Tpg=Mb.fc.cid}Mb=
this.Xb.Uw(0);this.Jm.generateAgendaSuggestion(Mb.fc.cid,Mb.fc.sid,this.jmc,this.P$.xSh,this.kdn(),Y,Sa)}else Sa(null)}kko(){this.nul(Object(h.a)(this,this.WSn,"onPODSTriggerAgendaConversionSuccessV1"),Object(h.a)(this,this.Dmm,"onPODSTriggerAgendaConversionFailureV1"));this.zc.blockContent(this.ya.presentation,"ApplyAgenda",!0,void 0,void 0)}lko(){for(const Y of this.ivb)Y&&Y.Ujo();this.nul(Object(h.a)(this,this.XSn,"onPODSTriggerAgendaConversionSuccessV2"),Object(h.a)(this,this.VSn,"onPODSTriggerAgendaConversionFailureV2"))}Rjo(){this.nul(Object(h.a)(this,
this.YSn,"onPODSTriggerAgendaConversionSuccessV3"),Object(h.a)(this,this.Emm,"onPODSTriggerAgendaConversionFailureV3"));this.zc.blockContent(this.ya.presentation,"ApplyAgenda",!0,void 0,void 0)}bve(Y,Sa){if(Sa.property===jc.a.PAb&&this.gQh){Y=Object(G.a)(568,Sa.node);if(Y.PAb===gj.MFm)for(const Mb of this.ivb)Mb&&Mb.cQn();else if(Y.PAb===gj.NFm){for(const Mb of this.ivb)Mb&&Mb.Pkm();this.aRh=!0}this.doe.rr(Object(h.a)(this,this.bve,"onPresentationPropertyChange"));this.gQh=0}}kdn(){const Y={};this.Ea.fSf&&
2===this.W3b&&(Y.shouldGenerateThemes="true",Y.themeCount="3");this.jWe()&&(Y.shouldNotConvertToGVMLBytes="true",Y.shouldInsertBlankSlides="true");return Oi.c(Y)}gdn(Y){const Sa={};Sa.SlideCount=this.zl().toString();Sa.isBlankThemeRequest=(this.X7a.TRd[Y].Can&&!this.jWe()).toString();Sa.isRequestForDeckDesignerForNonBlankSlides=this.jWe();return Oi.c(Sa)}jWe(){return this.Ea.gSf&&(1===this.W3b||0===this.W3b)}Qjo(){this.rb.nj();const Y=this.ya.presentation;if(Y){const Sa=this.As.xe(15);try{Sa.tc(Y),
Sa.wc=tb.a.UTe,Y.xHb=Object.assign(new ti,{CorrelationId:this.jmc,AgendaSlideSid:this.P$.Upg,AgendaSlideCid:this.P$.Tpg})}finally{Sa&&Sa.dispose()}this.zc.wy(Y,tb.a.UTe);this.zc.BE(Y)}else this.uVh()}SCm(Y){this.rb.nj();this.k_.mXm(this.Agj(Y));const Sa=this.ya.presentation;if(Sa){const Mb=this.As.xe(15);try{Mb.tc(Sa),Mb.wc=tb.a.UTe,Sa.PAb=gj.LFm,this.gQh=this.xfa(),this.doe.Rm(Object(h.a)(this,this.bve,"onPresentationPropertyChange")),Sa.yHb=Object.assign(new Dj,{DeckSuggestionId:this.Agj(Y),AgendaSessionId:this.jmc,
CorrelationId:Yb.a.create().toString()})}finally{Mb&&Mb.dispose()}this.zc.wy(Sa,tb.a.UTe);this.zc.BE(Sa)}else this.uVh()}uVh(){for(const Y of this.ivb)Y&&Y.bQn();this.zc.BE(this.ya.presentation)}WSn(){this.Qjo();this.aRh=!0;for(const Y of this.ivb)Y&&Y.Pkm()}XSn(Y){this.X7a.I1h=this.xfa();const Sa=this.Q2l(),Mb=new N.a;if(Y.Images)for(const oc of Y.Images)Mb.add("data:image/jpg;base64, "+oc);Mb.add(Sa);Eb.a.wb(Y.BlankSuggestionId)&&(Y.BlankSuggestionId=Yb.a.create().toString());this.X7a.Zpm(Y.DeckSuggestionId,
Y.BlankSuggestionId,gj.yGl);for(const oc of this.ivb)oc&&oc.eQn(Mb.toArray());this.rul(0)}YSn(){this.X7a.I1h=this.xfa();this.X7a.Zpm(null,Yb.a.create().toString(),gj.yGl);this.rul(0)}rul(Y){this.jWe()?this.WCm(Y,Object(h.a)(this,this.$Sn,"onPODSTriggerAgendaDeckSuggestionSuccessForNonBlankTheme"),Object(h.a)(this,this.Emm,"onPODSTriggerAgendaConversionFailureV3")):this.WCm(Y,Object(h.a)(this,this.ZSn,"onPODSTriggerAgendaDeckSuggestionSuccess"),Object(h.a)(this,this.Fmm,"onPODSTriggerAgendaDeckSuggestionFailure"))}WCm(Y,
Sa,Mb){if(this.X7a.I1h<this.X7a.J1h)this.RCm();else if(this.k_.KUn(Y),this.M0e=this.Agj(Y),this.Jan(this.X7a.TRd[Y])){var oc=Yb.a.create().toString();this.Jm.generateAgendaDeckSuggestion(this.P$.Tpg,this.P$.Upg,oc,this.jmc,this.M0e,this.gdn(Y),Sa,Mb);H.a.$(512496859,813,50,"AgendaConverterManager::TriggerDifferentThemeWorkflow - CorrelationID: {0}, RequestDeckSuggestionId: {1}",oc,this.M0e)}else this.pkm(this.X7a.TRd[Y].SLk,this.M0e),this.k_.Lkm(Y,!0)}ZSn(Y){if(Y.Images&&Y.Images.length){var Sa=new N.a;
for(var Mb of Y.Images)Sa.add("data:image/jpg;base64, "+Mb);this.pkm(Sa.toArray(),Y.DeckSuggestionId);var oc;if(Mb=(()=>{let Oc=this.w2l(Y.DeckSuggestionId);({themeIndex:oc}=Oc);return Oc})().returnValue)Mb.SLk=Sa.toArray(),Mb.J6i=!0;this.k_.Lkm(oc,!1)}else this.Fmm(Y)}$Sn(Y){Y.Images&&Y.Images.length?this.SCm(0):this.uVh()}pkm(Y,Sa){for(const Mb of this.ivb)Mb&&Sa===this.M0e&&Mb.YPn(Y)}Fmm(Y){try{let Sa;const Mb=(()=>{let oc=this.w2l(Y.DeckSuggestionId);({themeIndex:Sa}=oc);return oc})().returnValue;
Mb&&(Mb.J6i=!1,Mb.SLk=[]);this.k_.XPn(Sa);if(this.M0e!==Y.DeckSuggestionId)return!0}catch(Sa){H.a.$(512496858,813,10,"Exception in OnPODSTriggerAgendaDeckSuggestionFailure: "+Sa.message)}for(const Sa of this.ivb)Sa&&Sa.Okm();return!0}Dmm(){this.uVh();return!0}Emm(Y){return this.Dmm(Y)}VSn(){const Y=this.Q2l(),Sa=new N.a;Sa.add(Y);for(const Mb of this.ivb)Mb&&(Mb.dQn(Sa.toArray()),Mb.Okm());return!0}Q2l(){const Y=this.Xb.Uw(0);return this.Nf.mM(Y.fc).image.src}gra(Y,Sa){try{this.P$||(this.P$=new xk);
let Mb=!1;Sa?this.P$.gwn(Y.id)&&(this.mym(!1,this.W3b),Mb=!0):(this.P$.P$n(Y),this.P$.ibo(Y),this.P$.L$n(Y),this.P$.O$n(Y),this.P$.M$n(Y),this.P$.N$n(Y),this.Uym(),this.P$.szn()&&(this.mym(!0,this.W3b),this.P$.fbo(Y)));if(!(0>=this.ivb.count))for(const oc of this.ivb)try{oc&&(Mb?window.setTimeout(()=>{oc.okm()},100):oc.okm())}catch(Oc){H.a.$(512496857,813,10,"Exception message: "+Oc.message)}}catch(Mb){H.a.$(512496856,813,10,"Exception message: "+Mb.message)}}F4n(Y){Y&&this.ivb.add(Y)}flo(Y){this.ivb.remove(Y)}mym(Y,
Sa){this.rfm=this.Ea.gSf?Y:Y&&0!==Sa}h3l(){return this.rfm&&!this.aRh}gBk(Y){this.aRh=!Y}zl(){return this.ya.presentation.slideCount+this.P$.Zhk}Uym(){this.W3b=this.Gmn();this.k_.J7n(Fj[this.W3b]);this.G7n()}G7n(){this.jWe()?this.k_.h0k("V3"):1!==this.W3b||this.Ea.gSf?2===this.W3b&&this.Ea.fSf&&this.k_.h0k("V2"):this.k_.h0k("V1")}Gmn(){try{const Y=this.Xb.XK();if(Y&&0<Y.length)for(const Sa of Y)if(Sa){const Mb=Sa.ThemeFamilyId;if(this.Ea.fSf&&Mb.toLowerCase()===gj.qGm.toLowerCase())return 2;if(0<=
Array.indexOf(this.Ea.iRl,Mb)||Object(fb.a)("EnableNonEmptyThemeIdFixForAgendaToPPT")&&!this.Jb.getBooleanAppSetting("DisableAgendaToPPTForUnsupportedTheme")&&void 0===ui.a.bpc.find(oc=>oc.cKh===Mb))return 1}return 0}catch(Y){return H.a.$(512496855,813,10,"AgendaConverterManager::IsThemeSupportedForAgendaV1: Exception message: "+Y.message),0}}Agj(Y){return this.X7a.TRd[Y].rXl}w2l(Y){let Sa;Sa=0;for(const Mb of this.X7a.TRd){if(Mb.rXl===Y)return{returnValue:Mb,themeIndex:Sa};Sa++}H.a.$(512496854,813,
10,"AgendaConverterManager::GetDeckOptionInfoWithDeckSuggestionID: cannot find DeckOptionInfo with deckSuggestionId "+Y);return{returnValue:null,themeIndex:Sa}}Jan(Y){return Y?!Y.J6i:(H.a.$(512496853,813,10,"AgendaConverterManager::FShouldQueryFreshPreview: DeckOptionInfo is null "),!1)}dispose(){this.doe.rr(Object(h.a)(this,this.bve,"onPresentationPropertyChange"));this.gQh=0}xfa(){return(new Date).getTime()}}gj.yGl=4;gj.qGm="62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F";gj.NFm=1;gj.MFm=2;gj.LFm=0;Object(c.a)(gj,
"AgendaConverterManager",null,[40]);class Kj{constructor(Y,Sa,Mb){this.k_=Y;this.Fd=Sa;this.XCa=Mb;this.Oz()}Oz(){this.Fd.Jxf(Object(h.a)(this,this.Iac,"onUndoRedo"))}dispose(){this.Fd.qch(Object(h.a)(this,this.Iac,"onUndoRedo"))}n$f(Y,Sa){Y===tb.a.UTe&&(this.k_.gBk(Sa),this.XCa.gBk(Sa))}Iac(Y,Sa){this.n$f(Sa.T1h,Sa.Jgb)}}Object(c.a)(Kj,"AgendaConverterUndoRedoController",null,[779]);class Sk{constructor(){this.isEntryState=!1;this.pptAppFrameDomElement=null;this.maxTryAgainCount=0}}Object(c.a)(Sk,
"IAgendaSettings",null,[]);class tj{constructor(Y,Sa,Mb,oc,Oc){this.XSl="HighConfidenceAgendaDetected";this.I5=null;this.xa=new Zb.a;this.ZPh=null;this.XTh=0;this.na=Mb;this.Xr=Sa;this.Na=Oc;this.I5||(Sa=new Sk,Sa.isEntryState=!0,Sa.pptAppFrameDomElement=this.Xr.gN(),Sa.maxTryAgainCount=this.na.Jvi,this.I5=agendaConverter.AgendaConverterFactory.CREATE_AGENDA_CONVERTER_ACTOR(Sa));this.yho();this.XCa=Y;this.na&&this.na.eSf&&this.XCa.F4n(this);this.k_=oc;this.Ode=!1}okm(){this.XCa&&(this.XCa.h3l()?(this.k_.F7n(this.XCa.P$.Plk),
this.yzm(this.ZPh),1===this.XCa.P$.Plk&&this.xa.raiseEvent(this.XSl,null)):this.IEj())}Ujo(){this.I5&&(this.k_.ZPn(),this.I5.showAgendaToPptDialog(this.XCa.zl()),this.Na.lYe(fc.a.Ivi,fc.a.Wl,document.getElementById("AgendaToPptDialogHostElement"),!0),this.Na.Gm(fc.a.Ivi,!0),this.Ode=!0)}Pkm(){this.IEj();this.k_.aQn();window.setTimeout(()=>{this.$jo()},8E3)}eQn(Y){this.lAm(Y);this.k_.Mkm(!0)}dQn(Y){this.lAm(Y);this.k_.Mkm(!1)}YPn(Y){this.$eo(Y)}bQn(){this.XTh>=this.na.Jvi?this.I5.showAgendaToPptDismissCard():
(this.XTh+=1,this.I5.showAgendaToPptFailureCard());this.k_.wmm()}Okm(){this.I5&&this.Ode&&this.I5.showSlidePreviewError()}cQn(){this.I5.showMergeSlidesError();this.k_.wmm()}yzm(Y){this.na.eSf&&(this.U8k(Y),this.I5&&this.ZPh&&this.XCa&&this.XCa.h3l()&&(this.I5.showAgendaCard(this.ZPh,this.XCa.P$.Zhk),this.k_.WPn()))}IEj(){H.a.$(507843726,829,100,"AgendaConverterView::HideAgendaEntryCard");this.I5&&!this.Ode&&(this.I5.hideAgendaCard(),this.U8k(null))}lAm(Y){this.I5&&this.Ode&&this.I5.populateThemesInAgendaDialog(Y)}$eo(Y){this.I5&&
this.Ode&&this.I5.populatePreviewSlidesInAgendaDialog(Y)}U8k(Y){this.ZPh=Y}$jo(){if(this.na.kqm)try{const Y=vb.a.instance.eb("Common.ISystemInitiatedFeedback");Y&&(H.a.$(507843725,813,50,"AgendaConverterView::TriggerFpsForAgendaToPpt Floodgate survey for agenda to presentation triggered"),Y.execute(Sa=>{Sa.logActivity("AgendaToPresentationActivity","PowerPointAgendaToPptSurveyEnabled")}))}catch(Y){H.a.$(507843724,813,10,"Exception thrown while triggering floodgate survey. Exception: {0}",Y)}}yho(){this.I5.on(tj.OFm,
()=>{this.qWm()});this.I5.on(tj.RFm,()=>{this.tWm()});this.I5.on(tj.PFm,()=>{this.rWm()});this.I5.on(tj.QFm,()=>{this.sWm()});this.I5.on(tj.VFm,Y=>{this.pWm(Y)});this.I5.on(tj.SFm,Y=>{this.hRl(Y,!1)});this.I5.on(tj.TFm,()=>{this.uWm()});this.I5.on(tj.UFm,Y=>{this.hRl(Y,!0)})}qWm(){this.uBm()}tWm(){this.k_.LUn();this.uBm()}rWm(){this.gRl();this.k_.flm()}sWm(){this.gRl();this.k_.wRn()}gRl(){this.cleanup();this.XCa.flo(this)}uBm(){this.XCa.RCm()}pWm(Y){this.XCa.rul(Y)}hRl(Y,Sa){this.k_.$Pn(Y,Sa);this.Ode=
!1;this.I5.hideAgendaToPptDialog();this.XCa.SCm(Y)}uWm(){this.Ode=!1;this.I5.hideAgendaToPptDialog();this.k_.flm()}cleanup(){this.U8k(null);this.XTh=0;this.I5.cleanup()}jVm(Y){this.xa.addHandler(this.XSl,Y)}}tj.OFm="AgendaCardAddSlides";tj.RFm="AgendaCardTryAgain";tj.PFm="AgendaCardCancel";tj.QFm="AgendaCardDismiss";tj.VFm="AgendaToPptDialogThemeSuggestionSelected";tj.SFm="AgendaToPptDialogApply";tj.TFm="AgendaToPptDialogCancel";tj.UFm="AgendaToPptDialogMergeTryAgain";Object(c.a)(tj,"AgendaConverterView",
null,[780,798]);var gk=a(840);class Gk{constructor(){this.LFg={}}q0h(Y){this.LFg[Y]=new gk.a(Y,!0)}M6e(Y){if(Y in this.LFg){var Sa=this.LFg[Y];Sa.stop();Sa=Sa.PTd;delete this.LFg[Y];return Sa}return-1}eCk(Y){return Y in this.LFg}}Object(c.a)(Gk,"AgendaPerfLogger",null,[]);class cj{constructor(){this.EOh=this.d9l=this.f9l=this.e9l=!1}tCn(){this.EOh&&!this.e9l&&(this.e9l=!0,Aa.b(cj.RZm))}QCn(){this.EOh&&!this.f9l&&(this.f9l=!0,Aa.b(cj.SZm))}$Bn(){this.EOh&&!this.d9l&&(this.d9l=!0,Aa.b(cj.QZm))}static IBn(Y){Y&&
Y.isCreateNew&&Aa.b(cj.PZm)}}cj.RZm="WAC_Exp_AgendaToPPTHighConfidenceSeen";cj.SZm="WAC_Exp_AgendaToPPTHighConfidenceTried";cj.QZm="WAC_Exp_AgendaToPPTHighConfidenceKept";cj.PZm="WAC_Exp_AgendaToPPTIsCreateNew";Object(c.a)(cj,"ExperimentationMetrics",null,[]);class Hk{constructor(){this.vbk=this.Jak=this.Q9j=this.jmc=null;this.bck=!1;this.Vdm=this.lcm=this.tim=this.Ea=null;this.Snk="";this.cck=!1;this.P9j=""}reset(){this.tim={};this.lcm=new Gk;this.Vdm=new cj;this.Snk="";this.cck=!1;this.P9j="";this.vbk=
this.Jak=this.Q9j=this.jmc=null;this.bck=!1}get telemetryData(){return this.tim}get RJh(){return this.Vdm}get Wmb(){return this.lcm}get Pd(){return this.Ea}set Pd(Y){this.Ea=Y}get R0h(){return this.Snk}set R0h(Y){this.Snk=Y}get Hkd(){return this.cck}set Hkd(Y){this.cck=Y}get UHa(){return this.P9j}set UHa(Y){this.P9j=Y}get oXa(){return this.jmc}set oXa(Y){this.jmc=Y}get Qma(){return this.Q9j}set Qma(Y){this.Q9j=Y}get gNa(){return this.Jak}set gNa(Y){this.Jak=Y}get documentOpenType(){return this.vbk}set documentOpenType(Y){this.vbk=
Y}get eeg(){return this.bck}set eeg(Y){this.bck=Y}}Object(c.a)(Hk,"AgendaMetricsState",null,[]);var Hl=a(1188);class pj{constructor(Y,Sa){if(!Y)throw Error.argumentNull("AgendaThemetype is null");if(!Sa)throw Error.argumentNull("AgendaToPptFlowVersion is null");this.pmc=new Hl.a;this.pmc.Qeb(Object.assign(new x.a,{name:"AgendaThemeType",string:Y}));this.pmc.Qeb(Object.assign(new x.a,{name:"AgendaFlowVersion",string:Sa}))}tib(Y){Eb.a.wb(Y)||this.pmc.Qeb(Object.assign(new x.a,{name:"AgendaSessionId",
string:Y}));return this}qZh(Y){this.pmc.Qeb(Object.assign(new x.a,{name:"AgendaThemeIndexSelected",int64:Y}));return this}KGe(Y){Eb.a.wb(Y)||this.pmc.Qeb(Object.assign(new x.a,{name:"AgendaCardState",string:Y}));return this}Z9c(Y){Eb.a.wb(Y)||this.pmc.Qeb(Object.assign(new x.a,{name:"AgendaDialogState",string:Y}));return this}Bsd(Y){Eb.a.wb(Y)||this.pmc.Qeb(Object.assign(new x.a,{name:"AgendaButtonClickedType",string:Y}));return this}WZh(Y){Eb.a.wb(Y)||this.pmc.Qeb(Object.assign(new x.a,{name:"AgendaSeenTriedKept",
string:Y}));return this}tcb(Y){Eb.a.wb(Y)||this.pmc.Qeb(Object.assign(new x.a,{name:"DocumentOpenType",string:Y}));return this}build(){return this.pmc.dataFields}}Object(c.a)(pj,"AgendaToPptActivityDataPointBuilder",null,[]);class kj{constructor(){this.Ig=null;this.wpd=new gk.a("AgendaToPpt",!1);this.oel()}oel(){this.Ig=new Hk;this.Ig.reset();this.Ig.telemetryData.Flights="";n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",
!1)&&(this.Ig.telemetryData.Flights+="AugloopAgendaTASClassifierModelIsEnabled;");this.Ig.telemetryData.InitialUserThemeType=this.Ig.UHa}zRn(Y){Y&&(this.Ig.Pd=Y,this.Ig.documentOpenType=kj.ygn(Y),cj.IBn(this.Ig.Pd),this.Ig.telemetryData.IsDocumentOpenTypeCreateNew=this.Ig.Pd.isCreateNew.toString())}Nkm(Y,Sa){if(this.Ig.Wmb.eCk("AgendaToPptDialogThemeApply")&&"V2"===this.Ig.Qma){var Mb=this.Ig.Wmb.M6e("AgendaToPptDialogThemeApply");this.Ig.telemetryData.TotalTimeTakenToMerge=Mb.toString();Aa.a(kj.xXa,
Y,Mb,Sa)}else this.Ig.Wmb.eCk("OnAddSlidesClicked")?(Mb=this.Ig.Wmb.M6e("OnAddSlidesClicked"),this.Ig.telemetryData.TotalTimeTakenToMerge=Mb.toString(),Aa.a(kj.xXa,Y,Mb,Sa)):this.Ig.Wmb.eCk("OnTryAgainClicked")&&(Mb=this.Ig.Wmb.M6e("OnTryAgainClicked"),this.Ig.telemetryData.TotalTimeTakenToMerge=Mb.toString(),Aa.a(kj.xXa,Y,Mb,Sa));this.Ig.eeg=!1}WPn(){this.Ig.eeg=!1;if(!("Seen"in this.Ig.telemetryData)){this.Ixa("OnAgendaCardShown");this.wpd.start();this.Ig.telemetryData.Seen="true";H.a.$(508692634,
813,50,"AgendaCard shown");const Y=(new pj(this.Ig.UHa,this.Ig.Qma)).KGe("AgendaCardShown").WZh("Seen").tcb(this.Ig.documentOpenType).build();Aa.a(kj.xXa,!0,0,Y);this.Ig.RJh.tCn()}}RPn(){this.Ig.eeg?this.RCn():this.sBn()}sBn(){this.Ixa("OnAddSlidesClicked");this.wpd.stop();this.Ig.telemetryData.Tried="true";this.Ig.Wmb.q0h("OnAddSlidesClicked");H.a.$(508692633,813,50,"AgendaCard tried in MS:{0}",this.wpd.PTd);const Y=(new pj(this.Ig.UHa,this.Ig.Qma)).tib(this.Ig.oXa).KGe("AgendaCardShown").Bsd("AddSlides").WZh("Tried").tcb(this.Ig.documentOpenType).build();
Aa.a(kj.xXa,!0,this.wpd.PTd,Y);this.Ig.RJh.QCn()}aQn(){this.Ixa("OnAgendaToPPTApply");this.Ig.Hkd=!0;this.Ig.telemetryData.Kept="true";this.Ig.telemetryData.Event="AgendaCompleted";const Y=(new pj(this.Ig.UHa,this.Ig.Qma)).tib(this.Ig.oXa).KGe("AgendaCompleted").tcb(this.Ig.documentOpenType).build();this.Nkm(!0,Y);H.a.$(508692632,813,50,"AgendaToPPT Completed successfully")}LUn(){this.Ig.eeg=!0;this.Ixa("OnTryAgainClicked");this.Ig.telemetryData.Tried="true";this.Ig.telemetryData.Event="AgendaTryAgain";
this.Ig.Wmb.q0h("OnTryAgainClicked");H.a.$(508692631,813,50,"AgendaCard retry attempt")}RCn(){const Y=(new pj(this.Ig.UHa,this.Ig.Qma)).tib(this.Ig.oXa).KGe("AgendaMergeError").Bsd("TryAgain").WZh("Tried").tcb(this.Ig.documentOpenType).build();Aa.a(kj.xXa,!0,0,Y)}ZPn(){this.Ixa("OnAgendaDialogShown");this.Ig.gNa="Loading";H.a.$(508692630,813,50,"AgendaDialog shown");const Y=(new pj(this.Ig.UHa,this.Ig.Qma)).tib(this.Ig.oXa).Z9c(this.Ig.gNa).tcb(this.Ig.documentOpenType).build();Aa.a(kj.xXa,!0,0,Y)}Mkm(Y){this.Ixa("OnAgendaThemePaneLoadedSuccess");
this.Ig.gNa=Y?"ThemeSuggestions":"ThemeSuggestionsFailure";Y=this.Ig.Wmb.M6e("OnAddSlidesClicked");this.Ig.telemetryData.ThemePaneLoadingTime=Y.toString();const Sa=(new pj(this.Ig.UHa,this.Ig.Qma)).tib(this.Ig.oXa).Z9c(this.Ig.gNa).tcb(this.Ig.documentOpenType).build();Aa.a(kj.xXa,!0,Y,Sa)}mXm(Y){this.Ixa("ThemeDeckSuggestionId");this.Ig.telemetryData.SelectedDeckSuggestionId=Y}KUn(Y){"V2"===this.Ig.Qma&&(this.Ixa("OnTriggerDifferentThemeWorkflow"),this.Ig.gNa="ThemeSuggestions",this.Ig.Wmb.q0h("TriggerDeckLevelDesigner_"+
Y),Y=(new pj(this.Ig.UHa,this.Ig.Qma)).tib(this.Ig.oXa).Z9c(this.Ig.gNa).qZh(Y).Bsd("ThemeSelected").tcb(this.Ig.documentOpenType).build(),Aa.a(kj.xXa,!0,0,Y))}Lkm(Y,Sa){this.Ixa("OnAgendaDeckPreviewLoaded");this.Ig.gNa=Sa?"AgendaDeckPreviewLoadedFromCache":"AgendaDeckPreviewLoaded";Sa=this.Ig.Wmb.M6e("TriggerDeckLevelDesigner_"+Y);this.Ig.telemetryData["DeckPreviewLoadTime_"+Y]=Sa.toString();Y=(new pj(this.Ig.UHa,this.Ig.Qma)).tib(this.Ig.oXa).Z9c(this.Ig.gNa).qZh(Y).tcb(this.Ig.documentOpenType).build();
Aa.a(kj.xXa,!0,Sa,Y)}XPn(Y){const Sa=this.Ig.Wmb.M6e("TriggerDeckLevelDesigner_"+Y);this.Ixa("OnAgendaDeckPreviewError");this.Ig.gNa="AgendaDeckPreviewError";let Mb="";"DeckPreviewFailure"in this.Ig.telemetryData&&(Mb=this.Ig.telemetryData.DeckPreviewFailure.toString());this.Ig.telemetryData.DeckPreviewFailure=Mb+Y.toString()+";";Y=(new pj(this.Ig.UHa,this.Ig.Qma)).tib(this.Ig.oXa).Z9c(this.Ig.gNa).qZh(Y).tcb(this.Ig.documentOpenType).build();Aa.a(kj.xXa,!1,Sa,Y)}$Pn(Y,Sa){this.Ixa("OnAgendaDialogThemeApply");
this.Ig.gNa=Sa?"AgendaDeckMergeError":this.Ig.gNa;this.Ig.Wmb.q0h("AgendaToPptDialogThemeApply");Y=(new pj(this.Ig.UHa,this.Ig.Qma)).tib(this.Ig.oXa).qZh(Y).Z9c(this.Ig.gNa).Bsd(Sa?"TryAgain":"Apply").tcb(this.Ig.documentOpenType).build();Aa.a(kj.xXa,!0,0,Y)}flm(){this.Ixa("OnCancelClicked");this.Ig.Hkd=!0;this.Ig.telemetryData.Kept="false";this.Ig.telemetryData.Event="AgendaCancelled";H.a.$(508692629,813,50,"AgendaToPPT clicked Cancel button");const Y=(new pj(this.Ig.UHa,this.Ig.Qma)).tib(this.Ig.oXa).Bsd("Cancel").tcb(this.Ig.documentOpenType);
"V2"===this.Ig.Qma?Y.Z9c(this.Ig.gNa):Y.KGe("AgendaMergeError");Aa.a(kj.xXa,!0,0,Y.build())}wRn(){this.Ixa("OnDismissClicked");this.Ig.Hkd=!0;this.Ig.telemetryData.Kept="false";this.Ig.telemetryData.Event="AgendaDismissed";H.a.$(508692628,813,50,"AgendaToPPT clicked Dismiss button");const Y=(new pj(this.Ig.UHa,this.Ig.Qma)).tib(this.Ig.oXa).Bsd("Dismiss").tcb(this.Ig.documentOpenType);"V2"===this.Ig.Qma?Y.Z9c(this.Ig.gNa):Y.KGe("AgendaMergeError");Aa.a(kj.xXa,!0,0,Y.build())}wmm(){this.Ixa("OnMergingErrorInAgenda");
this.Ig.Hkd=!0;this.Ig.telemetryData.Kept="false";this.Ig.telemetryData.Event="AgendaError";const Y=(new pj(this.Ig.UHa,this.Ig.Qma)).tib(this.Ig.oXa).tcb(this.Ig.documentOpenType);"V2"===this.Ig.Qma?(this.Ig.gNa="AgendaMergeError",Y.Z9c("AgendaMergeError")):Y.KGe("AgendaMergeError");this.Nkm(!1,Y.build())}gBk(Y){let Sa=!1;this.Ixa("OnUndoRedoClicked");let Mb=(new pj(this.Ig.UHa,this.Ig.Qma)).tib(this.Ig.oXa).tcb(this.Ig.documentOpenType);if("Kept"in this.Ig.telemetryData){this.Ig.telemetryData.Kept=
(!Y).toString();const oc=Y?"UndoClicked":"RedoClicked";this.Ig.telemetryData.Event=oc;Mb=Mb.Bsd(oc)}else Sa=!0,Mb.Bsd("UndoRedoPostAgendaKept");Aa.a(kj.xXa,!0,0,Mb.build());H.a.$(508692627,813,50,"AgendaToPPT did UndoRedo: {0} and IsError:{1}",(!Y).toString(),Sa.toString())}H7n(Y){this.Ixa("ReportCorrelationID");this.Ig.telemetryData.CorrelationId=Y;this.Ig.oXa=Y}J7n(Y){this.Ixa("ReportInitialUserThemeType");this.Ig.telemetryData.InitialUserThemeType=Y;this.Ig.UHa=Y}h0k(Y){this.Ixa("ReportAgendaToPptFlowVersion");
this.Ig.telemetryData.AgendaToPptFlowVersion=Y;this.Ig.Qma=Y}F7n(Y){this.Ixa("ReportAgendaScore");this.Ig.telemetryData.AgendaScore=Y.toString();1===Y&&this.I7n()}I7n(){this.Ixa("ReportHighConfidenceAgendaDetected");this.Ig.telemetryData.HighConfidenceAgendaDetected="true";this.Ig.RJh.EOh=!0}dispose(){H.a.$(508692626,813,50,"AgendaToPPTMetrics: {0}",Oi.c(this.Ig.telemetryData))}L7n(){if(!this.Ig.telemetryData||!Fc.a.count(this.Ig.telemetryData))return"";const Y=Oi.c(this.Ig.telemetryData);if(this.Ig.R0h===
Y)return"";this.Ig.R0h=Y;if("Kept"in this.Ig.telemetryData){const Sa=(new pj(this.Ig.UHa,this.Ig.Qma)).tib(this.Ig.oXa).WZh("Kept").tcb(this.Ig.documentOpenType).build(),Mb=Boolean.parse(this.Ig.telemetryData.Kept.toString());Aa.a(kj.xXa,Mb,0,Sa);Mb&&this.Ig.RJh.$Bn()}this.Ig.Hkd&&(this.oel(),this.Ig.Hkd=!1);H.a.$(508692625,813,50,"AgendaToPPTMetrics: {0}; isFinalTelemetryData: {1}",this.Ig.R0h,this.Ig.Hkd.toString());return Y}Ixa(Y){this.Ig.telemetryData||(H.a.$(508692624,813,15,"AgendaMetrics::ValidateTelemetryData null  for method :{0}",
Y),this.oel())}static ygn(Y){return Y.isCreateNew?"NewDocument":Y.v7a?"ViewOnlyDocument":"EditDocument"}}kj.xXa="AgendaToPptEvents";Object(c.a)(kj,"AgendaMetrics",null,[778]);class Ti{constructor(){this.Ea=this.ga=null;this.Xgm=!0;this.kcm="AugLoop_AgendaDetection_AgendaDetectionAnnotation";this.XCa=null}get name(){return"PowerPointWebEditor.AgendaConverter"}oc(Y){this.ga=Y;this.ga.register(778,"PowerPointWebEditor.IAgendaMetrics").oa().pa(()=>new kj);this.ga.register(gj,"PowerPointWebEditor.AgendaConverter.AgendaConverterManager").oa().pa(()=>
new gj(this.ga.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),
this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.IAgendaMetrics"),this.ga.resolve("Box4.Graph.IGraphInstance").Xd(7),this.ga.resolve("Common.IAppSettingsManager")));this.ga.register(779,"PowerPointWebEditor.IAgendaConverterUndoRedoController").oa().pa(()=>new Kj(this.ga.resolve("PowerPointWebEditor.IAgendaMetrics"),this.ga.resolve("PowerPointWebEditor.View.IViewEventSource"),this.ga.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager")));
this.ga.resolve("PowerPointWebEditor.IAgendaConverterUndoRedoController");const Sa=mk.a(this.ga);fb.a("AgendaToPPT.DisableLocalizedStrings")?Sa("agendaConverter").then(()=>{this.ga.register(780,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").oa().pa(()=>new tj(this.ga.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.IAgendaMetrics"),
this.ga.resolve("PowerPointWebEditor.IFocusManager")));this.ga.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>{}):Sa("powerpoint-agenda-to-ppt-strings").then(()=>{Sa("agendaConverter").then(()=>{this.ga.register(780,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").oa().pa(()=>new tj(this.ga.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),
this.ga.resolve("PowerPointWebEditor.IAgendaMetrics"),this.ga.resolve("PowerPointWebEditor.IFocusManager")));this.ga.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>{})}).catch(()=>{})}init(){this.ga.resolve("Common.IAppSettingsManager").Wf(Object(h.a)(this,this.E4n,"registerAgendaDetectionEventHandler"))}dispose(){}E4n(){this.Ea=this.ga.resolve("PowerPointWebEditor.IApplicationSettings");this.XCa=this.ga.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager");
const Y=this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.Ea.yZl&&this.Xgm&&2===Y.mode&&(this.ga.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Sa=>{Sa.v2(this.kcm);Sa.gtm(this.kcm,Object(h.a)(this.XCa,this.XCa.gra,"handleAnnotationEvent"))}),this.Xgm=!1)}static main(){b.a.instance.Jc(new Ti)}}Object(c.a)(Ti,"AgendaConverterPackage",null,[4,5]);var dm=a(1105);class hk{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf){this.HRc=0;this.la=Y;this.Gb=Sa;this.na=Mb;
this.Na=oc;this.mf=Oc;this.sa=nd;this.Mq=Cd;this.N_=Zd;this.UG=we;this.OF=Qe;this.Omc=kf}Kb(){this.WSm();this.na.yrm&&this.X_l()&&this.Omc.continueWith(()=>{this.Omc.result.logActivity("HasPresentInTeamsSeen","PresentToTeamsTeachingUIEnabled")})}WSm(){this.la.ua(tb.a.Fnc,Ta.a.application,Object(h.a)(this,this.Fnc,"presentToTeams"),4);this.la.ua(tb.a.G3e,Ta.a.application,Object(h.a)(this,this.Fnc,"presentToTeams"),4);this.la.ua(tb.a.gXh,Ta.a.application,Object(h.a)(this,this.Fnc,"presentToTeams"),
4)}Fwm(){this.UG.hide();this.s9i()}s9i(){let Y;zi.a.XNe();Y=this.sVn();this.showDialog();return Y}sVn(){this.OF.Slc=!0;const Y=Yb.a.create().toString(),Sa=this.mf.documentUrl;try{const oc={};oc.pptSharingUrl=dm.b(Sa);const Oc=encodeURIComponent(de.c(oc));let nd=String.format("msteams:/l/present?ver={0}&deeplinkId={1}&pptContext={2}","1",Y,Oc);if(!Eb.a.wb(null)){const Cd=td.a.VK(null);nd=nd+"&fqdn="+Cd;const Zd=encodeURIComponent(de.c({joinUrl:null}));nd=nd+"&meetingContext="+Zd}var Mb=nd;e.ULS.sendTraceTag(556541766,
838,50,"actionId: {0}, deepLinkId: {1}",this.HRc,Y);window.open(Mb,"_top")}catch(oc){return e.ULS.sendTraceTag(508692483,838,15,"PresentToTeamsActor: failed with error: {0}",oc),!1}return!0}showDialog(){const Y=new za.a;Y.Ue=4;Y.vg(1,ResourceStrings.l_PresentToTeamsResumeInPowerPoint);Y.vg(2,ResourceStrings.l_PresentToTeamsTryAgainInTeams);Y.GC(ResourceStrings.l_PresentingFileInTeamsTitle,ResourceStrings.l_PresentingFileInTeamsMessage,0,Object(h.a)(this,this.Jcc,"protocolLaunchingDialogResultHandler"))}Jcc(Y){1===
Y||0===Y?(e.ULS.sendTraceTag(508692482,838,50,"PresentToTeamsActor - restarting PPT session"),this.Qbb()):2===Y&&(e.ULS.sendTraceTag(508692481,838,50,"PresentToTeamsActor - retry present to teams"),this.la.Eb(tb.a.gXh,2))}Qbb(){this.la.Ra(tb.a.refresh,2,{refreshtrigger:"PresentToTeamsActor::RestartApplication"})}X_l(){return!!this.mf.documentUrl}Fnc(Y,Sa,Mb){if(!this.X_l())return e.ULS.sendTraceTag(508692480,838,10,"PresentToTeamsActor: Document not supported"),8;if(1===Mb)return 32;this.HRc=Y;if(this.Mq.isPaused)return this.Na.ee(),
this.s9i()?32:8;this.sa.nj();this.Na.ee();if(Y===tb.a.gXh||1===this.Gb.mode)return this.s9i()?32:8;this.N_.jOa(!0,!0,!0,()=>{this.Fwm()},()=>{e.ULS.sendTraceTag(508692451,838,15,"PresentToTeamsActor: ForceSave failed");this.Fwm();return!0});this.UG.show(!1,this.HRc);return 32}q1(){}p1(){}}Object(c.a)(hk,"PresentToTeamsActor",null,[90]);class Ui{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.PresentToTeams"}oc(Y){this.ga=Y}init(){n.AFrameworkApplication.ha.Wf(()=>{(new hk(this.ga.resolve("Common.IActionManagerExtended"),
this.ga.resolve("Box4.IAppFrame"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("PowerPoint.IPathManager"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("Box4.IReplicationScheduler"),this.ga.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),this.ga.resolve("PowerPointWebEditor.ISaveBlockingUI"),this.ga.resolve("PowerPointWebEditor.IApplicationContext"),lf.a.kH(vb.a.instance.eb("Common.ISystemInitiatedFeedback")))).Kb()})}dispose(){}static main(){b.a.instance.Jc(new Ui)}}
Object(c.a)(Ui,"PPTWebEditorPresentToTeamsPackage",null,[4,5]);var Lj=a(1570),qj=a(28);class Ik{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.CorrelationId=null;this.SuggestionSid=this.SuggestionCid=0}}Object(c.a)(Ik,"DesignerSuggestionApplyInfo",null,[]);var Mj=a(769),Il=a(828),fl=a(141);class em{constructor(){this.wGh=null}}Object(c.a)(em,"IdeasSlideSuggestionWrapper",null,[]);var Lk=a(117);class gl{constructor(){this.trigger=null;this.cid=this.sid=0;this.jra=null;this.timestamp=
new Date;this.correlationId=Yb.a.create().toString()}}Object(c.a)(gl,"DesignerRequestData",null,[]);var Ll=a(197);class Xl{}Object(c.a)(Xl,"SlideSuggestionData",null,[]);class tf{}tf.SIn="mivTitle";tf.RIn="mivSubtitle";tf.CUh="mivContainer";tf.QIn="mivButtonsContainer";tf.yjm="mivButton";tf.PIn="mivButtonImage";tf.i1e="mivOverlayContainer";tf.vsk="mivIcon";tf.j1e="mivTerm";tf.Ajm="mivFrame";tf.TIn="mivView";tf.Bjm="mivIdx";tf.xsk="mivKeepFocusStart";tf.wsk="mivKeepFocusEnd";tf.kZl="Editor";tf.$1i=
"EditorContainer";tf.F9m="EditorTitle";tf.C9m="EditorSubtitleContainer";tf.mZl="EditorSubtitle";tf.r9m="EditorBucketContainer";tf.ZTd="EditorPrev";tf.WRf="EditorPrevDisabled";tf.UVe="EditorPrevEnabled";tf.Z1i="EditorBucketCurrent";tf.s9m="EditorBucketTotalCount";tf.cZl="EditorBucketTotal";tf.SVe="EditorNext";tf.TVe="EditorNextEnabled";tf.VRf="EditorNextDisabled";tf.v9m="EditorDescription";tf.y9m="EditorIgnoreContainer";tf.TRf="EditorIgnore";tf.B9m="EditorSeeMoreContainer";tf.YRf="EditorSeeMoreLabel";
tf.dZl="EditorCardContent";tf.pZl="EditorSuggestionsContainer";tf.okd="EditorSuggestionContainer";tf.xJh="EditorSuggestionArrow";tf.D9m="EditorSuggestionCheck";tf.oZl="EditorSuggestionText";tf.nZl="EditorSuggestionInstances";tf.z9m="EditorNoMoreContainer";tf.E9m="EditorSvgCheck";tf.H9m="EditorWhiteCheck";tf.x9m="EditorGreenFill";tf.w9m="EditorGreenBorder";tf.A9m="EditorNoMoreLabel";Object(c.a)(tf,"IdeasCss",null,[]);class Df{}Df.tbg="IdeasPane";Df.nkd="editorSuggestionIdx";Df.ifa="ClosePane";Df.Ctn=
"IdeasPaneOpen";Df.DUg=6;Df.nIn=3;Df.vXl="Architecture Backgrounds Cities Nature People Technology".split(" ");Object(c.a)(Df,"IdeasPaneConstants",null,[]);var og=a(617),zj=a(202),kg=a(246);class Te{constructor(Y,Sa,Mb,oc,Oc,nd,Cd){this.Pxg=null;this.ya=Y;this.rc=Sa;this.na=Mb;this.Rd=oc;this.aTh=(Y=this.na.xpc)?"DesignerSuggestionResultWide":"DesignerSuggestionResult";this.bTh=Y?"DesignerSuggestionResultSelectedWide":"DesignerSuggestionResultSelected";this.Yb=Oc;this.mf=nd;this.a_e=Cd}pWn(Y){const Sa=
[];try{if(!Y||!Y.SlideSuggestions)return H.a.$(510248778,829,50,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - no slide suggestions to parse"),Sa;for(let Mb=0;Mb<Y.SlideSuggestions.length;Mb++){if(!Y.SlideSuggestions[Mb])continue;const oc=Y.SlideSuggestions[Mb].Base64Img;let Oc=null;try{Oc=Object.assign(new Xl,{suggestionIndex:Y.SlideSuggestions[Mb].Index.toString(),suggestionCid:Y.SlideSuggestions[Mb].SlideId.Cid.toString(),suggestionSid:Y.SlideSuggestions[Mb].SlideId.Sid.toString(),imageData:oc.startsWith("data:image")?
oc:"data:image/png;base64,"+oc,label:String.format(ResourceStrings.l_DesignerSuggestionItem,Mb+1)})}catch(nd){H.a.$(510248777,829,15,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions by SlideId"),Oc=null}Oc||(Oc=Object.assign(new Xl,{suggestionIndex:Y.SlideSuggestions[Mb].Index.toString(),suggestionSid:Y.SlideSuggestions[Mb].SlideSid.toString(),imageData:oc.startsWith("data:image")?oc:"data:image/png;base64,"+oc,label:String.format(ResourceStrings.l_DesignerSuggestionItem,
Mb+1)}));Array.add(Sa,Oc)}}catch(Mb){H.a.$(510248776,829,10,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions. {0}",Mb)}return Sa}mgn(Y,Sa,Mb){if(!Y)throw Error.argumentNull("suggestionsContainer");return Y.querySelector("#"+Sa+" ."+Te.oAc+'[correlationId="'+Mb+'"]')}Ytj(){return this.na.RXl?this.na.QXl:this.na.PXl}wNh(Y){if(!this.na.MXa)return!1;let Sa=!0;switch(Y){case og.a.moreIdeas:Sa=!1;break;case og.a.bZa:Sa=!1}return Sa}y_k(Y){H.a.$(510248775,
829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, FirstRender:{1}",this.Rd.correlationId,Y.nWd);if(Y.wVe&&Y.QJh&&Y.DLb){var Sa=this.PMj(),Mb=Y.DLb.parentNode.parentNode.id;if(Y.Nkl&&this.na.mEc&&Y.nWd)switch(Y.wVe.DocumentUpsellStatus){case 0:this.zUm(Y.DLb);break;case 1:this.ITm(Y.DLb);break;case 2:this.zTm(Y.DLb)}Y.nWd&&this.na.eSf&&this.Yum(Y.DLb);var oc=Y.nWd?this.$3m(Y.QJh,Y.ni,Y.DLb,Sa,Y.o2h):this.mgn(Y.DLb,Mb,Y.ni);if(oc)try{const nd=this.Rd.gjd,Cd=!Rb.a.wb(nd)&&Mb===Df.tbg,
Zd=this.EZm(Y.wVe,Cd,nd);if(Y.nWd){this.Rd.Bsl=new Date;Y.o2h&&this.Ego(Y.ean);for(var Oc=0;Oc<oc.childNodes.length;Oc++){const we=oc.childNodes[Oc];Y.o2h&&this.zdo(Zd,Oc)?Te.Deo(Sa,Oc,we):this.WZk(Cd?nd[Oc].Type:0,Y.DLb,we,Mb,Y.QJh,Zd[Oc.toString()],Oc,Y.Nkl,Y.wVe.DocumentUpsellStatus)}this.na.fIb&&Y.wVe.HasPaginationInfo&&this.Zzm(Y.DLb,Y.ni)}else if(Y.o2h){H.a.$(510248774,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, Incremental Render. suggestionDataDict Count:{1}",this.Rd.correlationId,
Fc.a.count(Zd));for(Oc of Object.keys(Zd)){const we=parseInt(Oc),Qe=Y.DLb.querySelector("#"+Mb+" ["+Te.uAc+'="'+we+'"]');Zd[Oc]&&Qe&&Sys.UI.DomElement.containsCssClass(Qe.firstChild,"IncSuggestionPlaceholder")&&this.WZk(Cd?nd[we].Type:0,Y.DLb,Qe,Mb,Y.QJh,Zd[Oc],we,Y.Nkl,Y.wVe.DocumentUpsellStatus)}}}catch(nd){H.a.$(510248773,829,10,"DesignerViewHelper:RenderSuggestions - exception. CorrelationId:{0}, Error:{1}",this.Rd.correlationId,nd)}}}l7n(Y,Sa,Mb,oc){try{if(!(Y&&Y.SlideSuggestions&&Y.SlideSuggestions.length&&
Sa))return!1;this.aNh(Sa);const Oc=Sa.querySelector("."+Te.oAc);if(!Oc)return!1;const nd=Oc.childNodes.length,Cd=Oc.childNodes.length+Y.SlideSuggestions.length,Zd=this.PMj(),we=Sa.parentNode.parentNode.id;for(let Qe=0;Qe<Y.SlideSuggestions.length;++Qe){const kf=this.rWl(nd+Qe,Cd,Zd);this.WZk(0,Sa,kf,we,Cd,Y.SlideSuggestions[Qe],nd+Qe,oc,Y.DocumentUpsellStatus);Oc.appendChild(kf)}Y.HasPaginationInfo&&this.Zzm(Sa,Mb);return!0}catch(Oc){return H.a.$(510248772,829,10,"DesignerViewHelper:RenderMoreIdeas - Exceptionstion {0}",
Oc),!1}}EZm(Y,Sa,Mb){const oc={};if(Sa)for(const Oc of Mb)switch(Oc.Type){case 0:Sa=Oc;Mb=null;for(const nd of Y.SlideSuggestions)if(nd.Index===Sa.IndexInDesigner){Mb=nd;break}oc[Oc.Index.toString()]=Mb;break;default:oc[Oc.Index.toString()]=Oc}else for(const Oc of Y.SlideSuggestions)oc[Oc.Index.toString()]=Oc;return oc}zdo(Y,Sa){Sa=Sa.toString();return!(Sa in Y)||!Y[Sa]}zUm(Y){const Sa=Ib.a.kg();Sa.className="DesignerFreeTrialCardContainer";const Mb=Ib.a.kg();Mb.className="DesignerFreeTrialCardTitle";
Mb.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialTitle;const oc=Ib.a.kg();oc.className="DesignerFreeTrialCardContent";oc.innerText=String.format(ResourceStrings.l_DesignerUpsellStartFreeTrialContent,this.Ytj());const Oc=Ib.a.kg();Oc.className="DesignerStartFreeTrialButtonsContainer";const nd=Ib.a.kg();nd.className=Te.yUe;nd.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialButtonText;nd.tabIndex=0;nd.setAttribute(Fa.a.IA,nd.innerText);nd.setAttribute(Fa.a.ii,Fa.a.fM);const Cd=Ib.a.kg();
Cd.className=Te.cHh;const Zd=document.createElement("i");Zd.className=Te.hHh;Zd.style.lineHeight="20px";Zd.setAttribute("Unselectable","on");const we=Ib.a.kg();we.className="DesignerStartTrialGoPremiumButtonText";we.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;we.setAttribute("Unselectable","on");Cd.setAttribute(Fa.a.IA,we.innerText);Cd.setAttribute(Fa.a.ii,Fa.a.fM);Cd.tabIndex=0;Cd.appendChild(Zd);Cd.appendChild(we);Oc.appendChild(nd);Oc.appendChild(Cd);Sa.appendChild(Mb);Sa.appendChild(oc);
Sa.appendChild(Oc);Sa.setAttribute(Fa.a.IA,String.format("{0}. {1}",Mb.innerText,oc.innerText));Sa.setAttribute(Fa.a.ii,Fa.a.EHb);Y.appendChild(Sa)}BWl(){const Y=Ib.a.kg();Y.className="DesignerInFreeTrialView";const Sa=document.createElement("i");Sa.className=n.AFrameworkApplication.isRtl?"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIconRTL":"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIcon";const Mb=Ib.a.kg();Mb.className=Te.aEf;Mb.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;
Mb.tabIndex=0;const oc=Ib.a.kg();oc.className=n.AFrameworkApplication.isRtl?"DesignerInFreeTrialViewTextRTL":"DesignerInFreeTrialViewText";oc.innerText=ResourceStrings.l_DesignerUpsellInFreeTrialText;Mb.setAttribute(Fa.a.ii,Fa.a.CGh);Mb.setAttribute(Fa.a.fkc,Fa.a.Npa);Mb.setAttribute(Fa.a.IA,Mb.innerText);Y.appendChild(Sa);Y.appendChild(Mb);Y.appendChild(oc);Y.setAttribute(Fa.a.IA,Mb.innerText+" "+oc.innerText);Y.setAttribute(Fa.a.ii,Fa.a.EHb);return Y}yjo(){const Y=document.getElementsByClassName("DesignerFreeTrialCardContainer");
if(Y)for(let Sa=0;Sa<Y.length;Sa++){const Mb=Y[Sa];if(Mb.parentNode){const oc=this.BWl();Mb.parentNode.replaceChild(oc,Mb)}}this.PDm()}ITm(Y){const Sa=this.BWl();Y.appendChild(Sa)}zTm(Y){const Sa=Ib.a.kg();Sa.className="DesignerFreeTrialCardContainer";const Mb=Ib.a.kg();Mb.className="DesignerFreeTrialCardTitle";Mb.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedTitle;const oc=Ib.a.kg();oc.className="DesignerFreeTrialCardContent";oc.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedContent;
const Oc=Ib.a.kg();Oc.className=Te.$Df;const nd=document.createElement("i");nd.className=Te.hHh;nd.style.lineHeight="20px";const Cd=Ib.a.kg();Cd.className="DesignerTrialExhaustedGoPremiumButtonText";Cd.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Oc.setAttribute(Fa.a.IA,Cd.innerText);Oc.setAttribute(Fa.a.ii,Fa.a.fM);Oc.tabIndex=0;Oc.appendChild(nd);Oc.appendChild(Cd);Sa.appendChild(Mb);Sa.appendChild(oc);Sa.appendChild(Oc);Sa.setAttribute(Fa.a.IA,String.format("{0}. {1}",Mb.innerText,oc.innerText));
Sa.setAttribute(Fa.a.ii,Fa.a.EHb);Y.appendChild(Sa)}Zzm(Y,Sa){const Mb=Ib.a.kg();Mb.className=Te.gHh;Mb.setAttribute(Te.xUe,Sa);Mb.tabIndex=0;Sa=new kg.a;Sa.zh(16,16);Sa.CZa("0,0,2048,2048");const oc=new zj.a;oc.$na("M 1536 138 q 115 66 209 160 q 94 93 162 207 q 67 114 104 246 q 37 131 37 273 q 0 141 -36 272 q -37 131 -104 245 q -67 113 -160 207 q -94 93 -207 160 q -114 67 -245 104 q -131 36 -272 36 q -141 0 -272 -36 q -131 -37 -244 -104 q -114 -67 -207 -160 q -94 -94 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -145 39 -278 q 38 -134 108 -249 q 69 -116 167 -210 q 97 -94 216 -159 h -530 v -128 h 768 v 768 h -128 v -553 q -113 54 -207 137 q -95 83 -162 188 q -68 104 -105 227 q -38 123 -38 257 q 0 124 32 238 q 32 114 91 214 q 58 99 140 181 q 82 82 182 141 q 99 58 214 90 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -90 q 99 -59 181 -141 q 82 -82 141 -181 q 58 -100 90 -214 q 32 -115 32 -238 q 0 -114 -27 -220 q -28 -106 -78 -200 q -50 -94 -121 -173 q -71 -80 -158 -141 z");
Sa.appendChild(oc);Sa=Sa.va;Sa.setAttribute("class","DesignerMoreIdeasButtonIcon");Mb.appendChild(Sa);Sa=Ib.a.kg();Sa.className="DesignerMoreIdeasButtonLabel";Sa.innerText=ResourceStrings.l_DesignerSeeMoreIdeas;Mb.appendChild(Sa);Mb.setAttribute(Fa.a.IA,Sa.innerText);Mb.setAttribute(Fa.a.ii,Fa.a.fM);Y.appendChild(Mb)}Meo(Y){if(Y){var Sa=Ib.a.LK();Sa.className="DesignerMoreIdeasLoading";Sa.src=ed.a.NX(yb.a.mZa);Y.appendChild(Sa)}}aNh(Y){if(Y){var Sa=Y.querySelector("."+Te.gHh);Sa&&Y.removeChild(Sa);
(Sa=Y.querySelector(".DesignerMoreIdeasLoading"))&&Y.removeChild(Sa)}}$3m(Y,Sa,Mb,oc,Oc){const nd=Ib.a.kg();nd.className=Te.oAc;nd.setAttribute(Te.xUe,Sa);nd.setAttribute(Fa.a.IA,ResourceStrings.l_DesignerSuggestions);nd.setAttribute(Fa.a.ii,Fa.a.yzc);Oc&&(this.Rd.YFf=this.Ten());for(Sa=0;Sa<Y;++Sa)nd.appendChild(this.rWl(Sa,Y,oc));Mb.appendChild(nd);return nd}rWl(Y,Sa,Mb){const oc=Ib.a.kg();oc.className=Mb?this.aTh+"4x3":this.aTh;oc.setAttribute(Te.uAc,Y);oc.tabIndex=0;oc.setAttribute(Fa.a.IA,String.format(ResourceStrings.l_DesignerSuggestionItem,
Y+1));oc.setAttribute(Fa.a.ii,Fa.a.dfb);oc.setAttribute(Fa.a.bUe,Y+1);oc.setAttribute(Fa.a.cUe,Sa);return oc}WZk(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we){let Qe=null;this.na.MXa&&(Sa&&(Qe=Sa.querySelector("#"+oc+' [IncSuggestionPlaceholder="'+Cd+'"]')),Qe&&Sys.UI.DomElement.addCssClass(Qe,"ShimmerPaused"),this.ZBn(Cd,Oc));Sa=!1;switch(Y){case 0:this.Qbo(Mb,nd,Cd);Sa=(Y=Zd&&this.na.mEc)&&1!==we;Oc=oc=we=!1;if(nd&&nd.Categories)for(const kf of nd.Categories)2===kf?we=Zd&&!Y:1===kf?oc=!0:3===kf?Oc=!0:4===kf&&this.$Hj(Mb,
"commoncontrolsmartalignandspace.svg",ResourceStrings.l_DesignerFixItSuggestionItem,Cd);(we||Sa)&&this.jco(Mb);oc?this.$Hj(Mb,"commoncontrolvideocamerawithwhiteborder_24.svg",ResourceStrings.l_DesignerLoopingVideoSuggestionItem,Cd):Oc&&(this.$Hj(Mb,"commoncontrolanimationsuggestioniconnoborder.svg",ResourceStrings.l_DesignerAnimationSuggestionItem,Cd),Mb.setAttribute(Te.IDi,Te.IDi),Mb.setAttribute("title",ResourceStrings.l_DesignerAnimationSuggestionTooltip));this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Designer.EnableDesignDescriptions",
!1)&&this.lTm(Mb,nd);break;case 1:this.j7n(Mb,nd);break;case 2:this.c7n(Mb);break;case 3:case 4:this.q7n(Mb,nd)}Qe&&Qe.parentNode.removeChild(Qe);nd=Ib.a.kg();nd.className=Te.kHh;Sa&&(nd.style.visibility=hc.a.visible,Mb.removeAttribute("tabindex"),Mb.setAttribute(Fa.a.CK,Fa.a.iE));Mb.appendChild(nd)}j7n(Y,Sa){if(Sa){Y.className=tf.CUh;Y.setAttribute(Fa.a.IA,ResourceStrings.L_MakeItVisualCardTitle);var Mb=Ib.a.yy();Mb.className=tf.SIn;Mb.innerText=ResourceStrings.L_MakeItVisualCardTitle;var oc=Ib.a.yy();
oc.className=tf.RIn;oc.innerText=ResourceStrings.L_MakeItVisualCardSubtitle;var Oc=Ib.a.kg();Oc.className=tf.QIn;Oc.setAttribute(Fa.a.ii,Fa.a.yzc);var nd=0,Cd=new fi.a,Zd=Math.min(Df.DUg,Sa.SearchTerms.length);for(let we=0;we<Zd;we++)nd=this.HWl(Sa.SearchTerms[we].Term,Oc,Cd,we,nd);for(Sa=Zd;Sa<Df.DUg;Sa++)for(const we of Df.vXl)if(!Cd.contains(we)){nd=this.HWl(we,Oc,Cd,Sa,nd);break}Y.appendChild(Mb);Y.appendChild(oc);Y.appendChild(Oc);this.Rd.oUh=!0}}HWl(Y,Sa,Mb,oc,Oc){const nd=Ib.a.kg();nd.className=
tf.yjm;nd.setAttribute(Fa.a.ii,Fa.a.dfb);const Cd=tf.j1e+"."+oc,Zd=Ib.a.LK();Zd.className=tf.PIn;Zd.src=(()=>{let kf=this.Fin(Y,Mb,Oc);({Flc:Oc}=kf);return kf})().returnValue;Zd.setAttribute(Fa.a.nba,Cd);const we=Ib.a.kg();we.className=tf.i1e;we.tabIndex=0;we.setAttribute(tf.Bjm,oc);we.setAttribute(Fa.a.ii,Fa.a.fM);oc=document.createElement("i");oc.className=tf.vsk;oc.innerText="\ue721";oc.setAttribute(Fa.a.ii,Fa.a.pV);const Qe=Ib.a.yy();Qe.className=tf.j1e;Qe.innerText=Y;Qe.id=Cd;nd.appendChild(Zd);
nd.appendChild(we);we.appendChild(oc);we.appendChild(Qe);Sa.appendChild(nd);return Oc}Fin(Y,Sa,Mb){for(const oc of Df.vXl)if(oc.toLowerCase()===Y.toLowerCase())return Sa.add(oc),{returnValue:this.mf.Eq(Y+".png"),Flc:Mb};return{returnValue:this.mf.Eq("stock"+Mb++ +".png"),Flc:Mb}}Pbo(Y,Sa){if(Y){var Mb=document.createElement("video");Mb.className="SuggestedVideoBackgroundContainer";Mb.setAttribute("Src",Sa);Mb.setAttributeNode(document.createAttribute("muted"));Ll.a.y$l()||(Mb.setAttributeNode(document.createAttribute("autoplay")),
Mb.setAttributeNode(document.createAttribute("loop")),Mb.addEventListener("canplay",()=>{Mb.muted="true";Mb.play()}));Y.appendChild(Mb)}}$Hj(Y,Sa,Mb,oc){if(Y){var Oc=Ib.a.LK();Oc.src=this.mf.Eq(Sa);Oc.className="SuggestedMediaIcon";Sa=Ib.a.yy();Sa.className="SuggestedMediaContainer";Sa.appendChild(Oc);Y.setAttribute(Fa.a.IA,String.format(Mb,oc+1));Sa.setAttribute("aria-hidden",Fa.a.iE);Sa.setAttribute("Unselectable","on");Y.appendChild(Sa)}}lTm(Y,Sa){Y&&Sa&&Sa.DesignDescription&&0!=Sa.DesignDescription.length&&
Y.setAttribute(Fa.a.IA,Sa.DesignDescription)}jco(Y){if(Y)if(this.na.mEc)Sys.UI.DomElement.addCssClass(Y,hc.a.Pqd);else{Y.setAttribute(Te.fHh,Te.fHh);var Sa=Y.getAttribute(Fa.a.IA);Sa&&Y.setAttribute(Fa.a.IA,String.format("{0}. {1}",Sa.toString(),ResourceStrings.l_DesignerPremiumSuggestionItem));Fa.a.vea(Y,Fa.a.fkc,Fa.a.Npa);Sa=Ib.a.kg();Sa.className=Te.iHh;var Mb=document.createElement("i");Mb.className=Te.hHh;Sa.appendChild(Mb);Y.appendChild(Sa)}}PDm(){const Y=document.getElementsByClassName(Te.AEf);
if(Y)for(let Sa=0;Sa<Y.length;Sa++){Sys.UI.DomElement.removeCssClass(Y[Sa].parentNode,hc.a.Pqd);Y[Sa].parentNode.tabIndex=0;Y[Sa].parentNode.removeAttribute(Fa.a.CK);const Mb=ya.a.wfa(Y[Sa].parentNode,Te.kHh);!Mb||Mb.getAttribute(Te.CEi)&&Mb.getAttribute(Te.CEi).toString()===Te.aTl||(Mb.style.visibility=hc.a.hidden)}}olo(){if(this.na.mEc){var Y=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(Y)for(var Sa=0;Sa<Y.length;Sa++)Y[Sa].parentNode.removeChild(Y[Sa]);if(Y=document.getElementsByClassName("DesignerInFreeTrialView"))for(Sa=
0;Sa<Y.length;Sa++)Y[Sa].parentNode.removeChild(Y[Sa]);this.PDm()}else if(Y=document.getElementsByClassName(Te.iHh))for(Sa=0;Sa<Y.length;Sa++){Y[Sa].style.display="none";const oc=Y[Sa].parentNode;oc.removeAttribute(Te.fHh);oc.removeAttribute(Fa.a.fkc);var Mb=oc.getAttribute(Fa.a.IA);Mb&&(Mb=Mb.toString(),Mb=Mb.replace(ResourceStrings.l_DesignerPremiumSuggestionItem,""),oc.setAttribute(Fa.a.IA,Mb))}}Qbo(Y,Sa,Mb){if(Y&&Sa)try{let oc=!1;try{Y.setAttribute(Te.mNd,Sa.SlideId.Sid),Y.setAttribute(Te.jHh,
Sa.SlideId.Cid),oc=!0}catch(nd){H.a.$(510248771,829,15,"DesignerViewHelper:SetSuggestionImgSrc - failed to access suggestionItem.SlideId"),oc=!1}oc||Y.setAttribute(Te.mNd,Sa.SlideSid);const Oc=Ib.a.LK();Oc.className=Te.AEf;Oc.src=Sa.Base64Img;this.Rd.Fkc.contains(Sa.Index)||this.Rd.Fkc.add(Sa.Index);this.na.Yjd&&!Eb.a.wb(Sa.DesignerMediaURL)&&Sa.Categories&&Rb.a.contains(Sa.Categories,1)&&this.Pbo(Y,Sa.DesignerMediaURL);Y.appendChild(Oc);H.a.$(510248770,829,50,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} rendered. CorrelationId: {1}",
Mb,this.Rd.correlationId)}catch(oc){Y.parentNode.removeChild(Y),H.a.$(510248769,829,10,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} failed to render in browser. CorrelationId: {1}, Error: {2}",Mb,this.Rd.correlationId,oc)}}c7n(Y){if(Rb.a.wb(this.Rd.TXa)||!this.Rd.t2m())Y.style.display=hc.a.none;else{Y.className=tf.$1i;var Sa=Ib.a.yy();Sa.className=tf.F9m;Sa.innerText=ResourceStrings.L_ConsistencyCardTitle;var Mb=Ib.a.kg();Mb.className=tf.C9m;var oc=Ib.a.yy();oc.className=oc.id=tf.mZl;
oc.innerText=oc.title=this.Rd.TXa[0].critiques[0].explanationLabel;var Oc=Ib.a.kg();Oc.className=tf.r9m;var nd=Ib.a.yy();nd.innerText="<";nd.tabIndex=0;Sys.UI.DomElement.addCssClass(nd,tf.ZTd);Sys.UI.DomElement.addCssClass(nd,tf.WRf);nd.id=tf.ZTd;var Cd=Ib.a.yy();Cd.innerText="1";Cd.id=tf.Z1i;this.Rd.jAa=0;var Zd=Ib.a.yy();Zd.innerText="/";var we=Ib.a.yy();we.className=tf.s9m;we.id=tf.cZl;we.innerText=this.Rd.TXa.length.toString();var Qe=Ib.a.yy();Qe.innerText=">";Qe.tabIndex=0;Qe.className=Qe.id=
tf.SVe;0<this.Rd.TXa.length-1?Sys.UI.DomElement.addCssClass(Qe,tf.TVe):Sys.UI.DomElement.addCssClass(Qe,tf.VRf);Oc.appendChild(nd);Oc.appendChild(Cd);Oc.appendChild(Zd);Oc.appendChild(we);Oc.appendChild(Qe);Mb.appendChild(oc);Mb.appendChild(Oc);oc=Ib.a.yy();oc.className=tf.v9m;oc.innerText=ResourceStrings.L_ConsistencyCardDescription;Oc=Te.sWl();this.p6l(Oc,0);nd=Ib.a.kg();nd.className=tf.y9m;Cd=Ib.a.kg();Cd.className=tf.TRf;Cd.innerText=ResourceStrings.L_ConsistencyCardIgnore;Cd.title=ResourceStrings.L_ConsistencyCardIgnoreTitle;
Cd.tabIndex=0;nd.appendChild(Cd);Cd=Ib.a.kg();Cd.className=tf.B9m;Zd=Ib.a.yy();Zd.className=tf.YRf;Zd.innerText=ResourceStrings.L_ConsistencyCardSeeMore;Zd.tabIndex=0;Cd.appendChild(Zd);Zd=Ib.a.kg();Zd.id=tf.dZl;Zd.appendChild(Mb);Zd.appendChild(oc);Zd.appendChild(Oc);Zd.appendChild(nd);Y.appendChild(Sa);Y.appendChild(Zd);Y.appendChild(Cd);this.Rd.wJh=!0}}q7n(Y,Sa){if(Sa){Y.className=Te.fTl;Y.setAttribute(Fa.a.IA,Sa.TitleText);Y.setAttribute(Te.uAc,Sa.Index);var Mb=this.Dho(Sa.ExecutionActionName);
if(Mb){var oc=Ib.a.LK();oc.src=this.mf.Eq("pegal.png");oc.className=Mb;var Oc=Ib.a.yy();Oc.className="cui-img-container cui-img-24by24";Oc.appendChild(oc);Y.appendChild(Oc)}oc=Ib.a.yy();oc.className="DesignerSuggestedActionTitle";oc.innerText=Sa.TitleText;Oc=Ib.a.yy();Oc.className="DesignerSuggestedActionSubtitle";Oc.innerText=Sa.DescriptionText;Sa=Ib.a.kg();Sa.className=Mb?"DesignerSuggestedActionDescriptionWithIcon":"DesignerSuggestedActionDescription";Sa.appendChild(oc);Sa.appendChild(Oc);Y.appendChild(Sa)}}Yum(Y){try{if(this.a_e&&
this.a_e.instance){const Sa=Ib.a.kg();Sa.id="AgendaCardContainer";Sa.className="AgendaCardContainer";Y.appendChild(Sa);this.a_e.instance.yzm(Sa)}}catch(Sa){H.a.$(510248768,829,10,"DesignerViewHelper:RenderAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",this.Rd.correlationId,Sa)}}H0m(){try{this.a_e&&this.a_e.instance&&this.a_e.instance.IEj()}catch(Y){H.a.$(510248729,829,10,"DesignerViewHelper:CleanUpAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",this.Rd.correlationId,
Y)}}Dho(Y){switch(Y){case "PowerPointConvertImageToTable":return"pegal_ImageToTable_24x24x32";default:return null}}p6l(Y,Sa){Sa=this.Rd.TXa[Sa].critiques[0].suggestions;const Mb=Math.min(Df.nIn,Sa.length);for(let oc=0;oc<Mb;oc++)this.ipn(Y,Sa[oc].description,Sa[oc].numberOfInstances,oc)}ipn(Y,Sa,Mb,oc){const Oc=Ib.a.kg();Oc.className=tf.okd;Oc.tabIndex=0;Oc.setAttribute(Df.nkd,oc);const nd=Ib.a.yy();nd.className=tf.xJh;nd.innerText="\u2192";nd.setAttribute(Df.nkd,oc);const Cd=Ib.a.yy();Cd.className=
tf.oZl;Cd.innerText=Sa;Cd.setAttribute(Df.nkd,oc);Sa=Ib.a.yy();Sa.className=tf.nZl;Sa.innerText=String.format("[{0}]",Mb);Sa.setAttribute(Df.nkd,oc);Oc.appendChild(nd);Oc.appendChild(Cd);Oc.appendChild(Sa);Y.appendChild(Oc)}Ego(Y){this.s0h();this.Pxg=new B.a(2,1,this.na.SIh,()=>{this.YBn(Y)},void 0,"IncrementalRenderTimeoutTask");this.Yb.Rb(this.Pxg)}s0h(){this.Pxg&&(this.Yb.Sh(this.Pxg),this.Pxg=null)}YBn(Y){this.s0h();for(let Sa=0;Sa<Y;Sa++)this.Rd.Fkc.contains(Sa)||this.Rd.vNh.add(Sa)}ZBn(Y,Sa){if(!this.Rd.fjd.contains(Y)&&
(this.Rd.fjd.add(Y),Y=this.Rd.fjd.count,Y===Sa&&(this.Rd.Jyf=new Date,this.s0h()),!this.Rd.m8e&&Y>=this.Rd.YFf)){for(Sa=0;Sa<this.Rd.YFf;Sa++)if(!this.Rd.fjd.contains(Sa))return;this.Rd.m8e=new Date}}Ten(){const Y=document.getElementById("WACDocumentPanel");if(Y){const Sa=this.na.xpc,Mb=this.PMj();return Math.floor((Y.offsetHeight-87)/(Sa||Mb?135:101))}return 1}PMj(){const Y=this.qC();return.01>=Math.abs(Y.width/Y.height-1.33)}hUl(Y,Sa){this.GBl(this.KWe(Y,Sa),Sa,!1)}Mxm(Y,Sa){this.GBl(Y,Sa,!0)}Zko(Y){if(Y&&
(Y=Y.querySelector(".DesignerSuggestionResultSelected, .DesignerSuggestionResultSelected4x3, .DesignerSuggestionResultSelectedWide, .DesignerSuggestionResultSelectedWide4x3"))){var Sa=-1!==Y.className.indexOf("4x3");this.GBl(Y,Sa,!1)}}GBl(Y,Sa,Mb){Y&&(Mb?(Y.className=Sa?this.bTh+"4x3":this.bTh,Fa.a.vea(Y,Fa.a.CTb,Fa.a.iE)):(Y.className=Sa?this.aTh+"4x3":this.aTh,Fa.a.vea(Y,Fa.a.CTb,Fa.a.Npa)))}qC(){return this.rc.qC()}KWe(Y,Sa){return Y.querySelector("."+(Sa?this.bTh+"4x3":this.bTh))}get Ia(){return Object(G.a)(22,
this.ya.Ia)}Pwm(Y,Sa){if(Y){if(Y=Y.querySelector("["+Te.uAc+'="'+Sa+'"]'))Sa=Lb.a.ji(Y),Y.contains(Lb.a.BIb(new Sys.UI.Point(Sa.x,Sa.y)))&&Y.contains(Lb.a.BIb(new Sys.UI.Point(Sa.x+Sa.width-1,Sa.y)))?Y.contains(Lb.a.BIb(new Sys.UI.Point(Sa.x,Sa.y+Sa.height-1)))&&Y.contains(Lb.a.BIb(new Sys.UI.Point(Sa.x+Sa.width-1,Sa.y+Sa.height-1)))||Y.scrollIntoView(!1):Y.scrollIntoView(!fb.a("Designer.ScrollIntoViewFix"))}else H.a.$(510248728,829,15,"Designer view has been removed from DesignerViewContainer")}static HYi(Y){let Sa=
null;try{Sa=de.a(Y)}catch(Mb){H.a.$(510248727,829,10,"DesignerViewHelper:TransformSuggestionDataFormat - parsing suggestionResults failed")}return Sa}static $Vn(Y){const Sa=Y.CardData;let Mb=null;try{if(Mb=de.a(Sa),!Y.SlideSuggestions&&Mb)for(Mb=Hj.e(Mb,oc=>0!==oc.Type),Y=0;Y<Mb.length;Y++)Mb[Y].Index=Y}catch(oc){H.a.$(510248726,829,10,"parsing cards failed with exception: {0}",oc)}return Mb}static Deo(Y,Sa,Mb){Mb.style.backgroundColor="white";const oc=Ib.a.kg();oc.className=Y?"IncSuggestionPlaceholder placeholder_237x178":
"IncSuggestionPlaceholder placeholder_237x137";oc.setAttribute("IncSuggestionPlaceholder",Sa);(Na.a.Ek||Na.a.Yf)&&Sys.UI.DomElement.addCssClass(oc,"Shimmer");Mb.appendChild(oc)}static sWl(){const Y=Ib.a.kg();Y.className=Y.id=tf.pZl;return Y}}Te.oAc="DesignerSuggestionList";Te.xUe="correlationId";Te.uAc="suggestionIndex";Te.mNd="slideId";Te.jHh="slideCid";Te.fHh="isShownAsPremiumContent";Te.IDi="containsAnimation";Te.aTl="Refreshing";Te.CEi="SourceTrigger";Te.AEf="SuggestionImg";Te.hHh="ms-Icon ms-Icon--Diamond";
Te.iHh="ShadowedTriangleContainer";Te.kHh="DesignerSuggestionListDisabled";Te.gHh="DesignerMoreIdeasButton";Te.fTl="DesignerSuggestedActionResult";Te.aEf="DesignerInFreeTrialViewGoPremiumText";Te.$Df="DesignerFreeTrialCardGoPremiumButton";Te.yUe="DesignerStartFreeTrialButton";Te.cHh="DesignerStartFreeTrialGoPremiumButton";Object(c.a)(Te,"DesignerViewHelper",null,[768]);class vi{constructor(){this.cid=this.sid=0;this.jNh=this.jra=this.trigger=null}}Object(c.a)(vi,"PendingRequest",null,[]);class uj{constructor(){this.olk=
!1;this.WVc=null}get C$l(){return this.olk}get Oam(){return this.WVc}static get q3(){const Y=new uj;Y.olk=!0;Y.WVc=new Date;return Y}static get ready(){const Y=new uj;Y.olk=!1;Y.WVc=null;return Y}}Object(c.a)(uj,"RequestState",null,[]);var ah=a(768),Pi=a(490);class hj{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg,yh,qg,Ug,Zh,Ii,Jl,Tl,jm,Pj,Gj,dk,ql,yl,rl,qi,$i,Cj){this.Ywa=null;this.k_c=this.Hem=0;this.Lfm=!1;this.Hnd=this.HQh=this.hod=null;this.xdm=!1;this.Pfm=0;this.izg=this.ymc=!1;this.Yon=
(wm,cm,Ym)=>{if(1===Ym)return 32;try{this.vC&&this.vC.$D&&this.vC.$D.isVisible?Sb.a.Gz().then(Jm=>{Jm.setSelectedTaskPane(fc.a.qqa);return null}).catch(Jm=>{H.a.$(509354911,811,10,"DesignerPane::SelectPane exception: {0}",Jm.toString())}):this.la.Eb(tb.a.GVd,2)}catch(Jm){return H.a.$(509354910,811,10,"DesignerPane::OpenOrSelectPane exception: {0}",Jm.toString()),8}return 32};this.LD=Cd;this.vC=Zd;this.RJ=we;this.kY=Qe;this.Rd=kf;this.la=Y;this.qE=Sa;this.rb=Oc;this.Na=nd;this.ya=Vf;this.nh=eg;this.Fd=
zg;this.na=qg;this.zc=Mb;this.Tb=oc;this.Jm=Ug;this.d8b=Zh;this.x8b=uj.ready;this.NYa=Ii;this.zb=Jl;this.ud=Tl;this.Yb=jm;this.Rmc=Pj;this.tug=ql;this.rc=yl;this.Uwa=rl;this.k_=qi;this.jcm=$i;this.mdm=Cj;this.Gem=Object(h.a)(this,this.won,"handleFirstRunExperienceEvent");dk&&dk.isFeatureEnabled("PowerPointEnterpriseDesigner",!1).then(wm=>{this.Lfm=wm;return null});this.la.z9(this);this.ymc=fb.a("AddMoreDesignerLogsEnabled");this.izg=this.na.getBooleanAppSetting("FixEntryTriggerIssueEnabled")}Kb(){this.na.Cfg&&
(this.la.ua(tb.a.sjl,Ta.a.application,Object(h.a)(this,this.Kzm,"showHideIdeas"),4),this.la.ua(tb.a.G_h,Ta.a.application,Object(h.a)(this,this.Kzm,"showHideIdeas"),4),fb.a("Designer.QueryNewPane")&&this.la.ua(tb.a.z6c,Ta.a.application,Object(h.a)(this,this.s2n,"queryShowHideDesignerPane"),96),this.la.ua(tb.a.dWh,Ta.a.application,this.Yon,4),this.la.ua(tb.a.GVd,Ta.a.application,Object(h.a)(this,this.Knh,"showHideDesigner"),4),this.la.ua(tb.a.WHa,Ta.a.application,Object(h.a)(this,this.WHa,"applyDesignerSuggestion"),
4),this.la.ua(tb.a.xTb,Ta.a.application,Object(h.a)(this,this.WHa,"applyDesignerSuggestion"),4),this.la.Ba(tb.a.K0c,Ta.a.application,Object(h.a)(this,this.Tpd,"navigateDesignerSuggestion")),this.la.Ba(tb.a.cse,Ta.a.application,Object(h.a)(this,this.Tpd,"navigateDesignerSuggestion")),this.la.Ba(tb.a.Wpd,Ta.a.application,Object(h.a)(this,this.Tpd,"navigateDesignerSuggestion")),this.la.Ba(tb.a.J0c,Ta.a.application,Object(h.a)(this,this.Tpd,"navigateDesignerSuggestion")),this.la.Ba(tb.a.ase,Ta.a.application,
Object(h.a)(this,this.Tpd,"navigateDesignerSuggestion")),this.la.Ba(tb.a.Upd,Ta.a.application,Object(h.a)(this,this.Tpd,"navigateDesignerSuggestion")),this.la.Ba(tb.a.bse,Ta.a.application,Object(h.a)(this,this.Tpd,"navigateDesignerSuggestion")),this.la.Ba(tb.a.Vpd,Ta.a.application,Object(h.a)(this,this.Tpd,"navigateDesignerSuggestion")),this.la.ua(tb.a.lib,Ta.a.application,Object(h.a)(this,this.lib,"reportSuggestionSessionInfo"),64),this.la.Ba(tb.a.XIh,Ta.a.application,Object(h.a)(this,this.eko,"triggerOnUndoRedo")),
this.la.Ba(tb.a.KNh,Ta.a.application,Object(h.a)(this,this.Z5l,"handleImageUploadForDesigner")),this.la.Ba(tb.a.adg,Ta.a.application,Object(h.a)(this,this.Z5l,"handleImageUploadForDesigner")),this.d8b.Vjc(Object(h.a)(this,this.exa,"onSlidePresenceChanged")),this.nh.cU(Object(h.a)(this,this.C7m,"designerTargetSlideChangedHandler")),this.na.MXa&&this.Fd.bQl(Object(h.a)(this,this.ITn,"onRenderSuggestions")),this.na.fIb&&this.Fd.CPl(Object(h.a)(this,this.LSn,"onMoreIdesClicked")),this.na.JYi&&this.Fd.Sjc(Object(h.a)(this,
this.mab,"onRibbonTabSwitched")),this.na.wI&&this.nh.XSb(Object(h.a)(this,this.B7m,"designerSlidesSelectionChangedHandler")),this.na.$jd&&this.NYa.WJd(Object(h.a)(this,this.uTa,"onBlockingStateChanged")),this.nh.GFh(Object(h.a)(this,this.sue,"onForceOutboundGraphTransactionDisposed")),this.Rmc.sTe(Object(h.a)(this,this.Nue,"onMarkedUndo")),this.na.WIh&&this.ud.Teb(Object(h.a)(this,this.inc,"onSessionEnding")),fb.a("FixSessionRehydrationIssueForDesigner")&&this.ud.fKd(Object(h.a)(this,this.P1e,"onSessionExpired")),
this.ud.eI(Object(h.a)(this,this.qr,"onSessionRehydrated")),this.tug&&this.tug.execute(Y=>{Y.MPl(Object(h.a)(this,this.Cxk,"onEditorCritiques"))}),this.jcm&&this.jcm.execute(Y=>{Y.jVm(Object(h.a)(this,this.gSn,"onHighConfidenceAgendaDetected"))}),this.na.IXl?(this.Hem=window.setTimeout(Object(h.a)(this,this.Rwl,"tryTriggerNewDocDesignerRequest"),this.na.HXl),window.addEventListener("FREDecisionEvent",this.Gem,!0)):this.Rwl(),!Eb.a.wb(this.na.YWh)&&this.D7m(this.na.YWh)&&(this.kon(),this.ako(this.na.YWh)))}won(Y){window.removeEventListener("FREDecisionEvent",
this.Gem,!0);window.clearTimeout(this.Hem);(Y=Y.detail)&&Y.show&&Y.show||this.Rwl()}Ae(){const Y=this.Na.Uc(fc.a.qqa);Y.bindAction($a.a.hb(la.a.m6,0),tb.a.K0c);Y.bindAction($a.a.hb(la.a.cG,0),tb.a.K0c);Y.bindAction($a.a.hb(la.a.vJ,0),tb.a.cse);Y.bindAction($a.a.hb(la.a.yt,4),tb.a.Wpd);Y.bindAction($a.a.hb(la.a.l6,0),tb.a.J0c);Y.bindAction($a.a.hb(la.a.bG,0),tb.a.J0c);Y.bindAction($a.a.hb(la.a.yz,0),tb.a.ase);Y.bindAction($a.a.hb(la.a.yt,0),tb.a.Upd);Y.bindAction($a.a.hb(la.a.O1,0),tb.a.bse);Y.bindAction($a.a.hb(la.a.GY,
0),tb.a.Vpd)}Knh(Y,Sa,Mb,oc,Oc){return this.M9(this.vC,fc.a.qqa,Mb,Y,Oc)}Kzm(Y,Sa,Mb,oc,Oc){return Oc||!this.LD.isVisible?this.M9(this.vC,fc.a.q0b,Mb,Y,Oc):0}M9(Y,Sa,Mb,oc,Oc){var nd=this.ya.presentation;nd=!!this.ya.Ia&&!!nd&&!this.zc.Hd(nd);if(this.na.wI){const Cd=this.rb.rg();nd=!!Cd&&1===Cd.length&&nd}if(!nd)return 16;if(!this.kY.isEnabled())return 8;if(1===Mb)return 32;Oc||this.Na.Gm(Sa,Y.$D.isVisible);Sa=!1;if(this.na.SYe||this.na.TYe)Sa=Oc?Oc:!1;oc===tb.a.GVd?this.Rd.correlationId&&!this.Rd.xZe(this.Rd.correlationId)||
this.MIb(og.a.Htd):Y.$D.isVisible?Y.$D.DB(!1,ah.a.R6e,Sa?1:2):(this.MIb(oc===tb.a.G_h?og.a.Htd:og.a.pNe),Y.$D.DB(!0,ah.a.none,Sa?1:2));return 32}s2n(Y,Sa,Mb,oc,Oc){if(!Object(qj.a)(fl.a,Oc)||!this.vC||!this.vC.$D)return 8;Oc.Fg(this.vC.$D.isVisible);return 32}WHa(Y,Sa,Mb,oc,Oc){Sa=this.ya.presentation;if(!this.ya.Ia||!Sa||this.zc.Hd(Sa))return 16;oc=null;let nd=!0;Object(qj.a)(Ik,Oc)?oc=Oc:Object(qj.a)(em,Oc)&&(oc=Oc.wGh,nd=!1);if(!this.kY.isEnabled()||!oc)return 8;if(this.kY.RVn())return H.a.$(512496589,
829,50,"DesignerActor::ApplyDesignerSuggestion - skipped when client refresh. CorrelationId: {0}, ActionId: {1}",oc.CorrelationId,Y),8;if(1===Mb)return 32;if(!this.rb.Au()){if(1===this.rb.zd().length&&this.rb.zd()[0].Yw)return this.rb.nj(),H.a.$(512496588,829,15,"DesignerActor::ApplyDesignerSuggestion - skipped when there are picture in crop mode. CorrelationId: {0}, ActionId: {1}",oc.CorrelationId,Y),8;this.rb.nj()}if(!this.na.fIb&&this.Rd.m2a.sid===oc.SuggestionSid)return H.a.$(512496587,829,50,
"DesignerActor::ApplyDesignerSuggestion - suggestion already applied, skipping. CorrelationId: {0}, SuggestionSid: {1}",oc.CorrelationId,oc.SuggestionSid),2;Mb=this.Tb.xe(15);try{this.na.$jd&&(this.Rd.Did=new Date),Mb.tc(Sa),Mb.wc=Y,Sa.N3a=oc,this.Rd.m2a=w.a.Er(oc.SuggestionSid,oc.SuggestionCid),this.Rd.KCa=!0,H.a.$(512496586,829,50,"DesignerActor::ApplyDesignerSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}, slideID:{3}",oc.CorrelationId,Y,oc.SuggestionSid,oc.ActiveSlideSid)}finally{Mb&&
Mb.dispose()}this.na.dIb?this.zc.snb(Sa,this.ya.Ia,this.zb.Ua,Y):this.zc.wy(Sa,Y);this.LD.isVisible&&this.Na.Ag(fc.a.q0b);nd&&this.Rd.mqk();(this.na.SYe||this.na.TYe)&&this.vC.$D.T8l();return 32}Tpd(Y,Sa,Mb){Sa=this.ya.presentation;if(!this.ya.Ia||!Sa||this.zc.Hd(Sa))return 16;if(!this.kY.isEnabled())return 8;if(1===Mb)return 32;this.kY.Mpn(Y);return 32}lib(Y,Sa,Mb,oc,Oc){if(this.kY.vC.$D.isVisible)return 0;this.vGe(Oc.LOh,Oc.a8n);return 32}vGe(Y,Sa,Mb){const oc=this.Rd.correlationId;if(Eb.a.wb(oc))H.a.$(512496585,
829,50,"DesignerActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",Sa);else if(this.Rd.xZe(oc))H.a.$(512496584,829,50,"DesignerActor::SendTraceRequest - skipped for closed correlation. CorrelationId:{0}, ResetReason:{1}",oc,Sa);else{var Oc={};Oc.CachedTrigger=this.Rd.XEi;Oc.SuggestionSlideId=this.Rd.m2a.sid.toString();Oc.SuggestionSlideCreationId=this.Rd.m2a.cid.toString();Oc.AppliedSuggestion=this.Rd.KCa;Oc.DisplaySuggestionsTimeoutInMs=this.na.VIh;Oc.SuggestionsTimeout=this.Rd.ind;
Oc.ClientAbort=this.Rd.OYe||this.kY.PVn();Oc.DesignerPaneClosed=Y;Oc.ResetReason=Sa;Oc.HoverPreviewDesignerTriggered=this.Rd.T9l;Oc.DesignerFixPaneOpenHint=this.na.KYi;Oc.DesignerSendTraceRequestOnSessionEnded=this.na.WIh;Oc.UseWin32DesignerIconEnabled=this.na.yVe;Oc.IsSimplifiedRibbon=this.GPc();fb.a("DesignerLogRetriggerReason")&&Mb&&(Oc.RetriggerReason=Mb);this.na.JYi&&(Oc.DesignerDesignTabTriggerEnabled=!0);this.vC.Wkc()&&(this.na.mEc?(Oc[Je.a.vCl]=this.RJ.Ytj(),Oc[Je.a.xCl]=!0,this.Rd.Fnl&&(Oc.StartUpsellFreeTrial=
!0)):Oc[Je.a.cPi]=!0);Y=!!Sa&&0<=Sa.indexOf(og.a.moreIdeas);this.na.fIb&&(Oc.TermCorrelationId=hj.Ssj(),Y||(Oc.TermAction=this.zmn()));Mb=de.b(n.AFrameworkApplication.ha.appSettings.SessionStartInfoJson.toString());var nd={};nd.ClientOS=Mb.Os;nd.Browser=Mb.Browser||"";nd.BrowserVersion=Mb.BrowserVersion||"";nd.BrowserMajorVersion=Mb.BrowserMajorVersion||"";nd.BrowserMinorVersion=Mb.BrowserMinorVersion||"";this.Rd.zqh&&this.Rd.ELb&&this.Rd.ELb>this.Rd.zqh&&(nd.SuggestionsE2ETimeMs=+this.Rd.ELb-+this.Rd.zqh);
this.na.MXa&&(this.RJ.s0h(),this.Mnl(),Oc[Je.a.QHj]=!0,nd.VisibleSuggestionsCount=this.Rd.YFf,0<this.Rd.vNh.count&&(nd.IncrementalRenderTimeoutIndexes=this.Rd.vNh.toArray().join(",")),0<this.Rd.ZJb.count&&(nd.MissingDesignerCardIndexes=this.Rd.ZJb.toArray().join(",")),0<this.Rd.fjd.count&&(nd.CardIndexes=this.Rd.fjd.toArray().join(",")),0<this.Rd.Fkc.count&&(nd.DesignerCardIndexes=this.Rd.Fkc.toArray().join(",")),this.Rd.fIa&&(this.Rd.EVg&&this.Rd.EVg>this.Rd.fIa&&(nd.MissingDesignerCardsReceivedTime=
+this.Rd.EVg-+this.Rd.fIa),this.Rd.Jyf&&this.Rd.Jyf>this.Rd.fIa&&(nd.AllIncRenderReceivedTime=+this.Rd.Jyf-+this.Rd.fIa),this.Rd.m8e&&this.Rd.m8e>this.Rd.fIa&&(nd.VisibleIncRenderReceivedTime=+this.Rd.m8e-+this.Rd.fIa)));this.FTm(nd);try{if(this.k_.instance){const Cd=this.k_.instance.L7n();Eb.a.wb(Cd)||(Oc.AgendaMetrics=Cd)}}catch(Cd){H.a.$(512496583,813,10,"exception while populating AgendaMetrics",Cd)}Oc.BrowserData=nd;this.Rd.fIa&&this.Rd.ELb&&this.Rd.ELb>this.Rd.fIa&&(Oc.TimeToDisplaySuggestionsInMs=
+this.Rd.ELb-+this.Rd.fIa);this.Rd.Bsl&&this.Rd.Xsh&&(Oc.TimeSuggestionsRendered=this.Rd.Bsl.toUTCString());this.Rd.Xsh&&(Oc.TimeDesignerPaneClosed=this.Rd.Xsh.toUTCString());this.Rd.yAf&&0<this.Rd.yAf.count&&(Oc.AppliedSuggestionHis=this.Rd.yAf.toArray().join(" "));this.Jm.lib(oc,Oi.c(Oc),Sa===ah.a.nZh);this.cmo(oc,Sa);this.Rd.dPl(oc,this.na.fIb&&Y);H.a.$(512496582,829,50,"DesignerActor::ReportSuggestionSessionInfo - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",
Sa,oc)}}GPc(){return n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.ex?!0:!1}FTm(Y){Y.IdeasMivShown=this.Rd.oUh;Y.IdeasMivDrillIn=this.Rd.Tpk;Y.IdeasEditorShown=this.Rd.wJh;Y.IdeasEditorKept=this.Rd.vJh;Y.IdeasEditorDrillIn=this.Rd.eZl;Y.AnyCardShown=this.Rd.wJh||this.Rd.oUh||0<this.Rd.fjd.count;Y.AnyCardKept=this.Rd.vJh||this.Rd.KCa}cmo(Y,Sa){this.kY.e1c(Y,Sa===ah.a.R6e||Sa===ah.a.E0h||Sa===ah.a.noSuggestion||Sa===ah.a.xYl?Mj.a.W0c:Mj.a.pending)}ITn(Y,Sa){Sa.PBm.addRange(this.Rd.Fkc);
this.ZTl(Sa.PBm,Sa.D_l,Sa.slideId,Sa.trigger,Sa.correlationId);Sa.nWd&&(this.Hnd||this.Rd.ZJb.count||this.Ago(Sa.trigger,Sa.D_l))}LSn(Y,Sa){this.MIb(og.a.moreIdeas,null,Sa.Tbe)}mab(Y,Sa){!Sa.yzb||"PptRibbon.Design"!==Sa.yzb&&"Design"!==Sa.yzb||2!==Sa.Fw&&3!==Sa.Fw&&4!==Sa.Fw||this.kY.vC.$D.isVisible||32!==this.la.Eb(tb.a.m6e,1)||this.MIb(og.a.QIh)}Ago(Y,Sa){this.Mnl();const Mb=this.ya.Ia.fc,oc=this.Rd.correlationId;this.Hnd=new B.a(2,1,this.na.fsd,()=>{this.Rd.xZe(oc)||this.ZTl(this.Rd.Fkc,Sa,Mb,
Y,oc,Sa)},void 0,"CheckAndFetchMissingDesignerCardsTask");this.Yb.Rb(this.Hnd)}ZTl(Y,Sa,Mb,oc,Oc,nd){nd=void 0===nd?-1:nd;if(this.Rd.Fkc.count===Sa)this.Mnl();else if(Y&&Y.count&&!(0<this.Rd.ZJb.count)){if(-1===nd)for(const Cd of Y)Cd>nd&&(nd=Cd);this.q0m(Y,Sa,nd)&&this.pko(Mb,oc,Oc)}}q0m(Y,Sa,Mb){for(let oc=0;oc<Sa&&(Y.contains(oc)||this.Rd.ZJb.contains(oc)||this.Rd.ZJb.add(oc),oc!==Mb||this.Rd.ZJb.count);oc++);return 0<this.Rd.ZJb.count}pko(Y,Sa,Mb){const oc={};oc.MissingDesignerCardIndexes=this.Rd.ZJb.toArray().join(",");
this.Hnd=new B.a(0,1,0,()=>{this.Jm.xIb(Y.cid,Y.sid,Mb,hj.Ssj(),Sa,null,Oi.c(oc),()=>{H.a.$(512496581,829,50,"DesignerActor::TryFetchMissingDesignerCardsAsync - request successfully sent for fetch missing Designer indexes {0} for correlationId: {1}",oc.MissingDesignerCardIndexes,Mb)},Oc=>{H.a.$(512496580,829,15,"DesignerViewHelper:FetchMissingDesignerCardsAsync - request failed for fetch missing Designer indexes {0} with response: {1}. returning true to prevent ACE",oc.MissingDesignerCardIndexes,
Oc.HttpStatusCode);return!0})},void 0,"FetchMissingDesignerCardsTask");this.Yb.Rb(this.Hnd)}Mnl(){this.Hnd&&(this.Yb.Sh(this.Hnd),this.Hnd=null)}exa(Y,Sa){(Y=this.ya.Ia)&&Sa.slideId.equals(Y.fc)&&(this.kY.$_h(Sa.EAm,Sa.Arm),this.kY.vC.$D.isVisible&&!this.kY.isEnabled()&&(H.a.$(512496579,829,50,"DesignerActor::OnSlidePresenceChanged - More than two users in same slide and close opened designer pane. In the slide user count:{0}, presentation user count:{1}, CorrelationId:{2}",Sa.EAm,Sa.Arm,this.Rd.correlationId),
this.LD.DB(!1,ah.a.C1m,2)),this.LD.isVisible&&(this.kY.isEnabled()||this.kY.e1c(this.Rd.correlationId,Mj.a.W0c)))}C7m(Y,Sa){Sa.aab?(Y=Object.assign(new Il.a,{slideId:Sa.aab.fc}),this.la.Ra(tb.a.wdc,2,Y),this.kY.$_h(Y.bKe,Y.KLk),this.LD.isVisible&&(H.a.$(512496577,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - Slide changed when Designer pane is opened. CorrelationId:{0}",this.Rd.correlationId),this.kY.isEnabled()&&!Sa.aab.qR?this.MIb(og.a.Z_h):Sa.aab.qR&&this.na.uVe||(this.LD.DB(!1,ah.a.slideNavigation,
2),this.kY.e1c(this.Rd.correlationId,Mj.a.W0c)))):H.a.$(512496578,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - active slide was null. CorrelationId:{0}",this.Rd.correlationId)}j$f(Y){this.na.lEc&&(this.x8b=uj.ready,this.Ywa&&(this.LD.isVisible?(H.a.$(512496576,829,50,"DesignerActor::OnTaskComplete - sending pending request for triger {0}, sid: {1}",this.Ywa.trigger,this.Ywa.sid),Y()):this.Ywa=null))}yve(Y,Sa){this.j$f(Sa);H.a.$(512496547,829,15,"DesignerActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",
Y.HttpStatusCode);return!0}B7m(){if(this.kY.vC.$D.isVisible){const Y=this.rb.rg();Y&&1<Y.length&&(H.a.$(512496546,829,50,"DesignerActor::DesignerSlidesSelectionChangedHandler - More than one slides are selected, close the opened designer pane."),this.LD.isVisible&&this.LD.DB(!1,ah.a.BOn,2))}}uTa(Y,Sa){Y=this.Rd.Did;const Mb=this.na.dIb?"UnblockContentWhenDraw":"SessionRehydrated";Y&&Object(G.a)(String,Sa.actionName)===Mb&&(this.Rd.yAf.add(String.format("{0}:{1}:{2}",this.Rd.m2a,+Y-+this.Rd.ELb,+new Date-
+Y)),this.Rd.Did=null)}inc(Y,Sa){this.kY.vC.$D.isVisible&&(H.a.$(512496545,829,50,"DesignerActor::OnSessionEnding. Correlation={0}, Reason={1}",this.Rd.correlationId,Pi.a[Sa.nJ]),1!==Sa.nJ&&3!==Sa.nJ||this.vGe(!0,ah.a.nZh))}P1e(){H.a.$(507917086,829,50,"DesignerActor::OnSessionExpired");this.vC.$D.isVisible&&this.M9(this.vC,fc.a.qqa,2,null,null)}qr(){H.a.$(512496544,829,50,"DesignerActor::OnSessionRehydrated");if(fb.a("FixSessionRehydrationIssueForDesigner"))this.vC.$D.isVisible&&this.M9(this.vC,
fc.a.qqa,2,null,null);else{const Y={};Y[Je.a.pVf]=!0;this.MIb(og.a.refresh,Y)}}sue(Y,Sa){this.na.N9i?Sa&&void 0!==Sa.actionId&&null!==Sa.actionId?this.kY.a9l(Sa.actionId)&&this.a9f(Sa.actionId,Sa.transaction.mE):this.ymc&&H.a.$(507881238,829,50,"DesignerActor::onForceOutboundGraphTransactionDisposed args {0} and actionId {1}",Sa,Sa?Sa.actionId:null):Sa&&this.a9f(Sa.actionId,Sa.transaction.mE)}Nue(Y,Sa){if(this.na.N9i)if(Sa&&Sa.Smd)if(Y={},this.kY.GZj(Sa.actionId)){if(Sa.revisionId){var Mb=zi.a.MO(Lk.a.OQ,
zi.a.n5a(Sa.revisionId.toString()).toString());Mb&&1===Mb.length&&(Y[Je.a.Nx]=Mb[0].Nx)}this.a9f(Sa.actionId,Y)}else!this.kY.a9l(Sa.actionId)&&this.LD.isVisible&&(fb.a("FixDesignerPerfPaintNextFrameIssue")?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.M9(this.vC,fc.a.qqa,2,Sa.actionId,null)},0)}):this.M9(this.vC,fc.a.qqa,2,Sa.actionId,null));else this.ymc&&H.a.$(508137872,829,50,"DesignerActor::onMarkedUndo args or isMarkUndoSucceeded is false actionId {0}",Sa?Sa.actionId:null);else Sa.Smd&&
this.kY.GZj(Sa.actionId)&&(Y={},Sa.revisionId&&(Mb=zi.a.MO(Lk.a.OQ,zi.a.n5a(Sa.revisionId.toString()).toString()))&&1===Mb.length&&(Y[Je.a.Nx]=Mb[0].Nx),this.a9f(Sa.actionId,Y))}Z5l(Y,Sa,Mb,oc,Oc){switch(Y){case tb.a.KNh:return this.Rd.dIn(Oc),32;case tb.a.adg:return this.Rd.h6n(Oc),32;default:return 2}}RHn(Y,Sa,Mb){if(Y!==og.a.insertPicture&&Y!==og.a.hZa&&Y!==og.a.Scg)return null;const oc=Mb?Mb[Je.a.kmd]:!1,Oc=Mb?Mb[Je.a.MXe]:!1,nd=Mb?Mb[Je.a.lmd]:!1,Cd=Mb?Mb[Je.a.LXe]:!1;let Zd=null;switch(Sa){case tb.a.Pna:case tb.a.pnc:Zd=
oc?Je.a.npm:Oc?Je.a.mpm:nd?Je.a.opm:Cd?Je.a.lpm:null;break;case tb.a.qnc:Zd=oc?Je.a.rpm:Oc?Je.a.qpm:nd?Je.a.spm:Cd?Je.a.ppm:null;break;case tb.a.nTe:Zd=Je.a.copilot;break;case tb.a.AGc:Zd=Je.a.kbj;break;case tb.a.insertOnlinePicture:case tb.a.CIa:case tb.a.Mlc:Zd=Je.a.t3c;break;case tb.a.INh:Zd=Je.a.icon}Zd||H.a.$(512496543,829,50,"DesignerActor::MapActionIdToElementSource - Unexpected NULL ElementSource. Trigger: {0}, ActionId: {1}, CorrelationId: {2}",Y,Sa,this.Rd.correlationId);delete Mb[Je.a.kmd];
delete Mb[Je.a.MXe];delete Mb[Je.a.lmd];delete Mb[Je.a.LXe];return Zd}SHn(Y,Sa){fb.a("DesignerLogActionId")&&H.a.$(507881234,829,50,"DesignerActor::ActionId for trigger mapping {0}",Y);switch(Y){case tb.a.AGc:case tb.a.insertOnlinePicture:case tb.a.CIa:case tb.a.sbc:case tb.a.INh:case tb.a.nTe:case tb.a.Mlc:return og.a.insertPicture;case tb.a.qnc:case tb.a.Pna:case tb.a.pnc:case tb.a.yKb:return Sa&&Sa[Je.a.kmd]||Sa&&Sa[Je.a.MXe]&&this.na.VCm?og.a.insertPicture:Sa&&Sa[Je.a.lmd]?og.a.hZa:Sa&&Sa[Je.a.LXe]&&
this.na.qul?og.a.Scg:this.na.iWa?og.a.yAb:"";case tb.a.Bw:case tb.a.N2a:case tb.a.ckc:return og.a.ckc;case tb.a.Wpa:return og.a.V_h;case tb.a.OHe:case tb.a.PHe:case tb.a.Ksd:case tb.a.Lsd:case tb.a.Loc:return Sa&&Je.a.jmd in Sa&&Sa[Je.a.jmd]?og.a.wHh:og.a.refresh;case tb.a.DHf:case tb.a.HMa:return Sa&&Je.a.jmd in Sa&&Sa[Je.a.jmd]?og.a.IYi:og.a.refresh;case Hg.a.ona:return og.a.p8c;case tb.a.vta:case tb.a.oGa:case tb.a.yoc:case tb.a.bringForward:case tb.a.bringToFront:case tb.a.sendToBack:case tb.a.sendBackward:return fb.a("EnableDesignerSuggestionForZIndexActions")?
og.a.refresh:og.a.p8c;case Hg.a.NLd:case Hg.a.QLd:case Hg.a.knb:case Hg.a.PLd:case Hg.a.RLd:case Hg.a.CBf:case Hg.a.u2a:case Hg.a.EBf:case Hg.a.FBf:case Hg.a.GBf:case Hg.a.HBf:case Hg.a.TLd:case Hg.a.VLd:case Hg.a.backspace:case Hg.a.Iza:case Hg.a.uG:case Hg.a.sNa:case Hg.a.enter:case Hg.a.YB:case Hg.a.VA:return og.a.VA;case tb.a.hZa:return og.a.hZa;case tb.a.Tbc:return this.na.getBooleanAppSetting("DesignerUseRefreshTriggerForInsertTable")?og.a.refresh:og.a.insertTable;case tb.a.H4:case tb.a.rse:case tb.a.zzb:case tb.a.wG:return og.a.XEa;
case tb.a.bkc:return og.a.yGh;case tb.a.xHh:return og.a.uHh;case tb.a.ZAc:return og.a.ZAc;default:return og.a.refresh}}eko(Y){const Sa={};fb.a("DesignerLogActionId")&&H.a.$(508134675,829,50,"DesignerActor::triggerOnUndoRedo  ActionId {0}",Y);Sa[Je.a.undoRedo]=!0;this.MIb(og.a.refresh,Sa);return 32}a9f(Y,Sa){if(fb.a("EnableDesignerSuggestionForZIndexActions")){if(this.b9l(Y)&&this.awn(Y))return}else if(this.b9l(Y))return;const Mb=nd=>{const Cd={};Cd[Je.a.timestamp]=nd.timestamp;Cd[Je.a.correlationId]=
nd.correlationId;Cd[Je.a.trigger]=nd.trigger;Cd[Je.a.sid]=nd.sid;Cd[Je.a.cid]=nd.cid;Cd[Je.a.jra]=nd.jra;nd=this.Tb.Kd(4);try{nd.tc(this.ya.presentation),nd.wc=tb.a.RIh,this.ya.presentation.eIb=Oi.c(Cd)}finally{nd&&nd.dispose()}},oc=this.SHn(Y,Sa);this.ymc&&H.a.$(507881237,829,50,"DesignerActor::handleDesignerRequestOnEdit  ActionId {0} trigger {1}",Y,oc);const Oc=this.RHn(oc,Y,Sa);Sa||(Sa={});fb.a("DesignerLogRetriggerReason")&&oc===og.a.refresh&&(Sa[Je.a.JYh]=Y);if(!this.XYe(oc)&&!this.LD.isVisible)if(this.ymc&&
H.a.$(507642453,829,50,"DesignerActor::handleDesignerRequestOnEdit  trigger is not entry trigger {0}",oc),this.izg){if(!this.Rd.N9d)return}else return;Eb.a.wb(Oc)||(Sa[Je.a.Dfb]=Oc);this.kY.GZj(Y)&&this.LD.isVisible?this.UXi(oc,this.na.xVe,Sa,Mb):oc===og.a.refresh&&this.LD.isVisible&&fb.a("DesignerDelayRefreshTrigger")?this.UXi(oc,this.na.MXl,Sa,Mb):Y===tb.a.nTe?(Y=this.na.Ac("ChatPPTDesignerTriggerDelayMs",100),this.Pfm=Date.now(),this.UXi(oc,Y,Sa,Mb)):this.NJh(Mb,oc,Sa)}UXi(Y,Sa,Mb,oc){this.ymc&&
H.a.$(507881236,829,50,"DesignerActor::delayTriggerDesignerTask  trigger {0}",Y);if(this.hod){if(this.HQh===og.a.insertPicture&&Y===og.a.refresh){this.Yb.Sh(this.hod);this.Yb.Rb(this.hod);return}this.DJi()}this.LD.isVisible&&(this.kY.e1c(this.Rd.correlationId,Mj.a.pending),this.OZh(Y));const Oc=this.ya.Ia;if(Oc){var nd=Oc.sid,Cd=Oc.cid;this.HQh=Y;this.hod=new B.a(2,1,Sa,()=>{this.DJi();this.LD.isVisible&&H.a.$(512496542,829,50,"Potential candidate for {0} request for designer pane",Y);this.Ddo(Y,
nd,Cd)?this.ymc&&H.a.$(507642452,829,50,"DesignerActor::delayTriggerDesignerTask  shouldSkipRefreshTrigger true"):this.NJh(oc,Y,Mb)},void 0,"DesignerDelayTriggerTask");this.Yb.Rb(this.hod)}}DJi(){this.hod&&(this.ymc&&H.a.$(507881235,829,50,"DesignerActor::cleanupAnyDelayTriggerDesignerTask  trigger {0}",this.HQh),this.Yb.Sh(this.hod),this.HQh=this.hod=null)}MIb(Y,Sa,Mb){Sa=void 0===Sa?null:Sa;Mb=void 0===Mb?null:Mb;Sa||(Sa={});this.ymc&&H.a.$(507642451,829,50,"DesignerActor::handleDesignerRequestNonEdit before executeDesignerRequestProcessingWithAuth  trigger {0} lastShownCorrelationId {1}",
Y,Mb);this.NJh(oc=>{if(this.na.lEc){if(this.x8b.C$l&&+new Date-+this.x8b.Oam<this.na.ASd){this.Ywa=new vi;this.Ywa.sid=oc.sid;this.Ywa.cid=oc.cid;this.Ywa.trigger=oc.trigger;this.Ywa.jNh=oc.jra;H.a.$(512496541,829,50,"prior request in progress, marking current request as next pending. next trigger: {0}; next sid: {1}",Y,oc.sid);return}this.x8b=uj.q3;this.Ywa=null}const Oc=()=>{this.MIb(this.Ywa.trigger,this.Ywa.jNh,Mb)};this.Jm.xIb(oc.cid,oc.sid,oc.correlationId,hj.Ssj(),oc.trigger,Mb,Oi.c(oc.jra),
nd=>{nd&&nd.Status===Je.a.V0k?this.KYh(()=>{this.MIb(oc.trigger,oc.jra,Mb)}):this.k_c=0;this.k_c||this.j$f(Oc)},nd=>this.yve(nd,Oc))},Y,Sa);(this.na.SYe||this.na.TYe)&&this.vC.$D.T8l()}KYh(Y){this.k_c<this.na.zSd?this.Yb.Rb(new B.a(2,1,1E3,()=>{H.a.$(512496540,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.Rd.correlationId);this.x8b=uj.ready;this.k_c++;Y()},void 0,"RetryRequestOnWait")):H.a.$(512496539,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",
this.Rd.correlationId)}Fhn(Y,Sa){Sa=(void 0===Sa?null:Sa)||{};this.na.cPf&&Y===og.a.bZa&&(Sa[Je.a.DZl]="true");this.na.NXl&&(Sa[Je.a.RBm]=this.Lfm);this.vC.Wkc()&&(this.na.mEc?(Sa[Je.a.vCl]=this.RJ.Ytj(),Sa[Je.a.xCl]=!0):Sa[Je.a.cPi]=!0);this.RJ.wNh(Y)&&(Sa[Je.a.QHj]=!0);this.kY.Bwn()&&(Sa[Je.a.GHh]=this.kY.GHh());Sa.NewPaneEnabled=!0;var Mb=!Rb.a.wb(this.Rd.TXa);(Sa.RequestForEditorCardsForNewIdeasPane=Mb)&&(Sa.NumEditorCritiques=this.p3m());Mb={};Mb.SupportsImageToTableSuggestedAction=32===this.la.Eb(tb.a.TWh,
1);Sa.PPTOEnabledSuggestedActions=Oi.c(Mb);this.na.iWa&&Y===og.a.yAb&&(Sa[Je.a.zAb]=this.na.zAb,Sa[Je.a.E3g]=this.na.E3g,Sa[Je.a.D3g]=this.na.D3g);return Sa}p3m(){let Y=0;for(const Sa of this.Rd.TXa)for(const Mb of Sa.critiques)Y+=Mb.suggestions.length;return Y}b9l(Y){if(void 0===Y||null===Y)return!0;switch(Y){case tb.a.WHa:case tb.a.xTb:case tb.a.J0c:case tb.a.ase:case tb.a.Upd:case tb.a.K0c:case tb.a.cse:case tb.a.Wpd:case tb.a.bse:case tb.a.Vpd:case tb.a.RIh:return!0;case tb.a.cVd:return this.na.getBooleanAppSetting("ChatPPTImgShowDesigner")&&
fb.a("DesignerIgnore")&&Date.now()<this.Pfm+this.na.Ac("ChatPPTImgIgnoreRefreshMs",2E4);case tb.a.vta:case tb.a.oGa:case tb.a.yoc:case Hg.a.ona:case tb.a.bringForward:case tb.a.bringToFront:case tb.a.sendToBack:case tb.a.sendBackward:return!this.Rd.KCa;default:return!1}}awn(Y){if(fb.a("EnableDesignerSuggestionForMoveShapes")&&Y===tb.a.vta||fb.a("EnableDesignerSuggestionForResizeShape")&&Y===tb.a.oGa||fb.a("EnableDesignerSuggestionForPictureCropInfo")&&Y===tb.a.yoc)return!1;if(fb.a("EnableDesignerSuggestionForZIndexActions"))switch(Y){case tb.a.bringForward:case tb.a.bringToFront:case tb.a.sendToBack:case tb.a.sendBackward:return!1;
default:!0}return!0}p5m(Y,Sa){Sa=void 0===Sa?null:Sa;const Mb=this.ya.Ia;return Mb?Object.assign(new gl,{trigger:Y,sid:Mb.sid,cid:Mb.cid,jra:this.Fhn(Y,Sa)}):null}hyn(Y){return Object(Rj.b)(this,void 0,void 0,function*(){if(!Y||!Y.sid)return!1;if(!this.XYe(Y.trigger)&&!this.LD.isVisible)return this.izg?this.Rd.N9d?!0:!1:!1;switch(Y.trigger){case og.a.XEa:case og.a.pNe:case og.a.Htd:case og.a.insertPicture:case og.a.ckc:case og.a.QIh:case og.a.ZHh:case og.a.hZa:case og.a.Z_h:case og.a.V_h:case og.a.insertTable:return!0;
case og.a.Scg:return this.na.qul;case og.a.VA:return this.na.OYi&&this.LD.isVisible;case og.a.p8c:return this.na.vVe&&this.Rd.KCa;case og.a.wHh:case og.a.IYi:return this.na.sVe;case og.a.yAb:return this.na.iWa;case og.a.yGh:case og.a.uHh:case og.a.ZAc:return this.na.C7e;case og.a.refresh:return this.gyn(Y.jra);case og.a.moreIdeas:return this.na.fIb;case og.a.bZa:const Sa=0===(yield this.mdm.W_f());return this.na.cPf&&this.na.isCreateNew&&!Sa;case og.a.iGh:return this.na.H1h;default:return H.a.$(512496538,
829,15,"invalid trigger: {0}",Y.trigger),!1}})}gyn(Y){return Je.a.pVf in Y&&Y[Je.a.pVf]||Je.a.undoRedo in Y&&Y[Je.a.undoRedo]||this.na.LXl&&this.kY.vC.$D.isVisible?!0:!1}XYe(Y){switch(Y){case og.a.pNe:case og.a.Htd:case og.a.insertPicture:case og.a.Scg:case og.a.V_h:case og.a.wHh:case og.a.ckc:case og.a.hZa:case og.a.bZa:case og.a.yGh:case og.a.QIh:case og.a.ZHh:return!0;case og.a.iGh:return this.na.H1h;case og.a.yAb:return this.na.iWa;default:return!1}}$vn(Y){if(!(this.na.Zjd&&Je.a.Nx in Y.jra&&
Y.jra[Je.a.Nx]))return!1;switch(Y.trigger){case og.a.pNe:case og.a.Htd:case og.a.Z_h:case og.a.bZa:return!1;case og.a.refresh:return!(Je.a.pVf in Y.jra)||!(Je.a.undoRedo in Y.jra);default:return!0}}OZh(Y){const Sa=Y===og.a.VA||Y===og.a.refresh?4:Y===og.a.moreIdeas?7:1;(this.kY.vC.$D.isVisible||this.XYe(Y))&&this.vC.Nsd(Sa)}n5i(Y,Sa,Mb){var oc,Oc;Object(Rj.b)(this,void 0,void 0,function*(){this.ymc&&H.a.$(507642450,829,50,"DesignerActor::executeDesignerRequestProcessing trigger {0}",Sa);const nd="PasteText"==
Sa?new qh.a("DesignerActor::executeDesignerRequest",tb.a.yKb):void 0;null===nd||void 0===nd?void 0:nd.Gf("ST");this.DJi();const Cd=this.p5m(Sa,Mb);null===nd||void 0===nd?void 0:nd.Gf("TA_RequestData");var Zd=yield this.hyn(Cd);null===nd||void 0===nd?void 0:nd.Gf("TA_await");Zd?this.Rd.Oyn(this.ya.Ia.sid)?(this.OZh(Cd.trigger),this.KYh(()=>{this.NJh(Y,Sa,Mb)}),null===nd||void 0===nd?void 0:nd.Gf("TA_setPaneViewDirect")):(Zd=null!==(Oc=null===(oc=Cd.jra)||void 0===oc?void 0:oc.Tto)&&void 0!==Oc?Oc:
null,H.a.$(512496537,829,50,"trigger: {0}; sid: {1}; correlationId: {2} ReTriggerReason: {3}",Cd.trigger,Cd.sid,Cd.correlationId,Zd),null===nd||void 0===nd?void 0:nd.Gf("TB_sendTraceRequest"),this.Rd.correlationId&&!this.Rd.xZe(this.Rd.correlationId)&&(fb.a("DesignerLogRetriggerReason")?this.vGe(this.kY.vC.$D.isVisible,Cd.trigger,Zd):this.vGe(this.kY.vC.$D.isVisible,Cd.trigger)),null===nd||void 0===nd?void 0:nd.Gf("TA_sendTraceRequest"),this.Rd.zqh=new Date,this.Rd.correlationId=Cd.correlationId,
this.Rd.XEi=Cd.trigger,this.Rd.fIa=this.$vn(Cd)?Cd.jra[Je.a.Nx]:new Date,Cd.jra[Je.a.Dfb]===Je.a.copilot&&(this.Rd.Neg=!0),this.izg&&!this.LD.isVisible&&this.XYe(Sa)&&(this.Rd.N9d=!0),Y(Cd),null===nd||void 0===nd?void 0:nd.Gf("TA_requestAction"),this.OZh(Cd.trigger),null===nd||void 0===nd?void 0:nd.Gf("TA_setPaneViewState"),this.kY.e1c(Cd.correlationId,Mj.a.pending),null===nd||void 0===nd?void 0:nd.Gf("ET"),null===nd||void 0===nd?void 0:nd.hO()):(H.a.$(512496536,829,50,"Designer call not currently allowed for trigger {0}",
Sa),this.LD.DB(!1,ah.a.xYl,2))})}NJh(Y,Sa,Mb){if(this.na.xSd&&this.Uwa){this.OZh(Sa);var oc=new Date;this.Uwa.hP(this.na.Pye,this.na.BSd).then(Oc=>{const nd=+new Date-+oc;Oc.IsSuccess?(Mb[Je.a.i0l]=nd,Mb[Je.a.Bxm]=Oc.Token):(Mb[Je.a.x7i]=nd,H.a.$(512496535,829,15,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth Failed to get AAD token with error: "+Oc.ErrorCode+": "+Oc.ErrorMessage));this.n5i(Y,Sa,Mb)}).catch(Oc=>{H.a.$(512496534,829,10,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth - Token retrival failed:{0}",
Oc);Mb[Je.a.x7i]=+new Date-+oc;this.n5i(Y,Sa,Mb)})}else this.n5i(Y,Sa,Mb)}Rwl(){return Object(Rj.b)(this,void 0,void 0,function*(){if(this.na.cPf&&this.na.isCreateNew)if(0===(yield this.mdm.W_f()))H.a.$(509162323,829,50,"No Triggering NewDocument designer request in Copilot.");else if(this.rc){var Y=this.ya.presentation;if(!Y)throw Error.argumentNull("Presentation is null");var Sa=this.rc.XK();if(!Sa||0>=Sa.length)H.a.$(512496531,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters is invalid");
else{var Mb="62f939b6-93af-4db8-9c6b-d6c7dfdc589f"===Sa[0].ThemeFamilyId.toLowerCase();Mb&&1!==Sa.length?H.a.$(512496530,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters Length is invalid"):this.na.D7e||Mb?!Y.slides||0>=Y.slides.length?H.a.$(512496528,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes invalid"):Mb&&1!==Y.slides.length?H.a.$(512496527,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes Length for blank theme invalid"):
(Y=null,this.na.xxm&&this.na.sga&&0<this.na.sga.length&&(Y={},Y.TemplateId=this.na.sga),H.a.$(512496526,829,50,"Triggering NewDocument designer request"),this.MIb(og.a.bZa,Y)):H.a.$(512496529,829,50,"Not Triggering NewDocument designer request, themeFamilyId is invalid")}}else H.a.$(512496532,829,15,"Triggering NewDocument designer request failed, PresentationReader invalid");else H.a.$(512496533,829,50,"Not Triggering NewDocument designer request, DesignerNewDocTriggerEnabled:{0}, IsCreateNew:{1}",
this.na.cPf,this.na.isCreateNew)})}Cxk(Y,Sa){this.Rd.Vlo(Sa.XRf)}Ddo(Y,Sa,Mb){var oc=this.ya.Ia;if(!oc)return!0;const Oc=oc.sid;oc=oc.cid;return this.izg?Oc===Sa&&oc===Mb&&(this.LD.isVisible||this.XYe(Y)||this.Rd.N9d)?!1:!0:Oc!=Sa||oc!=Mb||!this.LD.isVisible&&!this.XYe(Y)}zmn(){const Y=document.querySelector("."+Te.oAc);return Y&&(this.RJ.KWe(Y,!1)||this.RJ.KWe(Y,!0))?"Kept":"NotKept"}e3l(Y){const Sa=new N.a;if(Y&&Y.children)for(let Mb=0;Mb<Y.children.length;Mb++){const oc=Y.children[Mb].innerText;
oc&&0<oc.length&&Sa.add(Y.children[Mb].innerText)}return Sa.toArray()}Ljn(Y){if(!Y)return null;var Sa=Y.ra(bd.a.Qhb,null);if(Sa)return Sa.replace("\r","\n").replace("\n\n","\n").split("\n");if(Sa=Y.ra(bd.a.uY,null))if(Sa=this.qE.tFa(Sa))return this.e3l(Sa);if(Sa=Y.ra(bd.a.e2e,null))if(Y=this.qE.tFa(Sa))return this.e3l(Y);return null}getName(){return"DesignerActor"}q1(){}p1(Y){var Sa,Mb;if(this.na.iWa&&Y.actionId===tb.a.yKb&&32===Y.response){var oc=Y.Wc,Oc=Y.actionId;(null===(Sa=this.na)||void 0===
Sa?0:Sa.getBooleanAppSetting("DelayDesignerActionOnPaste"))?(Y=new B.a(0,1,null===(Mb=this.na)||void 0===Mb?void 0:Mb.Ac("TimeDelayForDesignerInBrowserPaste",0),()=>{hj.U8l(oc,Oc,this)},226),n.AFrameworkApplication.Zd.Rb(Y)):hj.U8l(oc,Oc,this)}}static U8l(Y,Sa,Mb){const oc=new qh.a("DesignerActor::invokeDesignerActionOnPaste",tb.a.yKb);null===oc||void 0===oc?void 0:oc.Gf("ST");var Oc=Mb.rb.zd();Oc&&1===Oc.length&&Oc[0].id&&(null===oc||void 0===oc?void 0:oc.Gf("TB_getPastedText"),!(Y=Mb.Ljn(Object(G.a)(98,
Y)))||0>=Y.length||(Oc={},Oc[Je.a.tpm]=Y,null===oc||void 0===oc?void 0:oc.Gf("TA_getPastedText"),Mb.a9f(Sa,Oc),null===oc||void 0===oc?void 0:oc.Gf("TA_handleDesignerRequest"),null===oc||void 0===oc?void 0:oc.hO()))}D7m(Y){switch(Y){case Je.a.FFl:return this.na.AZl;default:return!1}}kon(){this.LD.DB(!0,ah.a.none,2);this.MIb(og.a.ZHh);this.vC.Nsd(3)}ako(Y){switch(Y){case Je.a.FFl:this.bko()}}bko(){if(this.na.lqm)try{const Y=vb.a.instance.eb("Common.ISystemInitiatedFeedback");Y&&(H.a.$(512496525,829,
50,"Floodgate survey for word to presentation triggered"),Y.execute(Sa=>{Sa.logActivity("ConvertWordToPresentationActivity","PowerPointDesignerWordToPptSurveyEnabled")}))}catch(Y){H.a.$(512496524,829,10,"Exception thrown while triggering floodgate survey. Exception: {0}",Y)}}gSn(){this.na.H1h&&(this.LD.isVisible||this.xdm||(this.LD.DB(!0,ah.a.none,2),this.MIb(og.a.iGh),this.vC.Nsd(3),H.a.$(512496523,829,50,"Auto opening designer pane for high confidence agenda")),this.xdm=!0)}static Ssj(){const Y=
document.querySelector("."+Te.oAc);return Y&&Y.getAttribute(Te.xUe)?Y.getAttribute(Te.xUe).toString():null}}Object(c.a)(hj,"DesignerActor",null,[90]);var Pl=a(1252),al=a(1433);class ul{constructor(Y){this.bucketId=Y;this.critiques=[]}}Object(c.a)(ul,"BucketedEditorData",null,[]);class ik{constructor(Y){this.XEi=this.correlationId=this.cod=this.Ncm=null;this.OYe=this.ind=this.KCa=!1;this.Xsh=this.Bsl=null;this.T9l=!1;this.gjd=this.suggestions=this.m8e=this.Jyf=this.fIa=this.Did=this.EVg=this.ELb=this.zqh=
null;this.jAa=0;this.N9d=this.Neg=this.Fnl=this.Tpk=this.oUh=this.eZl=this.vJh=this.wJh=!1;this.X$j=[];this.Lmk=[];this.ztg=Y;this.m2a=w.a.empty;this.yAf=new N.a;this.fjd=new N.a;this.Fkc=new N.a;this.vNh=new N.a;this.ZJb=new N.a;this.YFf=1}bIn(){this.zsd(0,0)}aIn(){this.zsd(1,0)}mqk(){this.zsd(2,4)}zsd(Y,Sa){this.ztg&&this.ztg.execute(Mb=>{const oc=Object.assign(new al.a,{cardId:Pl.a.CAm,actionType:Y,actionEngagement:Sa});Mb.rVh(oc)})}dPl(Y,Sa){this.xZe(Y)||(Array.add(this.X$j,Y),H.a.$(509112540,
829,50,"DesignerContext::AddCurrentSuggestionToClosedList - CorrelationId:{0}, ClosedSuggestionListLength:{1}",Y,this.X$j.length));this.s1k(!Sa)}xZe(Y){return Array.contains(this.X$j,Y)}dIn(Y){Array.add(this.Lmk,Y)}h6n(Y){Array.remove(this.Lmk,Y)}Oyn(Y){return Array.contains(this.Lmk,Y)}get AOi(){return this.cod}t2m(){if(this.cod)return!0;try{const Y=vb.a.instance.Db("PowerPointWebEditor.Proofing.IConsistencyCheckActor");if(Y)return this.cod=Y,!0}catch(Y){H.a.$(509112539,829,15,"error resolving consistencyCheckActor. ex: {0}",
Y)}return!1}Vlo(Y){if(Y){var Sa=[],Mb=new rb.a;for(const oc of Y.critiques){Y=oc.bucketId;let Oc=Mb.ka(Y);Oc||(Oc=new ul(Y),Mb.fa(Y,Oc),Sa.push(Oc));Oc.critiques.push(oc)}this.Ncm=Sa}}get TXa(){return this.Ncm}s1k(Y){this.correlationId="";this.m2a=w.a.empty;this.XEi="";this.OYe=this.ind=this.KCa=!1;this.Xsh=null;this.T9l=!1;this.Did=this.EVg=this.ELb=this.zqh=null;this.yAf.clear();this.m8e=this.Jyf=this.fIa=null;this.YFf=1;this.fjd.clear();this.Fkc.clear();this.vNh.clear();this.ZJb.clear();this.jAa=
0;this.Neg=this.Fnl=this.wJh=this.vJh=this.oUh=this.Tpk=!1;Y&&(this.suggestions=this.gjd=null);this.N9d=!1}}Object(c.a)(ik,"DesignerContext",null,[771]);class nj{constructor(){this.CardData=null;this.DocumentUpsellStatus=0;this.HasPaginationInfo=!1;this.SlideSuggestions=null}}Object(c.a)(nj,"DesignerSuggestions",null,[]);var Eh;(function(Y){Y[Y.init=0]="init";Y[Y.loading=1]="loading";Y[Y.noSuggestion=2]="noSuggestion";Y[Y.showSuggestion=3]="showSuggestion";Y[Y.refreshing=4]="refreshing";Y[Y.sameSlideCoauthNoSuggestion=
5]="sameSlideCoauthNoSuggestion";Y[Y.makeItVisualDrillIn=6]="makeItVisualDrillIn";Y[Y.loadingMoreIdeas=7]="loadingMoreIdeas";Y[Y.moreIdeas=8]="moreIdeas";Y[Y.noSuggestionRibbon=9]="noSuggestionRibbon"})(Eh||(Eh={}));Object(c.b)("DesignerViewState",Eh);class Wh{constructor(){this.suggestions=[]}}Object(c.a)(Wh,"SlideSuggestionNotificationData",null,[]);var ni=a(290),Ql=a(501);class Al{constructor(Y,Sa,Mb){this.ujc=this.$v=!1;Y&&(this.Ogb=Y,this.Ogb.isFeatureEnabled("PowerPointDesigner",!1).then(oc=>
{(this.$v=oc)?H.a.$(507843550,829,50,"DesignerStateManager:: Designer is enabled"):(this.ujc=this.Ogb.isFreemiumUpsellEnabled(),this.isFreemiumUpsellEnabled?Mb?H.a.$(507843553,829,50,"DesignerStateManager:: Usage based Upsell experience is enabled for deisgner"):H.a.$(507843552,829,50,"DesignerStateManager:: Content based Upsell experience is enabled for deisgner"):H.a.$(507843551,829,50,"DesignerStateManager:: Upsell experience is disbaled"));return null}),this.jGn=this.Ogb.UKb("PowerPointDesigner",
Object(h.a)(this,this.PXb,"featureStateChangeCallback")),this.NFn=Sa)}Wkc(){return!this.isEnabled&&this.isFreemiumUpsellEnabled}dispose(){this.Ogb&&(this.Ogb.kec("PowerPointDesigner",this.jGn),this.Ogb=null)}get isEnabled(){return this.$v}get isFreemiumUpsellEnabled(){return this.ujc}launchUpsellExperience(Y){this.Ogb&&this.Ogb.launchUpsellExperience(Y)}PXb(Y){Y&&"PowerPointDesigner"===Y.featureName&&(!this.isEnabled&&Y.isEnabled&&this.NFn(),this.$v=Y.isEnabled)}}Object(c.a)(Al,"DesignerStateManager",
null,[]);class xg{constructor(Y,Sa,Mb){this.$Gn=Y;this.GL=Sa;this.NGn=Mb}toString(){return"SuggestionIndex:"+this.$Gn+" SlideId:"+this.GL+" CreationId:"+this.NGn}}Object(c.a)(xg,"LoggableSourceContext",null,[]);var Sg=a(1636),Bl=a(1233),Yj=a(1251);class jk{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg){this.Lod=this.i$a=!1;this.lpk=0;this.qw=this.p_e=null;this.xa=new Zb.a;this.Cdm=!1;this.SSh=void 0;this.w5d=yh=>{!this.isVisible||yh.keyCode!==la.a.nv&&yh.keyCode!==la.a.P1||this.DB(!1,ah.a.VA,
1)};this.QHb=()=>{this.isVisible&&(H.a.$(509089857,829,50,"DesignerPane::ClosePaneButtonClickHandler - Designer pane close button clicked. CorrelationId:{0}",this.Rd.correlationId),this.DB(!1,ah.a.R6e,1));return!0};this.i$a=fb.a("SvgCloseButton");this.Gb=Y;this.mf=Sa;this.kf=Mb;this.pB=oc;this.la=Oc;this.Rd=nd;this.fT=Cd;this.ud=Zd;this.pT=we;this.kc=Qe;this.Na=kf;this.na=Vf;this.pA=eg;this.EH=Df.tbg;this.RFn=ResourceStrings.L_Designer;this.MW=zg;this.Wb=document.createElement("div");this.Wb.className=
yb.a.JXl;this.Wb.id=Df.tbg;this.Wb.style.position=yc.a.rJa;this.Wb.setAttribute(Fa.a.ii,Fa.a.EHb);this.Wb.setAttribute(Fa.a.nba,yb.a.UIh);this.pc=!1;this.rmc=Ib.a.kg();this.rmc.className="DesignerPaneLayoutRoot";this.i$a&&(this.rmc.style.display=yc.a.H1);this.Wb.appendChild(this.rmc);Y=n.AFrameworkApplication.ha.Ma("PPTFabricIconDiamondCssUrl");Sa=document.createElement("link");Sa.setAttribute("rel","stylesheet");Sa.setAttribute("type","text/css");Sa.setAttribute("href",Y);this.Wb.appendChild(Sa);
this.Gb.lXa(Object(h.a)(this,this.s1,"onSetOffline"))}dispose(){this.hfa();this.Wb.removeChild(this.rmc);this.Gb.bLb(Object(h.a)(this,this.s1,"onSetOffline"));H.a.$(509089863,829,50,"DesignerPane::Dispose")}initialize(){this.i$a||(this.qw=jk.TCc(this.mf),Sys.UI.DomElement.addCssClass(this.qw,"DesignerPaneCloseButton"),this.qw.setAttribute(Fa.a.ii,Fa.a.fM),this.rmc.appendChild(this.qw));this.p_e=Ib.a.kg();this.p_e.id=yb.a.UIh;this.p_e.className=yb.a.UIh;this.p_e.innerText=this.RFn;this.rmc.appendChild(this.p_e);
this.i$a&&(this.qw=jk.aVe(),Sys.UI.DomElement.addCssClass(this.qw,"DesignerPaneCloseButtonNew"),this.rmc.appendChild(this.qw));this.kf.Ub(Z.a.click,this.qw,this.QHb);this.pB.addHandler(this.qw,Z.a.oi,this.w5d);this.fT.nYa(this.S2l(),fc.a.Wl,this.Wb,Y=>{Y===this.Na.Uc(fc.a.J1)&&this.qw?this.y0(!0):fb.a("DesignerPaneArrowKeyFocusFix")?this.$fa(!1):this.$fa(!0)},()=>{this.$fa(!1)});this.ud.Sva(Object(h.a)(this,this.tF,"onUnifiedAppStateChanged"));this.ud.eI(Object(h.a)(this,this.cxa,"onPodSessionRehydrated"));
this.pT.Qjc(Object(h.a)(this,this.cxa,"onPodSessionRehydrated"));H.a.$(509089862,829,50,"DesignerPane::Initialize")}S2l(){return fc.a.qqa}hfa(){this.kf&&0<this.rmc.childNodes.length&&(this.kf.hc(Z.a.click,this.qw,this.QHb),this.pB.removeHandler(this.qw,Z.a.oi,this.w5d),this.rmc.removeChild(this.p_e),this.rmc.removeChild(this.qw));this.ud.sec(Object(h.a)(this,this.tF,"onUnifiedAppStateChanged"));this.ud.Tna(Object(h.a)(this,this.cxa,"onPodSessionRehydrated"));this.pT.G7c(Object(h.a)(this,this.cxa,
"onPodSessionRehydrated"));this.Na.currentScope&&this.Na.currentScope.name===fc.a.qqa&&this.Na.Gm(fc.a.qqa,!1)}tF(Y,Sa){Sa.$sb&&!this.kc.oq&&this.isVisible&&(H.a.$(509089861,829,50,"DesignerPane::OnUnifiedAppStateChanged - Switching to read-only mode and Designer pane is opened. CorrelationId:{0}",this.Rd.correlationId),this.DB(!1,ah.a.R6e,2))}s1(Y){Y&&this.isVisible&&this.DB(!1,ah.a.R6e,2)}cxa(){H.a.$(509089860,801,50,"Designer Pane is closed because session is rehydrated.");this.DB(!1,ah.a.I$n,
2)}layout(Y,Sa){const Mb=Sa?Y.$Q(this.width):Y.aR(this.width);this.isVisible&&(Sa?(Sys.UI.DomElement.addCssClass(this.Wb,yb.a.NYi),Mb.$Q(yb.a.TIh)):(Sys.UI.DomElement.addCssClass(this.Wb,yb.a.MYi),Mb.aR(yb.a.TIh)));Ib.a.kga(this.Wb,Mb,!1);return Y}DB(Y,Sa,Mb){if(!((this.na.SYe||this.na.TYe)&&Y&&2==Mb&&this.Cdm||this.pc===Y)){if(this.na.SYe||this.na.TYe)Y||2!=this.SSh||1!=Mb||(this.Cdm=!0),this.SSh=Y?Mb:void 0;this.pc=Y;Mb=this.na.KYi||this.id!==Df.tbg?Je.a.Jom:Df.Ctn;Y?(Sa={},Sa[Mb]=!0,this.pA.erh(Oi.c(Sa)),
this.initialize(),this.Wb.style.display=yc.a.H1,this.Rd.bIn(),H.a.$(509089859,829,50,"DesignerPane::SetIsVisible - Set to visible")):(Y={},Y[Mb]=!1,this.pA.erh(Oi.c(Y)),this.hfa(),this.Wb.style.display=yc.a.Uf,this.zfo(Sa)||(this.Rd.Xsh=new Date,1===this.lpk&&(this.Rd.OYe=!0),this.la.Ra(tb.a.lib,2,new Yj.a(!0,Sa))),this.Rd.aIn(),H.a.$(509089858,829,50,"DesignerPane::SetIsVisible - Set to not visible"));this.epi(this.Wb);Sa=ResourceStrings.L_Designer;this.MW.M9(this,this.pc,this.id===Df.tbg?Sa:ResourceStrings.L_ShowHideDesignerPane,
this.S2l());this.pc&&this.Rd.Neg&&fb.a("DesignerFocusChatPPT")&&this.la.Eb(tb.a.$Ha,2,null)}}epi(Y){n.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(Y,yb.a.NYi):Sys.UI.DomElement.addCssClass(Y,yb.a.MYi)}zfo(Y){return Y===ah.a.HUl||this.isVisible&&Y===ah.a.R6e}$fa(Y){Y?this.xa.raiseEvent("OnDesignerPaneFocusOn"):this.xa.raiseEvent("OnDesignerPaneFocusBlur")}Iti(Y){this.xa.addHandler("OnDesignerPaneFocusOn",Y)}eZk(Y){this.xa.removeHandler("OnDesignerPaneFocusOn",Y)}Jti(Y){this.xa.addHandler("OnDesignerPaneFocusBlur",
Y)}fZk(Y){this.xa.removeHandler("OnDesignerPaneFocusBlur",Y)}T8l(){2==this.SSh&&(this.SSh=void 0)}y0(Y){(this.Lod=Y)&&this.qw.focus()}get AGb(){return this.lpk}set AGb(Y){this.lpk=Y}uHe(Y){this.setFocus("#"+this.id+" ."+tf.yjm+":nth-child("+Y+") > ."+tf.i1e)}xao(){this.setFocus("#"+tf.ZTd)}wao(){this.setFocus("#"+tf.SVe)}BZh(Y){this.setFocus("."+tf.okd+"["+Df.nkd+'="'+Y+'"')}uao(){this.setFocus("."+tf.TRf)}vao(){this.setFocus("."+tf.YRf)}setFocus(Y){(Y=document.querySelector(Y))&&Cb.FocusManager.vz(Y)}get isVisible(){return this.pc}get BNc(){return this.Lod}get va(){return this.Wb}get order(){return 7}get id(){return this.EH}get width(){let Y=
0;this.isVisible&&(Y=yb.a.KXl,Y+=yb.a.TIh+Nb.a.sGa);return Y}static TCc(Y){return jk.ykc(Y,"per","cui-img-16by16","cui-ctl-iconContainer","ClosePaneGlyph_16x16x32",CommonUIStrings.l_DialogClose,null)}static aVe(){const Y=document.createElement(Ib.a.lAc);Y.type="button";Y.setAttribute(Fa.a.IA,CommonUIStrings.l_DialogClose);Y.appendChild(Object(ob.b)(ob.a,20,20).va);Y.className="SvgCloseButton";return Y}static ykc(Y,Sa,Mb,oc,Oc,nd,Cd){const Zd=Ib.a.LK();Zd.alt=nd;Zd.className=Ca.e(Sa,Oc);Zd.src=Y.Eq(Sa+
".png");Zd.setAttribute("Unselectable","on");Y=Ib.a.yy();Y.className=Mb+" cui-img-cont-float";Y.appendChild(Zd);Mb=Ib.a.yy();Mb.className=oc;Mb.setAttribute("Unselectable","on");Mb.appendChild(Y);oc=Ib.a.s3a();oc.className="cui-ctl DesignerPaneButton";oc.title=nd;oc.setAttribute(Fa.a.ii,Fa.a.fM);oc.tabIndex=0;oc.appendChild(Mb);Cd&&(nd=Ib.a.yy(),nd.className="cui-ctl-mediumlabel",nd.setAttribute("Unselectable","on"),nd.innerText=Cd,oc.appendChild(nd));return oc}}Object(c.a)(jk,"DesignerPane",null,
[767,488,40]);class vf{constructor(Y,Sa,Mb,oc,Oc,nd){this.i$a=!1;this.TTh=this.hrg=this.k0e=this.ou=null;this.lfk=this.Tgg=!1;this.Ymk=null;this.i$a=fb.a("SvgCloseButton");this.na=Sa;this.la=Y;this.OFn=nd;this.kf=oc;this.pB=Oc;this.Sdm=$a.a.hb(la.a.RZa,0);this.la.Ba(tb.a.uCl,u.a.frame,Object(h.a)(this,this.q1m,"closeCallout"));this.LIa=Ib.a.kg();this.LIa.className="GoPremiumCalloutContainer";Y=document.createElement("i");Y.className=Te.hHh+" GoPremiumIcon";Y.setAttribute(Fa.a.ii,Fa.a.pV);Y.setAttribute("Unselectable",
"on");Y.setAttribute(Fa.a.CK,Fa.a.iE);this.i$a?(Mb=document.createElement("div"),Mb.className="GoPremiumHeader",Mb.appendChild(Y),this.mmc=jk.aVe(),Sys.UI.DomElement.addCssClass(this.mmc,"GoPremiumCalloutCloseNew"),Mb.appendChild(this.mmc),this.LIa.appendChild(Mb)):(this.mmc=jk.TCc(Mb),Sys.UI.DomElement.addCssClass(this.mmc,"GoPremiumCalloutClose"),this.mmc.setAttribute(Fa.a.ii,Fa.a.fM),this.LIa.appendChild(this.mmc),this.LIa.appendChild(Y));this.m_title=Ib.a.kg();this.m_title.className="GoPremiumTitle";
this.LIa.appendChild(this.m_title);this.p_=Ib.a.kg();this.p_.className="GoPremiumSubtitle";this.LIa.appendChild(this.p_);this.H5b=Ib.a.kg();this.H5b.className="GoPremiumButton";Mb=Ib.a.yy();Mb.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Mb.setAttribute("Unselectable","on");Mb.setAttribute(Fa.a.CK,Fa.a.iE);this.H5b.appendChild(Mb);this.H5b.tabIndex=0;this.H5b.setAttribute(Fa.a.IA,Mb.innerText);this.H5b.setAttribute(Fa.a.ii,Fa.a.fM);this.LIa.appendChild(this.H5b);this.Oz()}show(Y,Sa,Mb,
oc,Oc,nd){this.oU&&this.dismiss();this.k0e=oc;this.hrg=Sa;this.TTh=Oc;this.Ymk=nd;this.k0e&&Sys.UI.DomElement.addCssClass(this.k0e,this.TTh);Mb?(this.m_title.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutTitle,this.p_.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutContent):(this.m_title.innerText=ResourceStrings.l_DesignerUpsellCalloutTitle,this.p_.innerText=ResourceStrings.l_DesignerUpsellCalloutContent);Sa.setAttribute(Fa.a.fkc,Fa.a.iE);this.na.E2i?this.ou=new Bl.a(Y,document.body,
n.AFrameworkApplication.Ha.L0,null):(this.ou=Sg.a.DLf(Y,document.body,document.body,2,Object(h.a)(this,this.dismiss,"dismiss")),this.ou.p7e=120);this.ou.Vea=310;this.LIa.setAttribute(Fa.a.IA,String.format("{0}. {1}",this.m_title.innerText,this.p_.innerText));this.LIa.setAttribute(Fa.a.ii,Fa.a.EHb);this.pB&&this.pB.addHandler(this.LIa,Z.a.oi,Object(h.a)(this,this.w5d,"inputKeyPressHandler"));this.ou.content=this.LIa;this.Nva();Sa=new Sys.UI.Bounds(0,0,ya.a.R1d(),ya.a.Wld());this.ou.J2=this.$dj(Sa,
Y,240,Mb);this.ou.Vw=!1;this.ou.vqd=()=>{fb.a("CalloutCrashFix")&&!this.ou?H.a.$(507605718,829,15,"PremiumContentCallout::m_callout is null."):(this.LIa.parentNode&&Sys.UI.DomElement.addCssClass(this.LIa.parentNode,"GoPremiumCalloutContentContainer"),this.ou.dO&&(Sys.UI.DomElement.addCssClass(this.ou.dO,"GoPremiumCalloutOuter"),this.ou.dO.removeAttribute(Fa.a.ii),this.na.E2i||(this.ou.dO.style.zIndex=String(n.AFrameworkApplication.Ha.Fjc))),this.ou.O5e(),this.f6(this.H5b),this.Tgg=!0)};this.ou.show()}Nva(){if(Cb.FocusManager.iP()){var Y=
Cb.FocusManager.instance(),Sa=Y.Uc("callout/modal");Sa.parent=fc.a.Wl;Y.kTe("callout/modal",fc.a.Wl,this.LIa);Y.haa("callout/modal",!1);Sa.bindAction(this.Sdm,tb.a.uCl);Sa=new ze.DOMFocusListing(()=>this.LIa);Sa.WKb=!0;Sa.Xq(2);Y=Y.Upa(()=>this.LIa,Y.Uc("callout/modal"),Sa);Y.XKb();Y.J3=!0;Y.vfb=!0}}foc(){if(Cb.FocusManager.iP()&&!n.AFrameworkApplication.Ch){const Sa=Cb.FocusManager.instance();var Y=Sa.Uc("callout/modal");Y&&Y.kD(this.Sdm);Sa.$da("callout/modal");(Y=Sa.YX("callout/modal"))&&Y.fm.qO(null);
Sa.hoc("callout/modal")}}f6(Y){Cb.FocusManager.iP()?Cb.FocusManager.instance().YX("callout/modal").fm.G4a(Y):Y.focus()}get oU(){return!!this.ou&&this.ou.oU}Ppn(){this.oU&&(this.Tgg?this.mmc.focus():this.H5b.focus(),this.Tgg=!this.Tgg)}AYl(){this.dismiss();return!0}q1m(){this.dismiss();return 32}dismiss(){if(!this.lfk){this.lfk=!0;try{this.foc(),this.hrg&&(this.hrg.setAttribute(Fa.a.fkc,Fa.a.Npa),Cb.FocusManager.vz(this.hrg),this.hrg=null),this.k0e&&(Sys.UI.DomElement.removeCssClass(this.k0e,this.TTh),
this.k0e=null),this.Ymk=this.TTh=null,this.Tgg=!1,this.ou&&(this.ou.dismiss(),this.ou.dispose(),this.ou=null),this.pB&&this.pB.removeHandler(this.LIa,Z.a.oi,Object(h.a)(this,this.w5d,"inputKeyPressHandler"))}finally{this.lfk=!1}}}dispose(){this.dismiss();this.wJa();this.LIa=this.mmc=this.H5b=null}w5d(Y){if(Y.keyCode===la.a.nv||Y.keyCode===la.a.P1){Y.preventDefault();Y=document.activeElement;try{Y?Y.click():H.a.$(508372757,829,15,"PremiumContentCallout::InputKeyPressHandler active element is null.")}catch(Sa){H.a.$(508372756,
829,15,"PremiumContentCallout::InputKeyPressHandler Exception: {0}",Sa)}}}Olm(){this.OFn(this.Ymk);return!0}Oz(){this.kf?(this.kf.Ub(Z.a.click,this.mmc,Object(h.a)(this,this.AYl,"dismissAndReturn")),this.kf.Ub(Z.a.click,this.H5b,Object(h.a)(this,this.Olm,"onGoPremiumClicked"))):H.a.$(508372755,829,50,"PremiumContentCallout::RegisterEvents ClickInputManager or KeyInputManager is null. Couldn't register events on the goPremiumButton")}wJa(){this.kf&&(this.kf.hc(Z.a.click,this.mmc,Object(h.a)(this,this.AYl,
"dismissAndReturn")),this.kf.hc(Z.a.click,this.H5b,Object(h.a)(this,this.Olm,"onGoPremiumClicked")))}$dj(Y,Sa,Mb,oc){if(oc)return 0;oc=6;Sa.y-Y.y<Mb&&(oc=3);return oc}}Object(c.a)(vf,"PremiumContentCallout",null,[]);class hi{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd){this.wVe=Y;this.ean=Sa;this.QJh=Mb;this.ni=oc;this.DLb=Oc;this.nWd=nd;this.Nkl=Cd;this.o2h=Zd}}Object(c.a)(hi,"RenderSuggestionsArgs",null,[1E3]);class Ml extends Sys.EventArgs{constructor(Y){super();this.card=Y}}Object(c.a)(Ml,"ClickSuggestedActionEventArgs",
Sys.EventArgs,[]);class bl extends Sys.EventArgs{constructor(Y){super();this.Tbe=Y}}Object(c.a)(bl,"DesignerClickMoreIdesEventArgs",Sys.EventArgs,[]);class lh extends Sys.EventArgs{constructor(Y,Sa){super();this.X9n=Y;this.Gho=Sa}}Object(c.a)(lh,"DesignerClickSuggestionEventArgs",Sys.EventArgs,[]);class oi extends ni.a{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg){super(new Ql.a,Y,nd);this.Hfe=this.Ife=this.Mwa=this.t8a=this.itg=this.LYa=null;this.Jem=this.Lem=0;this.Qwa=!1;this.wim=this.xWc=
this.RD=null;this.wJb=0;this.LD=Mb;this.RJ=oc;this.Rd=Oc;this.Na=Cd;this.kf=Zd;this.mf=Sa;this.dD=we;this.pB=Qe;this.la=kf;this.Oe=Vf;this.na=eg;this.TEm=this.na.xpc;this.UIa=new Ja.a(()=>new vf(this.la,this.na,Sa,Zd,Qe,Object(h.a)(this,this.w5l,"goPremiumExperience")));this.zdm=new Al(zg,Object(h.a)(this,this.LPn,"onAccountUpgrade"),eg.mEc);this.vsa=new vh;this.SEn=Object.assign(new rk(kf,this.vsa,this.na),{XZ:tb.a.Llc})}dispose(){this.Qwa&&this.iUl();this.RD&&(this.RD.dispose(),this.RD=null);this.UIa.w3d&&
this.UIa.value.dispose();super.dispose();H.a.$(512496477,829,50,"DesignerView::Dispose")}i5d(){this.LYa=Ib.a.kg();this.LYa.className="DesignerViewContainer";this.container.appendChild(this.LYa);this.Qwa=!0;H.a.$(512496476,829,50,"DesignerView::InitializeView")}iUl(){this.na.eSf&&this.RJ.H0m();if(this.LYa.children&&0<this.LYa.children.length)for(const Y=0;Y<this.LYa.children.length;)this.LYa.removeChild(this.LYa.children[Y]);this.LD.AGb=0;this.LD.eZk(Object(h.a)(this,this.onFocus,"onFocus"));this.LD.fZk(Object(h.a)(this,
this.Ilm,"onFocusBlur"));this.UIa.w3d&&this.UIa.value.dismiss();H.a.$(512496475,829,50,"DesignerView::CleanUpView")}Nsd(Y){H.a.$(512496474,829,50,"DesignerView.SetViewState. CorrelationId:{0}, ViewState:{1}",this.Rd.correlationId,Eh[Y]);this.LX();4!==Y&&7!==Y&&8!==Y&&(this.iUl(),this.LYa.id=this.Rd.correlationId);this.LD.AGb=Y;switch(this.LD.AGb){case 1:this.kun();this.aco();break;case 7:this.$bo();break;case 2:this.oun();break;case 9:this.nun();break;case 5:this.xun();break;case 3:this.yun();break;
case 6:this.lun();break;case 4:if(Y=document.querySelectorAll(".DesignerSuggestionListDisabled"))for(let Sa=0;Sa<Y.length;Sa++)Y[Sa].style.visibility=hc.a.visible,Y[Sa].setAttribute(Te.CEi,Te.aTl);this.na.getBooleanAppSetting("DesignerDisableMoreIdeasOnRefreshEnabled")&&(Y=document.querySelector("."+Te.gHh))&&(Y.style.backgroundColor="transparent",Y.style.pointerEvents="none",Y.style.border="1px solid #a19f9d",Y.style.color="#a19f9d",Y.setAttribute("disabled",!0))}this.LD.Iti(Object(h.a)(this,this.onFocus,
"onFocus"));this.LD.Jti(Object(h.a)(this,this.Ilm,"onFocusBlur"))}Wkc(){return this.na.QYi&&this.zdm.Wkc()}w5l(Y){this.na.QYi&&(H.a.$(512496473,829,50,"DesignerView::GoPremiumExperience SourceContext:{0}",Y?Y.toString():""),this.UIa.w3d&&this.UIa.value.dismiss(),this.zdm.launchUpsellExperience(this.na.mEc?"designertrial":"designer"))}startFreeTrial(){this.UIa.w3d&&this.UIa.value.dismiss();this.RJ.yjo();this.Rd.Fnl=!0;this.HU(0,!0);H.a.$(512496472,829,50,"DesignerView::StartFreeTrial Free Trial started")}LPn(){H.a.$(512496471,
829,50,"DesignerView::OnAccountUpgrade Account has been upgraded");this.UIa.w3d&&this.UIa.value.dismiss();this.RJ.olo()}kun(){this.itg=Ib.a.kg();this.itg.className="DesignerLoadingView";const Y=Ib.a.LK();Y.className=n.AFrameworkApplication.isRtl?"DesignerLoadingViewSpinnerRTL":"DesignerLoadingViewSpinner";Y.src=ed.a.NX(yb.a.mZa);const Sa=Ib.a.kg();Sa.className=n.AFrameworkApplication.isRtl?"DesignerLoadingViewTextRTL":"DesignerLoadingViewText";Sa.innerText=ResourceStrings.L_DesignerLoading;this.itg.appendChild(Y);
H.a.$(512496470,829,50,"DesignerView::spinner shows up");this.itg.appendChild(Sa);this.LYa.appendChild(this.itg);H.a.$(512496469,829,50,"DesignerView::InitLoadingState")}pun(){const Y=Ib.a.kg();Y.className="DesignerNoSuggestionNewButton";Y.tabIndex=0;Y.innerText=ResourceStrings.L_DesignerLearnMoreShort;Y.setAttribute("Unselectable","on");Y.setAttribute(Fa.a.IA,Y.innerText);Y.setAttribute(Fa.a.ii,Fa.a.fM);Y.setAttribute("href",yb.a.LYi);this.kf.Ub(Z.a.click,Y,Object(h.a)(this,this.yUl,"clickSuggestionLinkHandler"));
this.t8a.appendChild(Y)}mun(){const Y=Ib.a.s3a();Y.className="DesignerNoSuggestionView-Link";Y.setAttribute("href",yb.a.LYi);Y.setAttribute("target","_blank");Y.innerText=ResourceStrings.L_DesignerLearnMore;Y.tabIndex=0;Y.setAttribute(Fa.a.ii,Fa.a.CGh);this.t8a.appendChild(Y);this.kf.Ub(Z.a.click,Y,Object(h.a)(this,this.yUl,"clickSuggestionLinkHandler"))}oun(){this.LD.isVisible&&(this.yIj(!1),this.Ife.innerText=ResourceStrings.L_DesignerNoSuggestionHeader,this.Hfe.innerText=ResourceStrings.L_DesignerNoSuggestionContent,
H.a.$(512496468,829,50,"DesignerView::InitNoSuggestionState"))}nun(){this.LD.isVisible&&(this.yIj(!0),this.Ife.innerText=ResourceStrings.L_DesignerNoIdeasHeader,this.Hfe.innerText=ResourceStrings.L_DesignerNoIdeas,H.a.$(512496467,829,50,"DesignerView::InitNoSuggestionState"))}xun(){this.LD.isVisible&&(this.yIj(!1),this.Ife.innerText=ResourceStrings.L_DesignerCoauthorHeader,this.Hfe.innerText=ResourceStrings.L_DesignerCoauthorContent,H.a.$(512496466,829,50,"DesignerView::InitSameSlideCoauthNoSuggestionState"))}yIj(Y){this.t8a=
Ib.a.kg();this.t8a.className=n.AFrameworkApplication.isRtl?"DesignerNoSuggestionViewRTL":"DesignerNoSuggestionView";this.Ife=Ib.a.kg();this.Hfe=Ib.a.kg();this.RJ.Yum(this.LYa);if(Y){this.Ife.className="DesignerNoSuggestionNew-Header";this.Hfe.className="DesignerNoSuggestionNew-Content";const Sa=Ib.a.LK();Sa.src=this.mf.Eq("DesignerNoIdeas.svg");Sa.className="DesignerNoIdeasIllustration";this.t8a.appendChild(Sa)}else this.Ife.className="DesignerNoSuggestionView-Header",this.Hfe.className="DesignerNoSuggestionView-Content";
this.t8a.appendChild(this.Ife);this.t8a.appendChild(this.Hfe);Y?this.pun():this.mun();this.LYa.appendChild(this.t8a);this.pB.addHandler(this.t8a,Z.a.oi,Object(h.a)(this,this.w5d,"inputKeyPressHandler"))}yun(){this.LD.isVisible||this.LD.DB(!0,ah.a.none,2);this.Mwa=Ib.a.kg();const Y=this.TEm?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",Sa=this.TEm?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";this.Mwa.className=n.AFrameworkApplication.isRtl?Sa:Y;this.LYa.appendChild(this.Mwa);
this.na.OYi||(this.Na.Gm(fc.a.qqa,!0),this.Na.ee());this.kf.Ub(Z.a.click,this.Mwa,Object(h.a)(this,this.g1m,"clickSuggestionHandler"));this.pB.addHandler(this.Mwa,Z.a.oi,Object(h.a)(this,this.FNh,"inputKeyApplyHandler"));this.dD.Ub(Z.a.ZO,this.Mwa,Object(h.a)(this,this.i0,"onPointerOver"));this.dD.Ub(Z.a.IQ,this.Mwa,Object(h.a)(this,this.h0,"onPointerOut"));H.a.$(512496465,829,50,"DesignerView::InitShowSuggestionState")}Ykn(){return this.u6f(this.Mwa.querySelector("#"+this.$D.id+" .DesignerSuggestionResultSelected"))}Jhn(){return this.u6f(this.Mwa.querySelector("#"+
this.$D.id+" ["+Te.mNd+"]:hover"))}u6f(Y){let Sa;return(()=>{let Mb=this.N4l(Y);({suggestionIndex:Sa}=Mb);return Mb})().returnValue?parseInt(Sa):-1}N4l(Y){let Sa,Mb,oc;oc=Mb=Sa="";if(Y){const Oc=Y.getAttribute(Te.uAc),nd=Y.getAttribute(Te.mNd);if(!Oc||!nd)return H.a.$(512496464,829,10,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion index and slideId, CorrelationId: {0}",this.Rd.correlationId),{returnValue:!1,suggestionIndex:Sa,slideId:Mb,Fll:oc};Sa=Oc.toString();Mb=nd.toString();
(Y=Y.getAttribute(Te.jHh))?oc=Y.toString():H.a.$(512496463,829,15,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion slide creationId, CorrelationId: {0}",this.Rd.correlationId);return{returnValue:!0,suggestionIndex:Sa,slideId:Mb,Fll:oc}}return{returnValue:!1,suggestionIndex:Sa,slideId:Mb,Fll:oc}}rXe(){return this.Mwa.querySelectorAll("#"+this.$D.id+" ["+Te.uAc+"]").length}yUl(Y){return this.LD.isVisible&&Y&&Y.Wj?this.y5l(Y.Wj.className):!1}JIb(){const Y=this.na.xpc?"DesignerShowSuggestionViewWide":
"DesignerShowSuggestionView",Sa=this.na.xpc?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";return this.container.querySelector("."+(n.AFrameworkApplication.isRtl?Sa:Y))}f1m(Y){Y=Y.getAttribute(Te.uAc).toString();Y=this.Rd.gjd[parseInt(Y)];if(!Y||3!==Y.Type&&4!==Y.Type)return!1;this.Oe.gsm(new Ml(Y));return!0}qKh(Y,Sa){for(;Y&&Y.className!==Sa;)Y=Y.parentNode;return Y}g1m(Y){if(!this.LD.isVisible||Y.sE!==Sys.UI.MouseButton.leftButton||!this.RJ.Ia||!Y.Hc)return!1;var Sa=Y.Hc;try{if(Sa.className){if(Sa.className===
tf.i1e||Sa.className===tf.j1e||Sa.className===tf.vsk||Sa.className===tf.CUh)return this.d1m(Sa);if(Sa.className.startsWith(tf.kZl))return this.c1m(Sa)}else H.a.$(512496462,829,15,"DesignerView::ClickSuggestionHandler ClassName is null")}catch(eg){return H.a.$(512496461,829,15,"DesignerView::ClickSuggestionHandler unexpected exception: {1}",Sa.className,eg.message),!1}var Mb=this.qKh(Sa,Te.fTl);if(Mb)return this.f1m(Mb);if(this.Wkc()){if(Sa.className===Te.yUe)return this.startFreeTrial(),!0;if(Sa.className===
Te.aEf)return Y=Lb.a.ji(Sa),this.UIa.value.show(Y,Sa,!0,Sa,"DesignerInFreeTrialViewGoPremiumTextSelected",null),!0;(Mb=this.qKh(Sa,Te.$Df))||(Mb=this.qKh(Sa,Te.cHh));if(Mb)return this.w5l(null),!0}if(this.na.fIb&&(Mb=this.qKh(Sa,Te.gHh))){this.RJ.aNh(this.JIb());if(!Mb.getAttribute(Te.xUe))return!1;this.RJ.Meo(this.JIb());Sa=new bl(Mb.getAttribute(Te.xUe).toString());this.Oe.jsm(Sa);return!0}if(Sys.UI.DomElement.containsCssClass(Sa,"ms-Icon--Diamond")){if(Sa=Sa.parentNode,!Sa)return!1}else if(!(Sys.UI.DomElement.containsCssClass(Sa,
Te.iHh)||Sys.UI.DomElement.containsCssClass(Sa,Te.AEf)||Sys.UI.DomElement.containsCssClass(Sa,Te.kHh)||(Sa=Sa.firstChild,Sa)))return!1;const oc=Sa.parentNode;Mb=document.querySelector("#"+this.$D.id+" ."+Te.oAc);let Oc,nd,Cd;if(!(()=>{let eg=this.N4l(oc);({suggestionIndex:Oc,slideId:nd,Fll:Cd}=eg);return eg})().returnValue)return!1;var Zd=parseInt(Oc),we=parseInt(nd),Qe=parseInt(Cd)||0,kf=this.Rd.m2a.sid===we;Object(fb.a)("DesignerPaneArrowKeyFocusFix")&&(this.wJb=Zd,this.HU(Zd,!0));this.na.fIb&&
(kf=this.RJ.KWe(Mb,!1)===oc||this.RJ.KWe(Mb,!0)===oc);if(kf)return H.a.$(512496460,829,50,"DesignerView::ClickSuggestionHandler clicked the applied suggestion"),this.Oe.sPk(new lh(Zd,this.rXe())),!1;if(oc&&oc.getAttribute(Te.fHh)){Sa=null;Y=oc.childNodes;for(Mb=0;Mb<Y.length;Mb++)if(Zd=Y[Mb],Sys.UI.DomElement.containsCssClass(Zd,Te.iHh)){Sa=Zd;break}Y=new xg(Oc,nd,Cd);Sa=Lb.a.ji(Sa||oc);this.UIa.value.show(Sa,oc,!1,null,null,Y);return!1}if(Sys.UI.DomElement.containsCssClass(Sa,Te.kHh))return!1;kf=
this.Okn(Sa,we,Qe);we=Object.assign(new Ik,{SuggestionCid:Qe,SuggestionSid:we,CorrelationId:Mb.getAttribute("correlationId").toString(),ActiveSlideCid:this.RJ.Ia.cid,ActiveSlideSid:this.RJ.Ia.sid});Qe=Sa;Qe=.01>=Math.abs(Qe.width/Qe.height-1.33);let Vf=void 0;this.RJ.KWe(Mb,Qe)?(this.RJ.hUl(Mb,Qe),kf&&kf.parentNode&&kf.parentNode.parentNode&&this.RJ.hUl(kf.parentNode.parentNode,Qe),Vf=tb.a.xTb,this.la.Ra(Vf,2,we),H.a.$(512496459,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestionMultiple")):
(Vf=tb.a.WHa,this.la.Ra(Vf,2,we),H.a.$(512496458,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestion"));Object(fb.a)("DesignerInteractivePerfTrackingEnabled")&&Bd.ActionManager.VC(Y.Pb.rawEvent,Bd.ActionManager.oS?Bd.ActionManager.oS(Vf):"",void 0);this.na.GXl&&oc&&oc.getAttribute(Te.IDi)&&vb.a.instance.eb("Common.ISystemInitiatedFeedback").execute(eg=>{try{eg.logActivity("DesignerAnimationSuggestion",null)}catch(zg){H.a.$(512496457,829,10,"Designer Animation Suggestion teaching UI failed with exception: {0}",
zg)}});this.RJ.Mxm(Sa.parentNode,Qe);kf&&this.RJ.Mxm(kf.parentNode,Qe);this.RJ.Pwm(this.LYa,Zd);this.Oe.sPk(new lh(Zd,this.rXe()));return!0}Okn(Y,Sa,Mb){var oc="["+Te.mNd+'="'+Sa+'"] > .'+Te.AEf;Mb&&(oc=String.format('[{0}="{1}"][{2}="{3}"] > .{4}',Te.mNd,Sa,Te.jHh,Mb,Te.AEf));Sa=document.querySelectorAll(oc);if(!Sa)return null;for(Mb=0;Mb<Sa.length;Mb++)if(oc=Sa[Mb],oc!==Y)return oc;return null}w5d(Y){this.LD.isVisible&&(Y.keyCode!==la.a.nv&&Y.keyCode!==la.a.P1||this.y5l(Y.target.className))}FNh(Y){if(this.LD.isVisible){if(Y.keyCode===
la.a.nv||Y.keyCode===la.a.P1){Y.preventDefault();Y.stopPropagation();var Sa=document.activeElement;Sa&&Sa.click()}Object(fb.a)("DesignerPaneArrowKeyFocusFix")&&(Y.keyCode==la.a.HY&&(Y.preventDefault(),Y.stopPropagation(),Sa=0>this.wJb-1?0:this.wJb-1,Object(fb.a)("DesignerPaneFocusFix")||(this.wJb=0>this.wJb-1?0:this.wJb-1),this.HU(Sa,!0)),Y.keyCode==la.a.N1&&(Y.preventDefault(),Y.stopPropagation(),Y=this.rXe(),Sa=this.wJb+1<Y?this.wJb+1:Y-1,Object(fb.a)("DesignerPaneFocusFix")||(this.wJb=this.wJb+
1<Y?this.wJb+1:Y-1),this.HU(Sa,!0)))}}HU(Y,Sa){if(!(0>Y)){var Mb=this.Mwa.querySelector("["+Te.uAc+'="'+Y+'"]');Mb?Sa&&(Cb.FocusManager.vz(Mb),this.RJ.Pwm(this.LYa,Y),Object(fb.a)("DesignerPaneFocusFix")&&(this.wJb=Y)):H.a.$(512496456,829,15,"DesignerView::SetSuggestionItemFocus, suggestionItem {0} is null",Y)}}l5l(){return this.Wkc()?this.Mwa.querySelector("."+Te.aEf)?2:this.Mwa.querySelector("."+Te.yUe)?1:this.Mwa.querySelector("."+Te.$Df)?3:0:0}cam(){return!!this.Mwa.querySelector("."+Te.yUe+":focus")}Ekh(Y){const Sa=
this.Mwa.querySelector("."+Te.yUe);Sa?Y?Cb.FocusManager.vz(Sa):Sa.blur():H.a.$(512496455,829,15,"DesignerView::SetStartFreeTrialFocus, StartFreeTrial Button is not present")}A6l(){this.wam()&&this.UIa.value.Ppn()}wam(){return this.UIa.w3d&&this.UIa.value.oU}pzn(Y){return Y?!!Y&&(Y.className===Te.yUe||Y.className===Te.cHh||Y.className===Te.aEf||Y.className===Te.$Df):!1}Ifc(Y,Sa){let Mb=null;1===Sa?Mb=this.Mwa.querySelector("."+Te.cHh):2===Sa?Mb=this.Mwa.querySelector("."+Te.aEf):3===Sa&&(Mb=this.Mwa.querySelector("."+
Te.$Df));Mb?Y?Cb.FocusManager.vz(Mb):Mb.blur():H.a.$(512496454,829,15,"DesignerView::SetGoPremiumFocus, Go Premium Button is not present for {0} for upsell View State",Sa)}Rbo(Y,Sa){(Sa=9===Sa?this.t8a.querySelector(".DesignerNoSuggestionNewButton"):this.t8a.querySelector(".DesignerNoSuggestionView-Link"))?Y?Sa.focus():Sa.blur():H.a.$(512496453,829,15,"DesignerView::SetSuggestionLinkFocus, Can't find linkelement")}$yn(Y){return!(9===Y?!this.t8a.querySelector(".DesignerNoSuggestionNewButton:focus"):
!this.t8a.querySelector(".DesignerNoSuggestionView-Link:focus"))}y5l(Y){try{const Sa=this.t8a.querySelector("."+Y);if(!Sa)return!1;const Mb=Sa.getAttribute("href").toString();if(!Mb)return!1;Lb.a.openWindow(4,Mb);return!0}catch(Sa){return H.a.$(512496452,829,10,"DesignerView:GoToSuggestionLink exception: {0}",Sa),!1}}Ilm(){this.LD.isVisible&&this.UIa.w3d&&this.UIa.value.oU&&this.UIa.value.dismiss()}onFocus(){if(this.LD.isVisible)if(2===this.LD.AGb)Cb.FocusManager.vz(this.t8a.lastChild);else if(3===
this.LD.AGb){var Y=this.l5l();if(1===Y)this.Ekh(!0);else if(3===Y)this.Ifc(!0,Y);else{Y=this.Ykn();var Sa=this.Jhn();-1===Y?this.HU(-1===Sa?0:Sa,!0):this.HU(Y,!0)}}}i0(Y){return this.LD.isVisible&&Y.Hc?this.jZl(Y.clientPoint):!1}gXm(Y){var Sa;if(Y){var Mb=Y.getAttribute(Te.mNd);if((Sa=Y.getAttribute(Te.jHh))&&Mb)Sa=Sa.toString(),Mb=Mb.toString();else{H.a.$(509371461,829,10,"DesignerView::applyFirstDesignerSuggestion - Failed to parse suggestion slide creation id and slideId, CorrelationId: {0}",this.Rd.correlationId);
return}}H.a.$(508941526,829,50,"DesignerView::applyFirstDesignerSuggestion - CorrelationId: {0}",this.Rd.correlationId);Y=parseInt(Mb);Sa=parseInt(Sa)||0;Sa=Object.assign(new Ik,{SuggestionCid:Sa,SuggestionSid:Y,CorrelationId:this.Rd.correlationId,ActiveSlideCid:this.RJ.Ia.cid,ActiveSlideSid:this.RJ.Ia.sid});this.la.Ra(tb.a.WHa,2,Sa)}WHa(Y,Sa){H.a.$(509089807,829,50,"DesignerView::applyDesignerSuggestion - auto apply designer, CorrelationId: {0}",this.Rd.correlationId);Y=Object.assign(new Ik,{SuggestionCid:Sa,
SuggestionSid:Y,CorrelationId:this.Rd.correlationId,ActiveSlideCid:this.RJ.Ia.cid,ActiveSlideSid:this.RJ.Ia.sid});this.la.Ra(tb.a.WHa,2,Y)}h0(Y){return this.LD.isVisible&&Y.Hc?this.jZl(Y.clientPoint):!1}Con(Y){this.LX();this.Nsd(2);H.a.$(512496451,829,50,"DesignerView::HandleGetSuggestionsTimeout, CorrelationId: {0}",Y);this.LD.isVisible&&(this.Rd.ind=!0,this.la.Ra(tb.a.lib,2,new Yj.a(!1,ah.a.E0h)))}aco(){const Y=this.Rd.correlationId;this.Lem=window.setTimeout(()=>{this.Con(Y)},this.na.VIh)}Bon(Y){this.LX();
this.RJ.aNh(this.JIb());H.a.$(512496450,829,15,"DesignerView::HandleGetMoreIdeasTimeout, CorrelationId: {0}",Y)}$bo(){const Y=this.Rd.correlationId;this.Jem=window.setTimeout(()=>{this.Bon(Y)},this.na.VIh)}LX(){window.clearTimeout(this.Lem);window.clearTimeout(this.Jem)}get $D(){return this.LD}lun(){this.Mwa.style.display=hc.a.none;this.Rd.Tpk=!0;this.xWc=Ib.a.kg();this.xWc.className=tf.TIn;const Y=this.CWl(tf.xsk),Sa=document.createElement("iframe");Sa.className=Sa.id=tf.Ajm;const Mb=this.CWl(tf.wsk);
this.xWc.appendChild(Y);this.xWc.appendChild(Sa);this.xWc.appendChild(Mb);this.LYa.appendChild(this.xWc);const oc=this.Na.Uc(fc.a.sbg);oc.parent=ma.AFrame.lC;this.kf.Whd(fc.a.sbg,Sa);oc.e7(()=>{Sa.focus();const Oc=Object.assign(new ze.DOMFocusListing(()=>this.xWc),{WKb:!0});Oc.Xq(3);Oc.Xq(2);Oc.Xq(4);Oc.Xq(1);Oc.Xq(6);Oc.Xq(5);Cb.FocusManager.instance().sUe(this.xWc,oc,Oc);const nd=Cb.FocusManager.instance().YX(fc.a.sbg);nd.XKb();nd.J3=!0;nd.vfb=!0;oc.kD(Cb.FocusManager.instance().mHb);oc.kD(Cb.FocusManager.instance().nHb);
Oc.qO(Sa)});this.Na.Ag(fc.a.sbg);this.pB.addHandler(this.xWc,Z.a.oi,Object(h.a)(this,this.LJ,"keyDownHandler"))}CWl(Y){const Sa=document.createElement("div");Sa.setAttribute("Id",Y);Sa.setAttribute("tabindex",0);Sa.setAttribute("position","absolute");Sa.setAttribute("width","-1000px");Sa.setAttribute("top","-1000px");return Sa}LJ(Y){Y.keyCode===Sys.UI.Key.tab&&(Y.target.id!==tf.wsk||Y.shiftKey?Y.target.id===tf.xsk&&Y.shiftKey&&this.zym(Y,tf.wsk):this.zym(Y,tf.xsk))}zym(Y,Sa){Y.preventDefault();Y.stopPropagation();
(Y=document.getElementById(Sa))&&Y.focus()}d1m(Y){switch(Y.className){case tf.CUh:return this.$D.uHe(1),!0;case tf.i1e:Y=Y.querySelector("."+tf.j1e).innerText;break;case tf.j1e:Y=Y.innerText;break;case tf.vsk:Y=Y.parentNode.querySelector("."+tf.j1e).innerText;break;default:return!1}return this.k7n(Y)}k7n(Y){this.na.fIb&&(this.wim=this.JIb().querySelector("."+Te.oAc).getAttribute("correlationId").toString());this.Nsd(6);var Sa=Eb.a.tS(this.na.ZTa).toString();Sa=String.format(this.na.FMc,n.AFrameworkApplication.lcid,
xi.a.Le(n.AFrameworkApplication.lcid).name,n.AFrameworkApplication.buildVersion,Yb.a.create().toString(),3,Sa,0);Sa=Sa.replace(RegExp("&amp;","g"),"&").replace(RegExp("&p=3"),"&p=6")+"&q="+Y;Y=document.getElementById(tf.Ajm);Y.setAttribute("src",Sa);Y.style.visibility=hc.a.visible;this.RD=(new Li).getInstance(Y.contentWindow,Sa);this.RD.$nc(gg.a.gXa,Mb=>{if(Mb=this.vsa.gpm(Mb)){const oc=[];Array.add(oc,Mb);this.la.Eb(tb.a.Mnh,2);this.$D.DB(!1,ah.a.HUl,2);this.SEn.Klc(oc)}});this.RD.$nc(Df.ifa,()=>
{this.Nsd(3);const Mb=new hi(this.Rd.suggestions,this.Rd.suggestions?this.Rd.suggestions.SlideSuggestions.length:0,this.Rd.gjd.length,this.na.fIb?this.wim:this.Rd.correlationId,this.JIb(),!0,this.Wkc(),this.RJ.wNh(og.a.makeItVisual));this.RJ.y_k(Mb)});return!0}c1m(Y){return Sys.UI.DomElement.containsCssClass(Y,tf.UVe)||Sys.UI.DomElement.containsCssClass(Y,tf.TVe)?this.ron(Y):Sys.UI.DomElement.containsCssClass(Y,tf.okd)||Sys.UI.DomElement.containsCssClass(Y,tf.xJh)||Sys.UI.DomElement.containsCssClass(Y,
tf.oZl)||Sys.UI.DomElement.containsCssClass(Y,tf.nZl)?this.son(Y):Sys.UI.DomElement.containsCssClass(Y,tf.TRf)?this.Fon():Sys.UI.DomElement.containsCssClass(Y,tf.YRf)?this.Xon():!1}Xon(){this.la.Eb(tb.a.XWh,2);this.$D.DB(!1,ah.a.oVn,2);return this.Rd.eZl=!0}jZl(Y){const Sa=this.Rd.AOi;if(!Sa||Rb.a.wb(this.Rd.TXa))return!1;Y=Lb.a.BIb(Y);this.Wwn(Y)?Sa.hNh(this.r2l()):Sa.hNh([]);return!0}Wwn(Y){for(;Y&&Y.className!==tf.$1i;)Y=Y.parentNode;return!!Y&&Y.className===tf.$1i}Fon(){const Y=this.Rd.AOi;if(!Y)return!1;
Y.ignoreCritiques(this.r2l(),4);this.Rd.TXa.splice(this.Rd.jAa,1);if(this.Rd.jAa===this.Rd.TXa.length){let Sa;(Sa=this.Rd).jAa=Sa.jAa-1}this.s4n();return!0}r2l(){const Y=[];for(const Sa of this.Rd.TXa[this.Rd.jAa].critiques)Y.push(Sa.critiqueId);return Y}ron(Y){if(Sys.UI.DomElement.containsCssClass(Y,tf.UVe)){let Sa;(Sa=this.Rd).jAa=Sa.jAa-1;this.Rd.jAa||(Sys.UI.DomElement.removeCssClass(Y,tf.UVe),Sys.UI.DomElement.addCssClass(Y,tf.WRf));Y=document.getElementById(tf.SVe);Sys.UI.DomElement.removeCssClass(Y,
tf.VRf);Sys.UI.DomElement.addCssClass(Y,tf.TVe)}else{let Sa;(Sa=this.Rd).jAa=Sa.jAa+1;this.Rd.jAa===this.Rd.TXa.length-1&&(Sys.UI.DomElement.removeCssClass(Y,tf.TVe),Sys.UI.DomElement.addCssClass(Y,tf.VRf));Y=document.getElementById(tf.ZTd);Sys.UI.DomElement.removeCssClass(Y,tf.WRf);Sys.UI.DomElement.addCssClass(Y,tf.UVe)}document.getElementById(tf.Z1i).innerText=(this.Rd.jAa+1).toString();this.iEm(this.Rd.jAa);return!0}iEm(Y){var Sa=this.Rd.TXa[Y].critiques[0].explanationLabel;document.getElementById(tf.mZl).innerText=
Sa;Sa=document.getElementById(tf.pZl);const Mb=Te.sWl();Sa.parentNode.replaceChild(Mb,Sa);this.RJ.p6l(Mb,Y)}son(Y){const Sa=this.Rd.AOi;if(Rb.a.wb(this.Rd.TXa)||!Sa)return!1;Y=Y.getAttribute(Df.nkd);var Mb=document.querySelector("."+tf.xJh+"["+Df.nkd+'="'+Y+'"]');Mb&&(Mb.innerText="\u2713",Sys.UI.DomElement.removeCssClass(Mb,tf.xJh),Sys.UI.DomElement.addCssClass(Mb,tf.D9m));Mb=new rb.a(0);for(const oc of this.Rd.TXa[this.Rd.jAa].critiques)Mb.add(oc.critiqueId,Y);Sa.$Bm(Mb);return this.Rd.vJh=!0}s4n(){var Y=
document.getElementById(tf.cZl);let Sa=parseInt(Y.innerText);Sa--;if(0>=Sa)this.Seo(document.getElementById(tf.dZl));else{Y.innerText=Sa.toString();this.iEm(this.Rd.jAa);Y=this.Rd.jAa===this.Rd.TXa.length-1;const Mb=document.getElementById(tf.SVe);1<Sa&&!Y?(Sys.UI.DomElement.addCssClass(Mb,tf.TVe),Sys.UI.DomElement.removeCssClass(Mb,tf.VRf)):(Sys.UI.DomElement.addCssClass(Mb,tf.VRf),Sys.UI.DomElement.removeCssClass(Mb,tf.TVe));Y&&(document.getElementById(tf.Z1i).innerText=Sa.toString());Y=document.getElementById(tf.ZTd);
1<Sa&&this.Rd.jAa?(Sys.UI.DomElement.addCssClass(Y,tf.UVe),Sys.UI.DomElement.removeCssClass(Y,tf.WRf)):(Sys.UI.DomElement.addCssClass(Y,tf.WRf),Sys.UI.DomElement.removeCssClass(Y,tf.UVe))}}Seo(Y){const Sa=Ib.a.kg();Sa.className=tf.z9m;const Mb=new kg.a;Mb.zh(40,40);Mb.CZa("0,0,2048,2048");Mb.Nw(tf.E9m);var oc=new zj.a;oc.$na("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m -599 -783 l 72 -72 l 348 348 l 706 -706 l 72 72 l -778 779 z");
const Oc=new zj.a;Oc.$na("M 1894 1024 q 0 120 -31 232 q -31 111 -87 208 q -57 96 -136 176 q -80 79 -176 136 q -97 56 -208 87 q -112 31 -232 31 q -120 0 -231 -31 q -112 -31 -208 -87 q -97 -57 -176 -136 q -80 -80 -136 -176 q -57 -97 -88 -208 q -31 -112 -31 -232 q 0 -120 31 -231 q 31 -112 88 -208 q 56 -97 136 -176 q 79 -80 176 -136 q 96 -57 208 -88 q 111 -31 231 -31 q 120 0 232 31 q 111 31 208 88 q 96 56 176 136 q 79 79 136 176 q 56 96 87 208 q 31 111 31 231 z");Oc.va.setAttribute("class",tf.H9m);const nd=
new zj.a;nd.$na("M 1024 128 q 124 0 239 32 q 114 32 214 91 q 99 58 181 140 q 81 81 140 181 q 58 99 90 214 q 32 114 32 238 q 0 124 -32 239 q -32 114 -90 214 q -59 99 -140 181 q -82 81 -181 140 q -100 58 -214 90 q -115 32 -239 32 q -124 0 -238 -32 q -115 -32 -214 -90 q -100 -59 -181 -140 q -82 -82 -140 -181 q -59 -100 -91 -214 q -32 -115 -32 -239 q 0 -124 32 -238 q 32 -115 91 -214 q 58 -100 140 -181 q 81 -82 181 -140 q 99 -59 214 -91 q 114 -32 238 -32 m 599 625 l -72 -72 l -706 706 l -348 -348 l -72 72 l 420 421 z");
nd.va.setAttribute("class",tf.x9m);const Cd=new zj.a;Cd.$na("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m 672 -1141 l -851 851 l -493 -493 l 145 -144 l 348 347 l 706 -706 m -706 924 l 778 -779 l -72 -72 l -706 706 l -348 -348 l -72 72 z");
Cd.va.setAttribute("class",tf.w9m);Mb.appendChild(oc);Mb.appendChild(Oc);Mb.appendChild(nd);Mb.appendChild(Cd);oc=Ib.a.yy();oc.innerText=ResourceStrings.l_ConsistencyCardNoMore;oc.className=tf.A9m;Sa.appendChild(Mb.va);Sa.appendChild(oc);Y.parentNode.replaceChild(Sa,Y)}}oi.t9m=[tf.ZTd,tf.SVe,tf.okd,tf.TRf,tf.YRf];Object(c.a)(oi,"DesignerView",ni.a,[766,213,152,40]);var Mk=a(250);class nk extends Sys.EventArgs{constructor(Y,Sa){super();this.slideId=Y.slideId;this.PBm=Y.ltd;this.D_l=Y.hva;this.nWd=
Sa;this.trigger=Y.trigger;this.correlationId=Y.correlationId}}Object(c.a)(nk,"RenderSuggestionsEventArgs",Sys.EventArgs,[]);class Nk{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg){this.ffm=new fi.a;this.vC=Y;this.RJ=Sa;this.Rd=Mb;this.na=oc;this.la=Oc;this.ya=nd;this.Tb=Cd;this.Fd=Zd;this.zb=we;this.Na=Qe;this.Yb=kf;this.Prg=this.aak=0;this.Eod=Vf;this.wDn=eg;this.Omc=zg;this.Oz()}Oz(){this.Fd.LPl(Object(h.a)(this,this.Inm,"onSuggestionsUpdated"));this.Fd.KPl(Object(h.a)(this,this.llm,"onCoauthModifiedSameSlide"));
this.wDn.execute(Y=>{Y.vUm(Object(h.a)(this,this.lUn,"onShowMoreSuggestions"),()=>{this.E5e(this.vC,3)})});this.na.MXa&&this.Fd.oQl(Object(h.a)(this,this.com,"onUserBeginUploadPicture"));this.Fd.Jxf(Object(h.a)(this,this.Iac,"onUndoRedo"))}dispose(){this.Fd.bum(Object(h.a)(this,this.Inm,"onSuggestionsUpdated"));this.Fd.aum(Object(h.a)(this,this.llm,"onCoauthModifiedSameSlide"));this.na.MXa&&this.Fd.xum(Object(h.a)(this,this.com,"onUserBeginUploadPicture"));this.Fd.qch(Object(h.a)(this,this.Iac,"onUndoRedo"))}u$n(Y){this.la.Ra(tb.a.lib,
2,new Yj.a(!1,Y))}E5e(Y,Sa){Y?Y.Nsd(Sa):H.a.$(512496522,829,50,"SetDesignerViewState - null view. CorrelationId:{0}, ViewState:{1}",this.Rd.correlationId,Sa)}Mpn(Y){const Sa=this.M7m(Y);if(Sa){var Mb=Sa.$D;H.a.$(512496521,829,50,"DesignerManager::HandleSuggestionItemNavigation - ActionId: {0} in ViewState: {1}",Y,Eh[Mb.AGb]);switch(Mb.AGb){case 3:this.GOn(Y,Sa);break;case 2:case 9:this.FOn(Y,Sa,Mb.AGb)}}}M7m(Y){switch(Y){case tb.a.J0c:case tb.a.ase:case tb.a.Upd:case tb.a.K0c:case tb.a.cse:case tb.a.Wpd:case tb.a.bse:case tb.a.Vpd:Y=
this.vC;break;default:return null}return Y}GOn(Y,Sa){if(Sa&&Sa.$D){var Mb=document.activeElement;if(Mb){var oc=Mb.getAttribute(Te.uAc),Oc=Sa.pzn(Mb),nd=Sys.UI.DomElement.containsCssClass(Mb,"DesignerPaneCloseButton")||Sys.UI.DomElement.containsCssClass(Mb,"IdeasText"),Cd=this.zjm(Mb)||this.fZl(Mb),Zd=Sa.wam();if(oc||nd||Cd||Oc||Zd)if(oc=oc?parseInt(oc.toString()):-1,Oc=Sa.rXe()-1,!(1>Oc))switch(nd=Sa.$D,Cd=Sa.l5l(),Y){case tb.a.J0c:if(Zd||1===Cd||3===Cd)break;nd.y0(!1);oc<Oc&&(Sa.HU(oc,!1),Sa.HU(oc+
1,!0));break;case tb.a.ase:if(Zd||1===Cd||3===Cd)break;nd.y0(!1);oc!==Oc&&(Sa.HU(oc,!1),Sa.HU(Oc,!0));break;case tb.a.Upd:if(Zd){Sa.A6l();break}this.Ton(Sa,oc,Oc,Cd);break;case tb.a.K0c:if(Zd||1===Cd||3===Cd)break;nd.y0(!1);0<oc&&(Sa.HU(oc,!1),Sa.HU(oc-1,!0));break;case tb.a.cse:if(Zd||1===Cd||3===Cd)break;nd.y0(!1);oc&&(Sa.HU(oc,!1),Sa.HU(0,!0));break;case tb.a.Wpd:if(Zd){Sa.A6l();break}this.Uon(Sa,oc,Oc,Cd);break;case tb.a.bse:case tb.a.Vpd:Zd||1===Cd||3===Cd||(Y=Y===tb.a.Vpd,Sa=Sa.$D,this.zjm(Mb)?
this.Won(Y,Sa):this.fZl(Mb)&&this.Von(Y,Sa))}}}}Ton(Y,Sa,Mb,oc){const Oc=Y.$D;if(-1===Sa){switch(oc){case 1:Oc.BNc?(Oc.y0(!1),Y.Ekh(!0)):Y.cam()?(Y.Ekh(!1),Y.Ifc(!0,oc)):(Y.Ifc(!1,oc),Oc.y0(!0));return;case 2:Oc.BNc?(Oc.y0(!1),Y.HU(0,!0)):(Y.Ifc(!1,oc),Oc.y0(!0));return;case 3:Sa=Oc.BNc;Oc.y0(!Sa);Y.Ifc(Sa,oc);return}Oc.y0(!1);Y.HU(0,!0)}else Sa===Mb?(Y.HU(Sa,!1),2===oc?Y.Ifc(!0,oc):Oc.y0(!0)):(Y.HU(Sa,!1),Y.HU(Sa+1,!0))}Uon(Y,Sa,Mb,oc){const Oc=Y.$D;if(0<Sa)Y.HU(Sa,!1),Y.HU(Sa-1,!0);else if(-1===
Sa){switch(oc){case 1:Oc.BNc?(Oc.y0(!1),Y.Ifc(!0,oc)):Y.cam()?(Y.Ekh(!1),Oc.y0(!0)):(Y.Ifc(!1,oc),Y.Ekh(!0));return;case 2:Oc.BNc?(Oc.y0(!1),Y.Ifc(!0,oc)):(Y.Ifc(!1,oc),Y.HU(Mb,!0));return;case 3:Sa=Oc.BNc;Oc.y0(!Sa);Y.Ifc(Sa,oc);return}Oc.BNc&&(Oc.y0(!1),Y.HU(Mb,!0))}else Y.HU(0,!1),Oc.y0(!0)}FOn(Y,Sa,Mb){if(Sa){var oc=Sa.$D;if(Y===tb.a.Upd||Y===tb.a.Wpd||Y===tb.a.K0c||Y===tb.a.J0c)Y=Sa.$yn(Mb),oc.y0(Y),Sa.Rbo(!Y,Mb)}}zjm(Y){return Sys.UI.DomElement.containsCssClass(Y,tf.CUh)||Sys.UI.DomElement.containsCssClass(Y,
tf.i1e)}fZl(Y){return Y.className.startsWith(tf.kZl)}Won(Y,Sa){var Mb=document.activeElement;Mb&&(Sys.UI.DomElement.containsCssClass(Mb,tf.i1e)?(Mb=parseInt(Mb.getAttribute(tf.Bjm).toString())+1,Y?Mb!==Df.DUg?Sa.uHe(Mb+1):Sa.uHe(1):1!==Mb?Sa.uHe(Mb-1):Sa.uHe(Df.DUg)):Y?Sa.uHe(1):Sa.uHe(Df.DUg))}Von(Y,Sa){var Mb=document.activeElement;if(Mb){for(var oc=oi.t9m,Oc=0;!Sys.UI.DomElement.containsCssClass(Mb,oc[Oc]);)if(Oc++,Oc===oc.length){Oc=-1;break}var nd=document.querySelectorAll("."+tf.okd).length;
oc[Oc]!==tf.okd?Y?Oc!==oc.length-1&&-1!==Oc?oc[Oc+1]!==tf.okd?this.IXe(oc[Oc+1],Sa):Sa.BZh(0):this.IXe(oc[0],Sa):Oc&&-1!==Oc?oc[Oc-1]!==tf.okd?this.IXe(oc[Oc-1],Sa):Sa.BZh(nd-1):this.IXe(oc[oc.length-1],Sa):(Mb=parseInt(Mb.getAttribute(Df.nkd).toString()),Y?Mb!==nd-1?Sa.BZh(Mb+1):this.IXe(oc[Oc+1],Sa):Mb?Sa.BZh(Mb-1):this.IXe(oc[Oc-1],Sa))}}IXe(Y,Sa){switch(Y){case tf.ZTd:Sa.xao();break;case tf.SVe:Sa.wao();break;case tf.TRf:Sa.uao();break;case tf.YRf:Sa.vao()}}n$f(Y,Sa){if(this.na.Cfg&&this.vC.$D.isVisible){if(Sa&&
(Y===tb.a.WHa||Y===tb.a.xTb)){this.Rd.m2a=w.a.empty;Sa=this.ya.presentation;const Mb=this.Tb.Kd(7,void 0,void 0,void 0,!0);try{Mb.tc(Sa),this.na.OXl&&(Mb.wc=Y),Sa.removeProperty(jc.a.N3a)}finally{Mb&&Mb.dispose()}}this.RJ.Zko(this.vC.JIb());Sa=fb.a("AddMoreDesignerLogsEnabled");fb.a("FixSessionRehydrationIssueForDesigner")?this.na.PYi&&(Y!==tb.a.WHa&&Y!==tb.a.xTb||(Y==tb.a.WHa||Y==tb.a.xTb)&&!this.Rd.KCa)&&(Sa&&H.a.$(507642455,829,50,"DesignerActor::handleUndoRedoAction actionId {0}, isSuggestionApplied {1}",
Y,this.Rd.KCa),this.la.Eb(tb.a.XIh,2)):this.na.PYi&&Y!==tb.a.WHa&&Y!==tb.a.xTb&&(Sa&&H.a.$(507642454,829,50,"DesignerActor::handleUndoRedoAction actionId {0}",Y),this.la.Eb(tb.a.XIh,2))}}Iac(Y,Sa){this.n$f(Sa.T1h,Sa.Jgb)}zwn(Y){return this.Rd.xZe(Y)}GZj(Y){switch(Y){case Hg.a.NLd:case Hg.a.QLd:case Hg.a.knb:case Hg.a.PLd:case Hg.a.RLd:case Hg.a.CBf:case Hg.a.u2a:case Hg.a.EBf:case Hg.a.FBf:case Hg.a.GBf:case Hg.a.HBf:case Hg.a.TLd:case Hg.a.VLd:case Hg.a.backspace:case Hg.a.Iza:case Hg.a.uG:case Hg.a.sNa:case Hg.a.enter:case Hg.a.YB:case Hg.a.VA:return!0;
default:return!1}}a9l(Y){switch(Y){case Hg.a.ona:case tb.a.mTe:case tb.a.addSlideTitle:case tb.a.zid:case tb.a.bkc:case tb.a.Sma:case tb.a.Z0:case tb.a.XHa:case tb.a.efa:case tb.a.YHa:case tb.a.Wva:case tb.a.qXa:case tb.a.DHb:case tb.a.ckc:case tb.a.bringForward:case tb.a.bringToFront:case tb.a.L2a:case tb.a.ZAc:case tb.a.DUe:case tb.a.$Ac:case tb.a.ZHa:case tb.a.lfb:case tb.a.xHh:case tb.a.mfb:case tb.a.uH:case tb.a.Bw:case tb.a.Wpa:case tb.a.N2a:case tb.a.DHf:case tb.a.HMa:case tb.a.Vjd:case tb.a.fwa:case tb.a.VDc:case tb.a.zWb:case tb.a.WDc:case tb.a.deleteComment:case tb.a.jE:case tb.a.wG:case tb.a.cVd:case tb.a.pfa:case tb.a.AGc:case tb.a.yYb:case tb.a.cXd:case tb.a.bXd:case tb.a.dXd:case tb.a.YXf:case tb.a.AYb:case tb.a.Uba:case tb.a.flc:case tb.a.omd:case tb.a.OIb:case tb.a.zmd:case tb.a.nYe:case tb.a.oYe:case tb.a.Fmd:case tb.a.Gmd:case tb.a.INh:case tb.a.nTe:case tb.a.Llc:case tb.a.insertOnlinePicture:case tb.a.CIa:case tb.a.vYe:case tb.a.insertPicture:case tb.a.DIa:case tb.a.$Ib:case tb.a.aJb:case tb.a.pna:case tb.a.Cmd:case tb.a.Vqe:case tb.a.Pna:case tb.a.pnc:case tb.a.sbc:case tb.a.qnc:case tb.a.d2e:case tb.a.oKb:case tb.a.gZa:case tb.a.Phb:case tb.a.Gqd:case tb.a.rnc:case tb.a.c2e:case tb.a.qtd:case tb.a.Hib:case tb.a.GLb:case tb.a.FLb:case tb.a.HLb:case tb.a.hZa:case tb.a.d4c:case tb.a.cxe:case tb.a.SWh:case tb.a.yKb:case tb.a.Nab:case tb.a.Bnc:case tb.a.Tbc:case tb.a.vY:case tb.a.Qna:case tb.a.Nab:case tb.a.ync:case tb.a.zKb:case tb.a.mergeTableCells:case tb.a.AMc:case tb.a.T9:case tb.a.uxa:case tb.a.txa:case tb.a.nga:case tb.a.vxa:case tb.a.HVe:case tb.a.GVe:case tb.a.CKb:case tb.a.BKb:case tb.a.AKb:case tb.a.brd:case tb.a.N2e:case tb.a.Cnc:case tb.a.H4:case tb.a.rse:case tb.a.XEa:case tb.a.zzb:case tb.a.wG:case tb.a.kah:case tb.a.r4e:case tb.a.Nrd:case tb.a.GDe:case tb.a.ZKb:case tb.a.$Kb:case tb.a.Una:case tb.a.$Ee:case tb.a.gsd:case tb.a.nib:case tb.a.hLb:case tb.a.iLb:case tb.a.isd:case tb.a.hsd:case tb.a.d6:case tb.a.d5e:case tb.a.e5e:case tb.a.sendBackward:case tb.a.sendToBack:case tb.a.setAsSlideTitle:case tb.a.Koc:case tb.a.N5e:case tb.a.OHe:case tb.a.PHe:case tb.a.Ksd:case tb.a.Lsd:case tb.a.Loc:case tb.a.$Zh:case tb.a.wLb:case tb.a.zk:case tb.a.VDb:case tb.a.xLb:case tb.a.Aib:case tb.a.wlh:case tb.a.Tsd:case tb.a.IU:case tb.a.BY:case tb.a.EJe:case tb.a.L7e:case tb.a.N7e:case tb.a.P7e:case tb.a.X7e:case tb.a.yJa:case tb.a.Z7e:case tb.a.$7e:case tb.a.b8e:case tb.a.WHa:case tb.a.xTb:case tb.a.J0c:case tb.a.ase:case tb.a.Upd:case tb.a.K0c:case tb.a.cse:case tb.a.Wpd:case tb.a.bse:case tb.a.Vpd:case tb.a.RIh:case tb.a.vta:case tb.a.oGa:case tb.a.yoc:return!0;
default:return!1}}isEnabled(){return this.na.Cfg}Bwn(){return 0<this.Prg}GHh(){return this.Prg}llm(Y,Sa){Y=Sa.slideId;H.a.$(512496520,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Others is editing in slide sid: {0}",Y.sid);if((Sa=this.ya.Ia)&&Sa.fc.equals(Y)){Sa="unopened";this.vC.$D.isVisible&&(this.vC.$D.isVisible&&this.E5e(this.vC,5),Sa="set to SameSlideCoauthNoSuggestion UI");let Mb="unopened";this.vC.$D.isVisible&&(this.e1c(this.Rd.correlationId,Mj.a.W0c),Mb="closed");"unopened"===Sa&&
"unopened"===Mb||H.a.$(512496519,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Designer pane state: {0}. Designer card in Ideas pane state: {1}. Slide sid:{2}, cid:{3}, CorrelationId:{4}, CoauthCountInPresentation:{5} and CoauthCountInSlide:{6}.",Sa,Mb,Y.sid,Y.cid,this.Rd.correlationId,this.aak,this.Prg)}}Inm(Y,Sa){H.a.$(512496518,829,50,"DesignerManager::OnSuggestionsUpdated - IsDesignerEnabled:{0}, CoauthCountInPresentation:{1}, CoauthCountInSlide:{2}, correlationId:{3}; trigger: {4}",this.na.Cfg,
this.aak,this.Prg,Sa.correlationId,Sa.trigger);if(this.isEnabled()){if(Y=this.ya.Ia)if(this.na.getBooleanAppSetting("FixEntryTriggerIssueEnabled")&&this.Rd.N9d&&(this.Rd.N9d=!1),Sa.slideId.equals(Y.fc))if(this.zwn(Sa.correlationId))H.a.$(512496515,829,50,"DesignerManager::OnSuggestionsUpdated - CorrelationId is in closed suggestion list. CorrelationId:{0}",Sa.correlationId);else if(this.Vno(Sa.correlationId))H.a.$(512496514,829,50,"DesignerManager::OnSuggestionsUpdated - User began to upload picture during incremental rendering, so ignore further suggestions for this CorrelationId. CorrelationId:{0}",
Sa.correlationId);else{this.Rd.correlationId!==Sa.correlationId&&(this.Rd.dPl(Sa.correlationId,this.na.fIb&&Sa.trigger===og.a.moreIdeas),H.a.$(512496513,829,50,"DesignerManager::OnSuggestionsUpdated - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.Rd.correlationId,Sa.correlationId));if(this.Rd.correlationId===Sa.correlationId&&this.vC.$D.isVisible&&3===this.vC.$D.AGb)if(this.na.MXa&&Rb.a.any(Sa.ltd.toArray(),Mb=>0<=this.Rd.ZJb.indexOf(Mb)))this.Rd.EVg=
new Date,H.a.$(512496512,829,50,"DesignerManager::OnSuggestionsUpdated - Notification for missing Designer cards successfully received. CorrelationId: {0}, Received indexes: {1}, Missing indexes {2}",Sa.correlationId,Sa.ltd.toString(),this.Rd.ZJb.toString());else if(Y=Sa.Yoc,!this.na.MXa||this.Rd.Fkc.contains(Y)){H.a.$(512496483,829,50,"DesignerManager::OnSuggestionsUpdated - Duplicated Designer card notification. CorrelationId: {0}, StartIdx: {1}",Sa.correlationId,Y.toString());return}Y=Te.HYi(Sa.qpb);
this.t9n(Y,Sa);this.Opn(Sa);this.Npn(this.vC,Sa,Y,Sa.hva,Rb.a.wb(this.Rd.gjd)?Sa.hva:this.Rd.gjd.length);!fb.a("DesignerPaneFocusFix")||Sa.trigger!==og.a.pNe&&Sa.trigger!==og.a.Htd||this.vC.$D.$fa(!0)}else H.a.$(512496516,829,50,"DesignerManager::OnSuggestionsUpdated - current slide node is different to suggestion slide node. CorrelationId:{0}",Sa.correlationId)}else H.a.$(512496517,829,50,"DesignerManager::OnSuggestionsUpdated - Designer is not enabled. CorrelationId:{0}",Sa.correlationId)}t9n(Y,
Sa){if(Y&&Sa.trigger!==og.a.moreIdeas){this.Rd.suggestions||(this.Rd.suggestions=Object.assign(new nj,{CardData:Y.CardData,SlideSuggestions:Array(Sa.Sbg?Sa.hva:Sa.HZa)}));if(!Rb.a.wb(Y.SlideSuggestions))for(const Mb of Y.SlideSuggestions)this.Rd.suggestions.SlideSuggestions[Mb.Index]=Mb;this.Rd.gjd||(this.Rd.gjd=Te.$Vn(Y))}}Npn(Y,Sa,Mb,oc,Oc){H.a.$(512496482,829,50,"DesignerView.SetViewState. CorrelationId:{0}, Trigger:{1}, TotalSuggestions:{2}, DesignerCardCount:{3}",Sa.correlationId,Sa.trigger,
Sa.hva,oc);if(Sa.trigger===og.a.moreIdeas){this.Rd.ELb||(this.Rd.ELb=new Date);var nd=Y.rXe();this.RJ.l7n(Mb,Y.JIb(),Sa.correlationId,Y.Wkc())||(this.RJ.aNh(Y.JIb()),nd=Y.rXe()-1);Y.HU(nd,!0);this.E5e(Y,8)}else if(!oc)!this.na.tVe||Sa.trigger!==og.a.pNe&&Sa.trigger!==og.a.Htd?this.E5e(Y,2):this.E5e(Y,9),this.vC.$D.isVisible?this.e1c(this.Rd.correlationId,Mj.a.W0c):this.u$n(ah.a.noSuggestion);else if(this.wdo(Sa.trigger,Y.$D)){var Cd=!0;if(this.na.MXa){Cd=null;var Zd=Y.JIb();Zd&&(Cd=Zd.querySelector("#"+
Y.$D.id+" ."+Te.oAc+'[correlationId="'+Sa.correlationId+'"]'));Cd=!Cd;H.a.$(512496481,829,50,"HandleSuggestionUpdate CorrelationId:{0}, Trigger:{1}, FirstRender:{2}",Sa.correlationId,Sa.trigger,Cd);Zd=new nk(Sa,Cd);this.Fd.rsm(Zd)}if(Cd){this.E5e(Y,3);this.Rd.ELb||(this.Rd.ELb=new Date);try{this.na.Mqm&&this.Omc.execute(we=>{we.logActivity("HasSeenDesigner","PPTDesignerFloodgateSurveyEnabled")})}catch(we){H.a.$(512496480,829,10,"DesignerManager::HandleSuggestionUpdate: Exception thrown when trying to trigger floodgate survey. Exception: {0}",
we)}}oc=new hi(Mb,oc,Oc,Sa.correlationId,Y.JIb(),Cd,Y.Wkc(),this.RJ.wNh(Sa.trigger));this.RJ.y_k(oc);this.Rd.Neg&&this.na.getBooleanAppSetting("ChatPPTHideImg")&&this.f8n();this.Rd.Neg&&this.na.getBooleanAppSetting("ChatPPTImgAutoApplyDesigner")&&"InsertPicture"===Sa.trigger&&(fb.a("DesignerChatPPTApplyOnFirstRender")?Cd&&0<(null===(nd=null===Mb||void 0===Mb?void 0:Mb.SlideSuggestions)||void 0===nd?void 0:nd.length)?Y.WHa(Mb.SlideSuggestions[0].SlideId.Sid,Mb.SlideSuggestions[0].SlideId.Cid):H.a.$(509089808,
829,Cd?10:50,"DesignerManager::HandleSuggestionUpdate: not able to get suggestion to apply"):(Sa=Y.JIb().querySelector("."+Te.oAc),null!=Sa&&Y.gXm(Sa.childNodes[0])))}}f8n(){const Y=this.ya.Ia;if(Y){var Sa=Y.MZ(Mb=>0!==Mb.wtd);Sa&&Sa.length&&(Sa.forEach(Mb=>{Mb.wtd=0}),Sa=new B.a(2,1,this.na.Ac("ChatPPTUnhideUpdateMs",2E3),()=>{Y.G$(this.zb.Ua,252,!0)},void 0,"ResetTempHiddenShapeTask"),this.Yb.Rb(Sa))}}Opn(Y){Y.Sbg?(Rb.a.wb(this.Rd.suggestions.SlideSuggestions)||this.Rd.suggestions.SlideSuggestions.length===
Y.hva)&&this.e1c(Y.correlationId,Mj.a.success,this.Rd.suggestions,Y.trigger):this.e1c(Y.correlationId,Mj.a.success,this.Rd.suggestions,Y.trigger)}wdo(Y,Sa){return Sa.isVisible||Y!==og.a.XEa&&Y!==og.a.uHh&&Y!==og.a.ZAc}$_h(Y,Sa){this.Prg=Y;this.aak=Sa;this.Fd.hJ(new Mk.a(1))}com(){this.vC.$D.isVisible&&3===this.vC.$D.AGb&&(this.ffm.add(this.Rd.correlationId),this.vC.Nsd(1))}Vno(Y){return this.ffm.contains(Y)}e1c(Y,Sa,Mb,oc){Mb=void 0===Mb?null:Mb;oc=void 0===oc?"":oc;H.a.$(512496479,829,50,"DesignerManager:NotifySuggestionsReadyForIdeas - CorrelationId:{0}, Status:{1}, Trigger:{2}",
Y,Sa,oc);this.Eod.execute(Oc=>{const nd=this.d3m(Y,Mb);Eb.a.wb(oc)||(nd.trigger=oc);Oc.notifySlideSuggestion(Sa,nd)})}d3m(Y,Sa){const Mb=new Wh;Mb.correlationId=Y;if(!Sa)return H.a.$(512496478,829,50,"DesignerManager:ParseSlideSuggestionNotificationData - no suggestions to parse. CorrelationId:{0}",Y),Mb;Mb.suggestions=this.RJ.pWn(Sa);return Mb}lUn(Y){Y=new hi(this.Rd.suggestions,Y.suggestions.length,Y.suggestions.length,Y.correlationId,this.vC.JIb(),!0,this.vC.Wkc(),this.RJ.wNh(Y.trigger));this.RJ.y_k(Y);
this.Na.Gm(fc.a.qqa,!0)}RVn(){return 4===this.vC.$D.AGb}PVn(){return 1===this.vC.$D.AGb}}Object(c.a)(Nk,"DesignerManager",null,[769,40]);var rj=a(167);class vl{constructor(Y,Sa){this.foe=this.N8a=null;this.RGn=Sa;this.kj=Y;this.tP=!1}get vs(){return this.tP}setup(){this.vs||(this.foe=Ib.a.kg(),this.foe.setAttribute("Unselectable","on"),this.foe.style.position=hc.a.absolute,this.kj.addCssClass(this.foe,"designerPreviewImageContainer"),this.N8a=new rj.a,this.tP=!0)}dispose(){this.vs&&(this.dismiss(),
this.N8a&&this.N8a.va.parentNode&&(this.N8a.Or(),this.kj.removeCssClass(this.N8a.va,"designerPreviewImageContainer")))}dismiss(){this.vs?(this.lec(),this.N8a.setVisibility(!1)):H.a.$(38099035,829,15,"DesignerPreviewImageView::Dismiss - called before setup")}setImage(Y){if(this.vs){this.foe&&(this.foe.appendChild(this.N8a.va),this.kj.addCssClass(this.N8a.va,"designerPreviewImageContainer"),this.N8a.setVisibility(!1));var Sa=this.RGn.jd;if(Y=this.SVb(Y))this.lec(),Sa.z6e.appendChild(this.foe),this.N8a.va.appendChild(Y),
this.N8a.setVisibility(!0);this.N8a.zh(Sa.hs.clientWidth,Sa.hs.clientHeight)}else H.a.$(38099037,829,15,"DesignerPreviewImageView::SetImage - called before setup")}SVb(Y){if(!Eb.a.wb(Y)){const Sa=Ib.a.LK();Sa.setAttribute("Unselectable","on");Sa.src=Y;Sa.style.height="100%";Sa.style.width="100%";return Sa}return null}lec(){this.N8a.va.firstChild&&this.N8a.va.removeChild(this.N8a.va.firstChild)}}Object(c.a)(vl,"DesignerPreviewImageView",null,[770]);var Vi=a(168);class hl{constructor(Y,Sa,Mb,oc,Oc,
nd,Cd,Zd,we,Qe,kf,Vf){this.Ywa=null;this.k_c=0;this.la=Y;this.Tb=Sa;this.rb=Mb;this.ya=oc;this.zb=Oc;this.na=nd;this.Jm=Cd;this.Iw=Zd;this.zc=we;this.NYa=Qe;this.Yb=kf;this.le=Vf;this.x8b=uj.ready}Kb(){this.la.ua(tb.a.fixIt,Ta.a.application,Object(h.a)(this,this.xon,"handleFixIt"),4);this.la.ua(tb.a.U3e,Ta.a.application,Object(h.a)(this,this.fpn,"handleQueryFixIt"),96);this.la.ua(tb.a.zid,Ta.a.application,Object(h.a)(this,this.zid,"applyFixItSuggestion"),4);this.la.ua(tb.a.Y7c,Ta.a.application,Object(h.a)(this,
this.Y7c,"reportFixItSessionInfo"),64);this.NYa.WJd(Object(h.a)(this,this.uTa,"onBlockingStateChanged"))}dispose(){this.NYa.x4e(Object(h.a)(this,this.uTa,"onBlockingStateChanged"))}xon(Y,Sa,Mb){Sa=this.rb.zd();if(2>Sa.length)return 8;if(1===Mb)return 32;Mb=this.ya.presentation;this.na.dIb?this.zc.snb(Mb,this.ya.Ia,this.zb.Ua,Y):this.zc.wy(Mb,Y);this.Iw.oOh=!0;const oc=[];Sa.forEach(Oc=>{Array.add(oc,Oc.get_shapeId())});Y={};Y.SelectedShapeIds=oc.join(",");this.Iw.bEb=oc;this.Kyj(Y);this.Iw.XMe=window.setTimeout(()=>
{this.yon(this.Iw.correlationId)},this.na.R9i);return 32}yon(Y){this.Iw.ind=!0;H.a.$(507843603,829,15,"FixItActor::HandleFixItTimeout, CorrelationId: {0}",Y);this.la.Ra(tb.a.Y7c,2,ah.a.E0h);this.le.BNa(pf.a.Ji(170),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}Kyj(Y,Sa){Sa=void 0===Sa?null:Sa;this.R$m(Mb=>{if(this.na.lEc){if(this.x8b.C$l&&+new Date-+this.x8b.Oam<this.na.ASd){this.Ywa=new vi;this.Ywa.sid=Mb.sid;this.Ywa.cid=Mb.cid;this.Ywa.jNh=Mb.jra;
return}this.x8b=uj.q3;this.Ywa=null}const oc=()=>{this.Kyj(this.Ywa.jNh,Sa)};this.Jm.xIb(Mb.cid,Mb.sid,Mb.correlationId,null,Je.a.fixIt,Sa,Oi.c(Mb.jra),Oc=>{Oc&&Oc.Status===Je.a.V0k?this.KYh(()=>{this.Kyj(Mb.jra,Sa)}):this.k_c=0;this.k_c||this.j$f(oc)},Oc=>this.yve(Oc,oc))},void 0===Y?null:Y)}KYh(Y){this.k_c<this.na.zSd?this.Yb.Rb(new B.a(2,1,1E3,()=>{H.a.$(507843602,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.Iw.correlationId);this.x8b=uj.ready;this.k_c++;
Y()},void 0,"RetryRequestOnWait")):H.a.$(507843601,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.Iw.correlationId)}zid(Y,Sa,Mb,oc,Oc){Sa=this.ya.presentation;if(!this.ya.Ia||!Sa)return 16;oc=null;Object(qj.a)(Ik,Oc)&&(oc=Oc);if(!oc)return 8;if(1===Mb)return 32;Mb=this.Tb.xe(15);try{this.na.$jd&&(this.Iw.Did=new Date),Mb.tc(Sa),Mb.wc=Y,Sa.N3a=oc,this.Iw.m2a=w.a.Er(oc.SuggestionSid,oc.SuggestionCid),this.Iw.KCa=!0,H.a.$(507843600,829,50,"FixItActor::ApplyFixitSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",
oc.CorrelationId,Y,oc.SuggestionSid)}finally{Mb&&Mb.dispose()}return 32}R$m(Y,Sa){Sa=void 0===Sa?null:Sa;const Mb=this.ya.Ia;Mb&&Mb.sid&&(Sa=Object.assign(new gl,{sid:Mb.sid,cid:Mb.cid,jra:Sa||{}}),H.a.$(507843599,829,50,"FixIt; sid: {0}; correlationId: {1}",Sa.sid,Sa.correlationId),this.Iw.correlationId&&this.vGe(ah.a.p8c),this.Iw.mtd=new Date,this.Iw.correlationId=Sa.correlationId,this.Iw.fIa=new Date,Y(Sa))}j$f(Y){this.na.lEc&&(this.x8b=uj.ready,this.Ywa&&Y())}yve(Y,Sa){this.j$f(Sa);H.a.$(507843598,
829,15,"FixItActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",Y.HttpStatusCode);return!0}fpn(Y,Sa,Mb,oc,Oc){this.Sjo();if(!Object(qj.a)(fl.a,Oc))return 8;if(1<this.rb.oLb()){let nd;(nd=this.Iw).vUe=nd.vUe+1;return 32}return 8}Y7c(Y,Sa,Mb,oc,Oc){if(Oc===ah.a.noSuggestion||Oc===ah.a.E0h)this.na.dIb?this.zc.ppc(Vi.e(this.ya.Ia,this.zb.Ua)):this.zc.BE(this.ya.presentation);this.vGe(Oc);return 32}uTa(Y,Sa){if(this.Iw.oOh){Y=this.zc.Hd(this.ya.presentation);const Mb=
this.na.dIb?"UnblockContentWhenDraw":"SessionRehydrated";Y||Object(G.a)(String,Sa.actionName)!==Mb||(window.clearTimeout(this.Iw.XMe),this.Iw.ind||(this.Iw.ktd=new Date),this.Iw.Did=null,this.Iw.oOh=!1)}}vGe(Y){const Sa=this.Iw.correlationId;if(Eb.a.wb(Sa))H.a.$(507843597,829,50,"FixItActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",Y);else{var Mb={};this.Iw.m2a&&(Mb.SuggestionSlideId=this.Iw.m2a.sid.toString(),Mb.SuggestionSlideCreationId=this.Iw.m2a.cid.toString());Mb.AppliedSuggestion=
this.Iw.KCa;Mb.DisplaySuggestionsTimeoutInMs=this.na.R9i;Mb.SuggestionsTimeout=this.Iw.ind;Mb.ClientAbort=this.Iw.OYe;Mb.ResetReason=Y;Mb.DesignerSendTraceRequestOnSessionEnded=this.na.WIh;var oc=de.b(n.AFrameworkApplication.ha.appSettings.SessionStartInfoJson.toString()),Oc={};Oc.ClientOS=oc.Os;Oc.Browser=oc.Browser||"";Oc.BrowserVersion=oc.BrowserVersion||"";Oc.BrowserMajorVersion=oc.BrowserMajorVersion||"";Oc.BrowserMinorVersion=oc.BrowserMinorVersion||"";this.Iw.mtd&&this.Iw.S6e&&this.Iw.S6e>
this.Iw.mtd&&(Oc.SuggestionsE2ETimeMs=+this.Iw.S6e-+this.Iw.mtd);this.Iw.mtd&&this.Iw.ktd&&this.Iw.ktd>this.Iw.mtd&&(Oc.SuggestionAppliedE2ETimeMs=+this.Iw.ktd-+this.Iw.mtd);Mb.BrowserData=Oc;this.Iw.fIa&&this.Iw.ktd&&this.Iw.ktd>this.Iw.fIa&&(Mb.TimeToDisplaySuggestionsInMs=+this.Iw.ktd-+this.Iw.fIa);this.Iw.Asl&&(Mb.TimeSuggestionsRendered=this.Iw.Asl.toUTCString());this.Jm.lib(Sa,Oi.c(Mb),Y===ah.a.nZh);this.Iw.s1k();H.a.$(507843596,829,50,"FixItActor::SendTraceRequest - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",
Y,Sa)}}Sjo(){try{const Y=vb.a.instance.eb("Common.ISystemInitiatedFeedback");Y&&Y.execute(Sa=>{Sa.logActivity("AutoFixInViewportActivity",null)})}catch(Y){H.a.$(507843595,829,10,"Exception thrown while triggering AutoFixInViewportActivity. Exception: {0}",Y)}}q1(){}p1(){}}Object(c.a)(hl,"FixItActor",null,[90]);class il{constructor(){this.vUe=0;this.correlationId=this.bEb=null;this.XMe=0;this.OYe=this.oOh=this.KCa=this.ind=!1;this.suggestion=this.fIa=this.ktd=this.Did=this.S6e=this.mtd=this.Asl=null;
this.m2a=w.a.empty}s1k(){this.vUe=0;this.correlationId=this.bEb=null;this.m2a=w.a.empty;this.XMe=0;this.OYe=this.oOh=this.KCa=this.ind=!1;this.fIa=this.ktd=this.Did=this.S6e=this.mtd=this.Asl=null}}Object(c.a)(il,"FixItContext",null,[774]);var zk=a(1230),yk=a(1621),ij=a(1190),Nl=a(1220);class Tk{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe){this.la=Y;this.ya=Sa;this.Tb=Mb;this.Fd=oc;this.Iw=Oc;this.nh=nd;this.Rmc=Cd;this.uN=Zd;this.ud=we;this.le=Qe;this.Oz()}Oz(){this.Rmc.sTe(Object(h.a)(this,this.Zfa,
"onEvent"));this.nh.cU(Object(h.a)(this,this.Zfa,"onEvent"));this.ud.Teb(Object(h.a)(this,this.Zfa,"onEvent"));this.ud.eI(Object(h.a)(this,this.Zfa,"onEvent"));this.Fd.QPl(Object(h.a)(this,this.Hnm,"onSuggestionReceived"));this.Fd.Jxf(Object(h.a)(this,this.Iac,"onUndoRedo"))}dispose(){this.Fd.eum(Object(h.a)(this,this.Hnm,"onSuggestionReceived"));this.Fd.qch(Object(h.a)(this,this.Iac,"onUndoRedo"))}Hnm(Y,Sa){if(Y=this.ya.Ia)if(Sa.slideId.equals(Y.fc))if(this.Iw.correlationId!==Sa.correlationId)H.a.$(508134790,
829,50,"FixItManager::OnSuggestionReceived - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.Iw.correlationId,Sa.correlationId);else if(Y=Tk.HYi(Sa.qpb),Y.SlideSuggestion)this.Iw.S6e||(this.Iw.S6e=new Date),Sa=Object.assign(new Ik,{SuggestionCid:Y.SlideSuggestion.SlideId.Cid,SuggestionSid:Y.SlideSuggestion.SlideId.Sid,CorrelationId:Sa.correlationId,ActiveSlideCid:Object(G.a)(22,this.ya.Ia).cid,ActiveSlideSid:Object(G.a)(22,this.ya.Ia).sid}),this.la.Ra(tb.a.zid,
2,Sa);else switch(this.la.Ra(tb.a.Y7c,2,ah.a.noSuggestion),Y.ResponseDescription){case "Invalid request":this.le.BNa(pf.a.Ji(122),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItInvalidRequest);break;case "No suggestion":fb.a("DisableErrorDialogueForNoSuggestionInAutoFix")||this.le.BNa(pf.a.Ji(132),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItNoSuggestion);break;default:this.le.BNa(pf.a.Ji(134),0,ResourceStrings.errorTitle_PowerpointEditingStandard,
ResourceStrings.errorMessage_FixItTryAgain)}else H.a.$(508134791,829,50,"FixItManager::OnSuggestionReceived - current slide node is different to suggestion slide node. CorrelationId:{0}",Sa.correlationId)}gna(Y){this.Iw.correlationId&&Y!==tb.a.zid&&this.la.Ra(tb.a.Y7c,2,ah.a.p8e+this.uN.$la(Y))}n$f(Y,Sa,Mb){if(this.Iw.correlationId&&Mb&&Sa===tb.a.zid){this.Iw.m2a=w.a.empty;Mb=this.ya.presentation;const oc=this.Tb.Kd(7,void 0,void 0,void 0,!0);try{oc.tc(Mb),oc.wc=Sa,Mb.removeProperty(jc.a.N3a)}finally{oc&&
oc.dispose()}this.la.Ra(tb.a.Y7c,2,ah.a.p8e+this.uN.$la(Y))}}Iac(Y,Sa){this.n$f(Sa.actionId,Sa.T1h,Sa.Jgb)}Zfa(Y,Sa){Y=!1;let Mb="";if(Object(qj.a)(zk.a,Sa)){H.a.$(508134789,829,50,"FixItManager::OnSessionEnding. Correlation={0}, Reason={1}",this.Iw.correlationId,Pi.a[Object(G.a)(zk.a,Sa).nJ]);if(1===Object(G.a)(zk.a,Sa).nJ||3===Object(G.a)(zk.a,Sa).nJ)Y=!0;Mb=ah.a.nZh}else Object(qj.a)(yk.a,Sa)?(H.a.$(508134788,829,50,"FixItManager::OnSessionRehydrated"),Y=!0,Mb=ah.a.w5n):Object(qj.a)(ij.a,Sa)?(Y=
!0,Mb=ah.a.slideNavigation):Object(qj.a)(Nl.a,Sa)&&Object(G.a)(Nl.a,Sa).Smd&&this.gna(Object(G.a)(Nl.a,Sa).actionId);Y&&this.Iw.correlationId&&this.la.Ra(tb.a.Y7c,2,Mb);this.sCn()}sCn(){0<this.Iw.vUe&&(H.a.$(508134787,829,50,"FixItActor::HandleQueryFixIt - FixIt button is enabled: {0}",this.Iw.vUe),this.Iw.vUe=0)}static HYi(Y){let Sa=null;try{Sa=de.a(Y)}catch(Mb){H.a.$(508134786,829,10,"FixItManager::DeserializeSuggestionResponse - parsing suggestionResults failed")}return Sa}}Object(c.a)(Tk,"FixItManager",
null,[773,40]);var Ok=a(1158),Tj=a(25),Nj;(function(Y){Y[Y.seen=0]="seen";Y[Y.keep=1]="keep";Y[Y.drillIn=2]="drillIn"})(Nj||(Nj={}));Object(c.b)("IdeasCardAction",Nj);var wl;(function(Y){Y[Y.designer=0]="designer";Y[Y.makeItVisual=1]="makeItVisual";Y[Y.editor=2]="editor";Y[Y.UNKNOWN=3]="UNKNOWN"})(wl||(wl={}));Object(c.b)("IdeasCardType",wl);class Hi{constructor(Y,Sa){this.lmc=null;this.yFg=!1;this.la=Y;this.na=Sa;this.la.Ba(tb.a.ideasPaneOpened,Ta.a.application,Object(h.a)(this,this.Eon,"handleIdeasPaneOpen"));
this.la.Ba(tb.a.qNh,Ta.a.application,Object(h.a)(this,this.Don,"handleIdeasPaneClose"));this.la.Ba(tb.a.wGj,Ta.a.application,Object(h.a)(this,this.X5l,"handleIdeasKeep"));this.la.Ba(tb.a.xGj,Ta.a.application,Object(h.a)(this,this.Zyj,"handleIdeasSee"));this.la.Ba(tb.a.CGj,Ta.a.application,Object(h.a)(this,this.Zyj,"handleIdeasSee"));this.la.Ba(tb.a.DGj,Ta.a.application,Object(h.a)(this,this.Yyj,"handleIdeasDrillIn"));this.la.Ba(tb.a.AGj,Ta.a.application,Object(h.a)(this,this.X5l,"handleIdeasKeep"));
this.la.Ba(tb.a.BGj,Ta.a.application,Object(h.a)(this,this.Zyj,"handleIdeasSee"));this.la.Ba(tb.a.yGj,Ta.a.application,Object(h.a)(this,this.Yyj,"handleIdeasDrillIn"));this.la.Ba(tb.a.zGj,Ta.a.application,Object(h.a)(this,this.Yyj,"handleIdeasDrillIn"))}Eon(){if(!this.na.FKb)return 2;this.yFg=!0;this.Jwn()||this.Jgo(Yb.a.create());return 32}Don(){if(!this.na.FKb)return 2;this.yFg=!1;return 32}X5l(Y){if(!this.na.FKb)return 2;this.tjo(this.cZi(Y));return 32}Zyj(Y){if(!this.na.FKb)return 2;this.z1h(this.cZi(Y));
return 32}Yyj(Y){if(!this.na.FKb)return 2;this.sjo(this.cZi(Y));return 32}cZi(Y){switch(Y){case tb.a.wGj:case tb.a.xGj:case tb.a.yGj:Y=0;break;case tb.a.CGj:case tb.a.DGj:Y=1;break;case tb.a.AGj:case tb.a.BGj:case tb.a.zGj:Y=2;break;default:Y=3}return Y}Jgo(){this.na.FKb&&(this.lmc=new Ok.a)}z1h(Y){this.na.FKb&&this.yFg&&3!==Y&&this.lmc&&!this.lmc.any(Sa=>Sa.key===Y)&&this.lmc.add(new Tj.a(Y,0))}tjo(Y){this.yFg&&3!==Y&&this.lmc&&this.lmc.add(new Tj.a(Y,1))}sjo(Y){this.yFg&&3!==Y&&this.lmc&&this.lmc.add(new Tj.a(Y,
2))}Jwn(){return!!this.lmc&&0<this.lmc.length}}Object(c.a)(Hi,"IdeasContext",null,[772]);class Ak{constructor(){this.jy=this.iy=null;this.MA=this.Hw=0}}Object(c.a)(Ak,"ImageLocationInfo",null,[]);var Uk=a(614);class Zj{}Object(c.a)(Zj,"ImageToTableRequest",null,[]);class ak{}ak.g8l="ImageToTableTile";ak.e8l="ImageToTable.Request";ak.f8l="ImageToTable.Response";Object(c.a)(ak,"ImateToTableAugmentationSchemaNames",null,[]);class jl{constructor(){this.Gka=this.Jja=null}get jP(){return"ImageToTableALWorkflow"}get proto(){return""}get Ozc(){this.Jja||
(this.Jja=Object.assign(new Uk.a,{name:"LambdaBefore_ImageToTableAL",inputSchema:ak.g8l,outputSchema:ak.e8l,func:Object(h.a)(this,this.a3b,"lambdaBeforeFunc")}));return this.Jja}get Syc(){return null}get u7c(){this.Gka||(this.Gka=Object.assign(new Uk.a,{name:"LambdaRemote_ImageToTableAL",inputSchema:ak.e8l,outputSchema:ak.f8l,func:null}));return this.Gka}a3b(Y,Sa,Mb){Y=Object.assign(new Zj,{image:Y.image});Mb(Y)}}Object(c.a)(jl,"ImageToTableALWorkflow",null,[786]);class vj{constructor(){this.html=
this.processId=this.errorDescription=null;this.errorCode=this.shapeId=this.slideId=0}}Object(c.a)(vj,"ImageToTableALv2ResponseWrapper",null,[]);class tk{constructor(){this.sessionId=null;this.shapeId=this.slideSid=0;this.image=this.Gng=null}}Object(c.a)(tk,"ImageToTableTile",null,[]);class kl{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf){this.la=Y;this.rb=Sa;this.zc=Mb;this.Ri=oc;this.oA=Oc;this.Xb=Cd;this.il=Zd;this.r$j=we;this.R5b=Qe;this.na=kf}initialize(){this.la.Ba(tb.a.TWh,Ta.a.application,Object(h.a)(this,
this.N5l,"handleConvertImageToTable"));this.la.Ba(tb.a.ZWh,Ta.a.application,Object(h.a)(this,this.s6l,"handleReplaceImageWithHtmlTable"));this.Ri.cU(Object(h.a)(this,this.zT,"onActiveSlideChanged"));this.r$j.execute(Y=>{const Sa=new jl;Y.registerSimpleRemoteWorkflow(Sa.jP,Sa.Ozc,Sa.u7c,Sa.Syc);Y.addEventHandler(ak.f8l,Object(h.a)(this,this.Gon,"handleImageToTableALResults"));Y.v2("AugLoop_ImageToTable_DetectedHtmlTableAnnotation");Y.ZFa("AugLoop_ImageToTable_DetectedHtmlTableAnnotation",Object(h.a)(this,
this.gra,"handleAnnotationEvent"))})}dispose(){this.la.wY(tb.a.TWh,Ta.a.application,Object(h.a)(this,this.N5l,"handleConvertImageToTable"));this.la.wY(tb.a.ZWh,Ta.a.application,Object(h.a)(this,this.s6l,"handleReplaceImageWithHtmlTable"));this.Ri.Qla(Object(h.a)(this,this.zT,"onActiveSlideChanged"))}zT(){this.R5b.close()}N5l(Y,Sa,Mb){if(!this.na.x3e)return 16;if(1===Mb)return 32;Y=this.rb.zd();if(1!==Y.length)return 8;const oc=this.R5b.pVn();if(!oc)return H.a.$(512496449,829,15,"[ImageToTableActor::HandleConvertImageToTable] Failed to open the taskpane"),
8;const Oc=Y[0];this.na.GKk&&(this.R5b.mao(oc,Oc.slideSid,Oc.get_shapeId(),kl.aTi(Oc)),this.R5b.plm(oc));this.r$j.execute(nd=>{nd.hno(Oc.slideCid,Oc.slideSid,Oc.get_shapeId(),Cd=>{this.Y5l(oc,Oc,Cd)},()=>{this.Y5l(oc,Oc,null);return!0})});return 32}gra(Y){if(Y&&"errorDescription"in Y&&"parentPath"in Y&&"errorCode"in Y){var Sa=new vj,Mb=Y.errorDescription.split(";");Sa.errorDescription=Mb[0].split(":")[1];Sa.processId=Mb[1].split(":")[1];Sa.errorCode=Y.errorCode;H.a.$(512496448,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",
Sa.processId,Sa.errorCode,Sa.errorDescription);Mb=Y.parentPath[1].split("|");Sa.slideId=Number.parseInvariant(Mb[0]);Sa.shapeId=Number.parseInvariant(Mb[2]);Sa.html=Y.html;this.R5b.jao(Sa);this.R5b.olm()}}Y5l(Y,Sa,Mb){if(Mb&&Mb.ImgData)if(this.na.GKk)this.R5b.kao(Y,Mb.ImgData),this.R5b.olm();else{const oc=kl.aTi(Sa),Oc=Object.assign(new tk,{sessionId:Y,slideSid:Sa.slideSid,shapeId:Sa.get_shapeId(),Gng:oc,image:Mb.ImgData});this.r$j.execute(nd=>{nd.submit(ak.g8l,Oc)});this.R5b.plm(Y)}else this.R5b.kSn(Y)}Gon(Y,
Sa,Mb,oc){H.a.$(512496419,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",oc.processId,oc.errorCode,oc.errorDescription);this.R5b.WQn(Sa,oc)}s6l(Y,Sa,Mb,oc,Oc){Y=this.Xb.i1(Oc.slideSid);if(!Y)return 8;Mb=(Sa=Y.h1(Oc.shapeId))?kl.aTi(Sa):Oc.Gng;if(!Mb)return 8;H.a.$(512496418,829,50,"Replacing image with html table. Shape id: {0}",Sa.get_shapeId());Oc=this.il.fVe(!1,Y.cid,Y.sid,0,!1,Mb.iy,Mb.jy,Mb.Hw,Mb.MA,Y.Av()+1,Oc.XBm,"");this.oA.EO([Oc],Y,0,null,
Sa);this.zc.wy(Y,"ImageToTable");return 32}static aTi(Y){return Object.assign(new Ak,{iy:Y.iy,jy:Y.jy,Hw:Y.Hw,MA:Y.MA})}}Object(c.a)(kl,"ImageToTableActor",null,[]);class Qh{constructor(Y){this.shapeId=this.slideId=0;this.cHj=null;this.HFl=0;this.nEj=!1;this.Y1g=null;this.LOh=!1;this.rNh=this.sNh=this.Hkm=this.rom=null;this.sessionId=Y}}Object(c.a)(Qh,"ImageToTableConversionContext",null,[]);class ll{constructor(){this.shapeId=this.slideSid=0;this.XBm=this.Gng=null}}Object(c.a)(ll,"ReplaceImageWithHtmlTableData",
null,[]);class Rl{constructor(Y,Sa,Mb,oc){this.la=Y;this.Ld=Sa;this.Ea=Mb;this.Bhk=oc;this.kwb=null}initialize(){this.Ld.execute(Y=>{Y.Bxf(Object(h.a)(this,this.Hlm,"onFirstPartyAddInHidden"))});this.Bhk.dti(Object(h.a)(this,this.c6l,"handleMessage"))}dispose(){this.Ld.execute(Y=>{Y.v6n(Object(h.a)(this,this.Hlm,"onFirstPartyAddInHidden"))});this.Bhk.Vtm(Object(h.a)(this,this.c6l,"handleMessage"))}pVn(){this.close();const Y=new Qh(Yb.a.create().toString());Y.rom=new Promise(Mb=>{Y.Hkm=()=>{Mb(Y.sessionId)}});
const Sa={};Sa.UC=ResourceStrings.L_DataFromPicturePaneTitle;Sa.assetId="FA000000050";Sa.UW=()=>{this.K2c(Y)};Sa.nonPersistedSettings={["SessionID"]:Y.sessionId};Sa.sourceLocationOverrideResourceId=this.Ea.o3e;return 32===this.la.Ra(tb.a.kJa,2,Sa)?(this.kwb=Y,this.kwb.sessionId):this.kwb=null}close(){this.aLi(this.kwb)}K2c(Y){H.a.$(509208392,375,50,"[ImageToTablePane] Taskpane rendered. SessionId = {0}",Y.sessionId);const Sa=this.Ld.instance.EV("FA000000050");if(Sa&&Sa.settings&&"SessionID"in Sa.settings){var Mb;
let oc=de.d(Sa.settings.SessionID);({NB:Mb}=oc);oc.returnValue&&(Y.sessionId===Mb?(Y.Y1g=Sa.mq,H.a.$(509208391,375,50,"[ImageToTablePane] Taskpane rendered. InstanceId = {0}",Sa.mq)):H.a.$(509208390,375,50,"[ImageToTablePane] Failed to find the taskpane"))}}aLi(Y){Y&&Y.Y1g&&(Y.LOh=!0,this.la.Ra(tb.a.YUb,2,Y.Y1g))}mao(Y,Sa,Mb,oc){if(Y=this.xYd(Y))Y.slideId=Sa,Y.shapeId=Mb,Y.cHj=oc}Fsd(Y){if(Y=this.xYd(Y))Y.sNh=void 0}jao(Y){const Sa=this.kwb;Sa&&Sa.slideId===Y.slideId&&Sa.shapeId===Y.shapeId&&(this.kwb.rNh=
Y)}kao(Y,Sa){if(Y=this.xYd(Y))Y.sNh=Sa}plm(Y){const Sa=this.xYd(Y);Sa&&(Sa.HFl=window.setTimeout(()=>{this.jon(Sa)},this.Ea.m3e))}WQn(Y,Sa){if(Y&&Sa){var Mb=this.xYd(Y.sessionId);if(Mb&&!Mb.nEj)if(Mb.slideId=Y.slideSid,Mb.shapeId=Y.shapeId,Mb.cHj=Y.Gng,window.clearTimeout(Mb.HFl),0===Sa.errorCode){const oc={};oc.tableHtml=Sa.html;oc.imageData=Y.image;this.sendMessage(Mb.sessionId,oc)}else this.gZh(Y.sessionId,"Failed to convert image to table")}}olm(){const Y=this.kwb;if(Y&&!Y.nEj&&Y.rNh&&Y.sNh)if(window.clearTimeout(Y.HFl),
0===Y.rNh.errorCode){const Sa={};Sa.tableHtml=Y.rNh.html;Sa.imageData=Y.sNh;this.sendMessage(Y.sessionId,Sa)}else this.gZh(Y.sessionId,"Failed to convert image to table")}kSn(Y){this.gZh(Y,"Failed to render the image shape")}jon(Y){Y.nEj=!0;this.gZh(Y.sessionId,"Failed to convert image to table using AL")}c6l(Y,Sa){Sa=Sa.message;(Y=this.xYd(Sa.session_id))&&!Y.LOh&&("ACK"===Sa.cmd_type?(H.a.$(509208389,375,50,"[ImageToTablePane::MessageReceivedHandler] ACK message received.",Sa.cmd_type),Y.Hkm()):
"cancel"===Sa.cmd_type?(H.a.$(509208388,375,50,"[ImageToTablePane::MessageReceivedHandler] Cancel message received.",Sa.cmd_type),this.aLi(Y)):"insert_html"===Sa.cmd_type?(H.a.$(509208387,375,50,"[ImageToTablePane::MessageReceivedHandler] Insert message received.",Sa.cmd_type),Sa=Object.assign(new ll,{slideSid:Y.slideId,shapeId:Y.shapeId,Gng:Y.cHj,XBm:Sa.parameters}),this.aLi(Y),this.la.Ra(tb.a.ZWh,2,Sa)):H.a.$(509208386,375,15,"[ImageToTablePane::MessageReceivedHandler] Unknown message received. Message type: {0}",
Sa.cmd_type))}gZh(Y,Sa){this.sendMessage(Y,{["errorMessage"]:Sa})}sendMessage(Y,Sa){const Mb=this.xYd(Y);Mb&&Mb.sessionId===Y&&Mb.rom.then(()=>{this.Bhk.sendMessage(Mb.Y1g,Sa)})}xYd(Y){return Y&&this.kwb&&this.kwb.sessionId===Y?this.kwb:null}Hlm(Y,Sa){Sa&&this.kwb&&Sa.mq===this.kwb.Y1g&&(this.kwb=null)}}Object(c.a)(Rl,"ImageToTablePane",null,[776]);class Bk extends Sys.EventArgs{constructor(Y){super();this.message=Y}}Object(c.a)(Bk,"ImageToTablePaneMessageReceivedArgs",Sys.EventArgs,[]);class Uj{constructor(Y){this.xa=
new Zb.a;this.Ea=Y}dti(Y){this.xa.addHandler("ImageToDocPaneMessageReceived",Y)}Vtm(Y){this.xa.removeHandler("ImageToDocPaneMessageReceived",Y)}initialize(){try{window.addEventListener?window.addEventListener("message",Object(h.a)(this,this.mVg,"messageReceivedHandler"),!1):-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent?window.attachEvent("onmessage",Object(h.a)(this,this.mVg,"messageReceivedHandler")):H.a.$(507843165,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window")}catch(Y){H.a.$(507843164,
375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",Y.message,Y.stack)}}sendMessage(Y,Sa){const Mb={["imageToTablePaneWildcard"]:"."};for(const oc of Object.keys(Sa))Mb[oc]=Sa[oc];OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Y,"onCustomMessage",Mb,oc=>{oc&&H.a.$(507843163,375,15,"Couldn't deliver the message to ImageToDoc pane, status: {0}.",oc)})}mVg(Y){if(Y&&this.U$d(Y.origin)){let Sa=de.d(Y.data);({NB:Y}=Sa);
Sa.returnValue&&Y&&"."===Y.imageToTablePaneWildcard&&this.xa.raiseEvent("ImageToDocPaneMessageReceived",new Bk(Y))}}U$d(Y){return Y&&Y.length&&"null"!==Y?Y===this.Ea.n3e:!1}}Object(c.a)(Uj,"ImageToTablePaneMessenger",null,[775]);var th=a(1311);class Sl{constructor(){this.Scenario=0;this.ShapeIds=null;this.SlideSid=this.SlideCid=0}}Object(c.a)(Sl,"ImageTransformInfo",null,[]);class uk{constructor(Y,Sa,Mb,oc){this.la=Y;this.rb=Sa;this.ya=Mb;this.Fd=oc}initialize(){this.Fd.APl(Object(h.a)(this,this.Gnm,
"onSuggestedActionClick"))}dispose(){this.Fd.Rtm(Object(h.a)(this,this.Gnm,"onSuggestedActionClick"))}Gnm(Y,Sa){if((Y=Sa.card)&&this.ya.Ia){var Mb=this.ya.Ia.Nj(),oc=[];Sa=[];for(var Oc of Mb)for(const nd of Y.Selects)if(nd.Id===Oc.get_shapeId()){Array.add(oc,Oc);Array.add(Sa,Oc.get_shapeId());break}this.rb.Rx();this.rb.nj();this.rb.Wna(oc,!0);if(4===Y.Type){if(Oc=this.ya.presentation)Oc.WIb=Object.assign(new Sl,{Scenario:Y.Scenario,SlideSid:this.ya.Ia.sid,SlideCid:this.ya.Ia.cid,ShapeIds:Sa})}else this.la.Eb(th.a.Yid(Y.ExecutionActionName),
2)}}}Object(c.a)(uk,"SuggestedActionsHandler",null,[]);class Vk{constructor(){this.ga=null;this.Tfa=!1}get name(){return"PowerPointWebEditor.Designer"}oc(Y){this.ga=Y;this.ga.register(766,"PowerPointWebEditor.IDesignerView").oa().pa(()=>new oi(this.ga.resolve("Box4.IHtmlViewRootFactory"),this.ga.resolve("PowerPoint.IPathManager"),this.ga.resolve("PowerPointWebEditor.IDesignerPane"),this.ga.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.ga.resolve("PowerPointWebEditor.IDesignerContext"),this.ga.resolve("Box4.IViewManager"),
this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("Common.IClickInputManager"),this.ga.resolve("Common.IPointerInputManager"),this.ga.resolve("PowerPointWebEditor.IInputHandlerManager"),this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.ga.register(767,"PowerPointWebEditor.IDesignerPane").oa().pa(()=>
new jk(this.ga.resolve("Box4.IAppFrame"),this.ga.resolve("PowerPoint.IPathManager"),this.ga.resolve("Common.IClickInputManager"),this.ga.resolve("PowerPointWebEditor.IInputHandlerManager"),this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.IDesignerContext"),this.ga.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.ga.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.ga.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.IInboundHelper"),this.ga.resolve("PowerPointWebEditor.ITaskPaneManager")));this.ga.register(768,"PowerPointWebEditor.IDesignerViewHelper").oa().pa(()=>new Te(this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.IDesignerContext"),
this.ga.resolve("Common.ITaskManager"),this.ga.resolve("PowerPoint.IPathManager"),this.ga.eb("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")));this.ga.register(769,"PowerPointWebEditor.IDesignerManager").oa().pa(()=>new Nk(this.ga.resolve("PowerPointWebEditor.IDesignerView"),this.ga.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.ga.resolve("PowerPointWebEditor.IDesignerContext"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("Common.IActionManagerExtended"),
this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("Common.Transaction.ITransactionFactory"),this.ga.resolve("PowerPointWebEditor.View.IViewEventSource"),this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("Common.ITaskManager"),this.ga.eb("PowerPointWebEditor.IDesignerServiceProvider"),this.ga.eb("PowerPointWebEditor.IApplyDesignerSuggestions"),this.ga.eb("Common.ISystemInitiatedFeedback")));
this.ga.register(770,"PowerPointWebEditor.Designer.IDesignerPreviewImageView").oa().pa(()=>new vl(this.ga.resolve("PowerPoint.IBrowserHelperManager"),this.ga.resolve("PowerPointWebEditor.IActiveSlideViewManager")));this.ga.register(771,"PowerPointWebEditor.IDesignerContext").oa().pa(()=>new ik(this.ga.eb("PowerPointWebEditor.IDesignerServiceProvider")));this.ga.register(772,"PowerPointWebEditor.Infrared.IIdeasContext").oa().pa(()=>new Hi(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings")));
this.ga.register(773,"PowerPointWebEditor.IFixItManager").oa().pa(()=>new Tk(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("Common.Transaction.ITransactionFactory"),this.ga.resolve("PowerPointWebEditor.View.IViewEventSource"),this.ga.resolve("PowerPointWebEditor.IFixItContext"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.ga.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),
this.ga.resolve("PowerPointWebEditor.IActionNameResolver"),this.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.ga.resolve("PowerPointWebEditor.IErrorHandler")));this.ga.register(774,"PowerPointWebEditor.IFixItContext").oa().pa(()=>new il);(this.Tfa=this.ga.resolve("PowerPointWebEditor.IApplicationContext").Pd.li)&&this.ga.register(Lj.a,"PowerPointWebEditor.PodsInfoSender").oa().pa(()=>new Lj.a(n.AFrameworkApplication.$d,this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.ga.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.ga.resolve("PowerPointWebEditor.IErrorHandler"),this.ga.resolve("Common.ITaskManager"),this.ga.resolve("Common.IAppSettingsManager")));this.ga.register(kl,"PowerPointWebEditor.Designer.ImageToTableActor").oa().pa(()=>new kl(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.ga.resolve("PowerPointWebEditor.IGraphTransactionHelper"),this.ga.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("PowerPointWebEditor.IShapeEditor"),this.ga.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.ga.resolve("PowerPointWebEditor.Designer.IImageToTablePane"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings")));this.ga.register(775,"PowerPointWebEditor.Designer.IImageToTablePaneMessenger").oa().pa(()=>
new Uj(this.ga.resolve("PowerPointWebEditor.IApplicationSettings")));this.ga.register(776,"PowerPointWebEditor.Designer.IImageToTablePane").oa().pa(()=>new Rl(this.ga.resolve("Common.IActionManagerExtended"),this.ga.eb("PowerPointWebEditor.IAppForOfficeManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger")));this.ga.register(uk,"PowerPointWebEditor.Designer.SuggestedActionsHandler").oa().pa(()=>new uk(this.ga.resolve("Common.IActionManagerExtended"),
this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.View.IViewEventSource")))}init(){const Y=this.ga.resolve("Common.IAppSettingsManager");Y.Wf(()=>{if(Y.getBooleanAppSetting(Ai.a.aze)){this.Tfa&&this.ga.resolve("PowerPointWebEditor.PodsInfoSender");var Sa=this.ga.resolve("PowerPointWebEditor.IDesignerView");const Mb=vb.a.instance.resolve("PowerPointWebEditor.IDesignerPane").va;Sa.qMa(Mb);
Sa.i5d();Sa=null;if(Y.getBooleanAppSetting(Ai.a.xSd)&&(Sa=this.ga.resolve("Common.App.OAuth.IOAuthManager"))){const oc=new Date;Sa.hP(Y.Ma(Ai.a.Pye),Y.Ma(Ai.a.BSd)).then(Oc=>{const nd=+new Date-+oc;Oc.IsSuccess?H.a.$(512262863,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Latency: "+nd):(H.a.$(512262862,829,15,"PPTWebEditorDesignerPackage::Init Failed to get AAD token with error: "+Oc.ErrorCode+": "+Oc.ErrorMessage),H.a.$(512262861,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+
nd))}).catch(Oc=>{H.a.$(512262860,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+(+new Date-+oc));H.a.$(512262859,829,15,"PPTWebEditorDesignerPackage::Init - Token retrival failed:{0}",Oc)})}Sa=new hj(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("Box4.IClipboardDataHelper"),this.ga.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.ga.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("PowerPointWebEditor.IDesignerPane"),this.ga.resolve("PowerPointWebEditor.IDesignerView"),this.ga.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.ga.resolve("PowerPointWebEditor.IDesignerManager"),this.ga.resolve("PowerPointWebEditor.IDesignerContext"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.ga.resolve("PowerPointWebEditor.View.IViewEventSource"),
this.ga.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.ga.resolve("PowerpointPresence.IPresenceEventHandlers"),this.ga.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"),this.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.ga.resolve("Common.ITaskManager"),this.ga.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),
this.ga.resolve("PowerPointWebEditor.Infrared.IIdeasContext"),this.ga.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.ga.eb("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"),Sa,this.ga.eb("PowerPointWebEditor.IAgendaMetrics"),this.ga.eb("PowerPointWebEditor.AgendaConverter.IAgendaConverterView"),this.ga.resolve("PowerPointWebEditor.ICopilotEnableStateChecker"));Sa.Kb();Sa.Ae();(new hl(this.ga.resolve("Common.IActionManagerExtended"),
this.ga.resolve("Common.Transaction.ITransactionFactory"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.ga.resolve("PowerPointWebEditor.IFixItContext"),this.ga.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
this.ga.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.ga.resolve("Common.ITaskManager"),this.ga.resolve("PowerPointWebEditor.IErrorHandler"))).Kb();this.ga.resolve("PowerPointWebEditor.IApplicationSettings").ySd&&this.ga.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").setup();this.ga.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger").initialize();this.ga.resolve("PowerPointWebEditor.Designer.IImageToTablePane").initialize();this.ga.resolve("PowerPointWebEditor.Designer.ImageToTableActor").initialize();
this.ga.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").initialize();this.ga.resolve("PowerPointWebEditor.IFixItManager")}else H.a.$(512262858,829,50,"Designer setting is disabled")})}dispose(){this.ga.resolve("PowerPointWebEditor.IApplicationSettings").ySd&&this.ga.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").dispose();this.ga.resolve("PowerPointWebEditor.Designer.IImageToTablePane").dispose();this.ga.resolve("PowerPointWebEditor.Designer.ImageToTableActor").dispose();
this.ga.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").dispose();this.ga.resolve("PowerPointWebEditor.IFixItManager").dispose()}static main(){b.a.instance.Jc(wa.a(new Vk,0))}}Object(c.a)(Vk,"PPTWebEditorDesignerPackage",null,[4,5]);class kk{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.PenMinutes"}oc(Y){this.ga=Y}init(){const Y=this.ga.Db("Common.App.PenMinutesManager.IPenMinutesManager");Y&&Y.lbo()}dispose(){}static main(){b.a.instance.Jc(new kk)}}Object(c.a)(kk,
"PPTWebEditorPenMinutesPackage",null,[4,5]);var Yl=a(1418);class wj{}Object(c.a)(wj,"TextToSmartArtSuggestionData",null,[]);class Wk{constructor(){this.suggestions=[]}}Object(c.a)(Wk,"TextToSmartArtSuggestionNotificationData",null,[]);class Nh{}Nh.Iel="ShapePresence";Nh.slideNavigation="SlideNavigation";Nh.p8e="WebActionId:";Nh.laa="SelectionChanged";Nh.Clh="ShapePositionChanged";Nh.p8c="Retrigger";Nh.vuk="NoSuggestions";Nh.aDn="LowSuggestions";Nh.lVh="NewSession";Nh.Lfo="SlideShowStarted";Nh.Dua=
"ServerError";Nh.zUl="ClientSuggestionTimeOut";Object(c.a)(Nh,"ReplaceObjectResetReason",null,[]);class Yi{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg,yh,qg,Ug,Zh,Ii){this.Qod=this.rek=this.jje=!1;this.sa=Y;this.Na=Sa;this.ya=Mb;this.zc=oc;this.NYa=Oc;this.nh=nd;this.la=Cd;this.S5=Zd;this.$Xc=we;this.T5=Qe;this.Rmc=Vf;this.d8b=eg;this.ZSh=zg;this.Fd=yh;this.uN=qg;this.Yb=Ug;this.Gb=Zh;this.xU=kf;this.Eod=Ii;this.tP=!1}get vs(){return this.tP}setup(){this.vs||(this.Oz(),this.rek=2===this.Gb.mode,
this.tP=!0)}Oz(){this.sa.AO(Object(h.a)(this,this.tE,"onSelectionChanged"));this.Rmc.sTe(Object(h.a)(this,this.Bqk,"markedUndo"));this.nh.cU(Object(h.a)(this,this.zT,"onActiveSlideChanged"));this.d8b.Vjc(Object(h.a)(this,this.exa,"onSlidePresenceChanged"));this.Fd.cQl(Object(h.a)(this,this.Vzk,"onReplaceObjectResponse"));this.$Xc.wVm(Object(h.a)(this,this.Wzk,"onReplaceObjectViewDragEnd"));this.NYa.WJd(Object(h.a)(this,this.zwk,"onApplyReplaceObjectBlockingStateChanged"));this.nh.yxf(Object(h.a)(this,
this.nxh,"updateEditState"));this.Gb.zO(Object(h.a)(this,this.uw,"onAppFrameModeSwitched"));this.Fd.iti(Object(h.a)(this,this.Wkm,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval"));this.Fd.hti(Object(h.a)(this,this.Vkm,"onApplyReplaceObjectSuggestionAfterSelectionRemoval"));this.Fd.Jxf(Object(h.a)(this,this.Iac,"onUndoRedo"))}dispose(){this.vs&&(this.sa.gib(Object(h.a)(this,this.tE,"onSelectionChanged")),this.Rmc.lYh(Object(h.a)(this,this.Bqk,"markedUndo")),this.nh.Qla(Object(h.a)(this,this.zT,
"onActiveSlideChanged")),this.d8b.zch(Object(h.a)(this,this.exa,"onSlidePresenceChanged")),this.Fd.qum(Object(h.a)(this,this.Vzk,"onReplaceObjectResponse")),this.$Xc.D6n(Object(h.a)(this,this.Wzk,"onReplaceObjectViewDragEnd")),this.NYa.x4e(Object(h.a)(this,this.zwk,"onApplyReplaceObjectBlockingStateChanged")),this.Gb.c6(Object(h.a)(this,this.uw,"onAppFrameModeSwitched")),this.nh.gch(Object(h.a)(this,this.nxh,"updateEditState")),this.Fd.SYk(Object(h.a)(this,this.Wkm,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval")),
this.Fd.RYk(Object(h.a)(this,this.Vkm,"onApplyReplaceObjectSuggestionAfterSelectionRemoval")),this.Fd.qch(Object(h.a)(this,this.Iac,"onUndoRedo")),this.tP=!1)}Vsd(Y){return this.zQj()?this.ZSh.nAh(Y):!1}selectShape(Y){Y&&this.sa.selectShape(Y,!1)}FOh(Y){switch(Y){case tb.a.bkc:case tb.a.Mre:case tb.a.x0c:case tb.a.y0c:case tb.a.z0c:case tb.a.A0c:case tb.a.vta:return!0;default:return!1}}zQj(){return this.jje&&this.rek}hpm(Y,Sa){const Mb=[];if(Eb.a.wb(Y))return Mb;Y=Y.split(";");if(Y.length<Sa)return H.a.$(507843422,
829,10,"BaseReplaceObjectManager::ParseSuggestions - suggestionCount:{0}, resultLength:{1}",Sa,Y.length),Mb;for(let oc=0;oc<Sa;++oc){const Oc=Y[oc].split(":");if(3!==Oc.length)throw Sa=String.format("Invalid format of suggestion item. Index: {0}, SuggestionItem: {1}",oc,Y[oc]),H.a.$(507843421,829,50,"BaseReplaceObjectManager::ParseSuggestions - {0}",Sa),Error.create(Sa);const nd=Yl.a.$4l(Number.parseInvariant(Oc[1]));Array.add(Mb,Object.assign(new wj,{index:Oc[0],labelText:Eb.a.wb(nd)?ResourceStrings.L_SmartArt:
nd,imageData:this.HLh(Oc[2])}))}return Mb}Wkm(){this.Qod=!0}Vkm(){this.Qod=!1}Iac(Y,Sa){this.gna(Sa.actionId)}HLh(Y){return Eb.a.wb(Y)?null:"data:image/png;base64,"+Y}uw(Y){H.a.$(507843420,829,50,"BaseReplaceObjectManager::OnAppFrameModeSwitched, frame mode switched to :{0}",Y.mode);this.rek=2===Y.mode}nxh(){this.jje||H.a.$(507843419,829,50,"BaseReplaceObjectManager::UpdateEditState, updating edit state");this.jje=!0}y1e(Y,Sa,Mb,oc){this.Eod.execute(Oc=>{const nd=Object.assign(new Wk,{correlationId:Y,
shapeId:Sa,suggestions:Mb});Oc.notifyTextToSmartArtSuggestion(oc,nd)})}t6l(Y,Sa,Mb){if(Sa.Kfa)if(Sa.fub&&0!==Y.DCb)H.a.$(507843417,829,10,"HandleReplaceObjectResponse - first reponse should have notification type : Normal. NotificationType: {0}",Y.DCb);else{if(0===Y.DCb){if(0>=Y.CYa){H.a.$(507843416,829,50,"HandleReplaceObjectResponse - Reponse failed. CorrelationId {0}",Y.correlationId);this.closeSession(Sa,Nh.vuk);return}if(Y.CYa<Mb.Q4e){H.a.$(507843415,829,50,"HandleReplaceObjectResponse - not enough suggestions returned. CorrelationId {0}",
Y.correlationId);this.closeSession(Sa,Nh.aDn);return}Sa.fub=!1;Sa.suggestions=this.hpm(Y.qpb,Y.CYa);Sa.suggestionCount=Y.CYa;H.a.$(507843414,829,50,"HandleReplaceObjectResponse - suggestions returned: {0}. CorrelationId {1}",Sa.suggestionCount,Y.correlationId)}else if(1===Y.DCb){if(Eb.a.wb(Y.qpb)){H.a.$(507843413,829,10,"HandleReplaceObjectResponse - empty suggestions. CorrelationId {0}",Y.correlationId);return}Sa.suggestions=this.hpm(Y.qpb,Y.CYa);Sa.o7e=new Date;Mb.TTa&&this.y1e(Y.correlationId,
Sa.shapeId,Sa.suggestions,Mj.a.success)}else 2===Y.DCb&&(Sa.t_j=!1,Sa.shapeId=Y.shapeId,this.y1e(Sa.correlationId,Y.shapeId,Sa.suggestions,Mj.a.success));Mb=Sa.shape;Sa.slide&&Sa.slide.isConnected&&Mb&&Mb.isConnected&&this.xU.FPc(Mb)&&this.zQj()&&(1===Y.DCb?this.T5.dtm(Sa.correlationId):this.T5.O_h(Mb))}else H.a.$(507843418,829,15,"HandleReplaceObjectResponse - No session active. Reponse CorrelationId: {0}",Y.correlationId)}}Object(c.a)(Yi,"BaseReplaceObjectManager",null,[759,785]);class Ck{}Ck.none=
"";Ck.Clh="ShapePositionChanged";Object(c.a)(Ck,"ReplaceObjectRetriggerReason",null,[]);class Vj{}Vj.selectShape="SelectShape";Vj.p8c="Retrigger";Vj.QXm="AugLoopRetrigger";Vj.OXm="AugLoopDefault";Object(c.a)(Vj,"ReplaceObjectTrigger",null,[]);var Oj=a(607);class Cl extends Yi{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg,yh,qg,Ug,Zh,Ii,Jl,Tl,jm,Pj){super(Zd,Mb,oc,Oc,nd,Cd,we,Qe,kf,Vf,eg,yh,qg,Ug,Zh,Jl,Tl,jm,Pj);this.bDa=Y;this.hQh=Sa;this.pGn=zg;this.na=Ii;this.dhm=this.na.P4e}Oz(){this.na.T7c?
this.hQh.execute(Y=>{Y.addEventHandler("ShapeTextConvertable",Object(h.a)(this,this.Lrm,"processShapeTextConvertibleClientAL"))}):this.bDa.execute(Y=>{Y.addEventHandler("ShapeTextConvertable",Object(h.a)(this,this.aNk,"processShapeTextConvertible"))});this.Fd.HQl(Object(h.a)(this,this.SVh,"onSlideShowStarted"));super.Oz()}dispose(){this.vs&&(this.na.T7c?this.hQh.execute(Y=>{Y.removeEventHandler("ShapeTextConvertable",Object(h.a)(this,this.Lrm,"processShapeTextConvertibleClientAL"))}):this.bDa.execute(Y=>
{Y.removeEventHandler("ShapeTextConvertable",Object(h.a)(this,this.aNk,"processShapeTextConvertible"))}),this.Fd.Mum(Object(h.a)(this,this.SVh,"onSlideShowStarted")));super.dispose()}aNk(Y,Sa){if(Y&&Sa){try{var Mb=de.a(Y);var oc=de.a(Sa)}catch(nd){H.a.$(508692432,829,10,"AugmentationLoopReplaceObjectManager::OnSmartArtConvertable - Try parse aug response failed");return}if(Mb&&!isNaN(Mb.sid)&&!isNaN(Mb.cid)&&!isNaN(Mb.shapeId)&&this.ya.Ia&&(Y=new Date(Mb.c),H.a.$(508692431,829,50,"ALEvent received: Slide:{0}|{1}, Shape:{2}, TriggerName:{3}, ElapsedTimeInMs:{4}",
Mb.sid,Mb.cid,Mb.shapeId,Mb.t,Mb.c?(new Date).getTime()-Mb.c:-1),(Sa=this.ya.Ia.h1(Mb.shapeId))&&(Rb.a.contains(this.o4l(),Sa.get_shapeId())||"activeSlideChanged"===Mb.t)))if(oc&&!oc.isTextConvertible)this.T5.mec(Sa,!0);else{var Oc=this.S5.T4f(Sa.get_shapeId());if(Oc&&Oc.nIb&&(Oc=new Oj.a(Sa,Oc.KLb),this.la.Ra(tb.a.Yhb,2,Oc),!Oc.jCa))return;this.Vsd(Sa)&&this.xIb(this.ya.Ia,Sa,oc&&oc.smartArtInfo?oc.smartArtInfo.length:0,Mb.t||Vj.OXm,Ck.none,Y)}}}Lrm(Y,Sa,Mb,oc){Sa&&oc&&oc.ContextId&&oc.Payload&&
this.aNk(oc.ContextId,oc.Payload)}SVh(){this.UKi(Nh.Lfo)}tE(Y,Sa){if(!this.vs)H.a.$(508692430,829,50,"AugmentationLoopReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.Qod&&(Sa.cJ.length||!this.Na.currentScope||this.Na.currentScope.name!==fc.a.sh)){Y=this.o4l();for(const Mb of this.S5)Mb.Kfa&&!Array.contains(Y,Mb.shapeId)&&this.closeSession(Mb,Nh.laa);this.dhm&&!Array.contains(Y,this.T5.EXe)&&this.T5.T5n()}}Wzk(Y,Sa){this.vs?(Y=this.S5.T4f(Sa.shape.get_shapeId()))&&Y.Kfa&&
(Sa=Y.shape,this.closeSession(Y,Nh.Clh),this.Vsd(Sa)&&this.xIb(this.ya.Ia,Sa,0,Vj.QXm,Ck.Clh)):H.a.$(508692429,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}Bqk(Y,Sa){Sa.Smd&&this.gna(Sa.actionId)}zT(){this.UKi(Nh.slideNavigation)}exa(Y,Sa){if(Sa.Bwa&&Sa.shapes)for(const Mb of Sa.shapes)(Y=this.S5.T4f(Mb))&&Y.Kfa&&this.closeSession(Y,Nh.Iel)}Vzk(Y,Sa){(Y=this.S5.r0d(Sa.correlationId))?this.t6l(Sa,Y,this.na):H.a.$(508692428,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectResponse, No session active. Reponse CorrelationId: {0}",
Sa.correlationId)}zwk(){if(this.vs)for(const Y of this.S5)Y.l9d&&0===Y.suggestionType&&!this.zc.Hd(this.ya.presentation)&&(Y.l9d=!1,this.T5.mec(Y.shape,!0))}Vsd(Y){const Sa=this.S5.UOl;return 1<=Sa?(H.a.$(508692427,829,50,"AugmentationLoopReplaceObjectManager::ShouldGenerateSuggestion, too many floaties[{0}] showing on the slide.",Sa),!1):super.Vsd(Y)}xIb(Y,Sa,Mb,oc,Oc,nd){nd=void 0===nd?null:nd;try{let Cd=this.S5.T4f(Sa.get_shapeId());Cd&&this.closeSession(Cd,Nh.lVh);Cd=this.S5.pIh(Y,Sa.get_shapeId(),
oc,Oc,this.na);Cd.Wsh=nd;Cd.nIb="richEditTextUnicodeChanged"===oc;this.T5.axh(Cd.correlationId);const Zd=this.pGn.rxm(Cd);H.a.$(508692426,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, state:{4}",Cd.correlationId,Cd.slide.sid,Cd.slide.cid,Cd.shapeId,Zd);H.a.$(508692425,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion, text can convert to SmartArt, correlation id: {0}, returned suggestion count: {1}, should take suggestion count: {2}, trigger reason: {3}",
Cd.correlationId,Mb,Math.min(Mb,this.na.rEe),oc);Mb&&this.na.R4e&&(Mb=Math.min(Mb,this.na.rEe),Cd.suggestions=this.pdn(Mb),Cd.suggestionCount=Mb,Cd.fub=!1,this.T5.O_h(Sa));0===Zd&&this.na.TTa&&this.y1e(Cd.correlationId,Cd.shapeId,[],Mj.a.pending)}catch(Cd){H.a.$(508692424,829,10,"GenerateSuggestion failed!! {0} ",Cd.message)}}pdn(Y){const Sa=Array(Y);for(let Mb=0;Mb<Y;Mb++)Array.add(Sa,Object.assign(new wj,{index:Mb.toString(),labelText:ResourceStrings.l_Loading,imageData:null}));return Sa}gna(Y){this.vs?
this.FOh(Y)||this.UKi(Nh.p8e+this.uN.$la(Y)):H.a.$(508692423,829,15,"AugmentationLoopReplaceObjectManager::HandleAction - called before setup")}Zco(Y){if(!this.dhm)return!1;const Sa=this.sa.zd();return Y.nIb&&Array.contains(Sa,Y.shape)}closeSession(Y,Sa){0===Y.suggestionType&&(Sa===Nh.vuk?this.T5.mec(Y.shape,!0):Y.nIb&&this.T5.mec(Y.shape,!0,Sa!==Nh.lVh,this.Zco(Y)),this.S5.SNh(Y,Sa),this.na.TTa&&this.y1e(Y.correlationId,Y.shapeId,Y.suggestions,Mj.a.W0c))}UKi(Y){for(const Sa of this.S5)this.closeSession(Sa,
Y)}o4l(){const Y=this.sa.zd(),Sa=[];Y&&Y.forEach(Mb=>{Array.add(Sa,Mb.get_shapeId())});return Sa}}Object(c.a)(Cl,"AugmentationLoopReplaceObjectManager",Yi,[]);class Jg{constructor(Y,Sa){this.disabled=!1;this.Rfm=Wc.App.Qp;this.na=Y;this.Yb=Sa}bym(Y){this.disabled=!0;this.Rfm=new Date;const Sa=new B.a(2,1,this.na.pEe,()=>{this.disabled&&+new Date-+this.Rfm>=this.na.pEe&&Y()});this.Yb.Rb(Sa)}Mao(Y){const Sa=new B.a(2,1,550,()=>{Y()});this.Yb.Rb(Sa)}static zno(Y,Sa){return 7<=Y&&8>=Y&&1!==Sa}}Object(c.a)(Jg,
"FlyoutAnchorTimer",null,[]);var ja=a(606);class qb{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg,yh){this.yR=null;this.Qod=!1;this.Fd=Sa;this.sa=Y;this.S5=Mb;this.ya=oc;this.La=Oc;this.na=nd;this.T5=Cd;this.Jm=Zd;this.xU=we;this.d8b=Qe;this.NYa=kf;this.J8a=Vf;this.LSg=eg;this.uN=zg;this.kc=yh}Oz(){this.Fd.TPl(Object(h.a)(this,this.Ulm,"onIconSuggestionNotification"));this.sa.AO(Object(h.a)(this,this.tE,"onSelectionChanged"));this.Fd.iti(Object(h.a)(this,this.Ukm,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));
this.Fd.hti(Object(h.a)(this,this.Tkm,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Fd.SPl(Object(h.a)(this,this.Tlm,"onIconChanged"));this.d8b.Vjc(Object(h.a)(this,this.exa,"onSlidePresenceChanged"));this.NYa.WJd(Object(h.a)(this,this.uTa,"onBlockingStateChanged"));this.LSg.sTe(Object(h.a)(this,this.Nue,"onMarkedUndo"))}jxl(){this.Fd.hum(Object(h.a)(this,this.Ulm,"onIconSuggestionNotification"));this.sa.gib(Object(h.a)(this,this.tE,"onSelectionChanged"));this.Fd.SYk(Object(h.a)(this,
this.Ukm,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Fd.RYk(Object(h.a)(this,this.Tkm,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Fd.gum(Object(h.a)(this,this.Tlm,"onIconChanged"));this.d8b.zch(Object(h.a)(this,this.exa,"onSlidePresenceChanged"));this.NYa.x4e(Object(h.a)(this,this.uTa,"onBlockingStateChanged"));this.LSg.lYh(Object(h.a)(this,this.Nue,"onMarkedUndo"))}dispose(){this.jxl()}setup(){this.Oz()}Ukm(){this.Qod=!0}Tkm(){this.Qod=!1}Tlm(Y,Sa){Sa&&this.yR&&this.yR.xhh&&
this.yR.slide.sid===Sa.slideId.sid&&this.yR.slide.cid===Sa.slideId.cid&&this.yR.shapeId===Sa.shapeId&&this.yR.$cb===Sa.Q9&&(this.yR.z6k=Sa.iconName)}exa(Y,Sa){if(Sa.Bwa&&Sa.shapes&&this.yR)for(const Mb of Sa.shapes)this.yR.shapeId===Mb&&this.CXa(Nh.Iel)}Nue(Y,Sa){Sa.Smd&&!this.FOh(Sa.actionId)&&this.CXa(Nh.p8e+this.uN.$la(Sa.actionId))}FOh(Y){switch(Y){case tb.a.bkc:case tb.a.Mre:case tb.a.x0c:case tb.a.y0c:case tb.a.z0c:case tb.a.A0c:case tb.a.vta:return!0;default:return!1}}uTa(){if(this.yR){const Y=
this.yR.shape,Sa=this.La.Wv(Y);Y&&Sa&&!this.J8a.Hd(Sa)&&(this.yR.l9d=!1,this.T5.mec(Y,!0),this.yR.Ush=new Date,this.yR.CXa(Nh.laa))}}tE(){if(!this.Qod){var Y=this.La.zOa(this.sa.zd());if(Y){if(this.yR&&this.yR.Kfa){if(ja.a.Y5e(Y.lVa,this.yR.lVa))return;this.CXa(Nh.laa)}this.Vsd(Y)&&this.xIb(this.ya.Ia,Y,Vj.selectShape)}else this.yR&&this.yR.Kfa&&this.CXa(Nh.laa)}}xIb(Y,Sa,Mb){this.yR=this.S5.Ljd(Y,Sa.get_shapeId(),Mb,"",this.na,Sa.get_smartArtModelId());this.yR.fub=!0;this.T5.axh(this.yR.correlationId);
H.a.$(507843340,829,50,"ReplaceIconManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, SmartArtSubNodeId:{4}",this.yR.correlationId,this.yR.slide.sid,this.yR.slide.cid,this.yR.shapeId,this.yR.$cb);const oc=Sa.get_smartArtModelId()?this.La.Wv(Sa):Sa;oc?this.Jm.r1l(Y.cid,Y.sid,oc.get_shapeId(),this.xU.iMh(oc),this.xU.hMh(oc),Sa.get_smartArtModelId(),74,74,this.yR.correlationId,Mb,Object(h.a)(this,this.iSn,"onIconSuggestionResponseSuccess"),Object(h.a)(this,this.yve,"onTaskFailure")):
H.a.$(507843339,829,15,"Parent ShapeNode of a {0} is null",Sa.get_smartArtModelId()?"SmartArtSubShape":"NormalShape")}iSn(Y){if(Y&&Y.SuggestionResult){var Sa=Y.CorrelationId,Mb=this.S5.r0d(Sa);if(Mb)if(Mb.Kfa){Sa=null;try{Sa=Sys.Serialization.JavaScriptSerializer.deserialize(Y.SuggestionResult)}catch(oc){H.a.$(507843335,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - Deserialize exception: {0}",oc)}if(Sa){Mb.suggestions=this.gWn(Sa);Mb.o7e=new Date;if(Mb.fub){if(this.q9l(Mb)){H.a.$(507843333,
829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - client suggestion timeout in {0}, expected in {1}",Mb.RHf,this.na.ird);this.CXa(Nh.zUl);return}H.a.$(507843332,829,50,"ReplaceIconManager::OnReplaceObjectResponse, response arrives before notification");Mb.suggestionCount=Mb.suggestions?Mb.suggestions.length:0;Mb.fub=!1;this.T5.O_h(Mb.shape)}this.T5.dtm(Mb.correlationId)}else this.CXa(Nh.Dua),H.a.$(507843334,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - suggestion result is null")}else H.a.$(507843336,
829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, sessio is not active . Selection might change to new shape, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.yR?this.yR.correlationId:"",Sa);else H.a.$(507843337,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",Sa)}else this.CXa(Nh.Dua),H.a.$(507843338,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - response object or reponse suggestionresult is null")}yve(Y){this.CXa(Nh.Dua);
H.a.$(507843331,829,15,"ReplaceIconManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",Y.HttpStatusCode);return!0}Vsd(Y){return this.kc.oq?Y.get_smartArtModelId()&&Y.get_isSVGBlipFilled()?(Y=this.La.Wv(Y),!!Y&&!Y.EG):!1:!1}CXa(Y){this.yR&&(this.T5.mec(this.yR.shape,!0),this.S5.SNh(this.yR,Y),this.yR=null)}HLh(Y){return Eb.a.wb(Y)?null:Y.startsWith("<svg")?"data:image/svg+xml;charset=utf8,"+encodeURIComponent(Y):"data:image/png;base64,"+Y}gWn(Y){const Sa=[];if(!Y||
!Y.length)return Sa;for(let Mb=0;Mb<Y.length;++Mb){const oc=Object.assign(new wj,{index:Y[Mb].Index.toString(),labelText:Y[Mb].Label,imageData:this.HLh(Y[Mb].Render),renderData:this.HLh(Y[Mb].Replace)});Array.add(Sa,oc)}return Sa}D4m(Y,Sa){const Mb=[];if(Eb.a.wb(Y)||!Sa)return Mb;for(var oc=0;oc<Sa;++oc){var Oc=Object.assign(new wj,{index:oc.toString(),labelText:"",imageData:null,renderData:null});Array.add(Mb,Oc)}Y=Y.split(";");if(Y.length-1!==Sa)return H.a.$(507843330,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, the suggestion counts parsing from suggestion string do not match, expected:{0}, actural:{1} ",
Mb.length,Sa),Mb;for(oc=0;oc<Sa;++oc)Oc=Y[oc].indexOf(":"),0>Oc?H.a.$(507843329,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, Suggestion string does not contain :"):Mb[oc].labelText=Y[oc].substr(Oc+1);return Mb}fWn(Y){let Sa,Mb,oc,Oc;Sa="";oc=Mb=0;Oc=null;if(Eb.a.wb(Y))return H.a.$(507843299,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue is null or empty"),{returnValue:!1,correlationId:Sa,CYa:Mb,avk:oc,suggestions:Oc};const nd=Y.split("|");if(4!==nd.length)return H.a.$(507843298,
829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue length is not equals to 4, actural:"+Y.length),{returnValue:!1,correlationId:Sa,CYa:Mb,avk:oc,suggestions:Oc};Sa=nd[0];Mb=parseInt(nd[1]);oc=Number.parseInvariant(nd[2]);Oc=this.D4m(nd[3],Mb);return{returnValue:!0,correlationId:Sa,CYa:Mb,avk:oc,suggestions:Oc}}Ulm(Y,Sa){let Mb,oc,Oc,nd;if((()=>{let Zd=this.fWn(Sa.qpb);({correlationId:Mb,CYa:oc,avk:Oc,suggestions:nd}=Zd);return Zd})().returnValue)if(Y=this.S5.r0d(Mb))if(Y.Kfa&&
Y.fub){var Cd=Y.shape;0===Oc&&(0>=oc?(H.a.$(507843294,829,50,"ReplaceIconManager::OnReplaceObjectResponse, Reponse failed. CorrelationId {0}",Mb),this.CXa(Nh.vuk)):this.q9l(Y)?(H.a.$(507843293,829,15,"ReplaceIconManager::OnIconSuggestionNotification - client suggestion timeout in {0}, expected in {1}",Y.RHf,this.na.ird),this.CXa(Nh.zUl)):(Y.fub=!1,Y.suggestionCount=oc,Y.suggestions=nd,H.a.$(507843292,829,50,"ReplaceIconManager::OnReplaceObjectResponse, get response from GetReplaceObject request, correlation id: {0}, suggestion count: {1}",
Y.correlationId,Y.suggestionCount),this.T5.O_h(Cd)))}else H.a.$(507843295,829,50,"ReplaceIconManager::OnIconSuggestionNotification: Skip notification since: IsSessionActive {2}, IsWaitingForResponse {3}. Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.yR?this.yR.correlationId:"",Mb,Y.Kfa,Y.fub);else H.a.$(507843296,829,50,"ReplaceIconManager::OnIconSuggestionNotification, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",Mb);else H.a.$(507843297,829,
50,"ReplaceIconManager::OnIconSuggestionResponse, IconSuggestionnotification parse failed")}q9l(Y){const Sa=new Date,Mb=Y.KLb,oc=this.na.ird;return Sa&&Mb&&0<oc&&+Sa-+Mb>oc?(Y.RHf=+Sa-+Mb,!0):!1}}Object(c.a)(qb,"ReplaceIconManager",null,[]);var V=a(1434),Ea=a(1630);class Za extends Sys.EventArgs{constructor(Y){super();this.lVa=Y}}Object(c.a)(Za,"OnBeforeReplaceObjectSuggestionApplyEventArgs",Sys.EventArgs,[]);class ia{constructor(){this.shape=null;this.action=0}}Object(c.a)(ia,"ShowHideReplaceObjectGalleryData",
null,[]);class Va{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg){this.tP=this.jje=!1;this.la=Sa;this.Na=Mb;this.ya=Oc;this.nh=oc;this.zc=nd;this.aYc=Cd;this.T5=kf;this.zb=Vf;this.La=eg;this.sa=Y;this.Fd=Zd;this.S5=we;this.Tb=Qe}get vs(){return this.tP}setup(){this.vs||(this.Oz(),this.Kb(),this.Ae(),this.tP=!0)}dispose(){this.vs&&(this.jxl(),this.tP=!1)}Oz(){this.nh.yxf(Object(h.a)(this,this.nxh,"updateEditState"))}jxl(){this.nh.gch(Object(h.a)(this,this.nxh,"updateEditState"))}Kb(){this.la.ua(tb.a.bkc,
Ta.a.application,Object(h.a)(this,this.bkc,"applyReplaceObjectSuggestion"),4);this.la.ua(tb.a.Vad,Ta.a.application,Object(h.a)(this,this.Vad,"showHideReplaceObjectSuggestionsGallery"),4);this.la.ua(tb.a.AJe,Ta.a.application,Object(h.a)(this,this.Vad,"showHideReplaceObjectSuggestionsGallery"),4);this.la.ua(tb.a.t1e,Ta.a.application,Object(h.a)(this,this.Xjm,"navigateReplaceObjectSuggestion"),4);this.la.ua(tb.a.s1e,Ta.a.application,Object(h.a)(this,this.Xjm,"navigateReplaceObjectSuggestion"),4)}Ae(){const Y=
this.Na.Uc(fc.a.DV),Sa=this.Na.Uc(fc.a.sh),Mb=this.Na.Uc(fc.a.Yrd);Y.bindAction($a.a.hb(la.a.nv,2),tb.a.AJe);Sa.bindAction($a.a.hb(la.a.nv,2),tb.a.AJe);Mb.bindAction($a.a.hb(la.a.nv,2),tb.a.AJe);Mb.bindAction($a.a.hb(la.a.R0,0),tb.a.AJe);Mb.bindAction($a.a.hb(la.a.e$,0),tb.a.t1e);Mb.bindAction($a.a.hb(la.a.Sea,0),tb.a.s1e)}nxh(){this.jje||H.a.$(507843088,829,50,"ReplaceObjectActor::UpdateEditState, updating edit state");this.jje=!0}bkc(Y,Sa,Mb,oc,Oc){if(!this.vs)return H.a.$(33698392,829,15,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - called before setup"),
16;Sa=this.ya.presentation;if(!this.ya.Ia||!Sa||this.zc.Hd(Sa))return 16;if(1===Mb)return 32;Mb=!0;oc=null;Object(qj.a)(V.a,Oc)?oc=Oc:Object(qj.a)(Ea.a,Oc)&&(oc=Oc.wGh,Mb=!1);Oc=new ja.a(w.a.Er(oc.ActiveSlideSid,oc.ActiveSlideCid),oc.ShapeId,oc.SmartArtSubNodeId);const nd=new Za(Oc);this.aYc.S2n(nd);const Cd=this.S5.s0d(Oc);if(Cd&&Cd.shapeId===oc.ShapeId){let Zd=null;1===Cd.suggestionType&&(Zd=this.La.Wv(Cd.shape));Oc=this.Tb.Kd(15,void 0,()=>{1===Cd.suggestionType||this.sa.Au()||(this.Fd.B9g(Sys.EventArgs.Empty),
this.sa.nj(),this.Fd.A9g(Sys.EventArgs.Empty))},()=>{Zd&&(this.Fd.B9g(Sys.EventArgs.Empty),this.sa.selectShape(Zd,!0),this.Fd.A9g(Sys.EventArgs.Empty))});try{Oc.tc(Sa),Oc.wc=oc.SmartArtSubNodeId?tb.a.xHh:Y,Sa.eLb=oc,Cd.uGh=oc.SuggestionSid,Cd.Ywi=oc.Label,Cd.KCa=!0,Cd.Vsh=new Date,H.a.$(33698394,829,50,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",oc.CorrelationId,Y,oc.SuggestionSid)}finally{Oc&&Oc.dispose()}Cd.t_j=!0;Cd.l9d=!0;Mb&&Cd.mqk();
0===Cd.suggestionType?this.zc.wy(Sa,Y):Zd?this.zc.snb(Sa,Zd,this.zb.Ua,Y):H.a.$(507843086,808,15,"Invalid smartArtShape")}else H.a.$(33863682,808,15,"Couldn't find active replaceObjectContext");return 32}Vad(Y,Sa,Mb,oc,Oc){if(!this.vs)return H.a.$(33698398,829,15,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery - called before setup"),16;Sa=this.ya.presentation;if(!this.ya.Ia||!Sa||this.zc.Hd(Sa))return 16;if(1===Mb)return 32;Mb=null;Sa=0;if(Y===tb.a.Vad){Y=Object(G.a)(ia,Oc);if(!Y)return 16;
Mb=Y.shape;Sa=Y.action}else if(Y===tb.a.AJe){Y=this.sa.zd();if(1!==Y.length)return 32;Mb=Y[0]}if(!Mb)return H.a.$(33698400,829,10,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery, null shape."),16;Y=this.S5.s0d(Mb.lVa);if(!Y||!this.jje&&Y&&0===Y.suggestionType)return 2;if(Y&&Y.Kfa&&Y.shapeId===Mb.get_shapeId())switch(this.sa.lk(),this.Na.ee(),Sa){case 0:this.T5.djo(Y.correlationId);break;case 1:this.T5.X$.isVisible||this.T5.zkl(Y.correlationId);break;case 2:this.T5.eFj(Mb)}return 32}Xjm(Y,
Sa,Mb){if(!this.vs)return H.a.$(33698396,829,15,"ReplaceObjectActor::NavigateReplaceObjectSuggestion - called before setup"),16;Sa=this.ya.presentation;return this.ya.Ia&&Sa&&!this.zc.Hd(Sa)?1===Mb?32:this.T5.X$.isVisible?Y===tb.a.t1e?(this.T5.t1e(),32):Y===tb.a.s1e?(this.T5.s1e(),32):16:16:16}}Object(c.a)(Va,"ReplaceObjectActor",null,[]);class Ab{constructor(Y,Sa){this.g4=Y;this.iQh=Sa}initialize(){this.g4.execute(Y=>{Y.registerSimpleRemoteWorkflow(this.iQh.jP,this.iQh.Ozc,this.iQh.u7c,this.iQh.Syc)})}}
Object(c.a)(Ab,"ReplaceObjectAugLoopRuntimeManager",null,[]);var gc=a(1335),Hc;(function(Y){Y[Y.textToSmartArt=0]="textToSmartArt";Y[Y.iconChunking=1]="iconChunking"})(Hc||(Hc={}));Object(c.b)("ReplaceObjectType",Hc);class fd{constructor(Y,Sa){this.qGd=this.Zya=this.na=null;this.shapeId=0;this.$cb=null;this.suggestionType=0;this.nIb=!1;this.uGh=0;this.Ywi=null;this.RRj=this.pRj=this.l9d=this.KCa=!1;this.Ush=this.Vsh=this.ssl=this.o7e=this.Ysh=this.Scd=this.Wsh=this.KLb=null;this.uWe=this.yqh=0;this.fji=
this.eSb=this.Eaa=null;this.fub=!1;this.suggestions=null;this.RHf=this.suggestionCount=0;this.t_j=!1;this.XFe=null;this.xhh=!1;this.z6k=null;this.Ndi=!1;this.z0e=[];this.Jm=Y;this.ztg=Sa;this.reset()}Ljd(Y,Sa,Mb,oc,Oc,nd){this.Kfa&&this.CXa(Nh.lVh);if(!Y)throw Error.argumentNull("slide");const Cd=Y.UJc(new ja.a(Y?Y.fc:null,Sa,nd));if(!Cd)throw Error.invalidOperation(String.format("slide doesn't have shape corresponds to shapeId: {0}",Sa));this.Zya=Y;this.qGd=Cd;this.shapeId=Sa;this.$cb=nd;this.Eaa=
Yb.a.create().toString();this.Ndi=!0;this.eSb=Mb;this.fji=oc;this.na=Oc;this.KLb=new Date;this.suggestionType=this.imn();return this.correlationId}pIh(Y,Sa,Mb,oc,Oc){return this.Ljd(Y,Sa,Mb,oc,Oc,null)}imn(){const Y=this.shape;return this.na.b4d&&Y&&this.$cb&&Y.get_isSVGBlipFilled()?1:0}CXa(Y){if(this.Kfa&&!this.eyn(this.correlationId)){const Sa={};Sa.SuggestionCount=this.suggestionCount;Sa.ClientSuggestionTimeoutInMs=this.RHf;Sa.IsApplied=this.KCa;Sa.AppliedSuggestionId=this.KCa?this.uGh.toString():
"";Sa.AppliedSuggestionLabel=this.KCa?this.Ywi:"";Sa.IsFloatieShown=this.pRj;Sa.IsGalleryShown=this.RRj;Sa.Trigger=this.trigger;Sa.RetriggerReason=this.JYh;Sa.ResetReason=Y;Sa.IconId=this.na.moc;Sa.SlideCID=this.slide.cid;Sa.SlideSID=this.slide.sid;Sa.ShapeID=this.shapeId;Sa.AnimId=this.na.nEe;Sa.AnimEnabled=this.na.qEe;Sa.GalleryHoverEnabled=this.na.oEe;Sa.ReplaceSuggestionType=Hc[this.suggestionType];Sa.SeeMoreButtonClicked=this.xhh;Sa.SeeMoreIconName=this.xhh?this.z6k:"";this.KLb&&(Sa.SessionLiveTimeInMs=
+new Date-+this.KLb);this.$cb&&(Sa.SmartArtSubNodeId=this.$cb);this.Scd&&this.o7e&&this.o7e>this.Scd&&(Sa.SuggestionsReadyInMs=+this.o7e-+this.Scd);0<this.yqh&&(Sa.SuggestionsDisplayedForMs=this.yqh);0<this.uWe&&(Sa.FloatieDisplayedForMs=this.uWe);this.Scd&&this.KLb&&this.Scd>this.KLb&&(Sa.FloatieReadyInMs=+this.Scd-+this.KLb);this.KLb&&this.Wsh&&this.KLb>this.Wsh&&(Sa.TriggeredByAugLoopInMs=+this.KLb-+this.Wsh);this.Vsh&&this.Ush&&this.Ush>this.Vsh&&(Sa.SuggestionAppliedInMs=+this.Ush-+this.Vsh);
if(0<this.suggestions.length){Y=[];for(let Mb=0;Mb<this.suggestions.length;Mb++)Array.add(Y,this.suggestions[Mb].labelText);Sa.SuggestionLabels=Oi.c(Y)}1!==this.suggestionType||Eb.a.wb(this.XFe)||(Y=gc.a.srb(this.XFe))&&Y.hasChildNodes()&&(gc.a.Okc(),gc.a.Btm(this.XFe));this.Jm.jvm(this.correlationId,Oi.c(Sa),void 0,Object(h.a)(this,this.HZg,"onFailureCallback"));this.ZHn(this.correlationId)}this.reset()}reset(){this.Ndi=!1;this.Zya=null;this.t_j=this.RRj=this.pRj=this.l9d=this.KCa=this.nIb=!1;this.fji=
this.eSb=this.Eaa="";this.suggestions=[];this.uGh=0;this.Ywi="";this.fub=!1;this.RHf=this.suggestionCount=0;this.Ush=this.Vsh=this.ssl=this.o7e=this.Ysh=this.Scd=this.Wsh=this.KLb=null;this.suggestionType=this.uWe=this.yqh=0;this.XFe="";this.qGd=null;this.xhh=!1;this.z6k=""}eyn(Y){return this.z0e?Array.contains(this.z0e,Y):!1}ZHn(Y){this.z0e&&!Array.contains(this.z0e,Y)&&(Array.add(this.z0e,Y),H.a.$(512496034,829,50,"ReplaceObjectContext::MarkCorrelationAsHandled - CorrelationId: {0}; handled correlations count: {1}",
Y,this.z0e.length))}HZg(Y){H.a.$(512496033,829,15,"ReplaceObjectContext::OnFailureCallback - request failed with: {0}. returning true to prevent ACE.",Y.HttpStatusCode);return!0}mqk(){this.$im(2,4)}cIn(){this.$im(3,3)}$im(Y,Sa){this.ztg&&this.ztg.execute(Mb=>{const oc=Object.assign(new al.a,{cardId:Pl.a.IAm,actionType:Y,actionEngagement:Sa});Mb.rVh(oc)})}get slide(){return this.Zya}get shape(){return this.qGd}get correlationId(){return this.Eaa}get trigger(){return this.eSb}get JYh(){return this.fji}get Kfa(){return this.Ndi}get appSettings(){return this.na}get lVa(){return new ja.a(this.slide?
this.slide.fc:null,this.shapeId,this.$cb)}}Object(c.a)(fd,"ReplaceObjectContext",null,[1050]);class hd{constructor(){this.xa=new Zb.a}S2n(Y){this.xa.raiseEvent("ReplaceObjectBSA",Y)}eVm(Y){this.xa.addHandler("ReplaceObjectBSA",Y)}r6n(Y){this.xa.removeHandler("ReplaceObjectBSA",Y)}tsm(Y){this.xa.raiseEvent("ReplaceObjectSPOver",Y)}IVm(Y){this.xa.addHandler("ReplaceObjectSPOver",Y)}K6n(Y){this.xa.removeHandler("ReplaceObjectSPOver",Y)}ssm(Y){this.xa.raiseEvent("ReplaceObjectSPOut",Y)}HVm(Y){this.xa.addHandler("ReplaceObjectSPOut",
Y)}J6n(Y){this.xa.removeHandler("ReplaceObjectSPOut",Y)}T2n(Y){this.xa.raiseEvent("ReplaceObjectViewDE",Y)}wVm(Y){this.xa.addHandler("ReplaceObjectViewDE",Y)}D6n(Y){this.xa.removeHandler("ReplaceObjectViewDE",Y)}}Object(c.a)(hd,"ReplaceObjectEventSource",null,[1047,1048,1049]);class yd extends Yi{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg,yh,qg,Ug,Zh,Ii,Jl,Tl){super(nd,Y,Sa,Mb,oc,Oc,Cd,Zd,we,Qe,kf,eg,zg,yh,qg,Zh,Ii,Jl,Tl);this.su=Zd.P2l();this.Jm=Vf;this.na=Ug}tE(Y,Sa){if(!this.vs)H.a.$(507843267,
829,15,"ReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.Qod&&Sa.cJ.length)if(Y=this.sa.zd(),1!==Y.length)this.su.Kfa&&this.closeSession(this.su,Nh.laa);else{Y=Y[0];if(this.su.Kfa){if(this.su.shapeId===Y.get_shapeId())return;this.closeSession(this.su,Nh.laa)}this.Vsd(Y)&&this.xIb(this.ya.Ia,Y,Vj.selectShape,"")}}Wzk(Y,Sa){this.vs?this.su.Kfa&&this.su.shape===Sa.shape&&(Y=this.su.shape,this.closeSession(this.su,Nh.Clh),this.Vsd(Y)&&this.xIb(this.ya.Ia,Y,Vj.p8c,Ck.Clh)):
H.a.$(507843266,829,15,"ReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}Bqk(Y,Sa){Sa.Smd&&this.gna(Sa.actionId)}zT(){this.su.Kfa&&this.closeSession(this.su,Nh.slideNavigation)}exa(Y,Sa){this.su.Kfa&&Sa.Bwa&&Sa.shapes&&Array.contains(Sa.shapes,this.su.shapeId)&&this.closeSession(this.su,Nh.Iel)}Vzk(Y,Sa){Sa.correlationId!==this.su.correlationId?H.a.$(507843265,829,15,"ReplaceObjectManager::OnReplaceObjectResponse, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.su.correlationId,
Sa.correlationId):this.t6l(Sa,this.su,this.na)}zwk(){this.vs&&this.su.l9d&&0===this.su.suggestionType&&!this.zc.Hd(this.ya.presentation)&&(this.su.l9d=!1,this.T5.mec(this.su.shape,!0))}xIb(Y,Sa,Mb,oc){oc=void 0===oc?"":oc;try{const Oc=this.su.pIh(Y,Sa.get_shapeId(),Mb,oc,this.na);this.su.fub=!0;this.T5.axh(this.su.correlationId);this.Jm.hcj(Y.cid,Y.sid,Sa.get_shapeId(),Oc,Mb,null,this.xU.iMh(Sa),this.xU.hMh(Sa),void 0,Object(h.a)(this,this.yve,"onTaskFailure"));this.na.TTa&&this.y1e(Oc,this.su.shapeId,
this.su.suggestions,Mj.a.pending)}catch(Oc){H.a.$(507843264,829,15,"GenerateSuggestion failed!! {0} ",Oc.message)}}yve(Y){H.a.$(507843235,829,15,"ReplaceObjectManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",Y.HttpStatusCode);return!0}gna(Y){this.vs?this.su.Kfa&&!this.FOh(Y)&&this.closeSession(this.su,Nh.p8e+this.uN.$la(Y)):H.a.$(507843234,829,15,"ReplaceObjectManager::HandleAction - called before setup")}closeSession(Y,Sa){Y.nIb&&this.T5.mec(Y.shape,!0);Y.CXa(Sa);
this.na.TTa&&this.y1e(Y.correlationId,Y.shapeId,Y.suggestions,Mj.a.W0c)}}Object(c.a)(yd,"ReplaceObjectManager",Yi,[]);var Md=a(1);class te{constructor(Y){this.nY=-1;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.k$j=Array.clone(Y)}get_current(){if(-1===this.nY||this.nY>=this.k$j.length)throw Error.invalidOperation();return this.k$j[this.nY]}moveNext(){this.nY++;return this.nY<this.k$j.length}reset(){this.nY=-1}}Object(c.a)(te,"ArrayEnumerator",null,[122]);class Pe{constructor(Y){this.ZXc=
[];this.$$ge=this.getEnumerator;this.nGn=Y}getEnumerator(){return new te(this.ZXc)}[Symbol.iterator](){return Object(Md.a)(this.getEnumerator())}SNh(Y,Sa){Y&&(Y.CXa(Sa),Array.remove(this.ZXc,Y))}r0d(Y){for(const Sa of this.ZXc)if(Sa.correlationId===Y)return Sa;return null}s0d(Y){for(const Sa of this.ZXc)if(ja.a.Y5e(Y,Sa.lVa))return Sa;return null}g4l(Y,Sa){for(const Mb of this.ZXc)if(Mb.shapeId===Y&&(!Sa&&!Mb.$cb||Sa&&Sa===Mb.$cb))return Mb;return null}T4f(Y){return this.g4l(Y,null)}P2l(){return 0<
this.ZXc.length?this.ZXc[0]:null}Ljd(Y,Sa,Mb,oc,Oc,nd){let Cd=this.s0d(new ja.a(Y.fc,Sa,nd));Cd&&this.SNh(Cd,Nh.lVh);Cd=this.nGn(Y,Sa,Mb,oc,Oc,nd);Array.add(this.ZXc,Cd);return Cd}pIh(Y,Sa,Mb,oc,Oc){return this.Ljd(Y,Sa,Mb,oc,Oc,null)}get UOl(){let Y=0;this.ZXc.forEach(Sa=>{Sa.Kfa&&Y++});return Y}}Object(c.a)(Pe,"ReplaceObjectMultipleContextManager",null,[758,66]);class t{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe){this.ya=Y;this.ehm=Sa;this.qGn=Mb;this.xU=nd;this.$Xc=Oc;this.S5=oc;this.X$=Cd;this.Na=
Zd;this.Ee=we;this.La=Qe;this.tP=!1;this.wDh=-1}get vs(){return this.tP}get EXe(){return this.wDh}setup(){this.vs||(this.$Xc.eVm(Object(h.a)(this,this.$km,"onBeforeReplaceObjectSuggestionApply")),this.$Xc.IVm(Object(h.a)(this,this.enm,"onReplaceObjectSuggestionPointerOver")),this.$Xc.HVm(Object(h.a)(this,this.dnm,"onReplaceObjectSuggestionPointerOut")),this.tP=!0)}dispose(){this.vs&&(this.$Xc.r6n(Object(h.a)(this,this.$km,"onBeforeReplaceObjectSuggestionApply")),this.$Xc.K6n(Object(h.a)(this,this.enm,
"onReplaceObjectSuggestionPointerOver")),this.$Xc.J6n(Object(h.a)(this,this.dnm,"onReplaceObjectSuggestionPointerOut")),this.tP=!1)}$km(Y,Sa){if(!this.ya.Ia)throw Error.argumentNull("ActiveSlide is null");(Y=this.ya.Ia.UJc(Sa.lVa))&&this.mec(Y,!1)}enm(Y,Sa){this.ya.Ia&&(Y=new ja.a(this.ya.Ia.fc,Sa.shapeId,Sa.Q9),(Y=this.ya.Ia.UJc(Y))&&this.ykl(Y,Sa.tHj))}dnm(Y,Sa){this.ya.Ia&&(Y=new ja.a(this.ya.Ia.fc,Sa.shapeId,Sa.Q9),(Y=this.ya.Ia.UJc(Y))&&this.Lag(Y))}ykl(Y,Sa){let Mb=Y;Y.get_smartArtModelId()&&
(Mb=this.La.Wv(Y));if(Y=this.O4l(Mb))this.Rzm(Mb,!1),Y.ykl(Sa)}Lag(Y){let Sa=Y;Y.get_smartArtModelId()&&(Sa=this.La.Wv(Y));if(Y=this.O4l(Sa))this.Rzm(Sa,!0),Y.Lag()}O4l(Y){return Y&&!Y.get_smartArtModelId()&&Object(G.a)(112,Y.yc(this.Ee))?this.qGn.fca(Y):null}y$m(Y){return Y&&Object(G.a)(112,Y.yc(this.Ee))?this.ehm.fca(Y):null}Soj(Y){return Y&&Object(G.a)(112,Y.yc(this.Ee))?this.ehm.J7(Y):null}O_h(Y){if(!this.vs)H.a.$(507843098,829,15,"ReplaceObjectPresenter::ShowShapeReplaceObjectView - called before setup");
else if(Y){var Sa=this.y$m(Y);if(Sa){const Mb=this.S5.s0d(Y.lVa);!Mb||Mb.nIb&&this.EXe!==Mb.shapeId||(Mb.nIb?this.EXe===Mb.shapeId&&(Sa.CJh(),this.wDh=-1):(this.mec(Y,!0,!(this.X$.Xrd&&this.X$.isVisible&&ja.a.Y5e(Y.lVa,this.X$.Xrd.lVa))),Sa.display()),Mb.nIb=!0)}}}T5n(){if(-1!==this.EXe&&this.ya.Ia){var Y=this.ya.Ia.h1(this.EXe);Y&&this.mec(Y,!0)}}mec(Y,Sa,Mb,oc){Mb=void 0===Mb?!0:Mb;oc=void 0===oc?!1:oc;this.vs?Y&&(Sa&&this.Lag(Y),Mb&&this.eFj(Y),Sa=this.Soj(Y))&&(oc?(Sa.eJh(),this.wDh=Y.get_shapeId()):
(this.EXe===Y.get_shapeId()&&(this.wDh=-1),Sa.visible&&Sa.dismiss(),(oc=this.S5.s0d(Y.lVa))&&Y.get_shapeId()===oc.shapeId&&(oc.nIb=!1))):H.a.$(507843097,829,15,"ReplaceObjectPresenter::RemoveShapeReplaceObjectView - called before setup")}axh(Y){this.X$.axh(Y)}djo(Y){if(this.vs)if(this.X$.isVisible){const Sa=this.S5.r0d(Y);Sa&&Sa.Kfa&&Sa.correlationId===Y&&this.Lag(Sa.shape);this.eFj(Sa.shape)}else this.zkl(Y);else H.a.$(507843096,829,15,"ReplaceObjectPresenter::ToggleSuggestionsGalleryView - called before setup")}eFj(Y){this.X$.isVisible&&
this.X$.Xrd&&ja.a.Y5e(this.X$.Xrd.lVa,Y.lVa)&&(this.X$.dismiss(),(Y=this.Soj(this.X$.Xrd.shape))&&Y.root&&(Y.root.style.zIndex="0"),this.Na.Gm(fc.a.Yrd,!1))}zkl(Y){const Sa=this.S5.r0d(Y);if(Sa&&Sa.correlationId===Y&&Sa.Kfa){var Mb=this.Soj(Sa.shape);if(Mb){var oc=Mb.root;oc?this.X$.isVisible&&this.X$.Xrd&&!ja.a.Y5e(this.X$.Xrd.lVa,Sa.lVa)||(oc=this.xU.getBounds(oc),this.X$.show(Y,oc.x,oc.y),Mb.root.style.zIndex=String(n.AFrameworkApplication.Ha.Fjc),this.Na.Gm(fc.a.Yrd,!0),Sa.RRj=!0):H.a.$(507843093,
829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - rootElem is null")}else H.a.$(507843094,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - replaceObjectView is null")}}dtm(Y){this.vs?this.X$.isVisible&&this.zkl(Y):H.a.$(507843092,829,15,"ReplaceObjectPresenter::RefreshSuggestionsGallery - called before setup")}t1e(){if(this.vs){var Y=this.X$.wij();Y&&(-1===Y?this.X$.HU(0,!0):(this.X$.HU(Y,!1),this.X$.HU(Y-1,!0)))}else H.a.$(507843091,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionPrev - called before setup")}s1e(){if(this.vs){var Y=
this.X$.wij();Y+1!==this.X$.fmn()&&(-1===Y?this.X$.HU(0,!0):(this.X$.HU(Y,!1),this.X$.HU(Y+1,!0)))}else H.a.$(507843090,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionNext - called before setup")}Rzm(Y,Sa){Y&&(Y=Object(G.a)(112,Y.yc(this.Ee)))&&((Y=Y.va)?Y.oe(Sa):H.a.$(507843089,829,10,"ReplaceObjectPresenter::ShowHideShape,shapeViewDiv is null"))}}Object(c.a)(t,"ReplaceObjectPresenter",null,[785]);class L{constructor(){this.shapeId=this.slideCid=this.slideSid=0;this.h2e=null;this.bFk=
0}}Object(c.a)(L,"TaskItem",null,[]);class S{constructor(Y,Sa,Mb){this.Noe=[];this.Jm=Y;this.xU=Sa;this.Ycm=Mb}Bbn(Y,Sa,Mb){for(let oc=0;oc<this.Noe.length;oc++)if(this.Noe[oc].slideSid===Y&&this.Noe[oc].slideCid===Sa&&this.Noe[oc].shapeId===Mb)return this.Noe[oc];return null}rxm(Y){var Sa=this.Bbn(Y.slide.sid,Y.slide.cid,Y.shapeId);if(Sa)return Sa.h2e=Y,Sa.bFk++,1;const Mb=Object.assign(new L,{slideSid:Y.slide.sid,slideCid:Y.slide.cid,shapeId:Y.shapeId,bFk:0,h2e:null});Array.add(this.Noe,Mb);Y.fub=
!0;Sa=Y.correlationId;const oc=Y.slide,Oc=Y.shape;this.Jm.hcj(oc.cid,oc.sid,Oc.get_shapeId(),Sa,Y.trigger,null,this.Ycm?this.xU.iMh(Oc):this.xU.O5f(Oc),this.Ycm?this.xU.hMh(Oc):this.xU.N5f(Oc),()=>{this.Knm(Mb)},nd=>{this.Knm(Mb);H.a.$(36966425,829,15,"SendGenerateReplaceObjectRequest - request failed with response {0}. returning true to avoid ACE.",nd.HttpStatusCode);return!0});return 0}Knm(Y){Array.remove(this.Noe,Y);Y.h2e&&Y.h2e.Kfa&&(H.a.$(34144975,829,50,"ReplaceObjectRequestManager - Send pending request: {0}; {1} were in queue and skipped",
Y.h2e.correlationId,Y.bFk-1),this.rxm(Y.h2e))}}Object(c.a)(S,"ReplaceObjectRequestManager",null,[757]);class ka{constructor(Y){this.qfk=!0;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.Bu=Y}get_current(){return this.Bu}moveNext(){return this.qfk?(this.qfk=!1,!0):!1}reset(){this.qfk=!0}}Object(c.a)(ka,"SingleEnumerator",null,[122]);class ra{constructor(Y){this.$$ge=this.getEnumerator;this.su=Y}getEnumerator(){return new ka(this.su)}[Symbol.iterator](){return Object(Md.a)(this.getEnumerator())}SNh(Y,
Sa){Y&&Y===this.su&&Y.CXa(Sa)}r0d(){return this.su}s0d(){return this.su}T4f(){return this.su}g4l(){return this.su}P2l(){return this.su}Ljd(Y,Sa,Mb,oc,Oc,nd){this.su.Ljd(Y,Sa,Mb,oc,Oc,nd);return this.su}pIh(Y,Sa,Mb,oc,Oc){return this.Ljd(Y,Sa,Mb,oc,Oc,null)}get UOl(){return this.su.Kfa?1:0}}Object(c.a)(ra,"ReplaceObjectSingleContextManager",null,[758,66]);var xb=a(145);class Ob{constructor(Y,Sa,Mb,oc,Oc){this.QJb=null;this.R0e=this.rbk=!1;this.h8b=null;this.visible=!1;this.mF=Y;this.PQa=Sa;this.w8a=
Mb;this.xU=Oc;this.GOg=oc;this.tP=!1}get vs(){return this.tP}setup(){this.vs||(this.h8b=new rj.a,this.QJb=this.GOg.n5m(this.h8b.va),this.PQa&&!this.PQa.isDisposed&&this.PQa.Cua&&(this.PQa.Cua.appendChild(this.h8b),this.oe(!1),this.R0e=!0,this.PQa.uHb(this,3),this.visible=this.PQa.oM||this.PQa.vp),this.tP=!0)}Yq(){H.a.$(25306526,829,15,"ReplaceObjectSuggestionPreviewView::BuildDomElements - shouldn't be called")}NT(){}zu(){if(!this.vs)return H.a.$(36827549,829,15,"ReplaceObjectSuggestionPreviewView::GetVisibleBoundingRegion - called before setup"),
null;if(!this.rbk||!this.QJb.vs||!this.QJb.BBa)return null;const Y=Ib.a.Bo(this.QJb.BBa.va.style.left),Sa=Ib.a.Bo(this.QJb.BBa.va.style.top),Mb=Ib.a.Bo(this.QJb.BBa.va.style.width),oc=Ib.a.Bo(this.QJb.BBa.va.style.height);return new xb.a(new ib.a(Y,Sa),new ib.a(Y+Mb,Sa),new ib.a(Y+Mb,Sa+oc),new ib.a(Y,Sa+oc))}k1(){return!1}vE(){}tH(){}setPosition(){}qj(){this.R0e=!0;this.WC()}Ov(){this.R0e=!0;this.WC()}SA(){this.R0e=!0;this.WC()}setZIndex(Y){this.h8b&&this.h8b.NH(Y)}ER(){}pR(){return null}DM(){return[]}draw(){}dispose(){this.w8a();
this.vs&&(this.QJb.dispose(),this.h8b.va.parentNode&&this.h8b.Or(),this.h8b=null,this.tP=!1)}ykl(Y){this.vs?(this.ljh(Y),this.WC()):H.a.$(25306562,829,15,"ReplaceObjectSuggestionPreviewView::ShowSuggestionPreview - called before setup")}Lag(){this.vs?this.vkc():H.a.$(25306564,829,15,"ReplaceObjectSuggestionPreviewView::HideSuggestionPreview - called before setup")}ljh(Y){this.vs?(this.QJb.setImage(Y),this.oe(!0)):H.a.$(25306566,829,15,"ReplaceObjectSuggestionPreviewView::SetGlyph - called before setup")}vkc(){this.vs?
(this.QJb.dismiss(),this.oe(!1)):H.a.$(25306568,829,15,"ReplaceObjectSuggestionPreviewView::ClearGlyph - called before setup")}setSelection(){}WC(){if(this.rbk&&this.R0e){var Y=this.xU.O5f(this.mF),Sa=this.xU.N5f(this.mF);this.zh(Y,Sa);this.h8b&&(Y=this.xU.Hkn(this.mF),Ll.a.setRotation(this.h8b.va,Y));this.R0e=!1}}oe(Y){this.rbk=Y;this.h8b.oe(Y)}zh(Y,Sa){this.QJb&&this.QJb.zh(Y,Sa)}}Object(c.a)(Ob,"ReplaceObjectSuggestionPreviewView",null,[788,789,558,267,40,785]);var Vb=a(330),Ac=a(254),$c=a(1629),
qd=a(1628);class Fd extends Sys.EventArgs{constructor(Y){super();this.shape=Y}}Object(c.a)(Fd,"ReplaceObjectViewDragEndEventArgs",Sys.EventArgs,[]);class Ud{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf){this.Thm=!1;this.eyb=this.xod=null;this.la=Oc;this.kj=nd;this.od=Cd;this.S5=Zd;this.aYc=we;this.GOg=oc;this.w8a=Mb;this.mF=Y;this.PQa=Sa;this.wR=!1;this.na=Qe;this.llk=kf;this.tP=this.visible=!1;this.yyb=Vf}get vs(){return this.tP}QWe(){return this.S5.s0d(this.mF.lVa)}setup(){if(!this.vs){var Y=
this.QWe();Y=Y?Y.suggestionType:0;this.Thm=1===Y;this.eyb=new rj.a;this.xod=this.GOg.n4m(this.eyb,Ud.eHh,Object(h.a)(this,this.LRn,"onFlyoutAnchorClick"),Object(h.a)(this,this.MRn,"onFlyoutAnchorHover"),Y);this.PQa&&!this.PQa.isDisposed&&this.PQa.Cua&&(this.Yq(this.PQa.Cua),this.PQa.uHb(this,3));this.tP=!0}}CJh(){this.vs?this.xod&&this.xod.CJh():H.a.$(512496032,829,15,"ShapeReplaceObjectView::EnableFloatie - called before setup")}eJh(){this.vs?this.xod&&this.xod.eJh():H.a.$(512496031,829,15,"ShapeReplaceObjectView::DisableFloatie - called before setup")}display(){if(!this.vs)H.a.$(512496030,
829,15,"ShapeReplaceObjectView::Display - called before setup");else if(!this.visible){this.WC();this.xod.show();this.visible=!0;this.wpc();var Y=this.QWe();if(Y){Y.pRj=!0;const Sa=new Date;Y.Scd||(Y.Scd=Sa);Y.Ysh=Sa;H.a.$(512496029,829,50,"ShapeReplaceObjectView::Display - trigger: {0}, correlationId: {1}",Y.trigger,Y.correlationId)}}}get root(){return this.vs?this.eyb.va:(H.a.$(512496027,829,15,"ShapeReplaceObjectView::Root - called before setup"),null)}dismiss(){if(this.vs){this.xod.dismiss();
this.visible=!1;var Y=this.QWe();Y&&(Y.nIb=!1,Y.Ysh&&(Y.uWe+=+new Date-+Y.Ysh,H.a.$(512496025,829,50,"ShapeReplaceObjectView::Dismiss - FloatieDisplayedForMs: {0}; TimeFloatieRenderedLast: {1}; trigger: {2}; correlation: {3}",Y.uWe,Y.Ysh,Y.trigger,Y.correlationId)))}else H.a.$(512496026,829,15,"ShapeReplaceObjectView::Dismiss - called before setup")}Yq(){this.visible=!1;this.kj.addCssClass(this.eyb.va,"replaceObjectBody");document.body.appendChild(this.eyb.va);this.od.mXa(Object(h.a)(this,this.Yn,
"onResize"));this.WC()}NT(){}zu(){return null}k1(){return!1}vE(){}tH(){}setPosition(){}qj(){}Ov(){}SA(){}setZIndex(){}ER(Y){if(this.vs){if(Y)this.visible=!1,this.wpc();else if(this.wR){const Sa=new Fd(this.mF);this.aYc.T2n(Sa)}this.wR=Y}else H.a.$(512496024,829,15,"ShapeReplaceObjectView::SetDrag - called before setup")}pR(){return null}DM(){return[]}draw(){this.vs?this.WC():H.a.$(512496023,829,15,"ShapeReplaceObjectView::Draw - called before setup")}setSelection(){}dispose(){this.w8a();this.vs&&
(this.od.cLb(Object(h.a)(this,this.Yn,"onResize")),this.eyb&&(this.eyb.va.parentNode&&this.eyb.Or(),this.kj.removeCssClass(this.eyb.va,"replaceObjectBody")),this.dismiss(),this.xod.dispose(),this.eyb=null,this.tP=!1)}wpc(){this.eyb.va.style.visibility=this.visible?hc.a.visible:hc.a.hidden;const Y=this.QWe();Y&&(Y.nIb=this.visible)}WC(){var Y;let Sa=null;const Mb=this.PQa.Cua;Mb&&(Sa=this.kj.ji(Mb.va,null===(Y=this.yyb.jd)||void 0===Y?void 0:Y.hs));Sa?(Y=Sa.x-(Ud.eHh+10),this.Thm&&this.PQa&&this.PQa.yd&&
(Y=this.PQa.yd.Cd.te(this.mF.Hw,0),Y=Sa.x+Y+10),Ll.a.jma(this.eyb.va,1),this.eyb.setPosition(1*Y,Sa.y),this.Alo(1*Y,Sa.y)):H.a.$(512496022,829,15,"ShapeReplaceObjectView::UpdateView - elementBound is null")}Alo(Y,Sa){if(this.llk.isVisible){var Mb=this.QWe(),oc=this.llk.Xrd;oc&&Mb&&oc.correlationId===Mb.correlationId&&this.llk.updatePosition(Y,Sa)}}LRn(Y){if(Y.sE!==Sys.UI.MouseButton.leftButton)return!1;this.la.Ra(tb.a.Vad,2,Object.assign(new ia,{shape:this.mF,action:0}));return!0}MRn(){if(!this.na.oEe)return!1;
const Y=this.QWe();if(Y&&1===Y.suggestionType)return!1;this.la.Ra(tb.a.Vad,2,Object.assign(new ia,{shape:this.mF,action:1}));return!0}Yn(Y,Sa){this.visible&&(Y=null,Sa&&Sa.FB&&(Y=Sa.FB.Ed),Y&&Y.fc.equals(this.mF.slideId)&&this.WC())}}Ud.eHh=32;Object(c.a)(Ud,"ShapeReplaceObjectView",null,[783,784,558,267,40,785]);var ae=a(819),Yd=a(23);class se{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf){this.epd=this.PYa=this.gpd=this.xhb=this.IH=null;this.KTh=0;this.Xck=-1;this.Qv=this.su=null;this.kj=Y;this.kf=
Mb;this.dD=Sa;this.ya=oc;this.la=Oc;this.fT=we;this.aYc=nd;this.S5=Cd;this.Hje=Zd;this.Na=Qe;this.na=kf;this.IGn=!Vf.Ek;this.tP=this.lSe=!1}get vs(){return this.tP}get isVisible(){return this.lSe}get Xrd(){return this.su}setup(){this.vs||(this.IH=Ib.a.kg(),this.IH.setAttribute("Unselectable","on"),this.IH.style.position=hc.a.absolute,this.kj.addCssClass(this.IH,"replaceObjectContainer"),this.C1k(null),document.body.appendChild(this.IH),this.Xdc(),this.fT.nYa(fc.a.Yrd,fc.a.Wl,this.IH,()=>{},()=>{},
!0),this.tP=!0)}dispose(){this.vs&&(this.dismiss(),this.iwh(),this.IH&&this.IH.parentNode&&this.IH.parentNode.removeChild(this.IH),this.tP=!1)}dismiss(){this.vs?(n.AFrameworkApplication.Ha.WXa(!0),this.setVisibility(!1),this.k1e.style.display=hc.a.none,this.k1e.style.zIndex="-1",this.epd=this.PYa=null,this.C1k(null)):H.a.$(508692386,829,15,"ReplaceObjectSuggestionsGalleryView::Dismiss - called before setup")}show(Y,Sa,Mb){if(!this.vs)H.a.$(508692385,829,15,"ReplaceObjectSuggestionsGalleryView::Show - called before setup");
else if(!Eb.a.wb(Y)){var oc=this.S5.r0d(Y);oc&&oc.correlationId===Y&&oc.Kfa&&!oc.fub&&(this.su=oc,this.xYn(Y,this.su.suggestions),this.KTh=this.su.suggestionCount,this.uvm(),n.AFrameworkApplication.Ha.uXa(!0),this.k1e.style.zIndex=String(n.AFrameworkApplication.Ha.Mva),this.IH.style.zIndex=String(n.AFrameworkApplication.Ha.Fjc),this.k1e.style.visibility=hc.a.hidden,this.k1e.style.display=hc.a.block,this.k1e.style.visibility=hc.a.visible,this.H1b()?this.kj.addCssClass(this.IH,"replaceIconObjectContainer"):
this.kj.removeCssClass(this.IH,"replaceIconObjectContainer"),this.updatePosition(Sa,Mb),this.setVisibility(!0))}}updatePosition(Y,Sa){let Mb,oc;this.setPosition(0,0);if(this.H1b()){Mb=Y+Ud.eHh+7;oc=Sa;const Oc=ae.a(0,0);Mb+this.IH.offsetWidth>Oc.width&&(Mb=Y+Ud.eHh-this.IH.offsetWidth,oc=Sa-7-this.IH.offsetHeight)}else Mb=Y,oc=Sa-7-this.IH.offsetHeight;this.setPosition(Mb,oc)}fmn(){return this.vs?this.KTh:(H.a.$(508692384,829,15,"ReplaceObjectSuggestionsGalleryView::GetSuggestionCount - called before setup"),
0)}wij(){return this.vs?this.isVisible?this.IH?this.IH.querySelector(".replaceObjectSuggestionsList")?this.Xck:(H.a.$(508692381,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, suggestion list is null"),-1):(H.a.$(508692382,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, m_suggestionsContainer is null"),-1):-1:(H.a.$(508692383,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex - called before setup"),0)}HU(Y,Sa){if(!this.vs)H.a.$(508692380,
829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus - called before setup");else if(!(0>Y)&&this.isVisible)if(this.IH)if(Y>=this.KTh)H.a.$(508692378,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, invalid suggestionIndex. SuggestionCount:{0}, SuggestionIndex:{1}",this.KTh,Y);else{var Mb=this.IH.querySelector(".replaceObjectSuggestionsList");Mb?(Mb=Mb.children)?(Mb=Mb[Y])?Sa?(this.Xck=Y,Cb.FocusManager.vz(Mb)&&this.dAm(Mb.firstChild)):(this.uvm(),Cb.FocusManager.mDm(Mb)&&
this.Y6l(Mb.firstChild)):H.a.$(508692375,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItem is null"):H.a.$(508692376,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItems is null"):H.a.$(508692377,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestion list is null")}else H.a.$(508692379,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, m_suggestionsContainer is null")}axh(Y){this.gpd&&(this.gpd.className=
"ReplaceObjectCorrelation "+Y)}xYn(Y,Sa){this.C1k(Y);if(Y=this.c6m(Y,Sa))Sa=this.b6m(),this.IH.appendChild(Sa),this.IH.appendChild(Y),this.H1b()&&(Y=this.a6m(),this.IH.appendChild(Y))}C1k(Y){this.IH&&(this.xhb&&(this.kf.hc(Z.a.click,this.xhb,Object(h.a)(this,this.mmm,"onLinkClick")),this.xhb=null),this.kj.Ow(this.IH),this.gpd=Ib.a.kg(),this.gpd.setAttribute("Unselectable","on"),this.gpd.className=Eb.a.wb(Y)?"ReplaceObjectCorrelation":"ReplaceObjectCorrelation "+Y,this.gpd.style.position=hc.a.absolute,
this.gpd.style.display=hc.a.none,this.IH.appendChild(this.gpd),this.IH.style.zIndex="-1")}b6m(){const Y=Ib.a.yy();Y.setAttribute("Unselectable","on");this.H1b()?(Y.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryTitle,this.kj.addCssClass(Y,"replaceIconObjectContainerTitle")):(Y.innerText=ResourceStrings.l_ReplaceObjectSuggestionGalleryTitle1,this.kj.removeCssClass(Y,"replaceIconObjectContainerTitle"));this.kj.addCssClass(Y,"UIFont replaceObjectContainerTitle");return Y}c6m(Y,Sa){if(Eb.a.wb(Y))return H.a.$(508692374,
829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Empty correlationId"),null;if(!Sa||!Sa.length)return H.a.$(508692373,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Requires atleast one suggestion to display."),null;const Mb=Ib.a.pDc();Mb.id=Y;Mb.setAttribute("Unselectable","on");Mb.setAttribute(Fa.a.ii,Fa.a.XRl);this.kj.addCssClass(Mb,"replaceObjectSuggestionsList");this.PYa||(this.PYa=new Yd.a);this.epd||(this.epd=new Yd.a);for(var oc of Sa)Eb.a.wb(oc.imageData)||
this.PYa.fa(oc.index,oc.imageData),this.H1b()&&!Eb.a.wb(oc.renderData)&&this.epd.fa(oc.index,oc.renderData),Y=this.XYm(oc.index,oc.labelText),Mb.appendChild(Y);if(this.IGn&&0<this.epd.count&&this.H1b()&&(Eb.a.wb(this.su.XFe)&&(this.su.XFe=Lh.a.create().toString()),(oc=gc.a.srb(this.su.XFe))&&!oc.hasChildNodes())){oc.style.position=hc.a.absolute;oc.style.left="0px";oc.style.top="0px";for(const Oc of this.epd.values)Y=Ib.a.LK(),Y.src=Oc,Y.style.display=hc.a.block,Y.style.position=hc.a.absolute,oc.appendChild(Y);
gc.a.okc()}return Mb}a6m(){this.xhb=Ib.a.yy();this.xhb.setAttribute("Unselectable","on");this.xhb.setAttribute("tabindex","-1");this.xhb.setAttribute(Fa.a.ii,Fa.a.CGh);this.kj.addCssClass(this.xhb,"UIFont replaceObjectContainerLink");this.H1b()&&this.na.m5c&&this.na.H0b&&(this.xhb.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryLink,this.kf.Ub(Z.a.click,this.xhb,Object(h.a)(this,this.mmm,"onLinkClick")));const Y=Ib.a.kg();Y.appendChild(this.xhb);return Y}Xdc(){this.IH&&(this.kf.Ub(Z.a.click,
this.IH,Object(h.a)(this,this.onClick,"onClick")),this.Hje.addHandler(this.IH,Z.a.oi,Object(h.a)(this,this.FNh,"inputKeyApplyHandler")),this.dD.Ub(Z.a.ZO,this.IH,Object(h.a)(this,this.i0,"onPointerOver")),this.dD.Ub(Z.a.IQ,this.IH,Object(h.a)(this,this.h0,"onPointerOut")))}iwh(){this.IH&&(this.kf.hc(Z.a.click,this.IH,Object(h.a)(this,this.onClick,"onClick")),this.Hje.removeHandler(this.IH,Z.a.oi,Object(h.a)(this,this.FNh,"inputKeyApplyHandler")),this.dD.hc(Z.a.ZO,this.IH,Object(h.a)(this,this.i0,
"onPointerOver")),this.dD.hc(Z.a.IQ,this.IH,Object(h.a)(this,this.h0,"onPointerOut")))}i0(Y){Y=this.esj(Y.Hc);this.dAm(Y);return!0}h0(Y){Y=this.esj(Y.Hc);this.Y6l(Y);return!0}FNh(Y){if(this.isVisible&&!Y.ctrlKey&&!Y.altKey&&(!Y.shiftKey||Y.keyCode===la.a.yt&&this.H1b()))if(Y.keyCode===la.a.nv||Y.keyCode===la.a.P1)Y.preventDefault(),(Y=this.IH.querySelector(":focus"))&&Y.firstChild.click();else if(Y.keyCode===la.a.yt&&this.H1b()){const Sa=this.IH.querySelector(":focus");Sa&&this.xhb&&(Sa===this.xhb?
(Y.preventDefault(),Y.stopPropagation(),this.HU(0,!0)):Sa.parentNode&&Sa.parentNode.className&&0<=Sa.parentNode.className.indexOf("replaceObjectSuggestionsList")&&(Y.preventDefault(),Y.stopPropagation(),this.HU(this.wij(),!1),Cb.FocusManager.vz(this.xhb)))}}onClick(Y){if(Y.sE!==Sys.UI.MouseButton.leftButton)return!1;var Sa=this.esj(Y.Hc);if(!this.IYj(Sa)||!this.Yyn(Sa))return!0;Y=this.n2l(Sa);const Mb=this.u6f(Sa);Sa=this.hmn(Sa);Eb.a.wb(Y)||Eb.a.wb(Mb)||(Y=Object.assign(new V.a,{SuggestionSid:parseInt(Mb),
ShapeId:this.su.shapeId,CorrelationId:Y,ActiveSlideCid:this.ya.Ia.cid,ActiveSlideSid:this.ya.Ia.sid,Label:Sa,SmartArtSubNodeId:this.su.$cb?this.su.$cb:null,ReplaceObjectType:this.su.suggestionType}),this.la.Ra(tb.a.bkc,2,Y));return!0}mmm(){this.su&&(this.su.xhh=!0);this.kyj();this.la.Eb(tb.a.wUb,2);return!0}dAm(Y){Y&&this.IYj(Y)&&(Y=this.u6f(Y),Eb.a.wb(Y)||(Y=this.H1b()?this.epd.Sb(Y)?this.epd.ka(Y):"":this.PYa.Sb(Y)?this.PYa.ka(Y):"",Eb.a.wb(Y)||(Y=new qd.a(this.su.shapeId,Y,this.su.$cb),this.aYc.tsm(Y))))}Y6l(Y){Y&&
this.IYj(Y)&&(Y=new $c.a(this.su.shapeId,this.su.$cb),this.aYc.ssm(Y))}esj(Y){if(!Y)throw Error.argumentNull("sourceElement");return"a"===Y.nodeName.toLowerCase()?Y:Y.parentNode}n2l(Y){return Y?Y.parentNode.parentNode.id:null}u6f(Y){if(!Y)return null;Y=Y.id.split("_");return 2!==Y.length?null:Y[1]}hmn(Y){return Y?Y.title:null}IYj(Y){return!!Y&&!Eb.a.wb(Y.className)&&-1!==Y.className.indexOf("ObjectSuggestionContainer")}Yyn(Y){return!!Y&&!Eb.a.wb(Y.className)&&-1===Y.className.indexOf("ReplaceObjectSuggestionLoading")}XYm(Y,
Sa){const Mb=this.PYa.Sb(Y);var oc=Mb?this.PYa.ka(Y):ed.a.NX(yb.a.mZa);Mb||H.a.$(508692372,829,15,"ReplaceObjectSuggestionsGalleryView::spinner shows up");const Oc=Ib.a.LK();Oc.setAttribute("Unselectable","on");Oc.src=oc;Oc.title=Sa;Oc.setAttribute(Fa.a.ii,Fa.a.pV);this.kj.addCssClass(Oc,"replaceObjectSuggestionThumbnail");oc=Ib.a.s3a();oc.id="ROS_"+Y;oc.setAttribute("Unselectable","on");oc.title=Sa;oc.setAttribute(Fa.a.ii,"none");let nd=this.H1b()?"replaceIconObjectSuggestionContainer":"replaceObjectSuggestionContainer";
this.su.KCa&&this.su.uGh.toString()===Y&&(nd+="Selected");this.kj.addCssClass(oc,nd);Mb||this.kj.addCssClass(oc,"ReplaceObjectSuggestionLoading");oc.appendChild(Oc);Y=this.kj.MSi();Y.setAttribute("Unselectable","on");Y.setAttribute("tabindex","-1");Y.setAttribute(Fa.a.ii,Fa.a.pV);Y.setAttribute(Fa.a.IA,Sa);Y.appendChild(oc);return Y}setPosition(Y,Sa){this.vs?(0>Y&&(Y=0),0>Sa&&(Sa=0),this.IH.style.left=this.kj.Zc(Y),this.IH.style.top=this.kj.Zc(Sa)):H.a.$(508692371,829,15,"ReplaceObjectSuggestionsGalleryView::SetPosition - called before setup")}setVisibility(Y){if(this.IH){if(this.su)if(Y)this.su.ssl=
new Date,this.su.cIn();else{let Sa;(Sa=this.su).yqh=Sa.yqh+(+new Date-+this.su.ssl)}this.IH.style.visibility=Y?hc.a.visible:hc.a.hidden;this.lSe=Y;this.Na.Gm(fc.a.Yrd,Y)}}uvm(){this.Xck=-1}H1b(){return!!this.su&&1===this.su.suggestionType}get k1e(){this.Qv&&"undefined"!==typeof this.Qv||(this.Qv=this.kj.kg(),this.Qv.setAttribute("id","ModalDiv"),this.kj.addCssClass(this.Qv,"cui-modalDiv"),this.Qv.setAttribute("Unselectable","on"),document.body.appendChild(this.Qv),Vb.a.instance.Ub(Z.a.aH,this.Qv,
Object(h.a)(this,this.Pue,"onModalPointerDown")),Vb.a.instance.Ub(Z.a.JQ,this.Qv,Object(h.a)(this,this.Que,"onModalPointerUp")),Vb.a.instance.Ub(Z.a.xnc,this.Qv,Object(h.a)(this,this.JSn,"onModalPointerMove")),Vb.a.instance.Ub(Z.a.IQ,this.Qv,Object(h.a)(this,this.KSn,"onModalPointerOut")),Ac.a.instance.Ub(Z.a.click,this.Qv,Object(h.a)(this,this.ISn,"onModalClick")),pa.a.instance.Ub(Z.a.Bhb,this.Qv,Object(h.a)(this,this.F_g,"onModalMouseWheel")));return this.Qv}Pue(){return!0}Que(){return this.kyj()}JSn(){return!0}KSn(){return!0}ISn(){return this.kyj()}F_g(){return!0}kyj(){if(!this.su||
!this.su.slide)return!0;const Y=this.su.shape;if(!Y)return!0;this.la.Ra(tb.a.Vad,2,Object.assign(new ia,{action:2,shape:Y}));return!0}}Object(c.a)(se,"ReplaceObjectSuggestionsGalleryView",null,[755,785]);class Ie{constructor(Y,Sa,Mb,oc){this.rGn=Y;this.xU=Sa;this.ya=Mb;this.na=oc}ken(Y){if(!this.ya.Ia)return!1;Y=this.ya.Ia.h1(Y);return this.nAh(Y)}nAh(Y){return!(Y&&Y.get_shapeId()&&Y.hasText&&this.xU.FPc(Y))||Y.get_shapeRotation()||Y.EG||Y.Lfa||Y.yr||!this.rGn.validate(Y)?!1:!0}Bzn(Y){return!Array.contains(this.na.N4e,
Y)}}Object(c.a)(Ie,"ReplaceObjectValidationHelper",null,[]);class Se{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we){this.qQ=this.G8a=null;this.tP=!1;this.Xwa=Y;this.kf=Sa;this.dD=Mb;this.YDa=oc;this.NJb=Oc;this.mf=Cd;this.na=nd;this.Qde=we}get vs(){return this.tP}eJh(){this.na.qEe?this.qQ.setAttribute("Src",this.mf.Eq("BLUEBOLT_Deactivated.gif")):this.qQ.style.opacity=".3";this.Qde.bym(Object(h.a)(this,this.dismiss,"dismiss"))}CJh(){this.na.qEe?this.qQ.setAttribute("Src",this.mf.Eq("BLUEBOLT_Reactivated.gif")):
this.qQ.style.opacity="initial";this.Qde.disabled=!1}show(){this.na.qEe?this.qQ.setAttribute("Src",this.mf.Eq("BLUEBOLT_Entrance.gif")):this.qQ.setAttribute("Src",this.mf.Eq("LightningIdeasOOUI_blue_32x.png"))}dismiss(){this.na.qEe?(this.qQ.setAttribute("Src",this.mf.Eq("BLUEBOLT_Exit.gif")),this.Qde.Mao(()=>{this.Xwa.va.style.visibility=hc.a.hidden})):(this.qQ.setAttribute("Src",""),this.Xwa.va.style.visibility=hc.a.hidden)}setup(){this.vs||(this.Xwa?(this.G8a=new rj.a,this.G8a.va.style.visibility=
hc.a.inherit,this.G8a.va.style.position=hc.a.absolute,this.qQ=Ib.a.LK(),this.qQ.setAttribute("Unselectable","on"),this.qQ.setAttribute(Fa.a.ii,Fa.a.pV),this.qQ.className="gifFloatie",this.G8a.va.appendChild(this.qQ),this.Xwa.appendChild(this.G8a),this.Xdc()):H.a.$(38072903,829,15,"parentElement is null"),this.tP=!0)}Slm(Y){let Sa;switch(this.na.moc){case 7:Sa="BLUEBOLT_Hover_on.gif";break;case 8:Sa="BLUEBOLT_HoverWhite_On.gif";break;default:Sa="BLUEBOLT_Hover_on.gif"}this.qQ.setAttribute("Src",this.mf.Eq(Sa));
return this.NJb(Y)}onBlur(){let Y;switch(this.na.moc){case 7:Y="BLUEBOLT_Hover_off.gif";break;case 8:Y="BLUEBOLT_HoverWhite_Off.gif";break;default:Y="BLUEBOLT_Hover_off.gif"}this.qQ.setAttribute("Src",this.mf.Eq(Y));return!0}Xdc(){this.YDa&&this.kf.Ub(Z.a.click,this.qQ,this.YDa);this.NJb&&(this.dD.Ub(Z.a.ZO,this.qQ,Object(h.a)(this,this.Slm,"onHover")),this.dD.Ub(Z.a.IQ,this.qQ,Object(h.a)(this,this.onBlur,"onBlur")))}Rxl(){this.YDa&&this.kf.hc(Z.a.click,this.qQ,this.YDa);this.NJb&&(this.dD.hc(Z.a.ZO,
this.qQ,Object(h.a)(this,this.Slm,"onHover")),this.dD.hc(Z.a.IQ,this.qQ,Object(h.a)(this,this.onBlur,"onBlur")))}dispose(){this.dismiss();this.Rxl();this.tP=!1}}Object(c.a)(Se,"GifFlyoutAnchor",null,[811,785]);class Ke{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg){this.qQ=this.lY=null;this.Xwa=Y;this.nRa=Sa;this.JEn=Mb;this.KEn=oc;this.dfm=Vf.moc;this.rcm=Vf.nEe;this.scm=Vf.qEe;this.JYc=nd;this.GOg=Oc;this.kf=Cd;this.dD=Zd;this.YDa=we;this.NJb=Qe;this.kj=kf;this.aHn=eg;this.Qde=zg;this.tP=
!1}get jQf(){return 1===this.aHn?ResourceStrings.l_ReplaceIconSuggestionFloatieTooltip:this.Qde.disabled?ResourceStrings.l_ReplaceObjectGrayFloatieTooltip:ResourceStrings.l_ReplaceObjectFloatieTooltip}get vs(){return this.tP}setup(){this.vs||(this.lY=new rj.a,this.qQ=this.GOg.m5m(),this.lY.va.style.visibility=hc.a.inherit,this.YTb(),this.tP=!0)}eJh(){this.Qde.bym(Object(h.a)(this,this.dismiss,"dismiss"));this.vkc();this.ljh();this.lY.qVl("replaceObjectGrayedFlyoutAnchor")||this.lY.Nw("replaceObjectGrayedFlyoutAnchor")}show(){this.vs?
this.ljh(this.scm):H.a.$(38072907,829,15,"ReplaceObjectFlyoutAnchor::Show - called before setup")}CJh(){this.Qde.disabled=!1;this.vkc();this.ljh();this.lY.gec("replaceObjectGrayedFlyoutAnchor")}ljh(Y){this.vs?this.qQ.setImage(this.xhn(void 0===Y?!1:Y),""):H.a.$(25306443,829,15,"ReplaceObjectFlyoutAnchor::SetGlyph - called before setup")}xhn(Y){const Sa=this.JYc.jSi(this.nRa,this.nRa,this.JEn,this.KEn,this.jQf,null);this.kj.addCssClass(this.lY.va,"replaceObjectFlyoutAnchorBase");this.kj.addCssClass(this.lY.va,
"replaceObjectFlyoutAnchor"+this.dfm);Y&&(this.kj.addCssClass(this.lY.va,"replaceObjectFlyoutAnchorAnimBase"),this.kj.addCssClass(this.lY.va,"replaceObjectFlyoutAnchorAnim"+this.rcm));return Sa}vkc(){this.vs?(this.qQ.clear(),this.kj.removeCssClass(this.lY.va,"replaceObjectFlyoutAnchorBase"),this.kj.removeCssClass(this.lY.va,"replaceObjectFlyoutAnchor"+this.dfm),this.scm&&(this.kj.removeCssClass(this.lY.va,"replaceObjectFlyoutAnchorAnimBase"),this.kj.removeCssClass(this.lY.va,"replaceObjectFlyoutAnchorAnim"+
this.rcm))):H.a.$(25306445,829,15,"ReplaceObjectFlyoutAnchor::ClearGlyph - called before setup")}dispose(){this.vs&&(this.Rxl(),this.lY&&this.lY.va.parentNode&&this.lY.Or(),this.dismiss(),this.qQ.dispose(),this.lY=null,this.tP=!1)}dismiss(){this.vs?(this.vkc(),this.Xwa.va.style.visibility=hc.a.hidden):H.a.$(25306447,829,15,"ReplaceObjectFlyoutAnchor::Dismiss - called before setup")}YTb(){this.Xwa?(this.lY.va.style.width=this.kj.Zc(this.nRa),this.lY.va.style.height=this.kj.Zc(this.nRa),this.lY.va.setAttribute(Fa.a.ii,
Fa.a.fM),this.Xwa.appendChild(this.lY),this.qQ.YTb(this.lY.va),this.Xdc()):H.a.$(25306449,829,15,"ReplaceObjectFlyoutAnchor::BuildDom - parentElement is null")}Szb(){return!0}Xdc(){this.YDa&&this.kf.Ub(Z.a.click,this.lY.va,this.YDa);this.kf.Ub(Z.a.doubleClick,this.lY.va,Object(h.a)(this,this.Szb,"onDoubleClick"));this.NJb&&(this.dD.Ub(Z.a.ZO,this.lY.va,this.NJb),this.dD.Ub(Z.a.ZO,this.lY.va.firstChild,this.NJb),this.dD.Ub(Z.a.ZO,this.lY.va.firstChild.firstChild,this.NJb))}Rxl(){this.YDa&&this.kf.hc(Z.a.click,
this.lY.va,this.YDa);this.kf.hc(Z.a.doubleClick,this.lY.va,Object(h.a)(this,this.Szb,"onDoubleClick"));this.NJb&&(this.dD.hc(Z.a.ZO,this.lY.va,this.NJb),this.dD.hc(Z.a.ZO,this.lY.va.firstChild,this.NJb),this.dD.hc(Z.a.ZO,this.lY.va.firstChild.firstChild,this.NJb))}}Object(c.a)(Ke,"ReplaceObjectFlyoutAnchor",null,[811,785]);class Kd{constructor(Y,Sa){this.C6=null;this.Po=Y;this.kj=Sa;this.tP=!1}get vs(){return this.tP}get BBa(){return this.C6}setup(){this.vs||(this.C6=new rj.a,this.YTb(),this.tP=!0)}YTb(){this.Po?
(this.Po.appendChild(this.BBa.va),this.kj.addCssClass(this.BBa.va,"replaceObjectPreviewContainer"),this.BBa.setVisibility(!1)):H.a.$(25306518,829,15,"ReplaceObjectPreviewImageView::BuildDom - parentElement is null")}setImage(Y){if(this.vs){if(Y=this.SVb(Y))this.lec(),this.BBa.va.appendChild(Y),this.BBa.setVisibility(!0)}else H.a.$(25306520,829,15,"ReplaceObjectPreviewImageView::SetImage - called before setup")}zh(Y,Sa){this.vs?this.BBa.zh(Y,Sa):H.a.$(25306522,829,15,"ReplaceObjectPreviewImageView::SetSize - called before setup")}dispose(){this.vs&&
(this.dismiss(),this.BBa&&this.BBa.va.parentNode&&(this.BBa.Or(),this.kj.removeCssClass(this.BBa.va,"replaceObjectPreviewContainer")),this.C6=null)}dismiss(){this.vs?(this.lec(),this.BBa.setVisibility(!1)):H.a.$(25306524,829,15,"ReplaceObjectPreviewImageView::Dismiss - called before setup")}SVb(Y){if(!Eb.a.wb(Y)){const Sa=Ib.a.LK();Sa.setAttribute("Unselectable","on");Sa.src=Y;Sa.style.height="100%";Sa.style.width="100%";return Sa}return null}lec(){this.BBa.va.firstChild&&this.BBa.va.removeChild(this.BBa.va.firstChild)}}
Object(c.a)(Kd,"ReplaceObjectPreviewImageView",null,[785]);var Ae=a(1416);class We{constructor(Y,Sa,Mb,oc,Oc,nd,Cd){this.kf=Y;this.dD=Sa;this.kj=Mb;this.JYc=oc;this.na=Oc;this.mf=nd;this.Eem=Cd}n4m(Y,Sa,Mb,oc,Oc){Y=Jg.zno(this.na.moc,Oc)?new Se(Y,this.kf,this.dD,Mb,oc,this.na,this.mf,this.kj,this.Eem):new Ke(Y,Sa,"per","PowerPointDesigner_32x32x32",this,this.JYc,this.kf,this.dD,Mb,oc,this.kj,this.na,Oc,this.Eem);Y.setup();return Y}n5m(Y){Y=new Kd(Y,this.kj);Y.setup();return Y}m5m(){return new Ae.a(this.kj)}}
Object(c.a)(We,"ReplaceObjectViewFactory",null,[]);class je{constructor(Y,Sa,Mb){this.kj=Y;this.ya=Mb;this.yyb=Sa}iMh(Y){if(!Y)throw Error.argumentNull("shape");var Sa=Y.jX;Y=this.XUe(Sa.TopLeft);Sa=this.XUe(Sa.TopRight);return ib.a.pn(Y,Sa)}hMh(Y){if(!Y)throw Error.argumentNull("shape");var Sa=Y.jX;Y=this.XUe(Sa.TopRight);Sa=this.XUe(Sa.BottomRight);return ib.a.pn(Y,Sa)}O5f(Y){return this.iMh(Y)*this.r5l()}N5f(Y){return this.hMh(Y)*this.r5l()}Hkn(Y){if(!Y)throw Error.argumentNull("shape");var Sa=
Y.jX;Y=this.XUe(Sa.TopLeft);Sa=this.XUe(Sa.TopRight);return ta.a.$O(ib.a.sH(Y,Sa))}E1l(){return this.getBounds(this.yyb.jd.hs)}getBounds(Y){var Sa;return this.kj.ji(Y,null===(Sa=this.yyb.jd)||void 0===Sa?void 0:Sa.hs)}r5l(){const Y=this.yyb.jd;return Y?Y.rM:1}XUe(Y){return new ib.a(Y.X,Y.Y)}FPc(Y){return Y?!!this.ya.Ia&&this.ya.Ia.fc.equals(Y.slideId):!1}}Object(c.a)(je,"ReplaceObjectViewHelper",null,[]);var Me=a(615);class ue{constructor(Y,Sa,Mb){this.Gka=this.Jja=null;this.bDa=Y;this.oGn=Sa;this.ZSh=
Mb}get jP(){return"ReplaceObjectWacALWorkflow"}get proto(){return'syntax="proto3";message ShapeTextConvertable { string Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; };'}get Ozc(){this.Jja||(this.Jja=Object.assign(new Uk.a,{name:"LambdaBefore_ReplaceObjectWacAL",inputSchema:Me.a.m_h,outputSchema:Me.a.m_h,func:Object(h.a)(this,this.a3b,"lambdaBeforeFunc")}));return this.Jja}get Syc(){return null}get u7c(){this.Gka||(this.Gka=Object.assign(new Uk.a,{name:"LambdaRemote_ReplaceObjectWacAL",
inputSchema:Me.a.m_h,outputSchema:"ShapeTextConvertable",func:Object(h.a)(this,this.Vlg,"lambdaRemoteFunc")}));return this.Gka}a3b(Y,Sa,Mb){if(Y&&this.oGn.zQj())if(Y){try{var oc=de.a(Y.ContextId)}catch(Oc){H.a.$(507843271,375,10,"{0}:LambdaBeforeDone - Try parse tile contextId failed",this.jP);Mb(null);return}this.ZSh.Bzn(oc.t)?this.ZSh.ken(oc.shapeId)?Mb(Y):(H.a.$(507843269,375,50,"{0}:LambdaBeforeDone - shape invalid",this.jP),Mb(null)):(H.a.$(507843270,375,50,"{0}:LambdaBeforeDone - trigger invalid",
this.jP),Mb(null))}else Mb(null),H.a.$(507843272,375,50,"{0}:LambdaBeforeDone -  ShapeTextTile null",this.jP);else H.a.$(507843273,375,50,"{0}:LambdaBeforeDone -  input null or ineligible",this.jP),Mb(null)}Vlg(Y,Sa,Mb){Y?Y?this.bDa.execute(oc=>{oc.T4e(Y.Topic,Y.Data,Y.ContextId,Oc=>{this.Obb(Oc)},Oc=>{this.Lbb(Oc)},Mb)}):Mb(null):Mb(null)}Obb(Y){if(!n.AFrameworkApplication.Ch&&Y&&Y.data){var Sa=Y.data.state;if(Sa){try{var Mb=de.a(Y.data.responseData)}catch(oc){Sa(null);H.a.$(507843268,375,10,"Try parse aug response failed:{0}",
oc.message);return}Sa(Mb)}}}Lbb(Y){!n.AFrameworkApplication.Ch&&Y&&Y.data&&(Y=Y.data.state)&&Y(null)}}Object(c.a)(ue,"ReplaceObjectWacALWorkflow",null,[786]);var af=a(272);class Ge{constructor(){this.nuk=null}nAh(Y){return this.validate(Y)?this.nuk?this.nuk.nAh(Y):!0:!1}ebo(Y){this.nuk=Y}}Object(c.a)(Ge,"ReplaceObjectWall",null,[]);class ff extends Ge{constructor(){super();this.xU=null}s4l(Y){const Sa=this.xU.O5f(Y);Y=this.xU.N5f(Y);var Mb=Sa*Y;const oc=this.xU.E1l().width,Oc=this.xU.E1l().height;
Mb=Mb/(oc*Oc)*100;H.a.$(37041415,829,50,"ReplaceObjectValidationHelper::GetShapeAreaRatio - shapeWidth: {0}; shapeHeight{1}; slideWidth:{2}; slideHeight{3}; ratio: {4}",Sa,Y,oc,Oc,Mb);return Mb}}Object(c.a)(ff,"AreaRatioWall",Ge,[]);class Gf extends ff{constructor(Y,Sa){super();this.xFn=Y;this.xU=Sa}validate(Y){return this.s4l(Y)<=this.xFn}}Object(c.a)(Gf,"MaxAreaRatio",ff,[]);class wf extends Ge{constructor(Y,Sa){super();this.wFn=Y;this.xU=Sa}validate(Y){return this.xU.N5f(Y)<=this.wFn}}Object(c.a)(wf,
"MaxShapeHeight",Ge,[]);class yf extends Ge{constructor(Y,Sa){super();this.yFn=Y;this.xU=Sa}validate(Y){return this.xU.O5f(Y)<=this.yFn}}Object(c.a)(yf,"MaxShapeWidth",Ge,[]);class wg extends ff{constructor(Y,Sa){super();this.CFn=Y;this.xU=Sa}validate(Y){return this.s4l(Y)>=this.CFn}}Object(c.a)(wg,"MinAreaRatio",ff,[]);var Fh=a(53);class Yh extends Ge{constructor(Y,Sa){super();this.BFn=Y;this.La=Sa}validate(Y){return this.yjn(Y,this.La)>=this.BFn}yjn(Y,Sa){if(!Y)return 0;let Mb=0;Sa.fJ(Y,oc=>{oc.Va(Fh.a.Tq)&&
(oc=oc.jb(Fh.a.Tq))&&0<oc.length&&Mb++});return Mb}}Object(c.a)(Yh,"MinParagraphCount",Ge,[]);class Qi extends Ge{constructor(Y,Sa){super();this.AFn=Y;this.xU=Sa}validate(Y){return this.xU.N5f(Y)>=this.AFn}}Object(c.a)(Qi,"MinShapeHeight",Ge,[]);class ml extends Ge{constructor(Y,Sa){super();this.EFn=Y;this.xU=Sa}validate(Y){return this.xU.O5f(Y)>=this.EFn}}Object(c.a)(ml,"MinShapeWidth",Ge,[]);class Pk{constructor(Y,Sa,Mb){this.rta=null;this.na=Y;this.La=Sa;this.d1e=Mb;this.init(this.na.M4e)}validate(Y){return this.rta?
this.rta.nAh(Y):!0}init(Y){Y=this.r6m(Y);this.KZm(Y)}r6m(Y){const Sa={};if(Eb.a.wb(Y))return Sa;Y=Y.split(";");for(const Mb of Y)Eb.a.wb(Mb)||(Y=Mb.split(":"),2===Y.length?Sa[Y[0]]=Y[1]:H.a.$(507843084,829,10,"ReplaceObjectClientWalls::Parse - wall: {0}",Mb));return Sa}KZm(Y){const Sa=[];"MinParagraphCount"in Y&&Array.add(Sa,new Yh(af.d(Y,"MinParagraphCount",0),this.La));"MinShapeHeight"in Y&&Array.add(Sa,new Qi(af.b(Y,"MinShapeHeight",0),this.d1e));"MaxShapeHeight"in Y&&Array.add(Sa,new wf(af.b(Y,
"MaxShapeHeight",Number.MAX_VALUE),this.d1e));"MinShapeWidth"in Y&&Array.add(Sa,new ml(af.b(Y,"MinShapeWidth",0),this.d1e));"MaxShapeWidth"in Y&&Array.add(Sa,new yf(af.b(Y,"MaxShapeWidth",Number.MAX_VALUE),this.d1e));"MinShapeAreaRatio"in Y&&Array.add(Sa,new wg(af.b(Y,"MinShapeAreaRatio",0),this.d1e));"MaxShapeAreaRatio"in Y&&Array.add(Sa,new Gf(af.b(Y,"MaxShapeAreaRatio",Number.MAX_VALUE),this.d1e));for(Y=0;Y<Sa.length-1;Y++)Sa[Y].ebo(Sa[Y+1]);0<Sa.length&&(this.rta=Sa[0])}}Object(c.a)(Pk,"ReplaceObjectWalls",
null,[756]);class Tg{constructor(){this.ga=null;this.Tfa=this.vfk=this.Zfk=!1}get name(){return"PowerPointWebEditor.ReplaceObject"}oc(Y){this.ga=Y;(this.Tfa=this.ga.resolve("PowerPointWebEditor.IApplicationContext").Pd.li)&&this.ga.register(Lj.a,"PowerPointWebEditor.PodsInfoSender").oa().pa(()=>new Lj.a(n.AFrameworkApplication.$d,this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.ga.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),
this.ga.resolve("PowerPointWebEditor.IErrorHandler"),this.ga.resolve("Common.ITaskManager"),this.ga.resolve("Common.IAppSettingsManager")));Y.register(hd,"PowerPointWebEditor.ReplaceObject.ReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers").oa().pa(()=>new hd);Y.register(je,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper").oa().pa(()=>
new je(Y.resolve("PowerPoint.IBrowserHelperManager"),Y.resolve("PowerPointWebEditor.IActiveSlideViewManager"),Y.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));Y.register(755,"PowerPointWebEditor.IReplaceObjectGalleryView").oa().pa(()=>new se(Y.resolve("PowerPoint.IBrowserHelperManager"),Y.resolve("Common.IPointerInputManager"),Y.resolve("Common.IClickInputManager"),Y.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Y.resolve("Common.IActionManagerExtended"),Y.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),
Y.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),Y.resolve("PowerPointWebEditor.IInputHandlerManager"),Y.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),Y.resolve("PowerPointWebEditor.IFocusManager"),Y.resolve("PowerPointWebEditor.IApplicationSettings"),Y.resolve("Common.IBrowserUtils")));Y.register(756,"PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls").oa().pa(()=>new Pk(Y.resolve("PowerPointWebEditor.IApplicationSettings"),Y.resolve("PowerPointWebEditor.IShapeReader"),
Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")));Y.register(Ie,"PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper").oa().pa(()=>new Ie(Y.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls"),Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),Y.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Y.resolve("PowerPointWebEditor.IApplicationSettings")));Y.register(757,"PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager").oa().pa(()=>
new S(Y.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),Y.resolve("PowerPointWebEditor.IApplicationSettings").HZe));Y.register(758,"PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager").oa().pa(()=>Y.resolve("Common.IAppSettingsManager").getBooleanAppSetting(Ai.a.O4c)?new Pe((Sa,Mb,oc,Oc,nd,Cd)=>{const Zd=new fd(Y.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Y.eb("PowerPointWebEditor.IDesignerServiceProvider"));
Zd.Ljd(Sa,Mb,oc,Oc,nd,Cd);return Zd}):new ra(new fd(Y.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Y.eb("PowerPointWebEditor.IDesignerServiceProvider"))));Y.register(759,"PowerPointWebEditor.IReplaceObjectManager").oa().pa(()=>Y.resolve("Common.IAppSettingsManager").getBooleanAppSetting(Ai.a.O4c)?new Cl(Y.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),Y.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),Y.resolve("PowerPointWebEditor.IFocusManager"),
Y.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Y.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Y.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),Y.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),Y.resolve("PowerPointWebEditor.IPptSelectionManager"),Y.resolve("Common.IActionManagerExtended"),Y.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),Y.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),
Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),Y.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager"),Y.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),Y.resolve("PowerpointPresence.IPresenceEventHandlers"),Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),Y.resolve("PowerPointWebEditor.View.IViewEventSource"),Y.resolve("PowerPointWebEditor.IApplicationSettings"),
Y.resolve("PowerPointWebEditor.IActionNameResolver"),Y.resolve("Common.ITaskManager"),Y.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),Y.eb("PowerPointWebEditor.IDesignerServiceProvider")):new yd(Y.resolve("PowerPointWebEditor.IFocusManager"),Y.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Y.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Y.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),Y.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
Y.resolve("PowerPointWebEditor.IPptSelectionManager"),Y.resolve("Common.IActionManagerExtended"),Y.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),Y.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),Y.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Y.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),
Y.resolve("PowerpointPresence.IPresenceEventHandlers"),Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),Y.resolve("PowerPointWebEditor.View.IViewEventSource"),Y.resolve("PowerPointWebEditor.IApplicationSettings"),Y.resolve("PowerPointWebEditor.IActionNameResolver"),Y.resolve("Common.ITaskManager"),Y.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),Y.eb("PowerPointWebEditor.IDesignerServiceProvider")));Y.register(t,"PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").oa().pa(()=>
new t(Y.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Y.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>"),Y.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>"),Y.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),Y.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),
Y.resolve("PowerPointWebEditor.IReplaceObjectGalleryView"),Y.resolve("PowerPointWebEditor.IFocusManager"),Y.resolve("Box4.IPageView").Ua,Y.resolve("PowerPointWebEditor.IShapeReader")));Y.register(Jg,"PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer").oa().pa(()=>new Jg(Y.resolve("PowerPointWebEditor.IApplicationSettings"),Y.resolve("Common.ITaskManager")));Y.register(We,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory").oa().pa(()=>new We(Y.resolve("Common.IClickInputManager"),Y.resolve("Common.IPointerInputManager"),
Y.resolve("PowerPoint.IBrowserHelperManager"),Y.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),Y.resolve("PowerPointWebEditor.IApplicationSettings"),Y.resolve("PowerPoint.IPathManager"),Y.resolve("PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer")));Y.register(525,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>").oa().pa(()=>new Ec.a((Sa,Mb)=>{let oc=null;const Oc=Object(G.a)(112,Sa.yc(Y.resolve("Box4.IPageView").Ua));
Oc&&!Oc.isDisposed&&Oc.Cua&&(oc=new Ud(Sa,Oc,Mb,Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),Y.resolve("Common.IActionManagerExtended"),Y.resolve("PowerPoint.IBrowserHelperManager"),Y.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),Y.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),Y.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),Y.resolve("PowerPointWebEditor.IApplicationSettings"),Y.resolve("PowerPointWebEditor.IReplaceObjectGalleryView"),
Y.resolve("PowerPointWebEditor.IActiveSlideViewManager")),oc.setup());return oc}));Y.register(525,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>").oa().pa(()=>new Ec.a((Sa,Mb)=>{let oc=null;const Oc=Object(G.a)(112,Sa.yc(Y.resolve("Box4.IPageView").Ua));Oc&&!Oc.isDisposed&&Oc.Cua&&(oc=new Ob(Sa,Oc,Mb,Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")),
oc.setup());return oc}));Y.register(ue,"PowerPointWebEditor.ReplaceObject.ReplaceObjectWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").oa().pa(()=>new ue(this.ga.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.ga.resolve("PowerPointWebEditor.IReplaceObjectManager"),this.ga.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper")));Y.register(Ab,"PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").oa().pa(()=>
new Ab(this.ga.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.ga.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow")));Y.register(Va,"PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").oa().pa(()=>new Va(Y.resolve("PowerPointWebEditor.IPptSelectionManager"),Y.resolve("Common.IActionManagerExtended"),Y.resolve("PowerPointWebEditor.IFocusManager"),Y.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),Y.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Y.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Y.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),Y.resolve("PowerPointWebEditor.View.IViewEventSource"),Y.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),Y.resolve("Common.Transaction.ITransactionFactory"),Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),Y.resolve("PowerPointWebEditor.View.IPPTPageView"),Y.resolve("PowerPointWebEditor.IShapeReader")));
Y.register(qb,"PowerPointWebEditor.ReplaceObject.ReplaceIconManager").oa().pa(()=>new qb(Y.resolve("PowerPointWebEditor.IPptSelectionManager"),Y.resolve("PowerPointWebEditor.View.IViewEventSource"),Y.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),Y.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Y.resolve("PowerPointWebEditor.IShapeReader"),Y.resolve("PowerPointWebEditor.IApplicationSettings"),Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),
Y.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Y.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),Y.resolve("PowerpointPresence.IPresenceEventHandlers"),Y.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),Y.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingStatusChecker"),Y.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),Y.resolve("PowerPointWebEditor.IActionNameResolver"),Y.resolve("PowerPointWebEditor.Core.IUnifiedAppState")))}init(){this.Tfa&&
this.ga.resolve("PowerPointWebEditor.PodsInfoSender");const Y=this.ga.resolve("Common.IAppSettingsManager");Y.Wf(()=>{const Sa=new Date;Y.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?H.a.$(512262752,324,50,"PPTO TestEcsFeature Client Flight Enabled."):H.a.$(512262751,324,50,"PPTO TestEcsFeature Client Flight Disabled.");if(this.Zfk=Y.getBooleanAppSetting(Ai.a.O4e))Y.getBooleanAppSetting(Ai.a.T7c)&&this.ga.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").initialize(),
this.ga.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.ga.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.ga.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.ga.resolve("PowerPointWebEditor.IReplaceObjectManager").setup();if(this.vfk=Y.getBooleanAppSetting(Ai.a.b4d))this.ga.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.ga.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),
this.ga.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.ga.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").setup();H.a.$(512262750,829,50,"ReplaceObject::Callback duration:{0}",+new Date-+Sa)})}dispose(){this.Zfk&&(this.ga.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.ga.resolve("PowerPointWebEditor.IReplaceObjectManager").dispose(),this.ga.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),this.ga.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose());
this.vfk&&(this.ga.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.ga.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),this.ga.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose(),this.ga.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").dispose())}static main(){b.a.instance.Jc(wa.a(new Tg,0))}}Object(c.a)(Tg,"PPTWebEditorReplaceObjectPackage",null,[4,5]);var Kg=a(289),pi=a(595),Zl=a(1325);class Aj{constructor(){this.appName=
0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=!1;this.wdDisableSPOFileCache=this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}}Object(c.a)(Aj,"AppSettings",
null,[]);class $l{constructor(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}}Object(c.a)($l,"ControllerFactoryParameters",null,[]);var um=a(791),nl=a(354);class Ri{}Ri.none="None";Ri.vhFailedToLoadVersionList="VHFailedToLoadVersionList";Ri.vhFailedToGetDownloadToken="VHFailedToGetDownloadToken";Ri.vhFailedToParseVersionList="VHFailedToParseVersionList";Ri.vhFetchFailed="VHFetchFailed";Ri.vhVersioningNotEnabled="VHVersioningNotEnabled";
Ri.vhFileNotFound="VHFileNotFound";Ri.vhVersionTooOld="VHVersionTooOld";Ri.soo="VHFailedToRenderThumbnails";Ri.roo="VHFailedToRenderSlide";Ri.qoo="VHFailedToRenderNotes";Ri.ooo="VHFailedToRenderDiff";Ri.too="VHFailedToShowAnimaitonIcon";Ri.uoo="VHFailedToShowHiddenEffect";Ri.poo="VHFailedToRenderInitPresInfo";Object(c.a)(Ri,"ErrorName",null,[]);class ok{constructor(){this.OYc=new rb.a;this.OYc.add(0,Ri.none);this.OYc.add(100,Ri.vhFailedToLoadVersionList);this.OYc.add(101,Ri.vhFailedToGetDownloadToken);
this.OYc.add(102,Ri.vhFailedToParseVersionList);this.OYc.add(103,Ri.vhFetchFailed);this.OYc.add(104,Ri.vhVersioningNotEnabled);this.OYc.add(105,Ri.vhFileNotFound);this.OYc.add(106,Ri.vhVersionTooOld);this.i_c=new rb.a;this.i_c.add(0,Ri.none);this.i_c.add(100,Ri.soo);this.i_c.add(101,Ri.roo);this.i_c.add(102,Ri.qoo);this.i_c.add(103,Ri.ooo);this.i_c.add(104,Ri.too);this.i_c.add(105,Ri.uoo);this.i_c.add(106,Ri.poo)}get Nco(){return this.OYc}get zoo(){return this.i_c}static y4l(){ok.N4k||(ok.N4k=new ok);
return ok.N4k}}ok.USl="ErrorCode";ok.N4k=null;Object(c.a)(ok,"VersionHistoryTelmetryHelper",null,[]);var Ng=a(478);class ph{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg,yh,qg,Ug){this.bUh=this.qT=this.Iem=this.DSh=this.IYa=this.Xja=this.Jok=this.WSa=this.zna=null;this.omc=-1;this.w_e=null;if(!Ug)throw Error.argumentNull("clientRequestManager");this.la=Y;this.RSa=Sa;this.qk=Mb;this.Ea=oc;this.rc=Oc;this.Bpd={};this.Na=nd;this.Hj=Cd;this.O0e={};this.kc=we;this.aUh={};this.XFn=Zd;this.Fna=Qe;
this.pb=kf;this.Iak=[];Vf&&(this.Iem=Vf,this.Iem.execute(Zh=>{this.qT=Zh}));this.wN=eg;this.xh=zg;this.Rqg=yh;this.r9b=qg;this.Iq=Ug;this.vHn=new Ng.a(oc.Ela)}Kb(){this.la.Ba(r.a.bbd,u.a.frame,Object(h.a)(this,this.sfo,"showVersionHistoryDialogAction"));this.Ea.k3e||this.la.Ba(tb.a.$Wh,u.a.frame,Object(h.a)(this,this.E6g,"pptoShowFileVersion"));this.la.Ba(tb.a.y2h,u.a.frame,Object(h.a)(this,this.cqn,"handleVersionHistoryCopySlides"))}sfo(Y,Sa,Mb){if(1===Mb)return Y=!1,this.pb.P6a&&(Y=!0),Y?2:32;2===
Mb&&(this.bUh=Yb.a.create().toString(),e.ULS.sendTraceTag(512508634,822,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: ${this.m_versionHistoryLaunchSessionId}. disableVHSPOFileCache: ${this.disableVHSPOFileCache()}"),Aa.c(tb.a.jWh,!0),this.Bpd.VersionHistoryLaunchSessionId=this.bUh,this.O0e.VersionHistoryLaunchSessionId=this.bUh,this.Bpd.ShowVersionHistoryDialog=(new Date).getTime().toString(),this.DSh=[],this.zna||(this.zna=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new $l,
{ulsLogger:new pi.a,serviceBase:this.Ea.getSetting("VersionHistoryWebServiceBase"),latestStreamServiceBase:this.Ea.getBooleanAppSetting("PPTVHPodsBootEnabled")?this.Ea.getSetting("PODSLatestServiceBase")+"&PodSID="+this.Ea.getSetting("PodSID"):"",docId:n.AFrameworkApplication.Fh,appSettings:Object.assign(new Aj,{appName:100,wdEnableDownloadTokens:!0,retryCount:this.Ea.getSetting("PodVHRetryCount"),wdEnableRestore:this.kc.oq,userSessionId:n.AFrameworkApplication.userSessionId,wacCluster:this.Ea.Ma("WacCluster"),
uiLocale:this.Ea.EAb?this.Ea.EAb:"en-us",isRtl:n.AFrameworkApplication.isRtl,disabledChangeGates:this.Ea.Ma("VHSDisabledChangeGates"),disableSaveACopy:!this.kc.oq,wdEnableDeleteVersions:this.Ea.getBooleanAppSetting("PPTVersionHistoryDeleteVersionsIsEnabled"),wdDisableSPOFileCache:this.Jkc()}),perfTelemetryInfos:this.DSh}))),this.zna&&this.zna.setDisableSaveACopy(n.AFrameworkApplication.Mz),this.tfo());return 32}E6g(Y,Sa,Mb){return 1===Mb&&this.pb.P6a?2:this.la.Eb(r.a.Uoc,Mb)}cqn(Y,Sa,Mb){if(1===Mb)return this.ozm()?
2:32;this.WSa.onCopySlides();return 32}tfo(){var Y;if(!document.getElementById("VersionHistoryOverlay")){this.$4n();this.Y4n();this.Z4n();this.U4n();this.T4n();this.X4n();this.W4n();this.V4n();const Sa=document.createElement("div");Sa.id="VersionHistoryOverlay";Sa.style.width="100%";Sa.style.zIndex="998";Sa.style.display="block";Sa.style.position="absolute";Sa.style.top="0px";if(this.Ea.getBooleanAppSetting("RegionComposerIsEnabled")){const Mb=(null===(Y=document.getElementById("HeaderRegion"))||
void 0===Y?void 0:Y.offsetHeight)||0;Sa.style.top=Mb+"px";Sa.style.bottom="0px";Sa.style.height=`calc(100vh - ${Mb}px)`}else Sa.style.height="calc(100% + "+ma.AFrame.itd+"px)";document.getElementById("WACInnerFrame").appendChild(Sa);this.Jok=this.zna.createVersionHistoryDialog(Sa);this.Yfc()}document.getElementById("VersionHistoryOverlay").style.display="block";this.zna.getTipVersion&&this.Ea.getBooleanAppSetting("PPTVHPodsBootEnabled")&&this.zna.getTipVersion();this.zna.getVersions("");this.TSm()}TSm(){try{this.w_e=
this.XFn.p2l();for(let Y=0;Y<this.w_e.length;Y++)this.Hj.ns(this.w_e[Y]);this.Hj.jZ(fc.a.mQe)}catch(Y){e.ULS.sendTraceTag(512508633,822,10,"VersionHistoryPaneActor: exception in ActivateVersionHistoryFocus: {0}.",Y)}}K6m(){try{if(this.w_e)for(let Y=0;Y<this.w_e.length;Y++)this.Hj.jZ(this.w_e[Y]);else e.ULS.sendTraceTag(512508632,822,10,"VersionHistoryPaneActor: editorActiveF6Focuses is null.");this.Hj.ns(fc.a.mQe)}catch(Y){e.ULS.sendTraceTag(512508631,822,10,"VersionHistoryPaneActor: exception in DeactivateVersionHistoryFocus: {0}.",
Y)}}$4n(){this.zna.getFullAppErrorEvent().addListener(Y=>{try{const Sa=ok.y4l().Nco.ka(Y);this.O0e[ok.USl]=Sa;e.ULS.sendTraceTag(512508630,822,50,"FullApp Error Event: {0}, VersionHistoryLaunchSessionId: {1}",Sa,this.bUh)}catch(Sa){e.ULS.sendTraceTag(512508629,822,10,"Exception in FullAppErrorEvent call back: {0}.",Sa)}})}Y4n(){this.zna.getVersionsReadyEvent().addListener(Y=>{this.svm(Y.containerDiv);try{e.ULS.sendTraceTag(508843726,822,50,"registerForVersionReadyEvent - getVersionsReadyEvent - disableVHSPOFileCache: ${this.disableVHSPOFileCache()}");
const Sa=Y.versions;if(this.Jkc()){let Mb=Y=!1;const oc=ph.JJc(this.Xja),Oc=ph.JJc(this.IYa);for(const nd of Sa){if(!nd)continue;this.lxh(nd);const Cd=ph.JJc(nd);oc&&Cd===oc?Y=!0:Oc&&Cd===Oc&&(Mb=!0)}this.Xja&&!Y?(this.lxh(this.Xja),Sa.push(this.Xja)):this.IYa&&!Mb&&(this.lxh(this.IYa),Sa.push(this.IYa))}this.LUm(Sa);this.Na.haa("VersionHistoryOverlay",!0);this.Xja&&this.IYa&&this.lJh(this.Xja.DownloadUrl)&&this.lJh(this.IYa.DownloadUrl)&&this.WSa&&(this.AFm(),this.w8l(),this.WSa.onVersionSelected(this.Xja,
this.IYa,this.Bpd),this.tUl())}catch(Sa){e.ULS.sendTraceTag(512508628,822,10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",Sa)}})}lJh(Y){return Y.length?(new URL(Y)).host?!0:(e.ULS.sendTraceTag(508397020,822,10,"VersionHistoryPaneActor: DownloadUrl has no host"),!1):(e.ULS.sendTraceTag(508397021,822,10,"VersionHistoryPaneActor: DownloadUrl is empty"),!1)}LUm(Y){if(this.WSa){var Sa=this.WSa.getAppDataStore();for(const Mb of Y)Sa.AddVersionInfoToStore(Mb)}}Z4n(){this.zna.getVersionSelectedEvent().addListener(Y=>
{this.Xja=Y.currentVersion;this.IYa=Y.baseVersion;if(this.WSa){this.Jkc()&&(this.Xja&&!this.lJh(this.Xja.DownloadUrl)&&this.lxh(this.Xja),this.IYa&&!this.lJh(this.IYa.DownloadUrl)&&this.lxh(this.IYa));try{this.AFm(),this.w8l(),this.WSa.onVersionSelected(this.Xja,this.IYa,this.Bpd),this.s5n(),this.tUl()}catch(Sa){e.ULS.sendTraceTag(512508627,822,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",Sa)}}})}s5n(){const Y=this.C7f(2);Y&&(bc.a.addHandler(Y,Z.a.oi,Object(h.a)(this,
this.LJ,"keyDownHandler")),Jf.a.instance.Ub(Y,Object(h.a)(this,this.KK,"contextMenuHandler")))}llo(){const Y=this.C7f(2);Y&&(bc.a.removeHandler(Y,Z.a.oi,Object(h.a)(this,this.LJ,"keyDownHandler")),Jf.a.instance.hc(Y,Object(h.a)(this,this.KK,"contextMenuHandler")))}LJ(Y){try{if(Y.shiftKey&&Y.keyCode===la.a.Eva||Y.keyCode===la.a.HWa){const Sa=Zl.a.create(Z.a.contextMenu,Y,1);this.KK(Sa)}}catch(Sa){e.ULS.sendTraceTag(512508626,822,10,"VersionHistoryPaneActor:  Exception in KeyDownHandler: {0}",Sa)}}KK(Y){if(1===
Y.Dg){const Sa=this.C7f(2);Sa&&(Y.clientPoint.x=Lb.a.LWe(Sa)+yb.a.aAa,Y.clientPoint.y=Lb.a.MWe(Sa)+yb.a.aAa)}return 32===this.la.Ra(tb.a.VHh,2,Y)}U4n(){this.zna.getDownloadTokenReadyEvent().addListener(Y=>{try{if(e.ULS.sendTraceTag(512508625,822,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.IYa)if(Y&&Y.updatedVersions&&2<=Y.updatedVersions.length){let Sa=null,Mb=null;const oc=ph.JJc(this.Xja),Oc=ph.JJc(this.IYa);for(const nd of Y.updatedVersions){if(!nd)continue;const Cd=
ph.JJc(nd);oc&&oc===Cd?Sa=nd:Oc&&Oc===Cd&&(Mb=nd);if(Sa&&Mb)break}Sa&&Mb?(this.Xja=Sa,this.IYa=Mb,this.WSa.diff(this.Xja,this.IYa)):e.ULS.sendTraceTag(512508623,822,50,"VersionHistoryPaneActor - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",oc,Oc)}else e.ULS.sendTraceTag(512508622,822,50,"VersionHistoryPaneActor - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");
else e.ULS.sendTraceTag(512508624,822,50,"VersionHistoryPaneActor - m_baseVersion is null in GetDownloadTokenReadyEvent callback.")}catch(Sa){e.ULS.sendTraceTag(512508621,822,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",Sa)}})}Jkc(){return this.vHn.P_l||this.Ea.getBooleanAppSetting("DisableVHSPOFileCache")}b9m(Y){return Y?0!=Y.indexOf("SequenceNumber")?(e.ULS.sendTraceTag(508859522,822,15,"VersionHistoryPaneActor - downloadUrlIsValidSyncToken - Download URL does not start with SequenceNumber: {0}",
Y),!1):!0:(e.ULS.sendTraceTag(508859523,822,15,"VersionHistoryPaneActor - downloadUrlIsValidSyncToken - Download URL is null or empty"),!1)}lxh(Y){if(Y&&this.b9m(Y.DownloadUrl)){const Mb=this.Ea.daa;var Sa=Mb+"VersionHistoryDownloadLink.ashx";const oc=n.AFrameworkApplication.Fh;if(oc)Sa=new Rc.QueryStringBuilder(Sa),Sa.ej(yg.a.Uom,oc),Sa.ej(yg.a.IDk,Y.DownloadUrl),Sa.ej(yg.a.Xom,ph.JJc(Y)),Y.DownloadUrl=Sa.toString(),Y=new URL(Mb),e.ULS.sendTraceTag(508940565,822,50,`VersionHistoryPaneActor - updateDownloadUrl - Generated download URL with popsServiceBase host: ${Y.host}`);
else throw e.ULS.sendTraceTag(508936896,822,15,"VersionHistoryPaneActor - updateDownloadUrl - QuerySignature not found"),Error("Could not update downloadUrl with valid VersionHistoryDownloadLink - QuerySignature not found");}else e.ULS.sendTraceTag(508371797,822,15,"VersionHistoryPaneActor - updateDownloadUrl - Invalid SyncToken")}X4n(){this.zna.getSaveACopySelectedEvent().addListener(Y=>{var Sa=n.AFrameworkApplication.x2b;this.Ea.getBooleanAppSetting("VHSaveACopyForOdcOnSpoEnabled")&&(Sa=32===this.la.Eb(tb.a.crd,
1));e.ULS.sendTraceTag(512508620,822,10,"VersionHistoryPaneActor: RegisterForSaveACopySelectedEvent - shouldUseSaveACopyCommand: {0}",Sa);this.Ea.getBooleanAppSetting("PowerPointVersionHistoryFloodGateIsEnabled")&&ph.BPn();this.Jkc()&&(-1!=Y.indexOf("VersionHistoryDownloadLink.ashx")?Y="app=ppt ver="+(new Rc.QueryStringBuilder(Y)).RLh(yg.a.IDk):e.ULS.sendTraceTag(508699020,832,10,"DownloadURL did not contain VersionHistoryDownloadLink"));Y={["FileDownloadUrl"]:Y,["SaveEntryPoint"]:"VersionHistory"};
Sa=Sa?this.la.Ra(tb.a.crd,2,Y):this.la.Ra(r.a.lLb,2,Y);32!==Sa?(Aa.c(tb.a.PHf,!1),e.ULS.sendTraceTag(512508619,832,10,"Failed to launch Save a Copy dialog. ActionResponse: {0}",Sa)):Aa.c(tb.a.PHf,!0)})}dDm(Y,Sa){try{(new Promise((Mb,oc)=>{this.zna.setRestoreInProgress();this.Fna.sjd(this.pb.wk,this.pb.podSessionId,this.pb.ei.string,this.Ea.getSetting(Ai.a.ym),this.pb.Dla,!1,!0,()=>{Mb(!0)},Oc=>{oc("ClosePopWacSessionSync:: "+Oc.error.message)})})).then(()=>{(new Promise((Mb,oc)=>{this.Fna.csd(this.pb.ei.string,
Y,()=>{Mb(!0)},Oc=>{oc("RestoreFileVersion:: "+Oc.error.message)})})).then(()=>{const Mb=Date.now()-Sa;e.ULS.sendTraceTag(512508618,832,50,"VersionHistoryPaneActor: successfully restored version, refreshing now. Time: {0}",Mb);this.O0e.RestoreSucceededTime=Mb;this.la.Ra(tb.a.refresh,2,{["IsSourceVH"]:!0});Aa.c(tb.a.AOd,!0)}).catch(Mb=>{const oc=Date.now()-Sa;this.zna.setRestoreFailedAtServer(()=>{this.la.Ra(tb.a.refresh,2,{["IsSourceVH"]:!0})});e.ULS.sendTraceTag(512508617,832,10,"VersionHistoryPaneActor: Failed to restore version: {0}, Time: {1}",
Mb,oc);this.O0e.RestoreFailedTime=oc;Aa.c(tb.a.AOd,!1)})})}catch(Mb){e.ULS.sendTraceTag(512508616,832,10,"VersionHistoryPaneActor: Sending restore failed with message: {0}",Mb.message),Aa.c(tb.a.AOd,!1)}}W4n(){this.zna.getRestoreVersionSelectedEvent().addListener(Y=>{e.ULS.sendTraceTag(512508615,832,50,"VersionHistoryPaneActor:  RegisterForRestoreVersionSelectedEvent: {0}",Y);const Sa=Date.now();this.qT?(this.Iak=this.qT.dld(),0<this.Iak.length?(e.ULS.sendTraceTag(512508614,832,15,"VersionHistoryPaneActor: restore failed because of {0} coauthors",
this.Iak.length),Aa.c(tb.a.AOd,!1),this.zna.setCoauthRestoreError()):this.dDm(Y,Sa)):(e.ULS.sendTraceTag(512508613,832,10,"VersionHistoryPaneActor: presence manager is null"),this.dDm(Y,Sa))})}V4n(){this.zna.getDownloadVersionSelectedEvent().addListener(Y=>{e.ULS.sendTraceTag(512508612,832,50,"VersionHistoryPaneActor: RegisterForDownloadVersionSelectedEvent called");Y=new Rc.QueryStringBuilder(Y);Y.ej(yg.a.zDk,n.AFrameworkApplication.fileName);Y=this.la.Ra(r.a.downloadACopy,2,{["FileDownloadUrl"]:Y.toString()});
32!==Y?(Aa.c(tb.a.OHf,!1),e.ULS.sendTraceTag(512508611,832,10,"Download version failed with result: {0}",Y)):Aa.c(tb.a.OHf,!0)})}AFm(){for(const Y of this.DSh){const Sa=Y.TelemetryEventKey?Y.TelemetryEventKey:Y.telemetryEventKey?Y.telemetryEventKey:"",Mb=Y.TelemetryEventData?Y.TelemetryEventData:Y.telemetryEventData?Y.telemetryEventData:"";Eb.a.wb(Sa)||Eb.a.wb(Mb)||(this.Bpd[Sa]=Mb)}}tUl(){this.DSh=[];this.Bpd={}}T4n(){this.zna.getCloseSelectedEvent().addListener(()=>{this.Ea.getBooleanAppSetting("PowerPointVersionHistoryFloodGateIsEnabled")&&
ph.DAn();this.IUl()})}IUl(){this.K6m();this.Na.$da("VersionHistoryOverlay");document.getElementById("VersionHistoryOverlay").style.display="none";this.Ea.Tzi&&(this.Xja=null);e.ULS.sendTraceTag(512508610,822,50,de.c(this.O0e))}svm(Y){try{if(this.WSa)sk.setIsPageLoadForFirstTime(!1),this.WSa.switchParentViewContainer(Y);else{sk.setIsPageLoadForFirstTime(!0);const Sa=new PowerPointVersionHistory.AppBootSettings;Sa.RenderServiceBase="";Sa.IsRtl=n.AFrameworkApplication.isRtl;const Mb=new PowerPointVersionHistory.AppCallbackBag;
Mb.animationDecoratorCallback=Object(h.a)(this.RSa,this.RSa.YQi,"createAnimationOrTransitionStar");Mb.notesIconDecoratorCallback=Object(h.a)(this,this.W4m,"createNotesIcon");Mb.addToF6LoopCallback=Object(h.a)(this,this.GUm,"addToF6Loop");Mb.copySlideCallback=Object(h.a)(this,this.copySlideCallback,"copySlideCallback");Mb.reportViewerErrorCallback=oc=>{this.O0e[ok.USl]=ok.y4l().zoo.ka(oc);106!==oc&&103!==oc||this.zna.setViewerError(!0);e.ULS.sendTraceTag(512508609,822,50,"Versions viewer error: {0}",
oc);0!==oc&&(n.AFrameworkApplication.Ds(pf.a.Ji(406)),Rf.Health.instance.recordQosError("VersionHistoryFailed",["VersionHistoryACE"],!1,!1,!0,!1,null));return!0};Sa.IsHighContrast=!1;this.qk&&(Sa.IsHighContrast=this.qk.isInHighContrastMode);Sa.IsHighContrast&&(Sa.ClientColorSettings=this.qk.highContrastColors.foregroundTextColor+"_"+this.qk.highContrastColors.backgroundColor+"_"+this.qk.highContrastColors.linkColor);if(this.rc){const oc=this.rc.m5a();Sa.DefaultSlideWidth=oc.width;Sa.DefaultSlideHeight=
oc.height}Sa.UserSessionId=n.AFrameworkApplication.userSessionId;Sa.VersionViewerCssUrl=this.Ea.pQe;Sa.ProgressImageResourceUrl=ed.a.NX(yb.a.mZa);Sa.ThumbnailShareOptimizationEnabled=this.Ea.C3e;Sa.SlidePrefetchSettings=Object.assign(new PowerPointVersionHistory.SlidePrefetchSettings,{SlidePrefetchEnabled:this.Ea.getBooleanAppSetting("PPTVHSlidePrefetchEnabled"),SlidePrefetchAhead:this.Ea.getSetting("PPTVHSlidePrefetchAhead"),SlidePrefetchBehind:this.Ea.getSetting("PPTVHSlidePrefetchBehind"),SlidePrefetchChunkSize:this.Ea.getSetting("PPTVHSlidePrefetchChunkSize"),
SlidePrefetchDelay:this.Ea.getSetting("PPTVHSlidePrefetchDelay")});Sa.FileExtension=void 0!==this.Ea.t1&&null!==this.Ea.t1?Eb.a.GJ(this.Ea.t1).toLowerCase():"";Sa.SlideInformationLabel=ResourceStrings.l_SlideMenuButtonLabel;Sa.NotesButtonLabel=ResourceStrings.L_Notes;Sa.SynchronizerTimeout=this.Ea.getSetting("PptVersionHistorySynchronizerTimeout");Sa.IsRtl=n.AFrameworkApplication.isRtl;Sa.IsCopySlidesEnabled=!0;Sa.SlidePaneLabel=ResourceStrings.L_SlidePaneLabelVH;Sa.ThumbnailPaneLabel=ResourceStrings.L_ThumbnailPaneLabelVH;
Sa.NotesPaneLabel=ResourceStrings.L_NotesPaneLabelVH;Sa.StatusBarLabel=ResourceStrings.L_StatusBarLabelVH;Sa.Lcid=n.AFrameworkApplication.lcid;Sa.EnableOverflowXOnSlideAndNotePane=this.Ea.getBooleanAppSetting("PodVHEnableOverflowXOnSlideAndNotePane");Sa.ThumbnailInfoLabel=ResourceStrings.L_ThumbnailInfoLabelVH;Sa.IsModernCatchUpUxEnable=!0;Sa.IsRevisionTrackingFlyoutEnabled=fb.a("EnableRevisionTrackingFlyoutForVH");Sa.RevisionTrackingFlyoutContent=ResourceStrings.l_SlideIsChanged;this.WSa=new PowerPointVersionHistory.AppVersionController(Sa,
Y,Mb)}}catch(Sa){this.zna.setViewerError(!0),e.ULS.sendTraceTag(512508608,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",Sa)}}W4m(){return Ca.a(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,ResourceStrings.L_Notes)}Yfc(){const Y=this.Na.Uc("VersionHistoryOverlay");Y.parent=ma.AFrame.Wl;Y.US=!0;Y.Peh=!0;Y.Epa(Sa=>{Sa&&"dialog/modal"===Sa.name?this.zna.setSaveACopyCanceled():Sa&&Sa.name===ma.AFrame.aP||(this.omc=-1,this.oDm(!0))});this.Hj.q$("VersionHistoryOverlay");
this.Hj.Hsd(fc.a.mQe,Sa=>{this.oDm(Sa)});this.Hj.Goc(fc.a.mQe,()=>{2===this.omc&&Sys.UI.DomElement.addCssClass(this.C7f(2),"PPTVHViewerElementSelected");3===this.omc&&Sys.UI.DomElement.addCssClass(this.C7f(3),"PPTVHViewerElementSelected")})}oDm(Y){try{const Sa=this.BMh();(this.omc=this.ijn(Y))?1===this.omc?this.Jok.then(Mb=>{Mb.enterHeaderFocusTrapZone();return null}):Sa&&Cb.FocusManager.vz(document.getElementById(Sa[this.omc])):this.Jok.then(Mb=>{Mb.enterFocusTrapZone();return null})}catch(Sa){e.ULS.sendTraceTag(512508579,
822,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",Sa)}}ijn(Y){const Sa=this.BMh();let Mb=this.omc;do if(Y?Sa&&(Mb=(Mb+1)%Sa.length):Sa&&(Mb=0<Mb?Mb-1:Sa.length-1),!Mb||1===Mb||Sa&&"none"!==document.getElementById(Sa[Mb]).style.display)return Mb;while(Mb!==this.omc);return 0}w8l(){const Y=ph.JJc(this.Xja);Y&&!this.aUh[Y]&&(this.aUh[Y]=["VersionListPane","vhHeader"],this.omc=-1)}BMh(){if(!this.Xja)return this.Ea.Tzi?["VersionListPane","vhHeader"]:null;const Y=ph.JJc(this.Xja);
return Y&&this.aUh[Y]?this.aUh[Y]:null}C7f(Y){const Sa=this.BMh();return Sa&&Sa.length>Y?document.getElementById(Sa[Y]):null}GUm(Y){try{const Sa=this.BMh();Sa&&Sa.push(Y)}catch(Sa){e.ULS.sendTraceTag(512508578,822,10,"VersionHistoryPaneActor: exception in AddToF6Loop: {0}.",Sa)}return!0}copySlideCallback(Y){if(this.ozm())return!1;const Sa=Yb.a.create().toString();e.ULS.sendTraceTag(512508577,832,50,"Execute CopySlideCallback - correlationid : {0}",Sa);const Mb=this.wN.SCc(1,Y.SlideIds.length),oc=
{};oc.WacSessionId=n.AFrameworkApplication.userSessionId;oc.CallerCorrelationId=Sa;var Oc={};Oc.Source=Y.Source;Oc.SlideIds=Y.SlideIds;Oc.CcpId=Mb.Rp;Oc.PackageAccessKey=Mb.Jy;Y=JSON.stringify(Oc);Oc=String.format("{0}{1}",this.Ea.ym,"vhcopyslide.ashx");const nd=Date.now();try{if(this.Iq.ik(Oc,2,Y,oc,!1,0,Cd=>{ph.noo(Cd,nd,Sa)},Cd=>{ph.moo(Cd,nd,Sa)},null,null),this.xh.contentWindow&&this.xh.contentWindow.document&&this.xh.contentWindow.document.body){Ib.a.ukc(this.xh);const Cd=Ib.a.s3a();Cd.innerText=
Ib.a.oVh;Cd.setAttribute(nl.a.Rp,Mb.Rp);Cd.setAttribute(nl.a.lD,Mb.lD);Cd.setAttribute(nl.a.count,Mb.objectCount.toString());const Zd=um.a(Mb.dataType);Cd.setAttribute(nl.a.type,Zd);Cd.setAttribute(nl.a.location,Mb.location);Cd.setAttribute(nl.a.Jy,Mb.Jy);this.xh.contentWindow.document.body.appendChild(Cd);this.Rqg.yZa(this.xh);this.r9b.copy(this.xh)}else e.ULS.sendTraceTag(512508576,832,10,"VersionHistoryPaneActor cannot set minimal HTML metadata to system clipboard ")}catch(Cd){e.ULS.sendTraceTag(512508575,
832,10,"VersionHistoryPaneActor exception in CopySlideCallback: {0}",Cd)}return!0}ozm(){return(n.AFrameworkApplication.zB||n.AFrameworkApplication.Mz)&&!n.AFrameworkApplication.DAa}dispose(){document.getElementById("VersionHistoryOverlay")&&"none"!==document.getElementById("VersionHistoryOverlay").style.display&&this.IUl();this.llo()}static JJc(Y){return Y?Y.RevisionID?Y.RevisionID:Y.revisionID?Y.revisionID:"":null}static noo(Y,Sa,Mb){const oc=Date.now();try{JSON.parse(Y.data.responseData).IsCopied?
e.ULS.sendTraceTag(512508574,832,50,"VhCopySlide operation succeeded : Duration : {0}, correlationId : {1}",oc-Sa,Mb):e.ULS.sendTraceTag(512508573,832,10,"VhCopySlide operation failed : Duration : {0}, correlationId : {1}",oc-Sa,Mb)}catch(Oc){e.ULS.sendTraceTag(512508572,832,10,"VersionHistoryPaneActor exception in VHCopySlideRequestSucceeded: {0}, correlationId : {1} ",Oc,Mb)}}static moo(Y,Sa,Mb){const oc=Date.now();e.ULS.sendTraceTag(512508571,832,10,"VhCopySlide operation failed : Duration : {0}, HttpStatusCode : {1}, correlationId : {2}",
oc-Sa,Y.data?Y.data.Je:-1,Mb)}static DAn(){const Y=vb.a.instance.Db("Common.ISystemInitiatedFeedback");Y?(Y.logActivity("VersionHistoryExited",null),Y.logActivity("VersionHistoryCheckExited",null)):e.ULS.sendTraceTag(512508570,822,50,"ISystemInitiatedFeedback was null")}static BPn(){const Y=vb.a.instance.Db("Common.ISystemInitiatedFeedback");Y?Y.logActivity("VersionHistoryExited",null):e.ULS.sendTraceTag(512508569,822,10,"ISystemInitiatedFeedback was null")}}Object(c.a)(ph,"VersionHistoryPaneActor",
null,[804,40]);class Bj{constructor(){this.pEh=this.Oa=null}get name(){return"PowerPointWebEditor.VersionHistory"}oc(Y){this.Oa=Y}init(){n.AFrameworkApplication.ha.Wf(Object(h.a)(this,this.uu,"onFullAppSettingsReady"))}uu(){n.AFrameworkApplication.CZe()?this.Oa.resolve("PowerPointWebEditor.IApplicationSettings").T$d?e.ULS.sendTraceTag(507843211,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the file is open password protected"):(e.ULS.sendTraceTag(507843210,
202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Initializing the React VersionHistory package"),Db.a.get_instance().Ai(7,()=>{mk.a(this.Oa)("versionHistory").catch(Y=>e.ULS.sendTraceTag(39711109,811,10,"Failed to load the resources for the versionHistory feature: {0}",Y)).then(()=>this.TUn()).catch(Y=>e.ULS.sendTraceTag(39711110,811,10,"Failed to initialize the versionHistory feature: {0}",Y))})):e.ULS.sendTraceTag(507843212,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled")}TUn(){this.sQd();
return null}sQd(){this.Oa.register(ph,"PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor").pa(()=>new ph(n.AFrameworkApplication.ub,this.Oa.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.Oa.resolve("Common.Utils.IHighContrastDetector"),this.Oa.resolve("PowerPointWebEditor.IApplicationSettings"),this.Oa.resolve("PowerPointWebEditor.IPresentationReader"),Cb.FocusManager.instance(),Kg.a.instance,this.Oa.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.Oa.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Oa.resolve("PowerPointWebEditor.IPopWebService"),this.Oa.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.Oa.eb("PowerpointPresence.IPresenceManager"),this.Oa.resolve("PowerPointWebEditor.IClipServiceManager"),this.Oa.resolve("PowerPointWebEditor.IDesignModeManager").AXa,this.Oa.resolve("PowerPoint.IBrowserHelperManager"),this.Oa.resolve("PowerPointWebEditor.ISystemClipboard"),n.AFrameworkApplication.$d)).oa();this.pEh=this.Oa.resolve("PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor");
this.pEh.Kb()}dispose(){this.pEh&&this.pEh.dispose()}}Object(c.a)(Bj,"PPTWebEditorVersionHistoryPackageManager",null,[4,5]);var bk=a(626),ol=a(1460),am;(function(Y){Y[Y.anyone=0]="anyone";Y[Y.organization=1]="organization"})(am||(am={}));Object(c.b)("AccessControlEnum",am);var lm=a(353);class fm{constructor(){this.token=this.timeStamp=null}}Object(c.a)(fm,"CachedAccessToken",null,[]);class Dm{constructor(Y){this.G$j={};this.jEn=Y}q_m(Y,Sa){if(!Eb.a.wb(Y)&&!Eb.a.wb(Sa)){const Mb=new fm;Mb.token=Sa;
Mb.timeStamp=new Date;this.G$j[Y]=Mb}}d2l(Y){return Y in this.G$j&&(Y=Object(G.a)(fm,this.G$j[Y]),+new Date-+Y.timeStamp<6E4*this.jEn)?Y.token:null}}Object(c.a)(Dm,"AccessTokenCache",null,[]);class mm{constructor(){this.reject=this.resolve=this.frame=this.xKb=this.VCl=this.resource=this.appId=this.authority=this.id=null;this.XMe=0;this.I0k=null;this.$4g=0;this.qDm=!1}}Object(c.a)(mm,"DirectAuthRequest",null,[]);class Em{constructor(Y){this.IFg={};this.na=Y;this.NZc=new Dm(this.na.uqm);window.addEventListener("message",
Object(h.a)(this,this.O7n,"requestCompletionMessageHandler"),!1)}W2l(Y){const Sa={},Mb=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let oc;for(;oc=Mb.exec(Y);)Sa[Object(G.a)(String,oc[1])]=Object(G.a)(String,oc[2]);return Sa}O7n(Y){if("data"in Y){let Sa=de.d(Y.data);({NB:Y}=Sa);Sa.returnValue&&Y&&"DirectAuthRequestID"in Y&&this.HXe(Y)}}HXe(Y){try{const oc=Y.DirectAuthRequestID;if(oc in this.IFg){var Sa=null,Mb=Object(G.a)(mm,this.IFg[oc]);if(Mb&&Mb.id===oc){H.a.$(507843535,833,50,"DirectAuth: Request completed with request ID: {0}, IsTimedOut: {1}, IsFromPolling: {2}",
oc,"Timeouted"in Y,"FromPolling"in Y);window.clearTimeout(Mb.XMe);delete this.IFg[oc];window.clearTimeout(Mb.$4g);const Oc=new lm.a;Oc.IsSuccess=!1;Oc.ErrorCode="";Oc.ErrorMessage="";Oc.Token="";"Timeouted"in Y?(H.a.$(507843534,833,10,"DirectAuth: Request timed out with host: "+window.location.host),Oc.ErrorCode="Timeout",Oc.ErrorMessage="No response received in time for the authentcation request",Mb.resolve(Oc)):"PopupWindowClosed"in Y&&Mb.xKb?(Oc.ErrorCode="User_aborted",Oc.ErrorMessage="User aborted log in by closing the popup window",
Mb.resolve(Oc)):(Mb.frame?Sa=this.W2l(Mb.frame.contentWindow.location.hash):Mb.xKb&&!Mb.xKb.closed&&(Sa=this.W2l(Mb.xKb.location.hash)),"access_token"in Sa?(Oc.IsSuccess=!0,Oc.Token=Object(G.a)(String,Sa.access_token),this.NZc&&this.NZc.q_m(Mb.I0k,Oc.Token),Mb.resolve(Oc)):(Oc.ErrorCode="error"in Sa?Object(G.a)(String,Sa.error):"unknown",0<=Array.indexOf(this.na.wqm,Oc.ErrorCode)&&Mb.qDm&&Mb.frame&&!Mb.xKb?this.yYn(Mb.authority,Mb.appId,Mb.resource,Mb.VCl,this.na.xqm).then(nd=>{Mb.resolve(nd)}).catch(nd=>
{Mb.reject(nd)}):(Oc.ErrorMessage="error_description"in Sa?Object(G.a)(String,Sa.error_description):"unknown",Mb.resolve(Oc))));Mb.frame?document.body.removeChild(Mb.frame):Mb.xKb&&!Mb.xKb.closed&&Mb.xKb.close()}else H.a.$(507843533,833,10,"DirectAuth: Failed to find the request entry for ID: {0}",oc)}else H.a.$(507843536,833,50,"DirectAuth: Request response doesn't have request ID! Details: "+JSON.stringify(Y))}catch(oc){H.a.$(507843532,833,10,"DirectAuth: Excpetion thrown when handling completion response: "+
oc.message)}}pVl(){const Y=window.location.protocol,Sa=window.location.host;var Mb="/p/";H.a.$(507843531,833,50,"DirectAuth: ConstructReplyUrl: Protocol: {0}, Host: {1}, IsReplyUrlRegistered: {2}",Y,Sa,"ffc-powerpoint.officeapps.live.com"===Sa||"ppc-powerpoint.officeapps.live.com"===Sa);if(void 0===Mb||null===Mb){Mb=window.location.pathname;const oc=Mb.lastIndexOf("/");Mb=0<=oc?Mb.substring(0,oc+1):""}return Y+"//"+Sa+Mb+"WacDirectAuth.html"}sko(Y,Sa,Mb,oc,Oc,nd){return this.xfo(Y,Sa,Mb,oc,Oc,void 0===
nd?!1:nd)}yYn(Y,Sa,Mb,oc,Oc){if(Eb.a.wb(Y))throw Error.argumentNull("authority");if(Eb.a.wb(Sa))throw Error.argumentNull("appId");if(Eb.a.wb(Mb))throw Error.argumentNull("resource");if(Eb.a.wb(oc))throw Error.argumentNull("userUPN");const nd=!Eb.a.wb(oc)&&oc.indexOf("@")<oc.indexOf("."),Cd=this.pVl(),Zd=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}",Y,Sa,encodeURIComponent(Mb),encodeURIComponent(Cd));
if(this.NZc){const kf=this.NZc.d2l(Zd);if(!Eb.a.wb(kf))return H.a.$(507843530,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(Vf=>{const eg=new lm.a;eg.IsSuccess=!0;eg.ErrorCode="";eg.ErrorMessage="";eg.Token=kf;Vf(eg)})}const we=Yb.a.create().toString(),Qe=String.format("{0}&state={1}",Zd,we);return new Promise((kf,Vf)=>{const eg=new mm;eg.authority=Y;eg.appId=Sa;eg.resource=Mb;eg.VCl=oc;eg.resolve=kf;eg.reject=Vf;eg.id=we;eg.I0k=Zd;eg.xKb=window.open("",we,"width=400, height=600");
eg.xKb?(this.IFg[we]=eg,eg.xKb.location.replace(Qe),H.a.$(507843528,833,50,"DirectAuth: New popup request created with ID of: {0}, IsUserUPNAlias: {1}",we,nd),this.oBm(eg,1E3*Oc).then(()=>{const zg={};zg.DirectAuthRequestID=we;zg.FromPolling=!0;this.HXe(zg)}).catch(zg=>{"WindowClosed"===Object(G.a)(String,zg)&&(zg={},zg.DirectAuthRequestID=we,zg.PopupWindowClosed=!0,H.a.$(507843527,833,10,"DirectAuth: Popup window closed for request with ID of: "+we),this.HXe(zg))}),eg.XMe=window.setTimeout(()=>{const zg=
{};zg.DirectAuthRequestID=we;zg.Timeouted=!0;H.a.$(507843526,833,10,"DirectAuth: Popup request timedout with ID of: "+we);this.HXe(zg)},1E3*Oc)):(H.a.$(507843529,833,50,"DirectAuth: Popup window was blocked and cannot continue request of {0}",we),Vf=new lm.a,Vf.IsSuccess=!1,Vf.ErrorCode="fail_to_open_popup",Vf.ErrorMessage="Failed to create popup window!",Vf.Token="",kf(Vf))})}xfo(Y,Sa,Mb,oc,Oc,nd){if(Eb.a.wb(Y))throw Error.argumentNull("authority");if(Eb.a.wb(Sa))throw Error.argumentNull("appId");
if(Eb.a.wb(Mb))throw Error.argumentNull("resource");if(Eb.a.wb(oc))throw Error.argumentNull("userUPN");const Cd=!Eb.a.wb(oc)&&oc.indexOf("@")<oc.indexOf(".");var Zd=this.pVl();const we=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}&prompt=none",Y,Sa,encodeURIComponent(Mb),encodeURIComponent(Zd));if(this.NZc){const Vf=this.NZc.d2l(we);if(!Eb.a.wb(Vf))return H.a.$(507843525,833,50,"DirectAuth: Found valid cached token and use it!"),
new Promise(eg=>{const zg=new lm.a;zg.IsSuccess=!0;zg.ErrorCode="";zg.ErrorMessage="";zg.Token=Vf;eg(zg)})}const Qe=Yb.a.create().toString();Zd=Cd?String.format("{0}&login_hint={1}&state={2}",we,encodeURIComponent(oc),Qe):String.format("{0}&state={1}",we,Qe);const kf=document.createElement("iframe");kf.style.display="none";kf.src=Zd;return new Promise((Vf,eg)=>{const zg=new mm;zg.authority=Y;zg.appId=Sa;zg.resource=Mb;zg.VCl=oc;zg.frame=kf;zg.resolve=Vf;zg.reject=eg;zg.id=Qe;zg.I0k=we;zg.qDm=nd;document.body.appendChild(kf);
H.a.$(507843524,833,50,"DirectAuth: New silent request created with ID of: {0}, IsUserUPNAlias: {1}",Qe,Cd);this.oBm(zg,1E3*Oc).then(()=>{const yh={};yh.DirectAuthRequestID=Qe;yh.FromPolling=!0;this.HXe(yh)});zg.XMe=window.setTimeout(()=>{const yh={};yh.DirectAuthRequestID=Qe;yh.Timeouted=!0;H.a.$(507843523,833,10,"DirectAuth: Silent request timedout with ID of: "+Qe);this.HXe(yh)},1E3*Oc);this.IFg[Qe]=zg})}oBm(Y,Sa){return new Promise((Mb,oc)=>{const Oc=Sa/50;let nd=0;Y.$4g=window.setInterval(()=>
{try{nd++>Oc&&(window.clearInterval(Y.$4g),H.a.$(507843522,833,15,"DirectAuth: WindowHashPoller: Exceeded {0} ms timeout after {1} polls",Sa,Oc),oc(""));const Cd=Y.frame?Y.frame.contentWindow:Y.xKb;if(!Cd||Cd.closed)window.clearInterval(Y.$4g),H.a.$(507843521,833,15,"DirectAuth: WindowHashPoller: Window or Frame is closed before completion"),oc("WindowClosed");let Zd=null,we=null;try{Zd=Cd.location.href,we=Cd.location.hash}catch(Qe){}Zd&&"about:blank"!==Zd?Eb.a.wb(we)||(window.clearInterval(Y.$4g),
Mb(we)):H.a.$(507843520,833,50,"DirectAuth: WindowHashPoller: Don't process blank pages or cross domain: {0}","about:blank"===Zd)}catch(Cd){H.a.$(507843491,833,15,"DirectAuth: WindowHashPoller: threw exception {0}",Cd.message)}},50)})}}Object(c.a)(Em,"DirectAuthHelper",null,[]);class Fm{constructor(){this.welcomeScreenErrorImageUrl=this.welcomeScreenBackgroundImageUrl=this.hostElement=null;this.urlBarHeightInPercentage=this.baseZIndex=0;this.reactionsBarLayerHostId=this.dialogLayerHostId=this.urlBarLayerHostId=
this.calloutContainerId=this.welcomeScreenLayerHostId=null;this.isPowerpointLiveReactionEnabled=this.showTryAgainButton=!1;this.resourceCDNPath=this.onboardingScreenHostId=null;this.enableNewLiveWelcomeScreen=this.enablePrefetchLiveResource=!1;this.podsUrl=this.userSessionId=null}}Object(c.a)(Fm,"ILiveActorSettings",null,[]);class nm{constructor(){this.react=null;this.reactionCount=0;this.reactionImagePath=null;this.numberOfAnimationFrames=0}}Object(c.a)(nm,"ILiveReaction",null,[]);class sm{constructor(){this.isPaused=
this.isPrivate=!1;this.participantsCount=0;this.sessionURLPromise=null;this.sessionCurrentState=0}}Object(c.a)(sm,"ILiveSessionState",null,[]);class Xk{constructor(){this.sessionQRCode=this.participantUrl=null}}Object(c.a)(Xk,"ILiveSessionURL",null,[]);class pk{constructor(){this.Qgm=this.Pgm=null}}Object(c.a)(pk,"PollObjectInfo",null,[]);var cl;(function(Y){Y[Y.none=0]="none";Y[Y.singleLineRibbon=1]="singleLineRibbon";Y[Y.multipleLineRibbon=2]="multipleLineRibbon";Y[Y.slideShowToolbar=3]="slideShowToolbar";
Y[Y.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";Y[Y.welcomeScreenTryAgain=5]="welcomeScreenTryAgain"})(cl||(cl={}));Object(c.b)("LiveEntryPoint",cl);var ck;(function(Y){Y[Y.none=0]="none";Y[Y.callout=1]="callout";Y[Y.businessBar=2]="businessBar";Y[Y.pausedSessionTimeout=3]="pausedSessionTimeout";Y[Y.slideshowContextMenu=4]="slideshowContextMenu";Y[Y.accessControlChange=5]="accessControlChange";Y[Y.welcomeScreenTryAgain=6]="welcomeScreenTryAgain"})(ck||(ck={}));Object(c.b)("LiveExitPoint",
ck);var lj=a(1129);class gm{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg){this.xa=new Zb.a;this.yTc=this.D_e=this.dRh=this.pck=this.iem=!1;this.rvg=this.mck=this.fRh=!0;this.JNg=this.W0e=!1;this.Kz=this.Jw=this.R3b=this.JG=null;this.Knd=0;this.b0e=-1;this.C0e=30;this.BDg=-1;this.Sg=this.l8b=this.d8a=null;this.Dhm=this.Nim=this.qTh=this.oTh=0;this.sqg=this.imc=this.Ind=null;this.Hgk=this.xfe=0;this.dKe=null;this.Ynk=new Set;this.Xnk=new Map;this.dSh=null;this.EEg=1;this.ADg=this.t_e=this.yM=
this.PEa=this.Uok=this.obk=null;this.mf=oc;this.na=Y;this.mem=!1;this.Ad=Mb;this.rc=nd;this.Zr=Cd;this.ud=Zd;this.pT=we;this.pb=Qe;null===kf||void 0===kf?void 0:kf.execute(yh=>{this.xf=yh});this.Hv=Vf;this.rxb=eg;this.Na=zg;if(this.Xr=Sa)this.R3b=Sa.gN();this.Uwa=Oc;this.Knd=this.Y_l?1:0;this.na.Thb&&(this.obk=new Em(this.na));this.ud.eI(Object(h.a)(this,this.cxa,"onPodSessionRehydrated"));this.pT.Mxf(Object(h.a)(this,this.kqd,"onPodSessionUnavailable"));this.Gkd()&&this.Hv.execute(yh=>{yh.show(ResourceStrings.L_LivePresentations_Disconnected,
lj.a.$pd);yh.hide()});H.a.$(512496260,833,50,"LivePresenter: Host auth type is: "+this.na.hostAuthType)}get FO(){return this.na.Thb&&this.fRh}get xVd(){return this.pck}set xVd(Y){(this.pck=Y)&&this.xa.raiseEvent("OnLiveResourcesLoaded",Sys.EventArgs.Empty)}get kM(){return!!this.Kz}get oIb(){return this.mem}set oIb(Y){this.mem=Y}get Ukc(){return this.iem}set Ukc(Y){this.iem=Y}get cGc(){return!!this.Kz&&this.Kz.isPaused}get Dan(){return this.dRh}get fGc(){return this.rvg}set fGc(Y){this.rvg=Y}get van(){return this.xVd&&
this.FO&&!!this.JG}get accessControl(){return this.Knd}set accessControl(Y){this.Knd=Y}get Y_l(){return"true"===this.a4l("wdDisablePrivateSession")?!1:"aad"===this.na.hostAuthType}get V_l(){return this.FO&&this.kM&&this.Jw?this.Jw.isWelcomeScreenVisible():!1}kWe(){return this.na.I$d&&this.na.m6g&&this.xf.OUf?this.xf.nWe?this.JNg=!0:this.xf.b0l||this.JNg:!0}SVh(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we){if(this.FO){this.Ad.Cti(Object(h.a)(this,this.xnm,"onSlideShowEnterEndOfShow"));this.Ad.Mti(Object(h.a)(this,this.ynm,
"onSlideShowLeaveEndOfShow"));this.Ad.Dxf(Object(h.a)(this,this.nac,"onGetCurrentSlideDimensionsHandler"));this.D_e=!1;this.yTc=!0;try{this.na.v5g&&this.vdn();const Qe=this.$kj(Oc,oc);if(this.JG)(this.Ukc||this.cGc)&&this.JG.FetchDocumentDownloadURL(Qe);else{H.a.$(512496259,833,50,"Creating Broadcast monitor ...");const kf=new PowerPointLive.PPTBroadcastMonitorSettings;kf.isBlueChicken=this.na.isBlueChicken;kf.fileDownloadUrl=Qe;kf.rendezvousSvcBaseUri=this.na.qxe;kf.broadcastSubtitlesFromSpeechFrontDoor=
!0;kf.pragueInitTimeoutInMS=this.na.zqm;kf.preferredSubtitleLanguage=this.xf.y7f();kf.useStateService=this.na.Iqm;kf.numMaxAttempts=this.na.Cqm;kf.delayInSecsToCloseBroadcasterOnPause=this.na.tqm;kf.batchedRequestsEnabled=this.na.qqm;kf.sharedSessionSettings={};kf.websocketAliveTimeAfterLoseFocusInMs=this.na.Jqm;kf.pingTimeoutInMs=this.na.Aqm;kf.pongTimeoutInMs=this.na.Bqm;kf.enableTransientSessionHandling=this.na.Tqm;kf.maxStateServiceRoundtripRaw=n.AFrameworkApplication.ha.Ac("PPTLiveMaxStateServiceRoundtripRaw",
300);kf.sharedSessionSettings.MaxStateServiceRoundtripRaw=kf.maxStateServiceRoundtripRaw;kf.documentSnapshotRequestUrlGenerator=this.na.Qqm?()=>this.$kj(this.pb.podSessionId,this.pb.Hp):null;this.na.JHk&&(kf.sharedSessionSettings.IsAutomation=!0);this.JG=new PowerPointLive.PPTBroadcastMonitor(kf);this.JG.RegisterParticipantsCountChangeEventListener(Vf=>{this.Sg.telemetryData.maxParticipantCount=Math.max(this.Sg.telemetryData.maxParticipantCount,Vf);this.Jw&&this.Jw.setParticipantCount(Vf);this.xa.raiseEvent("ParticipantsCountChanged",
Sys.EventArgs.Empty)});this.JG.RegisterNewReactionEventListener(Object(h.a)(this,this.VOn,"newReactionHandler"));this.JG.RegisterConnectionStateEventListener(Object(h.a)(this,this.s2m,"connectionStateHandler"))}this.JG.SetCurrentPosition(Y,Sa-1,null);this.xfe=Y;this.Ukc&&!this.Kz&&we?(this.uph(n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.ex?1:2,Cd,Mb,Oc,Zd),this.G1m(Y),this.imc=new Set):this.d8a&&this.RXe();this.imc&&this.imc.add(Y)}catch(Qe){H.a.$(512496258,833,10,"LivePresenter: Exception at creating Broadcast monitor: {0}",
Qe.toString())}}}hko(){window.setTimeout(()=>{const Y=this.xfe===this.Hgk;this.FO&&this.kM&&Y&&this.Kz&&!this.Kz.isPaused&&(H.a.$(512496257,833,50,"LivePresenter::TriggerSurveyOnLastSlide Triggering live survey on last slide"),this.R1h(0),this.E7e(0))},6E4*this.na.Eqm)}pUn(){this.FO&&(this.Ad.bZk(Object(h.a)(this,this.xnm,"onSlideShowEnterEndOfShow")),this.Ad.iZk(Object(h.a)(this,this.ynm,"onSlideShowLeaveEndOfShow")),this.Ad.lch(Object(h.a)(this,this.nac,"onGetCurrentSlideDimensionsHandler")),this.yTc=
this.D_e=!1,this.kM&&this.Jw&&(this.Jw.hideAll(),this.YXj()||(this.DWn(),this.Leo()),this.Gkd()&&this.Hv.instance.hide()))}Ggo(Y,Sa,Mb,oc,Oc,nd){try{const Cd=new PowerPointLive.RendezvousSessionConfig;Cd.userSessionId=Y;Cd.webServiceBase=Sa;Cd.podSessionId=Mb;Cd.docId=oc;Cd.sessionId=Oc;Cd.accessControl=1===this.Knd?"organization":"anyone";Cd.authTokenFunc=nd;Cd.locale=n.AFrameworkApplication.uiCulture;Cd.presentationName=Eb.a.aca(n.AFrameworkApplication.fileName);Cd.slideHeight=this.rc.qC().height;
Cd.slideWidth=this.rc.qC().width;Cd.correlationId=this.Sg.telemetryData.correlationId;Cd.showQRCodeAfterFetchingDocDownloadUrl=this.na.$qm;Cd.presenterTenantId=!this.na.isBlueChicken&&this.na.TJk?n.AFrameworkApplication.ha.Ma("TenantId"):null;Cd.fileSource=n.AFrameworkApplication.ha.Ma("FileHost");this.na.Gqm||(Cd.fileName=n.AFrameworkApplication.fileName,Cd.bootstrapperUrl=this.na.i3e);const Zd=this.JG.StartLiveBroadcasting(Cd,this.Sg,!this.na.bXh);this.bvn();if(Zd){this.Kz=new sm;this.Kz.isPrivate=
1===this.Knd;this.Kz.isPaused=!1;this.Kz.participantsCount=0;this.Kz.sessionCurrentState=0;const we=Zd.then(Qe=>{const kf=new Xk;kf.participantUrl=Qe.sessionInfo.shortParticipantUrl;kf.sessionQRCode=Qe.sessionInfo.sessionQRCode;this.Kz.sessionCurrentState=1;return kf});this.Kz.sessionURLPromise=we;this.na.n6g?this.ADg.then(()=>{this.Jw.actOnSessionRequested(this.Kz)}):this.Jw.actOnSessionRequested(this.Kz);this.Ad.NFh(Object(h.a)(this,this.znm,"onSlideShowReady"));this.Ad.nQl(Object(h.a)(this,this.Vnm,
"onTranscriberStarted"));this.Ad.Qti(Object(h.a)(this,this.Omm,"onPodSessionExpired"));Zd.then(Qe=>{this.Sg.telemetryData.pragueDocId=Qe.sessionInfo.pragueDocId;this.Sg.telemetryData.sessionCreationWebServiceCallTimeInMS=this.xfa()-this.qTh;this.Sg.telemetryData.startAttemptCount=Qe.numAttempt;H.a.$(512496256,833,50,"SessionId: {0}, Message: StartLiveBroadcasting succeeded!, TimeElapsed: {1}",this.Sg.telemetryData.sessionId,this.Sg.telemetryData.sessionCreationWebServiceCallTimeInMS.toString());this.na.bXh?
(this.Yih(),this.JG.InitializeStateService().then(()=>{this.Zym(Qe);this.P7a("StartLiveBroadcasting")}).catch(kf=>{this.Sg.telemetryData.sessionEndedBeforePragueInitialized||this.Sg.telemetryData.sessionId!==Oc||(H.a.$(512496227,833,10,"SessionId: {0}, Message: failed to connect state service due to error!, Details: {1}",this.Sg.telemetryData.sessionId,kf?kf.toString():""),this.Sg.telemetryData.SetErrorCode(2,kf?kf.toString():""),this.P7a("StartLiveBroadcasting"),this.P_h())})):this.Zym(Qe);this.na.Sqm&&
$addHandler(window,"visibilitychange",Object(h.a)(this,this.bTn,"onPageVisibilityChangedHandler"));this.P7a("StartLiveBroadcasting")}).catch(Qe=>{H.a.$(512496226,833,10,"SessionId: {0}, Message: StartLiveBroadcasting failed due to error!, Details: {1}",this.Sg.telemetryData.sessionId,Qe.toString());this.Sg.telemetryData.SetErrorCode(4,Qe.toString());this.P7a("StartLiveBroadcasting");this.P_h()})}else this.P_h(),this.Sg.telemetryData.SetErrorCode(4,"Failed to create Promise object!"),H.a.$(512496225,
833,10,"StartLiveBroadcasting failed to create Promise object!")}catch(Cd){this.P_h(),this.Sg.telemetryData.SetErrorCode(4,Cd.toString()),H.a.$(512496224,833,10,"SessionId: {0}, Message: Exception when staring a new Live session, Details: {1}",this.Sg.telemetryData.sessionId,Cd.toString())}finally{this.P7a("StartLiveBroadcasting")}}Zym(Y){const Sa=this.xf.afn(this.xf.Fib);Sa?this.JG.SetDefaultSubtitlesLanguage(Sa):H.a.$(512496223,833,10,"SessionId: {0}, Message: Failed to set default subtitle language.",
this.Sg.telemetryData.sessionId);this.Ad.u7e(!0,this.JG.GetPragueSessionInfoJSONString());this.Ad.Pjc(Object(h.a)(this,this.Y0g,"onSlideShowPositionChanged"));this.Ad.mQl(Object(h.a)(this,this.Fnm,"onSubtitleUpdated"));this.na.bXh&&!this.Jw.isWelcomeScreenVisible()||this.Yih();this.xa.raiseEvent("OnLiveSessionStarted",Y.sessionInfo);this.kWe()||!this.xf.OUf||this.xf.b0l||this.JNg||!this.Gkd()||(this.W0e=!0,this.Hv.instance.show(ResourceStrings.l_LivePresentation_UnsupportedSpeechToast.replace("{0}",
xi.a.Le(n.AFrameworkApplication.uiCulture).displayName),lj.a.$pd));this.sqg=this.JG.CreateSurvey(Y.authToken,null,null,null);this.sqg.then(Mb=>{if(Mb){const oc={};oc.surveyeeName=n.AFrameworkApplication.userName;oc.surveyId=Mb.surveyId;oc.surveyResponseUrl=Mb.surveyResponseUrl;this.JG.SetAudienceFeedbackInfo(JSON.stringify(oc))}});this.na.v5g&&(this.Xnk.clear(),this.Ynk.forEach(Mb=>{try{const oc=Mb.Pgm;this.JG.CreateSurvey(Y.authToken,null,oc,Mb.Qgm).then(Oc=>{Oc?this.Xnk.set(oc,Oc.surveyId):H.a.$(512496222,
833,10,"SessionId: {0}, Message: Duplicated poll info is not valid!",this.Sg.telemetryData.sessionId)}).catch(Oc=>{H.a.$(512496221,833,10,"SessionId: {0}, Message: Failed to duplicate poll as DuplicateSurvey request failed due to error!, Details: {1}",this.Sg.telemetryData.sessionId,Oc.toString());this.Sg.telemetryData.SetErrorCode(13,Y.toString())})}catch(oc){H.a.$(512496220,833,10,"SessionId: {0}, Message: Exception when duplicating, Details: {1}",this.Sg.telemetryData.sessionId,oc.toString())}}));
this.rxb.init()?this.rxb.tTe(Object(h.a)(this,this.iqd,"onNetworkConnectivityChanged")):H.a.$(512496219,833,10,"SessionId: {0}, Message: NetworkConnectivityProvider init failed.",this.Sg.telemetryData.sessionId)}a4l(Y){Y=new RegExp(String.format("[\\?&]{0}=([^&#]*)",Y));return(Y=window.location.search.match(Y))&&2===Y.length?Y[1]:""}uph(Y,Sa,Mb,oc,Oc){this.Uok=Sa;this.PEa=Mb;this.yM=oc;this.t_e=Oc;this.qTh=this.xfa();this.oTh=this.xfa();var nd=this.a4l("wdSetLiveSessionId");nd="rdvSession_"+(nd.length?
nd:Yb.a.create().toString());this.Sg=new PowerPointLive.LiveSessionTelemetry;this.Sg.telemetryData.sessionId=nd;this.Sg.telemetryData.sessionStartUtc=(new Date).format("yyyy-MM-ddTHH:mm:ss.fffffff");this.Sg.telemetryData.accessControl=am[this.Knd];this.Sg.telemetryData.sessionEntryPoint=cl[Y];this.Sg.telemetryData.isSubtitleStartedByLive=this.oIb;this.Sg.telemetryData.isAutomation=this.na.JHk;this.Sg.telemetryData.correlationId=Yb.a.create().toString();this.P7a("StartLiveBroadcasting");try{this.FO&&
this.JG&&this.hTf()&&!this.Kz?(this.fBn(),this.Ad.Cxf(Object(h.a)(this,this.Nlm,"onGetCurrentSlideShowPosition")),this.Ad.getCurrentPosition(),this.A6i()&&this.Jw&&this.ADg&&this.ADg.then(()=>{this.Jw.showOnboardingScreen();this.HEl=!0}),this.Ggo(Sa,Mb,oc,Oc,nd,()=>this.nZf("StartLiveBroadcasting",this.Sg.telemetryData.sessionId))):(this.Sg.telemetryData.SetErrorCode(4,"Live actor or broadcast monitor is null while trying to start live session!"),H.a.$(512496218,833,10,"StartLiveBroadcasting: Live actor or broadcast monitor is null while trying to start live session!")),
this.Sg.telemetryData.isMordernSlideShow=!!this.Ad&&this.Ad instanceof ol.a}catch(Cd){this.Sg.telemetryData.SetErrorCode(4,Cd.toString()),H.a.$(512496217,833,10,"SessionId: {0}, Message: Exception when starting Live session, Details: {1}",this.Sg.telemetryData.sessionId,Cd.toString())}finally{this.P7a("StartLiveBroadcasting")}}DWn(){if(this.FO&&this.kM&&this.JG&&this.hTf()&&!this.Kz.isPaused){this.R1h(2);this.E7e(2);try{this.Sg.telemetryData.sessionPauseCount+=1,this.Sg.telemetryData.sessionActiveDurationInMS+=
this.xfa()-this.oTh,H.a.$(512496216,833,50,"SessionId: {0}, Message: Pause live broadcasting ...",this.Sg.telemetryData.sessionId),this.Jw.actOnSessionPaused(),this.Kz.isPaused=!0,this.Dhm=this.xfa(),this.JG.PauseLiveBroadcasting(()=>this.nZf("PauseLiveBroadcasting",this.Sg.telemetryData.sessionId)),this.xa.raiseEvent("OnLiveSessionPaused",Sys.EventArgs.Empty),this.Kgo(),this.Ad.u7e(!1)}catch(Y){this.Sg.telemetryData.SetErrorCode(5,Y.toString()),H.a.$(512496215,833,10,"SessionId: {0}, Message: Exception when pausing Live session, Details: {1}",
this.Sg.telemetryData.sessionId,Y.toString())}finally{this.P7a("PauseLiveBroadcasting")}}}Kvm(){if(this.FO&&this.kM&&this.JG&&this.hTf()&&this.Kz.isPaused)try{this.oTh=this.xfa(),this.Sg.telemetryData.sessionResumeCount+=1,H.a.$(512496214,833,50,"SessionId: {0}, Message: Resume live broadcasting ...",this.Sg.telemetryData.sessionId),this.wvm(),this.Jw.actOnSessionResumed(),this.JG.ResumeLiveBroadcasting(()=>this.nZf("ResumeLiveBroadcasting",this.Sg.telemetryData.sessionId)),this.Kz.isPaused=!1,this.xa.raiseEvent("OnLiveSessionResumed",
Sys.EventArgs.Empty),this.Onl(),this.Ad.u7e(!0,this.JG.GetPragueSessionInfoJSONString())}catch(Y){this.Sg.telemetryData.SetErrorCode(6,Y.toString()),H.a.$(512496213,833,10,"SessionId: {0}, Message: Exception when resuming Live session, Details: {1}",this.Sg.telemetryData.sessionId,Y.toString())}finally{this.P7a("ResumeLiveBroadcasting")}}ASf(Y){if(this.FO&&this.kM&&this.JG&&this.hTf()){this.E7e(3);try{this.Xjo(Y,()=>{this.Sg.telemetryData.sessionExitPoint=ck[Y];this.Kz.isPaused||(this.Sg.telemetryData.sessionActiveDurationInMS+=
this.xfa()-this.oTh);this.d8a&&this.RXe();this.Onl();this.Gkd()&&this.Hv.instance.hide();H.a.$(512496212,833,50,"SessionId: {0}, Message: End live broadcasting ...",this.Sg.telemetryData.sessionId);this.Jw.actOnSessionEnded();this.Ad.pYh(Object(h.a)(this,this.znm,"onSlideShowReady"));this.Ad.F7c(Object(h.a)(this,this.Y0g,"onSlideShowPositionChanged"));this.Ad.vum(Object(h.a)(this,this.Fnm,"onSubtitleUpdated"));this.Ad.wum(Object(h.a)(this,this.Vnm,"onTranscriberStarted"));this.rxb.mYh(Object(h.a)(this,
this.iqd,"onNetworkConnectivityChanged"));this.Ad.kZk(Object(h.a)(this,this.Omm,"onPodSessionExpired"));this.yTc&&this.Ad.u7e(!1);this.sqg=this.Kz=null;this.xa.raiseEvent("OnLiveSessionEnded",Sys.EventArgs.Empty);this.na.m6g&&this.xf.OUf&&(this.JNg=this.W0e=!1);if(3!==Y){const Sa=this.JG.EndLiveBroadcasting(()=>this.nZf("EndLiveBroadcasting",this.Sg.telemetryData.sessionId));Sa?Sa.then(()=>{this.P7a("EndLiveBroadcasting");H.a.$(512496211,833,50,"SessionId: {0}, Message: EndLiveBroadcasting web service call succeeded!",
this.Sg.telemetryData.sessionId)}).catch(Mb=>{this.Sg.telemetryData.SetErrorCode(7,Mb.toString());this.P7a("EndLiveBroadcasting");H.a.$(512496210,833,10,"SessionId: {0}, Message: EndLiveBroadcasting web service call failed due to error!, Details: {1}",this.Sg.telemetryData.sessionId,Mb.toString())}):(this.Sg.telemetryData.SetErrorCode(7,"EndLiveBroadcasting failed to created Promise object!"),H.a.$(512496209,833,10,"SessionId: {0}, Message: EndLiveBroadcasting failed to created Promise object!"))}else this.JG.CleanUpBroadcastBeforeEnd(),
H.a.$(512496208,833,50,"SessionId: {0}, Message: Skipping EndLiveBroadcasting web service call");this.P7a("EndLiveBroadcasting")})}catch(Sa){this.Sg.telemetryData.SetErrorCode(7),H.a.$(512496207,833,10,"SessionId: {0}, Message: Exception when ending live session!, Details: {1}",this.Sg.telemetryData.sessionId,Sa.toString())}finally{3!==Y&&this.OFb(),this.P7a("EndLiveBroadcasting")}}}tym(){this.FO&&this.JG&&this.JG.SetPresenterState("muted")}uym(){this.FO&&this.JG&&this.JG.SetPresenterState("unmuted")}showCallout(Y){this.FO&&
this.Jw&&(this.dRh=!0,this.Jw.showCallout(Y))}showWelcomeScreen(){this.FO&&this.Jw&&(this.Jw.showWelcomeScreen(),this.Eal())}showEndSessionDialog(Y,Sa){this.FO&&this.kM&&this.Jw&&this.Jw.showEndSessionDialogWithCallbacks(Y,Sa)}P_h(){this.Jw.isWelcomeScreenVisible()||this.Kz.isPaused||this.showWelcomeScreen();this.Kz=null;this.Jw.onSessionRequestError()}hTf(){if(this.FO&&!this.Jw&&this.R3b){const Y=new Fm;Y.hostElement=this.R3b;Y.baseZIndex=50005;Y.welcomeScreenBackgroundImageUrl=this.mf.Eq("LiveWelcomeScreenBackground.png");
Y.welcomeScreenErrorImageUrl=this.mf.Eq("LiveWelcomeScreenError.png");Y.welcomeScreenLayerHostId="LiveWelcomeScreenLayerHost";Y.calloutContainerId="LiveCalloutContainer";Y.urlBarLayerHostId="LiveURLBarLayerHost";Y.dialogLayerHostId="LiveDialogLayerHost";Y.reactionsBarLayerHostId="LiveReactionBarLayerHost";Y.showTryAgainButton=!0;Y.isPowerpointLiveReactionEnabled=!fb.a("PPTLive.ReactionToggleInLiveCallout");Y.onboardingScreenHostId="LiveOnboardingScreenLayerHost";Y.resourceCDNPath=this.na.krd;Y.enablePrefetchLiveResource=
this.na.n6g;Y.enableNewLiveWelcomeScreen=this.na.n6g;Y.userSessionId=this.Uok;Y.podsUrl=this.PEa;this.Jw=liveActor.LiveActorFactory.CREATE_LIVE_ACTOR(Y);this.Jw.on("OnWelcomeScreenOpenedAction",()=>{this.r$c("LiveWelcomeScreenLayerHost");this.Eal();this.Nim=Date.now();this.Sg.telemetryData.welcomeShownCount+=1});this.Jw.on("OnWelcomeScreenClosedAction",()=>{this.D_e&&this.Jw.hideURLBar();this.pUl();this.Ad.hga();this.Sg.telemetryData.welcomeScreenDurations.push(Date.now()-this.Nim);this.Sg.telemetryData.welcomeScreenFirstTimeDuration=
this.Sg.telemetryData.welcomeScreenDurations[0];this.P7a("OnWelcomeScreenClosedAction");this.JG.SetWelcomeScreenState(!1);this.na.v5g&&this.$Cm();this.W0e&&this.Gkd()&&window.setTimeout(()=>{this.Hv.instance.hide();this.W0e=!1},5E3)});this.Jw.on("ResumeSessionAction",()=>{this.Kvm();this.D_e||this.Jw.showURLBar()});this.Jw.on("EndSessionAction",()=>{this.ASf(this.yTc?1:2);this.Ad.hga()});this.Jw.on("OnCalloutOpenedAction",()=>{this.dRh=!0;this.xa.raiseEvent("OnCalloutOpened",Sys.EventArgs.Empty);
this.Sg.telemetryData.calloutShownCount+=1});this.Jw.on("OnCalloutClosedAction",()=>{this.dRh=!1;this.xa.raiseEvent("OnCalloutDismissed",Sys.EventArgs.Empty);this.Ad.hga()});this.Jw.on("OnEndSessionDialogOpenedAction",()=>{this.Eao()});this.Jw.on("OnEndSessionDialogClosedAction",()=>{this.q8n()});this.Jw.on("OnCalloutMenuDefinitionChangedAction",()=>{this.xa.raiseEvent("CalloutMenuDefinitionChanged",Sys.EventArgs.Empty)});this.Jw.on("OnTryAgainAction",()=>{H.a.$(512496206,833,15,"SessionId: {0}, Message: OnTryAgainAction called.",
this.Sg.telemetryData.sessionId);this.uph(5,this.Uok,this.PEa,this.yM,this.t_e)});this.Jw.on("PresenterDisabledReactions",()=>{this.mck=!1});this.Jw.on("PresenterEnabledReactions",()=>{this.mck=!0});this.Jw.on("OnOnboardingScreenOpenedAction",()=>{this.r$c("LiveOnboardingScreenLayerHost");this.Eal()});this.Jw.on("OnOnboardingScreenClosedAction",()=>{this.Yih()})}return!!this.Jw}Yih(){this.Jw&&(this.A6i()&&this.Jw.isOnboardingScreenVisible()?this.r$c("LiveOnboardingScreenLayerHost"):this.Jw.isWelcomeScreenVisible()?
this.r$c("LiveWelcomeScreenLayerHost"):(-1!==this.BDg&&this.pUl(),this.Ad.hga()))}gxn(){const Y=document.getElementById("LiveWelcomeScreenLayerHost"),Sa=document.getElementById("LiveOnboardingScreenLayerHost");let Mb=!1;Y&&(Mb=Y.contains(document.activeElement));return document.activeElement===Sa||document.activeElement===Y||Mb}Eal(){this.Jw&&-1===this.BDg&&(this.BDg=window.setInterval(()=>{this.gxn()||this.Yih()},500))}pUl(){window.clearInterval(this.BDg);this.BDg=-1}r$c(Y){this.R3b&&this.Jw&&window.setTimeout(()=>
{Cb.FocusManager.vz(this.R3b.ownerDocument.getElementById(Y))},50)}Eao(){this.yTc?this.r$c("LiveDialogLayerHost"):(this.Na.lYe(fc.a.aXh,fc.a.Wl,document.getElementById("LiveDialogLayerHost"),!0),this.Na.Gm(fc.a.aXh,!0))}q8n(){this.yTc?this.Ad.hga():this.Na.Gm(fc.a.aXh,!1)}d6l(){this.na.m6g&&this.xf.OUf&&(this.Gkd()&&this.W0e&&(this.Hv.instance.hide(),this.W0e=!1),this.JNg=!0)}fBn(){try{this.ADg||!this.A6i()&&!this.na.n6g||(this.ADg=mk.a(vb.a.instance)("liveActorLazy"))}catch(Y){H.a.$(512496205,833,
10,"SessionId: {0}, Message: Exception when loading the liveActorLazy, Details: {1}",this.Sg.telemetryData.sessionId,Y.toString())}}znm(){this.FO&&this.JG&&(this.cGc?(window.setTimeout(()=>{this.xa.raiseEvent("OnRelaunchPausedSession",Sys.EventArgs.Empty)},500),this.Kvm()):this.Kz&&this.Jw&&this.Jw.isWelcomeScreenVisible()&&this.Yih())}Y0g(Y,Sa){this.FO&&this.JG&&(this.JG.SetCurrentPosition(Sa.slideId,Sa.slideIndex,Sa.ztd),this.xfe!==Sa.slideId&&this.wvm(),this.xfe=Sa.slideId,this.imc&&(this.Ind&&
10>this.EEg&&10*this.imc.size>=this.EEg*this.Ind.size&&(this.E7e(4),this.EEg+=1),this.imc.add(Sa.slideId)),this.na.v5g&&this.$Cm(),Y=!!this.Ind&&this.Ind.size>=this.na.Dqm,this.xfe===this.Hgk&&Y&&this.hko())}xnm(){this.D_e=!0;this.FO&&this.kM&&this.Jw&&(this.Jw.hideURLBar(),this.R1h(1),this.E7e(1))}ynm(){this.D_e=!1;this.FO&&this.kM&&this.Jw&&this.Jw.showURLBar()}Fnm(Y,Sa){this.FO&&this.kM&&this.JG&&(Sa.isFinal?this.JG.UpdateFinalSubtitles(Sa.wjo):this.JG.UpdatePartialSubtitles(Sa.wjo))}Vnm(Y,Sa){this.Sg.telemetryData.transcriberSessionIds+=
Sa.C1h+",";this.FO&&this.kM&&this.Ad.u7e(!0,this.JG.GetPragueSessionInfoJSONString())}Kgo(){H.a.$(512496204,833,50,"SessionId: {0}, StartPausedSessionAutoExpireTimer.",this.Sg.telemetryData.sessionId);-1!==this.b0e&&window.clearInterval(this.b0e);this.C0e=30;this.b0e=window.setInterval(Object(h.a)(this,this.GWn,"pausedSessionAutoExpireTimerCallBack"),6E4)}Onl(){-1!==this.b0e&&(H.a.$(512496203,833,50,"SessionId: {0}, StopPausedSessionAutoExpireTimer.",this.Sg.telemetryData.sessionId),window.clearInterval(this.b0e),
this.b0e=-1)}GWn(){--this.C0e;0>=this.C0e?(H.a.$(512496202,833,50,"SessionId: {0}, Ending long paused session.",this.Sg.telemetryData.sessionId),this.RXe(),this.ASf(3)):this.d8a&&(this.d8a.message=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.C0e.toString()))}Leo(){if(!this.d8a&&this.Xr&&!n.AFrameworkApplication.Ch&&0!==this.Kz.sessionCurrentState){var Y=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.C0e.toString());Y=new bk.a(ResourceStrings.l_LiveBusinessBarTitle_PausedSession,
Y,null);Y.closeable=!0;Y.fU=Object(h.a)(this,this.sQn,"onBusinessBarClosed");Y.image=3;Y.addButton(ResourceStrings.l_LiveBusinessBarButton_ResumeSession,Object(h.a)(this,this.uQn,"onBusinessBarResumeSessionButtonClicked"),"");Y.qTe(ResourceStrings.l_LiveBusinessBarButton_EndSession,Object(h.a)(this,this.tQn,"onBusinessBarEndSessionButtonClicked"),"");this.Xr.businessBar.mi(Y,!1);this.Xr.ft();this.d8a=Y}}YXj(){var Y=6E4*this.na.Xqm;Y=0<Y?this.xfa()-this.qTh>=Y:!1;H.a.$(512496201,833,50,"LivePresenter::IsSessionStale {0}",
Y);return Y}RXe(){try{this.Xr&&this.d8a?(this.Onl(),this.Xr.businessBar.removeEntry(this.d8a),this.Xr.ft(),H.a.$(512496200,833,50,"LivePresenter::HideLiveSessionBusinessBar WasSuccessful: {0}",!this.d8a.businessBar),this.d8a=null):H.a.$(512496199,833,15,"LivePresenter::HideLiveSessionBusinessBar failed: conditions: {0}, {1}",!!this.Xr,!!this.d8a)}catch(Y){H.a.$(512496198,833,15,"LivePresenter::HideLiveSessionBusinessBar threw an exception of {0}",Y.toString())}}sQn(Y){Y===this.d8a&&(this.d8a=null)}uQn(Y){Y===
this.d8a&&this.Jw&&(this.RXe(),this.YXj()||n.AFrameworkApplication.ub.Eb(tb.a.GZa,2))}tQn(Y){Y===this.d8a&&this.Jw&&(this.YXj()?this.RXe():this.Jw.showEndSessionDialog())}bTn(){const Y=this.xfa(),Sa=window.document.hidden;H.a.$(512496197,833,50,"LivePresenter::OnPageVisibilityChangedHandler page {0} at {1}",Sa?"hidden":"visible",Y);Sa||this.cGc&&18E5<=Y-this.Dhm&&this.RXe()}jdj(Y,Sa,Mb){return!this.na.Thb||0===this.Knd&&this.na.isBlueChicken?new Promise(oc=>{oc(null)}):!Mb&&!this.Uwa||Mb&&!this.obk?
(H.a.$(512496196,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, isDirectAuth: {2}, Auth manager or helper is null",Y,Sa,Mb),new Promise((oc,Oc)=>{Oc("AuthHelperNotSet")})):new Promise((oc,Oc)=>{const nd=this.na.hostAuthType;let Cd="";if("aad"===nd||this.na.isBlueChicken)Cd=this.na.s3e;else if("msa"===nd)Cd=this.na.Wqm;else{H.a.$(512496195,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, hostAuthType is not aad or msa",Y,Sa);Oc("HostAuthTypeInvalid");return}const Zd=
"true"===n.AFrameworkApplication.ha.Ma("IsAnonymousUser").toLowerCase();let we=n.AFrameworkApplication.ha.Ma(n.AFrameworkApplication.DF);Eb.a.wb(we)&&(we="Unset");const Qe=new Date;let kf=null;kf=Mb?this.obk.sko(this.na.sqm,this.na.rqm,Cd,n.AFrameworkApplication.ha.Ma("UserPrincipalName"),this.na.Fqm,this.na.vqm&&"StartLiveBroadcasting"===Y&&!this.na.TJk):this.Uwa.hP(this.na.r3e,Cd);kf.then(Vf=>{this.wbm(Sa,Y,nd,Mb,Zd,we,Vf.IsSuccess,+new Date-+Qe,Vf.ErrorCode,Vf.ErrorMessage);Vf.IsSuccess?oc(Vf.Token):
Oc(Vf.ErrorCode)}).catch(Vf=>{this.wbm(Sa,Y,nd,Mb,Zd,we,!1,+new Date-+Qe,"exception",Vf.toString());Oc("exception")})})}nZf(Y,Sa){if(!this.na.Thb||0===this.Knd&&this.na.isBlueChicken)return new Promise(oc=>{oc(null)});H.a.$(508384139,833,50,"LivePresenter::GetToken with user credentials for type: {0}",this.na.hostAuthType);const Mb=this;return new Promise((oc,Oc)=>{const nd=this.na.getBooleanAppSetting("PowerpointLiveBroadcastEnableDirectAuthFallback");Mb.jdj(Y,Sa,!1).then(Cd=>{H.a.$(508384138,833,
50,"LivePresenter::GetToken succeeded with OAuth");oc(Cd)}).catch(Cd=>{H.a.$(508384137,833,50,"LivePresenter::GetToken - failed OAUth token retrieval: {0}",Cd.toString());Mb.jdj(Y,Sa,!1).then(Zd=>{H.a.$(508384136,833,50,"LivePresenter::GetToken - Retry with OAuth succeeded");oc(Zd)}).catch(Zd=>{H.a.$(508384135,833,50,"LivePresenter::GetToken - failed OAUth token retrieval Retry: {0}",Zd.toString());nd?Mb.jdj(Y,Sa,!0).then(we=>{H.a.$(508621791,833,50,"LivePresenter::GetToken - Retry with Direct Auth succeeded");
oc(we)}).catch(we=>{H.a.$(508384134,833,50,"LivePresenter::GetToken - Direct auth Re-Retry Failed with error:{1}",we.toString());Oc(we)}):(H.a.$(508384133,833,50,"LivePresenter::GetToken - Request Failed with error:{1}",Zd.toString()),Oc(Zd))})})})}xfa(){return(new Date).getTime()}wbm(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe){const kf={};kf.SessionId=Y;kf.Action=Sa;kf.HostAuthType=Mb;kf.UseDirectAuth=oc;kf.IsAnonymousUser=Oc;kf.UiHost=nd;kf.IsSuccess=Cd;kf.Latency=Zd;kf.ErrorCode=we;kf.ErrorMessage=Qe;H.a.$(51197915,
833,50,JSON.stringify(kf))}P7a(Y){this.Sg.telemetryData.action=Y;this.Sg.telemetryData.sessionDurationInMS=this.xfa()-this.qTh;this.Sg.telemetryData.hostAuthType=this.na.hostAuthType;this.Sg.SetStateServiceMetrics();this.Sg.telemetryData.errorCode.length&&(!this.Sg.telemetryData.errorMessage.length||0>Array.indexOf(this.na.yqm,this.Sg.telemetryData.errorMessage))&&(this.Sg.telemetryData.hasUnexpectedError=!0);Y=this.na.qxe.toLowerCase();-1!==Y.indexOf("pptservicescast.officeapps.live.com")?this.Sg.telemetryData.rendezvousServiceEnvironment=
"prod":-1!==Y.indexOf("pptservicescast.edog.officeapps.live.com")?this.Sg.telemetryData.rendezvousServiceEnvironment="edog":-1!==Y.indexOf("pptservicescast.officeapps.live-int.com")?this.Sg.telemetryData.rendezvousServiceEnvironment="int":this.Sg.telemetryData.rendezvousServiceEnvironment="dev";H.a.$(50706442,833,this.Sg.telemetryData.hasUnexpectedError?15:50,JSON.stringify(this.Sg.telemetryData))}G1m(Y){if(this.rc)try{var Sa=this.Zr.presentation;if(!Sa)throw Error.argumentNull("Presentation is null");
const Mb=Sa.slides||[];this.Hgk=Mb[Mb.length-1].sid;let oc=Sa=!1;this.Ind=new Set;for(const Oc of Mb)Sa||Oc.sid!==Y||(Sa=!0,oc=Oc.Kl),!Sa||Oc.Kl&&!oc||this.Ind.add(Oc.sid),oc&&!Oc.Kl&&(oc=!1)}catch(Mb){this.Sg.telemetryData.SetErrorCode(16,Mb.toString()),H.a.$(512496193,833,10,"SessionId: {0}, Message: Exception when collecting slide show info for triggering audience feedback!, Details: {1}",this.Sg.telemetryData.sessionId,Mb.toString())}}R1h(Y){return new Promise(Sa=>{if(this.FO&&this.JG&&this.Kz&&
this.sqg)try{this.sqg.then(Mb=>{let oc=!1;switch(Y){case 2:if(!this.imc||!this.Ind||10*this.imc.size<8*this.Ind.size){Sa(!0);return}break;case 3:oc=!0}const Oc={triggeredSurveyType:"Survey.AudienceFeedback"};Oc.isMandatory=oc;Oc.triggerEventId=Yb.a.create().toString();Oc.surveyeeName=n.AFrameworkApplication.userName;Mb?(Oc.surveyId=Mb.surveyId,Oc.surveyResponseUrl=Mb.surveyResponseUrl):H.a.$(512496192,833,10,"SessionId: {0}, Message: Audience feedback survey info is not valid!",this.Sg.telemetryData.sessionId);
this.JG.TriggerSurvey(JSON.stringify(Oc));H.a.$(512496163,833,50,"SessionId: {0}, Message: Triggering audience feedback!, Details: {1}",this.Sg.telemetryData.sessionId,Y);Sa(!0)}).catch(Mb=>{H.a.$(512496162,833,10,"SessionId: {0}, Message: Failed to trigger audience feedback as CreateSurvey request failed due to error!, Details: {1}",this.Sg.telemetryData.sessionId,Mb.toString());this.Sg.telemetryData.SetErrorCode(13,Mb.toString());Sa(!1)})}catch(Mb){this.Sg.telemetryData.SetErrorCode(17,Mb.toString()),
H.a.$(512496161,833,10,"SessionId: {0}, Message: Exception when collecting show info for triggering audience feedback!, Details: {1}",this.Sg.telemetryData.sessionId,Mb.toString()),Sa(!1)}else Sa(!0)})}Nlm(Y,Sa){this.Ad&&this.JG&&Sa&&(this.Ad.WDe(Object(h.a)(this,this.Nlm,"onGetCurrentSlideShowPosition")),this.JG.SetCurrentPosition(Sa.slideId,Sa.slideIndex,Sa.ztd))}nac(Y,Sa){this.Jw&&this.Jw.actOnCurrentSlideDimensionChange(Sa.slideHeight,Sa.yll,Sa.slideWidth,Sa.Jll)}getCalloutMenuDefinition(){return this.hTf()?
this.Jw.getCalloutMenuDefinition():null}bvn(){const Y=String.format("{0}{1}",this.na.krd,"reactions/heart/default/240_anim_f/heart.png"),Sa=String.format("{0}{1}",this.na.krd,"reactions/yes/default/240_anim_f/yes.png"),Mb=String.format("{0}{1}",this.na.krd,"reactions/clap/default/240_anim_f/clap.png"),oc=String.format("{0}{1}",this.na.krd,"reactions/laugh/default/240_anim_f/laugh.png"),Oc=String.format("{0}{1}",this.na.krd,"reactions/surprised/default/240_anim_f/surprised.png"),nd=String.format("{0}{1}",
this.na.krd,"reactions/wonder/default/240_anim_f/wonder.png");this.l8b=[Object.assign(new nm,{react:"yes",reactionCount:0,reactionImagePath:Sa,numberOfAnimationFrames:40}),Object.assign(new nm,{react:"heart",reactionCount:0,reactionImagePath:Y,numberOfAnimationFrames:16}),Object.assign(new nm,{react:"clap",reactionCount:0,reactionImagePath:Mb,numberOfAnimationFrames:40}),Object.assign(new nm,{react:"laugh",reactionCount:0,reactionImagePath:oc,numberOfAnimationFrames:77}),Object.assign(new nm,{react:"surprised",
reactionCount:0,reactionImagePath:Oc,numberOfAnimationFrames:68}),Object.assign(new nm,{react:"wonder",reactionCount:0,reactionImagePath:nd,numberOfAnimationFrames:70})];this.dKe=new Map;this.EEg=1;this.dSh=null}wvm(){if(this.l8b){for(const Y of this.l8b)Y.reactionCount=0;this.Jw&&this.Jw.resetReactions()}}VOn(Y){if(this.dKe){var Sa=this.dKe.has(Y.slideId)?this.dKe.get(Y.slideId)+1:1;this.dKe.set(Y.slideId,Sa)}if(this.l8b&&!this.cGc&&this.mck){for(const Mb of this.l8b)if(Mb.react===Y.react){Mb.reactionCount+=
1;break}if(this.Jw){Y=Array(this.l8b.length);for(Sa=0;Sa<this.l8b.length;Sa++)Y[Sa]=Object.assign(new nm,{react:this.l8b[Sa].react,reactionCount:this.l8b[Sa].reactionCount,reactionImagePath:this.l8b[Sa].reactionImagePath,numberOfAnimationFrames:this.l8b[Sa].numberOfAnimationFrames});this.Jw.setReactions(Y)}}}E7e(Y){return new Promise(Sa=>{if(this.FO&&this.JG&&this.Kz)try{if(1>this.dKe.size)H.a.$(512496160,833,50,"SessionId: {0}, Message: No reactions, skip save thumbnails request, Reason: {1}",this.Sg.telemetryData.sessionId,
Y),Sa(!0);else if(2===Y&&(!this.imc||1>this.imc.size))H.a.$(512496159,833,50,"SessionId: {0}, Message: No slide presented, skip save thumbnails request, Reason: {1}",this.Sg.telemetryData.sessionId,Y),Sa(!0);else{var Mb=null,oc=0;this.dKe.forEach((nd,Cd)=>{nd>oc&&(Mb=Cd.toString(),oc=nd)});if(this.dSh&&Mb===this.dSh)H.a.$(512496158,833,50,"SessionId: {0}, Message: Already trigger for slideId, skip save thumbnails request, Reason: {1}",this.Sg.telemetryData.sessionId,Y),Sa(!0);else{var Oc=this.JG.TriggerSaveThumbnails(()=>
this.nZf("SaveThumbnails",this.Sg.telemetryData.sessionId),Mb);Oc?Oc.then(()=>{this.dSh=Mb;H.a.$(512496156,833,50,"SessionId: {0}, Message: Triggering save thumbnails call succeeded, Reason: {1}",this.Sg.telemetryData.sessionId,Y);Sa(!0)}).catch(nd=>{H.a.$(512496155,833,10,"SessionId: {0}, Message: Triggering save thumbnais call failed due to error!, Details: {1}, Reason: {2}",this.Sg.telemetryData.sessionId,nd.toString(),Y);Sa(!1)}):(this.Sg.telemetryData.SetErrorCode(15,"Triggering save thumbnails failed to created Promise object!"),
H.a.$(512496157,833,10,"SessionId: {0}, Message: Triggering save thumbnails failed to created Promise object!"),Sa(!1))}}}catch(nd){this.Sg.telemetryData.SetErrorCode(15,nd.toString()),H.a.$(512496154,833,10,"SessionId: {0}, Message: Exception when triggering save thumbnails, Details: {1}",this.Sg.telemetryData.sessionId,nd.toString()),Sa(!1)}else Sa(!0)})}Gkd(){return this.na.FFa&&this.Hv&&this.Hv.instance?!0:!1}s2m(Y){if(this.Gkd())switch(Y){case 0:this.yTc&&this.Hv.instance.show(ResourceStrings.L_LivePresentations_Disconnected,
lj.a.eKb);this.Sg.telemetryData.SetErrorCode(3);this.P7a("DisconnectdToPrague");break;case 1:this.Hv.instance.hide();break;case 2:this.yTc&&this.Hv.instance.show(ResourceStrings.L_LivePresentations_Connecting,lj.a.$pd);break;default:H.a.$(512496152,833,10,"SessionId: {0}, Message: Unhandled connection state value.",this.Sg.telemetryData.sessionId)}else H.a.$(512496153,833,10,"SessionId: {0}, Message: Cannot show notification for service connectivity.",this.Sg.telemetryData.sessionId)}iqd(Y,Sa){this.Gkd()?
Sa.isConnected?this.Hv.instance.hide():this.yTc&&this.Hv.instance.show(ResourceStrings.L_LivePresentations_InternetDisconnected,lj.a.$pd):H.a.$(512496151,833,10,"SessionId: {0}, Message: Cannot show notification for network connectivity.",this.Sg.telemetryData.sessionId)}$kj(Y,Sa){Y=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}&waccluster={2}",this.na.ym,Y,Sa);this.na.Hqm&&(Y+="&shareable=true");return Y}Xjo(Y,Sa){try{const Mb=new N.a;if(1===Y||2===Y||4===Y)Mb.add(this.R1h(3)),
Mb.add(this.E7e(3));Mb.count?Promise.all(Mb.toArray()).then(()=>Sa()).catch(()=>Sa()):Sa()}catch(Mb){H.a.$(512496150,833,10,"failed to create end session task promises, error : {0}",Mb),Sa()}}get HEl(){const Y=ei.a.get("PPTLivePresentationOnboarded");return Y?"true"===Y.toLowerCase():!1}set HEl(Y){ei.a.rX("PPTLivePresentationOnboarded",Y.toString(),ei.a.BU)||H.a.$(512496149,833,10,"Failed to set cookie for PPTLivePresentationOnboarded to {0}",Y.toString())}A6i(){return this.na.Yqm&&!this.HEl}cxa(){try{if(H.a.$(512496148,
833,15,"Pods session rehydrated!"),this.fRh=!0,this.FO&&this.kM&&this.JG){H.a.$(512496147,833,15,"SessionId: {0}, Message:OnPodSessionRehydrated: Updating file download Url for DC: {1}",this.Sg.telemetryData.sessionId,this.pb.Hp);const Y=this.$kj(this.pb.podSessionId,this.pb.Hp);this.JG.OnPodSessionUpdated(Y)}}catch(Y){H.a.$(512496146,833,10,"LivePresenter: Exception at OnPodSessionRehydrated: {0}",Y.toString())}}kqd(){this.fRh=!1}Omm(){this.fRh=!1}OFb(){if(this.na.Zqm)try{const Y=vb.a.instance.eb("Common.ISystemInitiatedFeedback");
Y&&(H.a.$(512496145,833,50,"LivePresenter: Floodgate survey triggered for PPTLive"),Y.execute(Sa=>{Sa.logActivity("PPTWebLivePresentationsActivity","PPTLivePresentationsFloodgateSurveyEnabled")}))}catch(Y){H.a.$(512496144,833,10,"LivePresenter: Exception thrown when trying to trigger floodgate survey. Exception: {0}",Y)}}S3l(Y){const Sa=document.createElement("a");Sa.setAttribute("href",Y);return(Y=Sa.search.match(RegExp("[\\?&]Id=([^&#]*)")))&&2===Y.length?Y[1]:""}vdn(){var Y=this.rc.e1d();let Sa=
1;this.Ynk.clear();for(const Mb of Y){Y=Mb.Nj();for(const oc of Y)if(!Eb.a.wb(oc.T$b)){Y=this.S3l(oc.T$b);const Oc=new pk;Oc.Pgm=Y;Oc.Qgm=Sa.toString();this.Ynk.add(Oc);Sa+=1}}}$Cm(){var Y=this.rc.i1(this.xfe).Nj();for(const Sa of Y)Eb.a.wb(Sa.T$b)||(Y=this.S3l(Sa.T$b),Y=this.Xnk.get(Y),Eb.a.wb(Y)||this.JG.SetCurrentPollInfoState(Y,this.xfe))}xVm(Y){this.xa.addHandler("OnLiveResourcesLoaded",Y)}E6n(Y){this.xa.removeHandler("OnLiveResourcesLoaded",Y)}eQl(Y){this.xa.addHandler("OnLiveSessionStarted",
Y)}sum(Y){this.xa.removeHandler("OnLiveSessionStarted",Y)}dQl(Y){this.xa.addHandler("OnLiveSessionEnded",Y)}rum(Y){this.xa.removeHandler("OnLiveSessionEnded",Y)}fVm(Y){this.xa.addHandler("OnCalloutDismissed",Y)}s6n(Y){this.xa.removeHandler("OnCalloutDismissed",Y)}aQl(Y){this.xa.addHandler("OnRelaunchPausedSession",Y)}pum(Y){this.xa.removeHandler("OnRelaunchPausedSession",Y)}gVm(Y){this.xa.addHandler("CalloutMenuDefinitionChanged",Y)}t6n(Y){this.xa.removeHandler("CalloutMenuDefinitionChanged",Y)}}
Object(c.a)(gm,"LivePresenter",null,[754]);class Zi{constructor(){this.ga=null;this.Cgm=0}get name(){return"PowerPointWebEditor.Live"}oc(Y){this.ga=Y;const Sa=this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),Mb=this.ga.resolve("PowerPointWebEditor.IApplicationSettings");this.ga.register(754,"PowerPointLive.ILivePresenter").oa().pa(()=>new gm(Mb,Sa,this.ga.resolve("PowerPointWebEditor.ISlideshowFrame"),this.ga.resolve("PowerPoint.IPathManager"),this.ga.resolve("Common.App.OAuth.IOAuthManager"),
this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.ga.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.ga.eb("PowerPointWebEditor.ISubtitleContext"),vb.a.instance.eb("PowerPointWebEditor.ISlideShowVoiceNotification"),this.ga.resolve("PowerPointWebEditor.Core.INetworkConnectivityProvider"),
this.ga.resolve("PowerPointWebEditor.IFocusManager")))}gBn(){try{this.ga.resolve("PowerPointWebEditor.IApplicationSettings").Thb?(this.Cgm=Date.now(),H.a.$(509441559,833,50,"PPTWebEditorLivePackage: Loading the Live Presenter scripts"),Db.a.get_instance().Ai(7,()=>{const Y=this.ga.resolve("Common.IDynamicScriptLoaderProvider").SU,Sa=mk.a(this.ga),Mb=new N.a;Mb.add(Y.loadScript("PPTLiveBroadcast"));Mb.add(Y.loadScript("BroadcastMonitor"));Mb.add(Sa("liveActor"));n.AFrameworkApplication.Ha.Ib.ex||Mb.add(Sa("uiFabricLazy"));
Promise.all(Mb.toArray()).then(()=>this.BSn()).catch(oc=>H.a.$(42869341,833,10,"Failed to load scripts for the Live Presenter feature: {0}",oc))})):H.a.$(509441560,833,50,"PPTWebEditorLivePackage: Not loading the Live Presenter scripts because the feature is not enabled")}catch(Y){H.a.$(509441558,833,10,"PPTWebEditorLivePackage: exception in OnFullAppSettingsReady: {0}",Y)}}uu(){try{if(this.ga.resolve("PowerPointWebEditor.IApplicationSettings").Thb){if(this.ga.resolve("PowerPointWebEditor.IApplicationSettings").Rqm){const Y=
Eb.a.GJ((n.AFrameworkApplication.fileName||"").toLowerCase());if(".ppt"===Y||".pps"===Y){H.a.$(509441556,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format by checking file extension.");return}".pptx"!==Y&&H.a.$(509441555,833,15,"PPTWebEditorLivePackage: Allowing file extension: "+Y)}this.ga.resolve("PowerPointWebEditor.IApplicationSettings").Uqm&&this.ga.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(4)?H.a.$(509441554,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format."):
this.ga.resolve("PowerPointWebEditor.IApplicationSettings").Vqm&&(this.ga.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32)||this.ga.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32768))?H.a.$(509441553,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for protected file."):this.ga.resolve("PowerPointWebEditor.IApplicationSettings").SJk&&"msa"===this.ga.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType?H.a.$(509441552,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for MSA users."):
this.ga.eb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Y=>{Y.isFeatureEnabled("PowerPointLivePresentations",!1).then(Sa=>{Sa?this.gBn():(H.a.$(509441551,822,50,"User doesn't have license for Live broadcast feature. Skipping loading Live package!"),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0)))})})}else H.a.$(509441557,833,50,"PPTWebEditorLivePackage: Live broadcast feature is not enabled.")}catch(Y){H.a.$(509441550,833,10,"OnFullAppSettingsReady: exception in OnFullAppSettingsReady: {0}",
Y)}}BSn(){H.a.$(509441549,833,50,"PPTWebEditorLivePackage: Loading time: {0}ms",Date.now()-this.Cgm);this.ga.resolve("PowerPointLive.ILivePresenter").xVd=!0;this.ga.resolve("PowerPointWebEditor.IApplicationSettings").SJk||"msa"!==this.ga.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLiveSetAccessControlOrganization",!0));return null}init(){n.AFrameworkApplication.ha.Wf(Object(h.a)(this,this.uu,"onFullAppSettingsReady"))}dispose(){}static main(){b.a.instance.Jc(new Zi)}}
Object(c.a)(Zi,"PPTWebEditorLivePackage",null,[4,5]);var om=a(738),xl=a(1164);class hm{}Object(c.a)(hm,"LokiTokenResult",null,[]);class Gm{constructor(Y){this.iEh=Y}n3l(){const Y=this.Ain();return Y?Gm.N$d?new Promise((Sa,Mb)=>{this.iEh.continueWith(()=>{this.iEh.Nn||this.iEh.Om?Mb(Error.create("Error downloading auth library")):this.iEh.result.hP("Loki",Y).then(oc=>{oc=n.AFrameworkApplication.ha.getBooleanAppSetting("ForceLokiFallbackToACLPTokenIsEnabled")?this.Bin():oc.IsSuccess&&oc.Token?Object.assign(new hm,
{isSuccess:!0,token:oc.Token,errorMessage:null}):Object.assign(new hm,{isSuccess:!1,token:null,errorMessage:JSON.stringify(oc)});Sa(oc);return oc})})}):Promise.resolve(Object.assign(new hm,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new hm,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",xl.a.cLh())}))}Bin(){const Y=n.AFrameworkApplication.ha.Ma("LokiUserDataSignature")||
"";return Object.assign(new hm,{isSuccess:!0,token:Y,errorMessage:null})}Ain(){let Y=null;const Sa=xl.a.PXd();2===Sa?Y=n.AFrameworkApplication.ha.Ma("LokiAADAppId"):1===Sa&&(Y=n.AFrameworkApplication.ha.Ma("LokiMSAAppId"));return Y}static get N$d(){return n.AFrameworkApplication.ha.getBooleanAppSetting("IsO365CommercialHost")||n.AFrameworkApplication.ha.getBooleanAppSetting("IsO365ConsumerHost")}}Object(c.a)(Gm,"LokiTokenManager",null,[809]);class ym{get name(){return"Common.App.LivePersonaUtils"}init(){vb.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}oc(Y){Y.register(Gm,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").oa().pa(()=>new Gm(lf.a.kH(Object(om.a)())))}static main(){b.a.instance.Jc(new ym)}}Object(c.a)(ym,"LivePersonaUtilsPackage",null,[4,5]);var Um=a(258);class vm{constructor(){this.displayName=this.critique=null;this.optOut=!1;this.category=null}}Object(c.a)(vm,"RehearsalCritique",null,[]);class sg{static Hun(){sg.gea[2]=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;sg.gea[3]=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;
sg.gea[4]=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;sg.gea[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;sg.WXl=ResourceStrings.L_SubtitleDetection_MicReady;sg.XXl=ResourceStrings.L_SubtitleDetection_SoundReminder;sg.n_l=ResourceStrings.L_SubtitleDetection_NoMicrophone;sg.p_l=ResourceStrings.l_NoCamera;sg.B1l=ResourceStrings.L_SpeechGenericRetryErrorMessage}}sg.ZSl=20;sg.wtm=50002;sg.gea=Array(sg.ZSl);sg.WXl=null;sg.XXl=null;sg.n_l=null;sg.p_l=null;sg.B1l=null;sg.b8i="fillerWords";
sg.BVn="originality";sg.epo="wordsPerMinute";sg.C$n="sensitivePhrases";sg.n3m="correctedSensitivePhrases";sg.DYn="positivity";sg.cwj="grammar";sg.Hsk="monotone";sg.sNk="pronunciation";sg.BVi="crutchWords";sg.fFm="visionFace";sg.Hoo="visionGaze";sg.Goo="visionGazeGood";sg.Joo="visionOcclusion";sg.Ioo="visionOcclusionGood";sg.Doo="visionDistanceGood";sg.Eoo="visionDistanceTooClose";sg.Foo="visionDistanceTooFar";sg.Pln="GetStartedButton";sg.UAn="ListeningElement";sg.B2m="ContainerElement";sg.FWn="PausedElement";
sg.ytm="RehearsalFeedbackSettingPane";sg.mIk="PPTCoachRehearsalFREShown";Object(c.a)(sg,"RehearsalResourceString",null,[]);const pl=(Y,Sa)=>Eb.a.wb(Sa)?(e.ULS.sendTraceTag(508692422,822,10,"RehearsalUtils:IsCritiqueEnabled Invalid critique name"),!1):Y?Sa.toLowerCase()in Y:!0,tm=(Y,Sa)=>{let Mb=null;try{if(!Y||Eb.a.wb(Sa))return e.ULS.sendTraceTag(508692421,822,10,"RehearsalUtils:getSupportedCritiquesForLanguage SourceLanguage from session information or appsettings is null or empty"),null;const Oc=
Eb.a.wb(Y.abh)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(Y.abh,!0);Mb={};for(const nd in Oc){Y=nd;var oc=Oc[nd];if(oc){const Cd=Fc.a.Oid(oc.split(","));Cd&&Sa.toLowerCase()in Cd&&(Mb[Y.toLowerCase()]=!0)}}}catch(Oc){H.a.$(508692420,817,10,"RehearsalUtils:getSupportedCritiquesForLanguage Exception while building supported critique map from BRS: {0}",Oc.toString()),Mb=null}return Mb},im=(Y,Sa)=>{if(Eb.a.wb(Sa)||Eb.a.wb(Y.LFk))return null;try{var Mb=Sys.Serialization.JavaScriptSerializer.deserialize(Y.LFk,
!0);if(Eb.a.wb(Sa)){e.ULS.sendTraceTag(508692416,822,50,"RehearsalUtils:GetLanguageCodeFromLocale locale is null or empty.");var oc=null}else oc=Sa.split("-")[0].toLowerCase();return Mb[oc]}catch(Oc){return H.a.$(508692417,817,10,"RehearsalUtils:getPacingGaugeRangeLocale Exception while parsing BRS PodRehearsalLocaleBasedPacingGaugeRange: {0}",Oc.toString()),null}},Vm=Y=>{if(Y&&3<Y.length){let Sa="";"ws"===Y.substring(0,2)?Sa="http"+Y.substring(2,Y.length):"wss"===Y.substring(0,3)&&(Sa="https"+Y.substring(3,
Y.length));return Sa}return Y},Wm=Y=>{if(Eb.a.wb(Y))return e.ULS.sendTraceTag(508692387,822,10,"GetMappedSourceLanguage: SourceLanguage from session information is not valid, defaulting to english. SourceLanguage: {0}",Y),"en-US";switch(Y.toLowerCase()){case "en-au":case "en-ca":case "en-gb":case "en-in":case "en-us":return"en-US";default:return Y}};class Nm{constructor(){this.userCritiques=null}}Object(c.a)(Nm,"RehearseRoamingSettings",null,[]);class Om{constructor(){this.critiquesDisabledByDefault=
this.critiquesDisabled=null}}Object(c.a)(Om,"UserCritiqueSettings",null,[]);class yn{constructor(Y,Sa,Mb,oc){this.xa=new Zb.a;this.Gsa=this.msg=this.kSa=null;this.Pwa=!1;this.cdm=null;this.Imc=this.Jmc=0;this.Iq=Y;this.na=Sa;this.ysa=Mb;this.la=oc}rvn(){try{this.d4l(()=>{this.xa.raiseEvent("OnRehearsalOptOutSettingsRequestFinished",new Sys.EventArgs)})}catch(Y){H.a.$(508692293,822,10,"InitiateRehearsalOptOutSettingsRequest catched exception: {0}",Y.toString())}}VOh(){return 2===this.Jmc&&2===this.Imc}Mwl(){try{0!==
this.Jmc&&3!==this.Jmc||this.d4l(Object(h.a)(this,this.DQk,"raiseRehearsalGetCritiquesEvent")),0!==this.Imc&&3!==this.Imc||this.Mgn()}catch(Y){H.a.$(508692292,822,10,"TryToInitiateCritiquesFetchingRequest catched exception: {0}",Y.toString())}}Lfn(){if(!this.msg)return H.a.$(508692291,822,10,"GetCritiquesListForSettingsPane empty critique list"),null;try{if(this.Gsa)for(const Y of this.msg)this.Gsa.contains(Y.critique.toLowerCase())?Y.optOut=!0:Y.optOut=!1}catch(Y){H.a.$(508692290,822,10,"GetCritiquesListForSettingsPane catched exception: {0}",
Y.toString())}return this.msg.toArray()}omo(Y,Sa){this.vEm(Y,Sa);"vision"===Y.toLowerCase()&&(this.Pwa=!Sa,Y={},Y.triggerPoint=sg.ytm,this.la.Ra(tb.a.gdd,2,Y))}F3l(Y){Y=void 0===Y?!1:Y;let Sa="";if(this.Gsa&&0<this.Gsa.count)if(fb.a("RehearsalFilterOptOutCritiqueEnabled")&&Y){a:{var Mb=this.na;Y=this.na.Vdc;var oc=null;try{if(!Mb||Eb.a.wb(Y)){e.ULS.sendTraceTag(508692419,822,10,"RehearsalUtils:getCritiquesStatusForLanguage SourceLanguage from session information or appsettings is null or empty");
var Oc=null;break a}var nd=Eb.a.wb(Mb.abh)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(Mb.abh,!0);oc={};for(const Zd in nd){Oc=Zd;var Cd=nd[Zd];if(Cd){const we=Fc.a.Oid(Cd.split(","));oc[Oc.toLowerCase()]=we&&Y.toLowerCase()in we?!0:!1}}}catch(Zd){H.a.$(508692418,817,10,"RehearsalUtils:getCritiquesStatusForLanguage Exception while building supported critique map from BRS: {0}",Zd.toString()),oc=null}Oc=oc}if(Cd=Oc)for(const Zd of this.Gsa)if(nd="vision"===Zd?sg.fFm.toLowerCase():Zd.toLowerCase(),
nd in Cd?Cd[nd]:1)Sa=Eb.a.wb(Sa)?Zd.toLowerCase():Sa+","+Zd.toLowerCase()}else for(oc of this.Gsa)Sa=Eb.a.wb(Sa)?oc.toLowerCase():Sa+","+oc.toLowerCase();return Sa}WYh(){if(2!==this.Jmc)H.a.$(508692289,822,50,"SaveRehearseUserCritiques(), skipping save operation as Get request call is not succeeded");else if(this.ryn()){H.a.$(508692259,822,50,"SaveRehearseUserCritiques(), Start sending write request to FE");var Y=new Nm;Y.userCritiques=Object.assign(new Om,{critiquesDisabled:this.F3l(),critiquesDisabledByDefault:this.kSa.userCritiques.critiquesDisabledByDefault});
var Sa=de.c(Y),Mb=this.na.w0+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePowerPointRehearseUserCritiques",n.AFrameworkApplication.Fh),oc={};oc["X-StatelessPopsAffinityRoutingEnabled"]=this.na.aea.toString();this.Iq.ik(Mb,2,Sa,oc,!1,2,Oc=>{this.STn(Oc,Y)},Object(h.a)(this,this.RTn,"onSaveUserCritiquesFailed"),null,void 0,void 0,void 0,void 0,Um.a("17"))}else H.a.$(508692288,822,50,"SaveRehearseUserCritiques(), skipping save operation")}get W6i(){return this.Pwa}set W6i(Y){this.Pwa=
Y;this.vEm("vision",!this.Pwa);this.VOh()&&this.xa.raiseEvent("OnRehearsalSettingsUpdatedExternally",Sys.EventArgs.Empty)}tVm(Y){this.xa.addHandler("OnRehearsalOptOutSettingsRequestFinished",Y)}A6n(Y){this.xa.removeHandler("OnRehearsalOptOutSettingsRequestFinished",Y)}sVm(Y){this.xa.addHandler("OnRehearsalGetCritiquesSucceeded",Y)}z6n(Y){this.xa.removeHandler("OnRehearsalGetCritiquesSucceeded",Y)}rVm(Y){this.xa.addHandler("OnRehearsalGetCritiquesFailed",Y)}y6n(Y){this.xa.removeHandler("OnRehearsalGetCritiquesFailed",
Y)}uVm(Y){this.xa.addHandler("OnRehearsalSettingsUpdatedExternally",Y)}B6n(Y){this.xa.removeHandler("OnRehearsalSettingsUpdatedExternally",Y)}vEm(Y,Sa){this.Gsa&&(Y=Y.toLowerCase(),Sa&&!this.Gsa.contains(Y)?this.Gsa.add(Y):!Sa&&this.Gsa.contains(Y)&&this.Gsa.remove(Y),fb.a("RehearsalRoamingSettingAutoSaveEnabled")&&this.WYh())}ryn(){let Y=!1;try{var Sa=Eb.a.wb(this.kSa.userCritiques.critiquesDisabled);if(!this.Gsa||!this.Gsa.count&&Sa)return!1;if(Sa&&0<this.Gsa.count||!Sa&&!this.Gsa.count)return!0;
const Mb=new Set(this.kSa.userCritiques.critiquesDisabled.split(","));if(this.Gsa.count!==Mb.size)return!0;for(Sa=0;Sa<this.Gsa.count;Sa++)if(!Mb.has(this.Gsa.ka(Sa).toLowerCase())){Y=!0;break}}catch(Mb){H.a.$(508692258,822,10,"IsSaveRehearsalSettingsRequired catched exception: {0}",Mb.toString())}return Y}STn(Y,Sa){this.kSa=Sa;H.a.$(508692257,822,50,"OnSaveUserCritiquesSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+Y.data.Gp-+Y.data.Wy,+Y.data.Oo-+Y.data.Wy)}RTn(Y){const Sa=this.ysa.WX(Y);H.a.$(508692256,
822,50,"OnSaveUserCritiquesFailed: Web service failed with {0}, NumSlides={1}",Sa,Y.data.state)}d4l(Y){const Sa=this.na.w0+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPowerPointRehearseUserCritiques",n.AFrameworkApplication.Fh),Mb={};Mb["X-StatelessPopsAffinityRoutingEnabled"]=this.na.aea.toString();this.Iq.ik(Sa,1,null,Mb,!1,2,oc=>{this.aSn(oc,Y)},oc=>{this.$Rn(oc,Y)},null,void 0,void 0,void 0,void 0,Um.a("16"));this.Jmc=1}aSn(Y,Sa){let Mb=0;try{Y.data.responseData&&0<Y.data.responseData.trim().length&&
(Mb=Y.data.responseData.length,this.kSa=JSON.parse(Y.data.responseData));this.kSa&&this.kSa.userCritiques||(this.kSa=new Nm,this.kSa.userCritiques=new Om);Eb.a.wb(this.kSa.userCritiques.critiquesDisabledByDefault)&&(this.kSa.userCritiques.critiquesDisabledByDefault="vision",Eb.a.wb(this.kSa.userCritiques.critiquesDisabled)?this.kSa.userCritiques.critiquesDisabled="vision":this.kSa.userCritiques.critiquesDisabled+=",vision");this.Gsa=new N.a;if(!Eb.a.wb(this.kSa.userCritiques.critiquesDisabled)){const oc=
this.kSa.userCritiques.critiquesDisabled.split(",");for(const Oc of oc)this.Gsa.add(Oc.toLowerCase())}this.Pwa=!this.Gsa.contains("vision");this.Jmc=2}catch(oc){this.Jmc=3,H.a.$(508692255,822,10,"OnGetUserCritiquesSucceeded catched exception: {0}",oc.toString())}Sa&&Sa();Y=String.format("OnGetUserCritiquesSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",Mb,JSON.stringify(Y.data.Wy),JSON.stringify(Y.data.Oo),JSON.stringify(Y.data.Gp));H.a.$(508692254,822,50,Y)}$Rn(Y,
Sa){this.Jmc=3;Sa&&Sa();Y=this.ysa.WX(Y);H.a.$(508692253,822,50,"OnGetUserCritiquesFailed: Web service failed with {0}",Y)}Mgn(){try{const Sa=this.Qan();if(Eb.a.wb(Sa))H.a.$(508692252,822,10,"GetEnabledCritiquesForClientAndLocale failed to generate FD url for GetCritiques request");else{var Y=new XMLHttpRequest;Y.open("GET",Sa,!0);Y.onreadystatechange=()=>{if(4===Y.readyState){if(200===Y.status){H.a.$(508692251,822,50,"GetEnabledCritiquesForClientAndLocale: GetCritiques call successfuly completed");
const Mb=de.b(Y.responseText);if(Mb){this.msg=new N.a;for(const oc of Mb.critiquesData)this.msg.add(Object.assign(new vm,{category:oc.category,displayName:oc.displayName,optOut:!1,critique:oc.critique.toLowerCase()}));this.cdm=Mb.categoriesData;this.Imc=2}else this.Imc=3}else this.Imc=3;this.DQk()}};Y.send("");this.Imc=1}}catch(Sa){this.Imc=3,this.DQk(),H.a.$(508692250,822,10,"GetEnabledCritiquesForClientAndLocale catched exception: {0}",Sa.toString())}}Qan(){const Y=de.b(n.AFrameworkApplication.ha.appSettings.SessionStartInfoJson.toString()).Ring||
"Unknown",Sa=this.na.EKb.replace("wss","https");return Sa&&Sa.length?String.format("{0}GetCritiqueListHandler.ashx?action=GetCritiqueList&client=web&audiencegroup={1}&locale={2}",Sa,Y,Wm(this.na.Vdc)):null}DQk(){0!==this.Jmc&&1!==this.Jmc&&0!==this.Imc&&1!==this.Imc&&(this.VOh()?this.xa.raiseEvent("OnRehearsalGetCritiquesSucceeded",new Sys.EventArgs):this.xa.raiseEvent("OnRehearsalGetCritiquesFailed",new Sys.EventArgs))}}Object(c.a)(yn,"RehearsalFeedbackSettings",null,[751]);class zn{constructor(){this.type=
"RehearsalCritiqueWithGroupProps";this.retryToFetchCritiqueSettings=this.locale=this.updateCritiqueState=this.categoriesData=this.groupItems=null;this.isExternalUpdated=this.showErrorMessage=this.showLoadingMessage=!1}}Object(c.a)(zn,"RehearsalCritiqueWithGroupProps",null,[]);class en{constructor(Y,Sa,Mb,oc,Oc){this.$8a=this.pc=!1;Y("powerpoint-presenter-coach-strings").then(()=>{this.$8a=!0;H.a.$(509138183,822,50,"powerpoint-presenter-coach-strings loaded successfully")}).catch(nd=>{H.a.$(509138182,
822,10,"Failed to load powerpoint-presenter-coach-strings "+nd.toString())});this.la=Sa;this.na=Oc;this.fT=Mb;this.j4=oc;this.la.z9(this)}Kb(){this.la.Ba(tb.a.Unh,Ta.a.application,Object(h.a)(this,this.Unh,"showRehearsalFeedbackSettingsPane"));this.la.Ba(tb.a.o6e,Ta.a.application,Object(h.a)(this,this.o6e,"showHideRehearsalFeedbackSettingsPane"));this.la.ua(tb.a.f4e,Ta.a.application,Object(h.a)(this,this.f4e,"queryShowHideRehearsalFeedbackSettingsPane"),96)}Ae(){}getName(){return"RehearsalSettings"}q1(){}p1(){}Unh(Y,
Sa,Mb){if(Sa.contextId!==Ta.a.application||!this.$8a)return 2;if(1===Mb)return 32;this.pc?Sb.a.Gz().then(oc=>{oc.setSelectedTaskPane(fc.a.aoc);this.y0(!0);return null}).catch(oc=>{H.a.$(509138180,822,10,"RehearsalFeedbackSettingsPane::ShowRehearsalFeedbackSettingsPane exception: {0}",oc.toString())}):(this.pc=!0,this.ptm(),(Y=!this.j4.VOh())&&this.j4.Mwl(),Y=this.jN(Y,!1),this.Dnh(Y),H.a.$(509138181,822,50,"RehearsalFeedbackSettingsPaneActor::ShowRehearsalFeedbackSettingsPane"));return 32}o6e(Y,Sa,
Mb){if(Sa.contextId!==Ta.a.application||!this.$8a)return 2;if(1===Mb)return 32;(this.pc=!this.pc)?(this.ptm(),(Y=!this.j4.VOh())&&this.j4.Mwl(),Y=this.jN(Y,!1),this.Dnh(Y),H.a.$(509138179,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane show")):(this.t1m(),H.a.$(509138178,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane close"));return 32}f4e(Y,Sa,Mb,oc,Oc){if(!Object(qj.a)(fl.a,Oc))return 8;Oc.Fg(this.pc);return 32}Dnh(Y,Sa){Sa=void 0===
Sa?!1:Sa;const Mb=Object.assign(new Ka.a,{title:ResourceStrings.L_RehearseFeedbackSettings,hideHeader:!1,width:320,location:2,contentProps:Y,onOpen:()=>{},onClose:()=>{this.pc=!1;this.m7m();this.j4.WYh()},onHide:()=>{this.j4.WYh()},isModernPane:!0});Y=document.getElementById("RehearsalFeedbackSettingsPaneFocus-panel");this.fT.nYa(fc.a.aoc,fc.a.Wl,Y,()=>{this.y0(!0)},()=>{this.y0(!1)});Sb.a.Gz().then(oc=>{Sa?this.pc&&oc.updateTaskPane(fc.a.aoc,Mb):oc.showTaskPane(fc.a.aoc,Mb);return null}).catch(oc=>
{H.a.$(509138177,822,10,"RehearsalFeedbackSettingsPaneActor::ShowFeedbackSettingPane exception: {0}",oc.toString())})}t1m(){Sb.a.Gz().then(Y=>{Y.hideTaskPane(fc.a.aoc,2);return null}).catch(Y=>{H.a.$(509138176,822,10,"RehearsalFeedbackSettingsPaneActor::CloseFeedbackSettingPane exception: {0}",Y.toString())})}jN(Y,Sa){return Object.assign(new zn,{groupItems:Y||Sa?null:this.j4.Lfn(),categoriesData:this.j4.cdm,locale:this.na.Vdc,updateCritiqueState:(Mb,oc)=>{this.j4.omo(Mb,oc)},retryToFetchCritiqueSettings:()=>
{this.j4.Mwl()},showLoadingMessage:Y,showErrorMessage:Sa})}y0(Y){const Sa=document.getElementById("TaskPaneCloseBtnRehearsalFeedbackSettingsPaneFocus");Y&&Sa&&Sa.focus()}ptm(){this.j4.sVm(Object(h.a)(this,this.Ymm,"onRehearsalGetCritiquesSucceeded"));this.j4.rVm(Object(h.a)(this,this.Xmm,"onRehearsalGetCritiquesFailed"));this.j4.uVm(Object(h.a)(this,this.$mm,"onRehearsalSettingsUpdatedExternally"))}m7m(){this.j4.z6n(Object(h.a)(this,this.Ymm,"onRehearsalGetCritiquesSucceeded"));this.j4.y6n(Object(h.a)(this,
this.Xmm,"onRehearsalGetCritiquesFailed"));this.j4.B6n(Object(h.a)(this,this.$mm,"onRehearsalSettingsUpdatedExternally"))}Ymm(){const Y=this.jN(!1,!1);this.Dnh(Y,!0)}Xmm(){const Y=this.jN(!1,!0);this.Dnh(Y,!0)}$mm(){const Y=this.jN(!1,!1);Y.isExternalUpdated=!0;this.Dnh(Y,!0)}}Object(c.a)(en,"RehearsalFeedbackSettingsPane",null,[90]);var Pm;(function(Y){Y[Y.none=0]="none";Y[Y.ribbon=1]="ribbon";Y[Y.slideShowToolbar=2]="slideShowToolbar";Y[Y.summaryPage=3]="summaryPage";Y[Y.ribbonTopBar=4]="ribbonTopBar";
Y[Y.deepLink=5]="deepLink"})(Pm||(Pm={}));Object(c.b)("RehearsalEntryPoint",Pm);class bm{constructor(){this.imagesBaseFilePath=this.slideState=this.rootContainer=null;this.zIndex=0;this.fUseCountdownWelcomeScreen=this.fShowRealtimeFeedbackEnabledCheckbox=this.fEnableVision=!1;this.speechFDBase=null;this.fUseNewRealtimeCheckbox=this.fUseNewRealtimePanel=this.fDontShowTooltips=!1}}Object(c.a)(bm,"ICoachActorConfig",null,[]);class Yn{constructor(){this.rootContainer=this.imagesBaseFilePath=null;this.zIndex=
0}}Object(c.a)(Yn,"ICoachFREActorConfig",null,[]);class Zn{constructor(){this.customSettings=this.requestedRehearsalOptOutFeatures=this.requestedCoachFeatures=this.documentDownloadConfig=this.userSessionId=this.disabledCoachRealtimeFeatures=this.logger=null;this.fEnableVision=!1;this.supportedRehearsalTemplates=this.sourceLanguage=this.entryPoint=this.wacDatacenter=this.wacHost=this.locale=this.buildVersion=this.audienceGroup=this.audienceChannel=this.identityProvider=this.tenantId=this.userId=this.speechFDBase=
this.webcamConfig=null;this.fEnableServiceSideAggregationForCoach=!1;this.httpTimeoutForCoachSummaryData=0;this.enableTimeStampedCritiqueTelemetry=this.fSendClientMetaDataOnSessionStart=!1;this.audioInputDeviceCount=0}}Object(c.a)(Zn,"ICoachSessionConfig",null,[]);class $n{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(c.a)($n,"IDocumentDownloadConfig",null,[]);class An{constructor(){this.totalSlideCount=this.currentSlideIndex=0}}Object(c.a)(An,
"ISlideState",null,[]);class dl{constructor(){this.workingCanvas=this.videoView=null;this.requestedVideoHeight=this.requestedVideoWidth=this.webcamFrameWidth=this.numFramesPerSecond=0}}Object(c.a)(dl,"IWebcamConfig",null,[]);var fn=a(1244);class ao{constructor(Y,Sa,Mb,oc,Oc,nd,Cd,Zd,we,Qe,kf,Vf,eg,zg){this.vod=!1;this.q8=this.Z$j=this.JYa=this.R3b=null;this.lOg=0;this.Ugm=-1;this.Dpd=0;this.iUh=this.dUh=null;this.ock=this.jck=!1;this.Ykk=this.r8b=0;this.Pwa=!1;this.xa=new Zb.a;this.Apd=null;this.pem=
this.bpk=this.q$j=!1;this.$kk=null;this.tqg=this.fdm=0;this.Shm=this.Ydm=!1;this.bem=n.AFrameworkApplication.ha.getBooleanAppSetting("FirstRehearsalExperienceEnabled");this.$4b=Mb;Sa&&(this.R3b=Sa.gN());this.Ad=oc;this.la=Y;this.rc=Oc;this.ya=nd;this.pb=Cd;this.na=Zd;this.Hv=we;this.AJb=Qe;this.kOg=kf;this.j4=Vf;this.M3=eg;this.Gy=zg;this.WUf()&&this.j4.tVm(Object(h.a)(this,this.Zmm,"onRehearsalOptOutSettingsRequestFinished"))}Kb(){this.la.Ba(tb.a.I6e,Ta.a.application,Object(h.a)(this,this.I6e,"startRehearsalManager"));
this.la.Ba(tb.a.gdd,Ta.a.application,Object(h.a)(this,this.gdd,"toggleRehearsalVisionEnabled"));this.la.Ba(tb.a.Ird,Ta.a.application,Object(h.a)(this,this.Ird,"rehearsePresentationDropDown"));this.la.ua(tb.a.Pnc,Ta.a.application,Object(h.a)(this,this.Pnc,"queryRehearsalVisionEnabled"),96)}Pnc(Y,Sa,Mb,oc,Oc){if(!Oc||!Object(qj.a)(fl.a,Oc))return H.a.$(512496082,822,10,"RehearsalManager::QueryRehearsalVisionEnabled requires actionData"),8;Oc.Fg(this.Pwa);return 32}Ird(Y,Sa,Mb){switch(Mb){case 1:if(this.vod&&
this.UZj())return this.la.Eb(tb.a.tZa,1);break;default:H.a.$(512496081,822,10,"RehearsePresentationDropDown: Unimplemented action behavior")}return 8}gdd(Y,Sa,Mb,oc,Oc){switch(Mb){case 2:return this.Pwa=!this.Pwa,n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.ex&&Wc.App.Zb.CE({ToggleRehearsalVisionEnabled:"CheckboxModel"}),this.WUf()&&Oc&&Oc.triggerPoint!==sg.ytm&&(this.j4.W6i=this.Pwa),32;case 1:if(this.vod&&this.UZj())return 32;break;default:H.a.$(512496080,822,10,"ToggleVisionEnabled: Unimplemented action behavior")}return 8}I6e(Y,
Sa,Mb,oc,Oc){switch(Mb){case 2:return this.Lgo(Oc),32;case 1:if(this.vod&&this.UZj())return 32;break;default:H.a.$(512496079,822,10,"StartRehearsalManager: Unimplemented action behavior")}return 8}Dce(){try{this.fdm=Date.now();const Y=this.$4b.SU;Y.loadScript("powerpoint-presenter-coach-strings").then(()=>{const Sa=new N.a;Sa.add(Y.loadScript("CoachActorPackage"));Sa.add(Y.loadScript("CoachPackage"));Promise.all(Sa.toArray()).then(()=>{this.HQn();return null}).catch(Mb=>{H.a.$(512496078,801,10,"Failed to load scripts for the Presenter Coach feature: {0}",
Mb);return null})})}catch(Y){H.a.$(512496077,822,10,"RehearsalManager: Exception in LoadResources : {0}.",Y)}}hVm(Y){this.xa.addHandler("OnCoachResourcesLoaded",Y)}u6n(Y){this.xa.removeHandler("OnCoachResourcesLoaded",Y)}HQn(){const Y=n.AFrameworkApplication.ha.Ma("CoachPackageCssUrl"),Sa=document.createElement("link");Sa.setAttribute("rel","stylesheet");Sa.setAttribute("type","text/css");Sa.setAttribute("href",Y);$addHandler(Sa,"load",()=>{this.vod=!0;fb.a("PollToRefreshCoachEntryPointOnRibbon")&&
this.Gy&&this.Gy.JC();this.xa.raiseEvent("OnCoachResourcesLoaded",new Sys.EventArgs);H.a.$(512496076,822,50,"RehearsalManager: Coach package loading time: {0}ms",Date.now()-this.fdm)});document.body.appendChild(Sa)}p5n(){this.Ad.NFh(Object(h.a)(this,this.Cnm,"onSlideshowReady"));this.Ad.Pjc(Object(h.a)(this,this.Y0g,"onSlideShowPositionChanged"));this.Ad.TSb(Object(h.a)(this,this.mKb,"onSlideshowExitHandler"));this.Ad.OFh(Object(h.a)(this,this.xqd,"onSpecialKeyHandler"))}n7m(){this.Ad.pYh(Object(h.a)(this,
this.Cnm,"onSlideshowReady"));this.Ad.F7c(Object(h.a)(this,this.Y0g,"onSlideShowPositionChanged"));this.Ad.aLb(Object(h.a)(this,this.mKb,"onSlideshowExitHandler"));this.Ad.qYh(Object(h.a)(this,this.xqd,"onSpecialKeyHandler"))}xqd(Y,Sa){Sa.key===la.a.hjc&&this.C$k()}C$k(){if(0===this.r8b){var Y=this.q8.getCoachElement(sg.Pln);Y&&this.r$c(Y)}else 2===this.r8b?(Y=this.q8.getCoachElement(sg.FWn))&&this.r$c(Y):1===this.r8b&&(Y=this.q8.getCoachElement(sg.UAn))&&this.r$c(Y)}r$c(Y){this.R3b&&this.q8&&window.setTimeout(()=>
{Cb.FocusManager.vz(Y)},50)}LJ(Y){try{Y.keyCode!==la.a.yt&&(Y.keyCode===la.a.O1||Y.keyCode===la.a.m6?(this.Ad.prev(),this.C$k()):Y.keyCode===la.a.GY||Y.keyCode===la.a.l6?(this.Ad.next(),this.C$k()):Y.keyCode===la.a.nv||Y.keyCode===la.a.dud||Y.shiftKey||this.Ad.hga())}catch(Sa){H.a.$(512496075,822,10,"RehearsalManager: Exception in KeyDownHandler : {0}.",Sa)}}c5n(){const Y=this.q8.getCoachElement(sg.B2m),Sa=document.getElementById("HiddenFocusTrapAnchor");this.R3b.insertBefore(Y,Sa);Y&&bc.a.addHandler(Y,
Z.a.oi,Object(h.a)(this,this.LJ,"keyDownHandler"))}Lgo(Y){if(!this.ya.Ia)throw Error.argumentNull("ActiveSlide is null");sg.Hun();this.p5n();this.WUf()&&(this.j4.WYh(),this.j4.A6n(Object(h.a)(this,this.Zmm,"onRehearsalOptOutSettingsRequestFinished")));const Sa=new An;this.Apd=tm(this.na,this.na.Vdc);this.Pwa&&!this.na.nBb&&H.a.$(512496074,822,10,"RehearsalManager::startRehearsalSession: vision enabled but BRS is disabled.");this.Pwa=this.Pwa&&this.na.nBb;var Mb=new pi.a,oc=Object(G.a)(21,this.rc.i1(this.ya.Ia.fc.sid));
Sa.currentSlideIndex=oc?oc.Dh:0;Sa.totalSlideCount=this.rc.zl();oc=this.bfn(Sa);this.q8=(new CoachActorPackage.CoachActorFactory).createCoachActorManager(oc,Mb);this.Pwa&&(this.dUh=this.q8.getRehearsalVideoElement(),this.iUh=this.q8.getRehearsalVideoCanvas());this.Ykk=Y;Y=this.Pej(Sa,this.dUh,this.iUh);this.JYa=(new CoachPackage.CoachSessionFactory).createCoachManager(Y);Y=this.cfn();this.Z$j=(new CoachActorPackage.CoachFREActorFactory).createCoachFREActorManager(Y,Mb);fb.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&
this.M3.enumerateDevices(Object(h.a)(this,this.a2c,"onEnumerateDevicesSuccess"),Object(h.a)(this,this.Rzb,"onDevicesFailure"),Object(h.a)(this,this.dAb,"onUnsupported"));this.J4n();this.K4n();this.lOg=0;this.ock=!1;this.c5n();2===this.Ykk&&(Mb=localStorage.getItem(sg.mIk),this.bem&&!Mb?this.qBm():this.knl())}knl(){this.r8b=0;this.AJb.execute(Y=>{Y.xY(fn.a.SubtitlesButton,!1);Y.xY(fn.a.LiveButton,!1);Y.xY(fn.a.CoachButton,!1);Y.xY(fn.a.MicButton,!1)});this.JYa.startSession(!0)}qBm(){this.Z$j.showCoachFREUI(Y=>
{localStorage.setItem(sg.mIk,"true");this.Shm=Y;this.knl()})}a2c(Y){this.tqg=0;if(Y.length)for(var Sa of Y)"audioinput"===Sa.kind&&(this.tqg+=1);else this.tqg=0;this.Ydm=!0;Y=new An;Sa=Object(G.a)(21,this.rc.i1(this.ya.Ia.fc.sid));Y.currentSlideIndex=Sa?Sa.Dh:0;Y.totalSlideCount=this.rc.zl();Y=this.Pej(Y,this.dUh,this.iUh);this.JYa.updateSessionConfiguration(Y)}Rzb(Y){H.a.$(512496073,822,50,"RehearsalManager::OnDevicesFailure unable to get devices. Error: {0}",Y.toString())}dAb(){H.a.$(512496072,
822,10,"RehearsalManager::OnDevicesUnsupported mediaDevices API not available for browser: {0}",Na.a.Uy)}Cnm(){const Y=localStorage.getItem(sg.mIk);this.bem&&!Y?this.qBm():this.knl()}Y0g(Y,Sa){Y=new An;Y.currentSlideIndex=Sa.slideIndex;Y.totalSlideCount=this.rc.zl();Sa=this.Pej(Y,this.dUh,this.iUh);this.JYa.updateSessionConfiguration(Sa);this.q8.updateCoachSlideComponent(Y)}getTraceRequestMetadata(Y,Sa){const Mb={};if(Y)for(const oc in Y)Mb[oc]=Y[oc];if(Sa)for(const oc in Sa)Mb[oc]=Sa[oc];Y=de.b(n.AFrameworkApplication.ha.appSettings.SessionStartInfoJson.toString());
Mb.AudienceGroup=Y.Ring||"Unknown";Mb.BuildVersion=n.AFrameworkApplication.buildVersion||"Unknown";Mb.ClientType="web";Mb.IdentityProvider=this.na.hostAuthType||n.AFrameworkApplication.ha.Ma("HostAuthType")||"Unknown";Mb.Locale=this.na.EAb||"Unknown";Mb.SpeechMode="rehearsal";Mb.TenantId=n.AFrameworkApplication.ha.Ma("TenantId");Mb.UserId=this.getUserId();Mb.WacDatacenter=Y.WACDatacenter||"Unknown";Mb.WacHost=Y.Host||"Unknown";Mb.SourceLanguage=this.na.eLi||Wm(this.na.Vdc);return Mb}getUserId(){let Y=
n.AFrameworkApplication.ha.Ma("PptEditingUserId");Eb.a.wb(Y)&&(Y=n.AFrameworkApplication.ha.Ma("LoggableUserId"),e.ULS.sendTraceTag(512496071,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",Eb.a.wb(Y)));return Y}p$n(){if(this.na.Qpm){var Y=this.JYa.getTraceRequestMetadata(),Sa=this.q8.getTraceRequestMetadata(),Mb=this.na.EKb.replace("wss","https");if(Mb&&Mb.length){var oc=String.format("{0}SpeechHandler.ashx?action=SendTraceRequest",Mb);Mb=new XMLHttpRequest;Mb.open("POST",
oc,!0);oc=Yb.a.create().toString();Mb.setRequestHeader("X-Correlation",oc);try{e.ULS.sendTraceTag(512496069,822,50,"SendPPTCastTraceRequest: Sending request with CorrelationId:{0}",oc);const Oc=this.getTraceRequestMetadata(Y,Sa);Mb.send(de.c(Oc))}catch(Oc){e.ULS.sendTraceTag(512496068,822,10,"SendPPTCastTraceRequest failed. CorrelationId:{0}",oc)}}else e.ULS.sendTraceTag(512496070,822,10,"SendPPTCastTraceRequest failed: unable to retrieve basePPTCastUrl.")}}mKb(){this.n7m();this.r8b=3;this.JYa.stopSession();
this.Z$j.hideCoachFREAndWelcomeUI();this.q8.hideCoachUI();this.bpk=this.q$j=!1;try{this.JYa.getSessionSummary(Y=>{Y.timeSpentInSeconds=this.lOg;this.la.Eb(tb.a.nSf,2);this.la.Eb(tb.a.jSf,2);window.clearInterval(this.Ugm);this.ock&&this.kOg.instance.Voc(Y,this.Pwa,this.Apd,this.$kk,()=>{this.p$n()})})}catch(Y){e.ULS.sendTraceTag(512496067,822,10,"OnSlideshowExitHandler - getSessionSummary failed. Exception:{0}",Y)}}Akn(){let Y=",visionFace";this.na.erm&&(Y+=","+sg.Hoo+","+sg.Goo);this.na.grm&&(Y+=
","+sg.Joo+","+sg.Ioo);this.na.drm&&(Y+=","+sg.Doo+","+sg.Eoo+","+sg.Foo);return sg.epo+(pl(this.Apd,sg.b8i)?","+sg.b8i:"")+","+sg.C$n+","+sg.n3m+","+sg.BVn+","+sg.DYn+(this.na.qJk&&pl(this.Apd,sg.cwj)?","+sg.cwj:"")+(this.na.MFk&&pl(this.Apd,sg.Hsk)?","+sg.Hsk:"")+(this.na.nBb&&pl(this.Apd,sg.fFm)?Y:"")+(this.na.Aze&&pl(this.Apd,sg.sNk)?","+sg.sNk:"")+(this.na.zze&&pl(this.Apd,sg.BVi)?","+sg.BVi:"")}Pej(Y,Sa,Mb){const oc=new Zn;oc.disabledCoachRealtimeFeatures="";oc.userSessionId=n.AFrameworkApplication.userSessionId;
var Oc=new $n;Oc.docId=n.AFrameworkApplication.Fh;Oc.podsSessionId=this.pb.podSessionId;Oc.userDataCenterClusterId=this.pb.Hp;Oc.webServiceBase=this.na.ym;oc.documentDownloadConfig=Oc;Oc=new pi.a;oc.logger=Oc;Oc={};Oc.currentSlideIndex=Y.currentSlideIndex.toString();oc.customSettings=Oc;oc.fEnableServiceSideAggregationForCoach=this.na.nrd;oc.httpTimeoutForCoachSummaryData=this.na.lrm;oc.fSendClientMetaDataOnSessionStart=this.na.IZl;oc.speechFDBase=this.na.EKb;oc.requestedCoachFeatures=this.Akn();
this.WUf()&&(this.$kk=this.j4.F3l(!0),oc.requestedRehearsalOptOutFeatures=this.$kk);fb.a("RehearsalTimeStampedCritiqueTelemetryEnabled")&&(oc.enableTimeStampedCritiqueTelemetry=!0);oc.entryPoint=Pm[this.Ykk];oc.fEnableVision=this.Pwa;oc.fEnableVision&&Sa&&Mb&&(oc.webcamConfig=Object.assign(new dl,{videoView:Sa,workingCanvas:Mb,numFramesPerSecond:this.na.u3e,webcamFrameWidth:this.na.irm}));oc.supportedRehearsalTemplates=this.q8.getSupportedRehearsalTemplates();fb.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&
this.Ydm&&(oc.audioInputDeviceCount=this.tqg);Y=de.b(n.AFrameworkApplication.ha.appSettings.SessionStartInfoJson.toString());oc.userId=this.getUserId();oc.tenantId=n.AFrameworkApplication.ha.Ma("TenantId");oc.identityProvider=this.na.hostAuthType||n.AFrameworkApplication.ha.Ma("HostAuthType")||"Unknown";oc.audienceChannel="";oc.audienceGroup=Y.Ring||"Unknown";oc.buildVersion=n.AFrameworkApplication.buildVersion||"Unknown";oc.locale=this.na.EAb||"Unknown";oc.wacHost=Y.Host||"Unknown";oc.wacDatacenter=
Y.WACDatacenter||"Unknown";oc.sourceLanguage=this.na.eLi||Wm(this.na.Vdc);H.a.$(512496066,822,50,"getCoachSessionConfig: Language values are PodsUICulture: {0}, RegionalSettingsUserLanguage: {1}.",this.na.EAb,this.na.Vdc);return oc}cfn(){const Y=new Yn;Y.rootContainer=this.R3b;Y.zIndex=sg.wtm;Y.imagesBaseFilePath=n.AFrameworkApplication.ha.Ma("CoachImagesBaseFilePath");return Y}bfn(Y){const Sa=new bm;Sa.rootContainer=this.R3b;Sa.slideState=Y;Sa.imagesBaseFilePath=n.AFrameworkApplication.ha.Ma("CoachImagesBaseFilePath");
Sa.zIndex=sg.wtm;Sa.fEnableVision=this.Pwa;Sa.fShowRealtimeFeedbackEnabledCheckbox=this.na.Ppm;Sa.fUseNewRealtimePanel=this.na.Hrd;Sa.fUseCountdownWelcomeScreen=n.AFrameworkApplication.ha.getBooleanAppSetting("PptCoachEnableCountdownWelcomeUI");Sa.speechFDBase=Vm(this.na.EKb);Sa.fDontShowTooltips=Na.a.Yf;Sa.fUseNewRealtimeCheckbox=fb.a("UseNewRealtimeCheckbox");return Sa}wmo(){2!==this.r8b&&(this.lOg+=1,this.q8&&this.q8.updateTimer(this.lOg))}J4n(){this.q8.on("CoachSessionStarted",()=>{this.r8b=1;
this.Ugm=window.setInterval(Object(h.a)(this,this.wmo,"updatePresentationTimer"),1E3);this.JYa.enableVoiceStreaming();this.hfo();this.ock=!0});this.q8.on("CoachSessionPaused",()=>{this.r8b=2;this.JYa.pauseSession();this.LXb()&&this.Hv.instance.hide()});this.q8.on("CoachSessionResumed",()=>{this.r8b=1;this.JYa.resumeSession()})}K4n(){this.JYa.on("SpeechRecognitionStarted",()=>{this.jck&&this.LXb()&&(this.Hv.instance.hide(),this.jck=!1)});this.JYa.on("PPTCoachRealtimeNotification",Y=>{this.hon(Y)});
this.JYa.on("QualityStatusChanged",Y=>{this.epn(Y)});this.JYa.on("MediaStatusChanged",Y=>{this.Non(Y)});this.JYa.on("Error",Y=>{this.handleError(Y)});this.JYa.on("ConnectionRetry",()=>{this.zon()})}zon(){this.jck=!0;this.LXb()&&this.Hv.instance.show(sg.B1l,lj.a.eKb)}hon(Y){this.q8.updateCoachRealtimeNotification(Y)}handleError(Y){Y=Object(G.a)(String,Y);this.r8b=4;Y?Y.startsWith("ErrorAudio")?(this.q8&&this.q8.showCoachDisabledUI(0),this.LXb()&&this.Hv.instance.show(sg.n_l,lj.a.eKb)):Y.startsWith("ErrorVideo")?
(this.q8&&this.q8.showCoachDisabledUI(1),this.LXb()&&this.Hv.instance.show(sg.p_l,lj.a.eKb)):H.a.$(512496064,822,10,"RehearsalManager::handleError unhandled errorInfo"):H.a.$(512496065,822,10,"RehearsalManager::handleError errorInfo null")}lBm(){this.q8&&(this.Pwa&&this.q8.enableCoachVideoUI(),this.q8.showCoachRealtimeUI(this.Shm));this.LXb()&&this.Hv.instance.show(sg.WXl,lj.a.Gse)}Non(Y){"AudioDeviceConnected"===Y.mediaStatus?(this.q$j=!0,this.Pwa&&!this.bpk||this.lBm()):"VideoSetupCompleted"===
Y.mediaStatus&&(this.bpk=!0,this.q$j&&(this.q8&&this.q8.enableCoachVideoUI(),this.lBm()))}epn(Y){if(this.na.FFa){var Sa=Y.severity,Mb=Y.shortCode;if(0<Mb&&Mb<sg.ZSl&&sg.gea[Mb])switch(Sa){case 0:this.LXb()&&this.Hv.instance.hide();break;case 1:(Y=0<Mb?sg.gea[Mb]:Y.shortString)&&this.LXb()&&this.Hv.instance.show(Y,lj.a.$pd);break;case 2:(Y=0<Mb?sg.gea[Mb]:Y.shortString)&&this.LXb()&&this.Hv.instance.show(Y,lj.a.eKb)}else H.a.$(512496035,822,10,"onQualityStatusChanged: Invalid short code")}}LXb(){return this.na.FFa&&
this.Hv&&this.Hv.instance&&2!==this.r8b?!0:!1}hfo(){this.LXb()&&(this.Hv.instance.show(sg.XXl,lj.a.Gse),this.Dpd=window.setTimeout(Object(h.a)(this,this.Kag,"hideSoundReminderNotification"),3E3))}Kag(){this.LXb()&&(window.clearTimeout(this.Dpd),this.Hv.instance.hide())}WUf(){return this.na.o5c&&!!this.j4}UZj(){return this.WUf()?this.pem:!0}Zmm(){this.pem=!0;this.Pwa=this.j4.W6i;fb.a("PollToRefreshCoachEntryPointOnRibbon")&&this.Gy&&this.Gy.JC()}}Object(c.a)(ao,"RehearsalManager",null,[752]);class Bn{constructor(Y,
Sa,Mb){this.xn=Y;this.la=Sa;this.na=Mb}Voc(Y,Sa,Mb,oc,Oc){try{const Zd=document.createElement("div");Zd.id="SummaryPageOverlay";Zd.style.width="100%";Zd.style.height="100%";Zd.style.zIndex="999";Zd.style.display="flex";Zd.style.flexDirection="column";Zd.style.justifyContent="center";Zd.style.position="absolute";var nd=document.getElementById("SummaryPageOverlay");nd&&document.body.removeChild(nd);document.body.insertBefore(Zd,document.body.firstChild);const we=Zd.parentNode;bc.a.addHandler(we,Z.a.oi,
Object(h.a)(this,this.Imm,"onParentNodeKeyDownHandler"));var Cd=Y.thumbIndices;if(Cd){nd={};let eg=0;const zg=this.Hln(Cd);for(let yh=0;yh<Cd.length;yh++)nd[Cd[yh].toString()]=zg[yh],zg[yh]||eg++;H.a.$(507843151,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: number of slide thumbs requested = {0}, number of slides not found in cache = {1}",Cd.length,eg);Y.slideImageSrcs=nd}else Y.slideImageSrcs={},H.a.$(507843150,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: no slide thumbs object from Rehearsal");
const Qe=n.AFrameworkApplication.Ny;Qe||H.a.$(507843149,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback card is dsiabled");Mb||(Mb=tm(this.na,this.na.Vdc));Cd={};const kf=de.b(n.AFrameworkApplication.ha.appSettings.SessionStartInfoJson.toString()).WACSessionID;Cd.fFeedbackCardEnabled=this.na.Rpm&&Qe;Cd.fShowFeedbackButton=Qe;Cd.fMonotoneEnabled=this.na.MFk&&pl(Mb,sg.Hsk);Cd.fGrammarEnabled=this.na.qJk&&pl(Mb,sg.cwj);Cd.fFillersCardEnabled=pl(Mb,sg.b8i);Cd.locale=this.na.Vdc;Cd.fPronunciationCardEnabled=
this.na.Aze&&pl(Mb,sg.sNk);Cd.fCrutchWordCardEnabled=this.na.zze&&pl(Mb,sg.BVi);Cd.fVisionEnabled=Sa&&this.na.hrm&&this.na.nBb;const Vf=im(this.na,this.na.Vdc);Eb.a.wb(Vf)||(Cd.fPacingGaugeRange=Vf);Eb.a.wb(kf)||(Cd.clientSessionId=kf);this.na.o5c&&(Cd.rehearsalOptOutFeatures=oc);(new rehearsalSummaryPage.RehearsalSummaryPageController(Zd,Y,()=>{H.a.$(507843148,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Try Again button clicked.");Oc&&Oc();this.la&&(Zd.parentNode.removeChild(Zd),this.la.Ra(tb.a.tZa,
2,{entryPoint:3}))},()=>{Oc&&Oc();bc.a.removeHandler(we,Z.a.oi,Object(h.a)(this,this.Imm,"onParentNodeKeyDownHandler"))},this.na.ym,decodeURIComponent(this.na.Oqd),()=>{this.teo()},Cd,Vm(this.na.EKb),"Web",()=>{this.geo()})).renderSummaryPage()}catch(Zd){H.a.$(507843146,817,10,"RehearsalSummaryPageHelper::ShowRehearsalSummary Exception while generating summary page: {0}",Zd.toString())}}Imm(Y){"MainApp"===Y.target.id&&(Y.preventDefault(),Y.stopPropagation())}geo(){H.a.$(507843145,817,50,"RehearsalSummaryPageHelper::ShowCoachSettingsTaskPane: Rehearsal opt out card clicked.");
this.la&&this.na.o5c&&this.la.Ra(tb.a.Unh,2,null)}teo(){H.a.$(507843144,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback button clicked.");this.la&&(this.na.Kqm?this.la.Ra(tb.a.EWk,2,null):this.la.Ra(r.a.K7,2,!1))}Hln(Y){const Sa=Array(Y.length);if(!this.xn)return Sa;const Mb=this.xn.ZK(),oc=this.xn.dgb();for(let Oc=0;Oc<Y.length;Oc++){const nd=oc[Mb[Y[Oc]].sid.toString()];nd&&nd.thumbnailImage.length&&(Sa[Oc]=nd.thumbnailImage)}return Sa}}Object(c.a)(Bn,"RehearsalSummaryPageHelper",
null,[]);class Cn{constructor(Y,Sa,Mb,oc,Oc){this.vod=!1;this.xa=new Zb.a;this.la=Y;this.G_e=new Bn(Sa,this.la,oc);this.bhk=Mb;this.zTh=Oc}Kb(){this.la.Ba(tb.a.Voc,Ta.a.application,Object(h.a)(this,this.kfo,"showSummaryPage"));this.la.Ba(tb.a.EWk,Ta.a.application,Object(h.a)(this,this.weo,"showFloodgateSurvey"))}Voc(Y,Sa,Mb,oc,Oc){this.G_e.Voc(Y,Sa,Mb,oc,Oc)}kfo(Y,Sa,Mb,oc,Oc){switch(Mb){case 2:return this.G_e.Voc(Oc,!1,null,null,null),32;case 1:if(this.vod)return 32;break;default:H.a.$(509117593,
822,10,"ShowSummaryPage: Unimplemented action behavior")}return 8}weo(Y,Sa,Mb){switch(Mb){case 2:return this.zTh.execute(oc=>{oc.DEb("PPTRehearsePresentationSurvey","PowerPointRehearsePresentationSurveyEnabled")}),32;case 1:if(this.vod)return 32;break;default:H.a.$(509117592,822,10,"ShowFloodgateSurvey: Unimplemented action behavior")}return 8}Dce(){const Y=Date.now();this.bhk("rehearsalSummaryPage").then(()=>{const Sa=n.AFrameworkApplication.ha.Ma("RehearsalSummaryPageCssUrl"),Mb=document.createElement("link");
Mb.setAttribute("rel","stylesheet");Mb.setAttribute("type","text/css");Mb.setAttribute("href",Sa);$addHandler(Mb,"load",()=>{this.vod=!0;this.xa.raiseEvent("OnRehearsalSummaryResourcesLoaded",new Sys.EventArgs);H.a.$(509117591,817,50,"RehearsalSummaryPage: Loading time: {0}ms",Date.now()-Y)});document.body.appendChild(Mb);return null})}vVm(Y){this.xa.addHandler("OnRehearsalSummaryResourcesLoaded",Y)}C6n(Y){this.xa.removeHandler("OnRehearsalSummaryResourcesLoaded",Y)}}Object(c.a)(Cn,"RehearsalSummaryPageActor",
null,[750]);class bo{constructor(Y,Sa,Mb,oc,Oc){this.A$l=this.r9l=!1;this.la=Y;this.Ea=Sa;this.Zkk=Mb;this.kOg=oc;this.Omc=Oc;this.Zkk.execute(nd=>{nd.hVm(Object(h.a)(this,this.klm,"onCoachResourcesLoaded"))});this.kOg.execute(nd=>{nd.vVm(Object(h.a)(this,this.anm,"onRehearsalSummaryResourcesLoaded"))})}dispose(){this.Zkk.instance&&this.Zkk.instance.u6n(Object(h.a)(this,this.klm,"onCoachResourcesLoaded"));this.kOg.instance&&this.kOg.instance.C6n(Object(h.a)(this,this.anm,"onRehearsalSummaryResourcesLoaded"))}klm(){this.r9l=
!0;this.bDm()}anm(){this.A$l=!0;this.bDm()}bDm(){this.r9l&&this.A$l&&Db.a.get_instance().Ai(10,null).continueWith(()=>{if(this.Ea.Zhl&&this.Ea.crm){const Y=document.getElementById("rehearsal-loading-dialog-modal");Y?(Y.style.display="none",H.a.$(507843080,822,50,"Rehearsal Trigger: Hide rehearsal loading dialog")):H.a.$(507843079,822,10,"Rehearsal Trigger: Rehearsal deep link session triggered with no loading dialog element")}if(32===this.la.Eb(tb.a.tZa,1))if(this.Ea.Zhl)this.la.Ra(tb.a.tZa,2,{entryPoint:5});
else if(!this.Ea.isCreateNew&&this.Ea.lKk&&this.Ea.Lqm)try{this.Omc.continueWith(()=>{this.Omc.result.logActivity("HasCoachInPresentDropDownSeen","PPTCoachInPresentDropDownTeachingUIEnabled")}),H.a.$(507843078,822,50,"Rehearsal Trigger: Teaching UI triggered for Coach in Present Drop Down")}catch(Y){H.a.$(507843077,822,10,"Rehearsal Trigger: Exception thrown when trying to trigger teaching UI. Exception: {0}",Y)}})}}Object(c.a)(bo,"RehearsalTrigger",null,[753]);class Di{constructor(){this.ga=this.j4=
null}get name(){return"PowerPointWebEditor.Rehearsal"}m2m(){this.ga.register(750,"PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").oa().pa(()=>new Cn(n.AFrameworkApplication.ub,this.ga.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),mk.a(this.ga),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.eb("Common.ISystemInitiatedFeedback")));this.ga.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").Kb()}oc(Y){this.ga=Y;this.ga.eb("PowerPointWebEditor.IThumbnailDataStoreManager").execute(()=>
{this.m2m()});if(this.ga.resolve("PowerPointWebEditor.IApplicationSettings").EFa){this.ga.register(751,"PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings").oa().pa(()=>new yn(n.AFrameworkApplication.$d,this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.ga.resolve("Common.IActionManagerExtended")));this.j4=this.ga.resolve("PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings");const Sa=this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame");
this.ga.register(752,"PowerPointWebEditor.Rehearsal.IRehearsalManager").oa().pa(()=>new ao(n.AFrameworkApplication.ub,Sa,this.ga.resolve("Common.IDynamicScriptLoaderProvider"),this.ga.resolve("PowerPointWebEditor.ISlideshowFrame"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),vb.a.instance.eb("PowerPointWebEditor.ISlideShowVoiceNotification"),
vb.a.instance.eb("PowerPointWebEditor.ISlideshowToolbar"),vb.a.instance.eb("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),this.j4,this.ga.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.ga.resolve("PowerPointWebEditor.IRibbonUser")));this.ga.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").Kb();this.ga.register(753,"PowerPointWebEditor.Rehearsal.IRehearsalTrigger").oa().pa(()=>new bo(n.AFrameworkApplication.ub,this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),
vb.a.instance.eb("PowerPointWebEditor.Rehearsal.IRehearsalManager"),vb.a.instance.eb("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),lf.a.kH(vb.a.instance.eb("Common.ISystemInitiatedFeedback"))));this.ga.resolve("PowerPointWebEditor.Rehearsal.IRehearsalTrigger")}}init(){n.AFrameworkApplication.ha.Wf(Object(h.a)(this,this.uu,"onFullAppSettingsReady"))}uu(){this.ga.resolve("PowerPointWebEditor.IApplicationSettings").Qkg&&Db.a.get_instance().Ai(7,()=>{this.ga.eb("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").execute(()=>
{this.initialize()})})}initialize(){this.ga.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").Dce();this.ga.resolve("PowerPointWebEditor.IApplicationSettings").EFa&&this.ga.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").Dce();if(this.ga.resolve("PowerPointWebEditor.IApplicationSettings").o5c){const Y=new en(mk.a(this.ga),this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.j4,this.ga.resolve("PowerPointWebEditor.IApplicationSettings"));
Y.Kb();Y.Ae();this.j4.rvn()}}dispose(){}static main(){b.a.instance.Jc(new Di)}}Object(c.a)(Di,"PPTWebEditorRehearsalPackage",null,[4,5]);class Qm{static yqb(Y){try{return caches.open(Qm.UIl).then(Sa=>Sa.match(Y))}catch(Sa){return Promise.reject(null)}}static jld(Y,Sa){try{return Qm.yqb(Y).then(Mb=>Mb&&Number.parseInvariant(Mb.headers.get("cachedTime"))>Date.now()-Sa?Promise.resolve(Mb.text().toLocaleString()):Promise.reject("Not found")).catch(()=>Promise.reject("Cache returned undefined"))}catch(Mb){return Promise.reject(null)}}static store(Y,
Sa){try{return caches.open(Qm.UIl).then(Mb=>{Mb.put(Y,Sa).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch(Mb){return Promise.resolve(!0)}}static iho(Y,Sa){const Mb={};Mb.body=Sa;const oc={};oc.cachedTime=Date.now().toString();Mb.headers=oc;Sa=new Response(Sa,Mb);Qm.store(Y,Sa).then(()=>!0)}}Qm.UIl="ConsentState";Object(c.a)(Qm,"CacheManager",null,[]);class Dn{constructor(){this.message=null;this.httpStatusCode=0}}Object(c.a)(Dn,"HttpRequstToPromiseRejectData",null,[]);class kn{constructor(Y){this.hHb=
Y}Xub(Y,Sa,Mb,oc,Oc,nd){k.a.sendTelemetryEvent(Object.assign(new v.a,{name:"Office.Online."+Y,dataFields:[Object.assign(new x.a,{name:"EventMessage",string:Sa}),Object.assign(new x.a,{name:"FormFactor",string:this.hHb.formFactor}),Object.assign(new x.a,{name:"CorrelationId",string:this.hHb.correlationId}),Object.assign(new x.a,{name:"AccountType",string:this.hHb.accountType}),Object.assign(new x.a,{name:"OSVersion",string:this.hHb.osVersion}),Object.assign(new x.a,{name:"AppId",string:this.hHb.appId}),
Object.assign(new x.a,{name:"ConsentSurface",string:"AppStart"}),Object.assign(new x.a,{name:"ConsentLanguage",string:this.hHb.consentLanguage}),Object.assign(new x.a,{name:"EventCode",string:Mb}),Object.assign(new x.a,{name:"Region",string:this.hHb.region}),Object.assign(new x.a,{name:"ModelType",string:oc}),Object.assign(new x.a,{name:"ModelId",string:Oc}),Object.assign(new x.a,{name:"Platform",string:this.hHb.os}),Object.assign(new x.a,{name:"ReConsentReason",string:""}),Object.assign(new x.a,
{name:"ConsentType",string:nd})]}))}}Object(c.a)(kn,"TelemetryLogger",null,[]);class zm{constructor(Y,Sa,Mb){this.QMm="https://consent.config.office.com/consentcheckin/v1.0/consents";this.Ga=Y;this.Dn=Sa;this.Hhd=Mb;this.MLa=new kn(Mb)}P2(Y,Sa){return new Promise((Mb,oc)=>{const Oc=this.Ga.Ac("UCNoticeCheckinCallTimeoutMs",5E3);let nd=this.Ga.Ma("UCNoticeCheckinStateUrl");nd&&nd.length||(nd=this.QMm);this.Dn.lZ(nd,1,null,this.Vqb(Y),null,!1,0,Cd=>{try{if(void 0===Cd||null===Cd||void 0===Cd.data||
null===Cd.data||void 0===Cd.data.responseData||null===Cd.data.responseData){this.MLa.Xub("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);const we=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");oc(this.m3(we,Cd))}else if(Cd.data.Je!==Xe.a.KB){this.MLa.Xub("UnifiedConsent.ConsentGetFailed","CheckInApi : HTTP failure",Cd.data.Je.toString(),
null,null,null);const we=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Cd.data.Je,"UnifiedConsent.ConsentGetFailed");oc(this.m3(we,Cd))}else{var Zd=Sa(Cd.data.responseData);if(Zd)Mb(Zd);else{this.MLa.Xub("UnifiedConsent.ConsentGetFailed","CheckInApi : Consent values are empty","712",null,null,null);const we=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
"UnifiedConsent.ConsentGetFailed");oc(this.m3(we,Cd))}}}catch(we){this.MLa.Xub("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure","713",null,null,null),Zd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",we,"UnifiedConsent.ConsentGetFailed"),oc(this.m3(Zd,Cd))}},Cd=>{this.MLa.Xub("UnifiedConsent.ConsentGetFailed","CheckInApi : Error in service call ",Cd.data.Je.toString(),null,null,null);const Zd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",
Cd.data.Je,"UnifiedConsent.ConsentGetFailed");oc(this.m3(Zd,Cd))},null,void 0,void 0,2500,Oc)})}m3(Y,Sa){const Mb=new Dn;Mb.message=Y;Mb.httpStatusCode=Sa&&Sa.data?Sa.data.Je:-1;return Mb}Vqb(Y){const Sa={};Sa["Accept-Language"]=this.Hhd.consentLanguage;Sa.consentsurface="AppStart";Sa.platform="Web";Sa.formfactor=Na.a.Rlc?"Mobile":"Desktop";Sa["x-Cid"]=this.Hhd.correlationId;Sa.Authorization="Bearer "+Y;return Sa}}Object(c.a)(zm,"HttpRequestToPromiseUtility",null,[]);class Rm{constructor(){this.accountType=
"MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(c.a)(Rm,"WebSdkAdapterProps",null,[]);class Jk{constructor(Y,Sa,Mb,oc){this.HKl=this.Rqc=this.Ceb=this.eHb=null;this.aWn=Oc=>{if(void 0===Oc||null===Oc)return this.MLa.Xub(Jk.dCd,"Checkin response undefined or null",
"705",this.eHb,this.Ceb,this.Rqc),null;try{const {NB:nd}=de.d(Oc);return nd}catch(nd){this.MLa.Xub(Jk.dCd,"Checkin response parse error : "+nd.message,"706",this.eHb,this.Ceb,this.Rqc)}return null};this.FRe=oc;this.Ga=Y;this.pMm=Mb;this.Dn=Sa;this.Hhd=this.PYd();this.MLa=new kn(this.Hhd)}zzm(){"MSA"===(this.Ga.Ma("HostAuthType")||"").toUpperCase()&&Qm.jld(this.Hhd.userId,this.Ga.Ac("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.MLa.Xub(Jk.dCd,"CacheFound","701",this.eHb,this.Ceb,this.Rqc);return{}}).catch(()=>
{this.pMm.execute(Y=>{Y.hP("Consent",Jk.RRm).then(Sa=>{Sa.IsSuccess?(this.MLa.Xub(Jk.dCd,"CheckInTokenSuccess","702",this.eHb,this.Ceb,this.Rqc),this.sfn(Sa.Token).then(Mb=>{this.Uin(Mb);this.eHb&&""!==this.eHb&&Y.hP("Consent",Jk.SRm).then(oc=>{oc.IsSuccess?(this.MLa.Xub(Jk.dCd,"WebTokenSuccess","703",this.eHb,this.Ceb,this.Rqc),this.Ueo(oc,this.eHb)):this.MLa.Xub(Jk.dCd,"WebTokenFailed : "+oc.ErrorMessage,oc.ErrorCode,this.eHb,this.Ceb,this.Rqc);return{}});return{}})):this.MLa.Xub(Jk.dCd,"CheckInTokenFailed : "+
Sa.ErrorMessage,Sa.ErrorCode,this.eHb,this.Ceb,this.Rqc);return{}})})})}sfn(Y){this.HKl=new zm(this.Ga,this.Dn,this.Hhd);return this.HKl.P2(Y,this.aWn).then(Sa=>Promise.resolve(Sa),Sa=>Promise.reject("Error while getting result"+Sa))}Uin(Y){for(const Sa of Y.consentValues)if(Sa.needConsent&&!Sa.maxPromptsReached){this.Ceb=Sa.id;this.Rqc=Sa.consentType;this.eHb=Sa.modelType;return}Qm.iho(this.Hhd.userId,de.c(Y))}Ueo(Y,Sa){if(Gc.a("showConsentNotice")){const Mb=document.createElement("div");document.body.appendChild(Mb);
appChrome.api.showConsentNotice(this.tgn(Y.Token,Sa),Mb)}else this.MLa.Xub(Jk.fPm,"1JS : ShowConsentNotice API not found","704",this.eHb,this.Ceb,this.Rqc)}tgn(Y,Sa){const Mb=this.Hhd;Mb.token=Y;Mb.modelType=Sa;return Mb}PYd(){const Y=this.ncg(this.Ga.Ma("SessionStartInfoJson"));return Object.assign(new Rm,{emailId:this.Ga.Ma("UserPrincipalName"),userId:this.Ga.Ma("LoggableUserId"),accountType:"AAD"===(this.Ga.Ma("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.Ga.Ma("OfficeApplicationId"),
appVersion:this.Ga.Ma("appVersion"),appName:"Application"in Y?Y.Application:"",appEnv:this.FRe,consentLanguage:this.Ga.Ma("UICulture")||"en-US",formFactor:Na.a.Rlc?"Mobile":"Desktop",os:"Os"in Y?Y.Os:"",osVersion:"OsVersion"in Y?Y.OsVersion:"",region:this.Ga.Ma("region"),correlationId:Yb.a.create().toString(),isDarkMode:this.Ga.getBooleanAppSetting("DarkModeIsOn"),useCache:!0})}ncg(Y){let Sa={};try{Sa=de.b(Y)}catch(Mb){}return Sa}}Jk.SRm="https://consentservice.microsoft.com/web";Jk.RRm="https://consentservice.microsoft.com/checkin";
Jk.fPm="UnifiedConsent.ConsentGetFailed";Jk.dCd="UnifiedConsent.AuthTokenStatus";Object(c.a)(Jk,"ConsentNoticeManager",null,[808]);class Hm{constructor(){this.Oa=null}get name(){return"Common.App.ConsentNoticeDialog"}oc(Y){this.Oa=Y;Y.register(Jk,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").oa().pa(()=>new Jk(n.AFrameworkApplication.ha,n.AFrameworkApplication.$d,Object(om.a)(),n.AFrameworkApplication.Qkc))}init(){vb.a.instance.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){b.a.instance.Jc(new Hm)}}
Object(c.a)(Hm,"ConsentNoticeDialogPackage",null,[4,5]);var Xm;(function(Y){Y[Y.Log=0]="Log";Y[Y.EGm=1]="ClientCount"})(Xm||(Xm={}));Object(c.b)("MessageType",Xm);var Am;(function(Y){Y[Y.YJm=0]="ReadyToReceiveMessages";Y[Y.RJm=1]="QueryWaitingClients";Y[Y.gGm=2]="ActivationSignal"})(Am||(Am={}));Object(c.b)("ClientRequestType",Am);var Bm;(function(Y){Y[Y.Info=0]="Info";Y[Y.Error=1]="Error";Y[Y.Warning=2]="Warning"})(Bm||(Bm={}));Object(c.b)("LoggingLevel",Bm);class Qk{constructor(Y){this.BGn="/pods/pptsw.ashx";
this.rpn=(Sa,Mb)=>{Sa.addEventListener("updatefound",()=>{e.ULS.sendTraceTag(507605647,801,50,`ServiceWorkerManager.handleServiceWorkerUpdate: Installing new SW, this page was loaded with SW:${!!Mb}`);const oc=Sa.installing;null!=oc&&(oc.onstatechange=()=>{"installed"===oc.state&&this.oxm()})});Sa.active&&Sa.waiting&&this.oxm()};this.Cmo=Sa=>{Object(Rj.b)(this,void 0,void 0,function*(){var Mb,oc;if(0==Sa.HWn){const Oc=((yield null===(Mb=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||
void 0===Mb?void 0:Mb.getRegistrations())||[]).find(nd=>nd.waiting);Mb={["clientRequestType"]:Am.gGm};null===(oc=null===Oc||void 0===Oc?void 0:Oc.waiting)||void 0===oc?void 0:oc.postMessage(Mb)}e.ULS.sendTraceTag(507594304,801,50,`ServiceWorkerManager.updateSWIfApplicable: pendingClientCount ${Sa.HWn}`)})};this.oxm=()=>{var Sa;const Mb={["clientRequestType"]:Am.RJm,["data"]:""};null===(Sa=navigator.serviceWorker.controller)||void 0===Sa?void 0:Sa.postMessage(Mb)};this.yPn=()=>{var Sa;const Mb={["clientRequestType"]:Am.YJm,
["data"]:""};null===(Sa=navigator.serviceWorker.controller)||void 0===Sa?void 0:Sa.postMessage(Mb)};this.nWk=(Sa,Mb)=>{null===Sa||void 0===Sa?void 0:Sa.addEventListener("statechange",oc=>{e.ULS.sendTraceTag(507605646,801,50,`ServiceWorkerManager.register: initial state: ${Mb}, state changed to ${oc.target.state}`)})};this.e5n=()=>{navigator.serviceWorker.addEventListener("message",Sa=>{try{const Mb=Sa.data;switch(Mb.messageType){case Xm.Log:this.uCn(Mb);break;case Xm.EGm:this.Cmo(Mb)}}catch(Mb){e.ULS.sendTraceTag(507603107,
801,10,`ServiceWorkerManager.message: failed to parse message, error msg: ${Mb.message}`)}})};this.uCn=Sa=>{Sa.loggingLevel==Bm.Error?e.ULS.sendTraceTag(507605645,801,10,`ServiceWorkerManager.message: ${JSON.stringify(Sa)}`):e.ULS.sendTraceTag(507605644,801,50,`ServiceWorkerManager.message: ${JSON.stringify(Sa)}`)};this.Jb=Y}jWk(){Na.a.uSl&&navigator.serviceWorker.getRegistrations?this.hpn():e.ULS.sendTraceTag(507609371,801,10,"ServiceWorkerManager.registerServiceWorker: ServiceWorker is not supported")}hpn(){const Y=
this.Jb.getBooleanAppSetting("EnableSWRegistration"),Sa=Y?"registration":"unregistration";(Y?this.register():this.unregister()).then(()=>{e.ULS.sendTraceTag(507609373,801,50,`ServiceWorkerManager.handleRegistration: ${Sa} completed`)}).catch(Mb=>{e.ULS.sendTraceTag(507609372,801,10,`ServiceWorkerManager.handleRegistration: ${Sa} failed: ${Mb}`)})}register(){return Object(Rj.b)(this,void 0,void 0,function*(){const Y=navigator.serviceWorker.controller;this.e5n();this.yPn();return navigator.serviceWorker.register(this.BGn).then(Sa=>
{this.nWk(Sa.installing,"installing");this.nWk(Sa.active,"active");this.nWk(Sa.waiting,"waiting");this.rpn(Sa,Y)})})}unregister(){return Object(Rj.b)(this,void 0,void 0,function*(){const Y=yield navigator.serviceWorker.getRegistrations();for(const Sa of Y)return Sa.unregister()})}}Object(c.a)(Qk,"ServiceWorkerManager",null,[]);class Im{constructor(){this.Jb=this.ga=null}get name(){return"PowerPointWebEditor.ServiceWorkerPackage"}oc(Y){this.ga=Y;this.Jb=this.ga.resolve("Common.IAppSettingsManager")}init(){this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.EnablePPTServiceWorkerPackage",
!1)&&this.ga.resolve("PowerPointWebEditor.IAppBootCompletedListener").vra(()=>{this.jWk()})}jWk(){(new Qk(this.Jb)).jWk()}dispose(){}static main(){b.a.instance.Jc(new Im)}}Object(c.a)(Im,"ServiceWorkerPackage",null,[4,5]);var En=a(18);Type.registerNamespace("Box4.Media");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPointLive");Type.registerNamespace("PowerPointVersionHistory");Type.registerNamespace("PowerPointWeb");Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerPointWebEditor.Accessibility");Type.registerNamespace("PowerPointWebEditor.AgendaConverter");Type.registerNamespace("PowerPointWebEditor.Designer");Type.registerNamespace("PowerPointWebEditor.ImageDescription");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.Live");Type.registerNamespace("PowerPointWebEditor.PenMinutes");Type.registerNamespace("PowerPointWebEditor.PresentToTeams");Type.registerNamespace("PowerPointWebEditor.Rehearsal");
Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.StreamVideoPrefetchOrchestratorUtility");Type.registerNamespace("PowerPointWebEditor.Text");Type.registerNamespace("PowerPointWebEditor.VersionHistory");Object(En.c)("Chronos2");Type.registerNamespace("Common.App.AccessibilityChecker");dc.main();Ba.main();Lc.main();Type.registerNamespace("Common.App.AddinCommands");Type.registerNamespace("Common.App.AccessibilitySettings");ld.main();Type.registerNamespace("Common.App.RibbonSettings");
rg.main();Type.registerNamespace("Common.App.DirectPrint");b.a.instance.Jc(new jb);Type.registerNamespace("Common.App.DisplayEnvironmentName");Pb.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.InProductMessaging");Of.main();Type.registerNamespace("Common.App.NewAndOpen.UX");b.a.instance.Jc(new qe);Type.registerNamespace("Common.App.OneDriveFilePickerApi");cg.main();Type.registerNamespace("Common.App.PenMinutesManager");lg.main();Type.registerNamespace("Common.App.SaveAsToHost");
Gg.main();Type.registerNamespace("Common.App.SaveToSharePoint");Hd.main();Type.registerNamespace("Common.App.SaveToCloudStorage");ig.main();Type.registerNamespace("Common.App.SaveACopy");Ah.main();Type.registerNamespace("Common.App.PhoneLink");jg.main();Type.registerNamespace("Common.App.SharedFilePicker");ci.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SearchOAuthManager");di.main();Type.registerNamespace("Common.App.WopiIdentity");Xh.main();Type.registerNamespace("Common.App.AppsForOfficeOauth");
Type.registerNamespace("Common.App.SmartLookup");Type.registerNamespace("Common.App.ConsentNoticeDialog");Hm.main();Sj.main();Ti.main();Ui.main();Vk.main();kk.main();Tg.main();b.a.instance.Jc(wa.a(new Bj,0));Zi.main();Type.registerNamespace("Common.App.LivePersonaUtils");ym.main();Di.main();Im.main();Object(En.b)("Chronos2")},354:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}c.xS="data-copystatus";c.bIa="data-copyfailedreason";c.Rp="data-clipservice-ccpid";c.version="data-clipservice-version";
c.location="data-clipservice-location";c.lD="data-clipservice-dc";c.type="data-clipservice-type";c.cqd="data-clipservice-param";c.count="data-clipservice-count";c.I$="data-clipservice-cut";c.Ewa="data-clipservice-isEmptyPlaceholder";c.client="data-clipservice-client";c.FHh="data-clipboardasbytes-url";c.o8e="wacserver";c.sessionId="data-SessionId";c.bEb="data-ShapeIds";c.slideId="data-SlideId";c.timeStamp="data-TimeStamp";c.tNh="data-willexpire";c.fYe="ClipboardAsImage";c.Jy="data-pkey";Object(y.a)(c,
"ClipServiceConstants",null,[])},372:function(y,C,a){a.d(C,"a",function(){return u});y=a(0);var c=a(1703),b=a(54),d=a(484),e=a(182),h=a(51),n=a(80),m=a(40),k=a(618),l=a(619);class u{constructor(r){this.Fy=r}get node(){return this.Fy}get propertySet(){return this.Fy}get GP(){if(1074135132===this.Fy.Re)return 0;if(1074135137===this.Fy.Re)return 1;m.a.$(508842136,802,10,"Invalid AppType {0}",d.a[this.Fy.Re]);return-1}get id(){return 0===this.GP?this.propertySet.ra(h.a.f7,null)+this.shapeId.toString()+
this.slideId.toString():this.propertySet.ra(h.a.f7,null)}get jJh(){return this.propertySet.ra(b.a.RTe,null)}get visibility(){return this.propertySet.ra(b.a.akc,!1)}get width(){return this.propertySet.ra(b.a.sGh,320)}get row(){return this.propertySet.ra(b.a.rGh,0)}get hOh(){return this.propertySet.ra(e.a.isForUILessAction,!1)}get hJa(){return this.propertySet.ra(b.a.cnb,null)}get version(){return this.propertySet.ra(b.a.dzc,null)}get store(){return this.propertySet.ra(b.a.czc,null)}get storeType(){return this.propertySet.jb(h.a.$jc)}get assetId(){return this.propertySet.ra(h.a.Yjc,
null)}get assetStoreId(){return this.propertySet.ra(h.a.Zyc,null)}get ownerAddinSolutionId(){return this.propertySet.ra(h.a.u2g,null)}get sharedRuntimeId(){return this.propertySet.ra(e.a.sharedRuntimeId,null)}get settings(){const r={};k.a(this.node,(x,v)=>{l.b(v,r)});return r}get slideId(){return 0===this.GP?n.a.Er(this.Fy.jb(h.a.sid),this.Fy.jb(h.a.cid)):null}get shapeId(){const r=Object(c.a)(351,this.Fy);return 0===this.GP&&r?r.get_shapeId():0}get ownerAddinStoreType(){return this.propertySet.ra(h.a.ownerAddinStoreType,
null)}get tXa(){return this.propertySet.ra(h.a.tXa,-1)}get oMa(){return this.propertySet.ra(h.a.oMa,null)}}Object(y.a)(u,"AppReader",null,[990])},376:function(y,C,a){a.d(C,"a",function(){return x});y=a(0);var c=a(64),b=a(206),d=a(1704),e=a(1703),h=a(77);class n{constructor(){this.shapeType=this.k$b=this.Opd=this.fqd=this.eqd=0;this.Im=this.rp=this.xm=this.Pg=!1;this.ffb=null}}Object(y.a)(n,"ShapeProperties",null,[]);var m=a(40),k=a(55),l=a(117),u=a(233),r=a(42);class x{constructor(v,z,A,B,G,w,F,H,
E){this.Do=v;this.il=z;this.La=F;this.Z8b=w.z_h;this.XNg=this.ZLf();this.Zr=A;this.wM=B;this.Ee=G.Ua;this.tCg=w.iWa;this.Xb=E}b2e(v,z,A,B,G,w){w=void 0===w?null:w;if(z){var F=this.La.zOa(A);F&&(Array.remove(A,F),Array.add(A,this.La.Wv(F)));this.oKe(A);var H=A.length;F=Array(H);B=this.Ild(z,B);for(var E=0;E<H;E++){var P=A[E],T=this.K3f(P,B);F[E]=Object.assign(new n,{eqd:T.x,fqd:T.y,Opd:P.Hw,k$b:P.MA,shapeType:P.shapeType,Pg:P.Pg,xm:P.xm||2===P.mediaType||1===P.mediaType,rp:P.gd,Im:P.Im,ffb:""});F[E].Pg&&
(T=Object(e.a)(112,P.yc(this.Ee)),F[E].ffb=T?T.G6e:"",m.a.$(512500632,826,50,"PendingImage: {0}, State: {1}, HasImageId: {2}",P.qLc,this.wM.dY(P),0<F[E].ffb.length))}E=z.fc;P=z.Av();T=[];B=!0;var K=v.Aj===z.Aj,M=v.Gn===z.Gn,N=!1;v!==z&&(K?(N=v.oPa||z.oPa,M||(N=v.gPa||z.gPa||N),B=!N):B=!1,!B||v.To===z.To&&v.xk===z.xk||(B=!1));for(var I=0;I<H;I++)this.Wmh(A[I])||(T.push(A[I]),B&&(B=this.imh(A[I],M)));A=T;m.a.$(512500631,826,50,"{0}",{["LocalRenderEnabled"]:B,["SameSlide"]:v===z,["SameMaster"]:K,["SameLayout"]:M,
["ThemeOverrides"]:N});H=[];I=N=M=K=T=!1;for(let O=0;O<A.length;O++){const Q=F[O],U=this.il.cVe(!1,E.cid,E.sid,Q.eqd,Q.fqd,0,!1,Q.Opd,1>Q.k$b?1:Q.k$b,P+A[O].get_zIndex(),v.id,A[O],Q.shapeType,Q.Pg,Q.ffb,B);c.a.wb(w)||(U.lc=w);H.push(U);T=T||Q.Pg;K=K||Q.xm;M=M||Q.rp;N=N||Q.Im;I=I||this.tCg&&x.Wig(U)}G=x.HEe(T,K,M,N,I,G);if(0<H.length&&(v=B?A:null,this.Do.EO(H,z,G,v),B&&k.a.Bb)){if(v){z="";for(const O of v)z+=this.La.HIb(O)+",";k.a.Bb.Za(l.a.$Hh,z);k.a.Bb.Za(l.a.h_h,v.length.toString())}k.a.Bb.pj=!0;
k.a.Bb.DZa=!0}}}zIh(v,z,A,B,G,w){var F=this.Ild(v,A);A=[];const H=z.fKb,E=!!H&&!b.a.wb(H.Mae);w=this.J3f(w,F);for(F=0;F<z.objectCount;F++){const P=this.il.gIh(!0,v.cid,v.sid,0,w.x,w.y,G);if(Object(r.a)("CutPasteResizeShapeInvisibleFix")){const T=!!H&&!b.a.wb(H.Nae);P.Ge=T&&H.Nae[F]}P.isEditable=E&&H.Mae[F];A.push(P)}0<A.length&&this.Do.EO(A,v,B)}p4f(v){try{const z=atob(v.slice(0,50)).slice(16,24),A=Uint8Array.from(z,G=>G.charCodeAt(0)),B=new DataView(A.buffer);return{width:B.getInt32(0),height:B.getInt32(4)}}catch(z){return m.a.$(508127176,
307,10,"Exception while calculating image dimension. Exception : {0}",z),{width:0,height:0}}}J3f(v,z){const A=z*x.GK;z*=x.GK;var B=new h.a(A,z);v&&(B={width:v.clientWidth,height:v.clientHeight},Object(r.a)("GetPngDimension")&&v.src&&(v=v.src,v=v.slice(22,-1),B=this.p4f(v)),B=this.Xb.dna(B.width,B.height))&&(B.x+=A,B.y+=z);return B}Wmh(v){return v.LA&&this.Z8b||!v.o9d}imh(v,z){return v.qLc||this.wM.dY(v)||v.Bl&&v.hasText&&!z&&10!==v.placeholderType&&12!==v.placeholderType||v.au?!1:!0}oKe(v){v.sort((z,
A)=>z.get_zIndex()-A.get_zIndex())}QOh(v){return v?this.XNg.contains(v):!1}Ild(v,z){if(!v)return 0;if(!z)return x.bEf;let A,B;return z.fa(A=v.fc,(B=z.ka(A))+1),B}K3f(v,z){var A=this.Zr.presentation;if(!A)throw Error.argumentNull("Presentation is null");let B=v.iy,G=v.jy;v=A.mMh(A.$C(v.slideId));A=Math.round(x.GK/v)*v;v=d.a.Bf(A,0);for(A=d.a.Bf(A,1);0<z;)B+=v,G+=A,z--;return new h.a(B,G)}M1h(v){try{if(v&&v.clipboardData){const z=v.clipboardData.types;for(let A=0;A<z.length;A++){const B=v.clipboardData.getData(z[A]);
if(this.Ieg(B))return B}}}catch(z){}return null}Ieg(v){return!!v&&0<v.length&&this.clg(v)}clg(v){v=v.trim().toLowerCase();return v.startsWith("http:")||v.startsWith("https:")}KZh(v,z,A){v&&(v.setAttribute(x.Uid,z.toString()),v.setAttribute(x.Tid,A.toString()),v.setAttribute(x.Wid,"true"))}ZLf(){const v=new u.a;v.add("param");v.add("map");v.add("area");v.add("script");v.add("noscript");v.add("col");v.add("colgroup");v.add("caption");v.add("head");v.add("title");v.add("link");v.add("meta");v.add("style");
v.add("base");v.add("input");v.add("textarea");v.add("select");v.add("option");v.add("optgroup");v.add("button");v.add("hr");return v}ILh(v){return this.Jtd(v,x.Uid)}GLh(v){return this.Jtd(v,x.Tid)}dhg(v){return v?"true"===v.getAttribute(x.Wid):!1}L1h(v){if(this.Wae(v)){const z=v.indexOf('"')+1,A=v.lastIndexOf('"');if(1<z&&A>z&&(v=v.slice(z,A),v.startsWith(x.gEf)))return v}return null}Wae(v){return!!v&&v.length>x.qEf&&v.startsWith(x.hEf)}Jtd(v,z){let A=0;this.dhg(v)&&(A=parseFloat(v.getAttribute(z)));
return isNaN(A)?0:A}Zid(v){return this.AAc(v).returnValue}AAc(v){let z;z=2;let A=0,B=0,G=0,w=0,F=0,H=0,E=0,P=0,T=0,K=0,M=0,N=0,I=0,O=0,Q=0,U=0,ba=0;for(const aa of v)aa.gd?(z=2===z?6:20,A++):aa.xg?(z=2===z?12:20,B++):aa.Im?(z=2===z?7:20,G++):aa.Ge?(z=2===z?13:20,w++):22===aa.fgb?(z=2===z?10:20,F++):aa.Pg?(z=2===z?5:20,H++):aa.yr?(z=2===z?3:20,E++):aa.Lfa?(z=2===z?14:20,aa.LA&&T++,P++):aa.Bl?(z=2===z?14:20,aa.LA&&M++,K++):aa.Nu?(z=2===z?15:20,N++):aa.ZZ?(z=2===z?16:20,I++):aa.xm?(z=2===z?18:20,O++):
aa.au?(z=2===z?11:20,Q++):aa.a8?(z=2===z?17:20,U++):(z=2===z?4:20,ba++);return{returnValue:String.format("numTotalShapes={0}, numTables={1}, numSmartArt={2}, numCharts={3}, numGroups={4}, numInk={5}, numPictures={6}, numTextbox={7}, numTitlePlaceholder={8}, numEmptyTitlePlaceholder={9}, numNonTitlePlaceholder={10}, numEmptyNonTitlePlaceholder={11}, numLine={12}, numActiveX={13}, numMedia={14}, numAppForOffice={15}, numOleObject={16}, numNormalShape={17}",v.length,A,B,G,w,F,H,E,P,T,K,M,N,I,O,Q,U,ba),
contentType:z}}static dZh(v){for(const z of v)if(!z.o9d||z.isLocal)return!1;return!0}static Wig(v){return v&&4===v.DK?(!v.fill||!!v.fill.noFillField)&&(!v.lineStyle||!!v.lineStyle.noFillField):!1}static HEe(v,z,A,B,G,w){return v||z||A||B||G?w:0}}x.Wid="data-from-ppt-online";x.Uid="data-image-width-mu";x.Tid="data-image-height-mu";x.gEf="data:image/";x.hEf="<img src=";x.qEf=14;x.bEf=1;x.GK=15;Object(y.a)(x,"CopyPasteUtility",null,[898])},496:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);var c;
(function(b){b[b.OK=0]="OK";b[b.gkm=1]="notReady";b[b.EBm=2]="storeDisabled";b[b.V8l=3]="invokeFailure";b[b.Axm=4]="serviceDisabled";b[b.KSl=5]="builtinAddinDetails"})(c||(c={}));Object(y.b)("AddinDetailsQueryError",c)},556:function(y,C,a){a.d(C,"a",function(){return v});y=a(0);var c=a(405),b=a(38),d=a(41),e=a(100),h=a(85),n=a(653),m=a(224),k=a(150),l=a(557),u=a(370),r=a(98),x=a(57);class v{constructor(z,A,B,G,w,F,H,E){this.lFa=(P,T,K,M,N)=>{N&&N.MenuItemId&&(c.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",
{["Id"]:N.SourceControlId,["AppType"]:u.a[this.Z5]}),h.a.Go(N.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};this.Mac=(P,T,K,M,N)=>{if(N&&N.MenuItemId){const I=d.AFrameworkApplication.ha.getBooleanAppSetting("WacInTabOpenMRUIsEnabledForUiHost"),O=d.AFrameworkApplication.ha.getBooleanAppSetting("UiHostSupportsDocRebootFeatures");c.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",I,O);if(I&&O){c.ULS.sendTraceTag(592237458,
202,50,"Opening new tab {0}",{["Id"]:N.SourceControlId,["AppType"]:u.a[this.Z5]});P=N.MenuItemId.toString();const Q={};Q[m.a.Xnc]="1";Q[m.a.documentUrl]=P;Q[m.a.reason]=l.a.open;c.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");d.AFrameworkApplication.ZP().execute(U=>{U.sendMessage(k.a.RXa,Q)})}else this.lFa(P,T,K,M,N)}return 32};this.iIb=()=>{this.Dnd();return 32};this.Aa=z;this.Dn=A;this.ms=B;this.LY=G;this.Ce=w;this.ykb=F;this.phf=H;this.LRb=E}XXh(){this.$Ia.Ba(x.a.lFa,
r.a.frame,this.lFa);this.$Ia.Ba(x.a.Mac,r.a.frame,this.Mac);d.AFrameworkApplication.y5?this.Dnd():this.$Ia.ua(x.a.iIb,r.a.frame,this.iIb,96)}O$(z,A,B){B=void 0===B?"":B;if(A&&A.Oo){const G=n.a[A.status];A=A.Oo.getTime();const w=this.getCurrentTime()-A;c.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:z,["RequestStatus"]:G,["ElapsedMs"]:w,["StartTime"]:A,["Notes"]:B})}else c.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",
{["Caller"]:z})}Dnd(){var z=d.AFrameworkApplication.ha.getBooleanAppSetting("QPGVCI"),A=e.a.XP(document.URL,"wdNewAndOpenCt",z);if(A){A=parseInt(A);var B=e.a.XP(document.URL,"wdPreviousSession",z);z=e.a.XP(document.URL,"wdPreviousCorrelation",z);var G=d.AFrameworkApplication.ha.getBooleanAppSetting("NAOPLP");if(d.AFrameworkApplication.y5){var w=d.AFrameworkApplication.y5.getTime();!A||A>w?c.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:A,
["DocumentLoadedTime"]:w,["SessionId"]:B,["Correlation"]:z}):c.ULS.sendTraceTag(5849683,202,G?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:w-A,["ClickTimestamp"]:A,["SessionId"]:B,["Correlation"]:z})}else c.ULS.sendTraceTag(5849681,202,G?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:A,["SessionId"]:B,["Correlation"]:z})}}get $Ia(){return this.Aa.value}get aKb(){return this.Dn.value}get jVh(){return this.ms.value}get Z5(){return this.LY.value}get K$b(){return this.Ce.value}get getCurrentTime(){return this.ykb}get o1(){return this.phf.value}get ZGa(){return this.LRb.value}static get instance(){return v.Qa||
(v.Qa=v.Dq())}static Dq(){return new v(new b.a(()=>d.AFrameworkApplication.ub),new b.a(()=>d.AFrameworkApplication.$d),new b.a(()=>d.AFrameworkApplication.Ha),new b.a(()=>d.AFrameworkApplication.Ha.Ib.Dm),new b.a(()=>d.AFrameworkApplication.Zd),()=>(new Date).getTime(),new b.a(()=>d.AFrameworkApplication.Ha.Ib.o1),new b.a(()=>d.AFrameworkApplication.ZGa))}}v.Qa=null;Object(y.a)(v,"NewAndOpenCommonHelpers",null,[921])},562:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(b){this.type=
null;this.type=b}}Object(y.a)(c,"CustomContentProps",null,[])},573:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}c.JAa="extId";c.VHb="ComponentType";c.aqa="ComponentId";c.nNh="HostProps";c.Ota="OptionalProps";Object(y.a)(c,"ActionPropertyNames",null,[])},618:function(y,C,a){a.d(C,"a",function(){return d});a.d(C,"b",function(){return e});var c=a(45),b=a(619);const d=(h,n)=>{const m=new c.GraphIterator;m.set(h);let k=m.Fb(21);for(;k;)b.a(k)&&n(h,k),k=m.Df(21)},e=(h,n)=>{const m=new c.GraphIterator;
m.set(h);let k=m.Fb(21);for(;k&&k!==h;)k=b.a(k)&&n(k)?m.iIa(21):m.Uj(21)}},619:function(y,C,a){a.d(C,"b",function(){return b});a.d(C,"a",function(){return d});var c=a(54);const b=(e,h)=>{h[e.jb(c.a.anb)]=e.jb(c.a.rTb)},d=e=>1074135139===e.Re},620:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);var c;(function(b){b[b.Ujm=0]="myAddins";b[b.eRl=1]="adminManaged";b[b.Wpm=2]="popular"})(c||(c={}));Object(y.b)("AddinCollectionType",c)},628:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);class c{static H3f(){return c._nextEventReceiverId++}}
c._nextEventReceiverId=0;Object(y.a)(c,"EventReceiverIdCounter",null,[]);class b{constructor(d,e){this.Mff=d;this._id=c.H3f();this.Bqf=e}get id(){return this._id}notify(d,e){this.Bqf(d,e)}Qi(d,e){return this.Mff.U8g(d,e?this:null)}}Object(y.a)(b,"EventReceiver",null,[884])},729:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.hMb={}}tvf(b){this.hMb[b.id.toString()]=b}tXg(b){const d=this.hMb;for(const e in d)d[e].notify(b,!1);this.hMb={}}U8g(b,d){d&&this.tvf(d);return this.ive(b,
d)}Nkc(b){this.tXg(b)}cUd(b,d){b.notify(d,!0)}}Object(y.a)(c,"AEventEmitter",null,[924])},737:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.additionalDataFields=this.otelEvent=null}}Object(y.a)(c,"OtelTelemetryEvent",null,[])},738:function(y,C,a){a.d(C,"a",function(){return b});var c=a(50);const b=()=>c.a.instance.eb("Common.App.OAuth.IOAuthManager")},741:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);a=a(216);class c extends a.a{constructor(){super();this.Value=
this.Label=null;this.Underlined=this.ShowIcon=!1;this.AutoComplete="off";this.OnChangeCommandId=this.ResultAriaLiveText=null}get ControlType(){return 15}}Object(y.a)(c,"SearchBoxProps",a.a,[])},742:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);a=a(216);class c extends a.a{constructor(){super();this.OnLinkClicked=this.LinkUrl=this.LinkText=this.OnRetryCommandId=this.RetryButtonTitle=this.AriaDescription=this.IconName=this.Label=null}get ControlType(){return 12}}Object(y.a)(c,"ErrorViewProps",
a.a,[])},743:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);a=a(216);class c extends a.a{constructor(){super();this.CommandValueId=this.ActionCommandValueId=this.ActionText=this.ActionIdMapped=this.ActionId=this.Details=this.Links=this.Description=this.SecondaryLabel=this.Label=this.iconSet=this.ActionCommandId=this.CommandIdMapped=this.CommandId=null}get ControlType(){return 13}}Object(y.a)(c,"MultiActionButtonProps",a.a,[])},768:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}
c.none=null;c.C1m="CoAuth";c.qNh="IdeasPaneClosed";c.BOn="MultiSlidesSelected";c.p8c="Retrigger";c.nZh="SessionEnded";c.I$n="SessionRehydrated";c.slideNavigation="SlideNavigation";c.R6e="SuggestionPaneClosed";c.E0h="SuggestionsLoadingTimeout";c.noSuggestion="NoSuggestion";c.VA="Typing";c.p8e="WebActionId:";c.w5n="Rehydrated";c.xYl="DisallowedRequest";c.HUl="CloseSecondPane";c.oVn="OpenEditorPane";Object(y.a)(c,"DesignerResetReason",null,[])},769:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);
class c{}c.invalid="Invalid";c.success="Success";c.error="Error";c.pending="Pending";c.W0c="NoResult";Object(y.a)(c,"ProviderResultStatus",null,[])},773:function(y,C,a){a.d(C,"a",function(){return T});y=a(0);var c=a(405),b=a(6),d=a(1703),e=a(38);C=a(729);var h=a(827),n=a(792);class m extends n.a{constructor(){super();this.Ugd=this.Wgd=this.Vgd=null;this.state=this.Bhd=0;this.gtc=!1}get xWg(){return this.Vgd}get DUh(){return this.Wgd}get q1e(){return this.Ugd}get Hsl(){return this.Bhd}z0d(){return"MruActor Result"}}
Object(y.a)(m,"MruResult",n.a,[922,923]);var k=a(556),l=a(99),u=a(181);class r{constructor(K,M,N){this.task=null;this.B0b=K;this.FUg=M;this.YL=N;this.retryCount=this.JPa=0;this.NQb=this.wQa=null}Tig(K,M){return K===u.a.Rkd||20===M||18===M||3===M}wjg(K){return 3===K||5===K||6===K||7===K||9===K||10===K||11===K||12===K||13===K||14===K||15===K||16===K||23===K||26===K||27===K||28===K}get Whb(){return this.NQb}reset(){this.JPa=this.retryCount=0;this.NQb=this.wQa=null;this.task&&(this.YL.Sh(this.task),this.task=
null)}Hcg(K,M,N,I){this.NQb=String.format("{0}_{1}",N,I);if(this.retryCount>=this.FUg)return c.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.Tig(N,I))return c.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.wjg(I)&&1<=this.JPa)return this.wQa=N,!1;M=Math.max(M,this.B0b*Math.pow(2,this.JPa));if(26===I)M=Math.max(M,3E4);else if(27===I||28===I)M=Math.max(M,6E4);9===I||412===N&&(null==this.wQa||412!==this.wQa)?M=500:this.JPa+=1;this.wQa=
N;this.retryCount+=1;this.task&&this.YL.Sh(this.task);c.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",M);this.task=new l.a(2,1,M,K,107);this.YL.Rb(this.task);return!0}}Object(y.a)(r,"RetryManager",null,[]);var x=a(41),v=a(118),z=a(1831),A=a(75),B=a(15);class G{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(y.a)(G,"WriteOptions",null,[]);var w=a(324),F=a(64),H=a(98),E=a(57),P=a(1502);class T extends C.a{constructor(K,
M,N,I,O,Q,U){super();this.xBh=ba=>{this.emd(ba.data)};this.HMf=ba=>{if(ba.data.Je===u.a.sDc)this.emd(ba.data);else{var aa=ba.data.Je===u.a.GKb,La=z.a.Bx();this.hmd(this.p$,ba,this.FMf(),La);La&&(La.set("StatusCode",ba.data.Je.toString()),aa||this.ESb(ba.data,La));v.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",ba.data.Je),aa,!1,Object.assign({},{extendedProperties:La}))}};this.D3f=ba=>{this.Gld(ba)};this.C3f=ba=>{this.Gld(ba,!0)};this.A3f=ba=>{this.Fld(ba)};this.z3f=
ba=>{this.Fld(ba,!0)};this.dLa=K;this.rmf=M;this.m$=new r(x.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),x.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.Mw.K$b);this.p$=new r(x.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),x.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.Mw.K$b);
this.Ppf=N;this.Jhd=I;this.Uuf={};this.pK=new m;this.$gf=O;this.Deb="";this.Gaa=Q;this.zgd=U;this.Spf=x.AFrameworkApplication.ha.Ac("WordRecentLinksCount",25)}get bjb(){return this.Uuf}$Xh(){this.Mw.$Ia.Ba(E.a.Bch,H.a.frame,Object(b.a)(this,this.Cch,"renameMruEntry"))}Cch(){return this.cjc("Rename")}pUh(){this.Kpd("File Opened")}qUh(){this.Kpd("IntervalUpdate")}Kpd(K){c.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:K});this.cjc(K)}GJ(K){(K=F.a.GJ(K))&&K.startsWith(".")&&
(K=K.substring(1,K.length));return K}yIb(){switch(this.Mw.Z5){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}w7f(K){var M=this.$gf();if(!M)return null;const N=new G;N.documentUrl=this.zgd.value?encodeURI(M):M;N.mruItemId=this.Deb;N.app=this.yIb();if(M=this.Gaa())N.folderName=M.breadcrumbFolderName,M=M.LP,N.documentName=F.a.aca(M),N.documentExt=this.GJ(M);K&&(N.documentName?N.documentName.length?255<=N.documentName.length?
K.set("DocumentNameLength","Long"):2084<=N.documentName.length&&K.set("DocumentNameLength","VeryLong"):K.set("DocumentNameLength","0"):K.set("DocumentNameLength","Null"));return JSON.stringify(N)}cjc(K,M){M=void 0===M?!1:M;if(4===this.Mw.Z5&&!x.AFrameworkApplication.VEc)return 2;var N=z.a.Bx();N&&(N.set("Trigger",K),N.set("IsRetry",M?"true":"false"),N.set("MruIdSent",this.Deb?"true":"false"),N.set("URLEncoded",this.zgd.value?"true":"false"));v.Health.instance.recordKpiUsage("WriteMru",P.b.FailureBased,
"smartfio",N);K=this.w7f(N);if(!K)return M=!x.AFrameworkApplication.KWa,N&&(N.set("WebEditingIsEnabled",x.AFrameworkApplication.KWa?"true":"false"),N.set("ProtectedFile",x.AFrameworkApplication.zB?"true":"false")),v.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",M,!1,Object.assign({},{extendedProperties:N})),2;this.p$&&!M&&this.p$.reset();N=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.Mw.o1,this.w3b);this.Jhd?this.bjb["X-FileId"]=x.AFrameworkApplication.Fh:N+=String.format("&{0}",
x.AFrameworkApplication.Fh);x.AFrameworkApplication.rd&&(this.bjb["X-Office-AudienceGroup"]=Object(d.a)(String,x.AFrameworkApplication.rd.AudienceGroup)||"");this.bjb["X-Timeout"]=15E3;return this.Mw.aKb.ik(N,2,K,this.bjb,!0,5,this.xBh,this.HMf,null,void 0,void 0,void 0,void 0,"4")}emd(K){const M=z.a.Bx();this.p$&&(M&&this.p$.Whb&&(M.set("LastError",this.p$.Whb),M.set("NumRetries",this.p$.retryCount.toString())),this.p$.reset());const N=h.c(K.responseData);N&&N.diagnostics_data&&(this.Deb=N.diagnostics_data.mru_id);
K=+K.Gp-+K.Oo;M&&M.set("RequestDuration",K.toString());v.Health.instance.recordKpiSuccess("WriteMru",Object.assign({},{extendedProperties:M}))}FMf(){return()=>{this.cjc("Retry",!0)}}PLh(){this.Ahb("Polling")}B3f(){this.Ahb("Retry",!0)}nUh(){this.Ahb("Open")}mUh(){this.Ahb("Activity")}Ahb(K,M){M=void 0===M?!1:M;var N=void 0===N?!1:N;c.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:K});const I=z.a.Bx();I&&(I.set("Trigger",K),I.set("IsRetry",M?"true":"false"),N&&I.set("RecentLinks",
"true"));v.Health.instance.recordKpiUsage("GetMru",P.b.FailureBased,"smartfio",I);this.m$&&!M&&this.m$.reset();N?this.Ijd(this.C3f,this.z3f,!0):this.Ijd(this.D3f,this.A3f)}ESb(K,M){K&&K.gj&&(K=K.gj["X-CorrelationId"])&&M.set("ServerCorrelationId",K)}nog(K,M){K&&(M&&M.set("RequestDuration",(+K.Gp-+K.Oo).toString()),v.Health.instance.recordKpiSuccess("GetMru",Object.assign({},{extendedProperties:M})))}Gld(K,M){M=void 0===M?!1:M;var N="";let I=null,O=null,Q=null;const U=h.c(K.data.responseData);U&&(I=
U.places?U.places.items:[],O=U.documents?U.documents.items:[],(Q=h.a(U,M))&&(N=B.c(Q)));x.AFrameworkApplication.Ha&&x.AFrameworkApplication.Ha.Ib.wYa&&A.c()&&!M&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(N,!0)),this.uSe=N);N=z.a.Bx();this.m$&&(N&&this.m$.Whb&&(N.set("LastError",this.m$.Whb),N.set("NumRetries",this.m$.retryCount.toString())),this.m$.reset());M&&N&&N.set("RecentLinks","true");Q||I||O?(M?this.Mw.O$("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",K.data,
"Success"):this.Mw.O$("MruActor.GetMruV2FromServerSuccessCallback",K.data,"Success"),this.Tib(3,Q,I,O),this.nog(K.data,N)):(M?this.Mw.O$("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",K.data,"Failure: Invalid JSON"):this.Mw.O$("MruActor.GetMruV2FromServerSuccessCallback",K.data,"Failure: Invalid JSON"),N&&this.ESb(K.data,N),v.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign({},{extendedProperties:N})),this.Tib(3,null,null,null,!0));this.Nkc(this.pK)}hmd(K,
M,N,I){let O=0,Q=0;const U=h.c(M.data.responseData);U&&(null!=U.response_code&&(O=U.response_code,I&&I.set("MruResponseCode",O.toString()),9===O&&(this.Deb="")),U.error_data&&null!=U.error_data.retry_after_ms&&(Q=U.error_data.retry_after_ms,I&&I.set("ExpectedRetryAfter",Q.toString())));K&&(M=K.Hcg(N,Q,M.data.Je,O),I&&(I.set("CurrentRetryCount",K.retryCount.toString()),I.set("RetryScheduled",M?"true":"false")))}Fld(K,M){M=void 0===M?!1:M;const N=K.data.Je===u.a.GKb,I=z.a.Bx();I&&(I.set("StatusCode",
K.data.Je.toString()),M&&I.set("RecentLinks","true"),N||this.ESb(K.data,I));M?this.Mw.O$("MruActor.GetMruForRecentLinksFromServerFailureCallback",K.data,"Failure"):this.Mw.O$("MruActor.GetMruFromServerFailureCallback",K.data,"Failure");this.Tib(2);this.hmd(this.m$,K,Object(b.a)(this,this.B3f,"getMruFromServerRetryTask"),I);v.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",K.data.Je),N,!1,Object.assign({},{extendedProperties:I}));this.Nkc(this.pK);x.AFrameworkApplication.Ha&&
x.AFrameworkApplication.Ha.Ib.wYa&&A.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),M||(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),this.uSe=null))}Tib(K,M,N,I,O){if(3!==this.pK.state||3===K)this.pK.Vgd=void 0===M?null:M,this.pK.Wgd=void 0===N?null:N,this.pK.Ugd=void 0===I?null:I,this.pK.state=K,this.pK.gtc=void 0===O?!1:O,this.pK.Bhd=this.Mw.getCurrentTime()}ive(K,M){c.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:K,["ResultState"]:this.pK.state});
M&&3===this.pK.state&&this.cUd(M,this.pK);return this.pK}Ijd(K,M,N){N=void 0===N?!1:N;this.Tib(1);let I;const O={};I=N?String.format(this.Mw.o1+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.Spf,"OfficeSuite",this.w3b,"ClassicMru"):String.format(this.Mw.o1+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.yIb(),this.w3b);this.Ppf.value||(I+="&entity=docs");x.AFrameworkApplication.rd&&(O["X-Office-AudienceGroup"]=Object(d.a)(String,x.AFrameworkApplication.rd.AudienceGroup)||
"");N&&(O["X-Office-Application"]="147");this.Jhd?O["X-FileId"]=x.AFrameworkApplication.Fh:I+=String.format("&{0}",x.AFrameworkApplication.Fh);this.Mw.aKb.ik(I,1,null,O,!0,5,K,M,null)}get Mw(){return this.dLa.value}get w3b(){return this.rmf.value}static get instance(){return T.Qa||(T.Qa=T.Dq())}static Dq(){return new T(new e.a(()=>k.a.instance),new e.a(()=>w.a.Le(x.AFrameworkApplication.lcid).name),new e.a(()=>x.AFrameworkApplication.Ha.Ib.rR),x.AFrameworkApplication.ha.getBooleanAppSetting("MruWriteFileIdInHeader"),
()=>x.AFrameworkApplication.Ha.Ib.KUe,()=>x.AFrameworkApplication.Dz,new e.a(()=>x.AFrameworkApplication.ha.getBooleanAppSetting("OICEncodeUrlIsEnabled")))}}T.Qa=null;Object(y.a)(T,"MruActor",C.a,[])},791:function(y,C,a){a.d(C,"b",function(){return b});a.d(C,"a",function(){return d});y=a(0);class c{}c.slideType="slide";c.shapeType="shape";c.chartType="chart";Object(y.a)(c,"ClipserviceDataConstants",null,[]);const b=e=>e===c.slideType?1:e===c.shapeType?2:e===c.chartType?3:0,d=e=>1===e?c.slideType:
2===e?c.shapeType:""},792:function(y,C,a){a.d(C,"a",function(){return d});y=a(0);var c=a(405),b;(function(e){e[e.notStarted=0]="notStarted";e[e.waiting=1]="waiting";e[e.Qoc=2]="shouldRetry";e[e.complete=3]="complete"})(b||(b={}));Object(y.b)("EventResultState",b);class d{constructor(){this._state=0}get state(){return this._state}set state(e){c.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:b[this._state],["NewState"]:b[e]},"ResultType",this.z0d());this._state=e}}
Object(y.a)(d,"AEventResult",null,[923])},827:function(y,C,a){a.d(C,"c",function(){return h});a.d(C,"b",function(){return n});a.d(C,"a",function(){return m});var c=a(21),b=a(405),d=a(41),e=a(15);const h=k=>{if(!k)return null;let l;try{l=e.b(k)}catch(u){l=null,b.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",u)}return l},n=(k,l)=>{let u=[];if(k.breadcrumbs&&0<k.breadcrumbs.length)u=k.breadcrumbs;else{const r=k.service_info;r&&r.friendly_service_name&&
Array.add(u,r.friendly_service_name);k.display_path&&Array.addRange(u,k.display_path)}return u.join(l?" \u00ab ":" \u200f\u00bb ")},m=(k,l)=>{l=void 0===l?!1:l;if(!k)return[];if(!k.documents)return b.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!k.documents.items)return b.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];k=k.documents.items;const u=new c.a;for(let x=0;x<k.length;x++){const v=k[x];var r=v.web_url;if(!r){b.ULS.sendTraceTag(578320064,202,15,"Empty web_url");
if(!v.url){b.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}r=String.format("{0}?web=1",v.url)}const z={};z.DocumentUrl=r;z.MruId=v.mru_id;{r=v;let A=r.title;A?(r.extension&&(A=String.format("{0}.{1}",A,r.extension)),r=A):(b.ULS.sendTraceTag(578352837,202,15,"empty file title"),r="")}z.FileName=r;z.IsPinned=v.is_pinned;z.Path=n(v,d.AFrameworkApplication.isRtl);l&&(z.App=v.app,z.TimeStamp=v.time_stamp);u.add(z)}return u.toArray()}},831:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);
class c{constructor(){this.onFullRenderComplete=this.useCoachmark=this.jumpToCalloutTargetButtonEnabled=this.hasDynamicSizing=this.preventLightDismiss=this.useTeachingStyles=this.hasFocusableControls=this.calloutProps=this.showCloseIcon=this.secondaryButtonProps=this.primaryButtonProps=this.title=this.content=this.target=null}}Object(y.a)(c,"CalloutParameters",null,[])},832:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}Object(y.a)(c,"ICalloutProps",null,[])},840:function(y,C,a){a.d(C,
"a",function(){return b});y=a(0);var c=a(55);class b{constructor(d,e){this.Cyb=!1;this.ANb=this.whd=-1;this.gu=d;e&&this.start()}start(){this.Cyb=!0;this.ANb=-1;const d=c.a.UA();d&&(this.whd=d)}stop(){this.Cyb=!1;const d=c.a.UA();d&&0<this.bR&&d>=this.bR&&(this.ANb=d-this.bR)}get operation(){return this.gu}get PTd(){return this.ANb}get bR(){return this.whd}}Object(y.a)(b,"PPTStopwatch",null,[])},841:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{static add(b,d,e,h,n){c.Snd[c.ald(b,
d,e,h,n)]=!0}static contains(b,d,e,h,n){return c.ald(b,d,e,h,n)in c.Snd}static ald(b,d,e,h,n){return String.format("{0}|{1}|{2}|{3}|{4}",b.toLowerCase(),d,e.toLowerCase(),h.toLowerCase(),n.toLowerCase())}}c.Snd={};Object(y.a)(c,"AppsInsertedStorage",null,[])},842:function(y,C,a){a.d(C,"a",function(){return u});y=a(0);var c=a(17),b=a(1703),d=a(53),e=a(54),h=a(45),n=a(96),m=a(259),k=a(51),l=a(618);class u{static PKf(r,x,v){r=Object(b.a)(n.a,r.createInstance(1074135137));u.Yhd(r,x,v);return r}static uza(r,
x,v){h.GraphIterator.vb(r).wl(x,v)}static Yhd(r,x,v){r.setValue(e.a.bzc,0===x.targetType);r.setValue(e.a.cnb,x.solutionId);r.setValue(e.a.dzc,x.version);r.setValue(e.a.zHb,x.storeType);r.setValue(e.a.czc,x.storeId);r.setValue(k.a.$jc,v.YUe(x.storeType));x.assetId&&r.setValue(k.a.Yjc,x.assetId);r.setValue(k.a.Zyc,x.assetStoreId);void 0===x.isAddinCommands?r.setValue(k.a.isAddinCommands,!1):r.setValue(k.a.isAddinCommands,x.isAddinCommands);x.sharedRuntimeId&&-1!==x.backgroundState&&(r.setValue(k.a.tXa,
x.backgroundState),r.setValue(k.a.oMa,x.sharedRuntimeId));0===x.targetType&&(r.setValue(k.a.au,!0),v=x.height?x.height:200,r.setValue(d.a.Hw,x.width?x.width:200),r.setValue(d.a.MA,v))}static X1h(r,x,v){const z=c.a.ead(v);l.b(x,B=>{B=B.jb(e.a.anb);return!!B&&!(B in z)});l.a(x,(B,G)=>{const w=G.jb(e.a.anb);w&&w in z&&(u.Mwh(G,z[w],B),delete z[w])});const A=h.GraphIterator.vb(x);c.a.forEach(z,(B,G)=>{A.wl(u.QKf(r,B,G),21)},null)}static QKf(r,x,v){r=Object(b.a)(n.a,r.createInstance(1074135139));r.setValue(e.a.anb,
x);r.setValue(e.a.rTb,v);return r}static Mwh(r,x,v){r.setValue(e.a.rTb,x);v.ra(e.a.bzc,!0)?m.d(v,r,u.agh):m.d(v,r,u.rgh)}}u.agh=[k.a.sid,k.a.cid,k.a.shapeId];u.rgh=[e.a.cnb];Object(y.a)(u,"AppEditor",null,[])},843:function(y,C,a){a.d(C,"a",function(){return m});y=a(0);var c=a(41),b=a(181),d=a(114),e=a(6);C=a(21);var h=a(40),n=a(91);class m{constructor(k,l,u,r,x,v,z,A,B,G,w,F,H,E){this.JH=this.Kj=this.zs=null;this.$id=!0;this.yDa=k;this.lTg=l;this.Iwg=u;this.eRa=r;this.UO=v;this.zc=z;this.le=A;this.rf=
B;this.Fpd=G;this.mxb=w;this.fEg=F;this.eEg=H;this.dEg=E;this.IG=x}openDialog(){this.mLf();c.AFrameworkApplication.Ha.cUa();try{this.Kj.click()}catch(k){const l=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",k.message,k.stack);h.a.$(509727820,818,10,l);throw k;}}submit(){var k,l,u,r;const x=this.Kj.files[0];this.JH=this.Iwg();const v=Date.now();null===(k=this.rf)||void 0===k?void 0:k.Za("submitTime",v.toString());this.JH.eac&&(this.JH.eac(this.UO,this.zc,this.le,this.rf,
this.Fpd?x:void 0),k=Date.now(),null===(l=this.rf)||void 0===l?void 0:l.Za("beforeUploadTime",k.toString()));null===(u=this.rf)||void 0===u?void 0:u.Za("FileSize",null===(r=null===x||void 0===x?void 0:x.size)||void 0===r?void 0:r.toString());if(this.Fpd)this.uzh(x);else{l=new FormData;for(const A of this.JH.cTb)l.append(A.key,A.value);l.append("fileInputId",x,x.name);const z=new XMLHttpRequest;z.onreadystatechange=()=>{this.Mhb(z)};z.open("POST",this.JH.Xqd);z.send(l)}}Mhb(k){if(4===k.readyState){const l=
k.status;!l||l>=b.a.KB&&l<b.a.LGh?this.JH.px&&this.JH.px(k.responseText,this.UO,this.zc,this.le,this.rf,this.Kj):this.JH.$G&&this.JH.$G(k.responseText,this.UO,this.zc,this.le,this.rf);this.dispose()}}uzh(k){var l;const u=Date.now();null===(l=this.rf)||void 0===l?void 0:l.Za("UploadStartTime",u.toString());this.mxb().O9(this.eRa,this.IG,k.size,k,this.JH.cTb.ka("MediaToken"),this.rf,this.fEg,this.eEg,this.dEg,r=>{var x;if(this.JH.px){const v=Date.now();null===(x=this.rf)||void 0===x?void 0:x.Za("UploadEndTime",
v.toString());this.JH.px(r.result,this.UO,this.zc,this.le,this.rf,this.Kj)}},r=>{var x;if(this.JH.$G){const v=Date.now();null===(x=this.rf)||void 0===x?void 0:x.Za("failedUploadEndTime",v.toString());this.JH.$G(r.error.Code.toString(),this.UO,this.zc,this.le,this.rf)}})}dispose(){this.zs&&(d.a.removeHandler(this.Kj,"change",Object(e.a)(this,this.qIb,"fileInputChange")),document.body.removeChild(this.zs),this.Kj=this.zs=null,m.Fic.remove(this))}mLf(){this.zs||(this.zs=document.createElement("form"),
this.zs.id="uploadFormId",this.zs.style.visibility=n.a.hidden,this.zs.method="post",this.zs.encoding="multipart/form-data",this.zs.action="",this.Kj=document.createElement("input"),this.Kj.style.visibility=n.a.hidden,this.Kj.type="file",this.Kj.id="uploadFileInputId",this.Kj.name="uploadFileInputId",this.Kj.accept=this.yDa,this.zs.appendChild(this.Kj),document.body.appendChild(this.zs),d.a.addHandler(this.Kj,"change",Object(e.a)(this,this.qIb,"fileInputChange")))}qIb(){this.Kj.value&&this.Kj.value.length?
(this.$id=!1,this.lTg(this.Kj,this.le,this.rf,this.eRa).then(()=>{this.submit()}).catch(()=>{this.dispose()})):this.dispose()}static u6e(k,l,u,r,x,v,z,A,B,G,w,F,H,E){for(const P of m.Fic)P.$id&&P.dispose();k=new m(k,l,u,r,x,v,z,A,B,G,w,F,H,E);m.Fic.add(k);k.openDialog()}}m.Fic=new C.a;Object(y.a)(m,"UploadFileDialog",null,[])},844:function(y,C,a){a.d(C,"a",function(){return h});y=a(0);var c=a(64),b=a(114),d=a(40),e=a(42);class h{constructor(n){this.yT=null;this.WRa=0;this.eRa=n;switch(this.eRa){case "audio":this.yT=
h.iTg;this.WRa=h.uqg;break;case "captions":this.yT=h.jTg;this.WRa=h.nrg;break;case "video":this.yT=h.kTg;this.WRa=h.sTg;break;default:d.a.$(509727835,822,10,"Invalid file type")}}static set sDl(n){h.kTg=n}static set XDl(n){h.sTg=n}IGf(n){switch(this.eRa){case "audio":return h.GGf(n);case "captions":return h.HGf(n);case "video":return e.a("DisableVideoAsFileCheck")?new Promise(m=>{m(!0)}):h.JGf(n);default:return d.a.$(509727834,822,10,"Invalid file type"),new Promise(m=>{m(!1)})}}iAh(n){n=c.a.ph(n);
for(let m=0;m<this.yT.length;++m){const k=this.yT[m];if(k&&0<k.length&&n.endsWith(k))return!0}return!1}jAh(n){return n<=1048576*this.WRa}static GGf(n){return new Promise((m,k)=>{if(n&&n.size){var l=document.createElement("video"),u=URL.createObjectURL(n);l.setAttribute("src",u);b.a.addHandler(l,"loadedmetadata",()=>{URL.revokeObjectURL(u);const r=l.videoHeight,x=l.videoWidth;0<l.duration&&!r&&!x?m(!0):(d.a.$(509727832,822,10,"Invalid audio File"),m(!1))});b.a.addHandler(l,"error",()=>{URL.revokeObjectURL(u);
d.a.$(509727831,822,10,"Invalid audio File");k(ResourceStrings.L_InvalidAudioFileError)})}else d.a.$(509727833,822,10,"Empty media File"),m(!1)})}static HGf(n){return new Promise((m,k)=>{if(n&&n.size){var l=URL.createObjectURL(n),u=document.createElement("video"),r=document.createElement("track");u.appendChild(r);b.a.addHandler(r,"load",()=>{URL.revokeObjectURL(l);m(!0)});b.a.addHandler(r,"error",()=>{URL.revokeObjectURL(l);d.a.$(509727829,822,10,"Invalid captions File");k(ResourceStrings.l_InvalidCaptionsFileError)});
r.setAttribute("src",l);r.setAttribute("default","true")}else d.a.$(509727830,822,10,"Empty captions File"),m(!1)})}static JGf(n){return new Promise((m,k)=>{if(n&&n.size){var l=document.createElement("video"),u=URL.createObjectURL(n);l.setAttribute("src",u);b.a.addHandler(l,"loadedmetadata",()=>{URL.revokeObjectURL(u);const r=l.videoHeight,x=l.videoWidth;0<l.duration&&0<r&&0<x?m(!0):(d.a.$(509727837,822,10,"Invalid video File"),m(!1))});b.a.addHandler(l,"error",()=>{URL.revokeObjectURL(u);d.a.$(509727836,
822,10,"Invalid video File");k(ResourceStrings.L_InvalidVideoFileError)})}else d.a.$(509727838,822,10,"Empty media File"),m(!1)})}static gZb(n){if(!n||!n.value)return"Input file name is null";const m=n.value.lastIndexOf(".");return-1===m?"":n.value.substring(m+1,m+5)}}h.uqg=16;h.nrg=16;h.jTg=[".vtt"];h.iTg=[".mp3",".wav",".m4a",".aac",".oga"];Object(y.a)(h,"MediaValidationHelper",null,[])},848:function(y,C,a){a.d(C,"a",function(){return u});y=a(0);var c=a(405),b=a(324),d=a(41),e=a(169),h=a(69),n=
a(64),m=a(238),k=a(90),l=a(42);class u{static pXe(r){const x={};x.appSettings=u.RKf();x.singleSignOnSettings=u.mXe();x.appVersion="16";x.appUILocale=b.a.Le(d.AFrameworkApplication.lcid).Lfb;x.dataLocale=b.a.Le(d.AFrameworkApplication.lcid).Lfb;x.osfOmexBaseUrl=d.AFrameworkApplication.ha.Ma(k.a.NTe);x.firstPartyManifestCDNUrl=d.AFrameworkApplication.ha.Ma(k.a.YTe);x.sdxCdnUrl=d.AFrameworkApplication.ha.Ma(k.a.sdxCdnUrl);x.sdx1CdnUrl=d.AFrameworkApplication.ha.Ma("Sdx1CdnUrl");x.sdxDmsUrl=d.AFrameworkApplication.ha.Ma(k.a.sdxDmsUrl);
x.forceUseSdx1Cdn=d.AFrameworkApplication.ha.getBooleanAppSetting("ForceUseSdx1Cdn");x.sovereignFederationDMSToken=d.AFrameworkApplication.ha.Ma("SovereignFederationDMSToken");x.sovereignFederationDMSTokenSuffix=d.AFrameworkApplication.ha.Ma("SovereignFederationDMSTokenSuffix");x.sdxAssetsToPrefetchMapping=d.AFrameworkApplication.ha.Ma(k.a.sdxAssetsToPrefetchMapping);x.docUrl=r?r.documentUrl:"";x.pageBaseUrl=e.a.jH;x.lcid=d.AFrameworkApplication.lcid.toString();x.allowExternalMarketplace=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.xid);
x.localizedScriptsUrl=(d.AFrameworkApplication.xga?d.AFrameworkApplication.ha.Ma("StaticContentHostNonOverriden"):e.a.jH)+d.AFrameworkApplication.ha.Ma(k.a.nGh);r=r?r.cYe:"";x.localizedImagesUrl=e.a.jH+r;x.localizedStylesUrl=e.a.jH+r;x.localizedResourcesUrl=e.a.qFh(r);x.enableAddinCommands=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.jyc);x.enableMyApps=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.GNh);x.enableMyOrg=d.AFrameworkApplication.ha.getBooleanAppSetting("InsertAgaveMyOrgEnabledForHost");
x.enableUploadFileDevCatalog=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.jyc)&&!d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.f8e);x.enableDevCatalog=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.frd);x.devCatalogUrl=d.AFrameworkApplication.ha.Ma(k.a.mGh);x.enablePrivateCatalog=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.Eid);x.showSignOutFromPrivateCatalogMessage=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.showSignOutFromPrivateCatalogMessage);x.enableBlackForestRedirect=
d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.lUe);x.enableSingleSignOnForAddin=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.ZTe)&&d.AFrameworkApplication.kOh;x.enableTaskpaneUpgradeToAppCommand=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.f7e);x.hideAppsExtensionUrl=d.AFrameworkApplication.hideAppsExtensionUrl;x.enableAnonymousUseLegacyCatalogService=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.MTe);x.enableInsertDialogAccessibilityFix=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.B1e);
x.enableFirstPartySDXErrorMessages=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.A1e);x.disableAppsForOfficeThirdParty=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.b5c);x.wacSessionId=d.AFrameworkApplication.userSessionId;x.disableLogging=!d.AFrameworkApplication.ha.getBooleanAppSetting("AriaLoggingIsEnabled");x.loggableUserId=d.AFrameworkApplication.ha.Ma("LoggableUserId");x.sessionStartInfoJson=d.AFrameworkApplication.ha.Ma("SessionStartInfoJson");x.wopiHostOriginFromPostMessage=d.AFrameworkApplication.wopiHostOriginFromPostMessage;
x.wopiHostOriginFromWacPropBag=d.AFrameworkApplication.ha.Ma("PostMessageOrigin");x.wacIsEmbedded=d.AFrameworkApplication.ha.getBooleanAppSetting("IsEmbedded");x.accessibilityAllowFocusAddinTaskpane=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.accessibilityAllowFocusAddinTaskpane);x.disableMicrophonePermission=h.a.QO(1)&&d.AFrameworkApplication.ha.getBooleanAppSetting("TranscriberSafariEnabled")&&d.AFrameworkApplication.ha.getBooleanAppSetting("RehearsalSafariEnabled");x.isHostFrameTrustCheckEnabledForAddIns=
d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.YXe);x.isHostFrameTrusted=d.AFrameworkApplication.isHostFrameTrusted;x.hostAllowedSdxEmbedding=d.AFrameworkApplication.ha.getBooleanAppSetting("HostAllowedSdxEmbedding");x.hostAllowedOfficeStore=d.AFrameworkApplication.ha.getBooleanAppSetting("HostAllowedOfficeStore");x.hostInstallAddIns=d.AFrameworkApplication.ha.Ma("HostInstallAddIns");x.hostInstallAddInsIsEnabled=d.AFrameworkApplication.ha.getBooleanAppSetting("HostInstallAddInsIsEnabled");x.approvedAddIns=
d.AFrameworkApplication.ha.Ma("ApprovedAddIns");x.is3pAddInsDisabled=d.AFrameworkApplication.ha.getBooleanAppSetting("Is3pAddInsDisabled");x.isUpnCheckEnabled=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.isUpnCheckEnabled);x.wacUpn=d.AFrameworkApplication.ha.Ma("UserPrincipalName");x.isReactRibbonEnabled=!0;x.enableSetFocusOnTaskpaneOnUserAction=!0;x.enableMyOrg&&x.docUrl&&(r=x.docUrl.split("/"),x.spBaseUrl=2<r.length?r[0]+"//"+r[2]:null,x.spBaseUrl||c.ULS.sendTraceTag(512263002,806,10,String.format("Failed to parse SpBaseUrl from DocUrl: {0}",
x.docUrl)));x.userNameHashCode=n.a.tS(d.AFrameworkApplication.userName);x.envCode=d.AFrameworkApplication.ha.Ac(k.a.dqd,0).toString();return x}static RKf(){const r={};r.AddinRibbonIdAllowUnknown=d.AFrameworkApplication.ha.getBooleanAppSetting("AddinRibbonIdAllowUnknown");r.AddinRibbonNativeGroupControlIsEnabled=!0;r.AddinRibbonTabAutoFocusIsEnabled=!0;r.AddinRibbonTabPositionIsEnabled=!0;r.AgaveAddinUploadEnabled=d.AFrameworkApplication.ha.getBooleanAppSetting("AgaveAddinUploadEnabled");r.DevConsoleEnabled=
d.AFrameworkApplication.ha.getBooleanAppSetting("AddinDevConsoleLog");r.ManifestParserDevConsoleEnabled=!0;r.flightingTreatmentVariables=d.AFrameworkApplication.ha.clc;r.DisabledChangeGates=d.AFrameworkApplication.ha.Ma("DisabledChangeGates");r.DmsSdxListPresentation=d.AFrameworkApplication.IVe;return r}static mXe(){try{const r={};(l.a("FixAddinTeamsBrowserSSO")||h.a.pQa)&&m.a.esb&&(r.UiHostSupportsAuthTokenAddinList=u.Mkd);r.UiHostSupportsAuthToken=m.a.esb;return r}catch(r){c.ULS.sendTraceTag(512263001,
344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",r.message)}return null}}u.Mkd="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5 wa200003233 ad3bb869-dfe9-409b-95f2-98016482b42 wa200003251 b2177d0c-a1d8-4c60-bc46-b1d116be3eee".split(" ");Object(y.a)(u,"AppForOfficeHelper",null,[])},849:function(y,C,a){a.d(C,"a",function(){return e});y=a(0);var c=a(405),b=a(274),d=a(41);class e{static pzm(h){return parseInt(e.gic(b.a.aGh,
h)||"-1")<=(new Date).getTime()}static Icj(h){return parseInt(e.gic(b.a.qid,h)||"-1")}static TCj(h){return Boolean.parse(e.gic(b.a.Yxf,h)||"false")}static gic(h,n){let m=null;try{const k=e.YIc();if(void 0!==k&&k){const l=b.a.tHc(h)+n;m=k.getItem(l)}else c.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(k){c.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",h,n)}return m}static Xdd(h,n,m){try{const k=
e.YIc();if(void 0!==k&&k){const l=b.a.tHc(h)+m;k.setItem(l,n)}else c.ULS.sendTraceTag(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(k){c.ULS.sendTraceTag(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",h,m)}}static YIc(){if(!e.yIa)return null;let h=null;try{h=localStorage}catch(n){e.yIa=!1,h=null}return h}static C3l(){switch(d.AFrameworkApplication.Ha.Ib.Dm){case 1:return"ExcelOnline";case 2:return"PowerPointOnline";case 3:return"WordOnline";
case 4:return"OneNoteOnline";case 5:return"VisioOnline";default:return"Unknown"}}}e.yIa=!0;Object(y.a)(e,"AddinUtil",null,[])},850:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);var c;(function(b){b[b.notSupported=-1]="notSupported";b[b.OMEX=0]="OMEX";b[b.pgo=1]="spCatalog";b[b.ogo=2]="spApp";b[b.ibn=3]="fileSystem";b[b.exchange=4]="exchange";b[b.oneDrive=5]="oneDrive";b[b.registry=6]="registry";b[b.Mtn=7]="inMemory";b[b.eno=8]="uploadFileDevCatalog";b[b.mqn=9]="hardCodedPreinstall";b[b.J7g=
10]="privateCatalog";b[b.apo=16]="wopiCatalog"})(c||(c={}));Object(y.b)("AddinProviderType",c)},859:function(y,C,a){a.d(C,"d",function(){return B});a.d(C,"e",function(){return G});a.d(C,"a",function(){return E});a.d(C,"c",function(){return P});a.d(C,"b",function(){return T});var c=a(132),b=a(69),d=a(100),e=a(41),h=a(15),n=a(107),m=a(43),k=a(265),l=a(368),u=a(40),r=a(844);y=a(0);class x{constructor(){this.$G=this.px=this.eac=this.cTb=this.Xqd=null}}Object(y.a)(x,"UploadFileDialogData",null,[]);var v=
a(23),z=a(42);const A=new (a(30).a),B=(K,M,N,I,O)=>{const Q=String.format("{0}{1}",N,c.a.create().toString());return Object.assign(new x,{cTb:H(Q,I),Xqd:F(N,I),eac:(U,ba,aa,La,Z)=>{switch(N){case "video":ba.blockContent(O,K,!1,Z,La);break;default:ba.blockContent(U,"Insert Media",!1,void 0,void 0)}U=Date.now();null===La||void 0===La?void 0:La.Za("loaderTime",U.toString())},px:(U,ba,aa,La,Z,la)=>{M(K,Q,ba,aa,Z,la,O)},$G:(U,ba,aa,La,Z)=>{aa.NO(ba)?u.a.$(509727823,822,15,"Media::InsertMediaFailureAfterUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+ba.Zha):aa.NO(O)&&u.a.$(509666848,822,15,"Media::InsertMediaFailureAfterUpload:Slide was blocked with loader for {0} milliseconds",+new Date-+O.Zha);z.a("FixHideShimmerIssueOnUploadFailure")&&"video".match(N)?aa.BE(O):aa.BE(ba);ba=null;try{const la=h.a(U);ba=la?la.Error:null}catch(la){u.a.$(509727822,818,10,"UploadResponseReceived - Exception when deserializing response. Response: {0}",U)}if(!ba){let la;z.a("FixHideShimmerIssueOnUploadFailure")&&U&&!isNaN(parseInt(U))&&(la=Enum.parse(k.a,
k.a[parseInt(U)],!0));ba=Object.assign(new l.a,{Code:la?la:444})}Z&&(Z.finish(),Z=null);u.a.$(509727821,822,10,"Upload media failed");E(N)?P(ResourceStrings.l_FileInsertFailedMessageTitle,ba&&449===ba.Code?ResourceStrings.l_VideoUploadTimeoutMessage:ResourceStrings.l_FileInsertFailedMessage,null):w(La,Z,ba.Code,null)}})},G=(K,M,N,I)=>new Promise((O,Q)=>{const U=new r.a(I);u.a.$(509727828,822,50,"Media File details: Number of media files: {0}, media file extension: {1}",K&&K.value?K.files.length:0,
r.a.gZb(K));N&&N.Za("MediaFileValidationStarts",String.format("Number of media files: {0}, media file extension: {1}",K&&K.value?K.files.length:0,r.a.gZb(K)));if(K&&K.value&&K.value.length)if(U.iAh(K.value)){var ba=K.files[0];if(U.jAh(ba.size))U.IGf(ba).then(aa=>{aa?(N&&N.Za("MediaFileValidationPassedOnUI","true"),O(!0)):(E(I)?P(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[U.yT.join(", ")]):w(M,N,443,[U.yT.join(", ")]),Q(443))},()=>{u.a.$(509727825,822,
10,"Invalid media file, fileType:{0}",I);E(I)?P(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[U.yT.join(", ")]):w(M,N,443,[U.yT.join(", ")]);Q(443)});else{u.a.$(509727826,822,10,"video"===I?"Media::Insert:video: max size error":`Media::Insert:Invalid media file size:${ba.size}`);ba=z.a("FetchMediaSizeLimitFromValidationHelper")?U.WRa.toString():"16";const aa="video"===I?450:442;E(I)?P(ResourceStrings.l_MaxFileSizeValidationErrorTitle,ResourceStrings.l_MaxVideoSizeValidationErrorMessage,
[ba]):w(M,N,aa,[ba]);Q(442)}}else u.a.$(509727827,822,10,"{flow:Insert{0}, fileExt:{1}}",null===I||void 0===I?void 0:I.toString(),r.a.gZb(K)),E(I)?P(ResourceStrings.l_UnsuportedFileFormatTitle,ResourceStrings.l_UnsuportedFileFormatMessage,[U.yT.join(", ")]):w(M,N,441,[U.yT.join(", ")]),Q(441);else E(I)?P(ResourceStrings.l_FileInsertFailedMessageTitle,ResourceStrings.l_FileInsertFailedMessage,null):w(M,N,440,null),Q(440)}),w=(K,M,N,I)=>{M&&(M.Za("MediaFileValidationPassedOnUI","false"),N&&M.Za("ErrorCode",
N.toString()),M.finish());K.nM(N,O=>{O.UE=1;O.Ifb=I;return!1})},F=(K,M)=>{let N="MediaUpload.ashx";if(m.App.webServiceBase)N=m.App.webServiceBase+N;else if(b.a.Yf||b.a.wna)N=d.a.ZAa(N);let I="";switch(K){case "audio":I="audio";break;case "captions":I="captions";break;case "video":I="video";break;default:u.a.$(509727824,822,10,"Media::GetMediaUploadEndpoint: file type not supported")}N+=String.format("?MediaType={0}&{1}&{2}&{3}",I,e.AFrameworkApplication.r5a(),M.ei.string,e.AFrameworkApplication.zIb());
M.podSessionId&&(N+=String.format("&{0}={1}",n.a.caa,M.podSessionId));M.Hp&&(N+=String.format("&waccluster={0}",M.Hp));return N},H=(K,M)=>{const N=new v.a;N.fa("PresentationId",M.ei.string);N.fa(n.a.Ona,M.sessionInfo);N.fa("Canary",e.AFrameworkApplication.ZC);N.fa("access_token",e.AFrameworkApplication.accessToken);N.fa("MediaToken",K);return N},E=K=>z.a("EnableCalloutNotificationsForVideos")&&"video".match(K)?!0:!1,P=(K,M,N)=>{const I=new l.a;I.Title=K;I.Message=M;I.ExtraErrorParam=N;A.raiseEvent("videoCalloutNotificationEvent",
I)},T=K=>{A.addHandler("videoCalloutNotificationEvent",K)}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25649181/wdjs/ppteditDS.chronos2.js.map