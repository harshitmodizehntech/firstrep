window.Microsoft||(window.Microsoft = {});Microsoft.Office=Microsoft.Office||{},Microsoft.Office.PowerPoint=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=16)}({16:function(e,t,i){"use strict";i.r(t),i.d(t,"DocRebootSupportMode",(function(){return _n})),i.d(t,"CommandIds",(function(){return se})),i.d(t,"EventIds",(function(){return ue})),i.d(t,"createCancellationToken",(function(){return at})),i.d(t,"Application",(function(){return Un})),i.d(t,"createApplication",(function(){return En}));var n=[[/!/g,"%21"],[/'/g,"%27"],[/\(/g,"%28"],[/\)/g,"%29"],[/\*/g,"%2A"]],o=["eurppc"];function r(e){return 8===e.toLowerCase().indexOf("ffc")}function s(e){return 8===e.toLowerCase().indexOf("ppc")}function a(e,t){if(!t||-1===o.indexOf(t.toLowerCase()))return e;var i=e.match(/(^http[s]:\/\/)((?!word)\w*[-])?(.*)/i);return i?"".concat(i[1]).concat(t,"-").concat(i[3]):e}function c(e){var t=e.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function u(e,t){var i=e.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!i)throw new Error("Invalid URL");var n=i[2];if(void 0===t)return n;if(t<0)throw new Error("subDomainParts should be at least 1");return n.split(".").slice(-(t+1)).join(".")}function d(e){return e+"RemoteUls.ashx"}function l(e,t,i){i&&(e[t.toLowerCase()]=i)}function f(e,t){e[t.toLowerCase()]=""}function h(e,t){var i=e.toLowerCase(),n=t.toLowerCase(),o=i.indexOf("&"+n+"=");if(-1===o&&(o=i.indexOf("?"+n+"=")),-1===o)return"";var r=o+(t.length+2),s=e.indexOf("&",r);return e.substring(r,-1===s?void 0:s)}function p(e,t,i,n){if(!i)return e;var o=e,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var a=t.toLowerCase()+"=",c=new RegExp("\\W"+a,"i").exec(o);if("?"!==s&&c){if(n){var u=c.index+1,d=o.indexOf("&",u);o=o.substring(0,u)+a+i+(-1===d?"":o.substring(d))}return o}return o.concat(s,a,i)}function v(e){var t={},i=e.indexOf("?");return-1===i||i===e.length-1||e.substring(i+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(e){if(e){var i=e.indexOf("=");-1!==i&&i!==e.length-1&&(t[e.substring(0,i).toLowerCase()]=e.substring(i+1))}})),t}function m(e,t){if(!e)return e;var i=e,n=i.indexOf("?"),o=t.toLowerCase()+"=",r=i.toLowerCase().indexOf(o,n);if(r>=0){var s=i.indexOf("&",r);return"&"===(i=i.substring(0,r)+(-1===s?"":i.substring(s+1))).slice(-1)&&(i=i.slice(0,-1)),i}return e}function w(e){var t=new RegExp("(c[1-5])h?(-)");return e.replace(t,"$1h$2")}function g(e,t,i){var n=new RegExp("[?&]"+t+"=("+(i||"1")+")\\b","i"),o=e.match(n);return!!o&&(!i||o[1]===i)}function S(e,t){var i=h(e,t);return i?decodeURI(i):i}function I(e){return h(window.location.href,e)}function b(e){var t=encodeURIComponent(e);return n.forEach((function(e){t=t.replace(e[0],e[1])})),t}function T(e){var t=(e+"===").substring(0,e.length+(4-e.length%4)%4);return t=(t=t.replace(/-/g,"+")).replace(/_/g,"/"),atob(t)}function _(e){var t=document.createElement("a");t.href=e;var i=t.port||80,n=window.location.port||80;return t.hostname===window.location.hostname&&i===n}function y(e){return e?e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]:""}function C(e){var t=document.createElement("link");t.rel="preconnect",t.href=e,t.crossOrigin="anonymous",document.head.appendChild(t)}function A(e,t){return void 0===e&&(e=!1),{shouldPreconnect:function(e){return O&&(!t||t(e))},preconnect:function(t){return C(e?w(t):t)}}}var P,U,E,O=!0;function F(e,t,i){if(t){var n=window.navigator;if(n&&n.sendBeacon)try{return void n.sendBeacon(t,e)}catch(e){}!function(e,t,i){var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,i),n.send(e))}(e,t,i)}}!function(e){e.Unknown="UNKNOWN",e.Initialized="INITIALIZED",e.Prebooted="PREBOOTED",e.Booting="BOOTING",e.Booted="BOOTED",e.Failed="FAILED",e.Disposing="DISPOSING",e.Disposed="DISPOSED"}(P||(P={})),function(e){e[e.u=0]="msoulscat_ES_EWAJS",e[e.h=1]="msoulscat_ES_EWAJSGrid",e[e.v=6]="msoulscat_ES_EWAJSChart",e[e.g=202]="msoulscat_MSOSP_FileMenuCommands",e[e._=220]="msoulscat_MSOSP_AddInCommands",e[e.A=225]="msoulscat_MSOSP_OTelJS",e[e.P=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.U=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.O=301]="msoulscat_Wac_WordViewer",e[e.F=306]="msoulscat_Wac_BrowserGeneral",e[e.N=320]="msoulscat_Wac_TaskPane",e[e.R=339]="msoulscat_Wac_OneNoteGeneral",e[e.k=340]="msoulscat_Wac_Ribbon",e[e.B=356]="msoulscat_Wac_WacFeedback",e[e.H=379]="msoulscat_Wac_WopiPendingApplication",e[e.J=383]="msoulscat_Wac_Telemetry",e[e.j=391]="msoulscat_Wac_WacCatchUpActivities",e[e.q=394]="msoulscat_Wac_Dictation",e[e.K=395]="msoulscat_Wac_OneNoteSync",e[e.Z=700]="msoulscat_Wac_VisioApp",e[e.$=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.X=800]="msoulscat_Wac_PptAnimation",e[e.Y=833]="msoulscat_Wac_PptLive",e[e.ee=834]="msoulscat_Wac_PptMWeb",e[e.te=835]="msoulscat_Wac_PptGc2General",e[e.ie=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.ne=837]="msoulscat_Wac_PptGc2Operation",e[e.oe=844]="msoulscat_Wac_PptDataSync",e[e.re=848]="msoulscat_Wac_PptFluidRuntime",e[e.se=815]="msoulscat_Wac_PptShape",e[e.ae=817]="msoulscat_Wac_PptSession",e[e.ce=830]="msoulscat_Wac_PptSlideshow",e[e.ue=822]="msoulscat_Wac_PptView",e[e.de=846]="msoulscat_Wac_PptVideos",e[e.le=1303]="msoulscat_Uci_Insights",e[e.fe=2300]="msoulscat_Wac_VersionHistory",e[e.he=302]="msoulscat_Wac_WordPresence",e[e.pe=3e3]="msoulscat_Wac_OAuth",e[e.ve=3005]="msoulscat_Wac_WordVersionHistory",e[e.me=3006]="msoulscat_Wac_LivePersonaCard",e[e.we=3012]="msoulscat_Wac_CatchUpFlyout",e[e.ge=3016]="msoulscat_Wac_WordDesigner",e[e.Se=3021]="msoulscat_Wac_ModernFontPicker",e[e.Ie=3027]="msoulscat_Wac_UnifiedUiHost",e[e.be=3033]="msoulscat_Wac_EquationTools",e[e.Te=1401]="msoulscat_Osf_Latency",e[e._e=1402]="msoulscat_Osf_Notification",e[e.ye=1403]="msoulscat_Osf_Runtime",e[e.Ce=3041]="msoulscat_Wac_AiMaker",e[e.Ae=3043]="msoulscat_Wac_AiRewrite",e[e.Pe=3044]="msoulscat_Wac_AiInsert",e[e.Ue=3047]="msoulscat_Wac_AiSummarize",e[e.Ee=3048]="msoulscat_Wac_CopilotCompose",e[e.Oe=3049]="msoulscat_Wac_Skittles"}(U||(U={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(E||(E={}));var N={BUILD_NUMBER:"16.0.17324.40506"};function R(){try{return"16.0.17324.40506"}catch(e){return N.BUILD_NUMBER}}function k(){return 1732440506}var W,D;function M(e,t,i){!function(e,t,i,n){void 0===n&&(n=!0);var o={type:t.toString(),payloadJson:JSON.stringify(i)};F(JSON.stringify(o),e,n)}(e,W.JSAPI_STATE,{application:t,build:R(),state:i})}function x(e,t,i,n){var o=[],r=e.map((function(e){return function(e,t,i){var n={};if(n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category,e.correlationId){var o=i.findIndex((function(t){return t===e.correlationId}));o<0&&(o=i.push(e.correlationId)-1),n.I=o}var r=1e3*e.type+e.level;return n.D=r,n}(e,n,o)})),s=function(e,t,i,n,o){var r={};r.T=e,r.L=t,r.S=i,r.I=n,o&&o.length>0&&(r.W=o);return r.V=1,r}(n,r,t,i,o);return JSON.stringify(s)}!function(e){e.JSAPI_STATE="JSAPI_STATE",e.H_V2="H_V2"}(W||(W={})),function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(D||(D={}));var B,H=function(){try{var e=window.performance;return e&&e.now&&e.now()!==1/0}catch(e){return!1}}();function L(){return H?window.performance.now():Date.now()}function V(){if(!B){var e=window.performance;B=H&&e.timing&&e.timing.navigationStart?function(){return Math.round(e.now()+e.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return B()}var J,j,G=function(){function e(e){var t=this;this.Fe=3e4,this.Ne=30,this.Re=0,this.ke=[],this.We=V(),this.De=[],this.Me="",this.xe=0,this.flushOnClose=function(){t.Be(!1,!1)},this.flush=function(){t.He()},this.flushAndSetNewEndpoint=function(e,i){var n,o=t.Le(e);o.localeCompare(null!==(n=t.Ve)&&void 0!==n?n:"",void 0,{sensitivity:"accent"})&&(t.De.push((function(){t.Ve=o,i&&i()})),t.Be(!0,!0))},this.Le=function(e){return e+"?usid="+t.Me+"&officeserverversion="+R()},this.He=function(){window.setTimeout((function(){return t.Be(!0,!0)}),0)},this.Be=function(e,i){var n=L();if(window.clearTimeout(t.Je),t.Ve){if(t.ke.length>0)t.Re+=1,F(x(t.ke.splice(0,e?t.Ne:t.ke.length),t.Me,t.Re,t.We),t.Ve,i),t.We=V();0===t.ke.length&&t.De.length>0&&(t.De.forEach((function(e){"requestIdleCallback"in window?window.requestIdleCallback(e):window.setTimeout(e,0)})),t.De=[]),e&&(t.Je=window.setTimeout((function(){t.He()}),t.ke.length>t.Ne||t.De.length>0?1e3:t.Fe)),t.xe+=L()-n}},e&&this.configure(e)}return e.prototype.getTimeSpentLogging=function(){return this.xe},e.prototype.addLoggingTime=function(e){this.xe+=e},e.prototype.configure=function(e){var t=this,i=L();if(e.uploadCadenceInMs&&(this.Fe=e.uploadCadenceInMs),e.uploadTriggerSize&&(this.Ne=e.uploadTriggerSize),e.sessionId&&(this.Me=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this.Ve)throw new Error("Remote ULS endpoint is already set");this.Ve=this.Le(e.remoteUlsEndpoint),this.We=V(),window.setTimeout((function(){return t.Be(!0,!0)}),0)}this.xe+=L()-i},e.prototype.handleTrace=function(e){var t=L();e.message.length>3072&&(e.message=e.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.ke.push(e),(this.ke.length>this.Ne||e.level===E.Error)&&this.He(),this.xe+=L()-t},e.prototype.getUserSessionId=function(){return this.Me},e}(),z=[];!function(e){e.je="BootstrapperMaxUlsHeartbeatTime",e.Ge="BootstrapperNoCompleteWarning1Time",e.ze="BootstrapperNoCompleteWarning2Time",e.qe="RemoteUlsETag",e.Ke="RemoteUlsSuppressions",e.Ze="BootstrapperSettingsFetchPeriod",e.$e="timestamp",e.Xe="BootstrapperUlsHeartbeatIntervalMs",e.Qe="BootstrapperUlsHeartBeatIsEnabled",e.Ye="BootstrapperUlsUploadCadenceMs",e.et="WordConsumptionViewToEditRedirectIsEnabled",e.tt="RequestedCallThrottlingDefaultToViewMinimumValue",e.it="BulsEndpointUrl",e.nt="EnableCommonHostDiagnosticsParams",e.ot="EnableICNForWord",e.rt="EnableModernEmbedViewForPowerPoint",e.st="EnableModernReadingViewForPowerPoint",e.ct="EnableDefaultToModernForPowerPoint",e.ut="ShouldLogJsApiKpisForWord",e.dt="EnableFramePageErrorReportingForWord",e.lt="WordSwitchToViewInTeamsJsapiV1Enabled"}(j||(j={}));function q(e){var t=new G(e);function i(e,i,n,o){var r=L();if(!function(e){return 1===z[e]}(e)){var s={timestamp:V(),category:i,tag:e,level:n,type:D.Trace,message:o,correlationId:""};t.addLoggingTime(L()-r),t.handleTrace(s)}}return{ULS:{ft:function(e,t,n,o){i(e,t,n,o)},shipAssertTag:function(e,t,n,o){n&&i(e,t,E.Error,o)},debugAssertTag:function(e,t,i,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:function(){}},configure:function(e){t.configure(e)},settingsChangeHandler:function(e){var i,n;i=e.ht.getValue(j.Ke,""),n=e.ht.getValue(j.qe,""),J&&n===J||(z=[],J=n,i&&i.split(",").forEach((function(e){var t=parseInt(e,10);t&&(z[t]=1)}))),t.configure({uploadCadenceInMs:e.ht.getValue(j.Ye,6e4)});var o=e.ht.getValue(j.it,"").toString();""!==o&&t.flushAndSetNewEndpoint(o)},getTimeSpentLogging:function(){return t.getTimeSpentLogging()},getUserSessionId:function(){return t.getUserSessionId()},flushAndSetNewEndpoint:function(e,i){t.flushAndSetNewEndpoint(e,i)}}}var K=function(e,t){return(K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};var Z=function(){return(Z=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function $(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function X(e,t){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(c){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(i=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{i=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}Object.create;function Q(e,t,i){if(i||2===arguments.length)for(var n,o=0,r=t.length;o<r;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}var Y;Object.create;function ee(e){if(e){var t=e.lastIndexOf(".");if(-1!==t)return e.substring(t+1).toLowerCase()}return""}function te(e,t){return void 0===t?null:t}function ie(e){if(!e)return"";var t=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(Object.getPrototypeOf(e));return JSON.stringify(e,Q(Q([],t,!0),i,!0))}function ne(e,t){return{isFeatureEnabled:function(i){return function(e,t,i){if(!t)return;try{return t(e)}catch(e){i&&i.ULS.ft(594883024,U.H,E.Error,"IsFeatureEnabled callback error: "+ie(e))}return}(i,e,t)}}}function oe(e,t){var i={};if(Object.keys(Y).forEach((function(t){var n=e.isFeatureEnabled(Y[t]);void 0!==n&&(i[Y[t]]=n?"1":"0")})),t&&t.wdFlights)for(var n=0,o=t.wdFlights.toLowerCase().split(",");n<o.length;n++){var r=o[n];"et-treatment"!==r&&"et-control"!==r||(i[Y.pt]="et-treatment"===r?"1":"0")}return JSON.stringify(i)}!function(e){e.pt="EnterpriseTemplates",e.vt="ExcelAdaptiveLayoutDownload",e.wt="ExcelLandingPageOfflineTelemetry",e.gt="ExcelLandingPageObserverRetry",e.St="H2StaticContent",e.It="HashedUrl",e.bt="ODCShareLinkPreload",e.Tt="OfficeComExcelJsApiV2",e._t="OfficeComPptJsApiV2",e.yt="OfficeComUiHost",e.Ct="OfficeComWordJsApiV2",e.At="OfficeHwaUiHost",e.Pt="OfficeUnifiedUiHostTeams",e.Ut="WordViewToUnifiedRead"}(Y||(Y={}));var re,se,ae,ce,ue,de,le=function(){function e(){this.Et=[]}return e.prototype.add=function(e){e&&this.Et.push(e)},e.prototype.remove=function(e){if(e){var t=this.Et.indexOf(e);t>-1&&this.Et.splice(t,1)}},e.prototype.removeAll=function(){this.Et=[]},e.prototype.dispatch=function(e,t){this.Et.forEach((function(i){try{i(e)}catch(e){t&&t(e)}}))},e}(),fe=function(){function e(e,t){var i=this;this.Ot=0,this.Ft=function(){try{if(!window||!window.localStorage)return;var e=window.localStorage.getItem(i.Nt);if(!e)return;var t=JSON.parse(e);i.Rt(t)}catch(e){i.kt.ULS.ft(592836768,U.H,E.Warning,"Failed to get settings from localStorage: "+ie(e))}},this.Rt=function(e){return!!i.Wt(e)&&(i.Dt=e,i.Mt.dispatch({ht:i},(function(e){i.kt.ULS.ft(592836769,U.H,E.Error,"Settings listener error: "+ie(e))})),!0)},this.Wt=function(e){if(e&&"object"==typeof e){if(e.hasOwnProperty(j.$e)&&!isNaN(e.timestamp))return!0;i.kt.ULS.ft(592836770,U.H,E.Error,"Received invalid settings")}return!1},this.xt=function(){if(i.Bt){var e=new XMLHttpRequest;e.open("GET",i.Bt),e.responseType="json",e.timeout=5e3,e.send(),e.onload=function(){if(200===e.status&&e.response?(i.Ht(e.response),i.Ot=0):(i.kt.ULS.ft(592836771,U.H,E.Error,"Fetch settings error. Status: ".concat(e.status,", curErrors: ").concat(i.Ot)),i.Ot+=1),!(i.Ot>7)){var t=i.getValue(j.Ze,3e5);i.Ot>3&&(t+=(i.Ot-3+1)*(t/2)),i.Lt=window.setTimeout(i.xt,t)}}}},this.Ht=function(e){"requestIdleCallback"in window?(i.Vt&&self.cancelIdleCallback(i.Vt),i.Vt=window.requestIdleCallback((function(){return i.Jt(e)}),{timeout:1e4})):window.setTimeout((function(){return i.Jt(e)}),0)},this.Jt=function(e){if(i.Rt(e)&&window&&window.localStorage){var t=JSON.stringify(e);try{window.localStorage.setItem(i.Nt,t)}catch(e){i.kt.ULS.ft(592836800,U.H,E.Warning,"Failed to set localStorage: "+ie(e))}}},this.jt=e,this.Nt="Prod"+e+"Settings",this.kt=t,this.Mt=new le,this.Ft()}return e.prototype.initializePeriodicFetch=function(e,t){this.Nt=(r(e)?"FF":"Prod")+this.jt+"Settings",this.Ft(),this.Bt=e+"AppSettingsHandler.ashx?app="+this.jt+"&usid="+t+"&build="+R(),this.Lt||(this.Lt=window.setTimeout(this.xt,3e4))},e.prototype.getValue=function(e,t){if(this.Dt||this.Ft(),!this.Dt||!this.Dt.hasOwnProperty(e))return t;var i=this.Dt[e],n=typeof t;if(typeof i===n)return i;if("string"==typeof i){if("number"===n)return parseInt(i,10);if("boolean"===n)return"true"===i}return t},e.prototype.addSettingsChangeListener=function(e){this.Mt.add(e)},e.prototype.removeSettingsChangeListener=function(e){this.Mt.remove(e)},e.prototype.dispose=function(){this.Lt&&window.clearTimeout(this.Lt),this.Vt&&self.cancelIdleCallback(this.Vt),this.Lt=void 0,this.Vt=void 0,this.Dt=void 0,this.Mt.removeAll()},e}();!function(e){e.appReboot="appReboot",e.boot="boot",e.closeTab="closeTab",e.createNew="createNew",e.dispose="dispose",e.frameTrust="frameTrust",e.getAuthToken="getAuthToken",e.getHostKeyValue="getHostKeyValue",e.handleBootState="handleBootState",e.postWacToken="postWacToken",e.rename="rename",e.setOverlayContent="setOverlayContent",e.storeHostKeyValue="storeHostKeyValue",e.switchMode="switchMode",e.updateBootComplete="updateBootComplete"}(re||(re={})),function(e){e.blurFocus="blurFocus",e.boot="boot",e.completeCreateNew="completeCreateNew",e.continueAccessibilityLoop="continueAccessibilityLoop",e.createNew="createNew",e.dispose="dispose",e.grabFocus="grabFocus",e.moveToFolder="moveToFolder",e.popState="popState",e.sendChannelId="sendChannelId",e.sendConvId="sendConvId",e.teamsUsersReply="teamsUsersReply",e.teamsUserMentionReply="teamsUserMentionReply",e.backButtonPressed="backButtonPressed",e.getClientUrl="getClientUrl",e.getWebUrl="getWebUrl",e.sendOwlFrameDiagnostics="sendOwlFrameDiagnostics",e.rename="rename",e.completeSharedFilePicker="completeSharedFilePicker",e.sendAccessToken="sendAccessToken",e.sendAuthToken="sendAuthToken",e.sendCustomAuthConfig="sendCustomAuthConfig",e.sendEmbeddedViewUrl="sendEmbeddedViewUrl",e.sendFrameTrustResult="sendFrameTrustResult",e.sendHWRTelemetry="sendHWRTelemetry",e.sendSessionInfo="sendSessionInfo",e.sendUserAccessAndPermissions="sendUserAccessAndPermissions",e.sendWopiInfo="sendWopiInfo",e.sendDavUrl="sendDavUrl",e.switchMode="switchMode",e.signalShared="signalShared",e.postWacToken="postWacToken"}(se||(se={})),function(e){e.Gt="App_AccessibilityLoopComplete",e.zt="Wac_ActionComplete",e.qt="WacInitialize_Ready",e.Kt="Wac_AppFailed",e.Zt="Wac_AppBootState",e.$t="Wac_AppCompleted",e.Xt="BrowserEvent",e.Qt="UI_Close",e.Yt="App_CloseTab",e.ei="UI_Conversation",e.ti="UI_CopyAndEdit",e.ii="App_CreateNewDocument",e.ni="Wac_AppDataSavedStatus",e.oi="UI_Download",e.ri="UI_Edit",e.si="Error",e.ai="UI_FileEmbed",e.ci="UI_FileProperties",e.di="File_Rename",e.li="File_RenameFailed",e.fi="UI_FileVersions",e.hi="StateChanged",e.pi="App_IsFrameTrusted",e.vi="GetAccessToken",e.mi="App_GetAuthToken",e.wi="App_GetCustomAuthConfig",e.gi="App_GetHostKeyValue",e.Si="App_WopiInfoFromUrl",e.Ii="App_DavUrlFromIds",e.bi="App_LoadingStatus",e.Ti="App_SwitchMode",e._i="App_MoveToFolder",e.yi="UI_OpenInMobileApp",e.Ci="UI_OpenInBrowser",e.Ai="UI_OpenInClient",e.Pi="PageChanged",e.Ui="App_PushCommentContext",e.Ei="App_PushState",e.Oi="App_DocReboot",e.Fi="UI_RedeemForCommenting",e.Ni="App_RefreshSessionInfo",e.Ri="UI_ReplyWithChanges",e.ki="UI_ReportAbuse",e.Wi="App_FilePicker",e.Di="UI_SaveStatus",e.Mi="WopiSession_Complete_Ack",e.xi="SetOverlayContent",e.Bi="UI_Sharing",e.Hi="UI_ShareForm",e.Li="UI_SignIn",e.Vi="App_StoreHostKeyValue",e.Ji="App_Unloaded",e.ji="App_UlsLog",e.Gi="Wac_UnloadingApp",e.zi="App_UpdateBootComplete",e.qi="PageCount",e.Ki="UI_CheckUserAccessAndGrantPermissions",e.Zi="User_Activity",e.$i="Edit_Notification",e.Xi="UI_Workflow",e.Qi="ZoomChanged",e.Yi="CAAEMessage",e.en="Excel_HostFrameCacheSave",e.tn="Excel_HostFrameCacheEvict",e.in="Excel_RegenerateFileBundle",e.nn="App_SwitchToWacFrame",e.on="App_SaveSSRData",e.rn="App_PurgeDataInHostCache",e.sn="App_SaveHostRenderingV2Data",e.an="App_SaveHostUtilsData",e.cn="AcquireOAuthTokenTeams",e.un="App_SwitchNotebook",e.dn="FailedBoot_CheckFileInfo",e.ln="GetTeamsUsers",e.fn="SendTeamsUserMention",e.hn="NavigateBackToHost",e.pn="App_GetClientUrlComplete",e.vn="App_GetWebUrlComplete",e.mn="App_CopyLinkComplete",e.wn="App_SendConversationId",e.gn="CloseTeamsConversation",e.Sn="PageLoaded",e.In="Visio_BRS",e.bn="Visio_SendLicenseInfo",e.Tn="Visio_Consumption_CLTComplete",e._n="Visio_SwitchMode_FromViewFrame",e.yn="Visio_ModeSwitch_ToHost_Ack",e.Cn="Visio_UpdateEditUrl",e.An="Visio_PageViewLoaded",e.Pn="Visio_ActiveAppFrameLoadFailed",e.Un="Visio_DisposeBkgFrame",e.En="Visio_ReadyToReceiveDocData",e.On="Visio_DocReboot_HostNav",e.Fn="Visio_SwitchToVisioFrame",e.Nn="WacAppPerfMetric",e.Rn="App_ModifyURLState",e.kn="App_WacTokenAck"}(ae||(ae={})),function(e){e.Wn="Ack",e.Dn="WacInitialize_Ready_Ack",e.Mn="Wac_BeforeUnloadApp",e.xn="Blur_Focus",e.Bn="Wac_AppFailed_Ack",e.Hn="Wac_AppCompleted_Ack",e.Ln="WopiStartSession_Complete",e.Vn="WopiPendingSession_Complete",e.Jn="Host_AccessibilityLoopComplete",e.pi="Host_IsFrameTrusted",e.jn="Grab_Focus",e.Gn="HostCacheDiagnostic",e.zn="Host_KeyValue",e.qn="JsApiDiagnostics",e._i="Host_MoveToFolder",e.Kn="PageChanged_Ack",e.Zn="App_PopState",e.$n="Host_SendChannelId",e.Xn="Host_SendConversationId",e.Qn="GetTeamsUsers_Reply",e.Yn="SendTeamsUserMention_Reply",e.eo="Host_BackButtonPressed",e.to="Host_GetClientUrl",e.io="Host_GetWebUrl",e.no="OwlFrameDiagnostics",e.oo="File_Rename",e.Wi="Host_FilePicker",e.ro="PostAccessToken",e.so="Host_SetAuthToken",e.ao="Host_SetCustomAuthConfig",e.co="App_PushCommentContext",e.uo="CanEmbed",e.do="Host_RefreshSessionInfo",e.lo="CheckUserAccessAndGrantPermissions_Result",e.fo="Host_WopiInfoFromUrl",e.ho="Host_DavUrlFromIds",e.po="SetCurrentPage",e.vo="SetZoomLevel",e.mo="WopiPendingSession_Fail",e.wo="SetOverlayContent",e.So="WopiPendingApplicationComplete_Received",e.Io="Host_SwitchMode",e.bo="Host_Unload",e.To="PageCount_Ack",e._o="ZoomChanged_Ack",e.yo="Host_ShareUI",e.Co="Host_Telemetry",e.Ao="Visio_ConsumptionCLTComplete_Ack",e.Po="Visio_SwitchMode_FromHF_Ack",e.Uo="Visio_SwitchMode_FromHostFrame",e.Eo="Visio_FallbackToLegacySwitch",e.Oo="Visio_DocumentData",e.Fo="Host_PostWacToken"}(ce||(ce={})),function(e){e.AccessibilityLoopCompleted="AccessibilityLoopCompleted",e.ActionCompleted="ActionCompleted",e.BrowserEvent="BrowserEvent",e.CAAEMessage="CAAEMessage",e.Close="Close",e.ContentDisplayed="ContentDisplayed",e.Conversation="Conversation",e.CopyAndEdit="CopyAndEdit",e.CreateNewDocument="CreateNewDocument",e.Download="Download",e.Edit="Edit",e.Error="Error",e.FileEmbed="FileEmbed",e.FileProperties="FileProperties",e.FileRenamed="FileRenamed",e.FileVersions="FileVersions",e.FrameStateChanged="FrameStateChanged",e.FrameTrust="FrameTrust",e.GetAccessToken="GetAccessToken",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.GetWopiInfoFromUrl="GetWopiInfoFromUrl",e.GetDavUrlFromIds="GetDavUrlFromIds",e.ModeSwitched="ModeSwitched",e.MoveToFolder="MoveToFolder",e.OpenInMobileApp="OpenInMobileApp",e.OpenInBrowser="OpenInBrowser",e.OpenInClient="OpenInClient",e.PageChanged="PageChanged",e.PushState="PushState",e.Reboot="Reboot",e.RedeemForCommenting="RedeemForCommenting",e.RefreshSessionInfo="RefreshSessionInfo",e.ReplyWithChanges="ReplyWithChanges",e.ReportAbuse="ReportAbuse",e.SessionStarted="SessionStarted",e.SharedFilePicker="SharedFilePicker",e.SaveStatus="SaveStatus",e.Share="Share",e.ShareForm="ShareForm",e.SignIn="SignIn",e.SplashScreenShown="SplashScreenShown",e.UserAccessAndPermissions="UserAccessAndPermissions",e.UserActivity="UserActivity",e.UserEditActivity="UserEditActivity",e.Workflow="Workflow",e.ZoomChanged="ZoomChanged",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.LoadingStatus="LoadingStatus",e.SwitchNotebook="SwitchNotebook",e.FailedBootCheckFileInfo="FailedBootCheckFileInfo",e.GetTeamsUsers="GetTeamsUsers",e.SendTeamsUserMention="SendTeamsUserMention",e.NavigateBackToHost="NavigateBackToHost",e.GetClientUrlComplete="GetClientUrlComplete",e.GetWebUrlComplete="GetWebUrlComplete",e.CopyLinkComplete="CopyLinkComplete",e.SendConversationId="SendConversationId",e.CloseTeamsConversation="CloseTeamsConversation",e.PageLoaded="PageLoaded",e.FrameChanged="FrameChanged"}(ue||(ue={}));var he,pe=((de={})[se.boot]={No:re.boot},de[se.createNew]={No:re.createNew},de[se.dispose]={No:re.dispose},de[se.postWacToken]={No:re.postWacToken},de[se.rename]={No:re.rename},de[se.switchMode]={No:re.switchMode},de[ae.Zt]={No:re.handleBootState},de[ae.Yt]={No:re.closeTab},de[ae.pi]={No:re.frameTrust},de[ae.mi]={No:re.getAuthToken},de[ae.gi]={No:re.getHostKeyValue},de[ae.Oi]={No:re.appReboot},de[ae.xi]={No:re.setOverlayContent},de[ae.Vi]={No:re.storeHostKeyValue},de[ae.zi]={No:re.updateBootComplete},de[se.blurFocus]={Ro:ce.xn},de[se.continueAccessibilityLoop]={Ro:ce.Jn},de[se.grabFocus]={Ro:ce.jn},de[se.moveToFolder]={Ro:ce._i},de[se.popState]={Ro:ce.Zn},de[se.sendChannelId]={Ro:ce.$n},de[se.sendConvId]={Ro:ce.Xn},de[se.teamsUsersReply]={Ro:ce.Qn},de[se.teamsUserMentionReply]={Ro:ce.Yn},de[se.backButtonPressed]={Ro:ce.eo},de[se.getClientUrl]={Ro:ce.to},de[se.getWebUrl]={Ro:ce.io},de[se.sendAccessToken]={Ro:ce.ro},de[se.sendAuthToken]={Ro:ce.so},de[se.sendHWRTelemetry]={Ro:ce.Co},de[se.sendCustomAuthConfig]={Ro:ce.ao},de[se.sendDavUrl]={Ro:ce.ho},de[se.sendEmbeddedViewUrl]={Ro:ce.uo},de[se.sendFrameTrustResult]={Ro:ce.pi},de[se.sendSessionInfo]={Ro:ce.do},de[se.sendUserAccessAndPermissions]={Ro:ce.lo},de[se.sendWopiInfo]={Ro:ce.fo},de[se.signalShared]={Ro:ce.yo},de[se.sendOwlFrameDiagnostics]={Ro:ce.no},de[se.completeSharedFilePicker]={Ro:ce.Wi},de[ae.Gt]={ko:ue.AccessibilityLoopCompleted},de[ae.zt]={ko:ue.ActionCompleted},de[ae.Xt]={ko:ue.BrowserEvent},de[ae.Yi]={ko:ue.CAAEMessage},de[ae.Qt]={ko:ue.Close},de[ae.ei]={ko:ue.Conversation},de[ae.ti]={ko:ue.CopyAndEdit},de[ae.ii]={ko:ue.CreateNewDocument},de[ae.oi]={ko:ue.Download},de[ae.ri]={ko:ue.Edit},de[ae.si]={ko:ue.Error},de[ae.ai]={ko:ue.FileEmbed},de[ae.ci]={ko:ue.FileProperties},de[ae.di]={ko:ue.FileRenamed},de[ae.fi]={ko:ue.FileVersions},de[ae.vi]={ko:ue.GetAccessToken},de[ae.Ii]={ko:ue.GetDavUrlFromIds},de[ae.wi]={ko:ue.GetCustomAuthConfig},de[ae.Si]={ko:ue.GetWopiInfoFromUrl},de[ae.hi]={ko:ue.FrameStateChanged},de[ae.Ti]={ko:ue.ModeSwitched},de[ae._i]={ko:ue.MoveToFolder},de[ae.yi]={ko:ue.OpenInMobileApp},de[ae.Ci]={ko:ue.OpenInBrowser},de[ae.Ai]={ko:ue.OpenInClient},de[ae.Pi]={ko:ue.PageChanged},de[ae.Ei]={ko:ue.PushState},de[ae.Fi]={ko:ue.RedeemForCommenting},de[ae.Ni]={ko:ue.RefreshSessionInfo},de[ae.Ri]={ko:ue.ReplyWithChanges},de[ae.Wi]={ko:ue.SharedFilePicker},de[ae.ki]={ko:ue.ReportAbuse},de[ae.Di]={ko:ue.SaveStatus},de[ae.Bi]={ko:ue.Share},de[ae.Hi]={ko:ue.ShareForm},de[ae.Li]={ko:ue.SignIn},de[ae.Ki]={ko:ue.UserAccessAndPermissions},de[ae.Zi]={ko:ue.UserActivity},de[ae.$i]={ko:ue.UserEditActivity},de[ae.Xi]={ko:ue.Workflow},de[ae.Qi]={ko:ue.ZoomChanged},de[ae.cn]={ko:ue.AcquireOAuthTokenTeams},de[ae.bi]={ko:ue.LoadingStatus},de[ae.un]={ko:ue.SwitchNotebook},de[ae.dn]={ko:ue.FailedBootCheckFileInfo},de[ae.ln]={ko:ue.GetTeamsUsers},de[ae.fn]={ko:ue.SendTeamsUserMention},de[ae.hn]={ko:ue.NavigateBackToHost},de[ae.pn]={ko:ue.GetClientUrlComplete},de[ae.vn]={ko:ue.GetWebUrlComplete},de[ae.mn]={ko:ue.CopyLinkComplete},de[ae.wn]={ko:ue.SendConversationId},de[ae.gn]={ko:ue.CloseTeamsConversation},de[ae.Sn]={ko:ue.PageLoaded},de);function ve(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},i=window.crypto||window.msCrypto;if(i){t.crypto=!0;try{return i.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(ie(e)))}}t.perfNow=H;for(var n=0;n<e.length;n+=1){try{if(H){var o=Math.floor(100*window.performance.now())%10;(o<0||o>9)&&(o=0);for(var r=0;r<o;r+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(ie(e)))}e[n]=Math.floor(16*Math.random())}return t}(e),i=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[i];return i+=1,("x"===t?n:3&n|8).toString(16)})),t]}function me(){return"xxxxxxxx-xxxx-4xxx-xxxx-xxxxxxxxxxxx".replace(/[x]/g,we)}function we(){var e=new Uint8Array(1);return window.self.crypto&&window.self.crypto.getRandomValues?(window.self.crypto.getRandomValues(e),Math.floor(e[0]/16).toString(16)):window.msCrypto&&window.msCrypto.getRandomValues?(window.msCrypto.getRandomValues(e),Math.floor(e[0]/16).toString(16)):Math.floor(16*Math.random()).toString(16)}!function(e){e[e.Firefox=0]="Firefox",e[e.Opera=1]="Opera",e[e.IE=2]="IE",e[e.Edge=3]="Edge",e[e.Chrome=4]="Chrome",e[e.Safari=5]="Safari",e[e.TeamsElectron=6]="TeamsElectron",e[e.Unknown=7]="Unknown"}(he||(he={}));var ge=window.navigator,Se=ge?ge.userAgent:void 0;function Ie(){if(Se){if(Se.indexOf("Firefox")>-1)return he.Firefox;if(Se.indexOf("Opera")>-1||Se.indexOf("OPR")>-1)return he.Opera;if(Se.indexOf("Trident")>-1)return he.IE;if(Se.indexOf("Electron")>-1&&Se.indexOf("Teams")>-1)return he.TeamsElectron;if(Se.indexOf("Edg")>-1)return he.Edge;if(Se.indexOf("Chrome")>-1)return he.Chrome;if(Se.indexOf("Safari")>-1)return he.Safari}return he.Unknown}function be(){try{return!!Se&&Se.indexOf("iPad")>=0||!!Se&&Se.indexOf("Macintosh")>=0&&Ue()&&!Ce()||!!Se&&Se.indexOf("Android")>=0||Ue()}catch(e){return!1}}function Te(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(e){return!1}}function _e(){return Ie()===he.IE&&!function(){if(Ie()!==he.IE)return!1;if(null==document.documentMode||void 0===document.documentMode)return!1;return document.documentMode>=11}()}function ye(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(e){return!1}}function Ce(){return!!Se&&Se.indexOf("iPhone")>=0}function Ae(){return Ce()||/android.+mobile/i.test(ge.userAgent)}function Pe(){return window.devicePixelRatio||(window.screen?window.screen.deviceXDPI/window.screen.logicalXDPI:1)||1}function Ue(){return!!ge&&ge.maxTouchPoints>0}function Ee(e,t){t&&Object.keys(t).forEach((function(i){e[i]=t[i]}))}function Oe(e,t){try{if(void 0===window.performance)return void t.ULS.ft(595948609,U.H,E.Info,"Performance not supported");var i=window.performance.getEntriesByType("resource");if(void 0===i||i.length<=0)return void t.ULS.ft(595948610,U.H,E.Info,"No resources under performance");for(var n=new RegExp(e+"(-boot\\.min|(\\.(app|preview))?\\.boot)(\\.[0-9a-f]{20})?\\.js","i"),o=i.length-1;o>=0;o-=1){var r=i[o],s=r.name.match(n);if(s){var a=JSON.stringify(r);return a=a.replace(new RegExp(r.name,"g"),s[0]),void t.ULS.ft(595948616,U.H,E.Info,a)}}t.ULS.ft(595948484,U.H,E.Info,"Could not find JSAPI resource timing entry")}catch(e){t.ULS.ft(595948617,U.H,E.Info,"Could not trace the resource timing: ".concat(ie(e)))}}function Fe(e){var t,i,n=Z(Z({},e.host),{sessionId:e.hostSessionId,domain:location?location.host:void 0});delete n.siteId,delete n.webId,delete n.uiHostTabId;var o={};if(e.wdParams){var r=JSON.parse(JSON.stringify(e.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){r[e]&&(o[e]=r[e])}));var s=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;o.wdprevioussession&&!s.test(o.wdprevioussession)&&delete o.wdprevioussession,o.wdpreviouscorrelation&&!s.test(o.wdpreviouscorrelation)&&delete o.wdpreviouscorrelation}var a=Z({},e.rebootOverride);delete a.ackExpected,delete a["ui-language"],delete a.wdUserSession,delete a.rebootMode,delete a.documentUrl;var c,u,d=e.wopi;return{accessToken:d?{length:d.accessToken.length,expiry:d.expiry}:"N/A",wacToken:d&&d.wacToken?{length:d.wacToken.length}:void 0,bootParams:e.bootParams,build:R(),host:n,intent:e.intent,jsApiVersion:"v2",rebootOverride:a,region:(c=e.appBaseUrl,u=c.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i),u&&u[1]?u[1]:"public"),sessionOrigin:e.hostInitDiagnostics?e.hostInitDiagnostics.entryPoint:void 0,sessionContext:e.sessionContext,throttling:e.throttling,ui:e.ui,viewMode:e.viewMode,meeting:e.meeting?{id:null===(t=e.meeting)||void 0===t?void 0:t.id,isPresenter:null===(i=e.meeting)||void 0===i?void 0:i.isPresenter}:void 0,wdParams:o}}function Ne(){var e={perfNowSupported:H,browser:he[Ie()],touchMode:be(),highContrast:Te(),windows10x:ye()};try{var t=window.navigator,i=t.connection||t.mozConnection||t.webkitConnection;i&&(e.netDownlink=i.downlink,e.netDownlinkMax=i.downlinkMax,e.netEffectiveType=i.effectiveType,e.netRtt=i.rtt,e.netSaveData=i.saveData,e.netType=i.type),e.deviceMemory=t.deviceMemory,e.logicalProcessors=t.hardwareConcurrency}catch(e){}return e}function Re(e){try{var t=e.hostInitDiagnostics;e.logger.ULS.ft(558155803,U.H,E.Info,"HostInitDiagnostics: "+(t?JSON.stringify(t):"N/A")),e.logger.ULS.ft(596444237,U.H,E.Info,JSON.stringify({session:Fe(e),client:e.clientDiagnostics}))}catch(t){e.logger.ULS.ft(558155804,U.H,E.Error,"Failed to log init info: ".concat(ie(t)))}}function ke(){try{return localStorage.setItem("Test","Test"),localStorage.removeItem("Test"),!0}catch(e){return!1}}var We;function De(e,t){try{var i=parseInt(e,10);if(!i)return;if(i<=V()-6e4)t.ULS.ft(558155805,U.H,E.Warning,"Bad userClickTime or host took 60+s to kick off the session from click");else if(ke()){var n=i.toString(),o=localStorage.getItem("lastUserClickTime");if(o){var r=parseInt(o,10);r&&i<=r?t.ULS.ft(558155806,U.H,E.Warning,"Bad userClickTime: less than or equal to lastUserClickTime, delta: "+(r-i)):localStorage.setItem("lastUserClickTime",n)}else localStorage.setItem("lastUserClickTime",n)}}catch(e){t.ULS.ft(558155807,U.H,E.Error,"Error when tracking userClickTime: "+ie(e))}}function Me(e){var t=window.performance.timing;t&&(e.hostPageNavigationStartTime||(e.hostPageNavigationStartTime=t.navigationStart),e.hostPageFetchStartTime||(e.hostPageFetchStartTime=t.fetchStart),e.hostPageRequestStartTime||(e.hostPageRequestStartTime=t.requestStart),e.hostPageResponseStartTime||(e.hostPageResponseStartTime=t.responseStart),e.hostPageResponseEndTime||(e.hostPageResponseEndTime=t.responseEnd),e.hostPageDomCompleteTime||(e.hostPageDomCompleteTime=t.domComplete));var i=window.performance.navigation;if(i&&(void 0===e.hostPageRedirectCount&&(e.hostPageRedirectCount=i.redirectCount),!e.hostPageNavigationType)){var n="UNKNOWN";switch(i.type){case 0:n="NAVIGATE";break;case 1:n="RELOAD";break;case 2:n="BACK_FORWARD";break;case 255:n="RESERVED"}e.hostPageNavigationType=n}}!function(e){e[e.Unknown=0]="Unknown",e[e.Normal=1]="Normal",e[e.Minor=2]="Minor",e[e.Medium=3]="Medium",e[e.Major=4]="Major",e[e.Critical=5]="Critical"}(We||(We={}));var xe=function(){function e(e,t){this.Wo=function(){return Be(e,"OnBeforeUnload",t)},this.Do=function(){return Be(e,"OnPageHide",t)},this.Mo=function(){return Be(e,"VisibilityChange_"+document.visibilityState,t)},this.xo=function(){return Be(e,"OnUnload",t)},window.addEventListener("beforeunload",this.Wo,{capture:!0,once:!0}),window.addEventListener("pagehide",this.Do,{capture:!0}),window.addEventListener("visibilitychange",this.Mo,{capture:!0}),window.addEventListener("unload",this.xo,{capture:!0,once:!0})}return e.prototype.dispose=function(){window.removeEventListener("beforeunload",this.Wo,{capture:!0}),window.removeEventListener("pagehide",this.Do,{capture:!0}),window.removeEventListener("visibilitychange",this.Mo,{capture:!0}),window.removeEventListener("unload",this.xo,{capture:!0})},e}();function Be(e,t,i){e.ULS.ft(595957843,U.H,E.Info,"Page lifecycle: ".concat(t," fired")+(i?", flushing logger":"")),i&&e.ULS.flush()}var He=["https://augloop.office.com/v2","api://visio.officeapps.live.com/va/00695ed2-3202-4156-8da1-69f60065e255","394866fc-eedb-4f01-8536-3ff84b16be2a","https://officescripting.microsoft.com","https://nleditor.osi.office.net/nleditor","e03a13ee-9730-4cae-8525-47559c8cf18a","https://powerquery.microsoft.com","api://app.powerbi.com/00000009-0000-0000-c000-000000000000"],Le=function(){function e(e){var t=this;this.Bo={},this.Ho=[],this.Lo=function(e){if(e&&e.origin)try{var i=e.data;if("string"==typeof i&&i.includes("AddinTrustedOrigin")){var n=JSON.parse(i),o=n.AddinTrustId;o&&"AddinTrustedOrigin"===n.MessageId&&(t.kt.ULS.ft(560754784,U.H,E.Info,"didReceiveMessage addinTrustId ".concat(o)),t.Bo[o]=e.origin,t.Ho.forEach((function(t){t(o,e.origin)})))}}catch(e){t.kt.ULS.ft(560754785,U.H,E.Error,"AuthTokenTrustValidator didReceiveMessage failed")}},this.kt=e,window.addEventListener("message",this.Lo)}return e.prototype.isResourceTrustedForMessage=function(e){return $(this,void 0,void 0,(function(){var t,i,n,o,r,s,a,c,u=this;return X(this,(function(d){switch(d.label){case 0:return e&&e.Resource?(t=e.Resource,i=e.AddinTrustId,(n=function(e){if(!e)return!1;for(var t=e.toLowerCase(),i=0,n=He;i<n.length;i++){var o=n[i];if(o===t||"".concat(o,"/")===t)return!0}return!1}(t))||!i?[2,n]:this.Bo[i]?[2,Ve(t,this.Bo[i])]:(r=new Promise((function(e){o=function(n,o){i===n&&e(Ve(t,o))},u.Ho.push(o)})),s=-1,2e3,a=new Promise((function(e){s=window.setTimeout((function(){u.kt.ULS.ft(560754786,U.H,E.Warning,"isResourceTrustedForMessage - timeout waiting for addinTrustId: ".concat(i)),e(!1)}),2e3)})),[4,Promise.race([r,a])])):[2,!1];case 1:return c=d.sent(),this.Ho=this.Ho.filter((function(e){return e!==o})),window.clearTimeout(s),[2,c]}}))}))},e.prototype.dispose=function(){this.Bo={},this.Ho=[],window.removeEventListener("message",this.Lo)},e}();function Ve(e,t){try{if(!e||!t)return!1;for(var i=/[?&#%\\]/,n=0;n<e.length;n+=1){var o=e.charCodeAt(n);if(o<33||o>126)return!1;var r=e.charAt(n);if(i.test(r))return!1}var s=e;"api:"===s.substring(0,"api:".length).toLowerCase()&&(s="".concat("https:").concat(s.substring("api:".length)));var a=new URL(s);return"https:"===a.protocol&&t.toLowerCase()===a.origin.toLowerCase()}catch(e){return!1}}var Je=function(){function e(e,t,i,n,o,r,s){var a,c=this;this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.pendingReboot=!1,this.skipWopiValidation=!1,this.appContext={},this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.remoteTelemetryUrl="",this.Vo={},this.onMessage=function(e){var t=e.MessageId,i=e.Values||{},n=c.Vo[t];if(n&&n.length>0)c.Jo(t,i);else{var o=pe[t];if(o){var r=o.No,s=o.ko;r?(c.logger.ULS.ft(574654543,U.H,E.Info,"Running flow: ".concat(r)),c.jo[r](t,i,c,c.Go[r]).catch((function(e){c.zo(r,e)}))):s&&c.raiseEvent(s,i)}}},this.zo=function(e,t){c.logger.ULS.ft(596459925,U.H,E.Error,"".concat(e," flow error: ").concat(ie(t))),c.remoteTelemetryUrl&&M(c.remoteTelemetryUrl,c.appInfo.name,"flowException")},this.Jo=function(e,t){c.logger.ULS.ft(574654544,U.H,E.Info,"Dispatching action: ".concat(e));for(var i=c.Vo[e].slice().reverse(),n=i.length-1;n>-1;n-=1)try{i[n](e,t)}catch(t){c.logger.ULS.ft(596444186,U.H,E.Error,"".concat(e," action handler error: ").concat(ie(t)))}return Promise.resolve({completion:"success"})},this.state=P.Unknown;var u=ve(),d=u[0],l=u[1];this.logger=q(),this.logger.ULS.ft(593506837,U.H,E.Info,JSON.stringify(l)),this.sessionId=d,this.hostSessionId=i.hostSessionId,this.host=e.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=e.user,this.bootstrapperUrl=e.bootstrapperUrl,this.ui=e.ui||{},this.viewMode=e.viewMode,this.application=n,this.appInfo=t,this.session=o,this.featureManager=ne(e.host.capabilities&&e.host.capabilities.isFeatureEnabledCallback,this.logger),this.ht=new fe(t.name,this.logger),this.preloader=t.preloader,a=r(this.featureManager),this.jo=a[0],this.Go=a[1],this.qo=s,this.ht.addSettingsChangeListener(this.logger.settingsChangeHandler),this.clientDiagnostics=Ne(),this.pageStateObserver=new xe(this.logger,!0),this.authTokenTrustValidator=new Le(this.logger)}return Object.defineProperty(e.prototype,"diagnostics",{get:function(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}},enumerable:!1,configurable:!0}),e.prototype.raiseEvent=function(e,t){this.logger.ULS.ft(574654541,U.H,E.Info,"Raising event: ".concat(e));try{this.qo(e,t)}catch(e){this.logger.ULS.ft(593506838,U.H,E.Error,"Event handler error: ".concat(ie(e)))}},e.prototype.addActionHandler=function(e,t){this.Vo[e]||(this.Vo[e]=[]),this.Vo[e].push(t)},e.prototype.removeActionHandler=function(e,t){var i=this.Vo[e];if(i&&i.length>0){var n=i.indexOf(t);n>-1&&i.splice(n,1)}},e.prototype.run=function(e,t,i){var n=this;if(this.state===P.Disposed&&this.backgroundSession)return this.logger.ULS.ft(525203609,U.H,E.Info,"Redirecting to background session: ".concat(e)),this.backgroundSession.run(e,t,i);var o=[],r=this.Vo[e];if(r&&r.length>0)o.push(this.Jo(e,t));else{var s=pe[e];if(s){var a=s.No,c=s.Ro;if(a){this.logger.ULS.ft(574654542,U.H,E.Info,"Running flow: ".concat(a));var u=this.jo[a](e,t,this,this.Go[a],i).catch((function(e){return n.zo(a,e),{completion:"failure",error:e}}));o.push(u)}else c&&(this.container&&this.container.postMessage(c,t),o.push(Promise.resolve({completion:"success"})))}else o.push(Promise.resolve({completion:"failure"})),this.logger.ULS.ft(593500189,U.H,E.Warning,"Unhandled command: ".concat(e))}return Promise.race(o)},e.prototype.dispose=function(){if(this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.ht.dispose(),this.pageStateObserver.dispose(),this.authTokenTrustValidator.dispose(),this.Vo={},!this.pendingReboot){var e=this.application.sessions,t=e.indexOf(this.session);t>-1&&e.splice(t,1)}},e}();var je,Ge=function(){function e(e,t,i,n,o,r){var s=this;!function(e){if(!e)throw new TypeError("SessionInitParams");if(!e.hostSessionId)throw new TypeError("HostSessionId")}(i);this.Ko=new Je(e,t,i,n,this,r,(function(e,t){return o({type:e,data:t,session:s})})),this.Ko.state=P.Initialized}return Object.defineProperty(e.prototype,"id",{get:function(){return this.Ko.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diagnostics",{get:function(){return this.Ko.diagnostics},enumerable:!1,configurable:!0}),e.prototype.run=function(e,t,i){return this.Ko.run(e,t,i)},e.prototype.boot=function(e,t){return this.Ko.run(se.boot,e,t)},e.prototype.dispose=function(e){return this.Ko.run(se.dispose,void 0,e)},e}(),ze=function(){function e(e,t,i){var n,o,r=this;this.Zo="",this.$o="",this.Xo=!1,this.Qo=!1,this.Yo=!1,this.er=!1,this.tr=function(e){var t,i=!1,n=!0,o="",s=!1;if(r.ir&&r.ir.contentWindow&&(i=!0,n=e.source===r.ir.contentWindow),e.origin&&(s=(o=u(e.origin,2).toLowerCase())===r.$o),!r.Xo&&(!r.Qo||s&&n)||r.kt.ULS.ft(593232850,U.H,E.Info,"Window: available["+i+"] valid["+n+"]; Origin: valid["+s+"] expected["+r.$o+"] actual["+o+"]"),s&&(!r.Yo||n)){var a;try{a=JSON.parse(e.data)}catch(e){return void r.kt.ULS.ft(593232851,U.H,E.Info,"Failed to parse event data: ".concat(ie(e)))}var c=a.MessageId;if(c){if(r.kt.ULS.ft(593232854,U.H,E.Info,"Received message: ".concat(c,", correlation: ").concat(a.CorrelationId)),c!==ae.$t&&c!==ae.bi||r.setTargetOrigin(e.origin),a.Values&&a.Values.ackExpected&&r.postMessage(ce.Wn,void 0,a.CorrelationId),r.er&&c===ae.Nn)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[a.Values.name]=a.Values.time);if(r.nr)try{r.nr(a)}catch(e){r.kt.ULS.ft(594556386,U.H,E.Error,"Message handler error: ".concat(ie(e)))}else r.kt.ULS.ft(591933923,U.H,E.Error,"No message handler")}else(r.Xo||r.Qo)&&r.kt.ULS.ft(593232853,U.H,E.Info,"Missing message id")}},this.kt=t,this.setTargetOrigin(e),i&&this.setMessageHandler(i),this.er=!!(null===(o=null===(n=window.location)||void 0===n?void 0:n.search)||void 0===o?void 0:o.match(/wdpa=1/gi)),window.addEventListener("message",this.tr,!1)}return e.prototype.setTargetOrigin=function(e){var t=c(e).toLowerCase();this.Zo&&this.Zo!==t&&this.kt.ULS.ft(593232847,U.H,E.Warning,"Updating origin: [".concat(y(this.Zo),"]->[").concat(y(t),"]")),this.Zo=t,this.$o=u(t,2),this.Xo=r(t),this.Qo=s(t)},e.prototype.setTargetFrame=function(e,t){this.ir=e,this.Yo=!!t},e.prototype.setMessageHandler=function(e){this.nr=e},e.prototype.removeMessageHandler=function(){this.nr=void 0},e.prototype.postMessage=function(e,t,i){if(this.ir&&this.ir.contentWindow){this.kt.ULS.ft(593232849,U.H,E.Info,"Sending message: "+e);var n={MessageId:e,SendTime:V(),CorrelationId:i,Values:t};this.ir.contentWindow.postMessage(JSON.stringify(n),this.Zo)}else this.kt.ULS.ft(593232848,U.H,E.Error,"Missing target to send message: "+e)},e.prototype.dispose=function(){window.removeEventListener("message",this.tr,!1),this.nr=void 0},e}();!function(e){e.or="access_token",e.rr="access_token_ttl",e.sr="wac_token",e.ar="bundleSrc",e.cr="bundleStaleness",e.ur="DocID",e.dr="SiteID",e.lr="WebID",e.hr="ETag",e.pr="feature_status",e.vr="fileExtension",e.mr="fileGetUrl",e.wr="customFontCatalogUrl",e.gr="fileName",e.Sr="fileSize",e.Ir="forceSLR",e.br="frameHeightPx",e.Tr="frameWidthtPx",e._r="highContrast",e.yr="highDpi",e.Cr="host_diagnostics",e.Ar="hostName",e.Pr="huictrls",e.Ur="owner_id",e.Er="sc",e.Or="softBlockedBrowser",e.Fr="templateUrl",e.Nr="touchMode",e.Rr="user_id",e.kr="hfck",e.Wr="hfcv",e.Dr="timeZoneId",e.Mr="darkCssMedia",e.xr="caae",e.Br="meetingId",e.Hr="meetingTitle",e.Lr="meetingType",e.Vr="scheduledStartTime",e.Jr="scheduledEndTime",e.jr="isPresenter",e.Gr="meetingOrganizerId",e.zr="meetingJoinUrl",e.qr="isMeetingTeamsRoom",e.Kr="jsapibuild",e.Zr="owlver",e.$r="owlro",e.Xr="caaemode"}(je||(je={}));function qe(e,t){Ie()===he.Safari?e.style.display=t?"none":"block":e.style.visibility=t?"hidden":"visible"}function Ke(e,t,i){l(t,je.br,String(i?window.outerHeight:e.offsetHeight)),l(t,je.Tr,String(i?window.outerWidth:e.offsetWidth)),l(t,je.Nr,String(be())),l(t,je._r,String(Te())),l(t,je.Ir,String(ye())),l(t,je.Mr,String(function(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(e){return!1}}()))}function Ze(e){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(t){return e&&e.ULS.ft(591525084,U.H,E.Info,"Trust check error: ".concat(ie(t))),!1}}function $e(e){return!(!e||!e.parentNode)&&(e.id?!!document.getElementById(e.id):void 0!==e.isConnected?e.isConnected:document.body.contains(e))}var Xe=function(){function e(e,t){!function(e){if(!e||!e.appendChild)throw TypeError("Container")}(e),this.Qr=e,this.Yr=t,this.es=t+"_Form",this.ts=Ze()}return Object.defineProperty(e.prototype,"element",{get:function(){return this.Qr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameId",{get:function(){return this.Yr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formId",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTopFrameTrusted",{get:function(){return this.ts},enumerable:!1,configurable:!0}),e.prototype.boot=function(e,t,i,n){var o=this;this.kt=i,this.ns=new ze(e,i,this.nr);var r=n.useAdditionalDiv,s=n.permissionsPolicy;this.os&&!r?(this.os.setAttribute("allow",s),this.kt.ULS.ft(588793045,U.H,E.Info,"Wac frame reused")):(this.os=function(e,t,i,n,o,r,s,a){e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.height="100%",e.style.width="100%";var c=e.ownerDocument,u=c.createElement("iframe");if(u.id=t,u.name=t,u.src="",u.title="Office on the web Frame",u.marginWidth="0",u.marginHeight="0",u.style.top="0",u.style.bottom="0",u.style.left="0",u.style.right="0",u.style.height="100%",u.style.width="100%",u.style.display="block",u.style.position="absolute",u.style.backgroundColor="transparent",u.style.border="none",u.frameBorder="0",u.setAttribute("allowfullscreen","true"),u.setAttribute("allowTransparency","true"),u.setAttribute("allow",i),qe(u,s),n&&(e.style.minHeight=n,u.style.minHeight=n),o&&(e.style.minWidth=o,u.style.minWidth=o),a&&u.setAttribute("role","none"),r){var d=c.createElement("div");d.style.top="0",d.style.bottom="0",d.style.left="0",d.style.right="0",d.style.height="100%",d.style.width="100%",d.style.backgroundColor="#393a3d",d.style.backfaceVisibility="hidden",n&&(d.style.minHeight=n),o&&(d.style.minWidth=o),d.appendChild(u),e.appendChild(d)}else e.appendChild(u);return u}(this.Qr,this.Yr,s,n.minHeight,n.minWidth,r,n.isInvisible,n.setNoneRole),this.kt.ULS.ft(588793046,U.H,E.Info,"Wac frame created")),this.ns.setTargetFrame(this.os,n.enforceSameWindow),r&&(this.rs=this.os.parentElement),n.useFrameFixForTeams&&i.ULS.ft(509143245,U.H,E.Info,"Frame fix enabled for teams uiHost"),Ke(this.os,t,n.useFrameFixForTeams),this.ss=function(e,t,i,n,o){var r=e.ownerDocument,s=r.createElement("form");for(var a in s.id=i,s.name=i,s.action=n,s.target=t,s.method="POST",o){var c=r.createElement("input");c.type="hidden",c.name=a,c.value=o[a],s.appendChild(c)}return e.appendChild(s),s}(this.Qr,this.Yr,this.es,e,t);try{this.ss.submit()}catch(e){this.kt.ULS.ft(507909977,U.H,E.Warning,"WAC frame failed to submit, will retry. Error: ".concat(ie(e))),new Promise((function(e){window.setTimeout(e,10)})).then((function(){o.ss.submit()})).catch((function(e){throw o.kt.ULS.ft(507909976,U.H,E.Error,"WAC frame failed to submit on retry. Error: ".concat(ie(e))),e}))}},e.prototype.setVisibility=function(e){this.os&&qe(this.os,e)},e.prototype.setMessageHandler=function(e){this.nr=e,this.ns&&this.ns.setMessageHandler(e)},e.prototype.setWrapperPostMessage=function(e){this.as=e},e.prototype.removeMessageHandler=function(){this.nr=void 0,this.ns&&this.ns.removeMessageHandler()},e.prototype.postMessage=function(e,t){this.as?this.as(e,t):this.ns&&this.ns.postMessage(e,t)},e.prototype.dispose=function(e,t){var i=this;return new Promise((function(n){if(i.ss&&(i.Qr.removeChild(i.ss),i.ss=void 0),i.ns&&(i.ns.dispose(),i.ns=void 0,i.nr=void 0),i.as&&(i.as=void 0),i.kt=void 0,!i.os||!i.rs&&e)n();else{var o=function(){i.rs?(i.rs.removeChild(i.os),i.Qr.removeChild(i.rs)):i.Qr.removeChild(i.os),i.os=void 0,i.rs=void 0,n()};t?o():(i.os.src="about:blank",window.setTimeout(o,0))}}))},e}();var Qe=function(){function e(e,t,i){var n,o=this;this.sessions=[],this.containers=[],this.cs=function(e){o.us.dispatch(e)},function(e){if(!e)throw new TypeError("ApplicationInitParams");var t=e.host;if(!t||!t.storageHostName)throw new TypeError("HostInfo");var i=e.user;if(!i||null==i.id)throw new TypeError("UserInfo")}(e),this.ds=e,this.ls=t,this.fs=i,this.us=new le,(n=e.host.owlVersion)&&(N.BUILD_NUMBER=n),"undefined"!=typeof PerformanceResourceTiming&&void 0===PerformanceResourceTiming.prototype.toJSON&&(PerformanceResourceTiming.prototype.toJSON=function(){return{name:this.name,connectStart:this.connectStart,connectEnd:this.connectEnd}})}return Object.defineProperty(e.prototype,"name",{get:function(){return this.ls.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return R()},enumerable:!1,configurable:!0}),e.prototype.addEventListener=function(e){this.us.add(e)},e.prototype.removeEventListener=function(e){this.us.remove(e)},e.prototype.createContainer=function(e){var t="WacFrame_".concat(this.ls.name,"_").concat(this.containers.length),i=new Xe(e,t);return this.containers.push(i),i},e.prototype.createSession=function(e){var t=new Ge(this.ds,this.ls,e,this,this.cs,this.fs);return this.sessions.push(t),t},e.prototype.dispose=function(e){var t=this,i=this.sessions.map((function(t){return t.dispose(e).catch((function(e){}))}));return Promise.all(i).then((function(e){return t.us.removeAll(),t.sessions=[],t.containers=[],{completion:"success"}}))},e}(),Ye=function(e,t,i){return new Promise((function(t){i.logger.ULS.ft(590111070,U.H,E.Error,"Unsupported flow: ".concat(e)),t({completion:"failure"})}))};function et(e){return!(!(e&&e.source&&e.accessToken)||!e.expiry&&0!==e.expiry)}function tt(e){return function(e,t){var i={};t&&Object.keys(t).forEach((function(e){i[e.toLowerCase()]=t[e]}));return e.split("&").forEach((function(e){if(/^wd\w+=\w+/i.test(e)){var t=e.split("=");i[t[0].toLowerCase()]=t[1]}})),i}(window.location.search.substring(1),e)}function it(e,t,i){var n=Z(Z(Z({},v(e.appUrl)),function(e){var t={};l(t,"jsapi","1"),l(t,"jsapiver","v2"),l(t,"corrid",e.sessionId),l(t,"usid",e.sessionId),l(t,"newsession","1"),l(t,"sftc","1"),e.hostSessionId&&l(t,"hid",encodeURIComponent(e.hostSessionId));var i=e.host;i.uiHostName&&l(t,"uih",i.uiHostName),i.uiHostIntegrationType&&l(t,"uihit",encodeURIComponent(i.uiHostIntegrationType)),i.metaUiHostVersion&&l(t,"muv",encodeURIComponent(i.metaUiHostVersion));var n=i.capabilities;n&&(n.accessibilityLoop&&l(t,"accloop","1"),n.rebootDoc&&l(t,"sdr",n.rebootDoc.toString()),n.createNewDoc&&l(t,"scnd","1"),n.authToken&&l(t,"sat","1"),n.customAuthConfig&&l(t,"cac","1"),n.refreshAccessToken&&l(t,"rat","1"),n.atMentions&&l(t,"sams","1"),n.moveToFolder&&l(t,"mtf","1"),n.noBrowserModalDialogs&&l(t,"nbmd","1"),n.commonFilePicker&&l(t,"sfp","1"),n.directDownload&&l(t,"sdd","1"),n.directPrint&&l(t,"sdp","1"));var o=e.ui;o.language&&l(t,"ui",encodeURIComponent(o.language)),o.uiEmbed&&l(t,"uiembed","1"),(o.hideHeader||"DocGen"===o.contentAssemblyMode||"Templatization"===o.contentAssemblyMode||"ContentAssemblyEdit"===o.contentAssemblyMode||"ContentAssemblyView"===o.contentAssemblyMode)&&l(t,"hhdr","1"),o.highContrast&&l(t,"hcm",encodeURIComponent(o.highContrast)),o.hideFileLocationPicker&&l(t,"hodflp","1"),o.hideAppLauncherInHeader&&l(t,"halh","1"),o.hideChatInHeader&&l(t,"hch","1"),o.hideMeInHeader&&l(t,"hmh","1"),o.hideSearchInHeader&&l(t,"hsh","1"),o.hideWorkflowInHeader&&l(t,"hwfh","1"),o.hideSettingsInHeader&&l(t,"hsth","1"),o.showAppIconInHeader&&l(t,"sih","1"),o.useNeutralColorInHeader&&l(t,"unh","1"),o.openLinksInNewWindow&&l(t,"onw","1"),o.useDarkTheme&&l(t,"udt","1"),"DocGen"!==o.contentAssemblyMode&&"ContentAssemblyView"!==o.contentAssemblyMode||l(t,"readOnly","1");var r=e.wopi;r&&r.source&&l(t,"wopisrc",encodeURIComponent(r.source));var s=e.bootParams;s&&(s.dataLanguage&&l(t,"rs",encodeURIComponent(s.dataLanguage)),s.readOnly&&l(t,"readonly","1"),s.disableChat&&l(t,"dchat","1"),s.cookieCompliant&&l(t,"mscc","1"),s.isNewFile&&(l(t,"new","1"),s.isFromHostTemplate&&l(t,"wdtpl","fromhost"))),e.user.isLicensed&&l(t,"islicenseduser","1"),e.user.isSynthetic&&l(t,"syn","1"),e.actNavId&&l(t,"actnavid",e.actNavId),e.sessionContext&&l(t,"sc",encodeURIComponent(e.sessionContext));var a=e.wdParams;if(a)for(var c in a)l(t,c,a[c]);var u=e.preseededSession;u&&(u.key&&l(t,"preseededsessionkey",encodeURIComponent(u.key)),u.id&&l(t,"preseededwacsessionid",encodeURIComponent(u.id)));var d=e.throttling;d&&(d.protection&&l(t,"ctp",d.protection),d.request&&l(t,"rct",d.request));var h=e.hostInitDiagnostics;h&&(h.entryPoint&&l(t,"wdorigin",encodeURI(h.entryPoint)),h.userClickTime&&l(t,"wdhostclicktime",h.userClickTime.toString()));var p=e.rebootOverride;return p&&p.previousSessionId&&l(t,"wdprevioussession",p.previousSessionId),f(t,"region"),t}(e)),i),o=e.rebootOverride;return o&&o.queryOverrides&&(n=Z(Z({},n),o.queryOverrides)),function(e,t,i){var n=[];for(var o in i)i[o]&&n.push(o+"="+i[o]);return e+t+(n.length>0?"?"+n.join("&"):"")}(e.appBasePath,t,n)}function nt(e,t){var i=function(e){var t={};l(t,"highdpi",String(window.devicePixelRatio>1.24)),l(t,"softblockedbrowser",String(_e())),l(t,"hostname",e.hostName),l(t,"feature_status",oe(e.featureManager,e.wdParams)),l(t,"jsapibuild",R());var i=e.wopi;i&&(l(t,"access_token",i.accessToken),l(t,"access_token_ttl",i.expiry.toString()),i.wacToken&&l(t,"wac_token",i.wacToken));var n=e.customFontCatalogUrl;n&&l(t,"customfontcatalogurl",n);var o=e.contentBundle;if(o&&o.url){l(t,"bundlesrc",o.url);var r=o.staleness,s=null!=r;s&&l(t,je.cr,r.toString()),e.logger.ULS.ft(577783775,U.H,E.Info,"Content bundle staleness: "+(s?r:"N/A"))}var a=e.file,c=a.name;if(c){l(t,"filename",c);var u=ee(c);u&&l(t,"fileextension",u)}a.getUrl&&l(t,"filegeturl",a.getUrl),a.size&&l(t,"filesize",a.size.toString()),a.eTag&&l(t,"etag",a.eTag),a.cTag&&l(t,"revid",a.cTag),a.uniqueId&&l(t,"docid",a.uniqueId);var d=e.newFileTemplate;d&&(d.getUrl&&l(t,"templateurl",d.getUrl),d.size&&l(t,"filesize",d.size.toString()),d.eTag&&l(t,"etag",d.eTag),d.uniqueId&&l(t,"docid",d.uniqueId)),e.user.id&&l(t,"user_id",e.user.id),e.ownerId&&l(t,"owner_id",e.ownerId),e.sessionContext&&l(t,"sc",e.sessionContext);var f=e.ui;f.controls&&l(t,"huictrls",JSON.stringify(f.controls)),"Templatization"!==f.contentAssemblyMode&&"DocGen"!==f.contentAssemblyMode&&"ContentAssemblyEdit"!==f.contentAssemblyMode&&"ContentAssemblyView"!==f.contentAssemblyMode||l(t,"caae","1"),f.contentAssemblyMode&&l(t,"caaemode",f.contentAssemblyMode);var h=e.meeting;h&&(h.id&&l(t,"meetingId",h.id),h.title&&l(t,"meetingTitle",h.title),h.type&&l(t,"meetingType",h.type),h.scheduledStartTime&&l(t,"scheduledStartTime",h.scheduledStartTime),h.scheduledEndTime&&l(t,"scheduledEndTime",h.scheduledEndTime),h.isPresenter&&l(t,"isPresenter",h.isPresenter.toString()),h.organizerId&&l(t,"meetingOrganizerId",h.organizerId),h.joinUrl&&l(t,"meetingJoinUrl",encodeURIComponent(h.joinUrl)),h.isMeetingTeamsRoom&&l(t,"isMeetingTeamsRoom",h.isMeetingTeamsRoom.toString()));var p=e.host;return p.owlVersion&&l(t,"owlver",p.owlVersion),p.owlRollout&&l(t,"owlro",p.owlRollout),t}(e);return Object.keys(t).forEach((function(e){t[e]?i[e]=t[e]:delete i[e]})),i}var ot=function(e,t,i,n,o){return e!==se.createNew?Promise.reject("Wrong flow"):new Promise((function(r){var s={wopiPendingInitializeTime:V()},a=!!(n&&n.parallelizeStartSessionRequest&&n.buildStartSessionRequestParams)&&n.parallelizeStartSessionRequest(i),c=!1,u=!1,d=!1,l=!1,f=void 0,h=void 0,p=!1,v=!1;if(Ie()===he.IE||n&&n.fallBackToSingleStepBootFlow&&n.fallBackToSingleStepBootFlow(i,t))!function(){i.logger.ULS.ft(578074079,U.H,E.Info,"Waiting for WOPI info to start boot");var e=function(e,r){if(c)i.logger.ULS.ft(578074080,U.H,E.Warning,"completeCreateNew already called");else{if(c=!0,s.wopiPendingCompleteTime=V(),"failure"===r.state)return O(r.reason),i.state=P.Failed,void n({completion:"failure"});rt(r.newFile),i.run(se.boot,Z(Z({},t),{wopi:r.wopi}),o).then((function(e){n(e)}))}};i.addActionHandler(se.completeCreateNew,e);var n=function(t){i.removeActionHandler(se.completeCreateNew,e),r(t)};o&&o.subscribe((function(){n({completion:"cancelled"})}))}();else{var m=function(e,t){c?i.logger.ULS.ft(587236372,U.H,E.Warning,"completeCreateNew already called"):(c=!0,s.wopiPendingCompleteTime=V(),"failure"!==t.state?et(f=t.wopi)?(i.wopi=f,i.logger.ULS.ft(587286030,U.H,E.Info,"WOPI info received. Access token: "+JSON.stringify({length:f.accessToken.length,expiry:f.expiry})+", current state: "+JSON.stringify({parallelizeStartSessionRequest:a,wacFrameLoaded:u,wacCanAcceptStartSessionResponse:d})),!a||u&&!d?u&&T():g(),u&&i.container&&i.container.postMessage(ce.So,void 0),rt(t.newFile)):w("InvalidWopiInfo"):w(t.reason))},w=function(e){O(e),u&&i.container&&i.container.postMessage(ce.mo,void 0)},g=function(){i.logger.ULS.ft(587233056,U.H,E.Info,"Making parallelized StartSession request");var t=n.buildStartSessionRequestParams(i,e,f),o=it(i,t.appPageName,t.queryParamsOverrides),r={"Content-Type":"application/x-www-form-urlencoded"},a="access_token="+encodeURIComponent(f.accessToken)+"&access_token_ttl="+encodeURIComponent(f.expiry.toString());s.startSessionStartTime=V(),function(e,t,i,n){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{n&&n(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",e),i)o.setRequestHeader(r,i[r]);o.send(t)}(o,a,r,S)},S=function(e){var t=V();s.startSessionCompleteTime=t,i.logger.ULS.ft(587233057,U.H,E.Info,"StartSession request completed. Status code: ".concat(e.status,", time: ").concat(t)),h={RequestStatus:e.status,ResponseText:e.responseText},u&&d?b():i.logger.ULS.ft(587233058,U.H,E.Info,"StartSession response not yet sent: "+JSON.stringify({wacFrameLoaded:u,wacCanAcceptStartSessionResponse:d,wopiInfoSent:p,startSessionResponseSent:v}))},I=function(e,t){s.readyMessageReceiveTime=V(),i.container&&i.container.postMessage(ce.Dn,void 0),u||(u=!0,d=t.CanAcceptStartSessionComplete,i.logger.ULS.ft(587321567,U.H,E.Info,"App ready: "+JSON.stringify({parallelizeStartSessionRequest:a,wacCanAcceptStartSessionResponse:d,startSessionResponseAvailable:!!h,wopiInfoAvailable:!!f})),c&&i.container&&i.container.postMessage(f?ce.So:ce.mo,void 0),a&&d?b():T(),Ee(i.appInitDiagnostics,t.Diagnostics))},b=function(){v||p||!h||(200===h.RequestStatus?(v=!0,s.completeMessageCreateTime=V(),_(ce.Ln,{StartSessionResponse:h,Diagnostics:s},3)):T())},T=function(){v||p||!f||(p=!0,s.completeMessageCreateTime=V(),n&&n.sendCreateNewWopiInfo?n.sendCreateNewWopiInfo(i):_(ce.Vn,{WopiDetails:{WopiSrc:f.source,AccessToken:f.accessToken,AccessTokenTtl:f.expiry.toString()},Diagnostics:s},3))},_=function(e,t,n){var o=V();n<=0?i.logger.ULS.ft(587233165,U.H,E.Error,"Attempted to complete but no ack. Time: ".concat(o)):(i.logger.ULS.ft(587233166,U.H,E.Info,"Sending complete message. Retries left: ".concat(n-1,", Time: ").concat(o)),s.completeMessageSendTime=o,i.container&&i.container.postMessage(e,t),window.setTimeout(y,1e3,e,t,n-1))},y=function(e,t,n){l||(i.logger.ULS.ft(587233167,U.H,E.Info,"Timeout session complete ack. Retries left: ".concat(n)),_(e,t,n))},C=function(e,t){l=!0},A=function(e){i.removeActionHandler(se.completeCreateNew,m),i.removeActionHandler(ae.qt,I),i.removeActionHandler(ae.Mi,C),r(e)};i.addActionHandler(se.completeCreateNew,m),i.addActionHandler(ae.qt,I),i.addActionHandler(ae.Mi,C),o&&o.subscribe((function(){A({completion:"cancelled"})})),i.skipWopiValidation=!0,i.wopi=void 0,i.run(se.boot,t,o).then((function(e){i.skipWopiValidation=!1,i.wopi=f,A(e)}))}function O(e){i.logger.ULS.ft(596444188,U.H,E.Warning,"Fail with reason: "+(e?JSON.stringify(e):"N/A"))}}))};function rt(e){e&&(e.path&&history.replaceState({},"",e.path),e.title&&(document.title=e.title))}var st=function(){function e(e){var t=this;this.hs=!1,this.ps="",this.vs=[],this.ms=function(e){t.hs||(t.hs=!0,t.ps=e?"timeout":"cancelled",t.vs.map((function(e){return e()})),t.vs=[])},this.ws=e,window.setTimeout((function(){return t.ms(!0)}),e)}return Object.defineProperty(e.prototype,"isCancelled",{get:function(){return this.hs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeoutInMs",{get:function(){return this.ws},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.ps},enumerable:!1,configurable:!0}),e.prototype.cancel=function(){this.ms(!1)},e.prototype.subscribe=function(e){this.hs?e():this.vs.push(e)},e}();function at(e){return new st(e)}var ct=function(e,t,i,n,o){return e!==se.dispose?Promise.reject("Wrong flow"):new Promise((function(e){i.logger.ULS.ft(595714433,U.H,E.Info,"start disposing the application");var r=i.host.requireExplicitUnload,s={disposeStartTime:V(),forceAppUnload:r};i.state=P.Disposing;var a=function(){i.state=P.Disposed,e({completion:"success"})},c=function(e){n&&n.disposeAppSpecificResources&&n.disposeAppSpecificResources(i,t),i.dispose(),s.disposeEndTime=V(),function(e,t,i){if(i){var n=Number(i.hostMessageReceived);t.appUnloadStartTime&&!isNaN(n)&&(t.hostToAppPostMessageLatency=n-t.appUnloadStartTime);var o=Number(i.appMessageSent);!isNaN(o)&&t.appUnloadEndTime&&(t.appToHostPostMessageLatency=t.appUnloadEndTime-o);var r=Number(i.appUnloadStart),s=Number(i.appUnloadEnd);if(isNaN(r)||isNaN(s)||(t.appUnloadLatency=s-r),i.serverTimings){var a=i.serverTimings;for(var c in a)t["st-"+c.toString()]=a[c]}}e.logger.ULS.ft(592524822,U.H,E.Info,"App disposed: "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(i,s,e),i.container?i.container.dispose(i.pendingReboot,r).then(a):a()};if(r){s.appUnloadStartTime=V();i.addActionHandler(ae.Ji,(function(e,t){s.appUnloadEndTime=V(),c(t)})),(o||new st(5e3)).subscribe((function(){i.state===P.Disposing&&(s.appUnloadTimedOut=!0,c())})),i.container&&i.container.postMessage(ce.bo,void 0)}else c()}))};var ut=function(e,t,i,n,o){return e!==ae.pi?Promise.reject("Wrong flow"):new Promise((function(e){if(i.host.capabilities&&i.host.capabilities.frameTrustCheck)i.raiseEvent(ue.FrameTrust,t);else{var n=!!i.container&&i.container.isTopFrameTrusted;i.logger.ULS.ft(592445957,U.H,E.Info,"Top frame is trusted: ".concat(n)),i.container&&i.container.postMessage(ce.pi,{isTopFrameTrusted:n})}e({completion:"success"})}))},dt=function(e,t,i,n,o){return e!==ae.mi?Promise.reject("Wrong flow"):new Promise((function(e){i.authTokenTrustValidator.isResourceTrustedForMessage(t).then((function(n){n?i.raiseEvent(ue.GetAuthToken,t):(i.container.postMessage(ce.so,{AuthToken:"",Error:"accessDenied",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"success"}))}),(function(n){i.container.postMessage(ce.so,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"failure",error:n})}))}))},lt=function(e,t,i,n,o){return e!==ae.Zt?Promise.reject("Wrong flow"):new Promise((function(e){var o=t&&t.state?t.state:"Unknown";i.logger.ULS.ft(592839750,U.H,E.Info,"Boot state: [".concat(o,"]")),o!==ue.SessionStarted&&o!==ue.ContentDisplayed&&o!==ue.SplashScreenShown||i.raiseEvent(o,void 0),n&&n.beforeComplete&&n.beforeComplete(o),e({completion:"success"})}))},ft=function(e,t,i,n,o){if(e!==se.postWacToken)return Promise.reject("Wrong flow");var r=L();return i.logger.ULS.ft(507774685,U.H,E.Important,"postWacToken flow initiated"),new Promise((function(e){var n=function(e,t){i.logger.ULS.ft(507597017,U.H,E.Info,"postWacToken flow completed in ".concat(L()-r," ms")),window.clearInterval(s),window.clearTimeout(a),o({completion:"success"})},o=function(t){i.removeActionHandler(ae.kn,n),e(t)};i.addActionHandler(ae.kn,n);var s=window.setInterval((function(){var e;return null===(e=i.container)||void 0===e?void 0:e.postMessage(ce.Fo,t)}),100),a=window.setTimeout((function(){window.clearInterval(s),i.logger.ULS.ft(507844190,U.H,E.Warning,"postWacToken flow timed out after ".concat(15e3," milliseconds")),o({completion:"timeout"})}),15e3)}))},ht=function(e,t,i,n,o){return e!==se.rename?Promise.reject("Wrong flow"):new Promise((function(e){var n=function(e,i){var n={completion:i.NewName===t.NewName?"success":"failure"};s(n)},r=function(e,t){s({completion:"failure"})},s=function(t){i.removeActionHandler(ae.di,n),i.removeActionHandler(ae.li,r),e(t)};i.addActionHandler(ae.di,n),i.addActionHandler(ae.li,r),(o||new st(5e3)).subscribe((function(){s({completion:"cancelled"})})),i.container&&i.container.postMessage(ce.oo,t)}))};var pt,vt=function(e,t,i,n,o){return e!==ae.xi?Promise.reject("Wrong flow"):new Promise((function(e){!function(e){var t=window.navigator;if(t&&t.virtualKeyboard&&void 0!==t.virtualKeyboard.overlaysContent&&window===top)t.virtualKeyboard.overlaysContent=e}(t.overlayContent),i.container&&i.container.postMessage(ce.wo,void 0),e({completion:"success"})}))};!function(e){e[e.NotCreateNew=0]="NotCreateNew",e[e.UnifiedCreateNew=1]="UnifiedCreateNew",e[e.LegacyCreateNew=2]="LegacyCreateNew"}(pt||(pt={}));var mt,wt="powerpoint.officeapps.live.com",gt="https://ffc-"+wt,St="https://ppc-"+wt,It="https://eurppc-"+wt,bt="https://usc-"+wt,Tt="https://euc-"+wt,_t="https://cac-"+wt,yt="https://ukc-"+wt,Ct="https://auc-"+wt,At="https://jpc-"+wt,Pt="https://inc-"+wt,Ut="https://krc-"+wt,Et="https://frc-"+wt,Ot="https://sgc-"+wt,Ft="https://zac-"+wt,Nt="https://aec-"+wt,Rt="https://gbc-"+wt,kt="https://dec-"+wt,Wt="https://chc-"+wt,Dt="https://noc-"+wt,Mt="https://brc-"+wt,xt="https://sec-"+wt,Bt="https://qtc-"+wt,Ht="https://plc-"+wt,Lt="https://"+wt,Vt="https://cnc-powerpoint.partner.officewebapps.cn",Jt="https://powerpoint.gov.online.office365.us",jt="https://powerpoint.dod.online.office365.us",Gt="https://powerpoint.wac.online.office.eaglex.ic.gov",zt="https://powerpoint.wac.online.office.microsoft.scloud",qt="https://devpr.officeapps.live-int.com",Kt="https://c4-powerpoint-15.cdn.office.net/pods/s/",Zt="https://c1-powerpoint-15.cdn.office.net/pods/s/",$t=((mt={})[gt]=Xt(gt,"https://c5-powerpoint-15.cdn.office.net/pods/s/"),mt[St]=Xt(St,Kt),mt[It]=Xt(It,Kt),mt[Lt]=Xt(Lt),mt[bt]=Xt(bt),mt[Tt]=Xt(Tt),mt[_t]=Xt(_t),mt[yt]=Xt(yt),mt[Ct]=Xt(Ct),mt[At]=Xt(At),mt[Pt]=Xt(Pt),mt[Ut]=Xt(Ut),mt[Et]=Xt(Et),mt[Ot]=Xt(Ot),mt[Ft]=Xt(Ft),mt[Nt]=Xt(Nt),mt[kt]=Xt(kt),mt[Wt]=Xt(Wt),mt[Dt]=Xt(Dt),mt[Mt]=Xt(Mt),mt[xt]=Xt(xt),mt[Bt]=Xt(Bt),mt[Ht]=Xt(Ht),mt["https://powerpoint.online.office.de"]=Xt("https://powerpoint.online.office.de","https://powerpoint.cdn.office.de/pods/s/"),mt[Vt]=Xt(Vt,"https://cdn.partner.officewebapps.cn/pods/s/"),mt[Jt]=Xt(Jt,"https://powerpoint.cdn.office365.us/pods/s/"),mt[Rt]=Xt(Rt,"https://powerpoint.cdn.office365.us/pods/s/"),mt[jt]=Xt(jt,"https://powerpoint.dod.cdn.office365.us/pods/s/"),mt[Gt]=Xt(Gt,"https://powerpoint.cdn.wac.online.office.eaglex.ic.gov/pods/s/"),mt[zt]=Xt(zt,"https://powerpoint.cdn.wac.online.office.microsoft.scloud/pods/s/"),mt[qt]=Xt(qt,qt+"/pods/s/"),mt);function Xt(e,t){return void 0===t&&(t=Zt),{PodsUrl:e+"/pods/",WacCdnStaticServer:t}}function Qt(e){var t=e.substring(0,e.indexOf("/p/"));return $t[t.toLowerCase()]}var Yt=["wdPodsUrl","wdPopsUrl","wdNewPodsFrame","wdNewEnabled","wdfs","wdfsection","wdIncludeHostUrl","wdoverrides"];function ei(e,t,i){if(!t)return e;var n=e,o=null==i,r=n.indexOf("?");if(-1===r)return o?e:n+"?"+t+"="+i;for(var s=n.substr(r+1),a=s.split("&"),c=t+"=",u=!1,d=0;d<a.length;d+=1)if(0===a[d].indexOf(c)){n=n.replace(a[d],o?"":c+i),u=!0;break}return u||o||(s.length>0&&(n+="&"),n+=c+i),n}function ti(e,t){return!e||"wd"!==e.substring(0,2)||Yt.indexOf(e)>=0?"":e+"="+t}function ii(e){for(var t=e,i="",n=0,o=window.location.search.substring(1).split("&");n<o.length;n++){"wdoverrides"===(u=o[n].split("="))[0]&&(i=u[1]);var r=ti(u[0],u[1]);r&&(t+="&"+r)}for(var s=[],a=0,c=(i=i||"").split(/,|%2C/);a<c.length;a++){var u;2===(u=c[a].split(/:|%3A/)).length&&"devicepixelratio"!==u[0].toLowerCase()&&s.push(u[0]+":"+u[1])}return s.push("devicepixelratio:"+Pe()),s.push("RenderGifSlideShow:true"),t=ei(t,"wdoverrides",s.join(","))}function ni(e){var t=I("wdPodsUrl");return t&&!_(t)&&(t=""),t||(t=e),"/"!==t.substr(t.length-1)&&(t+="/"),t}function oi(e,t){var i=e.bootParams,n=e.file;if(!i.isNewFile){if(!n.getUrl)throw Error("Missing FileGetUrl");if(!n.name)throw Error("Missing FileName")}var o=e.preseededSession;o&&o.key&&("_._._."===o.key.slice(0,6)&&"-.-.-."===o.key.slice(-6)||(o.key="_._._."+o.key+"-.-.-."));var r=e.appContext;r.wopiInfoSent=!1,r.bootComplete=!1,r.bootFlowResolve=t,r.bootRecorded=!1;var s=$t[e.appBaseUrl];e.appBasePath=s?s.PodsUrl:e.appBaseUrl+"/pods/";var a=e.wdParams,c=a.wdpodsurl;c&&!_(c)&&(c=""),c||(c=e.appBasePath);var u=/\/$/;if(u.test(c)||(c+="/"),!c)throw Error("Invalid PODS URL");r.podsUrl=c;var d=a.wdpopsurl;if(d&&!_(d)&&(d=""),d||(d=(d=c).substring(0,d.indexOf("/pods/"))),u.test(d)||(d+="/"),!d)throw Error("Invalid POPS URL");if(r.popsUrl=d,e.bootstrapperUrl){r.cdnBasePath=e.bootstrapperUrl.split("/pods/s/")[0]+"/pods/s/"}else r.cdnBasePath=s?s.WacCdnStaticServer:Zt;r.createNewScenario=function(e,t,i,n){var o=pt.NotCreateNew,r="NotCreateNew";t.isNewFile?i.size?(o=pt.LegacyCreateNew,r="CreateNewWithNonZeroByteFile"):(o=pt.UnifiedCreateNew,r="IsNewFile"):t.isFromHostTemplate?(o=pt.UnifiedCreateNew,r="CreateNewFromHostTemplate"):n&&n.getUrl&&(o=pt.UnifiedCreateNew,r="CreateNewFromTemplateSourceUrl");var s={CreateNewScenario:pt[o],reason:r};return e.ULS.ft(34932951,U.H,E.Info,JSON.stringify(s)),o}(e.logger,i,n,e.newFileTemplate),r.shouldUsePods=function(e,t,i,n,o,r,s){var a=!1,c=!1,u="";t?(a="false"!==t,c=!0,u="wdPodsEnabled is available"):i?e===pt.LegacyCreateNew?(a=!1,c=!1,u="Legacy Create New Scenario because non-zero file size"):n?(a=!1,c=!1,u="Embed View fallback to WAC"):(a=!0,c=!0,u="Supported Region"):(a=!1,c=!1,u="Wac region not currently supported by PODS",s.ULS.ft(589168768,U.H,E.Warning,u+": "+r));o||e!==pt.NotCreateNew||(a=!1,c=!1,u+=" | FileGetUrl is empty");var d={ShouldUsePodsOrCached:a,ShouldUsePods:a,CanUsePods:c,ApplicationUrl:r,Reason:u,CreateNewScenario:pt[e]};return s.ULS.ft(561640788,U.H,E.Info,JSON.stringify(d)),a}(r.createNewScenario,a.wdpodsenabled,!!s,g(e.appUrl,"embed"),!!n.getUrl,y(e.appBaseUrl),e.logger);var l=e.hostInitDiagnostics;l&&l.userClickTime&&De(l.userClickTime,e.logger),function(e){var t=e.hostInitDiagnostics,i=e.bootParams,n=e.file,o=!!n.getUrl,r=!!e.customFontCatalogUrl,s=e.contentBundle,a={BootstrapperType:"TypeScript",JsApiVersion:"v2",Preview:!1,Scenario:"Unified App",ApplicationUrl:y(e.appBaseUrl),IsDeepLink:!!I("nav"),BootstrapperInstanceId:me(),IsMobileView:Ae(),ApplicationCustomSettings:{OnDemandServer:y(e.appBasePath),EnableWacFallback:!0},SessionInformation:{HostName:e.hostName,HostSessionId:e.hostSessionId,UiLocale:e.ui.language,DataLocale:i.dataLanguage,DocumentClickTime:t.userClickTime,CurrentTime:V(),UiHost:e.host.uiHostName,WdParams:e.wdParams},Diagnostics:{EntryPoint:t.entryPoint,FileHost:e.host.storageHostName,PodsRing:"",UnifiedUiHostDiagnostics:t.unifiedUiHostDiagnostics},WopiPrecheckInfo:{FileSize:n.size,FileGetUrlBool:o,CustomFontCatalogBool:r,FileGetUrlLength:o?n.getUrl.length:null,FileNameBool:!!n.name,ReadOnly:i.readOnly,IrmEnabled:i.irmEnabled,SupportsDecryptedContentDownload:i.supportsDecryptedContentDownload,ViewOnly:i.viewOnly,PreseededSessionKey:!!e.preseededSession&&!!e.preseededSession.key,FileExtension:ee(n.name)||null,BundleInfo:s?{MajorVersion:s.majorVersion,URLBool:!!s.url}:{}},AppInfo:{AppVersionMajor:1,AppVersionMinor:k(),Environment:"wac",UserAgent:window.navigator.userAgent},AdditionalTelemetry:{PostMessageToken:e.sessionId}};e.logger.ULS.ft(22357763,U.H,E.Info,JSON.stringify(a,te))}(e)}function ri(e){return e.appBasePath}function si(e){return t=e.appBasePath,i=e.sessionId,t+"RemoteTelemetry.ashx"+(i?"?usid="+i:"");var t,i}function ai(e){return!e.appContext.shouldUsePods}var ci="\n  @media screen and (-ms-high-contrast:active)\n  {\n   div#".concat("highContrastDetectionDiv"," a#").concat("highContrastDetectionAnchor","\n   {\n  \tbackground-image: none !important;\n   }\n  }\n\n  div#").concat("highContrastDetectionDiv","\n  {\n   background-color: Window;\n   position: absolute;\n   top: 0px;\n   left: -99999px;\n   width: 1px;\n   height: 1px;\n   opacity: 0;\n   overflow: hidden;\n  }\n\n  div#").concat("highContrastDetectionDiv"," a#").concat("highContrastDetectionAnchor","\n  {\n   background-image: url('data:image/png;base64,").concat("highcontrastdetectordefault","');\n  }\n");function ui(e){var t=e.ownerDocument.createElement("div");t.id="highContrastDetectionDiv",t.ariaHidden="true";var i=e.ownerDocument.createElement("a");i.id="highContrastDetectionAnchor",i.setAttribute("href","#"),i.ariaHidden="true",t.appendChild(i),e.appendChild(t);var n=e.ownerDocument.createElement("style");n.innerHTML=ci,e.ownerDocument.head.appendChild(n);var o=function(){e.ownerDocument.head.removeChild(n),e.removeChild(t)},r=fi(t),s=fi(i);if(r&&s){if(-1===s.backgroundImage.toLowerCase().indexOf("highcontrastdetectordefault")){var a=function(e,t,i){var n=di(e),o=di(t),r=di(i);if(!n||!o||!r)return;return{foregroundTextColor:n,backgroundColor:o,linkColor:r}}(r.color.toLowerCase(),r.backgroundColor.toLowerCase(),s.color.toLowerCase());return o(),{isInHighContrastMode:!0,highContrastColors:a}}return o(),{isInHighContrastMode:!1}}o()}function di(e){return new RegExp("#[0-9A-Fa-f]{6}").test(e)?e:"transparent"===e||"window"===e?"transparent":function(e){var t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);if(t&&4===t.length){var i=t[1],n=t[2],o=t[3];return function(e,t,i){return"#"+li(Number(e),2)+li(Number(t),2)+li(Number(i),2)}(i,n,o)}return}(e)}function li(e,t){for(var i=e.toString(16);i.length<t;)i="0"+i;return i.toLowerCase()}function fi(e){if(e.ownerDocument&&e.ownerDocument.defaultView&&e.ownerDocument.defaultView.getComputedStyle)return e.ownerDocument.defaultView.getComputedStyle(e)}var hi;function pi(){var e,t,i,n=(e={width:window.document.documentElement.clientWidth,height:window.document.documentElement.clientHeight-50},t={width:e.width,height:e.height},(i=t.width<320)&&(t.height-=17),t.height<256&&(t.width-=17),!i&&t.width<320&&(i=!0,t.height-=17),t.width=Math.max(t.width,320),t.height=Math.max(t.height,256),t);return(""+document.cookie).indexOf("WACRibbonMinimizedPPT=true")>=0&&(n.height-=be()?108:94),n.height-=30,n.height-=23,n}function vi(e){var t,i,n={height:e.height-32-1,width:e.width-238-1-17};return(i={width:(t=n).width-20,height:t.height-20}).width<424?i.width=424:i.width>1696&&(i.width=1696),i.height<238.5?i.height=238.5:i.height>954&&(i.height=954),i}function mi(e){if(e.Diagnostics&&e.Diagnostics.entryPoint)return e.Diagnostics.entryPoint;if(!e.ApplicationUrl)return null;var t=S(e.ApplicationUrl,"wdOrigin");return t||null}function wi(e,t,i){if(e)for(var n=0;n<e.length;n+=1){var o=e[n];if(o.name.indexOf(t)>=0)return o.name.toLowerCase()!==t.toLowerCase()&&i.ULS.ft(38147726,U.H,E.Info,"Found partial match for bootstrapper URL perf entry"),o}}function gi(e,t){if(t)try{if(!e)return void t.ULS.ft(557454687,U.H,E.Info,"Missing BootstrapperUrl");if(!window.performance)return void t.ULS.ft(557454688,U.H,E.Info,"Performance API not found on browser");var i=void 0;if(window.performance.getEntriesByName&&(i=wi(window.performance.getEntriesByName(e),e,t)),!i&&window.performance.getEntries&&(t.ULS.ft(557454689,U.H,E.Info,"Searching all entries for bootstrapper timing entry"),i=wi(window.performance.getEntries(),e,t)),!i)return void t.ULS.ft(557454690,U.H,E.Info,"Unable to extract Bootstrapper perf info");var n={name:e,logReason:"UnifiedTSBoot",nameMatchesExpected:i.name===e,connectEnd:i.connectEnd,connectStart:i.connectStart,domainLookupEnd:i.domainLookupEnd,domainLookupStart:i.domainLookupStart,fetchStart:i.fetchStart,initiatorType:i.initiatorType,redirectEnd:i.redirectEnd,redirectStart:i.redirectStart,requestStart:i.requestStart,responseEnd:i.responseEnd,responseStart:i.responseStart,duration:i.duration,entryType:i.entryType,startTime:i.startTime,nextHopProtocol:i.nextHopProtocol,workerStart:i.workerStart,secureConnectionStart:i.secureConnectionStart,transferSize:i.transferSize,encodedBodySize:i.encodedBodySize,decodedBodySize:i.decodedBodySize};t.ULS.ft(34928845,U.H,E.Info,JSON.stringify(n))}catch(e){t.ULS.ft(557454691,U.ae,E.Warning,"Exception extracting Bootstrapper perf info: ".concat(ie(e)))}}function Si(e){return!e||e.toLowerCase().indexOf("#")>-1?Math.random().toString(36).substring(2,25):e}function Ii(e,t){var i=e,n=function(e){if(e.SessionInformation.UiLocale)return e.SessionInformation.UiLocale;return S(e.ApplicationUrl,"ui")}(t);n&&(i=ei(i,"ui",n));var o=function(e){if(e.SessionInformation.DataLocale)return e.SessionInformation.DataLocale;return S(e.ApplicationUrl,"rs")}(t);o&&(i=ei(i,"rs",o));var r=h(t.ApplicationUrl,"mscc");r&&(i=ei(i,"mscc",r));var s=h(t.ApplicationUrl,"wdFR");s&&(i=ei(i,"wdFR",s));var a=mi(t);a&&(i=ei(i,"wdOrigin",b(a)));var c=Si(t.PostMessageToken);return t.PostMessageToken&&(i+="&postMessageToken="+c),(t.SessionInformation.DisableChat||t.ApplicationUrl.toLowerCase().indexOf("dchat=1")>-1)&&(i=ei(i,"dchat","1")),i=function(e,t){var i=t.indexOf("?");if(-1===i)return e;for(var n=e,o=0,r=t.substring(i+1).split("&");o<r.length;o++){var s=r[o].split("=");if(""===h(e,s[0])){var a=ti(s[0],s[1]);a&&(n+="&"+a)}}return n}(i,t.ApplicationUrl)}function bi(e){if(!e)return"";switch(e){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":return"teams";case"ParticipantApp":case"DragonGate":return e;default:return""}}function Ti(e){if(!e)return"";switch(e){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":case"OneDrive":case"ParticipantApp":case"DragonGate":return"SharePoint Online";default:return e}}function _i(e,t,i){if(e){var n="Page lifecycle: "+t+" fired.";i&&(n+="Flushing ULS logger",e.ULS.flushOnClose()),e.ULS.ft(579384268,U.H,E.Warning,n)}}function yi(e){return e.toLocaleLowerCase().indexOf("pod")>=0||e.toLocaleLowerCase().indexOf("pop")>=0}function Ci(e){var t="";for(var i in e)yi(i)||(t+="&"+i+"="+e[i]);return t}function Ai(e){var t=e.wdParams,i=Ae(),n="true"===t.wdembedview||g(e.appUrl,"embed"),o=e.appContext,r=i?"pptmobileapp.aspx":n?"pptembed.aspx":"ppt.aspx",s={},a={};Yt.forEach((function(e){f(s,e)}));var c=["devicepixelratio:"+Pe(),"RenderGifSlideShow:true"],u=t.wdoverrides;u&&u.split(/,|%2C/).forEach((function(e){var t=e.split(/:|%3A/);2===t.length&&"devicepixelratio"!==t[0].toLowerCase()&&c.push(t[0]+":"+t[1])})),l(s,"wdoverrides",c.join(",")),n&&(f(s,"corrid"),f(s,"usid")),be()&&l(a,"touchdevice","1");var d=window.document.documentElement;d&&(void 0!==d.clientWidth&&l(a,"windowwidth",d.clientWidth.toString()),void 0!==d.clientHeight&&l(a,"windowheight",d.clientHeight.toString()));var p=I("previoussessionid");p&&l(a,"previoussessionid",p),ke()&&l(a,"lssupported","1");var v=e.host.capabilities;v&&(v.rebootDoc&&(l(a,"sdr",v.rebootDoc.toString()),f(s,"sdr")),v.createNewDoc&&(l(a,"scnd","1"),f(s,"scnd")),v.authToken&&(l(a,"sat","1"),f(s,"sat")),v.customAuthConfig&&(l(a,"cac","1"),f(s,"cac")),v.refreshAccessToken&&(l(a,"rat","1"),f(s,"rat")),v.atMentions&&(l(a,"sams","1"),f(s,"sams")),v.moveToFolder&&(l(a,"mtf","1"),f(s,"mtf")),v.noBrowserModalDialogs&&(l(a,"nbmd","1"),f(s,"nbmd")),v.commonFilePicker&&(l(a,"sfp","1"),f(s,"sfp")),v.directDownload&&(l(a,"sdd","1"),f(s,"sdd")),v.directPrint&&(l(a,"sdp","1"),f(s,"sdp")));var m=e.ui;(m.hideHeader||"DocGen"===m.contentAssemblyMode||"Templatization"===m.contentAssemblyMode||"ContentAssemblyEdit"===m.contentAssemblyMode||"ContentAssemblyView"===m.contentAssemblyMode)&&(l(a,"hhdr","1"),f(s,"hhdr")),m.hideFileLocationPicker&&(l(a,"hodflp","1"),f(s,"hodflp")),m.hideAppLauncherInHeader&&(l(a,"halh","1"),f(s,"halh")),m.hideChatInHeader&&(l(a,"hch","1"),f(s,"hch")),m.hideMeInHeader&&(l(a,"hmh","1"),f(s,"hmh")),m.hideSearchInHeader&&(l(a,"hsh","1"),f(s,"hsh")),m.hideWorkflowInHeader&&(l(a,"hwfh","1"),f(s,"hwfh")),m.hideSettingsInHeader&&(l(a,"hsth","1"),f(s,"hsth")),m.showAppIconInHeader&&(l(a,"sih","1"),f(s,"sih")),m.useNeutralColorInHeader&&(l(a,"unh","1"),f(s,"unh")),e.hostName&&l(a,"filesrc",e.hostName),e.user.id&&l(a,"userid",e.user.id),m.openLinksInNewWindow&&(l(a,"onw","1"),f(s,"onw")),m.useDarkTheme&&(l(a,"udt","1"),f(s,"udt"));var w=e.viewMode;w&&w.hideToolbar&&l(a,"hvt","1");var S=e.file;S.name&&(l(s,"filename",b(S.name)),f(a,"filename")),S.getUrl&&(l(a,"fileurl",S.getUrl),f(a,"filegeturl")),l(s,"filegeturlbool",S.getUrl?"true":"false"),S.size&&(l(s,"fs",S.size.toString()),f(a,"filesize"));var _=e.newFileTemplate;_&&_.size&&(l(s,"fs",_.size.toString()),f(a,"filesize"));var y=e.contentBundle;y&&y.url&&(l(a,"bundleurl",y.url),f(a,"bundlesrc"));var C=e.bootParams;C.irmEnabled&&l(a,"irmenabled",C.irmEnabled.toString()),C.supportsDecryptedContentDownload&&l(a,"supportsdecryptedcontentdownload",C.supportsDecryptedContentDownload.toString()),C.readOnly&&f(s,"readonly"),l(s,"ro",C.readOnly?C.readOnly.toString():"false"),C.viewOnly&&l(a,"viewonly",C.viewOnly.toString()),C.openViewByDefault&&l(a,"ovbd",C.openViewByDefault.toString());var A=e.preseededSession;A&&(A.key&&(n||l(a,"preseededsessionkey",A.key),f(s,"preseededsessionkey")),A.id&&f(s,"preseededwacsessionid"));var P=e.throttling;P&&(P.protection&&(l(a,"ctp",P.protection),f(s,"ctp")),P.request&&(l(a,"rct",P.request),f(s,"rct")));var O=I("nav");if(O||(O=e.actNavId?e.actNavId:h(e.appUrl,"actnavid")),O){try{var F=T(O),N=JSON.parse(F),R=N.sId;R&&(l(s,"wdslideid",R),l(s,"dc","1"));var W=N.commentId;W&&"null"!==W&&l(s,"wdcommentid",W);var D=N.openMode;D&&"null"!==D&&l(s,"wdopenmode",D)}catch(t){e.logger.ULS.ft(560329684,U.H,E.Error,"Failed to parse navigation id: ".concat(O))}f(s,"actnavid")}if(o.shouldUsePods){e.appBasePath=o.podsUrl,f(s,"powerpointview"),l(s,"wdpodsurl",b(o.podsUrl)),l(s,"wdpopsurl",b(o.popsUrl)),l(s,"fastboot","true"),l(s,"noauth","1");var M=pi(),x=vi(M);l(s,"thpanel",M.height.toString()),l(s,"sw",x.width.toString()),l(s,"sh",x.height.toString());var B=t.wdfs;B&&l(s,"fslide",B);var H=t.wdfsection;H&&l(s,"fsection",H),(B||H||t.wdincludehosturl&&"false"!==t.wdincludehosturl)&&l(s,"frameurl",b(window.location.href));var L=I("automation");L&&l(s,"automation",L);var V=I("startrehearsal");if(V&&l(s,"startrehearsal",V),l(s,"postmessagetoken",e.sessionId),l(a,"postmessagetoken",e.sessionId),e.wdParams){var J=Ci(e.wdParams);J&&l(a,"wdparams",J)}if(l(a,"jsapiversionminor",k().toString()),(G=e.wopi)&&G.source&&(l(a,"wopisrc",G.source),f(s,"wopisrc")),e.container){var j=ui(e.container.element);j&&j.isInHighContrastMode&&(l(a,"isinhighcontrastmode","true"),j.highContrastColors&&l(a,"clientcolorsettings",j.highContrastColors.foregroundTextColor+"_"+j.highContrastColors.backgroundColor+"_"+j.highContrastColors.linkColor))}}else{e.appBasePath||l(s,"nolog","True");var G,z=e.appUrl.substring(0,e.appUrl.indexOf("?")),q=z.lastIndexOf("/")+1;if(e.appBasePath=z.substring(0,q),r=z.substring(q),(G=e.wopi)&&G.source){var K=G.source;K.toLowerCase().indexOf("powerpointframe.aspx")>=0&&(K=decodeURIComponent(h(K,"wopisrc"))),l(s,"wopisrc",b(K))}l(s,"wdenableroaming","1"),l(s,"wdo","1")}return{appPageName:r,queryParamsOverrides:s,postDataOverrides:a}}function Pi(e){if(e.appContext.shouldUsePods){var t=function(i,n){Ui(e),e.removeActionHandler(ae.qt,t)};e.addActionHandler(ae.qt,t);e.addActionHandler(ae.ji,(function(t,i){t===ae.ji&&function(e,t){var i=t;if(!i||"number"!=typeof i.Tag||"number"!=typeof i.Category||"number"!=typeof i.Level||"string"!=typeof i.Message)return;try{e.logger.ULS.ft(i.Tag,i.Category,i.Level,i.Message)}catch(t){e.logger.ULS.ft(512235072,U.H,E.Error,"ulsLog exception: "+t)}}(e,i)}))}gi(e.bootstrapperUrl,e.logger),window.setTimeout((function(){e.logger.ULS.flush()}),1e4)}function Ui(e){var t,i,n=e.appContext;if(!n.wopiInfoSent&&e.wopi){n.wopiInfoSent=!0;var o="";e.wdParams&&(o=Object.keys(e.wdParams).filter((function(e){return!/po[d/p]/i.test(e)})).reduce((function(t,i){return"".concat(t,"&").concat(i,"=").concat(e.wdParams[i])}),""));var r=e.bootParams,s=e.wopi,a=e.hostInitDiagnostics,c={WopiSrc:s.source,AccessToken:s.accessToken,AccessTokenTTL:s.expiry,ReadOnly:r.readOnly,IrmEnabled:r.irmEnabled,SupportsDecryptedContentDownload:r.supportsDecryptedContentDownload,FileName:e.file.name,SessionContext:e.sessionContext,WdParams:o,DocumentURL:window.location.href,PreviousSessionID:I("PreviousSessionID"),FirstPageFlushTime:null!==(t=window.WOPIPerf_FirstPageFlush)&&void 0!==t?t:a.hostPageFirstFlushTime,BootJsStartTime:window.WOPIPerf_BootJsStartTime,BootJsEndTime:window.WOPIPerf_BootJsEndTime,InitializeWacTime:window.WOPIPerf_InitializeWac,UserClickTime:null!==(i=window.WOPIPerf_UserClick)&&void 0!==i?i:a.userClickTime,UnifiedUiHostDiagnostics:a.unifiedUiHostDiagnostics,ClientDiagnostics:e.clientDiagnostics};if(s.wacToken&&(c.WacToken=s.wacToken),e.hostSessionId){var u=e.hostSessionId.indexOf(".");c.HostSessionId=u>0?e.hostSessionId.substring(0,u):e.hostSessionId}if(a.legacyPerformanceData){var d=a.legacyPerformanceData.host;d&&(void 0!==d.timing.navigationStart&&(c.NavigationStart=d.timing.navigationStart),void 0!==d.timing.fetchStart&&(c.FetchStart=d.timing.fetchStart),void 0!==d.timing.requestStart&&(c.RequestStart=d.timing.requestStart),void 0!==d.timing.responseStart&&(c.ResponseStart=d.timing.responseStart),void 0!==d.timing.responseEnd&&(c.ResponseEnd=d.timing.responseEnd),void 0!==d.navigation.type&&(c.NavigationType=d.navigation.type),void 0!==d.navigation.redirectCount&&(c.NavigationRedirects=d.navigation.redirectCount))}else if(window.performance){var l=window.performance.timing;l&&(c.NavigationStart=l.navigationStart,c.FetchStart=l.fetchStart,c.RequestStart=l.requestStart,c.ResponseStart=l.responseStart,c.ResponseEnd=l.responseEnd);var f=window.performance.navigation;f&&(c.NavigationType=f.type,c.NavigationRedirects=f.redirectCount)}e.container.postMessage(ce.Vn,c)}}!function(e){e.bootWithoutWopiInfo="",e.unifiedSingleFlush="Unified_SingleFlush",e.unifiedIrmEnabled="Unified_IrmEnabled",e.unifiedViewActionUrl="Unified_ViewActionUrl",e.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",e.forceSingleStepBoot="Force_SingleStepBoot",e.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",e.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",e.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect"}(hi||(hi={}));var Ei="WebApplicationFrame";function Oi(e,t){var i=document.createElement("input");return i.type="hidden",i.name=e,i.value=t,i}var Fi,Ni=function(){function e(e){this.gs=e}return e.prototype.GetApplicationType=function(){return"PowerPoint"},e.prototype.GetVersion=function(){return R()},e.prototype.GetSessionId=function(){return this.gs},e.prototype.RegisterEventHandler=function(){},e.prototype.RemoveEventHandler=function(){},e.prototype.RegisterErrorHandler=function(){},e.prototype.RemoveErrorHandler=function(){},e.prototype.PostCommand=function(){},e.prototype.Dispose=function(){},e}();function Ri(e,t){if(!e.IsFileNew){if(!e.WopiPrecheckInfo.FileGetUrl)throw Error("Missing FileGetUrl from contentParams");if(!e.WopiPrecheckInfo.FileName)throw Error("Null or Empty Filename")}var i=ni(e.OnDemandServer);if(!i)throw Error("Invalid Pods URL");var n,o,r=(n=e.OnDemandServer,(o=I("wdPopsUrl"))&&!_(o)&&(o=""),o||(o=(o=ni(n)).substr(0,o.indexOf("/pods/"))),"/"!==o.substr(o.length-1)&&(o+="/"),o);if(!r)throw Error("Invalid Pops URL");var s=pi(),a=vi(s),c="true"===I("wdEmbedView")||g(e.ApplicationUrl,"embed"),u=c?"pptembed.aspx":"ppt.aspx",d=Ae();t.ULS.ft(51380293,U.H,E.Info,"IsRequestForMobileView:".concat(d));var l=i+(u=d?"pptmobileapp.aspx":u)+"?wdPodsUrl="+b(i)+"&wdPopsUrl="+b(r)+"&fastBoot=true&sw="+a.width+"&sh="+a.height+"&thPanel="+s.height+"&ro="+e.WopiPrecheckInfo.ReadOnly+"&sftc=1&NoAuth=1&jsApi=1&jsapiver=v1";e.WopiPrecheckInfo.FileName&&(l+="&fileName="+b(e.WopiPrecheckInfo.FileName)),"DocGen"!==e.SessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.SessionInformation.ContentAssemblyMode||(l+="&readonly=1");var f=I("wdfs");f&&(l+="&fslide="+f);var p=I("wdfsection");p&&(l+="&fsection="+p);var v=I("wdIncludeHostUrl");(f||p||v&&"false"!==v)&&(l=ei(l,"frameURL",b(window.location.href))),l=Ii(l=ii(l),e),e.IsFileNew&&(l+="&new=1"),e.NewFileTemplateSource&&e.NewFileTemplateSource.FileSize?l+="&fs="+e.NewFileTemplateSource.FileSize:e.WopiPrecheckInfo.FileSize&&(l+="&fs="+e.WopiPrecheckInfo.FileSize);var m,w=!(m=e.SessionInformation.HostSessionId)||m.toLowerCase().indexOf("#")>-1?Math.random().toString(36).substring(2,25):m;e.SessionInformation.HostSessionId&&(l+="&hid="+w);var y=I("Automation");y&&(l+="&Automation="+y);var C=I("StartRehearsal");C&&(l+="&StartRehearsal="+C),c||(l+="&usid="+e.SessionId),e.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&(l+="&uiEmbed=1"),e.SessionInformation.SupportsAccessibilityLoop&&(l+="&accloop=1"),e.SessionInformation.IsSynthetic&&(l+="syn=1");var A=S(e.ApplicationUrl,"uih");A&&(l+="&uih="+A),e.SessionInformation.UiHostIntegrationType&&(l+="&uihit="+b(e.SessionInformation.UiHostIntegrationType)),"Microsoft Teams"===e.SessionInformation.HostName&&(l+="&fvo=1"),e.SessionInformation.MetaUiHostVersion&&(l+="&muv="+b(e.SessionInformation.MetaUiHostVersion)),e.SessionInformation.HighContrastMode&&(l+="&hcm="+b(e.SessionInformation.HighContrastMode));var P=I("nav");if(P||(P=h(e.ApplicationUrl,"actNavId")),P)try{var O=T(P),F=JSON.parse(O),N=F.sId;N&&(l=ei(l,"wdSlideId",N),l=ei(l,"DC","1"));var W=F.commentId;W&&"null"!==W&&(l=ei(l,"wdCommentId",W));var D=F.openMode;D&&"null"!==D&&(l=ei(l,"wdOpenMode",D))}catch(e){t.ULS.ft(38580688,U.H,E.Error,"Failed to parse navigation ID: ".concat(P))}var M=e.Container;if(M){var x=document.createElement("iframe");x.id=Ei,x.name="wac_frame",x.title="Office Online Frame",x.frameBorder="0",x.style.top="0",x.style.bottom="0",x.style.left="0",x.style.right="0",x.style.height="100%",x.style.width="100%",x.style.minHeight="200px",x.style.minWidth="300px",x.style.position="absolute",x.setAttribute("allowfullscreen","true"),x.setAttribute("allowTransparency","true");var B="";if(Ie()===he.Safari)B+="autoplay;",B+="microphone;",B+="camera;",B+="clipboard-read;",B+="clipboard-write;",B+="display-capture;";else{var H=i+" "+function(e,t){if(t){return t.split("/pods/s/")[0]+"/pods/s/"}if(e){var i=Qt(e);if(i)return i.WacCdnStaticServer;throw Error("Application url provided but region not in region allow list")}return Zt}(e.ApplicationUrl,e.BootstrapperUrl)+";";B+="autoplay "+H,B+="microphone "+H,B+="camera "+H,B+="clipboard-read "+H,B+="clipboard-write "+H,B+="display-capture "+H}x.setAttribute("allow",B),M.style.top="0",M.style.bottom="0",M.style.left="0",M.style.right="0",M.style.height="100%",M.style.width="100%",M.style.minHeight="200px",M.style.minWidth="300px",M.appendChild(x);var L=Date.now(),V=e.WopiPrecheckInfo.FileGetUrl;t.ULS.ft(38580689,U.H,E.Info,V?V.toString().length.toString():"null"),l+="&fileGetUrlBool="+!!V;var J=document.createElement("form");if(J.name="frameForm",J.id="frameForm",J.target="wac_frame",J.action=l,J.method="post",M.appendChild(J),e.WopiInfo){var j=e.WopiInfo.WopiSrc;j&&J.appendChild(Oi("WOPISrc",j));var G=e.WopiInfo.AccessToken;G&&J.appendChild(Oi("access_token",b(G)));var z=e.WopiInfo.AccessTokenExpiry;z&&J.appendChild(Oi("access_token_ttl",z.getTime().toString()));var q=e.WopiInfo.WacToken;q&&J.appendChild(Oi("wac_token",b(q)))}var K=e.SessionInformation.SessionContext;if(K&&J.appendChild(Oi("sc",K)),e.SessionInformation.WdParams){var Z=Ci(e.SessionInformation.WdParams);Z&&J.appendChild(Oi("wdparams",Z))}J.appendChild(Oi("jsapiversionminor",k().toString())),e.SessionInformation.HideViewerToolbar&&J.appendChild(Oi("hvt","1")),V&&J.appendChild(Oi("fileUrl",V));var $=e.WopiPrecheckInfo.CustomFontCatalogUrl;$&&J.appendChild(Oi("customFontCatalogUrl",$)),e.NewFileTemplateSource&&e.NewFileTemplateSource.FileGetUrl&&J.appendChild(Oi("templateUrl",e.NewFileTemplateSource.FileGetUrl)),e.SessionInformation.UserId&&(J.appendChild(Oi("UserID",e.SessionInformation.UserId)),J.appendChild(Oi("user_id",e.SessionInformation.UserId))),e.WopiPrecheckInfo.IrmEnabled&&J.appendChild(Oi("irmEnabled",e.WopiPrecheckInfo.IrmEnabled.toString())),e.WopiPrecheckInfo.SupportsDecryptedContentDownload&&J.appendChild(Oi("SupportsDecryptedContentDownload",e.WopiPrecheckInfo.SupportsDecryptedContentDownload.toString())),e.WopiPrecheckInfo.ViewOnly&&J.appendChild(Oi("ViewOnly",e.WopiPrecheckInfo.ViewOnly.toString())),e.NewFileTemplateSource&&e.NewFileTemplateSource.ETag?J.appendChild(Oi("ETag",e.NewFileTemplateSource.ETag)):e.WopiPrecheckInfo.ETag&&J.appendChild(Oi("ETag",e.WopiPrecheckInfo.ETag)),e.WopiPrecheckInfo.CTag&&J.appendChild(Oi("RevID",e.WopiPrecheckInfo.CTag)),e.NewFileTemplateSource&&e.NewFileTemplateSource.DocUniqueId?J.appendChild(Oi("DocID",e.NewFileTemplateSource.DocUniqueId)):e.WopiPrecheckInfo.DocUniqueId&&J.appendChild(Oi("DocID",e.WopiPrecheckInfo.DocUniqueId)),e.WopiPrecheckInfo.BundleInfo&&e.WopiPrecheckInfo.BundleInfo.Url&&J.appendChild(Oi("bundleUrl",e.WopiPrecheckInfo.BundleInfo.Url)),e.WopiPrecheckInfo.PreseededSessionKey&&!c&&J.appendChild(Oi("PreseededSessionKey",e.WopiPrecheckInfo.PreseededSessionKey)),e.SessionInformation.HostName&&J.appendChild(Oi("fileSrc",e.SessionInformation.HostName)),e.ApplicationCustomSettings&&e.ApplicationCustomSettings.HostUIControls&&J.appendChild(Oi("huictrls",JSON.stringify(e.ApplicationCustomSettings.HostUIControls))),J.appendChild(Oi("feature_status",oe(e.FeatureManager,{wdFlights:I("wdFlights")}))),be()&&J.appendChild(Oi("touchDevice","1")),window.document.documentElement&&(void 0!==window.document.documentElement.clientWidth&&J.appendChild(Oi("windowWidth",window.document.documentElement.clientWidth.toString())),void 0!==window.document.documentElement.clientHeight&&J.appendChild(Oi("windowHeight",window.document.documentElement.clientHeight.toString())));var X=I("PreviousSessionID");if(X&&J.appendChild(Oi("PreviousSessionID",X)),ke()&&J.appendChild(Oi("LSSupported","1")),J.appendChild(Oi("postMessageToken",e.PostMessageToken)),(e.SessionInformation.HideHeader||"teams"===A&&"UnifiedUiHostTeams"!==e.SessionInformation.UiHostIntegrationType&&"TeamsModern"!==e.SessionInformation.UiHostIntegrationType||"owa"===A||"DocGen"===e.SessionInformation.ContentAssemblyMode||"Templatization"===e.SessionInformation.ContentAssemblyMode||"ContentAssemblyEdit"===e.SessionInformation.ContentAssemblyMode||"ContentAssemblyView"===e.SessionInformation.ContentAssemblyMode)&&J.appendChild(Oi("hhdr","1")),e.SessionInformation.HideAppLauncherInHeader&&J.appendChild(Oi("halh","1")),e.SessionInformation.HideSearchInHeader&&J.appendChild(Oi("hsh","1")),e.SessionInformation.HideMeInHeader&&J.appendChild(Oi("hmh","1")),e.SessionInformation.HideChatInHeader&&J.appendChild(Oi("hch","1")),e.SessionInformation.HideWorkflowInHeader&&J.appendChild(Oi("hwfh","1")),e.SessionInformation.HideSettingsInHeader&&J.appendChild(Oi("hsth","1")),e.SessionInformation.ShowAppIconInHeader&&J.appendChild(Oi("sih","1")),e.SessionInformation.UseNeutralColorInHeader&&J.appendChild(Oi("unh","1")),e.SessionInformation.SupportsAuthToken&&J.appendChild(Oi("sat","1")),e.SessionInformation.SupportsCustomAuthConfig&&J.appendChild(Oi("cac","1")),e.SessionInformation.SupportsCreateNewDocument&&J.appendChild(Oi("scnd","1")),e.SessionInformation.UseDarkTheme&&J.appendChild(Oi("udt","1")),e.SessionInformation.SupportsDirectPrint&&J.appendChild(Oi("sdp","1")),e.SessionInformation.SupportsDirectDownload&&J.appendChild(Oi("sdd","1")),"Templatization"!==e.SessionInformation.ContentAssemblyMode&&"DocGen"!==e.SessionInformation.ContentAssemblyMode&&"ContentAssemblyEdit"!==e.SessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.SessionInformation.ContentAssemblyMode||J.appendChild(Oi("caae","1")),e.SessionInformation.ContentAssemblyMode&&J.appendChild(Oi("caaemode",e.SessionInformation.ContentAssemblyMode)),e.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&e.SessionInformation.SupportsDocReboot&&J.appendChild(Oi("sdr",!0===e.SessionInformation.SupportsDocReboot?"1":e.SessionInformation.SupportsDocReboot.toString())),e.SessionInformation.HideWACOneDriveFileLocationPicker&&J.appendChild(Oi("hodflp","1")),e.SessionInformation.SupportsAtMentions&&J.appendChild(Oi("sams","1")),e.WopiPrecheckInfo.RequestedCallThrottling){var Q=e.WopiPrecheckInfo.RequestedCallThrottling;J.appendChild(Oi("rct",Q))}if(e.WopiPrecheckInfo.ClientThrottlingProtection){var Y=e.WopiPrecheckInfo.ClientThrottlingProtection;J.appendChild(Oi("ctp",Y))}e.WopiPrecheckInfo.OpenViewByDefault&&J.appendChild(Oi("ovbd",e.WopiPrecheckInfo.OpenViewByDefault.toString())),e.SessionInformation.SupportsMoveToFolder&&J.appendChild(Oi("mtf","1")),e.SessionInformation.NoBrowserModalDialogs&&J.appendChild(Oi("nbmd","1")),e.SessionInformation.SupportsCommonFilePicker&&J.appendChild(Oi("sfp","1")),e.SessionInformation.OpenLinksInNewWindow&&J.appendChild(Oi("onw","1"));var ee=ui(M);ee&&ee.isInHighContrastMode&&(J.appendChild(Oi("IsInHighContrastMode","true")),ee.highContrastColors&&J.appendChild(Oi("ClientColorSettings",ee.highContrastColors.foregroundTextColor+"_"+ee.highContrastColors.backgroundColor+"_"+ee.highContrastColors.linkColor)));var te=e.SessionInformation.OwlVersion;te&&J.appendChild(Oi("owlver",te));var ie=e.SessionInformation.OwlRollout;return ie&&J.appendChild(Oi("owlro",ie)),J.appendChild(Oi("jsapibuild",R())),J.submit(),{IFrameElement:x,FrameCreateTime:L}}}function ki(e,t,i,n,o){i.ULS.ft(38147724,U.H,E.Info,"Launching Wac Fallback");var r=document.createElement("iframe");r.id=Ei,r.name="wac_frame",r.title="Office Online Frame",r.frameBorder="0",r.style.top="0",r.style.bottom="0",r.style.left="0",r.style.right="0",r.style.height="100%",r.style.width="100%",r.style.minHeight="200px",r.style.minWidth="300px",r.style.position="absolute",r.setAttribute("allowfullscreen","true"),r.setAttribute("allowTransparency","true"),r.style.minHeight="150px";var s=t.Container;s.style.top="0",s.style.bottom="0",s.style.left="0",s.style.right="0",s.style.height="100%",s.style.width="100%",s.style.minHeight="150px";var a=document.createElement("div");a.style.top="0",a.style.bottom="0",a.style.left="0",a.style.right="0",a.style.height="100%",a.style.width="100%",a.style.minHeight="150px",a.style.backgroundColor="#393a3d",a.style.backfaceVisibility="hidden";var c=document.createElement("form");c.name="wac_form",c.id="wac_form",c.target="wac_frame",c.action=function(e,t){if(e.WopiSrc.indexOf("PowerPointFrame.aspx")>=0){var i=e.WopiSrc.substr(e.WopiSrc.indexOf("WOPISrc=")+8),n=i.indexOf("&");e.WopiSrc=n<0?decodeURIComponent(decodeURI(i)):decodeURIComponent(i.substring(0,n))}var o=t.ApplicationUrl,r=o.indexOf("?"),s=o.substring(0,r);return s=ei(s+="?wdEnableRoaming=1&wdo=1","PowerPointView",h(o,"PowerPointView")),g(o,"new")&&(s=ei(s,"New","1")),g(o,"embed")&&(s=ei(s,"Embed","1")),t.OnDemandServer||(s=ei(s,"noLog","True")),e.WopiSrc&&(s=ei(s,"WOPISrc",b(e.WopiSrc))),s=ii(s)}(e,t),c.method="post",c.appendChild(Oi("access_token",e.AccessToken)),c.appendChild(Oi("access_token_ttl",e.AccessTokenExpiry?e.AccessTokenExpiry.getTime().toString():"0")),e.WacToken&&c.appendChild(Oi("wac_token",e.WacToken)),s.appendChild(c),s.appendChild(a),a.appendChild(r),c.submit();var u={};n.stop();var d=n.getVisibilityChangeEvents();d&&d.length>0&&(u.documentLoadedWithTabSwitch=!0,i.ULS.ft(38147725,U.H,E.Info,"Visibility Change Events:"+JSON.stringify(d))),t.FnOnInitializeSuccess(new Ni(o),u)}function Wi(e){var t=e.appContext,i="";if(Ie()===he.Safari)i+="autoplay;microphone;camera;clipboard-read;clipboard-write;display-capture;";else{var n=t.podsUrl+" "+t.cdnBasePath+";";i+="autoplay "+n,i+="microphone "+n,i+="camera "+n,i+="clipboard-read "+n,i+="clipboard-write "+n,i+="display-capture "+n}return{permissionsPolicy:i,minHeight:t.shouldUsePods?"200px":"150px",minWidth:"300px",useAdditionalDiv:!t.shouldUsePods}}!function(e){e.AppInitError="AppInitError",e.ApiDisabledError="ApiDisabledError",e.CannotLoadFirstPage="CannotLoadFirstPage",e.InvalidWopiInfo="InvalidWopiInfo",e.TimeoutWacReady="TimeoutWacReady",e.WacFailed="WacFailed"}(Fi||(Fi={}));function Di(e,t){return e+"RemoteTelemetry.ashx"+(t?"?usid="+t:"")}function Mi(e,t){return Di(xi(e),t)}function xi(e){var t=e.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}var Bi={errorType:Fi.AppInitError,errorObject:"Timed out waiting for FnOnInitializeSuccess",Category:0,Code:5,ErrorName:"TimeoutInitialize",EventType:13,ExtraInfo:"Initialization timeout"},Hi=function(e,t){var i=this;if(this.Ss=0,this.Is=0,this.bs=0,this.Ts=0,this._s=!1,this.ys=function(e,t){i.Ss=V();var n=6e5,o=I("wdOnSuccessTimeout");o&&parseInt(o,10).toString()===o&&(n=parseInt(o,10),t.ULS.ft(527521921,U.H,E.Warning,"App Timeout is overridden with url override param wdOnSuccessTimeout: ".concat(n))),n&&window.setTimeout((function(){return i.Cs(e,t)}),n)},this.As=function(e,t,n,o){var r={Message:"Received ".concat(e," callback after timeout had elapsed"),timeoutTimeMs:i.Ts,successTimeMs:i.Is,startTimeMs:i.Ss,appInitDiagnostics:n,error:o};t&&t.ULS.ft(38589660,U.H,E.Info,JSON.stringify(r))},this.Cs=function(e,t){if(!(i.bs||i.Is||i.Ts)){i.Ts=V();try{if($e(e.Container)){if(t){var n="Timed out waiting for FnOnInitializeSuccess to be called. startMs:".concat(i.Ss,", timeoutMs:").concat(i.Ts,", scenario:Unified, hostSessionId:").concat(e.SessionInformation.HostSessionId,", host: ").concat(e.SessionInformation.HostName);t.ULS.ft(38589661,U.H,E.Error,n),Li(e,5,"TimeoutInitialize",n,t,i.Ts,!0)}e.FnOnInitializeFailure&&e.FnOnInitializeFailure(Bi)}else t&&(t.ULS.ft(579604899,U.H,E.Warning,"App container is unloaded. Scenario: Unified"),Li(e,7,"AppContainerUnloadedTimeout","App container is unloaded",t,i.Ts,!1))}catch(e){t&&t.ULS.ft(579604898,U.H,E.Error,"timeoutIfSuccessNotCalled exception: "+ie(e))}}},e.FnOnInitializeSuccess){var n=e.FnOnInitializeSuccess;e.FnOnInitializeSuccess=function(o,r){i.Is=V(),i._s||(i._s=!0,i.Ts?i.As("success",t,r):(t&&(t.ULS.ft(38836226,U.H,E.Info,"TimeoutWrapper: Calling fnOnInitializeSuccess"),Li(e,void 0,void 0,void 0,t,V(),!1,r)),n(o,r)))}}if(e.FnOnInitializeFailure){var o=e.FnOnInitializeFailure;e.FnOnInitializeFailure=function(n,r){i.bs=V(),i._s||(i._s=!0,i.Ts&&n!==Bi?i.As("failure",t,r,n):(t&&(Li(e,n.Code,n.ErrorName,n.errorObject,t,V(),!1,r),t.ULS.ft(38836227,U.H,E.Info,"TimeoutWrapper: Calling fnOnInitializeFailure")),o(n,r)))}}this.ys(e,t)};function Li(e,t,i,n,o,r,s,a){var c=null==t&&null==i&&null==n&&!s,u=e.SessionInformation,d=e.WopiPrecheckInfo,l=d.BundleInfo,f=0;null!=u.DocumentClickTime&&u.DocumentClickTime.getTime&&(f=u.DocumentClickTime.getTime());var h={AppMetadata:{BrowserTechnology:"",Browser:"",FileSizeHint:d.FileSize,ApiStartTime:0,HostInitTime:u.HostInitTime,AppVersion:"1."+k(),UseBabylon:"",EntryPoint:mi(e),SessionId:e.SessionId,UserAgent:window.navigator.userAgent,WACRegion:y(e.ApplicationUrl),FileHost:Ti(u.HostName),Host:u.HostName,PodsRing:"",UiHost:bi(u.HostName)},BootInfo:{PreloadCompleteTime:0,DocumentClickTime:f,BootSuccess:c,BootTime:r,BootMode:""},BundleMetadata:"[]",FatalErrors:c?"":{ErrorCategory:"fatal",ExtraInfo:"",CorrelationId:"",ErrorCode:t,ErrorName:i,Message:n},NonFatalErrors:[],WopiPrecheckInfo:{FileGetUrlBool:!!d.FileGetUrl,FileNameBool:!!d.FileName,ReadOnly:d.ReadOnly,SupportsDecryptedContentDownload:d.SupportsDecryptedContentDownload,ViewOnly:d.ViewOnly,PreseededSessionKey:d.PreseededSessionKey,BundleInfo:l?{MajorVersion:l.MajorVersion,URLBool:!!l.Url}:""},AppBootTimings:a?a.appBootTimingDict:""};o.ULS.ft(s?592007955:587843200,U.H,s?E.Error:E.Info,JSON.stringify(h)),M(Mi(e.ApplicationUrl,e.SessionId),"PowerPoint",c?"bootSuccess":"bootFailure")}function Vi(e){var t=6e5,i=e.wdParams.wdonsuccesstimeout;return i&&parseInt(i,10).toString()===i&&(t=parseInt(i,10)),t}function Ji(e){e.appContext.bootComplete=!0,ji(e),e.logger.ULS.ft(34932955,U.H,E.Warning,JSON.stringify(e.diagnostics)),Gi(e)}function ji(e){if(e.appContext.shouldUsePods){var t=e.appInitDiagnostics;t.officeFrameServerDocumentFlushTime=t.documentFlushTime,t.officeFrameServerFirstFlushTime=t.serverFirstFlushTime,t.officeFrameServerStartTime=t.serverStartTime,t.officeServerDocumentProcessStartTime=t.bootStartMs,t.officeServerDocumentProcessEndTime=t.bootEndMs,t.fileRequestsData=[{browserRequest:!1,status:200,isAppCompleteCritical:!0,isDocumentLoadCritical:!0,name:"BootRequest",correlationId:t.downloadCorrelation,startTime:t.downloadStartMs,endTime:t.downloadEndMs,size:t.downloadSize,incremental:t.incDownload}],delete t.documentFlushTime,delete t.serverFirstFlushTime,delete t.serverStartTime,delete t.bootStartMs,delete t.bootEndMs,delete t.downloadCorrelation,delete t.downloadStartMs,delete t.downloadEndMs,delete t.downloadSize,delete t.incDownload}}function Gi(e,t,i,n){var o=e.appContext;if(!o.bootRecorded){o.bootRecorded=!0;var r=void 0!==t||void 0!==i||void 0!==n,s=!!e.timeoutTime,a=!!e.failureTime,c=!(!e.successTime||s||a||r),u=c?e.successTime:a?e.failureTime:e.timeoutTime,d=e.file,l=e.hostInitDiagnostics,f=e.bootParams,h=e.contentBundle,p=e.preseededSession,v=e.appInitDiagnostics,m={AppMetadata:{BrowserTechnology:"",Browser:"",FileSizeHint:d.size,ApiStartTime:0,HostInitTime:l.hostInitializeCallTime,AppVersion:"1."+k(),UseBabylon:"",EntryPoint:l.entryPoint,SessionId:e.sessionId,UserAgent:window.navigator.userAgent,WACRegion:y(e.appBasePath),FileHost:e.host.storageHostName,Host:e.hostName,PodsRing:"",UiHost:e.host.uiHostName},BootInfo:{PreloadCompleteTime:0,DocumentClickTime:l.userClickTime,BootSuccess:c,BootTime:u,BootMode:""},BundleMetadata:"[]",FatalErrors:c?"":{ErrorCategory:"fatal",ExtraInfo:"",CorrelationId:"",ErrorCode:t,ErrorName:i,Message:n},NonFatalErrors:[],WopiPrecheckInfo:{FileGetUrlBool:!!d.getUrl,FileNameBool:!!d.name,ReadOnly:f.readOnly,SupportsDecryptedContentDownload:f.supportsDecryptedContentDownload,ViewOnly:f.viewOnly,PreseededSessionKey:p?p.key:void 0,BundleInfo:h?{MajorVersion:h.majorVersion,URLBool:!!h.url}:""},AppBootTimings:v?v.appBootTimingDict:""};e.logger.ULS.ft(s?592007955:587843200,U.H,s?E.Error:E.Info,JSON.stringify(m))}}function zi(e,t){Gi(e,void 0,t.errorType,ie(t.errorObject))}function qi(e){try{var t=!e.container||!$e(e.container.element),i=t?7:5,n=t?"AppContainerUnloadedTimeout":"TimeoutInitialize",o=t?"App container is unloaded":"Timed out waiting for boot success. startMs:".concat(e.hostInitDiagnostics.hostInitializeCallTime,", timeoutMs:").concat(e.timeoutTime,", scenario:Unified, hostSessionId:").concat(e.hostSessionId,", host: ").concat(e.hostName);if(t)e.failureTime=e.timeoutTime,e.timeoutTime=0;else if(e.appContext.shouldUsePods){var r=function(t,i){Ee(e.appInitDiagnostics,i.Diagnostics),ji(e);var n=Z({message:"Received success message after timeout had elapsed",timeoutTime:e.timeoutTime,currentTime:V()},e.diagnostics);e.logger.ULS.ft(558195677,U.H,E.Info,JSON.stringify(n)),e.removeActionHandler(ae.$t,r)};e.addActionHandler(ae.$t,r)}Gi(e,i,n,o)}catch(t){e.logger.ULS.ft(558893250,U.H,E.Error,"onTimeout exception: "+ie(t))}}function Ki(e,t){Gi(e,void 0,"AppInitError",ie(t))}function Zi(){return!1}function $i(e){e.appContext.shouldUsePods&&Ui(e)}var Xi=function(e,t,i,n,o){return e!==ae.Oi?Promise.reject("Wrong flow"):i.ui.uiEmbed?function(e,t,i,n,o){return e!==ae.Oi?Promise.reject("Wrong flow"):new Promise((function(e){i.pendingReboot=!0;var n=void 0;if(t.queryOverrides)try{n=JSON.parse(t.queryOverrides)}catch(e){i.logger.ULS.ft(592217694,U.H,E.Error,"Failed to parse queryOverrides: ".concat(n))}i.raiseEvent(ue.Reboot,Z(Z({},t),{previousSessionId:i.sessionId,queryOverrides:n})),e({completion:"success"})}))}(e,t,i):new Promise((function(e){var n=window.location.href;g(n,"wdccsoff")&&(n=m(n,"wdccsoff")),n=p(n,"previoussessionid",i.sessionId,!0),t.controllerServicesParam&&(n=p(n,t.controllerServicesParamName,t.controllerServicesParam)),i.logger.ULS.ft(560740507,U.H,E.Info,"Updating window.location.href"),window.location.href=n,e({completion:"success"})}))};function Qi(e,t){if(!e)throw new TypeError("SessionBootParams");var i=e.appUrl,n=e.appBaseUrl;if(!i&&!n)throw new TypeError("Either appUrl or appBaseUrl should exist");if(i&&"string"!=typeof i)throw new TypeError("AppUrl");if(n&&"string"!=typeof n)throw new TypeError("AppBaseUrl");var o=e.file;if(!o||!o.name)throw new TypeError("FileInfo");var r=e.container;if(!r||!(r instanceof Xe)&&!r.appendChild)throw new TypeError("Container");if(!t&&!et(e.wopi))throw new TypeError("WopiInfo")}var Yi;function en(e,t){var i=function(e){if(!e)return"";var t=""+document.cookie,i=new RegExp("(?:^|; )"+e+"=([^;]*)"),n=t.match(i);if(!n||n.length<2)return"";return n[1]}(e);return"true"===i||"false"!==i&&t}function tn(e,t,i,n,o){void 0===n&&(n=Yi.none);var r=e+"="+t,s="",a=new Date;a.setTime(a.getTime()+31536e6);var c=new Date;c.setTime(c.getTime()+864e5*i),c>a&&(c=a),c&&(s=";expires="+c.toUTCString());var u=r+s+(";SameSite="+Yi[n]);return document.cookie=o?u+"; Secure":u,!(!document.cookie||-1===document.cookie.indexOf(r))||n===Yi.none&&tn(e,t,i,Yi.doNotSet,o)}!function(e){e[e.doNotSet=0]="doNotSet",e[e.none=1]="none",e[e.lax=2]="lax",e[e.strict=3]="strict"}(Yi||(Yi={}));var nn=function(){function e(e,t,i,n,o){this.Ps=0,this.Us=[],this.Xo=!1,this.Xo=e,this.Es=t,this.kt=i,this.Os=n,this.Fs=o,this.restart()}return e.prototype.restart=function(){var e=this,t=this.Es.getValue(j.Qe,!1);this.Ps=L()+(this.Fs?this.Fs:this.Es.getValue(j.je,6e5));var i=this.Xo?3e3:5e3;this.Ns=window.setInterval((function(){t&&e.kt.ULS.ft(595724178,U.H,E.Info,"Boot_HeartBeat"),L()>e.Ps&&(e.stop(),on(e.kt),e.Os&&e.Os())}),this.Es.getValue(j.Xe,i)),this.Us.push(window.setTimeout(on,this.Es.getValue(j.Ge,6e4),this.kt,1)),this.Us.push(window.setTimeout(on,this.Es.getValue(j.ze,18e4),this.kt,2))},e.prototype.stop=function(){this.Ps=0,this.Ns&&(window.clearInterval(this.Ns),this.Ns=void 0),this.Us.forEach((function(e){window.clearTimeout(e)})),this.Us=[]},e}();function on(e,t){e.ULS.ft(594901218,U.H,E.Warning,"Boot_NotComplete_".concat(t||"Final")),e.ULS.flush()}var rn=function(e,t,i,n,o){return e!==se.boot?Promise.reject("Wrong flow"):new Promise((function(e){var s,u=V();if(i.state=P.Booting,i.pendingReboot=!1,Qi(t,i.skipWopiValidation),i.intent=t.intent,i.file=t.file,i.customFontCatalogUrl=t.customFontCatalogUrl,i.wopi=t.wopi,i.contentBundle=t.contentBundle,i.newFileTemplate=t.newFileTemplate,i.ownerId=t.ownerId,i.sessionContext=t.sessionContext,i.actNavId=t.actNavId,i.preseededSession=t.preseededSession,i.throttling=t.throttling,i.meeting=t.meeting,i.tenantId=t.tenantId,i.wdParams=tt(t.wdParams),i.pinnedTarget=t.pinnedTarget,i.rebootOverride=t.rebootOverride,i.bootParams=t.bootParams||{},i.hostInitDiagnostics=Z(Z({},t.diagnostics),{hostInitializeCallTime:u}),i.ht.getValue(j.nt,!1)&&Me(i.hostInitDiagnostics),t.appUrl){var l=t.appUrl;i.appUrl=l;var f=i.bootParams;if(g(l,"new")&&(f.isNewFile=!0),!f.dataLanguage)(p=S(l,"rs"))&&(f.dataLanguage=p);var p,v=i.ui;if(g(l,"uiembed")&&(v.uiEmbed=!0),!v.language)(p=S(l,"ui"))&&(v.language=p);if(!i.hostInitDiagnostics.entryPoint){var m=S(l,"wdorigin");m&&(i.hostInitDiagnostics.entryPoint=m)}if(!i.host.uiHostName){var I=S(l,"uih");I&&(i.host.uiHostName=I)}}else i.appUrl="";i.appBaseUrl=t.appBaseUrl?t.appBaseUrl.toLowerCase():c(t.appUrl).toLowerCase(),i.appBaseUrl=a(i.appBaseUrl,h(i.appUrl,"region")),n.initializeAppContext(i,e,t),i.appBasePath=n.buildAppBasePath(i);var b=!1,T=i.preseededSession;i.appInfo.usePreseededSessionId&&T&&T.id&&(i.sessionId=T.id,b=!0);var _,y=!1,C=t.hostGeneratedSessionId;!b&&C&&(i.sessionId=C,y=!0),t.rebootOverride&&(b||y||(s=ve(),i.sessionId=s[0],_=s[1]),i.ht.addSettingsChangeListener(i.logger.settingsChangeHandler),i.pageStateObserver=new xe(i.logger,!0),i.authTokenTrustValidator=new Le(i.logger)),i.logger.ULS.ft(38580693,U.H,E.Info,"User session id: ".concat(i.sessionId,", is preseeded: ").concat(b,", is host generated: ").concat(y)),i.remoteTelemetryUrl=n.buildRemoteTelemetryUrl(i),M(i.remoteTelemetryUrl,i.appInfo.name,"init");var A=i.ht.getValue(j.it,"").toString();if(""===A&&(A=d(i.appBasePath)),i.logger.configure({remoteUlsEndpoint:A,sessionId:i.sessionId}),i.ht.initializePeriodicFetch(i.appBasePath,i.sessionId),_&&i.logger.ULS.ft(590966790,U.H,E.Info,JSON.stringify(_)),Re(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:R(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){i.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),!i.container){var O=t.container;i.container=O instanceof Xe?O:i.application.createContainer(O)}i.container.setMessageHandler(i.onMessage);var F=!!n.ignoreCompletionMessage&&n.ignoreCompletionMessage(i),N=function(e,t){i.successTime=V(),F||(i.container.postMessage(ce.Hn,void 0),Ee(i.appInitDiagnostics,t.Diagnostics)),n.onSuccess&&n.onSuccess(i,t),i.logger.ULS.ft(596448985,U.H,E.Info,JSON.stringify(i.diagnostics)),M(i.remoteTelemetryUrl,i.application.name,"bootSuccess"),i.logger.ULS.flush(),i.container.postMessage(ce.qn,{HostInitializeDiagnostics:i.hostInitDiagnostics,ClientDiagnostics:i.clientDiagnostics}),i.state=P.Booted,W({completion:"success"}),Oe(i.appInfo.name,i.logger)},k=function(e,t){var o,r;i.failureTime=V(),n.onFailure&&n.onFailure(i,t.Error),i.logger.ULS.ft(596448986,U.H,E.Error,JSON.stringify({error:t.Error,diagnostics:i.diagnostics})),M(i.remoteTelemetryUrl,i.application.name,"bootFailure"),i.logger.ULS.flush(),i.state=P.Failed;if(t.Error&&"object"!=typeof t.Error){var s={message:t.Error,errorSource:"App",documentLoadedWithTabSwitch:null===(o=i.appInitDiagnostics)||void 0===o?void 0:o.documentLoadedWithTabSwitch};W({completion:"failure",error:s})}else W({completion:"failure",error:Z(Z({},t.Error),{errorSource:"App",documentLoadedWithTabSwitch:null===(r=i.appInitDiagnostics)||void 0===r?void 0:r.documentLoadedWithTabSwitch})});Oe(i.appInfo.name,i.logger)},W=function(t){F||(i.bootHeartBeat&&i.bootHeartBeat.stop(),i.removeActionHandler(ae.$t,N),i.removeActionHandler(ae.Kt,k)),e(t)};o&&o.subscribe((function(){var e;W({completion:o.reason||"cancelled",error:{documentLoadedWithTabSwitch:null===(e=i.appInitDiagnostics)||void 0===e?void 0:e.documentLoadedWithTabSwitch}})})),F||(i.addActionHandler(ae.$t,N),i.addActionHandler(ae.Kt,k)),function(e){return"wdjs"in e||"wd1js"in e}(i.wdParams)&&("true"!==window.sessionStorage.getItem("sideLoadingIsEnabled")?tn("sideLoadingIsEnabled","false",0):en("sideLoadingIsEnabled",!1)||tn("sideLoadingIsEnabled","true",1));var D=n.buildBootRequestParams(i),x=it(i,D.appPageName,D.queryParamsOverrides),B=nt(i,D.postDataOverrides);if(i.bootstrapperUrl&&i.preconnector&&i.preconnector.shouldPreconnect(i.hostName)&&i.preconnector.preconnect(i.bootstrapperUrl),i.bootstrapperUrl&&i.preloader&&i.preloader.shouldPreload(x,i.host.origin))try{n.beforePreload&&n.beforePreload(i);var H=i.bootstrapperUrl;i.featureManager.isFeatureEnabled(Y.St)&&(i.logger.ULS.ft(590966791,U.H,E.Info,"HTTP2 preload enabled"),H=w(H)),i.preloader.preload(H,i.ui.language,i.logger,i.featureManager)}catch(e){i.logger.ULS.ft(590966792,U.H,E.Error,"Error preloading")}n.beforeContainerBoot&&n.beforeContainerBoot(i,x),i.appInitDiagnostics.officeFrameCreateTime=V(),i.container.boot(x,B,i.logger,n.buildContainerBootParams(i)),F?N(ae.$t,{Diagnostics:{}}):(i.bootHeartBeat=new nn(r(i.appBaseUrl),i.ht,i.logger,(function(){var e;i.timeoutTime=V(),n.onTimeout&&n.onTimeout(i),M(i.remoteTelemetryUrl,i.application.name,"bootTimeout"),W({completion:"timeout",error:{documentLoadedWithTabSwitch:null===(e=i.appInitDiagnostics)||void 0===e?void 0:e.documentLoadedWithTabSwitch}}),o&&o.cancel()}),o&&n.overrideBootTimeout?Math.min(o.timeoutInMs,n.overrideBootTimeout(i)):o?o.timeoutInMs:n.overrideBootTimeout?n.overrideBootTimeout(i):void 0),n.beforeBootCompletionMessage&&n.beforeBootCompletionMessage(i))})).catch((function(e){throw i.failureTime=V(),n.onException&&n.onException(i,e),i.remoteTelemetryUrl&&M(i.remoteTelemetryUrl,i.application.name,"bootException"),i.bootHeartBeat&&i.bootHeartBeat.stop(),Object.keys(Z({},e)).length>=1?Z(Z({},e),{errorSource:"JsApi"}):{error:e.toString(),errorStack:e.stack,errorSource:"JsApi"}}))},sn=function(e,t,i,n,o){var r,s,u,l,f,p;if(e!==se.boot)return Promise.reject("Wrong flow");var v=i.ht.getValue(j.rt,!1),m=i.ht.getValue(j.st,!1),w="editor",I=w=i.ui.uiEmbed||g(t.appUrl||"","uiembed")||-1!==(null===(r=t.intent)||void 0===r?void 0:r.indexOf("embed"))||"interactivepreview"===t.intent?"embed":(null===(s=i.bootParams)||void 0===s?void 0:s.viewOnly)||(null===(u=i.bootParams)||void 0===u?void 0:u.openViewByDefault)&&"default"===(null!==(l=t.intent)&&void 0!==l?l:"default")||"view"===t.intent?"reading":"editor";m||"reading"!==I||(I="embed");var b="editor"===w||"embed"===w&&!v;return b&&(I="editor"),i.logger.ULS.ft(507863259,U.H,E.Info,JSON.stringify({requestedUiType:w,actualUiType:I,modernEmbedEnabled:v,modernReadingEnabled:m,intent:t.intent,uiEmbed:i.ui.uiEmbed,viewOnly:null===(f=i.bootParams)||void 0===f?void 0:f.viewOnly,openViewByDefault:null===(p=i.bootParams)||void 0===p?void 0:p.openViewByDefault})),b?rn(e,t,i,n,o):new Promise((function(e){return $(void 0,void 0,void 0,(function(){var o,r,s,u,l,f,p,v,m,w,b,T,_,y,C,A,O,F,N,k,W,D,x,B,H,L,J,G;return X(this,(function(z){switch(z.label){case 0:o=V(),i.state=P.Booting,i.pendingReboot=!1,Qi(t,!0),i.intent=t.intent,i.file=t.file,i.customFontCatalogUrl=t.customFontCatalogUrl,i.contentBundle=t.contentBundle,i.newFileTemplate=t.newFileTemplate,i.ownerId=t.ownerId,i.sessionContext=t.sessionContext,i.actNavId=t.actNavId,i.preseededSession=t.preseededSession,i.throttling=t.throttling,i.meeting=t.meeting,i.tenantId=t.tenantId,i.wdParams=tt(t.wdParams),i.pinnedTarget=t.pinnedTarget,i.rebootOverride=t.rebootOverride,i.bootParams=t.bootParams||{},i.hostInitDiagnostics=Z(Z({},t.diagnostics),{hostInitializeCallTime:o}),i.ht.getValue(j.ct,!0)&&(i.wdParams.wdForceModernSlideShowInTeams="true"),i.ht.getValue(j.nt,!1)&&Me(i.hostInitDiagnostics),t.appUrl?(r=t.appUrl,i.appUrl=r,s=i.bootParams,g(r,"new")&&(s.isNewFile=!0),s.dataLanguage||(l=S(r,"rs"))&&(s.dataLanguage=l),u=i.ui,g(r,"uiembed")&&(u.uiEmbed=!0),u.language||(l=S(r,"ui"))&&(u.language=l),i.hostInitDiagnostics.entryPoint||(f=S(r,"wdorigin"))&&(i.hostInitDiagnostics.entryPoint=f),i.host.uiHostName||(p=S(r,"uih"))&&(i.host.uiHostName=p)):i.appUrl="",i.appBaseUrl=t.appBaseUrl?t.appBaseUrl.toLowerCase():c(t.appUrl).toLowerCase(),i.appBaseUrl=a(i.appBaseUrl,h(i.appUrl,"region")),i.appBasePath=n.buildAppBasePath(i),i.remoteTelemetryUrl=n.buildRemoteTelemetryUrl(i),M(i.remoteTelemetryUrl,i.appInfo.name,"init"),""===(v=i.ht.getValue(j.it,"").toString())&&(v=d(i.appBasePath)),i.logger.configure({remoteUlsEndpoint:v,sessionId:i.sessionId}),i.ht.initializePeriodicFetch(i.appBasePath,i.sessionId),Re(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:R(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){i.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),m=function(t,n){i.failureTime=V(),i.logger.ULS.ft(596448986,U.H,E.Error,JSON.stringify({diagnostics:i.diagnostics})),M(i.remoteTelemetryUrl,i.application.name,"bootFailure"),i.logger.ULS.flush(),i.state=P.Failed,e({completion:"failure",error:Z(Z({},t),{errorSource:n})}),Oe(i.appInfo.name,i.logger)},z.label=1;case 1:if(z.trys.push([1,3,,4]),!(null===(_=i.bootstrapperUrl)||void 0===_?void 0:_.startsWith("https://wise.sdf.cdn.office.net/")))throw new Error("Unsupported bootstrapperUrl");return w=new URL(i.bootstrapperUrl),"ring0",w.hostname=w.hostname.replace("wise.","res."),w.hostname=w.hostname.replace(".gcc.",".gcch."),w.pathname="/pptlive-m/5mttl/bootstrap/".concat("ring0","/powerpoint.preview.boot.js"),[4,function(e){return $(void 0,void 0,void 0,(function(){return X(this,(function(t){return[2,new Promise((function(t,i){var n=document.createElement("script");n.src=e.href,n.async=!0,n.onload=function(){t()},n.onerror=function(e){i(e)},document.head.appendChild(n)}))]}))}))}(w)];case 2:return z.sent(),[3,4];case 3:return b=z.sent(),m(b,"JsApi"),[2];case 4:return(null===(O=null===(A=null===(C=null===(y=null===window||void 0===window?void 0:window.Microsoft)||void 0===y?void 0:y.Office)||void 0===C?void 0:C.PowerPoint)||void 0===A?void 0:A.Bootstrap)||void 0===O?void 0:O.InitializeWopiPending)?(T={ApplicationUrl:i.appUrl,Container:t.container,SessionInformation:{HostName:i.hostName,HostSessionId:i.hostSessionId,UserId:i.user.id,DocumentClickTime:null===(F=i.hostInitDiagnostics)||void 0===F?void 0:F.userClickTime,EntryPoint:null===(N=i.hostInitDiagnostics)||void 0===N?void 0:N.entryPoint,HostInitTime:(new Date).toISOString(),WdParams:i.wdParams,UiHostRing:null===(k=null==t?void 0:t.diagnostics)||void 0===k?void 0:k.teamsRing},WopiPrecheckInfo:{FileName:i.file.name,FileGetUrl:i.file.getUrl,FileSize:i.file.size,ReadOnly:null===(W=i.bootParams)||void 0===W?void 0:W.readOnly,IrmEnabled:null===(D=i.bootParams)||void 0===D?void 0:D.irmEnabled,DocUniqueId:i.file.uniqueId,CTag:i.file.cTag,ETag:i.file.cTag,ViewOnly:null===(x=i.bootParams)||void 0===x?void 0:x.viewOnly},ApplicationCustomSettings:{ForceAccessibilityMode:!1,EnableWacFallback:!1,UseTransparentBackground:!1,UiType:I},Diagnostics:{entryPoint:null===(B=i.hostInitDiagnostics)||void 0===B?void 0:B.entryPoint,userClickTime:null===(H=i.hostInitDiagnostics)||void 0===H?void 0:H.userClickTime,hostPageFirstFlushTime:null===(L=i.hostInitDiagnostics)||void 0===L?void 0:L.hostPageFirstFlushTime,officeBootstrapperStartTime:null===(J=i.hostInitDiagnostics)||void 0===J?void 0:J.officeBootstrapperStartTime,officeBootstrapperEndTime:null===(G=i.hostInitDiagnostics)||void 0===G?void 0:G.officeBootstrapperEndTime},FnOnInitializeSuccess:function(){i.successTime=V(),i.logger.ULS.ft(596448985,U.H,E.Info,JSON.stringify(i.diagnostics)),M(i.remoteTelemetryUrl,i.application.name,"bootSuccess"),i.logger.ULS.flush(),Oe(i.appInfo.name,i.logger),i.state=P.Booted,e({completion:"success"})},FnOnInitializeFailure:function(e){m(e,"App")}},window.Microsoft.Office.PowerPoint.Bootstrap.InitializeWopiPending(T).Complete(),[2]):(m(new Error("InitializeWopiPending not found"),"JsApi"),[2])}}))}))}))},an=function(e,t,i,n,o){return e!==ae.zi?Promise.reject("Wrong flow"):new Promise((function(e){var n=i.appContext;"FatalError"===t.Reason?function(e,t){var i=e.hostInitDiagnostics,n={ErrorName:t,BootCompleted:e.appContext.bootComplete,SessionInfo:{HostName:e.hostName,HostSessionId:e.hostSessionId,UiLocale:e.ui.language,DataLocale:e.bootParams.dataLanguage,DocumentClickTime:i.userClickTime,HostInitTime:i.hostInitializeCallTime,UiHost:e.host.uiHostName,WdParams:e.wdParams}};e.logger.ULS.ft(587236555,U.H,E.Error,JSON.stringify(n))}(i,t.ErrorName):i.logger.ULS.ft(558421913,U.H,E.Info,"Updating boot complete - reason [".concat(t.Reason,"]")),n.bootComplete||(i.bootHeartBeat&&i.bootHeartBeat.stop(),n.bootFlowResolve({completion:"success"})),i.successTime=V(),Gi(i),e({completion:"success"})}))};var cn,un=function(){var e,t;return[(e={},e[re.appReboot]=Xi,e[re.boot]=sn,e[re.closeTab]=Ye,e[re.createNew]=ot,e[re.dispose]=ct,e[re.frameTrust]=ut,e[re.getAuthToken]=dt,e[re.getHostKeyValue]=Ye,e[re.handleBootState]=lt,e[re.postWacToken]=ft,e[re.rename]=ht,e[re.setOverlayContent]=vt,e[re.storeHostKeyValue]=Ye,e[re.switchMode]=Ye,e[re.updateBootComplete]=an,e),(t={},t[re.boot]={initializeAppContext:oi,buildAppBasePath:ri,buildRemoteTelemetryUrl:si,ignoreCompletionMessage:ai,buildBootRequestParams:Ai,beforeContainerBoot:Pi,buildContainerBootParams:Wi,overrideBootTimeout:Vi,onSuccess:Ji,onFailure:zi,onTimeout:qi,onException:Ki},t[re.createNew]={parallelizeStartSessionRequest:Zi,sendCreateNewWopiInfo:$i},t)]};!function(e){e[e.AppPageLoading=0]="AppPageLoading",e[e.AppReadyForPostMessage=1]="AppReadyForPostMessage",e[e.AppBootComplete=2]="AppBootComplete",e[e.DEPRECATED=3]="DEPRECATED",e[e.RefreshPage=4]="RefreshPage",e[e.UpdateInitializationComplete=6]="UpdateInitializationComplete",e[e.ProfileClientResourceUsage=7]="ProfileClientResourceUsage",e[e.ULSLog=8]="ULSLog"}(cn||(cn={}));var dn=function(){function e(){var t=this;this.Rs={},this.ks=function(e,i){for(var n in t.Rs){var o=t.Rs[n];o&&o.log(e,i)}},this.Ws=function(t){var i;try{i=JSON.parse(t.data)}catch(e){i=null}if(i){var n=i.m_id||i.Token;if(n){var o=e.getInstance(),r=o.get(n);r?r.onMessage(i,t.source):o.ks("Message received with no targetApi. Id: "+n.toString(),t.data)}}},window.addEventListener("message",this.Ws)}return e.getInstance=function(){return this.Ds||(this.Ds=new e),this.Ds},e.prototype.add=function(e,t){this.Rs[e]=t},e.prototype.get=function(e){return this.Rs[e]},e.prototype.remove=function(e){this.Rs[e]=null},e}();function ln(e,t,i,n){return{ShouldUsePODS:e,CanUsePODS:t,Reason:i,CreateNewScenario:n}}function fn(e,t){var i,n,o=e.WopiPrecheckInfo,r=e.ApplicationUrl,s=function(e,t,i,n){var o,r;e.CreateNewInfo?(r=pt.UnifiedCreateNew,o="CreateNewInfo"):e.IsNewFile?(r=pt.UnifiedCreateNew,o="CreateNewInfoIsNewFile"):e.IsNewFileFromHostTemplate?(r=pt.UnifiedCreateNew,o="CreateNewInfoFromHostTemplate"):i&&i.FileGetUrl?(r=pt.UnifiedCreateNew,o="CreateNewInfoFromTemplateSourceUrl"):g(t,"new")?0!==e.FileSize?(r=pt.LegacyCreateNew,o="ApplicationUrlContainsNewAndNonZeroByteFile"):(r=pt.UnifiedCreateNew,o="ApplicationUrlContainsNew"):(r=pt.NotCreateNew,o="NotCreateNew");var s={};return s.CreateNewScenario=pt[r],s.reason=o,n.ULS.ft(34932951,U.H,E.Info,JSON.stringify(s)),r}(o,r,e.NewFileTemplateSource,t),a=I("wdPodsEnabled");return i=o.FileGetUrl,n=a?ln("false"!==a,!0,"wdPodsEnabled is available",s):function(e,t,i){if(Qt(e))return t===pt.LegacyCreateNew?ln(!1,!1,"Legacy Create New Scenario because application url contains new, but non-zero file size",t):-1!==e.indexOf("&Embed=1")?ln(!1,!1,"Embed View fallback to WAC",t):ln(!0,!0,"Supported Region",t);var n="Wac region not currently supported by PODS: "+(y(e)||"");return i.ULS.ft(589168768,U.H,E.Warning,n),ln(!1,!1,n,t)}(r,s,t),i||n.CreateNewScenario!==pt.NotCreateNew?n:ln(!1,!1,n.Reason+"| FileGetUrl is empty",n.CreateNewScenario)}var hn,pn,vn=function(){function e(){var e=this;if(this.Ms=[],this.xs=[],this.Bs=function(){var t={visibility:document.visibilityState,time:V(),initialState:!1};e.Ms.push(t);for(var i=0,n=e.xs;i<n.length;i++){var o=n[i];o&&o(t)}},"hidden"===document.visibilityState){var t={visibility:document.visibilityState,time:V(),initialState:!0};this.Ms.push(t)}document.addEventListener("visibilitychange",this.Bs)}return e.prototype.registerEventHandler=function(e){this.xs.push(e)},e.prototype.removeEventHandler=function(e){if(e){var t=this.xs.indexOf(e);this.xs.splice(t,1)}},e.prototype.stop=function(){document.removeEventListener("visibilitychange",this.Bs)},e.prototype.getVisibilityChangeEvents=function(){return this.Ms},e.prototype.dispose=function(){this.stop(),this.xs=[],this.Ms=[]},e}(),mn=((hn={})[se.blurFocus]=ce.xn,hn[se.continueAccessibilityLoop]=ce.Jn,hn[se.grabFocus]=ce.jn,hn[se.moveToFolder]=ce._i,hn[se.popState]=ce.Zn,hn[se.rename]=ce.oo,hn[se.sendAccessToken]=ce.ro,hn[se.sendAuthToken]=ce.so,hn[se.sendCustomAuthConfig]=ce.ao,hn[se.sendEmbeddedViewUrl]=ce.uo,hn[se.sendSessionInfo]=ce.do,hn[se.sendUserAccessAndPermissions]=ce.lo,hn[se.sendWopiInfo]=ce.fo,hn[se.sendDavUrl]=ce.ho,hn[se.completeSharedFilePicker]=ce.Wi,hn[se.switchMode]=ce.Io,hn[se.signalShared]=ce.yo,hn),wn=function(){function e(e,t){var i,n,o=this;if(this.Hs=!1,this.xs={},this.Zo="",this.$o="",this.Yo=!1,this.Xo=!1,this.Qo=!1,this.er=!1,this.Ls=[],this.Vs=!0,this.Js=function(e,t,i){if(e){var n={MessageId:ce.Wn,CorrelationId:i,SendTime:V()};o.kt.ULS.ft(595732176,U.H,E.Info,"Sending Ack back"),e.postMessage(JSON.stringify(n),t)}else o.kt.ULS.ft(595736136,U.H,E.Info,"Missing target to send Ack back")},this.js=function(e){var t,i=!1,n=!0,r="",s=!1;if(o.Gs&&o.Gs.contentWindow&&(i=!0,n=e.source===o.Gs.contentWindow),e.origin&&(s=(r=u(e.origin,2).toLowerCase())===o.$o),!o.Xo&&(!o.Qo||s&&n)||o.kt.ULS.ft(595730526,U.H,E.Info,"Window is available: ".concat(i,", window is valid: ").concat(n,", origin is valid: ").concat(s,", expected origin: ").concat(o.$o,", actual origin: ").concat(r)),s&&(!o.Yo||n)){var a;try{a=JSON.parse(e.data)}catch(e){return void o.kt.ULS.ft(596464282,U.H,E.Info,"Failed to parse event data: ".concat(ie(e),"."))}var c=a.MessageId;if(c){if(o.kt.ULS.ft(595714715,U.H,E.Info,"Received messageId: ".concat(c,", correlation: ").concat(a.CorrelationId)),c!==ae.$t&&c!==ae.bi||o.zs(e.origin),o.er&&c===ae.Nn)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[a.Values.name]=a.Values.time);a.Values&&a.Values.ackExpected&&o.Js(e.source,e.origin,a.CorrelationId);var d=o.xs[c];if(!d)return o.kt.ULS.ft(596464289,U.H,E.Info,"No handler found for message id: ".concat(c)),void(o.Vs&&c===ae.mi&&(o.Ls.push(a),o.kt.ULS.ft(543207888,U.H,E.Info,"Kept for later process: ".concat(c))));o.kt.ULS.ft(596464288,U.H,E.Info,"Processing message: ".concat(c));try{d(a.Values||{})}catch(e){o.kt.ULS.ft(593773704,U.H,E.Error,"Handler error: ".concat(ie(e)))}0}else(o.Xo||o.Qo)&&o.kt.ULS.ft(595730520,U.H,E.Info,"Could not find message id")}},this.qs=function(){o.Vs=!1,o.Ls.forEach((function(e){var t=e.MessageId,i=o.xs[t];if(i){o.kt.ULS.ft(543207890,U.H,E.Info,"Processing message after boot complete: ".concat(t));try{i(e.Values||{})}catch(e){o.kt.ULS.ft(543207891,U.H,E.Error,"Handler error: ".concat(ie(e)))}}else o.kt.ULS.ft(543207889,U.H,E.Info,"No handler found after boot complete: ".concat(t))})),o.Ls=[]},this.Ks=function(e,t,i){e.postMessage(t,i)},this.zs=function(e){var t=e.toLowerCase();o.Zo&&o.Zo!==t&&o.kt.ULS.ft(596128131,U.H,E.Warning,"Updating origin: [".concat(y(o.Zo),"]->[").concat(y(t),"]")),o.Zo=t,o.$o=u(t,2),o.Xo=r(t),o.Qo=s(t)},!e)throw new Error("Missing origin for PostMessageHandler");this.Xo=r(e),this.Qo=s(e),this.kt=t,this.zs(e),this.er=!!(null===(n=null===(i=window.location)||void 0===i?void 0:i.search)||void 0===n?void 0:n.match(/wdpa=1/gi))}return e.prototype.registerMessagePayloadHandler=function(e,t){if(this.xs[e])throw new Error("Duplicate registration!");this.xs[e]=t},e.prototype.removeMessageHandler=function(e){delete this.xs[e]},e.prototype.sendPostMessage=function(e,t,i){if(e&&e.contentWindow){this.kt.ULS.ft(596464334,U.H,E.Info,"Sending message: "+t);var n={MessageId:t,SendTime:V(),Values:i};this.Ks(e.contentWindow,JSON.stringify(n),this.Zo)}else this.kt.ULS.ft(595948308,U.H,E.Info,"Missing target for SendPostMessage")},e.prototype.activate=function(e,t){this.Gs=e,this.Yo=!!t,this.Hs||(window.addEventListener("message",this.js,!1),this.Hs=!0)},e.prototype.postMessageForCommand=function(e,t,i){var n=mn[t];n?(this.kt.ULS.ft(595702598,U.H,E.Info,"Sending message ".concat(n," for command ").concat(t)),this.sendPostMessage(e,n,i)):this.kt.ULS.ft(595702599,U.H,E.Warning,"No mapping for command ".concat(t))},e.prototype.dispose=function(){this.xs={},this.Hs&&(window.removeEventListener("message",this.js,!1),this.Hs=!1)},e}();!function(e){e.BrowserEvent="BrowserEvent",e.PageChanged="PageChanged",e.ZoomChanged="ZoomChanged",e.ContentRefreshBegin="ContentRefreshBegin",e.ContentRefreshEnd="ContentRefreshEnd",e.AppClosed="UI_Close",e.UserEdit="Edit_Notification",e.FileRename="File_Rename",e.FileShare="UI_Sharing",e.ShowFileVersions="UI_FileVersions",e.UIWorkflow="UI_Workflow",e.IsDisabled="IsDisabled",e.AccessibilityLoopComplete="App_AccessibilityLoopComplete",e.Unloaded="Unloaded",e.Disposed="Disposed",e.SwitchMode="App_SwitchMode",e.DocumentReboot="DocReboot",e.WopiInfoFromUrl="WopiInfoFromUrl",e.DavUrlFromIds="DavUrlFromIds",e.ModeSwitched="ModeSwitched",e.CreateNewDocument="App_CreateNewDocument",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.SetOverlayContent="SetOverlayContent",e.MoveToFolder="MoveToFolder",e.SharedFilePicker="SharedFilePicker"}(pn||(pn={}));var gn=!1,Sn=!1;function In(e,t,i,n,o,r,s){if(t.ULS.ft(595714433,U.H,E.Info,"Starting disposing the application. unloadApp:".concat(e,"; disposed:").concat(gn,"; unloading:").concat(Sn)),gn||Sn&&e)t.ULS.ft(595714908,U.H,E.Info,"Application is already disposed or unloading");else{var a,c={logger:t,postMessenger:i,innerApplicationFrame:n,onDisposed:o,onFrameRemoved:r,unloadTimeoutInMs:s||1e3,forceAppUnload:!1,disposeStartTime:V(),appUnloadTimedOut:!1};if(e&&n)return Sn=!0,c.forceAppUnload=!0,(a=c).forceAppUnloadStartTime=V(),a.logger.ULS.ft(595855490,U.H,E.Info,"Sending postmessage to unload app"),a.logger.ULS.flush(),a.postMessenger.registerMessagePayloadHandler(ae.Ji,(function(e){return function(e,t){e.forceAppUnloadEndTime=V(),e.appUnloadedMessageValues=t,e.logger.ULS.ft(595855491,U.H,E.Info,"AppUnloaded received from app"),bn(e)}(a,e)})),a.postMessenger.sendPostMessage(a.innerApplicationFrame,ce.bo,{}),void window.setTimeout((function(){return function(e){!Sn&&gn||(e.appUnloadTimedOut=!0,e.logger.ULS.ft(595855492,U.H,E.Info,"ApplicationUnload timed out, forcing dispose"),bn(e))}(a)}),a.unloadTimeoutInMs);bn(c)}}function bn(e){if(!gn)try{gn=!0,Sn=!1,function(e){if(!e.innerApplicationFrame)return;e.innerApplicationFrame.src="about:blank",window.setTimeout((function(){e.innerApplicationFrame&&e.innerApplicationFrame.parentElement&&e.innerApplicationFrame.parentElement.removeChild(e.innerApplicationFrame),e.onFrameRemoved&&e.onFrameRemoved()}),0)}(e),function(e){var t={disposeStartTime:e.disposeStartTime,disposeEndTime:V(),forceAppUnload:e.forceAppUnload,appUnloadTimedOut:e.appUnloadTimedOut};e.forceAppUnloadStartTime&&(t.appUnloadStartTime=e.forceAppUnloadStartTime);e.forceAppUnloadEndTime&&(t.appUnloadEndTime=e.forceAppUnloadEndTime);if(e.appUnloadedMessageValues){var i=e.appUnloadedMessageValues,n=Number(i.hostMessageReceived);e.forceAppUnloadStartTime&&!isNaN(n)&&(t.hostToAppPostMessageLatency=n-e.forceAppUnloadStartTime);var o=Number(i.appMessageSent);!isNaN(o)&&e.forceAppUnloadEndTime&&(t.appToHostPostMessageLatency=e.forceAppUnloadEndTime-o);var r=Number(i.appUnloadStart),s=Number(i.appUnloadEnd);if(isNaN(r)||isNaN(s)||(t.appUnloadLatency=s-r),i.serverTimings){var a=i.serverTimings;for(var c in a)t["st-"+c.toString()]=a[c]}}e.logger.ULS.ft(595855436,U.H,E.Info,"App disposed "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(e),e.onDisposed&&e.onDisposed()}catch(t){e.logger.ULS.ft(595714434,U.H,E.Error,"Error disposing: ".concat(ie(t)))}}var Tn=function(){function e(e,t,i,n,o){var r=this;this.xs={},this.Zs=function(){r.$s.registerMessagePayloadHandler(ae.Oi,r.Xs),r.$s.registerMessagePayloadHandler(ae.Si,r.Qs),r.$s.registerMessagePayloadHandler(ae.Ii,r.Ys),r.$s.registerMessagePayloadHandler(ae.mi,r.ea),r.$s.registerMessagePayloadHandler(ae.Bi,r.ta),r.$s.registerMessagePayloadHandler(ae.wi,r.ia),r.$s.registerMessagePayloadHandler(ae._i,r.na),r.$s.registerMessagePayloadHandler(ae.Wi,r.oa)},this.ra=function(e,t){var i=r.xs[e];if(i)try{i(t||{})}catch(e){r.kt.ULS.ft(593773706,U.H,E.Error,"Handler error: ".concat(ie(e)))}},this.Xs=function(e){e.previousSessionId=r.gs,r.ra(pn.DocumentReboot,e)},this.Qs=function(e){r.ra(pn.WopiInfoFromUrl,e)},this.Ys=function(e){r.ra(pn.DavUrlFromIds,e)},this.ea=function(e){Promise?r.sa.isResourceTrustedForMessage(e).then((function(t){t?r.ra(pn.GetAuthToken,e):r.$s.sendPostMessage(r.Gs,ce.so,{AuthToken:"",Error:"accessDenied",RequestId:e.RequestId,IdentityType:e.IdentityType})}),(function(){r.$s.sendPostMessage(r.Gs,ce.so,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:e.RequestId,IdentityType:e.IdentityType})})):r.$s.sendPostMessage(r.Gs,ce.so,{AuthToken:"",Error:'"Promise" does not exist natively in browser',RequestId:e.RequestId,IdentityType:e.IdentityType})},this.ta=function(e){r.ra(pn.FileShare,e)},this.ia=function(e){r.ra(pn.GetCustomAuthConfig,e)},this.na=function(e){r.ra(pn.MoveToFolder,e)},this.oa=function(e){r.ra(pn.SharedFilePicker,e)},this.gs=e,this.kt=t,this.Gs=o.innerApplicationFrame,this.$s=i,this.aa=n,this.sa=new Le(t),this.Zs(),gn=!1}return e.prototype.GetApplicationType=function(){return"PowerPoint"},e.prototype.GetVersion=function(){return R()},e.prototype.GetSessionId=function(){return this.gs},e.prototype.RegisterEventHandler=function(e,t){switch(e){case pn.Unloaded:case pn.Disposed:case pn.DocumentReboot:case pn.WopiInfoFromUrl:case pn.DavUrlFromIds:case pn.GetAuthToken:case pn.GetCustomAuthConfig:case pn.MoveToFolder:case pn.SharedFilePicker:case pn.SetOverlayContent:case pn.FileShare:if(this.xs[e])throw new Error("Duplicate registration");this.xs[e]=t;break;default:this.$s.registerMessagePayloadHandler(e,t)}},e.prototype.RemoveEventHandler=function(e,t){switch(e){case pn.Unloaded:case pn.Disposed:case pn.DocumentReboot:case pn.FileShare:case pn.WopiInfoFromUrl:case pn.DavUrlFromIds:case pn.GetAuthToken:case pn.GetCustomAuthConfig:case pn.MoveToFolder:case pn.SharedFilePicker:case pn.SetOverlayContent:if(this.xs[e]!==t)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.xs[e];break;default:this.$s.removeMessageHandler(e)}},e.prototype.RegisterErrorHandler=function(e){},e.prototype.RemoveErrorHandler=function(e){},e.prototype.PostCommand=function(e,t){this.$s.postMessageForCommand(this.Gs,e,t)},e.prototype.Dispose=function(e,t){var i=this;In(e||!1,this.kt,this.$s,this.Gs,(function(){delete i.Gs,i.aa(),i.$s.dispose(),i.ra(pn.Unloaded,{})}),(function(){try{i.ra(pn.Disposed,{}),i.xs={}}catch(e){i.kt.ULS.ft(589108815,U.H,E.Error,"onFrameRemoved error: ".concat(ie(e)))}}),t)},e}();var _n,yn=function(e){function t(t,i,n,o,r){var s=e.call(this,t,i,n,o,r)||this;return s.ca={},s.ua=!1,s.da=!1,s.la=function(){s.da||(s.da=!0,s.ua=!1,s.aa&&s.aa(),s.ra(pn.Unloaded,{}),s.ra(pn.Disposed,{}),s.ca.disposeEndTime=V(),s.kt.ULS.ft(41710159,U.H,E.Info,JSON.stringify(s.ca)),s.xs={})},s.fa=function(e){s.ca.appUnloadEndTime=V(),e&&(s.ca.wacDisposeTelemetry=e),s.la()},s.ha=function(){!s.ua&&s.da||(s.kt.ULS.ft(41710160,U.H,E.Warning,"Unload timed out"),s.ca.appUnloadTimedOut=!0),s.la()},s.$s.registerMessagePayloadHandler(ae.Ji,s.fa),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}K(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}(t,e),t.prototype.Dispose=function(e,t){if(!(this.da||this.ua&&e))if(this.ca.disposeStartTime=V(),e){this.ua=!0,this.ca.appUnloadStartTime=V(),this.ca.forceAppUnload=e,this.$s.sendPostMessage(this.Gs,ce.bo,{});var i=t||1e3;window.setTimeout(this.ha,i)}else this.la()},t}(Tn),Cn=function(){function e(){this.hasAppBooted=!1}return e.prototype.getIfAllFieldsSet=function(){if(this.wopiInfo&&this.hasAppBooted&&this.iframe&&this.podsUrl)return{wopiInfo:this.wopiInfo,iframe:this.iframe,podsUrl:this.podsUrl,readonly:this.readonly,hasAppBooted:this.hasAppBooted,irmEnabled:this.irmEnabled,supportsDecryptedContentDownload:this.supportsDecryptedContentDownload,fileName:this.fileName}},e}(),An=function(){function e(e,t,i,n,o){var r,s=this;this.pa=new Cn,this.va=!1,this.ma=new vn,this.wa=function(){var e=dn.getInstance();e&&s.ga&&e.remove(s.ga.PptInitParams.PostMessageToken),s.ns&&s.ns.dispose(),s.Sa&&s.Sa.parentElement&&s.Sa.parentElement.removeChild(s.Sa),s.Sa&&delete s.Sa,s.Ia(),s.kt.ULS.ft(587552790,U.H,E.Warning,"PPTUnifiedSessionLoader::dispose:: App dispose"),s.ma.stop()},this.ba=function(){var e,t,i,n,o=s.pa&&s.pa.getIfAllFieldsSet();if(!s.Ta&&o&&o.iframe.contentWindow){var r={};r.WopiSrc=o.wopiInfo.WopiSrc,r.AccessToken=o.wopiInfo.AccessToken,r.AccessTokenTTL=o.wopiInfo.AccessTokenExpiry?o.wopiInfo.AccessTokenExpiry.getTime():0,r.ReadOnly=o.readonly,r.IrmEnabled=o.irmEnabled,r.SupportsDecryptedContentDownload=o.supportsDecryptedContentDownload,r.FileName=o.fileName,r.SessionContext=s._a,r.WdParams=s.ya,r.DocumentURL=window.location.href,o.wopiInfo.WacToken&&(r.WacToken=o.wopiInfo.WacToken);var a=I("PreviousSessionID");a&&(r.PreviousSessionID=a),(null===(i=null===(t=null===(e=s.ga)||void 0===e?void 0:e.PptInitParams)||void 0===t?void 0:t.SessionInformation)||void 0===i?void 0:i.HostSessionId)&&(r.HostSessionId=null===(n=s.ga)||void 0===n?void 0:n.PptInitParams.SessionInformation.HostSessionId),s.Ca(r),o.iframe.contentWindow.postMessage(JSON.stringify(r),o.podsUrl),s.Ta=!0}},this.Ca=function(e){var t,i,n,o,r,a,c=null!==(t=window.WOPIPerf_FirstPageFlush)&&void 0!==t?t:null===(n=null===(i=s.ga)||void 0===i?void 0:i.AppInitDiagnostics)||void 0===n?void 0:n.hostPageFirstFlushTime;c&&(e.FirstPageFlushTime=c);var u=window.WOPIPerf_BootJsStartTime;u&&(e.BootJsStartTime=u);var d=window.WOPIPerf_BootJsEndTime;d&&(e.BootJsEndTime=d);var l=window.WOPIPerf_InitializeWac;l&&(e.InitializeWacTime=l);var f=window.WOPIPerf_UserClick,h=s.ga&&s.ga.AppInitDiagnostics&&s.ga.AppInitDiagnostics.userClickTime;if(f?e.UserClickTime=f:h&&(e.UserClickTime=h),window.performance){var p=window.performance.timing;p&&(e.NavigationStart=p.navigationStart,e.FetchStart=p.fetchStart,e.RequestStart=p.requestStart,e.ResponseStart=p.responseStart,e.ResponseEnd=p.responseEnd);var v=window.performance.navigation;v&&(e.NavigationType=v.type,e.NavigationRedirects=v.redirectCount)}e.UnifiedUiHostDiagnostics=null===(r=null===(o=s.ga)||void 0===o?void 0:o.AppInitDiagnostics)||void 0===r?void 0:r.unifiedUiHostDiagnostics,e.ClientDiagnostics=null===(a=s.ga)||void 0===a?void 0:a.PptInitParams.ClientDiagnostics,s.Aa(e)},this.Aa=function(e){var t;if(window.performance&&window.performance.getEntriesByType){var i=null===(t=window.performance.getEntriesByType("navigation")[0])||void 0===t?void 0:t.toJSON();i&&i.name&&(delete i.name,e.HostPerfNavigationTelemetry=i)}},this.Pa=function(e,t,i){s.pa&&(s.pa.wopiInfo=e),t===pt.UnifiedCreateNew&&function(e){if(e&&e.NewFilePath)window.history.replaceState(null,"",e.NewFilePath),e.UpdatedPageTitle&&(window.document.title=e.UpdatedPageTitle);else if(window.location.href.indexOf("action=editnew")>=0){var t=window.location.href.replace("action=editnew","action=edit");window.history.replaceState(null,window.document.title||"",t)}}(i),window.setTimeout(s.ba,1)},this.Ia=function(){window.removeEventListener("beforeunload",s.Wo,{capture:!0}),window.removeEventListener("pagehide",s.Do,{capture:!0}),window.removeEventListener("visibilitychange",s.Mo,{capture:!0})},this.Ua=function(){var e=Ze(s.kt);s.ns?s.ns.sendPostMessage(s.Sa,ce.pi,{isTopFrameTrusted:e}):s.kt.ULS.ft(51237655,U.H,E.Error,"Trust frame request received but the wac frame is null")};var u,d=void 0;Promise&&(this.Ea=new Promise((function(e){return s.Oa=e})));try{var l=void 0,f=!1;e.WopiPrecheckInfo&&e.WopiPrecheckInfo.PreseededWacSessionId?(u=e.WopiPrecheckInfo.PreseededWacSessionId,f=!0):i?u=i:(u=(r=ve())[0],l=r[1]),M(Mi(e.ApplicationUrl,u),"PowerPoint","init"),function(e){if(void 0===e)throw new TypeError("initParams");var t=e.Container;if(void 0===t||void 0===t.appendChild)throw new TypeError("Container");var i=e.SessionInformation;if(void 0===i||void 0===i.HostName||void 0===i.HostSessionId||void 0===i.UserId)throw new TypeError("SessionInformation");var n=e.ApplicationUrl;if(void 0===n||"string"!=typeof n)throw new TypeError("ApplicationUrl");var o=e.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===e.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===e.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(e),function(e){!e.WopiPrecheckInfo.PreseededSessionKey||"_._._."===e.WopiPrecheckInfo.PreseededSessionKey.slice(0,6)&&"-.-.-."===e.WopiPrecheckInfo.PreseededSessionKey.slice(-6)||(e.WopiPrecheckInfo.PreseededSessionKey="_._._."+e.WopiPrecheckInfo.PreseededSessionKey+"-.-.-.")}(e),e.ApplicationUrl=a(e.ApplicationUrl,h(e.ApplicationUrl,"region")),e.ApplicationUrl=m(e.ApplicationUrl,"region");var p=function(e){if(e){var t=Qt(e);return t?t.PodsUrl:e.substring(0,e.toLowerCase().indexOf("powerpointframe.aspx")).replace("/p/","/pods/")}return""}(e.ApplicationUrl);d=t||q({remoteUlsEndpoint:p+"RemoteUls.ashx",sessionId:u}),this.kt=d;var v=Si(e.SessionInformation.HostSessionId),w=Z(Z({},e),{SessionId:u,PostMessageToken:v,OnDemandServer:p,FeatureManager:n||ne(e.FnIsFeatureEnabled,d),SettingsManager:o||new fe("PowerPoint",d),UsePodsDetails:fn(e,d),ClientDiagnostics:Ne()});o||(w.SettingsManager.addSettingsChangeListener(d.settingsChangeHandler),w.SettingsManager.initializePeriodicFetch(p,u)),new Hi(w,d),d.ULS.ft(38580693,U.H,E.Warning,"PPTBootstrapper - initializing session. Build version: ".concat(R(),"; UserSessionId: ").concat(u,"; IsSessionIdPreseeded: ").concat(f,"; IsSessionIdToUseProvided: ").concat(!!i)),d.ULS.ft(38580694,U.H,E.Info,"Bootstrapper Init Time: ".concat((new Date).getTime())),l&&d.ULS.ft(572618978,U.H,E.Info,JSON.stringify(l)),window.addEventListener("unload",(function(){d.ULS.ft(41157219,U.H,E.Warning,"Unloading bootstrapper window."),d.ULS.flushOnClose()})),this.Wo=function(){return _i(d,"OnBeforeUnload",!0)},this.Do=function(){return _i(d,"OnPageHide",!0)},this.Mo=function(){return _i(d,"VisibilityChange_"+document.visibilityState,!0)},window.addEventListener("beforeunload",this.Wo,{capture:!0,once:!0}),window.addEventListener("pagehide",this.Do,{capture:!0}),window.addEventListener("visibilitychange",this.Mo,{capture:!0}),d.ULS.ft(38580695,U.H,E.Info,"Application.InitializeWopiPending"),function(e,t){var i={BootstrapperType:"TypeScript",JsApiVersion:"v1",Preview:!1,Scenario:"Unified App",ApplicationUrl:y(e.ApplicationUrl)||null,IsDeepLink:!!I("nav"),BootstrapperInstanceId:me(),IsMobileView:Ae()};i.ApplicationCustomSettings={OnDemandServer:y(e.OnDemandServer)||null,EnableWacFallback:!0};var n=e.SessionInformation,o=e.Diagnostics,r=o&&o.userClickTime?o.userClickTime:n.DocumentClickTime?n.DocumentClickTime.getTime():null;i.SessionInformation={HostName:n.HostName,HostSessionId:n.HostSessionId,UiLocale:n.UiLocale,DataLocale:n.DataLocale,DocumentClickTime:r,HostInitTime:n.HostInitTime,CurrentTime:V(),UiHost:bi(n.HostName),WdParams:n.WdParams},i.Diagnostics={EntryPoint:mi(e),FileHost:Ti(e.SessionInformation.HostName),PodsRing:"",UnifiedUiHostDiagnostics:o?o.unifiedUiHostDiagnostics:null};var s=e.WopiPrecheckInfo,a=!!s.FileGetUrl,c=!!s.CustomFontCatalogUrl;i.WopiPrecheckInfo={FileSize:s.FileSize,FileGetUrlBool:a,CustomFontCatalogBool:c,FileGetUrlLength:a?s.FileGetUrl.length:null,FileNameBool:!!s.FileName,ReadOnly:s.ReadOnly,IrmEnabled:s.IrmEnabled,SupportsDecryptedContentDownload:s.SupportsDecryptedContentDownload,ViewOnly:s.ViewOnly,PreseededSessionKey:!!s.PreseededSessionKey,FileExtension:ee(s.FileName)||null,BundleInfo:s.BundleInfo?{MajorVersion:s.BundleInfo.MajorVersion,URLBool:!!s.BundleInfo.Url}:{}},i.AppInfo={AppVersionMajor:1,AppVersionMinor:k(),Environment:"wac",UserAgent:window.navigator.userAgent},i.AdditionalTelemetry={PostMessageToken:e.PostMessageToken},t.ULS.ft(22357763,U.H,E.Info,JSON.stringify(i,te))}(w,d);var g=w.UsePodsDetails;!function(e,t,i){var n={ShouldUsePodsOrCached:e.ShouldUsePODS,ShouldUsePods:e.ShouldUsePODS,CanUsePods:e.CanUsePODS,ApplicationUrl:y(t)||null,Reason:e.Reason,CreateNewScenario:pt[e.CreateNewScenario]};i.ULS.ft(38580687,U.H,E.Info,JSON.stringify(n))}(g,w.ApplicationUrl,d);var S=g.ShouldUsePODS;if(S){w.Diagnostics&&w.Diagnostics.userClickTime&&De(w.Diagnostics.userClickTime,d),w.IsFileNew=g.CreateNewScenario!==pt.NotCreateNew,w.WopiPrecheckInfo.ReadOnly=w.WopiPrecheckInfo.ReadOnly||!1;var b=Ri(w,d);if(!b){var T={Message:"Error creating IFrame",HostSessionId:w.SessionInformation.HostSessionId};throw d.ULS.ft(38580696,U.H,E.Error,JSON.stringify(T)),Error("Error Creating IFrame")}d.ULS.ft(50376725,U.H,E.Warning,"Assigning wopiBootParams"),this.Sa=b.IFrameElement,this.Oa&&this.Oa(this.Sa),this.pa&&(this.pa.iframe=b.IFrameElement,this.pa.podsUrl=ni(w.OnDemandServer),this.pa.readonly=w.WopiPrecheckInfo.ReadOnly,this.pa.irmEnabled=w.WopiPrecheckInfo.IrmEnabled,this.pa.supportsDecryptedContentDownload=w.WopiPrecheckInfo.SupportsDecryptedContentDownload,this.pa.fileName=w.WopiPrecheckInfo.FileName),this.ns=new wn(c(w.ApplicationUrl),d),this.ns.activate(b.IFrameElement),w.SessionInformation.SupportsFrameTrustCheck||this.ns.registerMessagePayloadHandler(ae.pi,this.Ua),this._a=w.SessionInformation.SessionContext?w.SessionInformation.SessionContext:"",this.ya="",w.SessionInformation.WdParams&&(this.ya=Ci(w.SessionInformation.WdParams)),this.ya&&d.ULS.ft(539837381,U.H,E.Warning,"Non-empty WdParams Assigned");var _=Z(Z({},w.Diagnostics),{hostName:w.SessionInformation.HostName});_.officeFrameCreateTime=b.FrameCreateTime,_.cacheHit=!1,this.ga={AppInitDiagnostics:_,PptInitParams:w};var C=dn.getInstance();C&&C.add(v,this)}d.ULS.ft(50376727,U.H,E.Warning,"Creating WopiPendingApplication"),this.Fa={Complete:function(e,t){S?s.Pa(e,g.CreateNewScenario,t):ki(e,w,d,s.ma,v)},Fail:function(e){s.kt.ULS.ft(38293905,U.H,E.Info,"Host failed to give us WopiInfo")},Dispose:function(e,t){s.wa(),t&&t()},PostWacToken:function(e,t){s.ns?function(e,t,i,n,o){var r=V();n.ULS.ft(507774684,U.H,E.Important,"postWacToken flow initiated"),o?o.then((function(o){var s=window.setInterval((function(){return i.sendPostMessage(o,ce.Fo,{wacToken:e,postWacTokenStart:t})}),100);i.registerMessagePayloadHandler(ae.kn,(function(){n.ULS.ft(507597019,U.H,E.Info,"postWacToken flow completed in ".concat(V()-r," ms")),window.clearInterval(s)})),window.setTimeout((function(){n.ULS.ft(507597018,U.H,E.Warning,"postWacToken flow timed out after ".concat(15e3," ms")),window.clearInterval(s)}),15e3)})).catch((function(e){return n.ULS.ft(507873094,U.H,E.Warning,"This should never reject, error: ".concat(ie(e)))})):n.ULS.ft(507846862,U.H,E.Warning,"`Promise` does not exist natively for this browser.")}(e,t,s.ns,s.kt,s.Ea):s.kt.ULS.ft(507846861,U.H,E.Info,"PPTUnifiedBootstrapper::PostWacToken, this._postMessageHandler is undefined")}},gi(w.BootstrapperUrl,d),window.setTimeout((function(){d&&d.ULS.flush()}),1e4)}catch(t){d&&(d.ULS.ft(38580697,U.H,E.Error,Fi.AppInitError+": "+ie(t)),d.ULS.flushOnClose()),e&&(e.ApplicationUrl&&M(Mi(e.ApplicationUrl,u),"PowerPoint","bootException"),e.FnOnInitializeFailure&&e.FnOnInitializeFailure({errorType:Fi.AppInitError,errorObject:t}))}}return e.prototype.log=function(e){this.kt.ULS.ft(39978262,U.H,E.Info,e)},e.prototype.onMessage=function(e,t){try{if(!e||!this.ga)return void this.kt.ULS.ft(39978263,U.H,E.Error,"Missing message data: "+!e+" or appData: "+!this.ga);switch(this.Sa&&this.Sa.contentWindow===t||this.kt.ULS.ft(39978264,U.H,E.Error,"Message with the right postMessageToken came from an unexpected iframe"),!e.Data.officeSessionId&&this.ga.AppInitDiagnostics.officeSessionId&&(e.Data.officeSessionId=this.ga.AppInitDiagnostics.officeSessionId),e.Data.messageType||(e.Data.messageType=e.Type),this.kt.ULS.ft(38580691,U.H,E.Warning,JSON.stringify(e.Data)),e.Type){case cn.AppPageLoading:break;case cn.AppReadyForPostMessage:this.pa&&(this.pa.hasAppBooted=!0),e.Data.officeSessionId&&(this.ga.AppInitDiagnostics.officeSessionId=e.Data.officeSessionId),window.setTimeout(this.ba,1);break;case cn.AppBootComplete:if(this.va=!0,this.ga.PptInitParams.FnOnInitializeSuccess){this.ga.AppInitDiagnostics.officeBootstrapperVersion=R(),e.Data.officeAppEndpoint&&(this.ga.AppInitDiagnostics.officeAppEndpoint=e.Data.officeAppEndpoint),e.Data.officeServerVersion&&(this.ga.AppInitDiagnostics.officeServerVersion=e.Data.officeServerVersion),e.Data.documentLoadedTime&&(this.ga.AppInitDiagnostics.documentLoadedTime=e.Data.documentLoadedTime,this.ga.AppInitDiagnostics.appCompletedTime=e.Data.documentLoadedTime),e.Data.officeFrameFirstFlushTime&&(this.ga.AppInitDiagnostics.officeFrameFirstFlushTime=e.Data.officeFrameFirstFlushTime),e.Data.officeFrameDocumentFlushTime&&(this.ga.AppInitDiagnostics.officeFrameDocumentFlushTime=e.Data.officeFrameDocumentFlushTime),e.Data.documentFlushTime&&(this.ga.AppInitDiagnostics.officeFrameServerDocumentFlushTime=e.Data.documentFlushTime),e.Data.serverFirstFlushTime&&(this.ga.AppInitDiagnostics.officeFrameServerFirstFlushTime=e.Data.serverFirstFlushTime),e.Data.serverStartTime&&(this.ga.AppInitDiagnostics.officeFrameServerStartTime=e.Data.serverStartTime),e.Data.bootStartMs&&(this.ga.AppInitDiagnostics.officeServerDocumentProcessStartTime=e.Data.bootStartMs),e.Data.bootEndMs&&(this.ga.AppInitDiagnostics.officeServerDocumentProcessEndTime=e.Data.bootEndMs),e.Data.cacheHit&&(this.ga.AppInitDiagnostics.cacheHit=e.Data.cacheHit);var i={browserRequest:!1,status:200,isAppCompleteCritical:!0,isDocumentLoadCritical:!0,name:"BootRequest"};e.Data.downloadCorrelation&&(i.correlationId=e.Data.downloadCorrelation),e.Data.downloadStartMs&&(i.startTime=e.Data.downloadStartMs),e.Data.downloadEndMs&&(i.endTime=e.Data.downloadEndMs),e.Data.downloadSize&&(i.size=e.Data.downloadSize),e.Data.incDownload&&(i.incremental=e.Data.incDownload),this.ga.AppInitDiagnostics.fileRequestsData=[i],this.ma.stop();var n=this.ma.getVisibilityChangeEvents();if(n&&n.length>0&&(this.ga.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,this.kt.ULS.ft(38580692,U.H,E.Info,"Visibility Change Events:"+JSON.stringify(n))),this.kt.ULS.ft(34932955,U.H,E.Warning,JSON.stringify(this.ga.AppInitDiagnostics)),!this.ns)throw this.kt.ULS.ft(51448022,U.H,E.Warning,"PPTUnifiedSessionLoader::onMessage::AppBootComplete null m_postMessageHandler"),Error("m_postMessageHandler");this.Na=new yn(this.ga.PptInitParams.PostMessageToken,this.kt,this.ns,this.wa,{innerApplicationFrame:this.Sa}),this.ga.PptInitParams.FnOnInitializeSuccess(this.Na,this.ga.AppInitDiagnostics),this.ns.qs()}break;case cn.RefreshPage:if(this.ga.PptInitParams.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&this.ga.PptInitParams.SessionInformation.SupportsDocReboot)break;var o=window.location.href;-1!==o.indexOf("&wdccsoff=1")&&(o=m(o,"wdccsoff")),e.Data.officeSessionId&&(o=ei(o,"PreviousSessionID",e.Data.officeSessionId)),e.Data.ControllerServicesParam&&(o=ei(o,e.Data.ControllerServicesParamName,e.Data.ControllerServicesParam)),this.kt.ULS.ft(594068673,U.H,E.Info,"PPTUnifiedSessionLoader::onMessage::RefreshPage Updating window.location.href"),window.location.href=o;break;case cn.UpdateInitializationComplete:try{if("FatalError"===e.Data.Reason){var r={ErrorName:e.Data.ErrorName,BootCompleted:this.va,SessionInfo:(a=this.ga.PptInitParams,u=a.SessionInformation,d=a.Diagnostics,{HostName:u.HostName,HostSessionId:u.HostSessionId,UiLocale:u.UiLocale,DataLocale:u.DataLocale,DocumentClickTime:d&&d.userClickTime?d.userClickTime:u.DocumentClickTime?u.DocumentClickTime.getTime():void 0,HostInitTime:u.HostInitTime,UiHost:bi(u.HostName),WdParams:u.WdParams})};this.kt.ULS.ft(587236555,U.H,E.Error,JSON.stringify(r))}else this.kt.ULS.ft(576583120,U.H,E.Info,"PPTUnifiedSessionLoader::onMessage::UpdateInitializationComplete - Reason: ".concat(e.Data.Reason))}catch(e){this.kt.ULS.ft(576582732,U.H,E.Error,"PPTUnifiedSessionLoader::onMessage::UpdateInitializationComplete Caught exception: "+e)}this.ns||(this.kt.ULS.ft(51448024,U.H,E.Info,"PPTUnifiedSessionLoader::onMessage::AppBootComplete null m_postMessageHandler"),this.ns=new wn(c(this.ga.PptInitParams.ApplicationUrl),this.kt),this.ns.activate(this.Sa)),this.Na=new yn(this.ga.PptInitParams.PostMessageToken,this.kt,this.ns,this.wa,{innerApplicationFrame:this.Sa}),this.ga.PptInitParams.FnOnInitializeSuccess(this.Na,this.ga.AppInitDiagnostics),this.ns.qs();break;case cn.ProfileClientResourceUsage:this.kt.ULS.ft(541388952,U.H,E.Info,JSON.stringify(e.Data));break;case cn.ULSLog:var s=e.Data;if(!s||"number"!=typeof s.Tag||"number"!=typeof s.Category||"number"!=typeof s.Level||"string"!=typeof s.Message)break;try{this.kt.ULS.ft(s.Tag,s.Category,s.Level,s.Message)}catch(e){this.kt.ULS.ft(512235073,U.H,E.Error,"PPTUnifiedSessionLoader::onMessage ULSLog exception: "+e)}}}catch(e){this.kt.ULS.ft(594121922,U.H,E.Error,"PPTUnifiedSessionLoader::onMessage Caught exception: "+e)}var a,u,d},e.prototype.getWopiPendingApplication=function(){return this.Fa},e}(),Pn=function(){function e(){}return e.prototype.GetVersion=function(){return R()},e.prototype.GetMinContentVersion=function(){return 1},e.prototype.Prefetch=function(){},e.prototype.InitializeWopiPending=function(e,t,i,n,o,r){return new An(e,t,i,o,r).getWopiPendingApplication()},e}();!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(_n||(_n={}));var Un=new Pn,En=function(e){var t={name:"PowerPoint",usePreseededSessionId:!0,preconnector:A()};return new Qe(e,t,un)}}});

"use strict";function getLogger(n,t){var i=new bUlsCache(n,t);return{ULS:{trace:function(n,t,r){return traceTagImpl(i,0,n,t,r)},traceTag:function(n,t,r,u){return traceTagImpl(i,n,t,r,u)},flush:i.flush,flushOnClose:i.flushOnClose}}}function getExperimentLogger(n,t,i,r){var u=new bUlsCache(n,t);return u.configure(i,r),{ULS:{trace:function(n,t,i){return traceTagImpl(u,0,n,t,i)},traceTag:function(n,t,i,r){return traceTagImpl(u,n,t,i,r)},flush:u.flush,flushOnClose:u.flushOnClose}}}function traceTagImpl(n,t,i,r,u){if(!(r>currentLevel)){var f={timestamp:Date.now(),category:i,tag:t,level:r,type:logType.Trace,message:u};n.handleTrace(f)}}function formatForUpload(n,t,i,r){var u=n.map(function(n){return getLogEntryInWireFormat(n,r)}),f=getLogBatchInWireFormat(r,u,t,i);return JSON.stringify(f)}function getLogEntryInWireFormat(n,t){var i={},r;return i.G=n.tag,i.T=n.timestamp-t,i.M=n.message,i.C=n.category,r=n.type*shiftFactory+n.level,i.D=r,i}function getLogBatchInWireFormat(n,t,i,r){var u={};return u.T=n,u.L=t,u.S=i,u.I=r,u.V=1,u}function uploadLogs(n,t,i){if(t!==""){var r=new XMLHttpRequest;(r.readyState===XMLHttpRequest.UNSENT||r.readyState===XMLHttpRequest.DONE)&&(r.open("POST",t,i),r.send(n))}}var logLevel,ULS,currentLevel,bUlsCache,shiftFactory,logCategory,logType,PowerPointOnline;(function(n){n[n.Spam=200]="Spam";n[n.Verbose=100]="Verbose";n[n.Info=50]="Info";n[n.Warning=15]="Warning";n[n.Error=10]="Error"})(logLevel||(logLevel={}));ULS={getLogger:getLogger,getExperimentLogger:getExperimentLogger};currentLevel=logLevel.Info;bUlsCache=function(){function n(n,t){var i=this;this.uploadCadenceInMsSec=3e4;this.uploadTriggerSize=30;this.uploadId=0;this.logCache=[];this.timestampBase=Date.now();this.userSessionId="00000000-0000-0000-0000-000000000000";this.flushOnClose=function(){i.triggerUpload(!1,!1)};this.flush=function(){i.triggerUploadAsync()};this.triggerUploadAsync=function(){window.setTimeout(function(){return i.triggerUpload(!0,!0)},0)};this.triggerUpload=function(n,t){if(window.clearTimeout(i.timeoutId),i.logCache.length>0){i.uploadId+=1;var r=formatForUpload(i.logCache,i.userSessionId,i.uploadId,i.timestampBase);uploadLogs(r,i.remoteUrlEndpoint,t);i.logCache=[];i.timestampBase=Date.now()}n&&(i.timeoutId=window.setTimeout(i.triggerUploadAsync,i.uploadCadenceInMsSec))};this.userSessionId=n;this.remoteUrlEndpoint=t+"?usid="+n;window.setTimeout(function(){return i.triggerUpload(!0,!0)},0)}return n.prototype.configure=function(n,t){this.uploadCadenceInMsSec=n;this.uploadTriggerSize=t},n.prototype.handleTrace=function(t){t.message.length>n.messageMaxChars&&(t.message=t.message.substr(0,n.messageMaxChars-n.trimedMessage.length)+n.trimedMessage);this.logCache.push(t);(this.logCache.length>this.uploadTriggerSize||t.level===logLevel.Error)&&this.triggerUploadAsync()},n.messageMaxChars=3072,n.trimedMessage="... [Trimmed]",n}();shiftFactory=1e3,function(n){n[n.WordViewer=301]="WordViewer";n[n.WopiPendingApplication=379]="WopiPendingApplication";n[n.VisioApp=700]="VisioApp";n[n.PptNavigation=810]="PptNavigation";n[n.PptSession=817]="PptSession";n[n.PptVersionHistory=832]="PptVersionHistory";n[n.PptLive=833]="PptLive"}(logCategory||(logCategory={})),function(n){n[n.Trace=0]="Trace";n[n.Assert=1]="Assert"}(logType||(logType={})),function(n){var t;(function(n){var r=function(){function n(){}return n.prototype.trace=function(n,t,i){this.traceTag(0,n,t,i)},n.prototype.traceTag=function(n,t,i,r){var u=null;switch(i){case logLevel.Verbose:u=console.debug;break;case logLevel.Info:u=console.log;break;case logLevel.Warning:case logLevel.Error:u=console.error;break;default:u=console.error}u(r)},n}(),t,i;n.ConsoleSessionLogger=r;t=function(){function n(n,t){try{this.logger=ULS.getLogger(n,t+"RemoteUls.ashx")}catch(i){}}return n.prototype.trace=function(n,t,i){this.logger!=null&&this.logger.ULS.trace(n,t,i)},n.prototype.traceTag=function(n,t,i,r){this.logger!=null&&this.logger.ULS.traceTag(n,t,i,r)},n.prototype.flush=function(){this.logger!=null&&this.logger.ULS.flush()},n.prototype.flushOnClose=function(){this.logger!=null&&this.logger.ULS.flushOnClose()},n}();n.UlsSessionLogger=t;i=function(){function n(){}return n.init=function(n){this.logger=n},n.trace=function(n,t,i){this.logger!=null&&this.logger.trace(n,t,i)},n.traceTag=function(n,t,i,r){this.logger!=null&&this.logger.traceTag(n,t,i,r)},n}();n.SessionLogger=i})(t=n.Telemetry||(n.Telemetry={}))}(PowerPointOnline||(PowerPointOnline={}));
var healthSmall=function(i){var t={};function n(e){if(t[e])return t[e].exports;var o=t[e]={i:e,l:!1,exports:{}};return i[e].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=i,n.c=t,n.d=function(i,t,e){n.o(i,t)||Object.defineProperty(i,t,{enumerable:!0,get:e})},n.r=function(i){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},n.t=function(i,t){if(1&t&&(i=n(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.__esModule)return i;var e=Object.create(null);if(n.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var o in i)n.d(e,o,function(t){return i[t]}.bind(null,o));return e},n.n=function(i){var t=i&&i.__esModule?function(){return i.default}:function(){return i};return n.d(t,"a",t),t},n.o=function(i,t){return Object.prototype.hasOwnProperty.call(i,t)},n.p="",n(n.s=0)}([function(i,t,n){"use strict";function e(i){if(i)return i}function o(i){if(null!=i)return i}function r(i){return null!=i&&i}function s(i){if(i){var t=new Map;return i.forEach((function(i,n){n&&i&&t.set(n,i)})),t}}function u(i){if(i){var t=new Set;return i.forEach((function(i){i&&t.add(i)})),t}}function l(i){if(i)return{durationMs:e(i.durationMs),extendedProperties:s(i.extendedProperties)}}function a(i){if(i){var t={};return i.forEach((function(i,n){n&&(t[n]=i)})),t}}function d(i,t){var n=[],e=new Set;return i.concat(t).forEach((function(i){return e.add(i)})),e.forEach((function(i){return n.push(i)})),n}n.r(t);var c=function(){function i(){var i=this;this._={},this.S=[],this.M={},this.I=0,this.U={H:3e5,O:!1,D:!1,A:3e4,K:25,P:"",T:864e5,F:"",R:"",V:3,W:3,B:15e3,C:new Set},this.L=!1,this.X=0,this.J=!1,this.N=0,this.G=!0,this.Y=function(){return!1},this.Z={},this.$=[],this.ii=0,this.ti=0,this.ni=void 0,this.ei=[],this.oi=[],this.ri=[],this.si=[],this.ui=0,this.li=0,this.ai=0,this.di=[],this.ci=!1,this.fi=0,this.vi=!1,this.hi=function(){i.ui&&(window.clearTimeout(i.ui),i.ui=0)},this.pi=function(){i.$=[],i.ei=[],i.oi=[],i.ni=void 0,i.ri=[],i.si=[],i.ii=0,i.ti=0},this.bi=function(){try{if(i.ii<=0)return;var t=i.mi();i.yi(t,i.I,i.U.W),i.pi()}catch(i){}},this.mi=function(){return{d:i.M,a:i._,b:i.$,e:i.oi,h:i.ni,q:i.ri,k:i.ei,l:i.si,type:"h_v2"}},this.wi=function(t,n,e,o){var r;if(void 0===o&&(o=!1),n&&!i.U.C.has(e))if(i.G){switch(t){case 0:i.$.push(n);break;case 1:i.ei.push(n);break;case 2:i.oi.push(n);break;case 3:-1===i.ri.map((function(i){return i.n})).indexOf(n.n)&&i.ri.push(n);break;case 4:i.si.push(n)}if(i.ii+=1,4!==t&&3!==t&&(i.ti+=1),i.Y()&&!o)return void i.bi();i.ii>=i.U.K&&(i.hi(),i._i())}else n.o=(new Date).toJSON(),null===(r=i.Si)||void 0===r||r.postMessage({t:t,k:i.M.w+"."+i.I,m:i.M,c:i._,v:n})},this.Mi=function(){i.hi(),i.ui=window.setTimeout((function(){i._i()}),i.U.A)},this._i=function(t){void 0===t&&(t=!1),t&&i.ti<=0||(i.bi(),i.Mi())},this.Ii=function(){if(i.di||i.Z){i.ni||(i.ii+=1);var t={p:i.ni?d(i.ni.p,i.di):i.di,k:i.ni?d(i.ni.k,i.S):i.S,i:i.U.H,o:i.X};i.ni=t,i.X=(i.X+1)%1e3}},this.xi=function(t,n,e,o,r,s,u,l,d,c){if(!n||i.Z[t]){n||i.Ui(t,l,d,c);var f=i.Z[t],v={n:f.k,e:e,t:f.t,a:f.a,f:f.o,d:null==o?void 0:o.durationMs,p:a(null==o?void 0:o.extendedProperties)};if(r){var h={n:r,x:u,z:s};v.k=h}i.wi(1,v,t)}},this.gi=function(){var t=i.U.M;t&&(i.M={a:t.application,b:t.applicationLcid,c:t.applicationMode,d:t.applicationModeExtended,e:t.arrVersion,f:t.browser,g:t.browserLcid,h:t.browserMajorVersion,i:t.browserVersion,j:t.clientVersion,k:t.datacenter,l:t.dataCulture,m:t.flightsImpressionId,n:t.host,o:t.isAnonymousUser,p:t.isBusinessUser,q:t.isEduUser,r:t.isSynthetic,s:t.loggableUserId,t:t.loggableUserIdSpace,u:t.ring,v:t.serverDocId,w:t.session_id,x:t.sessionOrigin,y:t.tenantId,z:t.uiHost,aa:t.wfeVersion,ab:t.fileExtension,ac:t.uiHostIntegrationType,ad:t.osVersion})},this.Hi=function(){i.Ii(),i.N=window.setTimeout((function(){i.Hi()}),i.U.H)},this.Oi=function(){i.di&&i.di.forEach((function(t){t&&i.ki(t,!0)}))},this.ki=function(t,n){var e={};e.n=t,i.wi(3,e,t,n)},this.Ei=function(){i.di&&(i.li=Date.now(),i.Oi()),i.ji()},this.ji=function(t){void 0===t&&(t=i.U.T),i.ai=window.setTimeout((function(){i.Ei()}),t)},this.Di=function(){i.L||(i.L=!0,i.J=!0,i.Hi())},this.Ai=function(){0!==i.ai&&(window.clearTimeout(i.ai),i.ai=0)},this.Ki=function(){if(i.U.O&&i.U.D&&i.U.R&&""!==i.U.R&&i.U.P&&""!==i.U.P)try{if("undefined"==typeof Worker)return void i.Pi(1);if(!i.U.P)return void i.Pi(2);i.Pi(3);var t=new Blob(["try{importScripts('"+encodeURI(i.U.P)+"');}catch(e){self.postMessage({i:14,l:'W',c:e})}"],{type:"application/javascript"});i.Si=new Worker(URL.createObjectURL(t)),i.Si.onmessage=function(t){try{var n=t.data;i.Pi(n.i,n.r)}catch(t){i.Pi(5,t)}},i.Si.postMessage({t:5,v:i.U.R}),i.Si.postMessage({t:6})}catch(t){i.Pi(6,t)}},this.Ti=function(t,n){var e;(t.b.length>0||t.e.length>0||t.q.length>0||t.k.length>0||t.l.length>0)&&(null===(e=i.Si)||void 0===e||e.postMessage({t:7,k:t.d.w+"."+n,v:t}))},this.Ui=function(t,n,e,o){t&&void 0!==n&&(i.Z[t]||(i.Z[t]={k:t,t:n,a:!0===e,o:o},e&&(i.S.push(t),i.Ii())))},this.Fi=function(t){i.X=0,t?(i.li=Date.now(),i.ji(),i.Di()):i.Ii()},this.Qi=function(t){return!!i.vi||(i.Pi(0,null==t?void 0:t.toString()),!1)},this.yi=function(t,n,e){if(t){var o=i.U.F;if(i.ci&&(e<=0||!i.G))i.Ti(t,n);else if(!(e<=0)){if(i.Y())try{if(void 0!==navigator.sendBeacon)return void navigator.sendBeacon(o,(r=t,JSON.stringify(r)))}catch(i){}var r,s=new XMLHttpRequest;s.open("POST",o,!0),t.d.w&&s.setRequestHeader("X-UserSessionId",t.d.w),s.onreadystatechange=function(){s.readyState===XMLHttpRequest.DONE&&(200===s.status?i.ci||(i.ci=!0):i.fi<i.U.V?(i.fi+=1,window.setTimeout((function(){i.fi-=1,i.yi(t,n,e-1)}),i.U.B)):i.ci&&i.Ti(t,n))},s.send(JSON.stringify(t))}}},this.Pi=function(t,n){var e={i:t,r:n};i.wi(4,e,t.toString())}}return i.getInstance=function(){return i.Ri||(i.Ri=new i),this.Ri},i.prototype.initialize=function(i){if(i)try{return this.U=function(i){var t,n,e,o,r,s,u,l,a,d,c;return{M:i.dimensions,H:null!==(t=i.heartbeatIntervalMs)&&void 0!==t?t:3e5,O:i.isHealthEnabled,D:i.isOfflineEnabled,A:null!==(n=i.maxIntervalMs)&&void 0!==n?n:3e4,K:null!==(e=i.maxQueueSize)&&void 0!==e?e:25,P:null!==(o=i.offlineWorkerUrl)&&void 0!==o?o:"",R:null!==(r=i.absoluteTelemetryUrl)&&void 0!==r?r:"",T:null!==(s=i.pillarIntervalMs)&&void 0!==s?s:864e5,F:null!==(u=i.telemetryUrl)&&void 0!==u?u:"",V:null!==(l=i.maxConcurrentRetries)&&void 0!==l?l:3,W:null!==(a=i.retryMaxAttempts)&&void 0!==a?a:3,B:null!==(d=i.retryDelayMs)&&void 0!==d?d:15e3,C:null!==(c=i.disabledHealthEvents)&&void 0!==c?c:new Set}}(i),this.gi(),this.Mi(),this.Ki(),this.vi=!0,void this.Pi(7)}catch(i){}this.vi=!1},i.prototype.addOrUpdatePartCDimension=function(i,t){this.Qi(0)&&i&&(this._.hasOwnProperty(i)&&this._[i]===t||(this._i(!0),this._[i]=t,this.I+=1,this.Ii(),this.Oi()))},i.prototype.addQosPillar=function(i){if(i){var t=0===this.di.length;-1===this.di.indexOf(i)&&(this.di.push(i),this.ki(i,!1),this.Fi(t))}},i.prototype.recordBsqmQosError=function(i,t,n){if(this.Qi(1)&&(this.stopAllHealthTimers(),this.Oi(),i)){var e={b:i,v:t,d:null==n?void 0:n.durationMs,p:a(null==n?void 0:n.extendedProperties),s:this.di};this.wi(0,e,i),this.shutdown()}},i.prototype.recordKpiFailure=function(i,t,n,e,o){this.xi(i,!0,0,o,t,e,n)},i.prototype.recordKpiImpliedFailure=function(i,t,n,e,o,r){this.xi(i,!1,1,r,t,e,n,0,!1,o)},i.prototype.recordKpiImpliedSuccess=function(i,t,n){this.xi(i,!1,2,n,void 0,void 0,void 0,0,!1,t)},i.prototype.recordKpiSuccess=function(i,t){this.xi(i,!0,3,t)},i.prototype.recordKpiUsage=function(i,t,n,e){this.xi(i,!1,4,{extendedProperties:e},void 0,void 0,void 0,t,!1,n)},i.prototype.recordKpiUsageForAlertableKpi=function(i,t,n){var e=!0,o=this.Z[i];o&&(e=0===o.t),this.xi(i,!1,4,{extendedProperties:n},void 0,void 0,void 0,0,!0,t),e&&this.Di()},i.prototype.recordQosError=function(i,t,n,e,o,r,s){if((!r||this.Qi(2))&&i&&t){var u={n:i,x:n,z:e,l:o,v:t,e:r,d:null==s?void 0:s.durationMs,p:a(null==s?void 0:s.extendedProperties),s:this.di};this.wi(2,u,i),r&&(this.stopAllHealthTimers(),this.Oi(),this.shutdown())}},i.prototype.removeQosPillar=function(i){var t=this.di.indexOf(i);t>-1&&(this.di.splice(t,1),this.Fi(!1)),0===this.di.length&&this.Ai()},i.prototype.resumeAllHealthTimers=function(){if(this.L&&!this.J&&this.Hi(),0===this.ai&&0!==this.li){var i=Date.now()-this.li;i>=this.U.T||i<=0?this.Ei():this.ji(this.U.T-i)}},i.prototype.setHandlerForIsAppShuttingDown=function(i){i&&(this.Y=i)},i.prototype.setIsAppOnline=function(i){var t;this.Qi(3)&&(!this.G&&i&&(null===(t=this.Si)||void 0===t||t.postMessage({t:6})),this.G=i)},i.prototype.shutdown=function(){var i;this.U.O&&(this.hi(),this.stopAllHealthTimers(),this.Y=function(){return!0},this.bi(),null===(i=this.Si)||void 0===i||i.terminate())},i.prototype.stopAllHealthTimers=function(){this.J=!1,this.X=0,0!==this.N&&(window.clearTimeout(this.N),this.N=0),this.Ai()},i.prototype.updatePartADimensions=function(i){var t=this;if(this.Qi(4)){var n=!1;Object.keys(i).forEach((function(e){void 0!==i[e]&&null!==i[e]&&""!==i[e]&&t.U.M[e]!==i[e]&&(t.U.M[e]=i[e],n=!0)})),n&&(this._i(),this.gi(),this.I+=1,this.Ii(),this.Oi())}},i}();function f(i,t){i&&t&&c.getInstance().addOrUpdatePartCDimension(i,t)}function v(i){i&&c.getInstance().addQosPillar(i)}function h(i,t,n){i&&c.getInstance().recordBsqmQosError(i,function(i){if(i){var t=[];return i.forEach((function(i){i&&t.push(i)})),t}}(t),l(n))}function p(i,t,n,o,r){i&&c.getInstance().recordKpiFailure(i,e(t),n,o,l(r))}function b(i,t,n,o,r,s){i&&c.getInstance().recordKpiImpliedFailure(i,e(t),n,o,e(r),l(s))}function m(i,t,n){i&&c.getInstance().recordKpiImpliedSuccess(i,e(t),l(n))}function y(i,t){i&&c.getInstance().recordKpiSuccess(i,l(t))}function w(i,t,n,o){i&&c.getInstance().recordKpiUsage(i,function(i){return i===k.FailureBased?0:1}(t),e(n),s(o))}function _(i,t,n){i&&c.getInstance().recordKpiUsageForAlertableKpi(i,e(t),s(n))}function S(i,t,n,e,o,r,s){i&&t&&c.getInstance().recordQosError(i,function(i){if(!i)return[];var t=[];return i.forEach((function(i){i&&t.push(i)})),t}(t),n,e,o,r,l(s))}function M(i){i&&c.getInstance().removeQosPillar(i)}function I(){c.getInstance().resumeAllHealthTimers()}function x(i){i&&c.getInstance().setHandlerForIsAppShuttingDown(i)}function U(i){c.getInstance().setIsAppOnline(i)}function g(){c.getInstance().shutdown()}function H(){c.getInstance().stopAllHealthTimers()}function O(i){c.getInstance().updatePartADimensions(e(i))}var k,E=function(){function i(){}return i.prototype.getHealthInstance=function(i){var t=function(i){var t,n,s,l,a,d,c,f,v,h,p,b,m,y,w,_,S,M,I,x,U,g,H,O,k,E,j,D,A,K;if(i)return{absoluteTelemetryUrl:e(i.absoluteRemoteTelemetryUrlForOfflineWorker),dimensions:{application:e(null===(t=i.dimensions)||void 0===t?void 0:t.application),applicationLcid:e(null===(n=i.dimensions)||void 0===n?void 0:n.applicationLcid),applicationMode:e(null===(s=i.dimensions)||void 0===s?void 0:s.applicationMode),applicationModeExtended:e(null===(l=i.dimensions)||void 0===l?void 0:l.applicationModeExtended),arrVersion:e(null===(a=i.dimensions)||void 0===a?void 0:a.arrVersion),browser:e(null===(d=i.dimensions)||void 0===d?void 0:d.browser),browserLcid:e(null===(c=i.dimensions)||void 0===c?void 0:c.browserLcid),browserMajorVersion:e(null===(f=i.dimensions)||void 0===f?void 0:f.browserMajorVersion),browserVersion:e(null===(v=i.dimensions)||void 0===v?void 0:v.browserVersion),clientVersion:e(null===(h=i.dimensions)||void 0===h?void 0:h.clientVersion),datacenter:e(null===(p=i.dimensions)||void 0===p?void 0:p.datacenter),dataCulture:e(null===(b=i.dimensions)||void 0===b?void 0:b.dataCulture),flightsImpressionId:e(null===(m=i.dimensions)||void 0===m?void 0:m.flightsImpressionId),host:e(null===(y=i.dimensions)||void 0===y?void 0:y.host),isAnonymousUser:o(null===(w=i.dimensions)||void 0===w?void 0:w.isAnonymousUser),isBusinessUser:o(null===(_=i.dimensions)||void 0===_?void 0:_.isBusinessUser),isEduUser:o(null===(S=i.dimensions)||void 0===S?void 0:S.isEduUser),isSynthetic:o(null===(M=i.dimensions)||void 0===M?void 0:M.isSynthetic),loggableUserId:e(null===(I=i.dimensions)||void 0===I?void 0:I.loggableUserId),loggableUserIdSpace:e(null===(x=i.dimensions)||void 0===x?void 0:x.loggableUserIdSpace),ring:e(null===(U=i.dimensions)||void 0===U?void 0:U.ring),serverDocId:e(null===(g=i.dimensions)||void 0===g?void 0:g.serverDocId),session_id:e(null===(H=i.dimensions)||void 0===H?void 0:H.session_id),sessionOrigin:e(null===(O=i.dimensions)||void 0===O?void 0:O.sessionOrigin),tenantId:e(null===(k=i.dimensions)||void 0===k?void 0:k.tenantId),uiHost:e(null===(E=i.dimensions)||void 0===E?void 0:E.uiHost),wfeVersion:e(null===(j=i.dimensions)||void 0===j?void 0:j.wfeVersion),fileExtension:e(null===(D=i.dimensions)||void 0===D?void 0:D.fileExtension),uiHostIntegrationType:e(null===(A=i.dimensions)||void 0===A?void 0:A.uiHostIntegrationType),osVersion:e(null===(K=i.dimensions)||void 0===K?void 0:K.osVersion)},disabledHealthEvents:u(i.disabledHealthEvents),heartbeatIntervalMs:e(i.heartbeatIntervalMs),isHealthEnabled:r(i.isHealthEnabled),isOfflineEnabled:r(i.isOfflineEnabled),maxConcurrentRetries:e(i.maxConcurrentRetries),maxIntervalMs:e(i.loggerMaxIntervalMs),maxQueueSize:e(i.loggerMaxQueueSize),offlineWorkerUrl:e(i.offlineWorkerUrl),pillarIntervalMs:e(i.recordPillarToWarmPipelineIntervalMs),retryDelayMs:e(i.retryDelayMs),retryMaxAttempts:e(i.retryMaxAttempts),telemetryUrl:e(i.remoteTelemetryUrl)}}(i);if(t)return c.getInstance().initialize(t),{addOrUpdatePartCDimension:f,addQosPillar:v,recordBsqmQosError:h,recordKpiFailure:p,recordKpiImpliedFailure:b,recordKpiImpliedSuccess:m,recordKpiSuccess:y,recordKpiUsage:w,recordKpiUsageForAlertableKpi:_,recordQosError:S,removeQosPillar:M,resumeAllHealthTimers:I,setHandlerForIsAppShuttingDown:x,setIsAppOnline:U,shutdown:g,stopAllHealthTimers:H,updatePartADimensions:O}},i}();!function(i){i[i.FailureBased=0]="FailureBased",i[i.SuccessBased=1]="SuccessBased"}(k||(k={}));var j=new E;n.d(t,"KpiTypeSS",(function(){return k})),n.d(t,"HealthFactorySSGlobal",(function(){return j})),n.d(t,"Health",(function(){return c})),n.d(t,"HealthFactorySS",(function(){return E}))}]);
//# sourceMappingURL=healthSmall.min.js.map
"use strict";function createPODSRegion(n,t,i,r){return t===void 0&&(t="https://c1-powerpoint-15.cdn.office.net/pods/s/"),i===void 0&&(i="5"),r===void 0&&(r=!1),{PodsURL:n,WacCdnStaticServer:t,PreviewerRolloutRing:i,IsGoLocalRoutedToPublic:r}}function createSNAPRegion(n,t,i,r){return t===void 0&&(t="5"),i===void 0&&(i=0),r===void 0&&(r=!1),{SnapURL:n,PreviewerRolloutRing:t,RolloutPercentage:i,IsGoLocalRoutedToPublic:r}}function createUseSnapDetails(n,t){return{UseSnap:n,Reason:t}}function createUsePODSDetails(n,t,i){return{ShouldUsePODS:n,CanUsePODS:t,Reason:i}}function createPresentRegion(n,t,i,r){return t===void 0&&(t="5"),i===void 0&&(i=0),r===void 0&&(r=!1),{PresentURL:n,PreviewerRolloutRing:t,RolloutPercentage:i,IsGoLocalRoutedToPublic:r}}function createUsePresentDetails(n,t){return{UsePresent:n,Reason:t}}function tryReadBoolDefaultTrue(n){return n!=undefined?n:!0}var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},__assign.apply(this,arguments)},__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e},Configuration=function(){function n(){}return n.HostCallbackTimeout=6e4,n}(),BuildVersionConfig=function(){function n(){}return Object.defineProperty(n,"BUILD_NUMBER",{get:function(){return"16.0.17324.40506"},enumerable:!1,configurable:!0}),Object.defineProperty(n,"BUILD_NUMBER_MINOR",{get:function(){return 1732440506},enumerable:!1,configurable:!0}),Object.defineProperty(n,"BUILD_CDN_NUMBER",{get:function(){return"161732440506"},enumerable:!1,configurable:!0}),n}(),ApplicationErrorMap=function(){function n(){}return n.convertServerErrorToAppErrorCode=function(n,t){var i=n;n.indexOf("Server")==0&&(i=n.slice(6).trim());switch(i){case"ErrorWorkerCannotOpenDocument":return 5308422;case"ErrorWorkerCannotOpenDocumentFileType":return 5341186;case"ErrorWorkerCannotOpenDocumentIRM":case"ErrorFileDownloadNotSupportedFileType":return 5341187;case"ErrorWorkerCannotOpenDocumentPassword":return 5341188;case"ErrorCannotInstallFonts":return 5341190;case"ErrorCannotRender":return 5341281;case"ErrorWorkerCannotOpenDocumentMacro":return 5341217;case"ErrorWorkerCannotOpenDocumentSigned":return 5341219;case"ErrorWorkerCannotOpenDocumentWrongExt":return 5341260;case"ErrorWorkerCannotOpenDocumentStgDocFileCorrupt":return 5341261;case"ErrorWorkerCannotOpenDocumentMmcfPackagePartNotFound":return 5341263;case"ErrorWorkerCannotOpenDocumentArchiveError":return 5341264;case"ErrorWorkerCannotOpenDocumentTooLarge":return 5341301;case"ErrorFileDownloadZeroByteFile":return 5341338;case"ErrorFileNotFound":return 5341412;case"Unauthorized":case"ErrorFileDownloadStatusCodeUnauthorized":return 5341414;case"ErrorFileDownloadStatusCodeForbidden":return 5341415;case"ErrorFileDownloadStatusCodeNotFound":return 5341417;case"ErrorFileDownloadFailed":return 5341421;case"ErrorFileDownloadStatusCodeTooManyRequests":return 5341437;case"ErrorCannotOpenFileMetroFileCorruption":return 5341440;case"ErrorFileDownloadTimedOut":return 5341460;case"GetItemsFailedDownloadFile":return 5341461;case"Failed to fetch":case"ErrorFailedToFetch":return 5341599;case"ErrorRESERVEDItemFailed":return 5341600;case"ErrorRequestTimeout":return 5341601;case"ErrorFileDownloadResourceInconsistent":return 5341602;case"ErrorGeneralUnknown":return 5341603;case"ErrorRequestFailed":return 5341610;case"ErrorWorkerExceedLimit":return 5341612;case"ErrorConnectionLost":return 5341613;case"ErrorFileDownloadNetworkError":return 5341614;case"ErrorWorkerCannotOpenDocumentStgFileAlreadyExists":return 5341615;case"ErrorInvalidItem":return 5341617;case"ResourceLoaderFailed":return 5341618;case"ErrorFileDownloadFailedToParseEndOfCentralDirectory":return 5341619;case"ErrorWorkerFailed":return 5373969;default:return t&&t.ULS.traceTag(557417609,logCategory.PptSession,logLevel.Warning,"Bootstrapper::convertToAppErrorCode: "+i+" is converted to 5001"),5001}},n.ModernBootStageToTimeoutErrorNameMap={SlideShowAppStart:{errorName:"BootTimeoutAtSlideShowAppStart",errorCode:51},GetItemsCall:{errorName:"BootTimeoutAtGetItemsCall",errorCode:52},DownloadResponseStream:{errorName:"BootTimeoutAtDownloadResponseStream",errorCode:53},ParseMultipartResponse:{errorName:"BootTimeoutAtParseMultipartResponse",errorCode:54},InitViewController:{errorName:"BootTimeoutAtInitViewController",errorCode:55},GotoTargetSlide:{errorName:"BootTimeoutAtGotoTargetSlide",errorCode:56},RenderingTransition:{errorName:"BootTimeoutAtRenderingTransition",errorCode:57},RenderingSlide:{errorName:"BootTimeoutAtRenderingSlide",errorCode:58},FlushingShaders:{errorName:"BootTimeoutAtFlushingShaders",errorCode:59},PreparingSBItems:{errorName:"BootTimeoutAtPreparingSBItems",errorCode:60},SwitchingToSVG:{errorName:"BootTimeoutAtSwitchingToSVG",errorCode:61},FinishingHandshake:{errorName:"BootTimeoutAtFinishingHandshake",errorCode:63},ReEnsureTextureLoaded:{errorName:"BootTimeoutAtReEnsureTextureLoaded",errorCode:62}},n}(),BrowserUtils=function(){function n(){}return n.devicePixelRatio=function(){return window.devicePixelRatio||(window.screen?window.screen.deviceXDPI/window.screen.logicalXDPI:1)||1},n.isSafari=function(){var n=window.navigator.userAgent.toLowerCase();return n.indexOf(" applewebkit/")>-1&&n.indexOf("version/")>-1&&n.indexOf("edge/")<0},n.isBrowserSupportedForModernSlideShow=function(t,i,r){var e,o,f,a,s,h,c,u,l;try{if(e=window.navigator.userAgent.toLowerCase(),e==null)return t&&t.ULS.traceTag(558438435,logCategory.PptSession,logLevel.Error,"IsBrowserSupportedForModernSlideShow: userAgent is null, defaulting to false"),!1;if(e.indexOf("trident/")>=0||e.indexOf("msie/")>=0)return t&&t.ULS.traceTag(558438464,logCategory.PptSession,logLevel.Info,"IsBrowserSupportedForModernSlideShow IE"),!1;if(o=!1,f=n.getBrowserInfo(),r){for(a=r.split(";"),s=0,h=a;s<h.length;s++)if(c=h[s],c.split(":")[0].toLowerCase()==f.name.toLowerCase()&&parseInt(f.version,10)<parseInt(c.split(":")[1],10)){o=!0;break}}else t===null||t===void 0?void 0:t.ULS.traceTag(558438465,logCategory.PptSession,logLevel.Info,"pptFeatureGates.modernSlideShowBlockListForBrowserVersion undefined or null");return u="Unknown OS",navigator.userAgent.indexOf("Win")!=-1&&(u="Windows"),navigator.userAgent.indexOf("Mac")!=-1&&(u="Macintosh"),navigator.userAgent.indexOf("Linux")!=-1&&(u="Linux"),navigator.userAgent.indexOf("Android")!=-1&&(u="Android"),navigator.userAgent.indexOf("like Mac")!=-1&&(u="iOS"),l=i?i.indexOf(u)>=0:!1,t&&t.ULS.traceTag(558438466,logCategory.PptSession,logLevel.Info,"IsBrowserSupportedForModernSlideShow Name "+f.name+", Version "+f.version+", OSName "+u+", BlockedBrowser "+o+", BlockedOS "+l),!l&&!o}catch(v){return t===null||t===void 0?void 0:t.ULS.traceTag(558438467,logCategory.PptSession,logLevel.Error,"Unexpected exception in ModernSlideShowEnabledHelper: "+v),!1}},n.getBrowserInfo=function(){var i=navigator.userAgent,t,n=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(i)||[],{name:"IE",version:t[1]||""}):n[1]==="Chrome"&&(t=i.match(/\b(OPR|Edge)\/(\d+)/),t!=null)?{name:t[1].replace("OPR","Opera"),version:t[2]}:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=i.match(/version\/(\d+)/i))!=null&&n.splice(1,1,t[1]),{name:n[0],version:n[1]})},n.isBrowserShapeBuilderCompatible=function(t,i,r){var c,l,f,b,o,a,v,e,u,p,s,tt,h,w,it;try{if(c=!1,l="PowerVR Rogue GX6250;SwiftShader;PowerVR Rogue GE8322;Adreno(TM) 680;Direct3D9Ex",r){for(f=n.getBrowserInfo(),b=r.split(";"),o=0,a=b;o<a.length;o++)if(v=a[o],v.split(":")[0].toLowerCase()==f.name.toLowerCase()&&parseInt(f.version,10)<parseInt(v.split(":")[1],10))return c=!0,i&&i.ULS.traceTag(554505223,logCategory.PptSession,logLevel.Info,"IsBrowserModernWebGLCompatible Name "+f.name+", Version "+f.version+", FakkbackBrowser "+c),!1}else i&&i.ULS.traceTag(554505224,logCategory.PptSession,logLevel.Info,"pptFeatureGates.modernWebGLBlockListForBrowserVersion undefined or null");if(e=document.createElement("canvas"),e.addEventListener("webglcontextcreationerror",function(n){return t.webglcontextcreationerror=""+(n.statusMessage||"Unknown error")}),u=e.getContext("webgl"),u==null&&(u=e.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0}),t.WebGLExperimental=!0),u==null)return t.GLIncompatible="CanvasRenderingContext",u=e.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!1}),u!=null&&(t.WebGLExperimentalWithPerfCaveat=!0),!1;if(!u.getExtension("EXT_blend_minmax"))return t.GLIncompatible="MinMax",!1;if(!u.getExtension("ANGLE_instanced_arrays"))return t.GLIncompatible="Instancing",!1;var k=u.getParameter(u.MAX_VERTEX_ATTRIBS),rt=u.getParameter(u.MAX_VERTEX_UNIFORM_VECTORS),d=u.getParameter(u.MAX_VERTEX_TEXTURE_IMAGE_UNITS),g=u.getParameter(u.MAX_VARYING_VECTORS),nt=u.getParameter(u.MAX_FRAGMENT_UNIFORM_VECTORS),ut=u.getParameter(u.MAX_TEXTURE_IMAGE_UNITS),y=u.getParameter(u.MAX_TEXTURE_SIZE);if(y<4096)return t.GLIncompatible="TextureSize",!1;t.VERTEX_ATTRIBS=k;t.VERTEX_UNIFORM_VECTORS=rt;t.VERTEX_TEXTURE_IMAGE_UNITS=d;t.VARYING_VECTORS=g;t.FRAGMENT_UNIFORM_VECTORS=nt;t.TEXTURE_IMAGE_UNITS=ut;t.TEXTURE_SIZE=y;try{if(p=u.getExtension("WEBGL_debug_renderer_info"),p)if(s={},s.WebGLRenderer=u.getParameter(p.UNMASKED_RENDERER_WEBGL),l){for(tt=l.split(";"),h=0,w=tt;h<w.length;h++)if(it=w[h],s.WebGLRenderer.toLowerCase().indexOf(it.toLowerCase())>=0)return i&&i.ULS.traceTag(558438468,logCategory.PptSession,logLevel.Info,"isBrowserShapeBuilderCompatible - Unsupported GPU Renderer: "+s.WebGLRenderer),t.GLIncompatible="UnsupportedGPURenderer",!1}else i&&i.ULS.traceTag(512558470,logCategory.PptSession,logLevel.Info,"pptFeatureGates.modernWebGLBlockListForGPURenderer undefined or null")}catch(ft){}return k<16||d<4||g<8||nt<64||y<4096?(t.GLIncompatible="InsufficientCapabilities",i&&i.ULS.traceTag(546182111,logCategory.PptSession,logLevel.Info,"isBrowserShapeBuilderCompatible is true"),!1):!0}catch(et){return t.GLIncompatible="Exception",!1}finally{t&&Object.keys(t).length>0&&i&&i.ULS.traceTag(588105736,logCategory.PptSession,logLevel.Info,JSON.stringify(t))}},n}(),HTMLHelper=function(){function n(){}return n.toPx=function(n){return isNaN(n)?"":n.toString()+"px"},n.floatToPercent=function(n){return(n*100).toString()+"%"},n.isInDomTree=function(n){return!n||!n.parentNode?!1:n.id?!!document.getElementById(n.id):n.isConnected!==undefined?n.isConnected:document.body.contains(n)},n}(),DocRebootSupportMode,MathHelper,PptSessionBootStatus,PresentationUrlGuaranteeLevel,PPTPreviewerGetPptFileData,PPTBootstrapSettings;(function(n){n[n.NotSupported=0]="NotSupported";n[n.SameDocOnly=1]="SameDocOnly";n[n.AnyDoc=2]="AnyDoc"})(DocRebootSupportMode||(DocRebootSupportMode={}));MathHelper=function(){function n(){}return n.hash=function(n){for(var t=0,i=0;i<n.length;i+=1)t=(t<<5)-t+n.charCodeAt(i),t=t&t;return t},n}();var PodsRegionInfo=function(){function n(){}return n.getWacToPodsUnifiedMap=function(){var n={};return n[this.ffcUrl]=createPODSRegion(this.ffcUrl+this.pods,"https://c5-powerpoint-15.cdn.office.net/pods/s/"),n[this.ppcUrl]=createPODSRegion(this.ppcUrl+this.pods,"https://c4-powerpoint-15.cdn.office.net/pods/s/"),n[this.prodUrl]=createPODSRegion(this.prodUrl+this.pods),n[this.uscUrl]=createPODSRegion(this.uscUrl+this.pods),n[this.eucUrl]=createPODSRegion(this.eucUrl+this.pods),n[this.cacUrl]=createPODSRegion(this.cacUrl+this.pods),n[this.ukcUrl]=createPODSRegion(this.ukcUrl+this.pods),n[this.aucUrl]=createPODSRegion(this.aucUrl+this.pods),n[this.jpcUrl]=createPODSRegion(this.jpcUrl+this.pods),n[this.incUrl]=createPODSRegion(this.incUrl+this.pods),n[this.krcUrl]=createPODSRegion(this.krcUrl+this.pods),n[this.frcUrl]=createPODSRegion(this.frcUrl+this.pods),n[this.sgcUrl]=createPODSRegion(this.sgcUrl+this.pods),n[this.zacUrl]=createPODSRegion(this.zacUrl+this.pods),n[this.aecUrl]=createPODSRegion(this.aecUrl+this.pods),n[this.decUrl]=createPODSRegion(this.decUrl+this.pods),n[this.chcUrl]=createPODSRegion(this.chcUrl+this.pods),n[this.nocUrl]=createPODSRegion(this.nocUrl+this.pods),n[this.secUrl]=createPODSRegion(this.secUrl+this.pods),n[this.qtcUrl]=createPODSRegion(this.qtcUrl+this.pods),n[this.brcUrl]=createPODSRegion(this.brcUrl+this.pods),n[this.plcUrl]=createPODSRegion(this.plcUrl+this.pods),n[this.eurppcUrl]=createPODSRegion(this.eucUrl+this.pods),n[this.blackforestUrl]=createPODSRegion(this.blackforestUrl+this.pods,"https://powerpoint.cdn.office.de/pods/s/"),n[this.gallatinUrl]=createPODSRegion(this.gallatinUrl+this.pods,"https://powerpoint.cdn.partner.officewebapps.cn/pods/s/"),n[this.usGovUrl]=createPODSRegion(this.usGovUrl+this.pods,"https://powerpoint.cdn.office365.us/pods/s/"),n[this.gbcUrl]=createPODSRegion(this.gbcUrl+this.pods,"https://powerpoint.cdn.office365.us/pods/s/"),n[this.usDoDUrl]=createPODSRegion(this.usDoDUrl+this.pods,"https://powerpoint.dod.cdn.office365.us/pods/s/"),n},n.getWacToPodsPreviewerMap=function(){var t={};return t[this.ffcUrl]=this.ShouldRerouteEdogToProd?createPODSRegion(this.https+"usc"+n.hostOSIPodsService,"https://c4-powerpoint-15.cdn.office.net/pods/s/"):createPODSRegion(this.https+"pods.edog.officeapps.live.com/","https://c5-powerpoint-15.cdn.office.net/pods/s/","1"),t[this.ppcUrl]=createPODSRegion(this.https+"msit"+n.hostOSIPodsService,"https://c4-powerpoint-15.cdn.office.net/pods/s/","2"),t[this.prodUrl]=createPODSRegion(this.https+n.hostOSIPodsService.substring(1)),t[this.uscUrl]=createPODSRegion(this.https+"usc"+n.hostOSIPodsService),t[this.brcUrl]=createPODSRegion(this.https+"brc"+n.hostOSIPodsService),t[this.eucUrl]=createPODSRegion(this.https+"euc"+n.hostOSIPodsService),t[this.cacUrl]=createPODSRegion(this.https+"canc"+n.hostOSIPodsService),t[this.ukcUrl]=createPODSRegion(this.https+"ukc"+n.hostOSIPodsService),t[this.aucUrl]=createPODSRegion(this.https+"ausc"+n.hostOSIPodsService),t[this.jpcUrl]=createPODSRegion(this.https+"jpc"+n.hostOSIPodsService),t[this.incUrl]=createPODSRegion(this.https+"inc"+n.hostOSIPodsService),t[this.krcUrl]=createPODSRegion(this.https+"krc"+n.hostOSIPodsService),t[this.frcUrl]=createPODSRegion(this.https+"frc"+n.hostOSIPodsService),t[this.sgcUrl]=createPODSRegion(this.https+"sgc"+n.hostOSIPodsService),t[this.eurppcUrl]=createPODSRegion(this.https+"euc"+n.hostOSIPodsService),t[this.usGovUrl]=createPODSRegion(this.https+"pods.osi.office365.us/","https://powerpoint.cdn.office365.us/pods/s/","6"),t[this.gbcUrl]=createPODSRegion(this.https+"pods.osi.office365.us/","https://powerpoint.cdn.office365.us/pods/s/","6"),t[this.usDoDUrl]=createPODSRegion(this.https+"pods.osi.apps.mil/","https://powerpoint.dod.cdn.office365.us/pods/s/","6"),t[this.gallatinUrl]=createPODSRegion(this.https+"pods.officeapps.partner.office365.cn/","https://powerpoint.cdn.partner.officewebapps.cn/pods/s/","6"),t[this.airGap08Url]=createPODSRegion(this.https+"pods.osi.eaglex.ic.gov/","https://powerpoint.cdn.wac.online.office.eaglex.ic.gov/pods/s/","7"),t[this.airGap09Url]=createPODSRegion(this.https+"pods.osi.microsoft.scloud/","https://powerpoint.cdn.wac.online.office.microsoft.scloud/pods/s/","7"),t.edog=createPODSRegion(this.https+"pods.edog.officeapps.live.com/","https://c5-powerpoint-15.cdn.office.net/pods/s/","1"),t[this.intTestUrl]=createPODSRegion(this.intTestUrl+"/","https://c5-powerpoint-15.cdn.office.net/pods/s/","0"),t[this.intDevUrl]=createPODSRegion(this.intDevUrl+"/","https://c5-powerpoint-15.cdn.office.net/pods/s/","0"),t[this.zacUrl]=createPODSRegion(this.https+n.hostOSIPodsService.substring(1)),t[this.zacUrl].IsGoLocalRoutedToPublic=!0,t[this.aecUrl]=createPODSRegion(this.https+n.hostOSIPodsService.substring(1)),t[this.aecUrl].IsGoLocalRoutedToPublic=!0,t[this.qtcUrl]=createPODSRegion(this.https+n.hostOSIPodsService.substring(1)),t[this.qtcUrl].IsGoLocalRoutedToPublic=!0,t[this.decUrl]=createPODSRegion(this.https+"euc"+n.hostOSIPodsService),t[this.decUrl].IsGoLocalRoutedToPublic=!0,t[this.chcUrl]=createPODSRegion(this.https+"euc"+n.hostOSIPodsService),t[this.chcUrl].IsGoLocalRoutedToPublic=!0,t[this.nocUrl]=createPODSRegion(this.https+"euc"+n.hostOSIPodsService),t[this.nocUrl].IsGoLocalRoutedToPublic=!0,t[this.secUrl]=createPODSRegion(this.https+"euc"+n.hostOSIPodsService),t[this.secUrl].IsGoLocalRoutedToPublic=!0,t[this.plcUrl]=createPODSRegion(this.https+"euc"+n.hostOSIPodsService),t[this.plcUrl].IsGoLocalRoutedToPublic=!0,t},n.shouldRouteToEdog=function(n,t,i){return!t||!t.SessionInformation||i=="6"?!1:t.SessionInformation.UiHostRing&&this.TeamsRingsInEdog.indexOf(t.SessionInformation.UiHostRing.toLowerCase())>=0?!0:this.HostsWithFFInEdog.indexOf(t.SessionInformation.HostName)>=0&&n===this.ffcUrl?!0:!1},n.tryGetPodsRegion=function(n,t,i){var u=n.substring(0,n.indexOf("/p/")),r;return i?this.WacToPodsUnifiedMap[u.toLowerCase()]:u.toLowerCase()==this.gallatinUrl&&t&&t.SessionInformation&&t.SessionInformation.HostName=="OneDrive"?undefined:(r=this.WacToPodsPreviewerMap[u.toLowerCase()],r&&this.shouldRouteToEdog(u.toLowerCase(),t,r.PreviewerRolloutRing)&&(r=this.WacToPodsPreviewerMap.edog),r)?r:this.RouteToWacPodsRegion(u)},n.GetDefaultProdRegion=function(){return this.WacToPodsPreviewerMap[this.prodUrl]},n.RouteToWacPodsRegion=function(n){return this.WacToPodsUnifiedMap[n.toLowerCase()]},n.getPodsRing=function(n){if(n.ApplicationUrl){var t=this.tryGetPodsRegion(n.ApplicationUrl,n,!1);return t&&t.PreviewerRolloutRing?t.PreviewerRolloutRing:"-4"}return"-4"},n.getWACRegion=function(n){return n?n.substring(0,n.indexOf("/p/")).toLowerCase():""},n.getFileHost=function(n){if(!n)return"";if(n.Diagnostics&&n.Diagnostics.fileHost)return n.Diagnostics.fileHost;if(n.SessionInformation&&n.SessionInformation.HostName){var t=n.SessionInformation.HostName;switch(t){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":case"OneDrive":case"ParticipantApp":case"DragonGate":return"SharePoint Online";default:return t}}return""},n.getUiHost=function(n){if(!n)return"";switch(n){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":return"teams";case"ParticipantApp":case"DragonGate":return n;default:return""}},n.ShouldRerouteEdogToProd=window.location.search.indexOf("wdTestPreviewerInEdog")>=0?!1:!0,n.HostsWithFFInEdog=["TeamsiOS","OneDrive"],n.TeamsRingsInEdog=["ring0","ring0_s"],n.https="https://",n.pods="/pods/",n.hostWAC="-powerpoint.officeapps.live.com",n.hostOSIPodsService=".pods.officeapps.live.com/",n.ffcUrl=n.https+"ffc"+n.hostWAC,n.ppcUrl=n.https+"ppc"+n.hostWAC,n.uscUrl=n.https+"usc"+n.hostWAC,n.eucUrl=n.https+"euc"+n.hostWAC,n.eurppcUrl=n.https+"eurppc"+n.hostWAC,n.cacUrl=n.https+"cac"+n.hostWAC,n.ukcUrl=n.https+"ukc"+n.hostWAC,n.aucUrl=n.https+"auc"+n.hostWAC,n.jpcUrl=n.https+"jpc"+n.hostWAC,n.incUrl=n.https+"inc"+n.hostWAC,n.krcUrl=n.https+"krc"+n.hostWAC,n.frcUrl=n.https+"frc"+n.hostWAC,n.sgcUrl=n.https+"sgc"+n.hostWAC,n.zacUrl=n.https+"zac"+n.hostWAC,n.aecUrl=n.https+"aec"+n.hostWAC,n.gbcUrl=n.https+"gbc"+n.hostWAC,n.decUrl=n.https+"dec"+n.hostWAC,n.chcUrl=n.https+"chc"+n.hostWAC,n.nocUrl=n.https+"noc"+n.hostWAC,n.secUrl=n.https+"sec"+n.hostWAC,n.qtcUrl=n.https+"qtc"+n.hostWAC,n.brcUrl=n.https+"brc"+n.hostWAC,n.plcUrl=n.https+"plc"+n.hostWAC,n.blackforestUrl=n.https+"powerpoint.online.office.de",n.gallatinUrl=n.https+"cnc-powerpoint.partner.officewebapps.cn",n.usGovUrl=n.https+"powerpoint.gov.online.office365.us",n.usDoDUrl=n.https+"powerpoint.dod.online.office365.us",n.airGap08Url=n.https+"powerpoint.wac.online.office.eaglex.ic.gov",n.airGap09Url=n.https+"powerpoint.wac.online.office.microsoft.scloud",n.prodUrl=n.https+n.hostWAC.substring(1),n.intTestUrl=n.https+"test.pods.officeapps.live-int.com",n.intDevUrl=n.https+"dev.pods.officeapps.live-int.com",n.WacToPodsUnifiedMap=n.getWacToPodsUnifiedMap(),n.WacToPodsPreviewerMap=n.getWacToPodsPreviewerMap(),n}(),PPTBootstrapper=function(){function n(){}return n.ensureInitializeParametersAreTheRightType=function(n){n.WopiPrecheckInfo.PreseededSessionKey&&(n.WopiPrecheckInfo.PreseededSessionKey.slice(0,6)!=="_._._."||n.WopiPrecheckInfo.PreseededSessionKey.slice(-6)!=="-.-.-.")&&(n.WopiPrecheckInfo.PreseededSessionKey="_._._."+n.WopiPrecheckInfo.PreseededSessionKey+"-.-.-.");n.ApplicationCustomSettings&&n.ApplicationCustomSettings.EnableWacFallback==null&&(n.ApplicationCustomSettings.EnableWacFallback=!0)},n.getOnDemandServer=function(n,t){var i,r,u;if(t===void 0&&(t=!1),n&&n.ApplicationCustomSettings&&n.ApplicationCustomSettings.OnDemandServer)return n.ApplicationCustomSettings.OnDemandServer;if(n&&n.ApplicationUrl&&(i=PodsRegionInfo.tryGetPodsRegion(n.ApplicationUrl,n,t),i))return i.PodsURL;r=PPTBootstrapSettings.getAppMetadata();u=r?r.Environment:"";switch(u){case"wac":return n&&n.ApplicationUrl?n.ApplicationUrl.substring(0,n.ApplicationUrl.indexOf("PowerPointFrame.aspx")).replace("/p/","/pods/"):"";default:return"https://localhost:8080/"}},n.getPresentFrontdoorServer=function(n,t){if(n&&n.ApplicationUrl){var i=PresentRegionInfo.tryGetPresentRegion(n.ApplicationUrl,n);if(i)return t===null||t===void 0?void 0:t.ULS.traceTag(508653836,logCategory.PptSession,logLevel.Info,"PPTBootstrapper.getPresentFrontdoorServer Region in allowlist for present frontdoor. PresentUrl "+i.PresentURL+"."),i.PresentURL}return t===null||t===void 0?void 0:t.ULS.traceTag(508653834,logCategory.PptSession,logLevel.Info,"Unable to get present region url. Returning default."),""},n.getWacStaticResourcesServer=function(n,t,i,r){var u,f;if(n&&n.WacStaticResourcesServer)return n.WacStaticResourcesServer;if(i)return u="pods/s/",i.split(u)[0]+u;if(t){if(f=PodsRegionInfo.tryGetPodsRegion(t,r,!1),f)return f.WacCdnStaticServer;throw Error("Application url provided but region not in region allowlist");}return"https://c1-powerpoint-15.cdn.office.net/pods/s/"},n.getStaticResourcesServerHostName=function(t,i){try{return UrlUtils.getHostname(n.getWacStaticResourcesServer(t.ApplicationCustomSettings,t.ApplicationUrl,t.BootstrapperUrl,t))}catch(r){return i.ULS.traceTag(554776468,logCategory.PptSession,logLevel.Error,"PPTBootstrapper.getStaticResourcesServerHostName: Caught exception "+r+"."),""}},n.isDoDRegion=function(n,t){return this.getStaticResourcesServerHostName(n,t)=="powerpoint.dod.cdn.office365.us"},n.getUrlDomain=function(n,t){try{return n?UrlUtils.getHostname(n):""}catch(i){return t.ULS.traceTag(539820259,logCategory.PptSession,logLevel.Error,"PPTBootstrapper.getUrlDomain: Caught exception "+i+"."),""}},n.generateRandomHexChar=function(){var n=new Uint8Array(1);return window.self.crypto&&window.self.crypto.getRandomValues?(window.self.crypto.getRandomValues(n),Math.floor(n[0]/16).toString(16)):window.msCrypto&&window.msCrypto.getRandomValues?(window.msCrypto.getRandomValues(n),Math.floor(n[0]/16).toString(16)):Math.floor(Math.random()*16).toString(16)},n.generateRandomUUID=function(){return"xxxxxxxx-xxxx-4xxx-xxxx-xxxxxxxxxxxx".replace(/[x]/g,this.generateRandomHexChar)},n.getBrowserTechnology=function(n,t){return this.getSlideShowKind(n,t)=="Modern"?n.SessionInformation.WdParams&&!n.SessionInformation.WdParams.wdBrowserShapeBuilderCompatible?"SVG":"WebGL":""},n.isScenarioBlockedForModernSS=function(n,t){var f,e,o,s,h=(e=(f=n.SessionInformation)===null||f===void 0?void 0:f.HostName)===null||e===void 0?void 0:e.toLowerCase(),r=PPTBootstrapperFeatureGatesHelper.getFeatureGates(n,t),u="",i=!1;return h==="msteams"&&(n.SessionInformation.WdParams?((o=n.SessionInformation.WdParams)===null||o===void 0?void 0:o.wdBrowserCompatible)===undefined?(i=!BrowserUtils.isBrowserSupportedForModernSlideShow(t,r===null||r===void 0?void 0:r.ModernSlideShowBlockListForOS,r===null||r===void 0?void 0:r.ModernSlideShowBlockListForBrowserVersion),i&&(u="UnsupportedBrowser")):(t.ULS.traceTag(545927457,logCategory.PptSession,logLevel.Info,"wdBrowserCompatible: "+n.SessionInformation.WdParams.wdBrowserCompatible),i=!n.SessionInformation.WdParams.wdBrowserCompatible,i&&(u="UnsupportedBrowser")):t.ULS.traceTag(545927456,logCategory.PptSession,logLevel.Error,"WdParam is null - Sanitize initParams and set it to not null"),r.AllowSingleWindowElectronTraffic||((s=n.SessionInformation.HostExperience)===null||s===void 0?void 0:s.toLocaleLowerCase())!="singlewindow"||window.navigator.userAgent.toLowerCase().indexOf("electron")==-1||(t.ULS.traceTag(545122067,logCategory.PptSession,logLevel.Info,"Blocking ModernSS for SingleWindow in Electron scenarios"),i=!0,u="SingleWindowElectron")),t.ULS.traceTag(545927458,logCategory.PptSession,logLevel.Info,"unsupportedModernSSScenario: "+i),i&&t.ULS.traceTag(545122068,logCategory.PptSession,logLevel.Info,"ModernUnsupportedReason: "+u),i},n.getSlideShowKind=function(t,i){var r=PPTBootstrapperFeatureGatesHelper.getFeatureGates(t,i);return r.RevertNewGetSlideShowKindLogic?n.getSlideShowKindOldVersion(t,i,r):n.getSlideShowKindUpdatedVersion(t,i,r)},n.getSlideShowKindOldVersion=function(n,t,i){var r="Modern",e="Legacy",o,f;try{if(t&&t.ULS.traceTag(559495312,logCategory.PptSession,logLevel.Info,"pptFeatureGates - "+JSON.stringify(i)),i===null||i===void 0?void 0:i.ForceLegacySlideShow)return e;if(n.SessionInformation.WdParams&&n.SessionInformation.WdParams.wdBrowserCompatible===undefined&&(n.SessionInformation.WdParams=__assign(__assign({},n.SessionInformation.WdParams),{wdBrowserCompatible:BrowserUtils.isBrowserSupportedForModernSlideShow(t,i?i.ModernSlideShowBlockListForOS:undefined,i?i.ModernSlideShowBlockListForBrowserVersion:undefined)})),n.SessionInformation.WdParams&&n.SessionInformation.WdParams.wdBrowserShapeBuilderCompatible==null&&(n.SessionInformation.WdParams=__assign(__assign({},n.SessionInformation.WdParams),{wdBrowserShapeBuilderCompatible:BrowserUtils.isBrowserShapeBuilderCompatible({},t,i?i.ModernWebGLBlockListForBrowserVersion:undefined)&&n.SessionInformation.WdParams.wdBrowserCompatible})),n.SessionInformation.WdParams&&n.SessionInformation.WdParams.wdIsFileTypeSupportedForModernSlideShow==null&&(n.SessionInformation.WdParams=__assign(__assign({},n.SessionInformation.WdParams),{wdIsFileTypeSupportedForModernSlideShow:this.isFileTypeSupportedForModernSlideShow(n.WopiPrecheckInfo.FileName,t,i?i.ModernSlideShowAllowListForFileType:undefined)})),o=window.location.search.indexOf("wdForceModernSlideShowInTeams")>=0||n.SessionInformation&&n.SessionInformation.WdParams&&n.SessionInformation.WdParams.wdForceModernSlideShowInTeams,o)return t&&t.ULS.traceTag(556615647,logCategory.PptSession,logLevel.Info,"modern slideshow forced from wdparam or from Teams client"),r;t&&this.s_logModernCompatibility&&(BrowserUtils.isBrowserSupportedForModernSlideShow(t,i?i.ModernSlideShowBlockListForOS:undefined,i?i.ModernWebGLBlockListForBrowserVersion:undefined),BrowserUtils.isBrowserShapeBuilderCompatible({},t,i?i.ModernWebGLBlockListForBrowserVersion:undefined),this.isFileTypeSupportedForModernSlideShow(n.WopiPrecheckInfo.FileName,t,i?i.ModernSlideShowAllowListForFileType:undefined),this.s_logModernCompatibility=!1);var u=n.SessionInformation.WdParams&&(n.SessionInformation.WdParams.wdBrowserShapeBuilderCompatible||n.SessionInformation.WdParams.wdBrowserCompatible)&&n.SessionInformation.WdParams.wdIsFileTypeSupportedForModernSlideShow,s=n.SessionInformation&&n.SessionInformation.IsPresenter&&i.EnableModernSlideShowForPresenter,h=n.SessionInformation&&n.SessionInformation.UiHostIsHighContrast&&i.EnableModernSlideShowForHighContrast;if(u?s?h||(this.s_fallbackReason="NotUseModernForHighContrast"):this.s_fallbackReason="NotUseModernForPresenter":this.s_fallbackReason=n.SessionInformation.WdParams?n.SessionInformation.WdParams.wdIsFileTypeSupportedForModernSlideShow?"BrowserNotShapeBuilderCompatibleAndBlockedConfig":"FileTypeNotSupported":"SessionInfomationWdParamsMissing",u&&s)return t&&t.ULS.traceTag(573862238,logCategory.PptSession,logLevel.Info,"Always use Modern for Presenter"),r;if(u&&h)return t&&t.ULS.traceTag(573698710,logCategory.PptSession,logLevel.Info,"Always use Modern for HighContrast"),r;if(f=n.SessionInformation.HostName.toLowerCase()==="teamsandroid"||n.SessionInformation.HostName.toLowerCase()==="msteams"||n.SessionInformation.HostName.toLowerCase()==="teamsios"||n.SessionInformation.WdParams&&n.SessionInformation.WdParams.wdModernSlideShowInTeams,this.s_fallbackReason=!f&&this.s_fallbackReason===""?"ModernDisabled":this.s_fallbackReason,u&&f)return t&&t.ULS.traceTag(556615650,logCategory.PptSession,logLevel.Info,"Using modern slideshow for compatible client and is enabled from Teams client for rings"),r}catch(c){t&&t.ULS.traceTag(573862240,logCategory.PptSession,logLevel.Warning,"Exception in getSlideShowKind. "+c)}return(n.ApplicationUrl===null)?"StaticHtml":(t&&t.ULS.traceTag(556615651,logCategory.PptSession,logLevel.Info,"returning legacy. fallbackReason:"+this.s_fallbackReason),this.s_fallbackReason=this.s_fallbackReason===""?"MissingApplicationUrl":this.s_fallbackReason,e)},n.getSlideShowKindUpdatedVersion=function(n,t,i){var u,f,e,o,s,h,c,l,a,r=(f=(u=n.SessionInformation)===null||u===void 0?void 0:u.HostName)===null||f===void 0?void 0:f.toLowerCase(),b=["1","2","5"].indexOf(PodsRegionInfo.getPodsRing(n))>=0,p=b?r!=="participantapp":r==="msteams"||r==="teamsandroid"||r==="teamsios",k=p,w,v,y;try{if(t===null||t===void 0?void 0:t.ULS.traceTag(545275915,logCategory.PptSession,logLevel.Info,"pptFeatureGates - "+JSON.stringify(i)),i===null||i===void 0?void 0:i.ForceLegacySlideShow)return"Legacy";if(((e=n.SessionInformation.WdParams)===null||e===void 0?void 0:e.wdBrowserCompatible)||(n.SessionInformation.WdParams=__assign(__assign({},n.SessionInformation.WdParams),{wdBrowserCompatible:BrowserUtils.isBrowserSupportedForModernSlideShow(t,i===null||i===void 0?void 0:i.ModernSlideShowBlockListForOS,i===null||i===void 0?void 0:i.ModernSlideShowBlockListForBrowserVersion)})),((o=n.SessionInformation.WdParams)===null||o===void 0?void 0:o.wdBrowserShapeBuilderCompatible)||(n.SessionInformation.WdParams=__assign(__assign({},n.SessionInformation.WdParams),{wdBrowserShapeBuilderCompatible:BrowserUtils.isBrowserShapeBuilderCompatible({},t,i===null||i===void 0?void 0:i.ModernWebGLBlockListForBrowserVersion)&&n.SessionInformation.WdParams.wdBrowserCompatible})),((s=n.SessionInformation.WdParams)===null||s===void 0?void 0:s.wdIsFileTypeSupportedForModernSlideShow)||(n.SessionInformation.WdParams=__assign(__assign({},n.SessionInformation.WdParams),{wdIsFileTypeSupportedForModernSlideShow:this.isFileTypeSupportedForModernSlideShow(n.WopiPrecheckInfo.FileName,t,i===null||i===void 0?void 0:i.ModernSlideShowAllowListForFileType,k)})),w=window.location.search.indexOf("wdForceModernSlideShowInTeams")>=0||n.SessionInformation&&((h=n.SessionInformation.WdParams)===null||h===void 0?void 0:h.wdForceModernSlideShowInTeams),w)return t===null||t===void 0?void 0:t.ULS.traceTag(545275916,logCategory.PptSession,logLevel.Info,"modern slideshow forced from wdparam or from Teams client"),"Modern";if(t&&this.s_logModernCompatibility&&(BrowserUtils.isBrowserSupportedForModernSlideShow(t,i===null||i===void 0?void 0:i.ModernSlideShowBlockListForOS,i===null||i===void 0?void 0:i.ModernWebGLBlockListForBrowserVersion),BrowserUtils.isBrowserShapeBuilderCompatible({},t,i===null||i===void 0?void 0:i.ModernWebGLBlockListForBrowserVersion),this.isFileTypeSupportedForModernSlideShow(n.WopiPrecheckInfo.FileName,t,i===null||i===void 0?void 0:i.ModernSlideShowAllowListForFileType),this.s_logModernCompatibility=!1),v=(((c=n.SessionInformation.WdParams)===null||c===void 0?void 0:c.wdBrowserShapeBuilderCompatible)||((l=n.SessionInformation.WdParams)===null||l===void 0?void 0:l.wdBrowserCompatible))&&((a=n.SessionInformation.WdParams)===null||a===void 0?void 0:a.wdIsFileTypeSupportedForModernSlideShow),v||(this.s_fallbackReason=n.SessionInformation.WdParams?n.SessionInformation.WdParams.wdIsFileTypeSupportedForModernSlideShow?"BrowserNotShapeBuilderCompatibleAndBlockedConfig":"FileTypeNotSupported":"SessionInfomationWdParamsMissing"),y=p||n.SessionInformation.WdParams&&n.SessionInformation.WdParams.wdModernSlideShowInTeams,this.s_fallbackReason=!y&&this.s_fallbackReason===""?"ModernDisabled":this.s_fallbackReason,v&&y)return t===null||t===void 0?void 0:t.ULS.traceTag(545275918,logCategory.PptSession,logLevel.Info,"Using modern slideshow for compatible client and is enabled from Teams client for rings"),"Modern"}catch(d){t===null||t===void 0?void 0:t.ULS.traceTag(545275919,logCategory.PptSession,logLevel.Warning,"Exception in getSlideShowKind. "+d)}return(n.ApplicationUrl===null)?"StaticHtml":(t===null||t===void 0?void 0:t.ULS.traceTag(545275920,logCategory.PptSession,logLevel.Info,"returning legacy. fallbackReason:"+this.s_fallbackReason),this.s_fallbackReason=this.s_fallbackReason===""?"MissingApplicationUrl":this.s_fallbackReason,"Legacy")},n.getSlideShowHostContainer=function(n){var t,i;return((i=(t=n===null||n===void 0?void 0:n.SessionInformation)===null||t===void 0?void 0:t.WdParams)===null||i===void 0?void 0:i.enablePptSharingWebviewContainer)&&n.WebviewRef?"Webview":"Iframe"},n.getFallbackReason=function(){return this.s_fallbackReason},n.isFileTypeSupportedForModernSlideShow=function(n,t,i,r){var e=this.getFileExtension(n),u,f;if(r)return!0;i||(i="pptx;ppsx;potx;pptm;ppsm;potm",t&&t.ULS.traceTag(558438469,logCategory.PptSession,logLevel.Info,"isFileTypeSupportedForModernSlideShow FeatureGate modernSlideShowAllowListForFileType is undefined. Setting to default value: "+i));u=i.split(";");for(f in u)if(u[f].toLowerCase()==e.toLowerCase())return!0;return!1},n.isFileTypeSupportedForLegacySlideShow=function(n,t){var i=this.getFileExtension(n),r="pptx;ppsx;potx;pptm;ppsm;potm;ppt;pps;pot".split(";");for(var u in r)if(r[u].toLowerCase()==i.toLowerCase())return t&&t.ULS.traceTag(556282498,logCategory.PptSession,logLevel.Info,"File has a valid ppt extension. Supported by Legacy SS: "+i),!0;return t&&t.ULS.traceTag(556282499,logCategory.PptSession,logLevel.Error,"File doesnt have a valid ppt extension. Supported by Legacy SS: "+i),!1},n.getFileExtension=function(n){var t;return n&&(t=n.split("."),t&&t.length>1)?t[t.length-1].toLowerCase():""},n.isSupportedFileExtension=function(n){for(var r,t=0,i=["odp","pot","potm","potx","pps","ppsm","ppsx","ppt","pptm","pptx"];t<i.length;t++)if(r=i[t],r.toLowerCase()==n.toLowerCase())return!0;return!1},n.isBinaryFile=function(n,t){var i=this.getFileExtension(n),r="ppt;pps;pot;odp".split(";");for(var u in r)if(r[u].toLowerCase()==i.toLowerCase())return t&&t.ULS.traceTag(545887873,logCategory.PptSession,logLevel.Info,"File extension is binary : "+i),!0;return!1},n.sendInitialLog=function(n,t,i,r){var f,l,u,o,v,e,h,a,s,c;this.s_bootstrapperInstanceIdentifier===""&&(this.s_bootstrapperInstanceIdentifier=this.generateRandomUUID());f={};f.BootstrapperType="TypeScript";f.Preview=t==="Previewer"?!0:!1;f.Scenario=t;f.ApplicationUrl=this.extractHostname(n.ApplicationUrl);f.IsDeepLink=!!UrlUtils.getQueryStringParam("nav");f.BootstrapperInstanceId=this.s_bootstrapperInstanceIdentifier;l={};f.ApplicationCustomSettings=l;n.ApplicationCustomSettings&&(l.OnDemandServer=this.extractHostname(n.ApplicationCustomSettings.OnDemandServer),l.EnableWacFallback=n.ApplicationCustomSettings.EnableWacFallback);u={};f.SessionInformation=u;u.HostName=n.SessionInformation.HostName;u.HostSessionId=n.SessionInformation.HostSessionId;u.UiLocale=n.SessionInformation.UiLocale;u.DataLocale=n.SessionInformation.DataLocale;n.Diagnostics&&n.Diagnostics.userClickTime?u.DocumentClickTime=n.Diagnostics.userClickTime:n.SessionInformation&&n.SessionInformation.DocumentClickTime&&(u.DocumentClickTime=n.SessionInformation.DocumentClickTime.getTime());u.HostInitTime=n.SessionInformation.HostInitTime;u.CurrentTime=(new Date).getTime();u.ParticipantId=n.SessionInformation.ParticipantId;u.CallId=n.SessionInformation.CallId;u.TenantId=n.SessionInformation.TenantId;u.ContentId=n.SessionInformation.ContentId;u.EndpointId=n.SessionInformation.EndpointId;u.IsPresenter=n.SessionInformation.IsPresenter;u.UiHost=PodsRegionInfo.getUiHost(n.SessionInformation.HostName);u.UiHostRing=n.SessionInformation.UiHostRing;u.UiHostIsHighContrast=n.SessionInformation.UiHostIsHighContrast;u.UiHostHighContrastColorSettings=n.SessionInformation.UiHostHighContrastColorSettings;u.PreviewerPosition=n.SessionInformation.Position;u.WdParams=n.SessionInformation.WdParams;u.HostExperience=n.SessionInformation.HostExperience;u.SlideShowKind=this.getSlideShowKind(n,r);u.BrowserTechnology=this.getBrowserTechnology(n,r);u.ForceModernSlideShowInTeamsQueryParam=window.location.search.indexOf("wdForceModernSlideShowInTeams")>=0;u.IsRetry=n.SessionInformation&&n.SessionInformation.IsRetry?n.SessionInformation.IsRetry:!1;u.PreviousSessionErrorName=n.SessionInformation&&n.SessionInformation.PreviousSessionErrorName?n.SessionInformation.PreviousSessionErrorName:"";u.PreviousHostSessionId=n.SessionInformation&&n.SessionInformation.PreviousHostSessionId?n.SessionInformation.PreviousHostSessionId:"";u.StateServiceFeatures=n.SessionInformation.EnableStateServiceInPreviewerFeatures;u.TeamsBuildVersion=n.SessionInformation.TeamsBuildVersion;u.IsTestSession=n.SessionInformation.IsTest;u.DeviceMetadata=n.SessionInformation.DeviceMetadata;o={};f.Diagnostics=o;v=this.getEntryPoint(n);o.EntryPoint=v;o.FileHost=PodsRegionInfo.getFileHost(n);o.PodsRing=n.ApplicationUrl?PodsRegionInfo.getPodsRing(n):"";o.PresentationUrlEnabled=this.getPresentationUrlFlag(n,r);e={};f.WopiPrecheckInfo=e;e.FileSize=n.WopiPrecheckInfo.FileSize;e.FileGetUrlBool=!!n.WopiPrecheckInfo.FileGetUrl;e.CustomFontCatalogUrlBool=!!n.WopiPrecheckInfo.CustomFontCatalogUrl;e.FileNameBool=!!n.WopiPrecheckInfo.FileName;e.ReadOnly=n.WopiPrecheckInfo.ReadOnly;e.IrmEnabled=n.WopiPrecheckInfo.IrmEnabled;e.SupportsDecryptedContentDownload=n.WopiPrecheckInfo.SupportsDecryptedContentDownload;e.ViewOnly=n.WopiPrecheckInfo.ViewOnly;e.PreseededSessionKey=!!n.WopiPrecheckInfo.PreseededSessionKey;!n.WopiPrecheckInfo.FileName||(e.FileExtension=this.getFileExtension(n.WopiPrecheckInfo.FileName));h={};n.WopiPrecheckInfo.BundleInfo&&(a=n.WopiPrecheckInfo.BundleInfo,h.MajorVersion=a.MajorVersion,h.URLBool=!!a.Url,h.CrossOrigin=a.CrossOrigin);e.BundleInfo=h;s={};f.AppInfo=s;c=PPTBootstrapSettings.getAppMetadata();c&&(s.AppVersionMajor=c.AppVersionMajor,s.AppVersionMinor=c.AppVersionMinor,s.Environment=c.Environment);s.UserAgent=window.navigator.userAgent;i&&(f.AdditionalTelemetry=i);r.ULS.traceTag(22357763,logCategory.PptSession,logLevel.Info,JSON.stringify(f,this.undefinedReplacer))},n.undefinedReplacer=function(n,t){return typeof t=="undefined"?null:t},n.shouldUsePresentationUrlHandler=function(n,t){return window.location.search.indexOf("wdPresentationUrlFlowEnabled")>=0?(t&&t.ULS.traceTag(557417435,logCategory.PptSession,logLevel.Info,"wdPresentationUrlFlowEnabled is set, hence using presentation url boot flow"),!0):n.SessionInformation.IsPresenter&&n.Diagnostics&&n.Diagnostics.presentationUrlFlag?(t&&t.ULS.traceTag(557417436,logCategory.PptSession,logLevel.Info,"PresentationUrl flag is true for presenter, hence using presentation url boot flow"),!0):!1},n.getPresentationUrlFlag=function(n,t){if(window.location.search.indexOf("wdPresentationUrlFlowEnabled")>=0||n.Diagnostics&&n.Diagnostics.presentationUrlFlag===!0)return!0;var i=PPTBootstrapperFeatureGatesHelper.getStateServiceFeatureGates(n,t)||[];return i.indexOf("PresUrlBoot")>-1?!0:!1},n.podsFlighting=function(n,t){var i=PodsRegionInfo.tryGetPodsRegion(n.ApplicationUrl,n,!1);return i?window.location.search.indexOf("wdTestPreviewer=1")>=0||window.location.hash.indexOf("wdTestPreviewer=1")>=0?createUsePODSDetails(!0,!0,"Supported Region and wdTestPreviewer/wdTestUnified set to true in Host Page URL"):createUsePODSDetails(!0,!0,"Supported Region"):(t.ULS.traceTag(589168768,logCategory.PptSession,logLevel.Info,"Wac region not currently supported by PODS"),createUsePODSDetails(!1,!1,"Wac region not currently supported by PODS"))},n.launchWacFallback=function(n,t,i,r,u,f,e){var c,s,h,l,a,p,y,v;u.ULS.traceTag(38147724,logCategory.PptSession,logLevel.Info,"Launching Wac Fallback");var o=document.createElement("iframe");o.frameBorder="0";o.style.top=HTMLHelper.toPx(0);o.style.bottom=HTMLHelper.toPx(0);o.style.left=HTMLHelper.toPx(0);o.style.right=HTMLHelper.toPx(0);o.style.height=HTMLHelper.floatToPercent(1);o.style.width=HTMLHelper.floatToPercent(1);o.style.minWidth=HTMLHelper.toPx(300);o.style.minHeight=HTMLHelper.toPx(200);o.style.position="absolute";o.setAttribute("allowfullscreen",(!0).toString());o.setAttribute("allowTransparency",(!0).toString());o.id="WebApplicationFrame";o.title="Office Online Frame";o.name="wac_frame";c=HTMLHelper.floatToPercent(1);t.Container.style.width=c;t.Container.style.height=c;t.Container.style.minHeight=HTMLHelper.toPx(150);t.Container.style.left=HTMLHelper.toPx(0);t.Container.style.right=HTMLHelper.toPx(0);t.Container.style.bottom=HTMLHelper.toPx(0);t.Container.style.top=HTMLHelper.toPx(0);s=document.createElement("div");s.style.backgroundColor="#393a3d";s.style.backfaceVisibility="hidden";s.style.width=c;s.style.height=c;s.style.minHeight=HTMLHelper.toPx(150);s.style.left=HTMLHelper.toPx(0);s.style.right=HTMLHelper.toPx(0);s.style.bottom=HTMLHelper.toPx(0);s.style.top=HTMLHelper.toPx(0);o.style.width=c;o.style.minHeight=HTMLHelper.toPx(150);o.style.height=c;h=document.createElement("form");h.name="wac_form";h.id="wac_form";h.target="wac_frame";h.action=i(n,t);h.method="post";l=document.createElement("input");l.type="hidden";l.name="access_token";l.value=n.AccessToken;h.appendChild(l);a=document.createElement("input");a.type="hidden";a.name="access_token_ttl";a.value=!n.AccessTokenExpiry?"0":n.AccessTokenExpiry.getTime().toString();h.appendChild(a);t.Container.appendChild(h);t.Container.appendChild(s);s.appendChild(o);h.submit();p=r&&r.Code===5308440?"CannotLoadBundleItem":"FatalError";y={errorObject:{errorType:p,errorObject:r}};f.stop();v=f.getVisibilityChangeEvents();v&&v.length>0&&(y.documentLoadedWithTabSwitch=!0,u.ULS.traceTag(38147725,logCategory.PptSession,logLevel.Info,"Visibility Change Events:"+JSON.stringify(v)));t.FnOnInitializeSuccess(new PPTDisabledApplication(e),y)},n.extractHostname=function(n){return n?n.indexOf("://")>-1?n.split("/")[2]:n.split("/")[0]:null},n.getEntryPoint=function(n){if(!n.ApplicationUrl)return null;var t=UrlUtils.getParameterValueDecoded(n.ApplicationUrl,"wdOrigin");return t?t:n.Diagnostics&&n.Diagnostics.entryPoint?n.Diagnostics.entryPoint:null},n.findBootstrapperPerfEntry=function(n,t,i){var r,u;if(n)for(r=0;r<n.length;r+=1)if(u=n[r],u.name.indexOf(t)>=0)return u.name.toLowerCase()!==t.toLowerCase()&&i.ULS.traceTag(38147726,logCategory.PptSession,logLevel.Info,"Found partial match for bootstrapper URL perf entry"),u;return null},n.logBootstrapperPerformanceInfo=function(n,t,i){var e,f,r,u;if(i)try{if(e="https://contentstorage.osi.office.net/boot/ppt.boot.js",f=n||e,n||i.ULS.traceTag(38147727,logCategory.PptSession,logLevel.Info,"Missing BootstrapperUrl, defaulting to "+e),!window.performance){i.ULS.traceTag(38147728,logCategory.PptSession,logLevel.Info,"Performance API not found on browser");return}if(r=undefined,window.performance.getEntriesByName&&(r=this.findBootstrapperPerfEntry(window.performance.getEntriesByName(f),f,i)),!r&&window.performance.getEntries&&(i.ULS.traceTag(38147729,logCategory.PptSession,logLevel.Info,"Searching all entries for bootstrapper timing entry."),r=this.findBootstrapperPerfEntry(window.performance.getEntries(),f,i)),!r){i.ULS.traceTag(38147730,logCategory.PptSession,logLevel.Info,"Unable to extract Bootstrapper perf info.");return}u={};u.name=f;u.logReason=t;u.nameMatchesExpected=r.name===f;u.connectEnd=r.connectEnd;u.connectStart=r.connectStart;u.domainLookupEnd=r.domainLookupEnd;u.domainLookupStart=r.domainLookupStart;u.fetchStart=r.fetchStart;u.initiatorType=r.initiatorType;u.redirectEnd=r.redirectEnd;u.redirectStart=r.redirectStart;u.requestStart=r.requestStart;u.responseEnd=r.responseEnd;u.responseStart=r.responseStart;u.duration=r.duration;u.entryType=r.entryType;u.startTime=r.startTime;u.nextHopProtocol=r.nextHopProtocol;u.workerStart=r.workerStart;u.secureConnectionStart=r.secureConnectionStart;u.transferSize=r.transferSize;u.encodedBodySize=r.encodedBodySize;u.decodedBodySize=r.decodedBodySize;i.ULS.traceTag(34928845,logCategory.PptSession,logLevel.Info,JSON.stringify(u))}catch(o){i.ULS.traceTag(38147731,logCategory.PptSession,logLevel.Warning,"Exception extracting Bootstrapper perf info. "+o)}},n.getPostMessageToken=function(n){return!n||n.toLowerCase().indexOf("#")>-1?Math.random().toString(36).substring(2,25):n},n.appendCommonFrameUrlQueryParams=function(n,t){var i=n,o=this.getUI(t),r,u,f,e,s;return o&&(i=UrlUtils.addOrReplaceParameterValue(i,"ui",o)),r=this.getDataLocale(t),r&&(i=UrlUtils.addOrReplaceParameterValue(i,"rs",r)),u=UrlUtils.getParameterValue(t.ApplicationUrl,"mscc"),u&&(i=UrlUtils.addOrReplaceParameterValue(i,"mscc",u)),f=UrlUtils.getParameterValue(t.ApplicationUrl,"wdFR"),f&&(i=UrlUtils.addOrReplaceParameterValue(i,"wdFR",f)),e=this.getEntryPoint(t),e&&(i=UrlUtils.addOrReplaceParameterValue(i,"wdOrigin",UrlUtils.urlKeyValueEncode(e))),s=this.getPostMessageToken(t.PostMessageToken),t.PostMessageToken&&(i+="&postMessageToken="+s),(t.SessionInformation.DisableChat||t.ApplicationUrl.toLowerCase().indexOf("dchat=1")>-1)&&(i=UrlUtils.addOrReplaceParameterValue(i,"dchat","1")),UrlOverrideUtils.forwardMissingWdParamsFromApplicationUrl(i,t.ApplicationUrl)},n.getUI=function(n){return n.SessionInformation.UiLocale?n.SessionInformation.UiLocale:UrlUtils.getParameterValueDecoded(n.ApplicationUrl,"ui")},n.getDataLocale=function(n){return n.SessionInformation.DataLocale?n.SessionInformation.DataLocale:UrlUtils.getParameterValueDecoded(n.ApplicationUrl,"rs")},n.s_bootstrapperInstanceIdentifier="",n.s_logModernCompatibility=!0,n.s_fallbackReason="",n}(),PPTBootstrapperFeatureGatesHelper=function(){function n(){}return n.getFeatureGates=function(n,t){var i;try{return i="{}",n&&n.SessionInformation&&n.SessionInformation.PptFeatureGates&&(i=decodeURIComponent(n.SessionInformation.PptFeatureGates).replace(/\u200B/g,"")),JSON.parse(i)}catch(r){return t&&t.ULS.traceTag(578933140,logCategory.PptSession,logLevel.Warning,"Exception parsing ppt feature gates: "+JSON.stringify(r)),{}}},n.getStateServiceFeatureGates=function(n,t){if(n&&n.SessionInformation&&n.SessionInformation.EnableStateServiceInPreviewerFeatures)try{var r=typeof n.SessionInformation.EnableStateServiceInPreviewerFeatures=="string"?JSON.parse(n.SessionInformation.EnableStateServiceInPreviewerFeatures):n.SessionInformation.EnableStateServiceInPreviewerFeatures,i=r.filter(function(n){return n&&n.length!=0});return i.length===0?undefined:i}catch(u){t.ULS.traceTag(546169615,logCategory.PptSession,logLevel.Warning,"Exception parsing state service feature gates: "+JSON.stringify(u))}return undefined},n}(),PPTBootstrapperLogger=function(){function n(){}return n.recordBootstrapperTimeoutFailure=function(n,t,i,r,u,f,e,o){if(!this.isBootSuccess(t,i,r)){var s={AppMetadata:this.getAppMetadata(n,PPTBootstrapSettings.getAppMetadata(),u),BootInfo:this.getBootInfo(n,u,f,!1,o),BundleMetadata:"[]",FatalErrors:this.getFatalErrorInfo(t,i,r),NonFatalErrors:e,WopiPrecheckInfo:this.getWopiPrecheckInfo(n)};u.ULS.traceTag(592007955,logCategory.PptSession,logLevel.Error,JSON.stringify(s))}},n.recordBootCompleted=function(n,t,i,r,u,f,e,o,s){var h={AppMetadata:this.getAppMetadata(n,PPTBootstrapSettings.getAppMetadata(),u),BootInfo:this.getBootInfo(n,u,f,this.isBootSuccess(t,i,r),s),BundleMetadata:"[]",FatalErrors:this.getFatalErrorInfo(t,i,r),NonFatalErrors:e,WopiPrecheckInfo:this.getWopiPrecheckInfo(n),AppBootTimings:o?o.appBootTimingDict:""};u.ULS.traceTag(587843200,logCategory.PptSession,logLevel.Info,JSON.stringify(h));this.recordNetworkLatency(u)},n.getWopiPrecheckInfo=function(n){return n&&n.WopiPrecheckInfo?{FileGetUrlBool:n.WopiPrecheckInfo.FileGetUrl?!0:!1,CustomFontCatalogUrlBool:n.WopiPrecheckInfo.CustomFontCatalogUrl?!0:!1,FileNameBool:n.WopiPrecheckInfo.FileName?!0:!1,ReadOnly:n.WopiPrecheckInfo.ReadOnly,SupportsDecryptedContentDownload:n.WopiPrecheckInfo.SupportsDecryptedContentDownload,ViewOnly:n.WopiPrecheckInfo.ViewOnly,PreseededSessionKey:n.WopiPrecheckInfo.PreseededSessionKey,BundleInfo:this.getBundleInfo(n.WopiPrecheckInfo.BundleInfo),FileExtFromHost:PPTBootstrapper.getFileExtension(n.WopiPrecheckInfo.FileName)}:""},n.getBundleInfo=function(n){if(n){var t=n;return{MajorVersion:t.MajorVersion,URLBool:t.Url,CrossOrigin:t.CrossOrigin}}return""},n.getAppMetadata=function(n,t,i){return n?{BrowserTechnology:PPTBootstrapper.getBrowserTechnology(n,i),FileSizeHint:n.WopiPrecheckInfo.FileSize,ApiStartTime:0,HostInitTime:n.SessionInformation.HostInitTime,AppVersion:t.AppVersionMajor+"."+t.AppVersionMinor,ViewerMode:n.ApplicationCustomSettings&&n.ApplicationCustomSettings.ViewerMode?n.ApplicationCustomSettings.ViewerMode:0,EntryPoint:PPTBootstrapper.getEntryPoint(n),SessionId:n.SessionInformation.HostSessionId,UserAgent:window.navigator.userAgent,ApplicationUrl:n.ApplicationUrl,WACRegion:PodsRegionInfo.getWACRegion(n.ApplicationUrl),FileHost:PodsRegionInfo.getFileHost(n),Host:n.SessionInformation.HostName,PodsRing:n.ApplicationUrl?PodsRegionInfo.getPodsRing(n):"",UiHost:PodsRegionInfo.getUiHost(n.SessionInformation.HostName),UiHostRing:n.SessionInformation.UiHostRing,UiHostIsHighContrast:n.SessionInformation.UiHostIsHighContrast,CallId:n.SessionInformation.CallId,ContentId:n.SessionInformation.ContentId,HostContainer:PPTBootstrapper.getSlideShowHostContainer(n),SlideShowKind:PPTBootstrapper.getSlideShowKind(n,i),HostWindowVersion:this.getHostWindowVersion(n),HostPlatformId:this.getHostPlatformId(n),IsTestSession:n.SessionInformation.IsTest,FallbackReason:PPTBootstrapper.getFallbackReason(),HostExperience:n.SessionInformation.HostExperience,ParticipantId:n.SessionInformation.ParticipantId,EndpointId:n.SessionInformation.EndpointId,HostSessionId:n.HostSessionId,isRetry:n.SessionInformation.IsRetry,previousSessionErrorName:n.SessionInformation.PreviousSessionErrorName,PreviousHostSessionId:n.SessionInformation.PreviousHostSessionId?n.SessionInformation.PreviousHostSessionId:"",IsPresenter:n.SessionInformation.IsPresenter,CDNHost:PPTBootstrapper.getStaticResourcesServerHostName(n,i),CDNVersion:t.WacCdnVersion,SnapServiceUrl:PPTBootstrapper.getUrlDomain(n.SessionInformation.SnapUrl,i),UseSnapService:n.SessionInformation.UseSnapService,UsingSnapServiceAttendee:PPTBootstrapper.getUrlDomain(n.WopiPrecheckInfo.PresentationUrl,i),TeamsBuildVersion:n.SessionInformation.TeamsBuildVersion,DeviceMetadata:n.SessionInformation.DeviceMetadata}:""},n.getHostWindowVersion=function(n){var t=n.SessionInformation.TeamsBuildVersion;return t?t.substring(t.indexOf("/")+1):""},n.getHostPlatformId=function(n){var t=n.SessionInformation.TeamsBuildVersion,i;return t?(i=t.indexOf("/"),i>0?t.substring(0,i):""):""},n.getFatalErrorInfo=function(n,t,i){return this.isBootSuccess(n,t,i)?"":{ErrorCategory:"fatal",ExtraInfo:"",CorrelationId:"",ErrorCode:n,ErrorName:t,Message:i}},n.getBootInfo=function(n,t,i,r,u){var f=0;return n.SessionInformation.DocumentClickTime!=null&&n.SessionInformation.DocumentClickTime.getTime&&(f=n.SessionInformation.DocumentClickTime.getTime()),{PreloadCompleteTime:0,DocumentClickTime:f,BootSuccess:r,BootTime:i,BootMode:"",PresentationUrlEnabled:PPTBootstrapper.getPresentationUrlFlag(n,t),BootStageInfo:u&&u.length>0?u:""}},n.isBootSuccess=function(n,t,i){return n==null&&t==null&&i==null},n.recordNetworkLatency=function(n){var t,i,r;try{window.navigator&&(t=window.navigator.connection,t&&(i=t.effectiveType,r=t.downlink,n.ULS.traceTag(562368730,logCategory.PptSession,logLevel.Info,'{"networkType": '+i+', "bandwidth": '+r+"}")))}catch(u){n.ULS.traceTag(562368731,logCategory.PptSession,logLevel.Info,"Exception trying to fetch netowrk speed: "+u)}},n.initializeHealthLogger=function(n,t,i){try{var r=this.getAppMetadata(n,PPTBootstrapSettings.getAppMetadata(),i),f=n.ApplicationCustomSettings&&(n.ApplicationCustomSettings.UiType==="embed"||n.ApplicationCustomSettings.UiType==="reading"),e=f?"VIEWINGAPP":r.SlideShowKind=="Modern"?"SLIDESHOWAPP":"PREVIEWER",o={application:"PowerPoint",applicationMode:"Slideshow",applicationModeExtended:e,browser:r.Browser,clientVersion:BuildVersionConfig.BUILD_NUMBER,host:r.FileHost,loggableUserId:this.getLoggableUserId(n.SessionInformation.UserId),ring:r.PodsRing,serverDocId:n.WopiPrecheckInfo.DocUniqueId,session_id:n.SessionInformation.HostSessionId,tenantId:n.SessionInformation.TenantId,uiHost:r.Host},u=healthSmall.Health.getInstance();return u.initialize({isHealthEnabled:!0,isOfflineEnabled:!1,telemetryUrl:t+"/RemoteTelemetry.ashx",dimensions:o}),u.addOrUpdatePartCDimension("component","bootstrapper"),u.addOrUpdatePartCDimension("uiHostRing",r.UiHostRing),u.addOrUpdatePartCDimension("TeamsCallId",r.CallId),u.addOrUpdatePartCDimension("HostExperience",r.HostExperience),u.addOrUpdatePartCDimension("FileSizeBytes",r.FileSizeHint),u.addOrUpdatePartCDimension("ContentId",r.ContentId),u.addOrUpdatePartCDimension("ParticipantId",r.ParticipantId),u.addOrUpdatePartCDimension("EndpointId",r.EndpointId),u.addOrUpdatePartCDimension("StartAsPresenter",r.IsPresenter),u.addOrUpdatePartCDimension("IsRetrySession",r.isRetry),u.addQosPillar("Open"),u}catch(s){return i&&i.ULS.traceTag(556097945,logCategory.PptSession,logLevel.Error,"Failed to initialize HealthLogger. err: {0}"+JSON.stringify(s)),undefined}},n.getLoggableUserId=function(n){if(!n)return n;var t=n;return t.indexOf("urn%3aspo%3")>-1?t="":t.toLowerCase().indexOf("8:orgid:")==0&&(t=t.substring(8,t.length)),t},n}(),PPTDisabledApplication=function(){function n(n){this.m_sessionId=n}return n.prototype.GetApplicationType=function(){return"PowerPoint"},n.prototype.GetVersion=function(){return BuildVersionConfig.BUILD_NUMBER},n.prototype.GetSessionId=function(){return this.m_sessionId},n.prototype.RegisterEventHandler=function(){},n.prototype.RemoveEventHandler=function(){},n.prototype.RegisterErrorHandler=function(){},n.prototype.RemoveErrorHandler=function(){},n.prototype.AddEventHandler=function(){},n.prototype.dispose=function(){},n.prototype.Dispose=function(){},n.prototype.GetIsDisabled=function(){return!0},n.prototype.GetPercievedBoot=function(){return null},n.prototype.UsingCached=function(){return!1},n.prototype.GetCurrentSlideDimensions=function(){},n.prototype.GetSlidesInShowCount=function(){},n.prototype.GetTimeLineInfos=function(){},n.prototype.GetCurrentPosition=function(){},n.prototype.GetId=function(){},n.prototype.Next=function(){},n.prototype.PausePresentation=function(){},n.prototype.PlayPresentation=function(){},n.prototype.GetPresentationPlaybackState=function(){},n.prototype.NextSlide=function(){},n.prototype.Prev=function(){},n.prototype.PrevSlide=function(){},n.prototype.GoToNextSlide=function(){},n.prototype.GoToPrevSlide=function(){},n.prototype.GoToSlide=function(){},n.prototype.GoToSlideId=function(){},n.prototype.DisplayBlackSlide=function(){},n.prototype.DisplayWhiteSlide=function(){},n.prototype.Popout=function(){},n.prototype.PlayMedia=function(){},n.prototype.PauseMedia=function(){},n.prototype.RestoreFocus=function(){},n.prototype.StopMedia=function(){},n.prototype.SeekMedia=function(){},n.prototype.GetCurrentMediaStates=function(){},n.prototype.SetNavigationOptions=function(){},n}(),PPTMessageListenerRegistry=function(){function n(){this.m_apiRegistry={};window.addEventListener("message",this.onMessage)}return n.getInstance=function(){return this.s_singleton||(this.s_singleton=new n),this.s_singleton},n.prototype.add=function(n,t,i,r){r===void 0&&(r="");this.m_apiRegistry[n]=t;i&&this.sendLogToAllListeners("Add to Message Registry: "+n+", Reason: "+r,this.getLoggableDataFromMessageListenerRegistry())},n.prototype.get=function(n){return this.m_apiRegistry[n]},n.prototype.remove=function(n,t,i){i===void 0&&(i="");this.m_apiRegistry[n]=null;t&&this.sendLogToAllListeners("Remove from Message Registry: "+n+", Reason: "+i,this.getLoggableDataFromMessageListenerRegistry())},n.prototype.setSliceLoaded=function(){var t,n;for(t in this.m_apiRegistry)n=this.m_apiRegistry[t],n&&n.onSliceLoaded()},n.prototype.sendLogToAllListeners=function(n,t){var r,i;for(r in this.m_apiRegistry)i=this.m_apiRegistry[r],i&&i.log(n,t)},n.prototype.getLoggableDataFromMessageListenerRegistry=function(){var i={},n,t;for(n in this.m_apiRegistry)t=this.m_apiRegistry[n],i[n]=t?t.hasOwnProperty("c_activated")?"PreviewSessionLoader":"PreviewSessionManagerV0":"API is Null";return JSON.stringify(i)},n.prototype.onMessage=function(t){var i,r,u,f;try{i=JSON.parse(t.data)}catch(e){i=null}if(i&&(r=i.m_id||i.Token,r)){if(u=n.getInstance(),f=u.get(r),!f){u.sendLogToAllListeners("Message received with no targetApi. Id: "+r.toString(),t.data);return}f.onMessage(i,t.source)}},n}();var SnapRegionInfo=function(){function n(){}return n.getWacToSnapPreviewerMap=function(){var t={};return t[PodsRegionInfo.ffcUrl]=this.ShouldRerouteEdogToProd?createSNAPRegion(this.https+"usc"+n.hostOSISnapService,"5",1):createSNAPRegion(this.https+"snap.edog.officeapps.live.com/","1",1),t[PodsRegionInfo.ppcUrl]=createSNAPRegion(this.https+"msit"+n.hostOSISnapService,"2",1),t[PodsRegionInfo.prodUrl]=createSNAPRegion(this.https+n.hostOSISnapService.substring(1),"5",1),t[PodsRegionInfo.uscUrl]=createSNAPRegion(this.https+"usc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.brcUrl]=createSNAPRegion(this.https+"brc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.eucUrl]=createSNAPRegion(this.https+"euc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.cacUrl]=createSNAPRegion(this.https+"canc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.ukcUrl]=createSNAPRegion(this.https+"ukc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.aucUrl]=createSNAPRegion(this.https+"ausc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.jpcUrl]=createSNAPRegion(this.https+"jpc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.incUrl]=createSNAPRegion(this.https+"inc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.krcUrl]=createSNAPRegion(this.https+"krc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.frcUrl]=createSNAPRegion(this.https+"frc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.sgcUrl]=createSNAPRegion(this.https+"sgc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.eurppcUrl]=createSNAPRegion(this.https+"euc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.usGovUrl]=createSNAPRegion(this.https+"snap.osi.office365.us/","6",1),t[PodsRegionInfo.gbcUrl]=createSNAPRegion(this.https+"snap.osi.office365.us/","6",1),t[PodsRegionInfo.usDoDUrl]=createSNAPRegion(this.https+"snap.osi.apps.mil/","6",1),t[PodsRegionInfo.gallatinUrl]=createSNAPRegion(this.https+"snap.officeapps.partner.office365.cn/","6",1),t[PodsRegionInfo.airGap08Url]=createSNAPRegion(this.https+"snap.osi.eaglex.ic.gov/","7"),t[PodsRegionInfo.airGap09Url]=createSNAPRegion(this.https+"snap.osi.microsoft.scloud/","7"),t.edog=createSNAPRegion(this.https+"snap.edog.officeapps.live.com/","1",1),t[PodsRegionInfo.intTestUrl]=createSNAPRegion(this.https+"test.snap.officeapps.live-int.com/","0",1),t[PodsRegionInfo.intDevUrl]=createSNAPRegion(this.https+"dev.snap.officeapps.live-int.com/","0",1),t[PodsRegionInfo.zacUrl]=createSNAPRegion(this.https+n.hostOSISnapService.substring(1),"5",1),t[PodsRegionInfo.zacUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.aecUrl]=createSNAPRegion(this.https+n.hostOSISnapService.substring(1),"5",1),t[PodsRegionInfo.aecUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.decUrl]=createSNAPRegion(this.https+"euc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.decUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.chcUrl]=createSNAPRegion(this.https+"euc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.chcUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.nocUrl]=createSNAPRegion(this.https+"euc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.nocUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.secUrl]=createSNAPRegion(this.https+"euc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.secUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.plcUrl]=createSNAPRegion(this.https+"euc"+n.hostOSISnapService,"5",1),t[PodsRegionInfo.plcUrl].IsGoLocalRoutedToPublic=!0,t},n.shouldRouteToEdog=function(n,t,i){return!t||!t.SessionInformation||i=="6"?!1:t.SessionInformation.UiHostRing&&this.TeamsRingsInEdog.indexOf(t.SessionInformation.UiHostRing.toLowerCase())>=0?!0:this.HostsWithFFInEdog.indexOf(t.SessionInformation.HostName)>=0&&n===PodsRegionInfo.ffcUrl?!0:!1},n.tryGetSnapRegion=function(n,t){var r=n.substring(0,n.indexOf("/p/")),i=this.WacToSnapPreviewerMap[r.toLowerCase()];return i&&this.shouldRouteToEdog(r.toLowerCase(),t,i.PreviewerRolloutRing)&&(i=this.WacToSnapPreviewerMap.edog),i},n.GetDefaultProdRegion=function(){return this.WacToSnapPreviewerMap[PodsRegionInfo.prodUrl]},n.getOnDemandSnapServer=function(t,i){var r,u,f;if(t&&(r=n.tryGetSnapRegion(t,i),r))return r.SnapURL;u=PPTBootstrapSettings.getAppMetadata();f=u?u.Environment:"";switch(f){case"wac":return t?t.substring(0,t.indexOf("PowerPointFrame.aspx")).replace("/p/","/"):"";default:return"https://localhost:8083/"}},n.getFlightingNumber=function(n){return n!=""?Math.abs(MathHelper.hash(n))/100%1:Math.random()},n.IsApplicationUrlUsGovRing=function(n){return n&&(n.SnapURL.indexOf("snap.osi.office365.us")!=-1||n.SnapURL.indexOf("snap.osi.apps.mil")!=-1)&&n.PreviewerRolloutRing=="6"},n.snapFlighting=function(t,i,r,u,f){var e,o;if(f===void 0&&(f=0),e=n.tryGetSnapRegion(t,r),window.location.search.indexOf("wdTestSnapService=1")>=0||window.location.hash.indexOf("wdTestSnapService=1")>=0)return createUseSnapDetails(!0,"Supported Region");if(e){if(f>0&&n.IsApplicationUrlUsGovRing(e)&&(u===null||u===void 0?void 0:u.ULS.traceTag(509125084,logCategory.PptSession,logLevel.Info,"Enabled snap region for gov RolloutPercentage - "+f),e.RolloutPercentage=f),e.RolloutPercentage<=0)return createUseSnapDetails(!1,"Snap region Disabled");if(o=this.getFlightingNumber(i),u!=null&&u.ULS.traceTag(540567040,logCategory.PptSession,logLevel.Info,"RolloutPercentage - "+e.RolloutPercentage+"; RolloutNumber - "+o),e.RolloutPercentage>=o)return createUseSnapDetails(!0,"Could use snap as evaluated rollout number is less than rollout percent")}return createUseSnapDetails(!1,"Not yet enabled Region")},n.ShouldRerouteEdogToProd=window.location.search.indexOf("wdTestPreviewerInEdog")>=0?!1:!0,n.HostsWithFFInEdog=["TeamsiOS","OneDrive"],n.TeamsRingsInEdog=["ring0","ring0_s"],n.https="https://",n.hostOSISnapService=".snap.officeapps.live.com/",n.WacToSnapPreviewerMap=n.getWacToSnapPreviewerMap(),n}(),SnapRegions=function(){function n(){}return n.aue="aue",n.ause="ause",n.brzs="brzs",n.canc="canc",n.cane="cane",n.cus="cus",n.eus="eus",n.eus2="eus2",n.frc="frc",n.inc="inc",n.ins="ins",n.inw="inw",n.jpe="jpe",n.jpw="jpw",n.krc="krc",n.krs="krs",n.ncus="ncus",n.neu="neu",n.scus="scus",n.sea="sea",n.uks="uks",n.ukw="ukw",n.wcus="wcus",n.weu="weu",n.wus="wus",n.wus2="wus2",n}(),PodsRegion=function(){function n(){}return n.aueRegion="aue-dc",n.auseRegion="ause-dc",n.brzsRegion="brzs-dc",n.cancRegion="canc-dc",n.caneRegion="cane-dc",n.cusRegion="cus-dc",n.eusRegion="eus-dc",n.eus2Region="eus2-dc",n.frcRegion="frc-dc",n.incRegion="inc-dc",n.insRegion="ins-dc",n.inwRegion="inw-dc",n.jpeRegion="jpe-dc",n.jpwRegion="jpw-dc",n.krcRegion="krc-dc",n.krsRegion="krs-dc",n.ncusRegion="ncus-dc",n.neuRegion="neu-dc",n.seaRegion="sea-dc",n.scusRegion="scus-dc",n.uksRegion="uks-dc",n.ukwRegion="ukw-dc",n.weuRegion="weu-dc",n.wcusRegion="wcus-dc",n.wusRegion="wus-dc",n.wus2Region="wus2-dc",n}(),SnapUrlToPodsRegion=function(){function n(){}return n.getSnapToPodsRegionMap=function(){var n={};return n[SnapRegions.aue]=PodsRegion.aueRegion,n[SnapRegions.ause]=PodsRegion.auseRegion,n[SnapRegions.brzs]=PodsRegion.brzsRegion,n[SnapRegions.cus]=PodsRegion.cusRegion,n[SnapRegions.canc]=PodsRegion.cancRegion,n[SnapRegions.cane]=PodsRegion.caneRegion,n[SnapRegions.eus]=PodsRegion.eusRegion,n[SnapRegions.eus2]=PodsRegion.eus2Region,n[SnapRegions.frc]=PodsRegion.frcRegion,n[SnapRegions.inc]=PodsRegion.incRegion,n[SnapRegions.ins]=PodsRegion.insRegion,n[SnapRegions.inw]=PodsRegion.inwRegion,n[SnapRegions.jpe]=PodsRegion.jpeRegion,n[SnapRegions.jpw]=PodsRegion.jpwRegion,n[SnapRegions.krc]=PodsRegion.krcRegion,n[SnapRegions.krs]=PodsRegion.krsRegion,n[SnapRegions.ncus]=PodsRegion.ncusRegion,n[SnapRegions.neu]=PodsRegion.neuRegion,n[SnapRegions.scus]=PodsRegion.scusRegion,n[SnapRegions.sea]=PodsRegion.seaRegion,n[SnapRegions.uks]=PodsRegion.uksRegion,n[SnapRegions.ukw]=PodsRegion.ukwRegion,n[SnapRegions.wcus]=PodsRegion.wcusRegion,n[SnapRegions.weu]=PodsRegion.weuRegion,n[SnapRegions.wus]=PodsRegion.wusRegion,n[SnapRegions.wus2]=PodsRegion.wus2Region,n},n.getSnapRegion=function(n){var t=n.hostname,i;return t==null?"":(t=t.toLowerCase(),t=t.replace("www.",""),i=t.split("-"),i[0])},n.tryGetPodsRegionSpecificUrl=function(t,i){var u,f,r;if(t===undefined||t.hostname.search(".snap.")==-1||t.hostname.search("localhost")>=0)return i&&i.ULS.traceTag(528868489,logCategory.PptSession,logLevel.Warning,"SnapUrlToPodsRegion:tryGetPodsRegionSpecificUrl snapUrl is not matching the condition."),"";if(u=t.hostname,u.lastIndexOf(n.hostOSIProdDomain)!=u.length-n.hostOSIProdDomain.length)return i===null||i===void 0?void 0:i.ULS.traceTag(508602052,logCategory.PptSession,logLevel.Info,"SnapUrlToPodsRegion:tryGetPodsRegionSpecificUrl is not implemented for domains that don't end in officeapps.live.com"),"";try{if(f=n.getSnapToPodsRegionMap(),r=n.getSnapRegion(t),r!="")return t.toString().indexOf("edog")>0?n.https+f[r]+n.hostOSIPodsServiceEdog:n.https+f[r]+n.hostOSIPodsService;i&&i.ULS.traceTag(528868490,logCategory.PptSession,logLevel.Info,"SnapUrlToPodsRegion:tryGetPodsRegionSpecificUrl snapRegion evaluated empty")}catch(e){i&&i.ULS.traceTag(528868491,logCategory.PptSession,logLevel.Error,"SnapUrlToPodsRegion:tryGetPodsRegionSpecificUrl failed with exception "+e)}return""},n.https="https://",n.hostOSIPodsService=".pods.officeapps.live.com/",n.hostOSIPodsServiceEdog=".pods.edog.officeapps.live.com/",n.hostOSIProdDomain=".officeapps.live.com",n}(),TimeoutClock=function(){function n(n,t,i){this.m_pausedTimeMs=0;this.m_resumedTimeMs=0;this.m_maxTimeoutDurationMs=i===null||i===void 0?void 0:i.maxTimeoutDurationMs;this.m_callback=n;this.m_timeoutMs=t;this.m_startTimeMs=Date.now();this.updateTimeout()}return n.prototype.pause=function(){this.isPaused||(this.m_pausedTimeMs=Date.now(),this.updateTimeout())},n.prototype.resume=function(){this.isPaused&&(this.m_resumedTimeMs=Date.now(),this.m_timeoutMs+=this.m_resumedTimeMs-this.m_pausedTimeMs,this.updateTimeout())},n.prototype.addTime=function(n){this.m_timeoutMs+=n;this.updateTimeout()},n.prototype.abort=function(){window.clearTimeout(this.m_timeoutId);this.m_callback=function(){}},Object.defineProperty(n.prototype,"isPaused",{get:function(){return this.m_pausedTimeMs>this.m_resumedTimeMs},enumerable:!1,configurable:!0}),n.prototype.updateTimeout=function(){window.clearTimeout(this.m_timeoutId);var n=Math.min(this.m_maxTimeoutDurationMs||Number.POSITIVE_INFINITY,this.isPaused?Number.POSITIVE_INFINITY:this.m_timeoutMs);isFinite(n)&&(this.m_timeoutId=window.setTimeout(this.m_callback,n-(Date.now()-this.m_startTimeMs)))},n}(),TimeoutWrapper=function(){function n(n,t,i,r,u){var f=this,s,h,c,l,a,v,y,e,o,p,w;this.m_initialTicks=0;this.m_onSuccessTicks=0;this.m_onFailureTicks=0;this.m_onTimeoutTicks=0;this.m_fCallbackCalled=!1;this.m_scenario="";this.m_hostSessionId="";this.m_host="";this.errorCode=5;this.errorName="TimeoutInitialize";this.m_bootStageInfo=[];this.m_timeAddedMs=0;this.m_aborted=!1;this.m_callbackTimeoutError={errorType:"AppInitError",errorObject:"Timed out waiting for FnOnInitializeSuccess",Category:0,Code:this.errorCode,ErrorName:this.errorName,EventType:13,ExtraInfo:"Initialization timeout"};this.m_scenario=i;this.m_appErrors=r;this.m_bootStageInfo[0]={n:"Bootstrapper",s:Date.now()};n&&(this.m_featureGates=PPTBootstrapperFeatureGatesHelper.getFeatureGates(n,t),n.FnOnInitializeSuccess&&(v=n.FnOnInitializeSuccess,n.FnOnInitializeSuccess=function(i,r){var u,e;f.m_onSuccessTicks=Date.now();f.m_fCallbackCalled||(f.m_fCallbackCalled=!0,f.m_onTimeoutTicks?f.logCallbackArrivedAfterTimeout("success",r,t):(t&&(t.ULS.traceTag(38836226,logCategory.PptSession,logLevel.Info,"TimeoutWrapper: Calling fnOnInitializeSuccess"),e=f.m_bootStageInfo.length,f.m_bootStageInfo[e-1].e=Date.now(),t.ULS.traceTag(545925074,logCategory.PptSession,logLevel.Info,"fnOnInitializeSuccess - boot stage info: "+JSON.stringify(f.m_bootStageInfo)),PPTBootstrapperLogger.recordBootCompleted(n,null,null,null,t,Date.now(),f.m_appErrors,r,((u=f.m_featureGates)===null||u===void 0?void 0:u.ShouldDisableBootStageInfoInSuccessSession)?[]:f.m_bootStageInfo)),v(i,r)))}),n.FnOnInitializeFailure&&(y=n.FnOnInitializeFailure,n.FnOnInitializeFailure=function(i,r){if(f.m_onFailureTicks=Date.now(),!f.m_fCallbackCalled)if(f.m_fCallbackCalled=!0,f.m_onTimeoutTicks&&i!==f.m_callbackTimeoutError)f.logCallbackArrivedAfterTimeout("failure",r,t,i);else{if(t){var u=i;PPTBootstrapperLogger.recordBootCompleted(n,u.Code,u.ErrorName,u.errorObject,t,Date.now(),f.m_appErrors,r?r:f.m_appInitDiagnostics,f.m_bootStageInfo.length>1?f.m_bootStageInfo:[]);t.ULS.traceTag(38836227,logCategory.PptSession,logLevel.Info,"TimeoutWrapper: Calling fnOnInitializeFailure")}y(i,r)}}),n.SessionInformation&&(this.m_hostSessionId=n.SessionInformation.HostSessionId,this.m_host=n.SessionInformation.HostName));this.m_initialTicks=Date.now();e=Configuration.HostCallbackTimeout;((s=this.m_featureGates)===null||s===void 0?void 0:s.HostBootTimeoutConfigInMs)&&((h=this.m_featureGates)===null||h===void 0?void 0:h.HostBootTimeoutConfigInMs)>0&&(e=this.m_featureGates.HostBootTimeoutConfigInMs);o=UrlUtils.getQueryStringParam("wdOnSuccessTimeout");!o||parseInt(o,10).toString()!==o||(e=parseInt(o,10));e&&(p=function(){return f.timeoutIfSuccessNotCalled(n,t,u)},w=((c=this.m_featureGates)===null||c===void 0?void 0:c.MaxBootTimeoutInMs)&&((l=this.m_featureGates)===null||l===void 0?void 0:l.MaxBootTimeoutInMs)>0?(a=this.m_featureGates)===null||a===void 0?void 0:a.MaxBootTimeoutInMs:72e5,this.m_timeoutClock=new TimeoutClock(p,e,{maxTimeoutDurationMs:w}))}return n.addTimeoutWrappersToHostCallbacks=function(t,i,r,u,f){return new n(t,i,r,u,f)},n.prototype.failByHost=function(n,t,i,r){var u,f,e;this.m_onFailureTicks||this.m_onSuccessTicks||this.m_onTimeoutTicks||this.m_aborted||(this.m_aborted=!0,(u=this.m_timeoutClock)===null||u===void 0?void 0:u.abort(),f=i,e=f==null?"":f.message,PPTBootstrapperLogger.recordBootCompleted(n,6,"AbortByHost",e,t,Date.now(),r))},n.prototype.addTimeIfNotAddedInMs=function(n){!this.m_timeoutClock||this.m_timeAddedMs>=n||(this.m_timeoutClock.addTime(n-this.m_timeAddedMs),this.m_timeAddedMs=n)},n.prototype.pause=function(){var n;(n=this.m_timeoutClock)===null||n===void 0?void 0:n.pause()},n.prototype.resume=function(){var n;(n=this.m_timeoutClock)===null||n===void 0?void 0:n.resume()},n.prototype.tryUpdateTimeoutErrorStage=function(n,t){try{if(!ApplicationErrorMap.ModernBootStageToTimeoutErrorNameMap[n]){t&&t.ULS.traceTag(557417806,logCategory.PptSession,logLevel.Error,"TimeoutWrapper: "+n+" not exist in map");return}this.errorName=ApplicationErrorMap.ModernBootStageToTimeoutErrorNameMap[n].errorName;this.m_callbackTimeoutError.ErrorName=this.errorName;this.errorCode=ApplicationErrorMap.ModernBootStageToTimeoutErrorNameMap[n].errorCode;this.m_callbackTimeoutError.Code=this.errorCode;this.m_callbackTimeoutError.ExtraInfo="Boot timeout at "+n;this.m_callbackTimeoutError.errorObject="Timed out waiting for boot at "+n;var i=this.m_bootStageInfo.length;this.m_bootStageInfo[i-1].e=Date.now();this.m_bootStageInfo[i]={n:n,s:Date.now()}}catch(r){t&&t.ULS.traceTag(557434064,logCategory.PptSession,logLevel.Error,"TimeoutWrapper: exception in tryUpdateTimeoutErrorStage: "+r)}},n.prototype.setAppInitDiagnostics=function(n){this.m_appInitDiagnostics=n},n.prototype.logCallbackArrivedAfterTimeout=function(n,t,i,r){var u={};u.Message="Received "+n+" callback after timeout had elapsed";u.timeoutTimeMs=this.m_onTimeoutTicks;u.successTimeMs=this.m_onSuccessTicks;u.startTimeMs=this.m_initialTicks;u.appInitDiagnostics=t;r&&(u.error=r);i&&i.ULS.traceTag(38589660,logCategory.PptSession,logLevel.Info,JSON.stringify(u))},n.prototype.timeoutIfSuccessNotCalled=function(n,t,i){var r;if(!this.m_onFailureTicks&&!this.m_onSuccessTicks&&!this.m_onTimeoutTicks&&!this.m_aborted){this.m_onTimeoutTicks=Date.now();try{PPTPreviewerBootstrapperUtils.tryGetHostNetworkMetricsFromCallback(n,t);var u=n.Container,f=!HTMLHelper.isInDomTree(u),e=this.m_bootStageInfo.length;this.m_bootStageInfo[e-1].e=Date.now();f?t&&(t.ULS.traceTag(579604899,logCategory.PptSession,logLevel.Warning,"App container is unloaded. Scenario: "+this.m_scenario),PPTBootstrapperLogger.recordBootCompleted(n,7,"AppContainerUnloadedTimeout","App container is unloaded",t,this.m_onTimeoutTicks,this.m_appErrors,undefined,this.m_bootStageInfo.length>1?this.m_bootStageInfo:[])):(t&&(r="Timed out waiting for FnOnInitializeSuccess to be called. startMs:"+this.m_initialTicks+", timeoutMs:"+this.m_onTimeoutTicks+", scenario:"+this.m_scenario+", hostSessionId:"+this.m_hostSessionId+", host: "+this.m_host,t.ULS.traceTag(38589661,logCategory.PptSession,logLevel.Error,r),i&&i.recordQosError(this.errorName,["FileOpenFailed"],!1,!0,!0,!0),n.SessionInformation.PreviousSessionErrorName=this.errorName,PPTBootstrapperLogger.recordBootstrapperTimeoutFailure(n,this.errorCode,this.errorName,r,t,this.m_onTimeoutTicks,this.m_appErrors,this.m_bootStageInfo.length>1?this.m_bootStageInfo:[])),this.m_bootStageInfo.length>1&&t.ULS.traceTag(557434065,logCategory.PptSession,logLevel.Error,"Timeout boot stage info: "+JSON.stringify(this.m_bootStageInfo)),n.FnOnInitializeFailure&&n.FnOnInitializeFailure(this.m_callbackTimeoutError,this.m_appInitDiagnostics))}catch(o){t&&t.ULS.traceTag(579604898,logCategory.PptSession,logLevel.Error,"timeoutIfSuccessNotCalled exception: "+o)}}},n}(),QueryStringParamForwarder=function(){function n(){}return n.forward=function(n,t){return!n||n.substr(0,2)!=="wd"||this.noForwardArray.indexOf(n)>=0?null:n+"="+t},n.noForwardArray=["wdPodsUrl","wdPopsUrl","wdNewPodsFrame","wdNewEnabled","wdfs","wdfsection","wdIncludeHostUrl","wdoverrides"],n}(),UrlOverrideUtils=function(){function n(){}return n.forwardMissingWdParamsFromApplicationUrl=function(n,t){var e=t.indexOf("?"),i,u,s,r,f;if(-1===e)return n;var h=t.substr(e+1),c=h.split("&"),o=n;for(i=0,u=c;i<u.length;i++)s=u[i],r=s.split("="),UrlUtils.getParameterValue(n,r[0])===""&&(f=QueryStringParamForwarder.forward(r[0],r[1]),f&&(o+="&"+f));return o},n}(),UrlUtils=function(){function n(){}return n.getParameterValue=function(n,t){var i=n.indexOf("&"+t+"="),r,u;return(i===-1&&(i=n.indexOf("?"+t+"=")),i===-1)?"":(r=i+(t.length+2),u=n.indexOf("&",r),u===-1)?n.substr(r):n.substring(r,u)},n.getParameterValueDecoded=function(n,t){var i=this.getParameterValue(n,t);return i?decodeURI(i):i},n.addOrReplaceParameterValue=function(n,t,i){var u;if(!t)return n;var r=n,f=i==null,s=r.indexOf("?");if(-1===s)return f?n:r+"?"+t+"="+i;var h=r.substr(s+1),e=h.split("&"),o=t+"=",c=!1;for(u=0;u<e.length;u=u+1)if(0===e[u].indexOf(o)){r=r.replace(e[u],f?"":o+i);c=!0;break}return c||f||(h.length>0&&(r+="&"),r+=o+i),r},n.getQueryStringParam=function(n){return this.getParameterValue(window.location.href,n)},n.urlKeyValueEncode=function(n){var t=encodeURIComponent(n);return this.encodeString(t,this.urlKeyValueEncodeReplacements)},n.encodeString=function(n,t){for(var r=n,u=t.length,i=0;i<u;i=i+1)r=r.replace(t[i].FindExpression,t[i].ReplaceValue);return r},n.getHostname=function(n){if(!n)return"";var t=document.createElement("a");return t.href=n,t.hostname},n.urlKeyValueEncodeReplacements=[{FindExpression:new RegExp("!","g"),ReplaceValue:"%21"},{FindExpression:new RegExp("'","g"),ReplaceValue:"%27"},{FindExpression:new RegExp("\\(","g"),ReplaceValue:"%28"},{FindExpression:new RegExp("\\)","g"),ReplaceValue:"%29"},{FindExpression:new RegExp("\\*","g"),ReplaceValue:"%2A"}],n}();var WacFallbackController=function(){function n(n,t,i,r,u,f,e){this.BootFailed=!1;this.InitializeWopiPendingParameters=n;this.m_forceWacFallback=t;this.GetFallbackUrl=i;this.OnSuccessWopiInfoCallback=r;this.logger=u;this.windowVisibilityMetrics=f;this.m_postMessageToken=e}return n.prototype.wopiPendingApplicationComplete=function(n,t){this.m_forceWacFallback||this.BootFailed?PPTBootstrapper.launchWacFallback(n,this.InitializeWopiPendingParameters,this.GetFallbackUrl,this.BootFailureInfo,this.logger,this.windowVisibilityMetrics,this.m_postMessageToken):(this.ReturnedWopiInfo=n,this.OnSuccessWopiInfoCallback&&this.OnSuccessWopiInfoCallback(this.ReturnedWopiInfo,t))},n.prototype.wopiPendingApplicationFail=function(){this.logger.ULS.traceTag(38293905,logCategory.PptSession,logLevel.Info,"Host failed to give us WopiInfo")},n}(),WindowVisibilityMetrics=function(){function n(){var t=this,n;this.visibilityChangeEvents=[];this.handleVisibilityChange=function(){var n={visibility:document.visibilityState,time:Date.now(),initialState:!1};t.visibilityChangeEvents.push(n)};document.visibilityState==="hidden"&&(n={visibility:document.visibilityState,time:Date.now(),initialState:!0},this.visibilityChangeEvents.push(n));document.addEventListener("visibilitychange",this.handleVisibilityChange)}return n.prototype.stop=function(){document.removeEventListener("visibilitychange",this.handleVisibilityChange)},n.prototype.getVisibilityChangeEvents=function(){return this.visibilityChangeEvents},n}(),WebViewerBaseMessage=function(){function n(n,t){this.m_id=n;this.m_type=t}return n}(),WebViewerBaseInternalMessage=function(){function n(n){this.m_type=n}return n}(),HandshakeWebViewerInternalMessage=function(n){function t(t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt){var ut=n.call(this,0)||this;return ut.m_id=t,ut.m_fEnableKeyboardNavigation=i,ut.m_contentMetadata=r,ut.m_fileUrl=u,ut.m_fileSize=f,ut.m_fileName=e,ut.m_presentationId=o,ut.m_startingSlideId=s,ut.m_startingSlideIndex=h,ut.m_hostName=c,ut.m_entryPoint=l,ut.m_apiStartTime=a,ut.m_documentClickTime=v,ut.m_hostInitTime=y,ut.m_fEnableAdvanceOnTap=p,ut.m_fileHost=w,ut.m_vetoAppSettingsStr=b,ut.m_disabledTransitionsList=k,ut.m_customTransitionResourceUrl=d,ut.m_streamUseThinEmbed=g,ut.m_disabledChangeGates=nt,ut.m_wacRegion=tt,ut.m_areThirdPartyAddInsAllowed=it,ut.m_allowExternalMarketplace=rt,ut}return __extends(t,n),t}(WebViewerBaseInternalMessage),BootTimingFromApiInternalMessage=function(n){function t(t){var i=n.call(this,26)||this;return i.m_apiTimings=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),RecordStartedSlideShowTimestampInternalMessage=function(n){function t(t){var i=n.call(this,33)||this;return i.m_startSlideShowTime=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),PowerPointWebViewerEventHandlerList=function(){function n(){this.m_list=[]}return n.prototype.Add=function(n){for(var t=0;t<this.m_list.length;t++)if(this.m_list[t]==n)return;this.m_list.push(n)},n.prototype.Remove=function(n){for(var t=0;t<this.m_list.length;++t)if(this.m_list[t]==n){this.m_list.splice(t,1);return}},n.prototype.Get=function(n){return n<this.m_list.length?this.m_list[n]:null},n.prototype.Clear=function(){this.m_list.length=0},n.prototype.Length=function(){return this.m_list.length},n}(),PreviewSessionManagerV0=function(){function n(n,t,i,r,u,f,e,o,s,h,c,l){this.m_automationDiv=null;this.m_hitNetworkHealthEvent=!1;this.m_pptDomainUrl="";this.m_anchor=n;this.m_iframe=t;this.m_frameContainerContext=i;this.m_id=r;this.m_bootedCached=u;this.m_appVersion=f;this.m_slideShowKind=e;this.m_initParams=o;this.m_percievedBootTime=s;this.m_disposeCallback=h;this.m_logger=c;this.m_pptFeatureGates=PPTBootstrapperFeatureGatesHelper.getFeatureGates(this.m_initParams,{});this.m_timeoutWrapper=l===null||l===void 0?void 0:l.timeoutWrapper;this.m_pptDomainUrl=(l===null||l===void 0?void 0:l.pptDomainUrl)?l===null||l===void 0?void 0:l.pptDomainUrl:"";this.m_eventHandlers=new PowerPointWebViewerEventHandlerList;try{StateServiceClientLoader.SendMessage(new RecordMetricsWebViewerInternalMessage("PostMessageReady",{}))}catch(a){this.m_logger.ULS.traceTag(512336899,logCategory.PptSession,logLevel.Warning,"PreviewSessionManagerV0::StateServiceClient:SendMessage PostMessageReady error "+a)}}return n.prototype.dispose=function(){this.Dispose()},n.prototype.Dispose=function(){this.ExitSlideshow();this.m_logger.ULS.traceTag(39203540,logCategory.PptSession,logLevel.Info,"PreviewSessionManagerV0::Dispose - removing anchor:"+(this.m_anchor!=null).toString());this.m_automationDiv=null;this.m_iframe!=null&&(this.m_iframe.src="");this.m_anchor!=null&&this.m_anchor.parentNode!=null&&this.m_anchor.parentNode.removeChild(this.m_anchor);this.m_anchor=null;this.m_iframe=null;this.m_eventHandlers.Clear();try{StateServiceClientLoader.TryDisconnectStateService(this.m_logger)}catch(n){this.m_logger.ULS.traceTag(571355283,logCategory.PptSession,logLevel.Error,"PreviewSessionManagerV0::Dispose StateServiceClient error "+n)}this.m_disposeCallback(this.m_id)},n.prototype.GetApplicationType=function(){return"PowerPoint"},n.prototype.GetVersion=function(){return this.m_appVersion},n.prototype.GetSessionId=function(){return this.m_id},n.prototype.GetPercievedBoot=function(){return this.m_percievedBootTime||null},n.prototype.UsingCached=function(){return this.m_bootedCached},n.prototype.GetIsDisabled=function(){return!1},n.prototype.log=function(n){this.m_logger.ULS.traceTag(39978267,logCategory.PptSession,logLevel.Info,n)},n.prototype.onMessage=function(t,i){var k,d,g,a,nt,o,v,f,et,tt,ot,s,y,st,ht,u,r,p,ct,it,rt,c,l,lt,w,ut,b,ft,h,at,vt,yt,pt,wt,e;if(this.m_frameContainerContext.isReceivedMessageValid(t,i)){t=t;switch(t.m_type){case WebViewerMessageType.GetSlidesInShowCount:a=t;!isNaN(a.m_slidesCount)&&a.m_slidesCount>=0&&this.TriggerEvent(new GetSlidesInShowCountParams(a.m_slidesCount));break;case WebViewerMessageType.GetTimeLineInfos:nt=t;nt.m_timeLineInfos!=null&&this.TriggerEvent(new GetTimeLineInfosParams(nt.m_timeLineInfos));break;case WebViewerMessageType.GetCurrentPosition:o=t;!isNaN(o.m_slideIndex)&&o.m_slideIndex>=0&&!isNaN(o.m_slideId)&&o.m_slideId>=0&&o.m_timeLineMappings!=null&&(this.m_lastPositionWebViewerMessage=o,this.TriggerEvent(new GetCurrentPositionParams(o.m_slideIndex,o.m_slideId,o.m_timeLineMappings)));break;case WebViewerMessageType.GetId:v=t;!isNaN(v.m_slideId)&&v.m_slideId>=0&&this.TriggerEvent(new GetIdParams(v.m_slideId));break;case WebViewerMessageType.OnPositionChanged:f=t;f.m_metadata&&(f.m_metadata.Bootstrapper_Notified=Date.now());!isNaN(f.m_slideIndex)&&f.m_slideIndex>=0&&!isNaN(f.m_slideId)&&f.m_slideId>=0&&f.m_timeLineMappings!=null&&(this.m_lastPositionWebViewerMessage=f,this.TriggerEvent(new OnPositionChangedParams(f.m_slideIndex,f.m_slideId,f.m_timeLineMappings,f.m_metadata)));break;case WebViewerMessageType.TogglePrivateViewing:et=t;this.TriggerEvent(new TogglePrivateViewingParams(et.m_enabled));break;case WebViewerMessageType.GoToPresenter:this.TriggerEvent(new GoToPresenterParams);break;case WebViewerMessageType.CopyFileLinktoClipboard:this.TriggerEvent(new CopyFileLinktoClipboardParams);break;case WebViewerMessageType.PasteFileLinktoChat:this.TriggerEvent(new PasteFileLinktoChatParams);break;case WebViewerMessageType.ShowWeatherPerson:tt=t;this.TriggerEvent(new ShowWeatherPersonParams(tt.m_show,tt.m_metadata));break;case WebViewerMessageType.RoleChangedOutbound:ot=t;this.TriggerEvent(new RoleChangedOutboundParams(ot.m_role));break;case WebViewerMessageType.MediaEvent:s=t;n.IsValidMediaEventType(s.m_mediaEventType)&&this.TriggerEvent(new OnMediaEventParams(s.m_mediaPlayerName,s.m_mediaEventType,s.m_mediaPosition,s.m_mediaHostName,s.m_mediaVolume,s.m_metadata));break;case WebViewerMessageType.GetCurrentMediaStates:y=t;this.TriggerEvent(new GetCurrentMediaStatesParams(y.m_slideIndex,y.m_slideId,y.m_mediaStates));break;case WebViewerMessageType.GetPresentationPlaybackState:st=t;this.TriggerEvent(new GetPresentationPlaybackStateParams(st.m_playbackState));break;case WebViewerMessageType.OnPresentationPlaybackStateChanged:ht=t;this.TriggerEvent(new OnPresentationPlaybackStateChangedParams(ht.m_playbackState));break;case WebViewerMessageType.GetCurrentSlideDimensions:u=t;!isNaN(u.m_slideWidth)&&u.m_slideWidth>=0&&!isNaN(u.m_slideHeight)&&u.m_slideHeight>=0&&(!isNaN(u.m_slideLeftBound)&&u.m_slideLeftBound>=0&&!isNaN(u.m_slideBottomBound)&&u.m_slideBottomBound>=0?this.TriggerEvent(new GetCurrentSlideDimensionsParams(u.m_slideWidth,u.m_slideHeight,u.m_slideLeftBound,u.m_slideBottomBound)):this.TriggerEvent(new GetCurrentSlideDimensionsParams(u.m_slideWidth,u.m_slideHeight,-1,-1)));break;case WebViewerMessageType.OnError:r=t;!isNaN(r.m_code)&&r.m_code>=0?(r.m_message=r.m_message?r.m_message:"",p=ErrorCategory.Fatal,ct=r.m_code+"_"+p+"_"+r.m_message+"_"+r.m_extraInfo+"_"+r.m_correlationId,this.m_logger.ULS.traceTag(553673368,logCategory.PptSession,logLevel.Info,"OnError Called with error code:"+r.m_code+", and message:"+r.m_message),this.AddAutomationData("OnError",ct),this.TriggerEvent(new OnErrorParams(p,r.m_message,r.m_extraInfo,r.m_sessionId,r.m_correlationId)),this.TriggerEvent(new OnApiErrorParams(r.m_code,p,r.m_extraInfo,r.m_sessionId))):this.m_logger.ULS.traceTag(553673369,logCategory.PptSession,logLevel.Warning,"OnError Called with invalid error code:"+r.m_code+", and message:"+r.m_message);break;case WebViewerMessageType.OnSpecialKey:it=t;n.FIsUintValid(it.m_key)&&this.TriggerEvent(new OnSpecialKeyParams(it.m_key));break;case WebViewerMessageType.OnUlsLog:rt=t;rt.m_logs&&this.TriggerEvent(new OnUlsLogParams(rt.m_logs));break;case WebViewerMessageType.OnNetworkHealthChanged:if(c=t,c.m_isHealthy===undefined)return;c.m_addTimeoutTimeMs&&((k=this.m_timeoutWrapper)===null||k===void 0?void 0:k.addTimeIfNotAddedInMs(c.m_addTimeoutTimeMs));c.m_isHealthy?(d=this.m_timeoutWrapper)===null||d===void 0?void 0:d.resume():(g=this.m_timeoutWrapper)===null||g===void 0?void 0:g.pause();break;case WebViewerMessageType.OnBrowserEvent:l=t;l.m_event&&this.TriggerEvent(new OnBrowserEventParams(l.m_event,l.m_clientX,l.m_clientY));break;case WebViewerMessageType.OnEnterEndOfSlideshow:this.TriggerEvent(new OnEnterEndOfSlideshowParams);break;case WebViewerMessageType.OnLeaveEndOfSlideshow:this.TriggerEvent(new OnLeaveEndOfSlideshowParams);break;case WebViewerMessageType.OnContentRefreshBegin:lt=t;this.TriggerEvent(new ContentRefreshBeginParams(lt.m_reason));break;case WebViewerMessageType.OnContentRefreshEnd:this.TriggerEvent(new ContentRefreshEndParams);this.GetSlidesInShowCount();break;case WebViewerMessageType.OnExitSlideshow:w=t;this.TriggerEvent(new OnExitSlideshowParams(w.m_slideId,w.m_slideIndex,w.m_isFromEndOfSlideshow));break;case WebViewerMessageType.OnContextMenu:ut=t;this.TriggerEvent(new OnContextMenuParams(ut.m_clientX,ut.m_clientY));break;case WebViewerMessageType.OnPodSessionExpired:b=t;this.TriggerEvent(new OnPodSessionExpiredParams(b.m_code,b.m_reason,b.m_podSessionId));break;case WebViewerMessageType.OnRenderedToBuffer:ft=t;this.TriggerEvent(new OnRenderedToBufferParams(ft.m_slideIndex,ft.m_img));break;case WebViewerMessageType.RecordQosError:h=t;this.TriggerEvent(new RecordQosErrorParams(h.m_errorName,h.m_vetoName,h.m_isIntentional,h.m_isInternal,h.m_alertOnPillar,h.m_isSessionEndingError,h.m_durationMs));break;case WebViewerMessageType.OnSlideViewBoundsChanged:at=t;this.TriggerEvent(new OnSlideViewBoundsChangedParams(at.m_slideViewBounds));break;case WebViewerMessageType.CameoDetectedInPresentation:vt=t;this.TriggerEvent(new CameoDetectedInPresentationParams(vt.m_fCameoDetectedInPresentation));break;case WebViewerMessageType.CameoFrameRequestForSlide:yt=t;this.TriggerEvent(new CameoFrameRequestForSlideParams(yt.m_cameoInSlide));break;case WebViewerMessageType.RenderingModeChangedToSVG:this.TriggerEvent(new RenderingModeChangedToSVGParams);break;case WebViewerMessageType.BlankSlideState:pt=t;this.TriggerEvent(new BlankSlideStateParams(pt.m_blankSlideState));break;case WebViewerMessageType.AadTokenRequest:wt=t;this.m_logger.ULS.traceTag(574386265,logCategory.PptSession,logLevel.Info,"AAD Token Auth: Sent request to Host");this.TriggerEvent(new AadTokenRequestParams(wt.m_resourceId));break;case WebViewerMessageType.FrameTrustCheck:this.m_initParams.ApplicationCustomSettings.OverrideFrameTrustCheck?this.TriggerEvent(new FrameTrustCheckParams):this.SetFrameTrustStatus(this.defaultFrameTrustCheck());break;case WebViewerMessageType.StartCoach:this.TriggerEvent(new StartCoachParams);break;case WebViewerMessageType.StopCoach:this.TriggerEvent(new StopCoachParams);break;case WebViewerMessageType.CheckCoachStatus:this.TriggerEvent(new CheckCoachStatusParams);break;case WebViewerMessageType.TakeControl:e=t;e.m_metadata&&(e.m_metadata.Bootstrapper_Notified=Date.now());!isNaN(e.m_slideIndex)&&e.m_slideIndex>=0&&!isNaN(e.m_slideId)&&e.m_slideId>=0&&e.m_timeLineMappings!=null&&this.TriggerEvent(new TakeControlParams(e.m_slideIndex,e.m_slideId,e.m_timeLineMappings,e.m_metadata));break;case WebViewerMessageType.MediaDetectedInPresentation:this.TriggerEvent(new MediaDetectedInPresentation)}}},n.prototype.defaultFrameTrustCheck=function(){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(n){}return!1},n.ValidateTimeLineMappings=function(t){var i=!Array.isArray(t),r;if(!i)for(r in t)if(t[r].TimeLineId==null||!n.FIsUintValid(t[r].Step)){i=!0;break}if(i)throw Error("ValidateTimeLineMappings");return t},n.prototype.AddAutomationData=function(n,t){this.EnsureAutomationDiv();var i=document.createElement("p");i.innerText=n+":"+t;this.m_automationDiv.appendChild(i)},n.FIsUintValid=function(n){return!(n==null||n<0||isNaN(n))},n.IsValidMediaEventType=function(n){return n>=0&&n<=4},n.prototype.EnsureAutomationDiv=function(){this.m_automationDiv||(this.m_automationDiv=document.createElement("div"),this.m_automationDiv.id="pptAutomation-"+this.m_id,this.m_automationDiv.style.visibility="hidden",this.m_anchor.appendChild(this.m_automationDiv))},n.prototype.TriggerEvent=function(n){for(var i,t=0;t<this.m_eventHandlers.Length();++t)i=this.m_eventHandlers.Get(t),i(n)},n.prototype.PostMessageDownward=function(n){if(!this.m_iframe){this.m_logger.ULS.traceTag(39203541,logCategory.PptSession,logLevel.Info,"PreviewSessionManagerV0::PostMessageDownward iframe is null");return}this.m_frameContainerContext&&this.m_frameContainerContext.postMessageDownward(n)},n.prototype.PostMessageWithArrayBufferDownward=function(n,t){if(!this.m_iframe){this.m_logger.ULS.traceTag(556672282,logCategory.PptSession,logLevel.Info,"PreviewSessionManagerV0::PostMessageWithArrayBufferDownward iframe is null");return}this.m_frameContainerContext&&this.m_frameContainerContext.postMessageWithArrayBufferDownward(n,t)},n.prototype.GetSlidesInShowCount=function(){var n=new GetSlidesInShowCountWebViewerInternalMessage;this.PostMessageDownward(n)},n.prototype.GetTimeLineInfos=function(t){if(n.FIsUintValid(t)){var i=new GetTimeLineInfosWebViewerInternalMessage(t);this.PostMessageDownward(i)}},n.prototype.GetCurrentPosition=function(){var n=new GetCurrentPositionWebViewerInternalMessage;this.PostMessageDownward(n)},n.prototype.GetCurrentPositionWithTimeLines=function(){var n=new GetCurrentPositionWithTimeLinesWebViewerInternalMessage;this.PostMessageDownward(n)},n.prototype.GetCurrentSlideDimensions=function(){var n=new GetCurrentSlideDimensionsWebViewerInternalMessage;this.PostMessageDownward(n)},n.prototype.GetId=function(t){n.FIsUintValid(t)&&this.PostMessageDownward(new GetIdWebViewerInternalMessage(t))},n.prototype.Next=function(n){this.PostMessageDownward(new NextWebViewerInternalMessage(n))},n.prototype.PausePresentation=function(){this.PostMessageDownward(new PausePresentationWebViewerInternalMessage)},n.prototype.PlayPresentation=function(){this.PostMessageDownward(new PlayPresentationWebViewerInternalMessage)},n.prototype.GetPresentationPlaybackState=function(){this.PostMessageDownward(new GetPresentationPlaybackStateInternalMessage)},n.prototype.NextSlide=function(){this.PostMessageDownward(new NextSlideWebViewerInternalMessage)},n.prototype.Prev=function(n){this.PostMessageDownward(new PrevWebViewerInternalMessage(n))},n.prototype.PrevSlide=function(){this.PostMessageDownward(new PrevSlideWebViewerInternalMessage)},n.prototype.GoToNextSlide=function(){this.PostMessageDownward(new GoToNextSlideWebViewerInternalMessage)},n.prototype.GoToPrevSlide=function(){this.PostMessageDownward(new GoToPrevSlideWebViewerInternalMessage)},n.prototype.GoToSlide=function(t,i,r){if(n.FIsUintValid(t)&&n.ValidateTimeLineMappings(i)){try{typeof t=="string"&&(t=parseInt(t))}catch(u){this.m_logger.ULS.traceTag(559708181,logCategory.PptSession,logLevel.Error,"Failed to parse go To Slide Index value. Received value: "+t+". Exception: "+u)}r&&(r.Bootstrapper_Local=Date.now());this.PostMessageDownward(new GoToSlideWebViewerInternalMessage(t,i,r));try{StateServiceClientLoader.SendMessage(new RecordMetricsWebViewerInternalMessage("NavigationMetadata",r||{}))}catch(u){this.m_logger.ULS.traceTag(557175650,logCategory.PptSession,logLevel.Warning,"PreviewSessionManagerV0::StateServiceClient:SendMessage GoToSlide error "+u)}}else this.m_logger.ULS.traceTag(570730066,logCategory.PptSession,logLevel.Warning,"GoToSlide: Invalid slideIndex: "+t+", or timelineMapping: "+JSON.stringify(i))},n.prototype.GoToSlideId=function(t,i){n.FIsUintValid(t)&&n.ValidateTimeLineMappings(i)&&this.PostMessageDownward(new GoToSlideIdWebViewerInternalMessage(t,i))},n.prototype.SwitchRole=function(n){this.m_logger.ULS.traceTag(578671050,logCategory.PptSession,logLevel.Info,"PreviewSessionManagerV0::SwitchRoleWebViewerInternalMessage role="+n.toString());this.PostMessageDownward(new SwitchRoleWebViewerInternalMessage(n));this.PostMessageDownward(new SwitchRoleV2WebViewerInternalMessage(n));try{StateServiceClientLoader.SendMessage(new SwitchRoleV2WebViewerInternalMessage(n))}catch(t){this.m_logger.ULS.traceTag(561111502,logCategory.PptSession,logLevel.Warning,"PreviewSessionManagerV0::StateServiceClient:SendMessage SwitchRole error "+t)}},n.prototype.SendiOSAuthTokenWithConfigs=function(n){this.m_logger.ULS.traceTag(543307339,logCategory.PptSession,logLevel.Info,"PreviewSessionManagerV0::SendiOSAuthTokenWithConfigInternalMessage sending configs");try{StateServiceClientLoader.SendMessage(new SendiOSAuthTokenWithConfigInternalMessage(n))}catch(t){this.m_logger.ULS.traceTag(545032028,logCategory.PptSession,logLevel.Warning,"PreviewSessionManagerV0::StateServiceClient:SendMessage SendiOSAuthTokenWithConfigs error "+t)}},n.prototype.ChangeTheme=function(n,t){this.PostMessageDownward(new ChangeThemeWebViewerInternalMessage(n,t))},n.prototype.SendPresenterStateDuringPrivateViewing=function(n,t,i){this.m_initParams.SessionInformation.WdParams.disableTeamsPptSharingNavControlsForAttendee&&this.PostMessageDownward(new SendPresenterStateDuringPrivateViewingInternalMessage(n,t,i))},n.prototype.PlayMedia=function(n,t){this.PostMessageDownward(new PlayMediaInternalMessage(n,t))},n.prototype.PauseMedia=function(n,t){this.PostMessageDownward(new PauseMediaInternalMessage(n,t))},n.prototype.RestoreFocus=function(){this.PostMessageDownward(new RestoreFocusInternalMessage)},n.prototype.StopMedia=function(n,t){this.PostMessageDownward(new StopMediaInternalMessage(n,t))},n.prototype.SeekMedia=function(n,t,i){this.PostMessageDownward(new SeekMediaInternalMessage(n,t,i))},n.prototype.SetMediaVolume=function(n,t,i){this.PostMessageDownward(new SetMediaVolumeInternalMessage(n,t,i))},n.prototype.GetCurrentMediaStates=function(){this.PostMessageDownward(new GetCurrentMediaStatesInternalMessage)},n.prototype.ExitSlideshow=function(){this.PostMessageDownward(new ExitSlideshowInternalMessage)},n.prototype.RefreshPodSession=function(n,t){this.PostMessageDownward(new RefreshPodSessionInternalMessage(n,t))},n.prototype.SetNavigationOptions=function(n,t){this.PostMessageDownward(new SetNavigationOptionsMessage(n,t))},n.prototype.ShowHideCursor=function(n){this.PostMessageDownward(new ShowHideCursorWebViewerInternalMessage(n))},n.prototype.PostMessageToInkManager=function(n,t){this.PostMessageDownward(new InkManagerInternalMessage(n,t))},n.prototype.PPTSharingLayoutChanged=function(n){n===void 0&&(n="ContentOnly");this.m_logger.ULS.traceTag(541885442,logCategory.PptSession,logLevel.Info,"PPTSharingLayoutChanged: sharingLayoutMode "+n);this.PostMessageDownward(new PPTSharingLayoutChangedInternalMessage(n))},n.prototype.SetAadToken=function(n){this.m_logger.ULS.traceTag(574386266,logCategory.PptSession,logLevel.Info,"AAD Token Auth: Sent response to PPT");this.PostMessageDownward(new SetAadTokenInternalMessage(n))},n.prototype.SetFrameTrustStatus=function(n){n||this.m_logger.ULS.traceTag(523077399,logCategory.PptSession,logLevel.Warning,"Trust check failed");this.PostMessageDownward(new SetFrameTrustStatusInternalMessage(n))},n.prototype.SetPrivateViewingToggle=function(n){this.m_logger.ULS.traceTag(573137920,logCategory.PptSession,logLevel.Info,"Attendee received private viewing is now "+n?"enabled":"disabled");this.PostMessageDownward(new SetPrivateViewingToggleInternalMessage(n))},n.prototype.UpdateMeetingCoachStatus=function(n){this.PostMessageDownward(new UpdateMeetingCoachStatusInternalMessage(n))},n.prototype.UpdateBufferInfoForCameo=function(n){this.PostMessageDownward(new UpdateBufferInfoForCameoInternalMessage(n))},n.prototype.VideoFrameToPptForCameo=function(n,t){this.PostMessageWithArrayBufferDownward(n,t)},n.prototype.UpdatePresenterName=function(n){this.m_logger.ULS.traceTag(521175364,logCategory.PptSession,logLevel.Info,"Update presenter name in PPT");this.PostMessageDownward(new UpdatePresenterNameInternalMessage(n))},n.prototype.ReturnToPresenterInbound=function(){this.PostMessageDownward(new ReturnToPresenterInboundInternalMessage)},n.prototype.CustomBackgroundForAPL=function(n,t){this.m_logger.ULS.traceTag(528263117,logCategory.PptSession,logLevel.Info,"CustomBackgroundForAPL image Id: "+t?t:"not received/known");this.PostMessageDownward(new CustomBackgroundForAPLInternalMessage(n,t))},n.prototype.SetGlobalMute=function(n){this.m_logger.ULS.traceTag(525162530,logCategory.PptSession,logLevel.Info,"Global Mute: Sent updated Muted value to PPT: "+n);this.PostMessageDownward(new SetGlobalMuteInternalMessage(n))},n.prototype.HideCameo=function(n,t){this.m_logger.ULS.traceTag(520734491,logCategory.PptSession,logLevel.Info,"Hide cameo: "+n+"reason: "+t);this.PostMessageDownward(new HideCameoInternalMessage(n,t))},n.prototype.GetPPTDomainURL=function(){this.TriggerEvent(new GetPPTDomainURLParams(this.m_pptDomainUrl))},n.prototype.SetLaserPointerActivation=function(n,t){this.m_logger.ULS.traceTag(525115935,logCategory.PptSession,logLevel.Info,"Laser Pointer Activation: sent activation value to PPT: "+n+", with metadata:"+JSON.stringify(t));this.PostMessageDownward(new SetLaserPointerActivationInternalMessage(n,t))},n.prototype.SendSessionMetadata=function(n,t){try{n!=null&&t!=null?(this.m_logger.ULS.traceTag(588804101,logCategory.PptSession,logLevel.Info,n+": "+JSON.stringify(t)),n=="NavMetric"&&this.PostMessageDownward(new RecordMetricsWebViewerInternalMessage("TeamsNavMetric",t))):this.m_logger.ULS.traceTag(588804100,logCategory.PptSession,logLevel.Warning,"SendSessionMetadata called with null params")}catch(i){this.m_logger.ULS.traceTag(588804099,logCategory.PptSession,logLevel.Error,"SendSessionMetadata error: "+JSON.stringify(i))}},n.prototype.onSliceLoaded=function(){},n.prototype.AddEventHandler=function(n){n&&this.m_eventHandlers.Add(n)},n.prototype.RegisterEventHandler=function(n,t){var i=this;t||(t=n,n="*");n=="*"&&this.m_eventHandlers.Add(function(n){i.filterEventOrErrorHandler(n,!1,t)});n=="ContentRefreshBegin"&&this.m_eventHandlers.Add(function(n){n.EventType==21&&t(n)});n=="ContentRefreshEnd"&&this.m_eventHandlers.Add(function(n){n.EventType==22&&t(n)})},n.prototype.RegisterErrorHandler=function(n){var t=this;n&&this.m_eventHandlers.Add(function(i){t.filterEventOrErrorHandler(i,!0,n)})},n.prototype.RemoveEventHandler=function(n,t){var i=this;t||(t=n,n="*");n=="*"&&this.m_eventHandlers.Remove(function(n){i.filterEventOrErrorHandler(n,!1,t)});n=="ContentRefreshBegin"&&this.m_eventHandlers.Remove(function(n){n.EventType==21&&t(n)});n=="ContentRefreshEnd"&&this.m_eventHandlers.Remove(function(n){n.EventType==22&&t(n)});n||this.m_eventHandlers.Remove(t)},n.prototype.RemoveErrorHandler=function(n){var t=this;n&&this.m_eventHandlers.Remove(function(i){t.filterEventOrErrorHandler(i,!0,n)})},n.prototype.filterEventOrErrorHandler=function(n,t,i){if(n.EventType==13&&t){var r=n;i(r)}n.EventType==13||t||i(n)},n}(),PreviewAPIV0Factory=function(){function n(){}return n.prototype.GetPreviewAPIV1=function(n,t,i,r,u,f,e,o,s,h,c,l){return new PreviewSessionManagerV0(n,t,i,r,u,f,e,o,s,h,c,l)},n}(),ViewerEventParams=function(){function n(n){this.EventType=n}return n}(),ViewerEventType=function(){function n(){}return n.GetSlidesInShowCount=0,n.GetTimeLineInfos=1,n.GetCurrentPosition=2,n.GetId=3,n.GetPresentationName=4,n.OnPositionChanged=5,n.OnPresentationOpened=6,n.GetCurrentSlideDimensions=7,n.OnMediaEvent=9,n.GetCurrentMediaStates=10,n.OnError=11,n.OnSpecialKey=12,n.OnApiError=13,n.OnUlsLog=14,n.OnNetworkHealthChanged=15,n.GetPresentationPlaybackState=16,n.OnPresentationPlaybackStateChanged=17,n.OnBrowserEvent=18,n.OnEnterEndOfSlideshow=19,n.OnLeaveEndOfSlideshow=20,n.ContentRefreshBegin=21,n.ContentRefreshEnd=22,n.OnExitSlideshow=23,n.OnContextMenu=24,n.GoToPresenter=25,n.OnPodSessionExpired=27,n.OnRenderedToBuffer=28,n.RecordQosError=33,n.TogglePrivateViewing=47,n.OnSlideViewBoundsChanged=48,n.AadTokenRequest=49,n.StartCoach=50,n.StopCoach=51,n.CheckCoachStatus=52,n.BlankSlideState=54,n.ShowWeatherPerson=55,n.RoleChangedOutbound=57,n.PasteFileLinktoChat=60,n.CopyFileLinktoClipboard=61,n.CameoDetectedInPresentation=66,n.CameoFrameRequestForSlide=67,n.RenderingModeChangedToSVG=68,n.FrameTrustCheck=69,n.TakeControl=72,n.MediaDetectedInPresentation=73,n.GetPPTDomainURL=74,n}(),OnApiErrorParams=function(n){function t(t,i,r,u){var f=n.call(this,ViewerEventType.OnApiError)||this;return f.Code=t,f.Category=i,f.ExtraInfo=r,f.SessionId=u,f.errorType=f.EventType.toString(),f.errorObject=null,f}return __extends(t,n),t}(ViewerEventParams),GetSlidesInShowCountParams=function(n){function t(t){var i=n.call(this,ViewerEventType.GetSlidesInShowCount)||this;return i.SlidesCount=t,i}return __extends(t,n),t}(ViewerEventParams),GetTimeLineInfosParams=function(n){function t(t){var i=n.call(this,ViewerEventType.GetTimeLineInfos)||this;return i.TimeLineInfos=t,i}return __extends(t,n),t}(ViewerEventParams),GetCurrentPositionParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.GetCurrentPosition)||this;return u.SlideIndex=t,u.SlideId=i,u.TimeLineMappings=r,u}return __extends(t,n),t}(ViewerEventParams),GetCurrentSlideDimensionsParams=function(n){function t(t,i,r,u){var f=n.call(this,ViewerEventType.GetCurrentSlideDimensions)||this;return f.SlideWidth=t,f.SlideHeight=i,f.SlideLeftBound=r,f.SlideBottomBound=u,f}return __extends(t,n),t}(ViewerEventParams),GetIdParams=function(n){function t(t){var i=n.call(this,ViewerEventType.GetId)||this;return i.SlideId=t,i}return __extends(t,n),t}(ViewerEventParams),OnPositionChangedParams=function(n){function t(t,i,r,u){var f=n.call(this,ViewerEventType.OnPositionChanged)||this;return f.SlideIndex=t,f.SlideId=i,f.TimeLineMappings=r,f.Metadata=u,f}return __extends(t,n),t}(ViewerEventParams),OnPresentationPlaybackStateChangedParams=function(n){function t(t){var i=n.call(this,ViewerEventType.OnPresentationPlaybackStateChanged)||this;return i.PlaybackState=t,i}return __extends(t,n),t}(ViewerEventParams),OnMediaEventParams=function(n){function t(t,i,r,u,f,e){var o=n.call(this,ViewerEventType.OnMediaEvent)||this;return o.MediaPlayerName=t,o.MediaEventType=i,o.MediaPosition=r,o.MediaVolume=f,u&&(o.MediaHostName=u),o.Metadata=e?e:{},o}return __extends(t,n),t}(ViewerEventParams),GetCurrentMediaStatesParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.GetCurrentMediaStates)||this;return u.SlideIndex=t,u.SlideId=i,u.MediaStates=r,u}return __extends(t,n),t}(ViewerEventParams),GetPresentationPlaybackStateParams=function(n){function t(t){var i=n.call(this,ViewerEventType.GetPresentationPlaybackState)||this;return i.PlaybackState=t,i}return __extends(t,n),t}(ViewerEventParams),OnPresentationOpenedParams=function(n){function t(t){var i=n.call(this,ViewerEventType.OnPresentationOpened)||this;return i.SessionId=t,i}return __extends(t,n),t}(ViewerEventParams),OnErrorParams=function(n){function t(t,i,r,u,f){var e=n.call(this,ViewerEventType.OnError)||this;return e.Category=t,e.Message=i,e.ExtraInfo=r,e.SessionId=u,e.CorrelationId=f,e}return __extends(t,n),t}(ViewerEventParams),OnSpecialKeyParams=function(n){function t(t){var i=n.call(this,ViewerEventType.OnSpecialKey)||this;return i.Key=t,i}return __extends(t,n),t}(ViewerEventParams),OnUlsLogParams=function(n){function t(t){var i=n.call(this,ViewerEventType.OnUlsLog)||this;return i.Logs=t,i}return __extends(t,n),t}(ViewerEventParams),OnBrowserEventParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.OnBrowserEvent)||this;return u.BrowserEvent=t,u.ClientX=i,u.ClientY=r,u}return __extends(t,n),t}(ViewerEventParams),OnEnterEndOfSlideshowParams=function(n){function t(){return n.call(this,ViewerEventType.OnEnterEndOfSlideshow)||this}return __extends(t,n),t}(ViewerEventParams),OnLeaveEndOfSlideshowParams=function(n){function t(){return n.call(this,ViewerEventType.OnLeaveEndOfSlideshow)||this}return __extends(t,n),t}(ViewerEventParams),ContentRefreshBeginParams=function(n){function t(t){var i=n.call(this,ViewerEventType.ContentRefreshBegin)||this;return i.reason=t,i}return __extends(t,n),t}(ViewerEventParams),ContentRefreshEndParams=function(n){function t(){var t=n.call(this,ViewerEventType.ContentRefreshEnd)||this;return t.succeeded=!0,t}return __extends(t,n),t}(ViewerEventParams),OnExitSlideshowParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.OnExitSlideshow)||this;return u.SlideId=t,u.SlideIndex=i,u.IsFromEndOfSlideshow=r,u}return __extends(t,n),t}(ViewerEventParams),OnContextMenuParams=function(n){function t(t,i){var r=n.call(this,ViewerEventType.OnContextMenu)||this;return r.ClientX=t,r.ClientY=i,r}return __extends(t,n),t}(ViewerEventParams),OnPodSessionExpiredParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.OnPodSessionExpired)||this;return u.Code=t,u.Reason=i,u.PodSessionId=r,u}return __extends(t,n),t}(ViewerEventParams),OnRenderedToBufferParams=function(n){function t(t,i){var r=n.call(this,ViewerEventType.OnRenderedToBuffer)||this;return r.SlideIndex=t,r.Img=i,r}return __extends(t,n),t}(ViewerEventParams),RecordQosErrorParams=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,ViewerEventType.RecordQosError)||this;return s.ErrorName=t,s.VetoName=i,s.IsIntentional=r,s.IsInternal=u,s.AlertOnPillar=f,s.IsSessionEndingError=e,s.DurationMs=o,s}return __extends(t,n),t}(ViewerEventParams),GoToPresenterParams=function(n){function t(){return n.call(this,ViewerEventType.GoToPresenter)||this}return __extends(t,n),t}(ViewerEventParams),TogglePrivateViewingParams=function(n){function t(t){var i=n.call(this,ViewerEventType.TogglePrivateViewing)||this;return i.Enabled=t,i}return __extends(t,n),t}(ViewerEventParams),ShowWeatherPersonParams=function(n){function t(t,i){var r=n.call(this,ViewerEventType.ShowWeatherPerson)||this;return r.Show=t,r.Metadata=i,r}return __extends(t,n),t}(ViewerEventParams),RoleChangedOutboundParams=function(n){function t(t){var i=n.call(this,ViewerEventType.RoleChangedOutbound)||this;return i.Role=t,i}return __extends(t,n),t}(ViewerEventParams),PasteFileLinktoChatParams=function(n){function t(){return n.call(this,ViewerEventType.PasteFileLinktoChat)||this}return __extends(t,n),t}(ViewerEventParams),CopyFileLinktoClipboardParams=function(n){function t(){return n.call(this,ViewerEventType.CopyFileLinktoClipboard)||this}return __extends(t,n),t}(ViewerEventParams),OnSlideViewBoundsChangedParams=function(n){function t(t){var i=n.call(this,ViewerEventType.OnSlideViewBoundsChanged)||this;return i.SlideViewBounds=t,i}return __extends(t,n),t}(ViewerEventParams),CameoDetectedInPresentationParams=function(n){function t(t){var i=n.call(this,ViewerEventType.CameoDetectedInPresentation)||this;return i.CameoDetectedInPresentation=t,i}return __extends(t,n),t}(ViewerEventParams),CameoFrameRequestForSlideParams=function(n){function t(t){var i=n.call(this,ViewerEventType.CameoFrameRequestForSlide)||this;return i.CameoInSlide=t,i}return __extends(t,n),t}(ViewerEventParams),RenderingModeChangedToSVGParams=function(n){function t(){return n.call(this,ViewerEventType.RenderingModeChangedToSVG)||this}return __extends(t,n),t}(ViewerEventParams),BlankSlideStateParams=function(n){function t(t){var i=n.call(this,ViewerEventType.BlankSlideState)||this;return i.BlankSlideState=t,i}return __extends(t,n),t}(ViewerEventParams),AadTokenRequestParams=function(n){function t(t){var i=n.call(this,ViewerEventType.AadTokenRequest)||this;return i.ResourceId=t,i}return __extends(t,n),t}(ViewerEventParams),FrameTrustCheckParams=function(n){function t(){return n.call(this,ViewerEventType.FrameTrustCheck)||this}return __extends(t,n),t}(ViewerEventParams),StartCoachParams=function(n){function t(){return n.call(this,ViewerEventType.StartCoach)||this}return __extends(t,n),t}(ViewerEventParams),StopCoachParams=function(n){function t(){return n.call(this,ViewerEventType.StopCoach)||this}return __extends(t,n),t}(ViewerEventParams),CheckCoachStatusParams=function(n){function t(){return n.call(this,ViewerEventType.CheckCoachStatus)||this}return __extends(t,n),t}(ViewerEventParams),TakeControlParams=function(n){function t(t,i,r,u){var f=n.call(this,ViewerEventType.TakeControl)||this;return f.SlideIndex=t,f.SlideId=i,f.TimeLineMappings=r,f.Metadata=u,f}return __extends(t,n),t}(ViewerEventParams),MediaDetectedInPresentation=function(n){function t(){return n.call(this,ViewerEventType.MediaDetectedInPresentation)||this}return __extends(t,n),t}(ViewerEventParams),GetPPTDomainURLParams=function(n){function t(t){var i=n.call(this,ViewerEventType.GetPPTDomainURL)||this;return i.DomainURL=t,i}return __extends(t,n),t}(ViewerEventParams),WebViewerInternalMessageType;(function(n){n[n.Handshake=0]="Handshake";n[n.GetSlidesInShowCount=1]="GetSlidesInShowCount";n[n.GetTimeLineInfos=2]="GetTimeLineInfos";n[n.GetCurrentPosition=3]="GetCurrentPosition";n[n.GetId=4]="GetId";n[n.Next=5]="Next";n[n.NextSlide=6]="NextSlide";n[n.Prev=7]="Prev";n[n.PrevSlide=8]="PrevSlide";n[n.GoToSlide=9]="GoToSlide";n[n.GoToSlideId=10]="GoToSlideId";n[n.Popout=11]="Popout";n[n.GetCurrentSlideDimensions=12]="GetCurrentSlideDimensions";n[n.DisplayBlackSlide=13]="DisplayBlackSlide";n[n.DisplayWhiteSlide=14]="DisplayWhiteSlide";n[n.PlayMedia=15]="PlayMedia";n[n.PauseMedia=16]="PauseMedia";n[n.StopMedia=17]="StopMedia";n[n.SeekMedia=18]="SeekMedia";n[n.GetCurrentMediaStates=19]="GetCurrentMediaStates";n[n.PausePresentation=20]="PausePresentation";n[n.PlayPresentation=21]="PlayPresentation";n[n.GetCurrentPlayModeState_Unused=22]="GetCurrentPlayModeState_Unused";n[n.GetPresentationPlaybackState=23]="GetPresentationPlaybackState";n[n.GoToNextSlide=24]="GoToNextSlide";n[n.GoToPrevSlide=25]="GoToPrevSlide";n[n.BootTimingFromApi=26]="BootTimingFromApi";n[n.GenericULSLog=27]="GenericULSLog";n[n.RestoreFocus=28]="RestoreFocus";n[n.ExitSlideshow=29]="ExitSlideshow";n[n.RefreshPodSession=30]="RefreshPodSession";n[n.SetNavigationOptions=31]="SetNavigationOptions";n[n.ShowHideCursor=32]="ShowHideCursor";n[n.RecordStartedSlideShowTimestamp=33]="RecordStartedSlideShowTimestamp";n[n.GetCurrentPositionWithTimeLines=34]="GetCurrentPositionWithTimeLines";n[n.InkManager=35]="InkManager";n[n.SwitchRole=34]="SwitchRole";n[n.RecordMetrics=36]="RecordMetrics";n[n.ChangeTheme=37]="ChangeTheme";n[n.SwitchRoleV2=45]="SwitchRoleV2";n[n.PPTSharingLayoutChanged=46]="PPTSharingLayoutChanged";n[n.SetPrivateViewingToggle=47]="SetPrivateViewingToggle";n[n.SendPresenterStateDuringPrivateViewing=48]="SendPresenterStateDuringPrivateViewing";n[n.SetAadToken=49]="SetAadToken";n[n.UpdateMeetingCoachStatus=50]="UpdateMeetingCoachStatus";n[n.VolumeMedia=55]="VolumeMedia";n[n.SendiOSAuthTokenWithConfig=56]="SendiOSAuthTokenWithConfig";n[n.ReturnToPresenterInbound=60]="ReturnToPresenterInbound";n[n.CustomBackgroundForAPL=61]="CustomBackgroundForAPL";n[n.SetGlobalMute=62]="SetGlobalMute";n[n.LaserPointerActivation=63]="LaserPointerActivation";n[n.UpdateBufferInfoForCameo=64]="UpdateBufferInfoForCameo";n[n.SetFrameTrustStatus=65]="SetFrameTrustStatus";n[n.HideCameo=66]="HideCameo";n[n.UpdatePresenterName=75]="UpdatePresenterName";n[n.VideoFrameToPptForCameo=99]="VideoFrameToPptForCameo"})(WebViewerInternalMessageType||(WebViewerInternalMessageType={}));var GetCurrentSlideDimensionsWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetCurrentSlideDimensions)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetSlidesInShowCountWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetSlidesInShowCount)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetTimeLineInfosWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.GetTimeLineInfos)||this;return i.m_slideIndex=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetCurrentPositionWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetCurrentPosition)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetCurrentPositionWithTimeLinesWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetCurrentPositionWithTimeLines)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetIdWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.GetId)||this;return i.m_slideIndex=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),NextWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.Next)||this;return i.m_metadata=t?t:{},i}return __extends(t,n),t}(WebViewerBaseInternalMessage),NextSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.NextSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GoToNextSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GoToNextSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GoToPrevSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GoToPrevSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),PausePresentationWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.PausePresentation)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),PlayPresentationWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.PlayPresentation)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetPresentationPlaybackStateInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetPresentationPlaybackState)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),PrevWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.Prev)||this;return i.m_metadata=t?t:{},i}return __extends(t,n),t}(WebViewerBaseInternalMessage),DisplayBlackSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.DisplayBlackSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),DisplayWhiteSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.DisplayWhiteSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),PrevSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.PrevSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GoToSlideWebViewerInternalMessage=function(n){function t(t,i,r){var u=n.call(this,WebViewerInternalMessageType.GoToSlide)||this;return u.m_slideIndex=t,u.m_timeLineMappings=i,u.m_metadata=r?r:{},u}return __extends(t,n),t}(WebViewerBaseInternalMessage),GoToSlideIdWebViewerInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.GoToSlideId)||this;return r.m_slideId=t,r.m_timeLineMappings=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),PopoutInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.Popout)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),PlayMediaInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.PlayMedia)||this;return r.m_mediaPlayerName=t,r.m_metadata=i?i:{},r}return __extends(t,n),t}(WebViewerBaseInternalMessage),PauseMediaInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.PauseMedia)||this;return r.m_mediaPlayerName=t,r.m_metadata=i?i:{},r}return __extends(t,n),t}(WebViewerBaseInternalMessage),SetMediaVolumeInternalMessage=function(n){function t(t,i,r){var u=n.call(this,WebViewerInternalMessageType.VolumeMedia)||this;return u.m_mediaPlayerName=t,u.m_volume=i,u.m_metadata=r?r:{},u}return __extends(t,n),t}(WebViewerBaseInternalMessage),RestoreFocusInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.RestoreFocus)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),StopMediaInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.StopMedia)||this;return r.m_mediaPlayerName=t,r.m_metadata=i?i:{},r}return __extends(t,n),t}(WebViewerBaseInternalMessage),SeekMediaInternalMessage=function(n){function t(t,i,r){var u=n.call(this,WebViewerInternalMessageType.SeekMedia)||this;return u.m_mediaPlayerName=t,u.m_position=i,u.m_metadata=r?r:{},u}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetCurrentMediaStatesInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetCurrentMediaStates)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GenericULSLogInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.GenericULSLog)||this;return r.m_tagID=t,r.m_message=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),ExitSlideshowInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.ExitSlideshow)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),RefreshPodSessionInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.RefreshPodSession)||this;return r.m_podSessionId=t,r.m_wacCluster=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),SetNavigationOptionsMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.SetNavigationOptions)||this;return r.m_enableAdvanceOnClick=t,r.m_enableKeyboardNavigation=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),ShowHideCursorWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.ShowHideCursor)||this;return i.m_fShow=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),InkManagerInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.InkManager)||this;return r.m_item=t,r.m_color=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),SwitchRoleWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.SwitchRole)||this;return i.m_role=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),SwitchRoleV2WebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.SwitchRoleV2)||this;return i.m_role=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),SendiOSAuthTokenWithConfigInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.SendiOSAuthTokenWithConfig)||this;return i.m_configs={},i.m_configs=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),ChangeThemeWebViewerInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.ChangeTheme)||this;return r.m_isHighContrast=t,r.m_highContrastColorSettings=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),SendPresenterStateDuringPrivateViewingInternalMessage=function(n){function t(t,i,r){var u=n.call(this,WebViewerInternalMessageType.SendPresenterStateDuringPrivateViewing)||this;return u.m_slideIndex=t,u.m_timeLineMappings=i,u.m_metadata=r,u}return __extends(t,n),t}(WebViewerBaseInternalMessage),RecordMetricsWebViewerInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.RecordMetrics)||this;return r.m_statName=t,r.m_data=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),PPTSharingLayoutChangedInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.PPTSharingLayoutChanged)||this;return i.m_sharingLayoutMode=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),SetAadTokenInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.SetAadToken)||this;return i.m_token=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),SetFrameTrustStatusInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.SetFrameTrustStatus)||this;return i.m_isTrusted=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),UpdateBufferInfoForCameoInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.UpdateBufferInfoForCameo)||this;return i.m_bufferName=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),ReturnToPresenterInboundInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.ReturnToPresenterInbound)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),CustomBackgroundForAPLInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.CustomBackgroundForAPL)||this;return r.m_backgroundUrl=t,r.m_backgroundId=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),UpdatePresenterNameInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.UpdatePresenterName)||this;return i.m_presenterDisplayName=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),SetPrivateViewingToggleInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.SetPrivateViewingToggle)||this;return i.m_enabled=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),UpdateMeetingCoachStatusInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.UpdateMeetingCoachStatus)||this;return i.m_isCoachOn=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),SetGlobalMuteInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.SetGlobalMute)||this;return i.m_fMuted=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),SetLaserPointerActivationInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.LaserPointerActivation)||this;return r.m_fActivate=t,r.m_metadata=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),HideCameoInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.HideCameo)||this;return r.m_fHide=t,r.m_reason=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),WebViewerMessageType;(function(n){n[n.Handshake=0]="Handshake";n[n.GetSlidesInShowCount=1]="GetSlidesInShowCount";n[n.GetTimeLineInfos=2]="GetTimeLineInfos";n[n.GetCurrentPosition=3]="GetCurrentPosition";n[n.GetId=4]="GetId";n[n.OnPositionChanged=5]="OnPositionChanged";n[n.OpenPresentation=6]="OpenPresentation";n[n.GetCurrentSlideDimensions=7]="GetCurrentSlideDimensions";n[n.MediaEvent=8]="MediaEvent";n[n.GetCurrentMediaStates=9]="GetCurrentMediaStates";n[n.OnError=10]="OnError";n[n.OnSpecialKey=11]="OnSpecialKey";n[n.OnRefresh=12]="OnRefresh";n[n.RejectedMessage=13]="RejectedMessage";n[n.OnUlsLog=14]="OnUlsLog";n[n.OnNetworkHealthChanged=15]="OnNetworkHealthChanged";n[n.GetPresentationPlaybackState=16]="GetPresentationPlaybackState";n[n.OnPresentationPlaybackStateChanged=17]="OnPresentationPlaybackStateChanged";n[n.OnBrowserEvent=18]="OnBrowserEvent";n[n.OnEnterEndOfSlideshow=19]="OnEnterEndOfSlideshow";n[n.OnLeaveEndOfSlideshow=20]="OnLeaveEndOfSlideshow";n[n.OnContentRefreshBegin=21]="OnContentRefreshBegin";n[n.OnContentRefreshEnd=22]="OnContentRefreshEnd";n[n.OnExitSlideshow=23]="OnExitSlideshow";n[n.OnContextMenu=24]="OnContextMenu";n[n.GoToPresenter=25]="GoToPresenter";n[n.OnPodSessionExpired=27]="OnPodSessionExpired";n[n.AppReadyForPostMessage=28]="AppReadyForPostMessage";n[n.OnRenderedToBuffer=29]="OnRenderedToBuffer";n[n.RecordQosError=33]="RecordQosError";n[n.SwitchRole=34]="SwitchRole";n[n.ChangeTheme=37]="ChangeTheme";n[n.LogToBootstrapper=40]="LogToBootstrapper";n[n.PostAppErrorUpwardsForTelemetry=41]="PostAppErrorUpwardsForTelemetry";n[n.AppBootPerfDict=42]="AppBootPerfDict";n[n.SwitchRoleV2=45]="SwitchRoleV2";n[n.TogglePrivateViewing=47]="TogglePrivateViewing";n[n.OnSlideViewBoundsChanged=48]="OnSlideViewBoundsChanged";n[n.AadTokenRequest=49]="AadTokenRequest";n[n.StartCoach=50]="StartCoach";n[n.StopCoach=51]="StopCoach";n[n.CheckCoachStatus=52]="CheckCoachStatus";n[n.BlankSlideState=54]="BlankSlideState";n[n.ShowWeatherPerson=55]="ShowWeatherPerson";n[n.BootStageChanged=56]="BootStageChanged";n[n.RoleChangedOutbound=57]="RoleChangedOutbound";n[n.PasteFileLinktoChat=60]="PasteFileLinktoChat";n[n.CopyFileLinktoClipboard=61]="CopyFileLinktoClipboard";n[n.CameoDetectedInPresentation=66]="CameoDetectedInPresentation";n[n.CameoFrameRequestForSlide=67]="CameoFrameRequestForSlide";n[n.RenderingModeChangedToSVG=68]="RenderingModeChangedToSVG";n[n.FrameTrustCheck=69]="FrameTrustCheck";n[n.TakeControl=72]="TakeControl";n[n.MediaDetectedInPresentation=73]="MediaDetectedInPresentation"})(WebViewerMessageType||(WebViewerMessageType={}));var HandshakeWebViewerMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.Handshake)||this;return f.m_sessionId=i,f.m_percievedBootTime=r,f.m_data=u,f}return __extends(t,n),t}(WebViewerBaseMessage),GetSlidesInShowCountWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.GetSlidesInShowCount)||this;return r.m_slidesCount=i,r}return __extends(t,n),t}(WebViewerBaseMessage),GetTimeLineInfosWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.GetTimeLineInfos)||this;return r.m_timeLineInfos=i,r}return __extends(t,n),t}(WebViewerBaseMessage),GetCurrentPositionWebViewerMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.GetCurrentPosition)||this;return f.m_slideIndex=i,f.m_slideId=r,f.m_timeLineMappings=u,f}return __extends(t,n),t}(WebViewerBaseMessage),GetCurrentSlideDimensionsWebViewerMessage=function(n){function t(t,i,r,u,f){var e=n.call(this,t,WebViewerMessageType.GetCurrentSlideDimensions)||this;return e.m_slideWidth=i,e.m_slideHeight=r,e.m_slideLeftBound=u,e.m_slideBottomBound=f,e}return __extends(t,n),t}(WebViewerBaseMessage),GetIdWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.Handshake)||this;return r.m_slideId=i,r}return __extends(t,n),t}(WebViewerBaseMessage),OnPositionChangedWebViewerMessage=function(n){function t(t,i,r,u,f){var e=n.call(this,t,WebViewerMessageType.OnPositionChanged)||this;return e.m_slideIndex=i,e.m_slideId=r,e.m_timeLineMappings=u,e.m_metadata=f?f:{},e}return __extends(t,n),t}(WebViewerBaseMessage),TogglePrivateViewingWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.TogglePrivateViewing)||this;return r.m_enabled=i,r}return __extends(t,n),t}(WebViewerBaseMessage),ShowWeatherPersonWebViewerMessage=function(n){function t(t,i,r){var u=n.call(this,t,WebViewerMessageType.ShowWeatherPerson)||this;return u.m_show=i,u.m_metadata=r?r:{},u}return __extends(t,n),t}(WebViewerBaseMessage),RoleChangedOutboundWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.RoleChangedOutbound)||this;return r.m_role=i,r}return __extends(t,n),t}(WebViewerBaseMessage),CopyFileLinktoClipboardWebViewerMessage=function(n){function t(t){return n.call(this,t,WebViewerMessageType.CopyFileLinktoClipboard)||this}return __extends(t,n),t}(WebViewerBaseMessage),PasteFileLinktoChatWebViewerMessage=function(n){function t(t){return n.call(this,t,WebViewerMessageType.PasteFileLinktoChat)||this}return __extends(t,n),t}(WebViewerBaseMessage),MediaEventWebViewerMessage=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,t,WebViewerMessageType.MediaEvent)||this;return s.m_mediaPlayerName=i,s.m_mediaEventType=r,s.m_mediaPosition=u,s.m_mediaVolume=e,f&&(s.m_mediaHostName=f),s.m_metadata=o?o:{},s}return __extends(t,n),t}(WebViewerBaseMessage),OnErrorWebViewerMessage=function(n){function t(t,i,r,u,f,e){var o=n.call(this,t,WebViewerMessageType.OnError)||this;return o.m_code=i,o.m_message=r,o.m_extraInfo=u,o.m_sessionId=f,o.m_correlationId=e,o}return __extends(t,n),t}(WebViewerBaseMessage),OnSpecialKeyWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.OnSpecialKey)||this;return r.m_key=i,r}return __extends(t,n),t}(WebViewerBaseMessage),GetCurrentMediaStatesWebViewerMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.GetCurrentMediaStates)||this;return f.m_slideIndex=i,f.m_slideId=r,f.m_mediaStates=u,f}return __extends(t,n),t}(WebViewerBaseMessage),GetPresentationPlaybackStateWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.GetPresentationPlaybackState)||this;return r.m_playbackState=i,r}return __extends(t,n),t}(WebViewerBaseMessage),OnPresentationPlaybackStateChangedWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.OnPresentationPlaybackStateChanged)||this;return r.m_playbackState=i,r}return __extends(t,n),t}(WebViewerBaseMessage),RejectedMessageWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.RejectedMessage)||this;return r.m_data=i,r}return __extends(t,n),t}(WebViewerBaseMessage),OnUlsLogWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.OnUlsLog)||this;return r.m_logs=i,r}return __extends(t,n),t}(WebViewerBaseMessage),OnNetworkHealthChangedWebViewerMessage=function(n){function t(t,i,r){var u=n.call(this,t,WebViewerMessageType.OnNetworkHealthChanged)||this;return u.m_isHealthy=i,u.m_addTimeoutTimeMs=r,u}return __extends(t,n),t}(WebViewerBaseMessage),OnBrowserEventMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.OnBrowserEvent)||this;return f.m_event=i,f.m_clientX=r,f.m_clientY=u,f}return __extends(t,n),t}(WebViewerBaseMessage),OnContentRefreshBeginMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.OnContentRefreshBegin)||this;return r.m_reason=i,r}return __extends(t,n),t}(WebViewerBaseMessage),OnExitSlideshowMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.OnExitSlideshow)||this;return f.m_slideId=i,f.m_slideIndex=r,f.m_isFromEndOfSlideshow=u,f}return __extends(t,n),t}(WebViewerBaseMessage),OnContextMenuMessage=function(n){function t(t,i,r){var u=n.call(this,t,WebViewerMessageType.OnContextMenu)||this;return u.m_clientX=i,u.m_clientY=r,u}return __extends(t,n),t}(WebViewerBaseMessage),OnPodSessionExpiredMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.OnPodSessionExpired)||this;return f.m_code=i,f.m_reason=r,f.m_podSessionId=u,f}return __extends(t,n),t}(WebViewerBaseMessage),OnRenderedToBufferMessage=function(n){function t(t,i,r){var u=n.call(this,t,WebViewerMessageType.OnRenderedToBuffer)||this;return u.m_slideIndex=i,u.m_img=r,u}return __extends(t,n),t}(WebViewerBaseMessage),RecordQosErrorMessage=function(n){function t(t,i,r,u,f,e,o,s){var h=n.call(this,t,WebViewerMessageType.RecordQosError)||this;return h.m_errorName=i,h.m_vetoName=r,h.m_isIntentional=u,h.m_isInternal=f,h.m_alertOnPillar=e,h.m_isSessionEndingError=o,h.m_durationMs=s,h}return __extends(t,n),t}(WebViewerBaseMessage),OnSlideViewBoundsChangedMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.OnSlideViewBoundsChanged)||this;return r.m_slideViewBounds=i,r}return __extends(t,n),t}(WebViewerBaseMessage),BlankSlideStateMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.BlankSlideState)||this;return r.m_blankSlideState=i,r}return __extends(t,n),t}(WebViewerBaseMessage),AadTokenRequestMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.AadTokenRequest)||this;return r.m_resourceId=i,r}return __extends(t,n),t}(WebViewerBaseMessage),CameoDetectedInPresentationMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.CameoDetectedInPresentation)||this;return r.m_fCameoDetectedInPresentation=i,r}return __extends(t,n),t}(WebViewerBaseMessage),CameoFrameRequestForSlideMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.CameoDetectedInPresentation)||this;return r.m_cameoInSlide=i,r}return __extends(t,n),t}(WebViewerBaseMessage),TakeControlWebViewerMessage=function(n){function t(t,i,r,u,f){var e=n.call(this,t,WebViewerMessageType.TakeControl)||this;return e.m_slideIndex=i,e.m_slideId=r,e.m_timeLineMappings=u,e.m_metadata=f,e}return __extends(t,n),t}(WebViewerBaseMessage),ErrorCategory;(function(n){n[n.Fatal=0]="Fatal";n[n.FatalDocument=1]="FatalDocument";n[n.FatalContent=2]="FatalContent";n[n.Informational=3]="Informational";n[n.ActionRequested=4]="ActionRequested"})(ErrorCategory||(ErrorCategory={}));var PresentRegionInfo=function(){function n(){}return n.getWacToPresentPreviewerMap=function(){var t={};return t[PodsRegionInfo.ffcUrl]=createPresentRegion(this.https+"present.edog.officeapps.live.com","1",1),t.edog=createPresentRegion(this.https+"present.edog.officeapps.live.com","1",1),t[PodsRegionInfo.ppcUrl]=createPresentRegion(this.https+"msit"+n.hostOSIPresentService,"2",1),t[PodsRegionInfo.uscUrl]=createPresentRegion(this.https+"usc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.brcUrl]=createPresentRegion(this.https+"brc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.eucUrl]=createPresentRegion(this.https+"euc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.cacUrl]=createPresentRegion(this.https+"canc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.ukcUrl]=createPresentRegion(this.https+"ukc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.aucUrl]=createPresentRegion(this.https+"ausc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.jpcUrl]=createPresentRegion(this.https+"jpc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.incUrl]=createPresentRegion(this.https+"inc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.krcUrl]=createPresentRegion(this.https+"krc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.frcUrl]=createPresentRegion(this.https+"frc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.sgcUrl]=createPresentRegion(this.https+"sgc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.eurppcUrl]=createPresentRegion(this.https+"euc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.zacUrl]=createPresentRegion(this.https+n.hostOSIPresentService.substring(1),"5",1),t[PodsRegionInfo.zacUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.aecUrl]=createPresentRegion(this.https+n.hostOSIPresentService.substring(1),"5",1),t[PodsRegionInfo.aecUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.qtcUrl]=createPresentRegion(this.https+n.hostOSIPresentService.substring(1),"5",1),t[PodsRegionInfo.qtcUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.decUrl]=createPresentRegion(this.https+"euc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.decUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.chcUrl]=createPresentRegion(this.https+"euc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.chcUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.nocUrl]=createPresentRegion(this.https+"euc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.nocUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.secUrl]=createPresentRegion(this.https+"euc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.secUrl].IsGoLocalRoutedToPublic=!0,t[PodsRegionInfo.plcUrl]=createPresentRegion(this.https+"euc"+n.hostOSIPresentService,"5",1),t[PodsRegionInfo.plcUrl].IsGoLocalRoutedToPublic=!0,t},n.shouldRouteToEdog=function(n,t){return!t||!t.SessionInformation?!1:t.SessionInformation.UiHostRing&&this.TeamsRingsInEdog.indexOf(t.SessionInformation.UiHostRing.toLowerCase())>=0?!0:this.HostsWithFFInEdog.indexOf(t.SessionInformation.HostName)>=0&&n===PodsRegionInfo.ffcUrl?!0:!1},n.tryGetPresentRegion=function(n,t){var i=n.substring(0,n.indexOf("/p/")),r=this.WacToPresentPreviewerMap[i.toLowerCase()];return this.shouldRouteToEdog(i.toLowerCase(),t)&&(r=this.WacToPresentPreviewerMap.edog),r},n.GetDefaultProdRegion=function(){return this.WacToPresentPreviewerMap[PodsRegionInfo.prodUrl]},n.getPresentRing=function(n){if(n.ApplicationUrl){var t=this.tryGetPresentRegion(n.ApplicationUrl,n);return t&&t.PreviewerRolloutRing?t.PreviewerRolloutRing:"-4"}return"-4"},n.getFlightingNumber=function(n){return n!=""&&n!=undefined?Math.abs(MathHelper.hash(n))/100%1:Math.random()},n.IsApplicationUrlUsGovRing=function(n){return n&&(n.PresentURL.indexOf("present.osi.office365.us")!=-1||n.PresentURL.indexOf("present.osi.apps.mil")!=-1)&&n.PreviewerRolloutRing=="6"},n.presentFlighting=function(n,t,i,r){if(i===void 0&&(i=0),window.location.search.indexOf("wdTestPresentService=1")>=0||window.location.hash.indexOf("wdTestPresentService=1")>=0)return createUsePresentDetails(!0,"Supported Region");if(t){if(t.RolloutPercentage<=0)return createUsePresentDetails(!1,"Present region Disabled");var u=this.getFlightingNumber(n);if(r!=null&&r.ULS.traceTag(508658514,logCategory.PptSession,logLevel.Info,"RolloutPercentage - "+i+"; RolloutNumber - "+u),i>=u)return createUsePresentDetails(!0,"Could use present as evaluated rollout number is less than rollout percent")}return createUsePresentDetails(!1,"Not yet enabled Region")},n.ShouldRerouteEdogToProd=window.location.search.indexOf("wdTestPresentFDInEdog")>=0?!1:!0,n.HostsWithFFInEdog=["TeamsiOS","OneDrive"],n.TeamsRingsInEdog=["ring0","ring0_s"],n.https="https://",n.hostOSIPresentService=".present.officeapps.live.com",n.WacToPresentPreviewerMap=n.getWacToPresentPreviewerMap(),n}(),ConditionalAction=function(){function n(n,t){var i=this;if(this.m_conditions={},t.length==0)throw Error("conditions");this.m_action=n;t.forEach(function(n){i.m_conditions[n]=!1})}return n.prototype.SetCondition=function(n){if(this.m_conditions[n]==null)throw Error("condition");this.m_conditions[n]=!0;this.CheckConditions()},n.prototype.AddNewCondition=function(n){if(n in this.m_conditions)throw Error("condition");this.m_conditions[n]=!1},n.prototype.GetCondition=function(n){if(this.m_conditions[n]==null)throw Error("condition");return this.m_conditions[n]},n.prototype.CheckConditions=function(){var n,t;if(this.m_action!=null){n=!0;for(t in this.m_conditions)n=n&&this.m_conditions[t];n&&(this.m_action(),this.m_action=null)}},n}(),PPTPreviewerBootstrapper=function(){function n(){var n=this;this.m_appErrors=[];this.m_awaitPresentationUrlStartTime=0;this.m_isPresentationUrlSet=!1;this.m_presentationUrlSetTimeout=0;this.s_previewerRingsWith100PercentSnap=["1","2","5"];this.onPresentationUrlSet=function(t,i){var r,u=undefined;if(!i){t.ULS.traceTag(554268612,logCategory.PptSession,logLevel.Error,"onPresentationUrlSet: data is null.");return}if(!i.url&&((r=i.metadata)===null||r===void 0?void 0:r.presenterErrorInfo))u=i.metadata.presenterErrorInfo;else if(n.m_isPresentationUrlSet){t.ULS.traceTag(544282375,logCategory.PptSession,logLevel.Info,"onPresentationUrlSet: m_isPresentationUrlSet is already true.");return}try{n.m_isPresentationUrlSet=!0;n.m_presentationUrlSetTimeout&&clearTimeout(n.m_presentationUrlSetTimeout);var f=i.isPresentationUrlEnabled||!1,e=i.url||"",o=i.metadata||{},s=(new Date).getTime(),h=s-n.m_awaitPresentationUrlStartTime,c=n.m_onPresentationUrlSetCreateViewerCallback!==undefined;t.ULS.traceTag(554268613,logCategory.PptSession,logLevel.Info,"onPresentationUrlSet: isPresentationUrlEnabled: "+f+"; presUrlLength: "+e.length+"; hasCallback: "+c+"; metadata: "+JSON.stringify(o)+"; startWaitingTime: "+n.m_awaitPresentationUrlStartTime+", elapsed: "+h+"; hasError: "+(u!==undefined)+";");n.m_onPresentationUrlSetCreateViewerCallback!==undefined?n.m_onPresentationUrlSetCreateViewerCallback(f,e,u):t.ULS.traceTag(544282376,logCategory.PptSession,logLevel.Error,"onPresentationUrlSet: m_onPresentationUrlSetCreateViewerCallback is undefined.")}catch(l){t.ULS.traceTag(554259402,logCategory.PptSession,logLevel.Error,"Exception in onPresentationUrlSet: "+JSON.stringify(l))}}}return n.TryLoadSlice=function(n,t,i,r){var u,f,o,s,e;try{return PreviewSessionLoader.s_previewAPIFactory?!0:(u=PPTBootstrapSettings.getAppMetadata(),f=PPTBootstrapSettings.viewerSliceBootstrapper(),u.Environment=="wac"&&(o=PPTBootstrapper.getWacStaticResourcesServer(n,t,i,r),f=o+u.WacCdnVersion+"_pptscripts/powerpoint.boot.vslice.js"),s=PPTPreviewerBootstrapperUtils.getTrustedScriptUrl(f,r,"VSlice",undefined),e=document.createElement("script"),e.src=s,document.head.insertBefore(e,document.head.firstChild),!0)}catch(h){return!1}},n.prototype.InitializeWopiPending=function(t){var ct=this,d,g,nt,tt,it,rt,a,o,i,h,ft,w,c,u,b,l,et,e,st,y,lt,ht,k,f;this.m_appErrors.length=0;this.m_awaitPresentationUrlStartTime=0;this.m_isPresentationUrlSet=!1;var at=Date.now(),vt=n.TryLoadSlice(t.ApplicationCustomSettings,t.ApplicationUrl,t.BootstrapperUrl,t),yt=Date.now(),s=undefined,r=undefined;try{a=PPTPreviewerBootstrapperUtils.sanitizeHostSessionId(t.SessionInformation.HostSessionId);t.ApplicationCustomSettings&&t.ApplicationCustomSettings.ForceHttp||(t.SessionInformation.HostSessionId=PPTBootstrapper.generateRandomUUID());(window.location.search.indexOf("wdTestPreviewer=1")>=0||window.location.hash.indexOf("wdTestPreviewer=1")>=0||window.location.search.indexOf("wdTestWacPreviewer=1")>=0)&&(o=new URLSearchParams(window.location.search),o.has("wdIsPresenter")&&(t.SessionInformation.IsPresenter=o.get("wdIsPresenter")==="1"),o.has("wdCallId")&&(t.SessionInformation.CallId=o.get("wdCallId")||"testdevcall"),o.has("wdDocId")&&(t.WopiPrecheckInfo.DocUniqueId=o.get("wdDocId")||t.WopiPrecheckInfo.FileGetUrl),o.has("wdPriViewToggle")&&((d=t===null||t===void 0?void 0:t.SessionInformation)===null||d===void 0?void 0:d.WdParams)&&(t.SessionInformation.WdParams.disableTeamsPptSharingPrivateViewingControlForPresenter=!0));PPTBootstrapper.ensureInitializeParametersAreTheRightType(t);t.ApplicationCustomSettings=n.InitAppSettingsWithDefaults(t);t.WopiPrecheckInfo.BundleInfo&&t.WopiPrecheckInfo.BundleInfo.Url||(t.WopiPrecheckInfo.BundleInfo={MajorVersion:0});t.PreviewerRolloutRing=PodsRegionInfo.getPodsRing(t);var v=PPTBootstrapper.getOnDemandServer(t),ut=!0,p="";if(((nt=(g=t===null||t===void 0?void 0:t.SessionInformation)===null||g===void 0?void 0:g.StateServiceSettings)===null||nt===void 0?void 0:nt.stateServiceSecret)&&!((tt=t===null||t===void 0?void 0:t.SessionInformation)===null||tt===void 0?void 0:tt.IsPresenter)||(p=PPTBootstrapper.getFileExtension(t.WopiPrecheckInfo.FileName),ut=PPTBootstrapper.isSupportedFileExtension(p)),!v)return this.failWithRegionNotFound(t,ut,a,p);h=PPTBootstrapperFeatureGatesHelper.getFeatureGates(t,null);h&&h.RemoteUlsExperimentEnabled?(i=s=ULS.getExperimentLogger(t.SessionInformation.HostSessionId,v+"RemoteUls.ashx",h.RemoteUlsExperimentUploadCadenceInMsSec!==undefined?h.RemoteUlsExperimentUploadCadenceInMsSec:6e4,h.RemoteUlsExperimentUploadTriggerSize!==undefined?h.RemoteUlsExperimentUploadTriggerSize:50),i.ULS.traceTag(0,logCategory.PptSession,logLevel.Info,"using experimental logger")):i=s=ULS.getLogger(t.SessionInformation.HostSessionId,v+"RemoteUls.ashx");i.ULS.traceTag(38286563,logCategory.PptSession,logLevel.Info,"Bootstrap - initializing session. Build version: "+this.GetVersion());i.ULS.traceTag(40206739,logCategory.PptSession,logLevel.Info,"Bootstrap - initializing session. Slice load initated: "+vt);i.ULS.traceTag(590140833,logCategory.PptSession,logLevel.Info,"Bootstrap - initializing session for Host Session Id:  "+a);ft=(new Date).getTime();i.ULS.traceTag(38286592,logCategory.PptSession,logLevel.Info,"Bootstrapper Init Time: "+ft);try{i.ULS.traceTag(507914331,logCategory.PptSession,logLevel.Info,"SharePoint Embed (embed.aspx): "+(location.pathname.indexOf("embed.aspx")>-1))}catch(pt){i.ULS.traceTag(507914330,logCategory.PptSession,logLevel.Warning,"Exception while detecting SharePoint Embed (embed.aspx): "+pt)}if(t=PPTPreviewerBootstrapperUtils.SanitizeInitialParameters(t,i),this.m_frameContainerContext=new FrameContainerContext(t,i),t!=null&&t.ApplicationCustomSettings!=null&&i.ULS.traceTag(593295124,logCategory.PptSession,logLevel.Info,"StartingSlideIndex: "+t.ApplicationCustomSettings.StartingSlideIndex),(t===null||t===void 0?void 0:t.SessionInformation)!=null&&(((rt=(it=t===null||t===void 0?void 0:t.SessionInformation)===null||it===void 0?void 0:it.StateServiceSettings)===null||rt===void 0?void 0:rt.stateServiceProxySettings)&&i.ULS.traceTag(543769175,logCategory.PptSession,logLevel.Info,"StateServiceSettings: "+JSON.stringify(t.SessionInformation.StateServiceSettings.stateServiceProxySettings)),i.ULS.traceTag(543769176,logCategory.PptSession,logLevel.Info,"EnableStateServiceInPreviewerFeatures: "+JSON.stringify(t.SessionInformation.EnableStateServiceInPreviewerFeatures))),this.windowVisibilityMetrics=new WindowVisibilityMetrics,w=PPTBootstrapper.getPostMessageToken(t.SessionInformation.HostSessionId),t.PostMessageToken=w,t.SnapRequestID="snapRequestID_"+PPTBootstrapper.generateRandomUUID(),c=n.ShouldUsePODS(t,i),n.LogShouldUsePodsOrCachedResult(c,t.ApplicationUrl,c.Reason,i),this.m_pptFeatureGates=PPTBootstrapperFeatureGatesHelper.getFeatureGates(t,i),u=t.ApplicationCustomSettings,u&&(u.DisabledChangeGates=PPTPreviewerBootstrapperFeatureGatesHelper.CombineDisabledChangeGates(u,this.m_pptFeatureGates)),t.HostSessionId=a,r=PPTBootstrapperLogger.initializeHealthLogger(t,v,i),!ut)return this.failWithUnsupportedFileExtension(t,i,r,p);if(this.m_pptFeatureGates&&!this.m_pptFeatureGates.AllowModernSlideShowBlockedScenarios&&PPTBootstrapper.isScenarioBlockedForModernSS(t,i)){f={errorType:"AppInitError",errorObject:"Platform not supported for modernSlideShow",Category:0,Code:12,ErrorName:"UnsupportedModernSlideShowPlatforms",EventType:13,ExtraInfo:"Modern slideshow cant run on old browsers and TSW Electron platforms",SessionId:t.SessionInformation.HostSessionId};PPTBootstrapperLogger.recordBootCompleted(t,12,"UnsupportedModernSlideShowPlatforms","Modern slideshow cant run on old browsers and TSW Electron platforms",i,Date.now(),[]);r===null||r===void 0?void 0:r.recordQosError(f.ErrorName,["FileOpenFailed"],!0,!0,!0,!0);t.FnOnInitializeFailure(f);return}b=TimeoutWrapper.addTimeoutWrappersToHostCallbacks(t,i,"Previewer",this.m_appErrors,r);l={};l.PostMessageToken=w;l.UsePODSDetails=c;l.HostSessionId=a;et=t;c.ShouldUsePODS||(l.FallbackPreBoot=!0,et=n.SanitizeInputParametersForFallbackLog(t));PPTBootstrapper.sendInitialLog(et,"Previewer",l,i);e=PPTBootstrapperFeatureGatesHelper.getStateServiceFeatureGates(t,i)||[];!this.m_pptFeatureGates.DisableStateServiceInking&&e.indexOf("Ink")<0&&t.SessionInformation.HostName!="MSTeams"&&PPTBootstrapper.isDoDRegion(t,i)&&t.SessionInformation.HostExperience!="SingleWindow"&&e.push("Ink");i.ULS.traceTag(558187592,logCategory.PptSession,logLevel.Info,"StateService enabledFeatures: "+(e?e.toString():"None"));try{this.trimEnabledStateServiceFeatures(t,e,i);this.m_awaitPresentationUrlStartTime=(new Date).getTime();e.length>0&&StateServiceClientLoader.TryLoadStateServiceClient(t,i,e,this.onPresentationUrlSet.bind(this,i),this.m_frameContainerContext,r,this.m_pptFeatureGates.DisableCachedStateServiceClientJS||!1,t.SessionInformation.StateServiceSettings)}catch(ot){i.ULS.traceTag(554259401,logCategory.PptSession,logLevel.Error,"PPTPreviewerBootstrapper: error in init StateServiceClient: "+JSON.stringify(ot))}if(c.ShouldUsePODS){if(!u){i.ULS.traceTag(554251101,logCategory.PptSession,logLevel.Info,"null ApplicationCustomSettings");throw Error("null ApplicationCustomSettings");}}else return i.ULS.traceTag(38836228,logCategory.PptSession,logLevel.Info,"Previewer unsupported region"),(u===null||u===void 0?void 0:u.EnableWacFallback)&&t.ApplicationUrl?(i.ULS.traceTag(38836229,logCategory.PptSession,logLevel.Info,"Previewer setting up wacFallbackController"),y=new WacFallbackController(t,!0,function(t,i){return n.GetWacPreviewURL(t,i)},null,i,this.windowVisibilityMetrics,w),st={Complete:function(n,t){y?y.wopiPendingApplicationComplete(n,t):null},Fail:function(n){y?y.wopiPendingApplicationFail(n):null}}):(i.ULS.traceTag(38836230,logCategory.PptSession,logLevel.Info,"Previewer returning error for unsupported region"),f={errorType:"AppInitError",errorObject:"Region not suppported",Category:0,Code:8,ErrorName:"RegionNotSupported",EventType:13,ExtraInfo:"Region not suppported"},r===null||r===void 0?void 0:r.recordQosError(f.ErrorName,["FileOpenFailed"],!0,!0,!0,!0),t.FnOnInitializeFailure(f),st={Complete:function(){},Fail:function(u){b.failByHost(t,i,u,ct.m_appErrors);r===null||r===void 0?void 0:r.recordQosError("AbortByHost",["FileOpenFailed"],!0,!1,!1,!0);n.WopiPendingFail(t.SessionInformation.HostSessionId,u,i)}}),st;return u.OnDemandServer=v,lt=PPTBootstrapSettings.getAppMetadata(),lt.Environment=="wac"&&(u.WacStaticResourcesServer=PPTBootstrapper.getWacStaticResourcesServer(u,t.ApplicationUrl,t.BootstrapperUrl,t)),ht={initWopiTime:at,bootstrapperInitTime:ft,sliceLoadTime:yt},n.s_prefetchStartTime>0&&(ht.prefetchStartTime=n.s_prefetchStartTime,n.s_prefetchStartTime=0),this.BootWithMeetingCoordination(t,e,i,ht,b,r),PPTBootstrapper.logBootstrapperPerformanceInfo(t.BootstrapperUrl,"PreviewerTSBoot",i),window.setTimeout(function(){i&&i.ULS.flush()},1e4),{Complete:function(){},Fail:function(u){b.failByHost(t,i,u,ct.m_appErrors);r===null||r===void 0?void 0:r.recordQosError("AbortByHost",["FileOpenFailed"],!0,!1,!1,!0);n.WopiPendingFail(t.SessionInformation.HostSessionId,u,i)}}}catch(ot){if(s&&(k=s,k.ULS.traceTag(38286593,logCategory.PptSession,logLevel.Error,"AppInitError: "+JSON.stringify(ot)),k.ULS.traceTag(590140832,logCategory.PptSession,logLevel.Error,"Host Session Id from Teams: "+t&&t.SessionInformation?t.SessionInformation.HostSessionId:""),k.ULS.flushOnClose()),f={errorType:"AppInitError",errorObject:ot,Category:0,Code:1,ErrorName:"InvalidInputParameters",EventType:13,ExtraInfo:"Exception caught"},r)try{r.recordQosError(f.ErrorName,["FileOpenFailed"],!1,!0,!0,!0)}catch(wt){s===null||s===void 0?void 0:s.ULS.traceTag(556097944,logCategory.PptSession,logLevel.Error,"Exception recording QoS error: "+JSON.stringify(wt))}t.FnOnInitializeFailure(f)}return undefined},n.prototype.failWithUnsupportedFileExtension=function(n,t,i,r){r.indexOf("mobileredirect=true")>-1&&t&&t.ULS.traceTag(508171088,logCategory.PptSession,logLevel.Info,"Unsupported file extension looks like a parsing error from a url");var u={errorType:"AppInitError",errorObject:"File type not supported",Category:0,Code:4,ErrorName:"UnsupportedFileTypeDetectedInBootstrapper",EventType:13,ExtraInfo:"Confirm ppt file type is received from Host",SessionId:n.SessionInformation.HostSessionId};return PPTBootstrapperLogger.recordBootCompleted(n,4,"UnsupportedFileTypeDetectedInBootstrapper","Unsupported fileType - host is not supposed to call init on this fileType",t,Date.now(),[]),i===null||i===void 0?void 0:i.recordQosError(u.ErrorName,["FileOpenFailed"],!0,!1,!1,!0),n.FnOnInitializeFailure(u),{Complete:function(){},Fail:function(){}}},n.prototype.failWithRegionNotFound=function(n,t,i,r){var u=ULS.getLogger(n.SessionInformation.HostSessionId,PodsRegionInfo.GetDefaultProdRegion().PodsURL+"RemoteUls.ashx"),f,e;return(u.ULS.traceTag(556869333,logCategory.PptSession,logLevel.Info,"Bootstrap - initializing session for Host Session Id:  "+i),u.ULS.traceTag(556869334,logCategory.PptSession,logLevel.Info,"Bootstrap - no onDemandServer for applicationUrl: "+n.ApplicationUrl.replace("https://","")),n.SessionInformation.UserId="",f=PPTBootstrapperLogger.initializeHealthLogger(n,PodsRegionInfo.GetDefaultProdRegion().PodsURL,u),!t)?this.failWithUnsupportedFileExtension(n,u,f,r):(e={errorType:"AppInitError",errorObject:"Region not suppported",Category:0,Code:8,ErrorName:"RegionNotSupported",EventType:13,ExtraInfo:"Confirm right applicationUrl is received from Host",SessionId:n.SessionInformation.HostSessionId},PPTBootstrapperLogger.recordBootCompleted(n,8,"RegionNotSupported","Region not supported. Check the ApplicationUrl",u,Date.now(),[]),f===null||f===void 0?void 0:f.recordQosError(e.ErrorName,["FileOpenFailed"],!0,!1,!1,!0),n.FnOnInitializeFailure(e),{Complete:function(){},Fail:function(){}})},n.prototype.trimEnabledStateServiceFeatures=function(t,i,r){var u,f,e,o,s,h;if(i.length!=0){h=t.Diagnostics?t.Diagnostics.entryPoint:"";h=="deepLink"&&i&&((u=this.m_pptFeatureGates)===null||u===void 0?void 0:u.DisabledScenariosForPresentationUrl)&&this.m_pptFeatureGates.DisabledScenariosForPresentationUrl.indexOf(h)>-1&&(n.removeStateServiceFeature("PresUrl",i,r,"DeepLink"),n.removeStateServiceFeature("PresUrlBoot",i,r,"DeepLink"));var c=i.indexOf("PresUrlBinary")>-1,l=t.WopiPrecheckInfo.FileName||"",a=PPTBootstrapper.isBinaryFile(l,r);a&&(c?(n.addStateServiceFeature("PresUrl",i,r,"BinaryFile"),n.addStateServiceFeature("PresUrlBoot",i,r,"BinaryFile")):(n.removeStateServiceFeature("PresUrl",i,r,"BinaryFile"),n.removeStateServiceFeature("PresUrlBoot",i,r,"BinaryFile")));((e=(f=t.SessionInformation)===null||f===void 0?void 0:f.WdParams)===null||e===void 0?void 0:e.isMovePrivateViewingToPPTEnabled)||n.removeStateServiceFeature("NavSync",i,r,"PVdisabled");((s=(o=t.SessionInformation)===null||o===void 0?void 0:o.WdParams)===null||s===void 0?void 0:s.disableTeamsPptSharingPrivateViewingControlForPresenter)?n.addStateServiceFeature("PriViewToggle",i,r,"ToggleButtonMovedToPpt"):n.removeStateServiceFeature("PriViewToggle",i,r,"ToggleButtonNotMovedToPpt");t.SessionInformation.EnableStateServiceInPreviewerFeatures=i}},n.removeStateServiceFeature=function(n,t,i,r){var u=t.indexOf(n);u>-1&&(t.splice(u,1),i.ULS.traceTag(542946185,logCategory.PptSession,logLevel.Info,"StateServiceFeatures: Removing "+n+"; reason:"+r+";"))},n.addStateServiceFeature=function(n,t,i,r){var u=t.indexOf(n);u<0&&(t.push(n),i.ULS.traceTag(542765315,logCategory.PptSession,logLevel.Info,"StateServiceFeatures: Adding "+n+"; reason:"+r+";"))},n.prototype.BootWithMeetingCoordination=function(n,t,i,r,u,f){var e=this,v,y,p,w,b,o=t.indexOf("PresUrlBoot")>-1,c=t.indexOf("PresUrl")>-1,d=t.indexOf("PresUrlBinary")>-1,l=((v=this.m_pptFeatureGates)===null||v===void 0?void 0:v.PresUrlBootTimeoutMS)!==undefined?this.m_pptFeatureGates.PresUrlBootTimeoutMS:4e3,h=n.SessionInformation.IsPresenter,g=n.WopiPrecheckInfo.FileName||"",s=PPTBootstrapper.isBinaryFile(g,i),k=this.s_previewerRingsWith100PercentSnap.indexOf(n.PreviewerRolloutRing)>=0,a;n.SessionInformation.WdParams&&n.SessionInformation.WdParams.wdDisableSnapForPreviewerTest&&(k=!1);s&&(l=((y=this.m_pptFeatureGates)===null||y===void 0?void 0:y.PresUrlBootTimeoutBinaryMS)!==undefined?this.m_pptFeatureGates.PresUrlBootTimeoutBinaryMS:3e4);i.ULS.traceTag(542946186,logCategory.PptSession,logLevel.Info,"BootWithMeetingCoordination Start. fUsePresUrlToBoot:"+o+"; fUsePresUrlDark:"+c+"; isPresenter:"+h+"; isBinary:"+s+"; fUsePresUrlBinary:"+d+"; waitTimeout:"+l+"; fSnapNonTeams:"+k);(o||c)&&h?(r.getPresentationUrlStartTime=Date.now(),PPTPreviewerGetPptFileData.getPresentationUrl(n,i,this.m_pptFeatureGates).then(function(t){var h,c,s;r.getPresentationUrlEndTime=Date.now();(t===null||t===void 0?void 0:t.presentationUrl)?(i.ULS.traceTag(554268609,logCategory.PptSession,logLevel.Info,"PresentationUrl: detected stateService flag so got presUrl, posting downward; elapsed: "+(r.getPresentationUrlEndTime-r.getPresentationUrlStartTime)+"."),c={m_type:"presentationUrl",m_url:t.presentationUrl,m_metadata:r},StateServiceClientLoader.SendMessage(c),o&&(n.WopiPrecheckInfo.PresentationUrl=t.presentationUrl,((h=e.m_pptFeatureGates)===null||h===void 0?void 0:h.DisableSnapToPodsRegionSpecificUrl)||!n.ApplicationCustomSettings||!n.ApplicationCustomSettings.OnDemandServer||(s=SnapUrlToPodsRegion.tryGetPodsRegionSpecificUrl(new URL(t===null||t===void 0?void 0:t.presentationUrl),i),i.ULS.traceTag(528868487,logCategory.PptSession,logLevel.Info,"PresentationUrl: podsDCSpecificUrl "+s+", pods url "+n.ApplicationCustomSettings.OnDemandServer),s!=""&&(n.ApplicationCustomSettings.OnDemandServer=s)))):(i.ULS.traceTag(554268610,logCategory.PptSession,logLevel.Error,"PresentationUrl: null response received from service, fail the session; elapsed: "+(r.getPresentationUrlEndTime-r.getPresentationUrlStartTime)+";"),e.HandleGetPresentationUrlError("Presentation Url missing in response",n,i,r,f));e.SendSnapAndCreateViewer(n,i,r,u,f,o)}).catch(function(t){e.HandleGetPresentationUrlError(t.message,n,i,r,f)})):o&&h===!1?(this.m_onPresentationUrlSetCreateViewerCallback=function(t,o,h){var c=t&&o!==undefined;i.ULS.traceTag(544282372,logCategory.PptSession,logLevel.Info,"PresentationUrl: onPresentationUrlSetCreateViewerCallback invoked. fUsePresUrl: "+c+", isPresUrlDefined:"+(o!=="")+"; isBinary:"+s+"; error: "+(h?JSON.stringify(h):""));h!==undefined?(f===null||f===void 0?void 0:f.recordQosError(h.ErrorName,["FileOpenFailed"],!1,!0,!0,!0),n.FnOnInitializeFailure(h)):(o&&(n.WopiPrecheckInfo.PresentationUrl=o),e.SendSnapAndCreateViewer(n,i,r,u,f,c));e.m_onPresentationUrlSetCreateViewerCallback=undefined},((w=(p=n===null||n===void 0?void 0:n.SessionInformation)===null||p===void 0?void 0:p.StateServiceSettings)===null||w===void 0?void 0:w.stateServiceSecret)||(this.m_presentationUrlSetTimeout=window.setTimeout(function(){e.m_isPresentationUrlSet||(e.m_isPresentationUrlSet=!0,i.ULS.traceTag(544282373,logCategory.PptSession,logLevel.Info,"PresentationUrl: Timeout after "+l+"ms, fallback to SPO boot; isBinary:"+s+"."),e.SendSnapAndCreateViewer(n,i,r,u,f,!1));e.m_onPresentationUrlSetCreateViewerCallback=undefined},l))):k?(r.getPresentationUrlStartTime=Date.now(),PPTPreviewerGetPptFileData.getPresentationUrl(n,i,this.m_pptFeatureGates).then(function(t){var s,o;r.getPresentationUrlEndTime=Date.now();(t===null||t===void 0?void 0:t.presentationUrl)?(n.WopiPrecheckInfo.PresentationUrl=t.presentationUrl,((s=e.m_pptFeatureGates)===null||s===void 0?void 0:s.DisableSnapToPodsRegionSpecificUrl)||!n.ApplicationCustomSettings||!n.ApplicationCustomSettings.OnDemandServer||(o=SnapUrlToPodsRegion.tryGetPodsRegionSpecificUrl(new URL(t===null||t===void 0?void 0:t.presentationUrl),i),i.ULS.traceTag(508948642,logCategory.PptSession,logLevel.Info,"PresentationUrl: podsDCSpecificUrl "+o+", pods url "+n.ApplicationCustomSettings.OnDemandServer),o!=""&&(n.ApplicationCustomSettings.OnDemandServer=o))):(i.ULS.traceTag(508948641,logCategory.PptSession,logLevel.Error,"PresentationUrl: null response received from service, fail the session; elapsed: "+(r.getPresentationUrlEndTime-r.getPresentationUrlStartTime)+";"),e.HandleGetPresentationUrlError("Presentation Url missing in response",n,i,r,f));e.SendSnapAndCreateViewer(n,i,r,u,f,!0)}).catch(function(t){var a,l;i.ULS.traceTag(508946523,logCategory.PptSession,logLevel.Warning,"getPresentationUrl failed with message:"+t.message);i.ULS.traceTag(508946522,logCategory.PptSession,logLevel.Info,"Boot without using presentationUrl. fUsePresUrlToBoot:"+o+"; fUsePresUrlDark:"+c+"; isPresenter:"+h+"; isBinary:"+s+";");e.SendSnapAndCreateViewer(n,i,r,u,f,o);!((a=e.m_pptFeatureGates)===null||a===void 0?void 0:a.DisableSnapToPodsRegionSpecificUrl)&&n.WopiPrecheckInfo.FileGetUrl&&n.ApplicationCustomSettings&&n.ApplicationCustomSettings.OnDemandServer&&(l=SnapUrlToPodsRegion.tryGetPodsRegionSpecificUrl(new URL(n.WopiPrecheckInfo.FileGetUrl),i),i.ULS.traceTag(508946521,logCategory.PptSession,logLevel.Info,"PresentationUrl: podsDCSpecificUrl "+l+", pods url "+n.ApplicationCustomSettings.OnDemandServer),l!=""&&(n.ApplicationCustomSettings.OnDemandServer=l))})):(i.ULS.traceTag(544282374,logCategory.PptSession,logLevel.Info,"Boot without using presentationUrl. fUsePresUrlToBoot:"+o+"; fUsePresUrlDark:"+c+"; isPresenter:"+h+"; isBinary:"+s+";"),this.SendSnapAndCreateViewer(n,i,r,u,f,o),!((b=this.m_pptFeatureGates)===null||b===void 0?void 0:b.DisableSnapToPodsRegionSpecificUrl)&&n.WopiPrecheckInfo.FileGetUrl&&n.ApplicationCustomSettings&&n.ApplicationCustomSettings.OnDemandServer&&(a=SnapUrlToPodsRegion.tryGetPodsRegionSpecificUrl(new URL(n.WopiPrecheckInfo.FileGetUrl),i),i.ULS.traceTag(528868488,logCategory.PptSession,logLevel.Info,"PresentationUrl: podsDCSpecificUrl "+a+", pods url "+n.ApplicationCustomSettings.OnDemandServer),a!=""&&(n.ApplicationCustomSettings.OnDemandServer=a)))},n.prototype.HandleGetPresentationUrlError=function(n,t,i,r,u){r.getPresentationUrlEndTime=Date.now();i.ULS.traceTag(540669892,logCategory.PptSession,logLevel.Error,"PresentationUrl: error getting PresUrl; fail the session: "+n+"; elapsed: "+(r.getPresentationUrlEndTime-r.getPresentationUrlStartTime));var f=ApplicationErrorMap.convertServerErrorToAppErrorCode(n,i),e={errorType:"AppInitError",errorObject:n,Category:0,Code:f!==5001?f:103,ErrorName:f!==5001?n:"GetPresentationUrlException",EventType:13,ExtraInfo:"Exception during getPresentationUrl: "+n,SessionId:t.SessionInformation.HostSessionId},o=__assign(__assign({},r),{presenterErrorInfo:e}),s={m_type:"presentationUrl",m_url:"",m_metadata:o};StateServiceClientLoader.SendMessage(s);u===null||u===void 0?void 0:u.recordQosError(e.ErrorName,["FileOpenFailed"],!1,!0,!0,!0);t.FnOnInitializeFailure(e)},n.prototype.SendSnapAndCreateViewer=function(t,i,r,u,f,e){PPTBootstrapper.getSlideShowKind(t,i)!="Modern"||e||this.SendSnapDownloadUrlRequest(t,i);this.m_frameContainerContext||(i.ULS.traceTag(528867784,logCategory.PptSession,logLevel.Info,"Bootstrap - create frameContainerContext in SendSnapAndCreateViewer"),this.m_frameContainerContext=new FrameContainerContext(t,i));i.ULS.traceTag(527958918,logCategory.PptSession,logLevel.Info,"Bootstraper - SendSnapAndCreateViewer");n.CreateViewer(t,this.m_frameContainerContext,i,r,this.m_appErrors,u,f)},n.prototype.SendSnapDownloadUrlRequest=function(t,i){var f,e,o,s,h,c,l;try{if(t==null||t.ApplicationCustomSettings==null||t.SessionInformation==null)return;var y=t.SessionInformation.HostSessionId||"",p=t.SessionInformation.HostName||"",w=t.SnapRequestID||"",a=t.SessionInformation.CallId||"",b=t.WopiPrecheckInfo.FileGetUrl||"",k=t.WopiPrecheckInfo.FileSize||0,d=t.WopiPrecheckInfo.ETag||"",g=t.WopiPrecheckInfo.DocUniqueId||"",nt=t.ApplicationCustomSettings.OnDemandServer||"",v=t.WopiPrecheckInfo.FileName||"",tt=PPTBootstrapper.isBinaryFile(v,i),it=t.ApplicationUrl,r=null,u="";try{u=SnapRegionInfo.getOnDemandSnapServer(t.ApplicationUrl,t);l=0;((f=this.m_pptFeatureGates)===null||f===void 0?void 0:f.SnapRolloutPercentageForSovereignCloud)&&((e=this.m_pptFeatureGates)===null||e===void 0?void 0:e.SnapRolloutPercentageForSovereignCloud)>0&&(l=(o=this.m_pptFeatureGates)===null||o===void 0?void 0:o.SnapRolloutPercentageForSovereignCloud);r=SnapRegionInfo.snapFlighting(t.ApplicationUrl,a,t,i,l);i.ULS.traceTag(540567008,logCategory.PptSession,logLevel.Info,"PPTPreviewerBootstrapper: snap region: "+u==null?"":u.replace("https://","").replace("http://",""));r&&(t.SessionInformation.UseSnapService=r.UseSnap,i.ULS.traceTag(540567009,logCategory.PptSession,logLevel.Info,"PPTPreviewerBootstrapper: snap region:"+r.UseSnap+", isenabled: "+r.Reason+" "))}catch(rt){i.ULS.traceTag(540567010,logCategory.PptSession,logLevel.Error,"PPTPreviewerBootstrapper: error in getting snap region: "+JSON.stringify(rt))}(tt||((s=this.m_pptFeatureGates)===null||s===void 0?void 0:s.DisableNewSnapService))&&(r=null,u="",t.SessionInformation.UseSnapService=!1);t.SessionInformation.SnapUrl=u;n.SendSnapDownloadUrlRequestCore("OnBoot",y,p,w,a,b,d,g,nt,u,r,v,(h=this.m_pptFeatureGates)===null||h===void 0?void 0:h.ForceMediaProtocol,(c=this.m_pptFeatureGates)===null||c===void 0?void 0:c.PdfLiveEnabled,i,k,it)}catch(ut){i.ULS.traceTag(588107799,logCategory.PptSession,logLevel.Error,"Exception in SendSnapDownloadUrlRequest: "+ut.message)}},n.SendSnapDownloadUrlRequestCore=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){var et=(new Date).getTime(),g,ut,d,b,ft;try{if(g=PPTBootstrapper.isBinaryFile(l,y),g){y&&y.ULS.traceTag(545887843,logCategory.PptSession,logLevel.Info,"Skiping call for binary files");return}}catch(nt){y===null||y===void 0?void 0:y.ULS.traceTag(545887872,logCategory.PptSession,logLevel.Error,"Exception in SendSnapDownloadUrlRequestCore while evaluating binary file extension: "+nt.message)}y===null||y===void 0?void 0:y.ULS.traceTag(588107801,logCategory.PptSession,logLevel.Info,"SendSnapDownloadUrlRequestCore with callId: "+u+"; triggerOrigin: "+n+"; snapRequestId: "+r+";");try{var ot=PPTBootstrapper.getFileExtension(l),k=PPTPreviewerBootstrapperUtils.createSnapRequestHeaders(t,i,r,u),tt=window.location.search.indexOf("wdAuthHeaderForHostDownloadEnabled")>=0,it=window.location.search.indexOf("wdUseSpoProxy")>=0,rt=w&&w.indexOf("https://")==0?w.substring(8,w.indexOf("/p/")):"";v&&ot.toLowerCase()=="pdf"?(d={ID:r,DownloadUrl:f,FileLengthHint:p,ETag:e,DocID:o,MultiRangeEnabled:!1,TailRangeEnabled:!0,AuthHeaderForHostDownloadEnabled:tt,SpoClientEnabled:it,FileType:"pdf",FileEnvironment:rt},b="",c!=null&&c.UseSnap?(y===null||y===void 0?void 0:y.ULS.traceTag(540567011,logCategory.PptSession,logLevel.Info,"SendSnapDownloadUrlRequestCore to snap service"),fetch(h+"SnapFileHandler.ashx",{method:"POST",headers:k,body:JSON.stringify(d)})):fetch(s+"SnapFileHandler.ashx",{method:"POST",headers:k,body:JSON.stringify(d)})):(ut={ID:r,DownloadUrl:f,FileLengthHint:p,ETag:e,DocID:o,MultiRangeEnabled:!1,TailRangeEnabled:!0,AuthHeaderForHostDownloadEnabled:tt,SpoClientEnabled:it,FileEnvironment:rt},b="",c!=null&&c.UseSnap?(y===null||y===void 0?void 0:y.ULS.traceTag(527979679,logCategory.PptSession,logLevel.Info,"SendSnapDownloadUrlRequestCore to snap service"),b=h+"SnapUrlHandler.ashx"):b=s+"SnapUrlHandler.ashx",a!==undefined&&(b=UrlUtils.addOrReplaceParameterValue(b,"forceMediaProtocol",a)),fetch(b,{method:"POST",headers:k,body:JSON.stringify(ut)}));y&&(ft={SendSnapDownloadUrlStart:et,SendSnapDownloadUrlEnd:(new Date).getTime(),CallId:u},y.ULS.traceTag(588107800,logCategory.PptSession,logLevel.Info,JSON.stringify(ft,PPTBootstrapper.undefinedReplacer)))}catch(nt){y===null||y===void 0?void 0:y.ULS.traceTag(577013019,logCategory.PptSession,logLevel.Error,"Exception in SendSnapDownloadUrlRequestCore: "+nt.message)}},n.InitAppSettingsWithDefaults=function(n){n.ApplicationCustomSettings||(n.ApplicationCustomSettings={});var t=n.ApplicationCustomSettings;return t.AddShadowBorder=!!t.AddShadowBorder,t.EnableAdvanceOnClick=tryReadBoolDefaultTrue(t.EnableAdvanceOnClick),t.EnableAutoAdvance=t.EnableAutoAdvance!=undefined?t.EnableAutoAdvance:PodsRegionInfo.getUiHost(n.SessionInformation.HostName)!="teams",t.EnableKeyboardNavigation=tryReadBoolDefaultTrue(t.EnableKeyboardNavigation),t.EnableWacFallback=tryReadBoolDefaultTrue(t.EnableWacFallback),t.ForceHttp=!!t.ForceHttp,t.PreserveDrawingBuffer=!!t.PreserveDrawingBuffer,t.TakeFocusOnBoot=tryReadBoolDefaultTrue(t.TakeFocusOnBoot),t.UseTransparentBackground=tryReadBoolDefaultTrue(t.UseTransparentBackground),t.EnableAdvanceOnTap=!!t.EnableAdvanceOnTap,t},n.WopiPendingFail=function(t,i,r){var u=i,e=u==null?"":u.message,f;r.ULS.traceTag(38286594,logCategory.PptSession,logLevel.Warning,"WopiPendingFail - message: "+e);f=u==null?!1:u.shutdownApp==!0;f&&n.CleanupWopiPending(t)},n.CleanupWopiPending=function(n){var i=PPTMessageListenerRegistry.getInstance(),t=i.get(n);t===null||t===void 0?void 0:t.Dispose()},n.SanitizeInputParametersForFallbackLog=function(n){return{BootstrapperUrl:n.BootstrapperUrl,Container:n.Container,PostMessageToken:n.PostMessageToken,PreviewerRolloutRing:n.PreviewerRolloutRing,SessionInformation:{HostName:n.SessionInformation.HostName,HostSessionId:n.SessionInformation.HostSessionId,UserId:""},ApplicationUrl:n.ApplicationUrl,WopiPrecheckInfo:{FileName:""},NewFileTemplateSource:{},ApplicationCustomSettings:n.ApplicationCustomSettings,Diagnostics:n.Diagnostics,FnOnInitializeSuccess:n.FnOnInitializeSuccess,FnOnInitializeFailure:n.FnOnInitializeFailure}},n.ShouldUsePODS=function(n,t){var i;return window.location.search.indexOf("wdTestWac=1")>=0||window.location.search.indexOf("wdTestWac=1")>=0?createUsePODSDetails(!1,!1,"wdTestWac set to true in Host Page URL"):((i=n.ApplicationCustomSettings)===null||i===void 0?void 0:i.OnDemandServer)?createUsePODSDetails(!0,!0,"OnDemandServer provided by Host"):!n.ApplicationUrl&&n.SessionInformation.HostName!="MSTeams"&&n.SessionInformation.HostName!="TeamsiOS"&&n.SessionInformation.HostName!="apiTest"&&n.SessionInformation.HostName!="TeamsAndroid"?createUsePODSDetails(!1,!1,"No Application URL provided (Sharepoint)"):n.ApplicationUrl?window.location.search.indexOf("wdTestPreviewer=1")>=0||window.location.hash.indexOf("wdTestPreviewer=1")>=0||window.location.search.indexOf("wdTestWacPreviewer=1")>=0?createUsePODSDetails(!0,!0,"wdTestPreviewer set to true in Host Page URL"):PPTBootstrapper.podsFlighting(n,t):createUsePODSDetails(!0,!0,"No Application URL provided")},n.LogShouldUsePodsOrCachedResult=function(n,t,i,r){var u={ShouldUsePods:n.ShouldUsePODS,CanUsePods:n.CanUsePODS,ApplicationUrl:PPTBootstrapper.extractHostname(t),Reason:i};r.ULS.traceTag(38286595,logCategory.PptSession,logLevel.Info,JSON.stringify(u))},n.GetWacPreviewURL=function(n,t){var i,u,f,r;return n.WopiSrc.indexOf("PowerPointFrame.aspx")>=0&&(i=n.WopiSrc.substr(n.WopiSrc.indexOf("WOPISrc=")+8),u=i.indexOf("&"),n.WopiSrc=u<0?decodeURIComponent(decodeURI(i)):decodeURIComponent(i.substring(0,u))),f=t.ApplicationUrl.indexOf("?"),r=t.ApplicationUrl.substring(0,f)+"?PowerPointView=ReadingView&wdnc=1&wdEnableRoaming=1&wdo=1",r=PPTBootstrapper.appendCommonFrameUrlQueryParams(r,t),PPTPreviewerBootstrapperUtils.AppendCommonFallbackQueryParams(r,t,n.WopiSrc)},n.prototype.InitializePodsExisting=function(t){var s=n.TryLoadSlice(t.ApplicationCustomSettings,t.ApplicationUrl,t.BootstrapperUrl,t),i,r,e,u,f,o;t.WopiPrecheckInfo.BundleInfo||(t.WopiPrecheckInfo.BundleInfo={MajorVersion:0});t.ApplicationCustomSettings=n.InitAppSettingsWithDefaults(t);!t.ApplicationCustomSettings.OnDemandServer&&window.location.href&&(t.ApplicationCustomSettings.OnDemandServer=window.location.href.split("SlideShowFrame.html")[0]);i=ULS.getLogger(t.SessionInformation.HostSessionId,t.ApplicationCustomSettings.OnDemandServer+"RemoteUls.ashx");i.ULS.traceTag(40206740,logCategory.PptSession,logLevel.Info,"Bootstrap - initializing PodsExisting. Slice load initated: "+s);PPTBootstrapper.sendInitialLog(t,"Slide Show",null,i);r=PPTBootstrapSettings.getAppMetadata();r&&r.Environment=="wac"&&(t.ApplicationCustomSettings.WacStaticResourcesServer=PPTBootstrapper.getWacStaticResourcesServer(t.ApplicationCustomSettings,t.ApplicationUrl,t.BootstrapperUrl,t));e={podsSessionId:t.WopiPrecheckInfo.PodSessionId};i.ULS.traceTag(38540374,logCategory.PptSession,logLevel.Info,JSON.stringify(e));u=PPTMessageListenerRegistry.getInstance().get(t.SessionInformation.HostSessionId);u&&(i.ULS.traceTag(39416217,logCategory.PptSession,logLevel.Error,"InitializePodsExisting found a session already created for this id. Disposing it"),u.DisposePreloadedApp());this.m_frameContainerContext=new FrameContainerContext(t,i);f=new PreviewSessionLoader(t,this.m_frameContainerContext,i,r,this.m_appErrors,!1);f.LoadApp(t.WopiPrecheckInfo.PodSessionId,!1,{});o=t.ApplicationCustomSettings&&t.ApplicationCustomSettings.AllowExternalMarketplace!=undefined?!!t.ApplicationCustomSettings.AllowExternalMarketplace:!0;f.LaunchFromSlide({PresentationId:t.WopiPrecheckInfo.PodSessionId,StartingSlideId:t.ApplicationCustomSettings.StartingSlideId,StartingSlideIndex:t.ApplicationCustomSettings.StartingSlideIndex,Diagnostics:t.Diagnostics,SendInitialLog:!1,StreamVideoUseThinEmbed:!1,DisabledChangeGates:t.ApplicationCustomSettings.DisabledChangeGates,AreThirdPartyAddInsAllowed:!!t.ApplicationCustomSettings.AreThirdPartyAddInsAllowed,AllowExternalMarketplace:o});PPTBootstrapper.logBootstrapperPerformanceInfo(t.BootstrapperUrl,"InitializePodsExisting",i)},n.prototype.PreloadApp=function(t){var e=(new Date).getTime(),o=n.TryLoadSlice(t.ApplicationCustomSettings,t.ApplicationUrl,t.BootstrapperUrl,t),i,r,u,f;return t.WopiPrecheckInfo.BundleInfo||(t.WopiPrecheckInfo.BundleInfo={MajorVersion:0}),t.ApplicationCustomSettings=n.InitAppSettingsWithDefaults(t),i=ULS.getLogger(t.SessionInformation.HostSessionId,t.ApplicationCustomSettings.OnDemandServer+"RemoteUls.ashx"),i.ULS.traceTag(40206741,logCategory.PptSession,logLevel.Info,"Bootstrap - initializing session. Slice load initated: "+o),PPTBootstrapper.sendInitialLog(t,"Preload App",null,i),r=PPTBootstrapSettings.getAppMetadata(),r.Environment=="wac"&&(t.ApplicationCustomSettings.WacStaticResourcesServer=PPTBootstrapper.getWacStaticResourcesServer(t.ApplicationCustomSettings,t.ApplicationUrl,t.BootstrapperUrl,t)),this.m_frameContainerContext=new FrameContainerContext(t,i),u=new PreviewSessionLoader(t,this.m_frameContainerContext,i,r,this.m_appErrors,!1),u.LoadApp(null,!0,{}),f={PreloadAppFunctionStart:e,PreloadAppFunctionEnd:(new Date).getTime()},i.ULS.traceTag(38286596,logCategory.PptSession,logLevel.Info,JSON.stringify(f,PPTBootstrapper.undefinedReplacer)),PPTBootstrapper.logBootstrapperPerformanceInfo(t.BootstrapperUrl,"PreloadApp",i),u},n.prototype.GetVersion=function(){return BuildVersionConfig.BUILD_NUMBER},n.GetMinContentVersion=function(){return 1},n.Prefetch=function(t){n.s_prefetchStartTime=(new Date).getTime();n.prefetchRequiredOnly(t,[])},n.prefetchRequiredOnly=function(t,i){var e=(t===null||t===void 0?void 0:t.IsLegacyAspxInTeamsEnabled)!=null&&(t===null||t===void 0?void 0:t.IsLegacyAspxInTeamsEnabled),o=!!(t===null||t===void 0?void 0:t.IsModernSlideShowInTeamsEnabled),r=[],u,f;r=e?o?["pptscripts/slideshowapp.js","pptscripts/slideshowui.js",]:["pptscripts/microsoftajax.js","pptscripts/bootview.js","pptscripts/WebViewerPreboot.js","pptscripts/ppt.slideshowplayer.api.js","pptscripts/ppt.inkcanvasmanager.js","pptscripts/transitions.js","pptscripts/ppttelemetry.js"]:["powerpointframe.html"];u=PPTBootstrapSettings.getAppMetadata();t&&u.Environment!="wac"&&r.push("AppMetadata.js");f=r.concat(i);n.PrefetchSpecifiedResources(t,f)},n.PrefetchSpecifiedResources=function(t,i){var u=PPTBootstrapSettings.getAppMetadata(),r=null;r=(t===null||t===void 0?void 0:t.IsModernSlideShowInTeamsEnabled)?PPTBootstrapper.getWacStaticResourcesServer(null,null,t===null||t===void 0?void 0:t.BootstrapperUrl,null)+u.WacCdnVersion+"_":PPTBootstrapper.getWacStaticResourcesServer(null,null,t===null||t===void 0?void 0:t.BootstrapperUrl,null)+u.WacCdnVersion+"_slideshowresources/";i.forEach(function(t){try{ViewerBrowserUtils.SupportPreloadLink()?t==="powerpointframe.html"?n.CreatePrefetchLink(r+t):n.CreatePreloadLink(r+t,"script"):n.CreatePrefetchLink(r+t)}catch(i){}})},n.CreatePreloadLink=function(n,t){var i=document.createElement("link");i.rel="preload";i.href=n;t!==""&&i.setAttribute("as",t);document.getElementsByTagName("head")[0].appendChild(i)},n.CreatePrefetchLink=function(n){var t=document.createElement("link");t.rel="prefetch";t.href=n;document.getElementsByTagName("head")[0].appendChild(t)},n.CreateViewer=function(n,t,i,r,u,f,e){var h,a,v,o,c,l,s;if(r.createViewerTime=Date.now(),a=PPTBootstrapSettings.getAppMetadata(),v=PPTBootstrapper.getOnDemandServer(n),i=ULS.getLogger(n.SessionInformation.HostSessionId,v+"RemoteUls.ashx"),!n.WopiPrecheckInfo.FileGetUrl){o={EventType:13,Code:10,ErrorName:"MissingFileGetUrl",Category:0,ExtraInfo:"",SessionId:n.SessionInformation.HostSessionId,errorType:"AppInitError",errorObject:"wopiPrecheckInfo.FileGetUrl not included"};e===null||e===void 0?void 0:e.recordQosError(o.ErrorName,["FileOpenFailed"],!1,!1,!0,!0);n.FnOnInitializeFailure(o);return}if(!n.Container){o={EventType:13,Code:11,ErrorName:"NoAppContainer",Category:0,ExtraInfo:"",SessionId:n.SessionInformation.HostSessionId,errorType:"AppInitError",errorObject:"Container"};e===null||e===void 0?void 0:e.recordQosError(o.ErrorName,["FileOpenFailed"],!1,!1,!0,!0);n.FnOnInitializeFailure(o);return}if(c="",(h=n.SessionInformation)===null||h===void 0?void 0:h.WdParams)for(l in n.SessionInformation.WdParams)c=c+"&"+l+"="+n.SessionInformation.WdParams[l];var p=BrowserUtils.devicePixelRatio(),w=n.ApplicationCustomSettings.AddShadowBorder?10:0,b=n.Container.getBoundingClientRect(),y="";n.WopiPrecheckInfo.BundleInfo&&(n.WopiPrecheckInfo.BundleInfo.Url=undefined,i.ULS.traceTag(38540377,logCategory.PptSession,logLevel.Info,"Cleared bundle info url"));s=new PreviewSessionLoader(n,t,i,a,u,!0,f,e);s.LoadApp(y,!1,r);s.LaunchFromSlide({PresentationId:y,StartingSlideId:n.ApplicationCustomSettings.StartingSlideId,StartingSlideIndex:n.ApplicationCustomSettings.StartingSlideIndex,Diagnostics:n.Diagnostics,SendInitialLog:!1,StreamVideoUseThinEmbed:!1,DisabledChangeGates:n.ApplicationCustomSettings.DisabledChangeGates,AreThirdPartyAddInsAllowed:n.ApplicationCustomSettings.AreThirdPartyAddInsAllowed!=null?n.ApplicationCustomSettings.AreThirdPartyAddInsAllowed:!1,AllowExternalMarketplace:n.ApplicationCustomSettings.AllowExternalMarketplace!=null?n.ApplicationCustomSettings.AllowExternalMarketplace:!1});r.bootstrapperInitTime&&s.RecordBootStrapperInitTime(r.bootstrapperInitTime)},n.s_prefetchStartTime=0,n}();var PPTPreviewerBootstrapperUtils=function(){function n(){}return n.SanitizeInitialParameters=function(t,i){return n.SanitizeInitialParametersInternal(t,i,!1)},n.SanitizeInitialParametersInternal=function(t,i,r){var u=t.SessionInformation,o,f,e;if(!u)throw"SessionInformation missing from init params";if(u.DocumentClickTime)try{o=u.DocumentClickTime.getTime()}catch(s){i.ULS.traceTag(508347349,logCategory.PptSession,logLevel.Warning,"DocumentClickTime was not of type Date");t.SessionInformation.DocumentClickTime=undefined}u.HostName=="TeamsAndroid"&&(!u.ContentId&&t.ContentID&&(t.SessionInformation.ContentId=t.ContentID),!u.UserId&&t.UserId&&(t.SessionInformation.UserId=t.UserId),!u.TenantId&&t.TenantId&&(t.SessionInformation.TenantId=t.TenantId),!u.EndpointId&&t.EndpointID&&(t.SessionInformation.EndpointId=t.EndpointID),!u.IsPresenter&&t.IsPresenter&&(t.SessionInformation.IsPresenter=t.IsPresenter));u.WdParams||(t.SessionInformation.WdParams={});t.SessionInformation.ParticipantId&&!n.isGuidFormat(t.SessionInformation.ParticipantId)&&(i.ULS.traceTag(508347353,logCategory.PptSession,logLevel.Warning,"ParticipantId does not look like a guid"),r&&(t.SessionInformation.ParticipantId="SCRUBBED"));t.SessionInformation.TenantId&&!n.isGuidFormat(t.SessionInformation.TenantId)&&(i.ULS.traceTag(508347352,logCategory.PptSession,logLevel.Warning,"TenantId does not look like a guid"),r&&(t.SessionInformation.TenantId="SCRUBBED"));t.SessionInformation.ContentId&&!n.isGuidFormat(t.SessionInformation.ContentId)&&(i.ULS.traceTag(508347351,logCategory.PptSession,logLevel.Warning,"ContentId does not look like a guid"),r&&(t.SessionInformation.ContentId="SCRUBBED"));t.SessionInformation.EndpointId&&!n.isGuidFormat(t.SessionInformation.EndpointId)&&(i.ULS.traceTag(508347350,logCategory.PptSession,logLevel.Warning,"EndpointId does not look like a guid"),r&&(t.SessionInformation.EndpointId="SCRUBBED"));u.UserId!=undefined&&n.shouldScrubUserId(u.UserId)&&(t.SessionInformation.UserId="");try{if(u.HostName=="TeamsiOS"){if(u.WdParams)for(f in t.SessionInformation.WdParams)(t.SessionInformation.WdParams[f]==="0"||t.SessionInformation.WdParams[f]==="false")&&(i.ULS.traceTag(546182108,logCategory.PptSession,logLevel.Info,"Converting "+f+" from "+t.SessionInformation.WdParams[f]+" to false"),t.SessionInformation.WdParams[f]=!1),(t.SessionInformation.WdParams[f]==="1"||t.SessionInformation.WdParams[f]==="true")&&(i.ULS.traceTag(546182109,logCategory.PptSession,logLevel.Info,"Converting "+f+" from "+t.SessionInformation.WdParams[f]+" to true"),t.SessionInformation.WdParams[f]=!0);e=String(t.SessionInformation.IsPresenter);(e==="0"||e==="false")&&(t.SessionInformation.IsPresenter=!1);(e==="1"||e==="true")&&(t.SessionInformation.IsPresenter=!0);t.SessionInformation.CallId&&(t.SessionInformation.CallId=t.SessionInformation.CallId.toLowerCase());t.SessionInformation.ContentId&&(t.SessionInformation.ContentId=t.SessionInformation.ContentId.toLowerCase());t.SessionInformation.ParticipantId&&(t.SessionInformation.ParticipantId=t.SessionInformation.ParticipantId.toLowerCase())}}catch(s){i.ULS.traceTag(546182110,logCategory.PptSession,logLevel.Warning,"Exception trying to parse iOS session params")}return t},n.isGuidFormat=function(n){return n.length==36&&n.charAt(8)=="-"&&n.charAt(13)=="-"&&n.charAt(18)=="-"&&n.charAt(23)=="-"},n.shouldScrubUserId=function(n){if(n.indexOf("8:live")>-1||n.indexOf("8:")==0&&n.indexOf(":",2)==-1)return!0;var t=n.replace(/8:(teamsvisitor|gcch|orgid|dod|live:.cid|live|guest):/,"");return t.length!=36&&t.length!=32&&t.length!=16?!0:!1},n.sanitizeHostSessionId=function(t){return n.isGuidFormat(t)?t:"SCRUBBED"},n.AppendCommonFallbackQueryParams=function(n,t,i){return t.SessionInformation.HostSessionId&&(n=UrlUtils.addOrReplaceParameterValue(n,"hid",t.SessionInformation.HostSessionId)),i&&(n=UrlUtils.addOrReplaceParameterValue(n,"WOPISrc",UrlUtils.urlKeyValueEncode(i))),n},n.IsTeamsPreviewerSession=function(n,t){return!t&&!!n&&!!n.SessionInformation&&!!n.SessionInformation.HostName&&n.SessionInformation.HostName.indexOf("Teams")>=0},n.createSnapRequestHeaders=function(n,t,i,r){var u=new Headers;return u.append("X-UserSessionId",n),u.append("callercorrelationid",i),u.append("X-WacNoAuth","1"),u.append("Scenario","Previewer"),u.append("Client",t+"-Bootstrapper"),u.append("Content-Type","application/json; charset=utf-8"),u.append("CallId",r),u},n.tryGetHostNetworkMetricsFromCallback=function(n,t){var i,r;try{if(!t)return;((i=n===null||n===void 0?void 0:n.SessionInformation)===null||i===void 0?void 0:i.WdParams)?n.SessionInformation.WdParams.enablePptSharingNetworkHealthMetricsCallback&&n.FnGetHostNetworkMetrics&&(t.ULS.traceTag(555045533,logCategory.PptSession,logLevel.Info,"PPTPreviewerBootstrapperUtils::tryGetHostNetworkMetricsFromCallback - call FnGetHostNetworkMetrics"),r=(new Date).getTime(),n.FnGetHostNetworkMetrics().then(function(n){var i=(new Date).getTime()-r;t.ULS.traceTag(555045534,logCategory.PptSession,logLevel.Info,"PPTPreviewerBootstrapperUtils::tryGetHostNetworkMetricsFromCallback - FnGetHostNetworkMetrics network metrics: "+JSON.stringify(n)+". callbackDuration: "+i)}).catch(function(n){t.ULS.traceTag(555045535,logCategory.PptSession,logLevel.Error,"PPTPreviewerBootstrapperUtils::tryGetHostNetworkMetricsFromCallback - exception when executing FnGetHostNetworkMetrics: "+n)})):t.ULS.traceTag(555045536,logCategory.PptSession,logLevel.Error,"PPTPreviewerBootstrapperUtils::tryGetHostNetworkMetricsFromCallback - no valid initParams")}catch(u){t&&t.ULS.traceTag(555045537,logCategory.PptSession,logLevel.Error,"PPTPreviewerBootstrapperUtils::tryGetHostNetworkMetricsFromCallback - exception when calling FnGetHostNetworkMetrics: "+u)}},n.getTrustedScriptUrl=function(n,t,i,r){var e,o,f="PPTPreviewerBootstrapperUtils::getTrustedScriptUrl-"+i,s,h,u;try{if(s=((o=(e=t.SessionInformation)===null||e===void 0?void 0:e.WdParams)===null||o===void 0?void 0:o.enablePptLiveTrustedScriptUrl)||!1,!s)return n;if(t.FnGetTrustedScriptUrl&&(h=(new Date).getTime(),r&&r.ULS.traceTag(512493647,logCategory.PptSession,logLevel.Info,f+" - start try GetTrustedScriptUrl; dirtyStringLength: "+n.length+";"),u=t.FnGetTrustedScriptUrl(n),r&&r.ULS.traceTag(512493646,logCategory.PptSession,logLevel.Info,f+" - got TrustedScriptUrlLength: "+(u?u.toString().length:0)+"; elapsed: "+((new Date).getTime()-h)+"ms"),u))return u}catch(c){r&&r.ULS.traceTag(512493645,logCategory.PptSession,logLevel.Error,f+" - Exception getting TrustedScriptUrl: "+c)}return r&&r.ULS.traceTag(512493648,logCategory.PptSession,logLevel.Error,f+" - not able to get TrustedScriptUrl, return dirtyUrl."),n},n}(),PreviewSessionLoader=function(){function n(t,i,r,u,f,e,o,s){if(this.m_startingSlideId=-1,this.m_startingSlideIndex=-1,this.m_vetoAppSettingsStr="",this.m_disabledTransitionsList="",this.m_customTransitionResourceUrl="",this.m_streamUseThinEmbed=!1,this.m_disabledChangeGates="",this.m_iframe=null,this.m_bootTimingDict={},this.m_appBootTimingDict={},this.m_contentMetadata=null,this.m_appInitDiagnostics={},this.m_iframeReadyForPostMessage=!1,this.m_fShouldUseLegacySlideShowAspx=!1,this.m_slideshowKind="",this.m_iframeLoadTimeout=undefined,this.m_retryPreviewerTimeout=undefined,this.m_bootCompleted=!1,this.c_appErrorThrottleCount=5,this.c_iframeLoaded="iframeLoaded",this.c_contentMetadataLoadedOrDoesNotExist="contentMetadataLoaded",this.c_activated="activated",this.c_minHeight=100,this.c_minIframeHeight=100,this.m_callbackIframeLoadFailed={errorType:"AppInitError",errorObject:"Failed to load iframe",Category:0,Code:101,ErrorName:"FailedToLoadIframe",EventType:13,ExtraInfo:"Iframe load Error"},!t)throw Error("initParams is null");if(!t.SessionInformation.HostSessionId)throw Error("sessionId is null");this.m_apiId=t.SessionInformation.HostSessionId;this.m_appMetaData=u;this.m_apiStartTime=Date.now();this.m_logger=r;this.m_appErrors=f;this.m_healthLogger=s;this.m_frameContainerContext=i;o&&(o.setAppInitDiagnostics(this.m_appInitDiagnostics),this.m_timeoutWrapper=o);t.ApplicationCustomSettings&&!t.ApplicationCustomSettings.OnDemandServer&&(t.ApplicationCustomSettings.OnDemandServer=PPTBootstrapper.getOnDemandServer(null));this.m_initParams=t;this.m_fShouldUseLegacySlideShowAspx=e;this.m_slideshowKind=PPTBootstrapper.getSlideShowKind(this.m_initParams,r);this.m_frameContainerContext.slideshowKind=this.m_slideshowKind;this.m_frameContainerContext.shouldUseAspxForLegacy=this.m_fShouldUseLegacySlideShowAspx;this.m_anchor=t.Container;t.ApplicationCustomSettings?(this.m_fVariableWidth=!n.FIsUintValid(t.ApplicationCustomSettings.Width),this.m_fVariableHeight=!n.FIsUintValid(t.ApplicationCustomSettings.Height),this.m_startingSlideId=t.ApplicationCustomSettings.StartingSlideId||-1,this.m_startingSlideIndex=t.ApplicationCustomSettings.StartingSlideIndex||-1):(this.m_fVariableWidth=!0,this.m_fVariableHeight=!0);t.Diagnostics&&t.Diagnostics.userClickTime?this.m_bootTimingDict.DocumentClickTime=t.Diagnostics.userClickTime:t.SessionInformation.DocumentClickTime&&(this.m_bootTimingDict.DocumentClickTime=t.SessionInformation.DocumentClickTime.getTime());r.ULS.traceTag(556057426,logCategory.PptSession,logLevel.Info,"PreviewerSessionLoader starting with shouldUseAspxPage:"+this.m_fShouldUseLegacySlideShowAspx.toString()+", slideshowKind:"+this.m_slideshowKind);this.m_slideShowLoader=new SlideShowLoader(t,this.m_frameContainerContext,r,u);this.m_pptFeatureGates=PPTBootstrapperFeatureGatesHelper.getFeatureGates(this.m_initParams,this.m_logger);PPTMessageListenerRegistry.getInstance().get(this.m_apiId)&&r.ULS.traceTag(39203528,logCategory.PptSession,logLevel.Error,"PreviewSessionLoader is about to overwrite value in PPTMessageListenerRegistry");PPTMessageListenerRegistry.getInstance().add(this.m_apiId,this,!0,"PreviewSessionLoader")}return n.FIsUintValid=function(n){return!(n==null||n<0||isNaN(n))},n.UpdateBaseIframe=function(n,t,i,r){t.id="pptframe-"+n;t.frameBorder="0";t.style.top=HTMLHelper.toPx(0);t.style.bottom=HTMLHelper.toPx(0);t.style.left=HTMLHelper.toPx(0);t.style.right=HTMLHelper.toPx(0);t.style.width=HTMLHelper.floatToPercent(1);t.style.height=HTMLHelper.floatToPercent(1);t.setAttribute("allowfullscreen",(!0).toString());t.setAttribute("allowTransparency",(!0).toString());var u="autoplay "+i;return r||(u=u+"; microphone *"),t.setAttribute("allow",u),t},n.prototype.registerOnLoadEvent=function(){var n=this;this.removeIframeOnLoadEvent();this.m_onLoad=function(){return n.OnIframeLoaded()};this.m_iframe.addEventListener("load",this.m_onLoad,!1)},n.prototype.registerOnUnloadEvent=function(){var n=this;this.m_iframe.addEventListener("unload",function(){n.m_logger.ULS.traceTag(588044115,logCategory.PptSession,logLevel.Warning,"Unloading previewer iframe");n.m_appErrors.length>0&&n.m_logger.ULS.traceTag(588044114,logCategory.PptSession,logLevel.Warning,JSON.stringify(n.m_appErrors));n.m_logger.ULS.flushOnClose()})},n.prototype.registerOnLoadErrorEvent=function(){var n=this;this.m_onLoadError=function(){return n.OnIframeLoadError()};this.m_iframe.addEventListener("error",this.m_onLoadError,!1)},n.prototype.removeIframeOnLoadEvent=function(){this.m_onLoad&&this.m_iframe.removeEventListener("load",this.m_onLoad)},n.prototype.OnIframeLoaded=function(){var n=this;this.m_logger.ULS.traceTag(39416209,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::OnIframeLoaded");this.m_bootTimingDict.iFrameOnloadEventInApi=Date.now();this.m_iframeReadyForPostMessage||(this.m_iframeLoadTimeout=window.setTimeout(function(){return n.IframeLoadTimeout()},15e3))},n.prototype.OnIframeLoadError=function(){this.m_logger.ULS.traceTag(590424142,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::OnIframeLoadError : iframe Id: "+this.m_iframe.id);this.m_healthLogger&&this.m_healthLogger.recordQosError(this.m_callbackIframeLoadFailed.ErrorName,["FileOpenFailed"],!1,!0,!0,!0);this.m_initParams.FnOnInitializeFailure&&this.m_initParams.FnOnInitializeFailure(this.m_callbackIframeLoadFailed);this.m_onLoadError&&this.m_iframe.removeEventListener("error",this.m_onLoadError)},n.prototype.IframeLoadTimeout=function(){var t,n,r,i;if(this.m_iframeReadyForPostMessage){this.m_logger.ULS.traceTag(39416210,logCategory.PptSession,logLevel.Warning,"IFrameLoadTimeout called even though iframe is ready for postmessage");return}if(!this.m_apiId){this.m_logger.ULS.traceTag(39416211,logCategory.PptSession,logLevel.Warning,"IFrameLoadTimeout called after m_apiId is null");return}r=(t=this.m_initParams)===null||t===void 0?void 0:t.Container;i=!HTMLHelper.isInDomTree(r);this.m_logger.ULS.traceTag(545378775,logCategory.PptSession,logLevel.Warning,"App container is unloaded: "+i);n=i?{EventType:13,Code:7,ErrorName:"AppContainerUnloadedTimeout",Category:0,ExtraInfo:"App container uploaded before iframe loaded",SessionId:this.m_apiId,errorType:"13",errorObject:null}:{EventType:13,Code:100,ErrorName:"TimeoutWaitingForIframeToLoad",Category:0,ExtraInfo:"Timeout waiting for iframe to load",SessionId:this.m_apiId,errorType:"13",errorObject:null};PPTBootstrapperLogger.recordBootstrapperTimeoutFailure(this.m_initParams,n===null||n===void 0?void 0:n.Code,n===null||n===void 0?void 0:n.ErrorName,n===null||n===void 0?void 0:n.ExtraInfo,this.m_logger,Date.now(),this.m_appErrors);this.FailToBoot(n)},n.prototype.Activate=function(){if(!this.m_apiId){this.m_logger.ULS.traceTag(38540363,logCategory.PptSession,logLevel.Warning,"PreviewSessionLoader::Activate is missing apiId or presentationId");return}this.m_logger.ULS.traceTag(38540364,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::Activate");(this.m_iframe==null||this.m_iframe.parentElement==null)&&this.m_logger.ULS.traceTag(39203531,logCategory.PptSession,logLevel.Error,"PreviewSessionLoader::Activate - iframe is null or detached from parent");this.m_bootTimingDict.ActivateInApi=Date.now();var n=this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.EnableKeyboardNavigation!=undefined?this.m_initParams.ApplicationCustomSettings.EnableKeyboardNavigation:!0,t=this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.EnableAdvanceOnTap!=undefined?this.m_initParams.ApplicationCustomSettings.EnableAdvanceOnTap:!1,i=this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.AreThirdPartyAddInsAllowed!=undefined?this.m_initParams.ApplicationCustomSettings.AreThirdPartyAddInsAllowed:!1,r=this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.AllowExternalMarketplace!=undefined?this.m_initParams.ApplicationCustomSettings.AllowExternalMarketplace:!0;if(this.PostMessageDownward(new HandshakeWebViewerInternalMessage(this.m_apiId,n,this.m_contentMetadata,this.m_initParams.WopiPrecheckInfo.FileGetUrl,this.m_initParams.WopiPrecheckInfo.FileSize,this.m_initParams.WopiPrecheckInfo.FileName,this.m_presentationId,this.m_startingSlideId,this.m_startingSlideIndex,this.m_initParams.SessionInformation.HostName,this.m_initParams.Diagnostics?this.m_initParams.Diagnostics.entryPoint:"",this.m_apiStartTime,this.m_initParams.Diagnostics?this.m_initParams.Diagnostics.userClickTime?this.m_initParams.Diagnostics.userClickTime:0:0,this.m_initParams.SessionInformation.HostInitTime?this.m_initParams.SessionInformation.HostInitTime:0,t,PodsRegionInfo.getFileHost(this.m_initParams),this.m_vetoAppSettingsStr,this.m_disabledTransitionsList,this.m_customTransitionResourceUrl,this.m_streamUseThinEmbed,this.m_disabledChangeGates,PodsRegionInfo.getWACRegion(this.m_initParams.ApplicationUrl),i,r)),!this.m_finishedBootingConditional){this.m_logger.ULS.traceTag(51448026,logCategory.PptSession,logLevel.Warning,"PreviewSessionLoader::OnMesssage - Conditional Action uninitialized");throw Error("m_finishedBootingConditional");}this.m_finishedBootingConditional.SetCondition(this.c_activated)},n.prototype.PostMessageDownward=function(n){this.m_frameContainerContext.postMessageDownward(n)},n.prototype.FailToBoot=function(n){if(this.m_logger.ULS.traceTag(38540365,logCategory.PptSession,logLevel.Error,"PreviewSessionLoader::FailToBoot: "+JSON.stringify(n)),this.m_healthLogger){var t=n.ErrorName;t||(t=n.Code?n.Code.toString():"UnknownFailToBootError");this.m_healthLogger.recordQosError(t,["FileOpenFailed"],!1,!0,!0,!0)}this.Dispose();this.m_initParams.FnOnInitializeFailure(n,{appBootTimingDict:JSON.stringify(this.m_appBootTimingDict)})},n.prototype.FinishBoot=function(n,t){if(!this.m_apiId||!this.m_anchor||!this.m_iframe){this.m_logger.ULS.traceTag(38540366,logCategory.PptSession,logLevel.Error,"FinishBoot is missing parameters");return}this.m_logger.ULS.traceTag(38540367,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::FinishBoot");var u=this.m_appMetaData?this.m_appMetaData.AppVersionMajor+"."+this.m_appMetaData.AppVersionMinor:"Not Ready",f=function(n){var t=PPTMessageListenerRegistry.getInstance();t&&t.remove(n,!0,"FinishBoot::DisposeCallBack")},e=PPTBootstrapper.getOnDemandServer(this.m_initParams),i=n.GetPreviewAPIV1(this.m_anchor,this.m_iframe,this.m_frameContainerContext,this.m_apiId,!1,u,this.m_slideshowKind,this.m_initParams,t.perceivedLoadTime,f,this.m_logger,{timeoutWrapper:this.m_timeoutWrapper,pptDomainUrl:e}),r=PPTMessageListenerRegistry.getInstance();r.remove(this.m_apiId,!0,"FinishBoot::TransferRegistration");r.add(this.m_apiId,i,!0,"FinishBoot::TransferRegistration");this.DisposeForTransferToPreviewAPI();this.m_logger.ULS.traceTag(38540368,logCategory.PptSession,logLevel.Info,"FinishBoot - returning FnOnInitializeSuccess");this.m_initParams.FnOnInitializeSuccess(i,t)},n.prototype.onSliceLoaded=function(){this.m_apiId&&this.m_bootCompleted&&n.s_previewAPIFactory?this.FinishBoot(n.s_previewAPIFactory,this.m_appInitDiagnostics):this.m_apiId&&this.m_logger.ULS.traceTag(38540369,logCategory.PptSession,logLevel.Info,"onSliceLoaded: App is not ready yet - "+this.m_apiId.toString())},n.prototype.log=function(n,t){this.m_logger.ULS.traceTag(39978265,logCategory.PptSession,logLevel.Info,n);t!=null&&this.m_logger.ULS.traceTag(591946190,logCategory.PptSession,logLevel.Info,t)},n.prototype.onMessage=function(t,i){var f,e,o,s,c,l,r,a,v,u,h;if(this.m_frameContainerContext.isReceivedMessageValid(t,i)){if(t=t,!t||t.m_type==undefined){this.m_logger.ULS.traceTag(39978266,logCategory.PptSession,logLevel.Error,"PreviewSessionLoader::onMessage - received message with the wrong syntax");return}switch(t.m_type){case 0:this.m_bootCompleted=!0;this.m_logger.ULS.traceTag(38540370,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::onMessage - received Handshake from iframe");s=t;c=s.m_percievedBootTime?new Date(s.m_percievedBootTime):undefined;this.m_appInitDiagnostics.perceivedLoadTime=c;this.m_contentMetadata||(l={HttpStatus:this.m_contentMetadataHttpStatusCode},this.m_appInitDiagnostics.errorObject={errorType:"CannotLoadBundleItem",errorObject:l});n.s_previewAPIFactory?this.FinishBoot(n.s_previewAPIFactory,this.m_appInitDiagnostics):this.m_logger.ULS.traceTag(38540371,logCategory.PptSession,logLevel.Warning,"PreviewSessionLoader::onMessage - Handshake received but PreviewAPIFactory is not available");break;case 10:r=t;!isNaN(r.m_code)&&r.m_code>=0&&(a=0,v={EventType:13,Code:r.m_code,ErrorName:r.m_errorName,Category:a,ExtraInfo:r.m_extraInfo,SessionId:r.m_sessionId,errorType:"13",errorObject:null},this.FailToBoot(v));break;case WebViewerMessageType.OnNetworkHealthChanged:if(u=t,u.m_isHealthy===undefined)return;u.m_addTimeoutTimeMs&&((f=this.m_timeoutWrapper)===null||f===void 0?void 0:f.addTimeIfNotAddedInMs(u.m_addTimeoutTimeMs));u.m_isHealthy?(e=this.m_timeoutWrapper)===null||e===void 0?void 0:e.resume():(o=this.m_timeoutWrapper)===null||o===void 0?void 0:o.pause();break;case 28:if(this.m_bootTimingDict.AppReadyForPostMessage=Date.now(),this.m_logger.ULS.traceTag(39416212,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::onMessage - AppReadyForPostMessage"),this.m_iframeReadyForPostMessage=!0,this.m_iframeLoadTimeout&&(window.clearTimeout(this.m_iframeLoadTimeout),this.m_iframeLoadTimeout=undefined),this.m_retryPreviewerTimeout&&(window.clearTimeout(this.m_retryPreviewerTimeout),this.m_retryPreviewerTimeout=undefined),!this.m_readyToActivateConditional){this.m_logger.ULS.traceTag(51448027,logCategory.PptSession,logLevel.Warning,"PreviewSessionLoader::onMessage - Conditional Action uninitialized");throw Error("m_readyToActivateConditional");}this.m_readyToActivateConditional.SetCondition(this.c_iframeLoaded);break;case 40:h=t.m_logs;h&&this.m_logger.ULS.traceTag(590885717,logCategory.PptSession,logLevel.Info,h);break;case 41:if(this.m_appErrors.length>=this.c_appErrorThrottleCount)break;t.ErrorName?this.m_appErrors.push({DuringBoot:!this.m_bootCompleted,ErrorName:t.ErrorName,Tag:t.Tag}):this.m_logger.ULS.traceTag(588044113,logCategory.PptSession,logLevel.Warning,"PreviewSessionLoader::onMessage::PostAppErrorUpwardsForTelemetry message data is missing required field");break;case 42:if(this.m_bootCompleted)break;t.m_appBootTimingDict&&(Object.assign?(Object.assign(this.m_appBootTimingDict,t.m_appBootTimingDict),this.m_appInitDiagnostics.appBootTimingDict=JSON.stringify(this.m_appBootTimingDict)):this.m_logger.ULS.traceTag(577282078,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::onMessage::AppBootPerfDict Object.assign is not supported"));break;case 56:this.m_timeoutWrapper&&this.m_timeoutWrapper.tryUpdateTimeoutErrorStage(t.m_stageInfo,this.m_logger)}}},n.prototype.GenerateSlideShowParams=function(t,i){var r={},o,f,s,h,e,u;if(this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.ExtraUrlParams)for(o=this.m_initParams.ApplicationCustomSettings.ExtraUrlParams.split("&"),f=0;f<o.length;f++)s=o[f].split("="),r[s[0]]=s[1];return this.m_fShouldUseLegacySlideShowAspx?(h=this.m_initParams.ApplicationCustomSettings.WacStaticResourcesServer+this.m_appMetaData.WacCdnVersion,r.staticCdn=encodeURIComponent(h)):this.m_appMetaData.Environment=="wac"&&(r.wacCdnVersion=this.m_appMetaData.WacCdnVersion),t&&(r.pid=encodeURIComponent(t)),r.PowerPointView="ChromelessView",n.FIsUintValid(this.m_startingSlideId)&&this.m_startingSlideId!=0?r.wdSlideId=UrlUtils.urlKeyValueEncode(this.m_startingSlideId.toString()):n.FIsUintValid(this.m_startingSlideIndex)&&(r.wdSlideIndex=UrlUtils.urlKeyValueEncode(this.m_startingSlideIndex.toString())),this.m_initParams.SessionInformation.DataLocale&&(r.rs=this.m_initParams.SessionInformation.DataLocale),this.m_initParams.SessionInformation.UiLocale&&(r.ui=this.m_initParams.SessionInformation.UiLocale),this.m_initParams.SessionInformation.HostSessionId&&(r.hsi=this.m_initParams.SessionInformation.HostSessionId),this.m_initParams.SessionInformation.UseSnapService&&(r.UseSnapService=this.m_initParams.SessionInformation.UseSnapService),this.m_initParams.SessionInformation.SnapUrl&&(r.SnapUrl=UrlUtils.urlKeyValueEncode(this.m_initParams.SessionInformation.SnapUrl)),r.utb=UrlUtils.urlKeyValueEncode((this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.UseTransparentBackground!=undefined?this.m_initParams.ApplicationCustomSettings.UseTransparentBackground:!0).toString()),r.wdEaa=UrlUtils.urlKeyValueEncode((this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.EnableAutoAdvance!=undefined?this.m_initParams.ApplicationCustomSettings.EnableAutoAdvance?1:0:0).toString()),r.eac=UrlUtils.urlKeyValueEncode((this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.EnableAdvanceOnClick!=undefined?this.m_initParams.ApplicationCustomSettings.EnableAdvanceOnClick:!0).toString()),r.ekn=UrlUtils.urlKeyValueEncode((this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.EnableKeyboardNavigation!=undefined?this.m_initParams.ApplicationCustomSettings.EnableKeyboardNavigation:!0).toString()),r.vm=UrlUtils.urlKeyValueEncode((this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.ViewerMode?this.m_initParams.ApplicationCustomSettings.ViewerMode:0).toString()),r.co=UrlUtils.urlKeyValueEncode(this.m_initParams.WopiPrecheckInfo.BundleInfo.CrossOrigin?this.m_initParams.WopiPrecheckInfo.BundleInfo.CrossOrigin:"anonymous"),r.lcid=UrlUtils.urlKeyValueEncode((this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.LCID?this.m_initParams.ApplicationCustomSettings.LCID:"1033").toString()),r.hostname=UrlUtils.urlKeyValueEncode(n.GetHostName(this.m_initParams)),r.ua=UrlUtils.urlKeyValueEncode((!0).toString()),r.asb=UrlUtils.urlKeyValueEncode((this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.AddShadowBorder!=undefined?this.m_initParams.ApplicationCustomSettings.AddShadowBorder:!1).toString()),r.apiStartTime=UrlUtils.urlKeyValueEncode(this.m_apiStartTime.toString()),r.preloadApp=UrlUtils.urlKeyValueEncode(i.toString()),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.TakeFocusOnBoot&&(r.takeFocusOnBoot=UrlUtils.urlKeyValueEncode(UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.TakeFocusOnBoot.toString()))),r.isCombineRequest=UrlUtils.urlKeyValueEncode(UrlUtils.urlKeyValueEncode((!0).toString())),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.NoCacheToken&&(r.noCacheToken=UrlUtils.urlKeyValueEncode(UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.NoCacheToken))),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.EndSlideShowText&&(r.endSlideShowText=UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.EndSlideShowText)),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.HostSupportsSessionRefreshEnabled&&(r.hostSupportsSessionRefreshEnabled=UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.HostSupportsSessionRefreshEnabled.toString())),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.InkingEnabled&&(r.inkingEnabled=UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.InkingEnabled.toString())),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.IsNewSlideShowToolbarEnabled&&(r.isNewSlideShowToolbarEnabled=UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.IsNewSlideShowToolbarEnabled.toString())),this.m_appMetaData&&this.m_initParams.ApplicationCustomSettings&&!this.m_initParams.ApplicationCustomSettings.Url&&(r.aVMa=UrlUtils.urlKeyValueEncode(this.m_appMetaData.AppVersionMajor.toString()),r.aVMi=UrlUtils.urlKeyValueEncode(this.m_appMetaData.AppVersionMinor.toString()),r.cVMa=UrlUtils.urlKeyValueEncode(this.m_appMetaData.ContentVersionMajor.toString()),r.cVMi=UrlUtils.urlKeyValueEncode(this.m_appMetaData.ContentVersionMinor.toString()),r.env=UrlUtils.urlKeyValueEncode(this.m_appMetaData.Environment.toString()),r.cdnMA=UrlUtils.urlKeyValueEncode("1"),this.m_appMetaData.Environment!="wac"&&(e=PPTBootstrapSettings.getCDNManifestMapping(),r.cdnRD=UrlUtils.urlKeyValueEncode(e["pptscripts/reader.dione.js"].toString()),r.cdnRC=UrlUtils.urlKeyValueEncode(e["pptscripts/reader.calypso.js"].toString()),r.cdnB=UrlUtils.urlKeyValueEncode(e["pptscripts/babylon.js"].toString()))),this.m_initParams.WopiPrecheckInfo.BundleInfo.Url&&(r.dce=encodeURIComponent(this.m_initParams.WopiPrecheckInfo.BundleInfo.Url)),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.OnDemandServer&&(r.odvs=this.m_initParams.ApplicationCustomSettings.OnDemandServer),r.odve="podView.svc/jsonAnonymous",this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.PreserveDrawingBuffer&&(r.wgl_pdb=this.m_initParams.ApplicationCustomSettings.PreserveDrawingBuffer.toString()),(window.location.search.indexOf("wdDev=1")>=0||window.location.hash.indexOf("wdDev=1")>=0)&&(r.wdDev="1"),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.WacCluster&&(r.wacCluster=this.m_initParams.ApplicationCustomSettings.WacCluster),this.isNeedToAddSBOverride()?(u=UrlUtils.getParameterValue(window.location.search,"wdoverrides"),u?u.indexOf("useshapebuilderviewing")<0&&(u=u+",useshapebuilderviewing:true,rendergifslideshow:true,videothrutransparentcanvas:true"):u="useshapebuilderviewing:true,rendergifslideshow:true,videothrutransparentcanvas:true",r.wdoverrides=u):window.location.search.indexOf("wdoverrides=")>=0&&(r.wdoverrides=UrlUtils.getParameterValue(window.location.search,"wdoverrides")),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.LiveBroadcastEnabled&&(r.LiveBroadcastEnabled=this.m_initParams.ApplicationCustomSettings.LiveBroadcastEnabled.toString()),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.IsVideoThruTransparentCanvas&&(r.isVideoThruTransparentCanvas=UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.IsVideoThruTransparentCanvas.toString())),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.IsFlipgridVideoEnabled&&(r.isFlipgridVideoEnabled=UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.IsFlipgridVideoEnabled.toString())),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.IsTEDVideoEnabled&&(r.isTEDVideoEnabled=UrlUtils.urlKeyValueEncode(this.m_initParams.ApplicationCustomSettings.IsTEDVideoEnabled.toString())),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.AreThirdPartyAddInsAllowed&&(r.AreThirdPartyAddInsAllowed=this.m_initParams.ApplicationCustomSettings.AreThirdPartyAddInsAllowed.toString()),this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.AllowExternalMarketplace!=undefined&&(r.allowExternalMarketplace=this.m_initParams.ApplicationCustomSettings.AllowExternalMarketplace.toString()),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.UserId&&(r.user_id=encodeURIComponent(this.m_initParams.SessionInformation.UserId)),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.TenantId&&(r.tid=encodeURIComponent(this.m_initParams.SessionInformation.TenantId)),this.m_initParams.WopiPrecheckInfo&&this.m_initParams.WopiPrecheckInfo.DocUniqueId&&this.m_initParams.WopiPrecheckInfo.DocUniqueId!=""&&(r.docId=encodeURIComponent(this.m_initParams.WopiPrecheckInfo.DocUniqueId),this.m_logger.ULS.traceTag(579187410,logCategory.PptSession,logLevel.Info,"PreviewerSessionLoader::GenerateSlideShowParams docId present in intiailize")),this.m_initParams.WopiPrecheckInfo&&this.m_initParams.WopiPrecheckInfo.FileSize&&this.m_logger.ULS.traceTag(579187409,logCategory.PptSession,logLevel.Info,"PreviewerSessionLoader::GenerateSlideShowParams FileSize: "+this.m_initParams.WopiPrecheckInfo.FileSize),this.m_initParams.ApplicationUrl&&(r.ring=this.m_initParams.PreviewerRolloutRing),r.fh=encodeURIComponent(PodsRegionInfo.getFileHost(this.m_initParams)),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.HostName&&(r.uih=encodeURIComponent(PodsRegionInfo.getUiHost(this.m_initParams.SessionInformation.HostName))),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.UiHostRing&&(r.uihRing=encodeURIComponent(this.m_initParams.SessionInformation.UiHostRing)),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.CallId&&(r.callId=encodeURIComponent(this.m_initParams.SessionInformation.CallId)),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.ContentId&&(r.contentId=encodeURIComponent(this.m_initParams.SessionInformation.ContentId)),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.IsPresenter&&(r.isPresenter=this.m_initParams.SessionInformation.IsPresenter),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.ParticipantId&&(r.participantId=encodeURIComponent(this.m_initParams.SessionInformation.ParticipantId)),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.EndpointId&&(r.endpointId=encodeURIComponent(this.m_initParams.SessionInformation.EndpointId)),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.IsRetry&&(r.isRetry=this.m_initParams.SessionInformation.IsRetry),this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.PreviousSessionErrorName&&(r.previousSessionErrorName=this.m_initParams.SessionInformation.PreviousSessionErrorName),r},n.prototype.LoadIframe=function(t,i){var f,r,u;if(i===void 0&&(i=undefined),this.m_anchor==null||this.m_iframe==null){this.m_logger.ULS.traceTag(39416213,logCategory.PptSession,logLevel.Error,"PreviewerSessionLoader::LoadIframe is missing parameters");return}this.m_iframe.parentNode||this.m_anchor.appendChild(this.m_iframe);f=PPTBootstrapSettings.getCDNManifestMapping();r=this.m_initParams&&this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.Url?ViewerUrlUtils.HTMLEncode(this.m_initParams.ApplicationCustomSettings.Url)+"powerpointframe.html":this.m_appMetaData.Environment=="wac"?this.m_initParams.ApplicationCustomSettings.WacStaticResourcesServer+this.m_appMetaData.WacCdnVersion+"_slideshowresources/powerpointframe.html":ViewerUrlUtils.HTMLEncode("https://contentstorage.osi.office.net/pages/"+f["pptpages/powerpointframe.html"].toString()+"#powerpointframe.html");(this.m_initParams.WopiPrecheckInfo.BundleInfo.Url&&this.m_initParams.WopiPrecheckInfo.BundleInfo.Url.substr(0,5)=="http:"||this.m_initParams.ApplicationCustomSettings.Url&&this.m_initParams.ApplicationCustomSettings.Url.substr(0,4)!="http"&&window.location.protocol=="http:"||this.m_initParams.ApplicationCustomSettings.OnDemandServer&&this.m_initParams.ApplicationCustomSettings.OnDemandServer.substr(0,5)=="http:"||this.m_initParams.ApplicationCustomSettings.ForceHttp)&&r.substr(0,5)=="https"&&(u=document.createElement("a"),u.href=n.EscapeHtml(r),r=u.href,r="http"+r.substr(5));t&&Object.keys(t).forEach(function(n){r=UrlUtils.addOrReplaceParameterValue(r,n,t[n])});r=r.replace("?","#");this.m_iframe&&(this.m_logger.ULS.traceTag(590424141,logCategory.PptSession,logLevel.Info,"Iframe src: "+r),i&&i(r),this.m_iframe.src=r)},n.prototype.isNeedToAddSBOverride=function(){if(!PPTPreviewerBootstrapperUtils.IsTeamsPreviewerSession(this.m_initParams,!1)||this.m_initParams&&this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.HostName&&this.m_initParams.SessionInformation.HostName.toLowerCase().indexOf("ios")>=0)return!1;var n=this.m_initParams.ApplicationUrl;return n?this.m_initParams.PreviewerRolloutRing!="6":!1},n.prototype.LoadApp=function(t,i,r){var o=this,f,e,u;r.previewSessionLoadAppTime=Date.now();this.m_logger.ULS.traceTag(38540372,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::LoadApp");PPTPreviewerBootstrapperUtils.tryGetHostNetworkMetricsFromCallback(this.m_initParams,this.m_logger);r.prefetchStartTime&&(this.m_bootTimingDict.PrefetchStart=r.prefetchStartTime);this.m_initParams!=null&&this.m_initParams.SessionInformation!=null&&this.m_initParams.SessionInformation.WdParams!=null&&this.m_initParams.SessionInformation.WdParams.wdLegacyAspxInTeams!=null&&(this.m_bootTimingDict.wdLegacyAspxInTeams=this.m_initParams.SessionInformation.WdParams.wdLegacyAspxInTeams?1:0);this.m_initParams!=null&&this.m_initParams.SessionInformation!=null&&this.m_initParams.SessionInformation.WdParams!=null&&this.m_initParams.SessionInformation.WdParams.wdModernSlideShowInTeams!=null&&(this.m_bootTimingDict.wdModernSlideShowInTeams=this.m_initParams.SessionInformation.WdParams.wdModernSlideShowInTeams?1:0);this.m_initParams!=null&&this.m_initParams.SessionInformation!=null&&this.m_initParams.SessionInformation.HostExperience!=null&&(this.m_bootTimingDict.HostExperience=this.m_initParams.SessionInformation.HostExperience);this.m_initParams!=null&&this.m_initParams.SessionInformation!=null&&this.m_initParams.SessionInformation.UiHostRing!=null&&(this.m_bootTimingDict.UiHostRing=this.m_initParams.SessionInformation.UiHostRing);this.m_initParams!=null&&this.m_initParams.SessionInformation!=null&&this.m_initParams.SessionInformation.IsPresenter!=null&&(this.m_bootTimingDict.IsPresenter=this.m_initParams.SessionInformation.IsPresenter);this.m_initParams!=null&&this.m_initParams.SessionInformation!=null&&this.m_initParams.SessionInformation.Position!=null&&(this.m_bootTimingDict.PreviewerPosition=this.m_initParams.SessionInformation.Position);this.m_bootTimingDict.LoadApp=Date.now();this.m_readyToActivateConditional=new ConditionalAction(function(){return o.Activate()},[this.c_iframeLoaded,this.c_contentMetadataLoadedOrDoesNotExist]);this.m_iframe&&this.m_iframe.id&&this.m_logger.ULS.traceTag(590424140,logCategory.PptSession,logLevel.Info,"iframe about to be replaced with new iframe: Old iframe Id: "+this.m_iframe.id+"  , New iframe Id: "+this.m_initParams.SessionInformation.HostSessionId);this.m_initParams.ApplicationCustomSettings&&(f=this.m_initParams.ApplicationCustomSettings.OnDemandServer);e=this.m_pptFeatureGates?this.m_pptFeatureGates.DisableMicrophonePermissionsForIframe:!1;this.m_iframe=n.UpdateBaseIframe(this.m_initParams.SessionInformation.HostSessionId,this.m_frameContainerContext.frameRef,f,e);this.m_logger.ULS.traceTag(39203533,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::LoadApp creating new iframe - "+this.m_iframe.id.toString());u=this.GenerateSlideShowParams(t,i);this.m_slideshowKind=="Modern"?this.m_slideShowLoader.LoadSlideShow(this.m_iframe,u,this.m_slideshowKind,r):this.m_fShouldUseLegacySlideShowAspx?this.m_slideShowLoader.LoadSlideShow(this.m_iframe,u,"Legacy",r):(this.registerOnLoadErrorEvent(),this.LoadIframe(u));this.registerOnLoadEvent();this.registerOnUnloadEvent();this.m_bootTimingDict.iframeURLset=Date.now()},n.prototype.LaunchFromSlide=function(n){var r=this,i,t;if(!this.m_iframe){this.m_logger.ULS.traceTag(39416214,logCategory.PptSession,logLevel.Error,"PreviewSessionLoader::LaunchFromSlide iframe is null");return}if(this.m_logger.ULS.traceTag(39416215,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::LaunchFromSlide"),this.m_initParams.ApplicationCustomSettings&&n.WacCluster&&(this.m_initParams.ApplicationCustomSettings.WacCluster=n.WacCluster),this.m_initParams.Diagnostics=n.Diagnostics,this.m_presentationId=n.PresentationId,this.m_apiStartTime=Date.now(),this.m_bootTimingDict.ApiStartTime=this.m_apiStartTime,this.m_streamUseThinEmbed=n.StreamVideoUseThinEmbed,n.SendInitialLog&&PPTBootstrapper.sendInitialLog(this.m_initParams,"Slide Show",null,this.m_logger),i=this.m_presentationId,this.m_startingSlideId=n.StartingSlideId||-1,this.m_startingSlideIndex=n.StartingSlideIndex||-1,this.m_vetoAppSettingsStr=n.VetoAppSettingsStr||"",this.m_disabledTransitionsList=n.DisabledTransitionsList||"",this.m_customTransitionResourceUrl=n.CustomTransitionResourceUrl||"",this.m_disabledChangeGates=n.DisabledChangeGates||"",this.m_initParams.ApplicationCustomSettings!=null&&n.AreThirdPartyAddInsAllowed!=null&&(this.m_initParams.ApplicationCustomSettings.AreThirdPartyAddInsAllowed=n.AreThirdPartyAddInsAllowed),this.m_initParams.ApplicationCustomSettings!=null&&n.AllowExternalMarketplace!=null&&(this.m_initParams.ApplicationCustomSettings.AllowExternalMarketplace=n.AllowExternalMarketplace),t=HTMLHelper.floatToPercent(1),this.m_anchor.style.width=this.m_fVariableWidth?t:HTMLHelper.toPx(this.m_initParams.ApplicationCustomSettings.Width),this.m_anchor.style.height=this.m_fVariableHeight?t:HTMLHelper.toPx(this.m_initParams.ApplicationCustomSettings.Height),this.m_fVariableHeight&&(this.m_anchor.style.minHeight=HTMLHelper.toPx(this.c_minHeight)),this.m_anchor.style.left=HTMLHelper.toPx(0),this.m_anchor.style.right=HTMLHelper.toPx(0),this.m_anchor.style.bottom=HTMLHelper.toPx(0),this.m_anchor.style.top=HTMLHelper.toPx(0),this.m_fVariableHeight?this.m_iframe.style.minHeight=HTMLHelper.toPx(this.c_minIframeHeight):this.m_iframe.style.height=HTMLHelper.toPx(Math.max(this.m_initParams.ApplicationCustomSettings.Height,0)),(this.m_fShouldUseLegacySlideShowAspx||this.m_slideshowKind=="Modern")&&this.m_slideShowLoader.LaunchSlideShow(),this.m_finishedBootingConditional=new ConditionalAction(function(){return r.SendBootTelemetry()},[this.c_activated]),this.m_startingSlideIndex>=1&&this.GetPreviewImageFromPods(i,this.m_startingSlideIndex),!this.m_readyToActivateConditional){this.m_logger.ULS.traceTag(51448028,logCategory.PptSession,logLevel.Warning,"PreviewSessionLoader::OnMesssage - Conditional Action uninitialized");throw Error("m_readyToActivateConditional");}this.m_readyToActivateConditional.SetCondition(this.c_contentMetadataLoadedOrDoesNotExist)},n.prototype.SendBootTelemetry=function(){this.m_logger.ULS.traceTag(38540373,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::SendBootTelemetry");var n=new BootTimingFromApiInternalMessage(this.m_bootTimingDict);this.PostMessageDownward(n)},n.prototype.RecordStartedSlideShowTimestamp=function(n){this.m_logger.ULS.traceTag(39683465,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::RecordStartedSlideShowTimestamp Time that SlideShow started in ms: "+n);var t=new RecordStartedSlideShowTimestampInternalMessage(n);this.PostMessageDownward(t)},n.prototype.GetPreviewImageFromPods=function(n,t){var u,i,f,r;this.m_initParams.ApplicationCustomSettings&&this.m_initParams.ApplicationCustomSettings.OnDemandServer&&(this.m_logger.ULS.traceTag(39203537,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::GetPreviewImageFromPods"),u=void 0,u=this.m_initParams.ApplicationCustomSettings.OnDemandServer,i="fullSizePreview.png",t>1&&(i=t-1+"_"+i),f=void 0,f=u+"imagehandler.ashx?PV=6&PF=4&Rid="+i+"&Pid="+n+"&X-SupportSVGInWebGL="+(ViewerBrowserUtils.SupportSVGInWebGL()?"1":"0"),r=document.createElement("img"),r.style.visibility="hidden",r.style.position="absolute",r.src=f)},n.GetHostName=function(n){return n.SessionInformation.HostName?n.SessionInformation.HostName:window.location.hostname},n.EscapeHtml=function(n){return n.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")},n.prototype.Dispose=function(){this.m_logger.ULS.traceTag(39203539,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::Dispose - removeAnchor: "+(this.m_anchor!=null).toString()+", removeAPI: "+(this.m_apiId!=null).toString());this.m_anchor&&this.m_anchor.parentNode&&this.m_anchor.parentNode.removeChild(this.m_anchor);this.m_apiId&&PPTMessageListenerRegistry.getInstance().remove(this.m_apiId,!0,"Dispose from PreviewSessionLoader");this.DisposeForTransferToPreviewAPI()},n.prototype.DisposeForTransferToPreviewAPI=function(){this.m_anchor=null;this.m_iframe=null;this.m_apiId=null;this.m_healthLogger&&this.m_healthLogger.shutdown()},n.prototype.DisposePreloadedApp=function(){this.m_logger.ULS.traceTag(39416216,logCategory.PptSession,logLevel.Info,"PreviewSessionLoader::DisposePreloadedApp");this.m_iframe&&this.m_iframe.parentNode&&this.m_iframe.parentNode.removeChild(this.m_iframe);this.m_apiId&&PPTMessageListenerRegistry.getInstance().remove(this.m_apiId,!0,"Dispose PreloadApp");this.DisposeForTransferToPreviewAPI()},n.prototype.RecordBootStrapperInitTime=function(n){this.m_bootTimingDict.BootstrapperInitTime=n},n}(),SlideShowLoader=function(){function n(n,t,i,r){this.m_iframe=null;this.m_frameForm=null;this.m_formData={};this.m_appMetadata=r;this.m_logger=i;this.m_initParams=n;this.m_frameContainerContext=t;this.m_anchor=n.Container;this.m_pptFeatureGates=PPTBootstrapperFeatureGatesHelper.getFeatureGates(this.m_initParams,this.m_logger)}return n.prototype.LoadSlideShow=function(t,i,r,u,f){var s=this,g,c,e,v,h,l,nt,tt,it,rt,ut,o,y,p,w,a,ft,b,et,k,ot,ct,lt;if(f===void 0&&(f=undefined),g=Date.now(),this.m_iframe=t,this.m_anchor==null||this.m_iframe==null){this.m_logger.ULS.traceTag(592732160,logCategory.PptSession,logLevel.Error,"PreviewerSessionLoader::LoadModernSlideShowFrame is missing parameters");return}if(c=r=="Legacy"?this.m_initParams.ApplicationCustomSettings.OnDemandServer+"legacySlideshow.aspx":this.m_initParams.ApplicationCustomSettings.OnDemandServer+"slideshow.aspx",e=this.GetPresentFDUrl(this.m_initParams),this.m_initParams.ApplicationCustomSettings.UiType==="embed"||this.m_initParams.ApplicationCustomSettings.UiType==="reading")if(e!=null&&e!=="")c=e+"/viewer";else{this.m_logger.ULS.traceTag(507569306,logCategory.PptSession,logLevel.Error,"PreviewerSessionLoader:::LoadSlideShow PresentFD url is empty.");return}if(v="slideshowframe-"+this.m_iframe.id.toString(),this.m_iframe.name=v,this.m_frameForm=document.createElement("form"),this.m_frameForm.name="frameform-"+this.m_iframe.id.toString(),this.m_frameForm.id="frameform-"+this.m_iframe.id.toString(),this.m_frameForm.target=v,this.m_frameForm.action=c,this.m_frameForm.method="post",this.m_iframe.parentNode||this.m_anchor.appendChild(this.m_iframe),this.m_logger.ULS.traceTag(527958914,logCategory.PptSession,logLevel.Info,"PreviewerSessionLoader::LoadModernSlideShowFrame. iframe: "+this.m_frameForm.id),h=window.origin,h&&(this.m_formData.parentWindowOrigin=h,this.m_logger.ULS.traceTag(521179736,logCategory.PptSession,logLevel.Info,"PreviewerSessionLoader::LoadModernSlideShowFrame. parentWindowOrigin is an absolute URI: "+(h.indexOf("http")||h.indexOf("https")))),this.m_initParams.WopiPrecheckInfo.FileGetUrl&&(this.m_formData.fileurl=this.m_initParams.WopiPrecheckInfo.FileGetUrl),this.m_initParams.WopiPrecheckInfo.CustomFontCatalogUrl&&(this.m_formData.customFontCatalogUrl=this.m_initParams.WopiPrecheckInfo.CustomFontCatalogUrl),this.m_initParams.WopiPrecheckInfo.PresentationUrl&&(this.m_formData.presentationUrl=this.m_initParams.WopiPrecheckInfo.PresentationUrl),this.m_initParams.WopiPrecheckInfo.FileName&&(this.m_formData.fileName=UrlUtils.urlKeyValueEncode(this.m_initParams.WopiPrecheckInfo.FileName)),l=this.GetPodsUrl(this.m_initParams),l!=null&&l!==""&&(this.m_formData.podsurl=l),e!=null&&e!==""&&(this.m_formData.presentFDUrl=e),!this.m_initParams.SessionInformation.HostSessionId)throw"SessionInformation.HostSessionId is not provided";if(this.m_formData.hostsessionid=this.m_initParams.SessionInformation.HostSessionId,this.m_formData["X-UserSessionId"]=this.m_initParams.SessionInformation.HostSessionId,this.m_formData.ApiId=this.m_initParams.SessionInformation.HostSessionId,this.m_initParams.ApplicationCustomSettings.UiType!=null&&(this.m_formData.uiType=this.m_initParams.ApplicationCustomSettings.UiType),this.m_initParams.ApplicationCustomSettings.StartingSlideIndex!=null&&(this.m_formData.startingslideindex=this.m_initParams.ApplicationCustomSettings.StartingSlideIndex.toString()),this.m_initParams.ApplicationCustomSettings.StartingTimelineMappings!=null&&(this.m_formData.startingtimelinemappings=JSON.stringify(this.m_initParams.ApplicationCustomSettings.StartingTimelineMappings)),this.m_initParams.SessionInformation.HostName!=null&&(this.m_formData.hostname=this.m_initParams.SessionInformation.HostName),this.m_initParams.SessionInformation.UiHostIsHighContrast!=null&&(this.m_formData.isHighContrast=this.m_initParams.SessionInformation.UiHostIsHighContrast),this.m_initParams.SessionInformation.UiHostHighContrastColorSettings!=null&&(this.m_formData.highContrastColorSettings=this.m_initParams.SessionInformation.UiHostHighContrastColorSettings),this.m_initParams.SessionInformation.HostExperience!=null&&(this.m_formData.hostExperience=this.m_initParams.SessionInformation.HostExperience),this.m_initParams.SessionInformation.PreviousSessionErrorName!=null&&(this.m_formData.previousSessionErrorName=this.m_initParams.SessionInformation.PreviousSessionErrorName),this.m_initParams.SessionInformation.IsRtl!=null&&(this.m_formData.isRtl=this.m_initParams.SessionInformation.IsRtl),this.m_initParams.ApplicationCustomSettings.AreThirdPartyAddInsAllowed!=null&&(this.m_formData.areThirdPartyAddInsAllowed=this.m_initParams.ApplicationCustomSettings.AreThirdPartyAddInsAllowed),this.m_formData.SupportsDecryptedContentDownload=!0,this.m_initParams.SessionInformation.DocumentClickTime!=null)try{this.m_formData.startFromTime=this.m_initParams.SessionInformation.DocumentClickTime.getTime()}catch(at){this.m_logger.ULS.traceTag(590221380,logCategory.PptSession,logLevel.Error,"PreviewerSessionLoader::LoadSlideShow exception thrown: "+at)}this.m_initParams.Diagnostics&&(this.m_initParams.Diagnostics.docClickTime&&!this.m_formData.startFromTime&&(this.m_formData.startFromTime=this.m_initParams.Diagnostics.docClickTime),this.m_initParams.Diagnostics.loadingSpinnerStartTime&&(this.m_formData.uiHostLoadingSpinnerStartTime=this.m_initParams.Diagnostics.loadingSpinnerStartTime),this.m_initParams.Diagnostics.spoApiCallsCount&&(this.m_formData.spoApiCallsCount=this.m_initParams.Diagnostics.spoApiCallsCount),this.m_initParams.Diagnostics.driveItemRequestStartTime&&(this.m_formData.driveItemRequestStartTime=this.m_initParams.Diagnostics.driveItemRequestStartTime),this.m_initParams.Diagnostics.driveItemRequestEndTime&&(this.m_formData.driveItemRequestEndTime=this.m_initParams.Diagnostics.driveItemRequestEndTime),this.m_initParams.Diagnostics.timeFromPresenterStartToAttendee&&(this.m_formData.timeFromPresenterStartToAttendee=this.m_initParams.Diagnostics.timeFromPresenterStartToAttendee),this.m_initParams.Diagnostics.presenterStartTime&&(this.m_formData.presenterStartTime=this.m_initParams.Diagnostics.presenterStartTime),this.m_initParams.Diagnostics.bootstrapperScriptPreloadFlag&&(this.m_formData.bootstrapperScriptPreloadFlag=this.m_initParams.Diagnostics.bootstrapperScriptPreloadFlag),this.m_initParams.Diagnostics.bootstrapperScriptLoadPoint&&(this.m_formData.bootstrapperScriptLoadPoint=this.m_initParams.Diagnostics.bootstrapperScriptLoadPoint),this.m_initParams.Diagnostics.officeBootstrapperStartTime&&(this.m_formData.bootstrapperScriptLoadStartTime=this.m_initParams.Diagnostics.officeBootstrapperStartTime),this.m_initParams.Diagnostics.officeBootstrapperEndTime&&(this.m_formData.bootstrapperScriptLoadEndTime=this.m_initParams.Diagnostics.officeBootstrapperEndTime),this.m_initParams.Diagnostics.incomingSessionJoinedTime&&(this.m_formData.incomingSessionJoinedTime=this.m_initParams.Diagnostics.incomingSessionJoinedTime),this.m_initParams.Diagnostics.presentationUrlUpdateMetadata&&(this.m_formData.presentationUrlUpdateMetadata=this.m_initParams.Diagnostics.presentationUrlUpdateMetadata),this.m_initParams.Diagnostics.bootTimings&&(this.m_initParams.Diagnostics.bootTimings.containerCreationStartTime&&(this.m_formData.containerCreationStartTime=this.m_initParams.Diagnostics.bootTimings.containerCreationStartTime),this.m_initParams.Diagnostics.bootTimings.containerCreationEndTime&&(this.m_formData.containerCreationEndTime=this.m_initParams.Diagnostics.bootTimings.containerCreationEndTime)));this.m_formData.presentationUrlFlagEnabled=PPTBootstrapper.getPresentationUrlFlag(this.m_initParams,this.m_logger);this.m_pptFeatureGates!=null&&(nt=this.m_pptFeatureGates.EnableSnapUrlForPresenterInLegacy||!1,this.m_formData.enableSnapUrlForPresenterInLegacy=nt,tt=this.m_pptFeatureGates.PresenterViewForLegacyEnabled||!1,this.m_formData.presenterViewForLegacyEnabled=tt,it=this.m_pptFeatureGates.ShowSlideShowKindVisualCue||!1,this.m_formData.showSlideShowKindVisualCue=it,rt=this.m_pptFeatureGates.PdfLiveEnabled||!1,this.m_formData.pdfLiveEnabled=rt,ut=this.m_pptFeatureGates.DisablePresentFrontdoor||!1,this.m_formData.disablePresentFrontdoor=ut);o=PPTBootstrapperFeatureGatesHelper.getStateServiceFeatureGates(this.m_initParams,this.m_logger);o!=null&&(this.m_formData.isStateServiceNavTelemetryEnabled=o.indexOf("Nav")>=0,this.m_formData.isStateServiceNavSyncEnabled=o.indexOf("NavSync")>=0,this.m_formData.isStateServiceMediaSyncEnabled=o.indexOf("Media")>=0,this.m_formData.isStateServiceOpticalZoomSyncEnabled=o.indexOf("OpticalZoomSync")>=0);this.m_initParams.SessionInformation&&this.m_initParams.SessionInformation.WdParams&&(this.m_initParams.SessionInformation.WdParams.wdModernSlideShowInTeams&&(this.m_formData.wdModernSlideShowInTeams=this.m_initParams.SessionInformation.WdParams.wdModernSlideShowInTeams),this.m_initParams.SessionInformation.WdParams.wdPresenterViewInTeams&&(this.m_formData.wdPresenterViewInTeams=this.m_initParams.SessionInformation.WdParams.wdPresenterViewInTeams),this.m_initParams.SessionInformation.WdParams&&(this.m_formData.enablePptSharingWebviewContainer=this.m_initParams.SessionInformation.WdParams.enablePptSharingWebviewContainer),y=window.location.search.indexOf("isMovePrivateViewingToPPTEnabled")>=0,y?this.m_formData.enableMovePrivateViewingToPPT=y:this.m_initParams.SessionInformation.WdParams.isMovePrivateViewingToPPTEnabled&&(this.m_formData.enableMovePrivateViewingToPPT=this.m_initParams.SessionInformation.WdParams.isMovePrivateViewingToPPTEnabled),this.m_initParams.SessionInformation.WdParams.enableMoveTakeControlButtonToPPT&&(this.m_formData.enableMoveTakeControlButtonToPPT=this.m_initParams.SessionInformation.WdParams.enableMoveTakeControlButtonToPPT),this.m_initParams.SessionInformation.WdParams.enableMovePresenterNameToPPT&&(this.m_formData.enableMovePresenterNameToPPT=this.m_initParams.SessionInformation.WdParams.enableMovePresenterNameToPPT),p=window.location.search.indexOf("isPasteFileLinktoChatEnabled")>=0,p?this.m_formData.enablePPTLiveCopyLinkToChatInPresenterView=p:this.m_initParams.SessionInformation.WdParams.isPasteFileLinktoChatEnabled&&(this.m_formData.enablePPTLiveCopyLinkToChatInPresenterView=this.m_initParams.SessionInformation.WdParams.isPasteFileLinktoChatEnabled),w=window.location.search.indexOf("isCopyFileLinktoClipboardEnabled")>=0,w?this.m_formData.enablePPTLiveCopyLinkInPresenterView=w:this.m_initParams.SessionInformation.WdParams.isCopyFileLinktoClipboardEnabled&&(this.m_formData.enablePPTLiveCopyLinkInPresenterView=this.m_initParams.SessionInformation.WdParams.isCopyFileLinktoClipboardEnabled),a=window.location.search.indexOf("disableTeamsPptSharingNavControlsForPresenter")>=0,a?this.m_formData.enableSSToolbarNavControlsForPresenter=a:this.m_initParams.SessionInformation.WdParams.disableTeamsPptSharingNavControlsForPresenter&&(this.m_formData.enableSSToolbarNavControlsForPresenter=this.m_initParams.SessionInformation.WdParams.disableTeamsPptSharingNavControlsForPresenter),ft=window.location.search.indexOf("disableTeamsPptSharingNavControlsForAttendee")>=0,a?this.m_formData.enableSSToolbarNavControlsForAttendee=ft:this.m_initParams.SessionInformation.WdParams.disableTeamsPptSharingNavControlsForAttendee&&(this.m_formData.enableSSToolbarNavControlsForAttendee=this.m_initParams.SessionInformation.WdParams.disableTeamsPptSharingNavControlsForAttendee),b=window.location.search.indexOf("disableTeamsPptSharingPrivateViewingControlForPresenter")>=0,b?this.m_formData.enableSSToolbarTogglePrivateViewingControl=b:this.m_initParams.SessionInformation.WdParams.disableTeamsPptSharingPrivateViewingControlForPresenter&&(this.m_formData.enableSSToolbarTogglePrivateViewingControl=this.m_initParams.SessionInformation.WdParams.disableTeamsPptSharingPrivateViewingControlForPresenter),this.m_initParams.SessionInformation.WdParams.wdBrowserShapeBuilderCompatible&&(this.m_formData.wdBrowserShapeBuilderCompatible=this.m_initParams.SessionInformation.WdParams.wdBrowserShapeBuilderCompatible),this.m_initParams.SessionInformation.WdParams.wdIsFileTypeSupportedForModernSlideShow&&(this.m_formData.wdIsFileTypeSupportedForModernSlideShow=this.m_initParams.SessionInformation.WdParams.wdIsFileTypeSupportedForModernSlideShow),this.m_initParams.SessionInformation.WdParams.wdset?this.m_formData.wdset=this.m_initParams.SessionInformation.WdParams.wdset:this.m_pptFeatureGates&&this.m_pptFeatureGates.wdset&&(this.m_formData.wdset=this.m_pptFeatureGates.wdset),et=this.m_formData.wdset&&this.m_formData.wdset.indexOf("slideshowcore.forceSvg:")>=0,this.m_initParams.SessionInformation.WdParams.wdBrowserShapeBuilderCompatible||et||(this.m_formData.wdset=(this.m_formData.wdset||"")+",slideshowcore.forceSvg:true"),this.m_formData.isSvg=this.m_formData.wdset&&this.m_formData.wdset.indexOf("slideshowcore.forceSvg:")>=0,k=window.location.search.indexOf("showCoachButtonInPresentationSharing")>=0,k?this.m_formData.enableCoach=k:this.m_initParams.SessionInformation.WdParams.showCoachButtonInPresentationSharing&&(this.m_formData.enableCoach=this.m_initParams.SessionInformation.WdParams.showCoachButtonInPresentationSharing));u!=null&&(u.initWopiTime!=null&&(this.m_formData.initWopiTime=u.initWopiTime.toFixed(),this.m_formData.startFromTime||(this.m_formData.startFromTime=u.initWopiTime.toFixed(),this.m_logger.ULS.traceTag(587830343,logCategory.PptSession,logLevel.Error,"PreviewerSessionLoader::LoadSlideShow startFromTime was not present, so will use initWopiTime instead"))),u.bootstrapperInitTime!=null&&(this.m_formData.bootstrapperInitTime=u.bootstrapperInitTime.toFixed()),u.sliceLoadTime!=null&&(this.m_formData.sliceLoadTime=u.sliceLoadTime.toFixed()),u.createViewerTime!=null&&(this.m_formData.createViewerTime=u.createViewerTime.toFixed()),u.previewSessionLoadAppTime!=null&&(this.m_formData.previewSessionLoadAppTime=u.previewSessionLoadAppTime.toFixed()),u.getPresentationUrlStartTime!=null&&(this.m_formData.getPresentationUrlStartTime=u.getPresentationUrlStartTime.toFixed()),u.getPresentationUrlEndTime!=null&&(this.m_formData.getPresentationUrlEndTime=u.getPresentationUrlEndTime.toFixed()));this.m_formData.loadSlideShowTime=g.toFixed();this.m_formData.wdForcePresenterViewInTeams=window.location.search.indexOf("wdForcePresenterViewInTeams")>=0;this.m_formData.wdEnablePresenterViewInkInTeams=window.location.search.indexOf("wdEnablePresenterViewInkInTeams")>=0;this.m_formData.wdEnableAnnotationsUI=window.location.search.indexOf("wdEnableAnnotationsUI")>=0;this.m_formData.wdInkMaster=window.location.search.indexOf("wdInkMaster")>=0;this.m_formData.wdEnableCursorMoveEvent=window.location.search.indexOf("wdEnableCursorMoveEvent")>=0;this.m_formData.wdEnableMouseStrokeSmooth=window.location.search.indexOf("wdEnableMouseStrokeSmooth")>=0;this.m_formData.wdEnableStraightLine=window.location.search.indexOf("wdEnableStraightLine")>=0;this.m_formData.wdEnablePressAndHoldStraightLine=window.location.search.indexOf("wdEnablePressAndHoldStraightLine")>=0;this.m_formData.wdEnableStrokeArrowHead=window.location.search.indexOf("wdEnableStrokeArrowHead")>=0;this.m_formData.wdEnableInkEffectPen=window.location.search.indexOf("wdEnableInkEffectPen")>=0;this.m_formData.wdEnableInstantInkingBehavior=window.location.search.indexOf("wdEnableInstantInkingBehavior")>=0;this.m_formData.wdEnableCustomCursor=window.location.search.indexOf("wdEnableCustomCursor")>=0;this.m_formData.wdEnablePersistentLaserCursor=window.location.search.indexOf("wdEnablePersistentLaserCursor")>=0;this.m_pptFeatureGates&&this.m_pptFeatureGates.ForceSlideShareAnnotation!=undefined&&(ot=this.m_pptFeatureGates.ForceSlideShareAnnotation||!1,this.m_formData.forceSlideShareAnnotation=ot);this.m_initParams.WopiPrecheckInfo.FileSize&&(this.m_formData.fileSize=this.m_initParams.WopiPrecheckInfo.FileSize,this.m_formData.fileLengthHint=this.m_initParams.WopiPrecheckInfo.FileSize);this.m_initParams.WopiPrecheckInfo.DocUniqueId&&(this.m_formData.DocID=this.m_initParams.WopiPrecheckInfo.DocUniqueId);this.m_initParams.WopiPrecheckInfo.ETag&&(this.m_formData.ETag=this.m_initParams.WopiPrecheckInfo.ETag);this.m_initParams.SnapRequestID&&(this.m_formData.snapRequestID=this.m_initParams.SnapRequestID);this.m_formData.authHeaderForHostDownloadEnabled=window.location.search.indexOf("wdAuthHeaderForHostDownloadEnabled")>=0;var d=BrowserUtils.devicePixelRatio(),st=this.m_initParams.ApplicationCustomSettings.AddShadowBorder?10:0,ht=this.m_initParams.Container.getBoundingClientRect();this.m_formData.availableWidth=Math.round(d*Math.max(Math.ceil(ht.width),300)-2*st);this.m_formData.availableHeight=Math.round(d*Math.max(Math.ceil(ht.height),201)-2*st);this.m_formData.dpr=d;this.m_formData.SupportSVGInWebGL=ViewerBrowserUtils.SupportSVGInWebGL();i&&Object.keys(i).forEach(function(n){s.m_formData[n.toLowerCase()]=i[n]});ct=PPTBootstrapper.getSlideShowHostContainer(this.m_initParams);lt=ct!="Webview"?!1:this.m_pptFeatureGates!=null&&this.m_pptFeatureGates.RemoveExtraFrameFormForWebview;lt||(Object.keys(this.m_formData).forEach(function(t){s.m_frameForm!=null?s.m_frameForm.appendChild(n.CreateHiddenInputElement(t,s.m_formData[t])):s.m_logger.ULS.traceTag(527958915,logCategory.PptSession,logLevel.Warning,"PreviewerSessionLoader:::LoadSlideShow frame form is empty.")}),f&&f(c),this.m_anchor.appendChild(this.m_frameForm))},n.prototype.LaunchSlideShow=function(){this.m_frameForm?(this.m_logger.ULS.traceTag(527786396,logCategory.PptSession,logLevel.Info,"PreviewerSessionLoader::LaunchSlideshow iframe: "+this.m_frameForm.id+"; numParams: "+Object.keys(this.m_formData).length+"; numChildren "+this.m_frameForm.childElementCount+"."),this.m_frameContainerContext.initMessageListener(),this.m_frameContainerContext.load(this.m_frameForm,this.m_formData)):this.m_logger.ULS.traceTag(527958917,logCategory.PptSession,logLevel.Warning,"PreviewerSessionLoader::LaunchSlideshow with empty m_frameForm.")},n.CreateHiddenInputElement=function(n,t){var i=document.createElement("input");return i.type="hidden",i.name=n,i.value=t,i},n.prototype.GetPodsUrl=function(n){var t=UrlUtils.getQueryStringParam("wdPodsUrl");return t&&!this.validateUrlHostMatchesWindowHost(t)&&(t=""),t||(t=PPTBootstrapper.getOnDemandServer(n,!0)),t.substr(t.length-1)!="/"&&(t+="/"),t},n.prototype.GetPresentFDUrl=function(n){var t=UrlUtils.getQueryStringParam("wdPresentUrl");return t&&!this.validateUrlHostMatchesWindowHost(t)&&(t=""),t||(t=PPTBootstrapper.getPresentFrontdoorServer(n,this.m_logger)),t},n.prototype.validateUrlHostMatchesWindowHost=function(n){var t=document.createElement("a"),i,r;return t.href=n,i=t.port||80,r=window.location.port||80,t.hostname==window.location.hostname&&i==r},n}(),StateServiceClientInitStatus;(function(n){n[n.Uninitialized=0]="Uninitialized";n[n.Initializing=1]="Initializing";n[n.Success=2]="Success";n[n.Failure=3]="Failure"})(StateServiceClientInitStatus||(StateServiceClientInitStatus={})),function(n){n[n.Initializing=0]="Initializing";n[n.Success=1]="Success";n[n.Failure=2]="Failure"}(PptSessionBootStatus||(PptSessionBootStatus={}));var StateServiceLoggerWrapper=function(){function n(n){this.logger=n}return n.prototype.sendTraceTag=function(n,t,i,r){this.logger.ULS.traceTag(n,t,i,r)},n}(),StateServiceClientLoader=function(){function n(){}return n.IsStateServiceClientInitComplete=function(n){return n==StateServiceClientInitStatus.Success||n==StateServiceClientInitStatus.Failure},n.TryDisconnectStateService=function(t){var i;n.stateServiceClient&&(t.ULS.traceTag(571355284,logCategory.PptSession,logLevel.Info,"StateServiceClientLoader: Closing State Service connection. ClientID: "+((i=n.stateServiceClient)===null||i===void 0?void 0:i.clientId)),n.stateServiceClient.close(),n.stateServiceClient=undefined,n.stateServiceClientInitStatus=StateServiceClientInitStatus.Uninitialized)},n.SendMessage=function(t){if(n.stateServiceClientInitStatus==StateServiceClientInitStatus.Success)n.stateServiceClient.onMessage(t);else{var i=t?t.m_type:"";switch(i){case WebViewerInternalMessageType.RecordMetrics:if(t.m_statName=="PostMessageReady"&&(n.pptSessionBootStatus=PptSessionBootStatus.Success,n.stateServiceClientInitStatus==StateServiceClientInitStatus.Failure)){n.RecordSharingNotSyncingVeto("VetoedTeamsSharingStateServiceConnection");break}this.storedMessages.push(t);break;case"presentationUrl":this.storedMessages.push(t);break;default:throw new Error("StateServiceClient::SendMessage messageType: "+i+" stateServiceClient is null");}}},n.RecordSharingNotSyncingVeto=function(t){n.healthLogger&&n.healthLogger.recordQosError(t,["SharingNotSyncing"],!1,!0,!0,!1)},n.TryLoadStateServiceClient=function(t,i,r,u,f,e,o,s){try{n.stateServiceClientInitStatus=StateServiceClientInitStatus.Uninitialized;n.healthLogger=e;var c=PPTBootstrapSettings.getAppMetadata(),l=PPTBootstrapper.getWacStaticResourcesServer(t.ApplicationCustomSettings,t.ApplicationUrl,t.BootstrapperUrl,t),a=l+c.WacCdnVersion+"_pptscripts/stateservicepreviewerclient.js",v=PPTPreviewerBootstrapperUtils.getTrustedScriptUrl(a,t,"StateServiceClient",i),h=document.createElement("script");return window.StateServicePreviewerClient&&window.StateServicePreviewerClient.StateServiceClient&&i.ULS.traceTag(520664784,logCategory.PptSession,logLevel.Warning,"StateServiceClientLoader: StateServiceClient JS already exists. Host:"+t.SessionInformation.HostName+";"),window.StateServicePreviewerClient&&window.StateServicePreviewerClient.StateServiceClient&&t.SessionInformation.HostName==="MSTeams"&&!o?(i.ULS.traceTag(520664783,logCategory.PptSession,logLevel.Warning,"StateServiceClientLoader: StateServiceClient JS already exists. Beginning Init."),n.TryLoadStateServiceClientImpl(t,i,r,u,f,e,s),!0):(i.ULS.traceTag(520664782,logCategory.PptSession,logLevel.Info,"StateServiceClientLoader: StateServiceClient JS doesn't exist, going to load it."),h.onload=function(){n.TryLoadStateServiceClientImpl(t,i,r,u,f,e,s)},h.onerror=function(){i.ULS.traceTag(538564750,logCategory.PptSession,logLevel.Error,"StateServiceClientLoader: Fail to load StateServiceClientJS.")},h.src=v,document.head.insertBefore(h,document.head.firstChild),!0)}catch(y){return i.ULS.traceTag(573154445,logCategory.PptSession,logLevel.Error,"StateServiceClientLoader: Caught exception "+y+"."),!1}},n.TryLoadStateServiceClientImpl=function(t,i,r,u,f,e,o){var h,c,l,a,s;n.stateServiceClient&&(i.ULS.traceTag(571355286,logCategory.PptSession,logLevel.Warning,"StateServiceClientLoader: Trying to create StateServiceClient instance again. ClientID: "+((h=n.stateServiceClient)===null||h===void 0?void 0:h.clientId)),n.TryDisconnectStateService(i));a={webviewContainerEnabled:((l=(c=t===null||t===void 0?void 0:t.SessionInformation)===null||c===void 0?void 0:c.WdParams)===null||l===void 0?void 0:l.enablePptSharingWebviewContainer)&&(t===null||t===void 0?void 0:t.WebviewRef)};n.stateServiceClient=new StateServicePreviewerClient.StateServiceClient(a,f);i.ULS.traceTag(571355285,logCategory.PptSession,logLevel.Info,"StateServiceClientLoader: Creating StateServiceClient instance.");var v=t.SessionInformation.HostSessionId,y={HostName:t.SessionInformation.HostName,Ring:t.SessionInformation.UiHostRing},w=o!==undefined?__assign(__assign({},o.stateServiceProxySettings),{correlationId:v,metadata:y}):{batchedRequestsEnabled:!1,maxRoundtripRaw:300,pingTimeoutInMs:15e3,pongTimeoutInMs:15e3,retryIntervalsInMs:[1e3,2e3,4e3],verbose:!1,websocketAliveTimeAfterLoseFocusInMS:3e4,maxSessionRetries:15,autoRoutingEnabled:!0,offlineMessageCacheEnabled:!0,maxOfflineMessageCacheTimeInMs:2e4,maxOfflineMessageCacheLength:64,allowReconnectOnSendMessage:!0,unacknowledgeMessageTimeoutInMs:12e3,useServiceGeneratedClientId:!0,correlationId:v,metadata:y},p=window.location.search.indexOf("wdTestPreviewer=1")>=0||window.location.hash.indexOf("wdTestPreviewer=1")>=0||window.location.search.indexOf("wdTestWacPreviewer=1")>=0;p&&(s=new URLSearchParams(window.location.search),s.has("wdIsPresenter")&&(t.SessionInformation.IsPresenter=s.get("wdIsPresenter")==="1"),s.has("wdCallId")&&(t.SessionInformation.CallId=s.get("wdCallId")||"testdevcall"));t.SessionInformation.CallId||i.ULS.traceTag(573154444,logCategory.PptSession,logLevel.Error,"StateServiceClientLoader: Not initializing StateServiceClient since CallId is null.");n.stateServiceClient&&(i.ULS.traceTag(520135637,logCategory.PptSession,logLevel.Info,"StateServiceClientLoader: StateServiceClient begin init."),n.stateServiceClientInitStatus=StateServiceClientInitStatus.Initializing,n.stateServiceClient.init(w,p,new StateServiceLoggerWrapper(i),t.SessionInformation.HostSessionId,t.SessionInformation.IsPresenter||!1,t.SessionInformation.CallId,t.WopiPrecheckInfo.FileGetUrl,r||[],e,u,o?o.regionalEndpointUrl:undefined,o?o.userId:undefined,o?o.stateServiceUser:undefined,o?o.authEnabled:undefined,o?o.stateServiceSecret:undefined,{rosterCheckEnabled:o?o.rosterCheckEnabled:!1,isPresenterInRoster:o?o.isPresenterInRoster:undefined}).then(function(t){var u,r;if(t){n.stateServiceClientInitStatus=StateServiceClientInitStatus.Success;i.ULS.traceTag(520135636,logCategory.PptSession,logLevel.Info,"StateServiceClientLoader: StateServiceClient initialized.");for(u in n.storedMessages)if(r=n.storedMessages[u],r){n.stateServiceClient.onMessage(r);i.ULS.traceTag(554268579,logCategory.PptSession,logLevel.Info,"StateServiceClientLoader: sending Stored message "+(r.m_type||"")+".");delete n.storedMessages[u]}}else n.stateServiceClientInitStatus=StateServiceClientInitStatus.Failure,n.pptSessionBootStatus==PptSessionBootStatus.Success&&n.RecordSharingNotSyncingVeto("VetoedTeamsSharingStateServiceConnection")}))},n.stateServiceClientInitStatus=StateServiceClientInitStatus.Uninitialized,n.pptSessionBootStatus=PptSessionBootStatus.Initializing,n.storedMessages=[],n}(),PPTPreviewerBootstrapperFeatureGatesHelper=function(){function n(){}return n.CombineDisabledChangeGates=function(n,t){var i="";return n&&n.DisabledChangeGates&&(i+=n.DisabledChangeGates+";"),t&&t.PPTDisabledChangeGates&&(i+=t.PPTDisabledChangeGates),i},n}(),ViewerBrowserUtils=function(){function n(){}return n.SupportPreloadLink=function(){return this.GetChromeVersion()>=50},n.GetChromeVersion=function(){var n=window.navigator.userAgent.toLowerCase(),t;if(n.indexOf("chrome/")>=0&&(t=n.indexOf("chrome/"),t>=0)){var i=t+7,r=n.indexOf(".",i),u=n.substring(i,r);return+u}return 0},n.SupportSVGInWebGL=function(){var r=!1,n,t,i;if(!this.iOS9OrOlderDetected()&&!BrowserUtils.isSafari())try{n=document.createElement("canvas");(n.getContext("webgl")||document.createElement("canvas").getContext("experimental-webgl"))&&(t=document.createElement("canvas").getContext("2d"),t&&(i=document.createElement("img"),i.src="data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E",t.drawImage(i,0,0,10,10),n.toDataURL("image/png"),r=!0))}catch(u){}return r},n.iOS9OrOlderDetected=function(){var n=window.navigator.userAgent.toLowerCase(),r,t,i;return(n.indexOf("iphone")!=-1||n.indexOf("ipad")!=-1||n.indexOf("ipod")!=-1)&&(r=new RegExp("os (\\d+)_"),t=r.exec(n),t&&t.length>=2)?(i=parseInt(t[1]),!isNaN(i)&&i<=9):!1},n}(),ViewerUrlUtils=function(){function n(){}return n.HTMLEncode=function(n){return UrlUtils.encodeString(n,this.htmlEncodeReplacements)},n.htmlEncodeReplacements=[{FindExpression:new RegExp("&","g"),ReplaceValue:"&#"+"&".charCodeAt(0)+";"},{FindExpression:new RegExp("<","g"),ReplaceValue:"&#"+"<".charCodeAt(0)+";"},{FindExpression:new RegExp(">","g"),ReplaceValue:"&#"+">".charCodeAt(0)+";"},{FindExpression:new RegExp("'","g"),ReplaceValue:"&#"+"'".charCodeAt(0)+";"},{FindExpression:new RegExp("\\\\","g"),ReplaceValue:"&#"+"\\\\".charCodeAt(0)+";"},{FindExpression:new RegExp('"',"g"),ReplaceValue:"&#"+'"'.charCodeAt(0)+";"},],n}(),FrameContainerContext=function(){function n(n,t){var i,r,u;this.m_initParams=n;this.m_logger=t;this.m_pptFeatureGates=PPTBootstrapperFeatureGatesHelper.getFeatureGates(this.m_initParams,null);((u=(r=(i=this.m_initParams)===null||i===void 0?void 0:i.SessionInformation)===null||r===void 0?void 0:r.WdParams)===null||u===void 0?void 0:u.enablePptSharingWebviewContainer)&&this.m_initParams.WebviewRef?(this.m_frameRef=this.m_initParams.WebviewRef,this.m_initParams.Container.style.display="none",this.m_frameContainerStrategy=new WebviewFrameStrategy(this.m_frameRef,this.m_logger,this.m_initParams.SessionInformation.HostSessionId,this.m_pptFeatureGates)):(this.m_frameRef=document.createElement("iframe"),this.m_frameContainerStrategy=new IFrameStrategy(this.m_frameRef,this.m_logger,this.m_pptFeatureGates))}return n.prototype.initMessageListener=function(){this.m_frameContainerStrategy&&this.m_frameContainerStrategy.initMessageListener()},n.prototype.addMessageListener=function(n){this.m_frameContainerStrategy&&this.m_frameContainerStrategy.addMessageListener(n)},n.prototype.removeEventListener=function(n){this.m_frameContainerStrategy&&this.m_frameContainerStrategy.removeEventListener(n)},n.prototype.isReceivedMessageValid=function(n,t){return this.m_frameContainerStrategy?this.m_frameContainerStrategy.isReceivedMessageValid(n,t):!1},Object.defineProperty(n.prototype,"frameRef",{get:function(){return this.m_frameRef},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"logger",{set:function(n){this.m_logger=n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"slideshowKind",{set:function(n){this.m_frameContainerStrategy&&(this.m_frameContainerStrategy.slideshowKind=n)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"shouldUseAspxForLegacy",{set:function(n){this.m_frameContainerStrategy&&(this.m_frameContainerStrategy.shouldUseAspxForLegacy=n)},enumerable:!1,configurable:!0}),n.prototype.load=function(n,t){this.m_frameContainerStrategy&&this.m_frameContainerStrategy.load(n,t)},n.prototype.postMessageDownward=function(n){this.m_frameContainerStrategy&&this.m_frameContainerStrategy.postMessageDownward(n)},n.prototype.postMessageWithArrayBufferDownward=function(n,t){this.m_frameContainerStrategy&&this.m_frameContainerStrategy.postMessageWithArrayBufferDownward(n,t)},n}(),IFrameStrategy=function(){function n(n,t,i){var r;this.m_slideshowKind="Modern";this.m_shouldUseAspxForLegacy=!1;this.m_iframe=n;this.m_logger=t;this.m_pptFeatureGates=i;(r=this.m_logger)===null||r===void 0?void 0:r.ULS.traceTag(527958919,logCategory.PptSession,logLevel.Info,"IFrameStrategy::Ctor.")}return n.prototype.initMessageListener=function(){},n.prototype.addMessageListener=function(n){window.addEventListener("message",n)},n.prototype.removeEventListener=function(n){window.removeEventListener("message",n)},n.prototype.isReceivedMessageValid=function(n,t){var i,r,u;if(this.m_iframe){if(this.m_iframe.contentWindow!=t)return(r=this.m_logger)===null||r===void 0?void 0:r.ULS.traceTag(528623698,logCategory.PptSession,logLevel.Error,"IFrameStrategy::isReceivedMessageValid - received a message with wrong source"),!1;if(!n)return(u=this.m_logger)===null||u===void 0?void 0:u.ULS.traceTag(528623699,logCategory.PptSession,logLevel.Error,"IFrameStrategy::isReceivedMessageValid - no actual data"),!1}else return(i=this.m_logger)===null||i===void 0?void 0:i.ULS.traceTag(528623697,logCategory.PptSession,logLevel.Error,"IFrameStrategy::isReceivedMessageValid - iframe is invalid but received a message"),!1;return!0},Object.defineProperty(n.prototype,"slideshowKind",{set:function(n){this.m_slideshowKind=n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"shouldUseAspxForLegacy",{set:function(n){this.m_shouldUseAspxForLegacy=n},enumerable:!1,configurable:!0}),n.prototype.load=function(n){var i,r,u,f,e,t,o,s,h;try{for(f=[],e=n.children,t=0;t<e.length;t++)o=e[t],o.value!=""&&f.push(o.name);(i=this.m_logger)===null||i===void 0?void 0:i.ULS.traceTag(527958920,logCategory.PptSession,logLevel.Info,"IFrameStrategy::Load; children: "+f+"; numChildren "+n.childElementCount)}catch(c){(r=this.m_logger)===null||r===void 0?void 0:r.ULS.traceTag(527786397,logCategory.PptSession,logLevel.Error,"IFrameStrategy::Load; exception "+c)}this.m_pptFeatureGates.DisableIframeDomCheckWhenFormSubmit==!0?n.submit():(s=n.target.replace("slideshowframe-",""),h=document.querySelector("#"+s),h?n.submit():(u=this.m_logger)===null||u===void 0?void 0:u.ULS.traceTag(527577626,logCategory.PptSession,logLevel.Error,"IFrameStrategy::Load; form target: "+n.target+" not in DOM"))},n.prototype.postMessageDownward=function(n){var t,i,u=this.m_slideshowKind=="Modern"||this.m_shouldUseAspxForLegacy,r;if(this.m_iframe&&(this.m_iframe.src.length!=0||u)&&this.m_iframe.contentWindow){r=JSON.stringify(n);try{this.m_iframe.contentWindow.postMessage(r,this.m_iframe.src==""?"*":this.m_iframe.src)}catch(f){(t=this.m_logger)===null||t===void 0?void 0:t.ULS.traceTag(508051482,logCategory.PptSession,logLevel.Error,"IFrameStrategy::PostMessageDownward; exception "+f)}}else(i=this.m_logger)===null||i===void 0?void 0:i.ULS.traceTag(39203532,logCategory.PptSession,logLevel.Error,"IFrameStrategy::PostMessageDownward - iframe is invalid")},n.prototype.postMessageWithArrayBufferDownward=function(n,t){var i,f=this.m_iframe.name.indexOf("slideshowframe")>=0;if((this.m_iframe.src.length!=0||f)&&this.m_iframe.contentWindow!=null){var u=this.m_iframe.src==""?"*":this.m_iframe.src,r={bufferMetadata:n,arrayBuffer:t},e=JSON.parse(n);e.sharedArrayBuffer?this.m_iframe.contentWindow.postMessage(r,u):this.m_iframe.contentWindow.postMessage(r,u,[r.arrayBuffer])}else(i=this.m_logger)===null||i===void 0?void 0:i.ULS.traceTag(556672283,logCategory.PptSession,logLevel.Info,"PreviewSessionManagerV0::PostMessageWithArrayBufferDownward iframe src or contentWindow is empty")},n}(),WebviewFrameStrategy=function(){function n(n,t,i,r){var u;this.webviewToParentChannelName="ppt-webview-to-main-renderer-postmessage";this.parentToWebviewChannelName="ppt-main-renderer-to-webview-postmessage";this.m_slideshowKind="Modern";this.m_shouldUseAspxForLegacy=!1;this.m_listenerList=[];this.m_startTimeDomReady=0;this.m_endTimeDomReady=0;this.m_logger=t;this.m_webviewFrame=n;this.m_hostSessionId=i;this.m_pptFeatureGates=r;(u=this.m_logger)===null||u===void 0?void 0:u.ULS.traceTag(527958913,logCategory.PptSession,logLevel.Info,"WebviewFrameStrategy::Ctor "+i+".")}return n.prototype.initMessageListener=function(){this.m_webviewFrame.addEventListener("ipc-message",this.onMessageReceived.bind(this))},n.prototype.addMessageListener=function(n){this.m_listenerList.push(n)},n.prototype.removeEventListener=function(n){var t=this;this.m_listenerList.forEach(function(i,r){i===n&&t.m_listenerList.splice(r,1)})},n.prototype.isReceivedMessageValid=function(n){var t,i;if(n){if(n.m_id!=this.m_hostSessionId)return(i=this.m_logger)===null||i===void 0?void 0:i.ULS.traceTag(528623696,logCategory.PptSession,logLevel.Error,"WebviewFrameStrategy::isReceivedMessageValid - invalid id in message, m_id:"+n.m_id+", hostSessionId:"+this.m_hostSessionId),!1}else return(t=this.m_logger)===null||t===void 0?void 0:t.ULS.traceTag(528623695,logCategory.PptSession,logLevel.Error,"WebviewFrameStrategy::isReceivedMessageValid - no actual data"),!1;return!0},n.prototype.load=function(n,t){var i=this,r,u;this.m_webviewFrame.style.display="flex";r=function(){var u,f,e;try{i.m_endTimeDomReady=Date.now();(u=i.m_logger)===null||u===void 0?void 0:u.ULS.traceTag(512553557,logCategory.PptSession,logLevel.Info,"WebviewFrameStrategy::load - startTimeDomReady: "+i.m_startTimeDomReady+", endTimeDomReady: "+i.m_endTimeDomReady);i.m_webviewFrame&&(e=JSON.stringify(t),i.m_webviewFrame.executeJavaScript('\n                        let frameForm = document.createElement("form");\n                        frameForm.name = "frameform-'+n.id+'";\n                        frameForm.id = "frameform-'+n.id+'";\n                        frameForm.action = "'+n.action+'";\n                        frameForm.method = "post";\n                        let formParams = '+e+';\n                        Object.keys(formParams).forEach(function (key) {\n                           let inputElement = document.createElement("input");\n                           inputElement.type = "hidden";\n                           inputElement.name = key;\n                           inputElement.value = formParams[key];\n                           frameForm.appendChild(inputElement);\n                        });\n                        document.body.appendChild(frameForm);\n                        frameForm.submit();\n                  '),i.m_webviewFrame.removeEventListener("dom-ready",r))}catch(o){(f=i.m_logger)===null||f===void 0?void 0:f.ULS.traceTag(528824523,logCategory.PptSession,logLevel.Error,"WebviewFrameStrategy::LaunchSlideShow - exception when form posting slideshow.aspx: "+o)}};this.m_webviewFrame.addEventListener("dom-ready",r);this.m_startTimeDomReady=Date.now();u=t.podsurl+"PowerPointLoader.aspx";this.m_webviewFrame.src=""+u},n.prototype.postMessageDownward=function(n){var t;try{n&&n.m_id==null&&(n.m_id=this.m_hostSessionId);this.m_webviewFrame.send(this.parentToWebviewChannelName,n)}catch(i){(t=this.m_logger)===null||t===void 0?void 0:t.ULS.traceTag(528824524,logCategory.PptSession,logLevel.Error,"WebviewFrameStrategy::postMessageDownward - exception: "+i)}},n.prototype.postMessageWithArrayBufferDownward=function(n,t){var u,i,f,e,r,o;try{i=void 0;this.m_pptFeatureGates.DisableWebviewVideoFrameCopy||t instanceof ArrayBuffer?i=t:(f=new Uint8Array(t),i=new ArrayBuffer(t.byteLength),e=new Uint8Array(i),e.set(f),r=JSON.parse(n),r&&r.sharedArrayBuffer==!0&&(r.sharedArrayBuffer=!1,n=JSON.stringify(r)));o={m_type:99,bufferMetadata:n,arrayBuffer:i};this.postMessageDownward(o)}catch(s){(u=this.m_logger)===null||u===void 0?void 0:u.ULS.traceTag(527303712,logCategory.PptSession,logLevel.Error,"WebviewFrameStrategy::postMessageWithArrayBufferDownward - exception: "+s)}},Object.defineProperty(n.prototype,"slideshowKind",{set:function(n){this.m_slideshowKind=n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"shouldUseAspxForLegacy",{set:function(n){this.m_shouldUseAspxForLegacy=n},enumerable:!1,configurable:!0}),n.prototype.onMessageReceived=function(n){var t,i,f=n&&n.channel,r,u;if(f===this.webviewToParentChannelName&&n.args&&n.args[1])if((t=this.m_logger)===null||t===void 0?void 0:t.ULS.traceTag(523383115,logCategory.PptSession,logLevel.Info,"WebviewFrameStrategy::onMessageReceived - passed event format check"),r=n.args[1],u=PPTMessageListenerRegistry.getInstance(),u){u.onMessage(r);this.m_listenerList.forEach(function(n){n(r)})}else(i=this.m_logger)===null||i===void 0?void 0:i.ULS.traceTag(528824525,logCategory.PptSession,logLevel.Error,"WebviewFrameStrategy::onMessageReceived - no messageRegistry instance")},n}();Microsoft.Office.PowerPoint.Bootstrap=new PPTPreviewerBootstrapper;Microsoft.Office.PowerPoint.Bootstrap.Prefetch=PPTPreviewerBootstrapper.Prefetch;Microsoft.Office.PowerPoint.Bootstrap.GetMinContentVersion=PPTPreviewerBootstrapper.GetMinContentVersion;Microsoft.Office.PowerPoint.Bootstrap.SetPreviewAPIFactory=function(n){PreviewSessionLoader.s_previewAPIFactory=n;PPTMessageListenerRegistry.getInstance().setSliceLoaded()},function(n){n[n.None=0]="None";n[n.Metadata=1]="Metadata";n[n.AllParts=2]="AllParts"}(PresentationUrlGuaranteeLevel||(PresentationUrlGuaranteeLevel={}));PPTPreviewerGetPptFileData=function(){function n(){}return n.isNetworkError=function(n){return n&&n.message=="Failed to fetch"},n.getPresentationUrl=function(t,i,r){return __awaiter(this,void 0,void 0,function(){var b,e,h,k,d,s,g,nt,u,f,c,l,o,a,v,y,p,w;return __generator(this,function(tt){switch(tt.label){case 0:if(tt.trys.push([0,8,,9]),t==null||t.ApplicationCustomSettings==null||t.SessionInformation==null)return[2,Promise.reject(new Error("Empty params"))];b="snapRequestID_"+PPTBootstrapper.generateRandomUUID();e=t.ApplicationCustomSettings.OnDemandServer||"";h=PPTPreviewerBootstrapperUtils.createSnapRequestHeaders(t.SessionInformation.HostSessionId||"",t.SessionInformation.HostName||"",b,t.SessionInformation.CallId||"");k=window.location.search.indexOf("wdAuthHeaderForHostDownloadEnabled")>=0;d=t.ApplicationUrl.indexOf("https://")==0?t.ApplicationUrl.substring(8,t.ApplicationUrl.indexOf("/p/")):"";s={CallID:t.SessionInformation.CallId||"",ContentId:t.SessionInformation.ContentId||"",DownloadUrl:t.WopiPrecheckInfo.FileGetUrl||"",CustomFontCatalogUrl:t.WopiPrecheckInfo.CustomFontCatalogUrl||"",FileExtension:PPTBootstrapper.getFileExtension(t.WopiPrecheckInfo.FileName),FileLengthHint:t.WopiPrecheckInfo.FileSize,ETag:t.WopiPrecheckInfo.ETag||"",DocId:t.WopiPrecheckInfo.DocUniqueId||"",MultiRangeEnabled:!1,TailRangeEnabled:!0,AuthHeaderForHostDownloadEnabled:k,GuaranteeLevel:PresentationUrlGuaranteeLevel.Metadata,FileEnvironment:d};g=t.WopiPrecheckInfo.FileName||"";nt=PPTBootstrapper.isBinaryFile(g,i);u=null;f="";try{f=SnapRegionInfo.getOnDemandSnapServer(t.ApplicationUrl,t);c=0;(r===null||r===void 0?void 0:r.SnapRolloutPercentageForSovereignCloud)&&(r===null||r===void 0?void 0:r.SnapRolloutPercentageForSovereignCloud)>0&&(c=r===null||r===void 0?void 0:r.SnapRolloutPercentageForSovereignCloud);u=SnapRegionInfo.snapFlighting(t.ApplicationUrl,s.CallID,t,i,c);i.ULS.traceTag(540317531,logCategory.PptSession,logLevel.Info,"getPresentationUrl: snap region: "+f==null?"":f.replace("https://","").replace("http://",""));u&&(t.SessionInformation.UseSnapService=u.UseSnap,i.ULS.traceTag(540317532,logCategory.PptSession,logLevel.Info,"getPresentationUrl: snap region enabled:"+u.UseSnap+", isenabled: "+u.Reason+" "))}catch(it){i.ULS.traceTag(540317533,logCategory.PptSession,logLevel.Error,"getPresentationUrl: error in getting snap region: "+JSON.stringify(it))}return(nt||(r===null||r===void 0?void 0:r.DisableNewSnapService))&&(u=null,f="",t.SessionInformation.UseSnapService=!1),t.SessionInformation.SnapUrl=f,f!=""&&u!=null&&u.UseSnap&&(e=f),e+="GetDownloadUrl.ashx",l=r===null||r===void 0?void 0:r.ForceMediaProtocol,l!==undefined&&(e=UrlUtils.addOrReplaceParameterValue(e,"forceMediaProtocol",l)),[4,n._getPresentationUrlWithRetries(e,s,h,i,2)];case 1:return o=tt.sent(),[4,o.json()];case 2:return(a=tt.sent(),!o.ok)?[3,3]:[2,Promise.resolve({presentationUrl:a.SnapUrl})];case 3:return(v=n.s_retryGetPresentationUrlHttpCodes.indexOf(o.status)!==-1,i.ULS.traceTag(538478227,logCategory.PptSession,logLevel.Warning,"getPresentationUrl: service error code "+o.status+"; isRetriable: "+v),!v)?[3,6]:[4,n._getPresentationUrl(e,s,h)];case 4:return y=tt.sent(),[4,y.json()];case 5:return p=tt.sent(),y.ok?[2,Promise.resolve({presentationUrl:p.SnapUrl})]:[2,Promise.reject(new Error(p.ErrorCode||"UnknownError"))];case 6:return[2,Promise.reject(new Error(a.ErrorCode||"UnknownError"))];case 7:return[3,9];case 8:return w=tt.sent(),i.ULS.traceTag(510251284,logCategory.PptSession,logLevel.Error,"getPresentationUrl: caught exception "+w),[2,Promise.reject(w)];case 9:return[2]}})})},n._getPresentationUrlWithRetries=function(t,i,r,u,f){return __awaiter(this,void 0,void 0,function(){var s,e,h,o;return __generator(this,function(c){switch(c.label){case 0:s=new Error("UnknownError");e=0;c.label=1;case 1:if(!(e<f))return[3,6];c.label=2;case 2:return c.trys.push([2,4,,5]),[4,n._getPresentationUrl(t,i,r)];case 3:return h=c.sent(),u.ULS.traceTag(509747974,logCategory.PptSession,logLevel.Info,"getPresentationUrlWithRetries succeeded after retry "+e),[2,h];case 4:return o=c.sent(),s=o,n.isNetworkError(o)?(u.ULS.traceTag(509747973,logCategory.PptSession,logLevel.Error,"getPresentationUrlWithRetries caught retryable exception "+o+", retries left: "+(f-e)),[3,5]):(u.ULS.traceTag(509747972,logCategory.PptSession,logLevel.Error,"getPresentationUrlWithRetries throwing nonretryable exception "+o),[3,6]);case 5:return e++,[3,1];case 6:throw s;}})})},n._getPresentationUrl=function(n,t,i){return fetch(n,{method:"POST",headers:i,body:JSON.stringify(t)})},n.s_retryGetPresentationUrlHttpCodes=[403,404,503],n}();Microsoft.Office.PowerPoint.Bootstrap&&Microsoft.Office.PowerPoint.Bootstrap.SetPreviewAPIFactory(new PreviewAPIV0Factory);PPTBootstrapSettings=function(){function n(){}return n.getAppMetadata=function(){return{AppVersionMajor:1,AppVersionMinor:BuildVersionConfig.BUILD_NUMBER_MINOR,ContentVersionMajor:1,ContentVersionMinor:BuildVersionConfig.BUILD_NUMBER_MINOR,WacCdnVersion:BuildVersionConfig.BUILD_CDN_NUMBER,Environment:"wac"}},n.getCDNManifestMapping=function(){var n={};return n["pptscripts/reader.dione.js"]="pptscripts/4110383a6dd337ba.js",n["pptscripts/reader.calypso.js"]="pptscripts/011f5a9f1a7d5aa3.js",n["pptscripts/babylon.js"]="pptscripts/9ae9bf21b21daf84.js",n["pptpages/powerpointframe.html"]="pptpages/492eb0938dfb7e14.html",n["pptscripts/powerpoint.boot.vslice.js"]="pptscripts/8aa15651170374dd.js",n},n.viewerSliceBootstrapper=function(){return"https://contentstorage.osi.office.net/scripts/pptscripts/8aa15651170374dd.js"},n}();