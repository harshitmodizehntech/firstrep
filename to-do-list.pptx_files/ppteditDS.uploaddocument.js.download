'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[27],{1904:function(y,C,a){a.r(C);y=a(0);var c=a(95);class b{get name(){return"Ppt.UploadDocument"}oc(Ca){this.ga=Ca}init(){this.ga.resolve("Common.IInsertFileUploader")}static main(){c.a.instance.Jc(new b)}dispose(){}}Object(y.a)(b,"PptUploadDocumentPackage",null,[4,5]);var d=a(405),e=a(21),h=a(15);class n{constructor(Ca,Fa){this.start=Ca;this.end=Fa}}Object(y.a)(n,"SliceByteRange",null,[]);var m=a(41),k=a(99),l=
a(181),u=a(64),r=a(23);class x{constructor(Ca,Fa,ya,Ua){this.rsf=null;this.RSe=0;this.NHa=1E3;this.WGb=Ca;this.pSm=Fa;this.RNm=ya;this.yai=Ua}Bfo(){this.rsf=x.H5m(this.WGb);const Ca=this.WGb.slice(this.rsf.ka(0).start,this.rsf.ka(0).end);this.tCl(Ca,0)}tCl(Ca,Fa){const ya=x.Bhn(this.WGb.size,this.rsf.ka(Fa));this.RSe++;x.GMf(this.pSm,Ca,Ua=>{if(Ua.status===l.a.OOl)this.oUn(Fa);else if(Ua.status===l.a.sDc){d.ULS.sendTraceTag(508822418,231,50,"MSO:BlobSlicer: File created successfully");try{var Ia;
let Oa;if(!({NB:Oa}=h.d(Ua.responseText)).returnValue)throw Error.create("Unable to deserialize OneDriveItem response json");(Ia=Oa)?this.RNm(Ia):(d.ULS.sendTraceTag(508822417,231,10,"MSO:BlobSlicer: OneDriveItem is null"),this.yai(2))}catch(Oa){d.ULS.sendTraceTag(508822416,231,10,"Exception while parsing OneDriveItemResponse {0}",Oa.message),this.yai(2)}}else this.G8n(Ca,Fa,Ua.status)},ya)}oUn(Ca){d.ULS.sendTraceTag(508822415,231,50,"MSO:BlobSlicer Slice uploaded successfully. SliceNumber {0}, UploadAttempts {1}",
Ca,this.RSe);this.xvm();var Fa=this.rsf.ka(Ca+1);Fa=this.WGb.slice(Fa.start,Fa.end);this.tCl(Fa,Ca+1)}G8n(Ca,Fa,ya){1>this.RSe&&x.kyn(ya)?(d.ULS.sendTraceTag(508822414,231,10,"MSO:BlobSlicer: Retrying Slice upload request. Failure statusCode: {0}, attempts {1}",ya,this.RSe),m.AFrameworkApplication.Zd.Rb(new k.a(2,1,this.NHa,()=>{this.tCl(Ca,Fa)},42)),this.NHa*=2):(d.ULS.sendTraceTag(508822413,231,10,"MSO:BlobSlicer: Slice upload request failed, aborting the upload. Failure statusCode: {0}, attempts {1}",
ya,this.RSe),this.xvm(),this.yai(1,ya))}xvm(){this.RSe=0;this.NHa=1E3}static H5m(Ca){const Fa=new e.a;Ca=Ca.size;const ya=Math.ceil(Ca/5242880);let Ua=0,Ia;for(let Oa=0;Oa<ya;Oa++)Ia=Math.min(Ua+5242880,Ca),Fa.add(new n(Ua,Ia)),Ua=Ia;return Fa}static Bhn(Ca,Fa){const ya=new r.a;ya.fa("Content-Range",String.format("bytes {0}-{1}/{2}",Fa.start,Fa.end-1,Ca));ya.fa("Accept","application/json");return ya}static GMf(Ca,Fa,ya,Ua){const Ia=new XMLHttpRequest;Ia.open("PUT",Ca,!0);if(Ua)for(const Oa of Ua)Ia.setRequestHeader(Oa.key,
u.a.jna(Oa.value));Ia.onreadystatechange=()=>{4===Ia.readyState&&ya(Ia)};Ia.send(Fa)}static kyn(Ca){switch(Ca){case l.a.vZa:case l.a.R8l:case l.a.KGh:case l.a.Cxm:case l.a.l1l:return!0;default:return!1}}}Object(y.a)(x,"BlobSlicer",null,[]);var v=a(142),z=a(69),A=a(59);const B=()=>"%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M12.9993%2017C12.9993%2016.4484%2012.5522%2016.0013%2012.0006%2016.0013C11.4491%2016.0013%2011.002%2016.4484%2011.002%2017C11.002%2017.5515%2011.4491%2017.9986%2012.0006%2017.9986C12.5522%2017.9986%2012.9993%2017.5515%2012.9993%2017ZM12.7401%209.1467C12.6901%208.78066%2012.3761%208.49876%2011.9964%208.49906C11.5822%208.49939%2011.2467%208.83545%2011.247%209.24966L11.2506%2013.7513L11.2575%2013.853C11.3075%2014.2191%2011.6215%2014.501%2012.0012%2014.5007C12.4154%2014.5003%2012.7509%2014.1643%2012.7506%2013.7501L12.747%209.24846L12.7401%209.1467ZM13.9693%203.65888C13.113%202.11108%2010.8878%202.1111%2010.0316%203.65893L2.28634%2017.6604C1.45678%2019.16%202.5414%2020.9995%204.25518%2020.9995H19.7462C21.46%2020.9995%2022.5446%2019.16%2021.715%2017.6603L13.9693%203.65888ZM11.3442%204.38501C11.6296%203.86907%2012.3713%203.86906%2012.6567%204.38499L20.4025%2018.3865C20.679%2018.8863%2020.3175%2019.4995%2019.7462%2019.4995H4.25518C3.68392%2019.4995%203.32238%2018.8863%203.5989%2018.3865L11.3442%204.38501Z%22%20fill%3D%22%23817400%22%2F%3E%0A%3C%2Fsvg%3E%0A",
G=(Ca,Fa)=>{appChrome.PRIToastManager.showToastForUploadFile("",Ca,Fa);Ca=new k.a(2,m.AFrameworkApplication.ha&&m.AFrameworkApplication.ha.isChangeGateEnabled("FixEarlyToastDismissIssue")?1:2,8E3,w,0);m.AFrameworkApplication.Zd.Rb(Ca)},w=()=>{appChrome.PRIToastManager.dismissToast()},F=Ca=>{const Fa='\\/:*?"<>|'.split(""),ya=new Sys.StringBuilder("");if(!Ca||""===Ca)return d.ULS.sendTraceTag(508672207,231,10,"MSO:InsertFileUploaderUtils: Empty File Name"),G(Object(A.a)("UploadFileWithEmptyFileName"),
B()),!1;if(250<Ca.length)return d.ULS.sendTraceTag(508672206,231,10,"MSO:InsertFileUploaderUtils: File Name larger than limit"),Ca=String.format(Object(A.a)("UploadFileWithLargerFileName"),250),G(Ca,B()),!1;let Ua=!1;for(let Ia=0;Ia<Fa.length;Ia++)ya.append(Fa[Ia]),ya.append(" "),v.a(Ca,Fa[Ia])&&(Ua=!0);return Ua?(d.ULS.sendTraceTag(508672205,231,10,"MSO:InsertFileUploaderUtils: Invalid character in File Name"),Ca=String.format(Object(A.a)("UploadFileWithInvalidCharacterInFileName"),ya.toString()),
G(Ca,B()),!1):!0};var H=a(19),E=a(100),P=a(85);class T{constructor(){this.NIl=this.kEh=this.WGb=null;this.MRe=0;this.VQm=1E3;this.KIl=""}Oxm(Ca){this.KIl=Ca}J2n(Ca){this.yZe()?d.ULS.sendTraceTag(508822472,231,10,"MSO:CloudFileUploadManager:QueueFileUpload There is already an upload in progress"):Ca?(d.ULS.sendTraceTag(508822470,231,50,"MSO:CloudFileUploadManager: File Queued of size: {0} and type: {1}",Ca.size.toString(),Ca.type),this.WGb=Ca,appChrome.PRIToastManager.showToastForUploadFile("",Object(A.a)("UploadFileProcessStartedMessage"),
null,!0),this.Qjd()):d.ULS.sendTraceTag(508822471,231,10,"MSO:CloudFileUploadManager:QueueFileUpload Invalid upload context")}yZe(){return!!this.WGb}Qjd(){let Ca=m.AFrameworkApplication.ha.isChangeGateEnabled("UsePopsServiceForUploadFeature")?String.format("{0}UploadFileToHostHandler.ashx?action=uploadFile&{1}",this.KIl,m.AFrameworkApplication.Fh):String.format("UploadFileToHostHandler.ashx?action=uploadFile&{0}",m.AFrameworkApplication.Fh);Ca=E.a.Ova(Ca,"filename",this.WGb.name);const Fa=["request-id"];
this.MRe++;const ya={};ya.ismsa=m.AFrameworkApplication.ha.getBooleanAppSetting("IsO365ConsumerHost");try{this.HRm=Date.now(),m.AFrameworkApplication.$d.ik(Ca,1,null,ya,!1,2,Ua=>{this.DMf(Ua)},Ua=>{this.D8n(Ua)},null,void 0,void 0,void 0,3E4,void 0,void 0,void 0,void 0,Fa)}catch(Ua){d.ULS.sendTraceTag(508822469,231,10,"MSO:CloudFileUploadManager: Exception when creating uploadSession {0}",Ua.message),this.QZg(0)}}D8n(Ca){2>this.MRe?(d.ULS.sendTraceTag(508822468,231,10,"MSO:CloudFileUploadManager: CreateUploadSession request failed with code: {0}, with correlation and request id {1} and attempts {2}",
Ca.data.Je,Ca.data.gj,this.MRe),this.Qjd()):(d.ULS.sendTraceTag(508822467,231,10,"MSO:CloudFileUploadManager: CreateUploadSession request failed with code: {0}, with correlation and request id {1} and attempts {2}",Ca.data.Je,Ca.data.gj,this.MRe),this.QZg(0,Ca.data.Je))}DMf(Ca){d.ULS.sendTraceTag(508822466,231,50,"MSO:CreateUploadSessionRequestSucceeded:CloudFileUploadManager CloudAttachment request succeeded with code: {0}, with correlation and request id {1} and message {2} and attempts {3}",Ca.data.Je,
Ca.data.gj,Ca.data.responseData,this.MRe);try{var Fa;let ya;if(!({NB:ya}=h.d(Ca.data.responseData)).returnValue)throw Error.create("Unable to deserialize uploadSession response json");(Fa=ya)&&Fa.uploadUrl&&""!==Fa.uploadUrl?this.bno(Fa.uploadUrl):(d.ULS.sendTraceTag(507901398,231,10,"createUploadSessionRequestSucceeded: upload session created: {0}",Fa?!0:!1),this.QZg(0))}catch(ya){d.ULS.sendTraceTag(508822465,231,10,"MSO:CreateUploadSessionRequestSucceeded:CloudFileUploadManager Exception while parsing OneDriveItemResponse {0}",
ya.message),this.QZg(0)}}bno(Ca){this.NIl=new x(this.WGb,Ca,Fa=>{this.W1m(Fa)},(Fa,ya)=>{this.QZg(Fa,ya)});m.AFrameworkApplication.Zd.Rb(new k.a(2,1,this.VQm,()=>{this.NIl.Bfo()},42))}W1m(Ca){this.yZe()?(this.kEh=Ca,this.z1(!0)):d.ULS.sendTraceTag(508822464,231,15,"MSO:CloudFileUploadManager:CompleteUpload There is no upload in progress")}QZg(Ca,Fa=0){this.yZe()?(d.ULS.sendTraceTag(507901397,231,10,"onFileUploadFailed: failureType {0} with status {1}",Ca,Fa),Ca=this.Wgn(Fa),G(Ca,B()),this.z1(!1)):
d.ULS.sendTraceTag(508822435,231,15,"MSO:CloudFileUploadManager:OnFileUploadFailed There is no upload in progress, failureType {0}",Ca)}Wgn(Ca=0){switch(Ca){case 507:return Object(A.a)("UploadFileInsufficientStorageError");default:return Object(A.a)("UploadFileInternalServerError")}}z1(Ca){this.yZe()?(Ca&&(d.ULS.sendTraceTag(508703698,231,50,"MSO:CloudFileUploadManager: File successfully uploaded"),Ca=Date.now()-this.HRm,d.ULS.sendTraceTag(508044241,231,50,"TimeTaken: {0} to upload a file of Size:{1}",
Ca,this.WGb.size.toString()),this.WGb.name!==this.kEh.name&&d.ULS.sendTraceTag(508672208,231,50,"MSO:CloudFileUploadManager: Renamed file name"),appChrome.PRIToastManager.dismissToast(),P.a.KWd(this.kEh.webUrl),H.a.dispatch("fileUploadedSuccessfully")),this.WGb=null,this.MRe=0,this.kEh=null):d.ULS.sendTraceTag(508822434,231,15,"MSO:CloudFileUploadManager: There is no upload in progress")}}Object(y.a)(T,"CloudFileUploadManager",null,[1170]);var K=a(50),M=a(1193),N=a(6);class I{constructor(Ca,Fa,ya){this.Zed=
this.bom=null;this.iHb=this.Heb=0;this.kDh=null;this.GRn=Ua=>{if(this.ADl(Ua)){if(z.a.Ey||z.a.Yf)this.kDh=Ua;this.A4a(this.Zed)}};this.Iu=Ca;this.Ce=Fa;this.Ga=ya;this.wZi=!1;this.PEm=!0;this.c8n();this.r1e=this.ha.getBooleanAppSetting("NativeFileOpenDialogIsEnabled")}get context(){return this.Iu}get ha(){return this.Ga}get retryCount(){return this.Heb}get soc(){return this.iHb}mnc(Ca){this.Zed=Ca;if(!this.wZi){if(this.PEm){if(this.r1e&&z.a.Ey){this.kDh=Ca.SWb(this.GRn);return}this.kDh=Ca.SWb(null);
if(!this.ADl(this.kDh))return}this.A4a(Ca)}}Mhb(){this.bom&&this.bom()}c8n(){this.Heb=0;this.iHb=this.ha.Ac("Box4UploadRetryDelayStart",200);this.Zed&&(this.Zed.dispose(),this.Zed=null)}}Object(y.a)(I,"FileUploader",null,[]);var O=a(114);const Q=(Ca,Fa,ya)=>{if(Ca){var Ua=0;do{try{Ca();break}catch(Ia){if(d.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",Ua,ya,Ia.message,Ia.stack),Ua>=Fa)break}Ua++}while(1)}};var U=a(221),ba=a(198),
aa=a(1631),La=a(132);class Z{constructor(Ca,Fa,ya,Ua,Ia,Oa,ma,za,Qa=!0,Xa=null,Tb=!1,Kb=null){this.s0l="FileUpload.ashx";this.vO=null;this._initialized=!1;this.gk=this.cgf=this.vai=this.kFh=this.hDh=this.e2=this.Hva=null;this.Bn=!1;this.Eaa=this.jDh=this.rni=null;this.dbn=()=>{this.hDh&&(this.hDh.innerText=this.Vhn())};this.Lve=()=>{try{if(!this.vO.contentWindow.document.body)return}catch(Ka){return}if(!(this._initialized||this.r1e&&z.a.Ey))this.yFc();else if(!this.r1e||!z.a.Ey||this.Dxn){var nb=
this.vO.contentWindow.document.body.innerText.toLowerCase();const Ka=0<=nb.indexOf("responses")||0<=nb.indexOf("wopisrc");nb=0<=nb.indexOf("http error");!Ka&&nb&&d.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this.vO.contentWindow.document.body.innerText)}};this._parent=Ca;this.vOm=Fa;this.qKl=Ia;this.Nrf=ma;this.qIl=za;this.mMl=Kb;this.aJl=Xa;this.qni=!1;this.IOm=Ua.getBooleanAppSetting("CanaryRenewalForFileUploadIsEnabled");(this.$gd=Tb)||this.HKf(Oa);
Qa&&this.B8l()}get sessionId(){return this.Nrf}get iFrame(){return this.vO}get gKh(){return this.e2}get r1e(){return m.AFrameworkApplication.ha?m.AFrameworkApplication.ha.getBooleanAppSetting("NativeFileOpenDialogIsEnabled"):!1}get m0l(){return m.AFrameworkApplication.ha?m.AFrameworkApplication.ha.getBooleanAppSetting("FileInputDescriptionAccessibilityIsEnabled"):!1}get dno(){return m.AFrameworkApplication.ha?m.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.UploadDocumentFromPCIsEnabled",
!1):!1}get Dxn(){return this.$gd?!1:v.b(this.vO.contentWindow.location.pathname,this.s0l,0)}get AWm(){return!z.a.$y&&m.AFrameworkApplication.ha.getBooleanAppSetting("AllowMultipleImageInsertFromLocalDevice")}B8l(){this.Eaa=La.a.create().toString();this.$gd?this.yFc():this.cXm()}HKf(Ca){this.vO=document.createElement("iframe");this.vO.className=Ca;this.vO.id=Ca;this.qKl&&(this.vO.style.visibility="visible",this.vO.style.height="30px",this.vO.setAttribute("frameborder","0"));this.kFh=this.Lve;O.a.addHandler(this.vO,
"load",this.kFh)}SWb(Ca=null){m.AFrameworkApplication.Ha.cUa();if(!this.e2)return d.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";O.a.addHandler(this.e2,"change",()=>{this.GVf(Ca)});Q(Object(N.a)(this,this.ebn,"fileInputClick"),1,"DoFileOpenDialog");return this.e2.value}GVf(Ca){Ca&&Ca(this.e2.value)}Vhn(){let Ca=null;if(this.e2.value){const Fa=this.e2.value,ya=Fa.lastIndexOf("\\");0<ya&&(Ca=Fa.substring(ya+1,Fa.length))}return Ca?Ca:""}ebn(){try{d.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),
this.e2.click()}catch(Ca){throw d.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",Ca.message),Ca;}}D0h(){this.xyn()?this.Q6e():(this.eCl(),this.Hva.submit())}xyn(){return(this.IOm||this.$gd)&&!(void 0===window.self.FormData||null===window.self.FormData)}s5e(Ca){if(Ca){const Fa=this.aWl();this.gk=new XMLHttpRequest;this.gk.open("POST",Fa);this.gk.setRequestHeader("X-CorrelationId",this.Eaa);this.RBn(Ca);this.gk.onreadystatechange=Object(N.a)(this,this.ceb,"uploadResponseReceived");
this.gk.send(Ca)}}RBn(Ca){if(!z.a.$y&&Ca.get){var Fa=Ca.get("ImageId");Ca=window.self.navigator;Fa={["CorrelationId"]:this.Eaa,["Canary"]:m.AFrameworkApplication.ZC,["ImageNodeId"]:Fa};Ca&&(Ca=Ca.connection?Ca.connection:Ca.mozConnection?Ca.mozConnection:Ca.webkitConnection?Ca.webkitConnection:null)&&(Fa.effectiveType=Ca.effectiveType,Fa.downlink=Ca.downlink,Fa.type=Ca.type,Fa.rtt=Ca.rtt);d.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",Fa)}}Q6e(){try{this.eCl();d.ULS.sendTraceTag(594888409,
322,50,"SubmitFormWithRequest is preparing to send an upload request");const Ca=new (Type.parse("FormData"))(this.Hva);this.s5e(Ca)}catch(Ca){d.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+Ca.message)}}vho(Ca){try{if(this.eCl(),d.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.eoo(Ca)){this.jDh=Ca;this.Hva.contains(this.e2)&&this.Hva.removeChild(this.e2);var Fa=new (Type.parse("FormData"))(this.Hva);
Fa.append("applicationfileInput",Ca.blob,Ca.filename);this.s5e(Fa)}}catch(ya){d.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+ya.message)}}eoo(Ca){return Ca&&void 0!==Ca.blob&&null!==Ca.blob&&void 0!==Ca.filename&&null!==Ca.filename&&""!==Ca.filename?void 0===window.self.FormData||null===window.self.FormData?(d.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(Ca=Ca?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",
void 0===Ca.blob||null===Ca.blob,void 0===Ca.filename||null===Ca.filename||""===Ca.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",d.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",Ca)),!1)}ceb(){if(4===this.gk.readyState)if(200===this.gk.status){d.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.Eaa);const Ca=this.gk.getResponseHeader("X-NewKey"),Fa=this.twn(this.gk);
let ya=!1;if(void 0!==Ca&&null!==Ca&&Fa&&(ya=this.Zno(Ca),!this.qni&&ya)){d.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.Eaa);this.qni=!0;void 0!==this.jDh&&null!==this.jDh?this.vho(this.jDh):this.Q6e();return}d.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.qni,Fa,!(void 0===
Ca||null===Ca),ya,this.Eaa)}else d.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.gk.status,this.gk.responseText?!1:!0,this.Eaa)}twn(Ca){try{const Fa=h.a(Ca.responseText).Responses;if(void 0!==Fa&&null!==Fa&&1===Fa.length){const ya=Fa[0];if(void 0!==ya&&null!==ya&&2===ya.length&&28===ya[1].StatusCode)return!0}}catch(Fa){}return!1}Zno(Ca){aa.a.tic(Ca);return m.AFrameworkApplication.ZC!==Ca?!1:!0}eCl(){this.rni||(this.rni=new Date)}dispose(){this.Bn||
(this.$gd?this._parent.removeChild(this.Hva):(this._parent.removeChild(this.vO),O.a.removeHandler(this.vO,"load",this.kFh),this.kFh=null),this.vai&&(O.a.removeHandler(this.e2,"change",this.vai),this.vai=null),this.m0l&&(this.cgf&&(O.a.removeHandler(this.e2,"change",this.cgf),this.cgf=null),this.hDh=null),this.e2=this.Hva=this._parent=this.vO=null,this.Bn=!0,this.rni=null,d.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}OIh(){this.dispose()}z4m(Ca){if(this.Hva){var Fa;(Fa=this.Hva.querySelector("input[name=__REQUESTDIGEST]"))?
Fa.value=Ca:(Fa=this.tLf(),Fa.type="hidden",Fa.id="__REQUESTDIGEST",Fa.name="__REQUESTDIGEST",Fa.value=Ca,this.Hva.appendChild(Fa))}}tLf(){return this.$gd?document.createElement("input"):this.vO.contentWindow.document.createElement("input")}yFc(){if(!this._initialized){var Ca=this.j1("uploadForm");const Fa=this.j1("fileInput"),ya=this.aWl();this.r4m();this.Hva.id=Ca;this.Hva.method="post";this.Hva.encoding="multipart/form-data";this.Hva.action=ya;this.e2.type="file";this.qIl&&(this.e2.accept=this.qIl,
this.aJl&&(this.e2.capture=this.aJl));this.e2.id=Fa;this.e2.name=Fa;this.AWm&&(this.e2.multiple=!0);this.dno&&("true"===this.mMl?this.e2.multiple=!0:"false"===this.mMl&&(this.e2.multiple=!1));!this.m0l||z.a.ek||z.a.rn||(this.cgf=this.dbn,O.a.addHandler(this.e2,"change",this.cgf),this.hDh=U.a.tGh(this.Hva,this.e2,"InputFileDescription",""));this.qKl&&(this.$gd||(Ca=this.vO.contentWindow.document.body,Ca.style.margin="0",Ca.style.overflow="hidden"),Ca=m.AFrameworkApplication.Ha,this.e2.style.fontFamily=
Ca.saa,this.e2.style.fontSize=Ca.Ntd,this.e2.style.margin="0");(Ca=document.getElementById("__REQUESTDIGEST"))&&this.z4m(Ca.value);this.Hva.appendChild(this.e2);this._initialized=!0;this.vOm(this)}}r4m(){if(this.$gd)this.Hva=document.createElement("form"),this._parent.appendChild(this.Hva),this.e2=document.createElement("input");else{this.Hva=this.vO.contentWindow.document.createElement("form");const Ca=this.vO.contentWindow.document;Ca.body.appendChild(this.Hva);this.e2=Ca.createElement("input")}}cXm(){this._parent.appendChild(this.vO);
this.r1e&&z.a.Ey&&this.yFc()}aWl(){var Ca=new ba.QueryStringBuilder(this.s0l);m.AFrameworkApplication.Peb(Ca);Ca=Ca.toString();if(z.a.Yf||z.a.Ey||z.a.rn)Ca=E.a.ZAa(Ca);return Ca}}Object(y.a)(Z,"UploadFrame",null,[40]);class la extends Z{constructor(Ca,Fa,ya,Ua,Ia,Oa,ma=null,za,Qa=!1){super(Ca,Fa,ya,Ua,Ia,"WACUploadFrame",m.AFrameworkApplication.userSessionId,Oa,void 0,ma,Qa,"false");this.B8l()}j1(){return La.a.create().toString()}}Object(y.a)(la,"FileUploadFrame",Z,[]);class da extends I{constructor(Ca,
Fa,ya){super(Ca,Fa,ya);this.dM=this.dJl=null;this.HRn=Ua=>{Ua?(Ua=Ua.split("/"),Ua=Ua[Ua.length-1].split("\\"),Ua=Ua[Ua.length-1]):Ua=null;this.coo(Ua)&&this.A1m.J2n(this.Zed.gKh.files[0])};this.brk=0;this.ewi=new e.a}get ffa(){return this.dM||(this.dM=Object(M.a)())}get A1m(){return this.dJl||(this.dJl=K.a.instance.resolve("Common.App.UploadFromPC.ICloudFileUploadManager"))}xym(Ca){this.brk=Ca}Jxm(Ca){this.ewi=Ca}get ino(){return"InsertFile"}showDialog(){var Ca;if((Ca=this.ewi)&&Ca.count){var Fa=
new Sys.StringBuilder(""),ya=Ca.count;for(let Ua=0;Ua<ya-1;Ua++)Fa.append("."),Fa.append(Ca.ka(Ua)),Fa.append(", ");Fa.append(".");Fa.append(Ca.ka(ya-1));Ca=Fa.toString()}else Ca="";""===Ca?G(Object(A.a)("UnableToOpenFilePickerDialog"),B()):void 0!==window.self.FormData&&null!==window.self.FormData?(this.wZi=!1,this.Zed=new la(document.body,Object(N.a)(this,this.mnc,"onUploadFrameInitialized"),Object(N.a)(this,this.ceb,"uploadResponseReceived"),this.ha,!1,Ca,void 0,void 0,!0)):z.a.ek||z.a.rn||this.r1e&&
z.a.Ey?d.ULS.sendTraceTag(508699840,231,50,"MSO:InsertFileUploader: Dialog not rendered for OpenFilePickerDirectly: {0}",z.a.ek||z.a.rn):d.ULS.sendTraceTag(508822474,231,50,"MSO:InsertFileUploader: Dialog not rendered")}mnc(Ca){this.Zed=Ca;this.wZi||(this.PEm?(d.ULS.sendTraceTag(508703702,231,50,"MSO:InsertFileUploader: Insert file uploader frame opened"),Ca.SWb(this.HRn)):this.A4a(Ca))}coo(Ca){if(!this.ADl(Ca))return!1;if(!this.doo(Ca))return d.ULS.sendTraceTag(508703700,231,10,"MSO:InsertFileUploader: Invalid File Extension"),
G(Object(A.a)("UploadFileWithInvalidExtension"),B()),!1;Ca=this.nan(this.Zed);var Fa=this.brk;d.ULS.sendTraceTag(508822419,231,50,"{0}:Size:{1}",this.ino,Ca);if(!(0<Ca&&Ca<=1048576*Fa))return d.ULS.sendTraceTag(508703699,231,10,"MSO:InsertFileUploader: Invalid File Size"),Ca=String.format(Object(A.a)("UploadFileLargerThanMaxSize"),this.brk),G(Ca,B()),!1;d.ULS.sendTraceTag(508822473,231,50,"MSO:InsertFileUploader: Cloud File Upload of size: {0}",Ca);return!0}doo(Ca){Ca=RegExp("\\.([a-zA-Z0-9]{1,5})$").exec(Ca);
return this.ewi.contains(Ca&&2===Ca.length?Ca[1]:null)}ADl(Ca){return F(Ca)}A4a(){this.cno()}nan(Ca){return Ca.gKh.files[0].size}ceb(){}cno(){this.Mhb();this.ffa.maa(Object(A.a)("UploadCompletedText"),!0)}}Object(y.a)(da,"InsertFileUploader",I,[1171]);class J{constructor(){this.Oa=null}get name(){return"Common.App.UploadFromPC"}init(){}dispose(){}oc(Ca){this.Oa=Ca;this.Oa.register(1170,"Common.App.UploadFromPC.ICloudFileUploadManager").oa().pa(()=>new T);this.Oa.register(1171,"Common.IInsertFileUploader").oa().pa(()=>
new da(null,m.AFrameworkApplication.Zd,m.AFrameworkApplication.ha))}static main(){c.a.instance.Jc(new J,7)}}Object(y.a)(J,"FileUploaderPackage",null,[4,5]);Type.registerNamespace("PowerPointWebEditor.UploadFromPC");Type.registerNamespace("Common.App.UploadFromPC");J.main();b.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25649181/wdjs/ppteditDS.uploaddocument.js.map