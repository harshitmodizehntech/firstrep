'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[20],{1136:function(y,C,a){function c(){var d,e;return(null!==(e=null===(d=b.AFrameworkApplication.ha)||void 0===d?void 0:d.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldUseSessionExpirationManagerWithRefreshV2",!1))&&void 0!==e?e:!1)&&b.AFrameworkApplication.Iz&&2==b.AFrameworkApplication.F2h}a.d(C,"a",function(){return c});var b=a(41)},1137:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}
c.qjm=31E3;c.lrk=8E3;Object(y.a)(c,"RealtimeChannelStaticConstants",null,[])},1430:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.hOl=!1;this.Rhi=null;this.sJl=0;this.Gai=this.gXl();this.KCh=this.gXl();this.Rwd=this.bSe=0;this.getCurrentTime=()=>new Date}get Cho(){return this.hOl}gXl(){const b=Array(6);for(let d=0;d<b.length;d++)b[d]=0;return b}khn(){return this.Gai.toString()}rfn(){return this.KCh.toString()}Igo(){this.Rhi=this.getCurrentTime()}Q$g(b,d,e=!1){this.Cho||
(e&&(this.hOl=!0),e=this.getCurrentTime(),0===b&&5<this.bSe||1===b&&5<this.Rwd||(this.sJl<b?(1===this.bSe%2&&(this.Gai[this.bSe]=-1,this.bSe++),this.sJl=b,1===d&&(this.KCh[this.Rwd]=-1,this.Rwd++),this.KCh[this.Rwd]=this.Znl(e),this.Rwd++):0===b?(this.Gai[this.bSe]=this.Znl(e),this.bSe++):(this.KCh[this.Rwd]=this.Znl(e),this.Rwd++)))}Znl(b){const d=b.getTime()-this.Rhi.getTime();this.Rhi=b;return d}static get instance(){c.Qa||(c.Qa=new c);return c.Qa}static set instance(b){c.Qa=b}}c.Qa=null;Object(y.a)(c,
"LatencyMetrics",null,[])},1431:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(b,d,e,h){this.GIn=b;this.Vcd=d;this.uIn=e;this.Ann=h}}Object(y.a)(c,"ThrottlerManagerSettings",null,[])},1465:function(y,C,a){a.d(C,"a",function(){return w});y=a(0);class c extends Sys.EventArgs{constructor(F,H){super();this.newState=F;this.oldState=H}}Object(y.a)(c,"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);class b extends Sys.EventArgs{constructor(F,H){super();this.i1m=F;this.uFb=
H}}Object(y.a)(b,"ClientInfoEventArgs",Sys.EventArgs,[]);class d extends Sys.EventArgs{constructor(F){super();this.presence=F}}Object(y.a)(d,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);class e extends Sys.EventArgs{constructor(F){super();this.BKi=F}}Object(y.a)(e,"PersistentStateClearedEventArgs",Sys.EventArgs,[]);class h extends Sys.EventArgs{constructor(F,H){super();this.type=F;this.e8e=H}}Object(y.a)(h,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var n=a(1813);class m extends Sys.EventArgs{constructor(F,
H=null){super();this.xK=F;this.nSm=H}get type(){return this.xK}get tpc(){return this.nSm}}Object(y.a)(m,"UpdateNotificationEventArgs",Sys.EventArgs,[]);class k extends Sys.EventArgs{constructor(F){super();this.m1n=F}}Object(y.a)(k,"GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs,[]);class l extends Sys.EventArgs{constructor(F,H,E,P,T,K){super();this.l8e=F;this.zOi=H;this.p2m=E;this.A_l=T;this.UJi=P;this.yE=K}}Object(y.a)(l,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);class u extends Sys.EventArgs{constructor(F){super();
this.hubConnection=F}}Object(y.a)(u,"RefreshProxyEventArgs",Sys.EventArgs,[]);class r extends Sys.EventArgs{constructor(F,H){super();this.Man=F;this.errorMessage=H}}Object(y.a)(r,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);class x extends Sys.EventArgs{constructor(F,H,E){super();this.type=F;this.presence=H;this.uFb=E}}Object(y.a)(x,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var v=a(1623);class z extends Sys.EventArgs{constructor(){super()}}Object(y.a)(z,"SessionPropertiesChangedEventArgs",
Sys.EventArgs,[]);class A extends Sys.EventArgs{constructor(F){super();this.BKi=F}}Object(y.a)(A,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);class B extends Sys.EventArgs{constructor(F,H){super();this.type=F;this.ano=H}}Object(y.a)(B,"UpdatePersistentStateRequestEventArgs",Sys.EventArgs,[]);var G=a(30);class w{constructor(){this.nb=new G.a}M2n(F,H){this.nb.raiseEvent("CSC",new c(F,H))}X2n(F){this.nb.raiseEvent("RP",new u(F))}GXh(F){this.nb.raiseEvent("RC",F)}Z2n(){this.nb.raiseEvent("RMID")}W2n(F,
H,E,P,T,K){this.nb.raiseEvent("RPS",new l(F,H,E,P,T,K))}Asm(F,H){this.nb.raiseEvent("UPSR",new B(F,H))}psm(F,H){this.nb.raiseEvent("PU",new n.a(F,H))}R2n(F){this.nb.raiseEvent("MPU",new d(F))}MQk(F,H,E,P){this.nb.raiseEvent("SUN",new v.a(F,H,E,P))}k3n(F,H){this.nb.raiseEvent("UNR",new m(F,H))}xsm(F,H,E){this.nb.raiseEvent("SP",new x(F,H,E))}osm(F,H){this.nb.raiseEvent("PSU",new h(F,H))}V2n(F){this.nb.raiseEvent("PSC",new e(F))}Q2n(F){this.nb.raiseEvent("IPSC",new e(F))}l3n(F){this.nb.raiseEvent("UPSC",
new A(F))}$2n(F,H){this.nb.raiseEvent("SPC",new z(F,H))}vsm(F,H){this.nb.raiseEvent("RCF",new r(F,H))}P2n(F){this.nb.raiseEvent("CPSWM",new k(F))}j3n(F,H){this.nb.raiseEvent("UCI",new b(F,H))}SJd(F){this.nb.addHandler("CSC",F)}wYk(F){this.nb.removeHandler("CSC",F)}EVm(F){this.nb.addHandler("RP",F)}I6n(F){this.nb.removeHandler("RP",F)}DVm(F){this.nb.addHandler("RC",F)}H6n(F){this.nb.removeHandler("RC",F)}JVm(F){this.nb.addHandler("RMID",F)}CVm(F){this.nb.addHandler("RPS",F)}G6n(F){this.nb.removeHandler("RPS",
F)}XVm(F){this.nb.addHandler("UPSR",F)}T6n(F){this.nb.removeHandler("UPSR",F)}RFh(F){this.nb.addHandler("PU",F)}ZUm(F){this.nb.addHandler("IPU",F)}o6n(F){this.nb.removeHandler("IPU",F)}VVm(F){this.nb.addHandler("UCI",F)}R6n(F){this.nb.removeHandler("UCI",F)}MVm(F){this.nb.addHandler("SUN",F)}M6n(F){this.nb.removeHandler("SUN",F)}$Um(F){this.nb.addHandler("IUNR",F)}p6n(F){this.nb.removeHandler("IUNR",F)}Myc(F){this.nb.addHandler("UNR",F)}YUm(F){this.nb.addHandler("IPSU",F)}n6n(F){this.nb.removeHandler("IPSU",
F)}XUm(F){this.nb.addHandler("IPSC",F)}m6n(F){this.nb.removeHandler("IPSC",F)}WVm(F){this.nb.addHandler("UPSC",F)}S6n(F){this.nb.removeHandler("UPSC",F)}LVm(F){this.nb.addHandler("SP",F)}L6n(F){this.nb.removeHandler("SP",F)}yQl(F){this.nb.addHandler("SPC",F)}N6n(F){this.nb.removeHandler("SPC",F)}KVm(F){this.nb.addHandler("RCF",F)}WUm(F){this.nb.addHandler("CPSWM",F)}l6n(F){this.nb.removeHandler("CPSWM",F)}static getInstance(){return w.Qa||(w.Qa=new w)}}w.Qa=null;Object(y.a)(w,"RtcEventHub",null,[1184])},
1623:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c extends Sys.EventArgs{constructor(b,d,e,h){super();this.type=b;this.tpc=d;this.i7m=e;this.uFb=h}}Object(y.a)(c,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},1624:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);var c;(function(b){b[b.disconnected=0]="disconnected";b[b.connecting=1]="connecting";b[b.connected=2]="connected"})(c||(c={}));Object(y.b)("ChannelConnectionState",c)},1625:function(y,C,a){a.d(C,"a",function(){return c});
y=a(0);class c{}c.P3k="rr";c.W8n="rd";c.S8n="rbp";c.q7k="sa";Object(y.a)(c,"RtcReconnectParams",null,[])},1626:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}c.mre="throttling_messageDelay";c.qZe="enabled";c.Vcd="throttling_timeToWaitForResponse";c.Yqe="throttling_maxNumberOfOutstandingMessages";c.Qvj="throttling_globalMaxNumberOfOutstandingMessages";c.errorMessage="errorMessage";c.Wkl="url";c.Zhb="queryString";c.x$="connectionString";Object(y.a)(c,"RtcFindSessionOutputFieldNameConstants",
null,[])},1627:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.EMh=this.vUh=this.wUh=this.xUh=0;this.zjg=!1;this.correlationId=this.x$=this.Zhb=this.nJf=this.errorMessage=null}get hVl(){return this.nJf+"?"+this.Zhb}}Object(y.a)(c,"FindSessionResponse",null,[])},1632:function(y,C,a){a.r(C);a.d(C,"FindSessionStrategy",function(){return N});y=a(0);var c=a(405),b=a(6),d=a(21),e=a(1624),h=a(1626),n=a(41),m=a(100),k=a(85),l=a(653),u=a(17),r=a(64),x=a(132),v=a(1627);class z{}
z.clientId="ClientId";z.Ino="UserApp";z.userSessionId="usid";z.userType="UserType";z.Wno="UserVersion";z.A6c="qs";z.l1m="clientProtocol";z.aPn="NoAuth";Object(y.a)(z,"RtcFindSessionInputQueryParamConstants",null,[]);class A{constructor(I,O,Q,U,ba,aa){this.SEd=null;this.CQm=I;I=String.format("{0}={1}",z.clientId,r.a.yj(U));I=String.format("{0}&{1}={2}",I,z.userSessionId,r.a.yj(ba));I=String.format("{0}&{1}={2}",I,z.Ino,r.a.yj(Q.toString()));I=String.format("{0}&{1}={2}",I,z.userType,r.a.yj("1"));I=
String.format("{0}&{1}={2}",I,z.Wno,r.a.yj(O));I=String.format("{0}&{1}={2}",I,z.l1m,r.a.yj(A.k1m));(O=A.Ben(Q,aa))&&(I=String.format("{0}&{1}",I,O));this.RMm=I}BUk(){this.SEd=this.CQm()}TKh(){this.SEd&&""!==this.SEd||(this.BUk(),c.ULS.sendTraceTag(575784194,500,this.SEd&&""!==this.SEd?50:15,"Query signature delegate called for refresh returned: {0} ",this.SEd));const I=String.format("{0}={1}",z.A6c,r.a.yj(this.SEd));return String.format("{0}&{1}",I,this.RMm)}static Ben(I,O){return 4===I?String.format("{0}={1}",
z.aPn,"1"):O?O.n5l():null}}A.k1m="1.0";Object(y.a)(A,"FindSessionQueryStringGenerator",null,[]);var B=a(1638),G=a(1430),w=a(624),F=a(1431);class H{}H.Ebn="FSType";Object(y.a)(H,"RtcFindSessionRequestHeaders",null,[]);class E{}E.B3n="polling";Object(y.a)(E,"RtcFindSessionTypes",null,[]);var P=a(1625);class T{}T.hoo="RTC-TokenProofkey";T.Ezn="RTC-IsWacJsBootFsRequest";Object(y.a)(T,"RtcRequestHeaders",null,[]);var K=a(336),M=a(1136);class N{constructor(I,O,Q,U,ba,aa,La,Z,la,da,J,Ca,Fa=null){this.wLl=
(new Date(0)).getTime();this.TLl=0;this.TDh=!1;this.KNl=null;this.yUk=36E5;this.QRe=N.x8l;this.Pff=0;this.ZEe=null;this.uoc=0;this.h5e=this.nVl=null;this.RQm=[h.a.qZe,h.a.errorMessage,h.a.Wkl,h.a.x$,h.a.Zhb,h.a.Qvj,h.a.Yqe,h.a.Vcd,h.a.mre];this.QQm=[h.a.qZe,h.a.errorMessage];this.x$=this.a$b=null;this.Hai=new A(J?J:()=>n.AFrameworkApplication.Fh,ba,aa,La,I,O);this.Rcf=Ca;this.zo=U;this.Dn=O;this.UNm=Q;this.hK=Z;this.wu=la;this.mgf=Fa;this.lKl=!1;this.uWf=9E4;da&&da.execute(ya=>{Object(M.a)()?ya.PFh(()=>
{c.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",this.hK);this.Hai.BUk()}):ya.Ixf(()=>{c.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",this.hK);this.Hai.BUk()})});2>=100*Math.random()&&(this.yUk=3E5);B.a.instance&&(B.a.instance.j1l=this.yUk)}dcl(I){this.h5e=I}init(){this.wu.JVm(Object(b.a)(this,this.V7n,"resetGetMachineIdDelay"));this.wu.SJd(Object(b.a)(this,this.jKb,"onConnectionStateChanged"))}jKb(I,O){this.uoc=
O.newState;2===O.newState&&(this.Pff=0)}zLh(){let I;I=this.ZEe.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.ZEe.Zhb,N.cIh,r.a.yj(I)),correlationId:I}}qpj(I,O,Q,U,ba){this.f$n(()=>{U(ba,"GetMachineIdSuccess")&&(c.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",this.x$,this.hK),I(this.KNl),Q(this.Jmn()))},aa=>{U(ba,"GetMachineIdFailure")&&(c.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",this.hK),O(aa))},U,ba)}P_i(){this.qUl();
this.Ttn()}f$n(I,O,Q,U){c.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",this.x$);this.x$?I():window.setTimeout(()=>{this.sendFindSessionRequestToServerInternal(I,O,Q,U)},this.w_m())}sendFindSessionRequestToServerInternal(I,O,Q,U){Q(U,"RequestMachineId")&&(this.wLl=(new Date).getTime(),Q=k.a.Hh(),this.O2l(ba=>{const aa=k.a.Hh();this.rWh(ba);this.Hal();I();ba=k.a.Hh()-aa;c.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",
ba)},ba=>{const aa=k.a.Hh();this.qUl();B.a.instance&&B.a.instance.mna(2,3);O(ba);ba=k.a.Hh()-aa;c.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",ba)},!1),Q=k.a.Hh()-Q,c.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",Q))}Ttn(){this.QRe+=N.Din;this.QRe=Math.min(this.QRe,N.qIn)}w_m(){let I=this.wLl+this.QRe-(new Date).getTime();0>I&&(I=0);return I}rWh(I){try{this.ZEe=I,this.a$b=I.hVl,this.x$=I.x$,this.nVl=I.Zhb,this.KNl=I.nJf}catch(O){c.ULS.sendTraceTag(17956953,
500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",O.toString())}}qUl(){this.x$=null;this.rUl()}Hal(){this.rUl();this.TDh=!0;this.TLl=window.setTimeout(Object(b.a)(this,this.u4n,"refreshMachineId"),this.yUk)}rUl(){this.TDh&&(window.clearTimeout(this.TLl),this.TDh=!1)}u4n(){this.TDh=!1;this.O2l(I=>{const O=this.nVl!==I.Zhb,Q=this.x$!==I.x$,U=this.x$;this.rWh(I);0!==this.uoc&&(Q?(c.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",
U||"null",I.x$),this.wu.GXh()):(this.wu.$2n(O,Q),this.Hal()))},()=>{B.a.instance&&B.a.instance.mna(2,3);this.Hal()},!0)}V7n(){this.QRe=N.x8l}Jmn(){return new F.a(this.ZEe.xUh,this.ZEe.wUh,this.ZEe.vUh,this.ZEe.EMh)}Jjo(I){if(Object.getType(I)!==Object)return null;for(let O in I);return this.m4m(I)}m4m(I){if(!(h.a.qZe in I))return null;const O=I[h.a.qZe];var Q=O?this.RQm:this.QQm;for(const U of Q)if(!(U in I))return null;Q=Object.assign(new v.a,{zjg:I[h.a.qZe],errorMessage:I[h.a.errorMessage],correlationId:x.a.create().toString()});
O&&(Q.nJf=I[h.a.Wkl],Q.Zhb=I[h.a.Zhb],Q.x$=I[h.a.x$],Q.EMh=I[h.a.Qvj],Q.vUh=I[h.a.Yqe],Q.wUh=I[h.a.Vcd],Q.xUh=I[h.a.mre]);return Q}lhn(I,O){c.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.mgf.Cbn.continueWith(()=>{this.mgf.Cbn.result?(c.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),I(this.mgf.Dbn)):(c.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),O(this.mgf.Dbn))})}nvm(I,O,Q,U,ba=
!1){return aa=>{G.a.instance.Q$g(0,1);I&&I.stop();this.Rcf=this.h5e=null;this.Mbm(aa.data,!0,O);var La=w.RtcUtils.deserialize(aa.data.responseData,"FindSession",null);if(La)if(La=this.Jjo(La)){if(La.zjg&&La.Zhb&&La.x$){c.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",this.hK);this.JBn(aa.data);Q(La);return}O.FindSessionFailureReason="FindSessionInvalidResponse";O.IsRtcEnabled=La.zjg;O.IsQueryStringEmpty=!La.Zhb;O.IsConnectionStringEmpty=!La.x$;c.ULS.sendTraceTag(4290720,
500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",this.hK,La.zjg,!La.Zhb,!La.x$)}else O.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",c.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",this.hK);else O.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",c.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",
this.hK);this.wsm(O,ba);U(null)}}lvm(I,O,Q,U=!1){return ba=>{G.a.instance.Q$g(0,1);I&&I.stop();this.Rcf=this.h5e=null;this.Mbm(ba.data,!1,O);let aa=null;var La="unknown";let Z="unknown";ba.data&&((La=ba.data.gj)&&N.Jfh in La&&(aa=La[N.Jfh].toString()),La=l.a[ba.data.status],Z=ba.data.Je.toString());O.FindSessionFailureReason="FindSessionRequestFailed";O.HttpErrorCode=Z;O.HttpErrorStatus=La;O[N.Jfh]=aa;c.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",
La,Z,this.hK,aa,U);this.wsm(O,U);Q(Z)}}O2l(I,O,Q=!1){let U=null;c.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.hK);const ba={};var aa=this.Hai.TKh();ba[K.a.cIa]=x.a.create().toString();this.h5e&&""!==this.h5e?aa=String.format("{0}&{1}={2}",aa,P.a.P3k,this.h5e):this.Rcf&&""!==this.Rcf&&(aa=String.format("{0}&{1}={2}",aa,P.a.P3k,this.Rcf),ba[T.hoo]="True",ba[T.Ezn]="True");aa=this.UNm+"?"+aa;Q&&(ba[H.Ebn]=E.B3n);const La={};La.IsNetworkOfflineBeforeSendRequest=this.Dn.tYa;
La.HasAvailableConnectionsBeforeSendRequest=this.Dn.UMh;La.MaxConnectionsAllowed=this.Dn.uUh;La.IsRefreshMachineId=Q;this.mgf&&!this.lKl?(this.lhn(this.nvm(null,La,I,O,Q),this.lvm(null,La,O,Q)),this.lKl=!0):(this.zo&&(U=this.zo.Xl("WebServiceCall","GetMachineIdFromTheServer")),B.a.instance&&B.a.instance.mna(2,0),0>this.Dn.lZ(aa,1,null,ba,[N.bIh,N.Jfh,N.TXg,N.O3k,N.Mjm,N.Ckm,N.Bkm],!1,1,this.nvm(U,La,I,O,Q),this.lvm(U,La,O,Q),null,null,!1,null,this.uWf,"3",null,!0)&&(5<this.Pff&&200>this.Pff&&c.ULS.sendTraceTag(578166985,
500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.Pff),window.setTimeout(()=>{this.Pff++;O("-1")},1E3)))}Mbm(I,O,Q){Q||(Q={});Q.IsNetworkOfflineAfterRequestComplete=this.Dn.tYa;Q.IsRequestSucceeded=O;I&&(Q.EnqueueTime=I.Wy,Q.InvokedTime=I.Oo,Q.CompletedTime=I.Gp,I.gj&&(N.bIh in I.gj&&(Q.CorrelationId=I.gj[N.bIh]),N.TXg in I.gj&&(Q[N.TXg]=I.gj[N.TXg])));c.ULS.sendTraceTag(38633565,500,O?50:15,w.RtcUtils.z1e(Q))}wsm(I,O){I||(I={});I.ConnectionState=
e.a[this.uoc];O||this.wu.vsm(1,I)}JBn(I){try{var O=!1,Q=!1,U=I.gj,ba=m.a.VK(I.request.get_url());if(U&&N.O3k in U){const da=U[N.O3k].toString().toLocaleLowerCase();Q="true"===da;O="false"===da}U=!1;const la=0<=ba.toLocaleLowerCase().indexOf("collab");Q&&!la?U=!0:O&&la&&(U=!0);if(U){O={};O.HostName=ba;O.Status=l.a[I.status];O.HttpStatus=I.Je.toString();var aa=I.request.get_headers();for(let da in aa){var La=aa[da];(ba=da)&&0<ba.length&&(Q=0,La&&(Q=La.toString().length),O["r_"+ba]=Q)}if(I.gj){const da=
new d.a;da.add(N.bIh);da.add(N.TXg);da.add(N.Jfh);da.add(N.Ckm);da.add(N.Bkm);da.add(N.Mjm);N.nUm(O,I.gj,da)}N.mUm(I.request.get_url(),O);var Z=u.a.toJSON(O);c.ULS.sendTraceTag(559437006,500,15,Z)}}catch(la){c.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",la.toString())}}static createInstance(I,O,Q,U,ba,aa,La,Z,la,da,J,Ca=null){return N.eVe(I,O,Q,U,ba,aa,La,Z,la,da,null,J,Ca)}static G4m(I,O,Q,U,ba,aa,La,Z,la,da,J=null){return N.eVe(I,O,Q,U,ba,3,aa,La,Z,la,da,J,null)}static eVe(I,
O,Q,U,ba,aa,La,Z,la,da,J,Ca,Fa=null){I=I||x.a.create().toString();I=new N(I,O,Q,U,ba,aa,La,Z,la,da,J,Ca,Fa);I.init();return I}static nUm(I,O,Q){for(let U of Q)U in O&&(I[U]=O[U])}static mUm(I,O){if(I){var Q=I.indexOf("?");if(-1!==Q)for(I=I.substr(Q+1).split("&"),Q=0;Q<I.length;++Q){var U=I[Q].split("=");if(2===U.length){const ba=U[0];if(ba&&0<ba.length){let aa=0;if(U=U[1])aa=U.length;O["q_"+ba]=aa}}}}}}N.Din=3E3;N.qIn=3E5;N.x8l=1E3;N.bIh="X-CorrelationId";N.cIh="corrid";N.Jfh="RtcErrorCode";N.TXg=
"X-OfficeCluster";N.O3k="X-NewEnv";N.Mjm="X-MSEdge-Ref";N.Bkm="X-OFFICEFD";N.Ckm="X-OfficeFE";Object(y.a)(N,"FindSessionStrategy",null,[1181])},1638:function(y,C,a){a.d(C,"a",function(){return m});y=a(0);var c=a(405),b=a(6),d=a(17),e;(function(k){k[k.huo=0]="SendNotification";k[k.iuo=1]="SendPersistentState";k[k.lro=2]="FindSession";k[k.HIm=3]="Last"})(e||(e={}));Object(y.b)("ApiType",e);var h;(function(k){k[k.zpo=0]="AttemptCount";k[k.Auo=1]="SuccessCount";k[k.aro=2]="DropCount";k[k.hro=3]="FailedCount";
k[k.cso=4]="LatencyOverThresholdCount";k[k.dso=5]="LatencyUnderThresholdCount";k[k.Nuo=6]="ThrottledCount";k[k.HIm=7]="Last"})(h||(h={}));Object(y.b)("EventCountType",h);var n=a(1430);class m{constructor(k){this.lVl=this.G0l=null;this.pjm=this.j1l=0;this.wO=null;this.QLl=this.bfi=0;this.Dn=k;this.dvn();this.iai=this.mKl=this.Hfi=!1;this.Yei=0}get ian(){return this.iai}Hgo(k){this.QLl=k;window.setInterval(Object(b.a)(this,this.h6j,"logMetricsBatchAndReset"),k);this.bfi=(new Date).getTime()}mna(k,l){this.Uco(k)&&
!this.mKl||this.ian||!window.navigator.onLine||this.Dn.tYa||(this.wO[k][l]++,this.Hfi=!0)}dvn(){this.wO=Array(3);for(let k=0;3>k;k++){this.wO[k]=Array(7);for(let l=0;7>l;l++)this.wO[k][l]=0}}iZm(){const k={};for(let l=0;3>l;l++)for(let u=0;7>u;u++)this.xzn(l,u)&&(k[e[l]+h[u]]=this.wO[l][u]);k.FSDomain=this.G0l;k.ConnectionDomain=this.lVl;k.FSRetryInterval=this.j1l;k.MaxPayloadSize=this.pjm;k.LogNumber=this.Yei;1===this.Yei&&(k.FSLatencies=n.a.instance.khn(),k.ConLatencies=n.a.instance.rfn());return k}xzn(k,
l){return 2===k&&3!==l&&0!==l?!1:!0}Uco(k){return 2===k?!1:!0}h6j(){if(this.Hfi){this.Yei++;if((new Date).getTime()-this.bfi<5E3+this.QLl){var k=d.a.toJSON(this.iZm());c.ULS.sendTraceTag(50644352,500,15,k)}this.bfi=(new Date).getTime();for(k=0;3>k;k++)for(let l=0;7>l;l++)this.wO[k][l]=0;this.Hfi=!1}}YHn(){this.mKl=!0}static get instance(){return m.Qa}static create(k){m.instance||(m.Qa=new m(k));return m.instance}}m.Qa=null;Object(y.a)(m,"FrequentLoggingMetrics",null,[1187])},1643:function(y,C,a){a.d(C,
"a",function(){return b});y=a(0);var c;(function(d){d[d.Sjm=0]="multipleBrowsersImageClassName";d[d.xpm=1]="peopleImageClassName";d[d.ypm=4]="peopleImageClusterPath";d[d.Rjm=5]="multipleBrowserImageClusterPath";d[d.mYa=6]="imageDimension";d[d.rtl=8]="rtl";d[d.uKb=9]="pointerInputManager";d[d.zXa=10]="clickInputManager";d[d.vertical=11]="vertical";d[d.zIndex=12]="zIndex";d[d.yjd=13]="contextMenuInputManager";d[d.b8l=14]="imageDomElement";d[d.QEm=15]="useIdleTooltip";d[d.dFm=16]="viewportBoundsCallback";
d[d.S0l=17]="flipHorizontalDirection";d[d.P0l=18]="fixRemoveFadeOutElementCrash";d[d.$7l=19]="ignoreEventOnExpandedTooltip";d[d.Z8l=20]="ipWidthAdjustForFlyout"})(c||(c={}));Object(y.b)("PresenceTooltipSettingKeys",c);class b{constructor(){this.fR={}}get(d,e=null){d=c[d];return"number"===typeof e?(e=this.fR[d])?Number.parseInvariant(e.toString()):0:this.fR[d]}add(d,e){this.fR[c[d]]=e}bfa(d,e){c[d]in this.fR||(this.fR[c[d]]=e)}remove(d){delete this.fR[c[d]]}}Object(y.a)(b,"PresenceTooltipSettings",
null,[])},1813:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c extends Sys.EventArgs{constructor(b,d){super();this.e8e=b;this.yYl=d}}Object(y.a)(c,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1814:function(y,C,a){a.r(C);a.d(C,"RealtimeChannelMetrics",function(){return h});y=a(0);var c=a(405),b=a(181),d=a(17),e=a(624);class h{constructor(){this.AMl=this.BMl=this.CMl=this.yMl=this.xMl=this.zMl=this.Knf=this.qgi=0;this.mDh=this.xei=this.Qlf=this.sei=this.tei=this.nei=this.Sgd=this.Clf=
this.oSe=this.mei=this.lDh=this.YRe=null;this.nfi=this.Nmf=this.JNl=this.cJl=0;this.hMl=!1;this.OXh=this.VSk;this.YSk=this.ZSk;this.PXh=this.XSk;this.M$g=this.hTk;this.Osm=this.gTk;this.zTk=this.ATk;this.wTk=this.xTk;this.QCe=this.uTk;this.S$g=this.vTk;this.Msm=this.WSk;this.wzb=this.Vtk;this.J$b=this.Xtk}VSk(){this.qgi++;this.mei=new Date;this.YRe||(this.YRe=new Date)}ZSk(){this.Knf++;this.Sgd=new Date;this.lDh||(this.lDh=this.Sgd);this.Qlf=this.Sgd;this.a2m()}XSk(){this.zMl++;this.nei=new Date}hTk(){this.xMl++;
this.oSe=new Date}gTk(){this.yMl++;this.Clf=new Date}xTk(){this.tei=new Date;this.CMl++}vTk(){this.mDh||(this.mDh=new Date);this.BMl++}uTk(){this.sei=new Date;this.AMl++}ATk(){if(!this.hMl&&this.qgi){var n=this.HHh();c.ULS.sendTraceTag(39321871,500,15,d.a.toJSON(n));this.hMl=!0}}WSk(n){const {dGj:m,eGj:k,Cj:l}=e.RtcUtils.G_l(n);m&&m!==b.a.KB&&(c.ULS.sendTraceTag(40157596,500,15,d.a.toJSON({["HttpErrorCode"]:m,["HttpErrorStatus"]:k,["Exception"]:l})),b.a.nOh(m)&&this.cJl++,b.a.bPh(m)&&this.JNl++)}Vtk(){this.xei=
new Date}Xtk(){this.oSe=this.Qlf=new Date}HHh(){return{["numberOfConnectionAttempts"]:this.qgi,["numberOfSuccessfulConnections"]:this.Knf,["numberOfFailedConnections"]:this.zMl,["numberOfDisconnectedConnections"]:this.xMl,["numberOfExplicitDisconnectedConnections"]:this.yMl,["numberOfSentMessages"]:this.CMl,["numberOfReceivedMessages"]:this.BMl,["numberOfLostMessages"]:this.AMl,["firstConnectionAttempt"]:this.YRe?this.YRe:null,["firstMessageReceived"]:this.mDh?this.mDh:null,["firstConnectionSuccess"]:this.lDh?
this.lDh:null,["lastConnectionAttempt"]:this.mei?this.mei:null,["lastConnectionSuccess"]:this.Sgd?this.Sgd:null,["lastConnectionFailure"]:this.nei?this.nei:null,["lastMessageSent"]:this.tei?this.tei:null,["lastMessageLost"]:this.sei?this.sei:null,["lastDisconnect"]:this.oSe?this.oSe:null,["lastExplicitDisconnect"]:this.Clf?this.Clf:null,["lastTimeOnline"]:this.Qlf?this.Qlf:null,["lastTimeOffline"]:this.xei?this.xei:null,["maxDisconnectedTimeMs"]:this.Nmf,["maxExplicitDisconnectedTimeMs"]:this.nfi,
["clientConnectionErrors"]:this.cJl,["serverConnectionErrors"]:this.JNl}}a2m(){this.YRe&&1===this.Knf&&(this.Nmf=Math.max(this.Nmf,this.Sgd.getTime()-this.YRe.getTime()));this.oSe&&1<this.Knf&&(this.Nmf=Math.max(this.Nmf,this.Sgd.getTime()-this.oSe.getTime()));this.Clf&&1<this.Knf&&(this.nfi=Math.max(this.nfi,this.Sgd.getTime()-this.Clf.getTime()))}static createInstance(n){h.Qa||(h.Qa=new h,c.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",n));return h.Qa}}h.Qa=
null;Object(y.a)(h,"RealtimeChannelMetrics",null,[1827,236])},1815:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);var c;(function(b){b[b.unspecified=0]="unspecified";b[b.word=1]="word";b[b.excel=2]="excel";b[b.powerPoint=3]="powerPoint";b[b.test=4]="test";b[b.n8e=5]="wacFrontEnd";b[b.oneNote=6]="oneNote";b[b.LAh=7]="visio";b[b.Wxo=8]="officeMobile";b[b.Ovo=9]="cosmosDBChangefeed";b[b.last=10]="last"})(c||(c={}));Object(y.b)("RtcClientAppName",c)},1822:function(y,C,a){a.r(C);a.d(C,"RealtimeChannel",
function(){return Kb});y=a(0);var c=a(405),b=a(6),d=a(1187),e=a(1815),h=a(1624),n=a(23),m=a(41);class k{constructor(nb,Ka){this.status=nb;this.LZe=Ka}}Object(y.a)(k,"UserStatusInfo",null,[]);var l=a(100),u=a(1430);class r{constructor(nb,Ka){this.data=nb;this.timeStamp=Ka}}Object(y.a)(r,"PresenceData",null,[]);var x=a(184),v=a(1137);class z{constructor(){this.I7h=this.IIl=!1;this.G7h=0;this.I8h=this.wki=this.vki=this.g7h=!1;this.Iai=0;this.yNl=!1;this.xNl=this.wNl=0;this.rji=!1;this.vji=this.tji=this.wji=
this.sji=0;this.uji=!1}get JGh(){return this.I7h}get Jid(){return this.G7h}get yWm(){return this.g7h}get bdo(){return this.vki}get cdo(){return this.wki}get j1m(){return this.I8h}get uWf(){return this.Iai}get Y8n(){return this.yNl}get dwm(){return this.wNl}get X8n(){return this.xNl}get T8n(){return this.rji}get U8n(){return this.sji}get iwm(){return this.wji}get ewm(){return this.tji}get gwm(){return this.vji}get fwm(){return this.uji}static createInstance(nb){return nb?Object.assign(new z,{IIl:nb.getBooleanAppSetting("AwayStatusManagerIsEnabled"),
I7h:nb.getBooleanAppSetting("AwayStatusOneMinuteTimeoutIsEnabled"),G7h:nb.Ac("AwayCoauthorThresholdMs",9E5),g7h:nb.getBooleanAppSetting("RtcAllowCrossDomainAccessEnabled"),vki:nb.getBooleanAppSetting("ShouldLogOnContentNotification"),wki:nb.getBooleanAppSetting("ShouldLogOnHostSubscriptionNotification"),I8h:nb.getBooleanAppSetting("RtcClientMetricsEnabled"),Iai:nb.Ac("RtcFindSessionRequestTimeoutInMS",6E4),yNl:nb.getBooleanAppSetting("RtcJsClientFrequentlyLogsMetrics"),wNl:nb.Ac("RtcJsClientFrequentMetricsLatencyThresholdInMS",
1E3),xNl:nb.Ac("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),rji:nb.getBooleanAppSetting("RtcClientMessageTelemetryEnabled"),sji:nb.Ac("RtcClientMessageTelemetrySampleSize",5),wji:nb.Ac("RtcSendTelemetryMessageIntervalInMS",3E5),tji:nb.Ac("RtcLogClientMessageMetricsTimeOutInMs",2E4),vji:nb.Ac("RtcMaxPayloadSizeInCharactersOverride",v.a.lrk),uji:nb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RTCLogSignalrHeartBeatMessages",!1)}):Object.assign(new z,{IIl:!1,I7h:!1,G7h:9E5,g7h:!1,vki:!1,
wki:!0,I8h:!1,Iai:9E4,rji:!1,sji:5,wji:3E5,tji:2E4,vji:v.a.lrk,uji:!1})}}Object(y.a)(z,"RealtimeChannelSettings",null,[1834]);var A=a(30),B=a(1431);class G{constructor(nb,Ka=""){this.iff=this.ttf=0;this.sdi=!1;this.YSe=this.bFh=null;this.jSe=!1;this.INl=nb;this.ACm=Ka;this.setTimeout=G.vXi;this.NHd=this.ttf=this.iff=0}yTk(){0<this.NHd&&0<this.iff&&c.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.ACm,this.iff,this.NHd);0<this.NHd&&0<this.ttf&&c.ULS.sendTraceTag(36545634,
500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.ACm,this.ttf,this.NHd)}get kZe(){return this.sdi}b_h(nb,Ka){this.ttf++;this.IHf(!0);this.sdi=!0;this.bFh=nb;this.YSe=Ka}IHf(nb){this.sdi=!1;this.YSe&&nb&&(this.iff++,this.YSe.dqk());this.YSe=this.bFh=null}static vXi(nb,Ka){return window.setTimeout(nb,Ka)}}Object(y.a)(G,"ThrottlerBase",null,[]);class w{constructor(){this.XIl=this.g9h=!1;this.callback=null}XYg(nb){this.callback=nb;this.TCm()}Vim(nb){this.g9h||(this.g9h=!0,this.NMm=
nb,this.TCm())}TCm(){this.g9h&&this.callback&&!this.XIl&&(this.XIl=!0,this.callback(this.NMm))}}Object(y.a)(w,"CompletionTask",null,[]);class F{constructor(){this.fMl=new w;this.eMl=new w}IVh(nb){this.fMl.XYg(nb)}HVh(nb){this.eMl.XYg(nb)}iUg(nb){this.fMl.Vim(nb)}Lpd(nb){this.eMl.Vim(nb)}dqk(){this.iUg(2);this.Lpd(2)}}Object(y.a)(F,"MessageStatus",null,[1839]);class H extends G{constructor(nb,Ka=""){super(nb,Ka);this.mre=0;this.w$n=()=>{if(this.kZe){const Sb=this.bFh,ab=this.YSe;this.IHf(!1);this.Yhh(Sb,
ab)}};this.Olf=(new Date(0)).getTime();this.currentTime=()=>(new Date).getTime()}init(nb){this.jSe||(this.mre=nb,this.jSe=!0)}add(nb){this.jSe||this.init(H.tXl);this.NHd++;const Ka=this.currentTime(),Sb=new F;this.Olf>Ka&&(this.Olf=Ka);this.kZe?(this.IHf(!0),this.b_h(nb,Sb)):this.Olf+this.mre<=Ka?this.Yhh(nb,Sb):(this.b_h(nb,Sb),this.setTimeout(this.w$n,this.Olf+this.mre-Ka));return Sb}Yhh(nb,Ka){this.Olf=this.currentTime();nb=this.INl(nb);nb.IVh(Sb=>{Ka.iUg(Sb)});nb.HVh(Sb=>{Ka.Lpd(Sb)})}static createInstance(nb,
Ka=""){return new H(nb,Ka)}}H.tXl=200;Object(y.a)(H,"MaxRateThrottler",G,[1836,1837]);class E extends G{constructor(nb,Ka=""){super(nb,Ka);this.Yqe=this.Vcd=0;this.nb=new A.a;this.iSe=!1;this.RCh=this.LCh=this.qmi=0;this.y$n=()=>{this.iSe=!1;if(this.kZe){const Sb=this.bFh,ab=this.YSe;this.IHf(!1);this.Yhh(Sb,ab)}};this.GSn=()=>{++this.RCh;this.RCh>Math.floor(this.Yqe/2)&&(this.RCh=-1E9,this.nb.raiseEvent("TMUDM"))};this.hEh=0;this.dFh=[];this.clearTimeout=E.cXi}add(nb){this.jSe||this.init(E.zXl,E.wXl);
this.NHd++;const Ka=new F;this.kZe?this.b_h(nb,Ka):this.hEh<this.Yqe?this.Yhh(nb,Ka):(this.b_h(nb,Ka),this.iSe=!1);return Ka}Yhh(nb,Ka){nb=this.INl(nb);const Sb=this.setTimeout(this.GSn,this.Vcd);++this.hEh;Array.add(this.dFh,Sb);const ab=this.LCh;nb.IVh(ub=>{Ka.iUg(ub)});nb.HVh(ub=>{this.LCh===ab&&(this.FSn(ab,Sb),Ka.Lpd(ub))})}FSn(nb,Ka){this.LCh===nb&&(--this.hEh,this.clearTimeout(Ka),Array.remove(this.dFh,Ka),this.kZe&&this.x$n())}x$n(){this.kZe&&!this.iSe&&(this.qmi=this.setTimeout(this.y$n,
0),this.iSe=!0)}WFh(nb){this.nb.addHandler("TMUDM",nb)}Uum(nb){this.nb.removeHandler("TMUDM",nb)}reset(){this.NHd=this.ttf=this.iff=this.RCh=0;++this.LCh;for(const nb of this.dFh)this.clearTimeout(nb);this.hEh=0;this.dFh=[];this.IHf(!0);this.iSe&&(this.clearTimeout(this.qmi),this.qmi=0,this.iSe=!1)}init(nb,Ka){this.jSe||(this.Vcd=nb,this.Yqe=Ka,this.jSe=!0)}static createInstance(nb,Ka=""){return new E(nb,Ka)}static cXi(nb){window.clearTimeout(nb)}}E.zXl=15E3;E.wXl=5;Object(y.a)(E,"MaxOutstandingThrottler",
G,[1838,1837]);class P{constructor(nb){this.je=null;this.ZU=!1;this.nb=new A.a;this.ufi=new n.a;this.rfi=new n.a;this.rmi=nb;this.eSe=this.rmi.IWl(Ka=>Ka.send(),"GlobalMaxOustandingThrottler");this.eSe.WFh(()=>{this.nb.raiseEvent("TMUDM")})}init(nb){this.ZU||(this.je=nb,this.eSe.init(this.je.Vcd,this.je.Ann),this.ZU=!0)}Hmn(nb){this.ZU||this.init(new B.a(H.tXl,E.zXl,E.wXl,P.vIn));if(!({value:Ka}=this.ufi.Ph(nb)).returnValue){if(!({value:Ka}=this.rfi.Ph(nb)).returnValue){var Ka="MaxOutstandingThrottler-"+
nb;Ka=this.rmi.IWl(Object(b.a)(this.eSe,this.eSe.add,"add"),Ka);Ka.init(this.je.Vcd,this.je.uIn);Ka.WFh(()=>{this.nb.raiseEvent("TMUDM")});this.rfi.add(nb,Ka)}const Sb="MaxRateThrottler-"+nb;Ka=this.rmi.O4m(Object(b.a)(Ka,Ka.add,"add"),Sb);Ka.init(this.je.GIn);this.ufi.add(nb,Ka)}return Ka}reset(){for(const nb of this.ufi)nb.value.yTk();for(const nb of this.rfi)nb.value.yTk(),nb.value.reset();this.eSe.yTk();this.eSe.reset()}WFh(nb){this.nb.addHandler("TMUDM",nb)}Uum(nb){this.nb.removeHandler("TMUDM",
nb)}}P.vIn=1E3;Object(y.a)(P,"ThrottlerManager",null,[1833]);class T{}T.ztn="realtimeChannelHub";T.Xtd="UpdatePresence";T.qDb="SendUpdateNotification";T.qfj="GetCompletePersistentStateWithMetadata";T.S7e="UpdatePersistentState";T.Utd="UpdateClientInfo";Object(y.a)(T,"RtcHubMethodNames",null,[]);class K{constructor(nb){this.N1a=!1;this.qxc=0;this.j9h=!1;this.qCn=()=>{c.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.hK)};this.setTimeout=K.vXi;this.clearTimeout=
K.cXi;this.TCn=this.qCn;this.hK=nb}OQn(){this.N1a||(this.qxc=this.setTimeout(()=>{this.N1a=!1;this.Obm()},8E3),this.N1a=!0,this.j9h=!1)}tRn(){this.LX()}BUn(){this.Obm()}Obm(){this.LX();this.j9h||(this.j9h=!0,this.TCn())}LX(){this.N1a&&this.clearTimeout(this.qxc);this.qxc=0;this.N1a=!1}static vXi(nb,Ka){return window.setTimeout(nb,Ka)}static cXi(nb){window.clearTimeout(nb)}}Object(y.a)(K,"ConnectedUsageKpiLogger",null,[1832]);class M{constructor(){this.OXh=this.VSk;this.YSk=this.ZSk;this.PXh=this.XSk;
this.M$g=this.hTk;this.Osm=this.gTk;this.zTk=this.ATk;this.wTk=this.xTk;this.QCe=this.uTk;this.S$g=this.vTk;this.Msm=this.WSk;this.wzb=this.Vtk;this.J$b=this.Xtk}VSk(){}ZSk(){}XSk(){}hTk(){}gTk(){}xTk(){}vTk(){}uTk(){}ATk(){}WSk(){}Vtk(){}Xtk(){}}Object(y.a)(M,"NoopRealtimeChannelMetrics",null,[1827,236]);class N{}N.Xtd="presenceUpdated";N.updateNotification="updateNotification";N.Cpm="persistentStateCleared";N.S7e="persistentStateUpdated";Object(y.a)(N,"RtcClientMethodNames",null,[]);class I{constructor(nb){this.X6=
nb}m5n(nb){this.X6.on(N.Xtd,nb)}r5n(nb){this.X6.on(N.updateNotification,nb)}k5n(nb){this.X6.on(N.S7e,nb)}j5n(nb){this.X6.on(N.Cpm,nb)}jlo(nb){this.X6.off(N.Xtd,nb)}klo(nb){this.X6.off(N.updateNotification,nb)}ilo(nb){this.X6.off(N.S7e,nb)}hlo(nb){this.X6.off(N.Cpm,nb)}Xtd(nb){return this.X6.invoke(T.Xtd,nb)}Utd(nb){return this.X6.invoke(T.Utd,nb)}qDb(nb,Ka){return this.X6.invoke(T.qDb,nb,Ka)}qfj(nb){return this.X6.invoke(T.qfj,nb)}S7e(nb,Ka){return this.X6.invoke(T.S7e,nb,Ka)}}Object(y.a)(I,"RealtimeChannelProxy",
null,[1829,1830,1831]);var O=a(1465),Q=a(1703);class U{constructor(nb){this.BHd=null;this.uoc=0;this.kVd=!1;this.wu=nb;this.wu.SJd(Object(b.a)(this,this.jKb,"onConnectionStateChanged"))}jKb(nb,Ka){this.uoc=Ka.newState}Unm(){c.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.wu.GXh()}Dun(nb){this.BHd.init(nb)}}Object(y.a)(U,"ARtcMessageHandler",null,[]);var ba=a(512);class aa{constructor(){this.Presence=null;this.TimeStamp=0}}Object(y.a)(aa,"PresenceDataEntryForClients",
null,[]);var La=a(17);class Z{constructor(nb,Ka=""){this.eRm=nb;this.dHb=Ka}send(){return this.eRm()}get messageId(){return this.dHb}}Object(y.a)(Z,"MessageHandler",null,[1840]);class la extends Sys.EventArgs{constructor(nb,Ka,Sb,ab){super();this.Z_k=nb;this.reconnectDelay=Ka;this.reason=Sb;this.q7k=ab}}Object(y.a)(la,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var da=a(1623);class J{constructor(){this.vli=this.$l=null}get ew(){return this.$l?this.vli?this.vli.getTime()-this.$l.getTime():(new Date).getTime()-
this.$l.getTime():0}start(){this.$l=new Date}stop(){this.vli=new Date}}Object(y.a)(J,"SimpleStopwatch",null,[]);var Ca=a(1625),Fa;(function(nb){nb[nb.Lvo=0]="contentUpdate";nb[nb.kwo=1]="editorsTableUpdate";nb[nb.NVd=2]="fileNameUpdate";nb[nb.Rzo=3]="wetContentUpdate";nb[nb.iyo=4]="persistedContentUpdate";nb[nb.Fvo=5]="clientRtcReconnectRequest";nb[nb.Gyo=6]="replicationTelemetry";nb[nb.Axo=7]="lockUpdate";nb[nb.Jvo=8]="collabServiceContentUpdate";nb[nb.wzo=9]="trackChangeSettingUpdate";nb[nb.Jyo=
10]="saveTargetUpdate";nb[nb.Dzo=11]="uploadToOcsUpdate";nb[nb.txo=12]="labelUpdate";nb[nb.cxo=13]="hostNotificationSubscriptionStatus";nb[nb.ozo=14]="subscribeOrExtend";nb[nb.lwo=15]="elapsedBootTelemetry";nb[nb.Hvo=16]="clientToClientTelemetryMessage";nb[nb.Gvo=17]="clientToClientResponseMessage";nb[nb.Fzo=18]="verifyNotificationPipeline";nb[nb.bxo=19]="hostNotificationHeartbeat";nb[nb.Oyo=20]="secondaryMetadataUpdate";nb[nb.last=21]="last"})(Fa||(Fa={}));Object(y.b)("UpdateNotificationType",Fa);
var ya=a(1502),Ua=a(624);class Ia extends U{constructor(nb,Ka,Sb,ab,ub,Aa,tb,kc,dc,Db){super(tb);this.X6=null;this.lNl=this.yCh=this.OLl=!1;this.dHb=0;this.xhi=new x.a;this.gPm=Ia.vfn();this.Ygi=m.AFrameworkApplication.ha.Ma("OwningFeatureCrewForRtcNotificationKpis");this.je=nb;this.wMl=this.vMl=0;this.BHd=Ka;this.BHd.WFh(Object(b.a)(this,this.Unm,"onTooManyUndeliveredMessages"));this._clientId=Sb;this.AQm=ub;this.wu.EVm(Object(b.a)(this,this.Wmm,"onRefreshProxyRequired"));this.wu.CVm(Object(b.a)(this,
this.Umm,"onRefreshAllPersistentStateRequest"));this.wu.MVm(Object(b.a)(this,this.qDb,"sendUpdateNotification"));this.wu.ZUm(Object(b.a)(this,this.cmm,"onInternalPresenceUpdated"));this.wu.$Um(Object(b.a)(this,this.dmm,"onInternalUpdateNotificationReceived"));this.wu.YUm(Object(b.a)(this,this.bmm,"onInternalPersistentStateUpdated"));this.wu.XUm(Object(b.a)(this,this.amm,"onInternalPersistentStateCleared"));this.wu.LVm(Object(b.a)(this,this.hZh,"sendPersistentState"));this.wu.VVm(Object(b.a)(this,
this.Utd,"updateClientInfo"));this.zo=Aa;this.hK=ab;this.wO=kc;this.qya=dc;this.Rmf=Db;this.hgd=Object(Q.a)(String,m.AFrameworkApplication.rd.Application)||""}Wmm(nb,Ka){this.X6=this.AQm(Ka.hubConnection);this.BHd.reset();this.X6.m5n(Object(b.a)(this,this.o0g,"onPresenceUpdated"));this.X6.k5n(Object(b.a)(this,this.LVh,"onPersistentStateUpdated"));this.X6.j5n(Object(b.a)(this,this.Azk,"onPersistentStateCleared"));this.X6.r5n(Object(b.a)(this,this.E1g,"onUpdateNotificationReceived"))}jKb(nb,Ka){this.uoc=
Ka.newState;2===Ka.newState&&this.r$n()}r$n(){for(const nb of this.xhi)this.qDb(null,new da.a(nb.key,nb.value,!1,new d.a));this.xhi=new x.a}Umm(nb,Ka){Ka.UJi();for(nb=0;3>nb;++nb)this.g$n(nb,Ka)}g$n(nb,Ka){try{this.X6.qfj(nb).done(Sb=>{Ka.l8e(Ka.zOi,"GetCompletePresenceSuccess")&&(Ka.p2m.BUn(),c.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}] of type [{1}]",this.hK,nb),this.wu.Z2n(),this.gTn(nb,Sb),this.wu.P2n(Sb),Ka.A_l.Sb(nb)&&this.wu.xsm(nb,Ka.A_l.ka(nb),
new d.a))}).fail(Sb=>{Ka.l8e(Ka.zOi,"GetCompletePresenceFail")&&(c.ULS.sendTraceTag(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}] of type [{2}]",Ua.RtcUtils.z1e(Sb),this.hK,nb),this.wu.GXh())}).always(()=>{Ka.yE&&Ka.yE.stop()})}catch(Sb){c.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",Ka.zOi,Sb.message)}}hZh(nb,Ka){nb=Ka.presence;
let Sb;const ab=Ka.uFb;this.qya.mna(1,0);try{Sb=Ua.RtcUtils.MHi(nb,this.Rmf)}catch(tb){this.qya.mna(1,3);c.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",tb.message);ab.setException(tb);return}const ub=new n.a;ub.fa(this._clientId,Object.assign(new aa,{Presence:nb,TimeStamp:(new Date).getTime()}));this.wu.Asm(Ka.type,ub);if(2!==this.uoc)this.wO.QCe(),this.qya.mna(1,2),ab.lj(null);else{var Aa=this.dHb.toString();++this.dHb;nb=new Z(()=>
this.t$n(Ka.type,Sb,Aa),Aa);nb=this.zCm(0,Ka.type).add(nb);nb.IVh(tb=>{2===tb&&(this.qya.mna(1,6),this.yCh||2!==Ka.type||c.ULS.sendTraceTag(508651234,500,15,"First persistent state update of type LiveMeeting for [{0}] was throttled",this.hK));ab.lj(null)});nb.HVh(()=>{})}}t$n(nb,Ka,Sb){let ab=null;const ub=new J,Aa=new F;c.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}] of type [{1}]",this.hK,nb);if(2!==this.uoc)return this.wO.QCe(),this.qya.mna(1,2),c.ULS.sendTraceTag(7934171,
500,15,"Connection is lost - unable to send the message for [{0}] of type [{1}]",this.hK,nb),Aa.dqk(),Aa;this.zo&&20>this.vMl&&(ab=this.zo.Xl("WebServiceCall","Send Presence Message"),this.vMl++);ub.start();Aa.iUg(1);try{this.X6.S7e(nb,Ka).done(()=>{this.wO.wTk();this.qya.mna(1,1);c.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}] of type [{2}]",Sb,this.hK,nb);2===nb&&(this.yCh=!0);Aa.Lpd(1);ub&&(ub.stop(),ub.ew>this.je.dwm?this.qya.mna(1,4):this.qya.mna(1,
5))}).fail(tb=>{this.kVd||(this.wO.QCe(),this.qya.mna(1,3),this.yCh||2!==nb||c.ULS.sendTraceTag(508651233,500,15,"First persistent state update of type LiveMeeting for [{0}] failed",this.hK),c.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",Sb,Ua.RtcUtils.z1e(tb),this.hK));Aa.Lpd(2)}).always(()=>{ab&&ab.stop()})}catch(tb){c.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",tb.message),
this.qya.mna(1,3),this.yCh||2!==nb||c.ULS.sendTraceTag(508651232,500,15,"First persistent state update of type LiveMeeting for [{0}] hit an exception",this.hK),Aa.Lpd(2)}return Aa}Utd(nb,Ka){nb=Ka.i1m;const Sb=Ka.uFb;let ab;try{ab=Ua.RtcUtils.MHi(nb,this.Rmf)}catch(ub){c.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",ub.message);Sb.setException(ub);return}try{this.X6.Utd(ab).done(()=>{c.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(ub=>
{this.kVd||c.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",Ua.RtcUtils.z1e(ub));Sb.lj(null)})}catch(ub){c.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",ub.message),Sb.lj(null)}}qDb(nb,Ka){const Sb=Ka.type;nb=Ka.tpc;const ab=Ka.i7m,ub=Ka.uFb;let Aa;this.qya.mna(0,0);try{Aa=Ua.RtcUtils.MHi(nb,this.Rmf)}catch(kc){this.qya.mna(0,3);c.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",
kc.message);ub.setException(kc);return}if(2!==this.uoc)ab?this.xhi.fa(Sb,nb):(this.wO.QCe(),this.qya.mna(0,2)),ub.lj(null);else{var tb=this.dHb.toString();++this.dHb;Ka=new Z(()=>this.A$n(Sb,Aa,tb),tb);Ka=this.zCm(1,Sb).add(Ka);Ka.IVh(kc=>{2===kc&&this.qya.mna(0,6);ub.lj(null)});Ka.HVh(()=>{})}}A$n(nb,Ka,Sb){let ab=null;const ub=new J,Aa=new F;c.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}] of type [{1}]",this.hK,nb);if(2!==this.uoc)return this.wO.QCe(),this.qya.mna(0,2),
c.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",this.hK),Aa.dqk(),Aa;this.zo&&3===nb&&20>this.wMl&&(ab=this.zo.Xl("WebServiceCall","Send WetContent Update"),this.wMl++);ub.start();Aa.iUg(1);this.X6.qDb(nb,Ka).done(()=>{this.wO.wTk();this.qya.mna(0,1);c.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}] of type [{2}]",Sb,this.hK,nb);Aa.Lpd(1);ub&&(ub.stop(),ub.ew>this.je.dwm?this.qya.mna(0,4):this.qya.mna(0,
5))}).fail(tb=>{this.kVd||(this.wO.QCe(),this.qya.mna(0,3),c.ULS.sendTraceTag(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",Sb,Ua.RtcUtils.z1e(tb),this.hK));Aa.Lpd(2)}).always(()=>{ab&&ab.stop()});return Aa}xJa(){this.X6.jlo(Object(b.a)(this,this.o0g,"onPresenceUpdated"));this.X6.ilo(Object(b.a)(this,this.LVh,"onPersistentStateUpdated"));this.X6.hlo(Object(b.a)(this,this.Azk,"onPersistentStateCleared"));this.X6.klo(Object(b.a)(this,this.E1g,"onUpdateNotificationReceived"))}H7m(){this.U7n();
this.wu.wYk(Object(b.a)(this,this.jKb,"onConnectionStateChanged"));this.wu.I6n(Object(b.a)(this,this.Wmm,"onRefreshProxyRequired"));this.wu.G6n(Object(b.a)(this,this.Umm,"onRefreshAllPersistentStateRequest"));this.wu.M6n(Object(b.a)(this,this.qDb,"sendUpdateNotification"));this.wu.o6n(Object(b.a)(this,this.cmm,"onInternalPresenceUpdated"));this.wu.p6n(Object(b.a)(this,this.dmm,"onInternalUpdateNotificationReceived"));this.wu.n6n(Object(b.a)(this,this.bmm,"onInternalPersistentStateUpdated"));this.wu.m6n(Object(b.a)(this,
this.amm,"onInternalPersistentStateCleared"));this.wu.L6n(Object(b.a)(this,this.hZh,"sendPersistentState"));this.wu.R6n(Object(b.a)(this,this.Utd,"updateClientInfo"))}cmm(nb,Ka){this.o0g(Ka.e8e,Ka.yYl)}o0g(nb){this.wO.S$g();this.LVh(0,nb)}bmm(nb,Ka){this.LVh(Ka.type,Ka.e8e)}gTn(nb,Ka){const Sb={};for(const ab in Ka)Sb[ab]=Ka[ab].Presence;this.Kmm(nb,Sb,Ka)}LVh(nb,Ka){this.wO.S$g();this.Kmm(nb,Ka)}Kmm(nb,Ka,Sb=null){if(c.ULS.OGa(500,100))for(var ab in Ka);delete Ka[this._clientId];if(!La.a.isEmpty(Ka)){for(var ub in Ka)ab=
ub,Ka[ab]=Ua.RtcUtils.deserialize(Ka[ub],"Presence",ab,!1,this.Rmf);ub=new n.a;ab=(new Date).getTime();for(const tb in Ka){var Aa=Ka[tb];const kc=tb;let dc;Sb?(dc=Sb[kc],dc.Presence=Aa):dc=Object.assign(new aa,{Presence:Aa,TimeStamp:ab});ub.fa(kc,dc)}this.wu.Asm(nb,ub);switch(nb){case 0:this.OLl||(c.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.hK),this.OLl=!0,m.AFrameworkApplication.Ng&&m.AFrameworkApplication.Ng.Uim());this.wu.psm(Ka,[]);break;case 2:this.lNl||
(c.ULS.sendTraceTag(508867081,500,50,"Raising first live meeting update notification for [{0}]",this.hK),this.lNl=!0);this.wu.osm(nb,Ka);break;default:this.wu.osm(nb,Ka)}}}amm(nb,Ka){this.Azk(Ka.BKi)}Azk(nb){this.wO.S$g();if(c.ULS.OGa(500,100))for(let Ka=0;Ka<nb.length;++Ka);nb.length&&(this.wu.l3n(nb),this.wu.V2n(nb),this.wu.psm({},nb))}dmm(nb,Ka){this.E1g(Ka.type,Ka.tpc)}E1g(nb,Ka=null){this.je.bdo&&0===nb&&c.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");
if(0===nb&&this.Ygi&&0<this.Ygi.length){const Sb=ba.a.getInstance({qNe:"ContentUpdateNotificationReceived",featureName:"RtcNotification",cNa:this.Ygi,qfd:"RealTimeCoauth"});Sb&&Sb.Bja(this.gPm)}this.je.cdo&&13===nb&&c.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",Ka||"<none>"));this.wO.S$g();5===nb?(Ka=(nb=this.lWn(Ka))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",nb.reason,nb.reconnectDelay):
"Received client reconnection request from the server without params.",c.ULS.sendTraceTag(18637071,500,50,Ka),this.wu.GXh(nb)):(Ka=Ua.RtcUtils.deserialize(Ka,String.format("UpdateNotification-{0}",Fa[nb]),null,!1,this.Rmf),this.wu.k3n(nb,Ka))}lWn(nb){try{if(!nb||""===nb)return null;const Ka=JSON.parse(nb);return new la(Ka[Ca.a.P3k],Ka[Ca.a.S8n],Ka[Ca.a.W8n],Ka[Ca.a.q7k])}catch(Ka){return c.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",Ka.message),null}}zCm(nb,Ka){return this.BHd.Hmn(this.Imn(nb,
Ka))}Imn(nb,Ka){return nb+","+Ka}U7n(){this.BHd.reset();this.BHd.Uum(Object(b.a)(this,this.Unm,"onTooManyUndeliveredMessages"))}static vfn(){var nb=new Map;nb.set("SkipAria","True");nb=Object.assign({},{extendedProperties:nb});return{mw:"ContentUpdateNotificationReceived",uQc:ya.b.FailureBased,gt:nb,KHb:3E5}}}Object(y.a)(Ia,"RtcMessageHandler",U,[]);class Oa{IWl(nb,Ka=""){return E.createInstance(nb,Ka)}O4m(nb,Ka=""){return H.createInstance(nb,Ka)}}Object(y.a)(Oa,"ThrottlerFactory",null,[1828]);var ma=
a(1638),za=a(380),Qa=a(21);class Xa{constructor(nb){this.messageId=nb;this.z$n=(new Date).getTime();this.R0j=new Qa.a}}Object(y.a)(Xa,"MessageLatencyDetails",null,[]);class Tb{constructor(nb,Ka,Sb){this.vjc=null;this.cfi=this.Pji=0;this.sendMessage=()=>{if(this.Irf){const ab=za.a.create().toString();this.vjc=new Xa(ab);this.wu.MQk(16,ab,!1,new d.a);window.setTimeout(()=>{this.bCn(ab)},this.cfi)}};this.L3n=(ab,ub)=>{16===ub.type?this.wu.MQk(17,ub.tpc,!1,new d.a):17===ub.type&&this.Irf&&ub.tpc&&this.processMessage(ub.tpc)};
this.je=Ka;this.gMl=Sb;this.Irf=!1;this.wu=nb;this.wu.Myc(this.L3n)}start(){if(this.gMl&&!this.Irf){const nb=this.je.iwm;this.cfi=this.je.ewm;nb<=this.cfi?(c.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",this.je.iwm,this.je.ewm),this.gMl=!1):(this.Irf=!0,this.Pji=window.setInterval(this.sendMessage,nb))}}bCn(nb){this.vjc&&this.vjc.messageId===
nb&&(0<this.vjc.R0j.count?(nb=this.vjc.R0j.toArray().join(","),c.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",nb)):c.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.vjc=null)}stop(){this.Pji&&(window.clearInterval(this.Pji),this.Irf=!1)}processMessage(nb){nb&&this.vjc&&nb.toString()===this.vjc.messageId&&this.vjc.R0j.add((new Date).getTime()-this.vjc.z$n)}static get instance(){return Tb.Qa}static tjn(nb,Ka,Sb){return Tb.instance||(Tb.Qa=new Tb(nb,
Ka,Sb))}}Tb.Qa=null;Object(y.a)(Tb,"ClientToClientMessageTelemetry",null,[]);class Kb{constructor(nb,Ka,Sb,ab,ub,Aa,tb,kc,dc,Db,sb,Qb){this.uli=!1;this.u_a=null;this.pLa=new n.a;this.xdf=1;this.reb=null;this.XR=!1;this.oei=(new Date(0)).getTime();this.YNl=0;this.mBm=()=>{const $a=this.xdf;this.uli=!1;this.wO.OXh();this.jgd.qpj(this.o2m,this.Elm,Object(b.a)(this.M8c,this.M8c.Dun,"initThrottlerManager"),Object(b.a)(this,this.l8e,"verifyConnectionToken"),$a)};this.Elm=($a=null)=>{this.wO.PXh();let X=
null;!$a||"documentsessiondeleted"!==(X=$a.toLowerCase())&&"documentsessionexpired"!==X?this.KPf():(c.ULS.sendTraceTag(508396225,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.hK,$a),this.disconnect())};this.KPf=($a,X=null)=>{c.ULS.sendTraceTag(508396224,500,50,"Disconnecting the connection [{0}]",this.u_a);$a=($a=2===this.v_a||1===this.v_a)&&!this.M8c.kVd;let Ta=!0,ca=0;X&&Object.getType(X)!==Object.getType(Sys.EventArgs.Empty)&&
X.Z_k&&""!==X.Z_k&&($a=!0,this.jgd.dcl(X.Z_k),Ta=X.q7k,ca=X.reconnectDelay);$a&&this.jKb(1,this.v_a);++this.xdf;this.M8c.xJa();this.$go(Ta);this.jgd.P_i();this.OWl();$a&&window.setTimeout(this.mBm,Math.min(ca,3E4))};this.bEm=()=>{let $a=null;const X=({correlationId:$a}=this.jgd.zLh()).returnValue;this.reb.qs=X;c.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.hK,$a)};this.o2m=$a=>{this.oei=(new Date).getTime();let X=null;this.reb.qs=
({correlationId:X}=this.jgd.zLh()).returnValue;this.je.yWm&&(this.reb.url=$a,ma.a.instance&&(ma.a.instance.lVl=l.a.VK($a)));let Ta=null;this.zo&&(Ta=this.zo.Xl("WebServiceCall","ConnectToServer"));c.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.hK);$a={};this.fFh&&($a.transport=1===this.fFh.length?this.fFh[0]:this.fFh);$a.pingInterval=null;u.a.instance.Q$g(1,0);$a.waitForPageLoad=!1;this.reb.start($a,null).done(ca=>{this.wO.YSk();u.a.instance.Q$g(1,1,!0);c.ULS.sendTraceTag(508396195,
500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",ca.id,X)}).fail(ca=>{c.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1},  ClientDetails: [{2}]",this.jgd.x$,X,this.hK);this.Elm();this.wO.Msm(ca);u.a.instance.Q$g(1,1,!1);this.wu.vsm(0,{["CorrelationId"]:X,["ErrorDetails"]:ca,["ConnectionState"]:h.a[this.v_a]})}).always(()=>{Ta&&Ta.stop();ma.a.instance&&(ma.a.instance.iai=!1)})};this.aom=($a,X)=>{for(const Ta of X.ano)this.pLa.Sb(Ta.key)||
this.pLa.fa(Ta.key,new x.a),$a=Ta.value,this.pLa.ka(Ta.key).fa(X.type,new r($a.Presence,new Date($a.TimeStamp))),Ta.key===this._clientId&&0===X.type&&this.wu.R2n($a.Presence)};this.$nm=($a,X)=>{for(const Ta of X.BKi)this.pLa.remove(Ta)};this.UJi=()=>{let $a;const X=[];({value:$a}=this.pLa.Ph(this._clientId)).returnValue&&this.pLa.remove(this._clientId);for(const Ta of this.pLa.keys)Array.add(X,Ta);for(const Ta of X)this.pLa.remove(Ta);$a&&this.pLa.fa(this._clientId,$a);this.wu.Q2n(X)};this._clientId=
nb;this.fFh=Ka;this.v_a=0;this.zo=ab;this.i9h=kc;this.$Qm=tb;this.JLm=dc;this.PMm=ub;this.jgd=Aa;this.hK=Sb;this.wO=Db;this.je=sb;this.Dn=Qb;this.BRm=1>100*Math.random()}get a$b(){return this.jgd.a$b}set a$b(nb){this.jgd.a$b=nb}get M8c(){return this.$Qm}get wu(){return this.JLm}init(){this.wu.DVm(this.KPf);this.wu.XVm(this.aom);this.wu.WVm(this.$nm);this.Dn.sHb(this.wO);m.AFrameworkApplication.I1(()=>{this.wO.zTk();ma.a.instance&&ma.a.instance.h6j()});this.OWl();this.t8m();this.wu.yQl(this.bEm)}t8m(){try{const Sb=
$.signalR;if(!Sb)throw Error.invalidOperation("Failed to retrieve Signalr object");const ab=Sb.version;if(!ab)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===ab){var nb=Sb.transports;if(!nb)throw Error.invalidOperation("Failed to retrieve transports object");var Ka=nb.longPolling;if(!Ka)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!Ka.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");
Ka.supportsKeepAlive=this.F5m()}}catch(Sb){c.ULS.sendTraceTag(508396227,500,15,"Failed to disable longPolling KeepAlives: {0}",Sb.message)}}F5m(){return()=>!1}OWl(){const nb=++this.xdf;this.oei=(new Date(0)).getTime();this.reb=this.PMm();this.wu.X2n(this.reb);this.reb.stateChanged(Ka=>{this.RQn(Ka,nb)});this.reb.connectionSlow(Object(b.a)(this,this.xUn,"onSlowConnection"));this.reb.error(Object(b.a)(this,this.mUn,"onSignalRError"));this.reb.log=Object(b.a)(this,this.nUn,"onSignalRLog")}l8e(nb,Ka){return nb!==
this.xdf?(c.ULS.sendTraceTag(508396226,500,50,"ConnectionToken verification failed for {0}",Ka),!1):!0}connect(){2!==this.v_a&&1!==this.v_a&&(c.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.hK),this.i9h.OQn(),u.a.instance.Igo(),this.jKb(1,this.v_a),this.mBm())}disconnect(){0===this.v_a?c.ULS.sendTraceTag(508396194,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.hK):(this.wO.Osm(),ma.a.instance&&(ma.a.instance.iai=!0),c.ULS.sendTraceTag(508396193,
500,50,"Starting explicit disconnect for [{0}]",this.hK),this.M8c.kVd=!0,this.i9h.tRn(),this.jKb(0,this.v_a),this.KPf(),this.M8c.kVd=!1)}$go(nb){const Ka=this.A_m(),Sb=this.reb,ab=this.u_a,ub=()=>{if(this.uli)c.ULS.sendTraceTag(508396191,500,15,"Stop connection was called twice, possibly on the same connection.");else try{this.uli=!0,Sb.stop(!0,nb)}catch(Aa){c.ULS.sendTraceTag(508396192,500,15,"Stopping connection failed: {0}",Aa.message)}};0<Ka?(c.ULS.sendTraceTag(508396190,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",
ab,Ka),window.setTimeout(ub,Ka)):(c.ULS.sendTraceTag(508396189,500,50,"Stopping connection [{0}].",ab),ub())}A_m(){let nb=0;0===this.reb.state&&(nb=this.oei+Kb.Ooo-(new Date).getTime(),0>nb&&(nb=0));return nb}get connectionState(){return this.v_a}SJd(nb){this.wu.SJd(nb)}wYk(nb){this.wu.wYk(nb)}Y7k(nb){return this.hZh(0,nb)}hZh(nb,Ka){const Sb=new d.a;this.wu.xsm(nb,Ka,Sb);return Sb.task}RFh(nb){this.wu.RFh(nb)}y_b(nb){return this.mnn(nb)}XKh(){return this.Zdn()}Zdn(){const nb={};for(const Ka of this.pLa)Ka.value.Sb(0)&&
(nb[Ka.key]=Ka.value.ka(0).data);return nb}mnn(nb){return this.pLa.Sb(nb)&&this.pLa.ka(nb).Sb(0)?this.pLa.ka(nb).ka(0).data:null}Ydn(){const nb=new x.a;if(!this.pLa.Sb(this._clientId))return nb;for(const Ka of this.pLa.ka(this._clientId))nb.fa(Ka.key,Ka.value.data);return nb}qDb(nb,Ka=null,Sb=!1){const ab=new d.a;this.wu.MQk(nb,Ka,Sb,ab);return ab.task}Myc(nb){this.wu.Myc(nb)}bjn(){return this.A5a(this._clientId)}A5a(nb){let Ka,Sb;return({value:Ka}=this.pLa.Ph(nb)).returnValue&&({value:Sb}=Ka.Ph(0)).returnValue?
new k(this.nnn(Sb),Sb.timeStamp):null}een(){const nb={};for(const Ka of this.pLa)Ka.value.Ph(0).returnValue&&(nb[Ka.key]=this.A5a(Ka.key));return nb}Utd(nb){const Ka=new d.a;this.wu.j3n(nb,Ka);return Ka.task}get clientId(){return this._clientId}get vfo(){return this.BRm}dispose(){var nb;if(!this.XR){if(null===(nb=m.AFrameworkApplication.ha)||void 0===nb?0:nb.getBooleanAppSetting("DetachRtcEventHandlerOnDispose"))this.G7m(),this.M8c.H7m();this.M8c.xJa();this.Dn.YKb(this.wO);this.wO.zTk();ma.a.instance&&
ma.a.instance.h6j();this.XR=!0}}RQn(nb,Ka){this.l8e(Ka,"StateChangedSignalR")&&this.jKb(this.OVl(nb.newState),this.OVl(nb.oldState))}jKb(nb,Ka){if((1!==this.v_a||0!==Ka||1!==nb)&&this.v_a!==Ka){var Sb=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.v_a,Ka,nb]));c.ULS.sendTraceTag(508396188,500,10,Sb)}if(this.v_a!==nb){switch(nb){case 2:ma.a.instance&&ma.a.instance.YHn();this.u_a=this.reb.id;c.ULS.sendTraceTag(3249539,
500,50,"Established connection [{0}] for client [{1}]",this.u_a,this.hK);this.PCn(this.reb);c.ULS.sendTraceTag(508396186,500,50,"Retrieving complete session state");Sb=null;this.zo&&(Sb=this.zo.Xl("WebServiceCall","Receive First Presence"));const ab=this.xdf;this.wu.W2n(Object(b.a)(this,this.l8e,"verifyConnectionToken"),ab,this.i9h,this.UJi,this.Ydn(),Sb);this.je.T8n&&Tb.tjn(this.wu,this.je,100*Math.random()<=this.je.U8n).start();break;case 1:2===Ka&&c.ULS.sendTraceTag(508396185,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",
this.u_a);break;case 0:if(Tb.instance&&Tb.instance.stop(),this.M8c.kVd)c.ULS.sendTraceTag(508396182,500,50,"Connection [{0}] has been explicitly closed",this.u_a);else{1===Ka&&(c.ULS.sendTraceTag(508396184,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.u_a),this.wO.M$g());2===Ka&&c.ULS.sendTraceTag(508396183,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",
this.u_a);this.KPf();return}}this.v_a=nb;this.wu.M2n(nb,Ka)}}G7m(){this.wu.H6n(this.KPf);this.wu.T6n(this.aom);this.wu.S6n(this.$nm);this.wu.N6n(this.bEm)}PCn(nb){if(nb&&nb.transport&&nb.transport.name){nb=nb.transport.name;var Ka=nb.toLowerCase();"websockets"===Ka?c.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",nb,this.hK):"serversentevents"===Ka?c.ULS.sendTraceTag(4290752,500,50,"Transport name - {0} for [{1}]",nb,this.hK):"foreverframe"===Ka?c.ULS.sendTraceTag(4290753,500,50,
"Transport name - {0} for [{1}]",nb,this.hK):"longpolling"===Ka?c.ULS.sendTraceTag(4290754,500,50,"Transport name - {0} for [{1}]",nb,this.hK):"mocktransport"!==Ka&&c.ULS.sendTraceTag(508396180,500,15,"Unknown transport protocol encountered - '{0}'",nb)}else c.ULS.sendTraceTag(508396181,500,10,"Transport protocol name is missing")}xUn(){if(this.je.fwm){const nb=l.a.XP(this.a$b,"mid");c.ULS.sendTraceTag(508396178,500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.u_a,
nb)}else c.ULS.sendTraceTag(508396177,500,50,"Detected that the connection [{0}] is slow",this.u_a)}mUn(){c.ULS.sendTraceTag(508396176,600,15,"SignalR ERROR for connection [{0}];",this.u_a)}nUn(nb){nb=a(624).RtcUtils.z1e(nb);if(this.je.fwm&&nb.startsWith("Keep alive timed out.")){const Ka=l.a.XP(this.a$b,"mid");c.ULS.sendTraceTag(508396175,500,15,"SignalR lib: {0}. Target Machine: {1}",nb,Ka)}else this.vfo&&2E3>this.YNl&&!nb.startsWith("Invok")&&!nb.startsWith("Trigger")&&(c.ULS.sendTraceTag(508396174,
500,50,"SignalR lib: {0}",nb),this.YNl++)}OVl(nb){switch(nb){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",nb,"Unknown SignalR state");}}nnn(nb){return nb&&nb.timeStamp?(new Date).getTime()-nb.timeStamp.getTime()>(this.je.JGh?6E4:this.je.Jid)?2:1:1}static createInstance(nb,Ka,Sb,ab,ub,Aa,tb,kc=null,dc=null,Db=null,sb,Qb=null,$a=null){return Kb.k4m(nb,Ka,Sb,$a,ab,ub,Aa,tb,kc,dc,Db,Qb)}static k4m(nb,Ka,Sb,ab,ub,Aa,tb,kc,dc=null,Db=null,
sb=null,Qb=null){const $a=z.createInstance(m.AFrameworkApplication.ha),X=m.AFrameworkApplication.buildVersion?m.AFrameworkApplication.buildVersion:"1.0",Ta=Kb.Jbj(nb,Ka,tb),ca=$a.j1m?a(1814).RealtimeChannelMetrics.createInstance(Ta):new M;var Ma=ma.a.create(ub);$a.Y8n&&Ma.Hgo($a.X8n);var Ba="";Ba=dc&&""!==dc?dc:"/rtc2/";Ma.G0l=l.a.VK(Ba);const wa=Ba+"signalr";dc=Ba+"findsession";const pa=T.ztn;Ba=new Oa;sb=sb||O.a.getInstance();c.ULS.shipAssertTag(508396228,500,$a.gwm<=v.a.qjm,"Client attempting to override max payload size beyond absolute limit");
const ta=Math.min($a.gwm,v.a.qjm);Ma.pjm=ta;Ma=new Ia($a,new P(Ba),nb,Ta,Wa=>new I(Wa.createHubProxy(pa)),kc,sb,ca,Ma,ta);Db||(Db=a(1632).FindSessionStrategy.createInstance(Ka,ub,dc,kc,X,tb,nb,Ta,sb,Aa,ab,Qb));Db.uWf=$a.uWf;Ka=new K(Ta);Sb=Sb?Sb.split(","):null;nb=new (a(1822).RealtimeChannel)(nb,Sb,Ta,kc,()=>$.hubConnection(wa),Db,Ma,Ka,sb,ca,$a,ub);nb.init();return nb}static Jbj(nb,Ka,Sb){return String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",nb,this.VFf(e.a[Sb]),this.VFf("browser"),
Ka)}static VFf(nb){return nb?nb.charAt(0).toLocaleUpperCase()+nb.substring(1,nb.length):nb}}Kb.Ooo=15E3;Object(y.a)(Kb,"RealtimeChannel",null,[1160,1159])},1827:function(y,C,a){a.d(C,"a",function(){return I});y=a(0);var c=a(405),b=a(419),d=a(420),e=a(6);class h{static ugj(O,Q,U){return h.vgj(O,Q,U,!0)}static vgj(O,Q,U,ba){const aa=document.createElementNS(h.eRe,"svg");aa.setAttribute("viewBox",String.format(h.DWi,h.CAh,h.BAh));aa.appendChild(h.msj(O,Q,U,ba));return aa}static msj(O,Q,U,ba){const aa=
h.CAh/O,La=Q/2*aa,Z=h.BAh/2;let la=0;ba&&(la=(O-3*Q-4*U)*aa/2);O=document.createElementNS(h.eRe,"g");Sys.UI.DomElement.addCssClass(O,h.CWi);for(ba=1;3>=ba;ba++)O.appendChild(h.zej(ba,La,la+(ba*(Q+U)-Q/2)*aa,Z));return O}static zej(O,Q,U,ba){const aa=document.createElementNS(h.eRe,"circle");Sys.UI.DomElement.addCssClass(aa,String.format("{0}-{1}",h.pJi,O));aa.setAttribute("cx",String.format("{0}",U));aa.setAttribute("cy",String.format("{0}",ba));aa.setAttribute("r",String.format("{0}",Q));return aa}}
h.eRe="http://www.w3.org/2000/svg";h.CWi="prDancingDots";h.pJi="prAnimateCircle";h.DWi="0 0 {0} {1}";h.BAh=40;h.CAh=120;Object(y.a)(h,"ModernPresenceTooltipDancingDots",null,[]);var n=a(41),m=a(169),k=a(109),l=a(88),u=a(221),r=a(197),x=a(111),v=a(64),z=a(3);class A extends b.a{constructor(O,Q){super(O);this.huf=this.qKa=this.Fwd=this.uya=this.aya=this.xJ=this.ov=null;this.mpa=Q.get(8,!1);this.kKa=Q.get(6,0);this.vni=Q.get(15,!1);this.je=Q;this.Uff=0;this.element=O;this.element.className=A.EWd;this.gS=
document.createElement("span");this.element.appendChild(this.gS);this.N$h=h.ugj(Q.get(6,0),4,2);this.LQ(Q);this._state=5}jXa(O){this.addHandler(d.a.JJ,O)}Ebb(O){this.removeHandler(d.a.JJ,O)}get user(){return this.huf}get state(){return this._state}dispose(){this.element&&(this.ov.hc(l.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.ov.hc(l.a.doubleClick,this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")),this.xJ.hc(l.a.aH,this.element,Object(e.a)(this,
this.tla,"onPointerDown")),this.xJ.hc(l.a.IQ,this.element,Object(e.a)(this,this.h0,"onPointerOut")),this.xJ.hc(l.a.ZO,this.element,Object(e.a)(this,this.i0,"onPointerOver")),this.aya.hc(this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}LQ(O){this.ov=O.get(10);this.ov.Ub(l.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.ov.Ub(l.a.doubleClick,this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior"));this.xJ=
O.get(9);this.xJ.Ub(l.a.ZO,this.element,Object(e.a)(this,this.i0,"onPointerOver"));this.xJ.Ub(l.a.IQ,this.element,Object(e.a)(this,this.h0,"onPointerOut"));this.xJ.Ub(l.a.aH,this.element,Object(e.a)(this,this.tla,"onPointerDown"));this.aya=O.get(13);this.aya.Ub(this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior"))}hide(O=null,Q=0,U=0){this.vni&&O?this.xjl(O,Q,U):(3===this.state&&this.ybh(),this.visible=!1,this._state=5)}xjl(O,Q,U=0){this.show(O,Q,15,4,void 0,U)}rnh(O,
Q,U,ba=!1,aa=!1,La=!1,Z=0){this.show(O,Q,U+20,ba?2:aa?1:0,La,Z)}bjl(O,Q,U,ba=!1,aa=0){this.show(O,Q,U+20,3,ba,aa)}show(O,Q,U,ba=3,aa=!1,La=0){!O||ba===this.state&&this.WDj(Q,U)||(this.gpi(ba,aa,La),this.z2(O,ba,La),this._state=ba,4===La||0===La&&!this.mpa?this.element.style.left=Q+"px":this.element.style.right=Q+"px",this.element.style.top=U+"px",this.visible=!0)}z2(O,Q,U){this.huf=O;x.a.Ow(this.gS);r.a.jKi(this.gS);this.gS.id="fly_"+O.clientId;this.gS.style.backgroundColor=O.color;4!==Q?(this.gS.style.height=
this.kKa+"px",this.gS.style.lineHeight=this.kKa+"px",r.a.S4(this.gS,"border-radius",this.kKa+"px")):4===U||0===U&&!this.mpa?this.gS.style.left="0px":this.gS.style.right="0px";2!==Q&&(4===Q?x.a.CB(this.gS,""):1===Q?this.gS.appendChild(this.N$h):(this.gS.setAttribute("dir","auto"),U=v.a.p2f(O.userName,!1),(!O.isAnonymous||n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&U||0!==Q?(O=O.userName,0===Q&&(O=U,r.a.S4(this.gS,"text-align",
"center")),x.a.CB(this.gS,O)):(this.uya||(this.uya=this.$Qi()),this.gS.appendChild(this.uya),r.a.S4(this.gS,"text-align","start"))))}onClick(O){if(0===this.state)return this.raiseEvent(d.a.JJ,new d.a(1,O)),!0;3===this.state&&c.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}h0(O){3===this.state&&this.raiseEvent(d.a.JJ,new d.a(3,O));return!1}i0(O){3!==O.Dg&&this.raiseEvent(d.a.JJ,new d.a(2,O));return!1}tla(O){if(3!==O.Dg)return!0;this.raiseEvent(d.a.JJ,new d.a(4,O));return!1}$Qi(){const O=
document.createElement("img");O.src=m.a.NX("doughperson_white_glyph.svg");O.setAttribute("Unselectable","on");u.a.vea(O,u.a.ii,u.a.pV);return k.c(this.kKa,this.kKa,null,null,A.N$i,"",!1,"",this.element.ownerDocument,O)}gpi(O,Q=!1,U=0){if(!this.l1b(this.state)||!this.l1b(O))switch(Sys.UI.DomElement.removeCssClass(this.element,this.Fwd),this.state){case 4:3===O?this.vza(A.FWd,A.zXf):this.l1b(O)&&this.vza(A.DWd,A.zXf);break;case 3:4===O?this.vza(A.HWd,A.yXf):this.l1b(O)&&(Q&&this.ybh(),this.vza(A.DWd,
A.yXf,Q?A.M$i:""));break;case 0:case 1:case 2:4===O?this.vza(A.HWd,A.GWd):3===O&&(Q&&this.bqi(),this.vza(A.FWd,A.GWd,Q?A.AXf:"",3===U?A.P$i:A.O$i));break;default:4===O?this.vza(A.HWd):3===O?this.vza(A.FWd):this.l1b(O)&&this.vza(A.DWd)}}vza(...O){this.Fwd=O.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.Fwd)}bqi(){this.Uff=window.setTimeout(()=>{this.element&&(this.qKa=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.qKa),this.element.style.zIndex="2",this.qKa.style.zIndex=
"1")},300)}ybh(){window.clearTimeout(this.Uff);this.qKa&&(Sys.UI.DomElement.removeCssClass(this.qKa,A.GWd+" "+A.AXf),Sys.UI.DomElement.addCssClass(this.qKa,A.L$i),z.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.qKa.parentNode&&this.element.parentNode.removeChild(this.qKa)}),r.a.NDe(this.element,"z-index"))}l1b(O){return 0===O||1===O||2===O}WDj(O,Q){const U=r.a.xla(this.element.style.top);return r.a.xla(this.element.style.left)===O&&U===Q}GEe(O){3===O&&r.a.xV(this.element,
"left")?(O=r.a.xla(this.element.style.left),r.a.NDe(this.element,"left"),this.element.style.right=-1*O+"px"):4===O&&r.a.xV(this.element,"right")&&(O=r.a.xla(this.element.style.right),r.a.NDe(this.element,"right"),this.element.style.left=-1*O+"px")}}A.EWd="prModernFlyout UIFont";A.HWd="flyoutIdle";A.FWd="flyoutExpanded";A.DWd="flyoutCollapsed";A.zXf="flyoutFromIdle";A.yXf="flyoutFromExpanded";A.GWd="flyoutFromCollapsed";A.AXf="flyoutStacked";A.M$i="flyoutFromStacked";A.L$i="flyoutFadeOut";A.N$i="cui-img-cont-float cui-img-20by20";
A.O$i="flyoutLtrDir";A.P$i="flyoutRtlDir";Object(y.a)(A,"ModernPresenceTooltipFlyoutControl",b.a,[]);class B{constructor(O,Q,U=2,ba=4){this.offsetTop=O;this.offsetLeft=Q;this.tAh=U;this.Rag=ba}}Object(y.a)(B,"FlyoutsPositioningInfo",null,[]);var G=a(85);class w{constructor(O=!1,Q=!1){this.qJe=!1;this.Mm=O;this.Pyd=Q;this.qJe=n.AFrameworkApplication.ha.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO:9192023_CalculateFlyoutDirectionsToHandleRTLScenarios")}skj(O,Q,U,ba,aa,La,
Z){const la=Z.y,da=Z.height;var J=this.Mdj(La);const Ca=J+Q;aa=O*U+(O-1)*aa;U=null;1===O||this.dGi(J,aa,la,da)?O=new B(0,0,2):(O=this.J9i(Ca,aa,la,da),O.offsetTop-=J);this.Pyd?U=new B(0,0,void 0,this.Mm?4:3):(La=this.Ldj(La,Z),J=Math.max(0,Z.x),Z=Z.width,Q=La+Q,this.qJe?U=this.iGi(La,ba,J,Z):this.eGi(La,ba,J,Z)?U=new B(0,0,void 0,this.Mm?3:4):this.fGi(Q,ba,J)&&(U=new B(0,0,void 0,this.Mm?4:3)),U||(U=this.I9i(La,Q,J,Z)));return new B(O.offsetTop,U.offsetLeft,O.tAh,U.Rag)}Mdj(O){return G.a.MWe(O)}Ldj(O,
Q){return this.Mm?this.qJe?G.a.AZf(O)-G.a.Kdj(O):Q.width-G.a.AZf(O):G.a.LWe(O)}dGi(O,Q,U,ba){return O+Q<=U+ba}J9i(O,Q,U,ba){let aa=1,La=Math.max(U,O-Q);Q>O-U&&(aa=2,La=Q<ba?ba-Q:U);return new B(La,0,aa)}iGi(O,Q,U,ba){const aa=this.gGi(O,Q,U);O=this.hGi(O,Q,U,ba);if(aa||O)return new B(0,0,void 0,this.Mm?aa?3:4:O?4:3)}eGi(O,Q,U,ba){return O+Q<=U+ba}fGi(O,Q,U){return Q<=O-U}hGi(O,Q,U,ba){return O+Q<=U+ba}gGi(O,Q,U){return U<=O-Q}I9i(O,Q,U,ba){ba-Q>=O-U?O=4:(Q=O,O=3);return new B(0,Q,void 0,O)}}Object(y.a)(w,
"ModernPresenceTooltipPositioner",null,[]);class F{constructor(O,Q,U,ba,aa,La,Z){this.XY=O;this._parent=Q;this.odf=U;this.X8h=ba;this.Wbi=aa;this.ymb=La;this.mpa=Z;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(O,Q){if(3!==O)if(5!==O&&this.XY&&this.XY.length){if(4===O){var U=this.Wbi;var ba=(this.ymb-U)/2;this.element.style.height=this.ymb+"px";this.element.style.width=this.ymb+"px";O=r.a.xla(this.XY[0].element.style.top);
Q=r.a.xla(this.mpa?this.XY[0].element.style.right:this.XY[0].element.style.left)}else U=this.odf,ba=(this.ymb-U)/2,this.element.style.height=this.ymb+"px",this.element.style.width=this.Uej()+2*ba+"px",O=r.a.xla(this.XY[this.XY.length-1].element.style.top),Q=this.xFi(this.XY[this.XY.length-1].element,U,Q);r.a.S4(this.element,"border-radius",this.ymb+"px");this.element.style.top=O-ba-U+"px";this.mpa?this.element.style.right=Q-ba+"px":this.element.style.left=Q-ba+"px";this.element.parentNode||this._parent.insertBefore(this.element,
this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}xFi(O,Q,U){return this.mpa&&!U?r.a.xla(O.style.right):this.mpa||U?this.mpa&&U?-r.a.xla(O.style.left)-Q:-r.a.xla(O.style.right)-Q:r.a.xla(O.style.left)}Uej(){return this.XY&&this.XY.length?this.odf+Math.min(this.XY.length-1,2)*this.X8h:0}}Object(y.a)(F,"ModernPresenceTooltipTarget",null,[]);var H=a(75),E=a(131),P=a(206);class T extends b.a{constructor(O,Q,U){super(O);this.Mlb=this.Qoa=this.Hif=
this.X_a=!1;this.Wm=[];this.ola=(ba,aa)=>{ba=this.aWa;this.$Ai()||2!==aa.type&&(4!==aa.type||3===ba)?4===aa.type&&3===ba?(this.Qoa&&(this.Qoa=!1),this.UOd()):3!==aa.type||3!==ba||this.X_a||(1<this.QAa?(this.Qoa=!0,z.Task.delay(250).continueWith(()=>{this.$2a(!0);this.Qoa=!1})):this.UOd()):(this.Qoa&&(this.Qoa=!1),3!==ba&&(this.sUf(),3===aa.jh.Dg&&this.UOd(2E3)));this.raiseEvent(d.a.JJ,aa)};this.Vzb=ba=>{3===ba.Dg?this.ola(this,new d.a(4,ba)):ba.eventName===l.a.ZO?this.ola(this,new d.a(2,ba)):ba.eventName===
l.a.IQ&&this.ola(this,new d.a(3,ba));return!1};this.Ysc={};this.je=U;this.Mm=U.get(8,!1);this.Thf=U.get(15,!1);this.b$h=U.get(12,0);this.vMa=U.get(6,0);this.kHb=Q;this.zuf=U.get(16);this.Pyd=U.get(17,!1);this.Ybi=U.get(19,!1);this.Lhi=U.get(20,!1);this.Wtc=0;this.Jhi=new w(this.Mm,this.Pyd);this.iMb=this.s0f();this.xEd=!1;this.Pxa=[];this.AOb=[];this.element.id=T.vXd();this.element.className=b.a.iVe("prControl",this.Mm);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.Mm;this.XGe(Q);
this.Qga=this.createElement("div");this.Qga.className="prFlyoutContainer";this.element.appendChild(this.Qga);this.XY=[];this.yKa=new F(this.FS,this.element,this.vMa,4,6,32,this.Mm);this.xJ=U.get(9);this.xJ.Ub(l.a.aH,this.yKa.element,this.Vzb);this.xJ.Ub(l.a.ZO,this.yKa.element,this.Vzb);this.xJ.Ub(l.a.IQ,this.yKa.element,this.Vzb)}get E3e(){return P.a.clone(this.Wm)}get FS(){return this.XY}get defaultZIndex(){return this.b$h}get QAa(){return this.FS?this.FS.length:0}get aWa(){return 0<this.QAa?this.FS[0].state:
5}get S9d(){return 3===this.aWa&&!this.X_a}jXa(O){this.addHandler(d.a.JJ,O)}Ebb(O){this.removeHandler(d.a.JJ,O)}dispose(){if(this.S9d)this.xEd=!0;else{if(this.FS)for(const O of this.FS)O.Ebb(this.ola),E.a.qz(O);this.XY=null;this.xJ.hc(l.a.aH,this.yKa.element,this.Vzb);this.xJ.hc(l.a.ZO,this.yKa.element,this.Vzb);this.xJ.hc(l.a.IQ,this.yKa.element,this.Vzb);super.dispose()}}ALb(){this.$2a();this.visible=!0}CJe(){this.visible=!0;this.sUf();this.X_a=!0}Soc(){this.CJe()}hide(){this.Obh();this.RBa();this.yKa.update(this.aWa,
this.Mlb)}z2(O){const Q=this.aWa,U=this.X_a;O.clientId||(O.clientId=(T.GOb++).toString());if(O.clientId in this.Ysc){var ba=this.eOa(O.clientId);if(0<=ba){ba=this.Wm[ba];if(ba.color===O.color&&ba.userName===O.userName)return;this.rua(O.clientId)}}this.hide();ba=new A(this.createElement("div"),this.je);ba.jXa(this.ola);this.Qga.insertBefore(ba.element,this.Qga.firstChild);this.Ysc[O.clientId]=ba;Array.add(this.Wm,O);Array.add(this.FS,ba);this.czh(Q,U);this.visible=!0}rua(O){if(this.S9d)Array.add(this.AOb,
O);else{var Q=this.aWa,U=this.X_a;this.hide();this.nec(O);this.czh(Q,U)}}Ure(O){const Q=this.eOa(O);if(!(0>=Q)){var U=this.Wm[Q];O=this.Ysc[O];Array.removeAt(this.Wm,Q);Array.insert(this.Wm,0,U);Array.removeAt(this.FS,Q);Array.insert(this.FS,0,O);this.Qga.removeChild(O.element);this.Qga.appendChild(O.element);this.$2a()}}czh(O,Q){0>=this.Wm.length?this.hide():3===O&&Q?this.CJe():this.ALb()}cIe(O,Q){Q?this.Moi(O):this.mbh(O)}RTf(O){if(this.S9d&&this.Ybi)return!1;O=T.q0d(O);if(this.Qga!==O&&x.a.Xsb(this.Qga,
O))return!0;for(const Q of this.FS)if(x.a.Xsb(Q.element,O))return!0;return!1}position(O,Q){this.element.style.top=Q+"px";this.element.style.left=O+"px"}$2a(O=!1){if(!O||this.Qoa){this.Hif&&this.zkh(!0);var Q=Math.min(3,this.QAa)-1;O=0;var U=1,ba=0;this.Mlb&&(O=this.iMb,U=-1,ba=-this.vMa);for(let aa=this.QAa-1;aa>Q;aa--)this.FS[aa].rnh(this.Wm[aa],-4*Q*U+ba,0,!0,!1,!0,O);for(;0<=Q;Q--)this.FS[Q].rnh(this.Wm[Q],-4*Q*U+ba,0,0<Q,Array.contains(this.Pxa,this.Wm[Q].clientId),Q!==this.Wtc,O);this.Wtc=0;
this.yKa.update(0,this.Mlb);this.zIndex=this.defaultZIndex;this.X_a=!1;this.Obh(0);this.xEd&&this.dispose()}}sUf(){this.Hif&&this.zkh(!1);this.zIndex=this.defaultZIndex+1;const {offsetX:O,offsetY:Q,Qag:U}=this.qal();for(let ba=0;ba<this.QAa;ba++)this.FS[ba].bjl(this.Wm[ba],O,Q+(this.vMa+2)*ba,ba!==this.Wtc,U)}RBa(){let O=0,Q=0;this.Mlb&&(O=this.iMb,Q=-6);for(let U=0;U<this.QAa;U++)this.FS[U].hide(this.Wm[U],Q,O);this.zIndex=this.defaultZIndex;this.visible=this.X_a=!1;this.xEd&&this.dispose()}UOd(O=
0){O?(this.Qoa=!0,z.Task.delay(O).continueWith(()=>{this.Thf?this.iFj():this.$2a(!0);this.Qoa=!1})):this.Thf?this.hide():this.$2a()}iFj(){this.Qoa&&this.hide()}$Ai(){if(n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.Bca&&H.c()){const O=appChrome.selectors.getShyState();return O.isActive&&0!==O.state}return!1}XGe(O){this.element.style.width=O+"px";this.element.style.height=this.vMa+"px"}nec(O){this.mbh(O);O=this.eOa(O);if(!(0>O)){var Q=this.Wm[O];Array.removeAt(this.Wm,O);delete this.Ysc[Q.clientId];
Q=this.FS[O];this.Qga.removeChild(Q.element);this.je.get(18,!1)&&Q.Ebb(this.ola);Array.removeAt(this.FS,O);Q.dispose()}}Obh(O=5){if(this.AOb.length){this.visible&&this.RBa();for(let Q=0;Q<this.AOb.length;Q++)this.nec(this.AOb[Q]);Array.clear(this.AOb);0>=this.Wm.length||5===O?this.hide():0===O&&this.ALb()}}eOa(O){for(let Q=0;Q<this.Wm.length;Q++)if(this.Wm[Q].clientId===O)return Q;return-1}Moi(O){if(-1===this.eOa(O))c.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");
else{if(Array.contains(this.Pxa,O)){if(this.Wm[0].clientId===O)return;Array.remove(this.Pxa,O)}Array.add(this.Pxa,O);this.Ure(O);1!==this.aWa&&this.$2a()}}mbh(O){-1===this.eOa(O)?c.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.Pxa,O)&&(Array.remove(this.Pxa,O),this.Wm[0].clientId===O&&0<this.Pxa.length&&this.Ure(this.Pxa[this.Pxa.length-1]),this.Wm[0].clientId===O&&1===this.aWa&&this.$2a())}zkh(O){O?Sys.UI.DomElement.addCssClass(this.Qga,
"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.Qga,"prBackgroundSelection")}qal(){let O,Q;Q=O=0;var U=this.iMb;if(this.zuf){const ba=this.zuf(this);if(!ba)return{offsetX:O,offsetY:Q,Qag:U};const aa=4===this.aWa;U=this.Jhi.skj(this.QAa,aa?6:this.vMa,this.vMa,150,2,this.element,ba);Q=U.offsetTop;this.Wtc=this.Mjj(U.tAh,U.offsetTop);U=U.Rag;U!==this.iMb&&(this.GEe(U),this.element.dir=3===U?"rtl":"ltr",this.iMb=U);U!==this.s0f()?(O=this.Lhi?-2:aa?-6:-this.vMa,this.Mlb=!0):this.Mlb=!1}return{offsetX:O,
offsetY:Q,Qag:U}}Mjj(O,Q){if(1===O)return this.QAa-1;O=Math.abs(Q);return 0<O?O/(this.vMa+2):0}GEe(O){for(let Q=0;Q<this.QAa;Q++)this.FS[Q].GEe(O)}s0f(){return this.Mm?3:4}static vXd(){return String.format("{0}-{1}","presencetooltip",T.GOb++)}static q0d(O){return O.Pb.rawEvent.relatedTarget}}T.GOb=0;Object(y.a)(T,"ModernPresenceTooltipControl",b.a,[626,40]);var K=a(254),M=a(340),N=a(330);class I{constructor(O){this.je=O;this.je.bfa(10,K.a.instance);this.je.bfa(9,N.a.instance);this.je.bfa(6,20);this.je.bfa(13,
M.a.instance);this.je.bfa(17,!1)}jIh(O,Q){this.je.bfa(15,!1);return new T(O,Q,this.je)}YKf(O){this.je.bfa(15,!1);return new T(O,20,this.je)}}Object(y.a)(I,"ModernPresenceTooltipFactory",null,[625])},1830:function(y,C,a){a.d(C,"a",function(){return B});y=a(0);var c=a(1703),b=a(419),d=a(420),e=a(6),h=a(88),n=a(111);class m extends b.a{constructor(G,w){super(G);this.Wm=null;this.mpa=w.get(8,!1);this.kKa=w.get(6,0);this.element=G;this.element.className=m.EWd;this.$Hd=this.createElement("ul");this.element.appendChild(this.$Hd);
this.ov=w.get(10);this.ov.Ub(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.xJ=w.get(9);this.xJ.Ub(h.a.IQ,this.element,Object(e.a)(this,this.h0,"onPointerOut"));this.xJ.Ub(h.a.aH,this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior"));this.aya=w.get(13);this.aya.Ub(this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior"))}jXa(G){this.addHandler(d.a.JJ,G)}Ebb(G){this.removeHandler(d.a.JJ,G)}get users(){return this.Wm}dispose(){this.element&&
(this.ov.hc(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.xJ.hc(h.a.aH,this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")),this.xJ.hc(h.a.IQ,this.element,Object(e.a)(this,this.h0,"onPointerOut")),this.aya.hc(this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(G,w,F){this.hide();!G||0>=G.length||(this.mpa?this.element.style.right=w+"px":this.element.style.left=w+"px",this.element.style.top=
F+"px",this.msi(G),this.visible=!0)}msi(G){this.Wm=G;n.a.Ow(this.$Hd);for(let w=G.length-1;0<=w;w--)this.z2(G[w])}z2(G){const w=document.createElement("li");w.style.backgroundColor=G.color;w.style.height=this.kKa+"px";w.id="fly_"+G.clientId;w.style.lineHeight=this.kKa+"px";n.a.CB(w,G.userName);w.setAttribute("dir","auto");this.$Hd.appendChild(w)}onClick(){this.hide();return!1}h0(G){this.raiseEvent(d.a.JJ,new d.a(3,G));return!1}}m.EWd="prFlyout UIFont";Object(y.a)(m,"PresenceTooltipFlyoutControl",
b.a,[]);var k=a(109);class l extends b.a{constructor(G,w,F){super(G);this.uya=null;this.Wm=[];this.element.className="prGlyph";this.je=w;this.ylb=this.je.get(9);this.pv=this.je.get(10);this.aya=this.je.get(13);this.vFj();this.z2(F);this.VAd=!1}get $Ea(){return this.Wm.length}get users(){return this.Wm}jXa(G){this.addHandler(d.a.JJ,G)}Ebb(G){this.removeHandler(d.a.JJ,G)}dispose(){this.Exl();super.dispose()}z2(G){Array.add(this.Wm,G);2===this.$Ea?this.hGb(!0):1===this.$Ea?this.hGb(!1):this.hGb(this.VAd)}rua(G){this.u8i(G)&&
(1<this.$Ea&&this.hGb(!0),1===this.$Ea?this.hGb(!1):1>this.$Ea&&this.hide())}show(){this.hGb(2<=this.$Ea);this.visible=!0}hide(){this.visible=!1}Bjj(G){return G?this.t_f(0,5):this.t_f(1,4)}u8i(G){for(let w=0;w<this.$Ea;w++)if(this.Wm[w].clientId===G)return G=this.Wm[w],Array.removeAt(this.Wm,w),G;return null}hGb(G){this.VAd!==G&&(this.uya&&this.element.removeChild(this.uya),this.uya=this.Bjj(G),this.element.appendChild(this.uya),this.VAd=G);this.uya.childNodes[0].style.backgroundColor=this.Wm[this.Wm.length-
1].color}t_f(G,w){const F=this.je.get(6,0),H=this.je.get(14);return k.c(F,F,this.je.get(G),this.je.get(w),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,H?H.cloneNode(!0):null)}i0(G){3!==G.Dg&&this.raiseEvent(d.a.JJ,new d.a(2,G));return!1}onClick(G){this.raiseEvent(d.a.JJ,new d.a(1,G));return!0}h0(G){3!==G.Dg&&this.raiseEvent(d.a.JJ,new d.a(3,G));return!1}Exl(){this.element&&(this.ylb.hc(h.a.aH,this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")),
this.ylb.hc(h.a.ZO,this.element,Object(e.a)(this,this.i0,"onPointerOver")),this.ylb.hc(h.a.IQ,this.element,Object(e.a)(this,this.h0,"onPointerOut")),this.pv.hc(h.a.doubleClick,this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")),this.pv.hc(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.aya.hc(this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")))}vFj(){this.element&&(this.ylb.Ub(h.a.aH,this.element,Object(e.a)(this,
this.G1,"stopPropagationAndPreventDefaultBehavior")),this.ylb.Ub(h.a.ZO,this.element,Object(e.a)(this,this.i0,"onPointerOver")),this.ylb.Ub(h.a.IQ,this.element,Object(e.a)(this,this.h0,"onPointerOut")),this.pv.Ub(h.a.doubleClick,this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")),this.pv.Ub(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.aya.Ub(this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")))}}Object(y.a)(l,"PresenceTooltipGlyph",
b.a,[]);var u=a(131);a(85);var r=a(206);class x extends b.a{constructor(G,w,F){super(G);this.Wm=[];this.uD=[];this.apa=0;this.ERb=this.vkb=!1;this.xbf=null;this.ola=(H,E)=>{var P=Object(c.a)(l,H);P=P?this.eWf(P):-1;if(2===E.type||1===E.type&&-1!==P&&!this.GZ[P].visible)this.K4c(H);else if(1===E.type)this.RBa(),this.vkb=!1;else if(3===E.type){if(this.RTf(E.jh))return;this.vkb||this.RBa()}this.raiseEvent(d.a.JJ,E)};this.yOb={};this.je=F;this.Mm=F.get(8,!1);this.J6=F.get(11,!1);G=F.get(12,0);this.mYa=
F.get(6,0);this.kHb=w;this.element.id=x.vXd();this.element.className=b.a.iVe("prControl",this.Mm);G&&(this.zIndex=G);this.rtl=this.Mm;this.XGe(w);this.C6=this.createElement("div");this.C6.className=this.J6?"prContainerV":"prContainerHr";this.element.appendChild(this.C6);this.Agf=Array(this.apa);for(w=0;w<this.apa;w++)this.GZ[w]=new m(this.createElement("div"),this.je),this.GZ[w].jXa(this.ola),this.element.appendChild(this.GZ[w].element)}get E3e(){return r.a.clone(this.Wm)}getGlyph(G){return this.yOb[G]}get GZ(){return this.Agf}get Bvf(){return this.xbf}get qbd(){return this.mYa+
2}get width(){return this.J6?this.qbd:this.kHb}get height(){return this.J6?this.kHb:this.qbd}jXa(G){this.addHandler(d.a.JJ,G)}Ebb(G){this.removeHandler(d.a.JJ,G)}dispose(){if(this.GZ)for(const G of this.GZ)G.Ebb(this.ola),u.a.qz(G);u.a.k5e(this.uD);this.uD=this.Agf=null;super.dispose()}ALb(){this.RBa();this.xJe();this.visible=!0;this.vkb=!1}CJe(){!this.uD||1>this.uD.length||(this.RBa(),this.visible=!0,this.xJe(),this.K4c(this.uD[this.uD.length-1]),this.vkb=!0)}Soc(){if(this.uD&&!(1>this.uD.length)){this.visible=
!0;this.xJe();var G=0;for(const w of this.uD)this.K4c(w,G++);this.vkb=!1;this.ERb=!0}}hide(){this.visible=!1;this.RBa();for(let G=0;G<this.uD.length;G++)this.uD[G].hide();this.vkb=!1}EGf(){if(!this.ERb)return!1;let G=0;for(const w of this.GZ)w.visible&&G++;return this.ERb=0<G&&(this.Wm.length<=this.apa?G===this.Wm.length:G===this.apa)}z2(G){if(!(0>=this.apa)){G.clientId||(G.clientId=(x.GOb++).toString());if(G.clientId in this.yOb){var w=this.eOa(G.clientId);if(0<=w){w=this.Wm[w];if(w.color===G.color&&
w.userName===G.userName)return;this.rua(G.clientId)}}w=this.EGf();var F=0;if(this.Wm.length<this.apa){var H=new l(this.createElement("div"),this.je,G);H.jXa(this.ola);this.Mm&&!this.J6&&0<this.Wm.length?this.C6.insertBefore(H.element,this.C6.firstChild):(this.C6.appendChild(H.element),F=this.uD.length);Array.add(this.uD,H)}else this.Mm&&!this.J6?H=this.uD[0]:(F=this.uD.length-1,H=this.uD[F]),H.z2(G);H.show();this.yOb[G.clientId]=H;Array.add(this.Wm,G);this.yxh(H,F);w&&this.Soc()}}rua(G){const w=this.EGf();
w&&this.RBa();this.nec(G);this.Wm.length>=this.apa&&this.uD.length<this.apa&&this.FSk();0>=this.Wm.length?this.hide():w&&this.Soc()}Ure(){}nec(G){var w=this.eOa(G);0>w||(G=this.Wm[w],Array.removeAt(this.Wm,w),w=this.yOb[G.clientId],delete this.yOb[G.clientId],w.rua(G.clientId),this.yxh(w),0>=w.$Ea&&(this.C6.removeChild(w.element),Array.remove(this.uD,w),w.dispose()))}cIe(){}FSk(){var G=this.Rmj();!G||1>=G.users.length||(G=Array.clone(this.Wm),G.forEach(w=>{this.nec(w.clientId)}),G.forEach(w=>{this.z2(w)}))}eOa(G){for(let w=
0;w<this.Wm.length;w++)if(this.Wm[w].clientId===G)return w;return-1}Rmj(){return this.Mm&&!this.J6?this.uD[0]:this.uD[this.uD.length-1]}position(G,w){this.element.style.top=w+"px";this.element.style.left=G+"px"}xJe(){for(let G=0;G<this.uD.length;G++)this.uD[G].show()}RBa(){for(let G=0;G<this.apa;G++)this.GZ[G].hide();this.ERb=!1}K4c(G,w=0){if(G)if(this.xbf=G,this.J6){const F=this.mYa;if(1<G.users.length)this.GZ[w].show(G.users,F,this.height-this.mYa);else{const H=this.C6.children.length;for(let E=
0;E<this.C6.children.length;E++)G.element===this.C6.children[E]&&this.GZ[w].show(G.users,F,this.height-(H-E)*this.qbd+2)}}else this.GZ[w].show(G.users,this.width,0)}RTf(G){G=x.q0d(G);let w=!1;for(const F of this.GZ)if(n.a.Xsb(F.element,G)){w=!0;break}return this.C6!==G&&n.a.Xsb(this.C6,G)||w}yxh(G,w=0){const F=this.UMj(G);F&&0>=G.$Ea?this.GZ[w].hide():F?this.K4c(G):this.GZ[w].hide()}eWf(G){let w=0;for(const F of this.uD){if(G===F)return w;w++}return-1}UMj(G){const w=this.eWf(G);return!!this.Bvf&&
G===this.Bvf&&-1!==w&&this.GZ[w].visible}XGe(G){this.apa=G===this.mYa?1:Math.floor(G/this.qbd);this.J6?(this.element.style.height=G+"px",this.element.style.width=this.mYa+"px"):(this.element.style.width=G+"px",this.element.style.height=this.mYa+"px")}static vXd(){return String.format("{0}-{1}","presencetooltip",x.GOb++)}static q0d(G){G=G.Pb.rawEvent;return G.relatedTarget||G.toElement}}x.GOb=0;Object(y.a)(x,"PresenceTooltipControl",b.a,[626,40]);var v=a(254),z=a(340),A=a(330);class B{constructor(G){this.je=
G;this.je.bfa(10,v.a.instance);this.je.bfa(9,A.a.instance);this.je.bfa(6,16);this.je.bfa(13,z.a.instance)}jIh(G,w){return new x(G,w,this.je)}YKf(G){return new x(G,16,this.je)}}Object(y.a)(B,"PresenceTooltipFactory",null,[625])},1902:function(y,C,a){a.r(C);var c=a(0),b=a(405),d=a(21),e=a(30),h=a(99),n=a(57),m=a(3),k=a(59);class l{constructor(bc,cc,Vc,td,Xc,ne,Vd,Ja,Lb=!1){this.fgd=null;this.Lai=!0;this.Mhi=this.ALa=this.H7h=null;this.nb=new e.a;this.qun=()=>{this.ANl.result&&this.$Ml.result&&(this.ALa=
this.ANl.result,this.Mhi=this.$Ml.result,this.ALa.RFh(this.o0g),this.H7h=new h.a(2,2,this.JIl,this.Elo,88),l.Ce.Rb(this.H7h))};this.o0g=(fa,Na)=>{(this.Lai||this.T3n(Na.e8e))&&l.Ce.Yla(this.H7h,0)};this.Elo=fa=>{var Na=this.ALa.een();if(Na){var ha=new Date,sa=!1;if(this.Lai){this.fgd=Na;this.Lai=!1;var xa=this.fgd;for(var pb in xa){Na=pb;var Rb=xa[pb];Rb.LZe<ha&&(ha=Rb.LZe);2===Rb.status&&(sa=!0,this.Mhi.gYh(Na))}sa&&this.Csm();l.Ce.Yla(fa,this.w3l(ha))}else{Rb=new d.a;pb=!1;var Fc=this.fgd;for(xa in Fc){Fc=
xa;if(!(Fc in this.fgd)||this.GPm.clientId===Fc)continue;var Kc=this.fgd[Fc];const jb=Na[Fc];if(Kc&&jb){Kc=Kc.status;const zb=jb.status;2===Kc&&1===zb?(Rb.add(Fc),b.ULS.sendTraceTag(38052609,392,50,Fc+" returned from away")):1===Kc&&2===zb&&(pb=sa=!0,this.Mhi.gYh(Fc),b.ULS.sendTraceTag(38052610,392,50,Fc+" went away"));1===zb&&jb.LZe<ha&&(ha=jb.LZe)}}this.fgd=Na;l.Ce.Yla(fa,this.w3l(ha));(0<Rb.count||sa)&&this.Csm();0<Rb.count&&!this.MQm?(fa=this.dfn(Rb),this.$io(fa)):fa=new d.a;(pb||0<fa.count)&&
this.xQm(n.a.nob,2)}}};this.GPm=bc;this.ANl=cc;this.$Ml=Vc;this.ZMl=td;this.JIl=ne;l.Ce=Xc;this.xQm=Vd;this.Eeb=Ja;this.MQm=Lb;m.Task.WAA(cc,Vc).continueWith(this.qun)}Csm(){this.nb.raiseEvent("u",null,this)}T3n(bc){for(const Vc in bc){var cc=this.ZMl.V3l({key:Vc,value:bc[Vc]});if(cc&&cc.clientId&&(cc=cc.clientId.toLowerCase(),(cc=this.fgd[cc]||this.fgd[cc.toUpperCase()])&&2===cc.status))return!0}return!1}$io(bc){if(bc.count)for(const cc of bc)bc=this.Eeb.OX(String.format(Object(k.a)("EditorsToastArriving"),
cc),!1),bc.image=5,bc.aY="CoAuth_AuthorStatus_16x16x32",this.Eeb.mi(bc)}dfn(bc){const cc=this.ALa.XKh(),Vc=new d.a;for(const td in cc){const Xc={key:td,value:cc[td]};if(bc.contains(Xc.key)){const ne=this.ZMl.V3l(Xc);ne&&(Vc.add(ne.userName),bc.remove(Xc.key))}}Vc.count||b.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return Vc}w3l(bc){return Math.max(bc.getTime()+this.JIl-(new Date).getTime(),0)}}l.Ce=null;Object(c.a)(l,"AwayManager",null,[]);var u=a(798),r=a(50),x=a(41),
v=a(363),z=a(1822),A=a(95),B=a(1815),G=a(6),w=a(1187),F=a(1627),H=a(1632),E=a(1465),P=a(624),T=a(1626),K=a(43),M=a(470),N=a(220),I=a(40),O=a(1189),Q=a(64),U=a(1703),ba=a(28),aa=a(1229),La=a(415),Z=a(53),la=a(80);class da{constructor(bc,cc){this.shapeNode=bc;this.pBm=cc}}Object(c.a)(da,"ShapeNodeStartEditingNotificationTracking",null,[]);class J{constructor(bc,cc,Vc,td,Xc="",ne=""){if(!bc||!cc||0>Vc)throw Error.argumentNull("LockEntry");this.n1=bc;this.GL=cc;this.Jka=Vc;this.rFn=td;this.nim=Xc;this.mim=
ne;this.$fm=new Date}get clientId(){return this.n1}get U_h(){return this.GL}get shapeId(){return this.Jka}get lockType(){return this.rFn}get YBm(){return this.nim}get WBm(){return this.mim}get gam(){return!Q.a.wb(this.mim)&&!Q.a.wb(this.nim)}get Sam(){return this.$fm}set Sam(bc){this.$fm=bc}}Object(c.a)(J,"LockEntry",null,[]);class Ca{constructor(bc,cc,Vc,td,Xc="",ne=""){this.clientId=bc;this.slideId=cc;this.shapeId=Vc;this.lockType=td;this.rowId=Xc;this.cellId=ne}}Object(c.a)(Ca,"SerializableLockData",
null,[]);var Fa=a(203),ya=a(71),Ua=a(264);class Ia{constructor(bc,cc,Vc,td,Xc,ne,Vd,Ja,Lb,fa,Na,ha,sa,xa,pb,Rb,Fc,Kc,jb,zb,ic,bb){this.ynn=new u.a("",ResourceStrings.L_GhostUserName,aa.a.LIh,new O.a(1));this.e0e={};this.f0e={};this.d0e={};this.Sfm=K.App.Qp;this.Cgk=null;this.Olk={};this.VPh={};this.WPh={};this.Tfm=K.App.Qp;this.jim=!0;this.Agm=this.rgm=0;this.oSh=(new Date(0)).getTime();this.pSh=(new Date(0)).getTime();this.nFg=(new Date(0)).getTime();this.vik=(new Date(0)).getTime();this.iim=!1;
this.j8a=bc;this.qT=cc;this.j0e=Vc;this.bOg=td;this.jc=Xc;this.Yb=ne;this.sa=Vd;this.fsg=Ja;this.$r=Lb;this.La=fa;this.Fc=Na;this.cpd=ha;this.Tak=sa.rOh;this.zR=xa;this.$Ya=pb;this.ya=Rb;this.Jhm=Fc;this.od=Kc;this.od.DQl(Object(G.a)(this,this.gUn,"onShapeViewElementRequestUpdateAuthorInfo"));(this.O5=x.AFrameworkApplication.ha.getBooleanAppSetting(ya.a.mBb))&&this.sa.AO(Object(G.a)(this,this.tE,"onSelectionChanged"));this.bOg.Myc(Object(G.a)(this,this.E1g,"onUpdateNotificationReceived"));this.qHn=
jb;this.Ee=zb;this.cHn=ic;this.Ea=sa;this.opd=bb;this.wun()}wun(){I.a.$(509219588,828,50,"CoauthStateChangesHandler:InitRttRelatedTasks - IsDedicatedSession: {0}, RttLockSettings: {1}",this.Tak,this.zR.BCn());this.zR.$Zi||(0<this.zR.Mrd?this.Yb.Rb(new h.a(2,2,this.zR.Mrd,Object(G.a)(this,this.removeExpiredLock,"removeExpiredLock"),90,"71")):I.a.$(509219587,804,10,"RemoveExipredLockIntervalMs is not set correctly while RTT lock is enabled"),0<this.zR.LLe?(this.Yb.Rb(new h.a(2,2,this.zR.LLe/2,Object(G.a)(this,
this.switchPendingSveToFidelity,"switchPendingSveToFidelity"),90,"72")),this.jim=!1):I.a.$(509219586,804,50,"Switch to fidelity delay after unlock is disabled"),0<this.zR.eYe?this.Yb.Rb(new h.a(2,2,this.zR.eYe,Object(G.a)(this,this.updateLockIfImeActive,"updateLockIfImeActive"),90,"73")):I.a.$(509219585,804,50,"IME typing lock notification disabled"),0<this.zR.Mpd?this.Yb.Rb(new h.a(2,2,this.zR.Mpd,Object(G.a)(this,this.detectLockLeak,"detectLockLeak"),90,"74")):I.a.$(509219584,804,50,"Lock leack detection is disabled"),
this.fsg.addHandler(La.a.PHh,(bc,cc)=>{this.Z1m(cc)}),this.zR.GPf||this.Grh||(this.cpd.kXa(Object(G.a)(this,this.Zkm,"onBeforeParagraphNodePropertyChanged")),0<this.zR.Mtd?this.Yb.Rb(new h.a(2,2,this.zR.Mtd,Object(G.a)(this,this.updateLockForActiveShapeNodes,"updateLockForActiveShapeNodes"),90,"75")):I.a.$(509219555,804,15,"DedicatedWorkerTypingUpdateIntervalMs is not set correctly")),this.Grh&&(this.cHn.kXa(Object(G.a)(this,this.xve,"onTableCellNodePropertyChanged")),this.cpd.kXa(Object(G.a)(this,
this.Zkm,"onBeforeParagraphNodePropertyChanged")),this.qHn.initialize(),0<this.zR.Mtd&&this.Yb.Rb(new h.a(2,2,this.zR.Mtd,Object(G.a)(this,this.updateLockForActiveTableCellNodes,"updateLockForActiveTableCellNodes"),90,"76")),0<this.zR.Mrd&&this.Yb.Rb(new h.a(2,2,this.zR.Mrd,Object(G.a)(this,this.removeExpiredTableCellLock,"removeExpiredTableCellLock"),90,"77"))))}get Grh(){return this.zR.J2i&&this.zR.JZl}removeExpiredLock(){var bc=Ua.a(this.e0e);for(const cc of bc){bc=Object(U.a)(112,this.e0e[cc]);
if(!bc){delete this.e0e[cc];continue}const Vc=bc.shapeNode;Vc&&Vc.isConnected?this.$Ya.I2l(Vc)||this.pXh(cc)||(delete this.e0e[cc],this.$Ya.J0f(Vc)||bc.isDisposed?I.a.$(509219554,814,50,"Previous non wet changes lock is expired but the shape contains wet changes now"):this.IDm(bc)):delete this.e0e[cc]}}removeExpiredTableCellLock(){var bc=Ua.a(this.f0e);for(const cc of bc){bc=Object(U.a)(1172,this.f0e[cc]);if(!bc){delete this.f0e[cc];continue}const Vc=bc.tableCellNode;Vc&&Vc.isConnected?Q.a.wb(this.$Ya.XZf(Vc))&&
!this.pXh(cc)&&(delete this.f0e[cc],this.JDm(bc)):delete this.f0e[cc]}}detectLockLeak(){const bc=[],cc=new Date,Vc=this.o5l();for(const td of Vc)td.isLocked&&+cc-+td.Mce>this.zR.Mpd&&bc.push(td.shapeNode.om);0<bc.length&&I.a.$(509219553,828,15,"Following objects are locked longer than {0} : {1}",this.zR.Mpd,bc.join(";"))}switchPendingSveToFidelity(){const bc=new Date,cc=this.o5l();for(const Vc of cc)Vc.isLocked||Vc.shapeNode.gd&&this.Grh||!Vc.vp||Vc.fz||!(+bc-+Vc.mbm>this.zR.LLe)||Vc.QB||Vc.jhc()}updateLockIfImeActive(){if(this.Sfm>=
this.Tfm&&this.Cgk){const bc=this.Fbn(this.Cgk);this.v2h(bc)&&this.dih(bc.slideId,bc.get_shapeId(),2)}this.Tfm=new Date}updateLockForActiveShapeNodes(){var bc=Ua.a(this.VPh);for(const cc of bc)bc=Object(U.a)(351,this.VPh[cc]),this.v2h(bc)&&this.dih(bc.slideId,bc.get_shapeId(),3);this.VPh={}}updateLockForActiveTableCellNodes(){var bc=Ua.a(this.WPh);for(const cc of bc)if(bc=Object(U.a)(394,this.WPh[cc]),this.v2h(bc)){const Vc=this.La.Jn(bc);this.dih(Vc.slideId,Vc.get_shapeId(),3,bc.rowId.toString(),
bc.cellId.toString())}this.WPh={}}Fbn(bc){return(bc=this.$r.lM(bc))?this.La.Jn(bc.mb):null}Zkm(bc,cc){cc&&cc.node?(bc=Object(U.a)(352,cc.node),bc)?bc.loading||bc.Jnc||cc.property.id!==Z.a.Tq.id||(cc=this.La.cna(bc),bc=this.Fc.vIa(bc),cc&&(bc?(cc=this.gLh(cc.slideId,cc.get_shapeId(),bc.rowId.toString(),bc.cellId.toString()),this.WPh[cc]=bc):(bc=this.lXe(cc.slideId,cc.get_shapeId()),this.VPh[bc]=cc))):I.a.$(509219551,828,10,"Invalid argument."):I.a.$(509219552,828,10,"Invalid argument.")}B9n(bc){const cc=
new h.a(2,1,this.zR.tph,Object(G.a)(this,this.rtcNotifyStartEditing,"rtcNotifyStartEditing"),90,"78");cc.customData=new da(bc,!1);this.Yb.Rb(cc);this.Olk[this.lXe(bc.slideId,bc.get_shapeId())]=cc}rtcNotifyStartEditing(bc){bc=Object(U.a)(da,bc.customData);const cc=bc.shapeNode;this.v2h(cc)&&this.Uyn(cc)&&this.dih(cc.slideId,cc.get_shapeId(),1);bc.pBm=!0}v2h(bc){return bc?bc.isConnected:!1}Uyn(bc){return(bc=this.Qk(bc))?bc.NF:!1}Qk(bc){return Object(U.a)(112,bc.Vg(this.jc.eo.Ua))}o5l(){const bc=[];
if(!this.ya.Ia)return bc;var cc=this.ya.Ia.Nj();if(!cc)return bc;for(const Vc of cc)(cc=this.Qk(Vc))&&!cc.isDisposed?bc.push(cc):I.a.$(509219549,828,50,"Shape {0} on active slide doesn't have valid view element",Vc.om);return bc}pnm(bc){this.qzm(bc)&&(this.j8a.amIAlone||this.B9n(bc))}tE(bc,cc){for(bc=0;bc<cc.cJ.length;bc++){const td=cc.cJ[bc];var Vc=Object(U.a)(351,td.context.node);Vc&&Vc.isConnected&&(Vc=Object(U.a)(112,Vc.yc(this.Ee)))&&(Vc=this.Jhm.J7(Vc.shapeNode))&&(1===td.lia?Vc.eWg():0===td.lia&&
Vc.Wsk())}}onm(bc){if(this.qzm(bc)&&!this.zR.EPf){var cc=this.lXe(bc.slideId,bc.get_shapeId()),Vc=Object(U.a)(h.a,this.Olk[cc]);if(Vc){const td=Object(U.a)(da,Vc.customData);this.Yb.Sh(Vc);td&&td.pBm&&this.dih(bc.slideId,bc.get_shapeId(),4);this.Olk[cc]=null}}}gUn(bc,cc){this.Ynm(cc.pJ)}Ynm(bc){bc.pM()||bc.shapeNode.vgb?this.XTm(bc):this.Znm(bc)}xve(bc,cc){if((cc=Object(U.a)(Fa.TableCellNode,cc.node))&&(bc=Object(U.a)(1172,cc.Vg(this.Ee)))&&cc.isConnected){cc=this.$Ya.XZf(cc);const Vc=this.mOk(bc.tableCellNode);
Q.a.wb(cc)?Vc?(this.O3j(bc,this.PZb(Vc.clientId,Ia.T1i)),this.hAl(bc)):Q.a.wb(cc)&&(this.mOk(bc.tableCellNode)||this.JDm(bc)):(this.O3j(bc,this.PZb(cc,Ia.T1i)),this.hAl(bc))}}O3j(bc,cc){bc.lock(cc)}JDm(bc){bc.unlock()}dih(bc,cc,Vc,td="",Xc=""){try{const ne=new Ca(this.j0e,bc.Bpc,cc,Vc,td,Xc);this.bOg.qDb(7,ne)}catch(ne){I.a.$(509219548,814,10,"LockManager.SendLockNotification : MyClientId: {0}; Exception: {1}. ",this.j0e,ne.stack)}}E1g(bc,cc){this.Ea.Z2e&&!this.iim&&8===cc.type&&this.opd&&this.Gdo(cc)&&
(I.a.$(509219547,814,50,"Log coauth activity"),this.iim=!0,this.opd.continueWith(()=>{this.opd.result.logActivity("CoauthContentMerge","PptCoauthSurveyFloodgateEnabled")}));7===cc.type&&((bc=cc.tpc)?bc.clientId===this.j0e?I.a.$(509219545,828,15,"Lock notification : lock notification from myself recieved"):(I.a.$(509219544,828,50,"Lock notification : LockClientId {0}, MyClientId: {1}.",bc.clientId,this.j0e),bc=new J(bc.clientId,bc.slideId,bc.shapeId,bc.lockType,bc.rowId,bc.cellId),this.bUm(bc),this.L1n(bc)):
I.a.$(509219546,828,10,"Lock notification: invalid lock data recieved"))}Znm(bc){if(!bc||bc.isDisposed)I.a.$(509219543,828,15,"UpdateAuthorInfoTaskHandler: shapeViewElement is null: {0}.",!bc);else{var cc=bc.shapeNode;if(!(cc.xg||this.Tak&&cc.gd&&(this.zR.USd||this.Grh))){var Vc=this.$Ya.J0f(cc);Vc?this.OPh(bc,this.PZb(Vc,Ia.T1i)):(cc=this.$Ya.I2l(cc))?(this.OPh(bc,this.PZb(cc,Ia.q9m)),this.gAl(bc)):(cc=this.mOk(bc.shapeNode))?(this.OPh(bc,this.PZb(cc.clientId,this.flj(cc.lockType))),this.gAl(bc)):
bc.isLocked&&this.IDm(bc)}}}IDm(bc){const cc=this.Jhm.J7(bc.shapeNode);cc&&(cc.h2h(null),bc.unlock(this.jim||!cc.SDj))}OPh(bc,cc){bc.lock(cc);bc.pM()&&this.sa.nj()}Gdo(bc){if(!bc||null===bc.tpc)return!1;bc=this.rWn(bc.tpc);for(const cc of bc)cc&&cc.clientId&&(cc.clientId.toLowerCase()===this.j0e.toLowerCase()?(this.rgm++,this.oSh=this.oSh===(new Date(0)).getTime()?(new Date).getTime():this.oSh,this.pSh=(new Date).getTime()):this.Mxn(cc.clientId)||(this.Agm++,this.nFg=this.nFg===(new Date(0)).getTime()?
(new Date).getTime():this.nFg,this.vik=(new Date).getTime()));return 5<=this.rgm&&5<=this.Agm&&(this.vik>=this.oSh&&this.nFg<=this.pSh||this.pSh>=this.nFg&&this.pSh<=this.vik)&&1<=this.qT.fXe()?!0:!1}rWn(bc){let cc=null;try{cc=bc}catch(Vc){}if(null===cc||!cc.length){let Vc=null;try{Vc=bc}catch(td){I.a.$(509219541,828,10,"UpdateHint can't convert to RTC message.")}if(null!==Vc)return[Vc]}return cc}Mxn(bc){bc=this.PZb(bc);const cc=this.PZb(this.j0e);return bc&&cc&&bc.userName===cc.userName&&bc.email===
cc.email?!0:!1}flj(bc){switch(bc){case 1:return Ia.Cgo;case 2:return Ia.Jtn;case 3:return Ia.Qko;case 4:return Ia.c$m}I.a.$(509219539,828,10,"Unknown lock type");return"Unknown lock type"}bUm(bc){if(bc&&bc.U_h){var cc=bc.gam?this.gLh(new la.a(bc.U_h),bc.shapeId,bc.YBm,bc.WBm):this.lXe(new la.a(bc.U_h),bc.shapeId);if(4===bc.lockType)this.d0e[cc]=bc;else{var Vc=Object(U.a)(J,this.d0e[cc]);Vc?(Vc=this.dlj(Vc),this.dlj(bc)>Vc&&(this.d0e[cc]=bc)):this.d0e[cc]=bc}}}dlj(bc){return this.zin(bc.lockType)-
(+new Date-+bc.Sam)}zin(bc){switch(bc){case 1:return this.zR.sph;case 2:return this.zR.Gbg;case 3:return this.zR.Zvh;case 4:return this.zR.rUd}I.a.$(509219536,828,10,"Unknown lock type");return 0}mOk(bc){if(Object(ba.a)(351,bc)){bc=Object(U.a)(351,bc);if(!bc.slideId)return null;bc=this.lXe(bc.slideId,bc.get_shapeId());return this.pXh(bc)}if(Object(ba.a)(394,bc)){bc=Object(U.a)(394,bc);const cc=this.La.cna(bc);if(!cc.slideId)return null;bc=this.gLh(cc.slideId,cc.get_shapeId(),bc.rowId.toString(),bc.cellId.toString());
return this.pXh(bc)}return null}pXh(bc){if(!bc)return null;const cc=Object(U.a)(J,this.d0e[bc]);return cc?0>=this.dlj(cc)?this.d0e[bc]=null:cc:null}gAl(bc){const cc=this.qln(bc);cc&&(this.e0e[cc]=bc)}hAl(bc){const cc=this.qmn(bc);cc&&(this.f0e[cc]=bc)}qln(bc){return bc?this.lXe(bc.shapeNode.slideId,bc.shapeNode.get_shapeId()):null}qmn(bc){if(!bc)return null;bc=bc.tableCellNode;const cc=this.La.cna(bc);return this.gLh(cc.slideId,cc.get_shapeId(),bc.rowId.toString(),bc.cellId.toString())}lXe(bc,cc){return String.format("{0}#{1}#{2}",
bc.sid,bc.cid,cc)}gLh(bc,cc,Vc,td){return String.format("{0}#{1}#{2}#{3}#{4}",bc.sid,bc.cid,cc,Vc,td)}Gxn(bc){const cc=Object(U.a)(22,this.ya.Ia);return cc&&la.a.W_h(bc.U_h,cc.fc.Bpc)?!0:!1}L1n(bc){if(this.Gxn(bc)){var cc=bc.shapeId,Vc=bc.clientId;this.ya.Ia&&(cc=this.ya.Ia.h1(cc))&&(bc.gam&&this.zR.J2i?this.R1n(bc,Vc,cc):this.O1n(bc,Vc,cc))}}O1n(bc,cc,Vc){Vc.xg||this.Tak&&Vc.gd&&(this.zR.USd||this.Grh)||!(Vc=this.Qk(Vc))||(this.OPh(Vc,this.PZb(cc,this.flj(bc.lockType))),this.gAl(Vc))}R1n(bc,cc,Vc){if((Vc=
this.rmn(Vc,bc.YBm,bc.WBm))&&Vc.isConnected){var td=Object(U.a)(1172,Vc.Vg(this.Ee));td&&Q.a.wb(this.$Ya.XZf(Vc))&&(this.O3j(td,this.PZb(cc,this.flj(bc.lockType))),this.hAl(td))}}rmn(bc,cc,Vc){bc=this.Fc.IS(Object(U.a)(351,bc));if(!bc)return null;var td=this.Fc.ena(bc);bc=null;for(const Xc of td){td=this.Fc.cgb(Xc);for(const ne of td)if(ne.rowId.toString()===cc&&ne.cellId.toString()===Vc){bc=ne;break}}return bc}XTm(bc){const cc=new h.a(0,1,0,()=>{this.Znm(bc)},90,"79");this.Yb.Rb(cc)}Z1m(bc){this.Sfm=
new Date;this.Cgk=this.rbn(bc.Hc)}rbn(bc){return bc?bc.querySelector(".Paragraph"):null}PZb(bc,cc=""){const Vc=this.qT.PZb(bc);if(Vc)return Vc;I.a.$(509219531,828,50,"Failed to find presence user for client id: {0}; DataSource: {1}.",bc,cc);return this.ynn}qzm(bc){return!this.zR.$Zi&&!(this.zR.USd&&bc.gd)&&!bc.xg}}Ia.T1i="EditingBy";Ia.q9m="EditingByInSameWorker";Ia.Cgo="StartEditing";Ia.c$m="EndEditing";Ia.Jtn="ImeTyping";Ia.Qko="Typing";Object(c.a)(Ia,"CoauthStateChangesHandler",null,[1185]);class Oa{constructor(bc){this.hmc=
{};this.n1=bc.CR;this.init(bc)}init(bc){if(bc=bc.B$)for(const cc of bc)cc.ID!==this.n1&&(this.hmc[cc.ID]=new Date)}oTm(bc){for(let cc=0;cc<bc.length;cc++)bc[cc]in this.hmc||bc[cc]===this.n1||(this.hmc[bc[cc]]=new Date)}cho(bc){const cc=this.hmc[bc];cc&&(I.a.$(37590341,814,50,"EditorPresenceTracker : Presence of coauthoring user never appeared, but leaving coauth; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.n1,bc,(new Date).getTime()-cc.getTime()),delete this.hmc[bc])}bho(bc){const cc=
this.hmc[bc];cc&&(I.a.$(507843859,814,50,"EditorPresenceTracker : Presence of coauthoring user appeared; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.n1,bc,(new Date).getTime()-cc.getTime()),delete this.hmc[bc])}aho(){for(const bc of Object.keys(this.hmc))I.a.$(507843858,814,15,"EditorPresenceTracker : Presence of coauthoring user never appear; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.n1,bc,(new Date).getTime()-this.hmc[bc].getTime());this.hmc={}}}Object(c.a)(Oa,
"EditorPresenceTracker",null,[1183]);class ma{constructor(bc){this.iGn=bc;this.yQ=new w.a;this.yQ.lj(this.iGn)}}Object(c.a)(ma,"PPTRtcProvider",null,[1182]);var za=a(132),Qa=a(38),Xa=a(1431);class Tb{constructor(bc,cc,Vc,td,Xc){this.zJb=null;this.yRa=!1;this.rak=this.nhk=null;this.PDn=za.a.create();this.bRh=!1;this.uWf=0;this.XYa=Xc;Vc.li&&(this.findSessionResponse=bc,td.yQl(Object(G.a)(this,this.H$n,"sessionPropertiesChanged")));this.GTc=new Qa.a(()=>cc())}get findSessionResponse(){return this.zJb}set findSessionResponse(bc){if(this.yRa)I.a.$(507843676,
814,15,"PptAssignRtcMachineStrategy : FindSessionResponse Not updating cached find session response as it is already set");else if(this.zJb=bc)this.yRa=!0,this.nhk=this.zJb.hVl,this.rak=this.zJb.x$}get a$b(){return this.yRa?this.nhk:this.GTc.value.a$b}set a$b(bc){this.yRa?this.nhk=bc:this.GTc.value.a$b=bc}dcl(bc){this.GTc.value.dcl(bc)}get x$(){return this.yRa?this.rak:this.GTc.value.x$}set x$(bc){this.yRa?this.rak=bc:this.GTc.value.x$=bc}zLh(){let bc;I.a.$(507843675,814,50,"PptAssignRtcMachineStrategy : OnConnectionStateChanged isFindSessionResponseValid:{0}, havePerformedFindSessionWithLazyStrategy:{1}",
this.yRa,this.bRh);return this.yRa?(bc=this.zJb.correlationId||this.PDn.toString(),I.a.$(507843674,500,50,"CorrelationId after FindSession: {0}",bc),{returnValue:String.format("{0}&{1}={2}",this.zJb.Zhb,x.AFrameworkApplication.cIh,Q.a.yj(bc)),correlationId:bc}):this.bRh?this.GTc.value.zLh():(I.a.$(507843673,814,50,"PptAssignRtcMachineStrategy : GetFindSessionRequestQs returning null QS to avoid crashing"),{returnValue:null,correlationId:null})}qpj(bc,cc,Vc,td,Xc){I.a.$(507843672,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",
this.yRa);this.yRa?(bc(this.zJb.nJf),Vc(new Xa.a(this.zJb.xUh,this.zJb.wUh,this.zJb.vUh,this.zJb.EMh))):(this.GTc.value.qpj(bc,cc,Vc,td,Xc),this.bRh=!0);this.XYa&&this.XYa.mi(26,!this.bRh)}P_i(){I.a.$(507843671,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.yRa);this.yRa?this.yRa=!1:this.GTc.value.P_i()}jKb(bc,cc){I.a.$(507843670,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.yRa);this.yRa||this.GTc.value.jKb(bc,cc)}H$n(){I.a.$(507843669,
814,50,"PptAssignRtcMachineStrategy : SessionPropertiesChanged; FindSessionQs refreshed isFindSessionResponseValid:{0}",this.yRa);this.yRa=!1}}Object(c.a)(Tb,"PptAssignRtcMachineStrategy",null,[1181]);var Kb=a(1641);class nb{constructor(){this.yq=null}Xjc(bc,cc){this.yq||(this.yq={});this.yq[cc]||(this.yq[cc]=0);this.yq[cc]+=bc}getData(){return this.yq}reset(){this.yq=null}}Object(c.a)(nb,"MultiSumDataAggregator",null,[1812]);class Ka{constructor(bc,cc){this.f7h=Kb.a.RX(bc,cc,new nb,!0)}Ff(bc){this.f7h.track(1,
bc)}}Object(c.a)(Ka,"MultiCounter",null,[1852]);class Sb{constructor(bc,cc,Vc,td){this.U5=bc;this.Yfa=cc;this.iHn=Vc;this.MEn=td;this.U5.Myc(Object(G.a)(this,this.Z8n,"rtcOnUpdateNotificationReceived"))}Z8n(bc,cc){0===cc.type&&(this.MEn.Ff("CU"),this.iHn||this.GO())}GO(){!x.AFrameworkApplication.Ch&&this.Yfa.iY&&this.Yfa.GO(null,null,null)}}Object(c.a)(Sb,"ContentNotificationManager",null,[]);class ab extends Sb{constructor(bc,cc,Vc,td){super(bc,cc,Vc,td)}static init(){if(K.App.Zb){var bc=K.App.Zb.Sd;
if(bc&&(bc.CFh(ab.Qkm),bc=bc.tj)&&(bc=bc.Zq)){var cc=K.App.xi;if(cc&&cc.Dx&&(cc=r.a.instance.resolve("AppRealtimeChannel.IRealtimeChannel"))){var Vc=x.AFrameworkApplication.ha.getBooleanAppSetting("Box4ThrottleInboundRequests"),td=new Ka(11,1);ab.sQh=ab.sQh||new ab(cc,bc,Vc,td);ab.sQh.GO()}}}}static Qkm(bc){ab.sQh||(bc.hYh(ab.Qkm),ab.init())}}ab.sQh=null;Object(c.a)(ab,"PptContentNotificationManager",Sb,[]);var ub=a(17),Aa=a(298),tb=a(118),kc;(function(bc){bc[bc.azo=0]="signalRConnectFailed";bc[bc.Dwo=
1]="findSessionFailed"})(kc||(kc={}));Object(c.b)("RtcConnectFailureType",kc);var dc=a(272),Db=a(42);class sb{constructor(bc,cc,Vc,td,Xc,ne){this.tSh=this.tgm=this.Zme=this.Yme=0;this.Sle=this.RVc=this.Y6b=this.OCg=this.qRh=this.F8a=null;this.KRh=this.LRh=this.MRh=this.HRh=this.IRh=!1;this.uhm=bc;this.rq=cc;this.LN=Vc;this.LN.uTe(Object(G.a)(this,this.xac,"onNetworkHealthStateChanged"));this.Dj=td;this.Flk=ne;$addHandler(window,"visibilitychange",Object(G.a)(this,this.ETa,"onVisibilityChange"));this.wGn=
Xc;this.wGn.KVm(Object(G.a)(this,this.LTn,"onRtcConnectFailed"))}xac(bc,cc){cc.mZe||(this.LRh=this.MRh=!0)}ETa(){window.document.hidden&&(this.HRh=this.IRh=!0)}LTn(bc,cc){bc=cc.Man;if(cc=cc.errorMessage){if(0===bc){const {dGj:Vc,eGj:td,Cj:Xc}=P.RtcUtils.G_l(cc.ErrorDetails);cc.HttpErrorCode=Vc;cc.HttpErrorStatus=td;cc.Exception=Xc;delete cc.ErrorDetails;if(!Vc&&this.Flk&&0<this.Flk.length)try{let ne=!0;const Vd=window.location.hostname.toLowerCase();for(const Ja of this.Flk.split(";"))if(Vd.endsWith(Ja)){ne=
!1;break}cc.IsCORS=ne.toString()}catch(ne){cc.Unexpected=ne.message}}I.a.$(508946247,500,15,"PptRealtimeChannelMetrics:OnRtcConnectFailed; AmIAlone:{0}; IsPageHidden:{1}; IsNetworkHealthy:{2}; rtc connect failed type:{3}; errorMessage:{4}",this.rq.amIAlone,window.document.hidden,this.Dj.OO,kc[bc],ub.a.toJSON(cc));this.KRh||(this.KRh=this.yyn(bc,cc))}}yyn(bc,cc){const Vc=dc.c(cc,"HttpErrorCode",-1);return 500<=Vc&&599>=Vc||1===bc&&"FindSessionRequestFailed"!==cc.FindSessionFailureReason?!0:!1}O6l(){return this.F8a&&
1===this.Zme?this.IRh||this.MRh:this.Y6b&&1<this.Zme?this.HRh||this.LRh:!1}N6l(){return this.Y6b&&0<this.tSh?this.HRh||this.LRh:this.F8a&&0<this.Yme?this.IRh||this.MRh:!1}OXh(){this.Yme++;this.OCg=new Date;this.F8a||(this.F8a=new Date,this.IRh=window.document.hidden,this.MRh=!this.Dj.OO)}YSk(){this.Nsm(0)}Nsm(bc){this.Zme++;this.RVc=new Date;this.qRh?this.QHh>this.uhm.M3k&&(bc={["hasExceededReconnectionThrehold"]:!0,["numberOfSuccessfullConnections"]:this.Zme,["numberOfConnectionAttempts"]:this.Yme,
["firstConnectionAttempt"]:this.F8a?this.F8a.toISOString():"",["lastConnectionSuccess"]:this.RVc?this.RVc.toISOString():"",["lastUnexpectedDisconnect"]:this.Y6b?this.Y6b.toISOString():"",["lastExplicitDisconnect"]:this.Sle?this.Sle.toISOString():"",["reconnectDurationInMs"]:this.QHh,["hasPageHiddenOrNetworkIssue"]:this.O6l()},I.a.$(36804373,500,15,ub.a.toJSON(bc))):(this.qRh=this.RVc,Aa.a.instance.mc("FirstPresenceUpdated",(new Date).getTime().toString()),this.QHh>this.uhm.M3k&&(bc={["hasExceededConnectionThrehold"]:!0,
["numberOfConnectionAttempts"]:this.Yme,["firstConnectionAttempt"]:this.F8a?this.F8a.toISOString():"",["firstConnectionSuccess"]:this.qRh?this.qRh.toISOString():"",["lastExplicitDisconnect"]:this.Sle?this.Sle.toISOString():"",["connectDurationInMs"]:this.QHh,["connectionDurationFromStopWatchInMs"]:bc,["hasPageHiddenOrNetworkIssue"]:this.O6l()},I.a.$(36804373,500,15,ub.a.toJSON(bc))))}PXh(){this.tgm++;const bc={["numberOfFailedConnections"]:this.tgm,["numberOfConnectionAttempts"]:this.Yme,["firstConnectionAttempt"]:this.F8a?
this.F8a.toISOString():"",["lastConnectionAttempt"]:this.OCg?this.OCg.toISOString():"",["lastExplicitDisconnect"]:this.Sle?this.Sle.toISOString():"",["lastConnectionFail"]:(new Date).toISOString(),["disconnectedDurationMs"]:this.zYl,["hasPageHiddenOrNetworkIssue"]:this.N6l()};this.KRh?(b.ULS.sendTraceTag(508946246,500,15,ub.a.toJSON(bc)),this.Qsm("ClientRTCSetupFailureDueToServerError")):(b.ULS.sendTraceTag(36804375,500,15,ub.a.toJSON(bc)),this.Qsm("ClientRTCSetupFailureDueToClientError"))}Qsm(bc){!this.N6l()&&
5E3<this.zYl&&Db.a("ClientRTCSetupFailureQoSErrorEnabled")&&tb.Health.instance.recordQosError(bc,["PresenceExperienceDegraded"],!1,!0,!0,!1,null)}M$g(){this.tSh++;this.Y6b=new Date;this.HRh=window.document.hidden;this.LRh=!this.Dj.OO}$3n(){this.ldo()&&this.PXh();this.Sle=new Date;this.X0m()}X0m(){this.tSh=this.Zme=this.Yme=0;this.RVc=this.Y6b=this.OCg=this.F8a=null;this.KRh=!1}ldo(){return!!this.OCg&&!this.RVc&&!this.Y6b}get QHh(){if(this.RVc){if(this.F8a&&1===this.Zme)return this.rq.u_f(this.F8a,
this.RVc);if(this.Y6b&&1<this.Zme)return this.rq.u_f(this.Y6b,this.RVc)}return 0}get zYl(){return this.Y6b&&0<this.tSh?this.rq.u_f(this.Y6b,new Date):this.F8a&&0<this.Yme?this.rq.u_f(this.F8a,new Date):0}}Object(c.a)(sb,"PptRealtimeChannelMetrics",null,[1180]);var Qb=a(92),$a=a(47),X=a(51);class Ta{constructor(bc,cc,Vc,td,Xc){this.HFn=bc.toLowerCase();this.uWc=cc;this.Wn=Vc;this.QA=td;this.pr=Xc;this.QA.Rva(Object(G.a)(this,this.tqd,"onShapeNodeLoaded"));this.pr.oui(Object(G.a)(this,this.R0g,"onShapeViewElementUnlocked"))}dispose(){this.QA.Fbb(Object(G.a)(this,
this.tqd,"onShapeNodeLoaded"));this.pr.CZk(Object(G.a)(this,this.R0g,"onShapeViewElementUnlocked"))}wH(bc){return this.D2m(bc)||this.rVl(bc)}rVl(bc){if(!bc||bc.xg)return!1;const cc=bc.ra(X.a.RRf,"");return+new Date-+bc.Mce<this.uWc&&!!cc&&cc.toLowerCase()!==this.HFn}D2m(bc){return!!this.J0f(bc)}I2l(bc){let cc="";bc&&this.rVl(bc)&&(cc=bc.jb(X.a.RRf));return cc}J0f(bc){return bc?bc.ra(X.a.uJh,""):""}XZf(bc){return bc?bc.ra(X.a.QTl,""):""}Lmo(bc){if(bc&&(bc.wH=this.wH(bc),bc.anchor)){const Vc=this.Wn.dwa(bc);
for(;Vc.moveNext();){var cc=Vc.currentNode;$a.ParagraphReader.ue(cc)&&(cc=Object(U.a)(Qb.AParagraphNode,cc))&&(cc.wH=bc.wH)}}}R0g(bc,cc){this.Lmo(cc.pJ.shapeNode)}tqd(bc,cc){bc=cc.node;bc.rEm();bc.wH=this.wH(bc)}}Object(c.a)(Ta,"PptWetChangeHandler",null,[1179,40]);class ca{constructor(bc){this.$Fn=bc}aYa(){return this.$Fn.aYa()}}Object(c.a)(ca,"PresenceCache",null,[]);var Ma=a(829),Ba=a(1813),wa=a(1729),pa=a(1716);class ta extends e.a{constructor(){super();this.KSh=[]}KSb(bc){bc&&(I.a.$(8958528,
814,50,"PresenceDataManager : AddPresence; clientId: {0}; presence: {1}",bc.clientId,bc.presence.toString()),Array.add(this.KSh,bc))}gYh(bc){(bc=this.L1d(bc))&&this.v4e(bc);return bc}v4e(bc){bc&&(I.a.$(507843860,814,50,"PresenceDataManager : RemovePresence; clientId: {0}; presence: {1}",bc.clientId,bc.presence.toString()),Array.remove(this.KSh,bc))}L1d(bc){for(const cc of this.KSh)if(cc.clientId===bc)return cc;return null}aYa(){return this.KSh}}Object(c.a)(ta,"PresenceDataManager",e.a,[]);var Wa=
a(52),Pa=a(1571);class ib{constructor(bc,cc,Vc,td,Xc,ne,Vd,Ja,Lb,fa,Na){this.clientId=bc;this.data=Vd;this.chatThreadId=cc;this.chatThreadDiscoveryUri=Vc;this.inChat=td;this.email=Xc;this.capabilities=ne;this.userName=Ja;this.clientType=Lb;this.fHasClientEverExperiencedNetworkLoss=fa;this.isAnonymous=Na}}Object(c.a)(ib,"SerializablePresenceInfo",null,[]);class Ib{constructor(bc,cc,Vc,td,Xc,ne,Vd,Ja,Lb,fa,Na){this.yNg=null;this.n1=bc.toLowerCase();this.GL=cc;this.xkk=Vc;this.edm=td;this.ddm=Xc;this.jfm=
ne;this.mod=Vd;this.adm=Ja;this.ZIa=Lb;this.shm=fa;this.eem=Na}eqj(){return new ib(this.n1,this.edm,this.ddm,this.jfm,this.mod,this.adm.capabilities,this.xkk?this.xkk.eqj():null,this.ZIa,this.shm,this.eem,x.AFrameworkApplication.RLb||x.AFrameworkApplication.WS)}yqn(bc){if(!(bc&&this.Pw.equals(bc.slideId)&&this.presence&&this.presence.OUa))return!1;for(const cc of this.presence.OUa)if(cc===bc.get_shapeId())return!0;return!1}get presence(){return this.xkk}get clientId(){return this.n1}get chatThreadId(){return this.edm}get chatThreadDiscoveryUri(){return this.ddm}get inChat(){return this.jfm}get email(){return this.mod}get capabilities(){return this.adm}get Pw(){return this.GL}get userName(){return this.ZIa}get clientType(){return this.shm}get fHasClientEverExperiencedNetworkLoss(){return this.eem}get presenceUser(){return this.yNg}set presenceUser(bc){this.yNg&&
(bc?!this.yNg.client||0===this.yNg.client||bc.client&&0!==bc.client||I.a.$(50942305,814,50,"PresenceEntry::SetPresenceUser; Specific to non-specific ClientType {0}.",this.n1):I.a.$(50942303,814,50,"PresenceEntry::SetPresenceUser; Non-null to null PresenceUser {0}.",this.n1));this.yNg=bc}static kIh(bc){if(!bc||!bc.clientId)return I.a.$(50942301,814,50,"PresenceEntry : CreateFromData; Invalid presence info"),null;const cc=Pa.a.kIh(bc.data);let Vc=0;bc.clientType&&8>=bc.clientType&&(Vc=bc.clientType);
return new Ib(bc.clientId,cc.Pw,cc,bc.chatThreadId,bc.chatThreadDiscoveryUri,bc.inChat,bc.email,new O.a(bc.capabilities),bc.userName,Vc,bc.fHasClientEverExperiencedNetworkLoss)}}Object(c.a)(Ib,"PresenceEntry",null,[]);class hc extends Sys.EventArgs{constructor(bc,cc,Vc,td,Xc,ne){super();this.GL=bc;this.zHn=Vc;this.vTh=cc;this.BOm=td;this.QGn=Xc;this.aGn=ne}get slideId(){return this.GL}get user(){return this.zHn}get shapes(){return this.vTh}get Bwa(){return this.BOm}get EAm(){return this.QGn}get Arm(){return this.aGn}}
Object(c.a)(hc,"SlidePresenceChangedEventArgs",Sys.EventArgs,[]);var yc=a(44);class ob extends e.a{constructor(bc,cc,Vc,td,Xc,ne,Vd,Ja,Lb,fa,Na,ha,sa,xa,pb,Rb,Fc,Kc,jb,zb,ic,bb,Pb,wc,Dc,ed,ad){super();this.VIa=new ta;this.lr=null;this.sdm=[];this.tdm=null;this.r_e=!0;this.Qje=!1;this.Wfm=new Date;this.wpd=null;this.jem=this.pEn=this.Qem=!1;this.JSh=null;this.pxb=bc;bc.userName||(bc.userName=wc);this.Jb=cc;this.U5=Vc;this.n1=td.clientId;this.Pka=td.TC;this.tg=Xc;this.kc=ic;this.GLg=zb;this.XYa=bb;
this.Q8a=ad;Pb.execute(Gd=>{this.lr=Gd});this.qtn();this.rq=sa;this.xs=xa;this.Rod=pb.S$l;this.lke=pb.Jab;this.cFn=pb.r2e;this.Mfm=x.AFrameworkApplication.Iz;this.Ffk=pb.li&&pb.lrd;this.sa=ne;this.sa.AO(Object(G.a)(this,this.tE,"onSelectionChanged"));this.xp=Vd;this.xp.RQl(Object(G.a)(this,this.RUn,"onValidShapeIdLoaded"));this.od=Ja;this.od.Hha(Object(G.a)(this,this.PPn,"onActiveSlideDOMReady"));this.Ofa=Lb;this.Ofa.sxf(Object(G.a)(this,this.AVh,"onEditorTableUpdate"));this.Nh=Rb;this.Nh.GF(Object(G.a)(this,
this.UJ,"onSessionEnd"));this.Nh.eI(Object(G.a)(this,this.qr,"onSessionRehydrated"));this.Nh.i2a(Object(G.a)(this,this.Xue,"onOutboundReplication"));this.ADn=pb.X2e;this.la=Na;this.ya=fa;this.LSh=ha;this.RQh=Fc;this.Yne=Kc;this.y_e=jb;pb.li&&(this.Nh.TFh(Object(G.a)(this,this.Z2c,"onSessionAccessTokenExpiring")),this.Nh.eKd(Object(G.a)(this,this.cJa,"onSessionAccessTokenExpired")),this.Nh.fKd(Object(G.a)(this,this.P1e,"onSessionExpired")),this.Jb.Wf(()=>{this.pxb.userName=this.Jb.appSettings.UserName;
this.pxb.email||(this.pxb.email=x.AFrameworkApplication.ha.Ma("UserPrincipalName"));this.kc.eQ||(I.a.$(512360717,814,50,"PresenceManager : Disconnect from RTC"),this.disconnect());this.Ffk&&this.Nh.Sva(Object(G.a)(this,this.tF,"onUnifiedAppStateChanged"))}),this.Mfm&&this.Nh.DTe(Object(G.a)(this,this.Nhb,"onWopiTokenRefreshed")));I.a.$(512360716,814,50,"PresenceManager - m_isWopiTokenRefreshEnabled:{0}",this.Mfm)}Kb(){this.la.ua(yc.a.wdc,Wa.a.application,Object(G.a)(this,this.wdc,"querySlidePresenceUsers"),
96)}wdc(bc,cc,Vc,td,Xc){Xc.bKe=this.$5f(Xc.slideId);Xc.KLk=this.fXe();return 32}$5f(bc){return(bc=this.B4l(bc))?bc.length:0}qtn(){this.U5.SJd(Object(G.a)(this,this.r2m,"connectionStateChanged"));this.U5.RFh(Object(G.a)(this,this.l1n,"presenceUpdated"));x.AFrameworkApplication.ha.getBooleanAppSetting("PPTForceUpdateEditorTableEnabled")&&this.U5.Myc(Object(G.a)(this,this.nmo,"updateNotificationReceived"));E.a.getInstance().WUm(Object(G.a)(this,this.Plm,"onGotCompletePersistentStateWithMetadata"));this.wpd=
this.Pka.Xl("WebServiceCall","RtcConnection");this.XYa.$Zl();this.U5.connect()}Wsm(){const bc=this.U5.XKh();this.zEm(new Ba.a(bc,null));this.Whh()}Plm(bc,cc){this.XYa.c_l(cc.m1n);E.a.getInstance().l6n(Object(G.a)(this,this.Plm,"onGotCompletePersistentStateWithMetadata"))}r2m(bc,cc){I.a.$(512360715,814,50,"PresenceManager : Connection State changed; oldState: {0}; newState: {1}; MyClientId: {2}",ob.rfj(cc.oldState),ob.rfj(cc.newState),this.n1);switch(cc.newState){case 2:this.wpd.stop();bc=this.wpd.ew;
this.XYa.ZZl();this.Wsm();this.GLg.Nsm(bc);break;case 1:2===cc.oldState&&this.GLg.M$g();this.GLg.OXh();break;case 0:this.r_e?this.Y0m():2===cc.oldState&&(window.setTimeout(()=>{this.U5.connect()},0),I.a.$(512360714,814,50,"PresenceManager : Reconnect rtc; Session time: {0}",this.tg.kXe().getTime()),this.GLg.M$g())}}getSelectedShapes(){if(!this.Rod)return null;const bc=[],cc=this.sa.zd();for(let Vc=0;Vc<cc.length;++Vc)Array.add(bc,cc[Vc].get_shapeId());0<bc.length&&bc.sort();return bc}Y0m(){var bc=
this.VIa.aYa();if(bc&&bc.length){bc=Array.clone(bc);for(const cc of bc)this.v4e(cc);this.raiseEvent("PresenceChanged")}}Y7k(bc,cc){try{this.pxb.email||(this.pxb.email=x.AFrameworkApplication.ha.Ma("UserPrincipalName"));const Vc=new Pa.a(bc,cc),td=new Ib(this.pxb.clientId,bc,Vc,this.pxb.chatThreadId,this.pxb.chatThreadDiscoveryUri,this.pxb.inChat,this.pxb.email,this.pxb.capabilities,this.pxb.userName,1,this.pEn);this.pxb.email||I.a.$(512360713,814,15,"PresenceManager : SendPresence; empty email for user");
this.U5.Y7k(td.eqj()).continueWith(()=>{I.a.$(8958538,814,50,"PresenceManager : SendPresence; Send presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.n1,Vc.toString(),this.tg.kXe().getTime())});this.Wfm=new Date;this.XYa.xbm();this.Z3n(bc,cc);I.a.$(8958540,814,50,"PresenceManager : SendPresence; Sending presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.n1,Vc.toString(),this.tg.kXe().getTime());this.c4n(Vc)}catch(Vc){I.a.$(512360712,814,10,"PresenceManager : SendPresence; Exception creating presence data {0}; MyClientId: {1};",
Vc.toString(),this.n1)}}l1n(bc,cc){bc=!!this.lr&&this.lr.XNa;I.a.$(8958544,814,50,"PresenceManager : PresenceUpdated; Received presence update; MyClientId: {0}, Rehydrating: {1} ",this.n1,bc);if(!bc){this.XYa.zbm(cc.e8e);bc=null;this.Pka&&(bc=this.Pka.Xl("ServerNotification","Presence Updated"));try{this.zEm(cc)}finally{bc&&bc.stop()}}}nmo(bc,cc){I.a.$(512360711,814,50,"PresenceManager : Update notification received; Type: {0}; MyClientId: {1}",cc.type,this.n1)}zEm(bc){this.cUm(bc.e8e);this.Qrd(bc.yYl);
I.a.$(8958546,814,50,"PresenceManager::UpdatePresenceCache; Refresh Peoples Well on presence update");this.raiseEvent("PresenceChanged")}Whh(){this.ya.Pw?this.Y7k(this.ya.Pw,this.getSelectedShapes()):I.a.$(512360708,814,50,"PresenceManager::SendCurrentSelection: m_graphTopologyManager.CurrentSlideId is null")}tE(){if(this.ya.Pw){var bc=this.getSelectedShapes();(ob.zqn(this.tdm,this.ya.Pw)||ob.ZDj(bc,this.sdm))&&this.Whh()}else I.a.$(512360707,814,50,"PresenceManager::OnSelectionChanged: m_graphTopologyManager.CurrentSlideId is null")}PPn(bc,
cc){cc.Ia?this.ya.Pw?this.Whh():I.a.$(512360705,814,50,"PresenceManager::OnActiveSlideDOMReady: m_graphTopologyManager.CurrentSlideId is null"):I.a.$(512360706,814,50,"PresenceManager::OnActiveSlideDOMReady: ActiveSlide is null")}RUn(bc,cc){this.ya.Pw?Array.contains(this.getSelectedShapes(),cc.shapeNode.get_shapeId())&&this.Whh():I.a.$(512360704,814,50,"PresenceManager::OnValidShapeIdLoaded: m_graphTopologyManager.CurrentSlideId is null")}mfo(bc,cc,Vc){cc=this.g2l(cc);bc=this.g2l(bc);this.tg.h2l().epc.raiseEvent(ob.$Rf,
new wa.a(this.rq.CR,null,cc,bc,null,0,0,Vc))}g2l(bc){const cc=new Map;for(let Vc=0;Vc<bc.length;Vc++){const td=bc[Vc];if(!td)continue;if(td.ID===this.rq.CR)continue;if(!td.EmailAddress){cc.set(td.ID,this.f2l(td));continue}const Xc=this.VIa.L1d(this.rq.CR);Xc&&Xc.email&&td.EmailAddress&&Xc.email.toUpperCase()===td.EmailAddress.toUpperCase()||cc.set(td.EmailAddress.toUpperCase(),this.f2l(td))}return[...cc.values()]}f2l(bc){const cc=new pa.a;cc.EmailAddress=bc.EmailAddress;cc.Id=bc.ID;cc.Name=bc.Name;
return cc}AVh(bc,cc){this.mfo(cc.D1j,cc.Jyi,cc.L9l);if(bc=this.rq.B$){var Vc=cc.D1j;for(var td=0;td<Vc.length;td++)this.RQh.cho(Vc[td].ID);Vc=[];cc=cc.Jyi;for(td=0;td<cc.length;td++){const ne=cc[td],Vd=ne.ID;if(Vd!==this.rq.CR){const Ja=this.VIa.L1d(Vd);Ja?this.y_e.PCi(Ja.email,ne.EmailAddress):Array.add(Vc,Vd)}}this.RQh.oTm(Vc);2<=bc.length&&I.a.$(512360674,814,50,"PresenceManager : EditorTable has atleast 2 coauthors; MyClientID: {0}; EditorTableCount: {1}",this.n1,bc.length);Vc=[];cc=[];for(var Xc of bc)Array.add(Vc,
Xc.ID),Xc.ID===this.rq.CR||this.VIa.L1d(Xc.ID)||Array.add(cc,Xc.ID);I.a.$(512360673,814,50,"PresenceManager : OnEditorTableUpdate; Received Editor Table update; MyClientID: {0}; editorTableCount: {1}; ClientIDs : {2}; ClientIDs with missing presence: {3}",this.n1,bc.length,Vc.join(","),cc.join(","));for(const ne of this.VIa.aYa())({editor:Xc}=this.rq.Idd(ne.clientId)).returnValue?(this.b4n(ne),bc=this.Yne.z5a(new Ma.a(Xc.EmailAddress,void 0,Xc.Name),Xc.ID,0),ne.presenceUser=new u.a(ne.clientId,Xc.Name,
bc,new O.a(1),null,null,ne.clientType),this.LSh.e$g(new hc(ne.Pw,ne.presence.OUa,ne.presenceUser,!0,this.$5f(ne.Pw),this.fXe())),I.a.$(512360671,814,50,"PresenceManager : OnEditorTableUpdate; Adding/Updating presence UI; ClientId: {0};  Presence: {1}; Color: {2}; MyClientId: {3};",ne.clientId,ne.presence.toString(),ne.presenceUser.color,this.n1)):I.a.$(512360670,814,50,"PresenceManager : OnEditorTableUpdate; Client not in Editor table; ClientId: {0};  Presence: {1}: Color: {2}; MyClientId: {3};",
ne.clientId,ne.presence.toString(),ne.presenceUser?ne.presenceUser.color:"",this.n1);this.raiseEvent("PresenceChanged")}else I.a.$(512360675,814,50,"PresenceManager : OnEditorTableUpdate; Received null on Editor Table update; MyClientID: {0};",this.n1)}UJ(bc,cc){this.RQh.aho();5!==cc.nJ&&(I.a.$(512360669,814,50,"PresenceManager : OnSessionEnd - Disconnect from RTC"),this.disconnect())}Z2c(){I.a.$(512360668,814,50,"PresenceManager : OnSessionAccessTokenExpiring");this.Qje||(I.a.$(512360667,814,50,
"PresenceManager : OnSessionAccessTokenExpiring; Access token expired"),this.Qje=!0)}cJa(){I.a.$(512360666,814,50,"PresenceManager : OnSessionAccessTokenExpired; Disconnecting from RTC");this.Qje||(I.a.$(512360665,814,50,"PresenceManager : OnSessionAccessTokenExpired; Access token expired"),this.Qje=!0)}P1e(){I.a.$(512360664,814,50,"PresenceManager : OnSessionExpired - Disconnect from RTC");this.disconnect()}Nhb(bc,cc){I.a.$(512360663,814,50,"PresenceManager : OnWopiTokenRefreshed");try{cc.Okg?(I.a.$(512360662,
814,50,"PresenceManager::OnWopiTokenRefreshed Token refresh succeeded. - RTC Connection State: {0}",ob.rfj(this.U5.connectionState)),this.Qje=!1,this.Ffk&&!this.kc.eQ?I.a.$(512360661,814,15,"PresenceManager : OnWopiTokenRefreshed; Do not connect to RTC in readonly mode"):this.r_e||2!==this.U5.connectionState?this.connect():(bc={},bc.qs=this.Q8a.ei.string,I.a.$(512360660,814,50,"PresenceManager : OnWopiTokenRefreshed; Calling UpdateClientInfo"),this.U5.Utd(bc))):I.a.$(512360659,814,15,"PresenceManager::OnWopiTokenRefreshed Token refresh failed.")}catch(Vc){I.a.$(512360658,
814,10,"PresenceManager::OnWopiTokenRefreshed Exception: {0}",Vc)}}qr(bc,cc){this.cFn&&this.Qje||this.Ffk&&!this.kc.eQ?I.a.$(512360657,814,50,"PresenceManager : OnSessionRehydrated; Do not connect to RTC; IsAccessTokenExpired={0}; IsInEditingModeOrCanEditAnyway={1};",this.Qje,this.kc.eQ):4!==cc.boc||this.r_e?this.connect():(I.a.$(512360656,814,50,"PresenceManager : OnSessionRehydrated - catch up presence"),this.Wsm())}tF(bc,cc){cc.eZe&&!this.kc.eQ&&(I.a.$(512360655,814,50,"PresenceManager : OnUnifiedAppStateChanged; Change to readonly, disconnect from RTC"),
this.disconnect())}connect(){I.a.$(512360654,814,50,"PresenceManager : Connect");this.r_e=!1;this.U5.connect()}Xue(){this.qdo()&&(I.a.$(512360653,814,50,"PresenceManager : OnOutboundReplication; Send presence update for editing actions"),this.Whh())}qdo(){const bc=this.U5.bjn();return bc?2===bc.status||+new Date-+this.Wfm>this.ADn?!0:!1:!1}u$l(){const bc=this.VIa.aYa();if(0<bc.length)for(const cc of bc)if(cc.presence&&cc.presence.Pw)return!0;return!1}gdo(){return!this.Qem&&this.lke&&2!==this.rq.Xma}cUm(bc){for(const Vc in bc){var cc=
bc[Vc];try{const td=Ib.kIh(cc);if(!td||td.clientId===this.n1)continue;const Xc=td.clientId;this.gdo()&&(this.Qem=!0,this.xs.spc(2),I.a.$(512360652,814,50,"PresenceManager : Update coauth status to Coauthoring from RTC"));I.a.$(39326610,814,50,"PresenceManager : AddOrUpdatePresence; ClientId: {0}; NewPresence: {1};",Xc,td.presence.toString());const ne=td.email;if(!this.y_e.sLh(ne)){let Vd;({editor:Vd}=this.rq.Idd(Xc)).returnValue&&this.y_e.PCi(ne,Vd.EmailAddress)}this.eUm(td);this.XYa.YZl()}catch(td){I.a.$(512360651,
814,10,"PresenceManager : AddOrUpdatePresence; Invalid Presence Data Received {0}; MyClientId: {1};",td.toString(),this.n1)}}this.XYa.ybm(bc)}eUm(bc){this.f$m(bc);const cc=this.U5.A5a(bc.clientId);cc&&2===cc.status?I.a.$(39326613,814,50,"PresenceManager : AddOrUpdatePresenceWithAwayStatus; Do not add presence for inactive user; ClientId: {0};",bc.clientId):this.dUm(bc)}dUm(bc){const cc=this.VIa.L1d(bc.clientId);if(cc){if(!this.vqn(cc,bc))return;I.a.$(8958560,814,50,"PresenceManager : AddOrUpdatePresence; Updating existing presence; ClientId: {0};  ExistingPresence: {1}; NewPresence: {2}; MyClientId: {3};",
bc.clientId,cc.presence.toString(),bc.presence.toString(),this.n1);this.v4e(cc)}this.jUm(bc)}v4e(bc){bc&&(this.VIa.v4e(bc),bc.presenceUser&&this.LSh.e$g(new hc(bc.Pw,bc.presence.OUa,bc.presenceUser,!1,this.$5f(bc.Pw),this.fXe())))}g_l(bc){if(bc)if(bc.presenceUser)I.a.$(512360649,814,100,"PresenceManager:AddOrUpdatePresence; PresenceUser already created for ClientId{0};",bc.clientId);else{const cc=this.U3l(bc.clientId);cc?bc.presenceUser=cc:I.a.$(512360650,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",
bc.clientId)}}jUm(bc){bc&&(this.VIa.KSb(bc),this.RQh.bho(bc.clientId),this.g_l(bc),bc.presenceUser?this.LSh.e$g(new hc(bc.Pw,bc.presence.OUa,bc.presenceUser,!0,this.$5f(bc.Pw),this.fXe())):I.a.$(512360648,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",bc.clientId))}vqn(bc,cc){let Vc;(Vc=!bc.Pw.equals(cc.Pw))&&I.a.$(512360647,814,50,"Slide Presence Changed - CurrentSlide: {0} ; NewSlide: {1}",bc.Pw,cc.Pw);(bc=this.Rod&&ob.Dco(bc,cc))&&I.a.$(512360646,814,50,"Shape Presence Changed");
return Vc||bc}Qrd(bc){if(bc){for(let cc=0;cc<bc.length;cc++)bc[cc]=bc[cc].toLowerCase();for(const cc of bc)I.a.$(512360645,814,50,"PresenceManager : RemovePresence; Removing presence for disconnected clients; ClientId: {0}",cc),(bc=this.VIa.gYh(cc))?bc.presenceUser?this.LSh.e$g(new hc(bc.Pw,bc.presence.OUa,bc.presenceUser,!1,this.$5f(bc.Pw),this.fXe())):I.a.$(512360643,814,15,"PresenceManager : RemovePresence; entry.PresenceUser is null"):I.a.$(512360644,814,15,"PresenceManager : RemovePresence; entry did not exist")}}B4l(bc){const cc=
[];for(const Vc of this.VIa.aYa())Vc.Pw.equals(bc)&&Vc.presenceUser&&Array.add(cc,Vc.presenceUser);return cc}Bqj(bc){const cc=[];for(const Vc of this.VIa.aYa())Vc.presence&&Vc.yqn(bc)&&Vc.presenceUser&&Array.add(cc,Vc.presenceUser);return cc}dld(){const bc=[];for(const cc of this.VIa.aYa())cc.presenceUser&&Array.add(bc,cc.presenceUser);return bc}fXe(){const bc=this.dld();return bc?bc.length:0}PZb(bc){if(!bc)return null;bc=bc.toLocaleLowerCase();for(const cc of this.VIa.aYa())if(cc.presenceUser&&cc.presenceUser.clientId===
bc)return cc.presenceUser;return this.U3l(bc)}gYh(bc){const cc=this.VIa.L1d(bc);this.v4e(cc);I.a.$(512360641,814,50,"PresenceManager : RemoveUserPresence; Removing presence; ClientId: {0};  MyClientId: {1};",cc?cc.clientId:bc+" not found",this.n1)}BVm(bc){this.addHandler("PresenceChanged",bc)}aYa(){return this.VIa.aYa()}connectionState(){return this.U5.connectionState}disconnect(){try{I.a.$(512360640,814,50,"PresenceManager : Disconnect"),this.r_e||this.GLg.$3n(),this.r_e=!0,this.U5.disconnect()}catch(bc){I.a.$(512360611,
814,10,"PresenceManager : Disconnect; Exception disconnecting rtc; Message: {0}; Callstack: {1}",bc.message,bc.stack)}}Z3n(bc,cc){this.tdm=bc;this.sdm=cc}U3l(bc){let cc;const Vc=({editor:cc}=this.rq.Idd(bc)).returnValue;var td=this.U5.y_b(bc),Xc=!!td;if(!Vc&&!Xc)return I.a.$(512360610,814,50,"PresenceUser:GetPresenceUser; ClientId {0} neither in presence nor rtc.",bc),null;td=Xc?td:null;Vc||I.a.$(512360609,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in EditorTable",bc);Xc||I.a.$(512360608,
814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in Presence",bc);Xc&&Vc&&I.a.$(512360607,814,50,"PresenceUser:GetPresenceUser; ClientId {0} in both. IsSameID={1}, IsSameEmail={2}.",bc,td.clientId!==cc.ID,td.email!==cc.EmailAddress);var ne=Vc?new Ma.a(cc.EmailAddress,void 0,cc.Name):new Ma.a(this.y_e.sLh(td.email)||td.email,void 0,td.userName);ne=this.Yne.z5a(ne,Vc?cc.ID:td.clientId,0);Xc=Xc?td.clientType:0;return new u.a(bc,Vc?cc.Name:td.userName,ne,new O.a(1),null,null,Xc)}b4n(bc){this.ya.Pw.equals(bc.Pw)&&
bc.presence.OUa&&bc.presence.OUa.length&&I.a.$(512360606,814,50,"PresenceManager : {0}; Begin to add shape presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}","OnEditorTableUpdate",bc.clientId,bc.presence.toString(),this.n1,this.tg.kXe().getTime());I.a.$(512360605,814,50,"PresenceManager : {0}; Begin to add slide presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}","OnEditorTableUpdate",bc.clientId,bc.presence.toString(),this.n1,this.tg.kXe().getTime())}c4n(bc){const cc=
[this.rq.userName];let Vc=0;for(var td of this.VIa.aYa())td.presence.Pw.equals(bc.Pw)&&!ob.ZDj(td.presence.OUa,bc.OUa)&&(Vc++,td.presenceUser&&Array.add(cc,td.presenceUser.userName));if(0<Vc){td={};let Xc=0,ne=0;for(let Vd=0;Vd<cc.length;++Vd){let Ja=cc[Vd];Ja&&Ja.length||(Ja="anonymous",ne++);Ja in td||(td[Ja]=!0,Xc++)}I.a.$(512360604,814,50,"PresenceManager : {0} users, {2} unique users are selecting same {1}. {3} users have no identity",Vc+1,bc.OUa&&0<bc.OUa.length?"shape":"slide",Xc,ne)}}f$m(bc){try{this.XYa.$_l()&&
!this.VIa.L1d(bc.clientId)&&(this.g_l(bc),this.g$m(bc.presenceUser))}catch(cc){I.a.$(512360603,814,15,"PresenceManager:EndPresenceBootTelemetry; Exception {0};",cc.toString())}}g$m(bc){bc&&bc.clientId&&(this.jem||this.JSh||(this.jem=!0,this.JSh=r.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry")),this.JSh&&this.JSh.h$m(bc.clientId,ob.Ikn(bc)))}static rfj(bc){let cc="";switch(bc){case 2:cc="Connected";break;case 1:cc="Connecting";break;case 0:cc="Disconnected"}return cc}static ZDj(bc,
cc){if(!bc&&!cc)return!1;if(!bc&&cc||bc&&!cc||bc.length!==cc.length)return!0;for(let Vc=0;Vc<bc.length;Vc++)if(bc[Vc]!==cc[Vc])return!0;return!1}static zqn(bc,cc){return!la.a.FZa(bc,cc)}static Dco(bc,cc){return bc.Pw.equals(cc.Pw)&&ob.ZDj(bc.presence.OUa,cc.presence.OUa)}static Ikn(bc){return bc&&1===bc.client?1:0}}ob.$Rf="ETU";Object(c.a)(ob,"PresenceManager",e.a,[1175,1176,1177,1178]);var Bc=a(1827),rb=a(1830),Eb=a(1643),jc=a(109),ea=a(67),ua=a(396);class Da{constructor(bc,cc,Vc,td,Xc){this.wU=
null;this.O5=x.AFrameworkApplication.ha.getBooleanAppSetting(ya.a.mBb);cc=this.ckn(cc,td,Xc);this.wU=this.O5?(new Bc.a(cc)).YKf(bc):(new rb.a(cc)).jIh(bc,Vc)}dispose(){this.wU.dispose()}ILk(){return ea.a.ji(document.getElementById(ua.a.LHb))}ckn(bc,cc,Vc){const td=new Eb.a;td.add(0,jc.e(x.AFrameworkApplication.IJ,"MoreUsersGlyph_16x16x32"));td.add(5,x.AFrameworkApplication.Ln);td.add(1,jc.e(x.AFrameworkApplication.IJ,this.O5?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph_16x16x32"));td.add(4,
x.AFrameworkApplication.Ln);td.add(6,Vc);td.add(8,x.AFrameworkApplication.isRtl);td.add(12,bc);td.add(11,cc);this.O5&&(td.add(16,Object(G.a)(this,this.ILk,"presenceViewportBoundsCallback")),td.add(17,!0));return td}z2(bc){this.wU?(I.a.$(8958619,814,50,"PresencePawn:AddUser at PresencePawn for ClientId {0}",bc.clientId),this.wU.z2(bc)):I.a.$(509219530,814,10,"PresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {0}",bc.clientId)}rua(bc){this.wU?(I.a.$(509219528,814,50,"PresencePawn:RemoveUser at PresencePawn for ClientId {0}",
bc.clientId),this.wU.rua(bc.clientId)):I.a.$(509219529,814,15,"PresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser for ClientId {0}",bc.clientId)}clear(){if(this.wU)if(I.a.$(509219526,814,50,"PresencePawn:Clear at PresencePawn "),this.hYa())for(const bc of this.hYa())this.rua(bc);else I.a.$(509219525,814,50,"PresencePawn:Clear - Pawn has no users");else I.a.$(509219527,814,15,"PresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}hYa(){return this.wU?this.wU.E3e:
null}cAm(){this.wU&&(this.O5&&this.wU.ALb(),this.wU.Soc())}X6l(){this.wU&&this.wU.ALb()}}Object(c.a)(Da,"PresencePawn",null,[599,40]);class Cb{eXl(bc,cc,Vc){return new Da(bc,2,cc,!0,Vc)}}Object(c.a)(Cb,"PresencePawnFactory",null,[1161]);var Nb=a(1263),fc=a(45);class fb{constructor(bc,cc,Vc,td,Xc,ne,Vd,Ja,Lb,fa,Na){this.Kik=[];this.opd=null;this.Dem=this.Cem=this.yck=0;this.ERh=this.FRh=null;this.BSh=[];if(!cc)throw Error.argumentNull("graphTopologyManager");if(!Vc)throw Error.argumentNull("presenceManager");
if(!td)throw Error.argumentNull("dragInputManager");if(!Xc)throw Error.argumentNull("coauthStateChangesHandler");this.od=bc;this.ya=cc;this.qT=Vc;this.Zx=td;this.Qrg=Xc;this.e8b=ne;this.Xb=Vd;this.Ee=Ja;this.Cpd=Lb;this.d8b=fa;this.Sfa=Na;this.d8b.Vjc(Object(G.a)(this,this.$_h,"slidePresenceChanged"));this.od.Hha(Object(G.a)(this,this.jFa,"onSlideNavigation"));this.od.Vxf(Object(G.a)(this,this.Lhb,"onThumbnailRefresh"));this.od.YSb(Object(G.a)(this,this.A1g,"onThumbnailVisibleRangeChanged"));this.vfm=
x.AFrameworkApplication.ha.getBooleanAppSetting(ya.a.I5g);(this.O5=x.AFrameworkApplication.ha.getBooleanAppSetting(ya.a.mBb))&&this.vfm&&(this.Cem=x.AFrameworkApplication.ha.Ac("PPTCanvasPresenceFloodGateSurveyTimeLapseSec",30),this.Dem=x.AFrameworkApplication.ha.Ac("PPTCanvasPresenceFloodGateSurveyTriggerThreshold",3),this.yck=0,this.opd=v.a.kH(r.a.instance.eb("Common.ISystemInitiatedFeedbackWithTimeLapse")));this.od.iid(Object(G.a)(this,this.Lco,"shapeViewElementAdded"));this.od.mui(Object(G.a)(this,
this.Mco,"shapeViewElementLocked"));this.od.hQl(Object(G.a)(this,this.hUn,"onShapeViewElementShowLockHint"));this.od.iQl(Object(G.a)(this,this.iUn,"onShapeViewElementShowPresenceHint"));this.od.fQl(Object(G.a)(this,this.cUn,"onShapeViewElementHidePresenceHint"))}jFa(){this.ya.Pw&&(I.a.$(512263071,814,50,"PresencePresenter::OnSlideNavigation; refreshing shape presence for slideId: {0}",this.ya.Pw),this.y4n(this.ya.Pw))}y4n(bc){if(this.ya.Pw&&this.ya.Pw.equals(bc)&&(I.a.$(512263070,814,50,"PresencePresenter::RefreshShapePresenceOnSlide refreshing presence for slideId: {0}",
bc),bc=new fc.GraphIterator,bc.set(this.ya.Ia),bc.Fb(1))){do if(0<bc.currentNode.jb(X.a.shapeId)){const cc=Object(U.a)(351,bc.currentNode);cc&&this.btm(cc)}while(bc.Df(1))}}$_h(bc,cc){this.Zx.XPa?(I.a.$(512263069,814,50,"PresencePresenter:SlidePresenceChanged - DragInputManager active."),this.ERh||(this.ERh=new h.a(2,1,0,()=>{this.handlePendingPresenceChangedEvent(cc)},90,"68"),x.AFrameworkApplication.Zd.Rb(this.ERh)),cc&&this.BSh.push(cc)):(this.Q1n(cc),this.P1n(cc))}handlePendingPresenceChangedEvent(){this.ERh=
null;this.x4n();if(this.ya.Pw&&0<this.BSh.length){const Vc={},td={};var bc=this.ya.Pw;for(var cc of this.BSh){if(!bc.equals(cc.slideId))continue;if(!cc.shapes||!cc.user)continue;cc.user.clientId in td||(Vc[cc.user.clientId]=cc.user,td[cc.user.clientId]=new Nb.a(0));const Xc=td[cc.user.clientId];for(const ne of cc.shapes){const Vd=cc.Bwa?1:0;Xc.Sb(ne)?0<(Xc.ka(ne)^Vd)&&Xc.fa(ne,Vd):Xc.add(ne,Vd)}}for(const Xc in Vc){bc=Vc[Xc];cc=Xc;if(!(cc in td))continue;const ne=[],Vd=[];td[cc].forEach((Ja,Lb)=>
{0<Lb?Vd.push(Ja):ne.push(Ja);return!0});0<ne.length&&this.Ntm(ne,bc);0<Vd.length&&this.sPl(Vd,bc)}this.BSh=[]}}Q1n(bc){bc.Bwa?this.KSb(bc.slideId,bc.user):this.Qrd(bc.slideId,bc.user)}Lhb(bc,cc){this.atm([cc.hsl])}A1g(bc,cc){this.atm(cc.tga)}atm(bc){const cc=[];for(const Vc of bc)bc=this.Sfa?this.Xb.oXe(Vc):this.Xb.agb(Vc),this.Sfa&&0>=bc.L1||bc&&Array.add(cc,bc);this.$sm(cc)}KSb(bc,cc){const Vc=this.a5l(bc);Vc?(Vc.KSb(cc),this.S3j(),I.a.$(512263067,814,50,"ThumbnailNavigationPaneView : Add slide presence succeeded. slideId  = {0}",
bc.toString())):I.a.$(21770506,814,50,"ThumbnailNavigationPaneView : AddPresence - slideId is invalid {0}",bc.toString())}Qrd(bc,cc){const Vc=this.a5l(bc);Vc?Vc.Qrd(cc):I.a.$(512263066,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",bc.toString())}a5l(bc){const cc=this.Xb.agb(bc);return cc?Object(U.a)(653,cc.Vg(this.Cpd)):(I.a.$(512263065,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",bc.toString()),null)}x4n(){const bc=this.ya.presentation;
if(!bc)throw Error.argumentNull("Presentation is null");this.$sm(bc.slides||[])}$sm(bc){for(const Vc of bc){var cc=Object(U.a)(22,Vc);cc?(bc=cc.fc,(cc=Object(U.a)(653,cc.Vg(this.Cpd)))?(I.a.$(512263062,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - updating presence for {0}",bc.toString()),cc.Xtd(this.qT.B4l(bc))):I.a.$(512263063,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - thumbnailViewElement is null for slide {0}",bc.toString())):I.a.$(512263064,
814,10,"ThumbnailNavigationPaneView : RefreshPresenceForThumbnails - could not cast slide to ISlideNode while updating presence for {0}",Vc.fc.toString())}}S3j(){this.O5&&this.vfm&&(this.jko()||this.opd&&this.opd.continueWith(()=>{this.opd.result.logActivity("PresenceBubbleRendered",ya.a.I5g,this.Cem)&&this.yck++}))}jko(){return this.yck>=this.Dem}P1n(bc){this.ya.Pw&&this.ya.Pw.equals(bc.slideId)&&bc.shapes&&(bc.Bwa?this.sPl(bc.shapes,bc.user):this.Ntm(bc.shapes,bc.user))}Lco(bc,cc){bc=cc.pJ;this.R$l(bc.shapeNode)&&
(this.Kik.push(bc),this.FRh||(this.FRh=new h.a(2,1,0,Object(G.a)(this,this.handlePendingShapePresenceUpdate,"handlePendingShapePresenceUpdate"),90,"69"),x.AFrameworkApplication.Zd.Rb(this.FRh)))}handlePendingShapePresenceUpdate(){this.FRh=null;for(const bc of this.Kik){if(!this.R$l(bc.shapeNode))return;this.btm(bc.shapeNode)}Array.clear(this.Kik)}btm(bc){const cc=Object(U.a)(112,bc.yc(this.Ee));if(cc&&!bc.get_smartArtModelId()){var Vc=this.qT.Bqj(bc);if(Vc)if(Vc.length){bc=this.e8b.fca(bc);bc.uUl();
for(const td of Vc)bc.KSb(td),this.S3j()}else(Vc=this.e8b.J7(bc))&&Vc.uUl();this.Qrg.Ynm(cc)}}sPl(bc,cc){var Vc=this.v4l();let td=!1;for(const Xc of Vc){if(!Array.contains(bc,Xc.get_shapeId())||Xc.get_smartArtModelId())continue;Vc=Object(U.a)(112,Xc.yc(this.Ee));if(!Vc||Xc.get_smartArtModelId())continue;const ne=this.e8b.fca(Xc);ne?(Vc.isSelected&&(ne.mUe=!1),ne.KSb(cc),this.S3j(),Vc.isSelected&&ne.eWg()):td=!0}td||I.a.$(512263060,814,50,"PresencePresenter::AddShapePresence succeeded")}Ntm(bc,cc){var Vc=
this.v4l();for(const td of Vc)Array.contains(bc,td.get_shapeId())&&(Vc=this.e8b.fca(td))&&Vc.Qrd(cc)}v4l(){let bc=null;this.ya.Ia&&(bc=this.ya.Ia.Nj());return bc||[]}R$l(bc){return!!this.ya.Ia&&this.ya.Ia.fc.equals(bc.slideId)}Mco(bc,cc){this.e8b.fca(cc.pJ.shapeNode).h2h(cc.presenceUser)}hUn(bc,cc){(cc.pJ.isLocked||cc.pJ.h6e)&&(bc=this.e8b.J7(cc.pJ.shapeNode))&&bc.Yil()}iUn(bc,cc){(bc=this.e8b.J7(cc.pJ.shapeNode))&&bc.Wdo()}cUn(bc,cc){(bc=this.e8b.J7(cc.pJ.shapeNode))&&bc.d0b()}}Object(c.a)(fb,"PresencePresenter",
null,[]);class Ub{constructor(bc){this.bOg=bc}y_b(bc){return this.bOg.y_b(bc)}A5a(bc){return this.bOg.A5a(bc)}}Object(c.a)(Ub,"PresenceUserInfoGetter",null,[1163,1151]);class Ec{constructor(bc=null){this.rq=bc}V3l(bc){if(!bc||!bc.value)return null;bc=bc.value;let cc=bc.userName;if(!cc&&this.rq){let Vc;({editor:Vc}=this.rq.Idd(bc.clientId)).returnValue&&(cc=Vc.Name)}return Object.assign(new u.a,{clientId:bc.clientId,chatThreadId:bc.chatThreadId,chatThreadDiscoveryUri:bc.chatThreadDiscoveryUri,inChat:bc.inChat,
email:bc.email,capabilities:new O.a(bc.capabilities),userName:cc})}}Object(c.a)(Ec,"PresenceUtils",null,[1174]);var Lc;(function(bc){bc[bc.coauthHandlerResponse=0]="coauthHandlerResponse";bc[bc.popSessionResponse=1]="popSessionResponse";bc[bc.defaultFallback=2]="defaultFallback"})(Lc||(Lc={}));Object(c.b)("RtcDiscoverType",Lc);class vb{constructor(bc,cc,Vc,td,Xc,ne,Vd,Ja,Lb,fa,Na,ha,sa,xa,pb,Rb){this.$Zi=bc;this.tph=cc;this.sph=Vc;this.rUd=td;this.eYe=Xc;this.Gbg=ne;this.Mtd=Vd;this.Zvh=Ja;this.Mrd=
Lb;this.GPf=fa;this.EPf=Na;this.LLe=ha;this.Mpd=sa;this.USd=xa;this.JZl=pb;this.J2i=Rb}BCn(){return String.format("[DRL-{0},SEND-{1},SELE-{2},EELE-{3},IUI-{4},IULE-{5},TUI-{6},TULE-{7},RELI-{8},DTL-{9},DEL-{10}, STF-{11}, MLD-{12}, DTL-{13}, ETR-{14}, ETCL-{15}]",this.$Zi,this.tph,this.sph,this.rUd,this.eYe,this.Gbg,this.Mtd,this.Zvh,this.Mrd,this.GPf,this.EPf,this.LLe,this.Mpd,this.USd,this.JZl,this.J2i)}}Object(c.a)(vb,"RttLockSettings",null,[]);var ec=a(297);class lb{constructor(bc,cc,Vc,td){this.nDg=
this.mDg=null;this.oLl=!1;this.YGn=bc;this.La=cc;this.Rj=Vc;this.$Ya=td;this.X0e=new Date;this.uWc=-1}get mb(){return this.YGn}get nPh(){return this.oLl}set nPh(bc){this.oLl=bc}zan(){return 0<this.uWc&&Date.now()>=this.uWc}vym(bc){this.uWc=bc}M6f(){return""}N6f(){return""}k4e(bc){this.mDg=bc?this.M6f():this.N6f();this.nDg=new Date}PIi(){}cJi(){return!1}twm(bc,cc){bc=bc||"";cc=cc||"";if(bc.length!==cc.length)return null;const Vc=[];for(let td=0;td<bc.length;td+=1)bc.charAt(td)!==cc.charAt(td)&&Vc.push(td);
return 0<Vc.length?ub.a.oO("Length",bc.length,"FirstDiffPos",Vc[0],"DiffCount",Vc.length):null}Jld(bc){return Q.a.replaceAll(bc,"\u00a0"," ").trim()}}Object(c.a)(lb,"ATextContentRecord",null,[]);var Zb=a(15),qc=a(55);class pc extends lb{constructor(bc,cc,Vc,td){super(bc,cc,Vc,td);this.Mim=bc.LA}get shapeNode(){return Object(U.a)(351,this.mb)}oco(){this.Mim=this.shapeNode.LA}M6f(){const bc=new d.a;var cc=this.shapeNode.HJ();for(const Vc of cc)(cc=this.Rj.text(Vc))&&0<cc.length&&bc.add(cc);return bc.toArray().join(" ")}N6f(){return this.La.MV(this.shapeNode)}PIi(){try{const bc=
this.M6f()||"",cc=this.mDg||"";if(bc!==cc){const Vc=this.Jld(bc)===this.Jld(cc),td=this.Mim||this.shapeNode.LA;if(!Vc&&!td&&!this.shapeNode.gd){const Xc=ub.a.oO("Shape",this.shapeNode.om,"Start",qc.a.Pf(this.X0e),"LastSnapshotTime",qc.a.Pf(this.nDg),"EverEdit",this.nPh,"Type",this.getShapeType());Xc.Expiration=-1<this.uWc?(+new Date(this.uWc)-+this.X0e).toString():null;const ne=bc.length-cc.length;ne?Xc.TextLengthDelta=ne:Xc.SameLengthDiffDetails=this.twm(bc,cc);I.a.$(25539747,814,15,Zb.c(Xc))}}}catch(bc){I.a.$(25981901,
814,10,"ShapeContentRecord:CheckTextContent failed. {0}",bc)}}cJi(){try{const bc=this.$Ya.J0f(this.shapeNode);if(bc&&0<bc.length)return!1;const cc=this.N6f()||"",Vc=this.mDg||"";if(cc!==Vc&&0>cc.indexOf(Vc)&&!(0<=this.Jld(cc).indexOf(this.Jld(Vc))||this.shapeNode.gd)){const td=ub.a.oO("Shape",this.shapeNode.om,"Start",qc.a.Pf(this.X0e),"LastSnapshotTime",qc.a.Pf(this.nDg),"TextLengthDelta",cc.length-Vc.length,"Type",this.getShapeType());I.a.$(25981903,814,15,Zb.c(td))}}catch(bc){I.a.$(25981905,814,
10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",bc)}return!0}getShapeType(){return this.shapeNode.gd?"Table":this.shapeNode.xg?"SmartArt":this.shapeNode.yr?"TextBox":this.shapeNode.Bl?"PlaceHolder":this.shapeNode.Gwa?"Shape":"Unknown"}}Object(c.a)(pc,"ShapeContentRecord",lb,[]);class ac{constructor(bc,cc,Vc,td,Xc,ne,Vd,Ja,Lb,fa,Na,ha,sa){this.Ope=this.Z0e=null;this.LEa={};this.l_c={};this.sa=Ja;this.Ofa=Lb;this.ud=bc;this.VB=cc;this.FEn=Vc;this.QA=td;this.ya=Xc;this.nh=ne;this.$Ya=Vd;this.La=
fa;this.Fc=Na;this.$nk=ha;this.zR=sa;this.sa.yTe(Object(G.a)(this,this.n0g,"onPreSelectionChanged"));this.sa.AO(Object(G.a)(this,this.lKb,"onSetSelectionFinished"));this.Ofa.KQl(Object(G.a)(this,this.DUn,"onTableCellViewElementLocked"));this.ud.EPl(Object(G.a)(this,this.oYm,"beforeProcessInboundResponse"));this.VB.Ujc(Object(G.a)(this,this.fUn,"onShapeViewElementOpenTextEditView"));this.VB.jid(Object(G.a)(this,this.bUn,"onShapeViewElementCloseTextEditView"));this.VB.mui(Object(G.a)(this,this.eUn,
"onShapeViewElementLocked"));this.FEn.$Jd(Object(G.a)(this,this.CUn,"onSuccessfulInbound"));this.QA.Rm(Object(G.a)(this,this.Qh,"onPropertyChanged"));this.nh.cU(Object(G.a)(this,this.zT,"onActiveSlideChanged"))}fUn(bc,cc){bc=Object(U.a)(351,Object(U.a)(ec.a,cc.pJ).mb);cc=this.$nk.dVi(bc);this.LEa[bc.id.toString()]=cc;cc.k4e(!0)}bUn(bc,cc){bc=Object(U.a)(351,Object(U.a)(ec.a,cc.pJ).mb).id.toString();bc in this.LEa&&this.LEa[bc].vym(Date.now()+this.zR.rUd)}eUn(bc,cc){bc=Object(U.a)(351,Object(U.a)(ec.a,
cc.pJ).mb).id.toString();bc in this.LEa&&delete this.LEa[bc]}n0g(){this.Z0e=this.kXl}lKb(){this.Ope=this.kXl;if(!(!this.Z0e&&!this.Ope||this.Z0e&&this.Ope&&this.Ope.id.equals(this.Z0e.id))){if(this.Z0e){var bc=this.Z0e.id.toString();bc in this.LEa&&this.LEa[bc].vym(Date.now()+this.zR.rUd)}this.Ope&&(bc=this.$nk.dVi(this.Ope),this.LEa[this.Ope.id.toString()]=bc,bc.k4e(!0))}}get kXl(){var bc=this.sa.Wa;if(!bc||!bc.qb||bc.qb.Fk)return null;bc=bc.qb;return bc.Ya.node&&bc.Ya.node.isConnected?this.Fc.vIa(bc.Ya.node):
null}DUn(bc,cc){bc=cc.tableCellNode.id.toString();bc in this.LEa&&delete this.LEa[bc]}oYm(){this.Ftm();for(const bc of Object.keys(this.LEa))this.LEa[bc].k4e(!0)}CUn(){this.Ftm();for(const bc of Object.keys(this.LEa))this.LEa[bc].PIi();for(const bc of Object.keys(this.l_c))this.l_c[bc].cJi()&&delete this.l_c[bc]}Qh(bc,cc){if(cc&&cc.node&&cc.property.id===Z.a.Tq.id){bc=Object(U.a)(352,cc.node);cc=!cc.node.loading;const Vc=this.Fc.vIa(bc);if(Vc)this.Ejm(Vc,cc),this.Fjm(Vc,cc);else if(bc=this.La.cna(bc))this.Ejm(bc,
cc),this.Fjm(bc,cc)}}zT(){this.l_c={}}Ftm(){for(const bc of Object.keys(this.LEa))this.LEa[bc].zan()&&delete this.LEa[bc]}Ejm(bc,cc){bc=bc.id.toString();if(bc in this.LEa){bc=this.LEa[bc];const Vc=Object(U.a)(pc,bc);Vc&&Vc.oco();bc.k4e(!0);cc&&(bc.nPh=!0)}}Fjm(bc,cc){var Vc=this.La.Jn(bc);Vc&&this.ya.Ia&&this.ya.Ia.sid===Vc.get_sid()&&this.ya.Ia.cid===Vc.get_cid()&&(Vc=bc.id.toString(),cc?Vc in this.l_c&&delete this.l_c[Vc]:(cc=Object(ba.a)(394,bc)?this.$Ya.XZf(Object(U.a)(394,bc)):this.$Ya.J0f(Object(U.a)(351,
bc)))&&0<cc.length&&(Vc in this.l_c?this.l_c[Vc].k4e(!1):(bc=this.$nk.dVi(bc),this.l_c[Vc]=bc,bc.k4e(!1))))}}Object(c.a)(ac,"TextContentMonitor",null,[]);class gb extends lb{constructor(bc,cc,Vc,td,Xc){super(bc,cc,td,Xc);this.Fc=Vc}get tableCellNode(){return Object(U.a)(394,this.mb)}M6f(){const bc=new d.a;this.Fc.r5c(this.tableCellNode,cc=>{(cc=this.Rj.text(cc))&&0<cc.length&&bc.add(cc)});return bc.toArray().join(" ")}N6f(){const bc=new d.a;this.Fc.r5c(this.tableCellNode,cc=>{cc.Va(Z.a.Tq)&&(cc=cc.jb(Z.a.Tq))&&
0<cc.length&&bc.add(cc)});return bc.toArray().join(" ")}PIi(){try{const bc=this.M6f()||"",cc=this.mDg||"";if(bc!==cc&&this.Jld(bc)!==this.Jld(cc)){const Vc=ub.a.oO("TableCellNode",this.fzm+"/"+this.tableCellNode.om,"Start",qc.a.Pf(this.X0e),"LastSnapshotTime",qc.a.Pf(this.nDg),"EverEdit",this.nPh);Vc.Expiration=-1<this.uWc?(+new Date(this.uWc)-+this.X0e).toString():null;const td=bc.length-cc.length;td?Vc.TextLengthDelta=td:Vc.SameLengthDiffDetails=this.twm(bc,cc);I.a.$(37748808,814,15,Zb.c(Vc))}}catch(bc){I.a.$(37748810,
814,10,"ShapeContentRecord:CheckTextContent failed. {0}",bc)}}cJi(){try{const bc=this.$Ya.XZf(this.tableCellNode);if(bc&&0<bc.length)return!1;const cc=this.N6f()||"",Vc=this.mDg||"";if(cc!==Vc&&0>cc.indexOf(Vc)&&!(0<=this.Jld(cc).indexOf(this.Jld(Vc)))){const td=ub.a.oO("TableCellNode",this.fzm+"/"+this.tableCellNode.om,"Start",qc.a.Pf(this.X0e),"LastSnapshotTime",qc.a.Pf(this.nDg),"TextLengthDelta",cc.length-Vc.length);I.a.$(37748812,814,15,Zb.c(td))}}catch(bc){I.a.$(37748814,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",
bc)}return!0}get fzm(){const bc=this.La.Jn(this.tableCellNode);return bc?bc.om:"UnknownShape"}}Object(c.a)(gb,"TableCellContentRecord",lb,[]);class Jb{constructor(bc,cc,Vc,td){this.La=bc;this.Fc=cc;this.Rj=Vc;this.$Ya=td}dVi(bc){return Object(ba.a)(351,bc)?new pc(Object(U.a)(351,bc),this.La,this.Rj,this.$Ya):Object(ba.a)(394,bc)?new gb(Object(U.a)(394,bc),this.La,this.Fc,this.Rj,this.$Ya):null}}Object(c.a)(Jb,"TextContentRecordFactory",null,[1162]);var uc=a(817);class Cc{constructor(bc,cc,Vc,td,Xc){this.zb=
bc;this.e8b=cc;this.sa=Vc;this.Ofa=td;this.qF=Xc;this.QQh=!1}initialize(){this.sa.AO(Object(G.a)(this,this.lKb,"onSetSelectionFinished"));this.Ofa.QQl(Object(G.a)(this,this.Xnm,"onTypingLockStatusChanged"))}dispose(){this.sa.B4e(Object(G.a)(this,this.lKb,"onSetSelectionFinished"));this.Ofa.Vum(Object(G.a)(this,this.Xnm,"onTypingLockStatusChanged"))}lKb(){var bc=this.sa.Pr();let cc=null;for(const Vc of bc)if(bc=Object(U.a)(Fa.TableCellNode,Vc))if(bc=Object(U.a)(1172,bc.Vg(this.zb.Ua)))if(cc=bc.xnd)break;
this.LEm(cc)}Xnm(bc,cc){this.LEm(cc.mXl)}LEm(bc=null){this.sa.Y7()?this.Oho(bc):this.A8n()}Oho(bc=null){if(this.zb.editingView&&this.zb.editingView.km){const cc=this.u2l();cc&&(this.e8b.fca(cc.shapeNode).h2h(bc),bc&&(cc.h6e=!0,this.qF.IXh(new uc.a(cc)),cc.h6e=!1));this.QQh||I.a.$(507843862,828,50,"TypingLockHandler:SuspectEditingView - ContentEditableView is switching to cell-lock mode");this.zb.editingView.disable(!1,14);this.QQh=!0}}A8n(){if(this.zb.editingView&&this.zb.editingView.km){const bc=
this.u2l();bc&&bc.shapeNode.gd&&(this.e8b.fca(bc.shapeNode).h2h(null),bc.TXe());this.QQh&&I.a.$(507843861,828,50,"TypingLockHandler:ResumeEditingView - ContentEditableView is switching back to edit mode");this.zb.editingView.IZa();this.QQh=!1}}u2l(){let bc=null;const cc=this.sa.zd();1===cc.length&&(bc=Object(U.a)(112,cc[0].yc(this.zb.Ua)));return bc}}Object(c.a)(Cc,"TypingLockHandler",null,[1173,40]);var Gc=a(1215),dd=a(90);class ld{constructor(){this.TRh=this.vn=this.ohb=this.pRh=this.qT=this.ga=
this.qe=null;this.dsg=0;this.gTh=null;this.Vbk=!1;this.TPh=null;this.uck=!1;this.dOg=Db.a("PresencePackage.RefactorInit");this.FDn=Db.a("PresencePackage.CheckSignalRLoadedBeforeRTC")}get name(){return"Presence"}l2m(){this.ga.register(u.a,"Common.PresenceUser").as("Common.IPresenceUser").oa();this.ga.register(Ec,"PowerpointPresence.PresenceUtils").as("Common.IPresenceConverter").oa().pa(()=>new Ec(this.ga.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.Vbk=!0}oc(bc){try{I.a.$(509100485,814,
50,"PresencePackage::configure");this.dsg=(new Date).getTime();this.ga!==bc&&(this.ga=bc,this.ohb=this.ga.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.vn=this.ohb.GIb(1,this.name),this.Vbk=!1,this.uck=this.ga.resolve("PowerPointWebEditor.IApplicationSettings").z3e);this.qe=this.ga.resolve("Common.AFrameworkApplication");const cc=this.ga.resolve("PowerPointWebEditor.IApplicationSettings");this.Vbk||this.l2m();if(this.FDn){I.a.$(508864333,814,50,"PresencePackage::configure; Check SignalR loaded");
const Xc=this.ga.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener");if(Xc.uZe)I.a.$(508864332,814,50,"PresencePackage::configure; SignalR loaded early");else{I.a.$(508864331,814,15,"PresencePackage::configure; SignalR not loaded");Xc.X8l(()=>{I.a.$(508864330,814,50,"PresencePackage::configure; SignalR loaded");this.oc(r.a.instance)});return}}const Vc=cc.aUl&&cc.QLb?!1:cc.li,td=this.t5m(this.ga.resolve("PowerpointPresence.RtcParams"),this.ga.resolve("Common.IPresenceUser"),Vc,cc[dd.a.daa]);
td?(this.ga.register(1159,"Common.IRealtimeChannelBasic").oa().pa(()=>td),this.ga.register(1160,"AppRealtimeChannel.IRealtimeChannel").oa().pa(()=>td),this.k2m(cc),this.dOg&&this.init()):I.a.$(509100484,814,15,"PresencePackage::configure could not create rtc")}catch(cc){I.a.$(508929377,814,10,"PresencePackage::configure; Initializing Presence failed: {0}",cc)}}k2m(bc){this.ga.register(ma,"PowerpointPresence.PPTRtcProvider").as("Common.Interface.IRtcBasicProvider").oa().pa(()=>new ma(this.ga.resolve("Common.IRealtimeChannelBasic")));
this.ga.register(Oa,"PowerpointPresence.EditorPresenceTracker").as("PowerpointPresence.IEditorPresenceTracker").oa().pa(()=>new Oa(this.ga.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.ga.register(sb,"PowerpointPresence.PptRealtimeChannelMetrics").as("PowerpointPresence.IPptRealtimeChannelMetrics").oa().pa(()=>new sb(this.ga.resolve("PowerpointPresence.RtcParams"),this.ga.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.ga.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),
this.ga.resolve("PowerPointWebEditor.Core.INetworkState"),E.a.getInstance(),bc.f5e));this.ga.register(ob,"PowerpointPresence.PresenceManager").as("PowerpointPresence.IPresenceManager").as("Common.IPresenceSender").as("PowerpointPresence.IPresenceUserManager").as("Common.IPresenceRemover").oa().pa(()=>new ob(this.ga.resolve("Common.IPresenceUser"),x.AFrameworkApplication.ha,this.ga.resolve("AppRealtimeChannel.IRealtimeChannel"),this.ga.resolve("PowerpointPresence.RtcParams"),this.qe.Xm,this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.ga.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.ga.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerpointPresence.IPresenceEventNotifier"),this.ga.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.ga.resolve("PowerPointWebEditor.ICoauthStateSetter"),
bc,this.ga.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.ga.resolve("PowerpointPresence.IEditorPresenceTracker"),this.ga.resolve("PowerpointPresence.IPresenceColorProvider"),this.ga.resolve("PowerpointPresence.IPresenceEmailConverter"),this.ga.resolve("PowerpointPresence.IPptRealtimeChannelMetrics"),this.ga.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.ga.resolve("PowerpointPresence.IPresencePerfLogger"),this.ga.eb("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),
this.ga.resolve("PowerpointPresence.IPresencePrepCacheParser").Vld(),this.ga.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.ga.resolve("PowerPointWebEditor.IPopWebService"),this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.ga.register(ca,"PowerpointPresence.PresenceCache").oa().pa(()=>new ca(this.ga.resolve("PowerpointPresence.IPresenceManager")));this.ga.register(fb,"PowerpointPresence.PresencePresenter").oa().pa(()=>new fb(this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerpointPresence.IPresenceManager"),this.ga.resolve("Common.DragInputManager"),this.ga.resolve("PowerpointPresence.ICoauthStateChangesHandler"),this.ga.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("Box4.IPageView").Ua,this.ga.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ua,
this.ga.resolve("PowerpointPresence.IPresenceEventHandlers"),bc.hxa));this.ga.register(Ta,"PowerPointWebEditor.PptWetChangeHandler").as("PowerPointWebEditor.IWetChangeHandler").oa().pa(()=>new Ta(this.ga.resolve("Common.IPresenceUser").clientId,bc.kzm,this.ga.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.ga.resolve("Box4.Graph.IGraphInstance").Xd(10),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")));const cc=new vb(bc.sYl,bc.tph,bc.sph,bc.rUd,bc.eYe,bc.Gbg,
bc.Mtd,bc.Zvh,bc.Mrd,bc.GPf,bc.EPf,bc.LLe,bc.Mpd,bc.USd,bc.wnc,bc.vnc);this.ga.register(Cc,"PowerpointPresence.TypingLockHandler").as("PowerpointPresence.ITypingLockHandler").oa().pa(()=>new Cc(this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"),this.ga.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource")));
this.ga.register(Ia,"PowerpointPresence.CoauthStateChangesHandler").as("PowerpointPresence.ICoauthStateChangesHandler").oa().pa(()=>new Ia(K.App.xi,this.ga.resolve("PowerpointPresence.IPresenceManager"),this.ga.resolve("Common.IPresenceUser").clientId,this.ga.resolve("AppRealtimeChannel.IRealtimeChannel"),this.ga.resolve("PowerPointWebEditor.IPPTWorkspace"),this.ga.resolve("Common.ITaskManager"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("Box4.ContentEditableViewEventSource"),
this.ga.resolve("PowerPointWebEditor.IViewElementHelper"),this.ga.resolve("PowerPointWebEditor.IShapeReader"),this.ga.resolve("PowerPointWebEditor.Graph.ITableReader"),this.ga.resolve("Box4.Graph.IGraphInstance").Xd(12),bc,cc,this.ga.resolve("PowerPointWebEditor.IWetChangeHandler"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.ga.resolve("PowerpointPresence.ITypingLockHandler"),this.ga.resolve("PowerPointWebEditor.View.IPPTPageView").Ua,this.ga.resolve("Box4.Graph.IGraphInstance").Xd(16),v.a.kH(r.a.instance.eb("Common.ISystemInitiatedFeedback"))));this.ga.register(1161,"PowerpointPresence.IPresencePawnFactory").oa().pa(()=>new Cb);this.ga.register(1162,"PowerpointPresence.ITextContentRecordFactory").oa().pa(()=>new Jb(this.ga.resolve("PowerPointWebEditor.IShapeReader"),this.ga.resolve("PowerPointWebEditor.Graph.ITableReader"),
this.ga.resolve("Box4.IParagraphReader"),this.ga.resolve("PowerPointWebEditor.IWetChangeHandler")));this.ga.register(ac,"PowerpointPresence.TextContentMonitor").oa().pa(()=>new ac(this.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),M.a.instance,this.ga.resolve("Box4.Graph.IGraphInstance").Xd(12),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.ga.resolve("PowerPointWebEditor.IWetChangeHandler"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.ga.resolve("PowerPointWebEditor.IShapeReader"),this.ga.resolve("PowerPointWebEditor.Graph.ITableReader"),this.ga.resolve("PowerpointPresence.ITextContentRecordFactory"),cc));this.ga.register(l,"Common.App.Presence.AwayManager").oa().pa(()=>this.B3m(this.ga.resolve("Common.IPresenceUser"),this.ga.resolve("Common.IRealtimeChannelBasic"),
this.ga.resolve("Common.IPresenceRemover"),this.ga.resolve("Common.IPresenceConverter"),bc.getBooleanAppSetting(ya.a.Hqd)));this.ga.register(1163,"PowerPointWebEditor.IDelayedPresenceUserInfoGetter").oa().pa(()=>new Ub(this.ga.resolve("AppRealtimeChannel.IRealtimeChannel")));I.a.$(509100483,814,50,"PresencePackage::configurePostRTC; Setting Rtc configured");this.JJh().Bfc("RTCConfigured")}qkn(bc){let cc,Vc;cc=0;if(bc=this.ga.resolve("PowerpointPresence.IPresencePrepCacheParser").m4l())return Vc=this.ga.resolve("PowerpointPresence.IPresencePrepCacheParser").JIe(),
{hwm:bc,cwm:cc,O_l:Vc};cc=1;if(bc=this.ga.resolve("PowerPointWebEditor.ICoauthStateSetter").QYh)return Vc=this.ga.resolve("PowerPointWebEditor.ICoauthStateSetter").JIe,{hwm:bc,cwm:cc,O_l:Vc}}s5m(){const bc=1E3*this.ga.resolve("PowerPointWebEditor.IApplicationSettings").g5e;0<bc&&(this.gTh=new h.a(2,1,bc,()=>{this.ga.Db("AppRealtimeChannel.IRealtimeChannel")||I.a.$(509670485,828,10,"PresencePackage::createRtcDiscoveryTimeoutTask RTC Discovery Timed Out after {0} ms and attempted to fallback",bc);this.ga.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").sZk(Object(G.a)(this,
this.Czk,"onPopsRtcEndpointUrlReady"));this.ga.Db("AppRealtimeChannel.IRealtimeChannel")||(this.oc(r.a.instance),this.dOg||this.init())},90,"111"),this.ga.resolve("Common.ITaskManager").Rb(this.gTh))}t5m(bc,cc,Vc,td){I.a.$(512360602,828,50,"PresencePackage::CreateRtcInstance; isPodsEnabled:{0}",Vc);cc.clientId=bc.clientId;var Xc=null;cc=null;const ne=E.a.getInstance();if(Vc){cc=td+"rtc2";({hwm:cc,cwm:Vc,O_l:td}=this.qkn(cc));Xc=!this.ga.resolve("PowerPointWebEditor.ICoauthStateGetter").amIAlone;const Vd=
this.ga.resolve("PowerPointWebEditor.ICoauthStateSetter").OOh;I.a.$(512360601,828,15,"PresencePackage::CreateRtcInstance; Discovering RTC enabled; RtcDiscoverType:{0} fCoauthoring:{1} fDefaultConnectToRtc:{2} fPopsRtcConfigured:{3}",Lc[Vc],Xc,td,Vd);if(2===Vc)return this.ga.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").tQl(Object(G.a)(this,this.Czk,"onPopsRtcEndpointUrlReady")),this.s5m(),null;if(!td&&!Xc)return this.ga.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").EFh(Object(G.a)(this,
this.D1e,"onCoauthStatusChanged")),null;Xc=this.y3m(bc,cc,this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),ne)}return z.RealtimeChannel.createInstance(bc.clientId,bc.userSessionId,bc.jsd,bc.DJ,bc.G8k,3,bc.TC,cc,Xc,ne)}B3m(bc,cc,Vc,td,Xc){const ne=new w.a;ne.lj(Vc);Vc=new w.a;Vc.lj(cc);return new l(bc,Vc.task,ne.task,td,this.ga.resolve("Common.ITaskManager"),this.qe.Xm.Pd.JGh?6E4:this.qe.Xm.Pd.Jid,Object(G.a)(this.qe.Xm.kU(),this.qe.Xm.kU().Eb,"processAction"),N.App.vSb.notificationBar,
Xc)}init(){I.a.$(509100482,814,50,"PresencePackage::init; initing presence");const bc=this.ga.resolve("PowerpointPresence.IPresencePerfLogger");bc.mi(21,ld.hOg);bc.mi(22,this.dsg);bc.mi(24,(new Date).getTime());this.ga.resolve("PowerPointWebEditor.PresentationContext").isValid?(I.a.$(509100481,814,50,"PresencePackage::init; Setting Presentation Id ready"),this.JJh().Bfc("PresentationId")):this.ga.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").SFh(Object(G.a)(this,this.oqd,"onPresentationIdReady"));
this.ga.resolve("PowerPointWebEditor.IAppBootCompletedListener").vra(()=>{I.a.$(509100480,814,50,"PresencePackage::init; Setting B2I Finished");this.JJh().Bfc("B2IFinished")})}oqd(){I.a.$(509100451,814,50,"PresencePackage::onPresentationIdReady; Setting Presentation Id ready");this.JJh().Bfc("PresentationId");this.ga.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").tYh(Object(G.a)(this,this.oqd,"onPresentationIdReady"))}Czk(){this.gTh&&this.ga.resolve("Common.ITaskManager").Sh(this.gTh);
this.ga.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").sZk(Object(G.a)(this,this.Czk,"onPopsRtcEndpointUrlReady"));this.ga.Db("AppRealtimeChannel.IRealtimeChannel")||(this.oc(r.a.instance),this.dOg||this.init())}D1e(bc,cc){2!==cc.euk||this.ga.Db("AppRealtimeChannel.IRealtimeChannel")||(this.oc(r.a.instance),this.dOg||this.init());this.ga.Db("AppRealtimeChannel.IRealtimeChannel")&&this.ga.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").iYh(Object(G.a)(this,this.D1e,"onCoauthStatusChanged"))}JJh(){this.TRh||
(this.TRh=new Gc.a(Object(G.a)(this,this.jYe,"initInternal"),["PresentationId","B2IFinished","RTCConfigured"]));return this.TRh}jYe(){this.ga.resolve("PowerpointPresence.IPresencePerfLogger").mi(4,this.ga.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource").h4e);this.ga.resolve("PowerpointPresence.IPresencePerfLogger").mi(23,(new Date).getTime());this.Tun();this.hvn();this.TRh=null}hvn(){try{let bc="";this.ga.resolve("PowerPointWebEditor.IDelayedPresenceUserInfoGetter");bc=this.vn.CJ("presencemanager");
this.ivn();this.vn.FJ(bc);this.ga.resolve("PowerPointWebEditor.ICoauthStateSetter").Zmd=!0;I.a.$(8958608,814,50,"PresencePackage::Init; Presence downloaded");K.App.UUe&&(bc=this.vn.CJ("contentnotification"),ab.init(),this.vn.FJ(bc));bc=this.vn.CJ("resolve");this.ga.resolve("PowerpointPresence.IPresencePerfLogger").h_l();this.qT=this.ga.resolve("PowerpointPresence.IPresenceManager");this.ga.resolve("Common.IPresenceConverter");this.ga.resolve("Common.IRealtimeChannelBasic");this.qe.Xm.Pd.E_l&&(I.a.$(512360600,
814,50,"PresencePackage::Init; Refresh Peoples well after Rtc ready"),this.qe.Xm.kU().Eb(n.a.nob,2));this.ga.resolve("PowerPointWebEditor.IWetChangeHandler");this.ga.resolve("Common.Interface.IRtcBasicProvider");this.ga.resolve("PowerpointPresence.ICoauthStateChangesHandler");this.ga.resolve("PowerpointPresence.PresencePresenter");this.ga.resolve("PowerpointPresence.IPresencePawnFactory");this.ga.resolve("Common.App.Presence.AwayManager");this.qe.Xm.Pd.PXe&&this.ga.resolve("PowerpointPresence.TextContentMonitor");
this.vn.FJ(bc);this.ga.resolve("PowerpointPresence.IPresencePerfLogger").b_l();this.ga.resolve("PowerpointPresence.IPresencePrepCacheParser").Ibm()}catch(bc){I.a.$(512360599,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",bc)}}dispose(){this.qT?this.qT.disconnect():I.a.$(512360598,814,10,"PresencePackage::Dispose; m_presenceManager is null.");this.ga.resolve("PowerpointPresence.IPresencePerfLogger").dispose()}ivn(){this.ga.resolve("PowerpointPresence.PresenceManager").Kb();
I.a.$(512360597,814,50,"PresencePackage::InitializePresenceManager; Presence Manager loaded and initialized")}y3m(bc,cc,Vc,td){let Xc=cc;Xc=Xc.endsWith("/")?Xc+"findsession":Xc+"/findsession";I.a.$(512360596,814,50,"PresencePackage::CreateAssignRtcMachineStrategy; Using rtc path: {0}; WacClusterId: {1} ",Xc,bc.DJ.Kxa);cc=()=>H.FindSessionStrategy.G4m(bc.userSessionId,bc.DJ,Xc,bc.TC,x.AFrameworkApplication.buildVersion,bc.clientId,ld.Jbj(3,x.AFrameworkApplication.buildVersion),td,bc.G8k,()=>{if(x.AFrameworkApplication.Fh)return x.AFrameworkApplication.Fh;
const Vd=this.ga.resolve("PowerPointWebEditor.PresentationContext").ei.string;Vd||I.a.$(512360595,814,15,"CreateAssignRtcMachineStrategy - returning a null query string");return Vd},this.ga.resolve("PowerpointPresence.IPresencePrepCacheParser").l4l());const ne=!!this.pRh;return this.uck||ne?this.TPh=new Tb(this.pRh,cc,Vc,td,this.ga.resolve("PowerpointPresence.IPresencePerfLogger")):cc()}Tun(){var bc;if(bc=this.ga.resolve("PowerPointWebEditor.IApplicationSettings").ord?this.ga.resolve("PowerpointPresence.IPresencePrepCacheParser").N2l():
this.ga.resolve("PowerPointWebEditor.Core.IFindRtcSessionSimpleStrategy").rWe)bc=P.RtcUtils.deserialize(bc,"PresencePackage","Deserialize existing FindSession response",!0),this.rWh(bc)}rWh(bc){if(bc)try{this.pRh=Object.assign(new F.a,{zjg:bc[T.a.qZe],errorMessage:bc[T.a.errorMessage],nJf:bc[T.a.Wkl],Zhb:bc[T.a.Zhb],x$:bc[T.a.x$],EMh:bc[T.a.Qvj],vUh:bc[T.a.Yqe],wUh:bc[T.a.Vcd],xUh:bc[T.a.mre]}),this.uck&&this.TPh&&(this.TPh.findSessionResponse=this.pRh)}catch(cc){I.a.$(512360594,828,10,"Exception caught while creating FindSessionResponse: {0}",
cc)}}static main(){ld.hOg=(new Date).getTime();const bc=new ld;x.AFrameworkApplication.ha&&x.AFrameworkApplication.ha.getBooleanAppSetting("IsSyncConfigPresenceEnabled")?(bc.oc(r.a.instance),bc.ga.Db("AppRealtimeChannel.IRealtimeChannel")&&!bc.dOg&&bc.init()):A.a.instance.Jc(bc)}static Jbj(bc,cc){return String.format("{0}, {1}, {2}",ld.VFf(B.a[bc]),ld.VFf("browser"),cc)}static VFf(bc){return bc?bc.charAt(0).toLocaleUpperCase()+bc.substring(1,bc.length):bc}}ld.hOg=0;Object(c.a)(ld,"PresencePackage",
null,[4,5]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerpointPresence");window.g_hermesPresence1JS=new Date;Type.registerNamespace("Common.App.Presence");Type.registerNamespace("AppRealtimeChannel");ld.main()},419:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);a=a(30);class c extends a.a{constructor(b){super();this._element=null;this.element=b}get element(){return this._element}set element(b){this._element=b}get visible(){return"visible"===this.element.style.visibility}set visible(b){this.element.style.visibility=
b?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(b){this.element.dir=b?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(b){this.element.style.zIndex=String(b)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(b){return this.element.ownerDocument.createElement(b)}G1(){return!0}static iVe(b,d){return b+(d?"Rtl":"")}}Object(y.a)(c,"BasePresenceControl",
a.a,[40,624])},420:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c extends Sys.EventArgs{constructor(b,d){super();this.type=b;this.jh=d}}c.JJ="InteractivityChanged";Object(y.a)(c,"InteractivityChangedEventArgs",Sys.EventArgs,[])},624:function(y,C,a){a.r(C);a.d(C,"RtcUtils",function(){return e});y=a(0);var c=a(405),b=a(15),d=a(1137);class e{static MHi(h,n=d.a.lrk){let m;try{m=b.c(h)}catch(k){throw h=String.format("Failed to JSON-serialize payload : {0}",k),c.ULS.sendTraceTag(508396173,
500,10,h),Error.argument("payload",h);}if(m.length>n)throw h=String.format("Payload exceeds maximum length: {0} > {1}.",m.length,n),c.ULS.sendTraceTag(508396171,500,10,h),Error.argument("payload",h);return m}static deserialize(h,n,m){if(!h)return null;if(Object.getType(h)!==String){var k=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",n,Object.getType(h).getName(),m);c.ULS.sendTraceTag(508396170,500,10,k);return null}k=null;
try{k=b.a(h)}catch(l){h=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",n,l,m),c.ULS.sendTraceTag(508396168,500,10,h)}return k}static z1e(h){if(!h)return"";if("string"===typeof h)return h.toString();try{return b.c(h)}catch(n){return h.toString()}}static G_l(h){let n,m,k;n=0;k=m=null;if(!h)return{dGj:n,eGj:m,Cj:k};try{const l=h.source;l&&Object.getType(l)===String&&(k=l);const u=h.context;u&&(h=u,n=h.status?h.status:0,m=h.statusText?h.statusText:
null)}catch(l){}return{dGj:n,eGj:m,Cj:k}}}Object(y.a)(e,"RtcUtils",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25649181/wdjs/ppteditDS.presence1.js.map