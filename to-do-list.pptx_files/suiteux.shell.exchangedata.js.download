var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_exchangedata_start"),(self.suiteux_shell_webpackJsonp_main=self.suiteux_shell_webpackJsonp_main||[]).push([["exchangedata"],{5172:function(e,a,n){n.r(a),n.d(a,{getOwaUserConfig:function(){return h},setUserTheme:function(){return u}});var t,i=n(6592),r=n(81235),o=n(56003);!function(e){e.DataProviderOpxGetUserConfiguration="DataProviderOpxGetUserConfiguration",e.DataProviderOpxSaveUserTheme="DataProviderOpxSaveUserTheme"}(t||(t={}));var c=n(91011),s="DataProviderOpx",l=null;function h(){return new Promise((function(e,a){x().then((function(){i.n.Instance.OwaPoweredExperiences.updateData(r.x.ExchangeData,t.DataProviderOpxGetUserConfiguration).then((function(a){(0,c.jl)().impression("GetOwaUserConfigSuccess","ExchangeDataOpx"),e(a)}))})).catch((function(e){a(e)}))}))}function u(e,a){return new Promise((function(n,o){x().then((function(){var o={ThemeId:e,SkipO365Call:a};(0,c.jl)().tag("SetUserThemeStart",1,"ExchangeDataOpx",e),i.n.Instance.OwaPoweredExperiences.updateData(r.x.ExchangeData,t.DataProviderOpxSaveUserTheme,o).then((function(a){(0,c.jl)().tag("SetUserThemeSuccess",1,"ExchangeDataOpx",e),n(a)}))})).catch((function(e){o(e)}))}))}function x(){return null==l&&(l=new Promise((function(e,a){var n=(0,o.P2)();n?function(e){var a=document.createElement("iframe");a.id=s,a.name=s,e.appendChild(a);var n={AuthToken:"",UseDarkMode:!1,BackgroundColor:"",SessionId:"",Scenario:"DataProvider",Telemetry:JSON.stringify({SessionID:i.n.Instance.Configuration.ShellSID,WorkloadID:i.n.Instance.Configuration.WorkloadId}),Data:{}};return i.n.Instance.OwaPoweredExperiences.initializeOpx(r.x.ExchangeData,s,n)}(n).then((function(n){if(0===n)e();else(0,c.jl)().tag("ExchangeDataOpx_InitializeExchangeDataOpx_Failed",6,n),a("Failed to initialize Exchange Data OPX.  Result Code: ".concat(n))})).catch((function(e){(0,c.jl)().exception("ExchangeDataOpx_InitializeExchangeDataOpx_UnknownFailure",6,e),a(e)})):((0,c.jl)().tag("ExchangeDataOpx_InitializeExchangeDataOpx_Failed",6,2),a("Failed to instantiate OPX container."))}))),l}}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_exchangedata_end"),shellPerformance.measure("shell_exchangedata","shell_exchangedata_start","shell_exchangedata_end"));