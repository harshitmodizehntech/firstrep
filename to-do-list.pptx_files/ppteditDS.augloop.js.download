'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1121:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.completion=new Promise((b,d)=>{this.resolve=b;this.reject=d})}}Object(y.a)(c,"ControlledPromise",null,[])},1122:function(y,C,a){a.d(C,"a",function(){return c});const c=b=>{if((b=b.Ac("AugLoopEndpointOverride",0))&&!(1>b))return{[1]:"https://augloop-test.officeppe.com",[2]:"https://augloop-int.officeppe.com",[3]:"https://augloop-dogfood.officeppe.com",
[4]:"https://augloop.office.com",[5]:"http://localhost:20080"}[b]}},1253:function(y,C,a){var c=this&&this.Npc||(Object.create?function(d,e,h,n){void 0===n&&(n=h);var m=Object.getOwnPropertyDescriptor(e,h);if(!m||("get"in m?!e.Xea:m.writable||m.configurable))m={enumerable:!0,get:function(){return e[h]}};Object.defineProperty(d,n,m)}:function(d,e,h,n){void 0===n&&(n=h);d[n]=e[h]}),b=this&&this.__exportStar||function(d,e){for(var h in d)"default"===h||Object.prototype.hasOwnProperty.call(e,h)||c(e,d,
h)};Object.defineProperty(C,"__esModule",{value:!0});b(a(1818),C);b(a(1819),C);b(a(1820),C);b(a(1821),C)},1419:function(y,C,a){a.d(C,"a",function(){return h});y=a(0);var c=a(21),b=a(111),d=a(43),e=a(61);a(110);class h{constructor(){this.zIa=null}get tmd(){return!1}zul(n,m){let k=new c.a;const l=new e.GraphTransaction(3);try{l.ld(d.App.Zb.Sd.eo.ih),this.dlg(m)&&(k=this.Fdg(m,k)),m!==n&&this.dlg(n)&&(k=this.Fdg(n,k))}finally{l&&l.dispose()}return k.toArray()}dlg(n){return!!n}cYh(n){let m=!1;for(const k of this.oFj)m||
!Sys.UI.DomElement.containsCssClass(n,k.className)&&!Sys.UI.DomElement.containsCssClass(n,k.F8f)||(m=!0),b.a.dib(n,k.className),b.a.dib(n,k.F8f)}}Object(y.a)(h,"AHighlightActor",null,[622])},1420:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(b,d){this.className=b;this.F8f=d}}Object(y.a)(c,"HighlightCssClassPair",null,[])},1421:function(y,C,a){a.d(C,"b",function(){return e});a.d(C,"a",function(){return h});var c=a(111);a(43);var b=a(61);a(47);a(105);var d=a(110);const e=
n=>{const m=new b.GraphTransaction(3);try{m.ld(n),n.er(32,!0)}finally{m&&m.dispose()}},h=n=>{if(n){n=c.a.Iia(n);if(-1===n.indexOf(d.a.R2)&&-1!==n.indexOf(d.a.KP)&&-1===n.indexOf(d.a.qRd))return 2;if(-1===n.indexOf(d.a.R2)&&(-1!==n.indexOf(d.a.Ujd)||-1!==n.indexOf(d.a.UP)||-1!==n.indexOf(d.a.qRd)||-1!==n.indexOf(d.a.jPd)||-1!==n.indexOf(d.a.fWb)||-1!==n.indexOf(d.a.pRd)||-1!==n.indexOf(d.a.xDc)||-1!==n.indexOf(d.a.yDc)||-1!==n.indexOf(d.a.vDc)||-1!==n.indexOf(d.a.wDc)||-1!==n.indexOf(d.a.TMf)||-1!==
n.indexOf(d.a.PMf)||-1!==n.indexOf(d.a.QMf)||-1!==n.indexOf(d.a.mRd)||-1!==n.indexOf(d.a.NMf)))return 1;if(-1!==n.indexOf("WACImageContainer"))return 3}return 0}},1422:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.type=this.action=0;this.y5c=this.ngb=null}}Object(y.a)(c,"HighlightOperation",null,[])},1424:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);var c=a(21);class b{static ltm(d){b.Vag.add(d)}static sxm(d){for(const e of b.Vag)e(d)}static rtm(d){b.$Fe.add(d);
if(0<b.I6c.count){for(const e of b.I6c)d(e);b.I6c=new c.a}}static vxm(d){if(0<b.$Fe.count)for(const e of b.$Fe)e(d);else b.I6c.add(d)}}b.I6c=new c.a;b.$Fe=new c.a;b.Vag=new c.a;Object(y.a)(b,"AugLoopEventUtils",null,[])},1583:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);var c=a(609);class b{constructor(d){this.DJ=d}t5e(d,e,h,n){return c.a.then(this.DJ.YLa(d,e,h,{"Content-Type":"application/json; charset=utf-8"},!1,n,null,void 0,void 0,void 0,void 0,void 0,"2"),m=>this.Y4f(m))}Y4f(d){return d&&
d.mj&&d.mj.data?d.mj.data.responseData:null}}Object(y.a)(b,"SimpleRequestManager",null,[1802])},161:function(y,C,a){a.r(C);a.d(C,"AnnotationState",function(){return c});a.d(C,"OperationErrorCode",function(){return h});a.d(C,"ItemOperation",function(){return d});a.d(C,"ItemChanges",function(){return e});a.d(C,"EntryPoint",function(){return b});a.d(C,"ecsMetadataBlockHeight",function(){return 512});a.d(C,"ecsMetadataBlockWidth",function(){return 32});a.d(C,"BlobRefType",function(){return n});a.d(C,
"OpenType",function(){return m});a.d(C,"GridConstants",function(){return k});a.d(C,"Annotation",function(){return u});a.d(C,"BinaryClassificationAnnotation",function(){return r});a.d(C,"Event",function(){return x});a.d(C,"UserCommand",function(){return v});a.d(C,"ItemDelta",function(){return z.f});a.d(C,"ItemChangesDelta",function(){return z.e});a.d(C,"Operation",function(){return z.i});a.d(C,"OperationWithSiblingContext",function(){return z.j});a.d(C,"AddOperation",function(){return z.a});a.d(C,
"MoveOperation",function(){return z.h});a.d(C,"UpdateAnnotationMetaDataOperation",function(){return z.n});a.d(C,"UpdateOperation",function(){return z.o});a.d(C,"DeleteOperation",function(){return z.b});a.d(C,"PurgeOperation",function(){return z.k});a.d(C,"PurgeSubtreeOperation",function(){return z.l});a.d(C,"FocusOperation",function(){return z.d});a.d(C,"VisibilityOperation",function(){return z.p});a.d(C,"DeltaUpdateOperation",function(){return z.c});a.d(C,"MicroSyncOperation",function(){return z.g});
a.d(C,"SignalOperation",function(){return z.m});a.d(C,"SchemaObject",function(){return l.a});a.d(C,"Signal",function(){return A});a.d(C,"DirtyAreaSignal",function(){return B});a.d(C,"Blob",function(){return G});a.d(C,"Binary",function(){return w});a.d(C,"TileGroup",function(){return F});a.d(C,"Session",function(){return H});a.d(C,"Document",function(){return E});a.d(C,"SubDocument",function(){return P});a.d(C,"GridCell",function(){return T});a.d(C,"GridNeighborhoodContext",function(){return K});a.d(C,
"ItemFilter",function(){return M});a.d(C,"DynamicContext",function(){return N});a.d(C,"ContextHolder",function(){return I});a.d(C,"UserContextHolder",function(){return O});a.d(C,"TenantContextHolder",function(){return Q});a.d(C,"EventsHolder",function(){return U});a.d(C,"UserCommandsHolder",function(){return ba});var c;(function(aa){aa[aa.Undefined=0]="Undefined";aa[aa.Created=10]="Created";aa[aa.Sent=20]="Sent";aa[aa.Duplicated=30]="Duplicated";aa[aa.Seen=40]="Seen";aa[aa.Tried=50]="Tried";aa[aa.Kept=
60]="Kept";aa[aa.Rejected=70]="Rejected"})(c||(c={}));var b;(function(aa){aa.Canvas="Canvas";aa.CopilotChat="CopilotChat";aa.Test="Test"})(b||(b={}));var d;(function(aa){aa[aa.None=0]="None";aa[aa.Added=1]="Added";aa[aa.Updated=2]="Updated";aa[aa.Deleted=3]="Deleted"})(d||(d={}));var e;(function(aa){aa[aa.ContentChanged=0]="ContentChanged";aa[aa.ContentWasEmpty=1]="ContentWasEmpty";aa[aa.FormattingChanged=2]="FormattingChanged";aa[aa.ContentWasInsideOfTheTable=3]="ContentWasInsideOfTheTable"})(e||
(e={}));var h;(function(aa){aa[aa.AddOfZeroElements=0]="AddOfZeroElements";aa[aa.AddOfItemsWithExtraOrMissingIds=1]="AddOfItemsWithExtraOrMissingIds";aa[aa.AddOfItemWithUndefinedId=2]="AddOfItemWithUndefinedId";aa[aa.AddOfUndefinedItem=3]="AddOfUndefinedItem";aa[aa.AddOfItemsWithDuplicateIds=4]="AddOfItemsWithDuplicateIds";aa[aa.SetHeadToNonExistingItem=5]="SetHeadToNonExistingItem";aa[aa.DeleteOfNonExistingItem=6]="DeleteOfNonExistingItem";aa[aa.UpdateOfNonExistentItem=7]="UpdateOfNonExistentItem";
aa[aa.UpdateOfStubbedItem=8]="UpdateOfStubbedItem";aa[aa.MoveOfNonExistentItem=9]="MoveOfNonExistentItem";aa[aa.UpdateMetaDataOfNonAnnotationType=10]="UpdateMetaDataOfNonAnnotationType";aa[aa.SequentialyInvertedUpdate=11]="SequentialyInvertedUpdate";aa[aa.MoveToTheSamePath=12]="MoveToTheSamePath";aa[aa.DeltaOfNonExistingItem=100]="DeltaOfNonExistingItem"})(h||(h={}));var n;(function(aa){aa[aa.None=0]="None";aa[aa.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl";aa[aa.AlCodedLocation=2]="AlCodedLocation";
aa[aa.Token=3]="Token"})(n||(n={}));var m;(function(aa){aa[aa.NewDocument=0]="NewDocument";aa[aa.EditDocument=1]="EditDocument";aa[aa.ViewOnlyDocument=2]="ViewOnlyDocument"})(m||(m={}));class k{}k.lowerIndexBound=1;k.maxNumberOfRows=1048576;k.maxNumberOfColumns=16384;k.firstColumnName="A";k.lastColumnName="XFD";var l=a(210);class u{get metadata(){return this.M_}set metadata(aa){this.M_=aa}constructor(aa){l.a.assign(u,this,aa)}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,
[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(aa){this.M_=aa}constructor(aa){l.a.assign(r,this,aa)}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class x{constructor(aa){l.a.assign(x,this,aa)}static getTypeName(){return"AugLoop_Core_Event"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,
[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class v{constructor(aa){l.a.assign(v,this,aa)}static getTypeName(){return"AugLoop_Core_UserCommand"}static getBaseTypes(){return["AugLoop_Core_Event"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};var z=a(464);class A{constructor(aa){l.a.assign(A,this,aa)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,
[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class B{constructor(aa){l.a.assign(B,this,aa)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class G{constructor(aa){l.a.assign(G,this,aa)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,
[G.getTypeName()])}}G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()};class w{constructor(aa){l.a.assign(w,this,aa)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class F{constructor(aa){l.a.assign(F,this,aa)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[F.getTypeName()])}}
F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class H{constructor(aa){l.a.assign(H,this,aa)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class E{constructor(aa){l.a.assign(E,this,aa)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,
[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class P{constructor(aa){l.a.assign(P,this,aa)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class T{constructor(aa){l.a.assign(T,this,aa)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[T.getTypeName()])}}
T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class K{constructor(aa){l.a.assign(K,this,aa)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[K.getTypeName()])}}K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};class M{constructor(aa){l.a.assign(M,this,aa)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[M.getTypeName()])}}
M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class N{constructor(aa){l.a.assign(N,this,aa)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class I{constructor(aa){l.a.assign(I,this,aa)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[I.getTypeName()])}}
I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class O{constructor(aa){l.a.assign(O,this,aa)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class Q{constructor(aa){l.a.assign(Q,this,aa)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,
[Q.getTypeName()])}}Q.H_={T_:Q.getTypeName(),B_:Q.getBaseTypes()};class U{constructor(aa){l.a.assign(U,this,aa)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class ba{constructor(aa){l.a.assign(ba,this,aa)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,
[ba.getTypeName()])}}ba.H_={T_:ba.getTypeName(),B_:ba.getBaseTypes()}},1816:function(y,C,a){a.d(C,"b",function(){return c});a.d(C,"a",function(){return b});const {AugLoopTextEncoder:c,AugLoopTextDecoder:b}=(()=>{if("undefined"===typeof TextEncoder){a(1817);const d={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};TextDecoder=TextEncoder=void 0;return d}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}})()},1817:function(y,C,a){(function(c,b){(function(d){function e(G,
w,F){if(G)throw Error("".concat("Failed to ").concat(w,": the '").concat(F,"' option is unsupported."));}function h(G){return b.from(G)}function n(G,w){var F;return G instanceof b?F=G:F=b.from(G.buffer,G.byteOffset,G.byteLength),F.toString(w)}function m(G){for(var w=0,F=Math.min(65536,G.length+1),H=new Uint16Array(F),E=[],P=0;;){var T=w<G.length;if(!T||P>=F-1){if(E.push(String.fromCharCode.apply(null,H.subarray(0,P))),!T)return E.join("");G=G.subarray(w);P=w=0}T=G[w++];if(0===(T&128))H[P++]=T;else if(192===
(T&224)){var K=G[w++]&63;H[P++]=(T&31)<<6|K}else if(224===(T&240)){K=G[w++]&63;var M=G[w++]&63;H[P++]=(T&31)<<12|K<<6|M}else if(240===(T&248)){K=G[w++]&63;M=G[w++]&63;var N=G[w++]&63;T=(T&7)<<18|K<<12|M<<6|N;65535<T&&(T-=65536,H[P++]=T>>>10&1023|55296,T=56320|T&1023);H[P++]=T}}}function k(G){for(var w=0,F=G.length,H=0,E=Math.max(32,F+(F>>>1)+7),P=new Uint8Array(E>>>3<<3);w<F;){var T=G.charCodeAt(w++);if(55296<=T&&56319>=T){if(w<F){var K=G.charCodeAt(w);56320===(K&64512)&&(++w,T=((T&1023)<<10)+(K&
1023)+65536)}if(55296<=T&&56319>=T)continue}H+4>P.length&&(E+=8,E*=1+w/G.length*2,E=E>>>3<<3,K=new Uint8Array(E),K.set(P),P=K);if(0===(T&4294967168))P[H++]=T;else{if(0===(T&4294965248))P[H++]=T>>>6&31|192;else if(0===(T&4294901760))P[H++]=T>>>12&15|224,P[H++]=T>>>6&63|128;else if(0===(T&4292870144))P[H++]=T>>>18&7|240,P[H++]=T>>>12&63|128,P[H++]=T>>>6&63|128;else continue;P[H++]=T&63|128}}return P.slice?P.slice(0,H):P.subarray(0,H)}function l(){this.encoding="utf-8"}function u(G,w){e(w&&w.fatal,"construct 'TextDecoder'",
"fatal");G=G||"utf-8";var F;if(r?F=b.WYe(G):F=-1!==z.indexOf(G.toLowerCase()),!F)throw new RangeError("".concat(B," encoding label provided ('").concat(G,"') is invalid."));this.encoding=G;this.ignoreBOM=this.fatal=!1}var r="function"==typeof b&&b.from,x=r?h:k;l.prototype.encode=function(G,w){return e(w&&w.stream,"encode","stream"),x(G)};var v=!r&&"function"==typeof Blob&&"function"==typeof URL&&"function"==typeof URL.createObjectURL,z=["utf-8","utf8","unicode-1-1-utf-8"],A=m;r?A=n:v&&(A=function(G){try{a:{try{var w=
URL.createObjectURL(new Blob([G],{type:"text/plain;charset=UTF-8"}));var F=new XMLHttpRequest;var H=(F.open("GET",w,!1),F.send(),F.responseText);break a}finally{w&&URL.revokeObjectURL(w)}H=void 0}return H}catch(E){return m(G)}});var B="".concat("Failed to "," ").concat("construct 'TextDecoder'",": the ");u.prototype.decode=function(G,w){e(w&&w.stream,"decode","stream");var F;return G instanceof Uint8Array?F=G:G.buffer instanceof ArrayBuffer?F=new Uint8Array(G.buffer):F=new Uint8Array(G),A(F,this.encoding)};
d.TextEncoder=d.TextEncoder||l;d.TextDecoder=d.TextDecoder||u})("undefined"!==typeof window?window:"undefined"!==typeof c?c:this)}).call(this,a(31),a(796).Buffer)},1818:function(y,C){Object.defineProperty(C,"__esModule",{value:!0});C.RewriteCompletionStatus=C.ContentType=C.RewriteSuggestionType=void 0;(function(a){a[a.Bullet=0]="Bullet";a[a.Concise=1]="Concise";a[a.Paraphrase=2]="Paraphrase";a[a.Title=3]="Title"})(C.RewriteSuggestionType||(C.RewriteSuggestionType={}));(function(a){a[a.PLAIN_TEXT=
0]="PLAIN_TEXT";a[a.HTML=1]="HTML";a[a.JSON=2]="JSON"})(C.ContentType||(C.ContentType={}));(function(a){a[a.Success=0]="Success";a[a.OffensiveContentInput=1]="OffensiveContentInput";a[a.OffensiveContentOutput=2]="OffensiveContentOutput";a[a.EmptyResponse=3]="EmptyResponse";a[a.OpenAiModelError=4]="OpenAiModelError";a[a.UnsupportedLanguage=5]="UnsupportedLanguage";a[a.Timeout=6]="Timeout";a[a.BadRequest=7]="BadRequest";a[a.Unknown=8]="Unknown";a[a.UserNotAuthorized=9]="UserNotAuthorized";a[a.ParseFailure=
10]="ParseFailure";a[a.RepeatedTitle=11]="RepeatedTitle"})(C.RewriteCompletionStatus||(C.RewriteCompletionStatus={}))},1819:function(y,C,a){Object.defineProperty(C,"__esModule",{value:!0});C.RewriteAnswer=void 0;const c=a(161);class b{constructor(d){c.SchemaObject.assign(b,this,d)}get metadata(){return this.M_}set metadata(d){this.M_=d}static getTypeName(){return"AugLoop_Rewrite_RewriteAnswer"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(d){return c.SchemaObject.matchesTypesFor(d,
[b.getTypeName()])}}C.RewriteAnswer=b;b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()}},1820:function(y,C){Object.defineProperty(C,"__esModule",{value:!0});C.RewriteType=void 0;y=C.RewriteType||(C.RewriteType={});y[y.Title=0]="Title";y[y.Subtitle=1]="Subtitle";y[y.Content=2]="Content"},1821:function(y,C,a){Object.defineProperty(C,"__esModule",{value:!0});C.RewriteSignal=void 0;const c=a(161);class b{constructor(d){c.SchemaObject.assign(b,this,d)}static getTypeName(){return"AugLoop_Rewrite_RewriteSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(d){return c.SchemaObject.matchesTypesFor(d,
[b.getTypeName()])}}C.RewriteSignal=b;b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()}},1891:function(y,C,a){(function(c){a.d(C,"a",function(){return d});var b=a(1816);class d{static deserialize(e,h=n=>n){if(e[0]!==d.IDENTIFIERBYTE)throw Error("Invalid Binary: Incorrect Identifier");let n=1;const m=[],k=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;n<e.byteLength;){if(n+4>e.byteLength)throw Error("Invalid Binary: Error reading fragment length");const l=k.getUint32(n);if(n+l+4>e.byteLength)throw Error("Invalid Binary: Fragment out of range");
"undefined"!==typeof c&&c.from?m.push(c.from(e.buffer,e.byteOffset+n+4,l)):m.push(new Uint8Array(e.buffer,e.byteOffset+n+4,l));n+=4+l}if(1>m.length)throw Error("Invalid Binary: No fragments found");e=d.textDecoder.decode(m[0]);return JSON.parse(e,(l,u)=>{if("string"===typeof u){if(u.substring(0,d.BINARYKEYWORD.length)===d.BINARYKEYWORD){l=parseInt(u.substring(d.BINARYKEYWORD.length),10);if("number"!==typeof l||l>=m.length-1)throw Error("Invalid Binary: Binary index out of range");return h(m[l+1])}if(u.substring(0,
d.ESCAPEKEYWORD.length)===d.ESCAPEKEYWORD)return u.substring(d.ESCAPEKEYWORD.length)}return u})}static serialize(e){const h=[void 0];e=JSON.stringify(e,(k,l)=>ArrayBuffer.isView(l)?(h.push(l),`${d.BINARYKEYWORD}${h.length-2}`):l&&"Buffer"===l.type&&Array.isArray(l.data)?(h.push(new Uint8Array(l.data)),`${d.BINARYKEYWORD}${h.length-2}`):"string"===typeof l&&l.substring(0,d.ESCAPEKEYWORD.length)===d.ESCAPEKEYWORD?d.ESCAPEKEYWORD+l:l);h[0]=d.textEncoder.encode(e);e=h.reduce((k,l)=>k+4+l.byteLength,0);
e=new Uint8Array(e+1);e[0]=d.IDENTIFIERBYTE;let n=1;const m=new DataView(e.buffer,e.byteOffset,e.byteLength);for(const k of h)m.setUint32(n,k.byteLength),e.set(k,n+4),n+=4+k.byteLength;return e}}d.IDENTIFIERBYTE=3;d.BINARYKEYWORD=":b";d.ESCAPEKEYWORD=":";d.textDecoder=new b.a;d.textEncoder=new b.b}).call(this,a(796).Buffer)},1897:function(y,C,a){a.r(C);var c=a(0),b=a(405),d=a(41),e=a(69),h=a(95),n=a(21);class m{constructor(){this.ContextId=this.SessionId=this.AppId=this.Payload=this.Topic=null}}Object(c.a)(m,
"AugmentationServiceRequest",null,[]);var k=a(15),l=a(23);class u{constructor(yb,Tc,bd){this.$Se=this.qHb=null;this.Obb=kd=>{!d.AFrameworkApplication.Ch&&kd&&kd.data&&this.lQn(kd.data.responseData)};this.Lbb=kd=>{!d.AFrameworkApplication.Ch&&kd&&kd.data&&b.ULS.sendTraceTag(25747918,306,15,"{0}",kd.data.responseData)};this.YLm=bd;this.Ga=Tc;this.Dn=yb}initialize(){b.ULS.sendTraceTag(25747911,306,50,"Start initialing augmentation loop ...");const yb=this.Ga.Ma("AugmentationLoopWebServiceBase"),Tc=this.Ga.Ma("WebServiceBase");
this.qHb=(void 0===yb?Tc:yb)+"proofing.ashx?"+d.AFrameworkApplication.Fh+"&apitype=AL";this.$Se=new l.a;b.ULS.sendTraceTag(25747912,306,50,"Augmentation Loop initialized")}addEventHandler(yb,Tc){if(yb&&""!==yb)if(Tc){if(!({value:bd}=this.$Se.Ph(yb)).returnValue){var bd=new n.a;this.$Se.add(yb,bd)}bd.contains(Tc)||bd.add(Tc)}else b.ULS.sendTraceTag(25747914,306,15,"eventHandler is null");else b.ULS.sendTraceTag(25747913,306,15,"topic is empty or null")}removeEventHandler(yb,Tc){yb&&""!==yb?Tc?this.$Se.Sb(yb)?
({value:yb}=this.$Se.Ph(yb),yb&&yb.contains(Tc)&&yb.remove(Tc)):b.ULS.sendTraceTag(25747917,306,15,"Topic {0} doesn't exist in handler map.",yb):b.ULS.sendTraceTag(25747916,306,15,"Try to remove null handler"):b.ULS.sendTraceTag(25747915,306,15,"topic is empty or null")}v7k(yb,Tc,bd){this.T4e(yb,Tc,bd,this.Obb,this.Lbb)}T4e(yb,Tc,bd,kd,zd,fe=null){yb=Object.assign(new m,{Topic:yb,Payload:Tc,AppId:this.YLm,SessionId:this.Dn.userSessionId,ContextId:bd});this.Dn.ik(this.qHb,2,k.c(yb),{"Content-Type":"application/json; charset=utf-8"},
!1,3,kd,zd,fe?fe:yb,void 0,void 0,void 0,void 0,"18")}lQn(yb){if(yb){try{var Tc=k.a(yb)}catch(bd){b.ULS.sendTraceTag(36284437,306,10,"Try parse aug response failed:{0}",bd.message);return}if(({value:yb}=this.$Se.Ph(Tc.Topic)).returnValue)for(const bd of yb)bd(Tc.ContextId,Tc.Payload);else b.ULS.sendTraceTag(25747919,306,50,"Cannot find handlers for Topic:{0};",Tc.Topic)}}}Object(c.a)(u,"AugmentationManager",null,[864]);var r=a(1703);class x{}Object(c.a)(x,"HostMetadata",null,[]);var v=a(1424);class z{sendMessage(yb){b.ULS.sendTraceTag(508965922,
306,100,"AL send SDX message");v.a.sxm(yb)}registerMessageReceivedCallback(yb){b.ULS.sendTraceTag(508965921,306,50,"AL handle SDX message");v.a.rtm(yb)}}Object(c.a)(z,"SdxMessageBridge",null,[896]);class A{}Object(c.a)(A,"Lambda",null,[]);class B extends A{constructor(){super()}}Object(c.a)(B,"WrapperLambda",A,[]);var G=a(595),w=a(142),F=a(206),H=a(143);class E{constructor(){this.handler=this.schemaName=null}}Object(c.a)(E,"AddEventHandlerParameters",null,[]);var P=a(1041);class T{constructor(){this.lambda=
this.name=null}}Object(c.a)(T,"RegisterSimpleLocalWorkflowParameters",null,[]);class K{constructor(){this.lambdaAfter=this.lambdaRemote=this.lambdaBefore=this.name=null}}Object(c.a)(K,"RegisterSimpleRemoteWorkflowParameters",null,[]);var M=a(1608);class N{constructor(){this.bridge=null}}Object(c.a)(N,"SetMessageBridgeParameters",null,[]);class I{constructor(){this.requestAuthTokenCallback=null}}Object(c.a)(I,"SetRequestAuthTokenCallbackParameters",null,[]);class O{constructor(){this.sendOTelEvent=
null}}Object(c.a)(O,"SetSendOTelEventCallbackParameters",null,[]);class Q{constructor(){this.ulsLogger=null}}Object(c.a)(Q,"SetULSLoggerParameters",null,[]);var U=a(718);class ba{constructor(){this.correlationVector=this.input=this.inputSchema=null}}Object(c.a)(ba,"SubmitParameters",null,[]);var aa=a(737);class La{constructor(yb,Tc=null){this.j_a=null;new l.a;new x;this.N7n=()=>{const bd=d.AFrameworkApplication.ha.Ma("AugLoopOAuthResourceUriV2");if(this.Zgd)return new Promise(kd=>{this.Zgd.execute(zd=>
{zd.hP("AugLoop",bd).then(fe=>{fe.IsSuccess?kd(fe.Token):(b.ULS.sendTraceTag(51499467,306,15,fe.ErrorMessage),kd(d.AFrameworkApplication.ha.Ma("AugloopACLPUserDataSignature")||""));return{}})})});b.ULS.sendTraceTag(51499468,306,50,"Auth requested without a IOAuthManager");return Promise.resolve("")};this.sendOTelEvent=bd=>{H.a.sendOtelEvent(Object.assign(new aa.a,{otelEvent:bd}))};this.oRm=yb;this.Zgd=Tc}initialize(yb){this.j_a?b.ULS.sendTraceTag(51185349,306,15,"Initialize called multiple times."):
(yb||(yb=new P.a),this.j_a=new Promise(Tc=>{b.ULS.sendTraceTag(51185350,306,50,"Start download and initialize augloop runtime ...");const bd=d.AFrameworkApplication.oh("al",2);this.oRm.dmc(bd).continueWith(()=>{b.ULS.sendTraceTag(51185351,306,50,"augloop: Successfully loaded script");const kd=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();kd.setRequestAuthTokenCallback(Object.assign(new I,{requestAuthTokenCallback:this.N7n}));kd.setULSLogger(Object.assign(new Q,{ulsLogger:new G.a}));kd.setSendOTelEventCallback(Object.assign(new O,
{sendOTelEvent:this.sendOTelEvent}));let zd=d.AFrameworkApplication.ha.Ma("OfficeApplicationName")||"";zd=zd.replace("Web","");yb.appName=yb.appName||zd;yb.serviceUrl=yb.serviceUrl||d.AFrameworkApplication.ha.Ma("AugLoopCloudALServiceUrl");yb.appVersion=yb.appVersion||d.AFrameworkApplication.ha.Ma("BuildVersion")||"";yb.releaseAudienceGroup=yb.releaseAudienceGroup||(d.AFrameworkApplication.rd?Object(r.a)(String,d.AFrameworkApplication.rd.AudienceGroup)||"":"");yb.sessionId=yb.sessionId||d.AFrameworkApplication.ha.Ma("SessionId")||
"";yb.uiLanguage=yb.uiLanguage||d.AFrameworkApplication.uiCulture;yb.flights=yb.flights||this.Ddn();yb.initSession=yb.initSession||!0;yb.downloadBaseUrl=yb.downloadBaseUrl||d.AFrameworkApplication.ha.Ma("AugLoopDownloadBaseUrl");kd.initialize(yb);kd.setMessageBridge(Object.assign(new N,{bridge:new z}));Tc({})})}))}registerSchemas(){b.ULS.sendTraceTag(51185352,306,50,"RegisterSchemas is a No-Op");return this.j_a}registerSimpleLocalWorkflow(yb,Tc){return this.j_a.then(()=>{b.ULS.sendTraceTag(51185353,
306,50,"Registering local workflow: {0} to AugLoop.",yb);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleLocalWorkflow(Object.assign(new T,{name:yb,lambda:this.D1h(Tc)}))})}registerSimpleRemoteWorkflow(yb,Tc,bd,kd){return this.j_a.then(()=>{b.ULS.sendTraceTag(51185354,306,50,"Registering remote workflow: {0} to AugLoop.",yb);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleRemoteWorkflow(Object.assign(new K,{name:yb,lambdaBefore:this.D1h(Tc),lambdaRemote:this.D1h(bd),
lambdaAfter:this.D1h(kd)}))})}registerReduceWorkflow(){b.ULS.sendTraceTag(51185355,306,100,"RegisterReduceWorkflow is NYI");return this.j_a}submit(yb,Tc){this.j_a.then(()=>{b.ULS.sendTraceTag(51185356,306,100,"Submitting event: {0} to AugLoop.",yb);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submit(Object.assign(new ba,{inputSchema:yb,input:Tc}))})}flushTelemetry(){b.ULS.sendTraceTag(51185357,306,100,"FlushTelemetry is NYI")}submitOperation(yb){this.j_a.then(()=>{b.ULS.sendTraceTag(51185358,
306,100,"Submitting Operation: {0} to AugLoop.",yb);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation(Object.assign(new U.a,{operation:yb}))})}setSessionDataCallback(yb){this.j_a.then(()=>{b.ULS.sendTraceTag(592318537,306,100,"Setting SessionData Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionDataCallback(yb)})}setInitSessionCallback(yb){this.j_a.then(()=>{b.ULS.sendTraceTag(594384065,306,100,"Setting init session override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setInitSessionCallback(yb)})}setSessionInitOverrideCallback(yb){this.j_a.then(()=>
{b.ULS.sendTraceTag(594384064,306,100,"Setting session init override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionInitOverrideCallback(yb)})}setAnnotationResultCallback(yb){this.j_a.then(()=>{b.ULS.sendTraceTag(51185359,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setAnnotationResultCallback(Object.assign(new M.a,{handler:yb}))})}activateAnnotation(yb){return this.j_a.then(()=>{b.ULS.sendTraceTag(51226247,306,100,"Activating Annotation: {0}",
yb.annotationType);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation(yb)})}releaseAnnotation(yb){return this.j_a.then(()=>{b.ULS.sendTraceTag(51226248,306,100,"Releasing Annotation: {0}",yb.token);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().releaseAnnotation(yb)})}addEventHandler(yb,Tc){yb&&""!==yb?Tc?this.j_a.then(()=>{b.ULS.sendTraceTag(51185362,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().addEventHandler(Object.assign(new E,
{schemaName:yb,handler:bd=>{bd&&Tc(bd.inputSchema,bd.input,bd.outputSchema,bd.output)}}))}):b.ULS.sendTraceTag(51185361,306,15,"eventHandler is null"):b.ULS.sendTraceTag(51185360,306,15,"schemaName is empty or null")}removeEventHandler(){b.ULS.sendTraceTag(51185363,306,100,"RemoveEventHandler is NYI.")}D1h(yb){if(yb){let Tc=null;yb.func&&(Tc=(bd,kd,zd,fe)=>{yb.func(bd,kd,fe)});return Object.assign(new B,{name:yb.name,inputSchema:yb.inputSchema,outputSchema:yb.outputSchema,func:Tc})}return null}Ddn(){var yb=
d.AFrameworkApplication.ha.Ma("FlightId");if(d.AFrameworkApplication.ha.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ALFlightForwardingTreatmentVariablesFix")){var Tc=d.AFrameworkApplication.ha.clc,bd=d.AFrameworkApplication.ha.Fz("AugLoopFlightKeywordList");Tc=La.TVf(yb,Tc,Array.isArray(bd)?bd:null);bd="";Tc&&0<Tc.length&&(bd=Tc.join(";"));return bd}Tc=d.AFrameworkApplication.ha.Fz("AugLoopFlightKeywordList");bd=[];if(yb&&""!==yb&&Tc&&0<Tc.length){yb=yb.split(";");for(let kd=0;kd<
yb.length;kd++)for(let zd=0;zd<Tc.length;zd++)-1<yb[kd].toLowerCase().indexOf(Tc[zd].toLowerCase())&&Array.add(bd,yb[kd])}return 0<bd.length?bd.join(";"):""}static TVf(yb,Tc,bd){const kd=new n.a;if(bd&&0<bd.length){for(var zd=0;zd<bd.length;zd++)bd[zd]=bd[zd].toLowerCase();if(yb&&""!==yb){yb=yb.toLowerCase().split(";");for(const fe of yb)F.a.any(bd,Ye=>-1<fe.indexOf(Ye))&&kd.add(fe)}if(Tc)for(const fe in Tc){zd=(yb={key:fe,value:Tc[fe]},yb.key)?yb.key:"";const Ye=w.d(zd);F.a.any(bd,pf=>-1<Ye.indexOf(pf))&&
kd.add(String.format("{0}:{1}",zd,yb.value))}}return kd.toArray()}}Object(c.a)(La,"NewAugLoopRuntimeManager",null,[863]);var Z=a(81),la=a(50),da=a(1583),J=a(64),Ca=a(6);class Fa{}Object(c.a)(Fa,"Lambda",null,[935]);var ya=a(1218);class Ua{constructor(){this.documentOpenType=this.getItemsEndPoint=this.downloadUrl=null}}Object(c.a)(Ua,"PowerPointParameters",null,[]);class Ia{constructor(){this.initSessionCallback=null}}Object(c.a)(Ia,"SetInitSessionCallbackParameters",null,[]);class Oa{constructor(){this.sessionDataCallback=
this.handler=null}}Object(c.a)(Oa,"SetSessionDataCallbackParameters",null,[]);class ma{constructor(){this.handler=null}}Object(c.a)(ma,"SetSessionInitOverrideCallbackParameters",null,[]);var za=a(299),Qa=a(719),Xa=a(157);class Tb extends Qa.a{constructor(){super();this.isTriggeredBySyncDelta=null;this.H_=Object.assign(new Xa.a,{T_:Tb.getTypeName(),B_:Tb.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(c.a)(Tb,
"DeleteOperation",Qa.a,[]);var Kb=a(612),nb=a(327);class Ka extends nb.a{constructor(){super();this.bridgeId=this.cv=this.messageId=null;this.H_=Object.assign(new Xa.a,{T_:Ka.getTypeName(),B_:Ka.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}}Object(c.a)(Ka,"Message",nb.a,[]);class Sb extends Ka{constructor(){super();this.protocolVersion=0;this.enableRemoteExecutionNotification=this.enableSessionInspectorLogs=this.returnWorkflowInputTypes=
this.extensionConfigs=this.authToken=this.origin=this.sessionKey=this.serviceUrl=this.clientMetadata=null;this.H_=Object.assign(new Xa.a,{T_:Sb.getTypeName(),B_:Sb.getBaseTypes()})}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}}Object(c.a)(Sb,"SessionInitMessage",Ka,[]);class ab extends Sb{constructor(){super();this.documentOpenType=this.getItemsEndPoint=this.downloadUrl=null;this.H_=Object.assign(new Xa.a,
{T_:ab.getTypeName(),B_:ab.getBaseTypes()})}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}}Object(c.a)(ab,"PowerPointSessionInitMessage",Sb,[]);var ub=a(42);class Aa{constructor(){this.authToken=this.origin=this.sessionUrl=null}}Object(c.a)(Aa,"SessionData",null,[]);var tb=a(756),kc=a(1122);class dc{constructor(){this.qHh=new Map}M1l(yb,Tc){const bd=
this.qHh.get(yb);if(bd){var kd=bd.get(Tc);bd.delete(Tc);0===bd.size&&this.qHh.delete(yb);return kd}}Z$n(yb,Tc,bd){let kd=this.qHh.get(yb);kd||(kd=new Map,this.qHh.set(yb,kd));kd.set(Tc,bd)}}Object(c.a)(dc,"AugLoopSessionCallbackStorage",null,[]);var Db=a(210);class sb{constructor(yb){Db.a.assign(sb,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[sb.getTypeName()])}}sb.H_={T_:sb.getTypeName(),
B_:sb.getBaseTypes()};class Qb{constructor(yb){Db.a.assign(Qb,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[Qb.getTypeName()])}}Qb.H_={T_:Qb.getTypeName(),B_:Qb.getBaseTypes()};class $a{constructor(yb){Db.a.assign($a,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[$a.getTypeName()])}}$a.H_={T_:$a.getTypeName(),B_:$a.getBaseTypes()};class X{constructor(yb){Db.a.assign(X,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[X.getTypeName()])}}X.H_={T_:X.getTypeName(),B_:X.getBaseTypes()};class Ta{constructor(yb){Db.a.assign(Ta,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_RateLimitErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse",
"AugLoop_Session_Protocol_Response"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[Ta.getTypeName()])}}Ta.H_={T_:Ta.getTypeName(),B_:Ta.getBaseTypes()};class ca{constructor(yb){Db.a.assign(ca,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[ca.getTypeName()])}}ca.H_={T_:ca.getTypeName(),B_:ca.getBaseTypes()};class Ma{constructor(yb){Db.a.assign(Ma,
this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[Ma.getTypeName()])}}Ma.H_={T_:Ma.getTypeName(),B_:Ma.getBaseTypes()};class Ba{constructor(yb){Db.a.assign(Ba,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[Ba.getTypeName()])}}Ba.H_={T_:Ba.getTypeName(),B_:Ba.getBaseTypes()};class wa{constructor(yb){Db.a.assign(wa,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[wa.getTypeName()])}}wa.H_={T_:wa.getTypeName(),B_:wa.getBaseTypes()};class pa{constructor(yb){Db.a.assign(pa,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[pa.getTypeName()])}}pa.H_={T_:pa.getTypeName(),B_:pa.getBaseTypes()};class ta{constructor(yb){Db.a.assign(ta,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionSwapOnClose"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionCloseReason"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[ta.getTypeName()])}}ta.H_={T_:ta.getTypeName(),B_:ta.getBaseTypes()};class Wa{constructor(yb){Db.a.assign(Wa,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[Wa.getTypeName()])}}Wa.H_={T_:Wa.getTypeName(),B_:Wa.getBaseTypes()};class Pa{constructor(yb){Db.a.assign(Pa,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[Pa.getTypeName()])}}Pa.H_={T_:Pa.getTypeName(),B_:Pa.getBaseTypes()};class ib{constructor(yb){Db.a.assign(ib,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[ib.getTypeName()])}}ib.H_={T_:ib.getTypeName(),B_:ib.getBaseTypes()};class Ib{constructor(yb){Db.a.assign(Ib,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[Ib.getTypeName()])}}Ib.H_={T_:Ib.getTypeName(),B_:Ib.getBaseTypes()};class hc{constructor(yb){Db.a.assign(hc,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[hc.getTypeName()])}}hc.H_={T_:hc.getTypeName(),B_:hc.getBaseTypes()};class yc{constructor(yb){Db.a.assign(yc,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[yc.getTypeName()])}}yc.H_={T_:yc.getTypeName(),B_:yc.getBaseTypes()};class ob{constructor(yb){Db.a.assign(ob,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[ob.getTypeName()])}}ob.H_={T_:ob.getTypeName(),B_:ob.getBaseTypes()};class Bc{constructor(yb){Db.a.assign(Bc,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[Bc.getTypeName()])}}Bc.H_={T_:Bc.getTypeName(),B_:Bc.getBaseTypes()};class rb{constructor(yb){Db.a.assign(rb,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[rb.getTypeName()])}}rb.H_={T_:rb.getTypeName(),B_:rb.getBaseTypes()};class Eb{constructor(yb){Db.a.assign(Eb,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[Eb.getTypeName()])}}Eb.H_={T_:Eb.getTypeName(),B_:Eb.getBaseTypes()};class jc{constructor(yb){Db.a.assign(jc,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_BatchedMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[jc.getTypeName()])}}jc.H_={T_:jc.getTypeName(),B_:jc.getBaseTypes()};class ea{constructor(yb){Db.a.assign(ea,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[ea.getTypeName()])}}ea.H_={T_:ea.getTypeName(),B_:ea.getBaseTypes()};class ua{constructor(yb){Db.a.assign(ua,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[ua.getTypeName()])}}ua.H_={T_:ua.getTypeName(),B_:ua.getBaseTypes()};class Da{constructor(yb){Db.a.assign(Da,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[Da.getTypeName()])}}Da.H_={T_:Da.getTypeName(),B_:Da.getBaseTypes()};class Cb{constructor(yb){Db.a.assign(Cb,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[Cb.getTypeName()])}}Cb.H_={T_:Cb.getTypeName(),B_:Cb.getBaseTypes()};class Nb{constructor(yb){Db.a.assign(Nb,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[Nb.getTypeName()])}}Nb.H_={T_:Nb.getTypeName(),B_:Nb.getBaseTypes()};class fc{constructor(yb){Db.a.assign(fc,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[fc.getTypeName()])}}fc.H_={T_:fc.getTypeName(),B_:fc.getBaseTypes()};class fb{constructor(yb){Db.a.assign(fb,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[fb.getTypeName()])}}fb.H_={T_:fb.getTypeName(),B_:fb.getBaseTypes()};class Ub{constructor(yb){Db.a.assign(Ub,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[Ub.getTypeName()])}}Ub.H_={T_:Ub.getTypeName(),B_:Ub.getBaseTypes()};class Ec{constructor(yb){Db.a.assign(Ec,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[Ec.getTypeName()])}}Ec.H_={T_:Ec.getTypeName(),B_:Ec.getBaseTypes()};class Lc{constructor(yb){Db.a.assign(Lc,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[Lc.getTypeName()])}}Lc.H_={T_:Lc.getTypeName(),B_:Lc.getBaseTypes()};class vb{constructor(yb){Db.a.assign(vb,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[vb.getTypeName()])}}vb.H_={T_:vb.getTypeName(),B_:vb.getBaseTypes()};class ec{constructor(yb){Db.a.assign(ec,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Message"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[ec.getTypeName()])}}ec.H_={T_:ec.getTypeName(),B_:ec.getBaseTypes()};class lb{constructor(yb){Db.a.assign(lb,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Response"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[lb.getTypeName()])}}lb.H_={T_:lb.getTypeName(),B_:lb.getBaseTypes()};class Zb{constructor(yb){Db.a.assign(Zb,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[Zb.getTypeName()])}}Zb.H_={T_:Zb.getTypeName(),B_:Zb.getBaseTypes()};class qc{constructor(yb){Db.a.assign(qc,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[qc.getTypeName()])}}qc.H_={T_:qc.getTypeName(),B_:qc.getBaseTypes()};class pc{constructor(yb){Db.a.assign(pc,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[pc.getTypeName()])}}pc.H_={T_:pc.getTypeName(),B_:pc.getBaseTypes()};class ac{constructor(yb){Db.a.assign(ac,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[ac.getTypeName()])}}ac.H_={T_:ac.getTypeName(),B_:ac.getBaseTypes()};class gb{constructor(yb){Db.a.assign(gb,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionConnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[gb.getTypeName()])}}gb.H_={T_:gb.getTypeName(),B_:gb.getBaseTypes()};class Jb{constructor(yb){Db.a.assign(Jb,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDisconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[Jb.getTypeName()])}}Jb.H_={T_:Jb.getTypeName(),B_:Jb.getBaseTypes()};class uc{constructor(yb){Db.a.assign(uc,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_SessionReconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[uc.getTypeName()])}}uc.H_={T_:uc.getTypeName(),B_:uc.getBaseTypes()};class Cc{constructor(yb){Db.a.assign(Cc,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_SubmittedCustomMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[Cc.getTypeName()])}}Cc.H_={T_:Cc.getTypeName(),B_:Cc.getBaseTypes()};class Gc{constructor(yb){Db.a.assign(Gc,this,yb)}static getTypeName(){return"AugLoop_Session_Protocol_ServerAuthenticationStateChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,
[Gc.getTypeName()])}}Gc.H_={T_:Gc.getTypeName(),B_:Gc.getBaseTypes()};var dd=a(1891);class ld{constructor(yb,Tc,bd,kd){var zd;this.cqg=new Map;this.Ude=new Map;this.dqg=new Map;this.ZZe=new Map;this.GYc=this.Mmc=this.ood=this.oB=null;this.qwi=new dc;this.sFh=new Map;this.Vje=!1;this.Dcm=[];if(!yb)throw Error.argumentNull("augLoopRuntimeManager");if(!Tc)throw Error.argumentNull("applicationSettings");if(!bd)throw Error.argumentNull("outboundHelper");if(!kd)throw Error.argumentNull("pathManager");this.TB=
yb;this.Ea=Tc;this.Jm=bd;this.mf=kd;const fe=new P.a;fe.powerpoint=new Ua;yb=new P.a;ub.a("AL.SendNewInitParams")&&(yb.serviceUrl=null!==(zd=Object(kc.a)(Tc))&&void 0!==zd?zd:void 0);if(ub.a("AL.SendSlideTile"))if(ub.a("AL.EnableRehydration"))this.TB.initialize(yb),this.TB.setInitSessionCallback(Object.assign(new Ia,{initSessionCallback:Object(Ca.a)(this,this.$Tn,"onSessionInit")})),this.TB.setSessionInitOverrideCallback(Object.assign(new ma,{handler:Object(Ca.a)(this,this.aUn,"onSessionInitOverride")})),
this.GYc=this.ENh(),this.TB.setAnnotationResultCallback(Object(Ca.a)(this,this.onAnnotationResult,"onAnnotationResult")),this.PIa=Promise.resolve(null);else{Tc=la.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;zd=la.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").ym;Tc=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",zd,Tc);zd=la.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").rwa?la.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").Ufb:
la.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").ym;var Ye=String.format("{0}getitems.ashx",zd);zd=new da.a(d.AFrameworkApplication.$d);this.PIa=tb.b(zd.t5e(Tc,1,"",0));this.PIa.then(pf=>{try{const Je=JSON.parse(pf),Ff=Je.downloadUrl;J.a.wb(Ff)?b.ULS.sendTraceTag(509112976,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",Je):(fe.powerpoint.downloadUrl=Ff,fe.powerpoint.getItemsEndPoint=Ye,this.Ea.oFc&&(fe.powerpoint.documentOpenType=this.E3l()))}catch(Je){b.ULS.sendTraceTag(509112975,
306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",Je)}this.TB.initialize(fe);this.GYc=this.ENh();this.TB.setAnnotationResultCallback(Object(Ca.a)(this,this.onAnnotationResult,"onAnnotationResult"));return null}).catch(pf=>{b.ULS.sendTraceTag(509112974,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",pf);this.TB.initialize(fe);this.GYc=this.ENh();this.TB.setAnnotationResultCallback(Object(Ca.a)(this,this.onAnnotationResult,"onAnnotationResult"))})}else this.PIa=
new Promise(pf=>{this.TB.initialize(fe);this.GYc=this.ENh();this.TB.setAnnotationResultCallback(Object(Ca.a)(this,this.onAnnotationResult,"onAnnotationResult"));pf("")})}Zmc(yb){this.Dcm.push(yb)}v2(yb){this.PIa.then(Tc=>{if(!this.sFh.has(yb))return this.TB.activateAnnotation(Object.assign(new ya.a,{annotationType:yb})),this.sFh.set(yb,Tc),Tc})}releaseAnnotation(yb){return Object(Z.b)(this,void 0,void 0,function*(){yield this.PIa;var Tc=this.sFh.get(yb);return Tc?((Tc=yield this.TB.releaseAnnotation({token:Tc}))&&
this.sFh.delete(yb),Tc):!1})}ZFa(yb,Tc){if(yb)if(Tc){if(this.cqg.has(yb))var bd=this.cqg.get(yb);else bd=new n.a,this.cqg.set(yb,bd);bd&&!bd.contains(Tc)&&bd.add(Tc)}else b.ULS.sendTraceTag(509112972,306,15,"AnnotationHandler is null");else b.ULS.sendTraceTag(509112973,306,15,"Annotation Type is null or empty")}ftm(yb,Tc){if(yb)if(Tc){if(this.dqg.has(yb))var bd=this.dqg.get(yb);else bd=new n.a,this.dqg.set(yb,bd);bd&&!bd.contains(Tc)&&bd.add(Tc)}else b.ULS.sendTraceTag(509116945,306,15,"AnnotationHandler is null");
else b.ULS.sendTraceTag(509116947,306,15,"Annotation Type is null or empty")}gtm(yb,Tc){if(yb)if(Tc){if(this.Ude.has(yb))var bd=this.Ude.get(yb);else bd=new n.a,this.Ude.set(yb,bd);bd&&!bd.contains(Tc)&&bd.add(Tc)}else b.ULS.sendTraceTag(509112970,306,15,"AnnotationHandler is null");else b.ULS.sendTraceTag(509112971,306,15,"Annotation Type is null or empty")}addEventHandler(yb,Tc){this.PIa.then(()=>{this.TB.addEventHandler(yb,Tc);return null})}removeEventHandler(yb,Tc){this.PIa.then(()=>{this.TB.removeEventHandler(yb,
Tc);return null})}registerSimpleLocalWorkflow(yb,Tc){return this.PIa.then(()=>this.TB.registerSimpleLocalWorkflow(yb,this.E1h(Tc)))}registerSimpleRemoteWorkflow(yb,Tc,bd,kd){return this.PIa.then(()=>this.TB.registerSimpleRemoteWorkflow(yb,this.E1h(Tc),this.E1h(bd),this.E1h(kd)))}submit(yb,Tc){this.Ea.qna||this.PIa.then(()=>{this.TB.submit(yb,Tc);return null})}submitOperation(yb){this.PIa.then(()=>{this.TB.submitOperation(yb);return null})}Zan(yb,Tc){return this.GYc.then(()=>Object(Z.b)(this,void 0,
void 0,function*(){return yield fetch(this.Mmc.sessionUrl,{method:"POST",headers:{"Content-Type":"application/jsond","X-Origin":this.Mmc.origin,Authorization:`Bearer ${this.Mmc.authToken}`},body:dd.a.serialize(yb),signal:Tc.signal})}))}xho(yb,Tc=1E4){return Object(Z.b)(this,void 0,void 0,function*(){const bd=new AbortController,kd=window.setTimeout(()=>{bd.abort()},Tc);try{if(!(yield this.Zan(yb,bd)).ok)throw Error("Network response was not ok");}catch(zd){if(zd instanceof DOMException&&"AbortError"===
zd.name)throw Error("Request timed out");throw zd;}finally{clearTimeout(kd)}})}submitBinarySignal(yb,Tc,bd,kd,zd=1E4){return Object(Z.b)(this,void 0,void 0,function*(){this.GYc.then(()=>Object(Z.b)(this,void 0,void 0,function*(){this.qwi.Z$n(Tc,kd,bd);void 0!==this.TXm&&clearInterval(this.TXm);try{yield this.xho(new ua({parentPath:["session","img"],item:{id:kd,body:yb}}),zd)}catch(fe){throw this.qwi.M1l(Tc,kd),fe;}}))})}Wan(yb){return this.GYc.then(()=>fetch(`${this.Mmc.sessionUrl}/blob/${yb}`,{headers:{"X-Origin":this.Mmc.origin,
Authorization:`Bearer ${this.Mmc.authToken}`}}))}getBlob(yb,Tc=1E4){return Object(Z.b)(this,void 0,void 0,function*(){const bd=new AbortController,kd=window.setTimeout(()=>{bd.abort()},Tc);yield this.PIa;try{const zd=yield this.Wan(yb);if(!zd.ok)throw Error("Network response was not ok");return zd.blob()}catch(zd){if(zd instanceof DOMException&&"AbortError"===zd.name)throw Error("Request timed out");throw zd;}finally{clearTimeout(kd)}})}hno(yb,Tc,bd,kd,zd){this.GYc&&this.GYc.then(()=>{this.Jm.augmentImage(yb,
Tc,bd,!0,this.Mmc.sessionUrl,this.Mmc.origin,this.Mmc.authToken,kd,zd);return null})}aUn(yb){b.ULS.sendTraceTag(509112969,306,50,"PPTAugLoopRuntimeManager: OnSessionInitOverride");const Tc=Object.assign(new ab,{protocolVersion:yb.protocolVersion,clientMetadata:yb.clientMetadata,sessionKey:yb.sessionKey,origin:yb.origin,authToken:yb.authToken,messageId:yb.messageId,cv:yb.cv,fileUrl:this.mf.documentUrl});try{this.Ea.oFc&&(Tc.documentOpenType=this.E3l())}catch(bd){b.ULS.sendTraceTag(509112968,306,10,
"PPTWebEditorAugLoopRunTimeManager::OnSessionInitOverride exception:{0}",bd)}this.eym(yb);if(J.a.wb(this.oB)||J.a.wb(this.ood))return b.ULS.sendTraceTag(509112967,306,15,"PPTAugLoopRuntimeManager: Failed to override sessionInitMessage, null or empty downloadUrl obtained"),yb;Tc.downloadUrl=this.oB;Tc.getItemsEndPoint=this.ood;this.ood=this.oB=null;return Tc}$Tn(){b.ULS.sendTraceTag(509112966,306,50,"PPTAugLoopRuntimeManager: OnSessionInit");this.Vje=!0;if(ub.a("AugLoopSessionCreationCallback"))for(var yb of this.Dcm)yb();
var Tc=la.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;const bd=la.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").ym;yb=la.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").rwa?la.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").Ufb:la.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").ym;Tc=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",bd,Tc);const kd=String.format("{0}getitems.ashx",
yb);yb=new da.a(d.AFrameworkApplication.$d);return tb.b(yb.t5e(Tc,1,"",0)).then(zd=>{try{const fe=JSON.parse(zd),Ye=fe.downloadUrl;J.a.wb(Ye)?b.ULS.sendTraceTag(509112965,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",fe):(this.oB=Ye,this.ood=kd)}catch(fe){b.ULS.sendTraceTag(509112964,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",fe)}return null}).catch(zd=>{b.ULS.sendTraceTag(509112963,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",
zd)})}ENh(){return new Promise(yb=>{this.TB.setSessionDataCallback(Object.assign(new Oa,{sessionDataCallback:(Tc,bd,kd)=>{this.Mmc=Object.assign(new Aa,{sessionUrl:Tc,origin:bd,authToken:kd});yb(null)}}))})}Ynn(yb,Tc,bd){yb=this.qwi.M1l(yb,Tc);void 0!==yb&&yb(bd)}onAnnotationResult(yb){if(yb&&yb.items)if(this.Ea.qna&&this.c$n(yb),nb.a.getTypeNameFor(yb)!==za.a.getTypeName()&&nb.a.getTypeNameFor(yb)!==Kb.a.getTypeName())this.Ea.w2i&&nb.a.getTypeNameFor(yb)===Tb.getTypeName()&&this.dRn(yb);else for(const bd of yb.items){if(!bd||
!bd.body)continue;const kd=nb.a.getTypeNameFor(bd.body);if(!kd)continue;var Tc=bd.body||{};yb.parentPath&&(Tc.parentPath=yb.parentPath);let zd;if(this.cqg.has(kd)){if(zd=this.cqg.get(kd))for(const fe of zd)fe(Tc)}else b.ULS.sendTraceTag(509112962,306,50,"Cannot find handlers for annotation:{0};",kd);kd&&yb.parentPath&&this.Ynn(kd,yb.parentPath[2],bd.body);if(this.Ea.w2i){if(this.Ude.has(kd)&&(Tc=this.Ude.get(kd)))for(const fe of Tc)fe(bd,!1);J.a.wb(bd.id)||this.ZZe.set(bd.id,kd)}}}c$n(yb){const Tc=
new Map,bd=nb.a.getTypeNameFor(yb)!==za.a.getTypeName()&&nb.a.getTypeNameFor(yb)!==Kb.a.getTypeName();for(var kd of yb.items){yb=bd&&this.ZZe.has(kd.id)?this.ZZe.get(kd.id):nb.a.getTypeNameFor(kd.body);let zd;Tc.has(yb)?zd=Tc.get(yb):(zd=new n.a,Tc.set(yb,zd));zd.add(kd)}for(const zd of Tc.keys())if(this.dqg.has(zd)){if(kd=this.dqg.get(zd))for(const fe of kd)fe(Tc.get(zd).toArray(),bd)}else b.ULS.sendTraceTag(509116952,306,50,"Cannot find handlers for annotation:{0};",zd)}dRn(yb){for(const Tc of yb.items)if(Tc&&
Tc.id&&this.ZZe.has(Tc.id)){yb=this.ZZe.get(Tc.id);if(this.Ude.has(yb)&&(yb=this.Ude.get(yb)))for(const bd of yb)bd(Tc,!0);this.ZZe.delete(Tc.id)}}E1h(yb){return yb?Object.assign(new Fa,{name:yb.name,inputSchema:yb.inputSchema,outputSchema:yb.outputSchema,func:yb.func}):null}E3l(){try{return this.Ea.isCreateNew?0:this.Ea.v7a?2:1}catch(yb){return b.ULS.sendTraceTag(509112961,306,50,"PPTWebEditorAugLoopRunTimeManager::GetOpenType :{0};",yb),2}}eym(yb){try{J.a.wb(yb.clientMetadata.flights)?yb.clientMetadata.flights=
";":yb.clientMetadata.flights+=";",this.Ea.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",!1)?yb.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Treatment;":yb.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Control;",this.Ea.getBooleanAppSetting("ChatPPTCIQDocMenuEnabled")&&(yb.clientMetadata.flights+="PPTOChatPPTCIQDocMenuEnabled;ciq.user-init.enabled:true;",
yb.clientMetadata.flights+="mc-editor-oa;mc-editor-oa-ecc-annotation;"),this.Ea.getBooleanAppSetting("StorytellerCiqEnabled")&&(yb.clientMetadata.flights+="mc-editor-oa;mc-editor-oa-ecc-annotation;"),this.Ea.Hgb&&(yb.clientMetadata.flights+="StorytellerBypassLicenseCheckEnabled;"),this.Ea.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CopilotRewrite",!1)&&ub.a("RewriteBypassLicenseCheckEnabled")&&(yb.clientMetadata.flights+="RewriteBypassLicenseCheckEnabled;")}catch(Tc){b.ULS.sendTraceTag(509112960,
306,50,"PPTWebEditorAugLoopRunTimeManager::SetFlights :{0};",Tc)}}}Object(c.a)(ld,"PPTAugLoopRuntimeManager",null,[862]);class bc{constructor(yb){this.bDa=yb;this.bDa.initialize()}addEventHandler(yb,Tc){this.bDa.addEventHandler(yb,Tc)}removeEventHandler(yb,Tc){this.bDa.removeEventHandler(yb,Tc)}v7k(yb,Tc,bd){this.bDa.v7k(yb,Tc,bd)}T4e(yb,Tc,bd,kd,zd,fe=null){this.bDa.T4e(yb,Tc,bd,kd,zd,fe)}}Object(c.a)(bc,"PPTAugmentationManager",null,[858]);var cc=a(380),Vc=a(132);class td{constructor(yb){Db.a.assign(td,
this,yb)}static getTypeName(){return"AugLoop_Chat_ChatsHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[td.getTypeName()])}}td.H_={T_:td.getTypeName(),B_:td.getBaseTypes()};class Xc{constructor(yb){Db.a.assign(Xc,this,yb)}static getTypeName(){return"AugLoop_Chat_Chat"}static getBaseTypes(){return[]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[Xc.getTypeName()])}}Xc.H_={T_:Xc.getTypeName(),B_:Xc.getBaseTypes()};class ne{constructor(yb){Db.a.assign(ne,
this,yb)}static getTypeName(){return"AugLoop_Chat_MessagesHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[ne.getTypeName()])}}ne.H_={T_:ne.getTypeName(),B_:ne.getBaseTypes()};class Vd{constructor(yb){Db.a.assign(Vd,this,yb)}static getTypeName(){return"AugLoop_Chat_ChatMessage"}static getBaseTypes(){return[]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[Vd.getTypeName()])}}Vd.H_={T_:Vd.getTypeName(),B_:Vd.getBaseTypes()};class Ja{constructor(yb){Db.a.assign(Ja,
this,yb)}static getTypeName(){return"AugLoop_Chat_TextChatMessage"}static getBaseTypes(){return["AugLoop_Chat_ChatMessage"]}static typeGuard(yb){return Db.a.matchesTypesFor(yb,[Ja.getTypeName()])}}Ja.H_={T_:Ja.getTypeName(),B_:Ja.getBaseTypes()};var Lb=a(40);class fa{constructor(yb){this.zM=yb;yb.body&&(yb=yb.body,this.ID=yb.id,this.Status=yb.status,this.Text=yb.text,this.B5h=this.gln())}gln(){return this.zM.parentPath&&0<this.zM.parentPath.length?this.zM.parentPath[this.zM.parentPath.length-1]:""}}
Object(c.a)(fa,"ALChatHelperResponse",null,[920]);class Na{constructor(yb,Tc){this.KFn=0;this.hhm=new Map;this.TB=Tc;const bd=["session","chats"],kd=(new cc.a(Vc.a.create(),1)).toString(),zd=[...bd,kd];this.zFn=[...zd,"messages"];this.TB.execute(fe=>{fe.submitOperation(Na.COi(bd,kd,yb.PHb));fe.submitOperation(Na.COi(zd,"messages",new ne));fe.v2(yb.responseType);fe.gtm(yb.responseType,this.gra.bind(this))})}gra(yb){yb=new fa(yb);if(yb.B5h){const Tc=this.hhm.get(yb.B5h);if(Tc){Tc(yb);this.hhm.delete(yb.B5h);
return}}this.VDn?this.VDn(yb):Lb.a.$(509366417,822,15,"No handler found")}send(yb){const Tc=`${this.KFn++}`;this.TB.execute(bd=>{bd.submitOperation(Na.COi(this.zFn,Tc,yb))})}static COi(yb,Tc,bd){return Object.assign(new za.a,{parentPath:yb,items:[{id:Tc,body:bd}]})}}Object(c.a)(Na,"ALChatHelper",null,[888]);class ha{constructor(yb){this.hQh=yb}create(yb){return new Na(yb,this.hQh)}}Object(c.a)(ha,"ALChatHelperFactory",null,[857]);var sa=a(30);class xa{constructor(){this.osl="TML";this.HUk="RTA";this.Nll=
"SR";this.xa=new sa.a}RVm(yb){this.xa.addHandler(this.osl,yb)}Q6n(yb){this.xa.removeHandler(this.osl,yb)}f3n(yb){this.xa.raiseEvent(this.osl,yb)}qVm(yb){this.xa.addHandler(this.HUk,yb)}x6n(yb){this.xa.removeHandler(this.HUk,yb)}HXh(yb){this.xa.raiseEvent(this.HUk,yb)}yVm(yb){this.xa.addHandler(this.Nll,yb)}F6n(yb){this.xa.removeHandler(this.Nll,yb)}KXh(yb){this.xa.raiseEvent(this.Nll,yb)}}Object(c.a)(xa,"TilingEventSource",null,[854,855,856]);class pb{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.AugmentationLoop"}oc(yb){this.ga=
yb;this.ga.register(bc,"PowerPointWebEditor.AugmentationLoop.PPTAugmentationManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager").oa().pa(()=>new bc(new u(d.AFrameworkApplication.$d,yb.resolve("Common.IAppSettingsManager"),"PowerPoint_Online")));this.ga.register(ld,"PowerPointWebEditor.AugmentationLoop.PPTAugLoopRuntimeManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").oa().pa(()=>{const Tc=e.a.Aam();b.ULS.sendTraceTag(509441561,306,50,"IsWebSocketSupported: {0}",
Tc);d.AFrameworkApplication.ha.appSettings.AugLoopUseWebSocket=Tc.toString();return new ld(new La(yb.resolve("Common.ISharedDependencyLoader"),yb.eb("Common.App.OAuth.IOAuthManager")),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.ga.resolve("PowerPoint.IPathManager"))});Object(ub.a)("EnableALChatHelper")&&this.ga.register(ha,"PowerPointWebEditor.AugmentationLoop.ALChatHelperFactory").as("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory").oa().pa(()=>
new ha(this.ga.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")));this.ga.register(xa,"PowerPointWebEditor.AugmentationLoop.TilingEventSource").as("PowerPointWebEditor.AugmentationLoop.ITilingEventNotifier").as("PowerPointWebEditor.AugmentationLoop.ITilingEventHandlers").as("PowerPointWebEditor.AugmentationLoop.ITilingEventSource").oa().pa(()=>new xa)}init(){this.ga.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager");this.ga.resolve("PowerPointWebEditor.IApplicationSettings").Gye&&
(this.ga.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),Object(ub.a)("EnableALChatHelper")&&this.ga.resolve("PowerPointWebEditor.AugmentationLoop.IALChatHelperFactory"))}dispose(){}static main(){h.a.instance.Jc(new pb)}}Object(c.a)(pb,"PPTWebEditorAugmentationLoopPackage",null,[4,5]);var Rb=a(38),Fc=a(1219),Kc=a(1217),jb=a(771),zb=a(78),ic=a(47);class bb{constructor(yb){if(!yb)throw Error.argumentNull("Handler for Text Prediction is Null- unable to retrieve initial text prediction signal state");
this.n$a=yb}JXe(yb){this.Xth(yb)}Xth(yb){if(yb){try{const zd=yb.parentPath;if(!zd||4>zd.length){Lb.a.$(507843231,820,50,"ParentPath is Null or Empty.");return}const fe=zd[3];var Tc=zd[2];if(!fe){Lb.a.$(507843230,820,50,"Unable to retreive original paragraph text");return}var bd=this.n$a.Whn(fe);this.n$a.X5n(fe);const Ye=yb.predictions;if(!Ye||!Ye.length){Lb.a.$(507843229,820,50,"Augloop Annotations Null or Empty.");return}const pf=Ye[0];if(!pf)return;var kd=pf.text;if(!kd||!kd.length){Lb.a.$(507843228,
820,50,"Text Predictions Null or Empty.");return}}catch(zd){Lb.a.$(507843227,820,10,"Unable to parse output because of modified output type from Augloop");return}kd&&bb.D8m(kd,bd,Tc)}else Lb.a.$(507843232,820,50,"Annotations returned from service is null.")}static D8m(yb,Tc,bd){yb&&yb.length&&(Tc=bb.Zjn(yb,Tc),-1!==Tc&&(Tc=yb.substring(Tc,yb.length),bd=Object.assign(new Kc.a,{text:yb,ica:Tc,ly:bd}),jb.a.sG.cea=bd,jb.a.nAf(yb,Tc)))}static Zjn(yb,Tc){var bd=zb.a.instance.Wa.qb.vf.node;if(!bd||!Tc)return-1;
bd=ic.ParagraphReader.text(bd);if(!bd)return-1;if(bd!==Tc)if(bd.length>Tc.length&&bd.substring(0,Tc.length)===Tc){if(!yb.startsWith(bd.substring(Tc.length,bd.length-Tc.length)))return-1;Lb.a.$(507843226,820,50,"Ghost Text matches part of the Prediction Text.")}else return-1;return" "===bd.substring(bd.length-1,1)?0:bb.qkj(bd)}static qkj(yb){return yb?yb.length-1-yb.lastIndexOf(" "):-1}}Object(c.a)(bb,"TextPredictionAugLoopResponseManager",null,[]);var Pb=a(286);class wc extends Qa.a{constructor(){super();
this.H_=Object.assign(new Xa.a,{T_:wc.getTypeName(),B_:wc.getBaseTypes()})}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(c.a)(wc,"SignalOperation",Qa.a,[]);var Dc=a(858);class ed{constructor(){this.UKk=!1}}Object(c.a)(ed,"PredictionSettings",null,[]);class ad{constructor(yb,Tc){this.sTh=null;this.fek={};this.TB=yb;this.Gb=Tc;this.Gb.did(Object(Ca.a)(this,this.u6l,"handleResize"))}Whn(yb){return this.fek[yb]}Vao(yb,Tc){this.fek[yb]=
Tc}X5n(yb){yb&&delete this.fek[yb]}get settings(){this.sTh||(this.sTh=Object.assign(new ed,{UKk:!1}));return this.sTh}set settings(yb){this.sTh=yb}rko(yb){if(this.settings.UKk&&yb){var Tc=yb.id.toString(),bd=jb.a.sG.cea,kd=zb.a.instance.Wa.qb;if(kd&&1===kd.length&&kd.vf){kd=kd.vf;var zd=kd.node;if(ic.ParagraphReader.textLength(zd)===kd.Xa){if(bd&&zd&&Tc===bd.ly&&Tc===zd.id.toString()&&(kd=this.G1f(bd,zd))){bd.ica=kd;jb.a.nAf(bd.text,kd);return}jb.a.sG.cea=null;bd=Vc.a.create().toString();kd=ic.ParagraphReader.text(yb);
this.Vao(bd,kd);yb=["Signal",Dc.a.getTypeName(),Tc,bd];bd=ad.gjn(kd);Tc=[Object.assign(new Pb.a,{id:Tc,body:bd})];var fe=Object.assign(new wc,{parentPath:yb,items:Tc});this.TB.execute(Ye=>{Ye.submitOperation(fe);Lb.a.$(512493778,820,50,"TextPrediction Signal sent to Augloop Service")})}}}}u4e(){jb.a.sG.cea=null;jb.a.U5a()}ppn(yb){!yb||1<yb.length?this.u4e():1>yb.length||((yb=yb[0])&&yb.context?(yb=yb.context,yb.Xa===yb.Mb&&ic.ParagraphReader.textLength(yb.node)===yb.Xa||this.u4e()):this.u4e())}G1f(yb,
Tc){var bd=null;if(yb&&Tc){Tc=ic.ParagraphReader.text(Tc);yb=yb.text;if(!Tc||!yb)return bd;Tc=Tc.replace(RegExp("\\u00a0","g")," ");yb=yb.replace(RegExp("\\u00a0","g")," ");if(Tc){if(Tc.endsWith(yb))return this.u4e(),bd;bd=ad.vjn(Tc,yb);bd=yb.substring(bd,yb.length)}}return bd}u6l(){jb.a.U5a()}dispose(){this.Gb.Srd(Object(Ca.a)(this,this.u6l,"handleResize"))}static gjn(yb){return Object.assign(new Dc.a,{languageId:"en-US",startOfSentence:!0,text:yb})}static vjn(yb,Tc){for(let bd=Tc.length;0<bd;bd--){const kd=
Tc.substring(0,bd);if(yb.endsWith(kd.trimStart()))return kd.length}return 0}}ad.vYa=!1;Object(c.a)(ad,"TextPredictionHandler",null,[956]);var Gd=a(68),Od=a(44);class Ld{constructor(yb,Tc){this.la=yb;this.rc=Tc}Kb(){this.la.Ba(Od.a.qrm,Gd.a.application,Object(Ca.a)(this,this.X0n,"predictionHandler"))}X0n(yb,Tc,bd){return d.AFrameworkApplication.ha.getBooleanAppSetting("PPTOTextPredictionIsEnabled")?1===bd?this.rc.zl()?32:2:8:8}}Object(c.a)(Ld,"TextPredictorActor",null,[]);class ee{constructor(){this.fok=
this.ga=null}get name(){return"PowerPointWebEditor.TextPrediction"}oc(yb){this.ga=yb;yb.register(Ld,"PowerPointWebEditor.TextPrediction.TextPredictorActor").oa().pa(()=>new Ld(yb.resolve("Common.IActionManagerExtended"),yb.resolve("PowerPointWebEditor.IPresentationReader")));yb.register(956,"PowerPointWebEditor.TextPrediction.ITextPredictionHandler").oa().pa(()=>new ad(yb.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),yb.resolve("PowerPointWebEditor.Core.IPPTAppFrame")))}init(){this.ga.resolve("PowerPointWebEditor.TextPrediction.TextPredictorActor").Kb();
this.fok=new Rb.a(()=>new bb(this.ga.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));this.ga.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(yb=>{yb.v2(Fc.a.getTypeName());yb.ZFa(Fc.a.getTypeName(),Object(Ca.a)(this.fok.value,this.fok.value.JXe,"handleResponse"))})}dispose(){}static main(){h.a.instance.Jc(new ee)}}Object(c.a)(ee,"TextPredictionPackage",null,[4,5]);var Ce=a(324),Pc=a(43);class Yc{}Object(c.a)(Yc,"AugContextId",null,[]);class Bd{}
Object(c.a)(Bd,"AugParagraph",null,[]);class Dd{}Object(c.a)(Dd,"AugShape",null,[]);class Sd{}Object(c.a)(Sd,"ShapeTextTile",null,[]);class He{constructor(yb,Tc,bd,kd){this.La=bd;this.Rj=kd;this.Vb=yb;this.Wn=Tc}lVe(yb,Tc){return yb&&yb.isConnected&&this.La.yYa(yb)?(yb=Object(r.a)(351,yb))?Object.assign(new Sd,{Topic:"ShapeText",ContextId:k.c(He.v2m(yb,Tc)),Data:k.c(this.w2m(yb))}):null:null}BKf(yb){return yb&&yb.get_shapeId()&&yb.hasText&&!yb.isLocked?yb.QYe:!1}w2m(yb){const Tc=[];yb=this.Vb.Lc(yb);
for(yb=this.Wn.lfa(yb,yb.currentNode);yb.moveNext();){var bd=yb.currentNode;const kd=bd;this.Rj.ue(kd)&&(bd=Object.assign(new Bd,{t:this.Rj.text(kd),l:this.Rj.gbc(bd)}),Array.add(Tc,bd))}return Object.assign(new Dd,{p:Tc,c:Ce.a.Le(d.AFrameworkApplication.lcid).Lfb})}static v2m(yb,Tc){return Object.assign(new Yc,{gid:yb.id,sid:yb.slideSid,cid:yb.slideCid,shapeId:yb.get_shapeId(),rid:(yb.pnd||yb.DYa||Pc.App.Qp).toString(),t:Tc,c:(new Date).getTime()})}}Object(c.a)(He,"ShapeTextTileManager",null,[957,
985]);var ge=a(17),ve=a(1727),ze=a(99),bf;(function(yb){yb[yb.none=0]="none";yb[yb.onParagraphPropertyChanged=1]="onParagraphPropertyChanged";yb[yb.onSelectionFinished=2]="onSelectionFinished";yb[yb.onActiveSlideDomReady=4]="onActiveSlideDomReady";yb[yb.onShapeChildTopologyChanged=8]="onShapeChildTopologyChanged";yb[yb.onParagraphDisconnect=16]="onParagraphDisconnect";yb[yb.onNumberListPropertyChanged=32]="onNumberListPropertyChanged";yb[yb.onNumberListDisconnect=64]="onNumberListDisconnect";yb[yb.onSlideConnected=
128]="onSlideConnected";yb[yb.onSlideDisconnected=256]="onSlideDisconnected";yb[yb.onRefreshTileAnnotations=512]="onRefreshTileAnnotations";yb[yb.onSlideReorder=1024]="onSlideReorder"})(bf||(bf={}));Object(c.b)("EventNames",bf);class Of{constructor(){this.ydd=this.graphNode=null;this.tnd=0;this.nsl=null}}Object(c.a)(Of,"TileGraphNode",null,[]);class Qf{constructor(){this.Nwm=this.C5k=this.dwj=this.E5l=0}}Object(c.a)(Qf,"TileTelemetry",null,[]);var Oe;(function(yb){yb[yb.unknown=0]="unknown";yb[yb.activeSlideChanged=
1]="activeSlideChanged";yb[yb.shapeSelected=2]="shapeSelected";yb[yb.listLevelChanged=3]="listLevelChanged";yb[yb.richEditTextUnicodeChanged=4]="richEditTextUnicodeChanged";yb[yb.shapeChildTopologyChanged=5]="shapeChildTopologyChanged";yb[yb.paragraphDeleted=6]="paragraphDeleted";yb[yb.numberListDeleted=7]="numberListDeleted";yb[yb.numberListPropertyChanged=8]="numberListPropertyChanged";yb[yb.slideAdded=9]="slideAdded";yb[yb.slideDeleted=10]="slideDeleted";yb[yb.refreshTileAnnotations=11]="refreshTileAnnotations";
yb[yb.slideReorder=12]="slideReorder"})(Oe||(Oe={}));Object(c.b)("TriggerName",Oe);var tg=a(610);class Cf{constructor(yb,Tc,bd,kd){this.Rnm=(zd,fe)=>{zd=new tg.a(!1,null,fe.Ia);this.sIb(zd,4)};this.Yb=Tc;this.wEn=bd;this.jHn=yb;this.qok={};this.Ktg={};this.Gb=kd}initialize(){this.Oz()}dispose(){this.wJa()}onParagraphPropertyChanged(yb,Tc){this.sIb(Tc,1)}gnc(yb,Tc){this.sIb(Tc,2)}onActiveSlideDomReady(yb,Tc){this.sIb(Tc,4)}onShapeChildTopologyChanged(yb,Tc){this.sIb(Tc,8)}iKb(yb,Tc){this.sIb(Tc,16)}get xX(){return this.jHn}get yNa(){return this.qok}get DWb(){return this.Ktg}sIb(yb,
Tc){try{if(2===this.Gb.mode&&Object(ve.a)(bf,Tc)in this.qok){var bd=Date.now();Object(r.a)(995,this.qok[Object(ve.a)(bf,Tc)]).dYa(yb,(kd,zd)=>{this.fRn(kd,zd,bd)})}}catch(kd){Lb.a.$(508879877,306,10,"Exception thrown at DetectTiles: "+kd)}}fRn(yb,Tc,bd){if(!F.a.wb(yb))try{for(const kd of yb){if(!ge.a.count(this.Ktg)){const Ye=new ze.a(3,1,this.wEn,Object(Ca.a)(this,this.fireTileEvents,"fireTileEvents"),90,"24");this.Yb.Rb(Ye)}let zd;if(kd.id.toString()in this.Ktg)zd=Object(r.a)(Of,this.Ktg[kd.id.toString()]),
zd.tnd=Tc;else{const Ye=new Qf;zd=Object.assign(new Of,{graphNode:kd,tnd:Tc,ydd:{},nsl:Ye});this.Ktg[kd.id.toString()]=zd;this.UPn(Ye,bd)}const fe=Oe[Tc];zd.ydd[fe]=(fe in zd.ydd?zd.ydd[fe]:0)+1}}catch(kd){Lb.a.$(508879876,306,10,"Exception thrown at FireTiles: "+kd)}}UPn(yb,Tc){yb&&(yb.E5l=Tc,yb.dwj=Date.now())}Kkm(yb,Tc){yb&&(yb.C5k=Tc,yb.Nwm=Date.now())}t1l(yb){return yb?String.format("GraphDetectDuration: {0}, QueueDuration: {1}, ScanGraphSpaceDuration: {2}",yb.dwj-yb.E5l,yb.C5k-yb.dwj,yb.Nwm-
yb.C5k):""}}Object(c.a)(Cf,"TileTriggerControllerBase",null,[996,40]);class oe extends Cf{constructor(yb,Tc,bd,kd,zd,fe,Ye,pf,Je,Ff,Cg,sh,Og){super(Ye&31,pf,Ff,sh);this.Wwa=yb.Xd(12);this.AR=yb.Xd(10);this.sa=Tc;this.od=bd;this.bDa=kd;this.g4=zd;this.CSa=fe;this.ya=Je;this.JEa=Cg;this.wHn=Og}Oz(){1===(this.xX&1)&&(this.Wwa.Rm(Object(Ca.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.yNa[Object(ve.a)(bf,1)]=this.JEa.A5m());2===(this.xX&2)&&(this.sa.AO(Object(Ca.a)(this,
this.gnc,"onProcessSetSelectionFinished")),this.yNa[Object(ve.a)(bf,2)]=this.JEa.B5m());4===(this.xX&4)&&(this.od.Hha(Object(Ca.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.yNa[Object(ve.a)(bf,4)]=this.JEa.y5m());8===(this.xX&8)&&(this.AR.rH(Object(Ca.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.yNa[Object(ve.a)(bf,8)]=this.JEa.C5m());16===(this.xX&16)&&(this.Wwa.Seb(Object(Ca.a)(this,this.iKb,"onBeforeParagraphDisconnect")),this.yNa[Object(ve.a)(bf,
16)]=this.JEa.z5m())}wJa(){this.Wwa.rr(Object(Ca.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.sa.gib(Object(Ca.a)(this,this.gnc,"onProcessSetSelectionFinished"));this.od.Cbb(Object(Ca.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.AR.MQ(Object(Ca.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"));this.Wwa.eib(Object(Ca.a)(this,this.iKb,"onBeforeParagraphDisconnect"))}fireTileEvents(){try{if(this.ya&&this.ya.Ia){var yb=this.ya.Ia.Nj();
for(const Tc of yb){const bd=Tc.id.toString();bd in this.DWb&&(this.MWf(Object(r.a)(Of,this.DWb[bd])),delete this.DWb[bd])}ge.a.forEach(this.DWb,Tc=>{delete this.DWb[Tc]},null)}}catch(Tc){Lb.a.$(507843605,306,10,"Exception thrown at FireTileEvents: "+Tc)}}MWf(yb){if(yb){var Tc=Date.now(),bd=this.CSa.lVe(yb.graphNode,Oe[yb.tnd]);if(bd){this.wHn?this.g4.execute(zd=>{zd.submit("ShapeTextTile",bd)}):this.bDa.execute(zd=>{zd.v7k(bd.Topic,bd.Data,bd.ContextId)});const kd=yb.nsl;this.Kkm(kd,Tc);Lb.a.$(507843604,
306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, {2}",Oe[yb.tnd],yb.ydd,this.t1l(kd))}}}}Object(c.a)(oe,"ShapeTextTileTriggerController",Cf,[]);var Rf=a(28),Uf=a(92),gf=a(53),gg=a(104),Ve=a(96),hf=a(182),ef=a(51);class Ga{constructor(){this.lcid=this.end=this.start=0;this.noProof=!1}}Object(c.a)(Ga,"TextSpan",null,[]);class hb{}Object(c.a)(hb,"AugCharFormat",null,[]);class Hb{}Object(c.a)(Hb,"AugCharFormatRun",null,[]);class mc{}Object(c.a)(mc,"AugDrawingElement",null,[]);class Nc{}Object(c.a)(Nc,
"AugDrawingElementMoniker",null,[]);class db{}Object(c.a)(db,"AugPara",null,[]);class Wb{}Object(c.a)(Wb,"AugParaFormat",null,[]);class Jc{}Object(c.a)(Jc,"AugParaFormatRun",null,[]);class jd{}Object(c.a)(jd,"AugSlide",null,[]);class xd{}Object(c.a)(xd,"AugSlideMoniker",null,[]);class Ad{}Object(c.a)(Ad,"AugText",null,[]);class de{}Object(c.a)(de,"AugTextTile",null,[]);class De{constructor(yb,Tc,bd,kd,zd,fe,Ye,pf,Je,Ff,Cg,sh){this.Rj=yb;this.uq=Tc;this.VNg=bd;this.Vb=kd;this.W_=zd;this.Fc=fe;this.Wn=
Ye;this.$7b=Cg;this.a0e=pf;this.Sne=Je;this.xC=Ff;this.Rne=sh}lVe(yb){if(!yb||!yb.isConnected)return null;var Tc=Object(r.a)(22,yb);if(!Tc)return null;let bd=yb=0;Tc=({lWh:yb,cJh:bd}=this.U5m(Tc)).returnValue;if(!Tc)return null;Tc=Object.assign(new de,{Id:Vc.a.create().toString(),Content:k.c(Tc)});Lb.a.$(508945997,306,50,"TileId: {0}; ParaCount: {1}; DirtyParaCount: {2};",Tc.Id,yb,bd);return Tc}U5m(yb){let Tc=0,bd=0;const kd=[];var zd=yb?yb.Nj():[];for(var fe of zd)if(!this.uq.Bgb(fe)||this.$7b)if(fe.gd){if(zd=
this.Fc.IS(fe))zd=this.Vb.Lc(zd),this.W_.Qkd(zd,Ye=>{(Ye=Object(r.a)(394,Ye.currentNode))&&!Ye.isGhostCell&&({lWh:Tc,cJh:bd}=this.n1l(Ye,Tc,bd,kd));return!0})}else({lWh:Tc,cJh:bd}=this.n1l(fe,Tc,bd,kd));fe=Tc;zd=bd;return{returnValue:Object.assign(new jd,{id:yb.id.toString(),mk:Object.assign(new xd,{sId:yb.sid,cId:yb.cid}),drawingElems:kd,isSlideCritiqueReady:yb.isSlideCritiqueReady,sourceTimestamp:Date.now()}),lWh:fe,cJh:zd}}n1l(yb,Tc,bd,kd){const zd=[];let fe=0;var Ye=this.Vb.Lc(yb);for(Ye=this.Wn.lfa(Ye,
Ye.currentNode);Ye.moveNext();){var pf=Ye.currentNode;pf&&this.Rj.ue(pf)&&pf.Va(gf.a.Tq)&&(pf=this.ddn(pf))&&(pf.pfRuns&&0<pf.pfRuns.length&&pf.pfRuns[0].pf.proofingDirty&&fe++,Array.add(zd,pf))}0<zd.length&&(Tc+=zd.length,bd+=fe,yb=Object.assign(new mc,{id:yb.id.toString(),mk:this.bdn(yb),text:Object.assign(new Ad,{paragraphs:zd})}),Array.add(kd,yb));return{lWh:Tc,cJh:bd}}bdn(yb){if(!yb)return null;var Tc="";let bd=0,kd=0;if(Object(Rf.a)(394,yb))Tc=Object(r.a)(394,yb),kd=3,Tc=Tc.cellId.toString();
else if(Object(Rf.a)(351,yb))if(yb=Object(r.a)(351,yb),Tc=yb.get_shapeId().toString(),bd=yb.get_cid(),yb.Lfa)kd=1;else if(yb.xg)kd=2;else if(yb.yr||yb.Bl)kd=4;return Object.assign(new Nc,{id:Tc,cId:bd,type:kd})}ddn(yb){if(!yb)return null;yb=Object(r.a)(Uf.AParagraphNode,yb);if(!yb)return null;var Tc=yb.ra(ef.a.rU,!1);Tc=Object.assign(new db,{id:yb.id.toString(),chars:Tc?"":this.Rj.text(yb)});const bd=this.cdn(yb);bd&&0<bd.length&&(Tc.pfRuns=bd);(yb=this.adn(yb))&&0<yb.length&&(Tc.cfRuns=yb);return Tc}cdn(yb){const Tc=
[],bd=Object(r.a)(Ve.a,this.Sne.j_d(yb));let kd=16,zd="",fe=0,Ye=0;if(bd&&this.Rne){const pf=this.xC.swa(bd);if(pf)if(kd=pf.listType,1===kd)zd=this.a0e.pJb(bd);else if(0===kd){fe=bd.ra(ef.a.autonumberBulletType,8);const Je=Object(r.a)(984,this.a0e);Je&&(Ye=Je.j3l(pf,bd))}}yb=Object.assign(new Jc,{pf:Object.assign(new Wb,{lvl:this.Rj.gbc(yb),proofingDirty:!yb.ra(hf.a.Jfa,!1),revisionId:yb.ra(hf.a.snd,0).toString(),listType:kd,listTag:zd,listNumeration:fe,listElementIndex:Ye})});Array.add(Tc,yb);return Tc}adn(yb){const Tc=
[];let bd=this.kin(yb);if(0<bd.count){bd=this.AYm(this.VNg.uld(yb),bd);for(const kd of bd)yb=kd.end-kd.start,Array.add(Tc,Object.assign(new Hb,{len:yb,cf:Object.assign(new hb,{lang:kd.lcid,noProof:kd.noProof})}))}return Tc}kin(yb){const Tc=new n.a,bd=yb.characterData;let kd=-1,zd=-1,fe=0;for(let Ye=0;Ye<yb.$a.length;Ye++){const pf=yb.$a.ka(Ye).formatting;pf&&(zd=gg.a.language(pf),-1!==kd&&kd!==zd&&(Tc.add(Object.assign(new Ga,{start:fe,end:yb.$a.ka(Ye).cp,lcid:kd,noProof:!1})),fe=yb.$a.ka(Ye).cp),
kd=zd)}Tc.add(Object.assign(new Ga,{start:fe,end:bd.length,lcid:zd,noProof:!1}));return Tc}AYm(yb,Tc){if(!yb)return Tc;for(const bd of yb){yb=!1;for(let kd=0;kd<Tc.count;kd++){if(!yb)if(Tc.ka(kd).start===bd.begin)yb=!0,Tc.ka(kd).noProof=!0;else if(bd.begin>Tc.ka(kd).start&&bd.begin<Tc.ka(kd).end){Tc.insert(kd+1,Object.assign(new Ga,{start:bd.begin,end:Tc.ka(kd).end,lcid:Tc.ka(kd).lcid,noProof:!0}));yb=!0;Tc.ka(kd).end=bd.begin;continue}if(yb)if(bd.end>Tc.ka(kd).end)Tc.ka(kd).noProof=!0;else{if(bd.end===
Tc.ka(kd).end){Tc.ka(kd).noProof=!0;break}if(bd.end<Tc.ka(kd).end){Tc.insert(kd+1,Object.assign(new Ga,{start:bd.end,end:Tc.ka(kd).end,lcid:Tc.ka(kd).lcid,noProof:!1}));Tc.ka(kd).end=bd.end;Tc.ka(kd).noProof=!0;break}}}}return Tc}}Object(c.a)(De,"SlideTextTileManager",null,[958,985]);var Le=a(615);class Xe extends Cf{constructor(yb,Tc,bd,kd,zd,fe,Ye,pf,Je,Ff,Cg,sh){super(Tc&125,bd,kd,Cg);this.od=yb;this.JEa=zd;this.PGn=fe;this.Wwa=Ye.Xd(12);this.AR=Ye.Xd(10);this.g4=pf;this.ya=Je;this.$pe=Ff;this.sSh=
Ye.Xd(22);this.Ea=sh}Oz(){this.Ea.qna||4!==(this.xX&4)||(this.od.Hha(Object(Ca.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.$pe.RVm(this.Rnm),this.yNa[Object(ve.a)(bf,4)]=this.JEa.O5m());16===(this.xX&16)&&(this.Wwa.Seb(Object(Ca.a)(this,this.iKb,"onBeforeParagraphDisconnect")),this.yNa[Object(ve.a)(bf,16)]=this.JEa.R5m());1===(this.xX&1)&&(this.Wwa.Rm(Object(Ca.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.yNa[Object(ve.a)(bf,1)]=this.JEa.S5m());
8===(this.xX&8)&&(this.AR.rH(Object(Ca.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.yNa[Object(ve.a)(bf,8)]=this.JEa.T5m());64===(this.xX&64)&&(this.sSh.Seb(Object(Ca.a)(this,this.Ykm,"onBeforeNumberListDicsonnect")),this.yNa[Object(ve.a)(bf,64)]=this.JEa.P5m());32===(this.xX&32)&&(this.sSh.Rm(Object(Ca.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged")),this.yNa[Object(ve.a)(bf,32)]=this.JEa.Q5m())}wJa(){this.Ea.qna||this.od.Cbb(Object(Ca.a)(this,
this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.Wwa.rr(Object(Ca.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Wwa.eib(Object(Ca.a)(this,this.iKb,"onBeforeParagraphDisconnect"));this.$pe.Q6n(this.Rnm);this.sSh.eib(Object(Ca.a)(this,this.Ykm,"onBeforeNumberListDicsonnect"));this.sSh.rr(Object(Ca.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"))}Ykm(yb,Tc){this.sIb(Tc,64)}onNumberListPropertyChanged(yb,Tc){this.sIb(Tc,32)}fireTileEvents(){try{ge.a.forEach(this.DWb,
yb=>{this.MWf(Object(r.a)(Of,this.DWb[yb]));delete this.DWb[yb]},null)}catch(yb){Lb.a.$(508944718,306,10,"Exception thrown at FireTileEvents: "+yb)}}MWf(yb){if(yb&&this.ya.Ia&&yb.graphNode&&this.ya.Ia.id===yb.graphNode.id){var Tc=Date.now(),bd=this.PGn.lVe(yb.graphNode,Oe[yb.tnd]);if(bd){Object(ub.a)("PPTOAugLoopProofingTelemetry")&&Lb.a.$(508944719,375,20,"ALv1: submitting proofing operation");this.g4.execute(zd=>{zd.submit(Le.a.etd,bd)});const kd=yb.nsl;this.Kkm(kd,Tc);Lb.a.$(508944717,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, TileSize: {2}, TileId: {3}, {4}",
Oe[yb.tnd],yb.ydd,k.c(bd).length,bd.Id,this.t1l(kd))}}}}Object(c.a)(Xe,"SlideTextTileTriggerController",Cf,[]);var ie=a(1262),If=a(994),qf=a(816),lf=a(80),qe=a(1261);class Ne extends Cf{constructor(yb,Tc,bd,kd,zd,fe,Ye,pf,Je,Ff,Cg,sh){super(Tc&1937,bd,kd,Cg);this.onRefreshTileAnnotations=(Og,Ch)=>{this.sIb(Ch,512)};this.onSlideReorder=(Og,Ch)=>{this.sIb(Ch,1024)};this.uhb=yb.Xd(8);this.Wwa=yb.Xd(12);this.JEa=zd;this.Xhm=fe;this.g4=pf;this.$pe=Je;this.Ea=sh;Object(If.b)()&&(this.Yhm=Ye);this.Lwa=new qe.a(Ff,
pf)}Oz(){16===(this.xX&16)&&(this.Wwa.Seb(Object(Ca.a)(this,this.iKb,"onBeforeParagraphDisconnect")),this.yNa[Object(ve.a)(bf,16)]=this.JEa.K5m());1===(this.xX&1)&&(this.Wwa.Rm(Object(Ca.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.yNa[Object(ve.a)(bf,1)]=this.JEa.L5m());128===(this.xX&128)&&(this.uhb.dfa(Object(Ca.a)(this,this.onSlideConnected,"onSlideConnected")),this.yNa[Object(ve.a)(bf,128)]=this.JEa.I5m());256===(this.xX&256)&&(this.uhb.t$(Object(Ca.a)(this,this.onSlideDisconnected,
"onSlideDisconnected")),this.yNa[Object(ve.a)(bf,256)]=this.JEa.J5m());this.Ea.qna&&512===(this.xX&512)&&(this.$pe.qVm(this.onRefreshTileAnnotations),this.yNa[Object(ve.a)(bf,512)]=this.JEa.M5m());this.WOh()&&1024===(this.xX&1024)&&(Object(If.b)()&&this.Yhm.Oz(),this.$pe.yVm(this.onSlideReorder),this.yNa[Object(ve.a)(bf,1024)]=this.JEa.N5m())}wJa(){this.Wwa.rr(Object(Ca.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Wwa.eib(Object(Ca.a)(this,this.iKb,"onBeforeParagraphDisconnect"));
this.uhb.gga(Object(Ca.a)(this,this.onSlideConnected,"onSlideConnected"));this.uhb.lxa(Object(Ca.a)(this,this.onSlideDisconnected,"onSlideDisconnected"));this.Ea.qna&&this.$pe.x6n(this.onRefreshTileAnnotations);this.WOh()&&(Object(If.b)()&&this.Yhm.wJa(),this.$pe.F6n(this.onSlideReorder))}onSlideConnected(yb,Tc){this.sIb(Tc,128)}onSlideDisconnected(yb,Tc){this.sIb(Tc,256)}fireTileEvents(){try{ge.a.forEach(this.DWb,yb=>{this.MWf(Object(r.a)(Of,this.DWb[yb]));delete this.DWb[yb]},null)}catch(yb){Lb.a.$(512496604,
306,10,"Exception thrown at FireTileEvents: "+yb)}}MWf(yb){if(yb&&yb.graphNode){var Tc=this.Xhm.lVe(yb.graphNode,Oe[yb.tnd]),bd=null,kd=Object(r.a)(22,yb.graphNode);if(kd&&!kd.qR&&!kd.Ytb){var zd=(this.Ea.qna||this.Ea.oNc)&&ub.a("ALSlideTileIdNewFormat")?kd.sid.toString()+"#"+kd.cid.toString():kd.sid.toString()+kd.cid.toString();var fe=["session","doc"];Tc=[Object.assign(new Pb.a,{id:zd,body:Tc,sourceTimestamp:Date.now()})];this.WOh()&&"slideReorder"in yb.ydd?(this.t7n(kd,fe,Tc),ub.a("ALUpdateSections")&&
this.Lwa.uHa()):(10===yb.tnd?"slideAdded"in yb.ydd||(bd=Object.assign(new Tb,{parentPath:fe,items:Tc})):"slideAdded"in yb.ydd?this.WOh()?(kd=this.Xhm.Rld(kd),yb=kd[0],kd=kd[1],bd=Object.assign(new za.a,{parentPath:fe,items:Tc,prevId:yb,nextId:kd})):bd=Object.assign(new za.a,{parentPath:fe,items:Tc}):bd=Object.assign(new Kb.a,{parentPath:fe,items:Tc}),bd&&(ub.a("PPTOAugLoopProofingTelemetry")&&Lb.a.$(508953108,375,20,"ALv2: submitting operation {0}",bd.H_.T_),this.g4.execute(Ye=>{Ye.submitOperation(bd)}),
ub.a("ALUpdateSections")&&this.Lwa.uHa()))}}}t7n(yb,Tc,bd){const kd=Object.assign(new Tb,{parentPath:Tc,items:bd}),zd=yb.YLk?lf.a.Er(yb.YLk.sid,yb.YLk.cid).toString():qf.a;yb=yb.guk?lf.a.Er(yb.guk.sid,yb.guk.cid).toString():qf.b;const fe=Object.assign(new za.a,{parentPath:Tc,items:bd,prevId:zd,nextId:yb});this.g4.execute(Ye=>{Ye.submitOperation(kd);Ye.submitOperation(fe)})}WOh(){return this.Ea.oNc&&ub.a("SlideReorderOnALEnabled")}}Object(c.a)(Ne,"SlideTileTriggerController",Cf,[]);var pe=a(1704),
Wf=a(45),ye;(function(yb){yb[yb.Unspecified=0]="Unspecified";yb[yb.Inline=1]="Inline";yb[yb.Floating=2]="Floating"})(ye||(ye={}));var Xf;(function(yb){yb[yb.Undefined=0]="Undefined";yb[yb.Bullet=1]="Bullet";yb[yb.Numbered=2]="Numbered";yb[yb.Lim=3]="Lim";yb[yb.Nil=4]="Nil";yb[yb.Any=5]="Any";yb[yb.NoList=6]="NoList";yb[yb.Invalid=7]="Invalid"})(Xf||(Xf={}));var uh;(function(yb){yb[yb.DontCare=1]="DontCare";yb[yb.Thin=2]="Thin";yb[yb.ExtraLight=3]="ExtraLight";yb[yb.Light=4]="Light";yb[yb.Normal=5]=
"Normal";yb[yb.Medium=6]="Medium";yb[yb.SemiBold=7]="SemiBold";yb[yb.Bold=8]="Bold";yb[yb.ExtraBold=9]="ExtraBold";yb[yb.Heavy=10]="Heavy"})(uh||(uh={}));var fg;(function(yb){yb[yb.NoCaps=0]="NoCaps";yb[yb.SmallCaps=1]="SmallCaps";yb[yb.AllCaps=2]="AllCaps";yb[yb.AllPetiteCaps=3]="AllPetiteCaps";yb[yb.PetiteCaps=4]="PetiteCaps";yb[yb.Unicase=5]="Unicase";yb[yb.Titling=6]="Titling";yb[yb.Other=7]="Other"})(fg||(fg={}));var pg;(function(yb){yb[yb.None=0]="None";yb[yb.Words=1]="Words";yb[yb.SingleLine=
2]="SingleLine";yb[yb.DoubleLine=3]="DoubleLine";yb[yb.HeavyLine=4]="HeavyLine";yb[yb.DottedLine=5]="DottedLine";yb[yb.DottedHeavyLine=6]="DottedHeavyLine";yb[yb.DashLine=7]="DashLine";yb[yb.DashHeavyLine=8]="DashHeavyLine";yb[yb.DashLongLine=9]="DashLongLine";yb[yb.DashLongHeavyLine=10]="DashLongHeavyLine";yb[yb.DotDashLine=11]="DotDashLine";yb[yb.DotDashHeavyLine=12]="DotDashHeavyLine";yb[yb.DotDotDashLine=13]="DotDotDashLine";yb[yb.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";yb[yb.WavyLine=15]=
"WavyLine";yb[yb.WavyHeavyLine=16]="WavyHeavyLine";yb[yb.WavyDoubleLine=17]="WavyDoubleLine"})(pg||(pg={}));var Kf;(function(yb){yb[yb.Left=0]="Left";yb[yb.Right=1]="Right";yb[yb.Center=2]="Center";yb[yb.Justified=3]="Justified";yb[yb.Other=4]="Other";yb[yb.None=5]="None";yb[yb.JustifyLow=6]="JustifyLow";yb[yb.Distributed=7]="Distributed";yb[yb.ThaiDistributed=8]="ThaiDistributed"})(Kf||(Kf={}));var hh;(function(yb){yb[yb.Image=0]="Image";yb[yb.TextBox=1]="TextBox";yb[yb.Chart=2]="Chart";yb[yb.SmartArt=
3]="SmartArt";yb[yb.Drawing=4]="Drawing";yb[yb.EquationObject=5]="EquationObject";yb[yb.Ink=6]="Ink";yb[yb.InkSpace=7]="InkSpace";yb[yb.InkEndOfLine=8]="InkEndOfLine";yb[yb.LineBreak=9]="LineBreak";yb[yb.PageBreak=10]="PageBreak";yb[yb.PageNumbers=11]="PageNumbers";yb[yb.FootnoteEndnote=12]="FootnoteEndnote";yb[yb.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";yb[yb.Tab=14]="Tab";yb[yb.UnsupportedObject=15]="UnsupportedObject";yb[yb.Other=16]="Other";yb[yb.Person=17]="Person";yb[yb.Date=
18]="Date"})(hh||(hh={}));var zh;(function(yb){yb[yb.Initial=0]="Initial";yb[yb.FirstLine=1]="FirstLine";yb[yb.Hanging=2]="Hanging"})(zh||(zh={}));class cg{constructor(yb,Tc){this.xC=yb;this.Aka=Tc}$pm(yb){const Tc={};try{Tc.listType=this.yZb(yb),Tc.outlineLevel=ic.ParagraphReader.Lld(yb),Tc.indentation=cg.pin(this.Aka.dca(yb))}catch(bd){Lb.a.$(509203979,822,50,"Exception message: "+bd.message)}return Tc}yZb(yb){const Tc=new Wf.GraphIterator;Tc.set(yb);Tc.sc(11);Tc.zg(11);return(yb=this.xC.Vv(Tc))?
cg.a3m(yb.listType):Xf.NoList}static a3m(yb){switch(yb){case 15:return Xf.Any;case 1:return Xf.Bullet;case 42:return Xf.Invalid;case 13:return Xf.Lim;case 14:return Xf.Nil;case 16:return Xf.NoList;case 0:return Xf.Numbered;default:return Xf.Invalid}}static pin(yb){return 2===yb.unit?Math.floor(pe.a.AHh(yb.value)/20):Math.floor(yb.value/20)}}Object(c.a)(cg,"TextTileFormatter",null,[959]);class le{}le.Gco="ShapeTextOnActiveSlideDomReady";le.Jco="ShapeTextOnSelectionFinished";le.Ico="ShapeTextOnParagraphPropertyChanged";
le.Kco="ShapeTextOnShapeChildTopologyChanged";le.Hco="ShapeTextOnParagraphDisconnect";le.Mfo="SlideTextOnActiveSlideDomReady";le.Qfo="SlideTextOnParagraphPropertyChanged";le.Pfo="SlideTextOnParagraphDisconnect";le.Rfo="SlideTextOnShapeChildTopologyChanged";le.Ofo="SlideTextOnNumberListPropertyChanged";le.Nfo="SlideTextOnNumberListDisconnect";le.Hfo="SlideOnParagraphPropertyChanged";le.Gfo="SlideOnParagraphDisconnect";le.Efo="SlideOnConnect";le.Ffo="SlideOnDisconnect";le.Ifo="SlideOnRefreshTileAnnotations";
le.Jfo="SlideOnReorder";Object(c.a)(le,"DetectStrategyName",null,[]);class ke{constructor(yb){this.CSa=yb}get xX(){return 4}dYa(yb,Tc){const bd=[];if((yb=Object(r.a)(tg.a,yb))&&yb.Ia&&(yb=Object(r.a)(22,yb.Ia))){yb=yb.Nj();for(const kd of yb)this.CSa.BKf(kd)&&Array.add(bd,kd);0<bd.length&&Tc(bd,1)}}}Object(c.a)(ke,"ShapeTextOnActiveSlideDomReadyDetectStrategy",null,[995]);var ag=a(326);class Ef{constructor(yb,Tc,bd){this.La=yb;this.CSa=Tc;this.sa=bd}get xX(){return 16}dYa(yb,Tc){if((yb=Object(r.a)(ag.a,
yb))&&yb.node&&12===yb.node.type&&(yb=this.La.Jn(yb.node))&&this.CSa.BKf(yb)){var bd=this.sa.D$();bd&&bd.id===yb.id&&(bd=[],Array.add(bd,yb),Tc(bd,6))}}}Object(c.a)(Ef,"ShapeTextOnParagraphDisconnectDetectStrategy",null,[995]);var lg=a(54),Hf=a(518);class Lg{constructor(yb,Tc,bd){this.La=yb;this.CSa=Tc;this.sa=bd}get xX(){return 1}dYa(yb,Tc){if((yb=Object(r.a)(Hf.a,yb))&&yb.node&&12===yb.node.type){const kd=this.La.Jn(yb.node);if(kd&&this.CSa.BKf(kd)){var bd=this.sa.D$();bd&&bd.id===kd.id&&(yb.property===
lg.a.listLevel?this.zVe(3,kd,Tc):yb.property===gf.a.Tq&&this.zVe(4,kd,Tc))}}}zVe(yb,Tc,bd){if(Tc){var kd=[];Array.add(kd,Tc);bd(kd,yb)}}}Object(c.a)(Lg,"ShapeTextOnParagraphPropertyChangedDetectStrategy",null,[995]);var Vg=a(1196);class uf{constructor(yb,Tc,bd,kd){this.sa=yb;this.CSa=Tc;this.n$a=bd;this.gSg=kd}get xX(){return 2}dYa(yb,Tc){const bd=[];if(yb=Object(r.a)(Vg.a,yb))if(this.gSg&&this.n$a&&this.n$a.ppn(yb.uE),!this.sa.U7())this.gSg&&this.n$a&&this.n$a.u4e();else if(yb.cJ&&yb.cJ.length){this.gSg&&
this.n$a&&this.n$a.u4e();yb=this.sa.zd();for(const kd of yb)this.CSa.BKf(kd)&&Array.add(bd,kd);0<bd.length&&Tc(bd,2)}}}Object(c.a)(uf,"ShapeTextOnSelectionFinishedDetectStrategy",null,[995]);var dg=a(915);class Fg{constructor(yb,Tc){this.sa=yb;this.CSa=Tc}get xX(){return 8}dYa(yb,Tc){const bd=[];if((yb=Object(r.a)(dg.a,yb))&&yb.node&&10===yb.node.type&&1===yb.$0&&(yb=Object(r.a)(351,yb.node))&&this.CSa.BKf(yb)){var kd=this.sa.D$();kd&&kd.get_shapeId()===yb.get_shapeId()&&(Array.add(bd,yb),Tc(bd,5))}}}
Object(c.a)(Fg,"ShapeTextOnShapeChildTopologyChangedDetectStrategy",null,[995]);class Gh{constructor(yb){this.ccm=yb}get xX(){return 1===this.ccm?128:256}dYa(yb,Tc){if((yb=Object(r.a)(ag.a,yb))&&yb.node&&8===yb.node.type){const bd=[];Array.add(bd,yb.node);1===this.ccm?Tc(bd,9):Tc(bd,10)}}}Object(c.a)(Gh,"SlideOnConnectOrDisconnectDetectStrategy",null,[995]);class Vh{constructor(yb){this.qc=yb}get xX(){return 16}dYa(yb,Tc){if((yb=Object(r.a)(ag.a,yb))&&yb.node&&12===yb.node.type){const bd=this.qc.Hg(yb.node);
bd&&(yb=[],Array.add(yb,bd),Tc(yb,6))}}}Object(c.a)(Vh,"SlideOnParagraphDisconnectDetectStrategy",null,[995]);class Qg{constructor(yb){this.qc=yb}get xX(){return 1}dYa(yb,Tc){var bd=Object(r.a)(Hf.a,yb);if(bd&&bd.node&&12===bd.node.type){const kd=this.qc.Hg(bd.node);kd&&Object(r.a)(Uf.AParagraphNode,bd.node)&&(yb=0,bd.property===lg.a.listLevel?yb=3:bd.property===gf.a.Tq&&(yb=4),bd=[],Array.add(bd,kd),Tc(bd,yb))}}}Object(c.a)(Qg,"SlideOnParagraphPropertyChangedDetectStrategy",null,[995]);class mh{get xX(){return 4}dYa(yb,
Tc){if((yb=Object(r.a)(tg.a,yb))&&yb.Ia&&(yb=Object(r.a)(22,yb.Ia))){var bd=yb.Nj();for(var kd of bd)if(kd.hasText){kd=[];Array.add(kd,yb);Tc(kd,1);break}}}}Object(c.a)(mh,"SlideTextOnActiveSlideDomReadyDetectStrategy",null,[995]);class Mf{constructor(yb,Tc){this.qc=yb;this.ya=Tc}get xX(){return 64}dYa(yb,Tc){if((yb=Object(r.a)(ag.a,yb))&&this.ya.Ia&&yb.node&&22===yb.node.type&&(yb=this.qc.Hg(yb.node))&&yb.id===this.ya.Ia.id){const bd=[];Array.add(bd,yb);Tc(bd,7)}}}Object(c.a)(Mf,"SlideTextOnNumberListDisconnectDetectStrategy",
null,[995]);class Gg{constructor(yb,Tc){this.qc=yb;this.ya=Tc}get xX(){return 32}dYa(yb,Tc){var bd=Object(r.a)(Hf.a,yb);bd&&bd.node&&22===bd.node.type&&(yb=this.qc.Hg(bd.node))&&this.ya.Ia&&yb.id===this.ya.Ia.id&&bd.property===gf.a.Wg&&(bd=[],Array.add(bd,yb),Tc(bd,8))}}Object(c.a)(Gg,"SlideTextOnNumberListPropertyChangedDetectStrategy",null,[995]);class dh{constructor(yb,Tc,bd,kd){this.ya=yb;this.uq=Tc;this.qc=bd;this.$7b=kd}get xX(){return 16}dYa(yb,Tc){if((yb=Object(r.a)(ag.a,yb))&&yb.node&&this.ya.Ia&&
12===yb.node.type){const bd=this.qc.Hg(yb.node);!bd||bd.id!==this.ya.Ia.id||this.uq.tca(yb.node)&&!this.$7b||(yb=[],Array.add(yb,this.ya.Ia),Tc(yb,6))}}}Object(c.a)(dh,"SlideTextOnParagraphDisconnectDetectStrategy",null,[995]);class Jh{constructor(yb,Tc,bd,kd,zd,fe,Ye,pf){this.ya=yb;this.uq=Tc;this.qc=bd;this.La=kd;this.$7b=zd;this.n$a=Ye;this.gSg=pf}get xX(){return 1}dYa(yb,Tc){if((yb=Object(r.a)(Hf.a,yb))&&yb.node&&this.ya.Ia&&12===yb.node.type){var bd=this.qc.Hg(yb.node);if(bd&&bd.id===this.ya.Ia.id&&
(bd=Object(r.a)(Uf.AParagraphNode,yb.node))&&(!this.uq.tca(bd)||this.$7b)){var kd=this.La.Jn(bd);kd.Gwa||kd.yr||kd.xg||kd.gd||!kd.Bl||!this.gSg||(this.n$a.settings.UKk=!0,this.n$a.rko(bd));yb.property===lg.a.listLevel?this.zVe(3,this.ya.Ia,Tc):yb.property===gf.a.Tq?this.zVe(4,this.ya.Ia,Tc):yb.property===hf.a.Jfa&&(bd.ra(hf.a.Jfa,!1)||this.zVe(4,this.ya.Ia,Tc))}}}zVe(yb,Tc,bd){if(Tc){var kd=[];Array.add(kd,Tc);bd(kd,yb)}}}Object(c.a)(Jh,"SlideTextOnParagraphPropertyChangedDetectStrategy",null,[995]);
class Wg{constructor(yb,Tc){this.ya=yb;this.qc=Tc}get xX(){return 8}dYa(yb,Tc){yb=Object(r.a)(dg.a,yb);this.ya.Ia&&yb&&yb.node&&10===yb.node.type&&1===yb.$0&&(yb=Object(r.a)(351,yb.node))&&(yb=this.qc.Hg(yb))&&yb.id===this.ya.Ia.id&&(yb=[],Array.add(yb,this.ya.Ia),Tc(yb,5))}}Object(c.a)(Wg,"SlideTextOnShapeChildTopologyChangedDetectStrategy",null,[995]);class Ra{get xX(){return 512}dYa(yb,Tc){if(yb&&yb.Ia&&(yb=yb.Ia)){var bd=yb.Nj();bd&&bd.some(kd=>this.Azn(kd))&&Tc([yb],11)}}Azn(yb){if(!yb||!yb.hasText)return!1;
switch(yb.placeholderType){case 0:case 2:case 3:case 15:case 1:return!0;case 8:return!yb.a8;default:return!1}}}Object(c.a)(Ra,"SlideOnRefreshTileAnnotationsDetectStrategy",null,[995]);class vc{get xX(){return 1024}dYa(yb,Tc){if(yb&&yb.gtk){var bd=yb.gtk;bd?(bd.YLk=yb.Frm,bd.guk=yb.vse,Tc([bd],12)):Lb.a.$(508851910,306,15,"Got null slide node for slide reorder strategy")}else Lb.a.$(508851911,306,15,"Slide reorder strategy got blank args")}}Object(c.a)(vc,"SlideOnReorderDetectStrategy",null,[995]);
class Uc{constructor(yb,Tc,bd,kd,zd,fe,Ye,pf,Je){this.qc=yb;this.La=Tc;this.rb=bd;this.CSa=kd;this.ya=zd;this.uq=fe;this.Ea=Ye;this.TB=pf;this.n$a=Je}Ngn(yb){if(F.a.wb(yb))return 0;let Tc=0;for(const bd of yb)Tc|=this.j8n(bd);return Tc}Pgn(yb){if(F.a.wb(yb))return 0;let Tc=0;for(const bd of yb)Tc|=this.l8n(bd);return Tc}Ogn(yb){if(F.a.wb(yb))return 0;let Tc=0;for(const bd of yb)Tc|=this.k8n(bd);return Tc}A5m(){return new Lg(this.La,this.CSa,this.rb)}B5m(){return new uf(this.rb,this.CSa,this.n$a,this.Ea.p5c)}y5m(){return new ke(this.CSa)}C5m(){return new Fg(this.rb,
this.CSa)}z5m(){return new Ef(this.La,this.CSa,this.rb)}O5m(){return new mh}R5m(){return new dh(this.ya,this.uq,this.qc,this.Ea.mrd)}S5m(){return new Jh(this.ya,this.uq,this.qc,this.La,this.Ea.mrd,this.TB,this.n$a,this.Ea.p5c)}T5m(){return new Wg(this.ya,this.qc)}Q5m(){return new Gg(this.qc,this.ya)}P5m(){return new Mf(this.qc,this.ya)}K5m(){return new Vh(this.qc)}L5m(){return new Qg(this.qc)}J5m(){return new Gh(2)}I5m(){return new Gh(1)}M5m(){return new Ra}N5m(){return new vc}j8n(yb){return yb===
le.Ico?1:yb===le.Jco?2:yb===le.Gco?4:yb===le.Kco?8:yb===le.Hco?16:0}l8n(yb){return yb===le.Mfo?4:yb===le.Pfo?16:yb===le.Qfo?1:yb===le.Rfo?8:yb===le.Ofo?32:yb===le.Nfo?64:0}k8n(yb){return yb===le.Gfo?16:yb===le.Hfo?1:yb===le.Efo?128:yb===le.Ffo?256:yb===le.Ifo?512:yb===le.Jfo?1024:0}}Object(c.a)(Uc,"TilingFactory",null,[960]);class id extends Sys.EventArgs{constructor(yb){super();this.Ia=yb}}Object(c.a)(id,"TilingModuleLoadEventArgs",Sys.EventArgs,[]);var Jd=a(90);class $d{constructor(){this.ga=null;
this.Imk=this.s$j=!1}get name(){return"PowerPointWebEditor.ContentUpdateDetection"}oc(yb){this.ga=yb;yb.register(957,"PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager").oa().pa(()=>new He(yb.resolve("Box4.Graph.IGraphIteratorFactory"),yb.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),yb.resolve("PowerPointWebEditor.IShapeReader"),yb.resolve("Box4.IParagraphReader")));yb.register(958,"PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager").oa().pa(()=>new De(yb.resolve("Box4.IParagraphReader"),
yb.resolve("PowerPointWebEditor.Graph.INotesReader"),yb.resolve("Box4.Proofing.IProofingTextUtility"),yb.resolve("Box4.Graph.IGraphIteratorFactory"),yb.resolve("Box4.ITableNavigator"),yb.resolve("PowerPointWebEditor.Graph.ITableReader"),yb.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),yb.resolve("Box4.IListMarkerUtility"),yb.resolve("PowerPointWebEditor.IPPTParagraphReader"),yb.resolve("Box4.List.IListReader"),yb.resolve("PowerPointWebEditor.IApplicationSettings").mrd,yb.resolve("PowerPointWebEditor.IApplicationSettings").Uhb));
yb.register(959,"PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter").oa().pa(()=>new cg(yb.resolve("Box4.List.IListReader"),yb.resolve("Box4.IParagraphIndentationReader")));yb.register(ie.a,"PowerPointWebEditor.ContentUpdateDetection.SlideTileManager").oa().pa(()=>new ie.a(yb.resolve("Box4.Graph.IGraphIteratorFactory"),yb.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),yb.resolve("PowerPointWebEditor.IApplicationSettings"),yb.resolve("Box4.IParagraphReader"),yb.resolve("PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter"),
yb.resolve("PowerPointWebEditor.IPresentationReader")));Object(If.b)()&&yb.register(If.a,"PowerPointWebEditor.ContentUpdateDetection.SlideTileOrderTracker").oa().pa(()=>new If.a(yb.resolve("PowerPointWebEditor.IPresentationReader"),yb.resolve("Box4.Graph.IGraphInstance"),yb.eb("PowerPointWebEditor.AugmentationLoop.ITilingEventNotifier")));yb.register(960,"PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").oa().pa(()=>new Uc(yb.resolve("PowerPointWebEditor.ISlideReader"),yb.resolve("PowerPointWebEditor.IShapeReader"),
yb.resolve("PowerPointWebEditor.IPptSelectionManager"),yb.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),yb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),yb.resolve("PowerPointWebEditor.Graph.INotesReader"),yb.resolve("PowerPointWebEditor.IApplicationSettings"),yb.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),yb.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));yb.register(oe,"PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").oa().pa(()=>
new oe(yb.resolve("Box4.Graph.IGraphInstance"),yb.resolve("PowerPointWebEditor.IPptSelectionManager"),yb.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),yb.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),yb.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),yb.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),yb.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").Ngn(yb.resolve("PowerPointWebEditor.IApplicationSettings").drd),
yb.resolve("Common.ITaskManager"),yb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),yb.resolve("PowerPointWebEditor.IApplicationSettings").F2e,yb.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),yb.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),yb.resolve("PowerPointWebEditor.IApplicationSettings").T7c));yb.register(Xe,"PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").oa().pa(()=>new Xe(yb.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
yb.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").Pgn(yb.resolve("PowerPointWebEditor.IApplicationSettings").drd),yb.resolve("Common.ITaskManager"),yb.resolve("PowerPointWebEditor.IApplicationSettings").uye,yb.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),yb.resolve("PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager"),yb.resolve("Box4.Graph.IGraphInstance"),yb.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),yb.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
yb.resolve("PowerPointWebEditor.AugmentationLoop.ITilingEventHandlers"),yb.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),yb.resolve("PowerPointWebEditor.IApplicationSettings")));yb.register(Ne,"PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").oa().pa(()=>new Ne(yb.resolve("Box4.Graph.IGraphInstance"),yb.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").Ogn(yb.resolve("PowerPointWebEditor.IApplicationSettings").drd),yb.resolve("Common.ITaskManager"),yb.resolve("PowerPointWebEditor.IApplicationSettings").uye,
yb.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),yb.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileManager"),Object(If.b)()?yb.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileOrderTracker"):null,yb.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),yb.resolve("PowerPointWebEditor.AugmentationLoop.ITilingEventHandlers"),yb.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),yb.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),
yb.resolve("PowerPointWebEditor.IApplicationSettings")))}Z_l(){return ub.a("AL.SendSlideTile")}init(){const yb=this.ga.resolve("Common.IAppSettingsManager");yb.Wf(()=>{this.s$j=yb.getBooleanAppSetting(Jd.a.A2e);this.Imk=yb.getBooleanAppSetting(Jd.a.Vhb)||yb.getBooleanAppSetting(Jd.a.eaa);this.s$j&&(yb.getBooleanAppSetting(Jd.a.O4c)&&this.ga.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").initialize(),(this.Imk||this.ga.resolve("PowerPointWebEditor.IApplicationSettings").$qd)&&
this.ga.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").initialize(),this.Z_l()&&this.ga.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize());this.ga.eb("PowerPointWebEditor.AugmentationLoop.ITilingEventNotifier").execute(Tc=>Tc.f3n(new id(this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ia)))})}dispose(){this.s$j&&(this.ga.resolve("Common.IAppSettingsManager").getBooleanAppSetting(Jd.a.O4c)&&this.ga.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").dispose(),
(this.Imk||this.ga.resolve("PowerPointWebEditor.IApplicationSettings").$qd)&&this.ga.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").dispose(),this.Z_l()&&(ub.a("PPTOnline.BugFix-7758356")?this.ga.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").dispose():this.ga.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize()))}static main(){h.a.instance.Jc(new $d)}}Object(c.a)($d,"PPTWebEditorContentUpdateDetectionPackage",
null,[4,5]);var re=a(1263),Re=a(1026),Be=a(192),rf=a(175),qa=a(613),Fb=a(141),oa=a(66);class eb{constructor(yb,Tc,bd,kd,zd,fe,Ye,pf){this.type="EditorPaneProps";this.critiqueCountInclusiveness=this.critiqueCountClarity=this.critiqueCountConciseness=this.critiqueCountVocabulary=this.critiqueCountPunctuationConvention=this.critiqueCountFormality=this.critiqueCountGrammar=this.critiqueCountSpelling=null;this.critiqueCountSpelling=yb;this.critiqueCountGrammar=Tc;this.critiqueCountFormality=bd;this.critiqueCountPunctuationConvention=
kd;this.critiqueCountVocabulary=zd;this.critiqueCountConciseness=fe;this.critiqueCountClarity=Ye;this.critiqueCountInclusiveness=pf}}Object(c.a)(eb,"EditorPaneProps",null,[]);class Bb{constructor(yb,Tc,bd,kd,zd,fe,Ye,pf,Je,Ff,Cg,sh,Og,Ch,Pg){this.pc=!1;this.KDi=320;this.F8b=!1;this.IFb={};if(!yb)throw Error.argumentNull("pptSelectionManager");if(!Tc)throw Error.argumentNull("appFrame");if(!bd)throw Error.argumentNull("actionManager");if(!kd)throw Error.argumentNull("focusManager");if(!zd)throw Error.argumentNull("editorPane");
if(!Ye)throw Error.argumentNull("graphOperationEventHandler");if(!pf)throw Error.argumentNull("viewElementEventHandlers");if(!Je)throw Error.argumentNull("viewEventSource");if(!Ff)throw Error.argumentNull("pageView");if(!sh)throw Error.argumentNull("workspace");if(!Og)throw Error.argumentNull("loadScript");if(!Pg)throw Error.argumentNull("graphTopologyManager");Og("powerpoint-editor-intl").then(()=>{this.F8b=!0}).catch(ch=>{Lb.a.$(512267606,801,10,"Failed to load powerpoint-editor-intl "+ch.toString())});
this.Gb=Tc;this.la=bd;this.Nrg=Ch;this.Na=kd;this.nh=Ye;this.od=pf;this.Fd=Je;this.g4=Cg;this.ya=Pg;this.nh.cU(this.G1c.bind(this));this.nh.bMa(this.G1c.bind(this));this.Fd.j2a(this.G1c.bind(this));this.od.RHa(this.G1c.bind(this));this.Gb.zO(this.uw.bind(this));this.initialize()}initialize(){this.g4.execute(yb=>{yb.addEventHandler(qa.a.ujd,this.qon.bind(this))})}dispose(){this.nh.Qla(this.G1c.bind(this));this.nh.Dbb(this.G1c.bind(this));this.Fd.ACb(this.G1c.bind(this));this.od.iib(this.G1c.bind(this));
this.Gb.c6(this.G1c.bind(this))}Kb(){this.la.ua(Od.a.Sad,Gd.a.application,this.Sad.bind(this),4);this.la.ua(Od.a.S3e,Gd.a.application,this.S3e.bind(this),96)}Ae(){}G1c(){this.pc&&this.vo(!0)}uw(yb){1===yb.mode&&this.pc&&(this.pc=!1,this.Tx(),this.Na.Gm(oa.a.ofa,this.pc))}S3e(yb,Tc,bd,kd,zd){(yb=Object(r.a)(Fb.a,zd))&&yb.Fg(this.pc);return 32}Sad(yb,Tc,bd){return this.F8b?1===bd?32:2===bd?(this.pc=!this.pc,rf.b("EditorPaneActor::ShowHideEditorPane PaneOpen: ",this.pc.toString(),yb,()=>{this.pc?this.vo():
this.Tx();return 32})):8:8}vo(yb=!1){const Tc=this.jN(),bd=Object.assign(new Re.a,{title:"Editor Pane",hideHeader:!1,width:this.KDi,location:2,contentProps:Tc,onOpen:()=>{},onClose:()=>{this.pc=!1},isModernPane:!0});Be.a.Gz().then(kd=>{yb?kd.updateTaskPane(oa.a.ofa,bd):kd.showTaskPane(oa.a.ofa,bd);return null}).catch(kd=>{Lb.a.$(512267605,822,10,"EditorPaneActor::ShowPane, Failed to show editor pane. Exception: "+kd.toString())})}Tx(){Be.a.Gz().then(yb=>{yb.hideTaskPane(oa.a.ofa,2);return null}).catch(yb=>
{Lb.a.$(512267604,822,10,"EditorPaneActor::HidePane, Failed to hide editor pane. Exception: "+yb.toString())})}jN(){let yb=0,Tc=0,bd=0,kd=0,zd=0,fe=0,Ye=0,pf=0;const Je=this.ya.Ia?this.ya.Ia.cid:void 0;Je&&this.IFb[Je]&&Object.keys(this.IFb[Je]).forEach(Ff=>{this.IFb[Je][Ff].forEach(Cg=>{switch(Cg.CategoryTitle){case "Spelling":yb+=1;break;case "Grammar":Tc+=1;break;case "Conciseness":fe+=1;break;case "Formality":bd+=1;break;case "PunctuationConventions":kd+=1;break;case "Clarity":Ye+=1;break;case "Inclusiveness":pf+=
1;break;case "Vocabulary":zd+=1;break;default:Lb.a.$(509727769,822,50,"Unknown Critique Type: "+Cg.CategoryTitle)}})});return new eb(yb,Tc,bd,kd,zd,fe,Ye,pf)}Rlo(yb,Tc){const bd={};Object.keys(yb).forEach(kd=>{this.IFb[Tc]?(Object.keys(this.IFb[Tc]).includes(kd),this.IFb[Tc][kd]=yb[kd]):(bd[kd]=yb[kd],this.IFb[Tc]=bd)})}qon(yb,Tc,bd,kd){Tc&&kd&&(yb=JSON.parse(Tc.Content),kd=this.Nrg.Bjd(kd.critiques),Tc=this.ya.Ia.cid,null!=kd&&0<kd.length?this.Rlo(this.Ven(kd),Tc):0==kd.length&&this.IFb[Tc]&&this.o9m(yb.drawingElems,
Tc),this.IFb[Tc]&&this.i6n(yb.drawingElems,Tc),this.vo(!0))}i6n(yb,Tc){const bd=Object.keys(this.IFb[Tc]),kd=this.Zmn(yb);bd.forEach(zd=>{kd.includes(zd)||delete this.IFb[Tc][zd]})}Zmn(yb){const Tc=[];yb.forEach(bd=>{0<bd.text.paragraphs.length&&bd.text.paragraphs.forEach(kd=>{Tc.push(kd.id)})});return Tc}o9m(yb,Tc){yb.forEach(bd=>{0<bd.text.paragraphs.length&&this.t0m(bd.text.paragraphs,Tc)})}t0m(yb,Tc){yb.forEach(bd=>{this.IFb[Tc][bd.id]&&(bd.pfRuns[0].pf.proofingDirty||""==bd.chars)&&delete this.IFb[Tc][bd.id]})}Ven(yb){const Tc=
{};if(yb)for(const bd of yb)bd.TileId in Tc?Array.add(Tc[bd.TileId],bd):Tc[bd.TileId]=[bd];return Tc}}Object(c.a)(Bb,"DexLitePaneActor",null,[40,502]);class $b{constructor(){this.xa=new sa.a}xPk(yb){this.xa.raiseEvent("OnEditorConsistencyCritiqueOnActiveSlide",yb)}MPl(yb){this.xa.addHandler("OnEditorConsistencyCritiqueOnActiveSlide",yb)}}Object(c.a)($b,"EditorRuntimeEventSource",null,[1043,1044,1045]);var tc=a(25),xc=a(62),cd=a(1422),od=a(48);class sd{constructor(yb,Tc){this.paragraph=yb;this.critiqueId=
Tc}}Object(c.a)(sd,"CritiqueToHighlight",null,[]);class wd{constructor(yb,Tc,bd,kd,zd,fe,Ye,pf,Je,Ff){this.BJb=yb;this.QDn=Tc;this.ya=bd;this.qL=kd;this.Tb=zd;this.HI=fe;this.sa=Ye;this.tak=pf;this.Na=Je;this.AEn=Ff;this.BJb.Lah(this.QDn)}hNh(yb){yb.length?(yb=this.zjn(yb),yb.length&&(yb=Object.assign(new cd.a,{action:0,type:2,ngb:yb,y5c:this.BJb.EQc?this.BJb.EQc.ngb:null}),this.BJb.C5e(yb))):this.b7m()}b7m(){const yb=this.BJb.EQc?this.BJb.EQc.ngb:null,Tc=new cd.a;Tc.action=1;Tc.type=2;Tc.ngb=yb;
Tc.y5c=yb;this.BJb.C5e(Tc)}zjn(yb){const Tc=[];if(!this.tak.isEnabled(2))return Tc;var bd=this.ya.Ia;if(bd&&bd.isSlideCritiqueReady){var kd=bd.Vcb;if(!kd.count)return this.x6j(2),Tc;bd=0;for(const fe of kd)if(kd=Object(r.a)(Uf.AParagraphNode,fe)){var zd=this.Fjj(kd);for(const Ye of zd)zd=Object(r.a)(763,Ye.Xi),zd.Q2&&Array.contains(yb,zd.Q2.TraceId)&&(bd++,zd=new sd(kd,zd.Q2.TraceId),Array.add(Tc,zd))}bd!==yb.length&&this.Q8j(2,bd,yb.length)}else this.l8j(2,bd);return Tc}$Bm(yb){if(!this.tak.isEnabled(3))return!1;
var Tc=this.ya.Ia;if(Tc&&Tc.isSlideCritiqueReady){Tc=Tc.Vcb;if(!Tc.count)return this.x6j(3),!1;let bd=0;const kd=this.Tb.Kd(15,void 0,()=>{this.prm()});try{let zd=!1;kd.tc(Tc.ka(0));kd.wc=od.a.rtd;for(const fe of Tc){const Ye=Object(r.a)(Uf.AParagraphNode,fe);if(Ye){const pf=new n.a,Je=this.Fjj(Ye);for(const Ff of Je){const Cg=Object(r.a)(763,Ff.Xi);if(Cg.Q2&&yb.Sb(Cg.Q2.TraceId)){const sh=yb.ka(Cg.Q2.TraceId);let Og;try{Og=Cg.Q2.Suggestions[sh].Text;const Ch=new tc.a(Ff,Og);pf.add(Ch);zd||(Cg.Odb(this.THn(sh)),
zd=!0);bd++}catch(Ch){Lb.a.$(508692554,375,10,"Take suggestion: Parse failed with exception: {0}",Ch)}}}pf.count&&(pf.Sc((Ff,Cg)=>Cg.key.begin-Ff.key.begin),this.B7n(Ye,pf))}}bd!==yb.count&&this.Q8j(3,bd,yb.count)}finally{kd&&kd.dispose()}}else return this.l8j(3,Tc),!1;return!0}THn(yb){switch(yb){case 0:return od.a.zxa;case 1:return od.a.Axa;case 2:return od.a.Bxa;case 3:return od.a.uJa;case 4:return od.a.vJa;default:return 0}}B7n(yb,Tc){for(const bd of Tc)this.HI.replaceTextRange(xc.a.createTextRange(yb,
0<bd.key.begin?bd.key.begin:0,bd.key.end),bd.value,!0,!1)}ignoreCritiques(yb,Tc){if(!this.tak.isEnabled(Tc))return!1;var bd=this.ya.Ia;if(bd&&bd.isSlideCritiqueReady){var kd=bd.Vcb;if(!kd.count)return this.x6j(Tc),!1;this.prm();bd=!1;let zd=0;for(const fe of kd)if(kd=Object(r.a)(Uf.AParagraphNode,fe)){kd=this.Fjj(kd);for(const Ye of kd)kd=Object(r.a)(763,Ye.Xi),kd.Q2&&Array.contains(yb,kd.Q2.TraceId)&&(kd.lYa=!0,bd||(kd.Odb(od.a.aYe),bd=!0),zd++)}zd!==yb.length&&this.Q8j(Tc,zd,yb.length)}else return this.l8j(Tc,
bd),!1;return!0}Fjj(yb){return this.qL.AH(yb,Tc=>{Tc=Object(r.a)(763,Tc.Xi);return!!Tc&&5===Tc.proofingType&&!Tc.lYa})}x6j(yb){Lb.a.$(508692553,375,15,"{0}: No slide critique in active slide. Skipping",yb)}Q8j(yb,Tc,bd){Lb.a.$(508692552,375,15,"{0}: ErrorRange number mismatch. Actual: {1}, expected: {2}",yb,Tc,bd)}l8j(yb,Tc){Lb.a.$(508692551,375,15,"{0}: Active slide is null or slide critiques are not ready. Active slide null: {1}",yb,!!Tc)}prm(){this.sa.Rx();this.sa.lk();this.AEn&&this.Na.Ag(oa.a.sh,
!0)}}Object(c.a)(wd,"ConsistencyCheckActor",null,[945]);var Hd=a(334),Wd=a(111),mb=a(1202),lc=a(1419),Mc=a(61),md=a(1420),ud=a(1421);class Qd extends lc.a{constructor(yb,Tc){super();this.TQh=[mb.a.x1e,mb.a.lce,mb.a.pFe,mb.a.tMd];this.ya=yb;this.eFn=Tc;this.Sdk=[new md.a("InconsistentCritiquesHighlight",null),new md.a("InconsistentCritiquesLeftSidebar",null),new md.a("InconsistentCritiquesRightSidebar",null)]}get tmd(){return this.eFn}get oFj(){return this.Sdk}Fdg(yb,Tc){yb=Object(Rf.a)(Array,yb)?
Array.isArray(yb)?yb:null:null;if(!yb||0<yb.length&&!Object(r.a)(sd,yb[0]))return Tc;const bd=new Mc.GraphTransaction(3);try{bd.ld(this.ya.presentation);for(const kd of yb)ud.b(kd.paragraph),Tc.add(kd.paragraph)}finally{bd&&bd.dispose()}return Tc}L2c(yb,Tc){if(this.tmd&&this.zIa&&this.zIa.Vob&&this.zIa.Vob.ngb&&2===this.zIa.Vob.type){var bd=[],kd=[];this.Ypm(this.zIa.Vob.ngb,bd,kd);var zd=[];this.Ypm(this.zIa.Vob.y5c,null,zd);Tc=Tc.querySelectorAll("*");for(let fe=0;fe<Tc.length;fe++){let Ye="",pf=
"";const Je=Tc[fe];for(let Ff=0;Ff<this.TQh.length;Ff++)Hd.a.ye(Je,this.TQh[Ff])&&(pf=this.TQh[Ff],Ye=Hd.a.ye(Je,this.TQh[Ff]));Ye.length&&2===this.zIa.Vob.type&&(0===this.zIa.Vob.action?Array.contains(kd,yb)&&Array.contains(bd,Ye)?this.Wqn(Je,pf):this.cYh(Je):1===this.zIa.Vob.action&&Array.contains(zd,yb)&&this.cYh(Je))}}}Wqn(yb,Tc){Wd.a.a3(yb,"InconsistentCritiquesHighlight");switch(Tc){case mb.a.lce:Wd.a.a3(yb,"InconsistentCritiquesLeftSidebar");break;case mb.a.pFe:Wd.a.a3(yb,"InconsistentCritiquesRightSidebar");
break;case mb.a.tMd:Wd.a.a3(yb,"InconsistentCritiquesLeftSidebar"),Wd.a.a3(yb,"InconsistentCritiquesRightSidebar")}}Ypm(yb,Tc,bd){if(yb)for(const kd of yb)Array.add(bd,kd.paragraph),Tc&&Array.add(Tc,kd.critiqueId)}}Object(c.a)(Qd,"CritiquesHighlightActor",lc.a,[]);class kb{}Object(c.a)(kb,"Critique",null,[]);class Xb{}Object(c.a)(Xb,"Suggestion",null,[]);class sc{MVl(yb,Tc){if(!yb)return[];const bd=Array(yb.length);for(let kd=0;kd<yb.length;kd++)bd[kd]=Tc(yb[kd]);return bd}T2m(yb){return Object.assign(new kb,
{critiqueId:yb.TraceId,typeId:yb.TypeId,tag:yb.Tag,bucketId:yb.BucketId,paragraphId:yb.TileId,start:yb.Start,length:yb.Length,categoryTitle:yb.CategoryTitle,explanationTitle:yb.ExplanationTitle,explanationLabel:yb.ExplanationLabel,explanation:yb.Explanation,suggestions:this.MVl(yb.Suggestions,Object(Ca.a)(this,this.U2m,"convertBox4Suggestion"))})}U2m(yb){return Object.assign(new Xb,{text:yb.Text,description:yb.Description,bucketId:yb.BucketId,numberOfInstances:yb.NumberOfInstances})}}Object(c.a)(sc,
"DataContractMapper",null,[948]);class Rc extends Sys.EventArgs{constructor(yb){super();this.mq=yb}}Object(c.a)(Rc,"PaneClosedEventArgs",Sys.EventArgs,[]);var Zc=a(250);class Id{constructor(yb,Tc,bd,kd,zd,fe,Ye,pf){this.la=yb;this.Ld=Tc;this.Fd=bd;this.Gbk=kd;this.q0e=zd;this.J_e=fe;this.iek=Ye;this.yHn=pf;this.fk=0;this.Ld.execute(Je=>{Je.Bxf(Object(Ca.a)(this,this.Aac,"onPaneClosed"))})}get state(){return this.fk}f_h(yb){this.fk!==yb&&(this.fk=yb,this.Fd.hJ(new Zc.a(1)))}som(yb){0===this.state&&
(Lb.a.$(507843105,375,50,"[EditorPane] Begin opening Editor pane, reason: {0} Time: {1}",yb,(new Date).getTime()),this.f_h(1),yb={},yb.UC=ResourceStrings.L_EditorPaneTitle,yb.assetId=this.q0e.getAssetId(),yb.UW=Object(Ca.a)(this,this.K2c,"onPaneRendered"),yb.nonPersistedSettings={},yb.nonPersistedSettings.IdeasEnabled=this.iek.toString(),yb.Jzh=this.yHn,32!==this.la.Ra(Od.a.kJa,2,yb)&&(Lb.a.$(507843104,375,15,"[EditorPane] Failed to open Editor pane"),this.f_h(0)))}ifa(yb){if(2===this.state){var Tc=
this.q0e.FIb();Tc&&(Lb.a.$(507843103,375,50,"[EditorPane] Begin closing Editor pane, reason: {0}",yb),32!==this.la.Ra(Od.a.YUb,2,Tc)&&Lb.a.$(507843102,375,15,"[EditorPane] Failed to close Editor pane"))}}Aac(yb,Tc){2===this.state&&Tc&&(yb=Tc.mq)&&yb.length&&(Tc=this.q0e.FIb(),Tc!==yb&&Tc||(Lb.a.$(507843101,375,50,"[EditorPane] Pane closed"),this.Gbk.U2n(new Rc(yb)),this.f_h(0),this.J_e.sessionEnd()))}K2c(){const yb=this.q0e.FIb();1!==this.state?Lb.a.$(507843100,375,15,"[EditorPaneActor] Received pane rendered event even though we weren't in opening state. Instance id={0}",
yb):(Lb.a.$(507843099,375,50,"[EditorPane] Pane rendered. Instance id={0}",yb),this.f_h(2),this.J_e.J$n())}}Object(c.a)(Id,"EditorPane",null,[950]);class Td{constructor(yb,Tc){this.type=0;this.id=null;this.type=yb;this.id=Tc}static WNe(yb){return yb.id&&yb.id.toString().length&&Object(Rf.a)(Number,yb.type)?new Td(yb.type,yb.id.toString()):null}}Object(c.a)(Td,"Message",null,[]);var he=a(3);class be{constructor(yb,Tc,bd,kd,zd,fe,Ye,pf,Je,Ff,Cg,sh,Og,Ch,Pg,ch){this.Y4i=new re.a;this.la=yb;this.qsa=
Tc;this.x_e=bd;this.Ldm=kd;this.x8a=zd;this.Igm=fe;this.Owa=Ye;this.Gbk=pf;this.ya=Je;this.d8b=Ff;this.lpe=Cg;this.Ri=sh;this.fEn=Og;this.Fd=Ch;this.DEn=Pg;this.rc=ch;this.LJh=new re.a(0);this.LJh.add(0,2001);this.LJh.add(1,2002);this.LJh.add(2,2003)}Kb(){this.la.ua(Od.a.E2e,Gd.a.application,Object(Ca.a)(this,this.hZl,"editorPaneButtonClicked"),4);this.la.ua(Od.a.a4e,Gd.a.application,Object(Ca.a)(this,this.Urm,"queryEditorPaneButton"),96);this.la.ua(Od.a.mqm,Gd.a.application,Object(Ca.a)(this,this.hZl,
"editorPaneButtonClicked"),4);this.la.ua(Od.a.b4e,Gd.a.application,Object(Ca.a)(this,this.Urm,"queryEditorPaneButton"),96);this.la.ua(Od.a.XWh,Gd.a.application,Object(Ca.a)(this,this.iZl,"editorPaneExtenal"),4);this.la.ua(Od.a.mHk,Gd.a.application,Object(Ca.a)(this,this.iZl,"editorPaneExtenal"),4);this.Ldm.dti(Object(Ca.a)(this,this.BRn,"onEditorPaneMessageReceived"));this.d8b.Vjc(Object(Ca.a)(this,this.exa,"onSlidePresenceChanged"));this.lpe.Rm(Object(Ca.a)(this,this.Lta,"onSlidePropertyChanged"));
this.Ri.cU(Object(Ca.a)(this,this.zT,"onActiveSlideChanged"));this.Gbk.zVm(Object(Ca.a)(this,this.Aac,"onPaneClosed"))}Ae(){}iZl(yb,Tc,bd){if(1===bd)return 32;switch(yb){case Od.a.XWh:this.qsa.som(2);break;case Od.a.mHk:this.qsa.ifa(2);break;default:return Lb.a.$(507843589,375,10,"[EditorPaneActor] Unsupported actionId: {0}",yb),16}return 32}hZl(yb,Tc,bd){if(1===bd)return this.rc.zl()?32:16;switch(this.qsa.state){case 0:return this.qsa.som(1),32;case 2:return this.qsa.ifa(1),32;case 1:return Lb.a.$(507843588,
375,50,"[EditorPaneActor] User double clicked to open pane before it was rendered"),this.Fd.hJ(new Zc.a(1)),32;default:return Lb.a.$(507843587,375,10,"[EditorPaneActor] Unsupported EditorPaneState"),16}}Urm(yb,Tc,bd,kd,zd){if(!zd||!Object(Rf.a)(Fb.a,zd))return 8;zd.Fg(2===this.qsa.state||1===this.qsa.state);return 32}BRn(yb,Tc){this.CRn(Tc)}CRn(yb){const Tc=this.x8a.o7m(yb.message);if(Tc){var bd;({value:bd}=this.Igm.Ph(Tc.type)).returnValue||(bd=this.Igm.ka(0));var kd=bd.process(yb,Tc);kd.continueWith(()=>
{const zd=kd.result,fe=this.x8a.LZl(zd);this.sendMessage(yb.mq,fe);this.XBn(yb,Tc,zd)})}else Lb.a.$(507843586,375,15,"[EditorPaneActor] OnEditorPaneMessageReceived, can't deserialize message."),he.Task.zG(!1)}APk(yb){this.Y4i.Sb(yb)||this.Y4i.fa(yb,this.DEn.dVe(200,()=>{const Tc=this.x_e.cmn(yb);if(Tc.length){var bd=new Td(this.LJh.ka(yb),cc.a.create().toString());bd=this.x8a.LZl(bd);this.n$n(Tc,bd)}this.fEn.xPk(yb)}));this.Y4i.ka(yb).perform()}n$n(yb,Tc){for(const bd of yb)this.sendMessage(bd,Tc)}sendMessage(yb,
Tc){this.Ldm.sendMessage(yb,Tc)}XBn(yb,Tc,bd){const kd=new Date,zd=+kd-+yb.Lsm;2E3<=zd&&Lb.a.$(507843585,375,1E4<=zd?10:15,"[EditorPaneActor] Host was slow to respond to the message receivedInstanceId={0} receivedIsFromEditorPane={1} receivedTimestamp={2} currentTime={3} passedMilliseconds={4} receivedId={5} receivedType={6} responseId={7} responseType={8}",yb.mq,yb.LRj,yb.Lsm.toUTCString(),kd.getTime(),zd.toString(),Tc.id,Tc.type,bd.id,bd.type)}Lta(yb,Tc){Tc.property===hf.a.isSlideCritiqueReady&&
this.APk(1)}zT(){this.APk(0)}exa(yb,Tc){(yb=this.ya.Ia)&&Tc.slideId.equals(yb.fc)&&this.APk(2)}Aac(yb,Tc){this.x_e.plo(Tc.mq);this.Owa.visualizeCritiques([])}}Object(c.a)(be,"EditorPaneActor",null,[]);class Ue{constructor(){this.xa=new sa.a}zVm(yb){this.xa.addHandler("PaneClosed",yb)}U2n(yb){this.xa.raiseEvent("PaneClosed",yb)}}Object(c.a)(Ue,"EditorPaneEventSource",null,[951,1039,1040]);var cf=a(4);class mf{}Object(c.a)(mf,"Paragraph",null,[]);var ig=a(233);class ug{constructor(yb,Tc,bd,kd,zd,fe,
Ye,pf,Je){this.ya=yb;this.qL=Tc;this.cod=bd;this.la=kd;this.La=zd;this.fGn=fe;this.Rak=Ye;this.Rj=pf;this.fFn=Je}checkProofingDirty(yb){const Tc=yb.includedTags;if(2===yb.critiqueSelection&&1===Tc)return yb=(yb=this.ya.Ia)&&yb.isConnected?!yb.isSlideCritiqueReady:!0,this.fmc(0,!0),yb;this.Ubm("CheckProofingDirty");return!0}getCritiques(yb){var Tc=yb.includedTags;if(2===yb.critiqueSelection&&1===Tc){yb=this.ya.Ia;if(!yb||!yb.isConnected||!yb.isSlideCritiqueReady)return null;Tc=yb.Vcb;yb=[];for(const bd of Tc)if((Tc=
bd)&&Tc.isConnected){Tc=this.qL.AH(Tc,kd=>{kd=Object(r.a)(763,kd.Xi);return!!kd&&5===kd.proofingType&&!kd.lYa});for(const kd of Tc)(Tc=Object(r.a)(763,kd.Xi))&&yb.push(Tc.Q2)}this.fmc(1,!0);return this.Rak.MVl(yb,Object(Ca.a)(this.Rak,this.Rak.T2m,"convertBox4Critique"))}this.Ubm("GetCritiques");return null}J3l(yb){var Tc=this.ya.Ia;if(!Tc||!Tc.isConnected)return null;const bd=[];yb=ug.KOn(yb);Tc=Tc.gfa;for(const kd of yb)(yb=Object(r.a)(Ve.a,Tc.ye(cc.a.Vf(kd))))&&yb.isConnected&&bd.push(Object.assign(new mf,
{paragraphId:kd,text:this.Rj.L4e(yb,"\n")}));return bd}getSupportedLanguages(yb){return this.fGn.o2l(yb.includedTags).CWR(Tc=>{const bd=[];if(Tc=Object(r.a)(cf.a,Tc)){Tc=Tc.result;for(const kd of Tc)(Tc=Ce.a.Le(kd))&&Array.add(bd,Tc.name)}this.fmc(6,!0);return bd})}getLanguagesOnCurrentSlide(){const yb=[],Tc=[],bd=this.ya.Ia;let kd=[];bd&&(kd=bd.Nj());for(const zd of kd)this.La.fJ(zd,fe=>{if(fe&&Object(Rf.a)(Uf.AParagraphNode,fe)){fe=Object(r.a)(Uf.AParagraphNode,fe);var Ye=fe.characterData;if(Ye&&
Ye.length){var pf=-1,Je;for(Ye=0;Ye<fe.$a.length;Ye++)if(Je=fe.$a.ka(Ye).formatting)Je=gg.a.language(Je),pf===Je||Array.contains(yb,Je)||(Array.add(yb,Je),(pf=Ce.a.Le(Je))&&Array.add(Tc,pf.name)),pf=Je}}});this.fmc(7,!0);return Tc}visualizeCritiques(yb){if(!yb)return this.fmc(2,!1),1;const Tc=Array(yb.length);if(!yb.length)return this.cod.hNh(Tc),this.fmc(2,!0),0;for(let bd=0;bd<yb.length;bd++)Tc[bd]=yb[bd].critiqueId;this.cod.hNh(Tc);this.fmc(2,!0);return 0}resolveCritiques(yb){if(!yb||!yb.length)return 1;
const Tc=new re.a(0);for(const bd of yb)Tc.add(bd.critiqueId,bd.suggestionIndex);yb=this.cod.$Bm(Tc);this.fmc(3,yb);return yb?0:1}ignoreCritiques(yb){if(!yb||!yb.length)return 1;const Tc=[];for(const bd of yb)Array.add(Tc,bd.critiqueId);yb=this.cod.ignoreCritiques(Tc,4);this.fmc(4,yb);return yb?0:1}openProofingSettingsDialog(){if(this.fFn){const yb=this.la.Eb(od.a.u3c,2);this.fmc(5,32===yb)}}fmc(yb,Tc){Lb.a.$(508692640,375,50,"{0}: {1}",yb,Tc?0:1)}Ubm(yb){Lb.a.$(508692639,375,15,"{0}: Unsupported CritiqueFilter",
yb)}static KOn(yb){const Tc=new ig.a;for(var bd of yb)Tc.contains(bd.paragraphId)||Tc.add(bd.paragraphId);yb=Array(Tc.count);bd=0;for(const kd of Tc)yb[bd++]=kd;return yb}}Object(c.a)(ug,"EditorPaneHost",null,[947]);class Pf{}Object(c.a)(Pf,"EditorRuntimeNotificationData",null,[]);class mg extends Sys.EventArgs{constructor(){super();this.XRf=this.x0b=null}}Object(c.a)(mg,"EditorRuntimeNotificationEventArgs",Sys.EventArgs,[]);class Lf{constructor(){this.notificationConfidence=0;this.shouldRaiseNotification=
!1;this.confidence=0;this.resultStatus=null}}Object(c.a)(Lf,"InfraredResultBase",null,[]);var Nd=a(769),ih=a(828);class Yg{constructor(yb,Tc){this.includedTags=this.critiqueSelection=0;this.critiqueSelection=yb;this.includedTags=Tc}static hoa(yb){return Object(Rf.a)(Number,yb.critiqueSelection)&&Object(Rf.a)(Number,yb.includedTags)?new Yg(yb.critiqueSelection,yb.includedTags):null}}Object(c.a)(Yg,"CritiqueFilter",null,[]);class Ah{constructor(yb,Tc,bd,kd){this.la=yb;this.Owa=Tc;this.ya=bd;this.Mdm=
kd}xPk(yb){if(this.Mdm){var Tc=new Yg(2,1),bd=this.Owa.checkProofingDirty(Tc),kd=bd?[]:this.Owa.getCritiques(Tc),zd=bd?[]:this.Owa.J3l(kd);Tc=this.Dvk();yb=Object.assign(new Pf,{isProofingDirty:bd,critiques:kd,paragraphs:zd,numberOfCoAuthors:Tc,contextChanged:0===yb});zd=(kd=!!kd&&0<kd.length)?1:0;let fe=Nd.a.success;0<Tc?fe=Nd.a.W0c:bd?fe=Nd.a.pending:kd||(fe=Nd.a.W0c);bd=Object.assign(new mg,{x0b:Object.assign(new Lf,{notificationConfidence:zd,shouldRaiseNotification:!1,confidence:1,resultStatus:fe}),
XRf:yb});this.Mdm.xPk(bd)}}Dvk(){var yb=this.ya.Ia;if(!yb||!yb.isConnected)return 0;yb=Object.assign(new ih.a,{slideId:yb.fc});this.la.Ra(Od.a.wdc,2,yb);return yb.bKe}}Object(c.a)(Ah,"EditorRuntimeEventRaiser",null,[946]);var Bh=a(1252),Kh=a(1433);class Mg{constructor(yb){this.OEn=yb}J$n(){this.zsd(0,0)}sessionEnd(){this.zsd(1,0)}Eho(){this.zsd(2,4)}Fho(){this.zsd(2,3)}zsd(yb,Tc){this.OEn.execute(bd=>{const kd=Object.assign(new Kh.a,{cardId:Bh.a.gZl,actionType:yb,actionEngagement:Tc});bd.rVh(kd)})}}
Object(c.a)(Mg,"InfraredTelemetryLogger",null,[949]);class jg extends Td{constructor(yb,Tc,bd){super(yb,Tc);this.payload=null;this.payload=bd}}Object(c.a)(jg,"MessageWithPayload",Td,[]);class jh extends jg{constructor(yb,Tc,bd){super(yb,Tc,bd)}}Object(c.a)(jh,"CheckProofingDirtyAndGetCritiquesResponse",jg,[]);class Yf extends jg{constructor(yb,Tc,bd){super(yb,Tc,bd)}}Object(c.a)(Yf,"ResponseMessage",jg,[]);class jf{constructor(yb){this.statusCode=0;this.logErrorMessage=null;this.statusCode=yb;this.logErrorMessage=
"";0!==yb&&(this.logErrorMessage=yb.toString())}}Object(c.a)(jf,"Response",null,[]);class ci extends jf{constructor(yb,Tc,bd,kd){super(0);this.isProofingDirty=!1;this.languagesOnTheCurrentSlide=this.paragraphs=this.critiques=null;this.isProofingDirty=yb;this.critiques=Tc;this.paragraphs=bd;this.languagesOnTheCurrentSlide=kd}}Object(c.a)(ci,"ProofingDirtyAndCritiques",jf,[]);class bi{constructor(yb,Tc,bd){this.ya=yb;this.Owa=Tc;this.x8a=bd}process(yb,Tc){var bd=this.x8a.N6m(yb.message);if(!bd)return Lb.a.$(508692509,
375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Can't decode message."),yb=new jf(1),he.Task.zG(new Yf(1003,Tc.id,yb));yb=this.ya.Ia;if(!yb||!yb.isConnected)return Lb.a.$(508692508,375,50,"[CheckProofingDirtyAndGetCritiquesProcessor] Active slide doesn't exist or is not connected"),yb=new ci(!1,[],[],[]),Tc=new jh(1003,Tc.id,yb),he.Task.zG(Tc);bd=(yb=this.Owa.checkProofingDirty(bd.payload))?[]:this.Owa.getCritiques(bd.payload);if(!bd)return Lb.a.$(508692507,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] No box4 critiques were returned by host"),
yb=new jf(2),he.Task.zG(new Yf(1003,Tc.id,yb));const kd=yb?[]:this.Owa.J3l(bd),zd=yb?[]:this.Owa.getLanguagesOnCurrentSlide();if(!zd)return Lb.a.$(508692506,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Failed to query languages on current slide"),yb=new jf(7),he.Task.zG(new Yf(1003,Tc.id,yb));yb=new ci(yb,bd,kd,zd);Tc=new jh(1003,Tc.id,yb);return he.Task.zG(Tc)}}Object(c.a)(bi,"CheckProofingDirtyAndGetCritiquesProcessor",null,[1038]);class Rh{constructor(yb,Tc,bd){this.Owa=yb;this.x8a=Tc;
this.J_e=bd}process(yb,Tc){var bd=this.x8a.P6m(yb.message);if(!bd)return Lb.a.$(37087328,375,15,"[IgnoreProcessor] Can't decode message."),yb=new jf(1),he.Task.zG(new Yf(1006,Tc.id,yb));bd=this.Owa.ignoreCritiques(bd.payload);0===bd&&yb.LRj&&this.J_e.Fho();yb=0===bd?new jf(0):new jf(6);return he.Task.zG(new Yf(1006,Tc.id,yb))}}Object(c.a)(Rh,"IgnoreProcessor",null,[1038]);class di extends jg{constructor(yb,Tc,bd){super(yb,Tc,bd)}}Object(c.a)(di,"NumberOfCoAuthorsResponse",jg,[]);class Dg extends jf{constructor(yb){super(0);
this.numberOfCoAuthors=0;this.numberOfCoAuthors=yb}}Object(c.a)(Dg,"NumberOfCoAuthorsModel",jf,[]);class Oh{constructor(yb,Tc){this.la=yb;this.ya=Tc}process(yb,Tc){yb=this.Dvk();yb=new Dg(yb);return he.Task.zG(new di(1009,Tc.id,yb))}Dvk(){var yb=this.ya.Ia;if(!yb||!yb.isConnected)return 0;yb=Object.assign(new ih.a,{slideId:yb.fc});this.la.Ra(Od.a.wdc,2,yb);return yb.bKe}}Object(c.a)(Oh,"NumberOfCoAuthorsProcessor",null,[1038]);class zf{constructor(yb,Tc,bd){this.la=yb;this.qsa=Tc;this.iek=bd}process(yb,
Tc){if(!this.iek)return Lb.a.$(38412446,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Ideas disabled, but we were asked to open Ideas pane"),yb=new jf(10),he.Task.zG(new Yf(1011,Tc.id,yb));this.qsa.ifa(3);yb=this.la.Eb(Od.a.Onh,2);32!==yb&&Lb.a.$(38412448,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Failed to open Ideas pane");yb=new jf(32!==yb?9:0);return he.Task.zG(new Yf(1011,Tc.id,yb))}}Object(c.a)(zf,"OpenIdeasPaneAndCloseEditorPaneProcessor",null,[1038]);class bh{constructor(yb){this.Owa=
yb}process(yb,Tc){this.Owa.openProofingSettingsDialog();yb=new jf(0);return he.Task.zG(new Yf(1007,Tc.id,yb))}}Object(c.a)(bh,"OpenProofingSettingsProcessor",null,[1038]);class Ph{constructor(yb,Tc,bd){this.Owa=yb;this.x8a=Tc;this.J_e=bd}process(yb,Tc){var bd=this.x8a.Q6m(yb.message);if(!bd)return Lb.a.$(37087330,375,15,"[ResolveProcessor] Can't decode message."),yb=new jf(1),he.Task.zG(new Yf(1005,Tc.id,yb));bd=this.Owa.resolveCritiques(bd.payload);0===bd&&yb.LRj&&this.J_e.Eho();yb=0===bd?new jf(0):
new jf(5);return he.Task.zG(new Yf(1005,Tc.id,yb))}}Object(c.a)(Ph,"ResolveProcessor",null,[1038]);class Lh extends jg{constructor(yb,Tc,bd){super(yb,Tc,bd)}}Object(c.a)(Lh,"SubscriptionResponse",jg,[]);class wi extends jf{constructor(yb){super(0);this.telemetryCorrelationId=null;this.telemetryCorrelationId=yb}}Object(c.a)(wi,"SubscriptionModel",jf,[]);class Zg{constructor(yb,Tc){this.x_e=yb;this.x8a=Tc}process(yb,Tc){const bd=this.x8a.R6m(yb.message);if(!bd)return Lb.a.$(39331169,375,15,"[SubscribeProcessor] Can't decode message."),
yb=new jf(1),he.Task.zG(new Yf(1001,Tc.id,yb));Lb.a.$(39331171,375,50,"Editor pane telemetry correlation id={0}",bd.payload.telemetryCorrelationId);this.x_e.subscribe(yb.mq,0);this.x_e.subscribe(yb.mq,1);this.x_e.subscribe(yb.mq,2);yb=new wi("not available");return he.Task.zG(new Lh(1001,Tc.id,yb))}}Object(c.a)(Zg,"SubscribeProcessor",null,[1038]);class Rg extends jg{constructor(yb,Tc,bd){super(yb,Tc,bd)}}Object(c.a)(Rg,"SupportedLanguagesResponse",jg,[]);class ji extends jf{constructor(yb){super(0);
this.supportedLanguages=null;this.supportedLanguages=yb}}Object(c.a)(ji,"SupportedLanguagesModel",jf,[]);class Xh{constructor(yb,Tc){this.Owa=yb;this.x8a=Tc}process(yb,Tc){yb=this.x8a.S6m(yb.message);if(!yb)return Lb.a.$(38094432,375,15,"[SupportedLanguagesProcessor] Can't decode message."),yb=new jf(1),he.Task.zG(new Yf(1010,Tc.id,yb));const bd=this.Owa.getSupportedLanguages(yb.payload);return bd.CWR(()=>{var kd=bd.result;if(!kd)return Lb.a.$(38094434,375,15,"[SupportedLanguagesProcessor] Failed to query supported languages"),
kd=new jf(8),new Yf(1010,Tc.id,kd);kd=new ji(kd);return new Rg(1010,Tc.id,kd)})}}Object(c.a)(Xh,"SupportedLanguagesProcessor",null,[1038]);class kh{process(yb,Tc){Lb.a.$(37025999,375,15,"[UnsupportedMessageProcessor] Unsupported message type: {0}",Tc.type);yb=new jf(3);return he.Task.zG(new Yf(Tc.type,Tc.id,yb))}}Object(c.a)(kh,"UnsupportedMessageProcessor",null,[1038]);class mi{constructor(yb,Tc){this.Owa=yb;this.x8a=Tc}process(yb,Tc){yb=this.x8a.T6m(yb.message);if(!yb)return Lb.a.$(37026001,375,
15,"[VisualizeProcessor] Can't decode message."),yb=new jf(1),he.Task.zG(new Yf(1004,Tc.id,yb));yb=0===this.Owa.visualizeCritiques(yb.payload)?new jf(0):new jf(4);return he.Task.zG(new Yf(1004,Tc.id,yb))}}Object(c.a)(mi,"VisualizeProcessor",null,[1038]);class rg extends jg{constructor(yb,Tc,bd){super(yb,Tc,bd)}static hoa(yb){const Tc=Td.WNe(yb);return Tc&&yb.payload?(yb=Yg.hoa(yb.payload))?new rg(Tc.type,Tc.id,yb):null:null}}Object(c.a)(rg,"CheckProofingDirtyAndGetCritiquesMessage",jg,[]);class Ji{constructor(yb){this.Ldf=
yb}get critiqueId(){return this.Ldf}static hoa(yb){return yb.critiqueId&&Object(r.a)(String,yb.critiqueId)?new Ji(yb.critiqueId.toString()):null}}Object(c.a)(Ji,"CritiqueIgnore",null,[]);class Ki extends jg{constructor(yb,Tc,bd){super(yb,Tc,bd)}static hoa(yb){const Tc=Td.WNe(yb);if(!Tc||!yb.payload||!Object(Rf.a)(Array,yb.payload))return null;yb=yb.payload;const bd=Array(yb.length);for(let kd=0;kd<yb.length;kd++){const zd=Ji.hoa(yb[kd]);if(!bd)return null;bd[kd]=zd}return new Ki(Tc.type,Tc.id,bd)}}
Object(c.a)(Ki,"IgnoreCritiquesMessage",jg,[]);class Li{constructor(yb,Tc){this.Ldf=yb;this.NRm=Tc}get critiqueId(){return this.Ldf}get suggestionIndex(){return this.NRm}static hoa(yb){return yb.critiqueId&&Object(r.a)(String,yb.critiqueId)&&Object(Rf.a)(Number,yb.suggestionIndex)?new Li(yb.critiqueId.toString(),yb.suggestionIndex):null}}Object(c.a)(Li,"CritiqueResolution",null,[]);class jj extends jg{constructor(yb,Tc,bd){super(yb,Tc,bd)}static hoa(yb){const Tc=Td.WNe(yb);if(!Tc||!yb.payload||!Object(Rf.a)(Array,
yb.payload))return null;yb=yb.payload;const bd=Array(yb.length);for(let kd=0;kd<yb.length;kd++){const zd=Li.hoa(yb[kd]);if(!bd)return null;bd[kd]=zd}return new jj(Tc.type,Tc.id,bd)}}Object(c.a)(jj,"ResolveCritiquesMessage",jg,[]);class aj{constructor(yb){this.telemetryCorrelationId=null;this.telemetryCorrelationId=yb}static hoa(yb){let Tc="unavailable";yb.telemetryCorrelationId&&Object(r.a)(String,yb.telemetryCorrelationId)&&yb.telemetryCorrelationId.toString().length&&50>=yb.telemetryCorrelationId.toString().length&&
(Tc=yb.telemetryCorrelationId.toString());return new aj(Tc)}}Object(c.a)(aj,"Subscription",null,[]);class mj extends jg{constructor(yb,Tc,bd){super(yb,Tc,bd)}static hoa(yb){const Tc=Td.WNe(yb);if(!Tc)return null;yb.payload||(yb.payload={});return(yb=aj.hoa(yb.payload))?new mj(Tc.type,Tc.id,yb):null}}Object(c.a)(mj,"SubscribeMessage",jg,[]);class ri extends jg{constructor(yb,Tc,bd){super(yb,Tc,bd)}static hoa(yb){const Tc=Td.WNe(yb);return Tc&&yb.payload?(yb=Yg.hoa(yb.payload))?new ri(Tc.type,Tc.id,
yb):null:null}}Object(c.a)(ri,"SupportedLanguagesMessage",jg,[]);class xi{constructor(yb){this.Ldf=yb}get critiqueId(){return this.Ldf}static hoa(yb){return yb.critiqueId&&Object(r.a)(String,yb.critiqueId)&&yb.critiqueId.toString().length?new xi(yb.critiqueId.toString()):null}}Object(c.a)(xi,"CritiqueToVisualize",null,[]);class yi extends jg{constructor(yb,Tc,bd){super(yb,Tc,bd)}static hoa(yb){const Tc=Td.WNe(yb);if(!Tc||!yb.payload||!Object(Rf.a)(Array,yb.payload))return null;yb=yb.payload;const bd=
Array(yb.length);for(let kd=0;kd<yb.length;kd++){const zd=xi.hoa(yb[kd]);if(!bd)return null;bd[kd]=zd}return new yi(Tc.type,Tc.id,bd)}}Object(c.a)(yi,"VisualizeCritiquesMessage",jg,[]);class vh{o7m(yb){return this.VNe(yb,Td.WNe)}R6m(yb){return this.VNe(yb,mj.hoa)}N6m(yb){return this.VNe(yb,rg.hoa)}T6m(yb){return this.VNe(yb,yi.hoa)}Q6m(yb){return this.VNe(yb,jj.hoa)}P6m(yb){return this.VNe(yb,Ki.hoa)}S6m(yb){return this.VNe(yb,ri.hoa)}VNe(yb,Tc){try{let bd;return({NB:bd}=k.d(yb)).returnValue?Tc(bd):
null}catch(bd){return null}}LZl(yb){return k.c(yb)}}Object(c.a)(vh,"MessageEncoder",null,[955]);var Hg=a(100);class Zf extends Sys.EventArgs{constructor(yb,Tc,bd){super();this.mq=yb;this.message=Tc;this.LRj=bd;this.Lsm=new Date}}Object(c.a)(Zf,"MessageReceivedEventArgs",Sys.EventArgs,[]);class Ci{constructor(yb,Tc,bd){this.xa=new sa.a;this.q0e=yb;this.ncm=Tc;this.IEn=new RegExp(bd,"i")}initialize(){try{if(window.addEventListener)return window.addEventListener("message",Object(Ca.a)(this,this.mVg,
"messageReceivedHandler"),!1),!0;if(-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent)return window.attachEvent("onmessage",Object(Ca.a)(this,this.mVg,"messageReceivedHandler")),!0;Lb.a.$(507843608,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window")}catch(yb){Lb.a.$(507843607,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",yb.message,yb.stack)}return!1}dti(yb){this.xa.addHandler("MessageReceived",
yb)}Vtm(yb){this.xa.removeHandler("MessageReceived",yb)}sendMessage(yb,Tc){if(yb&&Tc){var bd={};bd.message=Tc;bd.editorPaneWildCard=".";this.j$n(yb,bd)}}j$n(yb,Tc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(yb,"onCustomMessage",Tc,bd=>{bd&&Lb.a.$(507843606,375,15,"Couldn't deliver the message to Editor pane, status: {0}.",bd)})}mVg(yb){const Tc=yb.origin;if(this.U$d(Tc)){var bd;({NB:bd}=k.d(yb.data)).returnValue&&bd&&"."===bd.editorPaneWildCard&&bd.message&&this.xa.raiseEvent("MessageReceived",
new Zf(this.q0e.FIb(),bd.message,Tc===this.ncm))}}U$d(yb){const Tc=Hg.a.getOrigin(window.location.href);return!!yb&&0<yb.length&&"null"!==yb&&(yb===this.ncm||yb===Tc||this.IEn.test(yb))}}Object(c.a)(Ci,"Messenger",null,[954]);class wh{constructor(yb,Tc){this.Ld=yb;this.assetId=Tc.pJk}FIb(){if(!this.Ld.instance)return Lb.a.$(37025987,375,15,"[EditorPaneManager] App for office manager not present"),null;const yb=this.Ld.instance.EV(this.assetId);return yb?yb.mq?yb.mq:(Lb.a.$(37025991,375,15,"[EditorPaneManager] App for office doesn't have instance id"),
null):(Lb.a.$(37025989,375,200,"[EditorPaneManager] App for office not found"),null)}getAssetId(){return this.assetId}}Object(c.a)(wh,"PaneIdsProvider",null,[952]);class xh{constructor(){this.Vu=new re.a}subscribe(yb,Tc){yb&&(this.Vu.Sb(Tc)||this.Vu.add(Tc,[]),Array.contains(this.Vu.ka(Tc),yb)||this.Vu.ka(Tc).push(yb))}unsubscribe(yb,Tc){yb&&this.Vu.Sb(Tc)&&(yb=Array.indexOf(this.Vu.ka(Tc),yb),-1!==yb&&Array.removeAt(this.Vu.ka(Tc),yb))}plo(yb){yb&&(this.unsubscribe(yb,0),this.unsubscribe(yb,1),this.unsubscribe(yb,
2))}cmn(yb){return this.Vu.Sb(yb)?this.Vu.ka(yb):[]}}Object(c.a)(xh,"EditorPaneSubscriptionsManager",null,[953]);var vg=a(235);class Tf{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.EditorPane"}oc(yb){yb&&(this.ga=yb,this.ga.register(Qd,"PowerPointWebEditor.Proofing.CritiquesHighlightActor").oa().pa(()=>new Qd(this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").eaa)),this.ga.register(945,"PowerPointWebEditor.Proofing.IConsistencyCheckActor").oa().pa(()=>
new wd(this.ga.resolve("Box4.Highlight.IHighlightManager"),this.ga.resolve("PowerPointWebEditor.Proofing.CritiquesHighlightActor"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("Box4.Proofing.IErrorRangeEditor"),this.ga.resolve("Common.Transaction.ITransactionFactory"),this.ga.resolve("Box4.ICharacterPropertiesEditor"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),
this.ga.resolve("PowerPointWebEditor.IApplicationSettings").l3e)),this.ga.register(be,"PowerPointWebEditor.EditorPane.EditorPaneActor").oa().pa(()=>new be(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.ga.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),this.ga.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger"),this.ga.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),
this.Q4m(),this.ga.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.ga.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerpointPresence.IPresenceEventHandlers"),this.ga.resolve("Box4.Graph.IGraphInstance").Xd(8),this.ga.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.ga.resolve("PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser"),this.ga.resolve("PowerPointWebEditor.View.IViewEventSource"),
this.ga.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"))),Tf.Swn&&this.ga.register(Bb,"PowerPointWebEditor.EditorPane.DexLitePaneActor").oa().pa(()=>new Bb(this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("PowerPointWebEditor.View.IDexLitePane"),this.ga.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),
this.ga.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.ga.resolve("PowerPointWebEditor.View.IViewEventSource"),this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"),this.ga.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.ga.resolve("PowerPointWebEditor.IPPTWorkspace"),vg.a(this.ga),this.ga.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),
this.ga.register(946,"PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser").oa().pa(()=>new Ah(this.ga.resolve("Common.IActionManager"),this.ga.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"))),this.ga.register($b,"PowerPointWebEditor.Editor.Common.Model.EditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventNotifier").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventHandler").oa().pa(()=>
new $b),this.ga.register(947,"PowerPointWebEditor.EditorPane.IEditorPaneHost").oa().pa(()=>new ug(this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("Box4.Proofing.IErrorRangeEditor"),this.ga.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckActor"),this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.IShapeReader"),this.ga.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.ga.resolve("PowerPointWebEditor.EditorPane.IDataContractMapper"),
this.ga.resolve("Box4.IParagraphReader"),this.ga.resolve("Common.IAppSettingsManager").getBooleanAppSetting(Jd.a.ABb))),this.ga.register(948,"PowerPointWebEditor.EditorPane.IDataContractMapper").oa().pa(()=>new sc),this.ga.register(949,"PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger").oa().pa(()=>new Mg(this.ga.eb("PowerPointWebEditor.IInfraredTelemetryListener"))),this.ga.register(950,"PowerPointWebEditor.EditorPane.IEditorPane").oa().pa(()=>new Id(this.ga.resolve("Common.IActionManagerExtended"),
this.ga.eb("PowerPointWebEditor.IAppForOfficeManager"),this.ga.resolve("PowerPointWebEditor.View.IViewEventSource"),this.ga.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.ga.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),this.ga.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").TTa,!0)),this.ga.register(951,"PowerPointWebEditor.EditorPane.IEditorPaneEventSource").oa().pa(()=>new Ue),this.ga.register(952,
"PowerPointWebEditor.EditorPane.IPaneIdsProvider").oa().pa(()=>new wh(this.ga.eb("PowerPointWebEditor.IAppForOfficeManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"))),this.ga.register(953,"PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager").oa().pa(()=>new xh),this.ga.register(954,"PowerPointWebEditor.EditorPane.Messaging.IMessenger").oa().pa(()=>new Ci(this.ga.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").Nqm,
this.ga.resolve("PowerPointWebEditor.IApplicationSettings").zye)),this.ga.register(955,"PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder").oa().pa(()=>new vh),this.ga.register(kh,"PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor").oa().pa(()=>new kh),this.ga.register(Zg,"PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor").oa().pa(()=>new Zg(this.ga.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),this.ga.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),
this.ga.register(Ph,"PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor").oa().pa(()=>new Ph(this.ga.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.ga.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.ga.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.ga.register(Rh,"PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor").oa().pa(()=>new Rh(this.ga.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.ga.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),
this.ga.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.ga.register(bh,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor").oa().pa(()=>new bh(this.ga.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"))),this.ga.register(bi,"PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor").oa().pa(()=>new bi(this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),
this.ga.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.ga.register(mi,"PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor").oa().pa(()=>new mi(this.ga.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.ga.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.ga.register(Oh,"PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor").oa().pa(()=>new Oh(this.ga.resolve("Common.IActionManager"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),
this.ga.register(Xh,"PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor").oa().pa(()=>new Xh(this.ga.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.ga.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.ga.register(zf,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor").oa().pa(()=>new zf(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),
this.ga.resolve("PowerPointWebEditor.IApplicationSettings").TTa)))}init(){this.ga&&this.ga.resolve("Common.IAppSettingsManager").Wf(()=>{var yb=this.ga.resolve("PowerPointWebEditor.IApplicationSettings");Tf.ddo(yb)&&this.ga.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger").initialize()&&(yb=this.ga.resolve("PowerPointWebEditor.EditorPane.EditorPaneActor"),yb.Kb(),yb.Ae(),yb=this.ga.resolve("PowerPointWebEditor.EditorPane.DexLitePaneActor"),yb.Kb(),yb.Ae())})}dispose(){}Q4m(){const yb=
new re.a;yb.fa(0,this.ga.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor"));yb.fa(1,this.ga.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor"));yb.fa(3,this.ga.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor"));yb.fa(4,this.ga.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor"));yb.fa(5,this.ga.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor"));
yb.fa(6,this.ga.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor"));yb.fa(7,this.ga.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor"));yb.fa(9,this.ga.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor"));yb.fa(10,this.ga.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor"));yb.fa(11,this.ga.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor"));
return yb}static main(){h.a.instance.Jc(new Tf)}static ddo(yb){return yb.eaa&&Tf.qwn(yb.pJk)}static Swn(yb){return yb.ZIh}static qwn(yb){return!!yb&&0<yb.length}}Object(c.a)(Tf,"PptWebEditorEditorPanePackage",null,[4,5]);class ei{constructor(yb){this.pc=!1;this.KDi=320;this.initialize();this.la=yb}initialize(){}dispose(){}Kb(){this.la.ua(Od.a.Sad,Gd.a.application,this.Sad,4)}Ae(){}Sad(yb,Tc,bd){return 1===bd?32:2===bd?rf.b("EditorPaneActor::ShowHideEditorPane PaneOpen: ",this.pc.toString(),yb,()=>
{this.pc?this.vo():this.Tx();return 32}):8}vo(yb=!1){const Tc=this.jN();this.pc=!0;const bd=Object.assign(new Re.a,{title:ResourceStrings.L_DexLitePaneTitle,hideHeader:!1,width:this.KDi,location:2,contentProps:Tc,onOpen:()=>{},onClose:()=>{this.pc=!1},isModernPane:!0});Be.a.Gz().then(kd=>{yb?kd.updateTaskPane(oa.a.ofa,bd):kd.showTaskPane(oa.a.ofa,bd);return null}).catch(kd=>{Lb.a.$(508883089,822,10,"EditorPaneActor::ShowPane, Failed to show editor pane. Exception: "+kd.toString())})}Tx(){this.pc=
!1;Be.a.Gz().then(yb=>{yb.hideTaskPane(oa.a.ofa,2);return null}).catch(yb=>{Lb.a.$(508883088,822,10,"EditorPaneActor::HidePane, Failed to hide editor pane. Exception: "+yb.toString())})}jN(){return new eb(0,0,0,0,0,0,0,0)}}Object(c.a)(ei,"EditorPaneActor",null,[40,502]);var yg=a(1253),Hj=a(167);class zi{constructor(yb,Tc,bd,kd,zd,fe,Ye,pf,Je){this.WSl=/[\t\n\s `~!@#$%^&*-+=|:;'"<>?/]+/;this.f_m=4;this.bTl="RewriteInnerContainer";this.g_m="RewriteIndicatorView";if(!yb)throw Error.argumentNull("shapeReader");
if(!Tc)throw Error.argumentNull("selectionManager");if(!bd)throw Error.argumentNull("graphTopologyManager");if(!kd)throw Error.argumentNull("pageView");if(!zd)throw Error.argumentNull("activeSlideViewManager");if(!fe)throw Error.argumentNull("appSettings");if(!Ye)throw Error.argumentNull("shapeTargetBounds");if(!pf)throw Error.argumentNull("rewriteActivityLogger");if(!Je)throw Error.argumentNull("slideReader");this.La=yb;this.sa=Tc;this.ya=bd;this.zb=kd;this.Oc=zd;this.c_m=fe.vjm;this.b_m=fe.Ac("minWordLimitForValidBulletedConciseContent",
10);this.a_m=fe.Ac("minBulletLimitForValidBulletedConciseContent",7);this.d_m=fe.Ac("minWordLimitForTitleSuggestions",10);this.Khm=Ye;this.cPg=pf;this.qc=Je}dispose(){}get kNf(){const yb=this.sa.zd();return 1!=(null===yb||void 0===yb?void 0:yb.length)?new Sys.UI.Bounds(0,0,0,0):yb[0].yc(this.zb.Ua).getBounds()}get lXl(){const yb=this.Oc.jd;return yb?yb.hs.getBoundingClientRect():new Sys.UI.Bounds(0,0,0,0)}VLh(){return this.Khm.u0m(this.kNf,this.lXl)}tZe(yb){var Tc,bd;return null===(bd=null===(Tc=
this.sa.zd()[0])||void 0===Tc?void 0:Tc.id)||void 0===bd?void 0:bd.equals(yb)}sMh(){return this.Khm.hhn(this.VLh(),this.lXl,this.kNf)}eWi(){switch(this.aIb){case yg.RewriteType.Title:return this.Ukn();case yg.RewriteType.Content:return this.rnn()}}get aIb(){var yb=this.sa.zd();if(1==(null===yb||void 0===yb?void 0:yb.length)&&this.P$l(yb[0]))if(yb=yb[0],yb.Bl)switch(yb.placeholderType){case 0:case 2:return yg.RewriteType.Title;case 1:case 8:return yg.RewriteType.Content}else return this.Njo(yb)?yg.RewriteType.Title:
yg.RewriteType.Content}Njo(yb){var Tc,bd;const kd=this.qc.nMh(this.ya.Ia);if(this.Pyn(kd))for(const zd of kd)if(zd.yr)return null!==(bd=null===(Tc=yb.id)||void 0===Tc?void 0:Tc.equals(zd.id))&&void 0!==bd?bd:!1;return!1}P$l(yb){return yb.Bl||ub.a("EnableRewriteForTextbox")&&yb.yr}Pyn(yb){var Tc;return null!==(Tc=null===yb||void 0===yb?void 0:yb.every(bd=>!bd.Lfa))&&void 0!==Tc?Tc:!1}get Vsb(){const yb=this.sa.zd();return 1==(null===yb||void 0===yb?void 0:yb.length)&&this.P$l(yb[0])&&void 0!=this.eWi()}get qYj(){const yb=
this.ya.Ia;return yb&&yb.Nj()?yb.Nj().every(Tc=>Tc.Bl&&this.$xn(Tc.placeholderType)||this.Rxn(Tc)):!1}Dyn(yb){const Tc=this.sa.zd();if(1!=(null===Tc||void 0===Tc?void 0:Tc.length))return!1;const bd=this.La.cnj(Tc[0]);yb=null===yb||void 0===yb?void 0:yb.qb;const kd=this.SVl(null===yb||void 0===yb?void 0:yb.toArray());this.v0l(kd,bd);if(!kd||1>kd.size)return!1;let zd=!0;kd.forEach((fe,Ye)=>{if(fe)if(bd.size!=kd.size&&bd.get(Ye))zd=!1;else{var pf=fe.Xa;fe=fe.Mb;bd.size==kd.size&&0<=pf&&0<=fe&&Math.abs(fe-
pf)<bd.get(Ye)&&(zd=!1)}else zd=!1});return zd}$wn(yb){const Tc=this.sa.zd();if(1!=(null===Tc||void 0===Tc?void 0:Tc.length))return!1;const bd=this.La.cnj(Tc[0]);yb=null===yb||void 0===yb?void 0:yb.qb;yb=this.SVl(null===yb||void 0===yb?void 0:yb.toArray());this.v0l(yb,bd);if(!yb||bd.size!=yb.size)return!1;let kd=!0;yb.forEach((zd,fe)=>{if(zd){var Ye=zd.Xa;zd=zd.Mb;0<=Ye&&0<=zd&&Math.abs(zd-Ye)!=bd.get(fe)&&(kd=!1)}else kd=!1});return kd}v0l(yb,Tc){Tc.forEach((bd,kd)=>{0==bd&&(yb.delete(kd),Tc.delete(kd))})}SVl(yb){const Tc=
new Map;yb.forEach(bd=>{const kd=bd.node;if(Tc.has(kd.id)){const zd=bd.Mb;-1!=bd.Xa&&-1!=zd&&Tc.set(kd.id,bd)}else Tc.set(kd.id,bd)});return Tc}snn(){var yb=this.ya.Ia;if(yb){var Tc=[];yb.Nj().filter(bd=>bd&&this.Byn(bd)).forEach(bd=>Tc.push(this.La.M2f(bd)));yb=Tc.filter(bd=>bd&&0<bd.length).join("\n");return this.v9l(yb,!0)?yb:void 0}Lb.a.$(508692224,816,10,"Active slide node is null");this.cPg.rewriteLogActivity("RewriteActiveSlideNode",!1,0,{errorMsg:"Active slide node is null"})}Mmn(){var yb;
const Tc=this.sa.zd();if(1==(null===Tc||void 0===Tc?void 0:Tc.length)&&(null===(yb=Tc[0])||void 0===yb||!yb.LA))return(yb=(yb=this.La.M2f(Tc[0]))?yb.trim():void 0)&&0<yb.length?yb:void 0}Ukn(){var yb=this.snn();const Tc=this.Mmn();yb=null!==yb&&void 0!==yb?yb:Tc;if(!J.a.wb(yb))return{mNf:yb,inputType:yg.RewriteType.Title,l2i:[yg.RewriteSuggestionType.Concise],Cil:!1,DCm:Tc}}rnn(){const yb=this.sa.zd();if(1==(null===yb||void 0===yb?void 0:yb.length)){var Tc=this.La.M2f(yb[0]),bd=this.u9l(yb[0]);if(this.v9l(Tc,
!1)){const kd=[yg.RewriteSuggestionType.Bullet,yg.RewriteSuggestionType.Paraphrase];this.Iwn(yb[0])&&kd.push(yg.RewriteSuggestionType.Concise);return{mNf:Tc,inputType:this.aIb,Cil:bd,l2i:kd}}}}AZm(){var yb,Tc;const bd=new Hj.a;bd.va.id=this.g_m;this.Foe=new Hj.a;this.Foe.va.id=this.bTl;this.Foe.yk(1);this.Foe.va.style.position="absolute";null===(Tc=null===(yb=this.Oc.jd)||void 0===yb?void 0:yb.Tvm)||void 0===Tc?void 0:Tc.appendChild(null===bd||void 0===bd?void 0:bd.va);bd.appendChild(this.Foe)}Mdn(){var yb;
const Tc=this.sa.zd();if(d.AFrameworkApplication.ha.getBooleanAppSetting("RewriteViewElementImprovement")){var bd=null===(yb=Tc[0])||void 0===yb?void 0:yb.yc(this.zb.Ua);this.AZm();yb=null===bd||void 0===bd?void 0:bd.Lu();bd=document.getElementById(this.bTl);if(!yb||!bd)return this.Foe.va;this.Foe.setPosition(yb.Mc-bd.getBoundingClientRect().width-this.f_m,yb.hd);return this.Foe.va}yb=null===(bd=Tc[0])||void 0===bd?void 0:bd.yc(this.zb.Ua);bd=new Hj.a;bd.va.id="RewriteIndicatorId";yb.htmlElement.appendChild(bd.va);
return bd.va}v9l(yb,Tc){if(!yb||0>=yb.length)return!1;const bd=yb.trim().split(this.WSl);Tc=Tc&&ub.a("minWordLimitForTitle")?this.d_m:this.c_m;return bd.length>=Tc||ub.a("CJKContentEligibility")&&(this.ZUe(yb.trim(),"ja")>=Tc||this.ZUe(yb.trim(),"zh")>=Tc)}ZUe(yb,Tc){var bd,kd;if(!yb||!Tc)return 0;let zd="\\b";"ja"===Tc?zd="[\\p{Script=Hiragana}\\p{Script=Katakana}\\p{Script=Han}\u30fc]":"zh"===Tc&&(zd="[\\p{Script=Han}]");return null!==(kd=null===(bd=yb.match(new RegExp(zd,"gu")))||void 0===bd?void 0:
bd.length)&&void 0!==kd?kd:0}u9l(yb){return yb&&18!==yb.vdb&&0!==yb.vdb}Iwn(yb){if(!this.u9l(yb))return!0;yb=this.La.M2f(yb);if(!yb)return!1;yb=yb.split("\n");if(yb.length>=this.a_m)return!0;for(const Tc of yb){if(null===Tc||void 0===Tc||!Tc.length)break;if(Tc.trim().split(this.WSl).length>=this.b_m)return!0}return!1}$xn(yb){switch(yb){case 0:case 3:case 2:case 1:case 8:case 6:case 5:return!0;default:return!1}}Byn(yb){if(yb.Bl)switch(yb.placeholderType){case 1:case 8:return!0}else if(ub.a("EnableRewriteForTextbox"))return yb.yr;
return!1}Rxn(yb){return ub.a("EnableRewriteForShapesAndTextbox")?!(yb.gd||yb.Im||yb.xg):yb.isGif||yb.Pg||2==yb.mediaType||1==yb.mediaType}}Object(c.a)(zi,"RewriteSelectionManager",null,[1042]);var Mi=a(399),sf=a(464),ki=a(1121);class qh{constructor(yb,Tc){this.Vkl=new Map;this.isInitialized=!1;if(!yb)throw Error.argumentNull("pptAugLoopRuntimeManager");if(!Tc)throw Error.argumentNull("currentShapeSelectionStore");this.g4=yb;this.R$=Tc}initialize(){this.isInitialized||(this.g4.execute(yb=>{yb.v2(yg.RewriteAnswer.getTypeName());
yb.ZFa(yg.RewriteAnswer.getTypeName(),this.npn.bind(this))}),this.isInitialized=!0)}TKh(yb){return Object(Z.b)(this,void 0,void 0,function*(){this.initialize();return yield this.sdn(yb.mNf,yb.inputType,yb.l2i,this.Fkn(yb))})}Fkn(yb){return Object(ub.a)("SendPrevSuggestionsToAL")&&(null===yb||void 0===yb?void 0:yb.inputType)==yg.RewriteType.Title?{title:this.Nmn(yb)}:{concise:this.qfn(yb),bullet:{},paraphrase:this.Djn(yb)}}qfn(yb){return{makeBullet:yb.Cil}}Djn(yb){return{makeBullet:yb.Cil,prevSuggestions:Object(ub.a)("SendPrevSuggestionsToAL")?
this.R$.W3l(yg.RewriteSuggestionType.Paraphrase):void 0}}Nmn(yb){const Tc=this.R$.W3l(yg.RewriteSuggestionType.Title);(null===yb||void 0===yb?0:yb.DCm)&&Tc.push(yb.DCm);return{prevTitles:Tc}}sdn(yb,Tc,bd,kd){return Object(Z.b)(this,void 0,void 0,function*(){const zd=cc.a.create().toString(),fe=this.s3m(zd,yb,Tc,bd,kd,this.R$.Ofn(bd));this.g4.execute(pf=>{pf.submitOperation(fe.operation)});const Ye=new ki.a;this.Vkl.set(zd,Ye);return Ye.completion})}s3m(yb,Tc,bd,kd,zd,fe){Tc=new yg.RewriteSignal({input:Tc,
modelType:bd,requestedSuggestionTypes:kd,modelParams:zd,regenSequence:fe});yb=new sf.a({parentPath:[Mi.a.getTypeName(),Db.a.getTypeNameFor(Tc)],items:[{id:yb,body:Tc}]});return Object.assign(new U.a,{operation:yb})}VHn(yb){return{rewriteSuggestions:yb.suggestions.map(Tc=>({text:Tc.content,type:Tc.type})),statusCode:yb.status}}npn(yb){if(yb){var Tc=this.Bln(yb.parentPath),bd=this.Vkl.get(Tc);bd&&(this.Vkl.delete(Tc),bd.resolve(this.VHn(yb)))}}Bln(yb){return yb[2]}}Object(c.a)(qh,"RewriteSuggestionGenerator",
null,[1041]);var Hh=a(215),Ei=a(124),Xg=a(187),Ee=a(237),Jf=a(114),Ze=a(88),Xj=a(371),Ij=a(552),xj=a.n(Ij);class nh{constructor(yb){this.P4b=yb}tEb(yb,Tc,bd){const kd=this.vmj(Tc,yb);this.showDialog(kd,yb,Tc,bd)}showDialog(yb,Tc,bd,kd){function zd(Ye){Lb.a.$(508847713,811,20,"Feedback dialog dismissed. IsFeedbackSent={0}; FeatureArea={1}; IsLikeDialog={2}",Ye,bd,Tc);kd&&kd(Ye,bd)}const fe=this.Rq;Be.a.Kld().then(Ye=>{Ye.initializeFeedbackModal(yb,zd,fe)})}Rq(yb){Lb.a.$(508847712,811,10,"Error in submitting feedback: "+
yb)}vmj(yb,Tc=!1){var bd={};d.AFrameworkApplication.ha.Jjc(bd);bd=this.P4b.getContext(bd)||{};bd.uiType="Modal";bd.screenshot=!0;bd.showEmailAddress=!0;Tc?bd.initialFeedbackType="Smile":(bd.scenarioConfig={isScenarioEnabled:!0,scenarioType:"ResponsibleAI"},bd.initialFeedbackType="Frown");Tc=bd.telemetryGroup||{};Tc.processSessionId=bd.sessionId;Tc.officeBuild=bd.build;Tc.featureArea=yb;bd.telemetryGroup=Tc;return bd}}Object(c.a)(nh,"RewriteFeedback",null,[]);var fh=a(103);class ng{constructor(yb,
Tc,bd,kd,zd,fe,Ye,pf,Je,Ff,Cg,sh,Og,Ch){this.$Zm="<li>";this.ZZm="</li>";this.IRa=this.O6b=!0;this.I8n=()=>{if(this.O6b)return 8;this.Svm(void 0);return 32};this.Uvm=Pg=>Object(Z.b)(this,void 0,void 0,function*(){if(Pg.keyCode===Hh.a.nv){Pg.stopPropagation();Pg.preventDefault();const ch=document.activeElement;ch&&(Ei.FocusManager.vz(ch),ch.click())}else Pg.keyCode===Hh.a.RZa&&(Pg.stopPropagation(),Pg.preventDefault(),yield this.EVe())});this.onShapeSelected=()=>Object(Z.b)(this,void 0,void 0,function*(){this.O6b&&
this.IRa||this.nbm();this.R$.reset();this.O6b||(yield this.ekd());this.IRa||(yield this.EVe());(!ub.a("EnableSlideContentValidation")||this.HW.qYj)&&this.HW.Vsb&&(yield this.Uzm())});this.dxa=()=>Object(Z.b)(this,void 0,void 0,function*(){this.O6b&&this.IRa||this.nbm();this.R$.reset();this.O6b||(yield this.ekd());this.IRa||(yield this.EVe())});this.tE=(Pg,ch)=>Object(Z.b)(this,void 0,void 0,function*(){if(ch&&ch.uE){var Fi=ub.a("EnableSlideContentValidation")?this.HW.qYj:!0,Gi=ub.a("RewriteShapeSelectionIssueFixes")?
this.HW.Dyn(ch.gl):this.HW.$wn(ch.gl);Fi&&this.HW.Vsb&&Gi?this.IRa&&(yield this.onShapeSelected(Pg,ch)):yield this.dxa(Pg,ch)}});this.Vvm=(Pg,ch)=>Object(Z.b)(this,void 0,void 0,function*(){const Fi=ub.a("EnableSlideContentValidation")?this.HW.qYj:!0;ch.PJe&&Fi&&this.HW.Vsb?yield this.Uzm():ch.PJe||(this.IRa||(yield this.EVe()),yield this.ekd())});this.Yn=()=>Object(Z.b)(this,void 0,void 0,function*(){this.O6b||(yield this.ekd())});this.s1=Pg=>Object(Z.b)(this,void 0,void 0,function*(){if(this.KDa=
Pg)this.O6b||(yield this.ekd()),this.IRa||(yield this.EVe())});this.Svm=Pg=>Object(Z.b)(this,void 0,void 0,function*(){var ch;const Fi=performance.now();null===Pg||void 0===Pg?void 0:Pg.stopPropagation();yield this.ekd();const Gi=this.HW.aIb;this.R$.X6k=Gi;this.R$.wsd=null===(ch=this.rb.zd()[0])||void 0===ch?void 0:ch.id;yield this.Hjl();var $g=yield this.x1l();yield this.VXe();if(this.HW.tZe(this.R$.wsd)){ch=null===$g||void 0===$g?void 0:$g.statusCode;$g=this.K_l($g);var gh=yg.RewriteCompletionStatus.Success===
ch&&0<(null===$g||void 0===$g?void 0:$g.length);gh?(yield this.wkl($g,void 0),this.fEm($g),fh.c(Od.a.kfh,!0,void 0,0,30,performance.now()-Fi,{currentSelectionType:Gi,showSuggestionCard:gh,generatedSuggestionType:this.H_l($g)})):(Lb.a.$(508866837,816,10,"No suggestions returned for selected shape with status code: ${statusCode}"),fh.c(Od.a.kfh,!1,void 0,0,30,performance.now()-Fi,{errorMsg:"No suggestions returned for selected shape with status code: ${statusCode}"}),yield this.Cnh(ch))}});this.onLayerMounted=
()=>Object(Z.b)(this,void 0,void 0,function*(){const Pg=document.getElementById("RewriteSuggestionsBodyId");Pg&&(Ei.FocusManager.vz(Pg),this.LTm())});this.onLikeSuggestionClicked=Pg=>{if(this.ohm)try{this.ohm.tEb(Pg,"Copilot Rewrite",null),fh.c(Od.a.NYh,!0,void 0,0,30,0,{isFeedbackTypeLiked:Pg})}catch(ch){Lb.a.$(508851866,811,10,"Copilot Rewrite: Feedback dialog failed to open with error={0}; isLikeDialog={1}",ch.toString(),Pg),fh.c(Od.a.NYh,!1,void 0,0,30,0,{errorMsg:"Copilot Rewrite: Feedback dialog failed to open with error=${e.toString()}; isLikeDialog=${isLikeClicked}"})}else Lb.a.$(508851867,
811,10,"Copilot Chat: ActionAIFeedback is received as null"),fh.c(Od.a.NYh,!1,void 0,0,30,0,{errorMsg:"Copilot Chat: ActionAIFeedback is received as null"})};this.Oxi=Pg=>Object(Z.b)(this,void 0,void 0,function*(){var ch=performance.now();const Fi=this.HW.aIb,Gi=this.R$.FQh;this.IRa||(yield this.EVe());var $g=Pg.suggestionText;$g.startsWith('"')&&($g=$g.replace(/(^")|("$)/g,""));$g=xj.a.sanitize($g);if(ub.a("EnableReplaceTextJsonCmd")){var gh=this.rb.zd();if(1!=(null===gh||void 0===gh?void 0:gh.length)){Lb.a.$(508846176,
816,10,"Selected Shape Not Found");this.cPg.rewriteLogActivity("ShapeSelectionError",!1,0,{errorMsg:"Selected Shape Not Found"});return}$g={id:gh[0].get_sid(),type:1,cId:gh[0].get_cid(),shapeId:gh[0].get_shapeId(),text:$g,textFormat:1,removeBullet:ub.a("FixBulletToParaTextInRewrite")&&!this.Zyn($g)};ub.a("RewriteUseUpdatedApplyJOfcCommands")?JSON.parse(yield this.Vgb.applyJOfcCommands(JSON.stringify([{data:$g,name:"ReplaceTextCmd"}]),"","","","RewriteActor")).FSuccess||(Lb.a.$(508834818,816,10,"Rewrite:: JOFC command execution failed"),
fh.c(Od.a.MYh,!1,void 0,0,30,performance.now()-ch,{errorMsg:"Rewrite:: JOFC command execution failed"}),yield this.Cnh(yg.RewriteCompletionStatus.Unknown)):(yield this.Vgb.OJh(JSON.stringify($g),"ReplaceTextCmd"))||(Lb.a.$(508846175,816,10,"Rewrite:: JOFC command execution failed"),fh.c(Od.a.MYh,!1,void 0,0,30,performance.now()-ch,{errorMsg:"Rewrite:: JOFC command execution failed"}),yield this.Cnh(yg.RewriteCompletionStatus.Unknown))}else gh=new Xj.a,gh.Nua=!0,gh.fP=$g,this.la.Ra(Od.a.Pna,2,gh);
fh.c(Od.a.MYh,!0,void 0,0,30,performance.now()-ch,{currentSelectionType:Fi,appliedSuggestionType:Pg.suggestionType,visitedSuggestions:Gi});ub.a("DeselectShapesOnReplace")&&(ch=this.rb.zd())&&this.rb.gwa(ch)});this.B4n=Pg=>Object(Z.b)(this,void 0,void 0,function*(){const ch=performance.now();yield this.ekd();yield this.Hjl();var Fi=yield this.A4n(Pg);yield this.VXe();if(this.HW.tZe(this.R$.wsd)){Fi=null===Fi||void 0===Fi?void 0:Fi.statusCode;var Gi=this.R$.Sfn(),$g=yg.RewriteCompletionStatus.Success===
Fi&&0<(null===Gi||void 0===Gi?void 0:Gi.length);$g?yield this.wkl(Gi,Pg):(Lb.a.$(508866836,816,10,"No suggestions returned for selected type: ${currentSuggestionType} with status code: ${statusCode}"),fh.c(Od.a.lfh,!1,void 0,0,30,performance.now()-ch,{errorMsg:"No suggestions returned for selected type: ${currentSuggestionType} with status code: ${statusCode}"}),yield this.Cnh(Fi));fh.c(Od.a.lfh,!0,void 0,0,30,performance.now()-ch,{currentSelectionType:this.HW.aIb,showSuggestionCard:$g,generatedSuggestionTypes:Pg.toString()})}});
this.E8n=Pg=>Object(Z.b)(this,void 0,void 0,function*(){null===Pg||void 0===Pg?void 0:Pg.stopPropagation();const ch=performance.now();yield this.ekd();yield this.Hjl();var Fi=yield this.x1l();yield this.VXe();if(this.HW.tZe(this.R$.wsd)){var Gi=null===Fi||void 0===Fi?void 0:Fi.statusCode;Fi=this.K_l(Fi);var $g=yg.RewriteCompletionStatus.Success===Gi&&0<(null===Fi||void 0===Fi?void 0:Fi.length);$g?(yield this.wkl(Fi,void 0),this.fEm(Fi)):(Lb.a.$(508827721,816,10,"No suggestions returned for selected shape with status code: ${statusCode} on retry"),
fh.c(Od.a.lfh,!1,void 0,0,30,performance.now()-ch,{errorMsg:"No suggestions returned for selected shape with status code: ${statusCode} on retry"}),yield this.Cnh(Gi));fh.c(Od.a.lfh,!0,void 0,0,30,performance.now()-ch,{currentSelectionType:this.HW.aIb,showSuggestionCard:$g,generatedSuggestionTypes:this.H_l(Fi)})}});this.$On=Pg=>{this.R$.fxf(Pg)};if(!yb)throw Error.argumentNull("actionManager");if(!Tc)throw Error.argumentNull("graphOperationEventSource");if(!bd)throw Error.argumentNull("viewElementEventSource");
if(!kd)throw Error.argumentNull("rewriteSelectionManager");if(!zd)throw Error.argumentNull("rewriteSuggestionGenerator");if(!fe)throw Error.argumentNull("pptSelectionManager");if(!Ye)throw Error.argumentNull("viewEventNotifier");if(!pf)throw Error.argumentNull("customerFeedbackUiWrapper");if(!Je)throw Error.argumentNull("copilotProxy");if(!Ff)throw Error.argumentNull("appFrame");if(!Cg)throw Error.argumentNull("coreEventHandler");if(!sh)throw Error.argumentNull("currentShapeSelectionStore");if(!Og)throw Error.argumentNull("rewriteActivityLogger");
if(!Ch)throw Error.argumentNull("focusManager");this.xp=Tc;this.qF=bd;this.HW=kd;this.phm=zd;this.la=yb;this.rb=fe;this.Oe=Ye;this.ohm=new nh(pf);this.qrg=this.kvn();this.Vgb=Je;this.Gb=Ff;this.ud=Cg;this.R$=sh;this.cPg=Og;this.Na=Ch}Kb(){this.xp.Tjc(this.onShapeSelected);this.xp.hid(this.dxa);this.qF.Ujc(this.dxa);this.rb.AO(this.tE);this.Oe.PQl(this.Vvm);d.AFrameworkApplication.Ha.mZ(this.Yn);this.Gb.lXa(this.s1);this.ud.fKd(this.dxa);this.ud.GF(this.dxa);ub.a("RewriteIndicatorShortcutRegister")&&
this.la.ua(Od.a.kfh,Gd.a.application,this.I8n,4)}dispose(){this.xp.C4e(this.onShapeSelected);this.xp.vYh(this.dxa);this.qF.H7c(this.dxa);this.rb.gib(this.tE);this.Oe.Tum(this.Vvm);this.Gb.bLb(this.s1);this.ud.xch(this.dxa);this.ud.kaa(this.dxa)}Ae(){if(ub.a("RewriteIndicatorShortcutRegister")){const yb=this.Na.Uc(Xg.AFrame.Wl);null===yb||void 0===yb?void 0:yb.bindAction(Ee.a.hb(Hh.a.gjc,1|Ee.a.Ne),Od.a.kfh)}}LTm(){this.Htm();Jf.a.addHandler(document.getElementById("RewriteSuggestionsBodyId"),Ze.a.oi,
this.Uvm)}Htm(){Jf.a.removeHandler(document.getElementById("RewriteSuggestionsBodyId"),Ze.a.oi,this.Uvm)}kvn(){const yb=document.createElement("div");yb.id="RewriteCardId";document.body.appendChild(yb);return yb}Uzm(){return Object(Z.b)(this,void 0,void 0,function*(){if(this.O6b&&!this.KDa&&1!==this.Gb.mode){this.O6b=!1;var yb={onRewriteIndicatorClick:this.Svm,getTargetRect:d.AFrameworkApplication.ha.getBooleanAppSetting("RewriteViewElementImprovement")?void 0:this.HW.kNf,isIndicatorHidden:!1,targetPlaceholderType:this.HW.aIb};
yield(yield Be.a.tld()).renderContextualCard("RewriteIndicator",this.NEn=this.HW.Mdn(),yb);this.cPg.rewriteLogActivity("RewriteIndicatorCardShown",!0)}})}ekd(){var yb,Tc;return Object(Z.b)(this,void 0,void 0,function*(){this.O6b=!0;(yield Be.a.tld()).dispose(this.NEn);d.AFrameworkApplication.ha.getBooleanAppSetting("RewriteViewElementImprovement")?null===(yb=document.getElementById("RewriteIndicatorView"))||void 0===yb?void 0:yb.remove():null===(Tc=document.getElementById("RewriteIndicatorId"))||
void 0===Tc?void 0:Tc.remove()})}wkl(yb,Tc){return Object(Z.b)(this,void 0,void 0,function*(){this.IRa||(yield this.VXe());if(this.HW.tZe(this.R$.wsd)){var bd={getTargetRect:this.HW.sMh(),placeholderOverflow:this.HW.VLh(),rewriteCardState:1,isCardHidden:!1,rewriteSuggestions:yb,suggestionCount:yb.length,targetPlaceholderType:this.HW.aIb,currentRegeneratedSuggestionType:Tc,onReplaceSuggestionClicked:this.Oxi,onRegenerateSuggestionsClicked:this.B4n,onLikeSuggestionClicked:this.onLikeSuggestionClicked,
onNextSuggestionClicked:this.$On,onLayerMounted:this.onLayerMounted};yield(yield Be.a.tld()).renderContextualCard("RewriteContextualCard",this.qrg,bd);this.IRa=!1}})}Cnh(yb){return Object(Z.b)(this,void 0,void 0,function*(){this.IRa||(yield this.VXe());if(this.HW.tZe(this.R$.wsd)){var Tc={placeholderOverflow:this.HW.VLh(),targetPlaceholderType:this.HW.aIb,getTargetRect:this.HW.sMh(),rewriteCardState:2,isCardHidden:!1,rewriteErrorState:this.b3m(yb),onRetryButtonClicked:this.E8n,onLayerMounted:this.onLayerMounted};
yield(yield Be.a.tld()).renderContextualCard("RewriteContextualCard",this.qrg,Tc);this.IRa=!1;fh.a("ErrorContextualCardShown",!0)}})}Hjl(){return Object(Z.b)(this,void 0,void 0,function*(){this.IRa||(yield this.VXe());if(this.HW.tZe(this.R$.wsd)){var yb={placeholderOverflow:this.HW.VLh(),getTargetRect:this.HW.sMh(),targetPlaceholderType:this.HW.aIb,rewriteCardState:0,isCardHidden:!1,onLayerMounted:this.onLayerMounted};yield(yield Be.a.tld()).renderContextualCard("RewriteContextualCard",this.qrg,yb);
this.IRa=!1;fh.a("LoadingContextualCardShown",!0)}})}VXe(){return Object(Z.b)(this,void 0,void 0,function*(){const yb={getTargetRect:this.HW.sMh(),isCardHidden:!0};yield(yield Be.a.tld()).renderContextualCard("RewriteContextualCard",this.qrg,yb);this.IRa=!0})}EVe(){return Object(Z.b)(this,void 0,void 0,function*(){this.Htm();(yield Be.a.tld()).dispose(this.qrg);this.IRa=!0})}x1l(){return Object(Z.b)(this,void 0,void 0,function*(){var yb=this.HW.eWi();if(null!==yb&&void 0!==yb&&yb.mNf)return yb=yield this.phm.TKh(yb),
this.R$.eEm(yb),yb;Lb.a.$(508870787,816,50,"Ineligible shape selection for ALRewrite");this.cPg.rewriteLogActivity("ShapeSelectionError",!1,0,{errorMsg:"Ineligible shape selection for ALRewrite"})})}A4n(yb){return Object(Z.b)(this,void 0,void 0,function*(){var Tc=this.HW.eWi();if(null!==Tc&&void 0!==Tc&&Tc.mNf){var bd=this.Edn(yb);if(!(0>=bd.length))return this.R$.Stn(bd[0]),Tc.l2i=bd,Tc=yield this.phm.TKh(Tc),this.R$.eEm(Tc),Tc}else Lb.a.$(508823500,816,50,"Ineligible shape selection for ALRewrite")})}Edn(yb){switch(yb){case 0:return[yg.RewriteSuggestionType.Bullet];
case 1:return[yg.RewriteSuggestionType.Concise];case 2:return[yg.RewriteSuggestionType.Paraphrase];case 3:return[yg.RewriteSuggestionType.Title];default:return[]}}K_l(yb){var Tc;const bd=[];null===(Tc=null===yb||void 0===yb?void 0:yb.rewriteSuggestions)||void 0===Tc?void 0:Tc.filter(kd=>!!kd.text).forEach(kd=>{bd.push({suggestionText:kd.text,suggestionType:kd.type})});return bd}b3m(yb){switch(yb){case yg.RewriteCompletionStatus.OffensiveContentInput:case yg.RewriteCompletionStatus.OffensiveContentOutput:return 0;
case yg.RewriteCompletionStatus.UnsupportedLanguage:return 2;default:return 1}}H_l(yb){const Tc=[];yb.forEach(bd=>{Tc.push(bd.suggestionType)});return Tc.join(",")}nbm(){fh.c(Od.a.Rvm,!0,void 0,0,30,void 0,{currentSelectionType:this.R$.X6k,visitedSuggestions:this.R$.FQh,isRewriteIndicatorDisposed:!this.O6b,isRewriteContextualCardDisposed:!this.IRa})}fEm(yb){yb=new Set(yb.map(Tc=>Tc.suggestionType));yb.has(3)?this.R$.fxf(3):yb.has(0)?this.R$.fxf(0):yb.has(1)?this.R$.fxf(1):this.R$.fxf(2)}Zyn(yb){return yb.includes(this.$Zm)&&
yb.includes(this.ZZm)}}Object(c.a)(ng,"RewriteActor",null,[502]);class R{constructor(){this.kSh=24}u0m(yb,Tc){const bd={isPlaceholderOverflowing:!1,overflowDirection:void 0};yb&&Tc&&(yb.y+yb.height>=Tc.height+Tc.y&&(bd.isPlaceholderOverflowing=!0,bd.overflowDirection=0),yb.x<Tc.x&&(bd.isPlaceholderOverflowing=!0,bd.overflowDirection=1),yb.y+yb.height>=Tc.height+Tc.y&&yb.x<Tc.x&&(bd.overflowDirection=2));return bd}hhn(yb,Tc,bd){const kd=new Sys.UI.Bounds(0,0,0,0);if(yb.isPlaceholderOverflowing){switch(yb.overflowDirection){case 0:kd.x=
bd.x;kd.width=bd.width;kd.y=Tc.y;kd.height=Tc.height;break;case 1:kd.x=Tc.x+this.kSh;kd.width=Tc.width-this.kSh;kd.y=bd.y;kd.height=bd.height;break;case 2:kd.x=Tc.x+this.kSh,kd.width=Tc.width-this.kSh,kd.y=Tc.y,kd.height=Tc.height}return kd}return bd}}Object(c.a)(R,"ShapeTargetBounds",null,[981]);class Ha{constructor(yb){this.HTg=[];this.$Sl=0;this.KGn=yb}get window(){return this.HTg}QTm(yb){this.HTg[this.$Sl%this.KGn]=yb;this.$Sl++}}Object(c.a)(Ha,"SuggestionWindow",null,[]);class wb{constructor(yb){this.Mak=
new Map;this.FQh=new Set;this.NNg=new Map;this.hlk=this.qak=this.E$j=0;this.VGn=yb}Sfn(){const yb=[];this.Mak.forEach((Tc,bd)=>{(null===Tc||void 0===Tc?0:Tc.text)&&yb.push({suggestionText:Tc.text,suggestionType:bd})});return yb}eEm(yb){var Tc;0<(null===(Tc=null===yb||void 0===yb?void 0:yb.rewriteSuggestions)||void 0===Tc?void 0:Tc.length)&&yb.rewriteSuggestions.forEach(bd=>{this.Mak.set(bd.type,bd);Object(ub.a)("SendPrevSuggestionsToAL")&&this.IUm(bd)})}fxf(yb){this.FQh.add(yb)}get wsd(){return this.qdm}set wsd(yb){this.qdm=
yb}get X6k(){return this.rdm}set X6k(yb){this.rdm=yb}W3l(yb){return(yb=this.NNg.get(yb))?Array.from(yb.window):[]}IUm(yb){this.NNg.has(yb.type)||this.NNg.set(yb.type,new Ha(this.VGn));this.NNg.get(yb.type).QTm(yb.text)}Ofn(yb){if(1!=yb.length)return 0;switch(yb[0]){case yg.RewriteSuggestionType.Bullet:return this.E$j;case yg.RewriteSuggestionType.Concise:return this.qak;case yg.RewriteSuggestionType.Paraphrase:return this.hlk;default:return 0}}Stn(yb){switch(yb){case yg.RewriteSuggestionType.Bullet:this.E$j++;
break;case yg.RewriteSuggestionType.Concise:this.qak++;break;case yg.RewriteSuggestionType.Paraphrase:this.hlk++}}reset(){this.Mak.clear();this.FQh.clear();this.NNg.clear();this.hlk=this.qak=this.E$j=0;this.rdm=this.qdm=null}}Object(c.a)(wb,"CurrentShapeSelectionStore",null,[]);var Yb=a(144);class zc{rewriteLogActivity(yb,Tc,bd=0,kd=null){const zd=[];if(kd)for(const [fe,Ye]of Object.entries(kd))this.ZLa(fe,Ye,zd);fh.a(yb,Tc,bd,zd)}ZLa(yb,Tc,bd){bd.push(Object.assign(new Yb.a,{name:yb,string:Tc}))}}
Object(c.a)(zc,"RewriteActivityLogger",null,[980]);class Ic{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.CopilotRewrite"}oc(yb){if(yb){this.ga=yb;var Tc=this.ga.resolve("PowerPointWebEditor.IApplicationSettings");Tc.c2i&&this.ga.register(ei,"PowerPointWebEditor.CopilotRewrite.EditorPaneActor").oa().pa(()=>new ei(this.ga.resolve("Common.IActionManagerExtended")));this.yPj(this.ga)&&(this.ga.register(wb,"PowerPointWebEditor.CopilotRewrite.CurrentShapeSelectionStore").oa().pa(()=>
new wb(Tc.Ac("RewritePrevSuggestionWindowSize",3))),this.ga.register(zc,"PowerPointWebEditor.CopilotRewrite.RewriteActivityLogger").oa().pa(()=>new zc),this.ga.register(zi,"PowerPointWebEditor.CopilotRewrite.RewriteSelectionManager").as("PowerPointWebEditor.CopilotRewrite.IRewriteSelectionManager").oa().pa(()=>new zi(this.ga.resolve("PowerPointWebEditor.IShapeReader"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"),
this.ga.resolve("PowerPointWebEditor.IActiveSlideViewManager"),Tc,this.ga.resolve("PowerPointWebEditor.CopilotRewrite.IShapeTargetBounds"),this.ga.resolve("PowerPointWebEditor.CopilotRewrite.RewriteActivityLogger"),this.ga.resolve("PowerPointWebEditor.ISlideReader"))),this.ga.register(R,"PowerPointWebEditor.CopilotRewrite.ShapeTargetBounds").as("PowerPointWebEditor.CopilotRewrite.IShapeTargetBounds").oa().pa(()=>new R),this.ga.register(qh,"PowerPointWebEditor.CopilotRewrite.RewriteSuggestionGenerator").as("PowerPointWebEditor.CopilotRewrite.IRewriteSuggestionGenerator").oa().pa(()=>
new qh(this.ga.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.ga.resolve("PowerPointWebEditor.CopilotRewrite.CurrentShapeSelectionStore"))),this.ga.register(ng,"PowerPointWebEditor.CopilotRewrite.RewriteActor").oa().pa(()=>new ng(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.ga.resolve("PowerPointWebEditor.CopilotRewrite.IRewriteSelectionManager"),
this.ga.resolve("PowerPointWebEditor.CopilotRewrite.IRewriteSuggestionGenerator"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.View.IViewEventSource"),this.ga.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.ga.resolve("PowerPointWebEditor.ICopilotProxy"),this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.ga.resolve("PowerPointWebEditor.CopilotRewrite.CurrentShapeSelectionStore"),
this.ga.resolve("PowerPointWebEditor.CopilotRewrite.RewriteActivityLogger"),this.ga.resolve("PowerPointWebEditor.IFocusManager"))))}else Lb.a.$(508883090,822,10,"PptWebEditorRewritePackage::Container object not available")}init(){this.ga&&this.ga.resolve("Common.IAppSettingsManager").Wf(()=>{if(this.ga.resolve("PowerPointWebEditor.IApplicationSettings").c2i){var yb=this.ga.resolve("PowerPointWebEditor.CopilotRewrite.EditorPaneActor");yb.Kb();yb.Ae()}this.yPj(this.ga)&&(yb=this.ga.resolve("PowerPointWebEditor.CopilotRewrite.RewriteActor"),
yb.Kb(),yb.Ae())})}dispose(){this.ga.resolve("Common.IAppSettingsManager").Wf(()=>{this.yPj(this.ga)&&this.ga.resolve("PowerPointWebEditor.CopilotRewrite.RewriteActor").dispose()})}yPj(yb){yb=yb.resolve("PowerPointWebEditor.IApplicationSettings");return!(d.AFrameworkApplication.zB||d.AFrameworkApplication.Mz)&&(yb.Z4e||yb.getBooleanAppSetting("RewriteFeatureLicenseCheckEnabled")&&d.AFrameworkApplication.Cjd)}static main(){h.a.instance.Jc(new Ic)}}Object(c.a)(Ic,"PptWebEditorRewritePackage",null,[4,
5]);var Wc=a(178);class rd{constructor(yb,Tc){if(!yb)throw Error.argumentNull("selectionManager");if(!Tc)throw Error.argumentNull("pageView");this.sa=yb;this.zb=Tc}dispose(){}get kNf(){const yb=this.sa.zd();return 1===(null===yb||void 0===yb?void 0:yb.length)?yb[0].yc(this.zb.Ua).getBounds():new Sys.UI.Bounds(0,0,0,0)}get Vsb(){const yb=this.sa.zd();return 1===(null===yb||void 0===yb?void 0:yb.length)&&yb[0].Pg&&!!yb[0].RYe}get Qfn(){const yb=this.sa.zd();if(1===(null===yb||void 0===yb?void 0:yb.length)&&
yb[0].Pg)return yb[0].Djd}get c8l(){return"ImageReportHostId"}Nao(){var yb;const Tc=null===(yb=this.sa.zd()[0])||void 0===yb?void 0:yb.yc(this.zb.Ua);yb=new Hj.a;yb.va.id=this.c8l;Tc.htmlElement.appendChild(yb.va);return yb.va}}Object(c.a)(rd,"ImageReportSelectionManager",null,[1046]);class vd{constructor(yb,Tc){this.P4b=yb;this.Jb=Tc}tEb(yb,Tc,bd){Tc=this.vmj(yb,Tc);this.showDialog(Tc,yb,bd)}showDialog(yb,Tc,bd){const kd=fe=>{Lb.a.$(507876305,811,10,`ImageReportFeedback::showDialog - error in submitting feedback ${fe}`)},
zd=fe=>{Lb.a.$(507876306,811,20,`ImageReportFeedback::showDialog - feedback dialog dismissed with IsFeedbackSent=${fe} FeatureArea=${Tc}`);bd&&bd(fe,Tc)};Be.a.Kld().then(fe=>{fe.initializeFeedbackModal(yb,zd,kd);return fe})}vmj(yb,Tc){var bd={};this.Jb.Jjc(bd);bd=this.P4b.getContext(bd)||{};bd.uiType="Modal";bd.showEmailAddress=!0;bd.isScreenshotEnabled=!0;bd.isScreenRecordingEnabled=!1;bd.isFileUploadEnabled=!1;bd.isShareContextDataEnabled=!0;bd.getContextData=()=>{const zd=new File([Tc],"FeedbackAsset.json",
{type:"text/json"});return new Promise(fe=>{fe([zd])})};bd.scenarioConfig={isScenarioEnabled:!0,scenarioType:"ResponsibleAI"};bd.initialFeedbackType="Frown";const kd=bd.telemetryGroup||{};kd.processSessionId=bd.sessionId;kd.officeBuild=bd.build;kd.featureArea=yb;bd.telemetryGroup=kd;return bd}}Object(c.a)(vd,"ImageReportFeedback",null,[]);class Rd{constructor(yb,Tc,bd,kd,zd,fe,Ye){this.bgk=this.Pod=!1;this.onShapeSelected=()=>Object(Z.b)(this,void 0,void 0,function*(){this.Pod&&(yield this.oQf());
this.Dje.Vsb&&(yield this.Tzm())});this.dxa=()=>Object(Z.b)(this,void 0,void 0,function*(){this.Pod&&(yield this.oQf())});this.tE=(pf,Je)=>Object(Z.b)(this,void 0,void 0,function*(){Je&&Je.uE&&(this.Dje.Vsb?this.Pod||(yield this.onShapeSelected(pf,Je)):yield this.dxa(pf,Je))});this.d8l=(pf,Je)=>Object(Z.b)(this,void 0,void 0,function*(){Je.PJe?this.Dje.Vsb&&(yield this.Tzm()):yield this.oQf()});this.Yn=()=>Object(Z.b)(this,void 0,void 0,function*(){this.Pod&&(yield this.oQf())});this.s1=pf=>Object(Z.b)(this,
void 0,void 0,function*(){(this.KDa=pf)&&this.Pod&&(yield this.oQf())});this.lSn=()=>Object(Z.b)(this,void 0,void 0,function*(){if(this.hfm)try{this.hfm.tEb("Image Report",this.Dje.Qfn,null)}catch(pf){Lb.a.$(507876304,817,10,`PPTWebEditorImageReportPackage:onImageReportClickHandler Exception occurred trying to show feedback dialog. ${JSON.stringify(pf)}`)}});this.D0g=()=>Object(Z.b)(this,void 0,void 0,function*(){this.bgk=!0});if(!yb)throw Error.argumentNull("graphOperationEventSource");if(!Tc)throw Error.argumentNull("imageReportSelectionManager");
if(!bd)throw Error.argumentNull("pptSelectionManager");if(!kd)throw Error.argumentNull("customerFeedbackUiWrapper");if(!zd)throw Error.argumentNull("appFrame");if(!fe)throw Error.argumentNull("viewEventNotifier");if(!Ye)throw Error.argumentNull("coreEventHandler");this.xp=yb;this.Dje=Tc;this.rb=bd;this.hfm=new vd(kd,d.AFrameworkApplication.ha);this.Gb=zd;this.Oe=fe;this.ud=Ye}Kb(){this.xp.Tjc(this.onShapeSelected);this.xp.hid(this.dxa);this.rb.AO(this.tE);d.AFrameworkApplication.Ha.mZ(this.Yn);this.Gb.lXa(this.s1);
this.Oe.zQl(this.d8l);this.ud.fKd(this.dxa);this.ud.GF(this.dxa)}Ae(){}dispose(){this.xp.C4e(this.onShapeSelected);this.xp.vYh(this.dxa);this.rb.gib(this.tE);d.AFrameworkApplication.Ha.Sna(this.Yn);this.Gb.bLb(this.s1);this.Oe.Gum(this.d8l);this.ud.xch(this.dxa);this.ud.kaa(this.dxa)}Tzm(){return Object(Z.b)(this,void 0,void 0,function*(){if(!this.Pod&&!this.KDa&&this.bgk){this.Pod=!0;var yb={onImageReport:this.lSn,getTargetRect:this.Dje.kNf,buttonExpanded:!1};imageReport.renderReportImageUI(this.rHn=
this.Dje.Nao(),yb)}})}oQf(){var yb;return Object(Z.b)(this,void 0,void 0,function*(){this.Pod=!1;this.bgk&&imageReport.disposeReportImageUI(this.rHn);null===(yb=document.getElementById(this.Dje.c8l))||void 0===yb?void 0:yb.remove()})}}Object(c.a)(Rd,"ImageReportActor",null,[502]);class me{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.ImageReport"}oc(yb){yb?this.sxn(yb)&&(this.ga=yb,this.ga.register(rd,"PowerPointWebEditor.ImageReport.ImageReportSelectionManager").as("PowerPointWebEditor.ImageReport.IImageReportSelectionManager").oa().pa(()=>
new rd(this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"))),this.ga.register(Rd,"PowerPointWebEditor.ImageReport.ImageReportActor").oa().pa(()=>new Rd(this.ga.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),this.ga.resolve("PowerPointWebEditor.ImageReport.IImageReportSelectionManager"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),
this.ga.resolve("PowerPointWebEditor.View.IViewEventSource"),this.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler"))),this.dBn()):Lb.a.$(507876303,822,10,"PptWebEditorImageReport::Container object not available")}init(){this.ga&&this.ga.resolve("Common.IAppSettingsManager").Wf(()=>{const yb=this.ga.resolve("PowerPointWebEditor.ImageReport.ImageReportActor");yb.Kb();yb.Ae()})}dispose(){this.ga&&this.ga.resolve("Common.IAppSettingsManager").Wf(()=>{this.ga.resolve("PowerPointWebEditor.ImageReport.ImageReportActor").dispose()})}dBn(){Object(Z.b)(this,
void 0,void 0,function*(){Wc.a.get_instance().Ai(7,()=>Object(Z.b)(this,void 0,void 0,function*(){const yb=vg.a(this.ga);yield yb("imageReport");yb("imageReport").then(()=>{this.ga.resolve("PowerPointWebEditor.ImageReport.ImageReportActor").D0g()}).catch(Tc=>{Lb.a.$(507876302,817,10,`PPTWebEditorImageReportPackage:loadScript Exception while loading imageReport ${JSON.stringify(Tc)}`)})}))})}sxn(yb){return yb.resolve("PowerPointWebEditor.IApplicationSettings").getBooleanAppSetting("ImageReportEnabled")&&
d.AFrameworkApplication.Cjd}static main(){h.a.instance.Jc(new me)}}Object(c.a)(me,"PptWebEditorImageReportPackage",null,[4,5]);var ce=a(18);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.ContentUpdateDetection");Type.registerNamespace("PowerPointWebEditor.EditorPane");Type.registerNamespace("PowerPointWebEditor.EditorPane.MessageProcessing");Type.registerNamespace("PowerPointWebEditor.EditorPane.Messaging");
Type.registerNamespace("PowerPointWebEditor.EditorPane.Model");Type.registerNamespace("PowerPointWebEditor.EditorPane.Subscription");Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.EditorPaneV2");Type.registerNamespace("PowerPointWebEditor.TextPrediction");Object(ce.c)("AugLoop");pb.main();ee.main();$d.main();Tf.main();Ic.main();me.main();Object(ce.b)("AugLoop")},371:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.rga=
this.TZ=this.fP=null;this.b7a=this.Nua=!1;this.wAb=0;this.lc=null;this.yCa=this.g1b=this.xCa=!1;this.oCa=!0;this.reset()}reset(){this.TZ=[];this.fP=null;this.rga=[];this.b7a=this.Nua=!1;this.wAb=0;this.lc=null;this.yCa=this.g1b=this.xCa=!1;this.oCa=!0}}Object(y.a)(c,"HtmlPasteContext",null,[])},464:function(y,C,a){a.d(C,"f",function(){return b});a.d(C,"e",function(){return d});a.d(C,"i",function(){return e});a.d(C,"j",function(){return h});a.d(C,"a",function(){return n});a.d(C,"h",function(){return m});
a.d(C,"n",function(){return k});a.d(C,"o",function(){return l});a.d(C,"b",function(){return u});a.d(C,"k",function(){return r});a.d(C,"l",function(){return x});a.d(C,"d",function(){return v});a.d(C,"p",function(){return z});a.d(C,"c",function(){return A});a.d(C,"g",function(){return B});a.d(C,"m",function(){return G});var c=a(210);class b{constructor(w){c.a.assign(b,this,w)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(w){return c.a.matchesTypesFor(w,
[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class d{constructor(w){c.a.assign(d,this,w)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(w){return c.a.matchesTypesFor(w,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class e{constructor(w){c.a.assign(e,this,w)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(w){return c.a.matchesTypesFor(w,
[e.getTypeName()])}}e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class h{constructor(w){c.a.assign(h,this,w)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class n{constructor(w){c.a.assign(n,this,w)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext",
"AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class m{constructor(w){c.a.assign(m,this,w)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class k{constructor(w){c.a.assign(k,this,w)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,
[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class l{constructor(w){c.a.assign(l,this,w)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(w){c.a.assign(u,this,w)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,
[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class r{constructor(w){c.a.assign(r,this,w)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class x{constructor(w){c.a.assign(x,this,w)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,
[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class v{constructor(w){c.a.assign(v,this,w)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class z{constructor(w){c.a.assign(z,this,w)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,
[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class A{constructor(w){c.a.assign(A,this,w)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class B{constructor(w){c.a.assign(B,this,w)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,
[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class G{constructor(w){c.a.assign(G,this,w)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,[G.getTypeName()])}}G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25649181/wdjs/ppteditDS.augloop.js.map