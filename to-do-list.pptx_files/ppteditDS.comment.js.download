'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[23],{1064:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}c.Image16by16Class="Image16by16Class";c.Image32by32Class="Image32by32Class";c.On="On";c.LabelText="LabelText";c.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly";c.EnsureControlRoleIsButton="EnsureControlRoleIsButton";c.Visible="Visible";Object(y.a)(c,"SplitButtonCommandProperties",null,[])},1117:function(y,C,a){a.d(C,"a",function(){return c});
y=a(0);a=a(821);class c extends a.a{constructor(b,d){super(d);this.Vod=b;this.Twa=0}mWe(){const b=(new Date).getTime(),d=b-this.Twa;if(0<this.Twa&&0>=this.Vod-d)return this.Twa=0,this.LAc(),!0;this.Twa=b;this.LAc();this.setTimeout(this.Vod);return!1}}Object(y.a)(c,"FunctionDelayer",a.a,[])},1224:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(y.a)(c,"CalloutButtonProps",null,[])},1419:function(y,C,a){a.d(C,"a",
function(){return h});y=a(0);var c=a(21),b=a(111),d=a(43),e=a(61);a(110);class h{constructor(){this.zIa=null}get tmd(){return!1}zul(n,m){let k=new c.a;const l=new e.GraphTransaction(3);try{l.ld(d.App.Zb.Sd.eo.ih),this.dlg(m)&&(k=this.Fdg(m,k)),m!==n&&this.dlg(n)&&(k=this.Fdg(n,k))}finally{l&&l.dispose()}return k.toArray()}dlg(n){return!!n}cYh(n){let m=!1;for(const k of this.oFj)m||!Sys.UI.DomElement.containsCssClass(n,k.className)&&!Sys.UI.DomElement.containsCssClass(n,k.F8f)||(m=!0),b.a.dib(n,k.className),
b.a.dib(n,k.F8f)}}Object(y.a)(h,"AHighlightActor",null,[622])},1420:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(b,d){this.className=b;this.F8f=d}}Object(y.a)(c,"HighlightCssClassPair",null,[])},1421:function(y,C,a){a.d(C,"b",function(){return e});a.d(C,"a",function(){return h});var c=a(111);a(43);var b=a(61);a(47);a(105);var d=a(110);const e=n=>{const m=new b.GraphTransaction(3);try{m.ld(n),n.er(32,!0)}finally{m&&m.dispose()}},h=n=>{if(n){n=c.a.Iia(n);if(-1===n.indexOf(d.a.R2)&&
-1!==n.indexOf(d.a.KP)&&-1===n.indexOf(d.a.qRd))return 2;if(-1===n.indexOf(d.a.R2)&&(-1!==n.indexOf(d.a.Ujd)||-1!==n.indexOf(d.a.UP)||-1!==n.indexOf(d.a.qRd)||-1!==n.indexOf(d.a.jPd)||-1!==n.indexOf(d.a.fWb)||-1!==n.indexOf(d.a.pRd)||-1!==n.indexOf(d.a.xDc)||-1!==n.indexOf(d.a.yDc)||-1!==n.indexOf(d.a.vDc)||-1!==n.indexOf(d.a.wDc)||-1!==n.indexOf(d.a.TMf)||-1!==n.indexOf(d.a.PMf)||-1!==n.indexOf(d.a.QMf)||-1!==n.indexOf(d.a.mRd)||-1!==n.indexOf(d.a.NMf)))return 1;if(-1!==n.indexOf("WACImageContainer"))return 3}return 0}},
1422:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.type=this.action=0;this.y5c=this.ngb=null}}Object(y.a)(c,"HighlightOperation",null,[])},1898:function(y,C,a){a.r(C);var c=a(0),b=a(405),d=a(21),e=a(28),h=a(41);class n{}n.beginDraftingAsync="OSC:BDA";n.Ybn="OSC:FEQ";n.selectComment="OSC:SC";Object(c.a)(n,"CommentTaskNames",null,[]);class m{constructor(mb){this.kRa=mb;this.iEn=[]}get handler(){return this.kRa}get Mpb(){return this.iEn}}Object(c.a)(m,"RegisteredListener",
null,[]);class k{constructor(mb,lc){this.type=0;this.payload=null;this.type=mb;this.payload=lc}}Object(c.a)(k,"OfficeSharedCommentsEvent",null,[1798]);class l{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(c.a)(l,"ViewContainerEvent",null,[1798]);var u=a(1053);class r{constructor(mb){this.Tck=!1;this.R5=new d.a;this.Yb=mb}a5n(mb){mb=new m(mb);this.R5.add(mb)}NDm(mb){for(let lc=0;lc<this.R5.count;++lc)if(this.R5.ka(lc).handler===mb){this.R5.removeAt(lc);
break}}gfc(mb=!1){const lc=()=>{if(h.AFrameworkApplication.Ch)b.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let ud=0;ud<this.R5.count;++ud){const Qd=this.R5.ka(ud);for(;0<Qd.Mpb.length;){var Mc=Array.dequeue(Qd.Mpb);if(Object(e.a)(l,Mc)){var md=Qd.handler;md(Mc)}else Object(e.a)(k,Mc)&&(md=Qd.handler,md(Mc.type,Mc.payload))}}};mb?lc():this.Tck||(this.Tck=!0,u.a.Ljc(this.Yb,()=>{lc();this.Tck=!1},n.Ybn))}}Object(c.a)(r,"GenericEventHost",
null,[]);class x extends r{constructor(mb){super(mb)}t5n(mb){this.a5n(mb)}mlo(mb){this.NDm(mb)}Xym(mb){mb=this.N3m(mb);for(let lc=0;lc<this.R5.count;++lc)Array.enqueue(this.R5.ka(lc).Mpb,mb);this.gfc(!0)}N3m(mb){const lc=new l;lc.eventType=3;lc.viewContainerVisibilityState=mb;return lc}fcn(){const mb=this.m6m();for(let lc=0;lc<this.R5.count;++lc)Array.enqueue(this.R5.ka(lc).Mpb,mb);this.gfc(!0)}m6m(){const mb=new l;mb.eventType=2;return mb}}Object(c.a)(x,"ViewContainerEventHost",r,[1782]);class v{constructor(){this.numberOfThreads=
this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(c.a)(v,"BasicEventPayload",null,[1856]);class z{constructor(mb){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=mb}}Object(c.a)(z,
"CommentContextDetails",null,[]);class A{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(c.a)(A,"ContextChangeWithSelectedThreadIndex",null,[1856]);class B{constructor(){this.tasks=this.comments=null}}Object(c.a)(B,"LoadCommentsNoVirtualization",null,[1856]);class G extends r{constructor(mb){super(mb);this.XQm=0}d5n(mb,lc,Mc,md,ud,Qd,kb=0){mb=new m(mb);Qd&&Array.enqueue(mb.Mpb,
this.E3m(Qd,this.XQm));Qd=lc?lc.length:0;Array.enqueue(mb.Mpb,this.nWl(Qd,Mc,md,kb,null));Qd&&Array.enqueue(mb.Mpb,this.FWl(lc,ud));this.R5.add(mb);this.gfc()}Dwh(mb){this.NDm(mb)}F7k(mb,lc,Mc,md=0,ud=null){this.Amd(this.nWl(mb,lc,Mc,md,ud));this.gfc()}e$n(mb,lc,Mc,md,ud=null){this.Amd(this.P3m(mb,lc,Mc,md,ud));this.gfc()}qxm(mb,lc,Mc){this.Amd(this.R3m(mb,lc,Mc));this.gfc()}S7k(mb,lc){this.Amd(this.FWl(mb,lc));this.gfc()}selectComment(mb){this.Amd(this.YWl(mb,6));this.gfc()}highlightComment(mb){this.Amd(this.YWl(mb,
7));this.gfc()}Wtd(mb,lc){this.Amd(this.V4m(mb,lc));this.gfc()}wYn(mb,lc){this.Amd(this.W5m(mb,lc));this.gfc()}E3m(mb,lc=0){const Mc=new v;Mc.modelCapabilityFlags=mb;Mc.richTextCapabilityFlags=lc;return new k(12,Mc)}nWl(mb,lc,Mc,md,ud=null){const Qd=new v;Qd.numberOfComments=mb;Qd.numberOfThreads=lc;Qd.contextDetails=Object.assign(new z(Mc),{nextPopulatedContextDetails:md});Qd.contextDrafts=ud;Qd.rehydrationDrafts=null;return new k(0,Qd)}P3m(mb,lc,Mc,md,ud=null){const Qd=new A;Qd.numberOfComments=
mb;Qd.numberOfThreads=lc;Qd.selectedThreadIndex=Mc;Qd.contextDetails=Object.assign(new z(md),{nextPopulatedContextDetails:0});Qd.contextDrafts=ud;Qd.rehydrationDrafts=null;return new k(0,Qd)}R3m(mb,lc,Mc){const md=new v;md.comments=mb;md.numberOfThreads=lc;md.tasks=Mc;return new k(2,md)}FWl(mb,lc){const Mc=new B;Mc.comments=mb;Mc.tasks=lc;return new k(1,Mc)}YWl(mb,lc){const Mc=new v;Mc.commentId="";mb&&(Mc.commentId=mb);return new k(lc,Mc)}V4m(mb,lc){const Mc=new v;Mc.changes=[];Mc.contextDetails=
Object.assign(new z(lc),{nextPopulatedContextDetails:mb});return new k(10,Mc)}W5m(mb,lc){const Mc=new v;Mc.commentId=mb;Mc.smartReplies=lc;return new k(15,Mc)}Amd(mb){for(let lc=0;lc<this.R5.count;++lc)Array.enqueue(this.R5.ka(lc).Mpb,mb)}}Object(c.a)(G,"OfficeSharedCommentsEventHost",r,[1847]);var w=a(38);class F{constructor(){this.ONl=this.jOl=!1;this.fSm=[]}get z7e(){return this.fSm}get sLe(){return this.jOl}set sLe(mb){this.jOl=mb;for(const lc of this.z7e)lc.sLe=mb}get sHe(){return this.ONl}set sHe(mb){this.ONl=
mb;for(const lc of this.z7e)lc.sHe=mb}vdd(mb){for(const lc of this.z7e)mb=lc.vdd(mb);return mb}}Object(c.a)(F,"AggregateCommentTaskPersonTransformer",null,[1874]);var H=a(132);class E{constructor(mb,lc,Mc,md,ud=!1){this.priority=this.completion=-1;this.type=mb;this.user=lc;this.time=Mc;this.recordId=md;this.isLossy=ud}}Object(c.a)(E,"HistoryRecord",null,[]);class P{constructor(mb,lc){this.iPm=new w.a(()=>lc.vdd(mb.value))}Xfn(){return new Date}QCc(mb,lc,Mc){if(0===mb)throw b.ULS.sendTraceTag(594650201,
327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");const md=H.a.create().toString();Mc=new E(mb,this.iPm.value,Mc,md,!1);Mc.commentId=lc;b.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",mb);return Mc}}Object(c.a)(P,"HistoryRecordFactory",null,[1875]);class T{constructor(){this.endDate=this.startDate=null}}Object(c.a)(T,"CommentTaskSchedule",null,[]);class K{constructor(mb,
lc,Mc,md,ud,Qd){this.isLossy=mb;this.title=lc;this.assignees=Mc;this.schedule=md;this.completion=ud;this.priority=Qd}}Object(c.a)(K,"CommentTaskState",null,[]);class M{constructor(){this.commentId=null}}Object(c.a)(M,"HistoryItem",null,[]);class N{constructor(mb,lc,Mc,md,ud,Qd,kb){this.Oci=!1;if(1!==lc.type)throw Error.argument("createRecord");this.hef=Mc;this.eef=md;this.fef=ud;this.rMl=1;this.ADh=mb;this.FPm=Qd;this._state=new K(!1,this.hef,kb,new T,this.fef,this.eef);this._history=[];this.MWl(lc)}jVe(mb,
lc){if(1!==mb.type)throw Error.argument("createRecordTemplate");const Mc=N.nmn(mb,this.rMl);this.rMl++;return Object.assign(new E(lc,mb.user,mb.time,Mc),{commentId:mb.commentId})}get Kam(){return this.history[this.history.length-1]}get I6l(){return this.state.completion===this.fef}get H6l(){return this.state.priority===this.eef}get J6l(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get K6l(){return this.state.title===
this.hef}MWl(mb){mb=Object.assign(new M,{commentId:mb.commentId,records:[mb]});this.history.push(mb)}S1l(mb){let lc=-1;for(let Mc=0;Mc<this.state.assignees.length;Mc++)if(this.ADh.equals(this.state.assignees[Mc],mb)){lc=Mc;break}return lc}Rco(mb){const lc=this.Kam,Mc=lc.records[lc.records.length-1];return this.ADh.equals(Mc.user,mb.user)&&lc.commentId===mb.commentId&&Mc.time.getTime()===mb.time.getTime()?!0:!1}$mo(mb){switch(mb.type){case 2:-1===this.S1l(mb.assignee)&&this.state.assignees.push(mb.assignee);
break;case 3:const lc=this.S1l(mb.assignee);0<=lc&&this.state.assignees.splice(lc,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=mb.schedule;break;case 6:this.state.completion=mb.completion;break;case 9:this.state.title=mb.title;break;case 10:this.state.priority=mb.priority;break;case 0:this.state.isLossy=!0;break;case 1:b.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.Oci=!0;break;case 8:this.Oci=!1;break;case -1:b.ULS.sendTraceTag(51139905,
327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}mb.isLossy&&(this.state.isLossy=!0);this.Rco(mb)?this.Kam.records.push(mb):this.MWl(mb)}get isDeleted(){return this.Oci}get state(){return this._state}get history(){return this._history}Ghn(mb){if(!mb)return this.history;const lc=Array.clone(this.history),Mc=lc[0],md=Mc.records.shift();if(!this.FPm){var ud=this.jVe(md,4);Mc.records.unshift(ud)}!mb.I6l&&this.I6l&&(ud=this.jVe(md,6),ud.completion=this.fef,Mc.records.unshift(ud));
!mb.H6l&&this.H6l&&(ud=this.jVe(md,10),ud.priority=this.eef,Mc.records.unshift(ud));!mb.J6l&&this.J6l&&(ud=this.jVe(md,5),ud.schedule=new T,Mc.records.unshift(ud));!mb.K6l&&this.K6l&&(ud=this.jVe(md,9),ud.title=this.hef,Mc.records.unshift(ud));mb.isDeleted&&(mb=this.jVe(md,8),Mc.records.unshift(mb));return lc}static nmn(mb,lc){return"Synthesized-"+mb.recordId+"-"+lc}}Object(c.a)(N,"CommentTaskStateBuilder",null,[]);var I=a(854);class O{constructor(mb,lc,Mc,md){this.id=mb;this.commentId=lc;this.currentState=
Mc;this.history=md}}Object(c.a)(O,"CommentTaskItem",null,[]);class Q{constructor(mb,lc="",Mc="",md=""){this.IsCurrentUser=!1;this.UserId=mb;this.Provider=lc;this.DisplayName=Mc;this.Email=md}}Object(c.a)(Q,"CommentTaskPerson",null,[1866]);const U=mb=>{const lc=new Q(mb.UserId,mb.Provider,mb.DisplayName,mb.Email);lc.IsCurrentUser=mb.IsCurrentUser;return lc};var ba=a(1263);a(323);class aa{constructor(mb){this.extensions=mb}}Object(c.a)(aa,"ExtensionList",null,[]);class La{static clone(mb){mb=La.p1m(mb.extensions);
return new aa(mb)}static EUl(mb){return mb?La.clone(mb):null}static isEmpty(mb){return!mb.extensions||!mb.extensions.count}static wb(mb){return!mb||La.isEmpty(mb)}static p1m(mb){if(!mb)return null;const lc=new ba.a;mb.forEach((Mc,md)=>{lc.add(Mc,md);return!0});return lc}}Object(c.a)(La,"ExtensionListExtensions",null,[]);class Z{static clone(mb){var lc=U(mb.user);lc=new E(mb.type,lc,mb.time,mb.recordId,mb.isLossy);lc.commentId=mb.commentId;lc.anchorExtensionList=La.EUl(mb.anchorExtensionList);lc.recordExtensionList=
La.EUl(mb.recordExtensionList);mb.assignee&&(lc.assignee=U(mb.assignee));if(mb.schedule){var Mc=mb.schedule;const md=new T;md.startDate=Mc.startDate;md.endDate=Mc.endDate;lc.schedule=md}lc.completion=mb.completion;lc.title=mb.title;lc.priority=mb.priority;lc.undoId=mb.undoId;return lc}}Object(c.a)(Z,"HistoryRecordExtensions",null,[]);class la{constructor(mb,lc,Mc,md,ud,Qd,kb,Xb=!1){this.ADh=mb;this.tEh=lc;this.Ajc=Mc;this.VMm=md;this.hef=ud;this.eef=Qd;this.fef=kb;this.IDh=Xb}e6m(mb,lc,Mc,md=null){if(!mb)throw b.ULS.sendTraceTag(42796181,
327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!lc)throw b.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!Mc||!Mc.length)throw b.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==Mc[0].type)throw b.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var ud=[],Qd=null,kb=this.V1n(Mc);for(var Xb of Mc)if(!kb.contains(Xb.recordId))if(Mc=
this.j5l(Xb.commentId,md),Mc=this.wdn(Xb,Mc),1===Mc.type){let Rc=[];this.IDh&&Qd&&Qd.state&&(Rc=Qd.state.assignees);Qd=new N(this.ADh,Mc,this.hef,this.eef,this.fef,this.IDh,Rc);ud.push(Qd)}else if(Qd)Qd.$mo(Mc);else throw b.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");kb=null;Xb=[];if(Qd){Qd.isDeleted||
(kb=Qd.state);Qd=null;for(var sc of ud)ud=sc.Ghn(Qd),Array.addRange(Xb,ud),Qd=sc}sc=this.j5l(lc,md);kb&&(kb.completion=this.$1m(lc,md,kb.completion));return new O(mb,sc,kb,Xb)}ldn(mb,lc,Mc,md=null){if(!lc)throw b.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(Mc&&!mb)throw b.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const ud=[],Qd=this.Ajc.Xfn();if(Mc){var kb=this.Ajc.QCc(1,mb,Qd);ud.push(kb)}kb=
null;if(lc.assigneeUpdate){if(!lc.assigneeUpdate.assigneesToAdd||!lc.assigneeUpdate.assigneesToRemove)throw b.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var Xb=0;Xb<lc.assigneeUpdate.assigneesToAdd.length;Xb++){var sc=this.NWl(2,lc.assigneeUpdate.assigneesToAdd[Xb],mb,Qd);sc&&ud.push(sc)}for(Xb=0;Xb<lc.assigneeUpdate.assigneesToRemove.length;Xb++)(sc=this.NWl(3,lc.assigneeUpdate.assigneesToRemove[Xb],mb,Qd))&&ud.push(sc)}else lc.assignee&&
(Mc||(kb=this.Ajc.QCc(4,mb,Qd),ud.push(kb)),Xb=this.Ajc.QCc(2,mb,Qd),kb=this.tEh.vdd(lc.assignee),Xb.assignee=kb,ud.push(Xb));lc.title?(md=this.Ajc.QCc(9,mb,Qd),md.title=lc.title,ud.push(md)):Mc&&md&&(Xb=this.Ajc.QCc(9,mb,Qd),Xb.title=this.VMm.bnn(md,kb),ud.push(Xb));if(lc.schedule){if(lc.schedule.startDate>lc.schedule.endDate)throw b.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");md=this.Ajc.QCc(5,mb,Qd);md.schedule=lc.schedule;ud.push(md)}if(void 0!==
lc.completion&&null!==lc.completion){md=lc.completion;if(0>md||100<md)throw b.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");Mc||b.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",md);Mc=this.Ajc.QCc(6,mb,Qd);Mc.completion=md;ud.push(Mc)}if(void 0!==lc.priority&&null!==lc.priority){lc=lc.priority;if(0>lc||10<lc)throw b.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");mb=this.Ajc.QCc(10,
mb,Qd);mb.priority=lc;ud.push(mb)}return ud}NWl(mb,lc,Mc,md){if(2!==mb&&3!==mb)return b.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;mb=this.Ajc.QCc(mb,Mc,md);mb.assignee=this.tEh.vdd(lc);return mb}V1n(mb){const lc=new I.a,Mc=new I.a;for(let md=mb.length-1;0<=md;md--){const ud=mb[md],Qd=Mc.contains(ud.recordId);Qd||-1!==ud.type||(Mc.contains(ud.undoId)?b.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):
Mc.add(ud.undoId));if(Qd||-1===ud.type)lc.contains(ud.recordId)?b.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):lc.add(ud.recordId)}return lc}wdn(mb,lc){const Mc=Z.clone(mb);Mc.commentId=lc;Mc.user=this.tEh.vdd(mb.user);Mc.assignee=this.tEh.vdd(mb.assignee);return Mc}$1m(mb,lc,Mc){let md=Mc;mb&&lc&&(({value:lc}=lc.Ph(mb)).returnValue?(md=lc.ResolveState?100:100===Mc?0:Mc,md!==Mc&&b.ULS.sendTraceTag(592719873,327,50,
"Task completion state has been changed to match comment resolution state for comment {0}",mb)):b.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",mb));return md}j5l(mb,lc){let Mc=mb;mb&&lc&&(({value:lc}=lc.Ph(mb)).returnValue?Mc=lc.CommentId:(b.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",mb),Mc=mb));return Mc}}Object(c.a)(la,"CommentTaskTranslatorImpl",null,[538]);class da{constructor(){this.yxd=
{};this.yxd.ops=[]}Dvn(mb){const lc=this.yxd.ops;if(lc.length){var Mc=lc.length-1;const md=lc[Mc];if(!md.attributes){md.insert+=mb;lc[Mc]=md;this.yxd.ops=lc;return}}Mc={};Mc.insert=mb;Array.add(lc,Mc)}vvn(mb,lc,Mc){var md={};md.fullName=lc.fullName;md.email=lc.email;md.resolveState=lc.resolveState;lc={};lc.atmention=md;mb=this.Nob(mb,lc);Mc&&(md={},md.contentId=Mc.contentId,Mc={},Mc.atmention=md,mb.optional=Mc);Array.add(this.yxd.ops,mb)}rYe(mb,lc){mb=this.Nob(mb,{});const Mc={};Mc.base64=lc.base64;
lc={};lc.image=Mc;mb.optional=lc;Array.add(this.yxd.ops,mb)}insertHyperLink(mb,lc){const Mc={};Mc.link=lc.link;this.wbo(Mc,lc);Array.add(this.yxd.ops,this.Nob(mb,Mc))}lgn(){return Sys.Serialization.JavaScriptSerializer.serialize(this.yxd)}Nob(mb,lc){const Mc={};Mc.insert=mb;Mc.attributes=lc;return Mc}wbo(mb,lc){this.QGe(lc.weight>=da.KIn,mb,"weight",lc.weight);this.QGe(lc.italic,mb,"italic",!0);this.QGe(lc.underline,mb,"underline",!0);this.QGe(lc.strikethrough,mb,"strikethrough",!0);this.QGe(!!lc.highlight,
mb,"highlight",lc.highlight);this.QGe(!!lc.color,mb,"color",lc.color);this.QGe(!!lc.paragraph,mb,"paragraph",lc.paragraph)}QGe(mb,lc,Mc,md){mb&&(lc[Mc]=md)}static y2l(mb){return Sys.Serialization.JavaScriptSerializer.deserialize(mb,!0)}}da.KIn=700;Object(c.a)(da,"DeltaFormatCreator",null,[1846]);var J=a(830),Ca=a(1635),Fa=a(59);class ya{constructor(){this.ellipsis=Object(Fa.a)("Ellipsis")}bnn(mb,lc){if(!mb)throw b.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");
try{var Mc=da.y2l(mb)}catch(sc){throw b.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var md=mb=0,ud=0;const Qd=RegExp("\\s+","g"),kb=new Sys.StringBuilder;for(var Xb of Mc.ops)Xb.attributes&&Xb.attributes.atmention&&Xb.attributes.atmention.email&&lc&&(Mc=Xb.attributes.atmention.email,0<Mc.length&&(Mc===lc.UserId||Mc===lc.Email||Mc===J.a.KXb(lc.UserId))&&(md=mb,ud=md+Xb.insert.length)),Mc=Xb.insert.replace(Qd,
" "),mb+=Mc.length,kb.append(Mc);!ud&&lc&&b.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",lc.Provider);lc=kb.toString().trimEnd();mb=lc.length;255<mb?(Xb=(255-(ud-md))/2,0>md-Xb?(mb=Ca.a.instance.sZf(lc,255-this.ellipsis.length),ud=lc.substring(0,mb)+this.ellipsis,mb="Trimmed End"):ud+Xb>mb?(md=Ca.a.instance.rZd(lc,mb-255+this.ellipsis.length),ud=this.ellipsis+lc.substring(md,mb),mb="Trimmed Start"):(md=Ca.a.instance.rZd(lc,md-Xb+this.ellipsis.length),mb=Ca.a.instance.sZf(lc,
ud+Xb-this.ellipsis.length),ud=this.ellipsis+lc.substring(md,mb)+this.ellipsis,mb="Trimmed Both")):(mb="No Trim",ud=lc);b.ULS.sendTraceTag(592998804,327,50,mb);return ud}}Object(c.a)(ya,"ContentExtractor",null,[]);class Ua{constructor(mb,lc){this.sOm=mb;this.jPm=lc;this.sHe=this.sLe=!1}vdd(mb){if(!mb)return null;if(void 0===mb.UserId||null===mb.UserId)throw b.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(mb.IsCurrentUser||!this.sOm.equals(this.jPm.value,
mb))return mb;mb=U(mb);mb.IsCurrentUser=!0;return mb}}Object(c.a)(Ua,"EnsureIsCurrentUserSetTransformer",null,[1874]);class Ia{constructor(){this.sHe=this.sLe=!1}vdd(mb){if(!mb)return null;if(void 0===mb.UserId||null===mb.UserId)return mb;if(!mb.Email||""===mb.Email){let lc;if(lc=J.a.KXb(mb.UserId))return mb=U(mb),mb.Email=lc,mb}return mb}}Object(c.a)(Ia,"RestoreEmailTransformer",null,[1874]);class Oa{constructor(){this.sHe=this.sLe=!1}vdd(mb){if(!mb)return null;if(void 0!==mb.UserId&&null!==mb.UserId)return mb;
switch(this.sLe?this.sHe?2:1:0){case 0:if(void 0===mb.UserId||null===mb.UserId)throw b.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");mb=U(mb);break;case 1:if(void 0===mb.Id||null===mb.Id)throw b.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===mb.Email||null===mb.Email)throw b.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var lc=Oa.jpm(mb.Id,mb.Email,null);
if(!lc||""===lc)throw b.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var Mc=h.AFrameworkApplication.ha.Ma("HostAuthType")||"";if("aad"!==Mc.toLowerCase()||lc.startsWith("S::")){if("msa"===Mc.toLowerCase())throw b.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");b.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",Mc)}else throw b.ULS.sendTraceTag(593368211,327,
10,"Unexpected UserID format"),Error.argument("userId");mb=new Q(lc,"AD",mb.DisplayName,mb.Email);break;case 2:if(void 0===mb.UserPrincipalName||null===mb.UserPrincipalName)throw b.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==mb.SuggestionSubtype&&null!==mb.SuggestionSubtype)if("OrganizationUser"===mb.SuggestionSubtype)lc="AD";else throw b.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",
mb.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw b.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");Mc=Oa.jpm(mb.Id,mb.UserPrincipalName,mb.AadObjectId);if(!Mc||""===Mc)throw b.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===lc&&!Mc.startsWith("S::"))throw b.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");
mb=new Q(Mc,lc,mb.Name,mb.UserPrincipalName);break;default:throw b.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return mb}static jpm(mb,lc,Mc){if(!lc||""===lc)return b.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),mb;if(Mc&&""!==Mc)return"S::"+lc+"::"+Mc;if(!mb||""===mb)return b.ULS.sendTraceTag(593368217,327,50,"Missing ID"),mb;if(mb.startsWith("S::"))return mb;if(-1!==mb.indexOf("@")){Mc=mb.split("@");if(H.a.isValid(Mc[0]))return"S::"+lc+"::"+
Mc[0];b.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return mb}}Object(c.a)(Oa,"UserIdCanonicalizationTransformer",null,[1874]);class ma{constructor(mb,lc,Mc=!1,md=!1){this.ENm=mb;this.ZIl=lc;this.mPm=Mc;this.IDh=md}M3m(){const mb=new J.a;var lc=new w.a(ma.Tfn);const Mc=new F;this.ZIl&&(Mc.z7e.push(new Oa),Mc.z7e.push(new Ia));this.ENm&&Mc.z7e.push(new Ua(mb,lc));Mc.sLe=this.ZIl;Mc.sHe=this.mPm;lc=new P(lc,Mc);const md=new ya;return new la(mb,Mc,lc,md,ma.$6m,ma.Y6m,
ma.Z6m,this.IDh)}static Tfn(){const mb=new Q(h.AFrameworkApplication.ha.Ma("PresenceUserId")||"",h.AFrameworkApplication.ha.Ma("PresenceProvider")||"",h.AFrameworkApplication.userName||"");mb.IsCurrentUser=!0;return mb}}ma.$6m="";ma.Y6m=5;ma.Z6m=0;Object(c.a)(ma,"CommentTaskTranslatorFactory",null,[1865]);class za{constructor(){this.$ji=this.vIl=!1;this.QSe=this.PH=this.QKl=this.MLl=this.DOl=this.NMl=this.mOl=this.lJl=this.SU=this.Srf=null}initialize(mb,lc,Mc,md=null,ud=null,Qd=null,kb=null,Xb=null,
sc=null,Rc=null){this.SU=mb;this.lJl=lc;this.mOl=Mc;this.NMl=md;this.DOl=ud;this.MLl=Qd;this.QKl=kb;this.PH=Xb;this.vIl=!0;this.QSe=sc;this.Srf=Rc}CYe(){if(!this.vIl)return b.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((mb,lc)=>{lc(u.a.xH(-2130915313))});if(this.$ji)return b.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.Srf||
(h.AFrameworkApplication.ha.getBooleanAppSetting("DynamicBundlesIsEnabled")?this.Srf=appResourceLoader.loadChunk("sharedComments"):this.Srf=this.SU.loadScript("sharedComments"));return this.Srf.then(()=>{this.kUn()})}kUn(){this.$ji||(this.QSe&&this.QSe.execute(mb=>{mb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),sharedComments.instantiate(this.lJl,this.mOl,this.NMl,this.DOl,this.MLl,this.QKl,this.PH));this.$ji=!0}}Object(c.a)(za,"CommentActivationManager",
null,[1867]);class Qa{constructor(){this.actionBehavior=this.actionType=0}}Object(c.a)(Qa,"CommentUIActionPayload",null,[]);var Xa=a(278);class Tb{constructor(mb,lc){this.Khd=(Mc,md,ud,Qd,kb)=>{if(this.P6h.Sb(Mc)){var Xb=this.P6h.ka(Mc);if(!this.Oud.Sb(Xb))return 8;const sc=this.Oud.ka(Xb);if(sc.preCallback){const Rc=sc.preCallback(Mc,md,ud,Qd,kb);if(2!==Rc)return Rc}if(!sc.registeredCallback)return 1===ud?8:2;Xb=Object.assign(new Qa,{actionType:Xb});1===ud&&(Xb.actionBehavior=1);Xb=sc.registeredCallback(Xb);
return sc.postCallback?sc.postCallback(Xb,Mc,md,ud,Qd,kb):Xb?32:8}return 2};this.Aa=mb;this.Oud=lc;this.P6h=new Xa.a;for(const Mc of this.Oud)this.P6h.fa(Mc.value.canvasActionId,Mc.key),mb=Mc.value,mb.delayActionsUntilRegistration||this.Ba(mb)}Ba(mb){mb.withFlags?this.Aa.ua(mb.canvasActionId,mb.canvasContextId,this.Khd,97):this.Aa.Ba(mb.canvasActionId,mb.canvasContextId,this.Khd)}yUa(mb,lc){this.Oud.Sb(mb)&&(this.Oud.ka(mb).delayActionsUntilRegistration&&this.Ba(this.Oud.ka(mb)),this.Oud.ka(mb).registeredCallback=
lc)}}Object(c.a)(Tb,"OfficeSharedCommentsActionHost",null,[1849]);var Kb=a(298),nb=a(57),Ka=a(228);class Sb{}Object(c.a)(Sb,"CommentActivityData",null,[]);var ab=a(143),ub=a(98);class Aa{constructor(mb,lc,Mc,md,ud,Qd,kb,Xb,sc,Rc=null,Zc=null){this.XOl={["CancelCommentCreateThreadAction"]:nb.a.gfl,["CommitComment"]:nb.a.hfl,["CommitDraftAction"]:nb.a.ifl,["CommitDraftCreateAction"]:nb.a.o_h,["CommitDraftEditAction"]:nb.a.q_h,["CommitDraftReplyAction"]:nb.a.n_h,["CreateReplyAction"]:nb.a.n_h,["CreateReplyWithMentions"]:nb.a.jfl,
["CreateReplyWithTaskAssigned"]:nb.a.kfl,["CreateThreadAction"]:nb.a.o_h,["CreateThreadWithMentions"]:nb.a.lfl,["CreateThreadWithTaskAssigned"]:nb.a.mfl,["DeletePostAction"]:nb.a.nfl,["DeleteThreadAction"]:nb.a.ofl,["DeleteThreadWithTask"]:nb.a.pfl,["DiscardDraftAsync"]:nb.a.qfl,["PresentLinkToCommentAction"]:nb.a.rfl,["ResolveThreadAction"]:nb.a.vfl,["ResolveThreadWithTask"]:nb.a.wfl,["ReopenThreadAction"]:nb.a.sfl,["ReopenThreadWithTask"]:nb.a.tfl,["RequestInitCommentSession"]:nb.a.ufl,["SelectCommentAction"]:nb.a.xfl,
["UpdateCommentBodyAction"]:nb.a.q_h};this.dataCenter=this.ring=this.sessionId=this.releaseChannel=this.releaseAudience=this.appVersion=this.appName=null;this.disableUpload=!1;this.sovereignEnvironmentName=null;this.appName=mb;this.appVersion=lc;this.releaseAudience=Mc;this.releaseChannel=md;this.sessionId=ud;this.ring=Qd;this.dataCenter=kb;this.disableUpload=Xb;this.sovereignEnvironmentName=Zc;this.Aa=sc;this.PMl=Rc;this.nvn()}nvn(){this.Aa.Ba(nb.a.gfl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.hfl,
ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.ifl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.n_h,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.jfl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.kfl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.o_h,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.lfl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.mfl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.nfl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.ofl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.pfl,
ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.qfl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.rfl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.vfl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.wfl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.sfl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.tfl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.ufl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.xfl,ub.a.frame,Ka.ActionManager.Wi);this.Aa.Ba(nb.a.q_h,ub.a.frame,Ka.ActionManager.Wi)}sendULSTrace(mb,
lc,Mc,md){b.ULS.sendTraceTag(mb,lc,Mc,md)}recordActivity(mb){this.XOl[mb]&&this.Aa.Eb(this.XOl[mb],2)}sendOtelEvent(mb){ab.a.sendOtelEvent(mb)}recordPerfData(mb,lc){this.PMl&&(mb=Object.assign(new Sb,{durationMs:lc,name:mb}),this.PMl.sZa(mb))}}Object(c.a)(Aa,"OfficeSharedCommentsTelemetry",null,[]);var tb=a(324);class kc{constructor(mb,lc,Mc,md){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=mb;this.appLocale=lc;this.uiCulture=Mc;this.dataCulture=md}}
Object(c.a)(kc,"LocalizationDetails",null,[]);var dc=a(363),Db=a(88),sb=a(114);class Qb{constructor(mb,lc){this.ySm=mb;this.bKl=lc}getViewContainer(){return this.ySm}registerForViewContainerEvents(mb){this.bKl.t5n(mb)}unregisterForViewContainerEvents(mb){this.bKl.mlo(mb)}}Object(c.a)(Qb,"ViewContainerProvider",null,[1779]);var $a=a(95),X=a(1703),Ta=a(6),ca=a(15),Ma=a(43),Ba=a(267),wa=a(220),pa=a(40),ta=a(235),Wa=a(1009);class Pa{static d3l(mb){return mb===Pa.create?0:mb===Pa.reply?1:mb===Pa.edit?
2:mb===Pa.metadata?3:null}}Pa.create="CREATE";Pa.reply="REPLY";Pa.edit="EDIT";Pa.metadata="METADATA";Object(c.a)(Pa,"CommentSessionType",null,[]);class ib{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(c.a)(ib,"InitCommentSessionResult",null,[]);class Ib extends ib{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(c.a)(Ib,"BeginDraftingHostResult",ib,[]);class hc{constructor(mb,lc="",
Mc="",md="",ud=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=mb;this.Provider=lc;this.DisplayName=Mc;this.Email=md;this.IsCurrentUser=ud}}Object(c.a)(hc,"OfficeSharedCommentUser",null,[]);var yc=a(64),ob=a(50),Bc=a(142),rb=a(42);class Eb{constructor(mb,lc,Mc){this.xt=mb;this.eEn=lc;this.LDn=Mc;this.Wdm=null;this.Efm=!1}get wjd(){return this.xt}get v7(){return this.eEn}get commentId(){return this.LDn}get Npb(){return this.Wdm}set Npb(mb){this.Wdm=
mb}get ZOh(){return this.Efm}set ZOh(mb){this.Efm=mb}}Object(c.a)(Eb,"ActiveCommentSession",null,[]);var jc=a(1105);class ea{static get sIn(){return 50}static jen(mb){return ea.mfn(mb)}static Tjn(mb){if(""===mb)return"";let lc=0,Mc="";try{const md=da.y2l(mb);for(const ud of md.ops)if(ea.fCa(ud))lc||(Mc+=ea.nhn(ud.attributes.atmention.fullName)),lc+=1;else{const Qd=ud.insert?ud.insert:"";" "!==Qd&&0<Qd.length&&(lc=0,Mc+=Qd)}}catch(md){b.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return Mc}static mfn(mb){mb=
ea.Tjn(mb);return 0<mb.length&&mb.split(" ").length<=ea.sIn?mb:null}static nhn(mb){let lc="";mb&&(mb=mb.split(" "),0<mb.length&&(lc=mb[0]));return lc}static fCa(mb){return!!mb.attributes&&!!mb.attributes.atmention}}Object(c.a)(ea,"BaseCommentSmartReplyHelpers",null,[]);class ua{constructor(mb){this.lak=mb}Yno(mb,lc,Mc,md){-1===Mc||lc||(lc=md[Mc],Mc=lc.author?lc.author.IsCurrentUser:!1,lc&&lc.commentBody&&!Mc&&(lc=ea.jen(lc.commentBody))&&this.lak.invoke(mb,lc))}}Object(c.a)(ua,"CommentSmartReplyHelpers",
null,[]);var Da=a(69),Cb=a(92),Nb=a(47),fc=a(102),fb=a(104),Ub=a(62);class Ec{constructor(){this.Z$h=this.dli=this.bhd=null;this.G6l=!1;this.h1h=this.i1h=this.endPos=this.startPos=0}get paragraphs(){return this.bhd}get IVa(){return this.dli}set IVa(mb){this.dli=mb;this.bhd=[];this.bhd.push(this.dli)}get XXa(){return this.Z$h}set XXa(mb){this.Z$h=mb;this.bhd&&this.bkg&&this.bhd.push(this.Z$h)}Han(){for(const mb of this.bhd){const lc=Object(X.a)(352,mb);if(lc&&-1!==lc.zld().indexOf("\ufffc"))return!0}return!1}nam(mb){const lc=
(this.h1h&4294967295)>>>0;mb.TextBodyLength!==this.i1h||lc===mb.TextBodyHash||Ec.rwm.contains(this.h1h)||(Ec.rwm.add(this.h1h),pa.a.$(554280861,805,50,"IsTextBodyLengthValid - text body length matches but hash does not; ContainsObjectReplaceChar:{0}",this.Han()));return mb.TextBodyLength===this.i1h}get Dsm(){let mb=0;if(this.isValid)if(this.bkg){mb+=Nb.ParagraphReader.textLength(this.IVa)-this.startPos;mb+=this.endPos;for(let lc=1;lc<this.paragraphs.length-1;lc++){const Mc=this.paragraphs[lc];Mc&&
(mb+=Nb.ParagraphReader.textLength(Mc)+1)}}else mb=this.endPos-this.startPos;return mb}get UVa(){if(!this.isValid)return fc.a.auto;var mb=Ub.a.Oj(this.IVa,this.startPos+1);if(!mb)return fc.a.auto;mb=fb.a.rt(mb);return mb?(mb=mb.cache)&&mb.D5?mb.fontColor:fc.a.auto:fc.a.auto}get isValid(){return!!this.IVa&&!!this.XXa&&!!this.paragraphs}get bkg(){return!this.IVa.equals(this.XXa)}yFh(mb){this.bhd&&mb&&this.bhd.push(mb)}Svn(){if(this.isValid&&(this.IVa.er(16,!0),this.bkg))for(let mb=1;mb<this.paragraphs.length;mb++){const lc=
this.paragraphs[mb];lc&&lc.er(16,!0)}}Kwn(mb,lc){if(!this.isValid)return!1;const Mc=Object(X.a)(Cb.AParagraphNode,mb.node),md=Object(X.a)(Cb.AParagraphNode,lc.node);return!(Mc&&md&&Array.contains(this.paragraphs,Mc)&&Array.contains(this.paragraphs,md))||Mc.equals(this.IVa)&&(0>mb.Xa||mb.Xa<this.startPos)||md.equals(this.XXa)&&(0>lc.Mb||lc.Mb>this.endPos)?!1:!0}F2l(mb){let lc=3;mb&&(!this.bkg&&this.IVa.equals(mb)?lc=2:this.IVa.equals(mb)?lc=0:this.XXa.equals(mb)&&(lc=1));return lc}}Ec.rwm=new I.a;
Object(c.a)(Ec,"TextAnchorParagraphInfo",null,[]);class Lc{static lWe(mb,lc){return mb||lc?mb&&lc?mb.commentId===lc.commentId:!1:!0}static XJh(mb){return!!mb.Children&&0<mb.Children.length}static Ajn(mb,lc){mb=mb.zld()+"\r";for(let Mc=0;Mc<mb.length;Mc++){let md=mb.charCodeAt(Mc);160===md&&(md=32);lc=(lc<<5>>>0)+lc+md}return lc}static KAa(mb){return!!mb&&!!mb.textAnchoringInfo&&mb.textAnchoringInfo.EndPos>mb.textAnchoringInfo.StartPos&&0<mb.textAnchoringInfo.TextBodyLength}static I6f(mb,lc){if(!Lc.KAa(mb))return null;
if(!lc||1>lc.HJ().length)return pa.a.$(509220243,805,lc?10:15,"CommentUtilities::GetTextAnchoredCommentParagraph - CommentAnchorShape is null:{0}, else text anchored shape has no paragraphs",!lc),null;let Mc=null,md=null,ud=null;mb.textAnchoringInfo.AnchoringShape&&(mb.textAnchoringInfo.AnchoringShape.TableCell?(Mc=H.a.Vf(mb.textAnchoringInfo.AnchoringShape.TableCell.RowId),md=H.a.Vf(mb.textAnchoringInfo.AnchoringShape.TableCell.ColId)):mb.textAnchoringInfo.AnchoringShape.SmartArtNodeId&&(ud=mb.textAnchoringInfo.AnchoringShape.SmartArtNodeId,
ud.startsWith("{")||(ud="{"+ud),ud.endsWith("}")||(ud+="}")));let Qd=mb.textAnchoringInfo.StartPos;mb=mb.textAnchoringInfo.EndPos;let kb=0,Xb=0;const sc=new Ec;lc=lc.HJ();for(let Zc=0;Zc<lc.length;Zc++){const Id=lc[Zc],Td=Nb.ParagraphReader.textLength(Object(X.a)(Cb.AParagraphNode,Id));if(Mc&&md){var Rc=Id.UX();if(!Rc||!Mc.equals(Rc.rowId)||!md.equals(Rc.cellId))continue}else if(ud&&(!Id.get_smartArtModelId()||ud!==Id.get_smartArtModelId()))continue;if(!sc.isValid&&(Td>Qd||sc.IVa)){if(!sc.IVa&&(sc.IVa=
Object(X.a)(Cb.AParagraphNode,Id),sc.startPos=Qd,!sc.IVa))return null;Rc=Zc===lc.length-1||!!ud&&Lc.Qxn(ud,lc[Zc+1])||!!Mc&&!!md&&Lc.Pxn(Mc,md,lc[Zc+1]);Rc=Td<mb&&0<Td&&Rc;if((Td>=mb||Rc)&&!sc.XXa){if(Rc&&(mb=Td),sc.XXa=Object(X.a)(Cb.AParagraphNode,Id),sc.endPos=mb,!sc.XXa)return null}else Id.equals(sc.IVa)||sc.yFh(Object(X.a)(Cb.AParagraphNode,Id))}kb+=Td+1;Xb=Lc.Ajn(Id,Xb);sc.IVa||(Qd-=Td+1);mb-=Td+1}sc.i1h=kb;sc.h1h=Xb;return sc}static Qxn(mb,lc){return lc.get_smartArtModelId()&&lc.get_smartArtModelId()===
mb?!1:!0}static Pxn(mb,lc,Mc){return(Mc=Mc.UX())&&mb.equals(Mc.rowId)&&lc.equals(Mc.cellId)?!1:!0}static Amn(mb,lc,Mc,md){Mc=md=-1;if(!mb)return pa.a.$(509220242,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape is null."),{returnValue:null,CLb:Mc,lIb:md};let ud=Object(X.a)(352,lc.Ya.node);const Qd=Object(X.a)(352,lc.vf.node);if(!ud||!Qd)return pa.a.$(509220241,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Start paragraph node is null:{0}; end paragraph node is null:{1}.",
!ud,!Qd),{returnValue:null,CLb:Mc,lIb:md};const kb=lc.Ya.Neb,Xb=lc.vf.wSb;var sc=Nb.ParagraphReader.textLength(lc.Ya.node);lc=Nb.ParagraphReader.textLength(lc.vf.node);if(0>kb||0>=Xb||kb===Xb&&ud===Qd||kb>sc||Xb>lc)return pa.a.$(509220240,805,50,"CommentUtilities::GetTextAnchorParagraphFromSelection - Invalid start/end character positions. StartCp:{0}; EndCp{1}; FirstCtxTextLength:{2}; LastCtxTextLenth:{3}.",kb,Xb,sc,lc),{returnValue:null,CLb:Mc,lIb:md};mb=mb.HJ();if(!mb)return pa.a.$(509220239,805,
15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape paragraph node list is null."),{returnValue:null,CLb:Mc,lIb:md};sc=0;for(const Rc of mb){if(Qd.get_smartArtModelId()){if(Rc.get_smartArtModelId()!==Qd.get_smartArtModelId())continue;ud.get_smartArtModelId()!==Qd.get_smartArtModelId()&&(ud=Rc)}if(Qd.du()){if(Rc.UX()!==Qd.UX())continue;ud.UX()!==Qd.UX()&&(ud=Rc)}ud===Rc&&(Mc=kb+sc);Qd===Rc&&(md=Xb+sc);if(0<=Mc&&0<=md)return{returnValue:ud,CLb:Mc,lIb:md};sc+=Rc.zld().length+1}0<=
Mc&&-1===md&&(ud.get_smartArtModelId()||ud.du())&&(md=sc-1);return{returnValue:ud,CLb:Mc,lIb:md}}static get RGh(){return Da.a.Yf||Da.a.aQa}static get $Jh(){return!Da.a.Fj}}Object(c.a)(Lc,"CommentUtilities",null,[]);const vb=(mb,lc)=>{var Mc,md;if(null===mb||void 0===mb||!mb.ReactionList)return mb;for(const ud in mb.ReactionList)mb.ReactionList[ud].ReactionInstances=null===(md=null===(Mc=mb.ReactionList[ud])||void 0===Mc?void 0:Mc.ReactionInstances)||void 0===md?void 0:md.filter(Qd=>Qd.User.UserId!=
lc.UserId);mb.ReactionList=mb.ReactionList.filter(ud=>0!=ud.ReactionInstances.length);0==mb.ReactionList.length&&(mb.ReactionList=void 0);return mb},ec=mb=>mb.getBooleanAppSetting("PPTOCommentReactionsUIEnabled");var lb=a(90);class Zb{constructor(mb,lc,Mc,md,ud,Qd,kb,Xb,sc,Rc,Zc,Id,Td,he,be,Ue){this.qSh=!1;this.Ad=mb;this.Bmc=lc;this.Sbk=Mc;this.gDn=md;this.Yb=ud;this.Jb=Qd;this.WTh=kb;this.NDn=Xb;this.Gmc=sc;this.lak=Zc;this.nEn=Id;this.umc=Td;this.Pne=he;this.JDn=be;this.la=Ue}beginDraftingAsync(mb){if(!mb)return new Promise((Mc,
md)=>{md(u.a.xH(-2130915327))});const lc=Pa.d3l(mb.sessionType);return void 0===lc||null===lc?new Promise((Mc,md)=>{md(u.a.xH(-2130915317))}):2===lc&&mb.commentId===Zb.u1e?new Promise((Mc,md)=>{md(u.a.xH(-2130915324))}):new Promise((Mc,md)=>{u.a.Ljc(this.Yb,()=>{this.Ad.UB.isVisible||this.Ad.Bgc();var ud=this.Ad.Bmj(),Qd=null;let kb=-1;pa.a.$(512496833,805,50,"CommentAPI::BeginDraftingAsync - SessionType: {0}",lc);try{switch(lc){case 0:if(this.Pne)try{kb=this.Ad.b3l(!0)}catch(Zc){pa.a.$(512496832,
801,10,"GetIndexForDraftCommentCardInsertion threw en exception{0}",Zc),kb=ud.length}else kb=ud.length;Qd=new Eb(lc,mb,"");this.qSh=!0;break;case 1:if(!mb.threadId||!mb.threadId.length)throw u.a.xH(-2130915324);kb=Zb.Rhn(ud,mb.threadId);if(-1===kb)throw u.a.xH(-2130915323);if(this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)){var Xb=mb.threadId;(new ua(this.lak)).Yno(Xb,Zb.nqn(ud,Xb),Zb.Hjj(ud,Xb),ud)}Qd=new Eb(lc,mb,mb.threadId);break;case 2:if(!mb.commentId||
!mb.commentId.length)throw u.a.xH(-2130915324);kb=Zb.Hjj(ud,mb.commentId);if(-1===kb)throw u.a.xH(-2130915323);Qd=new Eb(lc,mb,mb.commentId);break;case 3:kb=Zb.Hjj(ud,mb.threadId);Qd=new Eb(lc,mb,mb.threadId);break;default:throw u.a.xH(-2130915322);}if(!Qd)throw u.a.xH(-2130915322);var sc=this.Ad.bun(Qd);if(sc)throw sc;}catch(Zc){md(Zc);return}ud=new Ib;Qd=this.Jb.Ma("UserName");sc=this.Jb.Ma(lb.a.ZTa);Xb=this.Jb.Ma(lb.a.dcc);const Rc=rb.a("PPTPlumbEmailThroughCG")?J.a.KXb(sc||""):"";sc=new hc(sc,
Xb,Qd,Rc,!0);ud.author=sc;ud.insertIndex=kb;ud.authorName=Qd;ud.authorIdentity=new String;Mc(ud)})})}commit(mb,lc,Mc){if(!this.Ad.nVe)throw pa.a.$(512496803,805,10,"CommentAPI::Commit - CurrentCommentSession is null; CommentSessionEndReason:{0}",this.Ad.Q1m),u.a.xH(-2130915320);var md=this.Ad.nVe.v7;if(!md)throw pa.a.$(512496802,805,15,"CommentAPI::Commit - CurrentCommentSession.DraftConfiguration is null"),u.a.xH(-2130915320);const ud=Pa.d3l(md.sessionType);if(void 0===ud||null===ud)throw u.a.xH(-2130915317);
if(mb!==md.draftId)throw u.a.xH(-2130915327);const Qd=this.umc?Bc.e(H.a.create().toString()):"";this.Ad.rYl();switch(ud){case 0:return pa.a.$(512496801,805,50,"CommentAPI::Commit - Create Comment {0}",Qd),md={},this.Ad.u7n(Qd),md.commentId=Qd,this.qSh=!1,this.Ad.bkm=Qd,Zb.gDm(Mc),Zb.fDm(),this.createComment(lc,md,Mc);case 1:return pa.a.$(512496800,805,50,"CommentAPI::Commit - Create Reply {0}:{1}",md.threadId,Qd),mb={},mb.parentId=md.threadId,mb.commentId=Qd,Zb.gDm(Mc),Zb.fDm(),this.createComment(lc,
mb,Mc);case 2:return pa.a.$(512496799,805,50,"CommentAPI::Commit - Edit comment {0}",md.commentId),Mc={},Mc.commentBody=lc,this.Klo(md.commentId,Mc),mb;case 3:return pa.a.$(512496798,805,50,"CommentAPI::Commit - Update Metadata {0}",md.threadId),ec(this.Jb)?this.Llo(md.threadId,Mc):this.$Dm(md.threadId,Mc),md.threadId;default:throw u.a.xH(-2130915322);}}endCommentSession(mb){pa.a.$(512496797,805,50,"CommentAPI::EndCommentSession - DraftId: {0}",mb);this.Ad.endCommentSession(mb,this.qSh?9:1);this.qSh=
!1}createComment(mb,lc,Mc){const md=this.WTh.F1h(mb,new Date);let ud="";this.umc&&(ud=yc.a.wb(lc.commentId)?H.a.create().toString():lc.commentId);let Qd=null;void 0!==Mc&&null!==Mc&&(Qd=this.WTh.Ljo(ud,Mc.Task,mb));mb=this.Ad.cZh;if(Mc=lc.parentId?null:this.Ad.Bmn())mb=this.Ad.Y9n;this.Bmc.eTm(ud,md.plainText,lc.parentId,mb,this.Ad.anchorNode,md.$jm,Qd,Mc);return yc.a.wb(ud)?Zb.u1e:ud}deleteComment(mb){if(mb===Zb.u1e)throw u.a.xH(-2130915327);pa.a.$(512496796,805,50,"CommentAPI::DeleteComment - {0}",
mb);this.Bmc.deleteComment(mb)}selectComment(mb){this.Ad.UB.isVisible||this.Ad.Bgc();mb!==Zb.u1e&&this.Ad.nLb(mb,0,!1)}highlightComment(mb){mb!==Zb.u1e&&this.Ad.RSm(mb)}ZDm(mb,lc,Mc){const md=Array.clone(this.Ad.Bmj());var ud=null;for(var Qd of md)if(Qd.commentId===mb){ud=Qd;break}if(!ud)throw pa.a.$(512496795,805,10,"Comment ID not found, UI and model in a mismatched state."),u.a.xH(-2130915323);(Qd=h.AFrameworkApplication.userName)&&0<Qd.length&&Qd!==ud.author.DisplayName&&pa.a.$(512496794,805,
50,"Author of comment being edited is not the current user (isAnonymous={0})",h.AFrameworkApplication.RLb||h.AFrameworkApplication.WS);Qd=new Date;ud=this.WTh.F1h(ud.commentBody,null).plainText;lc=this.WTh.F1h(lc.commentBody,Qd);this.Bmc.n9m(lc.plainText,mb,lc.$jm);Mc||ud!==lc.plainText||this.Sbk.qxm(md,this.Ad.wkm,Array.clone(this.Ad.D3l()))}Klo(mb,lc){if(mb===Zb.u1e)throw u.a.xH(-2130915327);lc.commentBody&&(this.Jb.getBooleanAppSetting(lb.a.Rpd)?this.ZDm(mb,lc,!0):u.a.Ljc(this.Yb,()=>{this.ZDm(mb,
lc,!1)}))}Llo(mb,lc){if(!((null===lc||void 0===lc?0:lc.Resolve)||(null===lc||void 0===lc?0:lc.Reaction)))throw u.a.xH(-2130915327);(null===lc||void 0===lc?0:lc.Resolve)&&this.$Dm(mb,lc);(null===lc||void 0===lc?0:lc.Reaction)&&this.Nlo(mb,lc)}$Dm(mb,lc){if(void 0===lc.Resolve||null===lc.Resolve)throw u.a.xH(-2130915327);const Mc=lc.Resolve.isResolved;let md=Mc?100:0;void 0!==lc.Task&&null!==lc.Task&&(md=lc.Task.completion);this.Bmc.aEm(mb,Mc?1:0,md);Mc&&this.Ad.cao()}Nlo(mb,lc){if(ec(this.Jb)){if(null==
(null===lc||void 0===lc?void 0:lc.Reaction))throw u.a.xH(-2130915327);a:{switch(lc.Reaction.reactionType){case 1:var Mc="\ud83d\udc4d";break a;default:pa.a.$(509220244,805,50,"Unsupported reaction type")}Mc=void 0}void 0!==Mc&&(this.Bmc.Olo(mb,Mc,lc.Reaction.isActive),this.Ad.MQn())}}setThreadResolvedState(mb,lc){this.Bmc.aEm(mb,lc?1:0,lc?100:0);lc&&this.Ad.TXl(mb)}selectFirstThreadInNextCommentContext(){this.Ad.Q9n()}selectLastThreadInPreviousCommentContext(){this.Ad.S9n()}presentLinkToComment(mb){var lc=
this.Bmc.Eln(mb);lc?(mb=JSON.stringify({["sId"]:lc.sid,["cId"]:lc.cid,["commentId"]:rb.a("FixDeepLinkedCommentsPPTO")&&this.Bmc.nZb(mb)?mb:void 0}),lc={},lc.nav=jc.a(mb),lc.mode="copy",pa.a.$(512496792,805,50,"PresentLinkToComment: nav:{0}",mb),this.la.Ra(nb.a.NAa,2,lc)):pa.a.$(512496793,805,50,"PresentLinkToComment failed")}registerForCommentEvents(mb){this.JDn.Sin().then(lc=>{this.Sbk.d5n(mb,this.Ad.Bmj(),this.Ad.wkm,this.Ad.isReadOnly,this.Ad.D3l(),lc,this.NDn.vPh)})}unregisterForCommentEvents(mb){this.Sbk.Dwh(mb)}registerForAction(mb,
lc){this.gDn.yUa(mb,lc);this.Ad.w4n()}unregisterForAction(){}loadThreads(){pa.a.$(512496791,805,10,"LoadThreads is not supported on WAC")}checkAtMentionCapability(){return new Promise(mb=>{h.AFrameworkApplication.ha.Wf(()=>{this.Gmc?this.Gmc.atMentionsEnabledAsync().then(lc=>{mb(lc);return null}):mb(!1)})})}resolveSupported(){return this.nEn}static Rhn(mb,lc){let Mc=!1;for(let md=0;md<mb.length;md++){if(Mc&&mb[md].commentId!==lc&&mb[md].parentId!==lc)return md;mb[md].commentId===lc&&(Mc=!0)}return Mc?
mb.length:-1}static nqn(mb,lc){let Mc=!1;for(let md=0;md<mb.length;md++)if(mb[md].commentId===lc&&(Mc=!0),Mc&&mb[md].parentId===lc)return!0;return!1}static Hjj(mb,lc){for(let Mc=0;Mc<mb.length;Mc++)if(mb[Mc].commentId===lc)return Mc;return-1}static fDm(){if(rb.a("CommentsFpsIsEnabled"))try{const mb=ob.a.instance.eb("Common.ISystemInitiatedFeedback");mb&&mb.execute(lc=>{lc.logActivity("PPTWebCommitNewCommentActivity","CommentsFpsIsEnabledBRS")})}catch(mb){pa.a.$(512496790,805,10,"Exception thrown while triggering PPTWebCommitNewCommentActivity. Exception: {0}",
mb)}}static gDm(mb){if(rb.a("CommentsTasksFpsIsEnabled")&&mb&&mb.Task)try{const lc=ob.a.instance.eb("Common.ISystemInitiatedFeedback");lc&&lc.execute(Mc=>{Mc.logActivity("PPTWebCommitTaskActivity","CommentsTasksFpsIsEnabledBRS")})}catch(lc){pa.a.$(512496789,805,10,"Exception thrown while triggering PPTWebCommitTaskActivity. Exception: {0}",lc)}}}Zb.u1e="temp-id";Object(c.a)(Zb,"CommentAPI",null,[584,585]);var qc=a(206),pc=a(380),ac=a(1422);class gb{constructor(mb,lc,Mc){this.S2g=mb;this.commentId=
lc;this.state=Mc}}Object(c.a)(gb,"CommentTextAnchorToHighlight",null,[]);class Jb extends Sys.EventArgs{constructor(mb){super();this.gzm=mb}}Object(c.a)(Jb,"CommentsVisibilityOnSmartArtChangeEventArgs",Sys.EventArgs,[]);class uc{constructor(mb,lc,Mc,md,ud,Qd,kb,Xb,sc,Rc){this.Lhm=[];this.tUh=null;this.v_h=!1;if(!Rc)throw Error.argumentNull("viewElementEventNotifier");this.Oc=lc;this.zmk=this.JQg=!1;this.xQh=mb;this.DGn=Mc;this.ufe=this.fod=null;this.PA=md;this.sa=ud;this.HYa=Qd;this.wSc=kb;this.BJb=
Xb;this.MDn=sc;this.YG=Rc;this.BJb.Lah(this.MDn)}get LXa(){return this.fod&&this.fod.isConnected?this.fod:null}get BAm(){return this.JQg}Akh(mb,lc,Mc=!1,md=!1){const ud=this.DGn.fca(mb);if(ud)switch(lc){case 0:ud.display(Mc,md);this.fod=mb;break;case 1:ud.activate();this.ufe=mb;break;case 2:ud.dismiss();this.fod=null;break;case 3:this.LXa&&this.LXa===mb&&this.CRd&&this.U6i(this.CRd,mb)?ud.display(Lc.KAa(this.CRd),md):ud.dismiss();this.ufe=null;break;case 4:ud.B8m(Mc),this.fod=mb}}ZZh(mb){if(this.Oc&&
this.Oc.jd)switch(mb){case 0:this.Oc.jd.highlight();this.JQg=!0;break;case 2:this.Oc.jd.Dxl();this.JQg=!1;break;case 1:this.Oc.jd.highlight();this.zmk=!0;break;case 3:this.Oc.jd.Dxl(),this.zmk=!1}}PIh(){this.xQh&&(this.JQg?this.ZZh(2):this.LXa&&this.Akh(this.LXa,2),this.AVe(null))}U6i(mb,lc){if(!Lc.KAa(mb))return!0;mb=this.PA.j3();return qc.a.any(mb,Mc=>!Lc.KAa(Mc)&&Mc.anchorShape===lc.get_shapeId())}J6k(mb,lc,Mc,md=!1,ud=!1){if(this.xQh&&mb&&(!md||uc.tTd(this.PA.j3(),mb))){md=this.wqb(mb);var Qd=
this.LXa!==md&&!!this.LXa;Qd&&this.sa.b1(this.LXa);this.PIh();if(md){const kb=Lc.KAa(mb);this.ufe===md?this.U6i(mb,md)?this.Akh(md,4,kb,kb&&Qd):this.fod=md:this.U6i(mb,md)?this.Akh(md,0,kb,Mc&&Qd):this.fod=md;lc=!!lc&&lc===mb.commentId;(kb||lc)&&ud||this.d$n(md,String.format(ResourceStrings.L_CommentAnchoringShapeSelection,mb.authorName,mb.dt.toDateString(),mb.dt.toLocaleTimeString()))}else this.ZZh(0),this.Oc&&this.Oc.jd&&this.Oc.jd.Ed&&this.fZh(String.format(ResourceStrings.L_CommentAnchoringSlideCommentSelection,
(this.Oc.jd.Ed.Dh+1).toString(),this.Oc.jd.Ed.title));!ud&&Qd&&this.sa.selectShape(this.LXa,!0,!1);this.AVe(null)}}QSm(mb){if(this.xQh){var lc=this.wqb(mb);lc?Lc.KAa(mb)?this.ufe=lc:this.Akh(lc,1):this.ZZh(1);this.AVe(mb)}}GIh(){this.ufe&&this.Akh(this.ufe,3);this.zmk&&!this.JQg&&this.ZZh(3);this.AVe(null)}wqb(mb){if(!mb)return null;try{return this.wSc.YKh(mb)}catch(lc){return pa.a.$(512496788,805,15,"GetAnchoredShapeForComment - Exception while getting anchored shape: {0}",lc),null}}AVe(mb){const lc=
[];var Mc=this.ufe;mb&&!Mc&&(Mc=this.LXa);const md=this.LXa?this.LXa:this.sa.Uo();md||mb&&Mc||this.eDm(lc);let ud=null;const Qd=[];var kb=!1;if(Lc.KAa(mb)&&Mc&&0<Mc.HJ().length&&(!this.CRd||mb.commentId!==this.CRd.commentId)){var Xb=Lc.I6f(mb,Mc);Xb&&Xb.isValid&&(kb=pc.a.Vf("{"+mb.commentId+"}{1}"),lc.push(new gb(Xb,kb,1)),kb=!0,Mc=this.wSc.Qk(Mc))&&(Qd.push(Mc),(Mc=Mc.shapeNode)&&Mc.xg&&(ud=Mc))}if(this.v_h||md&&0<md.HJ().length)if(Mc=this.PA.j3())for(var sc of Mc){if(!Lc.KAa(sc)||!this.v_h&&sc.anchorShape!==
md.get_shapeId()||kb&&sc.commentId===mb.commentId)continue;Xb=this.v_h?this.wqb(sc):md;if(!Xb)continue;const Rc=Lc.I6f(sc,Xb);if(!Rc||!Rc.isValid)continue;let Zc=5;(Mc=!!this.CRd&&sc.commentId===this.CRd.commentId)&&(Zc=0);const Id=pc.a.Vf("{"+sc.commentId+"}{1}");lc.push(new gb(Rc,Id,Zc));if(Xb=this.wSc.Qk(Xb))Qd.push(Xb),Xb=Xb.shapeNode,!ud&&Xb&&Mc&&Xb.xg&&(ud=Xb)}for(const Rc of this.Lhm)!Rc||Array.contains(Qd,Rc)||Rc.shapeNode&&Rc.shapeNode.xg||(Rc.kgg=!1,Rc.isLocked||!Rc.vp||Rc.fz||Rc.jhc());
mb=null;for(const Rc of Qd)(sc=Rc.shapeNode)&&sc.xg?(mb||(mb=sc),ud||md!==sc||(ud=sc)):(Rc.kgg=!0,Rc.vp||(pa.a.$(512496787,805,50,"DetermineTextAnchorHighlighting - Switched from FidelityView to EditView to display text anchors"),Rc.ptd()));ud||this.sa.uM()||!mb||(ud=mb);this.Lhm=Qd;this.YG.ism(new Jb(ud));this.eDm(lc)}eDm(mb){mb=Object.assign(new ac.a,{action:0,type:0,ngb:mb,y5c:this.BJb.EQc?this.BJb.EQc.ngb:null});this.BJb.C5e(mb)}fZh(mb){this.HYa.RKb(mb)}d$n(mb,lc){this.HYa.pSk(mb,lc)}H9k(mb){this.xQh=
mb}get CRd(){return this.tUh&&this.tUh.n5e?this.tUh.n5e.comment:null}static tTd(mb,lc){if(mb)for(const Mc of mb)if(lc.commentId===Mc.commentId)return!0;return!1}}Object(c.a)(uc,"CommentAnchoringHighlightsHelper",null,[]);var Cc=a(55);class Gc{constructor(mb,lc,Mc,md,ud,Qd,kb){this.rc=mb;this.ya=lc;this.oRh=Mc;this.kDa=md;this.FGn=ud;this.Gb=Qd;this.Yb=kb;this.uLl=0}Wtd(mb,lc){if(mb||1!==this.vPh)if(2>this.rc.zl())this.USm?this.Pal(5):this.Pal(1);else{const Mc=Cc.a.Xk("UpdateNextPopulatedContextDetails",
2);this.oRh.S8i((md,ud,Qd)=>{this.IRn(md,ud,Qd,Mc,lc)},Mc)}}get vPh(){return this.uLl}IRn(mb,lc,Mc,md,ud){let Qd=1;if(this.ya.Ia){const kb=this.ya.Ia.Dh;let Xb=!1,sc=!1,Rc=!1;lc&&mb&&(mb=mb.Dh,mb<kb?Xb=!0:mb===kb?sc=!0:(Rc=!0,Mc||(Xb=!0)));0<=ud&&(ud<kb?Xb=!0:ud===kb?sc=!0:Rc=!0);Rc?Qd=Xb||sc?3:2:Xb?Qd=4:sc&&(Qd=5)}this.Pal(Qd);md.finish();u.a.Ljc(this.Yb,()=>{this.Gb.fg()})}Pal(mb){this.uLl=mb;this.FGn.Wtd(mb,1===this.Gb.mode)}get USm(){return!!this.ya.Ia&&this.kDa.T8m(this.ya.Ia)}}Object(c.a)(Gc,
"CommentContextDetailsUpdateHelper",null,[540]);var dd=a(51);class ld{dao(mb){if(null===mb)throw Error.argumentNull("comment");mb.setValue(dd.a.commentId,"")}aao(mb,lc){if(null===mb)throw Error.argumentNull("comment");mb.setValue(dd.a.JUe,lc)}bao(mb){if(null===mb)throw Error.argumentNull("comment");if(mb=Object(X.a)(579,mb))mb.SHb=ResourceStrings.anonymousCommentAuthor}J5e(mb){if(null===mb)throw Error.argumentNull("comment");mb.setValue(dd.a.vjd,!0)}Uxm(mb,lc,Mc,md){if(null===mb)throw Error.argumentNull("comment");
if(mb=Object(X.a)(579,mb))mb.authorName=lc,mb.authorId=Mc,mb.BBf=md}fao(mb,lc){if(null===mb)throw Error.argumentNull("comment");mb.setValue(dd.a.cCc,lc)}eao(mb,lc){if(!mb)throw Error.argumentNull("comment");lc=ca.c(lc);mb.setValue(dd.a.reactions,lc)}}Object(c.a)(ld,"CommentEditor",null,[583]);var bc=a(45),cc=a(96),Vc=a(77);class td{constructor(){this.anchorShape=0;this.dt=this.commentId=this.Children=this.changesData=this.authorName=null;this.isUnread=!1;this.reactions=this.providerId=this.pos=null;
this.status=0;this.userId=this.textAnchoringInfo=this.text=this.taskInfo=null}}Object(c.a)(td,"Comment",null,[]);var Xc=a(303),ne=a(1210),Vd=a(275),Ja=a(71),Lb=a(44);class fa{constructor(mb,lc,Mc,md,ud,Qd,kb,Xb,sc,Rc,Zc,Id,Td,he,be){this.sJb=null;this.Xnd=md;this.Tb=ud;this.ya=Qd;this.J5=kb;this.Evb=Xb;this.Jb=sc;this.Vb=Rc;this.sa=Zc;this.Pfa=Id;this.Bsg=Td;this.qc=he;this.YYa=be;this.X5=mb;this.KDn=Mc;this.mEn=0===lc;this.QDm();this.r4j()}dispose(){}get userName(){return this.Jb.appSettings.UserName}get userId(){return this.Jb.appSettings[lb.a.ZTa]}get providerId(){return this.Jb.appSettings[lb.a.dcc]}get bub(){return this.Jb.getBooleanAppSetting(Ja.a.bub)}get $9l(){return rb.a("Comments.LogTasksTelemetry")}get V6i(){return this.Jb.getBooleanAppSetting("SlideResizePerfImprovementEnabled")}addComment(mb,
lc,Mc){this.$Ol("",mb,lc,Mc,null,null,null,null)}eTm(mb,lc,Mc,md,ud,Qd,kb,Xb){this.$Ol(mb,lc,Mc,md,ud,Qd,kb,Xb)}$Ol(mb,lc,Mc,md,ud,Qd,kb,Xb){const sc=this.X5.Xl("UserAction","AddComment");h.AFrameworkApplication.ha.fY?this.bPl(mb,lc,Mc,md,ud,Qd,kb,Xb,sc):this.Jb.Wf(()=>{this.bPl(mb,lc,Mc,md,ud,Qd,kb,Xb,sc)})}bPl(mb,lc,Mc,md,ud,Qd,kb,Xb,sc){this.KDn.OQd().then(Rc=>{fa.nwm&&(pa.a.$(512262931,805,15,"FirstCommentBeingAdded - IsBlank:{0}; CreateNewCommentPolicyEnabled:{1}",this.mEn,Rc),this.Pfa.EBn(Rc),
fa.nwm=!1);this.dTm(mb,lc,Mc,md,ud,Qd,kb,Xb);sc&&sc.stop();return Rc}).catch(Rc=>{pa.a.$(512262930,805,10,JSON.stringify(Rc));throw Error.create("CreateNewEnabledAsync or AddCommentOnFullAppSettingsReady failed");})}dTm(mb,lc,Mc,md,ud,Qd,kb,Xb){if(this.PYe()){var sc=!1,Rc=0,Zc=0;md&&(sc=!0,Rc=md.x,Zc=md.y);md=this.Tb.xe(15);try{var Id=this.sJb;md.tc(Id);const Td=bc.GraphIterator.vb(Id),he=Object(X.a)(cc.a,this.Xnd.createInstance(1074135127));this.Evb.J5e(he);this.Evb.dao(he);this.Evb.aao(he,mb);Id=
null;const be=Object(X.a)(579,he);if(be){if(be.THb=sc)be.SMa=Object.assign(new ne.a,{X:Rc,Y:Zc});be.m1h=this.Bsg.d5l();be.HLd=Qd;if(Id=Object(X.a)(351,ud))be.fPd=Id.get_shapeId();Mc&&(be.ITa=Mc);kb&&(be.taskInfo=kb);Xb&&(be.textAnchoringInfo=Xb);be.d3a=lc}let Ue=this.userId;ud=!Ue;const cf=!this.providerId,mf=!this.userName;(ud||cf)&&pa.a.$(512262928,805,ud&&!cf?15:10,"CommentEditor UserID null: {0}; ProviderID null: {1} UserName null: {2};",ud,cf,mf);rb.a("Comments.UseNameInPlaceOfUserId")&&ud&&
!cf&&(Ue=mf?ResourceStrings.anonymousCommentAuthor:this.userName);this.Evb.Uxm(he,this.userName,Ue,this.providerId);mf&&this.Evb.bao(he);Td.wl(he,1);pa.a.$(512262927,805,50,"CommentManager::AddCommentOnFullAppSettingsReady - Added comment: {0}; Has Task: {1}; Is Text Anchored: {2}, Is Shape Anchored: {3}",mb,!!kb,!!Xb,!!Id)}finally{md&&md.dispose()}this.pBn(mb,Mc,lc,Xb,kb)}else pa.a.$(512262929,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - CommentContentNode is unavailable")}pBn(mb,lc,
Mc,md,ud){this.$9l?lc?(lc=this.nZb(lc))?(lc=this.hlc(lc))?this.Pfa.qBn(mb,Mc.length-1,!!md,lc.taskInfo,ud):pa.a.$(512262925,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment not found"):pa.a.$(512262926,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment node not found"):this.Pfa.rBn(mb,Mc.length-1,!!md,!!ud):this.Pfa.U3j(mb,Mc.length-1,!!md,!!ud)}deleteComment(mb){this.Pfa.zCn();if(this.PYe()){var lc=this.Tb.Kd(15);try{lc.tc(this.sJb),this.eYi(mb,this.sJb),
lc.wc=Lb.a.deleteComment}finally{lc&&lc.dispose()}}else pa.a.$(512262924,805,10,"CommentManager::DeleteComment - CommentContentNode is unavailable")}eYi(mb,lc){rb.a("IsDeselectShapeOnDeleteCommentEnabled")&&this.sa.H$()&&(pa.a.$(512262923,805,15,"CommentManager::DeleteCommentHelper - Removing shape selection in text edit while deleting comment"),this.sa.nj());const Mc=this.kfn(mb,lc);if(Mc&&0<Mc.count){this.Evb.J5e(lc);for(const md of Mc)lc=bc.GraphIterator.vb(md),lc.sc(39),lc.Ui();pa.a.$(512262922,
805,50,"CommentManager::DeleteCommentHelper - Deleted comment {0}",mb)}else pa.a.$(512262921,805,10,"CommentManager::DeleteCommentHelper - Failed to find comment node {0}",mb);this.Pfa.d4n()}zWb(){const mb=Date.now();this.Pfa.GBn();const lc=this.j3();if(lc){var Mc=this.Tb.Kd(15);try{Mc.tc(this.ya.Ia);for(const md of lc)this.eYi(md.commentId,this.sJb);Mc.wc=Lb.a.zWb}finally{Mc&&Mc.dispose()}pa.a.$(512262919,805,50,"CommentManager::DeleteAllCommentsInSlide - Time taken: {0} ms",Date.now()-mb)}else pa.a.$(512262920,
805,10,"CommentManager::DeleteAllCommentsInSlide - Failed to retrieve comments of active slide")}EOf(mb){const lc=Date.now();mb?this.Pfa.HBn():this.Pfa.FBn();const Mc=this.ya.presentation;if(Mc){var md=Mc.slides;if(md){var ud=this.Tb.Kd(15);try{ud.tc(Mc);for(const Qd of md){const kb=Object(X.a)(22,Qd);if(!kb||!kb.TX()){pa.a.$(512262918,805,10,"CommentManager::DeleteAllComments - slideNode not found or has no comments node: {0}",kb);continue}const Xb=bc.GraphIterator.vb(kb).Fb(16);for(const sc of this.ilc(kb.TX()))(mb?
1===sc.status:1)&&this.eYi(sc.commentId,Xb)}ud.wc=mb?Lb.a.WDc:Lb.a.VDc}finally{ud&&ud.dispose()}pa.a.$(512262917,805,50,"CommentManager::DeleteAllComments - Time taken: {0} ms - fOnlyDeleteResolved: {1}",Date.now()-lc,mb)}}}n9m(mb,lc,Mc){this.m9m(mb,lc,Mc)}m9m(mb,lc,Mc){if(this.PYe()){var md=this.nZb(lc);if(md){const ud=this.Tb.xe(15);try{ud.tc(md);this.Evb.J5e(md);const Qd=Object(X.a)(579,md);Qd&&(Qd.d3a=mb,Qd.HLd=Mc)}finally{ud&&ud.dispose()}pa.a.$(512262915,805,50,"CommentManager::EditCommentInternal - Edited comment {0}",
lc)}else pa.a.$(512262914,805,10,"CommentManager::EditCommentInternal - Failed to find comment node {0}",lc);this.Pfa.LBn()}else pa.a.$(512262916,805,10,"CommentManager::EditCommentInternal - CommentContentNode is unavailable")}Ere(mb,lc){if(this.PYe()){var Mc=this.nZb(mb);if(Mc){if(null===lc)throw Error.argumentNull("pos");const md=this.Tb.xe(15);try{md.tc(Mc),this.Evb.J5e(Mc),Object(X.a)(579,Mc).SMa=Object.assign(new ne.a,{X:lc.x,Y:lc.y})}finally{md&&md.dispose()}pa.a.$(512262912,805,50,"CommentManager::MoveComment - Moved comment {0}",
mb)}else pa.a.$(512262883,805,10,"CommentManager::MoveComment - Failed to find comment node {0}",mb);this.Pfa.cCn(mb)}else pa.a.$(512262913,805,10,"CommentManager::MoveComment - CommentContentNode is unavailable")}Olo(mb,lc,Mc){this.Jb.Wf(()=>{this.Plo(mb,lc,Mc)})}Plo(mb,lc,Mc){if(this.PYe()){var md=this.nZb(mb);if(md){var ud=this.Tb.xe(15);try{ud.tc(md);this.Evb.J5e(md);const Rc=Object(X.a)(579,md);if(Rc){var Qd=Rc.reactions,kb={DisplayName:this.userName,Email:void 0,FullName:this.userName,ProviderId:this.providerId,
UserId:this.userId};if(Mc){let Zc;Zc=vb(Qd,kb);a:{mb=Zc;var Xb;const Id={Time:new Date,User:kb};if(mb&&mb.ReactionList){for(const [Td,he]of mb.ReactionList.entries())if(he.Type===lc){null===(Xb=mb.ReactionList[Td].ReactionInstances)||void 0===Xb?void 0:Xb.push(Id);Zc=mb;break a}mb.ReactionList.push({Type:lc,ReactionInstances:[Id]})}else mb={ReactionList:[{Type:lc,ReactionInstances:[Id]}]};Zc=mb}var sc=Zc}else sc=vb(Qd,kb);this.Evb.eao(md,sc)}else pa.a.$(509215366,805,10,"CommentManager::updateCommentReactionsInternal - Failed to cast to comment node {0}",
mb)}finally{null===ud||void 0===ud?void 0:ud.dispose()}}else pa.a.$(509219337,805,10,"CommentManager::updateCommentReactionsInternal - Failed to find comment node {0}",mb)}else pa.a.$(509613472,805,10,"CommentManager::updateCommentReactionsInternal - CommentContentNode is unavailable")}aEm(mb,lc,Mc){if(this.PYe()){var md=this.nZb(mb);if(md){const ud=this.Tb.xe(15);try{ud.tc(md),this.Evb.J5e(md),this.Evb.fao(md,lc),Object(X.a)(579,md).Jib=Mc,this.bub&&this.Evb.Uxm(md,this.userName,this.userId,this.providerId)}finally{ud&&
ud.dispose()}if(this.$9l){Mc=this.hlc(md);if(!Mc){pa.a.$(512262881,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment");return}1===lc?this.Pfa.mCn(!!Mc.taskInfo):0===lc&&this.Pfa.SCn(!!Mc.taskInfo)}else 1===lc&&this.Pfa.nCn();pa.a.$(512262880,805,50,"CommentManager::UpdateCommentStatus - Updated comment status {0}:{1}",mb,lc)}else pa.a.$(512262879,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment node {0}",mb)}else pa.a.$(512262882,805,10,"CommentManager::UpdateCommentStatus - CommentContentNode is unavailable")}j3(){return this.ilc(this.sJb)}ilc(mb){const lc=
[];if(!mb||39!==mb.type)return lc;mb=bc.GraphIterator.vb(mb);for(var Mc=mb.uj();Mc;){if(40===Mc.type){const md=Object(X.a)(579,Mc).ITa;Mc=this.hlc(Mc);if(md)for(const ud of lc)ud.commentId===md&&(ud.Children||(ud.Children=[]),ud.Children.push(Mc));else lc.push(Mc)}Mc=mb.Tp()}return lc}QDm(){const mb=this.ya.Ia;this.sJb=mb?bc.GraphIterator.vb(mb).Fb(16):null}yhn(){if(!this.sJb)return!1;const mb=bc.GraphIterator.vb(this.sJb);if(this.J5.lfj(this.sJb))return!0;let lc=mb.uj();for(;lc;){if(this.J5.lfj(lc))return!0;
lc=mb.Tp()}return!1}sbn(mb,lc){return this.z0l(mb,lc,!1)}vbn(mb,lc){return this.z0l(mb,lc,!0)}z0l(mb,lc,Mc){if(!mb)return null;if(mb=mb.TX()){mb=this.Vb.Lc(mb);let md=Mc?mb.GKc():mb.uj();for(;md;){if(!(this.J5.xae(md)||lc&&0!==this.J5.C_f(md)))return this.hlc(md);md=Mc?mb.wwa():mb.Tp()}}return null}T8m(mb){return mb?(mb=mb.TX())?!!this.Vb.Lc(mb).uj():!1:!1}OWe(mb){if(!mb)return 0;var lc=mb.TX();mb=0;if(lc){lc=this.Vb.Lc(lc);let Mc=lc.uj();for(;Mc;)this.J5.xae(Mc)||mb++,Mc=lc.Tp()}return mb}PYe(){return!!this.sJb&&
this.sJb.isConnected}kfn(mb,lc){lc=bc.GraphIterator.vb(lc);var Mc=lc.uj();const md=new d.a;for(;Mc;){const ud=this.J5.lLh(Mc),Qd=Object(X.a)(579,Mc).ITa;mb!==ud&&mb!==Qd||md.add(Mc);Mc=lc.Tp()}return md}nZb(mb){const lc=bc.GraphIterator.vb(this.sJb);let Mc=lc.uj();for(;Mc;){const md=this.J5.lLh(Mc);if(mb===md)return Mc;Mc=lc.Tp()}return null}cpj(mb){mb=this.nZb(mb);if(!mb)return null;const lc=Object(X.a)(579,mb).ITa;return yc.a.wb(lc)?mb:this.nZb(lc)}hlc(mb){const lc=Object(X.a)(579,mb);if(!lc)return null;
const Mc=new td;Mc.dt=lc.Rjd;Mc.text=lc.d3a;Mc.status=this.J5.C_f(mb);Mc.userId=lc.authorId;Mc.commentId=this.J5.lLh(mb);Mc.authorName=lc.authorName;Mc.providerId=lc.BBf;Mc.anchorShape=lc.fPd;Mc.pos=Object.assign(new Xc.a,{X:lc.SMa.X,Y:lc.SMa.Y});Mc.taskInfo=lc.taskInfo;Mc.textAnchoringInfo=lc.textAnchoringInfo;Mc.changesData=lc.changesData;Mc.isUnread=this.YYa.instance&&this.YYa.instance.Hwn(lc);ec(this.Jb)&&(Mc.reactions=lc.reactions);return Mc}uYd(mb){if(!mb)return[];const lc=this.ilc(mb.TX());
if(!lc||this.V6i&&!lc.length){if(!lc)throw Error.create("GetCommentsSortedByPositionForSlide - Comments should not be null");return lc}lc.sort((Mc,md)=>{var ud=this.qc.H5f(mb,Mc.anchorShape);ud=ud?ud.PT:new Vc.a(0,0);var Qd=this.qc.H5f(mb,md.anchorShape);Qd=Qd?Qd.PT:new Vc.a(0,0);ud.y+=Mc.pos.Y;Qd.y+=md.pos.Y;ud.x+=Mc.pos.X;Qd.x+=md.pos.X;let kb=ud.y-Qd.y;kb||(kb=ud.x-Qd.x)||(kb=+Mc.dt-+md.dt);return kb});return lc}Eln(mb){var lc=this.ya.presentation;if(!lc)return null;lc=lc.slides;if(!lc)return null;
for(const Mc of lc)if(lc=Object(X.a)(Vd.a,Mc))for(const md of this.ilc(lc.TX())){if(mb===md.commentId)return Mc;if(md.Children)for(const ud of md.Children)if(mb===ud.commentId)return Mc}return null}r4j(){let mb=0,lc=0;var Mc=this.ya.presentation;if(Mc){var md=Mc.slides;if(md){Mc=new d.a;for(const ud of md)if((md=Object(X.a)(Vd.a,ud))&&md.TX())for(const Qd of this.ilc(md.TX()))Lc.KAa(Qd)?lc+=1:Qd.textAnchoringInfo&&Mc.add(Qd.commentId),mb+=1;this.Pfa.r4j(mb,lc,Mc)}}}}fa.nwm=!0;Object(c.a)(fa,"CommentManager",
null,[581,582,40]);var Na=a(145);class ha{constructor(mb,lc,Mc,md){this.kDa=mb;this.Oc=lc;this.zb=Mc;this.Fc=md}pln(mb){if(null===mb)throw Error.argumentNull("comment");if(mb=this.YKh(mb))if(mb=this.Qk(mb))return mb.va.va;return null}hen(mb){if(null===mb)throw Error.argumentNull("comment");if(mb=this.YKh(mb)){if(mb.gd){var lc=this.Fc.IS(mb);if(!lc)return pa.a.$(595133523,805,10,"GetAnchorBoundingRegion: Shape {0} is table shape but has no table node",mb.get_shapeId()),null;lc=lc.yc(this.zb.Ua);return lc&&
lc.htmlElement?Na.a.Bia(new Sys.UI.Bounds(lc.htmlElement.clientLeft,lc.htmlElement.clientTop,lc.htmlElement.clientWidth,lc.htmlElement.clientHeight)):(pa.a.$(595133521,805,10,"GetAnchorBoundingRegion: cannot find table view element for table shape {0}",mb.get_shapeId()),null)}if(mb=this.Qk(mb))return mb=mb.va.va,Na.a.Bia(new Sys.UI.Bounds(mb.clientLeft,mb.clientTop,mb.clientWidth,mb.clientHeight))}return null}YKh(mb){if(null===mb)throw Error.argumentNull("comment");if(!mb.anchorShape)return null;
mb=this.kDa.cpj(mb.commentId);mb=this.kDa.hlc(mb);if(!mb)return null;const lc=this.Oc.jd?this.Oc.jd.Ed:null;return lc?lc.ED(mb.anchorShape):(pa.a.$(557090388,805,50,"ActiveSlide is null"),null)}ien(mb){if(null===mb)throw Error.argumentNull("comment");if(!mb.anchorShape)return 0;if(mb=this.YKh(mb))if(mb=this.Qk(mb))return mb.rotation;return 0}Qk(mb){if(null===mb)throw Error.argumentNull("shapeNode");return Object(X.a)(112,mb.yc(this.zb.Ua))}}Object(c.a)(ha,"CommentMarkerAnchorHelper",null,[534]);var sa=
a(654),xa=a(130);class pb{constructor(mb,lc,Mc){this.Ana=mb;this.Oc=lc;this.jak=Mc}S8m(mb){const lc=Object(X.a)(579,this.jak.nZb(mb.commentId));if(!lc)throw b.ULS.sendTraceTag(508360530,805,10,"There is no graph node for comment {0}",mb.commentId),Error.invalidOperation("GraphNodeNotFoundForComment");return!!lc.SMa}zkn(mb,lc){if(!mb)throw Error.argumentNull("commentMarkerViewElement");if(!lc)throw Error.argumentNull("comment");if(!this.jak.nZb(lc.commentId))return b.ULS.sendTraceTag(508360529,805,
10,"GetRenderingPosition: There is no graph node for comment {0}",lc.commentId),new Vc.a(0,Number.MIN_VALUE);const Mc=mb.ju;mb=mb.pWh;if(!this.S8m(lc)||!lc.pos.X&&!lc.pos.Y){if(Mc)return lc=new Vc.a(Mc.Gd-Mc.Mc-pb.UYh.width-pb.mwm.width,pb.mwm.height),pb.v6l(lc,Mc,mb),lc;if(this.Oc.jd&&this.Oc.jd.hs)return new Vc.a(this.Oc.jd.hs.clientWidth-pb.UYh.width,0);b.ULS.sendTraceTag(508360528,805,10,"m_activeSlideViewManager.ActiveSlideView || m_activeSlideViewManager.ActiveSlideView.ScreenBoundsElement is null");
return new Vc.a(0,0)}lc=new Vc.a(this.Ana.te(lc.pos.X,0),this.Ana.te(lc.pos.Y,1));lc=new Vc.a(lc._x-pb.lsd._x,lc._y-pb.lsd._y);Mc&&(lc._x=Math.max(0,lc._x),lc._y=Math.max(0,lc._y),lc._x=Math.min(lc._x,Mc.Gd-Mc.Mc-pb.UYh.width),lc._y=Math.min(lc._y,Mc.Bd-Mc.hd-pb.UYh.height),pb.v6l(lc,Mc,mb));return lc}Mlo(mb,lc){var Mc=new Vc.a(mb.element.offsetLeft,mb.element.offsetTop);Mc=new Vc.a(Mc._x+pb.lsd._x,Mc._y+pb.lsd._y);const md=mb.ju;md&&mb.pWh%360&&pb.HRl(Mc,0-mb.pWh,md.Ki());lc.pos.X=this.Ana.Bf(Mc._x,
0);lc.pos.Y=this.Ana.Bf(Mc._y,1);this.jak.Ere(lc.commentId,new Vc.a(lc.pos.X,lc.pos.Y))}static v6l(mb,lc,Mc){if(lc&&Mc%360){var md=new Vc.a(mb._x+pb.lsd._x,mb._y+pb.lsd._y);pb.HRl(md,Mc,lc.Ki());mb.update(md._x-pb.lsd._x,md._y-pb.lsd._y)}}static HRl(mb,lc,Mc){mb.AU(0-Mc._x,0-Mc._y);lc=sa.a.Ekc(lc);mb.update(mb._x*Math.cos(lc)-mb._y*Math.sin(lc)+Mc._x,mb._x*Math.sin(lc)+mb._y*Math.cos(lc)+Mc._y)}}pb.UYh=new xa.a(20,20);pb.mwm=new xa.a(4,4);pb.lsd=new Vc.a(4,20);Object(c.a)(pb,"CommentMarkerPositionHelper",
null,[535]);var Rb=a(221),Fc=a(109),Kc=a(67);class jb{constructor(mb,lc){this.oZc=this.WWc=this.rik=null;this.Vrg=mb;this.Lz=lc}Xv(){return!0}Wu(mb){if(!mb)return!1;this.oZc=this.Vrg.element.style;this.rik=new Vc.a(mb.clientPoint.x,mb.clientPoint.y);this.WWc=new Vc.a(parseInt(this.oZc.left),parseInt(this.oZc.top));this.Yv(mb);return!0}Yv(mb){if(!mb)return!1;mb=this.r3l(new Vc.a(mb.clientPoint.x,mb.clientPoint.y),this.rik);this.oZc.left=Kc.a.Zc(this.WWc._x+mb._x);this.oZc.top=Kc.a.Zc(this.WWc._y+mb._y);
return!0}Xn(mb){if(mb){mb=this.r3l(new Vc.a(mb.clientPoint.x,mb.clientPoint.y),this.rik);var lc=this.WWc._x+mb._x,Mc=this.WWc._y+mb._y,md=this.Vrg.ju;md&&(lc=Math.max(md.Mc,lc),lc=Math.min(md.Gd-this.Vrg.element.clientWidth,lc),Mc=Math.max(md.hd,Mc),Mc=Math.min(md.Bd-this.Vrg.element.clientHeight,Mc),mb._x=lc-this.WWc._x,mb._y=Mc-this.WWc._y);this.oZc.left=Kc.a.Zc(lc);this.oZc.top=Kc.a.Zc(Mc);this.Vrg.Ijm(mb)}}tu(){this.oZc.left=Kc.a.Zc(this.WWc._x);this.oZc.top=Kc.a.Zc(this.WWc._y)}r3l(mb,lc){mb=
Vc.a.kv(mb,lc);return new Vc.a(this.Lz.Fs(mb.x),this.Lz.Fs(mb.y))}}Object(c.a)(jb,"CommentMarkerDragAdapter",null,[229]);class zb{constructor(mb,lc,Mc,md,ud,Qd,kb,Xb){this.Rfe=null;this.sod=this.uod=!1;if(!lc)throw Error.argumentNull("parentElement");this.B_e=Xb;this.Dvb=mb;this.$s=Mc;this.Z4b=md;this.Uca=ud;this.eRh=kb;this.PD=document.createElement("div");this.PD.className=Lc.XJh(mb)?this.Uca.ejm:this.Uca.djm;this.PD.title=ResourceStrings.L_CommentMarkerTooltip;this.PD.style.display=this.eRh||this.B_e?
"none":"block";this.PD.setAttribute("data-pptcommentid",String.format("{0}",mb.commentId));this.z8=document.createElement("img");this.z8.alt=ResourceStrings.L_CommentMarkerTooltip;this.z8.src=Mc.frame.Eq(Mc.frame.KMa+".png");this.z8.setAttribute(Rb.a.ii,Rb.a.fM);this.PD.appendChild(this.z8);this.Ttd();this.frame.kf.Ub(Db.a.click,this.PD,Object(Ta.a)(this,this.yV,"clickHandler"));Lc.$Jh&&(sb.a.addHandler(this.PD,Db.a.jv,Object(Ta.a)(this,this.S$a,"mouseOverHandler")),sb.a.addHandler(this.PD,Db.a.hy,
Object(Ta.a)(this,this.SVg,"mouseOutHandler")));Lc.RGh&&sb.a.addHandler(this.z8,Db.a.mouseDown,Object(Ta.a)(this,this.h7g,"preventNativeDragMouseDownHandler"));lc.appendChild(this.PD);Qd||this.MRi()}dispose(){this.z8&&(Lc.RGh&&sb.a.removeHandler(this.z8,Db.a.mouseDown,Object(Ta.a)(this,this.h7g,"preventNativeDragMouseDownHandler")),this.frame.kf.hc(Db.a.click,this.PD,Object(Ta.a)(this,this.yV,"clickHandler")),this.z8.parentNode&&this.z8.parentNode.removeChild(this.z8),this.z8=null);this.PD&&(Lc.$Jh&&
(sb.a.removeHandler(this.PD,Db.a.jv,Object(Ta.a)(this,this.S$a,"mouseOverHandler")),sb.a.removeHandler(this.PD,Db.a.hy,Object(Ta.a)(this,this.SVg,"mouseOutHandler"))),this.Z4b&&(this.Z4b.HFf(),this.Z4b.aM(this.PD,this.Rfe)),this.PD.parentNode&&this.PD.parentNode.removeChild(this.PD));this.$s=this.Dvb=null}get comment(){return this.Dvb}get element(){return this.PD}get frame(){return this.$s.frame}MRi(){this.Z4b&&(this.Rfe=new jb(this,ob.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),
this.Z4b.bP(this.PD,this.Rfe))}updatePosition(mb){this.PD.style.left=Kc.a.Zc(mb._x-(this.$s.isRightToLeft?this.Uca.Dqk:0));this.PD.style.top=Kc.a.Zc(mb._y)}Ijm(mb){this.$s.Ere(this.Dvb,mb)}select(mb){this.uod=mb;this.Ttd()}activate(mb){this.sod=mb;this.Ttd()}Hzm(){}setVisibility(mb){this.PD.style.display=mb&&!this.B_e?"block":"none"}Ttd(){this.B_e||(this.z8.className=Lc.XJh(this.Dvb)?this.uod?Fc.e(this.frame.KMa,this.Uca.hjm):this.sod?Fc.e(this.frame.KMa,this.Uca.fjm):Fc.e(this.frame.KMa,this.Uca.gjm):
this.uod?Fc.e(this.frame.KMa,this.Uca.cjm):this.sod?Fc.e(this.frame.KMa,this.Uca.Cqk):Fc.e(this.frame.KMa,this.Uca.tUg))}get ju(){return null}get pWh(){return 0}yV(mb){if(mb.sE!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.Dvb,null,!1,!0,mb.Dg,1,!1);mb=mb.Pb;mb.preventDefault();mb.stopPropagation();return!0}S$a(){this.frame.iTe(this.Dvb,1)}SVg(){this.frame.iTe(null,1)}h7g(mb){mb.preventDefault()}}Object(c.a)(zb,"LegacyCommentMarkerViewElement",null,[605]);var ic=a(111),bb=
a(1023);class Pb{constructor(mb,lc,Mc,md,ud,Qd,kb,Xb,sc){this.Rfe=null;this.hem=this.sod=this.uod=!1;if(!lc)throw Error.argumentNull("parentElement");this.Dvb=mb;this.$s=Mc;this.Z4b=md;this.Uca=ud;this.wSc=Qd;this.vQh=kb;this.eRh=sc;this.PD=document.createElement("div");this.PD.className=Lc.XJh(mb)?this.Uca.ejm:this.Uca.djm;Sys.UI.DomElement.addCssClass(this.PD,"CommentMarker");this.PD.title=ResourceStrings.L_CommentMarkerTooltip;this.PD.style.display="none";this.PD.setAttribute("data-pptcommentid",
String.format("{0}",mb.commentId));this.z8=document.createElement("img");this.z8.alt=ResourceStrings.L_CommentMarkerTooltip;this.z8.src=Mc.frame.Eq(Mc.frame.KMa+".png");this.z8.setAttribute(Rb.a.ii,Rb.a.fM);this.PD.appendChild(this.z8);this.Ttd();this.frame.kf.Ub(Db.a.click,this.PD,Object(Ta.a)(this,this.yV,"clickHandler"));Lc.$Jh&&(sb.a.addHandler(this.PD,Db.a.jv,Object(Ta.a)(this,this.S$a,"mouseOverHandler")),sb.a.addHandler(this.PD,Db.a.hy,Object(Ta.a)(this,this.SVg,"mouseOutHandler")));Lc.RGh&&
sb.a.addHandler(this.z8,Db.a.mouseDown,Object(Ta.a)(this,this.h7g,"preventNativeDragMouseDownHandler"));lc.appendChild(this.PD);Xb||this.MRi()}dispose(){this.z8&&(Lc.RGh&&sb.a.removeHandler(this.z8,Db.a.mouseDown,Object(Ta.a)(this,this.h7g,"preventNativeDragMouseDownHandler")),this.frame.kf.hc(Db.a.click,this.PD,Object(Ta.a)(this,this.yV,"clickHandler")),this.z8.parentNode&&this.z8.parentNode.removeChild(this.z8),this.z8=null);this.PD&&(Lc.$Jh&&(sb.a.removeHandler(this.PD,Db.a.jv,Object(Ta.a)(this,
this.S$a,"mouseOverHandler")),sb.a.removeHandler(this.PD,Db.a.hy,Object(Ta.a)(this,this.SVg,"mouseOutHandler"))),this.Z4b&&(this.Z4b.HFf(),this.Z4b.aM(this.PD,this.Rfe)),this.PD.parentNode&&this.PD.parentNode.removeChild(this.PD));this.$s=this.Dvb=null}get comment(){return this.Dvb}get element(){return this.PD}get frame(){return this.$s.frame}MRi(){this.Z4b&&(this.Rfe=new jb(this,ob.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.Z4b.bP(this.PD,this.Rfe))}updatePosition(){const mb=
this.vQh.zkn(this,this.comment);this.PD.style.left=mb._x+"px";this.PD.style.top=mb._y+"px"}Ijm(){this.vQh.Mlo(this,this.comment)}select(mb){this.uod=mb;this.Ttd();this.ETa()}activate(mb){this.sod=mb;this.Ttd();this.ETa()}Hzm(mb){this.hem=mb;this.Ttd();this.ETa()}setVisibility(mb){this.eRh=!mb;this.ETa()}ETa(){!this.eRh&&(this.uod||this.sod||this.hem)?(this.updatePosition(this.frame.zCc(this.comment.pos.X,this.comment.pos.Y)),this.PD.style.display="block",ic.a.a3(this.PD,bb.a.rob)):(this.PD.style.display=
"none",ic.a.dib(this.PD,bb.a.rob))}get ju(){return this.wSc.hen(this.Dvb)}get pWh(){return this.wSc.ien(this.Dvb)}Ttd(){this.z8.className=Lc.XJh(this.Dvb)?this.uod?Fc.e(this.frame.KMa,this.Uca.hjm):this.sod?Fc.e(this.frame.KMa,this.Uca.fjm):Fc.e(this.frame.KMa,this.Uca.gjm):this.uod?Fc.e(this.frame.KMa,this.Uca.cjm):this.sod?Fc.e(this.frame.KMa,this.Uca.Cqk):Fc.e(this.frame.KMa,this.Uca.tUg)}yV(mb){if(mb.sE!==Sys.UI.MouseButton.leftButton)return!1;this.frame.UB.isVisible||this.frame.Bgc();this.frame.selectComment(this.Dvb,
null,!1,!0,mb.Dg,1,!1);mb=mb.Pb;mb.preventDefault();mb.stopPropagation();return!0}S$a(){this.z8.className=Fc.e(this.frame.KMa,this.Uca.Cqk)}SVg(){this.z8.className=Fc.e(this.frame.KMa,this.Uca.tUg)}h7g(mb){mb.preventDefault()}}Object(c.a)(Pb,"ModernCommentMarkerViewElement",null,[605]);class wc{constructor(mb,lc,Mc,md,ud,Qd){this.wSc=mb;this.vQh=lc;this.Uca=Mc;this.lvg=ud;this.B_e=Qd;md.OQd().then(kb=>{kb||this.ydl(!1)})}dispose(){this.Uca=null}create(mb,lc,Mc,md,ud,Qd){if(this.lvg){const kb=this.wSc.pln(mb);
return new Pb(mb,kb||lc,Mc,md,this.Uca,this.wSc,this.vQh,ud,Qd)}return new zb(mb,lc,Mc,md,this.Uca,ud,Qd,this.B_e)}ydl(mb){this.B_e=this.lvg=mb;this.Uca.ydl(mb)}}Object(c.a)(wc,"CommentMarkerViewElementFactory",null,[536,40]);var Dc=a(30);class ed extends Dc.a{constructor(){super()}JQl(mb){this.addHandler(ed.wBm,mb)}qkm(){this.raiseEvent(ed.wBm)}}ed.wBm="S";Object(c.a)(ed,"ATransactionCompletedProcessor",Dc.a,[604]);var ad=a(53);class Gd extends ed{constructor(mb,lc,Mc){super();this.sHn=mb;this.ARh=
lc;this.u_=Mc}get index(){return 0}run(){this.sHn()}bVl(mb,lc){lc.property!==dd.a.SMa&&lc.property!==dd.a.d3a&&lc.property!==dd.a.commentId&&lc.property!==dd.a.vjd&&lc.property!==dd.a.cCc&&lc.property!==dd.a.Bcd&&lc.property!==dd.a.Acd&&lc.property!==dd.a.reactions||this.qkm()}UUl(mb,lc){lc.property!==ad.a.Ez&&lc.property!==dd.a.vjd||this.qkm()}ptn(){this.ARh.Xd(39).Rm(Object(Ta.a)(this,this.UUl,"commentContentPropertyChanged"));this.ARh.Xd(40).Rm(Object(Ta.a)(this,this.bVl,"commentPropertyChanged"));
this.u_.Pxm(this,3)}Vko(){this.ARh.Xd(40).rr(Object(Ta.a)(this,this.bVl,"commentPropertyChanged"));this.ARh.Xd(39).rr(Object(Ta.a)(this,this.UUl,"commentContentPropertyChanged"))}}Object(c.a)(Gd,"CommentPropertyTracker",ed,[]);var Od=a(399),Ld=a(157);class ee extends Od.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new Ld.a,{T_:ee.getTypeName(),B_:ee.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(c.a)(ee,"CommentSmartReplySignal",Od.a,[]);var Ce=a(600);class Pc extends Ce.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new Ld.a,{T_:Pc.getTypeName(),B_:Pc.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(c.a)(Pc,"SmartReply",Ce.a,[]);var Yc=a(299),Bd=a(286);class Dd{constructor(mb,lc){this.LMm=mb;this.DIl=
lc}initialize(){this.DIl.execute(mb=>{const lc=Pc.getTypeName();mb.v2(lc);mb.ZFa(lc,Object(Ta.a)(this,this.gra,"handleAnnotationEvent"))})}invoke(mb,lc){const Mc=Object.assign(new Yc.a,{parentPath:["Signal",ee.getTypeName()],items:[Object.assign(new Bd.a,{body:Object.assign(new ee,{commentId:mb,comment:lc})})]});this.DIl.execute(md=>{md.submitOperation(Mc)})}gra(mb){if(mb){var lc=new d.a;if(mb&&mb.CommentId&&mb.ResultSets&&0<mb.ResultSets.length&&mb.ResultSets[0].Documents&&0<mb.ResultSets[0].Documents.length){for(const Mc of mb.ResultSets[0].Documents)lc.add(Mc.Caption);
0<lc.count&&this.LMm.wYn(mb.CommentId,lc.toArray())}else pa.a.$(507843648,327,10,"Invalid response from SmartReplies request")}else pa.a.$(507843649,327,50,"Smart reply invocation returned null annotations.")}}Object(c.a)(Dd,"CommentSmartReplyProvider",null,[]);var Sd=a(334),He=a(288),ge=a(407),ve=a(110),ze=a(231),bf=a(144),Of=a(80),Qf=a(811);class Oe{constructor(mb,lc,Mc,md,ud){this.mak=this.hbk=this.Ebk=this.XPh=0;this.idm=new d.a;this.Znk=this.ndm=this.oak=this.OOg=this.Khk=0;this.Rkk=new d.a;
this.M9j=this.L9j=this.N9j=this.K9j=0;this.pcm=new d.a;this.pTh=new d.a;this.cbk=this.abk=this.bbk=this.fbk=this.Qek=this.Pek=this.Rek=this.Sek=0;this.aQh=this.Pck=this.yQh=Ma.App.Qp;this.Sod=null;this.Qnk=this.Rnk=this.MTh=this.ZTh=this.$Sh=this.J9j=0;if(!mb)throw Error.argumentNull("coreEventHandler");if(!lc)throw Error.argumentNull("appSettingsManager");this.ud=mb;this.Jb=lc;this.ya=Mc;this.J5=md;this.iak=ud;this.ud.eI(Object(Ta.a)(this,this.qr,"onSessionRehydrated"));this.ud.GF(Object(Ta.a)(this,
this.UJ,"onSessionEnd"))}get gMi(){return this.Jb.getBooleanAppSetting("CommentTextAnchoringCreateNewEnabled")}get bio(){return this.Jb.getBooleanAppSetting("TasksForCommentsEnabled")}U3j(mb,lc,Mc,md){this.XPh+=1;this.mak+=lc;Mc&&(this.K9j+=1,this.Rkk.add(mb));md&&(this.J9j+=1)}rBn(mb,lc,Mc,md){this.MTh=md?this.MTh+1:this.MTh;this.U3j(mb,lc,Mc,md)}qBn(mb,lc,Mc,md,ud){(ud=!!ud)&&md?this.Rnk+=1:ud&&(this.Qnk+=1);this.U3j(mb,lc,Mc,ud)}KCn(){this.N9j+=1}HCn(){this.L9j+=1}ICn(){this.M9j+=1}JCn(mb,lc,Mc,
md){this.Y9l(mb.commentId)||(Mc&&!this.lzn(lc,Mc.HJ(),md)?this.Tbm(mb,Mc,!0):this.Tbm(mb,Mc,!1))}d4n(){this.hbk+=1}zCn(){this.fbk+=1}GBn(){this.bbk+=1}FBn(){this.abk+=1}HBn(){this.cbk+=1}LBn(){this.Ebk+=1}cCn(mb){this.idm.contains(mb)||(this.Khk+=1,this.idm.add(mb))}mCn(mb){this.$Sh=mb?this.$Sh+1:this.$Sh;this.OOg+=1}SCn(mb){this.ZTh=mb?this.ZTh+1:this.ZTh}nCn(){this.OOg+=1}r4j(mb,lc,Mc){this.oak=mb;this.Znk=lc;this.pcm=Mc;this.Gbm()}EBn(mb){this.ndm=mb?1:2}KQn(mb){this.yQh===Ma.App.Qp&&(this.yQh=
new Date,this.H5("OnCollabCornerCommentsEnabled",this.yQh,mb),this.D7k("CollabCornerCommentsEnabled",this.yQh))}KRn(mb){this.Pck===Ma.App.Qp&&(this.Pck=new Date,this.H5("OnFloatingCommentsRendered",this.Pck,mb))}gQn(mb){this.aQh===Ma.App.Qp&&(this.aQh=new Date,this.H5("OnAllFloatingContainersVisible",this.aQh,mb),this.D7k("AllFloatingContainersVisible",this.aQh))}bRn(mb){const lc=new Date;this.H5("OnDeepLinkedCommentSelected",lc,mb);this.D7k("DeepLinkedCommentSelected",lc)}Y9l(mb){return this.pcm.contains(mb)||
this.pTh.contains(mb)}lzn(mb,lc,Mc){let md=0;for(const Qd of lc)if(lc=Object(X.a)(569,Qd.yc(Mc))){lc=lc.htmlElement.getElementsByClassName(ve.a.Ujd);for(let kb=0;kb<lc.length;kb++){var ud=lc[kb];const Xb=Sd.a.ye(ud,ve.a.QIf);Xb&&(md+=qc.a.contains(Xb,mb)?1:0);(ud=Sd.a.ye(ud,ve.a.MIf))&&(md+=qc.a.contains(ud,mb)?1:0);if(2===md)return!0}}return!1}Tbm(mb,lc,Mc){if(mb&&mb.textAnchoringInfo&&!this.Y9l(mb.commentId))if(mb.textAnchoringInfo.EndPos<=mb.textAnchoringInfo.StartPos){if(lc){if(Mc){this.Qek+=
1;this.pTh.add(mb.commentId);return}this.Rek+=1}else this.Sek+=1;this.pTh.add(mb.commentId)}else 0>=mb.textAnchoringInfo.TextBodyLength&&(this.Rkk.contains(mb.commentId)?this.Rkk.remove(mb.commentId):(this.Pek+=1,this.pTh.add(mb.commentId)))}H5(mb,lc,Mc){const md={};md.Event=mb;md.Time=lc.getTime();md.SlideId=Mc.toString();md.LandingSlide=this.iin();md.SessionDimensions=this.C5f();md.PerfMetrics=this.ten();md.CommentPerfMetrics=this.lfn();md.CommentFileType=this.iak;md.CommentDeepLinkedOpen=!!this.Jb.Ma("CurrentCommentId");
md.StandaloneCommentJsEnabled=!0;md.LoadSharedCommentsEarly=!0;md.FetchFullAppSettingsOnBoot=!0;md.PrefetchCommentCloudPolicy=!0;pa.a.$(509703831,805,15,ca.c(md))}Gbm(){pa.a.$(509703830,805,15,"Comment(s) - OnOpen:{0}; FileType:{1}",this.oak,this.iak);pa.a.$(509703829,805,15,"Text Anchor(s) - OnOpen:{0}",this.Znk);pa.a.$(509703828,805,15,"Comment/Tasks BRSs - TextAnchoringCreateNewEnabled:{0}; TasksForCommentsEnabled:{1}; ",this.gMi,this.bio)}log(){pa.a.$(509703827,805,15,"Comment(s) - Added:{0}; Edited:{1}; Deleted:{2}; AverageLength:{3}; Moved:{4}; Resolved:{5}; OnOpen:{6}; FileType:{7}; CreateNewPolicy:{8}",
this.XPh,this.Ebk,this.hbk,this.mak/this.XPh,this.Khk,this.OOg,this.oak,this.iak,this.ndm);pa.a.$(509703826,805,15,"Text Anchor(s) - OnOpen:{0}; Added:{1}; WithMultiPara:{2}; InSmartArt{3}; InTable:{4}; InvalidStartEndPos:{5}; InvalidBodyLength:{6}; InvalidShape:{7}; InvalidTextDelete:{8}",this.Znk,this.K9j,this.N9j,this.L9j,this.M9j,this.Rek,this.Pek,this.Sek,this.Qek);pa.a.$(509703825,805,15,"Deleted Comment(s) - Single:{0}; InSlide:{1}; InPresentation:{2}; Resolved:{3}",this.fbk,this.bbk,this.abk,
this.cbk);this.DCn()}DCn(){pa.a.$(509703824,845,15,"Task(s) - Added:{0}",this.J9j);const mb={};mb.ResolvedTasksCount=this.$Sh;mb.UnresolvedTasksCount=this.ZTh;mb.TasksCreatedNewThreadCount=this.MTh;mb.TasksReassignedInReplyCount=this.Rnk;mb.TasksCreatedInReplyCount=this.Qnk;pa.a.$(509703823,845,15,ca.c(mb))}qr(){this.Gbm()}UJ(){this.log()}iin(){if(this.Sod)return this.Sod;this.Sod={};var mb=parseInt(this.Jb.Ma("CurrentSlideId"));mb=mb!==Of.a.empty.sid?Of.a.Er(mb,0):this.ya.presentation.IIb(0);if(!mb)return this.Sod;
this.Sod.SlideId=mb.toString();if(mb=this.ya.presentation.lMh(mb.sid))mb=Object(X.a)(22,mb).TX(),this.Sod.HasComments=this.J5.WMh(mb),this.Sod.HasActiveComments=this.J5.SMh(mb);return this.Sod}C5f(){const mb={};mb.Ring=h.AFrameworkApplication.rd.Ring;mb.Host=h.AFrameworkApplication.rd.Host;mb.UiHost=h.AFrameworkApplication.rd.UiHost;mb.SessionOrigin=h.AFrameworkApplication.rd.SessionOrigin;mb.ApplicationMode=h.AFrameworkApplication.rd.ApplicationMode;mb.Browser=h.AFrameworkApplication.rd.Browser;
mb.Os=h.AFrameworkApplication.rd.Os;return mb}ten(){const mb={};mb[He.a.gfd]=Kb.a.instance.vh(He.a.gfd);mb.DocPageNavigationStart=Kb.a.instance.vh("DocPageNavigationStart");mb[He.a.gHc]=Kb.a.instance.vh(He.a.gHc);mb[Qf.a.ceh]=Kb.a.instance.vh(Qf.a.ceh);mb[Qf.a.beh]=Kb.a.instance.vh(Qf.a.beh);mb[Qf.a.O0k]=Kb.a.instance.vh(Qf.a.O0k);mb[Qf.a.O5i]=Kb.a.instance.vh(Qf.a.O5i);mb[Qf.a.TJh]=Kb.a.instance.vh(Qf.a.TJh);mb[Qf.a.SJh]=Kb.a.instance.vh(Qf.a.SJh);mb[Qf.a.BHh]=Kb.a.instance.vh(Qf.a.BHh);mb[He.a.wQe]=
0<ge.a.instance.QXh();return mb}lfn(){const mb={};mb[Wa.a.MHh]=Kb.a.instance.vh(Wa.a.MHh);mb[Wa.a.OHh]=Kb.a.instance.vh(Wa.a.OHh);mb[Wa.a.kYe]=Kb.a.instance.vh(Wa.a.kYe);mb[Wa.a.zNh]=Kb.a.instance.vh(Wa.a.zNh);mb[Wa.a.p_h]=Kb.a.instance.vh(Wa.a.p_h);mb[Wa.a.CYe]=Kb.a.instance.vh(Wa.a.CYe);mb[Wa.a.BNh]=Kb.a.instance.vh(Wa.a.BNh);mb[Wa.a.HPh]=Kb.a.instance.vh(Wa.a.HPh);mb[Wa.a.AKh]=Kb.a.instance.vh(Wa.a.AKh);mb[Wa.a.BKh]=Kb.a.instance.vh(Wa.a.BKh);mb[Wa.a.Ulh]=Kb.a.instance.vh(Wa.a.Ulh);mb[Wa.a.HLf]=
Kb.a.instance.vh(Wa.a.HLf);mb[Wa.a.GLf]=Kb.a.instance.vh(Wa.a.GLf);return mb}oln(){const mb=Kb.a.instance.vh("DocPageNavigationStart");if(!Kb.a.instance.vh(He.a.gfd))return mb;const lc=Kb.a.instance.vh(He.a.gfd);return 6E4>mb-lc?lc:mb}D7k(mb,lc){const Mc=[];Array.add(Mc,Object.assign(new bf.a,{name:"EventName",string:mb}));ab.a.sendActivityEvent(Object.assign(new ze.a,{name:"CommentsBootEvents",durationMs:lc.getTime()-this.oln(),dataFields:Mc}))}}Object(c.a)(Oe,"CommentTelemetryManager",null,[575]);
var tg=a(1419),Cf=a(1420),oe=a(1421);class Rf extends tg.a{constructor(mb,lc){super();this.XEn=mb;this.qk=lc;this.Sdk=[new Cf.a(ve.a.TLi,null),new Cf.a(ve.a.ULi,null),new Cf.a(ve.a.VLi,null),new Cf.a(ve.a.YLi,null),new Cf.a(ve.a.bMi,null),new Cf.a(ve.a.cMi,null),new Cf.a(ve.a.aMi,null),new Cf.a(ve.a.WLi,null),new Cf.a(ve.a.XLi,null),new Cf.a(ve.a.ZLi,null),new Cf.a(ve.a.$Li,null)]}get isInHighContrastMode(){return!!this.qk&&this.qk.isInHighContrastMode}get tmd(){return this.XEn}get oFj(){return this.Sdk}L2c(mb,
lc){var Mc=this.zIa.Vob;if(Mc&&0===Mc.type&&(Mc=this.zIa.Vob.ngb,Mc=Object(e.a)(Array,Mc)?Mc:null)){var md=null,ud=null,Qd=new ba.a;for(const kb of Mc)kb.S2g.isValid&&Array.contains(kb.S2g.paragraphs,mb)&&(0===kb.state?md=kb.commentId:1===kb.state&&(ud=kb.commentId),Qd.fa(kb.commentId,kb.S2g));this.hXm(lc.querySelectorAll("*"),Qd,mb,md,ud)}}Fdg(mb,lc){mb=Object(e.a)(Array,mb)?Array.isArray(mb)?mb:null:null;if(!mb||0<mb.length&&!Object(X.a)(gb,mb[0]))return lc;for(const Mc of mb)if(Mc.S2g.isValid)for(const md of Mc.S2g.paragraphs)md&&
(oe.b(md),lc.add(md));return lc}Gan(mb,lc){mb=mb.UVa;const Mc=lc?Rf.TDn:Rf.UDn;lc=fc.a.Wej(mb,lc?Rf.pFn:Rf.qFn);mb=fc.a.Wej(mb,Mc);return lc<mb}hXm(mb,lc,Mc,md,ud){const Qd=new I.a,kb=new I.a;for(let Rc=0;Rc<mb.length;Rc++){const Zc=mb[Rc];this.cYh(Zc);if(!Zc.parentNode)continue;var Xb=Sd.a.ye(Zc,ve.a.QIf),sc=Sd.a.ye(Zc,ve.a.MIf);const Id=[!1,!1,!1];if(Xb)for(const Td of Xb)if(lc.Sb(Td)){Xb=lc.ka(Td).F2l(Mc);if(lc.ka(Td).G6l||(2===Xb||0===Xb)&&!this.isInHighContrastMode&&this.Gan(lc.ka(Td),Td===ud))lc.ka(Td).G6l=
!0,Qd.add(Td);kb.add(Td);this.YXl(lc,Mc,Td,md,ud,Id,!0)}if(sc)for(const Td of sc)kb.contains(Td)&&(kb.remove(Td),Qd.remove(Td),this.YXl(lc,Mc,Td,md,ud,Id,!1));if(0!==oe.a(Zc)){sc=(Xb=0<Qd.count)&&!!ud&&Qd.contains(ud);const Td=!!md&&kb.contains(md),he=!!ud&&kb.contains(ud);0<kb.count&&!this.isInHighContrastMode&&0<=Zc.parentNode.className.indexOf(ve.a.Cxa)&&(ic.a.a3(Zc.parentNode,ve.a.TLi),he?ic.a.a3(Zc.parentNode,sc?ve.a.XLi:ve.a.WLi):Td?(ic.a.a3(Zc.parentNode,ve.a.ULi),Xb=Zc.parentNode.className.match(new RegExp("\\b"+
ve.a.gNh+"\\b")),(!Xb||1>Xb.length)&&ic.a.a3(Zc.parentNode,ve.a.VLi)):ic.a.a3(Zc.parentNode,Xb?ve.a.cMi:ve.a.bMi));Id[1]?ic.a.a3(Zc,sc?ve.a.$Li:ve.a.ZLi):Id[0]?ic.a.a3(Zc,ve.a.YLi):Id[2]&&ic.a.a3(Zc,ve.a.aMi)}}}YXl(mb,lc,Mc,md,ud,Qd,kb){mb=mb.ka(Mc).F2l(lc);if(2===mb||(kb?0===mb:1===mb))md&&md.equals(Mc)&&(Qd[0]=!0),ud&&ud.equals(Mc)&&(Qd[1]=!0),Qd[2]=!0}}Rf.qFn="#F5E7F6";Rf.UDn="#503355";Rf.pFn="#F2E1F4";Rf.TDn="#4C3050";Object(c.a)(Rf,"CommentTextAnchorHighlightActor",tg.a,[]);class Uf{constructor(mb){let lc;
this.vPm=20;lc=mb?mb="SharedCommentBubble":mb="SharedCommentBubbleSelected";this.qPm=this.Vkd("SharedCommentBubble");this.pPm=this.Vkd("SharedCommentBubbleHover");this.XLl=this.Vkd(mb);this.uPm=this.Vkd("SharedCommentBubble");this.tPm=this.Vkd("SharedCommentBubbleHover");this.YLl=this.Vkd(lc);this.rPm="ModernCommentMarkerElementSingle cui-img-cont-float";this.sPm="ModernCommentMarkerElementWithReplies cui-img-cont-float"}get djm(){return this.rPm}get ejm(){return this.sPm}get Dqk(){return this.vPm}get tUg(){return this.qPm}get Cqk(){return this.pPm}get cjm(){return this.XLl}get gjm(){return this.uPm}get fjm(){return this.tPm}get hjm(){return this.YLl}ydl(mb){const lc=
mb?this.tUg:"SharedCommentBubbleSelected";mb=mb?this.tUg:lc;this.XLl=this.Vkd(lc);this.YLl=this.Vkd(mb)}Vkd(mb){return String.format("{0}_{1}x{2}x32",mb,this.Dqk,this.Dqk)}}Object(c.a)(Uf,"CommentViewHelper",null,[]);class gf{constructor(mb,lc,Mc,md,ud,Qd){this.ud=mb;this.ya=lc;this.Yb=Mc;this.Tgm=md;this.Ad=Qd;this.Tgm.rH(Object(Ta.a)(this,this.R1e,"onSlideOrderChanged"));this.ud.BPl(Object(Ta.a)(this,this.mlm,"onCommentsChanged"))}dispose(){this.ud.Stm(Object(Ta.a)(this,this.mlm,"onCommentsChanged"));
this.Tgm.MQ(Object(Ta.a)(this,this.R1e,"onSlideOrderChanged"))}mlm(){const mb=this.ya.Ia;u.a.Ljc(this.Yb,()=>{this.GYn(mb)})}R1e(mb,lc){if(2===lc.$0){const Mc=this.ya.Ia;u.a.Ljc(this.Yb,()=>{this.jqm(Mc)})}}jqm(mb){this.ya.Ia===mb&&mb&&this.Ad.Wtd(!0)}GYn(mb){this.jqm(mb)}}Object(c.a)(gf,"CommentsChangeListener",null,[40]);var gg=a(192),Ve=a(311),hf=a(66);class ef{constructor(mb,lc,Mc,md,ud){this.eUc=this.kpd=null;new Ve.a(0,0,0,0);this.jdm=null;this.nzm=this.ioe=!1;this.jka=md;this.Gb=lc;this.jka||
(this.kpd=document.createElement("div"),this.kpd.className="CommentPanel",this.kpd.style.position="absolute");this.pc=!1;this.rim=Mc;this.yp=ud}dispose(){}layout(mb){return mb}hostView(mb){this.eUc=mb}gao(mb){this.jdm=mb}DB(mb){this.pc=mb;this.jka?this.M9(this.pc):this.rim.M9(this,this.pc,ResourceStrings.L_Comments,hf.a.dB)}M9(mb){gg.a.Gz().then(lc=>{mb?(lc.showTaskPane(hf.a.dB,this.jdm),rb.a("UpdateCommentLoadMetrics")&&!this.ioe&&(this.yp.NL(this.yp.NNd,this.yp.kPd),this.yp.dZa(this.yp.NNd,this.yp.kPd),
this.ioe=!0)):lc.hideTaskPane(hf.a.dB,2);return null}).catch(lc=>{pa.a.$(508887565,833,10,"CommentsPane::ShowHidePane exception: {0}. isVisible: {1}",lc.toString(),mb.toString())})}bZh(){gg.a.Gz().then(mb=>{mb.setSelectedTaskPane(hf.a.dB);return null}).catch(mb=>{pa.a.$(508887564,833,10,"CommentsPane::SelectPane exception: {0}",mb.toString())})}O9n(){try{this.jka?this.bZh():this.rim.bZh(hf.a.dB)}catch(mb){pa.a.$(508887563,805,100," Task pane couldn't be selected as it is not present in tabbed task pane group",
mb)}}Nse(mb){this.Gb.Nse(mb?1:2)}get isVisible(){return this.pc}get va(){return this.kpd}get order(){return 18}}Object(c.a)(ef,"CommentsPane",null,[541,488,40,573]);class Ga{constructor(){this.mib=this.Yoc=0;this.Nd=this.Asd=this.UUb=null}}Object(c.a)(Ga,"FindCommentContext",null,[]);var hb;(function(mb){mb[mb.findNextComment=0]="findNextComment";mb[mb.findPreviousComment=1]="findPreviousComment";mb[mb.findNextActiveComment=2]="findNextActiveComment";mb[mb.findPreviousActiveComment=3]="findPreviousActiveComment"})(hb||
(hb={}));Object(c.b)("FindCommentRequestType",hb);class Hb{constructor(mb,lc,Mc,md,ud,Qd){this.rc=mb;this.ya=lc;this.Hck=Mc;this.kDa=md;this.zfm=ud;this.ui=new Ga;this.CEn=Qd}get GXa(){return this.CEn.value}dispose(){this.Hck.dispose();this.ui=this.Hck=null}R8i(mb,lc,Mc){this.x8i(0,!1,mb,lc,Mc)}$8i(mb,lc,Mc){this.x8i(1,!1,mb,lc,Mc)}S8i(mb,lc){this.x8i(0,!0,mb,lc,!1)}x8i(mb,lc,Mc,md,ud){var Qd=this.ya.presentation;if(!Qd)throw Error.argumentNull("Presentation is null");md||(md=Cc.a.Xk("FindComment",
0),md.Za("FindCommentRequestType",hb[mb]));md.Za(Hb.TDi,"true");if(this.zfm&&this.ya.Ia){if(!this.ya.Ia)throw Error.argumentNull("ActiveSlide is null");const kb=this.ya.Ia.Dh;Qd=Qd.slides||[];this.ui.UUb=Mc;this.ui.mib=Hb.ihn(mb,ud);this.ui.Nd=md;lc?this.y8i(Qd[kb>=Qd.length-1?0:kb+1]):1===mb?this.E0l(Qd,kb-1,ud):this.D0l(Qd,kb+1,ud)}else md.Za(Hb.YZm,this.zfm.toString()),Mc(null,null,!1,!1)}D0l(mb,lc,Mc){this.ui.Asd=null;this.ui.Yoc=lc;for(let md=lc;md<mb.length;md++)if(mb[md]&&this.Z$l(mb[md])){const ud=
this.mhn(mb[md],Mc);if(ud){this.ui.UUb(mb[md],ud,!1,!1);return}}else{this.y8i(mb[md]);return}0<lc?this.ybn(Mc):this.notFound()}E0l(mb,lc,Mc){this.ui.Asd=null;this.ui.Yoc=lc;for(let md=lc;-1<md;md--)if(mb[md]&&this.Z$l(mb[md])){const ud=this.lin(mb[md],Mc);if(ud){this.ui.UUb(mb[md],ud,!1,!1);return}}else{this.y8i(mb[md]);return}lc<mb.length-1?this.zbn(Mc):this.notFound()}y8i(mb){this.ui.Nd.Fm(Hb.h_m,new Date);mb&&this.Hck.find(mb.fc,this.ui.mib,Object(Ta.a)(this,this.ZTn,"onServerFindSucceeded"),Object(Ta.a)(this,
this.YTn,"onServerFindFailed"))}ZTn(mb){this.ui.Nd.zw(Hb.TDi,"false");this.ui.Nd.Fm(Hb.dTl,new Date);this.ui.Nd.Za(Hb.YSl,"true");mb?(this.ui.Asd=mb,-1===this.ZJc(this.ui.Asd.TargetSlideId)?this.notFound():this.ui.UUb(this.Xio(this.ui.Asd.TargetSlideId),this.ui.Asd.TargetComment,this.ui.Asd.IsFirstComment,this.ui.Asd.IsLastComment)):this.notFound()}YTn(){this.ui.Nd.zw(Hb.TDi,"false");this.ui.Nd.Fm(Hb.dTl,new Date);this.ui.Nd.Za(Hb.YSl,"false");pa.a.$(512496786,805,50,"OnServerFindFailed");this.notFound()}ybn(mb){var lc=
this.ya.presentation;if(!lc)throw Error.argumentNull("Presentation is null");lc=lc.slides||[];qc.a.wb(lc)?this.notFound():this.D0l(lc,0,mb)}zbn(mb){var lc=this.ya.presentation;if(!lc)throw Error.argumentNull("Presentation is null");lc=lc.slides||[];qc.a.wb(lc)?this.notFound():this.E0l(lc,lc.length-1,mb)}mhn(mb,lc){mb=this.rc.pl(mb.fc);if(this.GXa){const Mc=(mb=this.kDa.uYd(mb))?mb.length:0;for(let md=0;md<Mc;md++){const ud=mb[md];if(Hb.yam(ud,lc))return ud}return null}return this.kDa.sbn(mb,lc)}lin(mb,
lc){mb=this.rc.pl(mb.fc);if(this.GXa){var Mc=(mb=this.kDa.uYd(mb))?mb.length:0;for(--Mc;0<=Mc;Mc--){const md=mb[Mc];if(Hb.yam(md,lc))return md}return null}return this.kDa.vbn(mb,lc)}Z$l(mb){return mb.JD}ZJc(mb){var lc=this.ya.presentation;if(!lc)throw Error.argumentNull("Presentation is null");if(mb){lc=lc.slides||[];mb=new Of.a(mb);for(let Mc=0;Mc<lc.length;Mc++)if(lc[Mc]&&Of.a.HXa(lc[Mc].fc,mb))return Mc}return-1}Xio(mb){return mb?this.rc.agb(new Of.a(mb)):null}notFound(){this.ui.UUb&&this.ui.UUb(null,
null,!1,!1)}static ihn(mb,lc){if(lc)switch(mb){case 0:return 2;case 1:return 3}return mb}static yam(mb,lc){return!lc||0===mb.status}}Hb.TDi="IsCompletedSearchInClient";Hb.h_m="ServerSearchStartTime";Hb.dTl="ServerSearchEndTime";Hb.YSl="IsServerSearchSucceeded";Hb.YZm="IsBRSOn";Object(c.a)(Hb,"FindCommentLogic",null,[539,40]);var mc=a(99);class Nc{constructor(){this.type=0;this.UUb=this.Nd=null;this.Foi=!1}}Object(c.a)(Nc,"Entry",null,[]);class db{constructor(mb,lc){this.YQh=null;this.Bu=mb;this.Yb=
lc;this.k8b=[];this.xhk=0}dispose(){this.Bu.dispose();this.k8b=this.Bu=null;pa.a.$(507843594,805,50,"MaxQueuedEntryNum: {0}",this.xhk)}R8i(mb,lc,Mc){this.enqueue(1,mb,lc,Mc)}$8i(mb,lc,Mc){this.enqueue(0,mb,lc,Mc)}S8i(mb,lc){this.enqueue(2,mb,lc,!1)}enqueue(mb,lc,Mc,md){Mc.Za("AlreadyQueuedEntryCount",this.k8b.length.toString());mb=Object.assign(new Nc,{type:mb,UUb:(ud,Qd,kb,Xb)=>{lc(ud,Qd,kb,Xb);this.YQh=null;this.vpm()},Nd:Mc,Foi:md});Array.enqueue(this.k8b,mb);this.xhk=Math.max(this.xhk,this.k8b.length);
this.vpm()}vpm(){0<this.k8b.length&&!this.YQh&&(this.YQh=new mc.a(2,1,0,Object(Ta.a)(this,this.G1n,"processOneEntry"),90,"49"),this.Yb.Rb(this.YQh))}G1n(){const mb=Array.dequeue(this.k8b);1===mb.type?this.Bu.R8i(mb.UUb,mb.Nd,mb.Foi):0===mb.type?this.Bu.$8i(mb.UUb,mb.Nd,mb.Foi):this.Bu.S8i(mb.UUb,mb.Nd)}}Object(c.a)(db,"FindCommentLogicDecorator",null,[539,40]);var Wb=a(473),Jc=a(133);class jd extends Jc.a{constructor(mb,lc){super();this.StartSlideId=null;this.RequestType=0;this.FFindModernComments=
!1;if(null===mb)throw Error.argumentNull("slideId");this.RequestType=lc;this.StartSlideId=mb.toString();this.FFindModernComments=!0}lo(){return 88}}Object(c.a)(jd,"FindCommentRequest",Jc.a,[]);class xd extends Wb.a{constructor(mb){super();this.XIa=null;this.fhm=0;this.WJb=this.yJb=null;this.enabled=2;this.n0e=0;this.un=!1;this.Mq=mb;this.Mq.register(this)}dispose(){this.un||(1===this._state&&this.Mq.unregister(this),this.un=!0,this.n0e=0)}find(mb,lc,Mc,md){0<this.n0e&&null!==Mc&&(pa.a.$(507843207,
805,15,"FindCommentReplicator::Find() - NumPendingFindRequests={0}",this.n0e),Mc(null));this.XIa=mb;this.fhm=lc;this.GO(Mc,md,null)}LBa(){return 0<this.n0e&&!this.un}lN(){return!1}K5a(){return this.D$l||this.LBa()}Cec(){if(1===this._state)this.ve.eH=new jd(this.XIa,this.fhm),this.ve.status=1,this._state=3;else if(3===this._state&&this.D$l)if(pa.a.$(507843206,805,50,"FindCommentRequest EnqeueTime={0}, InvokedTime={1}, CompletedTime={2}",this.ve.Zrd,this.ve.Oo,this.ve.Gp),2===this.ve.statusCode&&this.ve.$u&&
1===this.ve.$u.length){const mb=this.ve.$u[0];0!==mb.StatusCode?this.YO(mb):this.o9(mb)}else this.YO()}GO(mb,lc){this.n0e++;this.WJb=mb;this.yJb=lc;this.Mq.nea()}forceOutbound(){}YO(mb=null){pa.a.$(507843204,805,50,"FindCommentReplicator Inbound failed: HttpStatusCode={0}, OperationStatusCode={1}, FindCommentResponseStatusCode={2}",this.ve.httpStatusCode,this.ve.statusCode,mb?mb.StatusCode:-1);this.Ylm(mb,!1)}o9(mb){this.Ylm(mb,!0)}get D$l(){return!!this.ve&&2===this.ve.status}Ylm(mb,lc){this.n0e--;
this._state=1;if(lc){lc=null;try{lc=Sys.Serialization.JavaScriptSerializer.deserialize(mb.FindCommentResult)}catch(Mc){pa.a.$(507843203,805,10,"Cannot parse find comment result: {0}",Mc)}this.WJb(lc)}else this.yJb(null,-1)}}Object(c.a)(xd,"FindCommentReplicator",Wb.a,[40]);class Ad{constructor(){this.PH=null;this.sCh=this.aNl=this.BIl=this.jtf=this.FOl=this.qMl=this.rNl=!1}vln(){this.PH||(b.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),
this.Lym());return this.PH}Sin(){return new Promise((mb,lc)=>{this.sCh?mb(this.q3l()):this.Nxm().then(()=>{mb(this.q3l())}).catch(Mc=>{lc(Mc)})})}q3l(){this.sCh||b.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let mb;mb=33;this.BIl&&(mb|=2);this.rNl&&(mb|=8);this.FOl&&(mb|=16);this.qMl&&(mb|=4);this.jtf&&(mb|=64);this.aNl&&(mb|=128);return mb}}Object(c.a)(Ad,"OfficeSharedCommentsAppCapabilities",
null,[1848]);class de extends Ad{constructor(mb,lc,Mc,md,ud,Qd){super();this.Jb=mb;this.Ea=lc;this.Mgm=Mc;this.Ime=Qd;this.Sbo(md,ud);this.Lym();this.Nxm()}Sbo(mb,lc){rb.a("CheckTaskHostIsEnabledForOneDriveConsumer")&&this.rdo(mb)?this.jtf=!0:this.jtf=this.Jb.getBooleanAppSetting("TasksForCommentsEnabled")&&!mb;this.FOl=!1;this.rNl=lc;this.aNl=this.qMl=!0}rdo(mb){return this.Jb.getBooleanAppSetting("TasksForCommentsEnabled")&&!mb&&this.Jb.getBooleanAppSetting("TasksHostIsEnabled")}Lym(){this.PH={};
const mb=this.jtf&&this.Ea.ham;this.PH.CommentsFluentUI="true";this.PH.CommentTasks=this.jtf.toString();this.PH.DisabledChangeGates=this.Jb.Ma("DisabledChangeGatesInSharedComments");this.PH.DiscreteHostedComments="true";this.PH.CommentReactions=ec(this.Jb).toString();this.PH.NewCommentButton="true";this.PH.PersonaColor="true";this.PH.LivePersonaPicker="true";this.PH.AtMentionFloodgateSurvey=h.AFrameworkApplication.ha.getBooleanAppSetting("AtMentionUserFloodGateCampaignIsEnabled").toString();this.PH.CommentTasksFromReply=
mb.toString();this.PH.LogDraftCommentIdPair=this.Ime.toString();this.PH.HyperlinksInComments="true";this.PH.SmartReplies=this.Jb.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1).toString();this.PH.TaskPaneWithNewInfrastructure=this.Ea.RIf.toString();this.PH.NewSelectionInteractions="true";this.PH.ExtendedDrafting="true";this.PH.LinkToComment="true";this.PH.WebThemeIntegration="true";this.PH.TaskHistoryRecordIDs=this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1).toString();this.PH.ConsumerEmailLPPEnabled=this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerEmailLPPEnabled",!1).toString()}Nxm(){return new Promise((mb,lc)=>{this.Mgm?this.Mgm.atMentionsEnabledAsync().then(Mc=>{this.BIl=Mc;this.sCh=!0;mb(this.sCh)}):(b.ULS.sendTraceTag(509645712,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),lc(u.a.xH(-2130915320)))})}}Object(c.a)(de,"PPTSharedCommentAppCapabilities",
Ad,[]);class De{constructor(mb){this.Np=mb}display(mb,lc){this.Np.uyl(mb?0:2,lc);this.Np.setVisibility()}dismiss(){this.Np.K0m();this.Np.setVisibility()}activate(){this.Np.uyl(1);this.Np.setVisibility()}B8m(mb){this.Np.uyl(mb?0:2)}Yq(mb){this.Np.Yq(mb)}NT(mb){this.Np.NT(mb)}zu(){return this.Np.zu()}k1(mb){return this.Np.d1b(mb)}vE(mb){this.Np.vE(mb)}dispose(){this.Np.dispose()}tH(){this.Np.tH()}pR(mb){return this.Np.pR(mb)}DM(mb){return this.Np.DM(mb)}draw(mb,lc){this.Np.draw(mb,lc)}get visible(){return this.Np.visible}set visible(mb){this.Np.visible=
mb}setPosition(mb,lc){this.Np.setPosition(mb,lc)}qj(mb){this.Np.qj(mb)}Ov(mb){this.Np.Ov(mb)}SA(mb){this.Np.SA(mb)}setZIndex(mb){this.Np.setZIndex(mb)}ER(mb,lc){this.Np.ER(mb,lc)}setSelection(){}}Object(c.a)(De,"ShapeCommentsAnchoredSelectionView",null,[567,558,267,40]);class Le{constructor(mb,lc){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=mb;this.canvasContextId=
lc}}Object(c.a)(Le,"CommentUIAction",null,[]);var Xe=a(85),ie=a(1026),If=a(187),qf=a(237),lf=a(215),qe=a(1064),Ne=a(616);class pe{constructor(){this.draftId=null;this.insertIndex=0;this.anchorHintText=null}}Object(c.a)(pe,"CurrentContextDraft",null,[]);class Wf{constructor(){this.contentId=null;this.anchorTop=this.containerContentType=0;this.anchorBottom=this.anchorRight=this.anchorLeft=null}}Object(c.a)(Wf,"IContentAnchorPosition",null,[]);class ye{constructor(){this.y=this.x=this.height=this.width=
0}}Object(c.a)(ye,"IViewportInfo",null,[]);class Xf{constructor(){this.allContainersVisibleCallback=this.positionsUpdatedScrollHeightCallback=this.positionsUpdatedCallback=this.paneOpenedCallback=this.paneClosedCallback=null}}Object(c.a)(Xf,"FloatingContainerManagerCreationParams",null,[]);var uh=a(147),fg=a(63),pg=a(1194),Kf=a(485),hh=a(468),zh=a(1213),cg;(function(mb){mb[mb.line=0]="line";mb[mb.lineInv=1]="lineInv";mb[mb.triangle=2]="triangle";mb[mb.rtTriangle=3]="rtTriangle";mb[mb.rect=4]="rect";
mb[mb.diamond=5]="diamond";mb[mb.parallelogram=6]="parallelogram";mb[mb.trapezoid=7]="trapezoid";mb[mb.nonIsoscelesTrapezoid=8]="nonIsoscelesTrapezoid";mb[mb.pentagon=9]="pentagon";mb[mb.hexagon=10]="hexagon";mb[mb.heptagon=11]="heptagon";mb[mb.octagon=12]="octagon";mb[mb.decagon=13]="decagon";mb[mb.dodecagon=14]="dodecagon";mb[mb.star4=15]="star4";mb[mb.star5=16]="star5";mb[mb.star6=17]="star6";mb[mb.star7=18]="star7";mb[mb.star8=19]="star8";mb[mb.star10=20]="star10";mb[mb.star12=21]="star12";mb[mb.star16=
22]="star16";mb[mb.star24=23]="star24";mb[mb.star32=24]="star32";mb[mb.roundRect=25]="roundRect";mb[mb.round1Rect=26]="round1Rect";mb[mb.round2SameRect=27]="round2SameRect";mb[mb.round2DiagRect=28]="round2DiagRect";mb[mb.snipRoundRect=29]="snipRoundRect";mb[mb.snip1Rect=30]="snip1Rect";mb[mb.snip2SameRect=31]="snip2SameRect";mb[mb.snip2DiagRect=32]="snip2DiagRect";mb[mb.plaque=33]="plaque";mb[mb.ellipse=34]="ellipse";mb[mb.teardrop=35]="teardrop";mb[mb.homePlate=36]="homePlate";mb[mb.chevron=37]=
"chevron";mb[mb.pieWedge=38]="pieWedge";mb[mb.pie=39]="pie";mb[mb.blockArc=40]="blockArc";mb[mb.donut=41]="donut";mb[mb.noSmoking=42]="noSmoking";mb[mb.rightArrow=43]="rightArrow";mb[mb.leftArrow=44]="leftArrow";mb[mb.upArrow=45]="upArrow";mb[mb.downArrow=46]="downArrow";mb[mb.stripedRightArrow=47]="stripedRightArrow";mb[mb.notchedRightArrow=48]="notchedRightArrow";mb[mb.bentUpArrow=49]="bentUpArrow";mb[mb.leftRightArrow=50]="leftRightArrow";mb[mb.upDownArrow=51]="upDownArrow";mb[mb.leftUpArrow=52]=
"leftUpArrow";mb[mb.leftRightUpArrow=53]="leftRightUpArrow";mb[mb.quadArrow=54]="quadArrow";mb[mb.leftArrowCallout=55]="leftArrowCallout";mb[mb.rightArrowCallout=56]="rightArrowCallout";mb[mb.upArrowCallout=57]="upArrowCallout";mb[mb.downArrowCallout=58]="downArrowCallout";mb[mb.leftRightArrowCallout=59]="leftRightArrowCallout";mb[mb.upDownArrowCallout=60]="upDownArrowCallout";mb[mb.quadArrowCallout=61]="quadArrowCallout";mb[mb.bentArrow=62]="bentArrow";mb[mb.uturnArrow=63]="uturnArrow";mb[mb.circularArrow=
64]="circularArrow";mb[mb.leftCircularArrow=65]="leftCircularArrow";mb[mb.leftRightCircularArrow=66]="leftRightCircularArrow";mb[mb.curvedRightArrow=67]="curvedRightArrow";mb[mb.curvedLeftArrow=68]="curvedLeftArrow";mb[mb.curvedUpArrow=69]="curvedUpArrow";mb[mb.curvedDownArrow=70]="curvedDownArrow";mb[mb.swooshArrow=71]="swooshArrow";mb[mb.cube=72]="cube";mb[mb.can=73]="can";mb[mb.lightningBolt=74]="lightningBolt";mb[mb.heart=75]="heart";mb[mb.sun=76]="sun";mb[mb.moon=77]="moon";mb[mb.smileyFace=
78]="smileyFace";mb[mb.irregularSeal1=79]="irregularSeal1";mb[mb.irregularSeal2=80]="irregularSeal2";mb[mb.foldedCorner=81]="foldedCorner";mb[mb.bevel=82]="bevel";mb[mb.frame=83]="frame";mb[mb.halfFrame=84]="halfFrame";mb[mb.corner=85]="corner";mb[mb.diagStripe=86]="diagStripe";mb[mb.chord=87]="chord";mb[mb.arc=88]="arc";mb[mb.leftBracket=89]="leftBracket";mb[mb.rightBracket=90]="rightBracket";mb[mb.leftBrace=91]="leftBrace";mb[mb.rightBrace=92]="rightBrace";mb[mb.bracketPair=93]="bracketPair";mb[mb.bracePair=
94]="bracePair";mb[mb.straightConnector1=95]="straightConnector1";mb[mb.bentConnector2=96]="bentConnector2";mb[mb.bentConnector3=97]="bentConnector3";mb[mb.bentConnector4=98]="bentConnector4";mb[mb.bentConnector5=99]="bentConnector5";mb[mb.curvedConnector2=100]="curvedConnector2";mb[mb.curvedConnector3=101]="curvedConnector3";mb[mb.curvedConnector4=102]="curvedConnector4";mb[mb.curvedConnector5=103]="curvedConnector5";mb[mb.callout1=104]="callout1";mb[mb.callout2=105]="callout2";mb[mb.callout3=106]=
"callout3";mb[mb.accentCallout1=107]="accentCallout1";mb[mb.accentCallout2=108]="accentCallout2";mb[mb.accentCallout3=109]="accentCallout3";mb[mb.borderCallout1=110]="borderCallout1";mb[mb.borderCallout2=111]="borderCallout2";mb[mb.borderCallout3=112]="borderCallout3";mb[mb.accentBorderCallout1=113]="accentBorderCallout1";mb[mb.accentBorderCallout2=114]="accentBorderCallout2";mb[mb.accentBorderCallout3=115]="accentBorderCallout3";mb[mb.wedgeRectCallout=116]="wedgeRectCallout";mb[mb.wedgeRoundRectCallout=
117]="wedgeRoundRectCallout";mb[mb.wedgeEllipseCallout=118]="wedgeEllipseCallout";mb[mb.cloudCallout=119]="cloudCallout";mb[mb.cloud=120]="cloud";mb[mb.ribbon=121]="ribbon";mb[mb.ribbon2=122]="ribbon2";mb[mb.ellipseRibbon=123]="ellipseRibbon";mb[mb.ellipseRibbon2=124]="ellipseRibbon2";mb[mb.leftRightRibbon=125]="leftRightRibbon";mb[mb.verticalScroll=126]="verticalScroll";mb[mb.horizontalScroll=127]="horizontalScroll";mb[mb.wave=128]="wave";mb[mb.doubleWave=129]="doubleWave";mb[mb.plus=130]="plus";
mb[mb.flowChartProcess=131]="flowChartProcess";mb[mb.flowChartDecision=132]="flowChartDecision";mb[mb.flowChartInputOutput=133]="flowChartInputOutput";mb[mb.flowChartPredefinedProcess=134]="flowChartPredefinedProcess";mb[mb.flowChartInternalStorage=135]="flowChartInternalStorage";mb[mb.flowChartDocument=136]="flowChartDocument";mb[mb.flowChartMultidocument=137]="flowChartMultidocument";mb[mb.flowChartTerminator=138]="flowChartTerminator";mb[mb.flowChartPreparation=139]="flowChartPreparation";mb[mb.flowChartManualInput=
140]="flowChartManualInput";mb[mb.flowChartManualOperation=141]="flowChartManualOperation";mb[mb.flowChartConnector=142]="flowChartConnector";mb[mb.flowChartPunchedCard=143]="flowChartPunchedCard";mb[mb.flowChartPunchedTape=144]="flowChartPunchedTape";mb[mb.flowChartSummingJunction=145]="flowChartSummingJunction";mb[mb.flowChartOr=146]="flowChartOr";mb[mb.flowChartCollate=147]="flowChartCollate";mb[mb.flowChartSort=148]="flowChartSort";mb[mb.flowChartExtract=149]="flowChartExtract";mb[mb.flowChartMerge=
150]="flowChartMerge";mb[mb.flowChartOfflineStorage=151]="flowChartOfflineStorage";mb[mb.flowChartOnlineStorage=152]="flowChartOnlineStorage";mb[mb.flowChartMagneticTape=153]="flowChartMagneticTape";mb[mb.flowChartMagneticDisk=154]="flowChartMagneticDisk";mb[mb.flowChartMagneticDrum=155]="flowChartMagneticDrum";mb[mb.flowChartDisplay=156]="flowChartDisplay";mb[mb.flowChartDelay=157]="flowChartDelay";mb[mb.flowChartAlternateProcess=158]="flowChartAlternateProcess";mb[mb.flowChartOffpageConnector=159]=
"flowChartOffpageConnector";mb[mb.actionButtonBlank=160]="actionButtonBlank";mb[mb.actionButtonHome=161]="actionButtonHome";mb[mb.actionButtonHelp=162]="actionButtonHelp";mb[mb.actionButtonInformation=163]="actionButtonInformation";mb[mb.actionButtonForwardNext=164]="actionButtonForwardNext";mb[mb.actionButtonBackPrevious=165]="actionButtonBackPrevious";mb[mb.actionButtonEnd=166]="actionButtonEnd";mb[mb.actionButtonBeginning=167]="actionButtonBeginning";mb[mb.actionButtonReturn=168]="actionButtonReturn";
mb[mb.actionButtonDocument=169]="actionButtonDocument";mb[mb.actionButtonSound=170]="actionButtonSound";mb[mb.actionButtonMovie=171]="actionButtonMovie";mb[mb.gear6=172]="gear6";mb[mb.gear9=173]="gear9";mb[mb.funnel=174]="funnel";mb[mb.mathPlus=175]="mathPlus";mb[mb.mathMinus=176]="mathMinus";mb[mb.mathMultiply=177]="mathMultiply";mb[mb.mathDivide=178]="mathDivide";mb[mb.mathEqual=179]="mathEqual";mb[mb.mathNotEqual=180]="mathNotEqual";mb[mb.cornerTabs=181]="cornerTabs";mb[mb.squareTabs=182]="squareTabs";
mb[mb.plaqueTabs=183]="plaqueTabs";mb[mb.chartX=184]="chartX";mb[mb.chartStar=185]="chartStar";mb[mb.chartPlus=186]="chartPlus"})(cg||(cg={}));Object(c.b)("ST_ShapeType",cg);var le=a(177);class ke{constructor(){this.RowId=this.ColId=null}}Object(c.a)(ke,"TableCellInfo",null,[]);var ag=a(1212),Ef=a(68),lg=a(203),Hf=a(149),Lg=a(218),Vg=a(1224),uf=a(831),dg=a(832),Fg=a(410),Gh=a(164);class Vh{constructor(mb,lc){this.Kmc=this.o_e=null;this.Ifm=!1;this.gmk=mb;this.Hj=lc}get Vyn(){return this.Ifm}s4e(mb,
lc){lc&&mb.removeNotification(lc);return lc}M5n(mb){this.o_e=this.s4e(mb,this.o_e);this.s4e(mb,this.Kmc);this.Kmc=this.o_e=null}dfo(mb,lc,Mc){mb?this.gmk.UB.isVisible&&1===mb.oxa.length&&lc.Ia&&Of.a.FZa(mb.qWd.fc,lc.Ia.fc)||gg.a.LO().then(md=>{this.Kmc=this.s4e(md,this.Kmc);this.Kmc=null;var ud=Object.assign(new Vg.a,{label:mb.Xhb,onExecute:()=>{mb.primaryButtonAction(this.gmk,lc);lc.Ia.Dh!==mb.qWd.Dh&&Mc.Z$(mb.qWd.Dh);this.s4e(md,this.Kmc);this.Kmc=null}}),Qd=Object.assign(new Vg.a,{label:mb.xoc,
onExecute:()=>{this.Ifm=!0;this.s4e(md,this.Kmc);this.Kmc=null}});Qd=Object.assign(new uf.a,{target:".EditingRibbonPanel",title:mb.title,content:mb.content,primaryButtonProps:ud,secondaryButtonProps:Qd,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new dg.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,onDismiss:()=>{this.Hj.ns(hf.a.fEb)},preventDismissOnScroll:!0,preventDismissOnResize:!0})});ud=Object.assign(new Fg.a,{onShow:()=>{this.Hj.jZ(hf.a.fEb)}});Qd=md.callout(Qd);this.Kmc=
md.addNotification(Qd,ud)}):pa.a.$(546153881,805,50,"SharedCommentFrame::ShowReviewResolvedCommentsCallout - Trying to show review resolved comments callout when params are null.")}Czm(mb,lc){const Mc=new Gh.a;Mc.Ue=4;Mc.GC(ResourceStrings.l_DeleteAllCommentsConfirmationTitle,lc?ResourceStrings.l_DeleteAllResolvedCommentsConfirmation:ResourceStrings.l_DeleteAllCommentsConfirmation,1,md=>{1===md?(mb.EOf(lc),this.gmk.Q6i(lc)?this.Dzm():this.Bzm(lc?ResourceStrings.l_DeleteAllResolvedCommentsInPresentationCallout:
ResourceStrings.l_DeleteAllCommentsInPresentationCallout),pa.a.$(546153882,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - Yes button clicked for DeleteAllComments - fDeleteAllResolved: {0}",lc)):pa.a.$(546153883,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - No button clicked for DeleteAllComments - fDeleteAllResolved: {0}",lc)})}Dzm(){const mb=new Gh.a;mb.Ue=0;mb.GC(ResourceStrings.l_DeleteAllCommentsErrorTitle,ResourceStrings.l_DeleteAllCommentsError,1,null)}Bzm(mb){const lc=
()=>{this.Hj.jZ(hf.a.fEb)},Mc=()=>{this.Hj.ns(hf.a.fEb)};gg.a.LO().then(md=>{this.s4e(md,this.o_e);this.o_e=null;var ud=Object.assign(new uf.a,{target:".EditingRibbonPanel",title:ResourceStrings.l_DeleteAllCommentsCalloutTitle,content:mb,showCloseIcon:!0,useTeachingStyles:!1,calloutProps:Object.assign(new dg.a,{directionalHint:6,isBeakVisible:!1,onDismiss:Mc,preventDismissOnScroll:!0,preventDismissOnResize:!0})});const Qd=Object.assign(new Fg.a,{onShow:lc});ud=md.callout(ud);this.o_e=md.addNotification(ud,
Qd)})}}Object(c.a)(Vh,"CommentCalloutDialogManager",null,[]);var Qg=a(1117);class mh{constructor(mb){this.Bmc=mb;this.k8b=[];this.Tsg=new Qg.a(1E3,Object(Ta.a)(this,this.perform,"perform"))}FYn(mb){Array.contains(this.k8b,mb)||Array.add(this.k8b,mb);this.Tsg.perform()}perform(){const mb=this.k8b;this.k8b=[];for(let lc=0;lc<mb.length;lc++){const Mc=mb[lc];this.Bmc.Ere(Mc.commentId,new Vc.a(Mc.pos.X,Mc.pos.Y))}}}Object(c.a)(mh,"CommentKeyboardMoveController",null,[]);class Mf{constructor(mb,lc,Mc,md,
ud){this.NRc=this.Lmc=null;this.MJb=[];if(!mb)throw Error.argumentNull("parentElement");if(!lc)throw Error.argumentNull("frame");this.g0e=Mc;this.Po=mb;this.Ad=lc;this.lem=md;this.rem=ud}dispose(){this.RWk();this.Ad=this.Po=null}RWk(){this.NRc=this.Lmc=null;if(this.MJb&&0<this.MJb.length){for(const mb of this.MJb)mb&&mb.dispose();Array.clear(this.MJb)}}Fkd(mb){if(!this.V6i)return!0;if(!mb||!mb.length)return!1;mb=Lg.e(mb,lc=>0===lc.status);return!!mb&&0<mb.length}UXh(mb){this.RWk();if(mb&&this.Po){var lc=
this.Ad.isReadOnly?null:this.Ad.Zx;for(const Mc of mb)this.MJb.push(this.g0e.create(Mc,this.Po,this,lc,this.Ad.isReadOnly,Lc.KAa(Mc)||!this.rem));this.Fkd(mb)&&this.jAl()}}selectComment(mb,lc){if(!(!mb&&!this.Lmc||this.Lmc&&Lc.lWe(mb,this.Lmc.comment))&&(this.Lmc&&this.Lmc.select(!1),this.Lmc=null,mb))for(const Mc of this.MJb){if(Lc.lWe(Mc.comment,mb)){this.Lmc=Mc;Mc.select(!0);break}if(lc&&Mc.comment.Children)for(const md of Mc.comment.Children)if(Lc.lWe(md,mb)){this.Lmc=Mc;Mc.select(!0);return}}}iTe(mb,
lc){if(!(!mb&&!this.NRc||this.NRc&&Lc.lWe(mb,this.NRc.comment))&&(this.NRc&&this.NRc.activate(!1),this.NRc=null,mb))for(const Mc of this.MJb){if(Lc.lWe(Mc.comment,mb)){this.NRc=Mc;Mc.activate(!0);break}if(lc&&Mc.comment.Children)for(const md of Mc.comment.Children)if(Lc.lWe(md,mb)){this.NRc=Mc;Mc.activate(!0);return}}}Izm(mb){for(const lc of this.MJb)lc.Hzm(mb)}jAl(){for(const mb of this.MJb)mb.updatePosition(this.Ad.zCc(mb.comment.pos.X,mb.comment.pos.Y))}Ere(mb,lc){lc=this.Ad.TVl(lc._x,lc._y);mb.pos.X+=
lc._x;mb.pos.Y+=lc._y;lc=new Vc.a(mb.pos.X,mb.pos.Y);this.Ad.selectComment(mb,null,!0,!1,0,1,!1);this.Ad.manager.Ere(mb.commentId,lc)}kmo(mb){for(const lc of this.MJb)if(lc.comment===mb){lc.updatePosition(this.Ad.zCc(lc.comment.pos.X,lc.comment.pos.Y));break}}lmo(mb){for(const lc of mb)for(const Mc of this.MJb)Mc.comment.commentId===lc.commentId&&Mc.updatePosition(this.Ad.zCc(Mc.comment.pos.X,Mc.comment.pos.Y))}setVisibility(mb){this.rem=mb;for(const lc of this.MJb)lc.setVisibility(!Lc.KAa(lc.comment)&&
mb)}get frame(){return this.Ad}get isRightToLeft(){return this.lem}set isRightToLeft(mb){this.lem=mb}get parentElement(){return this.Po}set parentElement(mb){this.Po=mb}get n5e(){return this.Lmc}get V6i(){return!!h.AFrameworkApplication.ha&&h.AFrameworkApplication.ha.getBooleanAppSetting("SlideResizePerfImprovementEnabled")}}Object(c.a)(Mf,"CommentMarkerView",null,[]);class Gg{static ykc(mb,lc,Mc,md,ud,Qd,kb){const Xb=Kc.a.LK();Xb.alt=Qd;Xb.className=Fc.e(lc,ud);Xb.setAttribute(Rb.a.ii,Rb.a.fM);Xb.src=
mb.Eq(lc+".png");Xb.setAttribute("Unselectable","on");mb=Kc.a.yy();mb.className=Mc+" cui-img-cont-float";mb.setAttribute(Rb.a.ii,Rb.a.fM);mb.appendChild(Xb);Mc=Kc.a.yy();Mc.className=md;Mc.setAttribute("Unselectable","on");Mc.setAttribute(Rb.a.ii,Rb.a.fM);Mc.appendChild(mb);md=Kc.a.s3a();md.className=Gg.g9n+" cui-ctl";md.title=Qd;md.setAttribute(Rb.a.ii,Rb.a.fM);md.setAttribute(Rb.a.IA,Qd);md.appendChild(Mc);kb&&(Qd=Kc.a.yy(),Qd.className="cui-ctl-mediumlabel",Qd.setAttribute("Unselectable","on"),
Qd.setAttribute(Rb.a.ii,Rb.a.fM),Qd.innerText=kb,md.appendChild(Qd));return md}static TCc(mb,lc){return Gg.ykc(mb,mb.KMa,"cui-img-16by16","cui-ctl-iconContainer",lc,CommonUIStrings.l_DialogClose,null)}}Gg.e9n="CommentPaneLTR";Gg.f9n="CommentPaneRTL";Gg.g9n="CommentPaneWithBorderButton";Object(c.a)(Gg,"CommentPaneHelper",null,[]);class dh{constructor(){this.comment=this.slide=null;this.direction=0;this.I6k=null}}Object(c.a)(dh,"CommentSelectContext",null,[]);var Jh;(function(mb){mb[mb.previous=0]=
"previous";mb[mb.next=1]="next"})(Jh||(Jh={}));Object(c.b)("CommentSelectDirection",Jh);class Wg{constructor(mb,lc){if(!mb||1>mb.length)throw Error.argument("ISlideNode[] slides");if(!lc)throw Error.argumentNull("ICommentGraphManager graphManager");this.SGn=mb;this.PA=lc;this.slk=[];this.init()}get wFa(){return this.SGn}get oxa(){return this.slk}get qWd(){return this.oxa[this.oxa.length-1]}get Xhb(){return 1<this.oxa.length?ResourceStrings.L_CommentReviewResolvedCalloutGoToButton:ResourceStrings.L_CommentReviewResolvedCalloutReviewButton}get xoc(){return ResourceStrings.L_CommentReviewResolvedCalloutDontShowButton}get title(){return ResourceStrings.L_CommentReviewResolvedCalloutTitle}get content(){return this.Dfo()}init(){for(const mb of this.wFa)for(const lc of this.PA.ilc(mb.TX()))if(1===
lc.status){this.slk.push(mb);break}if(1>this.slk.length)throw Error.argument("ISlideNode[] slides contains no resolved comments.");}Dfo(){switch(this.oxa.length){case 1:return ResourceStrings.L_CommentReviewResolvedCalloutContentSlides1;case 2:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides2,this.oxa[1].Dh+1,this.oxa[0].Dh+1);case 3:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides3,this.oxa[2].Dh+1,this.oxa[1].Dh+1,this.oxa[0].Dh+1);
case 4:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides4,this.oxa[3].Dh+1,this.oxa[2].Dh+1,this.oxa[1].Dh+1);default:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlidesN,this.oxa[this.oxa.length-1].Dh+1,this.oxa[this.oxa.length-2].Dh+1,this.oxa[this.oxa.length-3].Dh+1,this.oxa.length-3)}}ohn(){for(const mb of this.PA.uYd(this.qWd))if(1===mb.status)return mb;return null}primaryButtonAction(mb,lc){if(!lc.presentation||!lc.presentation.slides)return pa.a.$(571269902,
805,10,"ResolvedCommentsCalloutParams::PrimaryButtonAction - Failed to show callout due to null {0}",lc.presentation?"Presentation.Slides":"Presentation"),null;const Mc=this.ohn();if(!Mc)return null;mb.UB.isVisible||mb.Bgc();if(lc.Ia&&Of.a.FZa(lc.Ia.fc,this.qWd.fc))mb.nLb(Mc.commentId,1,!0);else for(const md of lc.presentation.slides)if(Of.a.FZa(md.fc,this.qWd.fc))return Object.assign(new dh,{slide:this.qWd,comment:Mc,direction:1,I6k:Cc.a.Xk("SelectResolvedCommentCrossSlide",1)});return null}}Object(c.a)(Wg,
"ResolvedCommentsCalloutParams",null,[]);class Ra{constructor(){this.type="SharedCommentsTaskPaneProps";this.focusCallback=null}}Object(c.a)(Ra,"SharedCommentsTaskPaneProps",null,[]);var vc=a(490),Uc=a(184),id=a(249);class Jd{constructor(mb,lc,Mc,md,ud,Qd,kb,Xb,sc,Rc,Zc,Id,Td,he,be,Ue,cf,mf,ig,ug,Pf,mg,Lf,Nd,ih,Yg,Ah,Bh,Kh,Mg,jg,jh,Yf,jf,ci,bi,Rh,di,Dg,Oh,zf,bh,Ph,Lh,wi,Zg,Rg,ji,Xh,kh,mi,rg,Ji,Ki,Li,jj,aj,mj){this.Rlk=this.kF=null;this.lhe=!0;this.wt=this.eck=this.qvg=this.ack=this.kie=!1;this.$me=
0;this.kTh=this.G0e=!1;this.nmc=this.VSh=this.ru=this.Lnd=this.$oe=this.syb=this.qcm=null;this.rck=this.Mod=!1;this.uR=null;this.tmk=this.Zbk=!1;this.ghm=null;this.VSl=[hf.a.GM,hf.a.dB,hf.a.Xza,hf.a.TUl];this.tud=2147483647;this.opg=0;this.Xfm=-1;this.hdm=0;this.DEg=null;this.Tfk=this.CSh=this.ioe=this.gak=!1;this.tBb=(ri,xi)=>{this.Tfk=xi.Tlc};this.bAb=(ri,xi)=>{xi.slide===this.ya.Ia&&(ri=this.YYa.instance.RCj||this.YYa.instance.SCj,!xi.slide.isUnread||ri)&&(xi=this.PA.j3(),this.m4e(xi,h.AFrameworkApplication.isRtl,
!0))};if(!bi)throw Error.argumentNull("appSettingsManager");if(!mg)throw Error.argumentNull("commentEventHost");if(!lc)throw Error.argumentNull("commentTelemetryManager");if(!mj)throw Error.argumentNull("sorterViewActorLazy");this.jka=mi;this.la=Mc;this.Gb=md;this.UB=ud;this.Zx=Qd;this.kf=kb;this.Na=Xb;this.Hj=sc;this.mf=Rc;this.sa=Zc;this.Oc=Td;this.qF=he;this.VB=be;this.PA=mb;this.Pfa=lc;this.kFn=new mh(mb);this.gEa=Ue;this.ya=cf;this.NTh=mf.Xd(40);this.Ggm=rb.a("PreventCommentDraftDeletionOnPageContentChange")?
mf.Xd(7):mf.Xd(8);this.r0e=Id;this.Csa=Td.jd?Td.jd.LHh:null;this.HJb=ih;this.Yb=ug;this.n8a=mg;this.Fqe=Lf;this.qgm=Pf;this.hTh=Nd;this.hak=Yg;this.oRh=Ah;this.Nf=Mg;this.ySh=Bh;this.pr=Kh;this.AQh=jg;this.Pp=jh;this.g0e=Yf;this.X5=jf;this.LG=ci;this.Jb=bi;this.xp=di;this.$dm=Dg;this.Ugb=new d.a;this.le=Oh;this.pb=zf;this.Nmc=Ph;this.umc=bh;this.Fd=Lh;this.La=Rg;this.xGn=ji;this.HI=Xh;this.wod=kh;this.Ea=Ji;this.yp=Ki;this.lDa=Li;this.lvg=Zg;this.Ofm=!1;this.la.z9(this);this.bfe=new Vh(this,this.Hj);
this.YYa=jj;this.Wsa=aj;this.Cda=mj;if(!Rh)throw Error.argumentNull("InteractiveViewManagerFuture");this.qfm=Rh;this.iDn=this.r3m();this.jka&&this.UB.gao(this.xjn());this.Ea.isAnimationPreviewEnabled&&this.Fd.fid(this.tBb);this.dug=rb.a("DoNotZoomUxControls");this.Vb=rg;wi.OQd().then(ri=>{ri||this.H9k(!1)})}get WJh(){return this.$dm}get W_l(){return this.umc}get qVe(){return this.Jb.Ma("CurrentCommentId")}get VWi(){return this.Jb.Ma("CurrentSlideId")}get d0n(){return this.Jb.getBooleanAppSetting("PPTSafeLinksIsEnabledForModernComments")}get R1m(){return this.Jb.getBooleanAppSetting("CommentTextAnchoringReadWriteEnabled")}get gMi(){return this.Jb.getBooleanAppSetting("CommentTextAnchoringCreateNewEnabled")}get zZl(){return this.Jb.getBooleanAppSetting("EnableDeleteAllComments")}get XVe(){return rb.a("CompactingDHCsEnabled")}get M_l(){return rb.a("CanvasToCommentFocusFixV2")}get NYe(){return rb.a("AutoShowHideOfCommentsPaneEnabled")}initialize(){this.wt=
1===this.Gb.mode;this.jka||(this.HJb?Sys.UI.DomElement.addCssClass(this.r0e,Gg.f9n):Sys.UI.DomElement.addCssClass(this.r0e,Gg.e9n));const mb=this.Na.Uc(hf.a.dB);mb.US=!0;mb.PLb=!0;mb.Epa(Mc=>{const md=!rb.a("FixAltF12KeboardingInCommentPane")||!Mc||Mc.name!==hf.a.J1;this.VZg(!0,!Mc||Mc.name!==hf.a.GM&&md,!0)});mb.WLa((Mc,md)=>{Mc=(md.name===hf.a.aP||md.name===hf.a.lea)&&Mc.name===hf.a.dB;this.VZg(!1,!1,md.name===hf.a.dB||md.name===hf.a.sh||md.name===hf.a.GM||md.name===hf.a.Xza||md.name===hf.a.J1||
Mc)});const lc=this.Na.Uc(hf.a.GM);lc.Epa((Mc,md)=>{this.vTn(Mc,md)});lc.WLa(()=>{this.uTn()});this.jka||this.kf.aib(Db.a.click,this.r0e,Object(Ta.a)(this,this.E1e,"onCommentPaneParentDivClick"),null,mb.PLb);this.Kb();this.qF.wTe(Object(Ta.a)(this,this.Ghb,"onBeforeSlideSwitched"));this.qF.Hha(Object(Ta.a)(this,this.Oyl,"updateCommentsWhenNavigateSlide"));this.VB.Reb(Object(Ta.a)(this,this.VOl,"activeSlideDOMDisplayed"));this.pr.sQl(Object(Ta.a)(this,this.Hmm,"onPageViewZoomChanged"));this.xp.Tjc(Object(Ta.a)(this,
this.onShapeSelected,"onShapeSelected"));this.xp.hid(Object(Ta.a)(this,this.dxa,"onShapeDeselected"));this.qF.Ujc(Object(Ta.a)(this,this.qnm,"onShapeTextSelected"));this.qF.Uxf(Object(Ta.a)(this,this.wqd,"onSlideBackgroundClicked"));this.lvg&&(this.qF.mXa(Object(Ta.a)(this,this.qUn,"onSlideSizeUpdated")),this.qF.EQl(Object(Ta.a)(this,this.nnm,"onShapeRotatedOrBoundsUpdated")),this.qF.BQl(Object(Ta.a)(this,this.nnm,"onShapeRotatedOrBoundsUpdated")));this.NTh.Rm(Object(Ta.a)(this,this.Lnm,"onTextAnchorPropertyChanged"));
this.Ggm.rH(Object(Ta.a)(this,this.gD,"onChildTopologyChanged"));this.NTh.Seb(Object(Ta.a)(this,this.alm,"onBeforeTextAnchorDisconnect"));this.Nmc.Rm(Object(Ta.a)(this,this.uqd,"onShapePropertyChange"));this.Nmc.pQl(Object(Ta.a)(this,this.knm,"onShapeInvalidation"));this.Fd.DPl(Object(Ta.a)(this,this.Clm,"onF6FocusDocument"));this.Fd.bid(Object(Ta.a)(this,this.kKb,"onSetFocus"));this.Wsa.execute(Mc=>{Mc.zTe(this.bAb)});this.AQh.fKd(Object(Ta.a)(this,this.P1e,"onSessionExpired"));this.AQh.GF(Object(Ta.a)(this,
this.dJa,"onSessionEnded"));this.Oc.jd&&this.Oc.jd.LHh&&(this.Ghb(this,null),this.Oyl(this,null));this.Gb.zO(Object(Ta.a)(this,this.Rkm,"onAppModeSwitched"));this.Gb.lXa(Object(Ta.a)(this,this.s1,"onSetOffline"));this.VB.iid(Object(Ta.a)(this,this.RVh,"onShapeViewElementAddedOrRemoved"));this.VB.UFh(Object(Ta.a)(this,this.RVh,"onShapeViewElementAddedOrRemoved"));this.sa.AO(Object(Ta.a)(this,this.tE,"onSelectionChanged"))}RVh(mb,lc){this.kF&&(mb=lc.pJ)&&mb.shapeNode&&this.Cyn(mb.shapeNode.slideId)&&
this.kF.UXh(this.PA.j3())}Cyn(mb){return!!this.ya&&!!this.ya.Pw&&this.ya.Pw.equals(mb)}H9k(mb){this.umc=this.$dm=mb;this.LG.H9k(mb)}qUn(mb,lc){var Mc,md,ud;!this.kF||this.dug&&(null===(md=null===(Mc=null===lc||void 0===lc?void 0:lc.FB)||void 0===Mc?void 0:Mc.Ed)||void 0===md?void 0:md.id)!==(null===(ud=this.ya.Ia)||void 0===ud?void 0:ud.id)||this.kF.jAl()}nnm(mb,lc){if(this.kF){const Mc=lc.pJ.shapeNode;if(Mc){if((mb=this.PA.j3())&&mb.length){lc=[];for(const md of mb)md.anchorShape===Mc.get_shapeId()&&
lc.push(md);this.kF.lmo(lc)}}else pa.a.$(512496785,805,10,"SharedCommentFrame:OnShapeRotatedOrBoundsUpdated shape is null")}}S_l(){return this.ru&&this.ru.Npb&&this.ya.Ia?!Of.a.FZa(this.ru.Npb,this.ya.Ia.fc):!1}hWe(){return this.ru&&this.ya.Ia?!this.ru.Npb||Of.a.FZa(this.ru.Npb,this.ya.Ia.fc):!1}e7n(){if(this.uR&&this.uR.isIntegratedExtensionEnabled()){const mb=this.PA.j3();mb&&0<mb.length&&this.AYh();this.hWe()&&this.avm(this.ru)}}cTn(){this.Gb.Nse(1)}dTn(){this.ePf();this.Gb.Nse(1)}mTn(mb){this.opg!==
mb&&(this.opg=mb,this.Oc&&this.Oc.jd&&this.Oc.jd.a2h(2,!1,this.opg))}p8l(){const mb=Object.assign(new Xf,{paneClosedCallback:Object(Ta.a)(this,this.cTn,"onPaneClosedCallback"),paneOpenedCallback:Object(Ta.a)(this,this.dTn,"onPaneOpenedCallback"),positionsUpdatedScrollHeightCallback:Object(Ta.a)(this,this.mTn,"onPositionUpdatedScrollHeightCallback")});rb.a("UpdateCommentLoadMetrics")||(mb.allContainersVisibleCallback=Object(Ta.a)(this,this.fQn,"onAllContainersVisible"));this.uR=floatingContainerManager.FactoryGlobal.createFloatingContainerManagerInstance(mb)}lvn(){this.d0n&&
this.xGn.execute(mb=>{const lc=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();lc?lc.registerSafelinksNavigator(Object(Ta.a)(mb,mb.ovh,"tryNavigate")):pa.a.$(512496783,805,15,"SharedCommentFrame:InitializeRichContentEditAPI consumerAPI is null. Created successfully:{0}")})}gun(){this.p8l();this.Zbk=!0;const mb=this.A_f();sb.a.p4e(mb,[Db.a.contextMenu]);if(this.uR){this.uR.setDhcContainerPanel(mb,this.HJb);var lc=Object.assign(new ye,{width:parseFloat(mb.style.width),height:this.tud,
x:0,y:0});this.uR.updateViewport(lc);this.uR.setCompactContainers(this.XVe)}this.AYh();this.Pfa.KRn(this.ya.Pw);lc=this.Na.Uc(hf.a.Xza);lc.US=!0;lc.PLb=!0;lc.Epa(Mc=>{this.VZg(!0,!Mc||Mc.name!==hf.a.GM,!0)});lc.WLa((Mc,md)=>{Mc=(md.name===hf.a.aP||md.name===hf.a.lea)&&Mc.name===hf.a.Xza;this.VZg(!1,!1,md.name===hf.a.dB||md.name===hf.a.sh||md.name===hf.a.GM||md.name===hf.a.Xza||md.name===hf.a.J1||Mc)});this.Na.lYe(hf.a.Xza,hf.a.Wl,mb,!0);this.ktm();this.la.Ba(Lb.a.coa,ub.a.frame,Object(Ta.a)(this,
this.coa,"showHideComments"))}AYh(){const mb=this.PA.j3();this.$um(mb)}ktm(){if(this.uR){const mb=this.A_f();if(mb){const lc=this.Na.Uc(hf.a.Xza);this.kf.aib(Db.a.click,mb,Object(Ta.a)(this,this.E1e,"onCommentPaneParentDivClick"),null,lc.PLb)}}}ODm(){if(this.uR){const mb=this.A_f();mb&&this.kf.hc(Db.a.click,mb,Object(Ta.a)(this,this.E1e,"onCommentPaneParentDivClick"))}}A_f(){const mb=this.Oc&&this.Oc.jd?this.Oc.jd.NHh:null;return mb?mb.va:null}$um(mb){if(this.Oc.jd&&this.Zbk){if(!this.uR)try{this.p8l(),
pa.a.$(512496782,801,15,"SharedCommentFrame::RenderCommentContainers - m_containerManager is null. Created successfully:{0}",!!this.uR)}catch(md){pa.a.$(512496781,801,10,"SharedCommentFrame::RenderCommentContainers - Error creating m_containerManager: {0}",md);return}var lc=Date.now();if((mb=this.UXl(mb))&&mb.length){var Mc=this.A_f();Mc.setAttribute(Rb.a.ii,"group");if(Mc){this.Ugb=this.tfn(mb);pa.a.$(512496780,801,50,"SharedCommentFrame::RenderCommentContainers - Content anchor positions: {0}",
this.Ugb.count);if(!this.Ugb.count&&!this.F9d){pa.a.$(512496779,801,50,"SharedCommentFrame::RenderCommentContainers - Time taken:{0} ms",Date.now()-lc);return}this.uR.setDhcContainerPanel(Mc,this.HJb);this.uR.attachContainers(this.Ugb.toArray())}pa.a.$(512496778,801,50,"SharedCommentFrame::RenderCommentContainers Time taken:{0} ms",Date.now()-lc)}}}UXl(mb){if(!mb||!mb.length)return mb;const lc=new d.a;for(const Mc of mb)0!==Mc.status?this.TXl(Mc.commentId):lc.add(Mc);return lc.toArray()}Gmo(){this.gak=
!1;if(!this.LG.BAm&&!this.LG.LXa&&this.Oc.jd){var mb=this.PA.uYd(this.Oc.jd.Ed);for(const lc of mb)if(0===lc.status){this.selectComment(lc,null,!0,!0,0,0,!1);break}}}Fln(){if(!this.Oc||!this.Oc.jd||!this.Oc.jd.Ed)return this.tud;var mb=this.Oc.jd.Ed;if(isNaN(mb.xk))return this.tud;mb=mb.xk;return 0>mb?this.tud:mb}L1l(mb){var lc=this.LG.wqb(mb);mb=mb.pos.Y;lc&&(mb+=lc.PT.y,lc.Eg&&(lc=this.La.us(lc),mb+=lc&&lc.PT?lc.PT.y:0));return this.zCc(0,mb).y}Yyl(){if(this.uR){const mb=this.Fln();mb!==this.Xfm&&
(this.Xfm=mb,this.uR.setSlideHeight(mb))}}avm(mb){if(mb&&0===mb.wjd){var lc=0;if(this.XVe)lc=-this.tud,this.Yyl();else{const Mc=this.sa.Uo();Mc&&(lc=this.zCc(0,Mc.PT.y).y)}lc=Object.assign(new Wf,{contentId:mb.v7.draftId,containerContentType:0,anchorTop:lc,anchorLeft:0});this.uR.setDhcContainerPanel(this.A_f(),this.HJb);this.uR.updateDrafting(lc,!0);this.uR.selectContainer(mb.v7.draftId,!0)}}u7n(mb){if(this.Ugb){var lc=0,Mc="";if(this.XVe){var md=this.sa.Uo();md&&(lc=this.zCc(0,md.PT.y).y);if(md=
this.PA.j3())for(const ud of md)yc.a.wb(ud.commentId)||this.L1l(ud)!==lc||(Mc=ud.commentId)}lc=Object.assign(new Wf,{contentId:mb,containerContentType:0,anchorTop:lc,anchorLeft:0});this.XVe?this.uR.updateDraftingAndPosition(lc,!1,Mc):this.uR.updateDrafting(lc,!1);this.uR.selectContainer(mb,!0)}}TXl(mb){if(this.uR&&this.Ugb)for(const lc of this.Ugb)Jd.kjm(lc,mb)&&(this.uR.detachContainers([lc]),this.Ugb.remove(lc))}cao(){this.gak=!0}IJh(){this.UB&&this.UB.isVisible&&this.UB.O9n()}yan(){var mb=this.ya.presentation;
if(!mb)return!1;mb=mb.slides;if(!mb)return!1;for(const lc of mb)if(mb=Object(X.a)(Vd.a,lc))for(const Mc of this.PA.ilc(mb.TX()))if(Lc.KAa(Mc))return!0;return!1}erj(mb){var lc=this.ya.presentation;if(!lc)return null;lc=lc.slides;if(!lc)return null;for(const Mc of lc)if(lc=Object(X.a)(Vd.a,Mc),Of.a.FZa(lc.fc,mb))return lc;return null}uan(){return this.gMi||this.R1m&&this.yan()}Q4l(){const mb=this.sa.Wa.qb,lc=this.sa.Wa.K1;if(!mb||!lc)return null;var Mc=Object(X.a)(352,mb.Ya.node),md=Object(X.a)(352,
lc.Ya.node);if(!Mc||!md)return null;Mc=Object(X.a)(lg.TableCellNode,Mc.UX());md=Object(X.a)(lg.TableCellNode,md.UX());return Mc&&md?Mc.rowIndex>md.rowIndex?mb:lc:null}Bmn(){if(!this.uan()||!this.sa.H$())return null;pa.a.$(512496777,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Begin.");var mb=0,lc=0;if(this.sa.Wa.Fk){var Mc=this.Q4l();if(!Mc)return pa.a.$(512496776,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell selection is null."),null;var md=
Mc}else md=this.sa.Wa.qb;if(!md)return pa.a.$(512496775,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, current selection is null."),null;const ud=({CLb:mb,lIb:lc}=Lc.Amn(this.sa.D$(),md,mb,lc)).returnValue;if(!ud||0>mb||0>lc||0>=lc-mb)return pa.a.$(512496774,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, invalid text anchor ParagraphNode is null:{0}, EndPos:{1}, StartPos:{2}.",!ud,lc,mb),null;Mc=new ag.a;Mc.StartPos=mb;Mc.EndPos=lc;if(this.sa.l7a()&&
ud.get_smartArtModelId()){pa.a.$(512496773,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in SmartArt.");Mc.AnchoringShape=new zh.a;mb=H.a.Vf(ud.get_smartArtModelId()).toString();if(!mb||!H.a.isValid(mb))return pa.a.$(512496772,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Smart Art node ID string is null:{0} or invalid.",!mb),null;Mc.AnchoringShape.SmartArtNodeId=mb;this.Pfa.HCn()}else if(ud.du()){pa.a.$(512496771,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in table.");
lc=Object(X.a)(lg.TableCellNode,ud.UX());if(!lc)return pa.a.$(512496770,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell node is null."),null;mb=lc.rowId.toString();lc=lc.cellId.toString();if(!(mb&&lc&&H.a.isValid(mb)&&H.a.isValid(lc)))return pa.a.$(512496769,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Row/Col ID string is null:{0}/{1} or invalid.",!mb,!lc),null;Mc.AnchoringShape=new zh.a;Mc.AnchoringShape.TableCell=new ke;Mc.AnchoringShape.TableCell.RowId=
mb;Mc.AnchoringShape.TableCell.ColId=lc;this.Pfa.ICn()}mb=Object(X.a)(352,md.Ya.node);md=Object(X.a)(352,md.vf.node);mb!==md&&this.Pfa.KCn();pa.a.$(512496768,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Succeeded.");return Mc}F7m(mb){if(this.uR&&mb)for(const lc of this.Ugb.toArray()){let Mc=!1;for(const md of mb)if(Jd.kjm(lc,md.commentId)){Mc=!0;break}Mc||(this.uR.detachContainers([lc]),this.Ugb.remove(lc),pa.a.$(512496739,801,50,"SharedCommentFrame::DetachDeletedCommentContainers {0}",
lc.contentId))}}ePf(){if(this.uR){for(const mb of this.Ugb.toArray())this.uR.detachContainers([mb]);this.Ugb.clear()}}jml(mb){if(!mb)return null;mb.sort((lc,Mc)=>{var md=this.LG.wqb(lc);md=md?md.PT:new Vc.a(0,0);var ud=this.LG.wqb(Mc);ud=ud?ud.PT:new Vc.a(0,0);md.y+=lc.pos.Y;ud.y+=Mc.pos.Y;md.x+=lc.pos.X;ud.x+=Mc.pos.X;let Qd=md.y-ud.y;Qd||(Qd=md.x-ud.x)||(Qd=+lc.dt-+Mc.dt);return Qd});return mb}tfn(mb){const lc=new d.a;if(mb){this.XVe&&this.Yyl();for(const Mc of mb)yc.a.wb(Mc.commentId)||(mb=this.L1l(Mc),
mb=Object.assign(new Wf,{contentId:Mc.commentId,containerContentType:0,anchorTop:mb,anchorLeft:0}),lc.add(mb))}return lc}s1(mb){this.gmm(mb)}Etm(mb,lc){for(let Mc=0;Mc<mb.$a.length;Mc++){const md=mb.$a.ka(Mc);if(!md.Xg)continue;const ud=[];for(let Qd=0;Qd<md.Xg.length;Qd++){const kb=md.Xg.ka(Qd);kb.vH.equals(lc)&&ud.push(kb)}if(!(1>ud.length))try{mb.MVa=!0;for(const Qd of ud)md.Xg.remove(Qd)}catch(Qd){pa.a.$(512496738,805,10,"SharedCommentFrame::RemoveCommentRange - Exception{0} when trying to remove start/end comment GUIDs",
Qd.toString())}finally{mb.MVa=!1}}}aPl(mb,lc,Mc){mb.Xg||(mb.Xg=new Kf.a(mb));const md=mb.Xg.Xe.paragraph;lc=new pg.a(mb.Xg.Xe,null,lc,Mc);mb.Xg.add(lc);md.mv()}hIh(mb){return pc.a.Vf("{"+mb+"}{1}")}Uvf(mb,lc,Mc,md){let ud=null;for(let Qd=0;Qd<mb.$a.length;Qd++){let kb=mb.$a.ka(Qd);if(kb.cp>=Mc){try{mb.MVa=!0;if(kb.cp>Mc||!kb.formatting)this.HI.Cea(mb,Qd,Mc,ud),kb=mb.$a.ka(Qd);this.aPl(kb,lc,md)}catch(Xb){pa.a.$(512496737,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",
Xb.toString())}finally{mb.MVa=!1}return}kb.formatting&&(ud=kb.formatting)}if(Nb.ParagraphReader.textLength(mb)>=Mc)try{mb.MVa=!0;this.HI.Cea(mb,mb.$a.length,Mc,ud);const Qd=mb.$a.ka(mb.$a.length-1);this.aPl(Qd,lc,md)}catch(Qd){pa.a.$(512496736,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",Qd.toString())}finally{mb.MVa=!1}}GRf(){var mb=this.PA.j3();if(mb){var lc=Date.now(),Mc=!1,md=new ba.a;for(var ud of mb){var Qd=Lc.I6f(ud,this.LG.wqb(ud));
md.fa(ud.commentId,Qd)}for(var kb of mb)if(kb.textAnchoringInfo&&(ud=this.LG.wqb(kb))&&(Qd=md.ka(kb.commentId),!Qd||!Qd.isValid||Qd.nam(kb.textAnchoringInfo)))for(var Xb of ud.HJ())this.Etm(Object(X.a)(Cb.AParagraphNode,Xb),this.hIh(kb.commentId));for(const sc of mb)if((mb=md.ka(sc.commentId))&&mb.isValid&&mb.nam(sc.textAnchoringInfo)&&(this.UB.isVisible||0===sc.status)){Mc=this.hIh(sc.commentId);this.Uvf(mb.IVa,Mc,mb.startPos,!0);if(mb.bkg)for(kb=1;kb<mb.paragraphs.length;kb++){if(Xb=mb.paragraphs[kb])this.Uvf(Xb,
Mc,0,!0),mb.XXa.equals(Xb)?this.Uvf(mb.XXa,Mc,mb.endPos,!1):this.Uvf(Xb,Mc,Nb.ParagraphReader.textLength(Xb),!1)}else this.Uvf(mb.XXa,Mc,mb.endPos,!1);mb.Svn();Mc=!0}Mc&&pa.a.$(512496735,805,100,"SharedCommentFrame::EditCommentParagraphMarkers - time taken:{0} ms",Date.now()-lc)}}Lnm(mb,lc){if((mb=this.PA.hlc(lc.node))&&(lc.property===dd.a.Bcd||lc.property===dd.a.Acd||lc.property===dd.a.yMe||lc.property===dd.a.zMe)){const Mc=Lc.KAa(mb);Mc&&this.GRf();!mb.textAnchoringInfo||Mc||lc.property!==dd.a.zMe&&
lc.property!==dd.a.yMe||this.Pfa.JCn(mb,this.hIh(mb.commentId),this.LG.wqb(mb),this.Oc.jd.Ua)}}NZl(){this.ru&&this.syb&&(this.n8a.F7k(this.syb.length,this.$me,this.wt,this.hak.vPh),this.n8a.S7k(Array.clone(this.syb),Array.clone(this.$oe)),this.$Tl(2))}Qyn(mb,lc){lc=this.Vb.Lc(lc);for(var Mc=lc.Fb(2);Mc;Mc=lc.Df(2))if((Mc=Object(X.a)(21,Mc))&&Of.a.FZa(Mc.fc,mb))return!0;return!1}gD(mb,lc){lc&&(mb=Object(X.a)(568,lc.node),lc=lc.$0,mb&&2===lc&&((lc=this.gEa.Tf)&&lc.slides&&0>=lc.slides.length&&this.UB.isVisible&&
this.tah(!1,!1),this.ru&&(lc=this.ru.Npb,!lc&&this.ya.Ia&&(lc=this.ya.Ia.fc),this.Qyn(lc,mb)||this.NZl())))}alm(mb,lc){if((mb=this.PA.hlc(lc.node))&&Lc.KAa(mb)&&(lc=this.LG.wqb(mb)))for(const Mc of lc.HJ())this.Etm(Object(X.a)(Cb.AParagraphNode,Mc),this.hIh(mb.commentId))}knm(mb,lc){(mb=Object(X.a)(351,lc.node))&&0<mb.HJ().length&&(lc.ZLj&192||lc.ZLj&4)&&this.GRf()}uqd(mb,lc){mb=lc.property;lc=lc.node;if(mb===ad.a.iy||mb===ad.a.jy)if(mb=this.PA.j3()){for(const Mc of mb)Mc.pos.Y=lc.PT.y,Mc.pos.X=lc.PT.x;
this.AYh()}}P1e(){pa.a.$(512496734,805,this.hLc?15:50,"SharedCommentFrame::OnSessionExpired - HasActiveDraft:{0}",this.hLc)}dJa(mb,lc){pa.a.$(512496733,805,this.hLc?15:50,"SharedCommentFrame::OnSessionEnded - SessionEndedReason:{0};HasActiveDraft:{1}",vc.a[lc.nJ],this.hLc)}dispose(){this.kF&&(this.kF.dispose(),this.kF=null);this.g0e&&(this.g0e.dispose(),this.g0e=null);this.qF.nYh(Object(Ta.a)(this,this.Ghb,"onBeforeSlideSwitched"));this.qF.Cbb(Object(Ta.a)(this,this.Oyl,"updateCommentsWhenNavigateSlide"));
this.qF.pec(Object(Ta.a)(this,this.VOl,"activeSlideDOMDisplayed"));this.pr.Aum(Object(Ta.a)(this,this.Hmm,"onPageViewZoomChanged"));this.xp.C4e(Object(Ta.a)(this,this.onShapeSelected,"onShapeSelected"));this.xp.vYh(Object(Ta.a)(this,this.dxa,"onShapeDeselected"));this.qF.H7c(Object(Ta.a)(this,this.qnm,"onShapeTextSelected"));this.qF.wYh(Object(Ta.a)(this,this.wqd,"onSlideBackgroundClicked"));this.Nmc.rr(Object(Ta.a)(this,this.uqd,"onShapePropertyChange"));this.Nmc.yum(Object(Ta.a)(this,this.knm,"onShapeInvalidation"));
this.Fd.Utm(Object(Ta.a)(this,this.Clm,"onF6FocusDocument"));this.Fd.y4e(Object(Ta.a)(this,this.kKb,"onSetFocus"));this.Wsa.execute(mb=>{mb.yYh(this.bAb)});this.NTh.rr(Object(Ta.a)(this,this.Lnm,"onTextAnchorPropertyChanged"));this.Ggm.MQ(Object(Ta.a)(this,this.gD,"onChildTopologyChanged"));this.NTh.eib(Object(Ta.a)(this,this.alm,"onBeforeTextAnchorDisconnect"));this.Gb.c6(Object(Ta.a)(this,this.Rkm,"onAppModeSwitched"));this.AQh.xch(Object(Ta.a)(this,this.P1e,"onSessionExpired"));this.AQh.kaa(Object(Ta.a)(this,
this.dJa,"onSessionEnded"));this.Gb.bLb(Object(Ta.a)(this,this.s1,"onSetOffline"));this.jka||this.kf.hc(Db.a.click,this.r0e,Object(Ta.a)(this,this.E1e,"onCommentPaneParentDivClick"));this.ODm();this.Csa=this.r0e=null;this.VB.D4e(Object(Ta.a)(this,this.RVh,"onShapeViewElementAddedOrRemoved"));this.VB.Jum(Object(Ta.a)(this,this.RVh,"onShapeViewElementAddedOrRemoved"));this.sa.gib(Object(Ta.a)(this,this.tE,"onSelectionChanged"))}get isReadOnly(){return this.wt}get F9d(){return!!this.ru}get hasFocus(){return this.ack}r3m(){const mb=
new Uc.a;var lc=new Le(Lb.a.Jlc,Ef.a.application);lc.preCallback=Object(Ta.a)(this,this.CHh,"claimFocus");lc.postCallback=Object(Ta.a)(this,this.qYl,"disableOnEmptyDeckAndReadOnly");mb.fa(0,lc);lc=new Le(Lb.a.deleteComment,Ef.a.application);lc.preCallback=Object(Ta.a)(this,this.CHh,"claimFocus");lc.postCallback=Object(Ta.a)(this,this.qYl,"disableOnEmptyDeckAndReadOnly");mb.fa(3,lc);lc=new Le(Lb.a.K3e,Ef.a.application);lc.preCallback=Object(Ta.a)(this,this.CHh,"claimFocus");lc.postCallback=Object(Ta.a)(this,
this.gqm,"postCommentAction");mb.fa(2,lc);lc=new Le(Lb.a.v1e,Ef.a.application);lc.preCallback=Object(Ta.a)(this,this.CHh,"claimFocus");lc.postCallback=Object(Ta.a)(this,this.gqm,"postCommentAction");mb.fa(1,lc);lc=new Le(nb.a.Ctd,Ef.a.application);lc.preCallback=Object(Ta.a)(this,this.Beo,"showHideActionPreCallback");lc.postCallback=Object(Ta.a)(this,this.Aeo,"showHideActionPostCallback");lc.delayActionsUntilRegistration=this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&rb.a("DelayCommentsShowHideAction");mb.fa(6,lc);return mb}Beo(mb,lc,Mc,md,ud){if(1===Mc)return!this.ya.Ia||this.isDisabled?8:2;pa.a.$(36983504,805,50,"New Comment Pane opened.");this.UB.Nse(!!ud&&ud.AutoShowHide);return 2}Aeo(mb,lc,Mc,md,ud,Qd){if(1===md)return mb&&this.Pfa.KQn(this.ya.Pw),mb?32:8;this.cRl(this.UB.isVisible,!!Qd&&Qd.AutoShowHide);return mb?32:8}CHh(mb,lc,Mc,md,ud){if(1===Mc&&this.sa.pYa())return 8;1!==Mc&&((this.qvg=!!ud&&ud.ShouldCanvasTakeFocus)||this.Pkc(),this.sa.Rx(),this.eck=
!0);return 2}gqm(mb,lc,Mc,md){if(1===md&&(this.Mod||!this.syb)||this.Tfk&&this.Ea.isAnimationPreviewEnabled)return 8;this.qvg=!1;return mb?32:8}qYl(mb,lc,Mc,md){return(1!==md||!this.wt&&this.syb)&&this.Oc.jd?mb?32:8:8}zCc(mb,lc){return new Vc.a(this.ySh.te(mb,0),this.ySh.te(lc,1))}TVl(mb,lc){return new Vc.a(this.ySh.Bf(mb,0),this.ySh.Bf(lc,1))}NWe(mb){mb=this.PA.nZb(mb);return this.PA.hlc(mb)}nLb(mb,lc,Mc){!this.S_l()||mb!==this.ru.v7.draftId&&mb!==this.ru.commentId?this.hWe()&&mb===this.ru.v7.draftId?
(this.n8a.selectComment(mb),this.uR&&this.uR.selectContainer(mb,!0),this.M_l&&!this.hasFocus&&1!==lc&&this.Pkc()):this.selectComment(this.NWe(mb),null,!0,!0,0,lc,Mc):(mb=this.erj(this.ru.Npb),mb)?1!==lc&&(this.ru.ZOh=!0,this.Cda.instance&&this.Cda.instance.Z$(mb.Dh)):(pa.a.$(512496732,805,10,"SharedCommentFrame::SelectCommentId - InvalidCommentDataState - slide for extended draft not found"),this.endCommentSession(this.ru.v7.draftId,0))}selectComment(mb,lc,Mc,md,ud,Qd,kb){this.sa.Rx();lc=this.Jhh?
this.Jhh.commentId:null;kb||this.IJh();0!==Qd?mb?this.n8a.selectComment(mb.commentId):this.n8a.selectComment(null):0===Qd&&(Qd=this.LG.wqb(mb))&&Qd.DK&&this.LG.fZh(cg[Qd.DK]);this.kF&&this.kF.selectComment(mb,!0);!this.UB.isVisible&&this.uR&&mb&&mb!==this.Lnd&&(Qd=this.PA.cpj(mb.commentId))&&(Qd=this.PA.hlc(Qd),this.uR.selectContainer(Qd.commentId,!this.qvg&&!kb&&!this.eck),this.eck=!1,this.Oc&&this.Oc.jd&&this.Oc.jd.iyh(5,!1,this.opg));kb||this.qvg||this.Pkc();!this.LG||!this.UB.isVisible&&this.UB.isVisible||
(this.LG.J6k(mb,lc,!0,!1,kb),Lc.KAa(mb)&&!kb&&this.GRf());this.Gb.fg()}get Jhh(){return this.kF&&this.kF.n5e?this.kF.n5e.comment:null}Q9n(){if(!this.Mod){const mb=Cc.a.Xk("SelectNextCommentCrossSlide",1),lc=!this.UB.isVisible;this.Mod=!0;this.oRh.R8i((Mc,md)=>{this.Glm(Mc,md,1,mb)},mb,lc)}}S9n(){if(!this.Mod){const mb=Cc.a.Xk("SelectPreviousCommentCrossSlide",1),lc=!this.UB.isVisible;this.Mod=!0;this.oRh.$8i((Mc,md)=>{this.Glm(Mc,md,0,mb)},mb,lc)}}Glm(mb,lc,Mc,md){md.Fm("FindCommentEndTime",new Date);
this.Yb.Rb(new mc.a(2,1,100,()=>{this.Mod&&(this.Mod=!1,this.fdo(mb,lc,Mc)?this.nLb(this.ru.commentId||this.ru.v7.draftId,0,!1):lc&&mb&&this.Oc.jd.Ed?mb.fc.equals(this.Oc.jd.Ed.fc)?(this.selectComment(lc,null,!0,!0,2,1,!1),md.Za("CircularSelectCommentInSingleSlide",Jh[Mc]),md.finish()):(this.nmc=Object.assign(new dh,{slide:mb,comment:lc,direction:Mc,I6k:md}),this.Cda.instance&&this.Cda.instance.Z$(mb.Dh)):(this.Gb.fg(),md.Za("NoCommentFound",Jh[Mc]),md.finish()))},90,"47"))}c3l(){let mb=-1;if(!this.ru)return mb;
if(this.ru.Npb){const lc=this.erj(this.ru.Npb);lc&&(mb=lc.Dh)}else this.Oc.jd&&this.Oc.jd.Ed&&(mb=this.Oc.jd.Ed.Dh);return mb}fdo(mb,lc,Mc){if(!this.ru||this.ru.v7.sessionType!==Pa.create)return!1;const md=this.c3l();if(0>md)return!1;if(!lc||!mb)return!0;lc=this.Oc.jd.Ed.Dh;if(1===Mc)return Mc=md<=lc&&lc<mb.Dh,lc=mb.Dh<=lc&&lc<md,md<=mb.Dh&&!Mc||lc;Mc=md>=lc&&lc>mb.Dh;lc=mb.Dh>=lc&&lc>md;return md>mb.Dh&&!Mc||lc}Qtd(mb){0!==mb&&this.n8a.selectComment(null);this.kF&&this.kF.selectComment(null,!1);
if(this.uR&&(this.uR.deselectContainer(),this.Oc&&this.Oc.jd)){let lc=5;const Mc=this.sa.Uo();Mc&&Mc.xg&&(lc=2);this.Oc.jd.iyh(lc,!1,this.opg)}this.LG&&0!==mb&&(this.LG.PIh(),this.LG.GIh());this.Gb.fg()}RSm(mb){this.iTe(this.NWe(mb),0)}iTe(mb,lc){this.Lnd!==mb&&(this.LG&&(mb?this.LG.QSm(mb):this.LG.GIh()),this.Lnd=mb,0!==lc&&(this.Lnd?this.n8a.highlightComment(this.Lnd.commentId):this.n8a.highlightComment(null)),this.kF&&this.kF.iTe(this.Lnd,!0))}P9n(){this.UB.isVisible||this.Bgc();if(this.qVe){var mb=
this.NWe(this.qVe),lc=this.Oc.jd.Ed.sid,Mc=lc===parseInt(this.VWi);if(mb){1!==mb.status&&2!==mb.status||this.Bgc();if(rb.a("FixDeepLinkedCommentsPPTO")){lc=this.PA.j3();const md=0<(null===lc||void 0===lc?void 0:lc.length);let ud=0;const Qd=()=>{md&&this.UB.isVisible?this.selectComment(mb,null,!0,!0,0,1,!1):ud<this.Ea.Ac("maxCommentsPaneLoadedRetries",10)&&(u.a.Ljc(this.Yb,Qd),ud++)};u.a.Ljc(this.Yb,Qd)}else this.selectComment(mb,null,!0,!0,0,1,!1);this.Pfa.bRn(this.ya.Pw);pa.a.$(512496730,804,15,
"Deep link - Comment successfully found.  CommentId: {0}; DeepLinkedSlideId: {1};",this.qVe,this.VWi)}else Mc&&this.le.Vs(Object.assign(new le.a,{Code:389,Source:4}),this.pb.podSessionId),pa.a.$(512496731,804,15,"Deep link - Comment not found. CommentId: {0}; DeepLinkedSlideId: {1}; CurrentSlideId: {2}",this.qVe,this.VWi,parseInt(lc))}}get manager(){return this.PA}get KMa(){return"per"}get ijm(){return this.Csa}set ijm(mb){this.Csa=mb;this.kF&&(this.kF.parentElement=mb)}get bkm(){return this.DEg}set bkm(mb){this.DEg=
mb}UXh(mb){this.m4e(mb,void 0,!0)}$fa(mb,lc){lc=!rb.a("FixAltF12KeboardingInCommentPane")||lc;this.VZg(mb,lc,!0)}KUk(){!this.jka&&this.UB&&(this.r0e.style.display=this.UB.isVisible?"flex":"none");this.kF&&(this.kF.setVisibility(this.lhe),this.kF.Izm(this.kie),this.LG.AVe(this.Lnd))}tah(mb,lc){this.uDm(mb,lc);this.KUk();this.cRl(mb,lc)}Hmm(){this.kF&&!this.lvg&&this.kF.jAl();this.AYh();this.XVe&&this.Yyl()}e1n(){this.Mod=!1;this.TZl();this.kF&&this.kF.RWk();this.G0e=!1;this.ODm()}TZl(){this.PA.QDm()}Ghb(){const mb=
this.nfg(),lc=mb&&this.Ea.getBooleanAppSetting("EnableTelemetryLogging")?new id.a("SharedCommentFrame::onBeforeSlideSwitched",Lb.a.wG):rb.a("LogPasteSlideStepTime")&&this.la.JA(Lb.a.uF)?new id.a("SharedCommentFrame::onBeforeSlideSwitched",Lb.a.uF):void 0;null===lc||void 0===lc?void 0:lc.Gf("ST");this.Ofm=this.Fkd()||this.hWe();this.LG&&this.Ofm&&(this.LG.PIh(),this.LG.GIh());null===lc||void 0===lc?void 0:lc.Gf("TB_prepareForSlideSwitch");this.e1n();null===lc||void 0===lc?void 0:lc.Gf("TA_prepareForSlideSwitch");
!rb.a("DuplicateSlideRunAutoShowHideCommentsPane")&&(this.Ea.getBooleanAppSetting("OptimizeSetActiveSlideForDuplicateSlide")&&mb||rb.a("PasteSlideSkipCode")&&this.la.JA(Lb.a.uF))?null===lc||void 0===lc?void 0:lc.Gf("Skipped_AutoShowHideCommentsPane"):this.YXm();null===lc||void 0===lc?void 0:lc.Gf("ET");null===lc||void 0===lc?void 0:lc.hO()}pdo(){return this.ru&&this.ru.Npb&&this.ya.Ia?this.ru.ZOh&&Of.a.FZa(this.ru.Npb,this.ya.Ia.fc):!1}Oyl(){this.ya.Ia||this.Ghb(this,null);this.TZl();this.Oc.jd&&
(this.ijm=this.Oc.jd.LHh);const mb=this.Oc&&this.Oc.jd?this.PA.uYd(this.Oc.jd.Ed):this.PA.j3(),lc=this.Shn(mb),Mc=this.Fkd()||this.hWe();this.ioe||Mc||(this.yp.bqd(this.yp.NNd,this.yp.kPd),this.ioe=!0);this.UB.isVisible||(Mc?(this.ePf(),this.e7n()):this.Fkd()&&this.ePf(),this.ktm());this.m4e(mb,h.AFrameworkApplication.isRtl,!1,lc);rb.a("OpenPaneWhenMovingToAnotherSlideUsingPrevNextComment")&&!this.UB.isVisible&&this.nmc&&-1!==lc&&this.Bgc();this.pdo()?(this.nLb(this.ru.commentId||this.ru.v7.draftId,
0,!1),this.ru.ZOh=!1):-1<lc&&this.nLb(mb[lc].commentId,0,!1);this.nmc&&(this.nmc.I6k.finish(),this.nmc=null);this.Wtd(!1);-1!==lc&&this.kF&&(this.kF.iTe(null,!1),this.kF.selectComment(mb[lc],!1))}VOl(){if(this.tmk){try{this.bfe.dfo(this.ghm,this.ya,this.Nf)}catch(mb){pa.a.$(512496729,805,10,"ActiveSlideDOMDisplayed - Exception while attempting to show resolved comment callout: {0}",mb)}this.tmk=!1}}Wtd(mb){const lc=this.c3l();this.hak.Wtd(mb,lc)}hEm(mb){this.ru&&!this.ru.Npb&&(this.ru.Npb=mb)}onShapeSelected(mb,
lc){this.WJh&&(mb=lc.shapeNode,this.Jel(mb),mb&&0<mb.HJ().length&&this.GRf())}qnm(mb,lc){this.WJh&&(this.Jel(lc.pJ.shapeNode),this.GRf())}tE(mb,lc){if(lc&&lc.gl&&this.sa.H$()&&(mb=this.PA.j3())){lc=!1;for(var Mc of mb)if(Lc.KAa(Mc)){lc=!0;break}lc&&((Mc=this.sa.D$())?this.Jel(Mc):pa.a.$(512496728,805,10,"SharedCommentFrame::OnSelectionChanged - Text selection exists but associated shape is null."))}}Jel(mb){mb.get_shapeId()&&(this.LG&&mb!==this.LG.LXa&&this.Qtd(1),this.cxm(mb.get_shapeId(),!0))}cxm(mb,
lc){var Mc=this.PA.j3();if(Mc){var md=null,ud=null,Qd=0,kb=null;for(const Xb of Mc)if((this.UB.isVisible||0===Xb.status)&&Xb.anchorShape===mb)if(this.sa.H$()&&Lc.KAa(Xb)){Mc=this.sa.Wa.qb.Ya;const sc=this.sa.Wa.qb.vf,Rc=Lc.I6f(Xb,this.LG.wqb(Xb));Rc&&Rc.isValid?(this.Jhh&&this.Jhh.commentId===Xb.commentId||Rc.i1h===Xb.textAnchoringInfo.TextBodyLength)&&Rc.Kwn(Mc,sc)&&(ud?(Mc=Rc.Dsm,Mc<Qd&&(ud=Xb,Qd=Mc)):(ud=Xb,Qd=Rc.Dsm)):(md=Xb,pa.a.$(512496727,805,10,"SharedCommentFrame::SelectCommentWithShapeId - Comment anchor shape paragraph is null."))}else ud||
kb||Lc.KAa(Xb)||(kb=Xb);ud?this.nLb(ud.commentId,1,lc):kb?this.nLb(kb.commentId,1,lc):this.sa.H$()&&!md?this.LG&&this.Qtd(1):md&&this.nLb(md.commentId,1,lc)}}dxa(){if(this.WJh){var mb=this.mgj();this.LG.fZh(String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,mb.toString()));this.Qtd(1)}}mgj(){const mb=this.PA.j3();let lc=[];mb&&(lc=Lg.e(mb,Mc=>0===Mc.status));return lc.length}wqd(){this.WJh&&this.Qtd(1)}Clm(mb,lc){lc.bKb===hf.a.sh&&this.LG.fZh(ResourceStrings.l_SlidePanel+", "+
String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,this.mgj().toString()));lc.Acc===hf.a.sh&&this.Qtd(1)}kKb(mb,lc){this.M_l&&lc.bKb!==hf.a.Xza&&(lc.Acc===hf.a.Xza||hf.a.GM)&&this.hLc&&this.Qtd(1)}Shn(mb){let lc=-1;if(this.nmc&&this.Oc.jd)if(this.nmc.slide!==this.Oc.jd.Ed)pa.a.$(512496726,805,50,"GetIndexOfCommentToSelect() - Active slide doesn't match expected slide in select context");else if(mb&&0<mb.length){if(this.UB.isVisible)lc=1===this.nmc.direction?0:mb.length-1;else if(1===
this.nmc.direction)for(var Mc=0;Mc<mb.length;Mc++){if(0===mb[Mc].status){lc=Mc;break}}else for(Mc=mb.length-1;0<=Mc;Mc--)if(0===mb[Mc].status){lc=Mc;break}0<=lc&&lc<mb.length&&(mb=mb[lc],Mc=this.nmc.comment,Mc.dt===mb.dt&&Mc.commentId===mb.commentId&&Mc.authorName===mb.authorName||pa.a.$(512496725,805,15,"GetIndexOfCommentToSelect() - Expected comment doesn't exist in active slide"))}return lc}dxk(){!this.PA.yhn()||this.CSh?(this.m4e(this.PA.j3(),h.AFrameworkApplication.isRtl,!0),this.CSh&&(this.CSh=
!1)):this.ru&&(0===this.ru.wjd||1===this.ru.wjd?(this.W_l&&this.m4e(this.PA.j3(),h.AFrameworkApplication.isRtl,!0),0===this.ru.wjd&&(this.kTh=!0)):this.ru&&2===this.ru.wjd&&this.W_l&&this.m4e(this.PA.j3(),h.AFrameworkApplication.isRtl,!0))}MQn(){ec(this.Jb)&&(this.CSh=!0,this.dxk())}get cZh(){const mb=this.sa.Uo();if(mb){const lc=mb.PT;this.Rlk=new Vc.a(h.AFrameworkApplication.isRtl?lc.x:lc.x+mb.Hw,lc.y)}else this.Rlk=null;return this.Rlk}get Y9n(){if(!this.sa.H$())return null;var mb=Object(X.a)(352,
this.sa.Wa.qb.vf.node);if(!mb)return null;const lc=Object(X.a)(569,mb.yc(this.Oc.jd.Ua));if(!lc)return null;var Mc=null,md=lc.htmlElement.getElementsByClassName("Selected");if(0<md.length)Mc=md[md.length-1];else if(this.sa.Wa.Fk){if(md=this.Q4l())if(md=Object(X.a)(352,md.vf.node))if(md!==mb){if(mb=Object(X.a)(569,md.yc(this.Oc.jd.Ua)))Mc=mb.htmlElement}else Mc=lc.htmlElement}else return null;mb=this.sa.Uo();if(!mb||!Mc)return null;mb=Object(X.a)(112,mb.yc(this.Oc.jd.Ua));if(!mb)return null;Mc=Xe.a.ji(Mc);
mb=Xe.a.ji(mb.Ho);if(0>=Mc.width+Mc.height&&0>=mb.width+mb.height)return null;mb=Vc.a.kv(new Vc.a(Mc.x,Mc.y),new Vc.a(mb.x,mb.y));return this.TVl(mb.x+Mc.width-5,mb.y+10)}get anchorNode(){const mb=this.sa.Uo();return this.qcm=mb?mb:this.Oc.jd.Ed}uDm(mb,lc){this.UB&&(this.NYe||lc||this.I9k(),this.Fqe.Xym(mb?3:1),!this.isDisabled&&mb&&rb.a("CommentShimmerBugFix")&&this.lDa&&this.lDa.isVisible&&(this.lDa.dNh(),this.Gb.Nse(1)),this.UB.DB(!this.isDisabled&&mb,lc),this.UB.isVisible&&(this.lhe=!0))}Oko(mb){this.UB&&
(this.lhe=!this.isDisabled&&mb,this.lhe||(this.Fqe.Xym(1),this.UB.DB(!1,!1),this.Na.Gm(hf.a.dB,!1)))}xjn(){const mb=new Ra;mb.focusCallback=Object(Ta.a)(this,this.FKh,"focusFirstPaneElement");return Object.assign(new ie.a,{title:ResourceStrings.L_Comments,hideHeader:!1,width:parseInt(this.fyo?300:320),contentProps:mb,location:2,onOpen:lc=>{this.NYe&&!this.Fkd()&&(this.rck=!0);sb.a.p4e(lc,[Db.a.contextMenu]);const Mc=this.Na.Uc(hf.a.dB);this.kf.aib(Db.a.click,lc,Object(Ta.a)(this,this.E1e,"onCommentPaneParentDivClick"),
null,Mc.PLb)},onClose:lc=>{this.tah(!1,!1);this.kf.hc(Db.a.click,lc,Object(Ta.a)(this,this.E1e,"onCommentPaneParentDivClick"));this.NYe&&this.I9k()},isModernPane:!0})}YXm(){if(!this.rck){var mb=this.PA.j3();mb=!!mb&&0<mb.length;pa.a.$(512496722,805,50,"SharedCommentPane::AutoShowHideCommentsPane hasComments:{0}",mb);mb?this.Fkd()&&this.NYe&&this.Bgc():this.NYe?this.R6l():this.ePf()}}Bgc(){this.UB.isVisible||this.la.Eb(Lb.a.coa,2);this.IJh()}R6l(){this.UB.isVisible&&this.la.Eb(Lb.a.coa,2)}Eq(mb){return this.mf.Eq(mb)}get isDisabled(){const mb=
this.gEa.Tf;return!mb||this.Ea.isAnimationPreviewEnabled&&this.Tfk?!0:mb.igb}fri(){this.VSh||(this.VSh=new mc.a(0,1,0,Object(Ta.a)(this,this.n4n,"refreshCommentsTask"),90,"48"),this.Yb.Rb(this.VSh))}Rkm(mb){this.gmm(1===mb.mode)}gmm(mb){this.wt=mb;this.fri();rb.a("PreventCommentPaneCloseOnReadOnlyChanged")?this.NZl():this.UB.isVisible&&this.wt&&this.R6l()}Bmj(){return this.syb?this.syb:[]}D3l(){return this.$oe?this.$oe:[]}get wkm(){return this.$me}get nVe(){return this.ru}b3l(mb){const lc=this.Oc&&
this.Oc.jd?this.PA.uYd(this.Oc.jd.Ed):this.jml(this.PA.j3());if(!lc||!lc.length)return 0;let Mc=null;this.cZh&&(Mc=this.zCc(this.cZh.x,this.cZh.y));let md=-1,ud=0;for(let sc=0;sc<lc.length;sc++){var Qd=this.LG.wqb(lc[sc]);if(!Mc&&Qd)break;if(Qd&&Mc){var kb=Qd.PT.x,Xb=Qd.PT.y;kb+=lc[sc].pos.X;Xb+=lc[sc].pos.Y;Qd.Eg&&(Qd=this.La.us(Qd),kb+=Qd&&Qd.PT?Qd.PT.x:0,Xb+=Qd&&Qd.PT?Qd.PT.y:0);Xb=this.zCc(kb,Xb);kb=Xb.y;Xb=Xb.x;if(Mc.y<kb)break;if(Mc.y>kb||Mc.y===kb&&Mc.x>=Xb)md=sc,lc[sc].Children&&mb&&(ud+=
lc[sc].Children.length)}else Qd||(md=sc,lc[sc].Children&&mb&&(ud+=lc[sc].Children.length))}return md+ud+1}bun(mb){if(!this.Zbk)throw pa.a.$(512496721,805,10,"SharedCommentFrame::InitCommentSession - InvalidCommentDataState - floating container not loaded"),u.a.xH(-2130915320);if(this.ru)return pa.a.$(512496720,805,15,"SharedCommentFrame::InitCommentSession - CommentSessionAlreadyActive"),u.a.xH(-2130915319);if(null===mb)throw Error.argumentNull("session");if(!mb.commentId.length&&0!==mb.wjd)return u.a.xH(-2130915327);
this.ru=mb;this.Wtd(!0);0===mb.wjd&&(this.Qtd(0),this.UB.isVisible||this.avm(mb));if(this.UB.isVisible||!this.UB.isVisible)this.Pkc(),this.T9m();let lc="";mb.v7&&(lc=mb.v7.draftId);pa.a.$(512496719,805,50,"SharedCommentFrame::InitCommentSession - Success; DraftId:{0}",lc);return null}endCommentSession(mb,lc){if(this.ru){if(this.ru.v7&&this.ru.v7.draftId!==mb)throw pa.a.$(512496718,805,10,"SharedCommentFrame::EndCommentSession - InvalidArgument; EndingDraftId:{0}, ActiveDraftId:{1}",mb,this.ru.v7.draftId),
u.a.xH(-2130915327);this.hdm=lc}9!==lc||this.UB.isVisible||this.Na.lJ(hf.a.sh);this.ru=null;this.Gb.fg();if(this.uR&&!this.UB.isVisible){const Mc=[Object.assign(new Wf,{contentId:mb,containerContentType:0,anchorTop:0,anchorLeft:0})];this.uR.detachContainers(Mc)}this.hTh.H$l&&this.rYl();pa.a.$(512496717,805,50,"SharedCommentFrame::EndCommentSession - Success; DraftId:{0}; EndReason:{1}",mb,lc)}get Q1m(){return this.hdm}aoa(){this.Pkc()}YIh(mb){if(this.Ea.getBooleanAppSetting("CommentCopyPasteEnabled")&&
!this.bfe.Vyn)for(const lc of mb)for(const Mc of this.PA.ilc(lc.TX()))if(1===Mc.status){this.ghm=new Wg(mb,this.PA);this.tmk=!0;return}}Kb(){1!==this.wod.awa&&(this.la.Ba(Lb.a.Qad,Ef.a.application,Object(Ta.a)(this,this.coa,"showHideComments")),this.la.ua(Lb.a.m9g,Ef.a.application,Object(Ta.a)(this,this.vdc,"queryShowHideComments"),97));this.zZl&&(this.la.Ba(Lb.a.zWb,Ef.a.application,Object(Ta.a)(this,this.EOf,"deleteAllComments")),this.la.Ba(Lb.a.VDc,Ef.a.application,Object(Ta.a)(this,this.EOf,"deleteAllComments")),
this.la.Ba(Lb.a.WDc,Ef.a.application,Object(Ta.a)(this,this.EOf,"deleteAllComments")));this.la.Ba(Lb.a.Egc,Ef.a.application,Object(Ta.a)(this,this.coa,"showHideComments"));this.la.ua(nb.a.r9g,ub.a.frame,Object(Ta.a)(this,this.vdc,"queryShowHideComments"),97);this.la.ua(Lb.a.vdc,Ef.a.application,Object(Ta.a)(this,this.vdc,"queryShowHideComments"),97);this.la.ua(Lb.a.udc,Ef.a.application,Object(Ta.a)(this,this.vdc,"queryShowHideComments"),97);this.la.ua(Lb.a.MBe,Ef.a.application,Object(Ta.a)(this,this.vdc,
"queryShowHideComments"),97);this.la.Ba(Lb.a.VVg,Ef.a.application,Object(Ta.a)(this,this.tVh,"nudgeCommentMarker"));this.la.Ba(Lb.a.WVg,Ef.a.application,Object(Ta.a)(this,this.tVh,"nudgeCommentMarker"));this.la.Ba(Lb.a.XVg,Ef.a.application,Object(Ta.a)(this,this.tVh,"nudgeCommentMarker"));this.la.Ba(Lb.a.YVg,Ef.a.application,Object(Ta.a)(this,this.tVh,"nudgeCommentMarker"));this.la.Ba(Lb.a.jNe,Ef.a.application,Object(Ta.a)(this,this.jNe,"toggleCommentAnchoringFocus"));this.Ea.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",
!1)&&(this.la.Ba(nb.a.tTd,Ef.a.application,Object(Ta.a)(this,this.tTd,"doesCommentExist")),this.la.Ba(nb.a.ePd,Ef.a.application,Object(Ta.a)(this,this.ePd,"commentActivitySelected")));this.Ae()}Ae(){var mb=this.Na.Uc(If.AFrame.Wl),lc=this.Na.Uc(hf.a.GM);const Mc=this.Na.Uc(hf.a.CY);mb.bindAction(qf.a.hb(lf.a.ijb,1),Lb.a.jNe);lc.bindAction(qf.a.hb(lf.a.ijb,1),Lb.a.jNe);Mc.bindAction(qf.a.hb(lf.a.ijb,1),Lb.a.jNe);mb=this.Na.Uc(hf.a.dB);lc=[mb,this.Na.Uc(hf.a.TA),this.Na.Uc(Hf.a.Xva),this.Na.Uc(hf.a.sh),
this.Na.Uc(hf.a.DV)];for(const md of lc)md.bindAction(qf.a.hb(lf.a.HHa,qf.a.Ne|(Da.a.Jj?4:1)),Lb.a.Jlc);mb.bindAction(qf.a.hb(lf.a.jjb,1),Lb.a.Jlc)}m4e(mb,lc,Mc,md=-1){this.HJb=lc;!this.kF&&this.Csa&&(this.kF=new Mf(this.Csa,this,this.g0e,this.HJb,this.lhe),this.LG.tUh=this.kF);if(mb){Jd.BBn(mb);lc=null;this.sa.H$()&&(lc=this.sa.Wa);var ud=0<mb.length?mb[mb.length-1]:null;if(this.kF){var Qd=this.kF.n5e?this.kF.n5e.comment:null;const kb=Qd?Qd.commentId:null;this.kF.isRightToLeft=this.HJb;this.kF.UXh(mb);
this.LG&&(this.Fkd()||this.hWe())&&(this.LG.PIh(),this.LG.GIh());this.kF.selectComment(null,!1);if(this.ru)Qd=this.NWe(this.ru.commentId),this.LG&&this.LG.J6k(Qd,kb,!1),this.kF.selectComment(Qd,!0);else if(Mc&&Qd){const Xb=this.NWe(Qd.commentId);this.LG&&(this.UB.isVisible||!Xb||1!==Xb.status&&2!==Xb.status)&&(this.kF.selectComment(Qd,!1),this.LG.J6k(Qd,kb,!1,!0))}else this.kTh&&ud&&(this.nLb(ud.commentId,1,!1),this.kF.selectComment(ud,!1));this.kF.Izm(this.kie);this.kie&&this.LG.AVe(this.Lnd)}this.$me=
mb.length;mb=this.jml(mb);this.syb=this.qgm.Cjo(mb,this.wt);this.$oe=this.qgm.Bjo(mb);Mc?(this.Wtd(!0),this.n8a.qxm(Array.clone(this.syb),this.$me,Array.clone(this.$oe)),this.kTh&&ud&&this.n8a.selectComment(ud.commentId)):(Mc=[],this.hWe()&&(Mc=this.b3l(!1),Mc=[Object.assign(new pe,{draftId:this.ru.v7.draftId,insertIndex:0>md?0:Mc})]),0>md?this.n8a.F7k(this.syb.length,this.$me,this.wt,this.hak.vPh,Mc):this.n8a.e$n(this.syb.length,this.$me,md,this.wt,Mc),this.n8a.S7k(Array.clone(this.syb),Array.clone(this.$oe)));
if(this.DEg){if(md=this.NWe(this.DEg))this.selectComment(md,null,!0,!0,0,1,!1),this.DEg=null}else lc&&this.sa.iD(lc);mb=this.UXl(mb);this.Ugb&&mb&&this.Ugb.count>mb.length&&this.F7m(mb);this.$um(mb);this.gak&&this.Gmo();this.kTh=!1}else this.n8a.F7k(0,0,this.wt,1),this.n8a.S7k([],[]),this.$me=0,this.kF&&(this.kF.isRightToLeft=this.HJb,this.kF.UXh(null)),this.$oe=this.syb=null,this.uDm(!1,!1),this.ePf()}Pkc(){this.IJh();this.hasFocus?this.ru&&this.hTh.H$l&&!this.S_l()&&this.Na.lJ(hf.a.GM):this.Na.lJ(this.UB.isVisible?
hf.a.dB:hf.a.Xza)}n4n(){this.VSh=null;this.dxk()}E1e(){this.Pkc();this.sa.Rx();return!1}$Tl(mb){if(this.ru){if(!this.ru.v7)throw pa.a.$(512496716,805,10,"CheckDraftConfigurationAndEndCommentSession - InvalidCommentDataState DraftConfiguration is null. EndReason: {0}",mb),u.a.xH(-2130915320);this.endCommentSession(this.ru.v7.draftId,mb)}else pa.a.$(512496715,805,50,"Calling EndCommentSession when there is no currentCommentSession. EndReason: {0}",mb),this.endCommentSession("",mb)}T9m(){this.G0e=this.Na.currentScope.name===
(this.UB.isVisible?hf.a.dB:hf.a.Xza);this.hTh.bRl(!0)}rYl(){this.hTh.bRl(!1);this.G0e&&(this.Na.lJ(this.UB.isVisible?hf.a.dB:hf.a.Xza),this.G0e=!1)}vTn(mb,lc){if(mb&&mb.name!==hf.a.dB&&mb.name!==hf.a.Xza&&lc.name===hf.a.GM)if(this.UB.isVisible)this.FKh();else if(this.ru){mb="";switch(this.ru.wjd){case 0:mb=this.ru.v7?this.ru.v7.draftId:"";break;case 1:case 2:if(lc=this.PA.cpj(this.ru.commentId))mb=this.PA.hlc(lc).commentId}this.uR.selectContainer(mb,!0)}this.G0e=!0}uTn(){this.G0e=!1}FKh(){this.UB.isVisible&&
this.Fqe.fcn()}VZg(mb,lc,Mc){this.ack=mb;this.Gb.fg();(rb.a("FixAltF12KeboardingInCommentPane")||!this.jka)&&this.ack&&lc&&this.FKh();mb||Mc||this.Qtd(1)}Q6i(mb){var lc=this.ya.presentation;if(!lc)return!1;lc=lc.slides;if(!lc)return!1;for(const Mc of lc)if(lc=Object(X.a)(Vd.a,Mc))if(lc=this.PA.ilc(lc.TX()),mb)for(const md of lc){if(1===md.status)return!0}else{if(lc&&0<lc.length)return!0}else pa.a.$(512496714,805,10,"SharedCommentFrame::FPresentationHasComments - slideNode not found");return!1}f7m(){this.PA.zWb();
const mb=this.PA.j3();mb&&mb.length?this.bfe.Dzm():this.bfe.Bzm(ResourceStrings.l_DeleteAllCommentsOnSlideCallout)}tVh(mb,lc,Mc){if(1===Mc)return 32;if(null!==this.ixm){lc=this.ixm;switch(mb){case Lb.a.VVg:lc.pos.Y+=20;break;case Lb.a.WVg:lc.pos.X-=20;break;case Lb.a.XVg:lc.pos.X+=20;break;case Lb.a.YVg:lc.pos.Y-=20}this.kF.kmo(lc);this.kFn.FYn(lc)}return 32}EOf(mb,lc,Mc){return!this.zZl||this.wt||this.ru&&this.ru.v7?8:1===Mc?this.jgn(mb):this.e7m(mb)}jgn(mb){switch(mb){case Lb.a.zWb:return this.PA.j3()&&
this.PA.j3().length?32:8;case Lb.a.VDc:return this.Q6i(!1)?32:8;case Lb.a.WDc:return 1!==this.wod.awa&&this.Q6i(!0)?32:8;default:return pa.a.$(512496712,805,15,"SharedCommentFrame::GetDeleteAllCommentsState - Unexpected actionId: {0}",mb),2}}e7m(mb){switch(mb){case Lb.a.zWb:this.f7m();break;case Lb.a.VDc:this.bfe.Czm(this.PA,!1);break;case Lb.a.WDc:this.bfe.Czm(this.PA,!0);break;default:return pa.a.$(512496711,805,15,"SharedCommentFrame::DeleteAllCommentsExecute - Unexpected actionId, cannot execute: {0}",
mb),2}return 32}coa(mb,lc,Mc,md,ud){if(1===Mc)return!this.ya.Ia||this.isDisabled?8:32;lc=!this.UB.isVisible;Mc=this.X5.Xl("UserAction",String.format("ShowHideComments: {0}",lc?"ShowPane":"HidePane"));pa.a.$(36983504,805,50,"New Comment Pane opened.");mb===Lb.a.Egc?(this.Oko(!this.lhe),this.KUk()):mb===Lb.a.Qad?(this.kie=!this.kie,this.LG.v_h=this.kie,this.KUk()):this.tah(lc,!!ud&&ud.AutoShowHide);Mc&&Mc.stop();return 32}q$m(){this.UB.isVisible&&this.nLb(this.ru.v7.draftId,1,!1)}jNe(){var mb=this.Na.currentScope.name;
if(this.ru&&this.ru.v7)return mb===hf.a.sh?(this.Pkc(),rb.a("FixAltF12KeboardingInCommentPane")||rb.a("SelectCommentDuringAlt12ActiveDraftEnable")&&this.q$m()):this.Na.Ag(hf.a.sh),32;if(this.LG.BAm||this.LG.LXa){if(mb===hf.a.sh||mb===hf.a.CY){var lc=this.LG.LXa;this.UB.isVisible||(mb=0,lc&&(mb=lc.get_shapeId()),this.cxm(mb,!1));this.Pkc();return 32}if(qc.a.contains(this.VSl,mb)){if((lc=this.Jhh)&&Lc.KAa(lc)){if(mb=Lc.I6f(lc,this.LG.LXa),mb.isValid){const Mc=[];for(let ud=0;ud<mb.paragraphs.length;ud++){const Qd=
mb.paragraphs[ud];Qd&&Mc.push(fg.SelectionFactory.z$(Qd,mb.IVa.equals(Qd)?mb.startPos:0,mb.XXa.equals(Qd)?mb.endPos:Nb.ParagraphReader.textLength(Qd)))}const md=new uh.SelectionCollection(Mc,0);lc.textAnchoringInfo.AnchoringShape&&lc.textAnchoringInfo.AnchoringShape.SmartArtNodeId?(this.Na.Ag(hf.a.CY),this.qfm.execute(ud=>{(ud=Object(X.a)(570,ud.Md))&&this.qfm.instance.e_h(Object(X.a)(hh.a,ud),md)})):(this.Na.Ag(hf.a.sh),this.sa.iD(md))}}else this.Na.Ag(hf.a.sh);return 32}}else{if(qc.a.contains(this.VSl,
mb))this.Na.Ag(hf.a.sh);else{mb=null;mb=this.Oc&&this.Oc.jd?this.PA.uYd(this.Oc.jd.Ed):this.jml(this.PA.j3());if(!qc.a.wb(mb))for(lc of mb)if(this.UB.isVisible||0===lc.status){this.nLb(lc.commentId,1,!1);break}this.Pkc()}return 32}return 8}cRl(mb,lc){mb&&!lc?this.jka?this.IJh():(this.Na.Gm(hf.a.dB,!0),this.Pkc(),this.FKh()):lc?mb&&this.Na.nYa(hf.a.dB,hf.a.Wl,this.UB,!1):0<this.mgj()||this.ru&&this.ru.v7?this.Na.Gm(hf.a.Xza,!0):this.Na.Gm(hf.a.dB,!1);this.NYe||lc||this.I9k()}fQn(){this.ioe||(this.yp.NL(this.yp.NNd,
this.yp.kPd),this.yp.dZa(this.yp.NNd,this.yp.kPd),this.ioe=!0,this.Pfa.gQn(this.ya.Pw));this.lDa&&this.lDa.c0l()}I9k(){const mb=this.PA.j3();mb&&0<mb.length&&(this.rck=!0)}Fkd(){var mb=this.PA.j3();if(!mb||!mb.length)return!1;mb=Lg.e(mb,lc=>0===lc.status);return!!mb&&0<mb.length}vdc(mb,lc,Mc,md,ud){mb===Lb.a.vdc?ud[qe.a.On]=this.UB.isVisible:mb===Lb.a.udc||mb===nb.a.r9g?ud[Ne.a.On]=this.UB.isVisible:mb===Lb.a.MBe?ud[Ne.a.On]=this.lhe:mb===Lb.a.m9g&&(ud[Ne.a.On]=this.kie);return!this.ya.Ia||this.isDisabled?
16:32}tTd(mb,lc,Mc,md,ud){return 2!==Mc?32:(mb=this.J_l(ud))&&this.findComment(mb)?32:8}ePd(mb,lc,Mc,md,ud){return 2!==Mc?32:(mb=this.J_l(ud))&&this.HOn(mb)?32:8}J_l(mb){if(!mb)return null;mb=mb.NavigationId;if(!mb)return null;try{return JSON.parse(mb)}catch(lc){return pa.a.$(512496710,805,10,"ExtractNavParams - Exception while parsing navigation id",lc),null}}HOn(mb){if(this.w9l(this.Oc.jd.Ed,mb))return this.bxm(mb);var lc=Of.a.Er(mb.sId,mb.cId);lc=this.erj(lc);if(!lc)return!1;this.Cda.instance&&
this.Cda.instance.Z$(lc.Dh);u.a.Ljc(this.Yb,()=>{this.bxm(mb)});return!0}bxm(mb){const lc=this.findComment(mb);if(!lc)return!1;1!==lc.status&&2!==lc.status||this.Bgc();this.nLb(mb.commentId,1,!1);return!0}findComment(mb){var lc=this.ya.presentation;if(!lc)return null;lc=lc.slides;if(!lc)return null;for(const Mc of lc)if((lc=Object(X.a)(Vd.a,Mc))&&this.w9l(lc,mb)){lc=this.PA.ilc(lc.TX());for(const md of lc){if(md.commentId===mb.commentId)return md;if(md.Children&&md.Children.length)for(const ud of md.Children)if(ud.commentId===
mb.commentId)return ud}}return null}w9l(mb,lc){return mb.cid&&lc.cId?mb.cid===lc.cId:mb.sid===lc.sId}isCollapsed(){return!1}get ixm(){return null}clearSelection(){}w4n(){this.Gb.fg()}get hLc(){return!!this.ru}I0m(){this.ru&&this.$Tl(8)}getName(){return"SharedFrame"}q1(mb){2===mb.behavior&&mb.actionId===Lb.a.u1&&(mb=this.Pp.Qfb(!0),mb!==Lb.a.uF&&mb!==Lb.a.wG&&mb!==Lb.a.zWb&&mb!==Lb.a.VDc&&mb!==Lb.a.WDc||gg.a.LO().then(lc=>{this.bfe.M5n(lc)}))}p1(){}static kjm(mb,lc){return mb.contentId===lc}static BBn(mb){let lc=
"";if(mb){for(const Mc of mb)if(lc+=Mc.commentId+";",Mc.Children)for(const md of Mc.Children)lc+=md.commentId+";";pa.a.$(512496659,805,15,"LogCommentIds() - {0}",lc)}}nfg(){return this.la.JA(Lb.a.wG)}}Object(c.a)(Jd,"SharedCommentFrame",null,[571,40,572,90]);class $d{constructor(mb,lc,Mc,md,ud,Qd,kb=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=mb;this.parentId=lc;this.commentBody=Mc;this.author=md;this.date=
ud;this.commentFlags=Qd;this.usersByReactionType=kb}}Object(c.a)($d,"OfficeSharedCommentModel",null,[]);class re{constructor(mb,lc){this.CommentId=mb;this.ResolveState=lc}}Object(c.a)(re,"CommentProperties",null,[]);class Re{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(c.a)(Re,"AtMentionAttributes",null,[]);class Be{constructor(){this.contentId=""}}Object(c.a)(Be,"AtMentionOptionalAttributes",null,[]);class rf{constructor(){this.atmention=this.altText=this.lang=null;this.italic=
!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(c.a)(rf,"DeltaAttributes",null,[]);var qa;(function(mb){mb[mb.Undo=-1]="Undo";mb[mb.Unknown=0]="Unknown";mb[mb.Create=1]="Create";mb[mb.ypo=2]="Assign";mb[mb.Vuo=3]="Unassign";mb[mb.Wuo=4]="UnassignAll";mb[mb.fuo=5]="Schedule";mb[mb.Lto=6]="Progress";mb[mb.Delete=7]="Delete";mb[mb.Sto=8]="Restore";mb[mb.nuo=9]="SetTitle";mb[mb.Priority=10]="Priority"})(qa||(qa={}));Object(c.b)("HistoryRecordType",
qa);class Fb{constructor(){this.Id=this.FullName=this.Email=this.DispName=null}}Object(c.a)(Fb,"CommentAtMention",null,[]);var oa=a(1211);class eb{constructor(){this.UserId=this.ProviderId=this.FullName=this.Email=this.DisplayName=null}}Object(c.a)(eb,"UserInfo",null,[]);class Bb{constructor(mb,lc){this.plainText=mb;this.$jm=lc}}Object(c.a)(Bb,"TextTranslationResult",null,[]);var $b=a(23);class tc{constructor(mb,lc,Mc){this.m8n="[";this.zXm=RegExp("\\<\\@(.*?)\\>|\\[\\@(.*?)\\]");this.TAn=RegExp("(?:https?:\\/\\/|www\\.)[^\\s]+",
"gi");this.AXm=RegExp("(\\<\\@.*?\\>|\\[\\@.*?\\]|(?:https?:\\/\\/|www\\.)[^\\s]+)","gi");this.Xbm=!1;this.k6m=md=>{if(!md)return null;const ud={};for(const Qd of md){a:{switch(Qd.Type){case "\ud83d\udc4d":md=1;break a;default:pa.a.$(509220245,805,50,"Unsupported reaction type")}md=void 0}void 0!==md&&(ud[md.toString()]=this.M1n(Qd.ReactionInstances))}return ud};this.M1n=md=>{const ud=[];for(const Qd of md)md=Qd.User,ud.push({DateUtc:Qd.Time,DisplayName:md.DisplayName,Email:md.Email,Provider:md.ProviderId,
UserId:md.UserId,IsCurrentUser:this.isCurrentUser(Qd.User.UserId,Qd.User.ProviderId)});return ud};this.Jb=mb;this.hmk=lc;this.mgk=Mc}get userId(){return this.Jb.appSettings[lb.a.ZTa]}get providerId(){return this.Jb.appSettings[lb.a.dcc]}uln(mb,lc){let Mc=0;if(1===mb.status||2===mb.status)Mc|=8;lc&&(Mc|=1);this.mdo(mb)&&(Mc|=16);mb.isUnread&&(Mc|=32);return Mc}isCurrentUser(mb,lc){return mb?"Author"===mb||this.userId===mb&&lc===lc?!0:!1:!1}Gwn(mb){return this.isCurrentUser(mb.userId,mb.providerId)}mdo(mb){return""===
mb.userId||"Author"===mb.userId||!this.joo(mb.userId)||this.userId===mb.userId&&this.providerId===mb.providerId?!1:!0}joo(mb){return 3===mb.split("::").length}OCm(mb,lc,Mc){var md;if(null===mb)throw Error.argumentNull("comment");const ud=this.Gjo(mb.text);var Qd=mb.authorName,kb=rb.a("PPTPlumbEmailThroughCG")?J.a.KXb(mb.userId||""):"";const Xb=mb.dt;Mc=this.uln(mb,Mc);Qd=new hc(mb.userId,mb.providerId,Qd,kb,this.Gwn(mb));return ec(this.Jb)&&(null===mb||void 0===mb?0:mb.reactions)?(kb=this.k6m(null===
(md=mb.reactions)||void 0===md?void 0:md.ReactionList),new $d(mb.commentId,lc,ud,Qd,Xb,Mc,kb)):new $d(mb.commentId,lc,ud,Qd,Xb,Mc)}Cjo(mb,lc){if(null===mb)throw Error.argumentNull("comments");const Mc=new d.a;for(const md of mb)if(Mc.add(this.OCm(md,"",lc)),md.Children&&0<md.Children.length)for(const ud of md.Children)Mc.add(this.OCm(ud,md.commentId,lc));return Mc.toArray()}Mjo(mb,lc,Mc,md){const ud=Object.assign(new oa.a,{Asignees:[]});mb=this.hmk.ldn(mb,lc,!lc.taskId,Mc);for(const Qd of mb)2===
Qd.type?Qd.assignee?(mb=Object.assign(new eb,{DisplayName:Qd.assignee.DisplayName,FullName:Qd.assignee.DisplayName,UserId:Qd.assignee.UserId,ProviderId:Qd.assignee.Provider,Email:Qd.assignee.Email}),ud.Asignees.push(mb)):pa.a.$(512496658,845,10,"TranslateSharedTaskMetadataToTaskInfo - History record type is assign, but Assignee is null."):9===Qd.type&&(ud.Title=Qd.title);if(!ud.Asignees)return pa.a.$(512496657,845,10,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo assignee is null and not set."),
null;ud.Title||(pa.a.$(512496656,845,15,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo title is null and not set."),ud.Title=md);return ud}Kjo(mb,lc){const Mc=new oa.a;if(mb.assignee){const md=new eb,ud=mb.assignee;md.DisplayName=ud.Name;md.FullName=ud.Name;md.UserId=ud.UserPrincipalName;md.ProviderId="O365";md.Email=ud.UserPrincipalName;Mc.Asignees=[md]}Mc.Title=mb.title?mb.title:lc;return Mc}Ljo(mb,lc,Mc){if(!lc)return null;try{const md=this.F1h(Mc,new Date).plainText,ud=this.mgk?this.Mjo(mb,
lc,Mc,md):this.Kjo(lc,md);if(!ud)return null;ud.CompletionPercentage=lc.completion?lc.completion:0;return ud}catch(md){pa.a.$(512496655,845,10,"TranslateSharedTaskMetadataToTaskInfo - Exception thrown: {0}",md)}return null}Bjo(mb){if(null===mb)throw Error.argumentNull("comments");const lc=new d.a;for(const Mc of mb)Mc.taskInfo&&Mc.taskInfo.Asignees&&0<Mc.taskInfo.Asignees.length&&(mb=this.Ajo(Mc))&&lc.add(mb);return lc.toArray()}Ajo(mb){if(this.mgk&&this.hmk&&0<mb.taskInfo.TaskHistoryRecords.length)try{const lc=
tc.X2m(mb.taskInfo.TaskHistoryRecords),Mc=new $b.a;Mc.add(mb.commentId,new re(mb.commentId,100===mb.taskInfo.CompletionPercentage));const md=this.hmk.e6m(mb.commentId,mb.commentId,lc,Mc);tc.m0m(mb,md,this.mgk);return md}catch(lc){return pa.a.$(512496654,845,10,"TranslateCommentTaskToSharedCommentTaskItem Failed due to [{0}]",lc.message),this.NCm(mb)}else return this.NCm(mb)}NCm(mb){var lc=new T;lc.startDate=mb.taskInfo.StartDate;lc.endDate=mb.taskInfo.DueDate;const Mc=new Q(mb.taskInfo.Asignees[0].UserId);
Mc.DisplayName=mb.taskInfo.Asignees[0].DisplayName;Mc.Provider=mb.taskInfo.Asignees[0].ProviderId;Mc.Email=mb.taskInfo.Asignees[0].Email;const md=Array(1);md[0]=Mc;lc=new K(!1,mb.taskInfo.Title,md,lc,mb.taskInfo.CompletionPercentage,0);return new O(mb.commentId,mb.commentId,lc,[])}Gjo(mb){if(null===mb)throw Error.argumentNull("nativeText");const lc=new da;mb=mb.split(this.AXm);for(const md of mb){var Mc=this.zXm.exec(md);Mc&&3===Mc.length?(mb=new Re,Mc[0].substring(0,1)===this.m8n?(mb.fullName=Mc[2],
mb.resolveState=1):(mb.fullName=Mc[1],mb.resolveState=0),mb.email="UnknownEmail",Mc=new Be,Mc.contentId="Pre-existing Mention",lc.vvn("@"+mb.fullName,mb,Mc),this.Xbm||(this.Xbm=!0,pa.a.$(512496653,845,15,"Rendering mention when AtMentions are disabled."))):(mb=this.TAn.exec(md))&&1===mb.length?(mb=mb[0],lc.insertHyperLink(mb,Object.assign(new rf,{link:mb}))):lc.Dvn(md)}return lc.lgn()}F1h(mb,lc){var Mc=Sys.Serialization.JavaScriptSerializer.deserialize(mb);mb=[];lc||(lc=new Date);const md=new Sys.StringBuilder;
for(const ud of Mc.ops)if(ud.attributes){if(ud.attributes.atmention){const Qd=1<ud.insert.length?ud.insert.substring(1,ud.insert.length):"";if(ud.optional&&ud.optional.atmention&&ud.optional.atmention.contentId)Mc=tc.f3l(Qd,1===ud.attributes.atmention.resolveState);else{Mc=tc.f3l(Qd,1===ud.attributes.atmention.resolveState);const kb=tc.fjn(lc,1===ud.attributes.atmention.resolveState);Array.add(mb,Object.assign(new Fb,{FullName:ud.attributes.atmention.fullName,DispName:Qd,Id:kb,Email:ud.attributes.atmention.email}));
lc=new Date(lc.getTime()+1)}}else ud.attributes.link||pa.a.$(512496652,845,10,"Unsupported formatting discovered in Delta. Stripping out rich text."),Mc=ud.insert;md.append(Mc)}else md.append(ud.insert);return new Bb(md.toString(),mb)}static g3m(mb){switch(mb){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 10;case 8:return 9;case 9:return-1;default:return 0}}static e3m(mb){var lc=null;mb.User&&(lc=new Q(mb.User.UserId,
mb.User.ProviderId,mb.User.DisplayName));lc=new E(tc.g3m(mb.HistoryRecordType),lc,mb.DtTime,mb.RecordId);lc.commentId=mb.CommentId;mb.Assignee&&(lc.assignee=new Q(mb.Assignee.UserId,mb.Assignee.ProviderId,mb.Assignee.DisplayName));mb.StartDate&&mb.DueDate?(lc.schedule=new T,lc.schedule.startDate=mb.StartDate?mb.StartDate:null,lc.schedule.endDate=mb.DueDate?mb.DueDate:null):mb.StartDate&&!mb.DueDate?pa.a.$(512496651,845,10,"ConvertToOfficeSharedHistoryRecord schedule end date is null but start date is not"):
!mb.StartDate&&mb.DueDate&&pa.a.$(512496650,845,10,"ConvertToOfficeSharedHistoryRecord schedule start date is null but end date is not");var Mc=mb.Priority;0<Mc?lc.priority=Mc:pa.a.$(512496649,845,10,"Priority is negative");Mc=mb.CompletionPercentage;0<=Mc?lc.completion=Mc:pa.a.$(512496648,845,10,"Percent complete is negative");lc.title=mb.Title;lc.undoId=mb.UndoId;return lc}static X2m(mb){const lc=mb.length,Mc=Array(lc);for(let md=0;md<lc;++md)Mc[md]=tc.e3m(mb[md]);return Mc}static m0m(mb,lc,Mc){const md=
lc.currentState,ud=mb.taskInfo;let Qd=!1;const kb=rb.a("SetTaskFromTaskStateInsteadOfHistory");ud.StartDate.toString()!==md.schedule.startDate.toString()&&(kb&&(md.schedule.startDate=ud.StartDate),Qd=!0,pa.a.$(512496647,845,10,"Start Date does not match."));ud.DueDate.toString()!==md.schedule.endDate.toString()&&(kb&&(md.schedule.endDate=ud.DueDate),Qd=!0,pa.a.$(512496646,845,10,"End Date does not match."));ud.CompletionPercentage!==md.completion&&(kb&&(md.completion=ud.CompletionPercentage),Qd=!0,
pa.a.$(512496645,845,10,"Completion percentage does not match."));ud.Title!==md.title&&(kb&&(md.title=ud.Title),Qd=!0,pa.a.$(512496644,845,10,"Title does not match."));ud.Asignees[0].UserId!==md.assignees[0].UserId&&(kb&&(md.assignees[0].UserId=ud.Asignees[0].UserId),Qd=!0,pa.a.$(512496643,845,10,"Assigned to user id does not match."));ud.Asignees[0].DisplayName!==md.assignees[0].DisplayName&&(kb&&(md.assignees[0].DisplayName=ud.Asignees[0].DisplayName),Qd=!0,pa.a.$(512496642,845,10,"Assigned to display name does not match."));
ud.Asignees[0].ProviderId!==md.assignees[0].Provider&&(kb&&(md.assignees[0].Provider=ud.Asignees[0].ProviderId),Qd=!0,pa.a.$(512496641,845,10,"Assigned to provider id does not match."));ud.Asignees[0].Email!==md.assignees[0].Email&&(kb&&(md.assignees[0].Email=ud.Asignees[0].Email),Mc||(Qd=!0,pa.a.$(512496640,845,10,"Assigned to email does not match.")));if(Qd&&Mc&&(tc.CCn(mb,lc),rb.a("IsThrowForTaskStateMismatchEnabled")))throw pa.a.$(0,845,10,"There was a mismatch between the state and state as determined by history"),
Error.create("TaskStateMismatch");}static CCn(mb,lc){const Mc=new d.a;for(const md of lc.history)for(const ud of md.records)Mc.add(qa[ud.type]);if(Mc.count!==mb.taskInfo.TaskHistoryRecords.length){lc=new d.a;for(const md of mb.taskInfo.TaskHistoryRecords)lc.add(qa[md.HistoryRecordType]);pa.a.$(512496611,845,10,"LogTaskHistoryDetailsForMismatch")}}static fjn(mb,lc){mb=mb._toFormattedString("yyyy-MM-ddThh:mm:ss:fff",Sys.CultureInfo.InvariantCulture);return lc?mb+"_Z":mb}static f3l(mb,lc){return lc?
"[@"+mb+"]":"<@"+mb+">"}}Object(c.a)(tc,"SharedCommentModelTranslator",null,[566]);class xc{constructor(mb,lc,Mc){this.iLl=!1;this.Na=mb;this.Hj=lc;this.aod=Mc}bRl(mb){mb?(this.aod&&this.aod.isVisible||this.Hj.jZ(hf.a.GM),this.Hj.ns(hf.a.dB),this.Na.lJ(hf.a.GM)):this.Hj.ns(hf.a.GM);this.iLl=mb}get H$l(){return this.iLl}}Object(c.a)(xc,"SharedCommentsRTEFocusActionHelper",null,[537]);class cd{constructor(mb,lc,Mc,md){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=mb;this.body=
lc;this.confirmButton=Mc;this.cancelButton=md}}Object(c.a)(cd,"ViewContainerModalDialogStrings",null,[]);class od{constructor(mb,lc,Mc){this.containerType="full-pane";this.identifier=null;this.Ad=mb;this.Na=lc;this.identifier=Mc}closeView(){this.Ad.tah(!1,!1)}openView(){this.Ad.tah(!0,!1)}invokeModalConfirmationDialog(mb,lc,Mc){const md=new Gh.a;Mc&&Mc.title&&Mc.body&&Mc.confirmButton&&Mc.cancelButton||(pa.a.$(35496838,805,10,"InvokeModalConfirmationDialog: No localized strings provided."),Mc=new cd("",
"","",""));md.Ue=1;md.vg(1,Mc.confirmButton);md.vg(0,Mc.cancelButton);md.mpb=this.Na.currentScope.name;md.Xmc=!0;md.GC(Mc.title,Mc.body,1,ud=>{1===ud?(mb(),md.mpb=null):lc()})}}Object(c.a)(od,"ViewContainerAPI",null,[564,565]);class sd extends Sys.EventArgs{constructor(){super()}}Object(c.a)(sd,"CommentsPackageLoadedEventArgs",Sys.EventArgs,[]);var wd=a(575);class Hd{constructor(){this.ggm=this.uim=this.Fqe=this.Gim=this.Gmc=this.uQh=this.kpd=this.wQh=this.O3=this.ga=null;this.Kge=this.umc=this.rod=
!1;this.X5=this.nak=null;this.Hgm="6F1926CF-E872-4C4C-9393-3956FCFEB98A";this.kDa=null;this.jka=!1}oc(mb){this.ga=mb;this.jka=this.ga.resolve("PowerPointWebEditor.IApplicationSettings").RIf;this.X5=this.ga.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");this.Fqe=new x(h.AFrameworkApplication.Zd,"CommentPane");mb.register(ld,"PowerPointWebEditor.CommentEditor").as("PowerPointWebEditor.ICommentEditor").oa().pa(()=>new ld);const lc=this.ga.resolve("PowerPointWebEditor.IFileInfo").awa,Mc=
2===lc||3===lc;this.rod=Mc;this.Kge=1===lc;mb.register(Oe,"PowerPointWebEditor.CommentTelemetryManager").as("PowerPointWeb.Comments.ICommentTelemetryManager").oa().pa(()=>new Oe(this.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.ga.resolve("Common.IAppSettingsManager"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.Graph.ICommentReader"),lc));mb.register(fa,"PowerPointWebEditor.CommentManager").as("PowerPointWeb.Comments.ICommentGraphManager").oa().pa(()=>
new fa(this.X5,lc,this.ga.resolve("PowerPointWebEditor.ICommentCloudPolicy"),this.ga.resolve("PowerPointWebEditor.IClassFactory"),this.ga.resolve("Common.Transaction.ITransactionFactory"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.Graph.ICommentReader"),this.ga.resolve("PowerPointWebEditor.ICommentEditor"),this.ga.resolve("Common.IAppSettingsManager"),this.ga.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.ga.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.ga.resolve("PowerPoint.IDateHelper"),this.ga.resolve("PowerPointWebEditor.ISlideReader"),this.ga.eb("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager")));const md=this.rod||!this.Kge;this.kDa=this.ga.resolve("PowerPointWeb.Comments.ICommentGraphManager");md&&mb.register(525,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>").oa().pa(()=>new wd.a((sc,
Rc)=>{let Zc=null;const Id=Object(X.a)(112,sc.yc(mb.resolve("Box4.IPageView").Ua));Id&&!Id.isDisposed&&(sc=mb.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").DUi(mb.resolve("PowerPointWebEditor.IPptSelectionManager"),null,sc,Rc,Id.Cua,mb.resolve("PowerPointWebEditor.IZoomContext"),mb.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),mb.resolve("PowerPointWebEditor.IApplicationSettings")),Zc=new De(sc),Zc.Yq(Id.Cua),Id.uHb(Zc,5),Zc.visible=Id.oM||Id.vp);return Zc}));
this.ga.register(534,"PowerPointWeb.Comments.ICommentMarkerAnchorHelper").oa().pa(()=>new ha(this.kDa,this.ga.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"),mb.resolve("PowerPointWebEditor.Graph.ITableReader")));this.ga.register(535,"PowerPointWeb.Comments.ICommentMarkerPositionHelper").oa().pa(()=>new pb(this.ga.resolve("PowerPointWebEditor.View.IPPTPageView").Cd,this.ga.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.kDa));
const ud=this.rod||!this.Kge;this.ga.register(536,"PowerPointWeb.Comments.ICommentMarkerViewElementFactory").oa().pa(()=>new wc(this.ga.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.ga.resolve("PowerPointWeb.Comments.ICommentMarkerPositionHelper"),new Uf(ud),this.ga.resolve("PowerPointWebEditor.ICommentCloudPolicy"),ud,ud));this.ga.register(Rf,"PowerPointWebEditor.CommentTextAnchorHighlightActor").oa().pa(()=>new Rf(!this.Kge,this.ga.resolve("Common.Utils.IHighContrastDetector")));
const Qd=new uc(md,this.ga.resolve("PowerPointWebEditor.IActiveSlideViewManager"),md?this.ga.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>"):null,this.kDa,this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.IAriaManager"),this.ga.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.ga.resolve("Box4.Highlight.IHighlightManager"),this.ga.resolve("PowerPointWebEditor.CommentTextAnchorHighlightActor"),
this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"));mb.register(537,"PowerPointWebEditor.IRTEFocusActionHelper").oa().pa(()=>new xc(mb.resolve("Common.IFocusManager"),mb.resolve("Common.IF6Manager"),mb.resolve("PowerPointWebEditor.ICommentsPane")));this.ga.register(G,"Common.Comments.OfficeSharedCommentsEventHost").as("Common.Comments.IOfficeSharedCommentsEventHost").oa().pa(()=>new G(this.ga.resolve("Common.ITaskManager")));const kb=this.ga.resolve("Common.IAppSettingsManager").getBooleanAppSetting(Ja.a.bub);
kb&&this.ga.register(538,"Common.Comments.ICommentTaskTranslator").oa().pa(()=>(new ma(!0,kb,!0)).M3m());this.ga.register(tc,"PowerPointWebEditor.SharedCommentModelTranslator").as("PowerPointWeb.Comments.ISharedCommentModelTranslator").oa().pa(()=>new tc(this.ga.resolve("Common.IAppSettingsManager"),kb?this.ga.resolve("Common.Comments.ICommentTaskTranslator"):null,kb));this.ga.register(za,"Common.Comments.CommentActivationManager").as("Common.Comments.ICommentActivationManager").oa().pa(()=>new za);
this.umc=this.ga.resolve("Common.IAppSettingsManager").getBooleanAppSetting(lb.a.Rpd)&&(Mc||!this.Kge);this.ga.register(Jd,"PowerPointWebEditor.SharedCommentFrame").as("PowerPointWeb.Comments.ICommentFrame").as("PowerPointWebEditor.ICommentSessionManager").oa().pa(()=>new Jd(this.kDa,this.ga.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.ga.resolve("PowerPointWebEditor.ICommentsPane"),
this.ga.resolve("Common.DragInputManager"),this.ga.resolve("Common.IClickInputManager"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("Common.IF6Manager"),this.ga.resolve("PowerPoint.IPathManager"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.ICommentsPane").va,this.ga.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.ga.resolve("PowerPointWebEditor.IPPTWorkspace"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("Box4.Graph.IGraphInstance"),this.ga.resolve("PowerPoint.IDateHelper"),this.ga.resolve("Common.ITaskManager"),this.ga.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),this.ga.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.Fqe,this.ga.resolve("PowerPointWebEditor.IRTEFocusActionHelper"),h.AFrameworkApplication.isRtl,this.ga.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),
this.ga.resolve("PowerPointWebEditor.IFindCommentLogic"),this.ga.resolve("PowerPointWebEditor.View.IPPTPageView").Cd,this.ga.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.ga.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.ga.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.ga.resolve("PowerPointWeb.Comments.ICommentMarkerViewElementFactory"),this.X5,Qd,this.ga.resolve("Common.IAppSettingsManager"),
this.ga.eb("Box4.IInteractiveViewManager"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),md,mb.resolve("PowerPointWebEditor.IErrorHandler"),mb.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.umc,mb.resolve("Box4.Graph.IGraphInstance").Xd(10),mb.resolve("PowerPointWebEditor.View.IViewEventSource"),mb.resolve("PowerPointWebEditor.ICommentCloudPolicy"),ud,mb.resolve("PowerPointWebEditor.IShapeReader"),mb.eb("Common.App.SafeLinks.ISafeLinksManager"),mb.resolve("Box4.ICharacterPropertiesEditor"),
mb.resolve("PowerPointWebEditor.IFileInfo"),this.jka,mb.resolve("Box4.Graph.IGraphIteratorFactory"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.IPPTRumTracker"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").$Jb?this.ga.resolve("PowerPointWebEditor.ICommentShimmerView"):null,this.ga.eb("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.ga.eb("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),this.ga.eb("PowerPointWebEditor.ISorterViewActorLazy")));
this.ga.register(Tb,"Common.Comments.OfficeSharedCommentsActionHost").as("Common.Comments.IOfficeSharedCommentsActionHost").oa().pa(()=>new Tb(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWeb.Comments.ICommentFrame").iDn));this.ga.register(od,"PowerPointWebEditor.ViewContainerAPI").as("PowerPointWeb.Comments.IPptViewContainerAPI").oa().pa(()=>new od(this.ga.resolve("PowerPointWeb.Comments.ICommentFrame"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.Hgm));
const Xb=new Hb(this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new xd(this.ga.resolve("PowerPointWebEditor.IPPTReplicationScheduler")),this.kDa,this.ga.resolve("Common.IAppSettingsManager").getBooleanAppSetting(lb.a.nqm),this.ga.he("PowerPointWeb.Comments.ICommentFrame"));this.ga.register(539,"PowerPointWebEditor.IFindCommentLogic").oa().pa(()=>new db(Xb,this.ga.resolve("Common.ITaskManager")));this.ga.register(gf,"PowerPointWebEditor.CommentsChangeListener").oa().pa(()=>
new gf(this.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("Common.ITaskManager"),this.ga.resolve("Box4.Graph.IGraphInstance").Xd(7),this.ga.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),this.ga.resolve("PowerPointWeb.Comments.ICommentFrame")));this.ga.register(540,"PowerPointWebEditor.ICommentContextDetailsUpdateHelper").oa().pa(()=>new Gc(this.ga.resolve("PowerPointWebEditor.IPresentationReader"),
this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.IFindCommentLogic"),this.kDa,this.ga.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.ga.resolve("Common.ITaskManager")));this.ga.register(Gd,"PowerPointWebEditor.CommentPropertyTracker").oa().pa(()=>new Gd(Object(Ta.a)(this.ga.resolve("PowerPointWeb.Comments.ICommentFrame"),this.ga.resolve("PowerPointWeb.Comments.ICommentFrame").dxk,
"onCommentPropertiesUpdated"),Ma.App.gP.LU,Ba.GraphTransactionManager.instance));this.ga.register(541,"PowerPointWebEditor.ICommentsPane").oa().pa(()=>new ef(this.ga.resolve("PowerPointWebEditor.IFrameContext"),this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.ga.resolve("PowerPointWebEditor.ITaskPaneManager"),this.jka,this.ga.resolve("PowerPointWebEditor.IPPTRumTracker")));this.ga.register(Dd,"PowerPointWebEditor.CommentSmartReplyProvider").oa().pa(()=>new Dd(this.ga.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
this.ga.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")))}init(){Kb.a.instance.mc(Wa.a.OHh,(new Date).getTime());const mb=this.X5.Xl("UserAction","InitCommentsPackage"),lc={};this.jka||(this.kpd=this.ga.resolve("PowerPointWebEditor.ICommentsPane").va);this.O3=this.ga.resolve("PowerPointWeb.Comments.ICommentFrame");this.O3.initialize();var Mc=mb.ew;lc.CommentFrameInitMS=Mc;this.ga.resolve("PowerPointWebEditor.ICommentSessionManager");this.wQh=this.ga.resolve("PowerPointWebEditor.CommentPropertyTracker");
this.wQh.ptn();const md=mb.ew;lc.CommentPropertyTrackerInitMS=md-Mc;this.nak=this.ga.resolve("PowerPointWebEditor.CommentsChangeListener");this.Gim=this.ga.resolve("PowerPointWeb.Comments.IPptViewContainerAPI");var ud=ca.b(h.AFrameworkApplication.ha.appSettings.SessionStartInfoJson.toString());Mc=ud.Ring||"Unknown";ud=ud.WACDatacenter||"Unknown";const Qd=this.ga.resolve("PowerPointWebEditor.IApplicationSettings").k9l;var kb=h.AFrameworkApplication.ha.Ma("LokiComplianceEnvironment");kb=kb&&""!==kb?
kb:h.AFrameworkApplication.ha.Ma("SovereignEnvironmentName");this.uim=new Aa("PowerPoint",h.AFrameworkApplication.buildVersion,null,null,h.AFrameworkApplication.userSessionId,Mc,ud,!Qd,this.ga.resolve("Common.IActionManagerExtended"),null,kb);Mc=tb.a.Le(h.AFrameworkApplication.lcid);this.ggm=new kc(h.AFrameworkApplication.isRtl,Mc?Mc.name:Sys.CultureInfo.CurrentCulture.name,h.AFrameworkApplication.uiCulture,h.AFrameworkApplication.dataCulture);this.jka||(this.kpd.id=this.Hgm);this.kYe();h.AFrameworkApplication.ha.Wf(Object(Ta.a)(this,
this.uu,"onFullAppSettingsReady"));(Mc=this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"))&&Mc.hsm(new sd);Mc=mb.ew;lc.CommentReactPaneInitMS=Mc-md;this.cun();lc.CommentPaneInitMS=mb.ew-Mc;h.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)&&this.ga.resolve("PowerPointWebEditor.CommentSmartReplyProvider").initialize();mb.stop();pa.a.$(512262878,805,15,"CommentsPackage::Init telemetry InitTimeMS:{0}; ModernCommentsReloadEnabledWithoutRoundtrip:{1}",
lc,this.ga.resolve("Common.IAppSettingsManager").getBooleanAppSetting(lb.a.Rpd))}cun(){const mb=this.ga.resolve("PowerPointWebEditor.ICommentsPane"),lc=this.ga.resolve("PowerPointWebEditor.IPaneManager");this.jka||document.getElementsByClassName("CommentPanel").length||lc.lba(mb);lc.$lc(2);this.ga.resolve("PowerPointWebEditor.IFocusManager").nYa(hf.a.dB,hf.a.Wl,mb,!mb.isVisible)}kYe(){Kb.a.instance.mc(Wa.a.kYe,(new Date).getTime());const mb=this;this.ga.resolve("PowerPointWebEditor.ICommentCloudPolicy").OQd().then(lc=>
{Kb.a.instance.mc(Wa.a.zNh,(new Date).getTime());dc.a.kH(mb.ga.eb("Common.App.People.IExternalPeopleAPI")).continueWith(Mc=>{mb.Gmc=Mc.result;mb.Gmc||pa.a.$(512262877,805,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");mb.ga.resolve("PowerPointWebEditor.IApplicationSettings").li&&(Mc=mb.ga.resolve("Common.IAppSettingsManager").Ma(lb.a.daa),mb.Gmc.MCk(Mc+"p"));Mc=[Db.a.contextMenu];mb.jka||sb.a.p4e(mb.kpd,Mc);const md=lc&&(mb.rod||!mb.Kge),ud=mb.ga.resolve("Common.IAppSettingsManager").getBooleanAppSetting("PositionDraftCommentCardOnCommentsPaneBasedOnAnchorPositionEnabled");
mb.ga.register(de,"PowerPointWebEditor.PPTSharedCommentAppCapabilities").as("Common.Comments.IOfficeSharedCommentsAppCapabilities").oa().pa(()=>new de(mb.ga.resolve("Common.IAppSettingsManager"),mb.ga.resolve("PowerPointWebEditor.IApplicationSettings"),mb.Gmc,mb.Kge,md,mb.umc));mb.ga.register(Zb,"PowerPointWebEditor.CommentAPI").as("PowerPointWebEditor.IPptOfficeSharedCommentAPI").oa().pa(()=>new Zb(mb.ga.resolve("PowerPointWeb.Comments.ICommentFrame"),mb.kDa,mb.ga.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
mb.ga.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),mb.ga.resolve("Common.ITaskManager"),mb.ga.resolve("Common.IAppSettingsManager"),mb.ga.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),mb.ga.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),mb.Gmc,mb.ga.resolve("PowerPointWebEditor.ICommentCloudPolicy"),mb.ga.resolve("PowerPointWebEditor.CommentSmartReplyProvider"),md,mb.umc,ud,mb.ga.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),mb.ga.resolve("Common.IActionManagerExtended"),
mb.ga.resolve("PowerPointWebEditor.IApplicationSettings")));mb.uQh=mb.ga.resolve("PowerPointWebEditor.IPptOfficeSharedCommentAPI")},11).continueWith(()=>{mb.uQh&&mb.uQh.checkAtMentionCapability().then(Mc=>{Mc&&((Mc=mb.ga.eb("Common.ISystemInitiatedFeedback"))?Mc.execute(md=>{md.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}):pa.a.$(512262876,805,10,"InitOfficeSharedComments:InitOfficeSharedComments sifFuture should not be null."))});mb.aun()})})}aun(){Kb.a.instance.mc(Wa.a.p_h,
(new Date).getTime());const mb=this.ga.resolve("Common.IDynamicScriptLoaderProvider").SU,lc=this.ga.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),Mc=this.ga.resolve("Common.Comments.ICommentActivationManager");Kb.a.instance.mc("CommentActivationManagerInitStart",(new Date).getTime());Mc.initialize(mb,this.uQh,this.uim,this.Gmc,new Qb(this.Gim,this.Fqe),this.ggm,null,lc.vln());Kb.a.instance.mc(Wa.a.CYe,(new Date).getTime());Mc.CYe().then(()=>{Kb.a.instance.mc(Wa.a.BNh,(new Date).getTime());
this.O3.lvn();Kb.a.instance.mc(Wa.a.HPh,(new Date).getTime());ta.a(this.ga)("floatingContainerManager").then(()=>{Kb.a.instance.mc(Wa.a.AKh,(new Date).getTime());this.O3.gun();Kb.a.instance.mc(Wa.a.BKh,(new Date).getTime());const md=this.kDa.j3();md&&0<md.length?(this.O3.P9n(),Kb.a.instance.mc(Wa.a.Ulh,(new Date).getTime()),wa.App.pLb(null,Wa.a.Ulh)):pa.a.$(512262875,805,50,"InitCommentActivationManager: Deep link to a slide without comments")}).catch(md=>{pa.a.$(512262874,801,10,"Failed to load the resources for the floating container UI + "+
md.toString())})})}uu(){this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame").fg()}dispose(){this.wQh&&this.wQh.Vko();this.O3&&this.O3.dispose();this.nak&&this.nak.dispose();this.Gmc=null}get name(){return"PowerPointWebEditor.CommentsPackage"}static main(){Kb.a.instance.mc(Wa.a.MHh,(new Date).getTime());$a.a.instance.Jc(new Hd,0,!0)}}Object(c.a)(Hd,"CommentsPackage",null,[4,5]);var Wd=a(18);Type.registerNamespace("Common.App.SharedComments");Type.registerNamespace("FloatingContainer");Type.registerNamespace("FloatingContainerManager");
Type.registerNamespace("PowerPointWeb.Comments");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("RichContentEditAPI");Type.registerNamespace("Common.Comments");Object(Wd.c)("Comment");Hd.main();Object(Wd.b)("Comment")},575:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);var c=a(1263);class b{constructor(d){this.Sm=new c.a;this.Jpd=d}fca(d){const e=d.id;let h=null;this.Sm.Sb(e)?h=this.Sm.ka(e):(this.Jpd&&(h=this.Jpd(d,()=>{this.sbh(e)})),h&&this.Sm.fa(e,h));return h}J7(d){d=
d.id;return this.Sm.Sb(d)?this.Sm.ka(d):null}sbh(d){this.Sm.remove(d)}}Object(y.a)(b,"ShapeComponentViewManager",null,[525])},831:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.onFullRenderComplete=this.useCoachmark=this.jumpToCalloutTargetButtonEnabled=this.hasDynamicSizing=this.preventLightDismiss=this.useTeachingStyles=this.hasFocusableControls=this.calloutProps=this.showCloseIcon=this.secondaryButtonProps=this.primaryButtonProps=this.title=this.content=this.target=
null}}Object(y.a)(c,"CalloutParameters",null,[])},832:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}Object(y.a)(c,"ICalloutProps",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25649181/wdjs/ppteditDS.comment.js.map