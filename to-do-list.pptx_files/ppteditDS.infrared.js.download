'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[28],{1905:function(y,C,a){a.r(C);y=a(0);var c=a(95),b=a(40),d=a(228),e=a(68),h=a(90),n=a(44);class m{constructor(la,da){this.la=la;this.la.ua(n.a.T7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.U7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.V7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.W7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.X7l,e.a.application,d.ActionManager.jI,4);
this.la.ua(n.a.Y7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.Z7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.F7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.G7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.H7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.I7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.J7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.K7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.L7l,e.a.application,d.ActionManager.jI,
4);this.la.ua(n.a.E7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.M7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.N7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.O7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.P7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.Q7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.R7l,e.a.application,d.ActionManager.jI,4);this.la.ua(n.a.S7l,e.a.application,d.ActionManager.jI,4);this.vdm=JSON.parse(da.Ma(h.a.L2e));for(const J of this.vdm)J.regex=
new RegExp(J.pattern)}trackAction(la){for(const da of this.vdm)da.regex.test(la)&&this.la.Eb(da.actionId,2)}}Object(y.a)(m,"IdeasActionTracker",null,[852]);class k{constructor(){this.Aje=this.jok=this.Hmk=null;this.rxn=this.Vyo}addSlideSuggestionsListener(la){this.Hmk=la}addTextToSmartArtSuggestionListener(la){this.jok=la}zqi(la){this.Aje=la}notifySlideSuggestion(la,da){this.Hmk&&(this.Hmk(la,da),b.a.$(512496328,829,50,"data: count: {0}, correlation: {1}",da?da.suggestions.length:0,da?da.correlationId:
"0"))}notifyTextToSmartArtSuggestion(la,da){this.jok&&(this.jok(la,da),b.a.$(512496327,829,50,"data: count: {0}, correlation: {1}",da?da.suggestions.length:0,da?da.correlationId:"0"))}rVh(la){this.Aje&&this.Aje(la)}}Object(y.a)(k,"InfraredDesignerServiceProvider",null,[853]);class l{constructor(){this.Aje=null}zqi(la){this.Aje=la}rVh(la){this.Aje&&this.Aje(la)}}Object(y.a)(l,"InfraredTelemetryListener",null,[851]);var u=a(206),r=a(1263),x=a(64),v=a(6),z=a(15);class A{}Object(y.a)(A,"EntityGroup",
null,[]);class B extends A{}Object(y.a)(B,"Idea",A,[]);var G=a(1252);class w{}Object(y.a)(w,"ProviderResult",null,[]);var F=a(769),H=a(615),E=a(614),P=a(768),T=a(1251),K=a(41),M=a(324);class N{}N.IYn="PowerPoint";N.Noo="WAC";Object(y.a)(N,"ApplicationPropertiesConstants",null,[]);class I{}Object(y.a)(I,"EnterpriseUserInfo",null,[]);class O{}Object(y.a)(O,"Message",null,[]);class Q extends O{}Q.PowerPointTextTileChangedMessageType="PowerPoint.TextTileChanged";Object(y.a)(Q,"PowerPointTextTileChangedMessage",
O,[]);class U{}Object(y.a)(U,"RankerConfiguration",null,[]);class ba{constructor(la){this.Pim=la}Gdn(la,da){return new Promise((J,Ca)=>{this.Pim&&la&&da||Ca("wopiIdentityManager or tokenParameter or clientWoipId is null");this.Pim.getAccessToken(la,da).then(Fa=>{Fa?J(Fa.accessToken):Ca("auth token is null")},Fa=>{Ca(Fa)})})}}Object(y.a)(ba,"AuthenticationProvider",null,[892]);class aa{constructor(la,da,J,Ca,Fa=""){this.resource=la;this.scope=da;this.silentLogin=J;this.options=Ca;this.correlationId=
Fa}}Object(y.a)(aa,"InfraredTokenParameters",null,[891]);class La{constructor(la,da,J,Ca,Fa,ya,Ua,Ia,Oa){this.kfm=this.t$j=this.JKl=null;this.efm=!1;this.Ggk=null;this.qmk=!1;b.a.$(512262852,809,50,"PPTWebEditorInfraredRuntimeManager - Initialize");this.P0e=la;this.HEn=Ua;this.hek=Oa;this.uFn=la.getBooleanAppSetting(h.a.$qd);this.npd=la.Ma(h.a.v6e);Ua=window.location.hostname;Oa=la.Ma(h.a.iYe);Ua&&0<Ua.length&&Oa&&0<Oa.length&&0<=Oa.toLowerCase().indexOf(Ua.toLowerCase())&&(this.npd="");this.Eod=
da;this.tug=ya;if(this.DHn=la.getBooleanAppSetting(h.a.T2e))this.kfm=la.Ma(h.a.U2e),this.t$j=new ba(Ia);this.Eod.addSlideSuggestionsListener(Object(v.a)(this,this.rUn,"onSlideSuggestion"));this.Eod.addTextToSmartArtSuggestionListener(Object(v.a)(this,this.GUn,"onTextToSmartArtSuggestion"));this.Eod.zqi(Object(v.a)(this,this.Vlm,"onIdeasSessionTelemetry"));J.zqi(Object(v.a)(this,this.Vlm,"onIdeasSessionTelemetry"));this.tug&&this.tug.execute(ma=>{ma.MPl(Object(v.a)(this,this.Cxk,"onEditorCritiques"))});
this.la=Ca;(this.bDa=Fa)&&this.bDa.execute(ma=>{ma.registerSimpleLocalWorkflow("InfraredSlideTextTileWorkflow",Object.assign(new E.a,{name:"InfraredSlideTextTileLambda",inputSchema:H.a.etd,outputSchema:H.a.etd,func:(za,Qa,Xa)=>{this.sUn(za);Xa(null)}}))});this.vco()}get ZXe(){return this.JKl}vco(){var la=JSON.parse(this.P0e.Ma(h.a.Aye));la=Object.assign(new U,{rankingOrder:la});var da=IdeasInfraredConnector,J=da.setup,Ca=b.a.$,Fa=Object(v.a)(this,this.Dtn,"ideasPaneVisibilityStatusCallback"),ya=this.P0e;
const Ua={};Ua.appName=2===K.AFrameworkApplication.Ha.Ib.Dm?N.IYn:"unknown";Ua.appVersion=K.AFrameworkApplication.buildVersion;Ua.appPlatform=N.Noo;Ua.lcid=K.AFrameworkApplication.lcid;var Ia=M.a.Le(K.AFrameworkApplication.lcid);Ia=Ia?Ia.name:null;const Oa=Ia.split("-");Ua.market=Oa[Oa.length-1];Ua.uiLanguage=Ia;Ua.sessionId=K.AFrameworkApplication.userSessionId;Ua.tenantRoot=ya.Ma(h.a.Z5e);Ua.shredderServiceEndpoint=ya.Ma(h.a.shredderServiceEndpoint);this.JKl=J.call(da,la,Ca,Fa,Ua,this.HEn,Object(v.a)(this,
this.w4l,"getShredderServiceAuthTokenPromise"))}Dtn(la){this.efm=la;(this.Eod.rxn=la)?(this.la.Eb(n.a.GVd,2),this.Irm()):this.la.Ra(n.a.lib,2,new T.a(!0,P.a.qNh))}rUn(la,da){const J=[];J.push(Object.assign(new B,{providerId:G.a.DAm,groupTypeId:G.a.CAm,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:da}));try{this.ZXe.pushProviderResult(Object.assign(new w,{providerId:G.a.DAm,resultStatus:la,entityGroups:J}))}catch(Ca){b.a.$(512262851,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",
Ca)}"Success"===la&&(u.a.wb(da.suggestions)||this.hek.z1h(0))}GUn(la,da){const J=[];J.push(Object.assign(new B,{providerId:G.a.KAm,groupTypeId:G.a.IAm,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:da}));try{this.ZXe.pushProviderResult(Object.assign(new w,{providerId:G.a.KAm,resultStatus:la,entityGroups:J}))}catch(Ca){b.a.$(512262850,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",Ca)}}Vlm(la){try{this.ZXe.trackIdeasProviderAction(la.cardId,
la.actionType,la.actionEngagement)}catch(da){b.a.$(512262849,811,10,"OnIdeasSessionTelemetry: Exception occured while calling TrackIdeasProviderAction in IR, Exception is: {0} ",da)}}sUn(la){if(this.uFn)if(la)if(la){try{const da=z.a(la.Content);this.RXm(this.Ggk,da)&&(this.Ggk=da,this.qmk=!0)}catch(da){b.a.$(512262818,811,10,"Deserializing tile response failed");return}this.efm&&this.Irm()}else b.a.$(512262819,811,50,"ProcessSlideTextTileChange,TileNull");else b.a.$(512262848,811,50,"ProcessSlideTextTileChange,InputNull")}RXm(la,
da){if(!la&&da||la&&!da)return!0;if(!la&&!da)return!1;if(!la.drawingElems&&da.drawingElems||la.drawingElems&&!da.drawingElems)return!0;const J=new r.a;for(const Ca of la.drawingElems)if(la=Ca.text)for(const Fa of la.paragraphs)Fa&&(x.a.wb(Fa.id)||x.a.wb(Fa.chars)||J.fa(Fa.id,Fa.chars));for(const Ca of da.drawingElems)if(da=Ca.text)for(const Fa of da.paragraphs)if(Fa&&!(x.a.wb(Fa.id)||x.a.wb(Fa.chars)||J.Sb(Fa.id)&&J.ka(Fa.id)===Fa.chars))return!0;return!1}Irm(){if(this.qmk){try{this.ZXe.postMessage(Object.assign(new Q,
{messageType:Q.PowerPointTextTileChangedMessageType,data:this.Ggk}))}catch(la){b.a.$(512262817,811,10,"OnSlideTextTileChange: Exception occured while posting message to IR Exception is: {0} ",la)}this.hek.z1h(1);this.qmk=!1}}Cxk(la,da){try{la=[],la.push(Object.assign(new B,{groupTypeId:G.a.gZl,providerId:G.a.lZl,notificationConfidence:da.x0b?da.x0b.notificationConfidence:0,shouldRaiseNotification:da.x0b?da.x0b.shouldRaiseNotification:!1,confidence:da.x0b?da.x0b.confidence:0,data:da.XRf})),this.ZXe.pushProviderResult(Object.assign(new w,
{providerId:G.a.lZl,resultStatus:da.x0b?da.x0b.resultStatus:F.a.invalid,entityGroups:la}))}catch(J){b.a.$(512262816,811,10,"OnEditorCritiques: Exception occured while calling PushProviderResult in IR, Exception is: {0} ",J)}da.x0b&&"Success"===da.x0b.resultStatus&&da.XRf&&!u.a.wb(da.XRf.critiques)&&this.hek.z1h(2)}w4l(){if(!this.t$j)return b.a.$(512262815,811,50,"authenticationProvider is null"),null;try{if(this.npd&&0<this.npd.length)return this.t$j.Gdn(new aa(this.npd,"user_impersonation",!0,{}),
this.kfm);b.a.$(512262814,811,50,"ShredderServiceResourceId is null or empty");return null}catch(la){return b.a.$(512262813,811,10,"Exception occured while retrieving auth token from wopi identity, Exception is: {0} ",la),null}}Rgn(){return new Promise(la=>{const da=this.P0e.Ma(h.a.shredderServiceEndpoint),J=this.w4l();da&&da.length&&J?J.then(Ca=>{Ca&&Ca.length?(Ca=new I,Ca.CountryCode="US",Ca.IsEnabled=!1,Ca.IsEnterpriseEnabled=!0,Ca.IsGoLocal=!1,Ca.ServiceEndpoint=da,Ca.TenantRoot="",la(Ca)):la(null)},
()=>{la(null)}):la(null)})}}Object(y.a)(La,"PPTWebEditorInfraredRuntimeManager",null,[850]);class Z{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.Infrared"}oc(la){this.ga=la;this.ga.register(k,"PowerPointWebEditor.Infrared.InfraredDesignerServiceProvider").as("PowerPointWebEditor.IDesignerServiceProvider").oa().pa(()=>new k);this.ga.register(l,"PowerPointWebEditor.Infrared.InfraredTelemetryListener").as("PowerPointWebEditor.IInfraredTelemetryListener").oa().pa(()=>new l);this.ga.register(m,
"PowerPointWebEditor.Infrared.IdeasActionTracker").as("PowerPointWebEditor.Infrared.IIdeasActionTracker").oa().pa(()=>new m(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("Common.IAppSettingsManager")));b.a.$(512262812,809,50,"PPTWebEditorInfraredRuntimePackage - Registering IInfraredRuntimeManager");this.ga.register(La,"PowerPointWebEditor.Infrared.PPTWebEditorInfraredRuntimeManager").as("PowerPointWebEditor.Infrared.IInfraredRuntimeManager").oa().pa(()=>new La(this.ga.resolve("Common.IAppSettingsManager"),
this.ga.resolve("PowerPointWebEditor.IDesignerServiceProvider"),this.ga.resolve("PowerPointWebEditor.IInfraredTelemetryListener"),this.ga.resolve("Common.IActionManager"),this.ga.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.ga.eb("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.ga.resolve("PowerPointWebEditor.Infrared.IIdeasActionTracker"),this.ga.resolve("Common.App.WopiIdentity.WopiIdentityManager"),this.ga.resolve("PowerPointWebEditor.Infrared.IIdeasContext")))}init(){const la=
this.ga.resolve("Common.IAppSettingsManager");la.Wf(()=>{la.getBooleanAppSetting(h.a.TTa)&&(b.a.$(512262811,809,50,"PPTWebEditorInfraredRuntimePackage - Initialize IInfraredRuntimeManager"),this.ga.resolve("PowerPointWebEditor.Infrared.IInfraredRuntimeManager"))})}dispose(){}static main(){c.a.instance.Jc(new Z)}}Object(y.a)(Z,"PPTWebEditorInfraredRuntimePackage",null,[4,5]);Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PowerPointWebEditor.Infrared");Z.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25649181/wdjs/ppteditDS.infrared.js.map