'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1107:function(y,C,a){a.d(C,"a",function(){return z});var c=a(81);y=a(0);var b=a(47),d=a(52),e=a(45),h=a(104),n=a(188),m=a(62),k=a(51),l=a(627),u=a(853),r=a(275),x=a(373),v=a(279);class z{constructor(A,B,G,w,F,H,E,P){this.cF=A;this.sa=B;this.mh=G;this.yka=w;this.La=F;this.MI=H;this.HI=E;this.c4=P;this.select=({scope:T,text:K,index:M})=>Object(c.b)(this,void 0,void 0,function*(){var N=[];let I=[];var O=null!==
T&&void 0!==T?T:"Selection";if("Selection"===O){var Q=this.sa.Wa.qb;Q?(Q=Q.toArray().filter(U=>b.ParagraphReader.ue(U.node)),0<Q.length?N.push(...Q):(Q=this.sa.zd(),0<Q.length&&this.c4.nfc(12,Q,N))):(Q=this.sa.rg(),this.c4.qxa(12,Q,N));0!==N.length||T||(O="Presentation")}if(Array.isArray(O)&&0<O.length&&O[0]instanceof r.a)this.c4.qxa(12,O,N);else if(Array.isArray(O)&&0<O.length&&O[0]instanceof u.a)this.c4.nfc(12,O,N);else if("Presentation"===O&&this.Ld){O=this.Ld.dA.presentation.slides;if(null===
O)throw Error("Could not cast from ISlide to ISlide on presentation slides.");this.c4.qxa(12,O,N)}if(K)for(const U of N){N=b.ParagraphReader.text(U.node);N=this.matchAll(N,K);for(const ba of N)ba[0]&&void 0!==ba.index&&(N=ba.index,O=ba.index+ba[0].length,Q=m.a.Oj(U.node,N),this.HI.xbd(Q),Q=m.a.Oj(U.node,O+1),this.HI.xbd(Q),I.push(m.a.createTextRange(U.node,N,O)))}else I=N;if("number"===typeof M){0>M&&(M=I.length+M);if(0<=M&&M<I.length)return[I[M]];throw Error.argumentOutOfRange("index");}return I});
this.Eih=(T,K)=>{const M=new e.GraphIterator;M.set(T);M.sc(11);M.zg(11);T=T.jg.Vv(M);const N=K?1:16;K=K?1:0;T?T.lga(N,K):(K=n.a.gM(N,K),this.MI.Vva(M,K))};this.qjh=(T,K)=>{switch(K){case "Left":K=1;break;case "Center":K=2;break;case "Right":K=3;break;case "Distributed":K=7;break;case "Justify":K=6;break;default:K=1}this.yka.LH(T,K)};this.Wkh=(T,K)=>{if(T=this.La.Jn(T)){switch(K){case "Top":K=0;break;case "Middle":K=1;break;case "Bottom":K=2;break;default:K=0}T.setValue(k.a.IM,K)}};this.format=({textRanges:T,
color:K,bold:M,italic:N,underline:I,fontName:O,size:Q,bulleted:U,horizontalAlignment:ba,verticalAlignment:aa})=>Object(c.b)(this,void 0,void 0,function*(){if(!T)throw Error.argumentNull("textRanges");const La=[];if(T&&0<T.length){for(const la of T){var Z=[];if(la.contextId===d.a.paragraph){const da=h.a.GWe(la.node,!1);for(const J of da)Z.push(J.formatting)}else Z.push(h.a.rt(la));for(const da of Z)da&&(K&&(Z=x.a.w$(K),K=""===Z?K:Z,this.mh.Up(da,K,null)),void 0!==M&&this.mh.XF(da,M),void 0!==N&&this.mh.setItalic(da,
N),I&&this.mh.HR(da,"None"!==I),O&&this.mh.FR(da,O),void 0!==Q&&this.mh.Ap(da,2*Q),void 0!==U&&this.Eih(la.node,U),ba&&this.qjh(la.node,ba),aa&&this.Wkh(la.node,aa));La.push(new Promise(da=>v.a.bL(da,la.node).bind(this)))}yield Promise.all(La)}});this.sdh=(T,K)=>Object(c.b)(this,void 0,void 0,function*(){const M=(new DOMParser).parseFromString(K,"text/html");if(0<M.body.innerHTML.trim().length)return T.kib=M.body.innerHTML.trim(),new Promise(N=>v.a.bL(N,T).bind(this))});this.insert=({precededBy:T,
text:K})=>Object(c.b)(this,void 0,void 0,function*(){if(!T)throw Error.argumentNull("precededBy");const M=[];for(var N of T){var I=N.node,O=-1===N.Mb?I.characterData.length:N.Mb+1;O=N.contextId===d.a.sg?N:m.a.Oj(I,O);this.HI.replaceTextRange(O,K,!0);I=m.a.createTextRange(I,N.Mb+1,N.Mb+K.length);M.push(I)}N=[];for(const Q of M)N.push(new Promise(U=>v.a.bL(U,Q).bind(this)));return Promise.all(N)});this.delete=({textRanges:T})=>Object(c.b)(this,void 0,void 0,function*(){if(!T)throw Error.argumentNull("textRanges");
const K=[],M=[];for(let N of T){N.node instanceof l.a&&N.contextId!==d.a.textRange&&(N=m.a.createTextRange(N.node,0,N.node.characterData.length));this.HI.replaceTextRange(N,"",!0);const I=m.a.Oj(N.node,N.Xa);K.push(I);M.push(new Promise(O=>v.a.bL(O,N.node).bind(this)))}yield Promise.all(M);return 0===K.length?[]:[K[0]]});if(!A)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!B)throw Error.argumentNull("m_selectionManager");if(!G)throw Error.argumentNull("m_formattingEditor");if(!w)throw Error.argumentNull("m_paragraphEditor");
if(!F)throw Error.argumentNull("m_shapeReader");if(!H)throw Error.argumentNull("m_listEditor");if(!E)throw Error.argumentNull("m_characterPropertiesEditor");if(!P)throw Error.argumentNull("m_odslGraphUtils");this.cF&&this.cF.execute(T=>{this.Ld=T})}matchAll(A,B){B=B instanceof RegExp?B:new RegExp(B,"g");const G=[];let w;for(;null!==(w=B.exec(A));)G.push(w);return G}}Object(y.a)(z,"ODSLText",null,[871])},1108:function(y,C,a){a.d(C,"a",function(){return F});var c=a(81);y=a(0);var b=a(654),d=a(1704),
e=a(1585),h=a(50),n=a(1703),m=a(275),k=a(80),l=a(77),u=a(376),r=a(571),x=a(55),v=a(117),z=a(776),A=a(572),B=a(201),G=a(373),w=a(279);class F{constructor(H,E,P,T,K,M,N,I,O,Q,U){this.cF=H;this.sa=E;this.zj=P;this.SJb=T;this.zDa=K;this.La=M;this.il=N;this.vj=I;this.zb=O;this.Do=Q;this.rw=U;this.q9a=this.Dsa=0;this.qfc=(ba,aa)=>{for(const La of ba)aa.push(...La.Nj())};this.select=({scope:ba,name:aa,index:La=-1})=>Object(c.b)(this,void 0,void 0,function*(){const Z=[],la=[];var da=null!==ba&&void 0!==ba?
ba:"Selection";if("Selection"===da){const J=this.sa.zd();0<J.length?Z.push(...J):this.qfc(this.sa.rg(),Z);0!==Z.length||ba||(da="Presentation")}if("Presentation"===da&&this.Ld){da=this.Ld.dA.presentation.slides;if(null===da)throw Error("Could not cast from ISlide to ISlide on presentation slides.");this.qfc(da,Z)}else Array.isArray(da)&&0<da.length&&da[0]instanceof m.a&&this.qfc(da,Z);if(aa)for(const J of Z)J.shapeName===aa&&la.push(J);else la.push(...Z);if("number"===typeof La){0>La&&(La=la.length+
La);if(0<=La&&La<la.length)return[la[La]];throw Error.argumentOutOfRange("index");}return la});this.format=({shapes:ba,left:aa,top:La,height:Z,width:la,lineColor:da,lineDashStyle:J,lineWeight:Ca,lineTransparency:Fa,fillColor:ya,fillTransparency:Ua})=>Object(c.b)(this,void 0,void 0,function*(){if(!ba)throw Error.argumentNull("shapes");if(ba&&0<ba.length){const Oa=[];for(const ma of ba){void 0!==aa&&(ma.iy=aa);void 0!==La&&(ma.jy=La);void 0!==Z&&(ma.MA=Z);void 0!==la&&(ma.Hw=la);if(da){var Ia=G.a.w$(da);
da=""===Ia?da:Ia;Ia=B.a.parse(da);ma.K9=JSON.stringify(Ia)}if(J)switch(J){case "Dash":ma.DA=0;break;case "DashDot":ma.DA=1;break;case "DashDotDot":ma.DA=2;break;case "LongDash":ma.DA=3;break;case "LongDashDot":ma.DA=4;break;case "RoundDot":ma.DA=5;break;case "Solid":ma.DA=6;break;case "SquareDot":ma.DA=7;break;case "LongDashDotDot":ma.DA=8;break;case "SystemDash":ma.DA=9;break;case "SystemDot":ma.DA=10;break;case "SystemDashDot":ma.DA=11;break;default:ma.DA=6}void 0!==Ca&&(ma.outlineWidth=Ca);void 0!==
Fa&&(Ia=B.a.parse(ma.K9),Ia.Alpha=100*Fa,ma.K9=JSON.stringify(Ia));ya&&(ya=""===G.a.w$(ya)?ya:G.a.w$(ya),Ia=B.a.parse(ya),ma.U4=JSON.stringify(Ia));void 0!==Ua&&(Ia=B.a.parse(ma.U4),Ia.Alpha=100*Ua,ma.U4=JSON.stringify(Ia));Oa.push(new Promise(za=>w.a.bL(za,ma).bind(this)))}yield Promise.all(Oa)}});this.insert=({slides:ba,shapeType:aa})=>{if(!ba)throw Error.argumentNull("slides");if(!this.Ld)throw Error("Cannot insert shapes without appForOfficeManager instance.");const La=[];for(const ya of ba){ba=
ya;if(!ba)throw Error("Cannot find selected slide to insert shape.");const Ua=ba.fc;if(k.a.By(Ua))throw Error("Cannot insert on fake slide node.");const Ia=this.tOa(aa);if(!Ia)throw Error("Could not load props for shapeType.");if(!this.zj.KD(ba,1))throw this.zj.qJ(ba),Error("Too many shapes on the slide.");const Oa=this.SJb.LF;var Z=ba.Ve.HasDefaultShape,la=ba.Ve.HasDefaultLine,da=95===Ia.HM||97===Ia.HM||Array.contains(r.a.cmc,Ia.HM);la=la&&da;Z=Z&&!da;this.Y9(0);var J=void 0;let ma,za;var Ca=this.Ld.dA.presentation.slideWidth,
Fa=this.Ld.dA.presentation.slideHeight;J=new l.a((Ca-Ia.width*b.a.nz)/2,(Fa-Ia.height*b.a.nz)/2);da=J.x+d.a.Bf(this.eF*u.a.GK,e.a.horizontal);za=J.y+d.a.Bf(this.eF*u.a.GK,e.a.vertical);Oa?(J=Ia.width*b.a.nz,ma=Ia.height*b.a.nz):(J=d.a.Bf(F.ifb,e.a.horizontal),ma=d.a.Bf(F.hfb,e.a.vertical),da=Ca/2-d.a.Bf(F.ifb/2-this.eF*u.a.GK,e.a.horizontal),za=Fa/2-d.a.Bf(F.hfb/2-this.eF*u.a.GK,e.a.vertical));this.eF++;this.eF>this.Dsa&&(this.eF=this.q9a);Ca=ba.Av();Fa=Object(n.a)(107,this.Ld.dA.Ia.Vg(this.zb.Ua));
x.a.Bb&&(la||Z)&&x.a.Bb.Za(v.a.CVd,la?"HasDefaultLine":"HasDefaultShape");let Qa=null;Qa=!Oa||"TextBox"===aa||Z||la?this.il.eIa(!1,Ua.cid,Ua.sid,0,Ia.shapeType,da,za,J,ma,Ca+1):r.a.ZVb(Ua,Ia,Fa.rM,null,new z.a,da,za,J,ma,Ca,this.La,this.il,this.zb,this.Ld.dA,this.vj);this.Do.EO([Qa],ba,null);this.rw.MJ=Qa;this.PFb();La.push(Qa)}aa=[];for(const ya of La)aa.push(new Promise(Ua=>w.a.bL(Ua,ya).bind(this)));return Promise.all(aa)};this.delete=({shapes:ba})=>Object(c.b)(this,void 0,void 0,function*(){if(!ba)throw Error.argumentNull("shapes");
for(const aa of ba)this.il.HWb(aa);return new Promise(aa=>w.a.bL(aa,this.Ld.dA.Ia).bind(this))});if(!H)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!E)throw Error.argumentNull("m_selectionManager");if(!P)throw Error.argumentNull("m_shapeCountValidator");if(!T)throw Error.argumentNull("m_shapeSVGDependencyLoader");this.cF&&this.cF.execute(ba=>{this.Ld=ba});this.eF=0}Y9(H){this.zDa.Etd(H)}PFb(){const H=h.a.instance.eb("Common.ISystemInitiatedFeedback");H&&H.execute(E=>{E.logActivity("InsertShapeActivity",
null)})}tOa(H){switch(H){case "Textbox":return new A.a(34,16,.5,3);case "Ellipse":return new A.a(34,9,1,1);case "Triangle":return new A.a(2,17,1,1.16);case "RightTriangle":return new A.a(3,55,1,1);case "Parallelogram":return new A.a(6,56,1,1.33);case "Trapezoid":return new A.a(7,57,1.33,1);case "Diamond":return new A.a(5,58,1,1);case "SPentagon":return new A.a(9,59,1,1.05);case "Hexagon":return new A.a(10,60,1,1.16);case "Heptagon":return new A.a(11,61,1,1);case "Octagon":return new A.a(12,62,1,1);
case "Decagon":return new A.a(13,63,1,1);case "Dodecagon":return new A.a(14,64,1,1);case "Pie":return new A.a(39,65,1,1);case "Chord":return new A.a(87,66,1,1);case "Teardrop":return new A.a(35,67,1,1);case "Frame":return new A.a(83,68,1,1);case "HalfFrame":return new A.a(84,69,1,1);case "LShape":return new A.a(85,70,1,1);case "DiagonalStripe":return new A.a(86,71,1,1);case "Cross":return new A.a(130,72,1,1);case "Plaque":return new A.a(33,73,1,1);case "Can":return new A.a(73,7,1.33,1);case "Cube":return new A.a(72,
8,1.33,1.33);case "Bevel":return new A.a(82,74,1.14,1.14);case "Donut":return new A.a(41,75,1,1);case "NoSymbol":return new A.a(42,76,1,1);case "BlockArc":return new A.a(40,77,1,1);case "FoldedCorner":return new A.a(81,78,1,1);case "SmileyFace":return new A.a(78,79,1,1);case "Heart":return new A.a(75,18,1,1);case "LightningBolt":return new A.a(74,80,1,1);case "Sun":return new A.a(76,81,1,1);case "Moon":return new A.a(77,82,1,.5);case "Cloud":return new A.a(120,83,1,1);case "Arc":return new A.a(88,
84,1,1);case "DoubleBracket":return new A.a(93,85,1,1);case "DoubleBrace":return new A.a(94,86,1,1.17);case "LeftBracket":return new A.a(89,87,1,.08);case "RightBracket":return new A.a(90,88,1,.08);case "LeftBrace":return new A.a(91,89,1,.17);case "RightBrace":return new A.a(92,90,1,.17);case "MathPlus":return new A.a(175,19,1,1);case "MathMinus":return new A.a(176,20,1,1);case "MathMultiply":return new A.a(177,21,1,1);case "MathDivide":return new A.a(178,22,1,1);case "MathEqual":return new A.a(179,
23,1,1);case "MathNotEqual":return new A.a(180,24,1,1);case "StraightConnector":return new A.a(95,12,1,1);case "StraightConnectorArrow":return new A.a(95,13,1,1);case "StraightConnectorTwoArrow":return new A.a(95,14,1,1);case "ElbowConnector":return new A.a(97,26,1,1);case "ElbowArrowConnector":return new A.a(97,155,1,1);case "ElbowDoubleArrowConnector":return new A.a(97,156,1,1);case "CurvedConnector":return new A.a(101,25,1,1);case "CurvedArrowConnector":return new A.a(101,153,1,1);case "CurvedDoubleArrowConnector":return new A.a(101,
154,1,1);case "DownArrow":return new A.a(46,0,1.07,.53);case "LeftArrow":return new A.a(44,1,.53,1.07);case "LeftRightArrow":return new A.a(50,2,.53,1.33);case "RightArrow":return new A.a(43,3,.53,1.07);case "UpArrow":return new A.a(45,4,1.07,.53);case "UpDownArrow":return new A.a(51,5,1.33,.53);case "LeftRightUpArrow":return new A.a(53,27,.93,1.33);case "BentArrow":return new A.a(62,28,.95,.89);case "UTurnArrow":return new A.a(63,29,.96,.97);case "LeftUpArrow":return new A.a(52,30,.93,.93);case "BentUpArrow":return new A.a(49,
31,.8,.93);case "CurvedRightArrow":return new A.a(67,32,1.33,.8);case "CurvedLeftArrow":return new A.a(68,33,1.33,.8);case "CurvedUpArrow":return new A.a(69,34,.8,1.33);case "CurvedDownArrow":return new A.a(70,46,.8,1.33);case "StripedRightArrow":return new A.a(47,35,.53,1.07);case "NotchedRightArrow":return new A.a(48,36,.53,1.07);case "Pentagon":return new A.a(36,37,.53,1.07);case "Chevron":return new A.a(37,38,.53,.53);case "RightArrowCallout":return new A.a(56,39,1,1);case "DownArrowCallout":return new A.a(58,
40,1,1);case "LeftArrowCallout":return new A.a(55,41,1,1);case "UpArrowCallout":return new A.a(57,42,1,1);case "LeftRightArrowCallout":return new A.a(59,43,.63,1.33);case "QuadArrowCallout":return new A.a(61,44,1.33,1.33);case "CircularArrow":return new A.a(64,45,1.07,1.07);case "QuadArrow":return new A.a(54,47,1.33,1.33);case "Rectangle":return new A.a(4,10,1,1);case "RoundedRectangle":return new A.a(25,11,1,1);case "RoundDiagonalCornerRectangle":return new A.a(28,48,1,1);case "RoundSameSideCornerRectangle":return new A.a(27,
49,1,1);case "RoundSingleCornerRectangle":return new A.a(26,50,1,1);case "SnipRoundSingleCornerRectangle":return new A.a(29,51,1,1);case "SnipDiagonalCornerRectangle":return new A.a(32,52,1,1);case "SnipSameSideCornerRectangle":return new A.a(31,53,1,1);case "SnipSingleCornerRectangle":return new A.a(30,54,1,1);case "RectangularCallout":return new A.a(116,91,.67,1);case "RoundedRectangleCallout":return new A.a(117,6,.67,1);case "OvalCallout":return new A.a(118,92,.67,1);case "CloudCallout":return new A.a(119,
93,.67,1);case "LineCallout1":return new A.a(104,94,.67,1);case "LineCallout2":return new A.a(105,95,.67,1);case "LineCallout3":return new A.a(106,96,.67,1);case "LineCallout1Accent":return new A.a(107,97,.67,1);case "LineCallout2Accent":return new A.a(108,98,.67,1);case "LineCallout3Accent":return new A.a(109,99,.67,1);case "LineCallout1BorderAccent":return new A.a(110,100,.67,1);case "LineCallout2BorderAccent":return new A.a(111,101,.67,1);case "LineCallout3BorderAccent":return new A.a(112,102,
.67,1);case "LineCallout1NoBorder":return new A.a(113,103,.67,1);case "LineCallout2NoBorder":return new A.a(114,104,.67,1);case "LineCallout3NoBorder":return new A.a(115,105,.67,1);case "Explosion1":return new A.a(79,106,1,1);case "Explosion2":return new A.a(80,107,1,1);case "Star4":return new A.a(15,108,1,1);case "Star5":return new A.a(16,15,1,1);case "Star6":return new A.a(17,109,1,1);case "Star7":return new A.a(18,110,1,1);case "Star8":return new A.a(19,111,1,1);case "Star10":return new A.a(20,
112,1,1);case "Star12":return new A.a(21,113,1,1);case "Star16":return new A.a(22,114,1,1);case "Star24":return new A.a(23,115,1,1);case "Star32":return new A.a(24,116,1,1);case "UpRibbon":return new A.a(122,117,.67,1.33);case "DownRibbon":return new A.a(121,118,.67,1.33);case "CurvedUpRibbon":return new A.a(124,119,.83,1.33);case "CurvedDownRibbon":return new A.a(123,120,.83,1.33);case "VerticalScroll":return new A.a(126,121,1.25,1.13);case "HorizontalScroll":return new A.a(127,122,1.13,1.25);case "Wave":return new A.a(128,
123,1,1);case "DoubleWave":return new A.a(129,124,1,1);case "Process":return new A.a(131,125,.67,1);case "AlternateProcess":return new A.a(158,126,.67,1);case "Decision":return new A.a(132,127,.67,1);case "Data":return new A.a(133,128,.67,1);case "PredefinedProcess":return new A.a(134,129,.67,1);case "InternalStorage":return new A.a(135,130,.67,.67);case "Document":return new A.a(136,131,.67,1);case "Multidocument":return new A.a(137,132,.83,1.16);case "Terminator":return new A.a(138,133,.33,1);case "Preparation":return new A.a(139,
134,.67,1.16);case "ManualInput":return new A.a(140,135,.5,1);case "ManualOperation":return new A.a(141,136,.67,1);case "Connector":return new A.a(142,137,.5,.5);case "OffpageConnector":return new A.a(159,138,.67,.67);case "Card":return new A.a(143,139,.88,1);case "PunchedTape":return new A.a(144,140,.88,1);case "SummingJunction":return new A.a(145,141,.67,.67);case "Or":return new A.a(146,142,.67,.67);case "Collate":return new A.a(147,143,1,.5);case "Sort":return new A.a(148,144,1,.5);case "Extract":return new A.a(149,
145,.75,.75);case "Merge":return new A.a(150,146,.75,.75);case "StoredData":return new A.a(152,147,.67,1);case "Delay":return new A.a(157,148,.67,.67);case "SequentialActionStorage":return new A.a(153,149,.67,.67);case "MagneticDisk":return new A.a(154,150,.67,1);case "DirectAccessStorage":return new A.a(155,151,.75,1);case "Display":return new A.a(156,152,.67,1);default:return null}}}F.ifb=110;F.hfb=75;Object(y.a)(F,"ODSLShape",null,[871])},1109:function(y,C,a){a.d(C,"a",function(){return n});var c=
a(81);y=a(0);var b=a(1703),d=a(275),e=a(494),h=a(279);class n{constructor(m,k,l,u){this.cF=m;this.sa=k;this.qf=l;this.Jq=u;this.select=({scope:r,index:x=-1})=>Object(c.b)(this,void 0,void 0,function*(){const v=[];var z=null!==r&&void 0!==r?r:"Selection";if("Selection"===z){const A=this.sa.rg();0<A.length&&v.push(...A);0!==v.length||r||(z="Presentation")}if("Presentation"===z&&this.Ld){z=this.Ld.dA.presentation.slides;if(null===z)throw Error("Could not cast from ISlide to ISlide on presentation slides.");
v.push(...z)}return-1!==x&&x<v.length?[v[x]]:v});this.format=()=>Object(c.b)(this,void 0,void 0,function*(){throw Error("Method not implemented.");});this.NYd=r=>r?r.Aj:this.Ld.dA.presentation.b0[0].Id;this.Q_f=r=>{const x=this.Ld.dA.presentation.b0;for(let v=0;v<x.length;v++)if(r===x[v].Id)return x[v].ContentMasters[0].Id;return 0};this.R_f=(r,x)=>{const v=this.Ld.dA.presentation.b0.find(z=>z.Id===x).ContentMasters.find(z=>z.Name===r);if(!v)throw Error("Could not find content master for layout "+
r);return v.Id};this.insert=({slides:r,layout:x})=>Object(c.b)(this,void 0,void 0,function*(){if(!r)throw Error("Could not insert slide due to invalid preceding slides");if(!this.Ld)throw Error("Cannot insert slides without appForOfficeManager instance.");const v=[];for(var z of r){var A=this.NYd(z);const B=x?this.R_f(x,A):this.Q_f(A);A=this.Ld.dA.presentation.JSb(z,null,A,B);v.push(Object(b.a)(d.a,A))}z=[];for(const B of v)z.push(new Promise(G=>h.a.bL(G,B).bind(this)));return Promise.all(z)});this.delete=
({slides:r})=>Object(c.b)(this,void 0,void 0,function*(){if(!r)throw Error.argumentNull("slides");if(!this.Ld)throw Error("Cannot delete slides without appForOfficeManager instance.");for(const x of r){const v=x;v&&!this.qf.Hd(v)&&v.isConnected&&(this.sa.nj(),this.Ld.dA.presentation.jE(v),this.Jq.Unc(new e.a([v])))}return new Promise(x=>h.a.bL(x,this.Ld.dA.presentation).bind(this))});if(!m)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!k)throw Error.argumentNull("m_selectionManager");
if(!l)throw Error.argumentNull("m_actionBlockingManager");if(!u)throw Error.argumentNull("m_graphOperationEventNotifier");this.cF&&this.cF.execute(r=>{this.Ld=r})}}Object(y.a)(n,"ODSLSlide",null,[871])},1110:function(y,C,a){a.d(C,"a",function(){return d});var c=a(81);y=a(0);var b=a(279);class d{constructor(e,h){this.cF=e;this.sa=h;this.select=()=>Object(c.b)(this,void 0,void 0,function*(){throw Error("Method not implemented.");});this.format=()=>Object(c.b)(this,void 0,void 0,function*(){throw Error("Method not implemented.");
});this.insert=({slides:n,imageData:m})=>Object(c.b)(this,void 0,void 0,function*(){if(!n)throw Error.argumentNull("slides");if(!m)throw Error("Could not get imageData in Base64.");if(!this.Ld)throw Error("Cannot insert images without appForOfficeManager instance.");this.t7a(m)&&(m=yield d.tZf(m));const k=[];for(const l of n)this.sa.GR.apply(this.sa,l),this.Ld.iR.XZh(m,!0,null,null,null,null,0,""),k.push(new Promise(u=>b.a.bL(u,l).bind(this)));yield Promise.all(k)});this.delete=()=>Object(c.b)(this,
void 0,void 0,function*(){throw Error("Method not implemented.");});if(!e)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!h)throw Error.argumentNull("m_selectionManager");this.cF&&this.cF.execute(n=>{this.Ld=n})}static tZf(e){return Object(c.b)(this,void 0,void 0,function*(){try{e.startsWith("//")&&(e="https:"+e);const h=yield fetch(e);if(h.ok){const n=yield h.arrayBuffer();return btoa((new Uint8Array(n)).reduce((m,k)=>m+String.fromCharCode(k),""))}}catch(h){}return""})}t7a(e){try{return new URL(e),
!0}catch(h){return!1}}}Object(y.a)(d,"ODSLImage",null,[871])},1111:function(y,C,a){a.d(C,"a",function(){return k});var c=a(81);y=a(0);var b=a(1744),d=a(1745),e=a(52),h=a(40),n=a(63),m=a(763);a.n(m);class k{constructor(l,u,r,x,v,z,A,B){this.sa=l;this.ya=u;this.Tb=r;this.oY=x;this.tka=v;this.khb=z;this.Yod=A;this.Xod=B;if(!this.sa)throw Error.argumentNull("m_selectionManager");if(!this.ya)throw Error.argumentNull("m_graphTopologyManager");if(!this.Tb)throw Error.argumentNull("m_transactionFactory");
if(!this.oY)throw Error.argumentNull("m_odslText");if(!this.tka)throw Error.argumentNull("m_odslShape");if(!this.khb)throw Error.argumentNull("m_odslSlide");if(!this.Yod)throw Error.argumentNull("m_odslTable");if(!this.Xod)throw Error.argumentNull("m_odslImage");}cMh(l){switch(l){case m.ActionRecommendationTrigger.TextSelection:case m.ActionRecommendationTrigger.TextBoxSelection:return this.S6f();default:throw Error.argumentOutOfRange("trigger");}}xGh(l){Object(c.b)(this,void 0,void 0,function*(){const u=
JSON.parse(l),r=this.Tb.xe(15),x=u.scenario;try{if(!x)throw Error("No scenario provided in modelData");r.tc(this.ya.presentation);switch(x){case "textToTable":const v=Object.assign({},u);this.eKf(v);break;case "summarizeText":const z=Object.assign({},u);if(!z.summarizeText)throw Error("No summarizeText provided in modelData");this.zTb(x,z.summarizeText);break;case "rewriteText":const A=Object.assign({},u);if(!A.rewriteText)throw Error("No rewriteText provided in modelData");this.zTb(x,A.rewriteText);
break;case "continueText":const B=Object.assign({},u);if(!B.continueText)throw Error("No continueText provided in modelData");this.zTb(x,B.newWholeText);break;case "slideGeneration":const G=Object.assign({},u);this.kAf(G);break;default:throw Error.argumentOutOfRange("scenario");}}catch(v){h.a.$(509085824,b.a.LUh,d.a.warning,`SmartRecommendation: Exception thrown while applying recommendation. ${v}`)}finally{r&&r.dispose()}})}S6f(){const l=this.sa.zd().map(x=>x.HJ().map(v=>v.characterData).join("\n")).join("\n");
let u="";const r=this.sa.Wa.qb;r&&(u=r.toArray().filter(x=>x.contextId===e.a.textRange).map(x=>x.node.characterData.substring(x.Neb,x.wSb)).join("\n"));return JSON.stringify({shapeText:l,selectedText:u})}eKf(l){Object(c.b)(this,void 0,void 0,function*(){if(!l)throw Error.argumentNull("modelData");if(!l.transformedData)throw Error("No transformedData provided in modelData");if(l.usedData){var u=l.usedData.split("\n");for(var r of u)u=yield this.oY.select({text:r}),yield this.oY.delete({textRanges:u})}else r=
yield this.tka.select({}),yield this.tka.delete({shapes:r});r=yield this.khb.select({});yield this.Yod.insert({slides:r,html:l.transformedData})})}zTb(l,u){Object(c.b)(this,void 0,void 0,function*(){if("summarizeText"===l||"rewriteText"===l)var r=yield this.oY.select({});else"continueText"===l&&(r=yield this.tka.select({}),r=yield this.oY.select({scope:r}));r=yield this.oY.delete({textRanges:r});r=yield this.oY.insert({precededBy:r,text:u});0<r.length&&(r=r[r.length-1],this.sa.setSelection(n.SelectionFactory.Mg(r.node,
r.Mb)))})}kAf(l){Object(c.b)(this,void 0,void 0,function*(){if(!l)throw Error.argumentNull("modelData");var u=yield this.khb.select({});u=yield this.khb.insert({slides:u,layout:"Two Content"});var r=u[0];this.sa.xNa();this.ya.Ia=r;l.title&&(r=yield this.tka.select({scope:u,index:0}),r=yield this.oY.select({scope:r}),yield this.oY.insert({precededBy:r,text:l.title}));if(l.text){r=yield this.tka.select({scope:u,index:1});const x=`<ul>${l.text.map(v=>`<li>${v}</li>`).join("")}</ul>`;yield this.oY.sdh(r[0],
x)}l.image&&(r=(yield this.tka.select({scope:u,index:2}))[0],this.sa.setSelection(n.SelectionFactory.Pk(r)),yield this.Xod.insert({slides:u,imageData:l.image}))})}}Object(y.a)(k,"SmartRecommendations",null,[])},1112:function(y,C){Object.defineProperty(C,"__esModule",{value:!0});C.ActionRecommendationPrompt=void 0;y=C.ActionRecommendationPrompt||(C.ActionRecommendationPrompt={});y.ODSLPPT="ODSLPPT";y.TextToTableAndSmartArtPPT="TextToTableAndSmartArtPPT";y.NextSlidePPT="NextSlidePPT";y.TextGenerationForSelectedTextPPT=
"TextGenerationForSelectedTextPPT";y.TextGenerationForTextBoxPPT="TextGenerationForTextBoxPPT"},1113:function(y,C,a){Object.defineProperty(C,"__esModule",{value:!0});C.ActionRecommendationAnnotation=void 0;const c=a(161);class b{constructor(d){c.SchemaObject.assign(b,this,d)}get metadata(){return this.M_}set metadata(d){this.M_=d}static getTypeName(){return"AugLoop_ActionRecommendation_ActionRecommendationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(d){return c.SchemaObject.matchesTypesFor(d,
[b.getTypeName()])}}C.ActionRecommendationAnnotation=b;b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()}},1114:function(y,C){Object.defineProperty(C,"__esModule",{value:!0});C.ActionRecommendationTrigger=void 0;y=C.ActionRecommendationTrigger||(C.ActionRecommendationTrigger={});y.TextBoxSelection="TextBoxSelection";y.TextSelection="TextSelection"},1115:function(y,C,a){Object.defineProperty(C,"__esModule",{value:!0});C.ActionRecommendationSignal=void 0;const c=a(161);class b{constructor(d){c.SchemaObject.assign(b,
this,d)}static getTypeName(){return"AugLoop_ActionRecommendation_ActionRecommendationSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(d){return c.SchemaObject.matchesTypesFor(d,[b.getTypeName()])}}C.ActionRecommendationSignal=b;b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()}},1120:function(y,C,a){a.d(C,"a",function(){return m});y=a(0);var c=a(1704),b=a(1585),d=a(102),e=a(45),h=a(47),n=a(201);class m{constructor(k,l,u){this.cF=k;this.sa=l;this.La=u;if(!k)throw Error.argumentNull("m_appForOfficeManagerFuture");
if(!l)throw Error.argumentNull("m_selectionManager");if(!u)throw Error.argumentNull("m_shapeReader");this.cF&&this.cF.execute(r=>{this.Ld=r})}L6f(k){if(!k.hasText)return null;const l=this.La.CIb(k).cache;let u;switch(l.vq){case 0:u="None";break;case 1:u="Single";break;case 2:u="Double";break;case 3:u="Heavy";break;case 4:u="Dotted";break;case 5:u="DottedHeavy";break;case 6:u="Dash";break;case 7:u="DashHeavy";break;case 8:u="DashLong";break;case 9:u="DashLongHeavy";break;case 10:u="DotDash";break;
case 11:u="DotDashHeavy";break;case 12:u="DotDotDash";break;case 13:u="DotDotDashHeavy";break;case 14:u="Wavy";break;case 15:u="WavyHeavy";break;case 16:u="WavyDouble";break;default:u="None"}var r=k.HJ()[0],x=new e.GraphIterator;x.set(r);x.sc(11);x.zg(11);x=(x=r.jg.Vv(x))?1===x.listType:!1;switch(h.ParagraphReader.WK(r)){case 1:r="Left";break;case 2:r="Center";break;case 3:r="Right";break;case 7:r="Distributed";break;case 6:r="Justify";break;default:r="Left"}return{text:k.MV(),color:d.a.IF(l.fontColor),
bold:l.isBold,italic:l.isItalic,underline:u,fontName:l.UK,size:l.fontSize/2,bulleted:x,horizontalAlignment:r}}E5f(k,l){const u=k.get_shapeTypeString(),r=k.shapeName;var x=k.PT;const v=c.a.te(x._x,b.a.horizontal);x=c.a.te(x._y,b.a.vertical);var z=k.jX;const A=z.BottomRight.Y-z.TopLeft.Y;z=z.BottomRight.X-z.TopLeft.X;var B=n.a.parse(k.K9);const G=B?B.RGBColor:"";B=B?B.Alpha:-1;let w;switch(k.DA){case 0:w="Dash";break;case 1:w="DashDot";break;case 2:w="DashDotDot";break;case 3:w="LongDash";break;case 4:w=
"LongDashDot";break;case 5:w="RoundDot";break;case 6:w="Solid";break;case 7:w="SquareDot";break;case 8:w="LongDashDotDot";break;case 9:w="SystemDash";break;case 10:w="SystemDot";break;case 11:w="SystemDashDot";break;default:w="None"}const F=k.outlineWidth;var H=n.a.parse(k.U4);const E=H?H.RGBColor:"";H=H?H.Alpha:-1;k=this.L6f(k);return{index:l,textRange:k,type:u,name:r,left:v,top:x,height:A,width:z,lineColor:G,lineDashStyle:w,lineWeight:F,lineTransparency:B,fillColor:E,fillTransparency:H}}S5f(k,l){l=
{index:l,shapes:[]};k=k.Nj();for(let u=0;u<k.length;u++)l.shapes.push(this.E5f(k[u],u));return l}rld(){if(!this.Ld)throw Error("Cannot create contextTree without valid AppForOfficeManager instance.");const k={slides:[],selectionNames:[]};k.slides.push(this.S5f(this.Ld.dA.Ia,0));const l=this.sa.zd();for(const u of l)k.selectionNames.push(u.shapeName);return k}}Object(y.a)(m,"ODSLContext",null,[844])},1151:function(y,C,a){a.d(C,"a",function(){return A});y=a(0);class c{constructor(){this.results=null;
this.totalResultCount=0;this.hasTooManyResults=!1}}Object(y.a)(c,"DocumentContentSearchResults",null,[]);class b{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(B,G,w,F,H){this.selectRange(G,w,F,H)}selectRangeV3(){}search(){}searchV2(B,G){this.search(B,w=>{G(Object.assign(new c,{results:w,totalResultCount:w.length,hasTooManyResults:100<w.length}))})}searchWithParam(B,G){this.search(B.query,G)}searchWithParamV2(B,G){this.searchWithParam(B,w=>{G(Object.assign(new c,{results:w,
totalResultCount:w.length,hasTooManyResults:w.length>B.totalResultLimit}))})}highlight(){}highlightWithParam(B){this.highlight(B.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(y.a)(b,"BaseDocumentContentExecutor",null,[813,875]);class d{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=0;this.authorName=this.authorEmail=null}}Object(y.a)(d,"DocumentContentSearchResult",null,[]);var e=a(132),h=a(41),n=a(64),m=a(21),k=a(92),l=a(47),u=a(62),r=a(405),x=a(570),v=a(44),z=a(90);class A extends b{constructor(B,G,w,F,H,E,P,T,K,
M,N){super();if(!B)throw Error("pageNode is null");if(!G)throw Error("interactiveViewManager is null");if(!w)throw Error("selectionFactory is null");if(!F)throw Error("slideReader is null");if(!H)throw Error("workspace is null");if(!E)throw Error("graphTopologyManager is null");if(!P)throw Error("searchContextFactory is null");if(!T)throw Error("actionManager is null");if(!K)throw Error("selectionManager is null");if(!M)throw Error("clipServiceManager is null");if(!N)throw Error("presentationReader is null");
this.vFg=B;this.qB=G;this.RJb=w;this.qc=F;this.jc=H;this.ya=E;this.HPg=P;this.la=T;this.sa=K;this.wN=M;this.rc=N}getAllParagraphsInDocument(){const B=this.MZb(),G=new m.a;for(const w of B)G.add(A.KZb(w));return G.toArray()}selectRange(B,G,w,F){if(!(0>B||0>G||0>w||0>F||B>w||B===w&&G>F)){var H=this.MZb();H.count<=w||(B=H.ka(B),w=H.ka(w),A.mnd(B,G)&&A.mnd(w,F)&&(H=this.qc.Hg(B),this.ya.Ia!==H&&this.jc.z5e(H,!1),G=this.RJb.Mg(B,G),F=this.RJb.jM(G,u.a.Oj(w,F+1)),this.qB.Msd(this.jc.AJ,F)))}}search(B,G){const w=
new m.a,F=B.toLowerCase();var H=this.MZb();let E=0;for(const T of H){H=A.KZb(T);const K=H.toLowerCase();let M=0;for(;-1<(M=K.indexOf(F,M));){var P=this.HPg.fMf(H,M,M+B.length,"");P=Object.assign(new d,{snippet:P.OJf,startOffsetInSnippet:P.Teh,endOffsetInSnippet:P.Seh-1,paragraphIndex:E,startOffsetInParagraph:M,endOffsetInParagraph:M+B.length-1});w.add(P);M+=B.length}E++}w.Sc((T,K)=>T.paragraphIndex===K.paragraphIndex?T.startOffsetInParagraph-K.startOffsetInParagraph:T.paragraphIndex-K.paragraphIndex);
G(w.toArray())}getSelectedSlidesAsPPTXStream(){const B=this.sa.rg();if(B&&B.length)return this.nld(B);r.ULS.sendTraceTag(509642065,1313,10,"Unable to get selected slides. getAllSelectedSlideNodes returned undefined or empty")}getAllSlidesAsPPTXStream(){const B=this.rc.e1d();if(B&&B.length)return this.nld(B);r.ULS.sendTraceTag(509437598,1313,10,"Unable to get slides in presentaiton. Calling getSortedSlideNodes returnd no slides")}nld(B){var G=this.wN.SCc(1,B.length,!1),w=e.a.create().toString();w=
new x.a(G,w,B);var F=8;F=this.la.Ra(v.a.Ejd,2,w);G.xS=F;w=h.AFrameworkApplication.ha.Ma(z.a.ym);F=n.a.yj(G.Rp);const H=n.a.yj(G.lD);G=n.a.yj(G.Jy);if(F&&H&&G)return{url:`${w}GetClipboardBytes.ashx?Id=${F}&DC=${H}&pkey=${G}&wdwaccluster=${H}&DataType=${1}`,selectedSlideIDs:B.map(E=>E.id.toString())}}MZb(){var B=l.ParagraphReader.qlc(this.vFg.value,!0,!1);const G=new m.a;for(const w of B)B=this.qc.Hg(w),B.qR||B.Ytb||G.add(w);return G}static KZb(B){B=l.ParagraphReader.text(B);return k.AParagraphNode.goc(B,
" ")}static mnd(B,G){B=A.KZb(B);return G<B.length}}Object(y.a)(A,"PPTDocumentContentExecutor",b,[])},1179:function(y,C,a){a.d(C,"a",function(){return z});var c=a(81);y=a(0);var b=a(132),d=a(1586),e;(function(A){A[A.CDm=0]="unattempted";A[A.q3=1]="inProgress";A[A.notHandled=2]="notHandled";A[A.R5l=4]="handleExternally";A[A.failed=8]="failed";A[A.error=16]="error";A[A.succeeded=32]="succeeded";A[A.CXl=64]="delayed"})(e||(e={}));Object(y.b)("ActionResponse",e);var h=a(51),n=a(275),m=a(280),k=a(373),
l=a(163),u=a(279),r=a(1703),x=a(44),v=a(371);class z{constructor(A,B,G,w,F,H,E,P,T,K,M){this.ya=A;this.sa=B;this.zj=G;this.Na=w;this.il=F;this.rw=H;this.zU=E;this.qf=P;this.la=T;this.Do=K;this.c4=M;this.select=({scope:N,index:I=-1})=>Object(c.b)(this,void 0,void 0,function*(){const O=[],Q=[];var U=null!==N&&void 0!==N?N:"Selection";if("Selection"===U){var ba=this.sa.Hm();ba?Q.push(ba):(ba=this.sa.rg(),0<ba.length&&this.c4.qxa(14,ba,O),0!=O.length||N||(U="Presentation"))}if(Array.isArray(U)&&0<U.length&&
U[0]instanceof n.a)this.c4.qxa(14,U,O);else if("Presentation"===U&&this.ya.presentation){U=this.ya.presentation.slides;if(null===U)throw Error("Could not cast from ISlide to ISlide on presentation slides");this.c4.qxa(14,U,O)}Q.push(...O.map(aa=>aa.node));return-1!==I&&I<Q.length?[Q[I]]:Q});this.format=({tables:N,color:I,fillColor:O,styles:Q,cellColor:U,border:ba,borderColor:aa,mergeCells:La,splitCells:Z})=>Object(c.b)(this,void 0,void 0,function*(){var la;let da=!1;var J=!1,Ca=!1;const Fa=[];for(const Ua of N){let Ia=
this.sa.Pr();1===N.length&&Ia&&0<Ia.length?da=!0:Ia=Ua.u5a();Ia.filter(Oa=>!Oa.isGhostCell);var ya=this.p6f(null!==(la=null!==Q&&void 0!==Q?Q:O)&&void 0!==la?la:I);ya&&0<ya.length&&Ua.setValue(h.a.foa,b.a.Vf(ya));if(U&&k.a.cjd(U)&&!J){J=this.k_b(U);for(const Oa of Ia)ya=Oa.cellShading,m.b(ya),ya.solidFillField=J,Oa.cellShading=ya;J=da&&1===N.length}if((ba||aa)&&!Ca){if(ba)Ca=aa&&k.a.cjd(aa)?this.k_b(aa):void 0,this.la.Ra(x.a.T9,d.a.execute,{["TableNode"]:Ua,["CellNodes"]:Ia,["SourceControlId"]:this.uOa(ba),
["BorderColor"]:Ca,["DoNotCreateTransaction"]:!0});else{Ca=k.a.w$(aa);this.la.Ra(x.a.yxa,d.a.execute,{["TableNode"]:Ua,["Color"]:Ca});Ca=this.k_b(aa);for(const Oa of Ia)l.Box4ColorHelper.hCa(Oa.Xua)||(Oa.Xua=Ca),l.Box4ColorHelper.hCa(Oa.R9)||(Oa.R9=Ca),l.Box4ColorHelper.hCa(Oa.Wua)||(Oa.Wua=Ca),l.Box4ColorHelper.hCa(Oa.S9)||(Oa.S9=Ca)}Ca=da&&1===N.length}(La||Z)&&da&&this.la.Ra(La?x.a.mergeTableCells:x.a.splitTableCells,d.a.execute,{["rows"]:1,["columns"]:2});Fa.push(new Promise(Oa=>u.a.bL(Oa,Ua,
!0).bind(this)))}yield Promise.all(Fa)});this.hdg=N=>{N=Object.assign(new v.a,{Nua:!1,rga:[N]});if(this.la.Ra(x.a.Pna,d.a.execute,N)!==e.succeeded)throw Error("Table insertion from HTML failed.");return this.sa.Uo()};this.jdg=(N,I,O)=>{const Q=[];if(!I||Number.isNaN(I)||!O||Number.isNaN(O))throw Error("Invalid rows and columns provided.");this.sa.Rx();this.sa.nj();this.Na.ee();for(const ba of N){N=ba;if(!N)throw Error("Cannot find selected slide to insert table.");if(!this.qf.Hd(N)){if(!this.zj.KD(N,
1))throw this.zj.qJ(N),Error("Too many shapes on the slide.");var U=N.fc;U=N.a1(U.sid,U.cid,0,I,O,N.Av());Q.push(U);this.Do.EO([U],N,null);this.rw.MJ=U}}return Q};this.insert=({slides:N,rows:I,columns:O,html:Q})=>Object(c.b)(this,void 0,void 0,function*(){if(!N)throw Error("No slide context provided to insert table.");const U=[];Q?U.push(this.hdg(Q)):U.push(...this.jdg(N,I,O));const ba=[];for(const aa of U)ba.push(new Promise(La=>u.a.bL(La,aa,!0).bind(this)));return Promise.all(ba)});this.delete=
({tables:N})=>Object(c.b)(this,void 0,void 0,function*(){if(!N)throw Error.argumentNull("tables");for(const Q of N){var I=this.sa.Uo();I&&I.gd&&this.qf.Hd(I)||(I=Object(r.a)(351,Q),this.il.HWb(I))}const O=this.ya.Ia;O&&this.qf.wy(O,"handleDeleteTable");return new Promise(Q=>u.a.bL(Q,O).bind(this))});if(!A)throw Error.argumentNull("m_graphTopologyManager");if(!B)throw Error.argumentNull("m_selectionManager");if(!G)throw Error.argumentNull("m_shapeCountValidator");if(!w)throw Error.argumentNull("m_focusManager");
if(!F)throw Error.argumentNull("m_shapeEditor");if(!H)throw Error.argumentNull("m_ribbonChangeManager");if(!E)throw Error.argumentNull("m_tableStyleGalleryManager");if(!P)throw Error.argumentNull("m_actionBlockingManager");if(!T)throw Error.argumentNull("m_actionManager");if(!K)throw Error.argumentNull("m_transactionHelper");if(!M)throw Error.argumentNull("m_odslGraphUtils");}V6f(){var A=this.sa.rg();return A&&0!=A.length?(A=A[0])?A.Ve:null:null}x_f(A,B){A=k.a.old(A);return(Math.abs(A.r-B.r)^2)+(Math.abs(A.g-
B.g)^2)+(Math.abs(A.b-B.b)^2)}p6f(A){if(!A)return"";var B=A.toLowerCase();this.zU.Ckd();A=this.zU.glc();if(!A||!A.length)return"";if(B.includes("transparent")||B.includes("none")){var G=A[0].Gh(h.a.tableStyle);return G.YN?G.YN.styleIdField:""}B=k.a.w$(B);if(!B.length)return"";const w=this.V6f();if(!w)return"";let F=999999,H="";for(let P=0;7>P;++P){const T=A[P].Gh(h.a.tableStyle);if(!T.YN)continue;var E=null!==(G=T.YN.firstRowField)&&void 0!==G?G:T.YN.wholeTblField;if(!E||!E.tcStyleField)continue;
E=E.tcStyleField.fillField;if(!E||E.noFillField)continue;let K;E.solidFillField?K=l.Box4ColorHelper.WF(l.Box4ColorHelper.paa(E.solidFillField),w):E.gradFillField&&(K=m.f(E.gradFillField,w).stops[0].color);K&&(E=this.x_f(B,K),E<=F&&(F=E,H=T.YN.styleIdField))}return H}k_b(A){const B={};B.Color=k.a.w$(A);return l.Box4ColorHelper.JR(B)}uOa(A){A=A.toLowerCase();if(A.includes("no"))return"TableBordersNoBorder";if(!A.includes("all")){if(A.includes("outside"))return"TableBordersOutsideBorders";if(A.includes("horizontal"))return"TableBordersInsideHorizontalBorder";
if(A.includes("vertical"))return"TableBordersInsideVerticalBorder";if(A.includes("inside"))return"TableBordersInsideBorders";if(A.includes("top"))return"TableBordersTopBorder";if(A.includes("bottom"))return"TableBordersBottomBorder";if(A.includes("left"))return"TableBordersLeftBorder";if(A.includes("right"))return"TableBordersRightBorder";if(A.includes("up"))return"TableBordersDiagonalUpBorder";if(A.includes("down"))return"TableBordersDiagonalDownBorder";if(A.includes("diagonal"))return"TableBordersDiagonalUpBorder"}return"TableBordersAllBorders"}}
Object(y.a)(z,"ODSLTable",null,[871])},1227:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(y.a)(c,"InsightsParameters",null,[])},1585:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);var c;(function(b){b[b.horizontal=0]="horizontal";b[b.vertical=1]="vertical"})(c||(c={}));Object(y.b)("Orientation",c)},161:function(y,C,a){a.r(C);a.d(C,"AnnotationState",function(){return c});a.d(C,"OperationErrorCode",
function(){return h});a.d(C,"ItemOperation",function(){return d});a.d(C,"ItemChanges",function(){return e});a.d(C,"EntryPoint",function(){return b});a.d(C,"ecsMetadataBlockHeight",function(){return 512});a.d(C,"ecsMetadataBlockWidth",function(){return 32});a.d(C,"BlobRefType",function(){return n});a.d(C,"OpenType",function(){return m});a.d(C,"GridConstants",function(){return k});a.d(C,"Annotation",function(){return u});a.d(C,"BinaryClassificationAnnotation",function(){return r});a.d(C,"Event",function(){return x});
a.d(C,"UserCommand",function(){return v});a.d(C,"ItemDelta",function(){return z.f});a.d(C,"ItemChangesDelta",function(){return z.e});a.d(C,"Operation",function(){return z.i});a.d(C,"OperationWithSiblingContext",function(){return z.j});a.d(C,"AddOperation",function(){return z.a});a.d(C,"MoveOperation",function(){return z.h});a.d(C,"UpdateAnnotationMetaDataOperation",function(){return z.n});a.d(C,"UpdateOperation",function(){return z.o});a.d(C,"DeleteOperation",function(){return z.b});a.d(C,"PurgeOperation",
function(){return z.k});a.d(C,"PurgeSubtreeOperation",function(){return z.l});a.d(C,"FocusOperation",function(){return z.d});a.d(C,"VisibilityOperation",function(){return z.p});a.d(C,"DeltaUpdateOperation",function(){return z.c});a.d(C,"MicroSyncOperation",function(){return z.g});a.d(C,"SignalOperation",function(){return z.m});a.d(C,"SchemaObject",function(){return l.a});a.d(C,"Signal",function(){return A});a.d(C,"DirtyAreaSignal",function(){return B});a.d(C,"Blob",function(){return G});a.d(C,"Binary",
function(){return w});a.d(C,"TileGroup",function(){return F});a.d(C,"Session",function(){return H});a.d(C,"Document",function(){return E});a.d(C,"SubDocument",function(){return P});a.d(C,"GridCell",function(){return T});a.d(C,"GridNeighborhoodContext",function(){return K});a.d(C,"ItemFilter",function(){return M});a.d(C,"DynamicContext",function(){return N});a.d(C,"ContextHolder",function(){return I});a.d(C,"UserContextHolder",function(){return O});a.d(C,"TenantContextHolder",function(){return Q});
a.d(C,"EventsHolder",function(){return U});a.d(C,"UserCommandsHolder",function(){return ba});var c;(function(aa){aa[aa.Undefined=0]="Undefined";aa[aa.Created=10]="Created";aa[aa.Sent=20]="Sent";aa[aa.Duplicated=30]="Duplicated";aa[aa.Seen=40]="Seen";aa[aa.Tried=50]="Tried";aa[aa.Kept=60]="Kept";aa[aa.Rejected=70]="Rejected"})(c||(c={}));var b;(function(aa){aa.Canvas="Canvas";aa.CopilotChat="CopilotChat";aa.Test="Test"})(b||(b={}));var d;(function(aa){aa[aa.None=0]="None";aa[aa.Added=1]="Added";aa[aa.Updated=
2]="Updated";aa[aa.Deleted=3]="Deleted"})(d||(d={}));var e;(function(aa){aa[aa.ContentChanged=0]="ContentChanged";aa[aa.ContentWasEmpty=1]="ContentWasEmpty";aa[aa.FormattingChanged=2]="FormattingChanged";aa[aa.ContentWasInsideOfTheTable=3]="ContentWasInsideOfTheTable"})(e||(e={}));var h;(function(aa){aa[aa.AddOfZeroElements=0]="AddOfZeroElements";aa[aa.AddOfItemsWithExtraOrMissingIds=1]="AddOfItemsWithExtraOrMissingIds";aa[aa.AddOfItemWithUndefinedId=2]="AddOfItemWithUndefinedId";aa[aa.AddOfUndefinedItem=
3]="AddOfUndefinedItem";aa[aa.AddOfItemsWithDuplicateIds=4]="AddOfItemsWithDuplicateIds";aa[aa.SetHeadToNonExistingItem=5]="SetHeadToNonExistingItem";aa[aa.DeleteOfNonExistingItem=6]="DeleteOfNonExistingItem";aa[aa.UpdateOfNonExistentItem=7]="UpdateOfNonExistentItem";aa[aa.UpdateOfStubbedItem=8]="UpdateOfStubbedItem";aa[aa.MoveOfNonExistentItem=9]="MoveOfNonExistentItem";aa[aa.UpdateMetaDataOfNonAnnotationType=10]="UpdateMetaDataOfNonAnnotationType";aa[aa.SequentialyInvertedUpdate=11]="SequentialyInvertedUpdate";
aa[aa.MoveToTheSamePath=12]="MoveToTheSamePath";aa[aa.DeltaOfNonExistingItem=100]="DeltaOfNonExistingItem"})(h||(h={}));var n;(function(aa){aa[aa.None=0]="None";aa[aa.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl";aa[aa.AlCodedLocation=2]="AlCodedLocation";aa[aa.Token=3]="Token"})(n||(n={}));var m;(function(aa){aa[aa.NewDocument=0]="NewDocument";aa[aa.EditDocument=1]="EditDocument";aa[aa.ViewOnlyDocument=2]="ViewOnlyDocument"})(m||(m={}));class k{}k.lowerIndexBound=1;k.maxNumberOfRows=1048576;k.maxNumberOfColumns=
16384;k.firstColumnName="A";k.lastColumnName="XFD";var l=a(210);class u{get metadata(){return this.M_}set metadata(aa){this.M_=aa}constructor(aa){l.a.assign(u,this,aa)}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(aa){this.M_=aa}constructor(aa){l.a.assign(r,this,aa)}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,
[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class x{constructor(aa){l.a.assign(x,this,aa)}static getTypeName(){return"AugLoop_Core_Event"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class v{constructor(aa){l.a.assign(v,this,aa)}static getTypeName(){return"AugLoop_Core_UserCommand"}static getBaseTypes(){return["AugLoop_Core_Event"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,
[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};var z=a(464);class A{constructor(aa){l.a.assign(A,this,aa)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class B{constructor(aa){l.a.assign(B,this,aa)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,
[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class G{constructor(aa){l.a.assign(G,this,aa)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[G.getTypeName()])}}G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()};class w{constructor(aa){l.a.assign(w,this,aa)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[w.getTypeName()])}}
w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class F{constructor(aa){l.a.assign(F,this,aa)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class H{constructor(aa){l.a.assign(H,this,aa)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[H.getTypeName()])}}
H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class E{constructor(aa){l.a.assign(E,this,aa)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class P{constructor(aa){l.a.assign(P,this,aa)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[P.getTypeName()])}}
P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class T{constructor(aa){l.a.assign(T,this,aa)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class K{constructor(aa){l.a.assign(K,this,aa)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[K.getTypeName()])}}
K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};class M{constructor(aa){l.a.assign(M,this,aa)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class N{constructor(aa){l.a.assign(N,this,aa)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[N.getTypeName()])}}N.H_=
{T_:N.getTypeName(),B_:N.getBaseTypes()};class I{constructor(aa){l.a.assign(I,this,aa)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[I.getTypeName()])}}I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class O{constructor(aa){l.a.assign(O,this,aa)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,
[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class Q{constructor(aa){l.a.assign(Q,this,aa)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[Q.getTypeName()])}}Q.H_={T_:Q.getTypeName(),B_:Q.getBaseTypes()};class U{constructor(aa){l.a.assign(U,this,aa)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(aa){return l.a.matchesTypesFor(aa,
[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class ba{constructor(aa){l.a.assign(ba,this,aa)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(aa){return l.a.matchesTypesFor(aa,[ba.getTypeName()])}}ba.H_={T_:ba.getTypeName(),B_:ba.getBaseTypes()}},1642:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);class c{constructor(d,e,h,n){this.Fdf=d;this.Dqf=e;this.Cqf=h;this.Eqf=n}get OJf(){return this.Fdf}get Teh(){return this.Dqf}get Seh(){return this.Cqf}get resultType(){return this.Eqf}}
Object(y.a)(c,"SearchContext",null,[944]);class b{fMf(d,e,h,n){var m=h-e;let k;if(100<=m)m=e,k=h;else{m=Math.max(0,e+Math.ceil(m/2)-50);k=Math.min(d.length,m+100);m=Math.max(0,k-100);let u;if(m&&" "!==d.charAt(m-1)){u=Math.min(e,m+10);for(var l=m;l<u;++l)if(" "===d.charAt(l)){m=l+1;break}}if(k!==d.length&&" "!==d.charAt(k))for(u=Math.max(h,k-10),l=k-1;l>=u;--l)if(" "===d.charAt(l)){k=l;break}}return new c(d.substring(m,k),e-m,h-m,n)}}Object(y.a)(b,"SearchContextFactory",null,[928])},1900:function(y,
C,a){a.r(C);var c=a(0),b=a(38),d=a(1642),e=a(41),h=a(289),n=a(124),m=a(95),k=a(50);const l=()=>k.a.instance.Db("Common.App.SearchCommon.SearchHostRuntime"),u=()=>k.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),r=()=>k.a.instance.Db("Common.App.Insights.SmartLookupVersion");var x=a(172),v=a(837),z=a(1432),A=a(21);class B{constructor(){k.a.instance.eb("Common.App.SearchCommon.SearchHostRuntime").execute(()=>{})}}Object(c.a)(B,"DocumentContentExtractionManager",null,[881]);var G=a(405),
w=a(6),F=a(1187),H=a(59);class E{}E.$fo="mso_smartLookup";E.channelId="SmartLookup";E.Zfo="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";E.NAm="https://uci.edog.cdn.office.net/mirrored/smartlookup/";E.OAm="https://uci.cdn.office.net/mirrored/smartlookup/";E.Yfo="https://hedwigtestserver.blob.core.windows.net/builds/";E.Xfo="http://localhost:8080/";E.Ooh="current";E.MAm="next";E.QVn=2;E.Z1e=Object(H.a)("SmartLookupPaneTitle");E.JZa="InsightsTaskPane";E.width=400;E.hCm="appCorrelationId";
E.iCm="message";Object(c.a)(E,"InsightsConstants",null,[]);var P=a(1227),T=a(232),K=a(158);class M{}Object(c.a)(M,"ActivityContractInfo",null,[]);class N{}Object(c.a)(N,"BrowserPaneDataField",null,[]);class I{}Object(c.a)(I,"BrowserPaneTelemetryEvent",null,[]);var O=a(143),Q=a(231),U=a(173);class ba{static MT(Pc,Yc){const Bd=new I;Bd.eventName="Diagnostics";Bd.isActivity=!1;Bd.activityContract=Object.assign(new M,{success:!0});const Dd=[],Sd=new N;Sd.name="Message";Sd.dataType=0;Sd.value=Pc;Pc=new N;
Pc.name="Level";Pc.dataType=0;Pc.value=ba.qin(Yc);Array.add(Dd,Sd);Array.add(Dd,Pc);Bd.dataFields=Dd;ba.sendTelemetryEvent(Bd)}static xGa(Pc,Yc){const Bd=new I;Bd.eventName=Pc;Bd.isActivity=!1;Bd.activityContract=Object.assign(new M,{success:!0});Pc=[];const Dd=new N;Dd.name="AppCorrelationId";Dd.dataType=0;Dd.value=Yc;Array.add(Pc,Dd);Bd.dataFields=Pc;ba.sendTelemetryEvent(Bd)}static i$n(Pc,Yc,Bd,Dd,Sd,He){const ge=new I;ge.eventName="LaunchPaneWithError";ge.isActivity=!1;ge.activityContract=Object.assign(new M,
{success:!0});const ve=[],ze=new N;ze.name="IsNetworkConnected";ze.dataType=0;ze.value=Pc?"true":"false";Pc=new N;Pc.name="IsHostruntimeAvailable";Pc.dataType=0;Pc.value=Yc?"true":"false";Yc=new N;Yc.name="EntryPoint";Yc.dataType=0;Yc.value=Bd;Bd=new N;Bd.name="RuntimeVersion";Bd.dataType=0;Bd.value=Dd;Dd=new N;Dd.name="IsFirstRelease";Dd.dataType=1;Dd.value=Sd?"true":"false";Sd=new N;Sd.name="IsZeroTerm";Sd.dataType=1;Sd.value=He?"true":"false";He=new N;He.name="IsClientSideRendering";He.dataType=
1;He.value="false";Array.add(ve,ze);Array.add(ve,Yc);Array.add(ve,Pc);Array.add(ve,Bd);Array.add(ve,Dd);Array.add(ve,Sd);Array.add(ve,He);ge.dataFields=ve;ba.sendTelemetryEvent(ge)}static y7k(Pc,Yc,Bd){const Dd=new I;Dd.eventName="CDNDownloadLatency";Dd.isActivity=!0;Dd.activityContract=Object.assign(new M,{duration:Bd,success:!0});Bd=[];const Sd=new N;Sd.name="CDNHostname";Sd.dataType=0;Sd.value=Pc;Pc=new N;Pc.name="Filename";Pc.dataType=0;Pc.value=Yc;Array.add(Bd,Sd);Array.add(Bd,Pc);Dd.dataFields=
Bd;ba.sendTelemetryEvent(Dd,1)}static bih(Pc,Yc,Bd,Dd,Sd,He,ge,ve){const ze=new I;ze.eventName="LaunchPane";ze.isActivity=!0;ze.activityContract=Object.assign(new M,{duration:Yc,success:!0});Yc=[];const bf=new N;bf.name="AppCorrelationId";bf.dataType=0;bf.value=Pc;Pc=new N;Pc.name="EntryPoint";Pc.dataType=0;Pc.value=Bd;Bd=new N;Bd.name="IsServerSideRendering";Bd.dataType=1;Bd.value="true";const Of=new N;Of.name="UxVersion";Of.dataType=0;Of.value=Dd;Dd=new N;Dd.name="FeatureGates";Dd.dataType=0;Dd.value=
Sd;Sd=new N;Sd.name="IsFirstRelease";Sd.dataType=1;Sd.value=He?"true":"false";He=new N;He.name="IsZeroTerm";He.dataType=1;He.value=ge?"true":"false";ge=new N;ge.name="IsClientSideRendering";ge.dataType=1;ge.value=ve?"true":"false";Array.add(Yc,bf);Array.add(Yc,Pc);Array.add(Yc,Bd);Array.add(Yc,Of);Array.add(Yc,Dd);Array.add(Yc,Sd);Array.add(Yc,He);Array.add(Yc,ge);ze.dataFields=Yc;ba.sendTelemetryEvent(ze)}static sendTelemetryEvent(Pc,Yc=2){if(Pc.isFeedbackActivity)ba.QBn(Pc.eventName);else{var Bd=
-1<Pc.eventName.indexOf(ba.gCm)?Pc.eventName:ba.gCm+Pc.eventName,Dd=ba.Vfn(Pc.dataFields);Pc.isActivity?(Pc=Object.assign(new Q.a,{name:Bd,samplingPolicy:Yc,dataFields:Dd,succeeded:Pc.activityContract.success,durationMs:Pc.activityContract.duration}),O.a.sendActivityEvent(Pc)):(Pc=Object.assign(new U.a,{name:Bd,samplingPolicy:Yc,dataFields:Dd}),O.a.sendTelemetryEvent(Pc))}}static qin(Pc){switch(Pc){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static Vfn(Pc){const Yc=[];if(Pc&&
0<Pc.length)for(const Bd of Pc)(Pc=K.a.yfa(Bd.name,Bd.value,ba.h3m(Bd.dataType)))&&Array.add(Yc,Pc);return Yc}static h3m(Pc){switch(Pc){case 0:return 2;case 1:return 1;case 2:return 3;case 3:return 4;default:return 0}}static QBn(Pc){const Yc=Object(T.b)();Yc?Yc.logActivity(Pc,null):G.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}ba.gCm="Office.Insights.SmartLookup.";Object(c.a)(ba,"TelemetryUtils",null,[]);var aa=a(845),La=a(497),Z=a(765),la=a(247),da=a(15),J=
a(132);class Ca{static EIa(Pc,Yc,Bd,Dd,Sd,He){if(1===Bd)return la.SessionStatusManager.instance.kja?32:8;if(Sd.value.Fdo())return ba.MT("Skipping Serplet launch",10),32;Yc=He;if(!Yc)return 8;Pc=Ca.NXd();if(Bd=Yc.CommandValueId)try{Yc=da.a(Bd)}catch(ge){return G.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",Bd),8}Bd=Yc;Yc.selection||(Yc.neighborhood?Bd=Object.assign(new La.a,{selection:Yc}):(Yc=Sd.value.NZd(),Bd.selection=Object.assign(new Z.a,
{neighborhood:Yc.neighborhood,mentionStart:Yc.mentionStart,mentionLength:Yc.mentionLength})));Bd.selection.clientDetectedLanguage=null;return Ca.eWe(He,null,Bd,Pc,0,Sd)}static eWe(Pc,Yc,Bd,Dd,Sd,He){const ge={};ge.controlId=Pc?Pc.SourceControlId:"shortcut";Bd&&(ge.entryPoint=aa.a[Bd.entryPoint]);G.ULS.sendTraceTag(594044172,1303,50,Ca.CYb("Show insights",Dd,ge));Yc?He.value.Ieo(Yc,Dd,Sd):Bd&&(e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",!1)?He.value.Udo(Bd,
Dd):He.value.Jeo(Bd,Dd,Sd));return 32}static CYb(Pc,Yc,Bd=null){Pc={["appCorrelationId"]:Yc,["message"]:Pc};if(Bd)for(const Dd in Bd)Pc[Dd]=Bd[Dd];return da.c(Pc)}static NXd(){return J.a.create().toString()}}Object(c.a)(Ca,"InvokingPaneUtils",null,[]);class Fa{}Object(c.a)(Fa,"LaunchDataInDoc",null,[]);class ya{}Object(c.a)(ya,"LaunchDataPasteAsSlide",null,[]);class Ua{}Object(c.a)(Ua,"LaunchDataSlidesCompression",null,[]);var Ia=a(628),Oa=a(187),ma=a(75),za=a(498),Qa=a(99),Xa=a(85),Tb=a(98),Kb=a(616),
nb=a(57);class Ka{constructor(Pc,Yc,Bd,Dd,Sd,He,ge,ve,ze){this.Sef=this.Mgd=this.GE=null;this.dJc=bf=>{this.GE||3!==bf.state||(this.GE=bf,this.Mgd=this.GE.aga)};this.s5=Pc;this.Aa=Yc||e.AFrameworkApplication.ub;this.HX=Bd;this.Fe=Dd;this.jLl=ve;this.Zgd=Sd;this.Ga=He;this.Ce=ge;this.Wun();this.jOb=new b.a(()=>new Ia.a(ze.value,this.dJc))}Kb(){this.Aa.Ba(nb.a.K8l,Tb.a.frame,Object(w.a)(this,this.Feo,"showInsights"));this.Aa.Ba(nb.a.M8l,Tb.a.frame,Object(w.a)(this,this.Heo,"showInsightsForTellMe"));
this.Aa.Ba(nb.a.definitions,Tb.a.frame,Object(w.a)(this,this.jeo,"showDefinitions"));this.Aa.Ba(nb.a.AXl,Tb.a.frame,Object(w.a)(this,this.keo,"showDefinitionsForTellMe"));this.Aa.Ba(nb.a.J_h,Tb.a.frame,Object(w.a)(this,this.J_h,"showInsightsForSuggestion"));this.jLl&&(this.Aa.Ba(nb.a.GYe,Tb.a.frame,Object(w.a)(this,this.EIa,"invokeSmartLookupPane")),this.Aa.Ba(nb.a.YNh,Tb.a.frame,Object(w.a)(this,this.YNh,"invokeInDocSerplet")),this.Aa.Ba(nb.a.IYe,Tb.a.frame,Object(w.a)(this,this.IYe,"invokeSerpletRibbon")),
this.Aa.Ba(nb.a.HYe,Tb.a.frame,Object(w.a)(this,this.HYe,"invokeSerpletContextMenu")),this.Aa.Ba(nb.a.bOh,Tb.a.frame,Object(w.a)(this,this.bOh,"invokeSerpletTellMeZeroTerm")),this.Aa.Ba(nb.a.aOh,Tb.a.frame,Object(w.a)(this,this.aOh,"invokeSerpletTellMeNotes")),this.Aa.Ba(nb.a.XNh,Tb.a.frame,Object(w.a)(this,this.XNh,"invokeImageSerpletContextMenu")),this.Aa.Ba(nb.a.KYe,Tb.a.frame,Object(w.a)(this,this.KYe,"invokeSynonymsSerpletContextMenu")),this.Aa.Ba(nb.a.WNh,Tb.a.frame,Object(w.a)(this,this.WNh,
"invokeDictionarySerpletContextMenu")),this.Aa.Ba(nb.a.cOh,Tb.a.frame,Object(w.a)(this,this.cOh,"invokeZeroTermSerpletContextMenu")),this.Aa.Ba(nb.a.VNh,Tb.a.frame,Object(w.a)(this,this.VNh,"invokeDefinitionSearchFromFloatie")),this.Aa.Ba(nb.a.Rdg,Tb.a.frame,Object(w.a)(this,this.Rdg,"invokeSerpletBrowseFiles")),this.Aa.Ba(nb.a.ZNh,Tb.a.frame,Object(w.a)(this,this.ZNh,"invokeInDocSerpletWithLaunchData")),this.Aa.Ba(nb.a.CXh,Tb.a.frame,Object(w.a)(this,this.CXh,"queryToggleSerplet")),this.Aa.Ba(nb.a.LZh,
Tb.a.frame,Object(w.a)(this,this.LZh,"setInDocSearchParameter")),this.Aa.Ba(nb.a.JYe,Tb.a.frame,Object(w.a)(this,this.JYe,"invokeSerpletSlidesCompression")),this.Aa.Ba(nb.a.$Nh,Tb.a.frame,Object(w.a)(this,this.$Nh,"invokeSerpletPasteAsNewSlide")),e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.Aa.Ba(nb.a.Y8l,Tb.a.frame,Object(w.a)(this,this.Xvn,"invokeSmartLookupPaneConversations")),this.Aa.Ba(nb.a.UNh,Tb.a.frame,Object(w.a)(this,
this.UNh,"invokeAutoLaunchSearchRequest"))),this.R4n().continueWith(()=>{e.AFrameworkApplication.Ha&&e.AFrameworkApplication.Ha.fg(!0)}))}gPl(){this.Aa.ua(nb.a.Kmd,Tb.a.frame,Object(w.a)(this,this.Kmd,"invokeFilesSerplet"),4);this.Aa.ua(nb.a.AMj,Tb.a.frame,Object(w.a)(this,this.Kmd,"invokeFilesSerplet"),4);this.Aa.ua(nb.a.CMj,Tb.a.frame,Object(w.a)(this,this.Uvn,"invokeLinkFilesSerplet"),4);if(this.Ga.getBooleanAppSetting("IsTellMeUpSellEnterpriseEnabled")&&this.Ga.getBooleanAppSetting("SmartLookupTokenPrefetchIsEnabled")){const Pc=
Qa.a.Mjd(1,0,Object(w.a)(this,this.trm,"prefetchToken"),0,177);this.Ce.Rb(Pc)}}hsi(){ma.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.Aa.Ba(nb.a.Kmd,Tb.a.frame,Object(w.a)(this,this.BMj,"invokeFilesSerpletUnavailable")),this.Aa.Ba(nb.a.AMj,Tb.a.frame,Object(w.a)(this,this.BMj,"invokeFilesSerpletUnavailable")),this.Aa.Ba(nb.a.CMj,Tb.a.frame,Object(w.a)(this,this.BMj,"invokeFilesSerpletUnavailable")))}trm(Pc){G.ULS.sendTraceTag(579352786,
1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",Pc.interval,!!Pc.data);this.Udb().then(Yc=>{let Bd=1;if(Yc)G.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.i8k("SmartLookupFiles: Token prefetch succeeded",!0),Yc=6E4*this.Ga.Ac("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{G.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.i8k("SmartLookupFiles: Token prefetch failed",!1);Bd=parseInt(Pc.data||
"1");if(Bd>this.Ga.Ac("SmartLookupTokenRenewalRetryThreshold",5)){G.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.i8k("SmartLookupFiles: Token prefetch max retry count reached",!1);return}Yc=6E4*this.Ga.Ac("SmartLookupTokenRetryWaitDurationInMinutes",10);Bd++}Yc=new Qa.a(3,1,Yc,Object(w.a)(this,this.trm,"prefetchToken"),177);Yc.data=Bd.toString();this.Ce.Rb(Yc)})}i8k(Pc="",Yc=!1){this.Zgd.execute(Bd=>{Bd&&Bd.r5e("PrefetchToken",Yc,0,"SmartLookup",
Pc)})}Udb(){return this.Zgd?new Promise(Pc=>{this.Zgd.execute(Yc=>{if(Yc){var Bd=Date.now();Yc.getToken("SmartLookup",this.Ga.Ma("SmartLookupShredderServiceEndpoint")).then(Dd=>{Pc(!!Dd&&0<Dd.length);Yc.r5e("TryGetTokenInternal",!!Dd&&0<Dd.length,Date.now()-Bd,"SmartLookup")})}else Pc(!1)})}):Promise.resolve(!1)}R4n(){const Pc=new F.a;if(this.Ga.getBooleanAppSetting("BrowserSupportsInsightsPaneSSO"))this.gPl(),Pc.lj(!0);else{if(!this.Zgd)return G.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),
Pc.lj(!1),this.hsi(),Pc.task;this.Zgd.execute(Yc=>{Yc?Yc.getToken("SmartLookup",this.Ga.Ma("SmartLookupShredderServiceEndpoint")).then(Bd=>{G.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!Bd&&0<Bd.length);Bd&&0<Bd.length?(this.gPl(),Pc.lj(!0)):this.hsi()}):(G.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),Pc.lj(!1),this.hsi())})}return Pc.task}Feo(Pc,Yc,Bd,Dd,Sd){if(1===Bd)return e.AFrameworkApplication.Ha&&e.AFrameworkApplication.ha.getBooleanAppSetting("OneNoteDelayLoadContextActivationManager")&&
!e.AFrameworkApplication.VUe?8:this.s5.value.W9l()?32:8;Pc=Ca.NXd();Yc=this.s5.value.NZd();return this.jLl?(Yc=Object.assign(new Z.a,{neighborhood:Yc.neighborhood,mentionStart:Yc.mentionStart,mentionLength:Yc.mentionLength}),Yc=Object.assign(new La.a,{selection:Yc,userIntent:null,entryPoint:0,launchData:Object.assign(new za.a,{landingTab:"All"})}),Ca.eWe(Sd,null,Yc,Pc,0,this.s5)):Ca.eWe(Sd,Yc,null,Pc,0,this.s5)}jeo(Pc,Yc,Bd,Dd,Sd){if(1===Bd)return this.s5.value.W9l()?32:8;Pc=Ca.NXd();Yc=this.s5.value.NZd();
return Ca.eWe(Sd,Yc,null,Pc,1,this.s5)}Heo(Pc,Yc,Bd,Dd,Sd){return 1===Bd?32:this.y_l(Sd,0)}keo(Pc,Yc,Bd,Dd,Sd){return 1===Bd?32:this.y_l(Sd,1)}y_l(Pc,Yc){const Bd=Ca.NXd(),Dd=Pc.CommandValueId;let Sd;try{Sd=da.a(Dd)}catch(He){return G.ULS.sendTraceTag(6295941,1303,15,Ca.CYb(String.format("Insights parameters [{0}] is not in proper format.",Dd),Bd)),8}return Ca.eWe(Pc,Sd,null,Bd,Yc,this.s5)}J_h(Pc,Yc,Bd,Dd,Sd){if(1===Bd)return 32;if(!Sd)return 8;Pc=Sd.query?Sd.query:"";Yc=Ca.NXd();Bd=new P.a;Bd.neighborhood=
Pc;Bd.mentionStart=0;Bd.mentionLength=Pc.length;return Ca.eWe(Sd,Bd,null,Yc,0,this.s5)}Uvn(Pc,Yc,Bd,Dd){if(1===Bd)return la.SessionStatusManager.instance.kja?32:8;const Sd=e.AFrameworkApplication.ha.getBooleanAppSetting("InsertFileLinkSerpletIsEnabled"),He=this.s5.value.Bld();return this.EIa(Pc,Yc,Bd,Dd,Object.assign(new La.a,{selection:Object.assign(new Z.a,{neighborhood:He.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new za.a,{landingTab:"File"}),entryPoint:Sd?32:10}))}Kmd(Pc,
Yc,Bd,Dd){if(1===Bd)return la.SessionStatusManager.instance.kja?32:8;const Sd=e.AFrameworkApplication.ha.getBooleanAppSetting("InvokeReuseSlidesSerpletIsEnabled"),He=this.s5.value.Bld();return this.EIa(Pc,Yc,Bd,Dd,Object.assign(new La.a,{selection:Object.assign(new Z.a,{neighborhood:He.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new za.a,{landingTab:Sd?"Slide":"File"}),entryPoint:Sd?20:10}))}BMj(){return 2}YNh(Pc,Yc,Bd,Dd,Sd){if(1===Bd)return la.SessionStatusManager.instance.iPa?
8:32;const He=this.s5.value.Bld();Sd=void 0===Sd||null===Sd?18:19;return this.EIa(Pc,Yc,Bd,Dd,Object.assign(new La.a,{selection:Object.assign(new Z.a,{neighborhood:He.neighborhood,mentionStart:He.mentionStart,mentionLength:He.mentionLength}),launchData:Object.assign(new za.a,{landingTab:"Indoc"}),entryPoint:Sd}))}ZNh(Pc,Yc,Bd,Dd,Sd){Sd=Sd.CommandValueId;if(!Sd||Sd&&this.Sef&&Sd.query===this.Sef.query&&Sd.matchCase===this.Sef.matchCase&&Sd.matchWholeWordOnly===this.Sef.matchWholeWordOnly)return 32;
const He=this.s5.value.Bld();return this.EIa(Pc,Yc,Bd,Dd,Object.assign(new La.a,{selection:Object.assign(new Z.a,{neighborhood:He.neighborhood,mentionStart:He.mentionStart,mentionLength:He.mentionLength}),launchData:Object.assign(new za.a,{landingTab:"Indoc",data:Object.assign(new Fa,{type:4,query:Sd.query,matchCase:Sd.matchCase,matchWholeWord:Sd.matchWholeWordOnly})}),entryPoint:18}))}CXh(Pc,Yc,Bd,Dd,Sd){Sd&&(Sd[Kb.a.On]=this.s5.value.Fig);return 32}LZh(Pc,Yc,Bd,Dd,Sd){if(Pc=Sd.CommandValueId)this.Sef=
Pc;return 32}Xvn(Pc,Yc,Bd){if(1===Bd)return la.SessionStatusManager.instance.kja?32:8;Pc=this.s5.value.Bld();Pc=Object.assign(new La.a,{selection:Object.assign(new Z.a,{neighborhood:Pc.neighborhood,mentionStart:Pc.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new za.a,{landingTab:"All"})});this.s5.value.h1j(Pc);return 32}UNh(Pc,Yc,Bd){if(1===Bd)return la.SessionStatusManager.instance.kja?32:8;Pc=this.s5.value.Bld();Pc=Object.assign(new La.a,{selection:Object.assign(new Z.a,
{neighborhood:Pc.neighborhood,mentionStart:Pc.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new za.a,{landingTab:"All",data:e.AFrameworkApplication.upb})});Yc=Ca.NXd();this.s5.value.iZh(Pc,Yc);return 32}IYe(Pc,Yc,Bd,Dd){if(1===Bd)return la.SessionStatusManager.instance.kja?32:8;const Sd=this.s5.value.Yhn();return this.EIa(Pc,Yc,Bd,Dd,Object.assign(new La.a,{selection:Object.assign(new Z.a,{neighborhood:Sd.neighborhood,mentionStart:Sd.mentionStart,mentionLength:Sd.mentionLength}),
entryPoint:4,launchData:Object.assign(new za.a,{landingTab:"All"})}))}HYe(Pc,Yc,Bd,Dd){return this.EIa(Pc,Yc,Bd,Dd,Object.assign(new La.a,{entryPoint:5,launchData:Object.assign(new za.a,{landingTab:"All"})}))}bOh(Pc,Yc,Bd,Dd){if(1===Bd)return la.SessionStatusManager.instance.kja?32:8;const Sd=this.s5.value.Bld();return this.EIa(Pc,Yc,Bd,Dd,Object.assign(new La.a,{selection:Object.assign(new Z.a,{neighborhood:Sd.neighborhood,mentionStart:Sd.mentionStart,mentionLength:0}),launchData:Object.assign(new za.a,
{landingTab:"All"}),entryPoint:26}))}WNh(Pc,Yc,Bd,Dd){return 1===Bd?(Pc=this.s5.value.NZd())&&0<Pc.mentionLength?32:8:this.EIa(Pc,Yc,Bd,Dd,Object.assign(new La.a,{entryPoint:22,launchData:Object.assign(new za.a,{landingTab:"All"})}))}VNh(Pc,Yc,Bd,Dd){return 1===Bd?(Pc=this.s5.value.NZd())&&0<Pc.mentionLength?32:8:this.EIa(Pc,Yc,Bd,Dd,Object.assign(new La.a,{entryPoint:7,launchData:Object.assign(new za.a,{landingTab:"All"})}))}XNh(Pc,Yc,Bd,Dd){return this.EIa(Pc,Yc,Bd,Dd,Object.assign(new La.a,{launchData:Object.assign(new za.a,
{landingTab:"Image"}),entryPoint:9}))}KYe(Pc,Yc,Bd,Dd){return this.EIa(Pc,Yc,Bd,Dd,Object.assign(new La.a,{launchData:Object.assign(new za.a,{landingTab:"All"}),entryPoint:24}))}aOh(Pc,Yc,Bd,Dd){return this.EIa(Pc,Yc,Bd,Dd,Object.assign(new La.a,{launchData:Object.assign(new za.a,{landingTab:"Notes"}),entryPoint:33}))}cOh(Pc,Yc,Bd,Dd){if(1===Bd)return la.SessionStatusManager.instance.kja?32:8;const Sd=this.s5.value.Bld();return this.EIa(Pc,Yc,Bd,Dd,Object.assign(new La.a,{selection:Object.assign(new Z.a,
{neighborhood:Sd.neighborhood,mentionStart:Sd.mentionStart,mentionLength:0}),launchData:Object.assign(new za.a,{landingTab:"All"}),entryPoint:27}))}JYe(Pc,Yc,Bd,Dd,Sd){if(!Sd)return 8;const He=Sd.url;Sd=Sd.selectedSlideIDs;return this.EIa(Pc,Yc,Bd,Dd,Object.assign(new La.a,{launchData:Object.assign(new za.a,{landingTab:"All",data:Object.assign(new Ua,{type:6,url:He,selectedSlideIDs:Sd})}),entryPoint:37}))}$Nh(Pc,Yc,Bd,Dd,Sd){if(!Sd)return 8;const He=Sd.Selection;Sd=Sd.CurrentDocTitle;return this.EIa(Pc,
Yc,Bd,Dd,Object.assign(new La.a,{launchData:Object.assign(new za.a,{landingTab:"All",data:Object.assign(new ya,{type:5,selection:He,currentDocTitle:Sd})}),entryPoint:36}))}EIa(Pc,Yc,Bd,Dd,Sd){return Ca.EIa(Pc,Yc,Bd,Dd,this.s5,Sd)}Rdg(Pc,Yc,Bd){if(1===Bd)return 32;this.GE||this.jOb.value.Qi("Browse File from Search pane",!0);if(!this.Mgd||""===this.Mgd)return G.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;Xa.a.Go(this.Mgd,"_blank",void 0,"BrowseFilesFromSearchPane");
return 32}Wun(){const Pc=this.Fe.Uc(E.JZa);Pc.parent=Oa.AFrame.Wl;Pc.e7(Object(w.a)(this,this.O7k,"sendIFrameTakeFocusMessage"));this.HX.Pma(E.JZa)}O7k(){document.activeElement.blur();e.AFrameworkApplication.Ha&&e.AFrameworkApplication.Ha.Ib.TOh||(this.s5.value.Zih(),this.s5.value.h$n())}dispose(){this.s5.value&&this.s5.value.dispose()}}Object(c.a)(Ka,"InsightsActor",null,[40]);var Sb=a(1703),ab=a(823),ub=a(69),Aa=a(324),tb=a(64);const kc=Pc=>{Pc=Pc.split("-");return Pc[Pc.length-1]},dc=Pc=>18===
Pc||19===Pc||15===Pc,Db=()=>{var Pc=X();if(Pc)return Promise.resolve(Pc);Pc=Ma().replace("SearchWeb","searchweb");Pc=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?Pc+E.MAm+"/":Pc+E.Ooh+"/";Pc+="version.json";if(ub.a.$y)return sb(Pc);try{const Yc=new Sys.Net.WebRequest;Yc.set_httpVerb("GET");Yc.set_url(Pc);Pc={};Pc.method=Yc.get_httpVerb();return"function"!==typeof window.fetch?(ba.MT("InsightsUtils - Failed to download version.json because fetch API is unavailable.",
10),Promise.resolve("")):window.fetch(Yc.getResolvedUrl(),Pc).then(Bd=>Bd.json()).catch(()=>{ba.MT("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(Bd=>{Bd=da.b(JSON.stringify(Bd));return Bd.version?Bd.version:""},Bd=>{ba.MT("InsightsUtils - Failed to deserialize version: "+Bd.toString(),10);G.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+Bd.toString());return""}).then(Bd=>Bd)}catch(Yc){return ba.MT("InsightsUtils - Failed to download version.json: "+
Yc.toString(),10),G.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+Yc.toString()),Promise.resolve("")}},sb=Pc=>{const Yc=e.AFrameworkApplication.$d;return new Promise(Bd=>{const Dd=new ab.a(Pc,1,null,null,!0,2,null);Yc.send(Dd).l7c(Sd=>{Sd&&Sd.data?Sd.data.responseData||(ba.MT("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+Sd.data.Je,10),Bd("")):(ba.MT("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",
10),Bd(""));try{const He=da.b(Sd.data.responseData);He.version&&Bd(He.version)}catch(He){ba.MT("InsightsUtils - Failed to deserialize version: "+He.toString(),10),Bd("")}},Sd=>{Sd&&Sd.data?ba.MT("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+Sd.data.Je,10):ba.MT("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);Bd("")})})},Qb=()=>e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableLocalOverride")||
e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),$a=()=>{const Pc=Ma();return Qb()||e.AFrameworkApplication.ha.Ma("SmartLookupPRClientVersion")?Pc+X()+"/":e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?Pc+E.MAm:Pc+E.Ooh},X=()=>Qb()?"dev":e.AFrameworkApplication.ha.Ma("SmartLookupPRClientVersion")?e.AFrameworkApplication.ha.Ma("SmartLookupPRClientVersion").split("/")[1]:
e.AFrameworkApplication.ha.Ma("SmartLookupClientVersion"),Ta=Pc=>{var Yc=3===e.AFrameworkApplication.Ha.Ib.Dm?"wordwac":2===e.AFrameworkApplication.Ha.Ib.Dm?"pptwac":"excelwac";var Bd=Aa.a.Le(e.AFrameworkApplication.lcid);const Dd=Bd?Bd.name:"en-us";Bd=Ma();const Sd=wa();Yc="main_ssr_wac.html?appName="+Yc+"&culture="+Dd;return"LOCAL"===Sd?Bd+Yc:Bd+((""!==Pc?Pc:E.Ooh)+"/")+Yc},ca=Pc=>Ma()+(""!==Pc?Pc:E.Ooh)+"/scripts/microsoft.office.smartlookup.host.runtime.js",Ma=()=>{switch(wa()){case "LOCAL":return E.Xfo;
case "PR":const Pc=e.AFrameworkApplication.ha.Ma("SmartLookupPRClientVersion").split("/");return E.Yfo+Pc[0]+"/";case "INT":return E.Zfo;case "EDOG":return E.NAm;default:return E.OAm}},Ba=()=>{if(!e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(wa()){case "EDOG":return E.NAm;case "PROD":return E.OAm;default:return""}},wa=()=>{if(e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableEdogSourceLocationOverride")||
e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableProdSourceLocationOverride")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableIntSourceLocationOverride")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",
!1))return"INT";if(e.AFrameworkApplication.ha.Ma("SmartLookupPRClientVersion")&&e.AFrameworkApplication.ha.Ma("SmartLookupPRIntentSvc"))return"PR";if(Qb())return"LOCAL";switch(Object(Sb.a)(String,e.AFrameworkApplication.rd.AudienceGroup)||""){case "Dogfood":if(e.AFrameworkApplication.ha&&e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let Pc=e.AFrameworkApplication.ha.Ma("UserPrincipalName");Pc=tb.a.ph(Pc);const Yc=e.AFrameworkApplication.ha.Zt("SmartLookupINTEnabledForSKITeam")?
e.AFrameworkApplication.ha.Fz("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(Yc,Pc))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},pa=()=>{let Pc;Pc=e.AFrameworkApplication.ha.getBooleanAppSetting("IntentSvcEnableEdogSourceLocationOverride")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":e.AFrameworkApplication.ha.getBooleanAppSetting("IntentSvcEnableProdSourceLocationOverride")||
e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":e.AFrameworkApplication.ha.getBooleanAppSetting("IntentSvcEnableIntSourceLocationOverride")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":wa();const Yc=e.AFrameworkApplication.ha.Ma("IntentServiceEndpoint"),Bd=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===Pc&&""!==Yc)return Yc+"searchendpointv2/";switch(Pc){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return e.AFrameworkApplication.ha.Ma("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(Bd?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(Bd?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},ta=()=>{const Pc=wa(),Yc=e.AFrameworkApplication.ha.Ma("IntentServiceEndpoint");switch(Pc){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===Pc&&""!==Yc?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class Wa{sendTelemetryEvent(Pc){ba.sendTelemetryEvent(Pc)}}
Object(c.a)(Wa,"OtelTelemetrySink",null,[919]);var Pa=a(836);class ib{}Object(c.a)(ib,"ApplicationProperties",null,[]);class Ib{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(c.a)(Ib,"CurrentDocumentProperties",null,[]);class hc{}Object(c.a)(hc,"EnterpriseUserInfo",null,[]);class yc{}Object(c.a)(yc,"FeatureGates",null,[]);var ob=a(100);class Bc{constructor(Pc,Yc){this.CN=this.zr=null;this.zz="Search";this.yfm=!0;this.uId=Yc;this.g$=Pc;this.g$.execute(Bd=>{Bd.isFeatureEnabled("mso_sendASmile",
!0).then(Dd=>{this.yfm=Dd}).catch(Dd=>{ba.MT("SearchHelper - Failed to check if Feedback feature is enabled: "+Dd.toString(),15)})});Pc=pa();Yc=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableInDocumentSearch")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupFeatureGateV2")){this.CN={};const Bd=this.kln();if(Bd&&0<Bd.length)for(let Dd=0;Dd<Bd.length;Dd++){const Sd=
Bd[Dd],He=this.yln(Sd);switch(He.toLowerCase()){case "true":this.CN[Sd]=!0;break;case "false":this.CN[Sd]=!1;break;default:this.CN[Sd]=He}}this.CN.EnableInDocumentSearch=Yc;this.CN.EnableInDocumentSearchReplace=!0;this.CN.EnableInDocumentParamLocalSearch=!0;this.CN.EnableInDocumentQuerySuggest=Yc&&e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableInDocumentQuerySuggest")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",
!1);this.CN.EnableInDocumentQuestionGeneration=Yc&&e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableInDocumentQuestionGeneration")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.CN.EnableInDocumentExperiment1=Yc&&e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment1")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",
!1);this.CN.EnableInDocumentExperiment2=Yc&&e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment2")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.CN.EnableInDocumentExperiment3=Yc&&e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment3")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",
!1);this.CN.EnableZeroTermAutoRefresh=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.CN.EnableTap3SZeroTerm=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableTap3SZeroTerm")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1);this.CN.EnableLocalSearch=!0;this.CN.EnableInDocumentStickyFilters=!0;this.CN.IntentServiceEndpoint=Pc;this.CN.EnablePDFShredding=
e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableSharepointPDFIsEnabled")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.CN.FilterNonPPTFilesForReuseSlides=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupFilterNonPPTFilesForReuseSlides");this.CN.UXBundleVersion=X();this.CN.SmartLookupServicePath=$a();this.CN.EnableAcronymSearch=!0;this.CN.UseAltAnswerEndpoint1=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint1")||
e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.CN.UseAltAnswerEndpoint2=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint2")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.CN.UseAltAnswerEndpoint3=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint3")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",
!1);this.CN.UseNextUXVersion=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.CN.IgnoreNeighborhoodContext=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.CN.ShowDebugInfo="INT"===wa();this.CN.DebugCommands=e.AFrameworkApplication.ha.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands","");this.CN.ChangeGates=e.AFrameworkApplication.ha.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",
"");this.CN.QnaInMixSection=!0;this.CN.EnableNoteSearch=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupNoteSearchIsEnabled")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.CN.EnableWikiL2=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.CN.EnableFilteringOutRedundantKPE=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",
!1);this.CN.EnableZeroTermEntitySuggestion=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.CN.RankingModels=e.AFrameworkApplication.ha.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.CN.EnableClientSideRendering=!0}else this.zr=new yc,this.zr.EnableInDocumentSearch=Yc,this.zr.EnableInDocumentSearchReplace=!0,this.zr.EnableInDocumentParamLocalSearch=!0,this.zr.EnableInDocumentQuerySuggest=
Yc&&e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableInDocumentQuerySuggest")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.zr.EnableInDocumentQuestionGeneration=Yc&&e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableInDocumentQuestionGeneration")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1),this.zr.EnableInDocumentExperiment1=
Yc&&e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment1")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.zr.EnableInDocumentExperiment2=Yc&&e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment2")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.zr.EnableInDocumentExperiment3=
Yc&&e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableInDocumentExperiment3")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.zr.EnableZeroTermAutoRefresh=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.zr.EnableTap3SZeroTerm=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableTap3SZeroTerm")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.zr.EnableLocalSearch=!0,this.zr.EnableInDocumentStickyFilters=!0,this.zr.IntentServiceEndpoint=Pc,this.zr.EnablePDFShredding=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableSharepointPDFIsEnabled")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.zr.FilterNonPPTFilesForReuseSlides=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupFilterNonPPTFilesForReuseSlides"),this.zr.UXBundleVersion=
X(),this.zr.SmartLookupServicePath=$a(),this.zr.EnableAcronymSearch=!0,this.zr.UseAltAnswerEndpoint1=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint1")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.zr.UseAltAnswerEndpoint2=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint2")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",
!1),this.zr.UseAltAnswerEndpoint3=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupUseAltAnswerEndpoint3")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.zr.UseNextUXVersion=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.zr.IgnoreNeighborhoodContext=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupIgnoreNeighborhoodContextIsEnabled"),
this.zr.ShowDebugInfo="INT"===wa(),this.zr.DebugCommands=e.AFrameworkApplication.ha.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",""),this.zr.ChangeGates=e.AFrameworkApplication.ha.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.zr.QnaInMixSection=!0,this.zr.EnableNoteSearch=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupNoteSearchIsEnabled")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",
!1),this.zr.EnableWikiL2=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.zr.EnableFilteringOutRedundantKPE=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.zr.EnableZeroTermEntitySuggestion=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.zr.RankingModels=e.AFrameworkApplication.ha.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",
""),this.zr.EnableClientSideRendering=!0,this.zr.SharedSerpletFeatureGate1=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",!1),this.zr.SharedSerpletFeatureGate2=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.zr.SharedSerpletFeatureGate3=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.zr.SharedSerpletFeatureGate4=
e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.zr.SharedSerpletFeatureGate5=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",!1),this.zr.SharedSerpletFeatureGate6=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.zr.SharedSerpletFeatureGate7=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",
!1),this.zr.SharedSerpletFeatureGate8=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.zr.SharedSerpletFeatureGate9=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",!1),this.zr.SharedSerpletFeatureGate10=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.zr.SharedSerpletFeatureGate11=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",
!1),this.zr.SharedSerpletFeatureGate12=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.zr.SharedSerpletFeatureGate13=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",!1),this.zr.SharedSerpletFeatureGate14=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.zr.SharedSerpletFeatureGate15=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",
!1),this.zr.SharedSerpletFeatureGate16=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.zr.SharedSerpletFeatureGate17=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",!1),this.zr.SharedSerpletFeatureGate18=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.zr.SharedSerpletFeatureGate19=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",
!1),this.zr.SharedSerpletFeatureGate20=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.zr.SharedSerpletFeatureGate21=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",!1),this.zr.SharedSerpletFeatureGate22=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.zr.SharedSerpletFeatureGate23=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",
!1),this.zr.SharedSerpletFeatureGate24=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.zr.SharedSerpletFeatureGate25=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",!1),this.zr.SharedSerpletFeatureGate26=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.zr.SharedSerpletFeatureGate27=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",
!1),this.zr.SharedSerpletFeatureGate28=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.zr.SharedSerpletFeatureGate29=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",!1),this.zr.SharedSerpletFeatureGate30=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.zr.SharedSerpletFeatureGate31=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",
!1),this.zr.SharedSerpletFeatureGate32=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.zr.SharedSerpletFeatureGate33=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",!1),this.zr.SharedSerpletFeatureGate34=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.zr.SharedSerpletFeatureGate35=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",
!1),this.zr.SharedSerpletFeatureGate36=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.zr.SharedSerpletFeatureGate37=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",!1),this.zr.SharedSerpletFeatureGate38=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.zr.SharedSerpletFeatureGate39=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",
!1),this.zr.SharedSerpletFeatureGate40=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.Gmf=Object(Pa.a)();this.Yyg=Bc.isEnterpriseUser();this.ipe=e.AFrameworkApplication.ha.Ma("SmartLookupShredderServiceEndpoint");this.eHn=ob.a.VK(e.AFrameworkApplication.ha.Ma("AppCatalogUrl")||"");this.uHn=e.AFrameworkApplication.ha.Ma("UserPrincipalName");this.Yyg&&this.x4l()}yln(Pc){return e.AFrameworkApplication.ha.getStringFeatureGate("Microsoft.Office.SharedOnline."+
Pc,"")}kln(){const Pc=e.AFrameworkApplication.ha.clc,Yc=e.AFrameworkApplication.ha.Fz("SmartLookupFlightKeywordList"),Bd=[];if(Pc&&Yc&&0<Yc.length)for(const Sd in Pc){var Dd={key:Sd,value:Pc[Sd]};Dd=Dd&&Dd.key?Dd.key:"";for(let He=0;He<Yc.length;He++)if(-1<Dd.toLowerCase().indexOf(Yc[He].toLowerCase())){const ge=Dd.split(".");ge&&4===ge.length&&Array.add(Bd,ge[ge.length-1])}}return Bd}d6f(Pc,Yc,Bd,Dd){return new Promise(Sd=>{this.Ryn().then(He=>{const ge=new ib;ge.anid="";ge.applicationName=3===e.AFrameworkApplication.Ha.Ib.Dm?
"WORD":"POWERPNT";ge.applicationVersion=e.AFrameworkApplication.buildVersion;ge.appCorrelationId=Pc?Pc:Ca.NXd();ge.themePlatform="web";ge.lcid=e.AFrameworkApplication.lcid;ge.launchUtcTime=(new Date).toUTCString();e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupFeatureGateV2")?ge.featureGates=da.c(this.CN):ge.featureGates=da.c(this.zr);var ve=Aa.a.Le(e.AFrameworkApplication.lcid);ve=ve?ve.name:null;ge.market=kc(ve);ge.uiLanguage=ve;ge.sessionId=e.AFrameworkApplication.userSessionId;ge.themeId=
Bd;ge.parentalControl="yes";ge.processorOnlyMode=He;ge.isEditingAllowed=Yc.isEditingAllowed();ge.isFeedbackEnabled=this.yfm;ge.isClientSideRendering=dc(Dd);ge.disableClipboard=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&e.AFrameworkApplication.Mz&&!e.AFrameworkApplication.DAa;ge.accessToken=this.Yyg?this.x4l():"";He=new hc;He.CountryCode=kc(ve);He.ServiceEndpoint=this.ipe;He.IsGoLocal=e.AFrameworkApplication.ha.getBooleanAppSetting("IsGoLocalEnvironment");
He.IsEnabled=this.Yyg;He.IsEnterpriseEnabled=this.Yyg;He.TenantRoot=this.eHn;He.Upn=this.uHn;ve=wa();He.IsEUDB="PROD"===ve&&""!==e.AFrameworkApplication.ha.Ma("IntentServiceEndpoint");ge.enterpriseUserInfo=He;He=new Ib;He.filePath=e.AFrameworkApplication.ha.Ma("EditDocInClientUrl");He.docName=e.AFrameworkApplication.ha.Ma("FileName");He.author=99!==Dd?Yc.author():null;He.createdDate=99!==Dd?Yc.createdDate():null;ge.currentDocument=He;Sd(ge)})})}Ryn(){return new Promise(Pc=>{this.g$?this.g$.execute(Yc=>
{Yc.isFeatureEnabled(E.$fo,!0).then(Bd=>{Pc(!Bd)}).catch(Bd=>{ba.MT("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+Bd.toString(),10);Pc(!0)})}):Pc(!0)})}zpm(Pc){this.Gmf&&this.Yyg&&this.xMh(this.ipe).then(Yc=>{Pc(Yc)})}x4l(){return"Dev Box"===e.AFrameworkApplication.ha.Ma("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.Gmf?this.Gmf.Omn(this.zz,
this.ipe):""}xMh(Pc){return"Dev Box"===e.AFrameworkApplication.ha.Ma("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?new Promise(Yc=>{Yc(window.SearchPaneShredderTokenOverride)}):this.Gmf?this.Gmf.getToken(this.zz,Pc):Promise.resolve("")}c1d(){return this.uId?this.uId.getVersion():""}L2l(){return e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupFeatureGateV2")?da.c(this.CN):da.c(this.zr)}static isEnterpriseUser(){const Pc=
e.AFrameworkApplication.ha.Ma("SovereignEnvironmentName"),Yc=e.AFrameworkApplication.ha.getBooleanAppSetting("IsTellMeUpSellEnterpriseEnabled");return(!Pc||!Pc.length)&&Yc}}Object(c.a)(Bc,"SearchHelper",null,[882]);class rb{constructor(){rb.Qa=""}getVersion(){return rb.Qa}lco(Pc){rb.Qa=Pc}}rb.Qa=null;Object(c.a)(rb,"SmartLookupVersion",null,[]);class Eb{}Object(c.a)(Eb,"ConfigurationProvider",null,[]);class jc{constructor(Pc){jc.Qa=Pc}ijj(){return jc.Qa}}jc.Qa=null;Object(c.a)(jc,"SearchHostRuntime",
null,[]);var ea=a(137),ua=a(360),Da=a(375),Cb=a(363);class Nb{constructor(){this.Iva=this.CRe=this.Oa=null}get name(){return"Common.App.Insights"}oc(Pc){this.Oa=Pc;const Yc=Cb.a.kH(Object(z.a)()),Bd=e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableNativePane")||e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupIsEnabled");Pc.register(Ka,"Common.App.Insights.InsightsActor").oa().pa(()=>new Ka(k.a.instance.he("Common.App.Insights.IInsightsManager"),e.AFrameworkApplication.ub,
h.a.instance,n.FocusManager.instance(),Object(v.a)(),e.AFrameworkApplication.ha,ea.TaskManager.instance,Bd,new b.a(()=>Yc.result)));Pc.register(881,"Common.App.Insights.IDocumentContentExtractionManager").oa().pa(()=>new B(Pc));Bd&&(Pc.register(rb,"Common.App.Insights.SmartLookupVersion").oa().pa(()=>new rb),Pc.register(882,"Common.App.SearchCommon.ISearchHelper").oa().pa(()=>new Bc(Object(x.a)(),r())))}init(){e.AFrameworkApplication.Dsb&&(this.CRe=k.a.instance.Db("Common.App.Insights.InsightsActor"),
this.CRe.Kb())}v4n(){if(e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",!1)){var Pc=e.AFrameworkApplication.ha.Ma("SmartLookupShredderServiceEndpoint");u().xMh(Pc).then(Yc=>{var Bd={};Bd.Authorization="Bearer "+Yc;Yc=ta();const Dd=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",!0);Bd=new ab.a(Yc+("?isTelemetryOnly="+Dd),1,null,Bd,!0,2,null);e.AFrameworkApplication.$d.send(Bd).l7c(()=>
{ba.MT("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+Dd,50)},Sd=>{ba.MT("InsightsPackage - Failed to send refreshmemory API request. Error: "+Sd.toString(),10)})})}}a9m(){this.Qvn();this.v4n()}Qvn(){Db().then(Pc=>{if(""!==Pc){const Yc=r();Yc&&Yc.lco(Pc)}this.CTd();this.CRe=k.a.instance.resolve("Common.App.Insights.InsightsActor");Pc=ca(Pc);Pc=Da.a.create(Pc);Pc.s$((Yc,Bd)=>{Bd.succeeded?this.uco()&&this.prefetchZeroTerm():ba.MT("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+
Bd.Cu,10);this.CRe.Kb()});ua.a.RK(Pc)})}uco(){const Pc=Object.assign(new Eb,{channelId:E.channelId,approvedOriginPattern:Qb()?"^(http)?://(localhost:8080)$":e.AFrameworkApplication.ha.Ma("SmartLookupApprovedOriginPattern")});var Yc=k.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const Bd=k.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Dd=k.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),Sd=new A.a;Yc&&Sd.add(Yc);Bd&&Sd.add(Bd);Dd&&Sd.add(Dd);
Yc=pa();try{const He=new Wa,ge=SmartLookupHostRuntime.setup(Pc,Sd.toArray(),!0,Yc,He);this.Oa.register(jc,"Common.App.SearchCommon.SearchHostRuntime").oa().pa(()=>new jc(ge));return!0}catch(He){return ba.MT("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+He,10),!1}}prefetchZeroTerm(){if(e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableInDocumentSearch")||e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)){var Pc=l();if(Pc){const Yc=u(),Bd=k.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper");Yc.d6f(null,Bd,0,99).then(Dd=>{Pc.ijj().prefetchZeroTerm(Dd,e.AFrameworkApplication.userSessionId,$a(),!0,"Indoc",null)})}else ba.MT("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}CTd(){var Pc=u();const Yc=Ta(Pc.c1d());Pc=Pc.c1d();Pc=Ma()+(""!==Pc?Pc:E.Ooh)+"/scripts/microsoft.office.smartlookup.ssr.js";const Bd=Ba();ub.a.$y?this.Z8m(Yc,Pc):(this.X8m(Yc,
Bd),this.Y8m(Pc,Bd))}X8m(Pc,Yc){const Bd=new Sys.Net.WebRequest;Bd.set_httpVerb("GET");const Dd={};Dd.method=Bd.get_httpVerb();Bd.set_url(Pc);const Sd=(new Date).getTime();try{window.fetch(Bd.getResolvedUrl(),Dd).then(()=>{""!==Yc&&ba.y7k(Yc,Pc,(new Date).getTime()-Sd);r()})}catch(He){ba.MT("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+He.toString(),10)}}Y8m(Pc,Yc){var Bd=new Sys.Net.WebRequest;Bd.set_httpVerb("GET");const Dd={};Dd.method=Bd.get_httpVerb();Bd.set_url(Pc);
let Sd=-1;if(e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))Bd=e.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),ea.TaskManager.instance.Rb(new Qa.a(5,1,Bd,()=>{const He=Da.a.create(Pc);He.HFh(()=>{Sd=Date.now()});He.s$((ge,ve)=>{ve.succeeded?""!==Yc&&ba.y7k(Yc,Pc,Date.now()-Sd):ba.MT("InsightsPackage - Failed to prefetch JS file.",10)});ua.a.RK(He)}));else{Sd=Date.now();try{window.fetch(Bd.getResolvedUrl(),
Dd).then(()=>{""!==Yc&&ba.y7k(Yc,Pc,Date.now()-Sd)})}catch(He){ba.MT("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+He.toString(),10)}}}Z8m(Pc,Yc){if(ub.a.$y){var Bd=e.AFrameworkApplication.$d;Pc=new ab.a(Pc,1,null,null,!0,2,null);Bd.send(Pc).l7c(Dd=>{Dd&&Dd.data?Dd.data.responseData?r():ba.MT("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+Dd.data.Je,10):ba.MT("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",
10)},Dd=>{Dd&&Dd.data?ba.MT("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+Dd.data.Je,10):ba.MT("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupPrefetchJSIsEnabled")&&(Yc=new ab.a(Yc,1,null,null,!0,2,null),Bd.send(Yc).l7c(Dd=>{Dd&&Dd.data?Dd.data.responseData||ba.MT("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
Dd.data.Je,10):ba.MT("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},Dd=>{Dd&&Dd.data?ba.MT("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+Dd.data.Je,10):ba.MT("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.CRe&&this.CRe.dispose()}}Object(c.a)(Nb,"InsightsPackage",null,[4,5]);var fc=a(43),fb=a(113),Ub=a(745),Ec=a(1316),Lc=a(1250),vb=a(74),
ec=a(48);class lb{constructor(Pc,Yc,Bd,Dd=!0){this.streamUrl=Pc;this.objectType=Yc;this.formatType=Bd;this.renderAfterInsert=Dd}}Object(c.a)(lb,"InsertContentFromStreamData",null,[]);var Zb=a(371),qc=a(44),pc=a(552),ac=a.n(pc),gb=a(42);class Jb{constructor(Pc,Yc,Bd){this.la=Pc;this.sa=Yc;this.ya=Bd}insertOnlinePicture(Pc){const Yc=Object(Sb.a)(21,this.ya.Ia);Pc&&Yc&&(Pc=Object.assign(new Lc.a,{Action:"Insert",Caption:Pc.caption,OriginalUrl:Pc.sourceUrl,Height:Pc.height,Width:Pc.width,LicenseDisplayName:Pc.licenseDisplayName,
LicenseUrl:Pc.licenseUrl,ThumbnailUrl:Pc.thumbnailUrl,PageUrl:Pc.pageUrl}),this.la.Ra(qc.a.Llc,2,Pc))}insertHtmlText(Pc){if(Pc)if(1===this.sa.zd().length){var Yc=new Ec.a;gb.a("SanitizeHtmlTextData")?Yc.setValue(vb.a.uY,ac.a.sanitize(Pc.htmlText)):Yc.setValue(vb.a.uY,Pc.htmlText);Yc.setValue(vb.a.Mwe,!1);Yc=this.la.Ra(ec.a.Iwe,2,Yc);8!==Yc&&2!==Yc||this.G8l(Pc)}else this.G8l(Pc)}G8l(Pc){Pc=Object.assign(new Zb.a,{Nua:!1,fP:Pc.htmlText});this.la.Ra(qc.a.Pna,2,Pc)}insertContentFromStreamUrl(Pc){Pc&&
(Pc=new lb(Pc.streamUrl,Pc.objectType,Pc.formatType,Pc.renderAfterInsert),this.la.Ra(qc.a.AMc,2,Pc))}getId(){return"InsertContentExecutor"}}Object(c.a)(Jb,"InsertContentExecutor",null,[815,875]);var uc=a(1151),Cc=a(196);class Gc{}Object(c.a)(Gc,"CommandMetadataResponse",null,[]);class dd{constructor(){this.tGj=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){Cc.PrivacyDialogManager.Zsd()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(Pc){const Yc=
new Gc;Pc.iconNames&&(Yc.svgData=this.getCommandIconSvg(Pc.iconNames));if(!Pc.commandId||""===Pc.commandId)return Yc.isVisible=!1,Yc;try{Yc.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),Pc.commandId);Yc.isDisabled=appChrome.selectors.isControlDisabled(Pc.commandId);Yc.label=appChrome.selectors.getControlLabel(Pc.commandId);if(Yc.svgData&&""!==Yc.svgData)return Yc;const Bd=appChrome.selectors.getControlIconSet(Pc.commandId),Dd=Array(2);Dd[0]=Bd["default"];Dd[1]=Bd.icon32;Yc.svgData=
this.getCommandIconSvg(Dd)}catch(Bd){return null}return Yc}getCommandIconSvg(Pc){if(!this.tGj)return"";for(let Yc=0;Yc<Pc.length;Yc++){const Bd=Pc[Yc];if(Bd in this.tGj)return this.tGj[Bd]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(Pc){const Yc={SourceControlId:"GiveFeedback"};Yc.feedbackType="true"===Pc.IsPosFeedback?0:1;const Bd={};Bd.featureArea=dd.Uan;Yc.telemetryGroup=Bd;Yc.appData=Pc;return Yc}}
dd.Eqn="FA000000012";dd.queryPrefix="AssetID=";dd.Uan="SearchPane";Object(c.a)(dd,"BaseSerpletExecutor",null,[814,875]);var ld=a(40);class bc extends dd{constructor(Pc,Yc,Bd){super();this.la=Pc;this.vgm=Yc;this.MEg=Bd;if(!Pc)throw Error.argumentNull("m_actionManager");}openFeedbackPane(Pc){this.la.Ra(nb.a.mLb,2,this.createFeedbackPropertiesFromData(Pc))}openHelpTaskPane(Pc){const Yc={};Yc.query=dd.queryPrefix+Pc;Pc={};Pc.assetId=dd.Eqn;Pc.nonPersistedSettings=Yc;this.la.Ra(qc.a.kJa,2,Pc)}browseFiles(){this.la.Ra(nb.a.Rdg,
2,null)}executeCommand(Pc){if(Pc)switch(Pc.CommandId){case 3:appChrome.api.executeCommand(Pc.Data.CommandId,Pc.Data.Payload);break;case 4:if(this.vgm&&this.MEg)try{this.vgm.Rvn(Pc.Data.AST)}catch(Yc){ld.a.$(509449952,1313,15,`SmartLookup PPTSerpletExecutor executeCommand: Exception thrown while executing provided AST. ${Yc}`)}}}}Object(c.a)(bc,"PPTSerpletExecutor",dd,[]);class cc{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(c.a)(cc,"BaseDocumentHelper",null,[816]);
class Vc extends cc{constructor(){super()}isEditingAllowed(){return fc.App.Zb.Sd.isEditingAllowed}}Object(c.a)(Vc,"PptDocumentHelper",cc,[]);class td{constructor(){this.PCh=this.Soa=null}PQi(){return null}Bld(){return this.NZd()}Yhn(){return this.NZd()}Ieo(Pc,Yc,Bd){this.Soa||(this.Soa=this.mIh());this.Soa.vo(Pc,Yc,Bd)}Jeo(Pc,Yc,Bd){this.Soa||(this.Soa=this.mIh());this.Soa.Sjl(Pc,Yc,Bd)}Udo(Pc,Yc){this.PCh||(this.PCh=this.PQi());this.PCh&&this.PCh.Sjl(Pc,Yc)}iZh(Pc,Yc){this.Soa||(this.Soa=this.mIh());
this.Soa.iZh(Pc,Yc)}h1j(Pc){this.Soa||(this.Soa=this.mIh());this.Soa.h1j(Pc)}h$n(){this.Soa&&this.Soa.O7k()}Zih(){this.Soa&&this.Soa.Fao()}Fdo(){var Pc=e.AFrameworkApplication.ha.Ac("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);Pc=window.performance.now()-td.Qam<=Pc;Pc||(td.Qam=window.performance.now());return Pc}dispose(){this.Soa&&(this.Soa.dispose(),this.Soa=null)}get Fig(){return this.Soa?this.Soa.isVisible:!1}}td.Qam=0;Object(c.a)(td,"InsightsManager",null,[939,40]);const Xc=()=>k.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime");
class ne{constructor(Pc,Yc,Bd,Dd,Sd,He=!0,ge=null,ve=null){this.Fva=this.sK=this.FOb=null;this.Rgd=!1;this.Iva=null;this.Fe=Yc;this.Mdi=He;this.Vef=ve?ve:new cc;this.g$=ge;this.HX=Pc;this.Mdi&&(l()&&(this.Iva=Xc().ijj()),this.aXa=u(),this.uId=this.aXa.c1d())}Bue(Pc){if(this.Mdi){Pc=Pc.rawEvent;try{var Yc=da.a(Pc.data)}catch(Bd){G.ULS.sendTraceTag(595161728,1303,15,this.CYb("Message data from Serplet [{0}] failed to deserialize.",Pc.data));return}switch(Yc.actionType){case 101:Pc=0;this.sK&&(Pc=this.sK.entryPoint);
this.aXa.d6f(this.Fva,this.Vef,this.wlc(),Pc).then(Bd=>{Yc.data=Bd;this.y2e(Yc)});break;case 118:Yc.data=this.sK?this.sK:Object.assign(new La.a,{selection:Object.assign(new Z.a,{neighborhood:this.FOb.neighborhood,mentionStart:this.FOb.mentionStart,mentionLength:this.FOb.mentionLength})});this.y2e(Yc);break;case 103:Pc=da.a(Object(Sb.a)(String,Yc.data));ba.sendTelemetryEvent(Pc);break;case 206:this.aXa.xMh(Yc.data).then(Bd=>{Yc.data=Bd;this.y2e(Yc)});break;case 112:Yc.data.shiftPressed?(ub.a.Yf&&document.activeElement.blur(),
this.HX.B2d(0,null,2,null,null),G.ULS.sendTraceTag(592545156,1303,50,this.CYb("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.HX.Krb(0,null,2,null,null),G.ULS.sendTraceTag(592545155,1303,50,this.CYb("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Tx()}}}cGe(Pc){if(this.Iva){var Yc=0;this.sK&&(Yc=this.sK.entryPoint);this.aXa.d6f(this.Fva,this.Vef,this.wlc(),Yc).then(Bd=>{ba.xGa("SearchFromHost",this.Fva);this.sK.launchData||(this.sK.launchData=new za.a);const Dd=$a();try{this.Iva.search(this.sK,
Bd,e.AFrameworkApplication.userSessionId,Dd,Pc),this.aXa.zpm(Sd=>{ba.xGa("SearchFromHostWithToken",this.Fva);this.Iva.searchAuthenticatedProviders(this.sK,Bd,e.AFrameworkApplication.userSessionId,Dd,null,Sd)})}catch(Sd){ba.MT("BaseSmartLookupPane - Fail to search from host. Error: "+Sd,10)}}).catch(Bd=>{ba.MT("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+Bd.toString(),10)})}}bih(Pc){this.Mdi&&ba.bih(this.Fva,Math.round(window.performance.now()-Pc),this.sK?aa.a[this.sK.entryPoint]:
"",this.aXa.c1d(),this.aXa.L2l(),e.AFrameworkApplication.HTe,this.Rgd,dc(this.sK?this.sK.entryPoint:0))}}Object(c.a)(ne,"BaseSmartLookupPane",null,[941,40]);class Vd{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(c.a)(Vd,"SmartLookupTaskPaneProps",null,[]);var Ja=a(1026);class Lb{}Object(c.a)(Lb,"ActionDescriptor",null,[]);var fa=a(111);class Na extends ne{constructor(Pc,Yc,Bd,Dd=null,Sd=null,He=null,ge=!0,ve=null,ze=null){super(Yc,Bd,Dd,Sd,He,ge,ve,ze);this.Wli=!!e.AFrameworkApplication.Ha&&
!!e.AFrameworkApplication.Ha.Ib&&e.AFrameworkApplication.Ha.Ib.ykg;this.lSe=this.Jii=!1;this.yPm=e.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.xPm=e.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.APm=e.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.zPm=e.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",
700);this.Mnm=()=>{if(this.Iva)this.Iva.onPaneThemeChanged(this.wlc());return ma.a("getTheme")?appChrome.api.getTheme():null};this.f_g=()=>{ba.MT("ReactSmartLookupPane - Iframe component failed to load.",10)};this.hSn=()=>{e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||ba.MT("ReactSmartLookupPane - Onload detected no network.",50)};ge||ba.MT("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",
10);this.wjc=Pc;this.IKl=Ta(this.uId)}get isVisible(){return this.lSe}iZh(Pc,Yc){this.sK=Pc;this.FOb=Pc=Object.assign(new P.a,{neighborhood:Pc.selection.neighborhood,mentionStart:Pc.selection.mentionStart,mentionLength:Pc.selection.mentionLength});this.Rgd=!Pc.mentionLength;this.Fva=Yc;this.cGe(!1)}h1j(Pc){this.sK=Pc;this.yEb(Object.assign(new P.a,{neighborhood:Pc.selection.neighborhood,mentionStart:Pc.selection.mentionStart,mentionLength:Pc.selection.mentionLength}),!1)}vo(Pc,Yc){this.Fva=Yc;this.yEb(Pc,
!0)}Sjl(Pc,Yc,Bd){this.sK=Pc;this.vo(Object.assign(new P.a,{neighborhood:Pc.selection.neighborhood,mentionStart:Pc.selection.mentionStart,mentionLength:Pc.selection.mentionLength}),Yc,Bd)}Tx(){this.HZh();this.wjc.hideTaskPane()}yEb(Pc,Yc){la.SessionStatusManager.instance.kja&&this.Iva?(this.FOb=Pc,this.Rgd=!Pc.mentionLength,Pc=window.performance.now(),this.initialize(),this.isVisible?e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupDisableRefreshPaneIsEnabled")?(this.wjc.updateTaskPane(null),
Yc&&this.v$n()):(Yc&&this.cGe(!1),this.Jii=!this.Jii,this.wjc.updateTaskPane(this.x3a())):(Yc&&this.cGe(this.isVisible),this.wjc.showTaskPane(this.x3a())),this.bih(Pc)):(this.wjc.showTaskPane(this.x3a()),ba.i$n(la.SessionStatusManager.instance.kja,!!this.Iva,this.sK?aa.a[this.sK.entryPoint]:"",this.aXa.c1d(),e.AFrameworkApplication.HTe,this.Rgd))}v$n(){if(!this.sK){const Pc=Object.assign(new Z.a,{neighborhood:this.FOb.neighborhood,mentionStart:this.FOb.mentionStart,mentionLength:this.FOb.mentionLength});
this.sK=Object.assign(new La.a,{selection:Pc,userIntent:null,entryPoint:0,launchData:null})}this.cGe(this.isVisible)}q$n(){const Pc=new Lb;Pc.transactionId=this.Fva;Pc.actionType=15;Pc.channelId=E.channelId;this.y2e(Pc)}Bue(Pc){const Yc=Pc.rawEvent;document.getElementById(E.JZa)&&Yc.source!==document.getElementById(E.JZa).contentWindow||this.r3n(Pc)}r3n(Pc){const Yc=Pc.rawEvent;let Bd;try{Bd=da.b(Yc.data)}catch(Dd){G.ULS.sendTraceTag(545604257,1303,15,this.CYb("Message data from Serplet [{0}] failed to deserialize.",
Yc.data));return}switch(Bd.actionType){case 32:e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(fa.a.R1d()>=this.yPm?this.wjc.updateTaskPane(this.bVi(this.xPm)):fa.a.R1d()>=this.APm&&this.wjc.updateTaskPane(this.bVi(this.zPm)));break;case 33:e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.wjc.updateTaskPane(this.bVi(Bd.data));break;case 42:this.wjc.updateTaskPane(this.f6m(Bd.data));
break;case 43:this.wjc.updateTaskPane(this.x3a());break;default:super.Bue(Pc)}}dispose(){}initialize(){this.Yfc()}Yfc(){const Pc=this.Fe.Uc(E.JZa);Pc.parent=Oa.AFrame.Wl;Pc.US=!0}IZh(){this.Fe.Ag(E.JZa)}HZh(){this.gZj()&&this.Fe.Ag(this.Fe.Eba)}FVk(){$addHandler(window,"message",Object(w.a)(this,this.Bue,"onIFrameMessage"))}Xxl(){$removeHandler(window,"message",Object(w.a)(this,this.Bue,"onIFrameMessage"))}gZj(){return!!this.Fe.currentScope&&this.Fe.currentScope.name===E.JZa}y2e(Pc){Pc=da.c(Pc);document.getElementById(E.JZa)&&
document.getElementById(E.JZa).contentWindow.postMessage(Pc,ob.a.getOrigin(this.IKl))}CYb(Pc,...Yc){const Bd={};this.Fva&&(Bd[E.hCm]=this.Fva);Bd[E.iCm]=String.format.apply(null,[Pc].concat(Yc));return da.c(Bd)}wlc(){return ma.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}O7k(){}Fao(){document.getElementById(E.JZa)&&n.FocusManager.vz(document.getElementById(E.JZa).contentWindow)}Bgn(){let Pc="";return this.sK?Pc=10===this.sK.entryPoint?2===e.AFrameworkApplication.Ha.Ib.Dm?Object(H.a)("ReuseSlidesPaneTitle"):
Object(H.a)("ReuseFilesPaneTitle"):18===this.sK.entryPoint?Object(H.a)("FindInDocumentPaneTitle"):37===this.sK.entryPoint?Object(H.a)("SummarizePaneTitle"):36===this.sK.entryPoint||38===this.sK.entryPoint?Object(H.a)("ConvertToDeckPaneTitle"):Object(H.a)("SmartLookupPaneTitle"):Pc}x3a(){var Pc=Object(H.a)("SmartLookupPaneTitle");e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",!1)&&(Pc=this.Bgn());const Yc=new Vd;Yc.src=this.IKl;Yc.id=
E.JZa;Yc.refreshPane=this.Jii;Yc.onError=this.f_g;Yc.onLoad=this.hSn;Yc.title=Pc;la.SessionStatusManager.instance.kja?this.Iva||(Yc.errorMessage=Object(H.a)("SmartLookupPaneInitializationError"),Yc.errorType=1):(Yc.errorMessage=Object(H.a)("SmartLookupPaneNetworkDisconnected"),Yc.errorType=0);Pc=Object.assign(new Ja.a,{title:Pc,hideHeader:!1,width:E.width,location:E.QVn,contentProps:Yc,isModernPane:!0,onOpen:()=>{this.IZh();this.lSe=!0;this.FVk();ma.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(this.Mnm);
e.AFrameworkApplication.Ha.fg();if(this.Iva)this.Iva.onPaneStateChanged(!0)},onClose:()=>{this.q$n();this.HZh();this.lSe=!1;this.Xxl();ma.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(this.Mnm);e.AFrameworkApplication.Ha.fg();if(this.Iva)this.Iva.onPaneStateChanged(!1)}});this.Wli&&(Pc.enableResize=!0,Pc.minResizeWidth=320,Pc.maxResizeWidth=920);return Pc}f6m(Pc){const Yc=this.x3a();Yc.title=Pc;Yc.contentProps.title=Pc;return Yc}bVi(Pc){const Yc=this.x3a();Yc.resizeWidth=
Pc;return Yc}}Object(c.a)(Na,"ReactSmartLookupPane",ne,[]);var ha=a(192);class sa{constructor(){this.lLl=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartLookupPaneResizingEnabled",!1)}showTaskPane(Pc){ha.a.Gz().then(Yc=>{this.lLl||(Pc.enableResize=!1);Yc.showTaskPane(E.JZa,Pc);return null})}updateTaskPane(Pc=null){ha.a.Gz().then(Yc=>{Yc.setSelectedTaskPane(E.JZa);Pc&&(this.lLl||(Pc.enableResize=!1),Yc.updateTaskPane(E.JZa,Pc));return null})}hideTaskPane(){ha.a.Gz().then(Pc=>
{Pc.hideTaskPane(E.JZa,2);return null})}}Object(c.a)(sa,"PptReactSmartLookupPaneHandler",null,[897]);var xa=a(90);class pb{static vrj(){switch(e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableEdogSourceLocationOverride")?"EDOG":e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableProdSourceLocationOverride")?"PROD":e.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableIntSourceLocationOverride")?"INT":pb.Qgn()){case "INT":return"WAC.INT.URL";case "EDOG":return"WAC.EDOG.URL";
default:return"WAC.PROD.URL"}}static Qgn(){switch(Object(Sb.a)(String,e.AFrameworkApplication.rd.AudienceGroup)||""){case "Dogfood":if(e.AFrameworkApplication.ha){let Pc=e.AFrameworkApplication.ha.Ma("UserPrincipalName");Pc=tb.a.ph(Pc);const Yc=e.AFrameworkApplication.ha.Zt("SmartLookupINTEnabledForSKITeam")?e.AFrameworkApplication.ha.Fz("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(Yc,Pc)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}}Object(c.a)(pb,"Utils",null,[]);class Rb{constructor(Pc,
Yc=null){this.Fva=this.sK=this.FOb=null;this.Rgd=!1;this.Iva=null;this.HX=Pc;this.Vef=Yc?Yc:new cc;l()&&(this.Iva=Xc().ijj());this.aXa=u();this.uId=this.aXa.c1d()}cGe(Pc){if(this.Iva){var Yc=0;this.sK&&(Yc=this.sK.entryPoint);this.aXa.d6f(this.Fva,this.Vef,this.wlc(),Yc).then(Bd=>{ba.xGa("SearchFromHost",this.Fva);this.sK.launchData||(this.sK.launchData=new za.a);const Dd=$a();try{this.Iva.search(this.sK,Bd,e.AFrameworkApplication.userSessionId,Dd,Pc),this.aXa.zpm(Sd=>{ba.xGa("SearchFromHostWithToken",
this.Fva);this.Iva.searchAuthenticatedProviders(this.sK,Bd,e.AFrameworkApplication.userSessionId,Dd,null,Sd)})}catch(Sd){ba.MT("BaseSmartLookupPane - Fail to search from host. Error: "+Sd,10)}}).catch(Bd=>{ba.MT("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+Bd.toString(),10)})}}FVk(){$addHandler(window,"message",Object(w.a)(this,this.Bue,"onIFrameMessage"))}Xxl(){$removeHandler(window,"message",Object(w.a)(this,this.Bue,"onIFrameMessage"))}y2e(Pc){Pc=da.c(Pc);
document.getElementById(this.Q_d())&&document.getElementById(this.Q_d()).contentWindow.postMessage(Pc,ob.a.getOrigin(Ma()))}Bue(Pc){let Yc;Pc=Pc.rawEvent;try{Yc=da.b(Pc.data)}catch(Bd){G.ULS.sendTraceTag(509614105,1303,15,this.CYb("Message data from Serplet [{0}] failed to deserialize.",Pc.data));return}switch(Yc.actionType){case 103:Pc=da.b(Object(Sb.a)(String,Yc.data));ba.sendTelemetryEvent(Pc);break;case 206:this.aXa.xMh(Yc.data).then(Bd=>{Yc.data=Bd;this.y2e(Yc)});break;case 112:Yc.data.shiftPressed?
(ub.a.Yf&&document.activeElement.blur(),this.HX.B2d(0,null,2,null,null),G.ULS.sendTraceTag(509614104,1303,50,this.CYb("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.HX.Krb(0,null,2,null,null),G.ULS.sendTraceTag(509614103,1303,50,this.CYb("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Tx()}}CYb(Pc,...Yc){const Bd={};this.Fva&&(Bd[E.hCm]=this.Fva);Bd[E.iCm]=String.format.apply(null,[Pc].concat(Yc));return da.c(Bd)}bih(Pc){ba.bih(this.Fva,Math.round(window.performance.now()-
Pc),this.sK?aa.a[this.sK.entryPoint]:"",this.aXa.c1d(),this.aXa.L2l(),e.AFrameworkApplication.HTe,this.Rgd,dc(this.sK?this.sK.entryPoint:0))}}Rb.$Wm="AppProperties";Rb.Wfo="SmartLookupApplicationInterface";Object(c.a)(Rb,"BaseCopilotAddin",null,[938,40]);class Fc extends Rb{constructor(Pc,Yc,Bd,Dd){if(!Pc)throw Error.argumentNull("actionManager");if(!Yc)throw Error.argumentNull("appForOfficeManager");if(!Dd)throw Error.argumentNull("f6Manager");super(Dd,Bd);this.pc=!1;this.Afm=!0;this.ycm="FA000000006";
this.la=Pc;this.Ld=Yc;this.JI={};this.XGn=pb.vrj();this.JI.sourceLocationOverrideResourceId=this.XGn;this.JI.UC="Copilot";this.JI.assetId=this.ycm}Sjl(Pc,Yc){this.sK=Pc;const Bd=Object.assign(new P.a,{neighborhood:Pc.selection.neighborhood,mentionStart:Pc.selection.mentionStart,mentionLength:Pc.selection.mentionLength});this.Fva=Yc;this.FOb=Bd;this.Rgd=!Bd.mentionLength;la.SessionStatusManager.instance.kja&&this.Iva?(this.cGe(!1),this.aXa.d6f(this.Fva,this.Vef,this.wlc(),Pc.entryPoint).then(Dd=>{Dd.isFirstLaunch=
this.Afm;this.Afm=!1;const Sd={};Sd[Rb.Wfo]=this.sK;Sd[Rb.$Wm]=Dd;this.JI.nonPersistedSettings=Sd;this.JI.UW=Object(w.a)(this,this.K2c,"onPaneRendered");this.la.Ra(qc.a.kJa,2,this.JI);this.pc=!0})):(this.la.Ra(qc.a.kJa,2,this.JI),this.pc=!0)}K2c(){this.FVk()}Tx(){const Pc=this.Q_d();this.Xxl();Pc&&this.la&&this.la.Ra(qc.a.YUb,2,Pc);this.pc=!1}iZh(Pc,Yc){this.sK=Pc;this.FOb=Pc=Object.assign(new P.a,{neighborhood:Pc.selection.neighborhood,mentionStart:Pc.selection.mentionStart,mentionLength:Pc.selection.mentionLength});
this.Rgd=!Pc.mentionLength;this.Fva=Yc;this.cGe(!1)}dispose(){}Q_d(){if(this.Ld.instance){const Pc=this.Ld.instance.EV(this.ycm+"."+this.JI.sourceLocationOverrideResourceId);if(Pc)return Pc.mq;ld.a.$(509433935,1313,15,"PPT Copilot Addin: Could not find task pane from ID.")}else ld.a.$(509433934,1313,15,"PPT Copilot Addin: AppForOfficeManager is unavailable.");return null}wlc(){return ma.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}get isVisible(){return this.pc}}Object(c.a)(Fc,
"PptCopilotAddin",Rb,[]);class Kc extends td{constructor(Pc,Yc,Bd,Dd,Sd){super();this.zhm=Pc;this.Jb=Bd;this.la=Dd;this.Ld=Sd}mIh(){const Pc=this.Jb.getBooleanAppSetting(xa.a.kZa);return new Na(new sa,h.a.instance,n.FocusManager.instance(),k.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),k.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),k.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),Pc,k.a.instance.eb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))}PQi(){return this.Jb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",
!1)?new Fc(this.la,this.Ld,null,h.a.instance):super.PQi()}NZd(){return this.zhm.getSelectedText()}W9l(){return this.zhm.KPj()}}Object(c.a)(Kc,"SmartLookupManager",td,[]);var jb=a(81);class zb{constructor(Pc,Yc,Bd,Dd,Sd,He,ge){this.cF=Pc;this.Tb=Yc;this.gHn=Bd;this.EGn=Dd;this.TGn=Sd;this.LEn=He;this.oim=ge;this.nTc=new Map;if(!Pc)throw Error.argumentNull("m_appForOfficeManagerFuture");if(!Yc)throw Error.argumentNull("m_transactionFactory");if(!Bd)throw Error.argumentNull("m_textODSLEntity");if(!Dd)throw Error.argumentNull("m_shapeODSLEntity");
if(!Sd)throw Error.argumentNull("m_slideODSLEntity");if(!He)throw Error.argumentNull("m_imageODSLEntity");if(!ge)throw Error.argumentNull("m_tablesODSLEntity");this.cF&&this.cF.execute(ve=>{this.Ld=ve});this.nTc=new Map;this.nTc.set("text",this.gHn);this.nTc.set("shapes",this.EGn);this.nTc.set("slides",this.TGn);this.nTc.set("images",this.LEn);this.nTc.set("tables",this.oim);this.nTc.set("table",this.oim)}z2m(Pc,Yc){return Object.assign({},...Pc.map(Bd=>Yc.has(Bd.value)?{[Bd.name]:Yc.get(Bd.value)}:
{[Bd.name]:JSON.parse(Bd.value)}))}Rvn(Pc){Object(jb.b)(this,void 0,void 0,function*(){if(this.Ld){var Yc=this.Tb.xe(15);try{Yc.tc(this.Ld.dA.presentation);const Bd=new Map;for(const Dd of Pc.statements){const Sd=Dd.name.split("_");if(2!==Sd.length)throw Error.argumentOutOfRange("statement",Sd,"Provided ODSL statement does not have expected format of action_entity.");const He=Sd[0],ge=Sd[1];if(!this.nTc.has(ge))throw Error.argumentOutOfRange("entityName",ge,"Provided entity name in ODSL statement is not supported.");
const ve=this.nTc.get(ge);if(!ve)throw Error.argumentOutOfRange("entity",ve,"Could not access entity for provided ODSL statement.");const ze=this.z2m(Dd.arguments,Bd);if(!ze)throw Error.argumentOutOfRange("args",ze,"Could not construct ODSL statement input from provided args.");let bf;switch(He){case "select":bf=yield ve.select(ze);break;case "format":bf=yield ve.format(ze);break;case "insert":bf=yield ve.insert(ze);break;case "delete":bf=yield ve.delete(ze);break;case "default":throw Error.argumentOutOfRange("action",
He,"Provided action in ODSL statement is not supported.");}Dd.returnVariable&&bf&&Bd.set(Dd.returnVariable,bf)}}catch(Bd){ld.a.$(509440020,1313,15,`SmartLookup PPTSerpletExecutor executeCommand: Exception thrown while executing provided AST. ${Bd}`)}finally{Yc&&Yc.dispose()}}else ld.a.$(509440021,1313,15,"SmartLookup ODSLInterpreter interpret: Skipping execution because no AppForOfficeManager instance exists.")})}}Object(c.a)(zb,"ODSLInterpreter",null,[872]);var ic=a(66),bb;(function(Pc){Pc.Idle=
"Idle";Pc.TranscribingVoice="TranscribingVoice";Pc.EndPending="EndPending";Pc.EndPendingWithCancel="EndPendingWithCancel";Pc.CancelPending="CancelPending"})(bb||(bb={}));Object(c.b)("DictationState",bb);class Pb{constructor(Pc,Yc,Bd,Dd,Sd){this.jc=Pc;this.la=Yc;this.Hj=Bd;this.Na=Dd;this.Gck=[];this.fQh=[];this.osa=bb.Idle;this.ZRh=!1;this.mfe=ic.a.aIh;this.onAction=He=>{if(He)switch(He.actionType){case "SubmitQuery":this.Spn(He.query);break;case "ToggleDictation":this.Oon();break;case "CancelQuery":this.Rpn()}};
this.igj=()=>[this.Gck.join(" "),this.fQh.join()].join(" ");if(!this.jc)throw Error.argumentNull("m_workspace");if(!this.la)throw Error.argumentNull("m_actionManager");if(!this.Hj)throw Error.argumentNull("m_f6Manager");if(!this.Na)throw Error.argumentNull("m_focusManager");if(!Sd)throw Error.argumentNull("actorFuture");Sd.execute(()=>{this.start().catch(He=>{G.ULS.sendTraceTag(509440287,1313,10,`Unable to start Copilot UX, error: ${He}`)})})}Tsj(){this.Qpn();return""}W4l(){return""}Iph(){this.Lpn();
return!0}uFc(){this.ton()}FRl(Pc){this.Znn(Pc);return!0}F8l(Pc){this.von(Pc);return!0}Djm(){}V4e(Pc){var Yc,Bd;G.ULS.sendTraceTag(509113183,1313,15,`Unexpected "${Pc}" called for Dictation FSM state: "${this.osa}". Listening: "${this.ZRh}"`);this.ZRh?(this.osa=bb.EndPending,this.o1h()):(this.osa=bb.Idle,null===(Bd=null===(Yc=this.CSc)||void 0===Yc?void 0:Yc.setMicState)||void 0===Bd?void 0:Bd.call(Yc,!1))}sEm(Pc){var Yc,Bd;null===(Bd=null===(Yc=this.CSc)||void 0===Yc?void 0:Yc.setMicState)||void 0===
Bd?void 0:Bd.call(Yc,Pc)}Qpn(){this.osa!==bb.Idle&&this.osa!==bb.EndPending?this.V4e("handleTextBeforeSelection"):(this.osa=bb.TranscribingVoice,this.sEm(!0))}Lpn(){this.osa!==bb.TranscribingVoice&&this.osa!==bb.EndPending?this.V4e("handleStartTurn"):this.osa=bb.TranscribingVoice}ton(){switch(this.osa){case bb.EndPending:case bb.EndPendingWithCancel:this.sEm(!1);const Pc=this.igj();0<Pc.length&&this.osa===bb.EndPending&&this.Smm(Pc);this.Gck=[];this.fQh=[];this.osa=bb.Idle;break;case bb.CancelPending:this.osa=
bb.EndPendingWithCancel;break;case bb.TranscribingVoice:this.osa=bb.EndPending;break;case bb.Idle:break;default:this.V4e("handleEndTurn")}}Vpn(){this.osa!==bb.TranscribingVoice?this.V4e("handleTimeout"):this.osa=bb.CancelPending}Znn(Pc){var Yc,Bd;this.osa!==bb.TranscribingVoice?this.V4e("handleAppendText"):this.CSc&&(this.fQh.push(Pc),null===(Bd=(Yc=this.CSc).setQuery)||void 0===Bd?void 0:Bd.call(Yc,this.igj()))}von(Pc){var Yc,Bd;this.osa!==bb.TranscribingVoice?this.V4e("handleFinalText"):(this.fQh=
[],""===Pc?this.Vpn():this.CSc&&(this.Gck.push(Pc),null===(Bd=(Yc=this.CSc).setQuery)||void 0===Bd?void 0:Bd.call(Yc,this.igj())))}Spn(Pc){this.osa!=bb.Idle?this.o1h():this.Smm(Pc)}Rpn(){this.osa!==bb.Idle&&(this.o1h(),this.osa=bb.CancelPending)}Oon(){this.o1h()}o1h(){this.la.Ra(ec.a.kNe,2,{bYl:Pb.CHm});this.ZRh=!this.ZRh}Smm(Pc){Pc=Object.assign(new La.a,{selection:Object.assign(new Z.a,{neighborhood:Pc,mentionStart:0,mentionLength:Pc.length}),launchData:Object.assign(new za.a,{landingTab:"Copilot"}),
entryPoint:0});this.la.Ra(nb.a.GYe,2,Pc)}Cfn(){var Pc;this.gda||(this.gda=document.createElement("div"),this.gda.id="copilotHost",(null!==(Pc=document.getElementById(Pb.n_m))&&void 0!==Pc?Pc:document.body).appendChild(this.gda));return this.gda}tco(){this.Na.Kjc(this.mfe);const Pc=this.Na.Uc(this.mfe);Pc.parent=Oa.AFrame.Wl;Pc.US=!0;Pc.e7(()=>{var Yc;null===(Yc=this.CSc)||void 0===Yc?void 0:Yc.focus()});this.Hj.Pma(this.mfe);this.Hj.jZ(this.mfe);this.gda.addEventListener("focusin",Yc=>{var Bd;Yc.preventDefault();
Yc.stopPropagation();(null===(Bd=this.Na.currentScope)||void 0===Bd?void 0:Bd.name)!==this.mfe&&this.Na.haa(this.mfe,!1)});this.gda.addEventListener("focusout",Yc=>{var Bd,Dd,Sd;Yc.preventDefault();Yc.stopPropagation();for(Yc=null!==(Bd=Yc.relatedTarget)&&void 0!==Bd?Bd:document.activeElement;Yc;){if(Yc===this.gda)return;Yc=Yc.parentElement}null===(Sd=null===(Dd=this.CSc)||void 0===Dd?void 0:Dd.collapse)||void 0===Sd?void 0:Sd.call(Dd);this.Na.$da(this.mfe,!1)})}start(){return Object(jb.b)(this,void 0,
void 0,function*(){const Pc=this.Cfn();this.CSc=yield(yield ha.a.m2l()).renderCopilot(Pc,{onAction:this.onAction});if(!this.CSc)throw Error("Copilot control interface is not returned.");this.tco()})}}Pb.n_m="WACViewPanelContainer";Pb.CHm="PowerPointWebEditor.SmartLookup.FABDictationHost";Object(c.a)(Pb,"PptCopilot",null,[576]);var wc=a(1110),Dc=a(1108),ed=a(1109),ad=a(1179),Gd=a(1107),Od=a(1120),Ld=a(279),ee=a(1111);class Ce extends Nb{constructor(){super()}get name(){return"Ppt.SmartLookup"}init(){e.AFrameworkApplication.Dib&&
this.a9m()}oc(Pc){super.oc(Pc);Pc.register(Ub.a,"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").oa().pa(()=>new Ub.a);Pc.register(Kc,"PowerPointWebEditor.SmartLookup.SmartLookupManager").as("Common.App.Insights.IInsightsManager").oa().pa(()=>new Kc(Pc.resolve("Common.App.Insights.IInsightsSelection"),Pc,Pc.resolve("Common.IAppSettingsManager"),Pc.resolve("Common.IActionManagerExtended"),Pc.eb("PowerPointWebEditor.IAppForOfficeManager")));
Pc.register(813,"Common.App.SearchCommon.IDocumentContentExecutor").as("Common.App.SearchCommon.IDocumentContentExecutor").oa().pa(()=>new uc.a(new b.a(()=>fc.App.Zb?fc.App.Zb.Sd.tj:null),fb.InteractiveViewManager.instance,Pc.resolve("Box4.ISelectionFactory"),Pc.resolve("PowerPointWebEditor.ISlideReader"),Pc.resolve("PowerPointWebEditor.IPPTWorkspace"),Pc.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new d.a,Pc.resolve("Common.IActionManagerExtended"),Pc.resolve("PowerPointWebEditor.IPptSelectionManager"),
Pc.resolve("PowerPointWebEditor.IClipServiceManager"),Pc.resolve("PowerPointWebEditor.IPresentationReader")));e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableHALO",!1)&&(Pc.register(Ld.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").as("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper").oa().pa(()=>new Ld.a(Pc.resolve("Box4.Graph.IGraphIteratorFactory"),Pc.resolve("Box4.IOutlineEditor"),Pc.resolve("Box4.IOutlineElementNavigator"),
Pc.resolve("Box4.ICharacterPropertiesEditor"))),Pc.register(Gd.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText").oa().pa(()=>new Gd.a(Pc.eb("PowerPointWebEditor.AppForOfficeManager"),Pc.resolve("PowerPointWebEditor.IPptSelectionManager"),Pc.resolve("Box4.IFormattingEditor"),Pc.resolve("Box4.IParagraphEditor"),Pc.resolve("PowerPointWebEditor.IShapeReader"),Pc.resolve("Box4.List.IListEditor"),Pc.resolve("Box4.ICharacterPropertiesEditor"),
Pc.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),Pc.register(Dc.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape").oa().pa(()=>new Dc.a(Pc.eb("PowerPointWebEditor.AppForOfficeManager"),Pc.resolve("PowerPointWebEditor.IPptSelectionManager"),Pc.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),Pc.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),Pc.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),
Pc.resolve("PowerPointWebEditor.IShapeReader"),Pc.resolve("PowerPointWebEditor.IShapeEditor"),Pc.resolve("PowerPointWebEditor.IPPTUnitConversion"),Pc.resolve("PowerPointWebEditor.View.IPPTPageView"),Pc.resolve("PowerPointWebEditor.IGraphTransactionHelper"),Pc.resolve("PowerPointWebEditor.IRibbonChangeManager"))),Pc.register(ed.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide").oa().pa(()=>new ed.a(Pc.eb("PowerPointWebEditor.AppForOfficeManager"),
Pc.resolve("PowerPointWebEditor.IPptSelectionManager"),Pc.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Pc.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"))),Pc.register(wc.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage").oa().pa(()=>new wc.a(Pc.eb("PowerPointWebEditor.AppForOfficeManager"),Pc.resolve("PowerPointWebEditor.IPptSelectionManager"))),Pc.register(ad.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable").oa().pa(()=>
new ad.a(Pc.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Pc.resolve("PowerPointWebEditor.IPptSelectionManager"),Pc.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),Pc.resolve("PowerPointWebEditor.IFocusManager"),Pc.resolve("PowerPointWebEditor.IShapeEditor"),Pc.resolve("PowerPointWebEditor.IRibbonChangeManager"),Pc.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),Pc.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Pc.resolve("Common.IActionManagerExtended"),
Pc.resolve("PowerPointWebEditor.IGraphTransactionHelper"),Pc.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLGraphHelper"))),Pc.register(Od.a,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLContext").as("PowerPointWebEditor.SmartLookup.ODSLBox4.Interfaces.IODSLContext").oa().pa(()=>new Od.a(Pc.eb("PowerPointWebEditor.AppForOfficeManager"),Pc.resolve("PowerPointWebEditor.IPptSelectionManager"),Pc.resolve("PowerPointWebEditor.IShapeReader"))),Pc.register(zb,"PowerPointWebEditor.SmartLookup.ODSLBox4.ODSLInterpreter").as("PowerPointWebEditor.SmartLookup.ODSLBox4.IODSLInterpreter").oa().pa(()=>
new zb(Pc.eb("PowerPointWebEditor.AppForOfficeManager"),Pc.resolve("Common.Transaction.ITransactionFactory"),Pc.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText"),Pc.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape"),Pc.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide"),Pc.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage"),Pc.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable"))),Pc.register(ee.a,"PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").as("PowerPointWebEditor.SmartLookup.Recommendations.SmartRecommendations").oa().pa(()=>
new ee.a(Pc.resolve("PowerPointWebEditor.IPptSelectionManager"),Pc.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Pc.resolve("Common.Transaction.ITransactionFactory"),Pc.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLText"),Pc.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLShape"),Pc.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLSlide"),Pc.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLTable"),Pc.resolve("PowerPointWebEditor.SmartLookup.ODSLBox4.Entities.ODSLImage"))));
Pc.register(814,"Common.App.SearchCommon.ISerpletExecutor").as("Common.App.SearchCommon.ISerpletExecutor").oa().pa(()=>new bc(Pc.resolve("Common.IActionManagerExtended"),Pc.Db("PowerPointWebEditor.SmartLookup.ODSLBox4.IODSLInterpreter"),Pc.Db("PowerPointWebEditor.SmartLookup.ODSLBox4.Interfaces.IODSLContext")));Pc.register(815,"Common.App.SearchCommon.IInsertContentExecutor").as("Common.App.SearchCommon.IInsertContentExecutor").oa().pa(()=>new Jb(e.AFrameworkApplication.ub,Pc.resolve("PowerPointWebEditor.IPptSelectionManager"),
Pc.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));Pc.register(816,"Common.App.SearchCommon.IDocumentHelper").oa().pa(()=>new Vc);e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CopilotUxIsEnabled",!1)&&(Pc.register(Pb,"PowerPointWebEditor.SmartLookup.PptCopilot").as("PowerPointWebEditor.SmartLookup.PptCopilot").as("PowerPointWebEditor.SmartLookup.FABDictationHost").oa().pa(()=>new Pb(Pc.resolve("PowerPointWebEditor.IPPTWorkspace"),Pc.resolve("Common.IActionManagerExtended"),
h.a.instance,n.FocusManager.instance(),Pc.eb("Common.App.Insights.InsightsActor"))),Pc.resolve("PowerPointWebEditor.SmartLookup.PptCopilot"))}static main(){m.a.instance.Jc(new Ce)}}Object(c.a)(Ce,"PptSmartLookupPackage",Nb,[]);Type.registerNamespace("PowerPointWebEditor.SmartLookup");Ce.main()},279:function(y,C,a){a.d(C,"a",function(){return n});y=a(0);var c=a(45),b=a(62),d=a(21),e=a(47),h=a(470);class n{constructor(m,k,l,u){this.Vb=m;this.vxb=k;this.ZDa=l;this.HI=u;if(!m)throw Error.argumentNull("m_graphIteratorFactory");
if(!k)throw Error.argumentNull("m_outlineEditor");if(!l)throw Error.argumentNull("m_outlineElementNavigator");if(!u)throw Error.argumentNull("m_characterPropertiesEditor");}J1f(m,k,l,u){m=this.M1f(m,k,l,u);k=new d.a;for(const r of m)k.add(b.a.create(r));return k}M1f(m,k,l,u){const r=new c.GraphIterator;r.set(k);k=new d.a;this.Tfb(m,r,l,u,k);return k}Tfb(m,k,l,u,r){let x=null;if(k&&(x=k.uj())){do{switch(x.type){case 12:break;case 35:u&&this.Tfb(m,k,l,u,r);break;case 14:l&&this.Tfb(m,k,l,u,r);break;
default:this.Tfb(m,k,l,u,r)}if(m===x.type&&12===m){if(null===x)throw Error("Could not cast node of NodeType.Paragraph to ParagraphNode");r.add(x)}}while(x=k.Tp());k.Bc()}}nfc(m,k,l){for(const u of k){if(12===m&&(u.LA||u.Gwa&&0===u.HJ().length)){k=this.Vb.Lc(u);u.deleteParagraph();this.vxb.nV(k,!0);this.ZDa.wi(k);k=k.currentNode;const r=e.ParagraphReader.textLength(k);k=b.a.createTextRange(k,0,r);this.HI.replaceTextRange(k,"")}l.push(...this.J1f(m,u,14===m,!1).toArray())}}qxa(m,k,l){for(const u of k)this.nfc(m,
u.Nj(),l)}}n.bL=(m,k,l=!1)=>{const u=()=>{if(k){var r=l?k.bgb():k;m(r);h.a.instance.A4e(u)}};h.a.instance.$Jd(u);return u};Object(y.a)(n,"ODSLGraphHelper",null,[])},371:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.rga=this.TZ=this.fP=null;this.b7a=this.Nua=!1;this.wAb=0;this.lc=null;this.yCa=this.g1b=this.xCa=!1;this.oCa=!0;this.reset()}reset(){this.TZ=[];this.fP=null;this.rga=[];this.b7a=this.Nua=!1;this.wAb=0;this.lc=null;this.yCa=this.g1b=this.xCa=!1;this.oCa=
!0}}Object(y.a)(c,"HtmlPasteContext",null,[])},464:function(y,C,a){a.d(C,"f",function(){return b});a.d(C,"e",function(){return d});a.d(C,"i",function(){return e});a.d(C,"j",function(){return h});a.d(C,"a",function(){return n});a.d(C,"h",function(){return m});a.d(C,"n",function(){return k});a.d(C,"o",function(){return l});a.d(C,"b",function(){return u});a.d(C,"k",function(){return r});a.d(C,"l",function(){return x});a.d(C,"d",function(){return v});a.d(C,"p",function(){return z});a.d(C,"c",function(){return A});
a.d(C,"g",function(){return B});a.d(C,"m",function(){return G});var c=a(210);class b{constructor(w){c.a.assign(b,this,w)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(w){return c.a.matchesTypesFor(w,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class d{constructor(w){c.a.assign(d,this,w)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(w){return c.a.matchesTypesFor(w,
[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class e{constructor(w){c.a.assign(e,this,w)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(w){return c.a.matchesTypesFor(w,[e.getTypeName()])}}e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class h{constructor(w){c.a.assign(h,this,w)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,
[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class n{constructor(w){c.a.assign(n,this,w)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class m{constructor(w){c.a.assign(m,this,w)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext",
"AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class k{constructor(w){c.a.assign(k,this,w)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class l{constructor(w){c.a.assign(l,this,w)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,
[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(w){c.a.assign(u,this,w)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class r{constructor(w){c.a.assign(r,this,w)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,
[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class x{constructor(w){c.a.assign(x,this,w)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class v{constructor(w){c.a.assign(v,this,w)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,
[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class z{constructor(w){c.a.assign(z,this,w)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class A{constructor(w){c.a.assign(A,this,w)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,
[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class B{constructor(w){c.a.assign(B,this,w)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class G{constructor(w){c.a.assign(G,this,w)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(w){return c.a.matchesTypesFor(w,
[G.getTypeName()])}}G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()}},570:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);a=a(760);class c extends a.a{constructor(b,d,e){super(b,d);this.A6e=e}}Object(y.a)(c,"ClipServiceSlideCopyParams",a.a,[])},571:function(y,C,a){a.d(C,"a",function(){return n});y=a(0);var c=a(1704),b=a(53),d=a(51),e=a(80),h=a(55);class n{static ZVb(m,k,l,u,r,x,v,z,A,B,G,w,F,H,E,P=!1){x=w.eIa(!1,m.cid,m.sid,0,k.shapeType,x,v,z,A,B+1);x.setValue(d.a.DK,k.HM);const {vIe:T,qIe:K}=
r.O0d(u,k,l,E,F,H);u=F.Cd;x.setValue(b.a.Hw,u.Bf(E.hH(T,l),0));x.setValue(b.a.MA,u.Bf(E.hH(K,l),1));x.setValue(d.a.$ib,x.Hw);x.setValue(d.a.mgb,x.MA);x.setValue(d.a.koc,!0);x.d1=c.a.Yta(T,0);x.c1=c.a.Yta(K,1);x.setValue(d.a.jIa,0);x.setValue(d.a.kIa,0);x.setValue(d.a.GIa,!0);x.setValue(d.a.isResizable,!0);x.setValue(d.a.kL,!0);x.tM=!0;x.FIa=!0;E=P&&x.fJb;E=95===k.HM||97===k.HM||E;x.kL=!E;x.isResizable=!0;x.setValue(d.a.Nu,E);x.setValue(d.a.hY,95===k.HM);x.xE=e.a.Er(m.sid,m.cid);x.pJa=x.get_shapeId();
x.setValue(d.a.Hfa,!0);m=r.wQd(T,K,l);x.jX=m;(G.oE(x)||G.J$(x))&&h.a.Bb&&(h.a.Bb.pj=!0);E||Array.contains(n.cmc,k.HM)?r.nHe(x):r.wHe(x);return x}}n.cmc=[88,93,94,89,90,91,92];n.FPh=[101,97];Object(y.a)(n,"InsertContentShapeNodeFactory",null,[])},572:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(b,d,e,h){this.HM=b;this.shapeType=d;this.height=e;this.width=h}}Object(y.a)(c,"AutoShapeProps",null,[])},745:function(y,C,a){a.d(C,"a",function(){return k});y=a(0);var c=a(405),
b=a(64),d=a(1227),e=a(43),h=a(56),n=a(92),m=a(47);class k{constructor(l=2E3){this.k$=l}KPj(){const l=k.JO();return this.elg(l)}elg(l){return 0<this.vlc(l).mentionLength}getSelectedText(){const l=k.JO();return this.vlc(l)}vlc(l){return this.u5f(l,!0)}u5f(l,u){var r=null;u&&l&&l.y$&&h.SelectionEditor.fh(l.Ya)&&h.SelectionEditor.Dgb(l.Ya)&&(c.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),r=h.SelectionEditor.pIa(l.Ya,!1));r&&(l=r);if(!l)return Object.assign(new d.a,
{neighborhood:"",mentionStart:0,mentionLength:0});const x=new Sys.StringBuilder;r=u=0;const v=[],z=l.length;for(let B=0;B<z;B++){const G=l.ka(B);if(!m.ParagraphReader.ue(G.node)||Array.contains(v,G.node.zX))continue;v.push(G.node.zX);let w=m.ParagraphReader.text(G.node),F=0;var A=m.ParagraphReader.Zqa(G.node,!0,!0,!0);let H=m.ParagraphReader.Zqa(G.node,!1,!0,!0),E=0;for(;w.length<this.k$&&(A||H);){if(!(E%2)&&A){const P=m.ParagraphReader.text(A);w=P+" "+w;F+=P.length+1;A=m.ParagraphReader.Zqa(A,!0,
!0,!0)}1===E%2&&H&&(w=w+" "+m.ParagraphReader.text(H),H=m.ParagraphReader.Zqa(H,!1,!0,!0));E++}A=B===z-1;B||-1===G.Xa||(u=G.Xa);r+=A&&-1!==G.Mb?G.Mb:w.length;x.append(w);u+=F;r+=F;A||(x.append(" "),r++)}for(l=n.AParagraphNode.goc(x.toString()," ");u<r&&b.a.Wx(l.charCodeAt(u));)u++;for(;r>u&&b.a.Wx(l.charCodeAt(r-1));)r--;return this.syf(l,u,r)}syf(l,u,r){if(l.length>this.k$){var x=r-u;if(x>this.k$)l=l.substr(u,this.k$),r=this.k$,u=0;else{x=Math.max(u-Math.floor((this.k$-x)/2),0);let v;v=Math.min(x+
this.k$,l.length);x=Math.max(v-this.k$,0);u-=x;r-=x;l=l.substring(x,v)}}return Object.assign(new d.a,{neighborhood:l,mentionStart:u,mentionLength:r-u})}static JO(){var l=e.App.Zb.Sd.eo;if(!l)return c.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;l=l.Ob;return l&&l.Wa&&l.Wa.length?l.Wa.qb:(c.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}}Object(y.a)(k,"Box4InsightsSelection",null,[876,877])},760:function(y,C,a){a.d(C,"a",function(){return c});
y=a(0);class c{constructor(b,d){this.Sp=b;this.lc=d}}Object(y.a)(c,"ClipServiceCopyParams",null,[])},761:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.bevelField=null;this.capField=0;this.capFieldSpecified=!1;this.cmpdField=0;this.cmpdFieldSpecified=!1;this.tailEndField=this.solidFillField=this.roundField=this.prstDashField=this.pattFillField=this.noFillField=this.miterField=this.headEndField=this.gradFillField=this.extLstField=
this.custDashField=null;this.wField=0;this.wFieldSpecified=!1}}Object(y.a)(c,"CT_LineProperties",null,[])},762:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.valField=0;this.valFieldSpecified=!1}}Object(y.a)(c,"CT_PresetLineDashProperties",null,[])},763:function(y,C,a){var c=this&&this.Npc||(Object.create?function(d,e,h,n){void 0===n&&(n=h);var m=Object.getOwnPropertyDescriptor(e,h);if(!m||("get"in m?!e.Xea:m.writable||m.configurable))m={enumerable:!0,get:function(){return e[h]}};
Object.defineProperty(d,n,m)}:function(d,e,h,n){void 0===n&&(n=h);d[n]=e[h]}),b=this&&this.__exportStar||function(d,e){for(var h in d)"default"===h||Object.prototype.hasOwnProperty.call(e,h)||c(e,d,h)};Object.defineProperty(C,"__esModule",{value:!0});b(a(1112),C);b(a(1113),C);b(a(1114),C);b(a(1115),C)},776:function(y,C,a){a.d(C,"a",function(){return x});y=a(0);var c=a(654),b=a(1703),d=a(293),e=a(489);class h{constructor(){this.limField=0;this.limFieldSpecified=!1}}Object(y.a)(h,"CT_LineJoinMiterProperties",
null,[]);var n=a(761);class m{constructor(){this.valField=0}}Object(y.a)(m,"CT_PositiveFixedPercentage",null,[]);var k=a(762),l=a(367),u=a(329),r=a(303);class x{O0d(v,z,A,B,G,w){v=Object(b.a)(107,w.Ia.Vg(G.Ua));A=G.Cd;G=Math.round(B.YQ(A.te(z.width*c.a.nz,0),v.rM));z=Math.round(B.YQ(A.te(z.height*c.a.nz,1),v.rM));return{vIe:G,qIe:z}}wQd(v,z){return Object.assign(new d.a,{TopLeft:Object.assign(new r.a,{X:0,Y:0}),TopRight:Object.assign(new r.a,{X:v,Y:0}),BottomLeft:Object.assign(new r.a,{X:0,Y:z}),
BottomRight:Object.assign(new r.a,{X:v,Y:z})})}nHe(v){v.lineStyle=Object.assign(new n.a,{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new h,{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new k.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new u.a,{schemeClrField:Object.assign(new l.a,{valField:4})}),wField:6350,wFieldSpecified:!0})}wHe(v){v.fill=Object.assign(new e.a,{solidFillField:Object.assign(new u.a,
{schemeClrField:Object.assign(new l.a,{valField:4})})});v.lineStyle=Object.assign(new n.a,{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new h,{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new k.a,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new u.a,{schemeClrField:this.eMf(26,Object.assign(new m,{valField:5E4}),4)}),wField:12700,wFieldSpecified:!0})}eMf(v,z,A){const B={};B.itemsElementNameField=
[v];B.itemsField=[z];B.valField=A;return B}}Object(y.a)(x,"InsertShapeActorHelper",null,[899])},845:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);var c;(function(b){b[b.other=0]="other";b[b.Vwm=1]="searchBoxSearch";b[b.Qwm=2]="searchBoxDictionary";b[b.Uwm=3]="searchBoxQuickAnswer";b[b.PAm=4]="smartLookupRibbon";b[b.c0h=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.jYl=7]="dictionary";b[b.jFm=8]="web";b[b.Lpm=9]="pictures";b[b.files=10]="files";b[b.bookmarks=11]="bookmarks";b[b.Bfa=
12]="help";b[b.XTl=13]="chartRecommendation";b[b.gbm=14]="linkSkill";b[b.Swm=15]="searchBoxFindInDocument";b[b.Rwm=16]="searchBoxEntity";b[b.Xwm=17]="searchSkill";b[b.JVl=18]="controlF";b[b.Wvm=19]="ribbonFindButton";b[b.Qvm=20]="reuseSlides";b[b.data=21]="data";b[b.yVl=22]="contextMenuDictionary";b[b.BVl=23]="contextMenuSearchSuggestion";b[b.EVl=24]="contextMenuSynonyms";b[b.AVl=25]="contextMenuSearchBoxSearch";b[b.Wwm=26]="searchBoxSearchZeroTerm";b[b.CVl=27]="contextMenuSearchZeroTerm";b[b.hkm=
28]="note";b[b.LAm=29]="smartLookupAutoLaunch";b[b.DVl=30]="contextMenuSmartLookupInSubMenu";b[b.qXl=31]="dataDisambiguate";b[b.fbm=32]="linkFiles";b[b.Twm=33]="searchBoxNoteL2";b[b.zVl=34]="contextMenuLaunchL2Document";b[b.ROl=35]="actionAI";b[b.kpm=36]="pasteAsNewSlide";b[b.GAm=37]="slidesCompression";b[b.$Yh=38]="searchBoxGenerateDeck";b[b.UWh=39]="powerPointCopilot";b[b.lCm=40]="tellMeService";b[b.srm=99]="prefetch"})(c||(c={}));Object(y.b)("EntryPoint",c)}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25649181/wdjs/ppteditDS.smartlookup.js.map