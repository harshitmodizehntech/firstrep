'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1070:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}Object(y.a)(c,"PersonaInfo",null,[])},1071:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}Object(y.a)(c,"PersonaIdentifiers",null,[])},1072:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(b){this.Rl=b}CXd(b){const d=[];if(b)for(const n in b){var e=n,h=b[n];const m=this.Rl.wld(e);if(m)for(const k of m)d.push(appChrome.actions.updateControlHiddenState(k,
h));else if(e=this.Rl.ELh(e))for(const k of e)if(k.externalUxCommandIds)for(const l of k.externalUxCommandIds)d.push(appChrome.actions.updateControlHiddenState(l,h));else d.push(appChrome.actions.updateGroupHiddenState(k.externalUxGroupId,h))}return d}VKh(b){const d=[];if(b)for(const e in b){if(!b[e])continue;const h=e;h&&d.push(appChrome.actions.deactivateRibbonTab(h))}return d}}Object(y.a)(c,"ReactRibbonTrimmingHelper",null,[])},1135:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{static xuh(b){if(!b)return"{NULL}";
const d=b.length;return 600>=d?b:b.substring(0,400)+"[...]"+b.substring(d-195,d)}}Object(y.a)(c,"LogUtils",null,[])},1136:function(y,C,a){function c(){var d,e;return(null!==(e=null===(d=b.AFrameworkApplication.ha)||void 0===d?void 0:d.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldUseSessionExpirationManagerWithRefreshV2",!1))&&void 0!==e?e:!1)&&b.AFrameworkApplication.Iz&&2==b.AFrameworkApplication.F2h}a.d(C,"a",function(){return c});var b=a(41)},1180:function(y,C,a){a.d(C,"a",function(){return e});
y=a(0);var c=a(1740),b;(function(h){h[h.none=0]="none";h[h.ignoreCase=1]="ignoreCase"})(b||(b={}));Object(y.b)("StringComparison",b);class d{static compare(h,n,m){return!h&&n?-1:h&&!n?1:h||n?m===b.ignoreCase?h.toLowerCase().localeCompare(n.toLowerCase()):h.localeCompare(n):0}static equals(h,n,m){return!d.compare(h,n,m)}static wb(h){return h?!1:!0}}Object(y.a)(d,"StringHelper",null,[]);a=a(21);class e{static PJc(h,n){for(let m=0;m<h.length;m++)if(d.equals(h[m].DisplayColor,n,1))return h[m].Color}static nzh(h,
n){const m=e.p2.indexOf(h);m&&(-1!==m&&e.p2.removeAt(m),e.p2.insert(0,h),e.p2.count===e.Npd+1&&e.p2.removeAt(e.Npd),e.Qgd||(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(n,!1)),e.Qgd=!0))}static N4f(){const h=[];for(let n=0;n<e.p2.count;n++)h.push(Object.assign(new c.a,{Color:e.p2.ka(n),Alt:e.p2.ka(n),DisplayColor:e.p2.ka(n)}));return h}}e.p2=new a.a;e.Npd=10;e.Qgd=!1;Object(y.a)(e,"ColorPickerFormatUtils",null,[])},1245:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(b){this.GDa=
!0;this.eSc=this.qYc=this.OZc=this.lWc=null;this.Kja=b}copy(){return new c(this.Kja.copy())}move(b,d){this.GDa=!0;this.Kja.move(b,d)}setOffsets(b){this.GDa=!0;this.Kja.setOffsets(b)}Ki(){return this.Kja.Ki()}get Mc(){this.qed();return this.lWc}get hd(){this.qed();return this.OZc}get Gd(){this.qed();return this.qYc}get Bd(){this.qed();return this.eSc}qed(){if(this.GDa){var b=this.Kja.points;this.lWc=this.qYc=b[0].x;this.OZc=this.eSc=b[0].y;for(const d of b)this.lWc=Math.min(this.lWc,d.x),this.OZc=
Math.min(this.OZc,d.y),this.qYc=Math.max(this.qYc,d.x),this.eSc=Math.max(this.eSc,d.y);this.GDa=!1}}}Object(y.a)(c,"Boundary",null,[])},1260:function(y,C,a){a.d(C,"a",function(){return r});y=a(0);class c{constructor(){this.vth=this.Qcg=null;this.ork=this.score=this.zUg=0}VDk(x,v,z){this.score=x.ka(v);++v;this.Qcg=x.ka(v)?z.Pqb(x.ka(v)):null;++v;this.vth=x.ka(v)?z.Pqb(x.ka(v)):null;++v;this.zUg=x.ka(v);++v;this.ork=x.ka(v);++v;return v}}Object(y.a)(c,"TokenStringGeneratorInit",null,[]);class b{constructor(x,
v,z,A,B){this.Nkd=x;this.count=v;this.wKh=z;this.Zma=A;this.depth=B}}Object(y.a)(b,"ErrorTolerantTrieMatch",null,[]);var d=a(1513),e=a(1622);class h{constructor(x=null,v=0,z=0,A=0){this.gSm=x||new e.a;this.tIb=v;this.Zma=z;this.depth=A}get gWa(){return this.gSm}getKey(){return this.gWa.KS.toString()+":"+this.tIb.toString()}}Object(y.a)(h,"TrieBookmark",null,[]);class n{constructor(x,v){this.Qmc=x;this.shk=v}YCn(x){if(null==x)throw Error.argumentNull("prefix");let v={};var z=v[""]=new h;this.pNh(z,
v);for(z=0;z<x.length;++z){const A=x.charCodeAt(z),B={};for(let G in v)this.nWm(A,v[G],B);v=B}return this.Ejo(v)}pNh(x,v){if(!(x.Zma>=this.shk)&&(x=new h(d.a.OKi(x.gWa),x.tIb,x.Zma+1,x.depth),x.gWa.n6&d.a.$fd&&(x.tIb+=1),this.Qmc.HNe(x.gWa))){x.depth+=1;let z=!0;for(;z;)n.d2h(x,v),this.pNh(x,v),x.tIb+=this.Qmc.PWe(x.gWa,!0)+(x.gWa.n6&d.a.$fd?1:0),z=this.Qmc.buh(x.gWa)}}nWm(x,v,z){v.Zma+1<=this.shk&&(v.Zma+=1,n.d2h(v,z),--v.Zma);v.gWa.n6&d.a.$fd&&(v.tIb+=1);if(this.Qmc.HNe(v.gWa)){v.depth+=1;let A=
!0;for(;A;)v.gWa.OQe===x?(n.d2h(v,z),this.pNh(v,z)):v.Zma+1<=this.shk&&(v.Zma+=1,n.d2h(v,z),this.pNh(v,z),--v.Zma),v.tIb+=this.Qmc.PWe(v.gWa,!0)+(v.gWa.n6&d.a.$fd?1:0),A=this.Qmc.buh(v.gWa)}}Ejo(x){const v=[];for(var z in x){const A=x[z];if(!A.gWa.KS)continue;const B=!!(A.gWa.n6&d.a.$fd),G=this.Qmc.PWe(A.gWa,!1)+(B?1:0);Array.add(v,new b(A.tIb,G,B,A.Zma,A.depth))}v.sort((A,B)=>{let G=A.Nkd-B.Nkd;return G||(G=-(A.count-B.count))?G:G=A.depth-B.depth});if(2>v.length)return v;x=[];for(z=0;z<v.length;)z+=
n.PCm(z,v,x);return x}static d2h(x,v){const z=x.getKey();z in v?(v=v[z],v.Zma=Math.min(v.Zma,x.Zma)):v[z]=new h(d.a.OKi(x.gWa),x.tIb,x.Zma,x.depth)}static PCm(x,v,z){const A=v[x];let B=A.Nkd;const G=B+A.count;let w=1,F=A.wKh;for(;x+w<v.length&&v[x+w].Nkd<G;){const H=v[x+w];H.Nkd>B&&(Array.add(z,new b(B,H.Nkd-B,F,A.Zma,A.depth)),F=!1);w+=n.PCm(x+w,v,z);B=H.Nkd+H.count}B<G&&Array.add(z,new b(B,G-B,F,A.Zma,A.depth));return w}}Object(y.a)(n,"ErrorTolerantTrieLookupEngine",null,[1104]);class m extends c{constructor(x,
v,z){super();this.k8l=this.jom=!1;this.o_l=null;if(x){var A=0;try{A=this.VDk(x,A,v);this.jom=1===x.ka(A);++A;this.k8l=1===x.ka(A);++A;const B=x.ka(A);this.o_l=this.bWn(z,B)}catch(B){throw Error.argument("initData");}}}bWn(x,v){return new n(x,v)}}Object(y.a)(m,"FuzzyMatchTokenStringGeneratorInit",c,[]);class k extends c{constructor(x,v){super();this.query=this.name=null;if(x){this.annotations=v.annotations;var z=0;try{z=this.VDk(x,z,v),this.name=v.j1(x.ka(z)),++z,this.query=v.tfa(x.ka(z))}catch(A){throw Error.argument("initData");
}}}}Object(y.a)(k,"QueryTokenStringGeneratorInit",c,[]);class l extends c{constructor(x,v){super();if(x)try{this.VDk(x,0,v)}catch(z){throw Error.argument("initData");}}}Object(y.a)(l,"SurfaceStringTokenStringGeneratorInit",c,[]);var u=a(577);class r{constructor(x){this.y$j=x}get Qcg(){return this.y$j.Qcg}get vth(){return this.y$j.vth}get zUg(){return this.y$j.zUg}static create(x,v,z){const {SurfaceStringTokenStringGenerator:A}=a(1810),{QueryTokenStringGenerator:B}=a(1811),{FuzzyMatchTokenStringGenerator:G}=
a(1812);let w=0;try{if(x.ka(w)!==r.SMd)throw Error.argument("initData","Input does not represent a token string generator");++w;const F=x.ka(w);++w;const H=new u.a;H.Ykd(x,w,x.count-w);switch(F){case A.LDf:return new A(new l(H,v));case B.LDf:return new B(new k(H,v));case G.LDf:return new G(new m(H,v,z));default:throw Error.argument("initData");}}catch(F){throw Error.argument("initData");}}static tPl(x,v,z,A,B,G){x=x.ljo.getId(v,null);if(0>x)return++G,G;r.uPl(x,z,A,B);return G}static uPl(x,v,z,A){Array.add(A.bol,
x);Array.add(A.LBm,v);++A.w7e[z]}}r.SMd=1099767983;Object(y.a)(r,"TokenStringGenerator",null,[1098])},141:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);var c=a(1739);class b{constructor(){this.selectedFont=this.vIb=this.uUe=this.YAa=this.pga=this.kAc=this.wIb=this.Mfb=this.kOa=this.xZ=this.RHb=this.LLb=null}Fg(d){this.LLb=new c.a;this.LLb.value=d}Afc(d){this.RHb=new c.a;this.RHb.value=d}boa(d){this.wIb=new c.a;this.wIb.value=d}}Object(y.a)(b,"QueryResult",null,[])},1428:function(y,C,a){a.d(C,
"a",function(){return c});y=a(0);class c{constructor(b){this.$b=b}get f1c(){return this.$b.f1c}get Lho(){return 4!==this.$b.style}get Mho(){return!0}get trie(){return this.$b.trie}getId(b,d){if(!this.Lho)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.$b.style){case 0:return this.Nhn(b,d);default:throw Error.notImplemented();}}j1(b){if(!this.Mho)throw Error.invalidOperation("String lookup not supported on this string table");if(0>b||b>=this.f1c)throw Error.argumentOutOfRange("id",
"Invalid string ID");switch(this.$b.style){case 0:return this.Wln(b);case 4:return this.Vln(b);default:throw Error.notImplemented();}}Nhn(b,d){b=this.$b.trie.$bm(b,0,b.length,d);if(!b.succeeded)return-1;if(0>b.B7e||b.B7e>=this.$b.f1c)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.$b.cuh?this.$b.s$g.DU(this.$b.cuh+4*b.B7e,4):b.B7e}Wln(b){if(this.$b.cuh){let d=0;for(;d<this.$b.f1c&&this.$b.s$g.DU(this.$b.cuh+4*d,4)!==b;++d);if(d>=this.$b.f1c)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");
return this.$b.trie.I4l(d)}return this.$b.trie.I4l(b)}Vln(b){const d=this.$b.s$g.DU(this.$b.JBm+4*b,4);b=this.$b.s$g.DU(this.$b.KBm+4*b,4);if(0>b||0>d)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const e=Array(d);for(let h=0;h<d;++h)e[h]=({Btn:b}=this.z3n(b)).returnValue;return String.fromCharCode.apply(null,e)}z3n(b){let d=0;for(let e=0;3>e;++e){const h=this.$b.s$g.ka(this.$b.VTl+b)^182;++b;d|=(h&127)<<7*e;if(!(h&128))break}return{returnValue:d,Btn:b}}}Object(y.a)(c,
"StringTable",null,[1085])},1429:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);var c=a(1513);class b{constructor(d){this.trie=null;this.VTl=this.JBm=this.KBm=this.cuh=0;if(d){this.s$g=d;var e=0;if(d.DU(e,4)!==b.SMd)throw Error.argument("bytes","Input does not represent a string table");e+=4;this.f1c=d.DU(e,4);e+=4;this.style=d.DU(e,4);e+=4;switch(this.style){case 0:const h=1===d.DU(e,4);e+=4;h||(this.cuh=e,e+=4*this.f1c);d.DU(e,4);this.trie=this.tWn(d,e+4);break;case 4:this.KBm=e;this.JBm=
e+=4*this.f1c;e+=4*this.f1c;d.DU(e,4);this.VTl=e+4;break;default:throw Error.argument("bytes");}}}tWn(d,e){return new c.a(d,e)}}b.SMd=1025118440;Object(y.a)(b,"StringTableInit",null,[])},148:function(y,C,a){a.r(C);a.d(C,"Annotations",function(){return m});y=a(0);var c=a(28),b=a(409),d=a(251),e=a(1428),h=a(1429);class n{constructor(k,l){this.Ogd=!1;this.Zgb=null;if(!k)throw Error.argumentNull("annotations");if(!k.BZe(l))throw Error.argument("structTypeID","Invalid struct type ID");this.lQ=k;this.g_e=
this.lQ.A3l(l);this.LRm=l}get LTe(){return this.lQ}get isReadOnly(){return this.Ogd}get apc(){return this.LRm}yld(k){if(0>k||k>=this.g_e)throw Error.argument("iField","Invalid field index");return this.Zgb&&null!=this.Zgb[k]?this.Zgb[k]:this.lQ.J4l(this.apc,k)}r$k(k,l){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>k||k>=this.g_e)throw Error.argument("iField","Invalid field index");if(!this.lQ.hZe(this.lQ.i1d(this.apc,k),l))throw Error.argument("value",
"Value is not of the correct type for the specified field");(this.Zgb||(this.Zgb=Array(this.g_e)))[k]=l}keb(){const {Annotations:k}=a(148);let l="[";if(this.Zgb){let u=!0;for(let r=0;r<this.g_e;++r){if(null==this.Zgb[r])continue;const x=this.lQ.i1d(this.apc,r);if(k.eud(x,this.Zgb[r],this.lQ.J4l(this.apc,r)))continue;u?u=!1:l+=", ";l+=this.lQ.K4l(this.apc,r);l+="=";const v=this.lQ.keb(x,this.Zgb[r]);x===k.OZa?(l+='"',l+=b.a.N4i(v),l+='"'):l+=v}}return l+"]"}isEqual(k){const {Annotations:l}=a(148);
if(this===k)return!0;if(!k||this.lQ!==k.LTe||this.apc!==k.apc)return!1;for(let u=0;u<this.g_e;++u)if(!l.eud(this.lQ.i1d(this.apc,u),this.yld(u),k.yld(u)))return!1;return!0}clone(){const k=new n(this.lQ,this.apc);this.Zgb&&(k.Zgb=Array.clone(this.Zgb));return k}Zva(){return this.isReadOnly?this.clone():this}L3j(){const {Annotations:k}=a(148);if(!this.isReadOnly&&(this.Ogd=!0,this.Zgb))for(let l=0;l<this.g_e;++l){const u=this.Zgb[l];null!=u&&k.Lce(u)}}toString(){return this.keb()}}Object(y.a)(n,"StructValue",
null,[1080,1078]);class m{constructor(k,l){if(!k)throw Error.argumentNull("initData");if(!l)throw Error.argumentNull("objectFetcher");this.bEn=l.V8m;let u=0;var r=l.ild(k.ka(u));++u;this.gnk=new e.a(new h.a(r));this.GNm=k.ka(u);++u;this.Qdm=Array(this.KJh);this.Tug=Array(this.KJh);this.qod=Array(this.KJh);for(r=0;r<this.KJh;++r){this.Qdm[r]=l.j1(k.ka(u));++u;this.Tug[r]=k.ka(u);++u;var x=k.ka(u);++u;this.qod[r]=Array(x);for(var v=0;v<x;++v)this.qod[r][v]=l.j1(k.ka(u)),++u}this.KRm=k.ka(u);++u;this.him=
Array(this.eqh);this.ITh=Array(this.eqh);this.JTh=Array(this.eqh);this.HTh=Array(this.eqh);for(r=0;r<this.eqh;++r)for(this.him[r]=l.j1(k.ka(u)),++u,x=k.ka(u),++u,this.ITh[r]=Array(x),this.JTh[r]=Array(x),this.HTh[r]=Array(x),v=0;v<x;++v)this.ITh[r][v]=l.j1(k.ka(u)),++u,this.JTh[r][v]=k.ka(u),++u,this.HTh[r][v]=({ogb:u}=this.jpb(this.JTh[r][v],k,u,null,null,null)).returnValue,m.Lce(this.HTh[r][v]);this.lMm=k.ka(u);++u;this.m$j=Array(this.gUe);this.n$j=Array(this.gUe);this.l$j=Array(this.gUe);for(r=
0;r<this.gUe;++r)this.m$j[r]=l.j1(k.ka(u)),++u,this.n$j[r]=k.ka(u),++u,this.l$j[r]=({ogb:u}=this.jpb(this.n$j[r],k,u,null,null,null)).returnValue,m.Lce(this.l$j[r])}kZf(k){for(let l=0;l<this.gUe;++l)if(this.m$j[l]===k)return l;return-1}T1l(k){if(!this.zZe(k))throw Error.argument("attrID","Invalid attribute ID");return this.m$j[k]}getAttributeType(k){if(!this.zZe(k))throw Error.argument("attrID","Invalid attribute ID");return this.n$j[k]}i1d(k,l){if(!this.BZe(k))throw Error.argument("structTypeID",
"Invalid struct type ID");k=this.JTh[m.fqh(k)];if(0>l||l>=k.length)throw Error.argument("iField","Invalid field index");return k[l]}keb(k,l){if(!this.i_j(k))throw Error.argument("typeID","Invalid type ID");if(!this.hZe(k,l))throw Error.argument("value","Value is not of the correct type");switch(k){case m.OZa:return l;case m.MLb:return l?"True":"False";case m.mic:case m.XFb:return l.toString();case m.Gxa:return l.keb();default:if(!m.raa(k)&&m.Vvh(k)){k=m.B4i(k);const x=this.qod[k].length;switch(this.Tug[k]){case 0:return this.qod[k][l];
case 1:if(l){var u="";for(var r=1;r<x;++r)l&1<<r-1&&(0<u.length&&(u+=" & "),u+=this.qod[k][r]);return u}return this.qod[k][0];case 2:u="";for(r=0;r<x;++r)l&1<<r&&(0<u.length&&(u+=" & "),u+=this.qod[k][r]);return u;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.Tug[k]);}}else return l.keb()}}i_j(k){switch(k){case m.OZa:case m.MLb:case m.mic:case m.XFb:case m.Gxa:return!0;default:return m.raa(k)?this.i_j(m.aJc(k)):m.Vvh(k)?this.vzn(k):this.BZe(k)}}vzn(k){k=m.B4i(k);return 0<=
k&&k<this.Qdm.length}BZe(k){k=m.fqh(k);return 0<=k&&k<this.him.length}zZe(k){return 0<=k&&k<this.gUe}hZe(k,l){if(null==l)return!1;switch(k){case m.OZa:return"string"===typeof l;case m.MLb:return"boolean"===typeof l;case m.mic:return"number"===typeof l;case m.XFb:return"number"===typeof l;case m.Gxa:return Object(c.a)(1077,l);default:if(m.raa(k))return Object(c.a)(1079,l)&&l.fTa===m.aJc(k);if(m.Vvh(k)){if("number"!==typeof l)return!1;k=m.B4i(k);const u=this.qod[k].length;switch(this.Tug[k]){case 0:return 0<=
l&&l<u;case 1:return!(l&-1<<u-1);case 2:return!!l&&!(l&-1<<u);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.Tug[k]);}}else return Object(c.a)(1080,l)&&l.apc===k}}get gUe(){return this.lMm}get KJh(){return this.GNm}get eqh(){return this.KRm}zen(k){if(!this.zZe(k))throw Error.argument("attrID","Invalid attribute ID");return this.l$j[k]}A3l(k){if(!this.BZe(k))throw Error.argument("structTypeID","Invalid struct type ID");return this.ITh[m.fqh(k)].length}K4l(k,l){if(!this.BZe(k))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.ITh[m.fqh(k)][l]}J4l(k,l){if(!this.BZe(k))throw Error.argument("structTypeID","Invalid struct type ID");k=this.HTh[m.fqh(k)];if(0>l||l>=k.length)throw Error.argument("iField","Invalid field index");return k[l]}jpb(k,l,u,r,x,v){if(!l)throw Error.argumentNull("initData");if(m.raa(k)){var z=l.ka(u);++u;k=m.aJc(k);var A=new d.a(this,k);for(var B=0;B<z;++B)Array.add(A.items,({ogb:u}=this.jpb(k,l,u,r,x,v)).returnValue);return{returnValue:A,ogb:u}}switch(k){case m.OZa:return{returnValue:(r||
this.gnk).j1(l.ka(u++)),ogb:u};case m.MLb:return{returnValue:1===l.ka(u++),ogb:u};case m.mic:return{returnValue:l.ka(u++),ogb:u};case m.XFb:return{returnValue:(x||this.bEn)[l.ka(u++)],ogb:u};case m.Gxa:k=l.ka(u++);z=new b.a(this);for(A=0;A<k;++A)B=l.ka(u),++u,v&&(B=v[B]),z.GU(B,({ogb:u}=this.jpb(this.getAttributeType(B),l,u,r,x,v)).returnValue);return{returnValue:z,ogb:u};default:if(m.Vvh(k))return{returnValue:l.ka(u++),ogb:u};if(m.xDm(k)){z=l.ka(u++);A=new n(this,k);for(B=0;B<z;++B){const G=l.ka(u);
++u;A.r$k(G,({ogb:u}=this.jpb(this.i1d(k,G),l,u,r,x,v)).returnValue)}return{returnValue:A,ogb:u}}throw Error.argument("typeID","Invalid type ID");}}static Vvh(k){return 16<=(k&16383)&&16384!==(k&16384)&&32768!==(k&32768)}static xDm(k){return 16<=(k&16383)&&16384===(k&16384)&&32768!==(k&32768)}static raa(k){return 32768===(k&32768)}static xin(k){if(m.raa(k))throw Error.argument("nonListTypeID","Non-list type ID required");return k|32768}static aJc(k){if(!m.raa(k))throw Error.argument("listTypeID",
"List type ID required");return k&-32769}static eud(k,l,u){switch(k){case m.OZa:case m.MLb:case m.mic:case m.XFb:return l===u;case m.Gxa:return l.isEqual(u);default:return m.raa(k)?l.isEqual(u):m.Vvh(k)?l===u:l.isEqual(u)}}static Lce(k){Object(c.a)(1078,k)&&k.L3j()}static Zva(k){return Object(c.a)(1078,k)?k.Zva():k}static B4i(k){return k-16}static fqh(k){return(k&-16385)-16}}m.OZa=1;m.MLb=2;m.mic=3;m.XFb=5;m.Gxa=9;Object(y.a)(m,"Annotations",null,[1081])},1513:function(y,C,a){a.d(C,"a",function(){return n});
y=a(0);class c{constructor(m){this.ckm=m;this.succeeded=!1;this.B7e=m?m.B7e:0;this.hzn=!1;this.length=this.$ho=0}}Object(y.a)(c,"TrieResult",null,[]);class b{constructor(m,k,l){this.tB=new c(null);this.tFn=m;this.xxg=k;this.Pdm=k+l-1}get result(){return this.tB}u3l(){let m;return this.xxg<=this.Pdm?(m=this.tFn.charAt(this.xxg),++this.xxg,{returnValue:!0,ch:m}):{returnValue:!1,ch:"\x00"}}AWk(m,k,l){m&&(this.tB.hzn=!0,this.tB.$ho=k);this.tB.length=this.xxg;this.tB.succeeded=!0;this.tB.B7e=l;this.xxg!==
this.Pdm+1&&(this.tB=new c(this.tB))}}Object(y.a)(b,"LookUpStringVisitor",null,[1101]);var d=a(1622);class e{constructor(){this.PTl=this.OSl=this.QSl=this.NSl=this.PSl=this.qDi=this.pDi=this.sDi=this.oDi=0}}Object(y.a)(e,"TRIESTATS",null,[]);class h{constructor(){this.symbol=this.EXg=0}}Object(y.a)(h,"TrieSymbol",null,[]);class n{constructor(m,k){this.LSa=null;this.PRh=this.$em=this.Yem=this.bfm=this.Uem=this.afm=this.Zem=this.cfm=this.Vem=0;this.Rca=m;if(m.DU(k,4)!==n.SMd)throw Error.argument("Input does not represent a trie");
k+=4;this.aem=1===m.DU(k,4);k+=4;this.oEn=1===m.DU(k,4);k+=4;this.gEn=m.DU(k,4);k+=4;if(m.DU(k,4)){m=k+4;this.LSa=this.C3n(m);this.Vem=k=m+n.TZm;this.cfm=k+=n.bHh*(this.LSa.oDi+(this.LSa.oDi%2?1:0));this.Zem=k+=n.bHh*(this.LSa.sDi+(this.LSa.sDi%2?1:0));this.afm=k+=n.bHh*(this.LSa.pDi+(this.LSa.pDi%2?1:0));this.Uem=k+=n.bHh*(this.LSa.qDi+(this.LSa.qDi%2?1:0));this.bfm=k+=n.FDi*this.LSa.NSl;this.Yem=k+=n.GDi*this.LSa.QSl;this.$em=k+=n.GDi*this.LSa.OSl;k+=n.GDi*this.LSa.PSl;if(k!==m+this.LSa.PTl)throw Error.argument("Corrupted trie binary");
this.PRh=k}else this.LSa=null}$bm(m,k,l,u){m=new b(m,k,l);this.gFm(m,u);return m.result}I4l(m){if(this.aem)if(m)--m;else return"";if(!this.LSa)throw Error.argument("Invalid trieID");const k=new d.a;k.n6=0;this.HNe(k);const l=[];for(;;){if(k.n6&n.$fd)if(m)--m;else return Array.add(l,k.OQe),String.fromCharCode.apply(null,l);const u=!!(k.n6&n.K5h),r=this.PWe(k,!0);if(u||m<r){if(Array.add(l,k.OQe),!this.HNe(k))throw Error.argument("Invalid trieID");}else if(m-=r,!this.buh(k))throw Error.argument("Invalid trieID");
}}gFm(m,k){let l=0;this.aem&&(m.AWk(this.oEn,this.gEn,0),++l);if(this.LSa){var u=new d.a;u.n6=0;if(this.HNe(u))for(;;){var r=void 0;if(!({ch:r}=m.u3l()).returnValue)break;k&&(r=k(r));r=r.toString().charCodeAt(0);let x=!1;for(;!x;){const v=!!(u.n6&n.$fd);if(u.OQe===r){if(x=!0,v&&m.AWk(!!(u.n6&n.VHl),u.P0h,l),!this.HNe(u))return}else if(l+=this.PWe(u,!0),!this.buh(u))return;v&&++l}}}}HNe(m){if(!m.n6)return this.mul(m),!0;if(!(m.n6&n.J5h))return!1;m.Dlc=0;m.KS=m.wmd;this.mul(m);return!0}buh(m){if(m.n6&
n.K5h)return!1;this.mul(m);return!0}PWe(m,k){return m.n6&n.UHl?m.XGh:m.n6&n.J5h?!k&&m.n6&n.K5h?this.Hfn(m):1:0}Hfn(m){m=n.OKi(m);if(!this.HNe(m))return 0;let k=0;do m.n6&n.$fd&&++k,k+=this.PWe(m,!1);while(this.buh(m));return k}mul(m){m.n6||(m.Dlc=0,m.KS=this.PRh);var k=this.IIh(this.Vem,m.KS),l=k.symbol;m.KS+=k.EXg;k=this.Rca.DU(this.Uem+n.FDi*l,n.FDi);m.OQe=k&65535;m.n6=k>>16;m.n6&n.UHl&&(m.XGh=this.O6m(m));m.n6&n.VHl&&(k=this.IIh(this.cfm,m.KS),l=k.symbol,m.KS+=k.EXg,m.P0h=this.Rca.DU(this.bfm+
4*l,4));m.n6&n.DKm?(m.wmd=this.PRh+((this.Rca.ka(m.KS)<<8|this.Rca.ka(m.KS+1))<<8|this.Rca.ka(m.KS+2)),m.KS+=3):m.n6&n.EKm?(m.wmd=m.KS,m.Dlc=m.wmd):m.n6&n.FKm?(k=this.IIh(this.Zem,m.KS),l=k.symbol,m.KS+=k.EXg,m.wmd=this.PRh+this.Rca.DU(this.Yem+4*l,4)):m.n6&n.J5h&&(k=this.IIh(this.afm,m.KS),l=k.symbol,m.KS+=k.EXg,m.Dlc||(m.Dlc=m.KS),m.Dlc+=this.Rca.DU(this.$em+4*l,4),m.wmd=m.Dlc)}IIh(m,k){const l=new h;let u=0;for(;;){u+=this.Rca.ka(k);++k;++l.EXg;const r=this.Rca.DU(m,2);if(u<r)break;l.symbol+=r;
u-=r;m+=2;u<<=8}l.symbol+=u;return l}O6m(m){let k=this.Rca.ka(m.KS);192<=k?(k=(k&63)<<15|(this.Rca.ka(m.KS+1)&127)<<8,k|=this.Rca.ka(m.KS+2),m.KS+=3):128<=k?(k=(k&127)<<8|this.Rca.ka(m.KS+1),m.KS+=2):m.KS+=1;return k}C3n(m){const k=new e;k.oDi=this.Rca.DU(m+12,2);k.sDi=this.Rca.DU(m+14,2);k.pDi=this.Rca.DU(m+16,2);k.qDi=this.Rca.DU(m+18,2);k.PSl=this.Rca.DU(m+24,4);k.NSl=this.Rca.DU(m+28,4);k.QSl=this.Rca.DU(m+32,4);k.OSl=this.Rca.DU(m+36,4);k.PTl=this.Rca.DU(m+40,4);return k}static OKi(m){const k=
new d.a;k.OQe=m.OQe;k.n6=m.n6;k.XGh=m.XGh;k.KS=m.KS;k.wmd=m.wmd;k.Dlc=m.Dlc;k.P0h=m.P0h;return k}}n.SMd=1654263084;n.TZm=48;n.bHh=2;n.GDi=4;n.FDi=4;n.$fd=1;n.K5h=2;n.UHl=4;n.VHl=8;n.J5h=16;n.EKm=64;n.FKm=128;n.DKm=256;Object(y.a)(n,"Trie",null,[1095])},160:function(y,C,a){a.d(C,"a",function(){return c});a.d(C,"b",function(){return b});const c=d=>null===d||"undefined"===typeof d||!d.length,b=d=>null===d||"undefined"===typeof d},1621:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c extends Sys.EventArgs{constructor(b){super();
this.boc=b}}Object(y.a)(c,"SessionRehydratedEventArgs",Sys.EventArgs,[])},1622:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.P0h=this.Dlc=this.wmd=this.KS=this.XGh=this.n6=this.OQe=0}}Object(y.a)(c,"TRIESCAN",null,[])},1810:function(y,C,a){a.r(C);a.d(C,"SurfaceStringTokenStringGenerator",function(){return b});y=a(0);var c=a(1260);class b extends c.a{constructor(d){super(d);this.$b=d}apply(d,e,h,n,m,k,l){null==k&&(k=d.g5l(m,e));l=c.a.tPl(d,k,this.$b.score,h,n,l);
return{wth:k,KDf:l}}}b.LDf=0;Object(y.a)(b,"SurfaceStringTokenStringGenerator",c.a,[])},1811:function(y,C,a){a.r(C);a.d(C,"QueryTokenStringGenerator",function(){return d});y=a(0);var c=a(1260),b=a(148);class d extends c.a{constructor(e){super(e);this.$b=e}apply(e,h,n,m,k,l,u){h=this.$b.query.load(h,null);k=0;let r=null;this.$b.query.GUa===b.Annotations.MLb?h&&(r=this.$b.name):((r=this.$b.name)&&(r+="_"),r+=this.$b.annotations.keb(this.$b.query.GUa,h));null!=r&&(k=c.a.tPl(e,r,this.$b.score,n,m,k));
return{wth:l,KDf:u+k}}}d.LDf=1;Object(y.a)(d,"QueryTokenStringGenerator",c.a,[])},1812:function(y,C,a){a.r(C);a.d(C,"FuzzyMatchTokenStringGenerator",function(){return b});y=a(0);var c=a(1260);class b extends c.a{constructor(d){super(d);this.$b=d}apply(d,e,h,n,m,k,l){null==k&&(k=d.g5l(m,e));d=this.$b.o_l.YCn(k);if(this.$b.jom)for(var u of d)if(!u.Zma&&u.wKh)return{wth:k,KDf:l};u=0;for(const r of d)if(r.Zma&&!({rDi:u}=this.LRl(r,!0,h,n,u)).returnValue)return{wth:k,KDf:l};if(this.$b.k8l)for(const r of d)if(!({rDi:u}=
this.LRl(r,!1,h,n,u)).returnValue)break;return{wth:k,KDf:l}}LRl(d,e,h,n,m){let k;e?(e=0,k=d.wKh?1:0):(e=d.wKh?1:0,k=d.count-e);for(let l=0;l<k;++l)if(c.a.uPl(d.Nkd+e+l,this.$b.score,h,n),++m,0<this.$b.ork&&m>=this.$b.ork)return{returnValue:!1,rDi:m};return{returnValue:!0,rDi:m}}}b.LDf=2;Object(y.a)(b,"FuzzyMatchTokenStringGenerator",c.a,[])},1894:function(y,C,a){function c(V){return V.includes("aadInteractionRequired")||V.includes("sessionRevocation")||V.includes("blockAccessForTenantRestrictions")||
V.includes("revoked")||V.includes("Due to organizational policies, you can't access these resources from this network location")?!0:!1}function b(){return l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getBooleanAppSetting("WopiTokenRevokedTokenExperiment")&&l.AFrameworkApplication.ha.getBooleanAppSetting("ShowTokenRevocationErrorMessage"):!1}function d(){return l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldKickoutWhenMaxRetries",
!1):!1}function e(){return l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.WordOnline.MaxConsecutiveTokenRefreshFailures",3):3}function h(V,Ea){var Za;null===(Za=n(V,Ea).Ci)||void 0===Za?void 0:Za.handleShapeNodeGC2ModelSync()}function n(V,Ea){return V?V.Vg(Ea):null}function m(V,Ea,Za){const ia={};ia.crop={left:V.Left,top:V.Top,right:V.Right,bottom:V.Bottom};(V=n(Ea,Za))&&V.Ci&&(V=V.Ci)&&V.t9("UpdateCrop",ia)}a.r(C);var k=a(0),l=a(41),u=a(95),r=a(405),x=a(1067),
v=a(124),z=a(50),A=a(38),B=a(6),G=a(1889),w=a(88),F=a(215),H=a(114),E=a(825),P=a(119);class T{static get Vl(){return P.a.jU(T.Sx,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}T.Sx="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(k.a)(T,"InsertSymbolsDialogHtml",null,[]);var K=a(48),M=a(264);class N extends G.a{constructor(V,Ea,Za){super();this.vLl=this.Bjc=this.yhd=null;this.tci=0;this.TBm=ia=>{if(ia.target!==this.vLl){const Va=this.Fe.yu();Va&&Va.fm&&(Va.fm.qO(ia.target),this.vLl=ia.target)}this.VTn(ia.target.id)};this.Rho=ia=>{const Va=ia.Hc;if("a"!==Va.tagName.toLowerCase())return!1;ia.eventName===w.a.doubleClick&&this.Ayk(Va.id);this.Fe.haa(this.HZ,!0);this.Fe.yu().fm.qO(Va);Va.focus();return!0};this.Tho=ia=>{var Va=
ia.Hc;if("a"!==Va.tagName.toLowerCase())return!1;const Ab=parseInt(Va.id.substr(Va.id.lastIndexOf("_")+1));if(ia.Pb.ctrlKey||ia.Pb.altKey||ia.Pb.keyCode>=F.a.fjc&&ia.Pb.keyCode<=F.a.ijb)return!1;if(ia.eventName===w.a.oi){ia=ia.Pb.keyCode;let gc=-1;ia===Sys.UI.Key.enter?(this.Ayk(Va.id),this.Fe.haa(this.HZ,!0),this.Fe.yu().fm.qO(Va),Va.focus()):ia===Sys.UI.Key.up?gc=Ab-15:ia===Sys.UI.Key.down?gc=Ab+15:ia===Sys.UI.Key.left?gc=l.AFrameworkApplication.isRtl?Ab+1:Ab-1:ia===Sys.UI.Key.right&&(gc=l.AFrameworkApplication.isRtl?
Ab-1:Ab+1);0<=gc&&(Va=this.nsj("symbol_d_"+gc))&&Va.focus()}return!0};this.Aa=V;this.Fe=Ea;this.Swc=Za;this.vg(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.vg(0,CommonUIStrings.l_DialogClose);this.j$=!1;this.Vl=T.Vl;this.rj="InsertSymbolsDialog"}dispose(){0<N.Cmi&&r.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.tci,N.Cmi);N.AJl++;r.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",N.AJl);this.Aa=
this.Swc=null;super.dispose()}rEb(){this.qp(Box4Intl.Box4Strings.L_SymbolSingle,Object(B.a)(this,this.Ivn,"insertSymbolsDialogHandler"),null);this.tci=0;N.DJl++;r.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",N.DJl);const V=this.nsj("symbol_d_"+N.Nlf);V&&V.focus()}hide(){var V=document.getElementById("symbolsContainer");if(V&&(V=V.getElementsByTagName("a")))for(let Ea=0;Ea<V.length;Ea++)H.a.removeHandler(V[Ea],w.a.focus,this.TBm);super.hide()}Ivn(V){1===V?(this.Ayk("symbol_d_"+
N.Nlf),this.Fe.haa(this.HZ,!0),this.Fe.yu().fm.qO(this.aK),this.aK.focus()):this.hide()}get MZe(){return N.ELl}set MZe(V){N.ELl=V}get KZe(){return N.zLl}set KZe(V){N.zLl=V}fZa(){super.fZa();var V=document.getElementById("symbolsContainer");if(V&&(E.a.uLb(V,this.Swc.ZYm(),"InsertSymbolsDialog"),V=V.getElementsByTagName("a")))for(let Ea=0;Ea<V.length;Ea++)H.a.addHandler(V[Ea],w.a.focus,this.TBm)}s2a(){const V=document.getElementById("symbolsContainer");V&&(this.yhd||(this.yhd=this.Rho,this.pv.Ub(w.a.click,
V,this.yhd),this.pv.Ub(w.a.doubleClick,V,this.yhd)),this.Bjc||(this.Bjc=this.Tho,this.Tj.Ub(w.a.oi,V,this.Bjc),this.Tj.Ub(w.a.hA,V,this.Bjc),this.Tj.Ub(w.a.jn,V,this.Bjc)));super.s2a()}O3a(){const V=document.getElementById("symbolsContainer");V&&(this.yhd&&(this.pv.hc(w.a.click,V,this.yhd),this.pv.hc(w.a.doubleClick,V,this.yhd),this.yhd=null),this.Bjc&&(this.Tj.hc(w.a.oi,V,this.Bjc),this.Tj.hc(w.a.hA,V,this.Bjc),this.Tj.hc(w.a.jn,V,this.Bjc),this.Bjc=null));super.O3a()}VTn(V){this.Rym("symbol_d_"+
N.Nlf,!1);N.Nlf=parseInt(V.substr(V.lastIndexOf("_")+1));this.Rym(V,!0);if(V=document.getElementById("SymbolNameValueLabel")){const Ea=this.sXe(N.Nlf);V.innerText=Ea.altText}}sXe(V){const Ea=this.Swc.O0h.cpl.value,Za=M.a(Ea);return Ea[Za[V]]}Ayk(V){this.tci++;N.Cmi++;V=parseInt(V.substr(V.lastIndexOf("_")+1));const Ea=this.sXe(V),Za={};Za.SourceControlId="symbol_"+V+"_"+Ea.N0h;this.Aa.Ra(K.a.tgb,2,Za);r.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",V)}nsj(V){const Ea=
document.getElementById("symbolsContainer");return Ea?Ea.querySelector("#"+V):null}Rym(V,Ea){(V=this.nsj(V))&&(Ea?V.setAttribute("selected","true"):V.removeAttribute("selected"))}}N.Nlf=0;N.ELl=null;N.zLl=null;N.DJl=0;N.AJl=0;N.Cmi=0;Object(k.a)(N,"InsertSymbolsDialog",G.a,[]);var I=a(56),O=a(63),Q=a(52),U=a(195),ba=a(120);class aa{constructor(V,Ea,Za,ia,Va,Ab,gc,Hc){this.mmn=()=>this.Swc.vZm();this.osj=()=>this.Swc.build();this.csm=(fd,hd,yd,Md,te)=>{if(1===yd)return 32;fd=this.Swc.ipm(te);fd=String.format(this.Swc.Sho,
fd.character);te[x.a.InnerHTML]=fd;te[x.a.On]=!1;return 32};this.Aa=V;this.PM=Ea;this.ORm=new A.a(this.mmn);this.PRm=new A.a(this.osj);this.Zl=Za;this.Swc=ia;this.Ry=Va;this.Py=Ab;this.Qc=gc;this.ll=Hc}Kb(){this.Aa.ua(K.a.X3e,Q.a.application,Object(B.a)(this,this.X3e,"queryInsertSymbols"),96);this.Aa.Ba(K.a.I4c,Q.a.view,Object(B.a)(this,this.I4c,"populateSymbolsDropDown"));this.Aa.Ba(K.a.X6e,Q.a.view,Object(B.a)(this,this.UBm,"symbolsDropDownOpenHandler"));this.Aa.Ba(K.a.AXh,Q.a.view,this.csm);this.Aa.Ba(K.a.tgb,
Q.a.view,Object(B.a)(this,this.XMc,"insertSymbolViewHandler"));this.Aa.Ba(K.a.I4c,Q.a.sg,Object(B.a)(this,this.I4c,"populateSymbolsDropDown"));this.Aa.Ba(K.a.X6e,Q.a.sg,Object(B.a)(this,this.UBm,"symbolsDropDownOpenHandler"));this.Aa.Ba(K.a.AXh,Q.a.sg,this.csm);this.Aa.Ba(K.a.tgb,Q.a.sg,Object(B.a)(this,this.Hvn,"insertSymbolHandler"));this.Aa.we(K.a.I4c,1124);this.Aa.we(K.a.X6e,1036);this.Aa.we(K.a.AXh,1124);this.Aa.we(K.a.tgb,1036);l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting("InsertMoreSymbolsIsEnabled")&&
(this.Aa.Ba(K.a.Emd,Q.a.view,Object(B.a)(this,this.Vzm,"showInsertMoreSymbolsDialogHandler")),this.Aa.Ba(K.a.Emd,Q.a.sg,Object(B.a)(this,this.Vzm,"showInsertMoreSymbolsDialogHandler")),this.Aa.we(K.a.Emd,1124))}XMc(V,Ea,Za,ia,Va){if(({Xf:V,selected:Za,XMc:Hc}=this.sXl(Ea,Za)).returnValue)return Hc;var Ab=I.SelectionEditor.fh(Za);let gc=!0;Za=8;var Hc=this.Zl.xe(15);Hc.ld(V.ih);Ab||(Za=this.Aa.hi(Ea,K.a.tNa,2,!0,ia,null),Ea=32===Za,r.ULS.shipAssertTag(6407387,348,Ea,"DeleteForReplace did not succeed. Response is {0}",
Za),gc=Ea);gc&&(Ea=V.Ob.sk,Ab=I.SelectionEditor.fh(Ea),r.ULS.shipAssertTag(6407388,348,Ab,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",Ea.contextId),Za=8,Ab&&(Za=this.Aa.hi(Ea,K.a.tgb,2,!1,ia,Va),r.ULS.shipAssertTag(6407389,348,32===Za,"Insertion at IP context did not succeed. Response is {0}",Za),32===Za&&v.FocusManager.instance().Ag(V.KF)));Hc.dispose();return Za}sXl(V,Ea){let Za,ia;Za=null;V.view.ki&&(Za=V.view);ia=null;return Za&&Za.Ob?(ia=Za.Ob.sk)?this.Py.ka(14)&&
this.Ry.wfb(ia)?{returnValue:!0,Xf:Za,selected:ia,XMc:8}:Za.Ob.Wa.MF||this.ll&&this.ll.instance&&this.ll.instance.eY(ia)||I.SelectionEditor.X8d(V.TF)?{returnValue:!0,Xf:Za,selected:ia,XMc:2}:1===Ea?{returnValue:!0,Xf:Za,selected:ia,XMc:32}:{returnValue:!1,Xf:Za,selected:ia,XMc:32}:{returnValue:!0,Xf:Za,selected:ia,XMc:2}:(ba.c(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",V.toString()),{returnValue:!0,Xf:Za,selected:ia,
XMc:8})}Hvn(V,Ea,Za,ia,Va){if(1===Za)return 32;if(I.SelectionEditor.X8d(Ea))return 2;V=this.Swc.ipm(Va);ia.AD=V.index;ia=this.PM.Lc(Ea.node);Za=ia.sc(11);r.ULS.shipAssertTag(6379466,324,Za,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",U.a[Ea.node.type]);Za=this.Zl.xe(15);Za.My(ia);aa.characterPropertiesEditor.replaceTextRange(Ea,V.character,!0,!1);Ea=O.SelectionFactory.Mg(ia.currentNode,Ea.Xa+1);this.Qc.setSelection(Ea);Za.dispose();return 32}I4c(V,Ea,Za,ia,Va){if(1===
Za)return 32;l.AFrameworkApplication.Ha&&l.AFrameworkApplication.Ha.Ib.ex?Va.MenuItems=this.ORm.value:Va.PopulationXML=this.PRm.value;return 32}UBm(V,Ea,Za){return this.sXl(Ea,Za).XMc}Vzm(V,Ea,Za){2===Za&&(new N(this.Aa,v.FocusManager.instance(),z.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).rEb();return 32}X3e(){return 32}static get characterPropertiesEditor(){return aa.Vh||(aa.Vh=z.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(V){aa.Vh=V}}
aa.Vh=null;Object(k.a)(aa,"SymbolsActor",null,[731]);class La{constructor(V,Ea){this.N0h=V;this.altText=Ea}}Object(k.a)(La,"Symbol",null,[]);class Z{constructor(){this.Cli=null;this.lOl=new A.a(Z.tMf)}get cpl(){return this.lOl}din(V){this.Cli||(this.Cli=M.a(this.lOl.value));return Array.indexOf(this.Cli,V)}static tMf(){const V={};V["\u2022"]=new La("\u2022",Box4Intl.Box4Strings.L_Bullet);V["\u20ac"]=new La("\u20ac",Box4Intl.Box4Strings.L_EuroSign);V["\u00a3"]=new La("\u00a3",Box4Intl.Box4Strings.L_PoundSign);
V["\u00a5"]=new La("\u00a5",Box4Intl.Box4Strings.L_YenSign);V["\u00a9"]=new La("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);V["\u00ae"]=new La("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);V["\u2122"]=new La("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);V["\u00b1"]=new La("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);V["\u2260"]=new La("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);V["\u2264"]=new La("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);V["\u2265"]=new La("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);
V["\u00f7"]=new La("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);V["\u00d7"]=new La("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);V["\u221e"]=new La("\u221e",Box4Intl.Box4Strings.L_Infinity);V["\u00b5"]=new La("\u00b5",Box4Intl.Box4Strings.L_MicroSign);V["\u03b1"]=new La("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);V["\u03b2"]=new La("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);V["\u03c0"]=new La("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);V["\u03a9"]=new La("\u03a9",
Box4Intl.Box4Strings.L_OhmSign);V["\u03a3"]=new La("\u03a3",Box4Intl.Box4Strings.L_NArySummation);V["\u00b0"]=new La("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);V["\u0394"]=new La("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);V["\u263a"]=new La("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);V["\u2665"]=new La("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);V["\u20b9"]=new La("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);V["\u00bf"]=new La("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);
V["\u00a1"]=new La("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);V["\u2014"]=new La("\u2014",Box4Intl.Box4Strings.L_EmDash);V["\u2026"]=new La("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);V["\u00c0"]=new La("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);V["\u00c1"]=new La("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);V["\u00c2"]=new La("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);V["\u00c3"]=new La("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);
V["\u00c4"]=new La("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);V["\u00c5"]=new La("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);V["\u00c6"]=new La("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);V["\u00c7"]=new La("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);V["\u00c8"]=new La("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);V["\u00c9"]=new La("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);V["\u00ca"]=new La("\u00ca",
Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);V["\u00cb"]=new La("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);V["\u00cc"]=new La("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);V["\u00cd"]=new La("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);V["\u00ce"]=new La("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);V["\u00cf"]=new La("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);V["\u00d1"]=new La("\u00d1",
Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);V["\u00d2"]=new La("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);V["\u00d3"]=new La("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);V["\u00d4"]=new La("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);V["\u00d5"]=new La("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);V["\u00d6"]=new La("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);V["\u00d9"]=new La("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);
V["\u00da"]=new La("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);V["\u00db"]=new La("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);V["\u00dc"]=new La("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);V["\u00df"]=new La("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);V["\u00e0"]=new La("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);V["\u00e1"]=new La("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);V["\u00e2"]=new La("\u00e2",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);V["\u00e3"]=new La("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);V["\u00e4"]=new La("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);V["\u00e5"]=new La("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);V["\u00e6"]=new La("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);V["\u00e7"]=new La("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);V["\u00e8"]=new La("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);
V["\u00e9"]=new La("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);V["\u00ea"]=new La("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);V["\u00eb"]=new La("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);V["\u00ec"]=new La("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);V["\u00ed"]=new La("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);V["\u00ee"]=new La("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);V["\u00ef"]=new La("\u00ef",
Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);V["\u00f1"]=new La("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);V["\u00f2"]=new La("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);V["\u00f3"]=new La("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);V["\u00f4"]=new La("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);V["\u00f5"]=new La("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);V["\u00f6"]=new La("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);
V["\u00f9"]=new La("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);V["\u00fa"]=new La("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);V["\u00fb"]=new La("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);V["\u00fc"]=new La("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);V["\u00ff"]=new La("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);V["\u011e"]=new La("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);V["\u011f"]=
new La("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);V["\u0130"]=new La("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);V["\u0131"]=new La("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);V["\u0152"]=new La("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);V["\u0153"]=new La("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);V["\u015e"]=new La("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);V["\u015f"]=new La("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);
V["\u0178"]=new La("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return V}}Object(k.a)(Z,"SymbolsLoader",null,[729]);var la=a(64),da=a(341),J=a(291),Ca=a(240),Fa=a(598),ya=a(1741),Ua=a(156),Ia=a(109);class Oa{constructor(V){this.QRm=V}get O0h(){return this.QRm}get Sho(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}ipm(V){V=V.SourceControlId.split("_");const Ea={};2===V.length?(Ea.character=V[1],Ea.index=this.O0h.din(Ea.character)):
(Ea.character=V[2],Ea.index=parseInt(V[1]));return Ea}vZm(){return this.P4l()}build(){return this.osj()}ZYm(){const V=new Sys.StringBuilder;V.append('<table class="moreSymbolsTable">');const Ea=this.O0h.cpl.value,Za=M.a(Ea);let ia=0;for(;ia<Za.length;){ia%15||V.append('<tr role="presentation">');const Va=Ea[Za[ia]];V.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+ia,la.a.gsb(Va.N0h),la.a.gsb(Va.altText)));ia++;ia%15&&ia!==Za.length||V.append("</tr>")}V.append("</table>");return V.toString()}osj(){const V=this.P4l();return Ua.l(V)}P4l(){const V=Object.assign(new da.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Array.add(V.MenuSectionList,this.BUm());l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting("InsertMoreSymbolsIsEnabled")&&Array.add(V.MenuSectionList,this.ZTm());return V}ZTm(){const V=Object.assign(new J.a,{Id:"msMoreSymbols",
Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),Ea=Object.assign(new Ca.a,{Id:"btnMoreSymbols",Command:"3574218963",LabelText:la.a.We(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:la.a.We(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:l.AFrameworkApplication.Ln,Image16by16Class:Ia.d("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Array.add(V.ControlList,Ea);return V}BUm(){const V=Object.assign(new J.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,
ControlList:[]}),Ea=Object.assign(new Fa.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),Za=this.O0h.cpl.value,ia=M.a(Za),Va=Math.min(25,ia.length);for(let gc=0;gc<Va;gc++){var Ab=Za[ia[gc]];Ab=Object.assign(new ya.a,{Id:String.format("{0}{1}_{2}","symbol_",gc,Ab.N0h),Character:Ab.N0h,Command:"3966968829",QueryCommand:"816646517",Alt:la.a.We(Ab.altText)});Ea.GalleryItems.push(Ab)}Array.add(V.ControlList,
Ea);return V}}Object(k.a)(Oa,"SymbolsUiBuilder",null,[730]);var ma=a(78),za=a(138),Qa=a(49),Xa=a(605),Tb=a(364);class Kb{constructor(){this.Oa=null}get name(){return"Box4.Symbols"}init(){l.AFrameworkApplication.ha.getBooleanAppSetting("InsertSymbolIsEnabled")&&this.Oa.resolve("Box4.Symbols.ISymbolsActor").Kb()}dispose(){}oc(V){this.Oa=V;this.Oa.register(Z,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").oa();this.Oa.register(Oa,"Box4.Symbols.SymbolsUiBuilder").as("Box4.Symbols.ISymbolsUIBuilder").oa().pa(()=>
new Oa(this.Oa.resolve("Box4.Symbols.ISymbolsLoader")));this.Oa.register(aa,"Box4.Symbols.SymbolsActor").as("Box4.Symbols.ISymbolsActor").oa().pa(()=>new aa(l.AFrameworkApplication.ub,new Xa.a,new Tb.a,this.Oa.resolve("Box4.Symbols.ISymbolsUIBuilder"),za.a.instance,Qa.a.instance,ma.a.instance,this.Oa.eb("Box4.IExternalSelectionManager")))}static main(){u.a.instance.Jc(new Kb)}}Object(k.a)(Kb,"Box4SymbolsPackage",null,[4,5]);var nb=a(1187),Ka=a(15),Sb=a(100),ab=a(1135);class ub{constructor(V,Ea){this.bki=
this.aki=null;this.MSe=new nb.a;this.MAk=Za=>{let ia=null;ia&&ia.length||!Za||!Za.data||(ia=Za.data.responseData);if(ia&&ia.length)try{const Va=Ka.a(ia);this.aki=Va.NavBarDataJson;r.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.aki?({NB:this.bki}=Ka.d(Va.NavBarDataJson)).returnValue?(this.eCn(this.bki),this.MSe.lj(this.bki)):(r.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:ab.a.xuh(this.aki)}),this.MSe.TUa()):(r.ULS.sendTraceTag(9000737,
215,15,"ShellData is null"),this.MSe.TUa())}catch(Va){r.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.MSe.TUa()}else r.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")};this.HZg=()=>{this.MSe.TUa();r.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};this.Dn=V;this.Meb=Ea.appSettings[ub.Uoo]||""}get lzm(){return this.MSe.task}get DJ(){return this.Dn.value}P7n(){const V={};V[ub.iqn]=l.AFrameworkApplication.Fh;
V["Content-Type"]="application/json; charset=utf-8";r.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const Ea=Sb.a.xl(this.Meb+ub.Oco,ub.DPn,l.AFrameworkApplication.Ha.Ib.Dm.toString());this.DJ.ik(Ea,1,"",V,!0,2,this.MAk,this.HZg,null,void 0,void 0,void 0,void 0,"20")}eCn(V){try{const Ea={};Ea.FlightName=V.FlightName;Ea.SessionID=V.SessionID;r.ULS.sendTraceTag(594883776,215,50,Ka.c(Ea))}catch(Ea){r.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}static get instance(){return ub.Qa||
(ub.Qa=ub.vHc())}static vHc(){return new ub(new A.a(()=>l.AFrameworkApplication.$d),l.AFrameworkApplication.ha,l.AFrameworkApplication.Ha.Ib.Dm)}}ub.iqn="X-qs";ub.DPn="at";ub.Oco="O365ShellServiceProxy.ashx";ub.Qa=null;ub.Uoo="ShellWebServiceBase";Object(k.a)(ub,"O365ShellActor",null,[760]);class Aa{constructor(){this.Oa=null;this.uu=()=>{l.AFrameworkApplication.aud&&l.AFrameworkApplication.Ha.Ib.PO&&z.a.instance.resolve("Common.App.O365Shell.O365ShellActor").P7n()}}get name(){return"Common.App.O365Shell"}oc(V){this.Oa=
V;this.Oa.register(ub,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").oa().pa(()=>new ub(new A.a(()=>l.AFrameworkApplication.$d),l.AFrameworkApplication.ha,l.AFrameworkApplication.Ha.Ib.Dm))}init(){l.AFrameworkApplication.ha.Wf(this.uu)}dispose(){}static main(){u.a.instance.Jc(new Aa)}}Object(k.a)(Aa,"PackageManager",null,[4,5]);var tb=a(333),kc=a(799),dc=a(1607);const Db=()=>z.a.instance.resolve("Common.App.SessionExpiration.ISessionLogger"),sb=()=>z.a.instance.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),
Qb=()=>z.a.instance.resolve("Common.ISessionExpirationManagerWithDialog"),$a=()=>z.a.instance.resolve("Common.ISessionExpirationManagerFactory");var X=a(30),Ta=a(319);class ca{constructor(V){this.nb=new X.a;this.ms=V}Ixf(V){this.nb.addHandler(ca.GFb,V)}rYh(V){this.nb.removeHandler(ca.GFb,V)}ynh(){this.nb.raiseEvent(ca.zoc)}xnh(){this.nb.raiseEvent(ca.x5e)}J6e(){throw Error("Method not implemented.");}N6e(){throw Error("Method not implemented.");}PFh(){throw Error("Method not implemented.");}}ca.zoc=
"SE";ca.x5e="SEP";ca.GFb="SER";ca.ntl="TRP";Object(k.a)(ca,"NullSessionExpirationManager",null,[737,739]);var Ma=a(225);class Ba{constructor(){this.Mrf=this.rhd=!1;this.Q1e=()=>{Ta.a.instance.zZk(this.Q1e);r.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.aCj()};this.H0g=()=>{Ta.a.instance.Fum(this.H0g);this.Mrf||this.rhd||(r.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Mrf=!0,this.ikl())};const V=l.AFrameworkApplication.Ao;0>=V||(this.Ao=
V,r.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Ao,["NowGetTime"]:(new Date).getTime(),["BootTime"]:l.AFrameworkApplication.kR}),Ta.a.instance.Txf(this.Q1e),Ta.a.instance.Sxf(this.H0g))}aCj(){this.rhd||(l.AFrameworkApplication.Ds(Ma.a.sessionAccessTokenExpired),this.rhd=!0,this.N_h())}J6e(){throw Error("Method not implemented.");}N6e(){throw Error("Method not implemented.");}PFh(){throw Error("Method not implemented.");}}Object(k.a)(Ba,"ASessionExpirationManager",
null,[]);var wa=a(164),pa=a(325),ta=a(57),Wa=a(59);class Pa{constructor(V,Ea,Za,ia){this.sCm="";this.Mud=V;this.MNl=Za;this.LNl=ia;this.WKl=Ea;V=(new Date(this.Mud)).format(l.AFrameworkApplication.s_h);this.sCm=this.WKl?String.format(Object(Wa.a)("SessionExpiredMessage")):String.format(Object(Wa.a)("SessionExpiringMessage"),V)}F8k(V){1===V?this.MNl&&this.MNl(this.WKl):0===V&&l.AFrameworkApplication.ub.Ra(ta.a.close,2,pa.g)}dispose(){this.LNl&&this.LNl()}}Pa.id="SessionExpirationDialog";Object(k.a)(Pa,
"SessionExpirationDialogSharedProperties",null,[]);class ib extends wa.a{constructor(V,Ea,Za,ia){super(Ea);this.MEh=new Pa(V,Ea,Za,ia);this.rj=Pa.id;l.AFrameworkApplication.BTl?(this.Ue=1,this.vg(0,Object(Wa.a)("DialogClose"))):(this.Ue=0,this.Vw=!1);Ea||1===l.AFrameworkApplication.Ha.mode?this.vg(1,Object(Wa.a)("SessionExpirationRefreshButton")):this.vg(1,Object(Wa.a)("SessionExpiringSaveAndRefreshButton"));this.GC(Object(Wa.a)("DefaultDialogTitle"),this.MEh.sCm,0,Object(B.a)(this,this.F8k,"sessionExpirationDialogHandler"))}F8k(V){this.MEh.F8k(V)}tOh(){return this.sU}$Mh(){this.hide()}dispose(){super.dispose();
this.MEh&&this.MEh.dispose()}}Object(k.a)(ib,"SessionExpirationDialog",wa.a,[835]);var Ib=a(287);class hc extends Ba{constructor(V){super();this.OSe=this.PSe=!0;this.OHa=null;this.nb=new X.a;this.DVe=()=>{this.OHa=null};this.w5e=()=>{this.ms.refreshDocument(null)};this.ms=V}Ixf(V){this.nb.addHandler(hc.GFb,V)}rYh(V){this.nb.removeHandler(hc.GFb,V)}ynh(V){this.PSe=V}xnh(V){this.OSe=V}ikl(){this.OHa||Ib.a.zy||(this.OSe&&(this.OHa=new ib(this.Ao,!1,this.w5e,this.DVe)),this.nb.raiseEvent(hc.x5e))}N_h(){this.OHa&&
(this.OHa.tOh()&&this.OHa.$Mh(),this.OHa=null);this.PSe&&(this.OHa=new ib(this.Ao,!0,this.w5e,this.DVe));this.nb.raiseEvent(hc.zoc)}}hc.zoc="SE";hc.x5e="SEP";hc.GFb="SER";hc.ntl="TRP";Object(k.a)(hc,"SessionExpirationManager",Ba,[737,739]);class yc{}yc.FSm="Aborting";yc.tFh="ActivityDuration";yc.error="Error";yc.errorsCount="Errors";yc.failed="Failed";yc.uKh="FirstActivity";yc.i6a="Initialized";yc.Szn="KickedOut";yc.Xzn="LastActivity";yc.Pvm="RetryOverride";yc.FYh="RequestGroups";yc.requests="Requests";
yc.responses="Responses";yc.mZh="SessionDuration";yc.status="Status";yc.success="Success";yc.Bho="Successful";yc.tokens="Tokens";yc.fGk="PollingDuration";Object(k.a)(yc,"SessionExpirationStrings",null,[]);var ob=a(99);class Bc{constructor(V){this.TY={};this.pjb={};this.hhd={};this.Cbm=15;this.mLl=!1;this.gRm=new Date;this.PDh=new Date;this.zFm=()=>{r.ULS.sendTraceTag(41964821,217,50,r.ULS.GZe({["Aggregate"]:this.pjb,["Current"]:this.TY}))};this.Ce=V;this.Nma=new ob.a(2,2,6E4*this.Cbm,this.zFm,135,
"SL",!1);this.Ce.Rb(this.Nma);this.cvn()}cvn(){this.pjb[yc.FYh]=0;this.pjb[yc.requests]=0;this.pjb[yc.responses]=0;this.pjb[yc.status]=yc.i6a;this.pjb[yc.uKh]=new Date;this.pjb[yc.mZh]=0;this.pjb[yc.tFh]=0;this.pjb[yc.mZh]=0;this.TY[yc.mZh]=0;this.pjb[yc.tFh]=0;this.TY[yc.tFh]=0}get WXn(){this.hhd[yc.fGk]=+new Date-+this.hhd[yc.uKh];return this.hhd}MHj(V,Ea){var Za=V[Ea];Za=Za?Za:0;Za++;V[Ea]=Za;this.pal(V)}pal(V){const Ea=new Date;V[yc.tFh]=+Ea-+this.PDh;this.PDh=Ea;V[yc.mZh]=+this.PDh-+this.gRm;
V[yc.Xzn]=this.PDh}zZa(V,Ea){this.TY[V]=Ea;this.pal(this.TY)}P9k(V,Ea){this.TY[V]=Ea;this.pal(this.TY)}hYe(V){this.MHj(this.TY,V);this.MHj(this.pjb,V);this.MHj(this.hhd,V)}flush(){this.mLl||(this.pjb[yc.status]=this.TY[yc.status],this.zFm(this.Nma),this.Ce.Yla(this.Nma,6E4*this.Cbm))}W7n(){const V=this.TY[yc.status];V&&(this.pjb[yc.status]=V);this.TY={}}$7n(){this.hhd={};this.hhd[yc.fGk]=0;this.hhd[yc.uKh]=new Date}stop(){r.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");
this.flush();this.mLl=!0;this.Ce.Sh(this.Nma)}}Object(k.a)(Bc,"SessionLogger",null,[733]);class rb{constructor(V,Ea){this.eFh=V;this.LNb=Ea}get tokens(){return this.eFh}get errors(){return this.LNb}}Object(k.a)(rb,"TokenRefreshArgs",null,[762]);var Eb=a(118),jc=a(247),ea=a(137);class ua extends Sys.EventArgs{constructor(V,Ea,Za,ia,Va,Ab,gc){super();this.hhd=V;this.FYh=ia;this.failed=Va;this.requests=Ab;this.responses=gc}}Object(k.a)(ua,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Da=
a(1046);class Cb{constructor(V,Ea,Za=null,ia=null){this.Mrf=this.rhd=!1;this.OSe=this.PSe=!0;this.nb=new X.a;this.jHb=this.ulf=this.BEh=!1;this.Hhi=null;this.UMl=10;this.Ezd=this.KDh=!1;this.Ndf=0;this.j4n=()=>{this.k$f(!1);return!Ta.a.instance.Kra(l.AFrameworkApplication.Ao)};this.CSm=(Va,Ab)=>{Ta.a.instance.q2b?this.Q1e(Va,Ab):this.Wdi?(this.ulf=!1,this.k$f(!1)):(this.rhd||r.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.Q1e(Va,Ab))};this.DSm=
(Va,Ab)=>{Ta.a.instance.Wlc?this.H0g(Va,Ab):(r.ULS.sendTraceTag(512247769,217,50,"Refreshing tokens since the user has network and session is expiring."),this.ulf=!1,this.k$f(!0))};this.foi=(Va,Ab)=>{Ta.a.instance.Wlc?this.H0g(Va,Ab):this.k$f(!0)};this.Q1e=()=>{this.Wdi||Ta.a.instance.zZk(this.Q1e);r.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.aCj(Ta.a.instance.q2b)};this.ijo=()=>{const Va=this.zx.WXn;r.ULS.sendTraceTag(555255521,217,50,"{0}",Ka.c(Va));this.nb.raiseEvent(Cb.ntl,
new ua(Va,Va[yc.fGk],Va[yc.uKh],Va[yc.FYh],Va[yc.failed],Va[yc.requests],Va[yc.responses]))};this.Y0n=()=>{3E5<+new Date-+this.yLl?(r.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.k$f(!1)):r.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")};this.qQn=()=>{this.Ezd&&(r.ULS.sendTraceTag(507647818,217,20,"Navigating away with after skipping abort token refresh. VisibilityState: {0}, isBrowserHidden: {1}",
Da.a[this.Ejc.Rma],window.document.hidden),this.Ezd=!1)};this.Atf=V;this.Wdi=l.AFrameworkApplication.Cam;this.Ce=ea.TaskManager.instance;r.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:l.AFrameworkApplication.Ao,["NowGetTime"]:(new Date).getTime(),["BootTime"]:l.AFrameworkApplication.kR});this.zx=Za||new Bc(ea.TaskManager.instance);this.$ya=ia;Ta.a.instance.Txf(this.CSm);Ta.a.instance.Sxf(this.foi);jc.SessionStatusManager.instance.LFh(this.foi);
jc.SessionStatusManager.instance.uQl(this.Y0n);this.yLl=new Date;l.AFrameworkApplication.Bam&&(Ta.a.instance.CUe=this.j4n);V=!1;l.AFrameworkApplication.ha&&(this.UMl=l.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),V=l.AFrameworkApplication.ha.getBooleanAppSetting("WopiTokenRefreshWhenNetworkResumed"));V?jc.SessionStatusManager.instance.LFh(this.DSm):jc.SessionStatusManager.instance.LFh(this.foi);Ea.execute(Va=>{this.Ejc=Va});this.Dfl&&l.AFrameworkApplication.I1&&
l.AFrameworkApplication.I1(this.qQn)}Ixf(V){this.nb.addHandler(Cb.GFb,V)}rYh(V){this.nb.removeHandler(Cb.GFb,V)}k$f(V){if(!this.BEh&&!this.ulf)if(this.$ya&&this.$ya.ygb)this.jHb=!0,this.zx.zZa(yc.status,yc.Szn),this.zx.flush(),this.zx.stop();else if(r.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",V,this.jHb),this.jHb)this.N_h();else{this.zx.flush();this.zx.W7n();this.zx.hYe(yc.FYh);this.BEh=!0;this.KDh||(this.zx.$7n(),this.KDh=!0,this.u3m());const Ea=this.Atf.z4n(V);
Ea.continueWith(()=>{if(this.Atf.U1n(Ea))this.zx.hYe(yc.Bho),this.zx.zZa(yc.status,yc.success),this.OSe=!1,this.Wdi&&(this.PSe=!1),this.ulf=!1,this.yLl=new Date,this.Ygo(),this.Dfl&&(this.Ezd&&r.ULS.sendTraceTag(507647820,217,20,"Successfully refresh token after permanent errors. VisibilityState: {0}, isBrowserHidden: {1}",Da.a[this.Ejc.Rma],window.document.hidden),this.Ezd=!1),this.SIe&&(this.Ndf=0),this.nb.raiseEvent(Cb.GFb,new rb(Ea.result.tokens,null));else{const Za=Ea.result.errors;this.zx.hYe(yc.failed);
this.zx.zZa(yc.status,yc.failed);if(this.Dfl){if(!V){const ia=this.Atf.Xmd(Za);this.Ejc.isActive?(!this.SIe||2!==this.$ya.networkState&&0!==this.$ya.networkState||(this.Ndf++,this.Ndf>=this.ojm&&(this.jHb=!0,jc.SessionStatusManager.instance.hEj=!0)),this.SIe?this.jHb||(this.jHb=ia):this.jHb=ia,ia&&(this.Ezd&&r.ULS.sendTraceTag(507647819,217,20,"Abort token refresh after skipping abort because of visibility state. VisibilityState: {0}, isBrowserHidden: {1}",Da.a[this.Ejc.Rma],window.document.hidden),
this.Ezd=!1)):(r.ULS.sendTraceTag(507654146,217,15,"Visibility is not active, not aborting token refresh. VisibilityState: {0}, IsPermanentErrors: {1}, isBrowserHidden: {2}",Da.a[this.Ejc.Rma],ia,window.document.hidden),ia&&(this.Ezd=!0))}}else V||(!this.SIe||2!==this.$ya.networkState&&0!==this.$ya.networkState||(this.Ndf++,this.Ndf>=this.ojm&&(this.jHb=!0,jc.SessionStatusManager.instance.hEj=!0)),this.SIe?this.jHb||(this.jHb=this.Atf.Xmd(Za)):this.jHb=this.Atf.Xmd(Za));this.jHb&&(this.zx.zZa(yc.FSm,
JSON.stringify(Za)),r.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.ulf=!0;this.nb.raiseEvent(Cb.GFb,new rb(null,Za))}this.zx.flush();this.BEh=!1})}}H0g(){this.Mrf||this.rhd||(r.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Mrf=!0,this.ikl(Ta.a.instance.Wlc))}aCj(V){if(!this.rhd){var Ea=V?Ma.a.Exm:Ma.a.sessionAccessTokenExpired;const Za={extendedProperties:new Map};Za.extendedProperties.set("ErrorCode",String.format("{0}",Ea));l.AFrameworkApplication.Ds(Ea,
void 0,["SessionExpired"],Za);V||(V=new Date,Ea=new Date(l.AFrameworkApplication.kR),r.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",Ea,V,+V-+Ea),864E5>+V-+Ea&&Eb.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,Za),2592E5>+V-+Ea&&Eb.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,Za));this.rhd=!0;this.N_h()}}Ygo(){this.KDh&&(this.Ce.Sh(this.Hhi),
this.KDh=!1)}u3m(){this.Hhi=new ob.a(2,2,1E3*this.UMl,this.ijo,135);this.Ce.Rb(this.Hhi)}J6e(){throw Error("Method not implemented.");}N6e(){throw Error("Method not implemented.");}PFh(){throw Error("Method not implemented.");}get Dfl(){return null!=this.kIl?this.kIl:this.kIl=l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.AbortOnlyWhenActiveVisibility",!1):!1}get SIe(){return null!=this.mIl?this.mIl:this.mIl=l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldKickoutWhenMaxRetries",
!1):!1}get ojm(){return null!=this.jIl?this.jIl:this.jIl=l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.WordOnline.MaxConsecutiveTokenRefreshFailures",3):3}}Cb.zoc="SE";Cb.x5e="SEP";Cb.GFb="SER";Cb.ntl="TRP";Object(k.a)(Cb,"ASessionExpirationManagerWithRefresh",null,[]);class Nb extends Cb{constructor(V,Ea,Za,ia=null,Va=null){super(Ea,Za,ia,Va);this.OHa=null;this.DVe=()=>{this.OHa=null};this.w5e=()=>{this.ms.refreshDocument(null)};this.ms=V}ynh(V){this.PSe=
V}xnh(V){this.OSe=V}ikl(V){if(!this.OHa&&!Ib.a.zy){if(V)this.OHa=new ib(l.AFrameworkApplication.pxa,!1,this.w5e,this.DVe);else if(this.OSe){if(this.BEh)return;this.OHa=new ib(l.AFrameworkApplication.Ao,!1,this.w5e,this.DVe)}r.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",Cb.x5e,V);this.nb.raiseEvent(Cb.x5e)}}N_h(){this.OHa&&(this.OHa.tOh()&&this.OHa.$Mh(),this.OHa=null);if(this.PSe){this.zx.stop();if(this.$ya&&this.$ya.ygb)return;this.OHa=new ib(l.AFrameworkApplication.Ao,
!0,this.w5e,this.DVe)}r.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",Cb.zoc);this.nb.raiseEvent(Cb.zoc)}}Object(k.a)(Nb,"SessionExpirationManagerWithRefresh",Cb,[737,739]);class fc{constructor(V,Ea){this.ICm=V;this.qn=Ea}J6e(){this.ICm.J6e()}N6e(){this.ICm.N6e()}PFh(V){this.qn.addHandler(fc.GFb,V)}ynh(){throw Error("Method not implemented.");}xnh(){throw Error("Method not implemented.");}Ixf(){throw Error("Method not implemented.");}rYh(){throw Error("Method not implemented.");}}fc.GFb="TR";
fc.zoc="SE";Object(k.a)(fc,"SessionExpirationManagerWithRefreshV2",null,[737]);class fb{constructor(V,Ea,Za,ia){this.refreshPolicy=Ea;this.gma=Za;this.hjo=ia;this.zmm=()=>{this.ZYh()};this.fom=()=>{this.ZYh()};V.execute(Va=>{this.TLb=Va})}J6e(){r.ULS.sendTraceTag(507803545,217,50,"TokenRefreshScheduler.startScheduler: Starting token refresh scheduler.");this.ZYh();this.TLb&&this.TLb.eid(this.fom);this.gma.vTe(this.zmm)}N6e(){r.ULS.sendTraceTag(507803544,217,50,"TokenRefreshScheduler.stopScheduler: Stopping token refresh scheduler.");
this.taskId||(window.clearTimeout(this.taskId),this.taskId=void 0);this.TLb&&this.TLb.sYh(this.fom);this.gma.Xtm(this.zmm)}ZYh(){if(this.gma.HOc||this.gma.ygb||l.AFrameworkApplication.Ch)this.N6e();else{var V=this.kVl();this.taskId&&window.clearTimeout(this.taskId);r.ULS.sendTraceTag(507803543,217,50,"TokenRefreshScheduler.scheduleNextRefresh: Scheduling next refresh with timeout: {0}.",V);this.taskId=window.setTimeout(()=>{0<this.kVl()||(this.Pam=(new Date).getTime(),this.hjo.refreshToken());this.ZYh()},
V)}}kVl(){const V=(new Date).getTime(),Ea=l.AFrameworkApplication.Ao-V-1E3*l.AFrameworkApplication.iZ;return 0>Ea?this.Pam?Math.max(this.Pam+this.refreshPolicy.esd-V,0):0:Ea}}Object(k.a)(fb,"TokenRefreshScheduler",null,[]);var Ub=a(224),Ec=a(150),Lc=a(132);class vb{}Object(k.a)(vb,"NamedResult",null,[]);class ec extends vb{}Object(k.a)(ec,"ErrorInfo",vb,[]);class lb{}Object(k.a)(lb,"Error",null,[]);var Zb=a(21),qc=a(429);let pc=0,ac=0;var gb=a(1502);class Jb{constructor(V,Ea,Za){this.n7i=V;this.gma=
Za;this.mw="TokenRefresh";Ea.execute(ia=>{this.TLb=ia})}OCn(){this.n7i.Bja({mw:this.mw,uQc:gb.b.SuccessBased})}NCn(){const V=new Map;V.set("IsExpiring",this.gma.dtb.toString());V.set("IsOnline",window.navigator.onLine.toString());V.set("IsHidden",window.document.hidden.toString());V.set("VisibilityState",this.TLb?Da.a[this.TLb.Rma]:"undefined");this.n7i.FYa({mw:this.mw,gt:{pS:{extendedProperties:V}}})}YZe(V,Ea){const Za=new Map;Za.set("IsExpiring",this.gma.dtb.toString());Za.set("IsOnline",window.navigator.onLine.toString());
Za.set("IsHidden",window.document.hidden.toString());Za.set("VisibilityState",this.TLb?Da.a[this.TLb.Rma]:"undefined");Ea&&Za.set("ErrorMessage",Ea);this.n7i.Hwa({mw:this.mw,errorName:V,gt:{pS:{extendedProperties:Za}}})}}Object(k.a)(Jb,"TokenRefreshKPILogger",null,[]);var uc=a(512);class Cc{constructor(V,Ea,Za,ia,Va){this.gma=Ea;this.refreshPolicy=Za;this.qn=ia;this.BM=()=>{var Ab=this.gma,gc=this.refreshPolicy,Hc=this.qn,fd=this.Pbe,hd=this.TLb;Ab.dtb&&hd&&hd.isActive?(r.ULS.sendTraceTag(507593738,
217,15,"TokenRefresh time out."),ac++,fd.YZe("TokenRefreshFailed_Timeout"),(2===Ab.networkState||0===Ab.networkState)&&d&&ac==e()*gc.yUh&&Hc.raiseEvent(fc.zoc,Ma.a.XEl)):(ac=0,fd.YZe("TokenRefreshFailed_Timeout_SkipProcessingError"))};V.execute(Ab=>{this.y7l=Ab;Ab.hD(Ec.a.U3d,this.uyk.bind(this))});Va.execute(Ab=>{this.TLb=Ab});this.Pbe=new Jb(uc.a.getInstance({cNa:"wwrelfc",featureName:"TokenRefreshManagerV2",dkc:"Infrastructure"}),Va,this.gma)}refreshToken(){if(this.y7l){var V={};V[Ub.a.uih]=this.refreshPolicy.tokens;
var Ea=Lc.a.create().toString();r.ULS.sendTraceTag(507803554,217,50,"TokenRefreshManagerV2.refreshToken: Refreshing token.");this.SIe&&(this.Gsl=window.setTimeout(this.BM,this.refreshPolicy.esd));this.y7l.sendMessage(Ec.a.QTe,V,Ea);this.Pbe.OCn()}else r.ULS.sendTraceTag(507803555,217,10,"TokenRefreshManagerV2.refreshToken: HostPostMessenger is not initialized.")}uyk(V){if(V.MessageId===Ec.a.U3d)if(this.Gsl&&(window.clearTimeout(this.Gsl),this.Gsl=void 0),this.gma.HOc||this.gma.ygb||l.AFrameworkApplication.Ch)r.ULS.sendTraceTag(507794142,
217,50,"TokenRefreshManagerV2.onHostResponseReceived: Skipping host response processing because session has ended.");else{r.ULS.sendTraceTag(507803553,217,50,"TokenRefreshManagerV2.onHostResponseReceived: Received response.");var Ea=this.TLb,Za=this.refreshPolicy,ia=this.qn,Va=this.gma,Ab=this.Pbe,gc=V.Values[Ub.a.uih];if(!gc||0>=gc.length)r.ULS.sendTraceTag(507778646,217,15,"Found no entries in the dictionary"),gc=V.Values;if(0==gc.length)r.ULS.sendTraceTag(507778645,217,15,"No tokens/errors in TokenRefresh response."),
Ab.YZe("TokenRefreshFailed_NoTokens");else{V=[];var Hc=[];for(const t of gc)if((gc=t)&&gc.Value?V.push(gc):(gc=t)?Hc.push(gc):r.ULS.sendTraceTag(507778644,217,15,"Unexpected Token/ErrorInfo in TokenRefresh response."),0<V.length){gc=ia;var fd=V,hd=Ab;pc=0;d()&&(ac=0);for(const L of fd)L.Name===Ub.a.accessToken&&(fd=(new Date).getTime(),L.Expiry>l.AFrameworkApplication.Ao?(r.ULS.sendTraceTag(507778643,217,20,"Updating AccessToken: {0}",{["AccessTokenTtl"]:L.Expiry,["NowGetTime"]:fd,["BootTime"]:l.AFrameworkApplication.kR},
"PreviousAccessTokenTtl",l.AFrameworkApplication.Ao),hd.NCn(),l.AFrameworkApplication.accessToken=L.Value,l.AFrameworkApplication.Ao=Math.floor(L.Expiry),l.AFrameworkApplication.neb=fd,l.AFrameworkApplication.aU=Math.floor(L.Expiry),gc.raiseEvent(fc.GFb)):(r.ULS.sendTraceTag(507778642,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:L.Expiry,["NowGetTime"]:fd,["BootTime"]:l.AFrameworkApplication.kR},"PreviousAccessTokenTtl",l.AFrameworkApplication.Ao),
hd.YZe("TokenRefreshFailed_AccessTokenExpiresTooSoon")))}else if(0<Hc.length){gc=Za;hd=ia;fd=Hc;var yd=Ab;if(Va.dtb&&Ea&&Ea.isActive){d()&&ac++;gc.Xmd(new Zb.a(fd))&&pc++;var Md=[];for(const L of fd){var te=L,Pe=Object.assign(new ec,{Name:te.Name,Errors:[],SPCorrelationId:te.SPCorrelationId});for(const S of te.Errors)te=new lb,te.Id=S.Id,te.Details=qc.a.q5a(S.Details,500),Pe.Errors.push(te);r.ULS.sendTraceTag(507778641,217,15,"Received error for token {0}. Errors: {1}. SPCorrelationId: {2}",Pe.Name,
JSON.stringify(Pe.Errors),Pe.SPCorrelationId);Md.push(Pe)}yd.YZe("TokenRefreshFailed_ErrorReceived",JSON.stringify(Md));if(pc==(l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.WordOnline.MaxConsecutivePermanentErrors",3):3)){yd=hd.raiseEvent;Md=fc.zoc;Pe=Ma.a.sessionAccessTokenExpired;for(const L of fd)for(const S of L.Errors)if(fd=parseInt(S.Id),te=S.Details.toString(),isNaN(fd))Pe=Ma.a.$El;else{switch(fd){case 401:Pe=Ma.a.cFl;b&&c(te)&&(Pe=Ma.a.eBh);break;
case 403:Pe=Ma.a.YEl;b&&c(te)&&(Pe=Ma.a.eBh);break;case 500:Pe=Ma.a.ZEl;break;case 503:Pe=Ma.a.bFl}Pe===Ma.a.sessionAccessTokenExpired&&(Pe=500<fd?Ma.a.aFl:Ma.a.WEl)}fd=Pe;yd.call(hd,Md,fd)}d&&ac==e()*gc.yUh&&hd.raiseEvent(fc.zoc,Ma.a.XEl)}else pc=0,d()&&(ac=0),yd.YZe("TokenRefreshFailed_SkipProcessingError")}}}}get SIe(){return null!=this.lIl?this.lIl:this.lIl=l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldKickoutWhenMaxRetries",!1):
!1}}Object(k.a)(Cc,"TokenRefreshManagerV2",null,[]);var Gc=a(1136);class dd{constructor(V,Ea,Za,ia=null,Va=null,Ab,gc){this.zOl=!1;this.Qa=null;this.Ggd=V;this.J0a=Ea;this.Nni=Za;this.zx=ia||new Bc(ea.TaskManager.instance);this.$ya=Va;this.qOl=Ab;this.Uzd=gc}create(){this.zOl=l.AFrameworkApplication.Iz;if(!this.zOl)return new hc(this.Ggd);r.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this.Qa)switch(l.AFrameworkApplication.F2h){case 1:r.ULS.sendTraceTag(39408090,
217,50,"Creating new NullSessionExpirationManager");this.Qa=new ca(this.Ggd);break;case 2:if(Object(Gc.a)()){r.ULS.sendTraceTag(507803552,217,50,"Creating new SessionExpirationManagerWithRefreshV2");const V=new X.a;this.Qa=new fc(new fb(this.Nni,this.qOl,this.$ya,new Cc(this.Uzd,this.$ya,this.qOl,V,this.Nni)),V)}else r.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh"),this.Qa=new Nb(this.Ggd,this.J0a,this.Nni,this.zx,this.$ya);break;default:r.ULS.sendTraceTag(39408092,
217,50,"Creating new legacy SessionExpirationManager"),this.Qa=new hc(this.Ggd)}r.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this.Qa).getName());return this.Qa}}Object(k.a)(dd,"SessionExpirationManagerFactory",null,[736]);var ld=a(1703),bc=a(28),cc=a(1153),Vc=a(204);class td{constructor(V,Ea,Za,ia=null,Va=!1,Ab=null,gc=!1,Hc=!1,fd=!1,hd=!1,yd=!1){this.Heb=0;this.oHb=this.Qs=null;this.eFh=new Zb.a;this.LNb=new Zb.a;this.qH=null;this.TBd=
!1;this.Btf=this.Ctf=null;this.Q7n=()=>{this.ovm()};Object(Gc.a)()||(this.Ce=V,this.VMl=Ea,this.VMl.execute(Md=>{Md.hD(Ec.a.U3d,Object(B.a)(this,this.uyk,"onHostResponseReceived"))}),this.tLa=Za,this.rOl=new cc.a("WebServiceCall","TokenRefresh"),this.zx=ia||new Bc(V),this.fRm=Va,this.PHa=Ab?Ab:jc.SessionStatusManager.instance,this.$Jl=gc,this.dDh=Hc,this.pRm=fd,this.qRm=hd,this.QNl=yd,this.WRe=uc.a.getInstance({cNa:"wwrelfc",featureName:"TokenRefreshManager",dkc:"Infrastructure"}))}uyk(V){if(V.MessageId!==
Ec.a.U3d)r.ULS.sendTraceTag(39408099,217,15,"Unexpected message.");else{var Ea=new Zb.a,Za=new Zb.a;this.zx.hYe(yc.responses);var ia=V.Values[Ub.a.uih];if(!ia||0>=ia.length)r.ULS.sendTraceTag(40122317,217,15,"Found no tokens in the dictionary"),ia=V.Values;this.zx.zZa("Correlation",V.CorrelationId);var Va="";for(let Hc=0;Hc<ia.length;Hc++){this.zx.P9k(yc.tokens,ia.length);var Ab=ia[Hc],gc=Ab;if(!gc||!gc.Name)continue;this.zx.hYe(gc.Name);const fd=Ab;if(fd&&fd.Value)Ea.add(fd),this.eFh.add(fd),this.dDh||
this.zx.zZa(yc.status,yc.success),this.$Jl&&this.PHa&&this.PHa.zvm();else if(Ab=this.Skn(Ab),r.ULS.sendTraceTag(39408129,217,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",gc.Name,JSON.stringify(Ab),this.oHb),Za.add(Ab),this.dDh||(this.LNb.add(Ab),Va=JSON.stringify(Ab),this.zx.zZa(yc.error,JSON.stringify(Ab)),this.zx.zZa(yc.status,yc.failed)),this.$Jl)for(const hd of Ab.Errors)gc=this.Vgn(hd),this.PHa&&this.PHa.vPl(gc)}this.dDh?(0<Za.count?this.Btf?this.Btf(new rb(Ea,
Za)):r.ULS.sendTraceTag(512267295,217,15,"Received errors but the promise has completed.TaskId {0}, IsSessionExpired: {1}, IsTokenExpiring: {2}, Error: {3}",this.oHb,this.PHa.dtb,this.TBd.toString(),Va):this.Ctf?this.Ctf(new rb(Ea,Za)):r.ULS.sendTraceTag(512267294,217,15,"Received valid tokens but the promise has completed. TaskId {0}, IsSessionExpired: {1}, IsTokenExpiring: {2}",this.oHb,this.PHa.dtb,this.TBd.toString()),r.ULS.sendTraceTag(512344162,217,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
Ea.count,Za.count,V.CorrelationId,this.oHb)):(0<Za.count&&""!==Va?(ia=Object.assign({},{extendedProperties:new Map}),ia.extendedProperties.set("Errors",Va),ia.extendedProperties.set("RetryCount",this.Heb.toString()),ia.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),ia.extendedProperties.set("IsTokenExpiring",this.TBd.toString()),this.iXj()&&ia.extendedProperties.set("IsAppShuttingDown",l.AFrameworkApplication.Ch.toString()),this.i6e?(ia.extendedProperties.set("SkipAria",
"false"),this.WRe.Hwa({mw:"WACTokenRefresh",errorName:"TokenRefreshFailed",gt:{Qmd:!1,Rmd:!1,pS:ia}})):Eb.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,ia)):this.i6e?(Va=Object.assign({},{extendedProperties:new Map}),Va.extendedProperties.set("SkipAria","false"),this.WRe.FYa({mw:"WACTokenRefresh",gt:{pS:Va}})):Eb.Health.instance.recordKpiSuccess("WACTokenRefresh",null),r.ULS.sendTraceTag(39408130,217,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
Ea.count,Za.count,V.CorrelationId,this.oHb),0<Za.count&&!this.Xmd(Za)?(V=this.tLa.j4l(Za),V!==this.tLa.esd&&(this.zx.P9k(yc.Pvm,V),this.Ce.Yla(this.Qs,V))):(this.zx.flush(),this.Qs&&this.Ce.Sh(this.Qs),this.qH&&!this.qH.task.isCompleted?this.qH.lj(new rb(Ea,Za)):r.ULS.sendTraceTag(512267293,217,15,"Received results but the task has completed")))}}Skn(V){if(!V)return null;const Ea=Object.assign(new ec,{Name:V.Name,Errors:[],SPCorrelationId:V.SPCorrelationId});for(const Za of V.Errors)V=new lb,V.Id=
Za.Id,V.Details=qc.a.q5a(Za.Details,500),Ea.Errors.push(V);return Ea}ovm(){Vc.a.DH("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");if(this.Heb>=this.tLa.yUh)r.ULS.sendTraceTag(39408132,217,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.oHb),this.h4m(this.qH);else{if(this.i6e){const V=Object.assign({},{extendedProperties:new Map});V.extendedProperties.set("SkipAria","false");this.WRe.Bja({mw:"WACTokenRefresh",uQc:gb.b.SuccessBased,gt:{pS:V}})}else Eb.Health.instance.recordKpiUsage("WACTokenRefresh",
gb.b.SuccessBased,"wwrelfc",null);this.nxm()}}nxm(){const V={};V[Ub.a.uih]=this.tLa.tokens;this.pRm&&(V[Ub.a.Fxm]=this.qRm);const Ea=Lc.a.create().toString();r.ULS.sendTraceTag(39408133,217,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.tLa.tokens),this.Heb+1,Ea,this.oHb);this.VMl.execute(Za=>{Za.sendMessage(Ec.a.QTe,V,Ea)});this.Heb++;this.zx.hYe(yc.requests)}h4m(V){const Ea=new Zb.a;for(let Za=0;Za<this.tLa.tokens.length;Za++){const ia=Object.assign(new ec,
{Name:this.tLa.tokens[Za],Errors:[Object.assign(new lb,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});Ea.add(ia);this.LNb.add(ia)}this.Ce.Sh(this.Qs);this.zx.zZa(yc.errorsCount,JSON.stringify(this.LNb));this.zx.zZa(yc.status,yc.failed);V&&!V.task.isCompleted&&V.lj(new rb(new Zb.a,this.LNb))}iXj(){return l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.isChangeGateEnabled("SkipSessionExpiredVetoForShutdown")}z4n(V){Vc.a.DH("ej4if276;fheca743");
Vc.a.DH("5d4fi128;abe10395");Vc.a.DH("7db39907;cegi0367;ijicc640");this.rOl.start();this.iXj()&&this.Ce.xwa&&(r.ULS.sendTraceTag(508351137,217,15,"Restarting taskmanager, is shutting down {0}",l.AFrameworkApplication.Ch),this.Ce.wZa());this.TBd=V;this.oHb=Lc.a.create().toString();r.ULS.sendTraceTag(41755338,217,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.oHb,this.TBd);this.Heb=0;this.LNb.clear();this.eFh.clear();this.qH=new nb.a;this.dDh?this.pvm(this.tLa.yUh).then(Ea=>{this.qH&&
!this.qH.task.isCompleted&&this.qH.lj(Ea);this.Btf=this.Ctf=null;this.zx.zZa(yc.errorsCount,JSON.stringify(this.LNb));this.zx.zZa(yc.status,yc.success);this.zx.flush()}).catch(Ea=>{this.qH&&!this.qH.task.isCompleted&&this.qH.lj(Object(ld.a)(762,Ea));this.Btf=this.Ctf=null;this.zx.zZa(yc.errorsCount,JSON.stringify(this.LNb));this.zx.zZa(yc.status,yc.failed);this.zx.flush()}):(this.Qs=new ob.a(this.tLa.priority,2,this.tLa.esd,this.Q7n,98,Ec.a.QTe,!0),this.fRm&&this.ovm(),this.Ce.Rb(this.Qs));return this.qH.task}pvm(V){const Ea=
this,Za=new Promise((Hc,fd)=>{Ea.Ctf=Hc;Ea.Btf=fd;this.i6e?(Hc=Object.assign({},{extendedProperties:new Map}),Hc.extendedProperties.set("SkipAria","false"),this.WRe.Bja({mw:"WACTokenRefresh",uQc:gb.b.SuccessBased,gt:{pS:Hc}})):Eb.Health.instance.recordKpiUsage("WACTokenRefresh",gb.b.SuccessBased,"wwrelfc",null);Ea.nxm()}),ia=this,Va=new Promise((Hc,fd)=>{window.setTimeout(()=>{fd(ia.yWl("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},ia.tLa.esd)});let Ab=
V;const gc=this;return new Promise((Hc,fd)=>{Ab--;Promise.race([Za,Va]).then(hd=>{if(this.i6e){const yd=Object.assign({},{extendedProperties:new Map});yd.extendedProperties.set("SkipAria","false");this.WRe.FYa({mw:"WACTokenRefresh",gt:{pS:yd}})}else Eb.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Hc(hd)}).catch(hd=>{var yd=gc.tLa.esd;if(Object(bc.a)(762,hd)&&(hd=Object(ld.a)(762,hd),0<hd.errors.count)){gc.OBn(hd.errors);gc.ePl(hd.errors);if(gc.Xmd(hd.errors)){fd(hd);return}const Md=gc.tLa.j4l(hd.errors);
Md!==gc.tLa.esd?(gc.zx.P9k(yc.Pvm,Md),yd=Md):gc.mzn(hd.errors)&&(yd=0)}Ab?window.setTimeout(()=>{gc.pvm(Ab).then(Hc).catch(fd)},yd):(yd=gc.yWl("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),gc.ePl(yd.errors),fd(yd),r.ULS.sendTraceTag(512267292,217,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",gc.oHb))})})}ePl(V){for(const Ea of V)this.LNb.add(Ea)}mzn(V){if(!V.count)return!1;V=V.ka(V.count-1);return V.Errors.length?
"TIMEOUT"==V.Errors[0].Id:!1}yWl(V,Ea){const Za=new Zb.a;for(let ia=0;ia<this.tLa.tokens.length;ia++){const Va=this.i4m(this.tLa.tokens[ia],V,Ea);Za.add(Va)}return new rb(new Zb.a,Za)}i4m(V,Ea,Za){return Object.assign(new ec,{Name:V,Errors:[Object.assign(new lb,{Id:Ea,Details:Za})]})}OBn(V){if(V.count){V=V.ka(V.count-1);V=JSON.stringify(V);var Ea=Object.assign({},{extendedProperties:new Map});Ea.extendedProperties.set("Errors",V);Ea.extendedProperties.set("RetryCount",this.Heb.toString());Ea.extendedProperties.set("NavigatorOnline",
window.navigator.onLine.toString());Ea.extendedProperties.set("IsTokenExpiring",this.TBd.toString());this.iXj()&&Ea.extendedProperties.set("IsAppShuttingDown",l.AFrameworkApplication.Ch.toString());this.i6e?(Ea.extendedProperties.set("SkipAria","false"),this.WRe.Hwa({mw:"WACTokenRefresh",errorName:"TokenRefreshFailed",gt:{pS:Ea}})):Eb.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Ea);this.zx.zZa(yc.error,V);this.zx.zZa(yc.status,yc.failed)}}U1n(V){this.rOl.stop();const Ea=
this.pqn(V.result.errors);r.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!Ea,this.oHb,this.TBd,this.Heb,this.LNb.count,0<V.result.errors.count?V.result.errors.ka(0).Name:"",0<V.result.errors.count&&0<V.result.errors.ka(0).Errors.length?V.result.errors.ka(0).Errors[0].Id:"",0<V.result.errors.count&&0<V.result.errors.ka(0).Errors.length?
V.result.errors.ka(0).Errors[0].Details:"");return Ea?!1:this.T1n(V.result.tokens)}Xmd(V){return this.tLa.Xmd(V)}T1n(V){for(let Ea=0;Ea<V.count;Ea++){const Za=V.ka(Ea);if(Za.Name===Ub.a.accessToken){const ia=(new Date).getTime();Za.Expiry>l.AFrameworkApplication.Ao?(r.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Za.Expiry,["NowGetTime"]:ia,["BootTime"]:l.AFrameworkApplication.kR},"PreviousAccessTokenTtl",l.AFrameworkApplication.Ao),l.AFrameworkApplication.accessToken=
Za.Value,l.AFrameworkApplication.Ao=Math.floor(Za.Expiry),l.AFrameworkApplication.neb=ia,l.AFrameworkApplication.aU=Math.floor(Za.Expiry)):r.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:Za.Expiry,["NowGetTime"]:ia,["BootTime"]:l.AFrameworkApplication.kR},"PreviousAccessTokenTtl",l.AFrameworkApplication.Ao)}}return!0}pqn(V){let Ea=!1;for(let Za=0;Za<V.count;Za++){Ea=!0;const ia=V.ka(Za);r.ULS.sendTraceTag(39706829,217,
15,"Received error for token {0}. Errors: {1}. TaskId: {2}, SPCorrelationId: {3}",ia.Name,JSON.stringify(ia.Errors),this.oHb,ia.SPCorrelationId)}return Ea}pam(V){return V.includes("aadInteractionRequired")||V.includes("sessionRevocation")||V.includes("blockAccessForTenantRestrictions")||V.includes("revoked")||V.includes("Due to organizational policies, you can't access these resources from this network location")?!0:!1}Vgn(V){let Ea=Ma.a.sessionAccessTokenExpired;const Za=parseInt(V.Id);V=V.Details.toString();
if(isNaN(Za))Ea=Ma.a.$El;else{switch(Za){case 401:Ea=Ma.a.cFl;this.QNl&&this.pam(V)&&(Ea=Ma.a.eBh);break;case 403:Ea=Ma.a.YEl;this.QNl&&this.pam(V)&&(Ea=Ma.a.eBh);break;case 500:Ea=Ma.a.ZEl;break;case 503:Ea=Ma.a.bFl}Ea===Ma.a.sessionAccessTokenExpired&&(Ea=500<Za?Ma.a.aFl:Ma.a.WEl)}return Ea}get i6e(){return null!=this.oIl?this.oIl:this.oIl=l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldUseNewKPIApiForTokenRefresh",!1):!1}}Object(k.a)(td,
"TokenRefreshManager",null,[735]);class Xc{constructor(){this.esd=l.AFrameworkApplication.tFm;this.yUh=l.AFrameworkApplication.rFm;this.tokens=l.AFrameworkApplication.v5l();this.priority=l.AFrameworkApplication.uFm;this.uNl=this.ubo();this.eTe=l.AFrameworkApplication.u5l()}Xmd(V){if(this.Mdo){var Ea=[];for(const ia of V)if(ia.Errors)for(const Va of ia.Errors)Ea.push(Va.Id);V=JSON.stringify(Ea);if(this.eTe&&0<this.eTe.length)for(var Za of this.eTe)if(0<Za.length&&0<=V.indexOf(Za))return!0}else if(Za=
JSON.stringify(V),this.eTe&&0<this.eTe.length)for(Ea of this.eTe)if(0<Ea.length&&0<=Za.indexOf(Ea))return!0;return!1}j4l(V){try{if(V)for(const Ea of V)if(Ea.Errors)for(const Za of Ea.Errors)if(Za.Id in this.uNl)return Number.parseInvariant(this.uNl[Za.Id].toString())}catch(Ea){r.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",Ea.toString())}return this.esd}ubo(){const V={};try{if(!l.AFrameworkApplication.X7f()||0>=l.AFrameworkApplication.X7f().length||
""===l.AFrameworkApplication.X7f()[0])return V;for(const Ea of l.AFrameworkApplication.X7f())0<Ea.length&&(V[Ea]=l.AFrameworkApplication.sFm)}catch(Ea){r.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",Ea.toString())}return V}get Mdo(){return null!=this.nIl?this.nIl:this.nIl=l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldUseErrorsForParsingPermanentErrors",!1):!1}}Object(k.a)(Xc,"TokenRefreshPolicy",
null,[734]);class ne{constructor(){this.Oa=null}get name(){return"Common.App.SessionExpiration"}init(){l.AFrameworkApplication.ha.Wf(()=>{this.A0b()})}A0b(){$a();z.a.instance.resolve("Common.ISessionExpirationManager");Qb();Object(Gc.a)()&&z.a.instance.resolve("Common.ISessionExpirationManagerV2").J6e()}dispose(){}oc(V){this.Oa=V;V.register(733,"Common.App.SessionExpiration.ISessionLogger").oa().pa(()=>new Bc(ea.TaskManager.instance));V.register(734,"Common.App.SessionExpiration.ITokenRefreshPolicy").oa().pa(()=>
new Xc);V.register(735,"Common.App.SessionExpiration.ITokenRefreshManager").oa().pa(()=>new td(ea.TaskManager.instance,l.AFrameworkApplication.ZP(),sb(),Db(),l.AFrameworkApplication.ha.getBooleanAppSetting("WopiTokenRefreshSendTokenRequestWithoutTasks"),Object(dc.a)(),l.AFrameworkApplication.ha.getBooleanAppSetting("WopiAllowTokenRefreshErrorTracking"),l.AFrameworkApplication.ha.getBooleanAppSetting("WopiTokenRefreshSyncMessageWithTimeout"),l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAddAllowAADPopupInPostMessage",
!1),l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAllowAADPopupForTokenRefresh",!1),l.AFrameworkApplication.ha.getBooleanAppSetting("WopiTokenRevokedTokenExperiment")&&l.AFrameworkApplication.ha.getBooleanAppSetting("ShowTokenRevocationErrorMessage")));V.register(736,"Common.ISessionExpirationManagerFactory").oa().pa(()=>new dd(l.AFrameworkApplication.Ha,z.a.instance.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),Object(kc.a)(),Db(),Object(dc.a)(),
sb(),Object(tb.a)()));V.register(737,"Common.ISessionExpirationManagerWithDialog").oa().pa(()=>$a().create());V.register(738,"Common.ISessionExpirationManagerV2").oa().pa(()=>Qb());V.register(739,"Common.ISessionExpirationManager").oa().pa(()=>Qb())}static main(){u.a.instance.Jc(new ne)}}Object(k.a)(ne,"SessionExpirationPackage",null,[4,5]);var Vd=a(69),Ja=a(563),Lb=a(51),fa=a(175),Na=a(187),ha=a(221),sa=a(83),xa=a(40),pb=a(42),Rb=a(44);class Fc extends Ib.a{constructor(V,Ea){super();this.YIa=null;
this.zDn=!1;this.SDn="";this.xgm=this.ygm=this.Lcm=this.Mcm=null;this.Ue=3;this.vg(1,ResourceStrings.L_SetSlideOrientationMaximize);this.vg(2,ResourceStrings.L_SetSlideOrientationEnsure);this.la=V;this.Kgm=Ea.Eq(sa.a.wpm)}dispose(){this.YIa=null;super.dispose()}showDialog(V){this.qp(V);this.Mcm=document.getElementById("btnMaximize");this.ygm=Object(B.a)(this,this.UTn,"onScaleUpButton");H.a.addHandler(this.Mcm,"click",this.ygm);this.Lcm=document.getElementById("btnEnsure");this.xgm=Object(B.a)(this,
this.TTn,"onScaleDownButton");H.a.addHandler(this.Lcm,"click",this.xgm)}qp(V){this.Dya=Object(B.a)(this,this.Ebo,"setSlideOrientationRatio");this.tLb(V);this.Qy.style.width="420px";this.show()}hide(){this.Cc&&(l.AFrameworkApplication.Ha.ry.ns(Na.AFrame.UEa),super.hide())}UTn(V){this.la.Eb(Rb.a.PHe,2);V.preventDefault();this.j$&&this.hide()}TTn(V){this.la.Eb(Rb.a.OHe,2);V.preventDefault();this.j$&&this.hide()}Ebo(V){1===V?this.la.Eb(Rb.a.PHe,2):2===V?this.la.Eb(Rb.a.OHe,2):xa.a.$(25277209,822,50,"Cancle the slide orientation change.");
this.j$&&this.hide()}tLb(){this.wF();this.X4()}wF(){super.wF();Sys.UI.DomElement.addCssClass(this.Cc,this.SDn);var V=$get("WACDialogTitleText");V.innerText=ResourceStrings.l_SetSlideScaleTitle;V.setAttribute("title",ResourceStrings.l_SetSlideScaleTitle);V=document.createElement("div");V.id=this.jl("WACDialogHtmlPanel");V.className="WACDialogHtmlPanel";this.Qy.appendChild(V);this.YIa=document.createElement("div");this.YIa.id=this.jl("WACDialogText");V.appendChild(this.YIa);V=document.createElement("div");
V.id=this.jl("Scalediv");V.className="WACDialogRow";this.YIa.appendChild(V);var Ea=document.createElement("label");Ea.id=this.jl("Scalelabel");Ea.innerText=ResourceStrings.L_SetSlideOrientationInformation;V.appendChild(Ea);V=document.createElement("div");V.id=this.jl("ScaleMode");V.setAttribute("style","margin-left: 20px;");V.className="WACDialogRow";this.YIa.appendChild(V);Ea=Fc.AWl(sa.a.ZEk+"_MaximizeFit_170x130x32",this.Kgm,ResourceStrings.L_SetSlideOrientationMaximize);Ea.id=this.jl("btnMaximize");
var Za=document.createElement("td");Za.className=String.format("clip{0}x{1}","170","130");Za.setAttribute("style","border: #ccc 1px solid");Za.appendChild(Ea);Ea=Fc.AWl(sa.a.ZEk+"_Ensurefit_170x130x32",this.Kgm,ResourceStrings.L_SetSlideOrientationEnsure);Ea.id=this.jl("btnEnsure");var ia=document.createElement("td");ia.className=String.format("clip{0}x{1}","170","130");ia.setAttribute("style","border: #ccc 1px solid");ia.appendChild(Ea);var Va=document.createElement("td");Va.setAttribute("style",
"width: 30px;");Ea=document.createElement("tr");Ea.appendChild(Za);Ea.appendChild(Va);Ea.appendChild(ia);Za=document.createElement("td");Za.setAttribute("align","center");ia=document.createElement("label");ia.id=this.jl("Maxlabel");ia.className="UIFontBold";ia.innerText=ResourceStrings.L_SetSlideOrientationMaximize;Za.appendChild(ia);ia=document.createElement("td");ia.setAttribute("align","center");Va=document.createElement("label");Va.id=this.jl("Ensurelabel");Va.className="UIFontBold";Va.innerText=
ResourceStrings.L_SetSlideOrientationEnsure;ia.appendChild(Va);const Ab=document.createElement("td");Ab.setAttribute("style","width: 30px;");Va=document.createElement("tr");Va.appendChild(Za);Va.appendChild(Ab);Va.appendChild(ia);Za=document.createElement("table");Za.appendChild(Ea);Za.appendChild(Va);V.appendChild(Za)}X4(){this.x6e(Ib.a.Wqd+(Ib.a.q9-Fc.UZm)/2-12,Ib.a.Vqd+(Ib.a.r9-Fc.XZm)/2-12)}x6e(V,Ea){this.Cc.style.top=(0>V?0:V)+"px";pb.a("DeprecateIE.SetSlideOrientation")?this.Cc.style.left=(0>
Ea?0:Ea)+"px":Vd.a.otb&&l.AFrameworkApplication.isRtl?this.Cc.style.right=(0>Ea?0:Ea)+"px":this.Cc.style.left=(0>Ea?0:Ea)+"px";this.zDn||(this.Cc.style.width=String.format("{0}em",this.width));this.Cc.style.display="Block"}static AWl(V,Ea,Za){const ia=document.createElement("img");ia.className=V;ia.setAttribute("Unselectable","on");ia.setAttribute(ha.a.ii,ha.a.pV);ia.src=Ea;Za&&(ia.alt=Za,ia.title=Za);return ia}}Fc.XZm=350;Fc.UZm=200;Object(k.a)(Fc,"SetSlideOrientationDialog",Ib.a,[]);var Kc=a(68),
jb=a(141),zb=a(285),ic=a(75);class bb extends P.a{constructor(V,Ea){super(!1,!1,!0);this.KVl=this.mfa=null;if(!V)throw Error.argumentNull("actionManager");if(!Ea)throw Error.argumentNull("presentationReader");this.la=V;this.rc=Ea}WBa(){this.mfa=Object(B.a)(this,this.Fbo,"setSlideSizeAndLayoutDialogResultHandler");this.KVl=this.edn(this.RWe());this.qp(ResourceStrings.L_SetSlideSize,this.mfa,this.KVl)}Fbo(V,Ea){1===V&&this.la.Ra(Rb.a.$Zh,2,Ea);this.dispose()}RWe(){const V=this.rc.qC(),Ea={};Ea.height=
V.height;Ea.width=V.width;Ea.slideType=this.rc.C4l();return Ea}edn(V){return{["id"]:"SlideSizeAndLayoutDialog",["bodyControls"]:V,["numberFormatInfo"]:ic.e().numberFormatInfo}}}Object(k.a)(bb,"SlideSizeAndLayoutDialog",P.a,[]);class Pb{constructor(V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd){this.fZc=this.c9b=this.GSa=0;this.slideSizeType="O_screen4x3 O_letterPaper O_A4paper O_35mm O_overhead O_banner O_custom O_ledgerPaper O_A3Paper O_B4ISOPaper O_B5ISOPaper O_B4JISPaper O_B5JISPaper O_HagakiCard O_screen16x9 O_screen16x10 O_Widescreen".split(" ");
this.zAm=[4320,4320,4320,4320,4320,576,4896,5754,6048,5115,3387,5184,3456,1872,3240,3600,4320];this.FAm=[5760,5760,6240,6480,5760,4608,6336,7672,8064,6820,4516,6912,4608,2880,5760,5760,7680];this.la=V;this.Na=Ea;this.qf=Za;this.Tb=ia;this.jc=Va;this.ya=Ab;this.sa=Hc;this.rc=gc;this.mf=fd;this.nc=hd}Kb(){this.la.ua(Rb.a.PBe,Kc.a.application,Object(B.a)(this,this.BOk,"querySlideSize"),96);this.la.ua(Rb.a.OBe,Kc.a.application,Object(B.a)(this,this.BOk,"querySlideSize"),96);this.la.ua(Rb.a.g4e,Kc.a.application,
Object(B.a)(this,this.BOk,"querySlideSize"),96);this.la.Ba(Rb.a.Oym,Kc.a.application,Ja.a.M7);this.la.ua(Rb.a.Zrm,Kc.a.application,Ja.a.kxa,96);this.la.ua(Rb.a.Loc,Kc.a.application,Object(B.a)(this,this.tpn,"handleSetSlideSize"),4);this.la.ua(Rb.a.Lsd,Kc.a.application,Object(B.a)(this,this.wpn,"handleSetSlideSize4x3"),4);this.la.ua(Rb.a.Ksd,Kc.a.application,Object(B.a)(this,this.vpn,"handleSetSlideSize16x9"),4);this.la.ua(Rb.a.V1e,Kc.a.application,Object(B.a)(this,this.BAn,"launchSlideSizeAndLayoutDialogHandler"),
4);this.la.ua(Rb.a.tom,Kc.a.application,Object(B.a)(this,this.Yam,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.la.ua(Rb.a.uom,Kc.a.application,Object(B.a)(this,this.Yam,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.la.ua(Rb.a.PHe,Kc.a.application,Object(B.a)(this,this.Nym,"setSlideOrientationHandler"),4);this.la.ua(Rb.a.OHe,Kc.a.application,Object(B.a)(this,this.Nym,"setSlideOrientationHandler"),4);this.la.ua(Rb.a.$Zh,Kc.a.application,Object(B.a)(this,this.Gbo,"setSlideSizeAndLayoutHandler"),
4);this.la.Ba(Rb.a.Pym,Kc.a.application,Ja.a.M7);this.la.Ba(Rb.a.setSlideHeight,Kc.a.application,Ja.a.M7);this.la.ua(Rb.a.asm,Kc.a.application,Ja.a.kxa,96);this.la.ua(Rb.a.$rm,Kc.a.application,Ja.a.kxa,96);this.la.Ba(Rb.a.YAm,Kc.a.application,Ja.a.M7);this.la.Ba(Rb.a.XAm,Kc.a.application,Ja.a.M7)}Ae(){}BOk(V,Ea,Za,ia,Va){xa.a.$(507843974,822,50,"Click slide size drop down.");if(Ea.contextId!==Kc.a.application)return 2;if(Ea=Object(ld.a)(jb.a,Va))V=Pb.Pwn(this.rc.qC(),V),Ea.Fg(V);return 32}BAn(V,Ea,
Za){Ea=this.ya.Ia;return!Ea||this.qf.Hd(Ea)||!pb.a("DeprecateIE.CustomizeSlideSizeActor")&&Vd.a.$y?8:1===Za?32:fa.a("CustomizeSlideSizeActor::LaunchSetSlideSizeAndLayoutDialogHandler ",V,()=>{(new bb(this.la,this.rc)).WBa();xa.a.$(507843973,822,50,"Open set slide size and layout dialog.");return 32})}Yam(V,Ea,Za,ia,Va){V=this.ya.Ia;if(!V||this.qf.Hd(V))return 16;if(1===Za)return 32;if("slideType"in Va&&"slideWidth"in Va&&"slideHeight"in Va)if(this.fZc=6,"o_custom"===Va.slideType.toString().toLowerCase())this.GSa=
6*Math.round(Va.slideWidth),this.c9b=6*Math.round(Va.slideHeight);else{Za=0;for(const Ab of this.slideSizeType){if(Va.slideType.toString().toLowerCase()===Ab.toLowerCase()){this.fZc=Za;break}Za++}"landscape"===Va.orientation.toString()?(this.c9b=this.zAm[Za],this.GSa=this.FAm[Za]):(this.GSa=this.zAm[Za],this.c9b=this.FAm[Za])}(new Fc(this.la,this.mf)).showDialog(ResourceStrings.l_SetSlideScaleTitle);xa.a.$(507843972,822,50,"Open set slide scale type dialog.");return 32}tpn(V,Ea,Za){V=this.ya.Ia;return!V||
this.qf.Hd(V)?8:this.la.Eb(Rb.a.Afb,Za)}wpn(V,Ea,Za){xa.a.$(507843971,822,50,"click set slide size 4:3.");Ea=this.ya.Ia;if(!Ea||this.qf.Hd(Ea))return 16;if(1===Za||960===this.rc.qC().width)return 32;this.GSa=5760;this.c9b=4320;this.fZc=0;return this.Q5e(this.GSa,this.c9b,V,this.fZc,"EnsureFit")}vpn(V,Ea,Za){xa.a.$(507843970,822,50,"click set slide size 16:9.");Ea=this.ya.Ia;if(!Ea||this.qf.Hd(Ea))return 16;if(1===Za)return 32;Za=this.rc.qC();if(1280===Za.width)return 32;this.GSa=7680;this.c9b=4320;
this.fZc=16;return 960===Za.width&&720===Za.height?this.Q5e(this.GSa,this.c9b,V,this.fZc,""):this.Q5e(this.GSa,this.c9b,V,this.fZc,"EnsureFit")}Gbo(V,Ea,Za,ia,Va){var Ab;Ea=this.ya.Ia;if(!Ea||this.qf.Hd(Ea))return 8;if(1===Za)return 32;pb.a("LogZoomStateForCustomSize")&&xa.a.$(507626334,822,50,`Setting custom size, IsFitToWindow: ${null===(Ab=this.nc)||void 0===Ab?void 0:Ab.pU}`);return this.Q5e(Va.width,Va.height,V,Va.slideType,Va.slideScaleType)}Nym(V,Ea,Za){Ea=this.ya.Ia;return!Ea||this.qf.Hd(Ea)?
16:1===Za?32:this.c9b&&this.GSa?V===Rb.a.PHe?this.Q5e(this.GSa,this.c9b,V,this.fZc,"Maximize"):V===Rb.a.OHe?this.Q5e(this.GSa,this.c9b,V,this.fZc,"EnsureFit"):32:(xa.a.$(507843969,822,10,"CustomizeSlideSizeActor::SetSlideOrientationHandler fail to get slide width/height."),8)}Q5e(V,Ea,Za,ia,Va){const Ab=this.ya.Ia;let gc=!1;if(Ab){var Hc=Ab.Nj();if(Hc&&0<Hc.length)for(const fd of Hc)if(fd.Cwa){gc=!0;break}}Hc=this.Tb.Kd(15,void 0,()=>{this.Na.ee();this.sa.nj()});try{Hc.ld(Ab),Hc.wc=Za,Hc.mE[zb.a.jmd]=
gc,Ab.setValue(Lb.a.slideWidth,V),Ab.setValue(Lb.a.slideHeight,Ea),Ab.setValue(Lb.a.slideScaleType,Va),Ab.setValue(Lb.a.slideSizeType,ia)}finally{Hc&&Hc.dispose()}xa.a.$(507843968,822,50,"Set slide width: {0}, height: {1}, scale type: {2}.",V,Ea,Va);this.qf.Uzc(this.jc.Tf,Ab,Za);return 32}static Pwn(V,Ea){V=V.width/V.height;switch(Ea){case Rb.a.PBe:return.01>Math.abs(V-1.33);case Rb.a.OBe:return.01>Math.abs(V-1.77);default:return!1}}}Object(k.a)(Pb,"CustomizeSlideSizeActor",null,[502]);var wc=a(81);
class Dc{}Dc.t1k=0;Dc.Z7n=22711;Object(k.a)(Dc,"ImageConstants",null,[]);var ed=a(265),ad=a(368),Gd=a(495),Od=a(55),Ld=a(117),ee=a(283),Ce=a(133);class Pc extends Ce.a{constructor(){super();this.ImageToken=null;this.ErrorCode=0}lo(){return 78}}Object(k.a)(Pc,"NotifyImageUploadFailureRequest",Ce.a,[]);class Yc{constructor(V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd,yd,Md,te,Pe,t,L,S,ka,ra,xb,Ob,Vb,Ac){this.vhb=this.Wnd=this.uU=null;this.zqe=!1;this.iTn=($c,qd)=>{($c=z.a.instance.eb("Common.ISystemInitiatedFeedback"))&&
qd&&qd.m$l&&$c.execute(Fd=>{Fd.logActivity("InsertPicture",null)})};this.la=V;this.rb=Za;this.zc=Ea;this.ya=Va;this.Tb=Ab;this.Na=ia;this.oT=gc;this.TIa=Hc;this.il=fd;this.Ogk=hd;this.rw=yd;this.le=Md;this.zb=te;this.uXc=Pe;this.Tzg=t;this.Y5b=L;this.Jm=S;this.zj=ka;this.Ea=ra;this.en=xb;this.Fd=Ob;this.N5=ra.ucc;this.La=Vb;this.aFn=null===Ac||void 0===Ac?void 0:Ac.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.InsertPictureFloodgateSurveyEnabled",!1);this.Bdm=null===Ac||void 0===
Ac?void 0:Ac.g1("DevicePictureSlideWidthAdjustmentFactor",0);this.Adm=null===Ac||void 0===Ac?void 0:Ac.g1("DevicePictureSlideHeightAdjustmentFactor",0);this.GFn=null===Ac||void 0===Ac?void 0:Ac.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.MultipleImageInsertionOffsetEnabled",!1);this.OA=ra.QK;this.Oz()}Oz(){this.aFn&&this.Fd.ZPl(this.iTn)}Kb(){this.la.ua(Rb.a.insertPicture,Q.a.application,Object(B.a)(this,this.a6l,"handleInsertPicture"),4);this.la.ua(Rb.a.AGc,Q.a.view,Object(B.a)(this,
this.Zpn,"handleUploadPictureAll"),4);this.la.ua(Rb.a.jjd,Q.a.application,Object(B.a)(this,this.don,"handleChangePicture"),4);this.la.ua(Rb.a.fLb,Q.a.application,Object(B.a)(this,this.kpn,"handleResetPicture"),4);this.la.ua(Rb.a.GYh,Q.a.application,Object(B.a)(this,this.lpn,"handleResetPictureAndSize"),4);this.la.ua(Rb.a.HYh,Q.a.application,Object(B.a)(this,this.mpn,"handleResetPictureSplitButton"),4);this.la.ua(Rb.a.ZHa,Q.a.application,Object(B.a)(this,this.eon,"handleChangePictureStyle"),4);this.la.ua(Rb.a.aRf,
Q.a.application,Object(B.a)(this,this.a6l,"handleInsertPicture"),4);this.la.ua(Rb.a.LVe,Q.a.application,Object(B.a)(this,this.mon,"handleDragAndInsertImage"),4)}Ae(){}a6l(V,Ea,Za){this.Ea.iQj&&!pb.a("DummyChangeGateForTest")&&xa.a.$(512500500,830,100,"HandleInsertPicture::DummyChangeGateForTest is disabled");Ea=this.ya.Ia;Ea=this.Ea.eae&&!!Ea&&!this.zc.Hd(Ea);Ea=(this.Tzg=this.uXc.o9l()&&this.Tzg)?Ea&&!!this.oT&&this.oT.Ztd:this.TIa.K9l&&Ea;if(!Ea)return 16;if(1===Za)return 32;this.zqe=!0;this.vhb=
this.ya.Ia;this.Q_h(V!==Rb.a.aRf,!0);return 32}Zpn(V,Ea,Za,ia,Va){var Ab;Ea=this.ya?this.ya.Ia:null;if(!Ea||!Ea.isConnected)return 16;if(!this.zj.KD(Ea,1))return this.zj.qJ(Ea),16;if(pb.a("ImageFileExtLogsForSaveImageToDisk")&&this.zqe)var gc=(gc=this.oT.UJh(null!==(Ab=null===Va||void 0===Va?void 0:Va.fileName)&&void 0!==Ab?Ab:""))?`: image file ext - ${gc}`:"";xa.a.$(512500497,822,50,"PictureActor::handleUploadPictureAll Start picture upload{0}",null!==gc&&void 0!==gc?gc:"");Ab=Yc.gzn(Va);(gc=Od.a.Bb)&&
gc.Za(Ld.a.J8l,Ab?"1":"0");this.Fd.Bsm(Sys.EventArgs.Empty);ia=!1;if(this.zqe&&this.Tzg&&!this.oT.oEb&&this.Fxn(Ab)){if(Ea=Ea.C$(this.rb.zd())){if(15!==Ea.placeholderType){const Hc=Ea.jX;Hc.BottomLeft.X!==Hc.TopLeft.X&&(ia=!0)}gc&&gc.Za(Ld.a.bwm,ia?"1":"0")}Ea&&(15===Ea.placeholderType||ia)?(gc&&gc.Za(Ld.a.CVd,ia?"PlaceHolder Rotated":"Picture Type PlaceHolder"),V=this.C6l(V,Za,Va)):V=this.aqn(V,Za,Va)}else this.oT.oEb=!1,V=this.C6l(V,Za,Va);Ab&&32===V&&xa.a.$(512500496,822,50,"Upload a svg file successfully.");
return V}Fxn(V){return V?this.Ea.M2e:!0}Son(V,Ea){Object(wc.b)(this,void 0,void 0,function*(){if(!Ea||0===Ea.length)return xa.a.$(508122975,822,15,"MultipleDragOfImages: No src urls captured for dragged images"),32;const Za=performance.now(),ia=[];let Va=!1;Promise.all(Ea.flatMap((Ab,gc)=>{try{const Hc=new URL(Ab);return fetch(new URL(Hc)).then(fd=>fd).catch(fd=>{xa.a.$(508070036,822,10,"Error in fetching response for url : {0}",fd.message);return[]})}catch(Hc){return console.log(Hc.message),xa.a.$(508125897,
822,15,"Error while downloading Multiple Dragged images on File no. {0} where error: {1}",gc,Hc.message),[]}})).then(Ab=>Promise.all(Ab.flatMap(gc=>gc&&gc.ok?[gc.blob()]:[]))).catch(Ab=>{console.log(Ab.message);xa.a.$(508126305,822,15,"Error while downloading Multiple Dragged images");return[]}).then(Ab=>{Ab&&Ab.length?(Ab.map((gc,Hc)=>{const fd=gc.type.search("/");Hc="temp"+String(Hc)+"."+gc.type.substring(fd+1,gc.type.length);0===this.oT.kfd(Hc)?ia.length<this.Ea.znc&&ia.push(new File([gc],Hc)):
Va=!0}),Va&&(xa.a.$(508101728,822,15,"MultipleDragOfImages: Unsupported Image Format from browser for Multi Drop "),this.en.yH(1<ia.length?29:18)),0<ia.length&&(Ab=performance.now(),xa.a.$(508074067,813,50,"PictureActor : handleMultipleDraggedImageUrl : total time taken {0} ms to download {1} files.",Ab-Za,ia.length),Ab=[],Ab=ia.slice(),this.oT.b1i(Ab,V,!1))):xa.a.$(508126304,822,15,"Error while downloading Multiple Dragged images")});return 32})}mon(V,Ea,Za,ia,Va){if(!this.oT.Kpm)return xa.a.$(512500495,
822,15,"PictureActor::HandleDragAndInsertImage - PictureUploadLargeImageEnabled is false"),16;if(!Va)return 16;Ea=null;Za=!1;if(this.Ea.XNc)if(Va.droppedFiles)V=Va.droppedFiles,Ea=Va.droppedPoint,Za=Va.fromBrowser;else return Ea=Va.droppedPoint,Va.ImgSrcList.length>this.Ea.znc&&(this.en.yH(28),xa.a.$(508101727,822,15,"PictureActor::HandleDragAndInsertImage - Dragging more Images than limit from browser, Number of files: {0}",Va.ImgSrcList.length)),xa.a.$(508086469,822,50,"PictureActor::HandleDragAndInsertImage - Number of files dropped from browser: {0}",
Va.ImgSrcList.length),this.Son(Ea,Va.ImgSrcList.slice(0,this.Ea.znc)),32;else V=Va;Va=[];ia=0;let Ab=!1;for(const gc of V){ia++;if("string"!==typeof gc.type)continue;const Hc=la.a.ph(gc.type);xa.a.$(512500494,822,50,"PictureActor::HandleDragAndInsertImage - No.{0} file  Size In Bytes:{1}; Tpye:{2} ",ia,gc.size,Hc);if(0<=Hc.indexOf("image")&&0===this.oT.kfd(gc.name))if(Va.length<this.Ea.Yqd)Array.add(Va,gc);else{this.en.yH(19);xa.a.$(508086468,822,15,"PictureActor::HandleDragAndInsertImage - Dragging more Images than limit from local system, Number of files: {0}",
V.length);break}else Ab||(pb.a("ErrorMessageUpdatedFixForUnsupportedFileFormatForMultiDrop")?this.en.yH(1<V.length?29:18):this.en.yH(18),Ab=!0)}Ab&&(Za?xa.a.$(508065562,822,15,"PictureActor::HandleDragAndInsertImage - Unsupported image format from browser for single drop"):1<=Va.length&&xa.a.$(508061897,822,15,"PictureActor::HandleDragAndInsertImage - Multiple Images dropped from local that has an Unsupported Image format"));if(!Za&&1>Va.length)return xa.a.$(512500493,822,15,"PictureActor::HandleDragAndInsertImage - unlegal image format"),
16;this.oT.b1i(Va,Ea,1==Va.length);return 32}C6l(V,Ea,Za){if(!(this.ya&&this.ya.Ia&&this.oT))return 16;if(1===Ea)return 32;this.TIa.exe=new Date;this.zqe&&this.rb.lk();this.Na.ee();this.zc.blockContent(this.ya.presentation,V,!1,void 0,void 0);const ia=Od.a.Bb;this.oT.r0h(Za,Va=>{Od.a.SK(ia,()=>{xa.a.$(512500492,822,50,"Picture upload successful");this.$on(Za,Va,V);this.Z0l()})},Va=>{xa.a.$(512500491,822,10,"Upload picture failed");this.q$f(Va.error);this.Z0l()});return 32}aqn(V,Ea,Za){if(!(this.ya&&
this.ya.Ia&&this.oT))return 16;if(1===Ea)return 32;const ia=String.format("{0}{1}","client",Lc.a.create().toString());xa.a.$(512500490,822,50,"Client generated imageToken:{0}, imageSize:{1}",ia,Za.LS);this.TIa.rYm(ia);const Va=Od.a.Bb;Va&&(Ea="InsertPicture",this.zqe||(Ea="ChangePicture"),Va.actionName=Ea,Va.pj=!0);const Ab=new Date;Od.a.Ak("PictureUploadStart",Od.a.Pf(Ab));Od.a.Ak("ImageSize",Za.LS.toString());Od.a.Ak("ImageToken",ia);const gc=this.ya.Ia.sid;this.la.Ra(Rb.a.KNh,2,gc);this.oT.r0h(Za,
Hc=>{Od.a.SK(Va,()=>{xa.a.$(512500489,822,50,"Upload picture completed, ImageToken:{0}",ia);Od.a.Ak("PictureUploadDurationMS",(+new Date-+Ab).toString());this.ZWn(ia,Hc);this.la.Ra(Rb.a.adg,2,gc)})},Hc=>{this.TIa.RZl(ia);var fd=Object.assign(new Pc,{ImageToken:ia,ErrorCode:Hc.error.Code});Va&&Va.Za("UploadPictureErrorCode",ed.a[fd.ErrorCode]);fd=new ee.a(fd,null,()=>Yc.PSn());this.Jm.Rb(fd);xa.a.$(512500488,822,10,"Upload picture failed, ImageToken:{0}, ErrorCode:{1}, Error Message:{2}",ia,ed.a[Hc.error.Code],
Hc.error.Message);this.la.Ra(Rb.a.adg,2,gc)},ia);this.insertPicture(ia,V,Za);return 32}don(V,Ea,Za){V=this.N5?this.fZd():this.VWe();if(!(this.N5?this.Vig(V):this.n$l(V)&&this.Ea.eae&&this.TIa.K9l&&!this.zc.Hd(V)))return 16;if(1===Za)return 32;this.zqe=!1;this.Q_h(!0,!1);return 32}kpn(V,Ea,Za){return this.ZHa(Ea,Za,Dc.t1k,V)}lpn(V,Ea,Za){return this.ZHa(Ea,Za,Dc.Z7n,V)}mpn(V,Ea,Za,ia,Va){return this.ZHa(Ea,1,Va,V)}eon(V,Ea,Za,ia,Va){return this.ZHa(Ea,Za,Va,V)}ZHa(V,Ea,Za,ia){const Va=this.rb.zd();
if(!(Va&&0<Va.length))return 8;V=[];if(pb.a("FixForPictureAndGraphicsStyleForGrpShapes"))this.Tkn(Va,V);else for(const gc of Va){if(this.f$l(gc)||this.zc.Hd(gc))return 8;(this.N5?this.Vig(gc):this.n$l(gc))&&V.push(gc)}if(0>=V.length)return 8;if(1===Ea)return 32;xa.a.$(512500487,822,15,"PictureStyle change started. PictureStyleId: '{0}'",Za);Ea=Od.a.Bb?Od.a.Bb.actionName:null;for(var Ab of V)this.EZ(Ab);Ab=this.Tb.Kd(15,void 0,()=>{this.rb.lk();this.Na.ee()});try{Ab.tc(V[0]);Ab.wc=ia;for(const gc of V)gc.Fab=
Za}finally{Ab&&Ab.dispose()}if(ia=Od.a.Bb)Ea&&(ia.actionName=Ea),ia.Za("PictureStyleId",Za.toString()),Od.a.t0(ia);return 32}Tkn(V,Ea){let Za=!1;for(const ia of V){if(!ia||this.f$l(ia)||this.zc.Hd(ia))return;ia.Eg&&(Za=!0)}if(Za)for(const ia of V)ia.Eg&&this.Vig(ia)&&Ea.push(ia);else for(const ia of V)if(this.Vig(ia))Ea.push(ia);else if(ia.Ge){V=this.La.Mu(ia);for(const Va of V)this.Vig(Va)&&Ea.push(Va)}}$on(V,Ea,Za){this.TIa.Jqd=new Date;const ia=Ea.result;if(V){if(this.zqe?(Ea="InsertPicture",this.Cvn(ia,
V,Za)):(Ea="ChangePicture",pb.a("ChangePictureOnMultiSelectFixEnabled")?this.Z_m(ia,V,Za):this.$_m(ia,V,Za)),V=Od.a.Bb)V.actionName=Ea,V.Za("PictureUploadStart",Od.a.Pf(this.TIa.exe)),V.Za("PictureUploadDurationMS",(+this.TIa.Jqd-+this.TIa.exe).toString())}else V=Object.assign(new ad.a,{Code:94}),this.q$f(V)}ZWn(V,Ea){this.TIa.RZl(V);Ea.result||xa.a.$(512500486,822,50,"Upload picture completed with null response")}Cvn(V,Ea,Za){const ia=this.ya.Ia;if(ia&&ia.isConnected){this.Wnd=ia.C$(this.rb.zd());
var Va=this.Tb.Kd(15,void 0,void 0,()=>{this.rb.selectShape(this.uU,!0);this.Na.ee()});try{Va.tc(ia);Va.wc=Za;Va.mE[zb.a.Dfb]=zb.a.kbj;this.uU=this.il.uWl(0,ia.fc);this.Wnd&&(this.uU.Yva=this.Wnd.id);let Ab=Za=0;this.Ea.getBooleanAppSetting("InsertPictureSizeIncreaseEnabled")&&(Za=ia.To*this.Bdm,Ab=ia.xk*this.Adm);this.uU.Jjh(V.ItemId,null,Ea.fileName,Za,Ab);ia.BJ(this.uU)}finally{Va&&Va.dispose()}this.zc.snb(this.ya.Ia,this.uU,this.zb.Ua,"InsertPictureAfterUpload");this.rw.MJ=this.uU}}Z_m(V,Ea,Za){var ia=
this.rb.zd();if(ia){var Va=[];for(const Ab of ia)Ab.Ge||Va.push(Ab);for(const Ab of Va)this.EZ(Ab);ia=this.Tb.Kd(15);try{ia.wc=Za;ia.tc(Va[0]);for(const Ab of Va)Ab.Yva=Ab.id,Ab.Jjh(V.ItemId,null,Ea.fileName),Ab.set_alt("")}finally{ia&&ia.dispose()}for(const Ab of Va)this.zc.snb(this.ya.Ia,Ab,this.zb.Ua,"ChangePictureAfterUpload")}}$_m(V,Ea,Za){const ia=this.N5?this.fZd():this.VWe();if(ia){this.EZ(ia);var Va=this.Tb.Kd(15);try{Va.wc=Za,Va.tc(ia),ia.Yva=ia.id,ia.Jjh(V.ItemId,null,Ea.fileName),ia.set_alt("")}finally{Va&&
Va.dispose()}this.zc.snb(this.ya.Ia,ia,this.zb.Ua,"changePictureAfterUploadSingleImage")}}q$f(V){this.TIa.Jqd=new Date;xa.a.$(512500484,822,50,"Upload picture failed");this.le.nM(V.Code,Ea=>{Ea.UE=1;Ea.Ifb=V.ExtraErrorParam;return!1})}Z0l(){this.zc.BE(this.ya.presentation)}Q_h(V,Ea){this.Ogk?Gd.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.oT&&(this.oT.wnd=this.Tzg,this.oT.oGb=0,V&&this.oT.rNk(Ea))}VWe(){const V=this.rb.zd();for(const Ea of V)if(Ea&&this.dig(Ea))return Ea;
return null}fZd(){const V=this.rb.zd();return V&&V.length?this.jyi(V)?V[0]:this.VWe():null}jyi(V){return null===V||void 0===V?void 0:V.filter(Ea=>!!Ea).every(Ea=>this.dig(Ea)||1===Ea.mediaType)}dig(V){return V.Pg&&!(this.OA&&V.RB)}Qk(V){return V?Object(ld.a)(112,V.yc(this.zb.Ua)):null}EZ(V){V&&V.Yw&&(V=this.Qk(V))&&V.yY(!1)}n$l(V){return!this.ya||!this.ya.Ia||!V||this.OA&&V.RB||!V.Pg?!1:!0}Vig(V){return!this.ya||!this.ya.Ia||!V||this.OA&&V.RB||!V.Pg&&1!==V.mediaType?!1:!0}f$l(V){return this.ya&&this.ya.Ia&&
V&&V.xm?!0:!1}insertPicture(V,Ea,Za){var ia=this.ya.Ia;const Va=Object(ld.a)(107,ia.yc(this.zb.Ua)),Ab=this.vhb.fc;if(ia&&ia.isConnected&&Va&&this.vhb&&this.vhb.isConnected){ia=this.vhb.Av();this.Wnd=this.vhb.C$(this.rb.zd());var gc=0,Hc=0;this.Ea.getBooleanAppSetting("InsertPictureSizeIncreaseEnabled")&&(gc=this.Bdm,Hc=this.Adm);var {CVf:fd,PT:hd}=this.Y5b.cJf(this.Ea.XNc&&!Za.Urd?void 0:this.Wnd,Za.imageWidth,Za.imageHeight,Va.rM,Za.TIb,Za.UIb,Za.Urd,gc,Hc);!this.GFn||void 0!=Za.TIb&&void 0!=Za.UIb||
(Za.TIb=hd.x,Za.UIb=hd.y,Za.Urd=!1,xa.a.$(507786768,822,50,"PictureActor:insertPicture Setting position of first image"));gc=this.Tb.Kd(15,void 0,()=>{this.rb.Rx();this.rb.nj();this.Na.ee()},()=>{this.rw.MJ=this.uU;this.rb.selectShape(this.uU,!0)});try{gc.tc(this.vhb);gc.wc=Ea;this.uU=this.il.JXa(!0,Ab.cid,Ab.sid,0,hd.x,hd.y,fd.width,fd.height,ia+1,!1);const yd=this.Y5b.uCf(this.zb.Cd,fd,hd,Va.rM);this.uU.jX=yd;this.Wnd&&(this.uU.Yva=this.Wnd.id,this.vhb.w1([this.Wnd]));this.uU.Jjh(V,null,Za.fileName);
this.uU.isResizable=!0;this.uU.MOc=!0;this.uU.kL=!0;this.uU.ela=!0;this.uU.Pg=!0;this.uU.mIb=!!Za.U$b;this.uU.yna=Za.U$b||Za.aMc;this.vhb.BJ(this.uU)}finally{gc&&gc.dispose()}Od.a.J7e()}}static gzn(V){return!!V&&!!V.fileName&&V.fileName.toLowerCase().indexOf(".svg")===V.fileName.length-4}static PSn(){xa.a.$(512500483,822,50,"NotifyImageUploadFailureRequest failed");return!0}}Object(k.a)(Yc,"PictureActor",null,[502]);var Bd=a(134),Dd=a(220),Sd=a(855),He=a(1198),ge=a(108);class ve extends Sys.EventArgs{constructor(V,
Ea){super();this.p$l=V;this.Okg=Ea}}Object(k.a)(ve,"TokenRefreshEventArgs",Sys.EventArgs,[]);class ze{constructor(V,Ea,Za,ia,Va,Ab,gc){this.a1e=0;this.ud=V;this.Ulk=Ea;this.VO=Za;this.la=ia;this.lr=Va;this.Yb=Ab;this.Ea=gc;this.Ulk&&this.Ulk.Ixf(Object(B.a)(this,this.Tnm,"onTokenRefreshed"))}IHi(V){!this.Ea.Mqd&&this.Yb.xwa&&this.Yb.wZa();const Ea=Ta.a.instance.Kra(l.AFrameworkApplication.Ao),Za=Ta.a.instance.Egb(l.AFrameworkApplication.Ao,l.AFrameworkApplication.iZ);xa.a.$(508694619,801,Ea||Za?15:
50,"SessionRehydrationController::CheckAccessTokenExpiry - IsExpired:{0}, IsExpiring:{1}, Trigger:{2}, Improvement:{3}, RetryCount:{4}",Ea,Za,V,this.Ea.Mqd,this.a1e);Ta.a.instance.R2a();this.Ea.Mqd&&this.Yb.xwa&&this.Yb.wZa()}Tnm(V,Ea){xa.a.$(508694618,809,50,"PPTTokenRefreshManager::OnTokenRefreshed, isShuttingdown {0}, task manager hasStopped {1}",l.AFrameworkApplication.Ch,this.Yb.xwa);try{const Za=Object(ld.a)(rb,Ea)||new rb(null,null),ia=Za.tokens,Va=Za.errors;V="";if(void 0===Va||null===Va||
0>=Va.count)for(Ea=0;Ea<ia.count;Ea++)if(ia.ka(Ea).Name===Ub.a.Gxm){const gc=ia.ka(Ea)?ia.ka(Ea):null;V=gc&&gc.Value&&0<gc.Value.length?gc.Value:"";break}const Ab=Ta.a.instance.Kra(l.AFrameworkApplication.Ao);xa.a.$(508694617,809,50,"PPTTokenRefreshManager::OnTokenRefreshed fTokenExpired:{0} m_applicationSettings.PPTOTokenRefreshRetryEnabled:{1} m_tokenRefreshRetryCount:{2} m_applicationSettings.PPTOTokenRefreshRetryLimit:{3}",Ab,this.Ea.dXh,this.a1e,this.Ea.NKk);if(0<V.length&&Ab&&this.Ea.dXh&&this.a1e<
this.Ea.NKk)xa.a.$(508694616,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token refreshed successfully but is expired. NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}, RetryEnabled:{4}, CurrentRetryCount:{5}",(new Date).getTime(),new Date,l.AFrameworkApplication.Ao,new Date(l.AFrameworkApplication.Ao),this.Ea.dXh,this.a1e),this.a1e++,this.IHi(2);else if(0<V.length&&!Ab){xa.a.$(508694615,809,Ab?15:50,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed successfully, NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}",
(new Date).getTime(),new Date,l.AFrameworkApplication.Ao,new Date(l.AFrameworkApplication.Ao));Dd.App.TWe=l.AFrameworkApplication.hIb=la.a.yj(V);const gc=this.VO.u5c.ei.P6e+"&access_token="+encodeURIComponent(l.AFrameworkApplication.accessToken)+"&access_token_ttl="+encodeURIComponent(l.AFrameworkApplication.Ao.toString());this.VO.u5c=new He.a(new Sd.a(gc));this.ud.GRk(new ve(this.lr?this.lr.XNa:!1,!0))}else{if(pb.a("CleanPIIFromC49mm")&&Va)for(const gc of Va)if(gc.Errors)for(const Hc of gc.Errors)"403"===
Hc.Id&&Hc.Details&&Hc.Details.startsWith("<")&&(Hc.Details=null);xa.a.$(508694614,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed, errors: {0}, RetryCount:{1}",Va?Bd.c(Va):"There is no error in Refreshed Token, but GetFileUrl is empty",this.a1e);if(Va&&0<=Bd.c(Va).indexOf("The caller is not authenticated"))l.AFrameworkApplication.Ds(ge.a.Ji(383)),Eb.Health.instance.recordQosError("WopiTokenRefreshFailedOnHostUnauth",["SessionExpired"],!1,!0,!1,!0,null);else{if(pb.a("SkipSessionExpiredVetoForShutdown")&&
l.AFrameworkApplication.Ch){xa.a.$(508351136,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token refresh failed, skipping error and restart on shutting down, task manager hasStopped {}",this.Yb.xwa);return}l.AFrameworkApplication.Ds(ge.a.Ji(380));Eb.Health.instance.recordQosError("WopiTokenRefreshFailed",["SessionExpired"],!1,!0,!0,!0,null)}l.AFrameworkApplication.GA&&l.AFrameworkApplication.GA.ana();this.ud.GRk(new ve(this.lr?this.lr.XNa:!1,!1));this.la.Ra(Rb.a.refresh,2,{refreshtrigger:"PPTTokenRefreshManager::OnTokenRefreshed"})}}catch(Za){xa.a.$(508694613,
809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed and throw exception, exception: {0}",Bd.c(Za))}}dispose(){this.Ulk.rYh(Object(B.a)(this,this.Tnm,"onTokenRefreshed"))}}Object(k.a)(ze,"PPTTokenRefreshManager",null,[714]);var bf=a(107),Of=a(812);class Qf{constructor(V,Ea,Za,ia,Va,Ab){this.bla=this.Qoo=this.e0k=null;this.XUf=this.U7i=!1;this.STh=0;this.eMb=Od.a.Xk("SeamlessFailover");1!==Ea&&2!==Ea||Od.a.vQa();this.$l=new Date;Od.a.mJb=this.startTime;this.aQm=Za;this.Njd=
0;this.IQm=Ea;this.NNm=ia;this.mQm=Va;this.Yjo=Ab;this.fSucceeded=!1;this.resultCode=0;this.fKl=!0;if(V=l.AFrameworkApplication.rd)this.Nd.Za("Host",Object(ld.a)(String,V.Host)),this.Nd.Za("Ring",Object(ld.a)(String,V.Ring))}Vym(V,Ea){this.STh=window.setTimeout(V,Ea)}Zgo(){this.fKl=!1}dispose(){Od.a.Ylc=new Date;0<=this.STh&&(window.clearTimeout(this.STh),this.STh=-1)}get Ian(){return this.fKl}get Nd(){return this.eMb}get startTime(){return this.$l}get AVn(){return this.aQm}get boc(){return this.IQm}get wan(){return this.NNm}get Nqd(){return this.mQm}}
Object(k.a)(Qf,"SeamlessFailoverState",null,[40]);var Oe=a(90);const tg=V=>{V=String.format("{0}/PodHandler.ashx?action=TriggerFontsInstallation&PodsID={1}",l.AFrameworkApplication.ha.Ma(Oe.a.ym),V);l.AFrameworkApplication.$d.lZ(V,1,null,null,null,!1,0,()=>{xa.a.$(512263E3,801,50,"CustomFontHelper::TriggerFontsInstallation - Succeeded")},()=>{xa.a.$(512262999,801,15,"CustomFontHelper::TriggerFontsInstallation - Failed to set document settings")},null)};var Cf;(function(V){V[V.unknown=0]="unknown";
V[V.mouse=1]="mouse";V[V.keyboard=2]="keyboard";V[V.podsPopsUnavailable=4]="podsPopsUnavailable"})(Cf||(Cf={}));Object(k.b)("RehydrationTrigger",Cf);var oe=a(826),Rf=a(1621);class Uf{constructor(V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd,yd,Md,te,Pe,t,L,S,ka,ra,xb,Ob,Vb,Ac){this.fk=this.kak=null;this.Bpk=this.hUh=-1;this.yhm=0;this.PJb=V;this.na=Ea;this.jc=Za;this.la=ia;this.Yb=Va;this.iF=Ab;this.Me=gc;this.Og=fd;this.pT=hd;this.le=yd;this.Mq=Md;this.Nh=te;this.kc=Pe;this.vU=t;this.Iq=ka;this.Xlk=new Date;this.pA=
L;this.xM=S;this.ya=ra;this.Jb=xb;this.Zod=Ob;Ac.execute($c=>{this.kak=$c});this.jRh=[];this.zGn=this.Jb.Ac("SeamlessFailoverMaxRetryAttempts",0);this.yGn=this.Jb.getBooleanAppSetting("SeamlessFailoverIncludePopsInfoInFinalLog");this.AGn=this.Jb.getBooleanAppSetting("SeamlessRehydrationAbortOnAbortedOnExitAppQosEnabled");xa.a.$(512497885,809,50,"PodSeamlessFailoverManager::PodSeamlessFailoverManager()")}get XNa(){return!!this.fk&&this.fk.Ian}get aKh(){return this.yhm}fTe(V){if(this.XNa){l.AFrameworkApplication.Iz&&
(this.Nh.H4e(Object(B.a)(this,this.Nhb,"onWopiTokenRefreshed")),this.kHf());var Ea=0;if(this.na.eJb)this.fk.Nd.zw("Result","abortedOnIrmProtectedFile"),Ea=365;else if(this.fk.Nd.zw("Result",V),"abortedOnExitApp"!==V||this.AGn)Ea=4===this.fk.boc?356:357;this.aGe(!1,Ea,!this.fk.XUf&&"abortedOnRefreshDoc"!==V)}}juh(V,Ea,Za){if(this.XNa)xa.a.$(512497884,801,15,"PodSeamlessFailoverManager::TriggerFailover skipped");else{l.AFrameworkApplication.GA||(l.AFrameworkApplication.GA=xa.a.zkc());this.le.disabled=
!1;this.le.kna=!1;this.fk=new Qf(V,Ea,this.Me.podSessionId,this.na.n2e,this.na.Nqd,Za);this.na.UQe||this.fk.Vym(Object(B.a)(this,this.Dlm,"onFailoverTimeout"),this.na.Wxe);this.fk.Nd.Za("PopsAvailable",this.Og.VF.toString());this.fk.Nd.Za("OrderlyShutdown",V.toString());this.fk.Nd.Za("Trigger",Cf[Ea]);this.fk.Nd.Za("TriggerErrorCode",ed.a[Za]);this.fk.Nd.Za("OldPodsId",this.fk.AVn);this.fk.Nd.Za("OldPopsId",this.Me.wk);xa.a.$(512497883,809,50,"PodSeamlessFailoverManager::TriggerFailover:ActionID:{0}; ActionDetails:{1}",
this.fk.Nd.actionId,this.fk.Nd.Dxa());if(1===Ea||2===Ea)l.AFrameworkApplication.Ch=!1,this.ya.presentation&&this.ya.presentation.W4e();this.Nh.DTe(Object(B.a)(this,this.Nhb,"onWopiTokenRefreshed"));l.AFrameworkApplication.Iz&&Ta.a.instance.R2a()?(xa.a.$(512497882,809,15,"FileUrlExpired on TriggerFailover, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),new Date,l.AFrameworkApplication.Ao,new Date(l.AFrameworkApplication.Ao)),this.kHf(),this.hUh=window.setTimeout(Object(B.a)(this,
this.XUn,"onWopiTokenRefreshTimeout"),this.na.q8e),this.na.HFk&&this.Zod.zaj(!1,"PodSeamlessFailoverManager")):(this.Nh.H4e(Object(B.a)(this,this.Nhb,"onWopiTokenRefreshed")),this.XCm(Ea))}}a0l(V){if(Array.contains(this.na.l2e,ge.a.Ji(V).toString())){if(!this.jRh.length)return!0;const Ea=new Date;let Za=0;for(let ia=this.jRh.length-1;0<=ia;ia--){const Va=this.jRh[ia];if(+Ea-+Va.startTime>this.na.uxe)break;Va.Yjo===V&&Za++}if(Za<this.na.m2e)return!0;xa.a.$(512497881,809,10,"PodSeamlessFailoverManager::FTriggerFailoverForServerError - Failover for Error[{0}] has been triggered for {1} times within {2}ms. Skip.",
V,Za,this.na.uxe)}return!1}XCm(V){l.AFrameworkApplication.Iz&&(this.Nh.H4e(Object(B.a)(this,this.Nhb,"onWopiTokenRefreshed")),this.kHf());if(++this.yhm>this.zGn)this.xyj("SeamlessFailoverMaxRetryCountReached",392);else if(this.na.UQe&&this.fk.Vym(Object(B.a)(this,this.Dlm,"onFailoverTimeout"),this.na.Wxe),+new Date-+this.Xlk>=36E5*this.na.O2e)this.xyj("RecoveryStreamExpired",358);else{if(this.fk.U7i&&(this.fk.Nd.zw("Trigger",Cf[V]+"_GetFileUrlExpired"),this.rwn())){this.xyj("GetFileUrlExpired_NoAzureBackup",
364);return}this.fk.wan&&this.G0m();this.Nh.Crd(new oe.a(4===V?5:2));this.Nh.ysm(new Sys.EventArgs);this.na.o2e&&4===V&&(xa.a.$(512497880,801,15,"PodSeamlessFailoverManager::TriggerFailover - Close PopSesion: {0}",this.Me.wk),this.vU.MHb(()=>{},()=>{}));this.Mq.isPaused||this.Mq.pause();this.fk.Nd.Fm("CreatePodsWithRetryST",new Date);this.fk.Nd.Fm("SessionStartTime",this.Xlk);this.ztm()}}xyj(V,Ea){this.Yb.xwa&&this.Yb.wZa();this.fk.Nd.zw("Result",V);this.aGe(!1,Ea)}XUn(){this.Nh.H4e(Object(B.a)(this,
this.Nhb,"onWopiTokenRefreshed"));this.kHf();xa.a.$(512497879,809,50,"WopiTokenRefreshed timeout during TriggerFailover");this.fk.Nd.Za("WopiTokenRefreshed","TO");l.AFrameworkApplication.Ds(ge.a.Ji(382));Eb.Health.instance.recordQosError("WopiTokenRefreshTimeoutOnRehydration",["SessionExpired"],!1,!0,!0,!0,null);l.AFrameworkApplication.GA&&l.AFrameworkApplication.GA.ana();this.fk.XUf=!0;this.la.Ra(Rb.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::OnWopiTokenRefreshTimeout"})}Nhb(V,Ea){V=
Ea.Okg;this.Nh.H4e(Object(B.a)(this,this.Nhb,"onWopiTokenRefreshed"));this.kHf();this.na.HFk&&this.Zod.zaj(!0,"PodSeamlessFailoverManager");Ea=0<l.AFrameworkApplication.Ao&&(new Date).getTime()>=l.AFrameworkApplication.Ao-this.na.TQe;xa.a.$(512497878,809,50,"WopiTokenRefreshed during TriggerFailover, IsTokenRefreshedSuccessfully: {0}, NowTicket: {1}, NowDateTime:{2}, AccessTtl:{3}, AccessTtlDateTime: {4}",V,(new Date).getTime(),new Date,l.AFrameworkApplication.Ao,new Date(l.AFrameworkApplication.Ao));
this.fk.Nd.Za("WopiTokenRefreshed","True");this.fk.Nd.Za("WopiTokenRefreshedSuccessfully",V.toString());this.fk.U7i=Ea;V?this.XCm(this.fk.boc):this.fk.XUf=!0}kHf(){-1!==this.Bpk&&(window.clearTimeout(this.Bpk),this.Bpk=-1);-1!==this.hUh&&(window.clearTimeout(this.hUh),this.hUh=-1)}rwn(){const V=la.a.ph(this.Jb.Ma(Oe.a.YXa)||""),Ea=!l.AFrameworkApplication.Ng.IsRealEdit&&1!==this.fk.boc&&2!==this.fk.boc;return".pptx"!==V&&".ppsx"!==V||Ea}G0m(){try{let V=0,Ea=0;const Za={},ia={};this.Iq.NOl(Va=>{if(-1<
Va.request.get_url().search(new RegExp(this.fk.Nqd,"i")))return this.JCm(Za,this.h4l(Va.request.get_url())),V++,!0;this.JCm(ia,this.h4l(Va.request.get_url()));Ea++;return!1});xa.a.$(512497877,801,15,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests - abort {0} requests: {1}, remain {2} request: {3}",V,Za,Ea,ia)}catch(V){xa.a.$(512497876,801,10,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests failed. {0}",V)}}h4l(V){let Ea=V;const Za=V.indexOf("?");0<Za&&(Ea=V.substr(0,Za));V=Ea.lastIndexOf("/");
0<V&&(Ea=Ea.substr(V+1));return Ea}JCm(V,Ea){V[Ea]=Ea in V?V[Ea]+1:1}Dlm(){this.XNa&&(this.fk.Nd.zw("Result","Timeout"),this.fk.Nd.Za("TimeoutDuration",(+new Date-+this.fk.startTime).toString()),this.aGe(!1,4===this.fk.boc?354:355))}aGe(V,Ea=0,Za=!0){if(this.XNa){this.pT.G7c(Object(B.a)(this,this.Hhb,"onPodSessionRefreshed"));this.jc.tj.Zq.joc(Object(B.a)(this,this.Ikm,"onAfterReplication"));var ia=+new Date-+this.Xlk>=6E4*this.na.g3e;l.AFrameworkApplication.Iz&&(ia=0<l.AFrameworkApplication.Ao&&
(new Date).getTime()>=l.AFrameworkApplication.Ao-this.na.TQe)&&xa.a.$(512497875,809,15,"FileUrlExpired on SeamlessFailoverEnd, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),new Date,l.AFrameworkApplication.Ao,new Date(l.AFrameworkApplication.Ao));V&&ia&&this.fk.Nd.Za("SkipPopsReason","FileUrlExpired");this.kc.r8j();var Va=this.fk.boc;this.fk.Nd.Za("IsInEditingMode",this.kc.oq.toString());this.fk.Nd.Za("IsPreviousModeEditing",this.kc.$md.toString());this.fk.Nd.Za("IsLastKnownModeEditing",
this.kc.gZe.toString());this.fk.Nd.Za("PopSessionEverInitialized",this.Og.D4c.toString());this.fk.Nd.Za("ResultErrorCode",ed.a[Ea]);this.fk.Nd.Za("RefreshPage",Za.toString());this.fk.Nd.Za("FRehydrationInitiatedPageRefresh",this.fk.XUf.toString());this.fk.fSucceeded=V;this.fk.resultCode=Ea;this.fk.Zgo();this.jRh.push(this.fk);this.yGn||this.CKh();V?(this.Nh.QQk(new Rf.a(Va)),this.cDm(ia,Va)):(this.CKh(),0!==Ea&&(V=ge.a.Ji(Ea),l.AFrameworkApplication.Ds(V),Eb.Health.instance.recordQosError(ge.a.Vma(V),
["UnexpectedAppRefresh"],399===Ea,!1,!0,Za,null)),Za?(l.AFrameworkApplication.GA&&l.AFrameworkApplication.GA.ana(),this.la.Ra(Rb.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::SeamlessFailoverEnd"})):(this.Nh.QQk(new Rf.a(Va)),this.cDm(ia,Va)))}}fVf(){return this.fk&&this.fk.Nd?!0:!1}CKh(){this.fVf()&&(xa.a.$(512497874,801,15,"Action Telemetry: {0}",this.fk.Nd.Dxa()),this.fk.Nd.finish(!0),this.fk.dispose(),this.fk=null)}cDm(V,Ea){!this.kc.eQ||V||2!==Ea&&1!==Ea&&4!==Ea?(this.fVf()&&this.fk.Nd.Za("PopsRehydrationAttempted",
"false"),xa.a.$(512497873,809,15,"TriggerRehydrateHostSession is skipped isFileUrlExpired:{0}, rehydrationTriger:{1}",V,Ea),this.RWl(null)):(this.fVf()&&this.fk.Nd.Za("PopsRehydrationAttempted","true"),this.vU.fga(4===Ea?6:7,Object(B.a)(this,this.f5m,"createPopSessionSucceededCallback"),Object(B.a)(this,this.RWl,"createPopSessionFailedCallback")))}f5m(){this.fVf()&&(this.O0l(),this.fk.Nd.Za("POPSessionCreated","true"),this.CKh())}RWl(){if(!this.fVf())return!1;this.O0l();this.fk.Nd.Za("POPSessionCreated",
"false");this.CKh();return!1}O0l(){this.fk.Nd.zw("IsInEditingMode",this.kc.oq.toString());this.fk.Nd.zw("IsPreviousModeEditing",this.kc.$md.toString());this.fk.Nd.zw("PopSessionEverInitialized",this.Og.D4c.toString())}Zjo(V){xa.a.$(512497872,801,50,"PodSeamlessfailoverManager TriggerFontsInstallationCallback started with UserHasValidLicenseForEnterpriseFonts:{0}, PPTOEnterpriseFontsEnabled:{1}",this.Jb.getBooleanAppSetting("UserHasValidLicenseForEnterpriseFonts"),this.Jb.getBooleanAppSetting("PPTOEnterpriseFontsEnabled"));
this.Jb.getBooleanAppSetting("UserHasValidLicenseForEnterpriseFonts")&&this.Jb.getBooleanAppSetting("PPTOEnterpriseFontsEnabled")&&tg(V)}ztm(){this.fk.bla=Of.a();this.Yb.xwa||this.Yb.stop();let V=this.na.aFe&&this.ya.Pw?this.ya.Pw.toString():"";V=la.a.replaceAll(V,"#","%23");this.PJb.createPodSession(this.fk.bla,"SeamlessFailover_"+this.fk.boc,this.fk.Njd,+new Date-+this.fk.startTime,Object(B.a)(this,this.e5m,"createPodSessionSucceededCallback"),Object(B.a)(this,this.d5m,"createPodSessionFailedCallback"),
this.iF,this.Me.podSessionId,V);this.PJb.wEm(this.fk.bla,Object(B.a)(this,this.Zjo,"triggerFontsInstallationCallback"));this.Yb.wZa()}e5m(V){if(this.XNa){Od.a.ytd=[];this.fk.Nd.Za("NewPodsId",this.fk.bla);this.Me.podSessionId=this.fk.bla;this.fk.Nd.Za("CreatePodsWithRetryResult","true");this.fk.Nd.Za("CreatePodsRetryCount",this.fk.Njd.toString());this.fk.Nd.Za("CreatePodsDuration",(+new Date-+this.fk.startTime).toString());this.Mq.isPaused&&this.Mq.ZFb();try{this.Mq.sHh()}catch(Ea){xa.a.$(512497871,
801,15,"PodSeamlessfailoverManager CancelBlockedOperation failed. {0}",Ea)}if(this.na.aFe&&V&&bf.a.a2e in V&&!la.a.wb(V[bf.a.a2e])){const Ea=Boolean.parse(V[bf.a.a2e]);this.fk.Nd.Za("RCRestoredWhenCreatePodSession",V[bf.a.a2e]);Ea?(this.fk.Nd.zw("Result","Success"),this.aGe(!0)):(this.kak&&this.kak.I0m(),this.fk.Nd.Za("DocRefreshTriggered","true"),V={failedMachineId:null,isPlanedShutdown:!1,fromSeamlessFailoverManager:!0},V.podSessionId=this.Me.podSessionId,this.fk.XUf=!0,this.la.Ra(Rb.a.SKb,2,V))}else this.YCm()}}YCm(){this.jc.tj.Zq.aid(Object(B.a)(this,
this.Ikm,"onAfterReplication"));this.dko()}dko(){const V=()=>{this.fk.e0k=new Date;this.fk.Nd.Fm("InboundStartTime",this.fk.e0k);this.jc.tj.Zq.GO(null,null,null)};xa.a.$(512497870,801,50,"PodSeamlessFailoverManager::TriggerInbound - ForceInboundSlide:{0}; ActiveSlide.Sid:{1}; PodSessionID:{2};",!0,this.ya.Ia?this.ya.Ia.sid:0,this.fk.bla);4===this.fk.boc&&this.na.s2e&&this.ya.Ia?(this.xM.ymd&&this.xM.ymd.TNh(this.ya.Ia.fc),this.fk.Nd.Fm("ForceInboundSlideStartTime",new Date),this.pA.xWe(this.ya.Ia,
(Ea,Za)=>{xa.a.$(512497869,801,50,"PodSeamlessFailoverManager::TriggerInbound after ForceInboundSlide - SlideId:{0}; SlideStale:{1};",Ea,Za);this.XNa&&(this.fk.Nd.Fm("ForceInboundSlideEndTime",new Date),V())},!0,!1)):V()}d5m(V){if(!this.XNa)return!0;const Ea=+new Date-+this.fk.startTime;if(399===V)return xa.a.$(512497868,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, unsupported client - PodSessionID:{0}; Time:{1};",this.Me.podSessionId,Ea),this.le.nM(V,
null),this.aGe(!1,V,!1),!0;if(this.fk.U7i&&230===V)return xa.a.$(512497867,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, file url expired - PodSessionID:{0}; Time:{1};",this.Me.podSessionId,Ea),this.QZl("CreatePodSessionFailed_GetFileUrlFailed",V),!0;if(this.fk.Njd<this.na.p2e&&Ea<this.na.q2e){let Za;(Za=this.fk).Njd=Za.Njd+1;xa.a.$(512497866,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, continue retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",
this.Me.podSessionId,this.fk.Njd,Ea,V);this.ztm();return!0}xa.a.$(512497865,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, stopped retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",this.Me.podSessionId,this.fk.Njd,Ea,V);this.QZl("CreatePodSessionFailed",V);return!0}QZl(V,Ea){this.fk.Nd.Za("CreatePodsWithRetryResult","false");this.fk.Nd.Za("CreatePodsRetryCount",this.fk.Njd.toString());this.fk.Nd.Fm("CreatePodsWithRetryET",new Date);
this.fk.Nd.zw("Result",V);this.fk.Nd.Za("CreatePodsDuration",(+new Date-+this.fk.startTime).toString());this.aGe(!1,Ea)}Ikm(V,Ea){this.XNa&&(Ea.KOh?xa.a.$(512497864,801,50,"PodSeamlessFailoverManager::OnAfterReplication() - Current replication is outbound, replication result: {0}",Ea.Ohb):(this.fk.Nd.zw("InboundDuration",(+new Date-+this.fk.e0k).toString()),this.fk.Nd.zw("Result","Success"),this.aGe(!0)))}Hhb(V,Ea){this.XNa&&(this.fk.Nd.Za("WaitPodsRefreshedDuration",(+new Date-+this.fk.Qoo).toString()),
this.fk.Nd.Za("NewPodsId",Ea.bla),this.pT.G7c(Object(B.a)(this,this.Hhb,"onPodSessionRefreshed")),this.Mq.isPaused&&this.Mq.ZFb(),this.YCm())}}Object(k.a)(Uf,"PodSeamlessFailoverManager",null,[713]);class gf{constructor(V,Ea,Za){this.MIa=V;this.pb=Za}X0(){}Hjc(){}Oeb(V){V&&(Array.add(V,bf.a.Z2g),Array.add(V,bf.a.caa),Array.add(V,bf.a.mbc),Array.add(V,bf.a.Som),Array.add(V,bf.a.a2e))}Afa(V,Ea){Ea?((Ea=V[bf.a.mbc])&&Ea.toLowerCase()!==(this.pb.Dla?this.pb.Dla.toLowerCase():"")&&(xa.a.$(512497857,821,
15,"HandleResponseHeaders: PodInstance was updated. Id:{0};",Ea),this.pb.Dla=Ea),this.MIa?(V=V[bf.a.Z2g])?(this.MIa.kfb=V,xa.a.$(512497827,826,50,"HandleResponseHeaders: CCPInfo was updated, length: {0}",V.length)):xa.a.$(512497826,826,15,"HandleResponseHeaders: CCPInfo couldn't be found in response headers."):xa.a.$(512497856,826,15,"HandleResponseHeaders: ccpInfoOwner is null so skip the response headers.")):xa.a.$(512497858,826,15,"HandleResponseHeaders: abort since argument 'responseHeaders' is null.")}}
Object(k.a)(gf,"RehydrationHeaderHandler",null,[732]);class gg{constructor(V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd){this.$Da=null;this.gRh=!1;this.$5l=yd=>{if(yd.keyCode===F.a.cud||yd.keyCode===F.a.zJa||yd.keyCode===F.a.Wib||yd.keyCode>=F.a.fjc&&yd.keyCode<=F.a.ijb)return!1;this.HWk(2);return!0};this.Kf=V;this.ud=Ea;this.QF=Za;this.pB=ia;this.kf=Va;this.kj=Ab;this.Ehm=fd;this.Ea=gc;this.lr=Hc;this.UTh=hd}init(){this.ud&&(this.ud.fKd(Object(B.a)(this,this.oZh,"sessionExpired")),this.ud.Ueb(Object(B.a)(this,this.BTn,
"onRehydrateSession")))}oZh(){this.Qzm(!0);r.ULS.sendTraceTag(594616334,821,50,"Pausing health heartbeat");Eb.Health.instance.stopAllHealthTimers()}HWk(V){this.Qzm(!1);const Ea=l.AFrameworkApplication.Iz||!pb.a("Rehyrdation.StopRefreshIfWopiRefreshDisable");r.ULS.sendTraceTag(544789148,821,100,"Should refresh token: {0}",Ea);Ea&&this.UTh&&this.UTh.IHi(0);this.Ea.aua&&this.lr.juh(!1,V,223)}BTn(){r.ULS.sendTraceTag(594616333,821,50,"Resuming health heartbeat");Eb.Health.instance.resumeAllHealthTimers()}Qzm(V){this.gRh!==
V&&this.Kf&&(V?(this.$Da||(this.$Da=this.kj.kg(),this.$Da.id="sessiontimeoutoverlay",this.$Da.className="SessionTimeoutOverlay",this.$Da.tabIndex=-1,this.BXm(this.$Da),this.Kf.appendChild(this.$Da)),this.gRh=!0,this.Ehm(this.$Da)):(this.VXl(this.$Da),this.$Da&&this.$Da.parentNode&&this.$Da.parentNode.removeChild(this.$Da),this.$Da=null,this.gRh=!1))}BXm(V){V&&(this.kf.Ub(w.a.click,V,Object(B.a)(this,this.xlc,"handleClickEvent")),this.kf.Ub(w.a.doubleClick,V,Object(B.a)(this,this.xlc,"handleClickEvent")),
pb.a("FixRehydrationOnKeyPress")?this.pB.addHandler(V,w.a.oi,this.$5l):this.QF.Ub(w.a.oi,V,Object(B.a)(this,this.b6l,"handleKeyEvent")),$addHandler(window,"visibilitychange",Object(B.a)(this,this.ETa,"onVisibilityChange")))}VXl(V){V&&(this.kf.hc(w.a.click,V,Object(B.a)(this,this.xlc,"handleClickEvent")),this.kf.hc(w.a.doubleClick,V,Object(B.a)(this,this.xlc,"handleClickEvent")),pb.a("FixRehydrationOnKeyPress")?this.pB.removeHandler(V,w.a.oi,this.$5l):this.QF.hc(w.a.oi,V,Object(B.a)(this,this.b6l,
"handleKeyEvent")),$removeHandler(window,"visibilitychange",Object(B.a)(this,this.ETa,"onVisibilityChange")))}xlc(){this.HWk(1);return!0}b6l(V){if(V.Pb.ctrlKey||V.Pb.altKey||V.Pb.shiftKey||V.Pb.keyCode>=F.a.fjc&&V.Pb.keyCode<=F.a.ijb)return!1;this.HWk(2);return!0}ETa(){l.AFrameworkApplication.Iz&&!window.document.hidden&&this.UTh&&this.UTh.IHi(1)}dispose(){this.ud.xch(Object(B.a)(this,this.oZh,"sessionExpired"));this.$Da&&(this.VXl(this.$Da),this.$Da.parentNode&&this.$Da.parentNode.removeChild(this.$Da));
this.pB=this.QF=this.kf=null;this.gRh=!1;this.Ehm=null}}Object(k.a)(gg,"SessionRehydrationController",null,[]);class Ve{constructor(){this.Oa=null}oc(V){this.Oa=V||z.a.instance}dispose(){}}Object(k.a)(Ve,"TellMePackage",null,[4,5]);class hf{}hf.lH="TellMe";hf.contextMenu="ContextMenu";hf.unknown="Unknown";Object(k.a)(hf,"TellMeScenario",null,[]);class ef{}ef.appName="AppName";ef.JMa="CloseAllMenus";ef.commandId="CommandId";ef.context="Context";ef.culture="Culture";ef.message="Message";ef.errorMessage=
"ErrorMessage";ef.event="Event";ef.interactionId="CorrelationID";ef.WVn="ParentUiElement";ef.query="Input";ef.queryId="QueryID";ef.Wrm="QueryLength";ef.W3e="QueryIndex";ef.z8n="ResultsList";ef.suggestions="Suggestions";ef.scenario="Scenario";ef.sessionId="SessionID";ef.source="Source";ef.timeStamp="Time";ef.zDm="UiElement";ef.LXh="ReactUx";ef.value="Val";ef.statusCode="StatusCode";ef.F$n="Service";ef.isSuccess="IsSuccess";ef.fjo="TokenAcquired";ef.kAn="LatencyType";ef.groupName="GroupName";ef.J_b=
"GroupIndex";ef.groupType="GroupType";ef.v8n="ResultInfoList";ef.resultType="ResultType";ef.pol="SubResultType";ef.vxn="IsInputBlur";ef.wxn="IsInputFocus";ef.Fyn="IsShortCutUsed";ef.actionType="ActionType";ef.count="Count";ef.k9m="DwellTime";ef.Eam="IsZeroTerm";ef.dpo="WordsCount";ef.fnd="IsSearchUxEnabled";ef.izn="IsTellMeInHeaderEnabled";ef.module="Module";ef.resultIndex="ResultIndex";ef.x_i="DisplayIndex";ef.S9m="EnableList";ef.provider="Provider";ef.contentType="ContentType";ef.wyn="IsSelectionBased";
ef.qYm="BeginPerformanceMarker";ef.e$m="EndPerformanceMarker";ef.RWn="PerformanceMeasure";Object(k.a)(ef,"Columns",null,[]);class Ga{}Ga.click="Click";Ga.DYe="InteractionBegin";Ga.O8l="InteractionEnd";Ga.HVl="ControlActivated";Ga.query="Query";Ga.Vrm="QueryIndexRecorded";Ga.RUl="Clicks";Ga.SOl="ActionEvents";Ga.w0l="FilteredActionEvents";Ga.Dxm="SessionContext";Ga.latency="Latency";Ga.performance="Performance";Ga.gvm="RenderedResults";Ga.events="Events";Ga.q5m="CreateResultsMenu";Ga.CE="UpdateRibbonControls";
Ga.y8n="ResultsAggregation";Ga.L$="IssueQuery";Ga.N1m="CommandSuggestions";Ga.error="Error";Ga.b3j="LoadModelData";Ga.j7m="DepsResolveTime";Ga.UIn="ModelDataWaitTime";Ga.timedOut="TimedOut";Ga.bWm="AddinQueryCommandReady";Ga.Tdn="GetAddinEntitlements";Ga.Prm="ProviderMRUEvents";Ga.Q9m="EnableAddinSearchCommands";Object(k.a)(Ga,"EventNames",null,[]);class hb{constructor(V,Ea,Za=null,ia=null,Va=4,Ab=-99999,gc=0){this.additionalInfo="";this.hGh=-1;this.value=V;this.type=Ea;this.subType=Va;this.label=
this.Uta=Za;this.groupType=30;this.description=ia;this.score=Ab;this.count=gc}}Object(k.a)(hb,"ResultBinding",null,[]);class Hb{constructor(V=30,Ea=""){this.UQm=[];this.groupType=V;this.displayName=Ea}get results(){return this.UQm}hR(V){V.groupType=this.groupType;Array.add(this.results,V)}$Xk(V=1){if(this.results.length>=V)for(let Ea=0;Ea<V;Ea++)Array.removeAt(this.results,this.results.length-1)}}Object(k.a)(Hb,"SimpleResultGroup",null,[797]);class mc{constructor(V){this.attributes=null;this.query=
V;this.FA=[]}$M(V){this.FA.push(V)}Mtm(V){const Ea=[];for(const Za of this.FA)Za.groupType!==V&&Ea.push(Za);this.FA.length!==Ea.length&&(this.FA=Ea)}get rZe(){return!1}}Object(k.a)(mc,"SimpleResultsUpdatedEventArgs",null,[796]);var Nc=a(25);class db{constructor(){this.userId=this.email=this.displayName=null}}Object(k.a)(db,"InsertMentionParameters",null,[]);class Wb{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(k.a)(Wb,"InsightsParameters",null,[]);class Jc{constructor(V,
Ea,Za,ia,Va){this.Hji=V;this.Gji=Ea;this.$Rm=Za;this.mOm=ia;this.KKl=Va}get cFe(){return 4}cwa(V,Ea=null){Ea=Ea.sessionId+"|"+Ea.interactionId+"|"+V.Uta;if(this.KKl||this.mOm){let Za=this.KKl||la.a.BF(Object(Wa.a)("HelpTooltip"))===la.a.BF(V.Uta.trim());if(this.$Rm&&2<V.Uta.length){const ia=V.Uta;";"===ia.charAt(0)&&";"===ia.charAt(ia.length-1)&&ia.substring(1,ia.length-1)===Jc.CEj&&(Za=!0)}V=Za?Object(Wa.a)("HelpButtonTextNoPlaceholder"):String.format(Object(Wa.a)("TextWithQuotation"),V.Uta);return this.u1l(Ea,
la.a.We(V),Za)}return this.u1l(Ea,la.a.We(String.format(Object(Wa.a)("TextWithQuotation"),V.Uta)),!1)}u1l(V,Ea,Za){return Ua.a(Jc.CEj,Za?this.Gji:this.Hji,Ea,"OfficeAssistant_16x16x32","A0",la.a.We(V),Ea,null,null)}}Jc.CEj="bSearchHelp";Object(k.a)(Jc,"AssistanceMenuItemFactory",null,[812]);class jd{get cFe(){return 13}cwa(){return jd.YYm()}static YYm(){return Ua.b(jd.K0l,"798637440",la.a.We(Object(Wa.a)("LookupFirstRunExperienceTitle")),l.AFrameworkApplication.Ln,Ia.d("Info_32x32x32"),null,null,
la.a.We(Object(Wa.a)("LookupFirstRunExperienceTitle")),"Menu32",null,null,la.a.We(Object(Wa.a)("LookupFirstRunExperienceDescription")),null,null)}}jd.K0l="bTellMeFirstRun";Object(k.a)(jd,"FirstRunMenuItemFactory",null,[812]);class xd{constructor(V=null,Ea=null){this.sMl=V;this.KPm=Ea||Object(Wa.a)("LookupNoResultsDescription")}get cFe(){return 14}cwa(V){V=String.format(this.KPm,V.Uta);return this.qZm(V)}qZm(V){return Ua.b(xd.dkm,"798637440",la.a.We(Object(Wa.a)("LookupNoResultsTitle")),this.sMl?l.AFrameworkApplication.Ln:
null,this.sMl,null,null,la.a.We(Object(Wa.a)("LookupNoResultsTitle")),"Menu32",null,null,la.a.We(V),null,null)}}xd.dkm="lookupNoResults";Object(k.a)(xd,"NoCommandsFoundMenuItemFactory",null,[812]);class Ad{constructor(V,Ea){this.FontWeight=0;this.Text=null;this.FontWeight=V;this.Text=Ea}}Object(k.a)(Ad,"LabelFormatted",null,[]);var de=a(497),De=a(765),Le=a(160);class Xe{}Xe.L8l="bInsights";Object(k.a)(Xe,"InsightsMenuItemFactoryStatic",null,[]);class ie{static get Lvn(){return"Insights_16x16x32"}static get tbn(){return"Find_16x16x32"}static get bpm(){return"-Parameterized"}static get $kl(){return"Parameterized"}static get P1h(){return"bTryQuery"}static get uwl(){return"TellMeSuggestion_"}static get sDm(){return"bTryQueryAlternate"}static get Vql(){return"MenuTellMe"}static get JWn(){const V=
{},Ea=[];Array.add(Ea,{Term:{PeopleType:"Person"}});V.And=Ea;return V}static t6m(V){return V+ie.bpm}static getParameter(V){let Ea="",Za="";if(V)for(let ia=0;ia<V.k0l;++ia)"Type"===V.getFieldName(ia)?Ea=V.jb(ia):"Value"===V.getFieldName(ia)&&(Za=V.jb(ia));return new Nc.a(Ea,Za)}static AUi(V){V=Object.assign(new Wb,{neighborhood:V,mentionStart:0,mentionLength:V.length});return Ka.c(V)}static $Wl(V,Ea,Za){V=Object.assign(new db,{displayName:V,email:Ea,userId:Za});return Ka.c(V)}static nDc(V,Ea,Za=null){return Ka.c(ie.E4l(V,
Ea,Za,null))}static E4l(V,Ea,Za=null,ia=null){V=Object.assign(new De.a,{neighborhood:V,mentionStart:0,mentionLength:V?V.length:0});return Object.assign(new de.a,{selection:V,userIntent:ia,entryPoint:Ea,launchData:Za})}static x8n(V,Ea){return ie.nDc(V,ie.Jvm(Ea))}static Jvm(V){switch(V){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static nxn(){return!!l.AFrameworkApplication.ha&&
l.AFrameworkApplication.ha.getBooleanAppSetting("IsGoLocalEnvironment")}static wZe(){const V=l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.Ma("SovereignEnvironmentName"):null;return!!V&&0<V.length}static isEnterpriseUser(){const V=l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.Ma("HostAuthType"):null;return!!V&&"aad"===V.toLowerCase()||"external"===V&&ie.UPj()}static igl(V){return V.hio&&!ie.wZe()}static syn(){const V=l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.Ma("UiHostIntegrationType"):
"";return!!l.AFrameworkApplication.ha&&"UnifiedUiHostTeams"===V&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",!1)}static hgl(V){return V.cpc&&V.abn&&(V.ksh||V.jsh||V.knd)&&!ie.syn()&&ie.isEnterpriseUser()&&!ie.wZe()}static Utb(){return l.AFrameworkApplication.ha?l.AFrameworkApplication.Dib||l.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupEnableNativePane"):l.AFrameworkApplication.Dib}static vca(V){return!V||ie.dam(V.gm)}static dam(V){return!V||
!V.trim().length}static K1h(V){if(!V)return 0;const Ea=Math.pow(10,5);return Math.round(V*Ea)/Ea}static Yio(){var V=new Date;return V?new Date(V.getUTCFullYear(),V.getUTCMonth(),V.getUTCDate(),V.getUTCHours(),V.getUTCMinutes(),V.getUTCSeconds(),V.getUTCMilliseconds()):null}static vtj(V){return(ie.Yio().getTime()-(new Date(V)).getTime())/1E3}static jam(V){switch(V){case Jc.CEj:case jd.K0l:case Xe.L8l:case xd.dkm:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return V.startsWith(ie.P1h)||
V.startsWith(ie.uwl)||V.startsWith(ie.sDm)||V.startsWith("PeopleSuggestion")||V.startsWith("FileSuggestion")||V.startsWith("FindInDocumentSuggestion")||V.startsWith("NotesSuggestion")||V.startsWith("OnenoteNotesSuggestion")||V.startsWith("SmartLookupFromTellMe")||V.startsWith("GetHelpFromTellMe")||V.startsWith("GetHelpWithDescriptionFromTellMe")||V.startsWith("AddinSuggestion")||V.startsWith("OfficeScripts")?!0:!1}static Bij(V,Ea){const Za=[];Array.add(Za,new Ad(400,V));Array.add(Za,new Ad(200,Ea));
V={};V.parts=Za;return JSON.stringify(V)}static gld(V){const Ea=V.indexOf("<b0>"),Za=V.lastIndexOf("</b0>"),ia=[];Array.add(ia,new Ad(400,V.substring(0,Ea)));Array.add(ia,new Ad(600,V.substring(Ea+4,Za)));Array.add(ia,new Ad(400,V.substring(Za+5,V.length)));V={};V.parts=ia;return JSON.stringify(V)}static b5l(V){const Ea=ie.vtj(V);60>Ea?V=Object(Wa.a)("TimeSince_SecsAgo"):3600>Ea?(V=Math.floor(Ea/60),V=String.format(Object(Wa.a)("TimeSince_MinsAgo"),V.toString())):86400>Ea?(V=Math.floor(Ea/3600),V=
String.format(Object(Wa.a)("TimeSince_HoursAgo"),V.toString())):172800>Ea?V=Object(Wa.a)("TimeSince_Yesterday"):(V=new Date(V),V=String.format(Object(Wa.a)("TimeSince_Date"),V.localeFormat("MMMM dd, yyyy")));return V}static gfn(V){const Ea=Array(V.length);for(let Za=0;Za<V.length;Za++)Ea[Za]=V[Za].commandId;return Ea}static UPj(){if("Dev Box"===l.AFrameworkApplication.ha.Ma("StatusBarEnvironmentNameToUse"))return!0;let V=l.AFrameworkApplication.ha.Ma("UserPrincipalName");V=Le.b(V)?"":la.a.ph(V);const Ea=
l.AFrameworkApplication.ha.Zt("TellMeIntEnabledForFeatureCrew")?l.AFrameworkApplication.ha.Fz("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(Ea,V)&&"inner"===l.AFrameworkApplication.ha.Ma("Microsoft365Ring")}static Mhn(V){switch(ie.yLh(V)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static Jln(V){V=
ie.yLh(V);switch(V){case "PowerPoint":return"pptx";case "Word":return"docx";case "Excel":return"xlsx";default:return V}}static yLh(V){switch(V.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";
case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static $y(){return Vd.a.qU&&!Vd.a.Ek}static Bfn(V){if("word"===V.application.toLowerCase())return"ChatPane";if("powerpoint"===V.application.toLowerCase())return"ChatPPTPane";if("excel"===V.application.toLowerCase())return"Copilot"}static ffn(V){if("excel"===
V.application.toLowerCase())return"ShareMenu"}}ie.s1h=9E5;Object(k.a)(ie,"TellMeUtils",null,[]);var If=a(498),qf=a(1707),lf=a(36);class qe{constructor(){this.iFh=null;this.Oxa=[];this.tSe=!0;this.dEh=null;this.BOl=!1;this.MU=null;this.Qfi=[];this.Z8h=[];this.Y8h=[];this.Bni=[];this.UEh=this.WPb=null;this.Rfi=[];this.wci=this.$li=this.ie=null;this.rqf=-1;this.ECh=this.Dbi=null}static get instance(){return qe.Qa||(qe.Qa=new qe)}Aej(){return this.Qfi}jLh(){return this.Z8h}hfj(){return this.Y8h}buj(){return this.Bni}klj(){return this.WPb}get hoh(){return this.UEh}set hoh(V){this.UEh=
V}Bej(){return this.Rfi}vxh(V,Ea="",Za=null){V?this.ECh=new qf.a(lf.a.Co()):Ea&&Za&&this.ECh.add(Ea,Za)}tXe(){return qe.instance.Gw?qe.instance.Gw.sZa.interactionId:null}get MAc(){return this.ECh}set MAc(V){this.ECh=V}get goa(){return qe.instance.$li}set goa(V){qe.instance.$li=V}Qsj(){return this.$li}get actions(){return qe.instance.Oxa}set actions(V){qe.instance.Oxa=V}ufa(){return this.ie}lq(){return this.wci}CIh(){return this.rqf}Xij(){return this.Dbi}get vy(){return qe.instance.ie}set vy(V){qe.instance.ie=
V}set P5h(V){qe.instance.iFh=V}get GXe(){return qe.instance.Dbi}set GXe(V){qe.instance.Dbi=V}get Gw(){return qe.instance.wci}set Gw(V){qe.instance.wci=V}get ICb(){return qe.instance.rqf}set ICb(V){qe.instance.rqf=V}static get Unknown(){return qe.unknown}get lNf(){return this.MU?this.MU.contentType:qe.unknown}CE(V){const Ea=window.performance.now();this.iFh&&!Le.b(V)&&(this.iFh(V),qe.instance.Gw.Zfa(Ga.CE,window.performance.now()-Ea))}get JVg(){return this.tSe}set JVg(V){this.tSe=V}get QAh(){return this.dEh}set QAh(V){this.dEh=
V}get cfd(){return this.BOl}set cfd(V){this.BOl=V}get o1e(){return this.Qfi}set o1e(V){this.Qfi=V}get PUe(){return this.Z8h}set PUe(V){this.Z8h=V}get OUe(){return this.Y8h}set OUe(V){this.Y8h=V}get i8e(){return this.Bni}set i8e(V){this.Bni=V}get Chb(){return this.WPb}set Chb(V){this.WPb=V}get RJe(){return this.UEh}set RJe(V){this.UEh=V}get p1e(){return this.Rfi}set p1e(V){this.Rfi=V}}qe.Qa=null;qe.unknown="Unknown";Object(k.a)(qe,"TellMeActorConstants",null,[]);class Ne{constructor(V){this.ie=V}zfa(){return"ActionAI"}uwa(){return 0===
this.ie.kN?0:1===this.ie.kN?1:2}L$(V,Ea,Za=!1,ia,Va=null){ia=new mc(V);if(!Va||Array.contains(Va,24))if(this.sdo()||!ie.vca(V)){Va=new Hb(24);var Ab=ie.vca(V);Za&&(Za=null,ie.Utb()&&(Za=ie.nDc(Ab?"":V.gm,1,Object.assign(new If.a,{landingTab:"ActionAI"}))),this.ie.LIb?Za&&qe.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",Za)):(V=[],Za&&V.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",Za)),appChrome.api.dispatch(V)));Va.hR(new hb("ActionAIFromTellMe",
25,null,null,1));ia.$M(Va)}Ea.zF(ia)}sdo(){return ie.Utb()&&this.ie.eOh}}Object(k.a)(Ne,"ActionAIResultsProvider",null,[749]);class pe{}pe.jjm=0;pe.J7g=10;Object(k.a)(pe,"AppsForOfficeStoreType",null,[]);class Wf{constructor(){this.gli=0}cOk(V,Ea){this.gli=window.performance.now();this.Zib(()=>{const Za=window.performance.now(),ia={},Va=l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",!0);Ea.WQl&&(ia.callback=Ab=>{V(Ab,pe.jjm,Za)},
Va&&(ia.storeType=pe.jjm),l.AFrameworkApplication.ub.Ra(ta.a.pZa,2,ia));Ea.XQl&&(ia.callback=Ab=>{V(Ab,pe.J7g,Za)},Va?ia.storeType=pe.J7g:l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?ia.storeType=10:ia.storeType=pe.J7g,l.AFrameworkApplication.ub.Ra(ta.a.pZa,2,ia))},0,()=>{if(qe.instance.lq())qe.instance.lq().onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.gli)+
" ms")})}Zib(V,Ea=0,Za=null){2!==l.AFrameworkApplication.ub.Eb(ta.a.pZa,1)?(qe.instance.lq()&&qe.instance.lq().Zfa(Ga.bWm,window.performance.now()-this.gli),V()):Ea<Wf.AIn?l.AFrameworkApplication.Zd.Rb(new ob.a(2,1,Wf.Poo,()=>{this.Zib(V,Ea+1,Za)})):Za&&Za()}static get instance(){Wf.Qa||(Wf.Qa=new Wf);return Wf.Qa}}Wf.Qa=null;Wf.AIn=20;Wf.Poo=500;Object(k.a)(Wf,"AddinEntitlementsQuery",null,[]);class ye{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=
this.assetId=this.appVersion=null;this.height=this.width=0;this.r0j=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(k.a)(ye,"AddinInfo",null,[]);class Xf{constructor(V){this.Kii=[];this.ie=V;this.URn=(Ea,Za,ia)=>{if(Ea){const Va=Ea.errorCode;if(qe.instance.lq()){const Ab={};Ab.StoreType=Za;Ab.ErrorCode=Va;Ab.AddinCount=Ea.value?Ea.value.length:0;qe.instance.lq().Zfa(Ga.Tdn,window.performance.now()-ia,Ab)}if(0===Va&&Ea.value){Xf.iKd=Xf.iKd||{};Ea=Ea.value;for(const Ab of Ea)Ea=
new ye,Ea.displayName=Ab[0],Ea.id=Ab[1],Ea.description=Ab[2],Ea.targetType=Ab[3],Ea.appVersion=4<Ab.length?Ab[4]:"",Ea.assetId=5<Ab.length?Ab[5]:"",Ea.assetStoreId=6<Ab.length?Ab[6]:"",Ea.width=7<Ab.length?Ab[7]:0,Ea.height=8<Ab.length?Ab[8]:0,Ea.iconUrl=9<Ab.length?Ab[9]:"",Ea.providerName=10<Ab.length?Ab[10]:"",Ea.storeId=11<Ab.length?Ab[11]:"",Ea.storeType=12<Ab.length?Ab[12]:"",Ea.r0j=this.ein(Ea),Xf.iKd[Ea.id]=Ea,0<Ea.iconUrl.length&&(Za="AddinIcon_"+Ea.id,l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",
!0)?this.mtm(Za,Ea.iconUrl):appChrome.addInApi.registerAddinIcon(Za,Ea.iconUrl))}}};Wf.instance.cOk(this.URn,this.ie)}zfa(){return"Add-ins"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:2}L$(V,Ea,Za,ia,Va=null){Za=new mc(V);Va&&!Array.contains(Va,27)||ie.vca(V)||(Va=new Hb(27),Va.displayName=Object(Wa.a)("TellMeAddinProviderTitle"),this.Zhn(V.gm,Va),Za.$M(Va));Ea.zF(Za)}Zhn(V,Ea){if((V=this.I9n(V))&&0<V.length){let Za=0;V.forEach(ia=>{if(!(3<++Za)){var Va="AddinSuggestion"+Za,Ab={};if(l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",
!0)){var gc="AddinIcon_"+ia.id;0>Array.indexOf(this.Kii,gc)&&0<ia.iconUrl.length&&this.mtm(gc,ia.iconUrl);Ab["default"]=0<=Array.indexOf(this.Kii,gc)?gc:"AppForOfficeLogo_20"}else Ab["default"]=0<ia.iconUrl.length?"AddinIcon_"+ia.id:"AppForOfficeLogo_20";gc=[];gc.push(appChrome.actions.setControlLabel(Va,ia.displayName));gc.push(appChrome.actions.setControlIconSet(Va,Ab));gc.push(appChrome.actions.setCompoundButtonCommandValueId(Va,ia.id));gc.push(appChrome.actions.updateCompoundButtonDescription(Va,
ia.description));l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(Ab=window.performance.now(),gc.push(appChrome.actions.updateControlEnabledDisabledState(Va,!1)),qe.instance.lq()&&qe.instance.lq().Zfa(Ga.Q9m,window.performance.now()-Ab));appChrome.api.dispatch(gc);Va=new hb(Va,27,void 0,void 0,1);Va.additionalInfo=Telemetry.PrivacyRules.GetPrivacyCompliantId(ia.id,ia.storeType,ia.assetId,null,null,ia.storeId);Ea.hR(Va)}})}}mtm(V,
Ea){ic.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(V,Ea),Array.add(this.Kii,V))}I9n(V){if(!Xf.iKd)return null;const Ea=[],Za=Xf.iKd;for(const Va in Za){var ia=Za[Va];ia&&Xf.fIn(V,ia)&&Array.add(Ea,ia)}return Ea}ein(V){return Xf.wgo(V.displayName)}static fIn(V,Ea){if(!Ea.r0j)return!1;for(const Za of V.split(" ")){V=!1;for(const ia of Ea.r0j)if(ia.toLowerCase().startsWith(Za.toLowerCase())){V=!0;break}if(!V)return!1}return!0}static wgo(V){const Ea=[];for(const Za of V.split(" ")){V=
0;for(let ia=0;ia<Za.length;ia++){const Va=Za.charAt(ia);Va.toString().toUpperCase()===Va.toString()&&ia>V&&(Array.add(Ea,Za.substring(V,ia)),V=ia)}Array.add(Ea,Za.substring(V,Za.length));V&&Array.add(Ea,Za.substring(0,Za.length))}return Ea}}Xf.iKd=null;Object(k.a)(Xf,"AddinResultsProvider",null,[749]);class uh{constructor(V,Ea){this.f7h=V;this.$n=Ea}zF(V){this.f7h.tbo(this.$n,V)}}Object(k.a)(uh,"AggregatorResultsProviderCallback",null,[962]);class fg{constructor(V){this.NGb=null;this.ie=V;this.ie.nLd&&
(this.NGb=null)}zfa(){return"AppsForOffice"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:2}L$(V,Ea,Za,ia,Va=null){Za=new mc(V);if(!Va||Array.contains(Va,1))Va=new Hb(1),this.NGb.rvo(Va,V.gm),Za.$M(Va);Ea.zF(Za)}}Object(k.a)(fg,"AppsForOfficeRecommendationResultsProvider",null,[749]);class pg{constructor(V){this.ie=V}zfa(){return"Assistance"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:this.ie.O1g?3:2}L$(V,Ea,Za=!1,ia,Va=null){ia=new mc(V);if((!Va||Array.contains(Va,8))&&!ie.vca(V)){Va=new Hb(8);
if(Za){Za=la.a.BF(Object(Wa.a)("HelpTooltip"))===la.a.BF(V.gm.trim())?Object(Wa.a)("HelpButtonTextNoPlaceholder"):String.format(Object(Wa.a)("TextWithQuotation"),V.gm);const Ab=[];this.ie.jnd&&(this.ie.ril||Ab.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),Za=this.y3l(V.gm));const gc="||"+V.gm;Ab.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",Za));Ab.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",gc));appChrome.api.dispatch(Ab);
V=new hb("GetHelpFromTellMe",4,V.gm,null,1)}else V=new hb("bSearchHelp",4,V.gm,null,1);Va.hR(V);Va.displayName=Object(Wa.a)("HelpButtonTitle");ia.$M(Va)}Ea.zF(ia)}gmd(V,Ea=null){const Za=new Hb(8),ia=la.a.BF(Object(Wa.a)("HelpTooltip"))===la.a.BF(V.gm.trim())?Object(Wa.a)("HelpButtonTextNoPlaceholder"):String.format(Object(Wa.a)("TextWithQuotation"),V.gm);for(let Ab=0;Ab<Ea.length&&2>Ab;Ab++){var Va=[];let gc="GetHelpWithDescriptionFromTellMe"+(Ab+1).toString(),Hc=4;if(this.ie.b6e)Va.push(appChrome.actions.setControlLabel(gc,
ia)),Va.push(appChrome.actions.setCompoundButtonCommandValueId(gc,V.gm)),Va.push(appChrome.actions.updateCompoundButtonDescription(gc,this.Ymn(Ea.length)));else if(this.ie.tmh){let fd=this.i5l(Ea[Ab]);gc="GetHelpFromTellMe"+(Ab+1).toString();this.ie.jnd&&(fd=this.y3l(fd));Hc=9;Va.push(appChrome.actions.setControlLabel(gc,fd));Va.push(appChrome.actions.setButtonCommandValueId(gc,this.Wmn(Ea[Ab])))}appChrome.api.dispatch(Va);Va=new hb(gc,Hc,null,null,0);Va.label=this.i5l(Ea[Ab]);Va.description=this.Vmn(Ea[Ab]);
Za.hR(Va);if(this.ie.tmh)break}Za.displayName=Object(Wa.a)("HelpButtonTitle");return Za}Ymn(V){return 1===V?String.format(Object(Wa.a)("SearchResultText"),V):String.format(Object(Wa.a)("SearchResultsText"),V)}y3l(V){return this.ie.FYj?ie.Bij(V,Object(Wa.a)("HelpScopedButtonText")):V+Object(Wa.a)("HelpScopedButtonText")}i5l(V){return V.name?V.name:""}Vmn(V){return V.description?V.description:""}Wmn(V){return V.id?"AssetID="+V.id:""}}Object(k.a)(pg,"AssistanceResultsProvider",null,[749]);var Kf=a(148),
hh=a(409);class zh{constructor(V,Ea){this.$b=V;this.lEn=Ea}isMatch(V,Ea){if(!Object(bc.a)(1077,V))throw Error.argument("objToTest","Expected feature bundle");let Za;return({value:Za}=V.zE(this.$b.FHb)).returnValue?this.$b.KDl.isMatch(Za,Ea):this.lEn}}Object(k.a)(zh,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1089]);class cg{constructor(V,Ea){this.$b=V;this.hck=Ea}isMatch(V){if(!Object(bc.a)(1077,V))throw Error.argument("objToTest","Expected feature bundle");return!!(this.hck^V.zE(this.$b.FHb).returnValue)}}
Object(k.a)(cg,"AnnotatedWithAnnotationFilter",null,[1089]);class le{constructor(V){this.$b=V}isMatch(V,Ea){if(!Object(bc.a)(1080,V))throw Error.argument("objToTest","Expected struct value");return this.$b.KDl.isMatch(V.yld(this.$b.Ykc),Ea)}}Object(k.a)(le,"FieldValueMatchesStructFilter",null,[1089]);class ke{constructor(V,Ea){V&&(this.Ykc=V.ka(0),this.KDl=Ea.Pqb(V.ka(1)))}}Object(k.a)(ke,"FieldValueMatchesStructFilterInit",null,[]);class ag{constructor(V){this.hck=V}isMatch(V){if(!Object(bc.a)(1077,
V))throw Error.argument("objToTest","Expected feature bundle");return!!(this.hck^V.UCj)}}Object(k.a)(ag,"HasAnnotationsAnnotationFilter",null,[1089]);class Ef{constructor(V,Ea){this.$b=V;this.xt=Ea}isMatch(V,Ea){if(!Object(bc.a)(1079,V))throw Error.argument("objToTest","Expected list value");switch(this.xt){case 0:for(const Za of V.items)if(this.$b.filter.isMatch(Za,Ea))return!0;return!1;case 1:for(const Za of V.items)if(!this.$b.filter.isMatch(Za,Ea))return!1;return!0;default:throw Error.notImplemented();
}}}Object(k.a)(Ef,"ItemTestListFilter",null,[1089]);class lg{constructor(V){this.$b=V}isMatch(V,Ea){if(!Object(bc.a)(1079,V))throw Error.argument("objToTest","Expected list value");return this.$b.filter.isMatch(V.items.length,Ea)}}Object(k.a)(lg,"LengthMatchesListFilter",null,[1089]);class Hf{constructor(V,Ea){this.$b=V;this.xt=Ea}isMatch(V,Ea,Za=null){let ia=0===this.xt;for(const Va of this.$b.dUl)if((ia=Va.isMatch(V,Ea,Za))?1===this.xt:0===this.xt)return ia;2===this.xt&&(ia=!ia);return ia}}Object(k.a)(Hf,
"NonterminalFilter",null,[1089]);class Lg{constructor(V,Ea){if(V){var Za=V.ka(0);this.dUl=Array(Za);for(let ia=0;ia<Za;++ia)this.dUl[ia]=Ea.Pqb(V.ka(1+ia))}}}Object(k.a)(Lg,"NonterminalFilterInit",null,[]);class Vg{constructor(V,Ea){this.$b=V;this.xt=Ea}isMatch(V,Ea){if("number"!==typeof V)throw Error.argument("objToTest","Expected number value");let Za=this.$b.number;if(this.$b.query){Ea=this.$b.query.NJ(null,Ea);if("number"!==typeof Ea)throw Error.invalidOperation("Query did not return number");
Za+=Ea}switch(this.xt){case 0:return V===Za;case 1:return V<Za;case 2:return V<=Za;case 3:return V>Za;case 4:return V>=Za;default:throw Error.notImplemented();}}}Object(k.a)(Vg,"NumberFilter",null,[1089]);class uf{constructor(V,Ea){V&&(this.number=V.ka(0),this.query=V.ka(1)?Ea.tfa(V.ka(1)):null)}}Object(k.a)(uf,"NumberFilterInit",null,[]);class dg{constructor(V,Ea,Za){this.xLh=this.chn;this.aSa=V;this.uem=Ea;this.tem=Za}qHi(V){this.uem=V}chn(V){if(!V)throw Error.argument("name","Invalid named feature bundle reference");
const Ea=V.substr(1);return 1===V.charCodeAt(0)&&Ea===this.aSa?this.uem:this.tem?this.tem.xLh(V):null}}Object(k.a)(dg,"SimpleNamedFeatureBundleResolver",null,[1100]);class Fg{constructor(V){this.$b=V}isMatch(V,Ea){if(!Object(bc.a)(1077,V))throw Error.argument("objToTest","Expected feature bundle");V=this.$b.query.NJ(null,new dg(this.$b.x2h,V,Ea));if("boolean"!==typeof V)throw Error.invalidOperation("Query did not return bool");return V}}Object(k.a)(Fg,"PredicateAnnotationFilter",null,[1089]);class Gh{constructor(V,
Ea){V&&(this.x2h=Ea.j1(V.ka(0)),this.query=Ea.tfa(V.ka(1)))}}Object(k.a)(Gh,"PredicateAnnotationFilterInit",null,[]);class Vh{constructor(V){this.$b=V}isMatch(V,Ea){if("boolean"!==typeof V)throw Error.argument("objToTest","Expected bool value");Ea=this.$b.query.NJ(null,Ea);if("boolean"!==typeof Ea)throw Error.invalidOperation("Query did not return bool");return V===Ea}}Object(k.a)(Vh,"QueryBooleanFilter",null,[1089]);class Qg{constructor(V,Ea){this.$b=V;this.xt=Ea}isMatch(V,Ea){if("number"!==typeof V)throw Error.argument("objToTest",
"Expected integer");Ea=this.$b.query.NJ(null,Ea);if("number"!==typeof Ea)throw Error.invalidOperation("Query did not return an enum value");switch(this.xt){case 0:return V===Ea;case 1:return 0!==(V&Ea);case 2:return V===(V&Ea);case 3:return Ea===(V&Ea);default:throw Error.notImplemented();}}}Object(k.a)(Qg,"QueryEnumFilter",null,[1089]);class mh{constructor(V,Ea){V&&(this.IOh=1===V.ka(0),this.query=Ea.tfa(V.ka(1)))}}Object(k.a)(mh,"QueryEnumFilterInit",null,[]);class Mf{constructor(V,Ea){this.$b=
V;this.xt=Ea}isMatch(V,Ea){if(!Object(bc.a)(1079,V))throw Error.argument("objToTest","Expected list value");Ea=this.$b.query.NJ(null,Ea);if(!Object(bc.a)(1079,Ea))throw Error.invalidOperation("Query did not return list value");if(V.fTa!==Ea.fTa)return!1;switch(this.xt){case 0:return Kf.Annotations.eud(Kf.Annotations.xin(V.fTa),V,Ea);case 1:for(const Za of V.items)for(const ia of Ea.items)if(Kf.Annotations.eud(V.fTa,Za,ia))return!0;return!1;case 2:for(const Za of V.items)for(const ia of Ea.items)if(!Kf.Annotations.eud(V.fTa,
Za,ia))return!1;return!0;case 3:for(const Za of Ea.items)for(const ia of V.items)if(!Kf.Annotations.eud(V.fTa,Za,ia))return!1;return!0;default:throw Error.notImplemented();}}}Object(k.a)(Mf,"QueryListFilter",null,[1089]);class Gg{constructor(V,Ea){this.$b=V;this.xt=Ea}isMatch(V,Ea){if("string"!==typeof V)throw Error.argument("objToTest","Expected string");Ea=this.$b.query.NJ(null,Ea);if("string"!==typeof Ea)throw Error.invalidOperation("Query did not return string");this.$b.wOj&&(V=V.toUpperCase(),
Ea=Ea.toUpperCase());switch(this.xt){case 0:return V===Ea;case 1:return 0<=V.indexOf(Ea);case 2:return V.startsWith(Ea);case 3:return V.endsWith(Ea);case 4:return 0<=Ea.indexOf(V);case 5:return Ea.startsWith(V);case 6:return Ea.endsWith(V);default:throw Error.notImplemented();}}}Object(k.a)(Gg,"QueryStringFilter",null,[1089]);class dh{constructor(V,Ea){V&&(this.query=Ea.tfa(V.ka(0)),this.wOj=1===V.ka(1))}}Object(k.a)(dh,"QueryStringFilterInit",null,[]);class Jh{constructor(V){this.$b=V}isMatch(V,
Ea){if(!Object(bc.a)(1080,V))throw Error.argument("objToTest","Expected struct value");Ea=this.$b.query.NJ(null,Ea);if(!Object(bc.a)(1080,Ea))throw Error.invalidOperation("Query did not return struct value");return V.isEqual(V)}}Object(k.a)(Jh,"QueryStructFilter",null,[1089]);class Wg{constructor(V){this.$b=V}isMatch(V,Ea){V=this.$b.query.NJ(null,Ea);if("boolean"!==typeof V)throw Error.invalidOperation("Query did not return bool");return V}}Object(k.a)(Wg,"QueryWhereConstraintFilter",null,[1089]);
class Ra{constructor(V){this.$b=V}isMatch(V){if("string"!==typeof V)throw Error.argument("objToTest","Expected string");return this.$b.regex.test(V)}}Object(k.a)(Ra,"RegexStringFilter",null,[1089]);class vc{constructor(V,Ea){V&&(this.regex=Ea.c4l(V.ka(0)))}}Object(k.a)(vc,"RegexStringFilterInit",null,[]);class Uc{constructor(V,Ea){V&&(this.filter=Ea.Pqb(V.ka(0)))}}Object(k.a)(Uc,"SingleFilterFilterInit",null,[]);class id{constructor(V,Ea){V&&(this.query=Ea.tfa(V.ka(0)))}}Object(k.a)(id,"SingleQueryFilterInit",
null,[]);class Jd{constructor(V){this.$b=V}isMatch(V){if("boolean"!==typeof V)throw Error.argument("objToTest","Expected bool value");return V===this.$b.value}}Object(k.a)(Jd,"StoredValueBooleanFilter",null,[1089]);class $d{constructor(V){V&&(this.value=1===V.ka(0))}}Object(k.a)($d,"StoredValueBooleanFilterInit",null,[]);class re{constructor(V,Ea){this.$b=V;this.xt=Ea}isMatch(V){if("number"!==typeof V)throw Error.argument("objToTest","Expected integer");switch(this.xt){case 0:return this.$b.IOh?this.$b.value?
!!(V&this.$b.value):!V:V===this.$b.value;case 1:return this.$b.IOh?(V&this.$b.value)===this.$b.value:32>V&&(1<<V&this.$b.value)===this.$b.value;case 2:return this.$b.IOh?!!(V&this.$b.value):32>V&&!!(1<<V&this.$b.value);default:throw Error.notImplemented();}}}Object(k.a)(re,"StoredValueEnumFilter",null,[1089]);class Re{constructor(V){V&&(this.IOh=1===V.ka(0),this.value=V.ka(1))}}Object(k.a)(Re,"StoredValueEnumFilterInit",null,[]);class Be{constructor(){this.VVn=null;this.tDi=this.$3d=0}}Object(k.a)(Be,
"WHEREConstraintData",null,[]);class rf{constructor(V){this.$b=V}isMatch(V,Ea){if(!Object(bc.a)(Be,V))throw Error.argument("objToTest","Expected WHERE constraint data");let Za=-1,ia=-1;const Va=V.VVn;switch(this.$b.OGi){case 4:Za=Va.UWf;ia=Va.vml;break;case 5:Za=V.$3d;ia=Va.UWf-V.$3d;break;case 6:Za=Va.UWf+Va.vml;ia=V.$3d+V.tDi-Za;break;case 1:case 2:case 3:let Ab=!1;for(let gc=Va.Dvo;gc;gc=gc.next)if(this.$b.Ono===gc.name){Ab=!0;1===this.$b.OGi?(Za=gc.UWf,ia=gc.vml):2===this.$b.OGi?(Za=V.$3d,ia=
gc.UWf-V.$3d):(Za=gc.UWf+gc.vml,ia=V.$3d+V.tDi-Za);break}if(!Ab)return!1;break;case 7:Za=V.$3d;ia=V.tDi;break;default:throw Error.notImplemented();}return null!==this.$b.xgo.Nwo(Va.ezo,Za,ia,Za,!0,2,Ea)}}Object(k.a)(rf,"SubSreWhereConstraintFilter",null,[1089]);class qa{constructor(V,Ea){if(V){var Za=Ea.j1(V.ka(0));this.OGi=Za.charCodeAt(0);this.Ono=Za.substr(1);this.xgo=Ea.Lkn(V.ka(1))}}}Object(k.a)(qa,"SubSreWhereConstraintFilterInit",null,[]);class Fb{constructor(V){this.$b=V}isMatch(V,Ea,Za=null){if(!Object(bc.a)(1077,
V))throw Error.argument("objToTest","Expected feature bundle");if(null==Za)throw Error.argumentNull("parentTextForSpan");if(this.$b.wRl&&!this.$b.wRl.isMatch(V,Ea))return!1;if(this.$b.lrl){let ia;if(({value:ia}=V.zE(this.$b.rgo)).returnValue){if(!this.$b.lrl.isMatch(ia,Ea))return!1}else{let Va,Ab;if(!({value:Va}=V.zE(this.$b.VAm)).returnValue||!({value:Ab}=V.zE(this.$b.UAm)).returnValue||0>Va||0>Ab||Va+Ab>Za.length||!this.$b.lrl.isMatch(Za.substr(Va,Ab),Ea))return!1}}if(this.$b.tBm){let ia;if(!({value:ia}=
V.zE(this.$b.VAm)).returnValue||!this.$b.tBm.isMatch(ia,Ea))return!1}if(this.$b.bbm){let ia;if(!({value:ia}=V.zE(this.$b.UAm)).returnValue||!this.$b.bbm.isMatch(ia,Ea))return!1}return!0}}Object(k.a)(Fb,"TextSpanFilter",null,[1089]);class oa{constructor(V,Ea){V&&(this.annotations=Ea.annotations,this.VAm=V.ka(0),this.UAm=V.ka(1),this.rgo=V.ka(2),this.lrl=V.ka(3)?Ea.Pqb(V.ka(3)):null,this.wRl=V.ka(4)?Ea.Pqb(V.ka(4)):null,this.tBm=V.ka(5)?Ea.Pqb(V.ka(5)):null,this.bbm=V.ka(6)?Ea.Pqb(V.ka(6)):null)}}Object(k.a)(oa,
"TextSpanFilterInit",null,[]);class eb{constructor(V,Ea){V&&(this.annotations=Ea.annotations,this.FHb=V.ka(0),this.KDl=V.ka(1)?Ea.Pqb(V.ka(1)):null)}}Object(k.a)(eb,"ValueFilterAnnotationFilterInit",null,[]);var Bb=a(577);class $b{Pqb(V,Ea){const Za=V.ka(0),ia=new Bb.a;ia.Ykd(V,1,V.count-1);switch(Za){case 1:return new Hf(new Lg(ia,Ea),0);case 2:return new Hf(new Lg(ia,Ea),1);case 3:return new Hf(new Lg(ia,Ea),2);case 101:return new Ra(new vc(ia,Ea));case 103:return new Gg(new dh(ia,Ea),0);case 104:return new Gg(new dh(ia,
Ea),1);case 105:return new Gg(new dh(ia,Ea),2);case 106:return new Gg(new dh(ia,Ea),3);case 107:return new Gg(new dh(ia,Ea),4);case 108:return new Gg(new dh(ia,Ea),5);case 109:return new Gg(new dh(ia,Ea),6);case 201:return new Jd(new $d(ia));case 202:return new Vh(new id(ia,Ea));case 301:return new Vg(new uf(ia,Ea),0);case 302:return new Vg(new uf(ia,Ea),1);case 303:return new Vg(new uf(ia,Ea),2);case 304:return new Vg(new uf(ia,Ea),3);case 305:return new Vg(new uf(ia,Ea),4);case 401:return new re(new Re(ia),
0);case 402:return new re(new Re(ia),1);case 403:return new re(new Re(ia),2);case 404:return new Qg(new mh(ia,Ea),0);case 405:return new Qg(new mh(ia,Ea),1);case 406:return new Qg(new mh(ia,Ea),2);case 407:return new Qg(new mh(ia,Ea),3);case 501:return new le(new ke(ia,Ea));case 502:return new Jh(new id(ia,Ea));case 601:return new Ef(new Uc(ia,Ea),0);case 602:return new Ef(new Uc(ia,Ea),1);case 603:return new lg(new Uc(ia,Ea));case 604:return new Mf(new id(ia,Ea),0);case 605:return new Mf(new id(ia,
Ea),1);case 606:return new Mf(new id(ia,Ea),2);case 607:return new Mf(new id(ia,Ea),3);case 701:return new ag(!1);case 702:return new ag(!0);case 703:return new cg(new eb(ia,Ea),!1);case 704:return new cg(new eb(ia,Ea),!0);case 705:return new zh(new eb(ia,Ea),!1);case 706:return new zh(new eb(ia,Ea),!0);case 707:return new Fg(new Gh(ia,Ea));case 901:return new Fb(new oa(ia,Ea));case 1002:return new Wg(new id(ia,Ea));case 1001:return new rf(new qa(ia,Ea));default:throw Error.argument("initData");}}}
Object(k.a)($b,"FilterFactory",null,[1076]);var tc=a(251);class xc{constructor(V){this.$b=V}get r3(){return this.$b.r3}get GUa(){return this.$b.GUa}get J0h(){return this.$b.J0h}get pOh(){return this.$b.pOh}load(V,Ea){return this.NJ(V,V?new dg("root",V,Ea):Ea)}store(V,Ea,Za){this.O6e(V,Ea,V?new dg("root",V,Za):Za,null)}NJ(V,Ea){if(!this.pOh&&!this.$b.annotations.hZe(this.r3,V))throw Error.argument("input","Input value not of expected type");let Za=this.$b.N0l;for(;Za;)V=Za.load(V,Ea),Za=Za.next;return V}O6e(V,
Ea,Za,ia){if(!this.J0h)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.pOh&&!this.$b.annotations.hZe(this.r3,V))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.$b.annotations.hZe(this.GUa,Ea))throw Error.argument("rvalue","Rvalue not of expected type");return this.$b.N0l.store(V,Ea,Za,ia)}static NUl(V,Ea,Za,ia){if(Za===ia)return Ea;if(Kf.Annotations.raa(Za)&&Kf.Annotations.raa(ia)){Za=Kf.Annotations.aJc(Za);ia=Kf.Annotations.aJc(ia);
const Va=new tc.a(V,ia);for(const Ab of Ea.items)Array.add(Va.items,xc.NUl(V,Ab,Za,ia));return Va}if(Za===Kf.Annotations.mic){if(ia===Kf.Annotations.XFb)return Ea;if(ia===Kf.Annotations.OZa)return Ea.toString()}else if(Za===Kf.Annotations.XFb){if(ia===Kf.Annotations.mic)return Math.floor(Ea);if(ia===Kf.Annotations.OZa)return Ea.toString()}else if(Za===Kf.Annotations.OZa){if(ia===Kf.Annotations.mic)return parseInt(Ea);if(ia===Kf.Annotations.XFb)return parseFloat(Ea)}throw Error.invalidOperation("Type conversion failure in query step");
}}Object(k.a)(xc,"AnnotationQuery",null,[1093]);class cd{constructor(){this.GUa=this.r3=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}hJc(V){if(this.next)return{returnValue:this.next,Ygc:V};if(V){const Ea=V.FVl;V=V.Erm;return{returnValue:Ea,Ygc:V}}return{returnValue:null,Ygc:V}}}Object(k.a)(cd,"AnnotationQueryStep",null,[1102]);class od extends cd{constructor(V){super();this.$b=V}load(V,Ea){Ea=this.$b.query.NJ(V,Ea);if(Kf.Annotations.raa(this.r3)){var Za=Kf.Annotations.aJc(this.r3);
let Va=new tc.a(this.$b.annotations,Za);if(Kf.Annotations.raa(this.$b.query.GUa)){if(V.items.length!==Ea.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let Ab=0,gc=V.items.length;Ab<gc;++Ab)Array.add(Va.items,this.oHh(V.items[Ab],Ea.items[Ab],Za===Kf.Annotations.XFb))}else for(var ia of V.items)Array.add(Va.items,this.oHh(ia,Ea,Za===Kf.Annotations.XFb));return Va}if(Kf.Annotations.raa(this.$b.query.GUa)){ia=new tc.a(this.$b.annotations,this.r3);
for(Za of Ea.items)Array.add(ia.items,this.oHh(V,Za,this.r3===Kf.Annotations.XFb));return ia}return this.oHh(V,Ea,this.r3===Kf.Annotations.XFb)}oHh(V,Ea,Za){V=this.AUe(V,Ea);return Za?V:Math.floor(V)}}Object(k.a)(od,"NumericAnnotationQueryStep",cd,[]);class sd extends od{constructor(V){super(V)}AUe(V,Ea){return V+Ea}}Object(k.a)(sd,"AddAnnotationQueryStep",od,[]);class wd extends cd{constructor(V){super();this.$b=V}load(V,Ea){if(this.r3===Kf.Annotations.MLb&&this.$b.query.GUa===Kf.Annotations.MLb){let Va;
if(({result:Va}=this.ETl(V)).returnValue)return Va}if(Kf.Annotations.raa(this.r3)){var Za=new tc.a(this.$b.annotations,Kf.Annotations.MLb);Ea=this.$b.query.NJ(V,Ea);if(Kf.Annotations.raa(this.$b.query.GUa)){if(V.items.length!==Ea.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Va=0,Ab=V.items.length;Va<Ab;++Va)Array.add(Za.items,this.eJf(Ea.items[Va],V.items[Va]))}else for(var ia of V.items)Array.add(Za.items,this.eJf(Ea,ia));return Za}ia=this.$b.query.NJ(V,
Ea);if(Kf.Annotations.raa(this.$b.query.GUa)){Ea=new tc.a(this.$b.annotations,Kf.Annotations.MLb);for(Za of ia.items)Array.add(Ea.items,this.eJf(Za,V));return Ea}return this.eJf(ia,V)}}Object(k.a)(wd,"BinaryBooleanAnnotationQueryStep",cd,[]);class Hd extends wd{constructor(V){super(V)}ETl(V){return{returnValue:!V,result:!1}}eJf(V,Ea){return V&&Ea}}Object(k.a)(Hd,"AndAnnotationQueryStep",wd,[]);class Wd{constructor(V){V&&(this.annotations=V)}}Object(k.a)(Wd,"AnnotationsOnlyQueryStepInit",null,[]);
class mb extends cd{constructor(V){super();this.$b=V}load(V,Ea){Ea=this.$b.query.NJ(V,Ea);V=V.clone();Kf.Annotations.raa(this.$b.query.GUa)?Array.addRange(V.items,Ea.items):Array.add(V.items,Ea);return V}}Object(k.a)(mb,"AppendAnnotationQueryStep",cd,[]);class lc extends cd{constructor(V){super();this.$b=V}load(V,Ea){if(this.r3===Kf.Annotations.Gxa)return this.oUf(V,Ea);const Za=new tc.a(this.$b.annotations,Kf.Annotations.Gxa);for(const ia of V.items)Array.add(Za.items,this.oUf(ia,Ea));return Za}oUf(V,
Ea){const Za=new hh.a(this.$b.annotations);Za.CCc(V);V=new hh.a(this.$b.annotations);this.$b.script.IAa(null,new dg("Input",Za,new dg("Output",V,Ea)));return V}}Object(k.a)(lc,"ApplyAnnotationQueryStep",cd,[]);class Mc extends cd{constructor(V){super();this.$b=V}load(V,Ea){if(this.r3===Kf.Annotations.Gxa)return Ea=this.oUf(V,Ea),Ea.zE(this.$b.vRl).returnValue||new tc.a(this.$b.annotations,Kf.Annotations.Gxa),Ea;const Za=new tc.a(this.$b.annotations,Kf.Annotations.Gxa);for(const ia of V.items)if(V=
this.oUf(ia,Ea),({value:V}=V.zE(this.$b.vRl)).returnValue)for(const Va of V.items)Array.add(Za.items,Va);return Za}oUf(V,Ea){const Za=new hh.a(this.$b.annotations);Za.CCc(V);V=new hh.a(this.$b.annotations);this.$b.script.IAa(null,new dg("Input",Za,new dg("Output",V,Ea)));return V}}Object(k.a)(Mc,"ApplyExpandAnnotationQueryStep",cd,[]);class md{constructor(V,Ea){V&&(this.annotations=Ea.annotations,this.script=Ea.MXd(V.ka(0)),this.vRl=V.ka(1))}}Object(k.a)(md,"ApplyExpandQueryStepInit",null,[]);class ud{constructor(V,
Ea){V&&(this.annotations=Ea.annotations,this.script=Ea.MXd(V.ka(0)))}}Object(k.a)(ud,"ApplyQueryStepInit",null,[]);class Qd extends cd{constructor(V){super();this.$b=V}load(V){if(this.r3===Kf.Annotations.Gxa)return this.JPh(V);const Ea=new tc.a(this.$b.annotations,this.$b.annotations.getAttributeType(this.$b.FHb));for(const Za of V.items)Array.add(Ea.items,this.JPh(Za));return Ea}store(V,Ea,Za,ia){if(this.r3===Kf.Annotations.Gxa){var Va=Ea,Ab=({Ygc:ia}=this.hJc(ia)).returnValue;Ab&&(Va=Ab.store(Kf.Annotations.Zva(this.JPh(V)),
Ea,Za,ia));V.GU(this.$b.FHb,Va)}else{var gc=Ea;if(Va=({Ygc:ia}=this.hJc(ia)).returnValue){gc=new tc.a(this.$b.annotations,this.$b.annotations.getAttributeType(this.$b.FHb));for(Ab of V.items)Array.add(gc.items,this.JPh(Ab));gc=Va.store(gc,Ea,Za,ia)}Ea=gc;if(Ea.items.length!==V.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let Hc=0,fd=V.items.length;Hc<fd;++Hc)Za=V.items[Hc],Za.isReadOnly&&(Za=Za.clone(),V.items[Hc]=Za),Za.GU(this.$b.FHb,Ea.items[Hc])}return V}JPh(V){({value:V}=
V.zE(this.$b.FHb)).returnValue||(V=this.$b.annotations.zen(this.$b.FHb));return V}}Object(k.a)(Qd,"AttrAnnotationQueryStep",cd,[]);class kb{constructor(V,Ea){V&&(this.annotations=Ea,this.FHb=V.ka(0))}}Object(k.a)(kb,"AttrQueryStepInit",null,[]);class Xb extends cd{constructor(V){super();this.$b=V}load(V){const Ea=new hh.a(this.$b.annotations);Ea.CCc(V);return this.$b.module.execute(Ea)}}Object(k.a)(Xb,"CallModuleAnnotationQueryStep",cd,[]);class sc{constructor(V,Ea){V&&(this.annotations=Ea.annotations,
this.module=Ea.Nlj(V.ka(0)))}}Object(k.a)(sc,"CallModuleQueryStepInit",null,[]);class Rc extends cd{constructor(V){super();this.$b=V}load(V,Ea){if(Kf.Annotations.raa(this.r3)){var Za=this.$b.query.NJ(V,Ea);Ea=new tc.a(this.$b.annotations,Kf.Annotations.OZa);let Ab="string"===typeof Za;for(var ia of V.items)if(Ab)Array.add(Ea.items,ia+Za);else for(var Va of Za.items)Array.add(Ea.items,ia+Va);return Ea}ia=this.$b.query.NJ(V,Ea);if("string"===typeof ia)return V+ia;Va=new tc.a(this.$b.annotations,Kf.Annotations.OZa);
for(Za of ia.items)Array.add(Va.items,V+Za);return Va}}Object(k.a)(Rc,"ConcatAnnotationQueryStep",cd,[]);class Zc extends cd{constructor(V){super();this.$b=V}load(V){return xc.NUl(this.$b.annotations,V,this.r3,this.GUa)}}Object(k.a)(Zc,"ConvertAnnotationQueryStep",cd,[]);class Id extends cd{constructor(){super()}load(V){return V.items.length}}Object(k.a)(Id,"CountAnnotationQueryStep",cd,[]);class Td extends od{constructor(V){super(V)}AUe(V,Ea){return V/Ea}}Object(k.a)(Td,"DivideAnnotationQueryStep",
od,[]);class he extends cd{constructor(V){super();this.$b=V}load(V,Ea){Ea=new dg(this.$b.x2h,null,Ea);for(const Za of V.items)if(Ea.qHi(Za),this.$b.query.NJ(Za,Ea))return!0;return!1}}Object(k.a)(he,"ExistsAnnotationQueryStep",cd,[]);class be extends od{constructor(V){super(V)}AUe(V,Ea){return Math.pow(V,Ea)}}Object(k.a)(be,"ExpAnnotationQueryStep",od,[]);class Ue{constructor(V,Ea){V&&(this.Xkc=Ea.j1(V.ka(0)))}}Object(k.a)(Ue,"FeatureBundleNameQueryStepInit",null,[]);class cf extends cd{constructor(V){super();
this.$b=V}load(V){if(Kf.Annotations.raa(this.r3)){const Ea=new tc.a(this.$b.annotations,this.$b.annotations.i1d(Kf.Annotations.aJc(this.r3),this.$b.Ykc));for(const Za of V.items)Array.add(Ea.items,Za.yld(this.$b.Ykc));return Ea}return V.yld(this.$b.Ykc)}store(V,Ea,Za,ia){if(Kf.Annotations.raa(this.r3)){var Va=Ea,Ab=({Ygc:ia}=this.hJc(ia)).returnValue;if(Ab){Va=new tc.a(this.$b.annotations,this.$b.annotations.i1d(Kf.Annotations.aJc(this.r3),this.$b.Ykc));for(var gc of V.items)Array.add(Va.items,gc.yld(this.$b.Ykc));
Va=Ab.store(Va,Ea,Za,ia)}Ea=Va;if(Ea.items.length!==V.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let Hc=0,fd=V.items.length;Hc<fd;++Hc)Za=V.items[Hc],Za.isReadOnly&&(Za=Za.clone(),V.items[Hc]=Za),Za.r$k(this.$b.Ykc,Ea.items[Hc])}else Ab=Ea,(gc=({Ygc:ia}=this.hJc(ia)).returnValue)&&(Ab=gc.store(Kf.Annotations.Zva(V.yld(this.$b.Ykc)),Ea,Za,ia)),V.r$k(this.$b.Ykc,Ab);return V}}Object(k.a)(cf,"FieldAnnotationQueryStep",cd,[]);class mf{constructor(V,
Ea){V&&(this.annotations=Ea,this.Ykc=V.ka(0))}}Object(k.a)(mf,"FieldQueryStepInit",null,[]);class ig extends cd{constructor(V){super();this.$b=V}load(V,Ea){for(const Za of V.items)if(this.$b.filter.isMatch(Za,Ea))return Za;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(V,Ea,Za,ia){let Va=Ea,Ab=-1;for(let Hc=0,fd=V.items.length;Hc<fd;Hc++)if(this.$b.filter.isMatch(V.items[Hc],Za)){Ab=Hc;break}if(0>Ab)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");
const gc=({Ygc:ia}=this.hJc(ia)).returnValue;gc&&(Va=gc.store(Kf.Annotations.Zva(V.items[Ab]),Ea,Za,ia));V.items[Ab]=Va;return V}}Object(k.a)(ig,"FirstItemMatchingAnnotationQueryStep",cd,[]);class ug extends cd{constructor(V){super();this.$b=V}load(V,Ea){Ea=new dg(this.$b.x2h,null,Ea);for(const Za of V.items)if(Ea.qHi(Za),!this.$b.query.NJ(Za,Ea))return!1;return!0}}Object(k.a)(ug,"ForAllAnnotationQueryStep",cd,[]);class Pf extends cd{constructor(V){super();this.$b=V}load(V,Ea){V=Ea?Ea.xLh(this.$b.Xkc):
null;if(!V)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.$b.Xkc+'"');return V}store(V,Ea,Za,ia){V=Za?Za.xLh(this.$b.Xkc):null;if(!V)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.$b.Xkc+'"');let Va=Ea;const Ab=({Ygc:ia}=this.hJc(ia)).returnValue;Ab&&(Va=Ab.store(V,Ea,Za,ia));V!==Va&&V.CCc(Va);return V}}Object(k.a)(Pf,"GetAnnotationQueryStep",cd,[]);class mg{constructor(V,Ea){this.XMm=V;this.wQm=Ea}get FVl(){return this.XMm}get Erm(){return this.wQm}}
Object(k.a)(mg,"AnnotationQueryStoreContinuation",null,[1103]);class Lf extends cd{constructor(V){super();this.$b=V}load(V,Ea){return this.$b.g1h.NJ(V,Ea)?this.$b.hDm.NJ(V,Ea):this.$b.bKh?this.$b.bKh.NJ(V,Ea):V}store(V,Ea,Za,ia){var Va=this.$b.g1h.NJ(V,Za);this.next&&(ia=new mg(this.next,ia));if(Va)return this.$b.hDm.O6e(V,Ea,Za,ia);if(this.$b.bKh)return this.$b.bKh.O6e(V,Ea,Za,ia);Va=Ea;let Ab=null;ia&&(Ab=ia.FVl,ia=ia.Erm);Ab&&(Va=Ab.store(Kf.Annotations.Zva(V),Ea,Za,ia));return Va}}Object(k.a)(Lf,
"IfAnnotationQueryStep",cd,[]);class Nd{constructor(V,Ea){V&&(this.g1h=Ea.tfa(V.ka(0)),this.hDm=Ea.tfa(V.ka(1)),this.bKh=V.ka(2)?Ea.tfa(V.ka(2)):null)}}Object(k.a)(Nd,"IfQueryStepInit",null,[]);class ih{constructor(V,Ea){V&&(this.Wtn=Ea.tfa(V.ka(0)),this.Gam=Ea.tfa(V.ka(1)))}}Object(k.a)(ih,"IndexAndItemQueryStepInit",null,[]);class Yg extends cd{constructor(V){super();this.$b=V}load(V,Ea){const Za=this.$b.Wtn.NJ(V,Ea);Ea=this.$b.Gam.NJ(V,Ea);V=V.clone();if(0>Za||Za>V.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");
if(Kf.Annotations.raa(this.$b.Gam.GUa))for(let ia=0;ia<Ea.items.length;++ia)Array.insert(V.items,Za+ia,Ea.items[ia]);else Array.insert(V.items,Za,Ea);return V}}Object(k.a)(Yg,"InsertAtAnnotationQueryStep",cd,[]);class Ah extends cd{constructor(V){super();this.$b=V}load(V,Ea){return!(!Ea||!Ea.xLh(this.$b.Xkc))}}Object(k.a)(Ah,"IsDefinedAnnotationQueryStep",cd,[]);class Bh extends cd{constructor(V){super();this.$b=V}load(V,Ea){Ea=this.Ald(V,Ea);return V.items[Ea]}store(V,Ea,Za,ia){const Va=this.Ald(V,
Za);let Ab=Ea;const gc=({Ygc:ia}=this.hJc(ia)).returnValue;gc&&(Ab=gc.store(Kf.Annotations.Zva(V.items[Va]),Ea,Za,ia));V.items[Va]=Ab;return V}Ald(V,Ea){Ea=this.$b.query.NJ(V,Ea);if(0>Ea||Ea>=V.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Ea}}Object(k.a)(Bh,"ItemAnnotationQueryStep",cd,[]);class Kh extends cd{constructor(V){super();this.$b=V}load(V,Ea){const Za=new tc.a(this.$b.annotations,Kf.Annotations.aJc(this.r3));for(const ia of V.items)this.$b.filter.isMatch(ia,
Ea)&&Array.add(Za.items,ia);return Za}}Object(k.a)(Kh,"ItemsMatchingAnnotationQueryStep",cd,[]);class Mg extends cd{constructor(V){super();this.$b=V}load(V,Ea){Ea=this.Ald(V,Ea);return V.items[V.items.length-Ea-1]}store(V,Ea,Za,ia){const Va=this.Ald(V,Za);let Ab=Ea;const gc=({Ygc:ia}=this.hJc(ia)).returnValue;gc&&(Ab=gc.store(Kf.Annotations.Zva(V.items[V.items.length-Va-1]),Ea,Za,ia));V.items[V.items.length-Va-1]=Ab;return V}Ald(V,Ea){Ea=this.$b.query?this.$b.query.NJ(V,Ea):0;if(0>Ea||Ea>=V.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Ea}}Object(k.a)(Mg,"LastItemAnnotationQueryStep",cd,[]);class jg extends cd{constructor(V){super();this.$b=V}load(V){if(Kf.Annotations.raa(this.r3)){const Ea=new tc.a(this.$b.annotations,Kf.Annotations.mic);for(const Za of V.items)Array.add(Ea.items,Za.length);return Ea}return V.length}}Object(k.a)(jg,"LengthAnnotationQueryStep",cd,[]);class jh extends cd{constructor(V){super();this.$b=V}load(V,Ea){if(Kf.Annotations.raa(this.r3)){const Za=new tc.a(this.$b.annotations,Kf.Annotations.MLb);for(const ia of V.items)Array.add(Za.items,
this.$b.filter.isMatch(ia,Ea));return Za}return this.$b.filter.isMatch(V,Ea)}}Object(k.a)(jh,"MatchesAnnotationQueryStep",cd,[]);class Yf extends cd{constructor(V){super();this.$b=V}load(V,Ea){return this.$b.filter.isMatch(V,Ea)}}Object(k.a)(Yf,"MatchesAsListAnnotationQueryStep",cd,[]);class jf extends od{constructor(V){super(V)}AUe(V,Ea){return V%Ea}}Object(k.a)(jf,"ModuloAnnotationQueryStep",od,[]);class ci extends od{constructor(V){super(V)}AUe(V,Ea){return V*Ea}}Object(k.a)(ci,"MultiplyAnnotationQueryStep",
od,[]);class bi extends cd{constructor(V){super();this.$b=V}load(V){if(Kf.Annotations.raa(this.r3)){const Ea=new tc.a(this.$b.annotations,Kf.Annotations.MLb);for(const Za of V.items)Array.add(Ea.items,!Za);return Ea}return!V}}Object(k.a)(bi,"NotAnnotationQueryStep",cd,[]);class Rh extends wd{constructor(V){super(V)}ETl(V){return{returnValue:V,result:!0}}eJf(V,Ea){return V||Ea}}Object(k.a)(Rh,"OrAnnotationQueryStep",wd,[]);class di extends cd{constructor(V){super();this.$b=V}load(V,Ea){const Za=this.$b.tnl.NJ(V,
Ea);V=this.$b.CKf.NJ(V,Ea);Ea=new tc.a(this.$b.annotations,Kf.Annotations.mic);for(let ia=0;ia<V;++ia)Array.add(Ea.items,Za+ia);return Ea}}Object(k.a)(di,"RangeAnnotationQueryStep",cd,[]);class Dg{constructor(V,Ea){V&&(this.annotations=Ea.annotations,this.filter=Ea.Pqb(V.ka(0)))}}Object(k.a)(Dg,"SingleFilterQueryStepInit",null,[]);class Oh{constructor(V,Ea){V&&(this.annotations=Ea.annotations,this.query=V.ka(0)?Ea.tfa(V.ka(0)):null)}}Object(k.a)(Oh,"SingleOptionalQueryQueryStepInit",null,[]);class zf{constructor(V,
Ea){V&&(this.annotations=Ea.annotations,this.query=Ea.tfa(V.ka(0)))}}Object(k.a)(zf,"SingleQueryQueryStepInit",null,[]);class bh{constructor(V,Ea){V&&(this.annotations=Ea.annotations,this.tnl=Ea.tfa(V.ka(0)),this.CKf=V.ka(1)?Ea.tfa(V.ka(1)):null)}}Object(k.a)(bh,"StartAndCountOrLengthQueryStepInit",null,[]);class Ph extends cd{constructor(V){super();this.$b=V}load(V,Ea){let Za;({Yoc:Ea,length:Za}=this.pMh(V,Ea));const ia=new tc.a(this.$b.annotations,V.fTa);for(let Va=0;Va<Za;++Va)Array.add(ia.items,
V.items[Ea+Va]);return ia}store(V,Ea,Za,ia){let Va,Ab;({Yoc:Va,length:Ab}=this.pMh(V,Za));var gc=Ea;const Hc=({Ygc:ia}=this.hJc(ia)).returnValue;if(Hc){gc=new tc.a(this.$b.annotations,V.fTa);for(let fd=0;fd<Ab;++fd)Array.add(gc.items,V.items[Va+fd]);gc=Hc.store(gc,Ea,Za,ia)}Ea=gc;for(Za=0;Za<Ab;++Za)Array.removeAt(V.items,Va);for(let fd=0,hd=Ea.items.length;fd<hd;++fd)Array.insert(V.items,Va+fd,Ea.items[fd]);return V}pMh(V,Ea){let Za;Za=this.$b.tnl.NJ(V,Ea);if(0>Za)throw Error.invalidOperation("Invalid start index in Sublist() query step");
Ea=this.$b.CKf?this.$b.CKf.NJ(V,Ea):V.items.length-Za;if(0>Ea||Za+Ea>V.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{Yoc:Za,length:Ea}}}Object(k.a)(Ph,"SublistAnnotationQueryStep",cd,[]);class Lh extends cd{constructor(V){super();this.$b=V}load(V,Ea){if(Kf.Annotations.raa(this.r3)){const Za=new tc.a(this.$b.annotations,Kf.Annotations.OZa);for(let ia=0,Va=V.items.length;ia<Va;++ia)Array.add(Za.items,this.getSubstring(V.items[ia],Ea));
return Za}return this.getSubstring(V,Ea)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}getSubstring(V,Ea){let Za;({Yoc:Ea,length:Za}=this.pMh(V,Ea));return V.substr(Ea,Za)}pMh(V,Ea){let Za;Za=this.$b.tnl.NJ(V,Ea);if(0>Za)throw Error.invalidOperation("Invalid start index in Substring() query step");Ea=this.$b.CKf?this.$b.CKf.NJ(V,Ea):V.length-Za;if(0>Ea||Za+Ea>V.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");
return{Yoc:Za,length:Ea}}}Object(k.a)(Lh,"SubstringAnnotationQueryStep",cd,[]);class wi extends od{constructor(V){super(V)}AUe(V,Ea){return V-Ea}}Object(k.a)(wi,"SubtractAnnotationQueryStep",od,[]);class Zg extends cd{constructor(V){super();this.$b=V}load(V){const Ea=new tc.a(this.$b.annotations,Kf.Annotations.OZa);for(let Za=0;Za<V.length;++Za)Array.add(Ea.items,V.charAt(Za).toString());return Ea}}Object(k.a)(Zg,"ToCharListAnnotationQueryStep",cd,[]);class Rg extends cd{constructor(V){super();this.$b=
V}load(V){const Ea=new tc.a(this.$b.annotations,this.r3);Array.add(Ea.items,V);return Ea}}Object(k.a)(Rg,"ToListAnnotationQueryStep",cd,[]);class ji extends cd{constructor(V){super();this.$b=V}load(){return this.$b.value}}Object(k.a)(ji,"ValueAnnotationQueryStep",cd,[]);class Xh{constructor(V,Ea){if(V){var Za=V.ka(0),ia=1;this.value=({ogb:ia}=Ea.jpb(Za,V,ia,null,null,null)).returnValue;Kf.Annotations.Lce(this.value)}}}Object(k.a)(Xh,"ValueQueryStepInit",null,[]);class kh{constructor(V,Ea){V&&(this.x2h=
Ea.j1(V.ka(0)),this.query=Ea.tfa(V.ka(1)))}}Object(k.a)(kh,"VarNameAndQueryQueryStepInit",null,[]);class mi{constructor(V,Ea){this.nKl=null;if(V){this.annotations=Ea.annotations;var Za=0;this.r3=V.ka(Za);++Za;this.GUa=V.ka(Za);++Za;this.J0h=1===V.ka(Za);++Za;this.pOh=1===V.ka(Za);++Za;var ia=V.ka(Za);++Za;if(ia){var Va=Za,Ab=Za+ia,gc=Za+2*ia;Za+=3*ia;var Hc=V.count-Za,fd=null;for(let yd=0;yd<ia;++yd){var hd=Za+V.ka(gc+yd);const Md=(yd===ia-1?Hc:V.ka(gc+yd+1))-V.ka(gc+yd),te=new Bb.a;te.Ykd(V,hd,Md);
hd=mi.hjn(V.ka(Ab+yd),te,Ea);hd.r3=V.ka(Va+yd);hd.GUa=yd===ia-1?this.GUa:V.ka(Va+yd+1);fd?fd.next=hd:this.nKl=hd;fd=hd}}}}get N0l(){return this.nKl}static hjn(V,Ea,Za){switch(V){case 1:return new Pf(new Ue(Ea,Za));case 2:return new Ah(new Ue(Ea,Za));case 3:return new Qd(new kb(Ea,Za.annotations));case 4:return new cf(new mf(Ea,Za.annotations));case 5:return new Lf(new Nd(Ea,Za));case 6:return new jh(new Dg(Ea,Za));case 43:return new Yf(new Dg(Ea,Za));case 45:return new lc(new ud(Ea,Za));case 49:return new Mc(new md(Ea,
Za));case 46:return new ji(new Xh(Ea,Za.annotations));case 51:return new Xb(new sc(Ea,Za));case 52:return new di(new bh(Ea,Za));case 53:return new Zc(new Wd(Za.annotations));case 13:return new Bh(new zf(Ea,Za));case 14:return new Mg(new Oh(Ea,Za));case 15:return new Id;case 18:return new ig(new Dg(Ea,Za));case 16:return new ug(new kh(Ea,Za));case 17:return new he(new kh(Ea,Za));case 22:return new Yg(new ih(Ea,Za));case 24:return new mb(new zf(Ea,Za));case 26:return new Ph(new bh(Ea,Za));case 27:return new Kh(new Dg(Ea,
Za));case 30:return new Rg(new Wd(Za.annotations));case 31:return new Lh(new bh(Ea,Za));case 32:return new Rc(new zf(Ea,Za));case 47:return new jg(new Wd(Za.annotations));case 48:return new Zg(new Wd(Za.annotations));case 34:return new sd(new zf(Ea,Za));case 35:return new wi(new zf(Ea,Za));case 36:return new ci(new zf(Ea,Za));case 37:return new Td(new zf(Ea,Za));case 38:return new jf(new zf(Ea,Za));case 39:return new be(new zf(Ea,Za));case 40:return new Hd(new zf(Ea,Za));case 41:return new Rh(new zf(Ea,
Za));case 42:return new bi(new Wd(Za.annotations));default:throw Error.argument("currStepInitData");}}}Object(k.a)(mi,"AnnotationQueryInit",null,[]);class rg{constructor(V){this.$b=V}execute(V,Ea){this.IAa(V,V?new dg("root",V,Ea):Ea)}IAa(V,Ea){for(const Za of this.$b.commands)Ea=Za.execute(V,Ea)}}Object(k.a)(rg,"AnnotationScript",null,[1092]);class Ji{constructor(V){this.$b=V}execute(V,Ea){const Za=this.$b.uvn.NJ(V,Ea),ia=this.$b.MVn.NJ(V,Ea);this.$b.script.IAa(V,new dg("Input",Za,new dg("Output",
ia,Ea)));return Ea}}Object(k.a)(Ji,"ApplyAnnotationScriptCommand",null,[1097]);class Ki{constructor(V,Ea){V&&(this.uvn=Ea.tfa(V.ka(0)),this.MVn=Ea.tfa(V.ka(1)),this.script=Ea.MXd(V.ka(2)))}}Object(k.a)(Ki,"ApplyScriptCommandInit",null,[]);class Li{constructor(V){this.$b=V}execute(V,Ea){const Za=this.$b.a4k.NJ(V,Ea);this.$b.SPh.O6e(V,Za,Ea,null);return Ea}}Object(k.a)(Li,"AssignAnnotationScriptCommand",null,[1097]);class jj{constructor(V){this.$b=V}execute(V,Ea){const Za=this.$b.SPh.NJ(V,Ea);V=this.$b.a4k.NJ(V,
Ea);Za!==V&&Za.CCc(V);return Ea}}Object(k.a)(jj,"CopyAnnotationScriptCommand",null,[1097]);class aj{constructor(V){this.$b=V}execute(V,Ea){let Za=this.$b.s2j.NJ(V,Ea);if(this.$b.s2j.J0h){Za=Kf.Annotations.Zva(Za);var ia=new dg(this.$b.Xkc,null,Ea);for(let Ab=0,gc=Za.items.length;Ab<gc;++Ab){var Va=this.t_l(V,Za.items[Ab],ia);if(0>this.$b.IYh)Za.items[Ab]=Va;else if(({value:Va}=Va.zE(this.$b.IYh)).returnValue)Za.items[Ab]=Va;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");
}this.$b.s2j.O6e(V,Za,Ea,null)}else{ia=new dg(this.$b.Xkc,null,Ea);for(let Ab=0,gc=Za.items.length;Ab<gc;++Ab)this.t_l(V,Za.items[Ab],ia)}return Ea}t_l(V,Ea,Za){let ia;0>this.$b.IYh?ia=Kf.Annotations.Zva(Ea):(ia=new hh.a(this.$b.annotations),ia.GU(this.$b.IYh,Ea));Za.qHi(ia);this.$b.xYm.IAa(V,Za);return ia}}Object(k.a)(aj,"EnumerateAnnotationScriptCommand",null,[1097]);class mj{constructor(V,Ea){V&&(this.annotations=Ea.annotations,this.Xkc=Ea.j1(V.ka(0)),this.s2j=Ea.tfa(V.ka(1)),this.xYm=Ea.MXd(V.ka(2)),
this.IYh=V.ka(3))}}Object(k.a)(mj,"EnumerateScriptCommandInit",null,[]);class ri{constructor(V){this.$b=V}execute(V,Ea){this.$b.g1h.NJ(V,Ea)?this.$b.nko.IAa(V,Ea):this.$b.g0l&&this.$b.g0l.IAa(V,Ea);return Ea}}Object(k.a)(ri,"IfAnnotationScriptCommand",null,[1097]);class xi{constructor(V,Ea){V&&(this.g1h=Ea.tfa(V.ka(0)),this.nko=Ea.MXd(V.ka(1)),this.g0l=V.ka(2)?Ea.MXd(V.ka(2)):null)}}Object(k.a)(xi,"IfScriptCommandInit",null,[]);class yi{constructor(V,Ea){V&&(this.annotations=Ea.annotations,this.SPh=
Ea.tfa(V.ka(0)),this.a4k=Ea.tfa(V.ka(1)))}}Object(k.a)(yi,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class vh{constructor(V){this.$b=V}execute(V,Ea){const Za=this.$b.a4k.NJ(this.$b.SPh.NJ(V,Ea),Ea);this.$b.SPh.O6e(V,Za,Ea,null);return Ea}}Object(k.a)(vh,"ModifyAnnotationScriptCommand",null,[1097]);class Hg{constructor(V){this.$b=V}execute(V,Ea){const Za=new hh.a(this.$b.annotations);this.$b.query&&Za.CCc(this.$b.query.NJ(V,Ea));return Ea=new dg(this.$b.Xkc,Za,Ea)}}Object(k.a)(Hg,"NewAnnotationScriptCommand",
null,[1097]);class Zf{constructor(V,Ea){V&&(this.annotations=Ea.annotations,this.Xkc=Ea.j1(V.ka(0)),this.query=V.ka(1)?Ea.tfa(V.ka(1)):null)}}Object(k.a)(Zf,"NewScriptCommandInit",null,[]);class Ci{constructor(V){this.$b=V}execute(V,Ea){V=this.$b.query.NJ(V,Ea);if(this.$b.query.GUa===Kf.Annotations.Gxa)V.dYh(this.$b.FHb);else for(const Za of V.items)Za.dYh(this.$b.FHb);return Ea}}Object(k.a)(Ci,"RemoveAnnotationScriptCommand",null,[1097]);class wh{constructor(V,Ea){V&&(this.annotations=Ea.annotations,
this.query=Ea.tfa(V.ka(0)),this.FHb=V.ka(1))}}Object(k.a)(wh,"RemoveScriptCommandInit",null,[]);class xh{constructor(V,Ea){if(V){var Za=0,ia=V.ka(Za);++Za;if(ia){var Va=Za,Ab=Za+ia;Za+=2*ia;var gc=V.count-Za;this.commands=Array(ia);for(let Hc=0;Hc<ia;++Hc){const fd=Za+V.ka(Ab+Hc),hd=(Hc===ia-1?gc:V.ka(Ab+Hc+1))-V.ka(Ab+Hc),yd=new Bb.a;yd.Ykd(V,fd,hd);this.commands[Hc]=xh.ejn(V.ka(Va+Hc),yd,Ea)}}}}static ejn(V,Ea,Za){switch(V){case 1:return new Li(new yi(Ea,Za));case 2:return new vh(new yi(Ea,Za));
case 3:return new Ci(new wh(Ea,Za));case 6:return new Hg(new Zf(Ea,Za));case 7:return new aj(new mj(Ea,Za));case 8:return new ri(new xi(Ea,Za));case 9:return new jj(new yi(Ea,Za));case 10:return new Ji(new Ki(Ea,Za));default:throw Error.argument("initData");}}}Object(k.a)(xh,"AnnotationScriptInit",null,[]);var vg=a(1513);class Tf{constructor(V){this.zaa=V;this.eM=0}qZa(){const V=this.zaa.DU(this.eM,4);this.eM+=4;return V}get VAf(){return this.zaa}get offset(){return this.eM}set offset(V){this.eM=
V}}Object(k.a)(Tf,"ByteArrayReader",null,[]);class ei{constructor(){this.Rca=null;this.Wem=this.Q5=0}ka(V){if(0>V||V>=this.Q5)throw Error.argumentOutOfRange("index");return this.Rca.DU(this.Wem+4*V,4)}get count(){return this.Q5}static t4m(V,Ea,Za){const ia=new ei;ia.Rca=V;ia.Wem=Ea;ia.Q5=Za;return ia}}Object(k.a)(ei,"ReadOnlyListOverByteArray",null,[1088]);class yg{constructor(V,Ea){this.oem=this.fem=!1;this.lQ=this.Qmc=this.T9j=this.vem=null;try{this.lQ=Ea.annotations;const Za=Ea.ild(V.ka(0)),ia=
new Tf(Za);if(-914743053!==ia.qZa())throw Error.argument("Input does not represent a flat lexicon");this.fem=1===ia.qZa();this.oem=1===ia.qZa();const Va=ia.qZa();ia.offset+=Va;const Ab=ia.qZa();this.T9j=yg.YVn(ia,Ab,this.lQ);const gc=ia.qZa();this.vem=yg.cWn(ia,gc);const Hc=ia.qZa();this.Qmc=new vg.a(ia.VAf,ia.offset);ia.offset+=Hc}catch(Za){throw Error.argument("initData");}}get trie(){return this.Qmc}Uen(V){return"i"===V&&this.oem?"\u0130":V.toUpperCase()}wOj(){return this.fem}gen(V){let Ea;Ea=
new tc.a(this.lQ,Kf.Annotations.Gxa);if(1!==V)if(0===V)V=new hh.a(this.lQ),Array.add(Ea.items,V);else if(V&1073741824){V=this.vem[V&-1073741825];for(let ia=0;ia<V.length;++ia){var Za=V[ia];Za=0===Za?new hh.a(this.lQ):this.T9j[Za-2];Array.add(Ea.items,Za)}}else Array.add(Ea.items,this.T9j[V-2]);return{returnValue:!0,KAn:Ea}}static YVn(V,Ea,Za){if(Ea%4)throw Error.argument("reader");const ia=ei.t4m(V.VAf,V.offset,Ea/4);V.offset+=Ea;V=[];for(Ea=0;Ea<ia.count;){const Va=({ogb:Ea}=Za.jpb(Kf.Annotations.Gxa,
ia,Ea,null,null,null)).returnValue;Array.add(V,Va)}return V}static cWn(V,Ea){Ea=V.offset+Ea;const Za=[];for(;V.offset<Ea;){const ia=V.qZa(),Va=Array(ia);for(let Ab=0;Ab<ia;++Ab){const gc=V.qZa();Va[Ab]=gc}Array.add(Za,Va)}return Za}}Object(k.a)(yg,"RawFlatLexicon",null,[1086]);var Hj=a(1428),zi=a(1429);class Mi{constructor(V){if(null==V)throw Error.argumentNull("base64String");const Ea=V.length;if(Ea%4)throw Error.argument("base64String's length must be a multiple of 4");this.Q5=.75*Ea;this.Afe=Array(Math.ceil(this.Q5/
4));V.endsWith("==")?this.Q5-=2:V.endsWith("=")&&--this.Q5;let Za=0;for(let ia=0;ia<Ea;ia+=4){const Va=Mi.TYh[V.charCodeAt(ia)-43]<<18|Mi.TYh[V.charCodeAt(ia+1)-43]<<12|Mi.TYh[V.charCodeAt(ia+2)-43]<<6|Mi.TYh[V.charCodeAt(ia+3)-43];let Ab=Va>>16&255;this.Afe[Math.floor(Za/4)]|=Ab<<Za%4*8;++Za;Ab=Va>>8&255;this.Afe[Math.floor(Za/4)]|=Ab<<Za%4*8;++Za;Ab=Va&255;this.Afe[Math.floor(Za/4)]|=Ab<<Za%4*8;++Za}}get length(){return this.Q5}ka(V){if(0>V||V>=this.Q5)throw Error.argumentOutOfRange("i");return this.$1l(V)}DU(V,
Ea){if(0>V||0>Ea||V+Ea>this.Q5)throw Error.argument("Bad range");let Za=0;for(let ia=0;ia<Ea;++ia)Za|=this.$1l(V+ia)<<8*ia;return Za}D3n(V,Ea){let Za=0,ia=0,Va=Math.floor(V/8);for(V%=8;ia<Ea;){const Ab=8-V>Ea-ia?Ea-ia:8-V,gc=this.ka(Va);Za|=(gc>>V&~(255<<Ab))<<ia;ia+=Ab;++Va;V=0}return Za}$1l(V){return this.Afe[Math.floor(V/4)]>>V%4*8&255}}Mi.TYh=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,
31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(k.a)(Mi,"ByteArray",null,[]);class sf{constructor(V,Ea,Za){this.o4=V;this.vEn=Ea;this.FFn=Za;this.ofm=Array(V.b?V.b.length:0);this.gnk=new Hj.a(new zi.a(this.ild(this.o4.s)));this.QYa=Array(V.t.length);this.XLm=new Kf.Annotations(this.fld(0),this)}get annotations(){return this.XLm}get V8m(){return this.o4.d}Vin(){if(!(""in this.o4.m))throw Error.argument("name","Unrecognized module");return this.Nlj(this.o4.m[""])}ild(V){if(0>
V||!this.o4.b||V>=this.o4.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.ofm[V]||(this.ofm[V]=new Mi(this.o4.b[V]))}j1(V){if(1>V||V>=this.o4.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.o4.t[V])throw Error.argument("blobID","Requested blob is not a string");if(null==this.QYa[V]){const Ea=this.fld(V).ka(0);this.QYa[V]=this.gnk.j1(Ea)}return this.QYa[V]}c4l(V){if(1>V||V>=this.o4.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.o4.t[V])throw Error.argument("blobID",
"Requested blob is not a Regex");if(!this.QYa[V]){var Ea=this.fld(V);const Za=this.j1(Ea.ka(0));Ea=1===Ea.ka(1);this.QYa[V]=new RegExp(Za,Ea?"i":"")}return this.QYa[V]}Lkn(V){if(1>V||V>=this.o4.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.o4.t[V])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}Nlj(V){if(1>V||V>=this.o4.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.o4.t[V])throw Error.argument("blobID","Requested blob is not an NL module");
return this.QYa[V]||(this.QYa[V]=this.FFn.cjn(this.fld(V),this))}tfa(V){if(1>V||V>=this.o4.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.o4.t[V])throw Error.argument("blobID","Requested blob is not an annotation query");return this.QYa[V]||(this.QYa[V]=new xc(new mi(this.fld(V),this)))}MXd(V){if(1>V||V>=this.o4.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.o4.t[V])throw Error.argument("blobID","Requested blob is not an annotation script");return this.QYa[V]||(this.QYa[V]=
new rg(new xh(this.fld(V),this)))}Pqb(V){if(1>V||V>=this.o4.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.o4.t[V])throw Error.argument("blobID","Requested blob is not a filter");return this.QYa[V]||(this.QYa[V]=this.vEn.Pqb(this.fld(V),this))}skn(V){if(1>V||V>=this.o4.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.o4.t[V])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.QYa[V]||(this.QYa[V]=new yg(this.fld(V),this))}fld(V){const Ea=
this.o4.n[V];V=(V<this.o4.t.length-1?this.o4.n[V+1]:this.o4.n.length)-Ea;if(0>Ea||0>V||Ea+V>this.o4.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Ea+","+V+")");const Za=new Bb.a;Za.lYf(this.o4.n,Ea,V);return Za}}Object(k.a)(sf,"ObjectFetcher",null,[1073]);class ki{constructor(V,Ea,Za){if(!V)throw Error.argumentNull("prediction");if(!Ea)throw Error.argumentNull("fieldNames");if(!Za)throw Error.argumentNull("values");if(Ea.length!==Za.length)throw Error.argument("values",
"fieldNames and values do not have same length");this.pQm=V;this.Qie=Ea;this.b_c=Za}get prediction(){return this.pQm}get k0l(){return this.Qie.length}getFieldName(V){return 0<=V&&V<this.Qie.length?this.Qie[V]:null}jb(V){return 0<=V&&V<this.b_c.length?this.b_c[V]:null}}Object(k.a)(ki,"PredictionData",null,[]);class qh{constructor(V,Ea){if(!V)throw Error.argumentNull("predictions");if(!Ea)throw Error.argumentNull("tokenAttributes");this.ZFn=V;this.kHn=Ea}Lnj(){return this.ZFn}J1l(){return this.kHn}}
Object(k.a)(qh,"PredictionDataWithTokenAttributes",null,[]);class Hh{constructor(V,Ea){this.prediction=null;this.score=0;this.prediction=V;this.score=Ea}}Object(k.a)(Hh,"PredictionWithScore",null,[]);class Ei{constructor(V,Ea){if(!V)throw Error.argumentNull("predictions");if(!Ea)throw Error.argumentNull("attributes");this.qQm=V;this.A7h=Ea}Lnj(){return this.qQm}J1l(){return this.A7h}}Object(k.a)(Ei,"PredictionsWithTokenAttributes",null,[]);class Xg{constructor(V,Ea,Za){if(!V)throw Error.argumentNull("attributeName");
if(!Ea)throw Error.argumentNull("fieldNames");if(!Za)throw Error.argumentNull("values");if(Ea.length!==Za.length)throw Error.argument("values","fieldNames and values do not have same length");this.mMm=V;this.Qie=Ea;this.b_c=Za}get attributeName(){return this.mMm}get k0l(){return this.Qie.length}getFieldName(V){return 0<=V&&V<this.Qie.length?this.Qie[V]:null}jb(V){return 0<=V&&V<this.b_c.length?this.b_c[V]:null}}Object(k.a)(Xg,"TokenAttributes",null,[]);var Ee=a(1);class Jf{constructor(V,Ea,Za,ia,
Va){this.MBh=0;this.dGl=null;this.NBh=this.u8e=0;this.Q2h=this.jRe=this.HGb=this.v8e=null;this.eGl=0;this.bQb=this.TY=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.Ava=V;this.EFm=this.IFm=Ea;this.DFm=this.GFm=Za;this.KBh=this.FFm=ia;this.LBh=this.HFm=Va}r8e(){this.NBh=0;return this.Wfd}Wfd(){if(!(this.NBh<this.KBh))return this.iRe;this.v8e=this.EFm.items[this.NBh+this.DFm];this.HGb=new hh.a(this.Ava.$b.annotations);1!==
this.KBh&&this.Ava.$b.Qeg||this.HGb.CCc(this.v8e);if(0<=this.Ava.$b.hVh){({value:this.jRe}=this.HGb.zE(this.Ava.$b.hVh)).returnValue?this.jRe=this.jRe.Zva():this.jRe=new tc.a(this.Ava.$b.annotations,Kf.Annotations.Gxa);this.Q2h=this.LBh.items;this.eGl=this.Q2h.length;for(this.MBh=0;this.MBh<this.eGl;++this.MBh)this.dGl=this.Q2h[this.MBh],Array.add(this.jRe.items,this.dGl);this.HGb.GU(this.Ava.$b.hVh,this.jRe)}else 0<=this.Ava.$b.bll?this.HGb.GU(this.Ava.$b.bll,this.LBh.items[0]):0<=this.Ava.$b.iBi?
this.HGb.GU(this.Ava.$b.iBi,!0):this.Ava.$b.i$l?this.LBh.items[0].IKh((V,Ea)=>this.HGb.GU(V,Ea)):(this.HGb.CCc(this.LBh.items[0]),1!==this.KBh&&this.Ava.$b.Qeg||(({value:this.u8e}=this.v8e.zE(this.Ava.$b.lMa)).returnValue&&this.HGb.GU(this.Ava.$b.lMa,this.u8e),({value:this.u8e}=this.v8e.zE(this.Ava.$b.rXa)).returnValue&&this.HGb.GU(this.Ava.$b.rXa,this.u8e),this.v8e.zE(this.Ava.$b.Hid).returnValue&&this.HGb.GU(this.Ava.$b.Hid,this.u8e)));this.TY=this.HGb;this._state=2;return this.t8e}iRe(){this._state=
3}s8e(){this.NBh++;return this.Wfd}t8e(){return 1<this.KBh&&this.Ava.$b.Qeg?this.iRe:this.s8e}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Jf(this.Ava,this.IFm,this.GFm,this.FFm,this.HFm)).getEnumerator()}[Symbol.iterator](){return Object(Ee.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.bQb=this.r8e());for(;1===this._state;)this.bQb=this.bQb();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");
}get_current(){return this.TY}}Object(k.a)(Jf,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[40,66,122]);class Ze{constructor(V,Ea,Za){this.yxg=this.Xem=0;this.k_e=null;this.Nnk=this.F$j=this.f_e=this.BQh=this.Eak=0;this.ZQh=!1;this.Jhk=V;this.wok=Ea;this.TFn=Za}u3l(){null===this.k_e&&({rCm:this.k_e,C7l:this.Eak,length:this.BQh,Aan:V}=this.Jhk.h5l(this.wok.items[this.yxg],this.TFn),this.ZQh=V||this.ZQh);if(this.f_e<this.BQh){var V=
this.k_e.charAt(this.Eak+this.f_e);++this.f_e;return{returnValue:!0,ch:V}}if(this.yxg===this.wok.items.length-1)return{returnValue:!1,ch:"\x00"};++this.yxg;this.f_e=0;this.k_e=null;return{returnValue:!0,ch:" "}}AWk(V,Ea){this.f_e===this.BQh&&this.k_e&&(this.Nnk=Ea,this.F$j=this.yxg-this.Xem+1)}e8n(V){if(0>V||V>=this.wok.items.length)throw Error.argumentOutOfRange("iToken");this.yxg=this.Xem=V;this.k_e=null;this.F$j=this.f_e=this.BQh=this.Eak=0;this.Nnk=-1;this.ZQh=!1}Cin(){return{NZm:this.F$j,Ozn:this.Nnk,
san:this.ZQh}}}Object(k.a)(Ze,"TriePrefixVisitor",null,[1101]);class Xj{constructor(V){this.$b=V}execute(V){if(!({value:Za}=V.zE(this.$b.jkc)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Ea;({value:Ea}=V.zE(this.$b.Czc)).returnValue||(Ea=null);var Za=this.Udn(Za,Ea);V=Kf.Annotations.Zva(V);V.GU(this.$b.jkc,Za);return V}Udn(V,Ea){let Za=null;const ia=this.$b.flatLexicon.trie,Va=new Ze(this,V,Ea);let Ab=null;this.$b.flatLexicon.wOj()&&(Ab=Object(B.a)(this.$b.flatLexicon,
this.$b.flatLexicon.Uen,"getCaseInsensitiveForm"));let gc=0,Hc;var fd;let hd;for(;gc<V.items.length;){const yd=V.items[gc];Va.e8n(gc);ia.gFm(Va,Ab);({NZm:Hc,Ozn:fd,san:hd}=Va.Cin());if(0<Hc){({KAn:fd}=this.$b.flatLexicon.gen(fd));for(let Md of this.U4m(V,gc,Hc,fd)){1<Hc&&this.$b.Qeg&&this.Z4m(V,Ea,gc,yd,Hc,hd,Md);if(!Za)for(Za=new tc.a(this.$b.annotations,Kf.Annotations.Gxa),fd=0;fd<gc;++fd)Array.add(Za.items,V.items[fd]);Array.add(Za.items,Md)}gc+=Hc}else Za&&Array.add(Za.items,yd),++gc}return Za||
V}Z4m(V,Ea,Za,ia,Va,Ab,gc){if(Ab)Ab=!0;else if(this.$b.g$l){Ab=!1;var Hc=-1;for(var fd=0;fd<Va;fd++){var hd=V.items[Za+fd];let Pe;var yd=void 0;if(!({value:Pe}=hd.zE(this.$b.lMa)).returnValue||!({value:yd}=hd.zE(this.$b.rXa)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");if(0<fd){if(Pe>Hc+1){Ab=!0;break}if(0>Hc||null===Ea||Hc>=Ea.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");
if(" "!==Ea.charAt(Hc)){Ab=!0;break}}Hc=Pe+yd}}else Ab=!1;if(Ab){yd=new Sys.StringBuilder;for(Ab=0;Ab<Va;++Ab)({rCm:Hc,C7l:fd,length:hd}=this.h5l(V.items[Za+Ab],Ea)),0<Ab&&yd.append(" "),yd.append(Hc.substr(fd,hd));gc.GU(this.$b.Hid,yd.toString())}V=V.items[Za+Va-1];let Md,te;({value:ia}=ia.zE(this.$b.lMa)).returnValue&&({value:Md}=V.zE(this.$b.lMa)).returnValue&&({value:te}=V.zE(this.$b.rXa)).returnValue?(gc.GU(this.$b.lMa,ia),gc.GU(this.$b.rXa,Md+te-ia)):(gc.dYh(this.$b.lMa),gc.dYh(this.$b.rXa))}U4m(V,
Ea,Za,ia){return new Jf(this,V,Ea,Za,ia)}h5l(V,Ea){let Za,ia;if(({value:Za}=V.zE(this.$b.Hid)).returnValue)ia=!0,Ea=0,V=Za.length;else{ia=!1;if(null===Ea)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");Za=Ea;if(!({value:Ea}=V.zE(this.$b.lMa)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation","token");if(!({value:V}=V.zE(this.$b.rXa)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>
Ea||0>V||Ea+V>Za.length)throw Error.argument("Token start/length values out of range","token");}return{rCm:Za,C7l:Ea,length:V,Aan:ia}}}Object(k.a)(Xj,"FlatLexiconNLModule",null,[1087]);class Ij{constructor(V,Ea){this.iBi=this.hVh=this.bll=this.Hid=this.rXa=this.lMa=this.Czc=this.jkc=0;this.i$l=this.g$l=this.Qeg=!1;this.flatLexicon=null;this.annotations=Ea.annotations;let Za=0;try{this.jkc=V.ka(Za),++Za,this.Czc=V.ka(Za),++Za,this.lMa=V.ka(Za),++Za,this.rXa=V.ka(Za),++Za,this.Hid=V.ka(Za),++Za,this.bll=
V.ka(Za),++Za,this.hVh=V.ka(Za),++Za,this.iBi=V.ka(Za),++Za,this.Qeg=1===V.ka(Za),++Za,this.g$l=1===V.ka(Za),++Za,this.i$l=1===V.ka(Za),++Za,this.flatLexicon=Ea.skn(V.ka(Za))}catch(ia){throw Error.argument("initData");}}}Object(k.a)(Ij,"FlatLexiconNLModuleInit",null,[]);class xj{constructor(){this.nbg=0;this.h8i=null;this.bhh=0}}Object(k.a)(xj,"FeatureGenStackRec",null,[]);class nh{constructor(V){this.mtl=Array(V);this.w7e=Array(V);this.bol=[];this.LBm=[]}}Object(k.a)(nh,"TokenStringLattice",null,
[]);const fh=(V,Ea,Za)=>{for(let ia=0;ia<V.length;ia++)Za=Ea(Za,V[ia]);return Za},ng=(V,Ea)=>{const Za=Array(V.length);for(let ia=0;ia<V.length;ia++)Za[ia]=Ea(V[ia]);return Za},R=(V,Ea)=>{Ea=Array(Math.min(Ea,V.length));for(let Za=0;Za<Ea.length;Za++)Ea[Za]=V[Za];return Ea},Ha=(V,Ea)=>{const Za=[];for(const ia of V)Ea(ia)&&Array.add(Za,ia);return Za};class wb{constructor(V,Ea){this.key=V;this.value=Ea}}Object(k.a)(wb,"KeyValuePair",null,[]);const Yb=(V,Ea)=>({returnValue:Ea in V,value:V[Ea]}),zc=
V=>{const Ea=[];for(let Za in V){const ia=new wb(Za,V[Za]);Array.add(Ea,ia)}return Ea};class Ic{constructor(V){this.g5l=this.Qmn;this.$b=V;this.lSh=this.thk=this.uhk=0;for(const Ea of this.$b.eKh)this.uhk=Math.max(this.uhk,Ea.QKk),this.thk=Math.max(this.thk,Ea.VGk),this.lSh=Math.max(this.lSh,Ea.F6e.length)}get obn(){return this.$b.t1h.trie}execute(V){if(!V)throw Error.argumentNull("input");let Ea,Za;({tokens:Ea,lAn:Za}=this.Smn(V));let ia=null,Va=null,Ab={};if(this.$b.Fgg){Ea=Kf.Annotations.Zva(Ea);
for(var gc=0;gc<Ea.items.length;++gc)Ea.items[gc]=Kf.Annotations.Zva(Ea.items[gc])}else({h0l:Va,returnValue:ia}=this.H3l(V,Ab));gc=Array(this.lSh);const Hc=Array(this.lSh);for(var fd=0;fd<Hc.length;++fd)Hc[fd]=new xj;for(fd=-this.uhk;fd<Ea.items.length+this.thk;++fd){let hd=null;this.$b.Fgg&&(hd=Ea.items[fd],Ab={},{h0l:Va,returnValue:ia}=this.H3l(hd,Ab));for(const yd of this.$b.eKh){if(0>fd&&-fd>yd.QKk||fd>=Ea.items.length&&fd-Ea.items.length+1>yd.VGk)continue;let Md=!0;for(let te=0;te<yd.F6e.length;++te){const Pe=
fd+yd.F6e[te];gc[te]=Pe;if(0>Pe?0>this.$b.RKk:Pe>=Ea.items.length?0>this.$b.WGk:!Za.w7e[Pe]){Md=!1;break}}Md&&({A6m:ia,B6m:Va}=this.Nvn(yd,Za,ia,Va,Ab,Hc,gc))}this.$b.Fgg&&(hd.GU(this.$b.oOc?this.$b.fUe:this.$b.dUe,ia),this.$b.oOc&&hd.GU(this.$b.eUe,Va))}V=Kf.Annotations.Zva(V);this.$b.Fgg?V.GU(this.$b.jkc,Ea):(V.GU(this.$b.oOc?this.$b.fUe:this.$b.dUe,ia),this.$b.oOc&&V.GU(this.$b.eUe,Va));return V}Smn(V){let Ea,Za;if(!V||!({value:Ea}=V.zE(this.$b.jkc)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let ia;({value:ia}=V.zE(this.$b.Czc)).returnValue||(ia="");Za=new nh(Ea.items.length);const Va=Ha(this.$b.ptl,Ab=>!Ab.Qcg||Ab.Qcg.isMatch(V,null));for(let Ab=0;Ab<Ea.items.length;++Ab){const gc=Ea.items[Ab];let Hc=null;Za.mtl[Ab]=Za.bol.length;let fd=Za.w7e[Ab]=0;for(const hd of Va)0<hd.zUg&&Za.w7e[Ab]+fd>=hd.zUg||hd.vth&&!hd.vth.isMatch(gc,null)||({wth:Hc,KDf:fd}=hd.apply(this,gc,Ab,Za,ia,Hc,fd))}return{tokens:Ea,lAn:Za}}Nvn(V,Ea,Za,ia,Va,Ab,gc){let Hc=0;Ab[0].nbg=-1;for(Ab[0].h8i=V.awm;;){var fd=
gc[Hc],hd=0>fd||fd>=Ea.w7e.length?1:Ea.w7e[fd];let te=!1;for(;Ab[Hc].nbg<hd-1;){++Ab[Hc].nbg;var yd=void 0,Md=void 0;0>fd?(yd=this.$b.RKk,Md=1):fd>=Ea.mtl.length?(yd=this.$b.WGk,Md=1):(Md=Ea.mtl[fd]+Ab[Hc].nbg,yd=Ea.bol[Md],Md=Ea.LBm[Md]);Ab[Hc].bhh=Md*(Hc?Ab[Hc-1].bhh:V.score);if(({value:yd}=Yb(Ab[Hc].h8i,yd.toString())).returnValue){Hc===V.F6e.length-1?(fd=yd,Ab[Hc].bhh&&(({value:hd}=Yb(Va,fd.toString())).returnValue||(hd=-1),0>hd&&(Za=Kf.Annotations.Zva(Za),Array.add(Za.items,fd)),this.$b.oOc&&
(ia=Kf.Annotations.Zva(ia),0>hd?Array.add(ia.items,Ab[Hc].bhh):ia.items[hd]+=Ab[Hc].bhh),0>hd&&(this.$b.uam||this.$b.oOc)&&(Va[fd.toString()]=Za.items.length-1))):(++Hc,Ab[Hc].nbg=-1,Ab[Hc].h8i=yd);te=!0;break}}if(!te&&(--Hc,0>Hc))break}return{A6m:Za,B6m:ia}}H3l(V,Ea){let Za;if(({value:Za}=V.zE(this.$b.oOc?this.$b.fUe:this.$b.dUe)).returnValue)for(let ia=0;ia<Za.items.length;++ia)Ea[Za.items[ia].toString()]=ia;else Za=new tc.a(this.$b.annotations,Kf.Annotations.mic);if(this.$b.oOc){if(({value:Ea}=
V.zE(this.$b.eUe)).returnValue||(Ea=new tc.a(this.$b.annotations,Kf.Annotations.XFb)),Ea.items.length!==Za.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.$b.annotations.keb(Kf.Annotations.Gxa,V));}else Ea=null;return{returnValue:Za,h0l:Ea}}get ljo(){return this.$b.t1h}Qmn(V,Ea){var Za;if(({value:Za}=Ea.zE(this.$b.Hid)).returnValue)V=Za;else{if(!({value:Za}=Ea.zE(this.$b.lMa)).returnValue)throw Error.argument("Token is missing Span.StartIndex");
if(!({value:Ea}=Ea.zE(this.$b.rXa)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>Za||0>Ea||Za+Ea>V.length)throw Error.argument("Token indices are out of range");V=V.substr(Za,Ea)}return V}}Object(k.a)(Ic,"NGramNLModule",null,[1087,1091]);class Wc{constructor(V){this.F6e=null;this.score=this.VGk=this.QKk=0;this.awm=null;if(V){var Ea=0;try{if(V.ka(Ea)!==Wc.SMd)throw Error.argument("initData","Input does not represent a feature template");++Ea;const Za=V.ka(Ea);++Ea;this.F6e=
Array(Za);for(let ia=0;ia<Za;++ia)this.F6e[ia]=V.ka(Ea),++Ea;this.QKk=V.ka(Ea);++Ea;this.VGk=V.ka(Ea);++Ea;this.score=V.ka(Ea);++Ea;this.awm=({B7l:Ea}=Wc.Jsm(V,Ea)).returnValue}catch(Za){throw Error.argument("initData");}}}static Jsm(V,Ea){const Za=V.ka(Ea);++Ea;const ia={};for(let Va=0;Va<Za;++Va){const Ab=V.ka(Ea);++Ea;V.ka(Ea)?ia[Ab.toString()]=({B7l:Ea}=Wc.Jsm(V,Ea)).returnValue:(++Ea,ia[Ab.toString()]=V.ka(Ea),++Ea)}return{returnValue:ia,B7l:Ea}}}Wc.SMd=240803228;Object(k.a)(Wc,"FeatureTemplate",
null,[1099]);var rd=a(1260);class vd{constructor(V,Ea){this.oOc=this.uam=this.Fgg=!1;this.Hid=this.rXa=this.lMa=this.jkc=this.Czc=this.eUe=this.fUe=this.dUe=0;this.t1h=null;this.WGk=this.RKk=0;this.eKh=this.ptl=null;if(V){this.annotations=Ea.annotations;var Za=0;try{this.Fgg=1===V.ka(Za);++Za;this.uam=1===V.ka(Za);++Za;this.oOc=1===V.ka(Za);++Za;this.dUe=V.ka(Za);++Za;this.fUe=V.ka(Za);++Za;this.eUe=V.ka(Za);++Za;this.Czc=V.ka(Za);++Za;this.jkc=V.ka(Za);++Za;this.lMa=V.ka(Za);++Za;this.rXa=V.ka(Za);
++Za;this.Hid=V.ka(Za);++Za;this.t1h=this.oWn(Ea.ild(V.ka(Za)));++Za;this.RKk=V.ka(Za);++Za;this.WGk=V.ka(Za);++Za;const ia=V.ka(Za);++Za;this.ptl=Array(ia);for(let Ab=0;Ab<ia;++Ab){const gc=V.ka(Za);++Za;const Hc=this.t1h.trie,fd=new Bb.a;fd.Ykd(V,Za,gc);this.ptl[Ab]=this.sWn(fd,Ea,Hc);Za+=gc}const Va=V.ka(Za);++Za;this.eKh=Array(Va);for(Ea=0;Ea<Va;++Ea){const Ab=V.ka(Za);++Za;const gc=new Bb.a;gc.Ykd(V,Za,Ab);this.eKh[Ea]=this.dWn(gc);Za+=Ab}}catch(ia){throw Error.argument("initData");}}}oWn(V){return new Hj.a(new zi.a(V))}sWn(V,
Ea,Za){return rd.a.create(V,Ea,Za)}dWn(V){return new Wc(V)}}Object(k.a)(vd,"NGramNLModuleInit",null,[]);class Rd{constructor(V){this.$b=V}execute(V){if(!V)throw Error.argumentNull("input");V=V.clone();this.$b.script.execute(V,null);return V}}Object(k.a)(Rd,"ScriptNLModule",null,[1087]);class me{constructor(V,Ea){V&&(this.script=Ea.MXd(V.ka(0)))}}Object(k.a)(me,"ScriptNLModuleInit",null,[]);const ce=V=>{V=ng(V,Ea=>Ea*Ea);return Math.sqrt(fh(V,(Ea,Za)=>Ea+Za,0))},yb=V=>fh(V,(Ea,Za)=>Ea>Za?Ea:Za,V[0]);
class Tc{constructor(V){this.$b=V}execute(V){if(!V)throw Error.argumentNull("input");var Ea=[],Za=[];this.H1m(V,Ea,Za);this.kWm(Ea,Za);const ia={};for(let Ab=0;Ab<Ea.length;++Ab){var Va=Ea[Ab];const gc=this.$b.P8l.ka(Va);Va=this.$b.Q8l.ka(Va);for(let Hc=0;Hc<Va;++Hc){const fd=this.$b.F0m.ka(this.$b.eUl.ka(gc+Hc)),hd=this.$b.fUl.ka(gc+Hc);let yd;({value:yd}=Yb(ia,fd)).returnValue||(yd=0);ia[fd]=yd+Za[Ab]*hd}}Za=zc(ia);Za.sort((Ab,gc)=>{var Hc=Ab.value,fd=gc.value;(Hc=-(Hc>fd?1:Hc<fd?-1:0))||(Hc=Ab.key.localeCompare(gc.key));
return Hc});Ea=new tc.a(this.$b.annotations,Kf.Annotations.Gxa);for(const Ab of R(Za,this.$b.kIn))Za=new hh.a(this.$b.annotations),Za.GU(this.$b.HXm,Ab.key),Za.GU(this.$b.JXm,Ab.value),Array.add(Ea.items,Za);V.GU(this.$b.IXm,Ea);return V}H1m(V,Ea,Za){if(({value:V}=V.zE(this.$b.GXm)).returnValue){let ia;if(({value:ia}=V.zE(this.$b.fUe)).returnValue){let Va;if(!({value:Va}=V.zE(this.$b.eUe)).returnValue||ia.items.length!==Va.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");
this.IHh(ia,Va,Ea,Za)}if(({value:ia}=V.zE(this.$b.LXm)).returnValue){let Va;if(!({value:Va}=V.zE(this.$b.MXm)).returnValue||ia.items.length!==Va.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.IHh(ia,Va,Ea,Za)}({value:ia}=V.zE(this.$b.dUe)).returnValue&&this.IHh(ia,null,Ea,Za);({value:ia}=V.zE(this.$b.KXm)).returnValue&&this.IHh(ia,null,Ea,Za)}}IHh(V,Ea,Za,ia){for(let Ab=0;Ab<V.items.length;++Ab){var Va=void 0;V.fTa===Kf.Annotations.OZa?
({value:Va}=Yb(this.$b.ZYl,V.items[Ab])).returnValue||(Va=-1):(Va=V.items[Ab],Va=Va>=this.$b.rsk&&Va<=this.$b.yIn?this.$b.zuk?this.$b.zuk.ka(Va-this.$b.rsk)-1:Va-this.$b.rsk:-1);if(0<=Va){let gc;gc=Ea?Ea.items[Ab]:1;0<gc&&(Array.add(Za,Va),Array.add(ia,gc))}}}kWm(V,Ea){if(V.length){switch(this.$b.i2n){case 0:break;case 1:for(var Za=0;Za<Ea.length;++Za)Ea[Za]=1+Math.log(Ea[Za]);break;case 2:Za=yb(Ea);for(let ia=0;ia<Ea.length;++ia)Ea[ia]=.5+Ea[ia]/Za*.5;break;case 3:for(Za=0;Za<Ea.length;++Za)Ea[Za]=
1;break;default:throw Error.notImplemented();}if(this.$b.ONh)for(Za=0;Za<Ea.length;++Za)Ea[Za]*=this.$b.ONh.ka(V[Za]);V=ce(Ea);for(Za=0;Za<Ea.length;++Za)Ea[Za]/=V}}}Object(k.a)(Tc,"TfIdfRankerNLModule",null,[1087]);class bd{constructor(V,Ea=0){if(!V)throw Error.argumentNull("byteArray");this.ay=Ea;if(604662927!==V.DU(this.ay+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.Wp=V.DU(this.ay+4,4);this.Jcm=V.DU(this.ay+8,4);this.EDn=V}ka(V){if(0>V||V>=this.count)throw Error.argumentOutOfRange("index");
return this.EDn.D3n(8*this.ay+96+V*this.Jcm,this.Jcm)}get count(){return this.Wp}}Object(k.a)(bd,"CompactIntArray",null,[1088]);const kd=(V,Ea)=>{Ea=Array(Ea);for(let Ab=0;Ab<Ea.length;Ab++){var Za=Ab,ia=V.qZa(),Va=1===(ia>>31&1)?-1:1;const gc=ia&8388607;ia=ia>>23&255;256===ia+1?Va=gc?Number.NaN:1===Va?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:ia?(ia-=127,Va=Va*zd(gc,1)*Math.pow(2,ia)):Va=Va*zd(gc,0)*Math.pow(2,-126);Ea[Za]=Va}return Ea},zd=(V,Ea)=>{let Za=0;for(let ia=0;23>ia;ia++)Za+=(V>>
22-ia&1)/Math.pow(2,ia+1);return Ea+Za};class fe{constructor(V,Ea){this.zuk=null;this.ukm=0;this.Q8l=this.P8l=this.ONh=null;this.tkm=0;this.fUl=this.eUl=null;this.annotations=Ea.annotations;let Za=0;this.KXm=V.ka(Za);++Za;this.dUe=V.ka(Za);++Za;this.LXm=V.ka(Za);++Za;this.MXm=V.ka(Za);++Za;this.fUe=V.ka(Za);++Za;this.eUe=V.ka(Za);++Za;this.GXm=V.ka(Za);++Za;this.IXm=V.ka(Za);++Za;this.HXm=V.ka(Za);++Za;this.JXm=V.ka(Za);++Za;var ia=V.ka(Za);++Za;var Va=Array(ia);for(var Ab=0;Ab<ia;++Ab)Va[Ab]=Ea.j1(V.ka(Za)),
++Za;this.F0m=Bb.a.eUi(Va);this.kIn=V.ka(Za);++Za;this.i2n=V.ka(Za);++Za;ia=V.ka(Za);++Za;this.ZYl={};for(Va=0;Va<ia;++Va){Ab=Ea.j1(V.ka(Za));++Za;const gc=V.ka(Za);++Za;this.ZYl[Ab]=gc}this.rsk=V.ka(Za);++Za;this.yIn=V.ka(Za);++Za;ia=V.ka(Za);++Za;0<ia&&(ia=Ea.ild(V.ka(Za)),++Za,this.zuk=this.qWh(new Tf(ia)));++Za;V=Ea.ild(V.ka(Za));this.hWn(V)}qWh(V){return new bd(V.VAf,V.offset)}hWn(V){try{const Ea=new Tf(V);this.ukm=Ea.qZa();1===Ea.qZa()?this.ONh=Bb.a.eUi(kd(Ea,this.ukm)):this.ONh=null;const Za=
Ea.qZa();this.P8l=this.qWh(Ea);Ea.offset+=Za;const ia=Ea.qZa();this.Q8l=this.qWh(Ea);Ea.offset+=ia;this.tkm=Ea.qZa();const Va=Ea.qZa();this.eUl=this.qWh(Ea);Ea.offset+=Va;this.fUl=Bb.a.eUi(kd(Ea,this.tkm))}catch(Ea){throw Error.argument("byteReader");}}}Object(k.a)(fe,"TfIdfRankerNLModuleInit",null,[]);class Ye{constructor(V,Ea,Za,ia){this.LDk=V;this.J0l=Za;this.tokens=ia;this.Zob=Ea;this.u5e=-1;this.lZh=0}}Object(k.a)(Ye,"TokenizerData",null,[]);class pf{constructor(V){this.$b=V}execute(V){if(!V)throw Error.argumentNull("input");
if(!({value:ia}=V.zE(this.$b.Czc)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Ea;({value:Ea}=V.zE(this.$b.lMa)).returnValue||(Ea=0);let Za;({value:Za}=V.zE(this.$b.rXa)).returnValue||(Za=ia.length-Ea);if(0>Ea||Ea>ia.length)throw Error.argument("input","Start index out of range");if(0>Za||Za>ia.length)throw Error.argument("input","Length out of range");if(Ea+Za>ia.length)throw Error.argument("input","Bad start-length range");var ia=new Ye(ia,
Ea,Ea+Za,new tc.a(this.$b.annotations,Kf.Annotations.Gxa));this.mjo(ia);V=V.isReadOnly?V.clone():V;V.GU(this.$b.jkc,ia.tokens);return V}mjo(V){for(;V.Zob<V.J0l;){if(this.$b.qwj){var Ea=this.$b.qwj.$bm(V.LDk,V.Zob,V.J0l-V.Zob,null);!Ea.succeeded&&Ea.ckm&&(Ea=Ea.ckm);if(Ea.succeeded){this.Amm(V,Ea.length,this.$b.H5l);V.Zob+=Ea.length;continue}}Ea=V.LDk.substr(V.Zob);let Za=-1,ia=-1,Va=-1;for(let Ab=0;Ab<this.$b.RYh.length;++Ab){const gc=this.$b.RYh[Ab].exec(Ea);gc&&0<gc[1].length&&(0>Za||gc[0].length>
ia)&&(Za=Ab,ia=gc[0].length,Va=gc[1].length)}0<=Za?(this.Amm(V,Va,this.$b.Q3k[Za]),V.Zob+=Va):V.Zob+=1}}Amm(V,Ea,Za){if(this.$b.N$l)Za!==pf.l_m&&(0>V.u5e&&(V.u5e=V.Zob),V.lZh=V.Zob+Ea-V.u5e,Za===pf.k_m&&(0<=V.u5e&&0<V.lZh&&(Ea=new hh.a(this.$b.annotations),Ea.GU(this.$b.lMa,V.u5e),Ea.GU(this.$b.rXa,V.lZh),Ea.GU(this.$b.ozi,pf.m_m),Ea.GU(this.$b.Czc,V.LDk),Array.add(V.tokens.items,Ea)),V.u5e=-1,V.lZh=0));else{let ia=new hh.a(this.$b.annotations);ia.GU(this.$b.lMa,V.Zob);ia.GU(this.$b.rXa,Ea);ia.GU(this.$b.ozi,
Za);Array.add(V.tokens.items,ia)}}}pf.l_m="GAP";pf.k_m="EOS_CHUNK";pf.m_m="SENTENCE";Object(k.a)(pf,"TokenizerNLModule",null,[1087]);class Je{constructor(V,Ea){this.rXa=this.lMa=this.ozi=this.jkc=this.Czc=0;this.N$l=!1;this.Q3k=this.RYh=this.H5l=this.qwj=null;if(V){this.annotations=Ea.annotations;var Za=0;try{this.Czc=V.ka(Za);++Za;this.jkc=V.ka(Za);++Za;this.ozi=V.ka(Za);++Za;this.lMa=V.ka(Za);++Za;this.rXa=V.ka(Za);++Za;this.N$l=1===V.ka(Za);++Za;var ia=V.ka(Za);++Za;0<ia&&(this.qwj=Ea.Nlj(ia).obn);
this.H5l=V.ka(Za)?Ea.j1(V.ka(Za)):"";++Za;const Va=V.ka(Za);++Za;this.RYh=Array(Va);this.Q3k=Array(Va);for(ia=0;ia<Va;++ia)this.RYh[ia]=new RegExp(Ea.j1(V.ka(Za))),++Za,this.Q3k[ia]=Ea.j1(V.ka(Za)),++Za}catch(Va){throw Error.argument("initData");}}}}Object(k.a)(Je,"TokenizerNLModuleInit",null,[]);class Ff{constructor(V){this.$b=V}execute(V){if(!V)throw Error.argumentNull("input");let Ea;if(!({value:Ea}=V.zE(this.$b.cSl)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");
for(const Za of this.$b.cnl)Ea=Za.apply(Ea);V=Kf.Annotations.Zva(V);V.GU(this.$b.dSl,Ea);return V}static Yxi(V,Ea){const Za=new Sys.StringBuilder;for(let ia=0;ia<V.length;++ia)Za.append(Ea(V.substr(ia,1)));return Za.toString()}}Object(k.a)(Ff,"TransliteratorNLModule",null,[1087]);class Cg{constructor(V){V&&(this.style=V.ka(0))}apply(V){return Ff.Yxi(V,Ea=>Cg.V_m(Ea,this.style))}static V_m(V,Ea){switch(Ea){case 0:return V.toLowerCase();case 1:return"I"===V?"\u0131":V.toLowerCase();case 2:return V.toUpperCase();
case 3:return"i"===V?"\u0130":V.toUpperCase();default:throw Error.invalidOperation();}}}Cg.$Md=0;Object(k.a)(Cg,"ChangeCaseTransliterationStage",null,[1096]);class sh{apply(V){return Ff.Yxi(V,sh.xjo)}static xjo(V){const Ea=V.charCodeAt(0);return 65281<=Ea&&65374>=Ea?String.fromCharCode(Ea-65248):V}}sh.$Md=4;Object(k.a)(sh,"LatinFullWidthToHalfWidthTransliterationStage",null,[1096]);class Og{constructor(V,Ea){V&&(this.regex=Ea.c4l(V.ka(0)),this.replacement=Ea.j1(V.ka(1)))}apply(V){return V.replace(this.regex,
this.replacement)}}Og.$Md=1;Object(k.a)(Og,"RegexReplaceTransliterationStage",null,[1096]);class Ch{constructor(V,Ea){if(V){var Za=V.ka(0),ia=Ea.j1(V.ka(1)),Va=new bd(Ea.ild(V.ka(2)));V=0>V.ka(3)?null:new bd(Ea.ild(V.ka(3)));this.vol={};for(Ea=0;Ea<Za;++Ea)this.vol[ia.charAt(Ea).toString()]=ia.substr(Va.ka(Ea),V?V.ka(Ea):1)}}apply(V){return Ff.Yxi(V,Ea=>Ea in this.vol?this.vol[Ea]:Ea)}}Ch.$Md=2;Object(k.a)(Ch,"SingleCharSubstitutionsTransliterationStage",null,[1096]);class Pg{constructor(V,Ea){this.dSl=
this.cSl=0;this.cnl=null;if(V){this.annotations=Ea.annotations;var Za=0;try{this.cSl=V.ka(Za);++Za;this.dSl=V.ka(Za);++Za;const ia=V.ka(Za);++Za;this.cnl=Array(ia);for(let Va=0;Va<ia;++Va){const Ab=V.ka(Za);++Za;const gc=V.ka(Za);++Za;const Hc=new Bb.a;Hc.Ykd(V,Za,gc);Za+=gc;this.cnl[Va]=this.nWn(Ab,Hc,Ea)}}catch(ia){throw Error.argument("initData");}}}nWn(V,Ea,Za){switch(V){case Cg.$Md:return new Cg(Ea);case Og.$Md:return new Og(Ea,Za);case Ch.$Md:return new Ch(Ea,Za);case sh.$Md:return new sh;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");
}}}Object(k.a)(Pg,"TransliteratorNLModuleInit",null,[]);class ch{cjn(V,Ea){const Za=V.ka(0),ia=new Bb.a;ia.Ykd(V,1,V.count-1);switch(Za){case 0:return new Rd(new me(ia,Ea));case 2:return new pf(new Je(ia,Ea));case 3:return new Ic(new vd(ia,Ea));case 5:return new Xj(new Ij(ia,Ea));case 9:return new Ff(new Pg(ia,Ea));case 10:return new Tc(new fe(ia,Ea));default:throw Error.notImplemented();}}}Object(k.a)(ch,"NLModuleFactory",null,[1075]);class Fi{constructor(V){this.i_m=";";if(!V)throw Error.argumentNull("resource");
this.jhb=new sf(V,new $b,new ch);this.Jhk=this.jhb.Vin();this.Bcm=this.jhb.annotations.kZf("Text.Text");this.zcm=this.jhb.annotations.kZf("Classification.Predictions");this.o$j=this.jhb.annotations.kZf("Classification.PredictionString");this.Acm=this.jhb.annotations.kZf("Classification.Probability");this.xDn=this.jhb.annotations.kZf("NLMod.Tokens");if(0>this.Bcm||0>this.zcm||0>this.o$j||0>this.Acm)throw Error.argument("resourceObj","Resource does not represent a ranker");}Een(){const V=[];this.e5i(void 0,
this.X1l(V),null);return V}Gen(V,Ea){const Za=[],ia=[];this.e5i(V,this.X1l(Za),(Va,Ab)=>{const gc=this.jhb.annotations.T1l(Va),Hc=[],fd=[];Ea&&Ea.length&&-1===Array.indexOf(Ea,gc)||(Va=this.jhb.annotations.getAttributeType(Va),this.eqm(Va,Ab,Hc,fd),Ab=new Xg(gc,Hc,fd),Array.add(ia,Ab))});return new Ei(Za,ia)}Fen(V){const Ea=[];this.e5i(V,Za=>{let ia;if(({value:ia}=Za.zE(this.o$j)).returnValue){let Va;({value:Va}=Za.zE(this.Acm)).returnValue&&Array.add(Ea,new Hh(ia,Va))}},null);return Ea}e5i(V,Ea,
Za){var ia=new hh.a(this.jhb.annotations);ia.GU(this.Bcm,V);V=this.Jhk.execute(ia);if(({value:ia}=V.zE(this.zcm)).returnValue)for(const Va of ia.items)Ea(Va);if(Za&&({value:Ea}=V.zE(this.xDn)).returnValue)for(const Va of Ea.items)Va.IKh(Za)}eqm(V,Ea,Za,ia){if(Kf.Annotations.raa(V))for(var Va of Ea.items)this.eqm(Ea.fTa,Va,Za,ia);else if(Kf.Annotations.xDm(V)){Va=this.jhb.annotations.A3l(V);for(let Ab=0;Ab<Va;Ab++)Array.add(Za,this.jhb.annotations.K4l(V,Ab)),Array.add(ia,this.jhb.annotations.keb(this.jhb.annotations.i1d(V,
Ab),Ea.yld(Ab)))}else Array.add(Za,"VALUE"),Array.add(ia,this.jhb.annotations.keb(V,Ea))}X1l(V){return Ea=>{let Za;({value:Za}=Ea.zE(this.o$j)).returnValue&&Array.add(V,this.$jn(Za))}}$jn(V){const Ea=V.indexOf(this.i_m);return 0>Ea?V:V.substring(0,Ea)}}Object(k.a)(Fi,"Ranker",null,[]);class Gi{constructor(V,Ea){this.commandId=V;this.score=Ea}}Object(k.a)(Gi,"CommandSuggestion",null,[]);var $g=a(16);class gh{static OLb(V,Ea){if(Ea&&Ea.az){const Za={};for(const ia of V)Ea.AZe(ia)&&(Za[ia]=appChrome.selectors.getModelType(ia));
qe.instance.CE(Za)}}static ENc(V){const Ea=qe.instance.ufa();return!!Ea&&Ea.az&&!appChrome.selectors.isControlDisabled(V)}static vqi(V,Ea,Za){if(!(Ea&&Ea.results&&V&&V.results&&V.results.length))return{returnValue:!1,mqi:V,Zri:Ea};const ia=[];for(var Va of Ea.results)Array.add(ia,Va.value);Va=0;const Ab=0<Ea.results.length?Ea.results[0].score:0;for(const gc of V.results)if(gc.score>Za&&!Array.contains(ia,gc.value)&&gh.ENc(gc.value)&&(0<Ab&&(gc.score=Ab),Array.insert(Ea.results,Va,gc),Va++),2===Va)break;
return 0<Va?(Za=Ea.results.length-5,0<Za&&Ea.$Xk(Za),{returnValue:!0,mqi:V,Zri:Ea}):{returnValue:!1,mqi:V,Zri:Ea}}static VZe(V,Ea,Za,ia){if(qe.instance.lq()&&V){const Va=[];for(const Ab of V)Va.push(String.format('{{"Id":"{0}","Score":{1}}}',Ab.commandId,Ab.score));V={};V[ef.suggestions]="[{"+Va.join(",")+"}]";V[ef.Eam]=Ea;V[ef.groupType]=Za;V[ef.provider]=ia;qe.instance.lq().Zfa(Ga.N1m,window.performance.now(),V)}}static y0d(V,Ea,Za,ia,Va,Ab,gc,Hc){var fd,hd;Za.Jfj&&(Ea=gh.Efn(Za.Jfj,Ea));var yd=
ie.gfn(Ea);gh.OLb(yd,Za);const Md=[];var te=[];yd=[];const Pe=new Hb(gc);gc=16===gc||18===gc||7===gc||4===gc?$g.AFrameworkApplication_AppSettingsManager.ha?$g.AFrameworkApplication_AppSettingsManager.ha.Ac("TellMeMaxRecommendedResultsToReturn",3):3:0===gc||17===gc||25===gc?5:0;const t=qe.instance.klj(),L=ie.Bfn(Za),S=ie.ffn(Za),ka=null===(fd=$g.AFrameworkApplication_AppSettingsManager.ha)||void 0===fd?void 0:fd.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateTellMeSuggestions",!1);ie.vca(V)&&
(Za.mVn&&Za.AZe(L)&&gh.ENc(L)&&!t.qJf(L)&&Md.push(new hb(L,5,null,null,Hc)),ka&&Za.AZe(S)&&gh.ENc(S)&&!t.qJf(S)&&Md.push(new hb(S,5,null,null,Hc)));fd=ka&&ie.vca(V);for(const xb of Ea)if(!(gh.Lwn(xb.commandId)||fd&&gh.Xyn(xb.commandId))){Ea=gh.vio(xb.commandId);if(Za.AZe(xb.commandId)&&!Ea){if(ie.jam(xb.commandId))continue;Ea=null;Va&&Ab&&(Ea=Va.Cjn(xb.commandId,Ab));gh.ENc(xb.commandId)?Array.add(Md,new hb(xb.commandId,5,Ea,null,Hc,xb.score)):Array.add(te,new hb(xb.commandId,5,Ea,null,Hc,xb.score))}else Za.nLd&&
Ea&&ia&&Array.add(yd,xb.commandId.substr(21));if(Md.length+yd.length>=gc)break}Va=0;for(Ab=0;Ab<Md.length&&Va<gc;Ab++,Va++)Pe.hR(Md[Ab]);var ra=(hd=(Za="excel"===(null===(hd=null===Za||void 0===Za?void 0:Za.application)||void 0===hd?void 0:hd.toLowerCase())?ka:!0)?null===(ra=null===appChrome||void 0===appChrome?void 0:appChrome.api)||void 0===ra?void 0:ra.getSharedUxSettings():void 0)?hd.commonSettings:void 0;if(!Za||!ra||!ra().shouldHideDisabledButtonsFromTellMe())for(ra=0;ra<te.length&&Va<gc;ra++,
Va++)Pe.hR(te[ra]);for(te=0;te<yd.length&&Va<gc;te++,Va++)ia.Czo(V,yd[te],Pe);return Pe}static Efn(V,Ea){const Za=[],ia=[];for(const Va of Ea){Ea=Va.commandId;let Ab=Va;Va.commandId in V&&(Ea=V[Va.commandId],Ab=new Gi(Ea,Va.score));Array.contains(ia,Ea)||(Za.push(Ab),ia.push(Ea))}return Za}static Lwn(V){gh.oSl||($g.AFrameworkApplication_AppSettingsManager.ha&&$g.AFrameworkApplication_AppSettingsManager.ha.Zt("TellMeControlPredictionBlockList")&&$g.AFrameworkApplication_AppSettingsManager.ha.Fz("TellMeControlPredictionBlockList").forEach(Ea=>
{Array.add(gh.nSl,Ea.toLowerCase())}),gh.oSl=!0);return Array.contains(gh.nSl,V.toLowerCase())}static Xyn(V){!gh.qSl&&$g.AFrameworkApplication_AppSettingsManager.ha&&$g.AFrameworkApplication_AppSettingsManager.ha.Zt("TellMeZeroCaseSuggestionsBlockList")&&(gh.pSl=$g.AFrameworkApplication_AppSettingsManager.ha.Fz("TellMeZeroCaseSuggestionsBlockList"),gh.qSl=!0);return gh.pSl.includes(V.toLowerCase())}static vio(V){return V.startsWith("btnTellMeOfficeAddIn")}static Veg(V){return 2<V.length&&";"===V.charAt(0)&&
";"===V.charAt(V.length-1)&&!!$g.AFrameworkApplication_AppSettingsManager.ha&&($g.AFrameworkApplication_AppSettingsManager.ha.getBooleanAppSetting("TellMeCommandHookIsEnabled")||$g.AFrameworkApplication_AppSettingsManager.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}}gh.oSl=!1;gh.qSl=!1;gh.nSl=[];gh.pSl=[];Object(k.a)(gh,"CommandResultsUtilityHelper",null,[]);class Wi{static OLb(V,Ea){return gh.OLb(V,Ea)}static ENc(V){return gh.ENc(V)}static VZe(V,Ea,Za,
ia){return gh.VZe(V,Ea,Za,ia)}static y0d(V,Ea,Za,ia,Va,Ab,gc,Hc){return gh.y0d(V,Ea,Za,ia,Va,Ab,gc,Hc)}static Veg(V){return gh.Veg(V)}static l2l(V){const Ea=new Hb(0);var Za=V.split(";");V=qe.instance.ufa();for(const ia of Za)if(0<ia.length){Za=ia.split(":");const Va=2===Za.length?Za[0]:ia;if(!V.AZe(Va))break;if(1===Za.length)Za=new hb(Va,5,null,null,1),Ea.hR(Za);else if(2===Za.length)Za=new hb(Va,5,Za[1],null,1),Ea.hR(Za);else break}return Ea}static vqi(V,Ea,Za){return gh.vqi(V,Ea,Za)}}Object(k.a)(Wi,
"CommandResultsUtility",null,[]);class yj{constructor(V,Ea){this.ALl="";this.uii=null;this.vii=!1;this.NGb=null;this.nMm=["TellMe.TellMeParamCollection"];this.ie=V;this.hvc=Ea;this.ie.nLd&&(this.NGb=null)}get uXh(){if(!this.uii&&!this.vii){let V=null;try{V=window.TellMeModel}catch(Ea){if(qe.instance.lq())qe.instance.lq().onError("QueryRanker","TellMeModel not found. Exception: "+Ea)}if(V){try{this.uii=new Fi(V)}catch(Ea){if(qe.instance.lq())qe.instance.lq().onError("QueryRanker","Exception thrown while loading classifier. Exception: "+
Ea)}this.vii=!0}else if(qe.instance.lq())qe.instance.lq().onError("QueryRanker","Classifier model not found")}return this.uii}zfa(){return"Command"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:2}L$(V,Ea,Za=!1,ia=hf.lH,Va=null){const Ab=new mc(V);if((!Va||Array.contains(Va,0))&&!ie.vca(V)){if(!this.uXh&&this.vii){if(qe.instance.lq())qe.instance.lq().onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.ie.nLd&&
this.NGb&&this.NGb.initialize();if(Wi.Veg(V.gm)&&(Va=Wi.l2l(V.gm),0<Va.results.length)){Va.displayName="Classifier Debug";Ab.$M(Va);Ea.zF(Ab);return}Va=V?this.ALl=V.gm:this.ALl;if(l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeParameterizedQueriesEnabled")){Va=this.bkn(Va);var gc=this.kLh(Va.Lnj());Va=Va.J1l()}else Va=this.akn(Va),gc=this.ifn(Va),Va=[];Wi.VZe(gc,!1,"Classifier","TFIDF");gc=Wi.y0d(V,gc,this.ie,this.NGb,this.hvc,Va,0,1);0<gc.results.length&&ia!==hf.contextMenu&&(gc.displayName=
Object(Wa.a)("TellMeCommandProviderTitle"));Za||gc.results.length||this.ie.Dsb||this.ie.Dib||(V=new hb("lookupNoResults",14,V.gm,null,1),gc.hR(V));0<gc.results.length&&Ab.$M(gc);Ab.attributes=Va}Ea.zF(Ab)}Lnj(){let V=[];try{V=this.uXh.Een()}catch(Ea){if(qe.instance.lq())qe.instance.lq().onError("GetPredictions","Exception: "+Ea)}return V}akn(V){let Ea=[];try{Ea=this.uXh.Fen(V)}catch(Za){if(qe.instance.lq())qe.instance.lq().onError("GetPredictionsWithScore","Exception: "+Za)}return Ea}bkn(V){try{return this.uXh.Gen(V,
this.nMm)}catch(Ea){if(qe.instance.lq())qe.instance.lq().onError("GetPredictionsWithTokenAttributes","Exception: "+Ea)}return new Ei([],[])}kLh(V){const Ea=[];if(V)for(const Za of V)Ea.push(new Gi(Za,-99999));return Ea}ifn(V){const Ea=[];if(V)for(const Za of V)Ea.push(new Gi(Za.prediction,Za.score));return Ea}}Object(k.a)(yj,"CommandResultsProvider",null,[749]);class qk extends hb{constructor(V,Ea,Za,ia,Va=null){super(V,Ea,Va,null,Za);this.id=ia}}Object(k.a)(qk,"TryQueryResultBinding",hb,[]);class Jj{constructor(V,
Ea,Za,ia){this.WPb=V;this.Chd=Ea;this.vOl=ia;this.VNm=Za;this.ie=qe.instance.ufa()}zfa(){return"EmptyQuery"}uwa(){return 1===this.ie.kN?1:0}L$(V,Ea,Za=!1,ia,Va=null){ia=new mc(V);if((!Va||Array.contains(Va,5)||Array.contains(Va,6)||Array.contains(Va,4))&&ie.vca(V)){this.WPb.V_f().length||!this.VNm||this.vOl||(V=new Hb(6),Va=new hb(null,13,void 0,void 0,1),V.hR(Va),ia.$M(V));V=new Hb(4);if(0<this.WPb.V_f().length){V.displayName=Object(Wa.a)("TellMeRecentlyUsedTitle");Va=this.WPb.V_f();var Ab=[];for(var gc of Va)Ab.push(gc.Id);
gh.OLb(Ab,this.ie);for(var Hc of Va)gh.ENc(Hc.Id)&&V.hR(new hb(Hc.Id,5,null,null,2));ia.$M(V)}if(this.vOl&&0<this.Chd.length&&this.WPb.V_f().length<Jj.maxResults){gc=new Hb(5);gc.displayName=Object(Wa.a)("TellMeTryQueryTitle");Hc=Jj.maxResults-V.results.length;V=[];for(Va=0;Va<this.Chd.length&&Va<Hc;++Va){if(Za){Ab=ie.uwl+(Va+1);const fd=this.Chd[Va].key,hd=la.a.replaceAll(fd,'"',"");V.push(appChrome.actions.setControlLabel(Ab,fd));V.push(appChrome.actions.setButtonCommandValueId(Ab,hd));Ab=new qk(fd,
7,0,hd,Ab)}else Ab=new qk(this.Chd[Va].key,7,0,this.Chd[Va].value);gc.hR(Ab)}0<V.length&&appChrome.api.dispatch(V);ia.$M(gc)}}Ea.zF(ia)}}Jj.maxResults=5;Object(k.a)(Jj,"EmptyQueryResultsProvider",null,[749]);class Ai{constructor(V){this.ie=V}zfa(){return"Feedback"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:2}L$(V,Ea,Za,ia,Va=null){V=new mc(V);if(!Va||Array.contains(Va,21))Va=[],Va.push(appChrome.actions.setControlLabel("TellMeFeedback",Object(Wa.a)("TellMeFeedbackText"))),appChrome.api.dispatch(Va),
Va=new Hb(22),Va.displayName="",Va.hR(new hb("TellMeFeedback",23,null,null,1)),V.$M(Va);Ea.zF(V)}}Object(k.a)(Ai,"FeedbackResultsProvider",null,[749]);class Rk{constructor(V,Ea,Za,ia){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=V;this.CommandId=Ea;this.CommandValueId=Za;this.InputText=ia}}Object(k.a)(Rk,"FindInDocumentProp",null,[]);class dj{constructor(V){this.pfi=2;this.hDd=[];this.Xgd=[];this.ie=V;dj.XXb=V.A0l;dj.C0l="FindInDocumentSuggestion";dj.Bpm="FindInDocumentSuggestion3";
this.hPm=Object.assign(new If.a,{landingTab:"Indoc",data:null});this.rRm=this.ie.Usd||!!l.AFrameworkApplication.Ha&&l.AFrameworkApplication.Ha.Ib.Usd}zfa(){return"FindInDocument"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:3===this.ie.kN?this.ie.vAm?2:3:2}L$(V,Ea,Za=!1,ia,Va=null){const Ab=new mc(V);if(Va&&!Array.contains(Va,2))Ea.zF(Ab);else if(Array.clear(this.hDd),ie.vca(V)){if(Za&&this.tzm()){Za=new Hb(2);Za.displayName=Object(Wa.a)("TellMeFindInDocProviderTitle");Va=1;ia="";if(0<this.Xgd.length&&
!this.ie.c6e)for(var gc of this.Xgd)if(""!==gc.Label.toLowerCase()){if(Va>=this.pfi)break;this.BEm(Za,gc.Label,gc.CommandValueId,dj.C0l+Va,gc.InputText);Va++}gc="";this.ie.doa?(Ab.$M(Za),Za=new Hb(3),gc=this.ie.Fid?ie.gld(Object(Wa.a)("TellMeOpenFindPaneTextV2Bolded")):Object(Wa.a)("TellMeOpenFindPaneTextV2")):gc=Object(Wa.a)("TellMeOpenFindPaneText");ia=this.k2l("");this.BEm(Za,gc,ia,dj.Bpm,"");Ab.$M(Za)}Ea.zF(Ab)}else gc="",Za&&(Za=this.k2l(V.gm),ia=[],this.ie.jnd?(this.ie.ril&&ia.push(appChrome.actions.setControlIconSet(dj.XXb,
{"default":"FindInDocument_20"})),gc=this.ie.FYj?ie.Bij(V.gm,Object(Wa.a)("FindInDocumentScopedButtonText")):V.gm+Object(Wa.a)("FindInDocumentScopedButtonText")):this.ie.doa?(gc=this.ie.Fid?ie.gld(String.format(Object(Wa.a)("FindInDocumentScopedButtonTextV2Bolded"),V.gm)):String.format(Object(Wa.a)("FindInDocumentScopedButtonTextV2"),V.gm),ia.push(appChrome.actions.setControlIconSet(dj.XXb,{"default":"FindInDocument_20"}))):gc=this.ie.c6e?Object(Wa.a)("TellMeOpenFindPaneText"):String.format(Object(Wa.a)("TextWithQuotation"),
V.gm),this.ie.LIb?(qe.instance.actions.push(appChrome.actions.setControlLabel(dj.XXb,gc)),qe.instance.actions.push(appChrome.actions.setButtonCommandValueId(dj.XXb,Za))):(ia.push(appChrome.actions.setControlLabel(dj.XXb,gc)),ia.push(appChrome.actions.setButtonCommandValueId(dj.XXb,Za)),appChrome.api.dispatch(ia)),this.wym(gc,dj.XXb,Za,V.gm)),this.ie.vAm?(gc=new hb(dj.XXb,8,V.gm),Za=new Hb(2),Za.displayName=Object(Wa.a)("TellMeFindInDocProviderTitle"),Za.hR(gc),Ab.$M(Za),Ea.zF(Ab)):this.ie.jhn().then(Hc=>
{const fd=new hb(dj.XXb,8,V.gm,null,1);fd.count=Hc;Hc=new Hb(2);Hc.displayName=Object(Wa.a)("TellMeFindInDocProviderTitle");Hc.hR(fd);Ab.$M(Hc);Ea.zF(Ab)},Hc=>{qe.instance.lq().onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+Hc);Hc=new hb(dj.XXb,8,V.gm,null,1);const fd=new Hb(2);fd.displayName=Object(Wa.a)("TellMeFindInDocProviderTitle");fd.hR(Hc);Ab.$M(fd);Ea.zF(Ab)})}tzm(){return!!this.ie&&this.ie.x_h}BEm(V,Ea,Za,ia,Va=null){const Ab=[];Ea&&Ab.push(appChrome.actions.setControlLabel(ia,
Ea));this.ie.doa&&Ab.push(appChrome.actions.setControlIconSet(ia,{"default":"FindInDocument_20"}));Ab.push(appChrome.actions.setButtonCommandValueId(ia,Za));appChrome.api.dispatch(Ab);this.wym(Ea,ia,Za,"");V.hR(new hb(ia,8,Va,null,1,-99999))}k2l(V){return this.rRm?ie.nDc(V,15,this.hPm):la.a.We(V)}wym(V,Ea,Za,ia){this.tzm()&&this.hDd.length<this.pfi&&(V=new Rk(V,Ea,Za,ia),Array.add(this.hDd,V))}$ao(V){for(let Ea=0;Ea<this.hDd.length;Ea++)if(this.hDd[Ea].CommandId===V){const Za=this.hDd[Ea].Label;let ia=
!1;if(0<this.Xgd.length){let Va=0;for(const Ab of this.Xgd){if(Ab.Label===Za){Array.removeAt(this.Xgd,Va);ia=!0;break}Va++}}!ia&&this.Xgd.length>=this.pfi-1&&Array.removeAt(this.Xgd,1);Array.insert(this.Xgd,0,this.hDd[Ea])}}}dj.XXb=null;dj.C0l=null;dj.Bpm=null;Object(k.a)(dj,"FindInDocumentResultsProvider",null,[749]);class Bi{constructor(V){this.ie=V}zfa(){return"Image"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:3===this.ie.kN?3:2}L$(V,Ea,Za,ia,Va=null){Za=new mc(V);(!Va||Array.contains(Va,19))&&
ie.vca(V)&&this.ie.doa&&this.gmd(V,Za,1);Ea.zF(Za)}gmd(V,Ea,Za,ia=null){var Va=[];let Ab;qe.instance.ufa()&&qe.instance.ufa().jnd?(Ab=this.ie.FYj?ie.Bij(V.gm,Object(Wa.a)("TellMeImageSuggestionScopedButtonTextNoHeader")):V.gm+Object(Wa.a)("TellMeImageSuggestionScopedButtonTextNoHeader"),this.ie.ril||Va.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):Ab=this.ie.doa?ie.vca(V)?this.ie.Fid?ie.gld(Object(Wa.a)("TellMeImageSuggestionButtonTextV2Bolded")):Object(Wa.a)("TellMeImageSuggestionButtonTextV2"):
this.ie.Fid?ie.gld(String.format(Object(Wa.a)("TellMeScopedImageSuggestionButtonTextBolded"),V.gm)):String.format(Object(Wa.a)("TellMeScopedImageSuggestionButtonText"),V.gm):this.ie.c6e?Object(Wa.a)("TellMeImageSuggestionButtonText"):V.gm+Object(Wa.a)("TellMeImageSuggestionScopedButtonTextWithHeader");this.ie.LIb?(qe.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",Ab)),Va=ie.nDc(V.gm,9,Object.assign(new If.a,{landingTab:"Image"})),qe.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",
Va))):(Va.push(appChrome.actions.setControlLabel("ImageForSearch",Ab)),V=ie.nDc(V.gm,9,Object.assign(new If.a,{landingTab:"Image"})),Va.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",V)),appChrome.api.dispatch(Va));Za=new hb("ImageForSearch",12,null,null,Za);ia&&(Za.score=ia.ConfidenceScore);ia=new Hb(19,this.ie.c6e?Object(Wa.a)("TellMeImageTitleV2"):Object(Wa.a)("TellMeImageTitle"));ia.hR(Za);Ea.$M(ia)}}Object(k.a)(Bi,"ImageResultsProvider",null,[749]);class sj{constructor(V){this.ie=
V}zfa(){return"Insights"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:2}L$(V,Ea,Za=!1,ia,Va=null){ia=new mc(V);if(!Va||Array.contains(Va,13))if(this.xdo()||!ie.vca(V)){Va=new Hb(13);var Ab=""===V.gm.trim(),gc=Ab?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",Hc=new hb(gc,10,V.gm,null,1);Za&&(Za=null,ie.Utb()?Ab?Ab=Object(Wa.a)("SeeMoreOpenSearchPaneLabel"):(Ab=this.ie.c6e?Object(Wa.a)("SeeMoreResultsButtonTextNonParameteriedV2"):String.format(Object(Wa.a)("SeeMoreResultsButtonText"),V.gm),
Za=ie.nDc(V.gm,1)):(Ab=String.format(Object(Wa.a)("InsightsButtonText"),V.gm),Za=ie.AUi(V.gm)),this.ie.LIb?(qe.instance.actions.push(appChrome.actions.setControlLabel(gc,Ab)),Za&&qe.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Za))):(V=[],V.push(appChrome.actions.setControlLabel(gc,Ab)),Za&&V.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Za)),appChrome.api.dispatch(V)),Hc.label=Ab);Va.hR(Hc);ia.$M(Va)}Ea.zF(ia)}xdo(){return ie.Utb()&&
this.ie.fio&&!this.ie.Ffb}}Object(k.a)(sj,"InsightsResultsProvider",null,[749]);class tl{constructor(V){this.ie=V}zfa(){return"Learning"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:2}L$(V,Ea,Za,ia,Va=null){Za=new mc(V);Va&&!Array.contains(Va,21)||!ie.vca(V)||(Va=[],ia=this.ie.HAn,Va.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",ia)),ia=tl.whn(ia),Va.push(appChrome.actions.setControlLabel("LearningForSearch",ia)),appChrome.api.dispatch(Va),V=new hb("LearningForSearch",22,V.gm,
null,1),Va=new Hb(21),Va.hR(V),Za.$M(Va));Ea.zF(Za)}static whn(V){const Ea=[];Array.add(Ea,new Ad(600,Object(Wa.a)("TellMeLearningButtonTipText")));Array.add(Ea,new Ad(400,Object(Wa.a)("TellMeLearningButtonText")));Array.add(Ea,new Ad(600,V));Array.add(Ea,new Ad(400,Object(Wa.a)("TellMeLearningButtonPunctuation")));V={};V.parts=Ea;return JSON.stringify(V)}}Object(k.a)(tl,"LearningProvider",null,[749]);var El=a(1283);class ej{constructor(V,Ea){this.nSe=this.bTe=this.khd=this.cEh=null;this.jG=!1;this.sSe=
V;this.eNm=Ea;V&&this.I_l(V)}N1h(){this.sSe.N1h()&&this.I_l(this.sSe)}jmn(V){let Ea=[];var Za=[];V=ej.hPn(V);var ia="";Array.clear(Za);for(let Va=0;Va<V.length;Va++){const Ab=V.charAt(Va);-1!==" ".indexOf(Ab)?(ia.length&&Array.add(Za,ia),ia=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(Ab)?(ia.length&&Array.add(Za,ia),ia=Ab,Array.add(Za,ia),ia=""):ia+=Ab}ia.length&&Array.add(Za,ia);for(V=0;V<Za.length;V++)ia=this.hfn(Za[V]),ia=this.$2m(ia),Ea=ej.DIn(Ea,ia);return Ea=this.lUm(Ea)}iUj(){this.jG||
this.N1h();return this.jG}HIh(V){return this.cEh[V.toString()]}lUm(V){for(let Ea=0;Ea<V.length;Ea++){const Za=this.khd[Ea];if(V[Ea].commandId!==this.HIh(Za[0]))throw Error.create("Incorrect Tcid orders with Priors data");let ia;(ia=V[Ea]).score=ia.score+Za[1]}return V}$2m(V){const Ea=[];for(var Za=0;Za<this.khd.length;Za++)Ea.push(new Gi(this.HIh(this.khd[Za][0]),-5));Za=new El.a;for(var ia=0;ia<V.length;ia++)Za.add(this.HIh(V[ia][0]));for(ia=0;ia<Ea.length;ia++){const Ab=Ea[ia];for(let gc=0;gc<V.length;gc++){var Va=
V[gc];const Hc=this.HIh(Va[0]);Va=Va[1];if(Hc===Ab.commandId){Ab.score=Va;Za.remove(Hc);break}}if(!Za.count)break}return Ea}hfn(V){const Ea=1>V.length;for(let gc=0;2>=gc;gc++){const Hc=this.nSe;for(const fd in Hc){var Za=Hc[fd],ia=V,Va=fd;const hd=Va.length+1,yd=Array((ia.length+1)*hd);for(var Ab=0;Ab<=ia.length;Ab++)yd[Ab*hd]=Ab;for(Ab=0;Ab<=Va.length;Ab++)yd[Ab]=Ab;for(Ab=0;Ab<Va.length;Ab++)for(let Md=0;Md<ia.length;Md++)yd[(Md+1)*hd+(Ab+1)]=ia.charAt(Md)===Va.charAt(Ab)?yd[Md*hd+Ab]:Math.min(Math.min(yd[Md*
hd+(Ab+1)]+1,yd[(Md+1)*hd+Ab]+1),yd[Md*hd+Ab]+1);ia=yd[ia.length*hd+Va.length];if((!ia||!Ea)&&ia<=gc)return Za}}return this.bTe}I_l(V){this.cEh=V.Hlj();this.khd=V.gkn();this.bTe=V.fnn();this.nSe=V.fin();if(this.jG=!!this.cEh&&!!this.khd&&!!this.nSe&&!!this.bTe)this.jG=0<this.khd.length&&ej.BNj(this.khd);this.jG&&(this.jG=0<this.bTe.length&&ej.BNj(this.bTe));this.jG&&(this.nSe=ej.qnn(this.nSe));this.jG||(this.nSe=this.bTe=this.khd=this.cEh=null)}Xmn(V){V=this.jmn(V);return this.lbn(V,this.eNm)}lbn(V,
Ea){let Za=[];for(let ia=0;ia<V.length;ia++)V[ia].score>=Ea&&Za.push(V[ia]);Za.sort((ia,Va)=>ia.score<Va.score?1:ia.score>Va.score?-1:0);0<Za.length-10&&(Za=Za.slice(0,10));return Za}static DIn(V,Ea){if(!V.length)return Ea;if(V.length!==Ea.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let Za=0;Za<V.length;Za++){if(V[Za].commandId!==Ea[Za].commandId)throw Error.create("Incorrect CommandId");let ia;(ia=V[Za]).score=ia.score+Ea[Za].score}return V}static hPn(V){return la.a.ph(V)}static BNj(V){for(let Ea=
0;Ea<V.length;Ea++)if(2!==V[Ea].length)return!1;return!0}static qnn(V){const Ea={};for(const Va in V){var Za=Va,ia=V[Va];const Ab=ia;Ab.length&&ej.BNj(Ab)&&(Ea[Za]=ia)}return Ea}}Object(k.a)(ej,"NaiveBayesClassifierModel",null,[]);class Fl{constructor(V,Ea){this.NGb=null;this.ie=V;this.enf=new ej(Ea,V.t3l);this.ie.nLd&&(this.NGb=null)}zfa(){return"NBCommand"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:2}L$(V,Ea,Za=!1,ia=hf.lH,Va=null){const Ab=new mc(V);if((!Va||Array.contains(Va,0))&&!ie.vca(V)){if(Wi.Veg(V.gm)&&
(Va=Wi.l2l(V.gm),0<Va.results.length)){Va.displayName="Classifier Debug";Ab.$M(Va);Ea.zF(Ab);return}if(!this.enf.iUj()){if(qe.instance.lq())qe.instance.lq().onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.ie.nLd&&this.NGb&&this.NGb.initialize();Va=this.enf.Xmn(V.gm);Wi.VZe(Va,!1,"Classifier","NaiveBayesian");Va=Wi.y0d(V,Va,this.ie,this.NGb,null,null,0,1);0<Va.results.length&&ia!==hf.contextMenu&&
(Va.displayName=Object(Wa.a)("TellMeCommandProviderTitle"));Za||Va.results.length||this.ie.Dsb||this.ie.Dib||(V=new hb("lookupNoResults",14,V.gm,null,1),Va.hR(V));0<Va.results.length&&Ab.$M(Va)}Ea.zF(Ab)}}Object(k.a)(Fl,"NaiveBayesCommandProvider",null,[749]);class fj{constructor(){this.aDd=null;this.jG=!1;this.N1h()}N1h(){this.jG||(this.aDd=window.NBCRM)&&4===this.aDd.length&&(this.jG=!0);return this.jG}gkn(){return this.jG?this.aDd[1]:null}fnn(){return this.jG?this.aDd[2]:null}fin(){return this.jG?
this.aDd[3][0]:null}Hlj(){return this.jG?this.aDd[0][0]:null}}Object(k.a)(fj,"NaiveBayesModelAdapter",null,[989]);var Th=a(142);class Ih{constructor(V){this.ie=V}zfa(){return"OfficeScript"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:2}L$(V,Ea){const Za=new mc(V);if(!ie.vca(V)){V=Th.d(V.gm);var ia=new Hb(28);ia.displayName=Object(Wa.a)("TellMeOfficeScriptsTitle");ia=this.pPl(V,Ih.alo,"OfficeScriptsUnhideAllRowsCols","samples-11",Object(Wa.a)("TellMeUnhideAllRowsColsTitle"),ia);ia=this.pPl(V,Ih.tcn,
"OfficeScriptsFreezeSelection","samples-12",Object(Wa.a)("TellMeFreezeSelectionTitle"),ia);Za.$M(ia)}Ea.zF(Za)}pPl(V,Ea,Za,ia,Va,Ab){const gc=[];for(const Hc of Ea)if(Th.a(V,Hc)){this.ie.LIb?(qe.instance.actions.push(appChrome.actions.setControlLabel(Za,Va)),qe.instance.actions.push(appChrome.actions.setButtonCommandValueId(Za,ia))):(gc.push(appChrome.actions.setControlLabel(Za,Va)),gc.push(appChrome.actions.setButtonCommandValueId(Za,ia)),appChrome.api.dispatch(gc));Ab.hR(new hb(Za,28,null,null,
1));break}return Ab}}Ih.alo="unhide row rows col cols column columns".split(" ");Ih.tcn=["freeze","selection","pane","panes"];Object(k.a)(Ih,"OfficeScriptsSamplesProvider",null,[749]);class Uh{}Uh.Blc="HttpRequest";Uh.provider="Provider";Object(k.a)(Uh,"LatencyTypes",null,[]);var si;(function(V){V[V.Rpo=0]="Classifier";V[V.qpo=1]="AppsForOffice";V[V.JHm=2]="FindInDocument";V[V.kro=3]="FindInDocumentScopedSearch";V[V.Pto=4]="RecentlyUsed";V[V.NKm=5]="TryQuery";V[V.Empty=6]="Empty";V[V.Ruo=7]="TryCommand";
V[V.oGm=8]="Assistance";V[V.mGm=9]="Answer";V[V.Definition=10]="Definition";V[V.sHm=11]="Entity";V[V.aLm=12]="WolframAnswer";V[V.oIm=13]="Insights";V[V.FJm=14]="People";V[V.Document=15]="Document";V[V.Qto=16]="Recommended";V[V.kuo=17]="ServiceClassifier";V[V.luo=18]="ServiceRecommended";V[V.Image=19]="Image";V[V.Notes=20]="Notes";V[V.LIm=21]="Learning";V[V.Feedback=22]="Feedback";V[V.IKm=23]="Template";V[V.fGl=24]="ActionAI";V[V.fGm=25]="ActionAICommand";V[V.F5h=26]="SummarizeDeck";V[V.hGm=27]="Addin";
V[V.tJm=28]="OfficeScript";V[V.iGm=29]="AddinStoreEntry";V[V.None=30]="None";V[V.Lso=31]="MergedActions";V[V.Mso=32]="MergedScopedSearches";V[V.Nso=33]="MergedSuggestedSearches"})(si||(si={}));Object(k.b)("ResultGroupType",si);class bj{}bj.lH="TellMe";bj.Ybm="Loki";bj.OBm="Substrate";bj.W3e="QueryIndex";bj.jCm="TellMeRanker";bj.kCm="TellMeRankerLogging";Object(k.a)(bj,"Services",null,[]);class Dh{constructor(V){this.Yoa=null;this.gKa=-1;this.qrk=14;this.urk=12;this.attributes=this.hni=this.query=
null;this.rZe=!1;this.HSe=[];this.Dn=l.AFrameworkApplication.$d;l.AFrameworkApplication.ha&&(this.qrk=l.AFrameworkApplication.ha.Ac("TellMeMaxTermedResults",this.qrk),this.urk=l.AFrameworkApplication.ha.Ac("TellMeMaxZeroTermResults",this.urk));this.usa=V}get FA(){return this.HSe}get V1h(){return this.hni}$M(V){let Ea=!1;for(let Za=0;Za<this.FA.length;Za++)if(30!==this.FA[Za].groupType&&this.FA[Za].groupType===V.groupType){this.kri(this.FA[Za],V);Ea=!0;break}Ea||this.FA.push(V)}kri(V,Ea){for(let Za=
0;Za<Ea.results.length;Za++)V.hR(Ea.results[Za])}Mtm(V){const Ea=[];for(const Za of this.FA)Za.groupType!==V&&Ea.push(Za);this.FA.length!==Ea.length&&(this.HSe=Ea)}a6n(V){let Ea=null,Za=null,ia=null;for(let Va=0;Va<V.length;Va++){const Ab=V[Va];if(Ab&&Ab.FA&&Ab.FA.length)for(const gc of Ab.FA)if(17===gc.groupType||18===gc.groupType)Ea=gc;else if(0===gc.groupType||16===gc.groupType)Za=gc,ia=Ab}Ea&&Za&&0<Za.results.length&&(17===Ea.groupType&&({mqi:Za,Zri:Ea}=gh.vqi(Za,Ea,this.usa.ufa()?this.usa.ufa().Xen:
-.6)),ia.Mtm(Za.groupType))}hgo(){this.usa&&(new Zb.a,this.Toh(this.usa.khm))}ckg(V,Ea){return this.query.gm.length>this.usa.ufa().okn&&this.dyn(V,Ea)||this.query.gm.length>this.usa.ufa().pkn&&this.Wyn(V,Ea)?!0:!1}Wyn(V,Ea){return V&&V.length&&Ea&&Ea.length?-1===Ea.toLowerCase().indexOf(V.toLowerCase())?!1:!0:!1}dyn(V,Ea){return V&&V.length&&Ea&&Ea.length?Ea.toLowerCase().startsWith(V.toLowerCase()):!1}nbn(V){const Ea=[];for(const Za of this.usa.ufa().doa?this.V1h:this.FA)V.contains(Za.groupType)||
Ea.push(Za);this.usa.ufa().doa?this.hni=Ea:this.HSe=Ea}Bmo(V,Ea){const Za=[];for(const ia of this.FA){const Va=ia;if(13!==Va.groupType||24!==Va.groupType){const Ab=V[si[Va.groupType].toLowerCase()];let gc="False";Ab<Ea&&(gc="True");Va.displayName=Va.displayName+" ("+gc+": "+Ab+")"}Za.push(Va)}this.HSe=Za}Toh(V,Ea=!1,Za=null){if(this.usa.ufa().doa){if(!Ea)for(this.hni=Array(this.FA.length),Ea=0;Ea<this.FA.length;Ea++)this.V1h[Ea]=this.FA[Ea];this.usa.Vhm.Toh(this.FA,this.V1h,this.query,V,Za)}else{for(Za=
new Zb.a;this.FA.length;){Ea=this.FA.pop();const ia=si[Ea.groupType].toLowerCase(),Va=V[ia];if(Le.b(Va))throw Error.create("GroupId "+ia+" missed from group SortingOrder");Za.add(new Nc.a(Va,Ea))}Za.Sc((ia,Va)=>ia.key<Va.key?-1:1);for(V=0;V<Za.count;V++)Ea=Za.ka(V).value,this.FA.push(Ea)}}igo(){var V=!1;let Ea=!1,Za=!1;for(let Va=0;Va<this.FA.length;Va++){var ia=this.FA[Va];const Ab=ia.groupType;if(8===Ab||15===Ab||14===Ab){ia=ia.results;for(let gc=0;gc<ia.length;gc++){if(8===Ab&&this.ckg(this.query.gm,
ia[gc].label)){V=!0;break}if(15===Ab&&this.ckg(this.query.gm,ia[gc].label)){Ea=!0;break}if(14===Ab){if(this.ckg(this.query.gm,ia[gc].label)||this.ckg(this.query.gm,ia[gc].description)){Za=!0;break}const Hc=ia[gc].label.split(" ");for(const fd of Hc)if(this.ckg(this.query.gm,fd)){Za=!0;break}}}}}V=this.usa.Jkn(V,Ea,Za);this.Toh(V)}vve(V,Ea,Za,ia,Va,Ab){if(Va===this.Yoa){var gc=V.data.responseData;Va=null;try{Va=Ka.b(gc)}catch(L){qe.instance.lq().onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+
L);return}if("RankerResults"in Va&&Va.RankerResults){this.QUb();var Hc=Va.RankerResults,fd=new Zb.a,hd=new Zb.a;gc=0;for(var yd of Hc){Hc=yd.ProviderId;var Md=yd.Score;gc+=Md;fd.add(new Nc.a(Hc,Md))}fd.Sc((S,ka)=>S.value>ka.value?-1:1);Md=Ab?Ab.mln:1E-6;yd={};Hc={};let L=0;for(var te=0;te<fd.count;te++){const S=parseInt(fd.ka(te).key),ka=fd.ka(te).value/gc;1===S&&(Hc.answer=L++,Hc.entity=L++,Hc.definition=L++,Hc.wolframanswer=L++,ka<Md&&(hd.add(9),hd.add(11),hd.add(10),hd.add(12)),yd.answer=ka,yd.entity=
ka,yd.definition=ka,yd.wolframanswer=ka);2===S&&(Hc.assistance=L++,ka<Md&&hd.add(8),yd.assistance=ka);3===S&&(Hc.classifier=L++,Hc.serviceclassifier=L++,ka<Md&&(hd.add(0),hd.add(17)),yd.classifier=ka,yd.serviceclassifier=ka);4===S&&(Hc.people=L++,ka<Md&&hd.add(14),yd.people=ka);5===S&&(Hc.document=L++,ka<Md&&hd.add(15),yd.document=ka);6===S&&(Hc.findindocument=L++,ka<Md&&hd.add(2),yd.findindocument=ka);7===S&&(Hc.notes=L++,ka<Md&&hd.add(20),yd.notes=ka);8===S&&(Hc.image=L++,ka<Md&&hd.add(19),yd.image=
ka)}fd=new Zb.a;fd.add("classifier");fd.add("serviceclassifier");fd.add("appsforoffice");fd.add("addin");fd.add("findindocument");fd.add("assistance");fd.add("document");fd.add("people");fd.add("answer");fd.add("wolframanswer");fd.add("definition");fd.add("entity");fd.add("image");fd.add("template");fd.add("officescript");for(te=0;te<fd.count;te++)fd.ka(te)in Hc||(Hc[fd.ka(te)]=L++);Hc.learning=L++;Hc.insights=L++;Hc.actionai=L++;Hc.actionaicommand=L++;Hc.feedback=L++;Ab&&Ab.Jxn&&this.Bmo(yd,Md);
Ab&&Ab.Kxn&&this.nbn(hd);hd={};for(var Pe in yd)hd[Pe]=yd[Pe]*gc;this.Toh(Hc,!0,hd)}if(Ab.aPh&&"Intents"in Va&&Va.Intents){Pe=Va.Intents;for(var t of Pe)if(this.a_j(t)&&"Serplet"===t.GroupType&&t.ConfidenceScore>t.ConfidenceThreshold){Pe=!1;Va=0;if(Ab.VXj){gc=new hb("",32);for(hd=0;hd<this.FA.length;hd++)if((fd=this.FA[hd].results)&&0<fd.length){Va=hd;gc=fd[0];break}2===gc.groupType&&(Pe=!0)}gc=new Hb(13);Pe&&Ab.VXj&&(gc=new Hb(13,Object(Wa.a)("TellMeWebTitle")));hd=new hb("SmartLookupFromTellMeQueryTermAtTop",
10,this.query.gm,null,0);fd=[];yd=null;yd=ie.Utb()?ie.nDc(this.query.gm,1):ie.AUi(this.query.gm);fd.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",yd));yd=String.format(Object(Wa.a)("SeeMoreResultsButtonTextAtTop"),this.query.gm);fd.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",yd));appChrome.api.dispatch(fd);gc.hR(hd);hd=[];if(Pe&&Ab.VXj)for(hd.push(this.FA[Va]),hd.push(gc),Pe=Va+1;Pe<this.FA.length;Pe++)(Va=this.FA[Pe].results)&&
0<Va.length&&hd.push(this.FA[Pe]);else for(hd.push(gc),Pe=0;Pe<this.FA.length;Pe++)(Va=this.FA[Pe].results)&&0<Va.length&&hd.push(this.FA[Pe]);this.HSe=hd}}if(Ab.Ckg&&!Ab.doa){t=Pe=-1;for(Va=0;Va<this.FA.length;Va++)switch(this.FA[Va].groupType){case 23:Pe=Va;break;case 0:case 17:case 2:-1===t&&(t=Va)}if(-1!==Pe){t=-1===t?0:Pe>t?t+1:t;Pe=this.FA[Pe];Va=Array(this.FA.length);gc=0;for(hd=0;hd<Va.length;hd++)hd===t?Va[hd]=Pe:(23===this.FA[gc].groupType&&gc++,Va[hd]=this.FA[gc],gc++);this.HSe=Va}}ia.zF(this);
ia=qe.instance.lq();ia.Jhb(Ea.length,"RankerInference",V.data.Je.toString(),Math.round(window.performance.now()-Za),bj.jCm,!0,Uh.Blc);this.rZe&&ia&&(V=this.query.vrd,Ea=ia.VCh,Ab.hPh&&V>Ea&&!Ab.doa&&(ia.K7j(this.query.gm),ia.R9k(V)))}}a_j(V){if("GroupType"in V&&V.GroupType&&"ConfidenceScore"in V&&"ConfidenceThreshold"in V)return!0;qe.instance.lq().onError("IsValidIntentGroup","Invalid intents found");return!1}mue(V,Ea,Za,ia,Va){ia===this.Yoa&&(this.QUb(),qe.instance.lq().Jhb(Ea.length,"RankerInference",
V.data.Je.toString(),Math.round(window.performance.now()-Za),bj.jCm,!1,Uh.Blc));Va.zF(this)}QUb(){-1!==this.gKa&&(window.clearTimeout(this.gKa),this.gKa=-1)}jgo(V){let Ea;Ea=this.usa.ufa().doa?qe.instance.lq().fsj(this.V1h,this.query.gm):qe.instance.lq().fsj(this.FA,this.query.gm);var Za=this.usa.ufa().lln;""!==Za&&(Za="_"+Za);let ia="";this.usa.ufa().hUj&&(ia="RankerInference"+Za+",");this.usa.ufa().aPh&&(ia+="SerpletClassifier");","===ia.charAt(ia.length-1)&&(ia=ia.substring(0,ia.length-1));Za=
qe.instance.lq().U4l(ia);const Va=this.Yoa=Lc.a.create().toString();Za["Client-Request-Id"]=Va;const Ab=window.performance.now(),gc=this.usa.ufa()?this.usa.ufa().nln:600;this.QUb();this.gKa=window.setTimeout(()=>{if(Va===this.Yoa){this.Yoa="";this.gKa=-1;V.zF(this);const Hc={};Hc[ef.provider]="Ranker";Hc[ef.queryId]=this.query.vrd;qe.instance.lq().Zfa(Ga.timedOut,gc,Hc)}},gc);this.Dn.ik(qe.instance.lq().V4l(),2,Ea,Za,!1,0,Hc=>{this.vve(Hc,this.query.gm,Ab,V,Va,this.usa.ufa())},Hc=>{this.mue(Hc,this.query.gm,
Ab,Va,V)},null,null,!1,4E3,6E3)}mko(){var V=0,Ea=new Zb.a,Za=this.usa.ihm,ia=this.usa.jhm;for(var Va=0;Va<this.FA.length;Va++){var Ab=this.FA[Va],gc=si[Ab.groupType].toLowerCase(),Hc=Za[gc];V+=Ab.results.length;Ab.results.length>Hc&&(gc=ia[gc],Le.b(gc)||Ea.add(new Nc.a(gc,Ab)))}ia=!this.query||""===this.query.gm.trim();Va=V-(ia?this.urk:this.qrk);if(!(0>=Va)){ia=window.performance.now();V=V.toString()+" total,"+Va.toString()+" to remove.";if(0<Ea.count)for(Ea.Sc((fd,hd)=>fd.key>hd.key?-1:1),Ab=0;Ab<
Ea.count&&0<Va;Ab++){gc=Ea.ka(Ab).value;Hc=si[gc.groupType].toLowerCase();let fd=gc.results.length-Za[Hc];fd>Va&&(fd=Va);0<fd&&(gc.$Xk(fd),V+=Hc+": "+fd.toString()+" results removed.",Va-=fd)}if(0<Va){V+=Va.toString()+" results left after trimming.";Ea=new Zb.a;Za=this.usa.nhm;for(Ab=0;Ab<this.FA.length;Ab++)gc=this.FA[Ab],Hc=Za[si[gc.groupType].toLowerCase()],Le.b(Hc)||Ea.add(new Nc.a(Hc,gc));Ea.Sc((fd,hd)=>fd.key<hd.key?-1:1);for(Za=0;0<Va;)Ab=Ea.ka(Za++).value,Va>=Ab.results.length?(Array.remove(this.FA,
Ab),V+=si[Ab.groupType]+": "+Ab.results.length.toString()+" results force removed.",Va-=Ab.results.length):(Ab.$Xk(Va),V+=si[Ab.groupType]+": "+Va.toString()+" results force removed.",Va=0)}qe.instance.lq()&&(Ea={},Ea[ef.message]=V,qe.instance.lq().Zfa("ShowOptimal",window.performance.now()-ia,Ea))}}}Object(k.a)(Dh,"CombineResultsUpdatedEventArgs",null,[796]);class lk{constructor(V,Ea,Za,ia=!1,Va=""){this.vhi=this.dji=!1;this.fK=V;this.xFd=[];this.eNl=Ea.length;this.ie=qe.instance.ufa();this.NDh=
ia;this.Dhd=Va;this.WSe={};for(V=0;V<Ea.length;++V)this.WSe[V.toString()]=Za?0:Ea[V].uwa()}tbo(V,Ea){Ea&&Ea.query&&Ea.query.vrd<qe.instance.CIh()||(this.xFd[V]=Ea,this.vhi?this.dji=!0:(!this.ie||3!==this.ie.kN||3!==this.WSe[V.toString()]||this.kYl())&&this.FYe())}CWn(){this.vhi=!0}elo(){this.vhi=!1;this.dji&&(this.dji=!1,this.FYe())}kYl(){if(this.xFd.length<this.eNl)return!1;for(let V=0;V<this.eNl;++V)if(!this.xFd[V])return!1;return!0}FYe(){var V=this.kYl();const Ea=window.performance.now(),Za=new Dh(qe.instance.Xij());
Za.a6n(this.xFd);for(var ia=0;ia<this.xFd.length;++ia){var Va=this.xFd[ia];if(Va&&Va.FA&&Va.FA.length&&(Za.query=Va.query,Va.attributes&&0<Va.attributes.length&&(Za.attributes=Va.attributes),Va&&Va.FA&&(V||this.x0m(ia,this.xFd))))for(const Ab of Va.FA)Za.$M(Ab)}Za.FA&&Za.FA.length&&(Za.rZe=V,this.ie&&this.ie.Oul&&Za.mko(),this.ie&&this.ie.lyn&&Za.query.gm&&0<Za.query.gm.length?Za.igo():Za.hgo(),this.ie&&(this.ie.hUj||this.ie.aPh)&&this.NDh&&Za.query.gm&&0<Za.query.gm.length&&Za.rZe&&this.Dhd!==hf.contextMenu?
(3===this.ie.kN&&V||this.fK.zF(Za),Za.jgo(this.fK)):this.fK.zF(Za),V=qe.instance.lq(),Za.rZe&&V&&(ia=Za.query.vrd,Va=V.VCh,Za.query.gm&&0<Za.query.gm.length&&this.NDh&&this.ie.hPh&&this.Dhd!==hf.contextMenu&&ia>Va&&!this.ie.hUj&&!this.ie.doa&&(V.K7j(Za.query.gm),V.R9k(ia)),V.Zfa(Ga.y8n,window.performance.now()-Ea)))}x0m(V,Ea){if(!(this.WSe&&V.toString()in this.WSe)||Ea.length<=V||!Ea[V])return!1;if(!Ea[V].FA.length)return!0;const Za=this.WSe[V.toString()];if(0===Za)return!0;const ia=this.WSe;for(const Ab in ia){var Va=
ia[Ab];const gc=Number.parseInvariant(Ab);if(gc!==V&&Va===Za&&!(Ea.length>gc&&Ea[gc]))return!1}return!0}}Object(k.a)(lk,"ResultsAggregator",null,[]);var vk=a(835);class Xi{constructor(V,Ea,Za,ia,Va,Ab){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=V;this.url=Ea;this.spWebUrl=Za;this.uniqueId=ia;this.size=Va;this.lastModified=Ab}}Object(k.a)(Xi,"FileInfo",null,[]);class wk{constructor(V,Ea){this.DimensionValue=this.DimensionName=null;this.DimensionName=
V;this.DimensionValue=Ea}}Object(k.a)(wk,"Dimension",null,[]);class Fk{constructor(V,Ea,Za,ia,Va){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=V;this.Query=Ea;this.From=Za;this.Size=ia;Va&&(this.Filter=Va)}}Object(k.a)(Fk,"EntityRequest",null,[]);class Kk{constructor(V){this.QueryString=null;this.QueryString=V}}Object(k.a)(Kk,"Query",null,[]);class rk{constructor(V,Ea){this.Dimensions=this.Name=null;this.Name=V;this.Dimensions=Ea}}Object(k.a)(rk,"Scenario",
null,[]);class fi{constructor(V,Ea,Za,ia){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=V;this.TimeZone=Ea;this.Cvid=Za;this.Scenario=ia}}Object(k.a)(fi,"SubstrateBody",null,[]);var Af=a(1071),Gl=a(1070);class Ni{constructor(V){this.gof=this.nhd=this.gEh=this.ggf=this.$of=0;this.tMl=this.QMl=this.Yoa=null;this.yei=0;this.gKa=-1;this.Tsf="";this.ibi=!1;this.Dn=l.AFrameworkApplication.$d;this.ie=V;this.ZEh=this.isj();this.ZFd=new vk.a;this.ZLl=this.ie.Oul?3:2;this.cmi=
this.ie.Oul&&this.ie.Yzm?5:3;this.doi=this.ie.x_h?2:3;this.LOl=1;this.WDh=this.ie.B3l;this.aOl=this.ie.Syn;this.tqf=V.D4l;l.AFrameworkApplication.ha&&(this.QMl=l.AFrameworkApplication.ha.Ma("AppCatalogUrl")+l.AFrameworkApplication.ha.Ma("SearchPersonaPhotoBaseUrl"),this.ibi=this.ie.BJh||this.ie.Ffb||this.ie.DJh);this.ie.Ffb&&(this.doi=this.cmi=5)}zfa(){return"Substrate"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:3}L$(V,Ea,Za,ia=hf.lH,Va=null){const Ab=new mc(V);if(!Va||Array.contains(Va,14)||
Array.contains(Va,15)||Array.contains(Va,20))if(!this.yei||window.performance.now()-this.yei>=ie.s1h)if(Za=this.ZFd.qXe())this.yei=window.performance.now(),Za.then(gc=>{gc&&""!==gc?(this.Tsf=gc,""!==this.Yoa&&this.L4l(V,ia,this.Tsf,Ea,Va)):(qe.instance.lq().onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),Ea.zF(Ab))},gc=>{qe.instance.lq().onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+gc);Ea.zF(Ab)});else{if(qe.instance.lq())qe.instance.lq().onError("SubstrateResultsProvider:IssueQuery",
"undefined token promise");Ea.zF(Ab)}else this.Tsf&&""!==this.Tsf?this.L4l(V,ia,this.Tsf,Ea,Va):(Ea.zF(Ab),qe.instance.lq().onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else Ea.zF(Ab)}z1(){this.nhd=this.gof=this.gEh=this.ggf=this.$of=0}L4l(V,Ea,Za,ia,Va){this.z1();const Ab=new mc(V),gc=this.Yoa=Lc.a.create().toString();this.QUb();this.gKa=window.setTimeout(()=>{if(gc===this.Yoa){this.Yoa="";this.gKa=-1;ia.zF(Ab);const hd={};hd[ef.provider]=this.zfa();hd[ef.queryId]=
V.vrd;qe.instance.lq().Zfa(Ga.timedOut,this.tqf,hd)}},this.tqf);const Hc={"Content-Type":"application/json",Accept:"application/json"};Hc.Authorization="Bearer "+Za;Hc["X-Office-Version"]=l.AFrameworkApplication.buildVersion;Hc["X-Office-Application"]=l.AFrameworkApplication.ha.Ma("Application");Hc["X-Office-Platform"]="WAC";Hc["X-TellMe-SessionId"]=qe.instance.tXe();Hc["X-TellMe-Culture"]=l.AFrameworkApplication.uiCulture;Hc["X-TellMe-ProcessSessionId"]=l.AFrameworkApplication.userSessionId;Hc["Client-Request-Id"]=
gc;const fd=window.performance.now();this.Dn.ik(this.dmn(),2,this.emn(V.gm,this.ie.application,qe.instance.tXe(),ie.vca(V)),Hc,!1,0,hd=>{this.vve(hd,V,ia,gc,fd,Ea,Va)},hd=>{this.mue(hd,V,ia,gc,fd)},null,null,!1,4E3,6E3)}QUb(){-1!==this.gKa&&(window.clearTimeout(this.gKa),this.gKa=-1)}vve(V,Ea,Za,ia,Va,Ab,gc){qe.instance.lq().Jhb(Ea.gm.length,this.ZEh.join(","),V.data.Je.toString(),Math.round(window.performance.now()-Va),bj.OBm,!0,Uh.Blc);const Hc=ie.vca(Ea),fd=new mc(Ea);if(ia===this.Yoa){this.QUb();
V=Ka.b(V.data.responseData);if(V.Groups){V=V.Groups;for(const hd of V)"People"===hd.Type&&this.ie.ksh&&(gc?Array.contains(gc,14):1)?(V=this.M3l(hd.Suggestions,Hc,Ab),0<V.results.length&&fd.$M(V)):"File"===hd.Type&&this.ie.jsh&&(gc?Array.contains(gc,15):1)?(V=this.fij(hd.Suggestions,Hc,Ab),0<V.results.length&&(this.DOh()&&(ia=new hb("GenerateSlidesFromTellMe",30,"",null,1),V.hR(ia)),fd.$M(V))):"Notes"===hd.Type&&this.ie.knd&&Ab!==hf.contextMenu&&(gc?Array.contains(gc,20):1)&&(V=this.z3l(hd.Suggestions,
Hc,Ea),0<V.results.length&&fd.$M(V))}Za.zF(fd);qe.instance.lq().Jhb(Ea.gm.length,this.ZEh.join(","),"",Math.round(window.performance.now()-Va),"",!0,Uh.provider)}else Za.zF(fd)}z3l(V,Ea,Za){const ia=new Hb(20);ia.displayName=Object(Wa.a)("TellMeNotesProviderTitle");for(const Va of V)this.yzn(Va)&&(V=Va.NotesType,V=la.a.ph(V),V=this.kjn(V,Va.LastModifiedTime,Va.BodyPreview,Va.Subject,Ea,Za,Va))&&(V.groupType=20,ia.hR(V));return ia}M3l(V,Ea,Za){const ia=new Hb(14);ia.displayName=Object(Wa.a)("TellMePeopleProviderTitle");
for(const Ab of V)if(this.zzn(Ab)){var Va=Ab.Id.split("@")[0];V=Ab.EmailAddresses[0];let gc=Ab.Type;if(void 0===gc||null===gc)gc="User";if(Va=this.Ojn(gc,Ab.DisplayName,Ab.JobTitle,V,Va,Za,Ea))Va.description=V,V=Ab.JobTitle,"Department"in Ab&&"CompanyName"in Ab&&(V+="@"+Ab.Department+"@"+Ab.CompanyName),Va.additionalInfo=V,ia.hR(Va)}return ia}fij(V,Ea,Za){const ia=new Hb(15);ia.displayName=Object(Wa.a)("TellMeFileProviderTitle");for(const hd of V)if(this.wzn(hd)){var Va=hd.FileName;V=hd.FileExtension;
var Ab=Va;Va.length>V.length&&Ab.endsWith(V)&&(Ab=Va.substr(0,Va.length-V.length-1));var gc=void 0,Hc=0;"DateCreated"in hd&&hd.DateCreated?(Hc=ie.vtj(hd.DateCreated),gc=ie.b5l(hd.DateCreated),gc=String.format(Object(Wa.a)("CreatedTimeFormatString"),hd.Author,gc)):gc=hd.Author;var fd=hd.AccessUrl+"?web=1";const yd=la.a.Y3d(fd);Va=String.format('<a href="{0}">{1}</a>',yd,la.a.gsb(Va));if(Za!==hf.contextMenu||la.a.K$(fd))if(Ab=this.ehn(Ab,Za===hf.contextMenu?Va:fd,gc,hd.FileExtension,hd.Text,Ea))Ab.description=
hd.Author,Ab.hGh=Hc,ia.hR(Ab),this.ibi&&(Hc=hd.AccessUrl,Va=ie.yLh(V),gc=hd.DateModified?hd.DateModified:hd.DateCreated,fd=hd.Size?hd.Size:hd.FileSize,this.ido()&&(Hc=Hc.replace(RegExp("%20","g")," "),Va=ie.Jln(V)),V=new Xi(Va,Hc,hd.SPWebUrl,hd.Id,fd,gc),qe.instance.vxh(!1,Ab.value,V))}return ia}mue(V,Ea,Za,ia,Va){ia===this.Yoa&&(this.QUb(),qe.instance.lq().Jhb(Ea.gm.length,this.ZEh.join(","),V.data.Je.toString(),Math.round(window.performance.now()-Va),bj.OBm,!1,Uh.Blc));V=new mc(Ea);Za.zF(V)}Ojn(V,
Ea,Za,ia,Va,Ab,gc){gc=gc?this.LOl:this.ZLl;if(!window.LPC&&!ie.UPj()||this.$of===gc)return null;this.$of+=1;gc="PeopleSuggestion"+this.$of.toString();var Hc=this.QMl+"?size=1&accountName="+ia;V=Object.assign(new Af.a,{PersonaType:V,Smtp:ia,ProfilePictureUrl:Hc,AadObjectId:Va});const fd=Object.assign(new Gl.a,{identifiers:V,displayName:Ea});V=Ab===hf.contextMenu;this.ie.LIb?(qe.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(gc,fd,Ea,Za)),Ab===hf.contextMenu&&(Za=ie.$Wl(Ea,ia,Va),
qe.instance.actions.push(appChrome.actions.setButtonCommandValueId(gc,Za))),qe.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(gc,V))):(Hc=[],Hc.push(appChrome.actions.setPersonaButtonCoauthor(gc,fd,Ea,Za)),Ab===hf.contextMenu&&(Za=ie.$Wl(Ea,ia,Va),Hc.push(appChrome.actions.setButtonCommandValueId(gc,Za))),Hc.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(gc,V)),appChrome.api.dispatch(Hc));return new hb(gc,11,Ea,ia,0)}kjn(V,Ea,Za,ia,Va,Ab,gc){if(Va&&
!this.ie.mam||this.gEh===this.WDh||this.gof===this.WDh||this.nhd===this.WDh)return null;var Hc=null;this.gEh+=1;Va="";const fd=[],hd={};gc.type="Notes";this.tMl=Object.assign(new If.a,{landingTab:"Notes",data:gc});Ab=ie.nDc(Ab.gm,33,this.tMl);if("onenotepagepreviews"===V){if(!("ClickthroughUrl"in gc&&gc.ClickthroughUrl)||""===gc.ClickthroughUrl)return null;this.gof+=1;Va="OnenoteNotesSuggestion"+this.gof.toString();hd["default"]="SaveAsonetoc2_20";Hc=gc.ClickthroughUrl;fd.push(appChrome.actions.setControlIconSet(Va,
hd));fd.push(appChrome.actions.setCompoundButtonCommandValueId(Va,Hc));Hc=new hb(Va,19,null,null,0)}else if("stickynote"===V){if(!this.aOl)return null;this.nhd+=1;Va="NotesSuggestion"+this.nhd.toString();hd["default"]="ShowAllNotes_20";fd.push(appChrome.actions.setControlIconSet(Va,hd));fd.push(appChrome.actions.setCompoundButtonCommandValueId(Va,Ab));Hc=new hb(Va,21,null,null,0)}else if("samsung"===V){if(!this.aOl)return null;this.nhd+=1;Va="NotesSuggestion"+this.nhd.toString();hd["default"]="CategoryCollapsed_20";
fd.push(appChrome.actions.setControlIconSet(Va,hd));fd.push(appChrome.actions.setCompoundButtonCommandValueId(Va,Ab));Hc=new hb(Va,20,null,null,0)}""!==Va&&(V=ie.b5l(Ea),V=String.format(Object(Wa.a)("LastModifiedString"),V),Hc.label=ia,Hc.hGh=ie.vtj(Ea),fd.push(appChrome.actions.setControlLabel(Va,ia)),fd.push(appChrome.actions.updateCompoundButtonDescription(Va,V)),fd.push(appChrome.actions.setControlCustomTooltip(Va,Za)),appChrome.api.dispatch(fd));return Hc}ehn(V,Ea,Za,ia,Va,Ab){if(this.ggf===
(Ab?this.doi:this.cmi)||this.ibi&&"Word"!==ie.yLh(ia))return null;this.ggf+=1;Ab="FileSuggestion"+this.ggf.toString();const gc=[],Hc={};Hc["default"]=ie.Mhn(ia);this.ie.LIb?(qe.instance.actions.push(appChrome.actions.setControlLabel(Ab,V)),qe.instance.actions.push(appChrome.actions.setControlIconSet(Ab,Hc)),qe.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ab,Za)),qe.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ab,Ea)),qe.instance.actions.push(appChrome.actions.setControlCustomTooltip(Ab,
Va))):(gc.push(appChrome.actions.setControlLabel(Ab,V)),gc.push(appChrome.actions.setControlIconSet(Ab,Hc)),gc.push(appChrome.actions.updateCompoundButtonDescription(Ab,Za)),gc.push(appChrome.actions.setCompoundButtonCommandValueId(Ab,Ea)),gc.push(appChrome.actions.setControlCustomTooltip(Ab,Va)),appChrome.api.dispatch(gc));return new hb(Ab,6,V,Za,0)}isj(){const V=[];this.ie.ksh&&Array.add(V,"People");this.ie.jsh&&Array.add(V,"File");this.ie.knd&&Array.add(V,"Notes");return V}emn(V,Ea,Za,ia){var Va=
new Kk(V);V=new Fk("File",Va,0,ia?this.doi:this.cmi,null);ia=new Fk("People",Va,0,ia?this.LOl:this.ZLl,ie.JWn);Va=new Fk("Notes",Va,0,this.WDh,null);(this.ie.BJh||this.ie.DJh)&&"powerpoint"===Ea.toLowerCase()&&(Ea="word");Ea=new wk("app",Ea.toLowerCase());var Ab=[];Array.add(Ab,Ea);Ea=new rk("tellmesearch",Ab);Ab=[];this.ie.jsh&&Array.add(Ab,V);this.ie.ksh&&Array.add(Ab,ia);this.ie.knd&&Array.add(Ab,Va);Za=new fi(Ab,"UTC",Za,Ea);return Ka.c(Za)}dmn(){let V=this.ie.Aho;this.ie.knd&&(V+="?&setflight=NotesFrom3S");
""!==this.ie.M4l&&(V=V+"&"+this.ie.M4l);return V}zzn(V){return"DisplayName"in V&&"Id"in V&&"EmailAddresses"in V&&!!V.Id&&!!V.EmailAddresses}wzn(V){return"FileExtension"in V&&!!V.FileExtension&&"FileName"in V&&!!V.FileName&&""!==V.FileName&&"AccessUrl"in V&&!!V.AccessUrl&&""!==V.AccessUrl}yzn(V){return"Id"in V&&!!V.Id&&"NotesType"in V&&!!V.NotesType&&"Subject"in V&&!!V.Subject&&""!==V.Subject}DOh(){return!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",
!1)}ido(){return!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(k.a)(Ni,"SubstrateResultsProvider",null,[749]);class sk{constructor(){this.m7e=this.n7e=this.l7e=this.Vng=this.XZe=this.EYe=0}wTm(V,Ea){switch(V){case 1:this.EYe=Ea;break;case 3:this.XZe=Ea;break;case 2:this.Vng=Ea;break;case 5:this.l7e=Ea;break;case 4:this.n7e=Ea;break;case 6:this.m7e=Ea}}}Object(k.a)(sk,"CommandFeatures",null,[]);class Qj{constructor(V){this.gKl=
0;this.Ceb=V;this.HMm={}}get modelId(){return this.Ceb}get San(){return this.gKl}get qIf(){return this.HMm}cTm(V,Ea,Za){0===Ea?this.gKl=Za:(this.qIf[V]||(this.qIf[V]=new sk),this.qIf[V].wTm(Ea,Za))}}Object(k.a)(Qj,"CoefficientsModel",null,[]);const Bf=(V,Ea)=>Math.pow(10,-Ea/(60*Math.LN10/Math.LN2*V));class Ej{constructor(V,Ea){this.DQm=V;this.Wp=1;this.Dyd=new sk;this.features.Vng=1+Math.log(this.count)/Math.LN2;this.features.EYe=V?1/V:0;this.features.XZe=2/Math.pow(2,V);this.features.l7e=Bf(10,
Ea);this.features.n7e=Bf(2,Ea);this.features.m7e=Bf(1,Ea)}get rank(){return this.DQm}get count(){return this.Wp}get features(){return this.Dyd}Utn(){this.Wp=this.count+1;this.features.Vng=1+Math.log(this.count)/Math.LN2}ymo(V){const Ea=2/Math.pow(2,V);this.features.EYe=Math.max(this.features.EYe,V?1/V:0);this.features.XZe=Math.max(this.features.XZe,Ea)}Vmo(V){const Ea=Bf(10,V),Za=Bf(2,V);V=Bf(1,V);this.features.l7e=Math.max(this.features.l7e,Ea);this.features.n7e=Math.max(this.features.n7e,Za);this.features.m7e=
Math.max(this.features.m7e,V)}}Object(k.a)(Ej,"CommandModel",null,[]);class Rj{constructor(V){this.mdf=null;if(!V&&qe.instance.lq())qe.instance.lq().onError("PredictionEngine","IModelAdapter can't be null");this.sSe=V;this.bEh=this.b3j()}b3j(){const V=this.sSe.Tin(),Ea=this.sSe.Hlj();if(void 0===V||null===V||void 0===Ea||null===Ea)return!1;try{window.performance.now();this.mdf={};for(let Za=0;Za<V.length;Za++){const ia=V[Za],Va=Ea[ia[0].toString()].trim(),Ab=ia[1],gc=0!==Ab?Ea[ia[2].toString()].trim():
"",Hc=ia[3];Va in this.mdf||(this.mdf[Va]=new Qj(Va));this.mdf[Va].cTm(gc,Ab,Hc)}}catch(Za){if(qe.instance.lq())qe.instance.lq().onError("LoadModelData","Error Loading Suggestions Model: "+Za);return!1}return!0}ndn(){const V=this.sSe.Uhn(),Ea={};if(!V)return Ea;let Za=1;for(let ia=0;ia<V.length;ia++){const Va=V[ia];Va.Id in Ea?(Ea[Va.Id].Utn(),Ea[Va.Id].ymo(Za),Ea[Va.Id].Vmo(Va.TimeElapsedSinceClick)):Ea[Va.Id]=new Ej(Za,Va.TimeElapsedSinceClick);Za++}return Ea}iUj(){this.bEh||(this.bEh=this.b3j());
return this.bEh}Yjn(){let V=[];if(!this.bEh){if(qe.instance.lq())qe.instance.lq().onError("GetPredictedCommands","IModelAdapter returned no data");return V}const Ea=this.ndn(),Za=this.mdf;for(const Va in Za){const Ab=Za[Va],gc=Ab.modelId;let Hc=0;for(const fd in Ea){var ia=fd;const hd=Ea[fd].features;(ia=ia in Ab.qIf?Ab.qIf[ia]:null)&&(Hc+=hd.EYe*ia.EYe+hd.XZe*ia.XZe+hd.Vng*ia.Vng+hd.l7e*ia.l7e+hd.n7e*ia.n7e+hd.m7e*ia.m7e)}Hc+=Ab.San;V.push(new Gi(gc,Hc))}V.sort((Va,Ab)=>Va.score<Ab.score?1:Va.score>
Ab.score?-1:0);0<V.length-10&&(V=V.slice(0,10));return V}}Object(k.a)(Rj,"PredictionEngine",null,[]);class Zk{constructor(){this.HNl={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),
"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),
"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),
"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),
"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}kLh(V,Ea){return Ea&&"word"===Ea.application.toLowerCase()&&V in this.HNl?this.HNl[V]:[]}}Object(k.a)(Zk,"SuggestionResultsUtility",null,[]);class na{constructor(V,Ea,Za){this.ie=Ea;this.enf=new Rj(V);this.WPb=Za;this.iOl=new Zk}zfa(){return"Suggestion"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:2}L$(V,Ea,Za,ia=hf.lH,Va=null){Za=new mc(V);
qe.instance.cfd=!1;if((!Va||Array.contains(Va,16))&&ie.vca(V)){if(!this.enf.iUj()){if(qe.instance.lq())qe.instance.lq().onError("CRASH","SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.MXj()&&0<this.iOl.kLh(qe.instance.lNf,this.ie).length){const gc=this.iOl.kLh(qe.instance.lNf,this.ie);Va=[];for(var Ab of gc)this.ie.x_h&&"Find"===Ab||Va.push(new Gi(Ab,0));qe.instance.cfd=!0}else Va=this.enf.Yjn();
gh.VZe(Va,!0,"Recommended","LRE");Ab=[];for(const gc of Va)this.WPb&&this.WPb.qJf(gc.commandId)||Ab.push(gc);V=gh.y0d(V,Ab,this.ie,null,null,null,16,1);0<V.results.length&&ia!==hf.contextMenu&&(V.displayName=Object(Wa.a)("TellMeTryCommandTitle"));0<V.results.length&&Za.$M(V)}Ea.zF(Za)}MXj(){return!!this.ie&&(this.ie.MXj||this.ie.Hzn)}}Object(k.a)(na,"SuggestionResultsProvider",null,[749]);class Ya{Uhn(){return qe.instance.jLh()}Tin(){return window.TellMeSuggestionModel}Hlj(){return window.CoefficientModelIdMap}}
Object(k.a)(Ya,"SuggestionsModelAdapter",null,[987]);class nc{constructor(V){this.ie=V;this.ZEh=this.isj()}zfa(){return"Add-ins"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:3}L$(V,Ea){V=new mc(V);Ea.zF(V)}gmd(V,Ea,Za){let ia;ia=this.ie.doa?new Hb(29):new Hb(27);ia.displayName=Object(Wa.a)("TellMeAddinProviderTitle");Za&&this.jfo(V.gm,Ea,ia)}jfo(V,Ea,Za){const ia=[];let Va;Va=this.ie.dwn?this.ie.doa&&this.ie.Fid?ie.gld(String.format(Object(Wa.a)("TellMeLaunchAddinDialogButtonText_1_Bolded"),V)):
String.format(Object(Wa.a)("TellMeLaunchAddinDialogButtonText_1"),V):this.ie.ewn?this.ie.doa&&this.ie.Fid?ie.gld(String.format(Object(Wa.a)("TellMeLaunchAddinDialogButtonText_2_Bolded"),V)):String.format(Object(Wa.a)("TellMeLaunchAddinDialogButtonText_2"),V):this.ie.doa&&this.ie.Fid?ie.gld(String.format(Object(Wa.a)("TellMeLaunchAddinDialogButtonText_0_Bolded"),V)):String.format(Object(Wa.a)("TellMeLaunchAddinDialogButtonText_0"),V);this.ie.LIb?(qe.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",
Va)),qe.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",V))):(ia.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",Va)),ia.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",V)),appChrome.api.dispatch(ia));Za.hR(new hb("LaunchAddinDialogFromTellMe",29));Ea.$M(Za)}isj(){const V=[];this.ie.iOh&&Array.add(V,"Addin");return V}}Object(k.a)(nc,"AddinStoreResultsProvider",null,[749]);class Qc{constructor(V){this.ie=
V}zfa(){return"Template"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:3}L$(V,Ea){V=new mc(V);Ea.zF(V)}gmd(V,Ea,Za){var ia=[];let Va;Va=this.ie.doa?this.ie.Fid?ie.gld(String.format(Object(Wa.a)("TellMeTemplateButtonTextV2Bolded"),V.gm)):String.format(Object(Wa.a)("TellMeTemplateButtonTextV2"),V.gm):String.format(Object(Wa.a)("TellMeTemplateButtonText"),V.gm);ia.push(appChrome.actions.setControlLabel("TemplateForSearch",Va));ia.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(l.AFrameworkApplication.ha.Ma("TellMeTemplateProviderURL"),
l.AFrameworkApplication.uiCulture,V.gm)));appChrome.api.dispatch(ia);V=new Hb(23);V.displayName=Object(Wa.a)("TellMeTemplateProviderTitle");ia=new hb("TemplateForSearch",24,null,null,0);ia.label=Za[0].Title?Za[0].Title:"";ia.description=Za[0].Description?Za[0].Description:"";V.hR(ia);Ea.$M(V)}}Object(k.a)(Qc,"TemplateResultsProvider",null,[749]);class pd{constructor(V,Ea,Za){this.vhd=this.dsf=this.esf=this.QEh=!1;this.Yoa=null;this.gKa=-1;this.xwc=this.ltf=this.Dhd=this.WGd=null;this.CLl=this.DLl=
0;this.ie=V;const ia=ie.Utb();this.ygd=Ea||[];this.Dn=l.AFrameworkApplication.$d;this.SNl=V.EBk;this.fsf=V.DBk;this.OEh=ia&&this.Bad();this.PEh=ia&&this.Cad();this.TNl=ia&&this.Dad();this.SEh=this.gJe();this.Eki=this.g6e();if((Ea=V.wol&&ie.hgl(V))||V.Ffb)this.WGd=new Ni(V),this.QEh=V.jsh;Ea&&(this.esf=V.ksh,this.dsf=V.knd,this.vhd=this.QEh&&this.sR("File")||this.esf&&this.sR("People")||this.dsf&&this.sR("Notes"));this.NEh=this.udo();this.isf=V.O1g;this.REh=this.Cdo();this.Dki=this.tdo();this.NSe=
this.w_h();this.TWa=this.xmn();this.AIl=new pg(V);this.uOm=new Bi(V);this.ZRm=new Qc(V);this.ULm=new nc(V);this.tqf=Za;this.ZFd=new vk.a;this.isf&&(this.AIl=new pg(V));V.Ffb&&(this.Dki=this.REh=this.isf=this.vhd=this.dsf=this.esf=this.Eki=this.SEh=this.TNl=this.PEh=this.OEh=this.fsf=!1,l.AFrameworkApplication.ha&&this.sR("File")&&this.uzm()||this.NSe)&&(V=this.ZFd.c7f("Search",l.AFrameworkApplication.ha.Ma("TellMeServiceAuthEndpointForSearch")),this.BVf(V,"TellMeService",!0),V=this.ZFd.c7f("SmartLookup",
l.AFrameworkApplication.ha.Ma("SmartLookupShredderServiceEndpoint")),this.BVf(V,"Shredder",!1));l.AFrameworkApplication.ha&&this.vhd&&this.sR("File")&&this.uzm()&&(V=this.ZFd.c7f("Search",l.AFrameworkApplication.ha.Ma("TellMeServiceAuthEndpointForSearch")),this.BVf(V,"TellMeService",!0))}sR(V){return Array.contains(this.ygd,V)?!0:!1}zfa(){return"TellMeService"}uwa(){return 0===this.ie.kN?0:1===this.ie.kN?1:this.sR("Command")||this.sR("Recommended")?2:3}vmn(V){let Ea="";if(!V&&this.sR("Command")&&
this.ie.oUj){Ea+="CommandSearch_DLIS,";var Za=this.ie.nCm;0<Za.length&&(Ea+=Za+",")}V&&this.sR("Recommended")&&this.fsf&&(Za=this.xnn(),0<Za.length&&(Ea+=Za+","));!V&&this.sR("Help")&&(V=this.ie.mCm,0<V.length&&(Ea+=V+","));this.ie.Ffb&&this.xwc&&0<this.xwc.length&&(Ea+="IsRecallEnabled_true,");(this.ie.BJh||this.ie.DJh||this.ie.Ffb)&&this.vhd&&(Ea+="IsGenerateSlidesEnabled_true,");0<Ea.length&&(Ea=Ea.substr(0,Ea.length-1));return Ea}BVf(V,Ea,Za){const ia=Za?this.DLl:this.CLl;if(!ia||window.performance.now()-
ia>=ie.s1h)if(V)Za?this.DLl=window.performance.now():this.CLl=window.performance.now(),V.then(Va=>{Za?this.ltf=Va:(this.xwc=Va,qe.instance.hoh=Va)},Va=>{qe.instance.lq().onError("TellMeServiceProvider:FetchTokenForService_"+Ea,"tellMeServiceToken promise rejected: "+Va)});else if(qe.instance.lq())qe.instance.lq().onError("TellMeServiceProvider:FetchTokenForService_"+Ea,"undefined token promise")}L$(V,Ea,Za,ia=hf.lH,Va=null){const Ab=new mc(V);Za=ie.vca(V);this.sR("File")&&(this.vhd||this.ie.Ffb)&&
this.BVf(this.ZFd.Rsj(),"TellMeService",!0);(this.sR("File")&&this.ie.Ffb||this.sR("ActionAI")&&this.NSe)&&this.BVf(this.ZFd.Rqj(),"Shredder",!1);var gc=this.vhd&&!!this.ltf;const Hc=this.ie.Ffb&&!!this.xwc;var fd=gc||Hc||Za&&this.sR("Recommended")&&this.fsf;gc=gc||Hc||!Za&&(this.SNl&&this.sR("Command")||this.OEh&&this.sR("Answer")||this.PEh&&this.sR("Definition")||this.Eki&&this.sR("Image")||this.isf&&this.sR("Help")||this.SEh&&this.sR("WolframAnswer")||this.REh&&this.sR("Template")||this.Dki&&this.sR("Addin"));
if(fd||gc)if(this.Dhd=ia,ia={"Content-Type":"application/json",Accept:"application/json"},ia["X-Office-Version"]=l.AFrameworkApplication.buildVersion,ia["X-Office-Application"]=l.AFrameworkApplication.ha.Ma("Application"),ia["X-Office-Platform"]="WAC",ia["X-TellMe-SqmUserId"]=l.AFrameworkApplication.ha.Ma("LoggableUserId")||"",ia["X-TellMe-SessionId"]=qe.instance.tXe(),this.ltf&&(ia.Authorization="Bearer "+this.ltf),this.xwc&&0<this.xwc.length&&(ia["X-TellMe-ShredderToken"]="Bearer "+this.xwc),fd=
this.vmn(Za),0<fd.length&&(ia["X-TellMe-Flights"]=fd),fd=[],!Za&&this.sR("Answer")&&this.OEh&&(Va?Array.contains(Va,9):1)&&Array.add(fd,"Answer"),!Za&&this.sR("Command")&&this.SNl&&!gh.Veg(V.gm)&&(Va?Array.contains(Va,17):1)&&Array.add(fd,"Command"),!Za&&this.sR("Definition")&&this.PEh&&(Va?Array.contains(Va,10):1)&&Array.add(fd,"Definition"),!Za&&this.sR("Help")&&this.isf&&(Va?Array.contains(Va,8):1)&&Array.add(fd,"Help"),!Za&&this.sR("WolframAnswer")&&this.SEh&&(Va?Array.contains(Va,12):1)&&Array.add(fd,
"WolframAnswer"),Za&&this.sR("Recommended")&&this.fsf&&!qe.instance.cfd&&(Va?Array.contains(Va,18):1)&&Array.add(fd,"Recommended"),!Za&&this.sR("Image")&&this.Eki&&(Va?Array.contains(Va,19):1)&&Array.add(fd,"Image"),this.ltf&&this.vhd&&(Va?Array.contains(Va,14)||Array.contains(Va,15)||Array.contains(Va,20):1)&&(this.WGd.z1(),this.QEh&&this.sR("File")&&Array.add(fd,"File"),this.esf&&this.sR("People")&&Array.add(fd,"People"),this.dsf&&this.sR("Notes")&&Array.add(fd,"Notes")),this.xwc&&0<this.xwc.length&&
this.ie.Ffb&&(Va?Array.contains(Va,15):1)&&(this.WGd.z1(),this.sR("File")&&Array.add(fd,"File")),!Za&&this.sR("Template")&&this.REh&&(Va?Array.contains(Va,23):1)&&Array.add(fd,"Template"),!Za&&this.sR("Addin")&&this.Dki&&(Va?Array.contains(Va,27):1)&&Array.add(fd,"Addin"),!Za&&this.sR("ActionAI")&&this.NSe&&(Va?Array.contains(Va,25):1)&&Array.add(fd,"ActionAI"),fd.length){ia["X-TellMe-SuggestionTypes"]=fd.join(",");ia["X-TellMe-Culture"]=l.AFrameworkApplication.uiCulture;ia["X-TellMe-ProcessSessionId"]=
l.AFrameworkApplication.userSessionId;var hd=this.Yoa=Lc.a.create().toString();ia["Client-Request-Id"]=hd;var yd=window.performance.now();this.QUb();this.gKa=window.setTimeout(()=>{if(hd===this.Yoa){this.Yoa="";this.gKa=-1;Ea.zF(Ab);const Md={};Md[ef.provider]=this.zfa();Md[ef.queryId]=V.vrd;qe.instance.lq().Zfa(Ga.timedOut,this.tqf,Md)}},this.tqf);this.Dn.ik(this.TWa,2,this.wmn(V.gm),ia,!1,0,Md=>{this.vve(Md,V,Ea,hd,yd,Va)},Md=>{this.mue(Md,V,Ea,hd,yd)},null,null,!1,4E3,this.NSe?3E4:6E3)}else qe.instance.lq().onError("IssueQuery",
"Empty Online Provider List: No online calls by provider"),Ea.zF(Ab);else Ea.zF(Ab)}QUb(){-1!==this.gKa&&(window.clearTimeout(this.gKa),this.gKa=-1)}vve(V,Ea,Za,ia,Va,Ab){const gc=new mc(Ea);if(ia===this.Yoa){this.QUb();qe.instance.lq().Jhb(Ea.gm.length,this.ygd.join(","),V.data.Je.toString(),Math.round(window.performance.now()-Va),bj.lH,!0,Uh.Blc);ia=V.data.responseData;V=null;try{V=Ka.b(ia)}catch(te){qe.instance.lq().onError("OnSuccessCallBack","Exception occured while deserializing response:"+
te);return}ia=ie.vca(Ea);if("Groups"in V&&V.Groups){var Hc=V.Groups;for(var fd of Hc)if("GroupType"in fd&&"Suggestions"in fd&&fd.Suggestions)if("Commands"===fd.GroupType&&(Ab?Array.contains(Ab,17):1)||"Recommended"===fd.GroupType&&(Ab?Array.contains(Ab,18):1)){var hd=(Hc="Recommended"===fd.GroupType)?"DLIS":"NaiveBayes";"Source"in fd&&fd.Source&&(hd=fd.Source);var yd=fd.Suggestions;new Zb.a;var Md=[];for(const te of yd)this.uzn(te)&&(yd=te.Type,("Command"===yd||Hc&&"Recommended"===yd)&&Md.push(new Gi(te.CommandId,
te.Score)));gh.VZe(Md,!Ea.gm.trim().length,fd.GroupType,hd);hd=qe.instance.klj();yd=[];for(const te of Md)Hc&&hd&&hd.qJf(te.commandId)||yd.push(te);Md=gh.y0d(Ea,yd,this.ie,null,null,null,Hc?18:17,0);0<Md.results.length&&(this.Dhd!==hf.contextMenu&&(Md.displayName=Hc?Object(Wa.a)("TellMeTryCommandTitle"):Object(Wa.a)("TellMeCommandProviderTitle")),gc.$M(Md))}else if("Answer"===fd.GroupType){yd=fd.Suggestions;Hc=null;Md=2147483647;hd="";for(const te of yd)if(this.tzn(te))if(hd=te.Type,yd=this.B4f(hd),
"Answer"===hd&&this.OEh){Hc=this.XWl(hd,te,Ea.gm);break}else yd&&yd<Md&&(Md=yd,Hc=this.XWl(hd,te,Ea.gm));Md=ie.x8n(Ea.gm,hd);Hc&&(Ab?Array.contains(Ab,Hc.type):1)&&(hd=[],this.NEh?this.ie.LIb?(qe.instance.actions.push(appChrome.actions.setControlLabel(Hc.value,Hc.Uta)),qe.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Hc.value,Hc.description)),qe.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Hc.value,Md))):(hd.push(appChrome.actions.setControlLabel(Hc.value,
Hc.Uta)),hd.push(appChrome.actions.updateCompoundButtonDescription(Hc.value,Hc.description)),hd.push(appChrome.actions.setCompoundButtonCommandValueId(Hc.value,Md)),appChrome.api.dispatch(hd)):this.ie.LIb?(qe.instance.actions.push(appChrome.actions.setControlLabel(Hc.value,Hc.Uta+" - "+Hc.description)),qe.instance.actions.push(appChrome.actions.setButtonCommandValueId(Hc.value,Md))):(hd.push(appChrome.actions.setControlLabel(Hc.value,Hc.Uta+" - "+Hc.description)),hd.push(appChrome.actions.setButtonCommandValueId(Hc.value,
Md)),appChrome.api.dispatch(hd)),Md=this.G5m(Hc.type),Md.hR(Hc),gc.$M(Md))}else"Help"===fd.GroupType&&fd.Suggestions.length&&(Ab?Array.contains(Ab,8):1)?this.isf&&(Hc=this.AIl.gmd(Ea,fd.Suggestions))&&0<Hc.results.length&&gc.$M(Hc):"Template"===fd.GroupType&&(Ab?Array.contains(Ab,23):1)?(Hc=fd.Suggestions)&&0<Hc.length&&this.ZRm.gmd(Ea,gc,Hc):"Addin"===fd.GroupType&&(Ab?Array.contains(Ab,27):1)?(Hc=fd.Suggestions)&&0<Hc.length&&this.ULm.gmd(Ea,gc,Hc):"ActionAI"===fd.GroupType&&(Ab?Array.contains(Ab,
25):1)?(Md=fd.Suggestions,Hc=[],new Hb(25),Md&&1===Md.length&&(hd=Md[0])&&hd.CommandId&&(Md=hd.CommandId,Hc.push(new Gi(Md,"Score"in hd?hd.Score:0)),Hc=gh.y0d(Ea,Hc,this.ie,null,null,null,25,0),Hc.displayName=Object(Wa.a)("TellMeActionAIProviderTitle"),gc.$M(Hc))):"Substrate"===fd.GroupType&&this.vhd&&"Type"in fd?"File"===fd.Type&&this.QEh&&(Ab?Array.contains(Ab,15):1)?(Hc=this.WGd.fij(fd.Suggestions,ia,this.Dhd))&&0<Hc.results.length&&(this.DOh()&&(Md=new hb("GenerateSlidesFromTellMe",30,"",null,
1),Hc.hR(Md)),gc.$M(Hc)):"People"===fd.Type&&this.esf&&(Ab?Array.contains(Ab,14):1)?(Hc=this.WGd.M3l(fd.Suggestions,ia,this.Dhd))&&0<Hc.results.length&&gc.$M(Hc):"Notes"===fd.Type&&this.dsf&&(Ab?Array.contains(Ab,14):1)&&(Hc=this.WGd.z3l(fd.Suggestions,ia,Ea))&&0<Hc.results.length&&gc.$M(Hc):"Recall"===fd.GroupType&&this.ie.Ffb&&"Type"in fd&&"IntentService"===fd.Type&&(Ab?Array.contains(Ab,15):1)&&(Hc=this.WGd.fij(fd.Suggestions,ia,this.Dhd))&&0<Hc.results.length&&(this.DOh()&&(Md=new hb("GenerateSlidesFromTellMe",
30,"",null,1),Hc.hR(Md)),gc.$M(Hc));else qe.instance.lq().onError("OnSuccessCallBack","GroupType"in fd?"Invalid group suggestions found for "+fd.GroupType:"Invalid group found")}if(V.Intents){fd=V.Intents;for(const te of fd)this.a_j(te)&&("Image"===te.GroupType&&te.ConfidenceScore>te.ConfidenceThreshold&&(Ab?Array.contains(Ab,19):1)?this.uOm.gmd(Ea,gc,0,te):"Commands"===te.GroupType&&te.ConfidenceScore<te.ConfidenceThreshold&&(Ab?Array.contains(Ab,17):1)&&(fd=new Hb(17),gc.$M(fd)))}Za.zF(gc);qe.instance.lq().Jhb(Ea.gm.length,
this.ygd.join(","),"",Math.round(window.performance.now()-Va),"",!0,Uh.provider)}}mue(V,Ea,Za,ia,Va){const Ab=new mc(Ea);ia===this.Yoa&&(this.QUb(),qe.instance.lq().Jhb(Ea.gm.length,this.ygd.join(","),V.data.Je.toString(),Math.round(window.performance.now()-Va),bj.lH,!1,Uh.Blc));Za.zF(Ab)}B4f(V){switch(V){case "Entity":return this.TNl?3:0;case "Definition":return this.PEh?5:0;case "WolframAnswer":return this.SEh?2:0;default:return 0}}XWl(V,Ea,Za){switch(V){case "Answer":return new hb(this.NEh?"AnswerForSearch":
"AnswerForSearchSingleLine",0,""===Ea.Title?Za:Ea.Title,Ea.Description,0);case "Entity":return new hb(this.NEh?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===Ea.Title?Za:Ea.Title,Ea.Description,0);case "Definition":return new hb(this.NEh?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===Ea.Title?Za:Ea.Title,Ea.Description,0);case "WolframAnswer":return new hb("WolframForSearch",3,""===Ea.Title?Za:Ea.Title,Ea.Description,0);default:return null}}G5m(V){switch(V){case 0:return new Hb(9,Object(Wa.a)("TellMeAnswersTitle"));
case 2:return new Hb(11,Object(Wa.a)("TellMeEntityTitle"));case 1:return new Hb(10,Object(Wa.a)("TellMeDefinitionTitle"));case 3:return new Hb(12,Object(Wa.a)("TellMeAnswersTitle"));case 12:return new Hb(19,this.ie.c6e?Object(Wa.a)("TellMeImageTitleV2"):Object(Wa.a)("TellMeImageTitle"));default:return null}}tzn(V){return"Type"in V&&!!V.Type&&""!==V.Type&&"Description"in V&&!!V.Description&&""!==V.Description}uzn(V){return"Type"in V&&!!V.Type&&""!==V.Type&&"CommandId"in V&&!!V.CommandId&&""!==V.CommandId&&
"Score"in V&&!!V.Score}a_j(V){if("GroupType"in V&&V.GroupType&&"ConfidenceScore"in V&&"ConfidenceThreshold"in V)return!0;qe.instance.lq().onError("IsValidIntentGroup","Invalid intents found");return!1}wmn(V){const Ea=ie.dam(V),Za={};Za.Query=V;Ea&&this.fsf&&(this.Oxn()?Za.UserActionEvents=qe.instance.buj():(Za.CommandClickedEvents=qe.instance.jLh(),Za.CommandActionEvents=qe.instance.hfj()),Za.TellMeCommandClickMruEvents=qe.instance.Aej(),Za.ContentType=qe.instance.lNf);this.REh&&(V={},V.Application=
this.ie.application,Za.TemplateInfo=V);return Ka.c(Za)}Bad(){return!!this.ie&&this.ie.Bad||!!l.AFrameworkApplication.Ha&&l.AFrameworkApplication.Ha.Ib.Bad}Cad(){return!!this.ie&&this.ie.Cad||!!l.AFrameworkApplication.Ha&&l.AFrameworkApplication.Ha.Ib.Cad}Dad(){return!!this.ie&&this.ie.Dad||!!l.AFrameworkApplication.Ha&&l.AFrameworkApplication.Ha.Ib.Dad}gJe(){return!!this.ie&&this.ie.gJe||!!l.AFrameworkApplication.Ha&&l.AFrameworkApplication.Ha.Ib.gJe}g6e(){return!!this.ie&&(this.ie.g6e||this.ie.doa)}udo(){return!!this.ie&&
!this.ie.jnd}Cdo(){return!!this.ie&&this.ie.Ckg}tdo(){return!!this.ie&&this.ie.fwn&&this.ie.cwn}w_h(){return!!this.ie&&this.ie.w_h}jZj(){return!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}kZj(){return!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}Oxn(){return!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",
!1)}DOh(){return!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}uzm(){return!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}xnn(){return l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}xmn(){if(!l.AFrameworkApplication.ha)return"";
if(this.kZj())return l.AFrameworkApplication.ha.Ma("TellMeServiceProdEndpointForSearch");if(this.jZj())return l.AFrameworkApplication.ha.Ma("TellMeServiceEdogEndpointForSearch");if(ie.UPj())return l.AFrameworkApplication.ha.Ma("TellMeServiceIntEndpointForSearch");let V=l.AFrameworkApplication.ha.Ma("TellMeServiceSearchEndpoint");V&&""!==V||(V=l.AFrameworkApplication.d1h);return V}static dXl(V,Ea){if(Ea)return new pd(V,["Command","Recommended"],V.bhn);Ea=ie.Utb()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):
"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new pd(V,Ea,V.D4l)}}Object(k.a)(pd,"TellMeServiceProvider",null,[749]);class Xd{constructor(V=!1){this.CSe={};this.CSe[hf.lH]=[];this.CSe[hf.contextMenu]=[];this.NDh=V}Fam(V,Ea,Za,ia,Va=null){let Ab;var gc=!1;switch(ia){case hf.contextMenu:Ab=this.CSe[hf.contextMenu];gc=!0;break;default:Ab=this.CSe[hf.lH]}Ea=new lk(Ea,Ab,gc,this.NDh,ia);Ea.CWn();for(let Hc=0;Hc<Ab.length;++Hc){const fd=window.performance.now(),hd=new uh(Ea,
Hc);(gc=qe.instance.ufa())&&gc.BYm?window.setTimeout(()=>{Ab[Hc].L$(V,hd,Za,ia,Va);if(qe.instance.lq()){const yd={};yd[ef.provider]=Ab[Hc].zfa();yd[ef.queryId]=V.vrd;qe.instance.lq().Zfa(Ga.L$,window.performance.now()-fd,yd)}},0):(Ab[Hc].L$(V,hd,Za,ia,Va),qe.instance.lq()&&(gc={},gc[ef.provider]=Ab[Hc].zfa(),gc[ef.queryId]=V.vrd,qe.instance.lq().Zfa(Ga.L$,window.performance.now()-fd,gc)))}Ea.elo()}zfa(){return"Aggregator"}uwa(){return 0}L$(V,Ea,Za=!1,ia=hf.lH,Va=null){if(qe.instance.JVg)this.Fam(V,
Ea,Za,ia,Va);else{const Ab=window.performance.now();qe.instance.QAh.then(()=>{qe.instance.lq()&&qe.instance.lq().Zfa(Ga.UIn,window.performance.now()-Ab);this.Fam(V,Ea,Za,ia,Va);return!0})}}w5(V,Ea){this.CSe[Ea].push(V)}YTm(V){switch(V){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Ea=this.CSe[hf.lH];for(const Za of Ea)if("FindInDocument"===Za.zfa()){Za.$ao(V);break}}}static createInstance(V,Ea,Za,ia){const Va=Ea.Ffb;var Ab=ia&&ie.igl(Ea),gc=Ab&&Ea.DBk&&
!Va;const Hc=Ea.iZj&&!ie.wZe()&&!Va,fd=Ea.SUj&&!Va,hd=new Xd(Ab);if(Ea.ydo&&!Va){var yd=new tl(Ea);hd.w5(yd,hf.lH)}yd=Ea.az?l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeIsSuggestionsForSimplifiedUxEnabled"):l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeSuggestionsIsEnabled");const Md=!yd&&l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeFirstRunExperienceIsEnabled");hd.w5(new Jj(V,Ea.Fko,Md,!1),hf.lH);yd&&!Va&&hd.w5(new na(new Ya,Ea,V),hf.lH);V=l.AFrameworkApplication.Ha.Ib.gPh?
new Fl(Ea,new fj):new yj(Ea,Za);hd.w5(V,hf.contextMenu);(Ab&&Ea.EBk||gc)&&hd.w5(pd.dXl(Ea,!0),hf.lH);hd.w5(V,hf.lH);!Ea.ubn||Va||"Word"===Ea.application&&Ea.B0l||hd.w5(new dj(Ea),hf.lH);Ea.nLd&&!Va&&(gc=new fg(Ea),hd.w5(gc,hf.lH),hd.w5(gc,hf.contextMenu));!Ea.hkc||Ea.tmh||Ea.b6e||Va||hd.w5(new pg(Ea),hf.lH);ia&&(Ea.Dsb||ie.Utb())&&(gc=new sj(Ea),hd.w5(gc,hf.lH),hd.w5(gc,hf.contextMenu));Ab&&hd.w5(pd.dXl(Ea,!1),hf.lH);ia&&!Ea.wol&&ie.hgl(Ea)&&!Va&&(hd.w5(new Ni(Ea),hf.lH),Ea.zho&&hd.w5(new Ni(Ea),
hf.contextMenu));Hc&&hd.w5(new Ai(Ea),hf.lH);!Ea.g6e&&!Ea.doa||Va||hd.w5(new Bi(Ea),hf.lH);Ea.Ckg&&!Va&&hd.w5(new Qc(Ea),hf.lH);Ea.eOh&&(Ab=new Ne(Ea),hd.w5(Ab,hf.lH),hd.w5(Ab,hf.contextMenu));ia&&Ea.iOh&&!Va&&hd.w5(new Xf(Ea),hf.lH);fd&&"Excel"===Ea.application&&!Va&&hd.w5(new Ih(Ea),hf.lH);return hd}}Object(k.a)(Xd,"AggregatorResultsProvider",null,[749]);var Fe=a(1149);class df{constructor(V="",Ea="",Za="",ia=-99999,Va=-1,Ab=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=
0;this.Title=V?V:"";this.Description=Ea?Ea:"";this.Type=Za?Za:"";this.Score=ia;this.Age=Va;this.Count=Ab}}Object(k.a)(df,"Suggestion",null,[]);class xf{constructor(V,Ea){this.GroupType=this.Suggestions=null;this.Suggestions=V;this.GroupType=Ea}}Object(k.a)(xf,"SuggestionGroup",null,[]);class Nf{}Nf.Bfa="help";Nf.NWm="answer";Nf.commands="commands";Nf.G$n="servicecommands";Nf.Wql="template";Object(k.a)(Nf,"SuggestionGroupType",null,[]);class nf{constructor(V,Ea,Za){this.H$h=0;this.ami=this.Tlf=null;
this.zx=V;this.Pki=this.q9h=this.fci=!1;this.ZMm=Ea;this.Dn=l.AFrameworkApplication.$d;this.ie=Za;this.VCh=this.jhi=0}get sZa(){return this.zx.sZa}UZh(V){this.zx.UZh(V)}Lbm(){if(this.Tlf){var V=0;for(const Ea of this.Tlf)this.zx.oCn(Ea,V++);this.Tlf=null}}beginQuery(V,Ea,Za){this.zx.jCn(V,Ea,Za)}$lm(V,Ea){this.zx.pYm(V,Ea);this.fci=!0;this.Pki=!1}Zlm(){this.fci=!1;this.q9h||(this.Lbm(),this.zx.OZl(this.H$h))}kCn(V,Ea){this.zx.lCn(V,Ea)}LQn(V,Ea,Za,ia,Va){for(const Ab of this.ZMm)if(V.startsWith(Ab)){this.Pki=
!0;break}this.zx.ABn(V,Ea,Za,ia,Va)}VQn(V){this.q9h=!1;this.H$h=V;this.fci||this.Pki||(this.Lbm(),this.zx.OZl(this.H$h,!1))}UQn(V,Ea){this.zx.CBn(V,Ea);this.q9h=!0}Mbj(V,Ea){if(!V.count)return"";let Za="";const ia=Date.now();for(const Va of V)V=(ia-Va.timeStamp)/1E3,V=ie.K1h(V),0<Za.length&&(Za+=";"),Za+=Ea?Va.commandId:Va.controlId,Za+=":",Za+=V.toString();return Za}l_g(){var V=this.Mbj(Fe.a.instance.Wqc,!1);0<V.length&&this.zx.zBn(V);V=this.Mbj(Fe.a.instance.aNb,!0);0<V.length&&this.zx.oBn(V);V=
this.Mbj(Fe.a.instance.Dgd,!0);0<V.length&&this.zx.SBn(V);V=qe.instance.Bej();0<V.length&&this.zx.iCn(Ka.c(V))}vCn(V){this.zx.wBn(V)}Jhb(V,Ea,Za,ia,Va,Ab,gc,Hc=null){this.zx.aCn(V,Ea,Za,ia,Va,Ab,gc,Hc)}q7j(V,Ea,Za,ia){this.zx.q7j(V,Ea,Za,ia)}Zfa(V,Ea,Za=null){this.zx.H5(V,Ea,Za)}onError(V,Ea,Za=null){this.zx.D3b(V,Ea,Za)}Zao(V){this.Tlf=V}gmn(V){const Ea=[];if(!V)return Ea;for(let Za=0;Za<V.length;Za++){const ia=si[V[Za].groupType].toLowerCase(),Va=[],Ab=V[Za].results;if(Ab){for(let gc=0;gc<Ab.length;gc++)"findindocument"===
ia?Array.add(Va,new df("","",ia,Ab[gc].score,Ab[gc].hGh,Ab[gc].count)):Array.add(Va,new df(Ab[gc].label,Ab[gc].description,ia,Ab[gc].score,Ab[gc].hGh,Ab[gc].count));"answer"===ia||"definition"===ia||"wolframanswer"===ia||"entity"===ia?Array.add(Ea,new xf(Va,Nf.NWm)):"classifier"===ia||"appsforoffice"===ia?Array.add(Ea,new xf(Va,Nf.commands)):"serviceclassifier"===ia?Array.add(Ea,new xf(Va,Nf.G$n)):"assistance"===ia?Array.add(Ea,new xf(Va,Nf.Bfa)):("document"===ia||"people"===ia||"findindocument"===
ia||"notes"===ia||"image"===ia||"template"===ia)&&Array.add(Ea,new xf(Va,ia))}}return Ea}fsj(V,Ea){const Za={};Za.Query=Ea;Za.SuggestionGroups=Ka.c(this.gmn(V));return Ka.c(Za)}U4l(V){const Ea={"Content-Type":"application/json",Accept:"application/json"};Ea["X-Office-Version"]=l.AFrameworkApplication.buildVersion;Ea["X-Office-Application"]=l.AFrameworkApplication.ha.Ma("Application");Ea["X-Office-Platform"]="WAC";Ea["X-TellMe-SqmUserId"]=l.AFrameworkApplication.ha.Ma("LoggableUserId")||"";Ea["X-TellMe-SessionId"]=
this.zx.sZa.interactionId;Ea["X-TellMe-SuggestionTypes"]="Ranker";Ea["X-TellMe-Culture"]=l.AFrameworkApplication.uiCulture;Ea["X-TellMe-ProcessSessionId"]=l.AFrameworkApplication.userSessionId;Ea["X-TellMe-Flights"]=V;Ea["X-TellMe-PartialQueryIndex"]=this.jhi;return Ea}vve(V,Ea,Za){this.Jhb(Ea.length,"RankerLogging",V.data.Je.toString(),Math.round(window.performance.now()-Za),bj.kCm,!0,Uh.Blc)}mue(V,Ea,Za){this.Jhb(Ea.length,"RankerLogging",V.data.Je.toString(),Math.round(window.performance.now()-
Za),bj.kCm,!1,Uh.Blc)}V4l(){this.ami||(this.ami=new pd(this.ie,null,6E3));return this.ami.TWa}K7j(V){const Ea=this.fsj(this.Tlf,V),Za=this.U4l("RankerLogging"),ia=window.performance.now();this.Dn.ik(this.V4l(),2,Ea,Za,!1,0,Va=>{this.vve(Va,V,ia)},Va=>{this.mue(Va,V,ia)},null,null,!1,4E3,6E3);this.jhi++}Y7n(){this.jhi=0}R9k(V){this.VCh=V}}Object(k.a)(nf,"InteractionLogger",null,[]);class Ig{constructor(V,Ea,Za,ia=0){this.I5l=V;this.groupType=Ea;this.xwj=ia;this.Ueh=Za}}Object(k.a)(Ig,"SortingGroup",
null,[]);class bg{constructor(V,Ea,Za,ia){this.order=V;this.J_b=Ea;this.Pnn=Za;this.groupType=ia}}Object(k.a)(bg,"SortingProp",null,[]);class oh{constructor(V,Ea){this.mhm={};this.lhm={};this.Wgm=this.Qim=1;this.FSl(V,Ea)}kgo(V,Ea,Za){var ia=ie.vca(Za)?this.mhm:this.lhm;Za=new Zb.a;for(var Va of Ea)Ea=Object(ld.a)(bg,ia[si[Va.groupType].toLowerCase()]),Le.b(Ea)||Za.add(new Nc.a(Ea,Va));Za.Sc((gc,Hc)=>gc.key.order<Hc.key.order?-1:1);Array.clear(V);Va=qe.instance.Qsj();for(Ea=0;Ea<Za.count;){ia=Za.ka(Ea).key.J_b;
var Ab=Za.ka(Ea).value;const gc=new Hb(Za.ka(Ea).key.groupType);Le.b(Va)||Va.Location===hf.contextMenu||(gc.displayName=Za.ka(Ea).key.Pnn);for(const Hc of Ab.results)gc.hR(Hc);for(Ab=++Ea;Ab<Za.count&&Za.ka(Ab).key.J_b===ia;)this.kri(gc,Za.ka(Ab).value),Ab=++Ea;V.push(gc)}}Rmo(V,Ea){this.Wgm=this.Qim=1;this.FSl(V,Ea)}FSl(V,Ea){this.SAm(V);for(var Za=0;Za<V.length;Za++){const ia=V[Za];for(const Va of ia.Ueh)this.DTm(Va,Za,ia.I5l,ia.groupType)}this.SAm(Ea);for(V=0;V<Ea.length;V++){Za=Ea[V];for(const ia of Za.Ueh)this.CTm(ia,
V,Za.I5l,Za.groupType)}}SAm(V){V.sort((Ea,Za)=>Object(ld.a)(Ig,Ea).xwj>Object(ld.a)(Ig,Za).xwj?-1:1)}DTm(V,Ea,Za,ia){this.mhm[si[V].toLowerCase()]=new bg(this.Qim++,Ea,Za,ia)}CTm(V,Ea,Za,ia){this.lhm[si[V].toLowerCase()]=new bg(this.Wgm++,Ea,Za,ia)}kri(V,Ea){for(let Za=0;Za<Ea.results.length;Za++)V.hR(Ea.results[Za])}}Object(k.a)(oh,"BaseGroupingSorter",null,[]);class rh{constructor(){this.jUh=[new Ig("",26,[26]),new Ig("",24,[24]),new Ig(Object(Wa.a)("TellMeRecentlyUsedTitleV2"),4,[4,2]),new Ig(Object(Wa.a)("TellMeCommandProviderTitle"),
7,[18,16,7]),new Ig(Object(Wa.a)("TellMeSuggestionsProviderTitle"),33,[15,14,19,3]),new Ig("",13,[13]),new Ig("",22,[22])];this.QSh=[new Ig("",25,[25]),new Ig(Object(Wa.a)("TellMeCommandProviderTitle"),31,[17,0,1,8,28]),new Ig(Object(Wa.a)("TellMeSuggestedSearchesProviderTitle"),32,[2,19,23,29]),new Ig(Object(Wa.a)("TellMePotentialMatchesProviderTitle"),33,[15,14,20,9,12,10,11,27]),new Ig("",13,[13]),new Ig("",22,[22])];this.Oem=new oh(this.jUh,this.QSh)}Toh(V,Ea,Za,ia=null,Va=null){let Ab=!1;if(ia){for(const gc of ie.vca(Za)?
this.jUh:this.QSh)this.m3n(gc,ia);Ab=!0}if(Va){for(const gc of ie.vca(Za)?this.jUh:this.QSh)this.Smo(Ea,gc,Va);Ab=!0}Ab&&this.Oem.Rmo(this.jUh,this.QSh);this.Oem.kgo(V,Ea,Za)}m3n(V,Ea){const Za=new Zb.a;for(var ia of V.Ueh){const Va=Ea[si[ia].toLowerCase()];Za.add(new Nc.a(Le.b(Va)?Number.MAX_VALUE:Va,ia))}if(Za.count){Za.Sc((Va,Ab)=>Va.key<Ab.key?-1:1);Ea=Array(Za.count);for(ia=0;ia<Za.count;ia++)Ea[ia]=Za.ka(ia).value;V.Ueh=Ea}}Smo(V,Ea,Za){let ia=0;for(const Va of Ea.Ueh)if(si[Va].toLowerCase()in
Za&&Za[si[Va].toLowerCase()])for(const Ab of V)if(Ab.groupType===Va){ia+=Za[si[Va].toLowerCase()];break}Ea.xwj=ia}}Object(k.a)(rh,"SimplifiedGroupingSorter",null,[]);class Mh{constructor(V){this.khm={};this.ihm={};this.jhm={};this.nhm={};this.Glk={};this.vhm=this.oHn=this.JGn=this.WGn=1;this.Vhm=null;this.OJ=V;this.DZm();this.tYn();this.CZm();this.$Ym();V.doa&&(this.Vhm=new rh)}v5(V){this.khm[si[V].toLowerCase()]=this.WGn++}r$(V,Ea){this.ihm[si[V].toLowerCase()]=Ea}Ijc(V){this.jhm[si[V].toLowerCase()]=
this.JGn++}VLa(V){this.nhm[si[V].toLowerCase()]=this.oHn++}W0(V){this.Glk[si[V].toLowerCase()]=this.vhm++}DZm(){const V=!!this.OJ&&this.OJ.jnd,Ea=!!this.OJ&&this.OJ.O1g,Za=!!this.OJ&&this.OJ.knd,ia=!!this.OJ&&this.OJ.iZj&&!ie.wZe(),Va=!!this.OJ&&this.OJ.Ckg,Ab=!!this.OJ&&this.OJ.iOh,gc=!!this.OJ&&this.OJ.SUj,Hc=!!this.OJ&&this.OJ.eOh;this.OJ&&(this.OJ.BJh||this.OJ.Ffb||this.OJ.DJh)&&this.v5(26);Hc&&this.v5(24);this.v5(4);this.v5(18);this.v5(16);this.v5(7);this.v5(17);this.v5(0);this.v5(1);gc&&this.v5(28);
Va&&this.v5(23);V||this.v5(2);V&&!Ea||this.v5(8);this.v5(15);Za&&this.v5(20);this.v5(14);this.v5(9);this.v5(12);this.v5(10);this.v5(11);V&&this.v5(2);V&&!Ea&&this.v5(8);this.v5(19);Ab&&this.v5(27);this.v5(21);this.v5(13);ia&&this.v5(22);this.v5(30)}tYn(){this.r$(21,1);this.r$(4,3);this.r$(18,3);this.r$(16,3);this.r$(7,3);this.r$(17,5);this.r$(0,5);this.r$(1,1);this.r$(28,2);this.r$(2,1);this.r$(8,2);this.r$(15,3);this.r$(14,2);this.r$(27,3);this.r$(9,1);this.r$(12,1);this.r$(10,1);this.r$(11,1);this.r$(19,
1);this.r$(23,1);this.r$(13,1);this.r$(24,1);this.r$(25,1);this.r$(20,2);this.r$(22,1);this.r$(26,1)}CZm(){this.Ijc(4);this.Ijc(0);this.Ijc(17);this.Ijc(7);this.Ijc(16);this.Ijc(18);this.Ijc(15);this.Ijc(20);this.Ijc(8);this.Ijc(14)}$Ym(){this.VLa(14);this.VLa(10);this.VLa(12);this.VLa(9);this.VLa(11);this.VLa(20);this.VLa(15);this.VLa(8);this.VLa(2);this.VLa(1);this.VLa(27);this.VLa(7);this.VLa(18);this.VLa(16);this.VLa(17);this.VLa(0);this.VLa(4)}d8n(){this.Glk={};this.vhm=1}Jkn(V,Ea,Za){this.d8n();
const ia=!!this.OJ&&this.OJ.jnd,Va=!!this.OJ&&this.OJ.O1g,Ab=!!this.OJ&&this.OJ.knd,gc=!!this.OJ&&this.OJ.iZj&&!ie.wZe(),Hc=!!this.OJ&&this.OJ.Ckg,fd=!!this.OJ&&this.OJ.iOh,hd=!!this.OJ&&this.OJ.SUj,yd=!!this.OJ&&this.OJ.w_h,Md=!!this.OJ&&this.OJ.eOh;V=V&&Va;yd&&this.W0(25);this.W0(4);this.W0(18);this.W0(16);this.W0(7);this.W0(17);this.W0(0);this.W0(1);Md&&this.W0(24);hd&&this.W0(28);Hc&&this.W0(23);ia&&!Va||!V||this.W0(8);Ea&&this.W0(15);ia||this.W0(2);fd&&this.W0(27);Za&&this.W0(14);ia&&!Va||V||
this.W0(8);Ea||this.W0(15);Ab&&this.W0(20);Za||this.W0(14);this.W0(9);this.W0(12);this.W0(10);this.W0(11);ia&&this.W0(2);ia&&!Va&&this.W0(8);this.W0(19);this.W0(21);this.W0(13);gc&&this.W0(22);return this.Glk}ufa(){return this.OJ}}Object(k.a)(Mh,"GroupsPlacementInfo",null,[]);var gi=a(315);class Si{constructor(V,Ea,Za,ia,Va,Ab){this.groupType=V;this.resultType=Ea;this.pol=Za;this.J_b=ia;this.x_i=Va;this.resultIndex=Ab}}Object(k.a)(Si,"ClickLoggingInfo",null,[]);const Sj=V=>{const Ea=[];for(;V;)Array.add(Ea,
"{ContextId:"+V.contextId+", IsGraphNodeContext:"+V.Al+"}"),V=V.TF;Ea.reverse();return"{"+Ea.join(", ")+"}"};class mk{constructor(){this.interactionId=this.sessionId=null}}Object(k.a)(mk,"CorrelationRecord",null,[965]);class Fj{constructor(V,Ea){this.provider=V;this.Otd=Ea}}Object(k.a)(Fj,"ExternalResultProvider",null,[]);class Oi{constructor(V,Ea){this.Id=null;this.TimeStamp=0;this.Id=V;this.TimeStamp=Ea}}Object(k.a)(Oi,"MRUControl",null,[]);var ti;(function(V){V[V.mGm=0]="Answer";V[V.Definition=
1]="Definition";V[V.sHm=2]="Entity";V[V.aLm=3]="WolframAnswer";V[V.oGm=4]="Assistance";V[V.Command=5]="Command";V[V.Document=6]="Document";V[V.NKm=7]="TryQuery";V[V.JHm=8]="FindInDocument";V[V.Jro=9]="HelpAction";V[V.oIm=10]="Insights";V[V.FJm=11]="People";V[V.Image=12]="Image";V[V.mro=13]="FirstRunResult";V[V.bto=14]="NoCommandsFoundResult";V[V.JKm=15]="TestResult";V[V.rpo=16]="AppsForOffice_Installed";V[V.tpo=17]="AppsForOffice_Recommandation";V[V.spo=18]="AppsForOffice_Query";V[V.cto=19]="Notes_Onenote";
V[V.dto=20]="Notes_Samsung";V[V.eto=21]="Notes_Sticky";V[V.LIm=22]="Learning";V[V.Feedback=23]="Feedback";V[V.IKm=24]="Template";V[V.fGl=25]="ActionAI";V[V.fGm=26]="ActionAICommand";V[V.hGm=27]="Addin";V[V.tJm=28]="OfficeScript";V[V.iGm=29]="AddinStoreEntry";V[V.Bro=30]="GenerateSlides";V[V.F5h=31]="SummarizeDeck";V[V.Unknown=32]="Unknown"})(ti||(ti={}));Object(k.b)("ResultType",ti);var Dj=a(394);class $h{constructor(V,Ea){this.wPm=10;this.ZWa=[];this.XPb=[];this.aLl=this.$Kl=!1;this.jnf=this.hnf=
"";this.rSe=Ea;this.ie=V}V_f(){!this.$Kl&&this.ie&&(this.hnf="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.ie.application,this.ZWa=this.c2l(),this.$Kl=!0);return this.ZWa}lkn(){!this.aLl&&this.ie&&(this.jnf="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.ie.application,this.XPb=this.c2l(!0),this.aLl=!0);return this.XPb}kzn(V){return V.startsWith("TellMeUpsell")||"OpenInClientUpsell"===V||"TryOfficeUpsell"===V}wPj(V){return this.mwn(V)||this.kzn(V)||ie.jam(V)?!1:!0}hTm(V){V=V.ControlId;this.wPj(V)&&(V=
this.jYk(V),this.c6n(V),this.JHn(),Array.insert(this.ZWa,0,new Oi(V,Date.now())),this.hnf.length&&(V=JSON.stringify(this.ZWa),Dj.a.instance.setItem(this.hnf,V)))}w5(V){this.IHn();Array.insert(this.XPb,0,new Oi(ti[V],Date.now()));this.jnf.length&&(V=JSON.stringify(this.XPb),Dj.a.instance.setItem(this.jnf,V))}c2l(V=!1){if(!this.ZWa.length){var Ea=V?Dj.a.instance.getItem(this.jnf):Dj.a.instance.getItem(this.hnf);if(!Ea||""===Ea)return V?this.XPb:this.ZWa;let Za=null;try{Za=JSON.parse(Ea)}catch(ia){this.O0m(V),
Za=null}if(!Za||!Za.length||10<Za.length)return V?this.XPb:this.ZWa;Ea=0;for(const ia of Za)if(V||this.ie.AZe(ia.Id)&&this.wPj(ia.Id))if(V?Array.insert(this.XPb,Ea++,ia):Array.insert(this.ZWa,Ea++,ia),Ea===this.rSe)break}return V?this.XPb:this.ZWa}qJf(V){V=this.jYk(V);for(const Ea of this.ZWa)if(Ea.Id===V)return!0;return!1}O0m(V=!1){Dj.a.instance.setItem(V?this.jnf:this.hnf,"")}Nwn(V){V=this.jYk(V.ControlId);return this.wPj(V)?this.qJf(V):!1}c6n(V){if(0<this.ZWa.length){let Ea=0;for(const Za of this.ZWa){if(Za.Id===
V){Array.removeAt(this.ZWa,Ea);break}Ea++}}}jYk(V){return"Excel"===this.ie.application&&V.startsWith("m_excelWebRenderer_ewaCtl_")?V.substr(26,V.length):V}JHn(){this.ZWa.length===this.rSe&&Array.removeAt(this.ZWa,this.ZWa.length-1)}IHn(){this.XPb.length===this.wPm&&Array.removeAt(this.XPb,this.XPb.length-1)}mwn(V){V=V.split("|");let Ea="";if(6<=V.length)Ea=V[0];else if(3<=V.length){if("3"===V[0])return!0;Ea=V[1]}return Ea.startsWith("WA")}static createInstance(V){let Ea=3;l.AFrameworkApplication.ha&&
(Ea=l.AFrameworkApplication.ha.Ac("TellMeMaxRecommendedResultsToReturn",3));return new $h(V,Ea)}}Object(k.a)($h,"MruControlsManager",null,[964]);class $k{constructor(V){this.kEd=V}cwa(V,Ea){let Za;return V.Uta&&(Za=this.kEd[V.value])?Za.cwa(V,Ea):(Za=this.i2l(V.value))?Za.cwa(Za.bJn,Ea):null}Cjn(V,Ea){if(V=this.kEd[V])for(const Za of Ea)if(Ea=ie.getParameter(Za),Ea.key===V.UVn)return Ea.value;return null}sPn(V){(V=this.i2l(V))&&V.qPn()}i2l(V){const Ea=V.indexOf(ie.bpm);return 0<Ea?this.kEd[V.substring(0,
Ea)]:null}}Object(k.a)($k,"ParameterizedCommandManager",null,[963]);class xk{constructor(V,Ea){this.gm=V;this.vrd=Ea}}Object(k.a)(xk,"TellMeQuery",null,[]);class ui{constructor(V,Ea){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=V;this.TimeElapsedSinceClick=Ea}}Object(k.a)(ui,"CommandClickedEvent",null,[]);class gj{constructor(V,Ea){this.SPm=V;this.rqf=Ea}zF(V){this.SPm(Le.b(V.query)?"":V.query.gm,V.FA,V.attributes,this.rqf,V.rZe)}}Object(k.a)(gj,"ResultsUpdatedCallback",null,[962]);class Kj{constructor(V,
Ea,Za,ia,Va){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=V;this.TimeElapsedSinceClick=Za;this.CommandSurface=ia;this.CommandId=Ea;this.TerminalParentControlId=Va}}Object(k.a)(Kj,"UserActionEvent",null,[]);class Sk{constructor(V,Ea){this.menuModel=V;this.Ivm=Ea}}Object(k.a)(Sk,"GeneratedMenuModel",null,[]);class tj{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=
null}}Object(k.a)(tj,"MenuModel",null,[]);class gk{constructor(V,Ea,Za){this.ie=V;this.kEd=Ea;this.iFh=Za}tdn(V,Ea,Za){let ia=0;const Va=new tj,Ab=[];let gc="";Va.sections=[];let Hc=new Zb.a;const fd=!!this.ie&&this.ie.jnd;var hd=!!this.ie&&this.ie.Usd||l.AFrameworkApplication.Ha.Ib.Usd;for(const Md of V){V=0;fd||(Hc=new Zb.a);const te=new Zb.a;let Pe=Md.displayName;for(const t of Md.results){if(0<=t.value.indexOf(ie.$kl)){if(t.Uta){var yd=this.kEd[t.value];if(yd&&t.value.endsWith(ie.$kl)){if("FindParameterized"!==
t.value&&!hd){const L=[];L.push(appChrome.actions.setControlLabel(t.value,yd.gin(t)));L.push(appChrome.actions.setButtonCommandValueId(t.value,yd.jfn(t)));appChrome.api.dispatch(L)}yd=t.value.replace(ie.$kl,"");Hc.remove(yd)?V--:te.add(yd);Hc.add(t.value);V++}}}else switch(t.type){case 5:te.contains(t.value)||(Hc.add(t.value),V++);break;case 7:Hc.add(t.Uta);V++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:Hc.add(t.value),
V++}13===Md.groupType&&(Pe=ie.Utb()?0<Ea.length?String.format(Object(Wa.a)("SeeMoreResultsButtonText"),Ea):Object(Wa.a)("SeeMoreResultsButtonTextNonParameteried"):String.format(Object(Wa.a)("InsightsButtonText"),Ea));21===Md.groupType&&(Pe=Object(Wa.a)("LearningUILiveText"))}ia+=V;""!==Pe&&0<V&&(gc+=" , "+V.toString()+" "+Object(Wa.a)("TellMeSectionLiveNotification")+" "+Pe+" , ");0<Hc.count&&!fd&&(V=appChrome.api.menuSection(Hc.toArray(),Md.displayName,null,si[Md.groupType]),Ab.push(V))}hd=null;
0<ia&&(hd=0<Ea.length?1!==ia?String.format(Object(Wa.a)("SearchLiveNotificationForTermedQueryResults"),ia,Ea):String.format(Object(Wa.a)("SearchLiveNotificationForTermedQueryResult"),Ea):1!==ia?String.format(Object(Wa.a)("LookupLiveNotificationResultPluralFormText"),ia):Object(Wa.a)("LookupLiveNotificationResultSingularFormText"),fd?(Ea=appChrome.api.menuSection(Hc.toArray(),"",null,null),Ab.push(Ea)):hd+=gc);Za&&(this.ie.LIb?qe.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(hd)):
appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(hd)));Va.sections=Ab;return new Sk(Va,ia,[])}static get o2i(){return gk.WJl||(gk.WJl=new Sk(Object.assign(new tj,{sections:[]}),0,[]))}}gk.WJl=null;Object(k.a)(gk,"TellMeMenuDefintionGenerator",null,[]);var Gk;(function(V){V[V.Fuo=0]="TellMeControlActivated";V[V.Huo=1]="TellMeQueryExecuted";V[V.Juo=2]="TellMeResultsRendered";V[V.Guo=3]="TellMeControlDeactivated"})(Gk||(Gk={}));Object(k.b)("PerformanceMarker",Gk);var cj;(function(V){V[V.Luo=
0]="TellMeTimeToRender";V[V.Kuo=1]="TellMeSessionLength";V[V.Iuo=2]="TellMeResultTriageTime"})(cj||(cj={}));Object(k.b)("PerformanceMeasure",cj);class Hk{mark(V){window.performance.mark(Gk[V])}measure(V,Ea,Za){try{window.performance.measure(cj[V],Gk[Ea],Gk[Za])}catch(ia){qe.instance.lq().onError("TellMePerformance:Measure","error measuring "+cj[V])}}f6j(V,Ea,Za){qe.instance.lq().q7j(Ea,Za,V,this.Kin(V))}tBc(V){for(const Ea of V)window.performance.clearMarks(Gk[Ea])}clearMeasures(V){for(const Ea of V)window.performance.clearMeasures(cj[Ea])}Kin(V){let Ea=
0;(V=this.Xdn(V))&&0<V.length&&(Ea=V[V.length-1].duration);return Ea}Xdn(V){return window.performance.getEntriesByName(cj[V],"measure")}}Object(k.a)(Hk,"TellMePerformance",null,[]);class Hl{constructor(V){this.YRm=V}MAk(V,Ea,Za){qe.instance.lq().Jhb(Ea,bj.W3e,V.data.Je.toString(),Math.round(window.performance.now()-Za),bj.W3e,!0,Uh.Blc);V=Ka.b(V.data.responseData);Ea=-1;V.Index&&(Ea=V.Index);qe.instance.lq().kCn(Ea,this.YRm)}HZg(V,Ea,Za){qe.instance.lq().Jhb(Ea,bj.W3e,V.data.Je.toString(),Math.round(window.performance.now()-
Za),bj.W3e,!1,Uh.Blc)}nkn(V){if(V&&""!==V.trim()){const Za=window.performance.now(),ia=l.AFrameworkApplication.b1h;var Ea={};Ea.Text=V;Ea.IsFileHash="false";Ea=Ka.c(Ea);l.AFrameworkApplication.$d.ik(ia,2,Ea,{"Content-Type":"application/json",Accept:"application/json"},!1,0,Va=>{this.MAk(Va,V.length,Za)},Va=>{this.HZg(Va,V.length,Za)},null,null,!1,4E3,6E3)}}}Object(k.a)(Hl,"TellMeQueryIndexCallback",null,[]);class pj{constructor(V,Ea,Za){this.xml=V;this.Ivm=Ea;this.E8m=Za}}Object(k.a)(pj,"GeneratedMenuXml",
null,[]);class kj{constructor(V,Ea){this.NCh=V||{};this.hvc=Ea}get cFe(){return 5}cwa(V,Ea=null){return this.hvc.cwa(V,Ea)||this.TYm(V.value)}TYm(V){return kj.SYm(V,this.NCh[V]||null)}static SYm(V,Ea=null){V=String.format('<ClonedControl Id="{0}" ',V);for(const Va in Ea){var Za=Va,ia=Ea[Va];ia=ia?la.a.We(ia.toString()):"";V+=String.format('{0}="{1}" ',Za,ia)}return V+"/>"}}Object(k.a)(kj,"CommandMenuItemFactory",null,[812]);class Ti{constructor(){this.TNm=Object(Wa.a)("FindInDocumentText")}get cFe(){return 8}cwa(V){var Ea=
V.Uta;V=la.a.We(V.value);const Za=la.a.We(Ea);Ea=la.a.We(String.format(this.TNm,Ea));return this.jdn(V,Za,Ea)}jdn(V,Ea,Za){return Ua.a(V,"1540292897",Za,ie.tbn,null,Ea,Za,null,null)}}Object(k.a)(Ti,"FindInDocumentMenuItemFactory",null,[812]);class dm{constructor(V=null){this.xOm=V||Object(Wa.a)("InsightsButtonText")}get cFe(){return 10}cwa(V){var Ea=V.Uta;V=ie.Utb()?ie.nDc(Ea,1):ie.AUi(Ea);Ea=String.format(this.xOm,Ea);return this.odn(V,Ea)}odn(V,Ea){return Ua.a(Xe.L8l,ie.Utb()?"1914896509":"3317204163",
la.a.We(Ea),ie.Lvn,null,la.a.We(V),la.a.We(Ea),null,null)}}Object(k.a)(dm,"InsightsMenuItemFactory",null,[812]);class hk{get cFe(){return 7}cwa(V){const Ea=Object(ld.a)(qk,V);return this.xdn(la.a.We(V.value),Ea.id)}xdn(V,Ea){return Ua.a(Ea,"1404166600",V,null,null,V,V,null,null)}}Object(k.a)(hk,"TryQueryMenuItemFactory",null,[812]);class Ui{constructor(V){this.KHa=[];this.ie=V}ahn(V){for(const Ea of this.KHa)if(Ea.cFe===V)return Ea;return null}sCb(V){this.KHa.push(V)}L4n(V){this.sCb(new kj(this.ie.Q2m,
V));this.sCb(new xd(this.ie.cPn));this.sCb(new Jc(this.ie.K9n,this.ie.J9n,this.ie.uio,this.ie.Fqn,this.ie.$co));this.sCb(new dm);this.sCb(new Ti);this.sCb(new jd);this.sCb(new hk)}}Object(k.a)(Ui,"MenuItemFactoryRegistry",null,[]);class Lj{constructor(V,Ea){this.ie=V;this.bMl=new Ui(this.ie);this.bMl.L4n(Ea)}udn(V,Ea){let Za=0;const ia=[],Va=[];for(const gc of V){V=ie.Vql;var Ab=[];for(const Hc of gc.results){const fd=this.bMl.ahn(Hc.type).cwa(Hc,Ea);V=ie.Vql;Ab.push(fd);if(13===Hc.type||14===Hc.type)V=
"Menu32";17===Hc.type&&(V="MenuTellMeExtended");Hc.groupType=gc.groupType;Va.push(Object(ld.a)(hb,Hc))}Za=Za?Za:Ab.length;Ab=Ua.c("TellMeDropdownControls",Ab);V=Ua.e("TellMeDropdownMenuSection",Ab,V,gc.displayName);ia.push(V)}Ea=Ua.f(ia,"LookupDropdownMenu");return new pj(Ea,Za,Va)}static get AJh(){return Lj.XJl||(Lj.XJl=new pj(Ua.f([],"LookupDropdownMenu"),0,[]))}}Lj.XJl=null;Object(k.a)(Lj,"TellMeXmlGenerator",null,[]);class qj{}qj.cJn="MRU";qj.test="Test";Object(k.a)(qj,"ActionType",null,[]);var Ik;
(function(V){V[V.juo=0]="Service";V[V.OIm=1]="Local";V[V.tso=2]="MRU";V[V.JKm=3]="TestResult";V[V.Unknown=4]="Unknown"})(Ik||(Ik={}));Object(k.b)("SubResultType",Ik);var Mj=a(17);class Il{constructor(V,Ea,Za,ia,Va=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=V;this.IsEnabled=Ea;this.ResultType=ti[Za];this.SubResultType=Ik[ia];this.OptionalData=Va?Mj.a.toJSON(Va):null}}Object(k.a)(Il,"ResultInfo",null,[]);var fl=a(158),em=a(143),
Lk=a(231);class gl{constructor(V,Ea=null){this.SKl="TellMeWAC.";this.eQm=V;this.hSm=Ea}rLb(V,Ea,Za){Ea=fl.a.Gt(Ea);V=fl.a.mVe(V,this.eQm,this.hSm,Za,Ea);em.a.rLb(V,this.SKl)}qLb(V,Ea,Za=0){Ea=fl.a.Gt(Ea);em.a.qLb(Object.assign(new Lk.a,{name:V,dataFields:Ea,durationMs:Za}),this.SKl)}}Object(k.a)(gl,"TellMeOtelLogger",null,[986]);class Ll{constructor(V,Ea,Za,ia,Va,Ab,gc){this.$Wa=this.Wya=this.kJl=null;this.zz=V;this.Mdf=Ea;this.zjc=Za;this.Ngd=ia;this.Etc=Va;this.$Om=Ab;this.$Wa=gc?gc:new gl(this.Ngd?
gi.a.w6e:gi.a.j7e)}get az(){return this.Ngd}get sZa(){return this.zjc}UZh(V){this.kJl=V;switch(V){case hf.contextMenu:this.Wya=hf.contextMenu;break;default:this.Wya=hf.lH}}pYm(V,Ea){this.zjc.interactionId||(this.zjc.interactionId=Lc.a.create().toString(),this.pbm(V,!0,Ea))}OZl(V,Ea=!0){this.zjc.interactionId&&this.NBn(V,Ea);this.Ngd&&appChrome.api.updateTellMeCorrelationId("");this.zjc.interactionId=null}pbm(V,Ea,Za){const ia=this.IXa(Ga.DYe);ia[ef.culture]=this.Mdf;ia[ef.appName]=this.zz;ia[ef.context]=
V;ia[ef.fnd]=this.Etc;ia[ef.izn]=this.$Om;ia[ef.Fyn]=Za;ia[ef.wxn]=Ea;ia[ef.contentType]=qe.instance.lNf;this.$Wa.rLb(Ga.DYe,ia,this.kJl);this.Ngd&&appChrome.api.updateTellMeCorrelationId(this.zjc.interactionId)}NBn(V,Ea){const Za=this.IXa(Ga.O8l);Za[ef.k9m]=V;Za[ef.vxn]=Ea;this.$Wa.qLb(Ga.O8l,Za)}jCn(V,Ea,Za){let ia=0;!Za&&0<V.length&&(ia=V.trim().split(" ").length);const Va=this.IXa(Ga.query);Va[ef.query]="!";Va[ef.queryId]=Ea;Va[ef.Wrm]=V.length;Va[ef.Eam]=Za;Va[ef.dpo]=ia;this.$Wa.rLb(Ga.query,
Va,this.Wya)}aCn(V,Ea,Za,ia,Va,Ab,gc,Hc=null){const fd=this.IXa(Ga.latency);fd[ef.culture]=this.Mdf;fd[ef.Wrm]=V;fd[ef.zDm]=Ea;fd[ef.statusCode]=Za;fd[ef.F$n]=Va;fd[ef.isSuccess]=Ab;fd[ef.kAn]=gc;Hc&&(fd[ef.fjo]=Hc);this.$Wa.qLb(Ga.latency,fd,ia)}q7j(V,Ea,Za,ia){const Va=this.IXa(Ga.performance);Va[ef.culture]=this.Mdf;Va[ef.qYm]=Gk[V];Va[ef.e$m]=Gk[Ea];Va[ef.RWn]=cj[Za];this.$Wa.qLb(Ga.performance,Va,ia)}oCn(V,Ea){if(V.results.length){var Za=this.IXa(Ga.gvm);Za[ef.J_b]=Ea.toString();Za[ef.groupType]=
si[V.groupType];16===V.groupType&&(Za[ef.wyn]=qe.instance.cfd);Ea=[];var ia=[],Va=[];for(const Ab of V.results)Za[ef.resultType]||(Za[ef.resultType]=ti[Ab.type]),V={},27===Ab.type&&(V.AssetId=Ab.additionalInfo),ia.push(gh.ENc(Ab.value)),Ea.push(Ab.value),Va.push(new Il(Ab.value,gh.ENc(Ab.value),Ab.type,Ab.subType,V));0<Ea.length&&(Za[ef.z8n]="{"+Ea.join(", ")+"}",Za[ef.S9m]="{"+ia.join(", ")+"}",Za[ef.v8n]=Ka.c(Va));this.$Wa.rLb(Ga.gvm,Za,this.Wya)}}Ldn(V,Ea){if(4===V)return qj.cJn;switch(Ea){case 5:case 16:case 17:case 18:return"Command";
case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return ti[Ea]}ABn(V,Ea,Za,ia,Va){const Ab=this.IXa(Ga.click);Ab[ef.zDm]=V;Ab[ef.WVn]=Ea;Ab[ef.commandId]=Za;Ab[ef.JMa]=ia;Ab[ef.actionType]=this.Ldn(Va.groupType,Va.resultType);Ab[ef.resultType]=ti[Va.resultType];Ab[ef.pol]=Ik[Va.pol];Ab[ef.groupType]=si[Va.groupType];Ab[ef.J_b]=Va.J_b.toString();Ab[ef.x_i]=Va.x_i.toString();Ab[ef.resultIndex]=Va.resultIndex.toString();this.$Wa.rLb(Ga.click,Ab,this.Wya)}CBn(V,
Ea){this.zjc.interactionId||(this.zjc.interactionId=Lc.a.create().toString(),this.pbm("",!1,Ea));Ea=this.IXa(Ga.HVl);Ea[ef.queryId]=V;this.$Wa.qLb(Ga.HVl,Ea)}vbm(V,Ea,Za){if(V){if(Za)for(const ia in Za)V[ia]=Za[ia];this.$Wa.qLb(Ga.events,V,Ea)}}H5(V,Ea,Za=null){const ia=this.IXa(Ga.events);ia[ef.event]=V;this.vbm(ia,Math.round(Ea),Za)}D3b(V,Ea,Za=null){const ia=this.IXa(Ga.events);ia[ef.event]=Ga.error;ia[ef.module]=V;ia[ef.errorMessage]=Ea;ia[ef.message]=Ea;this.vbm(ia,Math.round(window.performance.now()),
Za)}zBn(V){const Ea=this.IXa(Ga.RUl);Ea[ef.value]=V;Ea[ef.LXh]=this.Ngd;this.$Wa.rLb(Ga.RUl,Ea,this.Wya)}oBn(V){const Ea=this.IXa(Ga.SOl);Ea[ef.value]=V;Ea[ef.LXh]=this.Ngd;this.$Wa.rLb(Ga.SOl,Ea,this.Wya)}SBn(V){const Ea=this.IXa(Ga.w0l);Ea[ef.value]=V;Ea[ef.LXh]=this.Ngd;this.$Wa.rLb(Ga.w0l,Ea,this.Wya)}iCn(V){const Ea=this.IXa(Ga.Prm);Ea[ef.value]=V;Ea[ef.LXh]=this.Ngd;this.$Wa.rLb(Ga.Prm,Ea,this.Wya)}wBn(V){const Ea=this.IXa(Ga.Dxm);Ea[ef.value]=V;this.$Wa.rLb(Ga.Dxm,Ea,this.Wya)}lCn(V,Ea){const Za=
this.IXa(Ga.Vrm);Za[ef.W3e]=V;Ea&&(Za[ef.interactionId]=Ea);this.$Wa.qLb(Ga.Vrm,Za)}IXa(V){return{["SessionID"]:this.zjc.sessionId,["CorrelationID"]:this.zjc.interactionId,["Time"]:(new Date).getTime(),["Event"]:V,["Scenario"]:this.Wya}}}Object(k.a)(Ll,"UsageLogger",null,[961]);class Xl{}Xl.Callback="action";Object(k.a)(Xl,"MenuLauncherAsyncTriggerCommandProperties",null,[]);var tf=a(565),Df=a(975),og=a(360),zj=a(324),kg=a(98);class Te{constructor(V=null){this.hvc=this.Fe=this.Ga=this.MU=this.g$=
this.Ce=this.Aa=this.m2=this.Bfi=this.KOl=this.Ulb=null;this.kLl=this.mSe=!1;this.JRe=null;this.zkf=this.Etc=!1;this.vgd=this.TRe=this.kNb=this.zEh=this.zDh=this.Nfi=null;this.gSe=!1;this.Ifi=0;this.HRe=null;this.cMl=0;this.Pkf=!1;this.LB=this.fV=this.ygd=null;this.CVe=(Ea,Za,ia,Va,Ab)=>{if(Za.contextId===kg.a.frame)switch(Ea){case ta.a.lH:return this.lH(Ea,Za,ia,Va,Ab);case ta.a.T0h:return this.hTl(Ea,Za,ia,Va,Ab);case ta.a.X0h:return this.Dbm(Ea,Za,ia,Va,Ab);case ta.a.$0h:return this.tbm(Ea,Za,
ia,Va,Ab);case ta.a.Z0h:return this.Bbm(Ea,Za,ia,Va,Ab);case ta.a.V0h:return this.DYe(Ea,Za,ia,Va,Ab);case ta.a.c1h:return this.hga(ia);case ta.a.Y0h:return this.Abm(Ea,Za,ia,Va,Ab);case ta.a.a1h:return this.sbm(Ea,Za,ia,Va,Ab);case ta.a.vtd:return this.V0l(Ea,Za,ia,Va,Ab);case ta.a.S0h:return this.oVl(Ea,Za,ia,Va,Ab);case ta.a.e1h:case ta.a.EPh:return this.HLj(Ea,Za,ia,Va,Ab);case ta.a.iKh:case ta.a.jKh:case ta.a.kKh:case ta.a.lKh:case ta.a.mKh:case ta.a.XVh:case ta.a.YVh:case ta.a.ZVh:case ta.a.f1h:return this.nnc(Ea,
Za,ia,Va,Ab);case ta.a.xWh:case ta.a.yWh:case ta.a.zWh:return this.Xcg(Ea,Za,ia,Va,Ab);case ta.a.U0h:return this.oom(Ea,Za,ia,Va,Ab);case ta.a.bGh:case ta.a.cGh:case ta.a.dGh:return this.NZe(Ea,Za,ia,Va,Ab);case ta.a.$ad:return this.$ad(Ea,Za,ia,Va,Ab);case ta.a.zPh:return this.Uam(Ea,Za,ia,Va,Ab);case ta.a.FXh:return this.dsm(Ea,Za,ia,Va,Ab);case ta.a.UKh:return this.w1l(Ea,Za,ia,Va,Ab)}return 2};this.dsm=(Ea,Za,ia,Va,Ab)=>{if(1===ia)return 32;if(Le.b(Ab))return Te.instance.Gw.onError("TellMeActor:QuickActionOnFileHandler",
"actiondata comes null"),16;this.Fe.GKh();if(Ea=Ab.TerminalParentControlId){Ea=this.MAc.ka(Ea);if(!Ea)return 16;Za=[];Array.add(Za,Ea);if(!this.Zam(Za))return 8}return 32};this.w1l=()=>{if(!this.MAc.count)return 16;const Ea=[];for(const Za of this.MAc.values)Array.add(Ea,Za);return this.Zam(Ea)?32:8};this.Xcg=(Ea,Za,ia,Va,Ab)=>{if(1===ia)return 32;if(Le.b(Ab))return Te.instance.Gw.onError("TellMeActor:InsertMention","actiondata comes null"),16;Ea=Ab.UILocation;let gc;Ab=Ab.CommandValueId;try{gc=Ka.a(Ab)}catch(Hc){return Te.instance.Gw.onError("TellMeActor:InsertMention",
"commandValueId is not in proper format"),16}return Le.b(gc)?(Te.instance.Gw.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):Le.b(this.zDh)?(Te.instance.Gw.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==Ea?(Te.instance.Gw.onError("TellMeActor:InsertMention","location "+Ea+" is unexpected"),16):this.zDh.Xcg(gc.displayName,gc.email,gc.userId)?32:(Te.instance.Gw.onError("TellMeActor:InsertMention","mention is not inserted"),16)};this.nnc=
(Ea,Za,ia,Va,Ab)=>1===ia?32:Le.b(Ab)?(Te.instance.Gw.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===Ab.UILocation?this.Jvn(ia,Ab):this.lFa(Ea,Za,ia,Va,Ab);this.oom=(Ea,Za,ia,Va,Ab)=>{if(1===ia)return 32;if(Le.b(Ab))return Te.instance.Gw.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.fV&&window.setTimeout(()=>{this.fV.execute(gc=>{gc.DEb("TellMeSurvey",null)})},Te.Tan);return 32};this.Lna=(Ea,Za,ia,Va,Ab)=>{ia=window.performance.now();this.cYn(Za);Te.instance.Gw.Zao(Za);
Te.instance.vy.az?(this.vgd=this.Bfi.tdn(Za,Ea,Ab),Te.instance.vy.LIb?(Te.instance.actions.push(appChrome.actions.updateTellMeSearchResults(this.vgd.menuModel,Ea,Ab)),appChrome.api.dispatch(Te.instance.actions)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.vgd.menuModel,Ea,Ab)),Te.instance.vy.p2h&&this.gSe&&(Le.b(Te.instance.goa)||Te.instance.goa.Location!==hf.contextMenu)&&(this.m2.mark(2),this.m2.measure(0,1,2))):this.kNb=this.KOl.udn(Za,Te.instance.Gw.sZa);this.HRe&&
this.Ce.Rb(this.HRe);Ab={};Ab.GroupsCount=Za.length;Ab.QueryID=Va;Ab.QueryLength=Ea.length;Te.instance.Gw.Zfa(Ga.q5m,window.performance.now()-ia,Ab)};this.Uam=(Ea,Za,ia,Va,Ab)=>{if(1===ia)return 32;if(Le.b(Ab))return Te.instance.Gw.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){Ea={};Ea.SourceControlId=Ab.SourceControlId;Ea.Query=Ab.CommandValueId;Ab=this.Aa.Ra(ta.a.OZe,2,Ea);if(32!==
Ab)Te.instance.Gw.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+Ab+".");return Ab}return this.Aa.Ra(ta.a.OZe,2,Ab)};this.NZe=(Ea,Za,ia,Va,Ab)=>{if(1===ia)return 32;if(Le.b(Ab))return Te.instance.Gw.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;Ea=Ab.CommandValueId;if(Le.a(Ea))return Te.instance.Gw.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!Xf.iKd[Ea])return Te.instance.Gw.onError("TellMeActor:LaunchAddin",
"Add-in with assetId "+Ea+" doesn't not exist in entitlements"),16;Za=Xf.iKd[Ea];ia={};ia.solutionId=Za.id;ia.version=Za.appVersion;ia.storeType=Za.storeType;ia.storeId=Za.storeId;ia.assetId=Za.assetId;ia.assetStoreId=Za.assetStoreId;ia.displayName=Za.displayName;ia.targetType=Za.targetType;ia.height=Za.height;ia.width=Za.width;Za=this.Aa.Ra(ta.a.Ycg,2,ia);if(32!==Za)Te.instance.Gw.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+Za+". AssetId: "+Ea);return Za};
this.$ad=()=>{if(!Le.b(this.fV))for(const Ea of Fe.a.instance.aNb){if("ShowContextMenuWithFloatie"===Ea.commandId)return this.fV.execute(Za=>{Za.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(Ea.commandId&&-1===Ea.commandId.indexOf("Tab"))break}return 8};this.LB=V?V:new qe}jLh(){return this.LB.jLh()}hfj(){return this.LB.hfj()}buj(){return this.LB.buj()}Aej(){return this.LB.Aej()}Bej(){return this.LB.Bej()}get lNf(){return this.MU?this.MU.contentType:Te.unknown}mNf(){return this.MU?
[""]:[]}klj(){return this.LB.Chb}lq(){return this.LB.lq()}get actions(){return this.LB.actions}set actions(V){this.LB.actions=V}tXe(){return this.LB.tXe()}ufa(){return this.LB.ufa()}Xij(){return this.LB.Xij()}get JVg(){return this.LB.JVg}set tSe(V){this.LB.JVg=V}get QAh(){return this.LB.QAh}set dEh(V){this.LB.QAh=V}Qsj(){return this.LB.Qsj()}performance(){return this.m2}get hoh(){return this.LB.RJe}set hoh(V){this.LB.RJe=V}get cfd(){return this.LB.cfd}set cfd(V){this.LB.cfd=V}CE(V){return this.LB.CE(V)}initialize(V,
Ea=null,Za=null,ia=null,Va=null,Ab=null,gc=null,Hc=null,fd=null,hd=null,yd=null){Te.instance.vy=V;this.Etc=!!l.AFrameworkApplication.Ha&&l.AFrameworkApplication.Ha.Ib.Fgb;Te.instance.Gw=ia;if(!ia){ia=new mk;ia.sessionId=l.AFrameworkApplication.userSessionId;const Md=zj.a.Le(l.AFrameworkApplication.lcid)||zj.a.Olc;Te.instance.Gw=new nf(new Ll(Te.instance.vy.application,Md.name,ia,Te.instance.vy.az,this.Etc,V.cpc,null),Te.instance.vy.R2m,Te.instance.vy)}this.hvc=new $k(Te.instance.vy.parameterData);
this.KOl=Za||new Lj(Te.instance.vy,this.hvc);Te.instance.P5h=gc;this.Bfi=this.Bfi||new gk(Te.instance.vy,Te.instance.vy.parameterData,gc);this.Fe=v.FocusManager.instance();this.Chb=$h.createInstance(Te.instance.vy);Te.instance.GXe=new Mh(V);this.Aa=Va||l.AFrameworkApplication.ub;this.Ce=Ab||l.AFrameworkApplication.Zd;this.g$=fd;this.Ulb=Ea;this.fV=yd;this.m2=new Hk;this.MAc=new qf.a(lf.a.Co());this.zEh=[];fd?fd.execute(Md=>{Md.isFeatureEnabled(Te.gio,!0).then(te=>{this.Pkf=te;this.Ulb=this.Ulb||Xd.createInstance(this.Chb,
Te.instance.vy,this.hvc,this.Pkf);for(const Pe of this.zEh)this.Ulb.w5(Pe.provider,Pe.Otd);this.zEh=[];return null})}):(this.Pkf=!0,this.Ulb=this.Ulb||Xd.createInstance(this.Chb,Te.instance.vy,this.hvc,this.Pkf));this.Ga=Hc;this.kNb=Lj.AJh;this.dEh=new Promise(Md=>{this.Nfi=Md});hd&&hd.execute(Md=>{this.MU=Md})}Kb(){this.DUm()}DUm(){this.Aa.ua(ta.a.lH,kg.a.frame,Object(B.a)(this,this.lH,"tellMe"),96);this.Aa.ua(ta.a.T0h,kg.a.frame,Object(B.a)(this,this.hTl,"cacheAsyncMenuRefreshFunction"),96);this.Aa.ua(ta.a.X0h,
kg.a.frame,Object(B.a)(this,this.Dbm,"logItemExecuted"),96);this.Aa.ua(ta.a.$0h,kg.a.frame,Object(B.a)(this,this.tbm,"logControlDeactivation"),96);this.Aa.ua(ta.a.Z0h,kg.a.frame,Object(B.a)(this,this.Bbm,"logInputFocus"),96);this.Aa.ua(ta.a.V0h,kg.a.frame,Object(B.a)(this,this.DYe,"interactionBegin"),96);this.Aa.ua(ta.a.c1h,kg.a.frame,Object(B.a)(this,this.DYe,"interactionBegin"),96);this.Aa.ua(ta.a.Y0h,kg.a.frame,Object(B.a)(this,this.Abm,"logInputBlur"),96);this.Aa.ua(ta.a.a1h,kg.a.frame,Object(B.a)(this,
this.sbm,"logControlActivated"),96);this.Aa.ua(ta.a.vtd,kg.a.frame,Object(B.a)(this,this.V0l,"focusSearchBox"),96);this.Aa.ua(ta.a.S0h,kg.a.frame,Object(B.a)(this,this.oVl,"constructLiveNotificationForMenu"),96);this.Aa.ua(ta.a.e1h,kg.a.frame,Object(B.a)(this,this.HLj,"insertTryQuery"),96);this.Aa.ua(ta.a.EPh,kg.a.frame,Object(B.a)(this,this.HLj,"insertTryQuery"),96);this.Aa.ua(ta.a.iKh,kg.a.frame,this.nnc,96);this.Aa.ua(ta.a.jKh,kg.a.frame,this.nnc,96);this.Aa.ua(ta.a.kKh,kg.a.frame,this.nnc,96);
this.Aa.ua(ta.a.lKh,kg.a.frame,this.nnc,96);this.Aa.ua(ta.a.mKh,kg.a.frame,this.nnc,96);this.Aa.ua(ta.a.XVh,kg.a.frame,this.nnc,96);this.Aa.ua(ta.a.YVh,kg.a.frame,this.nnc,96);this.Aa.ua(ta.a.ZVh,kg.a.frame,this.nnc,96);this.Aa.ua(ta.a.xWh,kg.a.frame,this.Xcg,96);this.Aa.ua(ta.a.yWh,kg.a.frame,this.Xcg,96);this.Aa.ua(ta.a.zWh,kg.a.frame,this.Xcg,96);this.Aa.ua(ta.a.U0h,kg.a.frame,this.oom,96);this.Aa.ua(ta.a.f1h,kg.a.frame,this.nnc,96);this.Aa.ua(ta.a.bGh,kg.a.frame,this.NZe,96);this.Aa.ua(ta.a.cGh,
kg.a.frame,this.NZe,96);this.Aa.ua(ta.a.dGh,kg.a.frame,this.NZe,96);this.Aa.ua(ta.a.$ad,kg.a.frame,this.$ad,96);this.Aa.ua(ta.a.zPh,kg.a.frame,this.Uam,96);this.Aa.ua(ta.a.FXh,kg.a.frame,this.dsm,96);this.Aa.ua(ta.a.UKh,kg.a.frame,this.w1l,96)}C4n(V){this.tSe=!1;const Ea=window.performance.now();V.K7a.isCompleted?(this.tSe=!0,this.Nfi(!0)):V.s$(()=>{this.tSe=!0;this.Nfi(!0);Te.instance.Gw.Zfa(Ga.j7m,window.performance.now()-Ea)});this.O4n(V)}O4n(V){og.a.Fah(this.CVe);og.a.AUd([new Df.a(ta.a.lH,kg.a.frame,
96),new Df.a(ta.a.T0h,kg.a.frame,96),new Df.a(ta.a.X0h,kg.a.frame,96),new Df.a(ta.a.$0h,kg.a.frame,96),new Df.a(ta.a.Z0h,kg.a.frame,96),new Df.a(ta.a.V0h,kg.a.frame,96),new Df.a(ta.a.c1h,kg.a.frame,96),new Df.a(ta.a.Y0h,kg.a.frame,96),new Df.a(ta.a.a1h,kg.a.frame,96),new Df.a(ta.a.vtd,kg.a.frame,96),new Df.a(ta.a.S0h,kg.a.frame,96),new Df.a(ta.a.e1h,kg.a.frame,96),new Df.a(ta.a.EPh,kg.a.frame,96),new Df.a(ta.a.iKh,kg.a.frame,96),new Df.a(ta.a.jKh,kg.a.frame,96),new Df.a(ta.a.kKh,kg.a.frame,96),new Df.a(ta.a.lKh,
kg.a.frame,96),new Df.a(ta.a.mKh,kg.a.frame,96),new Df.a(ta.a.XVh,kg.a.frame,96),new Df.a(ta.a.YVh,kg.a.frame,96),new Df.a(ta.a.ZVh,kg.a.frame,96),new Df.a(ta.a.xWh,kg.a.frame,96),new Df.a(ta.a.yWh,kg.a.frame,96),new Df.a(ta.a.zWh,kg.a.frame,96),new Df.a(ta.a.U0h,kg.a.frame,96),new Df.a(ta.a.f1h,kg.a.frame,96),new Df.a(ta.a.bGh,kg.a.frame,96),new Df.a(ta.a.cGh,kg.a.frame,96),new Df.a(ta.a.dGh,kg.a.frame,96),new Df.a(ta.a.$ad,kg.a.frame,96),new Df.a(ta.a.zPh,kg.a.frame,96),new Df.a(ta.a.FXh,kg.a.frame,
96),new Df.a(ta.a.UKh,kg.a.frame,96)],V)}V0l(V,Ea,Za){if(1===Za)return 32;this.Qym();V=!1;(Te.instance.vy.cpc||this.Etc)&&(Ea=document.getElementById("SearchButton"))&&Ea.click();if(!Te.instance.vy.cpc&&this.Etc)for(Ea=document.getElementsByClassName("ms-suiteux-search-box"),Za=0;Za<Ea.length;Za++){const ia=Ea[Za].querySelector("input[type=search]");ia&&(V=v.FocusManager.vz(ia))}else V=v.FocusManager.vz($get(Te.instance.vy.az?gi.a.w6e:gi.a.j7e));this.zkf=!0;return V?32:8}HLj(V,Ea,Za,ia,Va){if(1===
Za)return 32;if(Le.b(Va))return Te.instance.Gw.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.Qym();V=Va.CommandValueId;Ea=Te.instance.vy.az?gi.a.w6e:gi.a.j7e;Te.instance.vy.az&&!Le.b(Va[tf.a.naa])&&(Va[tf.a.naa]=!1);if(V){if(Te.instance.vy.az)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(V)),this.ygd=[19],32;if(Va=$get(Ea))Va.value=V}return v.FocusManager.vz($get(Ea))?32:8}Qym(){this.Fe.haa(Te.instance.vy.cpc||this.Etc?Te.instance.vy.NXe:Te.instance.vy.xZa,
!1)}Idn(V,Ea){switch(V){case 0:return String.format(Object(Wa.a)("TellMeClassifierCommandAccessibleLabelFormat"),Ea);case 4:return String.format(Object(Wa.a)("TellMeRecentlyUsedAccessibleLabelFormat"),Ea);case 5:return String.format(Object(Wa.a)("TellMeTryQueryAccessibleLabelFormat"),Ea);case 7:case 16:return String.format(Object(Wa.a)("TellMeTryCommandAccessibleLabelFormat"),Ea)}return Ea}oVl(V,Ea,Za,ia,Va){if(1===Za)return 32;if(Le.b(Va))return Te.instance.Gw.onError("TellMeActor:ConstructLiveNotificationForMenu",
"actiondata comes null"),16;V=this.kNb?this.kNb.Ivm:0;Va.Value=1!==V?String.format(Object(Wa.a)("LookupLiveNotificationResultPluralFormText"),V):Object(Wa.a)("LookupLiveNotificationResultSingularFormText");if(this.kNb)for(const Ab of this.kNb.E8m)Va=Object(bc.a)(qk,Ab)?Ab.id:la.a.replaceAll(Ab.value,'"',""),(Va=$get(Va+"-"+ie.Vql))&&ha.a.vea(Va,ha.a.IA,la.a.We(this.Idn(Ab.groupType,Va.innerText)));return 32}hTl(V,Ea,Za,ia,Va){if(1===Za)return 32;if(Le.b(Va))return Te.instance.Gw.onError("TellMeActor:CacheAsyncMenuRefreshFunction",
"actiondata comes null"),16;this.HRe=new ob.a(2,1,0,()=>{Va[Xl.Callback]()},97);this.kNb&&this.Ce.Rb(this.HRe);return 32}Dbm(V,Ea,Za,ia,Va){if(1===Za)return 32;if(Le.b(Va))return Te.instance.Gw.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;Va.CloseAllMenus&&(V=void 0===Va.ParentControlId||null===Va.ParentControlId?"<NA>":Va.ParentControlId,Ea=this.JRe?this.JRe[Va.ControlId]:null,!Ea&&this.JRe&&"<NA>"!==V&&(Ea=this.JRe[V]),Ea||(Ea=this.mSe&&this.Chb.Nwn(Va),Ea=this.K7m(Ea,Va.ControlId),
Ea=new Si(Ea,32,4,-1,-1,-1),Te.instance.Gw.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+Va.ControlId+" determined group:"+si[Ea.groupType])),Te.instance.Gw.LQn(Va.ControlId,V,Va.CommandId,Va.CloseAllMenus,Ea),this.hvc.sPn(Va.ControlId),Va.Location!==hf.contextMenu&&(this.Chb.hTm(Va),this.Chb.w5(Ea.resultType),Te.instance.vy.x_h&&this.Ulb.YTm(Va.CommandId)));return 32}tbm(V,Ea,Za,ia,Va){if(1===Za)return 32;(new Hl(this.tXe())).nkn(this.TRe);V=this.TRe;Ea=this.CIh();Za=Te.instance.Gw.VCh;
if(Le.b(Va))return Te.instance.Gw.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;Va=Va.UILocation;V&&0<V.length&&this.Pkf&&ie.igl(Te.instance.vy)&&Te.instance.vy.hPh&&19!==Va&&Ea>Za&&!Te.instance.vy.doa&&(Te.instance.Gw.K7j(V),Te.instance.Gw.R9k(Ea));Te.instance.Gw.Y7n();Te.instance.vy.p2h&&19!==Va&&(this.m2.mark(3),this.m2.measure(1,0,3),this.m2.measure(2,2,3),this.m2.f6j(0,1,2),this.m2.f6j(2,2,3),this.m2.f6j(1,0,3),this.m2.tBc([0,1,2,3]),this.m2.clearMeasures([0,2,1]));
Te.instance.Gw.VQn(window.performance.now()-this.Ifi);Te.instance.vy.az&&(this.vgd=null,Te.instance.Gw.Zlm());this.zkf=this.gSe=!1;this.TRe="";return 32}Bbm(V,Ea,Za){if(1===Za)return 32;Te.instance.Gw.$lm(Sj(Ea),this.zkf);return 32}Abm(V,Ea,Za){if(1===Za)return 32;Te.instance.Gw.Zlm();this.gSe=!1;return 32}sbm(V,Ea,Za,ia,Va){if(1===Za)return 32;Te.instance.goa=null;Va&&(Te.instance.goa=Va);Te.instance.vy.p2h&&(Le.b(Te.instance.goa)||Te.instance.goa.Location!==hf.contextMenu)&&this.m2.mark(0);Te.instance.Gw.UZh(Le.b(Te.instance.goa)||
Le.b(Te.instance.goa.Location)?hf.unknown:Te.instance.goa.Location);Te.instance.Gw.UQn(this.cMl,this.zkf);this.gSe||this.l_g();return 32}wWl(V,Ea){const Za=[],ia=Date.now();for(const Va of V)V=(ia-Va.timeStamp)/1E3,V=ie.K1h(V),Array.add(Za,new ui(Ea?Va.commandId:Va.controlId,V));return Za}s6m(V){const Ea=[],Za=Date.now();for(const ia of V)if(ia.controlId||"keyboardShortcut"===ia.commandSurface)V=(Za-ia.timeStamp)/1E3,V=ie.K1h(V),Array.add(Ea,new Kj(ia.controlId,ia.commandId,V,ia.commandSurface,ia.terminalParentControlId));
return Ea}GWl(V=!1){var Ea=V?this.Chb.lkn():this.Chb.V_f();V=[];const Za=Date.now();for(const ia of Ea)Ea=(Za-ia.TimeStamp)/1E3,Ea=ie.K1h(Ea),Array.add(V,new ui(ia.Id,Ea));return V}l_g(){if(!this.gSe){this.mSe=this.gSe=!0;if(!this.kLl){this.kLl=!0;const V={};V.IsMLREnabled=Te.instance.vy.Lxn;V.IsReactRibbonEnabled=Te.instance.vy.az;V.IsSharedHeaderEnabled=!!l.AFrameworkApplication.Ha&&l.AFrameworkApplication.Ha.Ib.PO;V.IsSearchUxEnabled=this.Etc;V.IsTellMeInHeaderEnabled=Te.instance.vy.cpc;V.IsGoLocalEnv=
ie.nxn();V.IsSovereignEnvironment=ie.wZe();V.IsTellMeServiceResultsEnabled=ie.igl(Te.instance.vy);V.IsSubstrateProviderEnabled=ie.hgl(Te.instance.vy);V.ShouldFetchTokens=!!l.AFrameworkApplication.Ha&&l.AFrameworkApplication.Ha.Ib.Bib;V.IsSerpletEnabled=ie.Utb();V.FirstOnClickTimeInMS=Math.round(window.performance.now());V.IsHeaderHidden=l.AFrameworkApplication.hideHeader||l.AFrameworkApplication.cL;V.IsSearchInHeaderHidden=l.AFrameworkApplication.rmd;void 0!==window.performance.timing&&null!==window.performance.timing&&
(V.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));V.IsFindWithMatchesEnabled=Te.instance.vy.B0l;V.HelpShowsTopSearchResult=Te.instance.vy.tmh;V.HelpShowsNumberOfMatches=Te.instance.vy.b6e;l.AFrameworkApplication.ha&&(V.UiHost=l.AFrameworkApplication.ha.Ma("UiHostIntegrationType"));Te.instance.Gw.vCn(JSON.stringify(V))}this.PUe=this.wWl(Fe.a.instance.Wqc,!1);this.OUe=this.wWl(Fe.a.instance.aNb,!0);this.i8e=this.s6m(Fe.a.instance.aNb);this.o1e=this.GWl();this.p1e=this.GWl(!0);
Te.instance.Gw.l_g()}}DYe(V,Ea,Za,ia,Va){if(1===Za)return 32;if(Le.b(Va))return Te.instance.Gw.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Vd.a.C3)return 32;this.Ifi=window.performance.now();this.l_g();V=new gj(this.Lna,0);Te.instance.ICb++;Te.instance.Gw.beginQuery("",Te.instance.ICb,this.mSe);this.vxh(!0,null);this.kNb=Lj.AJh;this.vgd=gk.o2i;if(this.Ulb)Te.instance.actions=[],this.Ulb.L$(new xk("",Te.instance.ICb),V,Te.instance.vy.az);else Te.instance.Gw.onError("TellMeActor:ExecuteTellMeQuery",
"Aggregator provider not resolved yet");this.HRe&&this.Ce.Rb(this.HRe);return 32}hga(V){if(1===V)return 32;this.Fe.$da(Te.instance.vy.cpc||this.Etc?Te.instance.vy.NXe:Te.instance.vy.xZa,!1);return 32}lH(V,Ea,Za,ia,Va){if(1===Za)return 32;if(Le.b(Va))return Te.instance.Gw.onError("TellMeActor:TellMe","actiondata comes null"),16;Te.instance.goa=Va;Te.instance.Gw.UZh(Le.b(Te.instance.goa.Location)?hf.unknown:Te.instance.goa.Location);V=Te.instance.goa.Value;Te.instance.vy.az||V&&""!==V.trim()?(!this.vgd&&
Te.instance.vy.az&&(Te.instance.Gw.$lm(Sj(Ea),this.zkf),this.l_g()),this.$$m(V,Te.instance.goa.Location),Te.instance.goa.PopulationXML=this.kNb.xml):this.mSe?Te.instance.goa.PopulationXML=this.kNb.xml:(Te.instance.goa.PopulationXML=Lj.AJh.xml,this.vgd=gk.o2i,this.TRe="");return 32}$$m(V,Ea){this.Ifi=window.performance.now();Te.instance.vy.p2h&&Ea!==hf.contextMenu&&this.m2.mark(1);Te.instance.vy.az&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(V));V&&0<V.trim().length&&(this.mSe=
!1);Te.instance.vy.C$m();Ea=Le.b(Ea)?hf.lH:Ea;if(V!==this.TRe||Te.instance.vy.az){Te.instance.ICb++;Te.instance.Gw.beginQuery(V,Te.instance.ICb,this.mSe);this.vxh(!0,null);const Za=new xk(V,Te.instance.ICb),ia=new gj(this.Lna,Te.instance.ICb);this.kNb=Lj.AJh;this.vgd=gk.o2i;if(this.Ulb)Te.instance.actions=[],this.Ulb.L$(Za,ia,Te.instance.vy.az,Ea,this.ygd),this.ygd=null;else Te.instance.Gw.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.cMl=Te.instance.ICb;this.TRe=
V}}gmo(V){if(Te.instance.vy.az){var Ea=appChrome.selectors.getActiveControlStates();if(Ea=Object(ld.a)(Object,Ea[V.value])){V.label=Ea.label;let Za=null;"description"in Ea&&(Za=Ea.description);Za&&Object.getType(Za)===String?V.description=Za:"secondaryText"in Ea?V.description=Ea.secondaryText:"fullDescriptionLabel"in Ea&&(V.description=Ea.fullDescriptionLabel)}}}cYn(V){this.JRe={};let Ea=0,Za=0;for(const ia of V){V=0;for(const Va of ia.results)this.JRe[Va.value]=new Si(Va.groupType,Va.type,Va.subType,
Ea,V,Za),V++,Za++,Va.label||5!==Va.type||this.gmo(Va);0<V&&Ea++}}lFa(V,Ea,Za,ia,Va){if(1===Za)return 32;if(Le.b(Va))return Te.instance.Gw.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(V=Va.CommandValueId)&&window.open(V,"_blank");return 32}Zam(V){const Ea={};Ea.token=this.hoh;Ea.files=Ka.c(V);Ea.type="MultiFilesDeckGeneration";if(l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.Aa.Ra(ta.a.a1j,2,Ea),!0;V=ie.E4l("",
ie.Jvm("GenerateDeckFromFile"),Object.assign(new If.a,{landingTab:"All",data:Ea}));V=this.Aa.Ra(ta.a.GYe,2,V);return 32!==V?(Te.instance.Gw.onError("LaunchSmartLookupWithFilesData","CommonCommands.InvokeSerplet failed. Response: "+V+"."),!1):!0}Jvn(V,Ea){if(1===V)return 32;if(Le.b(Ea))return Te.instance.Gw.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(Le.b(this.zDh))return Te.instance.Gw.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;V=Ea.CommandValueId;return Le.b(V)?
(Te.instance.Gw.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.zDh.insertHtmlText(V)?32:(Te.instance.Gw.onError("TellMeActor:InsertUrl","url is not inserted"),16)}K7m(V,Ea){return Ea.startsWith(Te.instance.vy.az?ie.uwl:ie.P1h)?5:V?4:"bSearchHelp"===Ea||Ea.startsWith("GetHelpFromTellMe")?8:"bInsights"===Ea||Ea.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===Ea?24:Ea===Te.instance.vy.A0l?2:0}CIh(){return this.LB.CIh()}w5(V,Ea){this.Ulb?this.Ulb.w5(V,Ea):Array.add(this.zEh,
new Fj(V,Ea))}vxh(V,Ea="",Za=null){return this.LB.vxh(V,Ea,Za)}static get instance(){return Te.Qa||(Te.Qa=new Te(qe.instance))}get vy(){return this.LB.vy}set vy(V){this.LB.vy=V}set P5h(V){this.LB.P5h=V}get GXe(){return this.LB.GXe}set GXe(V){this.LB.GXe=V}get Gw(){return this.LB.Gw}set Gw(V){this.LB.Gw=V}get ICb(){return this.LB.ICb}set ICb(V){this.LB.ICb=V}get MAc(){return this.LB.MAc}set MAc(V){this.LB.MAc=V}get goa(){return this.LB.goa}set goa(V){this.LB.goa=V}get o1e(){return this.LB.o1e}set o1e(V){this.LB.o1e=
V}get PUe(){return this.LB.PUe}set PUe(V){this.LB.PUe=V}get OUe(){return this.LB.OUe}set OUe(V){this.LB.OUe=V}get i8e(){return this.LB.i8e}set i8e(V){this.LB.i8e=V}get Chb(){return this.LB.Chb}set Chb(V){this.LB.Chb=V}get RJe(){return this.LB.RJe}set RJe(V){this.LB.RJe=V}get p1e(){return this.LB.p1e}set p1e(V){this.LB.p1e=V}}Te.Qa=null;Te.gio="mso_tellMeService";Te.unknown="Unknown";Te.Tan=500;Object(k.a)(Te,"TellMeActor",null,[]);var vi=a(43),uj=a(1072);class ah{constructor(V=null,Ea=null,Za=null,
ia,Va=null){this.b7h=null;this.xIl=!1;this.jKl=this.mjc=null;this.xRm=this.RNl=this.$Lm=this.kKl=!1;this.NCh=null;this.kMm=null==Ea?l.AFrameworkApplication.hkc:Ea;this.yOm=null==Za?l.AFrameworkApplication.Dsb:Za;this.GRm=null==Va?l.AFrameworkApplication.Dib:Va;this.nOm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeHelpOnHelpIsEnabled");this.aSm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeCommandHookIsEnabled");this.sco(!!l.AFrameworkApplication.ha&&
l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeIgnoreQueryForHelp"));this.URm=!!l.AFrameworkApplication.Ha&&l.AFrameworkApplication.Ha.Ib.J2b;this.VRm=!ie.$y()&&!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting("TellMePeopleSuggestionIsEnabled");this.TRm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeFileSuggestionIsEnabled");this.ONm=!!l.AFrameworkApplication.Ha&&l.AFrameworkApplication.Ha.Ib.Bib;this.WRm=!!l.AFrameworkApplication.ha&&
l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.sRm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting("HelpShowsTopSearchResult");this.XPm=this.tmh||this.b6e;this.VPm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting("OnlineCommandSuggestionsIsEnabled");this.WPm=this.oUj;this.WOm=!!l.AFrameworkApplication.ha&&this.cpc&&l.AFrameworkApplication.ha.getBooleanAppSetting("StyledHeaderInLabelIsEnabled");
this.ZNm=l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.cOm=l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.YNm=l.AFrameworkApplication.ha?parseFloat(l.AFrameworkApplication.ha.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.TOm=
!!l.AFrameworkApplication.ha&&(l.AFrameworkApplication.ha.getBooleanAppSetting("SmartLookupNoteSearchIsEnabled")||l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.OOm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.cPm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",
!1);this.AOm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.isActionAIEnabledInTellMe",!1)&&(this.Fzn||this.Wxn);this.NSe=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.MRm=l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):
"https://substrate.office.com/search/api/v1/suggestions";this.dOm=l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.tRm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.CRm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",
!1);this.vRm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting("ShowFindInDocumentInZeroTermSearchBox")||this.doa;this.bPm=!!l.AFrameworkApplication.ha&&(l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeTemplateProviderIsEnabled")||l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.NOm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",
!1);this.SOm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeIsRuleBasedSortingEnabled")&&"en-US"===l.AFrameworkApplication.uiCulture;this.ZOm=!!l.AFrameworkApplication.ha&&(l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeFeedbackProviderIsEnabled")||l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.ePm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeZeroTermContextualCommandSuggestionsEnabled");
this.bMm=this.cpc&&!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.jOm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.ERm=!!l.AFrameworkApplication.ha&&(l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==l.AFrameworkApplication.ha.Ma("Application"));
this.uMm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.rSm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting("TellMePerformanceMarkerEnabled");this.COm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.GOm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.bOm=l.AFrameworkApplication.ha?l.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.aPm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeNotesSuggestionIsEnabled")||this.kam;this.EOm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.FOm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.DOm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.ANm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.BNm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.zNm=!!l.AFrameworkApplication.ha&&
l.AFrameworkApplication.Cjd&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableBumblebeeEntryPointInTellMe",!1);this.YPm=!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.Cjd&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1);this.XRm=this.jzn&&(this.DBk||this.EBk||this.O1g||this.cpc&&ie.Utb()&&!!l.AFrameworkApplication.ha&&(this.g6e||this.Bad||this.Cad||this.Dad||this.gJe||l.AFrameworkApplication.ha.getBooleanAppSetting("ShowAnswerSearchResults")||
l.AFrameworkApplication.ha.getBooleanAppSetting("ShowDefinitionSearchResults")||l.AFrameworkApplication.ha.getBooleanAppSetting("ShowEntitySearchResults")||l.AFrameworkApplication.ha.getBooleanAppSetting("ShowWolframSearchResults")));this.SLm=!!l.AFrameworkApplication.ha&&!l.AFrameworkApplication.ha.getBooleanAppSetting("AppsForOfficeThirdPartyIsDisabled")&&l.AFrameworkApplication.ha.getBooleanAppSetting("AppsForOfficeAllowExternalMarketplace")&&l.AFrameworkApplication.jMa;this.TLm=!!l.AFrameworkApplication.ha&&
l.AFrameworkApplication.ha.getBooleanAppSetting("AppsForOfficePrivateCatalogIsEnabled");this.Qun(V||{});this.Hji="2918242107";this.Gji="1454393937";this.kEd={};this.Chd=[];this.R2m=[ie.P1h]}get application(){return this.mjc}get hkc(){return this.kMm}get K9n(){return this.Hji}get J9n(){return this.Gji}get A0l(){return this.jKl}get ubn(){return this.kKl}get Dsb(){return this.yOm}get Dib(){return this.GRm}get nLd(){return this.$Lm}get Fqn(){return this.nOm}get uio(){return this.aSm}get jzn(){return!0}get hio(){return this.XRm}get $co(){return this.RNl}sco(V){this.RNl=
V}get cpc(){return this.URm}get ksh(){return this.VRm}get jsh(){return this.TRm}get abn(){return this.ONm}get fio(){return this.WRm}get Oul(){return!1}get O1g(){return this.XPm}get DBk(){return this.VPm}get EBk(){return this.WPm}get jnd(){return!1}get hPh(){return!1}get FYj(){return this.WOm}get ril(){return this.xRm}get g6e(){return!1}get ydo(){return!1}get HAn(){return""}get slj(){return 2}get okn(){return 4}get pkn(){return 5}get lln(){return""}get bhn(){return this.ZNm}get D4l(){return this.cOm}get nln(){return 1E3}get mln(){return 1E-6}get Aho(){return this.MRm}get wol(){return!1}get zho(){return!1}get lyn(){return this.SOm}get aPh(){return!1}get VXj(){return!1}get Kxn(){return!1}get Jxn(){return!1}get kam(){return!1}get mam(){return!1}get B0l(){return!1}get Usd(){return!1}get Bad(){return!1}get Cad(){return!1}get Dad(){return!1}get gJe(){return!1}get tmh(){return this.sRm}get c6e(){return this.tRm}get b6e(){return!1}get Jfj(){return null}get MXj(){return!1}get x_h(){return this.vRm}get B3l(){return 0}get Xen(){return this.YNm}get M4l(){return this.dOm}get Syn(){return this.TOm}get eOh(){return this.AOm}get w_h(){return this.NSe}get t3l(){return-3.9}get doa(){return this.CRm}get Ckg(){return this.bPm}get SUj(){return this.NOm}get iZj(){return this.ZOm}get Fid(){return this.bMm}get Hzn(){return this.ePm}get LIb(){return this.jOm}get vAm(){return this.ERm}get BYm(){return this.uMm}get p2h(){return this.rSm}get iOh(){return this.COm}get fwn(){return this.GOm}get kN(){return this.bOm}get knd(){return this.aPm}get dwn(){return this.EOm}get ewn(){return this.FOm}get cwn(){return this.DOm}get WQl(){return this.SLm}get XQl(){return this.TLm}get Ffb(){return this.ANm}get DJh(){return this.BNm}get BJh(){return this.zNm}get Fzn(){return this.cPm}get Wxn(){return this.OOm}get mVn(){return this.YPm}get ex(){return!!l.AFrameworkApplication.Ha&&
l.AFrameworkApplication.Ha.Ib.az}get az(){return!!l.AFrameworkApplication.Ha&&l.AFrameworkApplication.Ha.Ib.az}get Lxn(){return!!l.AFrameworkApplication.Ha&&l.AFrameworkApplication.Ha.Ib.NGa}get cPn(){return Ia.d("OfficeAssistant_32x32x32")}jhn(){return Promise.reject("GetFindMatchCount method is not overridden")}AZe(V){return Array.contains(appChrome.selectors.getVisibleControlIds(),V)}qOh(){return!1}get hUj(){return!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeModelRankerEnabled")}get mCm(){return l.AFrameworkApplication.ha?
l.AFrameworkApplication.ha.Ma("TellMeServiceHelpClassifierModelName"):""}get oUj(){return!!l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeMultiLingualCommandModelEnabled")}get NXe(){return"NoOpHeaderUi"}get Q2m(){return this.NCh}get parameterData(){return this.kEd}get Fko(){return this.Chd}C$m(){if(this.b7h&&!this.xIl&&(this.xIl=!0,this.S5e(this.b7h),this.az)){var V=z.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");V=(new uj.a(V)).CXd(this.b7h.Lea);
appChrome.api.dispatch(V)}}S5e(){}L7m(V){const Ea=[];for(let Za=0;Za<V.length;++Za)V[Za].Jdo?Ea.push(new Nc.a(V[Za].alternate,ie.sDm+Za.toString())):Ea.push(new Nc.a(V[Za].standard,ie.P1h+Za.toString()));return Ea}Qun(V){const Ea={};for(const Za in V){const ia=Za,Va=V[Za];for(const Ab in Va){const gc=Ab,Hc=Va[Ab];(Ea[gc]||(Ea[gc]={}))[ia]=Hc}}this.NCh=Ea}get nCm(){return""}get Yzm(){return!1}}Object(k.a)(ah,"TellMeApplicationData",null,[795]);class Pi{constructor(V,Ea=null,Za=!1){this.standard=V;
this.alternate=Ea;this.Jdo=Za}}Object(k.a)(Pi,"TryQuerySet",null,[]);class hj{constructor(){this.jMl=this.kMl=null}get bJn(){return this.jMl}cwa(V){this.kMl=V;return this.P4m(V)}qPn(){this.jMl=this.kMl}gin(V){return 8===V.type?String.format(Object(Wa.a)("FindInDocumentText"),V.Uta):V.Uta}jfn(V){return V.Uta}}Object(k.a)(hj,"ParameterizedCommand",null,[]);class Pl extends hj{constructor(V){super();this.Jyn=V}get commandId(){return this.Jyn?"FindParameterized":"EditingFind"}get UVn(){return"Find"}P4m(V){if(!V)return null;
const Ea=la.a.We(String.format(ResourceStrings.l_ParamFindInDocTitle,V.Uta));return Ua.a(ie.t6m(V.value),"1540292897",Ea,"Find_16x16x32",null,la.a.We(V.Uta),Ea,null,null)}}Object(k.a)(Pl,"FindParameterizedCommand",hj,[]);var al=a(149);class ul extends ah{constructor(){super(window.TellMeControlMetadataOverrides);this.mjc="PowerPoint";if(l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeTryQueriesIsEnabled")){var V=[new Pi(ResourceStrings.l_TellMeTryQuery01,"",!1),new Pi(ResourceStrings.l_TellMeTryQuery02,
"",!1),new Pi(ResourceStrings.l_TellMeTryQuery03,"",!1),new Pi(ResourceStrings.l_TellMeTryQuery04,"",!1),new Pi(ResourceStrings.l_TellMeTryQuery05,"",!1)];this.Chd=this.L7m(V)}l.AFrameworkApplication.ha.getBooleanAppSetting("TellMeFindInDocumentIsEnabled")&&(V=new Pl(ul.Hyn()),this.parameterData[V.commandId]=V,this.kKl=!0,this.jKl=V.commandId)}get xZa(){return al.a.aHh}S5e(V){if(V){V=V.Lea;var Ea=l.AFrameworkApplication.ha;V["PptTellMe.Animation"]=!Ea.getBooleanAppSetting("TellMeAnimationsTransitionsIsEnabled")||
Ea.getBooleanAppSetting(Oe.a.M5g);V["PptTellMe.Transition"]=!Ea.getBooleanAppSetting("TellMeAnimationsTransitionsIsEnabled");V["PptTellMe.SelectAll"]=!Ea.getBooleanAppSetting("TellMeSelectAllResultIsEnabled");V["PptTellMe.AnimationNew"]=!Ea.getBooleanAppSetting(Oe.a.M5g)||!Ea.getBooleanAppSetting("TellMeAnimationsTransitionsIsEnabled");V["PptTellMe.Designer"]=!Ea.getBooleanAppSetting(Oe.a.aze);Ea=Ea.getBooleanAppSetting("TellMeDesktopUpSellIsEnabled");var Za=l.AFrameworkApplication.lam;V["PptTellMe.WordArtUpSellButton"]=
!Ea||Za;V["PptTellMe.SpellCheckDictUpSellButton"]=!Ea||Za;V["PptTellMe.InsertAudioUpSellButton"]=!Ea||Za;V["PptTellMe.InsertChartUpSellButton"]=!Ea||Za;V["PptTellMe.WordArtUpSellButtonEnterprise"]=!Ea||!Za;V["PptTellMe.SpellCheckDictUpSellButtonEnterprise"]=!Ea||!Za;V["PptTellMe.InsertAudioUpSellButtonEnterprise"]=!Ea||!Za;V["PptTellMe.InsertChartUpSellButtonEnterprise"]=!Ea||!Za}}get kam(){return l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeNotesSuggestionIsEnabled",
!1)}get mam(){return l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get B3l(){return l.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.PowerPointOnline.NumberOfNotesSuggestionsToShow",2)}get nCm(){return l.AFrameworkApplication.ha.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMultiLanguageModelName","")}get wol(){return l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeServiceAADAuthIsEnabled",
!1)}get mCm(){return l.AFrameworkApplication.ha.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeHelpClassifierModelName","")}get g6e(){return l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowImageSearchResults",!1)}get oUj(){return l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMLCModelIsEnabled",!1)}get slj(){return l.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMenuUpdatePolicy",
0)}get Yzm(){return l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowMoreFileResults",!1)}get hPh(){return l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeEnableRankerLogging",!1)}get azn(){return l.AFrameworkApplication.Cjd&&l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSummarizeDeckInTellMe",!1)}get Jfj(){const V={};l.AFrameworkApplication.ha.getBooleanAppSetting("PPTOModernFontPickerIsEnabled")?
V.FontName="FontPicker":V.FontPicker="FontName";V.NewSlide="NewSlideSplit";V.ChangeLayout="ChangeLayoutFlyout";return V}get t3l(){var V=l.AFrameworkApplication.ha.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.NBClassifierScoreThreshold","-3.9");V=parseFloat(V);return isNaN(V)?-3.9:V}get aPh(){return l.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.IsSerpletClassifierEnabled",!1)}get WQl(){return l.AFrameworkApplication.ha.getBooleanAppSetting(Oe.a.xid)}get XQl(){return l.AFrameworkApplication.ha.getBooleanAppSetting(Oe.a.Eid)}static Hyn(){return!!l.AFrameworkApplication.Ha&&
l.AFrameworkApplication.Ha.Ib.ex}}Object(k.a)(ul,"PowerPointTellMeApplicationData",ah,[]);var ik;(function(V){V[V.none=0]="none";V[V.CEl=1]="waitAll";V[V.szo=2]="synchronizeFast";V[V.Uho=3]="synchronizeSlow"})(ik||(ik={}));Object(k.b)("ProviderSynchronizationType",ik);var nj;(function(V){V[V.immediate=0]="immediate";V[V.CEl=1]="waitAll";V[V.qzo=2]="synchronizeAndWaitAll";V[V.rzo=3]="synchronizeAndWaitForRanker"})(nj||(nj={}));Object(k.b)("MenuUpdatePolicy",nj);class Eh{constructor(V,Ea,Za){this.OJ=
V;this.rb=Ea;this.ya=Za}zfa(){return"SummarizeSlidesProvider"}uwa(){return this.OJ.slj?this.OJ.slj===nj.CEl?ik.CEl:ik.Uho:ik.none}L$(V,Ea,Za,ia,Va=null){var Ab,gc,Hc,fd;const hd=new mc(V);if(this.vca(V))if(null!=Va&&0>Va.indexOf(si.fGl))Ea.zF(hd);else{this.lnk="SummarizeDeckFromTellMe";if(1<(null===(gc=null===(Ab=this.rb)||void 0===Ab?void 0:Ab.rg())||void 0===gc?void 0:gc.length))this.lnk="SummarizeSlidesFromTellMe";else if(null===(fd=null===(Hc=this.ya)||void 0===Hc?void 0:Hc.presentation)||void 0===
fd||!fd.slides||2>this.ya.presentation.slideCount){Ea.zF(hd);return}appChrome&&appChrome.selectors.isControlDisabled(this.lnk)?Ea.zF(hd):(V=new hb(this.lnk,ti.F5h,"","",Ik.OIm),Za=new Hb(si.F5h),Za.hR(V),hd.$M(Za),window.requestAnimationFrame(()=>{Ea.zF(hd)}))}else Ea.zF(hd)}vca(V){return!V||!V.gm||!V.gm.trim().length}}Object(k.a)(Eh,"SummarizeSlidesProvider",null,[749]);class Wh extends Ve{constructor(){super()}get name(){return"PowerPointEditor.TellMe"}load(){this.init()}init(){if(l.AFrameworkApplication.W0h){var V=
vi.App.Zb.Ib.nXe(ta.a.lH);V.Mmd?Wh.Vpm():V.s$(Object(B.a)(this,this.G9n,"scriptResource_LoadFinished"));var Ea=new ul;Te.instance.initialize(Ea,null,null,null,null,null,Object(B.a)(vi.App.Zb,vi.App.Zb.JKh,"forceUpdateRibbonControls"),l.AFrameworkApplication.ha,this.Oa.eb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Oa.eb("Common.IActionContextProvider"),this.Oa.eb("Common.ISystemInitiatedFeedback"));Te.instance.C4n(V);V=l.AFrameworkApplication.ha&&l.AFrameworkApplication.ha.getBooleanAppSetting(Oe.a.kZa);
Ea.azn&&V&&Te.instance.w5(new Eh(Ea,this.Oa.resolve("PowerPointWebEditor.IPptSelectionManager"),this.Oa.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")),hf.lH)}}G9n(){Wh.Vpm()}static Vpm(){vi.App.Zb.fg()}}Object(k.a)(Wh,"PowerPointTellMePackage",Ve,[]);var ni=a(374),Ql=a(235);class Al{constructor(V,Ea,Za,ia,Va,Ab){if(!V)throw Error.argumentNull("transactionFactory");if(!Ea)throw Error.argumentNull("actionManager");if(!Va)throw Error.argumentNull("focusManager");if(!Ab)throw Error.argumentNull("pageView");
if(!ia)throw Error.argumentNull("selectionManager");if(!Za)throw Error.argumentNull("graphActionBlockingManager");this.Tb=V;this.Na=Va;this.la=Ea;this.zb=Ab;this.rb=ia;this.zc=Za}Kb(){this.la.ua(Rb.a.L2a,Q.a.application,this.bon.bind(this),4)}Ae(){}bon(V,Ea,Za,ia,Va){return this.L2a(Ea,Za,Va,V)}L2a(V,Ea,Za,ia){var Va;V=this.rb.zd();if(!(0<(null===V||void 0===V?void 0:V.length))||V.some(Ab=>this.zc.Hd(Ab)))return 8;V=V.filter(Ab=>Ab.RB);if(0>=V.length)return 8;if(1===Ea)return 32;xa.a.$(508560658,
822,15,"CameoStyle change started. CameoStyleId: '{0}'",Za);Ea=null===(Va=Od.a.Bb)||void 0===Va?void 0:Va.actionName;for(const Ab of V)this.EZ(Ab);Va=this.Tb.Kd(15,void 0,()=>{this.rb.lk();this.Na.ee()});try{Va.tc(V[0]);Va.wc=ia;for(const Ab of V)Ab.Fab=Za}finally{Va&&Va.dispose()}Od.a.Bb&&Ea&&(Od.a.Bb.actionName=Ea,Od.a.Bb.Za("CameoStyleId",Za.toString()),Od.a.t0(Od.a.Bb));return 32}EZ(V){null!==V&&void 0!==V&&V.Yw&&(V=this.Qk(V))&&V.yY(!1)}Qk(V){if(V)return V.yc(this.zb.Ua)}}Object(k.a)(Al,"CameoActor",
null,[502]);class xg{constructor(){this.vn=this.ohb=this.ga=null}get name(){return"PowerPointWebEditor.Chronos1"}oc(V){this.ga=V;this.ohb=this.ga.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.vn=this.ohb.GIb(4,this.name);this.ga.register(gf,"PowerPointWebEditor.RehydrationHeaderHandler").oa().pa(()=>new gf(this.ga.resolve("PowerPointWebEditor.ICCPInfoOwner"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.ga.register(gg,
"PowerPointWebEditor.SessionRehydrationController").oa().pa(()=>new gg(this.ga.resolve("Box4.IAppFrame").gN(),this.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.ga.resolve("Common.IKeyInputManager"),this.ga.resolve("PowerPointWebEditor.IInputHandlerManager"),this.ga.resolve("Common.IClickInputManager"),this.ga.resolve("PowerPoint.IBrowserHelperManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),
Ea=>{v.FocusManager.vz(Ea)},l.AFrameworkApplication.Iz?this.ga.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"):null));this.ga.register(713,"PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager").oa().pa(()=>new Uf(this.ga.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.IPPTWorkspace"),this.ga.resolve("Common.IActionManager"),this.ga.resolve("Common.ITaskManager"),this.ga.resolve("PowerPointWebEditor.RehydrationHeaderHandler"),
this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.ga.resolve("PowerPointWebEditor.IPopWebService"),this.ga.resolve("PowerPointWebEditor.IPopSessionState"),this.ga.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.ga.resolve("PowerPointWebEditor.IErrorHandler"),this.ga.resolve("Box4.IReplicationScheduler"),this.ga.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.ga.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.ga.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),
this.ga.resolve("PowerPointWebEditor.IInboundHelper"),this.ga.resolve("PowerPointWebEditor.Image.IImageManager"),l.AFrameworkApplication.$d,this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("Common.IAppSettingsManager"),this.ga.resolve("PowerPointWebEditor.IPPTOfflineManager"),this.ga.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.ga.eb("PowerPointWebEditor.ICommentSessionManager")));l.AFrameworkApplication.Iz&&this.ga.register(714,"PowerPointWebEditor.IPPTTokenRefreshManager").oa().pa(()=>
new ze(this.ga.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.ga.resolve("Common.ISessionExpirationManagerWithDialog"),this.ga.resolve("PowerPointWebEditor.PresentationContext"),this.ga.resolve("Common.IActionManager"),this.ga.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.ga.resolve("Common.ITaskManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){let V=this.vn.CJ("resolvechronos1");const Ea=this.ga.resolve("Common.AFrameworkApplication"),
Za=this.ga.resolve("PowerPointWebEditor.IApplicationContext").Pd;var ia=this.ga.resolve("PowerPointWebEditor.View.IPPTPageView");const Va=this.ga.resolve("Common.IActionManagerExtended"),Ab=this.ga.resolve("PowerPointWebEditor.IFocusManager"),gc=this.ga.resolve("Common.Transaction.ITransactionFactory"),Hc=this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),fd=this.ga.resolve("PowerPointWebEditor.IShapeEditor"),hd=this.ga.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
yd=this.ga.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),Md=this.ga.resolve("PowerPointWebEditor.PictureContext"),te=this.ga.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Pe=this.ga.resolve("PowerPointWebEditor.IRibbonChangeManager"),t=this.ga.resolve("PowerPointWebEditor.IPictureUploader");this.vn.FJ(V);V=this.vn.CJ("regactorschronos1");ia=[new Yc(Va,hd,Hc,Ab,this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),gc,t,Md,fd,l.AFrameworkApplication.WS,Pe,this.ga.resolve("PowerPointWebEditor.IErrorHandler"),
ia,this.ga.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),Za.Q9l,this.ga.resolve("PowerPointWebEditor.IInsertImageHelper"),te,yd,Za,this.ga.resolve("PowerPointWebEditor.IBusinessBarController"),this.ga.resolve("PowerPointWebEditor.View.IViewEventSource"),this.ga.resolve("PowerPointWebEditor.IShapeReader"),this.ga.resolve("Common.IAppSettingsManager")),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").QK?new Al(gc,Va,hd,Hc,Ab,ia):null].filter(S=>null!==S);for(var L of ia)L.Kb(),L.Ae();
this.Iun();this.vn.FJ(V);V=this.vn.CJ("tellme");L=new Wh;L.oc(this.ga);L.load(Ea);this.vn.FJ(V);Za.bze&&Za.li&&(V=this.vn.CJ("initrehydrationcontroller"),this.ga.resolve("PowerPointWebEditor.SessionRehydrationController").init(),this.vn.FJ(V));Za.aua&&this.ga.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager");l.AFrameworkApplication.Iz&&(V=this.vn.CJ("posttokenrefresh"),this.ga.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"),this.vn.FJ(V));this.XAn()}Iun(){const V=this.ga.resolve("Common.IActionManagerExtended"),
Ea=this.ga.resolve("PowerPointWebEditor.IFocusManager"),Za=this.ga.resolve("Common.AFrameworkApplication").Bj.Sd,ia=this.ga.resolve("Common.Transaction.ITransactionFactory"),Va=this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),Ab=this.ga.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),gc=this.ga.resolve("PowerPoint.IPathManager"),Hc=this.ga.resolve("PowerPointWebEditor.IZoomContext"),fd=this.ga.resolve("PowerPointWebEditor.IPresentationReader"),hd=Ql.a(this.ga);
hd("powerpoint-editor-intl").then(()=>{xa.a.$(512497373,801,50,"Editor script is loaded successfully");hd("powerpoint-ribbon-intl").then(()=>{xa.a.$(512497372,801,50,"Ribbon script is loaded successfully");const yd=[];yd.push(new Pb(V,Ea,Ab,ia,Za,this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),fd,Va,gc,Hc));for(const Md of yd)Md.Kb(),Md.Ae()}).catch(()=>{xa.a.$(512497371,801,10,"Failed to load Ribbon script")})}).catch(()=>{xa.a.$(512497370,801,10,"Failed to load Editor script")})}XAn(){xa.a.$(512497369,
809,50,"Start to download chronos2 js file");this.ga.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").qfa("pptedit.chronos2",null,()=>{const V=this.ga.resolve("PowerPointWebEditor.ISessionState");V&&V.iaa("Chronos2DownloadFinished")},()=>a.e(17).then(a.bind(null,1892)))}dispose(){const V=this.ga.resolve("PowerPointWebEditor.IApplicationSettings");V.bze&&V.li&&this.ga.resolve("PowerPointWebEditor.SessionRehydrationController").dispose();l.AFrameworkApplication.Iz&&V.li&&this.ga.resolve("PowerPointWebEditor.IPPTTokenRefreshManager").dispose()}static main(){l.AFrameworkApplication.Ch&&
Vd.a.Yf?xa.a.$(512497368,809,15,"Firefox attempts to load chronos1 package when App is disposing"):u.a.instance.Jc(ni.a(new xg,4))}}Object(k.a)(xg,"Chronos1Package",null,[4,5]);var Sg=a(1026),Bl=a(192),Yj=a(654),jk=a(332),vf=a(77),hi=a(66);class Ml{constructor(){this.shadowDistance=this.shadowAngle=this.shadowBlur=this.shadowSize=this.shadowTransparency=this.shadowColor=null;this.hasShadow=!0}}Object(k.a)(Ml,"Shadow",null,[]);class bl{constructor(){this.hasReflection=this.reflectionDistance=this.reflectionBlur=
this.reflectionSize=this.reflectionTransparency=null}}Object(k.a)(bl,"Reflection",null,[]);class lh{constructor(V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd,yd,Md,te,Pe,t,L,S,ka,ra,xb,Ob,Vb,Ac,$c,qd,Fd,Ud,ae){this.type="FormatPictureTaskPaneProps";this.transparency=this.saturation=this.contrast=this.brightness=this.top=this.left=this.height=this.width=this.numberFormatInfo=null;this.shadowProperties=new Ml;this.reflectionProperties=new bl;this.isPictureReflectionInactive=this.isPictureShadowInactive=this.isPictureTransparencyInactive=
this.isPictureCorrectionsInactive=this.isCropInactive=!1;this.colorMenu=null;this.emptyValueFields=0;this.onSectionToggle=this.pictureCorrectionsSectionProps=this.onEffectToggleChange=this.onChange=this.formatPictureSections=null;this.colorPickerMenuProps=[];const Yd=Object(ld.a)(Object,ic.e().numberFormatInfo);if(!Yd)throw Error.argumentNull("numberFormatInfo");this.numberFormatInfo=Yd;this.width=V;this.height=Ea;this.top=ia;this.left=Za;this.brightness=Va;this.contrast=Ab;this.saturation=gc;this.transparency=
Hc;this.shadowProperties.shadowColor=fd;this.shadowProperties.shadowTransparency=hd;this.shadowProperties.shadowSize=yd;this.shadowProperties.shadowBlur=Md;this.shadowProperties.shadowAngle=te;this.shadowProperties.shadowDistance=Pe;this.shadowProperties.hasShadow=t;this.reflectionProperties.reflectionTransparency=L;this.reflectionProperties.reflectionSize=S;this.reflectionProperties.reflectionBlur=ka;this.reflectionProperties.reflectionDistance=ra;this.reflectionProperties.hasReflection=xb;this.isCropInactive=
Ob;this.isPictureCorrectionsInactive=Vb;this.isPictureTransparencyInactive=Ac;this.isPictureShadowInactive=$c;this.isPictureReflectionInactive=qd;this.emptyValueFields=Fd;this.formatPictureSections=Ud;this.pictureCorrectionsSectionProps=ae}}Object(k.a)(lh,"FormatPictureTaskPaneProps",null,[]);var oi=a(1180),Mk=a(102),nk=a(201),Nk=a(820);const rj=pb.a("PicturePropertiesRename")?ResourceStrings.L_PictureCorrections:ResourceStrings.l_PictureProperties,vl=ResourceStrings.L_PictureTransparency,Vi=ResourceStrings.L_PictureShadow,
hl=ResourceStrings.L_PictureReflection,il=ResourceStrings.L_CropPicture;class zk{constructor(V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd,yd,Md,te){this.HAg=this.IAg=this.JAg=this.Nfk=this.ffk=!0;this.wak=this.C$j=this.yim=this.cgm=this.L5=this.Y5=0;this.Llk=100;this.zSa=this.Iok=0;this.bQg=1;this.ySa=this.wSa=this.xSa=0;this.fxg=!1;this.qhb=this.phb=this.rhb=this.shb=0;this.F8b=this.pc=this.Udm=this.JRh=!1;this.wda="#000000";this.s4=[0,0,0];this.SNf=this.X9a=null;this.yTh=!1;this.A5b=new Map([[rj,!1],[vl,!1],[il,
!1],[Vi,!1],[hl,!1]]);this.GSh=new Map([["FormatPictureSlider-Brightness",{isActive:!1}],["FormatPictureSlider-Contrast",{isActive:!1}],["FormatPictureSlider-Saturation",{isActive:!1}],[Vi,{isActive:!1}],[hl,{isActive:!1}]]);this.L6m=()=>{const Pe=Date.now();this.SNf&&500>Pe-this.uxo||(this.SNf&&clearTimeout(this.SNf),this.SNf=setTimeout(()=>{this.pc&&this.vo(!0);this.SNf=null},800))};this.onSectionToggle=(Pe,t)=>{this.A5b.forEach((L,S)=>this.A5b.set(S,S===Pe?t:!1));this.dEm();this.vo(!0)};this.Led=
(Pe,t,L,S,ka)=>{Pe=this.rb.zd().filter(ra=>!!ra);if(null===Pe||void 0===Pe||!Pe.length)return xa.a.$(508056668,815,10,"FormatPicturePaneActor::updatePictureShadowColor, selected Picture: null"),16;if(1===L)return 32;L=ka.Color;this.wda=L=ka.nonMoreColor?L:`#${JSON.parse(L).hex}`;this.X9a=this.tAb(ka);oi.a.nzh(L,"FontRecentColors");ka=Nk.a.iLh(L);this.s4=[ka.r,ka.g,ka.b];this.onEffectToggleChange([{property:14,value:this.fxg},{property:9,value:this.zSa},{property:10,value:this.bQg},{property:11,value:this.xSa},
{property:12,value:this.wSa},{property:13,value:this.ySa},{property:8,value:this.s4},{property:20,value:this.X9a}],0,!0);return 32};te("powerpoint-editor-intl").then(()=>{this.F8b=!0}).catch(Pe=>{xa.a.$(512350083,801,10,"Failed to load powerpoint-editor-intl "+Pe.toString())});this.rb=V;this.Gb=Ea;this.la=Za;this.Na=ia;this.nh=Va;this.ya=Ab;this.zb=gc;this.vj=Hc;this.p8a=fd;this.zc=hd;this.Fd=yd;if(!Md)throw Error.argumentNull("appSettings");this.na=Md;this.nh.bMa(Object(B.a)(this,this.wVh,"onChangeRenderFormatPicturePane"));
this.Gb.zO(Object(B.a)(this,this.uw,"onAppFrameModeSwitched"));this.Fd.j2a(Object(B.a)(this,this.wVh,"onChangeRenderFormatPicturePane"))}dispose(){this.nh.Dbb(Object(B.a)(this,this.wVh,"onChangeRenderFormatPicturePane"));this.Gb.c6(Object(B.a)(this,this.uw,"onAppFrameModeSwitched"));this.Fd.ACb(Object(B.a)(this,this.wVh,"onChangeRenderFormatPicturePane"))}Ae(){}Kb(){this.la.ua(Rb.a.Rnc,Kc.a.application,Object(B.a)(this,this.Rnc,"queryShowHideReactPictureCropPane"),96);this.la.ua(Rb.a.$sd,Kc.a.application,
Object(B.a)(this,this.$sd,"showHideReactPictureCropPane"),4);this.la.ua(Rb.a.upc,Kc.a.application,Object(B.a)(this,this.upc,"updatePictureCropPane"),4);this.la.ua(Rb.a.NVg,Kc.a.application,Object(B.a)(this,this.Ron,"handleMorePictureShadowColors"),96);this.la.ua(Rb.a.Led,Kc.a.application,this.Led,96)}Mym(V){this.yTh=V}Rnc(V,Ea,Za,ia,Va){(V=Object(ld.a)(jb.a,Va))&&V.Fg(this.pc);return 32}$sd(V,Ea,Za,ia,Va){if(!this.F8b)return 8;if(1===Za)return 32;Ea=this.ya.presentation;if(!this.ya.Ia||!Ea||this.zc.Hd(Ea))return 16;
this.gbo(Va);return fa.b("ShowHideReactPictureCropPane:",this.pc.toString(),V,()=>{if(this.pc=!this.pc){if(this.vo(),!this.na.nzc&&pb.a("CropControlEnableOnDisplayingFormatPicturePane")){const Ab=this.rb.Uo();(null===Ab||void 0===Ab?0:Ab.Yw)||this.la.Eb(Rb.a.Bkc,2)}}else this.Tx();return 32})}gbo(V){null!=V&&"FormatPicture"===V.SourceControlId?(this.A5b.set(rj,!0),this.A5b.set(il,!1)):(this.A5b.set(il,!0),this.A5b.set(rj,!1));this.A5b.set(vl,!1);this.A5b.set(Vi,!1);this.A5b.set(hl,!1)}upc(V,Ea,Za,
ia,Va){if(!this.pc)return 8;if(2===Za)if(this.na.nzc)this.onSectionToggle(Va.sectionName,Va.sectionNewState);else this.vo(!0);return 32}vo(V=!1){var Ea=this.fMh();Ea=this.jN(Ea);const Za=Object.assign(new Sg.a,{title:ResourceStrings.L_FormatPicture,hideHeader:!1,width:320,location:2,contentProps:Ea,onOpen:()=>{},onClose:()=>{this.pc=!1},isModernPane:!0});Bl.a.Gz().then(ia=>{V?ia.updateTaskPane(hi.a.BAb,Za):ia.showTaskPane(hi.a.BAb,Za);return null}).catch(ia=>{xa.a.$(512350082,822,10,"Failed to show picture crop pane. Exception: "+
ia.toString())})}Tx(){Bl.a.Gz().then(V=>{V.hideTaskPane(hi.a.BAb,2);return null}).catch(V=>{xa.a.$(512350081,822,10,"Failed to hide picture crop pane. Exception: "+V.toString())})}jN(V){if(V){const Ea=V.Yfj(),Za=this.zb.Cd;this.L5=Yj.a.Lw(Za.Bf(this.vj.hH(vf.a.pn(Ea.ka(0),Ea.ka(3)),V.zoom),1));this.Y5=Yj.a.Lw(Za.Bf(this.vj.hH(vf.a.pn(Ea.ka(0),Ea.ka(1)),V.zoom),0));this.cgm=Yj.a.Lw(Za.Bf(this.vj.hH(Ea.ka(0).x,V.zoom),0));this.yim=Yj.a.Lw(Za.Bf(this.vj.hH(Ea.ka(0).y,V.zoom),1));this.ffk=!1;this.Udm=
!0}else this.ffk=!0;V=this.Udm?0:15;this.na.nzc&&(this.HAg=this.IAg=this.JAg=this.Nfk=!1,this.NOh()||(V=15,this.HAg=this.IAg=this.JAg=this.Nfk=!0),this.m2n(),this.rmo(),this.tmo(),this.o2n(),this.n2n(),this.na.nHc||this.na.Fia)&&(this.Mym(!1),xa.a.$(507585424,815,50,"FormatPicturePaneActor::onChangeRenderFormatPicturePane setShouldUseShapeNodeValue = false"));V=new lh(this.Y5,this.L5,this.cgm,this.yim,this.C$j,this.wak,this.Llk,this.Iok,this.wda,this.zSa,this.bQg,this.xSa,this.wSa,this.ySa,this.fxg,
this.shb,this.rhb,this.phb,this.qhb,this.JRh,this.ffk,this.Nfk,this.JAg,this.IAg,this.HAg,V,this.A5b,this.GSh);V.colorPickerMenuProps=this.rYd("FillColorPicker");V.onColorSelect=Object(B.a)(this,this.onColorSelect,"onColorSelect");V.showMoreColorsDialog=Object(B.a)(this,this.showMoreColorsDialog,"showMoreColorsDialog");V.onChange=Object(B.a)(this,this.iFa,"onPropertyChange");V.onEffectToggleChange=Object(B.a)(this,this.onEffectToggleChange,"onEffectToggleChange");V.onSectionToggle=this.onSectionToggle;
return V}fMh(){const V=this.rb.Uo();return V&&V.Yw&&V.isConnected?this.p8a.J7(V):null}rmo(){this.W8k(!1);pb.a("FormatPictureSVGsupportEnabled")?this.NOh()&&!this.Q$l()&&(this.W8k(!0),this.T$l()&&this.GSh.set("FormatPictureSlider-Saturation",{isActive:!1})):!this.NOh()||this.T$l()||this.Q$l()||this.W8k(!0)}tmo(){this.HAg=this.IAg=this.JAg=!0;this.NOh()&&(this.HAg=this.IAg=this.JAg=!1)}NOh(){const V=this.rb.zd(),Ea=this.rb.tIc(V);return 1===V.length&&(null===Ea||void 0===Ea?void 0:Ea.Pg)}T$l(){const V=
this.rb.zd();return this.rb.tIc(V).get_isSVGBlipFilled()}Q$l(){const V=this.rb.zd();return this.rb.tIc(V).isGif}W8k(V){this.GSh.forEach((Ea,Za)=>this.GSh.set(Za,{isActive:V}))}m2n(){if(this.na.nzc){const V=this.rb.Uo();null==V||this.na.nHc&&!this.yTh||(this.C$j=V.DT.brightness,this.wak=V.DT.contrast,this.Llk=V.DT.saturation,this.Iok=V.DT.transparency)}}o2n(){if(this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.PictureShadowEffectsEnabled",!1)){const V=this.rb.Uo();null==V||
null==V.wm||this.na.Fia&&!this.yTh||(this.fxg=V.wm.hasShadow,this.s4=V.wm.color,this.zSa=V.wm.transparency,this.bQg=V.wm.size,this.xSa=V.wm.blur,this.wSa=V.wm.angle,this.ySa=V.wm.distance,this.wda=(new Nk.a(this.s4[0],this.s4[1],this.s4[2])).Nib(),this.X9a=nk.a.parse(this.wda))}}n2n(){if(this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.PictureReflectionEffectsEnabled",!1)){const V=this.rb.Uo();null==V||null==V.Dr||this.na.Fia&&!this.yTh||(this.JRh=V.Dr.hasReflection,this.shb=
V.Dr.transparency,this.rhb=V.Dr.size,this.phb=V.Dr.blur,this.qhb=V.Dr.distance)}}onEffectToggleChange(V,Ea,Za){var ia;const Va={};for(const Ab of V)Va[Ab.property]=Ab.value;Va.effectType=Ea;Va.IsChanged=Za;0===Ea?(V.some(Ab=>20===Ab.property)||(this.wda=null===(ia=V.find(Ab=>8===Ab.property))||void 0===ia?void 0:ia.value,Va[20]=nk.a.parse(this.wda)),this.la.Ra(Rb.a.wlh,2,Va)):1===Ea&&this.la.Ra(Rb.a.kah,2,Va);this.vo(!0)}iFa(V,Ea,Za){const ia={};ia.Number=V;ia.IsChanged=Za;switch(Ea){case 0:this.la.Ra(Rb.a.W7e,
2,ia);break;case 1:this.la.Ra(Rb.a.T7e,2,ia);break;case 2:this.la.Ra(Rb.a.U7e,2,ia);break;case 3:this.la.Ra(Rb.a.V7e,2,ia);break;case 4:this.la.Ra(Rb.a.N7e,2,ia);this.C$j=V;break;case 5:this.la.Ra(Rb.a.P7e,2,ia);this.wak=V;break;case 6:this.la.Ra(Rb.a.X7e,2,ia);this.Llk=V;break;case 7:this.la.Ra(Rb.a.b8e,2,ia);this.Iok=V;break;case 9:this.na.Fia&&(this.zSa=V);this.PVb(0,Ea,V,Za);break;case 10:this.na.Fia&&(this.bQg=V);this.PVb(0,Ea,V,Za);break;case 11:this.na.Fia&&(this.xSa=V);this.PVb(0,Ea,V,Za);
break;case 12:this.na.Fia&&(this.wSa=V);this.PVb(0,Ea,V,Za);break;case 13:this.na.Fia&&(this.ySa=V);this.PVb(0,Ea,V,Za);break;case 14:this.na.Fia&&(this.fxg=!!V);this.PVb(0,Ea,V,Za);break;case 15:this.na.Fia&&(this.shb=V);this.PVb(1,Ea,V,Za);break;case 16:this.na.Fia&&(this.rhb=V);this.PVb(1,Ea,V,Za);break;case 17:this.na.Fia&&(this.phb=V);this.PVb(1,Ea,V,Za);break;case 18:this.na.Fia&&(this.qhb=V);this.PVb(1,Ea,V,Za);break;case 19:this.na.Fia&&(this.JRh=!!V),this.PVb(1,Ea,V,Za)}this.vo(!0)}PVb(V,
Ea,Za,ia){const Va={[0]:[{property:14,value:this.fxg},{property:9,value:this.zSa},{property:10,value:this.bQg},{property:11,value:this.xSa},{property:12,value:this.wSa},{property:13,value:this.ySa},{property:8,value:this.s4},{property:20,value:nk.a.parse(this.wda)}],[1]:[{property:19,value:this.JRh},{property:15,value:this.shb},{property:16,value:this.rhb},{property:17,value:this.phb},{property:18,value:this.qhb}]}[V];if(Va){if(!this.na.Fia){const Ab=Va.find(gc=>gc.property===Ea);Ab&&(Ab.value=Za)}this.onEffectToggleChange(Va,
V,ia)}}Qk(V){return V?V.yc(this.zb.Ua):null}dEm(){var V=this.rb.Uo();this.A5b.get(il)?pb.a("CropControlEnableOnDisplayingFormatPicturePane")&&V&&((null===V||void 0===V?0:V.Yw)||this.la.Eb(Rb.a.Bkc,2)):(V=this.Qk(V))&&V.yY(!1)}wVh(){if(this.pc){this.na.nzc&&this.dEm();if(this.na.nHc||this.na.Fia)xa.a.$(507585423,815,50,"FormatPicturePaneActor::onChangeRenderFormatPicturePane setShouldUseShapeNodeValue = true"),this.Mym(!0);this.L6m()}}uw(V){1===V.mode&&this.pc&&(this.pc=!1,this.Tx(),this.Na.Gm(hi.a.BAb,
this.pc))}onColorSelect(V){const Ea={};Ea.Color=V;Ea.nonMoreColor=!0;this.la.Ra(Rb.a.Led,2,Ea)}tAb(V){return nk.a.parse(V.Color)}OVf(V,Ea){const Za={};Za[V]=Ea;this.la.Ra(Rb.a.Led,2,Za)}U8f(){return V=>{this.OVf("Color",V)}}WJf(V){const Ea=[];for(let Za=0;Za<V.length;Za++)Ea.push(appChrome.api.colorPickerCell(V[Za].Color,V[Za].DisplayColor,V[Za].Alt));return Ea}VYb(V,Ea,Za){const ia=this.wda,Va={customOnRenderListLength:1};Va.key=V+Ea;Va.data={["columnCount"]:10,["id"]:V+Ea,["type"]:"AppColorPickerProps",
["colorCells"]:this.WJf(Za),["onExecute"]:this.U8f(),["selectedId"]:oi.a.PJc(Za,ia)};return Va}rYd(V){var Ea=jk.f(this.ya.Ia.Ve,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColors","",1),Za=jk.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColors","",!1);let ia=Ea.ControlList[0].Colors;Ea=this.VYb(V,"Theme",ia);ia=Za.ControlList[0].Colors;Za=this.VYb(V,"Theme",ia);return[Ea,Za,this.VYb(V,"Recent",oi.a.N4f())]}showMoreColorsDialog(){l.AFrameworkApplication.ub.Ra(Rb.a.NVg,
2,{["ShouldCanvasTakeFocus"]:!0,["SourceControlId"]:"MoreFillColors"})}Ron(V,Ea,Za,ia,Va){if(1===Za)return this.la.Ra(Rb.a.renderColorPicker,1,Va);V={};Ea=Mk.a.plc(this.wda);V.currentColor=new Mk.a(Ea);V.handleCommand=Rb.a.Led;return this.la.Ra(Rb.a.renderColorPicker,2,V)}}Object(k.a)(zk,"FormatPicturePaneActor",null,[]);var yk=a(228),ij=a(813);const Nl=ResourceStrings.L_CropPicture;class Tk{constructor(V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd,yd,Md,te,Pe,t,L,S,ka,ra,xb,Ob){this.O_e=!1;if(!t)throw Error.argumentNull("shapeReader");
if(L&&!S)throw Error.argumentNull("shapeSVGDependencyLoader");if(!ka)throw Error.argumentNull("businessBarController");this.la=V;this.sa=Ea;this.Tb=Za;this.Jm=ia;this.zc=Va;this.Ofk=Ab;this.wfm=gc;this.qq=Hc;this.zb=fd;this.ya=hd;this.vj=yd;this.p8a=Md;this.wM=te;this.Y3=Pe;this.La=t;this.Ixb=L;this.SJb=S;this.OA=ra;this.r_=xb;this.E5b=Ob}Kb(){this.la.ua(Rb.a.Bkc,Q.a.application,Object(B.a)(this,this.J9f,"handlePictureCropEvent"),12);this.wfm?(this.la.ua(Rb.a.JMf,Q.a.application,Object(B.a)(this,
this.O5l,"handleCropSplitButton"),4),this.la.ua(Rb.a.KMf,Q.a.application,Object(B.a)(this,this.O5l,"handleCropSplitButton"),4)):(this.la.ua(Rb.a.JMf,Q.a.application,Object(B.a)(this,this.J9f,"handlePictureCropEvent"),4),this.la.ua(Rb.a.KMf,Q.a.application,Object(B.a)(this,this.J9f,"handlePictureCropEvent"),4));this.la.ua(Rb.a.Z3e,Q.a.application,Object(B.a)(this,this.j2n,"queryIsActive"),101);this.la.ua(Rb.a.yoc,Q.a.application,Object(B.a)(this,this.qpn,"handleSendCropInfo"),4);this.la.ua(Rb.a.cxe,
Q.a.application,Object(B.a)(this,this.wAj,"handlePictureCropToShapeEvent"),4);this.la.ua(Rb.a.d4c,Q.a.application,Object(B.a)(this,this.wAj,"handlePictureCropToShapeEvent"),4);this.la.ua(Rb.a.edc,Q.a.application,Object(B.a)(this,this.tXh,"queryPictureCropBounding"),100);this.la.ua(Rb.a.gdc,Q.a.application,Object(B.a)(this,this.tXh,"queryPictureCropBounding"),100);this.la.ua(Rb.a.fdc,Q.a.application,Object(B.a)(this,this.tXh,"queryPictureCropBounding"),100);this.la.ua(Rb.a.Mnc,Q.a.application,Object(B.a)(this,
this.tXh,"queryPictureCropBounding"),100);this.la.ua(Rb.a.T7e,Q.a.application,Object(B.a)(this,this.e2h,"updatePictureCropBounding"),4);this.la.ua(Rb.a.W7e,Q.a.application,Object(B.a)(this,this.e2h,"updatePictureCropBounding"),4);this.la.ua(Rb.a.U7e,Q.a.application,Object(B.a)(this,this.e2h,"updatePictureCropBounding"),4);this.la.ua(Rb.a.V7e,Q.a.application,Object(B.a)(this,this.e2h,"updatePictureCropBounding"),4)}O5l(V,Ea,Za,ia,Va){return 1===Za?32===this.wAj(V,Ea,Za,ia,Va)||32===this.J9f(V,Ea,Za,
ia,Va)?32:8:this.J9f(V,Ea,Za,ia,Va)}qpn(V,Ea,Za,ia,Va){if(!Va)return xa.a.$(512500482,824,50,"Send Crop Info called with no cropping info"),8;Ea=Va.pictCropperInfo;ia=Va.shapeNode;Va=Va.ignoreCommitChanges;if(this.r_){if(!ia)return xa.a.$(512500481,824,10,"Send Crop Info called with invalid ShapeMoniker"),8}else if(!ia||!ia.pictureCropInfo)return xa.a.$(507839492,824,10,"Send Crop Info called with invalid ShapeMoniker"),8;if(1===Za)return 32;if(Za=Od.a.Bb)Za.actionName="EndCropPicture",Za.pj=!1,Za.Oq=
!0;Za=this.Tb.Kd(15);if(this.r_&&(null===ia||void 0===ia?0:ia.aD)&&!this.E5b){if(ia.iZa=Ea,h(ia,this.zb.Ua),!Va)try{Za.tc(ia),Za.wc=V}finally{Za&&Za.dispose()}}else try{Za.tc(ia),Za.wc=V,ia.iZa=Ea}finally{Za&&Za.dispose()}return 32}wAj(V,Ea,Za,ia,Va){if(!this.wfm||this.zc.Hd(this.sa.ut()))return 8;Ea=this.sa.Ie();if(!Ea||!Ea.length||pb.a("PPTO_PICTURES_BUG_8343117_FIX")&&1!==Ea.length)return 8;const Ab=[];for(var gc of Ea)gc&&Ab.push(gc);if(!Ab.length)return 8;for(const hd of Ab)if(hd.isLocal||this.wM.dY(hd)||
!this.Zxn(hd))return 8;if(1===Za)return 32;xa.a.$(512500480,824,15,"HandlePictureCropToShapeEvent:: Crop to Shape operation started");const Hc=Va?Va.SourceControlId:"";gc=0;Za=Hc.split("_");if(3===Za.length)gc=Number.parseInvariant(Za[2]);else return xa.a.$(512500451,824,10,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with unknown shapeName: '{0}'",Hc),16;Za=window.performance.now();Va=new ij.a;Va.TargetShapeTypeAsInt=gc;gc=this.Tb.Kd(15,void 0,()=>{for(const hd of Ab)if(hd.Yw){const yd=
this.Qk(hd);yd&&yd.yY(!1)}xa.a.$(512500450,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with shapeName: '{0}'",Hc)});try{gc.tc(Ab[0]);gc.wc=V;for(var fd of Ab)fd.tnc=Va}finally{gc&&gc.dispose()}V=window.performance.now();if(fd=Od.a.Bb)fd.actionName="PictureCropToShape",fd.Za("PictureCropShapeType",Va.TargetShapeTypeAsInt.toString()),fd.Za("PictureCropToShapeDuration",(V-Za).toString()),Od.a.t0(fd);xa.a.$(512500449,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation completed for shapeType : '{0}'",
Va.TargetShapeTypeAsInt);return 32}J9f(V,Ea,Za,ia,Va){if(!this.Ofk||this.zc.Hd(this.sa.ut()))return 16;if(this.Ixb&&!this.SJb.mTj)return xa.a.$(512500448,824,10,"HandlePictureCropEvent:: Crop operation failed m_shapeSVGDependencyLoader is not loaded"),8;Ea=this.sa.zd();const Ab=this.sa.tIc(Ea);if(1!==Ea.length||!Ab||this.La.Mu(Ab).length||!this.TVj(Ab))return 8;if(1===Za)return 32;if(Ab.isLocal||this.wM.dY(Ab))return 16;if(Ab.Yw){V=this.Qk(Ab);if(!V)return 8;V.yY(!1);Ab.pictureCropInfo=null;vi.App.Zb.fg();
this.upc(null===Ab||void 0===Ab?void 0:Ab.Yw);return 32}"dblclick"===(null===Va||void 0===Va?void 0:Va.eventName)&&ia&&(ia.AD=30);this.sa.lk();const gc=this.ya.Ia;this.zc.blockContent(gc,V,!1,void 0,void 0);const Hc=Od.a.Bb;Hc&&(Hc.actionName="BeginCropPicture",Hc.pj=!1,Hc.Oq=!0);if(this.r_&&(null===Ab||void 0===Ab?0:Ab.aD))return this.cko(Ab,Va)?(xa.a.$(507848068,824,50,"PictureCrop: GC2 Crop triggered succesfully"),this.NRn(Ab,gc),null===yk.ActionManager||void 0===yk.ActionManager?void 0:yk.ActionManager.VC(window.event,
"beginCrop",void 0),32):16;this.Jm.ULh(Ab.get_sid(),Ab.get_cid(),Ab.get_shapeId(),fd=>{Od.a.PB(Hc,()=>{this.WRn(Ab,gc,fd)})},()=>this.VRn(Ab,gc),!0);return 32}NRn(V,Ea){this.zc.BE(Ea);V.isConnected&&(Ea=V.Vg(this.zb.Ua))&&(V.mHc=!0,this.p8a.fca(V).nBm(),Ea.gE(),this.upc(null===V||void 0===V?void 0:V.Yw))}cko(V,Ea){return(V=this.Qk(V))&&V.Ci&&(V=V.Ci)?V.t9("EnterCrop",Ea):!1}j2n(V,Ea,Za,ia,Va){if(!Object(bc.a)(jb.a,Va))return 8;V=this.sa.Uo();Va.Fg(V?V.Yw:!1);return 32}fMh(){const V=this.sa.Uo();return V&&
V.Yw&&V.isConnected?this.p8a.J7(V):null}Qk(V){return V?Object(ld.a)(112,V.yc(this.zb.Ua)):null}tXh(V,Ea,Za,ia,Va){if(!this.Ofk||!Va)return 16;Ea=this.fMh();if(!Ea)return 16;Za=Ea.Yfj();ia=this.zb.Cd;V=V===Rb.a.edc?ia.Bf(this.vj.hH(vf.a.pn(Za.ka(0),Za.ka(3)),Ea.zoom),1):V===Rb.a.gdc?ia.Bf(this.vj.hH(vf.a.pn(Za.ka(0),Za.ka(1)),Ea.zoom),0):V===Rb.a.fdc?ia.Bf(this.vj.hH(Za.ka(0).x,Ea.zoom),0):ia.Bf(this.vj.hH(Za.ka(0).y,Ea.zoom),1);Va=Va.queryResult;null!==Va&&(Va.pga=parseFloat(Yj.a.Lw(V).toFixed(2)).toString());
return 32}e2h(V,Ea,Za,ia,Va){if(!this.Ofk||this.Ixb&&!this.SJb.mTj)return 16;Ea=this.fMh();if(1===Za)return Ea?32:16;if(!Ea||!Va)return 16;if(2===Za){Za=!1;ia=Ea.Yfj().copy();Va=Yj.a.bY(Va.Number);const Ab=vf.a.pn(ia.ka(0),ia.ka(1)),gc=vf.a.pn(ia.ka(0),ia.ka(3)),Hc=this.zb.Cd;V===Rb.a.T7e?(Va=this.vj.YQ(Hc.te(Va,1),Ea.zoom),V=Va-gc,ia.ka(2).AU(0,V),ia.ka(3).AU(0,V)):V===Rb.a.W7e?(Va=this.vj.YQ(Hc.te(Va,0),Ea.zoom),V=Va-Ab,ia.ka(1).AU(V,0),ia.ka(2).AU(V,0)):V===Rb.a.U7e?(Za=!0,Va=this.vj.YQ(Hc.te(Va,
0),Ea.zoom),V=Va-ia.ka(0).x,ia.move(V,0)):V===Rb.a.V7e&&(Za=!0,Va=this.vj.YQ(Hc.te(Va,1),Ea.zoom),V=Va-ia.ka(0).y,ia.move(0,V));Ea.Slo(ia,Za)}return 32}Zxn(V){let Ea=[];V.Ge?Ea=this.La.Mu(V):V.Eg&&(Ea=this.La.Mu(V.us()));if(Ea.length){for(const Za of Ea)if(!this.TVj(Za))return!1;return!0}return this.TVj(V)}TVj(V){const Ea=this.qq.U6e&&!V.isGif&&(V.Pg||1===V.mediaType)&&(!V.get_isSVGBlipFilled()||this.OA&&V.RB);return this.Y3?Ea&&!V.cKb:Ea}VRn(V,Ea){this.zc.BE(Ea);if(!this.isActive||!V.isConnected)return!0;
this.isActive=!1;V.pictureCropInfo=null;xa.a.$(512500446,824,10,"Error: Failed to perform command of Get picture crop info.");return!1}WRn(V,Ea,Za){this.zc.BE(Ea);if(V.isConnected)if(Ea=Od.a.Bb,Od.a.PB(Ea,()=>{this.la.Eb(Rb.a.ufb,2)}),this.wM.dY(V))xa.a.$(512500445,822,50,"Crop is cancelled due to shape manipulation");else{var ia=V.Vg(this.zb.Ua);if(ia){var Va=new Date;V.pictureCropInfo=JSON.parse(Za.PictureCropInfoStr);this.p8a.fca(V).nBm();Za=new Date;Ea&&(Ea.Fm("ParseCropInfoStart",Va),Ea.Fm("ParseCropInfoEnd",
Za),Od.a.t0(Ea));ia.gE();this.upc(null===V||void 0===V?void 0:V.Yw)}}}upc(V){this.la.Ra(Rb.a.upc,2,{["sectionName"]:Nl,["sectionNewState"]:V})}get isActive(){return this.O_e}set isActive(V){this.O_e=V}}Object(k.a)(Tk,"PictureCropActor",null,[]);var Ok=a(1704),Tj=a(219),Nj=a(211),wl=a(242),Hi=a(145),Ak=a(194),Uk=a(460),Zj=a(1200),ak=a(698),jl=a(67),vj=a(91),tk=a(856),kl=a(123),Qh=a(230),ll=a(202),Rl=a(1206),Bk=a(414),Uj=a(170),th=a(212),Sl=a(250),uk=a(331);const Vk=ResourceStrings.L_CropPicture;class kk{constructor(V,
Ea,Za,ia,Va,Ab,gc,Hc,fd,hd,yd,Md,te,Pe,t,L,S){this.pc=!0;this.un=!1;this.Cn=[];this.M8a=this.SJ=this.NIa=this.pY=this.nda=this.Hb=null;this.VG=Array(8);this.Uxg=this.OYa=this.fq=this.TJ=null;this.HSa=this.ef=1;this.Emk=new vf.a(0,0);this.qo=new Tj.a;this.U$=new Nj.a;this.Y0e=new vf.a(0,0);this.vpd=0;this.Gx=new Nj.a;this.Nlk=!1;this.tik=new Nj.a;this.p9a=new vf.a(0,0);this.jxb=new vf.a(0,0);this.nfm=new vf.a(0,0);this.vSg=this.ywb=this.qek=!1;this.UCg=new vf.a(0,0);this.Nyb=this.ixb=null;this.MQh=
new X.a;this.mF=null;if(!ia)throw Error.argumentNull("clickInputManager");if(!V)throw Error.argumentNull("shapeNode");if(yd&&!Pe)throw Error.argumentNull("transformFactory");if(yd&&!t)throw Error.argumentNull("presReader");this.ta=V;this.La=Ea;this.qc=Za;this.kf=ia;this.la=Va;this.Ida=Ab;this.Oe=gc;this.w8a=Hc;this.CGn=fd;this.Jxb=hd;this.Ixb=yd;this.rk=Pe;this.xEn=L;this.zb=S;this.r_=Md;this.E5b=te}Yq(V){this.Hb=new th.a;this.Hb.yk(1);this.Hb.oe(!1);this.Hb.AGa(vj.a.MBm);V.appendChild(this.Hb.viewport);
this.nda=new tk.a(!1,this.Ixb);this.Hb.appendChild(this.nda);this.pY=new tk.a(!1,this.Ixb);this.Hb.appendChild(this.pY);this.pY.yk(1);this.NIa=new ll.a;this.NIa.PC(sa.a.D1);this.NIa.Hx(sa.a.wE);this.NIa.eP(kl.a.none);this.NIa.yk(1);this.Hb.appendChild(this.NIa);this.M8a=new ll.a;this.M8a.yk(1);this.M8a.vl(vj.a.xxa);this.M8a.AGa("ShapeMoveHandle");this.M8a.eP(kl.a.none);this.Hb.appendChild(this.M8a);this.SJ=new Qh.a;this.mDc(this.SJ);this.Hb.appendChild(this.SJ);this.Hb.viewport.va.setAttribute("class",
vj.a.Pqd);this.Hb.oe(!1);this.kf.Ub(w.a.click,this.M8a.va,Object(B.a)(this,this.mVh,"noOpHandler"));this.kf.Ub(w.a.click,this.NIa.va,Object(B.a)(this,this.mVh,"noOpHandler"))}mDc(V){for(let ia=0;8>ia;++ia){var Ea="cropHandle"+ia;const Va=new Qh.a;Va.va.id=Ea;if(Vd.a.sJa){var Za=new Bk.a;Za.va.id=Ea;Za.setVisibility(!1);Za.setPosition(-10,-10);Za.zh(20,20);Va.appendChild(Za)}Za=new Ak.a(ia);Ea=Za.cJb()?this.T3m(Za,Ea):this.E5m(Za,Ea);Va.appendChild(Ea);Va.yk(1);this.VG[ia]=Va;V.appendChild(Va)}}ubg(V){for(let Ea=
0;8>Ea;++Ea)if(this.VG[Ea].va.id===V.id)return new Ak.a(Ea);return null}iyn(V){return V.id.startsWith("cropHandle")}dispose(){this.w8a();this.un=!0;this.pc=!1;this.Hb&&this.Hb.Or();this.Hb=null;this.M8a&&this.kf.hc(w.a.click,this.M8a.va,Object(B.a)(this,this.mVh,"noOpHandler"));this.M8a=null;this.NIa&&this.kf.hc(w.a.click,this.NIa.va,Object(B.a)(this,this.mVh,"noOpHandler"));this.SJ=this.NIa=null;this.VG&&Array.clear(this.VG);this.ixb=this.Nyb=this.VG=null;this.UCg=new vf.a(0,0)}r_h(V,Ea,Za,ia){const Va=
this.Iqj(),Ab=V-Va.x+this.jxb.x+Za,gc=Ea-Va.y+this.jxb.y+ia;return isNaN(Ab)||isNaN(gc)?(xa.a.$(512497029,822,15,"PictureCropShapeView::ShiftPositionRelativeToShape - x:{0}, nodeTopLeft.X:{1}, m_maskViewPositionDiff.X:{2}, distX:{3}, y:{4}, nodeTopLeft.Y:{5}, m_maskViewPositionDiff.Y:{6}, distY:{7}, m_zoom:{8}",V,Va.x,this.jxb.x,Za,Ea,Va.y,this.jxb.y,ia,this.ef),new vf.a(0,0)):new vf.a(Ab,gc)}setPosition(V,Ea){var Za;if(this.ywb)if(this.ywb&&this.r_&&this.ta.aD){Ea=new vf.a(V/this.ef,Ea/this.ef);
V=this.TJ;this.p9a=Ea;Ea=this.hnn();Ea=this.qUe(V,Ea);this.E5b||(this.ta.iZa=Ea);const ia=n(this.ta,this.zb.Ua);null===(Za=null===ia||void 0===ia?void 0:ia.Ci)||void 0===Za?void 0:Za.i2h(vf.a.pn(V.ka(1),V.ka(0)),vf.a.pn(V.ka(3),V.ka(0)),V.ka(0).x*this.ef*window.devicePixelRatio,V.ka(0).y*this.ef*window.devicePixelRatio);this.E5b?m(Ea,this.ta,this.zb.Ua):h(this.ta,this.zb.Ua)}else this.ta.pictureCropInfo&&(this.p9a=Za=new vf.a(V/this.ef,Ea/this.ef),this.Jxb?(this.ixb&&this.nda&&(V=this.r_h(this.ixb.Position.X,
this.ixb.Position.Y,Za.x,Za.y),this.nda.setPosition(V.x,V.y)),this.Nyb&&this.pY&&this.pY.image&&(Za=this.r_h(this.Nyb.Position.X,this.Nyb.Position.Y,Za.x,Za.y),this.pY.image.setPosition(Za.x,Za.y))):((V=this.ta.pictureCropInfo.MaskViewElem)&&this.nda&&(V=this.r_h(V.Position.X,V.Position.Y,Za.x,Za.y),this.nda.setPosition(V.x,V.y)),(V=this.ta.pictureCropInfo.TextureViewElem)&&this.pY&&this.pY.image&&(Za=this.r_h(V.Position.X,V.Position.Y,Za.x,Za.y),this.pY.image.setPosition(Za.x,Za.y))),this.Hb.kn())}ego(V,
Ea){var Za;const ia=new vf.a(this.La.mU(this.ta,this.Ida).x/this.ef,this.La.mU(this.ta,this.Ida).y/this.ef),Va=new vf.a(this.jxb.x+this.p9a.x,this.jxb.y+this.p9a.y);if(this.Jxb)this.ixb&&this.nda&&this.nda.setPosition(this.ixb.Position.X-ia.x+Va.x+V/this.ef,this.ixb.Position.Y-ia.y+Va.y+Ea/this.ef),this.Nyb&&this.pY&&this.pY.image.setPosition(this.Nyb.Position.X-ia.x+Va.x+V/this.ef,this.Nyb.Position.Y-ia.y+Va.y+Ea/this.ef);else{if(pb.a("SmartAlignmentGuidesGC2Fix")&&this.r_&&(null===(Za=this.ta)||
void 0===Za?0:Za.aD)){this.setPosition(this.p9a.x*this.ef+V,this.p9a.y*this.ef+Ea);return}(Za=this.ta.pictureCropInfo.MaskViewElem)&&this.nda.setPosition(Za.Position.X-ia.x+Va.x+V/this.ef,Za.Position.Y-ia.y+Va.y+Ea/this.ef);(Za=this.ta.pictureCropInfo.TextureViewElem)&&this.pY.image.setPosition(Za.Position.X-ia.x+Va.x+V/this.ef,Za.Position.Y-ia.y+Va.y+Ea/this.ef)}this.Hb.kn()}fgo(V,Ea){Ea.qj(1/this.HSa);this.Yym(V,Tj.a.add(this.eZa,Ea))}resize(V,Ea){Ea.qj(1/this.HSa);this.Yym(V,Ea)}Yym(V,Ea){V=this.rDf(V,
Ea);pb.a("FixCropTransformChange")&&!this.Nlk&&(this.tik=V,this.Nlk=!0);this.Ov(V);this.setOffsets(Ea)}Iqj(){const V=this.La.mU(this.ta,this.Ida);return new vf.a(V.x/this.ef,V.y/this.ef)}HEm(){this.ta.Yw&&(this.HSa=this.qc.Hg(this.ta).To/this.Emk.x)}nBm(){var V,Ea;const Za=this.qc.Hg(this.ta);this.Emk.update(Za.To,Za.xk);this.r_&&(null===(V=this.ta)||void 0===V?0:V.aD)&&(this.qek=!0,this.nfm=this.ta.PT.copy(),this.Uxg=this.ta.FTa.copy(),pb.a("CropHandlesNotVisible")&&(V=n(this.ta,this.zb.Ua),V=null===
(Ea=null===V||void 0===V?void 0:V.Ci)||void 0===Ea?void 0:Ea.ge,null===V||void 0===V?0:V.Ze))&&(V.Ze.style.zIndex="2")}qj(V){this.ef=V;this.Hb.qj(this.ef);V=new Nj.a;V.Gpa(1/this.ef,1/this.ef);this.SJ.WJ(V,Uj.a.Tma);this.xEn?this.u9(!1):this.u9(!0)}get zoom(){return this.ef/this.HSa}Yfj(){var V;this.HEm();this.TJ||(this.TJ=this.ta.ju);var Ea=vf.a.pn(this.TJ.ka(0),this.TJ.ka(1));const Za=vf.a.pn(this.TJ.ka(0),this.TJ.ka(3)),ia=this.TJ.Ki(),Va=new Hi.a(new vf.a(0,0),new vf.a(Ea,0),new vf.a(Ea,Za),new vf.a(0,
Za));Va.move(ia.x-Ea/2,ia.y-Za/2);Ea=this.Iqj();this.r_&&(null===(V=this.ta)||void 0===V?0:V.aD)&&(Ea=this.Ojj(this.Ida),Ea=new vf.a(Ea.x/this.ef,Ea.y/this.ef));Va.move(Ea.x,Ea.y);Va.scale(this.HSa,this.HSa);return Va}Slo(V,Ea){var Za,ia;V=V.copy();V.scale(1/this.HSa,1/this.HSa);var Va=this.Iqj();this.r_&&(null===(Za=this.ta)||void 0===Za?0:Za.aD)&&(Va=this.Ojj(this.Ida),Va=new vf.a(Va.x/this.ef,Va.y/this.ef));V.move(-1*Va.x,-1*Va.y);Za=V.Ki();Va=new Nj.a;Ea?Va.Gha(this.ta.get_shapeRotation(),Za):
Va.Gha(this.ta.get_shapeRotation(),this.TJ.ka(0));Va.yl(V);Ea||V.move(this.TJ.ka(0).x-V.ka(0).x,this.TJ.ka(0).y-V.ka(0).y);this.TJ=V;if(this.ywb&&this.r_&&this.ta.aD){Ea=this.qUe(V.copy(),this.OYa);this.E5b||(this.ta.iZa=Ea);Za=vf.a.pn(V.ka(1),V.ka(0));Va=vf.a.pn(V.ka(3),V.ka(0));const Ab=n(this.ta,this.zb.Ua);null===(ia=null===Ab||void 0===Ab?void 0:Ab.Ci)||void 0===ia?void 0:ia.i2h(Za,Va,V.ka(0).x*this.ef*window.devicePixelRatio,V.ka(0).y*this.ef*window.devicePixelRatio);this.E5b?m(Ea,this.ta,this.zb.Ua):
h(this.ta,this.zb.Ua)}pb.a("FixCropTransformChange")&&(this.U$=this.tik,this.NIa.WJ(this.U$,Uj.a.Tma));this.NIa.py(this.TJ.points);ia=this.pY.clipPath;pb.a("SVGCreationOnChangesFromFormatPane")&&this.Ixb&&ia?(ia.rjd=this.tIh(V.copy()),this.BFh(vf.a.kv(V.points[this.vpd],this.Y0e))):ia&&ia.wkc&&ia.wkc.pyh(this.TJ.points);this.vSg=!0;this.u9(!0);this.Hb.kn()}setZIndex(V){this.Hb.NH(V+2*Uk.a.Dva)}setOffsets(V){var Ea,Za;xa.a.$(507803861,822,50,"PictureCropShapeView::setOffsets - crop Handles were moved");
this.TJ||(this.TJ=this.ta.ju);this.lWm(V);this.qo=V;V=this.Kej();this.NIa.py(this.TJ.points);const ia=this.pY.clipPath;this.Ixb&&ia?(this.BFh(vf.a.kv(V.points[this.vpd],this.Y0e)),ia.rjd=this.tIh(V),this.ywb&&this.r_&&(null===(Ea=this.ta)||void 0===Ea?0:Ea.aD)&&(Ea=this.qUe(V,this.OYa),this.E5b?m(Ea,this.ta,this.zb.Ua):this.ta.iZa=Ea,Ea=n(this.ta,this.zb.Ua),null===(Za=null===Ea||void 0===Ea?void 0:Ea.Ci)||void 0===Za?void 0:Za.i2h(vf.a.pn(V.ka(1),V.ka(0)),vf.a.pn(V.ka(3),V.ka(0)),V.ka(0).x*this.ef*
window.devicePixelRatio,V.ka(0).y*this.ef*window.devicePixelRatio))):ia&&ia.wkc&&ia.wkc.pyh(V.points);this.Hb.kn()}lWm(V){var Ea=this.TJ,Za=vf.a.pn(Ea.ka(0),Ea.ka(1));Ea=vf.a.pn(Ea.ka(0),Ea.ka(3));V.bottom-V.top<-1*Ea&&(Ea+=V.bottom-V.top,V.top+=Ea,V.bottom-=Ea);V.right-V.left<-1*Za&&(Za+=V.right-V.left,V.left+=Za,V.right-=Za)}Ov(V){this.U$=V;this.NIa.WJ(V,Uj.a.Tma);this.u9(!0)}SA(V){this.Gx=V;this.Hb.WJ(V,Uj.a.cUb);this.Hb.kn()}tH(){Array.clear(this.Cn)}pR(V){return this.iyn(V)?this.ubg(V):null}DM(V){var Ea;
const Za=[];if(this.ta.Yw){if(!(this.r_&&(null===(Ea=this.ta)||void 0===Ea?0:Ea.aD))){Ea=this.ta.pictureCropInfo;const ia=this.qc.Hg(this.ta);if(Ea.MaskViewElem){const Va=uk.a.QLf(6,ia.To,ia.xk);Array.add(Za,Va)}Ea.TextureViewElem&&(Ea=uk.a.QLf(7,ia.To,ia.xk),Array.add(Za,Ea))}Array.add(this.Cn,V)}else this.pc=!1,this.Hb.oe(!1);return Za}NT(){}Xmo(){this.UCg.x!==this.nda.x&&this.UCg.y!==this.nda.y&&(xa.a.$(512497026,822,50,"PictureCropShapeView::UpdateViewElementPositionForRedraw - Updating maskViewElements and PictureViewElements "),
this.ixb.Position.X=this.nda.x+this.La.mU(this.ta,this.Ida).x/this.ef,this.ixb.Position.Y=this.nda.y+this.La.mU(this.ta,this.Ida).y/this.ef,this.Nyb.Position.X=this.pY.image.x+this.La.mU(this.ta,this.Ida).x/this.ef,this.Nyb.Position.Y=this.pY.image.y+this.La.mU(this.ta,this.Ida).y/this.ef,this.jxb.update(0,0))}Qid(V,Ea){const Za=this.rk.Pjd();this.ta.get_isVerticallyFlipped()&&(Za.Gpa(1,-1),Za.dI(0,2*Ea._y));this.ta.get_isHorizontallyFlipped()&&(Za.Gpa(-1,1),Za.dI(2*Ea._x,0));Za.Gha(V,Ea);return Za}H4l(){return this.ta.get_isVerticallyFlipped()&&
this.ta.get_isHorizontallyFlipped()?2:this.ta.get_isVerticallyFlipped()?3:this.ta.get_isHorizontallyFlipped()?1:0}BFh(V){const Ea=new Nj.a;Ea.dI(V._x,V._y);this.pY.clipPath.WJ(Ea,Uj.a.Tma)}tIh(V){xa.a.$(512497025,809,15,"PictureCropShapeView:: createSVG operation started");var Ea=this.ta.get_shapeRotation();this.rk.x5(-Ea,V.Ki()).yl(V);this.mF||(this.mF=svgShape.FactoryGlobal.createShape());this.mF.setSVGRoot(this.Hb.va,!1);this.ta.DK?this.mF.setShapeType(this.ta.DK):(this.mF.setShapeType(4),xa.a.$(539760099,
809,50,"ShapeNode ArtShapeType is null"));this.mF.setOffsets(this.ta.get_xPersisted()+Ok.a.o0(V.ka(0).x/this.HSa,0),this.ta.get_yPersisted()+Ok.a.o0(V.ka(0).y/this.HSa,1));this.mF.setExtents(Ok.a.o0(V.ka(1).x-V.ka(0).x,0),Ok.a.o0(V.ka(2).y-V.ka(1).y,1));var Za=svgShape.FactoryGlobal.getConvertor().getPath(this.mF,!1,this.HSa,this.HSa);if(!Za||!Za.length)throw xa.a.$(512497024,822,15,"PictureCropShapeView::CreateSVG -No response received from getPath"),Error.invalidOperation(" Invalid response for svgpath element");
V=Array(Za.length);Ea=0;for(const ia of Za)Za=new ll.a,Za.$na(ia),Za.va.setAttribute(kl.a.MZa,this.Gx.KZa()),V[Ea++]=Za;xa.a.$(512496995,809,15,"PictureCropShapeView:: createSVG operation ended");return V}draw(V,Ea){var Za;if(this.r_&&(null===(Za=this.ta)||void 0===Za?0:Za.aD))this.TJ&&vf.a.pn(this.TJ.ka(0),this.TJ.ka(2))||(this.TJ=this.ta.ju),this.OYa=this.ta.FTa,this.M8a.py(this.OYa.points),this.NIa.py(this.TJ.points),this.ywb=!0,this.u9(!0),this.visible=this.pc,this.nda.oe(!1),this.pY.oe(!1),this.Hb.kn(),
this.Hb.oe(this.pc);else if(Array.contains(this.Cn,V)){Array.remove(this.Cn,V);if(this.ta.pictureCropInfo&&!this.ywb){if(this.ta.pictureCropInfo.MaskViewElem){V=this.ta.pictureCropInfo.MaskViewElem;Za=V.Clip;var ia=this.qc.Hg(this.ta);ia=uk.a.QLf(6,ia.To,ia.xk);if(ia=Ea[ia.toString()])this.nda.kym(ia.Base64Data,V.Id.toString(),Za.Bounds.Left,Za.Bounds.Top,Za.TotalWidth,Za.TotalHeight,Za.Bounds.Right-Za.Bounds.Left,Za.Bounds.Bottom-Za.Bounds.Top),this.nda.oe(!0),this.nda.setPosition(V.Position.X-this.La.mU(this.ta,
this.Ida).x/this.ef,V.Position.Y-this.La.mU(this.ta,this.Ida).y/this.ef);this.ixb=V;this.UCg=new vf.a(this.nda.x,this.nda.y)}this.ta.pictureCropInfo.TextureViewElem?(V=this.qc.Hg(this.ta),ia=uk.a.QLf(7,V.To,V.xk),V=this.ta.pictureCropInfo.TextureViewElem,Za=V.Clip,(Ea=Ea[ia.toString()])?this.Ixb?(this.vpd=this.H4l(),this.Y0e=this.fq.points[this.vpd].copy(),this.BFh(vf.a.kv(this.ta.ju.points[this.vpd],this.Y0e)),this.Gx=this.Qid(this.ta.get_shapeRotation(),this.ta.ju.Ki()),this.pY.lym(Ea.Base64Data,
V.Id.toString(),V.Position.X-this.La.mU(this.ta,this.Ida).x/this.ef,V.Position.Y-this.La.mU(this.ta,this.Ida).y/this.ef,Za.TotalWidth,Za.TotalHeight,this.fq.copy().points,this.tIh(this.fq.copy()))):this.pY.jym(Ea.Base64Data,V.Id.toString(),V.Position.X-this.La.mU(this.ta,this.Ida).x/this.ef,V.Position.Y-this.La.mU(this.ta,this.Ida).y/this.ef,Za.TotalWidth,Za.TotalHeight,this.ta.ju.points):xa.a.$(512496993,822,50,"PictureCropShapeView::Draw - No Crop Texture Image Downloaded"),this.Nyb=V):xa.a.$(512496992,
822,50,"PictureCropShapeView::Draw - Unable to set image and bounds to polygon as TextureViewElem is null");this.TJ&&vf.a.pn(this.TJ.ka(0),this.TJ.ka(2))||(this.TJ=this.ta.ju);this.OYa=this.ta.FTa;this.M8a.py(this.OYa.points);this.NIa.py(this.TJ.points);this.ywb=!0;this.u9(!0);this.visible=this.pc}else this.Jxb&&this.ixb&&this.Nyb&&(this.Xmo(),this.nda.setPosition(this.ixb.Position.X-this.La.mU(this.ta,this.Ida).x/this.ef,this.ixb.Position.Y-this.La.mU(this.ta,this.Ida).y/this.ef),this.pY.image.setPosition(this.Nyb.Position.X-
this.La.mU(this.ta,this.Ida).x/this.ef,this.Nyb.Position.Y-this.La.mU(this.ta,this.Ida).y/this.ef),this.Ixb?(this.vpd=this.H4l(),this.Y0e=this.fq.points[this.vpd].copy(),this.BFh(vf.a.kv(this.ta.ju.points[this.vpd],this.Y0e)),this.Gx=this.Qid(this.ta.get_shapeRotation(),this.ta.ju.Ki()),this.pY.clipPath.rjd=this.tIh(this.ta.ju)):this.pY.clipPath.wkc=new Rl.a(this.ta.ju.points,0),this.UCg=new vf.a(this.nda.x,this.nda.y),this.TJ=this.ta.ju,this.OYa=this.ta.FTa,this.M8a.py(this.OYa.points),this.NIa.py(this.TJ.points),
this.u9(!0),xa.a.$(512496991,822,50,"PictureCropShapeView::Draw - Redrawed crop views "));this.r_&&(this.pY&&!this.pY.oU()&&this.pY.oe(!0),this.nda&&!this.nda.oU()&&this.nda.oe(!0));this.Hb.kn();this.Hb.oe(this.pc)}}Jlo(){var V;this.TJ=this.TJ?this.Kej():this.ta.ju;this.fq=this.TJ.copy();this.OYa||(this.OYa=this.ta.FTa);this.OYa.move(this.p9a.x,this.p9a.y);this.M8a.py(this.OYa.points);this.r_&&(null===(V=this.ta)||void 0===V?0:V.aD)&&this.Hb.kn();this.jxb.AU(this.p9a.x,this.p9a.y);this.p9a.update(0,
0);this.Oe.hJ(new Sl.a(1))}$en(){var V=this.SJ.Dqb();const Ea=new vf.a(V[0].x,V[0].y),Za=new vf.a(V[2].x,V[2].y),ia=new vf.a(V[4].x,V[4].y);V=new vf.a(V[6].x,V[6].y);return new Hi.a(Ea,Za,ia,V)}Kej(){var V=this.SJ.Dqb();const Ea=new vf.a(V[0].x/this.ef,V[0].y/this.ef),Za=new vf.a(V[2].x/this.ef,V[2].y/this.ef),ia=new vf.a(V[4].x/this.ef,V[4].y/this.ef);V=new vf.a(V[6].x/this.ef,V[6].y/this.ef);return new Hi.a(Ea,Za,ia,V)}Mfn(){var V,Ea,Za,ia=(pb.a("SmartAlignmentGuidesGC2Fix")&&this.r_&&(null===(V=
this.ta)||void 0===V?0:V.aD)&&null!==this.Uxg?this.Uxg.copy():null===(Ea=this.ta)||void 0===Ea?void 0:Ea.FTa.copy()).points;V=new vf.a(ia[0].x*this.ef,ia[0].y*this.ef);Ea=new vf.a(ia[1].x*this.ef,ia[1].y*this.ef);const Va=new vf.a(ia[2].x*this.ef,ia[2].y*this.ef);ia=new vf.a(ia[3].x*this.ef,ia[3].y*this.ef);ia=new Hi.a(V,Ea,Va,ia);pb.a("SmartAlignmentGuidesGC2Fix")&&this.r_&&(null===(Za=this.ta)||void 0===Za?0:Za.aD)||ia.scale(1/this.HSa,1/this.HSa);ia.move((this.jxb.x+this.p9a.x)*this.ef,(this.jxb.y+
this.p9a.y)*this.ef);return ia}hnn(){var V=this.Uxg.copy().points,Ea=new vf.a(V[0].x,V[0].y);const Za=new vf.a(V[1].x,V[1].y),ia=new vf.a(V[2].x,V[2].y);V=new vf.a(V[3].x,V[3].y);Ea=new Hi.a(Ea,Za,ia,V);Ea.move(this.jxb.x+this.p9a.x,this.jxb.y+this.p9a.y);return Ea}ER(V){this.ywb&&(pb.a("EnabledKeyboardCrop")||this.SJ.oe(!V),V?(this.HEm(),this.vSg=!0):(this.Jlo(),this.la.Ra(Rb.a.upc,2,{["sectionName"]:Vk,["sectionNewState"]:this.ywb}),this.Jxb&&(V={["pictCropperInfo"]:this.qUe(this.TJ,this.OYa),["shapeNode"]:this.ta},
this.la.Ra(Rb.a.yoc,2,V))))}zu(){return this.Hb.zu()}u9(V){if(this.ywb){var Ea=this.TJ.copy();V&&this.U$.yl(Ea);V=new Nj.a;V.tHb(this.ta.get_shapeRotation());var Za=2*Math.ceil((this.ta.get_shapeRotation()-45)/90)%8;for(let ia=0;8>ia;++ia){const Va=this.VG[ia];Va.vl(jl.a.BZ(wl.a.box4Image(kk.S8c[Za]),vj.a.GB));this.WUa(Va,Ea.Pj(new Ak.a(ia)));Va.WJ(V,Uj.a.cUb);Za=(Za+1)%8}}}WUa(V,Ea){V.x===Ea.x*this.ef&&V.y===Ea.y*this.ef||V.setPosition(Ea.x*this.ef,Ea.y*this.ef)}get visible(){return this.pc}set visible(V){var Ea;
this.pc=V;!V&&this.ywb&&(this.aan(),this.ywb=!1,this.r_&&(null===(Ea=this.ta)||void 0===Ea?0:Ea.aD)&&(V=n(this.ta,this.zb.Ua))&&V.Ci&&(V=V.Ci)&&V.t9("ExitCrop",void 0));this.Hb.oe(this.pc)}aan(){var V,Ea,Za,ia;if(this.ywb){var Va=null===(V=this.ta)||void 0===V?void 0:V.Vg(this.zb.Ua);pb.a("CropHandlesNotVisible")&&null!==Va&&(this.r_&&(null===(Ea=this.ta)||void 0===Ea?0:Ea.aD)&&(V=null===(Za=null===Va||void 0===Va?void 0:Va.Ci)||void 0===Za?void 0:Za.ge,null===V||void 0===V?0:V.Ze)&&(V.Ze.style.zIndex=
""),Va.Alm());if(this.vSg&&(Za={["pictCropperInfo"]:this.qUe(this.TJ,this.OYa),["shapeNode"]:this.ta},null===yk.ActionManager||void 0===yk.ActionManager?void 0:yk.ActionManager.VC(window.event,"exitCrop",void 0),this.la.Ra(Rb.a.yoc,2,Za),this.r_&&(null===(ia=this.ta)||void 0===ia?0:ia.aD)&&null!==this.TJ&&null!==this.fq))if(ia=vf.a.pn(this.TJ.ka(0),this.TJ.ka(1)),Za=vf.a.pn(this.TJ.ka(0),this.TJ.ka(3)),pb.a("CropCTASelectionHandlesFix")){V=new vf.a(0,0);Ea=new vf.a(ia,0);const Ab=new vf.a(ia,Za),
gc=new vf.a(0,Za);this.ta.ju=new Hi.a(V,Ea,Ab,gc);Ea=this.qUe(this.Kej(),this.OYa);V=Va.yd.Cd.te(Ea.X,0);Ea=Va.yd.Cd.te(Ea.Y,1);Va.LPh(ia,Za);Va.Hoc(V,Ea,!0,!0)}else V=this.ta.ju,Va=vf.a.pn(V.ka(0),V.ka(1)),V=vf.a.pn(V.ka(0),V.ka(3)),ia-1<=Va&&Va<=ia+1&&Za-1<=V&&V<=Za+1||(Va=new vf.a(this.fq.ka(0).x,this.fq.ka(0).y),ia=new vf.a(this.fq.ka(1).x,this.fq.ka(1).y),Za=new vf.a(this.fq.ka(2).x,this.fq.ka(2).y),V=new vf.a(this.fq.ka(3).x,this.fq.ka(3).y),Va=new Hi.a(Va,ia,Za,V),this.ta.ju=Va);this.hfa()}}qUe(V,
Ea){const Za=this.s_m(V),{left:ia,top:Va,right:Ab,bottom:gc}=this.b2m(V,Ea);V=new Zj.a;V.Left=ia;V.Top=Va;V.Right=Ab;V.Bottom=gc;V.X=Za.x;V.Y=Za.y;return V}b2m(V,Ea){let Za,ia;({left:V,top:Ea,right:Za,bottom:ia}=this.J7m(V,Ea));({left:V,top:Ea,right:Za,bottom:ia}=this.Y2m(V,Ea,Za,ia));({left:V,top:Ea,right:Za,bottom:ia}=kk.$no(V,Ea,Za,ia));return{left:V,top:Ea,right:Za,bottom:ia}}J7m(V,Ea){Ea=Ea.points;const Za=V.points;V=ak.a(Ea[3],Ea[0],Za[3],Za[0]);const ia=ak.a(Ea[0],Ea[1],Za[0],Za[1]),Va=ak.a(Ea[1],
Ea[2],Za[1],Za[2]);Ea=ak.a(Ea[2],Ea[3],Za[2],Za[3]);return{left:V,top:ia,right:Va,bottom:Ea}}Y2m(V,Ea,Za,ia){var Va=this.OYa.points;const Ab=vf.a.pn(Va[0],Va[1]);Va=vf.a.pn(Va[1],Va[2]);V=Math.floor(V/Ab*1E6)/1E6;Ea=Math.floor(Ea/Va*1E6)/1E6;Za=Math.floor(Za/Ab*1E6)/1E6;ia=Math.floor(ia/Va*1E6)/1E6;return{left:V,top:Ea,right:Za,bottom:ia}}Ojj(V){const Ea=this.nfm.copy();Ea.x=V.te(Ea.x,0);Ea.y=V.te(Ea.y,1);return Ea}s_m(V){var Ea,Za;V=V.copy();var ia=new Nj.a;const Va=V.Ki();ia.Gha(-1*this.ta.get_shapeRotation(),
Va);ia.yl(V);ia=this.La.mU(this.ta,this.Ida);this.r_&&(null===(Ea=this.ta)||void 0===Ea?0:Ea.aD)&&this.qek&&(ia=this.Ojj(this.Ida));this.CGn?(Ea=this.Ida.Bf(V.Mc*this.ef+ia.x,0),V=this.Ida.Bf(V.hd*this.ef+ia.y,1),Ea=new vf.a(Ea,V)):Ea=new vf.a(V.Mc+ia.x/this.ef,V.hd+ia.y/this.ef);return this.r_&&(null===(Za=this.ta)||void 0===Za?0:Za.aD)?Ea:vf.a.scale(Ea,this.HSa,this.HSa)}mVh(){return!0}hfa(){var V;this.NIa.WJ(new Nj.a,Uj.a.Tma);this.M8a.setPosition(0,0);this.qo=new Tj.a;this.ta.pictureCropInfo=
null;this.ta.mHc=!1;this.fq=this.TJ=this.U$=null;this.jxb.update(0,0);this.vSg=!1;this.Emk.update(0,0);this.HSa=1;this.Nlk=!1;this.tik=null;this.r_&&(null===(V=this.ta)||void 0===V?0:V.aD)&&(this.qek=!1,this.Uxg=null)}rDf(V,Ea){const Za=new Nj.a;this.fq||(this.fq=V);V=this.fq.Ki();const ia=vf.a.pn(this.fq.ka(0),this.fq.ka(1)),Va=vf.a.pn(this.fq.ka(0),this.fq.ka(3)),Ab=ia?1+(Ea.right-Ea.left)/ia:1,gc=Va?1+(Ea.bottom-Ea.top)/Va:1,Hc=V.copy();Hc.AU(-1*ia/2,-1*Va/2);Za.Gha(-1*this.ta.get_shapeRotation(),
V);Za.dI(-1*Hc.x,-1*Hc.y);Za.Gpa(Ab,gc);Za.dI(Ea.left+Hc.x,Ea.top+Hc.y);Za.Gha(this.ta.get_shapeRotation(),V);return Za}T3m(V,Ea){var Za=[new vf.a(0,0),new vf.a(20,0),new vf.a(20,5),new vf.a(5,5),new vf.a(5,20),new vf.a(0,20)];Za=new Rl.a(Za,0);Za.va.id=Ea;Za.eP("black");Za.PC("white");Za.Hx(1);V.equals(Ak.a.rY)?Za.Ccb(90):V.equals(Ak.a.fD)?Za.Ccb(0):V.equals(Ak.a.JU)?Za.Ccb(180):V.equals(Ak.a.E1)&&Za.Ccb(-90);return Za}E5m(V,Ea){const Za=new Bk.a;Za.va.id=Ea;Za.eP("black");Za.PC("white");Za.Hx(1);
Za.zh(20,5);V.equals(Ak.a.north)?Za.setPosition(-10,0):V.equals(Ak.a.south)?Za.setPosition(-10,-5):V.equals(Ak.a.east)?(Za.setPosition(-5,-10),Za.zh(5,20)):V.equals(Ak.a.west)&&(Za.setPosition(0,-10),Za.zh(5,20));return Za}get eZa(){return this.qo}get ge(){return this.Hb.viewport}hXe(V){return!this.ta.Yw&&8>V.index?this.VG[V.index].va:null}k1(){return!1}vE(V){V&&(this.vSg=!1)}setSelection(){}static $no(V,Ea,Za,ia){.999999<V+Za&&(xa.a.$(512496987,822,15,"Invalid crop region inset values: left({0}), right({1})",
V,Za),Za=(999999-1E6*V)/1E6);.999999<Ea+ia&&(xa.a.$(512496986,822,15,"Invalid crop region inset values: top({0}), bottom({1})",Ea,ia),ia=(999999-1E6*Ea)/1E6);return{left:V,top:Ea,right:Za,bottom:ia}}}kk.S8c=[vj.a.y0h,vj.a.w0h,vj.a.x0h,vj.a.v0h,vj.a.A0h,vj.a.z0h,vj.a.B0h,vj.a.C0h];Object(k.a)(kk,"PictureCropShapeView",null,[740,558,267,40]);var Yl=a(1245);class wj{constructor(V,Ea,Za){this.La=V;this.Ida=Ea;this.p8a=Za}setPosition(V,Ea,Za){this.p8a.J7(V.shapeNode).ego(Ea,Za)}setOffsets(V,Ea){this.p8a.J7(V.shapeNode).fgo(V.K7e.copy(),
Ea)}$qa(V,Ea){const Za=new Nj.a,ia=this.p8a.J7(V.shapeNode);Ea=Ea?ia.$en().copy():ia.Mfn().copy();V=this.La.mU(V.shapeNode,this.Ida);Za.dI(V.x,V.y);Za.yl(Ea);return new Yl.a(Ea)}XJ(V){return V.shapeNode.Yw}}Object(k.a)(wj,"ShapeCropMoveResizeHandler",null,[552]);var Wk=a(492);class Nh{constructor(V,Ea,Za,ia){this.p8a=V;this.Jxb=Ea;this.Gne=Za;this.r_=ia}yY(V,Ea,Za){const ia=this.p8a.J7(V);let Va=void 0;if(ia&&ia.visible!==Za){for(const Ab of Ea)this.Gne&&(Ea=Object(ld.a)(105,Ab))&&(Va=Ea,Ea.setSelected(!Za)),
Ea=this.r_&&(null===V||void 0===V?0:V.aD)&&Ab instanceof Wk.a?!0:!1,Ab===ia||Ea||(Ab.visible=!Za);ia.visible=Za;this.r_&&(null===V||void 0===V?0:V.aD)&&!Za&&Va&&Va.WC()}}Xsd(){return!1}Rtd(V,Ea,Za){this.p8a.J7(V).resize(Za,Ea)}Ysd(){return!1}Std(V,Ea,Za,ia){ia&&this.p8a.J7(V).setPosition(Ea,Za)}nnd(){return!this.Jxb}Pfb(V,Ea){return this.Jxb?Ea:this.r_&&V.aD?(Ea=Ea.filter(Za=>null!==Za&&Za instanceof Wk.a),Array.add(Ea,this.p8a.J7(V)),Ea):[this.p8a.J7(V)]}XJ(V){return V.Yw}}Object(k.a)(Nh,"ShapeViewCropUpdateStrategyHandler",
null,[106,103]);var Yi=a(575);class Ck{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.PictureCrop"}oc(V){this.ga=V;this.ga.register(525,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>").oa().pa(()=>new Yi.a((Ea,Za)=>{let ia=null;const Va=Object(ld.a)(112,Ea.yc(this.ga.resolve("Box4.IPageView").Ua));Va&&!Va.isDisposed&&(ia=new kk(Ea,this.ga.resolve("PowerPointWebEditor.IShapeReader"),this.ga.resolve("PowerPointWebEditor.ISlideReader"),
this.ga.resolve("Common.IClickInputManager"),this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("Box4.IPageView").Cd,this.ga.resolve("PowerPointWebEditor.View.IViewEventNotifier"),Za,this.ga.resolve("PowerPointWebEditor.IApplicationSettings").b3e,this.ga.resolve("PowerPointWebEditor.IApplicationSettings").r4g,this.ga.resolve("PowerPointWebEditor.IApplicationSettings").dxe,this.ga.resolve("PowerPointWebEditor.IApplicationSettings").Plc,this.ga.resolve("PowerPointWebEditor.IApplicationSettings").KYf,
this.ga.resolve("PowerPointWebEditor.ITransformFactory"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").tWe,this.ga.resolve("PowerPointWebEditor.View.IPPTPageView")),ia.Yq(Va.va),ia.setZIndex(3),ia.visible=!1,Va.IR(ia.ge.va,!0),Va.uHb(ia,3));return ia}));this.ga.register(Tk,"PowerPointWebEditor.PictureCropActor").oa().pa(()=>new Tk(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.ga.resolve("Common.Transaction.ITransactionFactory"),this.ga.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.ga.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").l$l,this.ga.resolve("PowerPointWebEditor.IApplicationSettings").i2e,this.ga.resolve("Common.IBrowserUtils"),this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.ga.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.ga.resolve("PowerPointWebEditor.IGraphHotColdManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").fna,this.ga.resolve("PowerPointWebEditor.IShapeReader"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").dxe,this.ga.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),this.ga.resolve("PowerPointWebEditor.IBusinessBarController"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").QK,
this.ga.resolve("PowerPointWebEditor.IApplicationSettings").Plc,this.ga.resolve("PowerPointWebEditor.IApplicationSettings").KYf));this.ga.register(zk,"PowerPointWebEditor.FormatPicturePaneActor").oa().pa(()=>new zk(this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"),this.ga.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.ga.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.ga.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.ga.resolve("PowerPointWebEditor.View.IViewEventSource"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),
Ql.a(this.ga)))}init(){this.ga.resolve("PowerPointWebEditor.ViewElements.ICompositeShapeViewUpdateStrategy").addHandler(new Nh(this.ga.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").r4g,this.ga.resolve("PowerPointWebEditor.IApplicationSettings").Iqd,this.ga.resolve("PowerPointWebEditor.IApplicationSettings").Plc));this.ga.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new wj(this.ga.resolve("PowerPointWebEditor.IShapeReader"),
this.ga.resolve("Box4.IPageView").Cd,this.ga.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>")));this.ga.resolve("PowerPointWebEditor.PictureCropActor").Kb();this.ga.resolve("PowerPointWebEditor.FormatPicturePaneActor").Kb();this.ga.resolve("PowerPointWebEditor.FormatPicturePaneActor").Ae()}dispose(){}static main(){u.a.instance.Jc(ni.a(new Ck,0))}}Object(k.a)(Ck,"PPTWebEditorPictureCropPackage",null,[4,5]);var Vj=a(53),Oj=a(259);class Cl{constructor(V,
Ea,Za,ia,Va){this.mB=[Vj.a.Wg,Vj.a.font,Lb.a.autonumberBulletType];this.Vb=V;this.Wn=Ea;this.Rj=Za;this.Sne=ia;this.MI=Va}format(V){if(V&&V.kJb){V=this.Vb.Lc(V);for(var Ea=this.Wn.lfa(V,V.currentNode);Ea.moveNext();){var Za=Ea.currentNode;if(Za&&this.Rj.ue(Za)){var ia=this.Rj.gbc(Za);ia=this.MI.nR(V,ia);(Za=this.Sne.j_d(Za))&&Oj.d(ia,Za,this.mB)}}}}}Object(k.a)(Cl,"BeautifyListFormatter",null,[717]);class Jg{constructor(V,Ea,Za,ia,Va){this.la=V;this.ya=Za;this.Tb=Ea;this.La=ia;this.BDn=Va}initialize(){this.Kb()}Kb(){this.la.ua(Rb.a.WTe,
Q.a.application,Object(B.a)(this,this.WTe,"applyTextFormatterSuggestion"),4)}WTe(V,Ea,Za){if(1===Za)return 32;Ea=this.ya.Ia;if(!Ea)return 16;Za=Ea.Nj();if(!Za||!Za.length)return 16;Za=this.La.B5(Za);if(!Za.length)return 16;const ia=this.Tb.Kd(15);ia.tc(Ea);pb.a("FixDesignerCrashViaSetUndoActionId")&&(ia.wc=V);for(const Va of Za)this.BDn.format(Va);ia.dispose();return 32}}Object(k.a)(Jg,"TextFormatterActor",null,[]);class ja{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.TextFormatter"}oc(V){this.ga=
V;V.register(717,"PowerPointWebEditor.IBeautifyListFormatter").oa().pa(()=>new Cl(this.ga.resolve("Box4.Graph.IGraphIteratorFactory"),this.ga.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.ga.resolve("Box4.IParagraphReader"),this.ga.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.ga.resolve("PowerPointWebEditor.IPptListEditor")));V.register(Jg,"PowerPointWebEditor.TextFormatter.TextFormatterActor").oa().pa(()=>new Jg(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("Common.Transaction.ITransactionFactory"),
this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.IShapeReader"),this.ga.resolve("PowerPointWebEditor.IBeautifyListFormatter")))}init(){const V=this.ga.resolve("Common.IAppSettingsManager");V.Wf(()=>{V.getBooleanAppSetting(Oe.a.y3e)&&this.ga.resolve("PowerPointWebEditor.TextFormatter.TextFormatterActor").initialize()})}dispose(){}static main(){u.a.instance.Jc(ni.a(new ja,0))}}Object(k.a)(ja,"PPTWebEditorTextFormatterPackage",null,[4,5]);var qb=
a(18);Type.registerNamespace("Box4.Symbols");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.PictureCrop");Type.registerNamespace("PowerPointWebEditor.TellMe");Type.registerNamespace("PowerPointWebEditor.TextFormatter");Object(qb.c)("Chronos1");Kb.main();Type.registerNamespace("Common.App.O365Shell");Aa.main();Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");ne.main();Type.registerNamespace("Common.App.TellMe");
Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");xg.main();window.TellMeAdditionalControls={name:"CommandUI",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Animation",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Animation.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Animation.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",
attrs:{Id:"PptTellMe.Animation.Gallery",ElementDimensions:"Size64by48",Width:"3"},children:[{name:"GalleryButton",attrs:{Id:"Existing",Command:"0x11CFD1C3",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}},{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFadeIn",Alt:"STR@L_AnimationFadeIn"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}}]}]}]}]},
{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.AnimationNew",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"AnimationGallery"},children:[{name:"MenuSection",attrs:{Id:"AnimationGalleryNone"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery1",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"ExistingInMenu",Command:"0x4B65244F",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},
{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEntrance",Id:"AnimationGalleryEntrance"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery2",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}},{name:"GalleryButton",attrs:{Id:"Split",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},
{name:"GalleryButton",attrs:{Id:"GrowAndTurn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowAndTurn",Alt:"STR@L_AnimationGrowAndTurn"}},{name:"GalleryButton",attrs:{Id:"Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",
attrs:{Id:"Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Expand",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationExpand",Alt:"STR@L_AnimationExpand"}},{name:"GalleryButton",attrs:{Id:"PeekIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationPeekIn",Alt:"STR@L_AnimationPeekIn"}},{name:"GalleryButton",attrs:{Id:"RiseUp",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRiseUp",Alt:"STR@L_AnimationRiseUp"}},{name:"GalleryButton",attrs:{Id:"Stretch",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretch",Alt:"STR@L_AnimationStretch"}},{name:"GalleryButton",attrs:{Id:"Strips",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEmphasis",Id:"AnimationGalleryEmphasis"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery3",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Emphasis_Spin",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSpin",
Alt:"STR@L_AnimationSpin"}},{name:"GalleryButton",attrs:{Id:"Emphasis_GrowShrink",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowShrink",Alt:"STR@L_AnimationGrowShrink"}},{name:"GalleryButton",attrs:{Id:"Emphasis_Transparency",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationTransparency",Alt:"STR@L_AnimationTransparency"}},{name:"GalleryButton",attrs:{Id:"Emphasis_LineColor",
Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationLineColor",Alt:"STR@L_AnimationLineColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FillColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFillColor",Alt:"STR@L_AnimationFillColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FontColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationFontColor",Alt:"STR@L_AnimationFontColor"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationExit",Id:"AnimationGalleryExit"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery4",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Exit_Disappear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationDisappear",Alt:"STR@L_AnimationDisappear"}},{name:"GalleryButton",attrs:{Id:"Exit_Fade",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"Exit_FlyOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyOut",Alt:"STR@L_AnimationFlyOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",
Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Exit_Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"Exit_RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"Exit_Zoom",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",
Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Exit_Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Exit_Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Exit_PeekOut",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekOut",Alt:"STR@L_AnimationPeekOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Stretchy",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretchy",Alt:"STR@L_AnimationStretchy"}},{name:"GalleryButton",attrs:{Id:"Exit_Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",
Alt:"STR@L_AnimationStrips"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Transition",Command:"0x78ACF6A1",LabelText:"STR@L_TransitionTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Transition.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Transition.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Transition.Gallery",ElementDimensions:"Size64by48",Width:"2"},children:[{name:"GalleryButton",attrs:{Id:"TransitionExisting",Command:"0xDFACB0EC",QueryCommand:"0x08E3C66D",
InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingTransitionButtonDescription"}},{name:"GalleryButton",attrs:{Id:"TransitionNone",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionNone",Alt:"STR@L_TransitionNone"}},{name:"GalleryButton",attrs:{Id:"TransitionFade",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionFade",Alt:"STR@L_TransitionFade"}},{name:"GalleryButton",
attrs:{Id:"TransitionPush",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionPush",Alt:"STR@L_TransitionPush"}}]}]}]}]},{name:"Button",attrs:{Id:"PptTellMe.Designer",Command:"0x9531543E",LabelText:"STR@L_ShowHideDesignerPane"}},{name:"Button",attrs:{Id:"PptTellMe.Ideas",Command:"0x76FF601A",Image16by16:"IMGMAP@per@LightningIdeasHandraiseState_16x16x32",LabelText:"STR@L_IdeasButtonHomeRibbon"}},{name:"Button",attrs:{Id:"PptTellMe.SelectAll",
Command:"0x148D0534",Image16by16:"IMGMAP@per@SelectAll_16x16x32",LabelText:"STR@L_SelectAllButton"}},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.GroupShapesUpSellButton",LabelText:"STR@L_GroupShapesUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",
Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTGroupShapes",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},
{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButton",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},
{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTWordArt",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButton",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},
children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",
DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTSpellCheckDict",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButton",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",
attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertAudio",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButton",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertChart",LabelText:"STR@L_DesktopUpSellTitle",
Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButtonEnterprise",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",
LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButtonEnterprise",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButtonEnterprise",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButtonEnterprise",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]}]};Ck.main();ja.main();Type.registerNamespace("NLRT");Object(qb.b)("Chronos1")},251:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);var c=a(409);class b{constructor(d,e){this.Ogd=!1;const {Annotations:h}=a(148);if(!d)throw Error.argumentNull("annotations");
if(!d.i_j(e))throw Error.argument("memberTypeID","Invalid type ID");if(h.raa(e))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.lQ=d;this.BPm=e;this.cS=[]}get LTe(){return this.lQ}get isReadOnly(){return this.Ogd}get fTa(){return this.BPm}get items(){return this.cS}keb(){const {Annotations:d}=a(148);let e="[";for(let h=0,n=this.items.length;h<n;++h){0<h&&(e+=", ");const m=this.lQ.keb(this.fTa,this.items[h]);this.fTa===d.OZa?(e+='"',e+=c.a.N4i(m),e+='"'):e+=m}return e+
"]"}isEqual(d){const {Annotations:e}=a(148);if(this===d)return!0;if(!d||d.LTe!==this.lQ||d.fTa!==this.fTa||d.items.length!==this.items.length)return!1;for(let h=0;h<this.items.length;++h)if(!e.eud(this.fTa,this.items[h],d.items[h]))return!1;return!0}clone(){const d=new b(this.lQ,this.fTa);Array.addRange(d.items,this.items);return d}Zva(){return this.isReadOnly?this.clone():this}L3j(){const {Annotations:d}=a(148);if(!this.isReadOnly){this.Ogd=!0;for(const e of this.items)d.Lce(e)}}toString(){return this.keb()}}
Object(y.a)(b,"ListValue",null,[1079,1078])},409:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);class c{constructor(d,e){this.Gid=d;this.value=e}}Object(y.a)(c,"AttrValuePair",null,[]);class b{constructor(d){this.Ogd=!1;if(!d)throw Error.argumentNull("annotations");this.lQ=d;this.$Ca=[]}get LTe(){return this.lQ}get isReadOnly(){return this.Ogd}get UCj(){return 0<this.$Ca.length}zE(d){if(!this.lQ.zZe(d))throw Error.argument("attributeID","Invalid attribute ID");for(const e of this.$Ca)if(d===
e.Gid)return d=e.value,{returnValue:!0,value:d};return{returnValue:!1,value:null}}GU(d,e){var {Annotations:h}=a(148);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.lQ.zZe(d))throw Error.argument("attributeID","Invalid attribute ID");if(!this.lQ.hZe(this.lQ.getAttributeType(d),e))throw Error.argument("value","Value is not of the correct type for the specified attribute");h.Lce(e);for(h=0;h<this.$Ca.length;++h){const n=this.$Ca[h];if(d===
n.Gid){n.value=e;return}}Array.add(this.$Ca,new c(d,e))}dYh(d){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.lQ.zZe(d))throw Error.argument("attributeID","Invalid attribute ID");for(let e=0;e<this.$Ca.length;++e)if(d===this.$Ca[e].Gid){Array.removeAt(this.$Ca,e);break}}IKh(d){if(!d)throw Error.argumentNull("action");for(const e of this.$Ca)d(e.Gid,e.value)}clone(){const d=new b(this.lQ);d.CCc(this);return d}CCc(d){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");
if(!d)throw Error.argumentNull("other");if(d.LTe!==this.lQ)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.$Ca);d.IKh((e,h)=>{this.GU(e,h)})}keb(){const {Annotations:d}=a(148);let e="[",h=!0;for(const n of this.$Ca){h?h=!1:e+=", ";e+=this.lQ.T1l(n.Gid);e+="=";const m=this.lQ.getAttributeType(n.Gid),k=this.lQ.keb(m,n.value);m===d.OZa?(e+='"',e+=b.N4i(k),e+='"'):e+=k}return e+"]"}isEqual(d){const {Annotations:e}=a(148);if(!d)throw Error.argumentNull("other");if(this===d)return!0;
if(!d||this.lQ!==d.LTe||this.UCj!==d.UCj)return!1;let h=0,n=null,m=!1;d.IKh((k,l)=>{++h;if(!m){var u=-1;for(let r=0,x=this.$Ca.length;r<x;++r)if(this.$Ca[r].Gid===k){u=r;break}0>u?m=!0:(n||(n=Array(this.$Ca.length)),n[u]=l)}});if(this.$Ca.length!==h||m)return!1;for(let k=0,l=this.$Ca.length;k<l;++k)if(!e.eud(this.lQ.getAttributeType(this.$Ca[k].Gid),this.$Ca[k].value,n[k]))return!1;return!0}Zva(){return this.isReadOnly?this.clone():this}L3j(){const {Annotations:d}=a(148);if(!this.isReadOnly){this.Ogd=
!0;for(const e of this.$Ca)d.Lce(e.value)}}toString(){return this.keb()}static N4i(d){return d.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(y.a)(b,"FeatureBundle",null,[1077,1078])},497:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);var c=a(41);class b{constructor(){this.currentDocumentPath=c.AFrameworkApplication.ha.Ma("EditDocInClientUrl")}}Object(y.a)(b,"SmartLookupApplicationInterface",null,[])},498:function(y,C,a){a.d(C,"a",function(){return c});
y=a(0);class c{constructor(){this.data=this.landingTab=null}}Object(y.a)(c,"LaunchData",null,[])},565:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}c.Fw="InputMethod";c.naa="ShouldCanvasTakeFocus";c.Otd="UILocation";Object(y.a)(c,"ReactRibbonConstants",null,[])},577:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.Skk=null;this.Q5=this.ank=0}lYf(b,d,e){if(!b)throw Error.argumentNull("referenceList");if(0>d||d>b.length)throw Error.argumentOutOfRange("startIndex");
if(0>e||e>b.length)throw Error.argumentOutOfRange("length");if(d+e>b.length)throw Error.argument("Invalid start-length range");this.Skk=b;this.ank=d;this.Q5=e}Ykd(b,d,e){this.lYf(b.Skk,b.ank+d,e)}ka(b){if(0>b||b>=this.Q5)throw Error.argumentOutOfRange("index");return this.Skk[this.ank+b]}get count(){return this.Q5}static eUi(b){const d=new c;d.lYf(b,0,b.length);return d}}Object(y.a)(c,"ReadOnlyList",null,[1088])},765:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}Object(y.a)(c,"SmartLookupSelection",
null,[])},835:function(y,C,a){a.d(C,"a",function(){return u});y=a(0);var c=a(638),b=a(837),d=a(836),e=a(405),h=a(6),n=a(41),m=a(143),k=a(231),l=a(144);class u{constructor(){this.pH=null}Sib(){try{this.pH||(this.pH=Object(d.a)())}catch(r){e.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+r)}}c7f(r,x){return this.pH?this.pH.getToken(r,x):new Promise(v=>{Object(b.a)().execute(z=>{z?(this.pH=z,this.pH.getToken(r,x).then(A=>v(A))):v(null)})})}c3f(){this.Sib();return this.pH?
this.pH.getToken("Search",n.AFrameworkApplication.ode):null}qXe(){if("Dev Box"===n.AFrameworkApplication.ha.Ma("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(r=>{window.setTimeout(()=>{r(window.TellMeSubstrateTokenOverride)},750)});this.Sib();return this.pH?this.pH.getToken("Search",n.AFrameworkApplication.oLe):null}Rsj(){this.Sib();return this.pH?this.pH.getToken("Search",this.H6f()):null}H6f(){return n.AFrameworkApplication.ha.Ma("TellMeServiceAuthEndpointForSearch")}Rqj(){if("Dev Box"===
n.AFrameworkApplication.ha.Ma("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(r=>{window.setTimeout(()=>{r(window.TellMeSubstrateTokenOverride)},750)});this.Sib();return this.pH?this.pH.getToken("SmartLookup",this.P5f()):null}P5f(){return n.AFrameworkApplication.ha.Ma("SmartLookupShredderServiceEndpoint")}d3f(){return Object(h.a)(this,this.c3f,"getLokiTokenPromise")}t6f(){return Object(h.a)(this,this.qXe,
"getSubstrateTokenPromise")}Bib(){return!!n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.Bib}zMh(){const r={};this.Bib()&&(r.Loki=this.d3f(),r.Substrate=this.t6f());return r}HQa(r){m.a.qLb(Object.assign(new k.a,{name:"Events",dataFields:[Object.assign(new l.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new l.a,{name:"Status",bool:r})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}KPh(){return n.AFrameworkApplication.ha.getBooleanAppSetting("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.HQa(!1);return!1}).then(()=>{this.HQa(!0);return!0}):new Promise((r,x)=>{const v=Object(c.a)().SU;v?v.loadScript("tellme-strings").then(()=>{this.HQa(!0);r(!0)}).catch(()=>{this.HQa(!1);x(!1)}):(this.HQa(!1),x(!1))})}static YOh(){return!!n.AFrameworkApplication.Ha&&(n.AFrameworkApplication.Ha.Ib.J2b||n.AFrameworkApplication.Ha.Ib.Fgb)}static fnd(){return!!n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.Fgb}}Object(y.a)(u,"ReactSharedHeaderSearchUtils",
null,[])},836:function(y,C,a){a.d(C,"a",function(){return b});var c=a(50);const b=()=>c.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager")},837:function(y,C,a){a.d(C,"a",function(){return b});var c=a(50);const b=()=>c.a.instance.eb("Common.App.SearchCommon.ISearchOAuthManager")}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25649181/wdjs/ppteditDS.chronos1.js.map