'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[19],{1128:function(y,C,a){a.d(C,"a",function(){return h});y=a(0);var c=a(88),b=a(6),d=a(460),e=a(123);class h{constructor(n,m,k,l,u,r,x,v,z,A,B,G){this.UDf=1;this.nRa=m;this.Po=n;this.Y$j=k;this.kj=z;this.dD=A;this.kf=B;this.JYc=v;this.RWc=u;this.SWc=l;this.YDa=r;this.kj.addCssClass(this.Po,"prControl");this.Po.style.width=this.kj.Zc(m);this.qQ=x.bXl();this.ITc=x.aXl();this.qQ.YTb(n);this.ITc.YTb(n,m,m);this.jpd=
G;this.Xdc()}dispose(){this.iwh();this.clear();this.qQ.dispose();this.ITc.dispose();this.kj.removeCssClass(this.Po,"prControl")}get qKb(){return e.a.none}clear(){this.vkc();this.IUe();this.Y4e()}setZIndex(n){this.Po.style.zIndex=String(n)}OUg(){this.jpd.va.style.zIndex=String(this.UDf+d.a.Dva)}Y4e(){this.jpd.va.style.zIndex="0"}JZh(n,m,k=null){n=this.JYc.jSi(this.nRa,this.nRa,this.Y$j,n,"",k);this.qQ.setImage(n,m)}tJd(n,m){this.ITc.add(n,m)}IUe(){this.ITc.clear()}vkc(){this.qQ.clear()}onClick(){return!0}Xdc(){this.SWc&&
this.dD.Ub(c.a.ZO,this.Po,this.SWc);this.RWc&&this.dD.Ub(c.a.IQ,this.Po,this.RWc);this.YDa?this.kf.Ub(c.a.click,this.Po,this.YDa):this.kf.Ub(c.a.click,this.Po,Object(b.a)(this,this.onClick,"onClick"));this.kf.Ub(c.a.doubleClick,this.Po,Object(b.a)(this,this.onClick,"onClick"))}iwh(){this.SWc&&this.dD.hc(c.a.ZO,this.Po,this.SWc);this.RWc&&this.dD.hc(c.a.IQ,this.Po,this.RWc);this.YDa?this.kf.hc(c.a.click,this.Po,this.YDa):this.kf.hc(c.a.click,this.Po,Object(b.a)(this,this.onClick,"onClick"));this.kf.hc(c.a.doubleClick,
this.Po,Object(b.a)(this,this.onClick,"onClick"))}}Object(y.a)(h,"ShapePawn",null,[526])},1129:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}c.Gse="Listening";c.$pd="Warning";c.eKb="Error";Object(y.a)(c,"VoiceNotificationResourceStrings",null,[])},1241:function(y,C,a){a.d(C,"a",function(){return c});y=a(44);a=a(48);const c=[a.a.knb,a.a.TLd,a.a.VLd,a.a.bAf,a.a.hzc,a.a.fnb,y.a.Eza,y.a.Kpa,a.a.WKd,a.a.wxi,a.a.Vva,a.a.kzc,a.a.lzc,y.a.Sma,y.a.o2a,y.a.bLd,y.a.Z0,y.a.XHa,y.a.YHa,y.a.Wva,
y.a.qXa,y.a.WTe,a.a.oV,a.a.HP,a.a.NLd,a.a.knb,a.a.PLd,a.a.QLd,a.a.RLd,a.a.backspace,a.a.Iza,a.a.Izc,a.a.Wzi,y.a.pMa,a.a.bold,y.a.bold,y.a.bringForward,y.a.bringToFront,y.a.cDi,a.a.centerJustify,a.a.n7,a.a.o7,a.a.vS,a.a.clearFormatting,a.a.rBc,a.a.GMa,a.a.sOd,y.a.L2a,y.a.$Ac,y.a.ZHa,y.a.lfb,y.a.mfb,y.a.uH,y.a.clearFormatting,y.a.HMa,y.a.Bkc,y.a.Vjd,a.a.sNa,a.a.uG,y.a.vNa,y.a.editSlideTitle,a.a.enter,a.a.IFc,y.a.AGc,a.a.font,y.a.Uba,y.a.flc,y.a.bHc,a.a.fullJustify,a.a.Cia,a.a.HD,y.a.Ffa,a.a.insertHyperlink,
y.a.Cmd,a.a.xsb,a.a.sLj,a.a.Emd,y.a.Fmd,y.a.Gmd,a.a.insertOnlinePicture,y.a.insertOnlinePicture,a.a.insertPicture,y.a.insertPicture,a.a.bja,a.a.S7,y.a.$Ib,y.a.IMc,y.a.L0b,y.a.LMc,y.a.PMc,y.a.QMc,y.a.RMc,y.a.SMc,y.a.TMc,y.a.UMc,y.a.M0b,y.a.N0b,y.a.pna,y.a.Mlc,y.a.aJb,a.a.tgb,a.a.insertTable,a.a.kQc,a.a.kub,a.a.lub,a.a.mub,a.a.lQc,a.a.nQc,a.a.oQc,a.a.nub,a.a.oub,a.a.pub,a.a.pQc,a.a.qub,a.a.rub,a.a.tub,a.a.leftJustify,a.a.j8,y.a.mergeTableCells,y.a.Mre,y.a.vta,a.a.YB,a.a.qbc,y.a.Pna,y.a.pnc,y.a.qnc,
y.a.Gqd,a.a.m0,y.a.tbc,y.a.d4c,y.a.d4c,y.a.yKb,y.a.vY,y.a.Bnc,y.a.Tbc,y.a.Cye,y.a.Qna,y.a.XTa,y.a.dX,y.a.eX,y.a.Cnc,a.a.cH,y.a.ZKb,y.a.$Kb,y.a.fLb,a.a.fLb,a.a.I1k,y.a.yeh,y.a.oGa,y.a.nib,y.a.isd,y.a.sendBackward,y.a.yoc,y.a.sendToBack,y.a.NC,y.a.Up,y.a.Gfc,a.a.Ap,a.a.setItalic,y.a.uxa,y.a.zk,y.a.xLb,y.a.Aib,y.a.Tsd,a.a.hEb,y.a.EJe,y.a.Hgc,a.a.subscript,a.a.superscript,y.a.XLe,y.a.T9,y.a.Hib,a.a.EFb,a.a.mH,a.a.sJ,a.a.VA,a.a.underline]},1242:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);var c=
a(50);class b{createAuthProviderAsync(d){c.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").rZ();return new Promise(e=>{c.a.instance.eb("PowerPointWebEditor.IAppForOfficeAuthFactory").execute(h=>{h=h.kWl(d);e(h)})})}}Object(y.a)(b,"SlideShowAppForOfficeAuthFactory",null,[])},1243:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c extends Sys.EventArgs{constructor(b){super();this.slideId=b.SlideId;this.slideIndex=b.SlideIndex;this.ztd=b.TimeLineMappings}}Object(y.a)(c,
"OnPositionChangedEventArgs",Sys.EventArgs,[])},1244:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}c.CoachButton="coachButton";c.MicButton="micButton";c.PrevButton="prevButton";c.NextButton="nextButton";c.GridButton="gridButton";c.InkButton="inkButton";c.SubtitlesButton="subButton";c.LiveButton="liveButton";c.MoreButton="moreButton";c.ExitButton="exitButton";c.CameraButton="cameraButton";c.OptionsButton="optionsButton";c.SlideIndex="slideIndex";Object(y.a)(c,"SlideshowToolbarButtonIDs",
null,[])},1245:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(b){this.GDa=!0;this.eSc=this.qYc=this.OZc=this.lWc=null;this.Kja=b}copy(){return new c(this.Kja.copy())}move(b,d){this.GDa=!0;this.Kja.move(b,d)}setOffsets(b){this.GDa=!0;this.Kja.setOffsets(b)}Ki(){return this.Kja.Ki()}get Mc(){this.qed();return this.lWc}get hd(){this.qed();return this.OZc}get Gd(){this.qed();return this.qYc}get Bd(){this.qed();return this.eSc}qed(){if(this.GDa){var b=this.Kja.points;this.lWc=
this.qYc=b[0].x;this.OZc=this.eSc=b[0].y;for(const d of b)this.lWc=Math.min(this.lWc,d.x),this.OZc=Math.min(this.OZc,d.y),this.qYc=Math.max(this.qYc,d.x),this.eSc=Math.max(this.eSc,d.y);this.GDa=!1}}}Object(y.a)(c,"Boundary",null,[])},1255:function(y,C,a){function c(){const kb=B.a.instance.resolve("Common.AFrameworkApplication").Bj;return new Qf(B.a.instance.resolve("Common.IActionManagerExtended"),B.a.instance.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),B.a.instance.resolve("PowerPointWebEditor.IFocusManager"),
B.a.instance.resolve("PowerPointWebEditor.IFrameContext").notesPane,B.a.instance.resolve("PowerPointWebEditor.INotesView"),kb.Sd,B.a.instance.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),B.a.instance.resolve("PowerPointWebEditor.IFrameContext"),B.a.instance.resolve("PowerPointWebEditor.IActiveSlideViewManager"),kb,B.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),B.a.instance.resolve("PowerPointWebEditor.View.IPPTPageView"),B.a.instance.resolve("PowerPointWebEditor.IApplicationSettings"))}
function b(kb){return document.getElementById("SlideRootViewElement"+kb)}a.r(C);var d=a(0),e=a(41),h=a(95),n=a(42),m=a(40),k=a(1258),l=a(1254),u=a(235);class r{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.ProfilerAndInteractivityTrackerPackage"}oc(kb){this.ga=kb}init(){const kb=this.ga.resolve("PowerPointWebEditor.IApplicationSettings");kb.NIh&&(this.Qah(),this.Rah(kb))}Qah(){if(n.a("InteractivityTrackerEnabled")){const kb=performance.now();this.ga.resolve("PowerPointWebEditor.IAppBootCompletedListener").vra(()=>
{m.a.$(507801921,822,50,"App::Constructor ResponsiveEventTrackerInit running on invokeOrRegisterOnAppInteractive");e.AFrameworkApplication.ha.Wf(()=>{m.a.$(507801920,822,50,"App::Constructor ResponsiveEventTrackerInit running on invokeOrRegisterOnFullAppSettingsReady");const Xb=performance.now();this.ga.register(k.a,"PowerPointWebEditor.IResponsiveEventTracker").oa().pa(()=>new k.a(this.ga.resolve("PowerPointWebEditor.IAppBootCompletedListener")));this.ga.resolve("PowerPointWebEditor.IResponsiveEventTracker").Init();
m.a.$(507801891,822,50,`ResponsiveEventTrackerInit Initialization completed. TimeTaken : ${performance.now()-Xb}`)})});m.a.$(507801890,822,50,`ResponsiveEventTrackerInit Registration completed. TimeTaken : ${performance.now()-kb}`)}}Rah(kb){if(n.a("PowerPointOnlineJsSelfProfilerEnabled")){const Xb=performance.now();this.ga.resolve("PowerPointWebEditor.IAppBootCompletedListener").vra(()=>{m.a.$(507801889,822,50,"JsSelfProfilerManagerInit running on invokeOrRegisterOnAppInteractive");kb.Wf(()=>{m.a.$(507801888,
822,50,"JsSelfProfilerManagerInit running on invokeOrRegisterOnFullAppSettingsReady");const sc=performance.now();(new l.a(this.ga.resolve("PowerPointWebEditor.IAppBootCompletedListener"),this.ga.Db("PowerPointWebEditor.IResponsiveEventTracker"),u.a(this.ga))).init();m.a.$(507801887,822,50,`JsSelfProfilerManagerInit Initialization completed. TimeTaken : ${performance.now()-sc}`)})});m.a.$(507801886,822,50,`JsSelfProfilerManagerInit Registration completed. TimeTaken : ${performance.now()-Xb}`)}}dispose(){}static main(){h.a.instance.Jc(new r)}}
Object(d.a)(r,"PptProfilerAndInteractivityTrackerPackage",null,[4,5]);var x=a(81),v=a(375),z=a(360),A=a(17),B=a(50),G=a(363),w=a(178),F=a(21),H=a(6),E=a(69),P=a(405);class T{static get K4a(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static requestFullscreen(kb){kb.webkitRequestFullscreen?kb.webkitRequestFullscreen():kb.msRequestFullscreen?
kb.msRequestFullscreen():kb.mozRequestFullScreen?kb.mozRequestFullScreen():kb.requestFullscreen?kb.requestFullscreen():P.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():P.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get aZe(){return document.webkitFullscreenEnabled||
document.msFullscreenEnabled||document.mozFullScreenEnabled||document.fullscreenEnabled}static get sYa(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(d.a)(T,"FullscreenUtils",null,[]);class K{get K4a(){return T.K4a}requestFullscreen(kb){T.requestFullscreen(kb)}exitFullscreen(){T.exitFullscreen()}get aZe(){return T.aZe}get sYa(){return T.sYa}get CTl(){return this.aZe&&!E.a.$y}}Object(d.a)(K,"FullscreenUtilsProxy",
null,[513]);class M{Thn(kb){return inkButton.InkButtonManagerFactory.createInkButtonManager(kb)}}Object(d.a)(M,"InkButtonHelper",null,[520]);var N=a(118),I=a(114),O=a(88),Q=a(64),U=a(111),ba=a(215),aa=a(229),La=a(108);class Z{constructor(){this.menuDefinition=null;this.autoOpenMenu=!1;this.menuHostId=null;this.autoOpenMenu=!1;this.menuHostId="SlideshowToolbarCalloutMenuContainer"}}Object(d.a)(Z,"FlyoutMenuExtraProps",null,[]);class la{}la.VZm="_136_16_N_20";la.WZm="none";Object(d.a)(la,"InkButtonConstants",
null,[]);class da{constructor(){this.menuDefinition=this.controlInMenuRendererFunction=this.menuHostId=this.selectedColor=this.selectedItem=this.icon=null}static create(){return{}}}Object(d.a)(da,"InkButtonProps",null,[]);class J{constructor(){this.onInkMenuActivity=null}}Object(d.a)(J,"IInkButtonSettings",null,[]);class Ca extends J{constructor(){super()}}Object(d.a)(Ca,"InkButtonSettings",J,[]);class Fa{constructor(){this.color=this.item=null}}Object(d.a)(Fa,"InkManagerActivity",null,[]);var ya=
a(119);class Ua{constructor(){this.Hfm=!1;this.Whm=this.fim=0;this.Fdm=""}get n7a(){return this.Hfm}set n7a(kb){this.Hfm=kb}get K6e(){return this.fim}set K6e(kb){this.fim=kb}get slideCount(){return this.Whm}set slideCount(kb){this.Whm=kb}get wYl(){return this.Fdm}set wYl(kb){this.Fdm=kb}}Object(d.a)(Ua,"RehearsalContext",null,[516]);var Ia=a(67);class Oa extends ya.a{constructor(kb,Xb,sc){super(!1,!0);this.wik=50001;this.Ad=kb;this.mf=Xb;this.HH=new Ua;this.pb=sc;this.Ad.TSb(Object(H.a)(this,this.mKb,
"onSlideshowExitHandler"));this.Ad.Cxf(Object(H.a)(this,this.cnc,"onGetCurrentPositionHandler"));this.Ad.getCurrentPosition();this.xVc=!1}dispose(){super.dispose();this.xVc||this.Ad.hga()}wF(){super.wF();document.getElementById("WACDialogOverlay").style.zIndex=String(this.wik);const kb=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(kb,"SlideshowSubtitleProactiveDialogContainer")}X4(){super.X4();var kb=document.getElementById(this.jl("WACDialogPanel"));kb.style.minWidth=
Ia.a.Zc(300);kb.style.width=Ia.a.Zc(300);kb=document.getElementById(this.jl("WACDialogButtonPanel"));var Xb=document.getElementById(this.jl("WACDialogActionButton"));kb&&Xb&&kb.removeChild(Xb);if(Xb=document.getElementById(this.jl("WACDialogCancelButton")))Xb.style.color="#ffffff",Xb.style.font="12pt",Xb.style.background="#A92B1A",Xb.innerText="Got it",n.a("SubtitlesPopUpFocusFix")&&(this.Nva(),this.f6(Xb));kb&&Xb&&e.AFrameworkApplication.isRtl&&n.a("UseWACDialogButtonPanelNewStyles")&&(kb.style.display=
"inline-block",kb.style.padding="0px 14px 14px 0px",Xb.style.margin="10px 0px 0px 10px");if(kb=document.getElementById(this.jl("WACDialogPanel"))){Xb=Ia.a.kg();Xb.style.position="absolute";Xb.style.bottom="20px";Xb.style.left="20px";const sc=Ia.a.s3a();sc.setAttribute("href","https://support.office.com/en-ie/article/present-with-real-time-automatic-captions-or-subtitles-in-powerpoint-68d20e49-aec3-456a-939d-34a79e8ddd5f#OfficeVersion=Online");sc.setAttribute("target","_blank");sc.innerText="More Tips";
Xb.appendChild(sc);kb.appendChild(Xb)}}open(){m.a.$(512495708,830,50,"SlideshowSubtitleProactiveDialog: Open");var kb=this.mf.Eq("SubtitleProactive_clearly.png");const Xb=this.mf.Eq("SubtitleProactive_network.png"),sc=this.mf.Eq("SubtitleProactive_noNoise.png");this.Vl="<div id='subtitleDlg'><div id='captions' class='SubtitleProactiveCaptions'><label id='captionID'></label></div><div id='sectiontitle' class='SubtitleProactiveSectionTitle '><span id='sectiontitle1'><label id='str1ID'></label></span></br><span id='sectiontitle2'><label id='str2ID'></label></span></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
kb+"' style='width: 190px; height: 125px;'/><span id='block1_1' class='SubtitleProactiveBlockTitle'><label id='speakStr1ID'></label></span></br></br><span id='block1_2'><label id='speakStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+sc+"' style='width: 190px; height: 125px;'/><span id='block2_1' class='SubtitleProactiveBlockTitle'><label id='noiseStr1ID'></label></span></br><span id='block2_2'><label id='noiseStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
Xb+"' style='width: 190px; height: 125px;'/><span id='block3_1' class='SubtitleProactiveBlockTitle'><label id='networkStr1ID'></label></span></br></br><span id='block3_2'><label id='networkStr2ID'></label></span></br></br></br></div></div>";kb={["captionID"]:ResourceStrings.L_SubtitleProactive_Caption,["str1ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle1,["str2ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle2,["speakStr1ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr1,["speakStr2ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr2,
["noiseStr1ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr1,["noiseStr2ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr2,["networkStr1ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr1,["networkStr2ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr2};this.qp("",Object(H.a)(this,this.J1c,"onClickHandler"),kb);this.Ad.setVisibility(!0)}s2a(){super.s2a()}O3a(){super.O3a()}foc(){}cnc(){this.Ad.WDe(Object(H.a)(this,this.cnc,"onGetCurrentPositionHandler"));this.open()}mKb(){this.xVc=!0;this.Ad.aLb(Object(H.a)(this,
this.mKb,"onSlideshowExitHandler"));this.Ad.WDe(Object(H.a)(this,this.cnc,"onGetCurrentPositionHandler"));this.hide()}J1c(kb){0===kb&&(kb=Date.now(),this.Ad.cWa(e.AFrameworkApplication.userSessionId,this.pb.podSessionId,this.pb.Hp,e.AFrameworkApplication.Fh,3,kb,this.HH))}static Vam(kb,Xb,sc){return new Oa(kb,Xb,sc)}}Object(d.a)(Oa,"SlideshowSubtitleProactiveDialog",ya.a,[]);var ma=a(1244);class za{constructor(){this.buttonIdDictionary=null}}Object(d.a)(za,"SlideshowToolbarSettings",null,[]);var Qa=
a(89);class Xa extends Sys.EventArgs{constructor(kb){super();this.text=kb}}Object(d.a)(Xa,"ReadOutEventArgs",Sys.EventArgs,[]);var Tb=a(44);class Kb{constructor(kb,Xb,sc,Rc,Zc,Id,Td,he,be,Ue,cf){this.L_e=this.HH=this.xf=this.vJb=this.Ze=this.sRh=this.Omk=this.Yr=null;this.GSa=this.ppd=this.rpd=this.H_e=this.Bod=this.Rdk=0;this.Swa=!1;this.Mck=!0;this.YRh=this.RIa=this.xok=this.K$j=!1;this.Dkk=void 0;this.y6e=(mf,ig)=>{this.GEm(ig.slideIndex+1)};this.dlm=()=>{m.a.$(509157450,830,50,"ReactSlideshowToolbar.OnCameraToggleHandler");
this.P_e=!this.P_e;this.Dyl()};this.clm=()=>{m.a.$(508121225,830,10,"ReactSlideshowToolbar.onCameraErrorHandler");this.P_e=!1;this.Dyl()};this.wQn=mf=>{mf=mf.id?mf.id:"";"NoCameraPermission"===mf?this.Ad.sTl():(m.a.$(508916299,830,50,`ReactSlideshowToolbar.onCameraSelectionChanged - triggered with ${""===mf?"invalid":"valid"} id.`),this.Ad.XDm(mf),this.c2h())};this.DIj=()=>{this.PFn.execute(this.tun);this.Yr.registerButtonCallback(ma.a.OptionsButton,this.WYl);n.a("LogSlideshowToolbarMenuOpen")&&this.WYl(void 0)};
this.tun=mf=>{if(!this.wSh){const ig={onCameraMenuActivity:this.wQn,onPPTLiveButtonActivity:this.omm,onCoachButtonActivity:this.jlm,defaultCameraLabel:this.Ad.getDefaultCameraLabel()};this.wSh=mf.sjn(ig);m.a.$(508916298,830,50,"ReactSlideshowToolbar.initOptionsButton - OptionsButtonManager created.")}this.c2h()};this.WYl=()=>{n.a("LogSlideshowToolbarMenuOpen")&&m.a.$(507590088,830,50,"ReactSlideshowToolbar.dummyOnOptionsButtonClickedHandler")};this.jlm=()=>{m.a.$(512495941,830,50,"ReactSlideshowToolbar.OnCoachClickHandler");
32===this.la.Ra(Tb.a.tZa,2,{entryPoint:2})?this.Ea.EFa||(this.HH.n7a=!0):m.a.$(512495940,830,10,"ReactSlideshowToolbar.OnCoachClickHandler - Failed to start Rehearsal Session")};this.omm=()=>{this.Yd&&this.Yd.instance&&(m.a.$(512495937,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Yd.instance.kM),this.Yd.instance.kM||(this.Yd.instance.uph(3,e.AFrameworkApplication.userSessionId,this.Ea.ym,this.pb.podSessionId,e.AFrameworkApplication.Fh),this.Yd.instance.oIb=!this.xf.Jt,this.xf.SUf&&!this.xf.Jt&&
(m.a.$(512495936,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.xf.Jt=!0,this.Ad.cWa(e.AFrameworkApplication.userSessionId,this.pb.podSessionId,this.pb.Hp,e.AFrameworkApplication.Fh,5,Date.now(),this.HH),this.xf.Jt=!1,this.RIa=!0,this.$1h()),this.Swa=!1,this.Yr.setToolbarButtonToggleState(ma.a.LiveButton,!0)));this.O7e()};this.Ad=sc;this.Kf=Td;this.rB=he;this.pb=Ue;this.la=kb;this.Ea=Xb;this.qpk=Zc;this.Yd=Id;this.PEn=B.a.instance.eb("PowerPointWebEditor.IInkButtonHelper");
this.lTc=this.Ea.getBooleanAppSetting("SlideShowToolbarEaseOfUseEnabled");if(this.Ea.DZ||this.lTc)this.PFn=B.a.instance.eb("PowerPointWebEditor.IOptionsButtonLoader");this.mf=Rc;this.TO=cf}init(kb,Xb){m.a.$(512495955,830,50,"ReactSlideshowToolbar.Init");this.Aim=Xb.slideCount;this.Mck=!0;this.K$j=!1;var sc={};sc[ma.a.MicButton]=this.Ea.I$d;sc[ma.a.PrevButton]=!0;sc[ma.a.NextButton]=!0;sc[ma.a.GridButton]=!0;sc[ma.a.InkButton]=!0;sc[ma.a.SubtitlesButton]=!0;sc[ma.a.LiveButton]=!this.lTc;sc[ma.a.MoreButton]=
!0;sc[ma.a.CameraButton]=this.Ea.DZ;sc[ma.a.ExitButton]=!0;sc[ma.a.OptionsButton]=this.Ea.DZ||this.lTc;sc[ma.a.CoachButton]=this.Ea.g9d&&!this.lTc;sc[ma.a.SlideIndex]=this.lTc;this.Omk=new za;this.Omk.buttonIdDictionary=sc;if(!document.getElementById("slideshow-toolbar")){this.Ze=document.createElement("div");this.Ze.id="slideshow-toolbar";this.Ze.className="ReactSlideshowToolbar";this.Ea.FFa&&(this.sRh=document.getElementById("slideshowfooterContainerElement"),this.Ze.className="ReactSlideshowToolbarWithFooter");
sc=document.createElement("div");sc.id="slideshow-toolbar-accessibility";sc.style.position="absolute";sc.style.left="0px";sc.style.top="auto";sc.style.width="0px";sc.style.height="0px";sc.style.overflow="hidden";sc.setAttribute("aria-label",ResourceStrings.l_SlideShowToolbar);this.Ea.FFa?this.sRh.appendChild(this.Ze):this.Kf.appendChild(this.Ze);this.Yr=slideshowToolbar.SlideshowToolbarFactory.createToolbar(this.Omk,this.Ze);if(!this.Yr){m.a.$(512495954,830,10,"ReactSlideshowToolbar.Init m_slideshowToolbarManager is null.");
const Rc=La.a.Ji(359);e.AFrameworkApplication.Ds(Rc);N.Health.instance.recordQosError(La.a.Vma(Rc),["SlideShowACE"],!1,!0,!0,!1,null)}this.Yr.renderToolbar();this.Ze.appendChild(sc);this.Ze.tabIndex=0}this.vJb||(this.vJb=document.createElement("div"),this.vJb.id="SlideshowToolbarCalloutMenuContainer",this.vJb.className="SlideshowToolbarCalloutMenuContainer",this.rB()&&(this.vJb.style.direction=Qa.a.UEb),this.Kf.appendChild(this.vJb));this.xf=kb;this.HH=Xb;this.Yr.registerButtonCallback(ma.a.MicButton,
()=>{this.HSn()});this.Yr.registerButtonCallback(ma.a.CoachButton,()=>{this.jlm()});this.Ea.DZ?(this.Yr.registerButtonCallback(ma.a.CameraButton,this.dlm),this.Ztn(),this.Yr.registerButtonCallback(ma.a.OptionsButton,this.DIj),this.Yr.showToolbarButton(ma.a.OptionsButton)):this.lTc&&(this.Yr.registerButtonCallback(ma.a.OptionsButton,this.DIj),this.Yr.showToolbarButton(ma.a.OptionsButton));this.xf.Jt||this.Yd&&this.Yd.instance&&this.Yd.instance.kM?(this.RIa=!0,this.Yr.setToolbarButtonToggleState(ma.a.MicButton,
this.RIa),this.Yr.showToolbarButton(ma.a.MicButton)):(this.RIa=!1,this.Yr.setToolbarButtonToggleState(ma.a.MicButton,this.RIa),this.Yr.hideToolbarButton(ma.a.MicButton));this.Yr.registerButtonCallback(ma.a.PrevButton,Rc=>{this.M1e(Rc)});this.Yr.registerButtonCallback(ma.a.NextButton,Rc=>{this.J1e(Rc)});this.Yr.registerButtonCallback(ma.a.GridButton,Rc=>{this.I1e(Rc)});this.Yr.showToolbarButton(ma.a.GridButton);this.xf.SUf&&!this.HH.n7a&&(this.Yr.registerButtonCallback(ma.a.SubtitlesButton,Rc=>{this.UVh(Rc)}),
this.Yr.setToolbarButtonToggleState(ma.a.SubtitlesButton,this.xf.Jt),this.Yr.showToolbarButton(ma.a.SubtitlesButton));this.Yr.registerButtonCallback(ma.a.ExitButton,Rc=>{this.H1e(Rc)});this.Ea.fZe&&this.Ea.t$d&&(kb=da.create(),kb.icon=this.lTc?"InkingTool_20":la.VZm,kb.selectedColor=la.WZm,this.Yr.updateElementProps(ma.a.InkButton,kb),this.Yr.registerButtonCallback(ma.a.InkButton,()=>{this.iun()}),this.Yr.showToolbarButton(ma.a.InkButton));this.Yd&&this.Yd.instance&&this.Yd.instance.FO&&!this.HH.n7a&&
(this.Yr.registerButtonCallback(ma.a.LiveButton,()=>{this.omm()}),this.Yr.updateFlyoutButtonCallback(ma.a.LiveButton,this.Yd.instance.kM),this.Yr.setToolbarButtonToggleState(ma.a.LiveButton,this.Yd.instance.kM),this.Yr.showToolbarButton(ma.a.LiveButton),this.Yd.instance.eQl(Object(H.a)(this,this.w_g,"onLiveSessionStarted")),this.Yd.instance.dQl(Object(H.a)(this,this.v_g,"onLiveSessionEnded")),this.Yd.instance.aQl(Object(H.a)(this,this.u_g,"onLiveRelaunchPausedSession")),this.Yd.instance.gVm(Object(H.a)(this,
this.qmm,"onLiveCalloutMenuDefintionChanged")));this.O7e();this.UWd();this.lTc&&this.Ad.Pjc(this.y6e);this.Ad.TSb(Object(H.a)(this,this.kac,"onExitHandler"));this.Ad.rti(Object(H.a)(this,this.MYg,"onBrowserEventHandler"));this.Ad.Dxf(Object(H.a)(this,this.nac,"onGetCurrentSlideDimensionsHandler"));this.Ad.OFh(Object(H.a)(this,this.xqd,"onSpecialKeyHandler"));this.Ad.vti(Object(H.a)(this,this.N1c,"onContextMenuHandler"));this.Ad.Cti(Object(H.a)(this,this.ylm,"onEnterEndOfShowHandler"));this.Ad.Mti(Object(H.a)(this,
this.lmm,"onLeaveEndOfShowHandler"));this.Ad.JPl(this.clm);I.a.addHandler(this.Ze,O.a.jv,Object(H.a)(this,this.Rue,"onMouseOverHandler"));I.a.addHandler(this.Ze,O.a.hy,Object(H.a)(this,this.I_g,"onMouseOutHandler"));I.a.addHandler(this.vJb,O.a.click,Object(H.a)(this,this.J1c,"onClickHandler"));I.a.addHandler(this.Ze,O.a.oi,Object(H.a)(this,this.tac,"onKeyDownHandler"));n.a("FixSlideIndexInToolbar")&&this.GEm(-1==Xb.K6e?1:Xb.K6e)}Reo(){window.clearTimeout(this.Rdk);this.Rdk=window.setTimeout(Object(H.a)(this,
this.Sqn,"hideMouse"),3E3);this.Ad.uEb(!0)}Sqn(){this.Swa||(window.clearTimeout(this.Rdk),this.Ad.uEb(!1))}xY(kb,Xb){Xb?this.Yr.showToolbarButton(kb):this.Yr.hideToolbarButton(kb)}setToolbarButtonToggleState(kb,Xb){this.Yr.setToolbarButtonToggleState(kb,Xb)}show(){if(!this.O3e()){if(this.rB()){const kb=document.getElementById("slideshow-toolbar");if(kb){const Xb=(this.rpd+this.GSa-16-this.Yr.getToolbarWidth()).toString()+"px";kb.style.left=Xb}}this.Yr.showToolbar();this.Yr.enterFocusTrapZone();window.clearTimeout(this.Bod);
window.clearTimeout(this.H_e);this.Mck?(this.Bod=window.setTimeout(Object(H.a)(this,this.hide,"hide"),2E3),this.Mck=!1,this.K$j=!0):this.Bod=window.setTimeout(Object(H.a)(this,this.hide,"hide"),3E3);this.Ad.uEb(!0)}}oAm(){if(this.rB()){const kb=document.getElementById("slideshow-toolbar");if(kb){const Xb=(this.rpd+this.GSa-16-this.Yr.getToolbarWidth()).toString()+"px";kb.style.left=Xb}}this.Yr.showToolbar();this.Yr.enterFocusTrapZone();window.clearTimeout(this.Bod);window.clearTimeout(this.H_e);this.H_e=
window.setTimeout(Object(H.a)(this,this.hide,"hide"),1E4)}hide(){if(!this.Swa){const kb=document.getElementById("slideshow-toolbar");kb&&!this.Yr.isAnyToolbarElementFocused()&&document.activeElement===kb&&this.Ktd(ResourceStrings.l_SlideShowToolbarDismissed);window.clearTimeout(this.Bod);window.clearTimeout(this.H_e);this.Yr.hideToolbar();this.Ad.uEb(!1);this.Ze.style.display!==Qa.a.Uf||this.O3e()||this.Ad.hga()}}UWd(){this.Swa||(this.K$j&&this.Ktd(ResourceStrings.l_SlideShowToolbarDismissed),window.clearTimeout(this.Bod),
window.clearTimeout(this.H_e),this.Yr.forceHideToolbar(),this.Ad.uEb(!1),this.Ze.style.display!==Qa.a.Uf||this.O3e()||this.Ad.hga())}remove(){m.a.$(507773729,830,50,"ReactSlideshowToolbar::Starting toolbar remove.");this.Yr.closeToolbar();this.vJb.style.visibility=Qa.a.ht;this.YRh=!1;this.lTc&&this.Ad.F7c(this.y6e);this.Ad.aLb(Object(H.a)(this,this.kac,"onExitHandler"));this.Ad.WYk(Object(H.a)(this,this.MYg,"onBrowserEventHandler"));this.Ad.lch(Object(H.a)(this,this.nac,"onGetCurrentSlideDimensionsHandler"));
this.Ad.qYh(Object(H.a)(this,this.xqd,"onSpecialKeyHandler"));this.Ad.YYk(Object(H.a)(this,this.N1c,"onContextMenuHandler"));this.Ad.bZk(Object(H.a)(this,this.ylm,"onEnterEndOfShowHandler"));this.Ad.iZk(Object(H.a)(this,this.lmm,"onLeaveEndOfShowHandler"));this.Ad.Ztm(this.clm);I.a.removeHandler(this.Ze,O.a.jv,Object(H.a)(this,this.Rue,"onMouseOverHandler"));I.a.removeHandler(this.Ze,O.a.hy,Object(H.a)(this,this.I_g,"onMouseOutHandler"));I.a.removeHandler(this.vJb,O.a.click,Object(H.a)(this,this.J1c,
"onClickHandler"));I.a.removeHandler(this.Ze,O.a.oi,Object(H.a)(this,this.tac,"onKeyDownHandler"));this.Ze&&(this.Kf.contains(this.Ze)||this.sRh&&this.sRh.contains(this.Ze))&&(this.Swa=!1);this.Yd&&this.Yd.instance&&this.Yd.instance.FO&&(this.Yd.instance.sum(Object(H.a)(this,this.w_g,"onLiveSessionStarted")),this.Yd.instance.rum(Object(H.a)(this,this.v_g,"onLiveSessionEnded")),this.Yd.instance.pum(Object(H.a)(this,this.u_g,"onLiveRelaunchPausedSession")),this.Yd.instance.t6n(Object(H.a)(this,this.qmm,
"onLiveCalloutMenuDefintionChanged")));m.a.$(507773728,830,50,"ReactSlideshowToolbar::Toolbar removed.")}kac(){this.remove()}Ktd(kb){Q.a.wb(kb)?m.a.$(512495953,830,15,"ReactSlideshowToolbar::TryRaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.qpk.rRk(new Xa(kb))}nac(kb,Xb){try{this.rpd=Xb.Jll;this.ppd=Xb.yll;this.GSa=Xb.slideWidth;if("NaN"===this.rpd.toString()||"NaN"===this.ppd.toString()){m.a.$(512495952,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler slide dimension info is null.");
const sc=La.a.Ji(359);e.AFrameworkApplication.Ds(sc);N.Health.instance.recordQosError(La.a.Vma(sc),["SlideShowACE"],!1,!0,!0,!1,null)}else{const sc=this.Yd.instance&&this.Yd.instance.kM&&!this.YRh?26:0;if(this.Ea.FFa){const Rc=document.getElementById("slideshowfooterContainerElement");if(Rc){let Zc;Zc=this.rB()?(this.rpd+this.GSa-16-this.Yr.getToolbarWidth()).toString()+"px":(this.rpd+2).toString()+"px";Rc.style.left=Zc;if(this.xf.Jt&&"AboveSlide"===this.xf.a5)Rc.style.bottom="0px";else{const Td=
U.a.Wld();kb=0;const he=document.getElementById("AppHeaderPanel");he&&(kb=he.clientHeight);Rc.style.bottom=this.TO.sYa?(Td-this.ppd-sc).toString()+"px":(Td-this.ppd-kb-sc).toString()+"px"}Rc.style.top="auto";const Id=document.getElementById("ReactToolbarInnerContainer");Id&&(Id.style.position="relative")}}else{const Rc=document.getElementById("slideshow-toolbar");if(Rc){let Zc;Zc=this.rB()?(this.rpd+this.GSa-16-this.Yr.getToolbarWidth()).toString()+"px":(this.rpd+2).toString()+"px";Rc.style.left=
Zc;const Id=this.Yd.instance&&this.Yd.instance.kM?(this.ppd+sc).toString()+"px":this.ppd.toString()+"px";"AboveSlide"===this.xf.a5?(Rc.style.bottom="0px",Rc.style.top="auto"):(Rc.style.top=Id,Rc.style.bottom="auto");Rc.style.top=Id}}}this.show()}catch(sc){m.a.$(512495951,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler: Exception thrown when trying to access the OnGetCurrentSlideDimensionsEventArgs, exception: {0}",sc)}}O3e(){return n.a("SubtitlesPopUpFocusFix")?void 0!==this.Dkk&&
this.Dkk.sU:!1}ylm(){this.YRh=!0}lmm(){this.YRh=!1}tac(kb){this.Yr.isAnyCalloutMenuOpen()||(this.Swa=!1);try{this.Ze.style.display===Qa.a.zn&&(kb.keyCode===ba.a.$Lb||kb.keyCode===ba.a.cG||kb.keyCode===ba.a.m6?this.iXh():kb.keyCode===ba.a.jjb||kb.keyCode===ba.a.bG||kb.keyCode===ba.a.l6?this.vse():kb.keyCode===ba.a.O1?this.rB()?this.vse():this.iXh():kb.keyCode===ba.a.GY?this.rB()?this.iXh():this.vse():kb.keyCode===ba.a.HWa?(this.xok=!0,this.UWd()):kb.shiftKey&&kb.keyCode===ba.a.Eva||kb.keyCode===ba.a.Lpc?
this.UWd():this.Ad.jZh(kb))}catch(Xb){m.a.$(512495950,822,10,"ReactSlideshowToolbar.OnKeyDownHandler Exception in KeyDownHandler : {0}.",Xb)}}xqd(kb,Xb){var sc;this.Yr.isAnyCalloutMenuOpen()||(this.Swa=!1);Xb.key===ba.a.Lpc||Xb.shiftKey&&Xb.key===ba.a.Eva?(kb="off",this.Ze.style.display===Qa.a.Uf?(this.oAm(),kb="on"):this.UWd(),m.a.$(512495949,830,50,"ReactSlideshowToolbar.OnSpecialKeyHandler: T key pressed, turned slideshow toolbar {0}",kb)):this.Ea.DZ&&Xb.altKey&&Xb.key===ba.a.MGb?(this.wSh||this.DIj(),
null===(sc=this.wSh)||void 0===sc?void 0:sc.selectNextCameraDevice()):this.Ea.DZ&&Xb.shiftKey&&Xb.key===ba.a.bgd&&this.dlm()}N1c(){if(this.xok)this.xok=!1;else{var kb="off";this.Ze.style.display===Qa.a.Uf?(this.oAm(),kb="on"):this.Yr.isAnyCalloutMenuOpen()||this.UWd();m.a.$(512495948,830,50,"ReactSlideshowToolbar.OnContextMenuHandler: ContextMenu event received, turned slideshow toolbar {0}",kb)}}MYg(kb,Xb){this.Reo();Xb.clientY<this.ppd+8+20&&Xb.clientY>this.ppd-20-8&&this.show()}Rue(kb){(kb=kb.target)&&
this.Ze.contains(kb)&&(this.Swa=!0)}I_g(kb){kb.target&&(this.Yr.isAnyCalloutMenuOpen()?this.vJb.style.visibility=Qa.a.xx:(this.Swa=!1,this.show()));this.Yr.isAnyCalloutMenuOpen()||this.O3e()||this.Yr.enterFocusTrapZone()}J1c(kb){this.Swa=!1;window.clearTimeout(this.Bod);window.clearTimeout(this.H_e);this.vJb.style.visibility=Qa.a.ht;this.Bod=window.setTimeout(Object(H.a)(this,this.hide,"hide"),3E3);"SlideshowToolbarCalloutMenuContainer"===kb.target.id&&(this.O3e()||this.Yr.enterFocusTrapZone())}M1e(){m.a.$(512495947,
830,50,"ReactSlideshowToolbar.OnPrevClickHandler");this.iXh()}J1e(){m.a.$(512495946,830,50,"ReactSlideshowToolbar.OnNextClickHandler");this.vse()}iXh(){this.Ad.prev()}vse(){this.Ad.next()}GEm(kb){this.Yr.updateElementProps(ma.a.SlideIndex,{innerText:`${kb.toString().padStart(this.Aim.toString().length,"0")} of ${this.Aim}`})}H1e(){m.a.$(512495945,830,50,"ReactSlideshowToolbar.OnExitClickHandler");this.Yr.closeToolbar();this.Ad.exit()}ktl(kb){const Xb=!!this.Yd&&!!this.Yd.instance&&this.Yd.instance.kM;
var sc=this.xf.R_l&&5!==kb&&!Xb;5!==kb&&(this.xf.Jt&&(aa.a.rX("PPTCaptionDiscoverabiltyDoNotShowAgain","true",aa.a.BU)||m.a.$(512495944,822,10,"ReactSlideshowToolbar::ToggleTranscriber - Failed to set cookie for discoverability opt out to true")),this.xf.Jt=!this.xf.Jt);this.Yr.setToolbarButtonToggleState(ma.a.SubtitlesButton,this.xf.Jt);m.a.$(512495943,830,50,"ReactSlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",this.xf.Jt);this.xf.Jt&&sc&&(n.a("SubtitlesPopUpFocusFix")&&
this.UWd(),this.Dkk=Oa.Vam(this.Ad,this.mf,this.pb));sc||(sc=Date.now(),Xb?this.RIa||this.Yd.instance.kWe()?this.Ad.r1h(null):(this.Yd.instance.d6l(),this.Ad.cWa(e.AFrameworkApplication.userSessionId,this.pb.podSessionId,this.pb.Hp,e.AFrameworkApplication.Fh,kb,sc,this.HH)):this.Ad.cWa(e.AFrameworkApplication.userSessionId,this.pb.podSessionId,this.pb.Hp,e.AFrameworkApplication.Fh,kb,sc,this.HH));this.RIa=this.xf.Jt||Xb;this.$1h();this.O7e()}$1h(){this.Yr.setToolbarButtonToggleState(ma.a.MicButton,
this.RIa);this.RIa?this.Yr.showToolbarButton(ma.a.MicButton):this.Yr.hideToolbarButton(ma.a.MicButton)}O7e(){const kb=this.xf.Jt,Xb=!!this.Yd&&!!this.Yd.instance&&this.Yd.instance.kM,sc=this.HH.n7a,Rc=32!==this.la.Eb(Tb.a.tZa,1);kb||Xb||sc||Rc?this.Yr.hideToolbarButton(ma.a.CoachButton):this.Yr.showToolbarButton(ma.a.CoachButton)}HSn(){m.a.$(512495942,830,50,"ReactSlideshowToolbar.OnMicToggleHandler");this.RIa=!this.RIa;this.Yr.setToolbarButtonToggleState(ma.a.MicButton,this.RIa);this.Ad.K5e(!this.RIa);
if(this.Yd&&this.Yd.instance&&this.Yd.instance.kM&&this.RIa&&!this.Yd.instance.kWe()){this.Yd.instance.d6l();const kb=this.xf.Jt;this.Yd.instance.oIb=!this.xf.Jt;this.xf.Jt=!0;this.Ad.cWa(e.AFrameworkApplication.userSessionId,this.pb.podSessionId,this.pb.Hp,e.AFrameworkApplication.Fh,5,Date.now(),this.HH);this.xf.Jt=kb}}pXm(){return Object(x.b)(this,void 0,void 0,function*(){try{return navigator.permissions?"denied"!==(yield navigator.permissions.query({name:"camera"})).state:(m.a.$(508908556,830,
10,"ReactSlideshowToolbar.areCameraPermissionsGrantedAsync - insecure context."),!1)}catch(kb){return m.a.$(508885084,830,10,"ReactSlideshowToolbar.areCameraPermissionsGrantedAsync - exception="+kb),!1}})}Ztn(){Object(x.b)(this,void 0,void 0,function*(){(this.P_e=yield this.pXm())||m.a.$(508688463,830,10,"ReactSlideshowToolbar.initCameraToggleAsync - camera permissions denied.");this.Dyl();this.Yr.showToolbarButton(ma.a.CameraButton)})}Dyl(){this.Yr.setToolbarButtonToggleState(ma.a.CameraButton,this.P_e);
this.Ad.setCameraState(this.P_e)}c2h(){Object(x.b)(this,void 0,void 0,function*(){var kb=!!this.Yd&&!!this.Yd.instance&&this.Yd.instance.kM;kb=yield this.wSh.getControlsInMenuAsync(kb,kb?this.Yd.instance.getCalloutMenuDefinition():{sections:[{controls:[]}]},this.Ea.g9d,this.Ea.DZ);this.Yr.updateElementProps(ma.a.OptionsButton,{menuDefinition:kb,menuHostId:"SlideshowToolbarCalloutMenuContainer"})})}UVh(){m.a.$(512495939,830,50,"ReactSlideshowToolbar.OnTranscribeHandler");this.ktl(3)}I1e(){m.a.$(512495938,
830,50,"ReactSlideshowToolbar.OnGridViewClickHandler");let kb;n.a("AddGridViewTelemetryInSS")&&(kb=performance.now());this.la.Ra(Tb.a.yJe,2,null);n.a("AddGridViewTelemetryInSS")&&m.a.$(507852185,830,15,JSON.stringify({timeTaken:performance.now()-kb}))}w_g(){this.Yr.setToolbarButtonToggleState(ma.a.LiveButton,!0);this.Z1h(!1,!1);this.RIa=!0;this.$1h();this.O7e();this.Tjm();this.c2h()}v_g(){this.c2h();this.Yr.setToolbarButtonToggleState(ma.a.LiveButton,!1);this.Z1h(!1,!0);this.Yd&&this.Yd.instance&&
this.Yd.instance.oIb&&!this.xf.Jt&&(m.a.$(512495907,830,50,"Stopping subtitle for stopping live session."),this.Ad.cWa(e.AFrameworkApplication.userSessionId,this.pb.podSessionId,this.pb.Hp,e.AFrameworkApplication.Fh,5,Date.now(),this.HH));this.Yd.instance.oIb=!1;this.xf.Jt||(this.RIa=!1,this.$1h());this.O7e()}u_g(){this.Yd&&this.Yd.instance&&(this.Swa=!0,this.show(),this.vJb.style.visibility=Qa.a.xx,this.Z1h(!0,!1),this.Tjm());this.O7e()}Tjm(){this.Ea.m6g&&!this.Yd.instance.kWe()&&(this.RIa=!1,this.Yr.setToolbarButtonToggleState(ma.a.MicButton,
this.RIa),this.xf.Jt=!1,this.Yr.setToolbarButtonToggleState(ma.a.SubtitlesButton,this.xf.Jt))}qmm(){this.Z1h(!1,!1)}Z1h(kb,Xb){if(this.Yd&&this.Yd.instance){const sc=new Z;sc.menuDefinition=Xb?null:this.Yd.instance.getCalloutMenuDefinition();sc.autoOpenMenu=kb;this.Yr.updateElementProps(ma.a.LiveButton,sc);this.Yr.updateFlyoutButtonCallback(ma.a.LiveButton,!Xb)}}iun(){this.PEn.execute(Object(H.a)(this,this.hun,"initInkButton"));const kb=new Fa;kb.item="Init";this.Ad.YGk(kb);this.Yr.registerButtonCallback(ma.a.InkButton,
()=>{this.VYl()});n.a("LogSlideshowToolbarMenuOpen")&&this.VYl()}hun(kb){const Xb=new Ca;Xb.onInkMenuActivity=sc=>{this.nSn(sc)};this.L_e=kb.Thn(Xb);kb=da.create();kb.icon=this.L_e.getIcon();kb.menuDefinition=this.L_e.getControlsInMenu();kb.menuHostId="SlideshowToolbarCalloutMenuContainer";this.Yr.updateElementProps(ma.a.InkButton,kb)}VYl(){n.a("LogSlideshowToolbarMenuOpen")&&m.a.$(507590087,830,50,"ReactSlideshowToolbar.dummyOnInkButtonClickedHandler")}nSn(kb){let Xb;n.a("SlideShowInkTelemetry")&&
(Xb=performance.now());this.Ad.YGk(kb);const sc=da.create();sc.selectedColor=this.L_e.getSelectedColor();sc.icon=this.L_e.getIcon();sc.menuDefinition=this.L_e.getControlsInMenu();this.Yr.updateElementProps(ma.a.InkButton,sc);n.a("FocusLossInSlideShow")&&!this.O3e()&&this.Yr.enterFocusTrapZone();this.UWd();n.a("SlideShowInkTelemetry")&&m.a.$(507859203,830,15,JSON.stringify({timeTaken:Math.round(performance.now()-Xb),type:kb.item,color:kb.color}))}}Object(d.a)(Kb,"ReactSlideshowToolbar",null,[662,663]);
var nb=a(68);class Ka{constructor(kb,Xb){this.Po=kb;this.Tvg=document.createElement("div");this.Tvg.id="slideshowfooterContainerElement";this.Tvg.className="slideshowFooterContainer";this.la=Xb}init(){m.a.$(507843160,830,50,"SlideShowFooterContainer.Init");this.Po&&this.Po.appendChild(this.Tvg)}remove(){this.Po&&this.Po.contains(this.Tvg)&&this.Po.removeChild(this.Tvg)}Kb(){this.la.Ba(Tb.a.mjl,nb.a.application,Object(H.a)(this,this.xeo,"showFooterElements"));this.la.Ba(Tb.a.SEj,nb.a.application,Object(H.a)(this,
this.Qqn,"hideFooterElements"))}xeo(kb,Xb,sc){2===sc&&(kb=document.getElementById("slideshowfooterContainerElement"))&&(kb.style.display="flex");return 32}Qqn(kb,Xb,sc){2===sc&&(kb=document.getElementById("slideshowfooterContainerElement"))&&(kb.style.display=Qa.a.Uf);return 32}}Object(d.a)(Ka,"SlideShowFooterContainer",null,[664]);class Sb{constructor(){this.hostElement=null;this.baseZIndex=0}}Object(d.a)(Sb,"IVoiceActorSettings",null,[]);class ab{constructor(){this.xTg=this.Po=this.Iqe=null}init(){m.a.$(595198290,
830,50,"SlideShowVoiceNotification.Init");this.Iqe=document.createElement("div");this.Iqe.id="voiceNotificationContainerElement";this.Iqe.className="voiceNotificationContainer";(this.Po=document.getElementById("slideshowfooterContainerElement"))&&this.Po.insertBefore(this.Iqe,this.Po.firstChild);const kb=new Sb;kb.baseZIndex=50002;kb.hostElement=this.Iqe;this.xTg=voiceUI.VoiceActorFactory.CREATE_VOICE_ACTOR(kb)}remove(){this.Po&&this.Po.contains(this.Iqe)&&this.Po.removeChild(this.Iqe)}show(kb,Xb){this.xTg&&
this.xTg.showNotification(kb,Xb)}hide(){this.xTg&&this.xTg.hideNotification()}}Object(d.a)(ab,"SlideShowVoiceNotification",null,[521]);var ub=a(287);class Aa extends ya.a{constructor(kb,Xb){super(!1,!0);this.EQg=null;this.Kfe=this.god=0;this.wik=50001;this.W_e=null;this.Ad=kb;this.LFn=Xb;this.Ad.TSb(Object(H.a)(this,this.mKb,"onSlideshowExitHandler"));this.Ad.Cxf(Object(H.a)(this,this.cnc,"onGetCurrentPositionHandler"));this.Ad.getCurrentPosition();this.xVc=!1}get Y_h(){if(void 0===this.EQg||null===
this.EQg)this.EQg=document.getElementById("GotoDlgInput");return this.EQg}Xno(){if(!RegExp("^[0-9]+$").test(this.Y_h.value))return this.Y_h.value=this.god.toString(),!1;this.Kfe=Number.parseInvariant(this.Y_h.value);this.Kfe=Math.min(this.Kfe,this.LFn);this.Kfe=Math.max(this.Kfe,1);return!0}dispose(){super.dispose();this.EQg=null;this.xVc||this.Ad.hga()}wF(){super.wF();document.getElementById("WACDialogOverlay").style.zIndex=String(this.wik);const kb=document.getElementById("WACDialogOuterContainer");
Sys.UI.DomElement.addCssClass(kb,"SlideShowGoToDialogContainer")}X4(){super.X4();const kb=document.getElementById(this.jl("WACDialogPanel"));kb.style.minWidth=Ia.a.Zc(300);kb.style.width=Ia.a.Zc(300)}open(){m.a.$(507843218,830,50,"SlideshowGoToDialog: Open");this.Vl="<div id='GotoDlgLabelHolder'><label id='GotoDlgLabel'></label></div><input id='GotoDlgInput' type='text'/>";const kb={["GotoDlgLabel"]:ResourceStrings.l_GotoSlideLabel,["GotoDlgInput"]:this.god.toString()};this.qp(ResourceStrings.L_GoTo,
Object(H.a)(this,this.J1c,"onClickHandler"),kb);this.Ad.setVisibility(!0);this.Y_h.focus()}s2a(){super.s2a();this.W_e=Object(H.a)(this,this.tac,"onKeyDownHandler");e.AFrameworkApplication.Ha.OH.bib(O.a.oi,window.document,this.W_e,null)}O3a(){super.O3a();void 0!==this.W_e&&null!==this.W_e&&e.AFrameworkApplication.Ha.OH.rpc(O.a.oi,window.document,this.W_e);this.W_e=null}foc(){}cnc(kb,Xb){this.Ad.WDe(Object(H.a)(this,this.cnc,"onGetCurrentPositionHandler"));this.god=Xb.slideIndex+1;this.open()}mKb(){this.xVc=
!0;this.Ad.aLb(Object(H.a)(this,this.mKb,"onSlideshowExitHandler"));this.Ad.WDe(Object(H.a)(this,this.cnc,"onGetCurrentPositionHandler"));this.hide()}tac(kb){kb=kb.Pb.keyCode;return kb===ba.a.nv?(this.Xno()&&(this.Xld(this.Kfe),this.hide()),!0):kb===ba.a.ijc||kb===ba.a.AJa||kb===ba.a.u2h||kb===ba.a.bud?!0:!1}J1c(kb){1===kb&&this.Xld(this.Kfe)}Xld(kb){this.Ad.Xld(kb-1)}static zAn(kb,Xb){1>=Xb||void 0!==ub.a.zy&&null!==ub.a.zy||new Aa(kb,Xb)}}Object(d.a)(Aa,"SlideshowGoToDialog",ya.a,[]);class tb{constructor(kb,
Xb,sc,Rc,Zc,Id,Td,he,be){this.hhb=this.ga=null;this.O_e=!1;this.$gb=[];this.nod=this.Qfa=this.dwg=null;this.Ad=kb;this.Xb=Xb;this.xmc=sc;this.la=Rc;this.Oe=Zc;this.Kf=Id;this.rB=Td;this.TO=he;this.Yd=be}init(){this.ga||(this.ga=document.createElement("div"),this.ga.id="SlideshowContextMenuContainer",this.ga.className="SlideshowContextMenuContainer");this.hhb=document.createElement("div");this.hhb.className="SlideshowContextMenu cui-menu";this.hhb.tabIndex=0;const kb=document.createElement("ul");kb.className=
"SlideshowContextMenuList cui-menusection-items";const Xb=this.rB();let sc=this.cwa(ResourceStrings.L_Next,Object(H.a)(this,this.J1e,"onNextClickHandler"),Xb);Array.add(this.$gb,sc);kb.appendChild(sc);sc=this.cwa(ResourceStrings.L_Previous,Object(H.a)(this,this.M1e,"onPrevClickHandler"),Xb);Array.add(this.$gb,sc);kb.appendChild(sc);sc=this.cwa(ResourceStrings.l_GotoCell,Object(H.a)(this,this.dSn,"onGoToClickHandler"),Xb);Array.add(this.$gb,sc);kb.appendChild(sc);sc=this.cwa(ResourceStrings.L_GridView_SeeAllSlides,
Object(H.a)(this,this.I1e,"onGridViewClickHandler"),Xb);Array.add(this.$gb,sc);kb.appendChild(sc);this.TO.CTl&&(this.dwg=this.cwa(this.TO.sYa?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen,Object(H.a)(this,this.e2c,"onFullscreenClickHandler"),Xb),Array.add(this.$gb,this.dwg),kb.appendChild(this.dwg),this.TO.K4a&&!this.Qfa&&(this.Qfa=Object(H.a)(this,this.YZg,"onFullscreenChangeHandler"),$addHandler(this.Kf,this.TO.K4a,this.Qfa)));sc=this.cwa(ResourceStrings.L_EndShow,Object(H.a)(this,
this.H1e,"onExitClickHandler"),Xb);Array.add(this.$gb,sc);kb.appendChild(sc);this.Yd&&this.Yd.instance&&this.Yd.instance.FO&&(this.nod=this.cwa(ResourceStrings.l_EndLivePresentation,Object(H.a)(this,this.DRn,"onEndLivePresentationClickHandler"),Xb),Array.add(this.$gb,this.nod));this.hhb.appendChild(kb);this.ga.appendChild(this.hhb);this.Kf.appendChild(this.ga);this.xmc.addHandler(this.ga,O.a.click,Object(H.a)(this,this.J1c,"onClickHandler"));this.xmc.addHandler(this.ga,O.a.contextMenu,Object(H.a)(this,
this.Rlm,"onHostContextMenuHandler"));this.xmc.addHandler(this.hhb,O.a.jv,Object(H.a)(this,this.Rue,"onMouseOverHandler"));this.Ad.vti(Object(H.a)(this,this.N1c,"onContextMenuHandler"));this.Ad.TSb(Object(H.a)(this,this.kac,"onExitHandler"))}show(){if(this.Yd&&this.Yd.instance&&this.Yd.instance.kM&&this.nod&&!this.nod.parentNode){const kb=this.hhb.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===kb.length&&kb[0].appendChild(this.nod)}this.O_e||(this.xmc.addHandler(window.document,
O.a.oi,Object(H.a)(this,this.tac,"onKeyDownHandler")),this.xmc.addHandler(window.document,O.a.jn,Object(H.a)(this,this.jmm,"onKeyUpHandler")),this.O_e=!0);this.ga.style.visibility=Qa.a.xx}hide(){this.xmc.removeHandler(window.document,O.a.oi,Object(H.a)(this,this.tac,"onKeyDownHandler"));this.xmc.removeHandler(window.document,O.a.jn,Object(H.a)(this,this.jmm,"onKeyUpHandler"));this.O_e=!1;this.ga.style.visibility=Qa.a.ht;if(this.nod&&this.nod.parentNode){const kb=this.hhb.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");
1===kb.length&&kb[0].removeChild(this.nod)}}remove(){this.ga&&(this.xmc.removeHandler(this.ga,O.a.click,Object(H.a)(this,this.J1c,"onClickHandler")),this.xmc.removeHandler(this.ga,O.a.contextMenu,Object(H.a)(this,this.Rlm,"onHostContextMenuHandler")),this.Kf.contains(this.ga)&&this.Kf.removeChild(this.ga));this.ga=null;Array.clear(this.$gb)}kac(){this.Ad.aLb(Object(H.a)(this,this.kac,"onExitHandler"));this.Ad.YYk(Object(H.a)(this,this.N1c,"onContextMenuHandler"));this.dwg&&($removeHandler(this.Kf,
this.TO.K4a,this.Qfa),this.Qfa=null);this.remove()}J1c(kb){"SlideshowContextMenuContainer"===kb.target.id&&(this.hide(),this.Ad.hga())}N1c(kb,Xb){this.nom(Xb.clientX,Xb.clientY)}Rlm(kb){this.nom(kb.clientX,kb.clientY)}Rue(kb){(kb=kb.target)&&"li"===kb.tagName.toLowerCase()&&(this.oXk(document.activeElement),this.f6(kb))}tac(kb){const Xb=kb.keyCode,sc=kb.shiftKey;Xb===ba.a.yt||Xb===ba.a.N1?this.Wjm(!!(1^sc)):Xb===ba.a.HY&&this.Wjm(!!(0^sc));kb.preventDefault()}jmm(kb){var Xb=kb.keyCode;Xb===ba.a.nv||
Xb===ba.a.P1?(Xb=document.activeElement,Array.contains(this.$gb,Xb)&&Xb.click()):Xb===ba.a.R0&&this.Ad.exit();kb.preventDefault()}nom(kb,Xb){this.setPosition(kb,Xb);this.T0m();this.show();this.hhb.focus();this.Oe.qRk(new Xa(ResourceStrings.L_ControlMenu))}setPosition(kb,Xb){if(this.hhb){var sc=this.hhb.offsetWidth,Rc=this.hhb.offsetHeight,Zc=this.ga.clientHeight;kb+sc>this.ga.clientWidth&&(kb-=sc);Xb+Rc>Zc&&(Xb-=Rc);this.hhb.style.top=Ia.a.Zc(Xb);this.hhb.style.left=Ia.a.Zc(kb)}}cwa(kb,Xb,sc){const Rc=
document.createElement("li");Rc.className="SlideshowContextMenuItem cui-ctl-mediumlabel";Rc.innerText=kb;Rc.style.direction=sc?"rtl":"ltr";Rc.tabIndex=1;this.xmc.addHandler(Rc,O.a.click,Xb);return Rc}M1e(){m.a.$(507843392,830,50,"SlideshowContextMenu.OnPrevClickHandler");this.Ad.prev();this.hide();this.Ad.hga()}J1e(){m.a.$(507843363,830,50,"SlideshowContextMenu.OnNextClickHandler");this.Ad.next();this.hide();this.Ad.hga()}dSn(){m.a.$(507843362,830,50,"SlideshowContextMenu.OnGoToClickHandler");this.hide();
Aa.zAn(this.Ad,this.Xb.zl())}I1e(){m.a.$(507843361,830,50,"SlideshowContextMenu.OnGridViewClickHandler");this.hide();this.la.Ra(Tb.a.yJe,2,null)}e2c(){m.a.$(507843360,830,50,"SlideshowContextMenu.OnFullscreenClickHandler");this.Ad.dtl();this.hide();this.Ad.hga()}YZg(){this.dwg.innerText=this.TO.sYa?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen}H1e(){m.a.$(507843359,830,50,"SlideshowContextMenu.OnExitClickHandler");this.hide();this.Ad.exit()}DRn(){m.a.$(507843358,830,50,"SlideshowContextMenu.OnEndLivePresentationClickHandler");
this.hide();this.Ad.hga();this.Yd&&this.Yd.instance&&this.Yd.instance.kM&&this.Yd.instance.showEndSessionDialog(()=>{this.Yd.instance.ASf(4)},()=>{})}Wjm(kb){const Xb=document.activeElement,sc=Array.indexOf(this.$gb,Xb);kb=this.$gb[((-1===sc?kb?0:-1:kb?sc+1:sc-1)+this.$gb.length)%this.$gb.length];void 0!==kb&&null!==kb&&(this.oXk(Xb),this.f6(kb))}T0m(){this.$gb.forEach(kb=>{this.oXk(kb)})}f6(kb){void 0!==kb&&null!==kb&&(Sys.UI.DomElement.addCssClass(kb,"SlideshowContextMenuItemFocus"),kb.focus(),
this.Oe.qRk(new Xa(kb.innerText)))}oXk(kb){void 0!==kb&&null!==kb&&Sys.UI.DomElement.removeCssClass(kb,"SlideshowContextMenuItemFocus")}}Object(d.a)(tb,"SlideshowContextMenu",null,[663]);var kc=a(30),dc=a(366),Db=a(132),sb=a(834),Qb=a(177),$a=a(258),X=a(90);class Ta{constructor(kb,Xb,sc,Rc,Zc,Id,Td,he,be,Ue,cf,mf,ig,ug,Pf,mg,Lf,Nd,ih,Yg,Ah){this.xa=new kc.a;this.Qfa=null;this.Mmk=this.Nmk=this.CTh=this.PQg=-1;this.Tcm=this.Vcm=this.Ucm=this.X_e=null;this.Npg="";this.eUh=this.GTh=-1;this.Zfm=new Date(0);
this.Vfm="";this.Idm=null;this.Bem=this.rje=this.iRh=this.sfk=!1;this.EXc=this.HH=this.xf=null;this.vsg=-1;this.gck=this.sem=!1;this.Aee="boot";this.TO=kb;this.Ad=Xb;this.AJb=sc;this.Xb=be;this.na=Td;this.ODn=Rc;this.Jm=Zc;this.Iq=Id;this.Xr=he;this.pb=Ue;this.pT=cf;this.le=mf;this.WIa=ig;this.ud=ug;this.kUh=Pf;this.Omc=mg;this.vA=this.Xr.gN();this.eim=this.na.h3e;this.vpk=this.na.E6e;this.ud.GF(Object(H.a)(this,this.UJ,"onSessionEnd"));this.pT.Mxf(Object(H.a)(this,this.kqd,"onPodSessionUnavailable"));
this.ud.eI(Object(H.a)(this,this.qr,"onSessionRehydrated"));this.na.k2a&&(this.pT.Qjc(Object(H.a)(this,this.Hhb,"onPodSessionRefreshed")),this.pT.QFh(Object(H.a)(this,this.MVh,"onPodSessionRefreshedFromBrowser")));this.la=Lf;this.Yd=Nd;this.BTh=ih;this.Hv=Yg;this.g9b=Ah;kb=document.createElement("div");kb.id="HiddenFocusTrapAnchor";e.AFrameworkApplication.ha.getBooleanAppSetting("RegionComposerIsEnabled")||e.AFrameworkApplication.ha.getBooleanAppSetting("Fluent2StyleIsEnabled")?kb.style.position=
"absolute":kb.style.position="position: absolute";kb.style.left="-10000px";kb.style.top="auto";kb.style.width="1px";kb.style.height="1px";kb.style.overflow="hidden";kb.tabIndex=-1;this.vA.insertBefore(kb,this.vA.firstChild)}dispose(){this.ud.kaa(Object(H.a)(this,this.UJ,"onSessionEnd"));this.pT.Bum(Object(H.a)(this,this.kqd,"onPodSessionUnavailable"));this.ud.Tna(Object(H.a)(this,this.qr,"onSessionRehydrated"));this.na.k2a&&(this.pT.G7c(Object(H.a)(this,this.Hhb,"onPodSessionRefreshed")),this.pT.rZk(Object(H.a)(this,
this.MVh,"onPodSessionRefreshedFromBrowser")))}zun(kb,Xb){this.Idm=kb;this.xf=Xb;this.HH=new Ua}dPh(){return!Q.a.wb(this.Npg)}get mDi(){return this.Aee}set mDi(kb){this.Aee=kb}get Jag(){return this.rje}set Jag(kb){this.rje=kb}Aym(){this.gck=!0}o0h(kb,Xb,sc,Rc,Zc,Id,Td,he,be,Ue,cf,mf,ig){N.Health.instance.addQosPillar("Present");this.dPh()&&m.a.$(512495816,830,15,"SlideshowManager:StartFrom starting a new SlideShow while one is already running");e.AFrameworkApplication.ha.getBooleanAppSetting("PptPresenterViewEnabled")&&
(this.EXc=B.a.instance.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager"))&&this.EXc.KJb&&(this.vsg=Xb,this.la.Eb(Tb.a.btd,2,null),this.EXc.$Pl(Object(H.a)(this,this.oTn,"onPresenterViewSyncMessageReceivedHandler")));const ug=sc;this.na.EFa&&(sc=!1);this.PQg=Ue;this.CTh=Date.now();const Pf=document.createElement("div");Pf.id="startingSlideshowHiddenDiv";Pf.style.position="position: absolute";Pf.style.left="-10000px";Pf.style.top="auto";Pf.style.width="1px";Pf.style.height="1px";Pf.style.overflow=
"hidden";Pf.tabIndex=-1;Pf.setAttribute("aria-live","assertive");this.vA.insertBefore(Pf,this.vA.firstChild);Pf.innerText=ResourceStrings.l_StartingSlideShow;const mg=he+Ue.toString();this.Npg=mg;this.WIa&&this.WIa.QHe(!0);this.na.Y$l&&this.kUh&&this.kUh.QHe(!0);this.HH&&(this.HH.n7a=sc,this.HH.K6e=Xb,this.HH.slideCount=this.Xb.zl(),this.HH.wYl=this.na.xtm);this.na.FFa&&this.BTh&&this.BTh.init();this.na.FFa&&this.Hv&&this.Hv.execute(Nd=>{Nd.init()});this.na.DZ&&this.g9b&&this.g9b.execute(Nd=>{Nd.init()});
this.AJb.execute(Nd=>{Nd.init(this.xf,this.HH)});this.Ucm=this.vA.style.top;this.vA.style.top=Ia.a.Zc(0);this.na.e7a&&(this.Vcm=this.vA.style.width,this.Tcm=this.vA.style.height,this.vA.style.width="100%",this.vA.style.height="100%");this.Ad.show();this.Wam();this.na.Oll&&dc.a.Rib(!1);e.AFrameworkApplication.ha.getBooleanAppSetting("PptPresenterViewEnabled")&&this.EXc&&this.EXc.KJb&&this.Ad.Pjc(Object(H.a)(this,this.qve,"onSlideChangedHandler"));this.Ad.TSb(Object(H.a)(this,this.kac,"onExitHandler"));
this.Ad.RPl(Object(H.a)(this,this.e2c,"onFullscreenClickHandler"));this.Ad.NFh(Object(H.a)(this,this.Dnm,"onSlideshowReadyHandler"));this.Ad.NPl(Object(H.a)(this,this.G1e,"onErrorHandler"));this.Ad.OFh(Object(H.a)(this,this.xqd,"onSpecialKeyHandler"));this.Ad.Qti(Object(H.a)(this,this.Pmm,"onPodSessionExpiredHandler"));this.Ad.YPl(Object(H.a)(this,this.umm,"onLogEndOfTranscriptionSessionHandler"));this.Ad.WPl(Object(H.a)(this,this.smm,"onLiveSubtitlesDockedViewHandler"));this.Ad.wQl(Object(H.a)(this,
this.Rsm,"recordQosErrorHandler"));this.na.k2a||(this.pT.Qjc(Object(H.a)(this,this.Hhb,"onPodSessionRefreshed")),this.pT.QFh(Object(H.a)(this,this.MVh,"onPodSessionRefreshedFromBrowser")));this.lVm(Object(H.a)(this,this.FVh,"onKeydownHandler"));sc=Date.now();let Lf=!this.na.cWj||cf;Lf||(Lf=this.Jm.jlc().lN());this.sem=Lf;Ue=Date.now();m.a.$(512495815,830,50,"SlideshowManager: Outbound decision time in {0} ms, fWaitForForceOutbound is {1}, fFailOverInProgress is {2}.",Ue-sc,Lf?"True":"False",cf?"True":
"False");this.Nmk=Date.now();this.Jm.jlc().forceOutbound(()=>{m.a.$(512495814,830,50,"SlideshowManager: Will notify Replication Cache to flush unsaved revisions.");this.Jm.flush(()=>{this.Mmk=Date.now();m.a.$(512495813,830,50,"SlideshowManager: Finished flushing in {0} ms.",this.Mmk-this.Nmk);this.Npg===mg&&Lf&&(cf&&mf&&(m.a.$(512495812,830,50,"SlideshowManager: Refreshing the pod sessionId."),Zc=mf.Hp,Id=mf.podSessionId),this.sBm(kb,Xb,Rc,Zc,Id,Td,he,be,ig,ug),m.a.$(512495811,830,50,"SlideshowManager: Launched slideshow after ForceOutbound response."))},
Nd=>{m.a.$(512495810,830,10,"SlideshowManager: Failed to make Replication Cache flush unsaved revisions. {0}",Nd.ServerError);return!1})},(Nd,ih)=>{m.a.$(512495809,830,10,"SlideshowManager: Failed to force outbound. {0}",ih)},null);this.Npg!==mg||Lf||(this.sBm(kb,Xb,Rc,Zc,Id,Td,he,be,ig,ug),m.a.$(512495808,830,50,"SlideshowManager: Launched slideshow without waiting for ForceOutbound."))}sBm(kb,Xb,sc,Rc,Zc,Id,Td,he,be,Ue=!1){const cf=Db.a.create().toString();this.na.kSj&&this.EWn(sc,Zc,Td,cf);const mf=
{};mf.IsFrameNull=this.Ad?"false":"true";mf.slideshowClickTimeMs=this.PQg;void 0!==window.performance.timing&&null!==window.performance.timing&&(mf.slideshowClickTimePerformanceAPI=this.PQg-window.performance.timing.navigationStart);m.a.$(590976135,830,15,"SlideshowManager:startFromInternal - "+JSON.stringify(mf));this.Ad.o0h(kb,Xb,Rc,Zc,Id,Td,he,cf,this.PQg);0<this.eim&&(this.GTh=window.setTimeout(Object(H.a)(this,this.AUn,"onStartSlideshowTimeoutHandler"),this.eim));this.Yd&&this.Yd.instance&&this.Yd.instance.SVh(kb,
Xb,sc,Rc,Zc,Id,Td,e.AFrameworkApplication.Fh,be);this.xf&&this.xf.x9n();Ue&&(this.xf.Jt=!1)}xqd(kb,Xb){if(Xb.key===ba.a.R0)m.a.$(512495779,830,50,"SlideshowManager.OnSpecialKeyHandler Esc key"),this.AJb.execute(sc=>{sc.remove()}),m.a.$(507773725,830,50,"SlideshowManager.OnSpecialKeyHandler Toolbar remove invoked."),this.Ad.exit(),m.a.$(507773724,830,50,"SlideshowManager.OnSpecialKeyHandler Frame exit invoked.");else if(Xb.key===ba.a.Ipc)this.la.Ra(Tb.a.uth,2,null);else if(Xb.key===ba.a.LGb)this.na.getBooleanAppSetting("SlideShowToolbarEaseOfUseEnabled")&&
(m.a.$(507655364,830,50,"SlideShowManager"),32===this.la.Ra(Tb.a.tZa,2,{entryPoint:2})?this.na.EFa||(this.HH.n7a=!0):m.a.$(507655363,830,10,"SlideShowManager - Failed to start Rehearsal Session"));else if(!(Xb.key!==ba.a.wRe||Object(n.a)("altJTogglesCaptionsMenu")&&Xb.altKey)&&this.na.lJb&&this.xf&&this.xf.fGc&&this.HH&&this.Xb&&!this.HH.n7a&&this.na.ram&&this.xf.T_l)try{this.xf.Jt&&(aa.a.rX("PPTCaptionDiscoverabiltyDoNotShowAgain","true",aa.a.BU)||m.a.$(512495778,822,10,"SlideShowManager::OnSpecialKeyHandler - Failed to set cookie for discoverability opt out to true"));
this.xf.Jt=!this.xf.Jt;m.a.$(512495777,830,50,"SlideshowManager.OnSpecialKeyHandler m_subtitleContext FUseSubtitles is changed to: {0}",this.xf.Jt);const sc=document.getElementById("buttonSubtitle");if(sc){const Zc=sc.getElementsByTagName("span")[0].getElementsByTagName("img")[0];Zc&&(Zc.className=this.xf.Jt?"prt2_SubtitleSlideShowToggleHover_40x40x32":"prt2_SubtitleSlideShowToggleOff_40x40x32")}const Rc=!!this.Yd&&!!this.Yd.instance&&this.Yd.instance.kM;if(Rc)this.Ad.r1h(null);else{const Zc=Date.now();
this.Ad.cWa(e.AFrameworkApplication.userSessionId,this.pb.podSessionId,this.pb.Hp,e.AFrameworkApplication.Fh,4,Zc,this.HH)}this.AJb.execute(Zc=>{Zc.setToolbarButtonToggleState(ma.a.SubtitlesButton,this.xf.Jt);Zc.xY(ma.a.CoachButton,!this.xf.Jt&&!Rc)})}catch(sc){m.a.$(512495776,830,10,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the J key: {0}",sc)}else if(Xb.key===ba.a.cgd&&this.Yd&&this.Yd.instance&&this.Yd.instance.fGc&&this.Yd.instance.van&&this.HH&&!this.HH.n7a)try{if(this.Yd.instance.kM)this.Yd.instance.showWelcomeScreen();
else{this.Yd.instance.oIb=!this.xf.Jt;if(this.xf.SUf&&!this.xf.Jt){this.xf.Jt=!0;const sc=Date.now();this.Ad.cWa(e.AFrameworkApplication.userSessionId,this.pb.podSessionId,this.pb.Hp,e.AFrameworkApplication.Fh,5,sc,this.HH);this.xf.Jt=!1}this.Yd.instance.uph(4,e.AFrameworkApplication.userSessionId,this.na.ym,this.pb.podSessionId,e.AFrameworkApplication.Fh)}}catch(sc){m.a.$(512495775,830,10,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the L key: {0}",sc)}}oTn(kb,Xb){Xb&&(kb=
Xb.slideIndex,kb!==this.vsg&&(this.vsg=kb,this.Ad.Xld(kb)))}q3c(){m.a.$(512495774,830,15,"SlideshowManager.OnVisibilityChangeHandler: Full screen exited due to tab visibility change.");this.sfk=!0}EWn(kb,Xb,sc,Rc){m.a.$(512495773,830,50,"SlideshowManager.PauseResumeMerge. correlationId: {0}",Rc);kb=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked={2}",kb,Xb,!0);Xb={WaitForSessionTimeoutMs:"0"};Xb["X-UserSessionId"]=sc;Xb["X-CorrelationID"]=Rc;Xb["X-WacCluster"]=this.Idm;
this.Iq.ik(kb,2,null,Xb,!1,2,()=>{m.a.$(512495772,830,15,"SlideshowManager.PauseResumeMerge: Pause/resume merge succeeded. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,sc,Rc)},()=>{m.a.$(512495771,830,10,"SlideshowManager.PauseResumeMerge: Pause/resume merge failed. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,sc,Rc)},null,void 0,void 0,void 0,void 0,$a.a("14"))}TSb(kb){this.xa.addHandler("OnExitSlideshow",kb)}aLb(kb){this.xa.removeHandler("OnExitSlideshow",kb)}Pjc(kb){this.xa.addHandler("OnPositionChangeEventId",
kb)}F7c(kb){this.xa.removeHandler("OnPositionChangeEventId",kb)}lVm(kb){this.X_e||(this.X_e=kb,I.a.addHandler(window.document.body,"keydown",this.X_e))}hZk(){this.X_e&&(I.a.removeHandler(window.document.body,"keydown",this.X_e),this.X_e=null)}YZg(){if(this.TO.sYa)m.a.$(512495770,830,50,"SlideshowManager.OnFullscreenChangeHandler still in full screen");else{this.jUl();this.Ad.oZk(Object(H.a)(this,this.q3c,"onVisibilityChangeHandler"));m.a.$(512495769,830,50,"SlideshowManager.OnFullscreenChangeHandler: Leaving full screen mode.");
var kb=e.AFrameworkApplication.ha.Ma(e.AFrameworkApplication.DF);kb=!!kb&&"teams"===kb.toLowerCase();var Xb=!this.sfk&&!this.iRh&&document.hasFocus()&&!kb;m.a.$(507773723,830,50,"SlideshowManager.OnFullscreenChangeHandler: shouldExitSlideShowWhenExitFullscreen: {0}, m_fUserInitiatedFullscreenChange: {1}, isUIHostTeams: {2}, document.hasFocus(): {3} ",Xb,this.iRh,kb,document.hasFocus());Xb&&(m.a.$(512495768,830,15,"SlideshowManager.OnFullscreenChangeHandler: Exiting SlideshowFrame"),this.AJb.execute(sc=>
{sc.remove()}),m.a.$(507773722,830,50,"SlideshowManager.OnFullscreenChangeHandler: Toolbar Remove invoked"),this.Ad.exit(),m.a.$(507773721,830,50,"SlideshowManager.OnFullscreenChangeHandler: Frame exit invoked"));this.sfk=!1}this.iRh=!1}qve(kb,Xb){Xb&&this.vsg!==Xb.slideIndex&&(this.vsg=Xb.slideIndex,this.EXc.wxm(Xb))}kac(kb,Xb){var sc,Rc;m.a.$(512495767,830,15,"SlideshowManager.OnExitHandler Exiting SlideShow.");this.wUl();var Zc=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget",
"application_AssertiveNotifier"];for(var Id of Zc)(Zc=document.getElementById(Id))&&Sys.UI.DomElement.removeCssClass(Zc,"SlideShowAXItemNavigationFocusTrap");this.Npg="";this.WIa&&this.WIa.QHe(!1);this.kUh&&this.kUh.QHe(!1);this.xf&&this.xf.r8n();this.Ad.aLb(Object(H.a)(this,this.kac,"onExitHandler"));this.Ad.fum(Object(H.a)(this,this.e2c,"onFullscreenClickHandler"));this.Ad.pYh(Object(H.a)(this,this.Dnm,"onSlideshowReadyHandler"));this.Ad.cum(Object(H.a)(this,this.G1e,"onErrorHandler"));this.Ad.qYh(Object(H.a)(this,
this.xqd,"onSpecialKeyHandler"));this.Ad.oZk(Object(H.a)(this,this.q3c,"onVisibilityChangeHandler"));this.Ad.kZk(Object(H.a)(this,this.Pmm,"onPodSessionExpiredHandler"));this.Ad.num(Object(H.a)(this,this.umm,"onLogEndOfTranscriptionSessionHandler"));this.Ad.kum(Object(H.a)(this,this.smm,"onLiveSubtitlesDockedViewHandler"));this.Ad.Dum(Object(H.a)(this,this.Rsm,"recordQosErrorHandler"));this.hZk(Object(H.a)(this,this.FVh,"onKeydownHandler"));(Id=document.getElementById("startingSlideshowHiddenDiv"))&&
Id.parentNode.removeChild(Id);this.na.k2a||(this.pT.G7c(Object(H.a)(this,this.Hhb,"onPodSessionRefreshed")),this.pT.rZk(Object(H.a)(this,this.MVh,"onPodSessionRefreshedFromBrowser")));this.na.Oll&&(dc.a.Rib(!0),this.TO.sYa||sb.a.qib(e.AFrameworkApplication.isRtl));this.jUl();T.exitFullscreen();this.vA.style.top=this.Ucm;this.na.e7a&&(this.vA.style.width=this.Vcm,this.vA.style.height=this.Tcm);this.Xr.ft();this.xa.raiseEvent("OnExitSlideshow",Xb,kb);this.Yd&&this.Yd.instance&&this.Yd.instance.pUn();
this.HH&&this.HH.n7a&&Xb.summary&&this.la.Ra(Tb.a.Voc,2,Xb.summary);e.AFrameworkApplication.ha.getBooleanAppSetting("PptPresenterViewEnabled")&&this.EXc&&this.EXc.KJb&&this.la.Eb(Tb.a.tjd,2,null);this.HH&&(this.HH.n7a=!1);this.na.FFa&&this.Hv&&this.Hv.instance&&this.Hv.instance.remove();this.na.DZ&&(null===(Rc=null===(sc=this.g9b)||void 0===sc?void 0:sc.instance)||void 0===Rc?void 0:Rc.remove());this.na.FFa&&this.BTh&&this.BTh.remove();this.Pjo()}Pjo(){e.AFrameworkApplication.ha.getBooleanAppSetting(X.a.cXh)&&
B.a.instance.eb("Common.ISystemInitiatedFeedback").execute(kb=>{window.setTimeout(()=>{m.a.$(512495766,830,15,"SlideshowManager.Trigger NPS after slideshow");kb.logActivity("AppUsageTimeSatisfiedNPS",null)},1E3)})}e2c(){this.iRh=!0;this.TO.sYa?T.exitFullscreen():this.Wam()}Wam(){let kb=this.vA;this.na.DZ&&(kb=document.documentElement);kb&&this.TO.aZe&&(this.TO.K4a&&!this.Qfa&&(this.Qfa=Object(H.a)(this,this.YZg,"onFullscreenChangeHandler"),$addHandler(kb,this.TO.K4a,this.Qfa)),this.TO.requestFullscreen(kb),
this.Ad.qQl(Object(H.a)(this,this.q3c,"onVisibilityChangeHandler")))}Dnm(){this.wUl();var kb=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var Xb of kb)(kb=document.getElementById(Xb))&&Sys.UI.DomElement.addCssClass(kb,"SlideShowAXItemNavigationFocusTrap");if(-1===this.CTh)m.a.$(508924039,830,10,"SlideshowManager.onSlideshowReadyHandler returning early since slideshowStartTimeMs is -1");else{Xb=Date.now();m.a.$(23098073,830,15,
"SlideshowManager.slideshow ready in {0} ms",Xb-this.CTh);kb={};kb.SlideshowClickTimeMs=this.PQg;kb.SlideshowStartTimeMs=this.CTh;kb.SlideshowStartFlushTimeMs=this.Nmk;kb.SlideshowFinishFlushTimeMs=this.Mmk;kb.SlideShowFinishedTimeMs=Xb;kb.NoBlockingOutBoundSetting=this.na.cWj;kb.NoBlockingOutBound=!this.sem;m.a.$(512495765,830,15,"SlideshowManager.onSlideshowReadyHandler"+JSON.stringify(kb));this.AJb.execute(()=>{this.na.Zhg&&this.Ad.RWe()});!this.na.li||!this.na.yKk&&this.na.Zhg||this.ODn.init(this.xf,
this.HH);Xb=!!this.Yd&&!!this.Yd.instance&&this.Yd.instance.FO&&this.Yd.instance.Ukc;kb=!!this.Yd&&!!this.Yd.instance&&(this.Yd.instance.cGc||this.Yd.instance.kM);if((this.na.lJb||this.na.Qkg)&&this.xf&&this.HH&&this.Xb&&(this.xf.Jt||this.HH.n7a||Xb||kb)&&this.xf.T_l){const sc=Date.now();let Rc=2;e.AFrameworkApplication.Ha&&e.AFrameworkApplication.Ha.Ib.ex&&(Rc=1);const Zc=this.xf.Jt;Xb||kb?(this.xf.Jt||(Rc=5),this.Yd.instance.oIb=!this.xf.Jt,this.xf.Jt=!0):this.Yd&&this.Yd.instance&&(this.Yd.instance.oIb=
!1);this.Ad.cWa(e.AFrameworkApplication.userSessionId,this.pb.podSessionId,this.pb.Hp,e.AFrameworkApplication.Fh,Rc,sc,this.HH);this.xf.Jt=Zc}Xb&&(this.Yd.instance.Ukc=!1);this.hZk(Object(H.a)(this,this.FVh,"onKeydownHandler"));this.Ad.uEb(!1)}}FVh(kb){27===kb.keyCode&&(m.a.$(512495764,830,50,"SlideshowManager.OnKeydownHandler: Esc"),this.hZk(Object(H.a)(this,this.FVh,"onKeydownHandler")),this.AJb.execute(Xb=>{Xb.remove()}),m.a.$(507773720,830,50,"SlideshowManager.OnKeydownHandler: Esc Toolbar remove invoked."),
this.Ad.exit(),m.a.$(507773719,830,50,"SlideshowManager.OnKeydownHandler: Esc Frame exit invoked."))}umm(kb,Xb){kb={};try{const sc=A.a.KO(Xb.R4);for(const Rc of sc)try{kb[Rc]=Xb.R4[Rc]}catch(Zc){m.a.$(512495763,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when adding transcription session telemetry value for key: {0}, exception: {1}",Rc,Zc)}}catch(sc){m.a.$(512495762,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when logging transcription telemetry. Exception: {0}",
sc)}m.a.$(512495761,830,15,"SlideshowManager.onLogEndOfTranscriptionSessionHandler"+JSON.stringify(kb));try{!(this.HH&&this.HH.n7a||!this.na.jrm||this.Bem)&&kb.WebSocketConnectionDurationMS&&6E4<parseInt(kb.WebSocketConnectionDurationMS.toString())&&(m.a.$(512495760,830,50,"SlideshowManager.Floodgate survey triggered for transcription."),this.Bem=!0,this.Omc.continueWith(()=>{this.Omc.result.logActivity("TranscriptionUsed","PPTTranscriptionFloodgateSurveyEnabled")}))}catch(sc){m.a.$(512495759,830,
10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when trying to trigger floodgate survey. Exception: {0}",sc)}}smm(kb,Xb){this.na.Zhg||((kb=document.getElementById("slideshow-toolbar"))?Xb.pxo?"BelowSlide"===Xb.a5?(kb.style.bottom="15%",kb.style.left="8%"):"AboveSlide"===Xb.a5?(kb.style.bottom="6px",kb.style.left="8%"):(kb.style.left="0%",kb.style.bottom="6px",kb.style.top="auto"):(kb.style.left="0%",kb.style.bottom="6px",kb.style.top="auto"):m.a.$(512495758,830,10,"SlideshowManager.OnLiveSubtitlesDockedViewHandler: Can't find pptViewerAnchor-Met or slideshow-toolbar"))}Pmm(kb,
Xb){m.a.$(512495757,830,15,"SlideshowManager.OnPodSessionExpiredHandler ErrorCode: {0}, Reason: {1}, request PodSessionId: {2}",Xb.code,Xb.reason,Xb.podSessionId);if(Xb.podSessionId!==this.pb.podSessionId)m.a.$(512495756,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Failing request PODS ID and m_sessionInfoOwner PODS ID do not match, so will return. m_sessionInfoOwner has a newer PODS ID: {0}, and this failing request is coming from an old PODS ID: {1}.",this.pb.podSessionId,Xb.podSessionId);
else{if((kb=this.na.B6e)&&0<kb.length&&kb[0]){var sc=new Date(this.Zfm.getTime()+1E3*this.na.C6e);const Rc=new Date,Zc=Rc>sc;m.a.$(512495755,830,15,"SlideshowManager.OnPodSessionExpiredHandler: currentTime: {0} time after which rehydration is allowed: {1} canTriggerRehydration: {2}",Rc,sc,Zc);if(Zc)for(sc=0;sc<kb.length;sc++){if(kb[sc]===Xb.code.toString()&&(m.a.$(512495754,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Error from Slideshow: {0}",Xb.code),this.le.Vs(Object.assign(new Qb.a,{Code:223,
Source:4}),Xb.podSessionId),0<this.vpk)){m.a.$(512495753,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Triggered rehydration and will wait for {0} ms before calling the timeout handler.",this.vpk);this.Zfm=new Date;this.Vfm=Xb.podSessionId;this.eUh=window.setTimeout(Object(H.a)(this,this.x5n,"rehydrationTimeout"),this.vpk);return}}else if(this.Vfm===Xb.podSessionId){m.a.$(512495752,830,15,"SlideshowManager.OnPodSessionExpiredHandler: A request to rehydrate the session based on the pod session id: {0} has already been sent. Wait for rehydration to complete.",
Xb.podSessionId);return}}e.AFrameworkApplication.Ds(La.a.Ji(359));N.Health.instance.recordQosError("SlideShowPodSessionExpiredFailure",["SlideShowACE"],!1,!1,!0,!1,null);this.na.kxe&&(m.a.$(512495751,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Will exit slideshow. Error from Slideshow: {0}",Xb.code),this.AJb.execute(Rc=>{Rc.remove()}),this.Ad.exit())}}G1e(kb,Xb){kb=String.format("Category: {0}, Code: {1}, SessionId: {2}, CorrelationId: {3}, Message: {4}, ExtraInfo: {5}, IsApiError: {6}",
Xb.category,Xb.code,Xb.sessionId,Xb.correlationId,Xb.message,Xb.mE,Xb.lxo.toString());m.a.$(512495750,830,10,"SlideshowManager.OnErrorHandler: Error from Slideshow: {0}",kb);e.AFrameworkApplication.Ds(La.a.Ji(359));N.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],!1,!0,!0,!0,null);this.na.kxe&&(m.a.$(512495749,830,10,"SlideshowManager.OnErrorHandler: Will exit slideshow. Error from Slideshow: {0}",Xb.code),this.AJb.execute(sc=>{sc.remove()}),this.Ad.exit())}jUl(){let kb=this.vA;
this.na.DZ&&(kb=document.documentElement);kb&&this.Qfa&&(m.a.$(512495748,830,50,"SlideshowManager.CleanupFullscreenChangeHandler"),$removeHandler(kb,this.TO.K4a,this.Qfa),this.Qfa=null)}AUn(){m.a.$(512495747,830,15,"SlideshowManager.OnStartSlideshowTimeoutHandler");e.AFrameworkApplication.Ds(La.a.Ji(360));N.Health.instance.recordQosError("SlideShowTimeout",["SlideShowACE"],!1,!0,!0,!0,null);this.AJb.execute(kb=>{kb.remove()});m.a.$(507773718,830,50,"SlideshowManager.OnStartSlideshowTimeoutHandler: Toolbar remove invoked");
this.Ad.exit();m.a.$(507773717,830,50,"SlideshowManager.OnStartSlideshowTimeoutHandler: Frame exit invoked")}x5n(){m.a.$(512495746,830,15,"SlideshowManager.RehydrationTimeout");e.AFrameworkApplication.Ds(La.a.Ji(371));N.Health.instance.recordQosError("SlideShowWaitForRehydrationTimedOut",["SlideShowACE"],!1,!0,!0,!0,null);this.AJb.execute(kb=>{kb.remove()});this.Ad.exit()}Rsm(kb,Xb){N.Health.instance.recordQosError(Xb.errorName,[Xb.B2h],Xb.Qmd,Xb.Rmd,Xb.jRl,Xb.Ojg,0<Xb.durationMs?{durationMs:Xb.durationMs}:
null)}Hhb(kb,Xb){m.a.$(512495745,830,15,"SlideshowManager.OnPodSessionRefreshed: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.na.k2a);this.rje=!1;this.Aee="onPodSessionRefreshed";this.xUl();m.a.$(512495715,830,15,"SlideshowManager.OnPodSessionRefreshed: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",Xb.bla,this.pb.Hp);this.Ad.uah(Xb.bla,this.pb.Hp)}MVh(kb,Xb){m.a.$(512495714,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.na.k2a);this.rje=!1;this.Aee="onPodSessionRefreshedFromBrowser";this.xUl();m.a.$(512495712,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",Xb.bla,this.pb.Hp);this.Ad.uah(Xb.bla,this.pb.Hp)}qr(){this.rje=!1;this.Aee="onSessionRehydrated";m.a.$(512495711,830,15,"SlideshowManager.OnSessionRehydrated: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.na.k2a)}UJ(){this.rje=!0;this.Aee="onSessionEnd";
m.a.$(512495710,830,15,"SlideshowManager.OnSessionEnd: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.na.k2a)}kqd(){this.rje=!0;this.Aee="onPodSessionUnavailable";m.a.$(512495709,830,15,"SlideshowManager.OnPodSessionUnavailable: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.na.k2a)}wUl(){-1!==this.GTh&&(window.clearTimeout(this.GTh),this.GTh=-1)}xUl(){-1!==this.eUh&&(window.clearTimeout(this.eUh),this.eUh=-1)}}Object(d.a)(Ta,
"SlideshowManager",null,[522]);var ca=a(109);class Ma{constructor(kb,Xb,sc,Rc,Zc,Id,Td,he,be,Ue,cf){this.Amc=this.Twg=this.Mpe=this.A_e=this.ige=this.pod=this.l0e=this.x0e=this.HH=this.xf=this.Ze=null;this.oxg=0;this.Swa=!1;this.Qfa=null;this.Ad=sc;this.mf=Rc;this.qpk=Zc;this.Kf=Td;this.rB=he;this.pb=Ue;this.TO=cf;this.la=kb;this.Ea=Xb;this.ahk=null;this.BHg=be;this.Yd=Id}init(kb,Xb){this.Ze=document.createElement("div");this.Ze.id="slideshow-toolbar";this.Ze.className="SlideshowToolbar";this.Kf.appendChild(this.Ze);
this.xf=kb;this.HH=Xb;this.rB()?(this.x0e=this.Akc("buttonPrevSlide","navigationButton navigationButtonRtl","SlideShowNextServer",ResourceStrings.L_Next),this.l0e=this.Akc("buttonNextSlide","navigationButton navigationButtonRtl","SlideShowPrevServer",ResourceStrings.L_Previous)):(this.x0e=this.Akc("buttonPrevSlide","navigationButton navigationButtonLtr","SlideShowPrevServer",ResourceStrings.L_Previous),this.l0e=this.Akc("buttonNextSlide","navigationButton navigationButtonLtr","SlideShowNextServer",
ResourceStrings.L_Next));this.Ze.appendChild(this.x0e);this.Ze.appendChild(this.l0e);I.a.addHandler(this.x0e,O.a.click,Object(H.a)(this,this.M1e,"onPrevClickHandler"));I.a.addHandler(this.l0e,O.a.click,Object(H.a)(this,this.J1e,"onNextClickHandler"));this.Twg=this.Akc("buttonEnterGridView","navigationButton navigationButtonLtr","GridView",ResourceStrings.L_GridView_SeeAllSlides);this.Ze.appendChild(this.Twg);I.a.addHandler(this.Twg,O.a.click,Object(H.a)(this,this.I1e,"onGridViewClickHandler"));this.ige=
this.pod=null;this.TO.CTl&&(this.pod=this.Akc("buttonEnterFullscreen","navigationButton navigationButtonLtr","SlideShowFullscreen",ResourceStrings.L_EnterFullscreen),this.ige=this.Akc("buttonExitFullscreen","navigationButton navigationButtonLtr","SlideShowBackToWindow",ResourceStrings.L_ExitFullscreen),kb=this.TO.sYa,this.pod.style.display=kb?Qa.a.Uf:Qa.a.zn,this.ige.style.display=kb?Qa.a.zn:Qa.a.Uf,this.Ze.appendChild(this.pod),this.Ze.appendChild(this.ige),I.a.addHandler(this.pod,O.a.click,Object(H.a)(this,
this.e2c,"onFullscreenClickHandler")),I.a.addHandler(this.ige,O.a.click,Object(H.a)(this,this.e2c,"onFullscreenClickHandler")),this.TO.K4a&&!this.Qfa&&(this.Qfa=Object(H.a)(this,this.YZg,"onFullscreenChangeHandler"),$addHandler(this.Kf,this.TO.K4a,this.Qfa)));this.Mpe=null;this.xf.SUf&&!this.HH.n7a&&(this.Mpe=this.Akc("buttonSubtitle","navigationButton navigationButtonLtr","SubtitleSlideShowToggleOff",ResourceStrings.L_UseSubtitles),this.Ze.appendChild(this.Mpe),I.a.addHandler(this.Mpe,O.a.click,
Object(H.a)(this,this.UVh,"onTranscribeHandler")));this.A_e=this.Akc("buttonExitSlideShow","navigationButton navigationButtonLtr","ExitSlideShowServer",ResourceStrings.L_EndShow);this.Ze.appendChild(this.A_e);I.a.addHandler(this.A_e,O.a.click,Object(H.a)(this,this.H1e,"onExitClickHandler"));this.Amc=null;this.Yd&&this.Yd.instance&&this.Yd.instance.FO&&!this.HH.n7a&&(this.Yd.instance.eQl(Object(H.a)(this,this.w_g,"onLiveSessionStarted")),this.Yd.instance.dQl(Object(H.a)(this,this.v_g,"onLiveSessionEnded")),
this.Yd.instance.fVm(Object(H.a)(this,this.pmm,"onLiveCalloutDismissed")),this.Yd.instance.aQl(Object(H.a)(this,this.u_g,"onLiveRelaunchPausedSession")),this.Yd.instance.xVd?this.EWl():this.Yd.instance.xVm(Object(H.a)(this,this.rmm,"onLivePresenterResourcesLoaded")));this.Swa=!1;this.hide();this.Ad.TSb(Object(H.a)(this,this.kac,"onExitHandler"));this.Ad.rti(Object(H.a)(this,this.MYg,"onBrowserEventHandler"));I.a.addHandler(this.Ze,O.a.jv,Object(H.a)(this,this.Rue,"onMouseOverHandler"));I.a.addHandler(this.Ze,
O.a.hy,Object(H.a)(this,this.I_g,"onMouseOutHandler"))}show(){this.Ze.style.display=Qa.a.zn;window.clearTimeout(this.oxg);this.oxg=window.setTimeout(Object(H.a)(this,this.hide,"hide"),3E3);this.Ad.uEb(!0)}hide(){this.Swa||(window.clearTimeout(this.oxg),this.Ze.style.display=Qa.a.Uf,this.Ad.uEb(!1))}remove(){m.a.$(507773727,830,50,"SlideshowToolbar::Starting Toolbar remove.");this.Ze&&this.Kf.contains(this.Ze)&&(this.Kf.removeChild(this.Ze),this.Yd&&this.Yd.instance&&this.Yd.instance.FO&&(this.Yd.instance.sum(Object(H.a)(this,
this.w_g,"onLiveSessionStarted")),this.Yd.instance.rum(Object(H.a)(this,this.v_g,"onLiveSessionEnded")),this.Yd.instance.s6n(Object(H.a)(this,this.pmm,"onLiveCalloutDismissed")),this.Yd.instance.E6n(Object(H.a)(this,this.rmm,"onLivePresenterResourcesLoaded")),this.Yd.instance.pum(Object(H.a)(this,this.u_g,"onLiveRelaunchPausedSession"))),this.Swa=!1);m.a.$(507773726,830,50,"SlideshowToolbar::Toolbar removed.")}xY(){}setToolbarButtonToggleState(){}kac(){this.Ad.aLb(Object(H.a)(this,this.kac,"onExitHandler"));
this.Ad.WYk(Object(H.a)(this,this.MYg,"onBrowserEventHandler"));I.a.removeHandler(this.Ze,O.a.jv,Object(H.a)(this,this.Rue,"onMouseOverHandler"));I.a.removeHandler(this.Ze,O.a.hy,Object(H.a)(this,this.I_g,"onMouseOutHandler"));I.a.removeHandler(this.x0e,O.a.click,Object(H.a)(this,this.M1e,"onPrevClickHandler"));I.a.removeHandler(this.l0e,O.a.click,Object(H.a)(this,this.J1e,"onNextClickHandler"));I.a.removeHandler(this.A_e,O.a.click,Object(H.a)(this,this.H1e,"onExitClickHandler"));this.Amc&&I.a.removeHandler(this.Amc,
O.a.click,Object(H.a)(this,this.nmm,"onLiveBroadcastHandler"));this.Mpe&&I.a.removeHandler(this.Mpe,O.a.click,Object(H.a)(this,this.UVh,"onTranscribeHandler"));this.pod&&(I.a.removeHandler(this.pod,O.a.click,Object(H.a)(this,this.e2c,"onFullscreenClickHandler")),I.a.removeHandler(this.ige,O.a.click,Object(H.a)(this,this.e2c,"onFullscreenClickHandler")),$removeHandler(this.Kf,this.TO.K4a,this.Qfa),this.Qfa=null);this.Twg&&I.a.removeHandler(this.Twg,O.a.click,Object(H.a)(this,this.I1e,"onGridViewClickHandler"));
this.remove()}MYg(){this.show()}YZg(){const kb=this.TO.sYa;this.pod.style.display=kb?Qa.a.Uf:Qa.a.zn;this.ige.style.display=kb?Qa.a.zn:Qa.a.Uf}Rue(kb){if(kb=kb.target)kb.className.startsWith("prt2_SubtitleSlideShowToggle")?kb.className.startsWith("prt2_SubtitleSlideShowToggleOff_40x40x32")&&(kb.className=kb.className.replace("Off_40x40x32","Hover_40x40x32")):kb.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?kb.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle_40x40x32")&&
(kb.className=kb.className.replace("_40x40x32","Hover_40x40x32")):kb.className=kb.className.replace("_40x40x32","Hvr_40x40x32"),this.Swa=!0}I_g(kb){if(kb=kb.target)kb.className.startsWith("prt2_SubtitleSlideShowToggle")?!this.xf.Jt&&kb.className.startsWith("prt2_SubtitleSlideShowToggleHover_40x40x32")&&(kb.className=kb.className.replace("Hover_40x40x32","Off_40x40x32")):kb.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?this.Yd&&!this.Yd.instance.kM&&kb.className.startsWith("prt2_PresentLiveSlideshowToolbarToggleHover_40x40x32")&&
(kb.className=kb.className.replace("Hover_40x40x32","_40x40x32")):kb.className=kb.className.replace("Hvr_40x40x32","_40x40x32"),this.x6i()||(this.Swa=!1);this.x6i()||this.Ad.hga()}M1e(){m.a.$(508692442,830,50,"SlideshowToolbar.OnPrevClickHandler");this.Ktd(this.x0e.title);this.Ad.prev();this.Ad.hga()}J1e(){m.a.$(508692441,830,50,"SlideshowToolbar.OnNextClickHandler");this.Ktd(this.l0e.title);this.Ad.next();this.Ad.hga()}H1e(){m.a.$(508692440,830,50,"SlideshowToolbar.OnExitClickHandler");this.Ktd(this.A_e.title);
this.Ad.exit()}e2c(){m.a.$(508692439,830,50,"SlideshowToolbar.OnFullscreenClickHandler");this.Ad.dtl()}nmm(){this.Yd&&this.Yd.instance&&(this.Ktd(this.Amc.title),m.a.$(508692438,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Yd.instance.kM),this.Yd.instance.kM?this.Yd.instance.showCallout(this.Amc):(this.Yd.instance.uph(3,e.AFrameworkApplication.userSessionId,this.BHg,this.pb.podSessionId,e.AFrameworkApplication.Fh),this.Yd.instance.oIb=!this.xf.Jt,this.xf.SUf&&!this.xf.Jt&&(m.a.$(508692437,
830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.xf.Jt=!0,this.Ad.cWa(e.AFrameworkApplication.userSessionId,this.pb.podSessionId,this.pb.Hp,e.AFrameworkApplication.Fh,5,Date.now(),this.HH),this.xf.Jt=!1)),this.eAl())}ktl(kb,Xb){this.Ktd(this.Mpe.title);const sc=!!this.Yd&&!!this.Yd.instance&&this.Yd.instance.kM,Rc=this.xf.R_l&&5!==kb&&!sc;5!==kb&&(this.xf.Jt=!this.xf.Jt);m.a.$(508692436,830,50,"SlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.xf.Jt);Xb&&(this.xf.Jt?(Xb.className="prt2_SubtitleSlideShowToggleHover_40x40x32",Rc&&Oa.Vam(this.Ad,this.mf,this.pb)):Xb.className="prt2_SubtitleSlideShowToggleOff_40x40x32");Rc||(Xb=Date.now(),sc?this.Ad.r1h(null):this.Ad.cWa(e.AFrameworkApplication.userSessionId,this.pb.podSessionId,this.pb.Hp,e.AFrameworkApplication.Fh,kb,Xb,this.HH))}UVh(kb){this.ktl(3,kb.target)}I1e(){m.a.$(508692435,830,50,"SlideshowToolbar.OnGridViewClickHandler");this.la.Ra(Tb.a.yJe,2,null)}EWl(){this.Amc||(this.Amc=
this.Akc("buttonLiveBroadcast","navigationButton navigationButtonLtr","PresentLiveSlideshowToolbarToggle",ResourceStrings.L_UseLiveBroadcast),this.Ze.insertBefore(this.Amc,this.A_e),I.a.addHandler(this.Amc,O.a.click,Object(H.a)(this,this.nmm,"onLiveBroadcastHandler")))}Akc(kb,Xb,sc,Rc){const Zc=document.createElement("div");Zc.id=kb;Zc.className=Xb;if("buttonSubtitle"===kb)return kb=ca.b(40,40,"SubtitleSlideShowToggle"+(this.xf.Jt?"Hover_40x40x32":"Off_40x40x32"),"prt2",this.mf.Eq("prt2.png"),null,
null,!0,null),Zc.appendChild(kb),Zc.title=Rc,Zc;if("buttonLiveBroadcast"===kb)return kb=ca.b(40,40,"PresentLiveSlideshowToolbarToggle"+(this.Yd&&this.Yd.instance&&this.Yd.instance.kM?"Hover_40x40x32":"_40x40x32"),"prt2",this.mf.Eq("prt2.png"),null,null,!0,null),Zc.appendChild(kb),Zc.title=Rc,1===kb.children.length&&(this.ahk=kb.children[0]),Zc;kb=ca.b(40,40,sc+"_40x40x32","prt2",this.mf.Eq("prt2.png"),null,null,!0,null);Zc.appendChild(kb);Zc.title=Rc;return Zc}Ktd(kb){Q.a.wb(kb)?m.a.$(508692434,830,
15,"SlideshowToolbar::RaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.qpk.rRk(new Xa(kb))}x6i(){return!!this.Yd&&!!this.Yd.instance&&this.Yd.instance.Dan}eAl(){this.Yd&&this.Yd.instance&&this.ahk&&(this.ahk.className="prt2_PresentLiveSlideshowToolbarToggle"+(this.Yd.instance.kM?"Hover_40x40x32":"_40x40x32"))}rmm(){this.EWl()}w_g(){this.eAl()}v_g(){this.Yd&&this.Yd.instance&&this.Yd.instance.oIb&&!this.xf.Jt&&(m.a.$(508692433,830,50,"Stopping subtitle for stopping live session."),
this.Ad.cWa(e.AFrameworkApplication.userSessionId,this.pb.podSessionId,this.pb.Hp,e.AFrameworkApplication.Fh,5,Date.now(),this.HH));this.Yd.instance.oIb=!1;this.eAl()}u_g(){this.Yd&&this.Yd.instance&&(this.Swa=!0,this.show(),this.Yd.instance.showCallout(this.Amc))}pmm(){this.Swa=this.x6i();this.Swa||(window.clearTimeout(this.oxg),this.oxg=window.setTimeout(Object(H.a)(this,this.hide,"hide"),3E3))}}Object(d.a)(Ma,"SlideshowToolbar",null,[662,663]);var Ba=a(324),wa=a(15);class pa{constructor(kb){this.gUc=
this.Zwa=this.$Zc=null;this.jnk="BelowSlide";this.dhe=this.cem=!1;this.rvg=!0;this.hRh=-1;this.qem=this.evg=this.sck=!1;this.Ckk=this.nnk=this.pnk=this.onk=null;this.na=kb;e.AFrameworkApplication.ha.Wf(Object(H.a)(this,this.uu,"onFullAppSettingsReady"));kb=wa.b(e.AFrameworkApplication.ha.appSettings.SessionStartInfoJson.toString());this.Ccm=kb.Ring||"Unknown";this.Ocm=e.AFrameworkApplication.buildVersion||"Unknown";this.fgm=this.na.EAb||"Unknown";this.Kim=kb.Host||"Unknown";this.Jim=kb.WACDatacenter||
"Unknown";this.bim=this.ggn();this.ySg=this.hgn();this.Bim=this.y7f();this.E_e=pa.CCl;switch(this.na.KCm){case "ByUIHostName":kb=e.AFrameworkApplication.ha.Ma(e.AFrameworkApplication.DF);this.dhe=!(!kb||"teams"!==kb.toLowerCase());break;case "ByAppIsEmmbeded":this.dhe=e.AFrameworkApplication.XV;break;default:this.dhe=e.AFrameworkApplication.ha.getBooleanAppSetting("IsUIEmbedMode")}m.a.$(508692370,822,50,"Initialized SubtitleContext with cookie: {0}, default position:{1}",this.E_e,this.jnk)}uu(){this.$Zc=
this.getUserId();this.Zwa=e.AFrameworkApplication.ha.Ma("TenantId");this.gUc=this.na.hostAuthType||e.AFrameworkApplication.ha.Ma("HostAuthType")||"Unknown"}getUserId(){let kb=e.AFrameworkApplication.ha.Ma("PptEditingUserId");Q.a.wb(kb)&&(kb=e.AFrameworkApplication.ha.Ma("LoggableUserId"),m.a.$(508692369,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",Q.a.wb(kb)));return kb}get iWe(){return this.cem}set iWe(kb){m.a.$(508692368,830,50,"SubtitleContext: Update FEnabledInBaseDoc to {0}",
kb);this.cem=kb}get Jt(){return this.na.lJb&&this.iWe&&this.E_e&&!this.dhe}set Jt(kb){this.E_e!==kb&&(this.E_e=kb,pa.CCl=this.E_e)}get OUf(){return this.na.lJb&&this.evg}set OUf(kb){this.evg!==kb&&(this.evg=kb)}get b0l(){return this.qem}get T_l(){return!this.dhe}get nWe(){return this.sck}set nWe(kb){this.sck!==kb&&(this.sck=kb)}get SUf(){return this.na.lJb&&this.iWe&&this.na.qam&&!this.dhe}get R_l(){const kb=aa.a.get("PPTLiveSubtitleEnabled");return this.na.lJb&&this.na.sam&&Q.a.wb(kb)&&!this.dhe}get G0h(){if(!this.nnk){const Xb=
new F.a;var kb=this.na.wJk;if(!Q.a.wb(kb)){kb=kb.split(",");for(const sc of kb)sc.endsWith("*")||Xb.add(sc)}this.nnk=pa.rRl(Xb)}return this.nnk}get F0h(){if(!this.Ckk){const Xb=new F.a;var kb=this.na.wJk;if(!Q.a.wb(kb)){kb=kb.split(",");for(const sc of kb)sc.endsWith("*")&&Xb.add(sc.replace("*"," ").trim())}this.Ckk=pa.rRl(Xb)}return this.Ckk}get T6e(){this.onk||(this.onk=Q.a.wb(this.na.xJk)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(this.na.xJk,!0));return this.onk}get d0h(){this.pnk||
(this.pnk=pa.GWm(this.T6e));return this.pnk}x9n(){this.hRh=this.E_e?1:0}r8n(){-1!==this.hRh&&(this.Jt=1===this.hRh?!0:!1,this.hRh=-1)}ggn(){try{const kb=Ba.a.Le(e.AFrameworkApplication.lcid);if(!kb)return m.a.$(508692367,822,15,"SubtitleContext::GetDefaultSpeechLanguage Getting the culture info returned null. Language lcid: {0}: ",e.AFrameworkApplication.lcid),"en-us";const Xb=kb.name.toLowerCase();for(const sc of this.G0h)if(0<=sc.toLowerCase().indexOf(Xb.toLowerCase()))return Xb;for(const sc of this.F0h)if(0<=
sc.toLowerCase().indexOf(Xb.toLowerCase()))return Xb;this.evg=!0;return"en-us"}catch(kb){m.a.$(508692366,822,10,"SubtitleContext::GetDefaultSpeechLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",e.AFrameworkApplication.lcid,kb)}this.evg=!0;return"en-us"}hgn(){try{const kb=Ba.a.Le(e.AFrameworkApplication.lcid);if(!kb||Q.a.wb(kb.name))return m.a.$(508692365,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the culture info or culture info name returned null. Language lcid: {0}: ",
e.AFrameworkApplication.lcid),"en";const Xb=kb.name.toLowerCase();if(!Q.a.wb(Xb)&&this.T6e[Xb])return Xb;const sc=Ba.a.Le(kb.languageId);if(!sc||Q.a.wb(sc.name))return m.a.$(508692364,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the two-letter culture info returned null. Language lcid: {0}: ",e.AFrameworkApplication.lcid),"en";let Rc=sc.name.toLowerCase();this.T6e[Rc]||(m.a.$(508692363,822,15,"SubtitleContext::GetDefaultTranslationLanguage No matching default language was found for the user's locale. Will default to English. User's culture info name: {0} User's culture info two letter name: {1} Language lcid: {2}: ",
Xb,Rc,e.AFrameworkApplication.lcid),Rc="en");return Rc}catch(kb){m.a.$(508692362,822,10,"SubtitleContext::GetDefaultTranslationLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",e.AFrameworkApplication.lcid,kb)}return"en"}y7f(){try{if(Q.a.wb(this.ySg))return m.a.$(508692361,822,10,"SubtitleContext::GetValueForTranslationLanguage m_translationLanguages is null. Language lcid: {0}",e.AFrameworkApplication.lcid),"en-us";const kb=this.T6e[this.ySg.toLowerCase()];
if(!Q.a.wb(kb))return kb}catch(kb){m.a.$(508692360,822,10,"SubtitleContext::GetValueForTranslationLanguage Exception thrown when trying to get the value for key: {0} language lcid: {1}, exception: {2}.",this.ySg,e.AFrameworkApplication.lcid,kb)}return"en-us"}afn(kb){if(Q.a.wb(kb))return m.a.$(508692359,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Null or empty speech language code passed in."),null;var Xb=kb.split("-");if(!Xb.length)return m.a.$(508692358,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Incorrect speech language code passed in: {0}.",
kb),null;Xb=Xb[0];const sc=this.T6e;var Rc=this.d0h;for(const Zc of Rc)if(Rc=sc[Zc.toLowerCase()],Rc.startsWith(Xb))return Rc;m.a.$(508692357,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage No matching translation language code found for speech language code: {0}.",kb);return null}get Fib(){return this.bim}set Fib(kb){this.bim=kb;this.qem=!0}get userId(){return this.$Zc}set userId(kb){this.$Zc=kb}get locale(){return this.fgm}set locale(kb){this.fgm=kb}get audienceGroup(){return this.Ccm}set audienceGroup(kb){this.Ccm=
kb}get buildVersion(){return this.Ocm}set buildVersion(kb){this.Ocm=kb}get identityProvider(){return this.gUc}set identityProvider(kb){this.gUc=kb}get wacHost(){return this.Kim}set wacHost(kb){this.Kim=kb}get wacDatacenter(){return this.Jim}set wacDatacenter(kb){this.Jim=kb}get tenantId(){return this.Zwa}set tenantId(kb){this.Zwa=kb}get Rdb(){return this.ySg}set Rdb(kb){this.ySg=kb}get kpc(){return this.Bim}set kpc(kb){this.Bim=kb}get a5(){return this.jnk}set a5(kb){this.jnk=kb}get fGc(){return this.rvg}set fGc(kb){this.rvg=
kb}get Q_l(){return 0<=this.na.j3e.indexOf(this.Rdb)}static get CCl(){const kb=aa.a.get("PPTLiveSubtitleEnabled");return kb?"true"===kb.toLowerCase():!1}static set CCl(kb){aa.a.rX("PPTLiveSubtitleEnabled",kb.toString(),aa.a.BU)||m.a.$(508692356,822,10,"Failed to set cookie for use live subtitle to {0}",kb.toString())}static rRl(kb){const Xb={},sc=new F.a;for(const Rc of kb)try{const Zc=Ba.a.Le(Rc).displayName;sc.add(Zc);Xb[Zc]=Rc}catch(Zc){m.a.$(508692355,822,10,"SubtitleContext::AlphabetizeSpokenLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",
Rc,Zc)}sc.Sc((Rc,Zc)=>Rc.localeCompare(Zc));kb=new F.a;for(const Rc of sc)Rc&&0<Rc.length&&kb.add(Xb[Rc]);return kb}static GWm(kb){const Xb=A.a.KO(kb);kb={};const sc=new F.a;for(var Rc of Xb)try{const Zc=Ba.a.Le(Rc).displayName;Q.a.wb(Zc)?m.a.$(508692354,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Couldn't get display name for language code: {0}, language lcid: {1}.",Rc,e.AFrameworkApplication.lcid):(sc.add(Zc),kb[Zc]=Rc)}catch(Zc){m.a.$(508692353,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",
Rc,Zc)}sc.Sc((Zc,Id)=>Zc.localeCompare(Id));Rc=new F.a;for(const Zc of sc)Zc&&0<Zc.length&&Rc.add(kb[Zc]);return Rc}}Object(d.a)(pa,"SubtitleContext",null,[515]);var ta=a(611);class Wa{constructor(kb){this.qq=kb}vSl(){return ta.a()}}Object(d.a)(Wa,"WebGLHelperProxy",null,[514]);var Pa=a(534),ib=a(1460);class Ib{sjn(kb){return optionsButton.OptionsButtonManagerFactory.createOptionsButtonManager(kb)}}Object(d.a)(Ib,"OptionsButtonLoader",null,[523]);class hc{init(){m.a.$(508178882,830,50,"SlideShowCameraNotification.Init");
this.h_e=document.createElement("div");this.h_e.id="cameraNotificationContainerElement";this.h_e.className="cameraNotificationContainer";(this.Po=document.getElementById("slideshowfooterContainerElement"))&&this.Po.insertBefore(this.h_e,this.Po.firstElementChild);this.Zcm=cameraUI.CameraActorFactory.CREATE_CAMERA_ACTOR({hostElement:this.h_e})}remove(){var kb;(null===(kb=this.Po)||void 0===kb?0:kb.contains(this.h_e))&&this.Po.removeChild(this.h_e)}show(kb,Xb){var sc;null===(sc=this.Zcm)||void 0===
sc?void 0:sc.showNotification(kb,Xb)}hide(){var kb;null===(kb=this.Zcm)||void 0===kb?void 0:kb.hideNotification()}}Object(d.a)(hc,"SlideShowCameraNotification",null,[524]);var yc=a(595);class ob{static VZl(kb){kb.Db("PowerPointWebEditor.ISlideShowCoreHelper")||(kb.register(661,"PowerPointWebEditor.ISlideShowCoreHelper").oa().pa(()=>new ob(kb.resolve("PowerPointWebEditor.IApplicationSettings"))),m.a.$(508086165,830,50,"SlideShowCoreHelper - Registered instance in container"))}constructor(kb){this.GH=
new yc.a;kb;const Xb={},sc=this.Feg(Xb);this.U_e=ta.a()&&kb.EPc&&sc&&this.pOj(kb);this.T_e=this.oOj(kb);this.$wa=!this.U_e&&this.T_e;this.jRc({["Type"]:"CheckBrowserEnd",["IsSupportedBrowser"]:this.U_e||this.T_e,["IsModernWebGLSupportedBrowser"]:this.U_e,["IsModernSupportedBrowser"]:this.T_e,["IsBrowserShapeBuilderCompatible"]:sc,["log"]:Xb,["useSvg"]:this.$wa});if(this.U_e||this.T_e)this.$8m(kb),this.uYn(kb)}jRc(kb){m.a.$(594583632,830,15,"PPTWebEditorSlideShowPackage::logSlideShowSwitcherData "+
JSON.stringify(kb))}Feg(kb){return Pa.a(kb)}pOj(kb){const Xb=kb.Ma("PptModernSlideShowWebGLBlockListForBrowserVersion").split(";");kb=JSON.parse(kb.Ma("SessionStartInfoJson").toString());m.a.$(512309317,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernWebGLCompatible Browser:{0}, BrowserMajorVersion:{1}",kb.Browser,kb.BrowserMajorVersion);for(const sc of Xb)if(sc.split(":")[0].toLowerCase()===(kb.Browser||"").toLowerCase()&&parseInt(kb.BrowserMajorVersion||"",10)<parseInt(sc.split(":")[1],10))return m.a.$(512309316,
830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernWebGLCompatible Name {0}, Version {1}",kb.Browser,kb.BrowserMajorVersion),!1;return!0}oOj(kb){const Xb=kb.Ma("PptModernSlideShowBlockListForBrowserVersion").split(";");kb=JSON.parse(kb.Ma("SessionStartInfoJson").toString());m.a.$(512309315,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernCompatible Browser:{0}, BrowserMajorVersion:{1}",kb.Browser,kb.BrowserMajorVersion);for(const sc of Xb)if(sc.split(":")[0].toLowerCase()===(kb.Browser||"").toLowerCase()&&
parseInt(kb.BrowserMajorVersion||"",10)<parseInt(sc.split(":")[1],10))return m.a.$(512309314,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernCompatible Name {0}, Version {1}",kb.Browser,kb.BrowserMajorVersion),!1;return!0}$8m(kb){const Xb={};Xb.loadScriptStart=Date.now();const sc=v.a.create(e.AFrameworkApplication.oh("powerpoint-slideshow-strings",3));z.a.RK(sc);this.xhm=Promise.all([new Promise((Rc,Zc)=>{const Id=document.createElement("script");Id.async=!1;Id.src=e.AFrameworkApplication.oh(String.format("slideshowcore{0}.js",
".min"),5);Id.addEventListener("load",()=>{m.a.$(509636759,830,50,"PPTWebEditorSlideShowPackage::Loaded slideshowcore");Rc(Id)});Id.addEventListener("error",()=>{m.a.$(509636758,830,10,"PPTWebEditorSlideShowPackage::Failed to load slideshowcore");Zc(Id)});document.head.appendChild(Id)}),new Promise((Rc,Zc)=>{const Id=document.createElement("script");Id.async=!1;Id.src=e.AFrameworkApplication.oh(String.format("podsproxy{0}.js",".min"),5);Id.addEventListener("load",()=>{m.a.$(509636757,830,50,"PPTWebEditorSlideShowPackage::Loaded podsproxy");
Rc(Id)});Id.addEventListener("error",()=>{m.a.$(509636756,830,10,"PPTWebEditorSlideShowPackage::Failed to load podsproxy");Zc(Id)});document.head.appendChild(Id)}),new Promise((Rc,Zc)=>{const Id=document.createElement("script");Id.async=!1;Id.src=e.AFrameworkApplication.oh(String.format("pptspeechclient{0}.js",".min"),5);Id.addEventListener("load",()=>{m.a.$(509636755,830,50,"PPTWebEditorSlideShowPackage::Loaded pptspeechclient");Rc(Id)});Id.addEventListener("error",()=>{m.a.$(509636754,830,10,"PPTWebEditorSlideShowPackage::Failed to load pptspeechclient");
Zc(Id)});document.head.appendChild(Id)})]).then(()=>{Xb.loadScriptEnd=Date.now();const Rc={Type:"LoadedJS"};A.a.forEach(Xb,(Zc,Id)=>{Rc[Zc]=Id},null);this.jRc(Rc);this.cad();this.Zfc(kb);SlideShowCore.SlideShowCore.preloadShaders()}).catch(Rc=>{this.jRc({["Type"]:"Error",["Reason"]:"FailedDownloadingResources"});m.a.$(512309318,830,10,"PPTWebEditorSlideShowPackage::LoadSlideShowResources Failed to load the resources for SlideShowCore: {0}",Rc)})}uYn(kb){try{const Xb=JSON.parse(kb.Ma("Settings"))||
{};Xb.slideshowcore||(Xb.slideshowcore={});Xb.slideshowcore.forceSvg&&"true"===Xb.slideshowcore.forceSvg.toString().toLowerCase()?this.$wa=!0:this.$wa&&(Xb.slideshowcore.forceSvg="True");Xb.slideshowcore.enableCameoInPPTOSlideShow=kb.DZ.toString();this.Iy=Xb}catch(Xb){m.a.$(508086164,830,10,"SlideShowCoreHelper - Exception in parsing settings:{0}",Xb),this.Iy={}}}Zfc(kb){try{const Xb=this.Iy;if(Xb.slideshowcore){const sc={};sc.settings=Xb;sc.logger=this.GH;sc.disabledChangeGates=kb.Ma("PPTDisabledChangeGates");
window.SlideShowCore.setupGlobals_SlideShowCore(sc)}}catch(Xb){m.a.$(508086163,830,10,"SlideShowCoreHelper - Exception in passing settings to slideshowcore:{0}",Xb)}}cad(){try{const kb=this.Iy;if(kb.podsproxy){const Xb={};Xb.settings=kb;window.PodsProxy.setupGlobals_PodsProxy(Xb)}}catch(kb){m.a.$(508086162,830,10,"SlideShowCoreHelper - Exception in passing settings to podsproxy:{0}",kb)}}getSettings(){return this.Iy}faa(kb){const Xb=new XMLHttpRequest;Xb.open("GET",kb,!0);Xb.setRequestHeader("Content-Type",
"application/json; charset=utf-8");Xb.setRequestHeader("WaitForSessionTimeoutMs","0");Xb.setRequestHeader("X-UserSessionId",e.AFrameworkApplication.userSessionId);Xb.setRequestHeader("X-Correlationid",Db.a.create().toString());Xb.setRequestHeader("X-OfficeVersion",e.AFrameworkApplication.buildVersion);Xb.setRequestHeader("X-UserType",e.AFrameworkApplication.userType);Xb.setRequestHeader("X-xhr","1");return Xb}}Object(d.a)(ob,"SlideShowCoreHelper",null,[661]);var Bc=a(1704);class rb{constructor(kb,
Xb){this.convert=Bc.a;if(!kb)throw Error.argumentNull("presReader");this.Xb=kb;this.qpd=Xb;this.W5=this.Xb.qC()}Uxn(){const kb=this.Xb.qC();if(kb.height==this.W5.height&&kb.width==this.W5.width)return!0;this.Pmo(kb);return!1}Pmo(kb){this.W5.width=kb.width;this.W5.height=kb.height}T3l(kb){const Xb=this.ZK(),sc=this.Dhn();var Rc=this.Uxn();const Zc=Rc?kb.SlideEmuWidth:this.Pen();Rc=Rc?kb.SlideEmuHeight:this.Qen();if(Xb&&sc)return{SlideOrder:Xb,HiddenSlideOrder:sc,SlideEmuHeight:Zc,SlideEmuWidth:Rc,
ViewScalingFactor:kb.ViewScalingFactor,SlideShowProperties:kb.SlideShowProperties,Sections:kb.Sections}}Pen(){var kb=this.Xb.m5a();kb=this.qpd.T5f(kb);return this.convert.o0(kb.width,0)}Qen(){var kb=this.Xb.m5a();kb=this.qpd.T5f(kb);return Bc.a.o0(kb.height,1)}ZK(){return this.Xb.ZK().map(kb=>({sid:kb.sid,cid:0}))}Dhn(){return this.Xb.ZK().filter(kb=>{var Xb;return null===(Xb=this.Xb.i1(kb.sid))||void 0===Xb?void 0:Xb.Kl}).map(kb=>({sid:kb.sid,cid:0}))}}Object(d.a)(rb,"PresInfoClient",null,[]);var Eb=
a(616),jc=a(341),ea=a(291),ua=a(599),Da=a(221),Cb=a(28),Nb=a(156),fc=a(43),fb=a(141),Ub=a(250);class Ec{constructor(kb,Xb,sc,Rc){this.Qmk="BottomOverlaid";this.la=kb;this.xf=Rc;this.rc=Xb;this.Fd=sc;this.Rmk="productionSpokenLanguages_"+this.xf.Fib;this.Smk="productionSubtitleLanguages_"+this.xf.Rdb}Kb(){m.a.$(512500167,822,50,"SubtitleActor::RegisterActions - OptIn: True, FUseSubtitles:{0}",this.xf.Jt);this.la.ua(Tb.a.$hb,nb.a.application,Object(H.a)(this,this.$hb,"querySubtitleIsEnabled"),96);this.la.Ba(Tb.a.Pib,
nb.a.application,Object(H.a)(this,this.Pib,"toggleUseSubtitles"));this.la.ua(Tb.a.zrd,nb.a.application,Object(H.a)(this,this.z2n,"querySubtitleSettingsIsEnabled"),96);this.la.ua(Tb.a.wKb,nb.a.application,Object(H.a)(this,this.wKb,"populateTranscriptionSubtitleLanguage"),96);this.la.ua(Tb.a.vKb,nb.a.application,Object(H.a)(this,this.vKb,"populateTranscriptionSpokenLanguage"),96);this.la.Ba(Tb.a.GCm,nb.a.application,Object(H.a)(this,this.Wpn,"handleToggleTranscriptionSpokenLanguage"));this.la.Ba(Tb.a.HCm,
nb.a.application,Object(H.a)(this,this.Xpn,"handleToggleTranscriptionSubtitleLanguage"));this.la.ua(Tb.a.DXh,nb.a.application,Object(H.a)(this,this.DXh,"queryToggleTranscriptionSpokenLanguage"),96);this.la.ua(Tb.a.EXh,nb.a.application,Object(H.a)(this,this.EXh,"queryToggleTranscriptionSubtitleLanguage"),96);this.la.ua(Tb.a.OKb,nb.a.application,Object(H.a)(this,this.OKb,"querySubtitlesBottomOverlay"),96);this.la.Ba(Tb.a.hpc,nb.a.application,Object(H.a)(this,this.hpc,"toggleSubtitlesBottomOverlay"));
this.la.ua(Tb.a.PKb,nb.a.application,Object(H.a)(this,this.PKb,"querySubtitlesTopOverlay"),96);this.la.Ba(Tb.a.ipc,nb.a.application,Object(H.a)(this,this.ipc,"toggleSubtitlesTopOverlay"));this.la.ua(Tb.a.NKb,nb.a.application,Object(H.a)(this,this.NKb,"querySubtitlesBelowSlide"),96);this.la.Ba(Tb.a.gpc,nb.a.application,Object(H.a)(this,this.gpc,"toggleSubtitlesBelowSlide"));this.la.ua(Tb.a.MKb,nb.a.application,Object(H.a)(this,this.MKb,"querySubtitlesAboveSlide"),96);this.la.Ba(Tb.a.fpc,nb.a.application,
Object(H.a)(this,this.fpc,"toggleSubtitlesAboveSlide"))}Ae(){}$hb(kb,Xb,sc,Rc,Zc){if(!Zc||!Object(Cb.a)(fb.a,Zc))return 8;Zc.Fg(this.xf.Jt);return 32}z2n(kb,Xb,sc,Rc,Zc){return 1===sc?this.rc.zl()?32:8:Zc&&"object"===typeof Zc?this.xf&&this.xf.iWe?32:(m.a.$(512500164,822,10,"QuerySubtitleSettingsIsEnabled requires valid subtitleContext"),8):(m.a.$(512500165,822,10,"QuerySubtitleSettingsIsEnabled requires actionData"),8)}OKb(kb,Xb,sc,Rc,Zc){if(!Zc||!Object(Cb.a)(fb.a,Zc))return m.a.$(512500163,822,
10,"SubtitleActor::QuerySubtitlesBottomOverlay requires actionData"),8;Zc.Fg("BottomOverlay"===this.xf.a5);m.a.$(512500162,822,50,"SubtitleActor::QuerySubtitlesBottomOverlay: subtitles position is {0}",this.xf.a5);return 32}PKb(kb,Xb,sc,Rc,Zc){if(!Zc||!Object(Cb.a)(fb.a,Zc))return 8;Zc.Fg("TopOverlay"===this.xf.a5);m.a.$(512500160,822,50,"SubtitleActor::QuerySubtitlesTopOverlay: subtitles position is {0}",this.xf.a5);return 32}NKb(kb,Xb,sc,Rc,Zc){try{Zc&&Zc.Fg("BelowSlide"===this.xf.a5)}catch(Id){m.a.$(512500131,
822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",Id)}return 32}MKb(kb,Xb,sc,Rc,Zc){try{Zc&&Zc.Fg("AboveSlide"===this.xf.a5)}catch(Id){m.a.$(512500130,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",Id)}return 32}Pib(kb,Xb,sc,Rc,Zc){if(1===sc)return this.rc.zl()?32:8;if(!Zc||"object"!==typeof Zc)return 8;this.xf.Jt&&(aa.a.rX("PPTCaptionDiscoverabiltyDoNotShowAgain","true",aa.a.BU)||m.a.$(512500128,822,10,"SubtitleActor::ToggleUseSubtitles - Failed to set cookie for discoverability opt out to true"));
this.xf.Jt=!this.xf.Jt;m.a.$(512500127,822,50,"SubtitleActor::HandleToggleUseSubtitles: Changed UseSubtitles status to:{0}",this.xf.Jt);fc.App.Zb.CE({AlwaysUseSubtitles:"SplitButtonModel",UseSubtitles:"CheckboxModel"});return 32}wKb(kb,Xb,sc,Rc,Zc){try{if(1===sc)return 32;if(!Zc)return m.a.$(512500126,822,10,"PopulateTranscriptionSubtitleLanguage requires actionData"),8;this.aqm(Zc,!1)}catch(Id){m.a.$(512500125,822,10,"Exception in PopulateTranscriptionSubtitleLanguage: {0}.",Id)}return 32}vKb(kb,
Xb,sc,Rc,Zc){try{if(1===sc)return 32;if(!Zc)return m.a.$(512500124,822,10,"PopulateTranscriptionSpokenLanguage requires actionData"),8;this.aqm(Zc,!0)}catch(Id){m.a.$(512500123,822,10,"Exception in PopulateTranscriptionSpokenLanguage: {0}.",Id)}return 32}Xpn(kb,Xb,sc,Rc,Zc){try{if(Zc){this.xf.Rdb=Zc.MenuItemId;this.xf.kpc=this.xf.y7f();const Id=Zc.SourceControlId;this.Smk!==Id&&(kb={},kb[Id]="ToggleButtonModel",kb[this.Smk]="ToggleButtonModel",fc.App.Zb.CE(kb),this.Smk=Id)}}catch(Id){m.a.$(512500122,
822,10,"Exception in HandleToggleTranscriptionSubtitleLanguage: {0}.",Id)}return 32}EXh(kb,Xb,sc,Rc,Zc){try{Zc&&(Zc[Eb.a.On]=Zc.MenuItemId.toLowerCase()===this.xf.Rdb.toLowerCase())}catch(Id){m.a.$(512500121,822,10,"Exception in QueryToggleTranscriptionSubtitleLanguage: {0}.",Id)}return 32}Wpn(kb,Xb,sc,Rc,Zc){try{if(Zc){this.xf.Fib=Zc.MenuItemId;const Id=Zc.SourceControlId;this.Rmk!==Id&&(kb={},kb[Id]="ToggleButtonModel",kb[this.Rmk]="ToggleButtonModel",fc.App.Zb.CE(kb),this.Rmk=Id)}}catch(Id){m.a.$(512500120,
822,10,"Exception in HandleToggleTranscriptionSpokenLanguage: {0}.",Id)}return 32}DXh(kb,Xb,sc,Rc,Zc){try{Zc&&(Zc[Eb.a.On]=Zc.MenuItemId.toLowerCase()===this.xf.Fib.toLowerCase())}catch(Id){m.a.$(512500119,822,10,"Exception in QueryToggleTranscriptionSpokenLanguage: {0}.",Id)}return 32}hpc(kb,Xb,sc,Rc,Zc){if(1===sc)return 32;if(!Zc||"object"!==typeof Zc)return m.a.$(512500118,822,10,"SubtitleActor::ToggleSubtitlesBottomOverlay requires actionData"),8;Zc[Eb.a.On]&&(this.xf.a5="BottomOverlay",m.a.$(512500117,
822,50,"SubtitleActor::ToggleSubtitlesBottomOverlay: Bottom overlay is enabled"));this.j2h(Zc.SourceControlId);return 32}ipc(kb,Xb,sc,Rc,Zc){if(1===sc)return 32;if(!Zc||"object"!==typeof Zc)return m.a.$(512500116,822,10,"SubtitleActor::ToggleSubtitlesTopOverlay requires actionData"),8;Zc[Eb.a.On]&&(this.xf.a5="TopOverlay",m.a.$(512500115,822,50,"SubtitleActor::ToggleSubtitlesTopOverlay: Top overlay is enabled"));this.j2h(Zc.SourceControlId);return 32}gpc(kb,Xb,sc,Rc,Zc){if(1===sc)return 32;if(!Zc||
"object"!==typeof Zc)return m.a.$(512500114,822,10,"SubtitleActor::ToggleSubtitlesBelowSlide requires actionData"),8;Zc[Eb.a.On]&&(this.xf.a5="BelowSlide",m.a.$(512500113,822,50,"SubtitleActor::ToggleSubtitlesBelowSlide: Below Slide is enabled"));this.j2h(Zc.SourceControlId);return 32}fpc(kb,Xb,sc,Rc,Zc){if(1===sc)return 32;if(!Zc||"object"!==typeof Zc)return m.a.$(512500112,822,10,"SubtitleActor::ToggleSubtitlesAboveSlide requires actionData"),8;Zc[Eb.a.On]&&(this.xf.a5="AboveSlide",m.a.$(512500111,
822,50,"SubtitleActor::ToggleSubtitlesAboveSlide: Above Slide is enabled"));this.j2h(Zc.SourceControlId);return 32}aqm(kb,Xb){kb.MenuItems=Object.assign(new jc.a,{Id:Xb?"SpokenLanguageList":"SubtitleLanguageList",MenuSectionList:[],UpdateDynamically:!0});Xb?((Xb=this.xf.G0h)&&0<Xb.count&&(Xb=Ec.cXl(Xb,"productionSpokenLanguages",""),Array.add(kb.MenuItems.MenuSectionList,Xb)),(Xb=this.xf.F0h)&&0<Xb.count&&(Xb=Ec.cXl(Xb,"previewSpokenLanguages",ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle),
Array.add(kb.MenuItems.MenuSectionList,Xb))):(Xb=this.xf.T6e)&&0<A.a.count(Xb)&&(Xb=Ec.$5m(this.xf.d0h),Array.add(kb.MenuItems.MenuSectionList,Xb));kb.PopulationXML=Nb.l(kb.MenuItems)}j2h(kb){if(this.Qmk!==kb){const Xb={};Xb[kb]="ToggleButtonModel";Xb[this.Qmk]="ToggleButtonModel";fc.App.Zb.CE(Xb);this.Qmk=kb;this.Fd.hJ(new Ub.a(1))}}static cXl(kb,Xb,sc){sc=Object.assign(new ea.a,{DisplayMode:"Menu",Title:sc,Id:Xb,ControlsId:"ctr"+Xb,ControlList:[]});for(const Rc of kb)try{const Zc=Rc.toLowerCase(),
Id=Object.assign(new ua.a,{Id:Xb+"_"+Zc,ExternalId:Xb+"_"+Zc,LabelText:Ba.a.Le(Rc).displayName,Command:"892576938",MenuItemId:Zc,QueryCommand:"1887433262",Visible:!0,AriaLabel:Da.a.BLd});Array.add(sc.ControlList,Id)}catch(Zc){m.a.$(512500110,822,10,"SubtitleActor::CreateSpokenLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",Rc,Zc)}return sc}static $5m(kb){const Xb=Object.assign(new ea.a,{DisplayMode:"Menu",Title:"",Id:"productionSubtitleLanguages",ControlsId:"ctrproductionSubtitleLanguages",
ControlList:[]});for(const sc of kb)try{const Rc=Object.assign(new ua.a,{Id:"productionSubtitleLanguages_"+sc,ExternalId:"productionSubtitleLanguages_"+sc,LabelText:Ba.a.Le(sc).displayName,Command:"2717950896",MenuItemId:sc,QueryCommand:"4282741576",Visible:!0,AriaLabel:Da.a.BLd});Array.add(Xb.ControlList,Rc)}catch(Rc){m.a.$(512500109,822,10,"SubtitleActor::CreateSubtitleLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",sc,Rc)}return Xb}}Object(d.a)(Ec,"SubtitleActor",null,
[502]);var Lc=a(187),vb=a(237),ec=a(1225),lb=a(295),Zb=a(99),qc=a(100),pc=a(1703),ac=a(57),gb=a(107),Jb=a(1232),uc=a(52),Cc=a(51),Gc=a(55),dd=a(66);class ld{constructor(kb,Xb,sc,Rc,Zc,Id,Td,he,be,Ue,cf,mf,ig,ug,Pf,mg,Lf,Nd,ih,Yg,Ah,Bh,Kh,Mg,jg,jh,Yf){this.Ri=this.cTh=null;this.Pcm={};this.rTc=this.Fmc=null;this.i0e=0;this.Rem=!1;if(!Yf)throw Error.argumentNull("sorterViewActorLazy");this.N_=Rc;this.la=kb;this.Na=Xb;this.sa=sc;this.qf=Zc;this.mf=Id;this.jc=Td;this.ya=he;this.Xb=be;this.X9b=Ue;this.Jb=
cf;this.na=mf;this.UG=ig;this.pb=ug;this.rE=Pf;this.VJb=mg;this.Fgm=Lf;this.pA=Nd;this.Yb=ih;this.Iq=Yg;this.Ole=Ah;this.Bfm=mf.kSj;this.Fd=Bh;this.lr=Kh;this.xf=Mg;this.Yd=jg;this.PF=jh;this.Cda=Yf;this.p0m()}Kb(){this.la.Ba(Tb.a.Zoc,nb.a.application,Object(H.a)(this,this.Pgo,"startSlideShowFromBegnning"));this.la.Ba(Tb.a.F3e,nb.a.application,Object(H.a)(this,this.F3e,"present"));this.la.Ba(Tb.a.prd,nb.a.application,Object(H.a)(this,this.prd,"presentDropDown"));this.la.Ba(Tb.a.Lqd,nb.a.application,
Object(H.a)(this,this.Lqd,"playFromBeginningTopBar"));n.a("DelayRegisterStartSlideShowFromCurrentSlideCommand")&&!this.jc.Tf?(this.Ri=B.a.instance.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.Ri.WSb(Object(H.a)(this,this.ttm,"registerStartSlideShowFromCurrentSlideCommand"))):this.la.Ba(Tb.a.GZa,nb.a.application,Object(H.a)(this,this.GZa,"startSlideShowFromCurrentSlide"));this.la.Ba(Tb.a.dlc,nb.a.application,Object(H.a)(this,this.dlc,"forceClose"));this.la.Ba(Tb.a.tZa,nb.a.application,
Object(H.a)(this,this.tZa,"rehearsePresentation"));this.la.Ba(Tb.a.Jrd,nb.a.application,Object(H.a)(this,this.Jrd,"rehearsePresentationTopBar"));this.na.EFa&&(this.la.Ba(Tb.a.nSf,nb.a.application,Object(H.a)(this,this.nSf,"enableSubtitlesKeyboardShortcut")),this.la.Ba(Tb.a.jSf,nb.a.application,Object(H.a)(this,this.jSf,"enableLivePresenterKeyboardShortcut")));this.VTm();this.na.Zgg&&this.VJb.zun(this.pb.Hp,this.xf)}ttm(){this.Ri.qec(Object(H.a)(this,this.ttm,"registerStartSlideShowFromCurrentSlideCommand"));
this.la.Ba(Tb.a.GZa,nb.a.application,Object(H.a)(this,this.GZa,"startSlideShowFromCurrentSlide"))}Ae(){if(this.Jb.getBooleanAppSetting("SlideShowByShortcutEnabled")){const kb=this.Na.Uc(Lc.AFrame.Wl);Lc.AFrame.Bk(kb,vb.a.hb(ba.a.Dud,vb.a.Ne|4),Tb.a.GZa);n.a("MacSlideShowShortcutsFix")&&E.a.Jj?Lc.AFrame.Bk(kb,vb.a.hb(ba.a.nv,vb.a.Ne|4),Tb.a.Zoc):Lc.AFrame.Bk(kb,vb.a.hb(ba.a.Dud,vb.a.Ne),Tb.a.Zoc)}}QPh(kb,Xb){if(this.Pcm[kb]!=Xb){this.Pcm[kb]=Xb;let sc=this.VJb.mDi;16==Xb&&(sc="Error",this.VJb.dPh()&&
(sc="SlideShowActive"));m.a.$(507581699,822,15,"{0} {1} due to {2}",kb,32==Xb?"Enabled":"Disabled",sc)}}VTm(){this.la.Ba(Tb.a.rBb,nb.a.application,Object(H.a)(this,this.rBb,"presentLive"));this.la.Ba(Tb.a.rrd,nb.a.application,Object(H.a)(this,this.rrd,"presentLiveTopBar"));this.la.Ba(Tb.a.zcc,nb.a.application,Object(H.a)(this,this.zcc,"presentLiveSetAccessControlAnyone"));this.la.Ba(Tb.a.qrd,nb.a.application,Object(H.a)(this,this.qrd,"presentLiveSetAccessControlOrganization"));this.la.ua(Tb.a.Nnc,
nb.a.application,Object(H.a)(this,this.Nnc,"queryPresentLiveAccessControlAnyone"),96);this.la.ua(Tb.a.Onc,nb.a.application,Object(H.a)(this,this.Onc,"queryPresentLiveAccessControlOrganization"),96);B.a.instance.eb("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(kb=>{kb.JV("L_PublicLivePresentations",!0).then(Xb=>{Xb||(m.a.$(507896729,822,15,"Public Live Presentations is disabled by publiclivepresentations policy"),this.la.wY(Tb.a.zcc,uc.a.application,Object(H.a)(this,this.zcc,
"presentLiveSetAccessControlAnyone")),fc.App.Zb.vpc(Tb.a.zcc,Object(H.a)(new Jb.a,(new Jb.a).AIb,"getCommandById")));return null},Xb=>{m.a.$(507896728,822,10,"Could not get publiclivepresentations policy {0}",Xb);return null})})}LKb(kb,Xb,sc,Rc,Zc){kb=(kb=this.ya.Ia)?kb.Dh+1:0;kb=(Xb=this.Xb.zl())?String.format(ResourceStrings.l_SlideMenuButtonLabel,kb,Xb):ResourceStrings.l_Slide;Zc[ec.a.Value]=kb;Zc[lb.a.labelText]=kb;return 32}F3e(kb,Xb,sc){return this.Xgc(kb,sc,null)}prd(kb,Xb,sc){return n.a("LogSlideShowButtonTelemetry")&&
1==sc?(kb=this.Xgc(kb,sc,null),this.QPh("presentDropDown",kb),kb):this.Xgc(kb,sc,null)}Lqd(kb,Xb,sc){return n.a("LogSlideShowButtonTelemetry")&&1==sc?(kb=this.Xgc(kb,sc,null),this.QPh("playFromBeginningTopBar",kb),kb):this.Xgc(kb,sc,null)}Pgo(kb,Xb,sc){return n.a("LogSlideShowButtonTelemetry")&&1==sc?(kb=this.Xgc(kb,sc,null),this.QPh("startSlideShowFromBegnning",kb),kb):this.Xgc(kb,sc,null)}GZa(kb,Xb,sc){Xb=this.ya.Ia?this.ya.Ia.fc:null;return n.a("LogSlideShowButtonTelemetry")&&1==sc?(kb=this.Xgc(kb,
sc,Xb),this.QPh("startSlideShowFromCurrentSlide",kb),kb):this.Xgc(kb,sc,Xb)}Xgc(kb,Xb,sc,Rc=!1,Zc=!1){if(!this.na.Zgg)return this.Fgo(kb,Xb,sc);if(this.qf.Hd(this.jc.Tf)||!this.Xb.zl()||this.na.I3e&&this.VJb.dPh()||this.na.k2a&&this.VJb.Jag)return 16;if(1===Xb)return this.a6e()?32:8;this.na.iQj&&!n.a("DummyChangeGateForTest")&&m.a.$(507896727,830,100,"StartSlideShow::DummyChangeGateForTest is disabled");this.PF.hasDeferredContent()&&m.a.$(507896726,830,100,"StartSlideShow attemped with deferred content");
this.Ogo(sc,Rc,Zc);return 32}Ogo(kb,Xb,sc){var Rc,Zc=(new Date).getTime();const Id=(null===(Rc=window.performance.timing)||void 0===Rc?void 0:Rc.navigationStart)+window.performance.now();this.i0e=n.a("FixNegativeSSEUPL")?Zc:Id;m.a.$(507896725,830,15,"startSlideShow ModeSwitchtime Date.GetTime():{0}, Performance.now():{1}",Zc,Id);this.sa.nj();this.Na.Ag(dd.a.lC);this.Fd.pRk(Sys.EventArgs.Empty);m.a.$(507896724,830,15,"ViewSwitchActor.StartSlideShowFrom Should HideSlideShowButton: {0}",this.VJb.Jag);
Rc=kb?kb.sid:-1;kb=(kb=kb?Object(pc.a)(21,this.Xb.i1(kb.sid)):null)?kb.Dh+1:-1;Zc=!1;this.lr.instance?Zc=this.lr.instance.XNa?!0:!1:m.a.$(507896723,818,15,"StartSlideShowFrom: m_podSeamlessFailoverManager is null.");this.VJb.o0h(Rc,kb,Xb,this.Jb.Ma(X.a.ym),this.pb.Hp,this.pb.podSessionId,this.Jb.Ma(X.a.ZTa),e.AFrameworkApplication.userSessionId,this.na.t$l,this.i0e,Zc,this.pb,sc);this.VJb.TSb(Object(H.a)(this,this.Blm,"onExitSlideshowHandler"));this.rE.xAm()}Jrd(kb,Xb,sc,Rc){return this.tZa(kb,Xb,
sc,Rc,{entryPoint:4})}tZa(kb,Xb,sc,Rc,Zc){switch(sc){case 2:if(!this.ya.Ia)throw Error.argumentNull("ActiveSlide is null");this.na.EFa&&(Xb=0,Zc&&(Xb=Zc&&"entryPoint"in Zc?Zc.entryPoint:1),this.la.Ra(Tb.a.I6e,2,Xb),this.xf&&(this.xf.fGc=!1),this.Yd&&this.Yd.instance&&(this.Yd.instance.fGc=!1));return this.VJb.dPh()?(this.xf&&(this.xf.Jt=!1),32):this.Xgc(kb,sc,this.ya.Ia.fc,!0);case 1:if(0<this.Xb.zl())if(this.na.EFa){if(32===this.la.Eb(Tb.a.Voc,1)&&32===this.la.Eb(Tb.a.I6e,1)&&this.a6e())return 32;
break}else return this.a6e()?this.la.Eb(Tb.a.Voc,1):8;else break;default:m.a.$(507896722,822,10,"RehearsePresentation: Unimplemented action behavior")}return 8}nSf(kb,Xb,sc){switch(sc){case 2:if(this.na.EFa&&this.xf)return this.xf.fGc=!0,32;break;case 1:return this.na.EFa?32:8;default:m.a.$(507896721,822,10,"EnableSubtitlesKeyboardShortcut: Unimplemented action behavior")}return 8}jSf(kb,Xb,sc){switch(sc){case 2:if(this.na.EFa&&this.Yd&&this.Yd.instance)return this.Yd.instance.fGc=!0,32;break;case 1:return this.na.EFa?
32:8;default:m.a.$(507896720,822,10,"EnableLivePresenterKeyboardShortcut: Unimplemented action behavior")}return 8}rrd(kb,Xb,sc,Rc,Zc){return this.rBb(kb,Xb,sc,Rc,Zc)}rBb(kb,Xb,sc){if(this.Rem){try{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0))}catch(Rc){m.a.$(507896719,833,10,"SlideShowLaunchActor::PresentLive unhandled exception: {0}",Rc)}return 8}if(1===sc)return this.Yd&&this.Yd.instance&&this.Yd.instance.FO&&this.Yd.instance.xVd&&this.a6e()?0<this.Xb.zl()?
32:8:8;this.Yd&&this.Yd.instance&&this.Yd.instance.FO&&(this.Yd.instance.Ukc=!0);if(!this.ya.Ia)throw Error.argumentNull("ActiveSlide is null");return this.Xgc(kb,sc,this.ya.Ia.fc,!1,!0)}zcc(kb,Xb,sc){if(1===sc)return this.Yd&&this.Yd.instance&&this.Yd.instance.FO&&this.Yd.instance.xVd&&this.a6e()?32:8;this.Yd.instance.kM&&0!==this.Yd.instance.accessControl?this.Yd.instance.showEndSessionDialog(()=>{this.Yd.instance.ASf(5);this.Yd.instance.accessControl=0;this.Fd.hJ(new Ub.a(1))},()=>{}):(this.Yd.instance.accessControl=
0,this.Fd.hJ(new Ub.a(1)));return 32}qrd(kb,Xb,sc){if(1===sc)return this.Yd&&this.Yd.instance&&this.Yd.instance.FO&&this.Yd.instance.xVd&&this.Yd.instance.Y_l&&this.a6e()?32:8;this.Yd.instance.kM&&1!==this.Yd.instance.accessControl?this.Yd.instance.showEndSessionDialog(()=>{this.Yd.instance.ASf(5);this.Yd.instance.accessControl=1;this.Fd.hJ(new Ub.a(1))},()=>{}):(this.Yd.instance.accessControl=1,this.Fd.hJ(new Ub.a(1)));return 32}Nnc(kb,Xb,sc,Rc,Zc){try{const Id=Object(pc.a)(fb.a,Zc);Id&&this.Yd.instance&&
Id.Fg(0===this.Yd.instance.accessControl)}catch(Id){m.a.$(507896718,833,10,"SlideShowLaunchActor::QueryPresentLiveAccessControlAnyone unhandled exception: {0}",Id)}return 32}Onc(kb,Xb,sc,Rc,Zc){try{const Id=Object(pc.a)(fb.a,Zc);Id&&this.Yd.instance&&Id.Fg(1===this.Yd.instance.accessControl)}catch(Id){m.a.$(507896717,833,10,"SlideShowLaunchActor::QueryPresentLiveAccessControlOrganization unhandled exception: {0}",Id)}return 32}Fgo(kb,Xb,sc){if(this.qf.Hd(this.jc.Tf))return 16;if(1===Xb)return this.Xb.zl()?
32:16;this.i0e=(new Date).getTime();this.sa.nj();this.Na.Ag(dd.a.lC);this.Fd.pRk(Sys.EventArgs.Empty);this.UG.show(!0,kb);this.N_.jOa(!1,!0,!0,()=>{this.Hwm(sc,this.i0e)},()=>{m.a.$(507896716,818,10,"StartSlideShowFrom: ForceSave triggered failed.");this.Hwm(sc,this.i0e);return!0});return 32}Blm(kb,Xb){n.a("LogSlideShowButtonTelemetry")&&(this.VJb.mDi="ExitSlideshow");kb=((new Date).getTime()-this.i0e).toString();m.a.$(507896715,830,15,"SlideShowLaunchActor.OnExitSlideshowHandler: Exit slideshow. Duration: {0}. HasDeferredContentInFile: {1}, HasDeferredContentOnSlide: {2}",
kb,this.PF.hasDeferredContent(),Xb.slideId?this.PF.I$f(Xb.slideId.toString()):"Missing slideId");this.PF.hasDeferredContent()||Xb.slideId&&this.PF.I$f(Xb.slideId.toString())?this.PF.$La("DeferredExitSlideshowDuration",kb):this.PF.$La("ExitSlideshowDuration",kb);this.VJb.aLb(Object(H.a)(this,this.Blm,"onExitSlideshowHandler"));(this.Fmc=Xb)&&!this.Fmc.n9l&&!this.Fmc.M9l&&0<this.Fmc.slideId&&0<=this.Fmc.slideIndex&&this.EOn(this.Fmc.slideId,this.Fmc.slideIndex);this.Na.ee();this.Bfm?(this.rTc=Gc.a.Xk("ExitSlideshow"),
this.qf.blockContent(this.jc.Tf,"ExitSlideshow",!1,void 0,void 0),this.Fgm.Rm(Object(H.a)(this,this.Gmm,"onPageManifestNodePropertyChanged")),this.rTc.Za("UnlockPodsSessionStartTime",Gc.a.Pf(new Date)),this.unlockPodsSession(sc=>{this.rTc&&(this.rTc.Za("UnlockPodsSessionWithMerge",sc.toString()),this.rTc.Za("UnlockPodsSessionEndTime",Gc.a.Pf(new Date)));sc?this.pA.Y0l(null):this.J2k()})):this.J2k()}J2k(kb=null){kb&&(this.cTh=null);this.Fmc&&(this.Bfm&&(this.Fgm.rr(Object(H.a)(this,this.Gmm,"onPageManifestNodePropertyChanged")),
this.qf.BE(this.jc.Tf),this.rTc&&(this.rTc.Za("InboundPresentationEndTime",Gc.a.Pf(new Date)),this.rTc.finish(),this.rTc=null)),this.Fmc=null,this.rE.Lvm())}unlockPodsSession(kb){const Xb=Db.a.create().toString();m.a.$(507896713,830,50,"SlideShowLaunchActor.UnlockPodsSession: Unlock Pods session, correlation={0}",Xb);const sc=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked=false",e.AFrameworkApplication.ha.appSettings[X.a.ym],this.pb.podSessionId),Rc={WaitForSessionTimeoutMs:"0"};
Rc["X-UserSessionId"]=e.AFrameworkApplication.userSessionId;Rc["X-CorrelationID"]=Xb;Rc["X-WacCluster"]=this.pb.Hp;this.yxm(sc,Rc,0,kb)}yxm(kb,Xb,sc,Rc){this.Iq.ik(kb,2,null,Xb,!1,2,Zc=>{this.dlo(Zc,sc,Rc)},Zc=>{this.Kxl(Zc,kb,Xb,sc,Rc)},null,void 0,void 0,void 0,void 0,$a.a("2"))}dlo(kb,Xb,sc){if(Xb)m.a.$(507896711,830,50,"SlideShowLaunchActor.UnlockPodsSession: Succeed with retry: {0}",Xb);else{Xb=!1;try{kb.data.responseData&&0<kb.data.responseData.length&&(Xb=JSON.parse(kb.data.responseData).FMerged)}catch(Rc){m.a.$(507896712,
830,10,"SlideShowLaunchActor.UnlockPodsSession: Failed to deserialize unlock Pods session response: {0}",kb.toString())}sc(Xb)}}Kxl(kb,Xb,sc,Rc,Zc){Rc||Zc(!1);3>Rc?this.yxm(Xb,sc,Rc+1,Zc):m.a.$(507896710,830,10,"SlideShowLaunchActor.UnlockPodsSession: Failed with status code: {0}, retry count: {1}",this.Ole.WX(kb),Rc)}Gmm(kb,Xb){this.cTh||Xb.property!==Cc.a.Ilc||(this.cTh=new Zb.a(2,1,0,Object(H.a)(this,this.J2k,"resumeEditor"),90,"65"),this.Yb.Rb(this.cTh))}Hwm(kb,Xb){this.UG.hide();let sc=!0,Rc=
!1,Zc=this.mf.D6e;Zc||(Zc=qc.a.xl(window.document.URL,gb.a.nWh,gb.a.slideShowView,!0),Rc=!0);Zc=qc.a.removeParameter(Zc,gb.a.Yom);Zc=kb?qc.a.xl(Zc,gb.a.N3c,kb.sid.toString(),!0):qc.a.removeParameter(Zc,gb.a.N3c);0<Xb&&(Zc=qc.a.xl(Zc,e.AFrameworkApplication.Qpd,Xb.toString(),!0));kb=String.format("menubar=false,fullscreen=yes,scrollbars=yes,resizable=yes,left=0,top=0,width={0},height={1}",window.screen.width,window.screen.height);Xb=null;try{Xb=this.X9b.W1e(4,Zc,"SlideShowWindow",kb,Rc,!1)}catch(Id){m.a.$(507896709,
818,10,"StartSlideShowFrom: Exception throw trying to open the window. {0}",Id),sc=!1}Xb||(m.a.$(507896708,818,10,"StartSlideshowFrom:: failed to open slide show window"),sc=!1);Gc.a.Ak("Window Opened",sc.toString());Gc.a.XNe()}dlc(kb,Xb,sc){if(2!==sc)return this.la.Eb(ac.a.close,sc);kb=this.la.Eb(ac.a.close,2);32!==kb&&(m.a.$(507896707,801,50,"Close action failed to execute. Response: {0}",kb),window.location="about:blank");return 32}EOn(kb,Xb){m.a.$(507896706,830,50,"SlideShowLaunchActor.NavigateAtSlideshowExit: SlideIndex={0}",
Xb);(kb=this.Xb.i1(kb))?this.Cda.value.Z$(kb.Dh):(m.a.$(507896705,830,50,"SlideShowLaunchActor.NavigateAtSlideshowExit: SlideId does not exist.  Navigate to slide index {0}.",Xb),kb=this.Xb.zl()-1,Xb=Xb>kb?kb:Xb,0>Xb||this.Cda.value.Z$(Xb))}a6e(){return!this.VJb.Jag}p0m(){this.na.Thb&&B.a.instance.eb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(kb=>{kb.isFeatureEnabled("PowerPointLivePresentations",!1).then(Xb=>{Xb||(m.a.$(507896704,822,15," User doesn't have license for PPTLive, Hiding Present Live button"),
this.Rem=!0);return null})})}}Object(d.a)(ld,"SlideShowLaunchActor",null,[502]);var bc=a(1026),cc=a(192),Vc=a(175);class td{constructor(){this.type="CaptionDiscoverabilityTaskPaneProps";this.podiumPresentationImageUrl=null;this.enableDoNotShowAgain=!1;this.onLaunchSlideShowButtonClicked=this.onDismissButtonClicked=this.onTurnOnButtonClicked=null}}Object(d.a)(td,"CaptionDiscoverabilityTaskPaneProps",null,[]);class Xc{constructor(kb,Xb,sc,Rc,Zc,Id,Td,he,be,Ue){this.Jfm=!1;kb("powerpoint-discoverability-strings").then(()=>
{this.Jfm=!0;m.a.$(509138209,801,50,"powerpoint-discoverability-strings is loaded successfully")}).catch(cf=>{m.a.$(509138208,801,10,"Failed to load powerpoint-discoverability-strings "+cf.toString())});this.la=Xb;this.Fd=sc;this.rc=Rc;this.mf=Zc;this.fT=Id;this.xf=Td;this.UGn=be;this.M3=he;this.oFn=Ue;this.Qhm=aa.a.get("PPTCaptionDiscoverabilityLastShownTime")?!0:!1;this.Zyg=!1;this.Fd.Sjc(Object(H.a)(this,this.mab,"onRibbonTabSwitched"))}dispose(){this.Fd.ZDe(Object(H.a)(this,this.mab,"onRibbonTabSwitched"))}Kb(){this.la.Ba(Tb.a.j6e,
nb.a.application,Object(H.a)(this,this.j6e,"showCaptionDiscoverabilityPane"))}Ae(){}j6e(kb,Xb,sc){if(Xb.contextId!==nb.a.application||!this.Jfm)return 2;if(1===sc)return 32;if(Xc.FSj||Xc.h0i||!this.Fan()||!this.Ean())return 8;this.Zyg||this.l0m(kb);return 32}l0m(kb){Vc.a("CaptionDiscoverabilityPaneActor::CheckAudioAndShowPane",kb,()=>{this.Zyg=!0;this.M3.enumerateDevices(Object(H.a)(this,this.kQn,"onAudioInputAvailable"),Object(H.a)(this,this.Rzb,"onDevicesFailure"),Object(H.a)(this,this.dAb,"onUnsupported"));
return 32})}kQn(kb){if(kb.length){for(const Xb of kb)if("audioinput"===Xb.kind&&!this.UGn.Ggb()){Xc.FSj=!0;this.vo();break}this.Zyg=!1}}Rzb(kb){this.Zyg=!1;m.a.$(509138207,822,10,"CaptionDiscoverabilityPaneActor::OnDevicesFailure exception: {0}",kb.toString())}dAb(){this.Zyg=!1;m.a.$(509138206,822,15,"CaptionDiscoverabilityPaneActor::OnUnsupported mediaDevices API not available for browser: {0}",E.a.Uy)}vo(){const kb=this.jN(),Xb=Object.assign(new bc.a,{title:ResourceStrings.l_CaptionDiscoverabilityPane,
hideHeader:!1,width:320,location:2,contentProps:kb,onOpen:()=>{m.a.$(509138205,822,50,"CaptionDiscoverabilityPaneActor::ShowPane")},onClose:()=>{m.a.$(509138204,822,50,"CaptionDiscoverabilityPaneActor::ClosePane")},isModernPane:!0});this.fT.nYa(dd.a.NHb,dd.a.Wl,null,()=>{},()=>{});cc.a.Gz().then(sc=>{sc.showTaskPane(dd.a.NHb,Xb);return null}).catch(sc=>{m.a.$(509138203,822,10,"CaptionDiscoverabilityPaneActor::ShowPane exception: {0}",sc.toString())})}Tx(){cc.a.Gz().then(kb=>{kb.hideTaskPane(dd.a.NHb,
2);return null}).catch(kb=>{m.a.$(509138202,822,10,"CaptionDiscoverabilityPaneActor::HidePane exception: {0}",kb.toString())})}jN(){return Object.assign(new td,{podiumPresentationImageUrl:this.mf.Eq("CaptionDiscoverabilityPromptViewImage.png"),enableDoNotShowAgain:this.Qhm,onTurnOnButtonClicked:Object(H.a)(this,this.onTurnOnButtonClicked,"onTurnOnButtonClicked"),onDismissButtonClicked:Object(H.a)(this,this.onDismissButtonClicked,"onDismissButtonClicked"),onLaunchSlideShowButtonClicked:Object(H.a)(this,
this.onLaunchSlideShowButtonClicked,"onLaunchSlideShowButtonClicked")})}onTurnOnButtonClicked(){Vc.a("CaptionDiscoverabilityPaneTurnOn",Tb.a.Pib,()=>{let kb=8;this.xf.Jt||(kb=this.la.Ra(Tb.a.Pib,2,{}));this.oFn&&8!==kb||this.Tx();return kb})}onDismissButtonClicked(){this.Qhm&&(Xc.h0i=!0,m.a.$(509138201,822,50,"CaptionDiscoverabilityPaneActor::DoNotShowAgain"));this.Tx()}onLaunchSlideShowButtonClicked(){Vc.a("CaptionDiscoverabilityPaneLaunchSlideshow",Tb.a.Zoc,()=>{this.Tx();return this.la.Eb(Tb.a.Zoc,
2)})}mab(kb,Xb){2!==Xb.Fw&&3!==Xb.Fw&&4!==Xb.Fw||!Xb.yzb||"SlideShow"!==Xb.yzb||Vc.a("OnRibbonTabSwitched",Tb.a.j6e,()=>this.la.Eb(Tb.a.j6e,2))}Ean(){let kb=0,Xb=!1,sc=!1;for(var Rc of this.rc.rOa()){if(Rc.Kl){Xb=!0;break}if(Rc.KBa&&(kb+=Rc.BS.length,4<=kb))break;if(Rc.pPa){sc=!0;break}}Rc=sc||Xb||4<=kb;m.a.$(509138200,822,50,"CaptionDiscoverabilityPaneActor::FMeetsIntentToPresent - Result: {0}; Animation Count: {1}; Hidden slide: {2}, Transition: {3}",Rc.toString(),kb.toString(),Xb.toString(),sc.toString());
return Rc}Fan(){return!this.xf.Jt&&this.Ban()}Ban(){const kb=Ba.a.Le(e.AFrameworkApplication.lcid);return!kb||Q.a.wb(kb.name)?!1:kb.name.toLowerCase()===this.xf.Fib}static get FSj(){var kb=aa.a.get("PPTCaptionDiscoverabilityLastShownTime");if(!kb)return!1;const Xb=new Date;kb=new Date(decodeURIComponent(kb));return 14>(+Xb-+kb)/864E5}static set FSj(kb){aa.a.rX("PPTCaptionDiscoverabilityLastShownTime",(new Date).toUTCString(),aa.a.BU)||m.a.$(509138199,822,10,"Failed to set cookie for discoverability last shown time to {0}",
kb.toString())}static get h0i(){const kb=aa.a.get("PPTCaptionDiscoverabiltyDoNotShowAgain");return kb?"true"===kb.toLowerCase():!1}static set h0i(kb){aa.a.rX("PPTCaptionDiscoverabiltyDoNotShowAgain",kb.toString(),aa.a.BU)||m.a.$(509138198,822,10,"Failed to set cookie for discoverability opt out to {0}",kb.toString())}}Object(d.a)(Xc,"CaptionDiscoverabilityPaneActor",null,[502]);class ne{constructor(kb,Xb,sc,Rc){this.Sgm=Date.now();this.vkk=Date.now();this.Xmk=this.DTh=0;this.tpd=-1;this.$hm=0;this.aim=
new Set;this.Hna=!1;if(!kb)throw Error.argumentNull("appSettings");if(!Xb)throw Error.argumentNull("clientRequestManager");if(!sc)throw Error.argumentNull("presReader");if(!Rc)throw Error.argumentNull("slideShowCoreHelper");this.na=kb;this.Iq=Xb;this.Xb=sc;this.Xmk=this.na.Ac("SnapUrlUpdateAfterEditMaxCount",1);this.Ina=Rc;this.$hm=this.na.Ac("SnapUrlUpdateAfterEditWindowTime",5E3);this.aim=(this.na.getSetting("SnapUrlUpdateEligibleSlideIndexList")||"").split(",").map(Zc=>parseInt(Zc,10)).filter(Zc=>
!isNaN(Zc)).reduce((Zc,Id)=>Zc.add(Id),new Set)}get vrm(){return this.Sgm}get eXh(){return this.vkk}get urm(){return this.oB}get q5e(){return this.Hna}yvm(){this.DTh=0}oPh(kb){return kb<this.vkk}Q1h(kb,Xb){var sc,Rc,Zc;if(kb&&!(this.DTh>=this.Xmk)){for(let Id=0;Id<kb.length;Id++)if(void 0!=(null===(sc=kb[Id])||void 0===sc?void 0:sc.sid)){const Td=null===(Zc=this.Xb.i1(null===(Rc=kb[Id])||void 0===Rc?void 0:Rc.sid))||void 0===Zc?void 0:Zc.slideIndex;if(void 0!=Td&&this.aim.has(Td)){this.Mbo(Xb);return}}this.I7e()}}I7e(){-1!=
this.tpd&&void 0==this.$Qg&&(window.clearTimeout(this.tpd),m.a.$(507869148,830,15,"SnapUrlPrefetcher::tryResetSnapUrlUpdateAfterEdit: timeout cleared with TimeoutId:{0}",this.tpd),this.tpd=-1)}Mbo(kb){Object(x.b)(this,void 0,void 0,function*(){this.I7e();this.$Qg&&(yield this.$Qg);this.tpd=window.setTimeout(()=>Object(x.b)(this,void 0,void 0,function*(){this.DTh>=this.Xmk||(this.$Qg=this.d1n(kb),yield this.$Qg,this.$Qg=void 0,m.a.$(507871236,830,15,"SnapUrlPrefetcher::setSnapUrlUpdateAfterEdit: prefetched snap url for TimeoutId:{0}",
this.tpd));this.tpd=-1}),this.$hm);m.a.$(507871235,830,15,"SnapUrlPrefetcher::setSnapUrlUpdateAfterEdit: timeout set with TimeoutId:{0}",this.tpd)})}d1n(kb){return Object(x.b)(this,void 0,void 0,function*(){const Xb=new Date;m.a.$(507871233,830,15,"SnapUrlPrefetcher::prefetchSnapUrlAfterEdit: CurrentPodSessionId:{0}",kb);let sc=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.na.ym,kb);if(n.a("AddCallerQueryParam")){const Zc=this.na.getBooleanAppSetting("PPTOPresentFrontDoorEnabled");
sc+=`&caller=Slideshow&pptoPresentFrontDoorEnabled=${Zc}`}const Rc={};return new Promise((Zc,Id)=>{const Td={};Td.startTime=Xb;if(this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.UseXMLHttpRequestForSSSnap",!1)){const he=this.Ina.faa(sc);he.onreadystatechange=()=>{he.readyState===XMLHttpRequest.DONE&&(Td.correlationId=he.getResponseHeader("X-CorrelationId"),this.bJa(JSON.parse(he.response),Td),Zc())};he.onerror=()=>{Td.httpStatus=he.status;Td.correlationId=he.getResponseHeader("X-CorrelationId");
this.aJa(Td);Id()};he.send()}else Rc["Content-Type"]="application/json; charset=utf-8",Rc.WaitForSessionTimeoutMs="0",Rc["X-UserSessionId"]=e.AFrameworkApplication.userSessionId,this.Iq.ik(sc,1,"",Rc,!1,0,he=>{var be,Ue,cf,mf,ig;Td.correlationId=null===(be=null===he||void 0===he?void 0:he.data)||void 0===be?void 0:be.gj["X-CorrelationId"];Td.enqueueTime=null===(Ue=null===he||void 0===he?void 0:he.data)||void 0===Ue?void 0:Ue.Wy;Td.invokedTime=null===(cf=null===he||void 0===he?void 0:he.data)||void 0===
cf?void 0:cf.Oo;Td.completedTime=null===(mf=null===he||void 0===he?void 0:he.data)||void 0===mf?void 0:mf.Gp;this.bJa(JSON.parse(null===(ig=null===he||void 0===he?void 0:he.data)||void 0===ig?void 0:ig.responseData),Td);Zc()},he=>{var be,Ue;Td.httpStatus=null===(be=null===he||void 0===he?void 0:he.data)||void 0===be?void 0:be.Je;Td.correlationId=null===(Ue=null===he||void 0===he?void 0:he.data)||void 0===Ue?void 0:Ue.gj["X-CorrelationId"];this.aJa(Td);Id()},null,null)})})}bJa(kb,Xb){const sc=new Date;
Xb.timeTaken=+sc-+Xb.startTime;m.a.$(507871232,830,15,"SnapUrlPrefetcher::prefetchSnapUrlAfterEdit : {0}",Xb);this.oB=kb.downloadUrl;void 0!==kb.sendGetItemsRequestToPFD&&(this.Hna=kb.sendGetItemsRequestToPFD);Q.a.wb(this.oB)?m.a.$(507869411,830,10,"SnapUrlPrefetcher::prefetchSnapUrlAfterEdit: downloadUrl is null or empty : {0}",kb):(this.Sgm=Xb.startTime.getTime(),this.vkk=sc.getTime(),this.DTh++)}aJa(kb){m.a.$(507869410,830,10,"SnapUrlPrefetcher::onGettingSnappedUrlFailed : {0}",kb)}}Object(d.a)(ne,
"SnapUrlPrefetcher",null,[]);class Vd{constructor(){this.na=this.Wb=this.ga=null}get name(){return"PowerPointWebEditor.SlideShow"}oc(kb){this.ga=kb;const Xb=this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.Wb=Xb.gN();this.na=this.ga.resolve("PowerPointWebEditor.IApplicationSettings");this.ga.register(513,"PowerPointWebEditor.IFullscreenHelper").oa().pa(()=>new K);this.ga.register(514,"PowerPointWebEditor.IWebGLHelper").oa().pa(()=>new Wa(this.ga.resolve("Common.IBrowserUtils")));this.ga.register(515,
"PowerPointWebEditor.ISubtitleContext").oa().pa(()=>new pa(this.na));this.ga.register(516,"PowerPointWebEditor.IRehearsalContext").oa().pa(()=>new Ua);this.na.getBooleanAppSetting("SlideShowGetPresInfoFromClient")&&this.ga.register(517,"PowerPointWebEditor.PresInfoClient").oa().pa(()=>new rb(this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("PowerPointWebEditor.ISlideDimensionsHelper")));this.jRc({["Type"]:"CheckBrowserStart"});let sc;if(this.na.isAnimationPreviewEnabled){ob.VZl(this.ga);
var Rc=this.ga.resolve("PowerPointWebEditor.ISlideShowCoreHelper");kb=Rc.U_e||Rc.T_e;sc=Rc.$wa}else{kb={};Rc=this.Feg(kb);const be=ta.a()&&this.na.EPc&&Rc&&this.pOj(),Ue=this.oOj();sc=!be&&Ue;this.jRc({["Type"]:"CheckBrowserEnd",["IsSupportedBrowser"]:be||Ue,["IsModernWebGLSupportedBrowser"]:be,["IsModernSupportedBrowser"]:Ue,["IsBrowserShapeBuilderCompatible"]:Rc,["log"]:kb,["useSvg"]:sc});kb=be||Ue}if(kb){var Zc=this.na.getBooleanAppSetting("SnapUrlUpdateAfterEditEnabled");Zc&&this.ga.register(518,
"PowerPointWebEditor.SnapUrlPrefetcher").oa().pa(()=>new ne(this.na,e.AFrameworkApplication.$d,this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("PowerPointWebEditor.ISlideShowCoreHelper")));this.ga.register(519,"PowerPointWebEditor.ISlideshowFrame").oa().pa(()=>new ib.a(this.Wb,this.na,this.ga.resolve("PowerPointWebEditor.ISubtitleContext"),this.ga.resolve("Common.IDynamicScriptLoaderProvider").SU,this.ga.eb("PowerPointWebEditor.ISlideShowVoiceNotification"),this.ga.eb("PowerPointLive.ILivePresenter"),
this.ga.resolve("PowerPointWebEditor.IFullscreenHelper"),this.ga.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),sc,this.ga.resolve("PowerPoint.IPathManager"),this.ga.eb("Common.App.HostNotification.EditNotificationEventSource"),this.ga.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,e.AFrameworkApplication.$d,this.ga.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"),
this.na.getBooleanAppSetting("SlideShowGetPresInfoFromClient")?this.ga.resolve("PowerPointWebEditor.PresInfoClient"):null,this.ga.eb("PowerPointWebEditor.ISlideShowCameraNotification"),this.na.isAnimationPreviewEnabled?this.ga.resolve("PowerPointWebEditor.ISlideShowCoreHelper"):null,this.na.getBooleanAppSetting("IsSnapUrlFetchedEarlyOnBootEnabled")?this.ga.resolve("PowerPointWebEditor.SlideShowSnapUrlGenerator"):void 0,Zc?this.ga.resolve("PowerPointWebEditor.SnapUrlPrefetcher"):void 0));if(this.na.isAnimationPreviewEnabled)this.ga.resolve("PowerPointWebEditor.ISlideShowCoreHelper").xhm.then(()=>
{this.ga.resolve("PowerPointWebEditor.ISlideshowManager").gck||(m.a.$(509636753,830,50,"PPTWebEditorSlideShowPackage::Initializing SlideShowCoreFrame on package registration"),this.ga.resolve("PowerPointWebEditor.ISlideshowFrame").init(e.AFrameworkApplication.buildVersion,this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner").Hp,e.AFrameworkApplication.userSessionId,this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId),this.ga.resolve("PowerPointWebEditor.ISlideshowManager").Aym());
return null});else{const be={};be.loadScriptStart=Date.now();kb=v.a.create(e.AFrameworkApplication.oh("powerpoint-slideshow-strings",3));z.a.RK(kb);Promise.all([new Promise((Ue,cf)=>{const mf=document.createElement("script");mf.async=!1;mf.src=e.AFrameworkApplication.oh(String.format("slideshowcore{0}.js",".min"),5);mf.addEventListener("load",()=>{m.a.$(509636759,830,50,"PPTWebEditorSlideShowPackage::Loaded slideshowcore");Ue(mf)});mf.addEventListener("error",()=>{m.a.$(509636758,830,10,"PPTWebEditorSlideShowPackage::Failed to load slideshowcore");
cf(mf)});document.head.appendChild(mf)}),new Promise((Ue,cf)=>{const mf=document.createElement("script");mf.async=!1;mf.src=e.AFrameworkApplication.oh(String.format("podsproxy{0}.js",".min"),5);mf.addEventListener("load",()=>{m.a.$(509636757,830,50,"PPTWebEditorSlideShowPackage::Loaded podsproxy");Ue(mf)});mf.addEventListener("error",()=>{m.a.$(509636756,830,10,"PPTWebEditorSlideShowPackage::Failed to load podsproxy");cf(mf)});document.head.appendChild(mf)}),new Promise((Ue,cf)=>{const mf=document.createElement("script");
mf.async=!1;mf.src=e.AFrameworkApplication.oh(String.format("pptspeechclient{0}.js",".min"),5);mf.addEventListener("load",()=>{m.a.$(509636755,830,50,"PPTWebEditorSlideShowPackage::Loaded pptspeechclient");Ue(mf)});mf.addEventListener("error",()=>{m.a.$(509636754,830,10,"PPTWebEditorSlideShowPackage::Failed to load pptspeechclient");cf(mf)});document.head.appendChild(mf)})]).then(()=>{be.loadScriptEnd=Date.now();const Ue={Type:"LoadedJS"};A.a.forEach(be,(cf,mf)=>{Ue[cf]=mf},null);this.jRc(Ue);this.ga.resolve("PowerPointWebEditor.ISlideshowManager").gck||
(m.a.$(508086156,830,50,"PPTWebEditorSlideShowPackage::Initializing SlideShowCoreFrame on package registration"),this.ga.resolve("PowerPointWebEditor.ISlideshowFrame").preloadShaders(),this.ga.resolve("PowerPointWebEditor.ISlideshowFrame").init(e.AFrameworkApplication.buildVersion,this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner").Hp,e.AFrameworkApplication.userSessionId,this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId),this.ga.resolve("PowerPointWebEditor.ISlideshowManager").Aym());
return null}).catch(Ue=>{this.jRc({["Type"]:"Error",["Reason"]:"FailedDownloadingResources"});m.a.$(512309318,830,10,"PPTWebEditorSlideShowPackage::LoadSlideShowResources Failed to load the resources for SlideShowCore: {0}",Ue)})}this.ga.register(Ka,"PowerPointWebEditor.SlideShowFooterContainer").pa(()=>new Ka(this.Wb,e.AFrameworkApplication.ub));this.ga.resolve("PowerPointWebEditor.SlideShowFooterContainer").Kb();if(!this.na.Zhg||this.na.yKk)this.ga.register(Ma,"PowerPointWebEditor.SlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").oa().pa(()=>
new Ma(e.AFrameworkApplication.ub,this.na,this.ga.resolve("PowerPointWebEditor.ISlideshowFrame"),this.ga.resolve("PowerPoint.IPathManager"),this.ga.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.ga.eb("PowerPointLive.ILivePresenter"),this.Wb,()=>e.AFrameworkApplication.isRtl,this.na.ym,this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.ga.resolve("PowerPointWebEditor.IFullscreenHelper"))),this.ga.resolve("PowerPointWebEditor.ISlideshowToolbar");else{kb=u.a(this.ga);Rc=new F.a;
Rc.add(kb("slideshowToolbar"));this.na.arm&&Rc.add(kb("uiFabricLazy"));Promise.all(Rc.toArray()).catch(Ue=>m.a.$(50907106,830,10,"PPTWebEditorSlideShowPackage::Failed to load the resources for the slideshowToolbar feature: {0}",Ue)).then(()=>this.vUn()).catch(Ue=>m.a.$(50907136,830,10,"PPTWebEditorSlideShowPackage::Failed to load the React slideshowToolbar: {0}",Ue));this.na.t$d&&(kb("inkButton").catch(Ue=>m.a.$(51218050,830,10,"PPTWebEditorSlideShowPackage::Failed to load the resources for the ink button feature: {0}",
Ue)).then(()=>this.oSn()).catch(Ue=>m.a.$(51218052,830,10,"PPTWebEditorSlideShowPackage::Failed to load the React ink button: {0}",Ue)),this.ga.register(520,"PowerPointWebEditor.IInkButtonHelper").oa().pa(()=>new M));Rc=this.na.getBooleanAppSetting("SlideShowToolbarEaseOfUseEnabled");(this.na.DZ||Rc)&&this.hBn(kb);if(this.na.FFa){const Ue=this;kb("voiceUI").catch(cf=>m.a.$(595198419,830,10,"PPTWebEditorSlideShowPackage::Failed to load the resources for the voice UI feature: {0}",cf)).then(()=>Ue.wUn()).catch(cf=>
m.a.$(595198417,830,10,"PPTWebEditorSlideShowPackage::Failed to load the voice UI script: {0}",cf));this.ga.register(521,"PowerPointWebEditor.ISlideShowVoiceNotification").oa().pa(()=>new ab)}this.na.DZ&&this.VAn(kb);const be=this;this.ga.register(Kb,"PowerPointWebEditor.ReactSlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").oa().pa(()=>new Kb(e.AFrameworkApplication.ub,be.na,be.ga.resolve("PowerPointWebEditor.ISlideshowFrame"),be.ga.resolve("PowerPoint.IPathManager"),be.ga.resolve("PowerPointWebEditor.View.IViewEventNotifier"),
be.ga.eb("PowerPointLive.ILivePresenter"),be.Wb,()=>e.AFrameworkApplication.isRtl,be.na.ym,be.ga.resolve("PowerPointWebEditor.ISessionInfoOwner"),be.ga.resolve("PowerPointWebEditor.IFullscreenHelper")))}var Id=this.ga.eb("PowerPointWebEditor.ISlideshowToolbar");var Td=this;this.ga.register(tb,"PowerPointWebEditor.SlideshowContextMenu").pa(()=>new tb(Td.ga.resolve("PowerPointWebEditor.ISlideshowFrame"),Td.ga.resolve("PowerPointWebEditor.IPresentationReader"),Td.ga.resolve("PowerPointWebEditor.IInputHandlerManager"),
e.AFrameworkApplication.ub,Td.ga.resolve("PowerPointWebEditor.View.IViewEventNotifier"),Td.Wb,()=>e.AFrameworkApplication.isRtl,Td.ga.resolve("PowerPointWebEditor.IFullscreenHelper"),Td.ga.eb("PowerPointLive.ILivePresenter")));var he=this;this.ga.register(522,"PowerPointWebEditor.ISlideshowManager").oa().pa(()=>new Ta(he.ga.resolve("PowerPointWebEditor.IFullscreenHelper"),he.ga.resolve("PowerPointWebEditor.ISlideshowFrame"),Id,he.ga.resolve("PowerPointWebEditor.SlideshowContextMenu"),he.ga.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
e.AFrameworkApplication.$d,he.na,Xb,he.ga.resolve("PowerPointWebEditor.IPresentationReader"),he.ga.resolve("PowerPointWebEditor.ISessionInfoOwner"),he.ga.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),he.ga.resolve("PowerPointWebEditor.IErrorHandler"),B.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),he.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),he.ga.resolve("PowerPointWebEditor.IZoomContentFetcher"),G.a.kH(B.a.instance.eb("Common.ISystemInitiatedFeedback")),
e.AFrameworkApplication.ub,B.a.instance.eb("PowerPointLive.ILivePresenter"),he.ga.resolve("PowerPointWebEditor.SlideShowFooterContainer"),he.ga.eb("PowerPointWebEditor.ISlideShowVoiceNotification"),he.ga.eb("PowerPointWebEditor.ISlideShowCameraNotification")))}else this.jRc({["Type"]:"Error",["Reason"]:"UnSupportedBrowser"}),this.ga.resolve("PowerPointWebEditor.ISlideshowManager").Jag=!0}hBn(kb){kb("optionsButton").catch(Xb=>m.a.$(508912669,830,10,"Failed to load the resources for the options menu button feature: {0}",
Xb)).then(()=>this.TSn()).catch(Xb=>m.a.$(508912668,830,10,"Failed to load the React options menu button: {0}",Xb));this.ga.register(523,"PowerPointWebEditor.IOptionsButtonLoader").oa().pa(()=>new Ib)}VAn(kb){Object(x.b)(this,void 0,void 0,function*(){try{yield kb("cameraUI"),this.ga.register(524,"PowerPointWebEditor.ISlideShowCameraNotification").oa().pa(()=>new hc),this.tUn()}catch(Xb){m.a.$(508178881,830,10,`PPTWebEditorSlideShowPackage::Failed to load the resources for the camera UI feature: ${Xb}`)}})}jRc(kb){m.a.$(594583632,
830,15,"PPTWebEditorSlideShowPackage::logSlideShowSwitcherData "+JSON.stringify(kb))}pOj(){const kb=this.na.Ma("PptModernSlideShowWebGLBlockListForBrowserVersion").split(";"),Xb=JSON.parse(this.na.Ma("SessionStartInfoJson").toString());m.a.$(512309317,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernWebGLCompatible Browser:{0}, BrowserMajorVersion:{1}",Xb.Browser,Xb.BrowserMajorVersion);for(const sc of kb)if(sc.split(":")[0].toLowerCase()===(Xb.Browser||"").toLowerCase()&&parseInt(Xb.BrowserMajorVersion||
"",10)<parseInt(sc.split(":")[1],10))return m.a.$(512309316,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernWebGLCompatible Name {0}, Version {1}",Xb.Browser,Xb.BrowserMajorVersion),!1;return!0}oOj(){const kb=this.na.Ma("PptModernSlideShowBlockListForBrowserVersion").split(";"),Xb=JSON.parse(this.na.Ma("SessionStartInfoJson").toString());m.a.$(512309315,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernCompatible Browser:{0}, BrowserMajorVersion:{1}",Xb.Browser,Xb.BrowserMajorVersion);for(const sc of kb)if(sc.split(":")[0].toLowerCase()===
(Xb.Browser||"").toLowerCase()&&parseInt(Xb.BrowserMajorVersion||"",10)<parseInt(sc.split(":")[1],10))return m.a.$(512309314,830,50,"PPTWebEditorSlideShowPackage::IsBrowserModernCompatible Name {0}, Version {1}",Xb.Browser,Xb.BrowserMajorVersion),!1;return!0}Feg(kb){return Pa.a(kb)}init(){this.ga.resolve("Common.IAppSettingsManager").Wf(Object(H.a)(this,this.uu,"onFullAppSettingsReady"));var kb=B.a.instance.resolve("PowerPointWebEditor.IApplicationSettings");var Xb=B.a.instance.resolve("Common.AFrameworkApplication");
Xb=new ld(B.a.instance.resolve("Common.IActionManagerExtended"),B.a.instance.resolve("PowerPointWebEditor.IFocusManager"),B.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),B.a.instance.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),B.a.instance.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),B.a.instance.resolve("PowerPoint.IPathManager"),Xb.Bj.Sd,B.a.instance.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),B.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),
B.a.instance.resolve("PowerPointWebEditor.IWindowUtils"),e.AFrameworkApplication.ha,Xb.Xm.Pd,B.a.instance.resolve("PowerPointWebEditor.ISaveBlockingUI"),Xb.Xm.Wfb(),B.a.instance.resolve("PowerPointWebEditor.ISessionLifetimeManager"),B.a.instance.resolve("PowerPointWebEditor.ISlideshowManager"),B.a.instance.resolve("Box4.Graph.IGraphInstance").Xd(7),B.a.instance.resolve("PowerPointWebEditor.IInboundHelper"),B.a.instance.resolve("Common.ITaskManager"),e.AFrameworkApplication.$d,B.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager"),
B.a.instance.resolve("PowerPointWebEditor.View.IViewEventSource"),B.a.instance.eb("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),B.a.instance.resolve("PowerPointWebEditor.ISubtitleContext"),B.a.instance.eb("PowerPointLive.ILivePresenter"),B.a.instance.resolve("PowerPointWebEditor.IDeferredContentManager"),B.a.instance.he("PowerPointWebEditor.ISorterViewActorLazy"));Xb.Kb();Xb.Ae();Xb=e.AFrameworkApplication.ha.getBooleanAppSetting("LiveSubtitlesEnabled");kb.lJb&&Xb&&(kb=new Ec(B.a.instance.resolve("Common.IActionManagerExtended"),
B.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),B.a.instance.resolve("PowerPointWebEditor.View.IViewEventSource"),B.a.instance.resolve("PowerPointWebEditor.ISubtitleContext")),kb.Kb(),kb.Ae());kb=new Xc(u.a(B.a.instance),B.a.instance.resolve("Common.IActionManagerExtended"),B.a.instance.resolve("PowerPointWebEditor.View.IViewEventSource"),B.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),B.a.instance.resolve("PowerPoint.IPathManager"),B.a.instance.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),
B.a.instance.resolve("PowerPointWebEditor.ISubtitleContext"),B.a.instance.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),B.a.instance.resolve("PowerPointWebEditor.ISlideshowFrame"),B.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").krm);kb.Kb();kb.Ae()}uu(){w.a.get_instance().Ai(10,null).continueWith(()=>{if(!this.na.isCreateNew&&this.na.lKk&&this.na.xrm)try{G.a.kH(B.a.instance.eb("Common.ISystemInitiatedFeedback")).continueWith(kb=>{kb.result.logActivity("HasPresentButtonSeen",
"PresentTeachingUIEnabled")}),m.a.$(512495957,830,50,"PPTWebEditorSlideShowPackage::Present Teaching UI triggered")}catch(kb){m.a.$(512495956,830,10,"PPTWebEditorSlideShowPackage::Exception thrown when trying to trigger Present teaching UI. Exception: {0}",kb)}})}vUn(){this.ga.resolve("PowerPointWebEditor.ISlideshowToolbar");return null}oSn(){this.ga.resolve("PowerPointWebEditor.IInkButtonHelper");return null}TSn(){this.ga.resolve("PowerPointWebEditor.IOptionsButtonLoader")}wUn(){this.ga.resolve("PowerPointWebEditor.ISlideShowVoiceNotification");
return null}tUn(){this.ga.resolve("PowerPointWebEditor.ISlideShowCameraNotification")}dispose(){}static main(){h.a.instance.Jc(new Vd)}}Object(d.a)(Vd,"PPTWebEditorSlideShowPackage",null,[4,5]);var Ja=a(491),Lb=a(91);class fa{constructor(kb){this.L$d=kb;this.m_e=this.Kf=this.kf=this.Wb=null;this.xa=new kc.a;this.pc=!1}init(kb,Xb){this.Kf=kb;this.kf=Xb;this.qG()}dispose(){this.Wb&&(this.visible=!1,this.kf.hc(O.a.click,this.Wb,Object(H.a)(this,this.hKb,"onBackgroundClick")),this.Kf&&this.Wb&&(this.Kf.removeChild(this.Wb),
this.Wb=null),this.xa&&(this.xa.dispose(),this.xa=null))}qG(){this.Wb=document.createElement("div");this.Wb.className="EditingNotesDefaultView";e.AFrameworkApplication.isRtl&&(this.Wb.style.direction=Qa.a.UEb);this.Kf.appendChild(this.Wb);this.m_e=document.createElement("p");this.m_e.className="EditingNotesDefaultViewContent";this.L$d?(this.m_e.classList.add("NotesGhostText"),this.m_e.innerText=ResourceStrings.l_NotesPaneGhostText):this.m_e.innerText=ResourceStrings.l_ClickToAddNotes;this.Wb.appendChild(this.m_e);
this.kf.Ub(O.a.click,this.Wb,Object(H.a)(this,this.hKb,"onBackgroundClick"))}hKb(kb){this.xa.raiseEvent("OnBackgroundClick",kb);return!0}lti(kb){this.xa.addHandler("OnBackgroundClick",kb)}Yn(){}get visible(){return this.pc}set visible(kb){this.pc=kb;this.Wb.style.display=kb?Lb.a.block:Lb.a.none}get va(){return this.Wb}}Object(d.a)(fa,"NotesPromptView",null,[590,591,40]);class Na{constructor(kb){this.RSh=this.Kf=this.Wb=null;this.URh=this.pc=!1;this.gFn=kb}init(kb,Xb){Xb.M$d&&(this.Kf=kb,this.Wb=document.createElement("div"),
this.Wb.className="EditingNotesReadOnlyView",this.gFn&&(this.Wb.style.direction=Qa.a.UEb),this.Kf.appendChild(this.Wb),this.RSh=document.createElement("div"),this.RSh.className="EditingNotesReadOnlyViewContent",kb={},kb.inputString=Xb.Zpd,Xb=jSanity.sanitize(kb),this.RSh.appendChild(Xb),this.Wb.appendChild(this.RSh),this.URh=!0)}dispose(){this.URh&&(this.visible=!1,this.Kf&&this.Wb&&(this.Kf.removeChild(this.Wb),this.Wb=null),this.URh=!1)}get visible(){return this.pc}set visible(kb){this.URh&&(this.pc=
kb,this.Wb.style.display=kb?Lb.a.block:Lb.a.none)}get va(){return this.Wb}}Object(d.a)(Na,"NotesReadOnlyView",null,[589,40]);var ha=a(604),sa=a(106),xa=a(77),pb=a(149),Rb=a(818);class Fc extends ha.a{constructor(kb,Xb,sc,Rc,Zc,Id,Td,he,be,Ue,cf,mf,ig,ug,Pf,mg,Lf,Nd,ih,Yg,Ah){super(kb,Xb);this.isCreateNew=Ah;this.m0e=this.ug=this.ri=this.Qme=null;this.FJb=!1;this.ORa=fc.App.Qp;this.Cmc=Object(pc.a)(586,Xb);this.Wb=this.yd.container;this.tc(this.Wb);this.kf=sc;this.Na=Rc;this.loe=Zc;this.B0e=Ue;this.uq=
Id;this.Jm=Td;this.Pp=he;this.PN=be;this.rb=cf;this.$ub=mf;this.Cna=Object(pc.a)(108,kb);this.WTc=ig;this.kc=ug;this.Tne=Pf;this.fEa=mg;this.YI=Lf;this.mf=Nd;this.Qne=ih;this.Cr=Yg;this.tRh=this.mf.Eq("formatpaintertext.cur");this.Cr&&this.YI.ATe(Object(H.a)(this,this.yqd,"onTextFPActiveChanged"));this.ri||this.qG()}dispose(){this.kf.hc(O.a.click,this.Wb.parentNode,Object(H.a)(this,this.hKb,"onBackgroundClick"));this.Cr&&this.YI.F4e(Object(H.a)(this,this.yqd,"onTextFPActiveChanged"));this.loe&&(this.loe.dispose(),
this.loe=null);this.B0e&&(this.B0e.dispose(),this.B0e=null);super.dispose()}HB(kb){super.HB(kb);this.cxh()}uga(kb){this.JF(this.ug,kb,-1)}k6(){this.K_h()}qG(){this.Qne&&(this.m0e=this.yd.createElement("div"),this.m0e.className="NotesResizeHandle",sa.c(this.m0e,!0),Sys.UI.DomElement.addCssClass(this.m0e,"NotesResizeHandle"),this.htmlElement.appendChild(this.m0e),this.hn(this.m0e));this.Qme=this.yd.createElement("div");this.Qme.className="NotesContentContainer";this.Qme.id="NotesContentContainer";this.hn(this.Qme);
this.htmlElement.appendChild(this.Qme);this.ri=this.yd.createElement("div");Sys.UI.DomElement.addCssClass(this.ri,"NotesView");Sys.UI.DomElement.addCssClass(this.ri,"NotesEditViewVisible");this.Qme.appendChild(this.ri);this.hn(this.ri);this.ug=this.yd.createElement("div");Sys.UI.DomElement.addCssClass(this.ug,"NotesViewContent");this.ri.appendChild(this.ug);this.hn(this.ug);e.AFrameworkApplication.isRtl&&(this.ri.style.direction=Qa.a.UEb);this.kf.Ub(O.a.click,this.Wb.parentNode,Object(H.a)(this,this.hKb,
"onBackgroundClick"));this.loe.init(this.Wb.parentNode,this.kf);this.B0e.init(this.Wb.parentNode,this.Cmc);this.K_h();this.loe.lti(Object(H.a)(this,this.cRn,"onDefaultViewClick"))}K_h(){if(this.isCreateNew&&!Fc.Ndm){Fc.Ndm=!0;var kb=this.uq.nZe(this.Cmc);m.a.$(507569628,812,50,kb?"EmptyNotesOnLoad":"NonEmptyNotesOnLoad")}this.Cmc.M$d?(this.Ucb(!1),this.dkl(!1),this.afo()):(kb=this.uq.nZe(this.Cmc),kb=this.FJb||!kb,this.Ucb(kb),this.dkl(!kb),this.Cr&&this.NT(Fc.ssa))}yqd(kb,Xb){Fc.ssa=Xb.Wkd;this.NT(Fc.ssa)}NT(kb){const Xb=
this.Wb.querySelectorAll(".OutlineElement, .EditingSurfaceBody");if(2===kb)for(this.Wb.style.cursor=Ia.a.BZ(this.tRh,Lb.a.GB),this.ug.style.cursor=Ia.a.BZ(this.tRh,Lb.a.GB),kb=0;kb<Xb.length;kb++)if(Xb[kb].style.cursor!==Ia.a.BZ(this.tRh,Lb.a.GB))Xb[kb].style.cursor=Ia.a.BZ(this.tRh,Lb.a.qga);else break;else for(this.Wb.style.cursor=Lb.a.GB,this.ug.style.cursor=Lb.a.GB,kb=0;kb<Xb.length;kb++)Xb[kb].style.cursor=Lb.a.qga}cxh(){this.htmlElement.style.zIndex="0";const kb=this.uq.fYa(this.Cmc,this.yd.Cd),
Xb=this.uq.nlc(this.Cmc,this.yd.Cd);var sc=kb.width-Xb[1]-Xb[3];0>sc&&(Xb[1]+=sc/2,Xb[3]+=sc/2);sc=kb.height-Xb[0]-Xb[2];0>sc&&(Xb[1]+=sc/2,Xb[3]+=sc/2);Fc.cbl(this.ri,Xb);Fc.cbl(this.loe.va,Xb);Fc.cbl(this.B0e.va,Xb);this.fEa.wib(new xa.a(kb.x,kb.y),e.AFrameworkApplication.isRtl,this.ri,!0)}jAb(){this.FJb=!0;this.QW();this.startEditing()}kAb(){this.FJb=!1;this.QW();this.endEditing()}pM(){return this.FJb}startEditing(){this.Wmc.M$d?this.rb.lk():(this.K_h(),this.h$l()||(this.ORa=this.Wmc.DYa,this.PN.kbl(this.Cmc,
!1),this.PN.Nrm(this.Cmc)))}endEditing(){if(!this.Wmc.M$d&&(this.$ub.setVisibility(!1),this.K_h(),!this.h$l())){this.kkm.endEditing(!0,14);this.WTc.ZVe(this.Cna);var kb=this.Tne.jCa(this.Wmc,this.ORa),Xb=!!this.Wmc&&this.Wmc.isConnected;kb&&(Xb&&this.Wmc.Jsd(),this.Jm.qfb(this.Wmc),this.Pp.HUe(),m.a.$(507643671,812,50,"Notes edited"));this.PN.kbl(this.Cmc,Xb&&this.Wmc.Nmd)}}cRn(kb,Xb){this.hKb(Xb)}hKb(){this.Na.Gm(pb.a.Xva,!0);this.Ucb(!0);this.dkl(!1);this.kkm.WT();this.aoh();this.ORa=this.Wmc.DYa;
return!0}h$l(){return!this.kc.oq}get va(){return this.htmlElement}get Wmc(){return this.Cmc}get kkm(){return this.Pc}aoh(){this.Qea(!0)}afo(){this.B0e.visible=!0}dkl(kb){this.loe.visible=kb}Ucb(kb){Rb.b(kb,this.Qme,"NotesContentContainerHidden","NotesContentContainerVisible")}Qea(kb){Rb.b(kb,this.ri,"NotesEditViewHidden","NotesEditViewVisible")}static cbl(kb,Xb){kb&&(kb.style.paddingTop=Ia.a.Zc(Xb[0]),kb.style.paddingRight=Ia.a.Zc(Xb[1]),kb.style.paddingBottom=Ia.a.Zc(Xb[2]),kb.style.paddingLeft=
Ia.a.Zc(Xb[3]))}static Sxn(kb){return kb?Sys.UI.DomElement.containsCssClass(kb,"NotesResizeHandle"):!1}}Fc.ssa=0;Fc.Ndm=!1;Object(d.a)(Fc,"NotesViewElement",ha.a,[588,265]);var Kc=a(1719),jb=a(468),zb=a(292),ic=a(488),bb=a(807),Pb=a(1195),wc=a(602),Dc=a(48),ed=a(249),ad=a(601);class Gd extends ad.a{constructor(kb,Xb){super(kb,Xb);this.Nwa=[];this.iod=0}Wdc(kb,...Xb){Array.addRange(this.Nwa,Xb);this.iod=kb}Znc(){if(this.Nwa)for(const kb of this.Nwa)this.Tv.Ync(this.container,kb,this.iod);this.Tv.bP(this.container,
this.A$)}qpc(){this.Tv.aM(this.container,this.A$);for(const kb of this.Nwa)this.Tv.aM(this.container,kb)}}Object(d.a)(Gd,"NotesViewDomManager",ad.a,[]);var Od=a(629);class Ld extends Od.ViewSelectionChangedHandler{constructor(kb,Xb){super(kb);this.sa=Xb}$Hb(){return[Object(H.a)(this,this.jnc,"onSetup"),Object(H.a)(this,this.anc,"onEnsurePageViewElementsCreated"),Object(H.a)(this,this.bnc,"onEnsureSelectedContentViewElementsCreated"),Object(H.a)(this,this.enc,"onMainLoop"),Object(H.a)(this,this.OSn,
"onNotesContentSelect"),Object(H.a)(this,this.$mc,"onCommit"),Object(H.a)(this,this.lnc,"onTearDown")]}OSn(kb,Xb){this.mga(Xb);kb=Object(pc.a)(586,this.Lh.ih);if(!kb)return!0;kb=Object(pc.a)(588,kb.yc(this.Lh.Ua));if(!kb)return!0;this.sa.Ira()?kb.pM()||kb.jAb():kb.pM()&&kb.kAb();return!0}}Object(d.a)(Ld,"NotesViewSelectionChangedHandler",Od.ViewSelectionChangedHandler,[]);var ee=a(487),Ce=a(127);class Pc extends ee.DragSelectionDragAdapter{constructor(kb,Xb,sc,Rc,Zc,Id,Td){super(kb,Xb,sc);this.ys=
Rc;this.y9j=Id;this.uq=Zc;this.kc=Td}Wu(kb){if(this.y9j){var Xb=this.opc(kb);const sc=Xb?Xb.mb:null;if(sc){const Rc=this.uq.Bgb(sc)?Object(pc.a)(586,sc):this.uq.NZb(sc);if(Rc&&this.uq.nZe(Rc))return!1}if(kb.ctrlKey&&Xb&&sc&&(Xb=this.Xf.NZa(kb.clientPoint,Xb,sc,this.Xf,!1))&&Ce.HyperlinkReader.sna(Xb,!0))return!1}kb=super.Wu(kb);null!==this.ys&&kb&&this.ys.sxa(Lb.a.qga);return kb}tu(kb){super.tu(kb);null!==this.ys&&this.ys.dGa()}Xn(kb){super.Xn(kb);null!==this.ys&&this.ys.dGa()}hL(kb){return!this.Xf.isActive||
n.a("DisableNotesViewViewingModeSelection")&&!this.kc.oq?!1:super.hL(kb)}static MZd(kb){return new Pc(kb,B.a.instance.resolve("Common.IActionManagerExtended"),B.a.instance.resolve("Common.IActivityManager"),B.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").fJa?B.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,B.a.instance.resolve("PowerPointWebEditor.Graph.INotesReader"),B.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pze,B.a.instance.resolve("PowerPointWebEditor.Core.IUnifiedAppState"))}}
Object(d.a)(Pc,"NotesDragSelectionDragAdapter",ee.DragSelectionDragAdapter,[]);var Yc=a(261),Bd=a(83);class Dd{constructor(kb,Xb,sc,Rc,Zc,Id,Td,he,be,Ue,cf){this.zgm=this.$od=this.Hdm=this.cik=this.ehb=0;this.eta=this.Rvb=this.rSh=null;this.drg=this.Xcm=this.mSh=0;this.zbk=!1;this.Cna=kb;this.bD=Xb;this.vj=sc;this.Gb=Rc;this.tQ=Zc;this.Mf=Id;this.rc=Td;this.Oc=he;this.Tb=be;Ue.i2a(Object(H.a)(this,this.Xue,"onOutboundReplication"));this.la=cf}Xv(kb){return kb&&kb.sE!==Sys.UI.MouseButton.rightButton?
Fc.Sxn(kb.Hc):!1}Wu(kb){if(!this.Xv(kb))return!1;this.zbk=!0;this.rSh=this.tQ.va;if(!this.rSh)return!1;this.eta=this.Oc.jd;if(this.eta&&(this.Rvb=this.Mf.va))this.Hdm=this.Rvb.clientHeight;else return!1;this.mSh=Math.floor(.75*(this.rSh.clientHeight+this.Rvb.clientHeight));this.cik=this.rSh.clientHeight;this.$od=this.ehb=kb.clientPoint.y;this.zgm=this.eta.rM;this.bD.vl(7);this.Cna.endEditing(!0,14);return!0}Yv(kb){if(!kb)return!1;this.ehb=kb.clientPoint.y;kb=this.oTl(this.ehb);this.tQ.Bta=kb;this.Gb.ft();
Object(n.a)("FixNotesPaneDragIssue")||(kb=this.Hdm+this.cik-kb,this.Rvb.style.height=kb+"px",this.eta.Dym(kb-1),this.eta.a_h(this.zgm));return!0}Xn(kb){this.bD.EU();this.Cna.WT();this.drg=this.oTl(kb?kb.clientPoint.y:this.ehb);this.la.Ra(Tb.a.Mjh,2,this.drg)}tu(){this.zbk&&(this.zbk=!1,this.Xn(null))}Xue(){this.drg!==this.Xcm&&2===fc.App.Zb.mode&&(this.Xcm=this.drg,this.KVn(this.drg))}KVn(kb){const Xb=this.rc.In,sc=this.Tb.Kd(4);try{sc.tc(Xb),Xb.dKb=4320,Xb.Bta=this.x_m(kb)}finally{sc&&sc.dispose()}}oTl(kb){kb=
this.cik+this.vj.Fs(this.$od-kb);0<this.mSh&&kb>this.mSh?kb=this.mSh:kb<Yc.a.FNa&&kb>Bd.a.VTd?kb=Yc.a.FNa:kb<Bd.a.VTd&&(kb=Bd.a.sJh);return kb}x_m(kb){return this.vj.k2e(kb,1)}static MZd(kb){return new Dd(kb,B.a.instance.resolve("Common.CursorManager"),B.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),B.a.instance.resolve("Box4.IAppFrame"),B.a.instance.resolve("PowerPointWebEditor.INotesPane"),B.a.instance.resolve("PowerPointWebEditor.ISlidePane"),B.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),
B.a.instance.resolve("PowerPointWebEditor.IActiveSlideViewManager"),B.a.instance.resolve("Common.Transaction.ITransactionFactory"),B.a.instance.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),B.a.instance.resolve("Common.IActionManagerExtended"))}}Object(d.a)(Dd,"NotesResizeDragAdapter",null,[229]);class Sd extends jb.a{constructor(kb,Xb,sc,Rc,Zc,Id,Td,he,be,Ue,cf,mf,ig,ug){super(pb.a.Xva,kb,Xb,sc,Rc,Zc,Td,he,mf);this.Gfk=!1;this.Yyb=Id;this.kc=be;this.Qg=Ue;this.pQ=cf;this.y9j=ig;this.Cr=ug}get IKd(){return e.AFrameworkApplication.ha}YC(kb,
Xb=null){this.Cr&&this.Qg.Ub(O.a.BR,this.container,Object(H.a)(this,this.n1e,"mouseUpHandlerFilter"));super.YC(kb,Xb);(kb=Object(pc.a)(586,kb))&&kb.M$d&&this.Ug&&this.Ug.Lo&&this.Ug.Lo.setAttribute("aria-readonly","true")}detach(){this.Cr&&this.nq&&this.Qg.hc(O.a.BR,this.container,Object(H.a)(this,this.n1e,"mouseUpHandlerFilter"));super.detach()}skc(kb,Xb){return new Gd(kb,Xb)}Awa(kb){kb=super.Awa(kb);kb.A$=Pc.MZd(this);kb.Wdc(1,Dd.MZd(this));return kb}tla(kb){this.Tgd=kb.Dg;if(!this.Wnc||this.isActive||
!this.y9j||(kb.Pb.type===O.a.mouseDown||kb.Pb.type===O.a.vXa)&&kb.sE!==Sys.UI.MouseButton.leftButton)return!1;var Xb=kb.Hc;if(Xb&&Sys.UI.DomElement.containsCssClass(Xb,"NotesResizeHandle"))return!1;let sc=!1;jb.a.wba&&(sc=jb.a.wba.iwa());fc.App.pG.yZ&&fc.App.pG.yZ.$4e(Rc=>{Rc&&(sc=!0)});Xb=!n.a("DeprecateIE.NotesView")&&sc&&E.a.C3;kb=new bb.a(kb,this,!0,Xb);this.J1n(kb);return!1}J1n(kb){this.D3e();this.aoa(E.a.Yf||E.a.aQa);this.qn.raiseEvent(jb.a.Imd,new Pb.a(kb.graphNode));this.Skd(kb.graphNode);
this.k8e();const Xb=[Object(H.a)(this,this.Cuk,"noneClickHandler"),Object(H.a)(this,this.oPn,"notesSnapToContentClickHandler"),Object(H.a)(this,this.mPn,"notesDefaultClickHandler")];for(const sc of Xb)if(sc(kb).C5){this.Gfk=!0;break}}n1e(){return this.Gfk&&this.pQ.AYa?(this.Aa.Eb(Dc.a.sfa,2),!0):this.Gfk=!1}mPn(kb){const Xb=jb.a.kd.Vo(Dc.a.SUb);Xb.properties.fa(Kc.a.source,"DefaultClickHandler");this.a$(kb.I0,kb.Gr,kb.graphNode,kb.Pc,kb.jh.shiftKey,kb.jh.ctrlKey,kb.jh.Dg);Xb.end();kb.xYb&&this.aoa(!0);
this.editingView.Gub(kb.jh.shiftKey,kb.I0,kb.jh.Dg);return zb.a.ql(!0)}oPn(kb){if(!kb.Gr){const Xb=kb.Gr,sc=kb.graphNode,Rc=jb.a.kd.Vo(Dc.a.SUb);Rc.properties.fa(Kc.a.source,"SnapToContentClickHandler");this.a$(kb.I0,Xb,sc,this,kb.jh.shiftKey,kb.jh.ctrlKey,kb.jh.Dg);Rc.end();kb.xYb&&this.aoa(!0);this.editingView.Gub(kb.jh.shiftKey,kb.I0,kb.jh.Dg);return zb.a.ql(!0)}return zb.a.notHandled}xTa(){super.xTa();this.Ug&&this.Ug.Lo&&(this.IKd.getBooleanAppSetting("AccessibilityNotificationEnabledViaAriaLiveRegion")?
this.Ug.Eoc(Da.a.ALd):this.Ug.y5e(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,"",Da.a.ALd),this.Ug.Lo.setAttribute(Da.a.IA,ResourceStrings.l_NotesPane))}otd(){this.sD.Md===this&&this.suspend()}dsd(){this.sD.Md===this&&this.resume()}Old(){return new Ld(this,B.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"))}mld(){return[Object(H.a)(this,this.Cuk,"noneClickHandler"),Object(H.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(H.a)(this,this.tripleClickHandler,
"tripleClickHandler"),Object(H.a)(this,this.defaultClickHandler,"defaultClickHandler")]}vld(){return[Object(H.a)(this,this.Cuk,"noneClickHandler"),Object(H.a)(this,this.defaultDoubleClickHandler,"defaultDoubleClickHandler")]}Cuk(kb){return this.OOc(kb)||this.Txn()?zb.a.ql(!0):zb.a.notHandled}qld(){return[Object(H.a)(this,this.noContextMenuHandler,"noContextMenuHandler"),Object(H.a)(this,this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(H.a)(this,this.domElementSelectedContextMenuHandler,
"domElementSelectedContextMenuHandler")]}PGa(kb){this.OOc(kb)||super.PGa(kb)}noContextMenuHandler(kb){return this.OOc(kb)?ic.a.ql(null):ic.a.notHandled}OOc(kb){return!!kb&&!!kb.graphNode&&60===kb.graphNode.type&&kb.graphNode.M$d}Txn(){return!this.kc.oq}Zfb(){return wc.a.h1e}get eL(){return super.eL|96}get Ooc(){return!0}c7m(kb){var Xb,sc,Rc;if(n.a("LogPasteSlideStepTime")){var Zc=null===Gc.a||void 0===Gc.a?void 0:Gc.a.MO("PasteSlideShimmerStage","T2Ended");if(0<(null===Zc||void 0===Zc?void 0:Zc.length)||
(null===(Xb=this.Aa)||void 0===Xb?0:Xb.JA(Tb.a.uF)))kb.AIh=Tb.a.uF,(null===(sc=this.IKd)||void 0===sc?0:sc.getBooleanAppSetting("EnableFastRenderForPasteSlide"))&&n.a("DelayNotesViewValidateForPasteSlide")&&(kb.QXi=!0)}else n.a("LogCutSlideStepTime")&&(null===(Zc=this.Aa)||void 0===Zc?0:Zc.JA(Tb.a.fwa))&&(kb.AIh=Tb.a.fwa,(null===(Rc=this.IKd)||void 0===Rc?0:Rc.getBooleanAppSetting("EnableFastRenderForCutSlide"))&&n.a("DelayNotesViewValidateForCutSlide")&&(kb.QXi=!0))}vga(kb,Xb,sc=null){if(this.Yyb.XO(this)){var Rc=
{AIh:0,QXi:!1};this.c7m(Rc);const Zc=(null===Rc||void 0===Rc?0:Rc.AIh)?new ed.a("NotesView::validateAsynchronous",Rc.AIh):void 0;null===Zc||void 0===Zc?void 0:Zc.Gf("ST");(null===Rc||void 0===Rc?0:Rc.QXi)?(Rc=new Zb.a(1,1,0,()=>{super.vga(kb,Xb,sc)},223),e.AFrameworkApplication.Zd.Rb(Rc)):super.vga(kb,Xb,sc);null===Zc||void 0===Zc?void 0:Zc.Gf("ET");null===Zc||void 0===Zc?void 0:Zc.hO()}}}Object(d.a)(Sd,"NotesView",jb.a,[532,587,213,152,40,108,214,215,216,217]);var He=a(603),ge=a(838),ve=a(220);class ze{constructor(kb,
Xb,sc,Rc){this.sgm=null;this.Dmc=kb;this.ya=Xb;this.pr=sc;this.Nwg=Rc}evn(){this.sgm=new He.a(ve.App.vSb.jkm,"EditingNotesPanel","EditingNotesPanel InteractiveView");this.Dmc.qMa(this.sgm.Jxa);ge.a.RHh(this.Dmc);this.aSl(this.ya.Ia);this.pr.zPl(Object(H.a)(this,this.Xkm,"onAttachNotesView"))}Xkm(kb,Xb){this.v$m();this.aSl(Xb.Ed)}aSl(kb){this.ya.presentation&&kb&&kb.isConnected&&(kb=this.Nwg.ALh(kb,27),this.Dmc.YC(kb))}v$m(){this.Dmc.nq&&(this.Dmc.editingView.disable(!0,14),this.Dmc.detach())}dispose(){this.pr.Ptm(Object(H.a)(this,
this.Xkm,"onAttachNotesView"))}}Object(d.a)(ze,"NotesViewHelper",null,[40]);var bf=a(1417),Of=a(71);class Qf{constructor(kb,Xb,sc,Rc,Zc,Id,Td,he,be,Ue,cf,mf,ig){var ug;this.kh=this.Odm=!1;this.Ri=null;this.tQ=Rc;this.Dmc=Zc;this.la=kb;this.zc=Xb;this.Na=sc;this.mY=he;this.jc=Id;this.ya=Td;this.Oc=be;this.Gb=Ue;this.WIa=cf;this.zb=mf;this.Odm=null!==(ug=null===ig||void 0===ig?void 0:ig.getBooleanAppSetting("EnableShowHideNotesOptimization"))&&void 0!==ug?ug:!1;this.kh=ig.getBooleanAppSetting(Of.a.EJ)}Kb(){n.a("DelayRegisterShowHideNotesCommand")&&
!this.jc.Tf?(this.Ri=B.a.instance.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.Ri.WSb(Object(H.a)(this,this.stm,"registerShowHideNotesCommand"))):this.la.Ba(Tb.a.tVa,nb.a.application,Object(H.a)(this,this.tVa,"showHideNotes"));this.la.ua(Tb.a.wrd,nb.a.application,Object(H.a)(this,this.l2n,"queryNotesPaneState"),96);this.la.ua(Tb.a.S2e,nb.a.application,Object(H.a)(this,this.Iom,"pageScrollNotesPane"),64);this.la.ua(Tb.a.R2e,nb.a.application,Object(H.a)(this,this.Iom,"pageScrollNotesPane"),
64);this.la.Ba(Tb.a.Mjh,nb.a.application,Object(H.a)(this,this.nPn,"notesResize"))}Ae(){const kb=this.Na.Uc(pb.a.Xva);kb.bindAction(vb.a.hb(ba.a.cG,0),Tb.a.S2e);kb.bindAction(vb.a.hb(ba.a.bG,0),Tb.a.R2e)}stm(){this.Ri.qec(Object(H.a)(this,this.stm,"registerShowHideNotesCommand"));this.la.Ba(Tb.a.tVa,nb.a.application,Object(H.a)(this,this.tVa,"showHideNotes"))}tVa(kb,Xb,sc,Rc,Zc){if(this.zb&&0!==this.zb.fj)return 2;kb=this.jc.Tf;if(!this.ya.Ia||!kb||this.zc.NO(kb))return 16;if(1===sc)return 32;Zc&&
Object(Cb.a)(bf.a,Zc)?Zc.Roc?this.tQ.q6e():this.tQ.U6l():(this.tQ.Snm(),this.Odm||(this.tQ.wzc()&&this.Dmc.nq?this.Na.Gm(pb.a.Xva,!0):this.Na.Gm(pb.a.Xva,!1)));this.mY.Mrb();return 32}l2n(kb,Xb,sc,Rc,Zc){if(!Zc||!Object(Cb.a)(fb.a,Zc))return 8;Zc.Fg(this.tQ.wzc());return 32}Iom(kb,Xb,sc){return 1===sc?32:this.tQ?(kb===Tb.a.R2e?this.tQ.va.scrollTop+=Qf.cTl:kb===Tb.a.S2e&&(this.tQ.va.scrollTop-=Qf.cTl),32):8}nPn(kb,Xb,sc,Rc,Zc){var Id;m.a.$(508052502,822,50,"Notes Resize Begin");if(!this.tQ||!Zc||"number"!==
typeof Zc)return m.a.$(508052501,822,50,"Notes Resize Fail"),8;this.tQ.Bta=Zc;null===(Id=this.Oc.jd)||void 0===Id?void 0:Id.P5e(1);this.Gb.ft();this.kh||this.WIa.w2h();m.a.$(508052500,822,50,"Notes Resize Success, Notes status:{0}, Notes Height:{1}",this.tQ.ikm?"On":"Off",this.tQ.Bta);return 32}}Qf.cTl=80;Object(d.a)(Qf,"NotesActor",null,[502]);class Oe{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.Notes"}oc(kb){this.ga=kb;this.ga.register(532,"PowerPointWebEditor.INotesView").oa().pa(()=>
new Sd(this.ga.resolve("Box4.IWorkspace"),this.ga.resolve("Box4.IInteractiveViewManager"),()=>this.ga.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("Box4.IHtmlViewRootFactory"),this.ga.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.ga.resolve("Box4.IInteractiveEventNotifier"),this.ga.eb("Box4.ITextMetricsAdapter"),this.ga.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.ga.resolve("Common.MouseInputManager"),
this.ga.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.ga.resolve("Box4.IRotatingCoordinateConverter"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").pze,this.ga.resolve("PowerPointWebEditor.IApplicationSettings").GT));this.ga.register(ze,"PowerPointWebEditor.Notes.NotesViewHelper").oa().pa(()=>new ze(this.ga.resolve("PowerPointWebEditor.INotesView"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.View.IViewEventHandlers"),
this.ga.resolve("PowerPointWebEditor.Graph.IGraphNodeHelper")))}init(){this.ga.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393326,new Ja.a((Xb,sc)=>Object(Cb.a)(532,Xb)?new Fc(Xb,sc,this.ga.resolve("Common.IClickInputManager"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),new fa(this.ga.resolve("PowerPointWebEditor.IApplicationSettings").getBooleanAppSetting(Of.a.ykd)),this.ga.resolve("PowerPointWebEditor.Graph.INotesReader"),this.ga.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.ga.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.ga.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),new Na(e.AFrameworkApplication.isRtl),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("Box4.IGrippersManager"),this.ga.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.ga.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.ga.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),this.ga.resolve("PowerPointWebEditor.ViewCore.IPPTPositionEditor"),
this.ga.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),this.ga.resolve("PowerPoint.IPathManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").VWh,this.ga.resolve("PowerPointWebEditor.IApplicationSettings").GT,this.ga.resolve("PowerPointWebEditor.IApplicationSettings").isCreateNew):null));this.ga.resolve("Box4.IEditingView");this.ga.resolve("PowerPointWebEditor.Notes.NotesViewHelper").evn();const kb=c();kb.Kb();kb.Ae()}dispose(){this.ga.resolve("PowerPointWebEditor.Notes.NotesViewHelper").dispose()}static main(){h.a.instance.Jc(new Oe)}}
Object(d.a)(Oe,"PPTWebEditorNotesPackage",null,[4,5]);var tg=a(168);class Cf{constructor(kb,Xb,sc,Rc,Zc,Id,Td,he,be,Ue){this.mgm=new F.a;this.Hhm=null;this.jc=Rc;this.ya=Zc;this.Na=sc;this.Kwa=Td;this.e4b=he;this.qB=Id;this.sa=Xb;this.na=be;this.pr=kb;this.od=Ue;this.na.K$l&&(this.sa&&this.sa.AO(Object(H.a)(this,this.tE,"onSelectionChanged")),he&&he.otm(this),this.pr.$hd(Object(H.a)(this,this.tY,"onFocusChanged")),this.od.oui(Object(H.a)(this,this.R0g,"onShapeViewElementUnlocked")),this.od.MQl(Object(H.a)(this,
this.Onm,"onThumbnailsSetFakeImage")),this.od.NQl(Object(H.a)(this,this.Pnm,"onThumbnailsSetFocus")),this.od.OQl(Object(H.a)(this,this.Qnm,"onThumbnailsSetSelected")),this.na.Zgg&&this.pr.lQl(Object(H.a)(this,this.Bnm,"onSlideshowNavigationToolbarClickedHandler")),this.na.li&&this.pr.kQl(Object(H.a)(this,this.Anm,"onSlideshowContextMenuFocusedHandler")))}dispose(){this.pr.Rrd(Object(H.a)(this,this.tY,"onFocusChanged"));this.pr.Ttm(Object(H.a)(this,this.eRn,"onDesignerClickSuggestion"));this.od.CZk(Object(H.a)(this,
this.R0g,"onShapeViewElementUnlocked"));this.od.Pum(Object(H.a)(this,this.Onm,"onThumbnailsSetFakeImage"));this.od.Qum(Object(H.a)(this,this.Pnm,"onThumbnailsSetFocus"));this.od.Rum(Object(H.a)(this,this.Qnm,"onThumbnailsSetSelected"));this.na.Zgg&&this.pr.uum(Object(H.a)(this,this.Bnm,"onSlideshowNavigationToolbarClickedHandler"));this.na.li&&this.pr.tum(Object(H.a)(this,this.Anm,"onSlideshowContextMenuFocusedHandler"))}tE(kb,Xb){if(Xb&&Xb.gl&&this.sa.c8(Xb.gl))try{this.opn(Xb.gl)}catch(sc){kb=String.format("AriaManager failed to handle the select changed event. Message: {0}. Stack: {1}",
sc.message,sc.stack),m.a.$(508694669,822,10,kb)}}opn(kb){var Xb=this.sa.Ie();if(1===kb.length||1===Xb.length&&Xb[0].Eg){if(kb=this.sa.Uo()){Xb=new F.a;let sc=this.$3l(kb,Xb,Object(H.a)(this,this.rln,"getShapeName"));sc||Xb.count||(sc=this.e4b.pqj(kb,Xb));!sc&&kb.get_smartArtModelId()?sc=ResourceStrings.l_AccMessageSmartArtSubIcon:Q.a.wb(sc)||(sc+=ResourceStrings.L_ShapeSelected);const Rc=this.e4b.t4l(kb);({YRl:sc,zGl:Xb}=this.ERl(Rc,sc,Xb));!kb.EG&&kb.isUnread&&({YRl:sc,zGl:Xb}=this.ERl(this.e4b.u4l(kb,
this.Hhm),sc,Xb));0<Xb.count?this.Ksm(Xb):this.RKb(sc||"")}}else 1<kb.length&&(kb=this.e4b.s3l(this.sa.zd()),this.RKb(kb||""))}ERl(kb,Xb,sc){kb&&(sc.count?sc.add(document.createTextNode(kb)):Xb=String.format(ResourceStrings.l_ShapeAndPresenceInfo,Xb,kb));return{YRl:Xb,zGl:sc}}tY(kb,Xb){Xb=Xb.bKb;if(Xb===pb.a.lR||Xb===dd.a.sh){kb=this.ya.Ia;let sc=null;Xb===pb.a.lR?sc=(kb=this.jc.xtd.xPh)?String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.Hld()+this.e4b.wMh(kb)):String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,
this.Hld()):Xb!==dd.a.sh||!this.sa.Au()&&this.sa.U7()||(this.qB&&this.qB.value&&(Xb=this.qB.value.Md)&&kb&&Xb.Kp&&tg.e(kb,Xb.Ua),sc=this.e4b.A4l());this.RKb(sc||"")}}setAttribute(kb,Xb,sc){kb&&Da.a.vea(kb,Xb,sc)}b6(kb){this.mgm.add(kb)}$3l(kb,Xb,sc=null){try{if(kb&&this.Na)for(const Rc of this.mgm)if(Rc){const Zc=Rc(kb,this.Na.currentScope?this.Na.currentScope.name:null,Xb,sc);if(Zc||Xb&&0<Xb.count)return Zc}}catch(Rc){kb=String.format("AriaManager failed to get provider message. Message: {0}. Stack: {1}",
Rc.message,Rc.stack),m.a.$(508694667,822,10,kb)}return null}Ksm(kb){if(this.Kwa&&this.Kwa.value){const Xb=this.Kwa.value.k3l(!0);if(Xb&&kb&&0<kb.count){Xb.firstChild&&Xb.removeChild(Xb.firstChild);const sc=document.createElement("p");for(const Rc of kb)sc.appendChild(Rc);Xb.appendChild(sc)}}}pSk(kb,Xb){if(kb){const sc=new F.a;let Rc=this.$3l(kb,sc);Rc||sc.count||(Rc=this.e4b.pqj(kb,sc));0<sc.count?(Xb&&sc.add(document.createTextNode(Xb)),this.Ksm(sc)):(Xb&&(Rc+=" "+Xb),this.RKb(Rc||""))}}RKb(kb){this.Kwa&&
this.Kwa.value&&this.Kwa.value.maa(kb,!0)}R0g(kb,Xb){Xb.presenceUser&&Xb.L$l&&this.RKb(String.format(ResourceStrings.L_EditorLeavingHint,Xb.presenceUser.userName))}eRn(kb,Xb){this.RKb(this.e4b.z2l(Xb.X9n,Xb.Gho))}Onm(kb,Xb){this.setAttribute(Xb.BFb.image,Da.a.ii,Da.a.dfb)}Pnm(kb,Xb){Xb.hasFocus&&Xb.BFb.isSelected&&this.RKb(this.Hld()+this.e4b.wMh(Xb.BFb));this.setAttribute(Xb.BFb.SMe,Da.a.CTb,Xb.hasFocus&&Xb.BFb.isSelected?"true":"false")}Qnm(kb,Xb){Xb.BFb.isSelected&&Xb.hasFocus?this.RKb(this.Hld()+
this.e4b.wMh(Xb.BFb)):Xb.BFb.isSelected||this.RKb(this.Hld());this.setAttribute(Xb.BFb.SMe,Da.a.CTb,Xb.BFb.isSelected?"true":"false")}Bnm(kb,Xb){this.RKb(Xb.text)}rln(kb){this.Hhm=kb||ResourceStrings.l_Object}Anm(kb,Xb){this.RKb(Xb.text)}Hld(){let kb="";const Xb=this.sa.rg();Xb&&1<Xb.length&&(Xb.sort((sc,Rc)=>sc.Dh-Rc.Dh),this.ATb(Xb)&&(kb=this.e4b.Hld(Xb[0].Dh+1,Xb[Xb.length-1].Dh+1)));return kb}ATb(kb){if(!kb||1>=kb.length)return!1;const Xb=kb.length;return kb[Xb-1].Dh-kb[0].Dh+1===Xb?!0:!1}}Object(d.a)(Cf,
"AriaManager",null,[531,40]);var oe=a(1418);class Rf{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.Aria"}oc(kb){this.ga=kb;this.ga.register(530,"PowerPointWebEditor.IAriaMessageHelper").oa().pa(()=>new oe.a(this.ga.eb("PowerpointPresence.IPresenceUserManager"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("PowerPointWebEditor.IShapeReader"),this.ga.resolve("PowerPointWebEditor.Graph.INotesReader"),this.ga.eb("PowerPointWebEditor.Graph.ICommentReader"),
this.ga.eb("PowerPointWebEditor.IAppForOfficeManager"),this.ga.he("PowerPointWebEditor.IAppforOfficeClassFactory"),this.ga.resolve("Box4.IParagraphReader"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings")));this.ga.register(531,"PowerPointWebEditor.IAriaManager").oa().pa(()=>new Cf(this.ga.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("PowerPointWebEditor.IPPTWorkspace"),
this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.he("Box4.IInteractiveViewManager"),this.ga.he("Common.Utils.IAriaNotifier"),this.ga.resolve("PowerPointWebEditor.IAriaMessageHelper"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}init(){this.ga.resolve("PowerPointWebEditor.IAriaManager")}dispose(){this.ga.resolve("PowerPointWebEditor.IAriaManager").dispose()}static main(){h.a.instance.Jc(new Rf)}}
Object(d.a)(Rf,"PptAriaPackage",null,[4,5]);var Uf=a(1263),gf=a(1158),gg=a(56),Ve=a(112),hf=a(45);class ef{constructor(kb,Xb,sc){this.Cgi=this.hFd=this.ygi=this.fFd=this.vei=null;this.dM=kb;this.uNm=Xb;this.Qc=sc;this.init()}init(){this.uNm.Ub(Object(H.a)(this,this.pon,"handleEditingViewUpdatesSafe"));this.fFd=new Uf.a;this.ygi=new Uf.a;this.hFd=new Uf.a;this.Cgi=new gf.a}wbb(kb){this.fFd.add(kb.key,kb)}q4e(kb){this.hFd.add(kb.key,kb)}pon(kb){try{this.oon(kb)}catch(Xb){kb=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",
Xb.message,Xb.stack),P.ULS.sendTraceTag(5285580,334,10,kb)}}oon(kb){let Xb;({fWi:Xb}=ef.vko(this.Qc.Wa.qb)).returnValue&&(kb=ef.xfn(kb,this.vei,Xb),this.B1n(kb,Xb),this.vei=Xb)}B1n(kb,Xb){kb=this.Wdn(kb,Xb);let sc;({notification:sc}=ef.tko(kb)).returnValue&&this.dM.maa(sc,!1)}Wdn(kb,Xb){const sc=new Uf.a;sc.fa(1,new gf.a);sc.fa(0,new gf.a);kb.forEach(Rc=>{3===Rc?(Ve.ImageReader.KJ(Xb.node)||this.T7n(Xb),this.Bjn(sc,Xb)):0===Rc&&this.Kfn(sc,Xb);return!0});return sc}T7n(kb){this.fFd.forEach((Xb,sc)=>
{sc.reset(kb);return!0})}Kfn(kb,Xb){let sc=new Uf.a;Ve.ImageReader.KJ(Xb.node)||(sc=this.Ifn(Xb.Xa));this.Jfn(kb,this.ygi,sc,ef.jxm(this.vei,Xb));this.ygi=sc}Ifn(kb){const Xb=new Uf.a;this.fFd.forEach((sc,Rc)=>{sc=null;({c2a:sc}=Rc.Hdd(kb)).returnValue&&Xb.fa(Rc.key,sc);return!0});return Xb}Jfn(kb,Xb,sc,Rc){const Zc=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;Xb.forEach((Id,Td)=>{const he=this.fFd.ka(Id).Uma||Td.title;let be;({value:be}=sc.Ph(Id)).returnValue?Rc&&be.gU!==Td.gU&&(he&&kb.ka(1).add(he),
Id=this.fFd.ka(Id).Uma,Id=String.format(Zc,be.title,Id),be.description&&(Id+=", "+be.description),kb.ka(0).add(Id)):he&&kb.ka(1).add(he);return!0});sc.forEach((Id,Td)=>{Xb.Sb(Id)||(Id=this.fFd.ka(Id).Uma,Id=String.format(Zc,Td.title,Id),Td.description&&(Id+=", "+Td.description),kb.ka(0).add(Id));return!0})}Bjn(kb,Xb){Xb=this.amn(Xb.node);Xb=this.D1m(Xb);this.bmn(kb,this.Cgi,Xb);this.Cgi=Xb}amn(kb){const Xb=new hf.GraphIterator;Xb.set(kb);if(!Xb.sc(1))return null;const sc=new gf.a;for(;1!==Xb.yi;)this.hFd.forEach((Rc,
Zc)=>{let Id;({WHb:Id}=Zc.H7e(Xb)).returnValue&&sc.add(Id);return!0}),Xb.Bc();sc.reverse();return sc}D1m(kb){kb=kb.toArray();let Xb=0;for(;Xb<kb.length-1;){var sc=kb[Xb];if(sc.ega===kb[Xb+1].ega&&(this.hFd.ka(sc.ega),({E1m:sc}={returnValue:!1,E1m:null}).returnValue)){kb.splice(Xb,2,sc);continue}Xb++}return new gf.a(kb)}bmn(kb,Xb,sc){var Rc;for(Rc=0;Rc<Math.min(sc.length,Xb.length)&&sc.ka(Rc).contentId.equals(Xb.ka(Rc).contentId);Rc++){var Zc=this.hFd.ka(sc.ka(Rc).ega).wYd(sc.ka(Rc),Xb.ka(Rc));Zc&&
(sc.ka(Rc).description&&(Zc+=", "+sc.ka(Rc).description),kb.ka(0).add(Zc))}for(Zc=Rc;Zc<sc.length;Zc++){let Id=this.hFd.ka(sc.ka(Zc).ega).wYd(sc.ka(Zc),null);Id&&(sc.ka(Zc).description&&(Id+=", "+sc.ka(Zc).description),kb.ka(0).add(Id))}for(sc=Rc;sc<Xb.length;sc++)(Rc=this.hFd.ka(Xb.ka(sc).ega).Uma)&&kb.ka(1).add(Rc)}static xfn(kb,Xb,sc){const Rc=new gf.a;(kb=kb||ef.a$n(Xb,sc))?(Rc.add(3),Rc.add(0)):ef.jxm(Xb,sc)&&Rc.add(0);return Rc}static a$n(kb,Xb){return!kb||!kb.node.id.equals(Xb.node.id)}static jxm(kb,
Xb){return!kb||!kb.equals(Xb)}static vko(kb){let Xb;Xb=null;if(!kb||!(gg.SelectionEditor.Dy(kb)||(kb=gg.SelectionEditor.zm(kb,!0,!1),gg.SelectionEditor.Dy(kb)||kb.Ya&&Ve.ImageReader.KJ(kb.Ya.node))))return{returnValue:!1,fWi:Xb};Xb=kb.Ya;return{returnValue:!!Xb,fWi:Xb}}static tko(kb){const Xb=new gf.a;kb.ka(1).forEach(sc=>{sc=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,sc);Xb.add(sc);return!0});kb.ka(0).forEach(sc=>{sc=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,
sc);Xb.add(sc);return!0});kb=Xb.toArray().join(" ");return{returnValue:0<Xb.length,notification:kb}}}Object(d.a)(ef,"AccessibilityContextManager",null,[560]);class Ga{constructor(kb,Xb){this.fLl=!1;this.lrf=null;this.JEh=this.jFh=!1;this.RJl=null;this.qKd=(sc,Rc)=>{(Rc.rO||Rc.laa)&&this.uPn(Rc.rO,Rc.laa)};this.Ce=kb;this.Caa=Xb}get xqn(){return!!this.lrf}Ub(kb){this.fLl||(this.Caa.JFh(this.qKd),this.fLl=!0);this.RJl=kb}uPn(kb,Xb){this.xqn&&this.Ce.Sh(this.lrf);this.jFh=this.jFh||kb;this.JEh=this.JEh||
Xb;this.lrf=new Zb.a(4,1,Ga.J$m,()=>{this.RJl(this.jFh,this.JEh);this.reset()},126);this.Ce.Rb(this.lrf)}reset(){this.lrf=null;this.JEh=this.jFh=!1}}Ga.J$m=100;Object(d.a)(Ga,"EditingViewOnAfterValidateEventsConsolidator",null,[559]);var hb=a(78);class Hb{constructor(){this.Oa=null}get name(){return"Box4.Accessibility"}init(){fc.App.DGh&&this.Oa.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}oc(kb){this.Oa=kb;kb.register(Ga,"Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator").as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").oa().pa(()=>
new Ga(e.AFrameworkApplication.Zd,kb.resolve("Box4.ContentEditableViewEventSource")));kb.register(ef,"Box4.Accessibility.AccessibilityContextManager").as("Box4.Accessibility.IAccessibilityContextManager").oa().pa(()=>new ef(kb.resolve("Common.Utils.IAriaNotifier"),kb.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),hb.a.instance))}static main(){h.a.instance.Jc(new Hb)}}Object(d.a)(Hb,"Box4AccessibilityPackage",null,[4,5]);var mc=a(18),Nc=a(298),db=a(811);class Wb{constructor(kb){this.mf=
kb}jSi(kb,Xb,sc,Rc,Zc,Id){const Td=this.mf.Eq(sc+".png");sc=ca.e(sc,Rc);return ca.c(kb,Xb,sc,Td,32===kb&&32===Xb?"cui-img-cont-float cui-img-32by32":"cui-img-cont-float cui-img-16by16","",!1,Zc,null,Id)}}Object(d.a)(Wb,"ShapeGlyphImageFactory",null,[528]);var Jc=a(1128);class jd{constructor(kb,Xb){this.rRh=this.G8a=null;this.Xak=this.egm=0;this.kj=kb;this.Oc=Xb}dispose(){this.clear();this.G8a.parentNode.removeChild(this.G8a)}add(kb,Xb){this.y$k(!1);kb=this.TTm(kb,Xb);this.fxn()||this.Nyn(kb)?this.x$k(-1*
(Math.ceil(kb.offsetWidth)+2)):this.x$k(this.Xak);this.y$k(!0)}clear(){this.kj.Ow(this.rRh);this.y$k(!1);this.x$k(0)}YTb(kb,Xb,sc){this.egm=sc;this.Xak=Xb;this.G8a=this.kj.kg();this.G8a.className="prFlyout UISmallFont";kb.appendChild(this.G8a);this.rRh=this.kj.pDc();this.G8a.appendChild(this.rRh)}TTm(kb,Xb){const sc=this.kj.MSi();sc.style.backgroundColor=kb;sc.style.lineHeight=this.kj.Zc(this.egm);this.kj.CB(sc,Xb);this.rRh.appendChild(sc);return sc}Nyn(kb){kb=this.kj.ji(kb,this.Oc.jd.hs);const Xb=
this.kj.ji(this.Oc.jd.hs,this.Oc.jd.hs);return kb.x+kb.width+this.Xak>Xb.x+Xb.width}fxn(){return 0>this.kj.Bo(this.G8a.style.left)}y$k(kb){this.G8a.style.visibility=kb?Lb.a.visible:Lb.a.hidden}x$k(kb){this.G8a.style.left=this.kj.Zc(kb)}}Object(d.a)(jd,"ShapePawnFlyout",null,[609]);var xd=a(1416),Ad=a(1643),de=a(1827),De=a(460),Le=a(123);class Xe{constructor(kb,Xb,sc,Rc,Zc){this.UDf=1;this.BNg=[];this.vfe=null;this.rsg=this.w0e=!1;this.jpd=this.Po=this.wU=null;(this.O5=e.AFrameworkApplication.ha.getBooleanAppSetting(Of.a.mBb))?
(this.Po=kb,this.jpd=Zc,this.g5m()):this.WO=Object(pc.a)(Jc.a,Rc.CUi(kb,Xb,sc,Object(H.a)(this,this.i0,"onPointerOver"),Object(H.a)(this,this.h0,"onPointerOut"),Zc))}hYa(){if(this.O5)return this.dkn();const kb=Array.clone(this.IKb);if(this.KXa){let Xb=!1;for(const sc of this.IKb)if(sc.clientId===this.KXa.clientId){Xb=!0;break}Xb||Array.add(kb,this.KXa)}return kb}dispose(){this.O5?this.F8m():(this.BNg=this.vfe=null,this.WO.dispose())}z2(kb){if(this.O5)this.KUm(kb);else if(kb){for(const Xb of this.IKb)if(Xb.clientId===
kb.clientId)return;Array.add(this.IKb,kb);this.refresh()}}rua(kb){if(this.O5)this.k6n(kb);else if(kb)for(const Xb of this.IKb)if(Xb.clientId===kb.clientId){Array.remove(this.IKb,Xb);this.refresh();break}}clear(){this.O5?this.N0m():(this.BNg=[],this.WO.clear())}get KXa(){return this.vfe}set KXa(kb){this.vfe!==kb&&(this.vfe=kb,this.vfe||(this.rsg=!1),this.O5||this.refresh())}Yil(){this.O5||(this.KXa?(this.rsg=!0,this.o4e()):m.a.$(22675491,828,10,"ShapePresencePawn.ShowEditorFlyout: Trying to show editing flyout when current editor is null"))}cAm(){this.O5?
this.Zeo():(this.w0e=!0,this.vfe&&(this.rsg=!0),this.o4e())}X6l(){this.O5?this.Uqn():(this.w0e=!1,this.o4e())}setZIndex(kb){this.O5?this.qco(kb):this.WO.setZIndex(kb)}get qKb(){return this.KXa?this.KXa.color:this.IKb&&this.IKb.length?this.IKb[this.IKb.length-1].color:Le.a.none}TMh(){return!!this.vfe||0<this.BNg.length}get IKb(){return this.O5?this.wU.E3e:this.BNg}Pqn(){this.WO.Y4e();this.WO.IUe()}h0(){this.TMh()&&(this.w0e=!1,this.o4e());return!0}i0(){this.TMh()&&(this.w0e=!0,this.o4e());return!0}amo(){this.TMh()?
this.WO.JZh(1<this.BNg.length?"MoreUsersGlyph_16x16x32":"SingleCollabUserGlyph_16x16x32",this.qKb):this.WO.vkc()}refresh(){this.amo();this.o4e()}o4e(){this.Pqn();if(this.w0e)if(this.KXa){this.WO.tJd(this.KXa.color,String.format(ResourceStrings.l_TypingHint,this.KXa.userName));for(const kb of this.IKb)this.KXa.clientId!==kb.clientId&&this.WO.tJd(kb.color,kb.userName)}else for(const kb of this.IKb)this.WO.tJd(kb.color,kb.userName);else this.rsg&&(this.KXa?this.WO.tJd(this.KXa.color,String.format(ResourceStrings.l_TypingHint,
this.KXa.userName)):m.a.$(42472531,828,10,"ShapePresencePawn.RefreshFlyout: Trying to show editing flyout when current editor is null"));(this.w0e||this.rsg)&&this.WO.OUg()}cIe(kb,Xb){this.wU&&this.wU.cIe(kb,Xb)}F8m(){this.wU&&this.wU.dispose()}ILk(){return Ia.a.ji(document.body)}KUm(kb){kb?this.wU?(m.a.$(42472535,814,50,"ShapePresencePawn:AddUser at PresencePawn for ClientId { presenceUser.ClientId}",kb.clientId),this.wU.z2(kb)):m.a.$(42472533,814,10,"ShapePresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {presenceUser.ClientId}"):
m.a.$(50340754,814,10,"ShapePresencePawn:AddUser - user is null, skipping AddUser")}k6n(kb){kb?this.wU?(m.a.$(42472539,814,50,"ShapePresencePawn:RemoveUser at PresencePawn for ClientId { presenceUser.ClientId}",kb.clientId),this.wU.rua(kb.clientId)):m.a.$(42472537,814,15,"ShapePresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser {presenceUser.ClientId}"):m.a.$(50340758,814,15,"ShapePresencePawn:RemoveUser - user is null, skipping RemoveUser")}N0m(){if(this.wU){m.a.$(42472543,814,
50,"ShapePresencePawn:Clear at PresencePawn ");var kb=this.hYa();if(kb)for(const Xb of kb)this.rua(Xb);else m.a.$(42472545,814,50,"ShapePresencePawn:Clear - Pawn has no users")}else m.a.$(42472541,814,15,"ShapePresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}dkn(){return this.wU?this.wU.E3e:null}Zeo(){this.wU&&(this.wU.ALb(),this.wU.Soc())}Uqn(){this.wU&&this.wU.ALb()}qco(kb){this.Po.style.zIndex=String(kb)}Tmn(kb){const Xb=new Ad.a;Xb.add(0,ca.e(e.AFrameworkApplication.IJ,
"MoreUsersGlyph_16x16x32"));Xb.add(5,e.AFrameworkApplication.Ln);Xb.add(1,ca.e(e.AFrameworkApplication.IJ,"DoughboyWhiteGlyph_20x20x32"));Xb.add(4,e.AFrameworkApplication.Ln);Xb.add(6,20);Xb.add(8,e.AFrameworkApplication.isRtl);Xb.add(12,kb);Xb.add(11,!1);Xb.add(16,Object(H.a)(this,this.ILk,"presenceViewportBoundsCallback"));return new de.a(Xb)}g5m(){this.wU=this.Tmn(this.o3l()).YKf(this.Po);Sys.UI.DomElement.addCssClass(this.wU.element,"ShapePawnContainer")}b1m(){const kb=this.hYa();if(kb)for(const Xb of kb)this.cIe(Xb.clientId,
!1)}o3l(){return this.UDf+De.a.Dva+De.a.Dva}OUg(){this.jpd.va.style.zIndex=String(this.o3l())}}Object(d.a)(Xe,"ShapePresencePawn",null,[598,599,40,526]);var ie=a(1415);class If{constructor(kb,Xb,sc,Rc,Zc){this.dD=kb;this.kf=Xb;this.kj=sc;this.JYc=Rc;this.Oc=Zc}x5m(kb,Xb,sc,Rc){this.kj.addCssClass(kb,"ShapeModernCatchupPawnContainer");return new ie.a(kb,Xb,"pegal",this,sc,Rc)}w5m(kb,Xb,sc){this.kj.addCssClass(kb,"ShapePawnContainer");return new Xe(kb,Xb,"per",this,sc)}CUi(kb,Xb,sc,Rc,Zc,Id){return new Jc.a(kb,
Xb,sc,Rc,Zc,null,this,this.JYc,this.kj,this.dD,this.kf,Id)}aXl(){return new jd(this.kj,this.Oc)}bXl(){return new xd.a(this.kj)}}Object(d.a)(If,"ShapePawnFactory",null,[527]);var qf=a(654),lf=a(145),qe=a(194),Ne=a(1023),pe=a(167),Wf=a(202),ye=a(212),Xf=a(211),uh=a(1231),fg=a(189);class pg{constructor(kb,Xb,sc,Rc,Zc,Id,Td,he,be=16){var Ue;this.ufm=!1;this.fq=null;this.Oke=!1;this.nc=null;this.kh=!1;this.Yn=(cf,mf)=>{var ig,ug;cf=null;mf&&mf.FB&&(cf=mf.FB.Ed);cf&&(null===(ig=cf.fc)||void 0===ig?0:ig.equals(null===
(ug=this.ta)||void 0===ug?void 0:ug.slideId))&&this.h1i()};this.QTg=this.XB=this.WB=0;this.ef=1;this.mvg=!1;this.pc=this.Nqg=!0;this.wR=!1;this.P5=!0;this.Ubk=!1;this.nRa=be;this.MYc=new pe.a;this.b8a=new ye.a;this.m1=new Wf.a;this.gka=new Wf.a;this.Bna=new Wf.a;this.SIa=new pe.a;this.RF=new Xf.a;this.Gx=new Xf.a;this.rb=kb;this.WO=Xb?Xb(this.SIa.va,this.nRa,Zc):null;this.ta=sc;this.w8a=Rc;this.nc=Id;this.od=Td;(this.kh=null===he||void 0===he?void 0:he.getBooleanAppSetting(uh.a.EJ))&&this.nc.PXa&&
(null===(Ue=this.od)||void 0===Ue?void 0:Ue.mXa(this.Yn))}dispose(){var kb;this.w8a();this.MYc&&(this.MYc.va.parentNode&&this.MYc.Or(),this.b8a&&this.b8a.viewport&&this.b8a.viewport.Or(),this.m1&&this.m1.Or(),this.gka&&this.gka.Or(),this.Bna&&this.gka.Or());this.kh&&this.nc.PXa&&(null===(kb=this.od)||void 0===kb?void 0:kb.cLb(this.Yn));this.WO&&this.WO.dispose();this.SIa=this.Bna=this.gka=this.m1=this.b8a=this.MYc=null;this.pc=!1}get hzm(){return this.WO}get shape(){return this.ta}get a9d(){return this.ufm}set a9d(kb){this.nRa=
kb?20:16;this.ufm=kb}get c$l(){return this.Oke}set c$l(kb){this.nRa=16;this.Oke=kb}Yq(kb){this.MYc.appendChild(this.b8a.viewport);this.MYc.appendChild(this.SIa);this.m1.eP(Le.a.none);this.Oke?this.Hx(this.m1,Bd.a.j_h):this.Hx(this.m1,Bd.a.k_h);this.gka.eP(Le.a.none);this.Hx(this.gka,Ne.a.NIf);this.Bna.eP(Le.a.none);this.Hx(this.Bna,Ne.a.KHh);this.b8a.appendChild(this.Bna);this.b8a.appendChild(this.gka);this.b8a.appendChild(this.m1);this.setVisibility();this.h1i();kb.appendChild(this.MYc)}NT(){}zu(){return this.b8a.zu()}d1b(){return!1}vE(){}setVisibility(){const kb=
this.pc&&(!this.wR||!this.P5);this.SIa.oe(kb);this.m1.oe(kb);this.gka.oe(kb);this.Bna.oe(kb);this.MYc.oe(this.pc)}tH(){}pR(){return null}DM(){return[]}h1i(){this.fq=this.ta.ju.copy();this.Hx(this.m1,this.Ubk?Ne.a.dMi:this.Oke?Bd.a.j_h:Bd.a.k_h);this.Hx(this.gka,Ne.a.NIf);this.Hx(this.Bna,Ne.a.KHh);this.WC();this.setVisibility()}draw(){this.visible=!0;this.h1i()}get visible(){return this.pc}set visible(kb){this.pc!==kb&&(this.pc=kb,this.setVisibility(),this.WC())}get mUe(){return this.Nqg}set mUe(kb){this.Nqg=
kb;this.m1.oe(this.pc&&this.Nqg);this.gka.oe(this.pc&&this.Nqg);this.Bna.oe(this.pc&&this.Nqg)}setPosition(kb,Xb){this.WB=kb;this.XB=Xb;this.WC()}qj(kb){this.ef=kb;this.WC()}Ov(kb){this.RF=kb;this.WC()}SA(kb){this.Gx=kb;this.WC()}setZIndex(kb){this.QTg=kb;this.MYc.NH(this.QTg);this.b8a.NH(this.QTg);this.SIa.NH(this.QTg);this.WO&&this.WO.setZIndex(this.QTg)}ER(kb,Xb){this.wR=kb;this.P5=Xb;this.setVisibility()}M7e(kb=null){this.WO&&this.m1.PC(kb||this.WO.qKb);this.m1&&(this.m1.Kua(""),this.m1.eP(Le.a.none),
this.Oke?this.Hx(this.m1,Bd.a.j_h):this.Hx(this.m1,Bd.a.k_h),this.m1.S4(""))}K0m(){this.m1&&this.gka&&this.Bna&&(this.Ubk=!1,this.m1.S4(""),this.gka.S4(""),this.m1.PC(Le.a.none),this.m1.vLb(0),this.gka.PC(Le.a.none),this.gka.vLb(0),this.Bna.PC(Le.a.none),this.Bna.vLb(0))}uyl(kb,Xb=!1){if(this.m1&&this.gka&&this.Bna){this.Ubk=!0;var sc=0===kb;this.Hx(this.m1,Ne.a.dMi);this.Hx(this.gka,2===kb?Ne.a.aVl:Ne.a.NIf);this.Hx(this.Bna,Ne.a.KHh);this.m1.PC(sc?Le.a.none:Ne.a.ZUl);this.gka.PC(sc?Le.a.none:Ne.a.VUl);
switch(kb){case 2:this.Bna.PC(Ne.a.YUl);break;case 1:this.Bna.PC(Ne.a.WUl);break;default:this.Bna.PC(Ne.a.XUl)}1===kb?this.d0l():Xb?this.d0l():(this.m1.vLb(1),this.gka.vLb(1),this.Bna.vLb(1))}}d0l(){this.e0l(0)}e0l(kb){this.m1&&this.gka&&this.Bna&&!(1<kb)&&(kb+=.05,this.m1.vLb(kb),this.gka.vLb(kb),this.Bna.vLb(kb),window.setTimeout(()=>{this.e0l(kb)},10))}Hx(kb,Xb){kb.Hx(Xb/this.nc.$F)}WC(){if(this.fq){var kb=this.fq.copy();this.RF.yl(kb);this.Gx.yl(kb);kb.move(this.WB,this.XB);kb.scale(this.ef,this.ef);
this.Hlo(kb);this.qmo(kb)}}Hlo(kb){if(this.m1&&this.gka&&this.Bna&&kb){var Xb=this.mTl(Ne.a.$Ul,kb),sc=this.mTl(Ne.a.NIf,Xb);this.Bna.py(sc.points);this.b8a.kn();this.Bna.oe(this.pc&&(!this.wR||!this.P5));this.gka.py(Xb.points);this.b8a.kn();this.gka.oe(this.pc&&(!this.wR||!this.P5));this.m1.py(kb.points);this.b8a.kn();this.m1.oe(this.pc&&(!this.wR||!this.P5));E.a.xgb&&this.ta&&this.ta.gd&&this.rb.MYe()&&this.b8a.viewport.zh(this.b8a.viewport.width,0)}}eWg(){if(this.a9d){var kb=this.SIa.x,Xb=this.SIa.y,
sc=18/this.nc.$F;this.rb.G3(this.ta)&&!this.mvg&&(fg.a.Gj&&Object(n.a)("ShiftPawnDivForTableOneClickUI")&&this.ta.gd?this.SIa.setPosition(kb+5,Xb-sc):this.SIa.setPosition(kb,Xb-sc),this.mvg=!0)}}Wsk(){if(this.a9d){var kb=this.SIa.x,Xb=this.SIa.y,sc=18/this.nc.$F;this.mvg&&!this.rb.G3(this.ta)&&(fg.a.Gj&&Object(n.a)("ShiftPawnDivForTableOneClickUI")&&this.ta.gd?this.SIa.setPosition(kb-5,Xb+sc):this.SIa.setPosition(kb,Xb+sc),this.mvg=!1)}}mTl(kb,Xb){var sc=Xb.Pj(qe.a.rY),Rc=Xb.Pj(qe.a.fD);sc=qf.a.$O(xa.a.sH(Rc,
sc));new xa.a(0,0);new xa.a(0,0);let Zc;new xa.a(0,0);new xa.a(0,0);var Id=kb/this.nc.$F;Xb.rotate(-sc);const Td=Xb.points;kb=new xa.a(Td[0]._x+Id,Td[0]._y+Id);Rc=new xa.a(Td[1]._x-Id,Td[1]._y+Id);Zc=new xa.a(Td[2]._x-Id,Td[2]._y-Id);Id=new xa.a(Td[3]._x+Id,Td[3]._y-Id);kb=new lf.a(kb,Rc,Zc,Id);kb.rotate(sc);Xb.rotate(sc);return kb}qmo(kb){if(kb){var Xb=kb.Pj(qe.a.rY),sc=kb.Pj(qe.a.fD),Rc=qf.a.$O(xa.a.sH(sc,Xb));Xb=kb.Pj(qe.a.rY);sc=kb.Pj(qe.a.fD);90<=Rc&&(Xb=kb.Pj(qe.a.fD),sc=kb.Pj(qe.a.E1));180<=
Rc&&(Xb=kb.Pj(qe.a.E1),sc=kb.Pj(qe.a.JU));270<=Rc&&(Xb=kb.Pj(qe.a.JU),sc=kb.Pj(qe.a.rY));Rc=xa.a.sH(sc,Xb);var Zc=this.Njn(Rc);kb=Math.cos(Rc)*Zc;Rc=Math.sin(Rc)*Zc;Zc=this.a9d?this.nRa/2-1:this.Oke?this.nRa/2:this.nRa;this.SIa.va.style.transform=`scale(${1/this.nc.$F})`;this.Oke?this.SIa.setPosition(sc.x-Zc,sc.y-Zc):fg.a.Gj&&Object(n.a)("ShiftPawnDivForTableOneClickUI")&&this.ta.gd?this.SIa.setPosition(Xb.x-kb+10,Xb.y-Rc-Zc):this.SIa.setPosition(Xb.x-kb,Xb.y-Rc-Zc);this.SIa.oe(this.pc&&(!this.wR||
!this.P5));this.a9d&&(this.mvg=!1,this.eWg())}}Njn(kb){return(this.a9d?10:15)-qf.a.$O(kb)/6}}Object(d.a)(pg,"ShapePawnView",null,[597]);class Kf{DUi(kb,Xb,sc,Rc,Zc,Id,Td,he){return new pg(kb,Xb,sc,Rc,Zc,Id,Td,he,16)}}Object(d.a)(Kf,"ShapePawnViewFactory",null,[529]);class hh extends Sys.EventArgs{constructor(kb){super();this.shape=kb}}Object(d.a)(hh,"ShapeViewElementPresenceStateChangedEventArgs",Sys.EventArgs,[]);class zh{constructor(kb,Xb){this.Np=kb;this.ta=this.Np.shape;this.ta.EG=!1;this.Rcm=
new hh(this.ta);this.Fx=Object(pc.a)(Xe,this.Np.hzm);this.Him=Xb;(this.Zdm=e.AFrameworkApplication.ha.getBooleanAppSetting(Of.a.mBb))&&this.Np&&(this.Np.a9d=!0)}Yq(kb){this.Np.Yq(kb)}NT(kb){this.Np.NT(kb)}zu(){return this.Np.zu()}k1(kb){return this.Np.d1b(kb)}vE(kb){this.Np.vE(kb)}eWg(){this.Np.eWg()}Wsk(){this.Np.Wsk()}dispose(){this.Np.dispose()}tH(){this.Np.tH()}pR(kb){return this.Np.pR(kb)}DM(kb){return this.Np.DM(kb)}draw(kb,Xb){this.Np.draw(kb,Xb)}get visible(){return this.Np.visible}set visible(kb){this.Np.visible=
kb}setPosition(kb,Xb){this.Np.setPosition(kb,Xb)}qj(kb){this.Np.qj(kb)}Ov(kb){this.Np.Ov(kb)}SA(kb){this.Np.SA(kb)}setZIndex(kb){this.Np.setZIndex(kb)}ER(kb,Xb){this.Np.ER(kb,Xb)}setSelection(){}KSb(kb){kb&&(this.Kid(),this.Fx.z2(kb),this.Np.M7e(),this.Np.setVisibility(),m.a.$(22675524,814,50,"ShapePresenceView::AddPresence; Added User: {0}; Pawn and Border Color: {1}; shape: {2}",kb.clientId,this.Fx.qKb,this.ta?this.ta.om:"null_moniker"))}Qrd(kb){if(kb&&this.Fx){this.Fx.rua(kb);this.Np.M7e();var Xb=
this.Fx.hYa();Xb&&Xb.length?m.a.$(22675528,814,50,"ShapePresenceView::RemovePresence - Remove user from shape presence view; User: {0}, Current Pawn and Border color: {1}; shape: {2}",kb.clientId,this.Fx.qKb,this.ta?this.ta.om:""):m.a.$(22675526,814,50,"ShapePresenceView::RemovePresence - Removed last user, removed pawn and border, User: {0}, shape: {1}",kb.clientId,this.ta?this.ta.om:"null_moniker");this.Np.setVisibility();this.Tyc()}}uUl(){this.Fx.clear();this.Np.M7e();this.Tyc()}Yil(){this.Fx.Yil()}Wdo(){this.Fx.cAm()}d0b(){this.Fx.X6l()}h2h(kb){kb&&
this.Kid();this.Fx&&(this.Fx.KXa=kb);this.Np.M7e();this.Zdm&&this.Fx&&(this.Fx.KXa?this.Fx.cIe(kb.clientId,!0):this.Fx.b1m());kb||this.Tyc()}get HKb(){return this.Fx}get SDj(){return this.Fx.TMh()}get mUe(){return this.Np.mUe}set mUe(kb){this.Np.mUe=kb}Kid(){this.ta.EG||this.SDj||(this.ta.EG=!0,this.Him.bRk(this.Rcm))}Tyc(){this.ta.EG&&!this.SDj&&(this.ta.EG=!1,this.Him.bRk(this.Rcm))}}Object(d.a)(zh,"ShapePresenceView",null,[557,558,267,40]);var cg=a(575);class le{get name(){return"PowerPointWebEditor.ShapePresence"}oc(kb){kb.register(525,
"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>").oa().pa(()=>new cg.a((Xb,sc)=>{let Rc=null;const Zc=Object(pc.a)(112,Xb.yc(kb.resolve("Box4.IPageView").Ua));Zc&&!Zc.isDisposed&&(Xb=kb.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").DUi(kb.resolve("PowerPointWebEditor.IPptSelectionManager"),(Id,Td,he)=>Object(pc.a)(526,kb.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").w5m(Id,Td,he)),Xb,sc,Zc.Cua,kb.resolve("PowerPointWebEditor.IZoomContext"),
kb.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),kb.resolve("PowerPointWebEditor.IApplicationSettings")),Rc=new zh(Xb,kb.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier")),Rc.Yq(Zc.Cua),Zc.uHb(Rc,1),Rc.visible=Zc.oM||Zc.vp);return Rc}));kb.register(527,"PowerPointWebEditor.ShapePresence.IShapePawnFactory").oa().pa(()=>new If(kb.resolve("Common.IPointerInputManager"),kb.resolve("Common.IClickInputManager"),kb.resolve("PowerPoint.IBrowserHelperManager"),kb.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),
kb.resolve("PowerPointWebEditor.IActiveSlideViewManager")));kb.register(528,"PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory").oa().pa(()=>new Wb(kb.resolve("PowerPoint.IPathManager")));kb.register(529,"PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").oa().pa(()=>new Kf)}init(){}dispose(){}static main(){h.a.instance.Jc(new le)}}Object(d.a)(le,"PPTWebEditorShapePresencePackage",null,[4,5]);class ke{constructor(){this.ga=null;this.Vfa=[new le]}get name(){return"PowerPointWebEditor.ExtCommonPackage"}oc(kb){this.ga=
kb;for(const Xb of this.Vfa)Xb.oc(kb)}init(){for(const kb of this.Vfa)kb.init();this.ga.resolve("PowerPointWebEditor.IAppBootCompletedListener").yOh=!0;Nc.a.instance.mc(db.a.SJh,(new Date).getTime())}dispose(){}static main(){Nc.a.instance.mc(db.a.TJh,(new Date).getTime());h.a.instance.Jc(new ke)}}Object(d.a)(ke,"PptExtCommonPackage",null,[4,5]);var ag=a(848),Ef=a(1242);class lg{constructor(kb){m.a.$(508065505,830,50,"TransitionPreviewResourceProvider: creating new provider ");this.QN=kb;this.presInfoAndSlideInfo=
new Hf(this.QN.presInfoAndSlideInfo,this.Sim);this.presInfo=this.QN.presInfo;this.slideInfo=new Hf(this.QN.slideInfo,this.Sim);this.slide=this.QN.slide;this.slideViewData=this.QN.slideViewData;this.shapeViewData=this.QN.shapeViewData;this.imageData=this.QN.imageData;this.localizedString=this.QN.localizedString}invalidateSlideAsync(kb,Xb){return this.QN.invalidateSlideAsync(kb,Xb)}resetProviders(){this.QN.resetProviders()}updatePodsProxy(kb){this.QN.updatePodsProxy(kb)}isSlideCached(kb){return this.QN.isSlideCached(kb)}Sim(kb){kb.SlideShowInfo&&
0<kb.SlideShowInfo.sld.length&&kb.SlideShowInfo.sld[0].animLst&&kb.SlideShowInfo.sld[0].animLst.anim&&(kb.SlideShowInfo.sld[0].animLst.anim=[]);return kb}}Object(d.a)(lg,"TransitionPreviewResourceProvider",null,[692]);class Hf{constructor(kb,Xb){this.fpd=kb;this.vFn=Xb;this.events=this.fpd.events;this.policy=this.fpd.policy}load(kb,Xb){return Object(x.b)(this,void 0,void 0,function*(){const sc=yield this.fpd.load(kb,Xb);sc.resource&&(m.a.$(508065504,830,50,`TransitionPreviewResourceProvide: mapping result.resource in load method for resourceId ${kb}`),
sc.resource=this.vFn(sc.resource));return sc})}add(kb){return this.fpd.add(kb)}remove(kb,Xb){return this.fpd.remove(kb,Xb)}getAllLoadResultsInCache(){return this.fpd.getAllLoadResultsInCache()}getLoadResultsInCache(kb){return this.fpd.getLoadResultsInCache(kb)}getLoadResultInCache(kb,Xb){return this.fpd.getLoadResultInCache(kb,Xb)}}Object(d.a)(Hf,"PreviewResourceProvider",null,[693]);var Lg=a(1243);class Vg extends Sys.EventArgs{constructor(kb,Xb){super();this.LWm=kb;this.e1m=Xb}}Object(d.a)(Vg,"OnAnimationTimelineChangedEventArgs",
Sys.EventArgs,[]);class uf{constructor(kb,Xb,sc,Rc,Zc,Id){this.whb=this.Jg=null;this.Gfm=!1;this.ga=this.ap=null;this.GH=new yc.a;this.xa=new kc.a;this.Tde=[];this.Nnd=null;this.yyj=Td=>{if("Escape"===Td.key||"Esc"===Td.key||27===Td.keyCode)m.a.$(508043427,830,50,"PreviewFrame - Exiting Preview for Esc key [previewId: {0}]",this.uQ),this.exit()};this.vTm=()=>{document.getElementById("tabbedTaskPaneContainer")&&I.a.addHandler(document.getElementById("tabbedTaskPaneContainer"),O.a.mouseDown,this.fWe);
document.getElementById("tabStripFocusZone")&&I.a.addHandler(document.getElementById("tabStripFocusZone"),O.a.mouseDown,this.fWe)};this.R5n=()=>{document.getElementById("tabbedTaskPaneContainer")&&I.a.removeHandler(document.getElementById("tabbedTaskPaneContainer"),O.a.mouseDown,this.fWe);document.getElementById("tabStripFocusZone")&&I.a.removeHandler(document.getElementById("tabStripFocusZone"),O.a.mouseDown,this.fWe)};this.fWe=()=>{m.a.$(508043417,830,50,"PreviewFrame - Exiting preview on far pane interaction [previewId: {0}]",
this.uQ);this.exit()};this.wWe=()=>{m.a.$(508043416,830,50,"PreviewFrame - Focussing on preview container [previewId: {0}]",this.uQ);this.ga.focus()};if(!Id)throw Error.argumentNull("slideShowCoreHelper");this.Kf=kb;this.na=Xb;this.Iy=Rc;this.mf=sc;this.Ina=Id;this.zDg=()=>{m.a.$(508043457,830,50,"PreviewFrame - Exiting preview on completion [previewId: {0}]",this.uQ);this.exit()};this.Nnd=Zc}QLk(kb,Xb,sc,Rc,Zc){return Object(x.b)(this,void 0,void 0,function*(){this.uQ=Rc;m.a.$(508043456,830,50,"PreviewFrame - Beginning Animation Preview [previewId: {0}]",
this.uQ);const Id=uf.lU();if(yield this.j_l())this.Tde=[],this.Tde.push({["timelineId"]:"0_anim",["step"]:-1,["sid"]:-1}),this.ap.addEventListener("keydown",this.yyj),yield this.vBm(kb,Xb,Id,sc,"ap",Zc),this.Nnd.abd(0,!1,!1),this.Jg.events.on("slideLocationChanging",this.zDg),this.Jg.events.on("slideLocationChanged",this.zDg),this.bTm(),this.Pyl(Xb+1),this.Gzm(),this.nqd()})}XLk(kb,Xb,sc,Rc,Zc,Id,Td){return Object(x.b)(this,void 0,void 0,function*(){this.uQ=Id;m.a.$(508043426,830,50,"PreviewFrame - Beginning Transition Preview [previewId: {0}]",
this.uQ);var he=uf.lU();if(yield this.j_l()){var be=new lg(Zc);this.vTm();this.Pyl(Rc+1);this.ap.addEventListener("keydown",this.yyj);yield this.vBm(kb,Xb,he,be,"tp",Td);this.Gzm();he={["actionContext"]:{["navigationType"]:"next",["bootMetrics"]:{sr:"tp",startFromTime:he}},["fSkipTransition"]:!1};this.na.getBooleanAppSetting("EnsureNavigationStateConsistency")&&(he.fClearNavigationState=!0);this.Jg.events.on("slideLocationChanged",this.zDg);m.a.$(508043425,830,50,"PreviewFrame - Initiating gotoSlide to play transition [previewId: {0}]",
this.uQ);yield this.Jg.gotoSlide(uf.getSlideLocation(sc,Rc),he)}})}j_l(){return Object(x.b)(this,void 0,void 0,function*(){var kb=Object(n.a)("AddPreviewFlowAdjustments")&&this.Gfm;this.whb&&!kb&&(kb=uf.lU(),yield this.whb,m.a.$(508086161,830,15,"PreviewFrame - awaited SlideShowCore init for: {0} [previewId: {1}]",uf.lU()-kb,this.uQ));if(!this.Jg)return m.a.$(508086160,830,10,"PreviewFrame - SlideShowCore is undefined [previewId: {0}]",this.uQ),!1;yield this.Jg.refreshViewControllerSSC();m.a.$(508043424,
830,50,"PreviewFrame - Refreshed ViewController [previewId: {0}]",this.uQ);return!0})}vBm(kb,Xb,sc,Rc,Zc,Id){return Object(x.b)(this,void 0,void 0,function*(){m.a.$(508043423,830,50,"PreviewFrame - Starting SSC [previewId: {0}]",this.uQ);Object(n.a)("SelectiveResourceProviderUpdate")&&Id?yield this.Jg.updateResourceProviders(Rc,{shouldRerenderSlide:!0,startSlideIndex:Xb,skipPrefetchSlides:Object(n.a)("SkipPrefetchSlidesForUpdatingResourceProviders")}):Object(n.a)("SelectiveResourceProviderUpdate")||
(yield this.Jg.updateResourceProviders(Rc,{shouldRerenderSlide:!0,startSlideIndex:Xb,skipPrefetchSlides:Object(n.a)("SkipPrefetchSlidesForUpdatingResourceProviders")}));m.a.$(508043422,830,50,"PreviewFrame - Updated Resource Providers in SSC [previewId: {0}]",this.uQ);const Td={["actionContext"]:{["navigationType"]:"init",["startFromTime"]:sc,["bootMetrics"]:{sr:Zc,startFromTime:sc}},["fSkipTransition"]:!0};this.na.getBooleanAppSetting("EnsureNavigationStateConsistency")&&(Td.fClearNavigationState=
!0);this.na.getBooleanAppSetting("EnsureNavigationStateConsistency")||this.Jg.clearNavigationState();yield this.Jg.gotoSlide(uf.getSlideLocation(kb,Xb),Td);m.a.$(508043421,830,50,"PreviewFrame - gotoSlide complete [previewId: {0}]",this.uQ);this.xa.raiseEvent("PreviewStart");m.a.$(508086159,830,15,"PreviewFrame - Started slideshow for preview. slideId: {0}, slideIndex: {1} [previewId: {2}]",kb,Xb,this.uQ)})}init(kb,Xb){return Object(x.b)(this,void 0,void 0,function*(){if(this.ap)m.a.$(508086158,830,
50,"PreviewFrame - init called again: {0}",this.whb),yield this.whb;else{this.ap=document.createElement("div");this.ap.id="PreviewBackground";this.ap.className="PreviewBackground";this.ap.style.visibility=Qa.a.ht;this.ap.tabIndex=-1;this.ga=document.createElement("div");this.ga.id="PreviewContainer";this.ga.className="PreviewContainer";this.ga.tabIndex=-1;this.ga.style.width="100%";this.ga.style.height="100%";this.ga.style.top="0px";this.ap.appendChild(this.ga);this.Kf.appendChild(this.ap);var sc=
this.na.Ma("pptSlideShowCoreCssUrl"),Rc=document.createElement("link");Rc.setAttribute("rel","stylesheet");Rc.setAttribute("type","text/css");Rc.setAttribute("href",sc);this.ga.appendChild(Rc);Object(n.a)("DisablePreviewInSvgMode")&&this.Ina.$wa||(yield this.R4d(kb,Xb))}})}R4d(kb,Xb){return Object(x.b)(this,void 0,void 0,function*(){const sc={};sc.initTime=uf.lU();sc.uiHost="Unified App";sc.serverUrl=Q.a.yj(this.na.ym);sc.userSessionId=kb;sc.jsScriptsBasePath=this.na.Ma("StaticContentHost")+"pptscripts/ssapp/";
sc.fileHost=this.na.Ma("FileHost");sc.isRtl=e.AFrameworkApplication.isRtl;sc.applicationLcid=e.AFrameworkApplication.lcid;sc.applicationLocaleName=e.AFrameworkApplication.uiCulture;sc.areThirdPartyAddInsAllowed=e.AFrameworkApplication.jMa;sc.theWsaClient=e.AFrameworkApplication.Di;sc.appForOfficeContextActivationParameters=ag.a.pXe(this.mf);sc.hubbleVideoEndpoint=this.na.ZIb;sc.acceptLanguage=e.AFrameworkApplication.uiCulture;sc.appForOfficeAuthFactory=new Ef.a;const Rc={};Rc.settings=this.Iy;Rc.transitionResourceCDNPath=
this.na.DIh;Rc.transitionDisabledList=this.na.eWa;Rc.clickTargetEnabled=!0;Rc.mediaEnabled=!0;Rc.gifEnabled=!0;Rc.convertGifToVideo=!0;Rc.crossSlideAudioEnabled=!0;Rc.editAudioEnabled=this.na.getBooleanAppSetting("PPTOAudioPlaybackOptionsEnabled");Rc.flipgridVideoEnabled=this.na.getBooleanAppSetting("PptModernSlideShowFlipgridVideoEnabled");Rc.useNewYoutubePlayer=!0;Rc.useNewVimeoPlayer=!0;Rc.useOnlineVideoPlayer=!0;Rc.tedVideoEnabled=this.na.getBooleanAppSetting("PptModernSlideShowTEDVideoEnabled");
Rc.isStream2Enabled=!0;Rc.endOfShowText=ResourceStrings.l_EndOfSlideShowMessage;Rc.enableSVGAsWebGLTexture=!E.a.Yf&&this.na.getBooleanAppSetting("SlideShowShapeBuilderSVGEnabled");Rc.maxSvgTextureSize=this.na.Ac("ShapeBuilderMaxSvgTextureSize",2048);Rc.enableSlideSizeAdjust=this.na.getBooleanAppSetting("EnableSlideSizeAdjust");Rc.slideSizeMax={["x"]:this.na.Ac("SlideShowMaxWidth",1504),["y"]:this.na.Ac("SlideShowMaxHeight",849)};Rc.slideSizeMin={["x"]:this.na.Ac("SlideShowMinWidth",348),["y"]:this.na.Ac("SlideShowMinHeight",
261)};Rc.slideSizeDefault={["x"]:this.na.Ac("SlideShowDefaultWidth",1504),["y"]:this.na.Ac("SlideShowDefaultHeight",849)};Rc.streamVideoUseThinEmbed=this.na.getBooleanAppSetting("StreamVideoUseThinEmbed");Rc.slideMetadataEnabled=this.na.getBooleanAppSetting("PptModernSlideShowSlideMetadataEnabled");Rc.disabledChangeGates=this.na.Ma("PPTDisabledChangeGates");Rc.isMultiSlideshowcoreEnabled=this.na.getBooleanAppSetting("MultiSlideshowcoreEnabled");Rc.combineBootRequest=!0;Rc.localVideoTelemetryEnabled=
this.na.getBooleanAppSetting("IsGFXVideoLocalTelemetryEnabled");Rc.imageSettings={["imageAppendOption"]:"all"};Rc.SlideShowCacheRetentionExperimentEnabled=this.na.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled");const Zc={};Object(n.a)("addFlightToSSC")&&(Zc.verifyGlyphAsynchronously=e.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.verifyGlyphAsynchronously",!1));const Id={["slideShowCoreSettings"]:Rc,["appSettings"]:sc};Object(n.a)("addFlightToSSC")&&
(Id.flights=Zc);Object(n.a)("AddInstanceSourceIdentifier")?this.Jg=new SlideShowCore.SlideShowCore(this.ga,Xb,this.GH,Id,2):this.Jg=new SlideShowCore.SlideShowCore(this.ga,Xb,this.GH,Id);this.whb=this.Jg.init();this.Jg.events.on("blankSlideStateChanged",Td=>{"EndOfShow"==Td&&this.exit()});this.Jg.events.on("exitFromEndOfShow",()=>this.exit());this.Jg.events.on("animationStateChanged",()=>{this.nqd()});return new Promise(Td=>Object(x.b)(this,void 0,void 0,function*(){yield this.whb;new SlideShowCore.InputsAddon(this.Jg,
this.ga,e.AFrameworkApplication.isRtl);new SlideShowCore.AnimationLoggerAddon(this.Jg,Id,this.GH);new SlideShowCore.TransitionLoggerAddon(this.Jg,Id,this.GH);new SlideShowCore.PerfCheckerAddon(this.Jg,Id,this.GH);m.a.$(508086157,830,15,"PreviewFrame - initSlideShowCore finished");this.Gfm=!0;Td()}))})}nqd(){if(this.Jg&&this.ap&&this.ap.style.visibility!==Qa.a.ht){const kb=this.Jg.getSlideLocation();if(kb){const Xb=this.Jg.getAnimationState(!0),sc=Xb.timelineStates,Rc=[];for(let Zc=0;Zc<sc.length;Zc+=
1){Rc.push({["TimeLineId"]:sc[Zc].timelineId,["Step"]:sc[Zc].step,["LastClickTime"]:sc[Zc].lastClickTime,["StartTimeOffset"]:Xb.startTimeOffset});const Id=sc[Zc];this.Tde[Zc]?Id.step!=this.Tde[Zc].step&&(this.Tde[Zc].step=Id.step,this.xa.raiseEvent("AnimationPreview",new Vg(Zc,this.Tde[Zc].step))):this.Tde.push(Id)}this.xa.raiseEvent("OnPositionChangeEventId",new Lg.a({["SlideId"]:kb.slideId.sid,["SlideIndex"]:kb.slideIndex,["TimeLineMappings"]:Rc}));m.a.$(508043420,830,50,"PreviewFrame - Handled position change [previewId: {0}]",
this.uQ)}else m.a.$(508076692,830,10,"PreviewFrame - OnPositionChangedHandler: currentLocation is null [previewId: {0}]",this.uQ)}}Gzm(){this.ap&&(this.ap.style.visibility=Qa.a.xx,this.wWe());m.a.$(508043419,830,50,"PreviewFrame - Preview container visible [previewId: {0}]",this.uQ)}Rqn(){this.ap&&(this.ap.style.visibility=Qa.a.ht,this.ga.blur());m.a.$(508043418,830,50,"PreviewFrame - Preview container hidden [previewId: {0}]",this.uQ)}bTm(){document.addEventListener("click",this.wWe);document.getElementById("WACViewPanel").addEventListener("click",
this.wWe);document.getElementById("tabStripFocusZone")&&I.a.addHandler(document.getElementById("tabStripFocusZone"),O.a.mouseDown,this.fWe)}L5n(){document.removeEventListener("click",this.wWe);document.getElementById("WACViewPanel").removeEventListener("click",this.wWe);document.getElementById("tabStripFocusZone")&&I.a.removeHandler(document.getElementById("tabStripFocusZone"),O.a.mouseDown,this.fWe)}exit(){this.Jg&&(this.Jg.endSession(uf.lU()),this.Jg.events.off("slideLocationChanged",this.zDg),
this.Jg.events.off("slideLocationChanging",this.zDg),this.xa.raiseEvent("PreviewEnd"));this.ap.removeEventListener("keypress",this.yyj);this.R5n();this.L5n();this.Rqn()}static lU(){return Math.round(window.performance.now())}static getSlideLocation(kb,Xb){return{["slideId"]:{["sid"]:kb,["cid"]:0},["slideIndex"]:Xb-1}}Pyl(kb){const Xb=b(kb).style.display;b(kb).style.display="block";const sc=b(kb).getBoundingClientRect();b(kb).style.display=Xb;this.wWe();0!=sc.width&&0!=sc.height&&(this.ap.style.width=
sc.width+"px",this.ap.style.height=sc.height+"px",this.ap.style.left=sc.left+"px",this.ap.style.top=sc.top+"px")}pVm(kb){this.xa.addHandler("PreviewStart",()=>kb())}oVm(kb){this.xa.addHandler("PreviewEnd",()=>kb())}cVm(kb){this.xa.addHandler("AnimationPreview",kb)}}Object(d.a)(uf,"PreviewFrame",null,[509]);class dg extends Sys.EventArgs{constructor(kb){super();this.Tlc=!1;this.Tlc=kb}}Object(d.a)(dg,"PreviewStateEventArgs",Sys.EventArgs,[]);class Fg extends Sys.EventArgs{constructor(kb,Xb){super();
this.h9l=!1;this.h9l=kb;this.zlm=Xb}}Object(d.a)(Fg,"AnimationPreviewStartedStateEventArgs",Sys.EventArgs,[]);class Gh{constructor(kb,Xb,sc,Rc,Zc,Id,Td,he,be,Ue,cf){this.tsg=null;this.aSh=this.fle=!1;this.cZc=-1;this.u3b=this.Nnd=null;this.q0g=()=>{var mf;this.aSh=!0;try{null===(mf=this.tsg)||void 0===mf?void 0:mf.q0g(),m.a.$(508043464,830,50,"PreviewManager - Done handling preview load [previewId: {0}]",this.uQ)}catch(ig){m.a.$(508069957,830,10,"PreviewManager - Exception while handling preview load [previewId: {0}]: {1}",
this.uQ,ig)}};this.OVh=()=>{var mf;this.fle=!0;this.aSh=!1;this.VB.mXa(this.z6l);this.Xr.sLb(!0,!0);this.Oe.BQk(new dg(!0));this.Oqn();window.addEventListener("resize",this.C_l);try{null===(mf=this.tsg)||void 0===mf?void 0:mf.OVh(),m.a.$(508043463,830,50,"PreviewManager - Done handling preview start [previewId: {0}]",this.uQ)}catch(ig){m.a.$(508069956,830,10,"PreviewManager - Exception while handling preview start [previewId: {0}]: {1}",this.uQ,ig)}};this.NVh=()=>{var mf;this.Nnd.abd(0,!1,!0);this.fle=
!1;this.Oe.BQk(new dg(!1));this.VB.cLb(this.z6l);this.Xr.sLb(!1,!0);window.removeEventListener("resize",this.C_l);Object(n.a)("ShowCanvasLoadingSpinner")&&this.hideLoadingSpinner();this.blo();try{null===(mf=this.tsg)||void 0===mf?void 0:mf.NVh(),m.a.$(508043462,830,50,"PreviewManager - Done handling preview end [previewId: {0}]",this.uQ)}catch(ig){m.a.$(508069955,830,10,"PreviewManager - Exception while handling preview end [previewId: {0}]: {1}",this.uQ,ig)}this.uQ=void 0};this.z6l=()=>{!this.nc.pU&&
this.fle?(m.a.$(508043461,830,50,"PreviewManager - Ending preview on slide size change [previewId: {0}]",this.uQ),this.HJh()):this.nc.pU&&(m.a.$(508043460,830,50,"PreviewManager - Updating container on slide size change [previewId: {0}]",this.uQ),this.Ad.Pyl(this.cZc))};this.C_l=()=>{Object(n.a)("AddPreviewFlowAdjustments")?(m.a.$(508043459,830,50,"PreviewManager - Ending preview on window resize [previewId: {0}]",this.uQ),this.HJh()):this.la.Eb(Tb.a.Skc,2)};this.Ad=kb;this.POg=Xb;this.la=Rc;this.nc=
Id;this.Xb=Td;this.Oe=sc;this.VB=Zc;this.Xr=he;this.qDn=be;this.mHn=Ue;this.Ad.pVm(this.OVh);this.Ad.oVm(this.NVh);this.Nnd=cf}uun(kb,Xb,sc,Rc){Object(x.b)(this,void 0,void 0,function*(){this.POg.init(kb,Xb,sc,Rc);const Zc=yield this.POg.Woj([]);Object(n.a)("ShowCanvasLoadingSpinner")&&this.L4m();yield this.Ad.init(Xb,Zc)})}L4m(){Object(x.b)(this,void 0,void 0,function*(){this.u3b=document.createElement("div");this.u3b.id="canvas_loading_spinner";this.u3b.className="canvas_loading_spinner"})}QLk(kb,
Xb,sc,Rc){return Object(x.b)(this,void 0,void 0,function*(){this.Cym(sc);if(!this.Crm()){this.cZc=Xb;this.tsg=this.qDn;this.q0g();yield this.l$m();m.a.$(508043471,830,50,"PreviewManager - Animation Pane now open [previewId: {0}]",sc);yield this.WZl();m.a.$(508043470,830,50,"PreviewManager - Slide now zoomed to fit window [previewId: {0}]",sc);Object(n.a)("ShowCanvasLoadingSpinner")&&(this.showLoadingSpinner(b(Xb)),m.a.$(507901345,830,50,"PreviewManager - Unhide loading spinner [previewId: {0}]",sc));
var Zc=this.Xb.i1(kb),Id=!1;Object(n.a)("SelectiveResourceProviderUpdate")&&(Id=this.POg.w$l([[Zc.sid,Zc.cid]]));Zc=yield this.POg.Woj([[Zc.sid,Zc.cid]],sc);m.a.$(508043469,830,50,"PreviewManager - Fetched resource providers [previewId: {0}]",sc);yield this.Ad.QLk(kb,Xb-1,Zc,sc,Id||Rc);m.a.$(508077707,830,50,"PreviewManager - Started animation preview [previewId: {0}]",sc)}})}l$m(){return Object(x.b)(this,void 0,void 0,function*(){return new Promise(kb=>{this.Oe.aPk(new Fg(!0,Xb=>{m.a.$(508069958,
830,50,'PreviewManager - Action "{0}" processed for event [previewId: {1}]',Xb,this.uQ);"animationPaneOpened"==Xb&&kb()}))})})}WZl(){return Object(x.b)(this,void 0,void 0,function*(){if(this.nc.pU)m.a.$(508043468,830,50,"PreviewManager - Already zoomed to fit window [previewId: {0}]",this.uQ);else return new Promise(kb=>{const Xb=()=>{this.nc.pU&&(kb(),this.VB.cLb(Xb))};this.VB.mXa(Xb);m.a.$(508043467,830,50,"PreviewManager - Zooming to fit window [previewId: {0}]",this.uQ);this.la.Eb(Tb.a.cjb,2)})})}XLk(kb,
Xb,sc,Rc,Zc){return Object(x.b)(this,void 0,void 0,function*(){this.Cym(Zc);if(!this.Crm()){this.cZc=Rc;this.tsg=this.mHn;this.q0g();yield this.WZl();m.a.$(508043466,830,50,"PreviewManager - Slide now zoomed to fit window [previewId: {0}]",Zc);Object(n.a)("ShowCanvasLoadingSpinner")&&(this.showLoadingSpinner(b(Rc)),m.a.$(507901344,830,50,"PreviewManager - Unhide loading spinner [previewId: {0}]",Zc));var Id=this.Xb.i1(kb),Td=this.Xb.i1(sc);Id=yield this.POg.Woj([[Id.sid,Id.cid],[Td.sid,Td.cid]],Zc);
m.a.$(508043465,830,50,"PreviewManager - Fetched resource providers [previewId: {0}]",Zc);yield this.Ad.XLk(kb,Xb-1,sc,Rc-1,Id,Zc,!0);m.a.$(508086176,830,50,"PreviewManager - Completed transition preview [previewId: {0}]",Zc)}})}HJh(){m.a.$(508086175,830,50,"PreviewManager - Ending preview [previewId: {0}]",this.uQ);this.Ad.exit()}Crm(){const kb=this.aSh||this.fle;kb&&m.a.$(508086174,830,50,"PreviewManager - Not starting animation preview as preview is loading: {0} or ongoing: {1}, [previewId: {2}]",
this.aSh,this.fle,this.uQ);return kb}blo(){const kb=b(this.cZc),Xb=document.getElementById("WACHorizontalRulerContainer"),sc=document.getElementById("WACVerticalRulerContainer");kb&&(kb.style.display="inherit");Xb&&(Xb.style.display="inherit");sc&&(sc.style.display="inherit")}Oqn(){const kb=b(this.cZc),Xb=document.getElementById("WACHorizontalRulerContainer"),sc=document.getElementById("WACVerticalRulerContainer");kb&&(kb.style.display="none");Xb&&(Xb.style.display="none");sc&&(sc.style.display="none")}Cym(kb){this.uQ&&
m.a.$(508043458,830,15,"PreviewManager - Replacing ongoing preview correlation id with new id : {0}, [previewId: {1}]",kb,this.uQ);this.uQ=kb}showLoadingSpinner(kb){if(this.u3b){const Xb=kb.getBoundingClientRect(),sc=this.u3b.getBoundingClientRect(),Rc=Xb.width/2-sc.width/2;this.u3b.style.top=Xb.height/2-sc.height/2+"px";this.u3b.style.left=Rc+"px";kb.appendChild(this.u3b);this.u3b.style.display="block"}}hideLoadingSpinner(){this.u3b&&(this.u3b.style.display="none")}}Object(d.a)(Gh,"PreviewManager",
null,[512]);var Vh=a(1241);class Qg{constructor(kb,Xb,sc,Rc,Zc,Id){this.QN=null;this.v_e=new Map;this.fUh=this.f1e=!1;this.GH=new yc.a;this.Smc=this.XJb="";this.Qmm=()=>{m.a.$(508086172,830,100,"ResourceProviderManager - Multiple slides possibly updated");this.f1e=!0};this.gnm=Td=>{m.a.$(508086171,830,100,"ResourceProviderManager - Session updated");this.fUh=!0;this.fjk=Td};this.na=kb;this.fjk=sc;this.Iq=Rc;Zc.IFh((Td,he)=>this.B_g(he));Xb&&(Xb.Ojc(this.Qmm),Xb.Rjc(this.Qmm));Id.Qjc((Td,he)=>this.gnm(he.bla));
Id.QFh((Td,he)=>this.gnm(he.bla))}init(kb,Xb,sc,Rc){this.XJb=kb;this.Smc=Xb;this.fjk=sc;this.Iy=Rc}B_g(kb){return Object(x.b)(this,void 0,void 0,function*(){kb.actionId!==Dc.a.ona&&(m.a.$(508086173,830,100,"ResourceProviderManager: Slide edit event received for action id : {0}",null===kb||void 0===kb?void 0:kb.actionId),kb&&kb.hM&&1==kb.hM.length&&Vh.a.includes(null===kb||void 0===kb?void 0:kb.actionId)&&!this.f1e?kb.hM.forEach(Xb=>{this.v_e.has(Xb.sid)||this.v_e.set(Xb.sid,new Set);this.v_e.get(Xb.sid).add(Xb.cid)}):
this.f1e=!0)})}w$l(kb){return null==this.QN||this.f1e||this.fUh||this.Soo(kb)}Woj(kb,Xb){return Object(x.b)(this,void 0,void 0,function*(){const sc=Math.round(window.performance.now()),Rc=this.w$l(kb);if(Rc){const Zc=yield this.s4m();this.QN&&this.QN.dispose();m.a.$(508086170,830,50,"Updated ResourceProviders. InitCase: {0}, MultipleSlidesEdited: {1}, PodsSessionUpdated: {2}, [previewId: {3}]",null==this.QN,this.f1e,this.fUh,null!==Xb&&void 0!==Xb?Xb:"");this.QN=Zc;this.v_e.clear();this.fUh=this.f1e=
!1}m.a.$(508086169,830,50,"Returning ResourceProviders. Time taken: {0}, Updated: {1}",Math.round(window.performance.now())-sc,Rc);return this.QN})}F4l(kb){return Object(x.b)(this,void 0,void 0,function*(){const Xb=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.na.ym,this.fjk),sc={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0","X-UserSessionId":e.AFrameworkApplication.userSessionId},Rc=new Date;return new Promise((Zc,Id)=>{this.Iq.ik(Xb,
1,"",sc,!1,0,Td=>Object(x.b)(this,void 0,void 0,function*(){m.a.$(508086168,830,15,"PreviewFrame - Snap URL fetched successfully. Time taken: {0}, Number of retries: {1}",+new Date-+Rc,1-kb);const he=JSON.parse(Td.data.responseData).downloadUrl;Q.a.wb(he)?Id("Snap URL empty"):Zc(he)}),Td=>Object(x.b)(this,void 0,void 0,function*(){var he,be;const Ue=null!==(be=null===(he=Td.data)||void 0===he?void 0:he.Je)&&void 0!==be?be:-1;0<kb--?(m.a.$(508086167,830,10,"PreviewFrame - Snap URL fetch failed. Retry count: {0}, HttpStatus: {1}",
1-kb,Ue),he=yield this.F4l(kb),Zc(he)):(m.a.$(508086166,830,10,"PreviewFrame - Snap URL fetch failed after {0} retries. HttpStatus: {1}",1,Ue),Id())}),null,null)})})}krb(){const kb=new Map;kb.set("X-UserSessionId",this.Smc);kb.set("X-WacNoAuth","1");kb.set("X-WacCluster",this.XJb);kb.set("Client","Unified App");this.na.JLh&&kb.set("UseDocCache","True");return kb}lrb(){const kb={};kb.timeout=this.na.Ac("PptModernSlideShowGetItemsTimeoutMs",3E4);kb.throwHttpErrors=!1;kb.enableServerSpecificErrorCode=
n.a("SSCore.EnableServerSpecificErrorCode");return kb}f0d(){const kb={};kb.settings=this.Iy;kb.retryCount=this.na.Ac("GetItemsRetryCount",3);kb.retryOnCategories=this.na.Ma("GetItemsRetryCategories").split(";");const Xb={};Xb.Slide=ResourceStrings.l_Slide;Xb.AnimNum=ResourceStrings.l_AccSsAnimNum;Xb.SldNameWithTooltip=ResourceStrings.l_AccSsSldNameWithTooltip;Xb.SldNameWithoutTooltip=ResourceStrings.l_AccSsSldNameWithoutTooltip;Xb.AnimTotalSingular=ResourceStrings.l_AccSsAnimTotalSingular;Xb.AnimTotalPlural=
ResourceStrings.l_AccSsAnimTotalPlural;kb.localizedStrings=Xb;return kb}s4m(){return Object(x.b)(this,void 0,void 0,function*(){const kb=yield this.F4l(1);let Xb=PodsProxy.PodsProxy;if(n.a("UseNewPodsProxyConstructor"))try{Xb=new PodsProxy.PodsProxy(this.na.rwa?this.na.Ufb:this.na.ym,{DownloadUrl:kb,DocID:e.AFrameworkApplication.Fh,CustomFontCatalogUrl:this.na.Ma("CustomFontCatalogURL")},this.na.t1?Q.a.GJ(this.na.t1).toLowerCase():"",this.GH,this.krb(),this.lrb())}catch(sc){if(sc instanceof TypeError)Xb=
new PodsProxy.PodsProxy(this.na.rwa?this.na.Ufb:this.na.ym,{DownloadUrl:kb,DocID:e.AFrameworkApplication.Fh,CustomFontCatalogUrl:this.na.Ma("CustomFontCatalogURL")},this.na.t1?Q.a.GJ(this.na.t1).toLowerCase():"",this.GH,void 0,this.krb(),this.lrb());else throw m.a.$(507811594,830,10,"ResourceProviderManager::Error in PodsProxy initialization:{0}",sc),sc;}else Xb=new PodsProxy.PodsProxy(this.na.rwa?this.na.Ufb:this.na.ym,{DownloadUrl:kb,DocID:e.AFrameworkApplication.Fh,CustomFontCatalogUrl:this.na.Ma("CustomFontCatalogURL")},
this.na.t1?Q.a.GJ(this.na.t1).toLowerCase():"",this.GH,this.krb(),this.lrb());return new SlideShowCore.DefaultResourceProviders(Xb,this.GH,this.f0d())})}Soo(kb){return kb.some(([Xb,sc])=>this.v_e.has(Xb)&&this.v_e.get(Xb).has(sc))}}Object(d.a)(Qg,"ResourceProviderManager",null,[508]);class mh{constructor(kb){this.Oe=kb}q0g(){const kb=[appChrome.actions.updateControlHiddenState("AnimationPreview",!0),appChrome.actions.updateControlHiddenState("ExitAnimationPreview",!1),appChrome.actions.updateControlEnabledDisabledState("ExitAnimationPreview",
!0)];appChrome.api.dispatch(kb)}OVh(){const kb=[appChrome.actions.updateControlEnabledDisabledState("ExitAnimationPreview",!1)];appChrome.api.dispatch(kb)}NVh(){this.Oe.aPk(new Fg(!1,()=>{}));const kb=[appChrome.actions.updateControlHiddenState("AnimationPreview",!1),appChrome.actions.updateControlHiddenState("ExitAnimationPreview",!0)];appChrome.api.dispatch(kb)}}Object(d.a)(mh,"AnimationPreviewStateListener",null,[665]);class Mf{q0g(){const kb=[appChrome.actions.updateControlHiddenState("TransitionPreview",
!0),appChrome.actions.updateControlHiddenState("ExitTransitionPreview",!1),appChrome.actions.updateControlEnabledDisabledState("ExitTransitionPreview",!0)];appChrome.api.dispatch(kb)}OVh(){const kb=[appChrome.actions.updateControlEnabledDisabledState("ExitTransitionPreview",!1)];appChrome.api.dispatch(kb)}NVh(){const kb=[appChrome.actions.updateControlHiddenState("TransitionPreview",!1),appChrome.actions.updateControlHiddenState("ExitTransitionPreview",!0)];appChrome.api.dispatch(kb)}}Object(d.a)(Mf,
"TransitionPreviewStateListener",null,[665]);class Gg{constructor(kb){this.Bj=kb;this.Xyf=this.Yyf=null;this.wTj=this.flag=!1;this.abd=(Xb=0,sc=!1,Rc=!1)=>{clearTimeout(this.uRl);n.a("StickyToastMessage")?(this.flag&&(this.wTj?(this.Bj.notificationBar.removeEntry(this.Xyf),this.wTj=!1):this.Bj.notificationBar.removeEntry(this.Yyf),this.flag=!1),Rc||(this.uRl=setTimeout(()=>{this.flag=!0;sc?(this.Xyf=this.Bj.notificationBar.OX(Gg.WGl,!0),this.Xyf.image=5,this.Xyf.aY=Gg.Thc,this.Bj.notificationBar.mi(this.Xyf),
this.wTj=!0):(this.Yyf=this.Bj.notificationBar.OX(Gg.JGb,!0),this.Yyf.image=5,this.Yyf.aY=Gg.Thc,this.Bj.notificationBar.mi(this.Yyf))},Xb+3E3))):Rc||(this.uRl=setTimeout(()=>{const Zc=this.Bj.notificationBar.OX(sc?Gg.WGl:Gg.JGb,!1);Zc.displayTimeoutSeconds=2;Zc.image=5;Zc.aY=Gg.Thc;this.Bj.notificationBar.mi(Zc)},Xb+3E3))}}}Gg.JGb=ResourceStrings.l_AnimationPreviewStartToastString;Gg.WGl=ResourceStrings.l_AnimationPreviewExitToastString;Gg.Thc="AnimFxEntranceScale_16";Object(d.a)(Gg,"AnimationPreviewToast",
null,[]);class dh{get name(){return"PowerPointWebEditor.Preview"}oc(kb){const Xb=kb.resolve("PowerPointWebEditor.IApplicationSettings");if(Xb.isAnimationPreviewEnabled){ob.VZl(kb);const sc=kb.resolve("PowerPointWebEditor.ISlideShowCoreHelper"),Rc=kb.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),Zc=Rc.gN();kb.register(507,"PowerPointWebEditor.AnimationPreviewToast").oa().pa(()=>new Gg(kb.resolve("Box4.IAppFrame")));if(sc.U_e||sc.T_e)kb.register(508,"PowerPointWebEditor.IResourceProviderManager").oa().pa(()=>
new Qg(Xb,kb.resolve("PowerPointWebEditor.Core.ICoreEventSource"),kb.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,e.AFrameworkApplication.$d,kb.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),kb.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"))),kb.register(509,"PowerPointWebEditor.IPreviewFrame").oa().pa(()=>new uf(Zc,Xb,kb.resolve("PowerPoint.IPathManager"),sc.getSettings(),kb.resolve("PowerPointWebEditor.AnimationPreviewToast"),kb.resolve("PowerPointWebEditor.ISlideShowCoreHelper"))),
kb.register(510,"PowerPointWebEditor.AnimationPreviewStateListener").oa().pa(()=>new mh(B.a.instance.resolve("PowerPointWebEditor.View.IViewEventNotifier"))),kb.register(511,"PowerPointWebEditor.TransitionPreviewStateListener").oa().pa(()=>new Mf),kb.register(512,"PowerPointWebEditor.IPreviewManager").oa().pa(()=>new Gh(kb.resolve("PowerPointWebEditor.IPreviewFrame"),kb.resolve("PowerPointWebEditor.IResourceProviderManager"),B.a.instance.resolve("PowerPointWebEditor.View.IViewEventNotifier"),kb.resolve("Common.IActionManagerExtended"),
kb.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),kb.resolve("PowerPointWebEditor.IZoomContext"),kb.resolve("PowerPointWebEditor.IPresentationReader"),Rc,kb.resolve("PowerPointWebEditor.AnimationPreviewStateListener"),kb.resolve("PowerPointWebEditor.TransitionPreviewStateListener"),kb.resolve("PowerPointWebEditor.AnimationPreviewToast"))),sc.xhm.then(()=>{kb.resolve("PowerPointWebEditor.IPreviewManager").uun(kb.resolve("PowerPointWebEditor.ISessionInfoOwner").Hp,e.AFrameworkApplication.userSessionId,
kb.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,sc.getSettings())})}}init(){}dispose(){}static main(){h.a.instance.Jc(new dh)}}Object(d.a)(dh,"PreviewPackage",null,[4,5]);class Jh{constructor(kb,Xb,sc,Rc,Zc,Id,Td){this.ghb=new F.a;this.$rg=this.asg=null;this.Kdm=this.jod=0;this.Dna=this.Xek=this.Wek=!1;this.tje=Bc.a.vF(2,0,!1);this.d_c=Bc.a.vF(2,1,!1);this.kh=!1;this.WQg=kb;this.RTc=sc;this.wB=Rc;this.Lz=Xb;this.jgm=Td;this.nc=Zc;this.kh=Id.getBooleanAppSetting(Of.a.EJ);if(this.Dna=
Id.LYe)kb=Id.b0h,this.tje=Bc.a.vF(kb,0,!1),this.d_c=Bc.a.vF(kb,1,!1)}get jd(){return this.RTc.jd}sqd(kb,Xb,sc,Rc){if(!Xb)return!1;this.Wek||(this.jod=Date.now(),this.Wek=!0);Xb=!1;try{if(this.wB.TRl(sc.shapeNode)){this.ghb.clear();this.y_m();const Zc=this.ofn(sc);if(kb){const Td=this.wB.Kln(this.wB.$qa(sc,kb),this.pld(Zc),this.jd,this.tje,this.d_c);if(Td.top||Td.bottom||Td.left||Td.right)Xb=!0,this.wB.Poh(sc,Td);if(this.jgm){const he=this.wB.Tgn(this.wB.$qa(sc,kb),Zc,this.tje,this.d_c,Rc);if(he.top||
he.bottom||he.left||he.right)Xb=!0,this.wB.Poh(sc,he);const be=this.wB.Ugn(this.wB.$qa(sc,kb),Zc,this.jd,this.d_c,Rc,kb);if(be.top||be.bottom||be.left||be.right)Xb=!0,this.wB.Poh(sc,be);const Ue=this.wB.Hin(this.wB.$qa(sc,kb),Zc,this.jd,this.d_c,Rc,kb);if(Ue.top||Ue.bottom||Ue.left||Ue.right)Xb=!0,this.wB.Poh(sc,Ue)}}else Xb=this.wB.dgo(sc,this.wB.$qa(sc,kb),this.pld(Zc),this.jd,this.tje,this.d_c);this.ghb.addRange(this.wB.r_m(this.wB.$qa(sc,kb),this.pld(Zc),this.jd));const Id=this.wB.zUe(this.wB.$qa(sc,
kb),this.pld(Zc));if(Id.count)this.ghb.addRange(Id);else if(!Xb){let Td;Td=kb?this.wB.cgo(this.wB.$qa(sc,!0),this.pld(Zc),sc):this.wB.bgo(this.wB.$qa(sc,!1),this.pld(Zc),sc,this.d_c,this.tje);this.ghb.addRange(Td);Xb=!!Td&&0<Td.count}if(this.jgm)if(kb)this.ghb.addRange(this.wB.iFi(this.wB.$qa(sc,kb),this.wB.hld(Zc),this.jd,Rc,kb)),this.ghb.addRange(this.wB.sNd(this.wB.$qa(sc,kb),this.wB.hld(Zc),this.jd,Rc,kb)),this.ghb.addRange(this.wB.u_m(this.wB.$qa(sc,kb),this.wB.hld(Zc),Rc));else{const Td=this.wB.sNd(this.wB.$qa(sc,
kb),this.wB.hld(Zc),this.jd,Rc,kb);if(Td.count)this.ghb.addRange(Td);else if(!Xb){const be=this.wB.RAm(this.wB.$qa(sc,!1),this.pld(Zc),sc,this.jd,this.d_c,this.tje);this.ghb.addRange(this.wB.sNd(this.wB.$qa(sc,kb),this.wB.hld(Zc),this.jd,Rc,kb));Xb=be}const he=this.wB.iFi(this.wB.$qa(sc,kb),this.wB.hld(Zc),this.jd,Rc,kb);if(he.count)this.ghb.addRange(he);else if(!Xb){const be=this.wB.RAm(this.wB.$qa(sc,!1),this.pld(Zc),sc,this.jd,this.d_c,this.tje);this.ghb.addRange(this.wB.iFi(this.wB.$qa(sc,kb),
this.wB.hld(Zc),this.jd,Rc,kb));Xb=be}}this.WQg.m1i(this.ghb.toArray());this.WQg.visible=!0}}catch(Zc){this.Xek||(m.a.$(507799757,815,10,"SmartGuide - moving error {0}",Zc.toString()),this.Xek=!0)}return Xb}QVh(kb){kb&&(this.WQg.visible=!1,this.$rg=this.asg=null,this.ghb.clear(),this.WQg.m1i([]),this.Kdm=Date.now(),this.Xek=this.Wek=!1,m.a.$(507799756,815,50,"SmartGuide - moving timespan {0}",(this.Kdm-this.jod).toString()))}kUl(){this.WQg.m1i([]);this.ghb.clear()}get JB(){var kb,Xb;return this.kh?
null!==(Xb=null===(kb=this.nc)||void 0===kb?void 0:kb.JB)&&void 0!==Xb?Xb:1:1}y_m(){this.wB.zkm=this.Lz.Fs(this.jd.eO.offsetLeft-this.jd.Pc.scrollLeft/this.JB);this.wB.Akm=this.Lz.Fs(this.jd.eO.offsetTop-this.jd.Pc.scrollTop/this.JB)}ofn(kb){return this.asg?this.asg:this.asg=this.wB.nfn(this.wB.tln(this.jd,this.jd.Ua),kb)}pld(kb){return this.$rg?this.$rg:this.$rg=this.wB.hld(kb)}}Object(d.a)(Jh,"SmartGuideManager",null,[504]);var Wg=a(219);class Ra{constructor(){this.GQh=this.$S=null;this.DRh=0;this.fge=
this.wpe=null;this.XKl=!1}get color(){return this.$S}set color(kb){this.$S=kb}get dashStyle(){return this.GQh}set dashStyle(kb){this.GQh=kb}get H8f(){return this.DRh}set H8f(kb){this.DRh=kb}get Tm(){return this.wpe}set Tm(kb){this.wpe=kb}get Jl(){return this.fge}set Jl(kb){this.fge=kb}get rna(){return this.XKl}set rna(kb){this.XKl=kb}length(){let kb=-1;this.wpe&&this.fge&&(kb=Math.sqrt(Math.pow(this.fge._x-this.wpe._x,2)+Math.pow(this.fge._y-this.wpe._y,2)));return kb}reset(){const kb=new Ra;this.$S=
kb.$S;this.GQh=kb.GQh;this.DRh=kb.DRh;this.wpe=kb.wpe;this.fge=kb.fge}}Object(d.a)(Ra,"SmartGuideLine",null,[680]);class vc{constructor(kb,Xb,sc,Rc){this.distance=kb;this.xAi=Xb;this.Z2i=sc;this.direction=Rc}}Object(d.a)(vc,"DistancePair",null,[]);class Uc{constructor(kb,Xb){this.shape=kb;this.iA=Xb}}Object(d.a)(Uc,"LightSet",null,[]);class id{constructor(kb,Xb,sc,Rc){this.begin=kb;this.end=Xb;this.shape=sc;this.distance=Rc}}Object(d.a)(id,"LightSetItem",null,[]);class Jd{constructor(){this.S4b={};
this.Nfm=[]}ka(kb){return this.S4b[kb]}fa(kb,Xb){kb in this.S4b||this.Nfm.push(kb);return this.S4b[kb]=Xb}get keys(){return this.Nfm}}Object(d.a)(Jd,"NumberDictionary",null,[]);class $d{constructor(kb,Xb){this.first=kb;this.second=Xb}}Object(d.a)($d,"NumberPair",null,[]);var re=a(1245);class Re{constructor(kb,Xb){this.bmk=[];this.zp=5;this.Sgb=this.X_=2;this.RDa=4;this.T$=3;this.vSh=this.uSh=0;this.Lz=kb;this.T0e=Xb}tln(kb,Xb){kb=hf.GraphIterator.vb(kb.mb);const sc=[];for(var Rc=kb.Fb(1);Rc;Rc=kb.Df(1))Rc=
tg.a(Rc,Xb),sc.push(Rc);return sc}$qa(kb,Xb){for(const sc of this.bmk)if(sc.XJ(kb))return sc.$qa(kb,Xb);return null}addHandler(kb){this.bmk.push(kb)}bgo(kb,Xb,sc,Rc,Zc){Rc=this.j0h(Rc,Re.dHh);Zc=this.j0h(Zc,Re.dHh);for(var Id of Rc){Rc=kb.copy();Rc.move(0,0-Id);Rc=this.zUe(Rc,Xb);if(Rc.count)return this.mbd(sc,0,-Id),Rc;Rc=kb.copy();Rc.move(0,Id);Rc=this.zUe(Rc,Xb);if(Rc.count)return this.mbd(sc,0,Id),Rc}for(const Td of Zc){Id=kb.copy();Id.move(0-Td,0);Id=this.zUe(Id,Xb);if(Id.count)return this.mbd(sc,
-1*Td,0),Id;Id=kb.copy();Id.move(Td,0);Id=this.zUe(Id,Xb);if(Id.count)return this.mbd(sc,Td,0),Id}return new F.a}j0h(kb,Xb){const sc=new F.a;kb/=Xb;let Rc=0;for(let Zc=0;Zc<Xb;++Zc)Rc+=kb,sc.add(Rc);return sc}cgo(kb,Xb,sc){var Rc=[];for(const Zc of Rc)if(Rc=kb.copy(),Rc.setOffsets(Zc),Rc=this.zUe(Rc,Xb),Rc.count)return this.Poh(sc,Zc),Rc;return new F.a}hld(kb){const Xb=[];for(const sc of kb)Xb.push(new re.a(sc.Lu()));return Xb}dgo(kb,Xb,sc,Rc,Zc,Id){const Td=new xa.a(Number.MAX_VALUE,Number.MAX_VALUE);
let he=Number.MAX_VALUE;var be=Number.MAX_VALUE;let Ue=[];for(const cf of sc)Ue.push(cf);this.T0e&&(Ue=this.xUm(Ue,Rc));for(const cf of Ue)sc=this.Qin(Xb,cf,he),Math.abs(Td.y)>Math.abs(sc)&&(Td.y=sc),he=Math.abs(sc),sc=this.Pin(Xb,cf,be),Math.abs(Td.x)>Math.abs(sc)&&(Td.x=sc),be=Math.abs(sc);be=this.Egn(Xb,he,Rc);Math.abs(Td.y)>Math.abs(be)&&(Td.y=be);be=this.Dgn(Xb,he,Rc);Math.abs(Td.x)>Math.abs(be)&&(Td.x=be);Math.abs(Td.x)>Zc&&(Td.x=0);Math.abs(Td.y)>Id&&(Td.y=0);return Td.x||Td.y?(this.mbd(kb,
Td.x,Td.y),!0):!1}xUm(kb,Xb){var sc=this.Lz.Fs(Xb.ge.width);Xb=this.Lz.Fs(Xb.ge.height);var Rc=new re.a(new lf.a(new xa.a(0,0),new xa.a(sc,0),new xa.a(sc,Xb),new xa.a(0,Xb)));kb.push(Rc);Rc=new re.a(new lf.a(new xa.a(0,0),new xa.a(sc,0),new xa.a(sc,Xb/2),new xa.a(0,Xb/2)));kb.push(Rc);sc=new re.a(new lf.a(new xa.a(0,0),new xa.a(sc/2,0),new xa.a(sc/2,Xb),new xa.a(0,Xb)));kb.push(sc);return kb}Poh(kb,Xb){this.KXe(kb,sc=>{sc.setOffsets(kb,Xb)})}mbd(kb,Xb,sc){this.KXe(kb,Rc=>{Rc.setPosition(kb,Xb,sc)})}KXe(kb,
Xb){for(const sc of this.bmk)if(sc.XJ(kb)){Xb(sc);break}}Kln(kb,Xb,sc,Rc,Zc){let Id=Number.MAX_VALUE,Td=Number.MAX_VALUE,he=Number.MAX_VALUE,be=Number.MAX_VALUE;var Ue=[];for(var cf of Xb)Ue.push(cf.copy());Xb=this.Lz.Fs(sc.ge.width);sc=this.Lz.Fs(sc.ge.height);cf=new re.a(new lf.a(new xa.a(0,0),new xa.a(Xb,0),new xa.a(Xb,sc),new xa.a(0,sc)));Ue.push(cf);this.T0e&&(cf=new re.a(new lf.a(new xa.a(0,0),new xa.a(Xb,0),new xa.a(Xb,sc/2),new xa.a(0,sc/2))),Ue.push(cf),Xb=new re.a(new lf.a(new xa.a(0,0),
new xa.a(Xb/2,0),new xa.a(Xb/2,sc),new xa.a(0,sc))),Ue.push(Xb));for(const mf of Ue)Ue=this.aZh([mf.Bd-kb.hd,mf.hd-kb.hd,mf.Ki().y-kb.hd],Zc),this.tQa(Ue,Zc)&&Math.abs(Ue)<Math.abs(Id)&&(Id=Ue),Ue=this.aZh([mf.Bd-kb.Bd,mf.hd-kb.Bd,mf.Ki().y-kb.Bd],Zc),this.tQa(Ue,Zc)&&Math.abs(Ue)<Math.abs(Td)&&(Td=Ue),Ue=this.aZh([mf.Mc-kb.Mc,mf.Gd-kb.Mc,mf.Ki().x-kb.Mc],Rc),this.tQa(Ue,Rc)&&Math.abs(Ue)<Math.abs(he)&&(he=Ue),Ue=this.aZh([mf.Mc-kb.Gd,mf.Gd-kb.Gd,mf.Ki().x-kb.Gd],Rc),this.tQa(Ue,Rc)&&Math.abs(Ue)<
Math.abs(be)&&(be=Ue);kb=new Wg.a;kb.top=Id===Number.MAX_VALUE?kb.top:Id;kb.bottom=Td===Number.MAX_VALUE?kb.bottom:Td;kb.left=he===Number.MAX_VALUE?kb.left:he;kb.right=be===Number.MAX_VALUE?kb.right:be;return kb}TRl(kb){let Xb=!1;n.a("EnableSmartGuideForTableAndVideo")&&(Xb=kb.gd||kb.pq);return kb.Gwa||kb.Pg||kb.Bl||kb.Im||kb.xg||Xb}getDistance(kb,Xb){return Math.abs(kb-Xb)}Qin(kb,Xb,sc){kb=[new $d(kb.hd,Xb.hd),new $d(kb.hd,Xb.Bd),new $d(kb.hd,Xb.Ki().y),new $d(kb.Bd,Xb.hd),new $d(kb.Bd,Xb.Bd),new $d(kb.Bd,
Xb.Ki().y),new $d(kb.Ki().y,Xb.hd),new $d(kb.Ki().y,Xb.Bd),new $d(kb.Ki().y,Xb.Ki().y)];return this.OLh(kb,sc)}Pin(kb,Xb,sc){kb=[new $d(kb.Mc,Xb.Mc),new $d(kb.Mc,Xb.Gd),new $d(kb.Mc,Xb.Ki().x),new $d(kb.Gd,Xb.Mc),new $d(kb.Gd,Xb.Gd),new $d(kb.Gd,Xb.Ki().x),new $d(kb.Ki().x,Xb.Mc),new $d(kb.Ki().x,Xb.Gd),new $d(kb.Ki().x,Xb.Ki().x)];return this.OLh(kb,sc)}Egn(kb,Xb,sc){sc=this.Lz.Fs(sc.ge.height);kb=[new $d(kb.hd,0),new $d(kb.hd,sc),new $d(kb.Bd,0),new $d(kb.Bd,sc),new $d(kb.Ki().y,0),new $d(kb.Ki().y,
sc)];return this.OLh(kb,Xb)}Dgn(kb,Xb,sc){sc=this.Lz.Fs(sc.ge.width);kb=[new $d(kb.Mc,0),new $d(kb.Mc,sc),new $d(kb.Gd,0),new $d(kb.Gd,sc),new $d(kb.Ki().x,0),new $d(kb.Ki().x,sc)];return this.OLh(kb,Xb)}OLh(kb,Xb){let sc=Number.MAX_VALUE;for(const Rc of kb)kb=this.getDistance(Rc.first,Rc.second),kb<Xb&&(Xb=kb,sc=Rc.second-Rc.first);return sc}tQa(kb,Xb){kb=Math.abs(kb);return.2<kb&&kb<Xb}aZh(kb,Xb){let sc=Number.MAX_VALUE;for(const Rc of kb)this.tQa(Rc,Xb)&&Math.abs(sc)>Math.abs(Rc)&&(sc=Rc);return sc}nfn(kb,
Xb){const sc=new F.a;for(const Rc of kb)this.TRl(Rc.shapeNode)&&Rc.mb!==Xb.mb&&sc.add(Rc);return sc.toArray()}zUe(kb,Xb){var sc=new F.a;sc.add(kb);var Rc=new F.a;Rc.add(kb);var Zc=new F.a;Zc.add(kb);var Id=new F.a;Id.add(kb);for(const Td of Xb)Td.Bd<kb.hd||Td.hd>kb.Bd||(Td.Mc<kb.Mc&&this.uFh(sc,Td,2),Td.Gd>kb.Gd&&this.uFh(Rc,Td,3)),Td.Gd<kb.Mc||Td.Mc>kb.Gd||(Td.hd<kb.hd&&this.uFh(Zc,Td,0),Td.Bd>kb.Bd&&this.uFh(Id,Td,1));kb=this.QLh(sc,2);Rc=this.QLh(Rc,3);Xb=this.QLh(Zc,0);sc=this.QLh(Id,1);Id=new Jd;
this.nIh(Id,kb[0]);this.nIh(Id,Rc[0]);Zc=new Jd;this.nIh(Zc,Xb[0]);this.nIh(Zc,sc[0]);this.oKh(Id,kb,2);this.oKh(Id,Rc,3);this.oKh(Zc,Xb,0);this.oKh(Zc,sc,1);kb=new F.a;Rc=new F.a;this.DWl(Id,kb,Rc);this.DWl(Zc,kb,Rc);this.jtd(kb,1);this.jtd(Rc,2);kb.addRange(Rc);for(const Td of kb)this.sY(Td);return kb}QLh(kb,Xb){const sc=new F.a;for(let Zc=0;Zc<kb.count;++Zc){var Rc=new id(this.$fn(kb,Zc,Xb),this.ign(kb,Zc,Xb),null,-1);Rc=new Uc(kb.ka(Zc),[Rc]);for(let Id=Zc+1;Id<kb.count;++Id){const Td=Rc.iA.length;
let he=Td;for(let be=0;be<Td;++be)if(!Rc.iA[be].shape&&-1===Rc.iA[be].distance&&Rc.iA[be].end>Rc.iA[be].begin){const Ue=this.vgn(kb,Zc,Id,Xb);he+=this.D1n(kb,Id,be,he,Zc,Ue,Rc,Xb);he+=this.F1n(kb,Id,be,he,Zc,Ue,Rc,Xb);he+=this.W1n(kb,Id,be,he,Zc,Ue,Rc,Xb);he+=this.E1n(kb,Id,be,Zc,Ue,Rc,Xb)}}sc.add(Rc)}return sc.toArray()}DWl(kb,Xb,sc){for(const Zc of kb.keys){var Rc=kb.ka(Zc);if(1<Rc.count){const Id=new F.a;for(const Td of Rc){Rc=!1;for(const he of Id)if(this.qXm(Td,he)){Rc=!0;Id.remove(he);break}Rc||
Id.add(Td)}for(const Td of Id)this.J4m(Td,Xb,sc)}}}qXm(kb,Xb){return this.SRl(kb.xAi,Xb.xAi)&&this.SRl(kb.Z2i,Xb.Z2i)}SRl(kb,Xb){return kb.Mc===Xb.Mc&&kb.Gd===Xb.Gd&&kb.hd===Xb.hd&&kb.Bd===Xb.Bd}uFh(kb,Xb,sc){const Rc=kb.count;for(let Zc=0;Zc<Rc;Zc++){const Id=kb.ka(Zc);if(3===sc&&(Xb.Mc<kb.ka(0).Gd?Xb.Gd:Xb.Mc)<(Id.Mc<kb.ka(0).Gd?Id.Gd:Id.Mc)||2===sc&&(Xb.Gd>kb.ka(0).Mc?Xb.Mc:Xb.Gd)>(Id.Gd>kb.ka(0).Mc?Id.Mc:Id.Gd)||0===sc&&(Xb.Bd>kb.ka(0).hd?Xb.hd:Xb.Bd)>(Id.Bd>kb.ka(0).hd?Id.hd:Id.Bd)||1===sc&&
(Xb.hd<kb.ka(0).Bd?Xb.Bd:Xb.hd)<(Id.hd<kb.ka(0).Bd?Id.Bd:Id.hd)){kb.insert(Zc,Xb);return}}kb.add(Xb)}nIh(kb,Xb){for(const sc of Xb.iA)0<sc.distance&&kb.fa(Math.round(100*sc.distance)/100,new F.a)}oKh(kb,Xb,sc){const Rc=new Jd;for(const Zc of Xb){for(const Id of kb.keys)Rc.fa(Id,0);for(const Id of Zc.iA)if(0<Id.distance&&Id.shape)for(const Td of kb.keys)if(Xb=Td,this.UV(Id.distance,Xb)){const he=Rc.ka(Td);1>he&&(kb.ka(Td).add(new vc(Xb,Zc.shape,Id.shape,sc)),Rc.fa(Td,he+1));break}}}$fn(kb,Xb,sc){Xb=
kb.ka(Xb);kb=kb.ka(0);switch(sc){case 2:case 3:return Math.max(Xb.hd,kb.hd);case 0:case 1:return Math.max(Xb.Mc,kb.Mc);default:return-1}}ign(kb,Xb,sc){Xb=kb.ka(Xb);kb=kb.ka(0);switch(sc){case 2:case 3:return Math.min(Xb.Bd,kb.Bd);case 0:case 1:return Math.min(Xb.Gd,kb.Gd);default:return-1}}D1n(kb,Xb,sc,Rc,Zc,Id,Td,he){const be=kb.ka(Xb);Zc=kb.ka(Zc);switch(he){case 3:case 2:if(be.Bd>=Td.iA[sc].begin&&be.Bd<=Td.iA[sc].end&&be.hd<=Td.iA[sc].begin)return kb=new id(Td.iA[sc].begin,be.Bd,kb.ka(Xb),3===
he?Id-Zc.Gd:Zc.Mc-Id),Td.iA[Rc]=kb,Td.iA[sc].begin=be.Bd,1;break;case 0:case 1:if(be.Gd>=Td.iA[sc].begin&&be.Gd<=Td.iA[sc].end&&be.Mc<=Td.iA[sc].begin)return kb=new id(Td.iA[sc].begin,be.Gd,kb.ka(Xb),0===he?Zc.hd-Id:Id-Zc.Bd),Td.iA[Rc]=kb,Td.iA[sc].begin=be.Gd,1}return 0}F1n(kb,Xb,sc,Rc,Zc,Id,Td,he){const be=kb.ka(Xb);Zc=kb.ka(Zc);switch(he){case 3:case 2:if(be.hd>=Td.iA[sc].begin&&be.hd<=Td.iA[sc].end&&be.Bd>=Td.iA[sc].end)return kb=new id(be.hd,Td.iA[sc].end,kb.ka(Xb),3===he?Id-Zc.Gd:Zc.Mc-Id),
Td.iA[Rc]=kb,Td.iA[sc].end=be.hd,1;break;case 0:case 1:if(be.Mc>=Td.iA[sc].begin&&be.Mc<=Td.iA[sc].end&&be.Gd>=Td.iA[sc].end)return kb=new id(be.Mc,Td.iA[sc].end,kb.ka(Xb),0===he?Zc.hd-Id:Id-Zc.Bd),Td.iA[Rc]=kb,Td.iA[sc].end=be.Mc,1}return 0}W1n(kb,Xb,sc,Rc,Zc,Id,Td,he){const be=kb.ka(Xb);Zc=kb.ka(Zc);switch(he){case 3:case 2:if(be.hd>Td.iA[sc].begin&&be.hd<Td.iA[sc].end&&be.Bd>Td.iA[sc].begin&&be.Bd<Td.iA[sc].end)return kb=new id(be.hd,be.Bd,kb.ka(Xb),3===he?Id-Zc.Gd:Zc.Mc-Id),Td.iA[Rc]=kb,kb=new id(be.Bd,
Td.iA[sc].end,null,-1),Td.iA[++Rc]=kb,Td.iA[sc].end=be.hd,2;break;case 0:case 1:if(be.Mc>Td.iA[sc].begin&&be.Mc<Td.iA[sc].end&&be.Gd>Td.iA[sc].begin&&be.Gd<Td.iA[sc].end)return kb=new id(be.Mc,be.Gd,kb.ka(Xb),0===he?Zc.hd-Id:Id-Zc.Bd),Td.iA[Rc]=kb,kb=new id(be.Gd,Td.iA[sc].end,null,-1),Td.iA[++Rc]=kb,Td.iA[sc].end=be.Mc,2}return 0}E1n(kb,Xb,sc,Rc,Zc,Id,Td){const he=kb.ka(Xb);Rc=kb.ka(Rc);switch(Td){case 3:case 2:he.hd<Id.iA[sc].begin&&he.Bd>Id.iA[sc].end&&(Id.iA[sc].shape=kb.ka(Xb),Id.iA[sc].distance=
3===Td?Zc-Rc.Gd:Rc.Mc-Zc);break;case 0:case 1:he.Mc<Id.iA[sc].begin&&he.Gd>Id.iA[sc].end&&(Id.iA[sc].shape=kb.ka(Xb),Id.iA[sc].distance=0===Td?Rc.hd-Zc:Zc-Rc.Bd)}return 0}vgn(kb,Xb,sc,Rc){let Zc=-1;sc=kb.ka(sc);kb=kb.ka(Xb);switch(Rc){case 3:sc.Mc<kb.Gd&&sc.Gd>=kb.Gd&&(Zc=sc.Gd);sc.Mc>=kb.Gd&&(Zc=sc.Mc);break;case 2:sc.Gd>kb.Mc&&sc.Mc<=kb.Mc&&(Zc=sc.Mc);sc.Gd<=kb.Mc&&(Zc=sc.Gd);break;case 0:sc.Bd>kb.hd&&sc.hd<=kb.hd&&(Zc=sc.hd);sc.Bd<=kb.hd&&(Zc=sc.Bd);break;case 1:sc.hd<kb.Bd&&sc.Bd>=kb.Bd&&(Zc=
sc.Bd),sc.hd>=kb.Bd&&(Zc=sc.hd)}return Zc}J4m(kb,Xb,sc){const Rc=kb.xAi;var Zc=kb.Z2i;switch(kb.direction){case 3:var Id=Math.max(Rc.Bd,Zc.Bd),Td=new Ra;Td.Tm=new xa.a(Rc.Gd-this.T$,Rc.hd);Td.Jl=new xa.a(Rc.Gd-this.T$,Id+this.zp);Xb.add(Td);Td=new Ra;Td.Tm=new xa.a(Rc.Gd+kb.distance-this.T$,Zc.hd);Td.Jl=new xa.a(Rc.Gd+kb.distance-this.T$,Id+this.zp);Xb.add(Td);Xb=new Ra;Xb.Tm=new xa.a(Rc.Gd-this.T$,Id+this.zp);Xb.Jl=new xa.a(Rc.Gd+kb.distance-this.T$,Id+this.zp);sc.add(Xb);break;case 2:Id=Math.max(Rc.Bd,
Zc.Bd);Td=new Ra;Td.Tm=new xa.a(Rc.Mc-kb.distance-this.T$,Zc.hd);Td.Jl=new xa.a(Rc.Mc-kb.distance-this.T$,Id+this.zp);Xb.add(Td);Zc=new Ra;Zc.Tm=new xa.a(Rc.Mc-this.T$,Rc.hd);Zc.Jl=new xa.a(Rc.Mc-this.T$,Id+this.zp);Xb.add(Zc);Xb=new Ra;Xb.Tm=new xa.a(Rc.Mc-kb.distance-this.T$,Id+this.zp);Xb.Jl=new xa.a(Rc.Mc-this.T$,Id+this.zp);sc.add(Xb);break;case 0:Id=Math.max(Rc.Gd,Zc.Gd);Td=new Ra;Td.Tm=new xa.a(Rc.Mc,Rc.hd-this.X_);Td.Jl=new xa.a(Id+this.zp,Rc.hd-this.X_);Xb.add(Td);Td=new Ra;Td.Tm=new xa.a(Zc.Mc,
Rc.hd-kb.distance-this.X_);Td.Jl=new xa.a(Id+this.zp,Rc.hd-kb.distance-this.X_);Xb.add(Td);Xb=new Ra;Xb.Tm=new xa.a(Id+this.zp,Rc.hd-this.X_);Xb.Jl=new xa.a(Id+this.zp,Rc.hd-kb.distance-this.X_);sc.add(Xb);break;case 1:Id=Math.max(Rc.Gd,Zc.Gd),Td=new Ra,Td.Tm=new xa.a(Rc.Mc,Rc.Bd-this.X_),Td.Jl=new xa.a(Id+this.zp,Rc.Bd-this.X_),Xb.add(Td),Td=new Ra,Td.Tm=new xa.a(Zc.Mc,Rc.Bd+kb.distance-this.X_),Td.Jl=new xa.a(Id+this.zp,Rc.Bd+kb.distance-this.X_),Xb.add(Td),Xb=new Ra,Xb.Tm=new xa.a(Id+this.zp,Rc.Bd-
this.X_),Xb.Jl=new xa.a(Id+this.zp,Rc.Bd+kb.distance-this.X_),sc.add(Xb)}}u_m(kb,Xb,sc){const Rc=new F.a;if(!sc)return Rc;let Zc=!1;var Id=!1;const Td=sc.equals(qe.a.west)||sc.equals(qe.a.fD)||sc.equals(qe.a.E1),he=sc.equals(qe.a.east)||sc.equals(qe.a.rY)||sc.equals(qe.a.JU),be=sc.equals(qe.a.north)||sc.equals(qe.a.fD)||sc.equals(qe.a.rY);sc=sc.equals(qe.a.south)||sc.equals(qe.a.E1)||sc.equals(qe.a.JU);for(const cf of Xb){if(this.X$l(kb,cf,!0,Xb)&&(Td||he)){Zc=!0;var Ue=new Ra;Ue.Tm=new xa.a(cf.Mc,
cf.Ki()._y);Ue.Jl=new xa.a(cf.Gd-this.T$,cf.Ki()._y);Ue.rna=!0;Rc.add(this.sY(Ue))}this.X$l(kb,cf,!1,Xb)&&(be||sc)&&(Id=!0,Ue=new Ra,Ue.Tm=new xa.a(cf.Ki()._x,cf.hd),Ue.Jl=new xa.a(cf.Ki()._x,cf.Bd-this.Sgb),Ue.rna=!1,Rc.add(this.sY(Ue)))}Zc&&(Xb=new Ra,Xb.Tm=new xa.a(kb.Mc,kb.Ki()._y),Xb.Jl=new xa.a(kb.Gd-this.T$,kb.Ki()._y),Xb.rna=!0,Rc.add(this.sY(Xb)));Id&&(Id=new Ra,Id.Tm=new xa.a(kb.Ki()._x,kb.hd),Id.Jl=new xa.a(kb.Ki()._x,kb.Bd-this.Sgb),Id.rna=!1,Rc.add(this.sY(Id)));this.jtd(Rc,2);return Rc}Ehb(kb,
Xb,sc){var Rc=this.XIb(kb,Xb,!1),Zc=this.XIb(kb,Xb,!0);if(!Rc&&!Zc)return!1;let Id=[];if(Rc){if(kb.Gd<=Xb.Mc||kb.Gd<=Xb.Gd){Rc=Xb.hd>kb.hd?Xb.hd:kb.hd;var Td=Xb.Bd<kb.Bd?Xb.Bd:kb.Bd,he,be=he=Xb.Mc;kb.Gd>Xb.Mc&&(be=he=Xb.Gd);Rc=new re.a(new lf.a(new xa.a(be,Rc),new xa.a(he,Rc),new xa.a(he,Td),new xa.a(be,Td)));Array.add(Id,Rc)}if(kb.Mc>=Xb.Gd||kb.Mc>=Xb.Mc)Rc=Xb.hd>kb.hd?Xb.hd:kb.hd,Td=Xb.Bd<kb.Bd?Xb.Bd:kb.Bd,be=he=Xb.Gd,kb.Mc<Xb.Gd&&(be=he=Xb.Mc),Rc=new re.a(new lf.a(new xa.a(be,Rc),new xa.a(he,Rc),
new xa.a(he,Td),new xa.a(be,Td))),Array.add(Id,Rc)}if(Zc){if(kb.Bd<=Xb.hd||kb.Bd<=Xb.Bd)Zc=Xb.Mc>kb.Mc?Xb.Mc:kb.Mc,Rc=Xb.Gd<kb.Gd?Xb.Gd:kb.Gd,he=Td=Xb.hd,kb.Bd>Xb.hd&&(he=Td=Xb.Bd),Zc=new re.a(new lf.a(new xa.a(Zc,he),new xa.a(Rc,he),new xa.a(Rc,Td),new xa.a(Zc,Td))),Id.push(Zc);if(kb.hd>=Xb.Bd||kb.hd>=Xb.hd)Zc=Xb.Mc>kb.Mc?Xb.Mc:kb.Mc,Rc=Xb.Gd<kb.Gd?Xb.Gd:kb.Gd,he=Td=Xb.Bd,kb.hd<Xb.Bd&&(he=Td=Xb.hd),Zc=new re.a(new lf.a(new xa.a(Zc,he),new xa.a(Rc,he),new xa.a(Rc,Td),new xa.a(Zc,Td))),Array.add(Id,
Zc)}for(const Ue of sc)this.P6l(Ue,kb)||this.P6l(Ue,Xb)||(Id=this.imo(kb,Ue,Id));return 0<Id.length?!0:!1}imo(kb,Xb,sc){let Rc=[];for(const Zc of sc)sc=!0,Zc.Mc===Zc.Gd?(this.XIb(Zc,Xb,!1)||(sc=!1),kb.Gd<=Zc.Mc&&Xb.Gd<=kb.Gd&&(sc=!1),kb.Gd<=Zc.Mc&&Xb.Mc>=Zc.Gd&&(sc=!1),kb.Mc>=Zc.Gd&&Xb.Mc>=kb.Mc&&(sc=!1),kb.Mc>=Zc.Gd&&Xb.Gd<=Zc.Mc&&(sc=!1),sc?Xb.hd<=Zc.hd&&Xb.Bd<Zc.Bd?Rc=this.Y7e(Rc,!0,!0,!1,Zc,Xb):Xb.Bd>=Zc.Bd&&Xb.hd>Zc.hd?Rc=this.Y7e(Rc,!0,!1,!1,Zc,Xb):Xb.hd>Zc.hd&&Xb.Bd<Zc.Bd&&(Rc=this.Y7e(Rc,
!0,!1,!0,Zc,Xb)):Array.add(Rc,Zc)):Zc.hd===Zc.Bd&&(this.XIb(Zc,Xb,!0)||(sc=!1),kb.Bd<=Zc.hd&&Xb.Bd<=kb.Bd&&(sc=!1),kb.Bd<=Zc.hd&&Xb.hd>=Zc.Bd&&(sc=!1),kb.hd>=Zc.Bd&&Xb.hd>=kb.hd&&(sc=!1),kb.hd>=Zc.Bd&&Xb.Bd<=Zc.hd&&(sc=!1),sc?Xb.Mc<=Zc.Mc&&Xb.Gd<Zc.Gd?Rc=this.Y7e(Rc,!1,!0,!1,Zc,Xb):Xb.Gd>=Zc.Gd&&Xb.Mc>Zc.Mc?Rc=this.Y7e(Rc,!1,!1,!1,Zc,Xb):Xb.Mc>Zc.Mc&&Xb.Gd<Zc.Gd&&(Rc=this.Y7e(Rc,!1,!1,!0,Zc,Xb)):Array.add(Rc,Zc));return Rc}Y7e(kb,Xb,sc,Rc,Zc,Id){let Td,he,be,Ue,cf,mf,ig;if(sc)Xb?(sc=he=Zc.Mc,Td=Id.Bd,
be=Zc.Bd):(Td=be=Zc.hd,sc=Id.Gd,he=Zc.Gd);else if(sc||Rc){if(Xb?(sc=he=Ue=mf=Zc.Mc,Td=Zc.hd,be=Id.hd,cf=Id.Bd,ig=Zc.Bd):(Td=be=cf=ig=Zc.hd,sc=Zc.Mc,he=Id.Mc,Ue=Id.Gd,mf=Zc.Gd),Rc&&Xb&&!this.UV(cf,ig)||Rc&&!Xb&&!this.UV(Ue,mf))Rc=new re.a(new lf.a(new xa.a(Ue,cf),new xa.a(mf,cf),new xa.a(mf,ig),new xa.a(Ue,ig))),Array.add(kb,Rc)}else Xb?(sc=he=Zc.Mc,Td=Zc.hd,be=Id.hd):(Td=be=Zc.hd,sc=Zc.Mc,he=Id.Mc);if(Xb&&!this.UV(Td,be)||!Xb&&!this.UV(sc,he))Xb=new re.a(new lf.a(new xa.a(sc,Td),new xa.a(he,Td),new xa.a(he,
be),new xa.a(sc,be))),Array.add(kb,Xb);return kb}P6l(kb,Xb){return kb.Gd!==Xb.Gd||kb.Mc!==Xb.Mc||kb.hd!==Xb.hd||kb.Bd!==Xb.Bd?!1:!0}X$l(kb,Xb,sc,Rc){if(sc)return sc=this.UV(kb.Mc,Xb.Mc)&&this.UV(kb.Gd,Xb.Gd),this.UV(kb.Gd-kb.Mc,Xb.Gd-Xb.Mc)&&!sc&&this.Ehb(kb,Xb,Rc);sc=this.UV(kb.hd,Xb.hd)&&this.UV(kb.Bd,Xb.Bd);return this.UV(kb.Bd-kb.hd,Xb.Bd-Xb.hd)&&!sc&&this.Ehb(kb,Xb,Rc)}Tgn(kb,Xb,sc,Rc,Zc){const Id=new Wg.a;if(!Zc)return Id;let Td=Number.MAX_VALUE,he=Number.MAX_VALUE,be=Number.MAX_VALUE,Ue=Number.MAX_VALUE;
const cf=Zc.equals(qe.a.west)||Zc.equals(qe.a.fD)||Zc.equals(qe.a.E1),mf=Zc.equals(qe.a.east)||Zc.equals(qe.a.rY)||Zc.equals(qe.a.JU),ig=Zc.equals(qe.a.north)||Zc.equals(qe.a.fD)||Zc.equals(qe.a.rY);Zc=Zc.equals(qe.a.south)||Zc.equals(qe.a.E1)||Zc.equals(qe.a.JU);const ug=[];for(const Pf of Xb)ug.push(new re.a(Pf.Lu()));for(const Pf of ug)Xb=Pf.Bd-Pf.hd-(kb.Bd-kb.hd),this.tQa(Xb,Rc)&&Math.abs(Xb)<Math.abs(Td)&&this.Ehb(kb,Pf,ug)&&ig&&(Td=-1*Xb),this.tQa(Xb,Rc)&&Math.abs(Xb)<Math.abs(he)&&this.Ehb(kb,
Pf,ug)&&Zc&&(he=Xb),Xb=Pf.Gd-Pf.Mc-(kb.Gd-kb.Mc),this.tQa(Xb,sc)&&Math.abs(Xb)<Math.abs(be)&&this.Ehb(kb,Pf,ug)&&cf&&(be=-1*Xb),this.tQa(Xb,sc)&&Math.abs(Xb)<Math.abs(Ue)&&this.Ehb(kb,Pf,ug)&&mf&&(Ue=Xb);Id.top=Td===Number.MAX_VALUE?Id.top:Td;Id.bottom=he===Number.MAX_VALUE?Id.bottom:he;Id.left=be===Number.MAX_VALUE?Id.left:be;Id.right=Ue===Number.MAX_VALUE?Id.right:Ue;return Id}Ugn(kb,Xb,sc,Rc,Zc,Id){let Td=Number.MAX_VALUE,he=Number.MAX_VALUE,be=Number.MAX_VALUE,Ue=Number.MAX_VALUE,cf=!0,mf=!0,
ig=!0,ug=!0;Id&&Zc&&(cf=Zc.equals(qe.a.west)||Zc.equals(qe.a.fD)||Zc.equals(qe.a.E1),mf=Zc.equals(qe.a.east)||Zc.equals(qe.a.rY)||Zc.equals(qe.a.JU),ig=Zc.equals(qe.a.north)||Zc.equals(qe.a.fD)||Zc.equals(qe.a.rY),ug=Zc.equals(qe.a.south)||Zc.equals(qe.a.E1)||Zc.equals(qe.a.JU));Zc=[];for(var Pf of Xb)Zc.push(new re.a(Pf.Lu()));Xb=this.Lz.Fs(sc.ge.width);sc=this.Lz.Fs(sc.ge.height);for(const mg of Zc)mg.Mc>Xb/2&&mg.Mc<3*Xb/4&&kb.Gd<Xb/2&&mf&&(Pf=Xb/2-kb.Gd-(mg.Mc-Xb/2),this.tQa(Pf,Rc)&&Math.abs(Pf)<
Math.abs(Ue)&&this.Ehb(kb,mg,Zc)&&(Ue=Pf)),mg.Gd<Xb/2&&mg.Gd>Xb/4&&kb.Mc>Xb/2&&cf&&(Pf=Xb/2-mg.Gd-(kb.Mc-Xb/2),this.tQa(Pf,Rc)&&Math.abs(Pf)<Math.abs(be)&&this.Ehb(kb,mg,Zc)&&(be=Pf)),mg.hd>sc/2&&mg.hd<3*sc/4&&kb.Bd<sc/2&&ug&&(Pf=sc/2-kb.Bd-(mg.hd-sc/2),this.tQa(Pf,Rc)&&Math.abs(Pf)<Math.abs(he)&&this.Ehb(kb,mg,Zc)&&(he=Pf)),mg.Bd<sc/2&&mg.Bd>sc/4&&kb.hd>sc/2&&ig&&(Pf=sc/2-mg.Bd-(kb.hd-sc/2),this.tQa(Pf,Rc)&&Math.abs(Pf)<Math.abs(Td)&&this.Ehb(kb,mg,Zc)&&(Td=Pf));kb=new Wg.a;kb.top=Td===Number.MAX_VALUE?
kb.top:Td;kb.bottom=he===Number.MAX_VALUE?kb.bottom:he;kb.left=be===Number.MAX_VALUE?kb.left:be;kb.right=Ue===Number.MAX_VALUE?kb.right:Ue;return kb}RAm(kb,Xb,sc,Rc,Zc,Id){Zc=this.j0h(Zc,Re.dHh);Id=this.j0h(Id,Re.dHh);for(var Td of Zc){Zc=kb.copy();Zc.move(0,0-Td);if(this.sNd(Zc,Xb,Rc,null,!1).count)return this.mbd(sc,0,-Td),!0;Zc=kb.copy();Zc.move(0,Td);if(this.sNd(Zc,Xb,Rc,null,!1).count)return this.mbd(sc,0,Td),!0}for(const he of Id){Td=kb.copy();Td.move(0-he,0);if(this.sNd(Td,Xb,Rc,null,!1).count)return this.mbd(sc,
-1*he,0),!0;Td=kb.copy();Td.move(he,0);if(this.sNd(Td,Xb,Rc,null,!1).count)return this.mbd(sc,he,0),!0}return!1}XIb(kb,Xb,sc){return sc?kb.Mc>=Xb.Mc&&kb.Mc<=Xb.Gd||kb.Gd>=Xb.Mc&&kb.Gd<=Xb.Gd||Xb.Mc>=kb.Mc&&Xb.Mc<=kb.Gd||Xb.Gd>=kb.Mc&&Xb.Gd<=kb.Gd:kb.hd>=Xb.hd&&kb.hd<=Xb.Bd||kb.Bd>=Xb.hd&&kb.Bd<=Xb.Bd||Xb.hd>=kb.hd&&Xb.hd<=kb.Bd||Xb.Bd>=kb.hd&&Xb.Bd<=kb.Bd}iFi(kb,Xb,sc,Rc,Zc){const Id=new F.a,Td=new F.a,he=new F.a;let be=!1,Ue=!1,cf=!1,mf=!1,ig=!0,ug=!0,Pf=!0,mg=!0;Zc&&Rc&&(ig=Rc.equals(qe.a.west)||
Rc.equals(qe.a.fD)||Rc.equals(qe.a.E1),ug=Rc.equals(qe.a.east)||Rc.equals(qe.a.rY)||Rc.equals(qe.a.JU),Pf=Rc.equals(qe.a.north)||Rc.equals(qe.a.fD)||Rc.equals(qe.a.rY),mg=Rc.equals(qe.a.south)||Rc.equals(qe.a.E1)||Rc.equals(qe.a.JU));Rc=this.Lz.Fs(sc.ge.width);sc=this.Lz.Fs(sc.ge.height);Zc=new Ra;Zc.Tm=new xa.a(Rc/2-this.RDa,0-this.X_);Zc.Jl=new xa.a(Rc/2-this.RDa,sc-this.X_);const Lf=new Ra;Lf.Tm=new xa.a(0-this.RDa,sc/2-this.X_);Lf.Jl=new xa.a(Rc-this.RDa,sc/2-this.X_);Lf.rna=!0;for(const Nd of Xb)Nd.Mc>
Rc/2&&Nd.Mc<3*Rc/4&&kb.Gd<Rc/2&&this.Ehb(kb,Nd,Xb)&&ug&&this.UV(Rc/2-kb.Gd,Nd.Mc-Rc/2)&&(be=!0,0>Nd.hd&&(Zc.Tm=new xa.a(Rc/2,Nd.hd)),Nd.Bd>sc&&(Zc.Jl=new xa.a(Rc/2,Nd.Bd+this.zp)),Id.add(this.Thd(Nd,!1,!1)),Td.add(this.Shd(Nd,!1,!1,Rc,sc))),Nd.Gd<Rc/2&&Nd.Gd>Rc/4&&kb.Mc>Rc/2&&this.Ehb(kb,Nd,Xb)&&ig&&this.UV(kb.Mc-Rc/2,Rc/2-Nd.Gd)&&(Ue=!0,0>Nd.hd&&(Zc.Tm=new xa.a(Rc/2,Nd.hd)),Nd.Bd>sc&&(Zc.Jl=new xa.a(Rc/2,Nd.Bd+this.zp)),Id.add(this.Thd(Nd,!1,!0)),Td.add(this.Shd(Nd,!1,!0,Rc,sc))),Nd.hd>sc/2&&Nd.hd<
3*sc/4&&kb.Bd<sc/2&&this.Ehb(kb,Nd,Xb)&&mg&&this.UV(sc/2-kb.Bd,Nd.hd-sc/2)&&(cf=!0,0>Nd.Mc&&(Lf.Tm=new xa.a(Nd.Mc,sc/2)),Nd.Gd>Rc&&(Lf.Jl=new xa.a(Nd.Gd+this.zp,sc/2)),Id.add(this.Thd(Nd,!0,!1)),Td.add(this.Shd(Nd,!0,!1,Rc,sc))),Nd.Bd<sc/2&&Nd.Bd>sc/4&&kb.hd>sc/2&&this.Ehb(kb,Nd,Xb)&&Pf&&this.UV(kb.hd-sc/2,sc/2-Nd.Bd)&&(mf=!0,0>Nd.Mc&&(Lf.Tm=new xa.a(Nd.Mc,sc/2)),Nd.Gd>Rc&&(Lf.Jl=new xa.a(Nd.Gd+this.zp,sc/2)),Id.add(this.Thd(Nd,!0,!0)),Td.add(this.Shd(Nd,!0,!0,Rc,sc)));(be||Ue)&&Id.add(this.sY(Zc));
(cf||mf)&&Id.add(this.sY(Lf));cf&&(kb.Mc<Lf.Tm._x&&(Lf.Tm=new xa.a(kb.Mc,sc/2)),kb.Gd>Lf.Jl._x&&(Lf.Jl=new xa.a(kb.Gd,sc/2+this.zp)),Id.add(this.Thd(kb,!0,!0)),Td.add(this.Shd(kb,!0,!0,Rc,sc)));mf&&(kb.Mc<Lf.Tm._x&&(Lf.Tm=new xa.a(kb.Mc,sc/2)),kb.Gd>Lf.Jl._x&&(Lf.Jl=new xa.a(kb.Gd,sc/2+this.zp)),Id.add(this.Thd(kb,!0,!1)),Td.add(this.Shd(kb,!0,!1,Rc,sc)));be&&(kb.hd<Zc.Tm._y&&(Zc.Tm=new xa.a(Rc/2,kb.hd)),kb.Bd>Zc.Jl._y&&(Zc.Jl=new xa.a(Rc/2,kb.Bd+this.zp)),Id.add(this.Thd(kb,!1,!0)),Td.add(this.Shd(kb,
!1,!0,Rc,sc)));Ue&&(kb.hd<Zc.Tm._y&&(Zc.Tm=new xa.a(Rc/2,kb.hd)),kb.Bd>Zc.Jl._y&&(Zc.Jl=new xa.a(Rc/2,kb.Bd+this.zp)),Id.add(this.Thd(kb,!1,!1)),Td.add(this.Shd(kb,!1,!1,Rc,sc)));this.jtd(Id,1);this.jtd(Td,2);for(const Nd of Id)he.add(Nd);for(const Nd of Td)he.add(Nd);return he}Thd(kb,Xb,sc){const Rc=Xb&&sc,Zc=Xb&&!sc,Id=!Xb&&!sc;return!Xb&&sc?(Xb=new Ra,Xb.Tm=new xa.a(kb.Gd-this.T$,kb.Bd),Xb.Jl=new xa.a(kb.Gd-this.T$,kb.Bd+this.zp),this.sY(Xb)):Id?(Xb=new Ra,Xb.Tm=new xa.a(kb.Mc-this.RDa,kb.Bd),
Xb.Jl=new xa.a(kb.Mc-this.RDa,kb.Bd+this.zp),this.sY(Xb)):Rc?(Xb=new Ra,Xb.Tm=new xa.a(kb.Gd,kb.Bd-this.Sgb),Xb.Jl=new xa.a(kb.Gd+this.zp,kb.Bd-this.Sgb),this.sY(Xb)):Zc?(Xb=new Ra,Xb.Tm=new xa.a(kb.Gd,kb.hd-this.X_),Xb.Jl=new xa.a(kb.Gd+this.zp,kb.hd-this.X_),this.sY(Xb)):null}Shd(kb,Xb,sc,Rc,Zc){const Id=Xb&&sc,Td=Xb&&!sc,he=!Xb&&!sc;return!Xb&&sc?(Zc=new Ra,Zc.rna=!0,Zc.Tm=new xa.a(Rc/2-this.RDa,kb.Bd+this.zp),Zc.Jl=new xa.a(kb.Gd-this.T$,kb.Bd+this.zp),this.sY(Zc)):he?(Zc=new Ra,Zc.rna=!0,Zc.Tm=
new xa.a(Rc/2-this.RDa,kb.Bd+this.zp),Zc.Jl=new xa.a(kb.Mc-this.RDa,kb.Bd+this.zp),this.sY(Zc)):Id?(Rc=new Ra,Rc.rna=!0,Rc.Tm=new xa.a(kb.Gd+this.zp,Zc/2-this.X_),Rc.Jl=new xa.a(kb.Gd+this.zp,kb.Bd-this.Sgb),this.sY(Rc)):Td?(Rc=new Ra,Rc.rna=!0,Rc.Tm=new xa.a(kb.Gd+this.zp,Zc/2-this.X_),Rc.Jl=new xa.a(kb.Gd+this.zp,kb.hd-this.X_),this.sY(Rc)):null}Hin(kb,Xb,sc,Rc,Zc,Id){let Td=Number.MAX_VALUE,he=Number.MAX_VALUE,be=Number.MAX_VALUE,Ue=Number.MAX_VALUE,cf=!0,mf=!0,ig=!0,ug=!0;Id&&Zc&&(cf=Zc.equals(qe.a.west)||
Zc.equals(qe.a.fD)||Zc.equals(qe.a.E1),mf=Zc.equals(qe.a.east)||Zc.equals(qe.a.rY)||Zc.equals(qe.a.JU),ig=Zc.equals(qe.a.north)||Zc.equals(qe.a.fD)||Zc.equals(qe.a.rY),ug=Zc.equals(qe.a.south)||Zc.equals(qe.a.E1)||Zc.equals(qe.a.JU));Zc=[];for(const Pf of Xb)Zc.push(new re.a(Pf.Lu()));Xb=this.Lz.Fs(sc.ge.width);sc=this.Lz.Fs(sc.ge.height);for(const Pf of Zc)Pf.Gd>3*Xb/4&&Pf.Gd<Xb&&kb.Mc<Xb/4&&0<kb.Mc&&this.XIb(kb,Pf,!1)&&cf&&(Zc=Xb-Pf.Gd-kb.Mc,this.tQa(Zc,Rc)&&Math.abs(Zc)<Math.abs(be)&&(be=Zc)),
Pf.Mc<Xb/4&&0<Pf.Mc&&kb.Gd>3*Xb/4&&kb.Gd<Xb&&this.XIb(kb,Pf,!1)&&mf&&(Zc=Xb-kb.Gd-Pf.Mc,this.tQa(Zc,Rc)&&Math.abs(Zc)<Math.abs(Ue)&&(Ue=Zc)),Pf.Bd>3*sc/4&&Pf.Bd<sc&&kb.hd<sc/4&&0<kb.hd&&this.XIb(kb,Pf,!0)&&ig&&(Zc=sc-Pf.Bd-kb.hd,this.tQa(Zc,Rc)&&Math.abs(Zc)<Math.abs(Td)&&(Td=Zc)),Pf.hd<sc/4&&0<Pf.hd&&kb.Bd>3*sc/4&&kb.Bd<sc&&this.XIb(kb,Pf,!0)&&ug&&(Zc=sc-kb.Bd-Pf.hd,this.tQa(Zc,Rc)&&Math.abs(Zc)<Math.abs(he)&&(he=Zc));kb=new Wg.a;kb.top=Td===Number.MAX_VALUE?kb.top:Td;kb.bottom=he===Number.MAX_VALUE?
kb.bottom:he;kb.left=be===Number.MAX_VALUE?kb.left:be;kb.right=Ue===Number.MAX_VALUE?kb.right:Ue;return kb}sNd(kb,Xb,sc,Rc,Zc){const Id=new F.a,Td=new F.a,he=new F.a;var be=!1,Ue=!1,cf=!1,mf=!1,ig=!0;let ug=!0,Pf=!0,mg=!0;Zc&&Rc&&(ig=Rc.equals(qe.a.west)||Rc.equals(qe.a.fD)||Rc.equals(qe.a.E1),ug=Rc.equals(qe.a.east)||Rc.equals(qe.a.rY)||Rc.equals(qe.a.JU),Pf=Rc.equals(qe.a.north)||Rc.equals(qe.a.fD)||Rc.equals(qe.a.rY),mg=Rc.equals(qe.a.south)||Rc.equals(qe.a.E1)||Rc.equals(qe.a.JU));Rc=this.Lz.Fs(sc.ge.width);
sc=this.Lz.Fs(sc.ge.height);for(const Lf of Xb)Lf.Gd>3*Rc/4&&Lf.Gd<Rc&&kb.Mc<Rc/4&&0<kb.Mc&&this.XIb(kb,Lf,!1)&&ig&&this.UV(kb.Mc,Rc-Lf.Gd)&&(be=!0,Xb=new Ra,Xb.Tm=new xa.a(Lf.Gd-this.T$,Lf.Bd),Xb.Jl=new xa.a(Lf.Gd-this.T$,Lf.Bd+this.zp),Id.add(this.sY(Xb)),Xb=new Ra,Xb.rna=!0,Xb.Tm=new xa.a(Rc-this.T$,Lf.Bd+this.zp),Xb.Jl=new xa.a(Lf.Gd-this.T$,Lf.Bd+this.zp),Td.add(this.sY(Xb))),Lf.Mc<Rc/4&&0<Lf.Mc&&kb.Gd>3*Rc/4&&kb.Mc<Rc&&this.XIb(kb,Lf,!1)&&ug&&this.UV(Rc-kb.Gd,Lf.Mc)&&(Ue=!0,Xb=new Ra,Xb.Tm=
new xa.a(Lf.Mc-this.RDa,Lf.Bd),Xb.Jl=new xa.a(Lf.Mc-this.RDa,Lf.Bd+this.zp),Id.add(this.sY(Xb)),Xb=new Ra,Xb.rna=!0,Xb.Tm=new xa.a(0-this.RDa,Lf.Bd+this.zp),Xb.Jl=new xa.a(Lf.Mc-this.RDa,Lf.Bd+this.zp),Td.add(this.sY(Xb))),Lf.Bd>3*sc/4&&Lf.Bd<sc&&kb.hd<sc/4&&0<kb.hd&&this.XIb(kb,Lf,!0)&&Pf&&this.UV(kb.hd,sc-Lf.Bd)&&(cf=!0,Xb=new Ra,Xb.Tm=new xa.a(Lf.Gd,Lf.Bd-this.Sgb),Xb.Jl=new xa.a(Lf.Gd+this.zp,Lf.Bd-this.Sgb),Id.add(this.sY(Xb)),Zc=new Ra,Xb.rna=!0,Zc.Tm=new xa.a(Lf.Gd+this.zp,Lf.Bd-this.Sgb),
Zc.Jl=new xa.a(Lf.Gd+this.zp,sc-this.Sgb),Td.add(this.sY(Zc))),Lf.hd<sc/4&&0<Lf.hd&&kb.Bd>3*sc/4&&kb.Bd<sc&&this.XIb(kb,Lf,!0)&&mg&&this.UV(sc-kb.Bd,Lf.hd)&&(mf=!0,Xb=new Ra,Xb.Tm=new xa.a(Lf.Gd,Lf.hd-this.X_),Xb.Jl=new xa.a(Lf.Gd+this.zp,Lf.hd-this.X_),Id.add(this.sY(Xb)),Zc=new Ra,Xb.rna=!0,Zc.Tm=new xa.a(Lf.Gd+this.zp,0-this.X_),Zc.Jl=new xa.a(Lf.Gd+this.zp,Lf.hd-this.X_),Td.add(this.sY(Zc)));cf&&(cf=new Ra,cf.Tm=new xa.a(kb.Gd,kb.hd-this.X_),cf.Jl=new xa.a(kb.Gd+this.zp,kb.hd-this.X_),Id.add(this.sY(cf)),
ig=new Ra,cf.rna=!0,ig.Tm=new xa.a(kb.Gd+this.zp,0-this.X_),ig.Jl=new xa.a(kb.Gd+this.zp,kb.hd-this.X_),Td.add(this.sY(ig)));mf&&(mf=new Ra,mf.Tm=new xa.a(kb.Gd,kb.Bd-this.Sgb),mf.Jl=new xa.a(kb.Gd+this.zp,kb.Bd-this.Sgb),Id.add(this.sY(mf)),cf=new Ra,mf.rna=!0,cf.Tm=new xa.a(kb.Gd+this.zp,sc-this.Sgb),cf.Jl=new xa.a(kb.Gd+this.zp,kb.Bd-this.Sgb),Td.add(this.sY(cf)));be&&(be=new Ra,be.Tm=new xa.a(kb.Mc-this.RDa,kb.Bd),be.Jl=new xa.a(kb.Mc-this.RDa,kb.Bd+this.zp),Id.add(this.sY(be)),be=new Ra,be.rna=
!0,be.Tm=new xa.a(0-this.RDa,kb.Bd+this.zp),be.Jl=new xa.a(kb.Mc-this.RDa,kb.Bd+this.zp),Td.add(this.sY(be)));Ue&&(Ue=new Ra,Ue.Tm=new xa.a(kb.Gd-this.T$,kb.Bd),Ue.Jl=new xa.a(kb.Gd-this.T$,kb.Bd+this.zp),Id.add(this.sY(Ue)),Ue=new Ra,Ue.rna=!0,Ue.Tm=new xa.a(Rc-this.T$,kb.Bd+this.zp),Ue.Jl=new xa.a(kb.Gd-this.T$,kb.Bd+this.zp),Td.add(this.sY(Ue)));this.jtd(Id,1);this.jtd(Td,2);for(const Lf of Id)he.add(Lf);for(const Lf of Td)he.add(Lf);return he}r_m(kb,Xb,sc){var Rc=new Ra;const Zc=new Ra,Id=new Ra,
Td=new Ra,he=new Ra,be=new Ra,Ue=new F.a;Ue.add(Rc);Ue.add(Zc);Ue.add(Id);Ue.add(Td);Ue.add(he);Ue.add(be);this.jtd(Ue,0);this.qvn(Rc,Zc,Id,Td,he,be,kb);for(const cf of Xb)this.Bfb(kb.hd,cf.hd,cf.Bd,Rc,cf),this.Bfb(kb.Bd,cf.hd,cf.Bd,Zc,cf),this.Bfb(kb.Mc,cf.Mc,cf.Gd,Id,cf),this.Bfb(kb.Gd,cf.Mc,cf.Gd,Td,cf),this.T0e&&(this.Bfb(kb.hd,cf.Ki()._y,null,Rc,cf),this.Bfb(kb.Bd,cf.Ki()._y,null,Zc,cf),this.Bfb(kb.Mc,cf.Ki()._x,null,Id,cf),this.Bfb(kb.Gd,cf.Ki()._x,null,Td,cf),this.Bfb(kb.Ki()._y,cf.hd,null,
he,cf),this.Bfb(kb.Ki()._y,cf.Bd,null,he,cf),this.Bfb(kb.Ki()._x,cf.Mc,null,be,cf),this.Bfb(kb.Ki()._x,cf.Gd,null,be,cf)),this.Bfb(kb.Ki()._y,cf.Ki()._y,null,he,cf),this.Bfb(kb.Ki()._x,cf.Ki()._x,null,be,cf);0<Rc.length()&&0<Zc.length()&&(this.T0e?(he.Tm=new xa.a(kb.Mc-this.zp,kb.Ki()._y),he.Jl=he.Tm.copy()):he.reset());0<Id.length()&&0<Td.length()&&(this.T0e?(be.Tm=new xa.a(kb.Ki()._x,kb.Mc-this.RDa),be.Jl=be.Tm.copy()):be.reset());if(this.T0e&&sc){Xb=this.Lz.Fs(sc.ge.width);sc=this.Lz.Fs(sc.ge.height);
if(this.UV(kb.hd,sc/2)||Math.abs(kb.hd)<=Re.TMd||this.UV(kb.hd,sc))Rc.Tm._x=Math.min(Rc.Tm._x,-1*this.zp),Rc.Jl._x=Math.max(Rc.Jl._x,Xb+this.zp);if(this.UV(kb.Bd,sc/2)||Math.abs(kb.Bd)<=Re.TMd||this.UV(kb.Bd,sc))Zc.Tm._x=Math.min(Zc.Tm._x,-1*this.zp),Zc.Jl._x=Math.max(Zc.Jl._x,Xb+this.zp);if(this.UV(kb.Ki()._y,sc/2)||Math.abs(kb.Ki()._y)<=Re.TMd||this.UV(kb.Ki()._y,sc))he.Tm._x=Math.min(he.Tm._x,-1*this.zp),he.Jl._x=Math.max(he.Jl._x,Xb+this.zp);if(this.UV(kb.Gd,Xb/2)||Math.abs(kb.Gd)<=Re.TMd||this.UV(kb.Gd,
Xb))Td.Tm._y=Math.min(Td.Tm._y,-1*this.zp),Td.Jl._y=Math.max(Td.Jl._y,sc+this.zp);if(this.UV(kb.Mc,Xb/2)||Math.abs(kb.Mc)<=Re.TMd||this.UV(kb.Mc,Xb))Id.Tm._y=Math.min(Id.Tm._y,-1*this.zp),Id.Jl._y=Math.max(Id.Jl._y,sc+this.zp);if(this.UV(kb.Ki()._x,Xb/2)||Math.abs(kb.Ki()._x)<=Re.TMd||this.UV(kb.Ki()._x,Xb))be.Tm._y=Math.min(be.Tm._y,-1*this.zp),be.Jl._y=Math.max(be.Jl._y,sc+this.zp)}Rc=new F.a;for(const cf of Ue)cf.Tm&&0<cf.length()&&(this.F_l(cf,kb),Rc.add(this.sY(cf)));return Rc}Bfb(kb,Xb,sc,Rc,
Zc){(this.UV(kb,Xb)||this.UV(kb,sc))&&this.F_l(Rc,Zc)}F_l(kb,Xb){kb.rna?(kb.Tm._x=Math.min(kb.Tm._x,Xb.Mc-this.zp),kb.Jl._x=Math.max(kb.Jl._x,Xb.Gd+this.zp)):(kb.Tm._y=Math.min(kb.Tm._y,Xb.hd-this.zp),kb.Jl._y=Math.max(kb.Jl._y,Xb.Bd+this.zp))}sY(kb){let Xb;(Xb=kb.Tm).x=Xb.x+this.uSh;let sc;(sc=kb.Tm).y=sc.y+this.vSh;let Rc;(Rc=kb.Jl).x=Rc.x+this.uSh;let Zc;(Zc=kb.Jl).y=Zc.y+this.vSh;return kb}UV(kb,Xb){var sc=Re.TMd;return!!kb&&!!Xb&&Math.abs(kb-Xb)<=sc}qvn(kb,Xb,sc,Rc,Zc,Id,Td){kb.Tm=new xa.a(Td.Mc-
this.zp,Td.hd-this.X_);kb.Jl=kb.Tm.copy();kb.rna=!0;Xb.Tm=new xa.a(Td.Mc-this.zp,Td.Bd-this.Sgb);Xb.Jl=Xb.Tm.copy();Xb.rna=!0;sc.Tm=new xa.a(Td.Mc-this.RDa,Td.hd-this.zp);sc.Jl=sc.Tm.copy();Rc.Tm=new xa.a(Td.Gd-this.T$,Td.hd-this.zp);Rc.Jl=Rc.Tm.copy();Xb=Td.Ki();Zc.Tm=new xa.a(kb.Tm._x-this.zp,Xb._y-this.X_);Zc.Jl=Zc.Tm.copy();Zc.rna=!0;Id.Tm=new xa.a(Xb._x-this.zp,sc.Tm._y-this.zp);Id.Jl=Id.Tm.copy()}jtd(kb,Xb){for(const sc of kb)0===Xb?(sc.color=Qa.a.QUl,sc.dashStyle="4,4",sc.H8f=0):1===Xb?(sc.color=
Qa.a.PUl,sc.dashStyle="4,4",sc.H8f=1):2===Xb&&(sc.color=Qa.a.ALi,sc.dashStyle="4,4",sc.H8f=2)}get zkm(){return this.uSh}set zkm(kb){this.uSh=kb}get Akm(){return this.vSh}set Akm(kb){this.vSh=kb}}Re.TMd=.4;Re.dHh=5;Object(d.a)(Re,"SmartGuideUtility",null,[506]);var Be=a(197),rf=a(230),qa=a(246);class Fb{constructor(kb,Xb,sc,Rc,Zc,Id){this.U0e=this.V0e=this.Hb=null;this.TRa=new Sys.UI.Bounds(0,0,0,0);this.zhb=1;this.kh=this.pc=!1;this.Mf=kb;this.qk=Xb;this.od=Rc;this.Oc=sc;this.nc=Zc;this.kh=Id.getBooleanAppSetting(Of.a.EJ);
this.od.mXa(Object(H.a)(this,this.Yn,"onResize"));this.od.Reb(Object(H.a)(this,this.baa,"onActiveSlideDomDisplayed"));this.Yq()}get visible(){return!!this.Hb&&this.pc}set visible(kb){this.Hb||this.Yq();this.pc!==kb&&(this.Hb.oe(kb),this.pc=kb)}m1i(kb){this.U0e&&this.V0e.va.removeChild(this.U0e.va);this.U0e=new rf.a;let Xb=0;for(;Xb<kb.length;Xb++){const sc=kb[Xb],Rc=new Wf.a,Zc=Fb.JAn(Fb.Esm(xa.a.scale(sc.Tm,this.zhb,this.zhb)),Fb.Esm(xa.a.scale(sc.Jl,this.zhb,this.zhb)));Rc.py(Zc);Rc.PC(this.H1l(sc.color));
Rc.Kua(sc.dashStyle);Rc.Hx(1/this.JB);this.U0e.appendChild(Rc);2===sc.H8f&&this.d9m(Zc[0],Zc[1])}this.V0e.appendChild(this.U0e)}d9m(kb,Xb){kb._y===Xb._y?kb._x<Xb._x?this.iWl(kb,Xb):this.iWl(Xb,kb):kb._y>Xb._y?this.jWl(kb,Xb):this.jWl(Xb,kb)}iWl(kb,Xb){const sc=this.nTl(Xb._x-kb._x);this.fIh([new xa.a(kb._x,kb._y),new xa.a(kb._x+sc,kb._y-sc/2),new xa.a(kb._x+sc,kb._y+sc/2)]);this.fIh([new xa.a(Xb._x,Xb._y),new xa.a(Xb._x-sc,Xb._y-sc/2),new xa.a(Xb._x-sc,Xb._y+sc/2)])}jWl(kb,Xb){const sc=this.nTl(kb._y-
Xb._y);this.fIh([new xa.a(kb._x,kb._y),new xa.a(kb._x-sc/2,kb._y-sc),new xa.a(kb._x+sc/2,kb._y-sc)]);this.fIh([new xa.a(Xb._x,Xb._y),new xa.a(Xb._x-sc/2,Xb._y+sc),new xa.a(Xb._x+sc/2,Xb._y+sc)])}nTl(kb){return Math.min(kb,10)/2}fIh(kb){const Xb=new Wf.a,sc=this.H1l(Qa.a.ALi);Xb.py(kb);Xb.PC(sc);Xb.Hx(1/this.JB);Xb.eP(sc);Xb.oe(!0);this.U0e.appendChild(Xb)}H1l(kb){return this.qk&&this.qk.highContrastColors?this.qk.highContrastColors.foregroundTextColor:kb}Yq(){this.Hb=new pe.a;this.Hb.Nw("SmartGuideView");
this.Hb.yk(0);this.Hb.oe(!1);this.Mf.va.appendChild(this.Hb.va);this.V0e=new qa.a;this.V0e.va.style.overflow="visible";this.Hb.appendChild(this.V0e);this.WC(this.Oc.jd)}Yn(kb,Xb){Xb&&this.WC(Xb.FB)}baa(kb,Xb){Xb&&this.WC(Xb.FB)}get JB(){var kb,Xb;return this.kh?null!==(Xb=null===(kb=this.nc)||void 0===kb?void 0:kb.JB)&&void 0!==Xb?Xb:1:1}WC(kb){this.Hb&&kb&&kb.ge&&kb===this.Oc.jd&&(this.kh&&Be.a.jma(this.Hb.va,this.nc.$F),this.TRa.x!==kb.ge.x||this.TRa.y!==kb.ge.y||this.TRa.width!==kb.ge.width||this.TRa.height!==
kb.ge.height)&&(this.TRa=new Sys.UI.Bounds(kb.ge.x,kb.ge.y,kb.ge.width,kb.ge.height),this.Hb.setPosition(kb.ge.x,kb.ge.y),this.V0e.zh(kb.ge.width,kb.ge.height),this.Hb.zh(kb.ge.width,kb.ge.height))}static JAn(kb,Xb){Xb._y===kb._y||Math.abs(Xb._y-kb._y)%2||(Xb._y+=1);Xb._x===kb._x||Math.abs(Xb._x-kb._x)%2||(Xb._x+=1);return[kb,Xb]}static Esm(kb){return new xa.a(Math.floor(kb.x)+.5,Math.floor(kb.y)+.5)}}Object(d.a)(Fb,"SmartGuideView",null,[505]);class oa{setPosition(kb,Xb,sc){kb.setPosition(kb.x+Xb,
kb.y+sc,!0)}setOffsets(kb,Xb){kb.setOffsets(Wg.a.add(kb.eZa,Xb),!0)}$qa(kb){return new re.a(kb.Lu())}XJ(kb){return!kb.shapeNode.Yw}}Object(d.a)(oa,"DefaultShapeMoveResizeHandler",null,[552]);class eb{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.SmartGuide"}oc(kb){this.ga=kb;this.ga.register(504,"PowerPointWebEditor.ISmartGuideManager").oa().pa(()=>new Jh(this.ga.resolve("PowerPointWebEditor.ISmartGuideView"),this.ga.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.ga.resolve("PowerPointWebEditor.IActiveSlideViewManager"),
this.ga.resolve("PowerPointWebEditor.ISmartGuideUtility"),this.ga.resolve("PowerPointWebEditor.IZoomContext"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").B3e));this.ga.register(505,"PowerPointWebEditor.ISmartGuideView").oa().pa(()=>new Fb(this.ga.resolve("PowerPointWebEditor.ISlidePane"),this.ga.resolve("Common.Utils.IHighContrastDetector"),this.ga.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.ga.resolve("PowerPointWebEditor.IZoomContext"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings")));this.ga.register(506,"PowerPointWebEditor.ISmartGuideUtility").oa().pa(()=>new Re(this.ga.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").A3e))}init(){this.ga.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new oa);this.ga.resolve("PowerPointWebEditor.ISmartGuideManager")}dispose(){}static main(){h.a.instance.Jc(new eb)}}
Object(d.a)(eb,"PPTWebEditorSmartGuidePackage",null,[4,5]);var Bb;(function(kb){kb[kb.notLoaded=1]="notLoaded";kb[kb.loaded=2]="loaded";kb[kb.failed=3]="failed"})(Bb||(Bb={}));Object(d.b)("WebSocketCompressionHelperLoadState",Bb);var $b=a(1502),tc=a(478),xc=a(198),cd=a(1221),od=a(1222);class sd{constructor(kb,Xb,sc,Rc,Zc,Id=!1){this.bpd=this.Bs=this.Gpd=null;this.mhb=-1;this.$6b=this.VQa=0;this.$nd=-1;this.Z_e=0;this.$_e=null;this.bod=0;this.m_=!1;if(!kb)throw Error.argumentNull("webSocketClient");
this.qY=kb;this.pb=Xb;this.WG=sc;this.ud=Rc;this.m_=Id;kb=document.createElement("a");kb.href=this.qY.Voo;kb.protocol="http:"===kb.protocol?"ws":"wss";n.a("PodsWebSocketFrontDoor.UseQueryString")?(kb=new xc.QueryStringBuilder(kb.href),n.a("PodsWebSocketFrontDoor.UseWacClusterQueryString")&&kb.ej(gb.a.oWh,Xb.Hp),n.a("PodsWebSocketFrontDoor.UseUsidQueryString")&&kb.ej(gb.a.apm,e.AFrameworkApplication.userSessionId),kb.ej(gb.a.Fqd,Zc.toString()),this.Gpd=kb.toString()):this.Gpd=kb.href;this.tme=qc.a.VK(this.Gpd);
this.xjd(2);this.oSa=this.qY.Ovm;this.Mrg=this.qY.u1m;this.slh();this.ud.Teb(Object(H.a)(this,this.inc,"onSessionEnding"));this.ud.eI(Object(H.a)(this,this.qr,"onSessionRehydrated"))}dispose(){this.ud.$De(Object(H.a)(this,this.inc,"onSessionEnding"));this.ud.Tna(Object(H.a)(this,this.qr,"onSessionRehydrated"))}xjd(kb){this.m_||(this.Bs&&this.Bs.close(),this.Bs=cd.a(this.Gpd,[]),this.Bs.onopen=Object(H.a)(this,this.onOpen,"onOpen"),this.Bs.onerror=Object(H.a)(this,this.onError,"onError"),this.Bs.onclose=
Object(H.a)(this,this.onClose,"onClose"),this.Bs.onmessage=Object(H.a)(this,this.onMessage,"onMessage"),this.bod=kb,m.a.$(508077727,this.qY.IIa,50,"WebSocketFetcher::ConnectWebSocket - WebSocket connected WebSocketDomain:{0}, WacCluster:{1}, ConnectionReason:{2}",this.tme,this.pb.Hp,this.bod))}ping(){if(this.Bs)if(1===this.Bs.readyState){const kb=this.qY.$4m();this.Bs.send(kb)}else m.a.$(508077725,this.qY.IIa,10,"WebSocketFetcher::Ping. Wrong WebSocket state {0}",this.Bs.readyState),this.Tbb(4);else m.a.$(508077726,
this.qY.IIa,50,"WebSocketFetcher::Ping Websocket is unavailable.")}x1m(){this.Bs.close()}onOpen(){m.a.$(508077724,this.qY.IIa,50,"WebSocketFetcher::OnOpen WebSocketDomain:{0}, WacCluster:{1}",this.tme,this.pb.Hp);this.bsd();this.Z_e=0;this.$_e=null;this.qY.QQn()}onError(kb){m.a.$(508077723,this.qY.IIa,10,"WebSocketFetcher::OnError {0}, WebSocketDomain:{1}, WacCluster:{2}",JSON.stringify(kb),this.tme,this.pb.Hp)}onClose(kb){m.a.$(508077722,this.qY.IIa,50,"WebSocketFetcher::OnClose WebSocketDomain:{0}, WacCluster:{1}, EventInfo:{2}, CloseEventCode:{3}, CloseEventReason:{4}",
this.tme,this.pb.Hp,JSON.stringify(kb),kb.code,kb.reason);this.Z_e=kb.code;this.$_e=kb.reason}onMessage(kb){try{kb&&kb.data&&this.qY.E_g(kb)}catch(Xb){m.a.$(508077721,this.qY.IIa,10,"WebSocketFetcher::OnMessage",Xb.toString())}}slh(){this.bpd=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.$nd),this.Bs||(m.a.$(508077720,this.qY.IIa,50,"WebSocketFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.Tbb(1))):this.$nd=window.setTimeout(()=>{this.Bs&&
(m.a.$(508077719,this.qY.IIa,50,"WebSocketFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.Z_e=1E3,this.$_e="Lost visibility",this.Bs.close(this.Z_e,this.$_e),this.Bs=null,window.clearTimeout(this.mhb))},this.Mrg)};window.self.addEventListener("visibilitychange",this.bpd)}bsd(){this.VQa=0}Lyf(){0<this.qY.BUh&&(new Date).getTime()-this.$6b>this.qY.BUh&&(this.bsd(),m.a.$(508077718,this.qY.IIa,50,"WebSocketFetcher::Retry connect to server after long pause."))}AFf(){const kb=
!!this.WG&&!!this.WG.instance&&!this.WG.instance.F5,Xb=(new Date).getTime()-this.$6b>this.oSa,sc=this.VQa<this.qY.njm,Rc=!this.Bs||3===this.Bs.readyState||2===this.Bs.readyState,Zc=kb&&Xb&&sc&&Rc;m.a.$(508077717,this.qY.IIa,50,"WebSocketFetcher::CanRetry: canRetry:{0}, isPodsSessionAlive:{1}, retryTimeReached:{2}, retryAttemptsAvailable:{3}, noWebSocket:{4}",Zc,kb,Xb,sc,Rc);return Zc}nkh(){this.$6b=(new Date).getTime();this.oSa=Math.pow(2,this.VQa)*this.qY.Ovm;0<this.qY.BUh&&(this.oSa=Math.min(this.oSa,
this.qY.BUh));window.setTimeout(()=>{this.Tbb(3)},this.oSa)}Tbb(kb){this.Lyf();this.AFf()&&(this.xjd(kb),this.nkh(),this.VQa++,kb!==this.bod&&m.a.$(508077716,this.qY.IIa,10,"WebSocketFetcher::ReconnectionReasonMismatch ReconnectionReason:{0}, m_reconnectionReason{1}",kb,this.bod),m.a.$(508077715,this.qY.IIa,50,"WebSocketFetcher::Retry connect to server. ReconnectionReason:{0}",this.bod),this.VQa===this.qY.njm&&m.a.$(508077714,this.qY.IIa,50,"WebSocketFetcher::Max retries reached. ReconnectionReason:{0}",
this.bod))}sendMessage(kb,Xb){if(!this.Bs)return m.a.$(508077713,this.qY.IIa,50,"WebSocketFetcher::SendMessage Websocket is unavailable. RequestType:{0}, LastCloseCode:{1}, LastCloseReason:{2}",Xb,this.Z_e,this.$_e),1;m.a.$(508077712,this.qY.IIa,50,"WebSocketFetcher::SendMessage. WebSocket state {0}, RequestType:{1}, LastCloseCode:{2}, LastCloseReason:{3}",od.a[this.Bs.readyState],Xb,this.Z_e,this.$_e);if(1===this.Bs.readyState)return this.Bs.send(kb),0;this.Tbb(5);return 2}pco(){this.Bs.binaryType=
"arraybuffer"}jqd(){-1!==this.mhb&&window.clearTimeout(this.mhb);this.mhb=window.setTimeout(()=>{this.ping()},this.qY.$Wn)}P0m(){this.bod=0}inc(){this.Bs&&(m.a.$(508077711,this.qY.IIa,50,"WebSocketFetcher::OnSessionEnding: closing due to session ending."),this.Bs.close(),this.Bs=null)}qr(){this.Bs||(m.a.$(508077710,this.qY.IIa,50,"WebSocketFetcher::OnSessionRehydrated: reconnecting after session rehydrated."),this.Tbb(6))}}Object(d.a)(sd,"WebSocketFetcher",null,[659,40]);var wd;(function(kb){kb[kb.none=
0]="none";kb[kb.visibilityRegainedReconnection=1]="visibilityRegainedReconnection";kb[kb.initialConnection=2]="initialConnection";kb[kb.timeoutReconnection=3]="timeoutReconnection";kb[kb.webSocketNotOpenOnPingReconnection=4]="webSocketNotOpenOnPingReconnection";kb[kb.webSocketNotOpenedReconnection=5]="webSocketNotOpenedReconnection";kb[kb.sessionRehydrationReconnection=6]="sessionRehydrationReconnection"})(wd||(wd={}));Object(d.b)("ConnectionReason",wd);var Hd;(function(kb){kb[kb.success=0]="success";
kb[kb.nullWebSocket=1]="nullWebSocket";kb[kb.webSocketNotOpened=2]="webSocketNotOpened"})(Hd||(Hd={}));Object(d.b)("SendMessageStatusCode",Hd);class Wd extends Sys.EventArgs{constructor(kb,Xb,sc){super();this.response=kb;this.Fvm=Xb;this.t9l=sc}}Object(d.a)(Wd,"WebSocketFrontDoorEventArgs",Sys.EventArgs,[]);var mb=a(810);class lc{constructor(kb,Xb,sc,Rc,Zc){this.vk=window.performance.now();this.ulk=new kc.a;this.dck=this.tod=!0;this.u_e=null;this.e1e=1;this.pb=Xb;this.yme=kb.pFm;this.SFg=kb.qFm;this.DFn=
kb.nFm;this.tGn=kb.oFm;this.HDn=kb.lFm;this.A0e=kb.fud;this.Aqe=kb.SEm;this.zpk=kb.mFm;this.tme=qc.a.VK(this.zpk);this.Tmc=new sd(this,Xb,sc,Rc,new tc.a(kb.Ela),kb.getBooleanAppSetting("blockWebsocketConnectionForPAS"));if(Zc)this.u_e=Zc;else throw Error.argumentNull("dynamicScriptLoader");}dispose(){this.Tmc.dispose()}ping(){this.Tmc.ping()}gH(kb){const Xb=new Map,sc=this.wnn(kb);kb.smartArtEditOpRequest&&(Xb.set("requestType",sc),Xb.set("correlationId",kb.smartArtEditOpRequest.commonData?kb.smartArtEditOpRequest.commonData.correlationId:
null),N.Health.instance.recordKpiUsage("DeltaEdit",$b.b.SuccessBased,"gc2smartart",Xb));this.A0e?(kb=this.Tmc.sendMessage(JSON.stringify(kb),sc),0!==kb&&(Xb.set("SendMessageStatusCode",Hd[kb]),N.Health.instance.recordKpiFailure("DeltaEdit","SendRequestFailure",!1,!0,{extendedProperties:Xb}))):N.Health.instance.recordKpiFailure("DeltaEdit","WebSocketProtobufBRSDisabled",!0,!0,{extendedProperties:Xb})}xQl(kb){this.ulk.addHandler("ResponseReceivedEventId",kb)}Eum(kb){this.ulk.removeHandler("ResponseReceivedEventId",
kb)}QQn(){if(this.A0e){var kb=Gc.a.Bb?Gc.a.Bb.actionId:Db.a.create().toString(),Xb=e.AFrameworkApplication.userSessionId,sc=this.pb.Hp;this.dck=!0;Xb=mb.p(kb,Xb,this.pb.podSessionId,sc);Xb=this.Tmc.sendMessage(JSON.stringify(Xb),"validateSession");m.a.$(508368854,839,0===Xb?50:10,"PodsFrontDoorWebSocket::OnConnectionOpened ValidateSessionRequest correlationId:{0}, SendMessageStatusCode:{1}, WebSocketDomain:{2}, WacCluster:{3}",kb,Hd[Xb],this.tme,sc)}}E_g(kb){if(this.A0e)try{const Xb=this.qan(kb);
if(Xb.pong)this.jqd(Xb.pong.pingTimestamp);else if(Xb.validateSessionResponse)this.SUn(Xb.validateSessionResponse);else if(Xb.compressionHandshakeResponse)this.NQn(Xb.compressionHandshakeResponse);else{const sc=Object.getType(kb.data)!==String;this.ulk.raiseEvent("ResponseReceivedEventId",new Wd(Xb,this.Dkn(kb,sc),sc))}}catch(Xb){m.a.$(508368853,839,10,"PodsFrontDoorWebSocket Failed to parse WebSocketFrontDoorServiceResponse")}else this.jqd(kb.data)}qan(kb){let Xb=Object.getType(kb.data)===String?
kb.data:null;if(Xb)return JSON.parse(Xb);if(2===this.e1e)return kb=new Uint8Array(kb.data),Xb=WebSocketCompressionHelper.WebSocketCompressionHelper.decompressTextWithDeflateRaw(kb),JSON.parse(Xb);m.a.$(508368852,839,10,"PodsFrontDoorWebSocket: ExtractMessageReceive could not decompress data because WebSocketCompressionHelper is not loaded");return JSON.parse("")}Dkn(kb,Xb){return Xb?(new Uint8Array(kb.data)).byteLength:kb.data.length}SUn(kb){if(kb.isValid){kb=Gc.a.Bb?Gc.a.Bb.actionId:Db.a.create().toString();
var Xb=e.AFrameworkApplication.userSessionId,sc=this.pb.podSessionId,Rc=this.pb.Hp;m.a.$(508368850,839,50,"PodsWebSocketFrontDoor::OnValidateSessionResponse - WebSocketCompressionHelperLoadState:{0}",Bb[this.e1e]);1===this.e1e?this.lBn(kb,Xb,sc,Rc):2===this.e1e&&this.pxm(kb,Xb,sc,Rc);this.ping()}else m.a.$(508368851,839,10,"PodsWebSocketFrontDoor::OnMessageReceived - Closing WebSocket because session not valid. WebSocketDomain:{0}, WacCluster:{1}",this.tme,this.pb.Hp),this.Tmc.x1m()}lBn(kb,Xb,sc,
Rc){this.u_e.loadScript("WebSocketCompressionHelper").then(()=>{this.e1e=2;this.pxm(kb,Xb,sc,Rc)}).catch(()=>{m.a.$(508368849,839,10,"PodsFrontDoorWebSocket WebSocketCompressionHelper failed to load");this.e1e=3})}pxm(kb,Xb,sc,Rc){kb=mb.a(kb,Xb,sc,!0,Rc);kb=this.Tmc.sendMessage(JSON.stringify(kb),"compressionHandshake");m.a.$(508368848,839,50,"PodsFrontDoorWebSocket WebSocketCompressionHelper loaded and sent compression handshake with status code {0}",kb)}NQn(kb){kb=kb.clientReadyForCompression;m.a.$(508368847,
839,50,"PodsFrontDoorWebSocket WebSocket compression handshake received with value {0}",kb);kb&&this.Tmc.pco()}wnn(kb){return kb.ping?"ping":kb.validateSessionRequest?"validateSession":kb.compressionHandshakeRequest?"compressionHandshake":kb.smartArtEditOpRequest&&kb.smartArtEditOpRequest.editOps&&kb.smartArtEditOpRequest.editOps[0].resizeEditOp?"resizeEditOp":"unknown"}jqd(kb){this.Tmc.jqd(kb);Q.a.wb(kb)?m.a.$(508368846,839,10,"PodsFrontDoorWebSocket::OnPingReply Invalid pingTimestampStr"):(kb=parseFloat(kb),
isNaN(kb)?m.a.$(508368845,839,10,"PodsFrontDoorPing::OnMessage Ping response not a number. m_protobufEnabled:{0}",this.A0e):(kb={["PingTime"]:window.performance.now()-this.vk-kb,MeasurementType:"Performance.Now"},kb.First=this.tod?1:0,kb.WebSocketFrontDoorProtobufEnabled=this.A0e,kb.PostConnectionPing=this.dck,kb.ConnectionReason=wd[this.Tmc.bod],this.Tmc.P0m(),this.dck=this.tod=!1,m.a.$(508368844,839,50,A.a.toJSON(kb))))}$4m(){var kb=(window.performance.now()-this.vk).toString();if(!this.A0e)return kb;
kb=mb.q(mb.l(kb),null,null,null,this.pb.Hp);return JSON.stringify(kb)}get Voo(){return this.Aqe&&!Q.a.wb(this.zpk)?this.zpk:e.AFrameworkApplication.ha.appSettings.WebServiceBase+"WebSocketFrontDoorServiceHandler.ashx"}get IIa(){return 839}get $Wn(){return this.SFg}get njm(){return this.yme}get Ovm(){return this.tGn}get BUh(){return this.DFn}get u1m(){return this.HDn}}Object(d.a)(lc,"PodsWebSocketFrontDoor",null,[501,40,548]);class Mc{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.WebSocketFrontDoor"}oc(kb){if(!kb)throw Error.create("PPTWebEditorWebSocketFrontDoorPackage : container is null");
this.ga=kb;kb.register(501,"PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").oa().pa(()=>{try{return new lc(kb.resolve("PowerPointWebEditor.IApplicationSettings"),kb.resolve("PowerPointWebEditor.ISessionInfoOwner"),kb.eb("PowerPointWebEditor.ISessionLifetimeManager"),kb.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),kb.resolve("Common.IDynamicScriptLoaderProvider").SU)}catch(Xb){return m.a.$(507835866,839,10,"exception creating PodsWebSocketFrontDoor: "+Xb),null}})}init(){this.ga.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor")}dispose(){this.ga.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").dispose()}static main(){h.a.instance.Jc(new Mc)}}
Object(d.a)(Mc,"PPTWebEditorWebSocketFrontDoorPackage",null,[4,5]);var md=a(561);class ud{aLh(){return null}e2l(){return wa.c(window.PPTCampaignsObj_FromAppPackage)}t7f(kb){return md.a.t7f(kb,"PPTUserInitiatedSurveysDictionary_FromAppPackage")}}Object(d.a)(ud,"PowerPointFeedbackAppData",null,[503]);class Qd{constructor(){this.Oa=null}oc(kb){this.Oa=kb;kb.register(503,"Common.App.IAppSpecificFeedbackData").oa().pa(()=>new ud)}init(){this.Oa.Db("Common.App.IAppSpecificFeedbackData")}dispose(){}get name(){return"PPTWebEditor.Feedback"}static main(){h.a.instance.Jc(new Qd)}}
Object(d.a)(Qd,"PPTWebEditorFeedbackPackage",null,[4,5]);Type.registerNamespace("PowerPointWebEditor.Notes");Type.registerNamespace("PowerPointWebEditor.Preview");Type.registerNamespace("PowerPointWebEditor.ShapePresence");Type.registerNamespace("PowerPointWebEditor.SlideShow");Type.registerNamespace("PowerPointWebEditor.SmartGuide");Type.registerNamespace("PowerPointWebEditor.WebSocketFrontDoor");Object(mc.c)("ext-lazy");e.AFrameworkApplication.ha.isChangeGateEnabled("ExtCommonPackageOrderChange")&&
ke.main();r.main();Oe.main();Vd.main();dh.main();le.main();e.AFrameworkApplication.ha.isChangeGateEnabled("ExtCommonPackageOrderChange")||ke.main();Rf.main();Hb.main();eb.main();Mc.main();Qd.main();Object(mc.b)("ext-lazy")},1415:function(y,C,a){a.d(C,"a",function(){return k});y=a(0);var c=a(1703),b=a(6),d=a(103),e=a(57),h=a(40),n=a(1128),m=a(123);class k{constructor(l,u,r,x,v,z){this.vEd=this.VSc=null;this.WO=Object(c.a)(n.a,x.CUi(l,u,r,Object(b.a)(this,this.i0,"onPointerOver"),Object(b.a)(this,this.h0,
"onPointerOut"),v));this.eXc=0;this.ud=z;this.ud.GF(Object(b.a)(this,this.UJ,"onSessionEnd"));this.clear()}dispose(){this.WO.dispose();this.VSc=null}get qKb(){return this.vEd}setZIndex(l){this.WO.setZIndex(l)}qPl(l,u,r){this.vEd=l;this.VSc=u;this.WO.JZh("UnreadNotification_16x16x32",this.qKb,r)}clear(){this.WO.clear();this.vEd=m.a.none}wJe(){this.d0b();this.WO.tJd(this.qKb,this.jQf);this.WO.OUg()}d0b(){this.WO.IUe();this.WO.Y4e()}UJ(){h.a.$(39068559,804,15,"Canvas shape highlights pawn hovered count: {0};",
this.eXc);0<this.eXc&&d.c(e.a.tHh)}get jQf(){return this.VSc?this.VSc():""}i0(){this.wJe();h.a.$(23606147,804,50,"Shape revision tracking pawn hovered");this.eXc+=1;return!0}h0(){this.d0b();return!0}}Object(y.a)(k,"ShapeRevisionTrackingPawn",null,[526])},1416:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);var c=a(91);class b{constructor(d){this.fwb=this.G5b=null;this.kj=d}dispose(){this.clear();this.G5b.parentNode.removeChild(this.G5b)}YTb(d){this.G5b=this.VKf(d,"prContainerHr");this.fwb=
this.VKf(this.G5b,"prGlyph")}clear(){this.lec()}setImage(d,e){d&&(this.lec(),this.fwb.appendChild(d),this.fwb.style.backgroundColor=e,this.G5b.style.visibility=c.a.visible)}VKf(d,e){const h=this.kj.kg();this.kj.addCssClass(h,e);d.appendChild(h);return h}lec(){this.fwb.firstChild&&this.fwb.removeChild(this.fwb.firstChild)}}Object(y.a)(b,"ShapePawnGlyph",null,[])},1417:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(b){this.smk=b}get Roc(){return this.smk}}Object(y.a)(c,"ShowHideNotesData",
null,[])},1418:function(y,C,a){a.d(C,"a",function(){return k});y=a(0);var c=a(405),b=a(1263),d=a(1703),e=a(6),h=a(21),n=a(53),m=a(42);class k{constructor(l,u,r,x,v,z,A,B,G){this.gO=new b.a;this.qS=w=>w.isDecorative?ResourceStrings.L_AccMessageDecorative:w.get_altTitle();this.ANg=l;this.Xb=u;this.J5=v;this.La=r;this.Ld=z;this.SRc=A;this.uq=x;this.Rj=B;this.na=G;this.FIj()}get Yc(){return this.Ld.instance}get D2(){return this.SRc.value}FIj(){var l;this.gO.fa(0,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);
this.gO.fa(1,[ResourceStrings.l_PhTypeBody,ResourceStrings.l_ClickToAddText]);this.gO.fa(2,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.gO.fa(3,[ResourceStrings.l_PhTypeSubTitle,ResourceStrings.l_ClickToAddSubTitle]);this.gO.fa(8,[ResourceStrings.l_PhTypeObject,ResourceStrings.l_ClickToAddText]);this.gO.fa(9,[ResourceStrings.l_PhTypeGraph,ResourceStrings.l_InsertContent]);this.gO.fa(10,[ResourceStrings.l_PhTypeTable,ResourceStrings.l_InsertContent]);this.gO.fa(11,
[ResourceStrings.l_PhTypeClipArt,ResourceStrings.l_InsertContent]);this.gO.fa(12,[ResourceStrings.l_PhTypeSmartArt,ResourceStrings.l_ClickToAddSmartArt]);this.gO.fa(13,[ResourceStrings.l_PhTypeMedia,ResourceStrings.l_InsertContent]);this.gO.fa(15,[ResourceStrings.l_PhTypePicture,ResourceStrings.l_ClickToAddPicture]);this.gO.fa(6,[ResourceStrings.l_PhTypeFooter,ResourceStrings.l_ClickToAddFooter]);this.gO.fa(5,[ResourceStrings.l_PhTypeSlideNumber,ResourceStrings.l_ClickToAddSlideNumber]);(null===(l=
this.na)||void 0===l?0:l.qYa)&&this.gO.fa(16,[ResourceStrings.l_PhTypeCameo,ResourceStrings.l_ClickToAddCameo])}pqj(l,u){l&&(this.MV(l,u),l.Gwa?u.insert(0,document.createTextNode(ResourceStrings.l_ShapeObject)):this.b0d(l,null,u));return null}t4l(l){if(!this.ANg.instance||!l)return null;l=this.ANg.instance.Bqj(l);if(!l||!l.length)return null;const u=l.length;return 1===u?String.format(ResourceStrings.l_ShapePresenceForOneUser,l[0].userName):2===u?String.format(ResourceStrings.l_ShapePresenceForTwoUsers,
l[0].userName,l[1].userName):3===u?String.format(ResourceStrings.l_ShapePresenceForThreeUsers,l[0].userName,l[1].userName,l[2].userName):String.format(ResourceStrings.l_ShapePresenceForFourOrMoreUsers,u)}wMh(l){let u="";l&&l.YV&&l.image.title&&0<l.image.title.length&&(u=l.image.title);l&&(u=String.format(ResourceStrings.l_ThumbnailInfoNew,l.slideIndex+1,this.Xb.zl(),u),l=this.ptj(l),0<l.length&&(u+=l));return u}ptj(l){const u=new Sys.StringBuilder;l.isSelected&&u.append(ResourceStrings.L_SlideIsSelected);
l.Kl&&u.append(ResourceStrings.l_SlideIsHidden);const r=Object(d.a)(22,l.Ed);if(r){var x=r.HOa();x&&!this.uq.nZe(x)&&u.append(ResourceStrings.l_SlideHasNotes);(x=r.TX())&&this.J5.instance&&this.J5.instance.WMh(x)&&(x=this.J5.instance.OWe(x),u.append(1===x?ResourceStrings.l_SlideHasOneComment:String.format(ResourceStrings.l_SlideHasCommentsWithCount,x)))}l.RZ&&u.append(ResourceStrings.l_SlideHasAnimationOrTransition);if(l.HKb&&(l=l.HKb.hYa())&&0<l.length)if(1===l.length)u.append(String.format(ResourceStrings.l_SlideHasPresenceForOneUser,
l[0].userName));else{x="";for(const v of l)x+=v.userName+",";u.append(String.format(ResourceStrings.l_SlideHasPresenceForTwoOrMoreUsers,x))}r&&r.isUnread&&u.append(ResourceStrings.l_RevisionTracking_SlideHasUnreadChanges);return u.toString()}Hld(l,u){return String.format(ResourceStrings.l_MultipleSlidesSelected,l,u)}z2l(l,u){return String.format(ResourceStrings.l_DesignerSuggestionSelected,l+1,u)}A4l(){return ResourceStrings.l_SlidePanel}s3l(){return ResourceStrings.l_MultipleShapes}otm(l){l&&(this.na.zMa&&
l.b6(Object(e.a)(this,this.aej,"getCameoAccMessage")),l.b6(Object(e.a)(this,this.ssj,"getTableAccMessage")),l.b6(Object(e.a)(this,this.vjj,"getImageAccMessage")),l.b6(Object(e.a)(this,this.olj,"getMediaAccMessage")),l.b6(Object(e.a)(this,this.pej,"getChartAccMessage")),this.vad?(l.b6(Object(e.a)(this,this.a6f,"getSmartArtAccMessage")),l.b6(Object(e.a)(this,this.b0d,"getPlaceHolderAccMessage"))):(l.b6(Object(e.a)(this,this.b0d,"getPlaceHolderAccMessage")),l.b6(Object(e.a)(this,this.a6f,"getSmartArtAccMessage"))),
l.b6(Object(e.a)(this,this.htj,"getTextboxAccMessage")),l.b6(Object(e.a)(this,this.sqj,"getShapeGroupAccMessage")),l.b6(Object(e.a)(this,this.oqj,"getShapeAccMessage")),l.b6(Object(e.a)(this,this.Hcj,"getAddinAccMessage")),l.b6(Object(e.a)(this,this.vcj,"get3DAccMessage")))}b0d(l,u,r,x=null){if(l&&r&&l.Bl&&(this.nKc(l,r),this.gO.Sb(l.placeholderType))){x&&x(String.format("{0} {1}",this.gO.ka(l.placeholderType)[0],ResourceStrings.l_Placeholder));if(l.rU||!r.count){r=this.gO.ka(l.placeholderType)[0];
u="";if(!this.vad||l.rU)u=this.gO.ka(l.placeholderType)[1];return String.format(l.get_alt()?ResourceStrings.l_AccMessagePlaceHolderPromptAlt:ResourceStrings.l_AccMessagePlaceHolderPrompt,r,this.qS(l),u,l.get_alt())}l=String.format(l.get_alt()?ResourceStrings.l_AccMessagePlaceHolderTextAlt:ResourceStrings.l_AccMessagePlaceHolderText,this.gO.ka(l.placeholderType)[0],this.qS(l),l.get_alt());r.insert(0,document.createTextNode(l))}return null}htj(l,u,r,x=null){if(l&&r&&l.yr)if(this.nKc(l,r),x&&x(ResourceStrings.L_TextBox),
0<r.count)l=String.format(l.get_alt()?ResourceStrings.l_AccMessageTextboxHasTextAlt:ResourceStrings.l_AccMessageTextboxHasText,this.qS(l),l.get_alt()),r.insert(0,document.createTextNode(l));else return String.format(l.get_alt()?ResourceStrings.l_AccMessageTextboxNoTextAlt:ResourceStrings.l_AccMessageTextboxNoText,this.qS(l),l.get_alt());return null}a6f(l,u,r,x=null){if(l&&r&&l.xg)if(this.nKc(l,r),x&&x(ResourceStrings.L_SmartArt),0<r.count)l=String.format(l.get_alt()?ResourceStrings.l_AccMessageSmartArtHasTextAlt:
ResourceStrings.l_AccMessageSmartArtHasText,this.c6f(l)||"",this.qS(l),l.get_alt()),r.insert(0,document.createTextNode(l));else return String.format(l.get_alt()?ResourceStrings.l_AccMessageSmartArtNoTextAlt:ResourceStrings.l_AccMessageSmartArtNoText,this.c6f(l)||"",this.qS(l),l.get_alt());return null}MV(l,u){l&&u&&this.La.fJ(l,r=>{r.Va(n.a.Tq)&&this.D2f(r,u)})}nKc(l,u){if(l&&u){const r=this.vad?new h.a:u;let x=!1;this.La.fJ(l,v=>{const z=this.Rj.gY(v),A=this.Rj.gbc(v);z&&r.add(document.createTextNode(String.format(ResourceStrings.l_AccMessageTextLevel,
A)));x=this.D2f(v,r)||x});this.vad&&x&&u.addRange(r);u.count||(l=l.xMe)&&u.add(document.createTextNode(l))}}get vad(){return m.a("AriaMessageHelper.FixAccMessageForEmptyList")}D2f(l,u){let r;const x=l.ra(n.a.Bhc,null),v=l.ra(n.a.Tq,"");if(v&&u){if(x){let z=0,A=null,B;for(let G=0;G<x.length+1;G++)B=this.La.UIc(l,G),A&&A!==B&&(r=document.createElement("span"),r.setAttribute("lang",A),r.innerText=v.substring(z,x[G-1]),z=x[G-1],u.add(r)),A=B;r=document.createElement("span");A&&r.setAttribute("lang",A);
r.innerText=v.substring(z,v.length)}else r=document.createElement("span"),(l=this.La.UIc(l,0))&&r.setAttribute("lang",l),r.innerText=v;u.add(r)}return!!v&&0<v.length}ssj(l,u,r,x=null){return l&&l.gd?(x&&x(ResourceStrings.L_Table),String.format(l.get_alt()?ResourceStrings.l_AccMessageTableAlt:ResourceStrings.l_AccMessageTable,this.qS(l),l.get_alt())):null}vjj(l,u,r,x=null){return l&&l.Pg?(x&&x(ResourceStrings.l_Image),String.format(l.get_alt()?ResourceStrings.l_AccMessageImageAlt:ResourceStrings.l_AccMessageImage,
this.qS(l),l.get_alt())):null}aej(l,u,r,x=null){if(!l||!l.RB)return null;x&&x(ResourceStrings.l_Cameo);return l.get_alt()?String.format(ResourceStrings.l_AccMessageCameoAlt,this.qS(l),l.get_alt(),ResourceStrings.l_CameoLearnMoreMessage):String.format(ResourceStrings.l_AccMessageCameo,this.qS(l),ResourceStrings.l_CameoLearnMoreMessage)}olj(l,u,r,x=null){if(l){if(0===l.mediaType)return null;if(1===l.mediaType)return x&&x(ResourceStrings.l_Audio),this.na.JP?String.format(ResourceStrings.l_AccMessageCanvasAudio,
l.shapeName):String.format(l.get_alt()?ResourceStrings.l_AccMessageAudioAlt:ResourceStrings.l_AccMessageAudio,this.qS(l),l.get_alt());if(2===l.mediaType)return x&&x(ResourceStrings.l_Video),String.format(l.get_alt()?ResourceStrings.l_AccMessageVideoAlt:ResourceStrings.l_AccMessageVideo,this.qS(l),l.get_alt())}return null}pej(l,u,r,x=null){return l&&l.Im?(x&&x(ResourceStrings.l_Chart),String.format(l.get_alt()?ResourceStrings.l_AccMessageChartAlt:ResourceStrings.l_AccMessageChart,this.qej(l)||"",this.qS(l),
l.get_alt())):null}sqj(l,u,r,x=null){return l&&l.Ge?(x&&x(ResourceStrings.L_GroupObjects),m.a("GroupShapeAltTitleFixEnabled")?String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,l.Mu().length,l.get_alt()):String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,this.qS(l),l.get_alt())):null}oqj(l,u,r,x=null){if(l&&r&&l.Gwa&&!l.yr)if(this.nKc(l,r),u=this.La.L5f(l),l.Cwa&&(u=ResourceStrings.l_DecorativeLabel),
x&&x(u||ResourceStrings.l_TextShape),0<r.count)l=String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeHasTextAlt:ResourceStrings.l_AccMessageShapeHasText,u||ResourceStrings.l_TextShape,this.qS(l),l.get_alt()),r.insert(0,document.createTextNode(l));else return String.format(l.get_alt()?ResourceStrings.l_AccMessageShapeNoTextAlt:ResourceStrings.l_AccMessageShapeNoText,u||ResourceStrings.l_TextShape,this.qS(l),l.get_alt());return null}Hcj(l,u,r,x=null){return l&&l.au&&this.Yc&&this.D2?(l=this.D2.VMa(l),
l=this.Yc.OXd(l.id),x&&x(l?l.bfb:null),l?l.bfb:null):null}vcj(l,u,r,x=null){return l&&l.E5?(x&&x(ResourceStrings.l_3DModel),String.format(l.get_alt()?ResourceStrings.l_AccMessage3DAlt:ResourceStrings.l_AccMessage3D,this.qS(l),l.get_alt())):null}c6f(l){return l.smartArtInfo?k.Q0d(l.smartArtInfo.SmartArtLayout,1,177,"L_SAType"):(c.ULS.sendTraceTag(509092052,815,10,"SmartArt {0}#{1} has no SmartArtInfo",l.slideId?l.slideId.toString():"",l.get_shapeId()),null)}qej(l){return k.Q0d(l.chartType,0,102,"L_ChartType")}u4l(l,
u){return(l=this.La.Nld(l))&&u?String.format(ResourceStrings.l_RevisionTracking_ShapeHasUnreadChanges,u,l):null}static $4l(l){return k.Q0d(l,1,177,"L_SAType")}static Q0d(l,u,r,x){return l>=u&&l<=r&&(l=ResourceStrings[x+l])?l:null}}Object(y.a)(k,"AriaMessageHelper",null,[530])},1460:function(y,C,a){a.d(C,"a",function(){return Kb});var c=a(81);y=a(0);var b=a(595),d=a(30),e=a(143),h=a(41),n=a(114),m=a(88),k=a(340),l=a(64),u=a(69),r=a(50),x=a(132),v=a(118),z=a(46),A=a(15),B=a(40),G=a(42),w=a(108),F=a(848);
class H extends Sys.EventArgs{constructor(nb){super();this.clientX=nb.ClientX;this.clientY=nb.ClientY}}Object(y.a)(H,"OnBrowserEventArgs",Sys.EventArgs,[]);class E extends Sys.EventArgs{constructor(nb){super();this.slideId=nb.SlideId;this.slideIndex=nb.SlideIndex;this.n9l=nb.IsBeforeReady;this.M9l=nb.IsFromEndOfSlideshow;this.summary=nb.Summary}}Object(y.a)(E,"OnExitSlideshowEventArgs",Sys.EventArgs,[]);class P extends Sys.EventArgs{constructor(nb){super();this.slideId=nb.SlideId;this.slideIndex=
nb.SlideIndex;this.ztd=nb.TimeLineMappings}}Object(y.a)(P,"OnGetCurrentPositionEventArgs",Sys.EventArgs,[]);class T extends Sys.EventArgs{constructor(nb){super();this.slideHeight=nb.SlideHeight;this.slideWidth=nb.SlideWidth;this.Jll=nb.SlideLeftBound;this.yll=nb.SlideBottomBound}}Object(y.a)(T,"OnGetCurrentSlideDimensionsEventArgs",Sys.EventArgs,[]);class K extends Sys.EventArgs{constructor(nb){super();this.code=nb.Code;this.reason=nb.Reason;this.podSessionId=nb.PodSessionId}}Object(y.a)(K,"OnPodSessionExpiredEventArgs",
Sys.EventArgs,[]);var M=a(1243);class N extends Sys.EventArgs{constructor(nb){super();this.clientX=nb.ClientX;this.clientY=nb.ClientY}}Object(y.a)(N,"OnSlideshowContextMenuEventArgs",Sys.EventArgs,[]);class I extends Sys.EventArgs{constructor(nb){super();this.key=nb.Key;this.shiftKey=nb.ShiftKey;this.altKey=nb.AltKey}}Object(y.a)(I,"OnSpecialKeyEventArgs",Sys.EventArgs,[]);var O=a(1703);class Q extends Sys.EventArgs{constructor(nb){super();this.C1h=null;this.C1h="string"===typeof nb?Object(O.a)(String,
nb):nb.TranscriberSessionId}}Object(y.a)(Q,"OnTranscriberStartedEventArgs",Sys.EventArgs,[]);class U extends Sys.EventArgs{constructor(nb){super();this.isVisible=nb.IsVisible}}Object(y.a)(U,"OnVisibilityChangeEventArgs",Sys.EventArgs,[]);var ba=a(1242),aa=a(6);class La{}La.speechMode="Subtitles";La.tNf=[La.speechMode];La.sourceLanguage=null;La.targetLanguages=null;La.speechFDBase=null;La.podSessionId=null;La.NAh=null;La.docId=null;La.webServiceBase=null;La.userSessionId=h.AFrameworkApplication.userSessionId;
Object(y.a)(La,"PPTSpeechClientConfig",null,[]);class Z{constructor(){this.xa=new d.a}onFinalRecognitionText(nb){this.xa.raiseEvent("OnFinalRecognitionText",nb)}onPartialRecognitionText(nb){this.xa.raiseEvent("OnPartialRecognitionText",nb)}onError(nb){this.xa.raiseEvent("OnError",nb)}onSpeechRecognitionStarted(nb){this.xa.raiseEvent("OnSpeechRecognitionStarted",nb)}onEventUpdate(nb){this.xa.raiseEvent("OnEventUpdate",nb)}Psi(nb){this.xa.addHandler("OnFinalRecognitionText",nb)}CYk(nb){this.xa.removeHandler("OnFinalRecognitionText",
nb)}aui(nb){this.xa.addHandler("OnPartialRecognitionText",nb)}pZk(nb){this.xa.removeHandler("OnPartialRecognitionText",nb)}Lsi(nb){this.xa.addHandler("OnError",nb)}yYk(nb){this.xa.removeHandler("OnError",nb)}Bui(nb){this.xa.addHandler("OnSpeechRecognitionStarted",nb)}LZk(nb){this.xa.removeHandler("OnSpeechRecognitionStarted",nb)}Msi(nb){this.xa.addHandler("OnEventUpdate",nb)}AYk(nb){this.xa.removeHandler("OnEventUpdate",nb)}}Object(y.a)(Z,"PPTSpeechClientObserverController",null,[]);var la=a(405);
class da{constructor(){this.accessToken=null}}Object(y.a)(da,"IAuthenticationProvider",null,[]);class J{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(y.a)(J,"IDocumentDownloadConfig",null,[]);class Ca{constructor(){this.documentDownloadConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=
this.requestServiceCustomEndpoint=!1;this.microphoneDeviceId=null}}Object(y.a)(Ca,"ISpeechConfig",null,[]);class Fa{constructor(nb){this.x4=nb}onFinalText(){}onFragmentText(){}onFinalRecognitionText(nb,Ka){this.x4.onFinalRecognitionText(nb,Ka)}onPartialRecognitionText(nb,Ka){this.x4.onPartialRecognitionText(nb,Ka)}onError(nb){if("ErrorNone"!==nb)switch(nb){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.x4.onError("AccessDenied");
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.x4.onError("FailedToConnect");break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.x4.onError("Timeout");break;case "ErrorInitialSilenceTimeout":this.x4.onError("InitialSilenceTimeout");break;case "ErrorSpeechRecognitionFailure":case "ErrorTranslationFailure":case "ErrorFailedToGetSupportedTextLanguages":case "ErrorUnknown":this.x4.onError("UnknownError");
break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":this.x4.onError("MicrophoneError");break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":this.x4.onError("NotAllowedError");break;case "ErrorAudioNotFoundError":this.x4.onError("NotFoundError");break;case "ErrorAudioNotReadableError":this.x4.onError("NotReadableError");break;default:this.x4.onError("CustomError-"+nb)}}onSpeechRecognitionStarted(nb){la.ULS.sendTraceTag(507843283,
830,50,"PPTSpeechClientObserver::OnSpeechRecognitionStarted {0}",nb);this.x4.onSpeechRecognitionStarted(nb)}onEventUpdate(nb){this.x4.onEventUpdate(nb)}}Object(y.a)(Fa,"PPTSpeechClientObserver",null,[726]);class ya{constructor(nb){this.U8=null;this.AEa=0;this.microphoneDeviceId="";this.Zmk=new Fa(nb)}CYj(){return 2===this.AEa}pKj(){const nb=this.ZKf(),Ka=Object.assign(new da,{accessToken:""});this.U8&&0!==this.AEa&&(this.U8.stopSpeechRecognition(),this.AEa=0);this.U8=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(nb,
this.Zmk,Ka,null,new b.a);return this.U8?!0:(la.ULS.sendTraceTag(507843219,830,10,"Speech client was not successfully created"),!1)}Eph(){this.U8&&(0===this.AEa?(this.U8.startSpeechRecognition(),this.AEa=2):1===this.AEa&&(this.U8.resumeSpeechRecognition(),this.AEa=2))}Snl(){this.U8&&(this.U8.stopSpeechRecognition(),this.AEa=0)}WEk(){this.U8&&(this.U8.pauseSpeechRecognition(),this.AEa=1)}setCustomSetting(nb,Ka){this.U8&&this.U8.setCustomSetting(nb,Ka)}ZKf(){return Object.assign(new Ca,{speechMode:La.speechMode,
sourceLanguage:La.sourceLanguage,targetLanguages:La.targetLanguages,speechFDBase:La.speechFDBase,captureAudioPauseResumeRecordingState:!0,clientApp:0,documentDownloadConfig:Object.assign(new J,{docId:La.docId,podsSessionId:La.podSessionId,userDataCenterClusterId:La.NAh,webServiceBase:La.webServiceBase}),userSessionId:La.userSessionId,microphoneDeviceId:this.microphoneDeviceId})}}Object(y.a)(ya,"PPTSpeechClientProxy",null,[]);var Ua;(function(nb){nb[nb.none=0]="none";nb[nb.singleLineRibbon=1]="singleLineRibbon";
nb[nb.multipleLineRibbon=2]="multipleLineRibbon";nb[nb.slideShowToolbar=3]="slideShowToolbar";nb[nb.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";nb[nb.liveBroadcast=5]="liveBroadcast"})(Ua||(Ua={}));Object(y.b)("TranscriptionEntryPoint",Ua);var Ia=a(1129),Oa=a(89),ma=a(90);class za{constructor(){this.Kf=this.V8=this.AC=this.h$a=this.nr=this.Ad=this.na=this.Yd=this.xf=null;this.Hwb=!1;this.Hv=null;this.p$a=this.Dpd=0;this.fAg=!1;this.DEa=this.CEa="";this.zTc=!1;this.Npe="";this.yfe=0;this.gUc=
this.Zwa=this.$Zc="";this.M3=null;this.ita={};this.Dka=new Z;this.N8=new ya(this.Dka);za.sKj()}init(nb,Ka,Sb,ab,ub,Aa,tb){B.a.$(512495707,830,50,"SlideshowSubtitles.Init");this.Kf=Ka;this.na=nb;this.xf=Sb;this.Ad=ab;this.Hv=ub;this.Yd=Aa;this.M3=tb;this.nr=document.createElement("div");this.nr.id="SubtitleContainer";this.nr.className="SubtitleContainer";this.nr.style.display=Oa.a.Uf;this.nr.style.visibility=Oa.a.ht;this.h$a=document.createElement("div");this.h$a.id="SubtitleResultDiv";this.h$a.className=
"SubtitleResultDiv";this.xf.Q_l&&(this.h$a.style.direction="rtl");this.AC=document.createElement("span");this.AC.id="SubtitleResultSpan";this.AC.className="SubtitleResultSpan";this.AC.setAttribute("aria-hidden","true");this.V8=document.createElement("span");this.V8.id="SubtitleAccessibilitySpan";this.V8.className="SubtitleAccessibilitySpan";this.V8.innerText="";this.V8.setAttribute("lang",this.xf.Rdb);this.V8.setAttribute("aria-live","assertive");this.V8.setAttribute("aria-label",ResourceStrings.L_SubtitleAccessibilityWindow);
this.V8.setAttribute("aria-atomic","true");this.h$a.appendChild(this.AC);this.h$a.appendChild(this.V8);this.nr.appendChild(this.h$a);this.Kf.appendChild(this.nr);k.a.instance.Ub(this.AC,()=>!1);h.AFrameworkApplication.ha.fY?this.uu():h.AFrameworkApplication.ha.Wf(Object(aa.a)(this,this.uu,"onFullAppSettingsReady"))}uu(){this.$Zc=this.getUserId();this.Zwa=h.AFrameworkApplication.ha.Ma("TenantId");this.gUc=this.na.hostAuthType||h.AFrameworkApplication.ha.Ma("HostAuthType")||"Unknown"}getUserId(){let nb=
h.AFrameworkApplication.ha.Ma("PptEditingUserId");l.a.wb(nb)&&(nb=h.AFrameworkApplication.ha.Ma("LoggableUserId"),B.a.$(512495706,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",l.a.wb(nb)));return nb}hYk(){this.nr.style.display=Oa.a.Uf;this.nr.style.visibility=Oa.a.ht}cWa(nb,Ka,Sb,ab,ub,Aa){this.Ztb()&&(this.Hv.instance.show(ResourceStrings.L_SubtitleDetection_SoundReminder,Ia.a.Gse),this.Dpd=window.setTimeout(Object(aa.a)(this,this.Kag,"hideSoundReminderNotification"),
3E3));this.tAl(Ka,Sb,ab,this.xf);this.N8&&(this.N8.microphoneDeviceId=this.M3.microphoneDeviceId);this.xf.Jt&&this.N8.pKj()?(this.ita.StartTime=Aa,this.ita.LastError="ErrorNone",this.ita.EntryPoint=Ua[ub],this.Dka.Psi(Object(aa.a)(this,this.RZg,"onFinalRecognitionTextHandler")),this.Dka.aui(Object(aa.a)(this,this.Z_g,"onPartialRecognitionTextHandler")),this.Dka.Lsi(Object(aa.a)(this,this.e1g,"onSpeechProxyErrorHandler")),this.Dka.Msi(Object(aa.a)(this,this.f1g,"onSpeechProxyEventUpdateHandler")),
this.Dka.Bui(Object(aa.a)(this,this.g1g,"onSpeechRecognitionStartedHandler")),this.N8.Eph(),this.N8.setCustomSetting("clientMetadata",JSON.stringify(this.q0f())),this.AC.innerText="["+ResourceStrings.L_SubtitleInitMessage+"]",this.AC.style.color="rgba( 255, 255, 0, 1 )",this.setVisibility(5!==ub),this.oKd(),this.Ad.Dxf(Object(aa.a)(this,this.nac,"onGetCurrentSlideDimensionsHandler")),this.Ad.Pjc(Object(aa.a)(this,this.qve,"onSlideChangedHandler"))):this.Yph()}q0f(nb=""){const Ka=A.b(h.AFrameworkApplication.ha.appSettings.SessionStartInfoJson.toString()),
Sb={};Sb.userID=this.$Zc;Sb.tenantId=this.Zwa;Sb.identityProvider=this.gUc;Sb.audienceChannel="";Sb.audienceGroup=Ka.Ring||"Unknown";Sb.buildVersion=h.AFrameworkApplication.buildVersion||"Unknown";Sb.locale=this.na.EAb||"Unknown";Sb.wacHost=Ka.Host||"Unknown";Sb.wacDatacenter=Ka.WACDatacenter||"Unknown";Sb.livePragueSessionInfo=nb;return Sb}Yph(){this.nr?(this.nr.style.display=Oa.a.Uf,this.nr.style.visibility=Oa.a.ht,this.N8.Snl(),this.Dka.CYk(Object(aa.a)(this,this.RZg,"onFinalRecognitionTextHandler")),
this.Dka.pZk(Object(aa.a)(this,this.Z_g,"onPartialRecognitionTextHandler")),this.Dka.yYk(Object(aa.a)(this,this.e1g,"onSpeechProxyErrorHandler")),this.Dka.AYk(Object(aa.a)(this,this.f1g,"onSpeechProxyEventUpdateHandler")),this.Dka.LZk(Object(aa.a)(this,this.g1g,"onSpeechRecognitionStartedHandler")),this.Ad.lch(Object(aa.a)(this,this.nac,"onGetCurrentSlideDimensionsHandler")),this.Ad.F7c(Object(aa.a)(this,this.qve,"onSlideChangedHandler")),this.Ztb()&&this.Hv.instance.hide(),this.ita.EndTime=Date.now(),
B.a.$(512495705,817,15,JSON.stringify(this.ita,za.qxl)),this.ita={},this.xf.nWe=!1):B.a.$(508063889,817,50,"SlideshowSubtitles::stopTranscribe SubtitleContainer is null")}oKd(){let nb=3;this.ita.LastPosition=this.xf.a5;"AboveSlide"===this.xf.a5&&this.nr.style.visibility===Oa.a.xx?(this.nr.style.display=Oa.a.H1,this.nr.style.backgroundColor="black",this.nr.style.bottom="auto"):"BelowSlide"===this.xf.a5&&this.nr.style.visibility===Oa.a.xx?(this.nr.style.display=Oa.a.H1,this.nr.style.backgroundColor=
"black",this.nr.style.bottom="3%",nb=-1):"TopOverlay"===this.xf.a5?(this.nr.style.display=Oa.a.H1,this.nr.style.backgroundColor="transparent",this.nr.style.bottom="auto",nb=5):"BottomOverlay"===this.xf.a5&&(this.nr.style.display=Oa.a.H1,this.nr.style.backgroundColor="transparent",this.nr.style.bottom="5%",nb=-1);this.Hwb&&document.getElementById("LiveURLBarLayerHost")?this.nr.style.top=-1<nb?String.format("calc({0}% + {1})",nb.toString(),"26px"):"auto":(this.nr.style.top=-1<nb?nb.toString()+"%":"auto",
this.wyf())}isVisible(){return this.nr.style.visibility===Oa.a.xx}etl(nb,Ka=""){La.tNf=nb?["Live","Subtitles"]:["Subtitles"];this.Hwb=nb;this.setVisibility(this.nr.style.visibility===Oa.a.xx);this.oKd();this.N8.setCustomSetting("clientMetadata",JSON.stringify(this.q0f(Ka)));this.N8.setCustomSetting("slideIndex",this.yfe);this.N8.setCustomSetting("currentSpeechModes",JSON.stringify(La.tNf))}uEb(nb){this.nr.style.cursor=nb?"default":"none"}wyf(){this.AC.style.fontSize=Math.floor(this.nr.clientHeight/
2/1.5).toString()+"px";this.Npe=Math.floor(this.nr.clientHeight/12-2)+"px";this.AC.style.display="inline"}setVisibility(nb){this.nr?(null===nb&&(nb=this.nr.style.visibility===Oa.a.ht),this.nr.style.visibility=nb?Oa.a.xx:Oa.a.ht):B.a.$(509703457,817,50,"SlideshowSubtitles::setVisibility SubtitleContainer is null")}nac(){this.wyf()}qve(nb,Ka){this.yfe=Ka.slideIndex;this.N8.CYj()&&this.Hwb&&(this.N8.setCustomSetting("currentSlideIndex",this.yfe),B.a.$(512495704,817,50,"SlideshowSubtitles::OnSlideChangedHandler Updated current slide index for live"))}K5e(nb){nb?
(this.N8.WEk(),this.Lec(),this.zTc=!0,this.Yd&&this.Yd.instance&&this.Yd.instance.tym()):(this.N8.Eph(),this.Yd&&this.Yd.instance&&this.Yd.instance.uym())}Kag(){this.Ztb()&&(window.clearTimeout(this.Dpd),this.Hv.instance.hide())}tAl(nb,Ka,Sb,ab){La.sourceLanguage=ab.Fib;La.targetLanguages=ab.kpc;La.podSessionId=nb;La.NAh=Ka;La.docId=Sb;La.webServiceBase=this.na.ym;La.speechFDBase=h.AFrameworkApplication.ha.Ma(ma.a.EKb);nb=!!this.Yd&&!!this.Yd.instance&&(this.Yd.instance.cGc||this.Yd.instance.kM);
La.speechMode=this.Yd&&this.Yd.instance&&this.Yd.instance.FO&&this.Yd.instance.Ukc||nb?"Live":"Subtitles"}kQf(nb,Ka){this.fAg||(this.AC.style.color="rgba( 255, 255, 255, 1 )",window.clearTimeout(this.p$a),this.AC.innerText=this.Ftj(nb,Ka),this.AC.scrollTop=this.AC.scrollHeight,this.p$a=window.setTimeout(Object(aa.a)(this,this.Lec,"resetSubtitlesToEmpty"),1E4),Ka&&(this.V8.innerText=nb,this.V8.focus()),this.AC.style.padding=l.a.wb(nb)?"0px":this.Npe)}kE(nb){this.fAg||(this.AC.style.color="rgba( 255, 255, 0, 1 )",
l.a.wb(nb)&&(nb=ResourceStrings.L_SubtitleGenericErrorMessage),window.clearTimeout(this.p$a),this.AC.innerText="["+nb+"]",this.AC.scrollTop=this.AC.scrollHeight,this.p$a=window.setTimeout(Object(aa.a)(this,this.Lec,"resetSubtitlesToEmpty"),1E4),this.AC.style.padding=this.Npe,this.V8.innerText="",this.V8.focus())}kCj(nb){if(null!==nb)switch(nb){case "NotAllowedError":case "NotFoundError":case "NotReadableError":case "MicrophoneError":this.kE(ResourceStrings.L_SubtitleAudioDeviceErrorMessage);this.ita.LastError=
"MicrophoneError";break;case "FailedToConnect":this.kE(ResourceStrings.L_SubtitleRetryErrorMessage);this.ita.LastError="FailedToConnect";break;case "AccessDenied":case "UnknownError":case "Timeout":this.kE(ResourceStrings.L_SubtitleGenericErrorMessage);this.ita.LastError="FailedToCreateSpeechSession";break;default:B.a.$(512495703,830,15,"HandleSpeechProxyError {0}",nb)}}RZg(nb,Ka){this.nr.style.visibility!==Oa.a.ht&&this.kQf(Ka[this.xf.kpc],!0)}Z_g(nb,Ka){this.nr.style.visibility!==Oa.a.ht&&this.kQf(Ka[this.xf.kpc],
!1)}e1g(nb,Ka){B.a.$(512495702,830,10,"OnSpeechProxyErrorHandler {0}",Ka);(nb=Ka.toString())&&(-1<nb.indexOf("NotAllowedError")||-1<nb.indexOf("NotFoundError")||-1<nb.indexOf("NotReadableError")||-1<nb.indexOf("MicrophoneError"))&&this.Ztb()&&this.Hv.instance.show(ResourceStrings.L_SubtitleDetection_NoMicrophone,Ia.a.eKb);this.kCj(nb)}g1g(nb,Ka){B.a.$(512495701,830,50,"OnSpeechRecognitionStartedHandler {0}",Ka.toString());this.Ad.bBk(Ka.toString());this.Lec();this.Ztb()&&this.Hv.instance.hide()}f1g(nb,
Ka){if(this.Ztb())switch(nb=Ka.eventName,nb){case "MediaEvent":"AudioDeviceConnected"===Ka.mediaStatus&&this.Hv.instance.show(ResourceStrings.L_SubtitleDetection_MicReady,Ia.a.Gse);break;case "ConnectionRetry":this.Hv.instance.show(ResourceStrings.L_SpeechGenericRetryErrorMessage,Ia.a.eKb);this.kE(ResourceStrings.L_SubtitleGenericErrorMessage);break;case "QualityStatusUpdate":const Sb=Ka.shortCode;nb=Ka.longCode;const ab=Ka.shortString,ub=Ka.longString;switch(Ka.severity){case 0:this.Hv.instance.hide();
break;case 1:(Ka=0<Sb?za.gea[Sb]:ab)&&this.Hv.instance.show(Ka,Ia.a.$pd);break;case 2:(Ka=0<Sb?za.gea[Sb]:ab)&&this.Hv.instance.show(Ka,Ia.a.eKb),Ka=null===nb?ub:za.gea[nb],l.a.wb(Ka)||(window.clearTimeout(this.p$a),this.kE(Ka),this.p$a=window.setTimeout(Object(aa.a)(this,this.Lec,"resetSubtitlesToEmpty"),3E4))}break;default:B.a.$(512495700,830,50,"OnSpeechProxyEventUpdateHandler Event {0}",nb)}}Ztb(){return this.na.FFa&&!!this.Hv&&!!this.Hv.instance}Lec(){this.AC.style.color="rgba( 255, 255, 255, 1 )";
this.AC.innerText="";this.AC.scrollTop=this.AC.scrollHeight;this.DEa=this.CEa="";this.zTc=!1;this.p$a=0;this.AC.style.padding="0px"}Ftj(nb,Ka){this.zTc?this.Rwi(nb):this.S_k(nb);this.zTc=Ka;return l.a.wb(this.CEa)||l.a.wb(this.DEa)?l.a.wb(this.CEa)?this.DEa:this.CEa:this.CEa+"\n"+this.DEa}Rwi(nb){this.CEa=l.a.wb(this.DEa)?this.CEa:this.DEa;this.DEa=nb}S_k(nb){l.a.wb(this.CEa)||l.a.wb(this.DEa)?this.CEa=nb:this.DEa=nb}static get instance(){return za.Bu}static sKj(){za.gea[1]=ResourceStrings.L_SubtitleDetection_Listening;
za.gea[2]=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;za.gea[3]=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;za.gea[4]=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;za.gea[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet}static qxl(nb,Ka){return"undefined"===typeof Ka?null:Ka}}za.gea=Array(20);za.Bu=new za;Object(y.a)(za,"SlideshowSubtitles",null,[677]);var Qa=a(1241),Xa=a(48),Tb=a(80);class Kb{constructor(nb,Ka,Sb,ab,ub,Aa,tb,kc,dc,Db,sb,Qb,$a,X,Ta,ca,
Ma,Ba,wa,pa,ta){this.Jg=this.QN=this.Lxb=null;this.GH=new b.a;this.xa=new d.a;this.Smc="";this.ap=null;this.XJb="";this.whb=this.$xg=this.h9b=this.oB=this.T8=this.S8=this.M5b=this.ga=null;this.i9b=!0;this.z_=Date.now();this.BW=Date.now();this.cka=this.Uoe=this.fRg=0;this.ude=this.Hwb=!1;this.yda=new Set;this.ele=this.C8=!1;this.NWc=0;this.Ina=null;this.s$a=void 0;this.vpe=0;this.mpe={};this.Lme=0;this.yEa=this.x4b=this.v4b=!1;this.YPg={};this.Hna=!1;this.B_g=(Wa,Pa)=>{this.Vyk(Pa)};this.zxk=()=>{B.a.$(512309270,
830,50,`SlideShowCoreFrame::OnEditHappened,, Edit time elapsed between two edits:${Date.now()-this.BW} `);this.BW=Date.now();this.NWc++};this.Lyk=(Wa,Pa)=>{var ib;B.a.$(512309269,830,50,"SlideShowCoreFrame::OnLastMergeEditUTCChangedHandler");this.BW=Date.now();this.v4b=!0;this.yEa&&this.Bda.I7e();this.na.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled")&&(this.na.getBooleanAppSetting("CoauthEditSlideInfoEnabled")?(null===Pa||void 0===Pa?0:Pa.isPresentationChange)?this.ele=!0:0<(null===
(ib=null===Pa||void 0===Pa?void 0:Pa.hM)||void 0===ib?void 0:ib.length)&&Pa.hM.forEach(Ib=>{Ib=JSON.stringify({Sid:Ib.Sid,Cid:Ib.Cid});this.yda.has(Ib)||this.yda.add(Ib)}):this.C8=!0)};this.Rzk=(Wa,Pa)=>{var ib;B.a.$(512309268,830,50,"SlideShowCoreFrame::OnRealTimeEditHandler");this.BW=Date.now();this.x4b=!0;this.yEa&&this.Bda.I7e();this.na.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled")&&(this.na.getBooleanAppSetting("CoauthEditSlideInfoEnabled")?0<(null===(ib=null===Pa||void 0===
Pa?void 0:Pa.hM)||void 0===ib?void 0:ib.length)&&Pa.hM.forEach(Ib=>{Ib=JSON.stringify({Sid:Ib.Sid,Cid:Ib.Cid});this.yda.has(Ib)||this.yda.add(Ib)}):this.C8=!0)};this.FAk=(Wa,Pa)=>{var ib;this.Uoe=Date.now();B.a.$(507799770,830,50,"SlideShowCoreFrame::onSlideEditHandler");this.yEa&&this.Bda.Q1h(Pa.hM.map(Ib=>new Tb.a(Ib)),this.yM);this.C8||((null===Pa||void 0===Pa?0:Pa.isPresentationChange)?(B.a.$(507799769,830,15,"SlideShowCoreFrame::onSlideEditHandler SlideShow cache flushed by this edit"),this.C8=
!0):0<(null===(ib=null===Pa||void 0===Pa?void 0:Pa.hM)||void 0===ib?void 0:ib.length)&&Pa.hM.forEach(Ib=>{Ib=JSON.stringify({Sid:Ib.Sid,Cid:Ib.Cid});this.yda.has(Ib)||this.yda.add(Ib)}))};this.jFf=(Wa,Pa)=>{var ib,Ib;"Error"==Pa&&this.xa.raiseEvent("OnCameraErrorEventId");this.c$a&&(window.clearTimeout(this.c$a),this.c$a=void 0);Wa=this.bZi(Wa);null===(Ib=null===(ib=this.g9b)||void 0===ib?void 0:ib.instance)||void 0===Ib?void 0:Ib.show(Wa,Pa);this.c$a=window.setTimeout(()=>{var hc,yc;null===(yc=null===
(hc=this.g9b)||void 0===hc?void 0:hc.instance)||void 0===yc?void 0:yc.hide();this.c$a=void 0},3E3)};this.IUk=Wa=>{Object(c.b)(this,void 0,void 0,function*(){if(this.Tnd){var Pa=(new Date).getTime();try{const ib=yield this.Tnd.hP("Hubble",Wa);ib.IsSuccess?this.Jg.setAadToken(ib.Token):this.Jg.setAadToken("");B.a.$(508949124,830,50,`SlideShowCoreFrame::Hubble token requested by: ${"PowerPoint Slideshow"} successful: ${ib.IsSuccess} time: ${(new Date).getTime()-Pa}`)}catch(ib){B.a.$(508949123,830,10,
`SlideShowCoreFrame::Hubble token requested by: ${"PowerPoint Slideshow"} successful: false time: ${(new Date).getTime()-Pa} error: ${ib}`),this.Jg.setAadToken("")}}else B.a.$(508949125,830,10,"SlideShowCoreFrame::Refresh token requested without IOAuthManager. Setting AAD token as empty for SlideShow."),this.Jg.setAadToken("")})};this.Kf=nb;this.na=Ka;this.xf=Sb;this.u_e=ab;this.Hv=ub;this.g9b=Ba;this.Yd=Aa;this.M3=kc;this.TO=tb;this.$wa=dc;this.mf=Db;this.tW=sb;this.Nh=Qb;this.yM=$a;this.Iq=X;this.Rmc=
Ta;this.Xb=ca;this.Bda=ta;if(this.na.getBooleanAppSetting("SlideShowGetPresInfoFromClient")){if(!Ma)throw"PresInfo client not present";this.uNg=Ma}this.ZQg=pa;this.yEa=this.na.getBooleanAppSetting("SnapUrlUpdateAfterEditEnabled");wa&&(this.Ina=wa);this.Unk=e.a.getInstance();this.tW&&this.tW.execute(Wa=>{Wa.Cza(this.zxk)});if(!this.Xb)throw Error.argumentNull("presReader");this.Rmc.IFh(this.B_g);this.Nh&&(this.Nh.Ojc(this.Lyk),this.Nh.Rjc(this.Rzk),this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",
!1)&&this.Nh.xui(this.FAk));if(this.na.isAnimationPreviewEnabled)this.Iy=this.Ina.getSettings(),this.$wa=this.Ina.$wa;else try{const Wa=this.Iy=JSON.parse(this.na.Ma("Settings"))||{};Wa.slideshowcore||(Wa.slideshowcore={});Wa.slideshowcore&&Wa.slideshowcore.forceSvg&&"true"===Wa.slideshowcore.forceSvg.toString().toLowerCase()?this.$wa=!0:this.$wa&&(Wa.slideshowcore.forceSvg="True");Wa.slideshowcore.enableCameoInPPTOSlideShow=this.na.DZ.toString()}catch(Wa){B.a.$(512495906,830,10,"SlideShowCoreFrame::Exception in parsing settings:{0}",
Wa),this.Iy={}}this.YPg=A.b(h.AFrameworkApplication.ha.appSettings.SessionStartInfoJson.toString())}kYj(nb){return null==nb||G.a("CacheRetentionExperimentReversedCommands")&&-1<(this.na.Ma("CacheRetentionExperimentReversedCommands")||"").indexOf(nb+";")?!1:Qa.a.includes(nb)?!0:G.a("CacheRetentionExpCommandsFromBRS")?-1<(this.na.Ma("CacheRetentionExperimentCommands")||"").indexOf(nb.toString()+";"):!1}Vyk(nb){var Ka;Object(c.b)(this,void 0,void 0,function*(){if(!this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",
!1)&&nb.actionId!==Xa.a.ona&&(this.yEa&&this.Bda.Q1h(null===nb||void 0===nb?void 0:nb.hM,this.yM),this.na.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled"))){var Sb=this.Xb.i1(null===(Ka=null===nb||void 0===nb?void 0:nb.hM[0])||void 0===Ka?void 0:Ka.sid);Sb=null===Sb||void 0===Sb?void 0:Sb.slideIndex;B.a.$(508297357,830,50,`SlideShow:: Edit Command triggered  ::${nb.actionId}, SlideIndex Edited:: ${Sb},Edit time elaplsed between two edits:${Date.now()-this.BW}`);nb&&nb.hM&&1==nb.hM.length&&
this.kYj(null===nb||void 0===nb?void 0:nb.actionId)&&!this.C8?(Sb=JSON.stringify({Sid:nb.hM[0].sid,Cid:nb.hM[0].cid}),this.yda.has(Sb)||(this.yda.add(Sb),this.mpe[this.W5f(nb.hM[0].sid,nb.hM[0].cid)]=nb.actionId)):!this.C8&&G.a("TelemetryForSSCacheFlushCommand")&&(B.a.$(508063836,830,15,`SlideShowCoreFrame::onMarkedUndoWithSlidesAsync SlideShow cache flushed by this edit. Command triggered::${nb.actionId}, SlideIndex Edited:: ${Sb}`),this.C8=!0,this.Lme=nb.actionId)}})}preloadShaders(){this.cad();
this.Zfc();SlideShowCore.SlideShowCore.preloadShaders()}init(nb,Ka,Sb,ab){return Object(c.b)(this,void 0,void 0,function*(){this.Smc=Sb;this.yM=ab;this.XJb=Ka;if(this.ap)B.a.$(509636752,830,50,"SlideShowCoreFrame::init - initPromise {0}",this.pRa),yield this.pRa;else{this.M5b=document.getElementById("HiddenFocusTrapAnchor");this.ap=document.createElement("div");this.ap.id="SlideShowBackground";this.ap.className="SlideShowBackground";this.ap.style.visibility=Oa.a.ht;this.ap.tabIndex=-1;this.ga=document.createElement("div");
this.ga.id="SlideShowContainer";this.ga.className="SlideShowContainer";this.ga.tabIndex=-1;this.ga.style.width=window.screen.width+"px";this.ga.style.height=window.screen.height+"px";n.a.addHandler(this.ap,m.a.tta,tb=>{this.fzk(tb)});k.a.instance.Ub(this.ap,tb=>this.N1c(tb));this.ap.appendChild(this.ga);this.M5b?this.Kf.insertBefore(this.ap,this.M5b):this.Kf.appendChild(this.ap);var ub=this.na.Ma("pptSlideShowCoreCssUrl"),Aa=document.createElement("link");Aa.setAttribute("rel","stylesheet");Aa.setAttribute("type",
"text/css");Aa.setAttribute("href",ub);this.ga.appendChild(Aa);za.instance.init(this.na,this.ap,this.xf,this,this.Hv,this.Yd,this.M3);this.S8=document.getElementById("slideshowBeginningFocusTrap");this.T8=document.getElementById("slideshowEndFocusTrap");this.S8||this.T8||(this.S8=document.createElement("div"),this.S8.id="slideshowBeginningFocusTrap",this.S8.className="FocusTrap",this.S8.tabIndex=0,n.a.addHandler(this.S8,m.a.focus,()=>{this.X0g()}),this.T8=document.createElement("div"),this.T8.id=
"slideshowEndFocusTrap",this.T8.className="FocusTrap",this.T8.tabIndex=0,n.a.addHandler(this.T8,m.a.focus,()=>{this.X0g()}),this.M5b?(this.Kf.insertBefore(this.S8,this.Kf.firstChild),this.Kf.insertBefore(this.T8,this.M5b.nextSibling)):(ub=document.getElementById("slideshow-toolbar"),this.Kf.insertBefore(this.S8,this.ap),this.Kf.insertBefore(this.T8,ub)));this.na.getBooleanAppSetting("IsSnapUrlFetchedEarlyOnBootEnabled")&&this.ZQg?(ub=yield this.ZQg.trj())&&!l.a.wb(ub.$Qf)?(this.oB=ub.$Qf,this.Hna=
ub.q5e,this.z_=Date.now(),yield this.R4d()):(this.pRa=this.d1d(1),yield this.pRa):(this.pRa=this.d1d(1),yield this.pRa)}})}ZOj(){return this.v4b||this.x4b}d1d(nb){return Object(c.b)(this,void 0,void 0,function*(){let Ka=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.na.ym,this.yM);if(G.a("AddCallerQueryParam")){const ab=this.na.getBooleanAppSetting("PPTOPresentFrontDoorEnabled");Ka+=`&caller=Slideshow&pptoPresentFrontDoorEnabled=${ab}`}const Sb=new Date;return new Promise((ab,
ub)=>{const Aa={};Aa.startTime=Sb;if(this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.UseXMLHttpRequestForSSSnap",!1)){const tb=this.Ina.faa(Ka);tb.onreadystatechange=()=>Object(c.b)(this,void 0,void 0,function*(){tb.readyState===XMLHttpRequest.DONE&&(Aa.correlationId=tb.getResponseHeader("X-CorrelationId"),yield this.bJa(JSON.parse(tb.response),Aa),ab())});tb.onerror=()=>Object(c.b)(this,void 0,void 0,function*(){Aa.requestStatus=tb.status;Aa.correlationId=tb.getResponseHeader("X-CorrelationId");
yield this.aJa(nb,Aa);ub()});tb.send()}else{const tb={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};tb["X-UserSessionId"]=h.AFrameworkApplication.userSessionId;this.Iq.ik(Ka,1,"",tb,!1,0,kc=>Object(c.b)(this,void 0,void 0,function*(){var dc,Db,sb,Qb,$a;Aa.correlationId=null===(dc=null===kc||void 0===kc?void 0:kc.data)||void 0===dc?void 0:dc.gj["X-CorrelationId"];Aa.enqueueTime=null===(Db=null===kc||void 0===kc?void 0:kc.data)||void 0===Db?void 0:Db.Wy;Aa.invokedTime=
null===(sb=null===kc||void 0===kc?void 0:kc.data)||void 0===sb?void 0:sb.Oo;Aa.completedTime=null===(Qb=null===kc||void 0===kc?void 0:kc.data)||void 0===Qb?void 0:Qb.Gp;yield this.bJa(JSON.parse(null===($a=null===kc||void 0===kc?void 0:kc.data)||void 0===$a?void 0:$a.responseData),Aa);B.a.$(509636751,830,15,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlSucceeded");ab()}),kc=>Object(c.b)(this,void 0,void 0,function*(){var dc,Db;Aa.requestStatus=null===(dc=null===kc||void 0===kc?void 0:kc.data)||
void 0===dc?void 0:dc.Je;Aa.retryCount=nb;Aa.correlationId=null===(Db=null===kc||void 0===kc?void 0:kc.data)||void 0===Db?void 0:Db.gj["X-CorrelationId"];yield this.aJa(nb,Aa);B.a.$(509636750,830,10,"SlideShowCoreFrame - getSnappedUrl GettingSnappedUrlFailed");ub()}),null,null)}})})}bJa(nb,Ka){return Object(c.b)(this,void 0,void 0,function*(){Ka.timeTaken=+new Date-+Ka.startTime;B.a.$(512309283,830,15,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded : {0}",Ka);this.oB=nb.downloadUrl;void 0!==nb.sendGetItemsRequestToPFD&&
(this.Hna=nb.sendGetItemsRequestToPFD);l.a.wb(this.oB)?B.a.$(512309282,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty - {0}",nb):(this.z_=Date.now(),yield this.R4d())})}f0d(){const nb={};nb.settings=this.Iy;nb.retryCount=this.na.Ac("GetItemsRetryCount",3);nb.retryOnCategories=this.na.Ma("GetItemsRetryCategories").split(";");const Ka={};Ka.Slide=ResourceStrings.l_Slide;Ka.AnimNum=ResourceStrings.l_AccSsAnimNum;Ka.SldNameWithTooltip=ResourceStrings.l_AccSsSldNameWithTooltip;
Ka.SldNameWithoutTooltip=ResourceStrings.l_AccSsSldNameWithoutTooltip;Ka.AnimTotalSingular=ResourceStrings.l_AccSsAnimTotalSingular;Ka.AnimTotalPlural=ResourceStrings.l_AccSsAnimTotalPlural;nb.localizedStrings=Ka;return nb}R4d(){return Object(c.b)(this,void 0,void 0,function*(){this.cad();this.Zfc();G.a("UseNewPodsProxyConstructor")?this.xcg():this.Lxb=new PodsProxy.PodsProxy(this.na.rwa?this.na.Ufb:this.na.ym,{DownloadUrl:this.oB,DocID:h.AFrameworkApplication.Fh,CustomFontCatalogUrl:this.na.Ma("CustomFontCatalogURL")},
this.na.t1?l.a.GJ(this.na.t1).toLowerCase():"",this.GH,this.krb(),this.lrb());this.QN=new SlideShowCore.DefaultResourceProviders(this.Lxb,this.GH,this.f0d());const nb={};nb.initTime=Kb.lU();nb.uiHost="Unified App";nb.serverUrl=l.a.yj(this.na.ym);nb.userSessionId=this.Smc;nb.jsScriptsBasePath=this.na.Ma("StaticContentHost")+"pptscripts/ssapp/";nb.fileHost=this.na.Ma("FileHost");nb.isRtl=h.AFrameworkApplication.isRtl;nb.applicationLcid=h.AFrameworkApplication.lcid;nb.applicationLocaleName=h.AFrameworkApplication.uiCulture;
nb.areThirdPartyAddInsAllowed=h.AFrameworkApplication.jMa;nb.theWsaClient=h.AFrameworkApplication.Di;nb.appForOfficeContextActivationParameters=F.a.pXe(this.mf);nb.hubbleVideoEndpoint=this.na.ZIb;nb.acceptLanguage=h.AFrameworkApplication.uiCulture;nb.appForOfficeAuthFactory=new ba.a;const Ka={};Ka.settings=this.Iy;Ka.transitionResourceCDNPath=this.na.DIh;Ka.transitionDisabledList=this.na.eWa;Ka.clickTargetEnabled=!0;Ka.mediaEnabled=!0;Ka.gifEnabled=!0;Ka.convertGifToVideo=!0;Ka.crossSlideAudioEnabled=
!0;Ka.editAudioEnabled=this.na.getBooleanAppSetting("PPTOAudioPlaybackOptionsEnabled");Ka.flipgridVideoEnabled=this.na.getBooleanAppSetting("PptModernSlideShowFlipgridVideoEnabled");Ka.useNewYoutubePlayer=!0;Ka.useNewVimeoPlayer=!0;Ka.useOnlineVideoPlayer=!0;Ka.tedVideoEnabled=this.na.getBooleanAppSetting("PptModernSlideShowTEDVideoEnabled");Ka.isStream2Enabled=!0;Ka.endOfShowText=ResourceStrings.l_EndOfSlideShowMessage;Ka.enableSVGAsWebGLTexture=!u.a.Yf&&this.na.getBooleanAppSetting("SlideShowShapeBuilderSVGEnabled");
Ka.maxSvgTextureSize=this.na.Ac("ShapeBuilderMaxSvgTextureSize",2048);Ka.enableSlideSizeAdjust=this.na.getBooleanAppSetting("EnableSlideSizeAdjust");Ka.slideSizeMax={["x"]:this.na.Ac("SlideShowMaxWidth",1504),["y"]:this.na.Ac("SlideShowMaxHeight",849)};Ka.slideSizeMin={["x"]:this.na.Ac("SlideShowMinWidth",348),["y"]:this.na.Ac("SlideShowMinHeight",261)};Ka.slideSizeDefault={["x"]:this.na.Ac("SlideShowDefaultWidth",1504),["y"]:this.na.Ac("SlideShowDefaultHeight",849)};Ka.streamVideoUseThinEmbed=this.na.getBooleanAppSetting("StreamVideoUseThinEmbed");
Ka.slideMetadataEnabled=this.na.getBooleanAppSetting("PptModernSlideShowSlideMetadataEnabled");Ka.disabledChangeGates=this.na.Ma("PPTDisabledChangeGates");Ka.isMultiSlideshowcoreEnabled=this.na.getBooleanAppSetting("MultiSlideshowcoreEnabled");Ka.combineBootRequest=!0;Ka.localVideoTelemetryEnabled=this.na.getBooleanAppSetting("IsGFXVideoLocalTelemetryEnabled");Ka.imageSettings={["imageAppendOption"]:"all"};Ka.SlideShowCacheRetentionExperimentEnabled=this.na.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled");
Ka.usePresInfoFromClient=this.na.getBooleanAppSetting("SlideShowGetPresInfoFromClient");const Sb={};G.a("addFlightToSSC")&&(Sb.verifyGlyphAsynchronously=h.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.verifyGlyphAsynchronously",!1));const ab={["slideShowCoreSettings"]:Ka,["appSettings"]:nb};G.a("addFlightToSSC")&&(ab.flights=Sb);G.a("AddInstanceSourceIdentifier")?this.Jg=new SlideShowCore.SlideShowCore(this.ga,this.QN,this.GH,ab,1):this.Jg=new SlideShowCore.SlideShowCore(this.ga,
this.QN,this.GH,ab);new SlideShowCore.PrefetchAddon(this.Jg,this.GH,{["forwardPrefechCount"]:this.na.Ac("PptModernSlideShowForwardPrefetchCount",10),["backwardPrefechCount"]:this.na.Ac("PptModernSlideShowBackwardPrefetchCount",5),["forwardPrerenderCount"]:this.na.Ac("PptModernSlideShowForwardPrerenderCount",2),["backwardPrerenderCount"]:this.na.Ac("PptModernSlideShowBackwardPrerenderCount",2)});new SlideShowCore.SlideAdvanceAddon(this.Jg,this.GH);this.fRg=Date.now();this.whb=this.Jg.init();this.Jg.events.on("slideLocationChanged",
()=>{this.nqd()});this.Jg.events.on("animationStateChanged",()=>{this.nqd()});this.Jg.events.on("slideDimensionsChanged",()=>{this.RWe()});this.Jg.events.on("exitFromEndOfShow",()=>{this.DZg(!0)});this.Jg.events.on("blankSlideStateChanged",ub=>{this.Kwk(ub)});this.Jg.events.on("slideshowError",ub=>{this.G1e(ub)});this.na.getBooleanAppSetting("IsStream2VideoEnabled")&&(this.Tnd=r.a.instance.resolve("Common.App.OAuth.IOAuthManager"),this.Jg.events.on("aadTokenRequest",ub=>{this.IUk(ub)}));return new Promise(ub=>
Object(c.b)(this,void 0,void 0,function*(){yield this.whb;this.i9b=!1;this.$xg=new SlideShowCore.InputsAddon(this.Jg,this.ga,h.AFrameworkApplication.isRtl);new SlideShowCore.AnimationLoggerAddon(this.Jg,ab,this.GH);new SlideShowCore.TransitionLoggerAddon(this.Jg,ab,this.GH);new SlideShowCore.PerfCheckerAddon(this.Jg,ab,this.GH);this.h9b=new SlideShowCore.SlideShowInkAddon(this.Jg,this.GH,this.ga,()=>this.u_e.loadScript("slideshowink"),{["telemetryLogger"]:this.Unk});this.na.DZ&&(this.f9b=new SlideShowCore.CameoWebcamAddon(this.Jg,
{notificationCallback:this.jFf}));this.$xg.events.on("keydown",Aa=>{this.tac(Aa)});B.a.$(509636749,830,15,"SlideShowCoreFrame - initSlideShowCore Finshed Initializing");ub()}))})}lrb(){const nb={};nb.timeout=this.na.Ac("PptModernSlideShowGetItemsTimeoutMs",3E4);nb.throwHttpErrors=!1;nb.enableServerSpecificErrorCode=G.a("SSCore.EnableServerSpecificErrorCode");nb.pptoPresentFrontDoorEnabled=this.h$d();return nb}Zfc(){try{const nb=this.Iy;if(nb.slideshowcore){const Ka={};Ka.settings=nb;Ka.logger=this.GH;
Ka.disabledChangeGates=this.na.Ma("PPTDisabledChangeGates");window.SlideShowCore.setupGlobals_SlideShowCore(Ka)}}catch(nb){B.a.$(509703488,830,10,"SlideShowCoreFrame::Exception in passing settings to slideshowcore:{0}",nb)}}cad(){try{const nb=this.Iy;if(nb.podsproxy){const Ka={};Ka.settings=nb;window.PodsProxy.setupGlobals_PodsProxy(Ka)}}catch(nb){B.a.$(512309267,830,10,"SlideShowCoreFrame::Exception in passing settings to podsproxy:{0}",nb)}}CPe(nb,Ka,Sb){return Object(c.b)(this,void 0,void 0,function*(){this.cad();
this.Zfc();if(this.Jg){G.a("UseNewPodsProxyConstructor")?this.xcg():this.Lxb=new PodsProxy.PodsProxy(this.na.rwa?this.na.Ufb:this.na.ym,{DownloadUrl:this.oB,DocID:h.AFrameworkApplication.Fh,CustomFontCatalogUrl:this.na.Ma("CustomFontCatalogURL")},this.na.t1?l.a.GJ(this.na.t1).toLowerCase():"",this.GH,this.krb(),this.lrb());var ab=this.QN;this.QN=new SlideShowCore.DefaultResourceProviders(this.Lxb,this.GH,this.f0d());var ub=this.xpe;G.a("RockyV2NavigationFix")&&Sb&&ub<this.Xb.zl()-1&&ub++;if(G.a("UpdateSlideShowCoreRefractoringEnabled")){let tb=
!1;if(this.na.getBooleanAppSetting("SlideShowGetPresInfoFromClient")&&ab&&(!G.a("DisabledPresInfoClientInCoauth")||!this.ZOj())){var Aa=ab.presInfo.getLoadResultInCache("");(null===Aa||void 0===Aa?0:Aa.resource)&&this.uNg&&(Aa.resource=this.uNg.T3l(Aa.resource),null===Aa||void 0===Aa?0:Aa.resource)&&(this.QN.presInfo.add(Aa),tb=!0)}Aa=!Sb&&h.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SaveRenderCallForLaunchAfterEdit",!1);ub={shouldRerenderSlide:!0,startSlideIndex:this.d8()?
ub:this.xpe,isCacheRetentionEnabled:this.d8(),updateSlideShowCoreAfterLaunch:this.d8()&&Sb,isPresInfoFromClient:tb,fSetBlankSlideToBlack:Aa};yield this.Jg.updateResourceProviders(this.QN,ub)}else this.d8()?yield this.Jg.updateResourceProviders(this.QN,{shouldRerenderSlide:!0,updateSlideShowCoreAfterLaunch:Sb,startSlideIndex:ub,isCacheRetentionEnabled:this.d8()}):yield this.Jg.updateResourceProviders(this.QN,{shouldRerenderSlide:!0,startSlideIndex:this.xpe,isCacheRetentionEnabled:this.d8()});ab&&ab.dispose();
B.a.$(508162582,830,50,`SlideShowCoreFrame::Number of edits happened::${this.NWc}`);G.a("RockyV2Telemetry")?this.o1k():(this.yda.clear(),this.C8=!1,this.NWc=0);B.a.$(593827098,830,15,"SlideShowCoreFrame::Done updating ResourceProvider. StartUrl:{0}, downloadUrl:{1}, updatedResourceProvider:{2}, IsSlideShowVisible:{3}",nb,Ka,Date.now(),this.Ggb())}else B.a.$(508908737,830,10,"SlideShowCoreFrame - updateSlideShowCore: m_slideshowCore is null")})}xcg(){try{this.Lxb=new PodsProxy.PodsProxy(this.na.rwa?
this.na.Ufb:this.na.ym,{DownloadUrl:this.oB,DocID:h.AFrameworkApplication.Fh,CustomFontCatalogUrl:this.na.Ma("CustomFontCatalogURL")},this.na.t1?l.a.GJ(this.na.t1).toLowerCase():"",this.GH,this.krb(),this.lrb())}catch(nb){if(nb instanceof TypeError)this.Lxb=new PodsProxy.PodsProxy(this.na.rwa?this.na.Ufb:this.na.ym,{DownloadUrl:this.oB,DocID:h.AFrameworkApplication.Fh,CustomFontCatalogUrl:this.na.Ma("CustomFontCatalogURL")},this.na.t1?l.a.GJ(this.na.t1).toLowerCase():"",this.GH,this.h$d()?this.na.Ma("PresentUrlEndpoint"):
void 0,this.krb(),this.lrb());else throw B.a.$(507811592,830,10,"SlideShowCoreFrame::Error in PodsProxy initialization:{0}",nb),nb;}}o1k(){this.yda.clear();this.C8=!1;this.NWc=this.Lme=0;this.x4b=this.v4b=!1;this.mpe={};this.ele=!1}aJa(nb,Ka){return Object(c.b)(this,void 0,void 0,function*(){0<nb--?(B.a.$(512309281,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, {1}",nb,Ka),yield this.d1d(nb)):B.a.$(512309280,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : {0}",
Ka)})}d8(){return this.na.getBooleanAppSetting("SlideShowCacheRetentionExperimentEnabled")&&G.a("SlideCacheExperimentV2")}o0h(nb,Ka,Sb,ab,ub,Aa,tb,kc,dc){Object(c.b)(this,void 0,void 0,function*(){var Db=0;this.xpe=0>=Ka?0:Ka-1;var sb={};G.a("SSLaunchRefactoredLaunchLogs")&&(sb.id=x.a.create().toString(),sb.additionalMetrics={});const Qb={};G.a("CoauthEditSlideInfoEnabledTelemetryEnabled")&&(Qb.CoauthEditSlideInfoEnabled=this.na.getBooleanAppSetting("CoauthEditSlideInfoEnabled"));if(G.a("SSNetworkInfo")&&
"connection"in navigator){var $a=navigator.connection,X={};"effectiveType"in $a&&(X.type=$a.effectiveType);"downlink"in $a&&(X.downlink=$a.downlink);"rtt"in $a&&(X.rtt=$a.rtt);Qb.network=X}this.pRa&&(B.a.$(509617947,830,15,"SlideShowCoreFrame::StartFrom - initPromise {0}",this.pRa),$a=Kb.lU(),yield this.pRa,Db=Kb.lU()-$a,this.Ggb()||this.show());if(l.a.wb(this.oB))B.a.$(508924042,830,10,"SlideShowCoreFrame::StartFrom DownloadUrl is null or empty - {0}",this.oB),this.Ggb()&&(sb=w.a.Ji(410),h.AFrameworkApplication.Ds(sb),
v.Health.instance.recordQosError(w.a.Vma(sb),["SlideShowACE"],!1,!0,!0,!0,null),this.Jg&&this.Jg.recordSessionStats({["errorName"]:"ErrorSlideShowGetItemsFailedDownloadFile"}),this.exit());else if(this.Jg){$a={sr:"ss"};G.a("SSLaunchUnifiedTelemetry")&&(Qb.initPromiseTimeMs=Db);this.BW>this.z_||this.i9b?(this.Iy.slideshowcore.vetoBootDurationMs=this.na.Ac("PptModernSlideShowEditVetoBootDurationMs",8E3),$a.BootScenario=this.BW>this.z_?"AfterEdit":"Init",B.a.$(509703459,830,15,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",
this.na.Ac("PptModernSlideShowEditVetoBootDurationMs",8E3),this.BW,this.z_,this.i9b)):(this.Iy.slideshowcore.vetoBootDurationMs=this.na.Ac("PptModernSlideShowCachedVetoBootDurationMs",2E3),$a.BootScenario="Relaunch",B.a.$(509703458,830,15,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.na.Ac("PptModernSlideShowCachedVetoBootDurationMs",2E3),this.BW,this.z_,this.i9b));this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",
!1)&&this.Z3j();this.Zfc();X=0;Db=this.d8()&&!this.Xjg(nb)&&this.BW>this.z_;const Ta=this.d8()?this.Xjg(nb)&&this.BW>this.z_:this.BW>this.z_;G.a("RockyV2Telemetry")&&this.d8()&&(Qb.updateSlideShowCoreBeforeLaunch=Ta,Qb.updateSlideShowCoreAfterLaunch=Db,Ta&&(Qb.slideEditSource=this.brj(nb),Qb.slideFirstEditCommand=this.crj(nb)),G.a("PPTOPresentFrontDoorTelemetry")&&(Qb.pptoPresentFrontDoorEnabled=this.na.getBooleanAppSetting("PPTOPresentFrontDoorEnabled"),Qb.isGetItemsRequestRoutedtoPFD=this.h$d()));
Ta&&(X=Kb.lU(),this.Jg.showLoadingSpinner(),this.yEa&&this.Bda.oPh(this.BW)?yield this.Vyh(Db,sb):yield this.DPe(1,Db),X=Kb.lU()-X,G.a("SSLaunchRefactoredLaunchLogs")&&(sb.additionalMetrics.isUpdateResourceProviderCalled=!0));G.a("SSLaunchUnifiedTelemetry")&&($a.SSCoreUpdateAfterEditMs=X);$a.startFromTime=dc-window.performance.timing.navigationStart;$a.SSCoreFrameStartTime=Kb.lU();G.a("SSLaunchRefactoredLaunchLogs")&&(Qb.CacheRetentionExpEnabled=this.d8());G.a("SSSnapUrlUpdateAfterEditEnabled")&&
(Qb.SnapUrlUpdateAfterEditEnabled=this.yEa);G.a("SSRockySlideEditEnhancementEnabled")&&(Qb.RockySlideEditEnhancement=this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.RockySlideEditEnhancement",!1));G.a("IsGetPresInfoClientEnabled")&&(Qb.IsGetPresInfoClientEnabled=this.na.getBooleanAppSetting("SlideShowGetPresInfoFromClient"));G.a("IsSnapUrlonBootEnabled")&&(Qb.IsSnapUrlonBootEnabled=this.na.getBooleanAppSetting("IsSnapUrlFetchedEarlyOnBootEnabled"));G.a("SSEUPLBugTelemetry")&&(Qb.SlideShowClickTime=
dc);za.instance.hYk();this.ga.style.top="0";this.S8&&this.T8&&(this.S8.tabIndex=0,this.T8.tabIndex=0);X={["slideId"]:{["sid"]:nb,["cid"]:0}};X.slideIndex=Ka-1;this.vpe+=1;G.a("SSLaunchNumberInSession")&&(Qb.SlideShowLaunchNumber=this.vpe);G.a("SSLaunchSlideIndexTelemetry")&&(Qb.SlideShowIndex=Ka-1);G.a("SSLaunchRefactoredLaunchLogs")&&(Qb.id=sb.id,B.a.$(508072012,830,15,JSON.stringify(Qb)));h.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SSRemoveCheckFullScreenChecker",
!1)||!this.TO.aZe||this.TO.sYa?this.JWf(X,$a,Db,sb):this.gIi(X,$a,Db,sb);this.yEa&&this.Bda.yvm()}else B.a.$(512495901,830,10,"SlideShowCoreFrame::SlideshowCore is undefined")})}Vyh(nb,Ka){return Object(c.b)(this,void 0,void 0,function*(){this.z_=this.Bda.eXh;this.oB=this.Bda.urm;this.Hna=this.Bda.q5e;yield this.CPe(new Date(this.Bda.vrm),new Date(this.Bda.eXh),nb);B.a.$(507884896,830,15,"SlideShowCoreFrame::updateSlideShowCoreWithPrefetchedSnapUrl served prefethed snap url with updateSlideShowCoreAfterLaunch:{0}, actionId:{1}",
nb,Ka.id)})}h$d(){return G.a("SimplifyChecksAndReturnValueInSnapResponse")?this.Hna:this.na.getBooleanAppSetting("PPTOPresentFrontDoorEnabled")&&G.a("AddCallerQueryParam")&&this.YPg.FileSizeBytes<=this.na.Ac("PresentFrontdoorMaxAllowedFileSizeInBytes",1E8)&&!h.AFrameworkApplication.Mz}Xjg(nb){nb=-1==nb?this.Xb.Uw(0):this.Xb.i1(nb);nb=JSON.stringify({Sid:nb.sid,Cid:nb.cid});return this.C8||this.yda.has(nb)||this.na.getBooleanAppSetting("CoauthEditSlideInfoEnabled")&&this.ele}Z3j(){this.Uoe<this.BW&&
(B.a.$(507793607,830,15,"SlideShowCoreFrame: User launched before server response. ServerResponseTime:{0}, LastEditTime:{1}",this.Uoe,this.BW),G.a("ToggleMultiSlideEditOnServerResponseTime")||(this.C8=!0))}brj(nb){if(this.v4b)return 2;if(this.x4b)return 3;if(this.C8)return 1;nb=-1==nb?this.Xb.Uw(0):this.Xb.i1(nb);nb=JSON.stringify({Sid:nb.sid,Cid:nb.cid});return this.yda.has(nb)?0:4}W5f(nb,Ka){return nb+"_"+Ka}crj(nb){if(this.x4b||this.v4b)return-2;if(this.C8)return this.Lme;nb=-1==nb?this.Xb.Uw(0):
this.Xb.i1(nb);return this.mpe[this.W5f(nb.sid,nb.cid)]}prev(){return Object(c.b)(this,void 0,void 0,function*(){this.Jg&&(this.d8()&&this.s$a&&(this.Jg.showLoadingSpinner(),yield this.s$a,this.Jg.hideLoadingSpinner()),yield this.Jg.prevStep("0_anim"))})}next(){return Object(c.b)(this,void 0,void 0,function*(){this.Jg&&(this.d8()&&this.s$a&&(this.Jg.showLoadingSpinner(),yield this.s$a,this.Jg.hideLoadingSpinner()),yield this.Jg.nextStep("0_anim",3))})}show(){this.Dtd(!0)}Ggb(){return this.ap&&this.ap.style.visibility===
Oa.a.xx?!0:!1}Dtd(nb){za.instance.setVisibility(nb&&this.xf.Jt);this.ap&&(nb?(this.ap.style.visibility=Oa.a.xx,$addHandler(window,"visibilitychange",Ka=>{this.q3c(Ka)})):(this.ap.style.visibility=Oa.a.ht,$removeHandler(window,"visibilitychange",Ka=>{this.q3c(Ka)})))}exit(){this.DZg(!1)}cWa(nb,Ka,Sb,ab,ub,Aa,tb){const kc=!!this.Yd&&!!this.Yd.instance&&(this.Yd.instance.cGc||this.Yd.instance.kM);(this.Yd&&this.Yd.instance&&this.Yd.instance.FO&&this.Yd.instance.Ukc||kc)&&!this.Yd.instance.kWe()?B.a.$(512495900,
830,10,"SlideShowCoreFrame::Transcribe - LivePresenter prevented transcriber from starting"):(za.instance.cWa(nb,Ka,Sb,ab,ub,Aa,tb),this.xf.Jt&&this.Jg.recordSessionStats({["metadata"]:"subtitles"}),this.oTd())}JWf(nb,Ka,Sb,ab){Object(c.b)(this,void 0,void 0,function*(){this.na.isAnimationPreviewEnabled&&(yield this.Jg.refreshViewControllerSSC());this.na.getBooleanAppSetting("EnsureNavigationStateConsistency")||this.Jg.clearNavigationState();ab.navigationType="init";ab.startFromTime=Ka.startFromTime;
Ka.waitedForInit=this.i9b;Ka.startInitTime=this.fRg;Ka.beforeInitPromise=Kb.lU();yield this.whb;Ka.afterInitPromise=Kb.lU();ab.bootMetrics=Ka;if(0>nb.slideIndex){var ub=this.na.getBooleanAppSetting("EnsureNavigationStateConsistency")?yield this.Jg.gotoFirstSlideOptions(!0,{Nd:ab,xan:!0}):yield this.Jg.gotoFirstSlide(!0,ab);G.a("AddLogsForGotoFirstSlideFailure")&&ub&&!ub.fSucceeded&&B.a.$(507799685,830,10,"SlideShowCoreFrame::finishStartFrom: slide show core gotoSlide failed with error {0}",null===
ub||void 0===ub?void 0:ub.error);this.ga.style.height="100%";this.ga.style.width="100%";B.a.$(508924041,830,15,"SlideShowCoreFrame::finishStartFrom - Sending slideshowReadyEvent. slideLocation: {0}",JSON.stringify(nb))}else ub={},ub.actionContext=ab,ub.fSkipTransition=!0,this.na.getBooleanAppSetting("EnsureNavigationStateConsistency")&&(ub.fClearNavigationState=!0),G.a("FixForGotoSlideTelemetryMinify"),ub=yield this.Jg.gotoSlide(nb,ub),!G.a("AddLogsForGotoSlideFailure")||(null===ub||void 0===ub?0:
ub.fSucceeded)||B.a.$(507863835,830,10,"SlideShowCoreFrame::finishStartFrom: slide show core gotoSlide failed with error {0}",null===ub||void 0===ub?void 0:ub.error),this.ga.style.height="100%",this.ga.style.width="100%",B.a.$(508924040,830,15,"SlideShowCoreFrame::finishStartFrom - Sending slideshowReadyEvent. slideLocation: {0}",JSON.stringify(nb));this.d8()&&Sb&&(this.s$a=this.yEa&&this.Bda.oPh(this.BW)?this.Vyh(Sb,ab):this.DPe(1,Sb),yield this.s$a,this.s$a=void 0);this.xa.raiseEvent("OnSlideshowReady",
new Sys.EventArgs)})}gIi(nb,Ka,Sb,ab){const ub=this.na.Ac("PptModernSlideShowCheckFullscreenCounter",10),Aa=Kb.lU();let tb=ub,kc=4;G.a("fixEUPLBugEnabled")&&0!=this.cka&&(B.a.$(508411976,830,15,"Clearing check full screen interval if it is already running:{0}.",this.cka),this.na.getBooleanAppSetting("FixSlideShowEUPLBugEnabled")&&(window.clearInterval(this.cka),this.cka=0));this.cka=window.setInterval(()=>{if(this.na.getBooleanAppSetting("FixSlideShowEUPLBugEnabled")&&this.ude)B.a.$(508404055,830,
15,"SlideShowCoreFrame::checkFullscreenBeforeFinishStartFrom - Already CheckingFullScreen, exiting this iteration. checkFullscreenCounter: {0}.",tb);else{this.ude=!0;tb--;B.a.$(512495899,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen counter: {0}.",tb);var dc=Kb.lU();if(this.TO.sYa||0>=tb){const sb=Kb.lU();window.clearInterval(this.cka);this.cka=0;if(G.a("fixEUPLBugEnabled")&&0==tb%5&&0<=kc){kc--;var Db=z.a.$t();B.a.$(508409102,830,15,"CallStack before checkFullscreenBeforeFinishStartFrom : {0}",
Db)}Db=20*(ub-tb);G.a("SSLaunchUnifiedTelemetry")||(Ka.checkFullscreenMs=Db);B.a.$(512495898,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen duration: {0} ms. Time taken in FullScreen API: {1}ms",Db,(sb-dc).toString());G.a("SSLaunchUnifiedTelemetry")&&!Ka.checkFullscreenMs&&(Ka.checkFullscreenMs=Kb.lU()-Aa);this.JWf(nb,Ka,Sb,ab)}this.ude=!1}},20)}oTd(){let nb=0,Ka=100;this.xf.Jt&&za.instance.isVisible()&&("AboveSlide"===this.xf.a5?(nb=15,Ka=85):"BelowSlide"===this.xf.a5&&(Ka=85));const Sb=
document.getElementById("LiveURLBarLayerHost");this.Hwb&&Sb?(this.ga.style.top=String.format("calc({0}% + {1})",nb.toString(),"26px"),this.ga.style.height=String.format("calc({0}% - {1})",Ka.toString(),"26px")):(this.ga.style.top=nb.toString()+"%",this.ga.style.height=Ka.toString()+"%")}K5e(nb){za.instance.K5e(nb)}sTl(){this.jFf("NotAllowedError","Error")}bZi(nb){return nb&&"string"===typeof nb&&-1===nb.indexOf("unknown")?-1!==nb.indexOf("CameraStarted")?ResourceStrings.l_CameraReady:-1!==nb.indexOf("NotAllowedError")||
-1!==nb.indexOf("SecurityError")||-1!==nb.indexOf("TypeError")?ResourceStrings.l_CameraPermissionError:-1!==nb.indexOf("NotFoundError")||-1!==nb.indexOf("OverconstrainedError")||-1!==nb.indexOf("ErrorStreamStartFailure")||-1!==nb.indexOf("ErrorNoVideoTracks")?ResourceStrings.l_CameraDetectionError:-1!==nb.indexOf("NotReadableError")?ResourceStrings.l_CameraInUseByAnotherAppError:ResourceStrings.l_CameraError:ResourceStrings.l_CameraUnknownError}setCameraState(nb){var Ka;null===(Ka=this.f9b)||void 0===
Ka?void 0:Ka.setCameraState(nb)}XDm(nb){this.f9b&&nb&&this.f9b.updateWebcamDevice(nb)}getDefaultCameraLabel(){var nb,Ka;return null!==(Ka=null===(nb=this.f9b)||void 0===nb?void 0:nb.getDefaultCameraLabel())&&void 0!==Ka?Ka:""}u7e(nb,Ka=""){this.Hwb=nb;za.instance.etl(nb,Ka);this.oTd()}r1h(nb){za.instance.setVisibility(nb);za.instance.oKd();this.oTd()}dtl(){this.xa.raiseEvent("OnFullscreenClick",new Sys.EventArgs)}hga(){this.ap&&this.ap.style.visibility!==Oa.a.ht&&!this.yQj()&&this.ga.focus()}getCurrentPosition(){if(this.Jg){const nb=
this.Jg.getSlideLocation();nb?this.xa.raiseEvent("OnGetCurrentPosition",new P({["SlideId"]:nb.slideId.sid,["SlideIndex"]:nb.slideIndex})):B.a.$(512495897,830,10,"SlideShowCoreFrame::GetCurrentPosition: currentLocation is null")}}t2l(){if(this.Jg){const nb=this.Jg.getSlideLocation();if(nb){const Ka=this.Jg.getAnimationState(!0),Sb=Ka.timelineStates,ab=[];for(let ub=0;ub<Sb.length;ub+=1)ab.push({["TimeLineId"]:Sb[ub].timelineId,["Step"]:Sb[ub].step,["LastClickTime"]:Sb[ub].lastClickTime,["StartTimeOffset"]:Ka.startTimeOffset});
this.xa.raiseEvent("OnGetCurrentPosition",new P({["SlideId"]:nb.slideId.sid,["SlideIndex"]:nb.slideIndex,["TimeLineMappings"]:ab}))}else B.a.$(512495896,830,10,"SlideShowCoreFrame::GetCurrentPositionWithTimeLines: currentLocation is null")}}RWe(){if(this.Jg&&this.ap&&this.ap.style.visibility!==Oa.a.ht){const nb=document.getElementById(this.$wa?"svg-canvas":"webgl-canvas");nb&&this.xa.raiseEvent("OnGetCurrentSlideDimensions",new T({["SlideHeight"]:nb.offsetHeight,["SlideWidth"]:nb.offsetWidth,["SlideLeftBound"]:nb.offsetLeft,
["SlideBottomBound"]:nb.offsetTop+nb.offsetHeight}))}}Xld(nb){Object(c.b)(this,void 0,void 0,function*(){if(this.Jg){let Ka;G.a("FixForGotoSlideTelemetryMinify");Ka=yield this.Jg.gotoSlide({["slideIndex"]:nb},{actionContext:{navigationType:"goto"},fSkipTransition:!1});!G.a("AddLogsForGotoSlideFailure")||(null===Ka||void 0===Ka?0:Ka.fSucceeded)||B.a.$(507863834,830,10,"SlideShowCoreFrame::goToSlide: slide show core gotoSlide failed with error {0}",null===Ka||void 0===Ka?void 0:Ka.error)}})}x5l(nb,
Ka){Object(c.b)(this,void 0,void 0,function*(){if(this.Jg){var Sb={},ab=[];let ub=0;for(let Aa=0;Aa<Ka.length;Aa+=1){const tb={};tb.timelineId=Ka[Aa].TimeLineId;tb.step=Ka[Aa].Step;tb.lastClickTime=Ka[Aa].LastClickTime;ub=Ka[Aa].StartTimeOffset;ab.push(tb)}Sb.timelineStates=ab;Sb.startTimeOffset=ub;ab={actionContext:{navigationType:"goto"}};ab.animationState=Sb;ab.fSkipTransition=!1;G.a("FixForGotoSlideTelemetryMinify");Sb=yield this.Jg.gotoSlide({["slideIndex"]:nb},ab);!G.a("AddLogsForGotoSlideFailure")||
(null===Sb||void 0===Sb?0:Sb.fSucceeded)||B.a.$(507863833,830,10,"SlideShowCoreFrame::GoToSlideWithTimeLines: slide show core gotoSlide failed with error {0}",null===Sb||void 0===Sb?void 0:Sb.error)}})}DPe(nb,Ka){return Object(c.b)(this,void 0,void 0,function*(){B.a.$(512309260,830,15,"SlideShowCoreFrame::updateSlideShowCoreAfterEdit: CurrentPodSessionId:{0}",this.yM);let Sb=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.na.ym,this.yM);if(G.a("AddCallerQueryParam")){const ub=
this.na.getBooleanAppSetting("PPTOPresentFrontDoorEnabled");Sb+=`&caller=Slideshow&pptoPresentFrontDoorEnabled=${ub}`}const ab=new Date;return new Promise((ub,Aa)=>{const tb={};tb.startTime=ab;if(this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.UseXMLHttpRequestForSSSnap",!1)){const kc=this.Ina.faa(Sb);kc.onreadystatechange=()=>Object(c.b)(this,void 0,void 0,function*(){kc.readyState===XMLHttpRequest.DONE&&(tb.correlationId=kc.getResponseHeader("X-CorrelationId"),yield this.a_g(JSON.parse(kc.response),
Ka,tb),ub())});kc.onerror=()=>Object(c.b)(this,void 0,void 0,function*(){tb.httpStatus=kc.status;tb.correlationId=kc.getResponseHeader("X-CorrelationId");yield this.ZZg(nb,Ka,tb);Aa()});kc.send()}else{const kc={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};kc["X-UserSessionId"]=h.AFrameworkApplication.userSessionId;this.Iq.ik(Sb,1,"",kc,!1,0,dc=>Object(c.b)(this,void 0,void 0,function*(){var Db,sb,Qb,$a,X;tb.correlationId=null===(Db=null===dc||void 0===dc?void 0:dc.data)||
void 0===Db?void 0:Db.gj["X-CorrelationId"];tb.enqueueTime=null===(sb=null===dc||void 0===dc?void 0:dc.data)||void 0===sb?void 0:sb.Wy;tb.invokedTime=null===(Qb=null===dc||void 0===dc?void 0:dc.data)||void 0===Qb?void 0:Qb.Oo;tb.completedTime=null===($a=null===dc||void 0===dc?void 0:dc.data)||void 0===$a?void 0:$a.Gp;yield this.a_g(JSON.parse(null===(X=null===dc||void 0===dc?void 0:dc.data)||void 0===X?void 0:X.responseData),Ka,tb);B.a.$(509636748,830,15,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlSucceededAfterEdit");
ub()}),dc=>Object(c.b)(this,void 0,void 0,function*(){var Db,sb;tb.httpStatus=null===(Db=null===dc||void 0===dc?void 0:dc.data)||void 0===Db?void 0:Db.Je;tb.correlationId=null===(sb=null===dc||void 0===dc?void 0:dc.data)||void 0===sb?void 0:sb.gj["X-CorrelationId"];yield this.ZZg(nb,Ka,tb);B.a.$(509636747,830,10,"SlideShowCoreFrame - updateSlideShowCoreAfterEdit GettingSnappedUrlFailedAfterEdit");Aa()}),null,null)}})})}a_g(nb,Ka,Sb){return Object(c.b)(this,void 0,void 0,function*(){const ab=new Date;
Sb.timeTaken=+ab-+Sb.startTime;B.a.$(512309279,830,15,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit : {0}",Sb);this.oB=nb.downloadUrl;void 0!==nb.sendGetItemsRequestToPFD&&(this.Hna=nb.sendGetItemsRequestToPFD);l.a.wb(this.oB)?B.a.$(512309278,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit but downloadUrl is null or empty : {0}",nb):(this.z_=Date.now(),yield this.CPe(Sb.startTime,ab,Ka))})}ZZg(nb,Ka,Sb){return Object(c.b)(this,void 0,void 0,function*(){0<nb--?(B.a.$(512309277,
830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : Retrying to Get Snapped Download Url. Current Retry Count: {0}, {1}",nb,Sb),yield this.DPe(nb,Ka)):B.a.$(512309276,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : {0}",Sb)})}uah(nb,Ka,Sb=1){return Object(c.b)(this,void 0,void 0,function*(){B.a.$(512309259,830,15,"SlideShowCoreFrame::RefreshPodSession: CurrentPodSessionId:{0}, UpdatedPodSessionId:{1}",this.yM,nb);this.yM=nb;this.XJb=Ka;let ab=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",
this.na.ym,this.yM);if(G.a("AddCallerQueryParam")){const Aa=this.na.getBooleanAppSetting("PPTOPresentFrontDoorEnabled");ab+=`&caller=Slideshow&pptoPresentFrontDoorEnabled=${Aa}`}const ub=new Date;return new Promise((Aa,tb)=>{const kc={};kc.startTime=ub;if(this.na.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.UseXMLHttpRequestForSSSnap",!1)){const dc=this.Ina.faa(ab);dc.onreadystatechange=()=>Object(c.b)(this,void 0,void 0,function*(){dc.readyState===XMLHttpRequest.DONE&&(kc.correlationId=
dc.getResponseHeader("X-CorrelationId"),yield this.b_g(JSON.parse(dc.response),kc),Aa())});dc.onerror=()=>Object(c.b)(this,void 0,void 0,function*(){kc.httpStatus=dc.status;kc.correlationId=dc.getResponseHeader("X-CorrelationId");yield this.$Zg(Sb,kc);tb()});dc.send()}else{const dc={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};dc["X-UserSessionId"]=h.AFrameworkApplication.userSessionId;this.Iq.ik(ab,1,"",dc,!1,0,Db=>Object(c.b)(this,void 0,void 0,function*(){var sb,
Qb,$a,X,Ta;kc.correlationId=null===(sb=null===Db||void 0===Db?void 0:Db.data)||void 0===sb?void 0:sb.gj["X-CorrelationId"];kc.enqueueTime=null===(Qb=null===Db||void 0===Db?void 0:Db.data)||void 0===Qb?void 0:Qb.Wy;kc.invokedTime=null===($a=null===Db||void 0===Db?void 0:Db.data)||void 0===$a?void 0:$a.Oo;kc.completedTime=null===(X=null===Db||void 0===Db?void 0:Db.data)||void 0===X?void 0:X.Gp;yield this.b_g(JSON.parse(null===(Ta=null===Db||void 0===Db?void 0:Db.data)||void 0===Ta?void 0:Ta.responseData),
kc);Aa()}),Db=>Object(c.b)(this,void 0,void 0,function*(){var sb,Qb;kc.httpStatus=null===(sb=null===Db||void 0===Db?void 0:Db.data)||void 0===sb?void 0:sb.Je;kc.correlationId=null===(Qb=null===Db||void 0===Db?void 0:Db.data)||void 0===Qb?void 0:Qb.gj["X-CorrelationId"];yield this.$Zg(Sb,kc);tb()}),null,null)}})})}b_g(nb,Ka){return Object(c.b)(this,void 0,void 0,function*(){var Sb=new Date;B.a.$(512309275,830,15,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession : {0}",Ka);this.oB=
nb.downloadUrl;void 0!==nb.sendGetItemsRequestToPFD&&(this.Hna=nb.sendGetItemsRequestToPFD);l.a.wb(this.oB)?(B.a.$(512309274,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession but downloadUrl is null or empty : {0}",nb),this.Ggb()&&(Sb=w.a.Ji(413),h.AFrameworkApplication.Ds(Sb),v.Health.instance.recordQosError(w.a.Vma(Sb),["SlideShowACE"],!1,!0,!0,!0,null),this.Jg&&this.Jg.recordSessionStats({["errorName"]:"ErrorSlideShowRehydrationFailed"}),this.exit())):(this.z_=Date.now(),
yield this.CPe(Ka.startTime,Sb),G.a("prefetchOnPodSessionRefreshEnabled")&&this.Jg.prefetchOnPodSessionRefresh())})}$Zg(nb,Ka){return Object(c.b)(this,void 0,void 0,function*(){0<nb--?(B.a.$(512309273,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : Retrying to Get Snapped Download Url. Current Retry Count: {0}, {1}",nb,Ka),yield this.uah(this.yM,this.XJb,nb)):(B.a.$(512309272,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : {0}",Ka),this.Ggb()&&
this.exit())})}setVisibility(nb){this.Dtd(nb)}uEb(nb){this.ap&&(this.ap.style.cursor=nb?"default":"none");za.instance.uEb(nb)}YGk(nb){if(this.h9b)this.h9b.onInkManagerActivity(nb)}tac(nb){this.jZh(nb)}jZh(nb){this.xa.raiseEvent("OnSpecialKey",new I({["Key"]:nb.keyCode,["ShiftKey"]:nb.shiftKey,["AltKey"]:nb.altKey}))}X0g(){this.ap&&this.hga()}krb(){const nb=new Map;nb.set("X-UserSessionId",this.Smc);nb.set("X-WacNoAuth","1");nb.set("X-WacCluster",this.XJb);nb.set("Client","Unified App");G.a("AddHostInfoTelemetry")&&
nb.set("HostName",h.AFrameworkApplication.rd.Host);this.na.JLh&&nb.set("UseDocCache","True");return nb}DZg(nb=!1){var Ka,Sb,ab;B.a.$(507773716,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler");this.cka&&(B.a.$(512495890,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler m_fullscreenCheckerId is not zero: {0}",this.cka),window.clearInterval(this.cka),this.cka=0);this.h9b&&this.h9b.resetInkCanvas();null===(Ka=this.f9b)||void 0===Ka?void 0:Ka.setCameraState(!1);this.c$a&&(null===(ab=null===
(Sb=this.g9b)||void 0===Sb?void 0:Sb.instance)||void 0===ab?void 0:ab.hide(),window.clearTimeout(this.c$a),this.c$a=void 0);this.S8&&this.T8&&(this.S8.tabIndex=-1,this.T8.tabIndex=-1);this.Jg?(Ka=this.Jg.getSlideLocation(),this.Jg.endSession(Kb.lU()),G.a("ssExitTelemetryEnabled")&&B.a.$(508071949,830,15,"SlideShowCoreFrame::OnExitFromSlideShowHandler: Exiting the SlideShow"),Ka?this.xa.raiseEvent("OnExit",new E({["SlideId"]:Ka.slideId.sid,["IsBeforeReady"]:!1,["SlideIndex"]:Ka.slideIndex,["IsFromEndOfSlideshow"]:nb})):
(this.xa.raiseEvent("OnExit",new E({["IsFromEndOfSlideshow"]:nb})),B.a.$(512495889,830,10,"SlideShowCoreFrame::OnExitFromSlideShowHandler: currentLocation is null")),B.a.$(507773715,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler: Exit event raised")):G.a("SendExitEventOnSlideShowTimeout")&&(this.xa.raiseEvent("OnExit",new E({["IsFromEndOfSlideshow"]:nb})),B.a.$(507605470,830,15,"SlideShowCoreFrame::OnExitFromSlideShowHandler: m_slideshowCore is null, sending exit event"));this.ga&&(this.ga.style.width=
window.screen.width+"px",this.ga.style.height=window.screen.height+"px");this.Dtd(!1);za.instance.Yph()}nqd(){if(this.Jg&&this.ap&&this.ap.style.visibility!==Oa.a.ht){const nb=this.Jg.getSlideLocation();if(nb){const Ka=this.Jg.getAnimationState(!0),Sb=Ka.timelineStates,ab=[];for(let ub=0;ub<Sb.length;ub+=1)ab.push({["TimeLineId"]:Sb[ub].timelineId,["Step"]:Sb[ub].step,["LastClickTime"]:Sb[ub].lastClickTime,["StartTimeOffset"]:Ka.startTimeOffset});this.xa.raiseEvent("OnPositionChangeEventId",new M.a({["SlideId"]:nb.slideId.sid,
["SlideIndex"]:nb.slideIndex,["TimeLineMappings"]:ab}))}else B.a.$(512495888,830,10,"SlideShowCoreFrame::OnPositionChangedHandler: currentLocation is null")}}Kwk(nb){if(this.Jg&&this.ap&&this.ap.style.visibility!==Oa.a.ht)switch(nb){case "Hidden":this.xa.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty);break;case "EndOfShow":this.xa.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty);break;default:B.a.$(512495887,830,15,"SlideshowCoreFrame.OnBlankSlideStateChangedHandler {0}",nb)}}G1e(nb){if(this.Jg){B.a.$(512495886,
830,10,"SlideshowCoreFrame.OnErrorHandler {0}",nb);let Ka;nb.startsWith("Server")&&(nb="GetItemsRequestFailed");switch(nb){case "GetItemsFailedDownloadFile":B.a.$(512495885,830,10,"SlideshowCoreFrame.OnErrorHandler ErrorSlideShowFailedToDownloadFile PodSessionId {0}",this.yM);this.xa.raiseEvent("OnPodSessionExpired",new K({["Code"]:5341407,["Reason"]:"Failed To Download File",["PodSessionId"]:this.yM}));return;case "LoadFailed":Ka=407;break;case "GetItemsFailedInvalidResponse":Ka=408;break;case "GetItemsRequestFailed":Ka=
409;break;case "GetItemsTimeout":Ka=411;break;case "EnsureSlideFailed":Ka=412;break;case "SetupWebGLContextFailed":case "RestoreWebGLContextFailed":Ka=414;break;default:Ka=359}if(0!==Ka)if(this.Ggb()){const Sb=w.a.Ji(Ka);h.AFrameworkApplication.Ds(Sb);nb=409===Ka?nb:w.a.Vma(Sb);v.Health.instance.recordQosError(nb,["SlideShowACE"],!1,!0,!0,!0,null);this.Jg.recordSessionStats({["errorName"]:nb})}else B.a.$(512495884,830,15,"SlideshowCoreFrame.OnErrorHandler received error when frame is hidden. ErrorCode:{0}",
nb)}}bBk(nb){B.a.$(512495883,830,50,"SlideshowCoreFrame.OnTranscriberStartedHandler");this.Jg&&this.ap&&this.ap.style.visibility!==Oa.a.ht&&this.xa.raiseEvent("OnTranscriberStartedEventId",new Q({["TranscriberSessionId"]:nb}));this.xf.nWe=!0}q3c(){B.a.$(512495882,830,50,"SlideshowCoreFrame.OnVisibilityChangeHandler");window.document.hidden&&this.xa.raiseEvent("OnVisibilityChangeEventId",new U(!1))}yQj(){return!!this.Yd&&!!this.Yd.instance&&this.Yd.instance.V_l}NFh(nb){this.xa.addHandler("OnSlideshowReady",
nb)}pYh(nb){this.xa.removeHandler("OnSlideshowReady",nb)}rti(nb){this.xa.addHandler("OnBrowserEvent",nb)}WYk(nb){this.xa.removeHandler("OnBrowserEvent",nb)}RPl(nb){this.xa.addHandler("OnFullscreenClick",nb)}fum(nb){this.xa.removeHandler("OnFullscreenClick",nb)}vti(nb){this.xa.addHandler("OnSlideshowContextMenu",nb)}YYk(nb){this.xa.removeHandler("OnSlideshowContextMenu",nb)}TSb(nb){this.xa.addHandler("OnExit",nb)}aLb(nb){this.xa.removeHandler("OnExit",nb)}NPl(nb){this.xa.addHandler("OnSlideshowError",
nb)}cum(nb){this.xa.removeHandler("OnSlideshowError",nb)}Dxf(nb){this.xa.addHandler("OnGetCurrentSlideDimensions",nb)}lch(nb){this.xa.removeHandler("OnGetCurrentSlideDimensions",nb)}Cxf(nb){this.xa.addHandler("OnGetCurrentPosition",nb)}WDe(nb){this.xa.removeHandler("OnGetCurrentPosition",nb)}OFh(nb){this.xa.addHandler("OnSpecialKey",nb)}qYh(nb){this.xa.removeHandler("OnSpecialKey",nb)}qQl(nb){this.xa.addHandler("OnVisibilityChangeEventId",nb)}oZk(nb){this.xa.removeHandler("OnVisibilityChangeEventId",
nb)}Qti(nb){this.xa.addHandler("OnPodSessionExpired",nb)}kZk(nb){this.xa.removeHandler("OnPodSessionExpired",nb)}YPl(nb){this.xa.addHandler("OnLogEndOfTranscriptionSession",nb)}num(nb){this.xa.removeHandler("OnLogEndOfTranscriptionSession",nb)}Pjc(nb){this.xa.addHandler("OnPositionChangeEventId",nb)}F7c(nb){this.xa.removeHandler("OnPositionChangeEventId",nb)}WPl(nb){this.xa.addHandler("OnLiveSubtitlesDockedViewEventId",nb)}kum(nb){this.xa.removeHandler("OnLiveSubtitlesDockedViewEventId",nb)}Cti(nb){this.xa.addHandler("OnEnterEndOfShowEventId",
nb)}bZk(nb){this.xa.removeHandler("OnEnterEndOfShowEventId",nb)}Mti(nb){this.xa.addHandler("OnLeaveEndOfShowEventId",nb)}iZk(nb){this.xa.removeHandler("OnLeaveEndOfShowEventId",nb)}mQl(nb){this.xa.addHandler("OnSubtitleUpdatedEventId",nb)}vum(nb){this.xa.removeHandler("OnSubtitleUpdatedEventId",nb)}nQl(nb){this.xa.addHandler("OnTranscriberStartedEventId",nb)}wum(nb){this.xa.removeHandler("OnTranscriberStartedEventId",nb)}wQl(nb){this.xa.addHandler("RecordQosErrorEventId",nb)}Dum(nb){this.xa.addHandler("RecordQosErrorEventId",
nb)}JPl(nb){this.xa.addHandler("OnCameraErrorEventId",nb)}Ztm(nb){this.xa.removeHandler("OnCameraErrorEventId",nb)}fzk(nb){this.xa.raiseEvent("OnBrowserEvent",new H({["ClientX"]:nb.clientX,["ClientY"]:nb.clientY}))}N1c(nb){this.xa.raiseEvent("OnSlideshowContextMenu",new N({["ClientX"]:nb.clientPoint.x,["ClientY"]:nb.clientPoint.y}));return!0}static lU(){return Math.round(window.performance.now())}}Object(y.a)(Kb,"SlideShowCoreFrame",null,[519])},1643:function(y,C,a){a.d(C,"a",function(){return b});
y=a(0);var c;(function(d){d[d.Sjm=0]="multipleBrowsersImageClassName";d[d.xpm=1]="peopleImageClassName";d[d.ypm=4]="peopleImageClusterPath";d[d.Rjm=5]="multipleBrowserImageClusterPath";d[d.mYa=6]="imageDimension";d[d.rtl=8]="rtl";d[d.uKb=9]="pointerInputManager";d[d.zXa=10]="clickInputManager";d[d.vertical=11]="vertical";d[d.zIndex=12]="zIndex";d[d.yjd=13]="contextMenuInputManager";d[d.b8l=14]="imageDomElement";d[d.QEm=15]="useIdleTooltip";d[d.dFm=16]="viewportBoundsCallback";d[d.S0l=17]="flipHorizontalDirection";
d[d.P0l=18]="fixRemoveFadeOutElementCrash";d[d.$7l=19]="ignoreEventOnExpandedTooltip";d[d.Z8l=20]="ipWidthAdjustForFlyout"})(c||(c={}));Object(y.b)("PresenceTooltipSettingKeys",c);class b{constructor(){this.fR={}}get(d,e=null){d=c[d];return"number"===typeof e?(e=this.fR[d])?Number.parseInvariant(e.toString()):0:this.fR[d]}add(d,e){this.fR[c[d]]=e}bfa(d,e){c[d]in this.fR||(this.fR[c[d]]=e)}remove(d){delete this.fR[c[d]]}}Object(y.a)(b,"PresenceTooltipSettings",null,[])},1827:function(y,C,a){a.d(C,
"a",function(){return I});y=a(0);var c=a(405),b=a(419),d=a(420),e=a(6);class h{static ugj(O,Q,U){return h.vgj(O,Q,U,!0)}static vgj(O,Q,U,ba){const aa=document.createElementNS(h.eRe,"svg");aa.setAttribute("viewBox",String.format(h.DWi,h.CAh,h.BAh));aa.appendChild(h.msj(O,Q,U,ba));return aa}static msj(O,Q,U,ba){const aa=h.CAh/O,La=Q/2*aa,Z=h.BAh/2;let la=0;ba&&(la=(O-3*Q-4*U)*aa/2);O=document.createElementNS(h.eRe,"g");Sys.UI.DomElement.addCssClass(O,h.CWi);for(ba=1;3>=ba;ba++)O.appendChild(h.zej(ba,
La,la+(ba*(Q+U)-Q/2)*aa,Z));return O}static zej(O,Q,U,ba){const aa=document.createElementNS(h.eRe,"circle");Sys.UI.DomElement.addCssClass(aa,String.format("{0}-{1}",h.pJi,O));aa.setAttribute("cx",String.format("{0}",U));aa.setAttribute("cy",String.format("{0}",ba));aa.setAttribute("r",String.format("{0}",Q));return aa}}h.eRe="http://www.w3.org/2000/svg";h.CWi="prDancingDots";h.pJi="prAnimateCircle";h.DWi="0 0 {0} {1}";h.BAh=40;h.CAh=120;Object(y.a)(h,"ModernPresenceTooltipDancingDots",null,[]);var n=
a(41),m=a(169),k=a(109),l=a(88),u=a(221),r=a(197),x=a(111),v=a(64),z=a(3);class A extends b.a{constructor(O,Q){super(O);this.huf=this.qKa=this.Fwd=this.uya=this.aya=this.xJ=this.ov=null;this.mpa=Q.get(8,!1);this.kKa=Q.get(6,0);this.vni=Q.get(15,!1);this.je=Q;this.Uff=0;this.element=O;this.element.className=A.EWd;this.gS=document.createElement("span");this.element.appendChild(this.gS);this.N$h=h.ugj(Q.get(6,0),4,2);this.LQ(Q);this._state=5}jXa(O){this.addHandler(d.a.JJ,O)}Ebb(O){this.removeHandler(d.a.JJ,
O)}get user(){return this.huf}get state(){return this._state}dispose(){this.element&&(this.ov.hc(l.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.ov.hc(l.a.doubleClick,this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")),this.xJ.hc(l.a.aH,this.element,Object(e.a)(this,this.tla,"onPointerDown")),this.xJ.hc(l.a.IQ,this.element,Object(e.a)(this,this.h0,"onPointerOut")),this.xJ.hc(l.a.ZO,this.element,Object(e.a)(this,this.i0,"onPointerOver")),this.aya.hc(this.element,
Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}LQ(O){this.ov=O.get(10);this.ov.Ub(l.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.ov.Ub(l.a.doubleClick,this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior"));this.xJ=O.get(9);this.xJ.Ub(l.a.ZO,this.element,Object(e.a)(this,this.i0,"onPointerOver"));this.xJ.Ub(l.a.IQ,this.element,Object(e.a)(this,this.h0,"onPointerOut"));this.xJ.Ub(l.a.aH,this.element,Object(e.a)(this,
this.tla,"onPointerDown"));this.aya=O.get(13);this.aya.Ub(this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior"))}hide(O=null,Q=0,U=0){this.vni&&O?this.xjl(O,Q,U):(3===this.state&&this.ybh(),this.visible=!1,this._state=5)}xjl(O,Q,U=0){this.show(O,Q,15,4,void 0,U)}rnh(O,Q,U,ba=!1,aa=!1,La=!1,Z=0){this.show(O,Q,U+20,ba?2:aa?1:0,La,Z)}bjl(O,Q,U,ba=!1,aa=0){this.show(O,Q,U+20,3,ba,aa)}show(O,Q,U,ba=3,aa=!1,La=0){!O||ba===this.state&&this.WDj(Q,U)||(this.gpi(ba,aa,La),this.z2(O,
ba,La),this._state=ba,4===La||0===La&&!this.mpa?this.element.style.left=Q+"px":this.element.style.right=Q+"px",this.element.style.top=U+"px",this.visible=!0)}z2(O,Q,U){this.huf=O;x.a.Ow(this.gS);r.a.jKi(this.gS);this.gS.id="fly_"+O.clientId;this.gS.style.backgroundColor=O.color;4!==Q?(this.gS.style.height=this.kKa+"px",this.gS.style.lineHeight=this.kKa+"px",r.a.S4(this.gS,"border-radius",this.kKa+"px")):4===U||0===U&&!this.mpa?this.gS.style.left="0px":this.gS.style.right="0px";2!==Q&&(4===Q?x.a.CB(this.gS,
""):1===Q?this.gS.appendChild(this.N$h):(this.gS.setAttribute("dir","auto"),U=v.a.p2f(O.userName,!1),(!O.isAnonymous||n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&U||0!==Q?(O=O.userName,0===Q&&(O=U,r.a.S4(this.gS,"text-align","center")),x.a.CB(this.gS,O)):(this.uya||(this.uya=this.$Qi()),this.gS.appendChild(this.uya),r.a.S4(this.gS,"text-align","start"))))}onClick(O){if(0===this.state)return this.raiseEvent(d.a.JJ,new d.a(1,O)),
!0;3===this.state&&c.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}h0(O){3===this.state&&this.raiseEvent(d.a.JJ,new d.a(3,O));return!1}i0(O){3!==O.Dg&&this.raiseEvent(d.a.JJ,new d.a(2,O));return!1}tla(O){if(3!==O.Dg)return!0;this.raiseEvent(d.a.JJ,new d.a(4,O));return!1}$Qi(){const O=document.createElement("img");O.src=m.a.NX("doughperson_white_glyph.svg");O.setAttribute("Unselectable","on");u.a.vea(O,u.a.ii,u.a.pV);return k.c(this.kKa,this.kKa,null,null,A.N$i,"",!1,
"",this.element.ownerDocument,O)}gpi(O,Q=!1,U=0){if(!this.l1b(this.state)||!this.l1b(O))switch(Sys.UI.DomElement.removeCssClass(this.element,this.Fwd),this.state){case 4:3===O?this.vza(A.FWd,A.zXf):this.l1b(O)&&this.vza(A.DWd,A.zXf);break;case 3:4===O?this.vza(A.HWd,A.yXf):this.l1b(O)&&(Q&&this.ybh(),this.vza(A.DWd,A.yXf,Q?A.M$i:""));break;case 0:case 1:case 2:4===O?this.vza(A.HWd,A.GWd):3===O&&(Q&&this.bqi(),this.vza(A.FWd,A.GWd,Q?A.AXf:"",3===U?A.P$i:A.O$i));break;default:4===O?this.vza(A.HWd):
3===O?this.vza(A.FWd):this.l1b(O)&&this.vza(A.DWd)}}vza(...O){this.Fwd=O.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.Fwd)}bqi(){this.Uff=window.setTimeout(()=>{this.element&&(this.qKa=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.qKa),this.element.style.zIndex="2",this.qKa.style.zIndex="1")},300)}ybh(){window.clearTimeout(this.Uff);this.qKa&&(Sys.UI.DomElement.removeCssClass(this.qKa,A.GWd+" "+A.AXf),Sys.UI.DomElement.addCssClass(this.qKa,A.L$i),z.Task.delay(300).continueWith(()=>
{this.element&&this.element.parentNode===this.qKa.parentNode&&this.element.parentNode.removeChild(this.qKa)}),r.a.NDe(this.element,"z-index"))}l1b(O){return 0===O||1===O||2===O}WDj(O,Q){const U=r.a.xla(this.element.style.top);return r.a.xla(this.element.style.left)===O&&U===Q}GEe(O){3===O&&r.a.xV(this.element,"left")?(O=r.a.xla(this.element.style.left),r.a.NDe(this.element,"left"),this.element.style.right=-1*O+"px"):4===O&&r.a.xV(this.element,"right")&&(O=r.a.xla(this.element.style.right),r.a.NDe(this.element,
"right"),this.element.style.left=-1*O+"px")}}A.EWd="prModernFlyout UIFont";A.HWd="flyoutIdle";A.FWd="flyoutExpanded";A.DWd="flyoutCollapsed";A.zXf="flyoutFromIdle";A.yXf="flyoutFromExpanded";A.GWd="flyoutFromCollapsed";A.AXf="flyoutStacked";A.M$i="flyoutFromStacked";A.L$i="flyoutFadeOut";A.N$i="cui-img-cont-float cui-img-20by20";A.O$i="flyoutLtrDir";A.P$i="flyoutRtlDir";Object(y.a)(A,"ModernPresenceTooltipFlyoutControl",b.a,[]);class B{constructor(O,Q,U=2,ba=4){this.offsetTop=O;this.offsetLeft=Q;
this.tAh=U;this.Rag=ba}}Object(y.a)(B,"FlyoutsPositioningInfo",null,[]);var G=a(85);class w{constructor(O=!1,Q=!1){this.qJe=!1;this.Mm=O;this.Pyd=Q;this.qJe=n.AFrameworkApplication.ha.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO:9192023_CalculateFlyoutDirectionsToHandleRTLScenarios")}skj(O,Q,U,ba,aa,La,Z){const la=Z.y,da=Z.height;var J=this.Mdj(La);const Ca=J+Q;aa=O*U+(O-1)*aa;U=null;1===O||this.dGi(J,aa,la,da)?O=new B(0,0,2):(O=this.J9i(Ca,aa,la,da),O.offsetTop-=J);this.Pyd?
U=new B(0,0,void 0,this.Mm?4:3):(La=this.Ldj(La,Z),J=Math.max(0,Z.x),Z=Z.width,Q=La+Q,this.qJe?U=this.iGi(La,ba,J,Z):this.eGi(La,ba,J,Z)?U=new B(0,0,void 0,this.Mm?3:4):this.fGi(Q,ba,J)&&(U=new B(0,0,void 0,this.Mm?4:3)),U||(U=this.I9i(La,Q,J,Z)));return new B(O.offsetTop,U.offsetLeft,O.tAh,U.Rag)}Mdj(O){return G.a.MWe(O)}Ldj(O,Q){return this.Mm?this.qJe?G.a.AZf(O)-G.a.Kdj(O):Q.width-G.a.AZf(O):G.a.LWe(O)}dGi(O,Q,U,ba){return O+Q<=U+ba}J9i(O,Q,U,ba){let aa=1,La=Math.max(U,O-Q);Q>O-U&&(aa=2,La=Q<ba?
ba-Q:U);return new B(La,0,aa)}iGi(O,Q,U,ba){const aa=this.gGi(O,Q,U);O=this.hGi(O,Q,U,ba);if(aa||O)return new B(0,0,void 0,this.Mm?aa?3:4:O?4:3)}eGi(O,Q,U,ba){return O+Q<=U+ba}fGi(O,Q,U){return Q<=O-U}hGi(O,Q,U,ba){return O+Q<=U+ba}gGi(O,Q,U){return U<=O-Q}I9i(O,Q,U,ba){ba-Q>=O-U?O=4:(Q=O,O=3);return new B(0,Q,void 0,O)}}Object(y.a)(w,"ModernPresenceTooltipPositioner",null,[]);class F{constructor(O,Q,U,ba,aa,La,Z){this.XY=O;this._parent=Q;this.odf=U;this.X8h=ba;this.Wbi=aa;this.ymb=La;this.mpa=Z;
this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(O,Q){if(3!==O)if(5!==O&&this.XY&&this.XY.length){if(4===O){var U=this.Wbi;var ba=(this.ymb-U)/2;this.element.style.height=this.ymb+"px";this.element.style.width=this.ymb+"px";O=r.a.xla(this.XY[0].element.style.top);Q=r.a.xla(this.mpa?this.XY[0].element.style.right:this.XY[0].element.style.left)}else U=this.odf,ba=(this.ymb-U)/2,this.element.style.height=this.ymb+"px",this.element.style.width=
this.Uej()+2*ba+"px",O=r.a.xla(this.XY[this.XY.length-1].element.style.top),Q=this.xFi(this.XY[this.XY.length-1].element,U,Q);r.a.S4(this.element,"border-radius",this.ymb+"px");this.element.style.top=O-ba-U+"px";this.mpa?this.element.style.right=Q-ba+"px":this.element.style.left=Q-ba+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}xFi(O,Q,U){return this.mpa&&!U?r.a.xla(O.style.right):
this.mpa||U?this.mpa&&U?-r.a.xla(O.style.left)-Q:-r.a.xla(O.style.right)-Q:r.a.xla(O.style.left)}Uej(){return this.XY&&this.XY.length?this.odf+Math.min(this.XY.length-1,2)*this.X8h:0}}Object(y.a)(F,"ModernPresenceTooltipTarget",null,[]);var H=a(75),E=a(131),P=a(206);class T extends b.a{constructor(O,Q,U){super(O);this.Mlb=this.Qoa=this.Hif=this.X_a=!1;this.Wm=[];this.ola=(ba,aa)=>{ba=this.aWa;this.$Ai()||2!==aa.type&&(4!==aa.type||3===ba)?4===aa.type&&3===ba?(this.Qoa&&(this.Qoa=!1),this.UOd()):3!==
aa.type||3!==ba||this.X_a||(1<this.QAa?(this.Qoa=!0,z.Task.delay(250).continueWith(()=>{this.$2a(!0);this.Qoa=!1})):this.UOd()):(this.Qoa&&(this.Qoa=!1),3!==ba&&(this.sUf(),3===aa.jh.Dg&&this.UOd(2E3)));this.raiseEvent(d.a.JJ,aa)};this.Vzb=ba=>{3===ba.Dg?this.ola(this,new d.a(4,ba)):ba.eventName===l.a.ZO?this.ola(this,new d.a(2,ba)):ba.eventName===l.a.IQ&&this.ola(this,new d.a(3,ba));return!1};this.Ysc={};this.je=U;this.Mm=U.get(8,!1);this.Thf=U.get(15,!1);this.b$h=U.get(12,0);this.vMa=U.get(6,0);
this.kHb=Q;this.zuf=U.get(16);this.Pyd=U.get(17,!1);this.Ybi=U.get(19,!1);this.Lhi=U.get(20,!1);this.Wtc=0;this.Jhi=new w(this.Mm,this.Pyd);this.iMb=this.s0f();this.xEd=!1;this.Pxa=[];this.AOb=[];this.element.id=T.vXd();this.element.className=b.a.iVe("prControl",this.Mm);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.Mm;this.XGe(Q);this.Qga=this.createElement("div");this.Qga.className="prFlyoutContainer";this.element.appendChild(this.Qga);this.XY=[];this.yKa=new F(this.FS,this.element,
this.vMa,4,6,32,this.Mm);this.xJ=U.get(9);this.xJ.Ub(l.a.aH,this.yKa.element,this.Vzb);this.xJ.Ub(l.a.ZO,this.yKa.element,this.Vzb);this.xJ.Ub(l.a.IQ,this.yKa.element,this.Vzb)}get E3e(){return P.a.clone(this.Wm)}get FS(){return this.XY}get defaultZIndex(){return this.b$h}get QAa(){return this.FS?this.FS.length:0}get aWa(){return 0<this.QAa?this.FS[0].state:5}get S9d(){return 3===this.aWa&&!this.X_a}jXa(O){this.addHandler(d.a.JJ,O)}Ebb(O){this.removeHandler(d.a.JJ,O)}dispose(){if(this.S9d)this.xEd=
!0;else{if(this.FS)for(const O of this.FS)O.Ebb(this.ola),E.a.qz(O);this.XY=null;this.xJ.hc(l.a.aH,this.yKa.element,this.Vzb);this.xJ.hc(l.a.ZO,this.yKa.element,this.Vzb);this.xJ.hc(l.a.IQ,this.yKa.element,this.Vzb);super.dispose()}}ALb(){this.$2a();this.visible=!0}CJe(){this.visible=!0;this.sUf();this.X_a=!0}Soc(){this.CJe()}hide(){this.Obh();this.RBa();this.yKa.update(this.aWa,this.Mlb)}z2(O){const Q=this.aWa,U=this.X_a;O.clientId||(O.clientId=(T.GOb++).toString());if(O.clientId in this.Ysc){var ba=
this.eOa(O.clientId);if(0<=ba){ba=this.Wm[ba];if(ba.color===O.color&&ba.userName===O.userName)return;this.rua(O.clientId)}}this.hide();ba=new A(this.createElement("div"),this.je);ba.jXa(this.ola);this.Qga.insertBefore(ba.element,this.Qga.firstChild);this.Ysc[O.clientId]=ba;Array.add(this.Wm,O);Array.add(this.FS,ba);this.czh(Q,U);this.visible=!0}rua(O){if(this.S9d)Array.add(this.AOb,O);else{var Q=this.aWa,U=this.X_a;this.hide();this.nec(O);this.czh(Q,U)}}Ure(O){const Q=this.eOa(O);if(!(0>=Q)){var U=
this.Wm[Q];O=this.Ysc[O];Array.removeAt(this.Wm,Q);Array.insert(this.Wm,0,U);Array.removeAt(this.FS,Q);Array.insert(this.FS,0,O);this.Qga.removeChild(O.element);this.Qga.appendChild(O.element);this.$2a()}}czh(O,Q){0>=this.Wm.length?this.hide():3===O&&Q?this.CJe():this.ALb()}cIe(O,Q){Q?this.Moi(O):this.mbh(O)}RTf(O){if(this.S9d&&this.Ybi)return!1;O=T.q0d(O);if(this.Qga!==O&&x.a.Xsb(this.Qga,O))return!0;for(const Q of this.FS)if(x.a.Xsb(Q.element,O))return!0;return!1}position(O,Q){this.element.style.top=
Q+"px";this.element.style.left=O+"px"}$2a(O=!1){if(!O||this.Qoa){this.Hif&&this.zkh(!0);var Q=Math.min(3,this.QAa)-1;O=0;var U=1,ba=0;this.Mlb&&(O=this.iMb,U=-1,ba=-this.vMa);for(let aa=this.QAa-1;aa>Q;aa--)this.FS[aa].rnh(this.Wm[aa],-4*Q*U+ba,0,!0,!1,!0,O);for(;0<=Q;Q--)this.FS[Q].rnh(this.Wm[Q],-4*Q*U+ba,0,0<Q,Array.contains(this.Pxa,this.Wm[Q].clientId),Q!==this.Wtc,O);this.Wtc=0;this.yKa.update(0,this.Mlb);this.zIndex=this.defaultZIndex;this.X_a=!1;this.Obh(0);this.xEd&&this.dispose()}}sUf(){this.Hif&&
this.zkh(!1);this.zIndex=this.defaultZIndex+1;const {offsetX:O,offsetY:Q,Qag:U}=this.qal();for(let ba=0;ba<this.QAa;ba++)this.FS[ba].bjl(this.Wm[ba],O,Q+(this.vMa+2)*ba,ba!==this.Wtc,U)}RBa(){let O=0,Q=0;this.Mlb&&(O=this.iMb,Q=-6);for(let U=0;U<this.QAa;U++)this.FS[U].hide(this.Wm[U],Q,O);this.zIndex=this.defaultZIndex;this.visible=this.X_a=!1;this.xEd&&this.dispose()}UOd(O=0){O?(this.Qoa=!0,z.Task.delay(O).continueWith(()=>{this.Thf?this.iFj():this.$2a(!0);this.Qoa=!1})):this.Thf?this.hide():this.$2a()}iFj(){this.Qoa&&
this.hide()}$Ai(){if(n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.Bca&&H.c()){const O=appChrome.selectors.getShyState();return O.isActive&&0!==O.state}return!1}XGe(O){this.element.style.width=O+"px";this.element.style.height=this.vMa+"px"}nec(O){this.mbh(O);O=this.eOa(O);if(!(0>O)){var Q=this.Wm[O];Array.removeAt(this.Wm,O);delete this.Ysc[Q.clientId];Q=this.FS[O];this.Qga.removeChild(Q.element);this.je.get(18,!1)&&Q.Ebb(this.ola);Array.removeAt(this.FS,O);Q.dispose()}}Obh(O=5){if(this.AOb.length){this.visible&&
this.RBa();for(let Q=0;Q<this.AOb.length;Q++)this.nec(this.AOb[Q]);Array.clear(this.AOb);0>=this.Wm.length||5===O?this.hide():0===O&&this.ALb()}}eOa(O){for(let Q=0;Q<this.Wm.length;Q++)if(this.Wm[Q].clientId===O)return Q;return-1}Moi(O){if(-1===this.eOa(O))c.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.Pxa,O)){if(this.Wm[0].clientId===O)return;Array.remove(this.Pxa,O)}Array.add(this.Pxa,O);this.Ure(O);1!==this.aWa&&this.$2a()}}mbh(O){-1===
this.eOa(O)?c.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.Pxa,O)&&(Array.remove(this.Pxa,O),this.Wm[0].clientId===O&&0<this.Pxa.length&&this.Ure(this.Pxa[this.Pxa.length-1]),this.Wm[0].clientId===O&&1===this.aWa&&this.$2a())}zkh(O){O?Sys.UI.DomElement.addCssClass(this.Qga,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.Qga,"prBackgroundSelection")}qal(){let O,Q;Q=O=0;var U=this.iMb;if(this.zuf){const ba=this.zuf(this);
if(!ba)return{offsetX:O,offsetY:Q,Qag:U};const aa=4===this.aWa;U=this.Jhi.skj(this.QAa,aa?6:this.vMa,this.vMa,150,2,this.element,ba);Q=U.offsetTop;this.Wtc=this.Mjj(U.tAh,U.offsetTop);U=U.Rag;U!==this.iMb&&(this.GEe(U),this.element.dir=3===U?"rtl":"ltr",this.iMb=U);U!==this.s0f()?(O=this.Lhi?-2:aa?-6:-this.vMa,this.Mlb=!0):this.Mlb=!1}return{offsetX:O,offsetY:Q,Qag:U}}Mjj(O,Q){if(1===O)return this.QAa-1;O=Math.abs(Q);return 0<O?O/(this.vMa+2):0}GEe(O){for(let Q=0;Q<this.QAa;Q++)this.FS[Q].GEe(O)}s0f(){return this.Mm?
3:4}static vXd(){return String.format("{0}-{1}","presencetooltip",T.GOb++)}static q0d(O){return O.Pb.rawEvent.relatedTarget}}T.GOb=0;Object(y.a)(T,"ModernPresenceTooltipControl",b.a,[626,40]);var K=a(254),M=a(340),N=a(330);class I{constructor(O){this.je=O;this.je.bfa(10,K.a.instance);this.je.bfa(9,N.a.instance);this.je.bfa(6,20);this.je.bfa(13,M.a.instance);this.je.bfa(17,!1)}jIh(O,Q){this.je.bfa(15,!1);return new T(O,Q,this.je)}YKf(O){this.je.bfa(15,!1);return new T(O,20,this.je)}}Object(y.a)(I,
"ModernPresenceTooltipFactory",null,[625])},419:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);a=a(30);class c extends a.a{constructor(b){super();this._element=null;this.element=b}get element(){return this._element}set element(b){this._element=b}get visible(){return"visible"===this.element.style.visibility}set visible(b){this.element.style.visibility=b?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(b){this.element.dir=b?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(b){this.element.style.zIndex=
String(b)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(b){return this.element.ownerDocument.createElement(b)}G1(){return!0}static iVe(b,d){return b+(d?"Rtl":"")}}Object(y.a)(c,"BasePresenceControl",a.a,[40,624])},420:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c extends Sys.EventArgs{constructor(b,d){super();this.type=b;this.jh=d}}c.JJ="InteractivityChanged";Object(y.a)(c,"InteractivityChangedEventArgs",
Sys.EventArgs,[])},575:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);var c=a(1263);class b{constructor(d){this.Sm=new c.a;this.Jpd=d}fca(d){const e=d.id;let h=null;this.Sm.Sb(e)?h=this.Sm.ka(e):(this.Jpd&&(h=this.Jpd(d,()=>{this.sbh(e)})),h&&this.Sm.fa(e,h));return h}J7(d){d=d.id;return this.Sm.Sb(d)?this.Sm.ka(d):null}sbh(d){this.Sm.remove(d)}}Object(y.a)(b,"ShapeComponentViewManager",null,[525])},848:function(y,C,a){a.d(C,"a",function(){return u});y=a(0);var c=a(405),b=a(324),d=a(41),e=
a(169),h=a(69),n=a(64),m=a(238),k=a(90),l=a(42);class u{static pXe(r){const x={};x.appSettings=u.RKf();x.singleSignOnSettings=u.mXe();x.appVersion="16";x.appUILocale=b.a.Le(d.AFrameworkApplication.lcid).Lfb;x.dataLocale=b.a.Le(d.AFrameworkApplication.lcid).Lfb;x.osfOmexBaseUrl=d.AFrameworkApplication.ha.Ma(k.a.NTe);x.firstPartyManifestCDNUrl=d.AFrameworkApplication.ha.Ma(k.a.YTe);x.sdxCdnUrl=d.AFrameworkApplication.ha.Ma(k.a.sdxCdnUrl);x.sdx1CdnUrl=d.AFrameworkApplication.ha.Ma("Sdx1CdnUrl");x.sdxDmsUrl=
d.AFrameworkApplication.ha.Ma(k.a.sdxDmsUrl);x.forceUseSdx1Cdn=d.AFrameworkApplication.ha.getBooleanAppSetting("ForceUseSdx1Cdn");x.sovereignFederationDMSToken=d.AFrameworkApplication.ha.Ma("SovereignFederationDMSToken");x.sovereignFederationDMSTokenSuffix=d.AFrameworkApplication.ha.Ma("SovereignFederationDMSTokenSuffix");x.sdxAssetsToPrefetchMapping=d.AFrameworkApplication.ha.Ma(k.a.sdxAssetsToPrefetchMapping);x.docUrl=r?r.documentUrl:"";x.pageBaseUrl=e.a.jH;x.lcid=d.AFrameworkApplication.lcid.toString();
x.allowExternalMarketplace=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.xid);x.localizedScriptsUrl=(d.AFrameworkApplication.xga?d.AFrameworkApplication.ha.Ma("StaticContentHostNonOverriden"):e.a.jH)+d.AFrameworkApplication.ha.Ma(k.a.nGh);r=r?r.cYe:"";x.localizedImagesUrl=e.a.jH+r;x.localizedStylesUrl=e.a.jH+r;x.localizedResourcesUrl=e.a.qFh(r);x.enableAddinCommands=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.jyc);x.enableMyApps=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.GNh);
x.enableMyOrg=d.AFrameworkApplication.ha.getBooleanAppSetting("InsertAgaveMyOrgEnabledForHost");x.enableUploadFileDevCatalog=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.jyc)&&!d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.f8e);x.enableDevCatalog=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.frd);x.devCatalogUrl=d.AFrameworkApplication.ha.Ma(k.a.mGh);x.enablePrivateCatalog=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.Eid);x.showSignOutFromPrivateCatalogMessage=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.showSignOutFromPrivateCatalogMessage);
x.enableBlackForestRedirect=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.lUe);x.enableSingleSignOnForAddin=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.ZTe)&&d.AFrameworkApplication.kOh;x.enableTaskpaneUpgradeToAppCommand=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.f7e);x.hideAppsExtensionUrl=d.AFrameworkApplication.hideAppsExtensionUrl;x.enableAnonymousUseLegacyCatalogService=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.MTe);x.enableInsertDialogAccessibilityFix=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.B1e);
x.enableFirstPartySDXErrorMessages=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.A1e);x.disableAppsForOfficeThirdParty=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.b5c);x.wacSessionId=d.AFrameworkApplication.userSessionId;x.disableLogging=!d.AFrameworkApplication.ha.getBooleanAppSetting("AriaLoggingIsEnabled");x.loggableUserId=d.AFrameworkApplication.ha.Ma("LoggableUserId");x.sessionStartInfoJson=d.AFrameworkApplication.ha.Ma("SessionStartInfoJson");x.wopiHostOriginFromPostMessage=d.AFrameworkApplication.wopiHostOriginFromPostMessage;
x.wopiHostOriginFromWacPropBag=d.AFrameworkApplication.ha.Ma("PostMessageOrigin");x.wacIsEmbedded=d.AFrameworkApplication.ha.getBooleanAppSetting("IsEmbedded");x.accessibilityAllowFocusAddinTaskpane=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.accessibilityAllowFocusAddinTaskpane);x.disableMicrophonePermission=h.a.QO(1)&&d.AFrameworkApplication.ha.getBooleanAppSetting("TranscriberSafariEnabled")&&d.AFrameworkApplication.ha.getBooleanAppSetting("RehearsalSafariEnabled");x.isHostFrameTrustCheckEnabledForAddIns=
d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.YXe);x.isHostFrameTrusted=d.AFrameworkApplication.isHostFrameTrusted;x.hostAllowedSdxEmbedding=d.AFrameworkApplication.ha.getBooleanAppSetting("HostAllowedSdxEmbedding");x.hostAllowedOfficeStore=d.AFrameworkApplication.ha.getBooleanAppSetting("HostAllowedOfficeStore");x.hostInstallAddIns=d.AFrameworkApplication.ha.Ma("HostInstallAddIns");x.hostInstallAddInsIsEnabled=d.AFrameworkApplication.ha.getBooleanAppSetting("HostInstallAddInsIsEnabled");x.approvedAddIns=
d.AFrameworkApplication.ha.Ma("ApprovedAddIns");x.is3pAddInsDisabled=d.AFrameworkApplication.ha.getBooleanAppSetting("Is3pAddInsDisabled");x.isUpnCheckEnabled=d.AFrameworkApplication.ha.getBooleanAppSetting(k.a.isUpnCheckEnabled);x.wacUpn=d.AFrameworkApplication.ha.Ma("UserPrincipalName");x.isReactRibbonEnabled=!0;x.enableSetFocusOnTaskpaneOnUserAction=!0;x.enableMyOrg&&x.docUrl&&(r=x.docUrl.split("/"),x.spBaseUrl=2<r.length?r[0]+"//"+r[2]:null,x.spBaseUrl||c.ULS.sendTraceTag(512263002,806,10,String.format("Failed to parse SpBaseUrl from DocUrl: {0}",
x.docUrl)));x.userNameHashCode=n.a.tS(d.AFrameworkApplication.userName);x.envCode=d.AFrameworkApplication.ha.Ac(k.a.dqd,0).toString();return x}static RKf(){const r={};r.AddinRibbonIdAllowUnknown=d.AFrameworkApplication.ha.getBooleanAppSetting("AddinRibbonIdAllowUnknown");r.AddinRibbonNativeGroupControlIsEnabled=!0;r.AddinRibbonTabAutoFocusIsEnabled=!0;r.AddinRibbonTabPositionIsEnabled=!0;r.AgaveAddinUploadEnabled=d.AFrameworkApplication.ha.getBooleanAppSetting("AgaveAddinUploadEnabled");r.DevConsoleEnabled=
d.AFrameworkApplication.ha.getBooleanAppSetting("AddinDevConsoleLog");r.ManifestParserDevConsoleEnabled=!0;r.flightingTreatmentVariables=d.AFrameworkApplication.ha.clc;r.DisabledChangeGates=d.AFrameworkApplication.ha.Ma("DisabledChangeGates");r.DmsSdxListPresentation=d.AFrameworkApplication.IVe;return r}static mXe(){try{const r={};(l.a("FixAddinTeamsBrowserSSO")||h.a.pQa)&&m.a.esb&&(r.UiHostSupportsAuthTokenAddinList=u.Mkd);r.UiHostSupportsAuthToken=m.a.esb;return r}catch(r){c.ULS.sendTraceTag(512263001,
344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",r.message)}return null}}u.Mkd="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5 wa200003233 ad3bb869-dfe9-409b-95f2-98016482b42 wa200003251 b2177d0c-a1d8-4c60-bc46-b1d116be3eee".split(" ");Object(y.a)(u,"AppForOfficeHelper",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25649181/wdjs/ppteditDS.ext-lazy.js.map