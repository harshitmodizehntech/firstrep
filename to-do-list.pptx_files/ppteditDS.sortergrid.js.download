'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[30],{1915:function(y,C,a){a.r(C);y=a(0);var c=a(405),b=a(298),d=a(41),e=a(95),h=a(114),n=a(88),m=a(595),k=a(124),l=a(215),u=a(69),r=a(6),x=a(42),v=a(52),z=a(130),A=a(80),B=a(339),G=a(40),w=a(1209),F=a(89),H=a(167),E=a(90),P=a(44);class T{constructor(M,N,I,O,Q,U){this.XQh=this.BRh=this.CRh=this.zod=this.dda=this.bhb=this.uL=null;this.un=this.xVc=!1;this.Lf=null;this.Wgb=-1;this.R_e=this.V_e=!1;this.hDg=this.fSh=0;
this.rTh=this.JQh=this.rQh=-1;this.fhb=this.zsa=0;this.chb=!0;this.HSc=0;this.l_e=null;this.Kf=M;this.W$=N;this.la=I;this.Ad=O;this.xn=Q;this.Nod=!1;this.Qfa=null;this.TO=U;this.GDn=d.AFrameworkApplication.ha.Ac("PPTCloseGridViewTimeoutMs",500);this.Gdm=d.AFrameworkApplication.ha.Ac("PPTGridViewDisplayNoneTimeoutMs",800);this.GEn=d.AFrameworkApplication.ha.Ac("PPTGridViewTransitionTimeoutMs",500);this.Yie=[];this.Zhm=d.AFrameworkApplication.ha.appSettings[E.a.FFa]}Kb(){this.la.Ba(P.a.yJe,v.a.application,
Object(r.a)(this,this.yJe,"showGridView"));this.la.Ba(P.a.uth,v.a.application,Object(r.a)(this,this.uth,"toggleGridView"));this.Ad.TSb(Object(r.a)(this,this.mKb,"onSlideshowExitHandler"))}yJe(M,N,I){return 2===I?this.pjl():32}pjl(){try{const M=(new Date).getTime();G.a.$(512308959,822,15,"ShowGridView: Open grid view.");this.G7e(this.rQh);this.rQh=-1;this.G7e(this.JQh);this.JQh=-1;this.G7e(this.rTh);this.rTh=-1;this.Nod=!0;this.xVc=this.V_e=this.R_e=!1;const N=this.xn.ZK();if(!N)return G.a.$(512308958,
822,10,"ShowGridView: slideOrder is null."),this.T_i(),8;G.a.$(512308957,822,15,"ShowGridView: slideOrder length: {0}.",N.length);this.xn.aYh();this.Ad.Cxf(Object(r.a)(this,this.cnc,"onGetCurrentPositionHandler"));this.chb=!0;const I=this.xn.vXe();!this.l_e||I.width===this.l_e.width&&I.height===this.l_e.height||(G.a.$(512308956,822,50,"ShowGridView: thumbnailSize updated, new width: {0}, new height: {1}, old width: {2}, old height: {3}",I.width,I.height,this.l_e.width,this.l_e.height),this.T_i());
if(this.uL&&this.uL.va){this.uL.gec("pptonline-slideshow-grid-view-transition-class");this.uL.va.style.display=F.a.zn;this.uL.va.style.opacity="1";this.zsa=Date.now();this.Lf.events.onSlideSelectionChanged.subscribe(Object(r.a)(this,this.cKe,"slideSelectionChangeHandler"));this.Lf.events.onVisibleSlideRangeChanged.subscribe(Object(r.a)(this,this.BQe,"visibleSlideRangeChangedHandler"));const Q=this.W$.ETb(N,this.xn.dgb());this.Loi(Q);this.Lf.slideDataList=Q;this.Lf.sectionDataList=this.W$.Bzc(Q)}else{this.x4m();
h.a.addHandler(this.uL.va,n.a.oi,Object(r.a)(this,this.LJ,"keyDownHandler"));this.TO.K4a&&!this.Qfa&&(this.Qfa=Object(r.a)(this,this.Qcn,"fullScreenChangeHandler"),$addHandler(this.Kf,this.TO.K4a,this.Qfa));const Q=this.W$.ETb(N,this.xn.dgb()),U=this.W$.Bzc(Q);this.l_e=I;const ba=this.mWm(I);if(!this.Lf){const aa=new w.a;aa.throttleTimeoutInMs=1E3;aa.debounceWaitTimeInMs=200;aa.allowMultipleSelect=!1;aa.allowSectionsInKeyboardFocusOrdering=!0;aa.slideWidth=ba.width;aa.slideHeight=ba.height;aa.enableSelectionBetweenSlides=
!1;aa.isRTL=d.AFrameworkApplication.isRtl;aa.disabledChangeGates=d.AFrameworkApplication.ha.Ma("PPTDisabledChangeGates");x.a("LogSlideGridSubscribedEventCount")&&(aa.logger=new m.a);this.Lf=SlideGrid.SlideGridFactory.CreateSlideGrid(aa,this.CRh)}this.zsa=Date.now();this.Lf.events.onSlideSelectionChanged.subscribe(Object(r.a)(this,this.cKe,"slideSelectionChangeHandler"));this.Lf.events.onVisibleSlideRangeChanged.subscribe(Object(r.a)(this,this.BQe,"visibleSlideRangeChangedHandler"));this.Lf.show([0],
0,Q,U);h.a.addHandler(this.uL.va,n.a.focus,Object(r.a)(this,this.eSn,"onGridViewContainerDivFocus"))}this.Ad.t2l();if(this.Zhm)this.la.Ra(P.a.SEj,2,null);else{const Q=document.getElementById("slideshow-toolbar");Q&&(Q.style.display=F.a.Uf)}const O=document.getElementById("LiveURLBarLayerHost");O&&(O.style.display=F.a.Uf);this.uL.gec("pptonline-slideshow-grid-view-transition-class");this.uL.va.style.display=F.a.zn;this.uL.va.style.opacity="1";this.FUb(null);k.FocusManager.vz(this.uL.va);this.Ovh(!1);
this.xn.KFh(Object(r.a)(this,this.gqd,"onDataStoreUpdated"));this.Ad.F7c(Object(r.a)(this,this.y6e,"slideChangedHandler"));G.a.$(512308955,822,50,"GridViewActor: time taken for ShowGridViewImpl: {0}.",(new Date).getTime()-M);return 32}catch(M){return G.a.$(512308954,822,10,"GridViewActor: Exception in ShowGridView: {0}.",M),this.zeo(),8}}uth(M,N,I){try{if(2===I)if(G.a.$(512308953,822,15,"ToggleGridView called."),this.Nod)this.Ovh(!0),this.IBc(!1);else return this.pjl();return 32}catch(O){return G.a.$(512308952,
822,10,"GridViewActor: Exception in ToggleGridView: {0}.",O),8}}mWm(M){const N=new z.a(0,0);M.height&&M.width?(M=M.width/M.height,1<=M?(N.width=247,N.height=247/M):(N.height=247,N.width=247*M)):(N.width=247,N.height=247/1.76);return N}cnc(M,N){try{this.Ad.WDe(Object(r.a)(this,this.cnc,"onGetCurrentPositionHandler")),this.Wgb=N.slideIndex,this.Ad.x5l(this.Wgb,N.ztd)}catch(I){G.a.$(512308951,822,10,"Exception in GoToSlideWithTimeLines: {0}.",I)}try{this.uL&&(this.uL.va.style.display=F.a.zn);this.uL&&
k.FocusManager.vz(this.uL.va);this.HSc=0;const I=this.xn.ZK();if(I){const O=this.W$.ETb(I,this.xn.dgb());this.Loi(O);const Q=this.W$.Bzc(O);this.Lf.show([this.Wgb],this.Wgb,O,Q)}}catch(I){G.a.$(512308950,822,10,"Exception in OnGetCurrentPositionHandler: {0}.",I)}}y6e(M,N){try{if(this.V_e&&N){const I=N.slideIndex;this.Wgb!==I||0>this.Wgb?G.a.$(512308949,822,15,"GridViewActor-SlideChangedHandler: currentSelectedSlideIndex not equal to slideIndex in args. currentSelectedSlideIndex: {0}, slideIndex: {1}.",
this.Wgb,I):(this.Ad.F7c(Object(r.a)(this,this.y6e,"slideChangedHandler")),this.Ad.Xld(I),this.hDg=Date.now(),this.Rbm(),this.IBc(!0),this.V_e=!1)}}catch(I){G.a.$(512308948,822,10,"Exception in SlideChangedHandler: {0}.",I)}}eSn(){this.Lf&&this.Lf.restoreFocusToGrid()}LJ(M){try{if(M.keyCode===l.a.Ipc)this.LUe(null);else if(M.keyCode===l.a.nv){const N=this.Yie?this.Yie[this.HSc]:null;!N||N.className!==this.BRh.className&&N.className!==this.XQh.className||this.LUe(null)}else if(M.keyCode===l.a.RZa&&
!this.TO.sYa)this.Nod&&(this.Ad.exit(),this.IBc(!1));else if(M.keyCode===l.a.yt)M.preventDefault(),M.stopPropagation();else if(M.keyCode===l.a.vJ)this.Lf.activeFocusSlideIndex=0;else if(M.keyCode===l.a.yz){const N=this.xn.ZK();N&&0<N.length&&(this.Lf.activeFocusSlideIndex=N.length-1)}M.ctrlKey&&M.keyCode===l.a.xaa&&((this.HSc=M.shiftKey?Math.abs((this.HSc-1)%this.Yie.length):(this.HSc+1)%this.Yie.length)?0<this.HSc?k.FocusManager.vz(this.Yie[this.HSc]):G.a.$(512308947,822,15,"GridViewActor: wrong focus index value: {0}.",
this.HSc):this.Lf.restoreFocusToGrid())}catch(N){G.a.$(512308946,822,10,"GridViewActor: Exception in KeyDownHandler : {0}.",N)}}gqd(M,N){try{const O=this.xn.ZK();if(O){var I=this.W$.ETb(O,this.xn.dgb());this.Loi(I);this.Lf.slideDataList=I;this.Lf.sectionDataList=this.W$.Bzc(I);if(N.SlideIndex){const Q=N.SlideIndex;-1!==Q&&(0<=Q&&Q<O.length?this.FUb(O[Q]):G.a.$(512308944,822,10,"OnDataStoreUpdated: slideIndex is invalid: {0}.",Q))}else G.a.$(512308943,822,10,"OnDataStoreUpdated: SlideIndex is null from eventData.")}else G.a.$(512308945,
822,10,"OnDataStoreUpdated: slideOrder is null.")}catch(O){G.a.$(512308942,822,10,"Exception in OnDataStoreUpdated: {0}.",O)}}FUb(M){try{const N=this.Lf.visibleSlideRange;let I=!1;if(M)for(const O of N){if(O.slideSid===M.sid){I=!0;break}}else I=!0;if(I){M=!0;for(const O of N)for(const Q of this.Lf.slideDataList)if(Q.slideID.slideSid===O.slideSid&&Q.slideID.slideCid===O.slideCid&&!Q.thumbnailImage){M=!1;break}M&&0<this.zsa&&(this.fhb=Date.now(),G.a.$(512308941,822,15,"VisibleSlideRangePLT - firstVisibleRangePLTCalc: {0}, visibleSlideLength: {1}, startTime: {2}, endTime: {3}, elapse: {4}.",
this.chb,N.length,this.zsa,this.fhb,this.fhb-this.zsa),this.chb&&(this.chb=!1),this.fhb=this.zsa=0)}}catch(N){G.a.$(512308940,822,10,"Exception in CheckAndLogVisibleSlideRangePLT: {0}.",N)}}cKe(M,N){try{this.fSh=Date.now();const Q=N.slideIndex;G.a.$(512308939,822,15,"GridViewActor: SlideSelectionChangeHandler - targetSlideIndex: {0}.",Q);if(0>this.Wgb)G.a.$(512308938,822,10,"GridViewActor-SlideSelectionChangeHandler: wrong currentSelectedSlideIndex: {0}.",this.Wgb);else{var I=this.xn.ZK();if(!I||
0>=I.length)G.a.$(512308937,822,10,"GridViewActor-SlideSelectionChangeHandler: wrong slideOrder.");else{var O=this.Wgb===I.length-1;this.Wgb!==Q||O?(this.Ad.Pjc(Object(r.a)(this,this.y6e,"slideChangedHandler")),this.Wgb=Q,this.V_e=!0,this.Ovh(!0),0<=Q&&this.Ad.Xld(Q),this.G7e(this.rQh),this.rQh=window.setTimeout(()=>{try{this.Nod&&this.V_e&&this.IBc(!0)}catch(U){G.a.$(512308935,822,10,"GridViewActor: Exception in closeGridViewTimeoutHandler: {0}.",U)}},this.GDn)):(G.a.$(512308936,822,15,"GridViewActor: SlideSelectionChangeHandler - targetSlideIndex is the same to currentSelectedSlideIndex: {0}",
this.Wgb),this.V_e||(this.Ovh(!0),this.hDg=Date.now(),this.Rbm(),this.IBc(!0)))}}}catch(Q){G.a.$(512308934,822,10,"GridViewActor: Exception in SlideSelectionChangeHandler: {0}.",Q)}}Ovh(M){this.Ad?(this.Ad.Dtd(M),M&&!this.xVc&&(u.a.ek||document.activeElement.blur(),this.Ad.hga())):G.a.$(512308933,822,10,"GridViewActor: m_frame is null in TryToggleSlideShowFrame.")}BQe(){try{this.zsa=Date.now();this.FUb(null);const M=this.Lf.visibleSlideRange,N=[];for(const I of M)N.push(new A.a(Object.assign(new B.a,
{Cid:I.slideCid,Sid:I.slideSid})));this.xn.S4e(N)}catch(M){G.a.$(512308932,822,10,"GridViewActor: Exception in VisibleSlideRangeChangedHandler: {0}.",M)}}Loi(M){if(M)for(const N of M)N.slideAriaLabel=N.slideTitle,N.isHiddenSlide&&(N.slideAriaLabel+=", "+ResourceStrings.l_SlideIsHidden),N.slideAriaLabel+=" "+ResourceStrings.l_GridView_GridThumbnailTitle}x4m(){this.uL=new H.a;this.Yie.push(this.uL.va);this.CRh=document.createElement("div");this.uL.va.appendChild(this.CRh);this.uL.va.setAttribute("tabindex",
"0");this.uL.va.setAttribute("aria-label",ResourceStrings.L_GridView_GridContainerTitle);this.BRh||(this.BRh=this.zWl());this.uL.va.appendChild(this.BRh);this.uL.va.id="pptonline-slideshow-grid-view-id";this.uL.va.className="pptonline-slideshow-grid-view-class";this.CRh.className="pptonline-slideshow-grid-view-inner-container-class";this.Kf.appendChild(this.uL.va);this.uL.va.style.width="100%";this.uL.va.style.height="100%";this.uL.gec("pptonline-slideshow-grid-view-transition-class");this.uL.va.style.display=
F.a.zn;this.uL.va.style.opacity="1"}zWl(){const M=document.createElement("div");this.Yie.push(M);var N=d.AFrameworkApplication.isRtl;M.setAttribute("role","button");M.className=N?"pptonline-slideshow-grid-view-close-button-class rtl-ui":"pptonline-slideshow-grid-view-close-button-class";M.setAttribute("tabindex","0");N=document.createElement("i");N.className="ms-Icon ms-Icon--Back";M.appendChild(N);M.title=ResourceStrings.L_GridView_CloseButtonNewText;M.setAttribute("aria-label",ResourceStrings.L_GridView_CloseButtonNewText);
h.a.addHandler(M,n.a.click,Object(r.a)(this,this.LUe,"closeButtonClickHandler"));return M}IBc(M){try{if(G.a.$(512308931,822,50,"GridViewActor: CloseGridView called."),this.R_e)G.a.$(512308930,822,15,"GridViewActor: GridView is in closing status.");else if(this.uL){this.R_e=!0;this.xn.S1h();this.xn.$tm(Object(r.a)(this,this.gqd,"onDataStoreUpdated"));this.uL.Nw("pptonline-slideshow-grid-view-transition-class");this.bhb&&(this.bhb.va.style.display=F.a.Uf);M?(this.G7e(this.rTh),this.G7e(this.JQh),this.rTh=
window.setTimeout(()=>{try{this.uL.va.style.opacity="0",this.Nod=!1}catch(I){G.a.$(512308929,822,10,"Exception in setZeroOpacityHandler: {0}.",I)}},this.Gdm-this.GEn),this.JQh=window.setTimeout(()=>{try{this.R_e=!1,this.uL.va.style.display=F.a.Uf}catch(I){G.a.$(512308928,822,10,"Exception in displayNoneTimeoutHandler: {0}.",I)}},this.Gdm)):(this.uL.va.style.opacity="0",this.R_e=this.Nod=!1,this.uL.va.style.display=F.a.Uf);this.Lf&&(this.Lf.events.onSlideSelectionChanged.unsubscribe(Object(r.a)(this,
this.cKe,"slideSelectionChangeHandler")),this.Lf.events.onVisibleSlideRangeChanged.unsubscribe(Object(r.a)(this,this.BQe,"visibleSlideRangeChangedHandler")));this.Zhm&&this.la.Ra(P.a.mjl,2,null);var N=document.getElementById("LiveURLBarLayerHost");N&&(N.style.display=F.a.zn)}}catch(I){G.a.$(512308899,822,10,"GridViewActor: Exception in CloseGridView: {0}.",I),this.R_e=!1}}zeo(){try{if(!this.bhb){this.bhb=new H.a;this.dda=new H.a;this.XQh||(this.XQh=this.zWl());this.bhb.va.appendChild(this.XQh);this.bhb.va.appendChild(this.dda.va);
this.dda.Nw("pptonline-slideshow-grid-view-error-ui-inner");const M=document.createElement("div"),N=document.createElement("span");N.innerText=ResourceStrings.L_GridView_TryAgainError;M.setAttribute("tabindex","0");M.className="pptonline-slideshow-grid-view-error-ui-message";M.appendChild(N);this.dda.va.appendChild(M);const I=document.createElement("div"),O=document.createElement("span");O.innerText=ResourceStrings.L_GridView_TryAgainButton;I.setAttribute("tabindex","0");I.className="pptonline-slideshow-grid-view-try-again-button";
I.appendChild(O);this.dda.va.appendChild(I);h.a.addHandler(I,n.a.click,Object(r.a)(this,this.zuh,"tryAgainButtonClickHandler"));if(this.Kf)this.Kf.appendChild(this.bhb.va);else{this.bhb=null;return}this.bhb.va.setAttribute("tabindex","0");this.bhb.Nw("pptonline-slideshow-grid-view-error-ui-class");this.bhb.Nw("pptonline-slideshow-grid-view-class")}this.dda.va.style.display=F.a.zn;this.bhb.va.style.display="flex";h.a.addHandler(this.uL.va,n.a.oi,Object(r.a)(this,this.LJ,"keyDownHandler"));k.FocusManager.vz(this.uL.va)}catch(M){G.a.$(512308898,
822,10,"Exception in ShowGridViewErrorUI: {0}.",M)}}showLoadingSpinner(){if(!this.zod){this.zod=new H.a;this.zod.Nw("grid-view-spinner-class");const M=document.createElement("div");M.className="grid-view-spinner-inner-class";this.zod.va.appendChild(M);if(this.Kf)this.Kf.appendChild(this.zod.va);else{this.zod=null;return}}this.zod.va.style.display="flex"}zuh(){try{this.showLoadingSpinner(),this.dda.va.style.display=F.a.Uf,window.setTimeout(()=>{this.bhb&&(this.bhb.va.style.display=F.a.Uf);this.zod.va.style.display=
F.a.Uf;this.pjl()},1E3)}catch(M){G.a.$(512308897,822,10,"Exception in TryAgainButtonClickHandler: {0}.",M)}}G7e(M){0<=M&&window.clearTimeout(M)}mKb(){try{this.xVc=!0,this.Ad.aLb(Object(r.a)(this,this.mKb,"onSlideshowExitHandler")),this.Nod&&this.IBc(!1)}catch(M){G.a.$(512308896,822,10,"GridViewActor: Exception in OnSlideshowExitHandler: {0}.",M)}}Qcn(){try{this.Nod&&this.IBc(!1)}catch(M){G.a.$(512308895,822,10,"GridViewActor: Exception in FullScreenChangeHandler: {0}.",M)}}LUe(){try{this.Ovh(!0),
this.IBc(!1)}catch(M){G.a.$(512308894,822,10,"GridViewActor: Exception in CloseButtonClickHandler: {0}.",M)}}Rbm(){G.a.$(512308893,822,15,"GridViewActor: selectedSlideIndex: {0}, selectedTime: {1}, showTime: {2}, elapse: {3}",this.Wgb,this.fSh,this.hDg,this.hDg-this.fSh);this.hDg=this.fSh=0}dispose(){try{this.un||(this.un=!0,this.IBc(!1),this.Ad.aLb(Object(r.a)(this,this.mKb,"onSlideshowExitHandler")),this.TO.K4a&&this.Qfa&&$removeHandler(this.Kf,this.TO.K4a,this.Qfa),this.T_i())}catch(M){G.a.$(512308892,
822,10,"GridViewActor: Exception in Dispose: {0}.",M)}}T_i(){G.a.$(512308891,822,50,"GridViewActor: DisposeSlideGridComponentIfExist.");this.uL&&(h.a.removeHandler(this.uL.va,n.a.oi,Object(r.a)(this,this.LJ,"keyDownHandler")),this.Kf.removeChild(this.uL.va),this.uL=null);this.Lf&&(this.Lf=null)}}Object(y.a)(T,"GridViewActor",null,[1157,40]);class K{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.SorterGrid"}oc(M){this.ga=M}init(){b.a.instance&&b.a.instance.mc("SlideGridPackageLoaded",
Date.now());this.fvn()}fvn(){try{c.ULS.sendTraceTag(512254412,202,50,"SorterGrid:Init - Grid component package");const M=b.a.instance;M&&M.mc("SorterGridFullAppSettingsReady",Date.now());this.sQd()}catch(M){c.ULS.sendTraceTag(512254411,811,10,"PPTWebEditorSorterGridPackage: exception in OnFullAppSettingsReady: {0}",M)}}sQd(){const M=(new Date).getTime(),N=this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame").gN();this.ga.register(T,"PowerPointWebEditor.GridViewActor").pa(()=>new T(N,this.ga.resolve("PowerPointWebEditor.ISlideGridHelper"),
d.AFrameworkApplication.ub,this.ga.resolve("PowerPointWebEditor.ISlideshowFrame"),this.ga.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),this.ga.resolve("PowerPointWebEditor.IFullscreenHelper"))).oa();this.ga.resolve("PowerPointWebEditor.GridViewActor").Kb();c.ULS.sendTraceTag(512254409,811,50,"PPTWebEditorSorterGridPackage: Time Taken to create and Register SorterGrid Objects: {0}",(new Date).getTime()-M)}dispose(){try{const M=this.ga.Db("PowerPointWebEditor.IThumbnailDataStoreManager"),
N=this.ga.Db("PowerPointWebEditor.GridViewActor");M&&M.dispose();N&&N.dispose()}catch(M){c.ULS.sendTraceTag(512254408,811,10,"PPTWebEditorSorterGridPackage: exception in Dispose: {0}",M)}}static main(){e.a.instance.Jc(new K)}}Object(y.a)(K,"PPTWebEditorSorterGridPackage",null,[4,5]);a=a(18);Type.registerNamespace("PPTGridComponent");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.SorterGrid");Object(a.c)("Sortergrid");K.main();Object(a.b)("Sortergrid")}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25649181/wdjs/ppteditDS.sortergrid.js.map