'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14,16],{1051:function(y,C,a){a.d(C,"a",function(){return b});var c=a(50);const b=()=>c.a.instance.resolve("Postmessage.IHostPostmessenger")},1057:function(y,C,a){a.d(C,"a",function(){return b});var c=a(50);const b=()=>c.a.instance.eb("Common.App.Header.HeaderEventSource")},1064:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}c.Image16by16Class="Image16by16Class";c.Image32by32Class="Image32by32Class";
c.On="On";c.LabelText="LabelText";c.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly";c.EnsureControlRoleIsButton="EnsureControlRoleIsButton";c.Visible="Visible";Object(y.a)(c,"SplitButtonCommandProperties",null,[])},1099:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);a=a(365);class c extends a.a{constructor(){super();this.SecondaryText=this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(y.a)(c,"IconGalleryButtonProps",a.a,
[])},1118:function(y,C,a){a.d(C,"b",function(){return b});a.d(C,"a",function(){return d});a.d(C,"c",function(){return e});var c=a(64);a(425);a(43);a(74);const b=(h,n)=>{const m=[];if(h.length!==n.length)return m;for(let k=0;k<h.length;k++){const l={};l.key=n[k];l.text=h[k];l.type="AppComboBoxItem";m[k]=l}return m},d=(h,n,m,k,l)=>({["unitType"]:h,["unitPlaceholder"]:c.a.Kqd(n),["minValue"]:m,["maxValue"]:k,["step"]:l}),e=h=>"1.00"===h?1:"1.50"===h?1.5:"2.00"===h?2:0},1128:function(y,C,a){a.d(C,"a",
function(){return h});y=a(0);var c=a(88),b=a(6),d=a(460),e=a(123);class h{constructor(n,m,k,l,u,r,x,v,z,A,B,G){this.UDf=1;this.nRa=m;this.Po=n;this.Y$j=k;this.kj=z;this.dD=A;this.kf=B;this.JYc=v;this.RWc=u;this.SWc=l;this.YDa=r;this.kj.addCssClass(this.Po,"prControl");this.Po.style.width=this.kj.Zc(m);this.qQ=x.bXl();this.ITc=x.aXl();this.qQ.YTb(n);this.ITc.YTb(n,m,m);this.jpd=G;this.Xdc()}dispose(){this.iwh();this.clear();this.qQ.dispose();this.ITc.dispose();this.kj.removeCssClass(this.Po,"prControl")}get qKb(){return e.a.none}clear(){this.vkc();
this.IUe();this.Y4e()}setZIndex(n){this.Po.style.zIndex=String(n)}OUg(){this.jpd.va.style.zIndex=String(this.UDf+d.a.Dva)}Y4e(){this.jpd.va.style.zIndex="0"}JZh(n,m,k=null){n=this.JYc.jSi(this.nRa,this.nRa,this.Y$j,n,"",k);this.qQ.setImage(n,m)}tJd(n,m){this.ITc.add(n,m)}IUe(){this.ITc.clear()}vkc(){this.qQ.clear()}onClick(){return!0}Xdc(){this.SWc&&this.dD.Ub(c.a.ZO,this.Po,this.SWc);this.RWc&&this.dD.Ub(c.a.IQ,this.Po,this.RWc);this.YDa?this.kf.Ub(c.a.click,this.Po,this.YDa):this.kf.Ub(c.a.click,
this.Po,Object(b.a)(this,this.onClick,"onClick"));this.kf.Ub(c.a.doubleClick,this.Po,Object(b.a)(this,this.onClick,"onClick"))}iwh(){this.SWc&&this.dD.hc(c.a.ZO,this.Po,this.SWc);this.RWc&&this.dD.hc(c.a.IQ,this.Po,this.RWc);this.YDa?this.kf.hc(c.a.click,this.Po,this.YDa):this.kf.hc(c.a.click,this.Po,Object(b.a)(this,this.onClick,"onClick"));this.kf.hc(c.a.doubleClick,this.Po,Object(b.a)(this,this.onClick,"onClick"))}}Object(y.a)(h,"ShapePawn",null,[526])},1178:function(y,C,a){a.d(C,"a",function(){return d});
y=a(0);var c=a(64);class b{constructor(e,h){this.azg=e;this.m_message=h}get kCa(){return this.azg}get message(){return this.m_message}}Object(y.a)(b,"CalloutNotificationError",null,[]);class d{constructor(e,h){this.Vnd=e;this.fPg=h}AY(e,h,n,m,k,l,u,r,x,v,z,A,B,G){this.Vnd.show(this.fPg,null,!1,x,v,e,h,n,k,m,l,u,r,z,A,B,G)}VPf(){this.Vnd.dismiss()}sJe(e){if(!e)throw Error.argumentNull("CalloutNotificationMessageAttributes");const h=this.cAh(e);if(h&&h.kCa)return h;this.AY(e.title,e.message,e.mmd,e.Xhb,
e.nmd,e.xoc,e.q7g,e.shh,e.r7g,e.uhh,!!e.timeoutInSeconds,e.timeoutInSeconds,e.S$f,e.zwa);return new b(!1,null)}cAh(e){return c.a.wb(e.title)?new b(!0,"Invalid Title"):c.a.wb(e.message)?new b(!0,"Invalid Message"):e.mmd&&c.a.wb(e.Xhb)?new b(!0,"Missing PrimaryButtonLabel"):e.nmd&&c.a.wb(e.xoc)?new b(!0,"Missing SecondaryButtonLabel"):new b(!1,null)}}Object(y.a)(d,"CalloutNotificationAdapter",null,[687])},1226:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(b,d=null,e=null,
h=null){this.iconSet={};this.iconSet["default"]=b;this.iconSet.icon16=d;this.iconSet.icon24=e;this.iconSet.icon32=h}}Object(y.a)(c,"IconSetContainer",null,[])},1257:function(y,C,a){a.r(C);a.d(C,"ApplicationFeatureHelperPackage",function(){return Oa});y=a(0);var c=a(50),b=a(405),d=a(1707),e=a(36),h=a(1703),n;(function(ma){ma[ma.dXm=0]="applicationFeatureHelperHandler";ma[ma.B1m=1]="cloudPolicySettings";ma[ma.IWm=2]="alternateAuthToken"})(n||(n={}));Object(y.b)("ApplicationFeatureHelperRequestType",
n);class m{constructor(){this.message=null;this.httpStatusCode=0}}Object(y.a)(m,"HttpRequstToPromiseRejectData",null,[]);var k=a(118),l=a(100),u=a(181),r=a(429),x=a(1502),v=a(1831);class z{constructor(ma,za){this.Ga=ma;this.Dn=za}P2(ma,za,Qa,Xa=null,Tb=null,Kb=null,nb=null,Ka=null){const Sb=n[Qa],ab=Sb+"RequestFailure";k.Health.instance.recordKpiUsage(ab,x.b.FailureBased,"jpittsdirects",null);return new Promise((ub,Aa)=>{b.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",
Sb);const tb=null!=nb?nb:this.Ga.Ac("ApplicationFeatureHelperRequestQueueTimeout",15E3),kc=null!=Ka?Ka:this.Ga.Ac("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Dn.lZ(ma,1,null,this.Vqb(Qa,Xa),Kb,!1,1,dc=>{b.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",Sb);try{if(void 0===dc||null===dc||void 0===dc.data||null===dc.data||void 0===dc.data.responseData||null===dc.data.responseData){k.Health.instance.recordKpiFailure(ab,
"Invalid RequestSucceededEventArgs",!1,!0,null);const sb=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",Sb);Aa(this.m3(sb,dc))}else if(dc.data.Je!==u.a.KB){k.Health.instance.recordKpiFailure(ab,"HttpStatusCode_"+dc.data.Je.toString(),!1,!0,null);const sb=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
dc.data.Je,Sb);Aa(this.m3(sb,dc))}else{void 0!==Tb&&null!==Tb&&void 0!==dc.data.gj&&null!==dc.data.gj&&Tb(dc.data.gj);var Db=za(dc.data.responseData);if(Db)b.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",Sb),ub(Db);else{k.Health.instance.recordKpiFailure(ab,"Parse Failure",!1,!0,null);const sb=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",Sb);
Aa(this.m3(sb,dc))}}}catch(sb){k.Health.instance.recordKpiFailure(ab,"Unexpected Failure",!1,!0,null),Db=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",sb,Sb),Aa(this.m3(Db,dc))}},dc=>{var Db;if(dc.data){if(Db=v.a.Bx())try{Db.set("useCommonDomain",ma.toLowerCase().includes("common").toString())}catch(sb){b.ULS.sendTraceTag(507876040,3004,50,"Failed to set useCommonDomain")}k.Health.instance.recordKpiFailure(ab,"HttpStatusCode_"+dc.data.Je.toString(),
!1,!0,{extendedProperties:Db});Db=r.a.q5a(dc.data.responseData||"No Data");Db=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",dc.data.Je,Db,Sb)}else k.Health.instance.recordKpiFailure(ab,"Invalid RequestFailedEventArgs",!1,!0,null),Db=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",Sb);Aa(this.m3(Db,dc))},null,void 0,void 0,tb,
kc)})}m3(ma,za){const Qa=new m;Qa.message=ma;Qa.httpStatusCode=za&&za.data?za.data.Je:-1;return Qa}Vqb(ma,za){const Qa={};Qa["x-UserDataSignature"]=this.Ga.Ma("UserDataSignature");Qa["x-LicensingIsEnabled"]=this.Ga.getBooleanAppSetting("LicensingIsEnabled").toString();Qa["x-CacheIsEnabled"]=this.Ga.getBooleanAppSetting("LicensingRedisIsEnabled").toString();Qa["x-OcpsIsEnabled"]=this.Ga.getBooleanAppSetting("OcpsIsEnabled").toString();Qa["x-LicensingAADIdIsEnabled"]=this.Ga.getBooleanAppSetting("LicensingAadIdIsEnabled").toString();
0===ma&&(Qa["x-LicenseCheckOnTenantEnabled"]="true",Qa["x-SupportUserConsentDependentFeatures"]="true",Qa["x-AFHUserConsentGroupValue"]="0",Qa["x-UseShellServiceForUserConsentGroup"]="true",Qa["x-SMBUserLicensingEnabled"]="true",Qa["x-AFHPIPLComplianceEnabled"]=l.a.XP(window.location.href,"wd_afhpipl")||"false",Qa["x-ConsumerLicensingSNICertIsEnabled"]=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),Qa["x-MSGraphInLicensingIsEnabled"]=
this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",!1).toString());if(za)for(const Xa of za.keys)Qa[Xa]=za.ka(Xa);return Qa}}Object(y.a)(z,"HttpRequestToPromiseUtility",null,[]);var A=a(41),B;(function(ma){ma[ma.Ybm=0]="loki";ma[ma.SXm=1]="augloopACLP"})(B||(B={}));Object(y.b)("AlternateAuthSupportApp",B);var G=a(238),w=a(15);class F{constructor(){this.Token=null;this.ExpirationTime=0}}Object(y.a)(F,"WacAlternateAuthToken",null,[]);class H{constructor(ma,za){this.otl=
3E5;this.Awe=Qa=>{let Xa=null;({NB:Xa}=w.d(Qa));return Xa};if(void 0===ma||null===ma||void 0===za||null===za)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ga=ma;this.Xpc=new d.a(e.a.Co());this.Vga=new z(ma,za);void 0!==G.a.nde&&null!==G.a.nde&&void 0!==G.a.oRc&&null!==G.a.oRc&&0<G.a.oRc&&(ma=new F,ma.Token=G.a.nde,ma.ExpirationTime=G.a.oRc,this.Xpc.fa("loki",ma))}Wcj(ma){let za=null;this.Xpc.Sb(B[ma])&&(za=this.Xpc.ka(B[ma]));return void 0===za||null===za||this.wZj(za)?
this.C7i(ma):Promise.resolve(za.Token)}wZj(ma){return ma.ExpirationTime-Date.now()<this.otl}C7i(ma){const za=new d.a(e.a.Co());za.fa("X-AlternateAuthApp",B[ma]);return(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",!1)?Promise.race([this.Vga.P2(this.WP("/afhs/AlternateAuthHelperHandler.ashx",!0),this.Awe,2,za),this.Vga.P2(this.WP("/afhs/AlternateAuthHelperHandler.ashx",!1),this.Awe,2,za)]):this.Vga.P2(this.WP("/afhs/AlternateAuthHelperHandler.ashx",
this.Ga.getBooleanAppSetting("SuiteOriginForAFHSIsEnabled"),this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseOwlOriginForAFHS",!1)),this.Awe,2,za)).then(Qa=>{b.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",B[ma]);this.Xpc.fa(B[ma],Qa);return Qa.Token},Qa=>{Qa=Object(h.a)(m,Qa);b.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",Qa.message,
Qa.httpStatusCode);return null})}WP(ma,za,Qa=!1){ma=String.format("{0}{1}?{2}",Qa?"https://ffc-owl.officeapps.live.com":za?this.Ga.Ma("SuiteOrigin"):this.Ga.Ma("WebServiceBase"),ma,A.AFrameworkApplication.Fh);this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddUserSessionIdForAFHS",!1)&&(ma+="&usid="+A.AFrameworkApplication.userSessionId);return ma}}Object(y.a)(H,"AlternateAuthHelper",null,[119]);var E=a(1283);class P{constructor(ma,za,Qa){this.featureName=null;this.isEnabled=!1;this.tierName=
0;this.featureName=ma;this.isEnabled=za;this.tierName=Qa}}Object(y.a)(P,"FeatureStateChangeArgs",null,[]);var T=a(198),K=a(69),M=a(17),N=a(132),I;(function(ma){ma[ma.Enabled=0]="Enabled";ma[ma.Disabled=1]="Disabled"})(I||(I={}));Object(y.b)("FeatureState",I);var O=a(57),Q=a(416);class U{constructor(ma,za,Qa=null,Xa=null,Tb=null){this.aOa=this.cV=this.sqf=this.RKa=this.Iwc=null;this.Cwe=Kb=>{(Kb=w.b(Kb))?(b.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),
b.ULS.sendTraceTag(50938594,3004,50,"{0}",Kb)):b.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return Kb.Features};this.jyj=()=>{b.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.aOa.then(Kb=>{this.oah(Kb)}).catch(()=>{this.oah({})})};this.nAe=Kb=>{try{Kb&&"Date"in Kb&&(this.cV=new Date(Kb.Date),b.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",
this.cV.toString()))}catch(nb){b.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",nb)}};this.Vga=new z(ma,za);this.Ga=ma;this.Oei=ma.Ac("LicensingMaxRetryAttempts",0);this.UOb=ma.getBooleanAppSetting("IsO365ConsumerHost");this.kBd=ma.getBooleanAppSetting("IsO365CommercialHost");this.TAd=ma.getBooleanAppSetting("PremiumUpsellIsEnabled");this.Nkb=!1;this.tCd=0;this.kdf=Qa;this.nuf=Xa;this.Aa=Tb;this.QKa=ma.getBooleanAppSetting("LicensingIsEnabled");this.X0a=
ma.getBooleanAppSetting("OcpsIsEnabled")&&this.kBd;this.qId=ma.getBooleanAppSetting("ShowPrivacyDialog")&&!!Xa;this.htc=ma.getBooleanAppSetting("IsAnonymousUser");this.nGc=new Promise(Kb=>{Kb(!1)});this.kWa=new Promise(Kb=>{Kb(!0)});this.$Na=new d.a(e.a.Co());this.Nxc=!0;this.$lf=this.ykj();this.N$d()&&!this.htc?(void 0!==A.AFrameworkApplication.Ha&&null!==A.AFrameworkApplication.Ha&&(this.Iwc=A.AFrameworkApplication.Ha.Iea,void 0!==this.Iwc&&null!==this.Iwc&&(this.RKa=this.Iwc.izb("WebServiceCall",
"ApplicationFeatureHelperService"))),this.aOa=this.fOe()):this.aOa=new Promise(Kb=>{Kb({})});this.aOa.catch(Kb=>{Kb=Object(h.a)(m,Kb);b.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",Kb?Kb.httpStatusCode.toString():"Unknown")});this.Nxc&&this.isFeatureEnabled("FreemiumUpsell",!0).then(Kb=>{this.Nkb=Kb;return null})}ykj(){const ma=this.Ga.Zt("AllLicensedFeatures")?this.Ga.Fz("AllLicensedFeatures"):[],za=new E.a;for(let Qa=0;Qa<ma.length;Qa++)za.add(ma[Qa]);
return za}N$d(){return this.kBd||this.UOb}fOe(ma=0,za=!1){b.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",za);const Qa=v.a.Bx();Qa&&(Qa.set("retryAttempt",ma.toString()),Qa.set("forceRefresh",za.toString()),Qa.set("isO365ConsumerHost",this.UOb.toString()),Qa.set("isO365CommercialHost",this.kBd.toString()),Qa.set("isFreemiumUpsellSettingEnabled",this.TAd.toString()),Qa.set("useCommonDomain",(this.Ga.getBooleanAppSetting("SuiteOriginForAFHSIsEnabled")&&
0===ma).toString()),Qa.set("useRace",this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",!1).toString()));k.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",Qa);k.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",x.b.SuccessBased,"waclicensing",Qa);void 0!==this.RKa&&null!==this.RKa&&this.RKa.start();let Xa=null;za&&(Xa=new d.a(e.a.Co()),Xa.fa("x-LicensingForceRefresh","true"));this.sqf=new Date;return(this.QKa?
this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",!1)?Promise.race([this.Vga.P2(this.WP("/afhs/ApplicationFeatureHelperHandler.ashx",!0),this.Cwe,0,Xa,this.nAe,["Date"]),this.Vga.P2(this.WP("/afhs/ApplicationFeatureHelperHandler.ashx",!1),this.Cwe,0,Xa,this.nAe,["Date"])]):this.Vga.P2(this.WP("/afhs/ApplicationFeatureHelperHandler.ashx",this.Ga.getBooleanAppSetting("SuiteOriginForAFHSIsEnabled")&&0===ma,this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseOwlOriginForAFHS",
!1)),this.Cwe,0,Xa,this.nAe,["Date"]):Promise.resolve({})).then(Tb=>{const Kb={durationMs:this.Qph(),extendedProperties:Qa};Kb.extendedProperties&&Tb&&(Kb.extendedProperties.set("featureCount",M.a.count(Tb).toString()),Kb.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Tb).toString()),Kb.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in Tb).toString()),"FreemiumUpsell"in Tb&&Kb.extendedProperties.set("isFreemiumUpsellEnabled",Tb.FreemiumUpsell.toString()),
this.cV&&Kb.extendedProperties.set("fromCache",(this.cV<this.sqf).toString()));k.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Kb);return Tb},Tb=>{const Kb=Object.assign({},{durationMs:this.Qph()}),nb=Object(h.a)(m,Tb);if(!nb)return b.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),k.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,
!0,Kb),new Promise((Ka,Sb)=>{Sb(Tb)});Kb.extendedProperties=Qa;Kb.extendedProperties&&Kb.extendedProperties.set("status",nb.httpStatusCode.toString());k.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,Kb);return 408===nb.httpStatusCode&&++ma<=this.Oei?this.fOe(ma):new Promise((Ka,Sb)=>{Sb(nb)})})}WP(ma,za,Qa=!1){za=String.format("{0}{1}",Qa?"https://ffc-owl.officeapps.live.com":za?this.Ga.Ma("SuiteOrigin"):this.Ga.Ma("WebServiceBase"),ma);this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddUserSessionIdForAFHS",
!1)&&(za+="?usid="+A.AFrameworkApplication.userSessionId);this.Ga.Zt("ApplicationFeatureHelperHttpCachingEnabled")&&this.Ga.getBooleanAppSetting("ApplicationFeatureHelperHttpCachingEnabled")&&(ma=U.ZIc(this.Ga))&&0<ma.length&&(this.Nxc&&(ma+="ucbf"),za=new T.QueryStringBuilder(za),za.ej("afhskey",ma),za=za.toString());return za}isFeatureEnabled(ma,za){if(!this.X0a&&!this.qId&&!this.QKa)return this.kWa;b.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
ma);if("ConnectedServices"===ma){var Qa=this.X0a?this.kdf.JV("ControllerConnectedServicesEnabled"):this.kWa;const Kb=this.qId?this.nuf.getSettings().then(nb=>2!==nb.nC,()=>za):this.kWa;return Qa.then(nb=>nb?Kb:this.nGc)}if("FreemiumUpsell"===ma&&(!this.TAd||!this.UOb||this.htc))return this.nGc;Qa=null;Qa=this.X0a?this.kdf.isFeatureEnabled(ma):this.kWa;let Xa=null;Xa=this.QKa?this.XQj(ma,za):this.kWa;let Tb=null;Tb=this.qId?this.nuf.isFeatureEnabled(ma):this.kWa;return Qa.then(Kb=>Kb?Tb.then(nb=>nb?
Xa:this.nGc):this.nGc).then(Kb=>{this.gog(ma,Kb,!0);return Kb},()=>{this.gog(ma,za,!1);return za})}gog(ma,za,Qa){b.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",ma,za,Qa)}getFeatureTier(ma,za){if(!this.QKa)return new Promise(Qa=>{Qa(2)});b.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",ma);return this.aOa.then(Qa=>this.oKc(ma,Qa,za),()=>za)}isFreemiumUpsellEnabled(){if(this.TAd&&this.UOb&&!this.htc){if(this.Nkb&&
2!==this.tCd||!this.Nkb&&1!==this.tCd)b.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.Nkb.toString()),this.tCd=this.Nkb?2:1;return this.Nkb}return!1}tam(){return Object(Q.g)()&&this.UOb&&this.htc}launchUpsellExperience(ma,za=null){b.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",ma));var Qa=v.a.Bx();Qa&&(Qa.set("experienceId",
ma),za&&Qa.set("campaignId",za));k.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",x.b.SuccessBased,"waclicensing",Qa);(Qa=c.a.instance.Db("Common.IInProductMessagingUIManager"))?Qa.Y0j(ma,this.jyj,za):(b.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),k.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.Aa.Ra(O.a.mXd,2,{["experience"]:ma}))}UKb(ma,za){if(!this.QKa)return null;if(!ma||!za)return b.ULS.sendTraceTag(594564813,
3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const Qa=N.a.create().toString();this.$Na.Sb(ma)||this.$Na.fa(ma,new d.a(e.a.Co()));this.$Na.ka(ma).add(Qa,za);b.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",Qa,ma));return Qa}kec(ma,za){this.QKa&&(ma&&this.$Na.Sb(ma)?za&&N.a.isValid(za)?this.$Na.ka(ma).Sb(za)?(b.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
za,ma)),this.$Na.ka(ma).remove(za)):b.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",za,ma)):b.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",za,ma)):b.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
ma)))}oKc(ma,za,Qa){return this.Nxc?ma in za?za[ma].LicenseTier:Qa:ma in za?this.lEk(za[ma],Qa):Qa}lEk(ma,za){switch(ma.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return za}}oah(ma){b.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const za=this.fOe(0,!0);za.then(Qa=>{this.aOa=za;M.a.count(Qa)>M.a.count(ma)?k.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):k.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess",
"FeatureCountNotIncreased",!1,!0,null);for(const Xa of this.$Na.keys)if(Xa in Qa){const Tb=this.oKc(Xa,Qa,0);Xa in ma?this.oKc(Xa,ma,0)!==Tb&&this.Kse(Xa,!0,Tb):this.Kse(Xa,!0,Tb)}else Xa in ma&&this.Kse(Xa,!1,this.oKc(Xa,ma,0))}).catch(Qa=>{k.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);b.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(Qa))})}Kse(ma,za,Qa){b.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
ma,za,Qa);za=new P(ma,za,Qa);Qa=this.$Na.ka(ma);for(const Xa of Qa)try{Xa.value(za)}catch(Tb){b.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",ma,Xa.key,Tb.message))}}WQj(ma,za){if(this.QKa){const Qa=this.$lf.contains(ma);let Xa=!0,Tb="",Kb=!1;return this.aOa.then(nb=>{ma in nb?(nb=nb[ma],Tb=I[nb.FeatureState],Xa=1!==nb.FeatureState):Xa=!Qa;this.sog(ma,Qa,
Tb,Kb,za,Xa);return Xa},()=>{Kb=!0;Qa&&(Xa=za);this.sog(ma,Qa,Tb,Kb,za,Xa);return Xa})}return this.kWa}sog(ma,za,Qa,Xa,Tb,Kb){b.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",ma,za,Xa,Qa,Tb,Kb)}XQj(ma,za){if(this.Nxc)return this.WQj(ma,za);if(this.QKa){if(this.$lf.contains(ma))return this.aOa.then(Qa=>ma in Qa,()=>za);b.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",
ma)}return this.kWa}Qph(){if(void 0!==this.RKa&&null!==this.RKa){const ma=this.RKa.ew;this.RKa.stop();return ma}return null}static ZIc(ma){try{if(K.a.zLe){const za=ma.Ma("UserDataSignature").split(".");if(1<za.length){const Qa=window.self.atob(za[1]),Xa=JSON.parse(Qa).LocalStorageKey;if(void 0!==Xa&&null!==Xa&&0<Xa.length)return Xa}}}catch(za){b.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",za.toString())}return null}}Object(y.a)(U,"ApplicationFeatureHelper",null,[120]);
var ba=a(21);class aa{constructor(ma,za){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=ma.PolicySettings;ma=new Date;ma.setMinutes(ma.getMinutes()+za);this.ExpirationTime=ma.getTime()}}Object(y.a)(aa,"CloudPolicySettingsCacheData",null,[]);var La=a(394),Z=a(360),la=a(375);class da{static loh(){return A.AFrameworkApplication.ha.getBooleanAppSetting("SideCarIsEnabled")?da.e9c&&da.Mmd?new Promise(ma=>{ma(!0)}):new Promise((ma,za)=>{da.e9c=la.a.create(A.AFrameworkApplication.ha.Ma("SideCarUrl"));
Z.a.RK(da.e9c);da.e9c.s$((Qa,Xa)=>{(da.Mmd=Xa.succeeded)?ma(Xa.succeeded):za(Xa.succeeded)})}):new Promise(ma=>{ma(!1)})}}da.Mmd=!1;da.e9c=null;Object(y.a)(da,"SideCarLoader",null,[]);class J{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(y.a)(J,"CloudPolicySettingsData",null,[]);class Ca{constructor(ma,za){this.Awd=0;this.MBc=null;this.UDk=Qa=>{let Xa=null;({NB:Xa}=w.d(Qa));Qa=!!Xa;b.ULS.sendTraceTag(50622687,3004,Qa?50:10,"ParseCloudPolicySettingsResponse: Success={0}",
Qa);return Xa};this.oAe=Qa=>{try{if(void 0!==Qa&&null!==Qa&&"CheckIn-Interval"in Qa){const Xa=parseInt(Qa["CheckIn-Interval"]);void 0!==Xa&&null!==Xa&&0<Xa&&(this.Awd=Xa)}}catch(Xa){b.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",Xa)}};this.Vga=new z(ma,za);this.Ga=ma;za=ma.Ma("HostAuthType");this.X0a=ma.getBooleanAppSetting("OcpsIsEnabled")&&ma.getBooleanAppSetting("IsO365CommercialHost")&&!(void 0===za||null===za)&&"aad"===za.toLowerCase();this.Lnf=
w.b(ma.Ma("OcpsDefaultSettings")||"{}");this.EPb=this.ZIc();za=this.Ga.Zt("ServicesControlsMicrosoftControllerServicesList")?this.Ga.Fz("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.Zwd=new E.a;for(let Qa=0;Qa<za.length;Qa++)this.Zwd.add(za[Qa]);this.X0a&&!ma.getBooleanAppSetting("IsAnonymousUser")&&ma.getBooleanAppSetting("SideCarIsEnabled")?this.MBc=this.Zvl():this.MBc=this.dvh(this.X0a,this.UDk);this.MBc.then(()=>null).catch(Qa=>{Qa=Object(h.a)(m,Qa);b.ULS.sendTraceTag(50622685,
3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",Qa?Qa.httpStatusCode.toString():"Unknown")})}JV(ma,za=!0,Qa=!0){var Xa;if(!this.X0a){const Sb=this;return new Promise(ab=>{ab(Sb.IZb(ma))})}const Tb=this,Kb=this,nb=this.MBc.then(Sb=>{try{let ab=null;Sb.PolicySettings&&"unknown"in Sb.PolicySettings&&(ab=Sb.PolicySettings.unknown);if(ab){if(ma in ab&&void 0!==ab[ma]&&null!==ab[ma])return new Promise(Aa=>{Aa("0"!==ab[ma])});const ub=ma.toLowerCase();if(ub in ab&&void 0!==ab[ub]&&
null!==ab[ub])return new Promise(Aa=>{Aa("0"!==ab[ub])});if(Qa)return b.ULS.sendTraceTag(51512667,3004,50,"Policy"+ma+" not found, using default"),new Promise(Aa=>{Aa(Tb.IZb(ma))});b.ULS.sendTraceTag(508395746,3004,50,"Policy"+ma+" not found, returning PolicyNotConfigured error");return new Promise((Aa,tb)=>{tb("PolicyNotConfigured")})}return new Promise(ub=>{ub(Tb.IZb(ma))})}catch(ab){return b.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+ma+" policy value. Error Message: {0}",ab.message),Tb.handleError(ab.toString(),
za,Tb.IZb(ma))}},Sb=>Kb.handleError(Sb,za,Kb.IZb(ma))),Ka=null===(Xa=A.AFrameworkApplication.ha)||void 0===Xa?void 0:Xa.getBooleanAppSetting("FixPolicyNotConfiguredUnhandledPromiseRejection");Xa=Sb=>{b.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",ma,Sb);return Ka?Sb:null};if(Ka)return nb.then(Xa);nb.then(Xa);return nb}isFeatureEnabled(ma,za=!0){return this.YQj(ma,za)}YQj(ma,za=!0){var Qa;let Xa=new Promise(nb=>{nb(!0)}),Tb="";"mso_sendASmile"===
ma?Tb="Enabled":"Survey"===ma||"FloodgateSurvey"===ma?Tb="SurveyEnabled":this.Zwd.contains(ma)&&(Tb="ControllerConnectedServicesEnabled");""!==Tb&&(Xa=this.JV(Tb,za));za=nb=>{b.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",ma,nb,Tb);return Kb?nb:null};const Kb=null===(Qa=A.AFrameworkApplication.ha)||void 0===Qa?void 0:Qa.getBooleanAppSetting("FixPolicyNotConfiguredUnhandledPromiseRejection");if(Kb)return Xa.then(za);
Xa.then(za);return Xa}handleError(ma,za,Qa){return za?new Promise(Xa=>{Xa(Qa)}):new Promise((Xa,Tb)=>{Tb(ma)})}dvh(ma,za){if(!ma)return Promise.resolve(new J);let Qa=!1,Xa=null;if(ma=v.a.Bx())ma.set("useCommonDomain",this.Ga.getBooleanAppSetting("SuiteOriginForAFHSIsEnabled").toString()),ma.set("useRace",this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",!1).toString());k.Health.instance.recordKpiUsage("GetCloudPolicySettings",x.b.SuccessBased,"jpittsdirects",
ma);let Tb=this.MKf("GetCloudPolicySettings");return(new Promise((Kb,nb)=>{if(void 0!==this.EPb&&null!==this.EPb&&0<this.EPb.length){const Ka=this.Fvl();if(void 0!==Ka&&null!==Ka){Qa=!0;Kb(Ka);return}}(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",!1)?Promise.race([this.Vga.P2(this.WP("/afhs/CloudPolicySettings.ashx",!0),za,1,null,this.oAe,["CheckIn-Interval"],this.Ga.Ac("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ga.Ac("CloudPolicySettingsRequestSentTimeout",
3E4)),this.Vga.P2(this.WP("/afhs/CloudPolicySettings.ashx",!1),za,1,null,this.oAe,["CheckIn-Interval"],this.Ga.Ac("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ga.Ac("CloudPolicySettingsRequestSentTimeout",3E4))]):this.Vga.P2(this.WP("/afhs/CloudPolicySettings.ashx",this.Ga.getBooleanAppSetting("SuiteOriginForAFHSIsEnabled"),this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseOwlOriginForAFHS",!1)),za,1,null,this.oAe,["CheckIn-Interval"],this.Ga.Ac("CloudPolicySettingsRequestQueueTimeout",
15E3),this.Ga.Ac("CloudPolicySettingsRequestSentTimeout",3E4))).then(Ka=>{b.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.Ewl(Ka);Kb(Ka);return Ka},Ka=>{nb(Ka);return null})})).then(Kb=>{({yE:Tb,returnValue:Xa}=this.L6e(Tb));var nb=v.a.Bx();nb&&(nb.set("FromCache",Qa.toString()),nb.set("useCommonDomain",this.Ga.getBooleanAppSetting("SuiteOriginForAFHSIsEnabled").toString()),nb.set("useRace",this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseBothCommonAndAppDomainsForAFHS",
!1).toString()));nb=Object.assign({},{durationMs:Xa,extendedProperties:nb});k.Health.instance.recordKpiSuccess("GetCloudPolicySettings",nb);return Kb})}Zvl(){return da.loh().then(()=>{b.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}WP(ma,za,Qa=!1){ma=String.format("{0}{1}",Qa?"https://ffc-owl.officeapps.live.com":za?this.Ga.Ma("SuiteOrigin"):this.Ga.Ma("WebServiceBase"),
ma);this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddUserSessionIdForAFHS",!1)&&(ma+="?usid="+A.AFrameworkApplication.userSessionId);return ma}IZb(ma){return ma in this.Lnf?"0"!==this.Lnf[ma]:!0}Fvl(){try{const ma=La.a.instance.getItem(this.EPb);if(void 0===ma||null===ma)return b.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;b.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",
ma);const za=JSON.parse(ma);if(void 0===za||null===za)return b.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===za.ExpirationTime||null===za.ExpirationTime)return b.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(za.ExpirationTime)).getTime()<Date.now())return b.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),
null;const Qa=new J;Qa.PolicySettings=za.PolicySettings;Qa.ControllerConnectedServicesFeatureNames=new ba.a;this.Ga.Zt("ServicesControlsMicrosoftControllerServicesList")&&this.Ga.Fz("ServicesControlsMicrosoftControllerServicesList");for(const Xa of this.Zwd)Qa.ControllerConnectedServicesFeatureNames.add(Xa);b.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return Qa}catch(ma){return b.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",
ma.toString()),null}}Ewl(ma){try{if(void 0===ma||null===ma||void 0===ma.PolicySettings||null===ma.PolicySettings)b.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.Awd)b.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const za=new aa(ma,this.Awd),Qa=JSON.stringify(za);b.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",Qa);La.a.instance.setItem(this.EPb,
Qa);b.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(za){b.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",za.toString())}}ZIc(){const ma=U.ZIc(this.Ga);return ma&&0<ma.length?"OCPS"+ma:null}MKf(ma){const za=c.a.instance.Db("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==za&&null!==za?za.Xl("WebServiceCall",ma):null}L6e(ma){if(void 0!==ma&&null!==ma){const za=ma.ew;ma.stop();return{returnValue:za,
yE:null}}return{returnValue:null,yE:ma}}}Object(y.a)(Ca,"CloudPolicySettingsHelper",null,[117]);class Fa{constructor(){this.WQf=this.Nzh=this.nC=0;this.XQf=this.Ozh=this.m3a="";this.NGd=this.tva=2}clone(){const ma=new Fa;ma.nC=this.nC;ma.Nzh=this.Nzh;ma.WQf=this.WQf;ma.m3a=this.m3a;ma.Ozh=this.Ozh;ma.XQf=this.XQf;ma.tva=this.tva;ma.NGd=this.src;return ma}get src(){return this.NGd}serialize(ma=null){const za={};if(!ma||ma.contains(Fa.gab))za[Fa.gab]=this.nC;if(!ma||ma.contains(Fa.W$b))za[Fa.W$b]=this.m3a;
if(!ma||ma.contains(Fa.X$b))za[Fa.X$b]=this.tva;return JSON.stringify(za)}static create(ma,za=null){const Qa=new Fa;Qa.NGd=ma;void 0!==za&&null!==za&&(Fa.gab in za&&(Qa.nC=za[Fa.gab]),Fa.W$b in za&&(Qa.m3a=za[Fa.W$b]),Fa.X$b in za&&(Qa.tva=za[Fa.X$b]));return Qa}static deserialize(ma,za){try{const Qa=JSON.parse(ma);if(void 0!==Qa&&null!==Qa)return Fa.create(za,Qa);b.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",ma);throw Error.argument("settingsData");
}catch(Qa){throw b.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",Qa.toString()),Qa;}}}Fa.gab="CCS";Fa.W$b="CCSTime";Fa.X$b="OfficePrivacyRoamedNoticeShown";Object(y.a)(Fa,"UserPrivacySettings",null,[]);var ya=a(229);class Ua{constructor(ma,za){if(void 0===ma||null===ma||void 0===za||null===za)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ga=ma;this.Dn=za;this.pGd=this.je=null}WP(ma){var za=String.format("{0}RoamingServiceHandler.ashx?action=",
this.Ga.appSettings.RoamingServiceHandlerWebServiceBase||"");za=new Sys.StringBuilder(za);za.append(ma);za.append("&");za.append(A.AFrameworkApplication.Fh);return za.toString()}executeRequest(ma,za,Qa,Xa=null){return this.Dn.YLa(ma,za,Xa,null,!1,2,null,Qa,"33",!1,null,6E4)}saveSettings(ma){return new Promise((za,Qa)=>{try{if(void 0===this.je||null===this.je||void 0===ma||null===ma)b.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),Qa("Can't determine setting changes to save");
else{var Xa=this.je.nC!==ma.nC;if(2===this.je.src&&Xa)this.l5k(ma),za(!0);else{var Tb=this.x8k(ma);if(void 0===Tb||null===Tb||!Tb.length)b.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),Qa("No changes to save");else if(1===this.je.src)za(this.Bvh(Tb));else if(0===this.je.src){b.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Tb);const Kb=this.executeRequest(this.WP("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
Tb);Kb.continueWith(()=>{if(Kb.Nn||Kb.Om)b.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),za(!1);else{var nb=Kb.result;void 0!==nb.mj&&null!==nb.mj&&void 0!==nb.mj.data&&null!==nb.mj.data&&nb.mj.data.Je===u.a.KB?(b.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),za(!0)):(b.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),za(!1))}})}}}}catch(Kb){b.ULS.sendTraceTag(50860930,3004,
10,"SaveUserPrivacySettings: Exception = {0}",Kb.toString()),za(!1)}})}x8k(ma){if(void 0===this.je||null===this.je||void 0===ma||null===ma)throw Error.invalidOperation("User Privacy settings have not been initialized");const za=new ba.a;0===ma.src?(this.je.nC!==ma.nC&&(za.add(Fa.gab),za.add(Fa.W$b)),this.je.tva!==ma.tva&&za.add(Fa.X$b)):1===ma.src&&this.je.nC!==ma.nC&&za.add(Fa.gab);return za.count?ma.serialize(za):(b.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),
null)}getSettings(){if(!this.pGd){const ma=this;this.pGd=new Promise(za=>{try{ma.je?za(ma.je.clone()):ma.Qvl().then(Qa=>{ma.je=Qa;za(ma.je.clone());return null},()=>{ma.Ovl().then(Qa=>{ma.je=Qa;za(ma.je.clone());return null},()=>{ma.Pvl().then(Qa=>{ma.je=Qa;za(ma.je.clone());return null},()=>{b.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");ma.je=new Fa;za(ma.je.clone());return null});return null});return null})}catch(Qa){b.ULS.sendTraceTag(50860932,
3004,10,"UserPrivacySettings GetSettings: Exception = {0}",Qa.toString()),ma.je=new Fa,za(ma.je.clone())}})}return this.pGd}Qvl(){return new Promise((ma,za)=>{try{const Xa=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ga.getBooleanAppSetting("PrivacyDialogShouldCheckRoaming")||Xa){var Qa=this.executeRequest(this.WP("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");Qa.continueWith(()=>{try{if(Qa.Nn||Qa.Om)b.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");
else{const Tb=Qa.result;if(Tb&&Tb.mj&&Tb.mj.data)if(Tb.mj.data.Je!==u.a.KB)b.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Tb.mj.data.Je);else{if(Tb.mj.data.responseData){ma(Ua.parse(Tb.mj.data.responseData,0));b.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Tb.mj.data.responseData);return}b.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else b.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");za("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Tb){b.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Tb.toString()),za("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else b.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),za("Roaming should not be used")}catch(Xa){b.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",Xa.toString()),za("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}Ovl(){return new Promise((ma,za)=>{try{const Qa=ya.a.get("WacUPToggleState");let Xa=null;void 0!==Qa&&null!==Qa&&0<Qa.length&&(Xa=decodeURIComponent(Qa));if(void 0!==Xa&&null!==Xa&&0<Xa.length){const Tb=Ua.parse(Xa,1);b.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Tb.toString());ma(Tb)}else{const Tb=Fa.create(1),
Kb=new ba.a;Kb.add(Fa.gab);const nb=Tb.serialize(Kb);this.Bvh(nb)?(b.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",nb),ma(Tb)):(b.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",nb),za("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(Qa){b.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
Qa.toString()),za("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}Pvl(){return new Promise(ma=>{try{var za=-1!==window.location.href.indexOf("&wdccsoff=1");const Qa=Fa.create(2);za?(Qa.nC=2,A.AFrameworkApplication.CPf(),b.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",Qa.toString())):(Qa.nC=1,b.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",Qa.toString()));ma(Qa)}catch(Qa){b.ULS.sendTraceTag(50967431,
3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",Qa.toString()),za=Fa.create(2),za.nC=1,ma(za)}})}l5k(ma){b.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===ma.nC?A.AFrameworkApplication.CPf():A.AFrameworkApplication.x2i();b.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",ma)}Bvh(ma){try{b.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",ma);const za=
this.Ga.Ma("PrivacyCookieDomain")||"";if(!za||!za.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");b.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",ma);return ya.a.blh("WacUPToggleState",ma,ya.a.BU,"/",za)}catch(za){return b.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",za.toString()),!1}}isFeatureEnabled(ma){return this.getSettings().then(za=>{const Qa=this.Ga.Zt("ServicesControlsMicrosoftControllerServicesList")?
this.Ga.Fz("ServicesControlsMicrosoftControllerServicesList"):[],Xa=new E.a;for(let Tb=0;Tb<Qa.length;Tb++)Xa.add(Qa[Tb]);return Xa.contains(ma)?2!==za.nC:!0},()=>{b.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",ma);return!0})}static parse(ma,za){try{return b.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",ma,za),Fa.deserialize(ma,za)}catch(Qa){throw b.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",Qa.toString()),
Qa;}}}Object(y.a)(Ua,"UserPrivacySettingsHelper",null,[118]);var Ia=a(95);class Oa{constructor(){this.Oa=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}oc(ma){this.Oa=ma;this.Oa.register(117,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").oa().pa(()=>new Ca(A.AFrameworkApplication.ha,A.AFrameworkApplication.$d));this.Oa.register(118,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").oa().pa(()=>new Ua(A.AFrameworkApplication.ha,
A.AFrameworkApplication.$d));this.Oa.register(119,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").oa().pa(()=>new H(A.AFrameworkApplication.ha,A.AFrameworkApplication.$d));this.Oa.register(120,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").oa().pa(()=>new U(A.AFrameworkApplication.ha,A.AFrameworkApplication.$d,c.a.instance.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),c.a.instance.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
A.AFrameworkApplication.ub))}init(){A.AFrameworkApplication.ha.Wf(()=>{const ma=c.a.instance.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");A.AFrameworkApplication.ha.getBooleanAppSetting("LicensingIsEnabled")&&(ma.isFeatureEnabled("LicensingTestFeature",!1).then(za=>{b.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",za,A.AFrameworkApplication.ha.Ma("IsAnonymousUser"));
return null}),ma.getFeatureTier("LicensingTestFeature",0).then(za=>{b.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",za,A.AFrameworkApplication.ha.Ma("IsAnonymousUser"));return null}));c.a.instance.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.brl()})}dispose(){}brl(){try{A.AFrameworkApplication.ha.getBooleanAppSetting("SideCarIsEnabled")&&da.loh().then(ma=>{b.ULS.sendTraceTag(594057429,
3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",ma);return ma})}catch(ma){}}static main(){Ia.a.instance.Jc(new Oa)}}Object(y.a)(Oa,"ApplicationFeatureHelperPackage",null,[4,5])},1415:function(y,C,a){a.d(C,"a",function(){return k});y=a(0);var c=a(1703),b=a(6),d=a(103),e=a(57),h=a(40),n=a(1128),m=a(123);class k{constructor(l,u,r,x,v,z){this.vEd=this.VSc=null;this.WO=Object(c.a)(n.a,x.CUi(l,u,r,Object(b.a)(this,this.i0,"onPointerOver"),Object(b.a)(this,this.h0,"onPointerOut"),
v));this.eXc=0;this.ud=z;this.ud.GF(Object(b.a)(this,this.UJ,"onSessionEnd"));this.clear()}dispose(){this.WO.dispose();this.VSc=null}get qKb(){return this.vEd}setZIndex(l){this.WO.setZIndex(l)}qPl(l,u,r){this.vEd=l;this.VSc=u;this.WO.JZh("UnreadNotification_16x16x32",this.qKb,r)}clear(){this.WO.clear();this.vEd=m.a.none}wJe(){this.d0b();this.WO.tJd(this.qKb,this.jQf);this.WO.OUg()}d0b(){this.WO.IUe();this.WO.Y4e()}UJ(){h.a.$(39068559,804,15,"Canvas shape highlights pawn hovered count: {0};",this.eXc);
0<this.eXc&&d.c(e.a.tHh)}get jQf(){return this.VSc?this.VSc():""}i0(){this.wJe();h.a.$(23606147,804,50,"Shape revision tracking pawn hovered");this.eXc+=1;return!0}h0(){this.d0b();return!0}}Object(y.a)(k,"ShapeRevisionTrackingPawn",null,[526])},1417:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(b){this.smk=b}get Roc(){return this.smk}}Object(y.a)(c,"ShowHideNotesData",null,[])},1423:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.Id=null;
this.Enabled=!1;this.DisplayName=this.Name=null;this.Order=0;this.Tooltip=null;this.IsEndpointProtectionEnabled=!1;this.ParentId=null;this.RequiredDowngradeJustification=!1;this.Color=this.AutoLabelingSensitiveTypeIds=this.LabelActions=null;this.HasUserDefinedPermissions=!1;this.DefaultSublabelId=null;this.UDPVerifyUserPermissionConfigurable=this.UDPVerifyUserPermissionDefaultState=this.UDPRequestPermissionsConfigurable=this.UDPRequestPermissionsDefaultState=this.UDPAccessProgrammaticConfigurable=
this.UDPAccessProgrammaticDefaultState=this.UDPDocumentExpirationConfigurable=this.UDPDocumentExpirationDefaultState=!1;this.HasExtractForUser=!0;this.ParentName="";this.AppliesDynamicWatermarking=!1;this.Id=this.DynamicWatermarkResolvedString=this.DynamicWatermarkFormatString="";this.Enabled=!1;this.DisplayName=this.Name="";this.Order=0;this.Tooltip="";this.IsEndpointProtectionEnabled=!1;this.ParentId="";this.RequiredDowngradeJustification=!1;this.LabelActions=[];this.AutoLabelingSensitiveTypeIds=
[];this.Color="";this.HasUserDefinedPermissions=!1;this.DefaultSublabelId="";this.UDPVerifyUserPermissionConfigurable=this.UDPVerifyUserPermissionDefaultState=this.UDPRequestPermissionsConfigurable=this.UDPRequestPermissionsDefaultState=this.UDPAccessProgrammaticConfigurable=this.UDPAccessProgrammaticDefaultState=this.UDPDocumentExpirationConfigurable=this.UDPDocumentExpirationDefaultState=!1;this.HasExtractForUser=!0;this.ParentName="";this.AppliesDynamicWatermarking=!1;this.DynamicWatermarkResolvedString=
this.DynamicWatermarkFormatString=""}}Object(y.a)(c,"SensitivityLabel",null,[])},1570:function(y,C,a){a.d(C,"a",function(){return r});y=a(0);var c=a(41),b=a(132),d=a(99),e=a(6),h=a(15),n=a(107),m=a(40),k=a(258);class l{constructor(){this.TenantId=this.LoggableUserId=this.FileSource=this.ProviderId=this.UserId=this.UserName=null;this.EnableMacrosForProtectedFile=this.BrowserCacheAllowed=!1;this.ComplianceDomainPrefix=this.ServerDocId=null;this.IsCLPCoauthoringEnabled=this.IsO365CommercialHost=this.IsO365ConsumerHost=
!1}}Object(y.a)(l,"PodsInfo",null,[]);var u=a(90);class r{constructor(x,v,z,A,B,G,w){m.a.$(512262873,804,50,"Start PodsInfoSender::PodsInfoSender()");this.Jb=w;this.Iq=x;this.pb=v;this.ud=z;this.pT=A;this.le=B;this.Yb=G;this.S_e=!1;this.hpd=0;this.Jb.Wf(Object(e.a)(this,this.initialize,"initialize"))}initialize(){m.a.$(512262872,804,50,"Start PodsInfoSender::Initialize()");this.sendInfoToPods(null);this.ud.eI(Object(e.a)(this,this.qr,"onSessionRehydrated"));this.pT.Qjc(Object(e.a)(this,this.Hhb,"onPodSessionRefreshed"));
this.S_e=!0}dispose(){this.S_e&&(this.ud.Tna(Object(e.a)(this,this.qr,"onSessionRehydrated")),this.pT.G7c(Object(e.a)(this,this.Hhb,"onPodSessionRefreshed")),this.S_e=!1)}sendInfoToPods(){var x=this.Jb.Ma(u.a.ym),v=this.pb.podSessionId;const z=this.pb.Hp,A=c.AFrameworkApplication.userSessionId,B=b.a.create().toString();m.a.$(512262871,804,50,"PodsInfoSender.SendInfoToPods: Send user info to Pods, correlation={0}",B);x=String.format("{0}PodHandler.ashx?action=SendUserInfo&PodSID={1}",x,v);v={"Content-Type":"application/json; charset=utf-8",
WaitForSessionTimeoutMs:"0"};v["X-UserSessionId"]=A;v["X-CorrelationID"]=B;v["X-WacCluster"]=z;try{const G=Object.assign(new l,{UserName:this.Jb.Ma(n.a.$om),UserId:this.Jb.Ma(u.a.ZTa),ProviderId:this.Jb.Ma(u.a.dcc),FileSource:this.Jb.Ma("FileSource"),LoggableUserId:this.Jb.Ma("LoggableUserId"),TenantId:this.Jb.Ma("TenantId"),BrowserCacheAllowed:this.Jb.getBooleanAppSetting(u.a.Y2e),EnableMacrosForProtectedFile:c.AFrameworkApplication.oXb,ServerDocId:this.Jb.Ma("ServerDocId"),ComplianceDomainPrefix:c.AFrameworkApplication.ha.Ma("ComplianceDomainPrefix"),
IsO365CommercialHost:this.Jb.getBooleanAppSetting("IsO365CommercialHost"),IsO365ConsumerHost:this.Jb.getBooleanAppSetting("IsO365ConsumerHost"),IsCLPCoauthoringEnabled:this.Jb.getBooleanAppSetting("PPTClpSwitchEnabled")&&this.Jb.getBooleanAppSetting("SupportsOfficeClientCoauthoring")}),w=h.c(G);this.Iq.ik(x,2,w,v,!1,1,Object(e.a)(this,this.XTn,"onSendUserInfoSucceeded"),Object(e.a)(this,this.WTn,"onSendUserInfoFailed"),null,void 0,void 0,void 0,void 0,k.a("6"))}catch(G){m.a.$(512262870,804,15,"PodsInfoSender.SendInfoToPods: error serializing user info {0}",
G)}}XTn(){m.a.$(512262869,804,50,"PodsInfoSender.OnSendUserInfoSucceeded");this.hpd=0}WTn(){m.a.$(512262868,804,50,"PodsInfoSender.OnSendUserInfoFailed");3>this.hpd?this.F8n():this.znn()}F8n(){this.hpd++;m.a.$(512262867,804,50,"PodsInfoSender.RetryRequestOnFailure: Request failed - retrying (failures count: {0})",this.hpd);const x=new d.a(1,1,5E3,Object(e.a)(this,this.sendInfoToPods,"sendInfoToPods"),90,"22");this.Yb.Rb(x)}znn(){m.a.$(512262866,804,15,"PodsInfoSender.GiveUp: Request failed - giving up (failures count: {0})",
this.hpd);this.le.nM(307,null);this.hpd=0}qr(){this.hpd=0;m.a.$(512262865,804,50,"PodsInfoSender.OnSessionRehydrated");this.sendInfoToPods(null)}Hhb(){this.hpd=0;m.a.$(512262864,804,50,"PodsInfoSender.OnPodSessionRefreshed");this.sendInfoToPods(null)}}Object(y.a)(r,"PodsInfoSender",null,[])},1586:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);var c;(function(b){b[b.isEnabled=1]="isEnabled";b[b.execute=2]="execute";b[b.animation=3]="animation"})(c||(c={}));Object(y.b)("ActionBehavior",c)},
1587:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);var c;(function(b){b.None="None";b.PBh="ButtonModel";b.rGl="CheckboxModel";b.tGl="ColorPickerModel";b.SBh="ComboBoxModel";b.uGl="CompoundButtonModel";b.VGl="ErrorViewModel";b.e4h="GalleryModel";b.YGl="FileMenu";b.ZBh="FlyoutAnchorModel";b.gHl="IconGalleryButtonModel";b.hHl="InkButtonModel";b.iHl="InkFlyoutAnchorModel";b.lHl="InsertTableModel";b.kHl="InputBoxModel";b.oHl="LabelModel";b.AHl="PageNumberGalleryButtonModel";b.pHl="ListGalleryButtonModel";
b.oGl="CharacterCodeGalleryButtonModel";b.bHl="FontStyleGalleryButtonModel";b.jHl="InkThicknessGalleryButtonModel";b.WHl="TableStyleGalleryButtonModel";b.nGl="ChangeColorsGalleryButtonModel";b.CHl="PeopleWell";b.i5h="PreviewGalleryModel";b.NHl="SliderModel";b.ejc="SpinButtonModel";b.OHl="SplitButtonModel";b.TellMe="TellMe";b.ZHl="ToggleButtonModel";b.PHl="StatefulSplitButtonModel";b.BGl="DocumentTitleModel";b.qHl="MRUCompoundButtonModel";b.xHl="NewBlankDocumentModel";b.xGl="CustomTemplateModel";b.sGl=
"CoauthorGallery";b.THl="SyncStatus";b.DHl="PersonaButtonModel";b.aHl="FontPickerModel";b.wHl="MultiActionButtonModel";b.MHl="SearchBoxModel"})(c||(c={}));Object(y.b)("ModelType",c)},1607:function(y,C,a){a.d(C,"a",function(){return b});var c=a(50);const b=()=>c.a.instance.Db("Common.ISessionStatus")},1608:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.handler=null}}Object(y.a)(c,"SetAnnotationResultCallbackParameters",null,[])},1643:function(y,C,a){a.d(C,"a",function(){return b});
y=a(0);var c;(function(d){d[d.Sjm=0]="multipleBrowsersImageClassName";d[d.xpm=1]="peopleImageClassName";d[d.ypm=4]="peopleImageClusterPath";d[d.Rjm=5]="multipleBrowserImageClusterPath";d[d.mYa=6]="imageDimension";d[d.rtl=8]="rtl";d[d.uKb=9]="pointerInputManager";d[d.zXa=10]="clickInputManager";d[d.vertical=11]="vertical";d[d.zIndex=12]="zIndex";d[d.yjd=13]="contextMenuInputManager";d[d.b8l=14]="imageDomElement";d[d.QEm=15]="useIdleTooltip";d[d.dFm=16]="viewportBoundsCallback";d[d.S0l=17]="flipHorizontalDirection";
d[d.P0l=18]="fixRemoveFadeOutElementCrash";d[d.$7l=19]="ignoreEventOnExpandedTooltip";d[d.Z8l=20]="ipWidthAdjustForFlyout"})(c||(c={}));Object(y.b)("PresenceTooltipSettingKeys",c);class b{constructor(){this.fR={}}get(d,e=null){d=c[d];return"number"===typeof e?(e=this.fR[d])?Number.parseInvariant(e.toString()):0:this.fR[d]}add(d,e){this.fR[c[d]]=e}bfa(d,e){c[d]in this.fR||(this.fR[c[d]]=e)}remove(d){delete this.fR[c[d]]}}Object(y.a)(b,"PresenceTooltipSettings",null,[])},1645:function(y,C,a){a.d(C,
"a",function(){return b});y=a(0);class c{constructor(d,e,h){this.cKh=d;this.HDm=e;this.LDl=h}}Object(y.a)(c,"ThemeData",null,[]);class b{}b.bpc=[new c("2e142a2c-cd16-42d6-873a-c26d2a0506fa","OfficeTheme2023",4),new c("62f939b6-93af-4db8-9c6b-d6c7dfdc589f","OfficeTheme",4),new c("b8441adb-2e43-4af7-b97a-bd870242c6a8","Ion",4),new c("28cdc826-8792-45c0-861b-85eb3adeda33","Organic",4),new c("f226e7a2-7162-461c-9490-d27d9dc04e43","Frame",4),new c("fc33163d-4339-46b1-8eed-24c834239d99","IonBoardroom",
4),new c("789ec3fe-34fd-429c-9918-760025e6c145","Mesh",4),new c("5f128b03-dcca-4eeb-ab3b-cf2899314a46","Retrospect",8),new c("0507925b-6ac9-4358-8e18-c330545d08f8","Slice",4),new c("1306e473-ed32-493b-a2d0-240a757edd34","Savon",4),new c("98dff888-2449-4d28-977c-6306c017633e","Banded",4),new c("39ec5628-30ed-4578-acd8-9820edb8e15a","Quotable",4),new c("7acabc62-bf99-48cf-a9dc-4db89c7b13dc","WoodType",4),new c("5665723a-49ba-4b57-8411-a56f8f207965","Basis",4),new c("3577f8c9-a904-41d8-97d2-fd898f53f20e",
"Integral",8),new c("7cb32d59-10c0-40dd-b7bd-2e94284a981c","Wisp",4),new c("9697a71b-4ab7-4a1a-bd5b-bb2d22835b57","Dividend",4),new c("c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5","Celestial",4),new c("3388167b-a2eb-4685-9635-1831d9aef8c4","Parallax",4),new c("4c5440d6-04d2-4954-96cf-f251137069b2","Metropolitan",8),new c("c0c680cd-088a-49fc-a102-d699147f32b2","Facet",4),new c("ba0eb5a6-f2d4-4f82-977b-64adee4a2a69","View",4),new c("5156b0e4-0eb1-49fe-a26b-15f6f698aec6","Atlas",4),new c("025cb5fb-2dd3-45ee-b6f0-cc461540eb19",
"Madison",4)];Object(y.a)(b,"DesignManager_data",null,[])},1767:function(y,C,a){(function(c){a.d(C,"a",function(){return r});var b=a(81),d=a(0),e=a(44),h=a(52),n=a(40),m=a(1744),k=a(1745),l=a(42),u=a(75);class r{constructor(x,v,z,A,B,G,w,F,H,E,P){this.vhb=this.uU=null;this.GDe=(T,K,M,N,I)=>{this.actionId=T;this.uU=this.sa.Uo();return this.t_h(!0)?1===M?32:I?2===M&&(this.kqg.sLb(!0,!1),T={},n.a.$(508908313,m.a.E$b,k.a.info,"PictureBackgroundActor::removePictureBackground triggered."),this.k$m(T),this.Aon(this.uU,
T))?(this.RMh(),32):16:16:(this.RMh(),8)};this.$Ee=(T,K,M,N,I)=>{const O=this.sa.Uo();if(!this.t_h(!1))return this.RMh(),8;if(1===M)return 32;if(!I)return 16;n.a.$(508703427,m.a.E$b,k.a.info,"PictureBackgroundActor::restorePictureBackground triggered.");this.kqg.sLb(!0,!1);this.vhb=this.ya.Ia;K=this.Tb.Kd(15,void 0,()=>{this.sa.Rx();this.sa.nj();this.Na.ee()},()=>{this.rw.MJ=O;this.sa.selectShape(O,!0)});try{this.uU=O,K.tc(this.vhb),K.wc=T,this.uU.hJb=!1,this.RMh()}finally{K&&K.dispose(),this.kqg.sLb(!1,
!1)}return 32};if(!x)throw Error.argumentNull("actionManager");if(!v)throw Error.argumentNull("appOfflineSetter");if(!z)throw Error.argumentNull("selectionManager");if(!A)throw Error.argumentNull("imageManager");this.la=x;this.kqg=v;this.sa=z;this.xM=A;this.zb=B;this.ya=G;this.Tb=F;this.Na=w;this.rw=H;this.Htn=E;this.PJ=P}Kb(){this.la.ua(e.a.GDe,h.a.application,this.GDe,4);this.la.ua(e.a.$Ee,h.a.application,this.$Ee,4)}Ae(){}Aon(x,v){return(x=this.Qk(x))&&x.Ci&&(x=x.Ci)?x.t9("RemoveBackgroundAction",
v):!1}Qk(x){return x?x.yc(this.zb.Ua):null}k$m(x){x.type="RemoveBackgroundPayload";x.useMask=!0;x.downsample=!0;var v=this.j0l(this.ya.Ia,this.uU,13,-1),z=500,A=500;v&&v.Base64Data&&(A=this.j0l(this.ya.Ia,this.uU,1,this.uU.$g),z=new URL(v.Base64Data),x.originalUrl=z,z=A?A.Height:v.Height,A=A?A.Width:v.Width);v={};z=new URL(`data:image/svg+xml;base64, ${c.from(this.n4f(z,A)).toString("base64")}`,window.location.origin);v.url=z;v.renderAsSvg=!0;v.overlay=!0;v.cropToGeometry=!0;x.placeholder=v;x.resultHandler=
this.x1n.bind(this);x.updatePicture=l.a("FixForBGRPlaceholderRemovalOnError")}n4f(x,v){x=this.pbc(`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    preserveAspectRatio="xMidYMid meet" style="width:100%;" viewBox="0 0 ${v} ${x}">
    <defs>
      <animateTransform repeatCount="indefinite" dur="1.3666667s" begin="0s" xlink:href="#_R_G_L_0_G_L_1_G_N_2_T_0"
      fill="freeze" attributeName="transform" from="54" to="414" type="rotate" additive="sum" keyTimes="0;0.9756098;1"
       values="54;414;414" keySplines="0.33 0 0.1 1;0 0 0 0" calcMode="spline" />
      <animateTransform repeatCount="indefinite" dur="1.3666667s" begin="0s" xlink:href="#_R_G_L_0_G_L_0_G_N_2_T_0"
      fill="freeze" attributeName="transform" from="54" to="414" type="rotate" additive="sum" keyTimes="0;0.9756098;1"
      values="54;414;414" keySplines="0.33 0 0.1 1;0 0 0 0" calcMode="spline" />
      <animate attributeType="XML" attributeName="opacity" dur="1s" from="0" to="1" xlink:href="#time_group" />
    </defs>
    <g id="_R_G">
      <rect width="100%" height="100%" fill="rgba(179,179,179,0.5)" filter='blur(12px)' />
      <g id="_R_G_L_1_G" transform=" translate(${v/2}, ${x/2})
     translate(0, 0)" />
      <g id="_R_G_L_0_G" transform=" translate(${v/2}, ${x/2})
     translate(-14, -14)">
        <g id="_R_G_L_0_G_L_1_G_N_2_T_0" transform=" translate(14, 14) scale(2, 2)">
          <g id="_R_G_L_0_G_L_1_G">
            <path id="_R_G_L_0_G_L_1_G_D_0_P_0" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round"
             fill="none" stroke-width="3" stroke-opacity="1"
             d=" M0 -12 C6.62,-12 12,-6.62 12,0 C12,6.62 6.62,12 0,12 C-6.62,
             12 -12,6.62 -12,0 C-12,-6.62 -6.62,-12 0,-12z " />
          </g>
        </g>
        <g id="_R_G_L_0_G_L_0_G_N_2_T_0" transform=" translate(14, 14)">
          <g id="_R_G_L_0_G_L_0_G" transform=" rotate(3.724)
      scale(0.2, 0.2)">
            <path id="_R_G_L_0_G_L_0_G_D_0_P_0" fill="#C43E1C" fill-opacity="1" fill-rule="nonzero"
            d=" M-40.12 -128.87 C-40.12,-128.87 -47.25,-127.25 -55.5,-123 C-63.75,-118.75 -71.87,
            -114.75 -79.75,-108.62 C-87.62,-102.5 -92.37,-100.25 -99,-92.5 C-105.62,-84.75 -110.5,
            -79 -114.87,-71.75 C-119.25,-64.5 -124.75,-53.62 -127.12,-46.75 C-129.5,-39.87 -133.14,
            -27.1 -133.87,-20.37 C-134.87,-11.25 -135,-5.37 -135,1.5 C-135,8.38 -134.87,12 -134.5,
            16.5 C-134.12,21 -132.75,24.88 -132.75,24.88 C-132.75,24.88 -103.5,17.63 -103.5,
            17.63 C-103.5,17.63 -104.87,6 -104.87,-0.37 C-104.87,-6.75 -104.12,-14.37 -103.12,
            -20.37 C-102.12,-26.37 -100.37,-31.12 -98,-37.12 C-95.62,-43.12 -93.12,-49.37 -89.62,
            -55 C-86.12,-60.62 -83.12,-64.62 -78.5,-69.37 C-73.87,-74.12 -67.75,-80.12 -63.5,
            -83.37 C-59.25,-86.62 -51.25,-91.87 -46,-94.25 C-40.75,-96.62 -33.62,-99.12 -33.62,
            -99.12 C-33.62,-99.12 -40.12,-128.87 -40.12,-128.87z " />
            <path id="_R_G_L_0_G_L_0_G_D_1_P_0" stroke="#C43E1C" stroke-linecap="round" stroke-linejoin="round"
             fill="none" stroke-width="1" stroke-opacity="1" d=" M-40.12 -128.87 C-40.12,-128.87 -47.25,
             -127.25 -55.5,-123 C-63.75,-118.75 -71.87,-114.75 -79.75,-108.62 C-87.62,-102.5 -92.37,
             -100.25 -99,-92.5 C-105.62,-84.75 -110.5,-79 -114.87,-71.75 C-119.25,-64.5 -124.75,-53.62 -127.12,
             -46.75 C-129.5,-39.87 -133.14,-27.1 -133.87,-20.37 C-134.87,-11.25 -135,-5.37 -135,1.5 C-135,
             8.38 -134.87,12 -134.5,16.5 C-134.12,21 -132.75,24.88 -132.75,24.88 C-132.75,24.88 -103.5,17.63 -103.5,
             17.63 C-103.5,17.63 -104.87,6 -104.87,-0.37 C-104.87,-6.75 -104.12,-14.37 -103.12,-20.37 C-102.12,
             -26.37 -100.37,-31.12 -98,-37.12 C-95.62,-43.12 -93.12,-49.37 -89.62,-55 C-86.12,-60.62 -83.12,
             -64.62 -78.5,-69.37 C-73.87,-74.12 -67.75,-80.12 -63.5,-83.37 C-59.25,-86.62 -51.25,-91.87 -46,
             -94.25 C-40.75,-96.62 -33.62,-99.12 -33.62,-99.12 C-33.62,-99.12 -40.12,-128.87 -40.12,-128.87z " />
          </g>
        </g>
      </g>
    </g>
    <g id="time_group" />
  </svg>`);return this.wfc(x)}pbc(x){x=(new DOMParser).parseFromString(x,"image/svg+xml");if(0!==x.querySelectorAll("parsererror").length)throw Error("The XML could not be read");return x.firstElementChild}wfc(x){return(new XMLSerializer).serializeToString(x)}x1n(x){var v,z,A,B;return Object(b.b)(this,void 0,void 0,function*(){const G=null!==(z=null===(v=x.opExecutionTimeInMs)||void 0===v?void 0:v.toFixed(2))&&void 0!==z?z:"";x.succeeded?(n.a.$(508921416,m.a.E$b,k.a.info,`PictureBackgroundActor::processBackgroundRemovalResults Success. ExecutionTime: ${G} ms.`),
this.fYm=x.result.picture.url,yield this.$pn(this.actionId,this.fYm)):(this.kqg.sLb(!1,!1),this.qeo(),n.a.$(508921415,m.a.E$b,k.a.error,`PictureBackgroundActor::processBackgroundRemovalResults Failed. Status: ${null!==(B=null===(A=x.error)||void 0===A?void 0:A.message)&&void 0!==B?B:"unknown"}, ExecutionTime: ${G} ms.`))})}$pn(x,v){return Object(b.b)(this,void 0,void 0,function*(){this.vhb=this.ya.Ia;const z=this.Tb.Kd(15,void 0,()=>{this.sa.Rx();this.sa.nj();this.Na.ee()},()=>{this.rw.MJ=this.uU;
this.sa.selectShape(this.uU,!0)});try{z.tc(this.vhb),z.wc=x,l.a("PPTOImgSrcBgrAttr")?this.uU.lna=v.href:this.uU.Glc=v.href,this.uU.hJb=!0}finally{z&&z.dispose(),this.kqg.sLb(!1,!1)}})}RMh(){if(l.a("RemoveBgButtonExperienceImprovement"))if(u.c()){var x=this.t_h(!0),v=this.t_h(!1);x=[appChrome.actions.updateControlHiddenState("RestorePictureBackground",!v),appChrome.actions.updateControlHiddenState("RemovePictureBackground",v),appChrome.actions.updateControlEnabledDisabledState("RemovePictureBackground",
!x),appChrome.actions.updateControlEnabledDisabledState("RestorePictureBackground",!v)];appChrome.api.dispatch(x)}else n.a.$(508060246,m.a.E$b,k.a.info,"HandleToggleRemoveBackgroundBehavior: appChrome not defined")}t_h(x){var v,z,A;const B=this.sa.zd();return B?1==B.length&&(null===(v=B[0])||void 0===v?void 0:v.Pg)&&(null===(z=B[0])||void 0===z?void 0:z.pZe)&&(null===(A=B[0])||void 0===A?void 0:A.hJb)!==x:!1}j0l(x,v,z,A){const B=x?x.fc:null;v=v.get_shapeId();x=this.Htn.Qld(B,v,z,x.To,x.xk,A);n.a.$(508908312,
m.a.E$b,k.a.info,"PictureBackgroundActor::fetchImageData fetching image data.");({data:x}=this.xM.ymd.roc(x));if(x)return x;n.a.$(508923986,m.a.E$b,k.a.error,"PictureBackgroundActor::fetchImageData image data cannot be fetched for image id")}qeo(){this.PJ.AY(ResourceStrings.l_UnexpectedBEHTitle,ResourceStrings.l_GenericErrorMessage,!1,null,!1,null,0,0,null,null,!0,r.VMd,!1,null)}}r.VMd=20;Object(d.a)(r,"PictureBackgroundActor",null,[502])}).call(this,a(796).Buffer)},1830:function(y,C,a){a.d(C,"a",
function(){return B});y=a(0);var c=a(1703),b=a(419),d=a(420),e=a(6),h=a(88),n=a(111);class m extends b.a{constructor(G,w){super(G);this.Wm=null;this.mpa=w.get(8,!1);this.kKa=w.get(6,0);this.element=G;this.element.className=m.EWd;this.$Hd=this.createElement("ul");this.element.appendChild(this.$Hd);this.ov=w.get(10);this.ov.Ub(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.xJ=w.get(9);this.xJ.Ub(h.a.IQ,this.element,Object(e.a)(this,this.h0,"onPointerOut"));this.xJ.Ub(h.a.aH,this.element,
Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior"));this.aya=w.get(13);this.aya.Ub(this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior"))}jXa(G){this.addHandler(d.a.JJ,G)}Ebb(G){this.removeHandler(d.a.JJ,G)}get users(){return this.Wm}dispose(){this.element&&(this.ov.hc(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.xJ.hc(h.a.aH,this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")),this.xJ.hc(h.a.IQ,this.element,
Object(e.a)(this,this.h0,"onPointerOut")),this.aya.hc(this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(G,w,F){this.hide();!G||0>=G.length||(this.mpa?this.element.style.right=w+"px":this.element.style.left=w+"px",this.element.style.top=F+"px",this.msi(G),this.visible=!0)}msi(G){this.Wm=G;n.a.Ow(this.$Hd);for(let w=G.length-1;0<=w;w--)this.z2(G[w])}z2(G){const w=document.createElement("li");w.style.backgroundColor=G.color;
w.style.height=this.kKa+"px";w.id="fly_"+G.clientId;w.style.lineHeight=this.kKa+"px";n.a.CB(w,G.userName);w.setAttribute("dir","auto");this.$Hd.appendChild(w)}onClick(){this.hide();return!1}h0(G){this.raiseEvent(d.a.JJ,new d.a(3,G));return!1}}m.EWd="prFlyout UIFont";Object(y.a)(m,"PresenceTooltipFlyoutControl",b.a,[]);var k=a(109);class l extends b.a{constructor(G,w,F){super(G);this.uya=null;this.Wm=[];this.element.className="prGlyph";this.je=w;this.ylb=this.je.get(9);this.pv=this.je.get(10);this.aya=
this.je.get(13);this.vFj();this.z2(F);this.VAd=!1}get $Ea(){return this.Wm.length}get users(){return this.Wm}jXa(G){this.addHandler(d.a.JJ,G)}Ebb(G){this.removeHandler(d.a.JJ,G)}dispose(){this.Exl();super.dispose()}z2(G){Array.add(this.Wm,G);2===this.$Ea?this.hGb(!0):1===this.$Ea?this.hGb(!1):this.hGb(this.VAd)}rua(G){this.u8i(G)&&(1<this.$Ea&&this.hGb(!0),1===this.$Ea?this.hGb(!1):1>this.$Ea&&this.hide())}show(){this.hGb(2<=this.$Ea);this.visible=!0}hide(){this.visible=!1}Bjj(G){return G?this.t_f(0,
5):this.t_f(1,4)}u8i(G){for(let w=0;w<this.$Ea;w++)if(this.Wm[w].clientId===G)return G=this.Wm[w],Array.removeAt(this.Wm,w),G;return null}hGb(G){this.VAd!==G&&(this.uya&&this.element.removeChild(this.uya),this.uya=this.Bjj(G),this.element.appendChild(this.uya),this.VAd=G);this.uya.childNodes[0].style.backgroundColor=this.Wm[this.Wm.length-1].color}t_f(G,w){const F=this.je.get(6,0),H=this.je.get(14);return k.c(F,F,this.je.get(G),this.je.get(w),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,
H?H.cloneNode(!0):null)}i0(G){3!==G.Dg&&this.raiseEvent(d.a.JJ,new d.a(2,G));return!1}onClick(G){this.raiseEvent(d.a.JJ,new d.a(1,G));return!0}h0(G){3!==G.Dg&&this.raiseEvent(d.a.JJ,new d.a(3,G));return!1}Exl(){this.element&&(this.ylb.hc(h.a.aH,this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")),this.ylb.hc(h.a.ZO,this.element,Object(e.a)(this,this.i0,"onPointerOver")),this.ylb.hc(h.a.IQ,this.element,Object(e.a)(this,this.h0,"onPointerOut")),this.pv.hc(h.a.doubleClick,
this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")),this.pv.hc(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.aya.hc(this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")))}vFj(){this.element&&(this.ylb.Ub(h.a.aH,this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")),this.ylb.Ub(h.a.ZO,this.element,Object(e.a)(this,this.i0,"onPointerOver")),this.ylb.Ub(h.a.IQ,this.element,Object(e.a)(this,
this.h0,"onPointerOut")),this.pv.Ub(h.a.doubleClick,this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")),this.pv.Ub(h.a.click,this.element,Object(e.a)(this,this.onClick,"onClick")),this.aya.Ub(this.element,Object(e.a)(this,this.G1,"stopPropagationAndPreventDefaultBehavior")))}}Object(y.a)(l,"PresenceTooltipGlyph",b.a,[]);var u=a(131);a(85);var r=a(206);class x extends b.a{constructor(G,w,F){super(G);this.Wm=[];this.uD=[];this.apa=0;this.ERb=this.vkb=!1;this.xbf=null;
this.ola=(H,E)=>{var P=Object(c.a)(l,H);P=P?this.eWf(P):-1;if(2===E.type||1===E.type&&-1!==P&&!this.GZ[P].visible)this.K4c(H);else if(1===E.type)this.RBa(),this.vkb=!1;else if(3===E.type){if(this.RTf(E.jh))return;this.vkb||this.RBa()}this.raiseEvent(d.a.JJ,E)};this.yOb={};this.je=F;this.Mm=F.get(8,!1);this.J6=F.get(11,!1);G=F.get(12,0);this.mYa=F.get(6,0);this.kHb=w;this.element.id=x.vXd();this.element.className=b.a.iVe("prControl",this.Mm);G&&(this.zIndex=G);this.rtl=this.Mm;this.XGe(w);this.C6=
this.createElement("div");this.C6.className=this.J6?"prContainerV":"prContainerHr";this.element.appendChild(this.C6);this.Agf=Array(this.apa);for(w=0;w<this.apa;w++)this.GZ[w]=new m(this.createElement("div"),this.je),this.GZ[w].jXa(this.ola),this.element.appendChild(this.GZ[w].element)}get E3e(){return r.a.clone(this.Wm)}getGlyph(G){return this.yOb[G]}get GZ(){return this.Agf}get Bvf(){return this.xbf}get qbd(){return this.mYa+2}get width(){return this.J6?this.qbd:this.kHb}get height(){return this.J6?
this.kHb:this.qbd}jXa(G){this.addHandler(d.a.JJ,G)}Ebb(G){this.removeHandler(d.a.JJ,G)}dispose(){if(this.GZ)for(const G of this.GZ)G.Ebb(this.ola),u.a.qz(G);u.a.k5e(this.uD);this.uD=this.Agf=null;super.dispose()}ALb(){this.RBa();this.xJe();this.visible=!0;this.vkb=!1}CJe(){!this.uD||1>this.uD.length||(this.RBa(),this.visible=!0,this.xJe(),this.K4c(this.uD[this.uD.length-1]),this.vkb=!0)}Soc(){if(this.uD&&!(1>this.uD.length)){this.visible=!0;this.xJe();var G=0;for(const w of this.uD)this.K4c(w,G++);
this.vkb=!1;this.ERb=!0}}hide(){this.visible=!1;this.RBa();for(let G=0;G<this.uD.length;G++)this.uD[G].hide();this.vkb=!1}EGf(){if(!this.ERb)return!1;let G=0;for(const w of this.GZ)w.visible&&G++;return this.ERb=0<G&&(this.Wm.length<=this.apa?G===this.Wm.length:G===this.apa)}z2(G){if(!(0>=this.apa)){G.clientId||(G.clientId=(x.GOb++).toString());if(G.clientId in this.yOb){var w=this.eOa(G.clientId);if(0<=w){w=this.Wm[w];if(w.color===G.color&&w.userName===G.userName)return;this.rua(G.clientId)}}w=this.EGf();
var F=0;if(this.Wm.length<this.apa){var H=new l(this.createElement("div"),this.je,G);H.jXa(this.ola);this.Mm&&!this.J6&&0<this.Wm.length?this.C6.insertBefore(H.element,this.C6.firstChild):(this.C6.appendChild(H.element),F=this.uD.length);Array.add(this.uD,H)}else this.Mm&&!this.J6?H=this.uD[0]:(F=this.uD.length-1,H=this.uD[F]),H.z2(G);H.show();this.yOb[G.clientId]=H;Array.add(this.Wm,G);this.yxh(H,F);w&&this.Soc()}}rua(G){const w=this.EGf();w&&this.RBa();this.nec(G);this.Wm.length>=this.apa&&this.uD.length<
this.apa&&this.FSk();0>=this.Wm.length?this.hide():w&&this.Soc()}Ure(){}nec(G){var w=this.eOa(G);0>w||(G=this.Wm[w],Array.removeAt(this.Wm,w),w=this.yOb[G.clientId],delete this.yOb[G.clientId],w.rua(G.clientId),this.yxh(w),0>=w.$Ea&&(this.C6.removeChild(w.element),Array.remove(this.uD,w),w.dispose()))}cIe(){}FSk(){var G=this.Rmj();!G||1>=G.users.length||(G=Array.clone(this.Wm),G.forEach(w=>{this.nec(w.clientId)}),G.forEach(w=>{this.z2(w)}))}eOa(G){for(let w=0;w<this.Wm.length;w++)if(this.Wm[w].clientId===
G)return w;return-1}Rmj(){return this.Mm&&!this.J6?this.uD[0]:this.uD[this.uD.length-1]}position(G,w){this.element.style.top=w+"px";this.element.style.left=G+"px"}xJe(){for(let G=0;G<this.uD.length;G++)this.uD[G].show()}RBa(){for(let G=0;G<this.apa;G++)this.GZ[G].hide();this.ERb=!1}K4c(G,w=0){if(G)if(this.xbf=G,this.J6){const F=this.mYa;if(1<G.users.length)this.GZ[w].show(G.users,F,this.height-this.mYa);else{const H=this.C6.children.length;for(let E=0;E<this.C6.children.length;E++)G.element===this.C6.children[E]&&
this.GZ[w].show(G.users,F,this.height-(H-E)*this.qbd+2)}}else this.GZ[w].show(G.users,this.width,0)}RTf(G){G=x.q0d(G);let w=!1;for(const F of this.GZ)if(n.a.Xsb(F.element,G)){w=!0;break}return this.C6!==G&&n.a.Xsb(this.C6,G)||w}yxh(G,w=0){const F=this.UMj(G);F&&0>=G.$Ea?this.GZ[w].hide():F?this.K4c(G):this.GZ[w].hide()}eWf(G){let w=0;for(const F of this.uD){if(G===F)return w;w++}return-1}UMj(G){const w=this.eWf(G);return!!this.Bvf&&G===this.Bvf&&-1!==w&&this.GZ[w].visible}XGe(G){this.apa=G===this.mYa?
1:Math.floor(G/this.qbd);this.J6?(this.element.style.height=G+"px",this.element.style.width=this.mYa+"px"):(this.element.style.width=G+"px",this.element.style.height=this.mYa+"px")}static vXd(){return String.format("{0}-{1}","presencetooltip",x.GOb++)}static q0d(G){G=G.Pb.rawEvent;return G.relatedTarget||G.toElement}}x.GOb=0;Object(y.a)(x,"PresenceTooltipControl",b.a,[626,40]);var v=a(254),z=a(340),A=a(330);class B{constructor(G){this.je=G;this.je.bfa(10,v.a.instance);this.je.bfa(9,A.a.instance);
this.je.bfa(6,16);this.je.bfa(13,z.a.instance)}jIh(G,w){return new x(G,w,this.je)}YKf(G){return new x(G,16,this.je)}}Object(y.a)(B,"PresenceTooltipFactory",null,[625])},1835:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);class c{}c.taskPaneWidth=330;Object(y.a)(c,"AppsForOfficeConstants",null,[]);class b{constructor(){this.showLoadingSpinner=!1;this.aqa=null;this.resizeMaxWidth=this.resizeMinWidth=0;this.dialogWidth=this.dialogHeight=this.qEc=this.dialogTop=this.wEc=this.dialogLeft=null;this.taskPaneWidth=
c.taskPaneWidth;this.UC=this.sourceLocationOverrideResourceId=null;this.nonPersistedSettings={};this.onExtensionLaunchCallback=this.onTaskPaneClose=null;this.showResizeChatButton=this.isResizable=this.isModernPane=!1;this.sharedRuntimeId=null;this.isPaneAutoOpened=this.isPreload=!1;this.bkd=this.akd=!0}}Object(y.a)(b,"FirstPartyAddInOptionalParameters",null,[])},1889:function(y,C,a){a.d(C,"a",function(){return n});y=a(0);var c=a(119),b=a(187),d=a(41),e=a(124),h=a(287);class n extends c.a{constructor(m,
k=!1){super(m,!1,k)}get R1b(){return!1}get HZ(){return h.a.Gkc+"/modeless"}get MZe(){return null}set MZe(m){}get KZe(){return null}set KZe(m){}qp(m,k=null,l=null){this.yJ&&(l.isModal=!1);super.qp(m,k,l)}hide(){if(d.AFrameworkApplication.ha.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.Cc)this.qEm(),d.AFrameworkApplication.Ha.ry.ns(b.AFrame.UEa),super.hide()}uTm(){const m=d.AFrameworkApplication.Ha.ry,k=d.AFrameworkApplication.Ha.Gs;m.q$(this.HZ);
m.Pma(this.HZ);k.Uc(this.HZ).parent=b.AFrame.Wl}Nva(){e.FocusManager.iP()&&(super.Nva(),this.uTm(),d.AFrameworkApplication.Ha.ry.jZ(b.AFrame.UEa))}foc(){if(e.FocusManager.iP()&&!d.AFrameworkApplication.Ch){const m=e.FocusManager.instance();m.$da(this.HZ);const k=m.YX(this.HZ);k&&k.fm.qO(null);m.hoc(this.HZ)}}gJa(){"DL"===this.nza||"DP"===this.nza?super.gJa():d.AFrameworkApplication.ha&&d.AFrameworkApplication.ha.getBooleanAppSetting("WacAutoFitNonModalDialogIsEnabled")?(this.qEm(),this.HGh()&&this.sAm(this.Cc.clientHeight,
this.Cc.clientWidth)):this.X4()}X4(){this.sAm(c.a.WCh,c.a.XCh)}sAm(m,k){if(this.KZe&&this.MZe){let l,u;l=h.a.Wqd+this.MZe;u=h.a.Vqd+this.KZe;l+m>this.ara()&&(l=this.ara()-m);u+k>this.mBa()&&(u=this.mBa()-k);this.x6e(l,u)}else super.X4()}cXe(m){if(!m)return null;m.endsWith("px")&&(m=m.substring(0,m.length-2));return h.a.gJb(m)?((m=parseInt(m))||(m=1),m):null}qEm(){if(this.Cc&&this.Cc.style){var m=this.cXe(this.Cc.style.top);m&&(this.MZe=m-h.a.Wqd);if(m=d.AFrameworkApplication.isRtl?this.cXe(this.Cc.style.right):
this.cXe(this.Cc.style.left))this.KZe=m-h.a.Vqd}}}Object(y.a)(n,"ModelessCustomDialog",c.a,[])},1895:function(y,C,a){function c(ja){const qb=localStorage.getItem(ja);if(null===qb)return null;let V;try{V=JSON.parse(qb)}catch(Ea){return localStorage.removeItem(ja),null}return!Number.isInteger(V.expiration)&&Number.isNaN(Date.parse(V.expiration))||new Date(V.expiration)<=new Date?(localStorage.removeItem(ja),null):V.value}function b(ja,qb){return null!==ja&&null!==qb&&ja.toLowerCase().startsWith(qb.toLowerCase())&&
ja.length>qb.length&&"-"===ja.charAt(qb.length)}function d(ja,qb,V){if(void 0===ja||null===ja||1>ja.length)return-1;if(null===qb&&null===V)return-2;if(0===(null===qb||void 0===qb?void 0:qb.length)&&0===(null===V||void 0===V?void 0:V.length))return-1;let Ea=-1,Za=-1;for(let Va=0;Va<ja.length;Va+=1){var ia=ja[Va].lang.toLowerCase();ia=0!==(null===qb||void 0===qb?void 0:qb.length)&&ia===(null===qb||void 0===qb?void 0:qb.toLowerCase());const Ab=0!==(null===V||void 0===V?void 0:V.length)&&ja[Va].label.toLowerCase()===
(null===V||void 0===V?void 0:V.toLowerCase());0>Za&&Ab&&(Za=Va);if(ia){if(Ab)return Va;Ea=Va}0>Ea&&(b(ja[Va].lang,qb)||b(qb,ja[Va].lang))&&(Ea=Va)}return 0<Ea?Ea:0<Za?Za:0}function e(ja){if(!(void 0===ja||null===ja||1>ja.length)){var [qb,V]=[c("CaptionsLang"),c("CaptionsLabel")],Ea=d(ja,qb,V);if(0<=Ea&&Ea<ja.length)return ja[Ea].src}}a.r(C);var h=a(1257),n=a(41),m=a(0),k=a(50),l=a(232);const u=()=>k.a.instance.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");var r=a(405),x=a(609),v=
a(100),z=a(5);class A{constructor(ja,qb){this.Dn=ja;this.m2=qb}gH(ja,qb,V,Ea=null){return this.J8m(ja,Ea,Za=>this.Dn.YLa(Za,2,V,qb,!1,2,null,void 0,void 0,void 0,void 0,void 0,"2"))}J8m(ja,qb,V){const Ea=!!qb&&""!==qb;let Za=ja;Ea&&(Za=v.a.hXa(ja,"perfTag",qb));const ia=new Date;return x.a.then(V(Za),Va=>{const Ab=+new Date-+ia;if(!Va||!Va.mj||!Va.mj.data)return Va;Ea&&Va.mj.data.request&&this.s$n(Va.mj.data.request.getResolvedUrl(),qb,Ab);return Va})}s$n(ja,qb,V){ja=this.m2.Bkn(ja);if(ja.count&&
(ja=z.last(ja))){const Ea={Message:"Request durations for activities calls."};Ea.PerfTag=qb;Ea.CustomDuration=V;Ea.PerformanceDuration=ja.duration;r.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Ea))}}}Object(m.a)(A,"CatchUpNetworkingWrapper",null,[716]);var B=a(457);class G extends B.a{constructor(ja,qb){super(ja,qb)}lo(){return 6}}Object(m.a)(G,"GetActivityFeedRequest",B.a,[]);class w extends B.a{constructor(ja,qb,V,Ea,Za,ia){super(ja,qb);this.ItemIds=null;this.ActivityStatesToReset=this.ActivityStatesToSet=
0;this.ResetUnseenCount=!1;this.ItemIds=V;this.ActivityStatesToSet=Ea;this.ActivityStatesToReset=Za;this.ResetUnseenCount=ia}lo(){return 7}}Object(m.a)(w,"UpdateActivityFeedStateRequest",B.a,[]);var F=a(181),H=a(732);class E{constructor(ja,qb,V){this.oMl=ja;this.PGb=qb;this.QGb=V}Ndn(ja){return x.a.then(this.QGb.execute(new G(this.PGb(),null),(qb,V,Ea)=>this.oMl.gH(qb,V,Ea,"ActivityFeed"),ja),qb=>{if(!qb)return r.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!qb.mj)return r.ULS.sendTraceTag(572846938,
3012,10,"GetActivityFeed: Response.Args is null"),null;qb=qb.mj.data;if(!qb)return r.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(qb.Je!==F.a.KB)return r.ULS.sendTraceTag(508929507,3012,10,"GetActivityFeed: Response status code {0}",qb.Je),null;if(!qb.responseData)return r.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;qb=H.a.Xjd(qb.responseData);return qb?qb:(r.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),
null)})}slo(ja,qb,V,Ea,Za){return x.a.then(this.QGb.execute(new w(this.PGb(),null,qb,V,Ea,Za),(ia,Va,Ab)=>this.oMl.gH(ia,Va,Ab,"UpdateActivityFeedState"),ja),ia=>{try{return ia.succeeded}catch(Va){return r.ULS.sendTraceTag(523121054,3012,10,"UpdateActivityFeed: Exception {0}",Va.message),!1}})}}Object(m.a)(E,"CatchUpRequestHandler",null,[715]);var P=a(233);class T{constructor(ja){this.QSe=ja;this.NLl=new P.a}yBn(){this.UBn()}UBn(){if(this.QSe){var ja=qb=>{this.NLl.contains("CatchUpChangesFeedback")||
(this.NLl.add("CatchUpChangesFeedback"),qb.logActivity("CatchUpChangesFeedback",null))};this.QSe.execute(qb=>{window.setTimeout(()=>{ja(qb)},2E4)})}else r.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")}}Object(m.a)(T,"FloodgateEventLogger",null,[]);var K=a(21);class M{constructor(ja){this.fQm=ja}get duration(){return this.fQm.duration}}Object(m.a)(M,"PerformanceResourceTimingWrapper",null,[]);class N{constructor(ja){this.m2=ja}Bkn(ja){const qb=
new K.a;if(!this.m2)return qb;ja=this.m2.getEntriesByName(ja,"resource");if(!ja)return qb;for(const V of ja)qb.add(new M(V));return qb}}Object(m.a)(N,"PerformanceWrapper",null,[]);var I=a(95);class O{constructor(){this.Oa=null}get name(){return"Common.App.CatchUpActivity"}oc(ja){this.Oa=ja;this.Oa.register(A,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").oa().pa(()=>new A(n.AFrameworkApplication.$d,new N(window.performance)));this.Oa.register(E,
"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").oa().pa(()=>new E(u(),()=>n.AFrameworkApplication.Fh,new H.a));this.Oa.register(T,"Common.App.CatchUpActivity.FloodgateEventLogger").oa().pa(()=>new T(Object(l.a)()))}init(){u();k.a.instance.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")}dispose(){}static main(){I.a.instance.Jc(new O)}}Object(m.a)(O,"CatchUpActivityPackage",null,[4,5]);const Q=()=>k.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),
U=()=>k.a.instance.resolve("Common.App.Rename.IRenameFlyoutActor");var ba=a(799),aa=a(333),La=a(1607),Z=a(797),la=a(38),da=a(6),J=a(164);class Ca{constructor(ja,qb,V){this.Jjl=this.Kjl=this.Ljl=!1;this.okl=!ja&&!qb;this.pkl=!ja&&!V;this.okl||this.pkl||(this.Ljl=!ja,this.Kjl=!qb,this.Jjl=!V)}}Object(m.a)(Ca,"RenameDisabledDialogInfo",null,[]);var Fa=a(59);class ya extends J.a{constructor(ja,qb,V,Ea,Za){super();this.grl=[];this.IKa=new Ca(ja,qb,V);this.Fhd=Ea;this.Pgd=Za;this.rj="RenameDisabledDialog";
this.Ue=0;this.vg(1,Object(Fa.a)("DialogClose"));this.Vbo();this.o7n()}Vbo(){if(this.IKa.okl){let ja;ja=this.Fhd?this.Pgd?Object(Fa.a)("RenameFileRenameReadOnlyRecommended"):Object(Fa.a)("RenameFileRenameNotEveryoneSupportsRename"):Object(Fa.a)("RenameFileRenameDisabledCoauthFull");this.Xnh(ja)}else this.IKa.pkl?this.Xnh(Object(Fa.a)("RenameFileRenameDisabledPermissionFull")):this.UTm();this.dJd(this.grl)}Xnh(ja){Array.add(this.grl,ja)}UTm(){const ja=[];this.IKa.Ljl||Array.add(ja,Object(Fa.a)("RenameFileRenameDisabledSignIn"));
this.IKa.Kjl||Array.add(ja,Object(Fa.a)("RenameFileRenameDisabledPermission"));this.IKa.Jjl||Array.add(ja,Object(Fa.a)("RenameFileRenameDisabledCoauth"));0<ja.length&&Array.add(this.grl,ja)}}Object(m.a)(ya,"ReactRenameDisabledDialogBase",J.a,[]);class Ua extends ya{constructor(ja,qb,V,Ea,Za){super(ja,qb,V,Ea,Za)}o7n(){this.Umc(Object(Fa.a)("RenameFileRenameDisabledTitle"),null,null,null,null,null)}}Object(m.a)(Ua,"ReactRenameDisabledDialog",ya,[]);var Ia=a(119);class Oa{static get Vl(){return Ia.a.jU(Oa.Sx,
Object(Fa.a)("RenameFileRenameDisabled"),Object(Fa.a)("RenameFileRenameDisabledSignIn"),Object(Fa.a)("RenameFileRenameDisabledPermission"),Object(Fa.a)("RenameFileRenameDisabledCoauth"))}}Oa.Sx="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(m.a)(Oa,"RenameDisabledDialogHtml",null,[]);class ma extends Ia.a{constructor(ja,qb,V,Ea,Za){super();this.IKa=new Ca(ja,qb,V);this.Fhd=Ea;this.Pgd=Za;this.rj="RenameDisabledDialog";this.Ue=0;this.vg(1,Object(Fa.a)("DialogClose"));this.Vl=Oa.Vl;this.showDialog(Object(Fa.a)("RenameFileRenameDisabledTitle"),null);this.Gua("RenameRow")}fZa(){if(this.IKa.okl){let ja;ja=this.Fhd?this.Pgd?Object(Fa.a)("RenameFileRenameReadOnlyRecommended"):Object(Fa.a)("RenameFileRenameNotEveryoneSupportsRename"):
Object(Fa.a)("RenameFileRenameDisabledCoauthFull");ma.Xnh(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),ja)}else this.IKa.pkl?ma.Xnh(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Object(Fa.a)("RenameFileRenameDisabledPermissionFull")):this.Vqn()}Vqn(){this.IKa.Ljl&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.IKa.Kjl&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.IKa.Jjl&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static Xnh(ja,qb,V){ja.style.display="none";qb.innerText=V}}Object(m.a)(ma,"RenameDisabledDialog",Ia.a,[]);var za=a(64),Qa=a(98),Xa=a(57);class Tb{constructor(ja,qb){this.UCd=0;this.QUe=(V,Ea,Za,ia,Va)=>{if(1===Za)return this.Aa.Eb(Xa.a.BCb,1);V=za.a.aca(this.Hrc.LP);Va=(0,Va.getNewDocumentTitle)();Va.length>this.UCd&&(Va=Va.substr(0,this.UCd));if(32!==this.Aa.Ra(Xa.a.BCb,2,Va))return this.a8e(V),
8;this.a8e(Va);return 32};this.Aa=ja;this.Hrc=qb}initialize(ja){if(!this.Aa||!this.Hrc)return!1;this.UCd=ja;this.Kb();return!0}Kb(){this.Aa.Ba(Xa.a.QUe,Qa.a.frame,this.QUe)}a8e(ja){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(ja))}static nI(){return new Tb(n.AFrameworkApplication.ub,n.AFrameworkApplication.Dz)}}Object(m.a)(Tb,"ReactRenameUIHandler",null,[761]);var Kb=a(1057),nb=a(315),Ka=a(834),Sb=a(803),ab=a(88),ub=a(237),Aa=a(330),tb=a(221),kc=a(85),dc=a(69);class Db{constructor(ja,
qb,V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd){this._initialized=!1;this._element=null;this.UCd=0;this.Mji=this.Zbi=!1;this.Aa=ja;this.P7h=qb;this.Tj=V;this.xJ=Ea;this.Hrc=Za;this.CNl=ia;this.IEh=Va;this.H8h=Ab;this.Kma=gc;this.bLl=Hc;this.Ej=fd;this.Yci=hd}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(ja,qb,V){if(!(this.Aa&&this.Hrc&&this.CNl&&this.IEh&&this.H8h&&qb)||0>=ja)return!1;this._element=qb;this._element.title=V;this._element.setAttribute(tb.a.ii,tb.a.fM);this._element.setAttribute("Unselectable",
"on");this.UCd=ja;this.LQ();return this._initialized=!0}LQ(){this.P7h&&(this.P7h.Ub(ab.a.blur,this._element,Object(da.a)(this,this.onBlur,"onBlur")),this.P7h.Ub(ab.a.paste,this._element,Object(da.a)(this,this.eTn,"onPaste")));this.Tj.Ub(ab.a.oi,this._element,Object(da.a)(this,this.onKeyDown,"onKeyDown"));this.xJ.Ub(ab.a.aH,this._element,Object(da.a)(this,this.tla,"onPointerDown"));this.xJ.Ub(ab.a.JQ,this._element,Object(da.a)(this,this.Ihb,"onPointerUp"))}onBlur(){this.isActive&&!this.Zbi&&(this.bLl||
this.H8h(this._element),this.cVl(),this.MWi(!1));return this.Zbi=!1}eTn(){r.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(ja){return this.isActive?this.tSn(ja):this.uSn(ja)}tSn(ja){let qb=!1;switch(ja.Pb.keyCode){case Sys.UI.Key.enter:this.cVl();this.MWi(this.Ej||this.Yci);qb=!0;break;case Sys.UI.Key.tab:this.bLl&&this.H8h(this._element);break;case Sys.UI.Key.esc:this.x2k(),this.MWi(this.Ej||this.Yci),qb=!0}return qb}uSn(ja){let qb=!1;switch(ja.Pb.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.iDm(this.Yci),
this.isActive&&this.IEh(this._element),qb=!0}return qb}tla(){this.isActive||(this.iDm(!1),this.isActive&&(this._element.focus(),this.IEh(this._element),this.Mji=!0));return!1}Ihb(){return this.Mji?(this.IEh(this._element),this.Mji=!1,!0):!1}sZe(){return 32===this.Aa.Eb(Xa.a.BCb,1)}cVl(){const ja=za.a.aca(this.Hrc.LP);let qb=this._element.innerText.trim();qb.length>this.UCd&&(qb=qb.substr(0,this.UCd));qb!==ja&&""!==qb?32!==this.Aa.Ra(Xa.a.BCb,2,qb)?this.x2k():this.a8e(qb):this.x2k()}x2k(){this.a8e(za.a.aca(this.Hrc.LP))}a8e(ja){this._initialized&&
(this._element.innerText=ja,this.CNl())}iDm(ja){this.sZe()?this.isActive||(ja&&(this.Zbi=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(tb.a.ii,tb.a.GGh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,nb.a.ORf),this.Kma&&this.Kma.execute(qb=>{qb.EQk(!0)}),ja&&this._element.focus(),r.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Aa.Eb(Xa.a.IJe,
2)}MWi(ja){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(tb.a.ii,tb.a.fM);Sys.UI.DomElement.removeCssClass(this._element,nb.a.ORf);this.Kma&&this.Kma.execute(qb=>{qb.EQk(!1)});ja&&(this._element.blur(),this._element.focus())}static qib(){Ka.a.qib(n.AFrameworkApplication.isRtl)}static nI(){return new Db(n.AFrameworkApplication.ub,Sb.a.instance,ub.a.instance,Aa.a.instance,n.AFrameworkApplication.Dz,Db.qib,kc.a.Zwm,kc.a.EHh,
Object(Kb.a)(),dc.a.nE,dc.a.Fj,dc.a.Yf)}}Object(m.a)(Db,"RenameUIHandler",null,[761]);class sb{static get instance(){return n.AFrameworkApplication.Ha.Ib.PO?sb.Qa||(sb.Qa=Tb.nI()):sb.Qa||(sb.Qa=Db.nI())}}sb.Qa=null;Object(m.a)(sb,"RenameUIHandlerFactory",null,[]);var Qb=a(118),$a=a(1831);class X{constructor(){this.XWg=this.OOn=this.C6m=null}}Object(m.a)(X,"RenameMruEntryProperties",null,[]);var Ta=a(224),ca=a(150),Ma=a(557),Ba;(function(ja){ja[ja.unknown=-1]="unknown";ja[ja.success=0]="success";ja[ja.Byo=
1]="renameInvalidFileName";ja[ja.Ayo=2]="renameInCoauthNotSupported";ja[ja.Cyo=3]="renameNotSupportedInViewMode";ja[ja.permissionDenied=4]="permissionDenied";ja[ja.Syo=5]="serverCommunicationFailure";ja[ja.Awo=6]="fileNameTooLong"})(Ba||(Ba={}));Object(m.b)("CommonOperationResult",Ba);var wa=a(1502);class pa{constructor(ja,qb=!1){this.fileNameCandidate=ja;this.disableFailedActionDialog=qb}}Object(m.a)(pa,"RenameActionData",null,[]);var ta=a(75);class Wa{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc,fd,
hd){this.YIb=()=>sb.instance.initialize(n.AFrameworkApplication.pWe,n.AFrameworkApplication.ZWb,n.AFrameworkApplication.QZk||Object(Fa.a)("RenameFileTooltip"))?32:8;this.IJe=()=>{const yd=this.Mno(),Md=this.sSm();r.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.yCd,Md,yd,this.Fhd);n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.rR&&
n.AFrameworkApplication.ha.getBooleanAppSetting("ReactRenameDisabledDialogIsEnabled")?new Ua(this.yCd,!Md,!yd,this.Fhd,this.Pgd()):new ma(this.yCd,!Md,!yd,this.Fhd,this.Pgd());return 32};this.BCb=(yd,Md,te,Pe,t)=>{if(1===te)return this.sZe();if(!n.AFrameworkApplication.Dkd)return 8;if(8===this.sZe())return this.Ft.Eb(Xa.a.IJe,2),8;this.msd&&this.msd.kxh(!1);r.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");yd=!1;t instanceof pa&&(yd=t.disableFailedActionDialog,t=t.fileNameCandidate);n.AFrameworkApplication.Dkd(t,
Object(da.a)(this,this.v0g,"onRenameFileSuccess"),yd?this.nQn:this.ETn);n.AFrameworkApplication.Xum=!0;return 32};this.nQn=yd=>{r.ULS.sendTraceTag(507655632,203,15,"OnAutoRenameFileFailure: {0}",{["Result"]:null!==yd&&void 0!==yd?yd:-1});this.msd&&this.msd.kxh(!0)};this.ETn=yd=>{r.ULS.sendTraceTag(507655631,203,15,"OnRenameFileFailure: {0}",{["Result"]:null!==yd&&void 0!==yd?yd:-1});const Md=new J.a;Md.Ue=0;switch(yd){case 1:r.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");
Md.Ggc(Object(Fa.a)("RenameFileInvalidNameTitle"),Object(Fa.a)("RenameFileInvalidName"),null);break;case 6:r.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");Md.Ggc(Object(Fa.a)("RenameFileInvalidNameTitle"),Object(Fa.a)("RenameFileNameTooLong"),null);break;default:r.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:null!==yd&&void 0!==yd?yd:-1}),Md.Ggc(Object(Fa.a)("RenameFileGenericErrorTitle"),Object(Fa.a)("RenameFileGenericError"),null)}n.AFrameworkApplication.ZP().execute(te=>
{te.sendMessage(ca.a.p0l,{["FailureMessage"]:Ba[yd]})});this.Hvm();this.msd&&this.msd.kxh(!0)};this.t4n=(yd,Md,te)=>{if(1===te)return this.sZe();if(!n.AFrameworkApplication.HXb)return 8;n.AFrameworkApplication.HXb(Object(da.a)(this,this.N1e,"onRefreshFilenameSuccess"),Object(da.a)(this,this.PVh,"onRefreshFilenameFailure"),!1);return 32};this.nWg=(yd,Md,te,Pe,t)=>{if(1===te)return n.AFrameworkApplication.ha.getBooleanAppSetting("UiHostSupportsMoveToFolder")?this.sZe():8;if(2===te){if(!n.AFrameworkApplication.p5e)return Qb.Health.instance.recordKpiFailure("MoveToFolder",
"Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!t)return Qb.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(t[Ta.a.x9l])if(t[Ta.a.nCl])if(yd=t[Ta.a.nCl].toLowerCase(),Md=n.AFrameworkApplication.ha.getBooleanAppSetting("UiHostSupportsDocRebootFeatures"),te=n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Md&&n.AFrameworkApplication.una&&te){const L={};L[Ta.a.Xnc]="1";L[Ta.a.documentUrl]=yd;L[Ta.a.reason]=
Ma.a.zgh;Qb.Health.instance.recordKpiSuccess("MoveToFolder",null);n.AFrameworkApplication.ZP().execute(S=>{S.sendMessage(ca.a.RXa,L)})}else if(!n.AFrameworkApplication.una&&te)Qb.Health.instance.recordKpiSuccess("MoveToFolder",null),kc.a.Go(yd,kc.a.DJa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return Qb.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else Qb.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else n.AFrameworkApplication.HXb(Object(da.a)(this,
this.N1e,"onRefreshFilenameSuccess"),Object(da.a)(this,this.PVh,"onRefreshFilenameFailure"),!1),n.AFrameworkApplication.p5e(),Qb.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};this.gLl=ja;this.Aa=qb;this.VMb=V;this.Gaa=Ea;this.yCd=Za;this.sSm=ia;this.Fhd=Va;this.yOl=Ab;this.PQm=gc;this.Pgd=Hc;this.Ga=fd;this.OQm=hd;this.amb=new la.a(()=>this.Pkn())}Kb(){n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.PO||this.Ft.Ba(Xa.a.YIb,Qa.a.frame,this.YIb);this.Ft.Ba(Xa.a.IJe,Qa.a.frame,
this.IJe);this.Ft.Ba(Xa.a.BCb,Qa.a.frame,this.BCb);this.Ft.ua(Xa.a.NVd,Qa.a.frame,this.t4n,64);this.Ft.ua(Xa.a.nWg,Qa.a.frame,this.nWg,64);this.Ft.Ba(Xa.a.B$b,Qa.a.frame,Object(da.a)(this,this.B$b,"moveToFolder"));(n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||n.AFrameworkApplication.Ha&&(n.AFrameworkApplication.ha.getBooleanAppSetting("PostMessageEmbedded")||n.AFrameworkApplication.ha.getBooleanAppSetting("IsJsApi"))&&n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&n.AFrameworkApplication.ZP().execute(ja=>{ja.Yt(ca.a.dtk);ja.hD(ca.a.dtk,Wa.R3n);ja.Yt(ca.a.hKh);ja.hD(ca.a.hKh,Wa.J3n)})}sZe(){return 0===this.OQm.Qoj()?32:8}Mno(){return this.wZ?this.Fhd?this.wZ.NQf:this.wZ.Ofb:!0}Pkn(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIconsWithStrings",!1)?k.a.instance.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"):null}v0g(ja,qb){ja?0!==ja.OperationResult?this.S5l(ja.OperationResult):(this.m$n(qb,ja.NewName),
this.ylo(ja,Object(da.a)(n.AFrameworkApplication.Ha.Ib,n.AFrameworkApplication.Ha.Ib.b2h,"updateOpenInClientDocumentUrl")),n.AFrameworkApplication.ha.getBooleanAppSetting("DocumentNameInJewelInfoMenuIsEnabled")&&n.AFrameworkApplication.Ha.fg(),this.PQm.SDm()):this.S5l(5);this.msd&&this.msd.kxh(!0)}m$n(ja,qb){const V={};V[Ta.a.q0l]=qb;ja.sendMessage(ca.a.hKh,V)}ylo(ja,qb){this.Ilo(ja);n.AFrameworkApplication.ckd=ja.DirectInvokeDavUrl;qb=qb(ja.EditDocInClientUrl);const V=new X;V.XWg=this.Gaa.LP;V.C6m=
qb;V.OOn=ja.EditDocInClientUrl;this.Ft.Ra(Xa.a.Bch,2,V)}S5l(ja){switch(ja){case 1:ja=new J.a,ja.Ue=0,ja.h6(Object(Fa.a)("RenameFileInvalidNameTitle"),Object(Fa.a)("RenameFileInvalidName"),null),this.Hvm()}}Ilo(ja){this.Gaa.LP=Wa.aXm(this.Gaa.LP,ja.NewName);ja.BreadcrumbFolderName&&(this.Gaa.breadcrumbFolderName=ja.BreadcrumbFolderName);ja.BreadcrumbFolderUrl&&(this.Gaa.breadcrumbFolderUrl=ja.BreadcrumbFolderUrl);this.yOl(ja.NewName)}B$b(ja,qb,V,Ea,Za){if(1===V)return n.AFrameworkApplication.ha.getBooleanAppSetting("UiHostSupportsMoveToFolder")?
32:8;if(2===V){const ia={};ja=n.AFrameworkApplication.una;qb=n.AFrameworkApplication.ha.getBooleanAppSetting("UiHostSupportsDocRebootFeatures");ja=(!ja||ja&&qb)&&n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);ia[Ta.a.QBm]=ja;Za&&Za.MoveButtonClickedTime&&(ia[Ta.a.Hjm]=Za.MoveButtonClickedTime.getTime());n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.MoveFilePickerDarkModeSupported",!1)&&(ja={},Object(ta.a)("isSharedUXDarkModeOn")&&
appChrome.api.isSharedUXDarkModeOn()&&(ja[Ta.a.tFk]="Dark"),ia[Ta.a.rFk]=ja);n.AFrameworkApplication.ZP().execute(Va=>{Va.sendMessage(ca.a.B$b,ia)});Za&&Za.MoveButtonClickedTime&&((ja=$a.a.Bx())&&ja.set("MovePostDuration",((new Date).getTime()-Za.MoveButtonClickedTime.getTime()).toString()),Qb.Health.instance.recordKpiUsage("MoveToFolder",wa.b.FailureBased,"smartfio",ja));return 32}return 8}Ido(ja,qb){return ja&&qb?ja!==this.Gaa.breadcrumbFolderName||qb!==this.Gaa.breadcrumbFolderUrl:!1}N1e(ja,qb){ja&&
(ja.NewName!==za.a.aca(this.Gaa.LP)||this.Ido(ja.BreadcrumbFolderName,ja.BreadcrumbFolderUrl))&&this.v0g(ja,qb)}PVh(){}Hvm(){this.yOl(za.a.aca(this.Gaa.LP))}get Ft(){return this.Aa.value}get msd(){return this.amb.value}get wZ(){return this.VMb.value}static get instance(){return Wa.Qa||(Wa.Qa=Wa.vHc())}static vHc(){return new Wa(n.AFrameworkApplication.uae,new la.a(()=>n.AFrameworkApplication.ub),new la.a(()=>n.AFrameworkApplication.wZ),n.AFrameworkApplication.Dz,n.AFrameworkApplication.WS,()=>n.AFrameworkApplication.ffd,
n.AFrameworkApplication.cEe,Object(da.a)(sb.instance,sb.instance.a8e,"updateTitle"),Q(),()=>n.AFrameworkApplication.cW,n.AFrameworkApplication.ha,k.a.instance.resolve("Common.IRenameProps"))}static aXm(ja,qb){ja=za.a.GJ(ja);return qb+ja}static R3n(ja){const qb=ja.Values[Ta.a.d$l];r.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",qb);qb?n.AFrameworkApplication.ub.Ra(Xa.a.nWg,2,ja.Values):Qb.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",
!1,!1,null)}static J3n(ja){n.AFrameworkApplication.ub.Ra(Xa.a.BCb,2,ja.Values.NewName)}}Wa.Qa=null;Object(m.a)(Wa,"RenameActor",null,[]);var Pa=a(472),ib=a(1354),Ib=a(1333),hc=a(247);class yc{constructor(ja,qb){this.Aa=ja;this.q$h=qb}Kb(){this.Aa.Ba(Xa.a.dtd,Qa.a.frame,Object(da.a)(this,this.bfo,"showRenameDialogAction"))}bfo(ja,qb,V){ja=32;if(1===V)return hc.SessionStatusManager.instance.iPa||n.AFrameworkApplication.tna?8:32;2===V&&(32!==this.Aa.Eb(Xa.a.BCb,1)?(this.Aa.Eb(Xa.a.IJe,2),Pa.a.instance.ic(ib.a.$ma,
{["Reason"]:Ib.a.Wum}),ja=8):32===this.Aa.Eb(Xa.a.r6e,1)?this.Aa.Eb(Xa.a.r6e,2):this.q$h.value.create().rEb());return ja}}Object(m.a)(yc,"RenameDialogActor",null,[1062]);class ob{constructor(ja,qb,V){this.dialog=null;this.Aa=ja;this.Gaa=qb;this.iDh=V}wkn(){const ja={};ja.nameInputProps={["type"]:"AppInputProps",["id"]:ob.A0i,["label"]:Object(Fa.a)("RenameDialogLabel"),["value"]:za.a.aca(this.Gaa.LP),["maxLength"]:this.iDh};return ja}rEb(){const ja={["id"]:"RenameDialog",["bodyControls"]:this.wkn()};
this.dialog=new Ia.a(!1,!1,!0);this.dialog.Ue=1;this.dialog.rj="RenameDialog";this.dialog.qp(Object(Fa.a)("RenameDialogTitle"),Object(da.a)(this,this.U6n,"renameDialogHandler"),ja)}U6n(ja,qb){if(qb&&1===ja){if(qb[ob.A0i]&&(ja=za.a.aca(this.Gaa.LP),qb=(qb[ob.A0i]||"").trim(),qb!==ja&&""!==qb)){this.Aa.Ra(Xa.a.BCb,2,qb);return}Pa.a.instance.ic(ib.a.fkd,{["Reason"]:Ib.a.o0l})}}}ob.A0i="txtDocumentName";Object(m.a)(ob,"RenameDialog",null,[1074]);class Bc{constructor(ja){this.Hrc=null;this.iDh=0;this.Aa=
ja;this._initialized=!1}initialize(ja,qb){this.Hrc=ja;this.iDh=qb;this._initialized=!0}create(){return this._initialized?new ob(this.Aa,this.Hrc,this.iDh):null}}Object(m.a)(Bc,"RenameDialogFactory",null,[1061]);var rb=a(187),Eb=a(103),jc=a(99),ea=a(137),ua=a(204);class Da{constructor(ja,qb){this.Aa=ja;this.Fe=qb}Kb(){this.Aa.Ba(Xa.a.r6e,Qa.a.frame,Object(da.a)(this,this.cfo,"showRenameFlyoutAction"))}M_m(){return ta.d("setDocumentTitleFlyoutOpened")&&n.AFrameworkApplication.Ha.Ib.PO}cfo(ja,qb,V){if(1===
V)return this.M_m()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}wUm(){Da.Gyn&&n.AFrameworkApplication.HIa&&ea.TaskManager.instance.Rb(new jc.a(5,1,5E3,()=>{32===this.Aa.Eb(Xa.a.r6e,1)&&this.Fe&&this.Fe.currentScope.name===rb.AFrame.iU&&(Eb.a("RenameFloatieShownOnNewDocumentLoad",!0),this.Aa.Eb(Xa.a.r6e,2))}))}static get Gyn(){Da.MDh&&null!=Da.MDh||(ua.a.DH("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),Da.MDh=n.AFrameworkApplication.ha?
n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return Da.MDh}}Da.MDh=null;Object(m.a)(Da,"RenameFlyoutActor",null,[1060]);class Cb{constructor(ja,qb,V,Ea,Za){this.hIf=null;this.VMb=Za;this.hLl=V;this.gLl=Ea;this.uSm=ja;this.Pgd=qb}get wZ(){return this.VMb.value}Qoj(){if(!this.gLl())return 5;if(this.Pgd())return 1;if(this.wZ){if(this.hLl&&!this.wZ.NQf)return 3;if(!this.hLl&&!this.wZ.Ofb)return 4}return this.uSm()?0:
2}}Object(m.a)(Cb,"RenameProps",null,[741]);var Nb=a(23);class fc{constructor(ja,qb,V,Ea,Za,ia){this.$v=!1;this.uei=new Nb.a;this.URe=qb;this.fxd=V;this.Mwd=Ea;this.Ga=Za;this.$ya=ia}enable(){this.$v||(this.SDm(),this.Anl(),this.$v=!0)}generateKey(ja,qb,V){return String.format("{0}/{1}/{2}",V,ja,qb)}bin(){const ja=za.a.aca(this.URe().LP);return this.generateKey(this.URe().breadcrumbFolderName,this.URe().breadcrumbFolderUrl,ja)}cin(ja,qb,V){return ja&&qb?this.generateKey(ja,qb,V):V}f8m(ja,qb,V){return ja&&
ja!==this.URe().breadcrumbFolderName||qb&&qb!==this.URe().breadcrumbFolderUrl?!0:V!==za.a.aca(this.URe().LP)}SDm(){const ja=this.bin();this.uei.fa(ja,new Date)}jFk(ja){this.jdo(ja)&&this.QOl(ja)}jdo(ja){const qb=this.Mwd();return qb?this.$ya&&this.$ya.ygb||!qb.BOh||!n.AFrameworkApplication.HXb?(this.DBm(ja),this.$v=!1):!0:!1}Enm(ja,qb,V,Ea){const Za=this.f8m(ja,qb,V);ja=this.cin(ja,qb,V);qb=this.uei.Ph(ja).returnValue;Za&&!qb&&(this.U5l(Ea),r.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",
this.r6j));Za||this.uei.fa(ja,this.fxd())}}Object(m.a)(fc,"ARenamedFileChecker",null,[718]);class fb extends fc{constructor(ja,qb,V,Ea,Za,ia,Va,Ab){super(ja,qb,V,Ea,Za,ia);this.w6l=(gc,Hc)=>{Hc&&Hc.qse&&Hc.Fkm&&(Hc.gnd("BreadcrumbDocName")||Hc.gnd("BreadcrumbFolderName")||Hc.gnd("BreadcrumbFolderUrl")||Hc.gnd("DirectInvokeDAVUrl")||Hc.gnd("EditDocInClientUrl"))&&(r.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.r6j),this.jFk(Hc))};this.nNl=Za;this.NQm=Va;this.Uzd=Ab}get r6j(){return"RenamedFileCheckerUsingSettingsRefresh"}Anl(){this.nNl.xTe(this.w6l)}DBm(){this.nNl.oYh(this.w6l)}QOl(ja){if(ja&&
ja.qse){const qb=ja.qse;this.Enm(qb.Ma("BreadcrumbFolderName"),qb.Ma("BreadcrumbFolderUrl"),qb.Ma("BreadcrumbDocName"),ja)}}U5l(ja){const qb={OperationResult:0,classId:1};ja=ja.qse;qb.BreadcrumbFolderName=ja.Ma("BreadcrumbFolderName");qb.BreadcrumbFolderUrl=ja.Ma("BreadcrumbFolderUrl");qb.DirectInvokeDavUrl=ja.Ma("DirectInvokeDAVUrl");qb.EditDocInClientUrl=ja.Ma("EditDocInClientUrl");ja=ja.Ma("BreadcrumbDocName");qb.NewName=n.AFrameworkApplication.VEc?ja:za.a.aca(ja);this.Uzd.execute(V=>{this.Wvn(qb,
V)})}Wvn(ja,qb){this.NQm().v0g(ja,qb)}}Object(m.a)(fb,"RenamedFileCheckerUsingSettingsRefresh",fc,[]);class Ub extends fc{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc){super(ja,V,Ea,Za,ia,gc);this.dqf=this.Ejc=null;this.jQm=qb;this.Aa=Va;this.Ce=Ab;Hc&&Hc.execute(fd=>{this.u5n(fd)})}get r6j(){return"RenamedFileCheckerUsingTask"}u5n(ja){this.Ejc=ja;this.Ejc.eid(Object(da.a)(this,this.X2d,"handleVisibilityChange"))}X2d(ja,qb){!this.$v||0!==qb.newState&&1!==qb.newState||this.dqf||(this.Anl(),this.jFk(this.dqf))}Anl(){this.dqf=
new jc.a(3,2,this.jQm(),Object(da.a)(this,this.jFk,"performRenameFileCheckTick"),89);this.Ce.Rb(this.dqf)}DBm(ja){this.Ce.Sh(ja)}QOl(ja){this.Ejc&&2===this.Ejc.Rma?this.S5n(ja):n.AFrameworkApplication.HXb(Object(da.a)(this,this.N1e,"onRefreshFilenameSuccess"),Object(da.a)(this,this.PVh,"onRefreshFilenameFailure"),!0)}S5n(ja){this.Ce.Sh(ja);this.dqf=null}N1e(ja){ja&&this.Enm(ja.BreadcrumbFolderName,ja.BreadcrumbFolderUrl,ja.NewName,null)}U5l(){this.Aa.Eb(Xa.a.NVd,2)}PVh(){}}Object(m.a)(Ub,"RenamedFileCheckerUsingTask",
fc,[]);var Ec=a(124);class Lc{constructor(){this.Ga=this.Oa=null;this.uu=()=>{const ja=n.AFrameworkApplication.Ha.Ib.PO;n.AFrameworkApplication.uae()&&sb.instance.initialize(n.AFrameworkApplication.pWe,ja?null:n.AFrameworkApplication.ZWb,ja?null:n.AFrameworkApplication.QZk||Object(Fa.a)("RenameFileTooltip"))&&(this.Oa.register(Cb,"Common.App.Rename.RenameProps").as("Common.IRenameProps").pa(()=>new Cb(()=>n.AFrameworkApplication.ffd,()=>n.AFrameworkApplication.cW,n.AFrameworkApplication.cEe,n.AFrameworkApplication.uae,
new la.a(()=>n.AFrameworkApplication.wZ))).oa(),Wa.instance.Kb(),this.Ga.getBooleanAppSetting("RenameDialogIsEnabled")&&(k.a.instance.resolve("Common.App.Rename.RenameDialogFactory").initialize(n.AFrameworkApplication.Dz,n.AFrameworkApplication.pWe),k.a.instance.resolve("Common.App.Rename.IRenameDialogActor").Kb()),U().Kb(),n.AFrameworkApplication.cEe&&Q().enable(),U().wUm())}}get name(){return"Common.App.RenameFile"}oc(ja){this.Oa=ja;this.Ga=n.AFrameworkApplication.ha;this.Oa.register(yc,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").pa(()=>
new yc(n.AFrameworkApplication.ub,k.a.instance.he("Common.App.Rename.RenameDialogFactory"))).oa();this.Oa.register(Bc,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").pa(()=>new Bc(n.AFrameworkApplication.ub)).oa();this.Oa.register(718,"Common.App.Rename.IRenamedFileChecker").pa(()=>this.k5m()).oa();this.Oa.register(Da,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").pa(()=>new Da(n.AFrameworkApplication.ub,Ec.FocusManager.instance())).oa()}k5m(){if(this.Ga.getBooleanAppSetting("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const ja=
Object(Z.b)();if(ja&&ja.z$l)return new fb(()=>ja.Ac("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>n.AFrameworkApplication.Dz,()=>new Date,()=>n.AFrameworkApplication.wZ,ja,Object(La.a)(),()=>Wa.instance,Object(aa.a)())}return new Ub(()=>this.Ga.Ac("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Ga.Ac("RenamedFileCheckerPingIntervalInMs",12E4),()=>n.AFrameworkApplication.Dz,()=>new Date,()=>n.AFrameworkApplication.wZ,n.AFrameworkApplication.ha,n.AFrameworkApplication.ub,n.AFrameworkApplication.Zd,
Object(La.a)(),Object(ba.a)())}init(){this.Ga.Wf(this.uu)}dispose(){}}Object(m.a)(Lc,"PackageManager",null,[4,5]);var vb=a(1051),ec=a(15);const lb=ja=>{try{return ec.a(ja)}catch(qb){}return null};class Zb{constructor(ja,qb,V,Ea,Za,ia){this.veb=!1;this.ALa=null;this.yhi=!1;this.Pzi=Va=>{const Ab=Va.yQ.task;Ab.continueWith(()=>{this.ALa=Ab.result;this.yhi&&(this.ALa.qDb(2,null,!0),this.yhi=!1);this.ALa.Myc((gc,Hc)=>{2===Hc.type&&this.Ft.Eb(Xa.a.NVd,2)});this.ALa.SJd((gc,Hc)=>{2===Hc.newState&&this.Ft.Eb(Xa.a.NVd,
2)});2===this.ALa.connectionState&&this.Ft.Eb(Xa.a.NVd,2)})};this.N1e=Va=>{this.veb=!1;const Ab=lb(Va.data.responseData);Va.data.state.px(Ab,this.HLl.value)};this.ATn=Va=>{5!==Va.data.status||this.veb?this.Vmm(Va):(this.veb=!0,this.w_l(Va.data.state,!1))};this.Vmm=Va=>{Va.data.state.$G(-1)};this.v0g=Va=>{this.veb=!1;const Ab=lb(Va.data.responseData);Va.data.state.px(Ab,this.HLl.value);this.rkm()};this.FTn=Va=>{5!==Va.data.status||this.veb?this.bnm(Va):(this.veb=!0,this.x_l(Va.data.state,!1))};this.bnm=
Va=>{Va.data.state.$G(-1)};this.Aa=ja;this.Dn=qb;this.VMb=V;this.HLl=Ea;this.Ga=Za;this.lPm=ia}init(ja,qb){qb&&k.a.instance.eb("Common.Interface.IRtcBasicProvider").execute(this.Pzi)}HXb(ja){this.w_l(ja,!0)}w_l(ja,qb){const V=this.wZm(ja.uAm),Ea={};Ea[Zb.uVl]=Zb.vVl;this.mvm.ik(V,2,"",Ea,!1,2,this.N1e,qb?this.ATn:this.Vmm,ja)}Dkd(ja){this.x_l(ja,!0)}x_l(ja,qb){const V=this.xZm(),Ea={};Ea[Zb.uVl]=Zb.vVl;Ea[Zb.gqn]=za.a.yj(ja.qvm);Ea[Zb.eqn]=this.lPm.value.hIf;this.mvm.ik(V,2,"",Ea,!1,2,this.v0g,qb?
this.FTn:this.bnm,ja)}xZm(){return this.ESl()}wZm(ja){let qb=this.ESl();return qb=v.a.xl(qb,Zb.kqn,ja?"2":"1")}ESl(){let ja=(this.Ga.value.appSettings.RenameWebServiceBase||"")+Zb.fqn;ja=v.a.xl(ja,Zb.hqn,za.a.yj(n.AFrameworkApplication.Fh));this.wZ&&this.wZ.BOh&&(ja=v.a.xl(ja,Zb.jqn,"1"));return ja}rkm(){this.ALa?this.ALa.qDb(2,null,!0):this.yhi=!0}get Ft(){return this.Aa.value}get mvm(){return this.Dn.value}get wZ(){return this.VMb.value}static get instance(){return Zb.Qa||(Zb.Qa=Zb.vHc())}static vHc(){return new Zb(new la.a(()=>
n.AFrameworkApplication.ub),new la.a(()=>n.AFrameworkApplication.$d),new la.a(()=>n.AFrameworkApplication.wZ),new la.a(()=>Object(vb.a)()),new la.a(()=>n.AFrameworkApplication.ha),new la.a(()=>k.a.instance.resolve("Common.IRenameProps")))}}Zb.uVl="Content-Type";Zb.vVl="application/json; charset=utf-8";Zb.fqn="renamehandler.ashx";Zb.hqn="qs";Zb.gqn="n";Zb.jqn="sl";Zb.eqn="X-CoauthLockId";Zb.kqn="u";Zb.Qa=null;Object(m.a)(Zb,"ExecuteRenameFileHandler",null,[]);class qc{constructor(){this.$G=this.px=
null;this.uAm=!1}}Object(m.a)(qc,"ExecuteRefreshFilenameData",null,[]);class pc{constructor(){this.$G=this.px=this.qvm=null}}Object(m.a)(pc,"ExecuteRenameFileData",null,[]);class ac{constructor(){this.Oa=null;this.gai=Zb.instance;this.uu=()=>{n.AFrameworkApplication.uae()&&(Zb.instance.init(this.Oa,n.AFrameworkApplication.cEe),n.AFrameworkApplication.Dkd=Object(da.a)(this,this.Dkd,"executeRenameFile"),n.AFrameworkApplication.HXb=Object(da.a)(this,this.HXb,"executeRefreshFilename"),n.AFrameworkApplication.p5e=
Object(da.a)(this,this.p5e,"sendFileNameAndLocationUpdateNotification"))}}get name(){return"Common.App.RenameFile.RenameExecutor"}oc(ja){this.Oa=ja}init(){n.AFrameworkApplication.ha.Wf(this.uu)}Dkd(ja,qb,V){const Ea=new pc;Ea.qvm=ja;Ea.px=qb;Ea.$G=V;this.gai.Dkd(Ea)}HXb(ja,qb,V){const Ea=new qc;Ea.px=ja;Ea.$G=qb;Ea.uAm=V;this.gai.HXb(Ea)}p5e(){this.gai.rkm()}dispose(){}}Object(m.a)(ac,"PackageManager",null,[4,5]);class gb{constructor(ja,qb,V,Ea,Za,ia){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=
null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=ja;this.WebAffinitizedUrl=qb;this.PolicyCookie=V;this.PolicyCookieTTL=Ea;this.WasServiceDown=Za;this.AffinitizedUrl=ia}}Object(m.a)(gb,"SafeLinksData",null,[]);class Jb{constructor(ja,qb){this.Q0h=ja;this.yE=qb}}Object(m.a)(Jb,"SafeLinksGetUrlReputationRequestData",null,[]);class uc{constructor(ja,qb,V,Ea){this.ZRn=Za=>{let ia="OnGetUrlReputationSuccessCallback: ",Va=10;const Ab=Za.data.state;try{const gc=
ec.b(Za.data.responseData).reputationResults[0],Hc=gc.navigateUrl.length,fd=Ab.Q0h.length,hd=gc.navigateUrl===Ab.Q0h;gc.navigateUrl&&0<gc.navigateUrl.length&&(Ab.Q0h=gc.navigateUrl);ia+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",Za.data.Je,gc.verdict,fd.toString(),Hc.toString(),hd.toString());Va=50}catch(gc){ia+=String.format("Exception {0}",gc.message)}this.W5l(Ab,ia,Va)};this.YRn=Za=>{let ia="OnGetUrlReputationFailureCallback: ";
const Va=Za.data.state;try{ia+=String.format("HttpStatus {0}",Za.data.Je)}catch(Ab){ia+=String.format("Exception {0}",Ab.message)}this.W5l(Va,ia,10)};this.Ga=ja;this.Dn=qb;this.eOm=V;uc.zo=Ea}ovh(ja,qb,V){try{var Ea=null;uc.zo&&(Ea=uc.zo.Xl("WebServiceCall","SafeLinksGetUrlReputation"));const Za=new Jb(qb,Ea);Ea={};Ea.AffinitizedUrl=ja;Ea.TargetUrl=qb;Ea.PolicyCookie=V;const ia=ec.c(Ea);this.Dn.ik(this.eOm,2,ia,null,!1,2,this.ZRn,this.YRn,Za,void 0,void 0,3E3,3E3,"36");return!0}catch(Za){r.ULS.sendTraceTag(588788033,
378,10,Za.message)}return!1}W5l(ja,qb,V){ja.yE&&(ja.yE.stop(),ja.yE=null);r.ULS.sendTraceTag(588788034,378,V,qb);kc.a.Go(ja.Q0h,void 0,"noopener,noreferrer","SafeLinksNav")}}uc.zo=null;Object(m.a)(uc,"SafeLinksNavigationHelper",null,[]);var Cc;(function(ja){ja[ja.owo=0]="enabledByPolicy";ja[ja.vYl=1]="disabledByPolicy";ja[ja.fwo=2]="disabled_GetPolicyFailure";ja[ja.gwo=3]="disabled_PendingGetPolicyRequest"})(Cc||(Cc={}));Object(m.b)("SafeLinksNavigationState",Cc);var Gc=a(394),dd=a(198),ld=a(653),
bc=a(132);class cc{constructor(ja,qb,V,Ea=!1,Za=null,ia=null){this.hzd=this.gzd=0;this.Rgg=this.tDh=!1;this.dhd=null;this.kSe=!0;this.LEh=null;this.Nkn=gc=>{let Hc=F.a.fkm,fd="";try{this.tDh=this.Rgg=!1;var hd=gc.data.state;const ka=({yE:hd}=this.L6e(hd)).returnValue,ra=Object.assign({},{durationMs:ka});Qb.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",ra);r.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",
gc.data.Je,gc.data.responseData.length,ka);if(gc.data.Je!==F.a.KB)fd="Unexpected httpStatus: "+gc.data.Je.toString();else{hd=null;try{hd=ec.b(gc.data.responseData)}catch(xb){fd="Exception:"+xb.toString()+" deserializing response";return}if(hd){var yd=hd.IsSafeLinksEnabled;if(void 0===yd||null===yd||0>=yd.length)fd="Invalid isSafeLinksEnabledString";else{r.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",yd);var Md=cc.jEk(yd);if(void 0===hd.WebAffinitizedUrl||null===hd.WebAffinitizedUrl||
0>=hd.WebAffinitizedUrl.length)fd="Invalid WebAffinitizedUrl";else if(void 0===hd.PolicyCookie||null===hd.PolicyCookie||0>=hd.PolicyCookie.length)fd="Invalid PolicyCookie";else if(void 0===hd.PolicyCookieTTL||null===hd.PolicyCookieTTL)fd="Invalid PolicyCookieTTL";else{var te=hd.WebAffinitizedUrl,Pe=hd.PolicyCookie,t=hd.AffinitizedUrl,L=new Date;L.setMinutes(L.getMinutes()+(5<hd.PolicyCookieTTL?hd.PolicyCookieTTL-5:0));var S=new gb(yd,te,Pe,L.getTime(),!1,t);this.Txm(S);Hc=gc.data.Je;this.dhd&&(Md?
(this.pDm(this.dhd),this.hzd=this.gzd=0):(r.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),Qb.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),kc.a.KWd(this.dhd)),this.dhd=null)}}}else fd="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(ka){fd="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+ka.toString()}finally{Hc!==F.a.KB&&this.V5l(Hc,fd)}};this.Mkn=gc=>{this.tDh=
!1;let Hc=500,fd="";try{let hd=gc.data.state;const yd=({yE:hd}=this.L6e(hd)).returnValue,Md=Object.assign({},{durationMs:yd});Hc=gc.data.Je;Qb.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+Hc.toString(),!1,!0,Md);fd="Request Failed, Status="+ld.a[gc.data.status]+" Duration: "+yd}catch(hd){fd="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+hd.toString()}finally{this.V5l(Hc,fd)}};r.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");
this.Ga=ja;this.Dn=qb;this.zz=V;cc.zo=ia;this.BSm=Ea?this.Ga.Ma("SafeLinksHandlerWebServiceBase"):this.Ga.Ma("WebServiceBase");this.vSm=this.Ga.Ma("SafeLinksHashedUserId");this.gpo=this.Ga.Ma("SafeLinksWorkloadIdHeaderValue");this.UDh=this.Ga.Ac("SafeLinksMaxGetPolicyBootRetries",2);this.VDh=this.Ga.Ac("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.FDh=this.nyn();this.EDh=this.myn();cc.COl=this.Ga.Ma("UserPrincipalName")||"";cc.oOl=this.Ga.Ma("TenantId")||"";r.ULS.sendTraceTag(26019599,378,50,
"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.FDh,this.EDh);if(this.FDh&&this.EDh){qb=(ja=this.jld())?ja.IsSafeLinksEnabled.toLowerCase():"";V=this.hWj();r.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",qb,V);var Va=!ja||"unknown"===qb||ja.WasServiceDown||V,Ab=$a.a.Bx();Ab&&(Ab.set("shouldGetSafeLinksDataFromServer",Va.toString()),Ab.set("isSafeLinksEnabledCacheValue",qb.toString()));Za?(this.kSe=!1,Za.execute(gc=>
{gc.isFeatureEnabled("MsoUrlreputation",!0).then(Hc=>{this.kSe=Hc;Ab.set("isUserLicensedForSafeLinks",this.kSe.toString());Qb.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",wa.b.FailureBased,"jpittsdirects",Ab);this.kSe&&Va&&this.eMh(!0);return null})})):(Qb.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",wa.b.FailureBased,"jpittsdirects",Ab),Va&&this.eMh(!0))}}get appName(){return this.zz}get D2h(){return this.BSm}get userId(){return this.vSm}get m5l(){try{if(""===cc.tbi){const ja={};
ja["X-AppName"]=this.appName;ja["X-AppVersion"]=n.AFrameworkApplication.buildVersion;ja.OS=this.Ga.Ma("PlatformNameAndVersion")||"";const qb=JSON.stringify(ja);cc.tbi=window.self.btoa(qb)}}catch(ja){r.ULS.sendTraceTag(508909765,378,10,"GetUrlReputationAdditionalProperties Error: {0}",ja.message)}return cc.tbi}get Ujn(){const ja=this.D2h?this.D2h+"/":"",qb=new dd.QueryStringBuilder("SafeLinksHandler.ashx");qb.ej("app",this.appName);this.Ga.getBooleanAppSetting("SafeLinksUseDebugHeader")&&qb.ej("action",
"debug");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&qb.ej("s2satpop","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&qb.ej("s2se03","1");return String.format("{0}{1}&{2}",ja,qb.toString(),n.AFrameworkApplication.Fh)}get inn(){const ja=this.D2h?this.D2h+"/":"",qb=new dd.QueryStringBuilder("SafeLinksHandler.ashx");qb.ej("app",this.appName);this.Ga.getBooleanAppSetting("SafeLinksUseDebugHeader")&&qb.ej("action",
"debug");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&qb.ej("s2satpop","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&qb.ej("s2saat","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&qb.ej("s2se03","1");this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&qb.ej("sladpar",this.m5l);qb.ej("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",
ja,qb.toString(),n.AFrameworkApplication.Fh)}get JOn(){cc.yji||(cc.yji=new uc(this.Ga,this.Dn,this.inn,cc.zo));return cc.yji}ovh(ja){if(!ja)return r.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var qb=this.qxn(ja);r.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",qb,this.FDh,this.EDh,this.kSe);if(!(qb&&this.FDh&&this.EDh&&this.kSe))return!1;
qb=0;const V=({state:qb}=this.Hdo()).returnValue;r.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",Cc[qb]);const Ea=$a.a.Bx();Ea&&Ea.set("SafeLinksNavigationState",Cc[qb]);Qb.Health.instance.recordKpiUsage("SafeLinksNavigations",wa.b.FailureBased,"jpittsdirects",Ea);if(!V)return 2!==qb&&3!==qb||Qb.Health.instance.recordKpiFailure("SafeLinksNavigations",Cc[qb],!1,!0,null),!1;r.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");
if(this.Pdo())return this.hWj()?!1:this.JOn.ovh(this.Vdn(),ja,this.Q3l());if(!this.hWj())return this.pDm(ja),!0;this.dhd=ja;r.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.Rgg=!1;this.eMh();return!0}qxn(ja){ja=ja.toLowerCase();const qb=this.Ga.Fz("SafeLinksUnsupportedProtocols");if(qb)for(let V=0;V<qb.length;V++)if(ja.startsWith(qb[V]))return!1;return!0}eMh(ja=!1){var qb=$a.a.Bx();qb&&qb.set("isOnBootRequest",ja.toString());Qb.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",
wa.b.SuccessBased,"jpittsdirects",qb);Qb.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",wa.b.FailureBased,"jpittsdirects",qb);qb=this.MKf("SafeLinksGetPolicy");this.Dn.ik(this.Ujn,1,null,null,!0,2,this.Nkn,this.Mkn,qb,void 0,void 0,void 0,void 0,"23");this.Rgg=ja;this.tDh=!0;ja?this.gzd++:this.hzd++}V5l(ja,qb=""){try{if(r.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",ja,qb),this.gzd<this.UDh&&this.hzd<this.VDh)this.eMh(this.Rgg);else{this.Rgg=
!1;r.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",this.gzd,this.hzd,ja,qb);qb=null;const V=$a.a.Bx();V&&(V.set("HttpStatus",ja.toString()),qb=Object.assign({},{extendedProperties:V}));Qb.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,qb);const Ea=new gb("false","","",0,!0,"");this.Txm(Ea);this.dhd&&(r.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}",
"disabled_GetPolicyFailure"),Qb.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",!1,!0,null),kc.a.KWd(this.dhd),this.dhd=null)}}catch(V){r.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",V.toString())}}pDm(ja){const qb=this.Q3l(),V=this.vnn(),Ea={};Ea.Url=ja;Ea.SafeLinksCookie=qb;Ea.CorrelationId=bc.a.create().toString();Ea.WorkloadId=this.gpo;Ea.UserAgentInfo=dc.a.Uy+"|"+this.appName;this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",
!1)&&(Ea.User=cc.COl,Ea.TenantId=cc.oOl,Ea.AdditionalProperties=this.m5l);r.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",Ea.CorrelationId);kc.a.N4c(kc.a.DJa(4),V,Ea)}nyn(){const ja=this.Ga.Ma("IsSafeLinksEnabledForUser");return ja?cc.jEk(ja):!1}myn(){const ja=this.Ga.Fz("SafeLinksDisabledBrowsers");if(dc.a.WV){if(this.Ga.Zt("SafeLinksForTeamsIsEnabled")&&this.Ga.getBooleanAppSetting("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(ja,"Electron"))return!1}else if(Array.contains(ja,
dc.a.Uy))return!1;return"officecomhwa"===(this.Ga.Ma(n.AFrameworkApplication.DF)||"").toLowerCase()?!1:!0}Pdo(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&dc.a.Rlc?!0:dc.a.WV||dc.a.olg}Hdo(){let ja;ja=0;const qb=this.jld(),V=qb?qb.IsSafeLinksEnabled:"";if(""!==V)return qb.WasServiceDown?(r.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):
"false"===V.toLowerCase()?(r.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:cc.jEk(V),state:ja};if(this.tDh)return ja=3,r.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:ja};if(this.gzd>=this.UDh||this.hzd>=this.VDh)return ja=2,r.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.gzd,this.UDh,this.hzd,this.VDh),{returnValue:!1,
state:ja};r.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.UDh+this.VDh-(this.gzd+this.hzd));return{returnValue:!0,state:ja}}Q3l(){const ja=this.jld();return ja?ja.PolicyCookie:""}vnn(){const ja=this.jld();return ja?ja.WebAffinitizedUrl:""}Vdn(){const ja=this.jld();return ja?ja.AffinitizedUrl:""}Zgn(){const ja=new Date;try{const qb=this.jld();ja.setTime(qb?
qb.PolicyCookieTTL:0)}catch(qb){r.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",qb)}return ja}hWj(){const ja=this.Zgn();return!!ja&&ja.getTime()<Date.now()}jld(){if(!this.LEh){const ja=Gc.a.instance.getItem(this.userId);if(!ja||""===ja)return null;this.LEh=JSON.parse(ja)}return this.LEh}Txm(ja){if(void 0===ja||null===ja)throw Error.argumentNull("safeLinksData");if(void 0===ja.IsSafeLinksEnabled||null===ja.IsSafeLinksEnabled||0>=ja.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");
this.LEh=ja;ja.WasServiceDown||this.kpo(ja)}kpo(ja){ja=JSON.stringify(ja);Gc.a.instance.setItem(this.userId,ja)}MKf(ja){return void 0!==cc.zo&&null!==cc.zo?cc.zo.Xl("WebServiceCall",ja):null}L6e(ja){if(void 0!==ja&&null!==ja){const qb=ja.ew;ja.stop();return{returnValue:qb,yE:null}}return{returnValue:null,yE:ja}}static jEk(ja){return"false"!==ja.toLowerCase()?!0:!1}}cc.zo=null;cc.yji=null;cc.oOl="";cc.COl="";cc.tbi="";Object(m.a)(cc,"SafeLinksManager",null,[684]);const Vc=ja=>{switch(ja){case 3:return"Word";
case 2:return"PowerPoint";case 1:return"Excel";default:return"Unknown"}},td=ja=>{switch(ja){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};var Xc=a(374);class ne{constructor(){this.ga=null}get name(){return"PowerPointSafeLinks"}oc(ja){this.ga=ja}init(){n.AFrameworkApplication.ha.Wf(Object(da.a)(this,this.uu,"onFullAppSettingsReady"))}uu(){const ja=this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),qb=ja?ja.li:!1;ja.w3e&&(this.ga.register(cc,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").oa().pa(()=>
new cc(n.AFrameworkApplication.ha,n.AFrameworkApplication.$d,String.format("{0}-{1}",Vc(n.AFrameworkApplication.Ha.Ib.Dm),td(n.AFrameworkApplication.Ha.Ib.pTa)),qb)).oa(),this.ga.Db("Common.App.SafeLinks.ISafeLinksManager"))}dispose(){}static main(){I.a.instance.Jc(Xc.a(new ne,0))}}Object(m.a)(ne,"SafeLinksPackage",null,[4,5]);var Vd=a(298),Ja=a(288),Lb=a(1722),fa=a(360),Na=a(107),ha=a(43),sa=a(17),xa=a(215),pb=a(114),Rb=a(1703),Fc=a(1264);class Kc{constructor(ja,qb,V,Ea,Za,ia){this.nK=ja;this._id=
qb;this.A$h=Ea;this.qNm=Za;this.rNm=ia;this.txd=this.currentValue;void 0!==V&&null!==V&&(this.currentValue=V)}get defaultValue(){return this.txd}get lcid(){return this.nK}get id(){return this._id}get currentValue(){return(this.qNm||Kc.PJl)(this.A$h)}set currentValue(ja){(this.rNm||Kc.QJl)(this.A$h,ja)}get mg(){return this.A$h}static Uq(){Kc.PJl=()=>null;Kc.QJl=()=>{}}}Kc.PJl=null;Kc.QJl=null;Object(m.a)(Kc,"GrammarSettingOption",null,[744]);Kc.Uq();class jb{constructor(ja,qb,V){this.C9i=ja;this.n6k=
qb;this.TOn=V}}Object(m.a)(jb,"TwoLevelCacheKey",null,[]);var zb=a(48),ic=a(264),bb=a(3);class Pb extends Ia.a{constructor(ja,qb,V,Ea){super();this.$ii=this.rza=this.pKl=this.Sdf=null;this.Tw=Ea;this.P9h=ja;this.rj=Pb.id;this.QPm=()=>{this.Sdf=V?sa.a.ead(V):{};this.pKl=V?sa.a.ead(V):{};const Za=this.IYm(),ia=Pb.W3m(Za,Pb.v5e(Object(da.a)(this,this.V3m,"createCritiqueTypeSettingsTracker"))(Pb.X1m(Ab=>this.Sdf=Ab)));ia(V||{});var Va=Pb.v5e(Pb.j6m())(Ab=>Ab.cloneNode(!0));Pb.X3m(Za,Pb.I3m(Pb.o5m(qb),
Pb.U3m(Va))(V))(ja.toString());this.$ii=this.yZm();Va=Ab=>{if("click"===Ab.type||Ab.keyCode===xa.a.nv||Ab.keyCode===xa.a.dud)this.Sdf[ja.toString()]={},Za.reset(),Pb.S7n(ia)};pb.a.addHandler(this.asd,ab.a.click,Va);pb.a.addHandler(this.asd,ab.a.oi,Va)};this.Vl=""}get asd(){return this.$ii}qzn(){var ja=Pb.gXk(this.Sdf),qb=Pb.gXk(this.pKl);if(!ja&&!qb)return!1;let V;try{V=ja?Object(Rb.a)(Object,ja[this.P9h.toString()]):{};var Ea=qb?Object(Rb.a)(Object,qb[this.P9h.toString()]):{}}catch(Va){return r.ULS.sendTraceTag(36489288,
375,15,"Parse to dictionary failed"),!1}if(!V&&!Ea)return!1;V=V?V:{};Ea=Ea?Ea:{};ja=String.format("language: {0}",this.P9h.toString());qb=!1;for(const Va in V){var Za=Va,ia=V[Va];Za in Ea&&Ea[Za]===ia||(qb=!0,ja=String.format("{0}, [{1}, {2}]",ja,Za,ia))}for(const Va in Ea)Ea=Va,Ea in V||(qb=!0,ja=String.format("{0}, [{1}, default]",ja,Ea));qb&&r.ULS.sendTraceTag(37319685,375,50,"User changed settings: {0}",ja);return qb}qp(ja,qb,V){super.qp(ja,qb,V);this.G3n()}Gba(ja){return ja.Hc.id===Pb.tvm?!1:
super.Gba(ja)}R9n(){this.Tw.yu().Spd();this.rza=this.Tw.yu().fm.T2}G3n(){this.Tw.yu().scope.kD(Ec.FocusManager.instance().mHb);this.Tw.yu().scope.kD(Ec.FocusManager.instance().nHb);this.Tw.yu().scope.bindAction(Ec.FocusManager.instance().mHb,zb.a.DXe);this.Tw.yu().scope.bindAction(Ec.FocusManager.instance().nHb,zb.a.CXe);this.Tw.yu().scope.bindAction(ub.a.hb(xa.a.e$,0),zb.a.t8f);this.Tw.yu().scope.bindAction(ub.a.hb(xa.a.Sea,0),zb.a.s8f);this.Tw.yu().scope.bindAction(ub.a.hb(xa.a.HY,0),zb.a.t8f);
this.Tw.yu().scope.bindAction(ub.a.hb(xa.a.N1,0),zb.a.s8f)}get settings(){return Pb.gXk(this.Sdf)}fZa(){super.fZa();this.QPm()}IYm(){const ja=Pb.WYm(),qb=Pb.ZCf("WACDialogRow",ja);this.jS.insertBefore(qb,this.jS.firstChild);return ja}V3m(ja){const qb=Fc.a.merge(null,ja);return V=>{V.currentValue===(ja&&ja[V.lcid]?ja[V.lcid][V.id]:null)||V.currentValue!==V.defaultValue?Pb.G3l(qb,V.lcid)[V.id]=V.currentValue:delete Pb.G3l(qb,V.lcid)[V.id];this.rza=this.qhn(V.mg);return qb}}qhn(ja){return ja?(ja=ja.getElementsByTagName(Sys.UI.DomElement.containsCssClass(ja,
Pb.Wzn)?"select":"input"))?ja[0]:null:null}dispose(){this.asd&&(pb.a.bYh(this.asd),this.$ii=null);super.dispose()}yZm(){const ja=document.createElement("input");ja.id=Pb.tvm;ja.type="reset";ja.setAttribute("form",Pb.$0l);ja.className="WACButton WACDialogButtonNormal GrammarSettingsDialogResetButton";ja.value=CommonUIStrings.l_ResetAll;const qb=Pb.ZCf("GrammarSettingsDialogResetButtonContainer",ja),V=document.getElementById("WACDialogButtonPanel");V.parentNode.insertBefore(qb,V);return ja}static get IMf(){return"CritiqueType"}static X1m(ja){return qb=>
V=>ja(qb(V))}static v5e(ja){return qb=>V=>qb(ja(V))}static gXk(ja){const qb={};sa.a.forEach(ja,(V,Ea)=>{0<ic.a(Ea).length&&(qb[V]=Ea)},null);return qb}static WYm(){const ja=document.createElement("form");ja.id=Pb.$0l;Sys.UI.DomElement.addCssClass(ja,"WACDialogList");Sys.UI.DomElement.addCssClass(ja,Pb.u6m);return ja}static W3m(ja,qb){const V=Pb.o3n(ja,ab.a.change);return Ea=>{const Za=qb(Ea);V(ia=>{ia=ia.target.parentNode;Sys.UI.DomElement.containsCssClass(ia,Pb.IMf)&&Za(ia[Pb.bSl])})}}static o3n(ja,
qb){let V=null;return Ea=>{V&&pb.a.removeHandler(ja,qb,V);pb.a.addHandler(ja,qb,Ea);V=Ea}}static G3l(ja,qb){return ja[qb]=ja[qb]||{}}static S7n(ja){r.ULS.sendTraceTag(36489289,375,50,"User click reset all button");ja(null)}static o5m(ja){let qb=null;return V=>{qb=V;return ja.request(Number.parseInvariant(V)).CWRCo(Ea=>qb===V?Ea.result:null,Pb.WWi)}}static X3m(ja,qb){const V=Pb.Cen(Ea=>Pb.Vio(Ea.children));return Ea=>{const Za=V(Ea,ja);ja.innerHTML="";(Za?bb.Task.zG(Za):qb(Ea)).continueWith(ia=>{ia=
ia.result;for(let Va=0;Va<ia.length;Va++)ja.appendChild(ia[Va])},Pb.WWi)}}static I3m(ja,qb){return V=>Ea=>ja(Ea).CWRCo(Za=>z.toArray(z.select(z.asEnumerable(Za.result),ia=>qb(V,ia,Ea))),Pb.WWi)}static Vio(ja){const qb=[];for(let V=0;V<ja.length;V++)qb.push(ja[V]);return qb}static Cen(ja){const qb={};let V=null;return(Ea,Za)=>{V&&!qb[V]&&(Za=ja(Za))&&(qb[V]=Za);V=Ea;return qb[Ea]}}static j6m(){const ja={};return qb=>{ja[qb.C9i]=ja[qb.C9i]||{};const V=ja[qb.C9i];V[qb.n6k]=V[qb.n6k]||qb.TOn();return V[qb.n6k]}}static U3m(ja){return(qb,
V,Ea)=>{const Za=ja(new jb(Ea,V.Id,()=>Pb.PYm(V)));Za.setAttribute("role","group");const ia=Pb.OTl+V.Name;Za.setAttribute("aria-labelledby",ia);for(const Va of V.CritiqueTypeInfoList){const Ab=Pb.fdn(Ea,Va,qb,ja);Za.appendChild(Ab);Ab.setAttribute("aria-labelledby",ia)}return Za}}static fdn(ja,qb,V,Ea){Ea=Ea(new jb(ja,qb.Id,()=>qb.IsBinaryCritiqueType?Pb.NYm(qb):Pb.rZm(qb)));ja=new Kc(ja,qb.Id,V&&V[ja]?V[ja][qb.Id]:null,Ea,qb.IsBinaryCritiqueType?Za=>Za.children[0].checked:Za=>Za.children[1].selectedIndex,
qb.IsBinaryCritiqueType?(Za,ia)=>{Za.children[0].checked=ia}:(Za,ia)=>{Za.children[1].selectedIndex=ia});Ea[Pb.bSl]=ja;return Ea}static PYm(ja){ja=Pb.QYm(ja.Name);ja.className="WACWritingStylesDialogCategoryTitle";return Pb.ZCf("CritiqueCategory",ja)}static NYm(ja){const qb=Pb.RYm();qb.id=ja.Id;0<ja.DefaultCritiqueValue&&qb.setAttribute("checked","checked");ja=Pb.ASl(ja.Name,ja.Id);ja.className="WACDialogLabel";const V=Pb.ZCf(Pb.IMf,qb,ja);V.appendChild(qb);V.appendChild(ja);return V}static rZm(ja){ja=
Pb.hZm(ja.Id,ja.Name,Pb.uZm(ja.CritiqueTypeValues,ja.DefaultCritiqueValue),ja.DefaultCritiqueValue);Sys.UI.DomElement.addCssClass(ja,Pb.IMf);return ja}static uZm(ja,qb){return z.toArray(z.Si(z.asEnumerable(ja||[]),(V,Ea)=>{V=Pb.tZm(V,Ea.toString());Ea===qb&&V.setAttribute("selected","selected");return V}))}static hZm(ja,qb,V,Ea){qb=Pb.ASl(qb,ja);const Za=document.createElement("select");Za.id=ja;Za.className="WACDialogList";V=V||[];for(ja=0;ja<V.length;ja++)Za.appendChild(V[ja]),Ea===ja&&(V[ja].selected=
!0);return Pb.ZCf("GrammarSettingsDialogLabeledInlineList",qb,Za)}static tZm(ja,qb){const V=document.createElement("option");V.text=ja;V.value=qb;return V}static RYm(){const ja=document.createElement("input");ja.type="checkbox";ja.className="WACDialogCheckBox";return ja}static ASl(ja,qb){const V=document.createElement("label");V.innerText=ja;V.setAttribute("for",qb);return V}static QYm(ja){const qb=document.createElement("div");qb.innerText=ja;qb.id=Pb.OTl+ja;return qb}static ZCf(ja=null,...qb){const V=
document.createElement("div");V.className=ja;for(const Ea of qb)V.appendChild(Ea);return V}}Pb.id="GrammarSettingsDialog";Pb.$0l="CritiqueTypeSettings";Pb.u6m="CritiquesList";Pb.Wzn="GrammarSettingsDialogLabeledInlineList";Pb.tvm="ResetButton";Pb.OTl="WritingStylesCategory_";Pb.WWi=11;Pb.bSl="CritiqueType";Object(m.a)(Pb,"GrammarSettingsDialog",Ia.a,[]);var wc=a(192),Dc=a(341),ed=a(1099),ad=a(52),Gd=a(332),Od=a(83),Ld=a(175),ee=a(66),Ce=a(1197),Pc=a(40),Yc=a(44);class Bd{constructor(){this.Color=
null;this.Transparency=this.Scale=this.EffectDataPropType=this.Degree=0}}Object(m.a)(Bd,"EffectDataInfo",null,[]);var Dd=a(1199);class Sd{constructor(){this.EffectType=this.EffectId=0;this.FRemoveExisting=!1;this.ShapeIds=null}}Object(m.a)(Sd,"AddAnimationInfo",null,[]);class He{constructor(){this.TargetEffects=null}}Object(m.a)(He,"DeleteAnimationInfo",null,[]);class ge{constructor(){this.EffectNodeId=0;this.ShapeId=null}}Object(m.a)(ge,"TargetEffect",null,[]);class ve{constructor(){this.EffectType=
this.EffectId=0;this.IsReplaceShapeAnimations=!1;this.TargetEffects=null}}Object(m.a)(ve,"ReplaceAnimationInfo",null,[]);class ze{constructor(){this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.ModifyAnimPropType=0;this.TargetEffects=null}}Object(m.a)(ze,"ModifyAnimationInfo",null,[]);class bf{constructor(){this.StartType=0;this.TargetEffects=null}}Object(m.a)(bf,"ChangeAnimationRelationshipInfo",null,[]);var Of=a(380),Qf=a(163),Oe=a(102);class tg{constructor(){this.BuildType=0;
this.TargetEffects=null}}Object(m.a)(tg,"ChangeAnimationBuildTypeInfo",null,[]);class Cf{constructor(){this.IsLater=!1;this.TargetEffects=this.RefEffect=null}}Object(m.a)(Cf,"ReorderAnimationEffectsInfo",null,[]);var oe=a(42),Rf=a(51),Uf=a(55),gf=a(144),gg=a(1263),Ve=a(291),hf=a(599);class ef{constructor(){this.effectId=this.effectType=0;this.labelText=this.$k=this.effectData=this.xG=null}}Object(m.a)(ef,"AnimInfo",null,[]);class Ga{constructor(){this.Ex=this.labelText=this.$k=this.id=null}}Object(m.a)(Ga,
"EffectOption",null,[]);class hb extends Ga{constructor(){super();this.value=null}}Object(m.a)(hb,"EffectData",Ga,[]);class Hb{constructor(ja){this.d4b=ja;Hb.pC||(Hb.pC=new gg.a,Hb.pC.add("FromBottom",Object.assign(new Ga,{id:"FromBottom",$k:Hb.em("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottom,Ex:CommonUIStrings.l_AnimationFromBottomKeytip})),Hb.pC.add("FromBottomLeft",Object.assign(new Ga,{id:"FromBottomLeft",$k:Hb.em("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomLeft,
Ex:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),Hb.pC.add("FromLeft",Object.assign(new Ga,{id:"FromLeft",$k:Hb.em("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromLeft,Ex:CommonUIStrings.l_AnimationFromLeftKeytip})),Hb.pC.add("FromTopLeft",Object.assign(new Ga,{id:"FromTopLeft",$k:Hb.em("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopLeft,Ex:CommonUIStrings.l_AnimationFromTopLeftKeytip})),Hb.pC.add("FromTop",Object.assign(new Ga,
{id:"FromTop",$k:Hb.em("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTop,Ex:CommonUIStrings.l_AnimationFromTopKeytip})),Hb.pC.add("FromTopRight",Object.assign(new Ga,{id:"FromTopRight",$k:Hb.em("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopRight,Ex:CommonUIStrings.l_AnimationFromTopRightKeytip})),Hb.pC.add("FromRight",Object.assign(new Ga,{id:"FromRight",$k:Hb.em("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromRight,
Ex:CommonUIStrings.l_AnimationFromRightKeytip})),Hb.pC.add("FromBottomRight",Object.assign(new Ga,{id:"FromBottomRight",$k:Hb.em("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomRight,Ex:CommonUIStrings.l_AnimationFromBottomRightKeytip})),Hb.pC.add("ToBottom",Object.assign(new Ga,{id:"ToBottom",$k:Hb.em("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottom,Ex:CommonUIStrings.l_AnimationFromBottomKeytip})),Hb.pC.add("ToBottomLeft",
Object.assign(new Ga,{id:"ToBottomLeft",$k:Hb.em("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomLeft,Ex:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),Hb.pC.add("ToLeft",Object.assign(new Ga,{id:"ToLeft",$k:Hb.em("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToLeft,Ex:CommonUIStrings.l_AnimationFromLeftKeytip})),Hb.pC.add("ToTopLeft",Object.assign(new Ga,{id:"ToTopLeft",$k:Hb.em("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopLeft,
Ex:CommonUIStrings.l_AnimationFromTopLeftKeytip})),Hb.pC.add("ToTop",Object.assign(new Ga,{id:"ToTop",$k:Hb.em("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionToTop,Ex:CommonUIStrings.l_AnimationFromTopKeytip})),Hb.pC.add("ToTopRight",Object.assign(new Ga,{id:"ToTopRight",$k:Hb.em("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopRight,Ex:CommonUIStrings.l_AnimationFromTopRightKeytip})),Hb.pC.add("ToRight",Object.assign(new Ga,{id:"ToRight",
$k:Hb.em("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToRight,Ex:CommonUIStrings.l_AnimationFromRightKeytip})),Hb.pC.add("ToBottomRight",Object.assign(new Ga,{id:"ToBottomRight",$k:Hb.em("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomRight,Ex:CommonUIStrings.l_AnimationFromBottomRightKeytip})),Hb.pC.add("Horizontal",Object.assign(new Ga,{id:"Horizontal",$k:Hb.em("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,
Ex:CommonUIStrings.l_AnimationHorizontalKeytip})),Hb.pC.add("HorizontalIn",Object.assign(new Ga,{id:"HorizontalIn",$k:Hb.em("AnimEffectPropHorizontalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalIn,Ex:CommonUIStrings.l_AnimationHorizontalInKeytip})),Hb.pC.add("HorizontalOut",Object.assign(new Ga,{id:"HorizontalOut",$k:Hb.em("AnimEffectPropHorizontalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalOut,Ex:CommonUIStrings.l_AnimationHorizontalOutKeytip})),Hb.pC.add("Vertical",
Object.assign(new Ga,{id:"Vertical",$k:Hb.em("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Ex:CommonUIStrings.l_AnimationVerticalKeytip})),Hb.pC.add("VerticalIn",Object.assign(new Ga,{id:"VerticalIn",$k:Hb.em("AnimEffectPropVerticalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalIn,Ex:CommonUIStrings.l_AnimationVerticalInKeytip})),Hb.pC.add("VerticalOut",Object.assign(new Ga,{id:"VerticalOut",$k:Hb.em("AnimEffectPropVerticalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalOut,
Ex:CommonUIStrings.l_AnimationVerticalOutKeytip})),Hb.pC.add("LeftDown",Object.assign(new Ga,{id:"LeftDown",$k:Hb.em("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftDown,Ex:CommonUIStrings.l_AnimationLeftDownKeytip})),Hb.pC.add("LeftUp",Object.assign(new Ga,{id:"LeftUp",$k:Hb.em("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftUp,Ex:CommonUIStrings.l_AnimationLeftUpKeytip})),Hb.pC.add("RightDown",Object.assign(new Ga,{id:"RightDown",
$k:Hb.em("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightDown,Ex:CommonUIStrings.l_AnimationRightDownKeytip})),Hb.pC.add("RightUp",Object.assign(new Ga,{id:"RightUp",$k:Hb.em("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightUp,Ex:CommonUIStrings.l_AnimationRightUpKeytip})),Hb.pC.add("In",Object.assign(new Ga,{id:"In",$k:Hb.em("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionIn,Ex:CommonUIStrings.l_AnimationInKeytip})),
Hb.pC.add("InBottom",Object.assign(new Ga,{id:"InBottom",$k:Hb.em("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInToScreenBottom,Ex:CommonUIStrings.l_AnimationInToScreenBottomKeytip})),Hb.pC.add("InCenter",Object.assign(new Ga,{id:"InCenter",$k:Hb.em("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInCenter,Ex:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),Hb.pC.add("InSlightly",Object.assign(new Ga,{id:"InSlightly",$k:Hb.em("AnimEffectPropIn"),
labelText:ResourceStrings.L_EffectOptionsDirectionInSlightly,Ex:CommonUIStrings.l_AnimationInSlightlyKeytip})),Hb.pC.add("Out",Object.assign(new Ga,{id:"Out",$k:Hb.em("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOut,Ex:CommonUIStrings.l_AnimationOutKeytip})),Hb.pC.add("OutBottom",Object.assign(new Ga,{id:"OutBottom",$k:Hb.em("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutBottom,Ex:CommonUIStrings.l_AnimationOutFromScreenBottomKeytip})),Hb.pC.add("OutCenter",
Object.assign(new Ga,{id:"OutCenter",$k:Hb.em("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutToScreenCenter,Ex:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),Hb.pC.add("OutSlightly",Object.assign(new Ga,{id:"OutSlightly",$k:Hb.em("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutSlightly,Ex:CommonUIStrings.l_AnimationOutSlightlyKeytip})),Hb.pC.add("FloatUp",Object.assign(new Ga,{id:"FloatUp",$k:Hb.em("AnimEffectPropFloatUp"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatUp,
Ex:CommonUIStrings.l_AnimationOutKeytip})),Hb.pC.add("FloatDown",Object.assign(new Ga,{id:"FloatDown",$k:Hb.em("AnimEffectPropFloatDown"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatDown,Ex:CommonUIStrings.l_AnimationDownKeytip})),Hb.pC.add("ObjectCenter",Object.assign(new Ga,{id:"ObjectCenter",$k:Hb.em("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,Ex:CommonUIStrings.l_AnimationObjectCenterKeytip})),Hb.pC.add("SlideCenter",Object.assign(new Ga,
{id:"SlideCenter",$k:Hb.em("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,Ex:CommonUIStrings.l_AnimationSlideCenterKeytip})),Hb.pC.add("ObjectCenterOut",Object.assign(new Ga,{id:"ObjectCenterOut",$k:Hb.em("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,Ex:CommonUIStrings.l_AnimationObjectCenterKeytip})),Hb.pC.add("SlideCenterOut",Object.assign(new Ga,{id:"SlideCenterOut",$k:Hb.em("AnimEffectPropFadedZoomInFromCenter"),
labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,Ex:CommonUIStrings.l_AnimationSlideCenterKeytip})),Hb.pC.add("Clockwise",Object.assign(new Ga,{id:"Clockwise",$k:Hb.em("AnimEffectPropClockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionClockwise,Ex:CommonUIStrings.l_AnimationClockWiseKeytip})),Hb.pC.add("CounterClockwise",Object.assign(new Ga,{id:"CounterClockwise",$k:Hb.em("AnimEffectPropCounterclockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionCounterClockwise,Ex:CommonUIStrings.l_AnimationCounterClockWiseKeytip})),
Hb.pC.add("Across",Object.assign(new Ga,{id:"Across",$k:Hb.em("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionAcross,Ex:CommonUIStrings.l_AnimationAcrossKeytip})),Hb.pC.add("Up",Object.assign(new Ga,{id:"Up",$k:Hb.em("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionUp,Ex:CommonUIStrings.l_AnimationUpKeytip})),Hb.pC.add("Down",Object.assign(new Ga,{id:"Down",$k:Hb.em("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionDown,
Ex:CommonUIStrings.l_AnimationDownKeytip})),Hb.pC.add("GrowShrinkHorizontal",Object.assign(new Ga,{id:"GrowShrinkHorizontal",$k:Hb.em("AnimEffectPropGrowShrinkHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,Ex:CommonUIStrings.l_AnimationHorizontalKeytip})),Hb.pC.add("GrowShrinkVertical",Object.assign(new Ga,{id:"GrowShrinkVertical",$k:Hb.em("AnimEffectPropGrowShrinkVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Ex:CommonUIStrings.l_AnimationVerticalKeytip})),
Hb.pC.add("GrowShrinkBoth",Object.assign(new Ga,{id:"GrowShrinkBoth",$k:Hb.em("AnimEffectPropBoth"),labelText:ResourceStrings.L_EffectOptionsDirectionBoth,Ex:CommonUIStrings.l_AnimationBothKeytip})));Hb.HNa||(Hb.HNa=new gg.a,Hb.HNa.add("Spin_Quarter",Object.assign(new hb,{id:"Spin_Quarter",$k:Hb.em("AnimEffectPropQuarterSpin"),labelText:ResourceStrings.L_EffectOptionsSpinQuarter,value:"90",Ex:CommonUIStrings.l_AnimationQuarterSpinKeytip})),Hb.HNa.add("Spin_Half",Object.assign(new hb,{id:"Spin_Half",
$k:Hb.em("AnimEffectPropHalfSpin"),labelText:ResourceStrings.L_EffectOptionsSpinHalf,value:"180",Ex:CommonUIStrings.l_AnimationHalfSpinKeytip})),Hb.HNa.add("Spin_Full",Object.assign(new hb,{id:"Spin_Full",$k:Hb.em("AnimEffectPropFullSpin"),labelText:ResourceStrings.L_EffectOptionsSpinFull,value:"360",Ex:CommonUIStrings.l_AnimationFullSpinKeytip})),Hb.HNa.add("Spin_Two",Object.assign(new hb,{id:"Spin_Two",$k:Hb.em("AnimEffectPropTwoSpins"),labelText:ResourceStrings.L_EffectOptionsSpinTwo,value:"720",
Ex:CommonUIStrings.l_AnimationTwoSpinKeytip})),Hb.HNa.add("Transparency_25",Object.assign(new hb,{id:"Transparency_25",$k:Hb.em("AnimEffectPropTransparent25"),labelText:ResourceStrings.L_EffectOptionsTransparency25Percent,value:"0.75",Ex:CommonUIStrings.l_Animation25PerKeytip})),Hb.HNa.add("Transparency_50",Object.assign(new hb,{id:"Transparency_50",$k:Hb.em("AnimEffectPropTransparent50"),labelText:ResourceStrings.L_EffectOptionsTransparency50Percent,value:"0.5",Ex:CommonUIStrings.l_Animation50PerKeytip})),
Hb.HNa.add("Transparency_75",Object.assign(new hb,{id:"Transparency_75",$k:Hb.em("AnimEffectPropTransparent75"),labelText:ResourceStrings.L_EffectOptionsTransparency75Percent,value:"0.25",Ex:CommonUIStrings.l_Animation75PerKeytip})),Hb.HNa.add("Transparency_100",Object.assign(new hb,{id:"Transparency_100",$k:Hb.em("AnimEffectPropTransparent100"),labelText:ResourceStrings.L_EffectOptionsTransparency100Percent,value:"0.0",Ex:CommonUIStrings.l_Animation100PerKeytip})),Hb.HNa.add("GrowShrink_Tiny",Object.assign(new hb,
{id:"GrowShrink_Tiny",$k:Hb.em("AnimEffectPropTiny"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkTiny,value:"25",Ex:CommonUIStrings.l_AnimationTinyKeytip})),Hb.HNa.add("GrowShrink_Smaller",Object.assign(new hb,{id:"GrowShrink_Smaller",$k:Hb.em("AnimEffectPropSmaller"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkSmaller,value:"50",Ex:CommonUIStrings.l_AnimationSmallerKeytip})),Hb.HNa.add("GrowShrink_Larger",Object.assign(new hb,{id:"GrowShrink_Larger",$k:Hb.em("AnimEffectPropLarger"),
labelText:ResourceStrings.L_EffectOptionsGrowShrinkLarger,value:"150",Ex:CommonUIStrings.l_AnimationLargerKeytip})),Hb.HNa.add("GrowShrink_Huge",Object.assign(new hb,{id:"GrowShrink_Huge",$k:Hb.em("AnimEffectPropHuge"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkHuge,value:"400",Ex:CommonUIStrings.l_AnimationHugeKeytip})));if(!Hb.xD)if(Hb.xD=new gg.a,Hb.xD.add("Existing",Object.assign(new ef,{effectType:-1,effectId:-1,$k:Hb.em("AnimFxMultiple"),labelText:ResourceStrings.L_AnimationExisting,
xG:[],effectData:[]})),Hb.xD.add("None",Object.assign(new ef,{effectType:0,effectId:0,$k:Hb.em("AnimFxNone"),labelText:ResourceStrings.L_AnimationNone,xG:[],effectData:[]})),Hb.xD.add("Appear",Object.assign(new ef,{effectType:0,effectId:1,$k:Hb.em("AnimFxEntranceAppear"),labelText:ResourceStrings.L_AnimationAppear,xG:[],effectData:[]})),Hb.xD.add("FadeIn",Object.assign(new ef,{effectType:0,effectId:10,$k:Hb.em("AnimFxEntranceFadeIn"),labelText:ResourceStrings.L_AnimationFade,xG:[],effectData:[]})),
this.d4b){Hb.xD.add("FlyIn",Object.assign(new ef,{effectType:0,effectId:2,$k:Hb.em("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,xG:"FromBottom FromBottomLeft FromLeft FromTopLeft FromTop FromTopRight FromRight FromBottomRight".split(" "),effectData:[]}));Hb.xD.add("Wipe",Object.assign(new ef,{effectType:0,effectId:22,$k:Hb.em("AnimFxEntranceWipeIn"),labelText:ResourceStrings.L_AnimationWipe,xG:["FromBottom","FromLeft","FromRight","FromTop"],effectData:[]}));Hb.xD.add("Zoom",Object.assign(new ef,
{effectType:0,effectId:53,$k:Hb.em("AnimFxEntranceFadedZoom"),labelText:ResourceStrings.L_AnimationZoom,xG:["ObjectCenter","SlideCenter"],effectData:[]}));Hb.xD.add("Checkerboard",Object.assign(new ef,{effectType:0,effectId:5,$k:Hb.em("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationCheckerboard,xG:["Across","Down"],effectData:[]}));Hb.xD.add("BasicZoom",Object.assign(new ef,{effectType:0,effectId:23,$k:Hb.em("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBasicZoom,xG:"In InCenter InSlightly Out OutBottom OutSlightly".split(" "),
effectData:[]}));Hb.xD.add("Blinds",Object.assign(new ef,{effectType:0,effectId:3,$k:Hb.em("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBlinds,xG:["Horizontal","Vertical"],effectData:[]}));let qb;Hb.xD.add("Box",(qb=new ef,qb.effectType=0,qb.effectId=4,qb.$k=Hb.em("AnimFxEntranceShape"),qb.labelText=ResourceStrings.L_AnimationBox,qb.xG=["In","Out"],qb.effectData=[],qb));let V;Hb.xD.add("PeekIn",(V=new ef,V.effectType=0,V.effectId=12,V.$k=Hb.em("AnimFxEntranceGeneric"),V.labelText=
ResourceStrings.L_AnimationPeekIn,V.xG=["FromBottom","FromLeft","FromRight","FromTop"],V.effectData=[],V));let Ea;Hb.xD.add("Expand",(Ea=new ef,Ea.effectType=0,Ea.effectId=55,Ea.$k=Hb.em("AnimFxEntranceGeneric"),Ea.labelText=ResourceStrings.L_AnimationExpand,Ea.xG=[],Ea.effectData=[],Ea));let Za;Hb.xD.add("GrowAndTurn",(Za=new ef,Za.effectType=0,Za.effectId=31,Za.$k=Hb.em("AnimFxEntranceGrowAndTurn"),Za.labelText=ResourceStrings.L_AnimationGrowAndTurn,Za.xG=[],Za.effectData=[],Za));let ia;Hb.xD.add("RandomBars",
(ia=new ef,ia.effectType=0,ia.effectId=14,ia.$k=Hb.em("AnimFxEntranceRandomBars"),ia.labelText=ResourceStrings.L_AnimationRandomBars,ia.xG=["Horizontal","Vertical"],ia.effectData=[],ia));let Va;Hb.xD.add("RiseUp",(Va=new ef,Va.effectType=0,Va.effectId=37,Va.$k=Hb.em("AnimFxEntranceGeneric"),Va.labelText=ResourceStrings.L_AnimationRiseUp,Va.xG=[],Va.effectData=[],Va));let Ab;Hb.xD.add("Split",(Ab=new ef,Ab.effectType=0,Ab.effectId=16,Ab.$k=Hb.em("AnimFxEntranceSplit"),Ab.labelText=ResourceStrings.L_AnimationSplit,
Ab.xG=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],Ab.effectData=[],Ab));let gc;Hb.xD.add("Strips",(gc=new ef,gc.effectType=0,gc.effectId=18,gc.$k=Hb.em("AnimFxEntranceGeneric"),gc.labelText=ResourceStrings.L_AnimationStrips,gc.xG=["LeftDown","LeftUp","RightDown","RightUp"],gc.effectData=[],gc));let Hc;Hb.xD.add("Stretch",(Hc=new ef,Hc.effectType=0,Hc.effectId=17,Hc.$k=Hb.em("AnimFxEntranceGeneric"),Hc.labelText=ResourceStrings.L_AnimationStretch,Hc.xG=["Across","FromBottom","FromLeft",
"FromRight","FromTop"],Hc.effectData=[],Hc));let fd;Hb.xD.add("Exit_Disappear",(fd=new ef,fd.effectType=1,fd.effectId=1,fd.$k=Hb.em("AnimFxExitDisappear"),fd.labelText=ResourceStrings.L_AnimationDisappear,fd.xG=[],fd.effectData=[],fd));let hd;Hb.xD.add("Exit_Fade",(hd=new ef,hd.effectType=1,hd.effectId=10,hd.$k=Hb.em("AnimFxExitFadeOut"),hd.labelText=ResourceStrings.L_AnimationFade,hd.xG=[],hd.effectData=[],hd));let yd;Hb.xD.add("Exit_FlyOut",(yd=new ef,yd.effectType=1,yd.effectId=2,yd.$k=Hb.em("AnimFxExitFlyOut"),
yd.labelText=ResourceStrings.L_AnimationFlyOut,yd.xG="ToBottom ToBottomLeft ToLeft ToTopLeft ToTop ToTopRight ToRight ToBottomRight".split(" "),yd.effectData=[],yd));let Md;Hb.xD.add("Exit_Wipe",(Md=new ef,Md.effectType=1,Md.effectId=22,Md.$k=Hb.em("AnimFxExitWipe"),Md.labelText=ResourceStrings.L_AnimationWipe,Md.xG=["FromBottom","FromLeft","FromRight","FromTop"],Md.effectData=[],Md));let te;Hb.xD.add("Exit_Zoom",(te=new ef,te.effectType=1,te.effectId=53,te.$k=Hb.em("AnimFxExitFadedZoom"),te.labelText=
ResourceStrings.L_AnimationZoom,te.xG=["ObjectCenterOut","SlideCenterOut"],te.effectData=[],te));let Pe;Hb.xD.add("Exit_Checkerboard",(Pe=new ef,Pe.effectType=1,Pe.effectId=5,Pe.$k=Hb.em("AnimFxExitGeneric"),Pe.labelText=ResourceStrings.L_AnimationCheckerboard,Pe.xG=["Across","Up"],Pe.effectData=[],Pe));let t;Hb.xD.add("Exit_BasicZoom",(t=new ef,t.effectType=1,t.effectId=23,t.$k=Hb.em("AnimFxExitGeneric"),t.labelText=ResourceStrings.L_AnimationBasicZoom,t.xG="Out OutCenter OutSlightly In InBottom InSlightly".split(" "),
t.effectData=[],t));let L;Hb.xD.add("Exit_Blinds",(L=new ef,L.effectType=1,L.effectId=3,L.$k=Hb.em("AnimFxExitGeneric"),L.labelText=ResourceStrings.L_AnimationBlinds,L.xG=["Horizontal","Vertical"],L.effectData=[],L));let S;Hb.xD.add("Exit_Box",(S=new ef,S.effectType=1,S.effectId=4,S.$k=Hb.em("AnimFxExitShape"),S.labelText=ResourceStrings.L_AnimationBox,S.xG=["In","Out"],S.effectData=[],S));let ka;Hb.xD.add("Exit_PeekOut",(ka=new ef,ka.effectType=1,ka.effectId=12,ka.$k=Hb.em("AnimFxExitGeneric"),ka.labelText=
ResourceStrings.L_AnimationPeekOut,ka.xG=["ToBottom","ToLeft","ToRight","ToTop"],ka.effectData=[],ka));let ra;Hb.xD.add("Exit_RandomBars",(ra=new ef,ra.effectType=1,ra.effectId=14,ra.$k=Hb.em("AnimFxExitRandomBars"),ra.labelText=ResourceStrings.L_AnimationRandomBars,ra.xG=["Horizontal","Vertical"],ra.effectData=[],ra));let xb;Hb.xD.add("Exit_Split",(xb=new ef,xb.effectType=1,xb.effectId=16,xb.$k=Hb.em("AnimFxExitSplit"),xb.labelText=ResourceStrings.L_AnimationSplit,xb.xG=["HorizontalIn","HorizontalOut",
"VerticalIn","VerticalOut"],xb.effectData=[],xb));let Ob;Hb.xD.add("Exit_Strips",(Ob=new ef,Ob.effectType=1,Ob.effectId=18,Ob.$k=Hb.em("AnimFxExitGeneric"),Ob.labelText=ResourceStrings.L_AnimationStrips,Ob.xG=["LeftDown","LeftUp","RightDown","RightUp"],Ob.effectData=[],Ob));let Vb;Hb.xD.add("Exit_Stretchy",(Vb=new ef,Vb.effectType=1,Vb.effectId=17,Vb.$k=Hb.em("AnimFxExitGeneric"),Vb.labelText=ResourceStrings.L_AnimationStretchy,Vb.xG=[],Vb.effectData=[],Vb));let Ac;Hb.xD.add("Exit_Zoom",(Ac=new ef,
Ac.effectType=1,Ac.effectId=53,Ac.$k=Hb.em("AnimFxExitFadedZoom"),Ac.labelText=ResourceStrings.L_AnimationZoom,Ac.xG=["ObjectCenterOut","SlideCenterOut"],Ac.effectData=[],Ac));let $c;Hb.xD.add("Emphasis_Spin",($c=new ef,$c.effectType=2,$c.effectId=8,$c.$k=Hb.em("AnimFxEmphasisSpin"),$c.labelText=ResourceStrings.L_AnimationSpin,$c.xG=["Clockwise","CounterClockwise"],$c.effectData=["Spin_Quarter","Spin_Half","Spin_Full","Spin_Two"],$c));let qd;Hb.xD.add("Emphasis_Transparency",(qd=new ef,qd.effectType=
2,qd.effectId=9,qd.$k=Hb.em("AnimFxEmphasisTransparency"),qd.labelText=ResourceStrings.L_AnimationTransparency,qd.xG=[],qd.effectData=["Transparency_25","Transparency_50","Transparency_75","Transparency_100"],qd));let Fd;Hb.xD.add("Emphasis_GrowShrink",(Fd=new ef,Fd.effectType=2,Fd.effectId=6,Fd.$k=Hb.em("AnimFxEmphasisGrowShrink"),Fd.labelText=ResourceStrings.L_AnimationGrowShrink,Fd.xG=["GrowShrinkHorizontal","GrowShrinkVertical","GrowShrinkBoth"],Fd.effectData=["GrowShrink_Tiny","GrowShrink_Smaller",
"GrowShrink_Larger","GrowShrink_Huge"],Fd));let Ud;Hb.xD.add("Emphasis_FillColor",(Ud=new ef,Ud.effectType=2,Ud.effectId=1,Ud.$k=Hb.em("AnimFxEmphasisChangeFillColor"),Ud.labelText=ResourceStrings.L_AnimationFillColor,Ud.xG=[],Ud.effectData=[],Ud));let ae;Hb.xD.add("Emphasis_FontColor",(ae=new ef,ae.effectType=2,ae.effectId=3,ae.$k=Hb.em("AnimFxEmphasisChangeFontColor"),ae.labelText=ResourceStrings.L_AnimationFontColor,ae.xG=[],ae.effectData=[],ae));let Yd;Hb.xD.add("Emphasis_LineColor",(Yd=new ef,
Yd.effectType=2,Yd.effectId=7,Yd.$k=Hb.em("AnimFxEmphasisChangeLineColor"),Yd.labelText=ResourceStrings.L_AnimationLineColor,Yd.xG=[],Yd.effectData=[],Yd))}else Hb.xD.add("FlyIn",Object.assign(new ef,{effectType:0,effectId:2,$k:Hb.em("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,xG:["FromBottom","FromLeft","FromTop","FromRight"],effectData:[]}))}HWe(ja,qb){let V=null;Hb.xD.forEach((Ea,Za)=>{Za.effectType===ja&&Za.effectId===qb&&(V=Za);return!0});return V}oMh(ja,qb){let V=null;
Hb.xD.forEach((Ea,Za)=>{Za.effectType===ja&&Za.effectId===qb&&(V=Ea);return!0});return V}bMh(ja,qb,V,Ea,Za){const ia=Object.assign(new Ve.a,{Id:"MenuSectionEffectOptions"+V,ControlsId:"MenuSectionEffectOptionsDirection.Controls",DisplayMode:"Menu32",ControlList:[]});ja=this.HWe(qb,ja);if(!ja)return ia;if((ja=Hb.Hgn(ja,V))&&ja.length)for(qb=0;qb<ja.length;qb++){const Va=Hb.Ign(ja[qb],V),Ab="AnimationEffectOptions"+("Direction"===V?"Direction":"Data")+Va.id;Array.add(ia.ControlList,Object.assign(new hf.a,
{Command:Ea,Id:Va.id,ExternalId:Ab,QueryCommand:Za}))}return ia}tLh(ja){var qb;return(qb=Hb.xD.ka(ja))?(ja=qb.effectType,qb=qb.effectId,{returnValue:!0,effectType:ja,effectId:qb}):{returnValue:!1,effectType:-1,effectId:-1}}uLh(ja){let qb,V;qb=Hb.em("AnimFxMultiple");V=ResourceStrings.L_AnimationExisting;if(ja=Hb.xD.ka(ja))qb=ja.$k,V=ja.labelText;return{image:qb,label:V}}wOh(ja,qb){if(0===ja){if(0!==qb&&1!==qb&&2!==qb&&10!==qb)return!0}else if(0<ja)return!0;return!1}H9d(ja,qb){return ja&&qb?this.d4b?
(qb=qb.a1b()?ja.IsTrigger:ja.HasTrigger,!!this.HWe(ja.EffectType,ja.EffectId)&&!qb):!ja.HasExisting:!0}$Oh(ja){return ja?this.VYe(Array(ja)):!0}VYe(ja){if(!ja||!ja.length)return!0;for(const qb of ja)if(null==this.HWe(qb.EffectType,qb.EffectId))return!1;return!0}rUj(ja,qb){return qb&&ja&&this.d4b?qb.a1b()?!1:ja.HasMultiple:!1}Sfg(ja){if(!ja||!ja.length)return!1;const qb=ja[0].EffectId,V=ja[0].EffectType;for(let Ea=1;Ea<ja.length;Ea++){const Za=ja[Ea];if(Za.EffectId!=qb||Za.EffectType!=V)return!0}return!1}s9l(ja){if(ja&&
this.d4b&&2===ja.EffectType)switch(ja.EffectId){case 1:case 3:case 7:return!0}return!1}YZj(ja){if(!ja)return!1;if(2===ja.EffectType)switch(ja.EffectId){case 1:case 3:case 7:return!0}return!1}cgn(ja){ja=Hb.xD.ka(ja);return this.C0f(ja.xG[0])}agn(ja){return(ja=Hb.xD.ka(ja))&&ja.effectData.length?this.vhj(ja.effectData[0]):""}C0f(ja){switch(ja){case "FromBottom":case "ToBottom":return 3;case "FromBottomLeft":case "ToBottomLeft":case "LeftDown":return 8;case "FromLeft":case "ToLeft":return 4;case "FromTopLeft":case "ToTopLeft":case "LeftUp":return 5;
case "FromTop":case "ToTop":return 1;case "FromTopRight":case "ToTopRight":case "RightUp":return 6;case "FromRight":case "ToRight":return 2;case "FromBottomRight":case "ToBottomRight":case "RightDown":return 7;case "Horizontal":case "Across":return 9;case "HorizontalIn":return 15;case "HorizontalOut":return 16;case "Vertical":case "Down":case "Up":return 10;case "VerticalIn":return 17;case "VerticalOut":return 18;case "In":case "ObjectCenter":return 11;case "InCenter":case "SlideCenter":return 22;
case "InBottom":return 23;case "InSlightly":return 21;case "Out":case "ObjectCenterOut":return 12;case "OutBottom":return 26;case "OutSlightly":return 24;case "OutCenter":case "SlideCenterOut":return 25;case "FloatUp":return 1;case "FloatDown":return 3;case "Clockwise":return 13;case "CounterClockwise":return 14;case "GrowShrinkHorizontal":return 27;case "GrowShrinkVertical":return 28;case "GrowShrinkBoth":return 29;default:return 0}}vhj(ja){return(ja=Hb.HNa.ka(ja))?ja.value:""}eVl(ja,qb){return(qb=
Hb.HNa.ka(qb))&&parseFloat(ja)===parseFloat(qb.value)?!0:!1}dqj(ja){switch(ja){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}}C_m(ja){if(null===ja)throw Error.argumentNull("animation");const qb=this.HWe(ja.EffectType,ja.EffectId);return!!qb&&(0<qb.xG.length||0<qb.effectData.length||this.s9l(ja))}D_m(ja){if(!ja)return!1;const qb=this.HWe(ja.EffectType,ja.EffectId);return!!qb&&(0<qb.xG.length||0<qb.effectData.length||this.YZj(ja))}E_m(ja,
qb,V){return this.H9d(V,ja)&&!this.rUj(V,ja)&&(this.C_m(V)||this.vTl(ja,qb,V)||this.WFi(ja,qb,V)||this.tTl(ja,qb,V)||this.XFi(ja,V))}F_m(ja,qb,V){if(!(ja&&qb&&V&&V.length&&this.VYe(V)))return!1;ja=Hb.fWl(ja,V);qb=this.wTl(qb,ja)||this.yTl(qb,ja)||this.uTl(qb,ja)||this.ATl(ja);let Ea;this.Sfg(V)||(Ea=this.D_m(V[0]));return Ea||qb}tkn(ja,qb,V){const Ea=Object.assign(new Ve.a,{Id:"MenuSectionEffectOptionsSequence",ControlsId:"MenuSectionEffectOptionsSequence.Controls",DisplayMode:"Menu32",ControlList:[]});
this.vTl(ja,qb,V)&&Array.add(Ea.ControlList,Object.assign(new hf.a,{Command:"1850236812",Id:"AsOneObject",ExternalId:"AnimationEffectOptionsSequenceAsOneObject",QueryCommand:"1125291975"}));this.tTl(ja,qb,V)&&this.d4b&&Array.add(Ea.ControlList,Object.assign(new hf.a,{Command:"2048458448",Id:"AllAtOnce",ExternalId:"AnimationEffectOptionsSequenceAllAtOnce",QueryCommand:"1125291975"}));this.WFi(ja,qb,V)&&Array.add(Ea.ControlList,Object.assign(new hf.a,{Command:"3467781846",Id:"ByParagraph",ExternalId:"AnimationEffectOptionsSequenceByParagraph",
QueryCommand:"1125291975"}));this.XFi(ja,V)&&Array.add(Ea.ControlList,Object.assign(new hf.a,{Command:"1486892994",Id:"OneByOne",ExternalId:"AnimationEffectOptionsSequenceOneByOne",QueryCommand:"1125291975"}));return Ea}ukn(ja,qb,V){const Ea=new Ve.a;Ea.Id="MenuSectionEffectOptionsSequence";Ea.ControlsId="MenuSectionEffectOptionsSequence.Controls";Ea.DisplayMode="Menu32";Ea.ControlList=[];if(!(ja&&ja.length&&qb&&V&&V.length))return Ea;ja=Hb.fWl(ja,V);this.wTl(qb,ja)&&(V=new hf.a,V.Command="1850236812",
V.Id="AsOneObject",V.ExternalId="AnimationEffectOptionsSequenceAsOneObject",V.QueryCommand="1125291975",Ea.ControlList.push(V));this.uTl(qb,ja)&&(V=new hf.a,V.Command="2048458448",V.Id="AllAtOnce",V.ExternalId="AnimationEffectOptionsSequenceAllAtOnce",V.QueryCommand="1125291975",Ea.ControlList.push(V));this.yTl(qb,ja)&&(qb=new hf.a,qb.Command="3467781846",qb.Id="ByParagraph",qb.ExternalId="AnimationEffectOptionsSequenceByParagraph",qb.QueryCommand="1125291975",Ea.ControlList.push(qb));this.ATl(ja)&&
(qb=new hf.a,qb.Command="1486892994",qb.Id="OneByOne",qb.ExternalId="AnimationEffectOptionsSequenceOneByOne",qb.QueryCommand="1125291975",Ea.ControlList.push(qb));return Ea}oyn(ja){let qb=!0,V=0;if(!ja)return!1;for(const Ea of ja)if(qb)V=Ea.EffectId,qb=!1;else if(Ea.EffectId!==V)return!1;return!0}Zin(ja,qb,V){const Ea={isEnabled:!1,TXh:null};if(!ja||!qb||!qb.length)return Ea;for(var Za of qb)if(Za.IsTrigger)return Ea;ja=Hb.Ein(ja);if(!ja.length||Hb.lwn(ja,qb))return Ea;Za=ja.map(ia=>ia.EffectNodeId);
qb=qb.map(ia=>ia.EffectNodeId).sort((ia,Va)=>ia-Va);if(!Hb.tyn(qb,Za))return Ea;if(V){V=Za.indexOf(qb[qb.length-1]);if(-1==V||V==Za.length-1)return Ea;Ea.isEnabled=!0;Ea.TXh=Hb.T4l(ja[V+1])}else{V=Za.indexOf(qb[0]);if(-1==V||0==V)return Ea;Ea.isEnabled=!0;Ea.TXh=Hb.T4l(ja[V-1])}return Ea}hln(ja){const qb=[];if(!ja||!ja.animations||!ja.animations.Sequences)return qb;let V=0;for(const Ea of ja.animations.Sequences)Ea.Effects&&(qb.push({isTriggerSequence:Ea.IsTriggerSeq,sequenceIndex:Ea.SequenceIndex,
description:Ea.Description,animationCount:Ea.Effects.length,sequenceStartIndex:V}),V+=Ea.Effects.length);return qb}$gn(ja,qb){const V=[];if(!ja||!ja.length)return V;const Ea=new Map;if(oe.a("DisableControlsInAnimationCardBasedOnShapeType")){if(null===qb||void 0===qb||!qb.length)return V;qb.forEach(Ab=>{Ea.set(Ab.id.toString(),Ab)})}qb=new Map;for(var Za of ja.filter(Ab=>!Ab.IsTrigger&&-1!==Ab.GroupId)){var ia=`${Za.ShapeId}${","}${Za.GroupId}`;if(qb.has(ia)){var Va=qb.get(ia);qb.set(ia,Va+1)}else qb.set(ia,
1)}Za=new Set;for(const Ab of ja)ja=Hb.j4m(Ab),oe.a("DisableControlsInAnimationCardBasedOnShapeType")&&(ia=Ea.get(Ab.ShapeId),this.sao(ja,ia)),Ab.IsTrigger||(-1===Ab.GroupId?ja.IsGroupAnimation=0<Za.size:(ja.IsGroupAnimation=!0,ia=`${Ab.ShapeId}${","}${Ab.GroupId}`,0===Za.size&&(ja.IsFirstGroupAnimation=!0),Za.has(ia)||Za.add(ia),Va=qb.get(ia),Va--,qb.set(ia,Va),0===Va&&Za.delete(ia),0===Za.size&&(ja.IsLastGroupAnimation=!0)),ja.IsDraggable=!ja.IsGroupAnimation||ja.IsFirstGroupAnimation&&ja.IsLastGroupAnimation),
V.push(ja);return V}sao(ja,qb){const V=this.HWe(ja.EffectType,ja.EffectId);Hb.M$l([qb])&&!V?ja.DisabledAnimationControls.push(0):Hb.JXj([qb])&&!V&&(ja.DisabledAnimationControls.push(1),ja.DisabledAnimationControls.push(2))}static j4m(ja){return Object.assign(Object.assign({},ja),{IsDraggable:!1,IsFirstGroupAnimation:!1,IsGroupAnimation:!1,IsLastGroupAnimation:!1,DisabledAnimationControls:[]})}static fWl(ja,qb){const V=new Map;for(const Ea of ja)V.set(Ea.id.toString(),Ea);ja=new Map;for(const Ea of qb)qb=
Of.a.Vf(Ea.ShapeId),qb=V.get(qb.toString()),ja.set(Ea,qb);return ja}static T4l(ja){const qb=new ge;qb.EffectNodeId=ja.EffectNodeId;qb.ShapeId=ja.ShapeId;return qb}static tyn(ja,qb){if(!(ja&&ja.length&&qb&&qb.length)||ja.length>qb.length)return!1;const V=ja[ja.length-1],Ea=qb.indexOf(ja[0]);return qb.indexOf(V)-Ea+1==ja.length}static Ein(ja){const qb=[];if(!ja)return qb;ja=ja.animations;if(!ja||!ja.Sequences)return qb;for(const V of ja.Sequences[0].Effects)qb.push(V);return qb.sort((V,Ea)=>V.EffectNodeId-
Ea.EffectNodeId)}static lwn(ja,qb){if(!ja||!qb)return!1;const V=new Map;for(const Ea of ja.filter(Za=>-1!==Za.GroupId))if(ja=`${Ea.ShapeId}${","}${Ea.GroupId}`,V.has(ja)){const Za=V.get(ja);V.set(ja,Za+1)}else V.set(ja,1);for(const Ea of qb.filter(Za=>-1!==Za.GroupId))if(qb=`${Ea.ShapeId}${","}${Ea.GroupId}`,V.has(qb)&&1<V.get(qb))return!0;return!1}vTl(ja,qb,V){return 0!==V.SequenceId&&0!==V.EffectId&&this.H9d(V,ja)&&(ja.xg||2!==V.EffectType||1!==V.EffectId&&7!==V.EffectId)&&(ja.Lfa||this.XFi(ja,
V)||this.WFi(ja,qb,V))}H_m(ja,qb,V){return ja&&0!==V.BuildType&&0!==V.EffectId&&this.$Oh(V)&&(ja.xg||2!==V.EffectType||1!==V.EffectId&&7!==V.EffectId)&&(ja.Lfa||this.zTl(ja,V)||this.xTl(ja,qb,V))}wTl(ja,qb){for(const [V,Ea]of qb)if(!this.H_m(Ea,ja,V))return!1;return!0}tTl(ja,qb,V){return 0!==V.SequenceId&&!ja.Lfa&&!ja.gd&&0!==V.EffectId&&this.H9d(V,ja)&&(ja.xg||2!==V.EffectType||1!==V.EffectId&&7!==V.EffectId)&&(ja.Bl||ja.xg||ja.isEditable&&0<qb.MV(ja).length)}G_m(ja,qb,V){return ja&&0!==V.BuildType&&
!ja.Lfa&&!ja.gd&&0!==V.EffectId&&this.$Oh(V)&&(ja.xg||2!==V.EffectType||1!==V.EffectId&&7!==V.EffectId)&&(ja.Bl||ja.xg||ja.isEditable&&0<qb.MV(ja).length)}uTl(ja,qb){for(const [V,Ea]of qb)if(!this.G_m(Ea,ja,V))return!1;return!0}WFi(ja,qb,V){return 0!==V.SequenceId&&!ja.xg&&!ja.Lfa&&!ja.gd&&0!==V.EffectId&&this.H9d(V,ja)&&(2!==V.EffectType||1!==V.EffectId&&7!==V.EffectId)&&(ja.Bl||ja.isEditable&&0<qb.MV(ja).length)}xTl(ja,qb,V){return ja&&0!==V.BuildType&&!ja.xg&&!ja.Lfa&&!ja.gd&&0!==V.EffectId&&this.$Oh(V)&&
(2!==V.EffectType||1!==V.EffectId&&7!==V.EffectId)&&(ja.Bl||ja.isEditable&&0<qb.MV(ja).length)}yTl(ja,qb){for(const [V,Ea]of qb)if(!this.xTl(Ea,ja,V))return!1;return!0}XFi(ja,qb){return 0!==qb.SequenceId&&ja.xg&&0!==qb.EffectId&&this.H9d(qb,ja)}zTl(ja,qb){return ja&&0!==qb.BuildType&&ja.xg&&0!==qb.EffectId&&this.$Oh(qb)}ATl(ja){for(const [qb,V]of ja)if(!this.zTl(V,qb))return!1;return!0}static em(ja){return Od.a.Pwe+"_"+ja+"_32x32x32"}static Hgn(ja,qb){switch(qb){case "Direction":return ja.xG;case "EffectData":return ja.effectData;
default:return null}}static Ign(ja,qb){switch(qb){case "Direction":return Hb.pC.ka(ja);case "EffectData":return Hb.HNa.ka(ja);default:return null}}}Hb.pC=null;Hb.HNa=null;Hb.xD=null;Hb.M$l=ja=>{if(!ja||0==ja.length)return!1;for(const qb of ja)if(qb.E5)return!0;return!1};Hb.JXj=ja=>{if(!ja||0==ja.length)return!1;for(const qb of ja)if(1===qb.mediaType||2===qb.mediaType)return!0;return!1};Object(m.a)(Hb,"AnimationHelper",null,[724]);var mc=a(228);const Nc=(Yc.a.NC&65535^Yc.a.NC>>>16)<<16,db="SetAnimation SetAnimationDuration SetAnimationDelay AnimationStart MoveAnimationEarlier MoveAnimationLater SetAnimationColorEffect SetAnimationDirection SetAnimationEffectData SetAnimationSequenceAllAtOnce SetAnimationSequenceAsOneObject SetAnimationSequenceByParagraph SetAnimationSequenceOneByOne SetAnimationColor".split(" ");
class Wb{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd,yd,Md,te,Pe,t,L,S,ka,ra,xb,Ob){this.Eib="Existing";this.pbd="ExistingInMenu";this.nml="AnimationExisting";this.oml="AnimationExistingInMenu";this.vwb=this.Ena=this.BDa=!1;this.lgm=this.Sde=this.cQh=-1;this.apd=!1;this.Ibc=(Vb,Ac,$c,qd,Fd)=>{Vb=this.eu.r4;Ac=this.sa.ut();if(!Ac||!Vb||!Vb.length)return 8;if(1===$c)return 32;$c=this.f_b(Vb,Ac);Fd.MenuItems=this.KYm(Vb,Ac,$c);return 32};this.jUa=(Vb,Ac,$c,qd,Fd)=>{Vb=Fd.queryResult;Fd=Fd.SourceControlId;
qd=Ac=-1;Fd!==this.Eib&&({effectType:qd,effectId:Ac}=this.jz.tLh(Fd));var Ud=this.eu.r4;if(!this.sa.ut())return 8;if(1!==$c)return 32;$c=this.jz.uLh(Fd);var ae=$c.label;if(Fd===this.Eib||Fd===this.pbd)ae=ResourceStrings.L_ExistingButtonDescription;this.uXd(Fd,$c.image,$c.label,Vb,ae);let Yd=ae=!1;const se=0==Ud.length?0:Ud[0].EffectId,Ie=0==Ud.length?0:Ud[0].EffectType,Se=!this.jz.VYe(Ud);Ud=this.jz.Sfg(Ud);Se||Ud||(ae=Ac===se&&qd===Ie,Yd=this.jz.wOh(Ie,se));Fd===this.Eib?(Yd=this.g2n(this.Eib,Vb,
Ud,Yd,Se,$c.image,Ie,se),Vb.boa(Se||Ud||Yd)):Fd===this.pbd?(Yd=Wb.e2n(Vb,Ud,Se,Yd),Vb.boa(Se||Ud||Yd)):Vb.boa(ae);return 32};this.AFh=Vb=>{oe.a("AddAnimationContextInInteractiveEvent")&&(Uf.a.Ak("AnimationMarkerLocallyRenderTime",Date.now().toString()),Vb&&this.rbm(Vb,"isAnimationMarkerLocalRender","true"))};this.Lxm=(Vb,Ac,$c=!1)=>{var qd,Fd;let Ud=void 0,ae=void 0;const Yd=this.sa.zd();if(Yd&&Yd.length){var se=this.sa.ut();if(se.KBa){var Ie=se.LYb(Yd);0==(null===Ie||void 0===Ie?void 0:Ie.length)&&
(Ie=null===(Fd=null===(qd=se.animations)||void 0===qd?void 0:qd.Sequences)||void 0===Fd?void 0:Fd[0].Effects,null===Ie||void 0===Ie?0:Ie.length)&&(Ud=Ie[Ie.length-1].ClickOrder+1)}else Ud=1;for(const Se of Yd)Ud?!Se.Lfa&&Se.Bl?(ae="NodesIsPlaceHolderType",this.eu.iJa(!0,Se,void 0)):this.eu.iJa(!0,Se,Ud):(ae="NodesHaveSomeAnimation",(qd=se.DIb(Se))&&1==qd.length&&qd[0].EffectId==Vb&&!$c||this.eu.iJa(!0,Se,void 0));Ac&&ae&&this.rbm(Ac,"reasonForBlankAnimationMarker",ae)}};this.g7m=()=>{var Vb=this.sa.zd();
if(Vb&&Vb.length){var Ac=this.sa.ut(),$c=Ac.LYb(Vb);if($c&&0!=$c.length){$c=$c[0].ClickOrder;Vb=Vb.map(Fd=>Fd.id.toString());var qd=Ac.Nj();for(const Fd of qd)if(qd=Ac.DIb(Fd))if(Vb.includes(Fd.id.toString()))this.eu.yXa(Fd);else for(const Ud of qd)if(Ud.ClickOrder>=$c){this.eu.iJa(!0,Fd,void 0,!1);break}}}};this.NC=(Vb,Ac,$c,qd,Fd)=>{Ac=this.eu.r4;var Ud=this.sa.ut();let ae=!0;var Yd=this.getSelectedShapes();if(!Yd||!Yd.length)if(ae=!1,Yd=this.f_b(Ac,Ud),!Yd||!Yd.length)return oe.a("StopFalseLoggingSetAnimation")||
Pc.a.$(509677843,800,10,"AnimationActor::setAnimation: selected shapes info is null"),8;oe.a("FixAddAnimationCrashForGroupedShape")&&(Yd=this.D2l(Yd));if(!Wb.vyn(Ud,Yd)||this.Vlc(Yd))return 8;if(1===$c)return qd=0<Ac.length&&!this.jz.VYe(Ac),Ud=Hb.M$l(Yd),qd&&Ud?8:Vb===Yc.a.c$c||Vb===Yc.a.zfc?(Yd=0<Ac.length&&this.jz.Sfg(Ac),Ud=!1,qd||Yd||(Ud=this.jz.wOh(0<Ac.length?Ac[0].EffectType:-1,0<Ac.length?Ac[0].EffectId:-1)),Vb===Yc.a.zfc&&(Ud=qd?!0:!1),qd||Yd||Ud?32:16):Vb===Yc.a.b$c?Wb.uyn(Yd)?32:16:32;
$c=Fd.SourceControlId;if(!$c)return 8;if($c===this.Eib||$c===this.pbd||$c===this.nml||$c===this.oml)return 32;$c=this.jz.tLh($c);Yd=Wb.nen(Yd,$c.effectId,$c.effectType,ae,Ac);!this.Ea.getBooleanAppSetting("LocalAnimationMarkerRendering")||0!=(null===Yd||void 0===Yd?void 0:Yd.AnimationAction)&&3!=(null===Yd||void 0===Yd?void 0:Yd.AnimationAction)||(3==Yd.AnimationAction?this.g7m():this.Lxm($c.effectId,Vb),this.AFh(Vb));this.apd&&Yd&&!this.BDa&&Ac&&0===Ac.length&&(this.Toc(!1),this.BDa=!0);Yd&&this.RNa(Ud,
Yd,!0);qd&&(qd.AD=$c.effectId,qd.AV=$c.effectType+100);return 32};this.Gjm=(Vb,Ac,$c)=>{const qd=this.eu.r4;Ac=this.sa.ut();if(!Ac||!qd||!qd.length)return 8;var Fd=this.f_b(qd,Ac);if(!Fd||!Fd.length)return Pc.a.$(509670021,800,10,"AnimationActor::moveAnimationHandler: selected shapes info is null"),8;if(this.Vlc(Fd))return 8;switch(Vb){case Yc.a.Are:Vb=!1;break;case Yc.a.Bre:Vb=!0;break;default:return 8}Fd=this.jz.Zin(Ac,qd,Vb);if(1===$c)return Fd.isEnabled?32:8;if(!Fd.TXh)return Pc.a.$(509670020,
800,10,"AnimationActor::moveAnimationHandler: move animation info ref target is null"),8;$c=Wb.w5a(qd);$c=Wb.iUi($c,Fd.TXh,Vb);this.RNa(Ac,$c,!0);return 32};this.ncb=(Vb,Ac,$c,qd,Fd)=>{Ac=this.eu.r4;Vb=this.sa.ut();if(!Vb||!Ac||!Ac.length)return 8;var Ud=this.f_b(Ac,Vb);if(!Ud||!Ud.length)return Pc.a.$(509677842,800,10,"AnimationActor::setAnimationColor: selected shapes info is null"),8;if(this.Vlc(Ud))return 8;if(1===$c)return 32;$c=Qf.Box4ColorHelper.JR(Fd);if(!$c)return Pc.a.$(509677841,800,10,
"AnimationActor::setAnimationColor:  solid is null"),8;$c=Qf.Box4ColorHelper.LCb($c,Vb.Ve);if(!$c)return Pc.a.$(509677840,800,10,"AnimationActor::setAnimationColor:  color is null"),8;Fd=new Dd.a;Fd.AnimationAction=1;Ud=new ze;Ud.TargetEffects=Wb.w5a(Ac);Ud.ModifyAnimPropType=3;Ac=new Bd;Ac.Color=[$c.r,$c.g,$c.b];Ac.EffectDataPropType=1;Ud.EffectData=Ac;Fd.ModifyAnimationInfo=Ud;this.RNa(Vb,Fd,!0);qd&&(qd.AV=1);return 32};this.bOk=()=>{const Vb=this.eu.r4;var Ac=this.sa.ut();if(!Ac||!Vb||!Vb.length)return 8;
Ac=this.f_b(Vb,Ac);return Ac&&Ac.length?this.jz.F_m(Ac,this.La,Vb)?32:16:(Pc.a.$(509677839,800,10,"AnimationActor::queryEffectOptions: selected shapes info is null"),8)};this.xfc=(Vb,Ac,$c,qd,Fd)=>{Vb=this.eu.r4;Ac=this.sa.ut();if(!Ac||!Vb||!Vb.length)return 8;var Ud=this.f_b(Vb,Ac);if(!Ud||!Ud.length)return Pc.a.$(509677838,800,10,"AnimationActor::setAnimationDirection: selected shapes info is null"),8;if(this.Vlc(Ud))return 8;if(1===$c)return 32;$c=this.jz.C0f(Fd.MenuItemId);Fd=new Dd.a;Fd.AnimationAction=
1;Ud=new ze;Ud.TargetEffects=Wb.w5a(Vb);Ud.ModifyAnimPropType=2;Ud.Direction=$c;Fd.ModifyAnimationInfo=Ud;this.RNa(Ac,Fd,!0);qd&&(qd.AV=1);return 32};this.Mcc=(Vb,Ac,$c,qd,Fd)=>{Vb=this.eu.r4;if(!this.sa.ut()||!Vb||!Vb.length)return 8;Ac=Fd.queryResult;Fd=this.jz.C0f(Fd.MenuItemId);Wb.kwn(Vb)&&Ac.Fg(Vb[0].Direction===Fd);return 32};this.d$c=(Vb,Ac,$c,qd,Fd)=>{Vb=this.eu.r4;Ac=this.sa.ut();if(!Ac||!Vb||!Vb.length)return 8;var Ud=this.f_b(Vb,Ac);if(!Ud||!Ud.length)return Pc.a.$(509677652,800,10,"AnimationActor::setAnimationSequence: selected shapes info is null"),
8;if(this.Vlc(Ud))return 8;if(1===$c)return 32;$c=Fd.MenuItemId;Fd=new Dd.a;Fd.AnimationAction=5;Ud=new tg;Ud.TargetEffects=Wb.w5a(Vb);Ud.BuildType=Wb.Len($c);Fd.ChangeAnimationBuildTypeInfo=Ud;this.RNa(Ac,Fd,!0);qd&&(qd.AV=1);return 32};this.kUa=(Vb,Ac,$c,qd,Fd)=>{Vb=this.eu.r4;if(!this.sa.ut()||!Vb||!Vb.length)return 8;Ac=Fd.queryResult;Fd=this.jz.dqj(Fd.MenuItemId);Wb.iwn(Vb)&&Ac.Fg(Vb[0].BuildType===Fd);return 32};this.yfc=(Vb,Ac,$c,qd,Fd)=>{Ac=this.eu.r4;Vb=this.sa.ut();if(!Vb||!Ac||!Ac.length)return 8;
var Ud=this.f_b(Ac,Vb);if(!Ud||!Ud.length)return Pc.a.$(509677837,800,10,"AnimationActor::setAnimationEffectData: selected shapes info is null"),8;if(this.Vlc(Ud))return 8;if(1===$c)return 32;Ud=Fd.MenuItemId;$c=new Dd.a;$c.AnimationAction=1;Fd=new ze;Fd.TargetEffects=Wb.w5a(Ac);Fd.ModifyAnimPropType=3;Ac=this.Fgn(Ud);if(!Ac)return Pc.a.$(509703439,800,15,"AnimationActor::setAnimationEffectData:  effect data info is null"),16;Fd.EffectData=Ac;$c.ModifyAnimationInfo=Fd;this.RNa(Vb,$c,!0);qd&&(qd.AV=
1);return 32};this.Ncc=(Vb,Ac,$c,qd,Fd)=>{Vb=this.eu.r4;if(!this.sa.ut()||!Vb||!Vb.length)return 8;Fd.queryResult.Fg(this.jz.eVl(Wb.Ggn(Vb[0].EffectData),Fd.MenuItemId));return 32};this.S$n=(Vb,Ac,$c,qd,Fd)=>{Ac=this.eu.r4;Vb=this.sa.ut();if(!Vb||!Ac||!Ac.length)return 8;qd=this.f_b(Ac,Vb);if(!qd||!qd.length)return Pc.a.$(509677836,800,10,"AnimationActor::setAnimationStartHandler: selected shape info is null"),8;if(this.Vlc(qd))return 8;if(1===$c)return 32;$c=Fd.CommandValueId;if(!$c||!$c.trim().length)return Pc.a.$(509703438,
800,10,"AnimationActor::setAnimationStartHandler:  startoption value is null or empty"),16;$c=Wb.Oln($c);if(3==$c)return Pc.a.$(509703437,800,15,"AnimationActor::setAnimationStartHandler:  startoption value is invalid"),16;for(var Ud of Ac)Ud.StartType=$c;Ud=Wb.w5a(Ac);Ud=Wb.lWl(Ud,$c);this.RNa(Vb,Ud,!1);return 32};this.Knc=(Vb,Ac,$c,qd,Fd)=>{Vb=this.eu.r4;if(!this.sa.ut()||!Vb||!Vb.length)return Wb.Z8k(Fd,3),32;Ac=Vb[0].StartType;$c=!0;for(const Ud of Vb)if(Ac!=Ud.StartType){$c=!1;break}$c?Wb.Z8k(Fd,
Ac):Wb.Z8k(Fd,3);return 32};this.R$n=(Vb,Ac,$c,qd,Fd)=>{Vb=this.sa.ut();Ac=this.eu.r4;if(!Vb||!Ac||!Ac.length)return 8;qd=this.f_b(Ac,Vb);if(!qd||!qd.length)return Pc.a.$(509677835,800,10,"AnimationActor::setAnimationDurationHandler: selected shape info is null"),8;if(this.Vlc(qd))return 8;const Ud=!this.jz.VYe(Ac);if(Hb.JXj(qd)&&Ud)return 8;if(1===$c)return 32;($c=Math.floor(1E3*Fd.Number))||($c=10);for(var ae of Ac)ae.Duration=$c;ae=Wb.w5a(Ac);ae=Wb.iIh(ae,1,$c);this.RNa(Vb,ae,!1);return 32};this.oZa=
(Vb,Ac,$c,qd,Fd)=>{Vb=this.eu.r4;if(!this.sa.ut()||!Vb||!Vb.length)return this.A5e(Fd,"0.00"),32;Ac=Vb[0].Duration;$c=!0;for(const Ud of Vb)if(Ac!=Ud.Duration){$c=!1;break}$c?this.A5e(Fd,Number(Ac/1E3).toFixed(2)):this.A5e(Fd,"0.01");return 32};this.XSm=(Vb,Ac,$c)=>{if(!this.sa.ut())return 8;Vb=this.getSelectedShapes();if(!Vb||0==Vb.length)return Pc.a.$(507650054,800,10,"AnimationActor::addAnimationInContextMenuHandler: selected shape count is 0"),8;if(this.Vlc(Vb))return 8;if(1===$c)return 32;this.Gy.selectRibbonTabById("AnimationsTab");
this.BDa||(this.Toc(!1),this.BDa=!0);this.Bwj(20);return 32};this.ypn=(Vb,Ac,$c)=>1==$c?32:Ld.b("AnimationPaneActor::ShowHideAnimationPane PaneOpen:",this.BDa.toString(),Vb,()=>{(this.BDa=!this.BDa)?this.Toc(!1):this.MEj();return 32});this.urd=(Vb,Ac,$c,qd,Fd)=>{Fd&&Fd.Fg(this.BDa);return 32};this.Toc=(Vb,Ac)=>{const $c=this.jN();var qd=Object(da.a)(this,this.Vnn,"applyAnimationAction");$c.onAnimationAction=qd;qd=Object(da.a)(this,this.Xnn,"handleAnimationSelectionChangeFromPane");$c.onSelectionChange=
qd;$c.onAnimationPreviewAction=this.iQn;qd=this.getSelectedShapes();$c.isAddAnimationButtonDisabled=!qd||!qd.length;if(qd=oe.a("FixAnimationRibbonBugs")?this.eu.bT:this.sa.ut()){$c.isZeroStateAnimationPane=!qd.KBa;$c.isPreviewButtonOnCardDisabled=!0;$c.isAnimationPreviewPlaying=this.vwb;var Fd=qd.Nj(),Ud=qd.LYb(Fd);this.lgm=this.Iin(Ud);Ud=Ud.sort((Yd,se)=>Yd.EffectNodeId-se.EffectNodeId);$c.animations=this.jz.$gn(Ud,Fd);$c.previewSequenceIndex=this.cQh;$c.previewClickOrder=this.Sde;oe.a("FixScrollAndFocusDuringPreview")&&
this.Ena&&this.vwb?$c.selectedAnimationNodeIds=[]:$c.selectedAnimationNodeIds=this.eu.r4.map(Yd=>Yd.EffectNodeId);$c.sequencesInfo=this.jz.hln(qd);var ae={title:ResourceStrings.L_AnimationGalleryGroup,hideHeader:!1,width:$c.paneWidth,location:2,contentProps:$c,onOpen:()=>{},onClose:()=>{this.BDa=!1;Pc.a.$(507888535,800,50,"AnimationActor::showAnimationPane: Animation pane closed using close button");this.NSh&&this.vwb&&(this.la.Eb(Yc.a.Skc,2),this.vwb=!1)},isModernPane:!0};wc.a.Gz().then(Yd=>{Vb?
this.BDa&&(Yd.updateTaskPane(ee.a.l2a,ae),this.NSh&&this.vwb&&Yd.setSelectedTaskPane(ee.a.l2a)):Yd.showTaskPane(ee.a.l2a,ae);if(Ac)try{Ac()}catch(se){Pc.a.$(508069954,800,10,"AnimationActor::showAnimationPane: Could not execute callback on pane open {0}",se)}return null}).catch(Yd=>{Pc.a.$(512500804,800,10,"AnimationActor::showAnimationPane exception: {0}",Yd.toString())})}else Pc.a.$(509642376,800,10,"AnimationActor::showAnimationPane: selected slide is null")};this.onSelectionChange=()=>{if(this.eu&&
this.eu.Iwa&&!this.vwb){var Vb=this.eu.bT;Vb?(Vb=Vb.Nj())&&Vb.length&&(this.eu.DEm(),this.BDa&&this.eu.wCg&&this.Toc(!0)):Pc.a.$(509145116,800,10,"AnimationActor::onSelectionChange: current active slide is null")}};this.onActiveSlideDomReady=(Vb,Ac)=>{Ac&&this.eu&&((Vb=this.eu.bT)?(Ac=Object(Rb.a)(22,Ac.Ia))&&Vb.fc!==Ac.fc&&(this.eu.Fmo(Ac),this.BDa&&this.Toc(!0)):Pc.a.$(509145115,800,10,"AnimationActor::onActiveSlideDomReady: current active slide is null"))};this.$zb=(Vb,Ac)=>{const $c=this.ya.Ia;
$c&&$c.dW&&(Vb=this.eu.bT)&&$c===Vb&&(Ac=Ac.pJ)&&Ac.shapeNode&&this.FPc(Vb.fc,Ac.shapeNode)&&this.eu.iJa(this.eu.Iwa)};this.mab=(Vb,Ac)=>{Ac&&this.eu&&(this.eu.Emo(Ac.yzb),this.BDa&&(this.eu.Iwa||this.MEj()))};this.Cac=(Vb,Ac)=>{Ac.Ly&&Ac.Ly.Id&&this.j9a==Ac.Ly.Id&&setTimeout(()=>{this.eu.iJa(!0)},0)};this.SFe=(Vb,Ac)=>{Ac&&Ac.revisionId&&(this.j9a=Ac.revisionId.toString())};this.Qh=(Vb,Ac)=>{if(Ac&&Ac.property===Rf.a.KTe&&this.eu&&this.eu.Iwa){Vb=!1;if(oe.a("FixAnimationSelectionCachingIssue"))for(var $c of db){const qd=
Uf.a.EJc($c);if(qd&&0<qd.length){Vb=!0;break}}$c=this.eu.bT;$c?this.qc.Hg(Ac.node)===$c&&(this.eu.T5e(!1),this.eu.Dmo(Vb),this.eu.T5e(!0),this.BDa&&this.Toc(!0)):Pc.a.$(509145114,800,10,"AnimationActor::onPropertyChanged: current active slide is null")}};this.Vnn=(Vb,Ac,$c)=>{oe.a("TrackAnimationPaneEvents")&&Ac&&$c&&mc.ActionManager.VC(Ac,$c,void 0);if(oe.a("FixAnimationPaneActionContextNullIssue"))switch(Ac=Uf.a.Xk("SetAnimation",1),Ac.Oq=!0,Vb.actionType){case 0:Uf.a.PB(Ac,()=>{this.Bwj()});break;
case 2:Uf.a.PB(Ac,()=>{this.r6l(Vb)});break;case 1:Uf.a.PB(Ac,()=>{this.P5l(Vb)});break;case 3:this.g6l(Vb);break;case 4:Ac.actionName="AnimationStart";Uf.a.PB(Ac,()=>{this.M5l(Vb)});break;case 5:break;case 6:this.q6l(Vb);break;default:Pc.a.$(509642375,800,10,"AnimationActor::applyAnimationActionFromPane: invalid animation action type")}else switch(Vb.actionType){case 0:this.Bwj();break;case 2:this.r6l(Vb);break;case 1:this.P5l(Vb);break;case 3:this.g6l(Vb);break;case 4:this.M5l(Vb);break;case 5:break;
case 6:this.q6l(Vb);break;default:Pc.a.$(508829901,800,10,"AnimationActor::applyAnimationActionFromPane: invalid animation action type")}};this.Xnn=Vb=>{const Ac=this.sa.ut();Ac&&Vb?(this.eu.T5e(!1),this.eu.gwa(),this.eu.pri(Vb,Ac),this.eu.T5e(!0)):Pc.a.$(509620888,800,10,"AnimationActor::handleAnimationSelectionChangeFromPane: slide or animation ids info is null")};this.j8j=(Vb,Ac,$c,qd=30)=>{Vb=[Object.assign(new gf.a,{name:"CustomData1",int64:Nc+Vb}),Object.assign(new gf.a,{name:"CustomData2",
int64:Nc+Ac+100})];Eb.d(Yc.a.NC,!0,void 0,0,void 0==qd||null==qd?30:qd,$c,Vb)};this.Bwj=Vb=>{var Ac=Date.now(),$c=this.getSelectedShapes();const qd=this.sa.ut();if(qd&&$c&&$c.length){this.NTj("AddMarkerLocallyFromAnimationPane")&&(this.Lxm(10,void 0,!0),this.AFh());if(oe.a("FixAddAnimationCrashForGroupedShape")){const Fd=this.D2l($c);$c.length=0;$c.push(...Fd)}if($c=Wb.F1l($c,10,0,!1))this.RNa(qd,$c,!0),this.Iod&&(Ac=Date.now()-Ac,this.j8j(10,0,Ac,Vb))}else Pc.a.$(509642374,800,10,"AnimationActor::applyAddAnimationFromPane: slide or shapes info is null")};
this.r6l=Vb=>{var Ac=Date.now();if(Vb&&Vb.replaceAnimationInfo){var $c=Vb.replaceAnimationInfo.effectId;Vb=Vb.replaceAnimationInfo.effectType;var qd=this.eu.r4,Fd=this.sa.ut();if(Fd&&qd&&qd.length){if(this.NTj("ReplaceMarkerLocallyFromAnimationPane")&&(this.jpn(Fd,qd,$c),this.AFh()),qd=Wb.f4l(qd,$c,Vb))this.RNa(Fd,qd,!0),this.Iod&&(Ac=Date.now()-Ac,this.j8j($c,Vb,Ac))}else Pc.a.$(509642372,800,10,"AnimationActor::applyReplaceAnimation: slide or animation info is null")}else Pc.a.$(509642373,800,10,
"AnimationActor::applyReplaceAnimation: replace animation info is null")};this.jpn=(Vb,Ac,$c)=>{if(Vb&&Ac&&Ac.length)for(const qd of Ac)null!=qd.ShapeId&&qd.EffectId!==$c&&(Ac=Vb.Pld(Of.a.Vf(qd.ShapeId)))&&this.eu.iJa(!0,Ac,void 0)};this.P5l=Vb=>{var Ac=Date.now();if(Vb&&Vb.deleteAnimationInfo){var $c=this.sa.ut();Vb=Vb.deleteAnimationInfo.animationIds;$c&&Vb&&Vb.length?(this.NTj("DeleteMarkerLocallyFromAnimationPane")&&(this.lon($c,Vb),this.AFh()),Vb=Wb.umn(Vb),Vb=Wb.qWl(Vb),this.RNa($c,Vb,!0),this.Iod&&
(Ac=Date.now()-Ac,this.j8j(0,0,Ac))):Pc.a.$(509616839,800,10,"AnimationActor::handleDeleteAnimation: slide or deleteAnimationIds is null/empty")}else Pc.a.$(509616840,800,10,"AnimationActor::handleDeleteAnimation: delete animation info is null")};this.lon=(Vb,Ac)=>{if(Vb&&Ac&&Ac.length){var $c=new Map;for(var qd of Ac)$c.has(qd.shapeId)?$c.get(qd.shapeId).push(qd):$c.set(qd.shapeId,Array(qd));Ac=Ac.map(Fd=>Fd.effectNodeId);Ac=this.qc.$Kh(Ac,Vb);1<Ac.length&&Ac.sort((Fd,Ud)=>Fd.ClickOrder-Ud.ClickOrder);
Ac=Ac.length?Ac[0].ClickOrder:0;qd=Vb.Nj();for(const Fd of qd)qd=Vb.LYb(Array(Fd)),$c.has(Fd.id.toString())?qd.length==$c.get(Fd.id.toString()).length?this.eu.yXa(Fd):this.eu.iJa(!0,Fd,void 0):qd.length&&qd[qd.length-1].ClickOrder>Ac&&this.eu.iJa(!0,Fd,void 0,!1)}};this.jN=()=>({type:"AnimationPaneProps",paneWidth:Ce.a,isAnimationPreviewEnabled:this.Ena,forceDisablePreview:oe.a("DisablePreviewInSvgMode")&&this.Ena&&this.Ina.$wa});this.xlo=()=>{if(this.BDa)return this.Toc(!0),32};this.MEj=()=>{wc.a.Gz().then(Vb=>
{Pc.a.$(507888534,800,50,"AnimationActor::hideAnimationPane: Animation pane closed using animation pane button in the ribbon");Vb.hideTaskPane(ee.a.l2a,2);return null}).catch(Vb=>{Pc.a.$(512500803,833,10,"AnimationActor::hideAnimationPane exception: {0}",Vb.toString())})};this.Q$n=(Vb,Ac,$c,qd,Fd)=>{Ac=this.eu.r4;Vb=this.sa.ut();if(!Vb||!Ac||!Ac.length)return 8;qd=this.f_b(Ac,Vb);if(!qd||!qd.length)return Pc.a.$(509677834,800,10,"AnimationActor::setAnimationDelayHandler: selected shapes info is null"),
8;if(this.Vlc(qd))return 8;const Ud=!this.jz.VYe(Ac);if(Hb.JXj(qd)&&Ud)return 8;if(1===$c)return 32;$c=Math.floor(1E3*Fd.Number);for(var ae of Ac)ae.Delay=$c;ae=Wb.w5a(Ac);ae=Wb.iIh(ae,0,$c);this.RNa(Vb,ae,!1);return 32};this.nZa=(Vb,Ac,$c,qd,Fd)=>{Vb=this.eu.r4;if(!this.sa.ut()||!Vb||!Vb.length)return this.A5e(Fd,"0.00"),32;Ac=Vb[0].Delay;$c=!0;for(const Ud of Vb)if(Ac!=Ud.Delay){$c=!1;break}$c?this.A5e(Fd,Number(Ac/1E3).toFixed(2)):this.A5e(Fd,"0.00");return 32};this.KYm=(Vb,Ac,$c)=>{var qd;const Fd=
new Dc.a;Fd.Id="AnimationMenuEffectOptions";Fd.UpdateDynamically=!0;Fd.Title=ResourceStrings.L_EffectOptions;Fd.MenuSectionList=[];if(!this.jz.Sfg(Vb)){const Ud=Vb[0];Fd.MenuSectionList.push(this.jz.bMh(Ud.EffectId,Ud.EffectType,"Direction","2289594085","3782857737"));if(this.jz.YZj(Ud))if(Fd.MenuSectionList.push(Gd.f(Ac.Ve,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),Fd.MenuSectionList.push(Gd.d("Standard Colors","Color.Menu.Controls",
"standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)),this.jwn(Vb)){const ae=null===(qd=Ud.EffectData)||void 0===qd?void 0:qd.Color;qd=new Oe.a(Oe.a.OYh(ae));Gd.h(Fd,qd,Ac.Ve)}else Gd.h(Fd,null,Ac.Ve);Fd.MenuSectionList.push(this.jz.bMh(Ud.EffectId,Ud.EffectType,"EffectData","2949363495","4132852551"))}Fd.MenuSectionList.push(this.jz.ukn($c,this.La,Vb));return Fd};this.Fgn=Vb=>{const Ac=new Bd,$c=this.jz.vhj(Vb);return Vb.toLowerCase().startsWith("spin")?(Ac.Degree=parseFloat($c),
Ac.EffectDataPropType=0,Ac):Vb.toLowerCase().startsWith("transparency")?(Ac.Transparency=parseFloat($c),Ac.EffectDataPropType=2,Ac):Vb.toLowerCase().startsWith("growshrink")?(Ac.Scale=parseFloat($c),Ac.EffectDataPropType=3,Ac):null};this.g2n=(Vb,Ac,$c,qd,Fd,Ud,ae,Yd)=>{if(Fd)return!1;if($c)return this.uXd(Vb,Ud,ResourceStrings.L_AnimationMultiple,Ac,ResourceStrings.L_AnimationMultiple),qd;qd&&(Ud=this.jz.oMh(ae,Yd),{image:Ud,label:$c}=this.jz.uLh(Ud),this.uXd(Vb,Ud,$c,Ac,$c));return qd};this.uXd=
(Vb,Ac,$c,qd,Fd)=>{let Ud;Ud=Vb===this.Eib?"298832323":Vb===this.pbd?"1264919631":"2676673376";Ac=Ac.substring((Od.a.Pwe+"_").length,Ac.length-6);const ae=new ed.a;ae.Id=Vb;ae.ExternalId="Animation"+Vb;ae.Icon=Ac;ae.Command=Ud;ae.QueryCommand="1852964326";ae.LabelText=$c;ae.FullIconStyle={root:{width:"32px",height:"32px"}};ae.PreviewIconStyle={root:{width:"24px",height:"24px"}};ae.Alt=Fd;qd.YAa=ae};this.getSelectedShapes=()=>{const Vb=[],Ac=this.sa.zd();if(!Ac)return Vb;for(const $c of Ac)$c.get_smartArtModelId()?
Vb.push(this.La.Wv($c)):$c.Eg?Vb.push(this.La.us($c)):Vb.push($c);return Vb};this.f_b=(Vb,Ac)=>{const $c=[];if(!Vb||!Vb.length||!Ac)return $c;const qd=Ac.Nj();if(!qd||!qd.length)return $c;Ac=new Map;for(const Fd of qd)Ac.set(Fd.id.toString(),Fd);for(const Fd of Vb){Vb=Of.a.Vf(Fd.ShapeId);Vb=Ac.get(Vb.toString());if(!Vb)return[];$c.push(Vb)}return $c};this.RNa=(Vb,Ac,$c)=>{Uf.a.Ak("AnimationCommandType",String(Ac.AnimationAction));const qd=this.Tb.Kd(15,void 0,()=>{this.sa.lk();$c&&this.Na.ee()});
oe.a("FixDesignerCrashViaSetUndoActionId")&&(qd.wc=Yc.a.NC);try{qd.tc(Vb),Vb.Uva=Ac}finally{qd&&qd.dispose()}};this.Vlc=Vb=>{if(!Vb||0==Vb.length)return!1;for(const Ac of Vb)if(this.zc.Hd(Ac))return!0;return!1};this.A5e=(Vb,Ac)=>{Vb.queryResult.pga=Ac};this.KWm=(Vb,Ac)=>{this.vwb=Ac.h9l;this.cQh=this.Sde=-1;oe.a("FixScrollAndFocusDuringPreview")&&this.vwb&&this.sa.nj();!this.BDa&&this.vwb?(this.BDa=!0,this.Toc(!1,()=>Ac.zlm("animationPaneOpened"))):this.Toc(!0,()=>Ac.zlm("animationPaneOpened"))};
this.iQn=()=>{this.vwb=!this.vwb;if(oe.a("AddPreviewFlowAdjustments"))if(this.vwb){const Vb=bc.a.create().toString();Pc.a.$(508043415,800,50,"AnimationActor::onAnimationPreviewFromPaneHandler - Initiating preview [previewId: {0}]",Vb);this.la.Ra(Yc.a.wid,2,{t1n:Vb})}else Pc.a.$(508043414,800,50,"AnimationActor::onAnimationPreviewFromPaneHandler - Ending preview"),this.la.Eb(Yc.a.Skc,2);else this.la.Eb(this.vwb?Yc.a.wid:Yc.a.Skc,2)};this.Iin=Vb=>{let Ac=0;for(let $c=0;$c<Vb.length;$c++)0===Vb[$c].SequenceIndex&&
(Ac=Math.max(Ac,Vb[$c].ClickOrder));return Ac};this.X_m=(Vb,Ac)=>{this.cQh=Ac.LWm;this.Sde=Ac.e1m;Vb=oe.a("FixAnimationRibbonBugs")?this.eu.bT:this.sa.ut();Ac=Vb.Nj();Vb=Vb.LYb(Ac);(Ac=Vb.sort((qd,Fd)=>qd.EffectNodeId-Fd.EffectNodeId))&&0<Ac.length&&0===Ac[0].ClickOrder&&--this.Sde;this.Toc(!0);Ac=this.Sde==this.lgm;let $c=0;for(let qd=0;qd<Vb.length;qd++)Vb[qd].SequenceIndex===this.cQh&&Vb[qd].ClickOrder===this.Sde&&($c=Math.max($c,Vb[qd].Delay+Vb[qd].Duration));this.Nnd&&this.Nnd.abd($c,Ac)};if(!ja)throw Error.argumentNull("actionManager");
if(!qb)throw Error.argumentNull("selectionManager");if(!V)throw Error.argumentNull("focusManager");if(!Ea)throw Error.argumentNull("transactionFactory");if(!ra)throw Error.argumentNull("applicationSettings");if(!Za)throw Error.argumentNull("animationHelper");if(!ia)throw Error.argumentNull("graphActionBlockingManager");if(!Va)throw Error.argumentNull("shapeReader");if(!Ab)throw Error.argumentNull("pathManager");if(!gc)throw Error.argumentNull("effectSelectionManager");if(!Hc)throw Error.argumentNull("viewElementEventHandler");
if(!fd)throw Error.argumentNull("graphNodeEventHandlers");if(!hd)throw Error.argumentNull("viewEventNotifier");if(!yd)throw Error.argumentNull("slideReader");if(!Md)throw Error.argumentNull("graphTopologyManager");if(Pe){if(!te)throw Error.argumentNull("ribbonUser");this.Gy=te;this.UEn=Pe}if(oe.a("FixAnimationPaneVisibilityInViewMode")){if(!t)throw Error.argumentNull("appFrame");this.Gb=t}if(!ka)throw Error.argumentNull("graphOperationEventHandler");if(oe.a("DisablePreviewInSvgMode")&&L&&!Ob)throw Error.argumentNull("slideShowCoreHelper");
this.la=ja;this.sa=qb;this.Na=V;this.Tb=Ea;this.HFg=Ab.Eq(Od.a.g2e);this.jz=Za;this.zc=ia;this.La=Va;this.eu=gc;this.VB=Hc;this.QA=fd;this.Oe=hd;this.qc=yd;this.ya=Md;this.Iod=oe.a("AnimationPaneTelemetryEnabled");this.NSh=L;this.Nnd=S;this.nh=ka;this.Ea=ra;this.apd=xb;this.Ina=Ob}Kb(){this.la.ua(Yc.a.hMa,ad.a.application,this.S$n,4);this.la.ua(Yc.a.Knc,ad.a.application,this.Knc,97);this.la.ua(Yc.a.Coc,ad.a.application,this.R$n,4);this.la.ua(Yc.a.oZa,ad.a.application,this.oZa,97);this.la.ua(Yc.a.F_h,
ad.a.application,this.ypn,4);this.la.ua(Yc.a.urd,ad.a.application,this.urd,96);this.la.ua(Yc.a.Boc,ad.a.application,this.Q$n,4);this.la.ua(Yc.a.nZa,ad.a.application,this.nZa,97);this.la.ua(Yc.a.jUa,ad.a.application,this.jUa,97);this.la.ua(Yc.a.NC,ad.a.application,this.NC,13);this.la.ua(Yc.a.b$c,ad.a.application,this.NC,13);this.la.ua(Yc.a.c$c,ad.a.application,this.NC,5);this.la.ua(Yc.a.zfc,ad.a.application,this.NC,5);this.la.ua(Yc.a.kBe,ad.a.application,this.bOk,100);this.la.ua(Yc.a.xfc,ad.a.application,
this.xfc,13);this.la.ua(Yc.a.Mcc,ad.a.application,this.Mcc,97);this.la.ua(Yc.a.yfc,ad.a.application,this.yfc,12);this.la.ua(Yc.a.Ncc,ad.a.application,this.Ncc,96);this.la.ua(Yc.a.MGe,ad.a.application,this.d$c,13);this.la.ua(Yc.a.NGe,ad.a.application,this.d$c,13);this.la.ua(Yc.a.OGe,ad.a.application,this.d$c,13);this.la.ua(Yc.a.PGe,ad.a.application,this.d$c,13);this.la.ua(Yc.a.kUa,ad.a.application,this.kUa,97);this.la.ua(Yc.a.Ibc,ad.a.application,this.Ibc,96);this.la.ua(Yc.a.ncb,ad.a.application,this.ncb,
12);this.la.ua(Yc.a.Are,ad.a.application,this.Gjm,4);this.la.ua(Yc.a.Bre,ad.a.application,this.Gjm,4);this.la.ua(Yc.a.Rwh,ad.a.application,this.xlo,4);this.sa.AO(this.onSelectionChange);this.VB.Uxf(this.onSelectionChange);this.VB.Hha(this.onActiveSlideDomReady);this.QA.Rm(this.Qh);this.Oe.Sjc(this.mab);oe.a("ShowAnimationMarkerOnUndo")&&(this.nh.Jpa(this.Cac),this.nh.BTe(this.SFe));this.NSh&&(this.Oe.yPl(this.KWm),this.NSh.cVm(this.X_m),this.Ena=!0);oe.a("FixMarkersForShapeDeleteAndUndo")&&this.VB.iid(this.$zb);
this.UEn&&this.la.ua(Yc.a.vFh,ad.a.application,this.XSm,4);oe.a("FixAnimationPaneVisibilityInViewMode")&&this.Gb.zO(ja=>{this.uw(ja)})}Ae(){}rbm(ja,qb,V){oe.a("AddAnimationContextInInteractiveEvent")&&(ja=this.la.oR(ja))&&mc.ActionManager.yO(ja.interactive_uid,qb,V)}uw(ja){1===ja.mode&&this.BDa&&this.MEj()}D2l(ja){if(null===ja||void 0===ja||!ja.length)return[];const qb=new Set,V=[];ja.forEach(Ea=>{qb.has(Ea.id)||(qb.add(Ea.id),V.push(Ea))});return V}FPc(ja,qb){return ja&&qb?ja.equals(qb.slideId):
!1}NTj(ja){return this.Ea.getBooleanAppSetting("LocalAnimationMarkerRendering")&&oe.a(ja)}M5l(ja){var qb=Date.now();if(ja&&ja.changeAnimationRelationshipInfo){var V=this.eu.r4,Ea=this.sa.ut();Ea&&V&&V.length?(ja=ja.changeAnimationRelationshipInfo,V=Wb.w5a(V),V=Wb.lWl(V,ja.startType),this.RNa(Ea,V,!1),this.Iod&&(qb=Date.now()-qb,Eb.c(Yc.a.hMa,!0,void 0,0,30,qb))):Pc.a.$(509444173,800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: slide or selected animation info is null")}else Pc.a.$(509444174,
800,10,"AnimationActor::handleChangeAnimationRelationshipInfo: change relationship info is null")}g6l(ja){const qb=Date.now();if(ja&&ja.modifyAnimationInfo){var V=this.eu.r4,Ea=this.sa.ut();if(Ea&&V&&V.length)if(oe.a("FixAnimationPaneActionContextNullIssue")){var Za=Uf.a.Xk("SetAnimationDuration",1);0==ja.modifyAnimationInfo.modifyAnimationType&&(Za.actionName="SetAnimationDelay");Za.Oq=!0;Uf.a.PB(Za,()=>{var ia=Wb.w5a(V);if(ia=Wb.j2l(ja.modifyAnimationInfo,ia)){if(this.RNa(Ea,ia,!1),this.Iod){ia=
null;switch(ja.modifyAnimationInfo.modifyAnimationType){case 0:ia=Yc.a.Boc;break;case 1:ia=Yc.a.Coc}if(ia){const Va=Date.now()-qb;Eb.c(ia,!0,void 0,0,30,Va)}}}else Pc.a.$(509444170,800,10,"AnimationActor::handleModifyAnimation: command info is null, invalid modify prop type might be passed")})}else if(Za=Wb.w5a(V),Za=Wb.j2l(ja.modifyAnimationInfo,Za)){if(this.RNa(Ea,Za,!1),this.Iod){Za=null;switch(ja.modifyAnimationInfo.modifyAnimationType){case 0:Za=Yc.a.Boc;break;case 1:Za=Yc.a.Coc}if(Za){const ia=
Date.now()-qb;Eb.c(Za,!0,void 0,0,30,ia)}}}else Pc.a.$(508829900,800,10,"AnimationActor::handleModifyAnimation: command info is null, invalid modify prop type might be passed");else Pc.a.$(509444171,800,10,"AnimationActor::handleModifyAnimation: slide or selected animation info is null")}else Pc.a.$(509444172,800,10,"AnimationActor::handleModifyAnimation: modify info is null")}q6l(ja){const qb=Date.now(),V=ja.reorderAnimationInfo;if(ja&&V){var Ea=this.eu.r4,Za=ja.reorderAnimationInfo.refAnimationId,
ia=this.sa.ut();if(ia&&Ea&&Ea.length&&Za)if(oe.a("FixAnimationPaneActionContextNullIssue"))ja=Uf.a.Xk("MoveAnimationEarlier",1),ja.Oq=!0,ja.actionName=Za.effectNodeId<Ea[0].EffectNodeId?"MoveAnimationEarlier":"MoveAnimationLater",Uf.a.PB(ja,()=>{var Va=new ge;Va.EffectNodeId=Za.effectNodeId;Va.ShapeId=Za.shapeId;const Ab=Wb.w5a(Ea);Va=Wb.iUi(Ab,Va,V.isLater);this.RNa(ia,Va,!0);this.Iod&&(Va=Date.now()-qb,Eb.c(Za.effectNodeId<Ea[0].EffectNodeId?Yc.a.Are:Yc.a.Bre,!0,void 0,0,30,Va))});else{ja=new ge;
ja.EffectNodeId=Za.effectNodeId;ja.ShapeId=Za.shapeId;const Va=Wb.w5a(Ea);ja=Wb.iUi(Va,ja,V.isLater);this.RNa(ia,ja,!0);this.Iod&&(ja=Date.now()-qb,Eb.c(Za.effectNodeId<Ea[0].EffectNodeId?Yc.a.Are:Yc.a.Bre,!0,void 0,0,30,ja))}else Pc.a.$(509444168,800,10,"AnimationActor::handleReorderAnimation: slide, selected or ref animation info is null")}else Pc.a.$(509444169,800,10,"AnimationActor::handleReorderAnimation: reorder animation info is null")}static j2l(ja,qb){switch(ja.modifyAnimationType){case 0:return Wb.iIh(qb,
0,ja.delay);case 1:return Wb.iIh(qb,1,ja.duration);default:return null}}jwn(ja){var qb;if(!(ja&&ja.length&&!this.jz.Sfg(ja)&&this.jz.YZj(ja[0])&&ja[0].EffectData&&ja[0].EffectData.Color))return!1;const V=null===(qb=ja[0].EffectData)||void 0===qb?void 0:qb.Color;for(const Ea of ja){if(!Ea.EffectData||!Ea.EffectData.Color)return!1;ja=Ea.EffectData.Color;if(ja[0]!=V[0]||ja[1]!=V[1]||ja[2]!=V[2])return!1}return!0}static lWl(ja,qb){const V=new Dd.a;V.AnimationAction=4;const Ea=new bf;Ea.TargetEffects=
ja;Ea.StartType=qb;V.ChangeAnimationRelationshipInfo=Ea;return V}static iIh(ja,qb,V){const Ea=new Dd.a;Ea.AnimationAction=1;const Za=new ze;Za.TargetEffects=ja;Za.ModifyAnimPropType=qb;1===qb?Za.Duration=V:Za.Delay=V;Ea.ModifyAnimationInfo=Za;return Ea}static iUi(ja,qb,V){const Ea=new Dd.a;Ea.AnimationAction=6;const Za=new Cf;Za.TargetEffects=ja;Za.IsLater=V;Za.RefEffect=qb;Ea.ReorderAnimationEffectsInfo=Za;return Ea}static Z8k(ja,qb){let V="";switch(qb){case 0:V=ResourceStrings.l_AnimationStartOptionOnClick;
break;case 1:V=ResourceStrings.l_AnimationStartOptionWithPrevious;break;case 2:V=ResourceStrings.l_AnimationStartOptionAfterPrevious}ja.xZ=V;ja.Afc(!0)}}Wb.umn=ja=>{const qb=[];if(!ja||!ja.length)return qb;for(const V of ja)ja=new ge,ja.EffectNodeId=V.effectNodeId,ja.ShapeId=V.shapeId,qb.push(ja);return qb};Wb.Len=ja=>{switch(ja){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}};Wb.nen=(ja,qb,V,Ea,Za)=>0==qb&&0==V?Wb.kgn(Za):
Ea?Wb.F1l(ja,qb,V,!0):Wb.f4l(Za,qb,V);Wb.f4l=(ja,qb,V)=>{const Ea=new Dd.a;Ea.AnimationAction=2;const Za=new ve;if(!ja||!ja.length)return Pc.a.$(509703434,800,15,"AnimationActor::getReplaceAnimationCommandInfo:  animation info is null or empty"),null;Za.TargetEffects=Wb.w5a(ja);Za.EffectId=qb;Za.EffectType=V;Ea.ReplaceAnimationInfo=Za;return Ea};Wb.kgn=ja=>ja&&ja.length?Wb.qWl(Wb.w5a(ja)):(Pc.a.$(509703433,800,15,"AnimationActor::getDeleteAnimationCommandInfo:  animation info is null or empty"),null);
Wb.F1l=(ja,qb,V,Ea)=>{const Za=new Dd.a;Za.AnimationAction=0;const ia=new Sd;ia.EffectId=qb;ia.EffectType=V;ia.ShapeIds=[];ia.FRemoveExisting=Ea;for(const Va of ja)ia.ShapeIds.push(Va.id.toString());Za.AddAnimationInfo=ia;return Za};Wb.qWl=ja=>{const qb=new Dd.a;qb.AnimationAction=3;const V=new He;V.TargetEffects=ja;qb.DeleteAnimationInfo=V;return qb};Wb.Oln=ja=>{switch(ja.toLocaleLowerCase()){case "on click":return 0;case "with previous":return 1;case "after previous":return 2}return 3};Wb.w5a=ja=>
{if(!ja||!ja.length)return null;const qb=[];for(const V of ja)ja=new ge,ja.EffectNodeId=V.EffectNodeId,ja.ShapeId=V.ShapeId,qb.push(ja);return qb};Wb.vyn=(ja,qb)=>{if(!ja||!qb||!qb.length)return!1;for(const V of qb)if(V.ZZ||V.au||oe.a("FixAnimationRibbonBugs")?0:V.xm)return!1;return!0};Wb.uyn=ja=>{if(!ja||!ja.length)return!1;for(const qb of ja)if(qb.gd||qb.Im||oe.a("FixAnimationRibbonBugs")?0:qb.xm)return!1;return!0};Wb.kwn=ja=>{if(!ja||!ja.length)return!1;const qb=ja[0].Direction;for(let V=1;V<ja.length;V++)if(ja[V].Direction!=
qb)return!1;return!0};Wb.iwn=ja=>{if(!ja||!ja.length)return!1;const qb=ja[0].BuildType;for(let V=1;V<ja.length;V++)if(ja[V].BuildType!=qb)return!1;return!0};Wb.Ggn=ja=>{if(!ja)return"";switch(ja.EffectDataPropType){case 0:return ja.Degree.toString();case 3:return ja.Scale.toString();case 2:return ja.Transparency.toString()}return""};Wb.e2n=(ja,qb,V,Ea)=>{V?(ja.vIb=ResourceStrings.L_AnimationExisting,Ea&&(Ea=!1)):qb&&(ja.vIb=ResourceStrings.L_AnimationMultiple);return Ea};Object(m.a)(Wb,"AnimationActor",
null,[502]);class Jc{constructor(){this.BuildId=0;this.BuildIds=null;this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.EffectType=this.EffectId=0;this.HasTrigger=this.HasMultiple=this.HasExisting=!1;this.Id=null;this.IsTrigger=this.IsTextRangeType=!1;this.ParaRangeStart=this.ParaRangeEnd=0;this.RenderAnimationImage=!1;this.StartType=this.SequenceIndex=this.SequenceId=0}}Object(m.a)(Jc,"EditAnimationInfo",null,[]);var jd;(function(ja){ja[ja.invalid=0]="invalid";ja[ja.basicBlockList=
1]="basicBlockList";ja[ja.alternatingHexagons=2]="alternatingHexagons";ja[ja.pictureCaptionList=3]="pictureCaptionList";ja[ja.linedList=4]="linedList";ja[ja.verticalBulletList=5]="verticalBulletList";ja[ja.verticalBoxList=6]="verticalBoxList";ja[ja.verticalBracketList=7]="verticalBracketList";ja[ja.varyingWidthList=8]="varyingWidthList";ja[ja.tabList=9]="tabList";ja[ja.horizontalBulletList=10]="horizontalBulletList";ja[ja.squareAccentList=11]="squareAccentList";ja[ja.pictureAccentList=12]="pictureAccentList";
ja[ja.bendingPictureAccentList=13]="bendingPictureAccentList";ja[ja.stackedList=14]="stackedList";ja[ja.increasingCircleProcess=15]="increasingCircleProcess";ja[ja.pieProcess=16]="pieProcess";ja[ja.detailedProcess=17]="detailedProcess";ja[ja.groupedList=18]="groupedList";ja[ja.horizontalPictureList=19]="horizontalPictureList";ja[ja.continuousPictureList=20]="continuousPictureList";ja[ja.pictureStrips=21]="pictureStrips";ja[ja.verticalPictureList=22]="verticalPictureList";ja[ja.alternatingPictureBlocks=
23]="alternatingPictureBlocks";ja[ja.verticalPictureAccentList=24]="verticalPictureAccentList";ja[ja.titledPictureAccentList=25]="titledPictureAccentList";ja[ja.verticalBlockList=26]="verticalBlockList";ja[ja.verticalChevronList=27]="verticalChevronList";ja[ja.verticalAccentList=28]="verticalAccentList";ja[ja.verticalArrowList=29]="verticalArrowList";ja[ja.trapezoidList=30]="trapezoidList";ja[ja.descendingBlockList=31]="descendingBlockList";ja[ja.tableList=32]="tableList";ja[ja.segmentedProcess=33]=
"segmentedProcess";ja[ja.verticalCurvedList=34]="verticalCurvedList";ja[ja.pyramidList=35]="pyramidList";ja[ja.targetList=36]="targetList";ja[ja.hierarchyList=37]="hierarchyList";ja[ja.verticalCircleList=38]="verticalCircleList";ja[ja.tableHierarchy=39]="tableHierarchy";ja[ja.architectureLayout=40]="architectureLayout";ja[ja.basicProcess=41]="basicProcess";ja[ja.stepUpProcess=42]="stepUpProcess";ja[ja.stepDownProcess=43]="stepDownProcess";ja[ja.accentProcess=44]="accentProcess";ja[ja.pictureAccentProcess=
45]="pictureAccentProcess";ja[ja.alternatingFlow=46]="alternatingFlow";ja[ja.continuousBlockProcess=47]="continuousBlockProcess";ja[ja.increasingArrowsProcess=48]="increasingArrowsProcess";ja[ja.interconnectedBlockProcess=49]="interconnectedBlockProcess";ja[ja.continuousArrowProcess=50]="continuousArrowProcess";ja[ja.convergingText=51]="convergingText";ja[ja.processArrows=52]="processArrows";ja[ja.circleAccentTimeline=53]="circleAccentTimeline";ja[ja.basicTimeline=54]="basicTimeline";ja[ja.circleProcess=
55]="circleProcess";ja[ja.basicChevronProcess=56]="basicChevronProcess";ja[ja.chevronAccentProcess=57]="chevronAccentProcess";ja[ja.closedChevronProcess=58]="closedChevronProcess";ja[ja.chevronList=59]="chevronList";ja[ja.subStepProcess=60]="subStepProcess";ja[ja.phasedProcess=61]="phasedProcess";ja[ja.randomtoResultProcess=62]="randomtoResultProcess";ja[ja.verticalProcess=63]="verticalProcess";ja[ja.staggeredProcess=64]="staggeredProcess";ja[ja.processList=65]="processList";ja[ja.circleArrowProcess=
66]="circleArrowProcess";ja[ja.basicBendingProcess=67]="basicBendingProcess";ja[ja.repeatingBendingProcess=68]="repeatingBendingProcess";ja[ja.verticalBendingProcess=69]="verticalBendingProcess";ja[ja.ascendingPictureAccentProcess=70]="ascendingPictureAccentProcess";ja[ja.upwardArrow=71]="upwardArrow";ja[ja.descendingProcess=72]="descendingProcess";ja[ja.circularBendingProcess=73]="circularBendingProcess";ja[ja.equation=74]="equation";ja[ja.verticalEquation=75]="verticalEquation";ja[ja.funnel=76]=
"funnel";ja[ja.gear=77]="gear";ja[ja.arrowRibbon=78]="arrowRibbon";ja[ja.opposingArrows=79]="opposingArrows";ja[ja.convergingArrows=80]="convergingArrows";ja[ja.divergingArrows=81]="divergingArrows";ja[ja.basicCycle=82]="basicCycle";ja[ja.textCycle=83]="textCycle";ja[ja.blockCycle=84]="blockCycle";ja[ja.nondirectionalCycle=85]="nondirectionalCycle";ja[ja.continuousCycle=86]="continuousCycle";ja[ja.multidirectionalCycle=87]="multidirectionalCycle";ja[ja.segmentedCycle=88]="segmentedCycle";ja[ja.basicPie=
89]="basicPie";ja[ja.hexagonRadial=90]="hexagonRadial";ja[ja.radialCycle=91]="radialCycle";ja[ja.basicRadial=92]="basicRadial";ja[ja.divergingRadial=93]="divergingRadial";ja[ja.radialVenn=94]="radialVenn";ja[ja.cycleMatrix=95]="cycleMatrix";ja[ja.radialCluster=96]="radialCluster";ja[ja.organizationChart=97]="organizationChart";ja[ja.pictureOrganizationChart=98]="pictureOrganizationChart";ja[ja.nameandTitleOrganizationChart=99]="nameandTitleOrganizationChart";ja[ja.halfCircleOrganizationChart=100]=
"halfCircleOrganizationChart";ja[ja.circlePictureHierarchy=101]="circlePictureHierarchy";ja[ja.hierarchy=102]="hierarchy";ja[ja.labeledHierarchy=103]="labeledHierarchy";ja[ja.horizontalOrganizationChart=104]="horizontalOrganizationChart";ja[ja.horizontalMultiLevelHierarchy=105]="horizontalMultiLevelHierarchy";ja[ja.horizontalHierarchy=106]="horizontalHierarchy";ja[ja.horizontalLabeledHierarchy=107]="horizontalLabeledHierarchy";ja[ja.balance=108]="balance";ja[ja.circleRelationship=109]="circleRelationship";
ja[ja.hexagonCluster=110]="hexagonCluster";ja[ja.opposingIdeas=111]="opposingIdeas";ja[ja.plusandMinus=112]="plusandMinus";ja[ja.reverseList=113]="reverseList";ja[ja.counterbalanceArrows=114]="counterbalanceArrows";ja[ja.segmentedPyramid=115]="segmentedPyramid";ja[ja.nestedTarget=116]="nestedTarget";ja[ja.convergingRadial=117]="convergingRadial";ja[ja.radialList=118]="radialList";ja[ja.tabbedArc=119]="tabbedArc";ja[ja.basicTarget=120]="basicTarget";ja[ja.basicVenn=121]="basicVenn";ja[ja.linearVenn=
122]="linearVenn";ja[ja.stackedVenn=123]="stackedVenn";ja[ja.interconnectedRings=124]="interconnectedRings";ja[ja.basicMatrix=125]="basicMatrix";ja[ja.titledMatrix=126]="titledMatrix";ja[ja.gridMatrix=127]="gridMatrix";ja[ja.basicPyramid=128]="basicPyramid";ja[ja.invertedPyramid=129]="invertedPyramid";ja[ja.accentedPicture=130]="accentedPicture";ja[ja.circularPictureCallout=131]="circularPictureCallout";ja[ja.radialPictureList=132]="radialPictureList";ja[ja.snapshotPictureList=133]="snapshotPictureList";
ja[ja.spiralPicture=134]="spiralPicture";ja[ja.captionedPictures=135]="captionedPictures";ja[ja.bendingPictureCaption=136]="bendingPictureCaption";ja[ja.pictureFrame=137]="pictureFrame";ja[ja.bendingPictureSemiTransparentText=138]="bendingPictureSemiTransparentText";ja[ja.bendingPictureBlocks=139]="bendingPictureBlocks";ja[ja.bendingPictureCaptionList=140]="bendingPictureCaptionList";ja[ja.titledPictureBlocks=141]="titledPictureBlocks";ja[ja.pictureGrid=142]="pictureGrid";ja[ja.pictureAccentBlocks=
143]="pictureAccentBlocks";ja[ja.themePictureAccent=144]="themePictureAccent";ja[ja.themePictureGrid=145]="themePictureGrid";ja[ja.themePictureAlternatingAccent=146]="themePictureAlternatingAccent";ja[ja.alternatingPictureCircles=147]="alternatingPictureCircles";ja[ja.titlePictureLineup=148]="titlePictureLineup";ja[ja.pictureLineup=149]="pictureLineup";ja[ja.framedTextPicture=150]="framedTextPicture";ja[ja.bubblePictureList=151]="bubblePictureList";ja[ja.linearArrowProcessNumbered=152]="linearArrowProcessNumbered";
ja[ja.linearBlockProcessNumbered=153]="linearBlockProcessNumbered";ja[ja.basicLinearProcessNumbered=154]="basicLinearProcessNumbered";ja[ja.accentHomeChevronProcess=155]="accentHomeChevronProcess";ja[ja.basicProcessNew=156]="basicProcessNew";ja[ja.basicTimelineNew=157]="basicTimelineNew";ja[ja.chevronBlockProcess=158]="chevronBlockProcess";ja[ja.hexagonTimeline=159]="hexagonTimeline";ja[ja.horizontalActionList=160]="horizontalActionList";ja[ja.repeatingBendingProcessNew=161]="repeatingBendingProcessNew";
ja[ja.roundedRectangleTimeline=162]="roundedRectangleTimeline";ja[ja.verticalDownArrowProcess=163]="verticalDownArrowProcess";ja[ja.verticalHollowActionList=164]="verticalHollowActionList";ja[ja.verticalSolidActionList=165]="verticalSolidActionList";ja[ja.dropPinTimeline=166]="dropPinTimeline";ja[ja.horizontalLabelsTimeline=167]="horizontalLabelsTimeline";ja[ja.horizontalPathTimeline=168]="horizontalPathTimeline";ja[ja.iconLabelList=169]="iconLabelList";ja[ja.iconCircleList=170]="iconCircleList";
ja[ja.iconLabelDescriptionList=171]="iconLabelDescriptionList";ja[ja.iconVerticalSolidList=172]="iconVerticalSolidList";ja[ja.iconCircleLabelList=173]="iconCircleLabelList";ja[ja.iconCircleOutlineLabelList=174]="iconCircleOutlineLabelList";ja[ja.iconLeafLabelList=175]="iconLeafLabelList";ja[ja.iconLeafOutlineLabelList=176]="iconLeafOutlineLabelList";ja[ja.centeredIconLabelDescriptionList=177]="centeredIconLabelDescriptionList"})(jd||(jd={}));Object(m.b)("SmartArtLayout",jd);var xd;(function(ja){ja[ja.title=
0]="title";ja[ja.body=1]="body";ja[ja.centerTitle=2]="centerTitle";ja[ja.subTitle=3]="subTitle";ja[ja.slideNum=5]="slideNum";ja[ja.footer=6]="footer";ja[ja.object=8]="object";ja[ja.graph=9]="graph";ja[ja.table=10]="table";ja[ja.clipArt=11]="clipArt";ja[ja.orgChart=12]="orgChart";ja[ja.media=13]="media";ja[ja.picture=15]="picture";ja[ja.cameo=16]="cameo"})(xd||(xd={}));Object(m.b)("PlaceholderType",xd);class Ad{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc){this.Eib="Existing";this.pbd="ExistingInMenu";
this.nml="AnimationExisting";this.oml="AnimationExistingInMenu";this.la=ja;this.Zr=qb;this.sa=V;this.HFg=Hc.Eq(Od.a.g2e);this.Tb=Za;this.Na=Ea;this.jz=ia;this.zc=Va;this.VEn=Ab.V2e;this.La=gc;this.dgk=oe.a("SetAnimationTelemetryCustomDataEnabled")}Kb(){this.la.ua(Yc.a.jUa,ad.a.application,Object(da.a)(this,this.jUa,"queryAnimationGallery"),97);this.la.ua(Yc.a.qXh,ad.a.application,Object(da.a)(this,this.qXh,"queryMoreAnimationGallery"),96);this.la.ua(Yc.a.NC,ad.a.application,Object(da.a)(this,this.NC,
"setAnimation"),5|(this.dgk?8:0));this.la.ua(Yc.a.b$c,ad.a.application,Object(da.a)(this,this.NC,"setAnimation"),5|(this.dgk?8:0));this.la.ua(Yc.a.c$c,ad.a.application,Object(da.a)(this,this.NC,"setAnimation"),5);this.la.ua(Yc.a.zfc,ad.a.application,Object(da.a)(this,this.NC,"setAnimation"),5);this.la.ua(Yc.a.kBe,ad.a.application,Object(da.a)(this,this.bOk,"queryEffectOptions"),100);this.la.ua(Yc.a.xfc,ad.a.application,Object(da.a)(this,this.xfc,"setAnimationDirection"),5);this.la.ua(Yc.a.Mcc,ad.a.application,
Object(da.a)(this,this.Mcc,"queryAnimationDirection"),97);this.la.ua(Yc.a.yfc,ad.a.application,Object(da.a)(this,this.yfc,"setAnimationEffectData"),4);this.la.ua(Yc.a.Ncc,ad.a.application,Object(da.a)(this,this.Ncc,"queryAnimationEffectData"),96);this.la.ua(Yc.a.MGe,ad.a.application,Object(da.a)(this,this.d$c,"setAnimationSequence"),5);this.la.ua(Yc.a.NGe,ad.a.application,Object(da.a)(this,this.d$c,"setAnimationSequence"),5);this.la.ua(Yc.a.OGe,ad.a.application,Object(da.a)(this,this.d$c,"setAnimationSequence"),
5);this.la.ua(Yc.a.PGe,ad.a.application,Object(da.a)(this,this.d$c,"setAnimationSequence"),5);this.la.ua(Yc.a.kUa,ad.a.application,Object(da.a)(this,this.kUa,"queryAnimationSequence"),97);this.la.ua(Yc.a.jdh,ad.a.application,Object(da.a)(this,this.Sla,"reorderAnimation"),4);this.la.ua(Yc.a.kdh,ad.a.application,Object(da.a)(this,this.Sla,"reorderAnimation"),4);this.la.ua(Yc.a.Ibc,ad.a.application,Object(da.a)(this,this.Ibc,"populateAnimationEffectOptions"),96);this.la.ua(Yc.a.ncb,ad.a.application,
Object(da.a)(this,this.ncb,"setAnimationColor"),4)}Ae(){}Ibc(ja,qb,V,Ea,Za){ja=this.wrb();qb=this.sa.ut();if(!qb||!ja)return 8;if(1===V)return 32;V=Ad.sBa(qb,ja);if(!V||0===V.EffectId)return 16;Za.MenuItems=this.JYm(V,qb,ja);return 32}jUa(ja,qb,V,Ea,Za){ja=Za.queryResult;Za=Za.SourceControlId;var ia=Ea=-1;Za!==this.Eib&&({effectType:ia,effectId:Ea}=this.jz.tLh(Za));qb=this.wrb();var Va=this.sa.ut();if(!Va||!qb)return 8;if(1!==V)return 32;const {image:Ab,label:gc}=this.jz.uLh(Za);V=gc;if(Za===this.Eib||
Za===this.pbd)V=ResourceStrings.L_ExistingButtonDescription;this.uXd(Za,Ab,gc,ja,V);var Hc=Ad.sBa(Va,qb);V=Hc?Hc.EffectId:0;const fd=Hc?Hc.EffectType:0,hd=!this.jz.H9d(Hc,qb);Hc=this.jz.rUj(Hc,qb);this.VEn&&(Va=Va?Va.s5a(qb):null,Hc=Hc&&!this.jz.oyn(Va));Ea=!hd&&!Hc&&Ea===V&&ia===fd;ia=hd?!1:this.jz.wOh(fd,V);Za===this.Eib||Za===this.pbd?(ia=Za===this.Eib?this.h2n(this.Eib,ja,Hc,ia,Ab,fd,V):Ad.f2n(ja,Hc,ia),ja.boa(hd||Hc||ia)):qb&&ja.boa(Ea);return 32}h2n(ja,qb,V,Ea,Za,ia,Va){V?this.uXd(ja,Za,ResourceStrings.L_AnimationMultiple,
qb,ResourceStrings.L_AnimationMultiple):Ea&&(Za=this.jz.oMh(ia,Va),{image:Za,label:V}=this.jz.uLh(Za),this.uXd(ja,Za,V,qb,V));return Ea}uXd(ja,qb,V,Ea,Za){let ia;ia=ja===this.Eib?"298832323":ja===this.pbd?"1264919631":"2676673376";qb=qb.substring((Od.a.Pwe+"_").length,qb.length-6);ja=Object.assign(new ed.a,{Id:ja,ExternalId:"Animation"+ja,Icon:qb,Command:ia,QueryCommand:"1852964326",LabelText:V,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},
Alt:Za});Ea.YAa=ja}qXh(ja,qb){if(qb.contextId!==ad.a.application)return 2;ja=this.wrb();return!this.sa.ut()||!ja||ja.ZZ||ja.au||ja.xm?8:this.zc.Hd(ja)?16:32}NC(ja,qb,V,Ea,Za){qb=this.wrb();var ia=this.sa.ut();if(!ia||!qb||qb.ZZ||qb.au||qb.xm)return 8;if(this.zc.Hd(qb))return 16;var Va=Ad.sBa(ia,qb);const Ab=Va?Va.EffectId:-1,gc=Va?Va.EffectType:-1;if(1===V)return ja===Yc.a.c$c||ja===Yc.a.zfc?(Ea=this.jz.wOh(gc,Ab),ia=!!Va&&!this.jz.H9d(Va,qb),ja===Yc.a.zfc&&(Ea=ia?!0:!1),qb=!!Va&&this.jz.rUj(Va,qb),
qb=ia||qb,Ea||qb?32:16):ja===Yc.a.b$c?qb.gd||qb.Im||qb.xm?16:32:32;ja=Za.SourceControlId;if(!ja)return 8;if(ja===this.Eib||ja===this.pbd||ja===this.nml||ja===this.oml)return 32;const {effectType:Hc,effectId:fd}=this.jz.tLh(ja);V=this.jz.cgn(ja);Za=this.jz.agn(ja);Ea&&this.dgk&&(Ea.AD=fd,Ea.AV=Hc);Va=qb.a1b()?Ad.F5f(ia,qb):Va;Va||(Va=new Jc,Va.Id=qb.id.toString(),Va.BuildIds=[ia.mkd+1],Va.HasTrigger=!1,Va.BuildId=ia.mkd+1,Va.SequenceIndex=0,Va.IsTextRangeType=!1);Va.HasExisting=!1;Va.HasMultiple=!1;
Va.EffectType=Hc;Va.SequenceId=1;Va.EffectId=fd;Va.Direction=V;Va.EffectData=Za;Va.IsTrigger=!1;this.pUf(ia,qb,Va);r.ULS.sendTraceTag(512500802,800,50,"AnimationActorLegacy.SetAnimation: Effect={0}, SlideId.Sid={1}, ShapeId={2}",ja,ia.fc.sid,qb.id);this.ACn(ia);return 32}ncb(ja,qb,V,Ea,Za){qb=this.Zr.presentation;if(!qb)throw Error.argumentNull("Presentation is null");ja=this.wrb();if(!ja)return 8;qb=Object(Rb.a)(22,qb.$C(ja.slideId));if(!qb)return 8;Ea=Ad.sBa(qb,ja);if(!(Ea&&Za&&qb&&ja))return 8;
if(this.zc.Hd(ja))return 16;if(1===V)return 32;V=Qf.Box4ColorHelper.JR(Za);V=Qf.Box4ColorHelper.LCb(V,qb.Ve);if(!V)return 8;Ea.EffectData=String.format("{0},{1},{2}",V.r.toString(16),V.g.toString(16),V.b.toString(16));this.pUf(qb,ja,Ea);return 32}bOk(){const ja=this.wrb();var qb=this.sa.ut();return qb&&ja?this.zc.Hd(ja)?16:(qb=Ad.sBa(qb,ja))&&this.jz.E_m(ja,this.La,qb)?32:16:8}Sla(ja,qb,V){qb=this.wrb();const Ea=this.sa.ut();if(!Ea||!qb)return 8;if(this.zc.Hd(qb))return 16;const Za=Ad.F5f(Ea,qb);
let ia;switch(ja){case Yc.a.jdh:ia=!1;break;case Yc.a.kdh:ia=!0;break;default:return 8}let Va=!1;if(qb&&(Va=!!Za&&!Za.HasTrigger&&1===Za.BuildIds.length)){let Ab=!1,gc=!1;({pFf:Ab,sFf:gc}=Ad.J_m(Ea,Za));Va=ia?gc&&Va:Ab&&Va}if(1===V)return Va?32:8;if(Va){V=this.Tb.Kd(15,void 0,()=>{this.sa.lk();this.Na.ee()});try{V.tc(Ea),V.wc=ja,Ea.Sla(qb,ia)}finally{V&&V.dispose()}}return 32}xfc(ja,qb,V,Ea,Za){ja=this.wrb();qb=this.sa.ut();if(!qb||!ja)return 8;if(1===V)return 32;if(this.zc.Hd(ja))return 16;V=Ad.F5f(qb,
ja);if(!V)return 8;Za=Za.MenuItemId;V.Direction=this.jz.C0f(Za);this.pUf(qb,ja,V);r.ULS.sendTraceTag(512500801,800,50,"AnimationActorLegacy.SetAnimationDirection: Effect={0}, EffectDirection={1}, SlideId.Sid={2}, ShapeId={3}",this.jz.oMh(V.EffectType,V.EffectId),Za,qb.sid,ja.id);return 32}Mcc(ja,qb,V,Ea,Za){qb=this.wrb();Ea=this.sa.ut();if(!Ea||!qb)return 8;ja=Za.queryResult;Za=this.jz.C0f(Za.MenuItemId);qb=Ad.sBa(Ea,qb);1===V&&qb&&ja.Fg(qb.Direction===Za);return 32}d$c(ja,qb,V,Ea,Za){ja=Za.MenuItemId;
qb=this.wrb();Ea=this.sa.ut();if(!Ea||!qb)return 8;if(1===V)return 32;if(this.zc.Hd(qb))return 16;V=Ad.F5f(Ea,qb);if(!V)return 8;V.SequenceId=this.jz.dqj(ja);this.pUf(Ea,qb,V);return 32}kUa(ja,qb,V,Ea,Za){ja=this.wrb();qb=this.sa.ut();if(!qb||!ja)return 8;ja=Ad.sBa(qb,ja);qb=Za.queryResult;Za=this.jz.dqj(Za.MenuItemId);1===V&&ja&&qb.Fg(ja.SequenceId===Za);return 32}yfc(ja,qb,V,Ea,Za){ja=this.wrb();qb=this.sa.ut();if(!qb||!ja)return 8;if(1===V)return 32;if(this.zc.Hd(ja))return 16;V=Ad.F5f(qb,ja);
if(!V)return 8;if(!Za)return 2;V.EffectData=this.jz.vhj(Za.MenuItemId);this.pUf(qb,ja,V);return 32}Ncc(ja,qb,V,Ea,Za){ja=this.wrb();qb=this.sa.ut();if(!qb||!ja)return 8;ja=Ad.sBa(qb,ja);1===V&&ja&&Za.queryResult.Fg(this.jz.eVl(ja.EffectData,Za.MenuItemId));return 32}pUf(ja,qb,V){const Ea=this.Tb.Kd(15,void 0,()=>{this.sa.lk();this.Na.ee()});try{Ea.tc(ja),ja.Joc(qb,V)}finally{Ea&&Ea.dispose()}}JYm(ja,qb,V){const Ea=Object.assign(new Dc.a,{Id:"AnimationMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_EffectOptions,
MenuSectionList:[]});Array.add(Ea.MenuSectionList,this.jz.bMh(ja.EffectId,ja.EffectType,"Direction","2289594085","3782857737"));this.jz.s9l(ja)&&(Array.add(Ea.MenuSectionList,Gd.f(qb.Ve,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),Array.add(Ea.MenuSectionList,Gd.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)));Array.add(Ea.MenuSectionList,this.jz.bMh(ja.EffectId,ja.EffectType,
"EffectData","2949363495","4132852551"));Array.add(Ea.MenuSectionList,this.jz.tkn(V,this.La,ja));return Ea}ACn(ja){if(ja){var qb=ja.Nj(),V=String.format("{0}#{1}",ja.sid,ja.cid);if(qb&&0<qb.length)for(const Ea of qb)if(qb=ja.QOa(Ea)){const Za=qb.EffectId,ia=qb.EffectType,Va=qb.Direction,Ab=this.jz.oMh(ia,Za),gc=this.La.DLh(Ea),Hc=Ad.sln(Ea,gc);r.ULS.sendTraceTag(512500800,800,50,"Slide animation info: Effect={0}, EffectID={1}, EffectType={2}, Direction={3}, Len={4}, ShapeType={5}, ShapeSubType={6}, SeqID={7}, SlideID={8}, ShapeID={9}",
Ab,Za,ia,Va,Ea.HJ().length,gc,Hc,qb.SequenceId,V,Ea.id)}}}wrb(){const ja=this.sa.Uo();return ja?ja.get_smartArtModelId()?this.La.Wv(ja):ja.Eg?this.La.us(ja):ja:null}static f2n(ja,qb,V){qb?ja.vIb=ResourceStrings.L_AnimationMultiple:(ja.vIb=ResourceStrings.L_AnimationExisting,V&&(V=!1));return V}static J_m(ja,qb){let V,Ea;if(!qb)return{pFf:!1,sFf:!1};const Za=ja.QVe,ia=ja.mkd,Va=qb.BuildIds[0];Ea=V=!0;0===qb.StartType?V=Va>Za?!0:!1:Ea=Va<ia?!0:!1;if(Va===Za||Va===ia){if(!Va)return{pFf:!1,sFf:Ea};for(const Ab of ja.BS)if(Ab.Id!==
qb.Id)for(const gc of Ab.BuildIds)if(0===qb.StartType){if(gc>=Va)return Ea=!0,{pFf:V,sFf:Ea}}else if(gc===Va)return V=!0,{pFf:V,sFf:Ea};0===qb.StartType?Ea=!1:V=!1}return{pFf:V,sFf:Ea}}static sBa(ja,qb){return ja&&qb?ja.sBa(qb):null}static F5f(ja,qb){return ja&&qb?ja.QOa(qb):null}static sln(ja,qb){return 24===qb?jd[ja.smartArtInfo.SmartArtLayout]:1===qb?ja.shapeType.toString():14===qb?xd[ja.placeholderType]:"Unknown"}}Object(m.a)(Ad,"AnimationActorLegacy",null,[502]);var de=a(16);class De{constructor(ja,
qb,V,Ea,Za){this.lh=null;this.Aa=ja;this.tgd=qb;this.iOm=V;this.Vhi=Ea;this.Ga=Za;this.Vhi.init();this.tgd.init()}Kb(){this.Aa.ua(zb.a.u3c,ad.a.application,Object(da.a)(this,this.u3c,"openGrammarSettings"),1028);this.Aa.Ba(zb.a.DXe,Qa.a.frame,Object(da.a)(this,this.D5l,"grammarDialogTabFocusHandler"));this.Aa.Ba(zb.a.CXe,Qa.a.frame,Object(da.a)(this,this.D5l,"grammarDialogTabFocusHandler"));this.Aa.Ba(zb.a.t8f,Qa.a.frame,Object(da.a)(this,this.C5l,"grammarDialogOptionFocusHandler"));this.Aa.Ba(zb.a.s8f,
Qa.a.frame,Object(da.a)(this,this.C5l,"grammarDialogOptionFocusHandler"))}u3c(ja,qb,V,Ea,Za){ja=this.s2l();if(1===V)return this.Vhi.request(ja).result&&this.Vhi.request(ja).result.length?6===this.tgd.flb.status?32:8:8;this.lh=this.iOm(ja,this.tgd.flb.result);this.lh.showDialog(CommonUIStrings.l_GrammarSettingsDialogTitle,ia=>{r.ULS.sendTraceTag(36489285,375,50,"User click button of {0}",1===ia?"OK":0===ia?"Cancel":"");1===ia&&(this.lh.qzn()?(r.ULS.sendTraceTag(36489286,375,50,"User update proofing options"),
this.tgd.saveSettings(this.lh.settings)):r.ULS.sendTraceTag(36508631,375,50,"User click OK with but not update setting"))});ja=V="";Za&&(V+=Za.SourceControlId,ja+=Za.Alt);r.ULS.sendTraceTag(36489287,375,50,"Open grammar setting dialog, SourceControlId: "+V+", Alt: "+ja);return 32}s2l(){return parseInt(this.Ga.Ma("Lcid")||"1033")}D5l(ja){if(!this.lh)return 2;var qb=this.lh.Tw.yu().fm.T2;if(qb===this.lh.Jx&&ja===zb.a.DXe||qb===this.lh.asd&&ja===zb.a.CXe)this.lh.rza?this.lh.Tw.yu().fm.qO(this.lh.rza):
this.lh.R9n();else if(Sys.UI.DomElement.containsCssClass(qb,Pb.IMf)||qb.parentNode&&Sys.UI.DomElement.containsCssClass(qb.parentNode,Pb.IMf))qb=null,ja===zb.a.DXe?qb=this.lh.asd:ja===zb.a.CXe&&(qb=this.lh.Jx),this.lh.Tw.yu().fm.qO(qb);else if(ja===zb.a.DXe)this.lh.Tw.yu().o0c();else if(ja===zb.a.CXe)this.lh.Tw.yu().n0c();else return 2;return 32}C5l(ja){if(!this.lh)return 2;let qb=this.lh.Tw.yu().fm.T2;if(qb===this.lh.Jx||qb===this.lh.asd||qb===this.lh.aK)return 2;ja===zb.a.s8f&&this.lh.Tw.yu().o0c();
ja===zb.a.t8f&&this.lh.Tw.yu().n0c();qb=this.lh.Tw.yu().fm.T2;qb===this.lh.asd?this.lh.Tw.yu().n0c():qb===this.lh.Jx?this.lh.Tw.yu().o0c():this.lh.rza=qb;return 32}}Object(m.a)(De,"GrammarSettingsActor",null,[]);class Le extends De{constructor(ja,qb,V,Ea,Za,ia,Va){super(ja,qb,V,Ea,de.AFrameworkApplication_AppSettingsManager.ha);this.rb=Za;this.Agk=ia;this.La=Va}s2l(){let ja=parseInt(de.AFrameworkApplication_AppSettingsManager.ha.Ma("Lcid")||"1033");if(this.rb.c8(this.rb.Wa)){var qb=this.rb.zd();qb&&
1===qb.length&&(qb=this.La.g5a(qb[0]),0<qb&&(ja=qb))}else this.rb.Wa.qb&&(qb=this.Agk.$We(this.rb.sk),0<qb&&(ja=qb));return ja}}Object(m.a)(Le,"EditorSettingsActor",De,[]);var Xe=a(80),ie=a(368),If=a(201),qf=a(495),lf=a(285),qe=a(117);class Ne{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd){this.rGf=null;this.Fhm=this.mpd=!1;this.Fpn=(yd,Md,te)=>{this.rGf=this.ya.Ia;yd=this.sa.rg();if(!yd||!yd.length)return 16;for(const Pe of yd)if(!Pe||this.zc.Hd(Pe)||Xe.a.By(Pe.fc))return 16;if(1===te)return 32;
this.Q_h(!1);return 32};this.Ipn=(yd,Md,te)=>{yd=this.ya.Ia;if(!yd||this.zc.Hd(yd))return 8;if(1===te)return 32};this.Hpn=(yd,Md,te,Pe,t)=>{var L;if(!this.Ea.cga)return 8;if(null===t||void 0===t||!t.OriginalUrl)return Pc.a.$(508675585,822,10,"FormatBackgroundActor::handleSlidesPictureFromStockImages : Image Url is absent."),8;this.rGf=this.ya.Ia;Md=this.sa.rg().filter(S=>!!S);if(Md.every(S=>this.zc.Hd(S)))return Pc.a.$(508650910,822,10,"FormatBackgroundActor::handleSlidesPictureFromStockImages : SlideNode is blocked."),
8;if(null===Md||void 0===Md||!Md.length)return Pc.a.$(508678344,822,10,"FormatBackgroundActor::handleSlidesPictureFromStockImages: selected slides are empty"),16;if(1===te)return 32;te=this.Tb.Kd(15,void 0,()=>{this.Na.ee();this.sa.nj()});try{te.tc(this.rGf);te.wc=yd;te.mE[lf.a.Dfb]=lf.a.t3c;for(const S of Md)if(S.hUe=t.OriginalUrl,this.Fhm){const ka=S.ra(Rf.a.wVa,void 0),ra=(null===(L=t.OriginalUrl.match(/\.([a-z]+)$/i))||void 0===L?void 0:L[1])||"",xb=Uf.a.Bb,Ob=this.v7n(t.OriginalUrl,"thumbnails/xlarge."+
ra);this.z4l(Ob,S.To,S.xk,!1,ra).then(Vb=>{const Ac=S.Vg(this.gEa.AJ.Ua);void 0!=Ac&&(S.setValue(Rf.a.wVa,Vb),Ac.DM(qe.a.vG),Ac.draw(qe.a.vG,{},!1),S.setValue(Rf.a.wVa,ka),null===xb||void 0===xb?void 0:xb.Za("BgImgStockDraw",Uf.a.UA().toString()),Vb=null===Uf.a||void 0===Uf.a?void 0:Uf.a.EJc("FormatBackgroundPictureFromStockImagesUpload"),Vb.length&&Vb[0].aG("BGImageFromStockImageLocalDrawComplete",null===Uf.a||void 0===Uf.a?void 0:Uf.a.UA().toString()))}).catch(Vb=>{Pc.a.$(507606749,822,15,"FormatBackgroundActor::handleSlidesPictureFromStockImages : "+
Vb.message);S.setValue(Rf.a.wVa,ka)})}}finally{return null===te||void 0===te?void 0:te.dispose(),32}};this.Dpn=(yd,Md,te)=>{var Pe;Md=this.sa.rg();if(!Md||!Md.length)return Pc.a.$(509362200,822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides are empty"),8;for(const t of Md)if(!t||this.zc.Hd(t))return Pc.a.$(509362199,822,10,"FormatBackgroundActor::handleSlidesBackgroundReset: selected slides is blocked"),8;if(!this.Yco(Md))return Pc.a.$(509362198,822,50,"FormatBackgroundActor::handleSlidesBackgroundReset: The selected slide follow master background"),
8;if(1===te)return 32;null===(Pe=Uf.a.Bb)||void 0===Pe?void 0:Pe.Za("SlideCount",Md.length.toString());te=this.Tb.Kd(15,void 0,()=>{this.Na.ee();this.sa.nj()});try{te.tc(this.ya.Ia);te.wc=yd;for(const t of Md)t.ooc=!0}finally{te&&te.dispose()}return 32};this.Cpn=(yd,Md,te)=>{Md=this.ya.Ia;const Pe=this.sa.Ie();if(!Pe||!Pe.length)return Pc.a.$(508045471,822,10,"FormatBackgroundActor::handleSlidesBackgroundApplyFromPictureThisSlide: no shape selected"),8;if(!Md||this.zc.Hd(Md))return Pc.a.$(508073822,
822,10,"FormatBackgroundActor::handleSlidesBackgroundApplyFromPictureThisSlide: current slide is blocked"),8;if(1===te)return 32;te=this.Tb.Kd(15,void 0,()=>{this.Na.ee();this.sa.nj()});try{te.tc(Md),te.wc=yd,Md.X5e=Pe[0].get_shapeId()}finally{null===te||void 0===te?void 0:te.dispose()}return 32};this.Bpn=(yd,Md,te)=>{var Pe=this.ya.Ia;Md=this.sa.Ie();if(!Md||!Md.length)return Pc.a.$(508045470,822,10,"FormatBackgroundActor::handleSlidesBackgroundApplyFromPictureAllSlides: no shape selected"),8;if(!Pe||
this.zc.Hd(Pe))return 16;if(1===te)return 32;te=Pe.fc;Pe=this.gEa.Tf;if(!Pe)return Pc.a.$(508073821,822,10,"FormatBackgroundActor::handleSlidesBackgroundApplyFromPictureThisSlide: Presentation Node is null"),8;const t=this.Tb.Kd(15,void 0,()=>{this.Na.ee();this.sa.nj()});try{t.tc(Pe),t.wc=yd,Pe.Moc=Md[0].get_shapeId(),Pe.Woc=te}finally{null===t||void 0===t?void 0:t.dispose()}return 32};this.la=ja;this.Na=qb;this.zc=V;this.sa=Ea;this.Tb=Za;this.gEa=ia;this.ya=Va;this.oT=Ab;this.TIa=gc;this.Ogk=Hc;
this.le=fd;this.Ea=hd;this.mpd=this.Ea.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertSlideBGImageInlineEnabled",!1)&&oe.a("SetLocalBGInlineEnabled");this.Fhm=this.Ea.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertSlideBGImageInlineEnabled",!1)&&oe.a("StockImageInlineSlideBGEnabled")}Kb(){this.la.ua(Yc.a.Uba,ad.a.application,Object(da.a)(this,this.Jpn,"handleSlidesSolidFill"),4);this.la.ua(Yc.a.Ukd,ad.a.application,this.Ipn,4);this.la.ua(Yc.a.Tkd,ad.a.application,this.Fpn,
4);this.la.ua(Yc.a.YXf,ad.a.application,this.Hpn,4);this.la.ua(Yc.a.dXd,ad.a.application,Object(da.a)(this,this.Epn,"handleSlidesFinalizePicture"),4);this.la.ua(Yc.a.yYb,ad.a.application,Object(da.a)(this,this.$nn,"handleApplyAll"),4);this.la.ua(Yc.a.Sqd,ad.a.application,Object(da.a)(this,this.apn,"handlePopulateFillMenu"),96);this.la.ua(Yc.a.l1e,ad.a.application,Object(da.a)(this,this.Pon,"handleMoreFormatBackgroundColors"),96);this.la.ua(Yc.a.Q4c,ad.a.application,Object(da.a)(this,this.Qon,"handleMoreFormatBackgroundColorsResponse"),
4);this.la.ua(Yc.a.AYb,ad.a.application,this.Dpn,4);this.Ea.$Ye&&(this.la.ua(Yc.a.cXd,ad.a.application,this.Cpn,4),this.la.ua(Yc.a.bXd,ad.a.application,this.Bpn,4))}Ae(){}apn(ja,qb,V,Ea,Za){Ea=this.ya.Ia;if(!Ea||this.zc.Hd(Ea))return 16;if(1===V)return 32;if(!Za)return Pc.a.$(512500616,822,10,"HandlePopulateFillMenu requires actionData"),8;V=Ea.Ve;if(!V)return Pc.a.$(512500615,822,10,"HandlePopulateFillMenu failed to get theme information from slide"),8;ja=this.gEa.Tf.jfa;qb=Object.assign(new Dc.a,
{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});Array.add(qb.MenuSectionList,Gd.f(V,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColors","3049223287",1));Array.add(qb.MenuSectionList,Gd.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColors","3049223287",!1));oe.a("BackgroundColorHighlightFix")&&(Ea=If.a.parse(Ea.eU),Ea=Qf.Box4ColorHelper.bna(Ea.oHa(),V),Gd.h(qb,Ea,V));ja&&0<ja.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",
!1)),Array.add(qb.MenuSectionList,Gd.c(ja,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors","1912773268",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!0));Array.add(qb.MenuSectionList,Gd.a("More Format Background Color","Color.Menu.Controls","3938657252",ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));
Za.MenuItems=qb;return 32}Jpn(ja,qb,V,Ea,Za){qb=this.sa.rg();if(!qb||!qb.length)return 16;for(const ia of qb)if(!ia||this.zc.Hd(ia))return 16;if(1===V)return 32;V=Ne.tAb(Za);if(!V)return 8;Uf.a.Bb&&Uf.a.Bb.Za("SlideCount",qb.length.toString());Za=this.Tb.Kd(15,void 0,()=>{this.Na.ee();this.sa.nj()});try{Za.tc(this.ya.Ia);Za.wc=ja;for(const ia of qb)ia.IHb=V}finally{Za&&Za.dispose()}return 32}v7n(ja,qb){return ja.replace(/\/([^/]+)(\.[a-z]+)$/i,`/${qb}`)}$nn(ja,qb,V){qb=this.ya.Ia;if(!qb||this.zc.Hd(qb))return 16;
if(1===V)return 32;V=qb.fc;qb=this.gEa.Tf;if(!qb)return 8;const Ea=this.Tb.Kd(15,void 0,()=>{this.Na.ee();this.sa.nj()});try{Ea.tc(qb),Ea.wc=ja,qb.BHb=V}finally{Ea&&Ea.dispose()}return 32}Yco(ja){const qb=this.gEa.Tf;if(!qb)return Pc.a.$(509362197,822,10,"FormatBackgroundActor::shouldEnableResetBackground: Current presentation is null"),!1;for(const Ea of ja)if((ja=Ea.eU)&&-1==ja.indexOf("/BgSource/ContentMaster")&&-1==ja.indexOf("/BgSource/MainMaster")){var V=qb.H0l(Ea.Aj,Ea.Gn);if(!V)return Pc.a.$(509362196,
822,50,"FormatBackgroundActor::shouldEnableResetBackground: Slide master for current slide is null"),!0;V=V.eU;if(!V||!ja.match(V))return!0}return!1}Epn(ja,qb,V,Ea,Za){qb=this.sa.rg();if(!qb||!qb.length)return 16;for(const Va of qb){if(!Va||!Va.isConnected)return 16;const Ab=Uf.a.Bb;if(this.mpd){const gc=Va.jb(Rf.a.wVa);qb=Za.aMc;void 0!=qb?this.z4l(qb,Va.To,Va.xk).then(Hc=>{var fd,hd;Va.setValue(Rf.a.wVa,Hc);Hc=null===(hd=null===(fd=this.gEa)||void 0===fd?void 0:fd.AJ)||void 0===hd?void 0:hd.Ua;
void 0!=Hc&&(fd=Va.Vg(Hc),void 0!=fd&&fd&&(fd.DM(qe.a.vG),fd.draw(qe.a.vG,{},!1),Va.setValue(Rf.a.wVa,gc),null===Ab||void 0===Ab?void 0:Ab.Za("BgImgLocalDrawST",Uf.a.UA().toString())))}).catch(Hc=>{Va.setValue(Rf.a.wVa,gc);Pc.a.$(512500611,822,10,`Unable to resize image blob: Error = ${Hc}`)}):Pc.a.$(507606726,822,10,"Unable to get image data for set image inline")}}if(1===V)return 32;this.TIa.exe=new Date;const ia=Uf.a.Bb;this.oT.r0h(Za,Va=>{Uf.a.SK(ia,()=>{this.Gpn(Va,ja)})},Va=>{this.q$f(Va.error)});
this.ya.Ia===this.rGf&&(this.Na.ee(),this.sa.nj());return 32}goo(ja){if(ja)try{const qb=new URL(ja);if("blob:"===qb.protocol||"data:"===qb.protocol)return ja}catch(qb){throw Pc.a.$(507606724,810,10,`ContentBlockingIndicatorView::getMediaUrl URL conversion exception: ${qb}`),qb;}}z4l(ja,qb,V,Ea=!0,Za=""){return new Promise((ia,Va)=>{const Ab=new Image,gc=document.createElement("canvas"),Hc=gc.getContext("2d"),fd=Ea?ja.split(";")[0]:"image/"+Za,hd=qb/V;Ea||(Ab.crossOrigin="anonymous");oe.a("EnableBGImageCropToSlideAspectRatio")?
Ab.onload=function(){var yd=Ab.width;const Md=Ab.height;let te,Pe;yd/Md>hd?(te=Md*hd,Pe=Md):(te=yd,Pe=yd/hd);gc.width=te;gc.height=Pe;Hc.drawImage(Ab,(yd-te)/2,(Md-Pe)/2,te,Pe,0,0,te,Pe);yd=gc.toDataURL(fd,1);ia(yd)}:Ab.onload=function(){gc.width=qb;gc.height=V;Hc.drawImage(Ab,0,0,gc.width,gc.height);const yd=gc.toDataURL(fd,1);ia(yd)};Ab.onerror=function(yd){Pc.a.$(507609863,822,10,"Could not load image. isBase64: "+Ea+". "+yd);Va(Error("Could not load image. isBase64: "+Ea+". "+yd))};Ea?void 0!=
this.goo(ja)&&(Ab.src=ja):Ab.src=ja})}Pon(ja,qb,V,Ea,Za){ja=this.ya.Ia;if(!ja||this.zc.Hd(ja))return Pc.a.$(507605699,822,10,"HandleMoreFormatBackgroundColors: currentSlide is null"),16;if(this.Ea.wI&&oe.a("MoreColorBackgroundForMultipleSlidesEnabled")?1>this.sa.rg().length:1!==this.sa.rg().length)return 16;if(1===V)return this.la.Ra(Yc.a.renderColorPicker,1,Za);V=If.a.parse(ja.eU);if(!V)return 8;Za=V.oHa();V=null;Za&&(V=Qf.Box4ColorHelper.nwa(Za));Za={};Za.currentColor=V;Za.handleCommand=Yc.a.Q4c;
return this.la.Ra(Yc.a.renderColorPicker,2,Za)}Qon(ja,qb,V,Ea,Za){if(1===V)return this.la.Ra(Yc.a.Uba,V,Za);if(!Za)return Pc.a.$(512500609,822,10,"HandleMoreFormatBackgroundColorsResponse: actionData is null"),16;ja=this.la.Ra(Yc.a.Uba,V,Za);32===ja&&this.la.Ra(Yc.a.Qva,V,Za);return ja}Q_h(ja){this.Ogk?qf.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.oT&&(this.oT.oGb=1,this.oT.rNk(ja))}Gpn(ja,qb){this.TIa.Jqd=new Date;(ja=ja.result)?this.a0m(ja,qb):(qb=Object.assign(new ie.a,
{Code:94}),this.q$f(qb))}a0m(ja,qb){const V=this.sa.rg(),Ea=this.Tb.Kd(15);try{Ea.tc(this.rGf);Ea.wc=qb;for(const Za of V)Za.GG=ja.ItemId}finally{Ea&&Ea.dispose()}if(ja=Uf.a.Bb)ja.actionName="FormatBackgroundPicture",ja.Za("PictureUploadStart",Uf.a.Pf(this.TIa.exe)),ja.Za("PictureUploadDurationMS",(+this.TIa.Jqd-+this.TIa.exe).toString())}q$f(ja){this.TIa.Jqd=new Date;this.le.nM(ja.Code,qb=>{qb.UE=1;qb.Ifb=ja.ExtraErrorParam;return!1})}static tAb(ja){return If.a.parse(ja.Color)}}Object(m.a)(Ne,"FormatBackgroundActor",
null,[502]);var pe=a(92),Wf=a(47),ye=a(486),Xf=a(45),uh=a(177);const fg=ja=>{let qb=ja.isBold?"b:1;":"";qb+=ja.isItalic?"i:1;":"";qb+=ja.isUnderline?"u:1;":"";qb+=ja.SB?"s:1;":"";qb+=ja.isSuperscript?"sup:1;":"";return qb+=ja.pE?"sub:1;":""},pg=(ja,qb,V)=>{let Ea=null;for(var Za,ia=Wf.ParagraphReader.text(ja),Va=0;ja.$a&&Va<ja.$a.length;){var Ab=ja.$a.ka(Va),gc=Ab.cp;Za=Va<ja.$a.length-1?ja.$a.ka(Va+1).cp:Wf.ParagraphReader.textLength(ja);if(-1!==qb&&Za<=qb)Va++;else{if(-1!==V&&gc>V)break;var Hc=
"";Ab.formatting?Hc=fg(Ab.formatting.cache):(Ab=ye.c(ja.$a,Ab.cp).qnd)&&(Hc=fg(Ab.cache));Ab=gc;-1!==qb&&(Ab=Math.max(qb,gc));gc=Za;-1!==V&&(gc=Math.min(V,Za));gc=za.a.substring(ia,Ab,gc);0<gc.length&&(Za=document.createElement("span"),Za.setAttribute("style",Hc),Za.innerText=gc,Ea||(Ea=document.createElement("p")),Ea.appendChild(Za));Va++}}if(Ea&&Wf.ParagraphReader.gY(ja)){qb=Ea;V=qb.setAttribute;Va=new Xf.GraphIterator;Va.set(ja);Va.sc(11);Va.zg(11);ia="";if(ja.jg.Vv(Va))switch(Va=ja.jg.Vv(Va),
ja=Wf.ParagraphReader.gbc(ja),Hc=Va.jY,Va.listType){case 0:switch(Va.listStyle){case 1:ia="decimal";break;case 2:ia="loweralpha";break;case 3:ia="lowerroman";break;case 4:ia="upperalpha";break;case 5:ia="upperroman";break;default:ia="decimal"}ia=String.format("lt:{0};in:{1};li:{2}",ia,ja,Hc);break;case 1:switch(Va.listStyle){case 1:ia="disc";break;case 2:ia="circle";break;case 3:ia="square";break;default:ia="disc"}ia=String.format("lt:{0};in:{1}",ia,ja)}V.call(qb,"style",ia)}return Ea},Kf=ja=>{if(ja){var qb;
(qb=k.a.instance.resolve("PowerPointWebEditor.Graph.ITableReader"))?qb=qb.IS(ja):(Pc.a.$(512500561,822,10,"ImmersiveReader: TableReader is null."),qb=null);if(qb){ja=null;qb=qb.u5a();for(let V=0;V<qb.length;V++){const Ea=hh(Object(Rb.a)(pe.AParagraphNode,qb[V].blc));ja=zh(Ea,ja)}return ja}ja=Array.isArray(ja.HJ())?ja.HJ():null;return hh(ja&&0<ja.length?ja[0]:null)}return null},hh=ja=>{let qb=null;for(;ja;){const V=pg(ja,-1,-1);qb=zh(V,qb);ja=Wf.ParagraphReader.Zqa(ja,!1,!0,!1)}return qb},zh=(ja,qb)=>
{ja&&(qb||(qb=document.createElement("div")),qb.appendChild(ja));return qb},cg=ja=>{const qb=Object.assign(new uh.a,{Source:6});k.a.instance.resolve("PowerPointWebEditor.IErrorHandler").Vs(qb,ja,V=>{V.UE=1;V.aIa=0;V.title=ResourceStrings.L_ImmersiveReaderErrorDialogTitle;V.message=ResourceStrings.L_ImmersiveReaderErrorDialogMessage;return!1})};class le{constructor(ja,qb,V,Ea,Za){this.ifm=!1;this.mTh="";if(!ja)throw Error.argumentNull("actionManager");if(!qb)throw Error.argumentNull("focusManager");
if(!V)throw Error.argumentNull("pptSelectionManager");if(!Za)throw Error.argumentNull("appSettingsManager");this.la=ja;this.Na=qb;this.rb=V;const ia=new Date;Ea("immersiveReader").then(()=>{this.ifm=!0;Pc.a.$(512500569,822,50,"ImmersiveReader: Loaded SDK successfully. Duration (ms): {0}",+new Date-+ia)}).catch(Va=>{const Ab=+new Date-+ia;Pc.a.$(512500568,822,10,"ImmersiveReader: Failed to load SDK. Duration (ms): {0}, Exception: {1} ",Ab,Va.toString());const gc=new Map;gc.set("JSLoadDurationInMs",
Ab.toString());gc.set("Exception",Va.toString());Qb.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","JSLoadFailed",!1,!0,{extendedProperties:gc})})}Kb(){this.la.Ba(Yc.a.o4d,ad.a.view,Object(da.a)(this,this.h8l,"immersiveReaderHandler"));this.la.Ba(Yc.a.gYe,ad.a.view,Object(da.a)(this,this.h8l,"immersiveReaderHandler"))}Ae(){this.Na.Uc(ee.a.DV).bindAction(ub.a.hb(xa.a.gjc,ub.a.Ne|4),Yc.a.o4d)}$dn(ja){let qb="";for(ja=Object(Rb.a)(pe.AParagraphNode,ja.node);ja;){const V=Wf.ParagraphReader.Zqa(ja,
!0,!0,!1);if(V)ja=V;else break}for(;ja;)qb+="\n"+Wf.ParagraphReader.text(ja),ja=Wf.ParagraphReader.Zqa(ja,!1,!0,!1);return qb}bZm(){var ja=this.rb.rg();let qb=null;if(!ja)return null;for(const V of ja)if(ja=V.l_b())for(const Ea of ja)ja=Kf(Ea),qb=zh(ja,qb);return qb}aZm(){let ja=null;var qb=this.rb.Wa;if(!qb)return null;for(const Za of qb)if(Za)for(qb=0;qb<Za.length;qb++){var V=Za.ka(qb),Ea=null;if(V.contextId===ad.a.outline||V.contextId===ad.a.sg)if(Wf.ParagraphReader.ue(V.node)){for(V=Object(Rb.a)(pe.AParagraphNode,
V.node);V;)if(Ea=Wf.ParagraphReader.Zqa(V,!0,!0,!1))V=Ea;else break;Ea=hh(V)}else Ea=Kf(Object(Rb.a)(351,V.node));else V.contextId!==ad.a.endOfParagraph&&Wf.ParagraphReader.ue(V.node)&&(Ea=pg(Object(Rb.a)(pe.AParagraphNode,V.node),V.Xa,V.Mb));ja=zh(Ea,ja)}return ja}dZm(){let ja;return(ja=this.rb.Au()?this.bZm():this.aZm())?ja.innerHTML:""}Cmn(){let ja="";const qb=this.rb.Wa.qb;if(qb)for(let V=0;V<qb.length;V++){const Ea=qb.ka(V),Za=Ea.Xa,ia=Ea.Mb-Za;let Va;if(Wf.ParagraphReader.ue(Ea.node))switch(Va=
Ea.node.characterData,Ea.contextId){case ad.a.paragraph:ja+=Va+"\r";break;case ad.a.textRange:0<ia&&(ja+=Va.substr(Za,ia));break;case ad.a.endOfParagraph:ja+="\r";break;case ad.a.sg:ja+=this.$dn(Ea)}}return ja}c1j(){const ja=new XMLHttpRequest,qb=k.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;var V=k.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").ym;V=String.format("{0}PodHandler.ashx?action=ImmersiveReaderAuthToken&PodSID={1}",V,qb);ja.open("GET",V,!0);
const Ea=bc.a.create().toString();ja.setRequestHeader("X-UserSessionId",n.AFrameworkApplication.userSessionId);ja.setRequestHeader("X-CorrelationID",Ea);ja.setRequestHeader("X-WacCluster",k.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").Hp);let Za=null;const ia=new Map;ja.onreadystatechange=()=>{var Va;if(4===ja.readyState)if(200===ja.status){var Ab=+new Date-+Za;Pc.a.$(512500567,822,50,"ImmersiveReader: auth token received. Duration (ms): {0}",Ab);ia.set("AuthTokenDurationInMs",Ab.toString());
Ab=ja.responseText.replace('"',"");const fd=new Date;var gc=oe.a("EnableSendingHTMLToIR")?[{["content"]:this.mTh,["mimeType"]:"text/html"}]:[{["content"]:this.mTh}];gc={["title"]:ResourceStrings.L_ImmersiveReaderDialogTitle,["chunks"]:gc};var {["launchAsync"]:Hc}=window.immersiveReader;if(oe.a("EnableUseUpdatedImmersiveReaderVersion")){const {["v0_7_1"]:{["launchAsync"]:hd,["CookiePolicy"]:yd}}=window.immersiveReader;gc=Object.assign({},gc);Hc={["uiLang"]:null===(Va=this.Jb)||void 0===Va?void 0:Va.appSettings.UICulture,
["cookiePolicy"]:yd.Enable,["allowFullscreen"]:!0};hd(Ab,gc,Hc).then(Md=>{Md=Md?Md.sessionId:"";const te=+new Date-+fd,Pe=+new Date-+Za;Pc.a.$(508695828,822,50,"ImmersiveReader: IR Pane launched successfully. Duration (ms) of LaunchAsync(): {0}, IR response sessionId: {1}",te,Md);ia.set("LaunchAsyncDurationInMs",te.toString());ia.set("IRResponseSessionId",Md);ia.set("UserPerceivedDurationInMs",Pe.toString());Qb.Health.instance.recordKpiSuccess("ImmersiveReaderTriggered",{extendedProperties:ia})}).catch(Md=>
{cg(qb);const te=+new Date-+fd,Pe=+new Date-+Za;Pc.a.$(508695827,822,10,"ImmersiveReader: LaunchAsync failed. Duration (ms): {0}, ErrorJson: {1}",te,Md);ia.set("LaunchAsyncDurationInMs",te.toString());ia.set("ErrorJson",Md.toString());ia.set("UserPerceivedDurationInMs",Pe.toString());Qb.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","LaunchAsyncFailed",!1,!0,{extendedProperties:ia})})}else Hc(Ab,null,gc,null).then(hd=>{hd=(hd=Object(Rb.a)(Object,hd))?hd.sessionId:"";const yd=+new Date-
+fd,Md=+new Date-+Za;Pc.a.$(512500566,822,50,"ImmersiveReader: IR Pane launched successfully. Duration (ms) of LaunchAsync(): {0}, IR response sessionId: {1}",yd,hd);ia.set("LaunchAsyncDurationInMs",yd.toString());ia.set("IRResponseSessionId",hd);ia.set("UserPerceivedDurationInMs",Md.toString());Qb.Health.instance.recordKpiSuccess("ImmersiveReaderTriggered",{extendedProperties:ia})}).catch(hd=>{cg(qb);const yd=+new Date-+fd,Md=+new Date-+Za;Pc.a.$(512500565,822,10,"ImmersiveReader: LaunchAsync failed. Duration (ms): {0}, ErrorJson: {1}",
yd,hd);ia.set("LaunchAsyncDurationInMs",yd.toString());ia.set("ErrorJson",hd.toString());ia.set("UserPerceivedDurationInMs",Md.toString());Qb.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","LaunchAsyncFailed",!1,!0,{extendedProperties:ia})})}else cg(qb),Va=+new Date-+Za,Pc.a.$(512500564,822,10,"ImmersiveReader: Request for auth token failed. Duration (ms): {0}, statusCode:{1}, CorrelationId: {2}",Va,ja.status,Ea),ia.set("CorrelationId",Ea),ia.set("StatusCode",ja.status.toString()),ia.set("UserPerceivedDurationInMs",
Va.toString()),Qb.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","RequestForAuthTokenFailed",!1,!0,{extendedProperties:ia});else Pc.a.$(512500563,822,15,"Immersive Reader auth token request in progress. CorrelationId: {0}, Request Status: {1}",Ea,ja.status)};Za=new Date;Pc.a.$(512500562,822,50,"Begin request for ImmersiveReader auth token. StartTime: {0}, CorrelationId: {1}",Za.getTime(),Ea);V=new Map;V.set("CorrelationId",Ea);V.set("Info","RequestingAuthToken");Qb.Health.instance.recordKpiUsage("ImmersiveReaderTriggered",
wa.b.SuccessBased,null,V);ja.send(null)}h8l(ja,qb,V){if(1===V||6===this.la.np){if(!this.ifm)return 8;this.mTh=oe.a("EnableSendingHTMLToIR")?this.dZm():this.Cmn();if(""===this.mTh)return 8}2===V&&this.c1j();return 32}}Object(m.a)(le,"ImmersiveReaderActor",null,[502]);var ke=a(1317),ag=a(1191);class Ef{constructor(ja){this.customData=null;this.qIa=ja}}Object(m.a)(Ef,"PropertySetChangedState",null,[]);class lg{static A1n(ja,qb,V){if(ja&&qb){var Ea=new Ef(qb),Za=(ia,Va,Ab)=>{V.z1n(ia,Va,Ab,Ea)};ja=new ag.a(qb,
ja);ja.kid=Za;ja.mjd=Za;ja.Trd=Za;ja.dga()}}}Object(m.a)(lg,"PropertySetChangedManager",null,[]);class Hf{constructor(ja){this.yQm=ja}z1n(ja,qb,V,Ea){const Za=this.yQm[ja.id.toString()];Za&&Za(ja,qb,V,Ea)}}Object(m.a)(Hf,"PropertyChangedProcessor",null,[]);var Lg=a(1316),Vg=a(563),uf=a(74),dg=a(654),Fg=a(425),Gh=a(1118);class Vh{constructor(){this.HNk=this.GPh=this.CNh=null}}Object(m.a)(Vh,"ParagraphDialogResults",null,[]);class Qg extends Ia.a{constructor(ja,qb,V){super(void 0,void 0,!0);this.Xgb=
null;if(null===ja)throw Error.argumentNull("properties");this.DJb=ja.clone();this.exb=ja.clone();this.S$=V;this.la=qb;this.gGn=new la.a(Object(da.a)(this,this.i5m,"createPropertyChangedHandlers"))}tJe(){this.rj="ParagraphDialog";const ja={};ja.bodyControls=this.yZf();this.qp(ResourceStrings.L_ParagraphDialogTitle,Object(da.a)(this,this.qPf,"dialogResultHandler"),ja)}qPf(ja,qb){1===ja&&(this.xmo(qb),ja=Object.assign(new Vh,{CNh:this.DJb,GPh:this.exb,HNk:this.gGn}),this.la.Ra(Yc.a.mMi,2,ja));this.dispose()}yZf(){this.Xgb=
Qg.u0f();const ja={};this.i2m(ja);this.e2m(ja);var qb=Gh.a("Inch",3,0,56,.1);const V=Gh.a("Character",2,0,56,.1);qb=[qb,V];this.n2m(ja,qb);this.f2m(ja,qb);qb=[Gh.a("Point",5,0,1584,1)];this.g2m(ja,qb);this.d2m(ja,qb);this.j2m(ja);return ja}xmo(ja){this.ulo(ja);this.Tmo(ja);this.Flo(ja);this.Glo(ja);this.tlo(ja);this.jmo(ja)}i5m(){const ja={};ja[uf.a.CH.id.toString()]=Object(da.a)(this.S$,this.S$.Mzn,"justificationChangedHandler");ja[uf.a.mwe.id.toString()]=Object(da.a)(this.S$,this.S$.Kom,"paraIndentLeftChangedHandler");
ja[uf.a.nwe.id.toString()]=Object(da.a)(this.S$,this.S$.Kom,"paraIndentLeftChangedHandler");ja[uf.a.mJa.id.toString()]=Object(da.a)(this.S$,this.S$.zml,"specialIndentChangedHandler");ja[uf.a.sKe.id.toString()]=Object(da.a)(this.S$,this.S$.zml,"specialIndentChangedHandler");ja[uf.a.tKe.id.toString()]=Object(da.a)(this.S$,this.S$.zml,"specialIndentChangedHandler");ja[uf.a.NA.id.toString()]=Object(da.a)(this.S$,this.S$.SAn,"lineSpacingChangedHandler");ja[uf.a.swe.id.toString()]=Object(da.a)(this.S$,
this.S$.Mom,"paraSpacingAfterChangedHandler");ja[uf.a.rwe.id.toString()]=Object(da.a)(this.S$,this.S$.Mom,"paraSpacingAfterChangedHandler");ja[uf.a.uwe.id.toString()]=Object(da.a)(this.S$,this.S$.Oom,"paraSpacingBeforeChangedHandler");ja[uf.a.twe.id.toString()]=Object(da.a)(this.S$,this.S$.Oom,"paraSpacingBeforeChangedHandler");return ja}j2m(ja){var qb=Qg.vin(this.DJb),V="multiple"===qb;ja.lineSpacingComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:Gh.b([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["selectedKey"]:qb,["allowFreeForm"]:!1};qb=0;let Ea=!1;this.DJb.Va(uf.a.NA)&&V&&(qb=this.DJb.jb(uf.a.NA),0<=qb&&(Ea=!0));V=[Gh.a("none",
0,0,9.99,.5)];V={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:V,["numberFormatInfo"]:this.Xgb,["validReservedValues"]:[""]};V.value=Ea?qb:"";ja.atSpinButtonProps=V}d2m(ja,qb){const V=Qg.W1l(this.DJb,uf.a.swe,uf.a.rwe);ja.afterSpacingSpinButtonProps=Qg.c_h(V,{["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:dg.a.eQd(5),["validUnits"]:qb,["numberFormatInfo"]:this.Xgb,["validReservedValues"]:[""]})}g2m(ja,qb){const V=Qg.W1l(this.DJb,uf.a.uwe,uf.a.twe);ja.beforeSpacingSpinButtonProps=Qg.c_h(V,{["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:dg.a.eQd(5),["validUnits"]:qb,
["numberFormatInfo"]:this.Xgb,["validReservedValues"]:[""]})}f2m(ja,qb){const {yom:V,zom:Ea}=Qg.a3l(this.DJb,uf.a.nwe,uf.a.mwe,!1);qb={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:dg.a.eQd(Ea),["validUnits"]:qb,["numberFormatInfo"]:this.Xgb,["validReservedValues"]:[""]};qb=Qg.c_h(V,qb);ja.beforeTextSpinButtonProps=qb}n2m(ja,qb){const V={["type"]:"AppComboBoxProps",
["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:Gh.b([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["allowFreeForm"]:!1},Ea=this.DJb.Va(uf.a.mJa)?this.DJb.jb(uf.a.mJa):-1;Qg.bam(Ea)?V.selectedKey=Ea.toString():V.defaultSelectedKey=
"";ja.specialIndentationComboBoxProps=V;const {yom:Za,zom:ia}=Qg.a3l(this.DJb,uf.a.tKe,uf.a.sKe,1!==Ea&&2!==Ea);qb={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:dg.a.eQd(ia),["validUnits"]:qb,["numberFormatInfo"]:this.Xgb};qb=Qg.c_h(Za,qb);ja.bySpinButtonProps=qb}e2m(ja){const qb={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:Gh.b([Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified],["1","2","3","6"]),["allowFreeForm"]:!1},V=this.DJb.Va(uf.a.CH)?this.DJb.jb(uf.a.CH):0;Qg.zxn(V)?qb.selectedKey=V.toString():qb.defaultSelectedKey=
"";ja.alignmentComboBoxProps=qb}i2m(ja){ja.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};ja.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};ja.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"}}jmo(ja){if(ja.lineSpacingComboBoxProps){var qb=
ja.lineSpacingComboBoxProps;const V=qb.selectedKey?qb.selectedKey.toString():"";qb=Gh.c(V);"multiple"===V&&(ja=ja.atSpinButtonProps)&&(qb=parseFloat(ja.value.toString()));this.exb.setValue(uf.a.NA,qb);this.exb.setValue(uf.a.I3,2)}}tlo(ja){if(ja.afterSpacingSpinButtonProps){ja=ja.afterSpacingSpinButtonProps;var qb=dg.a.$Pd(ja.unitType.toString().toLowerCase());""!==ja.value.toString()&&(qb=4===qb?2:4,this.exb.setValue(uf.a.swe,parseInt(ja.value.toString())),this.exb.setValue(uf.a.rwe,qb))}}Glo(ja){if(ja.beforeSpacingSpinButtonProps){ja=
ja.beforeSpacingSpinButtonProps;var qb=dg.a.$Pd(ja.unitType.toString().toLowerCase());""!==ja.value.toString()&&(qb=4===qb?2:4,this.exb.setValue(uf.a.uwe,parseInt(ja.value.toString())),this.exb.setValue(uf.a.twe,qb))}}Flo(ja){if(ja.beforeTextSpinButtonProps){var qb=ja.beforeTextSpinButtonProps;ja=dg.a.$Pd(qb.unitType.toString().toLowerCase());if(""!==qb.value.toString()){qb=parseFloat(qb.value.toString());let V;2===ja?V=2:(V=1,qb=dg.a.Wwl(qb,ja));this.exb.setValue(uf.a.nwe,qb);this.exb.setValue(uf.a.mwe,
V)}}}Tmo(ja){var qb=ja.bySpinButtonProps,V=ja.didChangeSpecialIndentationComboBoxValue;if(qb&&""!==qb.value.toString()||V)if(ja.specialIndentationComboBoxProps&&(ja=ja.specialIndentationComboBoxProps,V=-1,ja.selectedKey&&(ja=ja.selectedKey.toString(),V=parseInt(ja)),Qg.bam(V)&&this.exb.setValue(uf.a.mJa,V)),qb){ja=parseFloat(qb.value.toString());qb=dg.a.$Pd(qb.unitType.toString().toLowerCase());if(0>ja||isNaN(ja))ja=0;2===qb?V=2:(V=1,ja=dg.a.Wwl(ja,qb));this.exb.setValue(uf.a.tKe,ja);this.exb.setValue(uf.a.sKe,
V)}}ulo(ja){ja.alignmentComboBoxProps&&(ja=ja.alignmentComboBoxProps,ja.selectedKey&&(ja=parseInt(ja.selectedKey.toString()),0<=ja&&this.exb.setValue(uf.a.CH,ja)))}static W1l(ja,qb,V){if(ja.Va(qb)&&ja.Va(V)){V=ja.jb(V);if(2!==V&&4!==V)return Number.NaN;ja=ja.jb(qb);2===V&&(ja*=Qg.SXn);return ja}return Number.NaN}static c_h(ja,qb){qb.value=isNaN(ja)?"":ja;return qb}static u0f(){return{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",
["numberGroupSizes"]:[3]}}static a3l(ja,qb,V,Ea){let Za=3;oe.a("BySpinButtonDefaultvalueFix")&&Ea?qb=0:ja.Va(qb)&&ja.Va(V)&&!Ea?(qb=ja.jb(qb),2===ja.jb(V)?Za=2:qb=dg.a.WEm(qb,Za)):qb=Number.NaN;return{yom:qb,zom:Za}}static zxn(ja){return 1===ja||2===ja||3===ja||6===ja}static bam(ja){return 1===ja||2===ja||0===ja}static vin(ja){if(Qg.sqn(ja)){ja=ja.jb(uf.a.NA);var qb="multiple";Fg.a.KA(ja,1)?qb="1.00":Fg.a.KA(ja,1.5)?qb="1.50":Fg.a.KA(ja,2)&&(qb="2.00");return qb}}static sqn(ja){return ja.Va(uf.a.NA)&&
ja.Va(uf.a.I3)&&2===ja.jb(uf.a.I3)?!0:!1}}Qg.SXn=72;Object(m.a)(Qg,"ReactParagraphDialog",Ia.a,[]);class mh{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc,fd){this.nbk=[];this.la=ja;this.sa=qb;this.Gna=V;this.Aka=Ea;this.Tb=Za;this.Rj=ia;this.cSa=Va;this.La=Ab;this.S$=gc;this.zka=Hc;this.vim=fd}Kb(){this.la.ua(Yc.a.nJb,ad.a.application,Object(da.a)(this,this.SVn,"paragraphDialogHandler"),4);this.la.ua(Yc.a.mMi,ad.a.application,Object(da.a)(this,this.T1m,"commitParagraphDialogHandler"),4);this.la.ua(Yc.a.sXh,
ad.a.view,Vg.a.kxa,96);this.la.ua(Yc.a.mXh,ad.a.view,Vg.a.kxa,96);this.la.ua(Yc.a.yXh,ad.a.view,Vg.a.kxa,96);this.la.ua(Yc.a.zXh,ad.a.view,Vg.a.kxa,96);this.la.ua(Yc.a.xXh,ad.a.view,Vg.a.kxa,96);this.la.ua(Yc.a.wXh,ad.a.view,Vg.a.kxa,96);this.la.ua(Yc.a.nXh,ad.a.view,Vg.a.kxa,96);this.la.ua(Yc.a.oXh,ad.a.view,Vg.a.kxa,96);this.la.Ba(Yc.a.eWh,ad.a.view,Vg.a.M7);this.la.Ba(Yc.a.e0h,ad.a.view,Vg.a.M7);this.la.Ba(Yc.a.xNh,ad.a.view,Vg.a.M7);this.la.Ba(Yc.a.h0h,ad.a.view,Vg.a.M7);this.la.Ba(Yc.a.g0h,ad.a.view,
Vg.a.M7);this.la.Ba(Yc.a.fWh,ad.a.view,Vg.a.M7);this.la.Ba(Yc.a.gWh,ad.a.view,Vg.a.M7);this.la.Ba(Yc.a.cWh,ad.a.view,Vg.a.M7);this.la.Ba(Yc.a.f0h,ad.a.view,Vg.a.M7);this.la.Ba(Yc.a.bWh,ad.a.view,Vg.a.M7);this.la.Ba(Yc.a.iWh,ad.a.view,Vg.a.M7);this.la.Ba(Yc.a.hWh,ad.a.view,Vg.a.M7);this.la.Ba(Yc.a.i0h,ad.a.view,Vg.a.M7);this.la.Ba(Yc.a.c9g,ad.a.paragraph,Object(da.a)(this,this.kkn,"getPropertiesForParagraphDialog"));this.la.Ba(Yc.a.c9g,ad.a.view,this.zka);this.la.we(Yc.a.c9g,96)}Ae(){}SVn(ja,qb,V){if(this.sa.Au()||
this.sa.Y7())return 16;ja=this.sa.zd();if(!this.La.B5(ja,!0).length&&!this.sa.Ira())return 16;if(1===V)return 32;this.vim&&Pc.a.$(508360609,820,50,"Setting Paragraph properties from: {0}, IsDialogLancherButton: {1}",this.la.np,"PptRibbon.Home"===this.la.$va);Array.clear(this.nbk);this.la.Eb(Yc.a.c9g,2);return(V=ke.a.ZWe(this.nbk))?((new Qg(V,this.la,this.S$)).tJe(),32):16}T1m(ja,qb,V,Ea,Za){if(1===V)return 32;if(!(Za&&Za.CNh&&Za.GPh&&Za.HNk))return 16;qb=this.sa.ut();this.S$.eun();V=this.Tb.xe(15);
try{V.tc(qb),V.wc=ja,Za.CNh.equals(Za.GPh)||this.w1m(),lg.A1n(Za.CNh,Za.GPh,new Hf(Za.HNk.value))}finally{V&&V.dispose()}if(this.vim){const {yIm:ia,zIm:Va,BIm:Ab,AIm:gc,xIm:Hc,CIm:fd}=this.S$.dio();Pc.a.$(25040909,820,50,"IsJustificationChanged: {0}, IsLnSpacChanged: {1}, IsSpaceBeforeChanged: {2}, IsSpaceAfterChanged: {3}, IsIndentLeftChanged: {4}, IsSpecialIndentChanged: {5}",ia,Va,Ab,gc,Hc,fd)}Uf.a.KR(!0,!0);return 32}kkn(ja,qb,V){if(1===V)return 32;qb=qb.node;ja=new Lg.a;ja.setValue(uf.a.CH,this.Rj.WK(qb));
V=this.Gna.gYa(qb);ja.setValue(uf.a.I3,V.unit);ja.setValue(uf.a.NA,V.value);V=this.Gna.XX(qb);ja.setValue(uf.a.twe,V.Nr.unit);ja.setValue(uf.a.uwe,V.Nr.value);ja.setValue(uf.a.rwe,V.Lr.unit);ja.setValue(uf.a.swe,V.Lr.value);V=this.Aka.dca(qb);ja.setValue(uf.a.mwe,1);ja.setValue(uf.a.nwe,V.JM);qb=this.cSa.iYa(qb);ja.setValue(uf.a.mJa,qb.specialIndentType);ja.setValue(uf.a.sKe,qb.unit);ja.setValue(uf.a.tKe,qb.value);this.nbk.push(ja);return 32}w1m(){if(this.sa.BH()){var ja=this.sa.zd();ja=this.La.B5(ja);
for(const qb of ja)qb.mwa()}}}Object(m.a)(mh,"ParagraphDialogActor",null,[502]);var Mf;(function(ja){ja[ja.unspecified=-1]="unspecified";ja[ja.none=0]="none";ja[ja.left=1]="left";ja[ja.center=2]="center";ja[ja.right=3]="right";ja[ja.inner=4]="inner";ja[ja.outer=5]="outer";ja[ja.both=6]="both";ja[ja.distribute=7]="distribute";ja[ja.margin=8]="margin";ja[ja.highKashida=9]="highKashida";ja[ja.lowKashida=10]="lowKashida";ja[ja.mediumKashida=11]="mediumKashida";ja[ja.numTab=12]="numTab";ja[ja.thaiDistribute=
13]="thaiDistribute";ja[ja.start=14]="start";ja[ja.end=15]="end"})(Mf||(Mf={}));Object(m.b)("Justification",Mf);var Gg=a(802);class dh{constructor(){this.value=this.unit=0}}Object(m.a)(dh,"ParagraphSpacingCommandData",null,[]);class Jh{constructor(){this.WAm=this.Lom=this.Nom=this.Pom=!1}}Object(m.a)(Jh,"PptPropertySetChangedState",null,[]);class Wg{constructor(ja){this.BYj=this.OSj=this.zYj=this.AYj=this.MTj=this.oTj=!1;this.HCg={};this.la=ja;this.jun()}Mzn(ja,qb,V){V&&(ja=this.HCg[Mf[V]],void 0!==
ja&&null!==ja&&(this.la.Eb(ja,2),this.oTj=!0))}SAn(ja,qb,V){void 0!==V&&null!==V&&(this.la.Ra(Yc.a.Nna,2,V),this.MTj=!0)}Oom(ja,qb,V,Ea){void 0!==V&&null!==V&&(ja=Wg.eLh(Ea),!ja.Pom&&null!==Ea&&Ea.qIa.Va(uf.a.twe)&&Ea.qIa.Va(uf.a.uwe)&&(qb=Ea.qIa.jb(uf.a.uwe),Ea=Ea.qIa.jb(uf.a.twe),ja.Pom=!0,this.la.Ra(Yc.a.BZa,2,Object.assign(new dh,{value:qb,unit:Ea})),this.AYj=!0))}Mom(ja,qb,V,Ea){void 0!==V&&null!==V&&(ja=Wg.eLh(Ea),!ja.Nom&&null!==Ea&&Ea.qIa.Va(uf.a.rwe)&&Ea.qIa.Va(uf.a.swe)&&(qb=Ea.qIa.jb(uf.a.swe),
Ea=Ea.qIa.jb(uf.a.rwe),ja.Nom=!0,this.la.Ra(Yc.a.AZa,2,Object.assign(new dh,{value:qb,unit:Ea})),this.zYj=!0))}Kom(ja,qb,V,Ea){void 0!==V&&null!==V&&(qb=Wg.eLh(Ea),!qb.Lom&&null!==Ea&&Ea.qIa.Va(uf.a.mwe)&&Ea.qIa.Va(uf.a.nwe)&&(ja=Ea.qIa.jb(uf.a.nwe),Ea=Ea.qIa.jb(uf.a.mwe),qb.Lom=!0,qb=new Gg.a,qb.unit=Ea,qb.value=ja,this.la.Ra(Yc.a.Ffa,2,qb),this.OSj=!0))}zml(ja,qb,V,Ea){void 0!==V&&null!==V&&(V=Wg.eLh(Ea),!V.WAm&&null!==Ea&&Ea.qIa.Va(uf.a.sKe)&&Ea.qIa.Va(uf.a.tKe)&&(qb=0,Ea.qIa.Va(uf.a.mJa)&&(qb=
Ea.qIa.jb(uf.a.mJa)),ja=Ea.qIa.jb(uf.a.tKe),Ea=Ea.qIa.jb(uf.a.sKe),V.WAm=!0,V=0,1===qb?V=Yc.a.xib:2===qb?V=Yc.a.yib:0===qb&&(V=Yc.a.zib),qb=new Gg.a,qb.unit=Ea,qb.value=ja,this.la.Ra(V,2,qb),this.BYj=!0))}dio(){return{yIm:this.oTj,zIm:this.MTj,BIm:this.AYj,AIm:this.zYj,xIm:this.OSj,CIm:this.BYj}}eun(){this.BYj=this.OSj=this.zYj=this.AYj=this.MTj=this.oTj=!1}jun(){this.HCg.left=zb.a.leftJustify;this.HCg.center=zb.a.centerJustify;this.HCg.right=zb.a.rightJustify;this.HCg.both=zb.a.fullJustify}static eLh(ja){ja.customData||
(ja.customData=new Jh);return ja.customData}}Object(m.a)(Wg,"ParagraphLevelPropertyChangedHandlers",null,[688]);var Ra=a(616),vc=a(206),Uc=a(324),id=a(229),Jd=a(408),$d=a(53),re=a(62),Re=a(96),Be=a(182);class rf{constructor(ja,qb){this.bWe=ja;this.Xi=qb}}Object(m.a)(rf,"DoNotCheckCritiqueTypeActionData",null,[]);var qa=a(28);class Fb{HUb(ja){return(ja=Object(Rb.a)(rf,ja))?Object(qa.a)(Jd.a,ja.Xi):!1}Ave(ja,qb){if(qb=Object(Rb.a)(rf,qb)){const V=qb.Xi;V&&(V.Odb(ja,qb.bWe),r.ULS.sendTraceTag(507843939,
375,50,"Don't check this critique for whole doc finished, removed errors count: {0}",qb.bWe))}}}Object(m.a)(Fb,"DoNotCheckCritiqueTypeCallback",null,[743]);var oa=a(506),eb=a(61);class Bb extends oa.a{constructor(ja,qb,V,Ea,Za,ia,Va){super();this.Cok=null;this.init(ja);this.hm("WholePresentationOperation");this.AIa(n.AFrameworkApplication.ub,qb,V,Ea,Za);this.hne=0;this.Oim=Va;this.Mem=ia;this.GYa=Za;this.HRc=qb;this.HUb()?1===this.behavior&&(this.Dp=32,this.B1()):(this.Dp=8,this.B1())}run(){0===this.hne&&
this.vlh();1===this.hne&&this.g8g();2===this.hne&&this.hsh();3===this.hne&&this.LWf()}HUb(){return this.Oim.HUb(this.GYa)}Ave(){this.Oim.Ave(this.HRc,this.GYa)}vlh(){this.Cok=new eb.GraphTransaction(3);this.Cok.tc(this.Mem.node);this.hne=1}g8g(){this.Cw||this.vib(this.Mem.TF);1!==this.Rna()&&(this.hne=2)}hsh(){this.Ave();this.Cok.dispose();this.hne=3}LWf(){this.B1()}}Object(m.a)(Bb,"WholePresentationOperation",oa.a,[]);var $b=a(68);class tc{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd){this.CLc=
!1;this.la=ja;this.bcm=qb;this.QI=V;this.Tb=Ea;this.rfe=Za;this.ya=ia;this.La=Va;this.sda=fd;this.Agk=Ab;this.qL=gc;this.rb=hd;this.Yoe=Hc.l_h;this.jFn=Hc.t3e;this.$En=Hc.Dnc;this.Zun()}get Sjd(){return this.QI.Cgb?this.rfe.instance:null}Kb(){this.la.ua(Yc.a.queryLanguage,$b.a.application,Object(da.a)(this,this.queryLanguage,"queryLanguage"),96);this.la.ua(Yc.a.Dqd,$b.a.application,Object(da.a)(this,this.rVn,"openPPTLanguageDialogView"),4);this.QI.GOh&&this.la.ua(zb.a.bYe,ad.a.sg,Object(da.a)(this,
this.bYe,"ignoreProofingError"),4);this.QI.UYe&&(this.jFn?(this.la.Ba(zb.a.NEc,ad.a.paragraph,Object(da.a)(this,this.GYl,"doNotCheckThisCritiqueTypeForNode")),this.la.Ba(zb.a.NEc,ad.a.section,Object(da.a)(this,this.GYl,"doNotCheckThisCritiqueTypeForNode")),this.la.bU(zb.a.NEc,ad.a.sg,Object(da.a)(this,this.H8m,"doNotCheckThisCritiqueTypeForWholeDoc"),4),this.la.ua(Yc.a.JVe,ad.a.sg,Object(da.a)(this,this.JVe,"doNotCheckThisCritiqueTypeForCurrentSlide"),4)):this.la.ua(zb.a.NEc,ad.a.sg,Object(da.a)(this,
this.JVe,"doNotCheckThisCritiqueTypeForCurrentSlide"),4));this.$En&&(this.la.ua(Yc.a.V3e,$b.a.application,Object(da.a)(this,this.V3e,"queryHideProofingErrors"),100),this.la.ua(Yc.a.cNh,$b.a.application,Object(da.a)(this,this.cjo,"toggleHideProofingErrors"),4))}Ae(){}Zun(){this.CLc=tc.aFj;r.ULS.sendTraceTag(508694594,375,50,"Initialized with hide proofing errors: {0}",this.CLc);this.CLc&&this.V6l(this.CLc)}V3e(ja,qb,V,Ea,Za){if(1===V)return 32;if(!Za)return 8;Za[Ra.a.On]=this.CLc;return 32}cjo(ja,
qb,V,Ea,Za){if(1===V)return 32;if(!(Za&&Ra.a.On in Za))return 8;this.CLc=Za[Ra.a.On];tc.aFj=this.CLc;this.V6l(this.CLc);r.ULS.sendTraceTag(508694593,375,50,"User hide proofing errors: {0}",this.CLc);return 32}GYl(ja,qb,V,Ea,Za){if(!qb)return 8;ja=qb.node;if(!ja)return 8;if(qb.contextId===ad.a.section&&!ja.ra(Be.a.YYe,!1))return 32;if(qb.contextId===ad.a.paragraph&&ja.ra(Be.a.Jfa,!1)){qb=Object(Rb.a)(rf,Za);if(!qb)return 8;Za=qb.Xi;if(!Za)return 8;qb.bWe+=this.Jtm(ja,Za.typeId,Za.lcid)}return 2}H8m(ja,
qb,V,Ea,Za){var ia=this.Rfn();ia=new rf(0,ia);this.la.hi(V,Yc.a.JVe,Ea,!1,Za,ia);V=re.a.create(Object(Rb.a)(Re.a,this.ya.presentation));r.ULS.sendTraceTag(508694592,375,50,"User click do not check this critique for whole doc with behavior: {0}",Ea);return new Bb(ja,qb,Ea,Za,ia,V,new Fb)}JVe(ja,qb,V,Ea,Za){ja=Object(Rb.a)(rf,Za);if(!ja)return 8;Ea=ja.Xi;if(!Ea)return 8;if(1===V)return 32;if(!qb.node)return 8;r.ULS.sendTraceTag(508694563,375,50,"Don't check this critique triggerred, language id: {0}, critique type id: {1}",
Ea.lcid,Ea.typeId);ja.bWe+=this.f6n(Ea.typeId,Ea.lcid);this.Sjd&&this.Sjd.oYl(Ea.lcid.toString(),Ea.typeId);return 32}bYe(ja,qb,V){if(1===V)return 32;r.ULS.sendTraceTag(508694562,375,50,"Ignore proofing error triggerred");V=this.qL.yOa(qb);if(!V||!V.Xi)return 8;qb=qb.node;var Ea=this.ya.Ia;if(!qb||!Ea)return 8;Ea=this.Tb.xe(tc.$mn(V));oe.a("FixDesignerCrashViaSetUndoActionId")&&(Ea.wc=ja);try{Ea.tc(qb),this.qL.eGa(qb,[V],!0),qb.setValue($d.a.SHh,!0)}finally{Ea&&Ea.dispose()}V.Xi.Odb(ja,1);this.rb.l7a()||
Uf.a.KR(!0,!1);r.ULS.sendTraceTag(508694561,375,50,"Ignore proofing error action succeeded");return 32}V6l(ja){this.sda.d6e=ja}Rfn(){var ja=this.rb.Wa.qb;if(!ja)return null;ja=this.qL.yOa(ja.Ya);if(!ja||!ja.Xi)return null;ja=Object(Rb.a)(Jd.a,ja.Xi);return!ja||0>=ja.lcid?null:ja}f6n(ja,qb){const V=new Date;if(!this.ya.Ia)return 0;const Ea=this.ya.Ia.Nj();if(!Ea)return 0;let Za=0,ia=0;const Va=this.Tb.xe(3);try{Va.tc(this.ya.Ia);for(const Ab of Ea)this.La.fJ(Ab,gc=>{++ia;gc.Va($d.a.Tq)&&gc.ra(Be.a.Jfa,
!1)&&(Za+=this.Jtm(gc,ja,qb))})}finally{Va&&Va.dispose()}r.ULS.sendTraceTag(508694560,375,50,"Remove proofing error take time(ms): {0}, scanned paragraph count: {1}, scanned shape count: {2}, removed errors count: {3}",+new Date-+V,ia,Ea.length,Za);return Za}Jtm(ja,qb,V){const Ea=this.qL.AH(ja,Za=>{Za=Object(Rb.a)(Jd.a,Za.Xi);return!!Za&&Za.typeId===qb&&Za.lcid===V});if(vc.a.wb(Ea))return 0;this.qL.eGa(ja,Ea);return Ea.length}queryLanguage(ja,qb,V,Ea,Za){Za.kAc=this.jin();return 32}jin(){let ja=n.AFrameworkApplication.lcid;
if(this.rb.c8(this.rb.Wa)){var qb=this.rb.zd();if(1<qb.length||1!==qb.length)return"";qb=this.La.g5a(qb[0]);0<qb&&(ja=qb)}else this.rb.Wa.qb&&(qb=this.Agk.$We(this.rb.sk),0<qb&&(ja=qb));return Uc.a.Le(ja)?Uc.a.Le(ja).displayName:Uc.a.Le(n.AFrameworkApplication.lcid).displayName}Ayn(){const ja=this.rb.zd();return 1===ja.length&&ja[0].bnd}rVn(ja,qb,V){if(2!==V)return 32;this.Yoe&&this.rb.c8(this.rb.Wa)&&this.Ayn()?(r.ULS.sendTraceTag(508694558,806,50,"Set proofing language on shape level."),this.bcm.value.getInstance(!0).Zad()):
this.rb.Wa.qb&&(r.ULS.sendTraceTag(508694557,806,50,"Set proofing language in text edit view."),this.bcm.value.getInstance(!1).Zad());return 32}static get aFj(){const ja=id.a.get("PowerPointHideProofingErrors");return ja?"true"===ja.toLowerCase():!1}static set aFj(ja){id.a.rX("PowerPointHideProofingErrors",ja.toString(),30)||r.ULS.sendTraceTag(508694556,375,10,"Failed to set cookie for hide proofing errors to {0}",ja.toString())}static $mn(ja){return 1===ja.Xi.proofingType?15:3}}Object(m.a)(tc,"ProofingActor",
null,[502]);var xc=a(178),cd=a(598);class od{constructor(ja,qb){this.Ve=ja.toLowerCase();this.variant=qb}}Object(m.a)(od,"ThemeVariant",null,[]);var sd=a(1645);class wd{Czn(ja){return!wd.WWe(wd.ioo)||ja>wd.LDl?!0:!1}static WWe(ja){return(ja=document.getElementById(ja))?ja:null}static obm(){const ja=k.a.instance.eb("Common.ISystemInitiatedFeedback");null!=ja&&(r.ULS.sendTraceTag(508614482,813,50,"ThemeHelper::TriggerFpsForNewDefaultTheme Floodgate survey triggered"),ja.execute(qb=>{qb.logActivity("NewDefaultThemeActivity",
"EnablePPTONewThemeFloodgateSurvey")}))}}wd.ioo="PptRibbon.Design.ThemeVariants-MaxSize";wd.LDl=4;Object(m.a)(wd,"ThemeHelper",null,[722]);class Hd{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd,yd,Md){this.OQh=null;this.PQh=0;this.gem=this.NQh=!1;this.Yfm=null;this.wUe=new od("",0);this.OTh={["ThemesOfficeTheme"]:"62f939b6-93af-4db8-9c6b-d6c7dfdc589f",["ThemesIon"]:"b8441adb-2e43-4af7-b97a-bd870242c6a8",["ThemesAtlas"]:"5156b0e4-0eb1-49fe-a26b-15f6f698aec6",["ThemesMadison"]:"025cb5fb-2dd3-45ee-b6f0-cc461540eb19",
["ThemesOrganic"]:"28cdc826-8792-45c0-861b-85eb3adeda33",["ThemesFrame"]:"f226e7a2-7162-461c-9490-d27d9dc04e43",["ThemesIonBoardroom"]:"fc33163d-4339-46b1-8eed-24c834239d99",["ThemesMesh"]:"789ec3fe-34fd-429c-9918-760025e6c145",["ThemesRetrospect"]:"5f128b03-dcca-4eeb-ab3b-cf2899314a46",["ThemesSlice"]:"0507925b-6ac9-4358-8e18-c330545d08f8",["ThemesSavon"]:"1306e473-ed32-493b-a2d0-240a757edd34",["ThemesBanded"]:"98dff888-2449-4d28-977c-6306c017633e",["ThemesQuotable"]:"39ec5628-30ed-4578-acd8-9820edb8e15a",
["ThemesWoodType"]:"7acabc62-bf99-48cf-a9dc-4db89c7b13dc",["ThemesBasis"]:"5665723a-49ba-4b57-8411-a56f8f207965",["ThemesIntegral"]:"3577f8c9-a904-41d8-97d2-fd898f53f20e",["ThemesWisp"]:"7cb32d59-10c0-40dd-b7bd-2e94284a981c",["ThemesDividend"]:"9697a71b-4ab7-4a1a-bd5b-bb2d22835b57",["ThemesCelestial"]:"c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5",["ThemesParallax"]:"3388167b-a2eb-4685-9635-1831d9aef8c4",["ThemesMetropolitan"]:"4c5440d6-04d2-4954-96cf-f251137069b2",["ThemesFacet"]:"c0c680cd-088a-49fc-a102-d699147f32b2",
["ThemesViewTheme"]:"ba0eb5a6-f2d4-4f82-977b-64adee4a2a69"};this.la=ja;this.Na=qb;this.zc=V;this.sa=Za;this.Tb=Ea;this.jc=Va;this.ya=Ab;this.rc=gc;this.hHn=Hc;this.Tke=fd;this.tfm=hd;this.YEn=yd;Hd.ODi=Md.Ac("NewThemeFloodgateSurveyDelayTime",3E5);yd&&(this.OTh.ThemesOfficeTheme2023="2e142a2c-cd16-42d6-873a-c26d2a0506fa",Md.sga&&Md.sga!=Hd.j_m||xc.a.get_instance().Ai(8,()=>{window.setTimeout(()=>{wd.obm()},Hd.ODi)}))}Kb(){this.la.ua(Yc.a.Bw,$b.a.application,Object(da.a)(this,this.B6l,"handleThemeChange"),
4);this.la.ua(Yc.a.N2a,$b.a.application,Object(da.a)(this,this.B6l,"handleThemeChange"),4);this.la.ua(Yc.a.Y3e,$b.a.application,Object(da.a)(this,this.Y3e,"queryMoreThemeGallery"),96);this.la.ua(Yc.a.rXh,$b.a.application,Object(da.a)(this,this.rXh,"queryMoreVariantGallery"),96);this.la.ua(Yc.a.Nz,$b.a.application,Object(da.a)(this,this.Nz,"queryThemes"),97);this.la.ua(Yc.a.Ard,$b.a.application,Object(da.a)(this,this.Ard,"queryThemeVariants"),97);this.la.ua(Yc.a.x2e,$b.a.application,Object(da.a)(this,
this.x2e,"populateVariantGallery"),96)}Ae(){}Nz(ja,qb,V,Ea,Za){Za&&Za.wx&&(ja=this.OTh[Za.wx]===this.cIc().Ve,Za.pbb.Fg(ja));return 32}Ard(ja,qb,V,Ea,Za){if(Za&&Za.wx){ja=this.cIc();qb=ja.Ve;V=Za.wx;try{var ia=Number.parseInvariant(V.substring(V.length-1,V.length))}catch(Va){ia=0}Za=Za.pbb;Za.Fg(ja.variant===ia);ia=Hd.A1l(V,ia,qb);Za.YAa=ia}return 32}Y3e(ja,qb,V){if(qb.contextId!==ad.a.application)return 2;ja=this.sa.ut();var Ea=this.cIc();qb=Hd.uXe(Ea.Ve);Ea=Ea.variant-1;return this.zc.Hd(ja)?16:
1!==V||(r.ULS.sendTraceTag(512499972,801,50,"ThemeActor.QueryMoreThemeGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",qb,Ea),this.rc.zl())?32:8}rXh(ja,qb,V){if(qb.contextId!==ad.a.application)return 2;var Ea=this.sa.ut();qb=this.cIc();ja=Hd.uXe(qb.Ve);qb=qb.variant-1;if(this.zc.Hd(Ea))return 16;if(1===V)if(V=Hd.A7f(this.cIc().Ve),Ea=this.hHn.Czn(V),V&&Ea)r.ULS.sendTraceTag(512499971,801,50,"ThemeActor.QueryMoreVariantGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",
ja,qb);else return 16;return 32}B6l(ja,qb,V,Ea,Za){qb=this.sa.rg();Ea=this.ya.Ia;if(!Ea||ja===Yc.a.N2a&&this.cIc()===this.wUe||this.zc.Hd(Ea))return 16;if(1===V)return 32;V=Object(Rb.a)(String,Za);if(null===V)return 8;Za=this.OTh[V];return ja===Yc.a.Bw?this.OWn(Ea,Za,qb):ja===Yc.a.N2a?this.PWn(Ea,V,qb):8}OWn(ja,qb,V){var Ea;if(!ja)return 16;Object(oe.a)("AddThemeIdInChangeThemeContext)")&&Uf.a.Ak("ThemeId",qb);1>=this.YVl()||this.tfm&&V&&1<V.length?(this.Sxi(ja,qb,0,!1,V),r.ULS.sendTraceTag(512499968,
801,50,"ThemeActor.PerformChangeTheme: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Hd.uXe(qb),0,ja.fc.sid)):(this.OQh=qb,this.PQh=0,this.NQh=!1,ja=new J.a,ja.Ue=1,ja.h6(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,Object(da.a)(this,this.UTl,"changeThemeHandler")));this.YEn&&this.OTh.ThemesOfficeTheme2023==qb&&window.setTimeout(()=>{wd.obm()},Hd.ODi);(null===(Ea=n.AFrameworkApplication.ha)||void 0===Ea?0:Ea.getBooleanAppSetting("SlideLayoutIconsOptimizationsEnabled"))&&
this.bqm();return 32}bqm(){const ja=new jc.a(0,1,0,()=>{this.la.Ra(Yc.a.ZXh,2,null)},223);n.AFrameworkApplication.Zd.Rb(ja)}PWn(ja,qb,V){var Ea;if(!ja)return 16;const Za=this.cIc();let ia;try{if(ia=Number.parseInvariant(qb.substring(7,qb.length))-1,0>ia||ia>Hd.A7f(Za.Ve))ia=-1}catch(Va){ia=-1}1>=this.YVl()||V&&1<V.length?(this.Sxi(ja,Za.Ve,ia,!0,V),r.ULS.sendTraceTag(512499939,801,50,"ThemeActor.PerformChangeVariant: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Hd.uXe(Za.Ve),ia,ja.fc.sid)):
(this.OQh=Za.Ve,this.PQh=ia,this.NQh=!0,ja=new J.a,ja.Ue=1,ja.h6(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,Object(da.a)(this,this.UTl,"changeThemeHandler")));(null===(Ea=n.AFrameworkApplication.ha)||void 0===Ea?0:Ea.getBooleanAppSetting("SlideLayoutIconsOptimizationsEnabled"))&&this.bqm();return 32}cIc(){let ja=null;var qb=this.ya.Ia;if(qb){qb=qb.Aj;const Ea=this.rc.XK();if(Ea&&qb)for(var V of Ea)if(V.Id===qb){ja=V;break}}if(!ja)return this.gem?this.Yfm:this.wUe;
if(Object(oe.a)("EnableNonEmptyGuidFixForThemeActor")){if(!ja.ThemeFamilyId||Hd.uXe(ja.ThemeFamilyId)===Hd.gTl)return this.wUe}else if(!ja.ThemeFamilyId||ja.ThemeFamilyId===Hd.e_m)return this.wUe;V="5156b0e4-0eb1-49fe-a26b-15f6f698aec6"===ja.ThemeFamilyId||"025cb5fb-2dd3-45ee-b6f0-cc461540eb19"===ja.ThemeFamilyId;return!this.Tke&&V?this.wUe:new od(ja.ThemeFamilyId,ja.VariantIndex+1)}YVl(){const ja=this.rc.XK();let qb=0;if(ja)for(const V of ja)V.InContent&&(qb+=1);return qb}UTl(ja){const qb=this.ya.Ia;
if(qb){var V=this.OQh,Ea=this.PQh,Za=this.NQh;this.OQh=null;this.PQh=-1;this.NQh=!1;1===ja&&(this.Sxi(qb,V,Ea,Za,null),r.ULS.sendTraceTag(512499936,801,50,"ThemeActor.ChangeThemeHandler: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Hd.uXe(V),Ea,qb.fc.sid))}}Sxi(ja,qb,V,Ea,Za){this.Yfm=(this.gem=Ea)?new od(qb,0):this.wUe;var ia=Object(oe.a)("ThemeRemoveSelectionFocusPostOB");const Va=()=>{this.Na.ee();this.sa.nj()};ia=this.Tb.Kd(15,void 0,ia?void 0:Va,ia?Va:void 0,!0);try{if(ia.tc(ja),ia.wc=
Ea?Yc.a.N2a:Yc.a.Bw,this.tfm&&Za)for(const Ab of Za)Ab.setValue(Rf.a.Msh,qb),Ab.setValue(Rf.a.wga,V),Ab.setValue(Rf.a.KRl,1<Za.length);else ja.setValue(Rf.a.Msh,qb),ja.setValue(Rf.a.wga,V)}finally{ia&&ia.dispose()}this.zc.Uzc(this.jc.Tf,ja,"ChangeTheme")}x2e(ja,qb,V,Ea,Za){if(1===V)return 32;ja=Math.max(Hd.A7f(this.cIc().Ve),4);qb=this.cIc().Ve;Za.MenuItems=Hd.vkn(ja,qb);return 32}static A7f(ja){for(let qb=0;qb<sd.a.bpc.length;++qb)if(sd.a.bpc[qb].cKh===ja)return sd.a.bpc[qb].LDl;return 0}static uXe(ja){for(let qb=
0;qb<sd.a.bpc.length;++qb)if(sd.a.bpc[qb].cKh===ja)return sd.a.bpc[qb].HDm;return Hd.gTl}static Nan(ja){let qb="";for(let V=0;V<sd.a.bpc.length;++V)sd.a.bpc[V].cKh===ja&&(qb=sd.a.bpc[V].HDm.replace(" ",""));return qb}static vkn(ja,qb){const V=Object.assign(new Dc.a,{Id:"PptRibbon.Design.ThemeVariants.Anchor.Menu",MenuSectionList:[]});var Ea=Object.assign(new Ve.a,{Id:"PptRibbon.Design.ThemeVariants.MenuSection",DisplayMode:"Size85by48",ControlList:[]});Array.add(V.MenuSectionList,Ea);const Za=Object.assign(new cd.a,
{Id:"PptRibbon.Design.ThemeVariants.Gallery",ExternalId:"MoreVariantsSection",ExternalGalleryId:"MoreVariantsGallery",Type:4,Width:4,ElementDimensions:"Size85by48",GalleryItems:[]});Array.add(Ea.ControlList,Za);for(Ea=1;Ea<=ja;++Ea)Array.add(Za.GalleryItems,Hd.A1l("Variant"+Ea,Ea,qb));return V}static A1l(ja,qb,V){V=!Hd.A7f(V)||qb>Hd.A7f(V)?"EmptyVariantsGallery_85x48x8":String.format("ThemeVariantGallery{0}{1}_85x48x24",Hd.Nan(V),qb);return Object.assign(new ed.a,{Id:ja,ExternalId:ja,Icon:V,Alt:String.format(ResourceStrings.L_ThemeVariantAlt,
qb),PreviewIconStyle:{root:{width:"49px",height:"28px",margin:"-2px"}},FullIconStyle:{root:{width:"85px",height:"48px"}},Command:"2759977169",QueryCommand:"1425701611"})}}Hd.e_m="00000000-0000-0000-0000-000000000000";Hd.gTl="Unsupported Theme";Hd.j_m="blankNew";Hd.ODi=3E5;Object(m.a)(Hd,"ThemeActor",null,[502]);class Wd{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc,fd){this.la=ja;this.jc=qb;this.ya=V;this.sa=Za;this.Na=ia;this.Tb=Ea;this.pF=Va;this.zc=Ab;this.Dfm=gc.j$l;this.Pu=gc.wI;this.ble=gc.s$l;this.HFg=
Hc.Eq(Od.a.g2e);this.zb=fd}Kb(){this.ble?(this.Dfm?(this.la.ua(Yc.a.zk,ad.a.application,Object(da.a)(this,this.Jbo,"setSlidesTransitionGalleryExceptExisting"),5),this.la.ua(Yc.a.Ok,ad.a.application,Object(da.a)(this,this.w2n,"querySlidesTransitionGalleryExceptExisting"),97),this.la.ua(Yc.a.Hcb,ad.a.application,Object(da.a)(this,this.Kbo,"setSlidesTransitionGalleryExisting"),5),this.la.ua(Yc.a.WDb,ad.a.application,Object(da.a)(this,this.Lbo,"setSlidesTransitionGalleryExistingInMenu"),5),this.la.ua(Yc.a.sbb,
ad.a.application,Object(da.a)(this,this.x2n,"querySlidesTransitionGalleryExisting"),97),this.la.ua(Yc.a.fCb,ad.a.application,Object(da.a)(this,this.y2n,"querySlidesTransitionGalleryExistingInMenu"),97)):(this.la.ua(Yc.a.zk,ad.a.application,Object(da.a)(this,this.Ecl,"setSlidesTransitionGallery"),5),this.la.ua(Yc.a.Ok,ad.a.application,Object(da.a)(this,this.COk,"querySlidesTransitionGallery"),97),this.la.ua(Yc.a.Hcb,ad.a.application,Object(da.a)(this,this.Ecl,"setSlidesTransitionGallery"),5),this.la.ua(Yc.a.WDb,
ad.a.application,Object(da.a)(this,this.Ecl,"setSlidesTransitionGallery"),5),this.la.ua(Yc.a.sbb,ad.a.application,Object(da.a)(this,this.COk,"querySlidesTransitionGallery"),97),this.la.ua(Yc.a.fCb,ad.a.application,Object(da.a)(this,this.COk,"querySlidesTransitionGallery"),97)),this.la.ua(Yc.a.xLb,ad.a.application,Object(da.a)(this,this.Ibo,"setSlidesTransitionEffectOption"),5),this.la.ua(Yc.a.pCe,ad.a.application,Object(da.a)(this,this.u2n,"querySlidesTransitionEffectOption"),97),this.la.ua(Yc.a.Hdc,
ad.a.application,Object(da.a)(this,this.v2n,"querySlidesTransitionEffectOptionsAnchor"),100),this.la.ua(Yc.a.J4c,ad.a.application,Object(da.a)(this,this.vYn,"populateSlidesTransitionEffectOptions"),96),this.la.ua(Yc.a.rUa,ad.a.application,Object(da.a)(this,this.t2n,"querySlidesTransitionDuration"),97),this.la.ua(Yc.a.Aib,ad.a.application,Object(da.a)(this,this.Hbo,"setSlidesTransitionDuration"),5)):(this.Dfm?(this.la.ua(Yc.a.zk,ad.a.application,Object(da.a)(this,this.fco,"setTransitionGalleryExceptExisting"),
5),this.la.ua(Yc.a.Ok,ad.a.application,Object(da.a)(this,this.F2n,"queryTransitionGalleryExceptExisting"),97),this.la.ua(Yc.a.Hcb,ad.a.application,Object(da.a)(this,this.gco,"setTransitionGalleryExisting"),5),this.la.ua(Yc.a.WDb,ad.a.application,Object(da.a)(this,this.hco,"setTransitionGalleryExistingInMenu"),5),this.la.ua(Yc.a.sbb,ad.a.application,Object(da.a)(this,this.sbb,"queryTransitionGalleryExisting"),97),this.la.ua(Yc.a.fCb,ad.a.application,Object(da.a)(this,this.fCb,"queryTransitionGalleryExistingInMenu"),
97)):(this.la.ua(Yc.a.zk,ad.a.application,Object(da.a)(this,this.ldl,"setTransitionGallery"),5),this.la.ua(Yc.a.Ok,ad.a.application,Object(da.a)(this,this.Ok,"queryTransitionGallery"),97),this.la.ua(Yc.a.Hcb,ad.a.application,Object(da.a)(this,this.ldl,"setTransitionGallery"),5),this.la.ua(Yc.a.WDb,ad.a.application,Object(da.a)(this,this.ldl,"setTransitionGallery"),5),this.la.ua(Yc.a.sbb,ad.a.application,Object(da.a)(this,this.Ok,"queryTransitionGallery"),97),this.la.ua(Yc.a.fCb,ad.a.application,Object(da.a)(this,
this.Ok,"queryTransitionGallery"),97)),this.la.ua(Yc.a.xLb,ad.a.application,Object(da.a)(this,this.eco,"setTransitionEffectOption"),5),this.la.ua(Yc.a.pCe,ad.a.application,Object(da.a)(this,this.E2n,"queryTransitionEffectOption"),97),this.la.ua(Yc.a.Hdc,ad.a.application,Object(da.a)(this,this.Hdc,"queryTransitionEffectOptionsAnchor"),100),this.la.ua(Yc.a.J4c,ad.a.application,Object(da.a)(this,this.J4c,"populateTransitionEffectOptions"),96),this.la.ua(Yc.a.rUa,ad.a.application,Object(da.a)(this,this.rUa,
"queryTransitionDuration"),97),this.la.ua(Yc.a.Aib,ad.a.application,Object(da.a)(this,this.Aib,"setTransitionDuration"),5));this.la.ua(Yc.a.VDb,ad.a.application,Object(da.a)(this,this.VDb,"setTransitionApplyAll"),4);this.la.ua(Yc.a.Snc,ad.a.application,Object(da.a)(this,this.Snc,"queryTransitionApplyAll"),96)}Ae(){}J4c(ja,qb,V,Ea,Za){if(this.Pu&&1!==this.sa.rg().length)return 16;if(1===V)return 32;ja=(ja=this.ya.Ia)?ja.EB:null;if(!ja)return 16;if(!Za)return 8;ja=this.pF.xXe(ja);ja.next&&(Za.MenuItems=
this.ISl(ja));return 32}Ok(ja,qb,V,Ea,Za){if(!Za)return 8;ja=Za.queryResult;Za=Za.SourceControlId;qb=this.pF.wIa(Za);if(!qb)return 8;ja.kOa=Wd.Ubj(qb.If,qb.yf,this.HFg);qb=this.ya.Ia;if(!qb)return 16;1===V&&((V=qb.EB)?(V=this.pF.Tld(V),ja.boa(!V&&"TransitionExisting"===Za||V===Za)):ja.boa("TransitionNone"===Za));return 32}F2n(ja,qb,V,Ea,Za){if(!Za||ja!==Yc.a.Ok)return 8;ja=Za.queryResult;Za=Za.SourceControlId;qb=this.pF.wIa(Za);if(!qb)return 8;Ea=qb.If.split("_")[1]+"_24";qb=Wd.$kd(Za,Za,Ea,"2024601249",
"149145197",qb.yf,qb.yf);ja.YAa=qb;qb=this.ya.Ia;if(!qb)return 16;1===V&&((V=qb.EB)?(V=this.pF.Tld(V),ja.boa(V===Za)):ja.boa("TransitionNone"===Za));return 32}sbb(ja,qb,V,Ea,Za){if(!Za||ja!==Yc.a.sbb)return 8;ja=Za.queryResult;Za=Za.SourceControlId;if(!Za||"TransitionExisting"!==Za)return 16;qb=this.pF.wIa(Za);if(!qb)return 8;Ea=qb.If.split("_")[1]+"_24";qb=Wd.$kd(Za,Za,Ea,"3752636652","3476251476",qb.yf,qb.yf);ja.YAa=qb;qb=this.ya.Ia;if(!qb)return 16;if(1===V&&(V=qb.EB)){V=this.pF.Tld(V);qb=this.pF.jPh(V,
this.pF.WWe());if(V&&!qb){Ea=this.pF.wIa(V);if(!Ea)return 8;const ia=Ea.If.split("_")[1]+"_24";Za=Wd.$kd(Za,Za,ia,"3752636652","3476251476",Ea.yf,Ea.yf);ja.YAa=Za}ja.boa(!V||!!V&&!qb)}return 32}fCb(ja,qb,V,Ea,Za){if(!Za||ja!==Yc.a.fCb)return 8;ja=Za.queryResult;Za=Za.SourceControlId;if(!Za||"TransitionExistingInMenu"!==Za)return 16;qb=this.pF.wIa(Za);if(!qb)return 8;Ea=qb.If.split("_")[1]+"_24";Za=Wd.$kd(Za,Za,Ea,"4036532528","2831233208",qb.yf,qb.yf);ja.YAa=Za;Za=this.ya.Ia;if(!Za)return 16;1===
V&&(V=Za.EB)&&(V=this.pF.Tld(V),ja.boa(!V));return 32}Hdc(ja,qb,V){ja=this.ya.Ia;if(!ja)return 16;ja=this.pF.xXe(ja.EB);return!ja||!ja.next||this.Pu&&1!==this.sa.rg().length?16:1===V?32:8}ldl(ja,qb,V,Ea,Za){if(!Za)return 8;qb=Za.SourceControlId;Za=ja===Yc.a.Hcb||ja===Yc.a.WDb;Ea=this.ya.Ia;if(!Ea||this.zc.Hd(Ea)||this.Pu&&1!==this.sa.rg().length)return 16;var ia=Ea.EB;const Va=!!this.pF.Sld(ia);if(Za&&(!ia||Va))return 16;if(1===V)return 32;ia=this.pF.wIa(qb);if(!ia)return 8;if(!Za&&2===V&&qb){Uf.a.Ak("SlideCount",
"1");V=this.Tb.Kd(15,void 0,()=>{this.sa.lk();this.Na.ee()});try{V.tc(Ea),V.wc=ja,Ea.EB=ia.Cf}finally{V&&V.dispose()}r.ULS.sendTraceTag(512499935,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",qb,ia.next||"null",Ea.fc.sid)}return 32}fco(ja,qb,V,Ea,Za){if(!Za)return 8;qb=Za.SourceControlId;Ea=this.ya.Ia;if(!Ea)return 16;if(ja!==Yc.a.zk)return 8;if(this.zc.Hd(Ea)||this.Pu&&1!==this.sa.rg().length)return 16;if(1===V)return 32;Za=
this.pF.wIa(qb);if(!Za)return 8;if(2===V&&qb){Uf.a.Ak("SlideCount","1");V=this.Tb.Kd(15,void 0,()=>{this.sa.lk();this.Na.ee()});try{V.tc(Ea),V.wc=ja,Ea.EB=Za.Cf}finally{V&&V.dispose()}r.ULS.sendTraceTag(512499934,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",qb,Za.next||"null",Ea.fc.sid)}return 32}gco(ja,qb,V,Ea,Za){if(!Za)return 8;qb=this.ya.Ia;if(!qb)return 16;if(ja!==Yc.a.Hcb)return 8;if(this.Pu&&1!==this.sa.rg().length)return 16;
if(1!==V)return 8;ja=qb.EB;V=!!this.pF.Sld(ja);qb=this.pF.xXe(ja);qb=this.pF.jPh(qb?qb.parent:null,this.pF.WWe());return ja&&!V||!qb?32:16}hco(ja,qb,V,Ea,Za){if(!Za)return 8;qb=this.ya.Ia;if(!qb)return 16;if(ja!==Yc.a.WDb)return 8;if(this.Pu&&1!==this.sa.rg().length)return 16;if(1!==V)return 8;ja=qb.EB;V=!!this.pF.Sld(ja);return!ja||V?16:32}VDb(ja,qb,V){qb=this.ya.Ia;if(!qb||this.zc.Hd(qb)||this.Pu&&1!==this.sa.rg().length)return 16;if(1===V)return 32;Uf.a.Ak("SlideCount","1");V=this.jc.Tf;const Ea=
this.Tb.Kd(15,void 0,()=>{this.sa.lk();this.Na.ee()});try{Ea.tc(V),Ea.wc=ja,V.CHb=qb.fc}finally{Ea&&Ea.dispose()}r.ULS.sendTraceTag(512499933,801,50,"TransitionActor: Command=SetTransitionApplyAll");return 32}Snc(ja,qb,V,Ea,Za){ja=this.ya.Ia?!0:!1;if(!Za)return 8;Za=Za.queryResult;Za.kOa=Wd.Ubj("pegal_TransitionNewsFlash_32x32x32",ResourceStrings.L_TransitionApplyAll,this.HFg);Za.boa(ja);return ja?32:16}eco(ja,qb,V,Ea,Za){if(!Za)return 8;qb=Za.MenuItemId;if(this.Pu&&1!==this.sa.rg().length)return 16;
if(1===V)return 32;V=this.ya.Ia;if(!V||this.zc.Hd(V))return 16;Ea=V?V.EB:null;Za=this.pF.wIa(qb);if(!Ea||!Za||!Za.Cf)return 16;Ea.TransitionType=Za.Cf.TransitionType;Ea.Direction=Za.Cf.Direction;Ea.Duration=Za.Cf.Duration;Uf.a.Ak("SlideCount","1");const ia=this.Tb.Kd(15,void 0,()=>{this.sa.lk();this.Na.ee()});try{ia.tc(V),ia.wc=ja,V.EB=Ea}finally{ia&&ia.dispose()}r.ULS.sendTraceTag(512499932,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",
Za.parent,qb,V.fc.sid);return 32}E2n(ja,qb,V,Ea,Za){if(!Za)return 8;ja=Za.queryResult;Za=Za.MenuItemId;qb=this.ya.Ia;if(!qb)return 16;1===V&&ja.Fg(this.pF.Sld(qb.EB)===Za);return 32}rUa(ja,qb,V,Ea,Za){ja=this.ya.Ia;if(!ja)return 16;if(!Za)return 8;ja=ja.EB;if(Za=Za.queryResult)Za.pga=ja?(ja.Duration/1E3).toString():"0";return 32}Aib(ja,qb,V,Ea,Za){qb=this.ya.Ia;if(!qb||this.zc.Hd(qb))return 16;if(!Za)return 8;if(this.Pu&&1!==this.sa.rg().length)return 16;Ea=Math.floor(1E3*Za.Number);Za=qb.EB;if(!Za)return 16;
Uf.a.Bb&&(Uf.a.Bb.actionName="SetTransitionDuration");if(1===V)return"TransitionNone"===this.pF.Tld(Za)?16:32;if(2===V){Za.Duration=Ea;const ia=this.Na.currentScope;Uf.a.Ak("SlideCount","1");V=this.Tb.Kd(15,void 0,()=>{this.sa.lk();!ia||ia.name!==ee.a.sh&&ia.name!==ee.a.GM||this.Na.ee()});try{V.tc(qb),V.wc=ja,qb.EB=Za}finally{V&&V.dispose()}}return 32}vYn(ja,qb,V,Ea,Za){if(1===V)return 32;if(!Za)return 8;qb=this.sa.rg();if(!qb||!qb.length)return 16;ja=qb[0].EB;if(!ja)return 16;ja=this.pF.xXe(ja);
if(1<qb.length)for(const ia of qb){qb=ia.EB;if(!qb)return 16;qb=this.pF.xXe(qb);if(ja.parent!==qb.parent)return 16}ja.next&&(Za.MenuItems=this.ISl(ja));return 32}COk(ja,qb,V,Ea,Za){if(!Za)return 8;ja=Za.queryResult;Za=Za.SourceControlId;qb=this.pF.wIa(Za);if(!qb)return 8;ja.kOa=Wd.Ubj(qb.If,qb.yf,this.HFg);qb=this.sa.rg();if(!qb||!qb.length)return 16;1===V&&(V="",({dic:V}=this.gkd(qb)).returnValue&&ja.boa(!V&&"TransitionExisting"===Za||V===Za));return 32}w2n(ja,qb,V,Ea,Za){if(!Za||ja!==Yc.a.Ok)return 8;
ja=Za.queryResult;Za=Za.SourceControlId;qb=this.pF.wIa(Za);if(!qb)return 8;Ea=qb.If.split("_")[1]+"_24";qb=Wd.$kd(Za,Za,Ea,"2024601249","149145197",qb.yf,qb.yf);ja.YAa=qb;qb=this.sa.rg();if(!qb||!qb.length)return 16;1===V&&(V="",({dic:V}=this.gkd(qb)).returnValue&&ja.boa(V===Za));return 32}x2n(ja,qb,V,Ea,Za){if(!Za||ja!==Yc.a.sbb)return 8;ja=Za.queryResult;Za=Za.SourceControlId;if(!Za||"TransitionExisting"!==Za)return 16;qb=this.pF.wIa(Za);if(!qb)return 8;Ea=qb.If.split("_")[1]+"_24";qb=Wd.$kd(Za,
Za,Ea,"3752636652","3476251476",qb.yf,qb.yf);ja.YAa=qb;qb=this.sa.rg();if(!qb||!qb.length)return 16;if(1===V&&(V="",({dic:V}=this.gkd(qb)).returnValue)){qb=this.pF.jPh(V,this.pF.WWe());if(V&&!qb){Ea=this.pF.wIa(V);if(!Ea)return 8;const ia=Ea.If.split("_")[1]+"_24";Za=Wd.$kd(Za,Za,ia,"3752636652","3476251476",Ea.yf,Ea.yf);ja.YAa=Za}ja.boa(!V||!!V&&!qb)}return 32}y2n(ja,qb,V,Ea,Za){if(!Za||ja!==Yc.a.fCb)return 8;ja=Za.queryResult;Za=Za.SourceControlId;if(!Za||"TransitionExistingInMenu"!==Za)return 16;
qb=this.pF.wIa(Za);if(!qb)return 8;Ea=qb.If.split("_")[1]+"_24";Za=Wd.$kd(Za,Za,Ea,"4036532528","2831233208",qb.yf,qb.yf);ja.YAa=Za;Za=this.sa.rg();if(!Za||!Za.length)return 16;1===V&&(V="",({dic:V}=this.gkd(Za)).returnValue&&ja.boa(!V));return 32}v2n(ja,qb,V){ja=this.sa.rg();if(!ja||!ja.length)return 16;qb=this.pF.xXe(ja[0].EB);return!qb||!qb.next||1<ja.length&&!this.gkd(ja).returnValue?16:1===V?32:8}Ecl(ja,qb,V,Ea,Za){if(!Za)return 8;qb=Za.SourceControlId;Za=ja===Yc.a.Hcb||ja===Yc.a.WDb;Ea=this.sa.rg();
if(!Ea||!Ea.length)return 16;for(var ia of Ea)if(this.zc.Hd(ia))return 16;ia="";const Va=({dic:ia}=this.gkd(Ea)).returnValue;if(Za&&(!Va||ia))return 16;if(1===V)return 32;ia=this.pF.wIa(qb);if(!ia)return 8;if(!Za&&2===V&&qb){Uf.a.Ak("SlideCount",Ea.length.toString());V=this.Tb.Kd(15,void 0,()=>{this.sa.lk();this.Na.ee()});try{V.tc(this.jc.Tf);V.wc=ja;for(const Ab of Ea)Ab.EB=ia.Cf}finally{V&&V.dispose()}r.ULS.sendTraceTag(512499931,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",
qb,ia.next||"null")}return 32}Jbo(ja,qb,V,Ea,Za){if(!Za)return 8;qb=Za.SourceControlId;if(ja!==Yc.a.zk)return 8;Ea=this.sa.rg();if(!Ea||!Ea.length)return 16;for(var ia of Ea)if(this.zc.Hd(ia))return 16;if(1===V)return 32;ia=this.pF.wIa(qb);if(!ia)return 8;if(2===V&&qb){Uf.a.Ak("SlideCount",Ea.length.toString());V=this.Tb.Kd(15,void 0,()=>{this.sa.lk();this.Na.ee()},()=>{1===this.zb.fj&&this.Na.Gm(ee.a.TA,!0)});try{V.tc(this.jc.Tf);V.wc=ja;for(const Va of Ea)Va.EB=ia.Cf}finally{V&&V.dispose()}r.ULS.sendTraceTag(512499930,
801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",qb,ia.next||"null")}return 32}Kbo(ja,qb,V,Ea,Za){if(!Za)return 8;qb=this.sa.rg();if(!qb||!qb.length)return 16;if(ja!==Yc.a.Hcb||1!==V)return 8;Ea="";ja=({dic:Ea}=this.gkd(qb)).returnValue;V=!!Ea;qb=Ea&&0<Ea.length?this.pF.wIa(Ea):null;qb=this.pF.jPh(qb?qb.parent:null,this.pF.WWe());return!ja||V&&qb?16:32}Lbo(ja,qb,V,Ea,Za){if(!Za)return 8;qb=this.sa.rg();if(!qb||!qb.length)return 16;if(ja!==Yc.a.WDb||
1!==V)return 8;ja="";return!({dic:ja}=this.gkd(qb)).returnValue||ja?16:32}Ibo(ja,qb,V,Ea,Za){if(!Za)return 8;qb=Za.MenuItemId;if(1===V)return 32;V=this.sa.rg();if(!V||!V.length)return 16;Ea=oe.a("NoTransitionForEffectCmdFixEnabled");for(var ia of V){if(this.zc.Hd(ia))return 16;Za=ia.EB;if(!Ea&&!Za)return 16}ia=this.pF.wIa(qb);if(!ia||!ia.Cf)return 16;Uf.a.Ak("SlideCount",V.length.toString());Za=this.Tb.Kd(15,void 0,()=>{this.sa.lk();this.Na.ee()});try{Za.tc(this.jc.Tf);Za.wc=ja;for(const Va of V){const Ab=
!Ea||Va.EB?Va.EB:ia.Cf;Ab.TransitionType=ia.Cf.TransitionType;Ab.Direction=ia.Cf.Direction;Ab.Duration=ia.Cf.Duration;Va.EB=Ab}}finally{Za&&Za.dispose()}r.ULS.sendTraceTag(512499929,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}",ia.parent,qb);return 32}u2n(ja,qb,V,Ea,Za){if(!Za)return 8;ja=Za.queryResult;Za=Za.MenuItemId;qb=this.sa.rg();if(!qb||!qb.length)return 16;1===V&&(V="",({dic:V}=this.K8m(qb)).returnValue&&ja.Fg(V===Za));return 32}t2n(ja,
qb,V,Ea,Za){if(!Za)return 8;ja=this.sa.rg();if(!ja||!ja.length)return 16;if(Za=Za.queryResult)ja=Wd.Iln(ja),Za.pga=ja;return 32}Hbo(ja,qb,V,Ea,Za){if(!Za)return 8;qb=this.sa.rg();if(!qb||!qb.length)return 16;for(const ia of qb)if(this.zc.Hd(ia))return 16;Za=Math.floor(1E3*Za.Number);for(const ia of qb)if(!ia.EB)return 16;Uf.a.Bb&&(Uf.a.Bb.actionName="SetTransitionDuration");if(1===V){for(const ia of qb)if("TransitionNone"===this.pF.Tld(ia.EB))return 16;return 32}if(2===V){const ia=this.Na.currentScope;
Uf.a.Ak("SlideCount",qb.length.toString());V=this.Tb.Kd(15,void 0,()=>{this.sa.lk();!ia||ia.name!==ee.a.sh&&ia.name!==ee.a.GM||this.Na.ee()});try{V.tc(this.jc.Tf);V.wc=ja;for(const Va of qb){const Ab=Va.EB;Ab.Duration=Za;Va.EB=Ab}}finally{V&&V.dispose()}}return 32}gkd(ja){let qb;qb="";if(!ja||!ja.length)return{returnValue:!1,dic:qb};qb=this.pF.Tld(ja[0].EB);let V=!0;if(1<ja.length)for(const Ea of ja)if(ja=this.pF.Tld(Ea?Ea.EB:null),qb!==ja){V=!1;break}V||(qb="");return{returnValue:V,dic:qb}}K8m(ja){let qb;
qb="";if(!ja||!ja.length)return{returnValue:!1,dic:qb};qb=this.pF.Sld(ja[0].EB);let V=!0;if(1<ja.length)for(const Ea of ja)if(ja=this.pF.Sld(Ea?Ea.EB:null),qb!==ja){V=!1;break}V||(qb="");return{returnValue:V,dic:qb}}ISl(ja){const qb=Object.assign(new Dc.a,{Id:"TransitionMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_TransitionEffectOptions,MenuSectionList:[]}),V=Object.assign(new Ve.a,{Id:"MenuSectionEffectOptions",ControlsId:"MenuSectionEffectOptions.Controls",DisplayMode:"Menu32",
ControlList:[]});Array.add(qb.MenuSectionList,V);let Ea=null;for(ja=({key:Ea}=this.pF.x3l(ja)).returnValue;ja;)Array.add(V.ControlList,Object.assign(new hf.a,{Command:"961566706",Id:Ea,ExternalId:"TransitionEffectOptions"+Ea,QueryCommand:"3535869262"})),{key:Ea,returnValue:ja}=this.pF.x3l(ja);return qb}static Iln(ja){let qb;if(!ja||!ja.length)return"0";const V=ja[0].EB;qb=V?(V.Duration/1E3).toString():"0";let Ea=!0;if(1<ja.length)for(const Za of ja)if((ja=Za?Za.EB:null)||V){if(!ja&&V||ja&&!V){Ea=
!1;break}if(qb!==(ja.Duration/1E3).toString()){Ea=!1;break}}Ea||(qb="0");return qb}static Ubj(ja,qb,V){ja=String.format('<SPAN class="cui-img-32by32 cui-img-cont-float" unselectable="on"><IMG class="{0}" src="{1}" unselectable="on"></SPAN>',ja,V);qb=String.format('<P class="cui-ctl-mediumlabel GalleryButtonLabel" unselectable="on">{0}</P>',qb);return String.format('<DIV class="GalleryButtonWithLabel">{0}{1}</DIV>',ja,qb)}static $kd(ja,qb,V,Ea,Za,ia,Va){return Object.assign(new ed.a,{Id:ja,ExternalId:qb,
Icon:V,Command:Ea,QueryCommand:Za,LabelText:ia,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Va})}}Object(m.a)(Wd,"TransitionActor",null,[502]);class mb{constructor(ja,qb,V,Ea,Za,ia,Va){this.dF=null;this.kpl=!1;this.UYa=V;this.sa=ja;(this.V8a=Ea)&&Za.execute(Ab=>{this.dF=Ab});this.ta=Va;this.la=qb;this.Q8a=ia}selectShape(){this.sa&&!this.sa.G3(this.ta)&&this.sa.selectShape(this.ta,!0)}onVolumeChanged(ja){const qb={ActionFromPlayer:!0};.2>=
ja?(qb.SourceControlId="SetVolumeLow",this.la.Ra(Yc.a.Psd,2,qb)):.2<ja&&.8>ja?(qb.SourceControlId="SetVolumeMedium",this.la.Ra(Yc.a.Qsd,2,qb)):.8<=ja&&(qb.SourceControlId="SetVolumeHigh",this.la.Ra(Yc.a.Osd,2,qb));this.selectShape()}onPlayToggled(ja){const qb={ActionFromPlayer:!0};ja?this.la.Ra(Yc.a.Iid,2,qb):this.la.Ra(Yc.a.HHb,2,qb);this.selectShape()}onMuteToggled(ja){if(ja)this.la.Ra(Yc.a.Rsd,2,{ActionFromPlayer:!0,SourceControlId:"SetVolumeMute"});else this.onVolumeChanged(this.ta.media.vlmField);
this.selectShape()}onPlayerReadyStateChanged(ja){ja&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("AudioPlay",!1))}onMouseHoverStateChanged(ja){ja||this.sa.vZe(this.ta)||(ja=this.IO())&&ja.showHidePlayer(!1)}onPlayerClicked(){this.V8a&&this.la.Eb(Yc.a.NLb,2)}onPlayerError(ja){Pc.a.$(512497820,822,10,"AudioLibraryCallback::OnPlayerError Error Message: {0}",ja);ja&&-1<ja.indexOf("PIPELINE_ERROR_READ")&&this.UYa.bXe(this.Q8a.podSessionId,this.ta).then(qb=>{const V=this.IO();
V&&V.setAudioSrc(qb)})}onKeyDown(ja){ja===xa.a.RZa?(ja=this.IO())&&ja.removeFocusFromPlayer():ja===xa.a.yt&&(this.kpl=!0)}onBlur(){const ja=this.IO();ja&&(this.kpl?ja.setFocusOnPlayer():ja.removeFocusFromPlayer());this.kpl=!1}IO(){return this.V8a&&this.dF?this.dF.IO(this.ta):null}}Object(m.a)(mb,"AudioLibraryCallback",null,[742]);class lc{constructor(ja,qb,V,Ea,Za,ia){this.UYa=ja;this.sa=qb;this.la=V;this.V8a=Ea;this.ovb=ia;this.Q8a=Za}z3m(ja){return new mb(this.sa,this.la,this.UYa,this.V8a,this.ovb,
this.Q8a,ja)}}Object(m.a)(lc,"AudioLibraryCallbackFactory",null,[690]);class Mc{constructor(ja,qb,V,Ea){this.volume=ja;this.mute=qb;this.repeat=V;this.rewind=Ea}}Object(m.a)(Mc,"MediaProperties",null,[]);class md{constructor(ja,qb,V,Ea){this.yDn=ja;this.bhk=qb;this.UYa=V;this.Q8a=Ea}createAudioManager(ja,qb,V){return new Promise((Ea,Za)=>{this.bhk("audioPlayback").then(()=>{window.self.audioPlayback?(Pc.a.$(512497818,801,50,"audio script is loaded successfully"),Ea(this.A3m(ja,qb,V))):(Pc.a.$(512497819,
801,10,"Audio script is loaded successfully but AudioPlayback namespace cannot be found"),Za("Audio script is loaded successfully but AudioPlayback namespace cannot be found"))}).catch(ia=>{Pc.a.$(512497817,801,10,"Failed to load audio script "+ia.toString());Za("Failed to load audio script ")})})}A3m(ja,qb,V){const Ea=qb.media;let Za=null;Ea&&(Za=new Mc(Ea.vlmField,Ea.mteField,Ea.repeatField,Ea.rewindField));const ia=audioPlayback.pptAudioFactoryGlobal.createAudioManager(ja,V,this.yDn.z3m(qb),Za);
this.UYa.bXe(this.Q8a.podSessionId,qb).then(Va=>{ia&&ia.setAudioSrc(Va)});return ia}}Object(m.a)(md,"AudioManagerFactory",null,[691]);var ud=a(1833);class Qd{constructor(){this.d_e=new ud.a}htm(ja,qb){qb&&this.d_e.fa(qb.id,ja)}W1h(ja){ja&&this.d_e.Sb(ja.id)&&(this.d_e.ka(ja.id).dispose(),this.d_e.remove(ja.id))}IO(ja){return ja&&this.d_e.Sb(ja.id)?this.d_e.ka(ja.id):null}}Object(m.a)(Qd,"AudioManagerStore",null,[689]);class kb{constructor(){this.Duration=this.Direction=0;this.IsManualAdvance=!1;this.TransitionType=
0}}Object(m.a)(kb,"EditTransitionInfo",null,[]);class Xb{constructor(){this.next=this.parent=this.Cf=this.A1=this.If=this.yf=null}}Object(m.a)(Xb,"Transition",null,[]);class sc{}sc.none=0;sc.Zbn=5;sc.$bn=4;sc.Iio=1;sc.Inn=1;sc.sYm=2;sc.rqb=0;sc.Xkd=1;sc.hHc=2;sc.AWe=3;sc.QKh=4;sc.PKh=5;sc.SKh=6;sc.RKh=7;sc.NMh=2;sc.Jmd=1;sc.Bnn=1;sc.MSl=0;sc.MZm=1;sc.LZm=2;sc.Dnn=0;sc.Cnn=1;sc.z5l=2;sc.Jnn=3;sc.Svj=0;sc.b8f=1;sc.MMh=0;sc.h2d=1;sc.uYm=1;sc.mSl=0;sc.QAm=2;sc.ago=0;sc.Kio=3;sc.Jio=1;sc.wheel=1;sc.Yvm=
29;sc.f1l=0;sc.vcn=1;sc.Bcn=2;sc.Jcn=3;sc.e1l=8;sc.ucn=9;sc.Acn=10;sc.Icn=11;sc.g1l=12;sc.ycn=13;sc.Dcn=14;sc.Mcn=15;sc.h1l=4;sc.zcn=5;sc.Ecn=6;sc.Ncn=7;sc.Ccn=0;sc.Kcn=1;sc.Fcn=2;sc.wcn=3;sc.d1l=4;sc.Lcn=5;sc.Gcn=6;sc.xcn=7;Object(m.a)(sc,"TransitionEffectOptions",null,[]);class Rc{}Rc.none=0;Rc.cut=0;Rc.random=1;Rc.blinds=2;Rc.checker=3;Rc.MCc=4;Rc.dissolve=5;Rc.fade=6;Rc.fed=7;Rc.IRk=8;Rc.E2h=9;Rc.wipe=10;Rc.ezm=11;Rc.split=13;Rc.Bco=17;Rc.Cco=18;Rc.wedge=19;Rc.push=20;Rc.GLi=21;Rc.pRl=23;Rc.wheel=
26;Rc.dzm=27;Rc.MAh=28;Rc.b5e=29;Rc.DKc=30;Rc.ffh=39;Rc.Wol=42;Rc.flip=43;Rc.jxa=44;Rc.Xoo=47;Rc.g7i=48;Rc.g1i=49;Rc.F6m=50;Rc.SEl=51;Rc.s1n=52;Rc.pcn=53;Rc.y6m=54;Rc.YEk=55;Rc.Gom=56;Rc.YCk=57;Rc.Uvi=58;Rc.kCk=59;Rc.morph=60;Rc.pan=36;Rc.zbj=38;Rc.aQi=37;Rc.N0i=33;Rc.window=34;Rc.uXf=32;Rc.zoom=31;Rc.mpo=22;Object(m.a)(Rc,"TransitionTypes",null,[]);class Zc{constructor(ja,qb){let V=0;this.Rf=new gg.a;this.bGn=qb;this.Rf.fa("TransitionExisting",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionExisting,
If:Zc.gg("TransitionFlash"),parent:"TransitionExisting"}));this.Rf.fa("TransitionExistingInMenu",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionExisting,If:Zc.gg("TransitionFlash"),parent:"TransitionExisting"}));this.Rf.fa("TransitionNone",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionNone,If:Zc.gg("TransitionNone"),Cf:Object.assign(new kb,{TransitionType:Rc.none,Direction:sc.sYm,Duration:0,IsManualAdvance:!0}),parent:"TransitionNone"}));this.Rf.fa("TransitionFade",Object.assign(new Xb,
{yf:ResourceStrings.L_TransitionFade,If:Zc.gg("TransitionFadeSmoothly"),Cf:Object.assign(new kb,{TransitionType:Rc.pRl,Direction:sc.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeSmoothly"}));this.Rf.fa("TransitionFadeSmoothly",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionSmoothly,A1:CommonUIStrings.l_TransitionFadeSmoothlyKeytip,If:Zc.gg("TransitionFadeSmoothly"),Cf:Object.assign(new kb,{TransitionType:Rc.pRl,Direction:sc.none,Duration:700,IsManualAdvance:!0}),
parent:"TransitionFade",next:"TransitionFadeThroughBlack"}));this.Rf.fa("TransitionFadeThroughBlack",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionThroughBlack,A1:CommonUIStrings.l_TransitionFadeThroughBlackKeytip,If:Zc.gg("TransitionFadeThroughBlack"),Cf:Object.assign(new kb,{TransitionType:Rc.fade,Direction:sc.none,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionFade"}));let Ea=[];if(ja){Ea=ja.toLowerCase().split(",");for(let Za=0;Za<Ea.length;Za++)Ea[Za]=Ea[Za].trim()}Array.contains(Ea,
"push")||(this.Rf.fa("TransitionPush",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionPush,If:Zc.gg("TransitionPushUp"),Cf:Object.assign(new kb,{TransitionType:Rc.push,Direction:sc.Xkd,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromBottom"})),this.Rf.fa("TransitionPushFromBottom",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromBottom,A1:CommonUIStrings.l_TransitionPushFromBottomKeytip,If:Zc.gg("TransitionPushUp"),Cf:Object.assign(new kb,{TransitionType:Rc.push,
Direction:sc.Xkd,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromLeft"})),this.Rf.fa("TransitionPushFromLeft",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromLeft,A1:CommonUIStrings.l_TransitionPushFromLeftKeytip,If:Zc.gg("TransitionPushRight"),Cf:Object.assign(new kb,{TransitionType:Rc.push,Direction:sc.hHc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromRight"})),this.Rf.fa("TransitionPushFromRight",Object.assign(new Xb,
{yf:ResourceStrings.L_TransitionFromRight,A1:CommonUIStrings.l_TransitionPushFromRightKeytip,If:Zc.gg("TransitionPushLeft"),Cf:Object.assign(new kb,{TransitionType:Rc.push,Direction:sc.rqb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromTop"})),this.Rf.fa("TransitionPushFromTop",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromTop,A1:CommonUIStrings.l_TransitionPushFromTopKeytip,If:Zc.gg("TransitionPushDown"),Cf:Object.assign(new kb,{TransitionType:Rc.push,
Direction:sc.AWe,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush"})));Array.contains(Ea,"cut")||(this.Rf.fa("TransitionCut",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionCut,If:Zc.gg("TransitionCut"),Cf:Object.assign(new kb,{TransitionType:Rc.cut,Direction:sc.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutNone"})),this.Rf.fa("TransitionCutNone",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionNone,A1:CommonUIStrings.l_TransitionCutNoneKeytip,If:Zc.gg("TransitionCut"),
Cf:Object.assign(new kb,{TransitionType:Rc.cut,Direction:sc.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutThroughBlack"})),this.Rf.fa("TransitionCutThroughBlack",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionThroughBlack,A1:CommonUIStrings.l_TransitionCutThroughBlackKeytip,If:Zc.gg("TransitionCutThroughBlack"),Cf:Object.assign(new kb,{TransitionType:Rc.cut,Direction:sc.Iio,Duration:500,IsManualAdvance:!0}),parent:"TransitionCut"})));Array.contains(Ea,"wipe")||
(this.Rf.fa("TransitionWipe",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionWipe,If:Zc.gg("TransitionWipeLeft"),Cf:Object.assign(new kb,{TransitionType:Rc.wipe,Direction:sc.rqb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromRight"})),this.Rf.fa("TransitionWipeFromRight",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromRight,A1:CommonUIStrings.l_TransitionWipeFromRightKeytip,If:Zc.gg("TransitionWipeLeft"),Cf:Object.assign(new kb,{TransitionType:Rc.wipe,
Direction:sc.rqb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTop"})),this.Rf.fa("TransitionWipeFromTop",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromTop,A1:CommonUIStrings.l_TransitionWipeFromTopKeytip,If:Zc.gg("TransitionWipeDown"),Cf:Object.assign(new kb,{TransitionType:Rc.wipe,Direction:sc.AWe,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromLeft"})),this.Rf.fa("TransitionWipeFromLeft",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromLeft,
A1:CommonUIStrings.l_TransitionWipeFromLeftKeytip,If:Zc.gg("TransitionWipeRight"),Cf:Object.assign(new kb,{TransitionType:Rc.wipe,Direction:sc.hHc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottom"})),this.Rf.fa("TransitionWipeFromBottom",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromBottom,A1:CommonUIStrings.l_TransitionWipeFromBottomKeytip,If:Zc.gg("TransitionWipeUp"),Cf:Object.assign(new kb,{TransitionType:Rc.wipe,Direction:sc.Xkd,Duration:1E3,
IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopRight"})),this.Rf.fa("TransitionWipeFromTopRight",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromTopRight,A1:CommonUIStrings.l_TransitionWipeFromTopRightKeytip,If:Zc.gg("TransitionStripsLeftDown"),Cf:Object.assign(new kb,{TransitionType:Rc.E2h,Direction:sc.SKh,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomRight"})),this.Rf.fa("TransitionWipeFromBottomRight",Object.assign(new Xb,
{yf:ResourceStrings.L_TransitionFromBottomRight,A1:CommonUIStrings.l_TransitionWipeFromBottomRightKeytip,If:Zc.gg("TransitionStripsLeftUp"),Cf:Object.assign(new kb,{TransitionType:Rc.E2h,Direction:sc.QKh,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopLeft"})),this.Rf.fa("TransitionWipeFromTopLeft",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromTopLeft,A1:CommonUIStrings.l_TransitionWipeFromTopLeftKeytip,If:Zc.gg("TransitionStripsRightDown"),Cf:Object.assign(new kb,
{TransitionType:Rc.E2h,Direction:sc.RKh,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomLeft"})),this.Rf.fa("TransitionWipeFromBottomLeft",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromBottomLeft,A1:CommonUIStrings.l_TransitionWipeFromBottomLeftKeytip,If:Zc.gg("TransitionStripsRightUp"),Cf:Object.assign(new kb,{TransitionType:Rc.E2h,Direction:sc.PKh,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe"})));Array.contains(Ea,"morph")||(this.Rf.fa("TransitionMorph",
Object.assign(new Xb,{yf:ResourceStrings.L_TransitionMorph,If:Zc.gg("TransitionByObject"),Cf:Object.assign(new kb,{TransitionType:Rc.morph,Direction:sc.MSl,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByObject"})),this.Rf.fa("TransitionMorphByObject",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionByObject,A1:CommonUIStrings.l_TransitionMorphObjectsKeytip,If:Zc.gg("TransitionByObject"),Cf:Object.assign(new kb,{TransitionType:Rc.morph,Direction:sc.MSl,Duration:2E3,
IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByWord"})),this.Rf.fa("TransitionMorphByWord",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionByWord,A1:CommonUIStrings.l_TransitionMorphWordsKeytip,If:Zc.gg("TransitionByWord"),Cf:Object.assign(new kb,{TransitionType:Rc.morph,Direction:sc.MZm,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByChar"})),this.Rf.fa("TransitionMorphByChar",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionByChar,
A1:CommonUIStrings.l_TransitionMorphCharactersKeytip,If:Zc.gg("TransitionByChar"),Cf:Object.assign(new kb,{TransitionType:Rc.morph,Direction:sc.LZm,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph"})));Array.contains(Ea,"split")||(this.Rf.fa("TransitionSplit",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionSplit,If:Zc.gg("TransitionSplitOutVertical"),Cf:Object.assign(new kb,{TransitionType:Rc.split,Direction:sc.z5l,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalOut"})),
this.Rf.fa("TransitionSplitVerticalOut",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionVerticalOut,A1:CommonUIStrings.l_TransitionSplitVerticalOutKeytip,If:Zc.gg("TransitionSplitOutVertical"),Cf:Object.assign(new kb,{TransitionType:Rc.split,Direction:sc.z5l,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalIn"})),this.Rf.fa("TransitionSplitHorizontalIn",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionHorizontalIn,A1:CommonUIStrings.l_TransitionSplitHorizontalInKeytip,
If:Zc.gg("TransitionSplitInHorizontal"),Cf:Object.assign(new kb,{TransitionType:Rc.split,Direction:sc.Cnn,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalOut"})),this.Rf.fa("TransitionSplitHorizontalOut",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionHorizontalOut,A1:CommonUIStrings.l_TransitionSplitHorizontalOutKeytip,If:Zc.gg("TransitionSplitOutHorizontal"),Cf:Object.assign(new kb,{TransitionType:Rc.split,Direction:sc.Dnn,Duration:1500,IsManualAdvance:!0}),
parent:"TransitionSplit",next:"TransitionSplitVerticalIn"})),this.Rf.fa("TransitionSplitVerticalIn",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionVerticalIn,A1:CommonUIStrings.l_TransitionSplitVerticalInKeytip,If:Zc.gg("TransitionSplitInVertical"),Cf:Object.assign(new kb,{TransitionType:Rc.split,Direction:sc.Jnn,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit"})));if(!Array.contains(Ea,"randombars")){this.Rf.fa("TransitionRandomBars",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionRandomBars,
If:Zc.gg("TransitionRandomBarsVertical"),Cf:Object.assign(new kb,{TransitionType:Rc.IRk,Direction:sc.h2d,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",next:"TransitionRandomBarsVertical"}));this.Rf.fa("TransitionRandomBarsVertical",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionVertical,A1:CommonUIStrings.l_TransitionRandomBarsVerticalKeytip,If:Zc.gg("TransitionRandomBarsVertical"),Cf:Object.assign(new kb,{TransitionType:Rc.IRk,Direction:sc.h2d,Duration:1E3,IsManualAdvance:!0}),
parent:"TransitionRandomBars",next:"TransitionRandomBarsHorizontal"}));let Za,ia;this.Rf.fa("TransitionRandomBarsHorizontal",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionHorizontal,ia.A1=CommonUIStrings.l_TransitionRandomBarsHorizontalKeytip,ia.If=Zc.gg("TransitionRandomBarsHorizontal"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.IRk,Za.Direction=sc.MMh,Za.Duration=1E3,Za.IsManualAdvance=!0,Za),ia.parent="TransitionRandomBars",ia))}if(!Array.contains(Ea,"shape")){let Za,ia;this.Rf.fa("TransitionShape",
(ia=new Xb,ia.yf=ResourceStrings.L_TransitionShape,ia.If=Zc.gg("TransitionShapeCircle"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.dzm,Za.Direction=sc.none,Za.Duration=800,Za.IsManualAdvance=!0,Za),ia.parent="TransitionShape",ia.next="TransitionShapeCircle",ia));let Va,Ab;this.Rf.fa("TransitionShapeCircle",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionCircle,Ab.A1=CommonUIStrings.l_TransitionShapeCircleKeytip,Ab.If=Zc.gg("TransitionShapeCircle"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.dzm,Va.Direction=sc.none,
Va.Duration=800,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionShape",Ab.next="TransitionShapeDiamond",Ab));let gc,Hc;this.Rf.fa("TransitionShapeDiamond",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionDiamond,Hc.A1=CommonUIStrings.l_TransitionShapeDiamondKeytip,Hc.If=Zc.gg("TransitionShapeDiamond"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.Bco,gc.Direction=sc.none,gc.Duration=800,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionShape",Hc.next="TransitionShapePlus",Hc));let fd,hd;this.Rf.fa("TransitionShapePlus",
(hd=new Xb,hd.yf=ResourceStrings.L_TransitionPlus,hd.A1=CommonUIStrings.l_TransitionShapePlusKeytip,hd.If=Zc.gg("TransitionShapePlus"),hd.Cf=(fd=new kb,fd.TransitionType=Rc.Cco,fd.Direction=sc.none,fd.Duration=1E3,fd.IsManualAdvance=!0,fd),hd.parent="TransitionShape",hd.next="TransitionShapeIn",hd));let yd,Md;this.Rf.fa("TransitionShapeIn",(Md=new Xb,Md.yf=ResourceStrings.L_TransitionIn,Md.A1=CommonUIStrings.l_TransitionShapeInKeytip,Md.If=Zc.gg("TransitionBoxIn"),Md.Cf=(yd=new kb,yd.TransitionType=
Rc.ezm,yd.Direction=sc.b8f,yd.Duration=1200,yd.IsManualAdvance=!0,yd),Md.parent="TransitionShape",Md.next="TransitionShapeOut",Md));let te,Pe;this.Rf.fa("TransitionShapeOut",(Pe=new Xb,Pe.yf=ResourceStrings.L_TransitionOut,Pe.A1=CommonUIStrings.l_TransitionShapeOutKeytip,Pe.If=Zc.gg("TransitionBoxOut"),Pe.Cf=(te=new kb,te.TransitionType=Rc.ezm,te.Direction=sc.Svj,te.Duration=1200,te.IsManualAdvance=!0,te),Pe.parent="TransitionShape",Pe))}if(!Array.contains(Ea,"reveal")){let Za,ia;this.Rf.fa("TransitionReveal",
(ia=new Xb,ia.yf=ResourceStrings.L_TransitionReveal,ia.If=Zc.gg("TransitionRevealSmoothlyFromRight"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.ffh,Za.Direction=sc.QAm,Za.Duration=3400,Za.IsManualAdvance=!0,Za),ia.parent="TransitionReveal",ia.next="TransitionRevealSmoothlyFromRight",ia));let Va,Ab;this.Rf.fa("TransitionRevealSmoothlyFromRight",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionSmoothlyFromRight,Ab.If=Zc.gg("TransitionRevealSmoothlyFromRight"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.ffh,Va.Direction=
sc.QAm,Va.Duration=3400,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionReveal",Ab.next="TransitionRevealSmoothlyFromLeft",Ab));let gc,Hc;this.Rf.fa("TransitionRevealSmoothlyFromLeft",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionSmoothlyFromLeft,Hc.If=Zc.gg("TransitionRevealSmoothlyFromLeft"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.ffh,gc.Direction=sc.ago,gc.Duration=3400,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionReveal",Hc.next="TransitionRevealFromRight",Hc));let fd,hd;this.Rf.fa("TransitionRevealFromRight",
(hd=new Xb,hd.yf=ResourceStrings.L_TransitionThroughBlackFromRight,hd.If=Zc.gg("TransitionRevealFromRight"),hd.Cf=(fd=new kb,fd.TransitionType=Rc.ffh,fd.Direction=sc.Kio,fd.Duration=3400,fd.IsManualAdvance=!0,fd),hd.parent="TransitionReveal",hd.next="TransitionRevealFromLeft",hd));let yd,Md;this.Rf.fa("TransitionRevealFromLeft",(Md=new Xb,Md.yf=ResourceStrings.L_TransitionThroughBlackFromLeft,Md.If=Zc.gg("TransitionRevealFromLeft"),Md.Cf=(yd=new kb,yd.TransitionType=Rc.ffh,yd.Direction=sc.Jio,yd.Duration=
3400,yd.IsManualAdvance=!0,yd),Md.parent="TransitionReveal",Md))}if(!Array.contains(Ea,"cover")){let Za,ia;this.Rf.fa("TransitionCover",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionCover,ia.If=Zc.gg("TransitionCoverLeft"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.MCc,Za.Direction=sc.rqb,Za.Duration=1E3,Za.IsManualAdvance=!0,Za),ia.parent="TransitionCover",ia.next="TransitionCoverFromRight",ia));let Va,Ab;this.Rf.fa("TransitionCoverFromRight",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionFromRight,Ab.If=
Zc.gg("TransitionCoverLeft"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.MCc,Va.Direction=sc.rqb,Va.Duration=1E3,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionCover",Ab.next="TransitionCoverFromTop",Ab));let gc,Hc;this.Rf.fa("TransitionCoverFromTop",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionFromTop,Hc.If=Zc.gg("TransitionCoverDown"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.MCc,gc.Direction=sc.AWe,gc.Duration=1E3,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionCover",Hc.next="TransitionCoverFromLeft",Hc));
let fd,hd;this.Rf.fa("TransitionCoverFromLeft",(hd=new Xb,hd.yf=ResourceStrings.L_TransitionFromLeft,hd.If=Zc.gg("TransitionCoverRight"),hd.Cf=(fd=new kb,fd.TransitionType=Rc.MCc,fd.Direction=sc.hHc,fd.Duration=1E3,fd.IsManualAdvance=!0,fd),hd.parent="TransitionCover",hd.next="TransitionCoverFromBottom",hd));let yd,Md;this.Rf.fa("TransitionCoverFromBottom",(Md=new Xb,Md.yf=ResourceStrings.L_TransitionFromBottom,Md.If=Zc.gg("TransitionCoverUp"),Md.Cf=(yd=new kb,yd.TransitionType=Rc.MCc,yd.Direction=
sc.Xkd,yd.Duration=1E3,yd.IsManualAdvance=!0,yd),Md.parent="TransitionCover",Md.next="TransitionCoverFromTopRight",Md));let te,Pe;this.Rf.fa("TransitionCoverFromTopRight",(Pe=new Xb,Pe.yf=ResourceStrings.L_TransitionFromTopRight,Pe.If=Zc.gg("TransitionCoverLeftDown"),Pe.Cf=(te=new kb,te.TransitionType=Rc.MCc,te.Direction=sc.SKh,te.Duration=1E3,te.IsManualAdvance=!0,te),Pe.parent="TransitionCover",Pe.next="TransitionCoverFromBottomRight",Pe));let t,L;this.Rf.fa("TransitionCoverFromBottomRight",(L=
new Xb,L.yf=ResourceStrings.L_TransitionFromBottomRight,L.If=Zc.gg("TransitionCoverLeftUp"),L.Cf=(t=new kb,t.TransitionType=Rc.MCc,t.Direction=sc.QKh,t.Duration=1E3,t.IsManualAdvance=!0,t),L.parent="TransitionCover",L.next="TransitionCoverFromTopLeft",L));let S,ka;this.Rf.fa("TransitionCoverFromTopLeft",(ka=new Xb,ka.yf=ResourceStrings.L_TransitionFromTopLeft,ka.If=Zc.gg("TransitionCoverRightDown"),ka.Cf=(S=new kb,S.TransitionType=Rc.MCc,S.Direction=sc.RKh,S.Duration=1E3,S.IsManualAdvance=!0,S),ka.parent=
"TransitionCover",ka.next="TransitionCoverFromBottomLeft",ka));let ra,xb;this.Rf.fa("TransitionCoverFromBottomLeft",(xb=new Xb,xb.yf=ResourceStrings.L_TransitionFromBottomLeft,xb.If=Zc.gg("TransitionCoverRightUp"),xb.Cf=(ra=new kb,ra.TransitionType=Rc.MCc,ra.Direction=sc.PKh,ra.Duration=1E3,ra.IsManualAdvance=!0,ra),xb.parent="TransitionCover",xb))}if(!Array.contains(Ea,"uncover")){let Za,ia;this.Rf.fa("TransitionUncover",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionUncover,ia.If=Zc.gg("TransitionUncoverLeft"),
ia.Cf=(Za=new kb,Za.TransitionType=Rc.fed,Za.Direction=sc.rqb,Za.Duration=750,Za.IsManualAdvance=!0,Za),ia.parent="TransitionUncover",ia.next="TransitionUncoverFromRight",ia));let Va,Ab;this.Rf.fa("TransitionUncoverFromRight",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionFromRight,Ab.If=Zc.gg("TransitionUncoverLeft"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.fed,Va.Direction=sc.rqb,Va.Duration=750,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionUncover",Ab.next="TransitionUncoverFromTop",Ab));let gc,Hc;
this.Rf.fa("TransitionUncoverFromTop",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionFromTop,Hc.If=Zc.gg("TransitionUncoverDown"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.fed,gc.Direction=sc.AWe,gc.Duration=750,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionUncover",Hc.next="TransitionUncoverFromLeft",Hc));let fd,hd;this.Rf.fa("TransitionUncoverFromLeft",(hd=new Xb,hd.yf=ResourceStrings.L_TransitionFromLeft,hd.If=Zc.gg("TransitionUncoverRight"),hd.Cf=(fd=new kb,fd.TransitionType=Rc.fed,fd.Direction=sc.hHc,
fd.Duration=750,fd.IsManualAdvance=!0,fd),hd.parent="TransitionUncover",hd.next="TransitionUncoverFromBottom",hd));let yd,Md;this.Rf.fa("TransitionUncoverFromBottom",(Md=new Xb,Md.yf=ResourceStrings.L_TransitionFromBottom,Md.If=Zc.gg("TransitionUncoverUp"),Md.Cf=(yd=new kb,yd.TransitionType=Rc.fed,yd.Direction=sc.Xkd,yd.Duration=750,yd.IsManualAdvance=!0,yd),Md.parent="TransitionUncover",Md.next="TransitionUncoverFromTopRight",Md));this.Rf.fa("TransitionUncoverFromTopRight",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromTopRight,
If:Zc.gg("TransitionUncoverLeftDown"),Cf:Object.assign(new kb,{TransitionType:Rc.fed,Direction:sc.SKh,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomRight"}));this.Rf.fa("TransitionUncoverFromBottomRight",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromBottomRight,If:Zc.gg("TransitionUncoverLeftUp"),Cf:Object.assign(new kb,{TransitionType:Rc.fed,Direction:sc.QKh,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromTopLeft"}));
this.Rf.fa("TransitionUncoverFromTopLeft",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromTopLeft,If:Zc.gg("TransitionUncoverRightDown"),Cf:Object.assign(new kb,{TransitionType:Rc.fed,Direction:sc.RKh,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomLeft"}));this.Rf.fa("TransitionUncoverFromBottomLeft",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromBottomLeft,If:Zc.gg("TransitionUncoverRightUp"),Cf:Object.assign(new kb,{TransitionType:Rc.fed,
Direction:sc.PKh,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover"}))}if(!Array.contains(Ea,"menusectionexciting")){if(!Array.contains(Ea,"fallover")){this.Rf.fa("TransitionFallOver",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFallOver,If:Zc.gg("TransitionFallOverLeft"),Cf:Object.assign(new kb,{TransitionType:Rc.g7i,Direction:sc.none,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionFallOver",next:"TransitionFallOverLeft"}));let Za,ia;this.Rf.fa("TransitionFallOverLeft",(ia=
new Xb,ia.yf=ResourceStrings.L_TransitionGoLeft,ia.If=Zc.gg("TransitionFallOverLeft"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.g7i,Za.Direction=sc.none,Za.Duration=2E3,Za.IsManualAdvance=!0,Za),ia.parent="TransitionFallOver",ia.next="TransitionFallOverRight",ia));let Va,Ab;this.Rf.fa("TransitionFallOverRight",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionGoRight,Ab.If=Zc.gg("TransitionFallOverRight"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.g7i,Va.Direction=sc.Jmd,Va.Duration=2E3,Va.IsManualAdvance=!0,Va),
Ab.parent="TransitionFallOver",Ab))}if(!Array.contains(Ea,"drape")){let Za,ia;this.Rf.fa("TransitionDrape",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionDrape,ia.If=Zc.gg("TransitionDrapeLeft"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.g1i,Za.Direction=sc.none,Za.Duration=2E3,Za.IsManualAdvance=!0,Za),ia.parent="TransitionDrape",ia.next="TransitionDrapeLeft",ia));let Va,Ab;this.Rf.fa("TransitionDrapeLeft",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionGoLeft,Ab.If=Zc.gg("TransitionDrapeLeft"),Ab.Cf=(Va=
new kb,Va.TransitionType=Rc.g1i,Va.Direction=sc.none,Va.Duration=2E3,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionDrape",Ab.next="TransitionDrapeRight",Ab));let gc,Hc;this.Rf.fa("TransitionDrapeRight",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionGoRight,Hc.If=Zc.gg("TransitionDrapeRight"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.g1i,gc.Direction=sc.Jmd,gc.Duration=2E3,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionDrape",Hc))}if(!Array.contains(Ea,"curtains")){let Za,ia;this.Rf.fa("TransitionCurtains",
(ia=new Xb,ia.yf=ResourceStrings.L_TransitionCurtains,ia.If=Zc.gg("TransitionCurtains"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.F6m,Za.Direction=sc.none,Za.Duration=6E3,Za.IsManualAdvance=!0,Za),ia.parent="TransitionCurtains",ia))}if(!Array.contains(Ea,"wind")){let Za,ia;this.Rf.fa("TransitionWind",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionWind,ia.If=Zc.gg("TransitionWindRight"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.SEl,Za.Direction=sc.none,Za.Duration=2E3,Za.IsManualAdvance=!0,Za),ia.parent="TransitionWind",
ia.next="TransitionWindRight",ia));let Va,Ab;this.Rf.fa("TransitionWindRight",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionGoRight,Ab.If=Zc.gg("TransitionWindRight"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.SEl,Va.Direction=sc.none,Va.Duration=2E3,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionWind",Ab.next="TransitionWindLeft",Ab));let gc,Hc;this.Rf.fa("TransitionWindLeft",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionGoLeft,Hc.If=Zc.gg("TransitionWindLeft"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.SEl,
gc.Direction=sc.Jmd,gc.Duration=2E3,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionWind",Hc))}if(!Array.contains(Ea,"prestige")){let Za,ia;this.Rf.fa("TransitionPrestige",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionPrestige,ia.If=Zc.gg("TransitionPrestige"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.s1n,Za.Direction=sc.none,Za.Duration=2E3,Za.IsManualAdvance=!0,Za),ia.parent="TransitionPrestige",ia))}if(!Array.contains(Ea,"fracture")){let Za,ia;this.Rf.fa("TransitionFracture",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionFracture,
ia.If=Zc.gg("TransitionFracture"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.pcn,Za.Direction=sc.none,Za.Duration=2E3,Za.IsManualAdvance=!0,Za),ia.parent="TransitionFracture",ia))}if(!Array.contains(Ea,"crush")){let Za,ia;this.Rf.fa("TransitionCrush",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionCrush,ia.If=Zc.gg("TransitionCrush"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.y6m,Za.Direction=sc.none,Za.Duration=2E3,Za.IsManualAdvance=!0,Za),ia.parent="TransitionCrush",ia))}if(!Array.contains(Ea,"peeloff")){let Za,
ia;this.Rf.fa("TransitionPeelOff",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionPeelOff,ia.If=Zc.gg("TransitionPeelOffLeft"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.YEk,Za.Direction=sc.none,Za.Duration=1250,Za.IsManualAdvance=!0,Za),ia.parent="TransitionPeelOff",ia.next="TransitionPeelOffLeft",ia));let Va,Ab;this.Rf.fa("TransitionPeelOffLeft",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionGoLeft,Ab.If=Zc.gg("TransitionPeelOffLeft"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.YEk,Va.Direction=sc.none,Va.Duration=
1250,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionPeelOff",Ab.next="TransitionPeelOffRight",Ab));let gc,Hc;this.Rf.fa("TransitionPeelOffRight",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionGoRight,Hc.If=Zc.gg("TransitionPeelOffRight"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.YEk,gc.Direction=sc.Jmd,gc.Duration=1250,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionPeelOff",Hc))}if(!Array.contains(Ea,"pagecurl")){let Za,ia;this.Rf.fa("TransitionPageCurl",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionPageCurl,
ia.If=Zc.gg("TransitionTwoPageCurlFromRight"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.YCk,Za.Direction=sc.none,Za.Duration=1250,Za.IsManualAdvance=!0,Za),ia.parent="TransitionPageCurl",ia.next="TransitionPageCurlDoubleLeft",ia));let Va,Ab;this.Rf.fa("TransitionPageCurlDoubleLeft",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionEffectOptionDoubleLeft,Ab.If=Zc.gg("TransitionTwoPageCurlFromRight"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.YCk,Va.Direction=sc.none,Va.Duration=1250,Va.IsManualAdvance=!0,Va),Ab.parent=
"TransitionPageCurl",Ab.next="TransitionPageCurlDoubleRight",Ab));let gc,Hc;this.Rf.fa("TransitionPageCurlDoubleRight",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionEffectOptionDoubleRight,Hc.If=Zc.gg("TransitionTwoPageCurlFromLeft"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.YCk,gc.Direction=sc.Jmd,gc.Duration=1250,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionPageCurl",Hc.next="TransitionPageCurlSingleLeft",Hc));let fd,hd;this.Rf.fa("TransitionPageCurlSingleLeft",(hd=new Xb,hd.yf=ResourceStrings.L_TransitionEffectOptionSingleLeft,
hd.If=Zc.gg("TransitionPageCurlFromRight"),hd.Cf=(fd=new kb,fd.TransitionType=Rc.Gom,fd.Direction=sc.none,fd.Duration=1250,fd.IsManualAdvance=!0,fd),hd.parent="TransitionPageCurl",hd.next="TransitionPageCurlSingleRight",hd));let yd,Md;this.Rf.fa("TransitionPageCurlSingleRight",(Md=new Xb,Md.yf=ResourceStrings.L_TransitionEffectOptionSingleRight,Md.If=Zc.gg("TransitionPageCurlFromLeft"),Md.Cf=(yd=new kb,yd.TransitionType=Rc.Gom,yd.Direction=sc.Jmd,yd.Duration=1250,yd.IsManualAdvance=!0,yd),Md.parent=
"TransitionPageCurl",Md))}if(!Array.contains(Ea,"airplane")){let Za,ia;this.Rf.fa("TransitionAirplane",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionAirplane,ia.If=Zc.gg("TransitionAirplaneRight"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.Uvi,Za.Direction=sc.none,Za.Duration=1250,Za.IsManualAdvance=!0,Za),ia.parent="TransitionAirplane",ia.next="TransitionAirplaneRight",ia));let Va,Ab;this.Rf.fa("TransitionAirplaneRight",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionGoRight,Ab.If=Zc.gg("TransitionAirplaneRight"),
Ab.Cf=(Va=new kb,Va.TransitionType=Rc.Uvi,Va.Direction=sc.none,Va.Duration=1250,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionAirplane",Ab.next="TransitionAirplaneLeft",Ab));let gc,Hc;this.Rf.fa("TransitionAirplaneLeft",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionGoLeft,Hc.If=Zc.gg("TransitionAirplaneLeft"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.Uvi,gc.Direction=sc.Jmd,gc.Duration=1250,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionAirplane",Hc))}if(!Array.contains(Ea,"origami")){let Za,ia;this.Rf.fa("TransitionOrigami",
(ia=new Xb,ia.yf=ResourceStrings.L_TransitionOrigami,ia.If=Zc.gg("TransitionOrigamiRight"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.kCk,Za.Direction=sc.none,Za.Duration=3250,Za.IsManualAdvance=!0,Za),ia.parent="TransitionOrigami",ia.next="TransitionOrigamiRight",ia));let Va,Ab;this.Rf.fa("TransitionOrigamiRight",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionGoRight,Ab.If=Zc.gg("TransitionOrigamiRight"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.kCk,Va.Direction=sc.none,Va.Duration=3250,Va.IsManualAdvance=
!0,Va),Ab.parent="TransitionOrigami",Ab.next="TransitionOrigamiLeft",Ab));let gc,Hc;this.Rf.fa("TransitionOrigamiLeft",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionGoLeft,Hc.If=Zc.gg("TransitionOrigamiLeft"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.kCk,gc.Direction=sc.Jmd,gc.Duration=3250,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionOrigami",Hc))}Array.contains(Ea,"dissolve")||this.Rf.fa("TransitionDissolve",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionDissolve,If:Zc.gg("TransitionDissolve"),
Cf:Object.assign(new kb,{TransitionType:Rc.dissolve,Direction:sc.none,Duration:1200,IsManualAdvance:!0}),parent:"TransitionDissolve"}));Array.contains(Ea,"checker")||(this.Rf.fa("TransitionChecker",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionChecker,If:Zc.gg("TransitionCheckerboardAcross"),Cf:Object.assign(new kb,{TransitionType:Rc.checker,Direction:sc.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromLeft"})),this.Rf.fa("TransitionCheckerFromLeft",
Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromLeft,If:Zc.gg("TransitionCheckerboardAcross"),Cf:Object.assign(new kb,{TransitionType:Rc.checker,Direction:sc.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromTop"})),this.Rf.fa("TransitionCheckerFromTop",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromTop,If:Zc.gg("TransitionCheckerboardDown"),Cf:Object.assign(new kb,{TransitionType:Rc.checker,Direction:sc.Bnn,Duration:2500,IsManualAdvance:!0}),
parent:"TransitionChecker"})));if(!Array.contains(Ea,"blinds")){this.Rf.fa("TransitionBlinds",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionBlinds,If:Zc.gg("TransitionBlindsVertical"),Cf:Object.assign(new kb,{TransitionType:Rc.blinds,Direction:sc.mSl,Duration:1600,IsManualAdvance:!0}),parent:"TransitionBlinds",next:"TransitionBlindsVertical"}));let Za,ia;this.Rf.fa("TransitionBlindsVertical",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionVertical,ia.If=Zc.gg("TransitionBlindsVertical"),ia.Cf=
(Za=new kb,Za.TransitionType=Rc.blinds,Za.Direction=sc.mSl,Za.Duration=1600,Za.IsManualAdvance=!0,Za),ia.parent="TransitionBlinds",ia.next="TransitionBlindsHorizontal",ia));let Va,Ab;this.Rf.fa("TransitionBlindsHorizontal",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionHorizontal,Ab.If=Zc.gg("TransitionBlindsHorizontal"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.blinds,Va.Direction=sc.uYm,Va.Duration=1600,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionBlinds",Ab))}if(!Array.contains(Ea,"wheel")){let Za,
ia;this.Rf.fa("TransitionWheel",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionWheel,ia.If=Zc.gg("TransitionWheelClockwise1"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.wheel,Za.Direction=sc.wheel,Za.Duration=1E3,Za.IsManualAdvance=!0,Za),ia.parent="TransitionWheel",ia.next="TransitionWheelClockwise",ia));let Va,Ab;this.Rf.fa("TransitionWheelClockwise",(Ab=new Xb,Ab.yf=ResourceStrings.l_TransitionWheelClockWise,Ab.If=Zc.gg("TransitionWheelClockwise1"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.wheel,Va.Direction=
sc.wheel,Va.Duration=1E3,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionWheel",Ab.next="TransitionWheelCounterclockwise",Ab));let gc,Hc;this.Rf.fa("TransitionWheelCounterclockwise",(Hc=new Xb,Hc.yf=ResourceStrings.l_TransitionWheelCounterClockWise,Hc.If=Zc.gg("TransitionWheelCounterclockwise1"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.Xoo,gc.Direction=sc.wheel,gc.Duration=1E3,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionWheel",Hc.next="TransitionWheelWedge",Hc));let fd,hd;this.Rf.fa("TransitionWheelWedge",
(hd=new Xb,hd.yf=ResourceStrings.l_TransitionWheelWedge,hd.If=Zc.gg("TransitionWedge"),hd.Cf=(fd=new kb,fd.TransitionType=Rc.wedge,fd.Direction=sc.none,fd.Duration=1E3,fd.IsManualAdvance=!0,fd),hd.parent="TransitionWheel",hd))}if(!Array.contains(Ea,"ripple")){let Za,ia;this.Rf.fa("TransitionRipple",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionRipple,ia.If=Zc.gg("TransitionRipple"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.b5e,Za.Direction=sc.Yvm,Za.Duration=1400,Za.IsManualAdvance=!0,Za),ia.parent="TransitionRipple",
ia.next="TransitionRippleCenter",ia));let Va,Ab;this.Rf.fa("TransitionRippleCenter",(Ab=new Xb,Ab.yf=ResourceStrings.L_EffectOptionsDirectionCenter,Ab.If=Zc.gg("TransitionRipple"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.b5e,Va.Direction=sc.Yvm,Va.Duration=1400,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionRipple",Ab.next="TransitionRippleBottomLeft",Ab));let gc,Hc;this.Rf.fa("TransitionRippleBottomLeft",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionFromBottomLeft,Hc.If=Zc.gg("TransitionRippleBottomLeft"),
Hc.Cf=(gc=new kb,gc.TransitionType=Rc.b5e,gc.Direction=sc.PKh,gc.Duration=1500,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionRipple",Hc.next="TransitionRippleBottomRight",Hc));let fd,hd;this.Rf.fa("TransitionRippleBottomRight",(hd=new Xb,hd.yf=ResourceStrings.L_TransitionFromBottomRight,hd.If=Zc.gg("TransitionRippleBottomRight"),hd.Cf=(fd=new kb,fd.TransitionType=Rc.b5e,fd.Direction=sc.QKh,fd.Duration=1500,fd.IsManualAdvance=!0,fd),hd.parent="TransitionRipple",hd.next="TransitionRippleTopRight",
hd));let yd,Md;this.Rf.fa("TransitionRippleTopRight",(Md=new Xb,Md.yf=ResourceStrings.L_TransitionFromTopRight,Md.If=Zc.gg("TransitionRippleTopRight"),Md.Cf=(yd=new kb,yd.TransitionType=Rc.b5e,yd.Direction=sc.SKh,yd.Duration=1500,yd.IsManualAdvance=!0,yd),Md.parent="TransitionRipple",Md.next="TransitionRippleTopLeft",Md));let te,Pe;this.Rf.fa("TransitionRippleTopLeft",(Pe=new Xb,Pe.yf=ResourceStrings.L_TransitionFromTopLeft,Pe.If=Zc.gg("TransitionRippleTopLeft"),Pe.Cf=(te=new kb,te.TransitionType=
Rc.b5e,te.Direction=sc.RKh,te.Duration=1500,te.IsManualAdvance=!0,te),Pe.parent="TransitionRipple",Pe))}if(!Array.contains(Ea,"glitter")){let Za,ia;this.Rf.fa("TransitionGlitter",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionGlitter,ia.If=Zc.gg("TransitionGlitterHexagonLeft"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.DKc,Za.Direction=sc.d1l,Za.Duration=3900,Za.IsManualAdvance=!0,Za),ia.parent="TransitionGlitter",ia.next="TransitionGlitterHexagonLeft",ia));let Va,Ab;this.Rf.fa("TransitionGlitterHexagonLeft",
(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionHexagonsFromLeft,Ab.If=Zc.gg("TransitionGlitterHexagonLeft"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.DKc,Va.Direction=sc.d1l,Va.Duration=3900,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionGlitter",Ab.next="TransitionGlitterHexagonTop",Ab));let gc,Hc;this.Rf.fa("TransitionGlitterHexagonTop",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionHexagonsFromTop,Hc.If=Zc.gg("TransitionGlitterHexagonTop"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.DKc,gc.Direction=sc.Lcn,
gc.Duration=3900,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionGlitter",Hc.next="TransitionGlitterHexagonRight",Hc));let fd,hd;this.Rf.fa("TransitionGlitterHexagonRight",(hd=new Xb,hd.yf=ResourceStrings.L_TransitionHexagonsFromRight,hd.If=Zc.gg("TransitionGlitterHexagonRight"),hd.Cf=(fd=new kb,fd.TransitionType=Rc.DKc,fd.Direction=sc.Gcn,fd.Duration=3900,fd.IsManualAdvance=!0,fd),hd.parent="TransitionGlitter",hd.next="TransitionGlitterHexagonBottom",hd));let yd,Md;this.Rf.fa("TransitionGlitterHexagonBottom",
(Md=new Xb,Md.yf=ResourceStrings.L_TransitionHexagonsFromBottom,Md.If=Zc.gg("TransitionGlitterHexagonBottom"),Md.Cf=(yd=new kb,yd.TransitionType=Rc.DKc,yd.Direction=sc.xcn,yd.Duration=3900,yd.IsManualAdvance=!0,yd),Md.parent="TransitionGlitter",Md.next="TransitionGlitterDiamondLeft",Md));let te,Pe;this.Rf.fa("TransitionGlitterDiamondLeft",(Pe=new Xb,Pe.yf=ResourceStrings.L_TransitionDiamondsFromLeft,Pe.If=Zc.gg("TransitionGlitterDiamondLeft"),Pe.Cf=(te=new kb,te.TransitionType=Rc.DKc,te.Direction=
sc.Ccn,te.Duration=3900,te.IsManualAdvance=!0,te),Pe.parent="TransitionGlitter",Pe.next="TransitionGlitterDiamondTop",Pe));let t,L;this.Rf.fa("TransitionGlitterDiamondTop",(L=new Xb,L.yf=ResourceStrings.L_TransitionDiamondsFromTop,L.If=Zc.gg("TransitionGlitterDiamondTop"),L.Cf=(t=new kb,t.TransitionType=Rc.DKc,t.Direction=sc.Kcn,t.Duration=3900,t.IsManualAdvance=!0,t),L.parent="TransitionGlitter",L.next="TransitionGlitterDiamondRight",L));let S,ka;this.Rf.fa("TransitionGlitterDiamondRight",(ka=new Xb,
ka.yf=ResourceStrings.L_TransitionDiamondsFromRight,ka.If=Zc.gg("TransitionGlitterDiamondRight"),ka.Cf=(S=new kb,S.TransitionType=Rc.DKc,S.Direction=sc.Fcn,S.Duration=3900,S.IsManualAdvance=!0,S),ka.parent="TransitionGlitter",ka.next="TransitionGlitterDiamondBottom",ka));let ra,xb;this.Rf.fa("TransitionGlitterDiamondBottom",(xb=new Xb,xb.yf=ResourceStrings.L_TransitionDiamondsFromBottom,xb.If=Zc.gg("TransitionGlitterDiamondBottom"),xb.Cf=(ra=new kb,ra.TransitionType=Rc.DKc,ra.Direction=sc.wcn,ra.Duration=
3900,ra.IsManualAdvance=!0,ra),xb.parent="TransitionGlitter",xb))}if(!Array.contains(Ea,"vortex")){let Za,ia;this.Rf.fa("TransitionVortex",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionVortex,ia.If=Zc.gg("TransitionVortexFromLeft"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.MAh,Za.Direction=sc.hHc,Za.Duration=4E3,Za.IsManualAdvance=!0,Za),ia.parent="TransitionVortex",ia.next="TransitionVortexFromLeft",ia));let Va,Ab;this.Rf.fa("TransitionVortexFromLeft",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionFromLeft,
Ab.If=Zc.gg("TransitionVortexFromLeft"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.MAh,Va.Direction=sc.hHc,Va.Duration=4E3,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionVortex",Ab.next="TransitionVortexFromTop",Ab));let gc,Hc;this.Rf.fa("TransitionVortexFromTop",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionFromTop,Hc.If=Zc.gg("TransitionVortexFromTop"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.MAh,gc.Direction=sc.AWe,gc.Duration=4E3,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionVortex",Hc.next="TransitionVortexFromRight",
Hc));let fd,hd;this.Rf.fa("TransitionVortexFromRight",(hd=new Xb,hd.yf=ResourceStrings.L_TransitionFromRight,hd.If=Zc.gg("TransitionVortexFromRight"),hd.Cf=(fd=new kb,fd.TransitionType=Rc.MAh,fd.Direction=sc.rqb,fd.Duration=4E3,fd.IsManualAdvance=!0,fd),hd.parent="TransitionVortex",hd.next="TransitionVortexFromBottom",hd));let yd,Md;this.Rf.fa("TransitionVortexFromBottom",(Md=new Xb,Md.yf=ResourceStrings.L_TransitionFromBottom,Md.If=Zc.gg("TransitionVortexFromBottom"),Md.Cf=(yd=new kb,yd.TransitionType=
Rc.MAh,yd.Direction=sc.Xkd,yd.Duration=4E3,yd.IsManualAdvance=!0,yd),Md.parent="TransitionVortex",Md))}Array.contains(Ea,"switch")||(this.Rf.fa("TransitionSwitch",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionSwitch,If:Zc.gg("TransitionSwitchRight"),Cf:Object.assign(new kb,{TransitionType:Rc.Wol,Direction:sc.NMh,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchRight"})),this.Rf.fa("TransitionSwitchRight",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionGoRight,
If:Zc.gg("TransitionSwitchRight"),Cf:Object.assign(new kb,{TransitionType:Rc.Wol,Direction:sc.NMh,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchLeft"})),this.Rf.fa("TransitionSwitchLeft",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionGoLeft,If:Zc.gg("TransitionSwitchLeft"),Cf:Object.assign(new kb,{TransitionType:Rc.Wol,Direction:sc.none,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch"})));if(!Array.contains(Ea,"flip")){this.Rf.fa("TransitionFlip",
Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFlip,If:Zc.gg("TransitionFlipRight"),Cf:Object.assign(new kb,{TransitionType:Rc.flip,Direction:sc.NMh,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipRight"}));this.Rf.fa("TransitionFlipRight",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionGoRight,If:Zc.gg("TransitionFlipRight"),Cf:Object.assign(new kb,{TransitionType:Rc.flip,Direction:sc.NMh,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipLeft"}));
let Za,ia;this.Rf.fa("TransitionFlipLeft",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionGoLeft,ia.If=Zc.gg("TransitionFlipLeft"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.flip,Za.Direction=sc.none,Za.Duration=1250,Za.IsManualAdvance=!0,Za),ia.parent="TransitionFlip",ia))}if(!Array.contains(Ea,"galleryicon")){let Za,ia;this.Rf.fa("TransitionGalleryIcon",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionGallery,ia.If=Zc.gg("TransitionGalleryRight"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.zbj,Za.Direction=sc.rqb,
Za.Duration=1600,Za.IsManualAdvance=!0,Za),ia.parent="TransitionGalleryIcon",ia.next="TransitionGalleryIconFromRight",ia));let Va,Ab;this.Rf.fa("TransitionGalleryIconFromRight",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionFromRight,Ab.If=Zc.gg("TransitionGalleryRight"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.zbj,Va.Direction=sc.rqb,Va.Duration=1600,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionGalleryIcon",Ab.next="TransitionGalleryIconFromLeft",Ab));let gc,Hc;this.Rf.fa("TransitionGalleryIconFromLeft",
(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionFromLeft,Hc.If=Zc.gg("TransitionGalleryLeft"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.zbj,gc.Direction=sc.hHc,gc.Duration=1600,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionGalleryIcon",Hc))}if(!Array.contains(Ea,"cube")){let Za,ia;this.Rf.fa("TransitionCube",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionCube,ia.If=Zc.gg("TransitionCubeFromRight"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.jxa,Za.Direction=sc.f1l,Za.Duration=1200,Za.IsManualAdvance=!0,Za),ia.parent=
"TransitionCube",ia.next="TransitionCubeFromRight",ia));let Va,Ab;this.Rf.fa("TransitionCubeFromRight",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionFromRight,Ab.If=Zc.gg("TransitionCubeFromRight"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.jxa,Va.Direction=sc.f1l,Va.Duration=1200,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionCube",Ab.next="TransitionCubeFromBottom",Ab));let gc,Hc;this.Rf.fa("TransitionCubeFromBottom",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionFromBottom,Hc.If=Zc.gg("TransitionCubeFromBottom"),
Hc.Cf=(gc=new kb,gc.TransitionType=Rc.jxa,gc.Direction=sc.vcn,gc.Duration=1200,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionCube",Hc.next="TransitionCubeFromLeft",Hc));let fd,hd;this.Rf.fa("TransitionCubeFromLeft",(hd=new Xb,hd.yf=ResourceStrings.L_TransitionFromLeft,hd.If=Zc.gg("TransitionCubeFromLeft"),hd.Cf=(fd=new kb,fd.TransitionType=Rc.jxa,fd.Direction=sc.Bcn,fd.Duration=1200,fd.IsManualAdvance=!0,fd),hd.parent="TransitionCube",hd.next="TransitionCubeFromTop",hd));let yd,Md;this.Rf.fa("TransitionCubeFromTop",
(Md=new Xb,Md.yf=ResourceStrings.L_TransitionFromTop,Md.If=Zc.gg("TransitionCubeFromTop"),Md.Cf=(yd=new kb,yd.TransitionType=Rc.jxa,yd.Direction=sc.Jcn,yd.Duration=1200,yd.IsManualAdvance=!0,yd),Md.parent="TransitionCube",Md))}if(!Array.contains(Ea,"doors")){let Za,ia;this.Rf.fa("TransitionDoors",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionDoors,ia.If=Zc.gg("TransitionDoorsVertical"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.N0i,Za.Direction=sc.h2d,Za.Duration=1400,Za.IsManualAdvance=!0,Za),ia.parent=
"TransitionDoors",ia.next="TransitionDoorsVertical",ia));let Va,Ab;this.Rf.fa("TransitionDoorsVertical",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionVertical,Ab.If=Zc.gg("TransitionDoorsVertical"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.N0i,Va.Direction=sc.h2d,Va.Duration=1400,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionDoors",Ab.next="TransitionDoorsHorizontal",Ab));let gc,Hc;this.Rf.fa("TransitionDoorsHorizontal",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionHorizontal,Hc.If=Zc.gg("TransitionDoorsHorizontal"),
Hc.Cf=(gc=new kb,gc.TransitionType=Rc.N0i,gc.Direction=sc.MMh,gc.Duration=1400,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionDoors",Hc))}if(!Array.contains(Ea,"box")){let Za,ia;this.Rf.fa("TransitionBox",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionBox,ia.If=Zc.gg("TransitionBoxFromRight"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.jxa,Za.Direction=sc.e1l,Za.Duration=1600,Za.IsManualAdvance=!0,Za),ia.parent="TransitionBox",ia.next="TransitionBoxFromRight",ia));let Va,Ab;this.Rf.fa("TransitionBoxFromRight",
(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionFromRight,Ab.If=Zc.gg("TransitionBoxFromRight"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.jxa,Va.Direction=sc.e1l,Va.Duration=1600,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionBox",Ab.next="TransitionBoxFromBottom",Ab));let gc,Hc;this.Rf.fa("TransitionBoxFromBottom",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionFromBottom,Hc.If=Zc.gg("TransitionBoxFromBottom"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.jxa,gc.Direction=sc.ucn,gc.Duration=1600,gc.IsManualAdvance=
!0,gc),Hc.parent="TransitionBox",Hc.next="TransitionBoxFromLeft",Hc));let fd,hd;this.Rf.fa("TransitionBoxFromLeft",(hd=new Xb,hd.yf=ResourceStrings.L_TransitionFromLeft,hd.If=Zc.gg("TransitionBoxFromLeft"),hd.Cf=(fd=new kb,fd.TransitionType=Rc.jxa,fd.Direction=sc.Acn,fd.Duration=1600,fd.IsManualAdvance=!0,fd),hd.parent="TransitionBox",hd.next="TransitionBoxFromTop",hd));let yd,Md;this.Rf.fa("TransitionBoxFromTop",(Md=new Xb,Md.yf=ResourceStrings.L_TransitionFromTop,Md.If=Zc.gg("TransitionBoxFromTop"),
Md.Cf=(yd=new kb,yd.TransitionType=Rc.jxa,yd.Direction=sc.Icn,yd.Duration=1600,yd.IsManualAdvance=!0,yd),Md.parent="TransitionBox",Md))}if(!Array.contains(Ea,"comb")){let Za,ia;this.Rf.fa("TransitionComb",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionComb,ia.If=Zc.gg("TransitionCombHorizontal"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.GLi,Za.Direction=sc.none,Za.Duration=1E3,Za.IsManualAdvance=!0,Za),ia.parent="TransitionComb",ia.next="TransitionCombHorizontal",ia));let Va,Ab;this.Rf.fa("TransitionCombHorizontal",
(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionHorizontal,Ab.If=Zc.gg("TransitionCombHorizontal"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.GLi,Va.Direction=sc.MMh,Va.Duration=1E3,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionComb",Ab.next="TransitionCombVertical",Ab));let gc,Hc;this.Rf.fa("TransitionCombVertical",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionVertical,Hc.If=Zc.gg("TransitionCombVertical"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.GLi,gc.Direction=sc.h2d,gc.Duration=1E3,gc.IsManualAdvance=!0,
gc),Hc.parent="TransitionComb",Hc))}if(!Array.contains(Ea,"zoom")){let Za,ia;this.Rf.fa("TransitionZoom",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionZoom,ia.If=Zc.gg("TransitionZoomIn"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.zoom,Za.Direction=sc.b8f,Za.Duration=900,Za.IsManualAdvance=!0,Za),ia.parent="TransitionZoom",ia.next="TransitionZoomIn",ia));let Va,Ab;this.Rf.fa("TransitionZoomIn",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionIn,Ab.If=Zc.gg("TransitionZoomIn"),Ab.Cf=(Va=new kb,Va.TransitionType=
Rc.zoom,Va.Direction=sc.b8f,Va.Duration=900,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionZoom",Ab.next="TransitionZoomOut",Ab));let gc,Hc;this.Rf.fa("TransitionZoomOut",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionOut,Hc.If=Zc.gg("TransitionZoomOut"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.zoom,gc.Direction=sc.Svj,gc.Duration=900,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionZoom",Hc.next="TransitionZoomAndRotate",Hc));let fd,hd;this.Rf.fa("TransitionZoomAndRotate",(hd=new Xb,hd.yf=ResourceStrings.L_TransitionZoomAndRotate,
hd.If=Zc.gg("TransitionNewsFlash"),hd.Cf=(fd=new kb,fd.TransitionType=Rc.mpo,fd.Direction=sc.none,fd.Duration=1500,fd.IsManualAdvance=!0,fd),hd.parent="TransitionZoom",hd))}if(!Array.contains(Ea,"random")){let Za,ia;this.Rf.fa("TransitionRandom",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionRandom,ia.If=Zc.gg("TransitionRandom"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.random,Za.Direction=sc.Inn,Za.Duration=1500,Za.IsManualAdvance=!0,Za),ia.parent="TransitionRandom",ia))}}if(!Array.contains(Ea,"menusectiondynamiccontent")){if(!Array.contains(Ea,
"pan")){let Za,ia;this.Rf.fa("TransitionPan",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionPan,ia.If=Zc.gg("TransitionPanFromBottom"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.pan,Za.Direction=sc.Xkd,Za.Duration=1300,Za.IsManualAdvance=!0,Za),ia.parent="TransitionPan",ia.next="TransitionPanFromBottom",ia));this.Rf.fa("TransitionPanFromBottom",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromBottom,If:Zc.gg("TransitionPanFromBottom"),Cf:Object.assign(new kb,{TransitionType:Rc.pan,Direction:sc.Xkd,
Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromLeft"}));this.Rf.fa("TransitionPanFromLeft",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromLeft,If:Zc.gg("TransitionPanFromLeft"),Cf:Object.assign(new kb,{TransitionType:Rc.pan,Direction:sc.hHc,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromRight"}));this.Rf.fa("TransitionPanFromRight",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromRight,If:Zc.gg("TransitionPanFromRight"),
Cf:Object.assign(new kb,{TransitionType:Rc.pan,Direction:sc.rqb,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromTop"}));this.Rf.fa("TransitionPanFromTop",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionFromTop,If:Zc.gg("TransitionPanFromTop"),Cf:Object.assign(new kb,{TransitionType:Rc.pan,Direction:sc.AWe,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan"}))}if(!Array.contains(Ea,"conveyor")){this.Rf.fa("TransitionConveyor",Object.assign(new Xb,{yf:ResourceStrings.L_TransitionConveyor,
If:Zc.gg("TransitionConveyorRight"),Cf:Object.assign(new kb,{TransitionType:Rc.aQi,Direction:sc.rqb,Duration:1600,IsManualAdvance:!0}),parent:"TransitionConveyor",next:"TransitionConveyorFromRight"}));let Za,ia;this.Rf.fa("TransitionConveyorFromRight",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionFromRight,ia.If=Zc.gg("TransitionConveyorRight"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.aQi,Za.Direction=sc.rqb,Za.Duration=1600,Za.IsManualAdvance=!0,Za),ia.parent="TransitionConveyor",ia.next="TransitionConveyorFromLeft",
ia));let Va,Ab;this.Rf.fa("TransitionConveyorFromLeft",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionFromLeft,Ab.If=Zc.gg("TransitionConveyorLeft"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.aQi,Va.Direction=sc.hHc,Va.Duration=1600,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionConveyor",Ab))}if(!Array.contains(Ea,"rotate")){let Za,ia;this.Rf.fa("TransitionRotate",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionRotate,ia.If=Zc.gg("TransitionRotateLeft"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.jxa,Za.Direction=
sc.h1l,Za.Duration=2E3,Za.IsManualAdvance=!0,Za),ia.parent="TransitionRotate",ia.next="TransitionRotateFromRight",ia));let Va,Ab;this.Rf.fa("TransitionRotateFromRight",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionFromRight,Ab.If=Zc.gg("TransitionRotateLeft"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.jxa,Va.Direction=sc.h1l,Va.Duration=2E3,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionRotate",Ab.next="TransitionRotateFromBottom",Ab));let gc,Hc;this.Rf.fa("TransitionRotateFromBottom",(Hc=new Xb,Hc.yf=
ResourceStrings.L_TransitionFromBottom,Hc.If=Zc.gg("TransitionRotateTop"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.jxa,gc.Direction=sc.zcn,gc.Duration=2E3,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionRotate",Hc.next="TransitionRotateFromLeft",Hc));let fd,hd;this.Rf.fa("TransitionRotateFromLeft",(hd=new Xb,hd.yf=ResourceStrings.L_TransitionFromLeft,hd.If=Zc.gg("TransitionRotateRight"),hd.Cf=(fd=new kb,fd.TransitionType=Rc.jxa,fd.Direction=sc.Ecn,fd.Duration=2E3,fd.IsManualAdvance=!0,fd),hd.parent="TransitionRotate",
hd.next="TransitionRotateFromTop",hd));let yd,Md;this.Rf.fa("TransitionRotateFromTop",(Md=new Xb,Md.yf=ResourceStrings.L_TransitionFromTop,Md.If=Zc.gg("TransitionRotateBottom"),Md.Cf=(yd=new kb,yd.TransitionType=Rc.jxa,yd.Direction=sc.Ncn,yd.Duration=2E3,yd.IsManualAdvance=!0,yd),Md.parent="TransitionRotate",Md))}if(!Array.contains(Ea,"window")){let Za,ia;this.Rf.fa("TransitionWindow",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionWindow,ia.If=Zc.gg("TransitionWindowVertical"),ia.Cf=(Za=new kb,Za.TransitionType=
Rc.window,Za.Direction=sc.h2d,Za.Duration=1500,Za.IsManualAdvance=!0,Za),ia.parent="TransitionWindow",ia.next="TransitionWindowVertical",ia));let Va,Ab;this.Rf.fa("TransitionWindowVertical",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionVertical,Ab.If=Zc.gg("TransitionWindowVertical"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.window,Va.Direction=sc.h2d,Va.Duration=1500,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionWindow",Ab.next="TransitionWindowHorizontal",Ab));let gc,Hc;this.Rf.fa("TransitionWindowHorizontal",
(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionHorizontal,Hc.If=Zc.gg("TransitionWindowHorizontal"),Hc.Cf=(gc=new kb,gc.TransitionType=Rc.window,gc.Direction=sc.MMh,gc.Duration=1500,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionWindow",Hc))}if(!Array.contains(Ea,"orbit")){let Za,ia;this.Rf.fa("TransitionOrbit",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionOrbit,ia.If=Zc.gg("TransitionOrbitFromRight"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.jxa,Za.Direction=sc.g1l,Za.Duration=1600,Za.IsManualAdvance=!0,
Za),ia.parent="TransitionOrbit",ia.next="TransitionOrbitFromRight",ia));let Va,Ab;this.Rf.fa("TransitionOrbitFromRight",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionFromRight,Ab.If=Zc.gg("TransitionOrbitFromRight"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.jxa,Va.Direction=sc.g1l,Va.Duration=1600,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionOrbit",Ab.next="TransitionOrbitFromBottom",Ab));let gc,Hc;this.Rf.fa("TransitionOrbitFromBottom",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionFromBottom,Hc.If=Zc.gg("TransitionOrbitFromBottom"),
Hc.Cf=(gc=new kb,gc.TransitionType=Rc.jxa,gc.Direction=sc.ycn,gc.Duration=1600,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionOrbit",Hc.next="TransitionOrbitFromLeft",Hc));let fd,hd;this.Rf.fa("TransitionOrbitFromLeft",(hd=new Xb,hd.yf=ResourceStrings.L_TransitionFromLeft,hd.If=Zc.gg("TransitionOrbitFromLeft"),hd.Cf=(fd=new kb,fd.TransitionType=Rc.jxa,fd.Direction=sc.Dcn,fd.Duration=1600,fd.IsManualAdvance=!0,fd),hd.parent="TransitionOrbit",hd.next="TransitionOrbitFromTop",hd));let yd,Md;this.Rf.fa("TransitionOrbitFromTop",
(Md=new Xb,Md.yf=ResourceStrings.L_TransitionFromTop,Md.If=Zc.gg("TransitionOrbitFromTop"),Md.Cf=(yd=new kb,yd.TransitionType=Rc.jxa,yd.Direction=sc.Mcn,yd.Duration=1600,yd.IsManualAdvance=!0,yd),Md.parent="TransitionOrbit",Md))}if(!Array.contains(Ea,"flythrough")){let Za,ia;this.Rf.fa("TransitionFlyThrough",(ia=new Xb,ia.yf=ResourceStrings.L_TransitionFlyThrough,ia.If=Zc.gg("TransitionFlyThroughIn"),ia.Cf=(Za=new kb,Za.TransitionType=Rc.uXf,Za.Direction=sc.b8f,Za.Duration=800,Za.IsManualAdvance=
!0,Za),ia.parent="TransitionFlyThrough",ia.next="TransitionFlyThroughIn",ia));let Va,Ab;this.Rf.fa("TransitionFlyThroughIn",(Ab=new Xb,Ab.yf=ResourceStrings.L_TransitionIn,Ab.If=Zc.gg("TransitionFlyThroughIn"),Ab.Cf=(Va=new kb,Va.TransitionType=Rc.uXf,Va.Direction=sc.b8f,Va.Duration=800,Va.IsManualAdvance=!0,Va),Ab.parent="TransitionFlyThrough",Ab.next="TransitionFlyThroughOut",Ab));let gc,Hc;this.Rf.fa("TransitionFlyThroughOut",(Hc=new Xb,Hc.yf=ResourceStrings.L_TransitionOut,Hc.If=Zc.gg("TransitionFlyThroughOut"),
Hc.Cf=(gc=new kb,gc.TransitionType=Rc.uXf,gc.Direction=sc.Svj,gc.Duration=800,gc.IsManualAdvance=!0,gc),Hc.parent="TransitionFlyThrough",Hc.next="TransitionFlyThroughInWithBounce",Hc));let fd,hd;this.Rf.fa("TransitionFlyThroughInWithBounce",(hd=new Xb,hd.yf=ResourceStrings.L_TransitionInWithBounce,hd.If=Zc.gg("TransitionFlyThroughIn"),hd.Cf=(fd=new kb,fd.TransitionType=Rc.uXf,fd.Direction=sc.Zbn,fd.Duration=900,fd.IsManualAdvance=!0,fd),hd.parent="TransitionFlyThrough",hd.next="TransitionFlyThroughOutWithBounce",
hd));let yd,Md;this.Rf.fa("TransitionFlyThroughOutWithBounce",(Md=new Xb,Md.yf=ResourceStrings.L_TransitionOutWithBounce,Md.If=Zc.gg("TransitionFlyThroughOut"),Md.Cf=(yd=new kb,yd.TransitionType=Rc.uXf,yd.Direction=sc.$bn,yd.Duration=900,yd.IsManualAdvance=!0,yd),Md.parent="TransitionFlyThrough",Md))}}this.Rf.forEach((Za,ia)=>{Za===ia.parent&&++V;return!0})}Sld(ja){let qb=null;ja?this.Rf.forEach((V,Ea)=>{Ea.Cf&&Ea.Cf.TransitionType===ja.TransitionType&&Ea.Cf.Direction===ja.Direction&&(qb=V);return!0}):
qb="TransitionNone";return qb}wIa(ja){return this.Rf.ka(ja)}xXe(ja){return(ja=this.Sld(ja))?this.Rf.ka(this.Rf.ka(ja).parent):null}Tld(ja){return(ja=this.Sld(ja))?this.Rf.ka(ja).parent:null}x3l(ja){let qb,V=null;qb=null;ja&&ja.next&&(qb=ja.next,V=this.wIa(qb));return{returnValue:V,key:qb}}WWe(){var ja=[Zc.Ucn,Zc.p3n,Zc.q3n];for(const qb of ja)if(ja=document.getElementById(qb))return ja;return null}jPh(ja,qb){return ja&&qb&&qb.childNodes?ja.startsWith(Zc.Vcn)?qb.contains(document.getElementById(this.bGn?
ja+"-PreviewButton":ja)):!1:!qb&&ja?"TransitionExisting"===ja||"TransitionNone"===ja||"TransitionMorph"===ja||"TransitionCut"===ja||"TransitionFade"===ja||"TransitionPush"===ja||"TransitionWipe"===ja:!1}static gg(ja){return Od.a.Pwe+"_"+ja+"_32x32x32"}}Zc.Ucn="PptRibbon.Transition.Gallery-MaxSize-1-0";Zc.p3n="Transitions";Zc.q3n="Transitions-previewWrapper";Zc.Vcn="Transition";Object(m.a)(Zc,"TransitionHelper",null,[721]);var Id=a(235),Td=a(90),he=a(1767),be=a(1201),Ue=a(815),cf=a(814);class mf{constructor(ja,
qb,V,Ea,Za,ia){this.f2h=(Va,Ab,gc,Hc,fd)=>{if(1===gc)return 32;if(!fd)return Pc.a.$(508045068,822,10,"PictureEffectActor::updatePictureEffects actionData is null"),16;Ab=this.rb.zd();if(1!=(null===Ab||void 0===Ab?void 0:Ab.length))return 16;Ab=Ab[0];Hc=new be.a(Ab.DT.brightness,Ab.DT.contrast,Ab.DT.saturation,Ab.DT.transparency);if(2===gc){gc=fd.Number;fd=fd.IsChanged;switch(Va){case Yc.a.N7e:Hc.Rxm(gc);break;case Yc.a.P7e:Hc.Wxm(gc);break;case Yc.a.X7e:Hc.Jym(gc);break;case Yc.a.b8e:Hc.yLb(gc)}if(this.na.nHc){const hd=
{};hd.value=gc;this.Ryj(Ab,Va,hd)}this.na.nHc||(Ab.DT=Hc,this.na.pXd&&this.cPe(Ab));!fd&&this.na.pXd||this.N$m(Hc,Ab,Va)}return 32};this.umo=(Va,Ab,gc,Hc,fd)=>{if(1===gc)return 32;if(!fd)return Pc.a.$(508045067,822,10,"PictureEffectActor::updatePictureReflectionEffects actionData is null"),16;Ab=this.rb.zd();if(1!=(null===Ab||void 0===Ab?void 0:Ab.length))return 16;Ab=Ab[0];Hc=new Ue.a(Ab.Dr.transparency,Ab.Dr.size,Ab.Dr.blur,Ab.Dr.distance,Ab.Dr.hasReflection);if(2===gc){gc=fd.IsChanged;if(fd.hasOwnProperty("effectType")&&
1===fd.effectType){var hd=fd[15];const yd=fd[16],Md=fd[17],te=fd[18];Hc.QZh(fd[19]);Hc.yLb(hd);Hc.f$c(Md);Hc.zh(yd);Hc.m$c(te)}this.na.Fia?(fd={},hd={},hd.startAlpha=Hc.transparency,hd.radius=Hc.blur,hd.endPosition=Hc.size,hd.distance=Hc.distance,fd.reflection=hd,this.Ryj(Ab,Va,fd)):(Ab.Dr=Hc,this.cPe(Ab));gc&&this.O$m(Hc,Ab,Va)}return 32};this.vmo=(Va,Ab,gc,Hc,fd)=>{if(1===gc)return 32;if(!fd)return Pc.a.$(508045066,822,10,"PictureEffectActor::updatePictureShadowEffects actionData is null"),16;Ab=
this.rb.zd();if(1!=(null===Ab||void 0===Ab?void 0:Ab.length))return 16;Ab=Ab[0];Hc=new cf.a(Ab.wm.color,Ab.wm.transparency,Ab.wm.size,Ab.wm.blur,Ab.wm.angle,Ab.wm.distance,Ab.wm.hasShadow,Ab.wm.colorInfo);if(2===gc){gc=fd.IsChanged;if(fd.hasOwnProperty("effectType")&&0===fd.effectType){var hd=fd[8],yd=fd[9];const Md=fd[10],te=fd[11],Pe=fd[12],t=fd[13],L=fd[20];Hc.YZh(fd[14]);Hc.setColor(hd);Hc.yLb(yd);Hc.zh(Md);Hc.f$c(te);Hc.rZh(Pe);Hc.m$c(t);Hc.vZh(L)}this.na.Fia?(fd={},hd={},yd={},yd.r=Hc.color[0],
yd.g=Hc.color[1],yd.b=Hc.color[2],yd.a=(100-Hc.transparency)/100,hd.color=yd,hd.radius=Hc.blur,hd.angle=Hc.angle,hd.distance=Hc.distance,fd.shadow=hd,this.Ryj(Ab,Va,fd)):(Ab.wm=Hc,this.cPe(Ab));gc&&this.P$m(Hc,Ab,Va)}return 32};if(!ja)throw Error.argumentNull("actionManager");if(!qb)throw Error.argumentNull("selectionManager");if(!V)throw Error.argumentNull("pageView");if(!Ea)throw Error.argumentNull("focusManager");if(!Za)throw Error.argumentNull("transactionFactory");if(!ia)throw Error.argumentNull("appSettings");
this.la=ja;this.rb=qb;this.zb=V;this.Na=Ea;this.Tb=Za;this.na=ia}Kb(){this.la.ua(Yc.a.N7e,ad.a.application,this.f2h,4);this.la.ua(Yc.a.P7e,ad.a.application,this.f2h,4);this.la.ua(Yc.a.X7e,ad.a.application,this.f2h,4);this.la.ua(Yc.a.b8e,ad.a.application,this.f2h,4);this.la.ua(Yc.a.wlh,ad.a.application,this.vmo,4);this.la.ua(Yc.a.kah,ad.a.application,this.umo,4)}Ae(){}Ryj(ja,qb,V){if(V&&(Pc.a.$(507585422,822,50,"PictureEffectActor::handleGC2PictureEffects Update Picture Effects using GC2 Undo Fix"),
(ja=this.Qk(ja))&&ja.Ci&&(ja=ja.Ci)))switch(qb){case Yc.a.N7e:ja.t9("ChangePictureBrightness",V);break;case Yc.a.P7e:ja.t9("ChangePictureContrast",V);break;case Yc.a.X7e:ja.t9("ChangePictureSaturation",V);break;case Yc.a.b8e:ja.t9("ChangePictureTransparency",V);break;case Yc.a.wlh:ja.t9("ChangeEffects",V);break;case Yc.a.kah:ja.t9("ChangeEffects",V)}}cPe(ja){var qb;null===(qb=this.Qk(ja).Ci)||void 0===qb?void 0:qb.handleShapeNodeGC2ModelSync()}Qk(ja){return null===ja||void 0===ja?void 0:ja.yc(this.zb.Ua)}N$m(ja,
qb,V){const Ea=this.Tb.Kd(15,void 0,()=>{this.rb.lk()});try{Ea.tc(qb),Ea.wc=V,this.na.nHc&&(qb.DT=ja)}finally{null===Ea||void 0===Ea?void 0:Ea.dispose()}}P$m(ja,qb,V){const Ea=this.Tb.Kd(15,void 0,()=>{this.rb.lk()});try{Ea.tc(qb),Ea.wc=V,this.na.Fia&&(qb.wm=ja)}finally{null===Ea||void 0===Ea?void 0:Ea.dispose()}}O$m(ja,qb,V){const Ea=this.Tb.Kd(15,void 0,()=>{this.rb.lk()});try{Ea.tc(qb),Ea.wc=V,this.na.Fia&&(qb.Dr=ja)}finally{null===Ea||void 0===Ea?void 0:Ea.dispose()}}}Object(m.a)(mf,"PictureEffectsActor",
null,[502]);class ig{constructor(ja,qb,V,Ea,Za,ia){this.wid=(Va,Ab,gc,Hc,fd)=>{var hd=(Va=null===(hd=this.ya.Ia)||void 0===hd?void 0:hd.fc)?this.Xb.pl(Va):void 0;if(3!=this.la.mode)return 8;if(oe.a("DisablePreviewInSvgMode")&&this.Ina.$wa){var yd=[appChrome.actions.updateControlHiddenState("AnimationPreview",!0)];appChrome.api.dispatch(yd);Pc.a.$(507884371,822,50,"PreviewActor: hide animationPreview buttons in svg mode");return 2}if(1===gc)return(null===hd||void 0===hd?0:hd.KBa)?32:8;if(null===hd||
void 0===hd||!hd.KBa)return 8;gc=null!==(yd=null===fd||void 0===fd?void 0:fd.t1n)&&void 0!==yd?yd:bc.a.create().toString();Pc.a.$(508065501,822,50,"PreviewActor: animationPreview function is called [previewId: {0}]",gc);this.y0e.QLk(hd.sid,hd.Dh,gc,null===hd||void 0===hd?void 0:hd.pPa);return 32};this.Skc=(Va,Ab,gc)=>{if(1===gc)return this.y0e.fle?32:8;Pc.a.$(508065500,822,50,"PreviewActor: exitAnimationPreview function is called");this.y0e.HJh();return 32};this.A7e=(Va,Ab,gc)=>{var Hc=(Va=null===
(Hc=this.ya.Ia)||void 0===Hc?void 0:Hc.fc)?this.Xb.pl(Va):null;Va=(null===Hc||void 0===Hc?0:Hc.pPa)?this.ekn(Va):null;if(3!=this.la.mode)return 8;if(oe.a("DisablePreviewInSvgMode")&&this.Ina.$wa)return gc=[appChrome.actions.updateControlHiddenState("TransitionPreview",!0)],appChrome.api.dispatch(gc),Pc.a.$(507884370,822,50,"PreviewActor: hide transitionPreview buttons in svg mode"),2;if(1===gc)return(null===Hc||void 0===Hc?0:Hc.pPa)&&Va?32:8;if(!Va)return 8;gc=bc.a.create().toString();Pc.a.$(508065503,
822,50,"PreviewActor: transitionPreview function is called [previewId: {0}]",gc);this.y0e.XLk(Va.sid,Va.Dh,Hc.sid,Hc.Dh,gc);return 32};this.gWe=(Va,Ab,gc)=>{if(1===gc)return this.y0e.fle?32:8;Pc.a.$(508065502,822,50,"PreviewActor: exitTransitionPreview function is called");this.y0e.HJh();return 32};if(!ja)throw Error.argumentNull("actionManager");if(!qb)throw Error.argumentNull("previewManager");if(!V)throw Error.argumentNull("graphTopologyManager");if(!Ea)throw Error.argumentNull("presReader");if(!ia)throw Error.argumentNull("slideShowCoreHelper");
this.la=ja;this.y0e=qb;this.ya=V;this.Xb=Ea;this.Ble=Za;this.Ina=ia}Ae(){}Kb(){this.la.Ba(Yc.a.wid,ad.a.view,this.wid);this.la.ua(Yc.a.Skc,ad.a.view,this.Skc,2052);this.Ble&&(this.la.Ba(Yc.a.A7e,ad.a.view,this.A7e),this.la.ua(Yc.a.gWe,ad.a.view,this.gWe,2052))}ekn(ja){let qb=null;for(const V of this.Xb.rOa()){if(V.sid==ja.sid&&V.cid==ja.cid)return qb;V.Kl||(qb=V)}return null}}Object(m.a)(ig,"PreviewActor",null,[502]);class ug{constructor(){this.vn=this.ga=null}get name(){return"PowerPointWebEditor.Advanced"}oc(ja){this.ga=
ja;this.vn=this.ga.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder").GIb(0,this.name);this.ga.register(688,"PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers").oa().pa(()=>new Wg(this.ga.resolve("Common.IActionManagerExtended")));if(this.ga.resolve("PowerPointWebEditor.IApplicationSettings").JP){const qb=Id.a(this.ga);this.ga.register(689,"PowerPointWebEditor.IAudioManagerStore").oa().pa(()=>new Qd);this.ga.register(690,"PowerPointWebEditor.IAudioLibraryCallbackFactory").oa().pa(()=>
new lc(this.ga.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("Common.IActionManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").JP,this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.ga.eb("PowerPointWebEditor.IAudioManagerStore")));this.ga.register(691,"PowerPointWebEditor.IAudioManagerFactory").oa().pa(()=>new md(this.ga.resolve("PowerPointWebEditor.IAudioLibraryCallbackFactory"),qb,
this.ga.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.ga.resolve("PowerPointWebEditor.IAudioManagerFactory");this.ga.resolve("PowerPointWebEditor.IAudioManagerStore")}}init(){let ja=this.vn.CJ("resolve");var qb=this.ga.resolve("Common.AFrameworkApplication");const V=this.ga.resolve("PowerPointWebEditor.IApplicationContext"),Ea=V.Pd;qb=qb.Bj;const Za=this.ga.resolve("Common.IActionManagerExtended"),ia=this.ga.resolve("PowerPointWebEditor.IFocusManager");
qb=qb.Sd;const Va=this.ga.resolve("Common.Transaction.ITransactionFactory"),Ab=this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),gc=this.ga.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Hc=this.ga.resolve("PowerPointWebEditor.PictureContext"),fd=this.ga.resolve("PowerPoint.IPathManager");var hd=this.ga.resolve("PowerPointWebEditor.IPresentationReader");const yd=this.ga.resolve("PowerPointWebEditor.IShapeReader"),Md=this.ga.resolve("PowerPointWebEditor.IPictureUploader"),
te=this.ga.he("PowerPointWebEditor.IPPTLanguageDialogFactory"),Pe=this.ga.resolve("Box4.IParagraphReader");this.vn.FJ(ja);ja=this.vn.CJ("regactors");hd=[new mh(Za,Ab,this.ga.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),this.ga.resolve("Box4.IParagraphIndentationReader"),this.ga.resolve("Common.Transaction.ITransactionFactory"),Pe,this.ga.resolve("PowerPointWebEditor.IPPTParagraphReader"),yd,this.ga.resolve("PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers"),ha.App.JLb.Hjd(12),
Ea.h7e),new Hd(Za,ia,gc,Va,Ab,fd,qb,this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),hd,new wd,Ea.JOh,this.ga.resolve("Common.IAppSettingsManager").getBooleanAppSetting("ChangingThemeSelectedSlidesEnabled"),this.ga.resolve("Common.IAppSettingsManager").getBooleanAppSetting("EnableDefaultThemeRefresh"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings")),new Wd(Za,qb,this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Va,Ab,ia,new Zc(Ea.eWa,null===Ea||void 0===
Ea?void 0:Ea.getBooleanAppSetting("AppGalleryPreviewButtonIdIsEnabled")),gc,Ea,fd,this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"))];Ea.pTb?hd.push(new Wb(Za,Ab,ia,Va,new Hb(Ea.HAf),gc,yd,fd,this.ga.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.ga.resolve("Box4.Graph.IGraphInstance").Xd(8),this.ga.resolve("PowerPointWebEditor.View.IViewEventSource"),this.ga.resolve("PowerPointWebEditor.ISlideReader"),
this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.IRibbonUser"),Ea.Rhd,this.ga.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),Ea.isAnimationPreviewEnabled?this.ga.resolve("PowerPointWebEditor.IPreviewFrame"):null,Ea.isAnimationPreviewEnabled?this.ga.resolve("PowerPointWebEditor.AnimationPreviewToast"):null,this.ga.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),Ea.mom,
Ea.isAnimationPreviewEnabled?this.ga.resolve("PowerPointWebEditor.ISlideShowCoreHelper"):null)):hd.push(new Ad(Za,this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ab,ia,Va,new Hb(Ea.HAf),gc,this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),yd,fd));Ea.Zqd&&hd.push(new Ne(Za,ia,gc,Ab,Va,qb,this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Md,Hc,n.AFrameworkApplication.WS,this.ga.resolve("PowerPointWebEditor.IErrorHandler"),Ea));Ea.nzc&&hd.push(new mf(Za,
Ab,this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("Common.Transaction.ITransactionFactory"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings")));Ea.uIb&&n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Pictures.PictureBGREnabled",!1)&&hd.push(new he.a(Za,this.ga.resolve("PowerPointWebEditor.Core.IAppOfflineSetter"),Ab,this.ga.resolve("PowerPointWebEditor.Image.IImageManager"),
this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("Common.Transaction.ITransactionFactory"),this.ga.resolve("PowerPointWebEditor.IRibbonChangeManager"),this.ga.resolve("PowerPointWebEditor.IImageIdHelper"),this.ga.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")));Ea.isAnimationPreviewEnabled&&hd.push(new ig(Za,this.ga.resolve("PowerPointWebEditor.IPreviewManager"),
this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"),Ea.kPh,this.ga.resolve("PowerPointWebEditor.ISlideShowCoreHelper")));for(const t of hd)t.Kb(),t.Ae();this.vn.FJ(ja);n.AFrameworkApplication.ha.Wf(()=>{ja=this.vn.CJ("regfullactors");const t=[],L=this.ga.resolve("Box4.Proofing.IProofingFeatureConfiguration");L.Cgb=this.ga.resolve("Common.IAppSettingsManager").getBooleanAppSetting(Td.a.ABb);V.Pd.JKb&&t.push(new tc(Za,te,L,this.ga.resolve("Common.Transaction.ITransactionFactory"),
this.ga.eb("Box4.Proofing.ICritiqueTypeSettings"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.IShapeReader"),this.ga.resolve("Box4.ILanguageReader"),this.ga.resolve("Box4.Proofing.IErrorRangeEditor"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("Box4.IProofingManager"),Ab));this.ga.resolve("PowerPointWebEditor.IApplicationSettings").Hlc&&t.push(new le(Za,ia,Ab,Id.a(this.ga),this.ga.resolve("Common.IAppSettingsManager")));
for(const S of t)S.Kb(),S.Ae();L.Cgb&&(new Le(Za,this.ga.resolve("Box4.Proofing.ICritiqueTypeSettings"),(S,ka)=>new Pb(S,this.ga.resolve("Box4.Proofing.IProofingConfigV2Manager"),ka,this.ga.resolve("Common.IFocusManager")),this.ga.resolve("Box4.Proofing.IProofingConfigV2Manager"),Ab,this.ga.resolve("Box4.ILanguageReader"),yd)).Kb();this.vn.FJ(ja)})}dispose(){}}Object(m.a)(ug,"AdvancedPackage",null,[4,5]);class Pf{get container(){return k.a.instance.resolve("PowerPointWebEditor.IRibbonPane").va}}Object(m.a)(Pf,
"PPTFloatPaneContainer",null,[666]);class mg{constructor(ja,qb,V=null){this.uqe=new gg.a(0);this.Jqd=null;this.exe=this.Jqd=ha.App.Qp;this.nck=ja;this.Fim=1E3*qb;this.Kem=V||(()=>(new Date).getTime())}rYm(ja){this.nck&&this.uqe.add(ja,(new Date).getTime())}RZl(ja){this.nck&&(this.uqe.remove(ja),this.rjo(this.Kem()-this.Fim))}rjo(ja){if(this.uqe.count){var qb=[];this.uqe.forEach((V,Ea)=>{Ea<ja&&qb.push(V);return!0});for(const V of qb)this.uqe.remove(V)}}get K9l(){return this.exe<=this.Jqd}F6l(){if(!this.nck||
!this.uqe.count)return!1;let ja=!1;const qb=this.Kem();this.uqe.forEach((V,Ea)=>qb-Ea<this.Fim?(ja=!0,!1):!0);return ja}}Object(m.a)(mg,"PictureContext",null,[682]);var Lf=a(1214),Nd=a(811);class ih{constructor(){this.LJb=this.khk=this.hgm=this.igm=!1;this.vn=this.ohb=this.t0e=this.ogm=this.ga=null;this.Qsg=[new ug];this.Vfa=[]}get name(){return"PowerPointWebEditor.Chronos"}oc(ja){this.ga=ja;this.ohb=this.ga.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.vn=this.ohb.GIb(0,this.name);
for(let qb=0;qb<this.Qsg.length;++qb)Array.add(this.Vfa,Xc.a(this.Qsg[qb],0));for(const qb of this.Vfa)qb.oc(ja);ih.h2m(ja);this.ga.register(mg,"PowerPointWebEditor.PictureContext").as("PowerPointWebEditor.IPictureContext").oa().pa(()=>new mg(this.ga.resolve("PowerPointWebEditor.IApplicationSettings").$2e,this.ga.resolve("PowerPointWebEditor.IApplicationSettings").grd))}rqd(ja,qb){ja=Vd.a.instance;for(let Ea=0;Ea<qb.entries.length;Ea++){var V=qb.entries[Ea];V.url=v.a.removeParameter(V.url,n.AFrameworkApplication.zJ);
const Za=v.a.jaa(V.url);let ia=!1;if("about:blank"===V.url||Za.endsWith("RemoteUls.ashx")||"renamehandler.ashx"===Za&&"2"===v.a.XP(V.url,"u")||this.LJb&&(ia=Za.endsWith("PowerPoint.ashx"))&&V.url.endsWith("ib=1"))V.behavior=1;else{if(ia||Za.endsWith("PowerPoint.ashx")||Za.endsWith("GetUpdates")||Za.endsWith("images.ashx")||Za.endsWith("GetThumb"))V.behavior=2;if(!this.igm&&Za.endsWith("PowerPoint.ashx")&&"true"===v.a.XP(V.url,Na.a.Tom))V=V.jD,ja.mc(Ja.a.TUe,parseInt(String(V.fetchStart))),ja.mc(Ja.a.wVl,
parseInt(String(V.responseStart))),ja.mc(Ja.a.tVl,parseInt(String(V.responseEnd-V.responseStart))),this.igm=!0;else if(!this.hgm&&Za.endsWith("PowerPoint.ashx")&&"true"===v.a.XP(V.url,"dSlide")){this.hgm=!0;V=V.jD;ja.mc("SlideImageFetchStart",parseInt(String(V.fetchStart)));ja.mc("SlideImageResponseStart",parseInt(String(V.responseStart)));ja.mc("SlideImageDownloadDuration",parseInt(String(V.responseEnd-V.responseStart)));let Va;({transferSize:Va}=ih.wDm(V)).returnValue&&ja.mc("SlideImageSize",Va)}else if(!this.khk&&
Za.endsWith("images.ashx")&&"true"===v.a.XP(V.url,"minimalboot")&&v.a.XP(V.url,"index")===this.ogm){this.khk=!0;V=V.jD;ja.mc("MBootFetchStart",parseInt(String(V.fetchStart)));ja.mc("MBootResponseStart",parseInt(String(V.responseStart)));ja.mc("MBootDownload",parseInt(String(V.responseEnd-V.responseStart)));let Va;({transferSize:Va}=ih.wDm(V)).returnValue&&ja.mc("MBootSize",Va)}}}}cbo(){const ja=window.self.FirstSlideRequestIndex;void 0===ja||null===ja?this.khk=!0:this.ogm=ja.toString()}init(){Pc.a.$(512497358,
809,50,"ChronosPackage::Init");const ja=this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),qb=this.ga.resolve("Common.ITaskManager");for(var V of this.Vfa)this.vn.CJ(V.name),V.init(),this.vn.FJ(V.name);this.ga.resolve("Common.IAppSettingsManager").Wf(()=>{if(ja.vxe){const Ea=this.vn.CJ("animationpreview");this.Nun();this.vn.FJ(Ea)}});this.ga.resolve("Common.IActionManagerExtended").z9(this.ga.resolve("PowerPointWebEditor.IPasteFloatieHelper"));V=k.a.instance.resolve("Box4.IProofingManager");
if(null!==V){const Ea=this.vn.CJ("proofingresume");V.resume();this.vn.FJ(Ea)}if(ja.Fwa||!ja.zYa)V=this.vn.CJ("loaddelayedres"),this.ga.resolve("PowerPointWebEditor.IPresentationResourcesManager").p0h(),this.vn.FJ(V);this.cbo();this.LJb=ja.tKb;V=this.ga.resolve("Common.NetworkTiming.IResourceTimingLogger");V.oc(30,0);V.FFh(Object(da.a)(this,this.rqd,"onResourceTimingEntriesAvailable"));V.activate();V.flush();V.NXh();ja.Agb&&(this.t0e=window.self.PerfMeterData,void 0!==this.t0e&&null!==this.t0e&&(qb.Rb(new jc.a(3,
2,6E4,Object(da.a)(this,this.collectPerfMeterData,"collectPerfMeterData"),90,"67")),Pc.a.$(512497357,809,50,"CollectPerfMeterData task started"),this.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler").GF(()=>{this.collectPerfMeterData(null)})));this.ga.resolve("Common.IActionManagerExtended").z9(this.ga.resolve("Box4.ITextPasteFloatieManager"));ja.Jfb&&this.ga.resolve("Common.IActionManagerExtended").z9(this.ga.resolve("PowerPointWebEditor.EditSurfaceLayoutManager"));this.WAn()}WAn(){Pc.a.$(512497356,
809,50,"Start to download chronos1 js file");this.ga.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").qfa("pptedit.chronos1",null,null,()=>a.e(7).then(a.bind(null,1894)))}collectPerfMeterData(){if(0<this.t0e.length){const ja=[];for(const qb of this.t0e)ja.push({["Id"]:qb.Id,["Value"]:qb.Value.toFixed(2),["Start"]:qb.Start.toFixed(2),["Duration"]:qb.Duration.toFixed(2)});Pc.a.$(512497355,813,50,JSON.stringify(ja));this.t0e.length=0}}dispose(){for(var ja of this.Vfa)ja.dispose();ja=
this.ga.resolve("Common.NetworkTiming.IResourceTimingLogger");ja.deactivate(!0);ja.kYh(Object(da.a)(this,this.rqd,"onResourceTimingEntriesAvailable"))}Nun(){const ja=Lb.a.create("pptedit.animationpreview",null,()=>a.e(32).then(a.bind(null,1920)));try{fa.a.RK(ja)}catch(qb){Pc.a.$(512497354,809,10,"ChronosPackage::InitializeAnimationPreview - Failed to download animationpreview script, Exception: {0}",qb.toString())}}static h2m(ja){ja.register(666,"Common.IFloatPaneContainer").oa().pa(()=>new Pf)}static wDm(ja){ja=
parseInt(String(Lf.a(ja,"transferSize")));return{returnValue:!ja.toString().startsWith("NaN"),transferSize:ja}}static main(){n.AFrameworkApplication.Ch&&dc.a.Yf?Pc.a.$(512497353,809,15,"Firefox attempts to load chronos package when App is disposing"):(Vd.a.instance.mc(Nd.a.BHh,(new Date).getTime()),I.a.instance.Jc(Xc.a(new ih,0)))}}Object(m.a)(ih,"ChronosPackage",null,[4,5]);class Yg{constructor(ja,qb,V,Ea,Za,ia,Va){this.Q0e=this.Iwa=!1;this.ya=ja;this.qc=qb;this.QA=V;this.VB=Ea;this.Mnd=ia;this.Oe=
Za;this.bT=this.ya.Ia;this.Oc=Va}initialize(){this.QA.Rm(Object(da.a)(this,this.Qh,"onPropertyChanged"));this.Oe.Sjc(Object(da.a)(this,this.mab,"onRibbonTabSwitched"));this.VB.Hha(Object(da.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.VB.iid(Object(da.a)(this,this.$zb,"onShapeViewElementAdded"));this.VB.FQl(Object(da.a)(this,this.snm,"onShapesAllSelected"))}dispose(){this.QA.rr(Object(da.a)(this,this.Qh,"onPropertyChanged"));this.Oe.ZDe(Object(da.a)(this,this.mab,"onRibbonTabSwitched"));
this.VB.Cbb(Object(da.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.VB.D4e(Object(da.a)(this,this.$zb,"onShapeViewElementAdded"));this.VB.Kum(Object(da.a)(this,this.snm,"onShapesAllSelected"))}Qh(ja,qb){qb.property===Rf.a.Zkd&&this.Iwa&&this.qc.Hg(qb.node)===this.bT&&this.iJa(this.Iwa)}mab(ja,qb){if(this.Iwa=!!qb.yzb&&0<=qb.yzb.indexOf("Animation"))this.Q0e=!0;this.iJa(this.Iwa)}$zb(ja,qb){(ja=this.ya.Ia)&&ja.dW&&ja===this.bT&&(qb=qb.pJ)&&qb.shapeNode&&this.bT&&this.FPc(this.bT.fc,
qb.shapeNode)&&this.iJa(this.Iwa)}FPc(ja,qb){return ja&&qb?ja.equals(qb.slideId):!1}onActiveSlideDomReady(ja,qb){(ja=Object(Rb.a)(22,qb.Ia))&&this.bT&&this.bT.fc!==ja.fc&&(this.bT=ja,this.iJa(this.Iwa))}snm(){this.eDb()}eDb(){if(this.Iwa&&this.bT&&this.bT.KBa&&this.Q0e){var ja=this.bT.Nj();if(ja&&0<ja.length)for(const qb of ja)qb&&qb.a1b()&&(ja=this.Mnd.fca(qb))&&(ja.uHf(),ja.eDb(!0))}}iJa(ja){if(this.Q0e&&this.bT&&this.bT.dW&&this.Oc.jd&&this.Oc.jd.Vyf){var qb=this.bT.Nj();if(qb&&0<qb.length)for(const V of qb)V&&
(qb=this.Mnd.fca(V))&&(qb.visible=ja,qb.WCe())}}}Object(m.a)(Yg,"AnimationMarkerManagerLegacy",null,[40]);var Ah=a(30),Bh=a(77);class Kh{constructor(ja,qb){this.height=ja;this.top=qb}}Object(m.a)(Kh,"ParagraphProperties",null,[]);var Mg=a(67),jg=a(91),jh=a(167),Yf=a(202),jf=a(246),ci=a(212),bi=a(362),Rh=a(71);class di{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd,yd,Md,te,Pe,t,L){this.vEg=this.wR=this.L0e=this.un=this.pc=!1;this.xa=new Ah.a;this.mFg=this.ef=1;this.nc=this.VD=this.eD=this.vi=this.Hb=
this.Wb=null;this.kh=!1;this.od=null;this.Yn=(S,ka)=>{ka&&(S=ka.FB,ka=this.qc.Hg(this.ta),null!==S&&void 0!==S&&S.Ed&&ka&&S.Ed.id===ka.id&&this.updateZoom())};this.Yq=S=>{S&&this.Csa?(this.Wb=new jh.a,this.Wb.Nw("AnimationMarkerView"),this.Csa.appendChild(this.Wb.va),this.Hb=new ci.a,this.Hb.yk(0),this.Wb.appendChild(this.Hb.viewport),this.vi=new Yf.a,this.vi.yk(1),this.vi.setVisibility(!1),this.Hb.appendChild(this.vi),this.eD=new jh.a,this.eD.Nw("ShapeAnimationMarkerContainer"),this.eD.va.id=this.ta.id.toString(),
this.eD.zh(20,this.Wb.va.clientHeight),this.eD.yk(1),this.Wb.appendChild(this.eD),this.VD=new jh.a,this.VD.Nw("TextAnimationMarkerContainer"),this.VD.va.id=this.ta.id.toString(),this.VD.zh(20,this.Wb.va.clientHeight),this.VD.yk(1),this.Wb.appendChild(this.VD),this.Qg.Ub(ab.a.jv,this.eD.va,this.bJ),this.Qg.Ub(ab.a.hy,this.eD.va,this.bJ),this.Qg.Ub(ab.a.jv,this.VD.va,this.bJ),this.Qg.Ub(ab.a.hy,this.VD.va,this.bJ),this.Qg.Ub(ab.a.BR,this.eD.va,this.Yld),this.Qg.Ub(ab.a.BR,this.VD.va,this.Yld),this.Qg.Ub(ab.a.mouseDown,
this.eD.va,this.Yld),this.Qg.Ub(ab.a.mouseDown,this.VD.va,this.Yld),this.kf.Ub(ab.a.click,this.VD.va,this.QMh),this.kf.Ub(ab.a.click,this.eD.va,this.QMh),this.setVisibility()):Pc.a.$(509682581,800,10,"AnimationMarkerView: {0} is null",S?"m_markerViewParentElement":"parent")};this.k1=()=>!0;this.Yld=S=>{if(!S&&!S.Hc.id.startsWith(Od.a.oTb)&&!S.Hc.id.startsWith("overlappedMarker"))return Pc.a.$(509682580,800,50,"AnimationMarkerView:handleAnimationMarkerClick source element is not marker"),!1;S.eventName==
ab.a.BR&&this.Wyk(S);S=S.Pb;S.preventDefault();S.stopPropagation();return!0};this.QMh=S=>{S=S.Pb;S.preventDefault();S.stopPropagation();return!0};this.setSelection=()=>{};this.setVisibility=()=>{let S=this.pc&&!this.wR;this.ta&&this.ta.isHiddenShape&&(S=!1);this.Wb&&this.Wb.oe(S);this.eD&&this.eD.oe(S);this.VD&&this.VD.oe(S)};this.eDb=S=>{if(this.W6a()){this.L0e=S;S=[this.eD.va.childNodes,this.VD.va.childNodes];for(const ka of S)for(S=0;ka&&S<ka.length;S++)this.Fhh(ka[S],this.L0e)}};this.T9n=S=>{if(this.W6a()){var ka=
[this.eD.va.childNodes,this.VD.va.childNodes];for(const ra of ka)for(ka=0;ra&&ka<ra.length;ka++){const xb=this.IWe(ra[ka]);if(!oe.a("FixAnimationMarkerAttributeNullCrash")||xb)for(const Ob of S)xb.includes(Ob)&&this.Fhh(ra[ka],!0)}}};this.IWe=S=>{if(!S||!this.ta)return null;S=S.getAttribute("AnimProps");if(!S||!S.toString()||!S.toString().trim().length)return null;S=S.toString().split(" ");if(!S||!S.length)return null;const ka=[];for(const ra of S){if(!ra||!ra.trim().length)return null;ka.push(Number.parseInvariant(ra.trim()))}return ka};
this.W6a=()=>{const S=!!this.ta&&!!this.Csa&&!!this.eD&&!!this.VD;S||Pc.a.$(509682579,800,10,"AnimationMarkerView: the containers are not exist.");return S};this.tBc=()=>{this.yXa(!0);this.yXa(!1)};this.yXa=S=>{if(this.Qg&&this.kf&&this.W6a()&&(S=S?this.VD.va:this.eD.va)&&S.childNodes&&0<S.childNodes.length){const ka=S.childNodes;for(const ra=0;ra<ka.length;)S.removeChild(ka[ra])}};this.Soi=()=>{if(this.W6a()){var S=this.qc.Hg(this.ta);if(S){var ka=S.DIb(this.ta);if(ka&&ka.length){var ra=!1;S=!1;
var xb=[];for(var Ob of ka)Ob.IsTextRangeType?S=!0:(ra=!0,xb.push(Ob));this.vEg=ra&&S;this.bGb(!0);this.bGb(!1);this.yXa(!1);0<xb.length&&(Ob=0,xb.sort((Vb,Ac)=>Vb.EffectNodeId-Ac.EffectNodeId),(Ob=oe.a("FixOverlappedAnimationMarkers")?this.kRf(xb,this.vj.hH(this.ta.ju.hd,this.ef),this.vj.hH(this.ta.ju.Bd-this.ta.ju.hd,this.ef),!1,-1):this.RYl(xb,this.vj.hH(this.ta.ju.hd,this.ef),this.vj.hH(this.ta.ju.Bd-this.ta.ju.hd,this.ef),!1))||Pc.a.$(509682577,800,10,"AnimationMarkerView: no shape marker is rendered"));
S?this.n4i():this.yXa(!0)}else this.tBc()}else Pc.a.$(509682578,800,10,"AnimationMarkerView::addAnimationMarkers: slideNode is null")}};this.n4i=()=>{const S=new jc.a(2,1,0,this.ensureTextIsRenderedAndDrawMarkers,90,"26");this.Yb.Rb(S)};this.ensureTextIsRenderedAndDrawMarkers=()=>{this.un||(this.Nbk(),this.uRf())};this.uRf=()=>{this.yXa(!0);if(this.eEj()){var S=this.Aqj();if(S&&S.length){var ka;if(({top:ka}=this.Zqj()).returnValue){var ra=0;for(let Ob=0;Ob<S.length;Ob++){var xb=this.qc.Hg(this.ta);
if(!xb){Pc.a.$(509682574,800,10,"AnimationMarkerView:drawTextAnimationMarkers slide node is null.");return}(xb=xb.eXe(this.ta,Ob))&&0<xb.length&&S[Ob]&&(xb.sort((Vb,Ac)=>Vb.EffectNodeId-Ac.EffectNodeId),ra=oe.a("FixOverlappedAnimationMarkers")?ra+this.kRf(xb,S[Ob].top-ka,S[Ob].height,!0,Ob):ra+this.RYl(xb,S[Ob].top-ka,S[Ob].height,!0))}ra||Pc.a.$(509682573,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else Pc.a.$(509682575,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else Pc.a.$(509682576,
800,50,"AnimationMarkerView: the paragrph view is not rendered")}};this.Aqj=()=>{const S=[];var ka=Xf.GraphIterator.vb(this.ta);ka=this.Wn.lfa(ka,ka.currentNode);for(var ra;ka.moveNext();)(ra=ka.currentNode)&&this.Rj.ue(ra)&&ra&&(ra=ra.yc(this.FC))&&ra.htmlElement&&(ra=this.JOa(ra.htmlElement))&&ra.height&&S.push(ra);return S};this.JOa=S=>{if(!S)return Pc.a.$(509682570,800,10,"AnimationMarkerView:getParagraphProperties paragraph is null"),null;S=S.querySelectorAll(".TextRun");if(!S||!S.length)return null;
let ka=0,ra=0;let xb,Ob=!1;for(let Ac=0;Ac<S.length&&S[Ac];Ac++){var Vb=S[Ac].getClientRects();({top:Vb,bottom:xb}=this.v8i(Vb)).returnValue&&(Ac?(ka=ka>Vb?Vb:ka,ra=ra<xb?xb:ra):(ka=Vb,ra=xb),Ob=!0)}if(Ob)return new Kh(ra-ka,ka);Pc.a.$(509682569,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null};this.IR=()=>{this.Onk(this.Wb.va,!0)};this.eEj=()=>{var S=this.qc.Hg(this.ta);if(!S)return Pc.a.$(509682567,800,10,"AnimationMarkerView::hasTextAnimations: slideNode is null"),
!1;S=S.DIb(this.ta);if(!S||!S.length)return!1;for(const ka of S)if(ka.IsTextRangeType)return!0;return!1};this.bGb=S=>{if(this.W6a()){var ka=S?this.eD.va:this.VD.va,ra,xb;ka&&({x:ra,y:xb}=this.mlj(S)).returnValue&&(ka.style.position=jg.a.absolute,ka.style.left=Mg.a.Zc(ra),ka.style.zIndex="20000",S?ka.style.top=Mg.a.Zc(xb):this.uRf())}};this.Wyk=S=>{if(this.xa&&S&&this.Na&&S.Hc){var ka=oe.a("FixOverlappedAnimationMarkers")?S.Hc.id.startsWith("overlappedMarker")&&S.Hc.parentElement?S.Hc.parentElement:
S.Hc:S.Hc.id.startsWith("overlappedMarker")&&S.Hc.offsetParent?S.Hc.offsetParent:S.Hc;(ka=this.IWe(ka))?(S.ctrlKey?this.eu.Wnn(ka,this.qc.Hg(this.ta)):(this.eu.T5e(!1),this.eu.gwa(),this.eu.T5e(!0),this.eu.pri(ka,this.qc.Hg(this.ta))),this.xa.raiseEvent("OnMarkerClick",S),this.Na.ee()):Pc.a.$(509682566,800,10,"AnimationMarkerView: failed to parse the animation properties.")}};this.kn=()=>{this.Hb&&(this.Ped(),this.Hb.kn())};this.Ped=()=>{if(this.ta&&this.vi){var S=this.ta.ju.points;S=di.eMa(S,this.QJc());
this.vi.py(S)}};this.QJc=()=>{let S=Od.a.rfc;this.ta.xg||!this.ta.e8&&!this.ta.Bl||(S+=6);return S};this.zu=()=>{this.Hb&&this.mFg!==this.ef&&this.WCe();return null};this.Ov=()=>{};this.SA=()=>{};this.qj=S=>{this.mFg=this.ef;this.ef=S};this.setZIndex=S=>{this.Hb&&this.Hb.NH(S)};this.draw=()=>{this.WCe()};this.l4n=(S,ka=!0)=>{this.Wb&&this.Csa&&this.pc&&!this.wR&&this.YSm(S,ka);this.updateZoom();this.setVisibility()};this.YSm=(S,ka=!0)=>{this.W6a()&&(this.qc.Hg(this.ta)?(this.bGb(!0),this.bGb(!1),
this.yXa(!0),this.yXa(!1),this.c9m(S,ka)):Pc.a.$(507881296,800,10,"AnimationMarkerView::addAnimationMarkers: slideNode is null"))};this.WCe=()=>{this.Wb&&this.Csa&&this.pc&&!this.wR&&(this.tBc(),this.Soi());this.updateZoom();this.setVisibility()};this.bJ=S=>{if(!this.xa||!S)return!1;this.xa.raiseEvent("OnSelectionAreaHover",S);S.eventName===ab.a.jv?this.wcb(S.Hc,"animMarkerHovered",1):S.eventName===ab.a.hy&&this.wcb(S.Hc,"animMarkerHovered",2);return!0};this.Fhh=(S,ka)=>{S?ka?(this.wcb(S,"animMarkerUnselected",
2),this.wcb(S,"animMarkerSelected",1)):(this.wcb(S,"animMarkerSelected",2),this.wcb(S,"animMarkerUnselected",1)):Pc.a.$(509682565,800,10,"AnimationMarkerView:selectMarker domElement is null")};this.wcb=(S,ka,ra)=>{const xb=this.VMh(S);switch(ra){case 0:S.setAttribute(jg.a.V2a,ka);xb&&S.lastChild.setAttribute(jg.a.V2a,ka);break;case 1:Sys.UI.DomElement.addCssClass(S,ka);xb&&Sys.UI.DomElement.addCssClass(S.lastChild,ka);break;case 2:Sys.UI.DomElement.removeCssClass(S,ka),xb&&Sys.UI.DomElement.removeCssClass(S.lastChild,
ka)}};this.VMh=S=>!!S&&!!S.lastChild&&!!S.lastChild.id&&"overlappedMarker"===S.lastChild.id;this.setPosition=()=>{};this.ER=S=>{this.wR=S;this.wR||(this.WC(),this.eDb(!0));this.setVisibility()};this.pR=()=>null;this.vE=()=>{};this.DM=()=>[];this.tH=()=>{};this.NT=()=>{};this.WC=()=>{!this.un&&this.Csa&&(this.bGb(!0),this.bGb(!1))};this.xIh=()=>{const S=new jf.a;S.zh(10,10);S.va.setAttribute(jg.a.V2a,"pointer-events-none");S.CZa("0 0 2048 2048");const ka=new Yf.a;ka.$na("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");
ka.eP("#E67E22");ka.PC("#FFFF00");ka.Hx(5);S.appendChild(ka);return S.va};if(!ja)throw Error.argumentNull("shapeNode");if(!qb)throw Error.argumentNull("slideReader");if(!V)throw Error.argumentNull("traverserFactory");if(!Ea)throw Error.argumentNull("paragraphReader");if(!Va)throw Error.argumentNull("activeSlideViewManager");if(!Ab)throw Error.argumentNull("mouseInputManager");if(!gc)throw Error.argumentNull("clickInputManager");if(!Hc)throw Error.argumentNull("focusManagers");if(!te)throw Error.argumentNull("effectSelectionManager");
if(!hd)throw Error.argumentNull("pptUnitConversion");this.ta=ja;this.qc=qb;this.Wn=V;this.Rj=Ea;this.FC=ia;this.Onk=Za;this.Csa=Va.jd?Va.jd.Vyf:null;this.Bmk=Va.jd?Va.jd.z6e:null;this.Qg=Ab;this.kf=gc;this.Na=Hc;this.Yb=fd;this.w8a=yd;this.Nbk=Md;this.vj=hd;this.eu=te;this.nc=Pe;this.od=L;(this.kh=t.getBooleanAppSetting(Rh.a.EJ))&&this.nc.PXa&&this.od.mXa(this.Yn)}dispose(){this.un||(this.w8a(),this.un=!0,this.pc=!1,this.tBc(),this.kf&&this.eD&&this.kf.hc(ab.a.click,this.eD.va,this.QMh),this.Qg&&
this.eD&&(this.Qg.hc(ab.a.jv,this.eD.va,this.bJ),this.Qg.hc(ab.a.hy,this.eD.va,this.bJ),this.Qg.hc(ab.a.BR,this.eD.va,this.Yld),this.Qg.hc(ab.a.mouseDown,this.eD.va,this.Yld)),this.kh&&this.nc.PXa&&this.od.cLb(this.Yn),this.eD=null,this.kf&&this.VD&&this.kf.hc(ab.a.click,this.VD.va,this.QMh),this.Qg&&this.VD&&(this.Qg.hc(ab.a.jv,this.VD.va,this.bJ),this.Qg.hc(ab.a.hy,this.VD.va,this.bJ),this.Qg.hc(ab.a.BR,this.VD.va,this.Yld),this.Qg.hc(ab.a.mouseDown,this.VD.va,this.Yld)),this.Na=this.Rj=this.ta=
this.Wn=this.qc=this.vj=this.eu=this.Hb=this.vi=this.Csa=this.Wb=this.VD=null)}get visible(){return this.pc}set visible(ja){this.pc=ja}get hs(){return this.Hb}get Ho(){return this.vi}get ge(){return this.Wb}Zqj(){return this.getClientRects(this.Bmk)}getClientRects(ja){let qb,V;qb=V=0;if(!ja)return Pc.a.$(509682572,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:qb,top:V};ja=ja.getClientRects();if(!ja||!ja.length||!ja[0])return Pc.a.$(509682571,800,10,"AnimationMarkerView: cannot get boundingRects."),
{returnValue:!1,left:qb,top:V};V=Math.round(ja[0].top);qb=Math.round(ja[0].left);return{returnValue:!0,left:qb,top:V}}v8i(ja){let qb,V;qb=V=0;if(!ja||!ja.length||!ja[0])return Pc.a.$(509682568,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),{returnValue:!1,top:qb,bottom:V};qb=ja[0].top;V=ja[0].bottom;for(let Ea=1;Ea<ja.length&&ja[Ea];Ea++)qb=ja[Ea].top>qb?qb:ja[Ea].top,V=ja[Ea].bottom<V?V:ja[Ea].bottom;return{returnValue:!0,top:qb,bottom:V}}RYl(ja,qb,V,Ea){if(!this.W6a()||!ja||!ja.length)return 0;
const Za=Ea?this.VD.va:this.eD.va;V=(V=Math.floor(this.vj.Fs(V)/21))?V:1;let ia=0,Va=null,Ab=null,gc=!0,Hc=!1;for(let yd=0;yd<ja.length;yd++){const Md=ja[yd];var fd=new jh.a;fd.va.id=Od.a.oTb+Md.ClickOrder;fd.zh(20,16);fd.yk(1);if(Md.IsTrigger){var hd=this.xIh();fd.va.appendChild(hd)}else fd.va.innerText=Md.ClickOrder.toString();let te=hd=!1;yd<V?(Ea&&(fd.va.style.position=jg.a.absolute,fd.va.style.top=Mg.a.Zc(this.vj.Fs(qb)+21*ia)),Hc=this.eu.RUe(Md.EffectNodeId),fd.va.setAttribute(jg.a.V2a,Hc?"animMarkerSelected":
"animMarkerUnselected"),Za.appendChild(fd.va),ia++):yd===V?(gc=gc&&Md.EffectId===Va.EffectId,hd=!0,te=Va.IsTrigger):gc=gc&&Md.EffectId===Va.EffectId;hd&&Ab.va.appendChild(this.TGh(te,gc,Hc));Va=Md;Ab||(Ab=fd);Ea?(fd=[],(hd=this.IWe(Ab.va))&&fd.push(...hd),fd.push(Md.EffectNodeId),Ab.va.setAttribute("AnimProps",fd.join(" "))):fd.va.setAttribute("AnimProps",Md.EffectNodeId)}this.IR();return ia}kRf(ja,qb,V,Ea){var Za;if(!this.W6a()||!ja||!ja.length)return 0;const ia=Ea?this.VD.va:this.eD.va;V=(V=Math.floor(this.vj.Fs(V)/
21))?V:1;let Va=0,Ab=null,gc=new jh.a,Hc=!0,fd=!1,hd=!1;for(let Pe=0;Pe<ja.length;Pe++){var yd=ja[Pe],Md=new jh.a;Md.va.id=Od.a.oTb+yd.ClickOrder;Md.zh(20,16);Md.yk(1);if(yd.IsTrigger){var te=this.xIh();Md.va.appendChild(te)}else Md.va.innerText=yd.ClickOrder.toString();Pe<V?(Ea&&(Md.va.style.position=jg.a.absolute,Md.va.style.top=Mg.a.Zc(this.vj.Fs(qb)+21*Va)),Md.va.setAttribute("AnimProps",yd.EffectNodeId),fd=this.eu.RUe(yd.EffectNodeId),Md.va.setAttribute(jg.a.V2a,fd?"animMarkerSelected":"animMarkerUnselected"),
ia.appendChild(Md.va),Va++):Pe===V&&gc.va?(Hc=Hc&&yd.EffectId===Ab.EffectId,hd=!0,te=Ab.IsTrigger,hd&&gc.va.appendChild(this.TGh(te,Hc,fd))):Hc=Hc&&yd.EffectId===Ab.EffectId;if(hd){Md=[];(te=this.IWe(gc.va))&&Md.push(...te);Md.push(yd.EffectNodeId);gc.va.setAttribute("AnimProps",Md.join(" "));if(oe.a("FixAnimationMarkerOverlapSelectionIssue"))for(const t of Md){if(fd=this.eu.RUe(t))break}else fd=this.eu.RUe(yd.EffectNodeId);gc.va.setAttribute(jg.a.V2a,fd?"animMarkerSelected":"animMarkerUnselected");
(yd=gc.va.lastElementChild)&&(null===(Za=null===yd||void 0===yd?void 0:yd.id)||void 0===Za?0:Za.startsWith("overlappedMarker"))&&yd.setAttribute(jg.a.V2a,"overlappedMarker "+(fd?"animMarkerSelected":"animMarkerUnselected"))}else gc=Md,Ab=yd}this.IR();return Va}TGh(ja,qb,V){const Ea=new jh.a;Ea.va.id="overlappedMarker";oe.a("FixOverlappedAnimationMarkers")?Ea.va.style.marginTop="-13px":Ea.va.style.marginTop=ja?"3px":"-13px";Ea.va.setAttribute(jg.a.V2a,"overlappedMarker "+(V?"animMarkerSelected":"animMarkerUnselected"));
qb&&this.wcb(Ea.va,"SameEffectOverlapped",1);return Ea.va}mlj(ja){var qb,V;let Ea;var Za=Ea=0;if(!this.ta)return{returnValue:!1,x:Za,y:Ea};var ia=Object(Rb.a)(112,this.ta.yc(this.FC));if(!ia)return{returnValue:!1,x:Za,y:Ea};ia=ia.Lu();if(!ia)return{returnValue:!1,x:Za,y:Ea};Za=20/(null!==(V=null===(qb=this.nc)||void 0===qb?void 0:qb.$F)&&void 0!==V?V:bi.a.f$);Za=ja?ia.Mc-(this.vEg?2*Za+21:Za+15):ia.Mc-Za-15;Ea=ia.hd;return{returnValue:!0,x:Za,y:Ea}}c9m(ja,qb=!0){if(this.W6a()){var V=this.eD.va,Ea=
new jh.a;Ea.va.id=Od.a.oTb+ja;Ea.zh(20,16);Ea.yk(1);ja&&(Ea.va.innerText=ja.toString());Ea.va.setAttribute(jg.a.V2a,ja?"animMarkerSelected":qb?"animMarkerBlank":"animMarkerUnselected Shimmer");V.appendChild(Ea.va);this.IR()}}updateZoom(){var ja,qb,V;this.kh&&null!==(ja=this.nc)&&void 0!==ja&&ja.PXa&&!this.un&&this.Csa&&(this.bGb(!0),this.bGb(!1),ja=this.qc.Hg(this.ta),this.jma(null===(qb=this.eD)||void 0===qb?void 0:qb.va,1/this.nc.aKc(ja)),this.jma(null===(V=this.VD)||void 0===V?void 0:V.va,1/this.nc.aKc(ja)))}jma(ja,
qb){ja&&qb&&(ja.style.transform=`scale(${qb})`,ja.style.transformOrigin="right")}}di.eMa=(ja,qb)=>[new Bh.a(ja[0]._x-qb,ja[0]._y-qb),new Bh.a(ja[1]._x+qb,ja[1]._y-qb),new Bh.a(ja[2]._x+qb,ja[2]._y+qb),new Bh.a(ja[3]._x-qb,ja[3]._y+qb)];Object(m.a)(di,"AnimationMarkerView",null,[685,558,267,40]);class Dg{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd,yd,Md){this.$Rh=this.L0e=this.un=this.pc=!1;this.Ynd=this.Krg=-1;this.vEg=this.wR=!1;this.xa=new Ah.a;this.mFg=this.ef=1;this.VD=this.eD=this.vi=this.Hb=
this.Wb=null;this.ta=ja;this.qc=qb;this.Wn=V;this.Rj=Ea;this.FC=ia;this.Onk=Za;this.Csa=Va.jd?Va.jd.Vyf:null;this.Bmk=Va.jd?Va.jd.z6e:null;this.Qg=Ab;this.kf=gc;this.Na=Hc;this.Yb=fd;this.w8a=yd;this.Nbk=Md;this.vj=hd}dispose(){this.un||(this.w8a(),this.un=!0,this.pc=!1,this.uHf(),this.tBc(),this.Qg&&this.eD&&(this.Qg.hc(ab.a.jv,this.eD.va,Object(da.a)(this,this.bJ,"onSelectionAreaHover")),this.Qg.hc(ab.a.hy,this.eD.va,Object(da.a)(this,this.bJ,"onSelectionAreaHover"))),this.eD=null,this.Qg&&this.VD&&
(this.Qg.hc(ab.a.jv,this.VD.va,Object(da.a)(this,this.bJ,"onSelectionAreaHover")),this.Qg.hc(ab.a.hy,this.VD.va,Object(da.a)(this,this.bJ,"onSelectionAreaHover"))),this.Hb=this.vi=this.Csa=this.Wb=this.VD=null)}get visible(){return this.pc}set visible(ja){this.pc=ja}get hs(){return this.Hb}get Ho(){return this.vi}get ge(){return this.Wb}Yq(ja){ja&&this.Csa?(this.Wb=new jh.a,this.Wb.Nw("AnimationMarkerView"),this.Csa.appendChild(this.Wb.va),this.Hb=new ci.a,this.Hb.yk(0),this.Wb.appendChild(this.Hb.viewport),
this.vi=new Yf.a,this.vi.yk(1),this.vi.setVisibility(!1),this.Hb.appendChild(this.vi),this.eD=new jh.a,this.eD.Nw("ShapeAnimationMarkerContainer"),this.eD.va.id=this.ta.id.toString(),this.eD.zh(20,this.Wb.va.clientHeight),this.eD.yk(1),this.Wb.appendChild(this.eD),this.VD=new jh.a,this.VD.Nw("TextAnimationMarkerContainer"),this.VD.va.id=this.ta.id.toString(),this.VD.zh(20,this.Wb.va.clientHeight),this.VD.yk(1),this.Wb.appendChild(this.VD),this.Qg.Ub(ab.a.jv,this.eD.va,Object(da.a)(this,this.bJ,"onSelectionAreaHover")),
this.Qg.Ub(ab.a.hy,this.eD.va,Object(da.a)(this,this.bJ,"onSelectionAreaHover")),this.Qg.Ub(ab.a.jv,this.VD.va,Object(da.a)(this,this.bJ,"onSelectionAreaHover")),this.Qg.Ub(ab.a.hy,this.VD.va,Object(da.a)(this,this.bJ,"onSelectionAreaHover")),this.setVisibility()):Pc.a.$(509682564,800,10,"AnimationMarkerView: {0} is null",ja?"m_markerViewParentElement":"parent")}k1(ja){let qb=!1;ja&&ja.Hc.id.startsWith(Od.a.oTb)||ja.Hc.id.startsWith("overlappedMarker")?(this.Wyk(ja),qb=!0):(this.uHf(),this.eDb(!0));
return qb}setSelection(ja){if(ja&&!this.$Rh||!ja)this.eDb(ja),this.uHf()}setVisibility(){let ja=this.pc&&!this.wR;this.ta&&this.ta.isHiddenShape&&(ja=!1);this.Wb&&this.Wb.oe(ja);this.eD&&this.eD.oe(ja);this.VD&&this.VD.oe(ja)}eDb(ja){if(this.W6a()){this.L0e=ja;ja=[this.eD.va.childNodes,this.VD.va.childNodes];for(const qb of ja)for(ja=0;qb&&ja<qb.length;ja++)this.Fhh(qb[ja],this.L0e)}}IWe(ja){if(!ja||!this.ta)return null;ja=ja.getAttribute("AnimProps");if(!ja||!ja.toString()||!ja.toString().trim().length)return null;
ja=ja.toString().split(" ");if(!ja||4!==ja.length)return null;const qb=[];for(const V of ja){if(!V||!V.trim().length)return null;qb.push(Number.parseInvariant(V.trim()))}return qb}W6a(){const ja=!!this.ta&&!!this.Csa&&!!this.eD&&!!this.VD;ja||Pc.a.$(509682563,800,10,"AnimationMarkerView: the containers are not exist.");return ja}tBc(){this.yXa(!0);this.yXa(!1)}yXa(ja){if(this.Qg&&this.kf&&this.W6a()&&(ja=ja?this.VD.va:this.eD.va)&&ja.childNodes&&0<ja.childNodes.length){const qb=ja.childNodes;for(const V=
0;V<qb.length;)ja.removeChild(qb[V])}}Soi(){if(this.W6a()){var ja=this.N1l(this.ta);if(ja&&ja.length){var qb=!1,V=!1,Ea=[];for(const Za of ja)Za.IsTextRangeType?V=!0:(qb=!0,Ea.push(Za));this.vEg=qb&&V;this.bGb(!0);this.bGb(!1);this.yXa(!1);0<Ea.length&&(Pc.a.$(509682562,800,50,"AnimationMarkerView: draw shape animation markers."),this.kRf(Ea,this.vj.hH(this.ta.ju.hd,this.ef),this.vj.hH(this.ta.ju.Bd-this.ta.ju.hd,this.ef),!1,-1)||Pc.a.$(509682561,800,10,"AnimationMarkerView: no shape marker is rendered"));
V?this.n4i():this.yXa(!0);if(!V&&-1!==this.Ynd||-1!==this.Ynd&&-1===this.Ynd&&!qb)this.iKi(),this.eDb(!0)}else this.tBc()}}n4i(){const ja=new jc.a(2,1,0,Object(da.a)(this,this.ensureTextIsRenderedAndDrawMarkers,"ensureTextIsRenderedAndDrawMarkers"),90,"26");this.Yb.Rb(ja)}ensureTextIsRenderedAndDrawMarkers(){this.un||(this.Nbk(),this.uRf())}uRf(){this.yXa(!0);if(this.eEj(this.ta)){var ja=this.Aqj();if(ja&&ja.length){var qb;if(({top:qb}=this.Zqj()).returnValue){var V=0;Pc.a.$(509682530,800,50,"AnimationMarkerView: draw paragraph animation markers.");
for(let Za=0;Za<ja.length;Za++){var Ea=this.qc.Hg(this.ta);if(!Ea)return;(Ea=Ea.Mld(this.ta,Za))&&0<Ea.length&&ja[Za]&&(V+=this.kRf(Ea,ja[Za].top-qb,ja[Za].height,!0,Za))}V||Pc.a.$(509682529,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else Pc.a.$(509682531,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else Pc.a.$(509682560,800,50,"AnimationMarkerView: the paragrph view is not rendered")}}Aqj(){const ja=[];var qb=Xf.GraphIterator.vb(this.ta);qb=this.Wn.lfa(qb,
qb.currentNode);for(var V;qb.moveNext();)(V=qb.currentNode)&&this.Rj.ue(V)&&V&&(V=V.yc(this.FC))&&V.htmlElement&&(V=this.JOa(V.htmlElement))&&V.height&&ja.push(V);return ja}Zqj(){return this.getClientRects(this.Bmk)}getClientRects(ja){let qb,V;qb=V=0;if(!ja)return Pc.a.$(509682528,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:qb,top:V};ja=ja.getClientRects();if(!ja||!ja.length||!ja[0])return Pc.a.$(509682527,800,50,"AnimationMarkerView: cannot get boundingRects."),
{returnValue:!1,left:qb,top:V};V=Math.round(ja[0].top);qb=Math.round(ja[0].left);return{returnValue:!0,left:qb,top:V}}JOa(ja){if(!ja)return Pc.a.$(509682526,800,10,"AnimationMarkerView: paragraph is null"),null;ja=ja.querySelectorAll(".TextRun");if(!ja||!ja.length)return null;let qb=0,V=0;let Ea,Za=!1;for(let Va=0;Va<ja.length&&ja[Va];Va++){var ia=ja[Va].getClientRects();({top:ia,bottom:Ea}=this.v8i(ia)).returnValue&&(Va?(qb=qb>ia?ia:qb,V=V<Ea?Ea:V):(qb=ia,V=Ea),Za=!0)}if(Za)return new Kh(V-qb,qb);
Pc.a.$(509682525,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null}v8i(ja){let qb,V;qb=V=0;if(!ja||!ja.length||!ja[0])return Pc.a.$(509682524,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),{returnValue:!1,top:qb,bottom:V};qb=ja[0].top;V=ja[0].bottom;for(let Ea=1;Ea<ja.length&&ja[Ea];Ea++)qb=ja[Ea].top>qb?qb:ja[Ea].top,V=ja[Ea].bottom<V?V:ja[Ea].bottom;return{returnValue:!0,top:qb,bottom:V}}kRf(ja,qb,V,Ea,Za){if(!this.W6a()||!ja||!ja.length)return 0;
const ia=Ea?this.VD.va:this.eD.va;V=(V=Math.floor(this.vj.Fs(V)/21))?V:1;let Va=0,Ab=null,gc=new jh.a,Hc=!1,fd=!1;const hd=Za===this.Ynd&&ja.length<this.Krg+1;for(let Md=0;Md<ja.length;Md++){const te=ja[Md],Pe=new jh.a;Pe.va.id=Od.a.oTb+te.BuildId;Pe.zh(20,16);Pe.yk(1);if(te.IsTrigger){var yd=this.xIh();Pe.va.appendChild(yd)}else Pe.va.innerText=te.BuildId.toString();let t=yd=!1;Md<V?(Ea&&(Pe.va.style.position=jg.a.absolute,Pe.va.style.top=Mg.a.Zc(this.vj.Fs(qb)+21*Va)),Pe.va.setAttribute("AnimProps",
String.format("{0} {1} {2} {3}",Md,Za,te.BuildId,te.EffectId)),fd=this.L0e||hd&&ja.length-1===Md||this.$Rh&&this.Krg===Md&&this.Ynd===Za,Pe.va.setAttribute(jg.a.V2a,fd?"animMarkerSelected":"animMarkerUnselected"),ia.appendChild(Pe.va),Va++):Md===V&&gc.va?(Hc=Hc&&te.EffectId===Ab.EffectId,yd=!0,t=Ab.IsTrigger):Hc=Hc&&te.EffectId===Ab.EffectId;yd&&gc.va.appendChild(this.TGh(t,Hc,fd));gc=Pe;Ab=te}this.IR();return Va}TGh(ja,qb,V){const Ea=new jh.a;Ea.va.id="overlappedMarker";Ea.va.style.marginTop=ja?
"3px":"-13px";Ea.va.setAttribute(jg.a.V2a,"overlappedMarker "+(V?"animMarkerSelected":"animMarkerUnselected"));qb&&this.wcb(Ea.va,"SameEffectOverlapped",1);return Ea.va}IR(){this.Onk(this.Wb.va,!0)}N1l(ja){if(!ja)return null;const qb=this.qc.Hg(ja);return qb?qb.s5a(ja):null}eEj(ja){ja=this.N1l(ja);if(!ja||!ja.length)return!1;for(const qb of ja)if(qb.IsTextRangeType)return!0;return!1}bGb(ja){if(this.W6a()){var qb=ja?this.eD.va:this.VD.va,V,Ea;qb&&({x:V,y:Ea}=this.mlj(ja)).returnValue&&(qb.style.position=
jg.a.absolute,qb.style.left=Mg.a.Zc(V),qb.style.zIndex="20000",ja?qb.style.top=Mg.a.Zc(Ea):this.uRf())}}mlj(ja){let qb,V;qb=V=0;if(!this.ta)return{returnValue:!1,x:qb,y:V};var Ea=Object(Rb.a)(112,this.ta.yc(this.FC));if(!Ea)return{returnValue:!1,x:qb,y:V};Ea=Ea.Lu();if(!Ea)return{returnValue:!1,x:qb,y:V};qb=ja?Ea.Mc-(this.vEg?61:35):Ea.Mc-20-15;V=Ea.hd;return{returnValue:!0,x:qb,y:V}}Wyk(ja){if(this.xa&&ja&&this.Na&&ja.Hc){var qb=ja.Hc.id.startsWith("overlappedMarker")&&ja.Hc.offsetParent?ja.Hc.offsetParent:
ja.Hc;this.$$n(qb);this.VMh(qb)&&!this.pyn(qb)&&this.iKi();this.eDb(!1);this.Fhh(qb,!0);this.xa.raiseEvent("OnMarkerClick",ja);this.Na.ee()}}uHf(){this.$Rh=!1;this.Ynd=this.Krg=-1;this.iKi()}$$n(ja){(ja=this.IWe(ja))?(this.$Rh=!0,this.Krg=ja[0],this.Ynd=ja[1],this.ta.vGa=this.Krg,this.ta.MUa=this.Ynd):Pc.a.$(509682523,800,10,"AnimationMarkerView: failed to parse the animation properties.")}iKi(){this.ta&&(this.ta.vGa=-1,this.ta.MUa=-1)}kn(){this.Hb&&(this.Ped(),this.Hb.kn())}Ped(){if(this.ta&&this.vi){var ja=
this.ta.ju.points;ja=Dg.eMa(ja,this.QJc());this.vi.py(ja)}}QJc(){let ja=Od.a.rfc;this.ta.xg||!this.ta.e8&&!this.ta.Bl||(ja+=6);return ja}zu(){this.Hb&&this.mFg!==this.ef&&this.WCe();return null}Ov(){}SA(){}qj(ja){this.mFg=this.ef;this.ef=ja}setZIndex(ja){this.Hb&&this.Hb.NH(ja)}draw(){this.WCe()}WCe(){this.Wb&&this.Csa&&this.pc&&!this.wR&&this.Soi();this.setVisibility()}bJ(ja){if(!this.xa||!ja)return!1;this.xa.raiseEvent("OnSelectionAreaHover",ja);ja.eventName===ab.a.jv?this.wcb(ja.Hc,"animMarkerHovered",
1):ja.eventName===ab.a.hy&&this.wcb(ja.Hc,"animMarkerHovered",2);return!0}Fhh(ja,qb){ja&&(qb?(this.wcb(ja,"animMarkerUnselected",2),this.wcb(ja,"animMarkerSelected",1)):(this.wcb(ja,"animMarkerSelected",2),this.wcb(ja,"animMarkerUnselected",1)))}wcb(ja,qb,V){const Ea=this.VMh(ja);switch(V){case 0:ja.setAttribute(jg.a.V2a,qb);Ea&&ja.lastChild.setAttribute(jg.a.V2a,qb);break;case 1:Sys.UI.DomElement.addCssClass(ja,qb);Ea&&Sys.UI.DomElement.addCssClass(ja.lastChild,qb);break;case 2:Sys.UI.DomElement.removeCssClass(ja,
qb),Ea&&Sys.UI.DomElement.removeCssClass(ja.lastChild,qb)}}VMh(ja){return!!ja&&!!ja.lastChild&&!!ja.lastChild.id&&"overlappedMarker"===ja.lastChild.id}pyn(ja){return!!ja&&!!ja.lastChild&&!!ja.lastChild.id&&0<=ja.lastChild.className.indexOf("SameEffectOverlapped")}setPosition(){}ER(ja){(this.wR=ja)?this.uHf():(this.WC(),this.eDb(!0));this.setVisibility()}pR(){return null}vE(){}DM(){return[]}tH(){}NT(){}WC(){!this.un&&this.Csa&&(this.bGb(!0),this.bGb(!1))}xIh(){const ja=new jf.a;ja.zh(10,10);ja.va.setAttribute(jg.a.V2a,
"pointer-events-none");ja.CZa("0 0 2048 2048");const qb=new Yf.a;qb.$na("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");qb.eP("#E67E22");qb.PC("#FFFF00");qb.Hx(5);ja.appendChild(qb);return ja.va}static eMa(ja,qb){return[new Bh.a(ja[0]._x-qb,ja[0]._y-qb),new Bh.a(ja[1]._x+qb,ja[1]._y-qb),new Bh.a(ja[2]._x+qb,ja[2]._y+
qb),new Bh.a(ja[3]._x-qb,ja[3]._y+qb)]}}Object(m.a)(Dg,"AnimationMarkerViewLegacy",null,[683,558,267,40]);var Oh=a(575),zf=a(1586),bh=a(1587),Ph=a(250);class Lh{constructor(ja,qb,V,Ea,Za,ia,Va,Ab){this.Q0e=this.Iwa=!1;this.r4=[];this.lTh=new Set;this.wCg=!0;if(!ja)throw Error.argumentNull("actionManager");if(!qb)throw Error.argumentNull("graphTopologyManager");if(!V)throw Error.argumentNull("slideReader");if(!Ea)throw Error.argumentNull("viewEventNotifier");if(!Za)throw Error.argumentNull("animationMarkerViewManager");
if(!ia)throw Error.argumentNull("activeSlideViewManager");if(!Va)throw Error.argumentNull("selectionManager");if(!Ab)throw Error.argumentNull("activeAppFrame");this.la=ja;this.ya=qb;this.qc=V;this.Mnd=Za;this.Oe=Ea;this.bT=this.ya.Ia;this.Oc=ia;this.sa=Va;this.hzg=oe.a("FixAnimationRibbonCrashIssue");this.Gb=Ab}initialize(){}dispose(){this.la=this.lTh=this.r4=this.bT=this.qc=this.sa=this.Oe=null}T5e(ja){this.wCg=ja}DEm(){if(!this.hzg||this.bT){var ja=this.sa.zd();this.qjd();var qb=this.bT.Nj(),V=
new Set;if(this.hzg){if(!qb)return;if(ja)for(const Ea of ja)V.add(Ea.id)}else for(const Ea of ja)V.add(Ea.id);for(const Ea of qb)V.has(Ea.id)?this.wri(Ea):this.dYk(Ea)}}Dmo(ja){this.iJa(this.Iwa);oe.a("FixAnimationSelectionCachingIssue")?this.Hmo(ja):this.EEm();oe.a("FixAnimationRibbonControlsRefreshLogic")?this.qUk():this.Oe.hJ(new Ph.a(7))}Wnn(ja,qb){if(qb&&ja&&ja.length){var V=this.RUe(ja[0]);this.wCg=!1;V?(qb=this.r4.filter(Ea=>!ja.includes(Ea.EffectNodeId)),this.qjd(),this.gwa(),this.qri(qb)):
(qb=this.qc.$Kh(ja,qb),this.Xpi(qb),qb=Object.assign([],this.r4),this.qjd(),this.gwa(),this.qri(qb));this.wCg=!0;this.la.Ra(Yc.a.Rwh,zf.a.execute,null)}}gwa(){const ja=this.sa.zd();this.sa.gwa(ja)}pri(ja,qb){qb&&ja&&(this.qjd(),ja=this.qc.$Kh(ja,qb),this.qri(ja),oe.a("FixRedundantSelectionChange")?this.wCg&&this.la.Ra(Yc.a.Rwh,zf.a.execute,null):this.la.Ra(Yc.a.Rwh,zf.a.execute,null))}RUe(ja){return this.lTh.has(ja)}Emo(ja){if(this.Iwa=!!ja&&0<=ja.indexOf("Animation"))this.Q0e=!0;this.iJa(this.Iwa);
this.Iwa?(this.DEm(),oe.a("FixAnimationRibbonControlsRefreshLogic")?this.qUk():this.Oe.hJ(new Ph.a(7))):this.qjd()}Fmo(ja){this.bT=ja;this.qjd();this.iJa(this.Iwa)}Hmo(ja){if(!this.hzg||this.bT)if(ja)this.EEm();else if((ja=this.sa.zd())&&ja.length){var qb=this.bT.Nj();if(qb&&qb.length){this.qjd();var V=new Set;for(const Ea of ja)V.add(Ea.id);for(const Ea of qb)V.has(Ea.id)?this.wri(Ea):this.dYk(Ea)}}}EEm(){if(!this.hzg||this.bT){var ja=this.sa.zd();this.qjd();var qb=this.bT.Nj();if(qb&&qb.length)if(ja&&
ja.length){var V=new Set;for(const Ea of ja)V.add(Ea.id);for(const Ea of qb)V.has(Ea.id)?this.wri(Ea):this.dYk(Ea)}else ja=this.bT.LYb(qb),ja.length&&(ja=ja.filter(Ea=>Ea.IsModifiedPreviously).map(Ea=>Ea.EffectNodeId),this.pri(ja,this.bT))}}qri(ja){if(ja&&this.bT){this.Xpi(ja);if(oe.a("RefreshMarkersInsteadOfComputeEffectSelection"))this.iJa(this.Iwa);else{var qb=this.bT.Nj();if(!qb||!qb.length)return;ja=new Map;for(var V of this.r4){var Ea=Of.a.Vf(V.ShapeId);if(!Ea){Pc.a.$(509620887,800,10,"EffectSelectionManager::addSelectedEffectHelper:  shape guid is null");
return}Ea=Ea.toString();ja.has(Ea)||ja.set(Ea,new Set);Ea=ja.get(Ea);null===Ea||void 0===Ea?void 0:Ea.add(V.EffectNodeId)}for(const Za of qb)if(V=this.Mnd.fca(Za))V.eDb(!1),qb=Za.id.toString(),(qb=ja.has(qb)?ja.get(qb):null)&&qb.size&&V.T9n(Array.from(qb))}oe.a("FixAnimationRibbonControlsRefreshLogic")?this.qUk():this.Oe.hJ(new Ph.a(7))}}qUk(){const ja={};ja.SetAnimationDuration=bh.a.ejc;ja.SetAnimationDurationMLR=bh.a.ejc;ja.SetAnimationDelay=bh.a.ejc;ja.SetAnimationDelayMLR=bh.a.ejc;ja.AnimationStart=
bh.a.SBh;ja.AnimationStartMLR=bh.a.SBh;ja.MoveEarlier=bh.a.PBh;ja.MoveLater=bh.a.PBh;ja.AnimationEffectOptions=bh.a.ZBh;ja.AnimationEffectOptionsMLR=bh.a.ZBh;ja.Animations=bh.a.i5h;ja.AnimationGallery=bh.a.e4h;this.Gb.CE(ja)}wri(ja){if(ja){var qb=this.qc.Hg(ja);qb&&(qb=qb.DIb(ja),this.Xpi(qb),ja=this.Mnd.fca(ja),this.hzg&&!ja||ja.eDb(!0))}}dYk(ja){ja&&(ja=this.Mnd.fca(ja))&&ja.eDb(!1)}Xpi(ja){if(ja&&ja.length)for(const qb of ja)this.RUe(qb.EffectNodeId)||(this.r4.push(qb),this.lTh.add(qb.EffectNodeId))}eWl(ja,
qb,V,Ea=!1,Za=!0){if(qb=this.Mnd.fca(qb))qb.visible=ja,Ea?qb.l4n(V,Za):qb.WCe()}yXa(ja){ja&&(ja=this.Mnd.fca(ja))&&ja.tBc()}iJa(ja,qb=null,V,Ea=!0){if(this.Q0e&&this.bT&&this.bT.dW&&this.Oc.jd&&this.Oc.jd.Vyf)if(qb)this.eWl(ja,qb,V,!0,Ea);else if((qb=this.bT.Nj())&&qb.length)for(const Za of qb)this.eWl(ja,Za)}qjd(){this.lTh.clear();this.r4.length=0}}Object(m.a)(Lh,"EffectSelectionManager",null,[681,40]);class wi{constructor(){this.ga=null;this.Jod=!1}get name(){return"PowerPointWebEditor.Animations"}oc(ja){this.ga=
ja;(this.Jod=this.ga.resolve("PowerPointWebEditor.IApplicationContext").Pd.pTb)?(this.ga.register(525,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>").oa().pa(()=>new Oh.a((qb,V)=>{let Ea=null;const Za=Object(Rb.a)(112,qb.yc(this.ga.resolve("Box4.IPageView").Ua));Za&&!Za.isDisposed&&Za.va&&(Ea=new di(qb,this.ga.resolve("PowerPointWebEditor.ISlideReader"),this.ga.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.ga.resolve("Box4.IParagraphReader"),
Object(da.a)(Za,Za.IR,"takeOwnershipOfSubtree"),this.ga.resolve("Box4.IPageView").Ua,this.ga.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.ga.resolve("Common.MouseInputManager"),this.ga.resolve("Common.IClickInputManager"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),n.AFrameworkApplication.Zd,this.ga.resolve("PowerPointWebEditor.IPPTUnitConversion"),V,()=>{Za.NNa()},this.ga.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager"),this.ga.resolve("PowerPointWebEditor.IZoomContext"),
this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")),Ea.Yq(Za.va),Ea.setZIndex(4),Ea.visible=!1,Za.IR(Ea.ge.va,!0),Za.uHb(Ea,4));return Ea})),this.ga.register(Lh,"PowerPointWebEditor.Animations.IEffectSelectionManager").oa().pa(()=>new Lh(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.ISlideReader"),this.ga.resolve("PowerPointWebEditor.View.IViewEventSource"),
this.ga.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>"),this.ga.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),this.ga.resolve("Box4.IAppFrame")))):(this.ga.register(525,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>").oa().pa(()=>new Oh.a((qb,V)=>{let Ea=null;const Za=Object(Rb.a)(112,
qb.yc(this.ga.resolve("Box4.IPageView").Ua));Za&&!Za.isDisposed&&Za.va&&(Ea=new Dg(qb,this.ga.resolve("PowerPointWebEditor.ISlideReader"),this.ga.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.ga.resolve("Box4.IParagraphReader"),Object(da.a)(Za,Za.IR,"takeOwnershipOfSubtree"),this.ga.resolve("Box4.IPageView").Ua,this.ga.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.ga.resolve("Common.MouseInputManager"),this.ga.resolve("Common.IClickInputManager"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),
n.AFrameworkApplication.Zd,this.ga.resolve("PowerPointWebEditor.IPPTUnitConversion"),V,()=>{Za.NNa()}),Ea.Yq(Za.va),Ea.setZIndex(4),Ea.visible=!1,Za.IR(Ea.ge.va,!0),Za.uHb(Ea,4));return Ea})),this.ga.register(Yg,"PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").oa().pa(()=>new Yg(this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("PowerPointWebEditor.ISlideReader"),this.ga.resolve("Box4.Graph.IGraphInstance").Xd(8),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.ga.resolve("PowerPointWebEditor.View.IViewEventSource"),this.ga.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>"),this.ga.resolve("PowerPointWebEditor.IActiveSlideViewManager"))))}init(){this.Jod?this.ga.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").initialize():this.ga.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").initialize()}dispose(){this.Jod?this.ga.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").dispose():
this.ga.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").dispose()}static main(){I.a.instance.Jc(Xc.a(new wi,0))}}Object(m.a)(wi,"PPTWebEditorAnimationsPackage",null,[4,5]);var Zg=a(1178),Rg=a(149);class ji{constructor(ja,qb,V,Ea,Za){this.la=ja;this.Na=qb;this.Kck=V;this.rc=Ea;this.nhb=Za}Kb(){this.la.Ba(Yc.a.find,ad.a.view,Object(da.a)(this,this.findText,"findText"));this.la.Ba(Yc.a.find,ad.a.notes,Object(da.a)(this,this.findText,"findText"));this.la.Ba(Yc.a.find,ad.a.sg,Object(da.a)(this,
this.findText,"findText"));this.la.Ba(Xa.a.rKh,ad.a.view,Object(da.a)(this,this.rKh,"findInDocument"));this.la.we(Yc.a.find,0);this.la.Ba(Yc.a.uua,ad.a.view,Object(da.a)(this,this.uua,"replaceText"));this.la.Ba(Yc.a.uua,ad.a.notes,Object(da.a)(this,this.uua,"replaceText"));this.la.Ba(Yc.a.uua,ad.a.sg,Object(da.a)(this,this.uua,"replaceText"));this.la.we(Yc.a.uua,4)}Ae(){const ja=[this.Na.Uc(oe.a("FindReplaceInNewThumbnail")?ee.a.TA:Rg.a.lR),this.Na.Uc(Rg.a.Xva),this.Na.Uc(ee.a.sh),this.Na.Uc(ee.a.DV)];
for(const qb of ja)qb.bindAction(ub.a.hb(xa.a.Ima,ub.a.Ne),Yc.a.find),qb.bindAction(ub.a.hb(xa.a.KGb,ub.a.Ne),Yc.a.uua)}findText(ja,qb,V){return qb.contextId!==ad.a.view&&qb.contextId!==ad.a.notes&&qb.contextId!==ad.a.sg?2:1===V?this.rc.zl()?32:8:oe.a("FindReplaceInNewThumbnail")&&1===this.nhb.fj?2:2===V?(this.Kck.rBm(qb),Pc.a.$(539773087,820,50,"FindTextDialog is initialized."),32):8}uua(ja,qb,V){return qb.contextId!==ad.a.view&&qb.contextId!==ad.a.notes&&qb.contextId!==ad.a.sg?2:1===V?this.rc.zl()?
32:8:oe.a("FindReplaceInNewThumbnail")&&1===this.nhb.fj?2:2===V?(this.Kck.Mgo(qb),Pc.a.$(539773088,820,50,"ReplaceTextDialog is initialized."),32):8}rKh(ja,qb,V,Ea,Za){if(qb.contextId!==ad.a.view&&qb.contextId!==ad.a.notes&&qb.contextId!==ad.a.sg)return 2;if(1===V)return 32;if(2===V){if(!Za)return 8;ja=Za.CommandValueId||"";Pc.a.$(539773089,820,50,"Find. ActionData QueryLength: {0}",ja.length);this.Kck.Dgo(qb,ja);Pc.a.$(539773090,820,50,"FindTextDialog is initialized from Search Box.");return 32}return 8}}
Object(m.a)(ji,"FindReplaceTextActor",null,[502]);var Xh=a(1889);class kh extends Xh.a{constructor(ja,qb,V){super(!1,!0);this.Xbk=!1;this.jTh=null;this.h0e=!1;this.Rdm=this.xem=null;this.Jck=!0;this.Vck=this.Wck=this.Uck=!1;this.s8b=null;this.YSh=!1;this.ilk=!0;this.Uhm=this.Wfk=!1;this.ahm=this.chm=null;this.ngm=0;this.Na=ja;this.Pvb=qb;this.fHn="FindReplaceTextDialog";this.OIa=ResourceStrings.l_FindTextTitle;V&&(this.OIa=ResourceStrings.l_ReplaceTextTitle);this.Yfk=V;this.j$=!1}rEb(){this.qp(this.OIa,
this.Pvb,this.Jqb());this.Xbk=!1}dispose(){super.dispose();this.Xbk=!0}o8m(){this.Uck=this.Jck=!1;this.QZa(this.OIa,this.Pvb,this.Jqb())}CZl(ja){ja&&(this.Na.Ag(rb.AFrame.UEa),this.Uck=!0);this.Jck=!0;this.QZa(this.OIa,this.Pvb,this.Jqb())}$Mh(){this.hide()}iao(ja){this.jTh=ja.searchString;this.h0e=ja.matchCase;this.s8b=ja.replaceString}isDisposed(){return this.Xbk}Gsd(ja,qb){this.Rdm=ja;this.ngm=qb;this.Uhm=0===qb;this.QZa(this.OIa,this.Pvb,this.Jqb())}EZh(ja){this.xem=ja;this.QZa(this.OIa,this.Pvb,
this.Jqb())}TZh(ja){this.chm=ja;this.QZa(this.OIa,this.Pvb,this.Jqb())}Sbl(ja){this.ahm=ja;this.QZa(this.OIa,this.Pvb,this.Jqb())}get usd(){return this.jTh}set usd(ja){this.jTh=ja}get matchCase(){return this.h0e}set matchCase(ja){this.h0e=ja}get T_k(){return this.s8b}set T_k(ja){this.s8b=ja}W9m(ja){ja&&(this.Na.Ag(rb.AFrame.UEa),this.Wck=!0);this.YSh=!0;this.QZa(this.OIa,this.Pvb,this.Jqb())}ZZi(){this.Wck=this.YSh=!1;this.QZa(this.OIa,this.Pvb,this.Jqb())}V9m(ja){ja&&(this.Na.Ag(rb.AFrame.UEa),this.Vck=
!0);this.ilk=!0;this.QZa(this.OIa,this.Pvb,this.Jqb())}q8m(){this.Vck=this.ilk=!1;this.QZa(this.OIa,this.Pvb,this.Jqb())}Qho(){this.OIa=ResourceStrings.l_ReplaceTextTitle;this.Yfk=!0;this.YSh=!1;this.QZa(this.OIa,this.Pvb,this.Jqb());this.Na.Ag(rb.AFrame.UEa)}U9m(){this.Wfk=!0;this.QZa(this.OIa,this.Pvb,this.Jqb())}Ien(){return{["searchString"]:this.jTh,["findNextButtonAriaLabel"]:this.xem,["errorMessage"]:this.Rdm,["findNextButtonIsEnabled"]:this.Jck,["focusFindNextButton"]:this.Uck,["focusDialog"]:Object(da.a)(this,
this.bcn,"focusDialog"),["isReplaceActive"]:this.Yfk,["replaceButtonIsEnabled"]:this.YSh,["replaceAllButtonIsEnabled"]:this.ilk,["showMessageAsError"]:this.Uhm,["messageStatus"]:this.ngm,["focusReplaceButton"]:this.Wck,["focusReplaceAllButton"]:this.Vck,["replaceButtonAriaLabel"]:this.chm,["replaceAllButtonAriaLabel"]:this.ahm,["readOnlyModeEnabled"]:this.Wfk}}Jqb(){return{["id"]:this.fHn,["bodyControls"]:this.Ien(),["isModal"]:!1}}bcn(){this.Na.Ag(rb.AFrame.UEa)}}Object(m.a)(kh,"ReactFindReplaceTextDialog",
Xh.a,[719]);class mi{constructor(ja){this.Na=ja}getInstance(ja,qb){return new kh(this.Na.value,ja,qb)}}Object(m.a)(mi,"FindReplaceTextDialogFactory",null,[669]);class rg{constructor(){this.Lib=this.ILb=this.paragraphIndex=this.jJa=this.slideIndex=0}reset(){this.slideIndex=this.jJa=this.paragraphIndex=0;this.ILb=this.Lib=-1}clone(){const ja=new rg;ja.slideIndex=this.slideIndex;ja.jJa=this.jJa;ja.paragraphIndex=this.paragraphIndex;ja.ILb=this.ILb;ja.Lib=this.Lib;return ja}}Object(m.a)(rg,"TextPosition",
null,[]);class Ji{constructor(){this.Bgk=this.CQh=null;this.XGa=new rg;this.zD=new rg;this.state=this.slideCount=0;this.BUe=this.$4i=!1;this.pattern=this.oNf=this.qNf=null;this.matchCase=!1;this.reset()}reset(){this.slideCount=0;this.XGa.reset();this.zD.reset();this.state=0;this.BUe=this.$4i=!1;this.Bgk=this.Ckc=this.oNf=this.qNf=null}get Ckc(){return this.CQh}set Ckc(ja){if(this.CQh=ja)this.Bgk=this.CQh}get Zzn(){return this.Bgk}}Object(m.a)(Ji,"FindContext",null,[]);var Ki=a(63),Li=a(105);class jj{constructor(){this.ShouldMatchCase=
!1}}Object(m.a)(jj,"MatchTextInfo",null,[]);class aj{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.OldStr=this.NewStr=this.MatchTxtInfo=null}}Object(m.a)(aj,"ReplaceAllTextInfo",null,[]);var mj=a(1417),ri=a(168),xi=a(764),yi=a(369);class vh{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd,yd,Md,te,Pe,t,L,S,ka,ra,xb,Ob){this.sXc=this.MD=this.QJ=null;this.ui=new Ji;this.s8b=this.e4="";this.RDg=!1;this.F0e=this.ine=0;this.E0e=Date.now();this.XSh=-1;this.Ick=0;this.MSh=-1;this.la=ja;this.Gvg=
qb;this.Na=V;this.pr=Ea;this.rc=Za;this.La=ia;this.uq=Va;this.Dmc=Ab;this.zb=gc;this.Yb=Hc;this.jc=fd;this.ya=hd;this.Vb=yd;this.Tb=Pe;this.Oe=Md;this.As=te;this.HI=t;this.KSa=L;this.bgm=S;this.doe=ka;this.YFn=ra;this.PJ=Ob;this.bhm=xb}rBm(ja){this.QJ=ja;this.MD=this.bgm.value.getInstance(Object(da.a)(this,this.F0l,"findReplaceTextDialogResultHandler"),!1);this.e4&&(this.MD.usd=this.e4,this.MSh=-1);this.MD.rEb();3!=this.la.mode&&this.MD.U9m();this.cnd()&&this.WZi()}Dgo(ja,qb){this.cnd()||(this.e4=
qb);this.rBm(ja);this.cnd()||(this.MD.usd=this.e4,this.MD.rEb(),this.uul(qb,!1))}Mgo(ja){this.QJ=ja;this.MD=this.bgm.value.getInstance(Object(da.a)(this,this.F0l,"findReplaceTextDialogResultHandler"),!0);this.e4&&(this.MD.usd=this.e4);this.MD.rEb();this.cnd()&&this.WZi()}F0l(ja,qb){if(qb)switch(this.MD.iao(qb),ja){case 1:this.AQn();break;case 2:this.BQn();break;case 3:this.CQn(this.MD.T_k);break;default:this.beo(),this.clearSelection(),this.ui.reset(),this.MD.$Mh()}else Pc.a.$(512496416,820,10,"Got null control value for findreplace dialog")}D6l(){return this.ui.qNf&&
this.Ioi!==this.ui.qNf.Dh}uul(ja,qb){this.pYl();if(0===this.ui.state||3===this.ui.state||ja!==this.e4||qb!==this.RDg||this.D6l())this.fun(ja,qb),this.MSh=-1;this.ui.BUe=!1;this.DVh()}get Ioi(){return this.ya.Ia?this.ya.Ia.Dh:0}fun(ja,qb){const V=ja===this.e4&&3===this.ui.state&&!this.D6l(),Ea=this.ui.XGa.clone();this.ui.reset();this.e4=ja;this.RDg=qb;V?this.ui.XGa=Ea.clone():(this.ui.XGa.slideIndex=this.Ioi,this.phn());this.ui.zD=this.ui.XGa.clone()}DVh(){this.Kbn(this.e4,this.RDg)?4!==this.ui.state&&
this.setSelection():(r.ULS.sendTraceTag(539829126,820,50,"Text not found"),this.ySf())}Kbn(ja,qb){var V=this.ya.presentation;if(!V)throw Error.argumentNull("Presentation is null");if(V=V.slides||[],V.length){this.ui.slideCount=V.length;const Ea=V.length+this.ui.XGa.slideIndex;for(;this.ui.zD.slideIndex<=Ea;){const Za=this.ui.zD.slideIndex%V.length,ia=this.Mbn(V[Za],ja,qb,this.ui.zD.slideIndex===Ea?this.ui.XGa.jJa:vh.krk);if(ia&&(this.ui.qNf=this.rc.pl(ia.fc)))return!0;if(7===this.ui.state)return this.ui.BUe&&
(Pc.a.$(512496414,820,50,"call into PerformBackendFind recursively."),this.ui.state=0),this.NWn(V[Za]?V[Za].fc:null,ja,qb);if(3===this.ui.state)break;let Va;(Va=this.ui.zD).slideIndex=Va.slideIndex+1;this.ui.zD.jJa=0}}else this.ui.state=1;return!1}Mbn(ja,qb,V,Ea){if(!ja)return null;var Za=this.rc.pl(ja.fc),ia=this.Vb.Lc(Za);Za=Za.l_b()||[];(ia=ia.Fb(27))&&Za.push(ia);if(!Za.length)return this.ui.state=7,null;for(;this.ui.zD.jJa<=Math.min(Za.length-1,Ea);){if(this.ui.oNf=this.Lbn(Za[this.ui.zD.jJa],
qb,V,this.ui.zD.jJa===Ea?this.ui.XGa.paragraphIndex:vh.krk))return ja;let Va;(Va=this.ui.zD).jJa=Va.jJa+1;this.ui.zD.paragraphIndex=0}return null}Lbn(ja,qb,V,Ea){if(!this.uq.Bgb(ja)&&ja.LA)return null;const Za=Li.a.createInstance(ja);let ia=0;for(;Za.moveNext()&&this.ui.zD.paragraphIndex<=Ea;){const Va=Za.currentNode;if(Wf.ParagraphReader.ue(Va)&&ia++===this.ui.zD.paragraphIndex){if(this.ui.Ckc=this.Ibn(Va,qb,V,this.ui.zD.paragraphIndex===Ea?this.ui.XGa.ILb:vh.krk))return ja;let Ab;(Ab=this.ui.zD).paragraphIndex=
Ab.paragraphIndex+1;this.ui.zD.ILb=this.ui.zD.Lib=-1}}return null}Ibn(ja,qb,V,Ea){if(!Wf.ParagraphReader.ue(ja))return null;let Za=ja.zld();if(!Za.length)return null;Za=Za.substring(0,Math.min(Za.length,Ea));return this.Nbn(Za,Math.max(0,this.ui.zD.Lib),qb,V)?ja:null}Nbn(ja,qb,V,Ea){let Za=ja,ia=V;Ea||(Za=ja.toLowerCase(),ia=V.toLowerCase());ja=Za.indexOf(ia,-1===qb?0:qb);if(-1!==ja)return this.ui.zD.ILb=ja,this.ui.zD.Lib=ja+ia.length,this.ui.state=2,this.ui.$4i=!0;this.ui.state=1;return!1}phn(){var ja=
ri.b(this.QJ);ja=ja?ja.Ob:null;if(!ja||!ja.Wa)r.ULS.sendTraceTag(512496411,820,50,"There could be no slide at all");else if(ja.Wa.qb){var qb=ja.Wa.qb.Ya;if(Wf.ParagraphReader.ue(qb.node)){ja=Object(Rb.a)(352,qb.node);this.ui.XGa.ILb=qb.Xa;this.ui.XGa.Lib=qb.Xa;const V=this.La.cna(qb.node);V?(this.ui.XGa.jJa=V.get_zIndex()-1,this.ui.XGa.paragraphIndex=this.I3l(ja)):this.uq.NZb(qb.node)&&(qb=this.ya.Ia?this.ya.Ia.l_b():null,this.ui.XGa.jJa=qb?qb.length:0,this.ui.XGa.paragraphIndex=this.I3l(ja))}else this.La.yYa(qb.node)&&
(this.ui.XGa.jJa=qb.node.get_zIndex()-1)}}I3l(ja){ja=this.Vb.Lc(ja);if(!ja.M1(V=>10===V.type||60===V.type||16===V.type))return 0;ja.Bc();const qb=ja.Bq;ja.Bc();return Math.max(0,ja.bYa(qb))}Yjm(){const ja=this.ya.presentation;if(!ja)throw Error.argumentNull("Presentation is null");return this.ui.XGa.slideIndex||this.ui.XGa.jJa?this.ui.zD.slideIndex<(ja.slides||[]).length:!1}A5l(){const ja=this.ya.presentation;if(!ja)throw Error.argumentNull("Presentation is null");this.ui.zD.slideIndex=ja.slides?
ja.slides.length:0;this.ui.BUe=!1;this.DVh()}sOh(){return this.MD.isDisposed()}pQn(ja){if(!this.sOh()){Pc.a.$(512496409,820,50,"OnBackendFindSucceeded");var qb=Xe.a.empty;({slideId:qb}=Xe.a.Rvl(ja));(ja=this.rc.agb(qb))?(qb=ja.slideIndex,qb>this.ui.XGa.slideIndex&&qb<this.ui.zD.slideIndex?this.ySf():this.jc.Ia!==ja?(this.pr.Hha(Object(da.a)(this,this.C1e,"onActiveSlideDomChanged")),this.jc.Ia=ja):(this.ui.state=5,this.ui.BUe=!0,this.ui.zD.slideIndex=this.ui.zD.slideIndex>qb?qb+this.ui.slideCount:
qb,this.ui.zD.jJa=0,this.ui.zD.paragraphIndex=0,this.ui.zD.ILb=-1,this.ui.zD.Lib=-1,this.DVh())):this.Yjm()?this.A5l():this.ySf()}}C1e(){Pc.a.$(512496408,820,50,"OnActiveSlideDomChanged");this.pr.Cbb(Object(da.a)(this,this.C1e,"onActiveSlideDomChanged"));this.sOh()||this.sXc||(this.sXc=new jc.a(3,1,0,Object(da.a)(this,this.Ezk,"onPostActiveSlideDomChangedTask"),90,"30"),this.Yb.Rb(this.sXc))}Ezk(){Pc.a.$(512496407,820,50,"OnPostActiveSlideDomChangedTask");this.sXc=null;if(!this.sOh())if(4===this.ui.state){const ja=
this.Ioi;this.ui.zD.slideIndex=this.ui.zD.slideIndex>ja?ja+this.ui.slideCount:ja;this.ui.state=5;this.ui.BUe=!0;this.DVh()}else 2===this.ui.state?this.setSelection():this.ySf()}oQn(){this.sOh()||(Pc.a.$(512496406,820,50,"OnBackendFindFailed"),this.Yjm()?this.A5l():this.ySf())}NWn(ja,qb,V){Pc.a.$(512496405,820,50,"PerformBackendFind");this.Gvg.findText(qb,V,ja.toString(),Object(da.a)(this,this.pQn,"onBackendFindSucceeded"),Object(da.a)(this,this.oQn,"onBackendFindFailed"));this.ui.state=4;return!0}ySf(){this.ui.state=
this.ui.$4i?3:1;Pc.a.$(512496404,820,50,"End of Find: {0}",this.ui.state);this.clearSelection();this.Gsd(0,"")}getShapeType(ja){return ja.yr?ResourceStrings.L_TextBox:ja.Im?ResourceStrings.l_Chart:ja.gd?ResourceStrings.L_Table:ja.xg?ResourceStrings.L_SmartArt:ja.xm?ResourceStrings.L_Media:ja.Pg?ResourceStrings.l_Picture:ja.Bl?ResourceStrings.l_Placeholder:ResourceStrings.l_ShapeObject}setSelection(){var ja=this.ui.Ckc,qb=this.ui.qNf;if(this.jc.Ia!==qb)this.pr.Hha(Object(da.a)(this,this.C1e,"onActiveSlideDomChanged")),
this.jc.Ia=qb;else{ja=Ki.SelectionFactory.z$(ja,this.ui.zD.ILb,this.ui.zD.Lib);if(this.uq.Bgb(this.ui.oNf))this.la.Ra(Yc.a.tVa,2,new mj.a(!0)),this.Na.Ag(Rg.a.Xva),this.Dmc.setSelection(ja),this.Gsd(this.ui.zD.slideIndex%this.rc.zl()+1,ResourceStrings.l_NotesPaneType);else{qb=this.ui.oNf;const V=this.ui.oNf.Vg(this.zb.Ua);if(V)if(V.isLocked){let Ea;(Ea=this.ui.zD).jJa=Ea.jJa+1;this.ui.zD.paragraphIndex=0;this.ui.zD.ILb=0;this.ui.zD.Lib=0;V.xEb()}else this.YFn&&qb.xg?(this.Oe.JXh(new yi.a(qb)),this.KSa.setSelection(ja)):
(this.Na.Ag(ee.a.sh),this.zb.setSelection(ja));this.Gsd(this.ui.zD.slideIndex%this.rc.zl()+1,this.getShapeType(qb))}Pc.a.$(512496402,820,50,"Find Text: {0}/{1}/{2}/({3},{4} )",this.ui.zD.slideIndex,this.ui.zD.jJa,this.ui.zD.paragraphIndex,this.ui.zD.ILb,this.ui.zD.Lib);this.y2i()}}clearSelection(){var ja=ri.b(this.QJ);if(ja=ja?ja.Ob:null){var qb=this.ui.Zzn;qb&&(qb=Ki.SelectionFactory.Mg(qb,0),ja.setSelection(qb))}else Pc.a.$(512496401,820,10,"Find Replace Text: Selection manager received as null when clearing selection")}Gsd(ja,
qb){const V=new Sys.StringBuilder,Ea=new Sys.StringBuilder;let Za=!1;ja!=this.MSh?(this.MSh=ja,this.Ick=1):this.Ick++;switch(this.ui.state){case 1:Za=!0;V.append(ResourceStrings.l_FindTextNotFound);break;case 3:V.append(ResourceStrings.l_FindTextFindOver);break;case 6:Za=!0;V.append(ResourceStrings.l_FindTextFindAgain);break;case 2:Ea.append(String.format(ResourceStrings.l_FindTextMessageWithCount,this.Ick,ja,qb));break;default:Pc.a.$(512496400,820,50,"Find Text: {0}",this.ui.state)}this.bbo(V.toString(),
Za,Ea.toString());this.y2i()}gko(ja){ja=this.A7n(ja);32===ja&&this.uul(this.e4,this.RDg);16===ja&&(this.MD.Gsd(ResourceStrings.l_ReplaceTextErrorMessage,0),this.MD.ZZi(),this.MD.CZl(!0))}A7n(ja){return Uf.a.gUf("SingleReplaceAction",Yc.a.uua,()=>{ja||(ja="",Pc.a.$(512496399,820,50,"Replacing with empty string"));var qb=this.ui.Ckc;if(!qb)return Pc.a.$(512496398,820,10,"ParagraphNode not set in findContext"),16;var V=this.ui.zD.ILb;const Ea=this.ui.zD.Lib;if(-1===V||-1===Ea)return Pc.a.$(512496397,
820,10,"Invalid start or end position of current text selection."),16;const Za=this.As.xe(15);oe.a("FixDesignerCrashViaSetUndoActionId")&&(Za.wc=Yc.a.uua);Za.ld(qb);this.HI.replaceTextRange(re.a.createTextRange(qb,V,Ea),ja,!0,!1,Yc.a.uua);qb=V+ja.length;V=qb!==this.ui.zD.Lib;this.ui.zD.Lib=qb;Za.dispose();V&&this.setSelection();return 32})}y2i(){this.MD.CZl(1===this.ine);this.GZl();this.MD.V9m(3===this.ine)}GZl(){this.ui.Ckc?this.MD.W9m(2===this.ine):this.MD.ZZi()}pYl(){this.MD.o8m();this.MD.ZZi();
this.MD.q8m()}bbo(ja,qb,V){2===this.ine?(this.MD.TZh(ResourceStrings.l_ReplaceTextReplaced+". "+V),this.MD.EZh("")):(this.MD.EZh(V),this.MD.TZh(""));this.MD.Sbl("");this.MD.Gsd(ja,qb?0:1)}Q$m(ja,qb){const V=Uf.a.Xk("FindNext");V.Za("CommandId",ja.toString());V.Za("IsReadOnlyModeEnabled",this.MD.Wfk.toString());try{qb()}finally{V.finish(!0)}}AQn(){za.a.wb(this.MD.usd)||this.Q$m(Yc.a.find,()=>{Pc.a.$(512496396,820,50,"Find Text Started");this.ine=1;this.uul(this.MD.usd,this.MD.matchCase);return 32})}BQn(){this.MD.Yfk?
(Pc.a.$(512496394,820,50,"Replace Text Started"),this.ine=2,this.gko(this.MD.T_k)):(this.MD.Qho(),Pc.a.$(512496395,820,50,"Find dialog switched to replace dialog"),this.GZl())}CQn(ja){this.cnd()?Pc.a.$(512496393,820,10,"ReplaceAll Already in progress. ReplaceAllStartTime:{0}, Time diff:{1}",this.F0e,Date.now()-this.F0e):za.a.wb(this.MD.usd)||(oe.a("FixReplaceAllTimeOutError")&&(this.ya.presentation.Gbb=-16),this.e4=this.MD.usd,this.s8b=ja?ja:"",this.F0e=Date.now(),this.ine=3,this.WZi(),this.qbn(this.ya.Ia,
this.e4,this.s8b,this.RDg),0<this.bhm&&(this.XSh=window.setTimeout(()=>{this.cnm()},this.bhm)),16===this.replaceAll()&&(this.E0e=Date.now(),this.vUl(),this.cnm()))}replaceAll(){return Uf.a.gUf("ReplaceAllAction",Yc.a.uua,()=>{Pc.a.$(512496392,820,50,"ReplaceAll Text Started");const ja=this.ya.presentation;if(ja){const qb=this.Tb.Kd(15);oe.a("FixDesignerCrashViaSetUndoActionId")&&(qb.wc=Yc.a.uua);try{qb.tc(ja),this.doe.Rm(Object(da.a)(this,this.bve,"onPresentationPropertyChange")),ja.dLb=Object.assign(new aj,
{NewStr:this.s8b,OldStr:this.e4,ActiveSlideCid:this.ya.Ia.cid,ActiveSlideSid:this.ya.Ia.sid,MatchTxtInfo:Object.assign(new jj,{ShouldMatchCase:this.MD.matchCase})})}finally{qb&&qb.dispose()}return 32}return 16})}qbn(ja,qb,V,Ea){if(ja){ja=this.rc.pl(ja.fc);var Za=this.Vb.Lc(ja);ja=ja.l_b()||[];(Za=Za.Fb(27))&&ja.push(Za);if(ja.length)for(Za=0;Za<=ja.length-1;)this.Pbn(ja[Za],qb,V,Ea),Za++}else Pc.a.$(512496391,820,50,"slide must not be null.")}Pbn(ja,qb,V,Ea){if(this.uq.Bgb(ja)||!ja.LA)for(ja=Li.a.createInstance(ja);ja.moveNext();){const Za=
ja.currentNode;if(!Wf.ParagraphReader.ue(Za))continue;let ia=null;(ia=this.Jbn(Za,qb,Ea))&&ia.characterData.replace(qb,V)}}Jbn(ja,qb,V){if(!Wf.ParagraphReader.ue(ja))return Pc.a.$(512496390,820,50,"node must be ParagraphNode"),null;const Ea=ja.zld();return Ea.length?this.Obn(Ea,qb,V)?ja:null:null}Obn(ja,qb,V){let Ea=ja,Za=qb;V||(Ea=ja.toLowerCase(),Za=qb.toLowerCase());return-1!==Ea.indexOf(Za,0)?!0:!1}bve(ja,qb){if(!this.cnd())Pc.a.$(512496389,820,50,"ReplaceAll Not Iniitated");else if(qb.property===
Rf.a.K4e){this.vUl();ja=Object(Rb.a)(568,qb.node);if(-1!==ja.Gbb){var V=2;if(0===ja.Gbb){qb=ResourceStrings.l_FindTextNotFound;var Ea=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchMessage;V=0;var Za=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchTitle}else 1===ja.Gbb?(qb=String.format(ResourceStrings.l_ReplaceAllSuccessSingular,ja.Gbb,this.e4,this.s8b),Ea=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessageSingular,ja.Gbb,this.e4,this.s8b)):(qb=String.format(ResourceStrings.l_ReplaceAllSuccessPlural,
ja.Gbb,this.e4,this.s8b),Ea=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessagePlural,ja.Gbb,this.e4,this.s8b)),Za=ResourceStrings.l_ReplaceAllCalloutNotificationSuccessTitle}else Za=ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,qb=Ea=ResourceStrings.l_ReplaceAllErrorMessage,V=0,Pc.a.$(512496388,820,10,"Invalid ReplaceAllTextCount");this.E0e=Date.now();Pc.a.$(512496387,820,50,"Time taken for Replace All operation in ms: {0}",this.E0e-this.F0e);this.BZl(qb,V);this.doe.rr(Object(da.a)(this,
this.bve,"onPresentationPropertyChange"));this.MD.isDisposed()&&this.Gil(Za,Ea,10);ja.Gbb=-16}}cnd(){return this.F0e>this.E0e}WZi(){var ja=String.format(ResourceStrings.l_ReplaceAllInProgress,this.e4);this.MD.Gsd(ja,3);ja=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceAllTextReplaceAll,this.e4);this.MD.Sbl(ja);ja=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceTextReplace,this.e4);this.MD.TZh(ja);
ja=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_FindTextFindNext,this.e4);this.MD.EZh(ja);this.pYl()}BZl(ja,qb){this.MD.Gsd(ja,qb);this.MD.Sbl(ja);this.MD.TZh("");this.MD.EZh("");this.y2i()}beo(){if(this.cnd()){var ja=String.format(ResourceStrings.l_ReplaceAllInProgress,this.e4);this.Gil(ResourceStrings.l_ReplaceAllCalloutNotificationProgressTitle,ja,1024)}}Gil(ja,qb,V){this.PJ?(this.PJ.VPf(),Pc.a.$(512496385,820,50,"Callout notification called for Replace All operation"),
ja=Object.assign(new xi.a,{title:ja,message:qb,timeoutInSeconds:V}),ja=this.PJ.sJe(ja),ja.kCa&&Pc.a.$(512496384,820,10,"Error in callout notification: Error:{0}",ja.message)):Pc.a.$(512496386,820,10,"Find Replace Text: m_calloutNotification adapter is null.")}cnm(){let ja=!1;this.cnd()&&(ja=!0,this.E0e=Date.now());Pc.a.$(512496355,820,10,"Error returned in replace all operation. ReplaceAll Timeout: {0}, Time taken in ms: {1}",ja,this.E0e-this.F0e);this.BZl(ResourceStrings.l_ReplaceAllErrorMessage,
0);this.doe.rr(Object(da.a)(this,this.bve,"onPresentationPropertyChange"));this.MD.isDisposed()&&this.Gil(ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,ResourceStrings.l_ReplaceAllErrorMessage,10);this.ya.presentation.Gbb=-16}vUl(){-1!==this.XSh&&(window.clearTimeout(this.XSh),this.XSh=-1)}}vh.krk=1024;Object(m.a)(vh,"FindReplaceTextHandler",null,[670]);class Hg{constructor(ja){this.kgm=this.dim=null;this.h0e=!1;this.Yfa=ja}findText(ja,qb,V,Ea,Za){this.kgm=ja;this.h0e=qb;this.dim=V;this.Yfa.GO(Ea,
Za,null)}get Ngo(){return this.dim}get matchCase(){return this.h0e}get Xqe(){return this.kgm}}Object(m.a)(Hg,"FindTextManager",null,[668]);var Zf=a(473),Ci=a(133);class wh extends Ci.a{constructor(){super();this.MatchText=null;this.MatchCase=!1;this.SlideID=null}lo(){return 54}static pJf(ja,qb,V){const Ea=new wh;Ea.SlideID=V;Ea.MatchText=ja;Ea.MatchCase=qb;return Ea}}Object(m.a)(wh,"FindTextRequest",Ci.a,[]);class xh extends Zf.a{constructor(ja,qb,V,Ea){super();this.yJb=this.WJb=null;this.yW=this.Zca=
!1;this.ssg=null;this.le=V;this.UPh=!1;this.Gvg=qb;this.pb=Ea;this.Mq=ja;this.enabled=2;this.Mq.register(this)}GO(ja,qb){this.UPh=!0;this.WJb=ja;this.yJb=qb;this.Mq.nea()}forceOutbound(){}LBa(){return this.UPh&&!this.Zca}lN(){return!1}K5a(){return this.ve&&2===this.ve.status?!0:this.LBa()}Cec(){if(1===this._state)this.ssg=this.pb.podSessionId,this.ve.eH=wh.pJf(this.Gvg.value.Xqe,this.Gvg.value.matchCase,this.Gvg.value.Ngo),this.ve.status=1,this._state=3;else if(3===this._state&&this.ve&&2===this.ve.status){if(2!==
this.ve.statusCode)this.YO();else{if(!this.ve.$u||1!==this.ve.$u.length){this.YO();return}const ja=this.ve.$u[0];0===ja.StatusCode?(this.o9(),this.WJb&&this.WJb(ja.SlideID)):(this.YO(ja),124===ja.StatusCode&&this.le.Vs(ja.ServerError,this.ssg))}this.ssg=null}}YO(ja=null){this.UPh=!1;this._state=1;Pc.a.$(507843426,824,15,"FindTextRequest failed. OperationResult:{0}, RequestStatus:{1}, HttpStatusCode:{2}, IsLastReplicationFailed:{3}, PodSessionId:{4}",ja?ja.StatusCode:-1,this.ve?ld.a[this.ve.statusCode]:
"NULL",this.ve?this.ve.httpStatusCode:-1,this.yW,this.ssg||"NULL");this.yW=!0;this.yJb&&this.yJb(-1,-1)}o9(){this.UPh=!1;this._state=1;Pc.a.$(507843425,818,this.yW?15:50,"FindTextRequest succeeded. IsLastReplicationFailed:{0}, PodSessionId:{1}",this.yW,this.ssg||"NULL");this.yW=!1}dispose(){this.Zca||(1===this._state&&this.Mq.unregister(this),this.Zca=!0)}}Object(m.a)(xh,"FindTextReplicator",Zf.a,[40]);class vg{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.FindText"}oc(ja){this.ga=
ja;this.ga.register(668,"PowerPointWebEditor.IFindTextManager").oa().pa(()=>new Hg(new xh(this.ga.resolve("PowerPointWebEditor.IPPTReplicationScheduler"),this.ga.he("PowerPointWebEditor.IFindTextManager"),this.ga.resolve("PowerPointWebEditor.IErrorHandler"),this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner"))));this.ga.register(669,"PowerPointWebEditor.IFindReplaceTextDialogFactory").oa().pa(()=>new mi(this.ga.he("PowerPointWebEditor.IFocusManager")));const qb=new Zg.a(this.ga.resolve("Common.App.CalloutNotification.ICalloutNotification"),
this.ga.resolve("PowerPointWebEditor.IRibbonPane").va);this.ga.register(670,"PowerPointWebEditor.IFindReplaceTextHandler").oa().pa(()=>new vh(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.IFindTextManager"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("PowerPointWebEditor.IShapeReader"),this.ga.resolve("PowerPointWebEditor.Graph.INotesReader"),
this.ga.resolve("PowerPointWebEditor.INotesView"),this.ga.resolve("Box4.IPageView"),this.ga.resolve("Common.ITaskManager"),this.ga.resolve("PowerPointWebEditor.IPPTWorkspace"),this.ga.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.ga.resolve("Box4.Graph.IGraphIteratorFactory"),this.ga.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),this.ga.resolve("Box4.Graph.IGraphTransactionFactory"),this.ga.resolve("Common.Transaction.ITransactionFactory"),this.ga.resolve("Box4.ICharacterPropertiesEditor"),
this.ga.resolve("PowerPointWebEditor.ISmartArtTextView"),this.ga.he("PowerPointWebEditor.IFindReplaceTextDialogFactory"),this.ga.resolve("Box4.Graph.IGraphInstance").Xd(7),this.ga.resolve("PowerPointWebEditor.IApplicationSettings").CU,this.ga.resolve("Common.IAppSettingsManager").Ac("ReplaceAllClientTimeoutMS",0),qb))}init(){const ja=new ji(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("PowerPointWebEditor.IFindReplaceTextHandler"),
this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"));ja.Kb();ja.Ae()}dispose(){}static main(){I.a.instance.Jc(Xc.a(new vg,0))}}Object(m.a)(vg,"PPTWebEditorFindTextPackage",null,[4,5]);class Tf{constructor(ja){this.Ea=ja}get PTe(){return"PowerPoint"}get rHh(){return"c551d75c-10b1-4de2-83cc-cce22d7c06bd"}get version(){return 1}get currentVersion(){return 0}get y9l(){return this.Ea.B2e}get pbe(){return this.Ea.D2e}get iPh(){return this.Ea.C2e}get R0l(){return"Microsoft.Office.Server.Powerpoint.Web.IWacPptEditorFirstRunExperienceUISettings"}get AUh(){return 24}get PYh(){return 4E3}get sFe(){return this.Ea.w0||
""}}Object(m.a)(Tf,"FirstRunExperienceLauncherSettings",null,[686]);class ei{constructor(ja){this.Aem=ja}veo(ja){this.Aem&&this.Aem.E_h(ja)}}Object(m.a)(ei,"FirstRunExperienceManager",null,[671]);class yg{constructor(){this.ga=null}get name(){return"PowerPointWebEditor.FirstRunExperience"}oc(ja){if(!ja)throw Error.argumentNull("container");this.ga=ja;this.ga.register(671,"PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager").oa().pa(()=>new ei(this.ga.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher")))}init(){this.ga.resolve("Common.IAppSettingsManager").Wf(()=>
{this.E_h()})}dispose(){}E_h(){var ja=this.ga.resolve("PowerPointWebEditor.IApplicationSettings");if(!ja)throw Error.argumentNull("appSettings");const qb=this.ga.resolve("PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager");qb&&(ja=new Tf(ja),qb.veo(ja))}static main(){I.a.instance.Jc(new yg)}}Object(m.a)(yg,"PPTWebEditorFirstRunExperiencePackage",null,[4,5]);var Hj=a(287),zi=a(46);let Mi=!1;class sf extends Ia.a{constructor(ja,qb){if(!ja)throw Error.argumentNull("actionManager");if(!qb)throw Error.argumentNull("applicationSettings");
oe.a("ReliabilityErrorFixPart1")&&(Mi=Hj.a.zy?!0:!1);super(!1,!1,!0);this.Ft=ja;this.w3n=(V,Ea)=>{1===V?(oe.a("ReliabilityErrorFixPart2")&&Pc.a.$(507601554,846,15,"TrimVideoDialog::reactTrimVideoDialogHandler ok button clicked"),this.oBg&&this.pHn===Math.floor(1E3*Ea.trimStartTime)&&this.nHn===Math.floor(1E3*Ea.trimEndTime)?Pc.a.$(507603072,846,15,`TrimVideoDialog::reactTrimVideoDialogHandler Exit trim dialog without trimming in time ${Date.now()-Ea.okButtonClickTime} ms`):this.Ft.Ra(Yc.a.F7e,2,{trimStart:Ea.trimStartTime,
trimEnd:Ea.trimEndTime,Dkm:Ea.okButtonClickTime})):(oe.a("ReliabilityErrorFixPart2")&&Pc.a.$(507601553,846,15,`TrimVideoDialog::reactTrimVideoDialogHandler ${V}`),this.hide())};this.oBg=oe.a("ReliabilityErrorFixPart1");this.Ea=qb}get S7m(){return"TrimVideoDialog"}WBa(ja,qb,V,Ea,Za,ia,Va,Ab){const gc=ResourceStrings.L_TrimVideoDialogTitle,Hc={};Hc.videoSrcUrl=ja;Hc.defaultCaptionsUrl=Ab;Hc.videoName=qb;Hc.startTime=V;Hc.endTime=Ea;Hc.posterFrame=Za;Hc.videoDuration=ia;Hc.aspectRatio=Va;this.Ue=1;this.vg(1,
ResourceStrings.L_TrimVideoDialogTrimButton);ja={["id"]:this.S7m,["bodyControls"]:Hc};this.ZDn=Date.now();this.oBg&&(this.pHn=V,this.nHn=Ea);this.qp(gc,this.w3n,ja)}dispose(){this.oBg&&Mi?Pc.a.$(507603043,846,15,"TrimVideoDialog::dispose deleted oldDialog"):oe.a("KustoTelemetryEnabled")&&Pc.a.$(507913753,846,15,`TrimVideoDialog::dispose Time spent on dialog: ${Date.now()-this.ZDn}ms`);super.dispose();if((!this.oBg||!Mi)&&oe.a("ExtraInfoLoggingEnabled")){const ja=zi.a.$t();Pc.a.$(508049218,846,15,
`TrimVideoDialog::dispose. Printing stack trace: ${ja}`);if(this.Ea.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TrimVideoDialogCrashEnabled",!1)&&!ja.includes("dismissOnCancel")&&!ja.includes("dismissOnOk"))throw Error("Trim video dialog gets closed abruptly");}this.oBg&&(Mi=!1)}}Object(m.a)(sf,"TrimVideoDialog",Ia.a,[]);var ki=a(123);class qh{constructor(ja,qb,V,Ea,Za,ia,Va,Ab){this.soe=!1;this.nfo=(gc,Hc,fd)=>{gc=this.sa.oLb();const hd=this.sa.Uo();Hc=(null===hd||void 0===hd?void 0:
hd.pq)&&!(null===hd||void 0===hd?0:hd.xm);if(1!=gc||!Hc)return Pc.a.$(508367065,846,10,"Selected shape for video object is not valid"),8;if(1===fd)return 32;try{gc=fd=void 0;Hc=0;this.YDn=Date.now();if(oe.a("FastTrimVideoDialogRendering")){const yd=this.Qk(hd),Md=null===yd||void 0===yd?void 0:yd.Hza;Md&&({ZDl:fd,duration:Hc,bXi:gc}=this.getVideoData(Md))}fd?this.VQi(fd,hd,Hc,gc):oe.a("PositionSliderThumbsCorrectly")?this.UYa.p5l(this.pb.podSessionId,hd).then(yd=>{if(yd&&yd.src){let Md=yd.dur;if(yd.dur<
yd.trimStart||yd.dur<yd.trimEnd||yd.dur-yd.trimEnd<yd.trimStart)Pc.a.$(508053698,846,15,`LocalVideoTrimDialogActor::showTrimVideoDialog duration less than trimStart: ${yd.dur<yd.trimStart}, duration less than trimEnd:  ${yd.dur<yd.trimEnd}, trimEnd less than trimStart: ${yd.dur-yd.trimEnd>yd.trimStart}`),Md=0;let te=void 0;oe.a("VideoOOBClosedCaptionsInTrimVideoEnabled")&&void 0!==yd.tracksInfo&&null!==yd.tracksInfo&&(te=e(yd.tracksInfo.trackLst));this.VQi(yd.src,hd,Md,te);if(this.soe)return Pc.a.$(508339986,
846,50,"LocalVideoTrimDialogActor::showTrimVideoDialog initialized the Trim video dialog"),32}else return yd||Pc.a.$(507898065,846,10,"LocalVideoTrimDialogActor::showTrimVideoDialog getVideoResponseAsync response is null"),this.iFf(),8}).catch(yd=>{Pc.a.$(507898064,846,10,`LocalVideoTrimDialogActor::showTrimVideoDialog unable to launch the trim video dialog: ${yd}`);if(this.soe)return this.iFf(),8}):this.UYa.bXe(this.pb.podSessionId,hd).then(yd=>{if(yd)this.VQi(yd,hd,0,void 0);else return this.iFf(),
8}).catch(yd=>{Pc.a.$(507898066,846,10,`LocalVideoTrimDialogActor::showTrimVideoDialog unable to launch the trim video dialog: ${yd}`);if(this.soe)return this.iFf(),8});if(!this.soe)return Pc.a.$(507594531,846,50,"LocalVideoTrimDialogActor::showTrimVideoDialog initialized the Trim video dialog"),32}catch(yd){if(this.soe)return Pc.a.$(507594560,846,10,`LocalVideoTrimDialogActor::showTrimVideoDialog exception: ${yd}`),this.iFf(),8}};if(!ja)throw Error.argumentNull("actionManager");if(!qb)throw Error.argumentNull("selectionManager");
if(!V)throw Error.argumentNull("mediaLocalRequestHelper");if(!Ea)throw Error.argumentNull("sessionInfoOwner");if(!Za)throw Error.argumentNull("videoManagerStore");if(!ia)throw Error.argumentNull("appSettings");if(!Va)throw Error.argumentNull("pageView");if(!Ab)throw Error.argumentNull("calloutNotificationAdapter");this.la=ja;this.sa=qb;this.UYa=V;this.pb=Ea;this.$_=Za;this.na=ia;this.zb=Va;this.PJ=Ab;this.soe=oe.a("ReliabilityErrorFixPart1")}Ae(){}Kb(){this.la.Ba(Yc.a.NPh,$b.a.application,this.nfo)}VQi(ja,
qb,V,Ea){const Za=qb.shapeName;Za||Pc.a.$(508351048,846,15,"Selected video shape name is null or empty");const ia=new sf(this.la,this.na),Va=qb.media.trmStrtField,Ab=qb.media.trmEndField,gc=this.Wjn(qb);let Hc=0;oe.a("PortraitVideoFixEnabled")&&(Hc=qb.RQe/qb.A3d);oe.a("ReliabilityErrorFixPart3")&&Pc.a.$(507598984,846,15,`TrimVideoDialog::createAndShowTrimVideoDialog video type: ${0>Hc?"Portrait":"normal"}`);oe.a("StopVideoOnCanvasUponTrimDialogLaunchEnabled")&&this.dho(qb);ia.WBa(ja,Za,Va,Ab,gc,V,
Hc,Ea);oe.a("KustoTelemetryEnabled")&&Pc.a.$(507913754,846,15,`TrimVideoDialog::createAndShowTrimVideoDialog Time taken to launch the dialog: ${Date.now()-this.YDn}ms`)}Qk(ja){return null===ja||void 0===ja?void 0:ja.yc(this.zb.Ua)}dho(ja){if(this.na.$Xa&&this.na.ggb){const qb=this.Qk(ja);qb&&qb.Ci?(ja=qb.Ci,this.soe?null===ja||void 0===ja?void 0:ja.w4e():null===ja||void 0===ja?void 0:ja.setSelected(!1)):(ja=this.$_.vwa(ja),null===ja||void 0===ja?void 0:ja.stopPlaying())}}Wjn(ja){ja=this.Qk(ja);ja=
null===ja||void 0===ja?void 0:ja.Hza;return ja?(ja=this.Xjn(ja)||ja.getAttribute(ki.a.VIb))?ja.toString():"":""}Xjn(ja){ja=ja.querySelectorAll("image");for(let qb=0;qb<ja.length;qb++){const V=ja[qb].getAttribute("href");if(V)try{const Ea=new URL(V);if("blob:"===Ea.protocol||"data:"===Ea.protocol)return V}catch(Ea){Pc.a.$(508073949,846,10,`LocalVideoTrimDialogActor::getPosterFrameData URL conversion exception: ${Ea}`)}}return null}getVideoData(ja){ja=Array.from(ja.querySelectorAll("video"));for(const V of ja){ja=
V.getAttribute("src");if(oe.a("VideoOOBClosedCaptionsInTrimVideoEnabled")){var qb=[];const Ea=Array.from(V.querySelectorAll('track[kind="captions"]'));for(const Za of Ea)qb.push({lang:Za.srclang,label:Za.label,src:Za.src,id:"",name:""});qb=e(qb)}else qb=void 0;if(ja)try{return 2<=V.readyState?{ZDl:ja,duration:1E3*V.duration,bXi:qb}:{ZDl:ja,duration:0,bXi:qb}}catch(Ea){Pc.a.$(508035600,846,10,`LocalVideoTrimDialogActor::getVideoData exception: ${Ea}`)}}return{ZDl:void 0,duration:0,bXi:void 0}}iFf(){if(oe.a("VideoSrcLoadingErrorCalloutEnabled")){const ja=
Object.assign(new xi.a,{title:ResourceStrings.l_SomethingWentWrongCalloutTitle,message:ResourceStrings.errorMessage_CannotInsertOnlineVideo,timeoutInSeconds:5});this.PJ.sJe(ja).kCa&&Pc.a.$(508056770,846,10,"Error while launching callout notification");Pc.a.$(508056771,846,10,"Could not get the video src url")}}}Object(m.a)(qh,"LocalVideoTrimDialogActor",null,[502]);class Hh{get name(){return"PowerPointWebEditor.TrimVideoDialog"}oc(ja){this.ga=ja}init(){if(this.ga){var ja=this.ga.resolve("Common.IActionManagerExtended");
const qb=this.ga.resolve("PowerPointWebEditor.IPptSelectionManager"),V=this.ga.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),Ea=this.ga.resolve("PowerPointWebEditor.ISessionInfoOwner"),Za=this.ga.resolve("PowerPointWebEditor.IVideoManagerStore"),ia=this.ga.resolve("PowerPointWebEditor.View.IPPTPageView"),Va=this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),Ab=this.ga.resolve("PowerPointWebEditor.ICalloutNotificationAdapter");ja=new qh(ja,qb,V,Ea,Za,Va,ia,Ab);ja.Kb();ja.Ae()}else Pc.a.$(508367064,
846,10,"Container is not available")}dispose(){}static main(){I.a.instance.Jc(new Hh)}}Object(m.a)(Hh,"PPTWebEditorTrimVideoDialogPackage",null,[4,5]);class Ei extends Ia.a{constructor(ja){super(!1,!1,!0);this.GGn=ja;this.IDn=this.GGn.Qco}WBa(){this.qp(ResourceStrings.l_KeyboardShortcutsDialogHeader,this.Rzn,{["id"]:"KeyboardShortcutsDialog",["bodyControls"]:{renderOverrideShortcutsSection:!1,defaultCheckbox:!0,prioritySection:"section2"},["shortcuts"]:this.IDn})}Rzn(){}}Object(m.a)(Ei,"KeyboardShortcutsDialog",
Ia.a,[]);class Xg{constructor(ja,qb,V){this.Keo=(Ea,Za,ia)=>{if(1==ia)return 32;(new Ei(this.lFn)).WBa();return 32};if(!ja)throw Error.argumentNull("actionManager");if(!qb)throw Error.argumentNull("keyboardshortcutsCollection");if(!V)throw Error.argumentNull("focusManager");this.la=ja;this.lFn=qb;this.Na=V}Ae(){const ja=this.Na.Uc(rb.AFrame.Wl);rb.AFrame.Bk(ja,ub.a.hb(xa.a.RWa,5),Yc.a.Rlg)}Kb(){this.la.Ba(Yc.a.Rlg,$b.a.application,this.Keo)}}Object(m.a)(Xg,"KeyboardShortCutsActor",null,[502]);class Ee{constructor(ja){this.Lma=
ja}get pp(){return this.Lma?"\u2318":"Ctrl"}get EJa(){return this.Lma?"Option":"Alt"}get h7l(){return this.pp+"+K"}get nsn(){return oe.a("AdditionsToShortcutsDialogFix")?this.pp+"+"+(this.Lma?"Shift":"Alt")+"+M":this.pp+"+"+this.EJa+"+M"}get f7l(){return this.pp+"+X"}get e7l(){return this.pp+"+C"}get q7l(){return this.pp+"+V"}get psn(){return this.pp+"+Shift+V"}get d7l(){return this.pp+"+B"}get Grn(){return this.pp+"+I"}get htn(){return this.pp+"+U"}get itn(){return this.pp+"+Z"}get tsn(){return this.pp+
"+Y"}get Ern(){return this.pp+"+Shift+>"}get $sn(){return this.pp+"+Shift+<"}get g7l(){return this.pp+"+F"}get wsn(){return this.pp+"+H"}get btn(){return this.pp+"+Shift+-"}get ctn(){return this.pp+"+Shift+PlusSign"}get prn(){return this.pp+"+D"}get Vsn(){return this.pp+"+F10"}get dsn(){return"\u2191"+ResourceStrings.l_OrStringShortcutsDialog+"\u2193"+ResourceStrings.l_OrStringShortcutsDialog+"\u2190"+ResourceStrings.l_OrStringShortcutsDialog+"\u2192"}get Irn(){return"\u2190"}get xsn(){return"\u2192"}get sFj(){return"\u2191"}get pFj(){return"\u2193"}get irn(){return"Delete"}get o7l(){return"Page Down"}get p7l(){return"Page Up"}get umd(){return"Tab"}get N3d(){return"Shift+Tab"}get qFj(){return"Esc"}get rsn(){return this.pp+
"+P"}get Asn(){return this.EJa+"+Q"}get i7l(){return this.pp+"+M"}get w7l(){return this.pp+"+PlusSign"}get ktn(){return this.pp+"+\u2193"}get x7l(){return this.pp+"+-"}get ltn(){return this.pp+"+\u2191"}get v7l(){return oe.a("AdditionsToShortcutsDialogFix")?this.Lma?this.pp+"+Shift+Enter":this.pp+"+F5":this.pp+"+F5"}get atn(){return this.pp+"+Shift+F5"}get m7l(){return"N"}get n7l(){return"Page Down"}get r7l(){return"P"}get s7l(){return"Page Up"}get gtn(){return"J"}get Msn(){return"Enter"}get Nsn(){return"F2"}get rrn(){return"F2"}get Fsn(){return"Ctrl+"+
ResourceStrings.l_ClickStringShortcutsDialog}get Gsn(){return"Shift+"+ResourceStrings.l_ClickStringShortcutsDialog}get Csn(){return ResourceStrings.l_ClickStringShortcutsDialog+"+"+ResourceStrings.l_DragTheMouseShortcutsDialog}get Dsn(){return"Shift+"+ResourceStrings.l_DragTheMouseShortcutsDialog}get Esn(){return"Ctrl+"+ResourceStrings.l_DragTheMouseShortcutsDialog}get rFj(){return this.pp+"+A"}get Wsn(){return oe.a("AdditionsToShortcutsDialogFix")?this.Lma?"\u2318+Shift+Alt+B":this.pp+"+[":this.pp+
"+["}get u7l(){return oe.a("AdditionsToShortcutsDialogFix")?this.Lma?"\u2318+Shift+Alt+F":this.pp+"+]":this.pp+"+]"}get $qn(){return this.Lma?"\u2318+Shift+F":this.pp+"+Shift+]"}get Xsn(){return this.pp+"+Shift+["}get Drn(){return this.pp+"+G"}get jtn(){return this.pp+"+Shift+G"}get Zqn(){return this.pp+"+\u2191"+ResourceStrings.l_OrStringShortcutsDialog+this.pp+"+\u2193"+ResourceStrings.l_OrStringShortcutsDialog+this.pp+"+\u2190"+ResourceStrings.l_OrStringShortcutsDialog+this.pp+"+\u2192"}get zsn(){return this.EJa+
"+\u2192"}get ysn(){return this.EJa+"+\u2190"}get Crn(){return"Type+G+,+\u2190"+ResourceStrings.l_OrStringShortcutsDialog+"\u2192+,+Enter"}get gsn(){return"Tab"}get isn(){return"Shift+Tab"}get hsn(){return"\u2193"}get jsn(){return"\u2191"}get iNh(){return"Enter"}get Yqn(){return"Tab"}get wrn(){return"\u2193"}get Arn(){return"\u2191"}get trn(){return"\u2192"}get crn(){return"\u2190"}get xrn(){return"\u2193"}get zrn(){return"\u2191"}get j7l(){return this.EJa+"+F12"}get Mrn(){return"Tab"}get qrn(){return"Type+Tab+,+Enter+,+\u2193"}get qsn(){return this.pp+
"+Enter"}get Jsn(){return"Shift+\u2192"}get Isn(){return"Shift+\u2190"}get Ksn(){return"Shift+"+this.pp+"+\u2190"}get Lsn(){return"Shift+"+this.pp+"+\u2192"}get Usn(){return"Shift+\u2191"}get Bsn(){return"Shift+\u2193"}get Ssn(){return"Shift+"+this.pp+"+\u2191"}get Psn(){return"Shift+"+this.pp+"+\u2193"}get Rsn(){return this.Lma?"Shift+"+this.pp+"+\u2190":"Shift+Home"}get Osn(){return this.Lma?"Shift+"+this.pp+"+\u2192":"Shift+End"}get Tsn(){return this.Lma?"Shift+"+this.pp+"+Fn+\u2190":"Shift+"+
this.pp+"+Home"}get Qsn(){return this.Lma?"Shift+"+this.pp+"+Fn+\u2192":"Shift+"+this.pp+"+End"}get jrn(){return this.Lma?"Delete":"Backspace"}get krn(){return this.Lma?"Fn+Delete":"Delete"}get lrn(){return this.Lma?this.pp+"+Delete":this.pp+"+Backspace"}get mrn(){return this.pp+"+Delete"}get Rrn(){return"\u2192"}get Qrn(){return"\u2190"}get l7l(){return this.pp+"+\u2192"}get k7l(){return"Ctrl+\u2190"}get Trn(){return"\u2191"}get Srn(){return"\u2193"}get esn(){return this.Lma?this.pp+"+\u2192":"End"}get ksn(){return this.Lma?
this.pp+"+\u2190":"Home"}get msn(){return this.pp+"+\u2191"}get Lrn(){return this.pp+"+\u2193"}get fsn(){return this.Lma?this.pp+"+Fn+\u2192":this.pp+"+End"}get lsn(){return this.Lma?this.pp+"+Fn+\u2190":this.pp+"+Home"}get arn(){return this.pp+"+E"}get Hrn(){return this.pp+"+J"}get dtn(){return"Shift+F3"}get usn(){return this.pp+"+Space"}get ssn(){return this.EJa+"+Shift+\u2190"}get nrn(){return this.EJa+"+Shift+\u2192"}get hrn(){return"Type+*+,+Spacebar"}get ern(){return"Type+-+,+Spacebar"}get frn(){return"Type+>+,+Spacebar"}get grn(){return"Type+<+,+>+,+Spacebar"}get csn(){return this.pp+
"+\u2191"}get Wrn(){return this.pp+"+\u2193"}get asn(){return this.pp+"+Shift+\u2191"}get bsn(){return this.pp+"+Shift+\u2193"}get $rn(){return this.pp+"+\u2191"}get Xrn(){return this.pp+"+\u2193"}get Yrn(){return this.pp+"+Shift+\u2191"}get Zrn(){return this.pp+"+Shift+\u2193"}get Orn(){return this.pp+"+F6"}get Prn(){return this.pp+"+F6"}get Jrn(){return"Shift+"+this.pp+"+F6"}get vrn(){return"\u2190"+ResourceStrings.l_OrStringShortcutsDialog+"\u2192"}get Krn(){return"\u2190"+ResourceStrings.l_OrStringShortcutsDialog+
"\u2192"}get orn(){return oe.a("AdditionsToShortcutsDialogFix")?(this.Lma?"Ctrl":this.EJa)+"+.":this.Lma?this.EJa+"+Ctrl":this.EJa+"+."+ResourceStrings.l_OrStringShortcutsDialog+this.EJa+"+\u229e"}get etn(){return"Type+"+(this.Lma?"Ctrl":this.EJa)+"+.+,+Z+,+R"}get Vrn(){return this.pp+"+Shift+F"}get Urn(){return"Ctrl+Shift+B"}get Nrn(){return"\u2191"+ResourceStrings.l_OrStringShortcutsDialog+"\u2193"}get urn(){return"+ ("+ResourceStrings.l_OnNumericKeypadOnlyShortcutsDialog+")"+ResourceStrings.l_OrStringShortcutsDialog+
"\u2192"}get drn(){return"- ("+ResourceStrings.l_OnNumericKeypadOnlyShortcutsDialog+")"+ResourceStrings.l_OrStringShortcutsDialog+"\u2190"}get Xqn(){return"Ctrl+Enter"+ResourceStrings.l_OrStringShortcutsDialog+"Ctrl+Space"}get vsn(){return"F2"}get srn(){return this.EJa+"+Shift+9"}get brn(){return this.EJa+"+Shift+1"}get mtn(){return this.pp+"+"+this.EJa+"+O"}get osn(){return this.EJa+"+Shift+A"}get ftn(){return this.pp+"+\\"}get Hsn(){return this.pp+"+Shift+Click"}get Frn(){return"Ctrl"}get t7l(){return"Enter"+
ResourceStrings.l_OrStringShortcutsDialog+"Space"}get yrn(){return this.m7l+ResourceStrings.l_OrStringShortcutsDialog+this.n7l+ResourceStrings.l_OrStringShortcutsDialog+this.xsn+ResourceStrings.l_OrStringShortcutsDialog+this.pFj+ResourceStrings.l_OrStringShortcutsDialog+"Enter"+ResourceStrings.l_OrStringShortcutsDialog+"Space"}get Brn(){return this.r7l+ResourceStrings.l_OrStringShortcutsDialog+this.s7l+ResourceStrings.l_OrStringShortcutsDialog+this.Irn+ResourceStrings.l_OrStringShortcutsDialog+this.sFj+
ResourceStrings.l_OrStringShortcutsDialog+(this.Lma?"Delete":"Backspace")}get Zsn(){return"T"}get Ysn(){return this.EJa+"+J"}}Object(m.a)(Ee,"KeyboardShortcutsMapping",null,[]);class Jf{constructor(ja){this.Nhm=[];this.Nke=!1;this.Ea=ja;this.Nke=dc.a.Jj;this.Hf=new Ee(this.Nke);this.D5m()}get Qco(){return this.Nhm}D5m(){this.ATm();this.fTm();this.xTm();this.RTm();this.pUm();this.uUm();this.yUm();this.CUm();this.FUm();this.kUm();oe.a("AdditionsToShortcutsDialogFix")&&this.iTm()}ATm(){this.qg(ResourceStrings.l_BoldShortcutDescription,
this.Hf.d7l,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.qg(ResourceStrings.l_CutShortcutDescription,this.Hf.f7l,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.qg(ResourceStrings.l_CopyShortcutDescription,this.Hf.e7l,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.qg(ResourceStrings.l_PasteShortcutDescription,this.Hf.q7l,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.qg(ResourceStrings.l_InsertHyperLinkShortcutDescription,this.Hf.h7l,
ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.qg(ResourceStrings.l_UndoShortcutDescription,this.Hf.itn,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.qg(ResourceStrings.l_RedoShortcutDescription,this.Hf.tsn,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.qg(ResourceStrings.l_DeleteShortcutDescription,this.Hf.irn,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.qg(ResourceStrings.l_OpenFindShortcutDescription,this.Hf.g7l,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);
this.qg(ResourceStrings.l_MoveShapeShortcutDescription,this.Hf.dsn,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.qg(ResourceStrings.l_NextSlideShortcutDescription,this.Hf.o7l,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.qg(ResourceStrings.l_PreviousSlideShortcutDescription,this.Hf.p7l,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.qg(ResourceStrings.l_MoveInTaskPaneShortcutDescription,this.Hf.umd+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.N3d,
ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.qg(ResourceStrings.l_ExitSlideShowViewShortcutDescription,this.Hf.qFj,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.qg(ResourceStrings.l_PrintShortcutDescription,this.Hf.rsn,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.qg(ResourceStrings.l_SearchActionShortcutDescription,this.Hf.Asn,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);this.Nke||this.qg(ResourceStrings.l_InsertNewSlideShortcutDescription,
this.Hf.i7l,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog);oe.a("AdditionsToShortcutsDialogFix")&&this.qg(ResourceStrings.l_HideTooltipShortcutDescription,this.Hf.Frn,ResourceStrings.l_FrequentlyUsedShortcutsSectionInDialog)}yUm(){this.qg(ResourceStrings.l_NextSlideShortcutDescription,this.Hf.o7l,ResourceStrings.l_SlidesSectionInDialog);this.qg(ResourceStrings.l_PreviousSlideShortcutDescription,this.Hf.p7l,ResourceStrings.l_SlidesSectionInDialog);this.qg(ResourceStrings.l_ShowOrHideThumbnailPaneShortcutDescription,
this.Hf.ftn,ResourceStrings.l_SlidesSectionInDialog);oe.a("AdditionsToShortcutsDialogFix")?(this.qg(ResourceStrings.l_ZoomInShortcutDescription,this.Hf.w7l,ResourceStrings.l_SlidesSectionInDialog),this.qg(ResourceStrings.l_ZoomOutShortcutDescription,this.Hf.x7l,ResourceStrings.l_SlidesSectionInDialog)):(this.qg(ResourceStrings.l_ZoomInShortcutDescription,this.Hf.w7l+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.ktn,ResourceStrings.l_SlidesSectionInDialog),this.qg(ResourceStrings.l_ZoomOutShortcutDescription,
this.Hf.x7l+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.ltn,ResourceStrings.l_SlidesSectionInDialog));this.Ea.getBooleanAppSetting(Rh.a.xkd)&&this.qg(ResourceStrings.l_ZoomToFitWindow,this.Hf.mtn,ResourceStrings.l_SlidesSectionInDialog);this.Nke||(this.qg(ResourceStrings.l_InsertNewSlideShortcutDescription,this.Hf.i7l,ResourceStrings.l_SlidesSectionInDialog),this.qg(ResourceStrings.l_MoveSlideUpShortcutDescription,this.Hf.csn,ResourceStrings.l_SlidesSectionInDialog),this.qg(ResourceStrings.l_MoveSlideDownShortcutDescription,
this.Hf.Wrn,ResourceStrings.l_SlidesSectionInDialog),this.qg(ResourceStrings.l_MoveSlideToBegShortcutDescription,this.Hf.asn,ResourceStrings.l_SlidesSectionInDialog),this.qg(ResourceStrings.l_MoveSlideToEndShortcutDescription,this.Hf.bsn,ResourceStrings.l_SlidesSectionInDialog),this.qg(ResourceStrings.l_MoveSlideSectionUpShortcutDescription,this.Hf.$rn,ResourceStrings.l_SlidesSectionInDialog),this.qg(ResourceStrings.l_MoveSlideSectionDownShortcutDescription,this.Hf.Xrn,ResourceStrings.l_SlidesSectionInDialog),
this.Ea.getBooleanAppSetting("SectionExtremityMoveEnabled")&&(this.qg(ResourceStrings.l_MoveSlideSectionToBegShortcutDescription,this.Hf.Yrn,ResourceStrings.l_SlidesSectionInDialog),this.qg(ResourceStrings.l_MoveSlideSectionToEndShortcutDescription,this.Hf.Zrn,ResourceStrings.l_SlidesSectionInDialog)))}kUm(){oe.a("AdditionsToShortcutsDialogFix")?(this.qg(ResourceStrings.l_StartingFromBeginningShortcutDescription,this.Hf.v7l,ResourceStrings.l_PresentingSectionInDialog),this.qg(ResourceStrings.l_StartFromCurrentSlideShortcutDescription,
this.Hf.atn,ResourceStrings.l_PresentingSectionInDialog),this.qg(ResourceStrings.l_NextSlideInFullViewShortcutDescription,this.Hf.yrn,ResourceStrings.l_PresentingSectionInDialog)):(this.Nke||this.qg(ResourceStrings.l_StartSlideShowShortcutDescription,this.Hf.v7l,ResourceStrings.l_PresentingSectionInDialog),this.qg(ResourceStrings.l_NextSlideInFullViewShortcutDescription,this.Hf.m7l+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.n7l+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.pFj,ResourceStrings.l_PresentingSectionInDialog),
this.qg(ResourceStrings.l_PreviousSlideInFullViewShortcutDescription,this.Hf.r7l+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.s7l+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.sFj,ResourceStrings.l_PresentingSectionInDialog));oe.a("AdditionsToShortcutsDialogFix")&&(this.qg(ResourceStrings.l_PreviousSlideInFullViewShortcutDescription,this.Hf.Brn,ResourceStrings.l_PresentingSectionInDialog),this.qg(ResourceStrings.l_ShowOrHideToolbarShortcutDescription,this.Hf.Zsn,ResourceStrings.l_PresentingSectionInDialog),
this.qg(ResourceStrings.l_MoveFocusToNextInToolbarShortcutDescription,this.Hf.umd,ResourceStrings.l_PresentingSectionInDialog),this.qg(ResourceStrings.l_MoveFocusToPrevInToolbarShortcutDescription,this.Hf.N3d,ResourceStrings.l_PresentingSectionInDialog),this.qg(ResourceStrings.l_InvokeItemInToolbarShortcutDescription,this.Hf.t7l,ResourceStrings.l_PresentingSectionInDialog),this.qg(ResourceStrings.l_MoveFocusToNextItemOnSlideShortcutDescription,this.Hf.umd,ResourceStrings.l_PresentingSectionInDialog),
this.qg(ResourceStrings.l_MoveFocusToPrevItemOnSlideShortcutDescription,this.Hf.N3d,ResourceStrings.l_PresentingSectionInDialog),this.qg(ResourceStrings.l_InvokeItemInFocusShortcutDescription,this.Hf.iNh,ResourceStrings.l_PresentingSectionInDialog),this.qg(ResourceStrings.l_MoveFocusToBackInGridShortcutDescription,this.Hf.Orn,ResourceStrings.l_PresentingSectionInDialog),this.qg(ResourceStrings.l_ShowOrHideTheClosedCaptionsMenuForAvideoShortcutDescription,this.Hf.Ysn,ResourceStrings.l_PresentingSectionInDialog));
this.qg(ResourceStrings.l_GoToInFullViewShortcutDescription,this.Hf.Crn,ResourceStrings.l_PresentingSectionInDialog);this.qg(ResourceStrings.l_TurnCaptionsShortcutDescription,this.Hf.gtn,ResourceStrings.l_PresentingSectionInDialog);this.qg(ResourceStrings.l_ExitSlideshowShortcutDescription,this.Hf.qFj,ResourceStrings.l_PresentingSectionInDialog)}uUm(){this.qg(ResourceStrings.l_CutObjOrTextShortcutDescription,this.Hf.f7l,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.qg(ResourceStrings.l_CopyObjOrTextShortcutDescription,
this.Hf.e7l,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.qg(ResourceStrings.l_PasteObjOrTextShortcutDescription,this.Hf.q7l,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.qg(ResourceStrings.l_DuplicateObjShortcutDescription,this.Hf.prn,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.qg(ResourceStrings.l_PasteTextShortcutDescription,this.Hf.psn,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.qg(ResourceStrings.l_MoveLeftToRightShortcutDescription,this.Hf.umd,ResourceStrings.l_ShapesandObjectsSectionInDialog);
this.qg(ResourceStrings.l_SelectEditPlaceHolderShortcutDescription,this.Hf.Msn+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.Nsn,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.qg(ResourceStrings.l_EndEditTextPlaceHolderShortcutDescription,this.Hf.rrn,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.qg(ResourceStrings.l_SelectMultipleSingleObjShortcutDescription,this.Hf.Fsn+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.Gsn,ResourceStrings.l_ShapesandObjectsSectionInDialog);
this.qg(ResourceStrings.l_SelectMultipleObjShortcutDescription,this.Hf.Csn+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.Dsn+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.Esn,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.qg(ResourceStrings.l_SelectAllObjOnPageShortcutDescription,this.Hf.rFj,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.qg(ResourceStrings.l_SelectAllTextInTextBoxShortcutDescription,this.Hf.rFj,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.qg(ResourceStrings.l_InsertHyperLinkInTextBoxShortcutDescription,
this.Hf.h7l,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.qg(ResourceStrings.l_SendObjBackOneShortcutDescription,this.Hf.Wsn,ResourceStrings.l_ShapesandObjectsSectionInDialog);oe.a("AdditionsToShortcutsDialogFix")?this.qg(ResourceStrings.l_BringTheObjectForwardOnePositionShortcutDescription,this.Hf.u7l,ResourceStrings.l_ShapesandObjectsSectionInDialog):this.qg(ResourceStrings.l_SendObjForwardOneShortcutDescription,this.Hf.u7l,ResourceStrings.l_ShapesandObjectsSectionInDialog);oe.a("AdditionsToShortcutsDialogFix")&&
(this.qg(ResourceStrings.l_BringTheObjectToTheFrontShortcutDescription,this.Hf.$qn,ResourceStrings.l_ShapesandObjectsSectionInDialog),this.qg(ResourceStrings.l_SendTheObjectToTheBackShortcutDescription,this.Hf.Xsn,ResourceStrings.l_ShapesandObjectsSectionInDialog));this.qg(ResourceStrings.l_GroupSelectedObjShortcutDescription,this.Hf.Drn,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.qg(ResourceStrings.l_UngroupSelectedShortcutDescription,this.Hf.jtn,ResourceStrings.l_ShapesandObjectsSectionInDialog);
this.qg(ResourceStrings.l_AdjustDimensionsShortcutDescription,this.Hf.Zqn,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.qg(ResourceStrings.l_RotateClockwiseShortcutDescription,this.Hf.zsn,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.qg(ResourceStrings.l_RotateCounterClockShortcutDescription,this.Hf.ysn,ResourceStrings.l_ShapesandObjectsSectionInDialog);this.qg(ResourceStrings.l_SelectObjLowerZOrderShortcutDescription,this.Hf.Hsn,ResourceStrings.l_ShapesandObjectsSectionInDialog)}FUm(){this.qg(ResourceStrings.l_SelectOneLeftCharShortcutDescription,
this.Hf.Isn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_SelectOneRightCharShortcutDescription,this.Hf.Jsn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_SelectOneWordLeftShortcutDescription,this.Hf.Ksn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_SelectOneWordRightShortcutDescription,this.Hf.Lsn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_SelectOneLineUpShortcutDescription,this.Hf.Usn,ResourceStrings.l_TextEditingSectionInDialog);
this.qg(ResourceStrings.l_SelectOneLineDownShortcutDescription,this.Hf.Bsn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_SelectToParagraphBegShortcutDescription,this.Hf.Ssn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_SelectToParagraphEndShortcutDescription,this.Hf.Psn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_SelectToLineBegShortcutDescription,this.Hf.Rsn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_SelectToLineEndShortcutDescription,
this.Hf.Osn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_SelectToPlaceHolderBegShortcutDescription,this.Hf.Tsn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_SelectToPlaceHolderEndShortcutDescription,this.Hf.Qsn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_SelelctAllInPlaceHolderShortcutDescription,this.Hf.rFj,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_DeleteOneCharLeftShortcutDescription,this.Hf.jrn,
ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_DeleteOneCharRightShortcutDescription,this.Hf.krn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_DeleteOneWordLeftShortcutDescription,this.Hf.lrn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_DeleteOneWordRightShortcutDescription,this.Hf.mrn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_MoveOneCHarLeftShortcutDescription,this.Hf.Qrn,ResourceStrings.l_TextEditingSectionInDialog);
this.qg(ResourceStrings.l_MoveOneCharRightShortcutDescription,this.Hf.Rrn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_MoveOneWordLeftShortcutDescription,this.Hf.k7l,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_MoveOneWordRightShortcutDescription,this.Hf.l7l,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_MoveOneLineUpShortcutDescription,this.Hf.Trn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_MoveOneLineDownShortcutDescription,
this.Hf.Srn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_MoveToEndOfLineShortcutDescription,this.Hf.esn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_MoveToBegOfLineShortcutDescription,this.Hf.ksn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_MoveUpOneParaShortcutDescription,this.Hf.msn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_MoveDownOneParaShortcutDescription,this.Hf.Lrn,ResourceStrings.l_TextEditingSectionInDialog);
this.qg(ResourceStrings.l_MoveToTextBoxEndShortcutDescription,this.Hf.fsn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_MoveToTextBoxBegShortcutDescription,this.Hf.lsn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_IncreaseFontShortcutDescription,this.Hf.Ern,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_DecreaseFontShortcutDescription,this.Hf.$sn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_BoldShortcutDescription,
this.Hf.d7l,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_ApplyItalicShortcutDescription,this.Hf.Grn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_ApplyUnderlineShortcutDescription,this.Hf.htn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_CenterParaShortcutDescription,this.Hf.arn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_JustifyParaShortcutDescription,this.Hf.Hrn,ResourceStrings.l_TextEditingSectionInDialog);
this.qg(ResourceStrings.l_ApplySubscriptShortcutDescription,this.Hf.btn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_ApplySuperscriptShortcutDescription,this.Hf.ctn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_SwitchCasesShortcutDescription,this.Hf.dtn,ResourceStrings.l_TextEditingSectionInDialog);this.Nke||(this.qg(ResourceStrings.l_RemoveFormattingShortcutDescription,this.Hf.usn,ResourceStrings.l_TextEditingSectionInDialog),this.qg(ResourceStrings.l_PromoteParaShortcutDescription,
this.Hf.ssn,ResourceStrings.l_TextEditingSectionInDialog),this.qg(ResourceStrings.l_DemoteParaShortcutDescription,this.Hf.nrn,ResourceStrings.l_TextEditingSectionInDialog));this.qg(ResourceStrings.l_CreateRoundBulletListShortcutDescription,this.Hf.hrn,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_CreateHyphensListShortcutDescription,this.Hf.ern,ResourceStrings.l_TextEditingSectionInDialog);this.qg(ResourceStrings.l_CreateListArrowShortcutDescription,this.Hf.frn,ResourceStrings.l_TextEditingSectionInDialog);
this.qg(ResourceStrings.l_CreateListDiamondShortcutDescription,this.Hf.grn,ResourceStrings.l_TextEditingSectionInDialog)}CUm(){this.qg(ResourceStrings.l_MoveToNextCellShortcutDescription,this.Hf.gsn,ResourceStrings.l_TablesSectionInDialog);this.qg(ResourceStrings.l_MoveToPrevCellShortcutDescription,this.Hf.isn,ResourceStrings.l_TablesSectionInDialog);this.qg(ResourceStrings.l_MoveToNextRowShortcutDescription,this.Hf.hsn,ResourceStrings.l_TablesSectionInDialog);this.qg(ResourceStrings.l_MoveToPrevRowShortcutDescription,
this.Hf.jsn,ResourceStrings.l_TablesSectionInDialog);this.qg(ResourceStrings.l_StartNewParaShortcutDescription,this.Hf.iNh,ResourceStrings.l_TablesSectionInDialog);this.qg(ResourceStrings.l_AddNewRowShortcutDescription,this.Hf.Yqn,ResourceStrings.l_TablesSectionInDialog)}fTm(){oe.a("AdditionsToShortcutsDialogFix")&&this.qg(ResourceStrings.l_NewCommentShortcutDescription,this.Hf.nsn,ResourceStrings.l_CommentsSectionInDialog);this.qg(ResourceStrings.l_NextCommentShortcutDescription,this.Hf.wrn,ResourceStrings.l_CommentsSectionInDialog);
this.qg(ResourceStrings.l_PrevCommentShortcutDescription,this.Hf.Arn,ResourceStrings.l_CommentsSectionInDialog);this.qg(ResourceStrings.l_ExpandCommentShortcutDescription,this.Hf.trn,ResourceStrings.l_CommentsSectionInDialog);this.qg(ResourceStrings.l_CollapseCommentShortcutDescription,this.Hf.crn,ResourceStrings.l_CommentsSectionInDialog);this.qg(ResourceStrings.l_NextReplyInCommentShortcutDescription,this.Hf.xrn,ResourceStrings.l_CommentsSectionInDialog);this.qg(ResourceStrings.l_PrevReplyInCommentShortcutDescription,
this.Hf.zrn,ResourceStrings.l_CommentsSectionInDialog);oe.a("AdditionsToShortcutsDialogFix")&&(this.qg(ResourceStrings.l_MoveFocusToNextInCommentShortcutDescription,this.Hf.umd,ResourceStrings.l_CommentsSectionInDialog),this.qg(ResourceStrings.l_MoveFocusToPreviousInCommentShortcutDescription,this.Hf.N3d,ResourceStrings.l_CommentsSectionInDialog),this.qg(ResourceStrings.l_MoveFocusFromCommentToAnchorShortcutDescription,this.Hf.j7l,ResourceStrings.l_CommentsSectionInDialog),this.qg(ResourceStrings.l_MoveFocusFromAnchorToCommentShortcutDescription,
this.Hf.j7l,ResourceStrings.l_CommentsSectionInDialog));this.qg(ResourceStrings.l_FocusReplyShortcutDescription,this.Hf.Mrn,ResourceStrings.l_CommentsSectionInDialog);this.qg(ResourceStrings.l_EditCommentShortcutDescription,this.Hf.qrn,ResourceStrings.l_CommentsSectionInDialog);this.qg(ResourceStrings.l_PostCommentShortcutDescription,this.Hf.qsn,ResourceStrings.l_CommentsSectionInDialog)}xTm(){this.qg(ResourceStrings.l_FindAndReplaceShortcutDescription,this.Hf.g7l,ResourceStrings.l_FindandReplaceSectionInDialog);
oe.a("AdditionsToShortcutsDialogFix")&&this.qg(ResourceStrings.l_ReplaceShortcutDescription,this.Hf.wsn,ResourceStrings.l_FindandReplaceSectionInDialog)}RTm(){this.qg(ResourceStrings.L_KeyboardNavigationMoveForwardShortcutDescription,this.Hf.Prn,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.qg(ResourceStrings.L_KeyboardNavigationMoveBackwardShortcutDescription,this.Hf.Jrn,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.qg(ResourceStrings.l_DiffRibbonTabShortcutDescription,this.Hf.vrn,
ResourceStrings.l_KeyboardNavigationSectionInDialog);this.qg(ResourceStrings.l_RibbonOptionShortcutDescription,this.Hf.iNh,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.qg(ResourceStrings.l_MoveRibbonOptionsShortcutDescription,this.Hf.Krn,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.qg(ResourceStrings.l_MoveRibbonFeatureGroupsShortcutDescription,this.Hf.k7l+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.l7l,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.qg(ResourceStrings.l_MoveInTaskPaneShortcutDescription,
this.Hf.umd+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.N3d,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.qg(ResourceStrings.L_SwitchBetweenRibbonsShortcutDescription,this.Hf.etn,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.qg(ResourceStrings.l_DisplayRibbonAccessShortcutDescription,this.Hf.orn,ResourceStrings.l_KeyboardNavigationSectionInDialog);this.qg(ResourceStrings.l_OpenShortcutDialogShortcutDescription,this.Hf.osn,ResourceStrings.l_KeyboardNavigationSectionInDialog)}pUm(){oe.a("AdditionsToShortcutsDialogFix")&&
this.qg(ResourceStrings.l_ShowOrHideSelectionPaneShortcutDescription,this.Hf.Vsn,ResourceStrings.l_SelectionPaneSectionInDialog);this.Nke||this.qg(ResourceStrings.l_MoveItemForwardShortcutDescription,this.Hf.Vrn,ResourceStrings.l_SelectionPaneSectionInDialog);oe.a("AdditionsToShortcutsDialogFix")&&(this.qg(ResourceStrings.l_MoveSelectedItemBackwardShortcutDescription,this.Hf.Urn,ResourceStrings.l_SelectionPaneSectionInDialog),this.qg(ResourceStrings.l_SelectItemInFocusShortcutDescription,this.Hf.t7l,
ResourceStrings.l_SelectionPaneSectionInDialog));this.qg(ResourceStrings.l_MoveFocusSingleShortcutDescription,this.Hf.Nrn,ResourceStrings.l_SelectionPaneSectionInDialog);this.qg(ResourceStrings.l_ExpandFocusGroupShortcutDescription,this.Hf.urn,ResourceStrings.l_SelectionPaneSectionInDialog);this.qg(ResourceStrings.l_CollapseFocusGroupShortcutDescription,this.Hf.drn,ResourceStrings.l_SelectionPaneSectionInDialog);oe.a("AdditionsToShortcutsDialogFix")&&this.qg(ResourceStrings.l_AddOrRemoveItemInFocusShortcutDescription,
this.Hf.Xqn,ResourceStrings.l_SelectionPaneSectionInDialog);this.qg(ResourceStrings.l_RenameFocusItemShortcutDescription,this.Hf.vsn,ResourceStrings.l_SelectionPaneSectionInDialog);this.qg(ResourceStrings.l_ExpandGroupsShortcutDescription,this.Hf.srn,ResourceStrings.l_SelectionPaneSectionInDialog);oe.a("AdditionsToShortcutsDialogFix")&&this.qg(ResourceStrings.l_CollapseAllShortcutDescription,this.Hf.brn,ResourceStrings.l_SelectionPaneSectionInDialog)}iTm(){this.qg(ResourceStrings.l_MoveThroughElementsWithOnly1StopOnTheCardListDescription,
this.Hf.umd+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.N3d,ResourceStrings.l_Copilot);this.qg(ResourceStrings.l_MoveThroughTheCardsInTheCardListShortcutDescription,this.Hf.sFj+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.pFj,ResourceStrings.l_Copilot);this.qg(ResourceStrings.l_NavigateIntoACardShortcutDescription,this.Hf.iNh,ResourceStrings.l_Copilot);this.qg(ResourceStrings.l_MoveThroughTheElementsWithinACardShortcutDescription,this.Hf.umd+ResourceStrings.l_OrStringShortcutsDialog+this.Hf.N3d,
ResourceStrings.l_Copilot);this.qg(ResourceStrings.l_NavigateOutOfACardShortcutDescription,this.Hf.qFj,ResourceStrings.l_Copilot)}qg(ja,qb,V){this.Nhm.push({description:ja,shortcut:qb,section:V,overrideBrowserShortcut:""})}}Object(m.a)(Jf,"KeyboardShortcutsCollection",null,[]);class Ze{get name(){return"PowerPointWebEditor.KeyboardShortcutsDialog"}oc(ja){this.ga=ja;const qb=this.ga.resolve("PowerPointWebEditor.IApplicationSettings");ja.register(Jf,"PowerPointWebEditor.KeyboardShortcutsCollection").oa().pa(()=>
new Jf(qb))}init(){if(this.ga){const ja=new Xg(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.KeyboardShortcutsCollection"),this.ga.resolve("PowerPointWebEditor.IFocusManager"));ja.Kb();ja.Ae()}else r.ULS.sendTraceTag(508367313,334,50,"PPTWebEditorKeyboardShortcutsDialogPackage.init Empty container while intializing")}dispose(){}static main(){I.a.instance.Jc(new Ze)}}Object(m.a)(Ze,"PPTWebEditorKeyboardShortcutsDialogPackage",null,[4,5]);var Xj=a(595);class Ij{constructor(){this.flyoutAnchorTarget=
this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(m.a)(Ij,"CatchUpConfiguration",null,[]);class xj{constructor(){this.recentChangesManager=this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=
this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(m.a)(xj,"SharedControllerFactoryParameters",null,[]);const nh=(ja,qb)=>{if(!ja)throw Error.create(String.format("Argument {0} is null.",qb));},fh=ja=>{if(!ja.navigationId)return Pc.a.$(507843593,3012,10,"CreateNavigationData: navigation id is missing."),null;try{const qb=window.atob(ja.navigationId);return qb&&""!==qb?{["NavigationId"]:qb}:null}catch(qb){return Pc.a.$(507843592,
3012,10,"CreateNavigationData: decoding navigation id failed.",qb),null}};class ng{constructor(ja){nh(ja,"ActivityContentManager.IActionManagerExtended");this.la=ja}doesContentExist(ja){if(!ja)return Pc.a.$(508039179,3012,10,"DoesContentExist: activity is null."),!1;switch(ja.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 12:return(ja=fh(ja))?32===this.la.Ra(Xa.a.tTd,2,ja):!1;default:return!1}}}Object(m.a)(ng,"ActivityContentManager",null,[553]);class R{constructor(ja){this.Ft=
ja}shouldShowEmptyExperienceButton(){return n.AFrameworkApplication.CZe()}getExplanationText(){return""}getCommandName(){return ResourceStrings.L_FileHistory}onButtonClick(){this.Ft.Ra(Xa.a.bbd,2,null)}onInviteOthersButtonClick(){this.Ft.Ra(Xa.a.NAa,2,null)}}Object(m.a)(R,"EmptyCatchUpBehaviorManager",null,[556]);class Ha{constructor(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}}Object(m.a)(Ha,"Person",null,[]);var wb=a(1030),Yb=a(265),zc=a(218);
class Ic extends Ci.a{constructor(ja){super();this.StartTime=null;this.StartTime=ja}lo(){return 93}}Object(m.a)(Ic,"GetFileRevisionHistoryRequest",Ci.a,[]);class Wc{constructor(ja,qb,V){this.ProviderId=this.UserId=this.UserName=null;this.UserName=ja;this.UserId=qb;this.ProviderId=V}}Object(m.a)(Wc,"Author",null,[]);const rd=(ja,qb)=>ja&&qb?ja.providerIdField===qb.ProviderId?ja.userIdField===qb.UserId:ja.userNameField===qb.UserName:!1;var vd=a(283);class Rd{constructor(ja,qb,V){this.xRh=this.jee=null;
this.Jm=ja;this.nfe=V;this.nfe.PPl(Object(da.a)(this,this.Flm,"onFileRevisionHistoryReady"));qb.Wf(()=>{this.jee=new Wc(qb.Ma("UserName"),qb.Ma(Td.a.ZTa),qb.Ma(Td.a.dcc))})}dispose(){this.nfe.dum(Object(da.a)(this,this.Flm,"onFileRevisionHistoryReady"));this.jee=null}fhn(ja,qb,V){ja&&V&&(this.xRh=V,ja=new vd.a(new Ic(ja),Ea=>{this.Nbm(Ea,qb);this.qqd(Ea)},Ea=>{this.Nbm(Ea,qb);return this.Khb(Ea)}),this.Jm.Rb(ja))}Flm(ja,qb){ja=null;const V=[];za.a.wb(qb.NVf)||(({NVf:qb}=this.Ako(qb.NVf)).returnValue?
zc.b(qb.fileRevisionEntriesField,Ea=>this.Vxn(Ea.changesDataField),Ea=>{V.push(Ea.changesDataField)}):ja="ErrorGetFileRevisionHistoryParseJsonException");this.Nxk(V,ja)}qqd(ja){let qb=null;ja.ServerError&&0!==ja.ServerError.Code?qb=Yb.a[ja.ServerError.Code]:0!==ja.StatusCode&&(qb=wb.a[ja.StatusCode]);qb&&this.Nxk(null,qb)}Khb(ja){Pc.a.$(512262998,811,15,"OnGetFileRevisionAuthorNamesFailed() - "+ja.toString());this.Nxk(null,"ErrorGetFileRevisionHistoryFailed");return!0}Nxk(ja,qb){this.xRh&&(ja=this.Odn(ja),
this.xRh(ja,qb),this.xRh=null)}Ako(ja){let qb;qb=null;try{qb=Sys.Serialization.JavaScriptSerializer.deserialize(ja)}catch(V){Pc.a.$(512262997,811,10,"TryParseFileRevisionList() - Exception: "+V)}return{returnValue:!!qb,NVf:qb}}Vxn(ja){return!rd(ja,this.jee)}Nbm(ja,qb){ja.kGa&&qb.Fm("GetAuthorNamesRequestInvokedTime",ja.kGa);qb.Za("GetAuthorNamesRequestCorrelationId",ja.ni)}Odn(ja){if(!ja)return[];const qb=Array(ja.length);for(let Ea=0;Ea<ja.length;Ea++){var V=ja[Ea];V=Object.assign(new Ha,{displayName:V.userNameField,
id:V.userIdField,provider:V.providerIdField});qb[Ea]=V}return qb}}Object(m.a)(Rd,"FileRevisionHistoryService",null,[603,40]);class me{constructor(ja,qb){nh(ja,"FlyoutFocus.IF6Manager");nh(qb,"FlyoutFocus.IFocusManagerHelper");this.Hj=ja;this.fT=qb}initialize(){this.fT.nYa(ee.a.TAc,ee.a.Wl,null,Object(da.a)(this,this.ccn,"focusOnFirstFlyoutItem"),()=>{},!0)}enableF6Focus(){this.Hj.jZ(ee.a.TAc)}disableF6Focus(){this.Hj.ns(ee.a.TAc)}ccn(){const ja=document.getElementById("flyoutItem0");ja&&(Pc.a.$(570730465,
3012,50,"Focused on the catch-up flyout via ctrl+F6"),ja.focus())}}Object(m.a)(me,"FlyoutFocus",null,[602]);class ce{constructor(ja,qb,V,Ea){this.mQh=null;this.Qcm=this.GRh=this.Q_e=this.lzg=!1;nh(qb,"FlyoutRibbonButton.IActionManagerExtended");nh(V,"FlyoutRibbonButton.IFocusManager");nh(Ea,"FlyoutRibbonButton.FloodgateEventLogger");this.Gb=ja;this.la=qb;this.Na=V;this.yEn=Ea;this.zEn=new Date}initialize(){n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&oe.a("DelayRegisterCatchUpActions")||this.Kb()}registerButtonClickedEvent(ja){this.mQh&&Pc.a.$(507843654,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.mQh=ja.buttonClickedCallback}onFlyoutInitialized(){this.lzg&&Pc.a.$(507843653,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const ja=(new Date).getTime()-this.zEn.getTime();Pc.a.$(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",ja);this.lzg=
!0;Eb.c(Xa.a.MTl,!0,Eb.e,0,0,ja);n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&oe.a("DelayRegisterCatchUpActions")&&this.Kb();n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)||this.Gb&&this.Gb.fg()}logFlightTriggers(){}onFlyoutVisibilityChanged(ja){this.Q_e!==ja.flyoutIsVisible&&(this.Q_e=ja.flyoutIsVisible,this.Gb&&this.Gb.fg(!0),this.Q_e&&this.Qcm?this.Na.Ag(ee.a.TAc):this.Q_e||
this.Na.Ag(ee.a.Wl),this.Q_e||this.yEn.yBn())}Kb(){this.la.Ba(Xa.a.t7e,Qa.a.frame,Object(da.a)(this,this.IUn,"onToggleCatchUpFlyout"));this.la.ua(Xa.a.BXh,Qa.a.frame,Object(da.a)(this,this.tTn,"onQueryToggleCatchUpFlyout"),96)}IUn(ja,qb,V){ja=n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1);if(1===V)return ja||this.lzg?(this.GRh||(this.GRh=!0,Pc.a.$(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(ja&&!this.lzg)return Pc.a.$(507647624,
3012,15,"Flyout isn't initialized yet."),8;if(!this.mQh)return 8;this.Qcm=!0;this.mQh();return 32}tTn(ja,qb,V,Ea,Za){Za[Ra.a.Visible]=!0;Za[Ra.a.On]=this.Q_e&&this.lzg;return 32}}Object(m.a)(ce,"FlyoutRibbonButton",null,[600]);const yb=ja=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+ja)};class Tc{constructor(ja,qb,V,Ea,Za,ia){nh(ja,"PowerPointActivityNavigationManager.IActionManagerExtended");nh(qb,"PowerPointActivityNavigationManager.IPresentationReader");
nh(V,"PowerPointActivityNavigationManager.IThumbnailNavigationPaneView");nh(Ea,"PowerPointActivityNavigationManager.IRibbonUser");nh(ia,"PowerPointActivityNavigationManager.IActivityContentManager");this.la=ja;this.rc=qb;this.Nf=V;this.Gy=Ea;this.uGn=Za;this.jDn=ia}navigateToActivity(ja){if(ja.fromSummaryString)return this.Iao(),this.Hnn(),this.Gnn(),this.feo(),Promise.resolve(1);ja=ja.activity;if(!ja)return Pc.a.$(508039178,3012,10,"NavigateToActivity: activity is null."),Promise.resolve(8);if(!ja.navigationId)return Pc.a.$(508039177,
3012,10,"NavigateToActivity: navigation id is null."),Promise.resolve(4);if(!this.jDn.doesContentExist(ja))return Promise.resolve(2);switch(ja.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:case 12:ja=fh(ja);if(!ja)return Promise.resolve(5);ja=this.la.Ra(Xa.a.ePd,2,ja);return Promise.resolve(32===ja?1:6);default:return Promise.resolve(7)}}Iao(){const ja=this.rc.In;ja?ja.Vkc=!0:Pc.a.$(508039176,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}Hnn(){this.Gy.selectRibbonTabById(this.uGn)}Gnn(){var ja=
this.rc.In;if(ja&&ja.slides){var qb=null;for(const V of ja.slides)if(V&&(ja=this.rc.pl(V.fc))&&ja.isUnread){qb=ja;break}qb?this.Nf.Z$(qb.Dh):Pc.a.$(508039174,3012,15,"PowerPointActivityNavigationManager: Could not find any unread slides.")}else Pc.a.$(508039175,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}feo(){this.la.Ra(Yc.a.zLb,2,{InvokeSource:1,ShowRevisionTrackingStatus:3})}}Object(m.a)(Tc,"PowerPointActivityNavigationManager",null,[554]);var bd=a(829);class kd{constructor(){this.collectionId=
this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(m.a)(kd,"ActivityFeedEntry",null,[]);const zd=(ja,qb)=>qb.sbe?z.toArray(z.select(z.asEnumerable(ja),V=>{if(!V||!V.activityFeedItemPayload)return V;const Ea=JSON.parse(V.activityFeedItemPayload);var Za=Ea.actor;if(!Za||Za.pictureUrl)return V;const ia=Za.userPrincipalName||Za.email;if(!ia)return V;Za=qb.cWb(ia,Za.provider,n.AFrameworkApplication.Fh,0);if(!Za)return V;Ea.actor.pictureUrl=Za;return Object.assign(new kd,
{id:V.id,type:V.type,collectionId:V.collectionId,activityState:V.activityState,activityFeedItemPayload:JSON.stringify(Ea),timestamp:V.timestamp})})):ja,fe=(ja,qb)=>{const V=new Map,Ea=new Map;for(const Za of ja){if(!Za||!Za.activityFeedItemPayload)continue;ja=JSON.parse(Za.activityFeedItemPayload).actor;if(!ja)continue;const ia=ja.email||ja.userPrincipalName;ia&&!Ea.has(ia)&&Ea.set(ia,new bd.a(ia,null,ja.name))}Ea.forEach(Za=>{const ia=qb.z5a(Za,6);V.set(Za.UserId,ia)});return V};class Ye{constructor(){this.collectionId=
this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(m.a)(Ye,"ActivityFeedItem",null,[]);class pf{constructor(){this.personaColorMap=this.activityFeedItems=null}}Object(m.a)(pf,"ActivityFeedPayload",null,[]);class Je{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(m.a)(Je,"ActivityRequestPayload",null,[]);var Ff=a(756);class Cg{constructor(){this.activityFeedItemId=
this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(m.a)(Cg,"Activity",null,[]);class sh{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc){this.rf=this.Igk=null;nh(ja,"PowerPointActivityRequestManager.IJsonpHelperManager");nh(qb,"PowerPointActivityRequestManager.PowerPointWaterlineUpdater");nh(V,"PowerPointActivityRequestManager.IFileRevisionHistoryService");nh(Ea,"PowerPointActivityRequestManager.IAppSettingsManager");
nh(Za,"PowerPointActivityRequestManager.IApplicationSettings");nh(ia,"PowerPointActivityRequestManager.IActionManagerExtended");nh(Va,"PowerPointActivityRequestManager.ICatchUpRequestHandler");nh(Ab,"PowerPointActivityRequestManager.IUserProfilePictureUtilsV2");nh(gc,"PowerPointActivityRequestManager.IPeopleColorUtils");this.ysa=ja;this.BHn=qb;this.uEn=V;this.Jb=Ea;this.la=ia;this.qQh=Va;this.dGn=Ab;this.Ene=gc;this.Chm=Hc}requestWYWAActivities(){return new Promise((ja,qb)=>{this.rf=Uf.a.Xk("ShowWYWACallout",
2);this.BHn.C8n(V=>{V=this.N1n(V);sh.isExpectedError(V)?ja(sh.KIh):V?(Pc.a.$(509223009,3012,10,"OnReadRoamingSucceeded() - Error: {0}",V),qb(V)):this.uEn.fhn(this.Igk,this.rf,(Ea,Za)=>{Za&&(Pc.a.$(509223008,3012,10,"GetFileRevisionAuthorNamesAsync() - Error: {0}",Za),qb(Za));ja(sh.S2m(Ea))})},V=>{const Ea=!!V.data&&sh.cxn(V.data.Je);V=this.ysa.WX(V);Pc.a.$(509223007,3012,Ea?50:10,"OnReadRoamingFailed() - Error: {0}",V);Ea?ja(sh.KIh):qb(V)})})}requestActivities(){return Promise.resolve(sh.KIh)}requestRelevantActivities(){return Promise.resolve(sh.KIh)}requestActivityFeed(){return this.qQh?
Ff.b(this.qQh.Ndn(this.Chm)).then(ja=>{ja=sh.zjo(ja);return{activityFeedItems:zd(ja,this.dGn),personaColorMap:fe(ja,this.Ene)}}):Promise.resolve(Object.assign(new pf,{activityFeedItems:[]}))}updateActivityState(ja){return this.qQh?Ff.b(this.qQh.slo(this.Chm,ja.itemIds,ja.activityStatesToSet||0,ja.activityStatesToReset||0,ja.resetUnseenCount)):Promise.resolve(!1)}N1n(ja){ja=ja.data.responseData;if(!ja)return"ErrorReadRoamingEmptyResponseBody";let qb;try{qb=JSON.parse(ja)}catch(V){return V.toString()}ja=
null;if(!qb.Error){if(!qb.Timestamp)throw Error.create("response.Error and response.Timestamp are empty");ja=qb.Timestamp}this.Igk=this.Wmo(ja);Pc.a.$(509223006,3012,100,"Timestamp for retrieving activities: "+this.Igk);return qb.Error}Wmo(ja){const qb={};var V=this.Jb.Ac("AppWaterlineOverrideTimestampValue",0);return V?(ja=new Date(1E3*V),qb.timestamp=ja,this.la.Ra(Yc.a.s6e,2,qb),ja.format("yyyy-MM-ddTHH:mm:ssZ")):ja?(V=this.Jb.Ac("AppWaterlineOverrideDaysValue",0))?(ja=new Date(+new Date(ja)-+new Date(864E5*
V)),qb.timestamp=ja,this.la.Ra(Yc.a.s6e,2,qb),ja.format("yyyy-MM-ddTHH:mm:ssZ")):ja:null}static S2m(ja){return ja?Object.assign(new Je,{actors:ja}):null}static zjo(ja){const qb=[];if(!ja)return qb;for(const V of ja)qb.push(Object.assign(new Ye,{id:V.id,type:V.type,collectionId:V.collectionId,activityState:V.activityState,activityFeedItemPayload:V.activityFeedItemPayload,timestamp:V.timestamp}));return qb}static isExpectedError(ja){return"ErrorDocNotInRoamingList"===ja||"ErrorLastViewedDocListIsEmpty"===
ja}static cxn(ja){return 403===ja}}sh.KIh=Object.assign(new Je,{activities:[],actors:[],hasMore:!1,highWaterline:"",lowWaterline:"",wywaWaterline:""});Object.assign(new Je,{activities:[Object.assign(new Cg,{activityId:"activityId1",type:3,actors:[Object.assign(new Ha,{id:"personId1",provider:"provider",displayName:"Kat Larsson",email:"klarsson@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId1"}),Object.assign(new Cg,{activityId:"activityId2",type:4,actors:[Object.assign(new Ha,
{id:"personId2",provider:"provider",displayName:"Frankie Smith",email:"fsmith@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId2"})]});Object.assign(new pf,{activityFeedItems:[Object.assign(new Ye,{id:"FeedItemId1",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"1","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a1","navigationId":"n1","commentThreadId":"1","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"kat.larsson@microsoft.com","userPrincipalName":"klarsson@microsoft.com","name":"Kat Larsson","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()}),Object.assign(new Ye,{id:"FeedItemId2",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"2","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a2","navigationId":"n2","commentThreadId":"2","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"frankie.smith@microsoft.com","userPrincipalName":"fsmith@microsoft.com","name":"Frankie Smith","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()})]});Object(m.a)(sh,"PowerPointActivityRequestManager",null,[555]);var Og=a(258);class Ch{constructor(ja,qb,V,Ea,Za,ia){this.IJb=!1;this.agm=null;this.ud=ja;this.Iq=qb;this.vGn=V;this.ysa=Ea;this.Yb=Za;this.P0e=ia}initialize(){this.ud&&(this.ud.Teb(Object(da.a)(this,this.Fhb,"onBeforeSessionEnd")),this.ud.GF(Object(da.a)(this,this.DR,"onSessionClosed")));this.D9n()}C8n(ja,qb){const V=this.k4l("getPPTDocLastViewedTimestamp");this.gH(V,1,ja,qb)}Fhb(){this.yFm()}DR(){this.IJb=
!0}D9n(){if(this.Yb){var ja=new jc.a(3,2,3E4,Object(da.a)(this,this.R7n,"requestWriteWaterline"),90,"29");this.Yb.Rb(ja)}}R7n(){!this.IJb&&3E4<+Uf.a.HQc-+this.agm&&(this.yFm(),this.agm=Uf.a.HQc)}yFm(){const ja=this.k4l("savePPTDocLastViewedTimestamp");this.P0e.getBooleanAppSetting("SendBeaconOnRoamingRequestsIsEnabled")?this.Iq.rea(ja,""):this.gH(ja,2,Object(da.a)(this,this.ZUn,"onWriteWaterlineSucceeded"),Object(da.a)(this,this.YUn,"onWriteWaterlineFailed"))}ZUn(ja){let qb=null;try{const V=ja.data.responseData;
qb=V?JSON.parse(V).Error:"ErrorWriteRoamingEmptyResponseBody"}catch(V){qb="ErrorWriteRoamingParseJsonResponseException",Pc.a.$(507843781,3012,10,"OnWriteRoamingSucceeded() - Exception: "+V)}finally{qb&&this.Wbm(qb)}Pc.a.$(507843780,3012,50,"OnWriteRoamingSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+ja.data.Gp-+ja.data.Wy,+ja.data.Oo-+ja.data.Wy)}YUn(ja){this.Wbm("ErrorReadRoamingFailed");Pc.a.$(507843779,3012,10,"OnWriteRoamingFailed() - Failure message: {0}",this.ysa.WX(ja))}k4l(ja){return this.vGn+
String.format("RoamingServiceHandler.ashx?action={0}&{1}",ja,n.AFrameworkApplication.Fh)}gH(ja,qb,V,Ea){const Za={};Za["X-StatelessPopsAffinityRoutingEnabled"]=this.P0e.getBooleanAppSetting("PPTStatelessPOPSRequestAffinityEnabled").toString();this.Iq.ik(ja,qb,null,Za,!1,1,V,Ea,null,void 0,void 0,void 0,void 0,Og.a("5"))}Wbm(ja){Pc.a.$(507843778,811,50,ja)}}Object(m.a)(Ch,"PowerPointWaterlineUpdater",null,[]);class Pg{get name(){return"PowerPointWebEditor.Activity"}get ZMj(){return n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",
!1)}init(){this.ga.resolve("Common.IAppSettingsManager").Wf(Object(da.a)(this,this.d7m,"delayedInit"))}oc(ja){this.ga=ja}dispose(){this.ga=this.pQh=null}Xco(ja){return!ja||ja.getBooleanAppSetting("IsAnonymousUser")?!1:ja.getBooleanAppSetting("PPTCatchUpFlyoutIsEnabled")}d7m(){const ja=this.ga.resolve("Common.IAppSettingsManager");this.Xco(ja)&&(yb("Begin"),this.W8m(),this.PBn())}W8m(){xc.a.get_instance().Ai(7,()=>{yb("ScriptDownload");Id.a(this.ga)("catchUpActivity").catch(()=>{Pc.a.$(512262995,3012,
10,"Failed to download catch-up script")}).then(()=>this.$tn()).catch(()=>{Pc.a.$(512262994,3012,10,"Failed to initialize shared catch-up code")})})}PBn(){Pc.a.$(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.ZMj&&Pc.a.$(526718752,3012,50,"ActivityFeedData is enabled")}$tn(){const ja=new Rd(this.ga.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.ga.resolve("Common.IAppSettingsManager"),this.ga.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler")),qb=
this.ga.resolve("Common.AFrameworkApplication");this.ga.register(Ch,"PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").oa().pa(()=>new Ch(this.ga.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),n.AFrameworkApplication.$d,this.ga.resolve("PowerPointWebEditor.IApplicationSettings").w0,this.ga.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.ga.resolve("Common.ITaskManager"),this.ga.resolve("Common.IAppSettingsManager")));this.ga.register(553,"Common.App.CatchUpActivity.IActivityContentManager").oa().pa(()=>
new ng(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings")));this.ga.register(554,"Common.App.CatchUpActivity.IActivityNavigationManager").oa().pa(()=>new Tc(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.ga.resolve("PowerPointWebEditor.IRibbonUser"),Od.a.Ism,this.ga.resolve("Common.App.CatchUpActivity.IActivityContentManager")));
let V=null;this.ga.resolve("PowerPointWebEditor.IApplicationSettings").li&&(V=this.ga.resolve("Common.IAppSettingsManager").Ma(Td.a.daa)+"p");this.ga.register(555,"Common.App.CatchUpActivity.IActivityRequestManager").oa().pa(()=>new sh(this.ga.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.ga.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater"),ja,this.ga.resolve("Common.IAppSettingsManager"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.ga.resolve("Common.IActionManagerExtended"),
this.ga.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler"),this.ga.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.ga.resolve("Common.App.People.IPeopleColorUtils"),V));this.ga.register(ce,"PowerPointWebEditor.Activity.FlyoutRibbonButton").as("Common.App.CatchUpActivity.IFlyoutRibbonButton").oa().pa(()=>new ce(qb.Bj,n.AFrameworkApplication.ub,this.ga.resolve("PowerPointWebEditor.IFocusManager"),this.ga.resolve("Common.App.CatchUpActivity.FloodgateEventLogger")));this.ga.register(me,
"PowerPointWebEditor.Activity.FlyoutFocus").as("Common.App.CatchUpActivity.IFlyoutFocus").oa().pa(()=>new me(this.ga.resolve("Common.IF6Manager"),this.ga.resolve("PowerPointWebEditor.View.IFocusManagerHelper")));this.ga.register(556,"Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").oa().pa(()=>new R(this.ga.resolve("Common.IActionManagerExtended")));this.pQh=catchUpActivity.FactoryGlobal.getPowerPointCatchUpAppInstance(Object.assign(new xj,{activityContentManager:this.ga.resolve("Common.App.CatchUpActivity.IActivityContentManager"),
activityNavigationManager:this.ga.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.ga.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),dataCulture:n.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.ZMj?this.ga.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutFocus:this.ga.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),flyoutRibbonButton:this.ga.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),
uiCulture:n.AFrameworkApplication.uiCulture,ulsLogger:new Xj.a}));if(!this.pQh)return Promise.reject("Failure to create CatchUpApp");this.ga.resolve("PowerPointWebEditor.Activity.FlyoutRibbonButton").initialize();this.ga.resolve("PowerPointWebEditor.Activity.FlyoutFocus").initialize();this.pQh.setWebpackPublicPath(n.AFrameworkApplication.j6);yb("InitializeCatchUpApp");return this.pQh.initialize(Object.assign(new Ij,{activityFeedDataEnabled:this.ZMj,featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0})).then(()=>
{this.ga.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").initialize()})}static main(){I.a.instance.Jc(Xc.a(new Pg,0))}}Object(m.a)(Pg,"PPTWebEditorActivityPackage",null,[4,5]);var ch=a(1570);class Fi extends Sys.EventArgs{constructor(ja,qb){super();this.shape=ja;this.Vkc=qb}}Object(m.a)(Fi,"ShowHideStateChangedEventArgs",Sys.EventArgs,[]);class Gi{constructor(ja,qb,V,Ea,Za,ia,Va){this.rf=null;this.la=ja;this.ya=qb;this.YYa=V;this.dTh=Ea;this.Xb=Za;this.Fd=ia;this.H0e=Va}dispose(){this.rf&&
(this.rf=null)}Ae(){}Kb(){this.la.Ba(Yc.a.g1e,$b.a.application,Object(da.a)(this,this.Mon,"handleMarkAsRead"));this.la.Ba(Yc.a.zLb,$b.a.application,Object(da.a)(this,this.zpn,"handleShowHideChanges"));this.la.ua(Yc.a.e4e,ad.a.application,Object(da.a)(this,this.gpn,"handleQueryShowHideChanges"),96);this.la.ua(Yc.a.s6e,$b.a.application,Object(da.a)(this,this.Apn,"handleShowRevisionTrackingWithUrlOverrides"),96)}Mon(ja,qb,V,Ea,Za){if(1===V)return this.Xb.zl()?32:8;ja=new Date;if(!Za)throw Error.argumentNull("actionData is null");
if(Za.SlideNode){if(Za=Object(Rb.a)(22,Za.SlideNode))Pc.a.$(509654912,804,50,String.format("HandleMarkAsRead: Mark slide {0} as read",Za.slideIndex+1)),this.YYa.slg?this.YYa.sUh(Za,!0):(Za.Tra=ja,this.YYa.FUk(Za))}else this.bqk(ja);return 32}bqk(ja){const qb=this.ya.presentation;if(!qb)throw Error.argumentNull("Presentation is null");this.rf=Uf.a.Xk("MarkActivitiesAsRead",1);Pc.a.$(509654883,804,50,"MarkAllSlidesAsRead: User marks slides as read via Ribbon button");this.YYa.slg?this.YYa.bqk():(zc.b(qb.slides||
[],null,V=>{if(V=Object(Rb.a)(22,V))V.Tra=ja}),this.YYa.Xsm())}zpn(ja,qb,V,Ea,Za){if(1===V)return this.Xb.zl()?32:8;const ia=this.Xb.In;ja=this.ya.Ia;if(!(ia&&ja&&ja.isConnected&&Za))return 16;V=qb=!1;switch(Za.ShowRevisionTrackingStatus){case 0:V=qb=!1;break;case 2:qb=!0;V=!1;break;case 3:V=qb=!0;break;case 1:qb=ia.Vkc&&!this.YYa.zKi?!0:!ia.Vkc;V=!0;break;default:return 8}if(this.YYa.zKi&&!V)return 32;Za=Za.InvokeSource;ia.Vkc=qb;this.YYa.zKi=qb&&V;V&&this.H0e.pCn(Za,qb);Za=ja.Nj();zc.b(Za,null,
Va=>{this.dTh.d3n(new Fi(Va,ia.Vkc))});this.Fd.hJ(new Ph.a(1));return 32}gpn(ja,qb,V,Ea,Za){ja=this.Xb.In;if(!ja)return 16;Za.Fg(ja.Vkc);return 32}Apn(ja,qb,V,Ea,Za){ja=this.ya.presentation;if(!Za||!ja||!ja.slides)return 8;Za=Za.timestamp;if(!Za)return 8;for(const ia of ja.slides)Object(Rb.a)(22,ia).Tra=Za;this.YYa.GUk(ja.slides);return 32}}Object(m.a)(Gi,"RevisionTrackingActor",null,[502,40]);class $g{constructor(ja){this.backgroundColor=this.foregroundColor=null;ja&&ja.isInHighContrastMode&&ja.highContrastColors?
(this.foregroundColor=ja.highContrastColors.foregroundTextColor||"#006BFF",this.backgroundColor=ja.highContrastColors.backgroundColor||"#006BFF"):this.backgroundColor=this.foregroundColor="#006BFF"}}Object(m.a)($g,"RevisionTrackingColorProvider",null,[]);class gh{constructor(){this.xa=new Ah.a}e3n(ja){this.xa.raiseEvent("SlideUSC",ja)}zTe(ja){this.xa.addHandler("SlideUSC",ja)}yYh(ja){this.xa.removeHandler("SlideUSC",ja)}c3n(ja){this.xa.raiseEvent("ShapeUSC",ja)}NVm(ja){this.xa.addHandler("ShapeUSC",
ja)}O6n(ja){this.xa.removeHandler("ShapeUSC",ja)}d3n(ja){this.xa.raiseEvent("ShowHideSC",ja)}PVm(ja){this.xa.addHandler("ShowHideSC",ja)}P6n(ja){this.xa.removeHandler("ShowHideSC",ja)}}Object(m.a)(gh,"RevisionTrackingEventSource",null,[654,655,656]);class Wi extends Sys.EventArgs{constructor(ja,qb){super();this.shape=ja;this.slide=qb}}Object(m.a)(Wi,"ShapeUnreadStateChangedEventArgs",Sys.EventArgs,[]);class yj{constructor(){this.cid=this.sid=0}}Object(m.a)(yj,"Slide",null,[]);class qk{constructor(ja,
qb){this.dt=this.mk=null;this.mk=Object.assign(new yj,{sid:ja.sid,cid:ja.cid});this.dt=qb}}Object(m.a)(qk,"SlideLastViewedVersion",null,[]);class Jj{constructor(){this.v=0;this.lv=this.defLv=null;this.v=1}}Object(m.a)(Jj,"SlideLastViewedVersions",null,[]);class Ai extends Sys.EventArgs{constructor(ja){super();this.slide=ja}}Object(m.a)(Ai,"SlideUnreadStateChangedEventArgs",Sys.EventArgs,[]);class Rk{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd,yd,Md,te,Pe){this.Cfe=this.jee=null;this.zem=!1;this.xek=
null;this.eSh=0;this.ZVc=this.$Cg=null;this.Lik=[];this.OSh=null;this.nTh=!1;this.Gnc=null;this.SCj=this.RCj=this.zKi=!1;Pc.a.$(512262749,804,50,"Start RevisionTrackingManager::RevisionTrackingManager()");this.Blk=ja;this.ya=qb;this.Yb=V;this.qc=Ea;this.Xb=Za;this.od=ia;this.LSg=Va;this.ud=Ab;this.Ri=gc;this.dTh=fd;this.Ihm=Hc;this.Jb=yd;this.EHn=hd.a3e;this.Ffm=hd.E$l;this.Rhm=!0;this.AM=!1;this.sYc=new gg.a;this.ud.eKd(Object(da.a)(this,this.cJa,"onSessionAccessTokenExpired"));n.AFrameworkApplication.Iz&&
this.ud.DTe(Object(da.a)(this,this.Nhb,"onWopiTokenRefreshed"));this.Jb.Wf(()=>{this.RCj=!0;this.initialize();this.Xsm();this.RCj=!1});this.H0e=Md;this.zb=te;this.OGn=Pe}get slg(){return oe.a("WriteSlideLastViewedVersionsOnRead")}dispose(){this.jee&&(this.od.Cbb(Object(da.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.od.D4e(Object(da.a)(this,this.$zb,"onShapeViewElementAdded")),this.LSg.lYh(Object(da.a)(this,this.Nue,"onMarkedUndo")),this.ud.$De(Object(da.a)(this,this.Fhb,"onBeforeSessionEnd")),
this.ud.kaa(Object(da.a)(this,this.DR,"onSessionClosed")),this.ud.Tna(Object(da.a)(this,this.qr,"onSessionRehydrated")),this.Ri.Lum(Object(da.a)(this,this.vnm,"onSlideChangesDataChanged")),this.Ri.Cum(Object(da.a)(this,this.Rmm,"onPresentationLastModifiedTimeReceived")),this.Ffm&&this.Ihm.rr(Object(da.a)(this,this.mnm,"onShapePropertyChanged")),this.ud.uYh(Object(da.a)(this,this.cJa,"onSessionAccessTokenExpired")))}initialize(){Pc.a.$(512262748,804,50,"Start RevisionTrackingManager::Initialize()");
this.xek=new Date;this.eSh=this.xek.getTime();this.W$n();this.od.Hha(Object(da.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.od.iid(Object(da.a)(this,this.$zb,"onShapeViewElementAdded"));this.LSg.sTe(Object(da.a)(this,this.Nue,"onMarkedUndo"));this.ud.Teb(Object(da.a)(this,this.Fhb,"onBeforeSessionEnd"));this.ud.GF(Object(da.a)(this,this.DR,"onSessionClosed"));this.ud.eI(Object(da.a)(this,this.qr,"onSessionRehydrated"));this.Ri.GQl(Object(da.a)(this,this.vnm,"onSlideChangesDataChanged"));
this.Ri.vQl(Object(da.a)(this,this.Rmm,"onPresentationLastModifiedTimeReceived"));this.Ffm&&this.Ihm.Rm(Object(da.a)(this,this.mnm,"onShapePropertyChanged"));this.Gnc=this.ya.Ia;this.Cfe=this.egn();this.getSlideLastViewedVersions();const ja=new jc.a(3,2,this.EHn,()=>{this.getSlideLastViewedVersions()},90,"12");this.Yb.Rb(ja)}onActiveSlideDomReady(ja,qb){ja=Object(Rb.a)(22,qb.Ia);this.Gnc&&ja!==this.Gnc&&this.Yfl()&&(this.Gnc.isConnected&&(this.Gnc.isUnread&&this.sUh(this.Gnc,!0),!this.slg&&this.Gnc.changesData&&
(this.Gnc.Tra=this.Gnc.changesData.dtField)),ja&&ja.isUnread&&this.ctm(ja));this.Gnc=ja;this.eSh=Date.now()}Nue(ja,qb){qb.actionId!==zb.a.ona&&qb.Smd&&(ja=this.ya.Ia)&&ja.isConnected&&ja.isUnread&&this.Yfl()&&this.sUh(ja,!0)}Fhb(){this.Yfl()&&this.rlo();this.H2h()}DR(){this.H0e.log();this.AM=!0}qr(){this.AM=!1;this.$Cg&&this.UDm(this.$Cg)}UDm(ja){var qb=this.ya.presentation;if(!qb)throw Error.argumentNull("Presentation is null");qb=qb.slides||[];0<qb.length&&(this.Omo(qb,ja),this.GUk(qb))}wTn(ja){this.SCj=
!0;Pc.a.$(512262747,804,50,"OnReceiveLastViewedVersionInfo()");ja&&(this.sYc=new gg.a,this.forEach(ja.lv,Ea=>{const Za=Ea.mk.sid;(!this.sYc.Sb(Za)||this.sYc.ka(Za).dt<Ea.dt)&&this.sYc.fa(Za,Ea)}));const qb=Uf.a.HQc;let V=!1;this.ZVc&&this.Blk.Dbe&&qb!==this.ZVc&&(this.$Cg&&ec.c(this.v1l())===ec.c(this.$Cg)||(V=!0));ja&&ja.defLv&&(this.Cfe=ja.defLv,this.Rhm=!1,ja.lv&&0<ja.lv.length&&this.UDm(ja));V&&this.H2h();this.ZVc=Uf.a.HQc;this.SCj=!1}vnm(ja,qb){this.forEach(qb.slides,V=>{this.COj(V.changesData)||
(this.ya.Ia&&V.fc!==this.ya.Ia.fc||this.Cqn(Object(Rb.a)(22,V)))&&this.FUk(Object(Rb.a)(22,V))})}Rmm(ja,qb){this.Rhm&&(this.Cfe=qb.zrm)}mnm(ja,qb){ja=qb.property;qb=Object(Rb.a)(351,qb.node);ja===Rf.a.toc&&(ja=this.qc.Hg(qb),ja===this.ya.Ia&&ja.isUnread&&qb.changesData.dtField<=ja.changesData.dtField&&(Pc.a.$(512262746,804,50,"Trying to highlight a shape in active slide, time elapsed after last slide navigation: {0}ms",Date.now()-this.eSh),this.EUk(this.ya.Ia,qb)))}$zb(ja,qb){ja=qb.pJ.shapeNode;this.ya.Ia.isUnread&&
this.FPc(this.ya.Ia.fc,ja)&&!this.COj(ja.changesData)&&(this.Lik.push(ja),this.OSh||(this.OSh=new jc.a(2,1,0,Object(da.a)(this,this.tryHighlightInsertedShapes,"tryHighlightInsertedShapes"),90,"13"),this.Yb.Rb(this.OSh)))}getSlideLastViewedVersions(){this.AM||this.nTh||this.Blk.getSlideLastViewedVersionInfo(Object(da.a)(this,this.wTn,"onReceiveLastViewedVersionInfo"))}H2h(){if(!this.AM&&!this.nTh){var ja=this.v1l();this.Blk.putSlideLastViewedVersionInfo(ja);this.$Cg=ja}}v1l(){const ja=this.ya.presentation;
if(!ja)throw Error.argumentNull("Presentation is null");const qb=Object.assign(new Jj,{defLv:this.Cfe}),V=[];this.forEach(ja.slides||[],Ea=>{Ea=Ea.fc;const Za=this.Xb.pl(Ea);Za&&Za.Tra&&(!Ea.cid&&this.sYc.Sb(Ea.sid)?Ea=Xe.a.Er(Ea.sid,this.sYc.ka(Ea.sid).mk.cid):Ea.cid&&this.sYc.Sb(Ea.sid)&&Ea.cid!==this.sYc.ka(Ea.sid).mk.cid&&Pc.a.$(512262745,804,50,"The same sid {0} has different cid. Roaming cid:{1}, Slide node cid:{2}",Ea.sid,this.sYc.ka(Ea.sid),Ea.cid),V.push(new qk(Ea,Za.Tra)))});qb.lv=V;return qb}Omo(ja,
qb){const V=qb.lv;this.forEach(ja,Ea=>{const Za=Object(Rb.a)(22,Ea);this.forEach(V,ia=>{Za&&this.uXm(Za,ia.mk)&&(!Za.Tra||Za.Tra<ia.dt)&&(Za.Tra=ia.dt)})})}uXm(ja,qb){return ja.cid&&qb.cid?ja.sid===qb.sid&&ja.cid===qb.cid:ja.sid===qb.sid}GUk(ja){this.forEach(ja,qb=>{this.FUk(Object(Rb.a)(22,qb))})}Xsm(){var ja=this.ya.presentation;if(!ja)throw Error.argumentNull("Presentation is null");ja=ja.slides||[];0<ja.length&&this.GUk(ja)}ctm(ja){this.hFm(ja,qb=>{this.EUk(ja,qb)})}FUk(ja){if(ja&&ja.isConnected&&
ja.changesData){const qb=this.mOh(ja.changesData,this.KLh(ja));qb!==ja.isUnread&&(this.bjm(ja,qb),this.Gko(),ja===this.ya.Ia&&this.ctm(ja))}}EUk(ja,qb){if(qb&&qb.isConnected&&qb.Va(Rf.a.toc)){const V=this.mOh(qb.changesData,this.KLh(ja));this.ajm(ja,qb,V)}}ajm(ja,qb,V){V!==qb.isUnread&&(Pc.a.$(512262744,804,50,"Shape unread state changed: {0} -> {1}",qb.isUnread,V),qb.isUnread=V,this.dTh.c3n(new Wi(qb,ja)))}bjm(ja,qb){qb!==ja.isUnread&&(Pc.a.$(512262743,804,50,"Slide unread state changed: {0} -> {1}, SlideId={2}",
ja.isUnread,qb,ja.fc.toString()),ja.isUnread=qb,this.dTh.e3n(new Ai(ja)))}sUh(ja,qb){if(this.slg){if(!ja)throw Error.argumentNull("ISlideNode is null");this.Nmo(ja);Pc.a.$(509654915,804,50,"MarkSlideAsRead - SlideId={0}, isUnread={1}, writeToRoaming={2}",ja.fc.toString(),ja.isUnread,qb);if(!ja.isUnread)return!1}this.hFm(ja,V=>{this.ajm(ja,V,!1)});this.bjm(ja,!1);this.slg&&qb&&this.H2h();return!0}bqk(){const ja=this.ya.presentation;if(!ja)throw Error.argumentNull("Presentation is null");let qb=!1;
this.forEach(ja.slides,V=>{V=this.sUh(Object(Rb.a)(22,V),!1);qb||(qb=V)});Pc.a.$(509654914,804,50,"MarkAllSlidesAsRead - requiresWriteToRoaming={0}",qb);qb&&this.H2h()}hFm(ja,qb){ja&&(ja=ja.Nj(),this.forEach(ja,V=>{qb(V)}))}forEach(ja,qb){zc.b(ja,null,qb)}COj(ja){return rd(ja,this.jee)}mOh(ja,qb){return!!ja&&!!ja.dtField&&!this.COj(ja)&&ja.dtField>qb}egn(){const ja=this.Xb.In;if(ja&&ja.W6g)return ja.W6g;Pc.a.$(512262742,808,50,"GetDefaultLastViewedTime - No PresLastModifiedTime");return new Date}Hwn(ja){const qb=
Object(Rb.a)(22,this.OGn.kMh(ja));return qb&&qb.isUnread&&ja&&this.mOh(ja.changesData,this.KLh(qb))}W$n(){this.jee=new Wc(this.Jb.Ma("UserName"),this.Jb.Ma(Td.a.ZTa),this.Jb.Ma(Td.a.dcc))}Nmo(ja){ja.Tra=ja&&ja.changesData?ja.changesData.dtField:this.Cfe}rlo(){const ja=this.ya.Ia;ja&&(ja.Tra=ja.changesData?ja.changesData.dtField:this.Cfe)}KLh(ja){return ja.Tra||this.Cfe}Gko(){this.zem||(this.zem=!0,Pc.a.$(512262741,804,50,"First revision tracking view render completed!"))}Cqn(ja){return ja.isConnected&&
ja.changesData&&ja.changesData.dtField?ja.changesData.dtField<=this.xek&&this.mOh(ja.changesData,this.KLh(ja)):!1}FPc(ja,qb){return ja.equals(qb.slideId)}tryHighlightInsertedShapes(){Pc.a.$(512262740,804,50,"Trying to highlight inserted shapes on active slide, time elapsed after last slide navigation: {0}ms",Date.now()-this.eSh);this.OSh=null;const ja=this.ya.Ia;if(ja&&ja.isUnread){const qb=ja.fc;for(const V of this.Lik)this.FPc(qb,V)&&this.EUk(ja,V)}Array.clear(this.Lik)}cJa(){this.nTh=!0}Nhb(ja,
qb){try{qb.Okg?(Pc.a.$(512262739,804,50,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh succeeded."),this.nTh=!1):Pc.a.$(512262738,804,15,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh failed.")}catch(V){Pc.a.$(512262737,804,10,"RevisionTrackingManager::OnWopiTokenRefreshed Exception: {0}",V)}}Yfl(){return 1!==this.zb.fj}}Object(m.a)(Rk,"RevisionTrackingManager",null,[]);class dj{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc,fd){this.ya=ja;this.Xb=qb;this.zlk=V;this.od=Ea;this.Wsa=
Za;this.La=ia;this.fak=Va;this.Cpd=Ab;this.Ee=gc;this.GJb=Hc;this.bFn=fd;this.Jgm=!1;this.od.YSb(Object(da.a)(this,this.gom,"onVisibleThumbnailRangeChanged"));this.od.Vxf(Object(da.a)(this,this.Lhb,"onThumbnailRefresh"));this.od.CQl(Object(da.a)(this,this.lnm,"onShapePresenceStateChanged"));this.od.LQl(Object(da.a)(this,this.Nnm,"onThumbnailPresenceStateChanged"));this.od.jQl(Object(da.a)(this,this.jUn,"onShapeViewElementShowRevisionTrackingHint"));this.od.gQl(Object(da.a)(this,this.dUn,"onShapeViewElementHideRevisionTrackingHint"));
this.Wsa.zTe(Object(da.a)(this,this.bAb,"onSlideUnreadStateChanged"));this.Wsa.NVm(Object(da.a)(this,this.rnm,"onShapeUnreadStateChanged"));this.Wsa.PVm(Object(da.a)(this,this.tnm,"onShowHideStateChanged"))}dispose(){this.od.zYh(Object(da.a)(this,this.gom,"onVisibleThumbnailRangeChanged"));this.od.G4e(Object(da.a)(this,this.Lhb,"onThumbnailRefresh"));this.od.Ium(Object(da.a)(this,this.lnm,"onShapePresenceStateChanged"));this.od.Oum(Object(da.a)(this,this.Nnm,"onThumbnailPresenceStateChanged"));this.Wsa.yYh(Object(da.a)(this,
this.bAb,"onSlideUnreadStateChanged"));this.Wsa.O6n(Object(da.a)(this,this.rnm,"onShapeUnreadStateChanged"));this.Wsa.P6n(Object(da.a)(this,this.tnm,"onShowHideStateChanged"))}gom(){const ja=this.ya.presentation;if(!ja)throw Error.argumentNull("Presentation is null");zc.b(ja.slides||[],null,qb=>{(qb=this.Xb.pl(qb.fc))&&qb.isUnread&&this.rkl(qb)})}Lhb(ja,qb){ja=this.Xb.pl(qb.hsl);ja.isUnread&&this.rkl(ja)}bAb(ja,qb){ja=qb.slide;ja.isUnread?this.rkl(ja):this.g6n(ja)}rnm(ja,qb){ja=qb.shape;qb=qb.slide;
ja&&(ja.isUnread?qb===this.ya.Ia&&this.jkl(ja):this.eYk(ja))}lnm(ja,qb){ja=qb.shape;ja.EG?this.eYk(ja):ja.isUnread&&this.jkl(ja,!0)}Nnm(ja,qb){ja=qb.slide;ja.EG&&!this.rzm?this.j6n(ja):ja.isUnread&&this.lfo(ja)}tnm(ja,qb){ja=qb.shape;qb.Vkc&&ja.isUnread?this.jkl(ja):this.eYk(ja)}get rzm(){return this.bFn}rkl(ja){ja&&ja.isConnected&&this.k2h(ja,()=>{})}g6n(ja){ja&&ja.isConnected&&this.k2h(ja,()=>{})}lfo(ja){ja.EG&&!this.rzm||this.k2h(ja,Object(da.a)(this,this.oUm,"addRevisionTrackingPawnForThumbnail"))}j6n(ja){this.k2h(ja,
()=>{})}szm(){const ja=this.Xb.In;return!this.GJb||this.GJb&&ja.Vkc}jkl(ja,qb=!1){this.szm()&&!ja.EG&&ja.Va(Rf.a.toc)&&(Object(Rb.a)(112,ja.yc(this.Ee))?(this.zlk.fca(ja).display(()=>this.La.Nld(ja)),this.yko(),Pc.a.$(507843140,804,50,"ShowShapeRevisionTrackingView(), IsTriggeredByPresenceUpdate={0}",qb)):Pc.a.$(507843139,804,50,"ShowShapeRevisionTrackingView() failed, no shape view element created"))}eYk(ja){const qb=this.zlk.J7(ja);qb?qb.dismiss():this.szm()&&ja.isUnread&&Pc.a.$(507843138,804,50,
"RemoveShapeRevisionTrackingView() failed, a revision tracking view is expected but not found")}k2h(ja,qb){ja&&((ja=Object(Rb.a)(653,ja.Vg(this.Cpd)))?qb(ja):Pc.a.$(507843137,804,50,"UpdateThumbnailRevisionTrackingView() failed, no thumbnail view element found"))}oUm(){}jUn(ja,qb){this.FEm(qb.pJ.shapeNode,!0)}dUn(ja,qb){this.FEm(qb.pJ.shapeNode,!1)}FEm(ja,qb){(ja=this.zlk.J7(ja))&&(qb?ja.wJe():ja.d0b())}yko(){this.Jgm||(this.Jgm=!0,Eb.c(Xa.a.NTl))}}Object(m.a)(dj,"RevisionTrackingPresenter",null,
[]);class Bi{KWl(){const ja=new jf.a;ja.zh(10,10);ja.CZa("0 0 10 10");ja.va.setAttribute("class","ModernRevisionTrackingIconSVG");const qb=new Yf.a;qb.$na("M1,5 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0");qb.va.setAttribute("class","ModernRevisionTrackingIconPath");ja.appendChild(qb);return ja.va}}Object(m.a)(Bi,"RevisionTrackingSVGProvider",null,[551]);class sj{constructor(){this.fTh=this.RTh=this.QTh=this.Whk=0}LCn(){this.RTh+=1}pCn(ja,qb){switch(ja){case 2:qb&&(this.QTh+=1);break;case 0:qb?(this.fTh+=1,Pc.a.$(39068549,
804,50,"HandleShowHideChanges: User enables detailed highlight via Ribbon button")):Pc.a.$(39068551,804,50,"HandleShowHideChanges: User disables detailed highlight via Ribbon button");break;case 1:qb&&(this.Whk+=1)}}log(){Pc.a.$(39068553,804,15,"WYWA Notification Clicks:{0}; Thumbnail Revision Tracking Pawn Clicks: {1}; Thumbnail Revision Tracking Pawn Hovers: {2}; Show Hide Changes Ribbon Clicks:{3};",this.Whk,this.QTh,this.RTh,this.fTh);0<this.QTh+this.RTh+this.fTh&&Eb.c(Xa.a.tHh)}}Object(m.a)(sj,
"RevisionTrackingTelemetry",null,[]);var tl=a(1643),El=a(1830),ej=a(109),Fl=a(798);class fj{constructor(ja,qb,V,Ea,Za){this.gee=null;this.ipd=ja;this.H0e=qb;this.Ec=Za;this.jc=V;this.sa=Ea;this.ipd.jXa(Object(da.a)(this,this.ola,"onInteractivityChanged"))}dispose(){this.ipd&&this.ipd.dispose();this.gee=this.ipd=null}display(ja,qb){this.gee||(this.gee=new Fl.a);this.gee.color=ja;this.gee.userName=qb;this.ipd.z2(this.gee)}dismiss(){this.ipd.rua(this.gee.clientId)}wJe(){this.ipd.Soc()}d0b(){this.ipd.ALb()}ola(ja,
qb){ja={InvokeSource:2,ShowRevisionTrackingStatus:null};1===qb.type?(this.jc.Ia!==this.Ec?(this.Ec&&(this.jc.Ia=this.Ec,this.sa.Rx()),ja.ShowRevisionTrackingStatus=3):ja.ShowRevisionTrackingStatus=1,n.AFrameworkApplication.ub.Ra(Yc.a.zLb,2,ja)):2===qb.type?this.Ec&&this.jc.Ia===this.Ec&&(ja.ShowRevisionTrackingStatus=2,n.AFrameworkApplication.ub.Ra(Yc.a.zLb,2,ja),this.H0e.LCn()):3===qb.type&&this.Ec&&this.jc.Ia===this.Ec&&(ja.ShowRevisionTrackingStatus=0,n.AFrameworkApplication.ub.Ra(Yc.a.zLb,2,ja))}}
Object(m.a)(fj,"ThumbnailRevisionTrackingPawn",null,[612,40]);a(396);class Th{constructor(ja,qb,V,Ea,Za,ia){this.kj=ja;ja=ej.e("pegal","UnreadNotification_16x16x32");qb=qb.Eq("pegal.png");V=V.KWl();this.h6m(n.AFrameworkApplication.isRtl,ja,qb,V);this.H0e=Ea;this.jc=Za;this.sa=ia}Zc(ja){return this.kj.Zc(ja)}h6m(ja,qb,V,Ea){const Za=new tl.a;Za.add(1,qb);Za.add(4,V);Za.add(6,16);Za.add(8,ja);Za.add(12,2);Za.add(11,!1);Za.add(14,Ea);new El.a(Za)}}Object(m.a)(Th,"RevisionTrackingThumbnailGadgetsFactory",
null,[550]);class Ih{constructor(ja,qb,V){this.tU=this.LI=!0;this.Iq=ja;this.ysa=qb;this.na=V}get Dbe(){return this.LI}getSlideLastViewedVersionInfo(ja){if(this.tU){Pc.a.$(507843075,824,50,"GetSlideLastViewedVersionInfo(), Start sending read request to FE at [{0}]",JSON.stringify(new Date));var qb=this.na.w0+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPPTSlideLastViewedMetadata",n.AFrameworkApplication.Fh),V={};V["X-StatelessPopsAffinityRoutingEnabled"]=this.na.aea.toString();this.Iq.ik(qb,
1,null,V,!1,2,Object(da.a)(this,this.cSn,"onGetVersionInfoSucceeded"),Object(da.a)(this,this.bSn,"onGetVersionInfoFailed"),ja,void 0,void 0,void 0,void 0,Og.a("12"));this.tU=!1}else Pc.a.$(507843076,824,50,"Response of previous get roaming request is not back yet.")}putSlideLastViewedVersionInfo(ja){if(this.LI){Pc.a.$(507843073,824,50,"PutSlideLastViewedVersionInfo(), Start sending write request to FE");var qb=ec.c(ja),V=this.na.v3e;if(qb.length>V)Pc.a.$(507843072,824,50,"Roaming data size is bigger than the limitation, won't write to roaming service, slideNum={0}, dataSize={1}, sizeLimitation={2}",
ja.lv.length,qb.length,V);else{V=this.na.w0+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePPTSlideLastViewedMetadata",n.AFrameworkApplication.Fh);if(n.AFrameworkApplication.ha.getBooleanAppSetting("SendBeaconOnRoamingRequestsIsEnabled"))this.Iq.rea(V,qb);else{const Ea={};Ea["X-StatelessPopsAffinityRoutingEnabled"]=this.na.aea.toString();this.Iq.ik(V,2,qb,Ea,!1,2,Object(da.a)(this,this.sTn,"onPutVersionInfoSucceeded"),Object(da.a)(this,this.rTn,"onPutVersionInfoFailed"),ja.lv.length,
void 0,void 0,void 0,void 0,Og.a("13"))}this.LI=!1}}else Pc.a.$(507843074,824,50,"Response of previous write roaming request is not back yet.")}dispose(){}cSn(ja){this.tU=!0;let qb=0;try{let V=null;ja.data.responseData&&0<ja.data.responseData.trim().length&&(qb=ja.data.responseData.length,V=JSON.parse(ja.data.responseData,Object(da.a)(this,this.Kzn,"jsonDateReviver")));const Ea=ja.data.state;Ea(V)}catch(V){Pc.a.$(507843043,824,10,"OnGetVersionInfoSucceeded catched exception: {0}",V.toString())}ja=
String.format("OnGetVersionInfoSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",qb,JSON.stringify(ja.data.Wy),JSON.stringify(ja.data.Oo),JSON.stringify(ja.data.Gp));Pc.a.$(507843042,824,50,ja)}bSn(ja){this.tU=!0;ja=this.ysa.WX(ja);Pc.a.$(507843041,824,50,"OnGetVersionInfoFailed: Web service failed with {0}",ja)}sTn(ja){this.LI=!0;Pc.a.$(507843040,824,50,"OnPutVersionInfoSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+ja.data.Gp-+ja.data.Wy,+ja.data.Oo-+ja.data.Wy)}rTn(ja){this.LI=
!0;const qb=this.ysa.WX(ja);Pc.a.$(507843039,824,50,"OnPutVersionInfoFailed: Web service failed with {0}, NumSlides={1}",qb,ja.data.state)}Kzn(ja,qb){return"dt"===ja||"defLv"===ja?new Date(qb):qb}}Object(m.a)(Ih,"RoamingCacheProxy",null,[549,40]);var Uh=a(1415);class si{constructor(ja,qb,V){this.Np=ja;this.eTh=Object(Rb.a)(Uh.a,this.Np.hzm);this.fak=qb;this.bHn=V;this.Np.c$l=!0}display(ja){let qb;qb=this.bHn.KWl();this.eTh.qPl(this.fak.backgroundColor,ja,qb);this.Np.M7e(this.fak.foregroundColor);
this.Np.setVisibility()}dismiss(){this.eTh.clear();this.Np.M7e(ki.a.none);this.Np.setVisibility()}Yq(ja){this.Np.Yq(ja)}NT(ja){this.Np.NT(ja)}zu(){return this.Np.zu()}k1(ja){return this.Np.d1b(ja)}vE(ja){this.Np.vE(ja)}dispose(){this.Np.dispose()}tH(){this.Np.tH()}pR(ja){return this.Np.pR(ja)}DM(ja){return this.Np.DM(ja)}draw(ja,qb){this.Np.draw(ja,qb)}get visible(){return this.Np.visible}set visible(ja){this.Np.visible=ja}setPosition(ja,qb){this.Np.setPosition(ja,qb)}qj(ja){this.Np.qj(ja)}Ov(ja){this.Np.Ov(ja)}SA(ja){this.Np.SA(ja)}setZIndex(ja){this.Np.setZIndex(ja)}ER(ja,
qb){this.Np.ER(ja,qb)}wJe(){this.eTh.wJe()}d0b(){this.eTh.d0b()}setSelection(){}}Object(m.a)(si,"ShapeRevisionTrackingView",null,[596,558,267,40]);class bj{constructor(){this.ga=null;this.GJb=this.fVc=this.Tfa=this.dhb=!1}get name(){return"PowerPointWebEditor.RevisionTracking"}init(){}oc(ja){this.ga=ja;ja.resolve("Common.IAppSettingsManager").Wf(()=>{this.Tfa=ja.resolve("PowerPointWebEditor.IApplicationContext").Pd.li;this.fVc=ja.resolve("PowerPointWebEditor.IApplicationContext").Pd.q$l;this.dhb=
ja.resolve("PowerPointWebEditor.IApplicationContext").Pd.cPh;this.GJb=ja.resolve("PowerPointWebEditor.IApplicationContext").Pd.pig;this.register();this.resolve()})}dispose(){this.dhb&&(this.ga.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").dispose(),this.ga.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").dispose(),this.ga.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").dispose())}register(){const ja=this.ga;this.Tfa&&this.fVc&&
ja.register(ch.a,"PowerPointWebEditor.PodsInfoSender").oa().pa(()=>new ch.a(n.AFrameworkApplication.$d,ja.resolve("PowerPointWebEditor.ISessionInfoOwner"),ja.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),ja.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),ja.resolve("PowerPointWebEditor.IErrorHandler"),ja.resolve("Common.ITaskManager"),ja.resolve("Common.IAppSettingsManager")));this.dhb&&(ja.register(sj,"RevisionTrackingTelemetry").oa().pa(()=>new sj),ja.register(Rk,"PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").oa().pa(()=>
new Rk(ja.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy"),ja.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ja.resolve("Common.ITaskManager"),ja.resolve("PowerPointWebEditor.ISlideReader"),ja.resolve("PowerPointWebEditor.IPresentationReader"),ja.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),ja.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),ja.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),ja.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
ja.resolve("Box4.Graph.IGraphInstance").Xd(10),ja.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource"),ja.resolve("PowerPointWebEditor.IApplicationSettings"),ja.resolve("Common.IAppSettingsManager"),ja.resolve("RevisionTrackingTelemetry"),ja.resolve("PowerPointWebEditor.View.IPPTPageView"),ja.resolve("PowerPointWebEditor.Graph.SlideNodeHelper"))),ja.register(dj,"PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").oa().pa(()=>new dj(ja.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
ja.resolve("PowerPointWebEditor.IPresentationReader"),ja.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>"),ja.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),ja.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),ja.resolve("PowerPointWebEditor.IShapeReader"),ja.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),ja.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ua,
ja.resolve("Box4.IPageView").Ua,ja.resolve("PowerPointWebEditor.IApplicationSettings").pig,ja.resolve("Common.IAppSettingsManager").getBooleanAppSetting(Rh.a.mBb))),ja.register(549,"PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").oa().pa(()=>new Ih(n.AFrameworkApplication.$d,ja.resolve("PowerPointWebEditor.IJsonpHelperManager"),ja.resolve("PowerPointWebEditor.IApplicationSettings"))),ja.register(550,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory").oa().pa(()=>
new Th(ja.resolve("PowerPoint.IBrowserHelperManager"),ja.resolve("PowerPoint.IPathManager"),ja.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider"),ja.resolve("RevisionTrackingTelemetry"),ja.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),ja.resolve("PowerPointWebEditor.IPptSelectionManager"))),ja.register(gh,"PowerPointWebEditor.RevisionTracking.RevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers").oa().pa(()=>
new gh),ja.register(525,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>").oa().pa(()=>new Oh.a((qb,V)=>{let Ea=null;const Za=Object(Rb.a)(112,qb.yc(ja.resolve("Box4.IPageView").Ua));Za&&!Za.isDisposed&&(qb=ja.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").DUi(ja.resolve("PowerPointWebEditor.IPptSelectionManager"),(ia,Va,Ab)=>ja.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").x5m(ia,Va,Ab,ja.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),
qb,V,Za.Cua,ja.resolve("PowerPointWebEditor.IZoomContext"),ja.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),ja.resolve("PowerPointWebEditor.IApplicationSettings")),Ea=new si(qb,ja.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),ja.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider")),Ea.Yq(Za.Cua),Za.uHb(Ea,1),Ea.visible=Za.oM||Za.vp);return Ea})),ja.register($g,"PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider").oa().pa(()=>
new $g(ja.resolve("Common.Utils.IHighContrastDetector"))),ja.register(551,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider").oa().pa(()=>new Bi),this.Tfa&&this.GJb&&ja.register(Gi,"PowerPointWebEditor.RevisionTracking.RevisionTrackingActor").oa().pa(()=>new Gi(ja.resolve("Common.IActionManagerExtended"),ja.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),ja.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),ja.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier"),
ja.resolve("PowerPointWebEditor.IPresentationReader"),ja.resolve("PowerPointWebEditor.View.IViewEventSource"),ja.resolve("RevisionTrackingTelemetry"))))}resolve(){this.Tfa&&this.fVc&&this.ga.resolve("PowerPointWebEditor.PodsInfoSender");if(this.dhb&&(this.ga.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter"),this.ga.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.ga.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory"),
this.GJb)){const ja=this.ga.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingActor");ja.Kb();ja.Ae()}}static main(){I.a.instance.Jc(Xc.a(new bj,0))}}Object(m.a)(bj,"PPTWebEditorRevisionTrackingPackage",null,[4,5]);var Dh=a(411),lk=a(240),vk=a(156);class Xi{constructor(ja){this.smb=[zb.a.Z6e,zb.a.$6e,zb.a.a7e,zb.a.b7e,zb.a.c7e];this.GJl=ja}qLh(ja){return this.GJl?this.GJl.pLh(ja.Ya):null}create(ja){return ja?(ja=this.hDc(ja))?vk.m(ja):"":""}d4m(ja){ja=ja.suggestions;if(!ja||!ja.count)return null;
ja=({EXl:qb}=this.d6m(ja)).returnValue;var qb=Xi.E4m(qb);const V=Object.assign(new Dh.a,{ExternalId:"DictationCorrectionMenu",Command:"798637440",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsFlyoutTitle,Image16by16Class:ej.e(n.AFrameworkApplication.IJ,Xi.c8m),Image16by16:n.AFrameworkApplication.Ln,Menu:Object.assign(new Dc.a,{ExternalId:"DictationCorrectionSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,MenuSectionList:[]})});ja&&Array.add(V.Menu.MenuSectionList,ja);Array.add(V.Menu.MenuSectionList,
qb);return V}d6m(ja){let qb;const V=Object.assign(new Ve.a,{Id:"DictationCorrectionSuggestions",ControlList:[],ControlsId:"DictationCorrectionSuggestionsControls",Title:Box4Intl.Box4Strings.L_DictationCorrectionsGroupTitle});qb=null;for(let Ea=0,Za=Math.min(this.smb.length,ja.count);Ea<Za;++Ea){if(!qb&&""===ja.ka(Ea).suggestion){qb=this.smb[Ea].toString();continue}const ia=Object.assign(new lk.a,{ExternalId:"btnDictationCorrectionSuggestion"+Ea,Command:this.smb[Ea].toString(),LabelText:ja.ka(Ea).suggestion});
Array.add(V.ControlList,ia)}return V.ControlList.length?{returnValue:V,EXl:qb}:{returnValue:null,EXl:qb}}hDc(ja){if(ja=this.d4m(ja)){const qb=Object.assign(new Ve.a,{Id:"DictationCorrectionSection",ControlList:[],ControlsId:"DictationCorrectionSection"});Array.add(qb.ControlList,ja);return qb}return null}static E4m(ja){const qb=Object.assign(new Ve.a,{Id:"DictationCorrectionIgnoreSuggestionSection",ControlList:[],ControlsId:"DictationCorrectionIgnoreSuggestionSectionControls"}),V=Object.assign(new lk.a,
{ExternalId:"btnIgnoreDictationCorrectionSuggestion",Command:"421768503",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsIgnoreSuggetion});Array.add(qb.ControlList,V);ja&&(ja=Object.assign(new lk.a,{ExternalId:"btnDeleteDictationCorrectionSuggestion",Command:ja,LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsDeleteSuggetion}),Array.add(qb.ControlList,ja));return qb}}Xi.c8m="Insertaudio_16x16x32";Object(m.a)(Xi,"DictationCorrectionContextMenuManager",null,[595]);var wk=a(493);class Fk{constructor(ja,
qb){this.UCh=null;this.Ls=ja;this.Doa=qb}get key(){return"DICTATIONCORRECTION"}get Uma(){return Box4Intl.Box4Strings.l_DictationCorrectionContentTitle}reset(ja){this.Ls.ue(ja.node)?this.UCh=ja.node:this.UCh=null}Hdd(ja){let qb;qb=null;if(!this.UCh)return{returnValue:!1,c2a:qb};ja=this.Doa.rgn(this.UCh,ja);if(!ja)return{returnValue:!1,c2a:qb};qb=Object.assign(new wk.a,{ega:this.key,gU:ja,description:this.O_f()});return{returnValue:!0,c2a:qb}}O_f(){return n.AFrameworkApplication.ha&&n.AFrameworkApplication.ha.getBooleanAppSetting("WordEditorIdeasCardsIsEnabled")?
Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}}Object(m.a)(Fk,"DictationCorrectionDetailsProvider",null,[617,618]);var Kk=a(808),rk=a(143);class fi{constructor(ja,qb,V=-1){this.TriggerType="click";this.TreatedInUX="true";this.PhraseId=ja.TWn;this.CorrectionId=ja.id;switch(qb){case 0:this.EditType="alternate";this.AlternateId=V;break;case 1:this.EditType="ignore";break;case 2:this.EditType="dismissed";break;default:r.ULS.sendTraceTag(51246608,394,10,"Invalid CorrectionEditType value")}}}
Object(m.a)(fi,"CorrectionEvent",null,[]);class Af{constructor(){this.Id="Corrections";this.Name="Telemetry";this.ClientSessionId="";this.CorrectionEvents=null}}Object(m.a)(Af,"CorrectionTelemetry",null,[]);class Gl{constructor(){this.Id="Corrections";this.Name="Session";this.ClientSessionId="";this.SessionInfo=null}}Object(m.a)(Gl,"CorrectionsSessionTelemetry",null,[]);class Ni{constructor(){this.j2=!1;this.G6h=this.wei=0}start(){this.j2||(this.j2=!0,this.wei=this.getTime())}stop(){this.j2&&(this.G6h+=
this.getTime()-this.wei,this.j2=!1)}get ew(){return this.G6h+(this.j2?this.getTime()-this.wei:0)}getTime(){return(new Date).getTime()}}Object(m.a)(Ni,"DictationCorrectionsSessionTimer",null,[]);class sk{constructor(){this.StartTime="";this.AlternateEditCount=this.ManualEditCount=this.Duration=0;this.TextInfo=null}}Object(m.a)(sk,"SessionInfo",null,[]);class Qj{constructor(){this.FinalText="";this.PhraseIds=null}}Object(m.a)(Qj,"TextInfo",null,[]);var Bf=a(231);class Ej{constructor(ja){this.uMl=this.ogi=
this.pgi=0;this.vLm="Office.Voice.Online.DictationCorrectionsSession";this.mGd=null;this.JSe=Object.assign(new sk,{TextInfo:[new Qj]});this.uKl=ja}startSession(){this.mGd||(this.JSe.StartTime=(new Date).toISOString(),this.mGd=new Ni);this.mGd.start()}pauseSession(){this.mGd.stop()}endSession(){this.mGd.stop();var ja=new Bf.a;ja.name=this.vLm;ja.samplingPolicy=2;ja.durationMs=this.mGd.ew;ja.dataFields=[];Array.add(ja.dataFields,Object.assign(new gf.a,{name:"CorrectionSessionId",string:this.Aoc}));
Array.add(ja.dataFields,Object.assign(new gf.a,{name:"StartTime",string:this.JSe.StartTime}));Array.add(ja.dataFields,Object.assign(new gf.a,{name:"NumberOfCorrectionsMarked",int64:this.pgi}));Array.add(ja.dataFields,Object.assign(new gf.a,{name:"NumberOfCorrectionsMade",int64:this.ogi}));Array.add(ja.dataFields,Object.assign(new gf.a,{name:"NumberOfCorrectionsDismissed",int64:this.uMl}));rk.a.sendActivityEvent(ja);if(ha.App.zNa&&0<ha.App.zNa.Dpm.length){this.JSe.AlternateEditCount=this.ogi;this.JSe.Duration=
Math.floor(this.mGd.ew/1E3);this.JSe.TextInfo[0].PhraseIds=ha.App.zNa.Dpm;var qb=new Gl;qb.ClientSessionId=this.Aoc;qb.SessionInfo=this.JSe;if(ja=this.uKl())qb=ec.c(qb),ja.ubm(qb)}}lRn(ja){this.pgi+=ja}ulm(ja,qb,V=-1){0===qb?this.ogi++:1===qb&&this.uMl++;var Ea=new Af;Ea.ClientSessionId=this.Aoc;Ea.CorrectionEvents=[new fi(ja,qb,V)];if(ja=this.uKl())Ea=ec.c(Ea),ja.ubm(Ea)}get Aoc(){return ha.App.zNa?ha.App.zNa.Aoc:""}}Object(m.a)(Ej,"DictationCorrectionsTelemetry",null,[]);var Rj=a(56),Zk=a(54);class na{constructor(ja,
qb,V){this.bwa=ja;this.Mb=qb;this.Wma=V}}Object(m.a)(na,"DictationCorrectionRange",null,[]);var Ya=a(441);class nc{constructor(ja,qb,V){this.MLa=this.xO=null;this.jRn=(Ea,Za)=>{this.QCh.O5n(Za.UVl)};this.iRn=(Ea,Za)=>{this.qEh.add(Za.TVn);this.xO&&this.xO.lRn(Za.eIn);this.QCh.nTm(Za.UVl)};this.LRe=ja;this.crc=qb;this.qEh=new Ya.a(new Kk.a);this.QCh=V;this.Xdc()}RNh(ja){this.crc.yEc&&Wf.ParagraphReader.ue(ja)&&this.qEh.contains(ja.id)&&this.LRe.RNh(ja)}Bgo(){this.crc.yEc=!0;this.xO=new Ej(()=>this.MLa);
this.xO.startSession()}Wgo(){this.crc.yEc=!1;var ja=ha.App.Zb.Sd.eo.ih;if(ja){ja=ja.Mh;for(const qb of this.qEh){const V=ja.ye(qb);V&&Wf.ParagraphReader.ue(V)&&this.LRe.Q0m(V)}}this.QCh.clear();this.qEh.clear();this.xO.endSession()}Gvm(ja){if(this.crc.yEc){var qb=ja.ra(Zk.a.bJh,null);if(!vc.a.wb(qb)){var V=new K.a,Ea=Math.min(qb.length,ja.$a.length);for(let Za=0;Za<Ea;Za++){const ia=this.QCh.Ffn(qb[Za]);if(ia){const Va=ja.$a.ka(Za).cp;V.add(new na(Va,Va+ia.source.length,ia))}}this.LRe.XHn(ja,V)}}}Q7e(ja,
qb){if(!qb)return!1;if(!this.crc.yEc||!ja)return qb.add(null),!1;qb.add(ja.BD?ja.BD.Wma.key:null);return!!ja.BD}Iwm(ja,qb){this.crc.yEc&&qb&&z.AT(qb,V=>!!V)?ja.pe(Zk.a.bJh,qb.toArray()):ja.removeProperty(Zk.a.bJh)}ntm(ja){this.MLa=ja}Xdc(){this.LRe.TUm(this.iRn);pb.a.addHandler(window.self,ab.a.blur,()=>{this.xO&&this.crc.yEc&&this.xO.pauseSession()});pb.a.addHandler(window.self,ab.a.focus,()=>{this.xO&&this.crc.yEc&&this.xO.startSession()});this.LRe.UUm(this.jRn)}hRn(ja,qb){this.xO&&this.xO.ulm(ja,
0,qb)}kRn(ja){this.xO&&this.xO.ulm(ja,1)}rgn(ja,qb){if(!this.crc.yEc)return null;ja=re.a.Oj(ja,qb);return this.LRe.pLh(ja)}}Object(m.a)(nc,"DictationCorrectionManager",null,[594]);var Qc=a(36);class pd extends Sys.EventArgs{constructor(ja,qb){super();this.TVn=ja;this.eIn=qb?qb.count:0;this.UVl=qb}}Object(m.a)(pd,"DictationCorrectionMarkerEventArgs",Sys.EventArgs,[]);class Xd{constructor(ja,qb,V,Ea,Za){this.hQm=ja;this._id=qb;this.OMm=Ea;this.Lwc=Za;this.HA=V;this.Aeb=String.format("{0}_{1}",ja,qb)}get TWn(){return this.hQm}get id(){return this._id}get source(){return this.HA}get confidence(){return this.OMm}get suggestions(){return this.Lwc}get key(){return this.Aeb}EIn(ja){this.suggestions.addRange(ja.suggestions)}}
Object(m.a)(Xd,"DictationCorrectionDetails",null,[]);class Fe{constructor(ja,qb,V){this.Wo=ja;this.$Mm=qb;this.PPm=V}get Wma(){return this.$Mm}get syk(){return this.PPm}get Xe(){return this.Wo}Qd(ja){return new Fe(ja||this.Xe,this.Wma,this.syk)}}Object(m.a)(Fe,"DictationCorrectionObject",null,[142]);class df{constructor(ja,qb){this.source=ja;this.suggestion=qb}}Object(m.a)(df,"DictationCorrectionSuggestion",null,[]);class xf{constructor(ja){this.Zon=(qb,V)=>{const Ea=V.Xe;for(var Za=qb.$a.EIb(Ea.cp)+
1;Za<qb.$a.length;Za++){const ia=qb.$a.ka(Za);if(ia.isDictationCorrectionEnd){let Va;this.rbh(qb,(Va=new K.a,Va.add(new na(Ea.cp,ia.cp,V.Wma)),Va));break}}};this.Vh=ja;this.nb=new Ah.a}TUm(ja){this.nb.addHandler("ADCM",ja)}UUm(ja){this.nb.addHandler("RDCM",ja)}XHn(ja,qb){this.$Hn(ja,qb)}$Hn(ja,qb){if(ja&&qb&&qb.count&&(qb=xf.aoo(ja,qb))&&qb.count){this.U0m(ja,qb);var V=new K.a;for(var Ea of qb)V.add(Ea.bwa),V.add(Ea.Mb);ja.YVe(V);for(const Za of qb)Ea=ja.$a.LZ(Za.bwa),Ea.BD=new Fe(Ea,Za.Wma,this.Zon),
Ea.isFromErrorRangeSplit=!0,Ea=ja.$a.LZ(Za.Mb),Ea.isDictationCorrectionEnd=!0,Ea.isFromErrorRangeSplit=!0;0<qb.count&&this.nb.raiseEvent("ADCM",new pd(ja.id,qb))}}B2l(ja){const qb=new K.a;if(ja){let V=null,Ea=-1;for(let Za=0;Za<ja.$a.length;Za++){const ia=ja.$a.ka(Za);ia.BD?(Ea=ia.cp,V=ia.BD.Wma):ia.isDictationCorrectionEnd&&(V?qb.add(new na(Ea,ia.cp,V)):r.ULS.sendTraceTag(593285261,394,10,"Correction range end with no start."),V=null)}}return qb}rbh(ja,qb){if(ja&&qb&&qb.count){for(const V of qb){let Ea=
ja.$a.LZ(V.bwa);Ea&&(Ea.BD=null);if(Ea=ja.$a.LZ(V.Mb))Ea.isDictationCorrectionEnd=!1}this.nb.raiseEvent("RDCM",new pd(ja.id,qb))}}Q0m(ja){if(ja)for(let qb=0;qb<ja.$a.length;qb++){const V=ja.$a.ka(qb);V.BD&&(V.BD=null);V.isDictationCorrectionEnd&&(V.isDictationCorrectionEnd=!1)}}pLh(ja){if(!ja||!Rj.SelectionEditor.pk(ja)&&!Rj.SelectionEditor.fh(ja))return null;const qb=ja.node,V=ja.Xa;ja=ja.Mb;let Ea=0,Za=null;for(let ia=0;ia<qb.$a.length;ia++){const Va=qb.$a.ka(ia);if(Va.BD&&V>=Va.cp)Za=Va.BD,Ea=
Va.cp;else if(Za&&Va.isDictationCorrectionEnd){if(ja<=Va.cp)return new na(Ea,Va.cp,Za.Wma);Za=null}}return null}boo(ja,qb,V){if(!ja)return!1;ja=Wf.ParagraphReader.text(ja);return xf.VEm(ja,qb.source,V)}RNh(ja){if(ja){var qb=this.B2l(ja);if(qb&&0<qb.count){const V=new K.a,Ea=Wf.ParagraphReader.text(ja);for(const Za of qb)xf.UEm(Ea,Za)||V.add(Za);this.rbh(ja,V)}}}U0m(ja,qb){qb.ka(0);qb.ka(qb.count-1);const V=this.B2l(ja);let Ea=0,Za=0;const ia=new K.a;for(;Za<qb.count&&Ea<V.count;){const Va=qb.ka(Za),
Ab=V.ka(Ea);Va.Mb<Ab.bwa?Za++:(Ab.Mb>Va.bwa&&ia.add(Ab),Ea++)}this.rbh(ja,ia)}yUn(ja,qb){(ja=ha.App.Zb.Sd.eo.ih)&&(qb=ja.Mh.ye(Of.a.Vf(qb.nodeId)))&&Wf.ParagraphReader.ue(qb)&&this.P5n(qb)}P5n(ja){if(ja){var qb=0,V=!1,Ea=!1,Za=new K.a;for(let ia=0;ia<ja.$a.length;ia++){const Va=ja.$a.ka(ia);Va.BD&&(qb=ia,V=!0);V&&(Va.Vp||Va.vM)&&(Ea=!0);Va.isDictationCorrectionEnd&&V&&(V=!1,Ea&&(Ea=ja.$a.ka(qb),Ea.BD&&Ea.BD.Wma&&Za.add(new na(Ea.cp,Va.cp,Ea.BD.Wma)),Ea.BD=null,Ea=Va.isDictationCorrectionEnd=!1))}this.nb.raiseEvent("RDCM",
new pd(ja.id,Za))}}static aoo(ja,qb){if(!qb.count)return qb;qb.Sc((Ea,Za)=>Ea.bwa!==Za.bwa?Ea.bwa-Za.bwa:Ea.Mb-Za.Mb);ja=Wf.ParagraphReader.text(ja);const V=new K.a;for(let Ea=0;Ea<qb.count;Ea++){const Za=qb.ka(Ea);if(Za.bwa>ja.length||Za.Mb>ja.length)break;if(!xf.UEm(ja,Za))continue;if(!V.count){V.add(Za);continue}const ia=V.ka(V.count-1);Za.bwa>ia.Mb?V.add(Za):ia.bwa===Za.bwa&&ia.Mb===Za.Mb&&ia.Wma.EIn(Za.Wma)}return V}static VEm(ja,qb,V){if(V+qb.length<=ja.length){for(let Ea=0;Ea<qb.length;Ea++)if(qb.charAt(Ea)!==
ja.charAt(Ea+V))return!1;return!0}return!1}static UEm(ja,qb){return!ja||qb.bwa>ja.length||qb.Mb>ja.length||!qb.Wma||!qb.Wma.source?!1:xf.VEm(ja,qb.Wma.source,qb.bwa)}}Object(m.a)(xf,"DictationCorrectionRangeEditor",null,[593]);class Nf{constructor(){this.yEc=!1}}Object(m.a)(Nf,"DictationCorrectionSettings",null,[]);var nf=a(13);class Ig{constructor(){this.Osf=new nf.ScriptSharpLegacyMap}nTm(ja){if(ja&&ja.count)for(const qb of ja)qb.Wma?(ja=qb.Wma.key,this.Osf.Sb(ja)||this.Osf.add(ja,qb.Wma)):r.ULS.sendTraceTag(593285260,
394,10,"Correction details is null.")}O5n(ja){if(ja&&ja.count)for(const qb of ja)qb.Wma?this.Osf.remove(qb.Wma.key):r.ULS.sendTraceTag(593285259,394,10,"Correction details is null.")}Ffn(ja){if(!ja)return null;let qb;return({value:qb}=this.Osf.Ph(ja)).returnValue?qb:null}clear(){this.Osf=new nf.ScriptSharpLegacyMap}}Object(m.a)(Ig,"DictationCorrectionStorage",null,[611]);class bg{constructor(ja,qb,V,Ea,Za,ia,Va){this.NUe=(Ab,gc,Hc,fd,hd)=>{if(2===Hc){gc=this.Qc.Wa.qb;if(!gc)return 2;gc=this.nf.zm(gc,
!0,!1);return this.Aa.hi(gc.Ya,Ab,Hc,!1,fd,hd)}return 32};this.Vh=ja;this.Def=qb;this.Doa=V;this.Aa=Ea;this.Qc=Za;this.nf=ia;this.Zl=Va}Kb(){this.Aa.Ba(zb.a.Z6e,ad.a.sg,Object(da.a)(this,this.Wrh,"takeSuggestedDictationCorrectionAction"));this.Aa.Ba(zb.a.$6e,ad.a.sg,Object(da.a)(this,this.Wrh,"takeSuggestedDictationCorrectionAction"));this.Aa.Ba(zb.a.a7e,ad.a.sg,Object(da.a)(this,this.Wrh,"takeSuggestedDictationCorrectionAction"));this.Aa.Ba(zb.a.b7e,ad.a.sg,Object(da.a)(this,this.Wrh,"takeSuggestedDictationCorrectionAction"));
this.Aa.Ba(zb.a.c7e,ad.a.sg,Object(da.a)(this,this.Wrh,"takeSuggestedDictationCorrectionAction"));this.Aa.Ba(zb.a.Y6e,ad.a.sg,Object(da.a)(this,this.Y6e,"takeIgnoreSuggestedDictationCorrection"));this.Aa.Ba(zb.a.Z6e,ad.a.view,this.NUe);this.Aa.Ba(zb.a.$6e,ad.a.view,this.NUe);this.Aa.Ba(zb.a.a7e,ad.a.view,this.NUe);this.Aa.Ba(zb.a.b7e,ad.a.view,this.NUe);this.Aa.Ba(zb.a.c7e,ad.a.view,this.NUe);this.Aa.Ba(zb.a.Y6e,ad.a.view,this.NUe);this.Aa.we(zb.a.Z6e,96);this.Aa.we(zb.a.$6e,96);this.Aa.we(zb.a.a7e,
96);this.Aa.we(zb.a.b7e,96);this.Aa.we(zb.a.c7e,96);this.Aa.we(zb.a.Y6e,96)}fXm(ja,qb,V){const Ea=this.Zl.xe(15);try{Ea.ld(ja);let Za;this.Def.rbh(ja,(Za=new K.a,Za.add(qb),Za));const ia=qb.Wma.suggestions.ka(V);if(this.Def.boo(ja,ia,qb.bwa)){const Va=re.a.createTextRange(ja,qb.bwa,qb.bwa+ia.source.length);this.Vh.replaceTextRange(Va,ia.suggestion);this.Doa.hRn(qb.Wma,V)}else r.ULS.sendTraceTag(50946527,394,100,"Failed to apply Suggestion")}finally{Ea&&Ea.dispose()}}Wrh(ja,qb,V){2===V&&qb.Al&&(V=
this.Def.pLh(qb))&&this.fXm(qb.node,V,this.Gfn(ja));return 32}Y6e(ja,qb,V){if(2===V&&qb.Al&&(ja=this.Def.pLh(qb))){let Ea;this.Def.rbh(qb.node,(Ea=new K.a,Ea.add(ja),Ea));this.Doa.kRn(ja.Wma)}return 32}Gfn(ja){switch(ja){case zb.a.Z6e:return 0;case zb.a.$6e:return 1;case zb.a.a7e:return 2;case zb.a.b7e:return 3;case zb.a.c7e:return 4;default:return-1}}}Object(m.a)(bg,"DictationCorrectionsActor",null,[610]);var oh=a(328),rh=a(78);class Mh{constructor(){this.HJl=this.Oa=null}get name(){return"Box4.DictationCorrections"}oc(ja){this.Oa=
ja;this.Oa.register(593,"Box4.DictationCorrections.IDictationCorrectionRangeEditor").oa().pa(()=>new xf(this.Oa.resolve("Box4.ICharacterPropertiesEditor")));this.Oa.register(594,"Box4.DictationCorrections.IDictationCorrectionManager").oa().pa(()=>new nc(this.Oa.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),new Nf,new Ig));this.Oa.register(595,"Box4.DictationCorrections.IDictationCorrectionContextMenuManager").oa().pa(()=>new Xi(this.Oa.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor")))}init(){this.Oa.resolve("Box4.DictationCorrections.IDictationCorrectionManager");
this.HJl=new bg(this.Oa.resolve("Box4.ICharacterPropertiesEditor"),this.Oa.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),this.Oa.resolve("Box4.DictationCorrections.IDictationCorrectionManager"),n.AFrameworkApplication.ub,rh.a.instance,oh.a.instance,this.Oa.resolve("Box4.Graph.IGraphTransactionFactory"));this.HJl.Kb();this.N4n(this.Oa.eb("Box4.Accessibility.IAccessibilityContextManager"),this.Oa.resolve("Box4.IParagraphReader"),this.Oa.resolve("Box4.DictationCorrections.IDictationCorrectionManager"));
const ja=this.Oa.Db("Box4.Proofing.IErrorRangeEditor"),qb=this.Oa.Db("Box4.DictationCorrections.IDictationCorrectionRangeEditor");n.AFrameworkApplication.ha.getBooleanAppSetting("WacBox4DictationFloatieIsEnabled")&&ja&&qb&&ja.OPl(Object(da.a)(qb,qb.yUn,"onSpellingErrorRangesChangedEventHandler"));ha.App.Zb.fg()}dispose(){}N4n(ja,qb,V){ja&&ja.execute(Ea=>{Ea.wbb(new Fk(qb,V))})}}Object(m.a)(Mh,"DictationCorrectionsPackageManager",null,[4,5]);a(1713);a(854);var gi=a(805);class Si{constructor(ja,qb,
V,Ea=null,Za=null){this.Wo=ja;this.xK=qb;this.UOm=V;this._id=Ea;this.vci=Za}get Xe(){return this.Wo}get type(){return this.xK}get Tk(){return this.UOm}get id(){return this._id}get intent(){return this.vci}Qd(ja){return new Si(ja,this.type,this.Tk,this.id,this.intent)}toString(){return String.format("Type = {0}, IsStart = {1}, Id = {2}",this.type,this.Tk,this.id?this.id.toString():"<null>")}}Object(m.a)(Si,"IntentObject",null,[142]);a(806);class Sj{constructor(ja,qb,V,Ea=null,Za=null){gi.a(ja);this.xK=
ja;this.bcf=qb;this.yff=V;this._id=Ea;this.vci=Za}get type(){return this.xK}get begin(){return this.bcf}get end(){return this.yff}get id(){return this._id}get intent(){return this.vci}toString(){return String.format("Type = {0}, Begin = {1}, End = {2}, Id = {3}",this.type,this.begin,this.end,this.id?this.id.toString():"<null>")}}Object(m.a)(Sj,"IntentRange",null,[176]);a(412);a(184);a(223);class mk{constructor(ja){this.Vh=ja}}Object(m.a)(mk,"IntentRangeEditor",null,[592]);class Fj{constructor(){this.Oa=
null}get name(){return"Box4.Intent"}oc(ja){this.Oa=ja;this.Oa.register(mk,"Box4.Intent.IntentRangeEditor").as("Box4.Intent.IIntentRangeEditor").oa().pa(()=>new mk(this.Oa.resolve("Box4.ICharacterPropertiesEditor")))}init(){this.Oa.resolve("Box4.IProofingManager")}dispose(){}static main(){I.a.instance.Jc(new Fj)}}Object(m.a)(Fj,"PackageManager",null,[4,5]);var Oi=a(1835),ti=a(1064),Dj=a(295),$h=a(1226),$k=a(833),xk=a(931);class ui{}ui.productionLanguages="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT hi-IN pt-BR fr-CA ja-JP en-IN en-AU".split(" ");
ui.previewLanguages="nb-NO da-DK sv-SE fi-FI nl-NL ko-KR pl-PL pt-PT ru-RU th-TH zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");ui.Loo="en-US en-CA en-GB en-AU en-IN en-NZ".split(" ");ui.VXm=["en-US","en-CA","en-GB","en-AU","en-IN"];ui.WXm="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT en-AU en-IN fr-CA pt-BR ja-JP ko-KR hi-IN pl-PL pt-PT ru-RU zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");
ui.X6m="en-US";ui.T7m="btnStartDictation";ui.d8m="btnDictationFloatieToggle";ui.a8m="Dictation";ui.e8m="DictationFloatieToggle";ui.dYl="Insertaudio_32x32x32";ui.cYl="Insertaudio_16x16x32";ui.$7m="JotInsertAudioRecordingShort_32x32x32";ui.Z7m="JotInsertAudioRecordingShort_16x16x32";ui.vgo="speechOn.wav";ui.ugo="speechOff.wav";Object(m.a)(ui,"DictationConstants",null,[]);class gj{constructor(ja){this.sLl=ja;this.L_a=(ja=Uc.a.Le(ja))?ja.displayName:this.sLl;this.nK=ja?ja.LCID:gj.FAn}get uPh(){return this.sLl}get displayName(){return this.L_a}get LCID(){return this.nK}}
gj.FAn=1033;Object(m.a)(gj,"DictationLanguage",null,[]);class Kj{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc){this.QDh=null;this.BKl=!1;this.TGb=null;this.ZSe=!1;this.R3e=(Hc,fd,hd,yd,Md)=>{if(1===hd)return 32;Md&&(Hc=!!n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.ex,this.TGb?Md[Hc?Ra.a.On:ti.a.On]=this.TGb.isVisible():(hd=this.teb.Sqa(),hd=(fd=2===hd)||1===hd,Hc?(Md[Ra.a.On]=hd,Md[Dj.a.IconSet]=fd?(new $h.a("JotInsertAudioRecordingShort_20")).iconSet:n.AFrameworkApplication.Ha.Ib.NGa?(new $h.a("InsertAudio_32")).iconSet:
(new $h.a("InsertAudio_20",null,null,"InsertAudio_32")).iconSet):(Md[ti.a.On]=hd,fd?(Md[ti.a.Image32by32Class]=ej.d(ui.$7m),Md[ti.a.Image16by16Class]=ej.d(ui.Z7m)):(Md[ti.a.Image32by32Class]=ej.d(ui.dYl),Md[ti.a.Image16by16Class]=ej.d(ui.cYl)))));return 32};this.kNe=(Hc,fd,hd,yd,Md)=>{if(2===hd){if(!this.TGb||(null===Md||void 0===Md?0:Md.bYl))return this.o5i(Md);this.FCm()}return 32};this.tth=(Hc,fd,hd)=>2!==hd?32:this.o5i(void 0);this.eye=(Hc,fd,hd,yd,Md)=>{if(1===hd)return 32;this.dYn(Md,Hc===zb.a.uGk);
return 32};this.vXh=(Hc,fd,hd,yd,Md)=>{if(1===hd)return 32;Md&&((Hc=Md.MenuItemId)&&Hc===this.lp.hNa?(Md[Ra.a.On]=!0,this.QDh=Md.SourceControlId):Md[Ra.a.On]=!1);return 32};this.lXh=(Hc,fd,hd,yd,Md)=>{if(1===hd)return 32;Md&&(Md[$k.a.Value]=(new gj(this.lp.hNa)).displayName);return 32};this.zZh=(Hc,fd,hd,yd,Md)=>{if(1===hd)return 32;Md&&(Hc=Md.SourceControlId,this.QDh!==Hc&&(this.lp.hNa=Md.MenuItemId,this.pEm(this.QDh),this.pEm(Hc),this.QDh=Hc,2===this.teb.Sqa()&&this.JVa()));return 32};this.AZh=
(Hc,fd,hd,yd,Md)=>{if(1===hd)return 32;if(Md){Hc=Md.MenuItemId;if(this.lp.hNa!==Hc){this.lp.hNa=Hc;if(this.TGb)this.TGb.onDictationLanguageChanged(Hc);2===this.teb.Sqa()&&this.JVa()}this.hzl()}return 32};this.showHelpPane=(Hc,fd,hd,yd,Md)=>{if(1===hd)return 32;Hc=this.aMm.value;if(!Hc)return 0;Md&&(Md={},Md.query="AssetID="+(this.lp.wno?Kj.lOm:Kj.Ibi),Md=Object.assign(new Oi.a,{nonPersistedSettings:Md}),Hc.kJa(Kj.Hbi,Md));return 32};this.bjo=(Hc,fd,hd,yd,Md)=>{if(1===hd)return this.lp.LNj?32:8;Md&&
this.lp&&(this.lp.useAutoPunctuation=Md[Ra.a.On]);2===this.teb.Sqa()&&this.JVa();this.hzl();return 32};this.ejo=(Hc,fd,hd,yd,Md)=>{if(1===hd)return this.lp.s_j?32:8;Md&&this.lp&&(this.lp.h8e=Md[Ra.a.On]);2===this.teb.Sqa()&&(this.teb.JVa(),this.R7e());this.gEm();return 32};this.C2n=(Hc,fd,hd,yd,Md)=>{if(1===hd)return 32;Md&&this.lp&&(Md[Ra.a.On]=this.lp.useAutoPunctuation);return 32};this.D2n=(Hc,fd,hd,yd,Md)=>{if(1===hd)return 32;Md&&this.lp&&(Md[Ra.a.On]=this.lp.h8e);return 32};this.mRn=(Hc,fd,
hd)=>{2===hd&&this.FJh();return 32};this.fTn=(Hc,fd,hd)=>{2===hd&&this.lp.Dwa&&2===this.teb.Sqa()&&this.JVa();return 32};this.ERn=(Hc,fd,hd)=>{2===hd&&this.lp.Dwa&&this.FJh();return 32};this.F1e=(Hc,fd,hd)=>{2===hd&&(this.lp.Dwa?this.FJh():this.JVa());return 32};this.FRn=(Hc,fd,hd)=>{2===hd&&this.JVa();return 32};this.pRn=(Hc,fd,hd)=>{2===hd&&this.R7e();return 32};this.qRn=(Hc,fd,hd)=>{2===hd&&(this.teb.JVa(),this.R7e());return 32};this.oRn=(Hc,fd,hd,yd,Md)=>{2===hd&&Md&&(Hc=Uc.a.Le(this.lp.hNa),
this.Ef.Foc(this.YR.rt(Md),Hc.LCID,Md.Mb));return 32};this.nRn=(Hc,fd,hd)=>{2===hd&&this.JVa();return 32};this.sRn=(Hc,fd,hd)=>{2===hd&&this.JVa();return 32};this.rRn=(Hc,fd,hd)=>2===hd&&this.lp&&this.lp.Uwn?this.lp.Dwa&&this.TGb&&!this.TGb.isVisible()?(this.FCm(),32):this.o5i(void 0):32;this.Aa=ja;this.Doa=ha.App.Mib;this.YCh=ha.App.zNa;this.teb=V;this.EEh=qb;this.Ef=Ea;this.YR=Za;this.lp=Va;this.Fe=gc;this.lp.Dwa&&(this.TGb=ia);this.aMm=Ab}Kb(){this.Aa.ua(zb.a.eye,ad.a.view,this.eye,96);this.Aa.ua(zb.a.zZh,
ad.a.view,this.zZh,1028);this.Aa.ua(zb.a.vXh,ad.a.view,this.vXh,96);this.Aa.ua(zb.a.kNe,ad.a.view,this.kNe,1028);this.Aa.ua(zb.a.R3e,ad.a.view,this.R3e,96);this.Aa.ua(zb.a.EZi,ad.a.view,this.F1e,64);this.Aa.ua(zb.a.HZi,ad.a.view,this.F1e,64);this.Aa.ua(zb.a.KZi,ad.a.view,this.pRn,64);this.Aa.ua(zb.a.LZi,ad.a.view,this.qRn,64);this.Aa.ua(zb.a.IZi,ad.a.view,this.oRn,64);this.Aa.ua(zb.a.GZi,ad.a.view,this.nRn,64);this.Aa.ua(zb.a.NZi,ad.a.view,this.FRn,64);this.Aa.ua(zb.a.JZi,ad.a.view,this.sRn,64);this.Aa.ua(zb.a.uGk,
ad.a.view,this.eye,96);this.Aa.ua(zb.a.AZh,ad.a.view,this.AZh,1028);this.Aa.ua(zb.a.lXh,ad.a.view,this.lXh,96);this.Aa.ua(zb.a.gYl,ad.a.view,this.showHelpPane,96);this.Aa.ua(zb.a.hYl,ad.a.view,this.showHelpPane,96);this.Aa.ua(zb.a.fYl,ad.a.view,this.bjo,96);this.Aa.ua(zb.a.Srm,ad.a.view,this.C2n,96);this.Aa.ua(zb.a.iYl,ad.a.view,this.ejo,96);this.Aa.ua(zb.a.Trm,ad.a.view,this.D2n,96);this.Aa.ua(zb.a.tth,ad.a.view,this.tth,1028);this.Aa.ua(zb.a.FZi,ad.a.view,this.mRn,1028);this.Aa.ua(zb.a.eYl,ad.a.view,
this.fTn,96);this.Aa.ua(zb.a.aYl,ad.a.view,this.ERn,96);const ja=ub.a.hb(xa.a.t2h,1);this.Fe.Uc(rb.AFrame.Wl).bindAction(ja,zb.a.MZi);this.Aa.ua(zb.a.MZi,ad.a.view,this.rRn,1028)}oLh(){return n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.ex?this.lp.Dwa?ui.e8m:ui.a8m:this.lp.Dwa?ui.d8m:ui.T7m}mTm(){const ja=Object.assign(new Ve.a,{Title:"",ShowMenuSectionSeparator:!0,DisplayMode:"Menu",Id:"dictationButton",ControlsId:"ctrDictationButton",ControlList:[]}),qb=Object.assign(new hf.a,{Id:"DictationLanguageList_"+
this.oLh(),ExternalId:"DictationLanguageList_"+this.oLh(),LabelText:Box4Intl.Box4Strings.L_DictationRibbonLabel,Command:"1394650145",MenuItemId:this.oLh(),QueryCommand:"2417470717",Image16by16Class:ej.d(ui.cYl),Image32by32Class:ej.d(ui.dYl),Visible:!0,AriaLabel:tb.a.ZRl});Array.add(ja.ControlList,qb);return ja}dYn(ja,qb){ja.MenuItems=Object.assign(new Dc.a,{Id:qb?"DictationSettingsLanguageList":"DictationLanguageList",MenuSectionList:[],UpdateDynamically:!0});if(!qb){var V=this.mTm();Array.add(ja.MenuItems.MenuSectionList,
V)}V=this.lp.Mrm;0<V.length&&(V=Kj.oIh(V,"dictationProdcutionLanguages","",qb),Array.add(ja.MenuItems.MenuSectionList,V));V=this.lp.Drm;0<V.length&&(qb=Kj.oIh(V,"dictationPreviewLanguages",Box4Intl.Box4Strings.L_DictationPreviewLanguages,qb),Array.add(ja.MenuItems.MenuSectionList,qb));ja.PopulationXML=vk.l(ja.MenuItems);this.BKl=!0}R7e(){const ja=this.EEh.value;if(ja){const qb=this.oLh();if(n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.ex){const V={};V[qb]=this.lp.Dwa?"ToggleButtonModel":
"SplitButtonModel";this.BKl&&!this.lp.Dwa&&(V["DictationLanguageList_"+qb]="ToggleButtonModel");ja.ued(V)}this.hzl();this.gEm()}}hzl(){if(this.lp.Dwa){const ja=this.EEh.value;n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.ex&&ja.ued({DictationSettingsAutoPunctuation:"CheckboxModel"})}}gEm(){if(this.lp.Dwa){const ja=this.EEh.value;n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.ex&&ja.ued({DictationSettingsVoiceCommands:"CheckboxModel"})}}pEm(ja){const qb=this.EEh.value;if(qb&&
n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.ex){const V={};V[ja]="ToggleButtonModel";qb.ued(V)}}FCm(){this.ZSe||(this.ZSe=!0,this.TGb.isVisible()?(this.FJh(),this.ZSe=!1):this.showFloatie(),this.R7e())}showFloatie(){this.TGb.showFloatie((new gj(this.lp.hNa)).displayName).then(()=>{0===this.teb.Sqa()&&this.teb.DKe(void 0).then(()=>{this.ZSe=!1}).catch(ja=>{this.ZSe=!1;r.ULS.sendTraceTag(577901849,394,10,"Failed to start dictation {0}",ja)});this.lp.Ifg&&this.Doa&&this.Doa.Bgo();this.YCh&&
this.YCh.startSession()}).catch(()=>{this.ZSe=!1})}o5i(ja){const qb=this.teb.Sqa();if(1===qb||3===qb)return 1;0===qb?this.DKe(null===ja||void 0===ja?void 0:ja.bYl):this.JVa();return 32}FJh(){const ja=this.teb.Sqa();1!==ja&&(this.TGb&&this.TGb.hideFloatie(),this.Doa&&this.Doa.Wgo(),0!==ja&&this.JVa(),this.YCh&&this.YCh.endSession(),this.R7e())}JVa(){this.teb.JVa();this.R7e()}DKe(ja){this.teb.DKe(ja).then(()=>{}).catch(qb=>{r.ULS.sendTraceTag(577901848,394,10,"Failed to start dictation {0}",qb)})}static createInstance(ja,
qb,V,Ea,Za,ia,Va,Ab){return Kj.Qa||(Kj.Qa=new Kj(n.AFrameworkApplication.ub,ja,qb,V,Ea,Za,ia,Va,Ab))}static oIh(ja,qb,V,Ea){V=Object.assign(new Ve.a,{DisplayMode:"Menu",Title:V,Id:qb,ControlsId:"ctr"+qb,ControlList:[]});for(const Za of ja){ja=qb+"_"+Za.uPh;const ia=Za.displayName,Va=Za.uPh;Ea?(ja=Object.assign(new xk.a,{Id:ja,ExternalId:ja,LabelText:ia,Command:"3662249320",MenuItemId:Va,Visible:!0}),Array.add(V.ControlList,ja)):(ja=Object.assign(new hf.a,{Id:ja,ExternalId:ja,LabelText:ia,Command:"2863762275",
MenuItemId:Va,QueryCommand:"2739750502",Visible:!0,AriaLabel:tb.a.BLd}),Array.add(V.ControlList,ja))}return V}}Kj.Qa=null;Kj.Hbi="FA000000012";Kj.Ibi="3876e05f-3fcc-418f-b8ab-db7ce0d11d3c";Kj.lOm="78766431-0933-4603-abf5-5bcc1dee9dda";Object(m.a)(Kj,"DictationActor",null,[606]);var Sk=a(289),tj=a(1378),gk=a(171);class Gk{constructor(ja,qb){this.K_a=null;this.LHa=!1;this.ugd=null;this.kNm=ja;this.lp=qb}isVisible(){return this.LHa}fOh(){return this.LHa&&!!this.K_a}t$m(){if(this.K_a)return!0;this.K_a=
this.kNm.value;if(!this.K_a)return!1;this.K_a.Uyo(zb.a.tth);this.K_a.Tyo(zb.a.FZi);pb.a.addHandler(window.self,ab.a.resize,()=>{this.dqn()});const ja=Ec.FocusManager.instance().Uc(gk.AppFrame.Ikc);ja.e7(qb=>{this.Wbn(qb)});ja.WLa((qb,V)=>{this.Vbn(V)});ja.US=!0;ja.Peh=!0;Sk.a.instance.q$(gk.AppFrame.Ikc,!0);Sk.a.instance.ns(gk.AppFrame.Ikc);return!0}Wbn(ja){this.fOh()&&ja.name!==rb.AFrame.aP&&this.K_a.focus()}Vbn(ja){this.fOh()&&ja.name!==rb.AFrame.aP&&this.K_a.blur()}showFloatie(ja){return this.LHa?
Promise.resolve(null):this.t$m()?new Promise((qb,V)=>{this.K_a.ixo().then(()=>{this.K_a.showDictationFloatie(this.Sfb(),!1,ja,this.lp.useAutoPunctuation);this.ugd=ja;this.LHa=!0;Sk.a.instance.jZ(gk.AppFrame.Ikc);qb(null)}).catch(()=>{V("failed to intialize the floatie")})}):Promise.reject("Unable to find the dictation floatie controller")}hideFloatie(){this.fOh()&&(this.K_a.dismissDictationFloatie(),Sk.a.instance.ns(gk.AppFrame.Ikc),this.LHa=!1)}showDictationWarning(ja){this.fOh()&&this.K_a.showDictationWarning(ja)}onDictationLanguageChanged(ja){this.ugd=
ja}Sfb(){var ja=ha.App.Zb.QXa.getBoundingClientRect();const qb=ja.left+ja.width/2-44;ja=ja.top+ja.height-70;return Object.assign(new tj.a,{x:qb,y:ja})}dqn(){this.LHa&&this.K_a&&(this.K_a.dismissDictationFloatie(),this.K_a.showDictationFloatie(this.Sfb(),!1,this.ugd,this.lp.useAutoPunctuation))}}Object(m.a)(Gk,"DictationFloatieManager",null,[]);class cj{constructor(){this.dQb=this.Guc=0;this.eDh=null;this.$Gb=!0;this.lCh="";this.lp=this.Hs=null;this.Huc=this.fHb=this.Egd=this.yx=this.$l=0;this.$$h=
this.u_a="";this.Xpf=this.wdf=0;this.qai=this.Qai=this.Pai=!1;this.ali="";this.epf=this.Sgf=this.zo=this.seb=null;this.M9h=this.ZDh=this.YDh=this.Emi=this.sOl=this.OHd=this.MHd=0}set q2m(ja){this.u_a=ja}get Aoc(){return ha.App.zNa?ha.App.zNa.Aoc:""}get Ltd(){return ha.App.zNa?ha.App.zNa.Ltd:""}set Ltd(ja){ha.App.zNa&&(ha.App.zNa.Ltd=ja)}onFragment(ja){this.Egd||(this.Egd=(new Date).getTime());this.Sgf&&(this.Sgf.stop(),this.MHd+=this.Sgf.ew,this.Sgf.start());this.Guc++;this.Huc+=ja.split(" ").length}onFinalPhrase(ja){this.Egd||
(this.Egd=(new Date).getTime());this.epf&&(this.epf.stop(),this.OHd+=this.epf.ew,this.epf.start());this.Huc=0;this.dQb++;this.fHb+=ja.split(" ").length}onConnectionStarted(ja){this.wdf=(new Date).getTime();this.q2m=ja;this.zo&&(this.Sgf=this.zo.Xl("WebServiceCall","FragmentResponse"),this.epf=this.zo.Xl("WebServiceCall","PhraseResponse"))}onRecordingStarted(){this.Xpf=(new Date).getTime()}onMicrophoneError(ja){this.onCustomError("MicrophoneError",ja)}onCustomError(ja,qb=null){this.$Gb=!1;this.eDh=
ja;this.setEndReason(qb||ja)}setEndReason(ja){this.$$h=ja}onTextInsertionError(){this.onCustomError("FailedToInsertText")}onTextInserted(ja,qb){this.M9h=qb;ja?(this.Emi+=qb,qb>this.ZDh&&(this.ZDh=qb)):(this.sOl=qb,qb>this.YDh&&(this.YDh=qb))}onFocusLost(){this.Pai=!0}onFocusLostWhileStarting(){this.Qai=!0}onFailedToStartTurn(){this.qai=!0}onSpeechSessionStarted(ja){this.ali=ja}setDictationLatency(ja){this.seb=ja}endActivity(){}onCommandCalled(){}onAugloopError(){}onFinalResultAnnotationResponse(){}onPartialResultAnnotationResponse(){}setRecordingStartTime(){}onCommandError(){}setCurFinalResultAnnotationResponseTime(){}calculateMaxAndMinFinalResultUserPerceivedLatency(){}setCurPartialResultAnnotationResponseTime(){}calculateMaxAndMinPartialResultUserPerceivedLatency(){}setFirstAudioChunkStartTime(){}setMicrophoneWarmUpLatency(){}getDictationStartTime(){}}
Object(m.a)(cj,"AbstractDictationSessionTelemetry",null,[641]);class Hk{}Hk.seen="Seen";Hk.QCm="Tried";Hk.Iam="Kept";Object(m.a)(Hk,"FunnelStatus",null,[]);class Hl{constructor(){this.dataFields=this.name=null}}Object(m.a)(Hl,"Contract",null,[]);class pj extends cj{constructor(ja,qb){super();this.jJl=this.iJl=this.EIl=!1;this.sfi=this.ofi=this.Eii=0;this.Lfi=this.Kfi=2147483647;this.Dmi=this.Bmi=0;this.lp=ja;this.$l=(new Date).getTime();this.zo=qb;this.Ltd=bc.a.create().toString();this.Hs=new Bf.a;
this.Hs.dataFields=[];this.lCh="Office.Voice.Online.ALDictationSession"}onFinalResultAnnotationResponse(ja,qb,V){ja=ja+this.M9h-(this.Eii+(qb+V)/1E4);this.Bmi+=ja;this.ofi<ja&&(this.ofi=ja);this.Kfi>ja&&(this.Kfi=ja)}onPartialResultAnnotationResponse(ja,qb,V){ja=ja+this.M9h-(this.Eii+(qb+V)/1E4);this.Dmi+=ja;this.sfi<ja&&(this.sfi=ja);this.Lfi>ja&&(this.Lfi=ja)}setRecordingStartTime(ja){this.Eii=ja}onCommandCalled(){this.iJl=!0}onAugloopError(ja){this.$Gb=!1;this.EIl=!0;this.eDh=ja}onCommandError(){this.jJl=
!0}endActivity(){this.fHb+=this.Huc;this.yx=(new Date).getTime();this.Hs.succeeded=this.$Gb;this.Hs.durationMs=this.yx-this.$l;Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"Success",bool:this.$Gb}));this.$Gb||Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"error",string:this.eDh}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"SessionID",string:this.Aoc}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"SpeechSessionID",string:this.ali}));Array.add(this.Hs.dataFields,
Object.assign(new gf.a,{name:"TurnID",string:this.Ltd}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"NumberOfWords",int64:0<this.Huc?this.Huc+this.fHb:this.fHb}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"NumberOfFragments",int64:this.Guc}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"NumberOfFinalPhrases",int64:this.dQb}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"Language",string:this.lp.hNa}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,
{name:"connectionID",string:this.u_a}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"IsUsingFloatie",bool:this.lp.Dwa}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"UseAutoPunctuation",bool:this.lp.useAutoPunctuation}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"EndReason",string:this.$$h}));this.Egd&&Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"TimeToGetFirstResult",
int64:this.Egd-this.wdf}));this.$Gb&&(Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"TimeToStartRecording",int64:this.Xpf-this.$l})),Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"TimeToOpenConnection",int64:this.wdf-this.Xpf})));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"FocusLost",bool:this.Pai}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"FocusLostWhileStarting",bool:this.Qai}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"FailedToStartTurn",
bool:this.qai}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"MaxTimeToInsertFragment",int64:this.YDh}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"MaxTimeToInsertPhrase",int64:this.ZDh}));var ja=Hk.seen;this.$Gb&&0<this.fHb&&(ja=0<this.dQb?Hk.Iam:Hk.QCm);Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"DictationFunnel",contract:Object.assign(new Hl,{name:"Office.System.Funnel",dataFields:[Object.assign(new gf.a,{name:"Name",string:"Dictation"}),Object.assign(new gf.a,
{name:"State",string:ja})]})}));this.Hs.name=this.lCh;this.Hs.samplingPolicy=2;Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"AugloopFailed",bool:this.EIl}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"CommandsUsed",bool:this.iJl}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"CommandsFailed",bool:this.jJl}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"MaxFinalResultUserPerceivedLatency",int64:this.ofi}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,
{name:"MinFinalResultUserPerceivedLatency",int64:this.Kfi}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"MaxPartialResultUserPerceivedLatency",int64:this.sfi}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"MinPartialResultUserPerceivedLatency",int64:this.Lfi}));ja=0<this.dQb?this.Bmi/this.dQb:0;const qb=0<this.Guc?this.Dmi/this.Guc:0;Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"AverageFinalResultUserPerceivedLatency",double:ja}));Array.add(this.Hs.dataFields,
Object.assign(new gf.a,{name:"AveragePartialResultUserPerceivedLatency",double:qb}));rk.a.sendActivityEvent(this.Hs)}}Object(m.a)(pj,"AugloopDictationTelemetry",cj,[]);var kj=a(242);class Ti{constructor(ja){this.xjb=ja}play(){this.xjb.play()}pause(){this.xjb.pause()}get paused(){return this.xjb.paused}get currentTime(){return this.xjb.currentTime}set currentTime(ja){this.xjb.currentTime=ja}get duration(){return this.xjb.duration}get error(){const ja=this.xjb.error;return ja?ja.code:0}get readyState(){return this.xjb.readyState}get src(){return this.xjb.getAttribute("src")}set src(ja){this.xjb.setAttribute("src",
ja)}get preload(){return this.xjb.getAttribute("preload")}set preload(ja){this.xjb.setAttribute("preload",ja)}get mg(){return this.xjb}}Object(m.a)(Ti,"AudioElement",null,[]);class dm{constructor(){this.sgi=this.rgi=this.OHd=this.MHd=this.u$h=0}onAudioData(){this.u$h||(this.u$h=(new Date).getTime())}onFragment(ja){this.MHd+=this.c5l(ja);this.rgi++}hTn(ja){this.OHd+=this.c5l(ja);this.sgi++}V1l(){return this.sgi?this.OHd/this.sgi:0}Den(){return this.rgi?this.MHd/this.rgi:this.V1l()}c5l(ja){if(!ja)return 0;
const qb=(new Date).getTime();let V=null;return({NB:V}=ec.d(ja)).returnValue?qb-this.u$h-(V.Offset+V.Duration)/1E4:0}}Object(m.a)(dm,"DictationLatency",null,[]);class hk{constructor(ja,qb){this.akb=0;this.Zki=this.$ki=null;this.Wkf=!1;this.aEh=null;this.GDh=!1;this.seb=this.xO=null;this.Jlm=()=>{if(1===this.akb){if(this.xO)this.xO.onFocusLostWhileStarting()}else 2===this.akb&&(this.Uxl(),this.Jma.onFocusLost())};this.Jma=qb;this.YGb=ja}onFinalText(ja,qb){if(2===this.akb){var V=ja.size;if(1!==V&&(r.ULS.sendTraceTag(51442337,
394,10,"Final text mapping has invalid size of {0}",V),!V))return;qb=qb.get("JsonResult");this.seb&&this.seb.hTn(qb);this.Jma.onFinalPhrase(ja.values().next().value,qb)}}onFragmentText(ja,qb){if(2===this.akb){var V=ja.size;if(1!==V&&(r.ULS.sendTraceTag(51442338,394,10,"Fragment text mapping has invalid size of {0}",V),!V))return;qb=qb.get("JsonResult");if(this.seb)this.seb.onFragment(qb);this.Jma.onFragment(ja.values().next().value)}}onError(ja){if(0!==this.akb&&3!==this.akb&&"ErrorNone"!==ja){this.akb=
3;switch(ja){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.Jma.KPn(ja);break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.Jma.PQn(ja);break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.Jma.BM(ja);break;case "ErrorInitialSilenceTimeout":this.Jma.mSn(ja);break;
case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":case "ErrorAudioCaptureAsync":this.Jma.onMicrophoneError(ja);break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":case "ErrorAudioPermissionDeniedError":this.Jma.pyk("NotAllowedError");break;case "ErrorAudioNotFoundError":case "ErrorAudioDevicesNotFoundError":this.Jma.pyk("NotFoundError");break;case "ErrorAudioNotReadableError":this.Jma.pyk("NotReadableError");break;
default:this.Jma.NUn(ja)}this.akb=0}}onSpeechRecognitionStarted(ja){window.self.document.hasFocus()?(this.akb=2,this.Wkf=!1,this.Jma.onRecordingStarted(),this.Jma.onConnectionStarted(ja),this.$ki||(this.$ki=Object.assign(new Ti(document.createElement("audio")),{src:kj.a.box4Image(ui.vgo)})),this.$ki.play()):(this.Uxl(),this.Jma.onFocusLost())}onSpeechEnd(){this.Uxl();0!==this.Sqa()&&(this.akb=3,this.Jma.zTn(),this.akb=0,this.Zki||(this.Zki=Object.assign(new Ti(document.createElement("audio")),{src:kj.a.box4Image(ui.ugo)})),
this.Zki.play())}onAudioData(ja){if(this.seb)this.seb.onAudioData();if(this.YGb){var qb=0;for(const V of ja)qb+=Math.pow(V,2);ja=Math.sqrt(qb/ja.length)>hk.mgo;!this.Wkf&&ja?(this.Wkf=!0,this.aEh=null):this.Wkf&&!ja&&(this.aEh?(new Date).getTime()>=this.aEh+hk.JIn&&(this.Wkf=!1):this.aEh=(new Date).getTime())}}onSpeechSessionStarted(ja){this.Jma.onSpeechSessionStarted(ja)}onEventUpdate(ja){if(this.YGb&&"QualityStatusUpdate"===ja.eventName)switch(ja.shortCode){case 13:case 2:this.YGb.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningLowSoundLevel);
break;case 3:case 4:this.YGb.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningTooMuchNoise);break;case 8:case 6:case 7:this.YGb.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningCheckNetworkConnection)}}gtd(ja,qb){this.Jma.uFc(!1);this.Jma.R4=ja;this.Jma.i9l=qb;this.S4n();this.xO=ja;this.akb=1;this.seb=new dm;this.xO&&this.xO.setDictationLatency(this.seb)}Sqa(){return this.akb}S4n(){this.GDh||(pb.a.addHandler(window.self,ab.a.blur,this.Jlm),this.GDh=!0)}Uxl(){this.GDh&&(pb.a.removeHandler(window.self,
ab.a.blur,this.Jlm),this.GDh=!1)}}hk.mgo=350;hk.JIn=350;Object(m.a)(hk,"FrontdoorSpeechClientObserver",null,[647]);class Ui extends hk{constructor(ja,qb){super(ja,qb);this.Hgd=new hk(ja,qb)}onFinalText(ja,qb){this.Hgd.onFinalText(ja,qb)}onFragmentText(ja,qb){this.Hgd.onFragmentText(ja,qb)}onError(ja){this.Hgd.onError(ja)}onSpeechRecognitionStarted(ja){this.Hgd.onSpeechRecognitionStarted(ja)}onSpeechEnd(){this.Hgd.onSpeechEnd()}onAudioData(ja){this.Hgd.onAudioData(ja)}gtd(ja,qb){this.Hgd.gtd(ja,qb)}Sqa(){return this.Hgd.Sqa()}}
Object(m.a)(Ui,"AugloopFrontdoorSpeechObserverAbstractDecorator",hk,[]);class Lj extends Ui{constructor(ja,qb,V){super(ja,qb);this.Qc=V}onFinalText(ja,qb){super.onFinalText(ja,qb)}onFragmentText(ja,qb){if(this.RXj())super.onFragmentText(ja,qb)}onError(ja){super.onError(ja)}onSpeechRecognitionStarted(ja=null){const qb=bc.a.create().toString();super.onSpeechRecognitionStarted(ja?ja:qb)}onSpeechEnd(){super.onSpeechEnd()}onAudioData(ja){super.onAudioData(ja)}gtd(ja,qb){super.gtd(ja,qb)}Sqa(){return super.Sqa()}RXj(){const ja=
this.Qc.Wa.qb.Ya;return ja.Mb!==ja.Xa?!1:!0}}Object(m.a)(Lj,"AugloopFrontdoorSpeechObserverDecorator",Ui,[]);class qj{constructor(ja){this.GOl=ja}onVoiceCommand(ja){this.GOl.onVoiceCommand(ja)}setDictationSessionTelemetry(ja){this.GOl.setDictationSessionTelemetry(ja)}}Object(m.a)(qj,"AugloopVoiceCommandObserverAbstractDecorator",null,[633]);class Ik extends qj{constructor(ja,qb,V){super(ja);this.qeb=qb;this.Qc=V}onVoiceCommand(ja){this.RXj()&&this.qeb.zzo();super.onVoiceCommand(ja)}setDictationSessionTelemetry(ja){super.setDictationSessionTelemetry(ja)}RXj(){const ja=
this.Qc.Wa.qb.Ya;return ja.Mb!==ja.Xa?!1:!0}}Object(m.a)(Ik,"AugloopVoiceCommandObserverDecorator",qj,[]);class Mj{constructor(ja){this.lp=ja}ubm(ja){const qb=n.AFrameworkApplication.$d;if(qb){var V=this.lp.i1l;V&&""!==V&&qb.ik(String.format("https://{0}/SpeechHandler.ashx?action=SendCorrectionTelemetry",V),2,ja,{["Content-Type"]:"application/json; charset=utf-8"},!1,3,()=>{},()=>{},null)}}}Object(m.a)(Mj,"FrontdoorCorrectionsTelemetryLogger",null,[634]);class Il{constructor(){this.properties=this.useCorrections=
this.useAutoPunctuation=this.dictationLanguage=null}}Object(m.a)(Il,"SpeechDictationSettings",null,[]);var fl=a(1707);class em{constructor(ja,qb,V,Ea){this.t$h=this.q5=null;this.qeb=ja;this.YGb=qb;this.Jma=V;this.KRe=Ea;this.initializeCommandsDictionary()}onVoiceCommand(ja){if(this.t$h)this.t$h.onCommandCalled();var qb=4;if(({value:qb}=this.q5.Ph(ja.commandId,0)).returnValue&&4!==qb){let V=null;ja.commandValue&&(V=new fl.a(Qc.a.Co()),V.add("commandValue",ja.commandValue));this.Jma.uFc(!1);qb=this.qeb.executeCommand(qb,
V);if(ja.offset&&ja.duration)this.KRe.onCommandFinished(ja.commandId,qb,ja.offset,ja.duration)}}setDictationSessionTelemetry(ja){this.t$h=ja}initializeCommandsDictionary(){this.q5=new fl.a(Qc.a.Co());this.q5.add("Word.Editing.Undo",2);this.q5.add("Word.Editing.Bold",5);this.q5.add("Word.Editing.Italics",6);this.q5.add("Word.Editing.Underline",10);this.q5.add("Word.Editing.StrikeThrough",20);this.q5.add("Word.Editing.Subscript",19);this.q5.add("Word.Editing.Superscript",18);this.q5.add("Word.Editing.RemoveBold",
11);this.q5.add("Word.Editing.RemoveUnderline",13);this.q5.add("Word.Editing.RemoveItalics",12);this.q5.add("Word.Editing.RemoveStrikeThrough",21);this.q5.add("Word.Editing.RemoveSubscript",22);this.q5.add("Word.Editing.RemoveSuperscript",24);this.q5.add("Word.Editing.Paste",7);this.q5.add("Word.Editing.InsertTable",8);this.q5.add("Word.Editing.InsertComment",9);this.q5.add("Word.Editing.InsertBullet",23);this.q5.add("Word.Editing.FullJustify",14);this.q5.add("Word.Editing.CenterJustify",15);this.q5.add("Word.Editing.LeftJustify",
16);this.q5.add("Word.Editing.RightJustify",17);this.q5.add("Command.Exit",1);this.q5.add("Command.Pause",0);this.q5.add("Command.ShowHelp",26);this.q5.add("Command.ShowCommand",27);this.q5.add("Word.Editing.RemoveFormatting",28)}}Object(m.a)(em,"VoiceCommandObserver",null,[633]);var Lk=a(1608);class gl{constructor(ja,qb,V,Ea,Za,ia,Va){this.xO=this.Cuf=null;this.Etn=0;this.KRe=Za;this.lp=Va;Za=new Il;Za.dictationLanguage=Va.hNa;Za.useAutoPunctuation=Va.useAutoPunctuation?"Intelligent":"Explicit";
Za.useCorrections=Va.Ifg.toString();alVoiceClient.DictationSettingsManager.dictationSettings=Za;this.kmb=new Lj(ja,ia,Ea);this.HOl=new Ik(new em(qb,ja,ia,this.KRe),qb,Ea);this.tCh=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();this.zIl=Array(V);this.tCh.setAnnotationResultCallback(Object.assign(new Lk.a,{handler:Ab=>{for(const gc of this.zIl)gc.onAnnotationResult(Ab)}}));this.xsf=new alVoiceClient.SpeechToTextClient(this.tCh,this.kmb,Va.OPe||Va.n2h,!1);this.YOl(this.xsf.getAnnotationObserver());
this.Buf=new alVoiceClient.VoiceCommandingClient(this.tCh,this.HOl,this.kmb);this.YOl(this.Buf.getAnnotationObserver());Va.Ifg&&(ja=new Mj(Va),(qb=ha.App.Mib)&&qb.ntm(ja))}y8l(ja,qb){return new Promise(V=>{const Ea=new Il;Ea.dictationLanguage=ja;Ea.useAutoPunctuation=this.lp.useAutoPunctuation?"Intelligent":"Explicit";alVoiceClient.DictationSettingsManager.dictationSettings=Ea;this.xO=qb;V(this.Sun())})}DKe(ja){if(!this.xsf)return 3;this.Cuf.startVoiceSessionFromMicrophoneInput();this.kmb.gtd(this.xO,
ja);ja=this.lp.h8e;this.xsf.initializeAsync(ja?[1]:[1,0],this.xO);ja&&this.Rgo();return 0}JVa(ja){if(ja&&this.kmb)this.kmb.onSpeechEnd();this.xsf&&this.xsf.uninitializeAsync();this.Cuf&&(this.Cuf.stopVoiceSession(),this.Cuf=null);this.xO=null;this.lp.h8e&&this.eho()}Sqa(){return this.kmb.Sqa()}Sun(){this.lp.h8e&&this.HOl.setDictationSessionTelemetry(this.xO);this.Cuf=new alVoiceClient.VoiceSession(this.tCh,this.kmb,this.lp.OPe,this.KRe,this.xO);return 0}Rgo(){this.Buf&&this.Buf.initializeAsync(this.xO)}eho(){this.Buf&&
this.Buf.uninitializeAsync()}YOl(ja){this.zIl[this.Etn++]=ja}}Object(m.a)(gl,"AugloopSpeechClientProxy",null,[620]);class Ll extends cj{constructor(ja,qb){super();this.lp=ja;this.$l=(new Date).getTime();this.zo=qb;this.Ltd=bc.a.create().toString();this.Hs=new Bf.a;this.Hs.dataFields=[];this.lCh="Office.Voice.Online.DictationSession"}endActivity(){this.fHb+=this.Huc;this.yx=(new Date).getTime();this.Hs.succeeded=this.$Gb;this.Hs.durationMs=this.yx-this.$l;Array.add(this.Hs.dataFields,Object.assign(new gf.a,
{name:"Success",bool:this.$Gb}));this.$Gb||Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"error",string:this.eDh}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"SessionID",string:this.Aoc}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"SpeechSessionID",string:this.ali}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"TurnID",string:this.Ltd}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"NumberOfWords",int64:0<this.Huc?this.Huc+this.fHb:
this.fHb}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"NumberOfFragments",int64:this.Guc}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"NumberOfFinalPhrases",int64:this.dQb}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"Language",string:this.lp.hNa}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"connectionID",string:this.u_a}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Hs.dataFields,
Object.assign(new gf.a,{name:"IsUsingFloatie",bool:this.lp.Dwa}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"UseAutoPunctuation",bool:this.lp.useAutoPunctuation}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"EndReason",string:this.$$h}));this.Egd&&Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"TimeToGetFirstResult",int64:this.Egd-this.wdf}));this.$Gb&&(Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"TimeToStartRecording",int64:this.Xpf-this.$l})),
Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"TimeToOpenConnection",int64:this.wdf-this.Xpf})));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"FocusLost",bool:this.Pai}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"FocusLostWhileStarting",bool:this.Qai}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"FailedToStartTurn",bool:this.qai}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"AverageFragmentLatency",double:this.seb?this.seb.Den():
0<this.Guc?this.MHd/this.Guc:0}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"AveragePhraseLatency",double:this.seb?this.seb.V1l():0<this.dQb?this.OHd/this.dQb:0}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"AveragePhraseInsertionLatency",double:0<this.dQb?this.Emi/this.dQb:0}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"AverageFragmentInsertionLatency",double:0<this.Guc?this.sOl/this.Guc:0}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"MaxTimeToInsertFragment",
int64:this.YDh}));Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"MaxTimeToInsertPhrase",int64:this.ZDh}));let ja=Hk.seen;this.$Gb&&0<this.fHb&&(ja=0<this.dQb?Hk.Iam:Hk.QCm);Array.add(this.Hs.dataFields,Object.assign(new gf.a,{name:"DictationFunnel",contract:Object.assign(new Hl,{name:"Office.System.Funnel",dataFields:[Object.assign(new gf.a,{name:"Name",string:"Dictation"}),Object.assign(new gf.a,{name:"State",string:ja})]})}));this.Hs.name=this.lCh;this.Hs.samplingPolicy=2;rk.a.sendActivityEvent(this.Hs)}}
Object(m.a)(Ll,"DictationSessionTelemetry",cj,[]);var Xl=a(1548);class tf{constructor(ja,qb){this.Ygd=ja;this.HOm=qb}getAccessToken(ja){this.HOm&&this.Ygd?this.Ygd.hP("OfficeDictation",n.AFrameworkApplication.ha.Ma("DictationResourceID")).then(qb=>{qb.IsSuccess?ja(qb.Token):ja(tf.t1i)}).catch(()=>{ja(tf.t1i)}):ja(tf.t1i)}}tf.t1i="dictation access token";Object(m.a)(tf,"AuthenticationProvider",null,[]);class Df{constructor(ja){this.KOm=ja;this.gFh=new Xj.a}debugAssertTag(ja,qb,V,Ea){this.G2h(Ea);this.gFh.debugAssertTag(ja,
qb,V,Ea)}debugTraceTag(ja,qb,V,Ea){this.G2h(Ea);this.gFh.debugTraceTag(ja,qb,V,Ea)}sendTraceTag(ja,qb,V,Ea){this.G2h(Ea);this.gFh.sendTraceTag(ja,qb,V,Ea)}shipAssertTag(ja,qb,V,Ea){this.G2h(Ea);this.gFh.shipAssertTag(ja,qb,V,Ea)}G2h(ja){if(this.KOm){const qb=window.console;qb&&qb.log(String.format("FDSpeechService: {0}",ja))}}}Object(m.a)(Df,"FrontdoorExternalLogger",null,[140]);class og{constructor(){this.accessToken=null}}Object(m.a)(og,"IAuthenticationProvider",null,[]);class zj{constructor(){this.customEndpointConfig=
this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.speechProcessorScript=null}}Object(m.a)(zj,"ISpeechConfig",null,[]);class kg{constructor(ja,qb,V,Ea,Za){this.xO=this.USe=null;this.wli=!1;this.kmb=new hk(V,Ea);this.WWa=ja;this.lp=qb;this.qMm=new tf(Za,qb.Twn);this.lp.Ifg&&(ja=new Mj(qb),(qb=ha.App.Mib)&&qb.ntm(ja))}y8l(ja,
qb){return new Promise(V=>{this.qMm.getAccessToken(Ea=>{V(this.Fun(ja,qb,Ea))})})}Fun(ja,qb,V){this.xO=qb;ja=this.ZKf(ja);V=Object.assign(new og,{accessToken:V});qb=new Df(this.lp.uOh);this.USe=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(ja,this.kmb,V,null,qb);return this.USe?0:(r.ULS.shipAssertTag(42796123,394,!1,"Speech client was not successfully created"),3)}DKe(ja){if(!this.USe)return 3;this.kmb.gtd(this.xO,ja);this.USe.startSpeechRecognition();return 0}JVa(ja){if(!this.wli){this.wli=
!0;if(this.USe)try{this.USe.stopSpeechRecognition()}catch(qb){r.ULS.shipAssertTag(593277727,394,!1,qb.message)}if(ja&&this.kmb)this.kmb.onSpeechEnd();this.xO=null;this.wli=!1}}Sqa(){return this.kmb.Sqa()}ZKf(ja){const qb=new zj;qb.speechMode="Dictation";qb.sourceLanguage=ja;(ja=this.lp.i1l)&&""!==ja&&(qb.speechFDBase=String.format("wss://{0}/",ja));qb.properties=new Map;this.WWa&&(qb.properties.set("DictationInsertionPointLeft",this.WWa.Tsj()),qb.properties.set("DictationInsertionPointRight",this.WWa.W4l()));
qb.properties.set("Corrections","true");qb.properties.set("punctuation",this.lp&&this.lp.useAutoPunctuation?"Intelligent":"Explicit");this.lp.uOh&&qb.properties.set("EnableAudioLogging",this.lp.uOh.toString());switch(Xl.a.TTe){case "Word":qb.clientApp=1;break;case "PowerPoint":qb.clientApp=0;break;case "OneNote":qb.clientApp=2}return qb}}Object(m.a)(kg,"FrontdoorSpeechClientProxy",null,[620]);var Te=a(1283);class vi{static Rdo(){vi.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationAccessDeniedErrorMessage)}static heo(){vi.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,
Box4Intl.Box4Strings.L_DictationFailedToConnectErrorMessage)}static Peo(ja){vi.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,ja)}static qfo(){vi.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationUnknownErrorMessage)}static showDialog(ja,qb){vi.lh||(vi.lh=new J.a,vi.lh.Vw=n.AFrameworkApplication.zra,vi.lh.Ue=0,vi.lh.vg(1,CommonUIStrings.l_DialogClose),vi.lh.h6(ja,qb,()=>{vi.lh=null}))}}vi.lh=null;Object(m.a)(vi,"Dialogs",null,[]);class uj{constructor(ja,
qb,V,Ea,Za,ia,Va,Ab){this.vSe=this.aTe=!1;this.R4=null;this.WWa=ja;this.i9l=qb;this.Aa=V;this.ogd=Ea;this.lp=Za;this.qeb=ia;this.rdf=Va;this.YGb=Ab;this.gNl=new Te.a;for(ja=0;ja<uj.fNl.length;ja++)this.gNl.add(uj.fNl.charAt(ja).toString())}onFinalPhrase(ja,qb=null){let V=!0;if(this.R4)this.R4.onFinalPhrase(ja);if(this.rdf&&this.qeb){var Ea=this.rdf.gyo(ja);if(Ea){this.uFc(!1);this.qeb.executeCommand(Ea.commandId,null);return}}Ea=(new Date).getTime();if(1===ja.length&&"\n"===ja)this.Jyj("",null),this.v_l();
else{let Za=ja.indexOf("\n");for(0<Za&&Za!==ja.length-1&&(V=!1);0<=Za;)this.Jyj(ja.substr(0,Za),V?qb:null),this.v_l(),ja=ja.substr(Za+1),Za=ja.indexOf("\n"),V=!1;this.Jyj(ja,V?qb:null)}ja=(new Date).getTime();if(this.R4)this.R4.onTextInserted(!0,ja-Ea)}onFragment(ja){if(this.aTe)var qb=this.tMh(ja);else{if(!this.Iph())return;qb=this.vSe?this.tMh(ja):ja}if(this.R4)this.R4.onFragment(ja);ja=!0;const V=(new Date).getTime();this.WWa&&!this.WWa.FRl(qb)&&(this.T5l(),ja=!1);qb=(new Date).getTime();if(this.R4)this.R4.onTextInserted(!1,
qb-V);ja&&this.qeb&&this.qeb.Zxo()}onRecordingStarted(){this.Aa.Eb(zb.a.KZi,2);if(this.R4)this.R4.onRecordingStarted()}onMicrophoneError(ja=""){this.e6l(Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage,ja)}F1e(ja){if(this.R4)this.R4.onCustomError(ja);this.Aa.Ra(zb.a.EZi,2,ja)}KPn(ja){this.F1e(ja);vi.Rdo()}PQn(ja){this.F1e(ja);vi.heo()}NUn(ja){this.F1e(ja);vi.qfo()}BM(ja){this.R4&&this.R4.setEndReason(ja);this.Aa.Ra(zb.a.JZi,2,ja)}mSn(ja){this.BM(ja);this.gfo()}zTn(){this.uFc(!1);this.Aa.Eb(zb.a.LZi,
2)}onConnectionStarted(ja){if(this.R4)this.R4.onConnectionStarted(ja)}pyk(ja){this.e6l(this.Oin(ja),ja)}onFocusLost(){if(this.R4)this.R4.onFocusLost();this.Aa.Eb(zb.a.GZi,2)}Tyn(ja){return this.i9l&&!za.a.plg(ja)&&!this.gNl.contains(ja.toString())}tMh(ja){return 0<ja.length&&this.Tyn(ja.charAt(0))?" "+ja:ja}Iph(){if(this.aTe)return!0;if(this.WWa){const ja=this.WWa.Tsj();this.vSe=!1;ja&&0<ja.length&&(this.vSe=!za.a.plg(ja.charAt(ja.length-1))&&!ja.endsWith("\u201c"));return this.aTe=this.WWa.Iph()}if(this.R4)this.R4.onFailedToStartTurn();
this.qeb&&this.qeb.ayo();return!1}uFc(ja){this.vSe=this.aTe=!1;this.WWa&&(ja&&this.WWa.Djm(),this.WWa.uFc())}onSpeechSessionStarted(ja){if(this.R4)this.R4.onSpeechSessionStarted(ja);this.lp.uOh&&this.D_h(ja)}e6l(ja,qb=""){if(this.R4)this.R4.onMicrophoneError(qb);this.Aa.Eb(zb.a.HZi,2);vi.Peo(ja)}Oin(ja){ja=ja.trimStart();return ja.startsWith("NotAllowedError")||ja.startsWith("PermissionDeniedError")?Box4Intl.Box4Strings.L_DictationMicrophoneAccessDeniedMessage:ja.startsWith("NotFoundError")||ja.startsWith("DevicesNotFoundError")?
Box4Intl.Box4Strings.L_DictationMicrophoneNotFoundMessage:ja.startsWith("NotReadableError")||ja.startsWith("TrackStartError")?Box4Intl.Box4Strings.L_DictationMicrophoneInUseMessage:Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage}gfo(){this.ogd&&this.ogd.execute(ja=>{ja.Ezm(Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage)})}D_h(ja){this.ogd&&this.ogd.execute(qb=>{qb.D_h(String.format("ServiceSessionID:{0} ClientSessionId: {1}",
ja,this.m1m))})}Jyj(ja,qb){if(this.aTe||this.Iph()){if(this.WWa){const V=this.vSe?this.tMh(ja):ja;(this.lp.Ifg&&Object(qa.a)(619,this.WWa)?this.WWa.jxo(V,qb,0<ja.length&&ja.charAt(0)!==V.charAt(0)):this.WWa.F8l(this.vSe?this.tMh(ja):ja))||this.T5l()}this.uFc(!0)}}T5l(){if(this.R4)this.R4.onTextInsertionError();this.Aa.Eb(zb.a.NZi,2)}v_l(){this.Aa.Eb(zb.a.YB,2)}get m1m(){return ha.App.zNa?ha.App.zNa.Aoc:""}}uj.fNl='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d';Object(m.a)(uj,"SpeechClientObserverController",
null,[]);class ah{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd){this.Dwc=null;this.Yki=new Map;this.rdf=this.qeb=this.YGb=this.xO=null;this.SU=ja;this.lNm=qb;this.Qc=V;this.ogd=Ea;this.zo=Za;this.lp=ia;this.Ygd=fd;this.PNl=hd;this.lp.Dwa&&(this.YGb=Va);if(this.lp.z9l||this.lp.OPe)this.qeb=Ab;this.lp.z9l&&(this.rdf=gc);this.KRe=Hc}DKe(ja){this.ogd&&this.ogd.execute(Ea=>{Ea.S6l()});const qb=this.lNm.value,V=null!==ja&&void 0!==ja?ja:"Box4.Dictation.IDictationHost";return new Promise((Ea,Za)=>{this.Yki.has(V)?
(this.Dwc=this.Yki.get(V),this.z_l(Ea,Za)):this.iBn().then(()=>{if(qb){const ia=qb.c4m(V);this.Dwc=this.X5m(ia);this.Yki.set(V,this.Dwc);this.z_l(Ea,Za)}else Za(4)}).catch(()=>{Za(2)})})}z_l(ja,qb){this.gtd().then(V=>{0===V?ja(0):qb(V)}).catch(V=>{qb(V)})}gtd(){return new Promise((ja,qb)=>{this.xO=new Ll(this.lp,this.zo);if(this.lp.n2h||this.lp.OPe)this.xO=new pj(this.lp,this.zo);this.Dwc.y8l(this.lp.hNa,this.xO).then(V=>{0!==V?ja(V):ja(this.Dwc.DKe(this.Dam()))}).catch(V=>{qb(V)})})}iBn(){return this.lp.n2h||
this.lp.OPe?this.ibm("alVoiceClient",!0):this.ibm("PPTSpeechClient")}ibm(ja,qb=!1){return!qb&&this.PNl&&n.AFrameworkApplication.Ha.Ib.xOh?(qb=n.AFrameworkApplication.oh(ja,2),Ff.a(this.PNl.dmc(qb))):this.SU?this.SU.loadScript(ja):new Promise((V,Ea)=>{Ea("Unable to load speech client "+ja)})}JVa(ja=!0){0!==this.Sqa()&&(this.Dwc&&this.Dwc.JVa(ja),this.xO&&(this.xO.endActivity(),this.xO=null))}Sqa(){return this.Dwc?this.Dwc.Sqa():0}Dam(){return"zh-CN"!==this.lp.hNa&&"ja-JP"!==this.lp.hNa}X5m(ja){const qb=
new uj(ja,this.Dam(),n.AFrameworkApplication.ub,this.ogd,this.lp,this.qeb,this.rdf,this.YGb);return this.lp.n2h||this.lp.OPe?new gl(this.YGb,this.qeb,2,this.Qc,this.KRe,qb,this.lp):new kg(ja,this.lp,this.YGb,qb,this.Ygd)}}Object(m.a)(ah,"DictationManager",null,[]);class Pi{constructor(){this.RMl=[];this.Ltd=this.Tji=""}startSession(){this.Tji=bc.a.create().toString();this.RMl=[]}endSession(){this.Tji=""}get Aoc(){return this.Tji}get Dpm(){return this.RMl}}Object(m.a)(Pi,"DictationSessionInfo",null,
[577]);class hj{constructor(ja,qb,V){this.zni=this.guf=this.tni=this.auf=!1;this.ugd="";this.Ga=ja?ja:n.AFrameworkApplication.ha;this.aHb=qb;this.Qc=V}get useAutoPunctuation(){if(!this.Dwa||!this.LNj)return!1;if(this.tni)return this.auf;const ja=Gc.a.instance.getItem("WACDictationFUseAutoPunctuation");this.auf=void 0===ja||null===ja?this.Ga.getBooleanAppSetting("DictationAutoPunctuationEnglishDefaultOnIsEnabled")?Array.contains(ui.VXm,this.hNa):!1:Boolean.parse(ja);this.tni=!0;return this.auf}set useAutoPunctuation(ja){this.Dwa&&
this.LNj&&(this.auf=ja,this.tni=!0,Gc.a.instance.setItem("WACDictationFUseAutoPunctuation",this.auf.toString()))}get h8e(){if(!this.Dwa||!this.s_j)return!1;if(this.zni)return this.guf;const ja=Gc.a.instance.getItem("WACDictationFloatieUseVoiceCommands");this.guf=void 0===ja||null===ja?!0:Boolean.parse(ja);this.zni=!0;return this.guf}set h8e(ja){this.Dwa&&this.s_j&&(this.guf=ja,this.zni=!0,Gc.a.instance.setItem("WACDictationFloatieUseVoiceCommands",this.guf.toString()))}get LNj(){return Array.contains(ui.WXm,
this.hNa)}get s_j(){return this.OPe&&Array.contains(ui.Loo,this.hNa)}get hNa(){""===this.ugd&&(this.ugd=this.bgn());return this.ugd}set hNa(ja){ja&&(this.ugd=ja)}get Ifg(){return this.Dwa}get Dwa(){return this.Ga.getBooleanAppSetting("WacBox4DictationFloatieIsEnabled")}get wno(){return this.Ga.getBooleanAppSetting("WacBox4DictationInternalArticle")}get i1l(){return this.Ga.Ma("DictationFrontdoorDomain")}get n2h(){return this.Ga.getBooleanAppSetting("WacBox4DictationUseAugloopService")}get z9l(){return this.Ga.getBooleanAppSetting("WacBox4DictationCommandsIsEnabled")&&
this.Dwa}get OPe(){return this.Ga.getBooleanAppSetting("WacBox4DictationUseAugloopServiceWithFrontdoor")}get Twn(){return this.Ga.getBooleanAppSetting("WacDictationAuthenticationEnabled")}get uOh(){return this.Ga.getBooleanAppSetting("DictationDebugModeEnabled")}get Mrm(){return this.getSupportedLanguages(0)}get Drm(){return this.getSupportedLanguages(1)}get Uwn(){return dc.a.I0h&&this.Ga.getBooleanAppSetting("UserCanUseDictation")}getSupportedLanguages(ja){const qb=[];ja=0===ja?ui.productionLanguages:
ui.previewLanguages;for(const V of ja)Array.add(qb,new gj(V));qb.sort((V,Ea)=>V.displayName.localeCompare(Ea.displayName));return qb}bgn(){if(this.aHb&&this.Qc){const ja=this.aHb.$We(this.Qc.sk);for(const qb of this.Mrm)if(qb.LCID===ja)return qb.uPh;for(const qb of this.Drm)if(qb.LCID===ja)return qb.uPh}return ui.X6m}}Object(m.a)(hj,"DictationSettings",null,[]);class Pl{constructor(){this.FJl=this.Oa=null}get name(){return"Box4.Dictation"}oc(ja){this.Oa=ja;const qb=k.a.instance.Db("Common.IDynamicScriptLoaderProvider");
let V=null;qb&&(V=qb.SU);const Ea=k.a.instance.he("Box4.Dictation.IDictationHostFactory");this.Oa.register(hj,"Box4.Dictation.DictationSettings").oa().pa(()=>new hj(this.Oa.resolve("Common.IAppSettingsManager"),this.Oa.resolve("Box4.ILanguageReader"),this.Oa.resolve("Box4.ISelectionManager")));const Za=k.a.instance.he("Common.IDictationFloatieController");this.Oa.register(Gk,"Box4.Dictation.DictationFloatieManager").oa().pa(()=>new Gk(Za,this.Oa.resolve("Box4.Dictation.DictationSettings")));this.Oa.register(ah,
"Box4.Dictation.DictationManager").oa().pa(()=>new ah(V,Ea,this.Oa.resolve("Box4.ISelectionManager"),ja.eb("Box4.IBusinessBarController"),ja.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Oa.resolve("Box4.Dictation.DictationSettings"),this.Oa.resolve("Box4.Dictation.DictationFloatieManager"),this.Oa.Db("Box4.DictationCommands.IDictationCommandManager"),this.Oa.Db("Box4.DictationCommands.IDictationCommandParser"),this.Oa.Db("Box4.DictationCommands.IDictationCommandsTelemetry"),
this.Oa.resolve("Common.App.OAuth.IOAuthManager"),this.Oa.resolve("Common.ISharedDependencyLoader")));this.Oa.register(577,"Box4.Dictation.IDictationSessionInfo").oa().pa(()=>new Pi)}init(){this.Oa.resolve("Box4.Dictation.IDictationSessionInfo");this.FJl=Kj.createInstance(this.Oa.he("Common.IRibbonButtonUpdater"),this.Oa.resolve("Box4.Dictation.DictationManager"),this.Oa.resolve("Box4.IFormattingEditor"),this.Oa.resolve("Box4.IFormattingReader"),this.Oa.resolve("Box4.Dictation.DictationFloatieManager"),
this.Oa.resolve("Box4.Dictation.DictationSettings"),this.Oa.he("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Ec.FocusManager.instance());this.FJl.Kb();ha.App.Zb.fg()}dispose(){}}Object(m.a)(Pl,"DictationPackageManager",null,[4,5]);class al{constructor(ja){this.ga=ja}c4m(ja){return this.ga.resolve(ja)}}Object(m.a)(al,"DictationHostFactory",null,[578]);class ul{constructor(ja,qb,V){this.VYa=null;this.Rja=this.KYa=-1;this.F_e=!1;this.HI=ja;this.sa=qb;this.la=V}Tsj(){return this.Y4l(!1)}W4l(){return this.Y4l(!0)}Iph(){this.VYa&&
this.uFc();const ja=this.sa.Wa.qb;if(ja){const qb=ja.Ya;if(qb&&Wf.ParagraphReader.ue(qb.node))return this.VYa=qb.node,this.Rja=ja.Ya.Neb,this.KYa=ja.Ya.wSb,this.F_e=!0}return!1}uFc(){this.VYa=null;this.F_e=!1;this.KYa=this.Rja=-1}FRl(ja){if(this.VYa){const qb=new eb.GraphTransaction(15);try{qb.ld(this.VYa);const V=this.F_e&&this.Rja!==this.KYa?re.a.createTextRange(this.VYa,this.Rja,this.KYa):re.a.Oj(this.VYa,this.KYa);this.HI.replaceTextRange(V,ja);this.KYa=this.F_e?this.Rja+ja.length:this.KYa+ja.length;
const Ea=Ki.SelectionFactory.Mg(this.VYa,this.KYa);this.sa.setSelection(Ea);this.F_e=!1;return!0}finally{qb&&qb.dispose()}}return!1}F8l(ja){if(this.VYa){const qb=new eb.GraphTransaction(15);try{qb.ld(this.VYa);const V=this.Rja!==this.KYa?re.a.createTextRange(this.VYa,this.Rja,this.KYa):re.a.Oj(this.VYa,this.KYa);this.HI.replaceTextRange(V,ja);this.KYa=this.Rja+ja.length;const Ea=Ki.SelectionFactory.Mg(this.VYa,this.KYa);this.sa.setSelection(Ea);this.F_e=!1;return!0}finally{qb&&qb.dispose()}}return!1}Djm(){var ja=
this.sgn();this.la&&ja&&ja.Neb!==ja.wSb&&0<=ja.Neb&&(ja=re.a.createTextRange(ja.node,ja.Neb,ja.wSb),this.la.Ra(zb.a.IZi,2,ja))}sgn(){return this.VYa?this.Rja!==this.KYa?re.a.createTextRange(this.VYa,this.Rja,this.KYa):re.a.Oj(this.VYa,this.KYa):null}Y4l(ja){var qb=this.sa.Wa.qb;if(qb){var V=qb.Ya;if(V&&(qb=V.node,Wf.ParagraphReader.ue(qb)&&(V=ja?V.wSb:V.Neb,qb=Wf.ParagraphReader.text(qb),V<=qb.length)))return ja?qb.substring(V,qb.length):qb.substring(0,V)}return""}}Object(m.a)(ul,"DictationHost",
null,[576]);class ik{get name(){return"PowerPointWebEditor.Dictation"}oc(ja){ja.register(al,"PowerPointWebEditor.Dictation.DictationHostFactory").as("Box4.Dictation.IDictationHostFactory").oa().pa(()=>new al(ja));ja.register(ul,"PowerPointWebEditor.Dictation.DictationHost").as("Box4.Dictation.IDictationHost").oa().pa(()=>new ul(ja.resolve("Box4.ICharacterPropertiesEditor"),ja.resolve("Box4.ISelectionManager"),n.AFrameworkApplication.ub))}init(){}dispose(){}static main(){I.a.instance.Jc(new ik)}}Object(m.a)(ik,
"PPTWebEditorDictationPackage",null,[4,5]);var nj=a(1223),Eh=a(1582),Wh=a(172);const ni=()=>k.a.instance.resolve("Common.App.Policy.Contracts.IPolicyManager");var Ql=a(626);class Al{constructor(ja,qb,V=null){this.id=ja.Id;V||(V="");this.U3n=V;this.sensitivityLabel=ja}}Object(m.a)(Al,"AutoPolicyLabelData",null,[]);class xg{constructor(ja,qb){this.hnb=ja;this.displayName=qb}}Object(m.a)(xg,"PolicyLabelRequestState",null,[]);class Sg{constructor(){this.A6k=this.uuk=""}}Object(m.a)(Sg,"PolicyStrings",
null,[]);class Bl extends Ia.a{constructor(ja,qb){super(!1,!1,!0);this.V0=null;this.oCh=!1;this.Hsm=V=>{let Ea="";1===V&&this.V0&&(Ea=this.V0);this.fK(V,this.Kji,Ea)};this.sSn=V=>{this.V0=V;V=this.validate();this.oCh!==V&&(this.oCh=V,this.QZa(Object(Fa.a)("SensitivityJustificationTitle"),this.Hsm,this.b4l(this.oCh)))};this.Kji=ja;this.fK=qb;this.rj=Bl.id;this.vg(1,Object(Fa.a)("DialogChange"));this.xY(1,!1);this.scb(0)}Cjl(){this.qp(Object(Fa.a)("SensitivityJustificationTitle"),this.Hsm,this.b4l(this.oCh))}b4l(ja){return{["id"]:this.rj,
["bodyControls"]:{["choiceGroupProps"]:{},["textAreaProps"]:{["placeholder"]:Object(Fa.a)("SensitivityJustificationPlaceholder")}},["actionButtonProps"]:{["label"]:Object(Fa.a)("DialogChange"),["disabled"]:!ja},["infoMessage"]:Object(Fa.a)("SensitivityJustificationMessage"),["justificationIrrelevantLabel"]:Object(Fa.a)("SensitivityJustificationNoLongerApplies"),["justificationIncorrectLabel"]:Object(Fa.a)("SensitivityJustificationIncorrect"),["justificationOtherLabel"]:Object(Fa.a)("SensitivityJustificationOther"),
["onJustificationUpdated"]:this.sSn}}static get eeb(){return n.AFrameworkApplication.Ha.Ib.rR&&n.AFrameworkApplication.Ha.Ib.njg}}Bl.id="JustificationDialog";Object(m.a)(Bl,"JustificationDialog",Ia.a,[]);class Yj extends Ia.a{constructor(ja,qb,V){super(!1,!1,!0);this.PHn=(Za,ia)=>{1===Za&&ia.selectedLabel&&(Za=ia.selectedLabel,""!==Za&&this.iNm(Za))};if(ja&&V){var Ea={["id"]:"MandatoryLabellingDialog"};this.iNm=V;this.Lei=qb;if(!n.AFrameworkApplication.ha.getBooleanAppSetting("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||
this.Lei&&""!==this.Lei)qb={["href"]:this.Lei,["target"]:"_blank"},Ea.learnMoreLink={["type"]:"AppLinkProps",["id"]:"mandatoryLabellingLearnMoreLink",["text"]:Object(Fa.a)("LearnMore"),["handler"]:qb,["customTooltip"]:Object(Fa.a)("LearnMoreTooltip")};qb={["sections"]:[],["shouldAutoOpen"]:!1};Array.add(qb.sections,{["id"]:"mandatoryLabellingFlyoutMenuSection",["controls"]:ja});Ea.labelFlyout={["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabellingFyout",["label"]:"Pick a label",["hideLabel"]:!1,
["hideChevron"]:!1,["hideIcon"]:!0,["menuDefinition"]:qb};ja={["id"]:"MandatoryLabellingDialog",["bodyControls"]:Ea};Ea.initialLabelText=Object(Fa.a)("MandatoryLabellingDialogInitialLabelText");Ea.descriptionText=Object(Fa.a)("MandatoryLabellingDialogDescriptionText");this.qp(Object(Fa.a)("MandatoryLabellingDialogBusinessBarTitle"),this.PHn,ja)}else r.ULS.sendTraceTag(560547850,306,10,"MandatoryLabelingDialog was triggered with invalid inputs")}}Object(m.a)(Yj,"MandatoryLabellingDialog",Ia.a,[]);
class jk{constructor(){this.Tkb=!!n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.Ib.rR}N4m(ja,qb,V){this.Tkb&&new Yj(ja,qb,V)}static get instance(){return jk.Qa||(jk.Qa=new jk)}}jk.Qa=null;Object(m.a)(jk,"MandatoryLabellingDialogFactory",null,[621]);class vf{}vf.Tgo="sbProtectForm14";vf.Vgo="SBStatusBarMarkAsReadOnly14";vf.GAn="Info_16x16x32";vf.bUl="QuickSearchCompletedToday_16x16x32";vf.RRk="CommonControlCheckboxCheck_16";vf.ECm="On";vf.visible="Visible";vf.acn="ImageIsVisible";vf.wx="SourceControlId";
vf.menuItemId="MenuItemId";vf.menu="Menu";vf.zRl="AppLockId";vf.value="Value";vf.labelText="LabelText";vf.alt="Alt";vf.a8l="Image16by16";vf.RIb="Image16by16Class";vf.Sgo="SBProtectForm_16";vf.Ugo="SBStatusBarMarkAsReadOnly_16";vf.icon="Icon";vf.iconColor="IconColor";vf.customTooltip="CustomTooltip";vf.t3n="MipTagDynamicFillWithOutline_20";vf.u3n="MipTagLockDynamicFillWithOutline_20";vf.s3n="MipTagErrorOutline_20";vf.v3n="MipTagQuestionOutline_20";vf.G1h="transparent";vf.Rko="UILocation";Object(m.a)(vf,
"PolicyConstants",null,[]);class hi extends Ia.a{constructor(ja,qb,V){super(!1,!1,hi.eeb);this.Pno=Ea=>{1!==Ea&&this.fK(Ea,this.Kji,"",this.V0)};this.Kji=ja;this.V0=qb;this.fK=V;this.Ue=1;this.rj=hi.id;this.scb(1);this.scb(0)}Okl(){const ja={["id"]:"UserDefinedPermissionsDialog"};hi.eeb&&this.qp("Defined Permissions",this.Pno,ja)}static get eeb(){return n.AFrameworkApplication.Ha.Ib.rR&&n.AFrameworkApplication.Ha.Ib.njg}}hi.id="UserDefinedPermissionsDialog";Object(m.a)(hi,"UserDefinedPermissionsDialog",
Ia.a,[]);var Ml=a(804),bl=a(142);const lh=ja=>{var qb;return ja?ja.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnablePolicyPackageRefactoring",!1):null===(qb=n.AFrameworkApplication.ha)||void 0===qb?void 0:qb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnablePolicyPackageRefactoring",!1)};class oi{constructor(ja,qb,V,Ea){this.llf=this.Stc=null;this.Hdi=this.Zdi=this.Fkf=this.rLl=this.ULl=this.Z9h=!1;this.ORe=this.nrc=this.yjc=this.kgd=this.V0=this.yeb=this.chd=this.mPb=null;this.YMm=
this.F7h=0;this.uai=this.nLl=this.OIl=this.Fhi=null;this.r4n=()=>{this.Hdi&&!this.vOh()&&(this.Hdi=!1,this.sv.value.q4n())};this.OHn=Za=>{this.M4i(this.WLl[Za])};this.tMk=()=>{if(!this.sv.value.O$l()){var Za=this.Efa[this.ow.AppliedPolicyId];this.Fkf&&this.kgd&&this.ORe!==this.kgd.id&&(!Za||Za.Order<this.kgd.sensitivityLabel.Order)&&(Za=this.Isd(this.kgd.id,{},4),32!==Za?r.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+Za):(this.ORe=
this.kgd.id,this.nrc&&(Za=this.Efa[this.nrc])&&Za.Order<=this.kgd.sensitivityLabel.Order&&(this.sv.value.eoc(29),this.nrc=null)));Za=this.Efa[this.ow.AppliedPolicyId];if(this.yjc&&this.nrc!==this.yjc.id&&(!Za||Za.Order<this.yjc.sensitivityLabel.Order)){const ia=this.yjc.id;this.sv.value.eoc(29);Za=lh(this.Ga)?this.sv.value.slc(this.yjc.sensitivityLabel):this.slc(this.yjc.sensitivityLabel);this.sv.value.Jvf(29,Object(Fa.a)("PolicyBusinessBarTitle"),String.format(Object(Fa.a)("PolicyLabelRecommendationMessage"),
Za)+" "+this.yjc.U3n,Object(Fa.a)("PolicyLabelRecommendationButton"),()=>{this.Isd(ia,{},8)});this.nrc=this.yjc.id}this.yjc=this.kgd=null}};this.N2m=(Za,ia,Va,Ab)=>{1===Za&&this.G$c(ia,Ab)};this.M2m=(Za,ia,Va)=>{1===Za?this.lPh()?(this.V0=Va,this.Isd(ia,null,2)):this.G$c(ia===this.ow.AppliedPolicyId?"":ia,Va):this.yo.fg()};this.vYm=Za=>{1===Za&&this.sv.value.g3n()};this.kJh=()=>32;this.OUn=(Za,ia)=>{ia.px&&this.Efa&&(Za=this.Efa[this.ow.AppliedPolicyId])&&(this.nrc&&(ia=this.Efa[this.nrc])&&ia.Order<=
Za.Order&&(this.sv.value.eoc(29),this.nrc=null),this.ORe&&this.ORe!==Za.Id&&(this.sv.value.eoc(28),this.ORe=null))};this.Aa=ja;this.yo=qb;this.Ga=V;this.sv=Ea;this.Xmf={};this.TMl={};this.WLl={};this.jOh=V.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled");this.sv.value.kui(this.tMk);this.sv.value.AQl(this.tMk);this.sv.value.Njc(this.OUn);n.AFrameworkApplication.Ha&&n.AFrameworkApplication.Ha.zO(this.r4n);V.getBooleanAppSetting("SupportsPolicies")&&V.Ma("AppliedPolicyId")&&(this.Stc=V.Ma("IrmPolicyTitle"),
this.llf=V.Ma("IrmPolicyDescription"));this.rMm=this.Ga.Ac("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.sMm=this.Ga.Ac("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3)}get HIa(){return n.AFrameworkApplication.HIa||!!this.nLl&&this.nLl()}Kb(){this.Aa.Ba(Xa.a.R1g,Qa.a.frame,this.kJh);this.Aa.ua(Xa.a.yrd,Qa.a.frame,Object(da.a)(this,this.yrd,"queryPolicyLabel"),96);this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&(this.Aa.Ba(Xa.a.MBk,Qa.a.frame,
this.kJh),this.Aa.ua(Xa.a.$3e,Qa.a.frame,Object(da.a)(this,this.$3e,"queryPolicyShortLabel"),96));this.Aa.Ba(Xa.a.Ftd,Qa.a.frame,Object(da.a)(this,this.Ftd,"toggleSensitivity"));this.Aa.Ba(Xa.a.Uqd,Qa.a.frame,Object(da.a)(this,this.Uqd,"populateSensitivityFlyout"));this.Aa.Ba(Xa.a.Ioc,Qa.a.frame,Object(da.a)(this,this.Ioc,"setSensitivity"));this.Aa.ua(Xa.a.d4e,Qa.a.frame,Object(da.a)(this,this.d4e,"querySensitivity"),96);this.Aa.Ba(Xa.a.Qnc,Qa.a.frame,Object(da.a)(this,this.Qnc,"querySensitivityToggleButton"));
this.Aa.Ba(Xa.a.j6c,Qa.a.frame,Object(da.a)(this,this.j6c,"querySensitivitySubFlyout"));this.jvf(Xa.a.Ftd)||this.Aa.we(Xa.a.Ftd,4);this.jvf(Xa.a.Uqd)||this.Aa.we(Xa.a.Uqd,4);this.jvf(Xa.a.Ioc)||this.Aa.we(Xa.a.Ioc,4);this.jvf(Xa.a.Qnc)||this.Aa.we(Xa.a.Qnc,4);this.jvf(Xa.a.j6c)||this.Aa.we(Xa.a.j6c,4);this.yo.fg();n.AFrameworkApplication.ha&&ta.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")&&this.sv.value.q6n(Object(da.a)(this,
this.etm,"registerActionsHandler"))}etm(){this.Kb()}KDm(){this.Aa.wY(Xa.a.R1g,Qa.a.frame,this.kJh);this.Aa.wY(Xa.a.yrd,Qa.a.frame,Object(da.a)(this,this.yrd,"queryPolicyLabel"));this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpQueryShortLabelEnabled",!1)&&(this.Aa.wY(Xa.a.MBk,Qa.a.frame,this.kJh),this.Aa.wY(Xa.a.$3e,Qa.a.frame,Object(da.a)(this,this.$3e,"queryPolicyShortLabel")));this.Aa.wY(Xa.a.Ftd,Qa.a.frame,Object(da.a)(this,this.Ftd,"toggleSensitivity"));this.Aa.wY(Xa.a.Uqd,Qa.a.frame,
Object(da.a)(this,this.Uqd,"populateSensitivityFlyout"));this.Aa.wY(Xa.a.Ioc,Qa.a.frame,Object(da.a)(this,this.Ioc,"setSensitivity"));this.Aa.wY(Xa.a.d4e,Qa.a.frame,Object(da.a)(this,this.d4e,"querySensitivity"));this.Aa.wY(Xa.a.Qnc,Qa.a.frame,Object(da.a)(this,this.Qnc,"querySensitivityToggleButton"));this.Aa.wY(Xa.a.j6c,Qa.a.frame,Object(da.a)(this,this.j6c,"querySensitivitySubFlyout"))}Ftd(){return 32}R1l(ja){const qb="mandatoryLabelling_"+ja.Id;this.WLl[qb]=ja.Id;return{["type"]:"AppToggleButtonProps",
["id"]:qb,["label"]:ja.DisplayName,["hideLabel"]:!1,["customTooltip"]:ja.Tooltip}}lPh(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPEnabled",!1)}VTj(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)}get ow(){if(lh(this.Ga))return this.sv.value.OE;this.mPb||(this.mPb=this.sv.value.OE);return this.mPb}get Efa(){return lh(this.Ga)?this.sv.value.i0a:this.yeb}get zwe(){return lh(this.Ga)?this.sv.value.Sof:this.chd}Gin(){const ja=
[];for(const V in this.zwe){var qb=this.zwe[V];const Ea=this.Efa[V];if(Ea&&Ea.Enabled&&!Ea.HasUserDefinedPermissions)if(qb.count){const Za={["sections"]:[],["shouldAutoOpen"]:!1},ia={["id"]:"mandatoryLabelling_flyoutMenuSection_"+Ea.Id,["controls"]:[]};for(const Va of qb)(qb=this.Efa[Va])&&qb.Enabled&&!qb.HasUserDefinedPermissions&&Array.add(ia.controls,this.R1l(qb));Array.add(Za.sections,ia);Array.add(ja,{["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabelling_"+Ea.Id,["label"]:Ea.DisplayName,
["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!1,["menuDefinition"]:Za})}else Array.add(ja,this.R1l(Ea))}return ja}Uqd(ja,qb,V,Ea,Za){if(1===V||!this.sv.value.cfb(!0))return 32;Za.MenuItems=Object.assign(new Dc.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(Za.MenuItems.MenuSectionList,this.oIh(!this.isReactRibbonEnabled()));this.ow.CustomUrl&&Array.add(Za.MenuItems.MenuSectionList,this.H4m(this.isReactRibbonEnabled()?this.ow.CustomUrl:za.a.We(this.ow.CustomUrl)));
this.isReactRibbonEnabled()||(Za.PopulationXML=vk.l(Za.MenuItems));return 32}d4e(ja,qb,V,Ea,Za){if(1===V||!Za||!this.jOh)return 32;lh(this.Ga)||(this.mPb=this.sv.value.OE);if(this.sv.value.cfb(!0)&&(Za[vf.visible]=!0,this.rLl||(Eb.a("MipLabelsAvailable"),this.rLl=!0),this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",!1)&&this.ow.AreLabelsAvailable&&(ja=Object(l.a)()))){let ia;ia=lh(this.Ga)?this.ow.AppliedPolicyId?"LouderLabel_LabelExistsOnLoadActivity":"LouderLabel_NoLabelAppliedOnLoadActivity":
oi.wb(this.ow.AppliedPolicyId)?"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";ja.execute(Va=>{Va.logActivity(ia,null)})}return 32}Qnc(ja,qb,V,Ea,Za){if(1===V||!Za)return 32;let ia,Va;Za[vf.ECm]=!!(ia=Za[vf.menuItemId])&&!!(Va=this.Xmf[ia])&&Va===this.ow.AppliedPolicyId;return 32}j6c(ja,qb,V,Ea,Za){if(1===V||!Za)return 32;let ia,Va,Ab;ja=!!(ia=Za[vf.wx])&&!!(Va=this.Xmf[ia])&&!!(Ab=this.zwe[Va])&&Ab.contains(this.ow.AppliedPolicyId);Za[vf.acn]=ja;Za[vf.ECm]=ja;return 32}Ioc(ja,
qb,V,Ea,Za){if(1===V||!Za)return 32;ja=this.Xmf[Za[vf.wx]];qb=this.Sko(Za[vf.Rko]);V=new gf.a;V.name="SensitivityPickerLocation";V.int64=qb;Eb.a("SensitivityPickerUsage",void 0,void 0,[V]);return this.Isd(ja,Za,2)}vOh(){return!!n.AFrameworkApplication.Ha&&1===n.AFrameworkApplication.Ha.mode}Tjo(){this.ow.DefaultLabelId&&this.ow.MandatoryLabelingEnforced?this.Z9h||this.vOh()?this.ow.AppliedPolicyId?this.M4i(""):(this.sv.value.jyn(this.sv.value.smg)||this.vOh())&&this.SZl():this.Zxm():this.ow.DefaultLabelId?
this.Zxm():this.ow.MandatoryLabelingEnforced&&(this.ow.AppliedPolicyId?this.M4i(""):this.SZl())}a$l(){return this.ow.MandatoryLabelingEnforced?this.ow&&this.ow.AreLabelsAvailable?this.Ga.getBooleanAppSetting("TestOverrideIsReactDialogEnabled")||this.yo&&this.yo.Ib&&this.yo.Ib.rR?!0:(r.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),!1):(r.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),!1):(r.ULS.sendTraceTag(539109063,
306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)}SZl(){!this.a$l()||n.AFrameworkApplication.tna||this.ULl||(this.ULl=n.AFrameworkApplication.tna=!0,r.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),this.sv.value.nsm("",1),this.sv.value.Eqi(37,Object(Fa.a)("MandatoryLabellingDialogBusinessBarTitle"),Object(Fa.a)("MandatoryLabellingDialogDescriptionText"),Object(Fa.a)("MandatoryLabellingDialogBusinessBarButton"),()=>{this.NHn()}))}M4i(ja){this.a$l()&&
n.AFrameworkApplication.tna&&(n.AFrameworkApplication.tna=!1,r.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),this.sv.value.JXk(),this.sv.value.nsm(ja,2))}NHn(){jk.instance.N4m(this.Gin(),this.ow.CustomUrl,this.OHn)}fSl(){return this.Ga.getBooleanAppSetting("CoAuthForProtectedFilesEnabled")&&this.Ga.getBooleanAppSetting("SupportsOfficeClientCoauthoring")&&this.Ga.getBooleanAppSetting("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.uai&&this.HIa}Isd(ja,qb,
V){this.sv.value.b3n(V);let Ea=32,Za=!1,ia=!0;const Va=this.Efa[ja],Ab=2===V||8===V||16===V,gc=ja===this.ow.AppliedPolicyId;if(this.OIl&&this.OIl(ja,Ab))r.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",V),this.yo.fg();else if(qb&&vf.zRl in qb&&this.sv.value.Fal(qb[vf.zRl]),ja)if(this.sv.value.O$l()||this.fSl()&&this.Zdi)r.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",
V),this.yo.fg(),Ab&&this.jGh(Object(Fa.a)("SensitivityApplicationDialogErrorTitle"),Object(Fa.a)("SensitivityQuickApplicationErrorMessage"));else if(this.Ga.getBooleanAppSetting("HasDocumentEditRights"))if(this.sv.value.N_m(ja))if(!this.lPh()&&(lh(this.Ga)?null===Va||void 0===Va?0:Va.HasUserDefinedPermissions:this.yeb[ja]&&this.yeb[ja].HasUserDefinedPermissions)&&!gc)r.ULS.sendTraceTag(540608323,306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",V),1!==V&&4!==V&&this.vWm();
else if(Ab&&this.ow.MandatoryLabelingEnforced&&gc)r.ULS.sendTraceTag(570972054,306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",V),this.jGh(Object(Fa.a)("MandatoryLabellingBlockLabelRemovalDialogTitle"),Object(Fa.a)("MandatoryLabellingBlockLabelRemovalDialogDescriptionText"));else{if(Ab&&this.Ga.getBooleanAppSetting("WacLabelingJustificationDialogIsEnabled")&&this.ow.RequiredDowngradeJustification&&(gc||(lh(this.Ga)?null===Va||void 0===Va?0:Va.RequiredDowngradeJustification:
this.yeb[ja].RequiredDowngradeJustification))&&!this.V0)return r.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",V),this.Cjl(ja),Ea;if(this.lPh()&&(lh(this.Ga)?null===Va||void 0===Va?0:Va.HasUserDefinedPermissions:this.yeb[ja].HasUserDefinedPermissions)&&!gc)return r.ULS.sendTraceTag(523019968,306,50,"UDP Label is selected. ApplyLabelFlag: {0}",V),this.Okl(ja,this.V0),Ea;if(this.fSl()&&!this.uai())this.F7h<this.rMm?(r.ULS.sendTraceTag(577356770,306,50,
"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.F7h,V),this.Zdi=!0,this.F7h++,bb.Task.delay(this.sMm).continueWith(()=>{this.Zdi=!1;this.Isd(ja,qb,V)})):(r.ULS.sendTraceTag(577356771,306,15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",V),Za=1!==V,ia=!1,Ea=8);else{if(this.Xxn(ja)&&(r.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",
V),1===V||8===V||4===V))return Ea;r.ULS.sendTraceTag(570972056,306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",V);this.G$c(gc?"":ja,this.V0,V);return Ea}}else r.ULS.sendTraceTag(42796169,306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",V),this.yo.fg(),Ab&&this.jGh(Object(Fa.a)("SensitivityApplicationDialogErrorTitle"),Object(Fa.a)("SensitivityCoauthApplicationErrorMessage"));else r.ULS.sendTraceTag(558892739,306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",
V),this.yo.fg(),Ab&&this.jGh(Object(Fa.a)("SensitivityApplicationDialogErrorTitle"),Object(Fa.a)("SensitivityNoEditRightsErrorMessage"));else r.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",V),this.yo.fg(),Za=Ab,ia=!1,Ea=8;this.sv.value.zsm(0,V,Za,ia);return Ea}GRl(ja,qb,V=null,Ea=!1){Qb.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",wa.b.FailureBased,"wordclpfc",null);this.Ga.getBooleanAppSetting("SupportsOfficeClientCoauthoring")&&
this.Ga.getBooleanAppSetting("CoAuthForProtectedFilesIsEnabled")?(this.Fkf=!1,lh(this.Ga)||(this.mPb=this.sv.value.OE),this.ow&&!this.ow.AppliedPolicyId?this.Fkf=!0:this.ow&&this.ow.PolicyLabelAssignmentMethod&&(this.Fkf=bl.e(this.ow.PolicyLabelAssignmentMethod)===bl.e("standard"))):this.Fkf=Ea;lh(this.Ga)?(ja=ja?this.Efa[ja]:null,qb=qb?this.Efa[qb]:null):(ja=oi.wb(ja)?null:this.yeb[ja],qb=oi.wb(qb)?null:this.yeb[qb]);qb?this.yjc=new Al(qb,!0,V):(this.sv.value.eoc(29),this.nrc=null);ja?this.kgd=new Al(ja,
!1):this.ORe=null;this.tMk(null,null)}lXm(ja){this.Isd(ja,null,16)}Pao(){this.yeb={};lh(this.Ga)||(this.mPb=this.sv.value.OE);if(this.ow)for(const ja of this.ow.SensitivityLabels)this.yeb[ja.Id]=ja}Xxn(ja){if(!lh(this.Ga)&&!this.chd)return!1;if(ja in this.zwe){ja=this.zwe[ja];for(const qb of ja)if((ja=this.Efa[qb])&&ja.Enabled)return!0}return!1}kbo(){this.chd={};lh(this.Ga)||(this.mPb=this.sv.value.OE);if(this.ow){for(const ja of this.ow.SensitivityLabels)ja.ParentId||(this.chd[ja.Id]=new K.a);for(const ja of this.ow.SensitivityLabels)this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSensitivityLabelingInOfficeJS",
!1)?ja.ParentId&&ja.ParentId in this.chd&&(this.yeb[ja.ParentId]&&(ja.ParentName=this.yeb[ja.ParentId].DisplayName),ja.Enabled&&this.chd[ja.ParentId].add(ja.Id)):ja.ParentId&&ja.ParentId in this.chd&&ja.Enabled&&this.chd[ja.ParentId].add(ja.Id)}}r2n(){lh(this.Ga)||(this.mPb=this.sv.value.OE);const ja=this.jOh&&this.isReactRibbonEnabled()&&this.sv.value.cfb();oi.DYh(ja)}Q4n(ja){this.uai=ja}Zxm(){if(this.Ga.getBooleanAppSetting("WacApplyDefaultPolicyLabelIsEnabled"))if(this.vOh())this.Hdi=!0;else if(!this.Z9h&&
(this.Z9h=!0,lh(this.Ga)||(this.mPb=this.sv.value.OE),this.ow&&this.ow.DefaultLabelId))if(!this.ow.AppliedPolicyId)r.ULS.sendTraceTag(509732190,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.ow.DefaultLabelType),this.Isd(this.ow.DefaultLabelId,null,1);else if(Qc.a.Co().equals(this.ow.DefaultLabelType,"documentLibraryDefault")){const ja=this.Efa[this.ow.AppliedPolicyId],qb=this.Efa[this.ow.DefaultLabelId];this.ow.AppliedPolicyId!==this.ow.DefaultLabelId&&Qc.a.Co().equals(this.ow.PolicyLabelAssignmentMethod,
"standard")&&ja.Order<qb.Order&&(r.ULS.sendTraceTag(509732189,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.ow.DefaultLabelType),this.Isd(this.ow.DefaultLabelId,null,1))}}G$c(ja,qb,V=2){this.lPh()||(this.V0=qb);this.sv.value.G$c(ja);this.yo.fg();qb=this.Efa[ja];qb=lh(this.Ga)?this.sv.value.slc(qb):this.slc(qb);V=new xg(V,qb);this.sv.value.L5e(ja,this.V0,V)}Cjl(ja){(new Bl(ja,this.M2m)).Cjl()}Okl(ja,qb){(new hi(ja,qb,this.N2m)).Okl()}jGh(ja="",qb=""){const V=new J.a;V.Vw=n.AFrameworkApplication.zra;
V.Ue=0;V.vg(1,Object(Fa.a)("DialogClose"));V.h6(ja,qb,null)}vWm(){const ja=new J.a;ja.Vw=n.AFrameworkApplication.zra;ja.Ue=1;ja.vg(1,Object(Fa.a)("OICDownLoadACopyDialogOpenButton"));ja.vg(0,Object(Fa.a)("DialogClose"));ja.h6(Object(Fa.a)("SensitivityApplicationDialogErrorTitle"),Object(Fa.a)("SensitivityBlockUDPSetLabelMessage"),this.vYm)}isReactRibbonEnabled(){return!!this.yo&&!!this.yo.Ib&&this.yo.Ib.az}sPc(){return this.yo&&this.yo.Ib?this.yo.Ib.sPc:!1}sbo(ja,qb,V,Ea){ja?(Ea[vf.value]=ja,Ea[vf.labelText]=
ja,Ea[vf.customTooltip]=qb,this.pym(V,n.AFrameworkApplication.Mz,Ea)):(Ea[vf.iconColor]=vf.G1h,this.ow.MandatoryLabelingEnforced?(Ea[vf.value]=Ea[vf.labelText]=this.YLh().A6k,Ea[vf.icon]=vf.s3n):(Ea[vf.value]=Ea[vf.labelText]=this.YLh().uuk,Ea[vf.icon]=vf.v3n));Ea[vf.visible]=!0}Wao(ja){let qb="",V="",Ea="";if(this.ow.AreLabelsAvailable){let Za=null;this.Efa&&(Za=this.Efa[this.ow.AppliedPolicyId]);Za&&(qb=lh(this.Ga)?this.sv.value.slc(Za):this.slc(Za),V=Za.Tooltip,this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpdateIRMWhenLabelChangedEnabled",
!1)||(n.AFrameworkApplication.Mz=this.sv.value.iJb(Za)),Ea=this.Yej(Za));if(!this.sv.value.cfb()&&!Za)return}else{if(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TitleBarSensitivityBufferEnabled",!1))qb=this.Stc?this.Stc:"";else{if(!this.Stc)return;qb=this.Stc}Ea=vf.G1h;V=this.llf?this.llf:""}this.sbo(qb,V,Ea,ja)}yrd(ja,qb,V,Ea,Za){if(1===V)return 32;lh(this.Ga)||(this.mPb=this.sv.value.OE);if(!this.ow||!Za)return 32;Za[vf.value]="";Za[vf.labelText]="";Za[vf.alt]=null;Za[vf.a8l]=null;
Za[vf.RIb]=null;Za[vf.customTooltip]="";Za[vf.visible]=!1;Za[vf.iconColor]="";Za[vf.icon]="";if(this.VTj())this.Wao(Za);else{V=qb=ja="";if(!this.ow.AreLabelsAvailable){if(!this.Stc)return 32;ja=this.Stc;V=vf.G1h;this.llf&&(qb=this.llf)}else if(this.ow.AppliedPolicyId){Ea=null;for(const ia of this.ow.SensitivityLabels)if(ia.Id.toLowerCase()===this.ow.AppliedPolicyId.toLowerCase()){Ea=ia;break}Ea&&(ja=lh(this.Ga)?this.sv.value.slc(Ea):this.slc(Ea),qb=Ea.Tooltip,this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpdateIRMWhenLabelChangedEnabled",
!1)||(n.AFrameworkApplication.Mz=this.sv.value.iJb(Ea)),V=this.Yej(Ea))}ja&&(Za[vf.value]=ja,Za[vf.labelText]=ja,this.sPc()?Za[vf.customTooltip]=qb:Za[vf.alt]=qb,this.pym(V,n.AFrameworkApplication.Mz,Za),Za[vf.visible]=!0)}return 32}$3e(ja,qb,V,Ea,Za){if(1===V)return 32;lh(this.Ga)||(this.mPb=this.sv.value.OE);if(!this.ow||!Za)return 32;Za[vf.labelText]="";if(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpUseHideBarByDefaultSetting",!1)&&this.ow.HideBarByDefault)return 32;ja="";if(this.ow.AreLabelsAvailable)if(this.ow.AppliedPolicyId){if(!this.Efa)return 32;
(qb=this.Efa[this.ow.AppliedPolicyId])&&(ja=qb.ParentId&&this.Efa[qb.ParentId]?lh(this.Ga)?qb.ParentName:this.Efa[qb.ParentId].DisplayName:qb.DisplayName)}else ja=this.ow.MandatoryLabelingEnforced?this.YLh().A6k:this.YLh().uuk;else{if(!this.Stc)return 32;ja=this.Stc}Za[vf.labelText]=ja;return 32}slc(ja){return ja?this.yeb?ja.ParentId&&this.yeb[ja.ParentId]?this.yeb[ja.ParentId].DisplayName+"\\"+ja.DisplayName:ja.DisplayName:(r.ULS.sendTraceTag(4282E4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),
ja.DisplayName):""}pym(ja,qb,V){this.VTj()?(V[vf.icon]=this.R4l(qb),V[vf.iconColor]=this.S4l(ja)):this.sPc()?V[vf.icon]=qb?vf.Sgo:vf.Ugo:(V[vf.a8l]=n.AFrameworkApplication.Ln,V[vf.RIb]=qb?ej.d(vf.Tgo):ej.d(vf.Vgo))}H4m(ja){const qb=this.Ku("LearnMoreSection",!0);ja=Object.assign(new lk.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:ja,LabelText:Object(Fa.a)("LearnMore"),Command:lh(this.Ga)?Xa.a.lFa.toString():"1959943459",Image16by16:n.AFrameworkApplication.Ln,Image16by16Class:ej.d(vf.GAn),
Visible:!0,Alt:Object(Fa.a)("LearnMoreTooltip"),KeyTip:"L"});Array.add(qb.ControlList,ja);return qb}fXl(ja,qb,V=!1){let Ea;Ea="Toggle_"+ja.Id;Ea="Sensitivity_"+Ea;const Za=ja.DisplayName,ia=ja.Tooltip;var Va=ja.Id===this.ow.AppliedPolicyId,Ab=V?za.a.We(Ea):Ea;this.VTj()?(Va=this.Yej(ja),qb=Object.assign(new hf.a,{Id:Ab,ExternalId:Ab,LabelText:V?za.a.We(Za):Za,Command:lh(this.Ga)?Xa.a.Ioc.toString():"2935633379",MenuItemId:Ab,QueryCommand:lh(this.Ga)?Xa.a.Qnc.toString():"991261903",Visible:!0,Alt:V?
za.a.We(ia):ia,AriaLabel:tb.a.BLd,IconColor:this.S4l(Va),KeyTip:qb}),qb.ExternalImageId=this.R4l(this.sv.value.iJb(ja))):(Ab=Object.assign(new Ml.a,{Id:Ab,ExternalId:Ab,LabelText:V?za.a.We(Za):Za,Command:lh(this.Ga)?Xa.a.Ioc.toString():"2935633379",MenuItemId:Ab,QueryCommand:lh(this.Ga)?Xa.a.Qnc.toString():"991261903",CheckedImage:n.AFrameworkApplication.Ln,Visible:!0,Alt:V?za.a.We(ia):ia,IsChecked:Va,AriaLabel:tb.a.BLd,KeyTip:qb}),this.isReactRibbonEnabled()?(Ab.CheckedImageClass=ej.d(vf.RRk),Ab.ExternalImageId=
vf.RRk):Ab.CheckedImageClass=ej.d(vf.bUl),qb=Ab);Ab=Ea;this.Xmf[Ab]=ja.Id;this.TMl[ja.Id]=Ab;return qb}Ku(ja,qb=!1){return Object.assign(new Ve.a,{Title:"",Id:ja,DisplayMode:vf.menu,ShowMenuSectionSeparator:qb,ControlsId:"Ctrl_"+ja,ControlList:[]})}Z5m(ja,qb,V){ja=this.Ku(ja+"Sub");let Ea=1;for(const Za of qb)(qb=this.Efa[Za])&&qb.Enabled&&(Array.add(ja.ControlList,this.fXl(qb,Ea.toString(),V)),Ea++);return ja}oIh(ja=!1){const qb=this.Ku("SensitivitySection");let V=1;for(const Ea in this.zwe){const Za=
this.zwe[Ea],ia=this.Efa[Ea];if(ia&&ia.Enabled){if(Za.count){const Va="Label"+this.YMm++,Ab=Object.assign(new Dh.a,{Id:Va,ExternalId:Va,LabelText:ja?za.a.We(ia.DisplayName):ia.DisplayName,Command:lh(this.Ga)?Xa.a.dU.toString():"798637440",QueryCommand:lh(this.Ga)?Xa.a.j6c.toString():"2875864574",Menu:Object.assign(new Dc.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:tb.a.BLd,KeyTip:V.toString(),Alt:ja?za.a.We(ia.Tooltip):
ia.Tooltip});this.isReactRibbonEnabled()?Ab.ExternalImageId=vf.RRk:(Ab.Image16by16=n.AFrameworkApplication.Ln,Ab.Image16by16Class=ej.d(vf.bUl));Array.add(Ab.Menu.MenuSectionList,this.Z5m(Va,Za,ja));Array.add(qb.ControlList,Ab);this.Xmf[Ab.Id]=ia.Id;this.TMl[ia.Id]=Ab.Id}else Array.add(qb.ControlList,this.fXl(ia,V.toString(),ja));V++}}return qb}jvf(ja){return!!this.Aa.IV(ja)&&!!this.Aa.IV(ja).flags&&!!this.Aa.IV(ja).flags.length}R4l(ja){return ja?vf.u3n:vf.t3n}S4l(ja){return ja?ja:vf.G1h}Yej(ja){if(ja.Color||
!ja.ParentId)return ja.Color;const qb=this.Efa[ja.ParentId];return qb?qb.Color:ja.Color}Sko(ja){switch(ja){case 2:case 14:case 15:return 1;case 21:return 2;default:return 0}}YLh(){this.Fhi||(this.Fhi=Object.assign(new Sg,{uuk:HeaderStrings.NoSensitivityLabel,A6k:HeaderStrings.SelectASensitivityLabel}));return this.Fhi}static Imo(){n.AFrameworkApplication.ha&&!n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)||!ta.c()||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("OpenDocumentLabelPane",
!0))}static DYh(ja){ta.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!ja))}static wb(ja){return ja&&ja.length?!1:!0}}Object(m.a)(oi,"PolicyActor",null,[607]);var Mk=a(35),nk=a(1423),Nk;(function(ja){ja[ja.unknown=0]="unknown";ja[ja.boot=1]="boot";ja[ja.refresh=2]="refresh";ja[ja.Qyo=3]="selfSetPolicyLabel"})(Nk||(Nk={}));Object(m.b)("GetPolicyLabelsReason",Nk);class rj extends Sys.EventArgs{constructor(ja,qb,V,Ea,Za,ia){super();this.tUe=ja;this.title=qb;this.message=
V;this.buttonText=Ea;this.DDf=Za;this.UOh=ia}}Object(m.a)(rj,"AddAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class vl extends Sys.EventArgs{constructor(ja,qb,V,Ea,Za){super();this.tUe=ja;this.title=qb;this.message=V;this.buttonText=Ea;this.DDf=Za}}Object(m.a)(vl,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var Vi;(function(ja){ja[ja.none=0]="none";ja[ja.vyo=1]="reasonDefaultLabel";ja[ja.xyo=2]="reasonManual";ja[ja.uyo=4]="reasonAutomatic";ja[ja.yyo=8]="reasonRecommended";
ja[ja.wyo=16]="reasonMandatory";ja[ja.tyo=32]="reasonAI"})(Vi||(Vi={}));Object(m.b)("ApplyLabelFlags",Vi);class hl extends Sys.EventArgs{constructor(ja,qb,V){super();this.KUl=ja;this.JUl=qb;this.existingLabelPriority=V}}Object(m.a)(hl,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);class il extends Sys.EventArgs{constructor(){super()}}Object(m.a)(il,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);class zk extends Sys.EventArgs{constructor(){super()}}Object(m.a)(zk,"GetPolicyLabelFailureEventArgs",Sys.EventArgs,
[]);var yk=a(1216),ij=a(824);class Nl extends Sys.EventArgs{constructor(ja=!1,qb=null,V=null,Ea=null){super();this.px=ja;this.Yzf=qb;this.context=V;this.Gym=Ea}}Object(m.a)(Nl,"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);class Tk extends Sys.EventArgs{constructor(ja,qb){super();this.Rim=ja;this.oGh=qb}}Object(m.a)(Tk,"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);class Ok extends Sys.EventArgs{constructor(ja,qb,V,Ea){super();this.title=ja;this.UXn=qb;this.buttonText=V;this.vQn=Ea}}Object(m.a)(Ok,
"PolicyTipEventArgs",Sys.EventArgs,[]);class Tj extends Sys.EventArgs{constructor(ja,qb){super();this.tUe=ja;this.UOh=qb}}Object(m.a)(Tj,"RemoveAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class Nj extends Sys.EventArgs{constructor(){super()}}Object(m.a)(Nj,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);class wl extends Sys.EventArgs{constructor(ja,qb){super();this.Tpm=ja;this.hnb=qb}}Object(m.a)(wl,"SetPolicyLabelEventArgs",Sys.EventArgs,[]);class Hi extends Sys.EventArgs{constructor(ja,
qb,V,Ea=null,Za=null,ia=null,Va=null){super();this.errorType=ja;this.Neo=V;this.title=Ea;this.message=Za;this.buttonText=ia;this.DDf=Va}}Object(m.a)(Hi,"SetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class Ak extends Sys.EventArgs{constructor(){super()}}Object(m.a)(Ak,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);class Uk extends Sys.EventArgs{constructor(ja){super();this.hdo=ja}}Object(m.a)(Uk,"UDPLabelingAppHandlerEventArgs",Sys.EventArgs,[]);var Zj=a(822),ak=a(823);class jl{static zao(ja,
qb){if(!ja||!qb||ja.count!==qb.count)return!1;for(const V of ja)if(!qb.contains(V))return!1;return!0}static toArray(ja){if(!ja)return null;const qb=Array(ja.count);let V=0;for(const Ea of ja)qb[V]=Ea,V++;return qb}}Object(m.a)(jl,"HashSetUtils",null,[]);var vj=a(596),tk=a(336);class kl{constructor(ja,qb,V,Ea=0,Za=null){this.V9h=this.SJl=null;this.shd=this.ahf=this.ehf=0;this.MY="";this.hGd=this.qLl=this.u7h=this.Nci=this.ljc=this.Vei=null;this.ZKl=!1;this.wvd=null;this.Kbi=0;this.vEh=this.oGd=this.ezd=
this.uEh=null;this.nb=new Ah.a;this.Zjh=this.r4f=this.ALa=null;this.Eci=!1;this.i0a={};this.Sof={};this.smg=null;this.Pzi=ia=>{if(!this.G$l){var Va=ia.yQ.task;Va.continueWith(()=>{this.ALa=Va.result;this.ALa.Myc(this.wSn)})}};this.wSn=(ia,Va)=>{12===Va.type&&(this.qLl?this.qLl():this.klc(this.MY,2,this.ljc,!0))};this.Ga=ja;this.Dn=qb;this.zo=V;this.XDh=Ea;this.OE=new yk.a;this.vDm();this.SMl=this.Ga.Ma("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.g$=Za;this.jOh=ja.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled");
this.Ueg=ja.getBooleanAppSetting("CoAuthForProtectedFilesIsEnabled");this.xLe=ja.getBooleanAppSetting("SupportsOfficeClientCoauthoring");this.zyn=!1;this.qbo=3E4;this.Ce=ea.TaskManager.instance;ja.getBooleanAppSetting("SupportsPolicies")&&Eb.a("MipSupportsPolicies");this.Ueg&&this.xLe&&Eb.a("MipSupportsOfficeClientCoauthoring")}get m9l(){return this.Eci}AVm(ja){this.nb.addHandler("PolicyTipEvent",ja)}Njc(ja){this.nb.addHandler("LabelInfoUpdateEvent",ja)}q6n(ja){this.nb.removeHandler("LabelInfoUpdateEvent",
ja)}kui(ja){this.nb.addHandler("SetPolicyLabelEventKey",ja)}Hum(ja){this.nb.removeHandler("SetPolicyLabelEventKey",ja)}AQl(ja){this.nb.addHandler("SetPolicyLabelFailureEventKey",ja)}VUm(ja){this.nb.addHandler("GetAutoPolicyLabelEventKey",ja);this.m9l&&(r.ULS.sendTraceTag(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.MPk(new il(0)))}SUm(ja){this.nb.addHandler("CreateAutoCLPSecurityNodesEventKey",ja)}TVm(ja){this.nb.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",
ja)}UVm(ja){this.nb.addHandler("UpdateAutoCLPSITNodesEventKey",ja)}MUm(ja){this.nb.addHandler("AddAutoPolicyBusinessBarEntryEventKey",ja)}FVm(ja){this.nb.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",ja)}NUm(ja){this.nb.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",ja)}GVm(ja){this.nb.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",ja)}bVm(ja){this.nb.addHandler("MandatoryLabellingAppHandlerEventKey",ja)}SVm(ja){this.nb.addHandler("UDPLabelingAppHandlerEventKey",
ja)}Oao(){this.i0a={};for(const ja of this.OE.SensitivityLabels)this.i0a[ja.Id]=ja}jbo(){this.Sof={};for(const ja of this.OE.SensitivityLabels)ja.ParentId||(this.Sof[ja.Id]=new K.a);for(const ja of this.OE.SensitivityLabels)ja.ParentId&&ja.ParentId in this.Sof&&(this.i0a[ja.ParentId]&&(ja.ParentName=this.i0a[ja.ParentId].DisplayName),ja.Enabled&&this.Sof[ja.ParentId].add(ja.Id))}get bxn(){if(!this.SJl)return!1;for(const ja of this.SJl.FWe())if(!ja.Capabilities||!ja.Capabilities.SupportsClientIsMipTrusted)return!1;
return!0}get G$l(){return!!this.ALa}vun(ja){ja&&this.Ueg&&this.xLe&&ja.execute(this.Pzi)}b5n(ja){this.Nci=ja}r0m(){return this.Nci?this.Nci():!1}H4n(ja){this.u7h=ja}getCurrentTime(){return(new Date).getTime()}jJb(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSensitivityLabelingInOfficeJS",!1)}ehj(){this.zo&&(this.uEh=this.zo.Xl("WebServiceCall","Call Get Policy Endpoint On Server"));var ja=vj.a.yfb(1,1);this.Ga.getBooleanAppSetting("SendHostAttributionInfoForPolicyLabelEnabled")?
(ja=new ak.a(this.U6g("datalosspolicy"),1,null,null,!0,2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ja),this.Dn.send(ja).l7c(Object(da.a)(this,this.tlm,"onDataLossPolicySuccessCallback"),Object(da.a)(this,this.slm,"onDataLossPolicyFailureCallback"))):this.Dn.ik(this.U6g("datalosspolicy"),1,null,null,!0,2,Object(da.a)(this,this.tlm,"onDataLossPolicySuccessCallback"),Object(da.a)(this,this.slm,"onDataLossPolicyFailureCallback"),null);this.ehf++;r.ULS.sendTraceTag(25565151,
306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",this.SMl,this.ehf)}q4n(){this.klc(this.MY,2,this.ljc)}klc(ja,qb=0,V=null,Ea=!1,Za=null){Qb.Health.instance.recordKpiUsage("MipGetPolicyLabel",wa.b.FailureBased,"officewebclp",this.Yhj(void 0,qb));this.r4f=this.getCurrentTime();const ia=this.uSi(qb);this.rLh(ja,ia,V,Ea,qb,Za);this.k0k(!0)}vDm(){const ja=Object(ij.b)();if(this.cLl=!!ja)this.OE=ja}iWj(){this.vDm();return this.cLl}tlm(ja){this.Spm();let qb="";
({data:qb}=this.Mvl(ja)).returnValue&&(r.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.ehf=0,this.zo&&(this.vEh=this.zo.Xl("Task","Parse and Handle Get Policy Response")),this.ZVn(qb),this.vEh&&(this.vEh.stop(),this.vEh=null))}slm(ja){this.Spm();this.ehf<=this.XDh?this.ehj():(r.ULS.sendTraceTag(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",ja?ja.data?ja.data.qoc:null:null),this.ehf=0)}O$l(){return 0<this.shd}G$c(ja){this.OE.AppliedPolicyId=
ja;this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpSetCachedAppliedLabelId",!1)&&(this.MY=ja,this.oEm())}L5e(ja,qb,V=null,Ea=null){const Za=this.C4m(V);this.pbo(ja,qb,Za,V,Ea)}jnm(ja){this.oGd&&(this.oGd.stop(),this.oGd=null);const {hxm:qb,Hym:V,lGa:Ea}=this.r4l(ja),Za=ja.data.state,ia=Za?Za.hnb:2;let Va="";({data:Va}=this.Mvl(ja)).returnValue?(r.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",ia),this.shd=0,this.mWn(Va,qb,V,Za,Ea)):
this.j3k(ia,Ea)}b3n(ja){Qb.Health.instance.recordKpiUsage("MipSetPolicyLabel",wa.b.FailureBased,"officewebclp",this.Yhj(ja));this.Zjh=this.getCurrentTime();r.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.nb.raiseEvent("SetPolicyLabelTriggeredEventKey",new Ak(ja))}rPn(){this.Ueg&&this.xLe&&this.G$l&&this.ALa.qDb(12,null,!0)}inm(ja){this.oGd&&(this.oGd.stop(),this.oGd=null);const {hxm:qb,Hym:V,lGa:Ea}=this.r4l(ja);if(this.shd<=this.XDh)this.L5e(qb,V,null,Ea);else{var Za=
ja.data.state;Za=Za?Za.hnb:2;r.ULS.sendTraceTag(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",ja?ja.data?ja.data.qoc:null:null,Za);this.smg="WACServerConnectionFailed";this.shd=0;this.j3k(Za,Ea)}}jyn(ja){if(ja&&("LabelNotSupported"===ja||"LabelErrorRetryLater"===ja||"CoherencyFailure"===ja||"LabelIdNotFound"===ja||"LabelDisabled"===ja))return r.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",ja),!0;r.ULS.sendTraceTag(539103557,
306,50,"LabelError is not retriable: {0}",ja);return!1}iJb(ja){return ja.IsEndpointProtectionEnabled||ja.HasUserDefinedPermissions}N_m(ja){if(!ja)return!1;let qb=null,V=null;if(lh(this.Ga))qb=this.i0a[ja],V=this.i0a[this.MY];else for(const Ea of this.OE.SensitivityLabels)Ea.Id===ja&&(qb=Ea),Ea.Id===this.MY&&(V=Ea);if(!qb)return!1;if(this.Ueg&&this.xLe){if(this.u7h&&this.u7h()||this.bxn)return!0}else if(n.AFrameworkApplication.wZ&&n.AFrameworkApplication.wZ.Ofb||this.ljc&&this.ljc())return!0;return this.iJb(qb)===
(!!V&&this.iJb(V))}Jvf(ja,qb,V,Ea,Za){28===ja?this.esm(new rj(ja,qb,V,Ea,Za,!1)):this.esm(new rj(ja,qb,V,Ea,Za,!0))}eoc(ja){28===ja?this.qsm(new Tj(ja,!1)):this.qsm(new Tj(ja,!0))}N2n(ja,qb,V){r.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");this.nb.raiseEvent("CreateAutoCLPSecurityNodesEventKey",new hl(ja,qb,V))}h3n(ja){r.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");this.nb.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",
new hl(null,null,ja))}i3n(ja,qb){r.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.nb.raiseEvent("UpdateAutoCLPSITNodesEventKey",new hl(ja,qb,null))}nsm(ja,qb){r.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===qb?"Reading":"Edit")+" switch event.");this.nb.raiseEvent("MandatoryLabellingAppHandlerEventKey",new Tk(ja,qb))}Eqi(ja,qb,V,Ea,Za){37===ja&&this.L2n(new vl(37,qb,V,Ea,Za))}JXk(){this.Y2n(new Nj)}g3n(){r.ULS.sendTraceTag(540608322,306,50,
"Raising a UDP labeling event.");this.nb.raiseEvent("UDPLabelingAppHandlerEventKey",new Uk(!0))}cfb(ja=!1){const qb=Object(Zj.a)(this.OE);qb||ja||oi.DYh(!1);return qb}o$n(){window.postMessage(JSON.stringify({type:"mipProperties",isProtected:n.AFrameworkApplication.Mz,sensitivity:{labelId:this.MY},usageRights:{docEdit:this.OE.EditEnabled,extract:n.AFrameworkApplication.DAa,print:n.AFrameworkApplication.lZa,export:n.AFrameworkApplication.hUd,objModel:n.AFrameworkApplication.oXb,owner:n.AFrameworkApplication.iUd}}),
"*")}dqm(ja){ja&&(this.ljc=ja);r.ULS.shipAssertTag(507888257,306,this.iWj(),"populatePolicyLabelsDataFromCache was called with no cached response");Object(ij.c)()?(r.ULS.sendTraceTag(507847580,306,50,"Policy label boot call is still pending response."),Object(ij.e)(this.q8l.bind(this))):(r.ULS.sendTraceTag(507847579,306,50,"Policy label boot call is being used to populate policy label info"),this.q8l())}q8l(){this.r8l(Object(ij.b)(),Object(ij.a)());this.lsm(1,!0)}lsm(ja,qb){this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpdateIRMWhenLabelChangedEnabled",
!1)&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableEdgeBlockScreenCapture",!1)&&qb&&this.o$n();Qb.Health.instance.recordKpiSuccess("MipGetPolicyLabel",this.WKh(void 0,ja,this.r4f));this.r4f=null;ja=new il(ja);this.O2n(ja);qb&&this.Tco()?(this.m9l?this.Dlo():(this.MPk(ja),this.Eci=!0),this.MPk(ja),this.Eci=!0):qb||this.NPk()}g2c(ja){this.ezd&&(this.ezd.stop(),this.ezd=null);var qb=null;ja&&ja.data&&(qb=ja.data.lGa);let V;this.k0k(!1);({data:V}=this.Mvl(ja)).returnValue?(r.ULS.sendTraceTag(34996493,
306,50,"Request to get label policy data succeeded."),this.ahf=0,qb=this.eWn(V,qb),this.lsm(this.R3l(ja.data),qb)):this.NPk()}Tco(){if(!this.Ga.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled"))return r.ULS.sendTraceTag(539877667,306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;if(!this.oXm())return!1;if(""===this.MY)return r.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),!0;if(this.wvd===this.Kbi)return r.ULS.sendTraceTag(539877697,
306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),!1;r.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");return!0}fRi(){this.WDm();r.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.hGd.count,this.wvd);const ja=jl.toArray(this.hGd);this.N2n(ja,ja,this.wvd)}Dlo(){var ja=this.hGd;this.WDm();jl.zao(ja,
this.hGd)||(r.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.hGd.count),ja=jl.toArray(this.hGd),this.i3n(ja,ja));this.ZKl&&(r.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",this.wvd),this.h3n(this.wvd))}WDm(){var ja;const qb=new Mk.a(Qc.a.Co());for(const V of this.OE.SensitivityLabels)if(0<(null===(ja=null===V||void 0===V?void 0:V.AutoLabelingSensitiveTypeIds)||void 0===ja?void 0:ja.length))for(const Ea of V.AutoLabelingSensitiveTypeIds)Ea&&
qb.add(Ea);this.hGd=qb}f2c(ja){const qb=this.R3l(ja.data);let V=null;ja&&ja.data&&(V=ja.data.lGa);Qb.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",!1,!1,this.WKh(void 0,qb,this.r4f));this.r4f=null;this.ezd&&(this.ezd.stop(),this.ezd=null);if(this.ahf<=this.XDh){if(this.Ga.getBooleanAppSetting("SendHostAttributionInfoForPolicyLabelEnabled")){const Ea=ja.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in Ea&&Ea[vj.a.rsd]&&"HostAttributionInfo.ScenarioTypeParamName"in
Ea&&Ea[vj.a.a9c]){ja.data.request.get_headers();ja.data.request.get_headers()[vj.a.a9c];ja=this.uSi(qb);this.rLh(this.MY,ja,this.ljc,void 0,qb,V);return}}this.klc(this.MY,qb,this.ljc,!1,V)}else r.ULS.sendTraceTag(34996494,306,15,"Request to get label policy failed with error response: {0}.",ja?ja.data?ja.data.qoc:null:null),this.NPk(),this.ahf=0,this.k0k(!1)}R3l(ja){return ja.state?ja.state:0}U6g(ja,qb=!1){return Object(Zj.c)(this.Ga.Ma("PolicyHandlerWebServiceBase")||n.AFrameworkApplication.Ha.Ib.o1,
this.SMl,n.AFrameworkApplication.Fh,ja===Zj.e&&n.AFrameworkApplication.wZ&&n.AFrameworkApplication.wZ.BOh,ja,qb)}r4l(ja){let qb=null,V=null,Ea=null;ja&&ja.data&&ja.data.request&&ja.data.request.get_headers()&&(qb=ja.data.request.get_headers()[tk.a.W6k],V=ja.data.request.get_headers()[tk.a.ubl],Ea=ja.data.lGa);return{hxm:qb,Hym:V,lGa:Ea}}Mvl(ja){ja=ja?ja.data?ja.data.responseData:null:null;return ja&&ja.length&&!this.Kae(ja)?{returnValue:!0,data:ja}:(r.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),
{returnValue:!1,data:ja})}ZVn(ja){let qb;try{qb=ec.b(ja)}catch(V){r.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(qb)if(qb.IsPolicyTipAvailable)switch(qb.IsPolicyTipAvailable.toLowerCase()){case "false":r.ULS.sendTraceTag(26007261,306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");break;case "true":r.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.V9h=qb.NavigateUrl;this.Xeo(qb.GeneralText,
Object(da.a)(this,this.$Qn,"onDataLossPolicyOverrideButtonClick"));break;default:r.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",qb.IsPolicyTipAvailable)}else r.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");else r.ULS.sendTraceTag(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.")}f3m(ja){switch(ja){case "CoherencyFailure":return 1;
case "DisabledByPolicy":return 2;case "FileCheckedOut":return 3;case "FileEncrypted":return 4;case "FileLocked":return 5;case "FileNotSupported":return 6;case "FileTooLarge":return 7;case "InvalidOperationOnZeroByteFile":return 8;case "LabelDisabled":return 9;case "LabelErrorRetryLater":return 10;case "LabelIdNotFound":return 11;case "LabelIrmDisabledByTenant":return 12;case "LabelNotSupported":return 13;case "MinorVersionLimitExceeded":return 15;default:return 0}}mWn(ja,qb,V,Ea,Za=null){var ia=Ea?
Ea.hnb:2;let Va=0;var Ab="";let gc;if(({NB:gc}=ec.d(ja)).returnValue)if(gc){Ab="Success";ja=this.uSi(3);if(gc.IsSuccessful){Qb.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.WKh(ia,void 0,this.Zjh));this.smg=this.Zjh=null;r.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",ia);2===ia&&this.eoc(29);this.zbo(qb,ia);this.rPn();this.eoc(28);this.jJb()?Ea&&4===ia&&(Ab=Za.startsWith("OFFICEJS_SENSITIVITY_CONTEXT_"),
this.Jvf(28,Ab?"SENSITIVITY":Object(Fa.a)("PolicyBusinessBarTitle"),String.format(Ab?"Due to content created by Copilot, your organization automatically applied the sensitivity label: {0}.":Object(Fa.a)("PolicyLabelAutomaticallyAppliedMessage"),Ea.displayName),Object(Fa.a)("DialogOk"),()=>{})):Ea&&4===ia&&this.Jvf(28,Object(Fa.a)("PolicyBusinessBarTitle"),String.format(Object(Fa.a)("PolicyLabelAutomaticallyAppliedMessage"),Ea.displayName),Object(Fa.a)("DialogOk"),()=>{});Eb.a("MipAppliedLabels",void 0,
void 0,[Object.assign(new gf.a,{name:"SetPolicyLabelApplyFlag",string:Vi[ia]})]);this.rLh(qb,ja,this.ljc,void 0,3,Za);return}r.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",ia,gc.FailureReason);this.smg=gc.FailureReason;Va=this.f3m(gc.FailureReason);this.zyn&&0<=gc.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&(Ea=new jc.a(2,1,this.qbo,()=>{r.ULS.sendTraceTag(575428443,
306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",this.shd);this.shd<=this.XDh&&this.L5e(qb,V,null,Za)}),this.Ce.Rb(Ea));this.Ueg&&this.xLe&&this.rLh(this.OE.AppliedPolicyId,ja,this.ljc,!0,3,Za)}else Ab="setPolicyLabelData null.",r.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",ia);else Ab="TryDeserialize failed.",r.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",
ia);this.j3k(ia,Za,Va);ia=this.WKh(ia,void 0,this.Zjh);this.Zjh=null;ia.extendedProperties.set("SetPolicyLabelDataFailureReason",this.smg);ia.extendedProperties.set("SetPolicyLabelDataParseStatus",Ab.toString());Qb.Health.instance.recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,ia)}B2f(ja){if(""===ja)return null;for(const qb of this.OE.SensitivityLabels)if((null===qb||void 0===qb?void 0:qb.Id)===ja)return qb;return null}zlo(){if(""!==this.MY)if(lh(this.Ga)){var ja=this.i0a[this.MY];
ja&&(ja.HasExtractForUser=this.iJb(ja)?this.OE.ExtractEnabled:!0)}else for(ja of this.OE.SensitivityLabels)(null===ja||void 0===ja?void 0:ja.Id)===this.MY&&(ja.HasExtractForUser=this.iJb(ja)?this.OE.ExtractEnabled:!0)}j3k(ja,qb=null,V=0){const Ea=2===ja||8===ja||16===ja,Za=new Nl;this.G$c(this.MY);this.jJb()&&(lh(this.Ga)?Za.Yzf=this.i0a[this.MY]:Za.Yzf=this.B2f(this.MY),Za.context=qb,Za.Gym=V);this.msm(Za);this.zsm(V,ja,Ea,!1)}zbo(ja,qb){this.G$c(this.MY=ja);if(!this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpdateIRMWhenLabelChangedEnabled",
!1))if(""===ja)n.AFrameworkApplication.Mz=!1,n.AFrameworkApplication.oXb=!1;else for(const V of this.OE.SensitivityLabels)if(V.Id===ja){n.AFrameworkApplication.Mz=this.iJb(V);break}this.a3n(new wl(ja,qb))}oEm(){for(const ja of this.OE.SensitivityLabels)if(null===ja||void 0===ja?0:ja.Enabled)ja.Id===this.MY&&(this.ZKl=this.wvd!==ja.Order,this.wvd=ja.Order),ja.Order>this.Kbi&&(this.Kbi=ja.Order)}xEm(){this.Ga.appSettings&&(this.Ga.appSettings.AppliedPolicyId=this.MY);let ja=!1;if(""!==this.MY)if(lh(this.Ga))ja=
this.iJb(this.i0a[this.MY]);else for(const qb of this.OE.SensitivityLabels)if(qb.Id===this.MY){ja=this.iJb(qb);break}n.AFrameworkApplication.Mz=ja;n.AFrameworkApplication.zB=ja?this.OE.ViewEnabled&&!this.OE.EditEnabled:!1;n.AFrameworkApplication.lZa=ja?this.OE.PrintEnabled:!1;n.AFrameworkApplication.oXb=ja?this.OE.MacrosEnabled:!1;n.AFrameworkApplication.DAa=ja?this.OE.ExtractEnabled:!1;n.AFrameworkApplication.hUd=ja?this.OE.ExportEnabled:!1;n.AFrameworkApplication.iUd=ja?this.OE.FullControlEnabled:
!1}r8l(ja,qb){if(!ja)return r.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),!1;if(!ja.AreLabelsAvailable)return!1;this.OE=ja;this.MY=ja.AppliedPolicyId;this.jJb()&&this.zlo();this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpdateIRMWhenLabelChangedEnabled",!1)?lh(this.Ga)||this.xEm():this.Ga.appSettings&&(this.Ga.appSettings.AppliedPolicyId=this.MY);this.oEm();this.cfb()&&r.ULS.sendTraceTag(51197846,306,50,"Labels are available for display after GetPolicyLabels call.");
ja=new Nl(!0);this.jJb()&&(lh(this.Ga)?ja.Yzf=this.i0a[this.MY]:ja.Yzf=this.B2f(this.MY),ja.context=qb);this.msm(ja);return!0}eWn(ja,qb=null){return({NB:ja}=ec.d(ja)).returnValue?this.r8l(ja,qb):(r.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),!1)}oXm(){var ja;if(!this.cfb())return r.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),!1;for(const qb of this.OE.SensitivityLabels)if(0<(null===(ja=
null===qb||void 0===qb?void 0:qb.AutoLabelingSensitiveTypeIds)||void 0===ja?void 0:ja.length))return!0;r.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1}msm(ja){r.ULS.sendTraceTag(35393610,306,50,"Raising label info update event.");lh(this.Ga)&&(this.Oao(),this.jbo(),this.xEm());this.nb.raiseEvent("LabelInfoUpdateEvent",ja)}O2n(ja){r.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.nb.raiseEvent("GetPolicyLabelEventKey",
ja)}NPk(){oi.DYh(!1);this.nb.raiseEvent("GetPolicyLabelFailureEventKey",new zk)}MPk(ja){this.g$&&this.g$.execute(qb=>{qb=[qb.isFeatureEnabled("MsoClpSpTwo",!0),qb.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(qb).then(V=>{vc.a.any(V,Ea=>Ea)&&(r.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),this.nb.raiseEvent("GetAutoPolicyLabelEventKey",ja),this.fRi(),Eb.a("MipAutoClassificationEnabled"));return null})})}Yhj(ja=null,qb=null){const V=new Map;V.set("ClpCoauth",this.xLe.toString());
null!=ja&&V.set("ApplyLabelFlags",Vi[ja]);null!=qb&&V.set("GetPolicyLabelsReason",Nk[qb]);return V}WKh(ja=null,qb=null,V=null){const Ea={};Ea.extendedProperties=this.Yhj(ja,qb);null!=V&&(Ea.durationMs=this.getCurrentTime()-V);return Ea}a3n(ja){r.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.nb.raiseEvent("SetPolicyLabelEventKey",ja)}esm(ja){r.ULS.sendTraceTag(51128227,306,50,"Raising an add auto policy business bar entry event.");ja&&ja.UOh&&Eb.a("MipRecommendations");this.nb.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",
ja)}qsm(ja){r.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.nb.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",ja)}L2n(ja){r.ULS.sendTraceTag(573842331,306,50,"Raising an add mandatory labelling business bar entry event.");this.nb.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",ja)}Y2n(ja){r.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");this.nb.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",
ja)}Xeo(ja,qb=null){r.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.nb.raiseEvent("PolicyTipEvent",new Ok(Object(Fa.a)("PolicyBusinessBarTitle"),ja,Object(Fa.a)("PolicyOverrideButton"),qb))}zsm(ja,qb,V,Ea=!0){r.ULS.sendTraceTag(42074656,306,Ea?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",qb);Ea=Object(Fa.a)("SensitivityApplicationErrorBusinessBarTitle");let Za=Object(Fa.a)("SensitivityApplicationErrorBusinessBarMessage"),ia=null,Va=null;switch(ja){case 2:Ea=
Object(Fa.a)("SensitivityApplicationErrorDisabledByPolicyBusinessBarTitle");Za=Object(Fa.a)("SensitivityApplicationErrorDisabledByPolicyBusinessBarMessage");break;case 5:Za=Object(Fa.a)("SensitivityApplicationErrorFileLockedBusinessBarMessage");break;case 7:Ea=Object(Fa.a)("SensitivityApplicationErrorFileTooLargeBusinessBarTitle");Za=Object(Fa.a)("SensitivityApplicationErrorFileTooLargeBusinessBarMessage");break;case 13:Ea=Object(Fa.a)("SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle");
Za=Object(Fa.a)("SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage");break;case 9:Ea=Object(Fa.a)("SensitivityApplicationErrorLabelDisabledBusinessBarTitle");Za=Object(Fa.a)("SensitivityApplicationErrorLabelDisabledBusinessBarMessage");break;case 10:Za=Object(Fa.a)("SensitivityApplicationErrorLabelErrorRetryLaterBusinessBarMessage");break;case 14:Ea=Object(Fa.a)("SensitivityCoauthMandatoryApplicationErrorTitle");Za=Object(Fa.a)("SensitivityCoauthMandatoryApplicationErrorMessage");break;
case 15:Ea=Object(Fa.a)("SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle"),Za=Object(Fa.a)("SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage"),ia=Object(Fa.a)("LearnMore"),Va=()=>{this.rbo()}}ja=new Hi(ja,qb,V,Ea,Za,ia,Va);this.nb.raiseEvent("SetPolicyLabelFailureEventKey",ja)}Fal(ja){this.Vei=ja}$Qn(){this.V9h?(r.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),kc.a.KWd(this.V9h)):r.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")}Kae(ja){if(!ja.startsWith("<")||
-1===ja.indexOf("Error")&&-1===ja.indexOf("Unavailable"))return!1;r.ULS.sendTraceTag(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");return!0}Spm(){this.uEh&&(this.uEh.stop(),this.uEh=null)}Kdn(ja){if(!ja)return"manual";switch(ja.hnb){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";
case 32:return"ai";default:return"manual"}}yen(ja){if(!ja)return"privileged";ja=ja.hnb;let qb="privileged";if(4===ja||1===ja||32===ja)qb="standard";return qb}rLh(ja,qb,V=null,Ea=!1,Za=0,ia=null){this.Ga.getBooleanAppSetting("WacLabelingGetPolicyLabelsIsEnabled")&&(this.MY=ja,this.ljc=V,this.zo&&(this.ezd=this.zo.Xl("WebServiceCall","Call Get Policy Endpoint On Server")),Object(Zj.d)(this.Ga,this.Dn,Object(da.a)(this,this.g2c,"onGetPolicyLabelsSuccessCallback"),Object(da.a)(this,this.f2c,"onGetPolicyLabelsFailureCallback"),
this.U6g("getpolicylabels",Ea),ja,qb,Za,ia),this.ahf++,r.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.ahf))}pbo(ja,qb,V,Ea=null,Za=null){if(this.jOh){this.zo&&(this.oGd=this.zo.Xl("WebServiceCall","Call Set Policy Endpoint On Server"));var ia={};ia[tk.a.W6k]=ja;qb&&(ia[tk.a.ubl]=encodeURIComponent(qb));this.Vei&&(ia[tk.a.ARl]=this.Vei);Ea?(ia[tk.a.rbl]=this.Kdn(Ea),ia[tk.a.sbl]=this.yen(Ea),1===Ea.hnb&&this.OE.DefaultLabelType&&(ia[tk.a.Fym]=
this.OE.DefaultLabelType)):(ia[tk.a.rbl]="manual",ia[tk.a.sbl]="privileged");this.xLe&&this.OE&&(ia[tk.a.Upm]=this.OE.PolicyLabelVersionToken);this.Ga.getBooleanAppSetting("SendHostAttributionInfoForPolicyLabelEnabled")?(ja=new ak.a(this.U6g(Zj.e,!0),1,null,ia,!0,2,Ea,void 0,this.jJb()?Za:void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,V),this.Dn.send(ja).l7c(Object(da.a)(this,this.jnm,"onSetPolicyLabelSuccessCallback"),Object(da.a)(this,this.inm,"onSetPolicyLabelFailureCallback"))):
this.Dn.ik(this.U6g(Zj.e,!0),1,null,ia,!0,2,Object(da.a)(this,this.jnm,"onSetPolicyLabelSuccessCallback"),Object(da.a)(this,this.inm,"onSetPolicyLabelFailureCallback"),Ea,this.jJb()?Za:void 0,void 0,void 0,void 0,"32");this.shd++;r.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.shd)}else r.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")}rbo(){const ja=new J.a,qb=this.Ga.Ma("BreadcrumbFolderUrl");
qb?(ja.Ue=11,ja.vg(1,Object(Fa.a)("SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction")),ja.vg(2,Object(Fa.a)("DialogOk"))):(ja.Ue=0,ja.vg(1,Object(Fa.a)("DialogOk")));ja.lTe(Object(Fa.a)("SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText"),"0f6cd105-974f-44a4-aadb-43ac5bdfd247");ja.Gtm();ja.h6(Object(Fa.a)("SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle"),Object(Fa.a)("SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage"),V=>{1===
V&&qb&&kc.a.Go(qb,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})}uSi(ja){return Object(Zj.b)(ja)}C4m(ja=null){if(!ja)return vj.a.yfb(8,0);switch(ja.hnb){case 1:case 16:return vj.a.yfb(1,1);case 4:case 2:case 8:return vj.a.yfb(8,1);default:return vj.a.yfb(8,0)}}k0k(ja){ta.c()&&appChrome.api.setAsyncRequestStatus("sensitivity",ja)}slc(ja){return ja?ja.ParentId&&ja.ParentName?ja.ParentName+"\\"+ja.DisplayName:ja.DisplayName:""}getHighestSensitivityLabel(ja){if(!ja||
0==ja.length)return null;let qb=null;for(const V of ja)if(""!==V)if(lh(this.Ga))if(ja=this.i0a[V]){if(!qb||ja.Order>qb.Order)qb=ja}else return null;else{ja=!1;for(const Ea of this.OE.SensitivityLabels)(null===Ea||void 0===Ea?void 0:Ea.Id)===V&&(ja=!0,!qb||Ea.Order>qb.Order)&&(qb=Ea);if(!ja)return null}qb||(qb=new nk.a);return qb}wen(){return""===this.MY?new nk.a:lh(this.Ga)?this.i0a[this.MY]:this.B2f(this.MY)}tryUpgradeLabel(ja,qb){if(""===ja.Id)return 0;var V=lh(this.Ga)?this.i0a[this.MY]:this.B2f(this.MY);
ja=lh(this.Ga)?this.i0a[ja.Id]:this.B2f(ja.Id);if(!ja)return 2147205112;if(!ja.Enabled)return 2147205117;if(ja.HasUserDefinedPermissions)return 2147205116;if(1==n.AFrameworkApplication.ub.mode)return 2147205119;if(ja.RequiredDowngradeJustification||(null===V||void 0===V?void 0:V.Order)>=ja.Order)return 2147205105;V=new xg(4,this.slc(ja));this.L5e(ja.Id,"",V,qb);return 0}}Object(m.a)(kl,"PolicyManager",null,[574]);class Qh{constructor(){this.Vji=this.Ghi=this.VLl=this.mNl=this.FIl=this.wq=this.ghd=
this.Oa=this.sv=null;this.Jkm=()=>{this.wq=Object(nj.a)();this.sv||(this.sv=ni());this.ghd=k.a.instance.resolve("Common.App.Policy.PolicyActor");ta.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")?this.sv.Njc(Object(da.a)(this.ghd,this.ghd.etm,"registerActionsHandler")):this.ghd.Kb();this.sv.Njc(this.hmo);n.AFrameworkApplication.ha.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled")&&(this.sv.AQl(this.spn),this.sv.MUm(this.Jvf),
this.sv.FVm(this.eoc),this.sv.NUm(this.Eqi),this.sv.GVm(this.JXk))};this.hmo=()=>{lh()||(this.ghd.Pao(),this.ghd.kbo());this.ghd.r2n();const ja=this.sv.r0m();n.AFrameworkApplication.ha.getBooleanAppSetting("HasDocumentEditRights")&&!ja?this.ghd.Tjo():r.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",n.AFrameworkApplication.ha.getBooleanAppSetting("HasDocumentEditRights"),ja);n.AFrameworkApplication.Ha.fg()};
this.Weo=(ja,qb)=>{this.Ghi&&this.wq.rYa(38)&&this.wq.removeEntry(this.Ghi);ja=this.P3l(qb.title,qb.UXn,38,qb.vQn,qb.buttonText);n.AFrameworkApplication.Ha.Ib.rJd(ja,!0)?(this.Ghi=ja,r.ULS.sendTraceTag(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")):r.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")};this.spn=(ja,qb)=>{qb.Neo&&(this.Vji&&this.wq.rYa(21)&&this.wq.removeEntry(this.Vji),ja=this.P3l(qb.title,
qb.message,21,null,null,qb.DDf,qb.buttonText),n.AFrameworkApplication.Ha.Ib.rJd(ja,!0)?(this.Vji=ja,r.ULS.sendTraceTag(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")):r.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user."))};this.eoc=(ja,qb)=>{(ja=qb.UOh?this.mNl:this.FIl)&&this.wq&&this.wq.rYa(qb.tUe)&&this.wq.removeEntry(ja)};this.Jvf=(ja,qb)=>{this.wq&&(this.sv.eoc(qb.tUe),ja=new Ql.a(qb.title,
qb.message,null),ja.id=qb.tUe,ja.closeable=!0,ja.image=3,ja.addButton(qb.buttonText,qb.DDf,qb.buttonText,!0),this.wq.mi(ja,!1),qb.UOh?this.mNl=ja:this.FIl=ja)};this.Eqi=(ja,qb)=>{this.wq&&(ja=new Ql.a(qb.title,qb.message,null),ja.id=qb.tUe,ja.closeable=!1,ja.image=3,ja.addButton(qb.buttonText,qb.DDf,qb.buttonText,!1),this.wq.mi(ja,!1),this.VLl=ja)};this.JXk=()=>{const ja=this.VLl;ja&&this.wq&&this.wq.rYa(ja.id)&&this.wq.removeEntry(ja)}}get name(){return"Common.App.Policy"}init(){n.AFrameworkApplication.ha.getBooleanAppSetting("ShouldInitCommonPolicyPackage")&&
(n.AFrameworkApplication.ha.getBooleanAppSetting("IsDataLossPreventionEnabledForUser")&&n.AFrameworkApplication.Ha&&(this.sv=ni(),this.sv.AVm(this.Weo),r.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",!1)?xc.a.get_instance().Ai(5,()=>{this.sv.ehj()}):xc.a.get_instance().Ai(6,()=>{this.sv.ehj()})),n.AFrameworkApplication.ha.getBooleanAppSetting("WacLabelingPoliciesIsEnabled")&&
n.AFrameworkApplication.ha.getBooleanAppSetting("SupportsPolicies")?n.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InitPolicyManagerEarlierEnabled",!1)?xc.a.get_instance().Ai(5,this.Jkm):xc.a.get_instance().Ai(6,this.Jkm):(oi.Imo(),oi.DYh(!1)))}dispose(){}oc(ja){ja.register(574,"Common.App.Policy.Contracts.IPolicyManager").oa().pa(()=>new kl(n.AFrameworkApplication.ha,n.AFrameworkApplication.$d,n.AFrameworkApplication.Ha.Iea,n.AFrameworkApplication.ha.Ac("MaxGetPolicyRetries",
1),Object(Wh.a)(),n.AFrameworkApplication.Ha.Ib.Dm));ja.register(oi,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").oa().pa(()=>new oi(n.AFrameworkApplication.ub,n.AFrameworkApplication.Ha,n.AFrameworkApplication.ha,Object(Eh.b)()));this.Oa=ja}P3l(ja,qb,V,Ea=null,Za=null,ia=null,Va=null){ja=new Ql.a(ja,qb,null);ja.id=V;ja.closeable=!0;Ea&&ja.oTe(Za,Ea);ia&&ja.addButton(Va,ia,Va);return ja}static main(){I.a.instance.Jc(new Qh)}}Object(m.a)(Qh,"PackageManager",null,[4,
5]);var ll=a(363),Rl=a(327),Bk=a(157);class Uj extends Rl.a{constructor(){super();this.fullDocSITs=this.partialDocSITs=null;this.H_=Object.assign(new Bk.a,{T_:Uj.getTypeName(),B_:Uj.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_SecurityShared"}static getBaseTypes(){return[]}}Object(m.a)(Uj,"SecurityShared",Rl.a,[]);class th extends Uj{constructor(){super();this.existingLabelPriority=null;this.H_=Object.assign(new Bk.a,{T_:th.getTypeName(),B_:th.getBaseTypes()})}static getTypeName(){return"AugLoop_SecurityShared_CLP"}static getBaseTypes(){return["AugLoop_SecurityShared_SecurityShared"]}}
Object(m.a)(th,"CLP",Uj,[]);var Sl=a(299),uk=a(286),Vk=a(612);class kk extends Ci.a{constructor(ja){super();this.TenantId=null;this.TenantId=ja}lo(){return 103}}Object(m.a)(kk,"GetAppliedPolicyIdRequest",Ci.a,[]);class Yl extends Sys.EventArgs{constructor(ja){super();this.AHb=ja}}Object(m.a)(Yl,"OnAppliedPolicyReceivedEventArgs",Sys.EventArgs,[]);class wj{constructor(ja,qb,V){this.Zwa=this.rdk=this.vRh=null;this.xa=new Ah.a;this.iZe=!1;this.Jm=ja;this.nfe=qb;this.Jb=V;this.nfe.IPl(Object(da.a)(this,
this.Skm,"onAppliedPolicyIdReady"));this.nfe.VPl(Object(da.a)(this,this.fmm,"onIsManuallyAppliedReady"))}dVm(ja){this.xa.addHandler("AppliedPolicyEventReceivedKey",ja)}dispose(){this.nfe.Ytm(Object(da.a)(this,this.Skm,"onAppliedPolicyIdReady"));this.nfe.jum(Object(da.a)(this,this.fmm,"onIsManuallyAppliedReady"))}JWe(ja,qb){ja?(this.Zwa=ja,this.vRh=qb,ja=new vd.a(new kk(ja),V=>{this.qqd(V)},V=>this.Khb(V)),this.Jm.Rb(ja)):Pc.a.$(507843486,822,15,"GetAppliedPolicyIdAsync: tenantId is null or empty")}ain(ja,
qb){!qb||za.a.wb(ja)?Pc.a.$(507843485,822,15,"GetIsManuallyAppliedAsync: tenantId or callback is null or empty"):(this.Zwa=ja,this.rdk=qb,ja=new vd.a(new kk(ja),V=>{this.qqd(V)},V=>this.Khb(V)),this.Jm.Rb(ja))}Skm(ja,qb){ja="";za.a.wb(qb.AHb)||(ja=qb.AHb);"00000000-0000-0000-0000-000000000000"===ja?(qb=za.a.wb(this.Zwa)?this.Jb.Ma("TenantId"):this.Zwa,this.JWe(qb,this.vRh)):this.ywk(ja,null)}fmm(ja,qb){this.rSn(qb.iZe)}qqd(ja){let qb=null;ja.ServerError&&0!==ja.ServerError.Code?qb=Yb.a[ja.ServerError.Code]:
0!==ja.StatusCode&&(qb=wb.a[ja.StatusCode]);qb&&this.ywk("",qb)}Khb(){Pc.a.$(507843484,822,15,"OnGetAppliedPolicyIdFailed()");this.ywk("","ErrorGetAppliedPolicyIdFailed");return!0}ywk(ja,qb){qb&&Pc.a.$(507843483,822,15,"OnAppliedPolicyIdReceived: error: "+qb);this.vRh?this.vRh(ja,qb):Pc.a.$(507843482,822,15,"m_getAppliedPolicyIdCallback is null");Pc.a.$(507843481,822,50,"OnAppliedPolicyIdReceived: Triggering OnAppliedPolicyReceivedEvent");ja=new Yl(ja);this.xa.raiseEvent("AppliedPolicyEventReceivedKey",
ja)}rSn(ja){this.rdk?this.rdk(ja,null):Pc.a.$(507843479,822,15,"m_getIsManuallyAppliedCallback is null")}}Object(m.a)(wj,"AppliedPolicyIdService",null,[533,40]);class Wk{constructor(ja,qb,V,Ea){this.v0e=ja;this.TRc=qb;this.eSa=V;this.na=Ea}gra(ja){const qb=(ja.automatic||{}).id;var V=ja.recommended||{};ja=V.id;V=V.policyTip;this.na.q3e?this.v0e.GRl(qb,ja,V,!this.eSa.OE.AppliedPolicyId||!this.TRc.iZe):this.v0e.GRl(qb,ja,V,!this.eSa.OE.AppliedPolicyId)}}Object(m.a)(Wk,"AutoClpAnnotationEventHandler",
null,[]);class Nh{constructor(){this.ApplyLabelType=0;this.LabelJson=this.LabelId=this.DocLocation=null;this.SkipContentMarking=!1;this.UserPrincipalName=this.UserName=this.TenantId=null}}Object(m.a)(Nh,"PolicyInfo",null,[]);var Yi=a(1259);class Ck{constructor(){this.u2e=this.startTime=null}}Object(m.a)(Ck,"PollingData",null,[]);class Vj{constructor(ja,qb,V,Ea,Za,ia,Va,Ab,gc,Hc,fd,hd){this.Ohm=this.S_e=!1;this.KQh=null;this.Cfm=!1;this.la=ja;this.v0e=qb;this.eSa=V;this.Zwa=Ea;this.pdm=new K.a;this.EEn=
Za;this.TRc=ia;this.Yb=Va;this.Mhm=Ab;this.xs=gc;this.Ofa=Hc;this.hv=fd;this.kc=hd;this.Rgm=n.AFrameworkApplication.ha.Ac("ClpLabelPollingIntervalMs",3E4);this.jjk=n.AFrameworkApplication.ha.Ac("ClpLabelPollingTimeoutMs",3E5);this.ZIa=n.AFrameworkApplication.ha.Ma("UserName");this.AHn=n.AFrameworkApplication.ha.Ma("UserPrincipalName");this.aEn=this.wgn()}wgn(){let ja;(ja=n.AFrameworkApplication.ha.Ma("EditDocInClientUrl"))||(ja=n.AFrameworkApplication.ha.Ma("WOPISrc"));return ja}dispose(){this.v0e=
null;if(this.S_e){this.eSa.Hum(Object(da.a)(this,this.hnm,"onSetLabelSucceeded"));for(const ja of this.pdm)this.eSa.Hum(ja)}}init(){this.v0e.Kb();this.v0e.Ae();if(n.AFrameworkApplication.ha.getBooleanAppSetting("PPTClpSwitchEnabled")&&n.AFrameworkApplication.ha.getBooleanAppSetting("SupportsOfficeClientCoauthoring")){const ja=Object(Rb.a)(Yi.a,ha.App.xi);ja&&this.eSa.H4n(Object(da.a)(ja,ja.PRl,"areAllCoauthorsInSessionClientMipTrusted"));this.eSa.vun(this.EEn);0<this.Rgm&&0<this.jjk&&this.TRc.dVm(Object(da.a)(this,
this.yRn,"onDocumentContentPolicyChanged"));n.AFrameworkApplication.HIa&&this.Mhm.Q4n(()=>this.xs.O2h);this.xs.Nfa&&(Pc.a.$(512263630,822,50,"PPTPolicyManager::Init - Setting LockId to {0}",this.xs.Nfa),this.eSa.Fal(this.xs.Nfa));this.Ofa.GPl(()=>{Pc.a.$(512263629,822,50,"PPTPolicyManager::LockIdChanged - Setting LockId to {0}",this.xs.Nfa);this.eSa.Fal(this.xs.Nfa)})}this.eSa.SVm(Object(da.a)(this,this.nXm,"applyUdpLabeling"));this.eSa.b5n(Object(da.a)(this,this.Awn,"isClpBlockedByAppSpecificScenario"));
this.eSa.bVm(Object(da.a)(this,this.kXm,"applyMandatoryLabeling"));this.eSa.kui(Object(da.a)(this,this.hnm,"onSetLabelSucceeded"));this.S_e=!0}nXm(ja,qb){qb.hdo&&n.AFrameworkApplication.ub.Eb(Yc.a.openInClient,2)}Awn(){const ja=!this.kc.getState(2)&&!this.kc.Tmd;this.Ohm!==ja&&(this.kc.r8j(),Pc.a.$(512263628,822,50,"PPTPolicyManager::IsClpBlockedByAppSpecificScenario - {0}",ja),this.Ohm=ja);return ja}get AHb(){return this.eSa.OE.AppliedPolicyId}f5n(ja){this.eSa.kui(ja);this.pdm.add(ja)}SWn(ja,qb,
V){const Ea=new Nh;Ea.TenantId=this.Zwa;Ea.LabelId=ja;Ea.ApplyLabelType=qb;Ea.LabelJson=Vj.Ubn(ec.c(V));Ea.SkipContentMarking=!1;Ea.UserName=this.ZIa;Ea.UserPrincipalName=this.AHn;Ea.DocLocation=this.aEn;Pc.a.$(512263627,822,50,"PersistLabelToWorker: Updating worker with received policy");this.la.Ra(Yc.a.SWh,2,Ea)}kXm(ja,qb){if(qb&&0!==qb.oGh){(ja=1===qb.oGh)?this.hv.W6e():(this.hv.M0h(),""!==qb.Rim&&this.Mhm.lXm(qb.Rim));qb=ja?1:3;var V=n.AFrameworkApplication.ub.mode;qb!==V?Pc.a.$(512263625,822,
10,"ApplyMandatoryLabeling ModeSwitch Failed. Expected: {0}, Current: {1}",qb,V):this.Cfm=ja}else Pc.a.$(512263626,822,50,"ApplyMandatoryLabelling is called with invalid inputs.")}hnm(ja,qb){this.SWn(qb.Tpm,qb.hnb,this.eSa.OE);Pc.a.$(512263624,822,50,"OnSetLabelSucceeded: Set policy label to ppt file after set label succeeded on host.")}M6i(ja){ja&&this.AHb?ja=this.AHb.toLowerCase()===ja.toLowerCase():(Pc.a.$(512263623,822,50,"FLabelIdMatchesPolicyManager: null labelId or null AppliedPolicyId, can't compare case insensitively. fNullLabelId:{0} fNullAppliedPolicyId:{1}",
!ja,!this.AHb),ja=ja===this.AHb);Pc.a.$(512263622,822,50,"FLabelIdMatchesPolicyManager: fLabelIdMatchesPolicyManager:{0}",ja);return ja}XXn(ja){const qb=Object(Rb.a)(Ck,ja.customData);if(qb){var V=+new Date-+qb.startTime;Pc.a.$(512263620,822,50,"PollingTaskCallback: Callback received, durationMs:{0}",V);this.M6i(qb.u2e)||V>this.jjk||qb.u2e!==this.KQh?(Pc.a.$(512263619,822,50,"PollingTaskCallback: Stopping loop due to FAreInSync:{0} fDidTimeout:{1} fStaleLabelId:{2}",this.M6i(qb.u2e),V>this.jjk,qb.u2e!==
this.KQh),this.Yb.Sh(ja)):(Pc.a.$(512263618,822,50,"PollingTaskCallback: Triggering GetPolicy call"),this.eSa.klc(qb.u2e,void 0,Vj.jTb,!0))}else Pc.a.$(512263621,822,15,"PollingTaskCallback: Failed to get pollingData from taskItem, removing task"),this.Yb.Sh(ja)}who(ja){Pc.a.$(512263617,822,50,"SubmitPollingTask: Submitting new polling task");const qb=new jc.a(2,2,this.Rgm,Object(da.a)(this,this.XXn,"pollingTaskCallback"),90,"113");qb.customData=Object.assign(new Ck,{startTime:new Date,u2e:ja});this.Yb.Rb(qb)}yRn(ja,
qb){Pc.a.$(512263616,822,50,"OnDocumentContentPolicyChanged: Notification received");qb.AHb||Pc.a.$(512263587,822,50,"OnDocumentContentPolicyChanged: Empty labelId - could indicate bug or all labels removed");this.KQh=qb.AHb;this.M6i(this.KQh)?Pc.a.$(512263586,822,50,"OnDocumentContentPolicyChanged: PODS is in agreement with SPO, no need to poll"):this.who(qb.AHb)}static jTb(){const ja=ha.App.xi.amIAlone,qb=ha.App.xi.jTb;let V=!1;const Ea=Object(Rb.a)(Yi.a,ha.App.xi);Ea&&(V=Ea.QRl());Pc.a.$(512263585,
822,50,"AmITheOnlyCoauthor: Used block self coauth flow, fAmIAlone:{0} fAmITheOnlyCoauthor:{1} fAreAllCoauthorsWebClients:{2}",ja,qb,V);return ja||qb&&V}static Ubn(ja){ja=ja.replace(RegExp(":null","gi"),':""');return ja=ja.replace(RegExp('"LabelActions":',"gi"),'"Actions":')}}Object(m.a)(Vj,"PptPolicyManager",null,[40]);class Oj{constructor(ja,qb,V,Ea){this.hDn=ja;this.rc=qb;this.Tb=V;this.na=Ea}Kb(){this.hDn.ua(Yc.a.SWh,$b.a.application,Object(da.a)(this,this.aon,"handleApplySensitivity"),4)}Ae(){}aon(ja,
qb,V,Ea,Za){if(!(n.AFrameworkApplication.ha.getBooleanAppSetting("WacLabelingPoliciesIsEnabled")&&n.AFrameworkApplication.ha.getBooleanAppSetting("WacApplyManualPolicyLabelIsEnabled")&&this.na.kcc&&this.na.erd&&n.AFrameworkApplication.ha.getBooleanAppSetting("SupportsPolicies")))return 16;if(qb.contextId!==$b.a.application)return 2;if(!Za||!Object(qa.a)(Nh,Za))return 8;ja=Object(Rb.a)(Nh,Za);if(za.a.wb(ja.TenantId))return Pc.a.$(507843082,808,10,"The tenant id of policy info is empty or null"),8;
if(za.a.wb(ja.LabelJson))return Pc.a.$(507843081,808,10,"The label json of policy info is empty or null"),8;if(1===V)return 32;V=this.rc.In;qb=this.Tb.Kd(7);try{qb.tc(V),V.Shb=ja}finally{qb&&qb.dispose()}return 32}}Object(m.a)(Oj,"SetPolicyActor",null,[502]);class Cl{constructor(){this.u$j=this.ISh=this.Jb=this.TRc=this.ga=null;this.Ygm=!0}get name(){return"PowerPointWebEditor.Policy"}oc(ja){this.ga=ja;this.ga.register(533,"PowerPointWebEditor.Policy.IAppliedPolicyIdService").oa().pa(()=>new wj(this.ga.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.ga.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler"),this.ga.resolve("Common.IAppSettingsManager")))}init(){this.Jb=this.ga.resolve("Common.IAppSettingsManager");this.Jb.ugb(Object(da.a)(this,this.uu,"onFullAppSettingsReady"))}dispose(){}uu(){this.Jb.getBooleanAppSetting("WacLabelingPoliciesIsEnabled")&&this.Jb.getBooleanAppSetting("SupportsPolicies")&&this.Jb.getBooleanAppSetting(Td.a.kcc)&&(this.TRc=this.ga.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),xc.a.get_instance().Ai(10,
Object(da.a)(this,this.uYg,"onAfterRibbonDisplayed")),ll.a.kH(this.ga.eb("Common.App.Policy.Contracts.IPolicyManager")).continueWith(ja=>{const qb=new Oj(this.ga.resolve("Common.IActionManagerExtended"),this.ga.resolve("PowerPointWebEditor.IPresentationReader"),this.ga.resolve("Common.Transaction.ITransactionFactory"),this.ga.resolve("PowerPointWebEditor.IApplicationSettings"));ja=ja.result;this.ISh=new Vj(this.ga.resolve("Common.IActionManagerExtended"),qb,ja,this.Jb.Ma("TenantId"),this.ga.eb("Common.Interface.IRtcBasicProvider"),
this.ga.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),this.ga.resolve("Common.ITaskManager"),this.ga.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.ga.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.ga.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.ga.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),this.ga.resolve("PowerPointWebEditor.Core.IUnifiedAppState"));this.ISh.init()}))}uYg(){ll.a.kH(this.ga.eb("Common.App.Policy.Contracts.IPolicyManager")).continueWith(ja=>
{const qb=ja.result;n.AFrameworkApplication.ha.getBooleanAppSetting("AutoClpIsEnabled")&&(Pc.a.$(512274584,822,50,"OnAfterRibbonDisplayed: Registering with GetAutoPolicyLabelHandler API"),this.u$j=new la.a(()=>new Wk(this.ga.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.ga.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),qb,this.ga.resolve("PowerPointWebEditor.IApplicationSettings"),this.Jb.Ma("TenantId"))),qb.VUm(Object(da.a)(this,this.I4n,"registerAutoClpAnnotationEventHandler")),
qb.SUm(Object(da.a)(this,this.fRi,"createAutoCLPSecurityNodes")),qb.TVm(Object(da.a)(this,this.Blo,"updateAutoCLPLabelPriorityNode")),qb.UVm(Object(da.a)(this,this.Clo,"updateAutoCLPSITNodes")));ja=this.Jb.Ma("AppliedPolicyId");const V=n.AFrameworkApplication.ha.getBooleanAppSetting("PPTOCoauthorPopUpFixManualCLPEnabled")?Vj.jTb:void 0;ja||n.AFrameworkApplication.ha.getBooleanAppSetting("PPTClpSwitchEnabled")&&n.AFrameworkApplication.ha.getBooleanAppSetting("SupportsOfficeClientCoauthoring")?qb.iWj()?
qb.dqm(V):qb.klc(ja,void 0,V):(ja=this.Jb.Ma("TenantId"),za.a.wb(ja)?Pc.a.$(512274583,822,15,"OnAfterRibbonDisplayed: tenantId is null or empty"):(Pc.a.$(512274582,822,50,"OnAfterRibbonDisplayed: Call AppliedPolicyIdService.GetAppliedPolicyIdAsync"),this.TRc.JWe(ja,(Ea,Za)=>{Za&&Pc.a.$(512274581,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync failed: "+Za);za.a.wb(Ea)&&(Ea="",Pc.a.$(512274580,822,50,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync: appliedPolicyIdInFile is empty"));
qb.iWj()?qb.dqm(V):qb.klc(Ea,void 0,V)}),this.TRc.ain(ja,(Ea,Za)=>{Za?Pc.a.$(512274579,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetIsManuallyAppliedAsync failed: "+Za):this.TRc.iZe=Ea}),this.ISh.f5n(Object(da.a)(this,this.fmo,"updateIsManuallyApplied"))))})}I4n(){const ja=this.ga.resolve("PowerPointWebEditor.Core.IUnifiedAppState");this.Ygm&&(ja.oq||this.ISh.Cfm&&ja.$md)&&(this.ga.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(qb=>{Pc.a.$(512274578,822,
50,"RegisterAutoClpAnnotationEventHandler: Registering with AugLoopRuntimeManager");qb.v2("AugLoop_SecurityClp_LabellingAnnotation");qb.ZFa("AugLoop_SecurityClp_LabellingAnnotation",Object(da.a)(this.u$j.value,this.u$j.value.gra,"handleAnnotationEvent"))}),this.Ygm=!1)}fRi(ja,qb){ja=[Object.assign(new uk.a,{id:"clp",body:Object.assign(new th,{existingLabelPriority:qb.existingLabelPriority,partialDocSITs:qb.KUl,fullDocSITs:qb.JUl})})];const V=Object.assign(new Sl.a,{parentPath:["session","doc","security"],
items:ja});this.ga.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Ea=>{Pc.a.$(512274577,822,50,"CreateAutoCLPSecurityNodes: Submit AddOperations to AugLoopRuntimeManager");Ea.submitOperation(V)})}Blo(ja,qb){ja=[Object.assign(new uk.a,{id:"clp",body:Object.assign(new th,{existingLabelPriority:qb.existingLabelPriority})})];const V=Object.assign(new Vk.a,{parentPath:["session","doc","security"],items:ja});this.ga.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Ea=>
{Pc.a.$(512274576,822,50,"UpdateAutoCLPLabelPriorityNode: Submit UpdateOperation to AugLoopRuntimeManager");Ea.submitOperation(V)})}Clo(ja,qb){ja=[Object.assign(new uk.a,{id:"clp",body:Object.assign(new th,{partialDocSITs:qb.KUl,fullDocSITs:qb.JUl})})];const V=Object.assign(new Vk.a,{parentPath:["session","doc","security"],items:ja});this.ga.eb("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Ea=>{Pc.a.$(512274575,822,50,"updateAutoCLPSITNodes: Submit UpdateOperation to AugLoopRuntimeManager");
Ea.submitOperation(V)})}fmo(ja,qb){qb&&(this.TRc.iZe=qb.Tpm&&0!==qb.hnb?2===qb.hnb||8===qb.hnb||16===qb.hnb?!0:!1:!1)}static main(){I.a.instance.Jc(new Cl)}}Object(m.a)(Cl,"PPTWebEditorPolicyPackage",null,[4,5]);var Jg=a(18);Type.registerNamespace("B4Intent");Type.registerNamespace("Box4.Dictation");Type.registerNamespace("Box4.Dictation.Authentication");Type.registerNamespace("Box4.DictationCorrections");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("OfficeVoice.FrontdoorSpeechClient");
Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointSafeLinks");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Activity");Type.registerNamespace("PowerPointWebEditor.Animations");Type.registerNamespace("PowerPointWebEditor.Dictation");Type.registerNamespace("PowerPointWebEditor.FirstRunExperience");Type.registerNamespace("PowerPointWebEditor.Policy");Type.registerNamespace("PowerPointWebEditor.RevisionTracking");
Object(Jg.c)("Chronosslim");(()=>{var ja;null!==(ja=n.AFrameworkApplication.ha)&&void 0!==ja&&ja.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DemandLoadApplicationFeatureHelper",!1)||(Type.registerNamespace("Common"),Type.registerNamespace("Common.App.ApplicationFeatureHelper"),h.ApplicationFeatureHelperPackage.main())})();Type.registerNamespace("Common.App.CatchUpActivity");O.main();Type.registerNamespace("Common.App.Rename");I.a.instance.Jc(new Lc,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");
I.a.instance.Jc(new ac);Type.registerNamespace("Common.App.SafeLinks");ne.main();ih.main();wi.main();vg.main();yg.main();Hh.main();Pg.main();bj.main();I.a.instance.Jc(new Mh);Fj.main();I.a.instance.Jc(new Pl);ik.main();Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.Policy");Qh.main();Cl.main();Ze.main();Object(Jg.b)("Chronosslim")},294:function(y,C,a){a.r(C);a.d(C,"CuiHelperStatic",function(){return b});
y=a(0);var c=a(156);class b{static addButton(d,e,h,n,m,k,l,u){e=c.a(d,e,h,n,null,null,null,k,null,null,void 0,void 0,m);(d=u.hostControl(d,e,k))&&l.appendChild(d);return d}}b.mxa="btnReplyWithChanges";Object(y.a)(b,"CuiHelperStatic",null,[])},315:function(y,C,a){a.d(C,"a",function(){return T});y=a(0);a(172);var c=a(50),b=a(405),d=a(416);a(560);var e=a(41),h=a(111),n=a(57),m=a(59);class k{}Object(y.a)(k,"RibbonUpsellButtonCreator",null,[]);class l extends Sys.EventArgs{constructor(K){super();this.ZAh=
K}}Object(y.a)(l,"TopRowCreatedEventArgs",Sys.EventArgs,[]);var u=a(472),r=a(366);a(169);var x=a(156);a(300);a(109);var v=a(254),z=a(162),A=a(88);class B{constructor(K,M){this.cluster=K;this.Tjd=M}}Object(y.a)(B,"ImageInfo",null,[]);class G{constructor(K,M,N,I,O,Q,U,ba,aa,La,Z,la,da,J,Ca=null,Fa=null){this.id=K;this.Lhd=M;this.Phd=N;this.Ohd=I;this.Nhd=O;this.Mhd=Q;this.XId=U;this.hTe=ba;this.Lgc=new B(aa,La);this.VJe=new B(Z,la);this.Yre=new B(da,J);Ca&&Fa&&new B(Ca,Fa)}}Object(y.a)(G,"PeoplesWellBaseSettings",
null,[]);class w{constructor(){this.STb=null}}Object(y.a)(w,"BreadcrumbControls",null,[]);class F{constructor(K){this.id=K}}new F("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32","WACSkypeDocChatUnread_16x16x32");Object(y.a)(F,"ChatButtonSettings",null,[]);class H{constructor(){this.id=this.image=this.label=this.command=null}}Object(y.a)(H,"SkypeButtonInfo",null,[]);class E{constructor(){this.feb=this.Rhc=this.C2a=null}}Object(y.a)(E,"TopRowControls",null,[]);var P=a(206);a(64);class T{constructor(K,
M,N=null,I=null,O=null){this.Maa=K;this.HOb=P.a.kVg(M,O);"undefined"!==typeof CommonUiStrings&&this.HOb.push(CommonUiStrings);"undefined"!==typeof CommonUIStrings&&this.HOb.push(CommonUIStrings);d.b();T.Aa=void 0===N||null===N?e.AFrameworkApplication.ub:N;void 0!==I&&null!==I||this.HMd()}HMd(){Object(m.a)("SignoutLink");Object(m.a)("SignIn")}static get y3d(){return T.Kma||(T.Kma=c.a.instance.resolve("Common.App.Header.HeaderEventSource"))}static TLh(K,M,N,I,O,Q){return new G(T.rKb,n.a.jIf,n.a.PBc,
n.a.nIf,n.a.lIf,n.a.kIf,n.a.oIf,n.a.nob,K,M,N,I,O,Q,null,null)}static rQf(K){K.C2a&&(T.hTd(K.C2a),K.C2a=null);K.Rhc&&(T.gTd(),K.Rhc=null);K.feb&&(T.iTd(K.feb),K.feb=null);T.y3d.O9g();let M;({kgb:M}=r.a.Rib(!1)).returnValue&&h.a.Uza(M)}static YIb(){e.AFrameworkApplication.ub.Eb(n.a.YIb,2)}static gTd(){e.AFrameworkApplication.ZWb&&z.EventHandlerManager.instance.ric(e.AFrameworkApplication.ZWb)}static addButton(K,M,N,I,O,Q,U,ba){M=x.a(K,M,N,I,null,null,null,Q,null,null,void 0,void 0,O);(K=ba.hostControl(K,
M,Q))&&U.appendChild(K);return K}static OVb(K,M,N,I,O){let Q;I?(Q=document.createElement("a"),Q.href=I,Q.target="_top",v.a.instance.aib(A.a.click,Q,T.Fte,null,!0)):O?(Q=document.createElement("div"),Q.tabIndex=0):Q=document.createElement("span");Q.className="BreadcrumbItem"+(O?" Selectable":"");Q.id=M;Q.innerText=N;Q.setAttribute("dir","auto");K.appendChild(Q);return Q}static hTd(K){K.STb&&z.EventHandlerManager.instance.zwh(K.STb)}static Fte(K){const M=u.a.instance.Vo(n.a.DCf);M.properties.add("id",
K.Wj.id);M.end();b.ULS.sendTraceTag(595732178,207,50,"Breadcrumb link clicked: {0}",{["id"]:K.Wj.id});return T.zMb?T.zMb(K):!1}static iTd(K){v.a.instance.IOe(A.a.click,K,T.pve,!0)}static pve(){e.AFrameworkApplication.Lic?(e.AFrameworkApplication.Ha.FEb(e.AFrameworkApplication.Ha.Ib.X0d()),e.AFrameworkApplication.Lic=!1):window.top.location=e.AFrameworkApplication.signInUrl;return!0}static eub(){return!!e.AFrameworkApplication.Ha&&e.AFrameworkApplication.Ha.Ib.eub}}T.Kma=null;T.Klh="ShareServerWhite_20x20x32";
T.Tkc="ExternalHeaderFullTopBars";T.OXe="HeaderTopBars";T.pkc="BreadcrumbBrand";T.qkc="BreadcrumbFolder";T.rkc="BreadcrumbTitle";T.Pkd="FolderSeparator";T.j7e="sbTellMe";T.w6e="TellMe-SearchBox";T.Cqd="btnOpenInClient";T.Noc="btnFileSharing";T.woh="BasicChat";T.mxa="btnReplyWithChanges";T.Jkd="jbtnGiveFeedback";T.rKb="PeoplesWellControl";T.ORf="EditableBreadcrumbItem";T.Aa=null;T.zMb=null;T.ked=50;T.mag=null;Object(y.a)(T,"CuiHelper",null,[725])},332:function(y,C,a){a.d(C,"f",function(){return G});
a.d(C,"e",function(){return w});a.d(C,"d",function(){return F});a.d(C,"c",function(){return H});a.d(C,"g",function(){return E});a.d(C,"b",function(){return P});a.d(C,"a",function(){return T});a.d(C,"h",function(){return K});var c=a(291),b=a(928),d=a(1740),e=a(64),h=a(240),n=a(41);y=a(0);class m{constructor(){this.g=this.b=0;this.hex=null;this.r=0}}Object(y.a)(m,"RecentColor",null,[]);var k=a(217),l=a(201),u=a(209),r=a(266),x=a(790),v=a(465),z=a(40),A=a(373),B=a(42);const G=(N,I,O,Q,U,ba,aa)=>w(N,
I,O,Q,U,ba,aa,!1),w=(N,I,O,Q,U,ba,aa,La)=>{I=Object.assign(new c.a,{Id:I,ControlsId:O,Title:ResourceStrings.L_ThemeFontColor,ControlList:[]});Q=Object.assign(new b.a,{Id:Q,ExternalId:U,McuExternalId:String.format("{0}MCU",U),McuLayout:!0,Command:ba,Width:10});if(N)if(U=[],1===aa||2===aa){La=(new x.a).y_f(N);({themeColors:N,Ehc:aa}=M(La,N));for(var Z=0;6>Z;Z++)for(var la=0;la<N.length;la++){ba=U;O=ba.push;var da=La;var J=N[la][Z],Ca=N[la][0],Fa=aa[la],ya=Z,Ua=la;J=e.a.qt(J.r,2)+e.a.qt(J.g,2)+e.a.qt(J.b,
2);const {sfb:Ia,yX:Oa}=da.WYb(Ca,J,Fa,ya,Ua);da=Object.assign(new d.a,{Color:"#"+Ia,DisplayColor:"#"+J,Alt:Oa});O.call(ba,da)}}else for(La=(new x.a).qYd(N,La),{themeColors:N,Ehc:aa}=M(La,N),Z=0;6>Z;Z++)for(la=0;la<N.length;la++){ba=U;O=ba.push;da=La;J=N[la][Z];Ca=N[la][0];Fa=aa[la];ya=Z;Ua=la;J=e.a.qt(J.r,2)+e.a.qt(J.g,2)+e.a.qt(J.b,2);const {sfb:Ia,yX:Oa}=da.WYb(Ca,J,Fa,ya,Ua),{rgb:ma,ahh:za,yX:Qa}={rgb:J,ahh:Ia,yX:Oa};da=Object.assign(new d.a,{Color:za,DisplayColor:"#"+ma,Alt:Qa});O.call(ba,da)}else U=
null;Q.Colors=U;Array.add(I.ControlList,Q);return I},F=(N,I,O,Q,U,ba)=>{N=Object.assign(new c.a,{Id:N,ControlsId:I,Title:ResourceStrings.L_StandardFontColor,ControlList:[]});O=Object.assign(new b.a,{Id:O,ExternalId:Q,Command:U,Width:10,Colors:[]});ba?(O.Colors.push(Object.assign(new d.a,{Color:"0000C0",Alt:e.a.We(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),O.Colors.push(Object.assign(new d.a,{Color:"0000FF",Alt:e.a.We(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),O.Colors.push(Object.assign(new d.a,
{Color:"00C0FF",Alt:e.a.We(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),O.Colors.push(Object.assign(new d.a,{Color:"00FFFF",Alt:e.a.We(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),O.Colors.push(Object.assign(new d.a,{Color:"50D092",Alt:e.a.We(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),O.Colors.push(Object.assign(new d.a,{Color:"50B000",Alt:e.a.We(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),O.Colors.push(Object.assign(new d.a,
{Color:"F0B000",Alt:e.a.We(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),O.Colors.push(Object.assign(new d.a,{Color:"C07000",Alt:e.a.We(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),O.Colors.push(Object.assign(new d.a,{Color:"602000",Alt:e.a.We(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),O.Colors.push(Object.assign(new d.a,{Color:"A03070",Alt:e.a.We(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"}))):(O.Colors.push(Object.assign(new d.a,
{Color:"#C00000",Alt:e.a.We(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),O.Colors.push(Object.assign(new d.a,{Color:"#FF0000",Alt:e.a.We(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),O.Colors.push(Object.assign(new d.a,{Color:"#FFC000",Alt:e.a.We(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),O.Colors.push(Object.assign(new d.a,{Color:"#FFFF00",Alt:e.a.We(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),O.Colors.push(Object.assign(new d.a,{Color:"#92D050",
Alt:e.a.We(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),O.Colors.push(Object.assign(new d.a,{Color:"#00B050",Alt:e.a.We(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),O.Colors.push(Object.assign(new d.a,{Color:"#00B0F0",Alt:e.a.We(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),O.Colors.push(Object.assign(new d.a,{Color:"#0070C0",Alt:e.a.We(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),O.Colors.push(Object.assign(new d.a,{Color:"#002060",
Alt:e.a.We(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),O.Colors.push(Object.assign(new d.a,{Color:"#7030A0",Alt:e.a.We(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"})));Array.add(N.ControlList,O);return N},H=(N,I,O,Q,U,ba,aa)=>{I=Object.assign(new c.a,{Id:I,ControlsId:O,Title:ResourceStrings.L_RecentColors,ControlList:[]});Q=Object.assign(new b.a,{Id:Q,ExternalId:U,Command:ba,Width:10,Colors:[]});if(aa)for(aa=0;N&&aa<N.length&&N[aa];aa++)U=N[aa],Q.Colors.push(Object.assign(new d.a,
{Color:U.hex,Alt:e.a.We(U.hex),DisplayColor:U.hex}));else for(aa=0;N&&aa<N.length&&N[aa];aa++)U=N[aa],Q.Colors.push(Object.assign(new d.a,{Color:"#"+U.hex,Alt:A.a.old("#"+U.hex).toString(),DisplayColor:"#"+U.hex}));Array.add(I.ControlList,Q);return I},E=(N,I)=>{if(!I)return N;var O=new m;O.hex=I;const Q=[];let U=0;Q[U++]=O;for(O=0;N&&O<N.length&&10>O&&10>U&&N[O];O++)N[O].hex!==I&&(Q[U++]=N[O]);return Q},P=(N,I,O,Q,U,ba,aa,La)=>{N=Object.assign(new c.a,{Id:N,ControlsId:I,DisplayMode:"Menu16",ControlList:[]});
O=Object.assign(new h.a,{Command:O,LabelText:Q,Image16by16:n.AFrameworkApplication.Ln,Image16by16Class:aa,Id:U,ExternalId:ba,KeyTip:La});Array.add(N.ControlList,O);return N},T=(N,I,O,Q,U,ba,aa,La)=>{N=Object.assign(new c.a,{Id:N,ControlsId:I,DisplayMode:"Menu16",ControlList:[]});O=Object.assign(new h.a,{Command:O,LabelText:Q,Image16by16:n.AFrameworkApplication.Ln,Image16by16Class:aa,Id:U,ExternalId:ba,KeyTip:La});Array.add(N.ControlList,O);return N},K=(N,I,O)=>{for(let da=0;da<N.MenuSectionList.length;da++){var Q=
N.MenuSectionList[da],U=Q.ControlList;if(U&&0<U.length&&(U=U[0]))if(I)if(Q.Id===v.a.themeColors&&O){var ba=u.i(I.ZB)||"";Q=O;var aa=U.Colors,La="#";if(aa&&aa.length)if(e.a.wb(ba))z.a.$(508694662,820,10,"selectedFontColor should not be empty in FindSelectedThemeColor");else for(var Z=0;Z<aa.length;Z++){var la=aa[Z].Color;if(!e.a.wb(la)&&(la=(la=l.a.parse(aa[Z].Color))?la.LZa():r.SchemeColor.parse(aa[Z].Color),Q&&la&&la.Erd(Q)&&la.ina&&(la=u.i(la.BO),la.toLowerCase()===ba.toLowerCase()))){La=aa[Z].Color;
break}}Q=La;U.SelectedColorId=Q}else{aa=u.i(u.g(I.ZB))||"";Q=U.Colors;ba="#";if(Q&&Q.length)if(e.a.wb(aa))z.a.$(508694661,820,10,"selectedFontColor should not be empty in FindSelectedStandardColor");else for(La=0;La<Q.length;La++)if(Z=Q[La].DisplayColor,!e.a.wb(Z)&&Z.replace("#","").toLowerCase()===aa.toLowerCase()){ba=Q[La].Color;break}Q=ba;U.SelectedColorId=Q}else U.SelectedColorId="#"}},M=(N,I)=>{if(B.a("PPTO_PICTURES_BUG_7720204_PERF_FIX")&&(!I||null===I.PresetSchemeColorMapping))return{themeColors:[],
Ehc:[]};const O=Array(10);O[0]=N.Dw(k.Color.Bh(I.PresetSchemeColorMapping.Background1));O[1]=N.Dw(k.Color.Bh(I.PresetSchemeColorMapping.Text1));O[2]=N.Dw(k.Color.Bh(I.PresetSchemeColorMapping.Background2));O[3]=N.Dw(k.Color.Bh(I.PresetSchemeColorMapping.Text2));O[4]=N.Dw(k.Color.Bh(I.PresetSchemeColorMapping.Accent1));O[5]=N.Dw(k.Color.Bh(I.PresetSchemeColorMapping.Accent2));O[6]=N.Dw(k.Color.Bh(I.PresetSchemeColorMapping.Accent3));O[7]=N.Dw(k.Color.Bh(I.PresetSchemeColorMapping.Accent4));O[8]=N.Dw(k.Color.Bh(I.PresetSchemeColorMapping.Accent5));
O[9]=N.Dw(k.Color.Bh(I.PresetSchemeColorMapping.Accent6));N=Array(10);N[0]=ResourceStrings.l_ThemeLabel1;N[1]=ResourceStrings.l_ThemeLabel2;N[2]=ResourceStrings.l_ThemeLabel3;N[3]=ResourceStrings.l_ThemeLabel4;N[4]=ResourceStrings.l_ThemeLabel5;N[5]=ResourceStrings.l_ThemeLabel6;N[6]=ResourceStrings.l_ThemeLabel7;N[7]=ResourceStrings.l_ThemeLabel8;N[8]=ResourceStrings.l_ThemeLabel9;N[9]=ResourceStrings.l_ThemeLabel10;return{themeColors:O,Ehc:N}}},370:function(y,C,a){a.d(C,"a",function(){return c});
y=a(0);var c;(function(b){b[b.unknown=0]="unknown";b[b.excel=1]="excel";b[b.powerPoint=2]="powerPoint";b[b.word=3]="word";b[b.oneNote=4]="oneNote";b[b.LAh=5]="visio"})(c||(c={}));Object(y.b)("OfficeAppType",c)},373:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);var c=a(217);class b{}var d=b;b.ksd={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",
brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",
darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",
lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",
mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",
powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",
yellow:"#ffff00",yellowgreen:"#9acd32"};b.w$=e=>{e=e.toLowerCase().trim().replace(/\s/g,"");return b.ksd[e]?b.ksd[e]:""};b.cjd=e=>e?""!==d.w$(e):!1;b.old=e=>{var h=/^#([0-9a-f])*$/i;if(!e||!e.match(h))throw Error("invalid hex color string provided");h=new c.Color;switch(e.length){case 7:h.a=1;h.r=parseInt(e.substring(1,3),16);h.g=parseInt(e.substring(3,5),16);h.b=parseInt(e.substring(5,7),16);break;case 9:h.r=parseInt(e.substring(1,3),16);h.g=parseInt(e.substring(3,5),16);h.b=parseInt(e.substring(5,
7),16);h.a=parseInt(e.substring(7,9),16);break;default:throw Error("unsupported color string provided");}return h};Object(y.a)(b,"ColorTranslator",null,[])},374:function(y,C,a){a.d(C,"a",function(){return e});y=a(0);var c=a(50);class b{constructor(h,n,m,k,l){this.Rwa=!1;this.K_e=h;this.n_e=n;this.yee=m;this.ZEn=l;this.p0e=k.GIb(m,n.name)}get WGh(){return this.yee}oc(h){this.p0e.MGh();this.n_e.oc(h);this.p0e.EJh()}init(){this.p0e.CJ(this.n_e.name+"_d");this.ZEn?this.K_e.u8l(this,this.yee):this.K_e.t8l(this,
this.yee)}s8l(){this.p0e.FJ(this.n_e.name+"_d");this.p0e.NGh();this.n_e.init();this.Rwa=!0;this.p0e.GJh()}dispose(){this.Rwa&&this.n_e.dispose()}get name(){return this.n_e.name}}Object(y.a)(b,"DelayLoadedPackage",null,[623,4,5]);class d{constructor(h,n){this.K_e=null;h.execute(m=>{this.K_e=m});this.DDn=n}create(h,n,m){return this.K_e?new b(this.K_e,h,n,this.DDn.value,m):h}static get instance(){return d.Qa||(d.Qa=new d(c.a.instance.eb("PowerPointWebEditor.DelayLoadedPackageInitializer"),c.a.instance.he("PowerPointWebEditor.Core.IBundleMetricRecorder")))}}
d.Qa=null;Object(y.a)(d,"DelayLoadedPackageFactory",null,[]);const e=(h,n)=>d.instance.create(h,n,!1)},401:function(y,C,a){a.d(C,"a",function(){return d});a.d(C,"b",function(){return e});a.d(C,"c",function(){return h});var c=a(41),b=a(370);const d=()=>{const n=c.AFrameworkApplication.Ha.Ib.Dm;return(3===n||1===n||2===n||4===n)&&c.AFrameworkApplication.ha.getBooleanAppSetting("PremiumUpsellIsEnabled")},e=(n,m,k,l=!1)=>{m=1===m;1===n&&(m=2===c.AFrameworkApplication.Ha.mode);return String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",
b.a[n],m?"Editor":"Viewer",l?"Dime":"Unknown",k?k:"dimedefault")},h=n=>{switch(n){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";default:return null}}},416:function(y,C,a){a.d(C,"b",function(){return m});a.d(C,"h",function(){return k});a.d(C,"d",function(){return l});a.d(C,"g",function(){return u});a.d(C,"f",function(){return x});a.d(C,"e",function(){return v});a.d(C,"c",function(){return z});a.d(C,"a",function(){return A});
var c=a(41);a(500);var b=a(559),d=a(401);a(10);var e=a(69),h=a(59),n;const m=()=>c.AFrameworkApplication.XV,k=()=>{const B=c.AFrameworkApplication.Ha.Ib.PO;return!m()&&!c.AFrameworkApplication.hideHeader&&d.a()&&(B||1===c.AFrameworkApplication.yWe)},l=()=>c.AFrameworkApplication.ha.getBooleanAppSetting("DiscoverPremiumButtonEnabled"),u=()=>c.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AnonymousSignInButtonExperiment",!1)&&c.AFrameworkApplication.ha.getBooleanAppSetting("IsAnonymousUser"),
r=()=>c.AFrameworkApplication.Wsd&&!m()&&!c.AFrameworkApplication.hideHeader,x=()=>r()&&"officecomhwa"!==(c.AFrameworkApplication.ha.Ma(c.AFrameworkApplication.DF)||"").toLowerCase()&&!c.AFrameworkApplication.pmd&&!e.a.oZe,v=()=>!c.AFrameworkApplication.Alc&&r(),z=()=>!m()&&!c.AFrameworkApplication.hideHeader&&c.AFrameworkApplication.ha.getBooleanAppSetting("BasicChatIsEnabled"),A=()=>{if(c.AFrameworkApplication.smd)return null;var B=!!c.AFrameworkApplication.Ha&&c.AFrameworkApplication.Ha.Ib.PO;
if((c.AFrameworkApplication.Ulc&&c.AFrameworkApplication.nxa||c.AFrameworkApplication.Vib)&&B)return Object.assign(new b.a,{command:"1197060601",label:Object(h.a)("ReplyWithChanges"),id:a(294).CuiHelperStatic.mxa});if(c.AFrameworkApplication.VLb){B="";switch(c.AFrameworkApplication.ajb){case "Assign":B=Object(h.a)("Assign");break;case "Submit":B=Object(h.a)("Submit")}if(""!==B)return Object.assign(new b.a,{command:"2988588587",label:B,id:"btnWorkflow"})}return null};null===(n=c.AFrameworkApplication.ha)||
void 0===n||n.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HeaderPlaceholderAddNewUx",!1)},419:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);a=a(30);class c extends a.a{constructor(b){super();this._element=null;this.element=b}get element(){return this._element}set element(b){this._element=b}get visible(){return"visible"===this.element.style.visibility}set visible(b){this.element.style.visibility=b?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(b){this.element.dir=
b?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(b){this.element.style.zIndex=String(b)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(b){return this.element.ownerDocument.createElement(b)}G1(){return!0}static iVe(b,d){return b+(d?"Rtl":"")}}Object(y.a)(c,"BasePresenceControl",a.a,[40,624])},420:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c extends Sys.EventArgs{constructor(b,
d){super();this.type=b;this.jh=d}}c.JJ="InteractivityChanged";Object(y.a)(c,"InteractivityChangedEventArgs",Sys.EventArgs,[])},465:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}c.themeColors="Theme Colors";Object(y.a)(c,"ReactColorConstants",null,[])},495:function(y,C,a){a.d(C,"a",function(){return b});var c=a(164);const b=(d,e,h)=>{const n=new c.a;n.Ue=0;n.h6(d,e,h);return n}},502:function(y,C,a){a.d(C,"a",function(){return l});y=a(0);var c=a(21),b=a(64),d=a(809),e=a(217),h=a(201),
n=a(209),m=a(413);class k{constructor(u,r){this.zua=u;this.description=r}}Object(y.a)(k,"ColorEntry",null,[]);class l{constructor(u){this.z4b={};this.l9b=null;this.Vk=u}get jph(){if(!this.l9b){const u=new Sys.StringBuilder;for(const r of this.standardColors)u.append(String.format(l.bUb,this.Atd(r.zua),this.Shc(r.zua),r.description));this.l9b=u.toString()}return this.l9b}get standardColors(){let u;return u=new c.a,u.add(new k(12582912,ResourceStrings.L_FontColorDarkRed)),u.add(new k(16711680,ResourceStrings.L_FontColorRed)),
u.add(new k(16760832,ResourceStrings.L_FontColorOrange)),u.add(new k(16776960,ResourceStrings.L_FontColorYellow)),u.add(new k(9621584,ResourceStrings.L_FontColorLightGreen)),u.add(new k(45136,ResourceStrings.L_FontColorDarkGreen)),u.add(new k(45296,ResourceStrings.L_FontColorLightBlue)),u.add(new k(28864,ResourceStrings.L_FontColorBlue)),u.add(new k(8288,ResourceStrings.L_FontColorDarkBlue)),u.add(new k(7352480,ResourceStrings.L_FontColorPurple)),u}Atd(u){return String.format("#{0}",n.i(u))}Shc(u){return n.i(u)}LZa(u){return Object.assign(new h.a,
{ThemeColor:u.ThemeColor,ColorLuminance:u.ColorLuminance,FTintColor:u.FTintColor}).toString()}yKc(u,r,x){const v=new Sys.StringBuilder;v.append(this.XTb("ThemeColors",ResourceStrings.L_ThemeFontColor,"ColorPicker",!0,u));this.bxf(v);v.append(this.WTb());v.append(this.XTb("StandardColors",ResourceStrings.L_StandardFontColor,"ColorPicker",!1,u));v.append(this.jph);v.append(this.WTb());r&&0<r.length&&(v.append(this.XTb("RecentColors",ResourceStrings.L_RecentColors,"ColorPicker",!1,x)),v.append(this.O4f(r)),
v.append(this.WTb()));return v.toString()}O4f(u){const r=new Sys.StringBuilder;for(let x=0;x<u.length;x++){const v=u[x];r.append(String.format(l.bUb,"#"+v.hex,v.hex,"#"+v.hex))}return r.toString()}XTb(u,r,x,v,z){return String.format(l.YDf,u,r,x,v?'McuLayout = "true" ':"",z)}WTb(){return l.XDf}bxf(u){const r=Array(10);r[0]=this.Dw(e.Color.Bh(this.Vk.PresetSchemeColorMapping.Background1));r[1]=this.Dw(e.Color.Bh(this.Vk.PresetSchemeColorMapping.Text1));r[2]=this.Dw(e.Color.Bh(this.Vk.PresetSchemeColorMapping.Background2));
r[3]=this.Dw(e.Color.Bh(this.Vk.PresetSchemeColorMapping.Text2));r[4]=this.Dw(e.Color.Bh(this.Vk.PresetSchemeColorMapping.Accent1));r[5]=this.Dw(e.Color.Bh(this.Vk.PresetSchemeColorMapping.Accent2));r[6]=this.Dw(e.Color.Bh(this.Vk.PresetSchemeColorMapping.Accent3));r[7]=this.Dw(e.Color.Bh(this.Vk.PresetSchemeColorMapping.Accent4));r[8]=this.Dw(e.Color.Bh(this.Vk.PresetSchemeColorMapping.Accent5));r[9]=this.Dw(e.Color.Bh(this.Vk.PresetSchemeColorMapping.Accent6));const x=Array(10);x[0]=ResourceStrings.l_ThemeLabel1;
x[1]=ResourceStrings.l_ThemeLabel2;x[2]=ResourceStrings.l_ThemeLabel3;x[3]=ResourceStrings.l_ThemeLabel4;x[4]=ResourceStrings.l_ThemeLabel5;x[5]=ResourceStrings.l_ThemeLabel6;x[6]=ResourceStrings.l_ThemeLabel7;x[7]=ResourceStrings.l_ThemeLabel8;x[8]=ResourceStrings.l_ThemeLabel9;x[9]=ResourceStrings.l_ThemeLabel10;for(let v=0;5>=v;v++)for(let z=0;z<r.length;z++)u.append(this.SYf(r[z][v],r[z][0],x[z],v,z))}Dw(u){const r=b.a.qt(u.r,2)+b.a.qt(u.g,2)+b.a.qt(u.b,2);if(this.z4b[r])return this.z4b[r];const x=
m.HSLColor.XAa(u),v=[];Array.add(v,u);if(u.Ikd())for(var z=0;z<d.a.QQe.length;++z)u=m.HSLColor.ZXa(x),u.darken(d.a.QQe[z]/100),Array.add(v,u.E$());else if(u.YJh())for(z=0;z<d.a.eMd.length;++z)u=m.HSLColor.ZXa(x),u.lighten(d.a.eMd[z]/100),Array.add(v,u.E$());else if(x.lum<l.ODf)for(z=0;z<d.a.sde.length;++z)u=m.HSLColor.ZXa(x),u.lighten(d.a.sde[z]/100),Array.add(v,u.E$());else if(x.lum>l.NDf)for(z=0;z<d.a.rde.length;++z)u=m.HSLColor.ZXa(x),u.darken(d.a.rde[z]/100),Array.add(v,u.E$());else for(z=0;z<
d.a.pob.length+d.a.ZOd.length;++z)u=m.HSLColor.ZXa(x),z<d.a.pob.length?u.lighten(d.a.pob[z]/100):u.darken(d.a.ZOd[z-d.a.pob.length]/100),Array.add(v,u.E$());return this.z4b[r]=v}SYf(u,r,x,v,z){u=this.Shc(u.zua);const {sfb:A,yX:B}=this.WYb(r,u,x,v,z);return String.format(l.bUb,A,u,B)}WYb(u,r,x,v,z){var A;var B=A=null;if(0>v)return{sfb:A,yX:B};r=Object.assign(new h.a,{RGBColor:r,ThemeColor:z,ColorLuminance:0,FTintColor:!1});v?(z=m.HSLColor.XAa(u),B=v-1,z.lum?1===z.lum?(v=!1,B=[242,217,191,166,127][B]):
.8<z.lum?(v=!1,B=[229,191,127,64,25][B]):.2>z.lum?(v=!0,B=[25,64,127,191,229][B]):(z=[51,102,153],A=[191,127],B=(v=B<z.length)?z[B]:A[B-z.length]):(v=!0,B=[127,166,191,217,242][B]),B=255-B,B=Math.round(100*B/255),r.ColorLuminance=100-B,r.FTintColor=v,B=String.format(v?ResourceStrings.l_ColorPickerTooltipTint:ResourceStrings.l_ColorPickerTooltipShade,u.toString(),x,B)):B=String.format(ResourceStrings.l_ColorPickerTooltipBase,u.toString(),x);A=this.LZa(r);return{sfb:A,yX:B}}}l.YDf='<MenuSection Id="{0}" Title="{1}"><Controls Id="Color.Menu.Controls"><ColorPicker Id="{2}" {3}Width="10" Command="{4}"><Colors>';
l.XDf="</Colors></ColorPicker></Controls></MenuSection>";l.bUb='<Color Color="{0}" DisplayColor="#{1}" Alt="{2}" />';l.ODf=.2;l.NDf=.8;Object(y.a)(l,"ColorPickerBuilder",null,[])},557:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}c.open="open";c.refresh="refresh";c.zgh="saveAs";c.translate="translate";c.modeSwitch="modeSwitch";c.oTi="createNew";c.convert="convert";Object(y.a)(c,"ReasonList",null,[])},559:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.keytip=
this.id=this.image=this.label=this.command=null}}Object(y.a)(c,"HeaderButtonInfo",null,[])},560:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}Object(y.a)(c,"RibbonPeripheralSection",null,[])},575:function(y,C,a){a.d(C,"a",function(){return b});y=a(0);var c=a(1263);class b{constructor(d){this.Sm=new c.a;this.Jpd=d}fca(d){const e=d.id;let h=null;this.Sm.Sb(e)?h=this.Sm.ka(e):(this.Jpd&&(h=this.Jpd(d,()=>{this.sbh(e)})),h&&this.Sm.fa(e,h));return h}J7(d){d=d.id;return this.Sm.Sb(d)?
this.Sm.ka(d):null}sbh(d){this.Sm.remove(d)}}Object(y.a)(b,"ShapeComponentViewManager",null,[525])},756:function(y,C,a){a.d(C,"a",function(){return b});a.d(C,"b",function(){return e});var c=a(8);a(1187);const b=n=>d(n),d=n=>new Promise((m,k)=>{n.continueWith(l=>{l.Om?k(l.Cj.message):l.Nn?k(c.a.Gjd()):m(null)})}),e=n=>h(n),h=n=>new Promise((m,k)=>{n.continueWith(()=>{n.Om?k(n.Cj.message):n.Nn?k(c.a.Gjd()):m(n.result)})})},764:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{constructor(){this.message=
this.title=null;this.mmd=!1;this.Xhb=null;this.nmd=!1;this.xoc=null;this.shh=this.q7g=0;this.uhh=this.r7g=null;this.timeoutInSeconds=0;this.S$f=!1;this.zwa=null}}Object(y.a)(c,"CalloutNotificationMessageAttributes",null,[])},790:function(y,C,a){a.d(C,"a",function(){return h});y=a(0);var c=a(41),b=a(502),d=a(209);class e extends b.a{constructor(n,m){super(n);this.Eqg=m}Atd(n){return d.i(d.g(n))}Shc(n){return d.i(n)}LZa(n){return this.Eqg?n.kUe:n.LZa().toString()}UGh(n,m,k){const l=new Sys.StringBuilder;
l.append(String.format('<Menu Id="{0}">',"menuFontColor"));l.append(this.yKc(n,m,k));l.append('<MenuSection Id="More Font Colors"><Controls Id="Color.Menu.Controls">');l.append(String.format('<Button Id="Color.Menu.MoreFontColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />',"862825906",c.AFrameworkApplication.Ln,ResourceStrings.l_MoreFontColors,ResourceStrings.l_MoreFontColorsKeytip));l.append("</Controls> </MenuSection>");l.append("</Menu>");
return l.toString()}}Object(y.a)(e,"ColorMenuBuilder",b.a,[]);class h{y_f(n){return new b.a(n)}qYd(n,m){return new e(n,m)}}Object(y.a)(h,"ColorPickerBuilderFactory",null,[765])},833:function(y,C,a){a.d(C,"a",function(){return c});y=a(0);class c{}c.IsFreeForm="IsFreeForm";c.Value="Value";c.Key="Key";c.FontStyle="FontStyle";Object(y.a)(c,"ComboBoxCommandProperties",null,[])},834:function(y,C,a){a.d(C,"a",function(){return k});y=a(0);var c=a(315),b=a(41),d=a(366),e=a(197),h=a(111),n=a(85),m=a(294);class k{static qib(l){const {yth:u,
zth:r}=k.cWf();k.Ngh(u,r,l)}static cWf(){({kgb:u}=d.a.Rib(!b.AFrameworkApplication.cL));var l=$get(c.a.OXe);if(u)var u=document.getElementById(c.a.Tkc);else u=l.childNodes[0],l=l.childNodes[1];return{yth:u,zth:l}}static Ngh(l,u,r){if(l&&u&&0<u.clientHeight){const x=-1!==u.parentNode.parentNode.className.indexOf("cui-ribbon");k.nsd(l,u,r,x)}}static nsd(l,u,r,x){let v=null,z=null,A=null,B=null,G=null,w=null,F=null,H=null,E=null,P=null,T=null,K=null,M=null,N=null,I=null,O=null,Q=null,U=null,ba=null,
aa=null;({tkd:v,skd:z,ukd:A,mIa:B,nIa:G,jwa:w,DO:F,xu:H,kwa:E,iM:P,lwa:T,vkd:aa}=k.Kkd(l,v,z,A,B,G,w,F,H,E,P,T,aa));({Efb:K,lE:M,rkd:N,pkd:I,oIa:O,UXa:Q,VXa:U,qkd:ba}=k.Lkd(u,K,M,N,I,O,Q,U,ba));l=[v,z,A,B,G,w,F,H,E,P,T,N,I,O,Q,U,ba,aa];for(var La of l)k.znh(La);La=[v,z,A,G,F,H,P,T,I,Q,U,ba];for(const Z of La)k.sic(Z);k.QEe(z);k.Esd(M,0);k.iTf(v,z,A,B,G,w,F,H,E,P,T,K,M,N,I,O,Q,U,ba,aa,x,r);k.jyf(w,F)}static YYh(l,u){k.nsd(l,null,u,!1)}static jyf(l,u){l&&u&&(l.style.marginTop=(u.offsetHeight-l.offsetHeight)/
2+"px")}static Kkd(l,u,r,x,v,z,A,B,G,w,F,H,E){for(let P=0;l&&P<l.childNodes.length;P++){const T=l.childNodes[P],K=h.a.Iia(T),M=!!T.id;-1!==K.indexOf("cui-QATRowLeft")?u=T:-1!==K.indexOf("cui-QATRowCenter")?r=T:-1!==K.indexOf("cui-QATRowRight")?x=T:-1!==K.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?v=T:T.id===c.a.pkc?z=T:T.id===c.a.Pkd?A=T:T.id===c.a.qkc?B=T:T.id===c.a.rkc?G=T:M&&k.Vfg(T)?w=T:-1!==K.indexOf("UsernameNameContainer")?F=T:-1!==K.indexOf("UsernameNameItem")?H=T:-1!==K.indexOf("FreemiumUpsellButton")&&
(E=T);({tkd:u,skd:r,ukd:x,mIa:v,nIa:z,jwa:A,DO:B,xu:G,kwa:w,iM:F,lwa:H,vkd:E}=k.Kkd(T,u,r,x,v,z,A,B,G,w,F,H,E))}return{tkd:u,skd:r,ukd:x,mIa:v,nIa:z,jwa:A,DO:B,xu:G,kwa:w,iM:F,lwa:H,vkd:E}}static Lkd(l,u,r,x,v,z,A,B,G){for(let w=0;l&&w<l.childNodes.length;w++){const F=l.childNodes[w],H=h.a.Iia(F),E=!!F.id;-1!==H.indexOf("cui-jewel-container")?u=F:-1!==H.indexOf("cui-tts")?r=F:-1!==H.indexOf("cui-TabRowInline")?v=F:-1!==H.indexOf("cui-TabRowRight")?G=F:-1!==H.indexOf("cui-separator")?x=F:E&&F.id.startsWith(c.a.Cqd)&&
!z?z=F:E&&F.id.startsWith(c.a.Jkd)?A=F:E&&F.id.startsWith(c.a.rKb)&&(B=F);({Efb:u,lE:r,rkd:x,pkd:v,oIa:z,UXa:A,VXa:B,qkd:G}=k.Lkd(F,u,r,x,v,z,A,B,G))}return{Efb:u,lE:r,rkd:x,pkd:v,oIa:z,UXa:A,VXa:B,qkd:G}}static Mgh(l,u,r,x,v,z,A,B,G){k.Pz(l,u,G)&&(k.lgb(u),k.Pz(l,u,G)&&k.lgb(u));k.Pz(u,x,G)&&(k.Ew(r),k.Ew(v),k.Pz(u,x,G)&&(k.lgb(u),k.Pz(u,x,G)&&(k.lgb(u),k.Pz(u,x,G)&&k.Ew(x))));k.Pz(x,B,G)&&(k.Ew(r),k.Ew(v));l=[z,A,B];k.qmd(x,B,l,G);k.qmd(u,B,l,G)}static qmd(l,u,r,x){let v=0;for(;v<r.length&&k.Pz(l,
u,x);)k.Ew(r[v]),v++}static l5f(l){if(!l)return 0;if(void 0===l._scaleStep||null===l._scaleStep){let u=0;-1!==l.className.indexOf("cui-tts-scale1")?u=1:-1!==l.className.indexOf("cui-tts-scale2")&&(u=2);l._scaleStep=u}return parseInt(l._scaleStep)}static lgb(l){let u=k.l5f(l);2>u&&k.Esd(l,++u)}static Esd(l,u){l&&(l.className=k.pfh[u],l._scaleStep=u)}static Pz(l,u,r){return l&&u?n.a.RZe(n.a.ji(l),n.a.ji(u),r):!1}static gxa(l,u,r){let x=0;l&&u&&(x=n.a.und(n.a.ji(l),n.a.ji(u),r));return x}static vCc(l){for(let u=
0;l&&u<l.childNodes.length;u++)if(-1!==l.childNodes[u].className.indexOf("cui-cg"))return!0;return!1}static oIc(l){let u=null;for(let r=l.childNodes.length-1;l&&0<=r;r--){const x=l.childNodes[r];if(-1===x.className.indexOf("cui-cg"))break;u=x}return u}static Exa(l,u,r){if(l&&!k.Kl(l)){var x=e.a.ps(l);x=h.a.aE(x.paddingLeft)+h.a.aE(x.paddingRight);r=l.offsetWidth-r-x;let v=0;for(;u&&u!==l;)(x=e.a.ps(u))&&(v+=h.a.aE(x.paddingLeft)+h.a.aE(x.paddingRight)),u=u.parentNode;r=Math.max(r,75+v);l.style.width=
r+"px"}}static Vdh(l,u,r){if(l&&u){let x=0,v=0;({left:x,top:v}=n.a.SWe(u,x,v));k.aWg(l,r?x-l.offsetWidth:x+u.offsetWidth)}}static iTf(l,u,r,x,v,z,A,B,G,w,F,H,E,P,T,K,M,N,I,O,Q,U){Q&&k.Mgh(H,E,P,T,K,M,N,I,U);k.vCc(E)?k.Sgh(E,l,u,r,x,v,z,A,B,G,w,F,O,U):k.Rgh(l,u,r,x,v,z,A,B,G,w,F,O,U)}static Rgh(l,u,r,x,v,z,A,B,G,w,F,H,E){const P=!!v,T=!!A,K=!!B;let M=0;if((T||K)&&0<(M=k.gxa(l,u,E))){let N=T;K&&(!T||B.offsetWidth>A.offsetWidth)&&(N=!1);k.Exa(N?A:B,N?A:B,N?M:2*M);T&&K&&0<(M=k.gxa(l,u,E))&&k.Exa(N?A:
B,N?A:B,N?M:2*M)}if(T&&k.Pz(A,u,E)||P&&k.Pz(v,u,E))k.Ew(x),k.Ew(v),k.Ew(z),k.Ew(A),K&&(k.sic(u),k.sic(B));k.Krd(u,r,B,G,w,F,H,E);K&&k.djd(B,l,r,E)}static Sgh(l,u,r,x,v,z,A,B,G,w,F,H,E,P){const T=!!B,K=!!G,M=!!w,N=!!E,I=k.oIc(l);0<(u=k.gxa(u,I,P))&&(T&&k.Exa(B,B,u),!T||k.Pz(B,I,P))&&(k.Ew(v),k.Ew(z),k.Ew(A),k.Ew(B));k.Pz(l,r,P)&&k.Vdh(r,l,P);k.Krd(r,x,G,w,F,H,E,P);0<(u=k.gxa(l,x,P))&&(k.Exa(F,H,u),N&&k.Pz(l,x,P)&&k.Ew(E),M&&k.Pz(l,x,P)&&k.Ew(w));K&&!k.Kl(r)&&k.djd(G,l,x,P)}static Krd(l,u,r,x,v,z,A,
B){const G=!!r,w=!!x,F=!!v,H=!!A;let E=0;if((G||F)&&0<(E=k.gxa(l,u,B))){const P=!!l&&"absolute"!==l.style.position;let T=G;F&&(!G||v.offsetWidth>r.offsetWidth)&&(T=!1);k.Exa(T?r:v,T?r:z,T&&P?2*E:E);G&&F?(0<(E=k.gxa(l,v,B))&&(T=!T,k.Exa(T?r:v,T?r:z,T&&P?2*E:E)),k.Pz(l,v,B)&&k.Ew(l)):G&&k.Pz(l,u,B)&&k.Ew(l)}H&&k.Pz(l,u,B)&&k.Ew(A);w&&k.Pz(l,u,B)&&k.Ew(x)}static Kl(l){if(!l)return!0;l=l._isHidden;return!(void 0===l||null===l||"0"===l)}static Ew(l){l&&!k.Kl(l)&&(l.style.display="none",l._isHidden="1")}static znh(l){l&&
k.Kl(l)&&(l.style.display="",l._isHidden="0")}static sic(l){l&&(l.style.width="auto",l.style.maxWidth="none")}static aWg(l,u){l&&(l.style.position="absolute",l.style.left=u+"px")}static QEe(l){l&&(l.style.position="static",l.style.left="auto")}static djd(l,u,r,x){if(l&&l.parentNode&&l.parentNode.parentNode){var v=k.j4g(l);"auto"!==l.parentNode.style.width&&(l.style.width=l.parentNode.offsetWidth-v+"px");var z=x?r:u;u=x?u:r;r=n.a.ji(l.parentNode.parentNode);z=z?n.a.ji(z):new Sys.UI.Bounds(r.x,0,0,
0);u=u?n.a.owa(u):new Sys.UI.Point(r.x+r.width,0);"absolute"===l.parentNode.style.position?v=u.x-(z.x+z.width)-v-1:(r=n.a.ji(l.nextSibling?l.parentNode:l),r=r.x+r.width/2,v=2*Math.min(r-(z.x+z.width),u.x-r)-v-1);l.style.maxWidth=v+"px"}}static j4g(l){var u=e.a.ps(l);u=u?h.a.aE(u.paddingLeft)+h.a.aE(u.paddingRight):0;var r=e.a.ps(l.parentNode);r=r?h.a.aE(r.paddingLeft)+h.a.aE(r.paddingRight):0;let x=0;for(;l.nextSibling;)l=l.nextSibling,x+=l.offsetWidth;return u+r+x}static Vfg(l){return!!l.id&&(l.id.startsWith(c.a.Noc)||
l.id.startsWith(m.CuiHelperStatic.mxa))}}k.pfh=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(y.a)(k,"RibbonTabScalingActor",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/25649181/wdjs/ppteditDS.chronosslim.js.map