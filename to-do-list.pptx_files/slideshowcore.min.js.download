!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SlideShowCore=t():e.SlideShowCore=t()}(window,(function(){return function(e){function t(t){for(var i,n,a=t[0],s=t[1],o=0,d=[];o<a.length;o++)n=a[o],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&d.push(r[n][0]),r[n]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);for(l&&l(t);d.length;)d.shift()()}var i={},r={7:0};function n(t){if(i[t])return i[t].exports;var r=i[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.e=function(e){var t=[],i=r[e];if(0!==i)if(i)t.push(i[2]);else{var a=new Promise((function(t,n){i=r[e]=[t,n]}));t.push(i[2]=a);var s,o=document.createElement("script");o.charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.src=function(e){return n.p+""+({11:"vendors.DOMPurify",12:"vendors.HLS",13:"vendors.officeonlineotel",14:"vendors.officeonlineqossmall"}[e]||e)+".bundle.js"}(e);var l=new Error;s=function(t){o.onerror=o.onload=null,clearTimeout(d);var i=r[e];if(0!==i){if(i){var n=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+n+": "+a+")",l.name="ChunkLoadError",l.type=n,l.request=a,i[1](l)}r[e]=void 0}};var d=setTimeout((function(){s({type:"timeout",target:o})}),12e4);o.onerror=o.onload=s,document.head.appendChild(o)}return Promise.all(t)},n.m=e,n.c=i,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n.oe=function(e){throw console.error(e),e};var a=window.webpackJsonpSscore=window.webpackJsonpSscore||[],s=a.push.bind(a);a.push=t,a=a.slice();for(var o=0;o<a.length;o++)t(a[o]);var l=s;return n(n.s=35)}([function(e,t,i){"use strict";i.d(t,"h",(function(){return r})),i.d(t,"e",(function(){return n})),i.d(t,"f",(function(){return a})),i.d(t,"b",(function(){return s})),i.d(t,"d",(function(){return o})),i.d(t,"c",(function(){return l})),i.d(t,"a",(function(){return d})),i.d(t,"k",(function(){return h})),i.d(t,"j",(function(){return c})),i.d(t,"g",(function(){return u})),i.d(t,"n",(function(){return f})),i.d(t,"m",(function(){return m})),i.d(t,"l",(function(){return p})),i.d(t,"i",(function(){return g}));const r=.001;class n{constructor(e,t){this.x=e,this.y=t}static Flip(e,t){return new n(e?-1:1,t?-1:1)}negate(){return new n(-this.x,-this.y)}inverse(){return new n(1/this.x,1/this.y)}normalized(){const e=this.length();return e?this.scale(1/e):void 0}abs(){return new n(Math.abs(this.x),Math.abs(this.y))}floor(){return new n(Math.floor(this.x),Math.floor(this.y))}ceil(){return new n(Math.ceil(this.x),Math.ceil(this.y))}sign(){return new n(this.x<0?-1:1,this.y<0?-1:1)}isZero(){return 0==this.x&&0==this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}static Distance(e,t){return e.subtract(t).length()}equals(e){return this.x==e.x&&this.y==e.y}equalsWithEpsilon(e,t=r){return Math.abs(this.x-e.x)<t&&Math.abs(this.y-e.y)<t}add(e){return new n(this.x+e.x,this.y+e.y)}subtract(e){return new n(this.x-e.x,this.y-e.y)}multiply(e){return new n(this.x*e.x,this.y*e.y)}divide(e){return new n(this.x/e.x,this.y/e.y)}dot(e){return this.x*e.x+this.y*e.y}scale(e){return new n(this.x*e,this.y*e)}rotate(e){return e?new n(this.x*Math.cos(e)-this.y*Math.sin(e),this.x*Math.sin(e)+this.y*Math.cos(e)):this}transformVector(e){return e.transformVector(this)}transformPoint(e){return e.transformPoint(this)}static InterpolateLinear(e,t,i){return e.add(t.subtract(e).scale(i))}static InterpolateQuadratic(e,t,i,r){return n.InterpolateLinear(n.InterpolateLinear(e,t,r),n.InterpolateLinear(t,i,r),r)}static QuadraticTangent(e,t,i,r){return n.InterpolateLinear(t,i,r).subtract(n.InterpolateLinear(e,t,r)).normalized()}static CalculateLineIntersection(e,t,i,a,s=r){const o=(a.x-i.x)*(e.y-i.y)-(a.y-i.y)*(e.x-i.x),l=(a.y-i.y)*(t.x-e.x)-(a.x-i.x)*(t.y-e.y);if(Math.abs(l)>s)return n.InterpolateLinear(e,t,o/l)}static MeasureQuadraticLength(e,t,i){return m(e.x,e.y,t.x,t.y,i.x,i.y)}}n.Zero=new n(0,0),n.One=new n(1,1);class a{constructor(e,t,i){this.x=e,this.y=t,this.z=i}}a.Zero=new a(0,0,0),a.One=new a(1,1,1);class s{constructor(e,t,i,r,n,a,s,o,l){this.m=new Float32Array([e,t,i,r,n,a,s,o,l])}toMatrix3(){return this}isIdentity(){return this==s.Identity||this.equals(s.Identity)}multiply(e){const t=this.m,i=e.m;return new s(t[0]*i[0]+t[1]*i[3]+t[2]*i[6],t[0]*i[1]+t[1]*i[4]+t[2]*i[7],t[0]*i[2]+t[1]*i[5]+t[2]*i[8],t[3]*i[0]+t[4]*i[3]+t[5]*i[6],t[3]*i[1]+t[4]*i[4]+t[5]*i[7],t[3]*i[2]+t[4]*i[5]+t[5]*i[8],t[6]*i[0]+t[7]*i[3]+t[8]*i[6],t[6]*i[1]+t[7]*i[4]+t[8]*i[7],t[6]*i[2]+t[7]*i[5]+t[8]*i[8])}inverse(){const e=this.m,t=e[0]*e[4]-e[1]*e[3];return 0==t?void 0:new s(e[4]/t,-e[1]/t,0,-e[3]/t,e[0]/t,0,(e[3]*e[7]-e[4]*e[6])/t,(-e[0]*e[7]+e[1]*e[6])/t,1)}transformVector(e){return new n(e.x*this.m[0]+e.y*this.m[3],e.x*this.m[1]+e.y*this.m[4])}transformPoint(e){return new n(e.x*this.m[0]+e.y*this.m[3]+this.m[6],e.x*this.m[1]+e.y*this.m[4]+this.m[7])}isSimpleScaleTranslationOnly(){return 0==this.m[1]&&0==this.m[2]&&0==this.m[3]&&0==this.m[5]&&1==this.m[8]}getSimpleScale(){return new n(this.m[0],this.m[4])}getSimpleTranslation(){return new n(this.m[6],this.m[7])}equals(e){for(let t=0;t<9;t++)if(this.m[t]!=e.m[t])return!1;return!0}tryGetTransform(e){const t=this.transformVector(new n(1,0)),i=this.transformVector(new n(0,1));if(Math.abs(t.x*i.x+t.y*i.y)>r)return;const a=t.x*i.y-t.y*i.x>0?new n(t.length(),i.length()):new n(t.length(),-i.length()),s=t.y>0?Math.acos(t.x/a.x):-Math.acos(t.x/a.x),l=this.transformPoint(e.negate());return new o(e,a,s,l)}static Translation2D(e){return new s(1,0,0,0,1,0,e.x,e.y,1)}static Scale2D(e){return new s(e.x,0,0,0,e.y,0,0,0,1)}static ScaleTranslation2D(e,t){return new s(e.x,0,0,0,e.y,0,t.x,t.y,1)}static RotationZ(e){const t=Math.cos(e),i=Math.sin(e);return new s(t,i,0,-i,t,0,0,0,1)}static RotationAroundPoint(e,t){return new o(t.negate(),n.One,e,t).toMatrix3()}static FromTransforms(...e){if(0==e.length)return s.Identity;let t=e[0].toMatrix3();for(let i=1;i<e.length;i++)t=t.multiply(e[i].toMatrix3());return t}}s.Identity=new s(1,0,0,0,1,0,0,0,1);class o{constructor(e,t,i,r){this.preTranslation=e||n.Zero,this.scale=t||n.One,this.rotation=null!=i?i:0,this.translation=r||n.Zero}toMatrix3(){const e=Math.cos(this.rotation),t=Math.sin(this.rotation),i=this.scale.x*e,r=this.scale.x*t,n=this.scale.y*-t,a=this.scale.y*e;return new s(i,r,0,n,a,0,this.preTranslation.x*i+this.preTranslation.y*n+this.translation.x,this.preTranslation.y*a+this.preTranslation.x*r+this.translation.y,1)}isIdentity(){return this==o.Identity||this.equals(o.Identity)}toInverseMatrix3(){const e=Math.cos(-this.rotation),t=Math.sin(-this.rotation),i=e/this.scale.x,r=t/this.scale.y,n=-t/this.scale.x,a=e/this.scale.y;return new s(i,r,0,n,a,0,-this.translation.x*i-this.translation.y*n-this.preTranslation.x,-this.translation.y*a-this.translation.x*r-this.preTranslation.y,1)}transformVector(e){return e.multiply(this.scale).rotate(this.rotation)}transformPoint(e){return e.add(this.preTranslation).multiply(this.scale).rotate(this.rotation).add(this.translation)}applyScaleAndTranslationBefore(e,t){return new o(this.preTranslation.add(t).divide(e),this.scale.multiply(e),this.rotation,this.translation)}applyTranslationAfter(e){return new o(this.preTranslation,this.scale,this.rotation,this.translation.add(e))}equals(e){return this.preTranslation.equals(e.preTranslation)&&this.scale.equals(e.scale)&&this.rotation==e.rotation&&this.translation.equals(e.translation)}static fromScaleAndTranslation(e,t){return new o(void 0,e,void 0,t)}static fromTransformAndPretranslation(e,t){return new o(t,e.scale,e.rotation,e.translation)}static fromTransformAndScale(e,t){return new o(e.preTranslation,t,e.rotation,e.translation)}static fromTransformAndRotation(e,t){return new o(e.preTranslation,e.scale,t,e.translation)}static fromTransformAndTranslation(e,t){return new o(e.preTranslation,e.scale,e.rotation,t)}}o.Identity=new o;class l{constructor(e=0,t=0,i=0,r=0){this.left=e,this.top=t,this.right=i,this.bottom=r}static FromSize(e){return new l(0,0,e.x,e.y)}static FromSizeAndCenter(e,t){return new l(t.x-.5*e.x,t.y-.5*e.y,t.x+.5*e.x,t.y+.5*e.y)}static FromPoints(e,t){return new l(Math.min(e.x,t.x),Math.min(e.y,t.y),Math.max(e.x,t.x),Math.max(e.y,t.y))}isEmpty(){return this.left==this.right&&this.top==this.bottom}isValid(){return this.left<=this.right&&this.top<=this.bottom}get width(){return this.right-this.left}get height(){return this.bottom-this.top}get size(){return new n(this.right-this.left,this.bottom-this.top)}get center(){return new n((this.left+this.right)/2,(this.top+this.bottom)/2)}get leftTop(){return new n(this.left,this.top)}get rightBottom(){return new n(this.right,this.bottom)}isPointInRect(e){return this.left<=e.x&&e.x<=this.right&&this.top<=e.y&&e.y<=this.bottom}equals(e){return this.left==e.left&&this.top==e.top&&this.right==e.right&&this.bottom==e.bottom}inflate(e){return new l(this.left-e,this.top-e,this.right+e,this.bottom+e)}inflateToInteger(){return new l(Math.floor(this.left),Math.floor(this.top),Math.ceil(this.right),Math.ceil(this.bottom))}multiply(e){return l.FromPoints(this.leftTop.multiply(e),this.rightBottom.multiply(e))}divide(e){return l.FromPoints(this.leftTop.divide(e),this.rightBottom.divide(e))}translate(e){return new l(this.left+e.x,this.top+e.y,this.right+e.x,this.bottom+e.y)}transformedBounds(e){let t=void 0,i=[new n(this.left,this.top),new n(this.right,this.top),new n(this.right,this.bottom),new n(this.left,this.bottom)];for(let r=0;r<4;r++)t=l.UnionPoint(t,i[r].transformPoint(e));return t}static UnionPoint(e,t){return e&&e.isValid()?new l(Math.min(e.left,t.x),Math.min(e.top,t.y),Math.max(e.right,t.x),Math.max(e.bottom,t.y)):new l(t.x,t.y,t.x,t.y)}static UnionRect(e,t){return e&&t&&e.isValid()&&t.isValid()?new l(Math.min(e.left,t.left),Math.min(e.top,t.top),Math.max(e.right,t.right),Math.max(e.bottom,t.bottom)):e&&e.isValid()?e:t&&t.isValid()?t:void 0}static IntersectRect(e,t){if(e&&t&&e.isValid()&&t.isValid()){const i=new l(Math.max(e.left,t.left),Math.max(e.top,t.top),Math.min(e.right,t.right),Math.min(e.bottom,t.bottom));return i.isValid()?i:void 0}}static SegmentBounds(e,t){return new l(Math.min(e.x,t.x),Math.min(e.y,t.y),Math.max(e.x,t.x),Math.max(e.y,t.y))}static QuadraticBezierBounds(e,t,i){let r;r=l.SegmentBounds(e,i);const a=(e.x-t.x)/(e.x+i.x-2*t.x);0<a&&a<1&&(r=l.UnionPoint(r,n.InterpolateQuadratic(e,t,i,a)));const s=(e.y-t.y)/(e.y+i.y-2*t.y);return 0<s&&s<1&&(r=l.UnionPoint(r,n.InterpolateQuadratic(e,t,i,s))),r}static InterpolateLinear(e,t,i){return new l(f(e.left,t.left,i),f(e.top,t.top,i),f(e.right,t.right,i),f(e.bottom,t.bottom,i))}}l.Zero=new l(0,0,0,0);class d{constructor(e,t,i,r){this.xMin=e,this.yMin=t,this.xMax=i,this.yMax=r}equals(e){return this.xMin===e.xMin&&this.yMin===e.yMin&&this.xMax===e.xMax&&this.yMax===e.yMax}clip(e){const t=new l(void 0===this.xMin?e.left:this.xMin,void 0===this.yMin?e.top:this.yMin,void 0===this.xMax?e.right:this.xMax,void 0===this.yMax?e.bottom:this.yMax);return l.IntersectRect(e,t)}static CreateFromRect(e){return new d(e.left,e.top,e.right,e.bottom)}}function h(e){return Math.pow(2,Math.round(Math.log(e)/Math.log(2)))}function c(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))}function u(e,t,i){return Math.min(i,Math.max(t,e))}function f(e,t,i){return e+(t-e)*i}function m(e,t,i,n,a,s){const o=a-e,l=s-t;if(Math.abs(o*(n-t)-l*(i-e))<r)return Math.sqrt(o*o+l*l);const d=a-2*i+e,h=s-2*n+t,c=2*i-2*a,u=2*n-2*s,f=4*(d*d+h*h),m=4*(d*c+h*u),p=c*c+u*u,g=2*Math.sqrt(f+m+p),_=Math.sqrt(f),v=2*Math.sqrt(p),y=m/_;return(_*(2*f*g+m*(g-v))+(4*p*f-m*m)*Math.log((2*_+y+g)/(y+v)))/(8*f*_)}function p(e,t,i,r){let n=(t-e)/(2*Math.PI);return n-=Math.floor(n),(r&&n>0||null==r&&n>.5)&&n--,f(e,e+n*(2*Math.PI),i)}function g(e,t){return e==t||null!=e&&null!=t&&e.equals(t)}},function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||t.hasOwnProperty(i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(270),t)},function(e,t,i){"use strict";var r;i.d(t,"a",(function(){return r})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles"}(r||(r={}))},function(e,t,i){"use strict";var r;i.d(t,"a",(function(){return r})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(r={}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var r=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e.prototype.setCorrelationId=function(){},e}(),n=new(function(){function e(){this.externalLogger=new r}return e.prototype.setCorrelationId=function(e){this.externalLogger.setCorrelationId(e)},e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,i,r){this.externalLogger.sendTraceTag(e,t,i,r)},e.prototype.debugAssertTag=function(e,t,i,r){this.externalLogger.debugAssertTag(e,t,i,r)},e.prototype.shipAssertTag=function(e,t,i,r){this.externalLogger.shipAssertTag(e,t,i,r)},e}());function a(e){if(!e)throw new Error("The 'logger' argument is missing");n.setLogger(e)}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{static Error(e,t){return r.s_logger.sendTraceTag(e,306,10,t),new Error(t+" "+e)}static Message(e,t){r.s_logger.sendTraceTag(e,306,50,t)}static setLogger(e){e&&(r.s_logger=e)}}r.s_logger={sendTraceTag:(e,t,i,r)=>{console.log(e,r)},shipAssertTag:()=>{},debugAssertTag:()=>{}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i(95))},function(e,t,i){"use strict";i.d(t,"b",(function(){return l})),i.d(t,"f",(function(){return d})),i.d(t,"a",(function(){return h})),i.d(t,"i",(function(){return c})),i.d(t,"d",(function(){return u})),i.d(t,"c",(function(){return f})),i.d(t,"e",(function(){return m})),i.d(t,"g",(function(){return p})),i.d(t,"j",(function(){return g})),i.d(t,"h",(function(){return v})),i.d(t,"k",(function(){return y})),i.d(t,"l",(function(){return S}));var r=i(18),n=i(0),a=i(5),s=i(16),o=i(14);class l{constructor(e,t,i,r=1){this.r=e,this.g=t,this.b=i,this.a=r}equals(e){return this.r==e.r&&this.g==e.g&&this.b==e.b&&this.a==e.a}modulateOpacity(e){return new l(this.r,this.g,this.b,this.a*e)}add(e){return new l(this.r+e.r,this.g+e.g,this.b+e.b,this.a+e.a)}subtract(e){return new l(this.r-e.r,this.g-e.g,this.b-e.b,this.a-e.a)}multiply(e){return new l(this.r*e.r,this.g*e.g,this.b*e.b,this.a*e.a)}divide(e){return new l(this.r/e.r,this.g/e.g,this.b/e.b,this.a/e.a)}scale(e){return new l(this.r*e,this.g*e,this.b*e,this.a*e)}static Gray(e){return new l(e,e,e,1)}static FromRGBA(e){return new l(e.r,e.g,e.b,e.a)}static FromHSL(e,t,i,r){const n=i<=.5?i+i*t:i+t-i*t,a=2*i-n,[s,o,d]=[1/3,0,-1/3].map(t=>{const i=(e+t)%1;return 6*i<1?a+(n-a)*i*6:2*i<1?n:3*i<2?a+(n-a)*(4-6*i):a});return new l(s,o,d,r)}static InterpolateLinear(e,t,i){return new l(Object(n.g)(Object(n.n)(e.r,t.r,i),0,1),Object(n.g)(Object(n.n)(e.g,t.g,i),0,1),Object(n.g)(Object(n.n)(e.b,t.b,i),0,1),Object(n.g)(Object(n.n)(e.a,t.a,i),0,1))}}l.Transparent=new l(0,0,0,0),l.Black=new l(0,0,0,1),l.White=new l(1,1,1,1),l.Red=new l(1,0,0,1),l.Orange=new l(1,.5,0,1),l.Yellow=new l(1,1,0,1),l.Green=new l(0,1,0,1),l.Cyan=new l(0,1,1,1),l.Blue=new l(0,0,1,1),l.Magenta=new l(1,0,1,1);class d{constructor(){this.renderDataMap={},this.m_changeTracker=new s.a}get changeTracker(){return this.m_changeTracker}get id(){return this.m_id}set id(e){this.m_id!=e&&(this.m_changeTracker.notifyChange(),this.m_id=e)}releaseGeneratedResources(){for(const e in this.renderDataMap)this.renderDataMap[e].releaseGeneratedResources()}}class h{constructor(){this.m_changeTrackers={colorChangeTracker:new s.a,alphaChangeTracker:new s.a}}get changeTracker(){return this.m_changeTrackers.colorChangeTracker}get version(){return this.m_changeTrackers.colorChangeTracker.version}get alphaChangeTracker(){return this.m_changeTrackers.alphaChangeTracker}get rotateWithShape(){return!0}static IsGradient(e){return 2<=e&&e<=5}}class c extends h{constructor(e){super(),this.m_color=e}clone(){return new c(this.m_color)}get color(){return this.m_color}set color(e){Object(o.c)(this.changeTracker,this.m_color,e),Object(o.a)(this.alphaChangeTracker,this.m_color.a,e.a),this.m_color=e}getType(){return 1}}class u{constructor(e,t){this.position=e,this.color=t}equals(e){return this.position==e.position&&this.color.equals(e.color)}}class f extends h{constructor(e,t){super(),this.m_type=e,this.m_angle=0,this.m_fillFromRect=new n.c(0,0,1,1),this.m_fillToRect=new n.c(.5,.5,.5,.5),this.m_rotateWithShape=!0,this.m_isStretched=!1,this.m_shadeFromTitle=!1,this.m_gradientStops=t?t.slice(0):[],this.m_isGammaCorrected=!0,this.m_alphaGamma=1,s.a.AddListener(this.changeTracker,this.alphaChangeTracker)}clone(){const e=new f(this.m_type,this.m_gradientStops);return e.m_angle=this.m_angle,e.m_fillFromRect=this.m_fillFromRect,e.m_fillToRect=this.m_fillToRect,e.m_rotateWithShape=this.m_rotateWithShape,e.m_isStretched=this.m_isStretched,e.m_shadeFromTitle=this.m_shadeFromTitle,e.m_isGammaCorrected=this.m_isGammaCorrected,e.m_alphaGamma=this.m_alphaGamma,e}get gradientStops(){return this.m_gradientStops}get angle(){return this.m_angle}get fillFromRect(){return this.m_fillFromRect}get fillToRect(){return this.m_fillToRect}get isStretched(){return this.m_isStretched}get shadeFromTitle(){return this.m_shadeFromTitle}get rotateWithShape(){return 5==this.m_type||this.m_rotateWithShape}get isGammaCorrected(){return this.m_isGammaCorrected}get blendBellShape(){return this.m_blendBellShape}get alphaGamma(){return this.m_alphaGamma}set gradientStops(e){Object(o.d)(this.changeTracker,this.m_gradientStops,e),this.m_gradientStops=e.slice(0)}set angle(e){Object(o.a)(this.changeTracker,this.m_angle,e),this.m_angle=e}set fillFromRect(e){Object(o.c)(this.changeTracker,this.m_fillFromRect,e),this.m_fillFromRect=e}set fillToRect(e){Object(o.c)(this.changeTracker,this.m_fillToRect,e),this.m_fillToRect=e}set rotateWithShape(e){Object(o.a)(this.changeTracker,this.m_rotateWithShape,e),this.m_rotateWithShape=e}set isStretched(e){Object(o.a)(this.changeTracker,this.m_isStretched,e),this.m_isStretched=e}set shadeFromTitle(e){Object(o.a)(this.changeTracker,this.m_shadeFromTitle,e),this.m_shadeFromTitle=e}set isGammaCorrected(e){Object(o.a)(this.changeTracker,this.m_isGammaCorrected,e),this.m_isGammaCorrected=e}set blendBellShape(e){Object(o.c)(this.changeTracker,this.m_blendBellShape,e),this.m_blendBellShape=e}set alphaGamma(e){Object(o.a)(this.changeTracker,this.m_alphaGamma,e),this.m_alphaGamma=e}getType(){return this.m_type}}class m extends h{constructor(e,t){super(),this.m_fillToPreserveAspectRatio=!1,this.m_isAlphaInvariant=!!t,this.changeTracker.replaceListener(void 0,e),this.m_isAlphaInvariant||this.alphaChangeTracker.replaceListener(void 0,e),this.m_image=e,this.m_isStretched=!0,this.m_scale=n.e.One,this.m_offset=n.e.Zero,this.m_alignment=4,this.m_opacity=1,this.m_rotateWithShape=!0}clone(){const e=new m(this.m_image);return e.m_isStretched=this.m_isStretched,e.m_scale=this.m_scale,e.m_offset=this.m_offset,e.m_alignment=this.m_alignment,e.m_opacity=this.m_opacity,e.m_rotateWithShape=this.m_rotateWithShape,e}get image(){return this.m_image}get wrapMode(){return this.m_wrapMode}get isStretched(){return this.m_isStretched}get scale(){return this.m_scale}get offset(){return this.m_offset}get alignment(){return this.m_alignment}get opacity(){return this.m_opacity}get rotateWithShape(){return this.m_rotateWithShape}get pictureEffects(){return this.m_pictureEffects}get isAlphaInvariant(){return this.m_isAlphaInvariant}get fillToPreserveAspectRatio(){return this.m_fillToPreserveAspectRatio}set image(e){this.changeTracker.replaceListener(this.m_image,e),this.m_isAlphaInvariant||this.alphaChangeTracker.replaceListener(this.m_image,e),this.m_image=e}set wrapMode(e){Object(o.a)(this.changeTracker,this.m_wrapMode,e),Object(o.a)(this.alphaChangeTracker,this.m_wrapMode,e),this.m_wrapMode=e}set isStretched(e){Object(o.a)(this.changeTracker,this.m_isStretched,e),Object(o.a)(this.alphaChangeTracker,this.m_isStretched,e),this.m_isStretched=e}set scale(e){Object(o.c)(this.changeTracker,this.m_scale,e),Object(o.c)(this.alphaChangeTracker,this.m_scale,e),this.m_scale=e}set offset(e){Object(o.c)(this.changeTracker,this.m_offset,e),Object(o.c)(this.alphaChangeTracker,this.m_offset,e),this.m_offset=e}set alignment(e){Object(o.a)(this.changeTracker,this.m_alignment,e),Object(o.a)(this.alphaChangeTracker,this.m_alignment,e),this.m_alignment=e}set opacity(e){Object(o.a)(this.changeTracker,this.m_opacity,e),Object(o.a)(this.alphaChangeTracker,this.m_opacity,e),this.m_opacity=e}set rotateWithShape(e){Object(o.a)(this.changeTracker,this.m_rotateWithShape,e),Object(o.a)(this.alphaChangeTracker,this.m_rotateWithShape,e),this.m_rotateWithShape=e}set pictureEffects(e){this.m_pictureEffects!=e&&(this.changeTracker.replaceListener(this.m_pictureEffects,e),this.alphaChangeTracker.replaceListener(this.m_pictureEffects,e),this.m_pictureEffects=e)}set isAlphaInvariant(e){this.m_isAlphaInvariant!=e&&(e?this.alphaChangeTracker.replaceListener(this.m_image,void 0):this.alphaChangeTracker.replaceListener(void 0,this.m_image),this.m_isAlphaInvariant=e)}set fillToPreserveAspectRatio(e){Object(o.a)(this.changeTracker,this.m_fillToPreserveAspectRatio,e),Object(o.a)(this.alphaChangeTracker,this.m_fillToPreserveAspectRatio,e),this.m_fillToPreserveAspectRatio=e}getType(){return 6}}class p extends h{constructor(e,t,i){super(),this.m_pattern=e,this.m_foregroundColor=t,this.m_backgroundColor=i}clone(){return new p(this.m_pattern,this.m_foregroundColor,this.m_backgroundColor)}get pattern(){return this.m_pattern}get foregroundColor(){return this.m_foregroundColor}get backgroundColor(){return this.m_backgroundColor}get rotateWithShape(){return!1}set pattern(e){Object(o.a)(this.changeTracker,this.m_pattern,e),Object(o.a)(this.alphaChangeTracker,this.m_pattern,e),this.m_pattern=e}set foregroundColor(e){Object(o.c)(this.changeTracker,this.m_foregroundColor,e),Object(o.a)(this.changeTracker,this.m_foregroundColor.a,e.a),this.m_foregroundColor=e}set backgroundColor(e){Object(o.c)(this.changeTracker,this.m_backgroundColor,e),Object(o.a)(this.changeTracker,this.m_backgroundColor.a,e.a),this.m_backgroundColor=e}getType(){return 7}}class g extends h{constructor(e){super(),this.m_type=e,8!=e&&9!=e&&a.a.Error(592520774,"SpecialBrush must be background or group")}clone(){return new g(this.m_type)}getType(){return this.m_type}}class _{constructor(e,t,i,r,n){this.widthMin=e,this.end=t,this.cap=i,this.width=r,this.length=n}}class v{constructor(e=0,t=2,i=8){this.headEnd=new _(0,0,0,1,1),this.tailEnd=new _(0,0,0,1,1),this.m_changeTracker=new s.a,this.m_lineWidth=e,this.m_lineJoin=t,this.m_miterLimit=i,this.m_dashType=0,this.m_compoundType=0,this.m_alignment=0,this.m_useRoundDash=!1}clone(){const e=new v(this.m_lineWidth);return e.m_lineJoin=this.m_lineJoin,e.m_miterLimit=this.m_miterLimit,e.m_dashType=this.m_dashType,e.m_compoundType=this.m_compoundType,e.m_alignment=this.m_alignment,e.m_useRoundDash=this.m_useRoundDash,e}get changeTracker(){return this.m_changeTracker}get version(){return this.m_changeTracker.version}get lineWidth(){return this.m_lineWidth?this.m_lineWidth:this.m_lineHeight?this.m_lineHeight:0}get adjustedLineWidth(){return Math.max(r.v,this.lineWidth)}get adjustedLineWidthForArrowHead(){return Math.max(r.w,this.lineWidth)}get lineHeight(){return this.m_lineHeight?this.m_lineHeight:this.m_lineWidth?this.m_lineWidth:0}get tipScale(){return this.m_lineWidth&&this.m_lineHeight?new n.e(1,this.m_lineHeight/this.m_lineWidth):n.e.One}get lineJoin(){return this.m_lineJoin}get miterLimit(){return this.m_miterLimit}get dashType(){return this.m_dashType}get useRoundDash(){return this.m_useRoundDash}get dashOffset(){return null==this.m_dashOffset?0:this.m_dashOffset}get compoundType(){return this.m_compoundType}get alignment(){return this.m_alignment}get tipType(){return null==this.m_tipType?0:this.m_tipType}set lineWidth(e){Object(o.a)(this.changeTracker,this.m_lineWidth,e),this.m_lineWidth=e}set lineHeight(e){Object(o.a)(this.changeTracker,this.m_lineHeight,e),this.m_lineHeight=e}set lineJoin(e){Object(o.a)(this.changeTracker,this.m_lineJoin,e),this.m_lineJoin=e}set miterLimit(e){Object(o.a)(this.changeTracker,this.m_miterLimit,e),this.m_miterLimit=e}set dashType(e){Object(o.a)(this.changeTracker,this.m_dashType,e),this.m_dashType=e}set useRoundDash(e){Object(o.a)(this.changeTracker,this.m_useRoundDash,e),this.m_useRoundDash=e}set dashOffset(e){Object(o.a)(this.changeTracker,this.m_dashOffset,e),this.m_dashOffset=e}set compoundType(e){Object(o.a)(this.changeTracker,this.m_compoundType,e),this.m_compoundType=e}set alignment(e){Object(o.a)(this.changeTracker,this.m_alignment,e),this.m_alignment=e}set tipType(e){Object(o.a)(this.changeTracker,this.m_tipType,e),this.m_tipType=e}}class y{constructor(e,t,i=new v,r=0){this.m_changeTracker=new s.a,this.m_alphaChangeTracker=new s.a,this.m_penChangeTracker=new s.a,this.m_fillChangeTrackers={colorChangeTracker:new s.a,alphaChangeTracker:new s.a},this.m_lineChangeTrackers={colorChangeTracker:new s.a,alphaChangeTracker:new s.a},this.m_pictureChangeTrackers={colorChangeTracker:new s.a,alphaChangeTracker:new s.a},s.a.AddListener(this.m_fillChangeTrackers.colorChangeTracker,this.m_changeTracker),s.a.AddListener(this.m_lineChangeTrackers.colorChangeTracker,this.m_changeTracker),s.a.AddListener(this.m_pictureChangeTrackers.colorChangeTracker,this.m_changeTracker),s.a.AddListener(this.m_fillChangeTrackers.alphaChangeTracker,this.m_alphaChangeTracker),s.a.AddListener(this.m_lineChangeTrackers.alphaChangeTracker,this.m_alphaChangeTracker),s.a.AddListener(this.m_pictureChangeTrackers.alphaChangeTracker,this.m_alphaChangeTracker),s.a.AddListener(this.m_penChangeTracker,this.m_changeTracker),this.m_pen=i,this.fillBrush=e,this.lineBrush=t,this.m_blendingMode=r,this.m_penChangeTracker.replaceListener(void 0,i)}clone(){const e=new y;return e.fillBrush=this.m_fillBrush?this.m_fillBrush.clone():void 0,e.lineBrush=this.m_lineBrush?this.m_lineBrush.clone():void 0,e.pictureBrush=this.m_pictureBrush?this.m_pictureBrush.clone():void 0,e.pictureEffects=this.m_pictureEffects?this.m_pictureEffects.clone():void 0,e.m_pictureOverflow=this.m_pictureOverflow,e.pen=this.m_pen.clone(),e.blendingMode=this.m_blendingMode,e.m_hitTransparentFill=this.m_hitTransparentFill,e}get changeTracker(){return this.m_changeTracker}get alphaChangeTracker(){return this.m_alphaChangeTracker}get penChangeTracker(){return this.m_penChangeTracker}get version(){return this.m_changeTracker.version}get fillBrush(){return this.m_fillBrush}get lineBrush(){return this.m_lineBrush}get pictureBrush(){return this.m_pictureBrush}get pictureEffects(){return this.m_pictureEffects}get pictureOverflow(){return this.m_pictureOverflow||0}get pen(){return this.m_pen}get hasLine(){return null!=this.m_lineBrush}get blendingMode(){return this.m_blendingMode}get hitTransparentFill(){return!!this.m_hitTransparentFill}get hitTestSlop(){return this.m_hitTestSlop}set fillBrush(e){b(this.m_fillChangeTrackers.colorChangeTracker,this.m_fillChangeTrackers.alphaChangeTracker,this.m_fillBrush,e),this.m_fillBrush=e}set lineBrush(e){b(this.m_lineChangeTrackers.colorChangeTracker,this.m_lineChangeTrackers.alphaChangeTracker,this.m_lineBrush,e),this.m_lineBrush=e}set pictureBrush(e){b(this.m_pictureChangeTrackers.colorChangeTracker,this.m_pictureChangeTrackers.alphaChangeTracker,this.m_pictureBrush,e),this.m_pictureBrush=e}set pictureEffects(e){this.m_pictureEffects!=e&&(this.changeTracker.replaceListener(this.m_pictureEffects,e),this.m_pictureEffects=e)}set pictureOverflow(e){Object(o.a)(this.changeTracker,this.m_pictureOverflow,e),this.m_pictureOverflow=e}set pen(e){this.m_penChangeTracker.replaceListener(this.m_pen,e),this.m_pen=e}set blendingMode(e){Object(o.a)(this.changeTracker,this.m_blendingMode,e),this.m_blendingMode=e}set hitTransparentFill(e){Object(o.a)(this.changeTracker,this.m_hitTransparentFill,e),this.m_hitTransparentFill=e}set hitTestSlop(e){this.m_hitTestSlop!=e&&this.changeTracker.notifyChange(),this.m_hitTestSlop=e}getBrushImages(){const e=S(this.fillBrush);return e.push(...S(this.lineBrush)),e.push(...S(this.pictureBrush)),e}}function b(e,t,i,r){i!=r&&(i&&(s.a.RemoveListener(i.changeTracker,e),s.a.RemoveListener(i.alphaChangeTracker,t)),r&&(s.a.AddListener(r.changeTracker,e),s.a.AddListener(r.alphaChangeTracker,t)))}function S(e){const t=[];if(e&&6==e.getType()){const i=e;i.image&&t.push(i.image)}return t}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r,n=i(0);i.d(t,"b",(function(){return n.e})),function(e){e[e.Audio=0]="Audio",e[e.Video=1]="Video",e[e.StreamClassic=2]="StreamClassic",e[e.YouTube=3]="YouTube",e[e.Vimeo=4]="Vimeo",e[e.Flip=5]="Flip",e[e.Ted=6]="Ted",e[e.Stream2=7]="Stream2",e[e.SlideShare=8]="SlideShare",e[e.Other=9]="Other"}(r||(r={}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n}));let r={info(e,t){},warn(e,t){},error(e,t){}};function n(e){r=e}},function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(12),n=i(4),a=i(2),s=i(3),o=i(123),l=i(17),d=i(126),h=i(1);class c{static init(e,t,i,r){c.m_userSessionId=e.appSettings.userSessionId;const d=(new o.UAParser).getResult();c.m_sessionConfig={browserName:d.browser.name,browserMajor:d.browser.major,osName:d.os.name,osVersion:d.os.version,uiHost:e.appSettings.uiHost,pkgVersion:t,svmVersion:i,sbVersion:r,browserLCID:navigator.language};const u={appMetadata:{initTime:e.appSettings.initTime,uiHost:e.appSettings.uiHost,serverUrl:e.appSettings.serverUrl,scenario:e.appSettings.scenario,useDocCache:e.appSettings.useDocCache,useSnapDownloadUrl:e.appSettings.useSnapDownloadUrl,userId:e.appSettings.userId,ring:e.appSettings.ring,fileHost:e.appSettings.fileHost},config:c.m_sessionConfig,uaStr:d.ua,pkgVersion:t,svmVersion:i,sbVersion:r};n.a.sendTraceTag(572289233,a.a.msoulscat_Wac_PptSlideshow,s.a.Warning,JSON.stringify(e));let f=e.slideShowCoreSettings.settings,m=h.Settings.readStringOrDefault("SSSessionSettingsToLogAsWarning","");if(f)for(const e in f)for(const t in f[e]){let i=m.indexOf(t+";")>=0;n.a.sendTraceTag(537522828,a.a.msoulscat_Wac_PptSlideshow,i?s.a.Warning:s.a.Info,`${e}.${t}:${f[e][t]}`)}if(e.slideShowCoreSettings.disabledChangeGates)for(const t of e.slideShowCoreSettings.disabledChangeGates.split(";"))n.a.sendTraceTag(537522829,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,t);n.a.sendTraceTag(595641932,a.a.msoulscat_Wac_PptSlideshow,s.a.Warning,l.c.getLogString("SSCoreConstructor",u))}static logSessionStart(e){c.m_sessionStats={};const t={userSessionId:c.m_userSessionId,startFromTime:e,...c.getSessionConfig()};for(const e in c.m_sessionStats)t[e]=c.m_sessionStats[e];n.a.sendTraceTag(594137685,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,l.c.getLogString("sessionStart",t)),c.startFrom=e}static logSessionEnd(e){const t={sessionId:c.m_userSessionId,startFromTime:c.startFrom,exitFromTime:e||performance.now(),vetos:[...r.VetoUtils.getSessionVetos().keys()]};d.a.logInkActivity("SessionEnd");for(const e in c.m_sessionStats)t[e]=c.m_sessionStats[e];if(c.startFrom=0,n.a.sendTraceTag(594650329,a.a.msoulscat_Wac_PptSlideshow,s.a.Warning,l.c.getLogString("sessionEnd",t)),Object.keys(c.m_sessionTransitionStats).length>0){const e={sessionId:c.m_userSessionId,startFromTime:c.startFrom,TransitionUsageData:c.m_sessionTransitionStats};n.a.sendTraceTag(592843211,a.a.msoulscat_Wac_PptSlideshow,s.a.Warning,l.c.getLogString("transitionLogObject",e))}}static recordSessionTransitionStats(e){if(e.effectId){if(c.m_sessionTransitionStats[e.effectId]){let t=c.m_sessionTransitionStats[e.effectId].count;c.m_sessionTransitionStats[e.effectId].count=t+1}else c.m_sessionTransitionStats[e.effectId]={count:1,isSupported:e.isSupported};e.metadata&&Object.keys(e.metadata).length>0&&(c.m_sessionTransitionStats[e.effectId].hasOwnProperty("metadata")?c.m_sessionTransitionStats[e.effectId].metadata.push(e.metadata):c.m_sessionTransitionStats[e.effectId].metadata=[e.metadata]),60!==e.effectId||c.getSessionStats("hasMorph")||c.recordSessionStats({hasMorph:!0})}}static recordSessionStats(e){const t={sessionId:c.m_userSessionId,startFromTime:c.startFrom};n.a.sendTraceTag(593295362,a.a.msoulscat_Wac_PptSlideshow,e.hasOwnProperty("errorName")?s.a.Warning:s.a.Info,"SessionUtils::recordSessionStats: "+JSON.stringify({...e,...t}));for(const t of Object.keys(e))"metadata"===t?(c.m_sessionStats.hasOwnProperty(t)||(c.m_sessionStats[t]=[]),c.m_sessionStats[t].includes(e[t])||(c.m_sessionStats[t]=c.m_sessionStats[t].concat(e[t]))):"errorName"===t?r.VetoUtils.recordVeto("ACE",{msg:e[t]}):c.m_sessionStats[t]=e[t]}static getSessionStats(e){return c.m_sessionStats[e]}static getSessionConfig(){return c.m_sessionConfig}static performanceNowTrimmed(){return Math.round(performance.now())}}c.m_sessionStats={},c.m_sessionTransitionStats={},c.m_sessionConfig={},c.startFrom=0},function(e,t,i){"use strict";i.d(t,"c",(function(){return m})),i.d(t,"d",(function(){return p})),i.d(t,"e",(function(){return g})),i.d(t,"b",(function(){return _})),i.d(t,"h",(function(){return v})),i.d(t,"g",(function(){return y})),i.d(t,"m",(function(){return b})),i.d(t,"k",(function(){return S})),i.d(t,"j",(function(){return T})),i.d(t,"i",(function(){return M})),i.d(t,"l",(function(){return C})),i.d(t,"a",(function(){return I})),i.d(t,"n",(function(){return P})),i.d(t,"f",(function(){return E}));var r=i(0),n=i(93),a=i(61),s=i(7),o=i(22),l=i(16),d=i(5),h=i(94),c=i(14),u=i(18),f=i(136);class m{constructor(e,t){this.transform=e,this.opacity=null==t?void 0:t.opacity,this.colorMatrix=null==t?void 0:t.colorMatrix,this.colorOffset=null==t?void 0:t.colorOffset,this.colorize=null==t?void 0:t.colorize,this.groupIndex=null==t?void 0:t.groupIndex}}m.DefaultArray=[new m(r.b.Identity)];class p{constructor(e=new a.a,t=r.d.Identity,i){this.m_animationChangeTracker=new l.a,this.renderDataMap={},this.m_changeTracker=new l.a(i),this.m_alphaTracker=new l.a(i),this.m_changeTracker.replaceListener(void 0,e),this.m_alphaTracker.replaceListener(void 0,e),this.m_effects=e,this.m_isHidden=!1,this.m_transform=t,null===h.a||void 0===h.a||h.a.register(this,this.renderDataMap)}cloneItemData(e){var t,i;e.effects=this.m_effects.clone(),e.m_transform=this.m_transform,e.fade=this.m_fade?this.m_fade.clone():void 0,e.m_animationTransform=this.m_animationTransform,e.m_fillBoundsOverride=this.m_fillBoundsOverride,e.m_effectsBoundsOverride=this.m_effectsBoundsOverride,e.m_scene3D=this.m_scene3D,e.m_isHidden=this.m_isHidden,e.m_instanceOffsets=null===(t=this.m_instanceOffsets)||void 0===t?void 0:t.slice(0),e.m_instances=null===(i=this.m_instances)||void 0===i?void 0:i.slice(0),e.m_clipBounds=this.m_clipBounds,e.clientData=this.clientData}get changeTracker(){return this.m_changeTracker}get animationChangeTracker(){return this.m_animationChangeTracker}get alphaTracker(){return this.m_alphaTracker}notifyChange(){this.m_changeTracker.notifyChange()}get version(){return this.m_changeTracker.version}get effects(){return this.m_effects}get transform(){return this.m_transform}get isHidden(){return this.m_isHidden}get instanceOffsets(){return this.m_instanceOffsets}get instances(){return this.m_instances}get fade(){return this.m_fade}get animationTransform(){return this.m_animationTransform}get fillBoundsOverride(){return this.m_fillBoundsOverride}get effectsBoundsOverride(){return this.m_effectsBoundsOverride}get scene3D(){return this.m_scene3D}get clipBounds(){return this.m_clipBounds}set effects(e){this.m_changeTracker.replaceListener(this.m_effects,e),this.m_effects=e}set transform(e){this.m_transform.equals(e)||(this.onTransformChanged(this.m_transform,e),this.notifyChange(),this.m_transform=e)}set isHidden(e){Object(c.a)(this.m_changeTracker,this.m_isHidden,e),this.m_isHidden=e}set instanceOffsets(e){this.m_instanceOffsets=e?e.slice(0):void 0,this.m_instances=e?e.map(e=>new m(r.b.Translation2D(e))):void 0}set instances(e){this.m_instances=e?e.slice(0):void 0}set fade(e){this.m_animationChangeTracker.replaceListener(this.m_fade,e),this.m_fade=e}set animationTransform(e){Object(c.c)(this.m_animationChangeTracker,this.m_animationTransform,e),this.m_animationTransform=e}set fillBoundsOverride(e){Object(c.c)(this.m_changeTracker,this.m_fillBoundsOverride,e),this.m_fillBoundsOverride=e}set effectsBoundsOverride(e){Object(c.c)(this.m_changeTracker,this.m_effectsBoundsOverride,e),this.m_effectsBoundsOverride=e}set scene3D(e){this.m_scene3D!=e&&(this.notifyChange(),this.m_scene3D=e,this.clearCache())}set clipBounds(e){Object(c.c)(this.changeTracker,this.m_clipBounds,e),Object(c.c)(this.alphaTracker,this.m_clipBounds,e),this.m_clipBounds=e}getBounds(e=!0,t=!0,i=!0,r){return T(this,t,i?31:0,i?31:0,null==r?void 0:r.toMatrix3(),!0,void 0,e)}onTransformChanged(e,t){}clearCache(){for(const e in this.renderDataMap)this.renderDataMap[e].releaseGeneratedResources()}releaseGeneratedResources(){this.clearCache();const e=this.getBrushImages();for(let t of e)t.releaseGeneratedResources()}}class g extends p{constructor(e,t=new s.k,i=new a.a,n=r.d.Identity){super(i,n),this.m_role=0,this.m_geometryTracker=new l.a,this.m_paths=e,this.m_overlapMode=0,this.m_mergeMode=0,this.changeTracker.replaceListener(void 0,t),l.a.AddListener(t.penChangeTracker,this.m_geometryTracker),l.a.AddListener(t.alphaChangeTracker,this.alphaTracker),l.a.AddListener(this.m_geometryTracker,this.alphaTracker),this.m_style=t}clone(){let e=new g;return e.paths=this.m_paths?this.m_paths.slice(0):void 0,e.m_overlapMode=this.m_overlapMode,e.m_mergeMode=this.m_mergeMode,e.style=this.m_style.clone(),e.m_shape3D=this.m_shape3D,e.text=this.m_text?this.m_text.clone():void 0,e.m_textEffectMetrics=this.m_textEffectMetrics,e.m_role=this.m_role,this.cloneItemData(e),e}static CreateRectangle(e,t=new s.k,i=new a.a,n=r.d.Identity){return new g([o.c.CreateFromRect(e)],t,i,n)}get paths(){return this.m_paths}get incrementalPath(){return this.m_incrementalPath}get overlapMode(){return this.m_overlapMode}get mergeMode(){return this.m_mergeMode}get style(){return this.m_style}get shape3D(){return this.m_shape3D}get text(){return this.m_text}get textEffectMetrics(){return this.m_textEffectMetrics}get role(){return this.m_role}set paths(e){this.m_paths!=e&&(this.clearPathCache(),this.notifyGeometryChange(),this.m_paths=e)}set incrementalPath(e){this.changeTracker.replaceListener(this.m_incrementalPath,e),this.alphaTracker.replaceListener(this.m_incrementalPath,e),this.m_incrementalPath=e}set overlapMode(e){this.m_overlapMode!=e&&(this.notifyGeometryChange(),this.m_overlapMode=e)}set mergeMode(e){this.m_mergeMode!=e&&(this.notifyGeometryChange(),this.m_mergeMode=e)}set style(e){this.m_style!=e&&(l.a.RemoveListener(this.m_style.penChangeTracker,this.m_geometryTracker),l.a.AddListener(e.penChangeTracker,this.m_geometryTracker),l.a.RemoveListener(this.m_style.alphaChangeTracker,this.alphaTracker),l.a.AddListener(e.alphaChangeTracker,this.alphaTracker),this.changeTracker.replaceListener(this.m_style,e),this.m_style=e)}set shape3D(e){this.m_shape3D!=e&&(this.notifyGeometryChange(),this.m_shape3D=e)}set role(e){this.m_role!=e&&(this.notifyChange(),this.m_geometryTracker.notifyChange(),this.m_role=e)}set text(e){this.m_text!=e&&(this.m_text&&(this.m_text.cache&&this.m_text.cache.clearCache(),l.a.RemoveListener(this.m_text.changeTracker,this.changeTracker),l.a.RemoveListener(this.m_text.changeTracker,this.alphaTracker),l.a.RemoveListener(this.m_text.animationChangeTracker,this.animationChangeTracker)),this.m_text=e,this.m_text&&(l.a.AddListener(this.m_text.changeTracker,this.changeTracker),l.a.AddListener(this.m_text.changeTracker,this.alphaTracker),l.a.AddListener(this.m_text.animationChangeTracker,this.animationChangeTracker)))}set textEffectMetrics(e){Object(c.c)(this.changeTracker,this.m_textEffectMetrics,e),Object(c.c)(this.alphaTracker,this.m_textEffectMetrics,e),this.m_textEffectMetrics=e}onTransformChanged(e,t){e.scale.equals(t.scale)||this.m_geometryTracker.notifyChange()}clearCache(){super.clearCache(),this.text&&this.text.cache&&(this.text.cache.clearCache(),this.text.cache=void 0),this.clearPathCache(),this.clearBoundsCache()}clearPathCache(){for(let e of this.paths||[])for(let t in e.renderDataMap)e.renderDataMap[t].releaseGeneratedResources()}clearBoundsCache(){this.shapeBoundsCache=void 0}get geometryTracker(){return this.m_geometryTracker}notifyGeometryChange(){this.notifyChange(),this.m_geometryTracker.notifyChange(),this.clearBoundsCache()}getBrushImages(){const e=this.style.getBrushImages();return this.text&&e.push(...this.text.getBrushImages()),e}isSolidRectGeometry(){return!(!this.m_paths||1!=this.m_paths.length||!this.m_paths[0].isUntransformedRect||1!=this.m_paths[0].fillMode||this.m_paths[0].transform instanceof r.b||this.m_paths[0].transform instanceof r.d&&0!=this.m_paths[0].transform.rotation)}isSolidRect(){return!(!this.isSolidRectGeometry()||this.style.hasLine||this.style.pictureOverflow>0||this.text&&0!=this.text.renderMode)}hasSmallDetails(){return 3==this.role||this.style.hasLine&&this.style.pen.lineWidth<3||this.m_paths&&this.m_paths.some(e=>e.hasPressureInfo)}getType(){return 1}}class _ extends p{constructor(e,t=new a.a,i=r.d.Identity){const n=e instanceof l.b?e:new l.b(e,u.m);super(t,i,n.deferTracking?()=>n.getHash():void 0),this.changeTracker.replaceListener(void 0,n),this.alphaTracker.replaceListener(void 0,n),this.m_items=n,this.m_opacity=1}clone(){const e=new _;for(const t of this.m_items.elements)e.items.push(t.clone());return e.groupFillBrush=this.m_groupFillBrush?this.m_groupFillBrush.clone():void 0,e.m_isDocumentShape=this.m_isDocumentShape,this.cloneItemData(e),e}get items(){return this.m_items}get groupFillBrush(){return this.m_groupFillBrush}get isDocumentShape(){return this.m_isDocumentShape}get opacity(){return this.m_opacity}set groupFillBrush(e){this.m_groupFillBrush=e}set isDocumentShape(e){this.m_isDocumentShape=e}set items(e){this.setItems(e)}set opacity(e){this.m_opacity!=e&&(this.notifyChange(),this.m_opacity=e)}setItems(e){const t=e instanceof l.b?e:new l.b(e);this.changeTracker.replaceListener(this.m_items,t),this.alphaTracker.replaceListener(this.m_items,t),this.m_items=t}clearCache(){super.clearCache();for(let e=0;e<this.m_items.length;e++)this.m_items.getAt(e).clearCache()}getBrushImages(){const e=Object(s.l)(this.groupFillBrush);for(const t of this.m_items.elements)e.push(...t.getBrushImages());return e}getType(){return 2}}function v(e,t){if(!e)return!0;if(1==e.getType()){const i=e;if(t(i),i.text&&i.text.cache){for(const e of i.text.cache.getTextShapes())if(!v(e,t))return!1;for(const e of i.text.cache.getSelectionShapes()||[])if(!v(e,t))return!1}}else{if(2!=e.getType())throw d.a.Error(591525086,"Unknown Item type");{const i=e;for(const e of i.items.elements)if(!v(e,t))return!1}}return!0}function y(e,t){v(e,e=>{for(const i of e.paths||[])if(!t(i))return!1;return!0})}function b(e){return 1==e.alignment?-1:2==e.alignment?1:0}function S(e,t,i){if(e.incrementalPath)return i?e.incrementalPath.bounds.transformedBounds(i):e.incrementalPath.bounds;e.shapeBoundsCache&&e.shapeBoundsCache.geometryVersion==e.geometryTracker.version||(e.shapeBoundsCache={geometryVersion:e.geometryTracker.version});let a=0;t&&e.style.hasLine&&(a=e.style.pen.adjustedLineWidth*(.5+Math.abs(Math.max(b(e.style.pen))))),t&&e.shape3D&&e.shape3D.adjustedContourWidth>0&&(a+=.5*e.shape3D.adjustedContourWidth);const s=!i||i.isSimpleScaleTranslationOnly();let o=a?e.shapeBoundsCache.pathsBoundsWithLine:e.shapeBoundsCache.pathsBounds;if(!o&&!a&&s&&e.paths&&(o=e.shapeBoundsCache.pathsBounds=Object(n.c)(e.paths)),o){if(!i)return o;if(s)return o.multiply(i.getSimpleScale()).translate(i.getSimpleTranslation())}let l=a?e.shapeBoundsCache.pathsBoundsContributorsWithLine:e.shapeBoundsCache.pathsBoundsContributors;if(!l){const t=r.b.Scale2D(e.transform.scale);l=[],e.paths&&Object(n.a)(e.paths,a,e.style,t,null!=e.shape3D,l),a?e.shapeBoundsCache.pathsBoundsContributorsWithLine=l:e.shapeBoundsCache.pathsBoundsContributors=l}const d=r.b.Scale2D(e.transform.scale.inverse()),h=i?d.multiply(i):d;let c=void 0;for(const e of l||[]){const t=Object(n.b)(e,h);c=r.c.UnionRect(c,t)}if(c&&s){const n=null==i?void 0:i.getSimpleScale();if(!i||n&&Math.abs(n.x)>r.h&&Math.abs(n.y)>r.h){const r=i?c.translate(i.getSimpleTranslation().negate()).multiply(i.getSimpleScale().inverse()):c;t?e.shapeBoundsCache.pathsBoundsWithLine=r:e.shapeBoundsCache.pathsBounds=r}}return c}function T(e,t,i,n,a,s=!0,o,l=!1){let d=l?e.animationTransform:void 0,h=a&&d?a.multiply(d):a||d;const c=h?e.transform.toMatrix3().multiply(h):e.transform.toMatrix3();let u=void 0;if(1==e.getType()){const i=e;if(o||(u=S(i,!0,c)),i.text&&t&&(s||o)){const n=new r.d(r.e.Zero,r.e.One,e.transform.rotation,e.transform.translation),s=i.text.hasAnimationProps()?a:h,d=s?n.toMatrix3().multiply(s):n.toMatrix3(),c=E(i);if(c)for(let e of c.textShapes)o&&e.textRange&&!o.intersects(e.textRange)||(u=r.c.UnionRect(u,e.getBounds(l,t,!0,d)))}}else if(2==e.getType()&&!o&&s){const i=e;for(let e=0;e<i.items.length;e++){const a=i.items.getAt(e),s=a instanceof g&&3==a.role;!t&&s||(u=r.c.UnionRect(u,T(a,t,n,n,c)))}}if(!o){let a,s;const o=1&i&&e.effects&&e.effects.glow&&e.effects.glow.radius,l=2&i&&e.effects&&e.effects.shadow,d=4&i&&e.effects&&e.effects.reflection;if((o||l||d)&&(s=h?T(e,t,i,n):u),(l||d)&&(a=e.effectsBoundsOverride?e.effectsBoundsOverride:T(e,!1,0,1)),u&&s&&1&i&&e.effects&&e.effects.glow&&e.effects.glow.radius&&(s=s.inflate(2*e.effects.glow.radius),u=u.inflate(2*e.effects.glow.radius)),(l||d)&&!t&&e instanceof g&&e.text){const t=T(e,!0,i,n);t&&(s=r.c.UnionRect(s,t))}if(u&&s&&a&&2&i&&e.effects&&e.effects.shadow){const t=M(e.effects.shadow.alignment,a),i=C(e.effects.shadow.angle,e.effects.shadow.distance,e.effects.shadow.scale,e.effects.shadow.skew,t),n=(e.effects.shadow.radius?s.inflate(e.effects.shadow.radius):s).transformedBounds(h?i.multiply(h):i),o=(e.effects.shadow.radius?s.inflate(e.effects.shadow.radius):s).transformedBounds(h?i.multiply(h):i);s=r.c.UnionRect(s,n),u=r.c.UnionRect(u,o)}if(u&&s&&a&&4&i&&e.effects&&e.effects.reflection){let t=e.effects.reflection,i=a.bottom+e.effects.reflection.distance/2;e instanceof g&&e.textEffectMetrics&&(i-=e.textEffectMetrics.descent);const n=r.b.Translation2D(new r.e(0,-i)).multiply(r.b.Scale2D(new r.e(1,-1))).multiply(r.b.Translation2D(new r.e(0,i))),o=(t.radius?s.inflate(t.radius):s).transformedBounds(n),l=h?(t.radius?s.inflate(t.radius):s).transformedBounds(n.multiply(h)):o;u=r.c.UnionRect(u,l)}}return u}const w=[new r.e(0,0),new r.e(.5,0),new r.e(1,0),new r.e(0,.5),new r.e(.5,.5),new r.e(1,.5),new r.e(0,1),new r.e(.5,1),new r.e(1,1)];function M(e,t){return t?w[e].multiply(t.size).add(t.leftTop):w[e]}function C(e,t,i,n,a){const s=r.b.Translation2D(a.negate()),o=new r.e(t,0).rotate(e).add(a),l=new r.b(i.x,n.y,0,n.x,i.y,0,o.x,o.y,1);return s.multiply(l)}function I(e,t){const i=e.getType();if(1==i){const i=e.style;switch(t){case 0:return i.fillBrush;case 1:return i.lineBrush;case 2:return i.pictureBrush}}if(2==i&&0==t)return e.groupFillBrush;d.a.Error(591192835,"Invalid item or brush")}function P(e){if(e.isSolidRectGeometry()&&!e.style.hasLine&&!e.effects.hasEffects&&!e.shape3D&&!e.text&&(e.style.fillBrush||e.style.pictureBrush)&&(!e.style.fillBrush||!e.style.pictureBrush)){const t=e.style.fillBrush||e.style.pictureBrush;if(t instanceof s.e&&t.isStretched&&t.scale.equals(r.e.One)&&t.offset.equals(r.e.Zero)&&t.rotateWithShape&&1===t.opacity)return t.image}}function E(e){if(e.text)return e.text.cache||(e.text.cache=new f.a),e.text.cache.update(e.text),e.text.cache}},function(e,t,i){"use strict";var r;i.r(t),i.d(t,"TraceLevel",(function(){return r})),i.d(t,"VetoUtils",(function(){return n.a})),i.d(t,"UserActionUtils",(function(){return a.a})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(r={}));var n=i(109),a=i(110)},function(e,t,i){"use strict";i.d(t,"K",(function(){return r})),i.d(t,"B",(function(){return n})),i.d(t,"J",(function(){return a})),i.d(t,"k",(function(){return s})),i.d(t,"l",(function(){return o})),i.d(t,"L",(function(){return l})),i.d(t,"C",(function(){return d})),i.d(t,"G",(function(){return h})),i.d(t,"E",(function(){return c})),i.d(t,"D",(function(){return u})),i.d(t,"H",(function(){return f})),i.d(t,"F",(function(){return m})),i.d(t,"z",(function(){return p})),i.d(t,"A",(function(){return g})),i.d(t,"f",(function(){return _})),i.d(t,"I",(function(){return v})),i.d(t,"i",(function(){return y})),i.d(t,"h",(function(){return b})),i.d(t,"j",(function(){return S})),i.d(t,"g",(function(){return T})),i.d(t,"w",(function(){return w})),i.d(t,"x",(function(){return M})),i.d(t,"u",(function(){return C})),i.d(t,"v",(function(){return I})),i.d(t,"o",(function(){return P})),i.d(t,"p",(function(){return E})),i.d(t,"m",(function(){return x})),i.d(t,"n",(function(){return A})),i.d(t,"s",(function(){return k})),i.d(t,"q",(function(){return R})),i.d(t,"t",(function(){return O})),i.d(t,"r",(function(){return L})),i.d(t,"y",(function(){return F})),i.d(t,"a",(function(){return D})),i.d(t,"b",(function(){return B})),i.d(t,"c",(function(){return N})),i.d(t,"d",(function(){return V})),i.d(t,"e",(function(){return U}));const r="www.youtube.com",n=56.6,a=6,s=60,o=96,l="https://www.youtube.com/iframe_api",d="#FFFFFF",h="#FFFFFF59",c="#FFFFFFB2",u="Highlight",f="ButtonFace",m="ButtonText",p=[2,1.75,1.5,1.25,1,.5],g="x",_=36,v="video-captions-render-window",y="CaptionsLang",b="CaptionsLabel",S=.6,T=.04,w=35,M=35,C="/mediasvc/api/media/getoembedproviders",I="/mediasvc/api/media/oembed",P="Content-Type",E="X-CorrelationId",x="Accept-Language",A="Authorization",k="Inserted URL is either not a valid video or can't be embedded",R="Inserted URL is not from a currently supported video provider",O="The online video service failed, please try again",L="This video could not be played because it either was not found or you do not have access to it.",F={YouTube:["https://(\\w+\\.)?youtube(-nocookie)?\\.[a-zA-Z]{2,3}/(watch|playlist|v|embed)/.*","https://(\\w+\\.)?youtube(-nocookie)?\\.com\\.br/(watch|playlist|v|embed)/.*","https://(\\w+\\.)?youtube(-nocookie)?\\.co\\.uk/(watch|playlist|v|embed)/.*","https://([\\-\\w]+\\.)?youtube(-nocookie)?\\.[a-zA-Z]{2,3}/(watch|playlist)\\?.*","https://([\\-\\w]+\\.)?youtube(-nocookie)?\\.com\\.br/(watch|playlist)\\?.*","https://([\\-\\w]+\\.)?youtube(-nocookie)?\\.co\\.uk/(watch|playlist)\\?.*","https://youtu\\.be/.*","https://youtube(-nocookie)?\\.com/gif.*","https://www\\.youtube(-nocookie)?\\.com/gif.*","https://www\\.youtube(-nocookie)?\\.com/shorts.*"],Vimeo:["https://(\\w+\\.)?(player\\.)?vimeo\\.com/.*"],Flip:["https://(\\w+\\.)?flipgrid\\.com/s/.*","https://(\\w+\\.)?flip\\.com/s/.*","https://(\\w+\\.)?shorts\\.flipgrid\\.com/watch/.*","https://(\\w+\\.)?shorts\\.flip\\.com/watch/.*"],StreamClassic:["https://(\\w+\\.)?microsoftstream\\.com/embed/video/.*","https://(\\w+\\.)?microsoftstream\\.com/video/.*"],Ted:["https://embed\\.ted\\.com/talks/.*","https://www\\.ted\\.com/talks/.*","https://www\\.ted\\.com/index\\.php/talks/.*\\.html.*"],SlideShare:["https://(\\w+\\.)?slideshare\\.net/.*"]},D="aria-checked",B="aria-expanded",N="aria-haspopup",V="aria-label",U="aria-valuetext"},function(e,t,i){"use strict";function r(e,t,i){t!=i&&e.notifyChange()}function n(e,t,i){t==i||t&&i&&t.equals(i)||e.notifyChange()}function a(e,t,i){if(t!=i)if(t&&i&&t.length==i.length){for(let r=0;r<t.length;r++)if(t[r]!=i[r])return void e.notifyChange()}else e.notifyChange()}function s(e,t,i){if(t!=i)if(t&&i&&t.length==i.length){for(let r=0;r<t.length;r++)if(!t[r].equals(i[r]))return void e.notifyChange()}else e.notifyChange()}i.d(t,"a",(function(){return r})),i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return a})),i.d(t,"d",(function(){return s}))},function(e,t,i){"use strict";i.d(t,"g",(function(){return c})),i.d(t,"e",(function(){return u})),i.d(t,"f",(function(){return f})),i.d(t,"n",(function(){return m})),i.d(t,"m",(function(){return p})),i.d(t,"j",(function(){return g})),i.d(t,"c",(function(){return _})),i.d(t,"o",(function(){return v})),i.d(t,"l",(function(){return y})),i.d(t,"i",(function(){return b})),i.d(t,"p",(function(){return S})),i.d(t,"b",(function(){return T})),i.d(t,"a",(function(){return w})),i.d(t,"d",(function(){return I})),i.d(t,"h",(function(){return x})),i.d(t,"k",(function(){return k}));var r=i(46),n=i(7),a=i(16),s=i(0),o=i(5),l=i(78),d=i(34),h=i(18);let c=1,u=1;const f=4096,m=2048,p=2,g=256;class _{constructor(){this.textureMemoryAllocated=0,this.allocatedTextures=[]}register(e){this.textureMemoryAllocated+=e.memoryUsage,this.allocatedTextures.push(e)}unregister(e){this.textureMemoryAllocated-=e.memoryUsage,this.allocatedTextures=this.allocatedTextures.filter(t=>t!==e)}}function v(e){c=u=e}let y=!0;function b(e){y=e}function S(e,t){return{center:e.center.add(t.preTranslation).multiply(t.scale).rotate(t.rotation).add(t.translation),size:e.size.multiply(t.scale.abs()),rotation:t.rotation,flipX:t.scale.x<0,flipY:t.scale.y<0}}class T{constructor(e,t,i,n,l,h,c){if(this.m_originalSize=s.e.Zero,this.m_changeTracker=new a.a,this.m_compatibleGraphicsProcessorId=0,this.m_isMipMapped=!1,this.m_usageRecord=[],!t.isValid())throw o.a.Message(512297123,"Unable to create texture on invalid renderer");if(A(l),this.wrapMode=h,this.releasePolicy=c,this.scenario=e,this.creationTime=performance.now(),this.m_lastRenderTime=i?performance.now():void 0,!isFinite(n.x)||!isFinite(n.y)||n.x<=0||n.y<=0){const t=d.a.readBooleanOrDefault("throwOnInvalidTextureSize",!1),i=o.a.Error(572319067,`Invalid texture size: ${n.x} x ${n.y}, scenario: ${e}`);if(t)throw i}else{const a=n.ceil();if(a.equals(n)||o.a.Error(572319068,`Bad texture size. Should be positive integers: ${n.x} x ${n.y}, scenario: ${e}`),this.m_graphicsProcessor=t.getGraphicsProcessor(),!this.m_graphicsProcessor)throw o.a.Error(592525214,"Unable to set texture if processor not initialized");if(this.m_originalSize=a,this.m_babylonTexture=i instanceof r.InternalTexture?i:i?this.m_graphicsProcessor.createTextureGraphicsResourceFromExternalWebGLTexture(a,l,i,void 0):void 0,this.m_compatibleGraphicsProcessorId=this.m_graphicsProcessor.getUniqueGraphicsProcessorId(),this.m_babylonTexture){const i=T.GetRequiredSizeForWrapMode(this.m_graphicsProcessor,a,h);if(4!=h&&!i.equals(a)){if(d.a.readBooleanOrDefault("noResample",!1))throw o.a.Error(572303306,"Invalid texture size for non-clamp scenario: ${scenario}");o.a.Error(572867283,"Texture size not supported for this wrap mode. The texture will be resampled and the copy will be managed by ShapeBuilder. Please conside resampling explicitely using WrapMode.clamp and cloneWithNewWrapMode when necessary. Scenario: "+e);const r=T.ResampleBabylonTexture(t,this.m_babylonTexture,this.originalSize,4,i,h,l);2==this.releasePolicy?this.releasePolicy=0:this.m_babylonTexture.dispose(),this.m_babylonTexture=r}}}const u=t;this.m_textureManager=u.getTextureManager(),this.m_textureManager.register(this)}static CreateFromByteBuffer(e,t,i,r,n,a,s,o,l,d,h){return T.CreateOrUpdateFromByteBuffer(e,void 0,t,i,r,n,a,s,o,l,d,h)}static CreateOrUpdateFromByteBuffer(e,t,i,r,n,a,l,d,h,c,u,f){var m,p;if(!i.isValid())throw o.a.Message(512297122,"Unable to create/update texture on invalid renderer");let g=t;const _=i.getGraphicsProcessor();if(!_)throw o.a.Error(592525215,"No Graphics Processor");const v=-1==a||-3==a?4:-2==a?5:a;if(!g||g.isValidForGraphicsProcessor(_)&&g.size.equals(r)&&g.m_babylonTexture&&g.format==v&&g.wrapMode==l&&g.m_babylonTexture.invertY==!!h||(g.release(),g=void 0),4==a||5==a||1==a||2==a){if(g&&g.m_babylonTexture)return _.updateTextureGraphicsResourceFromByteBuffer(g.m_babylonTexture,n,n instanceof Float32Array,f||4),g.changeTracker.notifyChange(),g.m_lastRenderTime=performance.now(),g;{const t=_.createTextureGraphicsResource(r,n,a,n instanceof Float32Array,!1,!1,l,d,!!h,f);return new T(e,i,t,r,a,l,null==c?0:c)}}if(-1==a||-2==a||-3==a){const t=(null==g?void 0:g.m_textureConverterCache)||{},o=-3==a?1:v,c=-1==a||-2==a;t.primary=T.CreateOrUpdateFromByteBuffer(e+"/primary",t.primary,i,r,n,o,l,d,h,0,u,f),t.secondary=-3==a?T.CreateOrUpdateFromByteBuffer(e+"/secondary",t.secondary,i,new s.e(Math.ceil(.5*r.x),Math.ceil(.5*r.y)),n.slice(r.x*Math.ceil(r.y/(f||4))*(f||4)),2,l,d,h,0,u,f):void 0;let _=void 0;if(t.primary.m_babylonTexture&&(_=T.ConvertTexture(e,i,g instanceof w?g:void 0,t.primary,c,t.secondary,v),_&&u?_.m_textureConverterCache=t:(null===(m=t.primary)||void 0===m||m.release(),null===(p=t.secondary)||void 0===p||p.release()),_))return _.m_lastRenderTime=performance.now(),_}throw o.a.Error(507910019,"Unsupported texture format")}static CreateFromHTMLElement(e,t,i,r=4,n=!0){if(!t.isValid())throw o.a.Message(512297121,"Unable to create texture on invalid renderer");const a=t.getGraphicsProcessor();if(!a)throw o.a.Error(592525216,"No Graphics Processor");const l=new s.e(i.width,i.height),d=a.createTextureGraphicsResource(l,i,5,!1,!1,!1,r,n,!0);return new T(e,t,d,l,5,r,0)}static CreateFromHTMLImageElement(e,t,i,r=4,n=!0){return T.CreateFromHTMLElement(e,t,i,r,n)}static CreateOrUpdateFromHTMLElement(e,t,i,r,n=4,a=!0){if(!i.isValid())throw o.a.Message(512297120,"Unable to create/update texture on invalid renderer");const l=i.getGraphicsProcessor();if(!l)throw o.a.Error(507910018,"No Graphics Processor");const d=new s.e(r.width,r.height);if(t){if(t.isValidForGraphicsProcessor(l)&&t.m_babylonTexture&&t.size.equals(d)&&t.wrapMode==n)return l.updateTextureGraphicsResourceFromHTMLElement(t.m_babylonTexture,r,!0),t.changeTracker.notifyChange(),t.m_lastRenderTime=performance.now(),t;t.release()}return T.CreateFromHTMLElement(e,i,r,n,a)}static CreateFromTextureAndMask(e,t,i,r,n,a=4,s=!0){const o=t,l=new w(e,t,n,0,{disableFiltering:!s,wrapMode:a});return o.drawTextureToTexture(l,i,4,{secondaryTexture:r}),l}get graphicsProcessor(){return this.m_graphicsProcessor}get size(){return this.m_babylonTexture?new s.e(this.m_babylonTexture.width,this.m_babylonTexture.height):s.e.Zero}get originalSize(){return this.m_originalSize}get changeTracker(){return this.m_changeTracker}get lastUsage(){return this.m_usageRecord.length>0?Math.max(...this.m_usageRecord.map(e=>e.lastUsage)):0}get format(){return this.m_babylonTexture?this.m_babylonTexture.format:(o.a.Error(572073351,"No texture, no format"),5)}get memoryUsage(){if(!this.graphicsProcessor)return 0;let e=l.d[this.format],t=0,i=0;if(this.m_babylonTexture){switch(this.m_babylonTexture.type){case 0:t=1;break;case 1:t=4;break;case 2:t=2;break;default:o.a.Error(572867285,"Unknown texture type")}i=this.m_babylonTexture._generateStencilBuffer?1:0}return Math.ceil(this.size.x*this.size.y*(e*t+i)*(this.m_isMipMapped?4/3:1))}get usageRecord(){return this.m_usageRecord}get lastRenderTime(){return this.m_lastRenderTime}tryUseBabylonTexture(e,t,i){const r=this.m_usageRecord.find(e=>e.clientObject==t);return r?(r.lastScenario=i,r.lastUsage=performance.now(),r.usageCount++):this.m_usageRecord.push({clientObject:t,lastScenario:i,lastUsage:performance.now(),usageCount:1}),this.isValidForGraphicsProcessor(e)?this.m_babylonTexture:void 0}set originalSize(e){this.m_changeTracker.notifyChange(),this.m_originalSize=e}set contentLocation(e){this.m_changeTracker.notifyChange(),this.m_contentLocation=e}generateMipMap(){const e=this.graphicsProcessor;e&&this.m_babylonTexture?(e.generateMipMap(this.m_babylonTexture),this.m_textureManager&&(this.m_textureManager.textureMemoryAllocated-=this.memoryUsage),this.m_isMipMapped=!0,this.m_textureManager&&(this.m_textureManager.textureMemoryAllocated+=this.memoryUsage)):o.a.Error(592525218,"Cannot generate mipmaps")}isValidForGraphicsProcessor(e){return this.m_babylonTexture&&this.m_graphicsProcessor==e&&this.m_compatibleGraphicsProcessorId==e.getUniqueGraphicsProcessorId()}isValid(e){const t=e.getGraphicsProcessor();return t&&this.isValidForGraphicsProcessor(t)}getState(e){const t=e.getGraphicsProcessor();return this.m_babylonTexture?t&&this.m_graphicsProcessor==t?this.isValidForGraphicsProcessor(t)?0==this.m_babylonTexture._references?2:0:4:3:1}tryGetWebGLTexture(){return this.m_babylonTexture&&this.m_babylonTexture._webGLTexture||void 0}unregisterFromTextureManager(){this.m_textureManager&&(this.m_textureManager.unregister(this),this.m_textureManager=void 0)}release(){var e,t,i,r;this.unregisterFromTextureManager(),this.m_babylonTexture&&2!=this.releasePolicy&&this.m_babylonTexture.dispose(),this.m_babylonTexture=void 0,null===(t=null===(e=this.m_textureConverterCache)||void 0===e?void 0:e.primary)||void 0===t||t.release(),null===(r=null===(i=this.m_textureConverterCache)||void 0===i?void 0:i.secondary)||void 0===r||r.release(),this.m_changeTracker.notifyChange()}get contentLocation(){const e=this.size;return this.m_contentLocation?this.m_contentLocation:{logicalCenter:e.scale(.5),logicalSize:e,physicalCenter:e.scale(.5),physicalSize:e,rotation:0,flipX:!1,flipY:!1}}get isMipMapped(){return this.m_isMipMapped}cloneWithNewWrapMode(e,t,i,r){const n=this.m_graphicsProcessor;if(!n||!this.m_babylonTexture||!this.isValidForGraphicsProcessor(n))return void o.a.Error(592472278,"Failed to get graphicsProcessor or valid texture");this.wrapMode==i&&o.a.Error(592472277,"Why cloning if the wrapmode is the same?");const a=T.GetRequiredSizeForWrapMode(n,this.size,i),s=T.ResampleBabylonTexture(t,this.m_babylonTexture,this.originalSize,this.wrapMode,a,i,this.format);if(!s)return;const l=new T(e,t,s,a,this.m_babylonTexture.format,i,r);return l.originalSize=this.originalSize,l}static GetRequiredSizeForWrapMode(e,t,i){return e.needPowerOf2TexturesForTilingOrMipMap()&&4!=i?function(e){return new s.e(Object(s.g)(Object(s.k)(e.x),1,2048),Object(s.g)(Object(s.k)(e.y),1,2048))}(t):t}static ResampleBabylonTexture(e,t,i,r,n,a,s){const l=e,d=l.getGraphicsProcessor();if(!d)return void o.a.Error(572867286,"Failed to get graphicsProcessor");const h=new T("TMP/ResampleSrc",e,t,i,t.format,r,2),c=new w("TMP/ResampleDst",e,n,0,{disableFiltering:1==t.samplingMode,format:s});l.drawTextureToTexture(c,h,0);const u=c.m_babylonTexture;return c.unregisterFromTextureManager(),c.m_babylonTexture=void 0,c.release(),u&&d.setWrapMode(u,a),h.release(),u}static ConvertTexture(e,t,i,r,n,a,s){var l;const d=t;if(!d.getGraphicsProcessor())return void o.a.Error(526714142,"Failed to get graphicsProcessor");const h=1==(null===(l=r.m_babylonTexture)||void 0===l?void 0:l.samplingMode),c=w.RecycleOrReplace(e,i,t,r.size,!1,s,!1,0,r.wrapMode,h);return d.drawTextureToTexture(c,r,n?2:a?3:0,{secondaryTexture:a}),c}}class w extends T{constructor(e,t,i=s.e.Zero,r,n){if(!t.isValid())throw o.a.Message(512297119,"Unable to create TargetTexture on invalid renderer");const a=i.ceil(),l=n&&void 0!==n.wrapMode?n.wrapMode:4,d=t,h=d.getGraphicsProcessor();if(!h)return void o.a.Error(592525217,"Graphics processor not initialized");if(a.isZero())return void o.a.Error(572867287,"Creating TargetTexture of size 0x0");const c=n&&n.format?n.format:5;A(c);let u=void 0;u=n&&n.externalTexture?h.createTextureGraphicsResourceFromExternalWebGLTexture(a,c,n.externalTexture,n?n.externalFrameBuffer:void 0):h.createTextureGraphicsResource(a,void 0,c,!(!n||!n.useFloat),!0,!!n&&!!n.needsRenderBuffer,l,!n||!n.disableFiltering,!1),super(e,t,u,a,c,l,r),2!=r&&(d.getCurrentFramePerformanceSummary().dynamicTextureAlloc+=this.memoryUsage)}tryGetBabylonTextureForRenderToTexture(e){return this.m_lastRenderTime=performance.now(),this.isValidForGraphicsProcessor(e)?this.m_babylonTexture:void 0}tryConvertToBufferRGBA(){if(this.m_graphicsProcessor&&this.m_babylonTexture)return this.m_graphicsProcessor.copyTexturePixelsToArray(this.m_babylonTexture,s.c.FromSize(this.size),!0)}tryConvertToCanvas(){if(!this.m_graphicsProcessor||!this.m_babylonTexture)return;const e=document.createElement("canvas");e.width=this.m_babylonTexture.width,e.height=this.m_babylonTexture.height;var t=e.getContext("2d");if(t){const i=this.tryConvertToBufferRGBA();if(i){const r=this.size,n=t.createImageData(r.x,r.y);return n.data.set(i),t.putImageData(n,0,0),t.globalCompositeOperation="copy",t.setTransform(1,0,0,-1,0,r.y),t.drawImage(e,0,0),e}}}tryConvertToDataURL(){const e=this.tryConvertToCanvas();if(e)return e.toDataURL()}static RecycleOrReplace(e,t,i,r,n,a,s,l,d,h){A(a);const c=i.getGraphicsProcessor();if(t){if(c&&t.isValidForGraphicsProcessor(c)&&t.size.equals(r)&&t.m_babylonTexture&&t.m_babylonTexture.format==a)return t.releasePolicy!=l&&o.a.Error(572867288,"RecycleOrReplace with different releasePolicy"),t;t.release()}return new w(e,i,r,l,{format:a,needsRenderBuffer:s,useFloat:n,wrapMode:d,disableFiltering:h})}}const M=[{attributeName:"a_0",attributeSize:4,offset:0}],C=[{attributeName:"a_1",attributeSize:4,offset:0}];function I(e,t,i,r,n){const a=t.originalSize.x/t.originalSize.y;E(e,t,t,n,0,a,[new s.c(0,0,t.size.x,t.size.y)],[new s.c(0,0,n.size.x,n.size.y)],n.size,r),E(e,t,n,i,1,a,[new s.c(0,0,n.size.x,n.size.y)],[new s.c(0,0,i.size.x,i.size.y)],i.size,r)}function P(e,t,i){0==e.length&&o.a.Error(509634196,"Cannot create vertex buffer array from empty rectangle array.");const r=new Float32Array(4*i);for(let n=0;n<i;n++){const i=e[Math.min(n,e.length-1)];r[4*n+0]=i.left/t.x,r[4*n+1]=i.top/t.y,r[4*n+2]=i.right/t.x,r[4*n+3]=i.bottom/t.y}return r}function E(e,t,i,r,a,s,l,d,h,c){const u=e.getGraphicsProcessor();if(!u||!u.isValid())return void o.a.Error(509634336,"Invalid Graphics Processor for Sharpness Filter");if(!i.isValidForGraphicsProcessor(u))return void o.a.Error(509634335,"Invalid Texture for Sharpness Filter");const f=Math.max(l.length,d.length);if(0==f)return;const m=P(l,i.size,f),p=P(d,h,f),g=u.activateShaderProgram(9);g.begin(r.tryGetBabylonTextureForRenderToTexture(u),n.b.Transparent,!0);const _=u.getBabylonEngine(),v=_.createVertexBuffer(m),y=_.createVertexBuffer(p);_.bindInstancesBuffer(v,M,!1),_.bindInstancesBuffer(y,C,!1),g.setTexture("t_0",i.tryUseBabylonTexture(u,void 0,"sharpnessFilterPass")),g.setTexture("t_1",t.tryUseBabylonTexture(u,void 0,"sharpnessFilterPass"));const b=c.sharpness,S=b<0?10.5*-b:1.25*b,T=b<0?1+.8*-b:1,w=1==a&&b>0;g.getBabylonEffect().setFloat("ufrag_0",S),g.getBabylonEffect().setFloat("ufrag_1",T),g.getBabylonEffect().setFloat("ufrag_2",s),g.getBabylonEffect().setInt("ufrag_3",a),g.getBabylonEffect().setBool("ufrag_4",w),g.drawQuadInstances(f),g.disableInstanceAttribute("a_0"),g.disableInstanceAttribute("a_1"),_._releaseBuffer(v),_._releaseBuffer(y),g.end()}function x(e,t,i,r,a,l,d,c=1,u,f){var m,p,g,_,v,y,b,S,T,w;if(!i.isValidForGraphicsProcessor(e))return void o.a.Error(591192838,"Invalid Texture");const I=Math.max(r.length,a.length);if(0==I)return;const E=P(r,i.size,I),x=P(a,l,I),A=e.getBabylonEngine(),k=A.createVertexBuffer(E),R=A.createVertexBuffer(x);if(A.bindInstancesBuffer(k,M,!1),A.bindInstancesBuffer(R,C,!1),t.setTexture("t_0",i.tryUseBabylonTexture(e,void 0,"drawTextureRects")),8!=t.programId&&t.getBabylonEffect().setFloat("ufrag_0",c),6==t.programId){const r=null==f?void 0:f.secondaryTexture;t.setTexture("t_1",null==r?void 0:r.tryUseBabylonTexture(e,void 0,"drawTextureRects/Secondary")),t.getBabylonEffect().setInt("ufrag_1",d),function(e,t){const i=null==t?void 0:t.brightnessContrast;if(i){let t,r;h.y?(t=1,r=i.brightness):i.brightness>=1?(t=0,r=1):(t=i.brightness>0?1/(1-i.brightness):Math.max(0,1+i.brightness),r=0),e.getBabylonEffect().setInt("ufrag_3",1),e.getBabylonEffect().setArray2("ufrag_4",[t,r]),e.getBabylonEffect().setArray4("ufrag_5",function(e){if(h.z)return[0,0,e,(1-e)/2];const t=Math.min(Math.abs(e/4),1/4-1/65025),i=64*t*t*t-48*t*t-4*t+3,r=-64*t/i,n=96*t/i,a=(i-32*t)/i;if(e>=0)return[r,n,a,0];const s=Math.max(0,(-n+Math.sqrt(n*n-4*r*a))/(2*r));return[(64*t-32*s)/3,-32*t+16*s,(32*t-22*s+3)/3,s]}(i.contrast))}else e.getBabylonEffect().setInt("ufrag_3",0);const r=null==t?void 0:t.hueSaturationLuminance;r?(e.getBabylonEffect().setInt("ufrag_6",1),e.getBabylonEffect().setFloat("ufrag_7",r.hueRotation),e.getBabylonEffect().setFloat("ufrag_8",r.saturationFactor),e.getBabylonEffect().setFloat("ufrag_9",r.luminanceFactor)):e.getBabylonEffect().setInt("ufrag_6",0);const n=null==t?void 0:t.recolor;if(n){const t=void 0===n.threshold?1:255,i=void 0===n.threshold?0:.5-t*n.threshold;e.getBabylonEffect().setInt("ufrag_10",1),e.getBabylonEffect().setFloat("ufrag_11",t),e.getBabylonEffect().setFloat("ufrag_12",i),e.getBabylonEffect().setVector3("ufrag_13",{x:n.darkColor.r,y:n.darkColor.g,z:n.darkColor.b}),e.getBabylonEffect().setVector3("ufrag_14",{x:n.brightColor.r,y:n.brightColor.g,z:n.brightColor.b})}else e.getBabylonEffect().setInt("ufrag_10",0);const a=null==t?void 0:t.colorTemperature;a?(e.getBabylonEffect().setInt("ufrag_15",1),e.getBabylonEffect().setFloat("ufrag_16",a.redGain),e.getBabylonEffect().setFloat("ufrag_17",a.blueGain),e.getBabylonEffect().setFloat("ufrag_18",a.greenGain)):e.getBabylonEffect().setInt("ufrag_15",0);const s=null==t?void 0:t.sharpness;h.A&&s?(e.getBabylonEffect().setInt("ufrag_20",1),e.getBabylonEffect().setFloat("ufrag_21",s.sharpness)):e.getBabylonEffect().setInt("ufrag_20",0);const o=null==t?void 0:t.highlightsShadows;o?(e.getBabylonEffect().setInt("ufrag_25",1),e.getBabylonEffect().setDirectColor4("ufrag_26",o.neutral),e.getBabylonEffect().setDirectColor4("ufrag_27",o.positive),e.getBabylonEffect().setDirectColor4("ufrag_28",o.negative)):e.getBabylonEffect().setInt("ufrag_25",0)}(t,null==f?void 0:f.pictureEffects),t.getBabylonEffect().setDirectColor4("ufrag_19",u||n.b.Transparent),t.getBabylonEffect().setVector2("ufrag_22",i.size);const a=null==f?void 0:f.lookupTableTexture;if((null===(m=null==f?void 0:f.pictureEffects)||void 0===m?void 0:m.lookupTable)&&a){const i=null==f?void 0:f.pictureEffects.lookupTable;t.getBabylonEffect().setFloat4("ufrag_23",i.dimensionR,i.dimensionG,i.dimensionB,i.blocksPerRow),t.setTexture("t_2",a.tryUseBabylonTexture(e,void 0,"drawTextureRects/lookupTableTexture"))}else t.getBabylonEffect().setFloat4("ufrag_23",0,0,0,0),t.setTexture("t_2",void 0);const s=null==f?void 0:f.ditherPalette256;s?(t.getBabylonEffect().setInt("ufrag_24",1),t.setTexture("t_3",s.tryUseBabylonTexture(e,void 0,"drawTextureRects/ditherPalette256"))):(t.getBabylonEffect().setInt("ufrag_24",0),t.setTexture("t_3",void 0))}else 8==t.programId&&(null==f?void 0:f.textureTransform)&&(t.getBabylonEffect().setVector2("ufrag_22",i.size),t.getBabylonEffect().setMatrix3x3("u_1",null==f?void 0:f.textureTransform.m),t.getBabylonEffect().setInt("ufrag_1",null!==(g=null===(p=null==f?void 0:f.drawMaskParams)||void 0===p?void 0:p.drawMaskMode)&&void 0!==g?g:0),t.getBabylonEffect().setFloat("ufrag_2",null!==(v=null===(_=null==f?void 0:f.drawMaskParams)||void 0===_?void 0:_.drawMaskParam)&&void 0!==v?v:0),t.getBabylonEffect().setVector2("ufrag_3",null!==(b=null===(y=null==f?void 0:f.drawMaskParams)||void 0===y?void 0:y.drawMaskFlipXY)&&void 0!==b?b:s.e.One),t.getBabylonEffect().setInt("ufrag_4",null!==(T=null===(S=null==f?void 0:f.drawMaskParams)||void 0===S?void 0:S.drawMaskOrder)&&void 0!==T?T:0),t.getBabylonEffect().setInt("ufrag_5",(null===(w=null==f?void 0:f.drawMaskParams)||void 0===w?void 0:w.drawMaskTransposeXY)?1:0));t.drawQuadInstances(I),t.disableInstanceAttribute("a_0"),t.disableInstanceAttribute("a_1"),A._releaseBuffer(k),A._releaseBuffer(R)}function A(e){switch(e){case 4:case 5:case 1:case 2:break;default:throw o.a.Error(507910017,"Unsupported texture format")}}function k(e){return 0==(e&e-1)}},function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return s}));var r=i(5),n=i(18);class a{constructor(e,t=!1){this.m_changeTracker=new s,this.deferTracking=t,this.m_changeTracker=new s(t?this.getHash:void 0),this.m_elements=[],e&&(this.elements=e)}getHash(){return this.m_elements.map(e=>e.changeTracker.currentUniqueId).join(",")}get changeTracker(){return this.m_changeTracker}get length(){return this.m_elements.length}get elements(){return this.m_elements}set elements(e){this.removeAll();for(let t of e)this.push(t)}getAt(e){if(e<0||e>=this.elements.length)throw r.a.Error(592520775,"Out of range");return this.m_elements[e]}setAt(e,t){this.deferTracking||(s.RemoveListener(this.getAt(e).changeTracker,this.m_changeTracker),s.AddListener(t.changeTracker,this.m_changeTracker)),this.m_elements[e]=t}push(e){this.deferTracking||s.AddListener(e.changeTracker,this.m_changeTracker),this.m_elements.push(e)}insertAt(e,t){this.deferTracking||s.AddListener(t.changeTracker,this.m_changeTracker),this.m_elements.splice(e,0,t)}removeAll(){if(!this.deferTracking)for(let e of this.m_elements)s.RemoveListener(e.changeTracker,this.m_changeTracker);this.m_elements=[]}removeAt(e){this.deferTracking||s.RemoveListener(this.getAt(e).changeTracker,this.m_changeTracker),this.m_elements.splice(e,1)}}class s{constructor(e){this.trackerId=s.s_nextUniqueId++,this.m_version=0,this.m_getDeferedHashFunction=e,this.m_currentUniqueId=this.trackerId+"v0",n.j&&Object(n.i)()?this.m_weakListeners=[]:this.m_listeners=[]}get version(){return this.m_getDeferedHashFunction&&this.verifyDeferedHash(),this.m_version}get currentUniqueId(){return this.m_getDeferedHashFunction&&this.verifyDeferedHash(),this.m_currentUniqueId}get listenerCount(){var e,t;return(null===(e=this.m_weakListeners)||void 0===e?void 0:e.length)||(null===(t=this.m_listeners)||void 0===t?void 0:t.length)||0}verifyDeferedHash(){if(this.m_getDeferedHashFunction){const e=this.m_getDeferedHashFunction();e!=this.m_deferedHash&&(this.notifyChange(),this.m_deferedHash=e)}}notifyChange(){var e;if(this.m_version++,this.m_currentUniqueId=this.trackerId+"v"+this.m_version,this.m_weakListeners){const t=this.m_weakListeners.length;this.m_weakListeners=this.m_weakListeners.filter(e=>null!=e.deref()),n.k&&t!=this.m_weakListeners.length&&r.a.Message(525337748,`ChangeTracker detaching ${t-this.m_weakListeners.length} zombie dependencies`);for(const t of this.m_weakListeners)null===(e=t.deref())||void 0===e||e.notifyChange()}else if(this.m_listeners)for(const e of this.m_listeners)e.notifyChange()}replaceListener(e,t){e!=t&&(e&&s.RemoveListener(e.changeTracker,this),t&&s.AddListener(t.changeTracker,this))}static AddListener(e,t){if(e)if(e.m_weakListeners){if(void 0===e.m_weakListeners.find(e=>e.deref()===t)){if("undefined"==typeof WeakRef)throw r.a.Error(525337749,"WeakRef not supported");e.m_weakListeners.push(new WeakRef(t)),t.notifyChange()}}else{if(!e.m_listeners)throw r.a.Error(525337750,"No dependency array");-1==e.m_listeners.indexOf(t)&&(e.m_listeners.push(t),t.notifyChange())}}static RemoveListener(e,t){if(e)if(e.m_weakListeners)e.m_weakListeners=e.m_weakListeners.filter(e=>e.deref()!=t),t.notifyChange();else if(e.m_listeners){const i=e.m_listeners.indexOf(t);-1!=i&&(e.m_listeners.splice(i,1),t.notifyChange())}}}s.s_nextUniqueId=1},function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return m}));var r,n,a=i(4),s=i(2),o=i(3),l=i(10),d=i(30),h=i(12),c=i(58),u=i(6),f=i(1);!function(e){e.Init="init",e.Goto="goto",e.Prefetch="prefetch",e.Prerender="prerender",e.CheckHidden="CheckHidden",e.UpdateResourceProviders="UpdateResourceProviders",e.ChangeRenderingModeToSVG="ChangeRenderingModeToSVG"}(r||(r={})),function(e){e.EnsureSlideView="ensureSlideView",e.ResizeViewContainer="resizeViewContainer",e.RenderTransition="renderTransition",e.RenderSlide="renderSlide",e.ReloadTexture="reloadTexture"}(n||(n={}));class m{static init(e){this.m_settings=e}static recordInitData(e){if(!e.hasOwnProperty(r.Init))return;const t={sessionId:this.m_settings.appSettings.userSessionId,InitInfo:e,initDurFromEndUser:e[r.Init].end-this.m_settings.appSettings.initTime,initDur:e[r.Init].end-e[r.Init].start,Config:l.a.getSessionConfig()};0===Object.keys(this.m_initInfo).length&&(this.m_initInfo=t.InitInfo);let i={initDur:t.initDur,initDurFromEndUser:t.initDurFromEndUser};this.m_settings.appSettings.useSnapDownloadUrl&&(t[m.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl,i[m.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl),l.a.recordSessionStats(i),a.a.sendTraceTag(592483858,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,this.getLogString("SSCoreInit",t))}static recordNavData(e,t,i,n){if(!i||0===Object.keys(i).length||!i.hasOwnProperty("sid"))return;let p=!1,g=!1,_=!1;const v=i.sid.toString();if(n&&n.bootMetrics){if(0===this.m_startFromTime&&(p=!0,this.m_navigationData.hasOwnProperty(v))){let e=this.m_navigationData[v];e.hasOwnProperty(r.Prerender)&&(g=!0),e.hasOwnProperty(r.Prefetch)&&(_=!0)}this.m_startFromTime=n.startFromTime?n.startFromTime:0,this.m_maxGotoSlideMs=0,this.m_navigationData={},n.startFromTime||a.a.sendTraceTag(588804161,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,"NavigationLogger::recordNavData Boot metrics object was present, but there was no startFromTime.")}if(this.m_navigationData.hasOwnProperty(v)||(this.m_navigationData[v]={}),u.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(i.hasOwnProperty(m.TextureMetadata)&&(i[m.TextureMetadata]=void 0),i.hasOwnProperty("createTransition")&&i.createTransition.hasOwnProperty("rendererEnvironment")&&(i.createTransition.rendererEnvironment.hasOwnProperty(m.RenderTransitionTextures)&&(i.createTransition.rendererEnvironment[m.RenderTransitionTextures]=void 0),i.createTransition.rendererEnvironment.hasOwnProperty(m.GenerateMorphResource)&&(i.createTransition.rendererEnvironment[m.GenerateMorphResource]=void 0),i.createTransition.rendererEnvironment.hasOwnProperty(m.RenderToTexture)&&(i.createTransition.rendererEnvironment[m.RenderToTexture]=void 0))),u.ChangeGate.isChangeGateEnabled("FixNavLogTrimming")&&i.hasOwnProperty("missingTextureIds")){const e={id:i&&i.id,sr:i&&i.sr,missingTextureIds:i.missingTextureIds};a.a.sendTraceTag(507598877,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,m.getLogString("addOnTrimmedData",e)),i.missingTextureIds=void 0,i.hasMissingTextureIds=!0}const y=this.m_navigationData[v];if(i.hasOwnProperty(this.Metadata)){y.hasOwnProperty(this.Metadata)||(y[this.Metadata]=[]),y[this.Metadata]=y[this.Metadata].concat(i[this.Metadata].filter(e=>!y[this.Metadata].includes(e)));let e=!1;for(let t in i[this.Metadata])if(i[this.Metadata][t].hasOwnProperty(this.MediaInfo)){e=!0;break}e&&!l.a.getSessionStats("hasMedia")&&l.a.recordSessionStats({hasMedia:!0}),u.ChangeGate.isChangeGateEnabled("ssc.HasMediaPartCDimension")&&e&&c.a.addOrUpdatePartCDimensions(new Map([["NavigatedToSlideWithMedia","true"]]))}if(u.ChangeGate.isChangeGateEnabled("FixNavLogTrimmingMetadata")&&i.hasOwnProperty(this.Metadata)){const e={id:i&&i.id,sr:i&&i.sr,metadata:i[this.Metadata]};a.a.sendTraceTag(507597592,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,m.getLogString("addOnTrimmedDataMetadata",e)),i[this.Metadata]=void 0,i.hasMetadata=!0}let b,S=0;if(n&&n.navMetrics&&n.navMetrics.checkHiddenSlideResult&&(S=this.getDuration(n.navMetrics.checkHiddenSlideResult)),!(t===r.Goto&&y.hasOwnProperty(r.Goto)&&i.hasOwnProperty(r.Goto)&&this.getDuration(y[r.Goto])+this.getDuration(y[r.CheckHidden])>=this.getDuration(i[r.Goto])+S||t===r.Prefetch&&y.hasOwnProperty(r.Prefetch))){for(const t in i)if(t===r.Goto)if(y[r.CheckHidden]=S,n&&n.bootMetrics){const r={sessionId:this.m_settings.appSettings.userSessionId,startFromTime:n?n.startFromTime:void 0,bootMetrics:n?n.bootMetrics:void 0,Config:l.a.getSessionConfig(),EUPL:n.startFromTime&&0!==n.startFromTime?i[t].end-n.startFromTime:void 0,firstStartMetrics:{firstStart:p}};if(u.ChangeGate.isChangeGateEnabled("SSLaunchRefactoredLaunchLogs")&&n&&n.id&&(r.id=n.id),i.hasOwnProperty("pptSpinnerStartTime")&&r.bootMetrics&&(r.bootMetrics.pptSpinnerStartTime=i.pptSpinnerStartTime),i.hasOwnProperty("errorName")&&(r.errors=i.errorName),this.m_settings.appSettings.useSnapDownloadUrl&&(r[m.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl),i.hasOwnProperty(m.Metadata)){const e=this.getMetadataSummary(i[m.Metadata]);e.length>0&&(r[m.Metadata]=e),r.NavigationInfo=Object.keys(i).reduce((e,t)=>(t!==m.Metadata&&(e[t]=i[t]),e),{})}else r.NavigationInfo=i;r.slideIndex=e.getVisibleSlideIndex({sid:i.sid,cid:0}),u.ChangeGate.isChangeGateEnabled("AddNavigationSource")&&(this.m_slideIndexFromBoot=r.slideIndex),p&&(r.firstStartMetrics.prefetched=_,r.firstStartMetrics.prerendered=g),0!==Object.keys(this.m_initInfo).length&&(r.initMetrics=this.m_initInfo),r.EUPL>f.Settings.readNumberOrDefault("vetoBootDurationMs",2e3)&&h.VetoUtils.recordVeto("VetoedSlideShowBootTimeMs",{qosVeto:"PerceivedOpenSlow",...r}),i.hasOwnProperty(m.GetItemsResult)&&void 0!==i[m.GetItemsResult]&&(r[m.GetItemsResult]=i[m.GetItemsResult]),u.ChangeGate.isChangeGateEnabled("AddSlideDuration")&&(this.m_bootLaunchId=n&&n.id),a.a.sendTraceTag(594650330,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,this.getLogString("boot",r))}else n&&!n.bootMetrics&&(i.hasOwnProperty("errorName")||(y[t]=i[t],i.hasOwnProperty("SBCurrentFrameSummary")&&i.SBCurrentFrameSummary.hasOwnProperty("totalCostMs")&&(y[this.RenderCost]=i.SBCurrentFrameSummary.totalCostMs),i.hasOwnProperty(this.NavigationStep)&&0!==i[this.NavigationStep]&&1!==i[this.NavigationStep]&&(y[this.NavigationStep]=i[this.NavigationStep]),n&&n.navigationType&&n.navigationType!==d.a.Init&&n.navigationType!==d.a.Next&&n.navigationType!==d.a.Prev&&(y.navigation=n.navigationType),i.hasOwnProperty(m.CachedInServer)&&(y[m.CachedInServer]=i[m.CachedInServer]),i.hasOwnProperty(m.RequestInfo)&&(y[m.RequestInfo]=i[m.RequestInfo]),i.hasOwnProperty(m.PlayTransitionMs)||(this.m_maxGotoSlideMs=Math.max(this.m_maxGotoSlideMs,this.getDuration(y[t])),this.getDuration(i[t])+S>f.Settings.readNumberOrDefault("vetoNavigationDurationMs",1250)&&0!==this.m_startFromTime&&h.VetoUtils.recordVeto("VetoedSlideShowNavTimeMs",{qosVeto:"SlideShowNavSlow",...this.m_navigationData[v.toString()]}))));else t===r.Prefetch&&(i.hasOwnProperty("errorName")?y.hasOwnProperty("errorCount")?y.errorCount+=1:y.errorCount=1:y[t]=i[t],i.hasOwnProperty(r.Prerender)&&(y[r.Prerender]=i[r.Prerender]),i.hasOwnProperty(m.CachedInServer)&&(y[m.CachedInServer]=i[m.CachedInServer]),i.hasOwnProperty(m.RequestInfo)&&(y[m.RequestInfo]=i[m.RequestInfo]));if(i.sessionId=this.m_settings.appSettings.userSessionId,i.action=t,i.startFromTime=this.m_startFromTime,a.a.sendTraceTag(594650332,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,m.getLogString("navigation",i)),u.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&(b=e.getVisibleSlideIndex({sid:i.sid,cid:0})),u.ChangeGate.isChangeGateEnabled("AddNavigationSource")&&t===r.Goto){const e={id:i&&i.id,navType:n&&n.navigationType,sIdx:void 0!==this.m_slideIndexFromBoot?this.m_slideIndexFromBoot:void 0,timestamp:Date.now()};if(u.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&(e.sr=i.sr,e.playTransitionMs=i.playTransitionMs,e.slideDistanceFromLaunch=void 0!==this.m_slideIndexFromBoot&&void 0!==b?b-this.m_slideIndexFromBoot:void 0,e.loadSlide=i.LoadSlide,e.fPrepared=i.fPrepared),u.ChangeGate.isChangeGateEnabled("AddSlideDuration"))if(e.bootLaunchId=this.m_bootLaunchId,n&&n.navigationType===d.a.Init)this.m_userActionTimestamp=l.a.performanceNowTrimmed();else if(n&&(n.navigationType===d.a.Next||n.navigationType===d.a.Prev||n.navigationType===d.a.GoTo)){const t=l.a.performanceNowTrimmed();e.timeSpentOnPrevSlide=t-this.m_userActionTimestamp,this.m_userActionTimestamp=t,e.navType=n.navigationType}a.a.sendTraceTag(507787460,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,m.getLogString("addOnnavigation",e))}}}static logPerfData(){if(0===Object.keys(this.m_navigationData).length)return;let e=[];const t=Object.keys(this.m_navigationData).map(t=>{const i=this.m_navigationData[t],n={};return n.id=t,Object.keys(i).forEach(t=>{if(t===r.Goto||t===r.Prefetch||t===r.Prerender)n[t]=this.getDuration(i[t]);else if(t===this.Metadata){for(let t of i[this.Metadata])t.hasOwnProperty(this.MediaInfo)&&e.push(t[this.MediaInfo]);let t=this.getMetadataSummary(i[this.Metadata]);t.length>0&&(n[this.Metadata]=t)}else n[t]=i[t]}),n}),i={startFromTime:this.m_startFromTime,sessionId:this.m_settings.appSettings.userSessionId,maxNav:this.m_maxGotoSlideMs,navList:t,Config:l.a.getSessionConfig()};l.a.recordSessionStats({maxNav:this.m_maxGotoSlideMs}),a.a.sendTraceTag(594650331,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,this.getLogString("navSummary",i));const n={startFromTime:this.m_startFromTime,sessionId:this.m_settings.appSettings.userSessionId,mediaInfoObjects:e,Config:l.a.getSessionConfig()};Object.keys(e).length>0&&a.a.sendTraceTag(591165197,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,this.getLogString("mediaSummary",n))}static getMetadataSummary(e){const t=[];for(let i in e)if(e[i].hasOwnProperty(this.MediaInfo)){const r=e[i][this.MediaInfo];t.includes(r.type)||t.push(r.type)}else t.includes(e[i])||t.push(e[i]);return t}static getDuration(e){return e.end-e.start}static getLogString(e,t){if(!t)return"";const i=JSON.stringify(t),r=i.length;return r>3e3&&a.a.sendTraceTag(572289234,s.a.msoulscat_Wac_PptSlideshow,o.a.Warning,`log size is too long! size:${r}, source:${e}`),i}}m.m_navigationData={},m.m_maxGotoSlideMs=0,m.m_startFromTime=0,m.m_userActionTimestamp=0,m.m_initInfo={},m.RenderCost="render",m.Metadata="metadata",m.NavigationStep="step",m.CachedInServer="cached",m.PlayTransitionMs="playTransitionMs",m.GetItemsResult="getItemsResult",m.UseSnapDownloadUrlString="useSnap",m.MediaInfo="mediaInfo",m.RequestInfo="requestInfo",m.TextureMetadata="textureMetadata",m.RenderTransitionTextures="renderTransitionTextures",m.GenerateMorphResource="generateMorphResource",m.RenderToTexture="renderToTexture"},function(e,t,i){"use strict";i.d(t,"u",(function(){return a})),i.d(t,"G",(function(){return s})),i.d(t,"v",(function(){return o})),i.d(t,"w",(function(){return l})),i.d(t,"t",(function(){return d})),i.d(t,"s",(function(){return h})),i.d(t,"I",(function(){return c})),i.d(t,"F",(function(){return u})),i.d(t,"E",(function(){return f})),i.d(t,"y",(function(){return m})),i.d(t,"z",(function(){return p})),i.d(t,"A",(function(){return g})),i.d(t,"K",(function(){return _})),i.d(t,"L",(function(){return v})),i.d(t,"M",(function(){return y})),i.d(t,"b",(function(){return b})),i.d(t,"c",(function(){return S})),i.d(t,"f",(function(){return T})),i.d(t,"d",(function(){return w})),i.d(t,"e",(function(){return M})),i.d(t,"g",(function(){return C})),i.d(t,"a",(function(){return I})),i.d(t,"B",(function(){return P})),i.d(t,"l",(function(){return E})),i.d(t,"x",(function(){return x})),i.d(t,"h",(function(){return A})),i.d(t,"H",(function(){return k})),i.d(t,"J",(function(){return R})),i.d(t,"o",(function(){return O})),i.d(t,"n",(function(){return L})),i.d(t,"p",(function(){})),i.d(t,"j",(function(){return F})),i.d(t,"k",(function(){return D})),i.d(t,"i",(function(){return B})),i.d(t,"m",(function(){return N})),i.d(t,"r",(function(){return V})),i.d(t,"D",(function(){return U})),i.d(t,"q",(function(){return W})),i.d(t,"C",(function(){return z}));var r=i(5),n=i(34);let a=!0;function s(e){a=e}let o=1,l=8,d=16,h=0;function c(e,t){o=e,l=t}function u(e){d=e}function f(e){h=e}let m=!0,p=!0,g=!0;function _(e){m=e}function v(e){p=e}function y(e){g=e}const b=0,S=1,T=2,w=3,M=5,C=7;let I=b;function P(e){I=e}let E=3,x=!1;function A(e){x=e}function k(e){r.a.setLogger(e)}function R(e){n.a.load(e)}let O=!1,L=!1,F=!1,D=!1;function B(){return"undefined"!=typeof WeakRef}let N=!1,V=1040;function U(e){V=e}let W=0;function z(e){W=e}},function(e,t,i){"use strict";var r,n;i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n})),function(e){e.SlideShowUIRootContainer="SlideShowUIRootContainer",e.ThumbnailStrip="ThumbnailStrip",e.NotesPane="NotesPane",e.SlideShowToolbar="SlideShowToolbar",e.GridView="GridView",e.ResumeSlideShow="ResumeSlideShow",e.SlideShowTop="SlideShowTop",e.OpticalZoomPopover="OpticalZoomPopover"}(r||(r={})),function(e){e[e.Attendee=0]="Attendee",e[e.Presenter=1]="Presenter",e[e.PrivateViewing=2]="PrivateViewing"}(n||(n={}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return a}));class r{}var n,a;r.skewEmitter="Skew_Emitter",r.skewReceiver="Skew_Receiver",r.teamsNotified="Teams_Notified",r.teamsLocal="Teams_Local",r.elapsedTime="Total_Elapsed_MS",r.mediaEventEmitted="PPT_ModernSS_Emit_Media",r.mediaEventCompleted="PPT_ModernSS_Complete_Media",r.mediaEventOutOfOrder="Media_Event_Out_Of_Order",r.mediaEventDuplicate="Media_Event_Duplicate",r.stateNotified="State_Notified",r.stateLocal="State_Local",r.annotationEventEmitted="PPT_ModernSS_Emit_Annotation",r.annotationEventCompleted="PPT_ModernSS_Complete_Annotation",r.bootstrapperNotified="Bootstrapper_Notified",r.bootstrapperLocal="Bootstrapper_Local",r.ic3Notified="Teams_Notified_IC3",r.ic3Local="Teams_Local_IC3",r.mediaEventType="mediaEventType",r.mediaSyncTimeLine="mediaSyncTimeLine",r.senderId="senderId",r.senderIdSystem="system",r.syncEventEmitTime="PPT_ModernSS_Emit_Time_Ms",r.syncEventCompleteTime="PPT_ModernSS_Complete_Time_Ms",function(e){e.Unknown="srcUNKNOWN",e.Teams="srcTEAMS",e.State="srcSTATE"}(n||(n={})),function(e){e.Media="Media",e.SyncStateManager="SyncStateManager"}(a||(a={}))},function(e,t,i){"use strict";i.d(t,"e",(function(){return r.d})),i.d(t,"c",(function(){return r.b})),i.d(t,"d",(function(){return u})),i.d(t,"b",(function(){return f.b})),i.d(t,"a",(function(){return f.a}));var r=i(25),n=i(12),a=i(4),s=i(2),o=i(3),l=i(1);class d{constructor(){this.m_glyphMap=new Map,this.m_knownGlyphsString=""}mergeGlyphs(e){if(null!=e)for(const t of e)this.hasGlyph(t.f,t.g)||this.addGlyph(t)}addGlyph(e){let t=this.m_glyphMap.get(e.f);t||(t=[],this.m_glyphMap.set(e.f,t)),t.push(e),this.updateKnownGlyphsString()}hasGlyph(e,t){const i=this.m_glyphMap.get(e);if(!i)return!1;for(const r of i)if(r.f===e&&r.g===t)return!0;return!1}getGlyph(e,t){const i=this.m_glyphMap.get(e);if(!i)return a.a.sendTraceTag(590103965,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"glyph font info missing"),void n.VetoUtils.recordVeto("ACE",{errorName:"GlyphMissing",whatsMissing:"FontInfo",qosVeto:"ContentRenderFailed"});for(const r of i)if(r.f===e&&r.g===t)return r;a.a.sendTraceTag(590103966,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"glyph missing"),n.VetoUtils.recordVeto("ACE",{errorName:"GlyphMissing",whatsMissing:"Glyph",qosVeto:"ContentRenderFailed"})}get knownGlyphsString(){return this.m_knownGlyphsString}updateKnownGlyphsString(){const e={};this.m_glyphMap.forEach(t=>{for(const i of t){const t=h.parseFontInfo(i.f);t.fontName in e||(e[t.fontName]={}),t.key in e[t.fontName]||(e[t.fontName][t.key]=[]),e[t.fontName][t.key].push(i.g)}for(const t in e)for(const i in e[t])e[t][i].sort((e,t)=>1*e-1*t);for(const t in e)for(const i in e[t])for(let r=0;r<e[t][i].length-1;r+=1){let n=0;for(;r+n+1<e[t][i].length&&e[t][i][r+n]+1===e[t][i][r+n+1];)n+=1;if(n>0){const a=""+e[t][i][r+n];a.length<n.toString().length?e[t][i][r]=`${e[t][i][r]}-${a}`:e[t][i][r]=`${e[t][i][r]}+${n}`,e[t][i].splice(r+1,n)}}}),this.m_knownGlyphsString=JSON.stringify(e),l.Settings.readBooleanOrDefault("logKnownGlyphsString",!1)&&a.a.sendTraceTag(558130316,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"GetKnownGlyphsString length: "+this.m_knownGlyphsString.length)}}class h{static parseFontInfo(e){const t=h.findSixthComma(e);return{fontName:e.substring(1,t),key:e.substring(t+1,e.length-1)}}static findSixthComma(e){let t=e.length;for(let i=0;i<6;i+=1)t=e.lastIndexOf(",",t-1);return t}}var c=i(50);class u{constructor(e,t,i){this.memoryStats={gifTextures:0,transitionTextures:0,transitionsMemoryReport:new c.MemoryReport,videoTextures:0,cameoTextures:0,externalTextureLeaks:0},this.externalTexturesToRelease=[],this.slideIdOrder=[],this.visibleSlideIdOrder=[],this.glyphStore=new d,this.sections=[],this.m_hiddenSlideIdOrder=[],this.m_slideViewDataLoader=e,this.m_shapeViewDataLoader=t,this.m_localizedStringLoader=i,this.imageDataMap=new Map,this.slideMetadataMap=new Map}onExternalTextureReleased(e){for(let t=this.externalTexturesToRelease.length-1;t>=0;t-=1){const i=this.externalTexturesToRelease[t];i.imageId===e&&((l.Settings.readBooleanOrDefault("fixExternalTextureTracking",!0)?2===i.texture.releasePolicy:2!==i.texture.releasePolicy)?(i.texture.release(),a.a.sendTraceTag(520966875,s.a.msoulscat_Wac_PptSession,o.a.Info,"Releasing externally managed texture id:"+e)):a.a.sendTraceTag(572610636,s.a.msoulscat_Wac_PptSession,o.a.Warning,"ViewDataManager::onExternalTextureReleased: tried to release texture that is not ExternallyManaged. id:"+e),this.externalTexturesToRelease.splice(t,1))}}async getSlideViewData(e,t){const i=await this.m_slideViewDataLoader.load(JSON.stringify(e),t);return i.resource&&i.resource.shapeGlyph&&this.glyphStore.mergeGlyphs(i.resource.shapeGlyph),i&&i.resource||a.a.sendTraceTag(591927432,s.a.msoulscat_Wac_PptSession,o.a.Warning,`ViewDataManager::getSlideViewData: missing slideViewData. slideId:${e.sid}, item exists:${!!i}, correlation:${t?t.meta_correlationId:""}, errorName:${i&&i.hasOwnProperty("metadata")&&i.metadata.hasOwnProperty("errorName")?i.metadata.errorName:""}`),i}async getShapeViewData(e,t){const i=await this.m_shapeViewDataLoader.load(`${JSON.stringify(e)}_${JSON.stringify(t)}`);return i&&i.resource}setSlideIdOrder(e){a.a.sendTraceTag(576247950,s.a.msoulscat_Wac_PptSession,o.a.Info,"ViewDataManager::setSlideIdOrder slideIdOrder:"+JSON.stringify(e)),this.slideIdOrder=e}setSlideIdOrderWithHidden(e,t){this.setSlideIdOrder(e),a.a.sendTraceTag(576247951,s.a.msoulscat_Wac_PptSession,o.a.Info,"ViewDataManager::setSlideIdOrderWithHidden hiddenSlideIdOrder:"+JSON.stringify(t)),this.m_hiddenSlideIdOrder=t,this.visibleSlideIdOrder=e.filter(e=>!this.m_hiddenSlideIdOrder.some(t=>t.sid===e.sid&&t.cid===e.cid))}async getLocalizedString(e){const t=await this.m_localizedStringLoader.load(e);return t&&t.resource||a.a.sendTraceTag(591136962,s.a.msoulscat_Wac_PptSession,o.a.Error,"Failed to get localized string. id:"+e),t&&t.resource}getVisibleSlideIndex(e){if(this.visibleSlideIdOrder.length>0)return this.visibleSlideIdOrder.findIndex(t=>t.sid===e.sid);let t=-1;for(const i of this.slideIdOrder){const r=this.slideMetadataMap.get(i.sid);if(!r||void 0===r.isHidden)return-1;if(r.isHidden||(t+=1),i.sid===e.sid)return r.isHidden?-1:t}return-1}getVisibleSlideIndexDifference(e,t){const i=this.getSlideIndex(e),r=this.getSlideIndex(t);if(-1===i||-1===r)return;if(i===r)return 0;if(!1!==this.getIsHiddenByIndex(i)||!1!==this.getIsHiddenByIndex(r))return;if(this.visibleSlideIdOrder.length>0)return this.visibleSlideIdOrder.findIndex(e=>e.sid===t.sid)-this.visibleSlideIdOrder.findIndex(t=>t.sid===e.sid);const n=i<r?1:-1;let a=1;for(let e=i+n;e!==r;e+=n){const t=this.getIsHiddenByIndex(e);if(void 0===t)return;t||(a+=1)}return n*a}getIsHiddenByIndex(e){const t=this.slideMetadataMap.get(this.slideIdOrder[e].sid);return t?t.isHidden:void 0}getSlideIndex(e){if(0===this.slideIdOrder.length)return-1;let t=0;for(const i of this.slideIdOrder){if(e.sid===i.sid)return t;t+=1}return-1}}var f=i(8);i(69)},function(e,t,i){"use strict";i.d(t,"c",(function(){return s})),i.d(t,"f",(function(){return o})),i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return d})),i.d(t,"e",(function(){return h})),i.d(t,"d",(function(){return c}));var r=i(0),n=i(5),a=(i(16),i(94));class s{constructor(e,t){if(e instanceof s)this.m_sharedPathStorage=e.m_sharedPathStorage,this.m_transform=t||e.transform;else{const i=[];for(const t of e.figures)i.push(t instanceof d?t.createFigure():t);this.m_sharedPathStorage={figures:i,fillMode:null==e.fillMode?1:e.fillMode,lineEnabled:null==e.lineEnabled||e.lineEnabled,extrusionEnabled:null==e.extrusionEnabled||e.extrusionEnabled,glyphCacheId:e.glyphCacheId?{fontId:e.glyphCacheId.fontId,glyphId:e.glyphCacheId.glyphId}:void 0,isUntransformedRect:u(i),untransformedBounds:c(i),renderDataMap:{}},this.m_transform=t||(e.transform?e.transform:r.d.Identity)}null===a.a||void 0===a.a||a.a.register(this,this.renderDataMap)}static CreateFromFigure(e){return new s({figures:[e]})}static CreateFromRect(e){return new s({figures:[l.CreateFromRect(e)]})}get figures(){return this.m_sharedPathStorage.figures}get transform(){return this.m_transform}get fillMode(){return this.m_sharedPathStorage.fillMode}get lineEnabled(){return this.m_sharedPathStorage.lineEnabled}get extrusionEnabled(){return this.m_sharedPathStorage.extrusionEnabled}get glyphCacheId(){return this.m_sharedPathStorage.glyphCacheId}get maxPressure(){return 4096}get renderDataMap(){return this.m_sharedPathStorage.renderDataMap}get hasPressureInfo(){return this.figures.some(e=>!!(8&e.format))}get isUntransformedRect(){return this.m_sharedPathStorage.isUntransformedRect}get untransformedBounds(){return this.m_sharedPathStorage.untransformedBounds}measureLength(e=r.d.Identity){let t=0;for(const i of this.figures)t+=i.measureLength(e);return t}equals(e){return this.m_sharedPathStorage==e.m_sharedPathStorage&&this.m_transform.equals(e.m_transform)}}function o(e){let t=(1&e?2:0)+(2&e?1:0)+(4&e?1:0)+(8&e?1:0)+(16&e?2:0);return 32&e&&(t=4*Math.ceil(t/4)),t}class l{constructor(e,t=!1,i=3){if(this.m_points=e,this.m_isClosed=t,this.m_format=i,this.m_pointDataSize=o(i),this.m_points.length%this.m_pointDataSize!=0)throw n.a.Error(592520776,"list of points invalid")}static CreateFromRect(e){return new l([e.left,e.top,1,e.right,e.top,1,e.right,e.bottom,1,e.left,e.bottom,1],!0)}static CreateFromRoundedRect(e,t){const i=Math.min(t,Math.min(e.width,e.height)/2),r=new d;return r.moveTo(e.center.x-e.width/2,e.center.y-(e.height/2-i)),r.arcTo(i,i,-Math.PI,Math.PI/2),r.lineTo(e.right-i,e.top),r.arcTo(i,i,-Math.PI/2,Math.PI/2),r.lineTo(e.right,e.bottom-i),r.arcTo(i,i,0,Math.PI/2),r.lineTo(e.left+i,e.bottom),r.arcTo(i,i,Math.PI/2,Math.PI/2),r.lineTo(e.left,e.top+i),r.close(),r.createFigure()}get points(){return this.m_points}get format(){return this.m_format}get pointDataSize(){return this.m_pointDataSize}get isClosed(){return this.m_isClosed}isLastPointDuplicated(){return this.getPoint(0).equalsWithEpsilon(this.getPoint(-1),.1)}getPointCount(){return this.m_points.length/this.m_pointDataSize}getPoint(e){const t=this.getPointCount(),i=e<0?e%t+t:e%t;return new r.e(this.m_points[i*this.m_pointDataSize],this.m_points[i*this.m_pointDataSize+1])}getPointType(e){if(!(2&this.m_format))return 1;const t=this.getPointCount(),i=e<0?e%t+t:e%t;return this.m_points[i*this.m_pointDataSize+2]}toPolygon(){const e=this.getPointCount(),t=new d([],this.m_isClosed,1);for(let i=0;i<e;i++){const e=this.getPoint(i);if(2!=this.getPointType(i))t.pushPoint(e.x,e.y);else{const n=this.getPoint(i-1),a=this.getPoint(i+1),s=8;for(let i=1;i<s;i++){const o=r.e.InterpolateQuadratic(n,e,a,i/s);t.pushPoint(o.x,o.y)}}}return t.createFigure()}transform(e){const t=this.points.slice(0),i=this.pointDataSize;for(let r=0;r<this.getPointCount();r++){const n=this.getPoint(r).transformPoint(e);t[r*i]=n.x,t[r*i+1]=n.y}return new l(t,this.isClosed,this.format)}measureLength(e=r.d.Identity){let t=0;return this.forEachSegment((e,i,n)=>(t+=i?r.e.MeasureQuadraticLength(e,i,n):r.e.Distance(e,n),!0),e),t}getPointFromDist(e,t=r.d.Identity,i=!1){let n=0,a=void 0;return this.forEachSegment((t,i,s)=>{const o=i?r.e.MeasureQuadraticLength(t,i,s):r.e.Distance(t,s);if(n+o>e){const l=(e-n)/o;a=i?r.e.InterpolateQuadratic(t,i,s,l):r.e.InterpolateLinear(t,s,l)}return n+=o,n<=e},t,i),a||this.getPoint(i?0:this.getPointCount()-1).transformPoint(t)}getTangentFromDist(e,t=r.d.Identity,i=!1){let n=0,a=r.e.Zero;return this.forEachSegment((t,i,s)=>{const o=i?r.e.MeasureQuadraticLength(t,i,s):r.e.Distance(t,s);return a=i?r.e.QuadraticTangent(t,i,s,(e-n)/o):s.subtract(t).scale(1/o),n+=o,n<e},t,i),a}forEachSegment(e,t=r.d.Identity,i=!1){const n=this.getPointCount(),a=i?0:n-1,s=i?-1:1;for(let r=i?n-1:0;r!=a;r+=s){const i=r+s,a=i+s,o=2==this.getPointType(i);if(2!=this.getPointType(r)&&(this.m_isClosed||i==i%n)&&(!o||this.m_isClosed||a==a%n)&&!e(this.getPoint(r).transformPoint(t),o?this.getPoint(i).transformPoint(t):void 0,this.getPoint(o?a:i).transformPoint(t)))return}}}class d{constructor(e=[],t=!1,i=3){if(this._points=e,this.isClosed=t,this.format=i,this.pointDataSize=o(i),this.lastPointX=0,this.lastPointY=0,this._points.length%this.pointDataSize!=0)throw n.a.Error(592520777,"list of points invalid")}createFigure(){return new l(this._points,this.isClosed,this.format)}pushPoint(e,t,i=1,r){switch(this.lastPointX=e,this.lastPointY=t,this.pointDataSize){case 2:return void this._points.push(e,t);case 3:return void this._points.push(e,t,i);case 4:return void this._points.push(e,t,i,r?r[0]:0);case 5:return void this._points.push(e,t,i,r?r[0]:0,r?r[1]:0);case 6:return void this._points.push(e,t,i,r?r[0]:0,r?r[1]:0,r?r[2]:0);case 7:return void this._points.push(e,t,i,r?r[0]:0,r?r[1]:0,r?r[2]:0,r?r[3]:0)}throw n.a.Error(592520778,"Unsupported data size")}moveTo(e,t,i){if(0!=this._points.length)throw n.a.Error(592520779,"Figures should have only one MoveTo");this.pushPoint(e,t,1,i)}moveToPoint(e,t){this.moveTo(e.x,e.y,t)}lineTo(e,t,i){if(this._points.length<this.pointDataSize)throw n.a.Error(592520780,"All figures should start with a MoveTo");(Math.abs(e-this.lastPointX)>.1||Math.abs(t-this.lastPointY)>.1)&&this.pushPoint(e,t,1,i)}lineToPoint(e,t){this.lineTo(e.x,e.y,t)}quadBezierTo(e,t,i,r,a){if(this._points.length<this.pointDataSize)throw n.a.Error(592520781,"All figures should start with a MoveTo");const s=this.lastPointX,o=this.lastPointY;if(Math.abs(i-s)>.1||Math.abs(r-o)>.1){const n=Math.sqrt((e-s)*(e-s)+(t-o)*(t-o)),l=Math.sqrt((i-e)*(i-e)+(r-t)*(r-t)),d=Math.abs(e-s)<.1&&Math.abs(t-o)<.1,h=Math.abs(i-e)<.1&&Math.abs(r-t)<.1;!d&&!h&&Math.abs(n/l)>.1&&Math.abs(l/n)>.1?(this.pushPoint(e,t,2),this.pushPoint(i,r,1,a)):this.pushPoint(i,r,1,a)}}quadBezierToPoint(e,t,i){this.quadBezierTo(e.x,e.y,t.x,t.y,i)}cubicBezierTo(e,t,i,n,a,s){this.cubicBezierToPoint(new r.e(e,t),new r.e(i,n),new r.e(a,s))}cubicBezierToPoint(e,t,i){if(this._points.length<this.pointDataSize)throw n.a.Error(592520782,"All figures should start with a MoveTo");const a=new r.e(this.lastPointX,this.lastPointY),s=Math.abs(e.x-a.x)<.1&&Math.abs(e.y-a.y)<.1,o=Math.abs(t.x-e.x)<.1&&Math.abs(t.y-e.y)<.1,l=Math.abs(i.x-t.x)<.1&&Math.abs(i.y-t.y)<.1;if(o&&(s||l))s!=l&&this.lineToPoint(i);else{const n=4;let s=a,o=a,l=e;for(let d=0;d<n;d++){const h=(d+1)/n,c=r.e.InterpolateQuadratic(a,e,t,h),u=r.e.InterpolateQuadratic(e,t,i,h),f=r.e.InterpolateLinear(c,u,h),m=l.subtract(o).normalized(),p=u.subtract(c).normalized();let g;if(m&&p&&Math.abs(m.dot(p))<Math.sqrt(2)/2)g=r.e.CalculateLineIntersection(o,l,c,u,r.h);else{const o=(d+.5)/n,l=r.e.InterpolateLinear(r.e.InterpolateQuadratic(a,e,t,o),r.e.InterpolateQuadratic(e,t,i,o),o),h=s.add(f).scale(.5);g=h.add(l.subtract(h).scale(2))}g?this.quadBezierTo(g.x,g.y,f.x,f.y):this.lineTo(f.x,f.y),s=f,o=c,l=u}}}arcTo(e,t,i,a){if(this._points.length<this.pointDataSize)throw n.a.Error(592520783,"All figures should start with a MoveTo");const s=2*Math.PI,o=e<r.h||t<r.h,l=o?i:Math.atan2(e*Math.sin(i),t*Math.cos(i)),d=a<0?-1:1;let h=Math.abs(a);if(h>=s)h=s;else{let r=i+h*d;r=o?r:Math.atan2(e*Math.sin(r),t*Math.cos(r)),h=(r-l)*d,h<0&&(h+=s)}const c=this.lastPointX,u=this.lastPointY,f=c-Math.cos(l)*e,m=u-Math.sin(l)*t,p=Math.ceil(8*Math.abs(h)/s);for(let i=0;i<p;i++){const n=d*s/8,a=l+i*n,o=i==p-1?d*h-i*n:n,c=a+o,u=a+o/2,g=1/Math.cos(o/2),_=new r.e(f+Math.cos(u)*g*e,m+Math.sin(u)*g*t),v=new r.e(f+Math.cos(c)*e,m+Math.sin(c)*t);Math.abs(o)>r.h?this.quadBezierTo(_.x,_.y,v.x,v.y):this.lineTo(v.x,v.y)}}close(){if(this._points.length<this.pointDataSize)throw n.a.Error(592520784,"All figures should start with a MoveTo");this.isClosed=!0}isLastPointDuplicated(){return this.getPoint(0).equalsWithEpsilon(this.getPoint(-1),.1)}getPointCount(){return this._points.length/this.pointDataSize}getPoint(e){const t=this.getPointCount(),i=e<0?e%t+t:e%t;return new r.e(this._points[i*this.pointDataSize],this._points[i*this.pointDataSize+1])}get data(){return this._points}}function h(e){const t="["+e.replace(/(M|L|Q|C|A|E|;)/g,e=>"M"==e?"0":"L"==e?"1":"Q"==e?"2":"C"==e?"3":"A"==e?"4":"E"==e?"5":",")+"]",i=new Float32Array(JSON.parse(t)),r=[];let a=void 0,s=0;const o=2*Math.PI/216e5;for(;s<i.length;)switch(i[s++]){case 0:if(s+1>=i.length)throw n.a.Error(592520785,"Invalid LineTo");a&&r.push(a),a=new d,a.moveTo(i[s++],i[s++]);break;case 1:if(!a||s+1>=i.length)throw n.a.Error(592520786,"Invalid LineTo");a.lineTo(i[s++],i[s++]);break;case 2:if(!a||s+3>=i.length)throw n.a.Error(592520787,"Invalid MoveTo");a.quadBezierTo(i[s++],i[s++],i[s++],i[s++]);break;case 3:if(!a||s+5>=i.length)throw n.a.Error(592520788,"Invalid CubicBezierTo");a.cubicBezierTo(i[s++],i[s++],i[s++],i[s++],i[s++],i[s++]);break;case 4:if(!a||s+3>=i.length)throw n.a.Error(592520789,"Invalid Arc of ellipse");a.arcTo(i[s++],i[s++],i[s++]*o,i[s++]*o);break;case 5:if(!a)throw n.a.Error(592520790,"All paths should start with a MoveTo");a.close(),r.push(a),a=void 0}return a&&r.push(a),r}function c(e){let t=void 0;for(const i of e){if(!i.cachedBounds){const e=i.points.length/i.pointDataSize;if(e<1)return;let t=i.points[0],n=t,a=i.points[1],s=a;for(let r=0;r<e;r++){const o=r*i.pointDataSize,l=(r-1+e)%e*i.pointDataSize,d=(r+1)%e*i.pointDataSize;let h,c,u;2&i.format?(h=i.points[o+2],c=i.points[l+2],u=i.points[d+2]):h=c=u=1;const f=i.points[o],m=i.points[o+1];if(1==h&&1==u)t=f<t?f:t,n=f>n?f:n,a=m<a?m:a,s=m>s?m:s;else if(1==c&&2==h&&1==u){const e=i.points[l],r=i.points[l+1],o=i.points[d],h=i.points[d+1];t=e<t?e:t,n=e>n?e:n,a=r<a?r:a,s=r>s?r:s,t=o<t?o:t,n=o>n?o:n,a=h<a?h:a,s=h>s?h:s;const c=(e-f)/(e+o-2*f);if(0<c&&c<1){const i=c*c,l=e*(i-2*c+1)+o*i+2*f*(c-i),d=r*(i-2*c+1)+h*i+2*m*(c-i);t=l<t?l:t,n=l>n?l:n,a=d<a?d:a,s=d>s?d:s}const u=(r-m)/(r+h-2*m);if(0<u&&u<1){const i=u*u,l=e*(i-2*u+1)+o*i+2*f*(u-i),d=r*(i-2*u+1)+h*i+2*m*(u-i);t=l<t?l:t,n=l>n?l:n,a=d<a?d:a,s=d>s?d:s}}}i.cachedBounds=new r.c(t,a,n,s)}t=r.c.UnionRect(t,i.cachedBounds)}return t}function u(e){if(1!=e.length)return!1;const t=e[0];if((4!=t.getPointCount()||!t.isClosed||t.isLastPointDuplicated())&&(5!=t.getPointCount()||!t.isClosed||!t.isLastPointDuplicated()))return!1;const i=[t.getPoint(0),t.getPoint(1),t.getPoint(2),t.getPoint(3)],n=new r.c(Math.min(i[0].x,i[1].x,i[2].x,i[3].x),Math.min(i[0].y,i[1].y,i[2].y,i[3].y),Math.max(i[0].x,i[1].x,i[2].x,i[3].x),Math.max(i[0].y,i[1].y,i[2].y,i[3].y));for(let e=0;e<4;e++){const t=i[e],r=i[(e+1)%4];if(t.x!=n.left&&t.x!=n.right||t.y!=n.top&&t.y!=n.bottom||t.x!=r.x&&t.y!=r.y)return!1}return!0}},function(e,t,i){"use strict";i.d(t,"l",(function(){return o})),i.d(t,"d",(function(){return I})),i.d(t,"e",(function(){return b})),i.d(t,"c",(function(){return h})),i.d(t,"f",(function(){return u})),i.d(t,"h",(function(){return f})),i.d(t,"a",(function(){return m})),i.d(t,"k",(function(){return y})),i.d(t,"b",(function(){return N})),i.d(t,"i",(function(){return j})),i.d(t,"g",(function(){return X})),i.d(t,"j",(function(){return J}));var r=i(4),n=i(6),a=i(1);const s={};function o(e){e.logger&&r.a.setLogger(e.logger),e.settings&&a.Settings.load(e.settings?e.settings.slideshowcore:{}),e.disabledChangeGates&&n.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.anim=s)}var l,d,h,c,u,f,m,p,g,_,v,y;!function(e){e[e.Unset=0]="Unset",e[e.Double=1]="Double",e[e.String=2]="String",e[e.Color=3]="Color",e[e.Image=4]="Image",e[e.Array=5]="Array",e[e.Point=6]="Point",e[e.Filter=7]="Filter"}(l||(l={}));class b{}b.Undefined=-1,b.RepeatForever=-1,b.MainTimelineId="0_anim",b.RepeatUntilClick=-2,b.RepeatUntilEnd=-1,b.Zoom_InFromCenterFactor=.5,b.Zoom_InSlightlyScaleInit=2/3,b.Zoom_OutScaleInit=3,b.Zoom_OutFromBottomScaleFactor=5,b.Zoom_OutSlightlyScaleInit=5/4,b.Boomerang_XOffs=500,b.Boomerang_YOffs1=-200,b.Boomerang_YOffs2=100,b.BoomerangRot=-Math.PI/2,b.Float_XOffs1=350,b.Float_XOffs2=-40,b.Float_YOffs1=-250,b.Float_YOffs2=60,b.FloatRot=-Math.PI/2,b.GrownAndTurn_ScaleInit=.25,b.GrowAndTurn_Rotations=Math.PI/2,b.Ascend_Offs=60,b.Descend_Offs=-60,b.PinWheel_Rotations=3*Math.PI,b.RiseUp_YOffs1=600,b.RiseUp_YOffs2=-20,b.RiseUp_Seg1Fraction=.9,b.Swish_DropFraction=.6,b.Swish_BounceOffs=-40,b.Swish_Theta=-Math.PI/6,b.ThinLine_XOffs=-400,b.ThinLine_HInit=.05,b.ThinLine_WInit=1.4,b.Spinner_Rotations=1*Math.PI,b.Spinner_ScaleInit=.25,b.Whip_MidScale=1.1,b.Whip_XOffs=300,b.Unfold_XOffs=-200,b.Sling_Rot=Math.PI/2,b.Sling_XMid_Offs=-100,b.ExpandWidthFactor=.5,b.CompressWidthFactor=1.75,b.Zip_YOffs_Ratio=.85,b.Zip_Midscale=2.5,b.Glide_XOffs=-40,b.Flip_Rotations=4*Math.PI,b.BezierLengthEstimateDivisions=10,b.Blink_Alpha=0,b.Shimmer_Theta=Math.PI/8,b.Wave_Theta=-Math.PI/8,b.Wave_YOffs=-100,b.FlashBulb_ScaleOffs=1.1,b.FlashBulb_Alpha=.2,b.GrowShrink_DefaultDuration=200,function(e){e[e.None=0]="None",e[e.Constant=1]="Constant",e[e.Linear=2]="Linear",e[e.Bezier=3]="Bezier",e[e.VisTrack=4]="VisTrack",e[e.SmoothHelper=5]="SmoothHelper",e[e.ConstantObject=6]="ConstantObject"}(d||(d={})),function(e){e[e.None=0]="None",e[e.Src=1]="Src",e[e.Html=2]="Html",e[e.NativeW=3]="NativeW",e[e.NativeH=4]="NativeH",e[e.ScaleW=5]="ScaleW",e[e.ScaleH=6]="ScaleH",e[e.CropL=7]="CropL",e[e.CropT=8]="CropT",e[e.CropR=9]="CropR",e[e.CropB=10]="CropB",e[e.PosX=11]="PosX",e[e.PosY=12]="PosY",e[e.Alpha=13]="Alpha",e[e.Rotate=14]="Rotate",e[e.Visible=15]="Visible",e[e.RenderAs=16]="RenderAs",e[e.MediaProperties=17]="MediaProperties",e[e.ImageId=43]="ImageId",e[e.ShapeId=44]="ShapeId",e[e.ChildShapeId=45]="ChildShapeId",e[e.ObjectRotationX=46]="ObjectRotationX",e[e.ObjectRotationY=47]="ObjectRotationY",e[e.ObjectRotationZ=48]="ObjectRotationZ",e[e.ObjectScaleX=49]="ObjectScaleX",e[e.ObjectScaleY=50]="ObjectScaleY",e[e.ObjectScaleZ=51]="ObjectScaleZ",e[e.ObjectTranslateX=52]="ObjectTranslateX",e[e.ObjectTranslateY=53]="ObjectTranslateY",e[e.ObjectTranslateZ=54]="ObjectTranslateZ",e[e.ViewRotationX=55]="ViewRotationX",e[e.ViewRotationY=56]="ViewRotationY",e[e.ViewRotationZ=57]="ViewRotationZ",e[e.ViewScaleX=58]="ViewScaleX",e[e.ViewScaleY=59]="ViewScaleY",e[e.ViewScaleZ=60]="ViewScaleZ",e[e.ViewTranslateX=61]="ViewTranslateX",e[e.ViewTranslateY=62]="ViewTranslateY",e[e.ViewTranslateZ=63]="ViewTranslateZ",e[e.LocalRenderingProperties=64]="LocalRenderingProperties",e[e.CropOffsetX=65]="CropOffsetX",e[e.CropOffsetY=66]="CropOffsetY",e[e.Is3DRunning=67]="Is3DRunning",e[e.FadeMaskInfo=68]="FadeMaskInfo",e[e.FadeMaskProgress=69]="FadeMaskProgress",e[e.MediaPlaybackCmd=70]="MediaPlaybackCmd",e[e.EmbeddedAnimId=71]="EmbeddedAnimId",e[e.EmbeddedAnimProgress=72]="EmbeddedAnimProgress"}(h||(h={})),function(e){e[e.Add=0]="Add",e[e.Mult=1]="Mult",e[e.BaselineOnly=2]="BaselineOnly",e[e.First=3]="First",e[e.Last=4]="Last"}(c||(c={})),function(e){e[e.Entrance=0]="Entrance",e[e.Exit=1]="Exit",e[e.MotionPath=2]="MotionPath",e[e.Emphasis=3]="Emphasis",e[e.Media=4]="Media"}(u||(u={})),function(e){e[e.OnClick=0]="OnClick",e[e.WithPrevious=1]="WithPrevious",e[e.AfterPrevious=2]="AfterPrevious"}(f||(f={})),function(e){e[e.None=0]="None",e[e.HideOnNextClick=1]="HideOnNextClick",e[e.HideImmediatelyAfter=2]="HideImmediatelyAfter"}(m||(m={})),function(e){e[e.None=0]="None",e[e.ChangeFillColor=1]="ChangeFillColor",e[e.ChangeFont=2]="ChangeFont",e[e.ChangeFontColor=3]="ChangeFontColor",e[e.ChangeFontSize=4]="ChangeFontSize",e[e.ChangeFontStyle=5]="ChangeFontStyle",e[e.GrowShrink=6]="GrowShrink",e[e.ChangeLineColor=7]="ChangeLineColor",e[e.Spin=8]="Spin",e[e.Transparency=9]="Transparency",e[e.BoldFlash=10]="BoldFlash",e[e.Blast=14]="Blast",e[e.BoldReveal=15]="BoldReveal",e[e.BrushOnColor=16]="BrushOnColor",e[e.BrushOnUnderline=18]="BrushOnUnderline",e[e.ColorBlend=19]="ColorBlend",e[e.ColorWave=20]="ColorWave",e[e.ComplementaryColor=21]="ComplementaryColor",e[e.ComplementaryColor2=22]="ComplementaryColor2",e[e.ContrastingColor=23]="ContrastingColor",e[e.Darken=24]="Darken",e[e.Desaturate=25]="Desaturate",e[e.FlashBulb=26]="FlashBulb",e[e.Flicker=27]="Flicker",e[e.GrowWithColor=28]="GrowWithColor",e[e.Lighten=30]="Lighten",e[e.StyleEmphasis=31]="StyleEmphasis",e[e.Teeter=32]="Teeter",e[e.VerticalHighlight=33]="VerticalHighlight",e[e.Wave=34]="Wave",e[e.Blink=35]="Blink",e[e.Shimmer=36]="Shimmer",e[e.Turntable3D=37]="Turntable3D",e[e.Swing3D=38]="Swing3D",e[e.JumpAndTurn3D=39]="JumpAndTurn3D",e[e.Embedded1=100]="Embedded1",e[e.Embedded2=101]="Embedded2",e[e.Embedded3=102]="Embedded3",e[e.Embedded4=103]="Embedded4",e[e.Embedded5=104]="Embedded5",e[e.Embedded6=105]="Embedded6",e[e.Embedded7=106]="Embedded7",e[e.Embedded8=107]="Embedded8",e[e.Embedded9=108]="Embedded9",e[e.Embedded10=109]="Embedded10",e[e.Embedded11=110]="Embedded11",e[e.Embedded12=111]="Embedded12",e[e.Embedded13=112]="Embedded13",e[e.Embedded14=113]="Embedded14",e[e.Embedded15=114]="Embedded15",e[e.Embedded16=115]="Embedded16",e[e.Embedded17=116]="Embedded17",e[e.Embedded18=117]="Embedded18"}(p||(p={})),function(e){e[e.None=0]="None",e[e.Appear=1]="Appear",e[e.Fly=2]="Fly",e[e.Blinds=3]="Blinds",e[e.Box=4]="Box",e[e.Checkerboard=5]="Checkerboard",e[e.Circle=6]="Circle",e[e.Crawl=7]="Crawl",e[e.Diamond=8]="Diamond",e[e.Dissolve=9]="Dissolve",e[e.Fade=10]="Fade",e[e.FlashOnce=11]="FlashOnce",e[e.Peek=12]="Peek",e[e.Plus=13]="Plus",e[e.RandomBars=14]="RandomBars",e[e.Spiral=15]="Spiral",e[e.Split=16]="Split",e[e.Stretch=17]="Stretch",e[e.Strips=18]="Strips",e[e.Swivel=19]="Swivel",e[e.Wedge=20]="Wedge",e[e.Wheel=21]="Wheel",e[e.Wipe=22]="Wipe",e[e.Zoom=23]="Zoom",e[e.RandomEffects=24]="RandomEffects",e[e.Boomerang=25]="Boomerang",e[e.Bounce=26]="Bounce",e[e.ColorReveal=27]="ColorReveal",e[e.Credits=28]="Credits",e[e.EaseIn=29]="EaseIn",e[e.Float=30]="Float",e[e.GrowAndTurn=31]="GrowAndTurn",e[e.Lightspeed=34]="Lightspeed",e[e.Pinwheel=35]="Pinwheel",e[e.RiseUp=37]="RiseUp",e[e.Swish=38]="Swish",e[e.ThinLine=39]="ThinLine",e[e.Unfold=40]="Unfold",e[e.Whip=41]="Whip",e[e.Ascend=42]="Ascend",e[e.CenterRevolve=43]="CenterRevolve",e[e.FadedSwivel=45]="FadedSwivel",e[e.Descend=47]="Descend",e[e.Sling=48]="Sling",e[e.Spinner=49]="Spinner",e[e.Compress=50]="Compress",e[e.Zip=51]="Zip",e[e.Arcup=52]="Arcup",e[e.FadedZoom=53]="FadedZoom",e[e.Glide=54]="Glide",e[e.Expand=55]="Expand",e[e.Flip=56]="Flip",e[e.Fold=58]="Fold",e[e.Arrive3D=60]="Arrive3D",e[e.FlyIn3D=61]="FlyIn3D",e[e.Draw=63]="Draw"}(g||(g={})),function(e){e[e.None=0]="None",e[e.Play=1]="Play",e[e.Pause=2]="Pause",e[e.Stop=3]="Stop",e[e.PlayFromBookmark=4]="PlayFromBookmark"}(_||(_={})),function(e){e[e.Top=1]="Top",e[e.Right=2]="Right",e[e.Bottom=4]="Bottom",e[e.Left=8]="Left",e[e.TopRight=3]="TopRight",e[e.TopLeft=9]="TopLeft",e[e.BottomRight=6]="BottomRight",e[e.BottomLeft=12]="BottomLeft",e[e.In_=16]="In_",e[e.Out=32]="Out",e[e.Ppt_ZoomIn=16]="Ppt_ZoomIn",e[e.Ppt_ZoomOut=32]="Ppt_ZoomOut",e[e.Ppt_ZoomSlightly=256]="Ppt_ZoomSlightly",e[e.Ppt_ZoomCenter=512]="Ppt_ZoomCenter",e[e.Stretch_FromTop=1]="Stretch_FromTop",e[e.Stretch_FromRight=2]="Stretch_FromRight",e[e.Stretch_FromBottom=4]="Stretch_FromBottom",e[e.Stretch_FromLeft=8]="Stretch_FromLeft",e[e.Stretch_Across=10]="Stretch_Across",e[e.Swivel_Vertical=5]="Swivel_Vertical",e[e.Swivel_Horizontal=10]="Swivel_Horizontal",e[e.ComplexClip_BlindsHoriz=10]="ComplexClip_BlindsHoriz",e[e.ComplexClip_BlindsVert=5]="ComplexClip_BlindsVert",e[e.ComplexClip_PlusIn=16]="ComplexClip_PlusIn",e[e.ComplexClip_PlusOut=32]="ComplexClip_PlusOut",e[e.ComplexClip_StripsLeftDown=12]="ComplexClip_StripsLeftDown",e[e.ComplexClip_StripsLeftUp=9]="ComplexClip_StripsLeftUp",e[e.ComplexClip_StripsRightDown=6]="ComplexClip_StripsRightDown",e[e.ComplexClip_StripsRightUp=3]="ComplexClip_StripsRightUp",e[e.ComplexClip_BoxIn=16]="ComplexClip_BoxIn",e[e.ComplexClip_BoxOut=32]="ComplexClip_BoxOut",e[e.ComplexClip_CheckerboardAcross=10]="ComplexClip_CheckerboardAcross",e[e.ComplexClip_CheckerboardDown=5]="ComplexClip_CheckerboardDown",e[e.ComplexClip_RandomBarsHoriz=10]="ComplexClip_RandomBarsHoriz",e[e.ComplexClip_RandomBarsVert=5]="ComplexClip_RandomBarsVert",e[e.ComplexClip_SplitHorizIn=26]="ComplexClip_SplitHorizIn",e[e.ComplexClip_SplitHorizOut=42]="ComplexClip_SplitHorizOut",e[e.ComplexClip_SplitVertIn=21]="ComplexClip_SplitVertIn",e[e.ComplexClip_SplitVertOut=37]="ComplexClip_SplitVertOut",e[e.ComplexClip_WipeUp=1]="ComplexClip_WipeUp",e[e.ComplexClip_WipeDown=4]="ComplexClip_WipeDown",e[e.ComplexClip_WipeLeft=8]="ComplexClip_WipeLeft",e[e.ComplexClip_WipeRight=2]="ComplexClip_WipeRight",e[e.ComplexClip_Wheel1=1]="ComplexClip_Wheel1",e[e.ComplexClip_Wheel2=2]="ComplexClip_Wheel2",e[e.ComplexClip_Wheel3=3]="ComplexClip_Wheel3",e[e.ComplexClip_Wheel4=4]="ComplexClip_Wheel4",e[e.ComplexClip_Wheel8=8]="ComplexClip_Wheel8",e[e.ComplexClip_CircleIn=16]="ComplexClip_CircleIn",e[e.ComplexClip_CircleOut=32]="ComplexClip_CircleOut",e[e.ComplexClip_DiamondIn=16]="ComplexClip_DiamondIn",e[e.ComplexClip_DiamondOut=32]="ComplexClip_DiamondOut",e[e.Zoom_In=0]="Zoom_In",e[e.Zoom_InFromCenter=1]="Zoom_InFromCenter",e[e.Zoom_InSlightly=2]="Zoom_InSlightly",e[e.Zoom_Out=3]="Zoom_Out",e[e.Zoom_OutFromBottom=4]="Zoom_OutFromBottom",e[e.Zoom_OutSlightly=5]="Zoom_OutSlightly",e[e.ObjRotLeft=2]="ObjRotLeft",e[e.ObjRotRight=4]="ObjRotRight",e[e.ObjRotBack=8]="ObjRotBack",e[e.ObjRotFront=16]="ObjRotFront",e[e.ObjRotCounterclockwise=32]="ObjRotCounterclockwise",e[e.ObjRotClockwise=64]="ObjRotClockwise",e[e.ViewRotRight=128]="ViewRotRight",e[e.ViewRotLeft=256]="ViewRotLeft",e[e.ViewRotUp=512]="ViewRotUp",e[e.ViewRotDown=1024]="ViewRotDown",e[e.ViewRotClockwise=2048]="ViewRotClockwise",e[e.ViewRotCounterclockwise=4096]="ViewRotCounterclockwise",e[e.ObjTransLeft=8192]="ObjTransLeft",e[e.ObjTransRight=16384]="ObjTransRight",e[e.ObjTransUp=32768]="ObjTransUp",e[e.ObjTransDown=65536]="ObjTransDown",e[e.ObjTransBack=131072]="ObjTransBack",e[e.ObjTransFront=262144]="ObjTransFront",e[e.ViewTransRight=524288]="ViewTransRight",e[e.ViewTransLeft=1048576]="ViewTransLeft",e[e.ViewTransUp=2097152]="ViewTransUp",e[e.ViewTransDown=4194304]="ViewTransDown",e[e.ViewTransBack=8388608]="ViewTransBack",e[e.ViewTransFront=16777216]="ViewTransFront",e[e.DrawProgress=0]="DrawProgress",e[e.DrawProgressAllAtOnce=1]="DrawProgressAllAtOnce"}(v||(v={}));class S{}S.Transpose=1,S.Invert=2,S.FlipHorz=4,S.FlipVert=8,S.IsDistributedByLength=16,S.EffectMap=[{FxId:g.Split,Dir:v.ComplexClip_SplitVertIn,Preset:9,Param:0,EntFlags:0,ExitFlags:S.Invert},{FxId:g.Split,Dir:v.ComplexClip_SplitVertOut,Preset:9,Param:0,EntFlags:S.Invert,ExitFlags:0},{FxId:g.Split,Dir:v.ComplexClip_SplitHorizIn,Preset:9,Param:0,EntFlags:S.Transpose,ExitFlags:S.Transpose|S.Invert},{FxId:g.Split,Dir:v.ComplexClip_SplitHorizOut,Preset:9,Param:0,EntFlags:S.Transpose|S.Invert,ExitFlags:S.Transpose},{FxId:g.Blinds,Dir:v.ComplexClip_BlindsHoriz,Preset:1,Param:6,EntFlags:S.Transpose,ExitFlags:S.Transpose},{FxId:g.Blinds,Dir:v.ComplexClip_BlindsVert,Preset:1,Param:6,EntFlags:0,ExitFlags:0},{FxId:g.Checkerboard,Dir:v.ComplexClip_CheckerboardAcross,Preset:3,Param:6,EntFlags:0,ExitFlags:0},{FxId:g.Checkerboard,Dir:v.ComplexClip_CheckerboardDown,Preset:3,Param:6,EntFlags:S.Transpose,ExitFlags:S.Transpose},{FxId:g.Circle,Dir:v.ComplexClip_CircleIn,Preset:4,Param:0,EntFlags:0,ExitFlags:S.Invert},{FxId:g.Circle,Dir:v.ComplexClip_CircleOut,Preset:4,Param:0,EntFlags:S.Invert,ExitFlags:0},{FxId:g.Diamond,Dir:v.ComplexClip_DiamondIn,Preset:5,Param:0,EntFlags:0,ExitFlags:S.Invert},{FxId:g.Diamond,Dir:v.ComplexClip_DiamondOut,Preset:5,Param:0,EntFlags:S.Invert,ExitFlags:0},{FxId:g.Plus,Dir:v.ComplexClip_PlusIn,Preset:7,Param:0,EntFlags:0,ExitFlags:S.Invert},{FxId:g.Plus,Dir:v.ComplexClip_PlusOut,Preset:7,Param:0,EntFlags:S.Invert,ExitFlags:0},{FxId:g.Dissolve,Dir:0,Preset:6,Param:0,EntFlags:0,ExitFlags:0},{FxId:g.Fade,Dir:0,Preset:0,Param:0,EntFlags:0,ExitFlags:0},{FxId:g.RandomBars,Dir:v.ComplexClip_RandomBarsHoriz,Preset:8,Param:0,EntFlags:S.Transpose,ExitFlags:S.Transpose},{FxId:g.RandomBars,Dir:v.ComplexClip_RandomBarsVert,Preset:8,Param:0,EntFlags:0,ExitFlags:0},{FxId:g.Box,Dir:v.ComplexClip_BoxIn,Preset:2,Param:0,EntFlags:0,ExitFlags:S.Invert},{FxId:g.Box,Dir:v.ComplexClip_BoxOut,Preset:2,Param:0,EntFlags:S.Invert,ExitFlags:0},{FxId:g.Strips,Dir:v.ComplexClip_StripsLeftUp,Preset:10,Param:16,EntFlags:S.Invert,ExitFlags:S.Invert},{FxId:g.Strips,Dir:v.ComplexClip_StripsLeftDown,Preset:10,Param:16,EntFlags:S.FlipHorz,ExitFlags:S.FlipHorz},{FxId:g.Strips,Dir:v.ComplexClip_StripsRightUp,Preset:10,Param:16,EntFlags:S.FlipVert,ExitFlags:S.FlipVert},{FxId:g.Strips,Dir:v.ComplexClip_StripsRightDown,Preset:10,Param:16,EntFlags:0,ExitFlags:0},{FxId:g.Wedge,Dir:0,Preset:11,Param:2,EntFlags:0,ExitFlags:S.Invert},{FxId:g.Wheel,Dir:v.ComplexClip_Wheel1,Preset:12,Param:1,EntFlags:0,ExitFlags:S.FlipHorz},{FxId:g.Wheel,Dir:v.ComplexClip_Wheel2,Preset:12,Param:2,EntFlags:0,ExitFlags:S.FlipHorz},{FxId:g.Wheel,Dir:v.ComplexClip_Wheel3,Preset:12,Param:3,EntFlags:0,ExitFlags:S.FlipHorz},{FxId:g.Wheel,Dir:v.ComplexClip_Wheel4,Preset:12,Param:4,EntFlags:0,ExitFlags:S.FlipHorz},{FxId:g.Wheel,Dir:v.ComplexClip_Wheel8,Preset:12,Param:8,EntFlags:0,ExitFlags:S.FlipHorz},{FxId:g.Wipe,Dir:v.ComplexClip_WipeUp,Preset:1,Param:1,EntFlags:S.Transpose,ExitFlags:S.Transpose|S.Invert},{FxId:g.Wipe,Dir:v.ComplexClip_WipeDown,Preset:1,Param:1,EntFlags:S.Transpose|S.Invert,ExitFlags:S.Transpose},{FxId:g.Wipe,Dir:v.ComplexClip_WipeLeft,Preset:1,Param:1,EntFlags:0,ExitFlags:S.Invert},{FxId:g.Wipe,Dir:v.ComplexClip_WipeRight,Preset:1,Param:1,EntFlags:S.Invert,ExitFlags:0},{FxId:g.Draw,Dir:v.DrawProgress,Preset:13,Param:0,EntFlags:S.IsDistributedByLength,ExitFlags:S.IsDistributedByLength},{FxId:g.Draw,Dir:v.DrawProgressAllAtOnce,Preset:13,Param:0,EntFlags:0,ExitFlags:0}],function(e){e[e.MoveTo=0]="MoveTo",e[e.LineTo=1]="LineTo",e[e.CurveTo=2]="CurveTo"}(y||(y={}));class T{constructor(e,t){this.m_id=e,this.m_evaluators=[],this.m_aggregateRule=t,this.m_fHasCachedValue=!1}registerAnimEvaluator(e){this.m_evaluators.push(e)}mergeWith(e){if(this!==e){if(this.m_aggregateRule===c.BaselineOnly)this.m_aggregateRule=e.AggregateRule;else if(this.m_aggregateRule!==e.AggregateRule)return;for(let t of e.Evaluators)this.registerAnimEvaluator(t)}}get AttrId(){return this.m_id}get Evaluators(){return this.m_evaluators}get AggregateRule(){return this.m_aggregateRule}clearCachedValue(){this.m_fHasCachedValue=!1}}class w extends T{constructor(e,t,i){super(e,i),this.m_baseLineValue=t}fUpdateAggregateValue(e){let t=this.m_baseLineValue;switch(this.m_aggregateRule){case c.Add:for(let i of this.m_evaluators)t+=i.evaluate(e,0);break;case c.Mult:for(let i of this.m_evaluators)t*=i.evaluate(e,this.m_baseLineValue);break;case c.First:for(let i of this.m_evaluators)if(t=i.evaluate(e,this.m_baseLineValue),t!==this.m_baseLineValue)break;break;case c.Last:for(let i=this.m_evaluators.length-1;i>=0&&(t=this.m_evaluators[i].evaluate(e,this.m_baseLineValue),t===this.m_baseLineValue);i-=1);break;case c.BaselineOnly:}let i=this.m_cachedValue!==t||!this.m_fHasCachedValue;return i&&(this.m_cachedValue=t,this.m_fHasCachedValue=!0),i}get Value(){return this.m_fHasCachedValue?this.m_cachedValue:this.m_baseLineValue}}class M extends T{constructor(e,t,i){super(e,i),this.m_baselineValue=t,this.m_cachedValue=null}fUpdateAggregateValue(e){let t=this.m_baselineValue;switch(this.m_aggregateRule){case c.First:for(let i of this.m_evaluators)if(i.EvalId===d.ConstantObject&&(t=i.evaluateObject(e,this.m_baselineValue),t!==this.m_baselineValue))break;break;case c.Last:for(let i=this.m_evaluators.length-1;i>=0;i-=1){let r=this.m_evaluators[i];if(r.EvalId===d.ConstantObject&&(t=r.evaluateObject(e,this.m_baselineValue),t!==this.m_baselineValue))break}break;case c.Add:case c.Mult:case c.BaselineOnly:}const i=this.m_cachedValue!==t||!this.m_fHasCachedValue;return i&&(this.m_cachedValue=t,this.m_fHasCachedValue=!0),i}get Value(){return this.m_fHasCachedValue?this.m_cachedValue:this.m_baselineValue}}var C=i(31);class I{constructor(){this.m_startTimeMs=0,this.m_pausedTimeMs=0,this.m_requestId=-1,this.events=new C.EventEmitter}start(e){this.stop(),this.m_requestId=window.requestAnimationFrame(this.loop.bind(this)),this.m_startTimeMs=Date.now()-(e||0),this.events.emit("tick",this.currentTimeMs)}stop(){window.cancelAnimationFrame(this.m_requestId),this.m_pausedTimeMs=0,this.events.emit("notRunning",null)}pause(){this.stop(),this.m_pausedTimeMs=Date.now()}resume(){let e=this.m_pausedTimeMs?this.m_pausedTimeMs-this.m_startTimeMs:0;this.start(e)}get currentTimeMs(){return Date.now()-this.m_startTimeMs}loop(){this.m_requestId=window.requestAnimationFrame(this.loop.bind(this)),this.events.emit("tick",this.currentTimeMs)}}class P{constructor(e){this.TimeSmoother=null,this.m_clickTimeProvider=e}}class E extends P{constructor(e,t,i,r,n){super(n),this.m_adjustedStartTime=0,this.m_adjustedEndTime=0,this.m_timelineId=e,this.m_evalTimeSpan=t,this.m_numRepeats=i,this.m_repeatGap=r}checkAndUpdateTimeBounds(e){let t,i=this.m_clickTimeProvider.getClickTime(this.m_timelineId,this.m_evalTimeSpan.Start.ClickNum).ClickTime;if(i===b.Undefined)return!1;if(i+=this.m_evalTimeSpan.Start.Offs,e<i){let e=this.m_numRepeats===b.RepeatForever,t=this.m_clickTimeProvider.getClickTime(this.m_timelineId,this.m_evalTimeSpan.Start.ClickNum+1).ClickTime!==b.Undefined;if(e||!t)return!1}if(this.m_evalTimeSpan.End.Offs===b.Undefined)t=b.Undefined;else{if(this.m_evalTimeSpan.End.ClickNum===b.Undefined?t=i+this.m_evalTimeSpan.End.Offs:(t=this.m_clickTimeProvider.getClickTime(this.m_timelineId,this.m_evalTimeSpan.End.ClickNum).ClickTime,t!==b.Undefined&&(t+=this.m_evalTimeSpan.End.Offs)),t!==b.Undefined&&e>=t){let r=t-i+this.m_repeatGap;if(this.m_numRepeats!==b.RepeatForever&&e>=t+r*this.m_numRepeats)return!1;if((e-t)%r<this.m_repeatGap)return!1}let r=this.m_clickTimeProvider.getClickTime(this.m_timelineId,this.m_evalTimeSpan.SkipClickNum).ClickTime;if(r!==b.Undefined&&e>=r)return!1}return this.m_adjustedStartTime=i,this.m_adjustedEndTime=t,!0}getEquivalentTimeFromRepeatTime(e){if(e<this.m_adjustedEndTime)return e;if(this.m_adjustedEndTime===b.Undefined)return e;let t=this.m_adjustedEndTime-this.m_adjustedStartTime+this.m_repeatGap;return 0===t?e:this.m_adjustedStartTime+(e-this.m_adjustedEndTime)%t-this.m_repeatGap}get TimelineId(){return this.m_timelineId}get TimeSpan(){return this.m_evalTimeSpan}}class x extends E{constructor(e,t,i,r,n,a){super(e,t,i,r,n),this.m_value=a}evaluate(e,t){return t}evaluateObject(e,t){return this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),this.checkAndUpdateTimeBounds(e)?this.m_value:t}get EvalId(){return d.ConstantObject}}class A extends E{constructor(e,t,i,r,n,a){super(e,t,i,r,n),this.m_modValue=a}evaluate(e,t){return this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),this.checkAndUpdateTimeBounds(e)?this.m_modValue:t}get EvalId(){return d.ConstantObject}}class k extends E{constructor(e,t,i,r,n,a){super(e,t,i,r,n),this.m_valRangePair=a}evaluate(e,t){if(this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),!this.checkAndUpdateTimeBounds(e))return t;if(this.m_adjustedEndTime===b.Undefined)return this.m_valRangePair.Val1;let i=(this.getEquivalentTimeFromRepeatTime(e)-this.m_adjustedStartTime)/(this.m_adjustedEndTime-this.m_adjustedStartTime);return this.m_valRangePair.Val1+i*(this.m_valRangePair.Val2-this.m_valRangePair.Val1)}get EvalId(){return d.Linear}}class R extends E{constructor(e,t,i,r,n,a){super(e,t,i,r,n),this.m_controlValList=a}evaluate(e,t){if(null!=this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),!this.checkAndUpdateTimeBounds(e))return t;if(this.m_adjustedEndTime===b.Undefined)return this.m_controlValList[0];const i=(this.getEquivalentTimeFromRepeatTime(e)-this.m_adjustedStartTime)/(this.m_adjustedEndTime-this.m_adjustedStartTime);return G.calculateBezierCoordinate(this.m_controlValList[0],this.m_controlValList[1],this.m_controlValList[2],this.m_controlValList[3],i)}get EvalId(){return d.Bezier}}class O extends E{constructor(e,t,i,r,n){super(e,t,i,r,n)}evaluate(e,t){return t}fInRange(e){return this.checkAndUpdateTimeBounds(e)}getEquivalentTime(e){return this.getEquivalentTimeFromRepeatTime(e)}get EvalId(){return d.SmoothHelper}get AdjustedStartTime(){return this.m_adjustedStartTime}get AdjustedEndTime(){return this.m_adjustedEndTime}}class L extends P{constructor(e,t,i){super(i),this.m_visTrack=e,this.m_modValue=t,this.m_resolvedVisTrack=void 0}evaluate(e,t){return this.TimeSmoother&&(e=this.TimeSmoother.smooth(e)),this.checkVisTrackMap(e)?t:this.m_modValue}checkVisTrackMap(e){if(null==this.m_resolvedVisTrack){this.m_resolvedVisTrack=[];for(let e=0;e<this.m_visTrack.Length;e+=1){let t=this.m_visTrack.getMarker(e);if(!t)continue;let i,r=this.m_clickTimeProvider.getClickTime(t.TimelineId,t.ClickNum).ClickTime,n=0;this.m_clickTimeProvider.getClickTime(t.TimelineId,t.ClickNum+1).ClickTime===b.Undefined&&(n=t.Offs),i=r!==b.Undefined?Math.max(0,r)+n:b.Undefined,this.m_resolvedVisTrack.push(new U(i,t.FVisible,e))}this.sortResolvedVisTrack()}for(let t=this.m_resolvedVisTrack.length-1;t>=0;t-=1){let i=this.m_resolvedVisTrack[t];if(i.ResolvedTime!==b.Undefined&&i.ResolvedTime<=e)return i.FVisible}return!(this.m_resolvedVisTrack.length>0)||!this.m_resolvedVisTrack[0].FVisible}sortResolvedVisTrack(){this.m_resolvedVisTrack&&this.m_resolvedVisTrack.sort(U.sortFunction)}onClickListsChanged(){this.m_resolvedVisTrack=void 0}get EvalId(){return d.VisTrack}get VisTrack(){return this.m_visTrack}get ModValue(){return this.m_modValue}}class F{constructor(e){this.ClickTime=e}get HasOccurred(){return this.ClickTime!==b.Undefined}}class D{constructor(e,t,i,r,n,a){this.m_startPath=e,this.m_timelineId=t,this.m_click=i,this.m_offs=r,this.m_xTarget=n,this.m_yTarget=a}get FStartPath(){return this.m_startPath}get TimeLineId(){return this.m_timelineId}get Click(){return this.m_click}get Offs(){return this.m_offs}get XTarget(){return this.m_xTarget}get YTarget(){return this.m_yTarget}}class B{constructor(e,t){this.Id=e,this.Shape=t,this.m_attributes=[],this.m_visAttributeIndex=b.Undefined}get Attributes(){return this.m_attributes}registerAnimAttribute(e,t){for(let t of this.m_attributes)if(t.AttrId===e.AttrId)return void t.mergeWith(e);if(t&&this.m_visAttributeIndex!==b.Undefined)return this.m_attributes.splice(this.m_visAttributeIndex,0,e),void(this.m_visAttributeIndex+=1);this.m_attributes.push(e),e.AttrId===h.Visible&&(this.m_visAttributeIndex=this.m_attributes.length-1)}getRegisteredAttribute(e){for(let t of this.m_attributes){let i=t;if(i.AttrId===e)return i}}aggregateAllAttributesForTime(e){let t=!1;for(let i of this.m_attributes)i.fUpdateAggregateValue(e)&&(t=!0);return t}clearCachedAttributeValues(){for(let e of this.m_attributes)e.clearCachedValue()}getAnimEndTime(){let e=new Map;for(let t of this.m_attributes)for(let i of t.Evaluators)if(i.EvalId===d.VisTrack){let t,r=i;for(let i=0;i<r.VisTrack.Length;i+=1){let n=r.VisTrack.getMarker(i);n&&(t=e.get(n.TimelineId),null==t&&(t={ClickNum:n.ClickNum,Offs:n.Offs},e.set(n.TimelineId,t)),n.ClickNum>=t.ClickNum&&(t.ClickNum=n.ClickNum,n.Offs>=t.Offs&&(t.Offs=n.Offs)))}}else{let t=i;if(null==t.TimeSpan)continue;let r=e.get(t.TimelineId);if(null==r&&(r={ClickNum:t.TimeSpan.Start.ClickNum,Offs:t.TimeSpan.Start.Offs+t.TimeSpan.End.Offs},e.set(t.TimelineId,r)),t.TimeSpan.Start.ClickNum>=r.ClickNum){r.ClickNum=t.TimeSpan.Start.ClickNum;let e=t.TimeSpan.Start.Offs+t.TimeSpan.End.Offs;e>=r.Offs&&(r.Offs=e)}}return e}}class N{static getAnimAttributeValue(e,t,i){for(const i of e)if(i.AttrId===t){if(i instanceof w)return i.Value;if(i instanceof M)return i.Value}return i}}class V{constructor(e,t,i,r){this.FVisible=e,this.TimelineId=t,this.ClickNum=i,this.Offs=r}}class U{constructor(e,t,i){this.ResolvedTime=e,this.FVisible=t,this.MarkerIndex=i}static sortFunction(e,t){return e.ResolvedTime!==t.ResolvedTime?e.ResolvedTime===b.Undefined&&t.ResolvedTime!==b.Undefined?1:t.ResolvedTime===b.Undefined&&e.ResolvedTime!==b.Undefined||e.ResolvedTime<t.ResolvedTime?-1:1:e.MarkerIndex<t.MarkerIndex?-1:t.MarkerIndex<e.MarkerIndex?1:0}}class W{constructor(){this.m_track=[]}get Length(){return this.m_track.length}getMarker(e){return e<this.m_track.length?this.m_track[e]:null}becomesVisibleAt(e,t,i){this.m_track.push(new V(!0,e,t,i))}becomesInvisibleAt(e,t,i){this.m_track.push(new V(!1,e,t,i))}}class z{constructor(e,t,i,r,n,a,s){this.m_helperEvaluator=new O(e,t,i,r,n),this.m_smoothStartFactor=Math.max(0,Math.min(a,1)),this.m_smoothEndFactor=Math.max(0,Math.min(s,1-this.m_smoothStartFactor)),this.m_vTarget=1/(1-this.m_smoothStartFactor/2-this.m_smoothEndFactor/2),this.m_tAOverPi=this.m_smoothStartFactor/Math.PI,this.m_tBOverPi=this.m_smoothEndFactor/Math.PI,this.m_linearOffset=-this.m_vTarget*this.m_smoothStartFactor/2}smooth(e){if(!this.m_helperEvaluator.fInRange(e))return e;if(this.m_helperEvaluator.AdjustedEndTime===b.Undefined)return e;const t=this.m_helperEvaluator.AdjustedEndTime-this.m_helperEvaluator.AdjustedStartTime;if(t<=0)return e;const i=(this.m_helperEvaluator.getEquivalentTime(e)-this.m_helperEvaluator.AdjustedStartTime)/t;let r;if(i<this.m_smoothStartFactor)r=this.m_vTarget/2*(i-this.m_tAOverPi*Math.sin(i/this.m_tAOverPi));else if(i>1-this.m_smoothEndFactor){const e=1-i;r=1-this.m_vTarget/2*(e-this.m_tBOverPi*Math.sin(e/this.m_tBOverPi))}else r=i*this.m_vTarget+this.m_linearOffset;return r*t+this.m_helperEvaluator.AdjustedStartTime}}class G{static calculateBezierCoordinate(e,t,i,r,n){const a=e+n*(t-e),s=t+n*(i-t),o=a+n*(s-a);return o+n*(s+n*(i+n*(r-i)-s)-o)}}class j{constructor(){this.m_currentRelativeTime=0,this.m_animObjectList=[],this.m_clickTimeListMap=new Map,this.m_timelineIdList=[],this.m_endTimeMap=new Map}getEndTime(e){return this.m_endTimeMap[e]}onClickTimeListsChanged(e){if(this.m_callbackVisEvaluatorList)for(let e of this.m_callbackVisEvaluatorList)e.onClickListsChanged();e&&e()}clearAllClickTimeLists(){this.m_clickTimeListMap=new Map;for(let e of this.m_timelineIdList)this.m_clickTimeListMap[e]=[]}createVisEvaluatorCallbackList(e){let t=[];for(let i of e)for(let e of i.Attributes)if(e.AttrId===h.Visible)for(let i of e.Evaluators)i.EvalId===d.VisTrack&&t.push(i);return t}adjustClickTimeListOnPop(e){for(let t of e)t.HasOccurred&&(t.ClickTime-=j.c_removeClickTimeAdjustInMs)}setTimeAndCalculate(e){this.m_currentRelativeTime=e;let t=!1;for(let i of this.m_animObjectList)i.aggregateAllAttributesForTime(e)&&(t=!0);return t}forceSlideRedraw(){if(this.m_animObjectList)for(let e of this.m_animObjectList)e.clearCachedAttributeValues()}resetTimeline(e,t){this.m_clickTimeListMap[e]=[],this.onClickTimeListsChanged(t)}hasTimelineFinished(e){const t=this.m_endTimeMap[e];if(null==t)return!1;let i=this.m_clickTimeListMap[e];if(null==i)return!1;if(i.length<t.ClickNum)return!1;if(i.length>t.ClickNum)return!0;if(0===i.length)return 0===t.ClickNum&&this.m_currentRelativeTime>=t.Offs;let r=this.m_currentRelativeTime-i[i.length-1].ClickTime;return t.Offs<r}addTimelineClickInternal(e,t,i){null!=this.m_clickTimeListMap[e]&&(this.m_clickTimeListMap[e].push(new F(t)),this.onClickTimeListsChanged(i))}addTimelineClicks(e,t,i){for(let i=0;i<t;i+=1)this.addTimelineClick(e,void 0);t>0&&this.onClickTimeListsChanged(i)}addTimelineClick(e,t){if(null==this.m_clickTimeListMap)return;let i=this.m_currentRelativeTime;this.addTimelineClickInternal(e,i,t)}removeTimelineClicks(e,t,i){for(let i=0;i<t;i+=1)this.removeTimelineClick(e,void 0);t>0&&this.onClickTimeListsChanged(i)}removeTimelineClick(e,t){if(null==this.m_clickTimeListMap)return;let i=this.m_clickTimeListMap[e];null!=i&&i.length>0&&(i.pop(),this.adjustClickTimeListOnPop(i),this.onClickTimeListsChanged(t))}getTimelineStates(e){if(!this.m_timelineIdList)return null;let t=[];for(const i of this.m_timelineIdList){const r=this.getNumTimelineClicks(i),n=this.getClickTime(i,r).ClickTime;e?t.push({timelineId:i,step:r,lastClickTime:n}):t.push({timelineId:i,step:r})}return t}setTimelineStates(e){for(const t of e){const e=this.m_clickTimeListMap[t.timelineId];if(!e||!this.m_endTimeMap[t.timelineId])continue;const i=e.length,r=this.m_endTimeMap[t.timelineId].ClickNum;let n=Math.min(Math.max(t.step,0),r+1);n>i?this.addTimelineClicks(t.timelineId,n-i):n<i&&this.removeTimelineClicks(t.timelineId,i-n),null!=t.lastClickTime&&e.length>0&&(e[e.length-1].ClickTime=t.lastClickTime)}}getNumTimelineClicks(e){if(null==this.m_clickTimeListMap)return 0;let t=this.m_clickTimeListMap[e];return null==t?0:t.length}getClickTime(e,t){if(null==this.m_clickTimeListMap)return new F(b.Undefined);let i=this.m_clickTimeListMap[e];return null==i||t===b.Undefined?new F(b.Undefined):0===t?new F(0):i.length<t?new F(b.Undefined):i[t-1]}initTimeline(e,t,i,r,n){if(null!=t&&0!==t.length){this.m_timelineIdList=t,this.m_animObjectList=e,this.m_callbackVisEvaluatorList=this.createVisEvaluatorCallbackList(e),this.clearAllClickTimeLists();for(let[e,t]of i.entries())if(t)for(let i=0;i<t.ClickNum;i+=1){let r=i===t.ClickNum-1?t.Offs:0;this.addTimelineClickInternal(e,r,void 0)}this.onClickTimeListsChanged(n),this.setTimeAndCalculate(r),this.calculateEndTimes()}}calculateEndTimes(){this.m_endTimeMap=new Map;for(const e of this.m_animObjectList)for(const[t,i]of e.getAnimEndTime()){const e=this.m_endTimeMap[t];(null==e||i.ClickNum>e.ClickNum||i.ClickNum===e.ClickNum&&i.Offs>e.Offs)&&(this.m_endTimeMap[t]=i)}null==this.m_endTimeMap[b.MainTimelineId]&&(this.m_endTimeMap[b.MainTimelineId]={ClickNum:0,Offs:0})}}j.c_removeClickTimeAdjustInMs=36e5;var H=i(2),q=i(3);class ${constructor(e,t){this.m_clickTimeProvider=e,this.m_visTrackTable=t}addEvaluatorConstantAfter(e,t,i,r,n){let a={Start:{ClickNum:i,Offs:r},End:{ClickNum:b.Undefined,Offs:b.Undefined},SkipClickNum:b.Undefined},s=new A(e,a,0,0,this.m_clickTimeProvider,n);t.registerAnimEvaluator(s)}addEvaluatorConstantObjectAfter(e,t,i,r,n){const a={Start:{ClickNum:i,Offs:r},End:{ClickNum:b.Undefined,Offs:b.Undefined},SkipClickNum:b.Undefined},s=new x(e,a,0,0,this.m_clickTimeProvider,n);t.registerAnimEvaluator(s)}addEvaluatorConstantObject(e,t,i,r,n,a,s,o){const l=$.getRepeatsSkipClick(i+1,s),d=$.getEvalNumRepeats(s),h={Start:{ClickNum:i,Offs:r},End:{ClickNum:b.Undefined,Offs:n},SkipClickNum:l},c=new x(e,h,d,o,this.m_clickTimeProvider,a);return t.registerAnimEvaluator(c),c}addEvaluatorConstantDuration(e,t,i,r,n,a,s,o){this.addEvaluatorConstantSpan(e,t,i,r,b.Undefined,n,a,s,o)}addEvaluatorConstantSpan(e,t,i,r,n,a,s,o,l){let d=$.getRepeatsSkipClick(n===b.Undefined?b.Undefined:n+1,o),h=$.getEvalNumRepeats(o),c=new A(e,{Start:{ClickNum:i,Offs:r},End:{ClickNum:n,Offs:a},SkipClickNum:d},h,l,this.m_clickTimeProvider,s);t.registerAnimEvaluator(c)}addEvaluatorConstantObjectSpan(e,t,i,r,n,a,s,o,l){const d=$.getRepeatsSkipClick(n===b.Undefined?b.Undefined:n+1,o),h=$.getEvalNumRepeats(o),c=new x(e,{Start:{ClickNum:i,Offs:r},End:{ClickNum:n,Offs:a},SkipClickNum:d},h,l,this.m_clickTimeProvider,s);t.registerAnimEvaluator(c)}addEvaluatorLinear(e,t,i,r,n,a,s,o,l){let d=$.getRepeatsSkipClick(i+1,o),h=$.getEvalNumRepeats(o),c={Start:{ClickNum:i,Offs:r},End:{ClickNum:b.Undefined,Offs:n},SkipClickNum:d},u={Val1:a,Val2:s},f=new k(e,c,h,l,this.m_clickTimeProvider,u);return t.registerAnimEvaluator(f),f}addEvaluatorConstantObjectBidir(e,t,i,r,n,a,s,o,l,d){if(this.m_visTrackTable[e])return o?(this.m_visTrackTable[e].becomesVisibleAt(t,r,n),this.addEvaluatorConstantObject(t,i,r,n,a,s,l,d)):(l!==b.RepeatUntilEnd&&this.m_visTrackTable[e].becomesInvisibleAt(t,J.getRepeatsClick(r,l),J.getRepeatsOffs(n,a+d,l)),this.addEvaluatorConstantObject(t,i,r,n+d,a,s,l,d))}addEvaluatorVisLinearBidir(e,t,i,r,n,a,s,o,l,d,h){if(!this.m_visTrackTable[e])return;let c;return l?(this.m_visTrackTable[e].becomesVisibleAt(t,r,n),c=this.addEvaluatorLinear(t,i,r,n,a,o,s,d,h)):(c=this.addEvaluatorLinear(t,i,r,n+h,a,s,o,d,h),d!==b.RepeatUntilEnd&&this.m_visTrackTable[e].becomesInvisibleAt(t,J.getRepeatsClick(r,d),J.getRepeatsOffs(n,a+h,d))),c}addTimeSmoother(e,t,i,r,n,a,s,o,l){if(t>0||i>0){const d={Start:{ClickNum:n,Offs:a},End:{ClickNum:b.Undefined,Offs:s},SkipClickNum:$.getRepeatsSkipClick(n+1,o)},h=new z(r,d,$.getEvalNumRepeats(o),l,this.m_clickTimeProvider,t,i);e.TimeSmoother=h}}addEvaluatorVisTrack(e,t){return new L(e,t,this.m_clickTimeProvider)}addEvaluatorsForSegmentList(e,t,i,n,a,s,o){if(null===o||0===o.length)return void r.a.sendTraceTag(595654272,H.a.msoulscat_Wac_PptAnimation,q.a.Error,"Bad segList input to AddEvaluatorsForSegmentList.");const l=this.m_visTrackTable[e];if(null==l)return void r.a.sendTraceTag(595654273,H.a.msoulscat_Wac_PptAnimation,q.a.Error,`Bad visTrack for aoId ${e} at AddEvaluatorsForSegmentList.`);let d;if(a){d=o[0],l.becomesVisibleAt(t,n,d.Offs);for(let e of o)this.addEvaluatorLinear(t,i,n,e.Offs,e.Dur,e.OffsVal,e.BaseVal,s,e.SegOffs)}else{const e=o[0];d=o[o.length-1];const r=d.Offs+d.Dur;for(let a=o.length-1;a>=0;a-=1){d=o[a];const l=r-(d.Offs-e.Offs)-d.Dur;this.addEvaluatorLinear(t,i,n,l,d.Dur,d.BaseVal,d.OffsVal,s,d.SegOffs)}if(s!==b.RepeatUntilEnd){const i=e.Offs,a=r-i;l.becomesInvisibleAt(t,J.getRepeatsClick(n,s),J.getRepeatsOffs(i,a,s))}}}addEvaluatorBezier(e,t,i,r,n,a,s,o){const l=$.getRepeatsSkipClick(i+1,s),d=$.getEvalNumRepeats(s),h={Start:{ClickNum:i,Offs:r},End:{ClickNum:b.Undefined,Offs:n},SkipClickNum:l},c=new R(e,h,d,o,this.m_clickTimeProvider,a);return t.registerAnimEvaluator(c),c}static getEvalNumRepeats(e){return e===b.RepeatUntilClick||e===b.RepeatUntilEnd?b.RepeatForever:e}static getRepeatsSkipClick(e,t){return t===b.RepeatUntilEnd?b.Undefined:e}}var Z=i(12);function X(e){r.a.setLogger(e)}class Y{constructor(){this.m_durationType=0,this.m_duration=2e3}static fromDuration(e){let t=new Y;return t.m_duration=e,t}static fromString(e){let t=new Y;return t.m_duration=1,"def"===e?(t.m_durationType=0,t.m_duration=2e3):"sld"===e?t.m_durationType=2:"clk"===e?t.m_durationType=1:(t.m_durationType=0,t.m_duration=parseInt(e,10)),t}get FTimed(){return 0===this.m_durationType}get FUntilClick(){return 1===this.m_durationType}get FUntilSlide(){return 2===this.m_durationType}get Duration(){return this.FTimed||r.a.sendTraceTag(595682199,H.a.msoulscat_Wac_PptAnimation,q.a.Error,"AnimDuration: !FTimed, bad property access."),this.m_duration}}class J{constructor(e){this.m_visTrackTable=new Map,this.m_mpRestEvalHelperTable=new Map,this.m_evalCreator=new $(e,this.m_visTrackTable)}calcChildRewindDelay(e,t,i){return e*(i-t-1)}createAnimObjectListForSlide(e,t,i){let r=new Map;const n=[];for(let e of t)for(let[t,i]of e.parts.entries()){const a=1===e.parts.length?e.id:`${e.id}c${t}`,s=new B(a,i),o=r.get(e.id)||[];o.push(s),r.set(e.id,o),this.m_visTrackTable[a]=new W,this.m_mpRestEvalHelperTable[a]=[],n.push(s);const l=new w(h.Visible,1,c.Mult),d=this.m_evalCreator.addEvaluatorVisTrack(this.m_visTrackTable[a],0);l.registerAnimEvaluator(d),s.registerAnimAttribute(l,!1)}const a=this.translateAnimations(e,r,i);for(let e=0;e<n.length;e+=1)this.generateRestEvaluators(n[e]);return{animObjectList:n,needsDummyClick:a}}getNumChildAnims(e,t){if(t.childTimeInc<0)return 0;let i=e.get(t.shapeId);return null==i||null==i.length?0:i.length}translateAnimations(e,t,i){let n=!0,a=!1;for(let s of e){if(!s.AnimationList||!s.SequenceId)continue;let e=s.AnimationList,o=s.SequenceId,l=0,d=0,h=0,c=!1;for(let s of e){if(null==!s)continue;n&&(s.startTrig!==f.OnClick&&(a=!0,s.startTrig=f.OnClick),n=!1);let e=1;!s.autoReverse||s.effectType!==u.Emphasis&&s.effectType!==u.MotionPath||(e*=2),s.numRepeats!==b.RepeatUntilClick&&s.numRepeats!==b.RepeatUntilEnd&&(e*=s.numRepeats+1);let m=0,p=this.getNumChildAnims(t,s);p>0&&(m+=p*s.childTimeInc);let g=0,_=0,v=Y.fromString(s.animSpeed),y=s.numRepeats===b.RepeatUntilClick||s.numRepeats===b.RepeatUntilEnd||!v.FTimed,S=0;switch(y||(S=e*v.Duration),s.startTrig){case f.OnClick:g=l+=1,_=s.timeOffs,d=0,h=_+S+m;break;case f.WithPrevious:g=l,_=d+s.timeOffs,h=Math.max(h,_+S+m);break;case f.AfterPrevious:c?(g=l,_+=s.timeOffs,d=h):(g=l,_=h+s.timeOffs,d=h),h=_+S+m;break;default:r.a.sendTraceTag(595682200,H.a.msoulscat_Wac_PptAnimation,q.a.Info,"AnimTranslate::translateAnimations: Unrecognized start trigger, assuming onClick."),g=l+=1,_=s.timeOffs,d=0,h=_+S+m}if(c=y,s.childTimeInc<0){let e=t.get(s.shapeId);if(!e||!e[0]){r.a.sendTraceTag(595682201,H.a.msoulscat_Wac_PptAnimation,q.a.Info,`AnimTranslate::translateAnimations: Invalid shapeId:${s.shapeId}. Anim ignored.`);continue}this.translateOneAnim(s,o,e[0],g,_,v,i)}else{const e=t.get(s.shapeId)||[];let r=s.childTimeInc;const n=v,a=e.length;for(let[t,l]of e.entries())s.rewindChildDelay=this.calcChildRewindDelay(s.childTimeInc,t,a),this.translateOneAnim(s,o,l,g,_+r,n,i),r+=s.childTimeInc}}}return a}translateOneAnim(e,t,i,n,a,s,o){switch(r.a.sendTraceTag(595653975,H.a.msoulscat_Wac_PptAnimation,q.a.Info,`AnimTranslate::translateOneAnim: Animation effectType:${e.effectType}, effectId:${e.effectId}`),e.effectType){case u.Entrance:this.translateEntranceExitEffect(e,t,i,n,a,s,!0,o);break;case u.Exit:this.translateEntranceExitEffect(e,t,i,n,a,s,!1,o);break;case u.MotionPath:this.addInitialVisibilityMarker(i.Id,t),this.translateMotionPathEffect(e,t,i,n,a,s.Duration);break;case u.Emphasis:this.translateEmphasisEffect(e,t,i,n,a,s),this.addInitialVisibilityMarker(i.Id,t);break;case u.Media:this.translateMediaEffect(e,t,i,n,a,s);break;default:r.a.sendTraceTag(595682202,H.a.msoulscat_Wac_PptAnimation,q.a.Info,"AnimTranslate::translateOneAnim: Unknown anim effect category. Ignored.")}if(e.numRepeats!==b.RepeatUntilEnd){let o=this.m_visTrackTable[i.Id];if(!o)return void r.a.sendTraceTag(595682203,H.a.msoulscat_Wac_PptAnimation,q.a.Info,"AnimTranslate::translateOnAnim: Bad visibility track when trying to add After effect.");if(e.after===m.HideImmediatelyAfter){let i=s.FTimed?s.Duration:0;o.becomesInvisibleAt(t,J.getRepeatsClick(n,e.numRepeats),J.getRepeatsOffs(a,i,e.numRepeats))}else e.after===m.HideOnNextClick&&o.becomesInvisibleAt(t,n+1,0)}}translateEntranceExitEffect(e,t,i,n,a,s,o,l){const d=e.effectId,h={animObject:i,timelineId:t,click:n,offs:a,dur:s,isEntrance:o,numRepeats:e.numRepeats,direction:e.direction,effectId:d};switch(d){case g.Appear:this.addEffect_Appear(h);break;case g.Fly:case g.Crawl:this.addEffect_Fly(h,l,e.smoothStartFactor,e.smoothEndFactor);break;case g.Lightspeed:h.direction=o?v.Left:v.Right,this.addEffect_Fly(h,l,e.smoothStartFactor,e.smoothEndFactor);break;case g.Dissolve:h.direction=0,this.addEffect_ComplexClip(h);break;case g.Blinds:case g.Box:case g.Checkerboard:case g.Circle:case g.Diamond:case g.RandomBars:case g.Plus:case g.Split:case g.Strips:case g.Wedge:case g.Wheel:this.addEffect_ComplexClip(h);break;case g.Fade:this.addEffect_Fade(h,0,1,0);break;case g.FlashOnce:this.addEffect_FlashOnce(h);break;case g.Peek:this.addEffect_Peek(h);break;case g.Stretch:this.addEffect_Stretch(h);break;case g.Swivel:this.addEffect_Swivel(h,!1);break;case g.FadedSwivel:this.addEffect_Swivel(h,!0);break;case g.Wipe:this.addEffect_Wipe(h);break;case g.Zoom:h.direction=J.translatePPTZoomFlags(h.direction,h.isEntrance),this.addEffect_Zoom(h,l);break;case g.Boomerang:this.addEffect_Boomerang(h);break;case g.Credits:this.addEffect_Credits(h,l.y);break;case g.EaseIn:this.addEffect_EaseIn(h);break;case g.Float:this.addEffect_Float(h);break;case g.GrowAndTurn:this.addEffect_GrowAndTurn(h);break;case g.Pinwheel:this.addEffect_PinWheel(h);break;case g.RiseUp:this.addEffect_RiseUp(h);break;case g.Swish:this.addEffect_Swish(h,l);break;case g.ThinLine:this.addEffect_Thinline(h);break;case g.Unfold:this.addEffect_Unfold(h);break;case g.Whip:this.addEffect_Whip(h);break;case g.Ascend:case g.Descend:this.addEffect_AscendDescend(h);break;case g.Sling:this.addEffect_Sling(h,l);break;case g.Spinner:this.addEffect_Spinner(h);break;case g.Compress:this.addEffect_ExpandCompress(h,b.CompressWidthFactor);break;case g.Expand:this.addEffect_ExpandCompress(h,b.ExpandWidthFactor);break;case g.Zip:this.addEffect_Zip(h,l);break;case g.Arcup:this.addEffect_ArcUp(h,e);break;case g.FadedZoom:h.direction=J.translatePPTZoomFlags(h.direction,h.isEntrance),this.addEffect_FadedZoom(h,l);break;case g.Glide:this.addEffect_Glide(h);break;case g.Flip:this.addEffect_Flip(h,l);break;case g.Fold:this.addEffect_Fold(h,l,e.smoothStartFactor,e.smoothEndFactor);break;case g.Draw:this.addEffect_Draw(h,e.animatedPropertyList);break;default:r.a.sendTraceTag(595682204,H.a.msoulscat_Wac_PptAnimation,q.a.Info,`AnimTranslate::translateEntranceExitEffect: Unrecognized or unimplemented effect ID:  ${e.effectId} . Using Fade instead.`),this.addEffect_Fade(h,0,1,0),Z.VetoUtils.recordVeto("AnimationFallback",{EffectId:e.effectId,qosVeto:"AnimationFallback",isIntentional:!0})}if(e.rewind&&e.numRepeats!==b.RepeatUntilEnd){if(!this.m_visTrackTable[i.Id])return;let r=J.getRepeatsOffs(a,s.Duration,e.numRepeats);e.rewindChildDelay>=0&&(r+=e.rewindChildDelay),o?this.m_visTrackTable[i.Id].becomesInvisibleAt(t,J.getRepeatsClick(n,e.numRepeats),r):this.m_visTrackTable[i.Id].becomesVisibleAt(t,J.getRepeatsClick(n,e.numRepeats),r)}}addEffect_Appear(e){const t=this.m_visTrackTable[e.animObject.Id];t?e.isEntrance?t.becomesVisibleAt(e.timelineId,e.click,e.offs+e.dur.Duration):t.becomesInvisibleAt(e.timelineId,e.click,e.offs+e.dur.Duration):r.a.sendTraceTag(595657670,H.a.msoulscat_Wac_PptAnimation,q.a.Error,`AnimTranslate::addEffect_Appear: Bad visTrack for aoId ${e.animObject.Id}.`)}addEffect_Fly(e,t,i,r){const n=e.animObject.Shape.position.x,a=e.animObject.Shape.position.y,s=e.animObject.Shape.size;let o=0,l=0;if((e.direction&v.Left)>0&&(o=-(n+s.x)),(e.direction&v.Top)>0&&(l=-(a+s.y)),(e.direction&v.Right)>0&&(o=t.x-n),(e.direction&v.Bottom)>0&&(l=t.y-a),0!==o){const t=new w(h.PosX,n,c.Add),a=this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,o,e.isEntrance,e.numRepeats,0);a&&this.m_evalCreator.addTimeSmoother(a,i,r,e.timelineId,e.click,e.offs,e.dur.Duration,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}if(0!==l){const t=new w(h.PosY,a,c.Add),n=this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,l,e.isEntrance,e.numRepeats,0);n&&this.m_evalCreator.addTimeSmoother(n,i,r,e.timelineId,e.click,e.offs,e.dur.Duration,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}}addEffect_Fade(e,t,i,r){const n=new M(h.FadeMaskInfo,null,c.First),a=J.getFadeMaskInfo(g.Fade,0,e.isEntrance);this.m_evalCreator.addEvaluatorConstantObjectBidir(e.animObject.Id,e.timelineId,n,e.click,e.offs,e.dur.Duration,a,e.isEntrance,e.numRepeats,t),e.animObject.registerAnimAttribute(n,!1);const s=new w(h.FadeMaskProgress,1,c.First);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,s,e.click,e.offs,e.dur.Duration,i,r,e.isEntrance,e.numRepeats,t),e.animObject.registerAnimAttribute(s,!1)}addEffect_ComplexClip(e){const t=new M(h.FadeMaskInfo,null,c.First),i=J.getFadeMaskInfo(e.effectId,e.direction,e.isEntrance);this.m_evalCreator.addEvaluatorConstantObjectBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,i,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1);const r=new w(h.FadeMaskProgress,1,c.First);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,r,e.click,e.offs,e.dur.Duration,1,0,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(r,!1)}addEffect_FlashOnce(e){const t=new w(h.Visible,1,c.Mult),i=this.m_visTrackTable[e.animObject.Id];null!==i?(e.isEntrance?i.becomesVisibleAt(e.timelineId,e.click,e.offs):this.m_evalCreator.addEvaluatorConstantDuration(e.timelineId,t,e.click,e.offs,e.dur.Duration/2,0,e.numRepeats,e.dur.Duration/2),e.numRepeats!==b.RepeatUntilEnd&&i.becomesInvisibleAt(e.timelineId,J.getRepeatsClick(e.click,e.numRepeats),J.getRepeatsOffs(e.offs,e.dur.Duration,e.numRepeats)),e.animObject.registerAnimAttribute(t,!1)):r.a.sendTraceTag(595656966,H.a.msoulscat_Wac_PptAnimation,q.a.Error,`AnimTranslate::addEffect_FlashOnce: Bad visTrack for aoId ${e.animObject.Id} at AddEffect_FlashOnce.`)}addEffect_Peek(e){let t,i=0;const r=e.animObject.Shape.size;e.animObject.registerAnimAttribute(new w(h.PosX,e.animObject.Shape.position.x,c.BaselineOnly),!1),e.animObject.registerAnimAttribute(new w(h.PosY,e.animObject.Shape.position.y,c.BaselineOnly),!1);const n=e.isEntrance?J.flipDirection(e.direction):e.direction;switch(e.direction){case v.Top:t=h.PosY,i=-r.y;break;case v.Right:t=h.PosX,i=r.x;break;case v.Left:t=h.PosX,i=-r.x;break;case v.Bottom:default:t=h.PosY,i=r.y}const a=new M(h.FadeMaskInfo,null,c.First),s=J.getFadeMaskInfo(g.Wipe,n,e.isEntrance);this.m_evalCreator.addEvaluatorConstantObjectBidir(e.animObject.Id,e.timelineId,a,e.click,e.offs,e.dur.Duration,s,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(a,!1);const o=new w(h.FadeMaskProgress,1,c.First);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,o,e.click,e.offs,e.dur.Duration,1,0,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(o,!1);const l=new w(t,-i,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,l,e.click,e.offs,e.dur.Duration,0,i,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(l,!1)}static flipDirection(e){switch(e){case v.Bottom:return v.Top;case v.Left:return v.Right;case v.Right:return v.Left;case v.Top:default:return v.Bottom}}addEffect_Stretch(e){const t=e.animObject.Shape.position.x,i=e.animObject.Shape.position.y,r=e.animObject.Shape.size;let n=0,a=0,s=1,o=1;switch(e.direction){case v.Stretch_FromLeft:s=0,n=-r.x/2;break;case v.Stretch_FromRight:s=0,n=r.x/2;break;case v.Stretch_FromTop:o=0,a=-r.y/2;break;case v.Stretch_FromBottom:o=0,a=r.y/2;break;case v.Stretch_Across:default:s=0}if(1!==s){const t=new w(h.ScaleW,1,c.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,s,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}if(1!==o){const t=new w(h.ScaleH,1,c.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,o,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}if(0!==n){const i=new w(h.PosX,t,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,0,n,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1)}if(0!==a){const t=new w(h.PosY,i,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,a,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}}addEffect_Swivel(e,t){let i=1,r=1;switch(e.direction){case v.Swivel_Vertical:r=0;break;case v.Swivel_Horizontal:default:i=0}if(1!==i){const t=new w(h.ScaleW,1,c.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,i,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}if(1!==r){const t=new w(h.ScaleH,1,c.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,r,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}t&&this.addEffect_Fade(e,0,1,0)}addEffect_Wipe(e){const t=new M(h.FadeMaskInfo,null,c.First),i=J.getFadeMaskInfo(e.effectId,e.direction,e.isEntrance);this.m_evalCreator.addEvaluatorConstantObjectBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,i,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1);const r=new w(h.FadeMaskProgress,1,c.First);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,r,e.click,e.offs,e.dur.Duration,1,0,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(r,!1)}addEffect_Draw(e,t){t&&"drawprogressallatonce"===t[0].name.toLowerCase()?e.direction=1:e.direction=0,this.addEffect_Wipe(e)}addEffect_Zoom(e,t){const i=e.animObject.Shape.position.x,r=e.animObject.Shape.position.y,n=e.animObject.Shape.size;let a=0,s=0,o=0;switch(e.direction){case v.Zoom_InFromCenter:s=b.Zoom_InFromCenterFactor*(t.x-n.x)-i,o=b.Zoom_InFromCenterFactor*(t.y-n.y)-r;break;case v.Zoom_InSlightly:a=b.Zoom_InSlightlyScaleInit;break;case v.Zoom_Out:a=b.Zoom_OutScaleInit;break;case v.Zoom_OutFromBottom:a=b.Zoom_OutFromBottomScaleFactor,o=t.y-r;break;case v.Zoom_OutSlightly:a=b.Zoom_OutSlightlyScaleInit;break;case v.Zoom_In:}if(0!==s){const t=new w(h.PosX,i,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,s,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}if(0!==o){const t=new w(h.PosY,r,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,o,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}const l=new w(h.ScaleW,1,c.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,l,e.click,e.offs,e.dur.Duration,1,a,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(l,!1);const d=new w(h.ScaleH,1,c.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,d,e.click,e.offs,e.dur.Duration,1,a,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(d,!1)}static translatePPTZoomFlags(e,t){return t?0!=(e&v.Ppt_ZoomIn)?0!=(e&v.Ppt_ZoomCenter)?v.Zoom_InFromCenter:0!=(e&v.Ppt_ZoomSlightly)?v.Zoom_InSlightly:v.Zoom_In:0!=(e&v.Bottom)?v.Zoom_OutFromBottom:0!=(e&v.Ppt_ZoomSlightly)?v.Zoom_OutSlightly:v.Zoom_Out:0!=(e&v.Ppt_ZoomOut)?0!=(e&v.Ppt_ZoomCenter)?v.Zoom_InFromCenter:0!=(e&v.Ppt_ZoomSlightly)?v.Zoom_InSlightly:v.Zoom_In:0!=(e&v.Bottom)?v.Zoom_OutFromBottom:0!=(e&v.Ppt_ZoomSlightly)?v.Zoom_OutSlightly:v.Zoom_Out}addEffect_Boomerang(e){const t=e.animObject.Shape.position.x,i=e.animObject.Shape.position.y,r=new w(h.PosX,t,c.Add),n=[];n.push({Offs:e.offs,Dur:e.dur.Duration/2,BaseVal:0,OffsVal:b.Boomerang_XOffs,SegOffs:e.dur.Duration/2}),n.push({Offs:e.offs,Dur:e.dur.Duration,BaseVal:0,OffsVal:0,SegOffs:0}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,r,e.click,e.isEntrance,e.numRepeats,n),e.animObject.registerAnimAttribute(r,!1);const a=new w(h.PosY,i,c.Add),s=[];s.push({Offs:e.offs,Dur:e.dur.Duration/2,BaseVal:b.Boomerang_YOffs2,OffsVal:b.Boomerang_YOffs1,SegOffs:e.dur.Duration/2}),s.push({Offs:e.offs+e.dur.Duration/2,Dur:e.dur.Duration/2,BaseVal:0,OffsVal:b.Boomerang_YOffs2,SegOffs:e.dur.Duration/2}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,a,e.click,e.isEntrance,e.numRepeats,s),e.animObject.registerAnimAttribute(a,!1);const o=new w(h.Rotate,0,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,o,e.click,e.offs,e.dur.Duration/2,0,b.BoomerangRot,e.isEntrance,e.numRepeats,e.dur.Duration/2),e.animObject.registerAnimAttribute(o,!1);const l=new w(h.ScaleW,1,c.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,l,e.click,e.offs,e.dur.Duration,1,0,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(l,!1),e.dur=Y.fromDuration(e.dur.Duration/2),this.addEffect_Fade(e,e.dur.Duration/2,1,0)}addEffect_Spinner(e){this.addEffect_Fade(e,0,1,0);const t=new w(h.ScaleW,1,c.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,b.Spinner_ScaleInit,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1);const i=new w(h.ScaleH,1,c.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,1,b.Spinner_ScaleInit,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1);const r=new w(h.Rotate,0,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,r,e.click,e.offs,e.dur.Duration,0,b.Spinner_Rotations,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(r,!1)}addEffect_ExpandCompress(e,t){this.addEffect_Fade(e,0,1,0);const i=new w(h.ScaleW,1,c.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,1,t,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1)}addEffect_Zip(e,t){const i=e.animObject.Shape.position.x,r=e.animObject.Shape.position.y,n=e.animObject.Shape.size,a=.5*(t.x-n.x)-i,s=(t.y-n.y)*b.Zip_YOffs_Ratio-r,o=b.Zip_Midscale,l=b.Zip_Midscale;e.animObject.registerAnimAttribute(new w(h.PosX,e.animObject.Shape.position.x,c.BaselineOnly),!1);const d=new w(h.PosX,0,c.Add),u=[];u.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:a,OffsVal:a,SegOffs:.5*e.dur.Duration}),u.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:0,OffsVal:a,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,d,e.click,e.isEntrance,e.numRepeats,u),e.animObject.registerAnimAttribute(d,!1),e.animObject.registerAnimAttribute(new w(h.PosY,e.animObject.Shape.position.y,c.BaselineOnly),!1);const f=new w(h.PosY,0,c.Add),m=[];m.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:s,OffsVal:s,SegOffs:.5*e.dur.Duration}),m.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:0,OffsVal:s,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,f,e.click,e.isEntrance,e.numRepeats,m),e.animObject.registerAnimAttribute(f,!1);const p=new w(h.ScaleW,1,c.Mult),g=[];g.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:o,OffsVal:1,SegOffs:.5*e.dur.Duration}),g.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:o,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,p,e.click,e.isEntrance,e.numRepeats,g),e.animObject.registerAnimAttribute(p,!1);const _=new w(h.ScaleH,1,c.Mult),v=[];v.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:l,OffsVal:1,SegOffs:.5*e.dur.Duration}),v.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:l,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,_,e.click,e.isEntrance,e.numRepeats,v),e.animObject.registerAnimAttribute(_,!1),e.dur=Y.fromDuration(e.dur.Duration/2),this.addEffect_Fade(e,e.dur.Duration/2,1,0)}addEffect_ArcUp(e,t){this.addEffect_Fade(e,0,1,0),e.direction=v.Zoom_OutSlightly,this.addEffect_Zoom(e,{x:0,y:0}),this.translateMotionPathEffect(t,e.timelineId,e.animObject,e.click,e.click,e.dur.Duration)}addEffect_FadedZoom(e,t){this.addEffect_Fade(e,0,1,0),this.addEffect_Zoom(e,t)}addEffect_Glide(e){this.addEffect_Fade(e,0,1,0);const t=new w(h.ScaleW,1,c.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,0,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1),e.animObject.registerAnimAttribute(new w(h.PosX,e.animObject.Shape.position.x,c.BaselineOnly),!1);const i=new w(h.PosX,0,c.Add),r=e.animObject.Shape.size.x;this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,0,-r/2+b.Glide_XOffs,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1)}addEffect_Flip(e,t){e.animObject.registerAnimAttribute(new w(h.PosY,e.animObject.Shape.position.y,c.BaselineOnly),!1);const i=new w(h.PosY,0,c.Add),r=e.isEntrance?-t.y:t.y;this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,0,r,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1);const n=new w(h.ScaleW,1,c.Mult),a=[];a.push({Offs:e.offs,Dur:1/4*e.dur.Duration,BaseVal:0,OffsVal:1,SegOffs:3/4*e.dur.Duration}),a.push({Offs:e.offs+1/4*e.dur.Duration,Dur:1/4*e.dur.Duration,BaseVal:1,OffsVal:0,SegOffs:3/4*e.dur.Duration}),a.push({Offs:e.offs+.5*e.dur.Duration,Dur:1/4*e.dur.Duration,BaseVal:0,OffsVal:1,SegOffs:3/4*e.dur.Duration}),a.push({Offs:e.offs+3/4*e.dur.Duration,Dur:1/4*e.dur.Duration,BaseVal:1,OffsVal:0,SegOffs:3/4*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,n,e.click,e.isEntrance,e.numRepeats,a),e.animObject.registerAnimAttribute(n,!1);const s=new w(h.Rotate,0,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,s,e.click,e.offs,e.dur.Duration,0,b.Flip_Rotations,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(s,!1)}addEffect_Fold(e,t,i,r){this.addEffect_ExpandCompress(e,b.CompressWidthFactor),e.direction=v.Bottom,e.animObject.registerAnimAttribute(new w(h.PosX,e.animObject.Shape.position.x,c.BaselineOnly),!1),e.animObject.registerAnimAttribute(new w(h.PosY,e.animObject.Shape.position.y,c.BaselineOnly),!1),this.addEffect_Fly(e,t,i,r);const n=new w(h.ScaleH,1,c.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,n,e.click,e.offs,e.dur.Duration,1,.5,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(n,!1)}addEffect_Credits(e,t){const i=e.animObject.Shape.position.y,n=new w(h.PosY,i,c.Add),a=this.m_visTrackTable[e.animObject.Id];null!=a?(e.isEntrance?(a.becomesVisibleAt(e.timelineId,e.click,e.offs),this.m_evalCreator.addEvaluatorLinear(e.timelineId,n,e.click,e.offs,e.dur.Duration,t,-t,e.numRepeats,0)):(a.becomesVisibleAt(e.timelineId,e.click,e.offs),this.m_evalCreator.addEvaluatorLinear(e.timelineId,n,e.click,e.offs,e.dur.Duration,-t,t,e.numRepeats,0)),e.numRepeats!==b.RepeatUntilEnd&&a.becomesInvisibleAt(e.timelineId,J.getRepeatsClick(e.click,e.numRepeats),J.getRepeatsOffs(e.offs,e.dur.Duration,e.numRepeats)),e.animObject.registerAnimAttribute(n,!1)):r.a.sendTraceTag(595654243,H.a.msoulscat_Wac_PptAnimation,q.a.Error,"AnimTranslate::addEffect_Credits: o visibility track for AO.")}addEffect_EaseIn(e){const t=e.animObject.Shape.size.x;if(e.isEntrance)return e.direction=v.Left,void this.addEffect_Peek(e);e.animObject.registerAnimAttribute(new w(h.PosX,e.animObject.Shape.position.x,c.BaselineOnly),!1),this.addEffect_Fade(e,0,1,0);const i=new w(h.PosX,0,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,0,-t/2,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1)}addEffect_AscendDescend(e){this.addEffect_Fade(e,0,1,0),e.animObject.registerAnimAttribute(new w(h.PosY,e.animObject.Shape.position.y,c.BaselineOnly),!1);const t=e.effectId===g.Ascend?b.Ascend_Offs:b.Descend_Offs,i=new w(h.PosY,0,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,0,t,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1)}addEffect_Float(e){const t=e.animObject.Shape.position.x,i=e.animObject.Shape.position.y,r=new w(h.PosX,t,c.Add),n=[];n.push({Offs:e.offs,Dur:e.dur.Duration/2,BaseVal:b.Float_XOffs2,OffsVal:b.Float_XOffs1,SegOffs:e.dur.Duration/2}),n.push({Offs:e.offs+e.dur.Duration/2,Dur:e.dur.Duration/2,BaseVal:0,OffsVal:b.Float_XOffs2,SegOffs:e.dur.Duration/2}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,r,e.click,e.isEntrance,e.numRepeats,n),e.animObject.registerAnimAttribute(r,!1);const a=new w(h.PosY,i,c.Add),s=[];s.push({Offs:e.offs,Dur:e.dur.Duration/2,BaseVal:b.Float_YOffs2,OffsVal:b.Float_YOffs1,SegOffs:e.dur.Duration/2}),s.push({Offs:e.offs+e.dur.Duration/2,Dur:e.dur.Duration/2,BaseVal:0,OffsVal:b.Float_YOffs2,SegOffs:e.dur.Duration/2}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,a,e.click,e.isEntrance,e.numRepeats,s),e.animObject.registerAnimAttribute(a,!1);const o=new w(h.Rotate,0,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,o,e.click,e.offs,e.dur.Duration/2,0,b.FloatRot,e.isEntrance,e.numRepeats,e.dur.Duration/2),e.animObject.registerAnimAttribute(o,!1),e.dur=Y.fromDuration(e.dur.Duration/2),this.addEffect_Fade(e,e.dur.Duration/2,1,0)}addEffect_GrowAndTurn(e){this.addEffect_Fade(e,0,1,0);const t=new w(h.ScaleW,1,c.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,1,b.GrownAndTurn_ScaleInit,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1);const i=new w(h.ScaleH,1,c.Mult);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,1,b.GrownAndTurn_ScaleInit,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1);const r=new w(h.Rotate,0,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,r,e.click,e.offs,e.dur.Duration,0,b.GrowAndTurn_Rotations,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(r,!1)}addEffect_PinWheel(e){this.addEffect_Fade(e,0,1,0),e.direction=v.Zoom_In,this.addEffect_Zoom(e,{x:0,y:0});const t=new w(h.Rotate,0,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,b.PinWheel_Rotations,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}addEffect_RiseUp(e){this.addEffect_Fade(e,0,1,0),e.animObject.registerAnimAttribute(new w(h.PosY,e.animObject.Shape.position.y,c.BaselineOnly),!1);const t=new w(h.PosY,0,c.Add),i=[];i.push({Offs:e.offs,Dur:b.RiseUp_Seg1Fraction*e.dur.Duration,BaseVal:b.RiseUp_YOffs2,OffsVal:b.RiseUp_YOffs1,SegOffs:(1-b.RiseUp_Seg1Fraction)*e.dur.Duration}),i.push({Offs:e.offs+b.RiseUp_Seg1Fraction*e.dur.Duration,Dur:e.dur.Duration*(1-b.RiseUp_Seg1Fraction),BaseVal:0,OffsVal:b.RiseUp_YOffs2,SegOffs:b.RiseUp_Seg1Fraction*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,t,e.click,e.isEntrance,e.numRepeats,i),e.animObject.registerAnimAttribute(t,!1)}addEffect_Swish(e,t){if(e.animObject.registerAnimAttribute(new w(h.PosY,e.animObject.Shape.position.y,c.BaselineOnly),!1),e.isEntrance){const i=b.Swish_DropFraction,r=(1-b.Swish_DropFraction)/2,n=r,a=new w(h.PosY,0,c.Add),s=[];s.push({Offs:e.offs,Dur:i*e.dur.Duration,BaseVal:0,OffsVal:-t.y,SegOffs:(1-i)*e.dur.Duration}),s.push({Offs:e.offs+i*e.dur.Duration,Dur:e.dur.Duration*r,BaseVal:b.Swish_BounceOffs,OffsVal:0,SegOffs:(1-r)*e.dur.Duration}),s.push({Offs:e.offs+(i+r)*e.dur.Duration,Dur:e.dur.Duration*n,BaseVal:0,OffsVal:b.Swish_BounceOffs,SegOffs:(1-n)*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,a,e.click,e.isEntrance,e.numRepeats,s),e.animObject.registerAnimAttribute(a,!1);const o=new w(h.Rotate,0,c.Add),l=[];l.push({Offs:e.offs,Dur:i*e.dur.Duration,BaseVal:b.Swish_Theta,OffsVal:b.Swish_Theta,SegOffs:(1-i)*e.dur.Duration}),l.push({Offs:e.offs+i*e.dur.Duration,Dur:e.dur.Duration*r,BaseVal:-b.Swish_Theta,OffsVal:b.Swish_Theta,SegOffs:(1-r)*e.dur.Duration}),l.push({Offs:e.offs+(i+r)*e.dur.Duration,Dur:e.dur.Duration*n,BaseVal:0,OffsVal:-b.Swish_Theta,SegOffs:(1-n)*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,o,e.click,e.isEntrance,e.numRepeats,l),e.animObject.registerAnimAttribute(o,!1)}else{const i=new w(h.Rotate,0,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,i,e.click,e.offs,e.dur.Duration,0,-b.Swish_Theta,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(i,!1);const r=new w(h.PosY,0,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,r,e.click,e.offs,e.dur.Duration,0,t.y,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(r,!1)}}addEffect_Thinline(e){e.animObject.registerAnimAttribute(new w(h.PosX,e.animObject.Shape.position.x,c.BaselineOnly),!1);const t=new w(h.PosX,0,c.Add),i=[];i.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:0,OffsVal:b.ThinLine_XOffs,SegOffs:.5*e.dur.Duration}),i.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:0,OffsVal:0,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,t,e.click,e.isEntrance,e.numRepeats,i),e.animObject.registerAnimAttribute(t,!1);const r=new w(h.ScaleW,1,c.Mult),n=[];n.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:b.ThinLine_WInit,OffsVal:b.ThinLine_WInit,SegOffs:.5*e.dur.Duration}),n.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:b.ThinLine_WInit,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,r,e.click,e.isEntrance,e.numRepeats,n),e.animObject.registerAnimAttribute(r,!1);const a=new w(h.ScaleH,1,c.Mult),s=[];s.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:b.ThinLine_HInit,OffsVal:b.ThinLine_HInit,SegOffs:.5*e.dur.Duration}),s.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:b.ThinLine_HInit,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,a,e.click,e.isEntrance,e.numRepeats,s),e.animObject.registerAnimAttribute(a,!1)}addEffect_Unfold(e){this.addEffect_Fade(e,0,1,0),e.animObject.registerAnimAttribute(new w(h.PosX,e.animObject.Shape.position.x,c.BaselineOnly),!1);const t=new w(h.PosX,0,c.Add);this.m_evalCreator.addEvaluatorVisLinearBidir(e.animObject.Id,e.timelineId,t,e.click,e.offs,e.dur.Duration,0,b.Unfold_XOffs,e.isEntrance,e.numRepeats,0),e.animObject.registerAnimAttribute(t,!1)}addEffect_Whip(e){e.animObject.registerAnimAttribute(new w(h.PosX,e.animObject.Shape.position.x,c.BaselineOnly),!1);const t=new w(h.PosX,0,c.Add),i=[];i.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:b.Whip_XOffs,OffsVal:b.Whip_XOffs,SegOffs:.5*e.dur.Duration}),i.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:0,OffsVal:b.Whip_XOffs,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,t,e.click,e.isEntrance,e.numRepeats,i),e.animObject.registerAnimAttribute(t,!1);const r=new w(h.ScaleW,1,c.Mult),n=[];n.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:b.Whip_MidScale,OffsVal:0,SegOffs:.5*e.dur.Duration}),n.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:b.Whip_MidScale,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,r,e.click,e.isEntrance,e.numRepeats,n),e.animObject.registerAnimAttribute(r,!1);const a=new w(h.ScaleH,1,c.Mult),s=[];s.push({Offs:e.offs,Dur:.5*e.dur.Duration,BaseVal:b.Whip_MidScale,OffsVal:0,SegOffs:.5*e.dur.Duration}),s.push({Offs:e.offs+.5*e.dur.Duration,Dur:.5*e.dur.Duration,BaseVal:1,OffsVal:b.Whip_MidScale,SegOffs:.5*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,a,e.click,e.isEntrance,e.numRepeats,s),e.animObject.registerAnimAttribute(a,!1),e.dur=Y.fromDuration(e.dur.Duration/2),this.addEffect_Fade(e,e.dur.Duration/2,1,0)}addEffect_Sling(e,t){const i=e.animObject.Shape.position.x,r=-t.x-i,n=-i+t.x-b.Sling_XMid_Offs,a=n/2;e.animObject.registerAnimAttribute(new w(h.PosX,e.animObject.Shape.position.x,c.BaselineOnly),!1);const s=new w(h.PosX,0,c.Add),o=[];o.push({Offs:e.offs,Dur:1/3*e.dur.Duration,BaseVal:n,OffsVal:r,SegOffs:2/3*e.dur.Duration}),o.push({Offs:e.offs+1/3*e.dur.Duration,Dur:1/3*e.dur.Duration,BaseVal:a,OffsVal:n,SegOffs:2/3*e.dur.Duration}),o.push({Offs:e.offs+2/3*e.dur.Duration,Dur:1/3*e.dur.Duration,BaseVal:0,OffsVal:a,SegOffs:2/3*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,s,e.click,e.isEntrance,e.numRepeats,o),e.animObject.registerAnimAttribute(s,!1);const l=new w(h.Rotate,0,c.Add),d=[];d.push({Offs:e.offs,Dur:2/3*e.dur.Duration,BaseVal:b.Sling_Rot,OffsVal:b.Sling_Rot,SegOffs:1/3*e.dur.Duration}),d.push({Offs:e.offs+2/3*e.dur.Duration,Dur:1/3*e.dur.Duration,BaseVal:0,OffsVal:b.Sling_Rot,SegOffs:2/3*e.dur.Duration}),this.m_evalCreator.addEvaluatorsForSegmentList(e.animObject.Id,e.timelineId,l,e.click,e.isEntrance,e.numRepeats,d),e.animObject.registerAnimAttribute(l,!1),this.addEffect_Fade(e,0,1,0)}translateEmphasisEffect(e,t,i,n,s,o){const l={animObject:i,timelineId:t,click:n,offs:s,dur:o,numRepeats:e.numRepeats,rewind:e.rewind,autoReverse:e.autoReverse,effectId:e.effectId};switch(e.effectId){case p.GrowShrink:this.addEmphEffect_GrowShrink(l,e.rewindChildDelay,e.scaleByXPercent,e.scaleByYPercent,e.direction);break;case p.Spin:this.addEffect_Spin(l,e.rewindChildDelay,e.rotAngDegrees);break;case p.Transparency:this.addEmphEffect_Transparency(l,e.transparencyAmountPercent);break;case p.Shimmer:this.addEmphEffect_Shimmer(l);break;case p.Blink:this.addEmphEffect_Blink(l);break;case p.FlashBulb:this.addEmphEffect_FlashBulb(l);break;case p.Wave:this.addEmphEffect_Wave(l);break;case p.Embedded1:case p.Embedded2:case p.Embedded3:case p.Embedded4:case p.Embedded5:case p.Embedded6:case p.Embedded7:case p.Embedded8:case p.Embedded9:case p.Embedded10:case p.Embedded11:case p.Embedded12:case p.Embedded13:case p.Embedded14:case p.Embedded15:case p.Embedded16:case p.Embedded17:case p.Embedded18:if(a.Settings.readBooleanOrDefault("enableAnimations3D",!1)){this.addEmphEffect_EmbeddedAnimation(l);break}default:r.a.sendTraceTag(595682205,H.a.msoulscat_Wac_PptAnimation,q.a.Info,`AnimTranslate::translateEmphasisEffect: Unknown or NYI emphasis effect ID:${e.effectId}. ignored.`),Z.VetoUtils.recordVeto("AnimationFallback",{EffectId:e.effectId,qosVeto:"AnimationFallback",isIntentional:!0})}}addEmphEffect_EmbeddedAnimation(e){const t=e.autoReverse?e.dur.Duration:0,i=e.dur.Duration,r=e.effectId-p.Embedded1,n=new w(h.EmbeddedAnimId,r,c.First);this.m_evalCreator.addEvaluatorConstantDuration(e.timelineId,n,e.click,e.offs,i,r,e.numRepeats,t),e.rewind||this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,n,e.click,e.offs+i,r),e.animObject.registerAnimAttribute(n,!1);const a=new w(h.EmbeddedAnimProgress,0,c.First);this.m_evalCreator.addEvaluatorLinear(e.timelineId,a,e.click,e.offs,i,0,1,e.numRepeats,t),e.autoReverse?this.m_evalCreator.addEvaluatorLinear(e.timelineId,a,e.click,e.offs+i,i,1,0,e.numRepeats,t):e.rewind||this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,a,e.click,e.offs+i,1),e.animObject.registerAnimAttribute(a,!1);const s=new w(h.Is3DRunning,0,c.Add);this.m_evalCreator.addEvaluatorLinear(e.timelineId,s,e.click,e.offs,i+t,1,1,e.numRepeats,0),e.animObject.registerAnimAttribute(s,!1)}addEmphEffect_GrowShrink(e,t,i,r,n){const a=i/100,s=r/100,o=new w(h.ScaleW,1,c.Mult),l=new w(h.ScaleH,1,c.Mult);let d;if(d=e.dur.FUntilSlide||e.dur.FUntilClick?b.GrowShrink_DefaultDuration:e.dur.Duration,1===n&&(d=1),e.dur.FUntilSlide)this.m_evalCreator.addEvaluatorLinear(e.timelineId,o,e.click,e.offs,d,1,a,e.numRepeats,0),this.m_evalCreator.addEvaluatorLinear(e.timelineId,l,e.click,e.offs,d,1,s,e.numRepeats,0),this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,o,e.click,e.offs+d,a),this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,l,e.click,e.offs+d,s);else if(e.dur.FUntilClick)this.m_evalCreator.addEvaluatorLinear(e.timelineId,o,e.click,e.offs,d,1,a,e.numRepeats,0),this.m_evalCreator.addEvaluatorLinear(e.timelineId,l,e.click,e.offs,d,1,s,e.numRepeats,0),this.m_evalCreator.addEvaluatorConstantSpan(e.timelineId,o,e.click,e.offs+d,e.click+1,0,a,0,0),this.m_evalCreator.addEvaluatorConstantSpan(e.timelineId,l,e.click,e.offs+d,e.click+1,0,s,0,0);else{const i=e.autoReverse?d:0;this.m_evalCreator.addEvaluatorLinear(e.timelineId,o,e.click,e.offs,d,1,a,e.numRepeats,i),this.m_evalCreator.addEvaluatorLinear(e.timelineId,l,e.click,e.offs,d,1,s,e.numRepeats,i),e.autoReverse?(this.m_evalCreator.addEvaluatorLinear(e.timelineId,o,e.click,e.offs+d,d,a,1,e.numRepeats,i),this.m_evalCreator.addEvaluatorLinear(e.timelineId,l,e.click,e.offs+d,d,s,1,e.numRepeats,i)):e.rewind?t>0&&(this.m_evalCreator.addEvaluatorConstantDuration(e.timelineId,o,e.click,e.offs+d,t,a,e.numRepeats,i),this.m_evalCreator.addEvaluatorConstantDuration(e.timelineId,l,e.click,e.offs+d,t,s,e.numRepeats,i)):(this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,o,e.click,e.offs+d,a),this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,l,e.click,e.offs+d,s))}e.animObject.registerAnimAttribute(o,!1),e.animObject.registerAnimAttribute(l,!1)}addEffect_Spin(e,t,i){let r=new w(h.Rotate,0,c.Add),n=i*Math.PI/180,a=e.autoReverse?e.dur.Duration:0;this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs,e.dur.Duration,0,n,e.numRepeats,a),e.autoReverse?this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs+e.dur.Duration,e.dur.Duration,n,0,e.numRepeats,a):e.rewind?t>0&&this.m_evalCreator.addEvaluatorConstantDuration(e.timelineId,r,e.click,e.offs+e.dur.Duration,t,n,e.numRepeats,0):this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,r,e.click,e.offs+e.dur.Duration,n),e.animObject.registerAnimAttribute(r,!1)}addEmphEffect_Transparency(e,t){const i=new M(h.FadeMaskInfo,null,c.First),r=J.getFadeMaskInfo(g.Fade,0,!0),n=new w(h.FadeMaskProgress,1,c.First),a=(100-t)/100;e.dur.FUntilSlide?(this.m_evalCreator.addEvaluatorConstantObjectAfter(e.timelineId,i,e.click,e.offs,r),this.m_evalCreator.addEvaluatorConstantAfter(e.timelineId,n,e.click,e.offs,a)):e.dur.FUntilClick?(this.m_evalCreator.addEvaluatorConstantObjectSpan(e.timelineId,i,e.click,e.offs,e.click+1,0,r,e.numRepeats,0),this.m_evalCreator.addEvaluatorConstantSpan(e.timelineId,n,e.click,e.offs,e.click+1,0,a,e.numRepeats,0)):(this.m_evalCreator.addEvaluatorConstantObjectSpan(e.timelineId,i,e.click,e.offs,e.click,e.offs+e.dur.Duration,r,e.numRepeats,0),this.m_evalCreator.addEvaluatorConstantSpan(e.timelineId,n,e.click,e.offs,e.click,e.offs+e.dur.Duration,a,e.numRepeats,0)),e.animObject.registerAnimAttribute(i,!1),e.animObject.registerAnimAttribute(n,!1)}addEmphEffect_Shimmer(e){const t=e.dur.Duration/2,i=new w(h.Rotate,0,c.Add);this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs,t,0,b.Shimmer_Theta,e.numRepeats,t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs+t,t,b.Shimmer_Theta,0,e.numRepeats,t),e.animObject.registerAnimAttribute(i,!1)}addEmphEffect_Blink(e){const t={animObject:e.animObject,timelineId:e.timelineId,click:e.click,offs:e.offs,dur:Y.fromDuration(e.dur.Duration/2),isEntrance:!0,numRepeats:e.numRepeats,direction:v.Top,effectId:e.effectId};this.addEffect_Fade(t,e.dur.Duration/2,b.Blink_Alpha,b.Blink_Alpha)}addEmphEffect_FlashBulb(e){const t=e.dur.Duration/2,i=new w(h.ScaleW,1,c.Mult),r=new w(h.ScaleH,1,c.Mult);this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs,t,1,b.FlashBulb_ScaleOffs,e.numRepeats,t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs,t,1,b.FlashBulb_ScaleOffs,e.numRepeats,t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs+t,t,b.FlashBulb_ScaleOffs,1,e.numRepeats,t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,r,e.click,e.offs+t,t,b.FlashBulb_ScaleOffs,1,e.numRepeats,t),e.animObject.registerAnimAttribute(i,!1),e.animObject.registerAnimAttribute(r,!1);const n=new w(h.Alpha,1,c.Mult);this.m_evalCreator.addEvaluatorLinear(e.timelineId,n,e.click,e.offs,e.dur.Duration,b.FlashBulb_Alpha,b.FlashBulb_Alpha,e.numRepeats,0),e.animObject.registerAnimAttribute(n,!1)}addEmphEffect_Wave(e){const t=e.dur.Duration/3,i=new w(h.Rotate,0,c.Add);this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs,t,0,b.Wave_Theta,e.numRepeats,e.dur.Duration-t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs+t,t,b.Wave_Theta,-b.Wave_Theta,e.numRepeats,e.dur.Duration-t),this.m_evalCreator.addEvaluatorLinear(e.timelineId,i,e.click,e.offs+2*t,t,-b.Wave_Theta,0,e.numRepeats,e.dur.Duration-t),e.animObject.registerAnimAttribute(i,!1);const r=e.dur.Duration/2;e.animObject.registerAnimAttribute(new w(h.PosY,e.animObject.Shape.position.y,c.BaselineOnly),!1);const n=new w(h.PosY,0,c.Add);this.m_evalCreator.addEvaluatorLinear(e.timelineId,n,e.click,e.offs,r,0,b.Wave_YOffs,e.numRepeats,e.dur.Duration-r),this.m_evalCreator.addEvaluatorLinear(e.timelineId,n,e.click,e.offs+r,r,b.Wave_YOffs,0,e.numRepeats,e.dur.Duration-r),e.animObject.registerAnimAttribute(n,!1)}static getFadeMaskInfo(e,t,i){for(let r of S.EffectMap)if(r.FxId===e&&r.Dir===t)return{preset:r.Preset,param:r.Param,flags:i?r.EntFlags:r.ExitFlags};return{preset:6}}addInitialVisibilityMarker(e,t){let i=this.m_visTrackTable[e];null!=i?0===i.Length&&i.becomesVisibleAt(t,0,0):r.a.sendTraceTag(595682206,H.a.msoulscat_Wac_PptAnimation,q.a.Error,`AnimTranslate::addInitialVisibilityMarker: Bad visTrack for aoId ${e} at AddInitialVisibilityMarker.`)}static getRepeatsClick(e,t){return t===b.RepeatUntilEnd?b.Undefined:t===b.RepeatUntilClick?e+1:e}static getRepeatsOffs(e,t,i){return i===b.RepeatUntilEnd?b.RepeatForever:i===b.RepeatUntilClick?0:e+(i+1)*t}translateMotionPathEffect(e,t,i,n,a,s){if(!e.motionPath)return;i.registerAnimAttribute(new w(h.PosX,i.Shape.position.x,c.BaselineOnly),!1),i.registerAnimAttribute(new w(h.PosY,i.Shape.position.y,c.BaselineOnly),!1);let o=e.motionPath.commandList;e.motionPath.fReversed&&(o=J.generateReversedMotionPath(o));const l=new Array(o.length);let d=0;for(let e=0;e<o.length;e+=1){const t=J.calcMPSegmentLength(o,e);l[e]=t,d+=t}if(0===d)return void r.a.sendTraceTag(595644578,H.a.msoulscat_Wac_PptAnimation,q.a.Info,"Motion path had zero length, ignored.");const u=this.m_mpRestEvalHelperTable[i.Id];if(null!==u)if(u.push(J.createRestEvalHelperStartEntry(t,n,a)),this.translateMPList(e,i,t,o,l,d,!1,0,n,a,s,e.autoReverse,e.numRepeats,a),e.autoReverse){const r=J.generateReversedMotionPath(o);this.translateMPList(e,i,t,r,l,d,!0,s,n,a,s,e.autoReverse,e.numRepeats,a+s);const h=J.getRepeatsOffs(a,2*s,e.numRepeats),c=J.createRestEvalHelperEndEntry(r,t,J.getRepeatsClick(n,e.numRepeats),h);u.push(c)}else{const i=J.getRepeatsOffs(a,s,e.numRepeats);if(e.rewind){if(e.rewindChildDelay>0){const r=J.createRestEvalHelperEndEntry(o,t,J.getRepeatsClick(n,e.numRepeats),i);u.push(r);const a=J.createRestEvalHelperStartEntry(t,J.getRepeatsClick(n,e.numRepeats),i+e.rewindChildDelay);u.push(a)}}else{const r=J.createRestEvalHelperEndEntry(o,t,J.getRepeatsClick(n,e.numRepeats),i);u.push(r)}}else r.a.sendTraceTag(595644579,H.a.msoulscat_Wac_PptAnimation,q.a.Error,"No rest eval list exists for this anim object.")}static generateReversedMotionPath(e){const t=[];if(null==e||0===e.length)return t;let i=e[e.length-1].end,n={type:y.MoveTo,end:i};t.push(n);for(let a=e.length-1;a>0;a-=1){switch(i=e[a-1].end,e[a].type){case y.MoveTo:n={type:y.MoveTo,end:i};break;case y.LineTo:n={type:y.LineTo,end:i};break;case y.CurveTo:const t=e[a];n={type:y.CurveTo,control1:t.control2,control2:t.control1,end:i};break;default:r.a.sendTraceTag(595644608,H.a.msoulscat_Wac_PptAnimation,q.a.Info,"Unknown motion path command while reversing.")}t.push(n)}return t}static calcMPSegmentLength(e,t){if(0===t)return 0;const i=e[t-1],n=e[t];switch(n.type){case y.MoveTo:return 0;case y.LineTo:return J.calcLineSegmentLength(i.end.x,i.end.y,n.end.x,n.end.y);case y.CurveTo:const e=n;return J.calcBezierSegmentLength(i.end.x,i.end.y,e.control1.x,e.control1.y,e.control2.x,e.control2.y,e.end.x,e.end.y);default:return r.a.sendTraceTag(595644609,H.a.msoulscat_Wac_PptAnimation,q.a.Info,"Unknown motion path command type, ignoring."),0}}static calcLineSegmentLength(e,t,i,r){const n=i-e,a=r-t;return Math.sqrt(n*n+a*a)}static calcBezierSegmentLength(e,t,i,r,n,a,s,o){let l,d,h=0,c=e,u=t;const f=1/b.BezierLengthEstimateDivisions;for(let m=0;m<=1;m+=f)l=G.calculateBezierCoordinate(e,i,n,s,m),d=G.calculateBezierCoordinate(t,r,a,o,m),h+=J.calcLineSegmentLength(c,u,l,d),c=l,u=d;return h}generateRestEvaluators(e){const t=this.m_mpRestEvalHelperTable[e.Id];if(null==t||0===t.length)return;const i=e.Shape.position.x,r=e.Shape.position.y,n=new w(h.PosX,i,c.Add),a=new w(h.PosY,r,c.Add);for(let e=0;e<t.length;e+=1){const i=t[e];if(!i.FStartPath)if(e===t.length-1)this.m_evalCreator.addEvaluatorConstantAfter(i.TimeLineId,n,i.Click,i.Offs-1,i.XTarget),this.m_evalCreator.addEvaluatorConstantAfter(i.TimeLineId,a,i.Click,i.Offs-1,i.YTarget);else{const r=t[e+1];this.m_evalCreator.addEvaluatorConstantSpan(i.TimeLineId,n,i.Click,i.Offs-1,r.Click,r.Offs,i.XTarget,0,0),this.m_evalCreator.addEvaluatorConstantSpan(i.TimeLineId,a,i.Click,i.Offs-1,r.Click,r.Offs,i.YTarget,0,0)}}e.registerAnimAttribute(n,!1),e.registerAnimAttribute(a,!1)}static createRestEvalHelperStartEntry(e,t,i){return new D(!0,e,t,i,0,0)}static createRestEvalHelperEndEntry(e,t,i,r){const n=e[e.length-1];return new D(!1,t,i,r,n.end.x,n.end.y)}translateMPList(e,t,i,r,n,a,s,o,l,d,h,c,u,f){const m=e.autoReverse?h:0;let p=o;for(let o=1;o<r.length;o+=1){const g=h*n[s?r.length-o:o]/a,_=h-g+(c?h:0);g>0&&this.addMPSegment(e,t,i,r,o,l,d+p,g,u,_,f,m,h),p+=g}}addMPSegment(e,t,i,n,a,s,o,l,d,u,f,m,p){if(0===a)return;const g=t.Shape.position.x,_=t.Shape.position.y;let v,b;const S=n[a-1],T=n[a];switch(T.type){case y.MoveTo:break;case y.LineTo:v=new w(h.PosX,g,c.Add);const n=this.m_evalCreator.addEvaluatorLinear(i,v,s,o,l,S.end.x,T.end.x,d,u);this.m_evalCreator.addTimeSmoother(n,e.smoothStartFactor,e.smoothEndFactor,i,s,f,p,d,m),t.registerAnimAttribute(v,!1),b=new w(h.PosY,_,c.Add);const a=this.m_evalCreator.addEvaluatorLinear(i,b,s,o,l,S.end.y,T.end.y,d,u);this.m_evalCreator.addTimeSmoother(a,e.smoothStartFactor,e.smoothEndFactor,i,s,f,p,d,m),t.registerAnimAttribute(b,!1);break;case y.CurveTo:const M=T,C=[S.end.x,M.control1.x,M.control2.x,M.end.x];v=new w(h.PosX,g,c.Add);const I=this.m_evalCreator.addEvaluatorBezier(i,v,s,o,l,C,d,u);this.m_evalCreator.addTimeSmoother(I,e.smoothStartFactor,e.smoothEndFactor,i,s,f,p,d,m),t.registerAnimAttribute(v,!1);const P=[S.end.y,M.control1.y,M.control2.y,M.end.y];b=new w(h.PosY,_,c.Add);const E=this.m_evalCreator.addEvaluatorBezier(i,b,s,o,l,P,d,u);this.m_evalCreator.addTimeSmoother(E,e.smoothStartFactor,e.smoothEndFactor,i,s,f,p,d,m),t.registerAnimAttribute(b,!1);break;default:r.a.sendTraceTag(595644610,H.a.msoulscat_Wac_PptAnimation,q.a.Info,"Unknown motion path command type, ignoring.")}}addMediaEffect_Play(e){const t=new M(h.MediaPlaybackCmd,null,c.Last);let i=e.dur.Duration>0?100:e.dur.Duration;this.m_evalCreator.addEvaluatorConstantObject(e.timelineId,t,e.click,e.offs,i,e,0,0),e.animObject.registerAnimAttribute(t,!1)}translateMediaEffect(e,t,i,r,n,a){const s={animObject:i,timelineId:t,click:r,offs:n,dur:a,effectId:e.effectId,mediaCmd:e.mediaCmd};this.addMediaEffect_Play(s)}}},,function(e,t,i){"use strict";i.d(t,"a",(function(){return ni})),i.d(t,"c",(function(){return ai})),i.d(t,"d",(function(){return si})),i.d(t,"b",(function(){return oi}));var r=i(112),n=i(8),a=i(18),s=i(11),o=i(4),l=i(2),d=i(3),h=i(23),c=i(50),u=i(31),f=i(0),m=i(5);class p{constructor(e,t,i,r,n,a){this.renderDataMap={},this.contents=e,this.location=t,this.zPosition=i,this.parentTransform=n,this.morphingGrid=r,this.shapeInterpolation=a}clearCache(){for(const e in this.renderDataMap)this.renderDataMap[e].releaseGeneratedResources()}static CreateFromItem(e,t,i,r,n,a,s){const o=f.b.FromTransforms(e.transform,a||f.b.Identity,e.animationTransform||f.b.Identity),l=o.transformVector(new f.e(1,0)),d=o.transformVector(new f.e(0,1)),h=i.transformedBounds(o),c={center:h?h.center:f.e.Zero,size:h?i.size.multiply(new f.e(l.length(),d.length())):f.e.Zero,rotation:e.transform.rotation,flipX:e.transform.scale.x<0,flipY:e.transform.scale.y<0};return new p([{item:e,includeSubtree:r,textRange:n}],c,t,void 0,a,s)}static TryCreateFromShape(e,t,i,r,n){const a=Object(s.k)(e,!1);return a?p.CreateFromItem(e,t,a,i,void 0,r,n):void 0}static TryCreateFromText(e,t,i,r){if(e.text){const n=e.text.getFullRange(),a=i||n;if(n&&a&&n.contains(a)){const i=e.text.getBoundsOfRange(a);if(i){const n=i.transformedBounds(f.d.fromScaleAndTranslation(e.transform.scale.inverse(),e.transform.preTranslation.negate()));return n?p.CreateFromItem(e,t,n,!0,a,r):void 0}}else m.a.Error(592525387,`TryCreateFromText out of range: ${i?(i.start,i.last,"]"):void 0} fullRange: ${n?(n.start,n.last,"]"):"undefined"}`)}else m.a.Error(592525386,"TryCreateFromText on Shape with no Text")}static TryCreateFromGroup(e,t,i,r){const n=Object(s.j)(e,!1,0,0,e.transform.toInverseMatrix3());return n?p.CreateFromItem(e,t,n,i,void 0,r):void 0}}class g{constructor(e=[]){this.renderDataMap={},this.keyFrames=e}clearCache(){for(let e of this.keyFrames||[])e&&e.clearCache()}}class _{constructor(){this.elements=[]}clearCache(){this.elements.forEach(e=>e.clearCache())}}var v=i(36),y=i(7),b=i(6),S=i(1),T=i(40),w=i(27);class M{constructor(e,t,i,r,n,a){this.createdItems=[],this.fallbackReasons=new Set,this.isForwards=!1,this.m_cameoViewElements=[],this.m_isDisposed=!1,this.metadata={numFallbackElement:0,numTextElement:0,numOtherElement:0,numCameoElement:0},this.m_environment=e,this.morph=new _,n.slideSizePixels.x===a.slideSizePixels.x&&n.slideSizePixels.y===a.slideSizePixels.y||o.a.sendTraceTag(591984863,l.a.msoulscat_Wac_PptSession,d.a.Warning,"MorphTransition::createMorphKeyFrame: slide size mismatch."),this.m_slideSizePixels=a.slideSizePixels;const s=new f.e(this.m_slideSizePixels.x,this.m_slideSizePixels.y).scale(S.Settings.readNumberOrDefault("hackMorphRenderSizeScale",1)),h=this.m_environment.rendererEnvironment.calculateRenderTransform(n.slideSizePixels),u=this.m_environment.rendererEnvironment.calculateRenderTransform(a.slideSizePixels),m=this.m_environment.rendererEnvironment.calculateRenderTransform(t.slideSizePixels),p=this.m_environment.rendererEnvironment.calculateRenderTransform(s),v=h.toMatrix3().multiply(p.toInverseMatrix3()),y=u.toMatrix3().multiply(p.toInverseMatrix3()),T=m.toMatrix3().multiply(p.toInverseMatrix3());for(const e of t.elements){const t=[this.createMorphKeyFrame(e.keyFrameA,n,v,T),this.createMorphKeyFrame(e.keyFrameB,a,y,T)],i=new g(t);if(i.keyFrames[0]&&i.keyFrames[0].contents[0]&&i.keyFrames[0].contents[0].item&&i.keyFrames[1]&&i.keyFrames[1].contents[0]&&i.keyFrames[1].contents[0].item)for(const e of this.m_cameoViewElements)if(e.shapeItem===i.keyFrames[0].contents[0].item||e.shapeItem===i.keyFrames[1].contents[0].item){i.hasDynamicContent=!0;break}i.rotateClockwise=e.rotateClockwise,this.morph.elements.push(i)}if(i===c.kTransitionIds.PPT_TRANSITION_PAN)switch(r){case c.kTransitionEffectOptions.Left:this.morph.panVector=new f.e(-this.m_slideSizePixels.x,0);break;case c.kTransitionEffectOptions.Top:this.morph.panVector=new f.e(0,-this.m_slideSizePixels.y);break;case c.kTransitionEffectOptions.Right:this.morph.panVector=new f.e(this.m_slideSizePixels.x,0);break;case c.kTransitionEffectOptions.Bottom:this.morph.panVector=new f.e(0,this.m_slideSizePixels.y)}if(o.a.sendTraceTag(592197024,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,JSON.stringify(this.metadata)),!b.ChangeGate.isChangeGateEnabled("SSC.CheckMorphZPos")){const e=[new Set,new Set];for(const t of this.morph.elements)for(let i=0;i<2;i+=1){const r=t.keyFrames[i]?t.keyFrames[i].zPosition:void 0;if(void 0!==r){if(e[i].has(r))return void this.fallbackReasons.add("duplicate z position");e[i].add(r)}}}}createMorphKeyFrame(e,t,i,r){if(!e)return;const n=[];if(e.isBg){const e={slideId:t.slideId,shapeId:-1},i=t.shapeViewElements.filter(t=>t.id.slideId.sid===e.slideId.sid&&t.id.shapeId===e.shapeId);for(const e of i)if(e.shapeItem){const t={item:e.shapeItem,textRange:void 0,includeSubtree:!0};n.push(t),this.metadata.numOtherElement+=1}}for(const i of e.parts){const e=t.shapeViewElements.find(e=>i.shapeId?e.id.slideId.sid===i.shapeId.slideId.sid&&e.id.shapeId===i.shapeId.shapeId:void 0);if(e&&e.shapeItem){let t=e.shapeItem;const r=4===e.shapeType&&!this.m_cameoViewElements.includes(e);r&&this.m_cameoViewElements.push(e),i.bigPart&&(t=Object(T.d)(t,i.bigPart)||t);let a=!0,s=void 0;const h=Object(T.f)(t);i.textRange&&(h&&h.text?(s=new v.j(i.textRange.begin,i.textRange.length),t=h):(o.a.sendTraceTag(593020765,l.a.msoulscat_Wac_PptSession,d.a.Error,"MorphTransition::createMorphKeyFrame: text not found for shapebuilder shape."),this.fallbackReasons.add("text missing"))),a=i.isSubtreeIncluded;const c={item:t,textRange:s,includeSubtree:a};n.push(c),s?this.metadata.numTextElement+=1:r?this.metadata.numCameoElement+=1:this.metadata.numOtherElement+=1}}if(0===n.length)for(const i of e.parts){let e,r;for(const n of t.shapeViewElements)if(i.animatableContentId)for(const t of n.animatableContentViewElements){const a=i.animatableContentId.toString();t.id===a&&(e=n,r=t)}if(e&&e.shapeItem&&r){const t=e.shapeItem;if(i.animatablePartIndicies&&0!==i.animatablePartIndicies.length)for(const e of i.animatablePartIndicies){const i={item:Object(T.d)(t,`${r.id}c${e}`)||t,includeSubtree:!1};n.push(i),this.metadata.numFallbackElement+=1}else{const e={item:Object(T.d)(t,r.id)||t,includeSubtree:!1};n.push(e),this.metadata.numFallbackElement+=1}}}if(0===n.length&&e.fallbackImage){const t=this.m_environment.viewDataManager.imageDataMap.get(e.fallbackImage.imgID);if(t&&t.size){const i=t.size,r=t.size,a=t.size.scale(.5);w.a.verifyTextureSize(this.m_environment,"morph_fallback",i);const o=new y.f;o.id=e.fallbackImage.imgID,this.m_environment.rendererEnvironment.attachImage("MorphImageFallback",o,t,t.size);const l=new y.e(o);l.scale=r.divide(i),l.offset=r.scale(.5).subtract(a).divide(i);const d=new f.c(e.fallbackImage.rect.left,e.fallbackImage.rect.top,e.fallbackImage.rect.right,e.fallbackImage.rect.bottom),h=s.e.CreateRectangle(d,new y.k(l));this.createdItems.push(h);const c={item:h,includeSubtree:!1};n.push(c),this.metadata.numFallbackElement+=1}else o.a.sendTraceTag(592561536,l.a.msoulscat_Wac_PptSession,d.a.Error,"MorphTransition::createMorphKeyFrame: fallback image not found for shapebuilder shape."),this.fallbackReasons.add("fallback image missing")}const a={center:r?M.toVector2(e.center).transformPoint(r):M.toVector2(e.center),flipX:e.flipX,flipY:e.flipY,rotation:e.angleRadians,size:r?M.toVector2(e.size).transformVector(r):M.toVector2(e.size)},h=e.grid?{data:e.grid.data,size:M.toVector2(e.grid.size)}:void 0;return new p(n,a,e.zIndex,h,i)}static toVector2(e){return new f.e(e.x,e.y)}static applyShotgunToPillowCurve(e){return.5-.5*Math.cos(2*Math.PI*(1-1/(e+1)))}init(e){}tryPrepareMorph(e){return this.m_isDisposed?(o.a.sendTraceTag(520681372,l.a.msoulscat_Wac_PptSession,d.a.Error,"MorphTransition tried to prepare after being disposed."),!0):this.m_environment.rendererEnvironment.renderer.tryPrepareMorph(this.morph,e)}draw(e){if(this.m_isDisposed)return o.a.sendTraceTag(520681371,l.a.msoulscat_Wac_PptSession,d.a.Error,"MorphTransition tried to draw after being disposed."),!1;for(const e of this.m_cameoViewElements)e.ensureCameoTextureAttached();(S.Settings.readBooleanOrDefault("enableCameoInPPTOSlideShow",!1)||S.Settings.readBooleanOrDefault("enableCameoInT2",!1))&&this.m_cameoViewElements.length>0&&this.m_environment.updateCameoTextureFromVideoElement();const t=this.isForwards?M.applyShotgunToPillowCurve(e):1-M.applyShotgunToPillowCurve(1-e),i=new f.e(this.m_slideSizePixels.x,this.m_slideSizePixels.y).scale(S.Settings.readNumberOrDefault("hackMorphRenderSizeScale",1)),r=this.m_environment.rendererEnvironment.calculateRenderTransform(i);return this.m_environment.rendererEnvironment.renderer.renderMorph(this.morph,t,y.b.White,r),!0}dispose(){this.morph.clearCache();for(const e of this.createdItems)e.releaseGeneratedResources();this.m_isDisposed=!0}}var C=i(42);function I(e){const t=[e.ACTIVE_TEXTURE,e.ARRAY_BUFFER_BINDING,e.BLEND,e.BLEND_COLOR,e.BLEND_DST_ALPHA,e.BLEND_DST_RGB,e.BLEND_EQUATION_ALPHA,e.BLEND_EQUATION_RGB,e.BLEND_SRC_ALPHA,e.BLEND_SRC_RGB,e.COLOR_CLEAR_VALUE,e.COLOR_WRITEMASK,e.CULL_FACE,e.CULL_FACE_MODE,e.CURRENT_PROGRAM,e.DEPTH_CLEAR_VALUE,e.DEPTH_FUNC,e.DEPTH_RANGE,e.DEPTH_TEST,e.DEPTH_WRITEMASK,e.DITHER,e.ELEMENT_ARRAY_BUFFER_BINDING,e.FRAMEBUFFER_BINDING,e.FRONT_FACE,e.GENERATE_MIPMAP_HINT,e.LINE_WIDTH,e.PACK_ALIGNMENT,e.POLYGON_OFFSET_FACTOR,e.POLYGON_OFFSET_FILL,e.POLYGON_OFFSET_UNITS,e.RENDERBUFFER_BINDING,e.SAMPLE_COVERAGE_INVERT,e.SAMPLE_COVERAGE_VALUE,e.SCISSOR_BOX,e.SCISSOR_TEST,e.STENCIL_BACK_FAIL,e.STENCIL_BACK_FUNC,e.STENCIL_BACK_PASS_DEPTH_FAIL,e.STENCIL_BACK_PASS_DEPTH_PASS,e.STENCIL_BACK_REF,e.STENCIL_BACK_VALUE_MASK,e.STENCIL_BACK_WRITEMASK,e.STENCIL_CLEAR_VALUE,e.STENCIL_FAIL,e.STENCIL_FUNC,e.STENCIL_PASS_DEPTH_FAIL,e.STENCIL_PASS_DEPTH_PASS,e.STENCIL_REF,e.STENCIL_TEST,e.STENCIL_VALUE_MASK,e.STENCIL_WRITEMASK,e.TEXTURE_BINDING_2D,e.TEXTURE_BINDING_CUBE_MAP,e.UNPACK_ALIGNMENT,e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.UNPACK_FLIP_Y_WEBGL,e.UNPACK_PREMULTIPLY_ALPHA_WEBGL];let i=e.getParameter(e.VIEWPORT),r=new Array(57);for(let i=0;i<57;i++)r[i]=e.getParameter(t[i]);let n=new Array(2);for(let t=0;t<2;t++)n[t]=e.getVertexAttrib(t,e.VERTEX_ATTRIB_ARRAY_ENABLED);return{viewport:i,params:r,VERTEX_ATTRIB_ARRAY_ENABLED:n}}class P{constructor(e){this.webGLRestoreToDefault=!1,this.old=new Array(57),this.old_VERTEX_ATTRIB_ARRAY_ENABLED=new Array(2),this.webGLRestoreToDefault=e}init(e){if(this.gl&&m.a.Error(591663577,"Previous Init has not been Restored"),this.gl=e,this.webGLRestoreToDefault)this.old_VIEWPORT=e.getParameter(e.VIEWPORT);else{let{viewport:t,params:i,VERTEX_ATTRIB_ARRAY_ENABLED:r}=I(e);this.old_VIEWPORT=t,this.old=i,this.old_VERTEX_ATTRIB_ARRAY_ENABLED=r}}setDefaults(){const e=this.gl;if(e){e.activeTexture(e.TEXTURE0),e.bindBuffer(e.ARRAY_BUFFER,null),e.disable(e.BLEND),e.blendColor(0,0,0,0),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.clearColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.disable(e.CULL_FACE),e.cullFace(e.BACK),e.useProgram(null),e.clearDepth(1),e.depthFunc(e.LESS),e.depthRange(0,1),e.disable(e.DEPTH_TEST),e.depthMask(!0),e.disable(e.DITHER),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.frontFace(e.CCW),e.hint(e.GENERATE_MIPMAP_HINT,e.DONT_CARE),e.lineWidth(1),e.polygonOffset(0,0),e.disable(e.POLYGON_OFFSET_FILL),e.bindRenderbuffer(e.RENDERBUFFER,null),e.sampleCoverage(1,!1),e.scissor(0,0,this.old_VIEWPORT[2],this.old_VIEWPORT[3]),e.disable(e.SCISSOR_TEST),e.stencilFunc(e.ALWAYS,0,1),e.stencilMask(255),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.disable(e.STENCIL_TEST),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.pixelStorei(e.PACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.BROWSER_DEFAULT_WEBGL),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),e.viewport(this.old_VIEWPORT[0],this.old_VIEWPORT[1],this.old_VIEWPORT[2],this.old_VIEWPORT[3]);for(let t=0;t<2;t++)e.disableVertexAttribArray(t)}else m.a.Error(591663578,"Trying to set default without Init")}restore(){const e=this.gl;if(!e)return void m.a.Error(591663579,"Trying to Restore without Init");const t=this.old;if(this.webGLRestoreToDefault)this.setDefaults();else{e.activeTexture(t[0]),e.bindBuffer(e.ARRAY_BUFFER,t[1]),t[2]?e.enable(e.BLEND):e.disable(e.BLEND);const i=t[3];e.blendColor(i[0],i[1],i[2],i[3]),e.blendEquationSeparate(t[7],t[6]),e.blendFuncSeparate(t[9],t[5],t[8],t[4]);const r=t[10];e.clearColor(r[0],r[1],r[2],r[3]);const n=t[11];e.colorMask(n[0],n[1],n[2],n[3]),t[12]?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),e.cullFace(t[13]),e.useProgram(t[14]),e.clearDepth(t[15]),e.depthFunc(t[16]),e.depthRange(t[17][0],t[17][1]),t[18]?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),e.depthMask(t[19]),t[20]?e.enable(e.DITHER):e.disable(e.DITHER),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t[21]),e.bindFramebuffer(e.FRAMEBUFFER,t[22]),e.frontFace(t[23]),e.hint(e.GENERATE_MIPMAP_HINT,t[24]),e.lineWidth(t[25]),e.pixelStorei(e.PACK_ALIGNMENT,t[26]),e.polygonOffset(t[27],t[29]),t[28]?e.enable(e.POLYGON_OFFSET_FILL):e.disable(e.POLYGON_OFFSET_FILL),e.bindRenderbuffer(e.RENDERBUFFER,t[30]),e.sampleCoverage(t[32],t[31]);const a=t[33];e.scissor(a[0],a[1],a[2],a[3]),t[34]?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),e.stencilFuncSeparate(e.FRONT,t[44],t[47],t[49]),e.stencilFuncSeparate(e.BACK,t[36],t[39],t[40]),e.stencilMaskSeparate(e.FRONT,t[50]),e.stencilMaskSeparate(e.BACK,t[41]),e.stencilOpSeparate(e.FRONT,t[43],t[45],t[46]),e.stencilOpSeparate(e.BACK,t[35],t[37],t[38]),e.clearStencil(t[42]),t[48]?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),e.bindTexture(e.TEXTURE_2D,t[51]),e.bindTexture(e.TEXTURE_CUBE_MAP,t[52]),e.pixelStorei(e.UNPACK_ALIGNMENT,t[53]),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,t[54]),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t[55]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t[56]),e.viewport(this.old_VIEWPORT[0],this.old_VIEWPORT[1],this.old_VIEWPORT[2],this.old_VIEWPORT[3]);for(let t=0;t<2;t++)this.old_VERTEX_ATTRIB_ARRAY_ENABLED[t]?e.enableVertexAttribArray(t):e.disableVertexAttribArray(t)}this.gl=void 0}}var E=i(28),x=i(22),A=i(93),k=i(78),R=i(15);class O{constructor(e,t,i,r){this.triangleCount=t,this.vertexBuffer=i,this.indexBuffer=r,this.m_engine=e.getBabylonEngine(),this.m_compatibleGraphicsProcessorId=e.getUniqueGraphicsProcessorId()}isValid(e){return this.m_compatibleGraphicsProcessorId==e.getUniqueGraphicsProcessorId()}discard(){this.m_engine._releaseBuffer(this.vertexBuffer),this.m_engine._releaseBuffer(this.indexBuffer)}static CreateGridXY(e,t,i,r){const n=new Float32Array(t*i*2);for(let e=0;e<i;e++){const a=Object(f.n)(r.top,r.bottom,e/(i-1));for(let i=0;i<t;i++){const s=2*(i+e*t);n[s]=Object(f.n)(r.left,r.right,i/(t-1)),n[s+1]=a}}const a=new Uint16Array((t-1)*(i-1)*2*3);for(let e=0;e<i-1;e++)for(let i=0;i<t-1;i++)a.set([i+e*t,i+1+e*t,i+(e+1)*t,i+1+(e+1)*t,i+(e+1)*t,i+1+e*t],6*(i+e*(t-1)));const s=e.getBabylonEngine();return new O(e,(t-1)*(i-1)*2,s.createVertexBuffer(n),s.createIndexBuffer(a))}}var L=i(257);const F=[{attributeName:"a_0",attributeSize:2,offset:0,divisor:0}],D=[{attributeName:"a_1",attributeSize:2,offset:0,divisor:0}];function B(e,t,i,r,n,a,s,o,l,d){const h=i.tryUseBabylonTexture(e,d,"blurSrc");if(!h)return void m.a.Error(592525250,"Invalid Texture");const c=r.tryGetBabylonTextureForRenderToTexture(e);if(!c)return void m.a.Error(572867298,"Invalid Texture");const u=e.activateShaderProgram(3);u.begin(c,y.b.Transparent,!1);const f=u.getBabylonEffect();f.setFloat("u_0",a),f.setVector2("u_1",t),f.setVector2("u_2",o),f.setVector2("u_3",i.size),f.setInt("u_4",l?1:2),u.setTexture("tex_0",h),f.setDirectColor4("ufrag_0",n||y.b.Transparent),f.setFloat("ufrag_2",Math.log(a/4)/Math.log(2)),f.setInt("ufrag_3",s),f.setInt("ufrag_4",l?1:2),u.drawQuads(1),u.end(),r.generateMipMap()}function N(e,t){const i=H(t,e.contentLocation.logicalSize);let r=f.b.Scale2D(i.multiply(f.e.Flip(e.contentLocation.flipX,e.contentLocation.flipY)));return r=r.multiply(f.b.RotationZ(e.contentLocation.rotation)),r=r.multiply(f.b.Translation2D(e.contentLocation.logicalCenter)),r=r.multiply(f.b.Scale2D(e.size.inverse())),r=r.multiply(f.b.Translation2D(new f.e(-.5,-.5))),r}function V(e){return e?e.size.x+"x"+e.size.y:"undefined"}class U{constructor(e,t){this.contentRotation=0,this.depth=0,this.depthFar=0,this.depthNear=0,this.blendingMode=0,this.overallOpacity=1,this.contentCenter=e?e.center:f.e.Zero,this.contentSize=e?e.size:f.e.One,this.contentFlip=e?f.e.Flip(e.flipX,e.flipY):f.e.One,this.contentRotation=e?e.rotation:0,this.customMesh=t}getDebugStringInfo(){return["Layer"]}}class W extends U{constructor(e,t,i){super(t,i),this.texture=e}getDebugStringInfo(){return["Texture: "+V(this.texture),(this.fadeInfo?" +Fade ":"")+(this.reflectionGradient?" + Reflection ":"")+(this.customMesh?" + CustomMesh ":"")]}}class z extends U{constructor(e,t,i,r,n,a){super({center:f.e.Zero,size:f.e.One,rotation:0,flipX:!1,flipY:!1},n),this.progress=0,this.textureA=e,this.textureB=t,this.panVector=a,i&&r&&(this.morphingGrid=[i,r])}getDebugStringInfo(){return["Textures: "+V(this.textureA)+"  "+V(this.textureB),(this.fadeInfo?" +Fade ":"")+(this.customMesh?" + CustomMesh ":"")+(this.morphingGrid?" + MorphingGrid ":"")]}}class G extends z{constructor(e,t,i,r,n,a,s,o,l,d){super(e,t,s,o,l,d),this.textureDeltaWhiteA=i,this.textureDeltaWhiteB=r,this.texturePictureA=n,this.texturePictureB=a}getDebugStringInfo(){return["Textures: "+V(this.textureA)+"  "+V(this.textureB),"TexturesW: "+V(this.textureDeltaWhiteA)+"  "+V(this.textureDeltaWhiteB),"TextureP: "+V(this.texturePictureA)+"  "+V(this.texturePictureB),(this.fadeInfo?" +Fade ":"")+(this.customMesh?" + CustomMesh ":"")+(this.morphingGrid?" + MorphingGrid ":"")]}}class j extends W{constructor(e,t,i,r){super(e,t,r),this.fillBrightness=0,this.distanceFieldMode=2,this.style=i}getDebugStringInfo(){return["Texture: "+V(this.texture),(this.fadeInfo?" +Fade ":"")+(this.reflectionGradient?" + Reflection ":"")+(this.customMesh?" + CustomMesh ":"")]}}function H(e,t){return 0!=e.x&&0!=e.y?t.divide(e):0!=e.x?f.e.One.scale(t.x/e.x):0!=e.y?f.e.One.scale(t.y/e.y):f.e.Zero}function q(e,t,i){const r=H(t,e.logicalSize),n=f.c.FromSizeAndCenter(e.physicalSize,e.physicalCenter.subtract(e.logicalCenter)),a=f.b.RotationZ(-e.rotation),s=f.b.ScaleTranslation2D(f.e.Flip(e.flipX,e.flipY).divide(r),i);return n.transformedBounds(a.multiply(s))}function $(e,t,i,r){const n=Object(s.i)(t.alignment,e),a=t.isStretched?e:e.transformedBounds(new f.d(n.negate(),i.originalSize.divide(e.size),0,n));if(a){const s=t.isStretched?t.offset.multiply(a.size):t.offset;let o=t.scale;if(t.isStretched&&t.fillToPreserveAspectRatio){const t=i.originalSize.x/i.originalSize.y,r=e.size.x/e.size.y;o=o.multiply(new f.e(t>r?t/r:1,t<r?r/t:1))}const l=a.transformedBounds(new f.d(n.negate(),o,0,n.add(s)));return l&&r?l.transformedBounds(r):l}}function Z(e,t,i,r,n,o,l){var d,h,c,u;const p=t instanceof W?t:void 0,g=t instanceof z?t:void 0,_=t instanceof G?t:void 0,v=g?g.textureA:p?p.texture:void 0,b=g?g.textureB:void 0,S=g&&g.panVector&&(!v||!b);let T=0;g&&(T=S?v?0:1:g.progress);const w=p?p.reflectionGradient:void 0,M=t instanceof j&&!v;if(!M&&!(v&&v.isValidForGraphicsProcessor(e)||b&&b.isValidForGraphicsProcessor(e)))return void m.a.Error(592525252,"No Texture");const C=t.contentCenter;let I=f.b.Identity,P=f.b.Identity;const E=i.getBabylonEffect(),x=i.getBabylonEngine();if(g&&g.morphingGrid&&2==g.morphingGrid.length)E.setInt("u_16",1),E.setFloat("u_17",g.progress),x.bindInstancesBuffer(g.morphingGrid[0],F),x.bindInstancesBuffer(g.morphingGrid[1],D),I=f.b.Scale2D(t.contentSize),P=f.b.Scale2D(t.contentSize);else{E.setInt("u_16",0),E.setFloat("u_17",0),i.setDummyPointerAttribute("a_0"),i.setDummyPointerAttribute("a_1");const e=v?q(v.contentLocation,t.contentSize,t.contentCenter):M?f.c.FromSizeAndCenter(t.contentSize,t.contentCenter):void 0,r=b?q(b.contentLocation,t.contentSize,t.contentCenter):void 0;let n=e&&r?f.c.UnionRect(e,r):e||r;if(t instanceof j&&t.style.pictureOverflow>0&&t.style.pictureBrush&&t.pictureTexture){const e=$(t.fillBoundsOverride?t.fillBoundsOverride:f.c.FromSizeAndCenter(t.contentSize,t.contentCenter),t.style.pictureBrush,t.pictureTexture);e&&(n=f.c.UnionRect(n,e))}if(!n)return void m.a.Error(592525253,"Undefined physical bounds");if(n=n.translate(t.contentCenter.negate()),n=t.effectTransform?n.transformedBounds(t.effectTransform):n,n=n&&t.localClipRect?f.c.IntersectRect(n,t.localClipRect):n,!n)return;n=n.translate(t.contentCenter),I=f.b.ScaleTranslation2D(n.size,n.center.subtract(C));const a=t.effectTransform?t.effectTransform.inverse():void 0;P=a?I.multiply(a):I}const A=v?P.multiply(N(v,t.contentSize)):f.b.Identity,k=b?P.multiply(N(b,t.contentSize)):f.b.Identity;let R=f.b.Identity;if(t instanceof j&&t.textCutoutTexture&&v){const e=t.textCutoutTransform||f.b.Identity;R=P.multiply(e).multiply(N(t.textCutoutTexture,t.contentSize))}let O=C;S&&g&&g.panVector&&(O=C.add(g.panVector.scale(g.progress-(b?1:0))));let B=f.b.RotationZ(t.contentRotation).multiply(f.b.Translation2D(O));n&&(B=B.multiply(n)),E.setMatrix3x3("u_0",I.m),E.setVector2("u_15",t.contentFlip),E.setMatrix3x3("u_1",B.m),E.setVector2("u_2",r),E.setMatrix3x3("u_3",A.m),E.setMatrix3x3("u_11",R.m),E.setMatrix3x3("u_4",k.m),E.setFloat2("ufrag_12",w?w.opacity0:1,w?w.opacity1:1),E.setVector2("u_20",w?w.pos0:f.e.Zero),E.setVector2("u_21",w?w.pos1:f.e.Zero),E.setDirectColor4("ufrag_13",o||y.b.Transparent),E.setFloat("ufrag_36",T);const V=t.fadeInfo?t.fadeInfo.fadeTexture:void 0;i.setTexture("t_3",V?V.tryUseBabylonTexture(e,t.clientObject,"fadeTexture"):void 0);let U=0;if(t.fadeInfo&&t.fadeInfo.fade){U=t.fadeInfo.fadeMode;const i=t.fadeInfo.fade,r=i.reverse?1-i.progress:i.progress;E.setVector2("ufrag_17",function(e,t,i){var r;let n=10;if(0==e.preset)n=1;else if(13==e.preset){const t=null!==(r=e.drawFadeOptions)&&void 0!==r?r:L.a.Default;n=i&&0==t.mode?1:Math.max(10,30)}return e.reverse?new f.e(n-1,1-t*n):new f.e(1-n,t*n)}(i,r,t instanceof j&&void 0!==t.pictureTexture)),0!=i.preset&&(t.fadeInfo.fadeTexture&&t.fadeInfo.fadeTexture.isValidForGraphicsProcessor(e)?E.setMatrix3x3("u_10",13==i.preset?P.multiply(N(t.fadeInfo.fadeTexture,t.contentSize)).m:A.multiply(i.getFadeTransform()).m):m.a.Error(592525254,"fade texture missing"))}if(E.setInt("ufrag_16",U),E.setFloat("u_18",t.depthFar),E.setFloat("u_19",t.depthNear),E.setFloat("ufrag_41",t.overallOpacity),E.setMatrix3x3("ufrag_42",null!==(h=null===(d=t.colorMatrix)||void 0===d?void 0:d.m)&&void 0!==h?h:f.b.Identity.m),E.setVector3("ufrag_43",null!==(c=t.colorOffset)&&void 0!==c?c:f.f.Zero),E.setDirectColor4("ufrag_44",null!==(u=t.colorize)&&void 0!==u?u:y.b.Transparent),t instanceof j){let r;!function(e,t,i,r,n,o){var l;const d=i.texture,h=i.style;t.setFloat("ufrag_0",i.distRangeSize?.5/i.distRangeSize:1),t.setInt("ufrag_34",d?0:1);const c=7==o&&h.hitTransparentFill,u=h.fillBrush;let p=c?1:u?u.getType():0;const g=6==p?i.fillTexture:void 0;6!=p||g||(p=0);const _=u instanceof y.i?!u.color.equals(y.b.Transparent):0!=p;if(t.setInt("ufrag_10",p),4==p)t.setFloatArray4("ufrag_3",X(u));else{const e=c?y.b.White:1==p?u.color:7==p?u.foregroundColor:y.b.Transparent;t.setDirectColor4("ufrag_3",e)}t.setInt("ufrag_18",6==p&&g&&4==g.wrapMode?1:0),t.setFloat("ufrag_20",6==p?u.opacity:1),t.setInt("u_13",7==p?1:0),t.setMatrix3x3("u_4",i.fillTransformUV?7==p?i.fillTransformUV.m:r.multiply(i.fillTransformUV).m:r.m),t.setDirectColor4("ufrag_22",7==p?u.backgroundColor:y.b.Transparent),t.setFloat("ufrag_28",i.fillBrightness);const v=i.pictureTexture;if(t.setInt("ufrag_30",v?1:0),v){const e=h.pictureBrush;t.setInt("ufrag_31",v&&4==v.wrapMode?1:0),t.setFloat("ufrag_32",e.opacity),t.setMatrix3x3("u_5",i.pictureTransformUV?r.multiply(i.pictureTransformUV).m:f.b.Identity.m)}let b=0;a.a==a.g?b=a.l:7!=o||!h.hasLine||_||v||(b=null!==(l=h.hitTestSlop)&&void 0!==l?l:a.t);let S=h.lineBrush&&2!=o?h.lineBrush.getType():0;const T=6==S?i.lineTexture:void 0;6!=S||T||(S=0),b&&(S=1);const w=a.a==a.g?b:Math.max(b,h.hasLine?h.pen.adjustedLineWidth:0);if(t.setFloat("ufrag_1",w),t.setInt("ufrag_11",S),4==S)t.setFloatArray4("ufrag_4",X(h.lineBrush));else{let e=y.b.Transparent;b?e=a.a==a.g?y.b.Red:y.b.White:1==S?e=h.lineBrush.color:7==S&&(e=h.lineBrush.foregroundColor),t.setDirectColor4("ufrag_4",e)}t.setInt("ufrag_19",6==S&&T&&4==T.wrapMode?1:0),t.setFloat("ufrag_21",6==S?h.lineBrush.opacity:1),t.setInt("u_14",7==S?1:0),t.setMatrix3x3("u_6",i.lineTransformUV?7==S?i.lineTransformUV.m:r.multiply(i.lineTransformUV).m:r.m),t.setDirectColor4("ufrag_23",7==S?h.lineBrush.backgroundColor:y.b.Transparent),t.setFloat("ufrag_29",1==i.mergeMode?1:0),t.setFloat("ufrag_6",h.pen&&0!=h.pen.dashType&&h.pen.useRoundDash?1:0);const M=b?Y[0]:function(e){return!e.compoundType||e.tipType?Y[0]:e.compoundType>=0&&e.compoundType<Y.length?Y[e.compoundType]:(m.a.Error(587220940,"unsupported compoundType"),Y[0])}(h.pen);t.setFloatArray3("ufrag_8",M.centers),t.setFloatArray3("ufrag_9",M.slopes);const C=Math.sqrt(2)/2,I=new f.e(C,C),P=n?n.transformVector(I).length():1;if(t.setFloat("ufrag_2",1/P),t.setFloat("ufrag_27",Object(f.g)(Object(s.m)(h.pen),-1,1)*w/2),t.setInt("ufrag_37",d&&2==i.distanceFieldMode?1:0),t.setInt("ufrag_38",0==h.pen.dashType&&0==h.pen.compoundType||7==o?1:0),i.softEdges&&i.softEdges.radius>0&&i.softEdgesTexture&&i.softEdgesTexture.isValidForGraphicsProcessor(e)?(t.setInt("ufrag_24",1),t.setMatrix3x3("u_7",r.multiply(N(i.softEdgesTexture,i.contentSize)).m)):(t.setInt("ufrag_24",0),i.softEdges&&i.softEdges.radius>0&&m.a.Error(588006213,"soft edges texture not ready")),i.innerShadow&&i.innerShadow.color.a>0&&i.innerShadowTexture&&i.innerShadowTexture.isValidForGraphicsProcessor(e)){const e=new f.e(i.innerShadow.distance,0).rotate(i.innerShadow.angle),n=r.multiply(f.b.Translation2D(e)).multiply(N(i.innerShadowTexture,i.contentSize));t.setInt("ufrag_25",1),t.setMatrix3x3("u_8",n.m),t.setDirectColor4("ufrag_26",i.innerShadow.color)}else t.setInt("ufrag_25",0),i.innerShadow&&i.innerShadow.color.a>0&&m.a.Error(588006214,"inner shadow  exture not ready");t.setInt("ufrag_39",i.textRenderMode||0),t.setFloat("ufrag_40",h.pictureOverflow),t.setInt("ufrag_15",7==o||5==o?1:a.a==a.e?10:a.a!=a.b&&7!=a.a?a.a+10:0),a.a==a.g&&(t.setInt("ufrag_10",0),t.setInt("ufrag_11",1)),0==o&&3==i.blendingMode&&t.setDirectColor4("ufrag_13",y.b.White)}(e,E,t,P,n,l),i.setTexture("t_0",v?v.tryUseBabylonTexture(e,t.clientObject,"distanceField"):void 0),i.setTexture("t_1",t.fillTexture?t.fillTexture.tryUseBabylonTexture(e,t.clientObject,"fillTexture"):void 0),i.setTexture("t_2",t.lineTexture?t.lineTexture.tryUseBabylonTexture(e,t.clientObject,"lineTexture"):void 0),i.setTexture("t_4",t.softEdgesTexture?t.softEdgesTexture.tryUseBabylonTexture(e,t.clientObject,"softEdgesTexture"):void 0),i.setTexture("t_5",t.innerShadowTexture?t.innerShadowTexture.tryUseBabylonTexture(e,t.clientObject,"innerShadowTexture"):void 0),t.pictureTexture&&7==l&&t.style.hitTransparentFill?r=e.whiteTexture:t.pictureTexture&&(r=t.pictureTexture.tryUseBabylonTexture(e,t.clientObject,"pictureTexture")),i.setTexture("t_6",r),i.setTexture("t_7",t.textCutoutTexture?t.textCutoutTexture.tryUseBabylonTexture(e,t.clientObject,"textCutoutTexture"):void 0)}else!function(e){e.setFloat("ufrag_0",0),e.setFloat("ufrag_1",0),e.setFloat("ufrag_2",0),e.setDirectColor4("ufrag_3",y.b.Transparent),e.setDirectColor4("ufrag_4",y.b.Transparent),e.setFloat("ufrag_6",0),e.setFloatArray3("ufrag_8",new Float32Array([0,0,0])),e.setFloatArray3("ufrag_9",new Float32Array([0,0,0])),e.setInt("ufrag_10",0),e.setInt("ufrag_11",0),e.setInt("ufrag_18",0),e.setInt("ufrag_19",0),e.setFloat("ufrag_20",1),e.setFloat("ufrag_21",1),e.setDirectColor4("ufrag_22",y.b.Transparent),e.setDirectColor4("ufrag_23",y.b.Transparent),e.setInt("ufrag_24",0),e.setInt("ufrag_25",0),e.setDirectColor4("ufrag_26",y.b.Transparent),e.setFloat("ufrag_27",0),e.setFloat("ufrag_28",0),e.setFloat("ufrag_29",0),e.setInt("ufrag_30",0),e.setInt("ufrag_31",0),e.setFloat("ufrag_32",0),e.setInt("ufrag_34",0),e.setInt("u_13",0),e.setInt("u_14",0),e.setInt("ufrag_39",0),e.setFloat("ufrag_40",0)}(E),E.setInt("ufrag_15",_?3:2),i.setTexture("t_0",v?v.tryUseBabylonTexture(e,t.clientObject,t instanceof z?"morphA":"sprite"):void 0),i.setTexture("t_1",b?b.tryUseBabylonTexture(e,t.clientObject,"morphB"):void 0),i.setTexture("t_2",_?_.textureDeltaWhiteA.tryUseBabylonTexture(e,t.clientObject,"morphAW"):void 0),i.setTexture("t_4",_?_.textureDeltaWhiteB.tryUseBabylonTexture(e,t.clientObject,"morphBW"):void 0),i.setTexture("t_5",_?_.texturePictureA.tryUseBabylonTexture(e,t.clientObject,"morphAP"):void 0),i.setTexture("t_6",_?_.texturePictureB.tryUseBabylonTexture(e,t.clientObject,"morphBP"):void 0),i.setTexture("t_7",void 0),_&&E.setMatrix3x3("u_5",_.pictureTransformUV?P.multiply(_.pictureTransformUV).m:f.b.Identity.m);const H=0==l,Z=1==t.blendingMode||5==t.blendingMode;E.setInt("ufrag_35",H&&Z?1:0),i.setBlendingMode(H?t.blendingMode:0),t.customMesh?i.drawMesh(t.customMesh):i.drawQuads(1)}function X(e){const t=e.fillToRect?e.fillToRect:new f.c(.5,.5,.5,.5),i=e.fillFromRect?e.fillFromRect:new f.c(0,0,1,1),r=t.translate(i.leftTop.negate()).multiply(i.size.inverse());return new Float32Array([1/r.left,1/r.top,1/(1-r.right),1/(1-r.bottom)])}const Y=[{centers:new Float32Array([0,0,0]),slopes:new Float32Array([1,1,1])},{centers:new Float32Array([-2/3,2/3,2/3]),slopes:new Float32Array([3,3,3])},{centers:new Float32Array([-.4,.8,.8]),slopes:new Float32Array([5/3,5,5])},{centers:new Float32Array([-.8,.4,.4]),slopes:new Float32Array([5,5/3,5/3])},{centers:new Float32Array([-5/6,0,5/6]),slopes:new Float32Array([6,3,6])}];var J=i(64);const K=[1,1,2,4,8,16,16];function Q(e,t,i=!1,r=!1,n){const a=[],s=r?[]:void 0;if(!e.figures||0==e.figures.length)return{buffers:a,endDistance:0};let o=0;for(let l=0;l<e.figures.length;l++){const d=i?e.figures[l].toPolygon():e.figures[l],h=Object(x.f)(43),c=d.isLastPointDuplicated(),u=d.isClosed||c,f=ee(d.points,d.format,43,0,c?d.points.length-d.pointDataSize:d.points.length,1,3,u,e.maxPressure),m=f.length/h;let p;if(r){const e=te(f,43,u,o,n,1,3);p=e.distanceArray,o=e.endDistance}const g=f.length;if(g>t){const e=t/h-4,i=Math.ceil((m-4)/e),r=e+4;let n=0;for(let e=0;e<i;e++){const e=Math.min(r,m-n),t=e-4;a.push(f.subarray(n*h,(n+e)*h)),s&&p&&s.push(p.subarray(n,n+e)),n+=t}}else{const e=new Float32Array(4*Math.ceil(g/4));e.set(f,0),a.push(e),s&&p&&s.push(p)}}return s&&s.length!=a.length&&m.a.Error(592525388,"Invalid distance array"),{buffers:a,distanceBuffers:s,endDistance:o}}function ee(e,t,i,r=0,n=e.length,a=0,s=0,o=!0,l=1){let d=Object(x.f)(t),h=n-r;if(!(h%d==0&&1&t&&1&i))throw m.a.Error(592525389,"list of source points invalid");let c=e,u=h/d;1==u&&(c=new Float32Array(2*e.length),c.set(e,0),c.set(e,e.length),u=2);const f=d;d=Object(x.f)(i);const p=new Float32Array((a+u+s)*d);for(let e=0;e<u;e++){let n=r+e*f,s=(a+e)*d;for(const e of K)e&i&&(p[s]=8==e?e&t?c[n]/l:1:e&t?c[n]:2==e?1:0,s++),e&t&&n++}if((a||s)&&(a>0&&p.copyWithin(0,p.length-(a+s)*d,p.length-s*d),s>0&&p.copyWithin(p.length-s*d,a*d,(a+s)*d),!o&&2&i)){for(let e=0;e<a;e++)p[e*d+2]=0;for(let e=0;e<s;e++)p[p.length-(e+1)*d+2]=0}return p}function te(e,t,i,r=0,n,a=0,s=0){const o=n?function(e,t,i){const r=Object(x.f)(t);if(0==r||e.length%r!=0||!(1&t))throw m.a.Error(592525390,"list of points for invalid for measuring distance");const n=i.m,a=new Float32Array(e);for(let t=0;t<e.length;t+=r){const i=e[t],r=e[t+1];a[t]=i*n[0]+r*n[3]+n[6],a[t+1]=i*n[1]+r*n[4]+n[7]}return a}(e,t,n):e,l=Object(x.f)(t);if(0==l||o.length%l!=0||o.length/l<a+s+1||!(1&t))throw m.a.Error(587534800,"list of points for invalid for measuring distance");const d=new Float32Array(o.length/l),h=a*l,c=(o.length-s*l-h)/l,u=2&t;let p=r||0;for(let e=0;e<c;e++){const t=h+e*l;if(2!=(u?o[t+2]:1)&&(d[a+e]=p,i||e<c-1)){const r=h+(e+1)%c*l,n=u?o[r+2]:1;if(2!=n){let e=o[r]-o[t],i=o[r+1]-o[t+1];p+=Math.sqrt(e*e+i*i)}else if(2==n&&(i||e<c-2)){const i=h+(e+2)%c*l;let n=o[t],a=o[t+1],s=o[r],d=o[r+1],u=o[i],m=o[i+1];p+=Object(f.m)(n,a,s,d,u,m)}}}const g=p-r;for(let e=0;e<a;e++)d[e]=d[a+c-a+e]-g;for(let e=a+c;e<o.length/l;e++)d[e]=d[e+a-(a+c)]+g;for(let e=0;e<c;e++){const t=h+e*l;if(u&&2==o[t+2]){const t=0==a&&0==e?c-1:a+e-1,i=0==s&&e==c-1?a:a+e+1;d[a+e]=.5*(d[t]+d[i])}}return{distanceArray:d,endDistance:p}}var ie=i(34);class re{constructor(e,t,i,r,n,a,s,o){this.m_renderer=t,this.pathIndexRange=i,this.fillMode=r,this.distRangeSize=0,this.contentQuality=0,this.enableMipMap=!1,this.mergeMode=0,this.distanceFieldMode=a,this.scenario=e,this.releasePolicy=s,this.isDisplacementMap=o}get size(){return this.texture?this.texture.size:f.e.Zero}refresh(e,t,i){const r=e,n=r.getGraphicsProcessor();if(!n)throw m.a.Error(591524387,"Graphics processor not initialized");const a=ie.a.readBooleanOrDefault("forceRefreshDistanceField",!1);if(!i&&!a&&this.geometryUniqueId==t.geometryTracker.currentUniqueId&&this.texture&&this.texture.isValidForGraphicsProcessor(n))return!0;const s=this.getContentBounds(t);if(!s)return m.a.Error(570959637,"Shape has no bounds"),this.texture&&this.texture.release(),!1;const o=this.getQualityToUse(t),l=this.getPixelPaddingInShapeUnits(t),d=s.size.scale(o).add(new f.e(2*l*o,2*l*o)),h=this.enableMipMap?new f.e(Object(f.j)(d.x),Object(f.j)(d.y)):d.ceil(),c=h.scale(Math.min(1,R.f/h.x,R.f/h.y)).ceil(),u=new f.e(Object(f.g)(c.x,16,R.f),Object(f.g)(c.y,16,R.f)),p=this.texture;if(this.texture=R.a.RecycleOrReplace(this.scenario,p,e,u,this.isDisplacementMap,5,!0,this.releasePolicy),!this.texture||!this.texture.graphicsProcessor)return!1;if(i&&p!=this.texture)return m.a.Error(591524416,"Cannot update incrementally: texture had to be recreated"),!1;const g=o*Math.min(u.x/d.x,u.y/d.y),_=f.c.FromSizeAndCenter(u.scale(1/g),s.center),v=l*g/o;return this.rasterize(t,i,_,g,v,r.getCurrentFramePerformanceSummary()),!0}getQualityToUse(e){return this.qualityOverride?this.qualityOverride:e.hasSmallDetails()?2*R.g:R.g}getContentBounds(e){if(this.contentBoundsOverride)return this.contentBoundsOverride;const t=e.incrementalPath?e.incrementalPath.bounds:Object(s.k)(e,1!=this.distanceFieldMode);if(!t)return;const i=t.size;if(!isFinite(i.x)||!isFinite(i.y))return void m.a.Error(562151697,`Invalid shape bounds for SDF: ${i.x} x ${i.y}, scenario: ${this.scenario}`);const r=e.transform.scale;if(isFinite(r.x)&&isFinite(r.y))return t.multiply(r.abs());m.a.Error(562151698,`Invalid shape scale for SDF: ${r.x} x ${r.y}, scenario: ${this.scenario}`)}getFillBrightness(){return 2==this.fillMode?.4:3==this.fillMode?.2:4==this.fillMode?-.4:5==this.fillMode?-.2:0}getPixelPaddingInShapeUnits(e){var t;if(null!=this.paddingOverride)return this.paddingOverride;const i=ie.a.readNumberOrDefault("maxReasonableZoomOut",10);if(e.style.hasLine){const r=null!==(t=e.style.hitTestSlop)&&void 0!==t?t:a.t;return Math.ceil(Math.max(r/2,i))}return i}rasterize(e,t,i,r,n,o){if(!this.texture||!this.texture.graphicsProcessor)return m.a.Error(591524418,"No gl texture or context"),!1;const l=e.transform.scale.abs();let d=Object(s.k)(e,!1,f.b.Scale2D(l).multiply(new f.d(i.center.negate(),e.transform.scale.sign(),0,i.center).toMatrix3()));if(!d)return m.a.Error(591524420,"Nothing to render"),!1;const h=new f.e(r,r),c=i.size,u=this.size.scale(.5),p=new f.d(i.center.negate(),h,0,u),g=i.transformedBounds(p),_=d.transformedBounds(p);if(!g||!_)return m.a.Error(588006216,"Nothing to render"),!1;if(this.contentQuality=r,this.localBounds=i?i.multiply(l.inverse()):void 0,this.renderScale=h.divide(this.size),this.uvScale=c.multiply(this.renderScale).multiply(e.transform.scale.sign()),this.texture.contentLocation={logicalCenter:_.center,logicalSize:_.size,physicalCenter:g.center,physicalSize:g.size,rotation:0,flipX:e.transform.scale.x<0,flipY:e.transform.scale.y<0},!this.localBounds||!this.renderScale)return m.a.Error(591524421,"no bounds or renderScale"),!1;o.pixelCountDistanceField+=Math.floor(this.size.x*this.size.y);const b=a.a==a.e;let S=.5*(e.style.pen?e.style.pen.adjustedLineWidth*(1+Math.min(Math.abs(Object(s.m)(e.style.pen)),1)):0);if(this.isDisplacementMap&&e.shape3D){let t=.5*Math.max(e.shape3D.topBevel?e.shape3D.topBevel.size.x:0,e.shape3D.bottomBevel?e.shape3D.bottomBevel.size.x:0,e.shape3D?.5*e.shape3D.adjustedContourWidth:0);S=Math.max(S,2*t-S)}return this.distRangeSize=b?Math.max(c.x/2,c.y/2):Math.max(S,n),function(e,t,i,r,n,s,o,l,d,h,c,u,p){const g=performance.now(),_=i.texture;if(!_)return m.a.Error(572842049,"DistanceFieldTexture not initialized"),!1;let b,S=c?void 0:y.b.Transparent;if(r.paths&&!r.incrementalPath)b=ve(e,t,r.paths,r.style.hasLine?r.style.pen:void 0,!1,1!=d,2==d,r.transform.scale,n,u,p,!!i.isGlyphCache,!!i.isGlyphCacheDisabled);else if(r.incrementalPath){const a=_.tag,s=a&&a.incrementalPathTrackerId==r.incrementalPath.changeTracker.trackerId;(!s||a&&(0==a.figureCount||1==a.figureCount&&0==a.lastFigurePointCount))&&(S=y.b.Transparent);const o=s&&a.figureCount>0?a.figureCount-1:0,l=[];for(let e=o;e<r.incrementalPath.figures.length;e++){const t=r.incrementalPath.figures[e],i=s&&e==o&&a.lastFigurePointCount>0?a.lastFigurePointCount-1:0,n=t.getPointCount();l.push(new x.a(t.data.slice(i*r.incrementalPath.pointDataSize,n*r.incrementalPath.pointDataSize),!1,r.incrementalPath.format))}_.tag={incrementalPathTrackerId:r.incrementalPath.changeTracker.trackerId,figureCount:r.incrementalPath.figures.length,lastFigurePointCount:r.incrementalPath.figures.length>0?r.incrementalPath.figures[r.incrementalPath.figures.length-1].getPointCount():0};b=ve(e,t,[new x.c({figures:l,fillMode:0})],r.style.hasLine?r.style.pen:void 0,!1,1!=d,2==d,r.transform.scale,n,u,p,!!i.isGlyphCache,!!i.isGlyphCacheDisabled)}if(!b)return m.a.Error(592525084,"Nothing to render"),!1;const T=e.activateShaderProgram(0);T.begin(_.tryGetBabylonTextureForRenderToTexture(e),S,!1);const w=T.getBabylonEffect();w.setVector2("u_0",s.center.multiply(r.transform.scale)),w.setVector2("u_1",r.transform.scale),w.setVector2("u_2",o),w.setFloat("u_3",h),w.setFloat("ufrag_10",r.style&&r.style.pen?2*h/(r.style.pen.adjustedLineWidthForArrowHead+1):0),w.setFloat("ufrag_11",r.transform.scale.x*r.transform.scale.y),w.setInt("ufrag_7",a.a),w.setInt("u_13",a.a),w.setInt("u_15",0==r.style.pen.compoundType?0:1),w.setVector2("u_17",r.style.pen.tipScale?r.style.pen.tipScale:f.e.One),w.setInt("u_18",r.style.pen.tipType?r.style.pen.tipType:0);const M=(r.style.pen.adjustedLineWidth/2+1/i.contentQuality)/(2*h);w.setFloat("ufrag_15",0==r.style.pen.alignment?M:2*M);for(const e of b.transformedPaths){const i=ge(l);if(i)for(let n=i.start;n<=i.last;n++)_e(n,!0,e,l,u)&&(be(T,n,!0,r),2==n?T.drawQuads(1):Se(T,n,!0,r,[e],l,d,u,t.getCurrentFramePerformanceSummary(),h,null!=r.shape3D))}const C=function(e){return 1==e?v.j.FromFirstLast(0,0):v.j.FromFirstLast(0,a.a==a.c||a.a==a.f?0:2)}(l);if(C)for(let e=C.start;e<=C.last;e++)be(T,e,!1,r),2==e?T.drawQuads(1):Se(T,e,!1,r,b.transformedPaths,l,d,u,t.getCurrentFramePerformanceSummary(),h,null!=r.shape3D);if(T.end(),R.l&&ae&&b.cachedGlyphsPages.length>0){const t=e.activateShaderProgram(5);if(t.begin(_.tryGetBabylonTextureForRenderToTexture(e),void 0,!1),ye(t,0,0),i.localBounds&&i.uvScale)for(const r of b.cachedGlyphsPages)if(r.cachedGlyphInstances.length>0){const n=new Array(r.cachedGlyphInstances.length),a=new Array(r.cachedGlyphInstances.length);for(let e=0;e<r.cachedGlyphInstances.length;e++){const t=r.cachedGlyphInstances[e];n[e]=t.srcRect,a[e]=t.dstRect.translate(i.localBounds.center.negate()).multiply(_.size.multiply(i.uvScale).multiply(i.localBounds.size.inverse())).translate(_.size.scale(.5))}const s=ae[r.page].texture;s?Object(R.h)(e,t,s,n,a,_.size,0,ae[r.page].distRangeSize/i.distRangeSize*(r.cachedGlyphInstances[0].dstRect.size.y/r.cachedGlyphInstances[0].srcRect.size.y)):m.a.Error(572867297,"glyphPageTexture missing")}t.end()}return _.renderCost=performance.now()-g,!0}(this.texture.graphicsProcessor,this.m_renderer,this,e,this.pathIndexRange,this.localBounds,this.renderScale,this.mergeMode,this.distanceFieldMode,this.distRangeSize,t,1==this.generateDrawFadeMask,this.isDisplacementMap)&&(this.geometryUniqueId=e.geometryTracker.currentUniqueId,this.lastKnownQualitySetting=R.g,this.lastKnownLineWidth=e.style.pen.adjustedLineWidth,this.lastKnownLineWidthForArrowHead=e.style.pen.adjustedLineWidthForArrowHead,this.lastKnownHitTestSlop=a.t,this.enableMipMap&&this.texture.generateMipMap()),!1}}function ne(e){return e?e.fontId+":"+e.glyphId:void 0}let ae,se={},oe=[],le=0;function de(){for(let e of ae||[])e.texture&&e.texture.release();ae=void 0,se={},oe=[]}function he(){return le-16}function ce(){return he()/16}function ue(){return 7*ce()/8}function fe(){return ce()/16}const me=[{attributeName:"a_p0",attributeSize:4,offset:0},{attributeName:"a_p1",attributeSize:4,offset:16},{attributeName:"a_p2",attributeSize:4,offset:32},{attributeName:"a_p3",attributeSize:4,offset:48},{attributeName:"a_p4",attributeSize:4,offset:64}],pe=[{attributeName:"a_d1",attributeSize:1,offset:4},{attributeName:"a_d2",attributeSize:1,offset:8}];function ge(e){if(1==e)return v.j.FromFirstLast(0,3)}function _e(e,t,i,r,n){return!(n&&0!=e||1!=r&&t||0!=e&&0==i.fillMode)}function ve(e,t,i,r,n,a,s,o,l,d,h,c,u){const p=[],g=[];if(0==i.length)return{transformedPaths:p,cachedGlyphsPages:g};l&&(l.start<0||l.last>=i.length)&&m.a.Error(592525078,"pathIndexRange out of range");const _=l?Math.max(l.start,0):0,v=l?Math.min(l.last,i.length-1):i.length-1,y=r&&(Object(J.c)(r.headEnd,r.adjustedLineWidthForArrowHead)>0||Object(J.c)(r.tailEnd,r.adjustedLineWidthForArrowHead)>0),b=d||!!r&&0!=r.dashType||y,S=R.l&&!r;for(let l=_;l<=v;l++){const d=i[l];if(h&&!d.extrusionEnabled)continue;const _=d.transform.scale.x>=ue()/4096;d.glyphCacheId?c?t.getCurrentFramePerformanceSummary().glyphCountAddedToCache++:(t.getCurrentFramePerformanceSummary().glyphCount++,_&&t.getCurrentFramePerformanceSummary().glyphCountLargeText++,null!=r&&t.getCurrentFramePerformanceSummary().glyphCountTextOutline++):t.getCurrentFramePerformanceSummary().pathCount++;let v=!1;const y=ne(d.glyphCacheId);if(!u&&y&&S&&ae&&0==d.transform.rotation&&Math.abs(d.transform.scale.x-d.transform.scale.y)<f.h&&!_&&se[y]){const e=se[y];if(e.page<0||e.page>=ae.length)m.a.Error(592525079,"Invalid glyph page");else{const i=ae[e.page];if(i.texture){const r=i.localBounds?i.localBounds.center:void 0,n=i.localBounds&&r&&i.uvScale?i.localBounds.translate(r.negate()).multiply(i.uvScale.inverse()).translate(r):void 0,a=i.localBounds&&n&&i.uvScale?e.bounds.multiply(i.uvScale).translate(n.leftTop.negate()):void 0,s=e.bounds.translate(e.offset.negate()).multiply(new f.e(1/e.scale,1/e.scale)).transformedBounds(d.transform);if(a)if(s)if(a.right<0||a.bottom<0||a.left>=he()||a.top>=he())m.a.Error(592525082,"Cached glyph src rect out of bounds");else{const i={srcRect:a,dstRect:s,distanceScale:1};let r;for(let t=0;t<g.length&&!r;t++)g[t].page==e.page&&(r=g[t]);r||(r={page:e.page,cachedGlyphInstances:[]},g.push(r)),r.cachedGlyphInstances.push(i),v=!0,t.getCurrentFramePerformanceSummary().glyphCountReadFromCache++}else m.a.Error(592525081,"Cached glyph dst rect undefined");else m.a.Error(592525080,"Cached glyph src rect undefined")}else m.a.Error(572867295,"Glyph page texure missing")}}if(!v){d.glyphCacheId&&!c&&t.getCurrentFramePerformanceSummary().glyphCountRenderedAsPath++;const i=t.ensurePathRenderData(d);i.refreshCachedHwTapeBuffers(d,e);let l,u=i.tapeBuffers,m=0;if(!u||b||n)if(b||n){const e=Q(d,4096,n,b,b?f.b.FromTransforms(d.transform,f.b.Scale2D(o)):void 0);u=e.buffers,l=e.distanceBuffers,m=e.endDistance}else u=i.refreshCachedTapeBuffers(d);const g=e.getBabylonEngine();let _,v=i.hwTapeBuffers;v||(v=u.map(e=>g.createVertexBuffer(e))),l&&(_=l.map(e=>g.createVertexBuffer(e)));const y=d.transform.toMatrix3(),S={tapeBuffers:u,hwTapeBuffers:v,hwDistanceBuffers:_,fillMode:h?1:s?0:d.fillMode,lineEnabled:a&&d.lineEnabled,isArrowHead:!1,transform:y,startDistance:0,endDistance:m};if(p.push(S),s&&r&&(0!=r.headEnd.end||0!=r.tailEnd.end)){const e=r.adjustedLineWidthForArrowHead,t=y.multiply(f.b.Scale2D(o)),i=f.b.Scale2D(o.inverse());for(const n of d.figures){const a=n.isClosed||n.isLastPointDuplicated();if(r.headEnd&&0!=r.headEnd.end&&!a){const a=Object(J.a)(r.headEnd,e);if(a){const s=Object(J.b)(n,!1,r.headEnd,e,t),o=Q(x.c.CreateFromFigure(a),4096).buffers;p.push({tapeBuffers:o,hwTapeBuffers:o.map(e=>g.createVertexBuffer(e)),hwDistanceBuffers:void 0,fillMode:5==r.headEnd.end?0:1,lineEnabled:!0,isArrowHead:!0,transform:s?s.multiply(i):void 0,startDistance:0,endDistance:0})}}if(r.tailEnd&&0!=r.tailEnd.end&&!a){const a=Object(J.a)(r.tailEnd,e);if(a){const s=Object(J.b)(n,!0,r.tailEnd,e,t),o=Q(x.c.CreateFromFigure(a),4096).buffers;p.push({tapeBuffers:o,hwTapeBuffers:o.map(e=>g.createVertexBuffer(e)),hwDistanceBuffers:void 0,fillMode:5==r.tailEnd.end?0:1,lineEnabled:!0,isArrowHead:!0,transform:s?s.multiply(i):void 0,startDistance:0,endDistance:0})}}}}}}return{transformedPaths:p,cachedGlyphsPages:g}}function ye(e,t,i){const r=e.getBabylonEngine();0==t?(r.setColorWrite(!0),r.depthCullingState.depthMask=!0,r.stencilState.stencilTest=!1,r.stencilState.stencilMask=255,r.stencilState.stencilFunc=519,r.stencilState.stencilFuncRef=0,r.stencilState.stencilFuncMask=3,r.alphaState.alphaBlend=!0,r.alphaState.setAlphaBlendFunctionParameters(1,1,1,1),r.alphaState.setAlphaEquationParameters(32776,32776),r.clear(null,!1,!1,!0)):1==t?(r.setColorWrite(!1),r.depthCullingState.depthMask=!1,r.stencilState.stencilTest=!0,r.stencilState.stencilMask=255,r.stencilState.stencilFunc=519,r.stencilState.stencilFuncRef=1,r.stencilState.stencilFuncMask=255):(r.setColorWrite(!0),r.depthCullingState.depthMask=!0,r.stencilState.stencilMask=0,2==t?(r.stencilState.stencilTest=!0,r.stencilState.stencilFunc=517,r.stencilState.stencilFuncRef=0,r.stencilState.stencilFuncMask=1==i?255:3,r.alphaState.alphaBlend=!0,r.alphaState.setAlphaBlendFunctionParameters(775,769,773,771),r.alphaState.setAlphaEquationParameters(32774,32774)):3==t&&(r.stencilState.stencilTest=!1,r.alphaState.alphaBlend=!0,r.alphaState.setAlphaBlendFunctionParameters(772,1,0,0),r.alphaState.setAlphaEquationParameters(32774,32774)))}function be(e,t,i,r){let n=i&&!(3==t);ye(e,t,r.overlapMode);const a=e.getBabylonEffect();a.setInt("u_7",t),a.setInt("ufrag_0",t),a.setFloat("ufrag_8",n?1:0);let s=0;const o=we(r.style.pen);if(o&&o.length>0)for(let e=0;e<o.length;e++)s+=o[e];0==s&&(s=1);const l=0==r.style.pen.headEnd.cap?1:0;a.setFloat("ufrag_5",o&&o.length>0?.5-(o[0]-l)/(2*s):0),a.setFloat("ufrag_4",o&&o.length>0?1/(s*r.style.pen.adjustedLineWidth):0)}function Se(e,t,i,r,n,s,o,l,d,h,c){if(0==t&&a.a==a.d)return;let u=-performance.now();const m=e.getBabylonEffect(),p=e.getBabylonEngine();m.setFloat("u_12",r.style.pen.adjustedLineWidth),m.setFloat("u_5",r.style.pen.miterLimit);let g=0;const _=we(r.style.pen),v=_?_.length:0;if(r.style.pen&&_){for(let e=0;e<v;e++)g+=_[e];g=g>0?g:1,m.setFloat("ufrag_12",g/2),m.setFloat4("ufrag_13",v>=2?_[0]/2:g,v>=3?_[0]/2+_[1]:g,v>=4?_[0]/2+_[1]+_[2]:g,v>=5?_[0]/2+_[1]+_[2]+_[3]:g)}else m.setFloat("ufrag_12",.5),m.setFloat4("ufrag_13",1,1,1,1);m.setFloat("u_14",n.length>0&&n[0].isArrowHead||0==r.style.pen.headEnd.cap?1:0);for(const a of n){if(!_e(t,i,a,s,l))continue;const d=(0!=a.fillMode||2==o)&&2==o==a.isArrowHead&&(0==s||1==s&&i),u=a.lineEnabled&&!a.isArrowHead,g=a.isArrowHead&&0==a.fillMode,_=g?u:d,v=g?d:u;m.setMatrix3x3("u_8",a.transform?a.transform.m:f.b.Identity.m),m.setInt("ufrag_17",l?1:0),l&&m.setFloat("ufrag_12",1/a.endDistance),m.setFloat("ufrag_19",a.isArrowHead&&0==a.fillMode&&h?r.style.pen.adjustedLineWidth/4/h:0);const y=n.length>0&&a.isArrowHead||c?1:r.style.pen?r.style.pen.lineJoin:0;m.setInt("u_4",y),m.setInt("ufrag_1",y);for(let i=0;i<a.tapeBuffers.length;i++){const n=a.tapeBuffers[i],s=a.hwTapeBuffers[i],o=a.hwDistanceBuffers?a.hwDistanceBuffers[i]:void 0,l=n.length/4-4;if(p.bindInstancesBuffer(s,me,!1),o?(m.setInt("u_19",0),p.bindInstancesBuffer(o,pe,!1)):(m.setInt("u_19",1),e.setDummyPointerAttribute("a_d1"),e.setDummyPointerAttribute("a_d2")),0==n[2]&&a.startDistance!=a.endDistance){const e=Object(J.c)(r.style.pen.headEnd,r.style.pen.adjustedLineWidthForArrowHead),t=Object(J.c)(r.style.pen.tailEnd,r.style.pen.adjustedLineWidthForArrowHead);m.setFloat2("ufrag_16",a.startDistance+e,a.endDistance-t)}else m.setFloat2("ufrag_16",0,0);m.setFloat("ufrag_2",_?1:0),m.setFloat("ufrag_3",v?1:0),m.setFloat("ufrag_18",g?1:0),1==t?(m.setFloat("ufrag_6",1),e.setDistanceFieldStencilSumIncrement(!0),e.drawQuadInstances(l),m.setFloat("ufrag_6",-1),e.setDistanceFieldStencilSumIncrement(!1),e.drawQuadInstances(l)):e.drawQuadInstances(l)}}e.disableInstanceAttribute("a_p0"),e.disableInstanceAttribute("a_p1"),e.disableInstanceAttribute("a_p2"),e.disableInstanceAttribute("a_p3"),e.disableInstanceAttribute("a_p4"),e.disableInstanceAttribute("a_d1"),e.disableInstanceAttribute("a_d2"),u+=performance.now(),d.drawTapeCostMs+=u}function Te(e,t,i,r){const n=oe[t],a=[];for(const e of n)r&&e.ready||(a.push(e.path),e.ready=!0);if(a.length>0){const t=new s.e(a);return t.style.pen.lineWidth=fe(),t.overlapMode=1,i.refresh(e,t,r)}return!0}function we(e){if(1!=e.tipType)return e.dashType>=0&&e.dashType<Me.length?Me[e.dashType]:void m.a.Error(591192836,"unsupported dashType")}const Me=[null,new Float32Array([3,1]),new Float32Array([1,1]),new Float32Array([3,1,1,1]),new Float32Array([3,1,1,1,1,1]),new Float32Array([1,3]),new Float32Array([4,3]),new Float32Array([8,3]),new Float32Array([4,3,1,3]),new Float32Array([8,3,1,3]),new Float32Array([8,3,1,3,1,3])];class Ce{constructor(){this.m_compatibleGraphicsProcessorId=0}get tapeBuffers(){return this.m_tapeBuffers}get hwTapeBuffers(){return this.m_hwTapeBuffers}releaseGeneratedResources(){if(this.m_hwTapeBuffers&&this.m_engine)for(const e of this.m_hwTapeBuffers)this.m_engine._releaseBuffer(e);this.m_hwTapeBuffers=void 0}onFinalization(){}refreshCachedTapeBuffers(e){return this.m_tapeBuffers||(this.m_tapeBuffers=Q(e,4096).buffers),this.m_tapeBuffers}refreshCachedHwTapeBuffers(e,t){if(!this.m_hwTapeBuffers||!this.m_engine||this.m_compatibleGraphicsProcessorId!=t.getUniqueGraphicsProcessorId()){const i=Q(e,4096,!1,!1,void 0),r=t.getBabylonEngine();this.m_hwTapeBuffers=i.buffers.map(e=>r.createVertexBuffer(e)),this.m_compatibleGraphicsProcessorId=t.getUniqueGraphicsProcessorId(),this.m_engine=t.getBabylonEngine()}return this.m_hwTapeBuffers}}class Ie{constructor(e,t){this.m_state=e,this.m_texture=t}getState(){return this.m_state}getSize(){return this.m_texture?this.m_texture.size:void 0}getLogicalCenter(){return this.m_texture&&this.m_texture.contentLocation?this.m_texture.contentLocation.logicalCenter:void 0}tryConvertToBufferRGBA(){return this.m_texture instanceof R.a?this.m_texture.tryConvertToBufferRGBA():void 0}}class Pe{constructor(){this.m_state=0}releaseGeneratedResources(){this.m_texture&&(this.m_texture.release(),this.m_state=2)}onFinalization(){}get texture(){return this.m_texture}get loader(){return this.m_loader}set texture(e){this.m_loader&&(this.m_loader.release(),this.m_loader=void 0),this.m_texture=e,this.m_state=1}set loader(e){this.m_texture&&(this.m_texture=void 0),this.m_loader&&this.m_loader!=e&&this.m_loader.release(),this.m_loader=e,this.m_state=1}get state(){return this.m_state}}const Ee=new f.e(1024,1024);function xe(e){const t=e.gradientStops.length,i=new Float32Array(t+2),r=new Float32Array(4*(t+2));for(let n=0;n<t+2;n++){const a=Math.min(Math.max(n-1,0),t-1),s=e.gradientStops[a].color;i[n]=0==n?0:n==t+1?1:e.gradientStops[a].position,r[4*n+0]=s.r,r[4*n+1]=s.g,r[4*n+2]=s.b,r[4*n+3]=s.a}return{stops:i,colors:r}}const Ae=[{attributeName:"a_p1",attributeSize:4,offset:16},{attributeName:"a_p2",attributeSize:4,offset:32}],ke=new f.e(8,8),Re=[[255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[3,0,3,0,3,0,3,0,3,0,3,0,3,0,3,0],[7,64,29,0,116,0,208,1,64,7,0,29,0,116,1,208],[1,208,0,116,0,29,64,7,208,1,116,0,29,0,7,64],[255,255,3,0,3,0,3,0,3,0,3,0,3,0,3,0],[7,208,29,116,116,29,208,7,208,7,116,29,29,116,7,208],[3,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0],[3,0,0,0,0,3,0,0,3,0,0,0,0,3,0,0],[3,3,0,0,48,48,0,0,3,3,0,0,48,48,0,0],[3,3,48,48,3,3,48,48,3,3,48,48,3,3,48,48],[51,51,12,12,51,51,192,192,51,51,12,12,51,51,192,192],[51,51,204,204,51,51,204,192,51,51,204,204,51,51,192,204],[51,51,204,204,51,51,204,204,51,51,204,204,51,51,204,204],[63,63,204,204,243,243,204,204,63,63,204,204,243,243,204,204],[252,252,207,207,252,252,207,207,252,252,207,207,252,252,207,207],[252,252,255,255,207,207,255,255,252,252,255,255,207,207,255,255],[63,255,255,255,255,63,255,255,63,255,255,255,255,63,255,255],[255,255,255,255,255,255,255,252,255,255,255,255,255,255,252,255],[3,3,12,12,48,48,192,192,3,3,12,12,48,48,192,192],[192,192,48,48,12,12,3,3,192,192,48,48,12,12,3,3],[15,15,60,60,240,240,195,195,15,15,60,60,240,240,195,195],[240,240,60,60,15,15,195,195,240,240,60,60,15,15,195,195],[15,192,63,0,252,0,240,3,192,15,0,63,0,252,3,240],[3,240,0,252,0,63,192,15,240,3,252,0,63,0,15,192],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[255,255,0,0,0,0,0,0,255,255,0,0,0,0,0,0],[204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204],[255,255,0,0,255,255,0,0,255,255,0,0,255,255,0,0],[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[255,255,255,255,0,0,0,0,255,255,255,255,0,0,0,0],[0,0,0,0,3,3,12,12,48,48,192,192,0,0,0,0],[0,0,0,0,192,192,48,48,12,12,3,3,0,0,0,0],[255,0,0,0,0,0,0,0,0,255,0,0,0,0,0,0],[3,0,3,0,3,0,3,0,0,3,0,3,0,3,0,3],[3,0,0,3,12,0,0,48,192,0,0,192,48,0,0,12],[243,192,240,0,0,240,192,243,207,3,15,0,0,15,3,207],[3,192,12,48,48,12,192,3,3,192,12,48,48,12,192,3],[0,0,192,3,48,204,15,0,0,0,192,3,48,204,15,0],[0,192,0,48,0,12,0,3,192,3,48,12,12,48,3,192],[255,255,3,0,3,0,3,0,255,255,0,3,0,3,0,3],[3,3,204,12,48,48,12,204,3,3,192,12,48,48,204,192],[51,51,204,204,51,51,204,204,255,0,255,0,255,0,255,0],[0,0,192,0,0,3,192,0,0,0,3,0,0,192,3,0],[51,51,0,0,3,0,0,0,3,0,0,0,3,0,0,0],[3,0,0,0,48,48,0,0,0,3,0,0,48,48,0,0],[0,240,3,12,12,3,240,0,0,15,0,48,0,192,0,192],[255,255,60,60,255,255,195,195,255,255,60,60,255,255,195,195],[252,252,3,195,3,255,3,255,252,252,195,3,255,3,255,3],[255,255,3,3,3,3,3,3,255,255,3,3,3,3,3,3],[195,195,60,60,60,60,195,195,195,195,60,60,60,60,195,195],[255,0,255,0,255,0,255,0,0,255,0,255,0,255,0,255],[3,48,12,12,48,3,192,0,48,3,12,12,3,48,0,192],[192,0,240,3,252,15,255,63,252,15,240,3,192,0,0,0]];var Oe;!function(e){e[e.fromBegining=0]="fromBegining",e[e.distanceFieldsReady=1]="distanceFieldsReady",e[e.brushTexturesReady=2]="brushTexturesReady",e[e.fadeReady=3]="fadeReady",e[e.effectsReady=4]="effectsReady"}(Oe||(Oe={}));class Le{constructor(){this.initTextureStage=Oe.fromBegining,this.fadeMode=0,this.spriteQuality=0,this.spriteHitTest=!1,this.isBlankSlate=!1}get resolvedFillTexture(){var e;return this.fillTexture instanceof R.b?this.fillTexture:null===(e=this.fillTexture)||void 0===e?void 0:e.loader.getTexture(this.fillTexture.wrapMode)}get resolvedLineTexture(){var e;return this.lineTexture instanceof R.b?this.lineTexture:null===(e=this.lineTexture)||void 0===e?void 0:e.loader.getTexture(this.lineTexture.wrapMode)}get resolvedPictureTexture(){var e;return this.pictureTexture instanceof R.b?this.pictureTexture:null===(e=this.pictureTexture)||void 0===e?void 0:e.loader.getTexture(this.pictureTexture.wrapMode)}beforeInitTextures(e,t){if(this.isBlankSlate=!1,this.clientData=e.clientData,this.hasInvalidTexture(t)&&this.clearTextures(),this.checkDistanceFields(e),this.lastKnownShapeVersion==e.version&&e.alphaTracker.version==this.lastKnownAlphaVersion||(this.clearEffectsTextures(this.lastKnownShapeVersion!=e.version,e.alphaTracker.version!=this.lastKnownAlphaVersion),this.drawDistribution=void 0),this.lastKnownShapeVersion=e.version,this.lastKnownAlphaVersion=e.alphaTracker.version,1==e.getType()){const t=e;t.geometryTracker.version!=this.lastKnownGeometryVersion&&(this.initTextureStage=Oe.fromBegining,this.lastKnownGeometryVersion=t.geometryTracker.version)}}getFulltextureList(){const e=[this.resolvedFillTexture,this.resolvedLineTexture,this.resolvedPictureTexture,this.innerShadowTexture,this.softEdgesTexture,this.glowTexture,this.shadowTexture,this.reflectionTexture,this.fadeTexture,this.spriteTexture];for(let t of this.distanceFields||[])e.push(t.texture);return this.coutoutLayer&&e.push(this.coutoutLayer.texture),e}getBevelDistanceField(){for(let e of this.distanceFields||[])if(e.isDisplacementMap)return e}hasInvalidTexture(e){const t=this.getFulltextureList();for(let e of this.distanceFields||[])t.push(e.texture);for(let i of t)if(i&&!i.isValidForGraphicsProcessor(e))return!0;return!1}checkDistanceFields(e){if(1==e.getType()){const t=e;for(let e of this.distanceFields||[])if(e.geometryUniqueId!=t.geometryTracker.currentUniqueId||e.lastKnownQualitySetting!=R.g||e.lastKnownLineWidth!=t.style.pen.adjustedLineWidth||e.lastKnownLineWidthForArrowHead!=t.style.pen.adjustedLineWidthForArrowHead||e.lastKnownHitTestSlop!=a.t)return void this.clearTextures()}}clearBounds(){this.initTextureStage=Oe.fromBegining}clearEffectsTextures(e,t){this.initTextureStage=Oe.fromBegining,e&&(this.reflectionTexture&&this.reflectionTexture.release(),this.fadeTexture&&this.fadeTexture.release(),this.spriteTexture&&this.spriteTexture.release(),this.reflectionTexture=this.fadeTexture=this.spriteTexture=void 0),t&&(this.innerShadowTexture&&this.innerShadowTexture.release(),this.softEdgesTexture&&this.softEdgesTexture.release(),this.glowTexture&&this.glowTexture.release(),this.shadowTexture&&this.shadowTexture.release(),this.innerShadowTexture=this.softEdgesTexture=this.glowTexture=this.shadowTexture=void 0)}clearBrushTextures(){var e,t,i,r,n,a;this.fillTexture instanceof R.b&&1==this.fillTexture.releasePolicy&&(this.fillTexture.release(),this.fillTexture=void 0),this.lineTexture instanceof R.b&&1==this.lineTexture.releasePolicy&&(this.lineTexture.release(),this.lineTexture=void 0),this.pictureTexture instanceof R.b&&1==this.pictureTexture.releasePolicy&&(this.pictureTexture.release(),this.pictureTexture=void 0),(null===(e=this.fillLookupTableCache)||void 0===e?void 0:e.texture)&&(null===(t=this.fillLookupTableCache)||void 0===t||t.texture.release(),this.fillLookupTableCache=void 0),(null===(i=this.lineLookupTableCache)||void 0===i?void 0:i.texture)&&(null===(r=this.lineLookupTableCache)||void 0===r||r.texture.release(),this.lineLookupTableCache=void 0),(null===(n=this.pictureLookupTableCache)||void 0===n?void 0:n.texture)&&(null===(a=this.pictureLookupTableCache)||void 0===a||a.texture.release(),this.pictureLookupTableCache=void 0)}clearTextures(){this.initTextureStage=Oe.fromBegining;for(let e of this.distanceFields||[])e&&e.texture&&e.texture.release();this.clearBrushTextures(),this.clearEffectsTextures(!0,!0),this.distanceFields=void 0}releaseGeneratedResources(){var e;this.clearBounds(),this.clearTextures(),this.isBlankSlate=!0,this.coutoutLayer&&(null===(e=this.coutoutLayer.texture)||void 0===e||e.release(),this.coutoutLayer=void 0)}initFadeTexture(e,t,i){var r,n,a,o;if(!e.getGraphicsProcessor())return;const l=i?13==i.preset?t.changeTracker.currentUniqueId:i.param+":"+i.preset:"";if(!this.fadeTexture||i&&0!=i.preset&&this.fadeTexture.isValid(e)&&this.fadeTexture.tag==l||(this.fadeTexture.release(),this.fadeTexture=void 0),!this.fadeTexture)if(1==t.getType()&&i&&13==i.preset){const l=t,d=l.style.pictureBrush,h=d?e.getTextureFromImageBrush(d):void 0;if(d&&h){const t=R.a.RecycleOrReplace("PictureDrawFade",void 0,e,h.size,!0,5,!1,1,4);t.originalSize=h.originalSize;const l=Object(s.i)(d.alignment),c=new f.d(l.negate(),d.scale,0,l.add(d.offset)),u=new f.d(new f.e(0,-1),new f.e(1,-1)),m=f.b.FromTransforms(u,c.toInverseMatrix3(),u),p=null!==(n=null===(r=i.drawFadeOptions)||void 0===r?void 0:r.mode)&&void 0!==n?n:0,g=null!==(o=null===(a=i.drawFadeOptions)||void 0===a?void 0:a.order)&&void 0!==o?o:0,_=i.param,v=f.e.Flip(i.flipX,i.flipY),y=i.transposeXY;e.drawTextureToTexture(t,h,5,{textureTransform:m,drawMaskParams:{drawMaskMode:p,drawMaskOrder:g,drawMaskParam:_,drawMaskFlipXY:v,drawMaskTransposeXY:y}}),this.fadeTexture=t,this.fadeMode=3}else if(l.paths&&l.paths.length>0){const t=new re("FadeMask/Draw",e,void 0,1,l.mergeMode,0,1,!1);t.generateDrawFadeMask=!0,t.refresh(e,l,!1),this.fadeTexture=t.texture,this.fadeMode=2}}else i&&0!=i.preset&&13!=i.preset?(this.fadeTexture=function(e,t,i,r,n){const a=e.getGraphicsProcessor();if(!a)throw m.a.Error(592525321,"Graphics processor not initialized");const s=R.a.RecycleOrReplace("FadeMask/Standard",t,e,Ee,!1,5,!1,1);return s.tag=n,function(e,t,i,r){const n=performance.now(),a=e.activateShaderProgram(4);a.begin(t.tryGetBabylonTextureForRenderToTexture(e),y.b.Black,!1);const s=a.getBabylonEffect();s.setInt("ufrag_0",i),s.setFloat("ufrag_1",r),a.drawQuads(1),a.end(),t.renderCost=performance.now()-n}(a,s,i,r),s}(e,this.fadeTexture,i.preset,i.param,l),this.fadeMode=2):this.fadeMode=i?1:0}getBrushTexture(e){switch(e){case 0:return this.fillTexture;case 1:return this.lineTexture;case 2:return this.pictureTexture}m.a.Error(591192833,"Invalid brush source")}setBrushTexture(e,t){switch(e){case 0:this.fillTexture=t;break;case 1:this.lineTexture=t;break;case 2:this.pictureTexture=t;break;default:m.a.Error(591192834,"Invalid brush source")}}initBrushTexture(e,t,i){const r=this.getBrushTexture(i),n=function(e,t,i,r){var n,o,l,d;const h=e.getGraphicsProcessor();if(!h)return;const c=t instanceof R.b&&!t.isValidForGraphicsProcessor(h);let u=t;const p=Object(s.a)(i,r);if(p){const h=p.getType();if(6==h){const h=p;if(h.image){const g=p.wrapMode,_=void 0!==g?g:4,v=e.ensureImageRenderData(h.image);2==v.state?m.a.Error(592472275,"Trying to use deleted texture id:"+h.image.id):0==v.state&&m.a.Error(592472276,"Trying to use uninitialized texture id:"+h.image.id);const y=v.texture,b=h.pictureEffects||(i instanceof s.e&&2==r?i.style.pictureEffects:void 0);if(v.loader&&i instanceof s.e){const e=Object(s.k)(i,!1,f.b.Scale2D(i.transform.scale.abs()));let t=null!==(n=null==e?void 0:e.size.x)&&void 0!==n?n:0,r=null!==(o=null==e?void 0:e.size.y)&&void 0!==o?o:0;for(const e of i.instances||[]){const n=Object(s.k)(i,!1,e.transform.toMatrix3());t=Math.max(t,null!==(l=null==n?void 0:n.width)&&void 0!==l?l:0),r=Math.max(t,null!==(d=null==n?void 0:n.height)&&void 0!==d?d:0)}t>0&&r>0&&v.loader.prepareForRenderSize(new f.e(t,r)),u={loader:v.loader,wrapMode:_}}else!c&&t instanceof R.b&&(t==y||y&&t.tag==y.changeTracker.currentUniqueId)||(u=!(null==b?void 0:b.hasImpact)&&y&&y.wrapMode!=_?y.cloneWithNewWrapMode("ImageWrapResample",e,_,1):y);if(null==b?void 0:b.hasImpact){const n=u instanceof R.b?u:null==u?void 0:u.loader.getTexture(u.wrapMode);if(n){const s=n.changeTracker.currentUniqueId+"/"+b.changeTracker.currentUniqueId+"/"+_;if(t instanceof R.b&&!c&&t.tag==s)u=t;else{const o=e.ensureRenderNode(i).cache.ensureLookupTableTexture(e,r,b.lookupTable);u=function(e,t,i,r,n,s){var o,l;if(!e.getGraphicsProcessor())return;const d=R.a.RecycleOrReplace("PictureEffects",t,e,i.size,!1,i.format,!1,1,n);if(d.originalSize=i.originalSize,!(null===(o=null==r?void 0:r.sharpness)||void 0===o?void 0:o.hasImpact)||a.A)e.drawTextureToTexture(d,i,1,{pictureEffects:r,lookupTableTexture:s});else{const t=new R.a("PictureEffects/Sharpness/BlurIntermediateTexture",e,i.size,1);t.originalSize=i.originalSize,Object(R.d)(e,i,t,r.sharpness,d),e.drawTextureToTexture(d,t,1,{pictureEffects:r,lookupTableTexture:s}),t.release()}return(2===(null===(l=e.getBabylonEngine())||void 0===l?void 0:l.webGLVersion)||Object(R.k)(d.size.x)&&Object(R.k)(d.size.y))&&d.generateMipMap(),d}(e,t!=y&&t instanceof R.a?t:void 0,n,b,_,o),u&&(u.tag=s)}}}}else u=void 0}else if(7==h){let i=-performance.now();t&&!c&&t instanceof R.b&&t.tag==p.pattern||(u=function(e,t,i){if(!e.getGraphicsProcessor())throw m.a.Error(592525326,"Graphics processor not initialized");if(t<0||t>53)return void m.a.Error(592525327,"pattern out of range");const r=new Uint8Array(64),n=Re[t];for(let e=0;e<16;e++){const t=n[e];for(let i=0;i<4;i++){const n=(t&3<<2*i)>>2*i,a=0==n?255:1==n?127:0;r[4*e+i]=a}}const a=R.b.CreateFromByteBuffer("Pattern",e,ke,r,1,0,!1,!1,1);return a.tag=t,a}(e,p.pattern)),i+=performance.now(),e.getCurrentFramePerformanceSummary().patternTextureCostMs+=i}else if(y.a.IsGradient(h)){let r=-performance.now();if(5==h){const n=t instanceof R.a?t:void 0;n&&!c&&n.tag==i.changeTracker.currentUniqueId||(i instanceof s.e?u=function(e,t,i,r,n){const a=e.getGraphicsProcessor();if(!a)throw m.a.Error(592525324,"Graphics processor not initialized");if(5!=r.getType())throw m.a.Error(592525325,"This is not a path gradient");const o=Object(s.k)(i,!1);if(!o||o.isEmpty()||!i.paths)return;const l=o.size.multiply(i.transform.scale.abs()),d=l.scale(Math.min(1,R.f/l.x,R.f/l.y)),h=new f.e(Math.floor(d.x+1),Math.floor(d.y+1)),c=R.a.RecycleOrReplace("PathGradient",t,e,h,!1,5,!1,1);return c.tag=i.changeTracker.currentUniqueId,function(e,t,i,r,n,a){const s=performance.now(),o=xe(i),l=o.colors,d=o.colors.length<4?y.b.Transparent:new y.b(l[l.length-4],l[l.length-3],l[l.length-2],l[l.length-1]),h=e.activateShaderProgram(2);h.begin(t.tryGetBabylonTextureForRenderToTexture(e),d,!1);const c=h.getBabylonEffect(),u=h.getBabylonEngine();if(c.setInt("u_0",1),c.setVector2("u_1",n),c.setVector2("u_2",a),c.setFloatArray("bfrag_0",o.stops),c.setFloatArray4("bfrag_1",o.colors),c.setInt("ufrag_0",0),c.setInt("ufrag_3",i&&i.isGammaCorrected?1:0),c.setInt("ufrag_4",i.blendBellShape?1:0),c.setVector2("ufrag_5",i.blendBellShape||f.e.Zero),r){const e=4096;for(const t of r){const i=t.transform.toMatrix3(),r=Q(t,e,!0).buffers,n=r.map(e=>u.createVertexBuffer(e));for(let e=0;e<r.length;e++){const t=r[e].length/4-4;u.bindInstancesBuffer(n[e],Ae,!1),c.setMatrix3x3("u_3",i.m),h.drawQuadInstances(t),u._releaseBuffer(n[e])}}h.disableInstanceAttribute("a_p1"),h.disableInstanceAttribute("a_p2")}h.end(),t.renderCost=performance.now()-s}(a,c,r,i.paths,o.center,o.size.inverse()),c}(e,n,i,p):m.a.Error(592525320,"Path gradient only supported on Shape items")),r+=performance.now(),e.getCurrentFramePerformanceSummary().pathGradientTextureCostMs+=r}else{const i=t instanceof R.a?t:void 0;i&&!c&&i.tag==p.changeTracker.currentUniqueId||(u=function(e,t,i,r){const n=e.getGraphicsProcessor();if(!n)throw m.a.Error(592525322,"Graphics processor not initialized");const a=i.getType();if(2!=a&&4!=a&&3!=a)throw m.a.Error(592525323,"Unsupported Gradient type");const s=2==a||4==a,o=new f.e(R.j,s?1:R.j),l=2==a?"LinearGradient":4==a?"RectangularGradient":"RadialGradient",d=R.a.RecycleOrReplace(l,t,e,o,!1,5,!1,1);return d.tag=i.changeTracker.currentUniqueId,function(e,t,i){const r=performance.now(),n=xe(i),a=e.activateShaderProgram(2);a.begin(t.tryGetBabylonTextureForRenderToTexture(e),y.b.Black,!1);const s=a.getBabylonEffect();a.setDummyPointerAttribute("a_p1"),a.setDummyPointerAttribute("a_p2"),s.setFloatArray("bfrag_0",n.stops),s.setFloatArray4("bfrag_1",n.colors),s.setInt("u_0",0);const o=i&&3==i.getType();if(s.setInt("ufrag_0",o?1:0),s.setFloat("ufrag_6",i&&i.isGammaCorrected?2.2:1),s.setFloat("ufrag_7",i&&i.alphaGamma),i&&o){const e=i.fillToRect?i.fillToRect.center:new f.e(.5,.5),t=i.fillFromRect?e.subtract(i.fillFromRect.leftTop).divide(i.fillFromRect.size):e;s.setVector2("ufrag_2",t)}s.setInt("ufrag_4",i.blendBellShape?1:0),s.setVector2("ufrag_5",i.blendBellShape||f.e.Zero),a.drawQuads(1),a.end(),t.renderCost=performance.now()-r}(n,d,i),d}(e,i,p)),r+=performance.now(),e.getCurrentFramePerformanceSummary().gradientTextureCostMs+=r}}}else u=void 0;return t&&t!=u&&t instanceof R.b&&1==t.releasePolicy&&t.release(),u}(e,r,t,i);r!=n&&this.setBrushTexture(i,n)}initTextCutoutLayer(e,t,i){var r;if(t){this.coutoutLayer=new re("TextCutoutLayer",e,void 0,1,0,0,1,!1),this.coutoutLayer.isGlyphCacheDisabled=!0;const r=new s.e(t,i.style);this.coutoutLayer.refresh(e,r,!1);const n=Object(s.k)(r,!1);this.coutoutLayerCenter=null==n?void 0:n.center}else this.coutoutLayer&&(null===(r=this.coutoutLayer.texture)||void 0===r||r.release(),this.coutoutLayer=void 0)}updateLookupTableCache(e,t,i){let r=t;return t?t.texture&&(!i||!t.texture.isValid(e)||i&&t.lookupTable&&i!=t.lookupTable&&!i.equals(t.lookupTable))&&(t.texture.release(),t.texture=void 0):i&&(r={lookupTable:i}),r&&!r.texture&&i&&(r.texture=function(e,t,i){return R.b.CreateFromByteBuffer("LookupTable",e,t.resolution,t.table,4,4,!0,!1,1,!1,1)}(e,i)),r}ensureLookupTableTexture(e,t,i){var r,n,a;switch(t){case 0:return this.fillLookupTableCache=this.updateLookupTableCache(e,this.fillLookupTableCache,i),null===(r=this.fillLookupTableCache)||void 0===r?void 0:r.texture;case 1:return this.lineLookupTableCache=this.updateLookupTableCache(e,this.lineLookupTableCache,i),null===(n=this.lineLookupTableCache)||void 0===n?void 0:n.texture;case 2:return this.pictureLookupTableCache=this.updateLookupTableCache(e,this.pictureLookupTableCache,i),null===(a=this.pictureLookupTableCache)||void 0===a?void 0:a.texture}m.a.Error(509728260,"Invalid brush source")}}var Fe=i(61);function De(e,t,i,r){r>0&&r<1?(e.paths=function(e,t,i){const r=new Array(Math.max(e.length,t.length));for(let n=0;n<r.length;n++){const a=n<e.length?e[n]:void 0,s=n<t.length?t[n]:void 0,o=a||s;let l;if(o){if(a&&s){l=new Array(Math.max(a.figures.length,s.figures.length));for(let e=0;e<r.length;e++){const t=e<a.figures.length?a.figures[n]:void 0,r=e<s.figures.length?s.figures[n]:void 0;t&&r?l[e]=Ne(t,r,a.transform,s.transform,i):t?l[e]=Be(t,a.transform,1-i):r&&(l[e]=Be(r,s.transform,i))}}else l=o.figures.map(e=>Be(e,o.transform,a?1-i:i));r[n]=new x.c({figures:l,fillMode:o.fillMode,lineEnabled:o.lineEnabled,extrusionEnabled:o.extrusionEnabled,transform:f.d.Identity})}else m.a.Error(507910022,"no path")}return r}(t.paths||[],i.paths||[],r),(t.incrementalPath||i.incrementalPath)&&m.a.Error(507910023,"Incremental path interpolation not yet implemented"),e.overlapMode=t.overlapMode,e.mergeMode=t.mergeMode,e.style=function(e,t,i){const r=new y.k,n=e.fillBrush&&!(e.fillBrush instanceof y.i&&e.fillBrush.color.equals(y.b.Transparent)),a=t.fillBrush&&!(t.fillBrush instanceof y.i&&t.fillBrush.color.equals(y.b.Transparent)),s=e.fillBrush instanceof y.e&&!e.pictureBrush?e.fillBrush:n?void 0:e.pictureBrush,o=t.fillBrush instanceof y.e&&!t.pictureBrush?t.fillBrush:a?void 0:t.pictureBrush;if(!s&&!o||Ve(e.fillBrush,t.fillBrush)||Ve(e.pictureBrush,t.pictureBrush))if(r.fillBrush=Ue(e.fillBrush,t.fillBrush,i),e.pictureBrush instanceof y.e&&t.pictureBrush instanceof y.e){const n=Ue(e.pictureBrush,t.pictureBrush,i);n instanceof y.e||!n?r.pictureBrush=n:m.a.Error(507910021,"Interpolated ImageBrush returned wrong type")}else r.pictureBrush=e.pictureBrush;else if(o){if(r.fillBrush=ze(s||e.fillBrush,1-i),r.pictureBrush=ze(o,i),s&&o&&e.pictureBrush&&t.pictureBrush&&r.fillBrush instanceof y.e&&r.pictureBrush instanceof y.e){const n=f.e.InterpolateLinear(e.pictureBrush.scale,t.pictureBrush.scale,i),a=f.e.InterpolateLinear(e.pictureBrush.offset,t.pictureBrush.offset,i);r.fillBrush.scale=n,r.pictureBrush.scale=n,r.fillBrush.offset=a,r.pictureBrush.offset=a}}else r.fillBrush=ze(t.fillBrush,i),r.pictureBrush=ze(s,1-i);return r.lineBrush=Ue(e.lineBrush,t.lineBrush,i),r.pen=function(e,t,i){if(i>0&&i<1){const r=e.clone();return r.lineWidth=Object(f.n)(e.lineWidth,t.lineWidth,i),r.lineHeight=Object(f.n)(e.lineHeight,t.lineHeight,i),r.miterLimit=Object(f.n)(e.miterLimit,t.miterLimit,i),r.dashOffset=Object(f.n)(e.dashOffset,t.dashOffset,i),r}return i<1?e:t}(e.pen,t.pen,i),r.blendingMode=e.blendingMode,r}(t.style,i.style,r),e.shape3D=t.shape3D,e.clipBounds=t.clipBounds,e.text=t.text,e.textEffectMetrics=t.textEffectMetrics,e.role=t.role,e.effects=function(e,t,i){if(i>0&&i<1){const r=e.clone();return r.glow=function(e,t,i){if(e&&t)return new Fe.b(y.b.InterpolateLinear(e.color,t.color,i),Object(f.n)(e.radius,t.radius,i));const r=e||t;if(r){const t=r.clone();return t.color=r.color.modulateOpacity(e?1-i:i),t}}(e.glow,t.glow,i),r.shadow=function(e,t,i){if(e&&t)return new Fe.e(y.b.InterpolateLinear(e.color,t.color,i),Object(f.n)(e.radius,t.radius,i),Object(f.l)(e.angle,t.angle,i,void 0),Object(f.n)(e.distance,t.distance,i),f.e.InterpolateLinear(e.scale,t.scale,i),f.e.InterpolateLinear(e.skew,t.skew,i),i<1?e.alignment:t.alignment,i<1?e.rotateWithShape:t.rotateWithShape,i<1?e.shadowType:t.shadowType);const r=e||t;if(r){const t=r.clone();return t.color=r.color.modulateOpacity(e?1-i:i),t}}(e.shadow,t.shadow,i),r.innerShadow=function(e,t,i){if(e&&t)return new Fe.c(y.b.InterpolateLinear(e.color,t.color,i),Object(f.n)(e.radius,t.radius,i),Object(f.l)(e.angle,t.angle,i,void 0),Object(f.n)(e.distance,t.distance,i));const r=e||t;if(r){const t=r.clone();return t.color=r.color.modulateOpacity(e?1-i:i),t}}(e.innerShadow,t.innerShadow,i),r.reflection=function(e,t,i){if(e&&t)return new Fe.d(Object(f.n)(e.radius,t.radius,i),Object(f.n)(e.startAlpha,t.startAlpha,i),Object(f.n)(e.startPosition,t.startPosition,i),Object(f.n)(e.endAlpha,t.endAlpha,i),Object(f.n)(e.endPosition,t.endPosition,i),Object(f.n)(e.distance,t.distance,i));const r=e||t;if(r){const t=r.clone();return t.startAlpha=r.startAlpha*(e?1-i:i),t.endAlpha=r.endAlpha*(e?1-i:i),t}}(e.reflection,t.reflection,i),r.softEdges=function(e,t,i){if(e&&t)return new Fe.f(Object(f.n)(e.radius,t.radius,i));const r=e||t;r&&(r.clone().radius=r.radius*(e?1-i:i))}(e.softEdges,t.softEdges,i),r.direction=i<1?e.direction:t.direction,r}return i<1?e:t}(t.effects,i.effects,r),e.transform=function(e,t,i){return new f.d(f.e.InterpolateLinear(e.preTranslation,t.preTranslation,i),f.e.InterpolateLinear(e.scale,t.scale,i),Object(f.l)(e.rotation,t.rotation,i,void 0),f.e.InterpolateLinear(e.translation,t.translation,i))}(t.transform,i.transform,r),e.fade=t.fade,e.animationTransform=t.animationTransform,e.fillBoundsOverride=t.fillBoundsOverride,e.scene3D=t.scene3D,e.isHidden=t.isHidden,e.instances=t.instances):function(e,t){e.paths=t.paths,e.incrementalPath=t.incrementalPath,e.overlapMode=t.overlapMode,e.mergeMode=t.mergeMode,e.style=t.style,e.shape3D=t.shape3D,e.clipBounds=t.clipBounds,e.text=t.text,e.textEffectMetrics=t.textEffectMetrics,e.role=t.role,e.effects=t.effects,e.transform=t.transform,e.fade=t.fade,e.animationTransform=t.animationTransform,e.fillBoundsOverride=t.fillBoundsOverride,e.scene3D=t.scene3D,e.isHidden=t.isHidden,e.instances=t.instances}(e,r<1?t:i)}function Be(e,t,i){var r;const n=Object(x.d)([e]);if(n){const a=n.center,s=e.points.slice(0);for(let n=0;n<e.getPointCount();n++){const o=n*e.pointDataSize;let l=new f.e((s[o]-a.x)*i+a.x,(s[o+1]-a.y)*i+a.y);l=null!==(r=null==t?void 0:t.transformPoint(l))&&void 0!==r?r:l,s[o]=l.x,s[o+1]=l.y}return new x.a(s,e.isClosed,e.format)}return e}function Ne(e,t,i,r,n){const a=new Array,s=new Array,o=new Array,l=new Array;e.forEachSegment((e,t,i)=>(a.push({a:e,quadraticControl:t,b:i}),!0),i),t.forEachSegment((e,t,i)=>(s.push({a:e,quadraticControl:t,b:i}),!0),r);let d=0;for(;d<1;){const e=d*a.length,t=d*s.length,i=Math.floor(e),r=Math.floor(t),n=e-i,h=t-r,c=a[i],u=s[r],m=c.quadraticControl?f.e.InterpolateQuadratic(c.a,c.quadraticControl,c.b,n):f.e.InterpolateLinear(c.a,c.b,n),p=u.quadraticControl?f.e.InterpolateQuadratic(u.a,u.quadraticControl,u.b,h):f.e.InterpolateLinear(u.a,u.b,h);o.push(m.x,m.y,1),l.push(p.x,p.y,1);const g=(i+1)/a.length,_=(r+1)/s.length;if(d=Math.min(g,_),c.quadraticControl||u.quadraticControl){const e=c.quadraticControl||f.e.InterpolateLinear(c.a,c.b,.5),t=u.quadraticControl||f.e.InterpolateLinear(u.a,u.b,.5),g=d*a.length-i,_=d*s.length-r,v=f.e.InterpolateQuadratic(c.a,e,c.b,g),y=f.e.InterpolateQuadratic(u.a,t,u.b,_),b=f.e.InterpolateQuadratic(c.a,e,c.b,(n+g)/2),S=f.e.InterpolateQuadratic(u.a,t,u.b,(h+_)/2);o.push(2*b.x-.5*(m.x+v.x),2*b.y-.5*(m.y+v.y),2),l.push(2*S.x-.5*(p.x+y.x),2*S.y-.5*(p.y+y.y),2)}d>=1&&(o.push(c.b.x,c.b.y,1),l.push(u.b.x,u.b.y,1))}const h=new Array(o.length);for(let e=0;e<h.length;e++)h[e]=Object(f.n)(o[e],l[e],n);return new x.a(h,e.isClosed&&t.isClosed,3)}function Ve(e,t){return e instanceof y.e&&t instanceof y.e&&e.image&&t.image&&e.image.id==t.image.id}function Ue(e,t,i){if(i>0&&i<1){if(!e&&!t)return;if(!e)return ze(t,i);if(!t)return ze(e,1-i);if(e instanceof y.i&&t instanceof y.i)return new y.i(y.b.InterpolateLinear(e.color,t.color,i));if(e instanceof y.i&&t instanceof y.c||e instanceof y.c&&t instanceof y.i){const r=e instanceof y.c?e:t,n=e instanceof y.i?e.color:t.color,a=r.clone();return a.gradientStops=r.gradientStops.map(t=>new y.d(t.position,y.b.InterpolateLinear(t.color,n,e instanceof y.c?i:1-i))),a}if(e instanceof y.i&&t instanceof y.g||e instanceof y.g&&t instanceof y.i){const r=e instanceof y.g?e:t,n=e instanceof y.i?e.color:t.color,a=e instanceof y.g?i:1-i;return new y.g(r.pattern,y.b.InterpolateLinear(r.foregroundColor,n,a),y.b.InterpolateLinear(r.backgroundColor,n,a))}if(e instanceof y.c&&t instanceof y.c){const r=new Array(Math.max(e.gradientStops.length,t.gradientStops.length));for(let n=0;n<r.length;n++){const a=We(e.gradientStops,n/(r.length-1)),s=We(t.gradientStops,n/(r.length-1));r[n]=new y.d(Object(f.n)(a.position,s.position,i),y.b.InterpolateLinear(a.color,s.color,i))}const n=new y.c(e.getType(),r);return n.angle=Object(f.l)(e.angle,t.angle,i,void 0),n.fillFromRect=f.c.InterpolateLinear(e.fillFromRect,t.fillFromRect,i),n.fillToRect=f.c.InterpolateLinear(e.fillToRect,t.fillToRect,i),n.rotateWithShape=e.rotateWithShape,n.isStretched=e.isStretched,n.shadeFromTitle=e.shadeFromTitle,n.isGammaCorrected=e.isGammaCorrected,n.blendBellShape=e.blendBellShape,n}if(e instanceof y.e&&t instanceof y.e&&Ve(e,t)){const r=e.clone();return r.scale=f.e.InterpolateLinear(e.scale,t.scale,i),r.offset=f.e.InterpolateLinear(e.offset,t.offset,i),r.opacity=Object(f.n)(e.opacity,t.opacity,i),r}}return i<1?e:t}function We(e,t){const i=t*(e.length-1),r=Math.floor(i),n=i-r,a=e[Math.min(r,e.length-1)],s=e[Math.min(r+1,e.length-1)];return new y.d(Object(f.n)(a.position,s.position,n),y.b.InterpolateLinear(a.color,s.color,n))}function ze(e,t){if(e instanceof y.i)return new y.i(e.color.modulateOpacity(t));if(e instanceof y.c){const i=e.clone();return i.gradientStops=e.gradientStops.map(e=>new y.d(e.position,e.color.modulateOpacity(t))),i}if(e instanceof y.e){const i=e.clone();return i.opacity*=t,i}return e instanceof y.g?new y.g(e.pattern,e.foregroundColor.modulateOpacity(t),e.backgroundColor.modulateOpacity(t)):(m.a.Error(507910020,"Unexpected brush type not interpolated"),e)}class Ge{constructor(){}releaseGeneratedResources(){this.texture&&1==this.texture.releasePolicy&&this.texture.release(),this.textureDeltaWhite&&1==this.textureDeltaWhite.releasePolicy&&this.textureDeltaWhite.release(),this.texturePicture&&1==this.texturePicture.releasePolicy&&this.texturePicture.release()}onFinalization(){}}class je{constructor(){}releaseGeneratedResources(){var e;null===(e=this.interpolatedShapeSprite)||void 0===e||e.release()}onFinalization(){}}class He{tryInitMorphKeyFrame(e,t,i){var r,n;const a=e.ensureMorphKeyFrameRenderData(t);if(!(a.texture&&!a.texture.size.isZero()&&a.texture.isValid(e)&&(!a.textureDeltaWhite||a.textureDeltaWhite.isValid(e))&&(!a.texturePicture||a.texturePicture.isValid(e)))&&i&&(a.texture&&(e.fixedMemoryLeakAmounts.pictureCropBWTextures+=a.texture.memoryUsage),a.textureDeltaWhite&&(e.fixedMemoryLeakAmounts.pictureCropBWTextures+=a.textureDeltaWhite.memoryUsage)),i){const i=function(e,t){if(1==t.contents.length){const i=t.contents[0];if(i&&i.item instanceof s.e){const t=i.item.style.pictureBrush;if(t&&t.image){const i=e.getTextureFromImageBrush(t),r=Object(s.i)(t.alignment).multiply(f.e.One.subtract(t.scale)),n=f.c.FromSize(t.scale).translate(r.add(t.offset).subtract(new f.e(.5,.5)));if(i)return{texture:i,pictureRelativeBounds:n}}}}m.a.Error(572073356,"Texture not found")}(e,t);i&&(a.texturePicture=i.texture,a.pictureRelativeBounds=i.pictureRelativeBounds)}if(a.texture&&!a.texture.size.isZero()&&a.texture.isValid(e)&&(!a.textureDeltaWhite||a.textureDeltaWhite.isValid(e)))return!0;let o=void 0;for(let e of t.contents){const i=f.b.FromTransforms(t.parentTransform||f.b.Identity,e.item.animationTransform||f.b.Identity),r=Object(s.j)(e.item,e.includeSubtree||null!=e.textRange,31,31,i,e.includeSubtree,e.textRange);o=f.c.UnionRect(o,r)}return null===(r=a.texture)||void 0===r||r.release(),null===(n=a.textureDeltaWhite)||void 0===n||n.release(),o&&(t.location?i?(a.texture=qe(e,t,o,y.b.Black),a.textureDeltaWhite=qe(e,t,o,y.b.White)):a.texture=qe(e,t,o,void 0):m.a.Error(591672911,"No KeyFrame location")),!0}tryPrepareMorphInRenderScope(e,t,i){if(!e.getGraphicsProcessor())return m.a.Error(575942947,"glContext must be provided"),!1;const r=performance.now();e.m_initDeadline=i?r+i:void 0;const n=[];for(const i of t.elements)for(const t of i.keyFrames)if(t){const i=e.ensureMorphKeyFrameRenderData(t);if(!i.texture||i.texture.size.isZero()||!i.texture.isValid(e))for(const e of t.contents){if(e.item instanceof s.e){const t=e.item;if(e.textRange)if(t.text){const i=t.text.getFullRange();i&&i.contains(e.textRange)?e.textRange.equals(i)||t.text.forceSplit(2):m.a.Error(591672913,"Text KeyFrame out of range: ["+e.textRange.start+", "+e.textRange.last+"], fullRange: "+(i?"["+i.start+", "+i.last+"]":"undefined"))}else m.a.Error(591672914,"Text KeyFrame on Shape with no Text")}e.item&&!n.find(t=>t==e.item)&&n.push(e.item)}}for(let t of n){const i=e.m_initDeadline?e.m_initDeadline-performance.now():void 0;if(null!=i&&i<=0)return!1;if(!e.tryPrepareItemInWebGlScope(t,e.getGraphicsProcessor(),!0,i))return!1}for(let i of t.elements){const t=Ze(i);for(let r of i.keyFrames)if(r){if(!this.tryInitMorphKeyFrame(e,r,t))return!1;if(e.initOutOfTime())return!1}}return!0}tryPrepareMorph(e,t,i){const r=e.getGraphicsProcessor();if(!r)return m.a.Error(591672912,"glContext must be provided"),!1;const n=r.isInRenderScope();let a=!1;return(n||r.beginRenderScope())&&(a=this.tryPrepareMorphInRenderScope(e,t,i),n||r.endRenderScope()),a}renderMorph(e,t,i,r,n,a){const o=e.getGraphicsProcessor();if(!o)return void m.a.Error(591672915,"glContext must be provided");if(o&&!o.beginRenderScope())return;const l=o.getBabylonEngine();if(!this.tryPrepareMorph(e,t,void 0))return void m.a.Error(591672916,"failed to initialize Morph");const d=[];for(let r of t.elements){const n=r.keyFrames.length>0&&r.keyFrames[0]?r.keyFrames[0]:void 0,a=r.keyFrames.length>1&&r.keyFrames[1]?r.keyFrames[1]:void 0,h=n?n.location:a?a.location:void 0,c=a?a.location:h,u=e.ensureMorphElementRenderData(r);if(h&&c){if(n&&a&&Xe(n)&&Xe(a)){const t=new s.e;De(t,null==n?void 0:n.contents[0].item,null==a?void 0:a.contents[0].item,i),t.text=void 0,e.tryPrepareItemInWebGlScope(t,o,!0,void 0);const r=e.createTextureRasterizedItem("MorphInterpolatedShape",t,31,u.interpolatedShapeSprite,void 0,0,0,1,1,1);t.clearCache(),u.interpolatedShapeSprite&&u.interpolatedShapeSprite!=r&&u.interpolatedShapeSprite.release(),u.interpolatedShapeSprite=r,u.layer=new z(r,r,void 0,void 0,void 0,void 0)}else{const i=n?e.ensureMorphKeyFrameRenderData(n):void 0,s=a?e.ensureMorphKeyFrameRenderData(a):void 0,d=i?[i.texture,i.textureDeltaWhite,i.texturePicture]:[void 0,void 0,void 0],h=s?[s.texture,s.textureDeltaWhite,s.texturePicture]:[void 0,void 0,void 0],c=u.layer instanceof G?[u.layer.textureA,u.layer.textureDeltaWhiteA,u.layer.texturePictureA]:[u.layer?u.layer.textureA:void 0,void 0,void 0],p=u.layer instanceof G?[u.layer.textureB,u.layer.textureDeltaWhiteB,u.layer.texturePictureB]:[u.layer?u.layer.textureB:void 0,void 0,void 0];let g=!1;for(let e=0;e<3;e++)c[e]==d[e]&&p[e]==h[e]||(g=!0);if(!u.layer||g){let e,i,s;if(n&&a&&n.morphingGrid&&a.morphingGrid){const t=n.morphingGrid.size.x*n.morphingGrid.size.y*2;n.morphingGrid.size.equals(a.morphingGrid.size)&&t>0&&n.morphingGrid.data.length==t&&a.morphingGrid.data.length==t?(e=l.createVertexBuffer(n.morphingGrid.data),i=l.createVertexBuffer(a.morphingGrid.data),s=O.CreateGridXY(o,n.morphingGrid.size.x,n.morphingGrid.size.y,new f.c(-1,-1,1,1))):m.a.Error(591672917,"Wrong morphing grid size")}else(n&&n.morphingGrid||a&&a.morphingGrid)&&m.a.Error(591672918,"Morphing grids should come by pair");d[0]&&h[0]&&d[1]&&h[1]&&d[2]&&h[2]?u.layer=new G(d[0],h[0],d[1],h[1],d[2],h[2],e,i,s,t.panVector):u.layer=new z(d[0],h[0],e,i,s,t.panVector),u.layer.clientObject=r}}if(u.layer){const s=n?n.zPosition:a?a.zPosition:0,o=a?a.zPosition:s,l=!(n&&a||t.panVector);if(u.layer.progress=l?n?Object(f.g)(3*i,0,1):Object(f.g)(3*i-2,0,1):i,u.layer.contentCenter=f.e.InterpolateLinear(h.center,c.center,i),u.layer.contentSize=f.e.InterpolateLinear(h.size,c.size,i),u.layer.contentFlip=f.e.InterpolateLinear(f.e.Flip(h.flipX,h.flipY),f.e.Flip(c.flipX,c.flipY),i),u.layer.contentRotation=Object(f.l)(h.rotation,c.rotation,i,r.rotateClockwise),u.layer.depth=Object(f.n)(s,o,i),u.layer instanceof G){const t=n?e.ensureMorphKeyFrameRenderData(n).pictureRelativeBounds:void 0,r=a?e.ensureMorphKeyFrameRenderData(a).pictureRelativeBounds:void 0;if(t&&r){const e=new f.c(Object(f.n)(t.left,r.left,i),Object(f.n)(t.top,r.top,i),Object(f.n)(t.right,r.right,i),Object(f.n)(t.bottom,r.bottom,i)),n=u.layer.contentSize,a=e.size.multiply(n);let s=e.center.multiply(n);u.layer.pictureTransformUV=f.b.Translation2D(s.negate()).multiply(f.b.Scale2D(a.inverse()))}else m.a.Error(572073352,"PictureMorphLayer needs pictureCrop"),u.layer.pictureTransformUV=void 0}d.push(u.layer)}}}o.updateViewportSize();const h=a?a.tryGetBabylonTextureForRenderToTexture(o):void 0,c=a?a.size:o.getCurrentViewportSize(),u=o.activateShaderProgram(1);u.begin(h,r,!0),d.sort((e,t)=>e.depth-t.depth);for(let e=0;e<d.length;e++){let i=d[e];i.depthFar=1-e/t.elements.length,i.depthNear=1-(e+.9)/t.elements.length,Z(o,i,u,c,n?n.toMatrix3():void 0,void 0)}u.end(),o.endRenderScope()}}function qe(e,t,i,r){const n=e.getGraphicsProcessor();if(!n)return void m.a.Error(572073353,"glContext must be provided");if(1==t.contents.length&&t.contents[0].item instanceof s.e){const a=t.contents[0].item,o=Object(s.n)(a);if(o)if(null!=r){if(ie.a.readBooleanOrDefault("morphOptimizeFillColorOverride",!1))return R.b.CreateFromByteBuffer("morphOptimizeFillColorOverride",e,f.e.One,new Uint8Array([255*r.r,255*r.g,255*r.g,255*r.a]),5,4,!0)}else if(ie.a.readBooleanOrDefault("morphOptimizeImages",!1)){const r=e.getTextureFromImage(o),l=Object(s.k)(a,!1,t.parentTransform?t.parentTransform.toMatrix3():f.b.Identity);if(r&&l){const s=r.tryUseBabylonTexture(n,void 0,"MorphKeyFrameImgRef");if(s){const n=new R.b("MorphKeyFrameImgRef",e,s,r.size,r.format,r.wrapMode,2),o=n.size.divide(l.size);return n.contentLocation={logicalCenter:t.location.center.subtract(i.leftTop).multiply(o),logicalSize:t.location.size.multiply(o),physicalCenter:n.size.scale(.5),physicalSize:n.size,rotation:t.location.rotation-a.transform.rotation,flipX:t.location.flipX,flipY:t.location.flipY},n}}}}const a=Math.min(R.g,R.f/Math.max(i.width,i.height));let o=new R.a("MorphKeyFrame",e,new f.e(Math.max(1,Math.ceil(i.size.x*a)),Math.max(1,Math.ceil(i.size.y*a))),1);const l=new f.d(i.leftTop.negate(),new f.e(a,a));for(let i=0;i<t.contents.length;i++){let a,d,h=t.contents[i];r&&h.item instanceof s.e?(d=h.item.clone(),d.style.pictureBrush=void 0,d.style.fillBrush=new y.i(r),e.tryPrepareItemInWebGlScope(d,n,!0,void 0)||m.a.Error(572073354,"Failed to prepare color clone"),a=d):a=h.item,e.renderItemInWebGLRenderScope(a,0==i?y.b.Transparent:void 0,{target:o,noSubtree:!h.includeSubtree,textRange:h.textRange,transform:f.b.FromTransforms(t.parentTransform||f.b.Identity,f.b.FromTransforms(l))}),d&&d.clearCache()}return t.location?o.contentLocation={logicalCenter:t.location.center.subtract(i.leftTop).scale(a),logicalSize:t.location.size.scale(a),physicalCenter:o.size.scale(.5),physicalSize:o.size,rotation:t.location.rotation,flipX:t.location.flipX,flipY:t.location.flipY}:m.a.Error(572073355,"No KeyFrame location"),o}function $e(e){return e.isStretched&&(4==e.wrapMode||void 0===e.wrapMode)&&1==e.rotateWithShape&&1==e.opacity}function Ze(e){if(ie.a.readBooleanOrDefault("morphPictureCrop",!0)&&2==e.keyFrames.length){const t=e.keyFrames[0],i=e.keyFrames[1];if(t&&i&&1==t.contents.length&&1==i.contents.length){const r=t.contents[0],n=i.contents[0];if(r&&n&&r.item instanceof s.e&&n.item instanceof s.e){const t=r.item.style.pictureBrush,i=n.item.style.pictureBrush;if(t&&i&&$e(t)&&$e(i)&&(e.hasDynamicContent||!t.scale.equals(i.scale)||!t.offset.equals(i.offset)||t.alignment!=i.alignment)&&r.item.transform.scale.sign().equals(n.item.transform.scale.sign()))return!0}}}return!1}function Xe(e){if(!e.shapeInterpolation||1!=e.contents.length)return!1;const t=e.contents[0];return t.item instanceof s.e&&!t.textRange&&(!t.includeSubtree||!t.item.text)}class Ye{constructor(){this.renderers=[]}dumpLastScene(){console.log(this.lastRenderer&&this.lastScene?this.lastRenderer.getDebugString(this.lastScene):void 0)}static OnRender(e,t){if(!ie.a.readBooleanOrDefault("debugTool",!1))return;const i=window;i.shapeBuilderDebugTool||(i.shapeBuilderDebugTool=new Ye);const r=i.shapeBuilderDebugTool;if(r.lastRenderer=e,r.lastScene=1==t.length?t[0].item:void 0,t.length>1){const e=new s.b;for(let i of t)e.items.push(i.item);r.lastScene=e}r.renderers.includes(e)||r.renderers.push(e)}}var Je=i(136);function Ke(e,t,i,r,n){if(!i)return f.b.Identity;const a=i.getType();if(7==a)return f.b.Scale2D(n.scale(1/16));const o=y.a.IsGradient(a);if(6!=a&&!o)return f.b.Identity;const l=i.rotateWithShape;let d=0;const h=l?f.b.Scale2D(t.transform.scale):t.transform.toMatrix3(),c=Object(s.k)(t,r,h);let u=t.fillBoundsOverride?t.fillBoundsOverride:c;if(t.fillBoundsOverride&&u&&l&&(u=u.transformedBounds(f.b.FromTransforms(t.transform.toInverseMatrix3(),h))),!c||!u)return f.b.Identity;const p=u.size;let g=f.e.One,_=f.e.Zero,v=!0,b=4;if(6==a){const t=i;if(_=t.offset,g=t.scale.abs(),v=t.isStretched,b=t.alignment,v){if(g=g.multiply(p),t.fillToPreserveAspectRatio){const i=e.getTextureFromImageBrush(t);if(i){const e=i.originalSize.x/i.originalSize.y,t=p.x/p.y;g=g.multiply(new f.e(e>t?e/t:1,e<t?t/e:1))}else m.a.Error(524026452,"No texture")}_=_.multiply(p)}else{const i=e.getTextureFromImageBrush(t);i?g=g.multiply(i.originalSize):m.a.Error(590960595,"No texture")}}else if(5==a)g=p;else if(o){const e=i;if(g=e.fillFromRect?e.fillFromRect.size:f.e.One,_=(e.fillFromRect?e.fillFromRect.center:f.e.Zero).subtract(new f.e(.5,.5)).multiply(p),v=e.isStretched||4==a,2==a){g=g.multiply(p);const t=v?f.c.FromSize(f.e.One):f.c.FromSize(g),i=t.transformedBounds(f.b.RotationZ(e.angle));g=i?g.scale(i.width/t.width):g,d-=e.angle}else v?g=g.multiply(p):(g=g.scale(Math.max(p.x,p.y)),3==a&&(g=g.scale(Math.sqrt(p.x*p.x+p.y*p.y)/Math.max(p.x,p.y))))}else g=g.multiply(p);const S=new f.c(-p.x/2+g.x/2,-p.y/2+g.y/2,p.x/2-g.x/2,p.y/2-g.y/2);_=_.add(Object(s.i)(b,S)).multiply(new f.e(1,-1));let T=f.b.Identity;return T=T.multiply(f.b.Translation2D(c.center.subtract(u.center))),T=T.multiply(f.b.Scale2D(new f.e(1,-1))),l||(T=T.multiply(f.b.Scale2D(t.transform.scale.sign())),T=T.multiply(f.b.RotationZ(-t.transform.rotation))),T=T.multiply(f.b.Translation2D(_.negate())),2==a&&(T=T.multiply(f.b.Translation2D(u.center.subtract(c.center))),v&&(T=T.multiply(f.b.Scale2D(p.inverse()))),T=T.multiply(f.b.RotationZ(-d)),v&&(T=T.multiply(f.b.Scale2D(p))),T=T.multiply(f.b.Translation2D(c.center.subtract(u.center)))),T=T.multiply(f.b.Scale2D(g.inverse())),T=T.multiply(f.b.Scale2D(new f.e(1,-1))),T}function Qe(e,t,i,r,n,a,o,l,d,h,c,u,p,g,_){const v=e.getGraphicsProcessor();if(!v)return void m.a.Error(572867293,"Unable to get graphicsProcessor");const b=Object(s.k)(a,!1);if(!b)return void m.a.Error(588006215,"Unable to get bounds");const S=new j(i?i.texture:void 0,Object(R.p)(b,a.transform),a.style);if(S.fillTexture=t.resolvedFillTexture||void 0,S.lineTexture=t.resolvedLineTexture||void 0,S.pictureTexture=t.resolvedPictureTexture||void 0,S.innerShadowTexture=t.innerShadowTexture||void 0,S.softEdgesTexture=t.softEdgesTexture||void 0,S.fillTransformUV=Ke(e,a,a.style.fillBrush,!1,o),S.pictureTransformUV=Ke(e,a,a.style.pictureBrush,!1,o),S.lineTransformUV=Ke(e,a,a.style.lineBrush,!0,o),S.localClipRect=c,S.fillBrightness=i?i.getFillBrightness():0,S.mergeMode=a.mergeMode,S.distanceFieldMode=i?i.distanceFieldMode:2,S.distRangeSize=i?i.distRangeSize:0,S.softEdges=a.effects&&16&r?a.effects.softEdges:void 0,S.innerShadow=a.effects&&8&r?a.effects.innerShadow:void 0,S.blendingMode=a.style.blendingMode,S.fillBoundsOverride=a.fillBoundsOverride,(0==d||7==d)&&t.fade&&(S.fadeInfo={fade:t.fade,fadeTexture:t.fadeTexture,fadeMode:t.fadeMode}),S.clientObject=t,a.text&&0!=a.text.renderMode)if(a.text&&a.text.cache instanceof Je.a&&t.coutoutLayer&&t.coutoutLayer.texture&&t.coutoutLayerCenter){S.textRenderMode=a.text.renderMode;const e=t.coutoutLayer.texture.contentLocation.logicalSize.scale(1/t.coutoutLayer.contentQuality),i=b.multiply(a.transform.scale.abs()),r=t.coutoutLayerCenter;S.textCutoutTransform=f.b.Scale2D(a.transform.scale.sign()),S.textCutoutTransform=S.textCutoutTransform.multiply(f.b.Translation2D(i.center)),S.textCutoutTransform=S.textCutoutTransform.multiply(a.text.frameToShape.toInverseMatrix3()),S.textCutoutTransform=S.textCutoutTransform.multiply(f.b.Translation2D(a.transform.preTranslation.multiply(a.transform.scale.abs()).subtract(r))),S.textCutoutTransform=S.textCutoutTransform.multiply(f.b.Scale2D(i.size.divide(e))),S.textCutoutTexture=t.coutoutLayer.texture}else if(2!=a.text.renderMode)return;S.overallOpacity=u,S.colorMatrix=p,S.colorOffset=g,S.colorize=_;const T=performance.now();Z(v,S,n,o,l,5==d?y.b.White:h,d),e.onLayerRendered(3==a.role?"text":"shape","SDF",T,S)}var et=i(46),tt=i(45),it=i(135),rt=i(73);rt.ThinEngine.prototype.createRenderTargetTexture=function(e,t){var i=new it.a;void 0!==t&&"object"==typeof t?(i.generateMipMaps=t.generateMipMaps,i.generateDepthBuffer=!!t.generateDepthBuffer,i.generateStencilBuffer=!!t.generateStencilBuffer,i.type=void 0===t.type?0:t.type,i.samplingMode=void 0===t.samplingMode?3:t.samplingMode,i.format=void 0===t.format?5:t.format):(i.generateMipMaps=t,i.generateDepthBuffer=!0,i.generateStencilBuffer=!1,i.type=0,i.samplingMode=3,i.format=5),(1!==i.type||this._caps.textureFloatLinearFiltering)&&(2!==i.type||this._caps.textureHalfFloatLinearFiltering)||(i.samplingMode=1),1!==i.type||this._caps.textureFloat||(i.type=0,tt.a.Warn("Float textures are not supported. Render target forced to TEXTURETYPE_UNSIGNED_BYTE type"));var r=this._gl,n=new et.InternalTexture(this,et.InternalTextureSource.RenderTarget),a=e.width||e,s=e.height||e,o=e.layers||0,l=this._getSamplingParameters(i.samplingMode,!!i.generateMipMaps),d=0!==o?r.TEXTURE_2D_ARRAY:r.TEXTURE_2D,h=this._getRGBABufferInternalSizedFormat(i.type,i.format),c=this._getInternalFormat(i.format),u=this._getWebGLTextureType(i.type);this._bindTextureDirectly(d,n),0!==o?(n.is2DArray=!0,r.texImage3D(d,0,h,a,s,o,0,c,u,null)):r.texImage2D(d,0,h,a,s,0,c,u,null),r.texParameteri(d,r.TEXTURE_MAG_FILTER,l.mag),r.texParameteri(d,r.TEXTURE_MIN_FILTER,l.min),r.texParameteri(d,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(d,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),i.generateMipMaps&&this._gl.generateMipmap(d),this._bindTextureDirectly(d,null);var f=this._currentFramebuffer,m=r.createFramebuffer();return this._bindUnboundFramebuffer(m),n._depthStencilBuffer=this._setupFramebufferDepthAttachments(!!i.generateStencilBuffer,i.generateDepthBuffer,a,s),n.is2DArray||r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n._webGLTexture,0),this._bindUnboundFramebuffer(f),n._framebuffer=m,n.baseWidth=a,n.baseHeight=s,n.width=a,n.height=s,n.depth=o,n.isReady=!0,n.samples=1,n.generateMipMaps=!!i.generateMipMaps,n.samplingMode=i.samplingMode,n.type=i.type,n.format=i.format,n._generateDepthBuffer=i.generateDepthBuffer,n._generateStencilBuffer=!!i.generateStencilBuffer,this._internalTexturesCache.push(n),n},rt.ThinEngine.prototype.createDepthStencilTexture=function(e,t){if(t.isCube){var i=e.width||e;return this._createDepthStencilCubeTexture(i,t)}return this._createDepthStencilTexture(e,t)},rt.ThinEngine.prototype._createDepthStencilTexture=function(e,t){var i=this._gl,r=e.layers||0,n=0!==r?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D,a=new et.InternalTexture(this,et.InternalTextureSource.Depth);if(!this._caps.depthTextureExtension)return tt.a.Error("Depth texture is not supported by your browser or hardware."),a;var s=Object(E.__assign)({bilinearFiltering:!1,comparisonFunction:0,generateStencil:!1},t);this._bindTextureDirectly(n,a,!0),this._setupDepthStencilTexture(a,e,s.generateStencil,s.bilinearFiltering,s.comparisonFunction);var o=s.generateStencil?i.UNSIGNED_INT_24_8:i.UNSIGNED_INT,l=s.generateStencil?i.DEPTH_STENCIL:i.DEPTH_COMPONENT,d=l;return this.webGLVersion>1&&(d=s.generateStencil?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24),a.is2DArray?i.texImage3D(n,0,d,a.width,a.height,r,0,l,o,null):i.texImage2D(n,0,d,a.width,a.height,0,l,o,null),this._bindTextureDirectly(n,null),a};var nt=i(86);let at=1;const st=[{v:"precision highp float;const int pc=0,qc=1,rc=2,sc=3,tc=-1;const int k=0,l=1,m=2,n=3;const int uc=0,vc=1,wc=2;uniform vec2 u_0;uniform vec2 u_1;uniform vec2 u_2;uniform float u_3;uniform int u_4;uniform float u_5;uniform int u_6;uniform int u_7;uniform mat3 u_8;uniform float u_12;uniform int u_13;uniform float u_14;uniform int u_15;uniform vec2 u_17;uniform int u_18;uniform int u_19;attribute vec2 a_v;attribute vec4 a_p0;attribute vec4 a_p1;attribute vec4 a_p2;attribute vec4 a_p3;attribute vec4 a_p4;attribute float a_d1;attribute float a_d2;const float o=0.0,p=1.0,q=3.0,s=4.0,t=5.0,u=6.0,v=7.0;const float xc=0.001;const float yc=0.001;varying float frag_type;varying vec3 frag_geoUVS;varying vec2 frag_geoRange;varying vec4 frag_specialParam1;varying vec4 frag_specialParam2;varying vec4 frag_specialParam3;varying vec3 frag_specialParam4;varying vec2 frag_specialParam5;const int zc=2,Ac=5;const int Bc=0,Cc=1,Dc=2,Ec=3;vec2 Fc(vec4 Gc){mat3 Hc=u_8;vec2 Ic=u_0;vec2 Jc=u_1;vec2 Kc=u_17;return((Hc*vec3(Gc.xy,1.0)).xy*Jc-Ic)/Kc;}vec2 Lc(vec2 wb){return vec2(-wb.y,wb.x);}void main(){vec2 Mc=a_v;int Y=u_7;vec2 Nc=u_2;float Oc=u_3;int Z=u_4;float Pc=u_5;float Qc=u_12;int fb=u_13;float Rc=u_14;int Sc=u_15;vec2 Kc=u_17;bool Tc=u_18 !=0;bool Uc=u_19 !=0;frag_type=0.0;frag_geoRange=frag_specialParam5=vec2(0.0,0.0);frag_geoUVS=frag_specialParam4=vec3(0.0,0.0,0.0);frag_specialParam1=frag_specialParam2=frag_specialParam3=vec4(0.0,0.0,0.0,0.0);if(Y==rc || Y==sc){gl_Position=vec4(Mc,0.0,1.0);frag_type=p;}else{vec2 Vc=Fc(a_p0),Wc=Fc(a_p1),Xc=Fc(a_p2),Yc=Fc(a_p3),Zc=Fc(a_p4);int ad=int(a_p0.z),bd=int(a_p1.z),cd=int(a_p2.z),dd=int(a_p3.z),ed=int(a_p4.z);float fd=Uc ? 0.0 : a_d1,gd=Uc ? 0.0 : a_d2;float hd=a_p1.w,id=a_p2.w,jd=a_p3.w;bool kd=bd==wc;bool ld=cd==wc;vec2 md,nd,od;int pd,qd;if(ld){md=Wc;nd=Xc;od=Yc;pd=bd;qd=dd;}else if(kd){md=Vc;nd=Wc;od=Xc;pd=ad;qd=cd;}else{md=Wc;nd=(Wc+Xc)*0.5;od=Xc;pd=bd;qd=cd;}vec2 rd=od-md,sd=nd-md,td=od-nd;float ud=length(rd),vd=length(sd),wd=length(td);vec2 xd=rd/ud,yd=sd/vd,zd=td/wd;vec2 Ad=Lc(xd),Bd=Lc(yd),Cd=Lc(zd);float Dd=dot(Bd,zd);mat2 Ed;vec2 Fd,Gd;float Hd;bool Id=false;vec2 Jd;if(ld || kd){vec2 Kd=td-sd;float Ld=(dot(-sd,td)+dot(-sd,-sd))/dot(Kd,Kd);vec2 Md=mix(md,nd,Ld),Nd=mix(nd,od,Ld),Od=normalize(Nd-Md);float Pd=sign(Dd);mat2 Qd=mat2(Od,vec2(-Od.y,Od.x)*Pd);vec2 Rd=mix(Md,Nd,Ld);vec2 Sd=(md-Rd)*Qd,Td=(od-Rd)*Qd;float Ud=abs(Sd.x)> abs(Td.x)?(Sd.x*Sd.x)/Sd.y :(Td.x*Td.x)/Td.y;Ed=Qd/Ud;Fd=Rd;Gd=vec2(Sd.x,Td.x)/Ud;Hd=Ud*Pd;Id=Tc || abs(Dd)< xc || min(abs(ud),min(abs(vd/ud),abs(wd/ud)))< Oc*yc;if(Id){nd=(md+od)*0.5;sd=nd-md;td=od-nd;vd=wd=ud*0.5;yd=zd=xd;Bd=Cd=Ad;Dd=1.0;}}bool Vd=ld || kd;vec2 Wd=Vc;int Xd=ad;vec2 Yd=Vd ? Zc : Yc;int Zd=Vd ? ed : dd;bool ae=(Xd==0),be=(Zd==0),ce=(qd==0);if(Xd==0)Wd=md-(nd-md);if(Zd==0)Yd=od-(od-nd);vec2 de=md-Wd,ee=-de,fe=Yd-od,ge=-fe;float he=length(de),ie=length(fe);vec2 je=de/he,ke=fe/ie;vec2 le=Lc(je),me=Lc(ke);if(! Vd || Id){if(vd < yc){yd=je;Bd=le;}if(wd < yc){zd=ke;Cd=me;}if(ud < yc){xd=normalize(Yd-Wd);Ad=Lc(xd);}if(ud < yc){xd=vec2(1.0,0.0);Ad=vec2(0.0,-1.0);ud=yc;}if(vd < yc){yd=xd;Bd=Ad;}if(wd < yc){zd=xd;Cd=Ad;}if(he < yc){je=yd;le=Bd;}if(ie < yc){ke=zd;me=Cd;}Ed=mat2(xd/ud,Ad/ud);Fd=md;Gd=vec2(0.0,1.0);Hd=ud;}vec2 ne=vec2(0.0,0.0);if(Y==pc &&(! Vd || ld)){if(Tc){bool ce=(qd==0);if(ce || abs(ud)< Oc*yc)frag_type=o;else{float oe=clamp(hd,0.0,1.0);float pe=clamp((Vd ? jd : id),0.0,1.0);float qe=Vd ? fd+(gd-fd)*2.0 : gd;float re=Qc*0.5;vec4 se=vec4(min(md.x,od.x)-Oc*Kc.x,min(md.y,od.y)-Oc*Kc.y,max(md.x,od.x)+Oc*Kc.x,max(md.y,od.y)+Oc*Kc.y);ne=Mc*vec2(se [ 2 ]-se [ 0 ],se [ 3 ]-se [ 1 ])/2.0+vec2(se [ 2 ]+se [ 0 ],se [ 3 ]+se [ 1 ])/2.0;vec2 te=vec2(xd.x==0.0 ? 1.0 : sign(xd.x),xd.y==0.0 ? 1.0 : sign(xd.y));float ue=re*(1.0-oe),ve=re*(1.0-pe);float we=re*oe,xe=re*pe;vec2 ye=md-te*we,ze=od+te*xe;vec2 Ae=ye+vec2(te.x*2.0*we,0.0),Be=ze-vec2(te.x*2.0*xe,0.0);vec2 Ce=ye+vec2(0.0,te.y*2.0*we),De=ze-vec2(0.0,te.y*2.0*xe);bool Ee=dot(Ad,Ae-md)>=0.0,Fe=dot(Ad,Be-md)>=0.0;vec2 Ge=Ee ? Ae : Ce,He=Fe ? Be : De;vec2 Ie=Ee ? Ce : Ae,Je=Fe ? De : Be;float Ke=max(abs(xd.x),abs(xd.y));float Le=dot(ne-Ge,Lc(normalize(He-Ge)))*Ke+re;float Me=dot(ne-Ie,-Lc(normalize(Je-Ie)))*Ke+re;float Ne=dot(ne-md,Ad);float Oe=dot(ne-md,(oe > xc)? Lc(Ie-Ge): xd);float Pe=dot(ne-od,(pe > xc)? Lc(He-Je):-xd);frag_specialParam1=vec4(ne-md,ne-od)*0.5/Oc;frag_specialParam2=vec4(Le,Me,ue,ve)*0.5/Oc;frag_specialParam3=vec4(gd-fd,fd,0.0,0.0);frag_specialParam4=vec3(Ne,Oe,Pe);frag_type=v;}}else{float Qe=dot(le,yd),Re=dot(Cd,ke),Se=dot(le,xd),Te=dot(Ad,ke);bool Ue=abs(Qe)< xc,Ve=abs(Re)< xc;bool We=Ue && dot(je,yd)< 0.0,Xe=Ve && dot(zd,ke)< 0.0;float Ye=(! Ue)? sign(Qe):(Se !=0.0)? sign(Se): sign(Te);float Ze=(! Ve)? sign(Re):(Te !=0.0)? sign(Te): sign(Se);vec2 af=normalize(le+Bd)*-Ye;float bf=abs(dot(af,Bd));float cf=(Z==k)? bf :(Z==l)? 1.0/max(bf,xc): 1.0;vec2 df=We ? yd*Ye : af*cf;vec2 ef=normalize(Cd+me)*-Ze;float ff=abs(dot(ef,Cd));float gf=(Z==k)? ff :(Z==l)? 1.0/max(ff,xc): 1.0;vec2 hf=Xe ?-zd*Ze : ef*gf;vec4 se=vec4(min(min(min(min(md.x,od.x),nd.x),md.x+df.x*Oc),od.x+hf.x*Oc)-Oc,min(min(min(min(md.y,od.y),nd.y),md.y+df.y*Oc),od.y+hf.y*Oc)-Oc,max(max(max(max(md.x,od.x),nd.x),md.x+df.x*Oc),od.x+hf.x*Oc)+Oc,max(max(max(max(md.y,od.y),nd.y),md.y+df.y*Oc),od.y+hf.y*Oc)+Oc);ne=Mc*vec2(se [ 2 ]-se [ 0 ],se [ 3 ]-se [ 1 ])/2.0+vec2(se [ 2 ]+se [ 0 ],se [ 3 ]+se [ 1 ])/2.0;vec2 jf=normalize(Bd+df*Ye);vec2 kf=-normalize(le+df*Ye);bool lf=ce || We || Ue || cf > vd*10.0 || cf > he*10.0;vec2 mf=ne-md;vec2 nf=normalize(df);float Cb=-dot(mf,(vd < xc || We)? xd : yd);float Db=lf ? Cb :-dot(mf,Lc(nf))*Ye;float Eb=lf ?-dot(mf,Bd)*Ye : dot(mf,Lc(jf))/(2.0*Oc*length(df+jf*dot(-df,jf)));float Fb=lf ? 0.5 :(dot(mf,nf)/Oc-Pc)/abs(dot(nf,Bd));float Gb=lf ? 1.0 : dot(mf,Lc(kf))/(2.0*Oc*length(df+kf*dot(-df,kf)));vec2 of=-normalize(Cd+hf*Ze);vec2 pf=normalize(me+hf*Ze);bool qf=ce || Xe || Ve || gf > wd*10.0 || gf > ie*10.0;vec2 rf=ne-od;vec2 sf=normalize(hf);float Hb=dot(rf,(wd < xc || Xe)? xd : zd);float Ib=qf ? Hb : dot(rf,Lc(sf))*Ze;float Jb=qf ?-dot(rf,Cd)*Ze : dot(rf,Lc(of))/(2.0*Oc*length(hf+of*dot(-hf,of)));float Kb=qf ? 0.5 :(dot(rf,sf)/Oc-Pc)/abs(dot(sf,Cd));float Lb=qf ? 1.0 : dot(rf,Lc(pf))/(2.0*Oc*length(hf+pf*dot(-hf,pf)));float tf=(1.0-Rc)*Qc/(4.0*Oc);if(ae)Gb=-dot(mf,yd)/(2.0*Oc)+tf;if(be)Lb=dot(rf,zd)/(2.0*Oc)+tf;float uf,vf;if(Vd && ! Id){float wf=fd,qe=fd+(gd-fd)*2.0;float xf=sqrt(1.0+4.0*Gd [ 0 ]*Gd [ 0 ]),yf=sqrt(1.0+4.0*Gd [ 1 ]*Gd [ 1 ]);float zf=sign(Gd [ 0 ])*0.5*(abs(Gd [ 0 ])*xf+0.5*log(2.0*abs(Gd [ 0 ])+xf));float Af=sign(Gd [ 1 ])*0.5*(abs(Gd [ 1 ])*yf+0.5*log(2.0*abs(Gd [ 1 ])+yf));uf=(qe-wf)/abs(Af-zf);vf=wf-zf*uf;}else{float wf=fd;float qe=gd;uf=qe-wf;vf=wf;}float oe=hd;float pe=Vd ? jd : id;vec2 Bf=(vec2(1.0,1.0)-clamp(vec2(oe,pe),0.0,1.0))*Qc/(4.0*Oc);frag_specialParam1=vec4(vec2(Cb,Db)/Qc,Eb,Fb);frag_specialParam2=vec4(vec2(Hb,Ib)/Qc,Jb,Kb);frag_specialParam3=vec4(uf,vf,Bf.x,Bf.y);if(Sc==0 || Rc > 0.0)frag_specialParam4=vec3(ae ? 0.0 : 1.0,be ? 0.0 : 1.0,ce ? 0.0 : 1.0);else frag_specialParam4=vec3(1.0,1.0,ce ? 0.0 : 1.0);frag_specialParam5=vec2(Gb,Lb);frag_type=(Vd && ! Id)? s : q;}}else if(Y==qc &&(! Id || ld)){float Cf=(Mc.y)/(Kc.x*Nc.x);if(! Vd || Id){vec2 Df=(Mc.x < 0.0)? md : od;ne=Df+vec2(Cf,0.0);frag_type=t;}else{float Ef=clamp((md.y-nd.y)/(md.y+od.y-2.0*nd.y),0.0,1.0);vec2 Ff=mix(mix(md,nd,Ef),mix(nd,od,Ef),Ef);vec2 Gf=ld ? md : Ff;vec2 Hf=ld ? Ff : od;vec2 Df=(Mc.x < 0.0)? Gf : Hf;vec2 If=(Ff-Fd)*Ed;vec2 Jf=(Df+vec2(Cf,0.0)-Fd)*Ed;vec2 Kf=((ld ? md : od)-Fd)*Ed;float Lf=Jf.x-If.x;float Mf=sign(Kf.x-If.x);float fc=Lf*Mf;float gc=sign(dot(Bd,zd));ne=Df+vec2(Cf,0.0);frag_specialParam1.x=dot(ne-md,Bd*sign(dot(Bd,xd)));frag_specialParam1.y=dot(ne-nd,Cd*sign(dot(Cd,-yd)));frag_specialParam1.z=dot(ne-od,Ad*sign(dot(Ad,-zd)));frag_specialParam1.w=dot(ne-Gf,vec2(Gf.y-Hf.y,Hf.x-Gf.x));frag_specialParam2.x=fc;frag_specialParam2.y=gc;frag_type=u;}}else{gl_Position=vec4(0.0,0.0,0.0,0.0);frag_type=o;}gl_Position=vec4(ne.x*Nc.x*2.0*Kc.x,-ne.y*Nc.y*2.0*Kc.y,0.0,1.0);frag_geoRange=Gd;frag_geoUVS.xy=(ne-Fd)*Ed;frag_geoUVS.z=Hd*0.5/Oc;if(fb==2)frag_specialParam3=vec4(Mc.x*0.5+0.5,Mc.y*0.5+0.5,rd.x+rd.y,0.0);}}",f:"precision highp float;const int c=0,d=1,e=2,f=3,h=4,i=5,j=6;const int k=0,l=1,m=2,n=3;uniform int ufrag_0;uniform int ufrag_1;uniform float ufrag_2;uniform float ufrag_3;uniform float ufrag_4;uniform float ufrag_5;uniform float ufrag_6;uniform int ufrag_7;uniform float ufrag_8;uniform float ufrag_10;uniform float ufrag_11;uniform float ufrag_12;uniform vec4 ufrag_13;uniform float ufrag_15;uniform vec2 ufrag_16;uniform int ufrag_17;uniform float ufrag_18;uniform float ufrag_19;varying float frag_type;const float o=0.0,p=1.0,q=3.0,s=4.0,t=5.0,u=6.0,v=7.0;varying vec3 frag_geoUVS;varying vec2 frag_geoRange;varying vec4 frag_specialParam1;varying vec4 frag_specialParam2;varying vec4 frag_specialParam3;varying vec3 frag_specialParam4;varying vec2 frag_specialParam5;float A(vec2 B,vec2 C){float a=0.5-B.y;float b=-0.5*B.x;float D=b*0.5;float E=(b*b)*0.25;float F=(a*a*a)/27.0;if(E+F > 0.0){float G=sqrt(E+F);float H=G-D;float I=sign(H)*pow(abs(H),1.0/3.0);float J=G+D;float K=-sign(J)*pow(abs(J),1.0/3.0);float x=I+K;return clamp(x,C [ 0 ],C [ 1 ]);}else{const float L=0.333333333;const vec3 M=vec3(0.0,2.094395102,4.188790205);float N=1.0/a;vec3 O=2.0*sqrt(-a*L)*cos(L*acos(sqrt(-6.75*N)*b*N)-M);vec3 x=clamp(O,C [ 0 ],C [ 1 ]);vec3 P=B.x-x,Q=B.y-x*x,R=P*P+Q*Q;return(R [ 0 ] < R [ 1 ] && R [ 0 ] < R [ 2 ])? x [ 0 ] :(R [ 1 ] < R [ 2 ])? x [ 1 ] : x [ 2 ];}}bool S(float T){return T-0.4 < frag_type && frag_type < T+0.4;}float U(float V,float a,float b,float W,float X){return clamp((abs(V*2.0-a-b)+a-b)*W*0.5+X,0.0,1.0);}void main(){int Y=ufrag_0;int Z=ufrag_1;float ab=ufrag_2;float bb=ufrag_3;float cb=ufrag_4;float db=ufrag_5;float eb=ufrag_6;int fb=ufrag_7;float gb=ufrag_8;float hb=ufrag_10;float ib=ufrag_11;float jb=ufrag_12;vec4 kb=ufrag_13;float lb=ufrag_15;vec2 mb=ufrag_16;bool nb=(ufrag_17==1);float ob=ufrag_18;float pb=ufrag_19;const float qb=1.0;float F=qb;float rb;float sb=0.0;float tb=0.0;if(Y==0 && ! S(v)){float V=0.0;float ub=0.0;vec2 vb;if(S(s)){float x=A(frag_geoUVS.xy,frag_geoRange);vb=frag_geoUVS.xy-vec2(x,x*x);vec2 wb=normalize(vec2(1.0,2.0*x));sb=dot(vb,vec2(-wb.y,wb.x))*frag_geoUVS.z;float xb=2.0*abs(x),yb=sqrt(1.0+xb*xb);float zb=sign(x)*(xb*yb+log(xb+yb))*0.25;float Ab=1.0-abs(sign((x-frag_geoRange [ 0 ])*(x-frag_geoRange [ 1 ])));V=zb+Ab*dot(vb,wb);ub=(x-frag_geoRange [ 0 ])/(frag_geoRange [ 1 ]-frag_geoRange [ 0 ]);}else{vb=frag_geoUVS.xy-vec2(clamp(frag_geoUVS.x,0.0,1.0),0.0);V=ub=frag_geoUVS.x;sb=frag_geoUVS.y;}F=length(vb)*abs(frag_geoUVS.z);ub=clamp(ub,0.0,1.0);const float Bb=0.01;float Cb=frag_specialParam1 [ 0 ],Db=frag_specialParam1 [ 1 ],Eb=frag_specialParam1 [ 2 ],Fb=frag_specialParam1 [ 3 ],Gb=frag_specialParam5 [ 0 ];float Hb=frag_specialParam2 [ 0 ],Ib=frag_specialParam2 [ 1 ],Jb=frag_specialParam2 [ 2 ],Kb=frag_specialParam2 [ 3 ],Lb=frag_specialParam5 [ 1 ];float Mb=frag_specialParam4.x,Nb=frag_specialParam4.y,Ob=frag_specialParam4.z;bool Pb=ub < 0.5 ?(Mb !=0.0 &&(Db > Bb || Fb > 1.0)):(Nb !=0.0 &&(Ib > Bb || Kb > 1.0));if(Z !=m){if(Pb)F=qb;else{const float Qb=0.001;if(ub < 0.5 && Cb > Bb && Mb !=0.0)F=(Db <=Qb)? Eb :(Fb >=0.0)? Gb : qb;if(ub > 0.5 && Hb > Bb && Nb !=0.0)F=(Ib <=Qb)? Jb :(Kb >=0.0)? Lb : qb;}}float Rb=F;if(Mb==0.0)Rb=max(Rb,Gb);if(Nb==0.0)Rb=max(Rb,Lb);tb=V*frag_specialParam3.x+frag_specialParam3.y;bool Sb=(mb==vec2(0.0,0.0))||(mb [ 0 ] <=tb && tb <=mb [ 1 ]);bb=Sb ? bb*Ob : 0.0;float Tb=(F <=lb && Sb)? bb : 0.0;float Ub=Pb ? 0.0 : Tb;const float Vb=0.2;const float Wb=(1.0-2.0*Vb)*2.0;float Xb=abs(fract(db+tb*cb)*2.0-1.0)*jb;float Yb=U(Xb,kb [ 0 ],kb [ 1 ],Wb,Vb)*U(Xb,kb [ 2 ],kb [ 3 ],Wb,Vb)*Tb;float Zb=clamp(0.5-F*sign(sb)*ib,0.0,1.0)*Ub;rb=sign(Rb)*max(0.0,abs(Rb)+mix(frag_specialParam3.z,frag_specialParam3.w,ub));float ac=(0.5-rb+pb)*bb;float bc=(0.5-F)*ab;vec4 cc=vec4(bc,ac,Zb,Yb);vec4 dc=vec4(ac,bc,0.0,0.0);vec4 ec=mix(cc,dc,ob);gl_FragColor=clamp(ec,0.0,1.0);}else if(S(t)){gl_FragColor=vec4(0.0,0.0,0.0,1.0);if(eb==sign(frag_geoUVS.y))discard;}else if(S(u)){gl_FragColor=vec4(0.0,0.0,0.0,0.0);if(frag_specialParam1.x > 0.0 && frag_specialParam1.y > 0.0 && frag_specialParam1.z > 0.0){float fc=frag_specialParam2.x,gc=frag_specialParam2.y;float hc=((fc >=0.0)? sign((frag_geoUVS.y-frag_geoUVS.x*frag_geoUVS.x)): 1.0)*gc;if(eb==hc)discard;}else if(eb==sign(frag_specialParam1.w))discard;}else if(S(v)){tb=frag_geoUVS.x*frag_specialParam3.x+frag_specialParam3.y;float ic=max(abs(frag_specialParam1.x),abs(frag_specialParam1.y))+frag_specialParam2.z;float jc=max(abs(frag_specialParam1.z),abs(frag_specialParam1.w))+frag_specialParam2.w;rb=min(ic,jc);if(frag_specialParam4.y >=0.0 && frag_specialParam4.z >=0.0)rb=min(rb,frag_specialParam4.x >=0.0 ? frag_specialParam2.x : frag_specialParam2.y);float kc=0.5-clamp(rb,0.0,0.5);gl_FragColor=vec4(kc*ab,kc*bb,0.0,1.0);}else gl_FragColor=vec4(frag_type*(1.0-gb),0.0,0.0,frag_type*gb);if(Y==0 && nb){float lc=smoothstep(lb,lb*1.5,rb);float mc=(tb+32.0*rb/lb)*jb;float nc=1.0-(mc+lc);gl_FragColor=vec4(nc,nc,nc,1.0);}if(fb==e){gl_FragColor.rgb=clamp(vec3(1.0-F*2.0,1.0-F*4.0,1.0-F*8.0),0.0,1.0);float oc=0.25+clamp((abs(frag_specialParam3.x+frag_specialParam3.y-1.0)+abs(frag_specialParam3.x-frag_specialParam3.y))*4.0-2.75,0.0,1.0);gl_FragColor+=vec4(oc*(1.0+sin(frag_specialParam3.z))/2.0,oc*(1.0+cos(frag_specialParam3.z))/2.0,oc*frag_specialParam3.z/18.0,1.0);}}",a:["a_v","a_p0","a_p1","a_p2","a_p3","a_p4","a_d1","a_d2"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_5","ufrag_6","ufrag_7","ufrag_8","ufrag_10","ufrag_11","ufrag_12","ufrag_13","ufrag_15","ufrag_16","ufrag_17","ufrag_18","ufrag_19","u_0","u_1","u_2","u_3","u_4","u_5","u_6","u_7","u_8","u_12","u_13","u_14","u_15","u_17","u_18","u_19"],s:[]},{v:"precision highp float;uniform mat3 u_0;uniform mat3 u_1;uniform vec2 u_2;uniform mat3 u_3;uniform mat3 u_4;uniform mat3 u_5;uniform mat3 u_6;uniform mat3 u_7;uniform mat3 u_8;uniform mat3 u_10;uniform mat3 u_11;uniform int u_13;uniform int u_14;uniform vec2 u_15;uniform int u_16;uniform float u_17;uniform float u_18;uniform float u_19;uniform vec2 u_20;uniform vec2 u_21;attribute vec2 a_v;attribute vec2 a_0;attribute vec2 a_1;varying vec2 l,m,n,o,p,q,s,t;varying float u;mat2 id(float jd){return mat2(cos(jd),-sin(jd),sin(jd),cos(jd));}vec2 kd(vec2 ld){return vec2(ld.x/2.0,ld.y/-2.0)+vec2(0.5,0.5);}vec2 md(vec2 ld,mat3 nd){return(nd*vec3(vec2(ld.x/2.0,ld.y/2.0),1.0)).xy*vec2(1.0,-1.0)+vec2(0.5,0.5);}mat4 od(float pd,float qd,float rd,float sd){float a=1.0/tan(pd*0.5),b=1.0/(rd-sd);return mat4(a/qd,0.0,0.0,0.0,0.0,-a,0.0,0.0,0.0,0.0,(rd+sd)*b,-1.0,0.0,0.0,2.0*rd*sd*b,0.0);}mat4 td(float jd){float ud=cos(jd),vd=sin(jd);return mat4(1.0,0.0,0.0,0.0,0.0,ud,-vd,0.0,0.0,vd,ud,0.0,0.0,0.0,0.0,1.0);}mat4 wd(float jd){float ud=cos(jd),vd=sin(jd);return mat4(ud,0.0,vd,0.0,0.0,1.0,0.0,0.0,-vd,0.0,ud,0.0,0.0,0.0,0.0,1.0);}void main(){vec2 xd=a_v;mat3 yd=u_0;vec2 zd=u_15;mat3 Ad=u_1;vec2 Bd=u_2;mat3 Cd=u_3;mat3 Dd=u_4;mat3 Ed=u_5;mat3 Fd=u_6;mat3 Gd=u_7;mat3 Hd=u_8;mat3 Id=u_10;mat3 Jd=u_11;vec2 Kd=u_20;vec2 Ld=u_21;int Md=u_13;int Nd=u_14;float Od=u_18;float Pd=u_19;vec2 Qd=xd;vec2 Rd=xd;if(u_16 !=0){Qd=xd+a_0*2.0;Rd=xd+a_1*2.0;xd=mix(Qd,Rd,u_17);}vec2 Sd=(yd*vec3(xd.xy/2.0,1.0)).xy;vec2 Td;if(zd !=vec2(1.0,1.0)){const float Ud=1.57079632679;mat4 Vd=wd((1.0-zd.x)*Ud),Wd=td((1.0-zd.y)*Ud);mat4 Xd=mat4(mat2(Ad));Xd [ 3 ] [ 0 ]=Ad [ 2 ] [ 0 ];Xd [ 3 ] [ 1 ]=Ad [ 2 ] [ 1 ];vec4 Yd=Xd*Wd*Vd*vec4(Sd,0.0,1.0)-vec4(Bd*0.5,0.0,0.0);gl_Position=vec4((Yd.xy/Bd)*vec2(2.0,-2.0),0.0,1.0);const float Zd=0.78539816339;float ae=Bd.y/(2.0*tan(Zd*0.5));Yd.z-=ae;vec4 be=od(Zd,Bd.x/Bd.y,ae/2.0,ae*2.0)*Yd;gl_Position=be/be.w;}else{vec2 Td=(Ad*vec3(Sd,1.0)).xy;gl_Position=vec4((Td/Bd-vec2(0.5,0.5))*vec2(2.0,-2.0),0.0,1.0);}gl_Position.z=mix(Od,Pd,xd.y*0.5+0.5);l=md(Qd.xy,Cd);t=md(Qd.xy,Jd);m=md((Md !=0)? gl_Position.xy : Rd.xy,Dd);o=md((Nd !=0)? gl_Position.xy : xd.xy,Fd);n=md(xd.xy,Ed);q=md(xd.xy,Gd);s=md(xd.xy,Hd);p=md(xd.xy,Id);if(Kd==Ld){u=1.0;}else{vec2 ce=Ld-Kd;u=dot(Sd-Kd,ce)/dot(ce,ce);}}",f:"precision highp float;uniform sampler2D t_0;uniform sampler2D t_1;uniform sampler2D t_2;uniform sampler2D t_3;uniform sampler2D t_4;uniform sampler2D t_5;uniform sampler2D t_6;uniform sampler2D t_7;uniform float ufrag_0;uniform float ufrag_1;uniform float ufrag_2;uniform vec4 ufrag_3;uniform vec4 ufrag_4;uniform float ufrag_6;uniform vec3 ufrag_8;uniform vec3 ufrag_9;uniform int ufrag_10;uniform int ufrag_11;uniform vec2 ufrag_12;uniform vec4 ufrag_13;uniform int ufrag_14;uniform int ufrag_15;uniform int ufrag_16;uniform vec2 ufrag_17;uniform int ufrag_18;uniform int ufrag_19;uniform float ufrag_20;uniform float ufrag_21;uniform vec4 ufrag_22;uniform vec4 ufrag_23;uniform int ufrag_24;uniform int ufrag_25;uniform vec4 ufrag_26;uniform float ufrag_27;uniform float ufrag_28;uniform float ufrag_29;uniform int ufrag_30;uniform int ufrag_31;uniform float ufrag_32;uniform int ufrag_34;uniform int ufrag_35;uniform float ufrag_36;uniform int ufrag_37;uniform int ufrag_38;uniform int ufrag_39;uniform float ufrag_40;uniform float ufrag_41;uniform mat3 ufrag_42;uniform vec3 ufrag_43;uniform vec4 ufrag_44;const int c=0,d=1,e=2,f=3,h=10,i=11,j=14,k=16;varying vec2 l,m,n,o,p,q,s,t;varying float u;float v(float A){return clamp(A,0.0,1.0);}const vec2 B=vec2(.5,.5);vec4 C(vec4 D,vec4 E){float F=E.a+D.a*(1.0-E.a);return vec4((E.rgb*E.a+D.rgb*D.a*(1.0-E.a))/F,F);}float G(float H,vec3 I,vec3 J){float K=clamp(H,I [ 0 ],I [ 2 ]);vec3 L=abs((K-I)*J);return min(L [ 0 ],min(L [ 1 ],L [ 2 ]));}float M(vec2 N){vec2 O=sign(B-abs(N-B));return max(0.0,O.x+O.y)*.5;}float P(float Q,float R,float S){const float T=-0.5;const float U=0.16;const float V=0.5;float W=mix(U,T,v(S*V));float X=min(S,R);float Y=1.0-v((Q-W)/X);return Y*Y;}vec2 Z(vec4 ab,float bb,float cb,float db,vec3 eb,vec3 fb,float S,float gb){bool hb=ufrag_38 !=0;float ib=max(cb,S)*0.5;float jb=ab.r-0.5;float kb=P(-jb/bb,0.5/bb,S);float lb=clamp(0.5-mix(ab.g,min(1.0-ab.r,ab.g),ufrag_29),0.0,0.5);float mb=(hb && gb==0.0)? lb : 0.5-ab.b;float H=lb*sign(mb)/bb;bool nb=fb [ 0 ]==fb [ 2 ];if(! nb && abs(H)< cb*0.5-S*2.0)H=mb/bb;H+=gb;const float ob=0.2;const float pb=1.0/(1.0-ob*2.0);const float qb=0.5-0.5*pb;float rb=ab.a;float sb=rb*pb+qb;float tb=(1.0-sb)*ib;float ub=abs(H);if(rb <(1.0-ob)&& ! hb)ub=mix(max(tb,ub),length(vec2(tb,ub)),db);const float vb=0.49;float wb=min(ib,vb/bb);float xb=P(ub-wb,0.5/bb-wb,S);if(rb < ob && ! hb){xb=0.0;}if(sb >=db && ! hb){float yb=G(H,eb*ib,fb);float zb=min(min(fb [ 0 ],fb [ 1 ]),fb [ 2 ]);float Ab=S*zb;float Bb=P(yb-wb,0.5/bb-wb,Ab);xb=min(xb,Bb);}if(ufrag_37==0)return vec2(clamp(kb,0.0,1.0),clamp(xb,0.0,1.0));else return vec2(0.0,clamp(max(kb,xb),0.0,1.0));}const int Cb=0,Db=1,Eb=2,Fb=3,Gb=4,Hb=5,Ib=6,Jb=7,Kb=8,Lb=9;vec2 Mb(int Nb,vec4 Ob,vec2 N,float bb){if(Nb==Gb)return vec2(1.0-min(min(Ob [ 0 ]*N.x,Ob [ 3 ]*N.y),min(Ob [ 2 ]*(1.0-N.x),Ob [ 1 ]*(1.0-N.y))),0.0);if(Nb==Eb){float Pb=N.x,Qb=floor(Pb),K=Pb-Qb;Pb=(fract(Qb*0.5)==0.0)? K : 1.0-K;return vec2(Pb,0.0);}else return N;}vec4 Rb(int Nb,vec4 Ob,vec4 Sb,vec2 N,sampler2D Tb,int Ub,vec4 ab,float bb){if(Nb==Cb)return vec4(0.0,0.0,0.0,0.0);else if(Nb==Db)return Ob;else if(Ub !=0 && Nb !=0 && Nb > 1 &&(N.x < 0.0 || N.x > 1.0 || N.y < 0.0 || N.y > 1.0))return vec4(0.0,0.0,0.0,0.0);vec4 Y=texture2D(Tb,Mb(Nb,Ob,N,bb));if(Nb==Jb)return mix(Ob,Sb,Y.r);else{if(Nb==Ib && Y.a > 0.0)Y.rgb/=Y.a;return Y;}}void main(){float bb=ufrag_0;float cb=ufrag_1;float Vb=ufrag_2;vec4 Wb=ufrag_3;vec4 Xb=ufrag_4;float db=ufrag_6;vec3 eb=ufrag_8;vec3 fb=ufrag_9;int Yb=ufrag_10;int Zb=ufrag_11;vec2 ac=ufrag_12;vec4 bc=ufrag_13;int cc=ufrag_15;int dc=ufrag_16;vec2 ec=ufrag_17;int fc=ufrag_18;int gc=ufrag_19;float hc=ufrag_20;float ic=ufrag_21;vec4 jc=ufrag_22;vec4 kc=ufrag_23;int lc=ufrag_24;int mc=ufrag_25;vec4 nc=ufrag_26;float gb=ufrag_27;float oc=ufrag_28;int pc=ufrag_30;int qc=ufrag_31;float rc=ufrag_32;bool sc=ufrag_34 !=0;float tc=ufrag_36;int uc=ufrag_39;float vc=ufrag_40;float wc=ufrag_41;mat3 xc=ufrag_42;vec3 yc=ufrag_43;vec4 zc=ufrag_44;vec4 Ac=sc ? vec4(0.0,0.0,0.0,0.0): texture2D(t_0,l);if(cc==e || cc==f){float Bc=M(l);float Cc=M(m);Ac*=Bc;if(tc > 0.0){vec4 Dc=texture2D(t_1,m)*Cc;Ac=mix(Ac,Dc,v(tc));}if(cc==f){vec4 Ec=texture2D(t_2,l)*Bc;vec4 Fc=texture2D(t_4,m)*Cc;vec4 Gc=mix(Ec,Fc,v(tc));vec4 Hc=vec4(0.0,0.0,0.0,0.0);if(n.x >=0.0 && n.x <=1.0 && n.y >=0.0 && n.y <=1.0){Hc=mix(texture2D(t_5,n),texture2D(t_6,n),tc);}float Ic=Gc.a > 0.0 ? Gc.r/Gc.a : 0.0;float Jc=Ac.a > 0.0 ? Ac.r/Ac.a : 0.0;float Kc=abs(Ic-Jc);Ac=mix(Ac*0.5+Gc*0.5,Hc,Kc);}gl_FragColor=Ac;if(gl_FragColor.a > 0.0){gl_FragColor.rgb/=gl_FragColor.a;}}else if(cc <=d){vec2 Lc=sc ? vec2(1.0,0.0): Z(Ac,bb,cb,db,eb,fb,Vb,gb);if(uc !=0 && ufrag_37==0){vec4 Mc=texture2D(t_7,t)*M(t);vec2 Nc=Z(Mc,bb,cb,db,eb,fb,Vb,gb);Lc=(uc==2)? vec2(v(Lc.x-Nc.x),v(Lc.y*(1.0-Nc.x)+Lc.x*Nc.y)):(uc==1)? vec2(Nc.x*Lc.x,v(Nc.y*Lc.x+Lc.y*Nc.x)): Nc;}vec4 Oc=Rb(Yb,Wb,jc,m,t_1,fc,Ac,bb);Oc.a*=hc;vec4 Pc=vec4(Oc.rgb,0.0);if(pc !=0){vec4 Qc=Rb(Ib,vec4(0.0,0.0,0.0,0.0),vec4(0.0,0.0,0.0,0.0),n,t_6,qc,Ac,bb);Qc.a*=rc;if(Qc.a > 0.0)Oc=C(Oc,Qc);Pc=vec4(Qc.rgb,Qc.a*vc*M(n));}Oc.rgb=clamp(mix(Oc.rgb,vec3(0.5)*sign(oc)+0.5,abs(oc)),0.0,1.0);if(mc !=0){float Rc=texture2D(t_5,s).a;Oc.rgb=mix(Oc.rgb,nc.rgb,(1.0-Rc)*nc.a);}vec4 Sc=mix(Pc,Oc,Lc [ 0 ]);vec4 Tc=Rb(Zb,Xb,kc,o,t_2,gc,Ac,bb);vec4 Uc=vec4(Tc.rgb,Tc.a*Lc [ 1 ]*ic);gl_FragColor=C(Sc,Uc);}else if(cc==h){float Vc=(Ac.r-0.5);float Wc=v(1.0-2.0*abs(sin(Vc*64.0)))*0.5;if(Vc < 0.0)gl_FragColor=vec4(0.0,Wc*(1.0+Vc),1.0+Vc,1.0+Vc);else gl_FragColor=vec4(1.0-Vc,Wc*(1.0-Vc),0.0,1.0);}else{if(cc==i)gl_FragColor=vec4(Ac.r,Ac.g*2.0,0.0,1.0);else if(cc==j)gl_FragColor=vec4(Ac.r,0.0,0.0,1.0);else if(cc==k)gl_FragColor=vec4(Ac.b,Ac.b > 0.95 ?(Ac.b-0.95)*20.0 : 0.0,Ac.a,1.0);else gl_FragColor=vec4(Ac.r,Ac.g,Ac.b,1.0);}float Xc=ac [ 0 ]+(ac [ 1 ]-ac [ 0 ])*v(u);if(lc !=0)Xc-=1.0-texture2D(t_4,q).a;if(dc !=0 &&(cc==0 || cc==2)){if(dc==1){Xc-=1.0-ec [ 1 ];}else{vec4 Yc=texture2D(t_3,p);if(dc==2){float Zc=1.0-Yc.r;Xc-=1.0-v(Zc*ec [ 0 ]+ec [ 1 ]);}else if(dc==3){float ad=1.0-ec [ 0 ];float bd=ec [ 1 ]/ad;if(Yc.r > 0.0){Xc-=1.0-v(6.0*bd);vec3 cd=clamp(vec3((1.0-Yc.a)*ec [ 0 ]+ec [ 1 ]*3.0)-vec3(0.0,1.0-Yc.b,2.0-Yc.b)*(1.0-ec [ 0 ]),0.0,1.0);gl_FragColor.rgb=mix(mix(vec3(Yc.r),vec3(Yc.g),cd [ 1 ]),mix(vec3(Yc.g),gl_FragColor.rgb,bd),cd [ 2 ]);}else{Xc-=1.0-v(2.0*bd-1.0);}}}}if(zc.a > 0.0){float dd=max(gl_FragColor.r,max(gl_FragColor.g,gl_FragColor.b));float ed=min(gl_FragColor.r,min(gl_FragColor.g,gl_FragColor.b));float fd=(dd+ed)*0.5;vec3 gd=fd < 0.5 ? zc.rgb*fd*2.0 : mix(zc.rgb,vec3(1.0,1.0,1.0),fd*2.0-1.0);gl_FragColor.rgb=mix(gl_FragColor.rgb,gd,zc.a);}gl_FragColor.rgb=xc*gl_FragColor.rgb+yc;gl_FragColor.a=v(gl_FragColor.a)*v(Xc)*wc;if(cc !=d && bc.a > 0.0)gl_FragColor.rgb=bc.rgb;gl_FragColor.rgb*=gl_FragColor.a;gl_FragColor.rgb=clamp(gl_FragColor.rgb,0.0,1.0);if(cc==d){if(gl_FragColor.a > 0.0)gl_FragColor=bc;else gl_FragColor=vec4(0.0,0.0,0.0,0.0);}if(ufrag_35==1){float hd=1.0-gl_FragColor.a;gl_FragColor=vec4(hd+gl_FragColor.rgb,gl_FragColor.a);}else if(gl_FragColor.a==0.0){gl_FragColor=vec4(0.0,0.0,0.0,0.0);}}",a:["a_v","a_0","a_1"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_6","ufrag_8","ufrag_9","ufrag_10","ufrag_11","ufrag_12","ufrag_13","ufrag_14","ufrag_15","ufrag_16","ufrag_17","ufrag_18","ufrag_19","ufrag_20","ufrag_21","ufrag_22","ufrag_23","ufrag_24","ufrag_25","ufrag_26","ufrag_27","ufrag_28","ufrag_29","ufrag_30","ufrag_31","ufrag_32","ufrag_34","ufrag_35","ufrag_36","ufrag_37","ufrag_38","ufrag_39","ufrag_40","ufrag_41","ufrag_42","ufrag_43","ufrag_44","u_0","u_1","u_2","u_3","u_4","u_5","u_6","u_7","u_8","u_10","u_11","u_13","u_14","u_15","u_16","u_17","u_18","u_19","u_20","u_21"],s:["t_0","t_1","t_2","t_3","t_4","t_5","t_6","t_7"]},{v:"precision highp float;uniform int u_0;uniform vec2 u_1;uniform vec2 u_2;uniform mat3 u_3;attribute vec2 a_v;attribute vec4 a_p1;attribute vec4 a_p2;varying vec2 c;void main(){if(u_0==0){gl_Position=vec4(a_v,0.0,1.0);}else{vec2 s;if(a_v.x > 0.0){vec2 N=(a_v.y < 0.0)? a_p1.xy : a_p2.xy;gl_Position=vec4((((u_3*vec3(N,1.0)).xy-u_1)*u_2)*vec2(2.0,-2.0),0.0,1.0);}else gl_Position=vec4(0.0,0.0,0.0,1.0);}c=a_v*vec2(0.5,-0.5)+vec2(0.5,0.5);}",f:"precision highp float;uniform float bfrag_0 [ 11 ];uniform vec4 bfrag_1 [ 11 ];uniform int ufrag_0;uniform vec2 ufrag_2;uniform int ufrag_4;uniform vec2 ufrag_5;uniform float ufrag_6;uniform float ufrag_7;varying vec2 c;vec4 d(vec4 e,float f,float h){return vec4(pow(e.r,f),pow(e.g,f),pow(e.b,f),pow(e.a,h));}vec4 i(float j){float k=ufrag_6;float h=ufrag_7;float l=1.0/k;float m=1.0/h;for(int n=0;n < 10;n++){if(j <=bfrag_0 [ n+1 ]){vec4 o=d(bfrag_1 [ n ],k,h);vec4 p=d(bfrag_1 [ n+1 ],k,h);return d(mix(o,p,(j-bfrag_0 [ n ])/(bfrag_0 [ n+1 ]-bfrag_0 [ n ])),l,m);}}return bfrag_1 [ 10 ];}float q(vec2 s,vec2 t){vec2 u=s-t;float v=dot(u,u);float A=t.x*s.y-s.x*t.y;vec2 B=u*A;float C=sqrt(v-A*A);vec2 D=u*C;vec2 E=vec2((B.y+sign(D.y)*D.x),(-B.x+abs(D.y)))/v;vec2 F=vec2((B.y-sign(D.y)*D.x),(-B.x-abs(D.y)))/v;vec2 G=sign(length(E-t)-length(F-t))==sign(dot(t-s,t))? E : F;float j=length(s-t)/length(G-t);return clamp(j,0.0,1.0);}float H(float x){return x < 0.5 ? 2.0*x*x : 2.0*x*(2.0-x)-1.0;}float I(float x,float J){return x < J ? H(x/J): H((1.0-x)/(1.0-J));}float K(float x,float J){return x < J ? x/J :(1.0-x)/(1.0-J);}void main(){float j=c.x;if(ufrag_0==1){vec2 t=ufrag_2;j=q(c*2.0-1.0,t*2.0-1.0);}if(ufrag_4 !=0){float L=I(j,ufrag_5.x)*ufrag_5.y;float M=K(j,ufrag_5.x)*ufrag_5.y;gl_FragColor=vec4(i(L).rgb,i(M).a);}else{gl_FragColor=i(j);}}",a:["a_v","a_p1","a_p2"],u:["bfrag_0","bfrag_1","ufrag_0","ufrag_2","ufrag_4","ufrag_5","ufrag_6","ufrag_7","u_0","u_1","u_2","u_3"],s:[]},{v:"precision highp float;uniform float u_0;uniform vec2 u_1;uniform vec2 u_2;uniform vec2 u_3;uniform int u_4;attribute vec2 a_v;varying vec2 c,d,e,f,h,i,j,k,l;void main(){vec2 G=a_v;float H=u_0;vec2 I=u_1;vec2 J=u_2;vec2 K=u_3;int p=u_4;gl_Position=vec4(G.x,-G.y,0.0,1.0);vec2 L=(vec2(G.x,-G.y)*I/2.0)+vec2(0.5,0.5);if(p==1){vec2 M=J*vec2(2.0*H/(K.x*8.0),2.0*H/(K.y*8.0));vec2 N=L-J*vec2(H/K.x,H/K.y);c=N;d=N+M;e=N+M*2.0;f=N+M*3.0;h=N+M*4.0;i=N+M*5.0;j=N+M*6.0;k=N+M*7.0;l=N+M*8.0;}else{vec2 r=vec2(H/K.x,H/K.y);c=L+r*vec2(-0.7,-0.7);d=L+r*vec2(0.0,-1.0);e=L+r*vec2(0.7,-0.7);f=L+r*vec2(-1.0,0.0);h=L;i=L+r*vec2(1.0,0.0);j=L+r*vec2(-0.7,0.7);k=L+r*vec2(0.0,1.0);l=L+r*vec2(0.7,0.7);}}",f:"precision highp float;uniform sampler2D tex_0;uniform vec4 ufrag_0;uniform float ufrag_2;uniform int ufrag_3;uniform int ufrag_4;varying vec2 c,d,e,f,h,i,j,k,l;void main(){vec4 m=ufrag_0;int n=ufrag_3;float o=ufrag_2;int p=ufrag_4;vec4 q=p==1 ? vec4(1.20,1.15,1.10,1.05)*o : vec4(1.20,1.20,1.20,1.20)*o;vec4 s=texture2D(tex_0,c,q [ 0 ]);vec4 t=texture2D(tex_0,d,q [ 1 ]);vec4 u=texture2D(tex_0,e,q [ 2 ]);vec4 v=texture2D(tex_0,f,q [ 3 ]);vec4 A=texture2D(tex_0,h,o);vec4 B=texture2D(tex_0,i,q [ 3 ]);vec4 C=texture2D(tex_0,j,q [ 2 ]);vec4 D=texture2D(tex_0,k,q [ 1 ]);vec4 E=texture2D(tex_0,l,q [ 0 ]);if(n==0){vec4 F=s*0.000229+t*0.005977+u*0.060598+v*0.241732+A*0.382928+B*0.241732+C*0.060598+D*0.005977+E*0.000229;gl_FragColor=clamp(F,0.0,1.0);}else if(n==1){float F=s.a*0.000229+t.a*0.005977+u.a*0.060598+v.a*0.241732+A.a*0.382928+B.a*0.241732+C.a*0.060598+D.a*0.005977+E.a*0.000229;gl_FragColor=vec4(m.rgb,1.0)*m.a*F;}else if(n==2){float F=min(min(min(min(s.a,t.a),min(u.a,v.a)),min(min(A.a,B.a),min(C.a,D.a))),E.a);gl_FragColor=vec4(m.rgb,1.0)*m.a*F;}else if(n==3){float F=max(max(max(max(s.a,t.a),max(u.a,v.a)),max(max(A.a,B.a),max(C.a,D.a))),E.a);gl_FragColor=vec4(m.rgb,1.0)*m.a*F;}}",a:["a_v"],u:["ufrag_0","ufrag_2","ufrag_3","ufrag_4","u_0","u_1","u_2","u_3","u_4"],s:["tex_0"]},{v:"precision highp float;attribute vec2 a_v;varying vec2 c;void main(){vec2 v=a_v;gl_Position=vec4(v.x,-v.y,0.0,1.0);c=(vec2(v.x,v.y)/2.0)+vec2(0.5,0.5);}",f:"precision highp float;varying vec2 c;const int d=1,e=2,f=3,h=4,i=5,j=6,k=7,l=8,m=9,n=10,o=11,p=12;uniform int ufrag_0;uniform float ufrag_1;void main(){const float PI=3.141592653;const float q=0.707106781;int s=ufrag_0;float t=ufrag_1;float u=0.0,x=c.x,y=c.y;if(s==d)u=1.0-x*t;else if(s==e)u=max(abs(x*2.0-1.0),abs(y*2.0-1.0));else if(s==f)u=1.0-(x*t+floor(y*t)/2.0);else if(s==h)u=length(c*2.0-vec2(1.0,1.0))*q;else if(s==i)u=(abs(x*2.0-1.0)+abs(y*2.0-1.0))*0.5;else if(s==j)u=fract(sin(dot(c,vec2(12.9898,78.233)))*43758.5453);else if(s==k)u=min(abs(x*2.0-1.0),abs(y*2.0-1.0));else if(s==l)u=fract(sin(x*12.9898)*43758.5453);else if(s==m)u=abs(x*2.0-1.0);else if(s==n)u=1.0-(ceil(x*t)+ceil(y*t))/(2.0*t);else if(s==o)u=1.0-atan(abs(x-0.5),0.5-y)/PI;else if(s==p)u=1.0-atan(x-0.5,0.5-y)*t/(2.0*PI);gl_FragColor=vec4(mod(u,1.0),0.0,0.0,1.0);}",a:["a_v"],u:["ufrag_0","ufrag_1"],s:[]},{v:"precision highp float;attribute vec2 a_v;attribute vec4 a_0;attribute vec4 a_1;varying vec2 c;const int i=0,j=1,k=2,l=3;void main(){vec2 m=a_v;vec4 n=a_0,o=a_1;vec2 p=m*0.5+0.5;c=vec2(n [ i ]+(n [ k ]-n [ i ])*p.x,1.0-(n [ j ]+(n [ l ]-n [ j ])*p.y));gl_Position=vec4((o [ i ]+(o [ k ]-o [ i ])*p.x)*2.0-1.0,1.0-((o [ j ]+(o [ l ]-o [ j ])*p.y)*2.0),0.0,1.0);}",f:"precision highp float;uniform sampler2D t_0;uniform float ufrag_0;varying vec2 c;float d(float e){return clamp(e,0.0,1.0);}void main(){float f=ufrag_0;vec4 h=texture2D(t_0,c);h.rgb=(h.rgb-0.5)*f+0.5;gl_FragColor=h;}",a:["a_v","a_0","a_1"],u:["ufrag_0"],s:["t_0"]},{v:"precision highp float;attribute vec2 a_v;attribute vec4 a_0;attribute vec4 a_1;varying vec2 c;const int ec=0,fc=1,gc=2,hc=3;void main(){vec2 ic=a_v;vec4 jc=a_0,kc=a_1;vec2 lc=ic*0.5+0.5;c=vec2(jc [ ec ]+(jc [ gc ]-jc [ ec ])*lc.x,1.0-(jc [ fc ]+(jc [ hc ]-jc [ fc ])*lc.y));gl_Position=vec4((kc [ ec ]+(kc [ gc ]-kc [ ec ])*lc.x)*2.0-1.0,1.0-((kc [ fc ]+(kc [ hc ]-kc [ fc ])*lc.y)*2.0),0.0,1.0);}",f:"precision highp float;uniform sampler2D t_0;uniform sampler2D t_1;uniform sampler2D t_2;uniform sampler2D t_3;uniform float ufrag_0;uniform int ufrag_1;varying vec2 c;uniform int ufrag_3;uniform vec2 ufrag_4;uniform vec4 ufrag_5;uniform int ufrag_6;uniform float ufrag_7;uniform float ufrag_8;uniform float ufrag_9;uniform int ufrag_10;uniform float ufrag_11;uniform float ufrag_12;uniform vec3 ufrag_13;uniform vec3 ufrag_14;uniform int ufrag_15;uniform float ufrag_16;uniform float ufrag_17;uniform float ufrag_18;uniform vec4 ufrag_19;uniform int ufrag_20;uniform float ufrag_21;uniform vec2 ufrag_22;uniform vec4 ufrag_23;uniform int ufrag_24;uniform int ufrag_25;uniform vec4 ufrag_26;uniform vec4 ufrag_27;uniform vec4 ufrag_28;const int d=0;const int e=1;const int f=2;const int h=3;const int i=4;float j(float k){return clamp(k,0.0,1.0);}vec3 l(vec3 rgb){float m=max(rgb.r,max(rgb.g,rgb.b));float n=min(rgb.r,min(rgb.g,rgb.b));float o=(m+n)*0.5;if(m==n)return vec3(0.0,0.0,o);float p=(m-n)*2.0;float q=m+n;float s=0.5*p/((o <=0.5)? q : 2.0-q);float t=(rgb.r==m)?((rgb.g-rgb.b)/p)/3.0 :(rgb.g==m)?(1.0+(rgb.b-rgb.r)/p)/3.0 :(2.0+(rgb.r-rgb.g)/p)/3.0;return vec3(fract(t),s,o);}float u(float v,float A,float B){float C=fract(B);return(C*6.0 < 1.0)? v+(A-v)*C*6.0 :(C*2.0 < 1.0)? A :(C*3.0 < 2.0)? v+(A-v)*(4.0-C*6.0): v;}vec3 D(vec3 E){float A=(E.z <=0.5)? E.z+E.z*E.y : E.z+E.y-E.z*E.y;float v=2.0*E.z-A;return vec3(u(v,A,E.x+1.0/3.0),u(v,A,E.x),u(v,A,E.x-1.0/3.0));}const vec3 F=vec3(2.2,2.2,2.2);const vec3 G=vec3(1.0/2.2,1.0/2.2,1.0/2.2);const vec2 H=vec2(.5,.5);vec4 I(vec4 J,vec3 K){return vec4(pow(J.rgb,K),J.a);}vec4 L(vec4 M){const int N=7;const int O=(N-1)/2;float P [ N ];float Q=ufrag_21 < 0.0 ?-1.0*ufrag_21*5.0 : 5.0;float R=1.0/Q;float S=R*R;float T=0.0;for(int U=0;U < O;U++){float V=float(U);float W=0.39894*R*exp(-0.5*V*V*S);P [ O+U ]=W;P [ O-U ]=W;T+=2.0*W;}T-=P [ O ];vec4 X=vec4(0.0);for(int U=-O;U <=O;U++){for(int Y=-O;Y <=O;Y++){vec4 Z=texture2D(t_0,c+3.0*vec2(float(U),float(Y))/ufrag_22);X+=P [ O+Y ]*P [ O+U ]*Z;}}X/=T*T;if(ufrag_21 < 0.0){return X;}else{vec4 ab=M-X;vec4 bb=M+ab*ufrag_21*4.0;return clamp(bb,0.0,1.0);}}vec3 cb(vec3 rgb,vec4 q){return clamp(q [ 0 ]*rgb*rgb*rgb+q [ 1 ]*rgb*rgb+q [ 2 ]*rgb+q [ 3 ],0.0,1.0);}vec2 db(float eb,vec3 fb,float gb,vec2 hb){float ib=floor(eb/gb);float jb=eb-ib*gb;return vec2(jb,ib)*fb.rg+hb;}vec3 kb(vec3 J,vec3 fb,float gb){vec2 lb=fb.rg*vec2(gb,ceil(fb.b/gb));vec3 mb=clamp(J,0.0,1.0)*(fb-vec3(1.0));vec2 hb=mb.rg+vec2(0.5);float nb=floor(mb.b);float ob=min(nb+1.0,fb.b-1.0);vec3 a=texture2D(t_2,db(nb,fb,gb,hb)/lb).rgb;vec3 b=texture2D(t_2,db(ob,fb,gb,hb)/lb).rgb;return mix(a,b,mb.b-nb);}const int pb=8;const int qb=16;const float rb=float(qb)*sqrt(3.0);vec3 sb(int U){return texture2D(t_3,vec2(float(U)/255.0,0.0)).rgb;}vec4 tb(vec3 ub,int vb [ pb ]){float wb=rb;int xb=0;vec3 yb=vec3(0.0);for(int U=0;U < pb;U++){int zb=vb [ U ];vec3 J=sb(zb);float V=length(J-ub);if(V < wb){xb=zb;yb=J;wb=V;}}return vec4(yb,float(xb));}int Ab(vec3 M,int vb [ pb ]){vec3 ub=M;int xb=0;float Bb=fract(sin(dot(c,vec2(12.9898,78.233)))*43758.5453);int Cb=int(Bb*float(qb-1));for(int Db=0;Db < qb;Db++){vec4 Eb=tb(ub,vb);vec3 yb=Eb.rgb;xb=int(Eb.a);if(Db==Cb){return xb;}ub=((ub+(ub-yb))+M)*0.5;}return xb;}int Fb(vec3 M){int vb [ pb ];float Gb [ pb ];for(int zb=0;zb < pb;zb++){vb [ zb ]=zb;Gb [ zb ]=length(sb(zb)-M);}for(int zb=pb;zb < 256;zb++){int Hb=0;float Ib=0.0;for(int Jb=0;Jb < pb;Jb++){float Kb=Gb [ Jb ];if(Kb > Ib){Hb=Jb;Ib=Kb;}}vec3 J=sb(zb);float V=length(J-M);if(V < Ib){for(int Jb=0;Jb < pb;Jb++){if(Jb==Hb){vb [ Jb ]=zb;Gb [ Jb ]=V;}}}}return Ab(M,vb);}vec3 Lb(vec3 M){vec4 Mb=ufrag_26;vec4 Nb=ufrag_27;vec4 Ob=ufrag_28;float Pb=j(dot(M,vec3(0.2126,0.7152,0.0722)));vec4 Qb=Mb+Nb*j(Pb*3.0-1.5)-Ob*j(Pb*-3.0+1.5);return mix(vec3(Pb),M*Qb.rgb,Qb.a);}vec4 Rb(vec4 M){if(ufrag_3+ufrag_6+ufrag_10+ufrag_15+ufrag_20+ufrag_25==0 &&(ufrag_23.x <=1.0)){return M;}vec4 Sb=vec4(M);if(ufrag_20==1){Sb=L(Sb);}Sb.rgb=Sb.a==0.0 ? vec3(0.0,0.0,0.0): Sb.rgb/Sb.a;if(ufrag_15==1){Sb.r*=ufrag_16;Sb.b*=ufrag_17;Sb.g*=ufrag_18;}if(ufrag_6==1){vec3 E=l(Sb.rgb);E=vec3(fract(E.x+ufrag_7),E.yz*vec2(ufrag_8,ufrag_9));Sb.rgb=clamp(D(E),0.0,1.0);}if(ufrag_3==1){Sb.rgb=ufrag_4 [ 0 ]*Sb.rgb+ufrag_4 [ 1 ];if(ufrag_5 [ 0 ] < 0.0){Sb.rgb=clamp(Sb.rgb,0.0,1.0);}Sb.rgb=cb(Sb.rgb,ufrag_5);}if(ufrag_25==1){Sb.rgb=Lb(Sb.rgb);}if(ufrag_10==1){const vec3 Tb=vec3(0.2125,0.7154,0.0721);float Ub=clamp(dot(Sb.rgb,Tb)*ufrag_11+ufrag_12,0.0,1.0);Sb.rgb=mix(ufrag_13,ufrag_14,Ub);}if(ufrag_23.x > 1.0){Sb.rgb=kb(Sb.rgb,ufrag_23.xyz,ufrag_23.w);}Sb.rgb*=Sb.a;return Sb;}void main(){float Vb=ufrag_0;int Wb=ufrag_1;vec4 Xb=ufrag_19;vec4 Yb=texture2D(t_0,c);Yb.rgb=(Yb.rgb-0.5)*Vb+0.5;Yb.rgb=(Wb==f)? vec3(Yb.b,Yb.g,Yb.r): Yb.rgb;if(Wb==h || Wb==i){vec4 Zb=texture2D(t_1,c);if(Wb==h){vec4 ac=Zb;vec3 bc=vec3(Yb.r,ac.r,ac.a)*255.0-vec3(16.0,128.0,128.0);vec3 rgb=bc*mat3(1.164383,0.0,1.596027,1.164383,-0.391762,-0.812968,1.164383,2.017232,0.0);Yb.rgb=clamp(rgb/255.0,0.0,1.0);}else if(Wb==i){Yb*=Zb.r;}}else if(Wb==e){Yb=Rb(Yb);}if(Xb.a !=0.0){float cc=Xb.a*Yb.a;Yb=vec4(Xb.rgb*cc,cc);}if(ufrag_24==1){int dc=Fb(Yb.rgb);Yb=vec4(sb(dc),1.0);}gl_FragColor=Yb;}",a:["a_v","a_0","a_1"],u:["ufrag_0","ufrag_1","ufrag_3","ufrag_4","ufrag_5","ufrag_6","ufrag_7","ufrag_8","ufrag_9","ufrag_10","ufrag_11","ufrag_12","ufrag_13","ufrag_14","ufrag_15","ufrag_16","ufrag_17","ufrag_18","ufrag_19","ufrag_20","ufrag_21","ufrag_22","ufrag_23","ufrag_24","ufrag_25","ufrag_26","ufrag_27","ufrag_28"],s:["t_0","t_1","t_2","t_3"]},{v:"precision highp float;uniform mat3 u_0;uniform mat3 u_1;uniform mat3 u_2;uniform mat3 u_3;uniform vec2 u_4;attribute vec2 a_v;varying vec2 c;varying vec2 d;vec2 Kb(vec2 Lb,mat3 Mb){return(Mb*vec3(vec2(Lb.x/2.0,Lb.y/2.0),1.0)).xy*vec2(1.0,-1.0)+vec2(0.5,0.5);}void main(){vec2 Nb=a_v;mat3 Ob=u_0;mat3 Pb=u_1;mat3 Qb=u_2;mat3 Rb=u_3;vec2 Sb=u_4;c=Kb(Nb.xy,Qb);d=Kb(Nb.xy,Rb);vec2 Tb=(Ob*vec3(Nb.xy/2.0,1.0)).xy;vec2 Ub=(Pb*vec3(Tb,1.0)).xy;gl_Position=vec4((Ub/Sb-vec2(0.5,0.5))*vec2(2.0,-2.0),0.0,1.0);}",f:"precision highp float;uniform sampler2D t_0;uniform sampler2D t_1;uniform sampler2D t_2;varying vec2 c;varying vec2 d;uniform int ufrag_0;uniform vec2 ufrag_1;uniform float ufrag_2;uniform float ufrag_3;uniform vec2 ufrag_4;uniform vec4 ufrag_5;uniform vec4 ufrag_6 [ 4 ];uniform vec3 ufrag_7 [ 4 ];uniform vec4 ufrag_8 [ 4 ];uniform vec4 ufrag_9;uniform vec4 ufrag_10;uniform vec4 ufrag_11;uniform vec4 ufrag_12;uniform vec4 ufrag_13;uniform int ufrag_14;uniform float ufrag_15;uniform vec4 ufrag_16;uniform float ufrag_17;const int e=0;const int f=1;const int h=2;float i(vec2 j,float k,float l){vec2 m=ufrag_1;float n=ufrag_2;float o=ufrag_3;vec2 p=ufrag_4;float q=texture2D(t_1,j+m*vec2(k,l)).r;float s=clamp((q*n+o)/p.x,0.0,1.0);return texture2D(t_2,vec2(s,1.0)).r*p.y;}vec3 t(vec2 j){float u=i(j,-1.0,-1.0);float v=i(j,0.0,-1.0);float A=i(j,1.0,-1.0);float B=i(j,-1.0,0.0);float C=i(j,0.0,0.0);float D=i(j,1.0,0.0);float E=i(j,-1.0,1.0);float F=i(j,0.0,1.0);float G=i(j,1.0,1.0);vec3 H=normalize(vec3(1.0,0.0,v-u));vec3 I=normalize(vec3(1.0,0.0,A-v));vec3 J=normalize(vec3(1.0,0.0,C-B));vec3 K=normalize(vec3(1.0,0.0,D-C));vec3 L=normalize(vec3(1.0,0.0,F-E));vec3 M=normalize(vec3(1.0,0.0,G-F));vec3 N=normalize(vec3(0.0,1.0,B-u));vec3 O=normalize(vec3(0.0,1.0,C-v));vec3 P=normalize(vec3(0.0,1.0,D-A));vec3 Q=normalize(vec3(0.0,1.0,E-B));vec3 R=normalize(vec3(0.0,1.0,F-C));vec3 S=normalize(vec3(0.0,1.0,G-D));return normalize(cross(H,N)+cross(H,O)+cross(I,O)+cross(I,P)+cross(J,N)+cross(J,O)+cross(K,O)+cross(K,P)+cross(J,Q)+cross(J,R)+cross(K,R)+cross(K,S)+cross(L,Q)+cross(L,R)+cross(M,R)+cross(M,S));}vec4 T(vec4 U,vec4 V){float W=V.a+U.a*(1.0-V.a);return vec4((V.rgb*V.a+U.rgb*U.a*(1.0-V.a))/W,W);}void main(){int X=ufrag_0;vec4 Y=texture2D(t_0,c);if(X !=0){vec4 Z=vec4(Y.rgb/Y.a,Y.a);int ab=ufrag_14;if(ab==f){Z=vec4(0.0,0.0,0.0,0.0);}else{vec3 bb=t(d);vec4 cb=ufrag_5;vec4 db=ufrag_9;vec4 eb=ufrag_10;vec4 fb=ufrag_11;vec4 gb=ufrag_12;vec4 hb=ufrag_13;vec3 ib=gb.rgb+cb.rgb*fb.rgb;vec3 jb=vec3(0.0,0.0,-1.0);float kb=hb.x;bool lb=hb.y !=0.0;;vec3 mb=vec3(0.0,0.0,0.0);vec3 nb=vec3(0.0,0.0,0.0);for(int ob=0;ob < 4;ob++){vec3 pb=ufrag_6 [ ob ].rgb;vec3 qb=ufrag_7 [ ob ];float rb=ufrag_8 [ ob ].x;float sb=ufrag_8 [ ob ].y;float tb=ufrag_8 [ ob ].z;float ub=ufrag_8 [ ob ].w;float vb=-dot(bb,qb);vb=vb*rb+sb;mb+=clamp(vb,0.0,1.0)*tb*pb;float wb=0.0;if(lb){vec3 xb=-normalize(jb+qb);wb=dot(xb,bb);}else{vec3 yb=jb-2.0*bb*dot(bb,jb);wb=-dot(yb,qb);}wb=pow(max(0.0,wb),kb);nb+=clamp(wb,0.0,1.0)*ub*pb;}mb*=db.rgb;nb*=eb.rgb;float zb=Z.a*db.a;float Ab=hb.z;float Bb=hb.w;float Cb=1.0-abs(dot(jb,bb));if(Bb > 0.0){zb+=(1.0-zb)*pow(Cb,Bb);}else if(Bb < 0.0){zb-=zb*pow(Cb,-Bb);}if(Ab > 0.0){mb+=(vec3(1.0,1.0,1.0)-mb)*pow(Cb,Ab);}else if(Ab < 0.0){mb-=mb*pow(Cb,-Ab);}if(ab==h){const float Db=0.5;mb+=nb*Db;nb*=(1.0-Db);}Z.rgb=clamp(Z.rgb*(ib+mb)+nb,0.0,1.0);Z.a=clamp(zb,0.0,1.0);}float Eb=ufrag_15;if(Eb > 0.0){float n=ufrag_2;float o=ufrag_3;vec4 Fb=ufrag_16;float Gb=ufrag_17;float Hb=max(Eb,Gb)*0.5;float Ib=abs(texture2D(t_1,d).r*n+o);float Jb=clamp(Hb-Ib,0.0,1.0);Z=T(Z,Fb*vec4(1.0,1.0,1.0,Jb));}Y=vec4(Z.rgb*Z.a,Z.a);}gl_FragColor=Y;}",a:["a_v"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_5","ufrag_6","ufrag_7","ufrag_8","ufrag_9","ufrag_10","ufrag_11","ufrag_12","ufrag_13","ufrag_14","ufrag_15","ufrag_16","ufrag_17","u_0","u_1","u_2","u_3","u_4"],s:["t_0","t_1","t_2"]},{v:"precision highp float;attribute vec2 a_v;attribute vec4 a_0;attribute vec4 a_1;varying vec2 c;uniform mat3 u_1;const int rb=0,sb=1,tb=2,ub=3;void main(){vec2 vb=a_v;vec4 wb=a_0,xb=a_1;vec2 yb=vb*0.5+0.5;c=vec2(wb [ rb ]+(wb [ tb ]-wb [ rb ])*yb.x,1.0-(wb [ sb ]+(wb [ ub ]-wb [ sb ])*yb.y));c=(u_1*vec3(c.x,c.y,1.0)).xy;gl_Position=vec4((xb [ rb ]+(xb [ tb ]-xb [ rb ])*yb.x)*2.0-1.0,1.0-((xb [ sb ]+(xb [ ub ]-xb [ sb ])*yb.y)*2.0),0.0,1.0);}",f:"precision highp float;uniform sampler2D t_0;uniform float ufrag_0;uniform int ufrag_1;uniform float ufrag_2;uniform vec2 ufrag_3;uniform int ufrag_4;uniform int ufrag_5;uniform vec2 ufrag_22;varying vec2 c;const float PI=3.141592653;float d(float e){return clamp(e,0.0,1.0);}vec3 f(vec3 rgb){float h=max(rgb.r,max(rgb.g,rgb.b));float i=min(rgb.r,min(rgb.g,rgb.b));float j=(h+i)*0.5;if(h==i)return vec3(0.0,0.0,j);float k=(h-i)*2.0;float l=h+i;float m=0.5*k/((j <=0.5)? l : 2.0-l);float n=(rgb.r==h)?((rgb.g-rgb.b)/k)/3.0 :(rgb.g==h)?(1.0+(rgb.b-rgb.r)/k)/3.0 :(2.0+(rgb.r-rgb.g)/k)/3.0;return vec3(fract(n),m,j);}float o(float x){return fract(sin(x*12.9898)*43758.5453);}float p(vec2 q){float s=ufrag_2;const float t=1.0;const float u=0.7;vec2 v=vec2(q.x,(1.0-q.y-(1.0-cos(q.x*PI/4.0))*t)*(1.0+t*0.5));float A=(v.x+v.y)*0.5;float B=d(((v.x-v.y)*0.5)/(1.0-abs(A-0.5)*2.0)*u+0.5);float C=floor(A*s);return d(1.0-1.0*(fract(C/2.0)==0.0 ?(C+B)/s :(C+1.0-B)/s));}float D(vec2 q,bool E){float s=ufrag_2;float F=p(q);float G=1.0-floor(q.x*s)/s;return mix(E ? o(G): G,F,E ? 0.3 : 0.1);}float H(vec2 q,vec2 I){float J=ufrag_2;float K=1.0-atan(q.x-I.x,q.y-I.y);float L=1.0+J*(sin(K*3.0)*0.1+sin(K*7.0)*0.05+sin(K*11.0)*0.03);return max(0.0,1.0-length(q-I)*L);}float M(vec2 q,vec2 I){bool N=ufrag_5 !=0;float O=N ? ufrag_22.y/ufrag_22.x : ufrag_22.x/ufrag_22.y;float s=ufrag_2;vec2 e=q-I;e*=O > 1.0 ? vec2(O,1.0): vec2(1.0,1.0/O);float P=length(e)*sqrt(2.0);if(P < 0.01/s){return 1.0;}float K=0.5+atan(e.y,e.x)/(2.0*PI);return(floor((1.0-P)*s-K)+K)/s;}void main(){const int Q=2;const float R=float((Q*2+1)*(Q*2+1));const float S=1.0;const float T=3.0;const float U=1.0;const float V=1.0;const vec3 W=vec3(0.0,0.0,-1.0);const float s=15.0;const vec2 X=vec2(1.0,1.0);bool N=ufrag_5 !=0;bool Y=c.x < 0.0 || c.y < 0.0 || c.x > 1.0 || c.y > 1.0;vec4 Z=texture2D(t_0,c);float ab=0.0;float bb=0.0;float cb=0.0;for(int db=-Q;db <=Q;db++){for(int eb=-Q;eb <=Q;eb++){vec2 fb=c+vec2(float(eb),float(db))*S/ufrag_22;vec4 gb=texture2D(t_0,fb);ab+=abs(Z.r-gb.r)+abs(Z.g-gb.g)+abs(Z.b-gb.b);vec2 hb=ufrag_3.xy;vec2 ib=N ? vec2(1.0-fb.y,1.0-fb.x): fb;ib=vec2(hb.x > 0.0 ? ib.x : 1.0-ib.x,hb.y > 0.0 ? ib.y : 1.0-ib.y);float jb=0.5;if(ufrag_1==1){jb=p(ib);}else if(ufrag_1==2){jb=H(ib,vec2(0.0,0.0));}else if(ufrag_1==3){jb=H(ib,vec2(0.5,0.5));}else if(ufrag_1==4){jb=D(ib,false);}else if(ufrag_1==5){jb=D(ib,true);}else if(ufrag_1==6){jb=M(ib,vec2(0.5,0.5));}bb+=jb;if(ufrag_4==0){cb+=0.5;}else{vec3 kb=f(Z.rgb);if(ufrag_4==1){cb+=1.0-smoothstep(0.4,0.6,kb [ 2 ]);}if(ufrag_4==2){cb+=smoothstep(0.4,0.6,kb [ 2 ]);}}}}ab=U*T*ab/R;bb=V*bb/R;cb=cb/R;vec3 lb=f(Z.rgb);vec3 mb=vec3(W.x < 0.0 ? 1.0 : 0.0,W.y < 0.0 ? 1.0 : 0.0,W.z < 0.0 ? 1.0 : 0.0)+f(Z.rgb)*W;float L=d((ab+bb+mb.x+mb.y+mb.z)/(U+V+abs(W.x)+abs(W.y)+abs(W.z)));float nb=fract(sin(dot(c,vec2(12.9898,78.233)))*43758.5453);float ob=1.0-nb*0.2;float pb=d(min(d((ab-0.5)*1.5+0.5)*nb,0.5));float qb=d(min((ab-0.75)*4.0+0.5,0.5));if(Y){gl_FragColor=vec4(0.0,ob,0.0,bb);}else{gl_FragColor=vec4(ob,ob-pb-qb,cb,bb);}}",a:["a_v","a_0","a_1"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4","ufrag_5","ufrag_22","u_1"],s:["t_0"]},{v:"precision highp float;attribute vec2 a_v;attribute vec4 a_0;attribute vec4 a_1;varying vec2 d;const int u=0,v=1,A=2,B=3;void main(){vec2 C=a_v;vec4 D=a_0,E=a_1;vec2 F=C*0.5+0.5;d=vec2(D [ u ]+(D [ A ]-D [ u ])*F.x,1.0-(D [ v ]+(D [ B ]-D [ v ])*F.y));gl_Position=vec4((E [ u ]+(E [ A ]-E [ u ])*F.x)*2.0-1.0,1.0-((E [ v ]+(E [ B ]-E [ v ])*F.y)*2.0),0.0,1.0);}",f:"precision highp float;uniform sampler2D t_0;uniform sampler2D t_1;uniform float ufrag_0;uniform float ufrag_1;uniform float ufrag_2;uniform int ufrag_3;uniform bool ufrag_4;const int c=22;varying vec2 d;void main(){vec2 e=ufrag_3==0 ? vec2(1.0/512.0,0.0): vec2(0.0,1.0/512.0);e*=ufrag_1;if(ufrag_2 > 1.0 && ufrag_3==0){e/=ufrag_2;}else if(ufrag_2 < 1.0 && ufrag_3==1){e*=ufrag_2;}float f=1.0/ufrag_0;float h=f*f;float i=-0.5*h;float j=0.39894*f;float k=j;vec4 l=k*texture2D(t_0,d);float m=0.0;m+=k;for(int n=1;n < c;n++){float o=float(n);float p=j*exp(o*o*i);l+=p*texture2D(t_0,d+(o*e));l+=p*texture2D(t_0,d+(-o*e));m+=2.0*p;}vec4 q=l/m;if(ufrag_4){vec4 s=texture2D(t_1,d);vec4 t=s-q;q=s+t*ufrag_0*9.0;q=clamp(q,0.0,1.0);}gl_FragColor=q;}",a:["a_v","a_0","a_1"],u:["ufrag_0","ufrag_1","ufrag_2","ufrag_3","ufrag_4"],s:["t_0","t_1"]}],ot={x:0,y:0,width:1,height:1},lt=[{attributeName:"",index:0,attributeSize:2,offset:0,divisor:0}];class dt{constructor(e,t,i,r){this.m_shaderPrograms=new Array(10),this.m_isInitializeReady=!0,this.m_isInScope=!1,this.m_stateRestorer=r,this.m_wipeStateBetweenScopes=t,this.m_disableParallelShaderCompile=i,this.setWebGLContextOrBabylonEngine(e)}getBabylonEngine(){return this.m_engine}get quadMesh(){return this.m_quadMesh}get emptyTexture(){return this.m_emptyTexture}get whiteTexture(){return this.m_whiteTexture}needPowerOf2TexturesForTilingOrMipMap(){return this.m_needPowerOf2TexturesForTilingOrMipMap}isCurrentWebGLContext(e){return this.m_gl==e}isValid(){return this.m_gl&&!this.m_gl.isContextLost()}setWebGLContextOrBabylonEngine(e){const t=e instanceof WebGLRenderingContext||e instanceof WebGL2RenderingContext?e:e._gl;if(this.m_gl!=t){this.m_engine&&(this.m_emptyTexture&&this.m_engine._releaseTexture(this.m_emptyTexture),this.m_whiteTexture&&this.m_engine._releaseTexture(this.m_whiteTexture),this.m_quadMesh&&this.m_quadMesh.discard()),this.m_gl=t;const i=t.canvas.width,r=t.canvas.height;this.m_canvasRenderSize=new f.e(i,r),e instanceof rt.ThinEngine?this.m_engine=e:(this.m_engine=new rt.ThinEngine(t),this.m_engine.preventCacheWipeBetweenFrames=!0,this.m_engine.doNotHandleContextLost=!0,this.m_engine.setSize(i,r),this.m_engine.setViewport(ot));const n=this.m_engine.getCaps();this.m_parallelShaderCompilationExtension=n.parallelShaderCompile,n.parallelShaderCompile=void 0,this.m_renderToFilteredFloat=n.textureFloatRender&&n.textureFloatLinearFiltering,this.m_renderToFilteredHalfFloat=n.textureHalfFloatRender&&n.textureHalfFloatLinearFiltering,this.m_needPowerOf2TexturesForTilingOrMipMap=this.m_engine.needPOTTextures,this.m_uniqueGraphicsProcessorId=at,at++;for(let e=0;e<10;e++)this.m_shaderPrograms[e]=void 0}}updateViewportSize(){const e=this.m_gl.canvas.width,t=this.m_gl.canvas.height;this.m_canvasRenderSize=new f.e(e,t),this.m_engine.setSize(e,t),this.m_engine.setViewport(ot)}onWebGLContextLost(){for(let e=0;e<10;e++)this.m_shaderPrograms[e]=void 0}initializeProgramsAsync(){return Object(E.__awaiter)(this,void 0,void 0,(function*(){this.m_isInitializeReady=!1;const e=this.m_engine.getCaps();this.m_disableParallelShaderCompile||(e.parallelShaderCompile=this.m_parallelShaderCompilationExtension);const t=[];if(!this.beginRenderScopeInternal(!1))throw m.a.Error(592328457,"Failed to enter render scope.");for(let e=0;e<10;e++){const i=this.getProgramInWebGlScope(e);t.push(i.enureDoneAsync())}this.endRenderScopeInternal(!1),yield Promise.all(t),this.m_isInitializeReady=!0}))}isInRenderScope(){return this.m_isInScope}beginRenderScope(){if(!this.m_isInitializeReady)throw m.a.Error(592525269,"Please, wait for onDone to be called in initialize.");return this.beginRenderScopeInternal(!0)}endRenderScope(){this.endRenderScopeInternal(!0)}beginRenderScopeInternal(e){const t=this.m_gl.isContextLost();return this.m_isInScope&&m.a.Error(592525270,"already in glContext scope"),t&&m.a.Error(592525271,"Invalnew glContext context is lostid"),!this.m_gl||t?this.m_isInScope=!1:(this.m_isInScope=!0,e&&(this.m_stateRestorer?(this.m_stateRestorer.init(this.m_gl),this.m_stateRestorer.setDefaults(),this.m_engine.wipeCaches(!0),this.m_engine.depthCullingState.cull=!1):this.m_wipeStateBetweenScopes&&(this.m_engine.wipeCaches(!0),this.m_engine.depthCullingState.cull=!1)),this.ensureVertexBufferAndMaxTapeInitialized()),this.m_isInScope}endRenderScopeInternal(e){this.m_isInScope?this.m_gl.isContextLost()?m.a.Error(592525273,"leaving glContext context is lost"):this.m_stateRestorer&&e&&this.m_stateRestorer.restore():m.a.Error(592525272,"leaving glContext not in scope"),this.m_isInScope=!1}ensureVertexBufferAndMaxTapeInitialized(){this.m_emptyTexture||(this.m_emptyTexture=this.createTextureGraphicsResource(f.e.One,new Uint8Array([0,0,0,0]),5,!1,!1,!1,4,!1,!1)),this.m_whiteTexture||(this.m_whiteTexture=this.createTextureGraphicsResource(f.e.One,new Uint8Array([1,1,1,1]),5,!1,!1,!1,4,!1,!1)),this.m_quadMesh||(this.m_quadMesh=O.CreateGridXY(this,2,2,new f.c(-1,-1,1,1)))}getProgramInWebGlScope(e){let t=this.m_shaderPrograms[e];return t||(t=this.m_shaderPrograms[e]=new ht(this,e)),t}createTextureGraphicsResourceFromExternalWebGLTexture(e,t,i,r){let n=i instanceof WebGLTexture?i:null;if(i instanceof et.InternalTexture&&(n=i._webGLTexture),!n)throw m.a.Error(592525275,"wrong texture type");const a=new et.InternalTexture(this.m_engine,0,!0);return a._webGLTexture=n,r&&(a._framebuffer=r),a.width=e.x,a.height=e.y,a.baseWidth=e.x,a.baseHeight=e.y,a.type=0,a.format=t,a}updateTextureGraphicsResourceFromHTMLElement(e,t,i){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement){const r=this.m_gl,n=e._webGLTexture;n&&(r.bindTexture(r.TEXTURE_2D,n),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,i),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t),r.bindTexture(r.TEXTURE_2D,null))}}updateTextureGraphicsResourceFromByteBuffer(e,t,i,r){const n=this.m_engine;if(t instanceof Uint8Array||t instanceof Float32Array){let a=t,s=this.getTypeFromData(t,i);if(!(t instanceof Uint8Array&&0==s||t instanceof Float32Array&&1==s)){m.a.Error(572867294,"Wrong buffer data type: needs conversion");const e=0==s?new Uint8Array(t.length):new Float32Array(t.length),i=0==s?255:1/255;for(let r=0;r<t.length;r++)e[r]=t[r]*i;a=e}n._bindTextureDirectly(3553,e,!0,!0),this.m_gl.pixelStorei(this.m_gl.UNPACK_ALIGNMENT,r),n._uploadDataToTextureDirectly(e,a,0,0,void 0,!0),this.m_gl.pixelStorei(this.m_gl.UNPACK_ALIGNMENT,4),n._bindTextureDirectly(3553,null,!0,!0)}}createTextureGraphicsResource(e,t,i,r,n,a,s,o,l,d){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement){const r=this.m_gl;let n;if(n=r.createTexture(),n){r.bindTexture(r.TEXTURE_2D,n),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,l),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.bindTexture(r.TEXTURE_2D,null);const a=this.createTextureGraphicsResourceFromExternalWebGLTexture(e,i,n,void 0);return a&&this.setWrapMode(a,s),a}}const h=this.m_engine;let c,u=this.getTypeFromData(t,r);const f=o?2:1;if(n)c=h.createRenderTargetTexture({width:e.x,height:e.y},{generateDepthBuffer:!1,generateStencilBuffer:a,format:i,type:u,samplingMode:f,generateMipMaps:!1});else{const n=new et.InternalTexture(h,et.InternalTextureSource.Unknown);n.updateSize(e.x,e.y),n.type=u,n.format=i,n.invertY=l,h.updateTextureSamplingMode(f,n),(t instanceof Uint8Array||t instanceof Float32Array)&&this.updateTextureGraphicsResourceFromByteBuffer(n,t,r,d||4),c=n}return this.setWrapMode(c,s),c}getTypeFromData(e,t){let i=0;return t&&(e instanceof Float32Array&&this.m_renderToFilteredFloat?i=1:e||(this.m_renderToFilteredHalfFloat?i=2:this.m_renderToFilteredFloat&&(i=1))),i}setRenderTarget(e){e?(this.m_engine.bindFramebuffer(e),this.m_currentRenderTarget=e):(this.m_engine.restoreDefaultFramebuffer(),this.m_currentRenderTarget=void 0)}generateMipMap(e){this.m_engine.updateTextureSamplingMode(3,e,!0)}setWrapMode(e,t){const i=4==t?0:1==t||3==t?2:1,r=4==t?0:2==t||3==t?2:1;this.m_engine.updateTextureWrappingMode(e,i,r)}copyTexturePixelsToArray(e,t,i){const r=Math.floor(t.left),n=Math.floor(t.top),a=Math.floor(t.width),s=Math.floor(t.height);this.setRenderTarget(e);const o=this.m_engine.readPixels(r,n,a,s,i);return this.setRenderTarget(void 0),o}getCurrentViewportSize(){return this.m_currentRenderTarget?new f.e(this.m_currentRenderTarget.width,this.m_currentRenderTarget.height):this.m_canvasRenderSize}setScissorRect(e,t){if(t||!Object(f.i)(e,this.m_currentScissorRect)){const t=this.m_gl,i=this.getCurrentViewportSize();e?(t.enable(t.SCISSOR_TEST),t.scissor(e.left,i.y-e.bottom,e.width,e.height)):(t.disable(t.SCISSOR_TEST),t.scissor(0,0,i.x,i.y))}this.m_currentScissorRect=e}getUniqueGraphicsProcessorId(){return this.m_uniqueGraphicsProcessorId}isFloatTextureSupported(){return this.m_renderToFilteredFloat||this.m_renderToFilteredHalfFloat}activateShaderProgram(e){const t=this.getProgramInWebGlScope(e);return t.activate(),t}getWebGLState(){return I(this.m_gl)}preCompileShaderAsync(e){this.beginRenderScopeInternal(!1)&&(this.getProgramInWebGlScope(e),this.endRenderScopeInternal(!1))}preLinkShaderAsync(e){this.preCompileShaderAsync(e)}tryPrepareProgramResourcesInWebGlScope(e){for(let e=0;e<2;e++)this.m_shaderPrograms[e]||this.getProgramInWebGlScope(e);return!0}}class ht{constructor(e,t){this.graphicsProcessor=e,this.m_engine=e.getBabylonEngine(),this.programId=t,this.m_effect=this.createEffect()}getBabylonEngine(){return this.m_engine}getBabylonEffect(){return this.m_effect}done(){return void 0!==this.effectErrors||this.m_effect.isReady()}enureDoneAsync(){return new Promise((e,t)=>{this.done()?e(void 0):(this.m_effect.onCompileObservable.add(()=>e(void 0)),this.m_effect.onErrorObservable.add(t))})}createEffect(){return m.a.Message(592525280,"Compiling shader "+this.programId),new nt.Effect({vertexSource:st[this.programId].v,fragmentSource:st[this.programId].f,spectorName:this.programId},st[this.programId].a,st[this.programId].u,st[this.programId].s,this.m_engine,void 0,void 0,void 0,(e,t)=>{this.effectErrors=t})}activate(){this.handleActivationErrors(),this.m_engine.enableEffect(this.m_effect),this.m_currentMesh=void 0,this.bindMesh(void 0)}bindMesh(e){const t=e||this.graphicsProcessor.quadMesh;t&&t.isValid(this.graphicsProcessor)?this.m_currentMesh!=t&&(t.vertexBuffer&&t.indexBuffer&&t.isValid(this.graphicsProcessor)&&(this.m_engine._bindIndexBufferWithCache(t.indexBuffer),lt[0].index=this.m_effect.getAttributeLocationByName("a_v"),this.m_engine.bindInstancesBuffer(t.vertexBuffer,lt,!1)),this.m_currentMesh=t):m.a.Error(592525281,"Invalid Mesh")}handleActivationErrors(){if(!this.effectErrors&&this.m_effect.isReady())return;const e="Program "+this.programId+" ";if(this.effectErrors){const t=this.m_effect.getPipelineContext();if(t.vertexCompilationError)throw m.a.Error(592525282,e+"V compile failed: "+t.vertexCompilationError);if(t.fragmentCompilationError)throw m.a.Error(592525283,e+"V compile failed: "+t.fragmentCompilationError);if(t.programLinkError)throw m.a.Error(592525312,e+"link failed: "+t.programLinkError);if(t.programValidationError)throw m.a.Error(592525313,e+"validation failed: "+t.programValidationError);throw m.a.Error(592525314,e+"preparation failed:"+this.effectErrors)}if(!this.m_effect.isReady())throw m.a.Error(592525315,e+"Effect not ready yet.")}setTexture(e,t){const i=t||this.graphicsProcessor.emptyTexture;this.m_effect._bindTexture(e,i||null)}clearAndEnbaleDepthBuffer(){this.m_engine.depthCullingState.depthFunc=513,this.m_engine.depthCullingState.depthMask=!0,this.m_engine.depthCullingState.depthTest=!0,this.m_engine.clear(null,!1,!0,!1)}setDistanceFieldStencilSumIncrement(e){const t=e?34055:34056,i=this.m_engine;i.stencilState.stencilOpStencilFail=t,i.stencilState.stencilOpDepthFail=t,i.stencilState.stencilOpStencilDepthPass=t}setBlendingMode(e){const t=this.m_engine;t.alphaState.alphaBlend=!0,0==e?(t.alphaState.setAlphaBlendFunctionParameters(1,771,1,771),t.alphaState.setAlphaEquationParameters(32774,32774)):1==e?(t.alphaState.setAlphaBlendFunctionParameters(1,1,0,1),t.alphaState.setAlphaEquationParameters(32775,32774)):2==e?(t.alphaState.setAlphaBlendFunctionParameters(775,769,0,1),t.alphaState.setAlphaEquationParameters(32774,32774)):3==e?(t.alphaState.setAlphaBlendFunctionParameters(1,1,1,1),t.alphaState.setAlphaEquationParameters(32779,32779)):4==e?(t.alphaState.setAlphaBlendFunctionParameters(1,1,1,1),t.alphaState.setAlphaEquationParameters(32774,32774)):5==e?(t.alphaState.setAlphaBlendFunctionParameters(774,0,0,1),t.alphaState.setAlphaEquationParameters(32774,32774)):m.a.Error(592525318,"Wrong blending mode")}begin(e,t,i){const r=this.m_engine;this.graphicsProcessor.setRenderTarget(e),this.m_engine.setViewport(ot),t&&r.clear(t,!0,!1,!1),i?this.setBlendingMode(0):r.alphaState.alphaBlend=!1,r.depthCullingState.depthTest=!1,r.depthCullingState.depthMask=!0,r.stencilState.stencilTest=!1,r.stencilState.stencilMask=255,r.setColorWrite(!0)}end(){this.graphicsProcessor.setRenderTarget(void 0),this.m_engine.unbindInstanceAttributes(),this.m_engine.setViewport(ot)}drawQuads(e){this.bindMesh(void 0),this.m_engine.drawElementsType(0,0,6*e)}drawQuadInstances(e){this.bindMesh(void 0),this.m_engine.drawElementsType(0,0,6,e)}drawMesh(e){this.bindMesh(e),this.m_engine.drawElementsType(0,0,3*e.triangleCount)}setDummyPointerAttribute(e){if(this.graphicsProcessor.quadMesh&&this.graphicsProcessor.quadMesh.vertexBuffer){const t=this.graphicsProcessor.quadMesh.vertexBuffer,i=this.m_engine,r=[{attributeName:e,attributeSize:1,offset:0,divisor:0,index:this.m_effect.getAttributeLocationByName(e)}];i.bindInstancesBuffer(t,r,!1)}else m.a.Error(592525319,"Quad not initialized")}disableInstanceAttribute(e){this.m_engine.disableInstanceAttributeByName(e)}}const ct={itemHit:void 0,itemStack:void 0,textHit:void 0};let ut=0;class ft{constructor(e){this.cache=new Le,this.isGroup=e}releaseGeneratedResources(){this.cache.releaseGeneratedResources()}onFinalization(){if(a.o&&!this.cache.isBlankSlate){let e=0,t=0;for(const i of this.cache.getFulltextureList())i&&2!=i.releasePolicy&&(e++,t+=i.memoryUsage);const i=a.p?vt(this.cache.clientData,a.p):"";m.a.Error(529096734,`Generated resources not released on ${this.isGroup?"Group":"Shape"} ${i}, leaking ${Math.ceil(t/1e4)/100}MB on ${e} textures`)}a.n&&this.releaseGeneratedResources()}}class mt{constructor(){this.index=0}get color(){const e=this.index%256,t=(this.index-e)/256%256,i=(this.index-e-256*t)/65536%256;return new y.b(e/255,t/255,i/255,1)}next(){this.index++}}class pt{constructor(e,t,i,r){var n,a;this.scene3D=null!==(n=null==e?void 0:e.scene3D)&&void 0!==n?n:t.scene3D;const o=null!==(a=null==e?void 0:e.fade)&&void 0!==a?a:t.fade;if(o){if(this.fade=o.clone(),o.isDistributedByLength&&(null==e?void 0:e.drawDistribution)&&r+1<e.drawDistribution.length){const t=e.drawDistribution[r],i=e.drawDistribution[r+1];this.fade.progress=(o.progress-t)/(i-t)}else o.isDistributedByLength&&e&&m.a.Error(592525086,"Unable to distribute by length"),this.fade.progress=o.progress;if(2==t.getType()&&o.isDistributedByLength){if(!i.cache.drawDistribution){let e=0;const r=t=>{for(const i of t.paths||[])e+=i.measureLength(f.b.FromTransforms(i.transform,t.transform));return!0};Object(s.h)(t,r);const n=e;let a=0;const o=t;i.cache.drawDistribution=[];for(let t=0;t<o.items.length;t++)i.cache.drawDistribution.push(a/n),e=0,Object(s.h)(o.items.getAt(t),r),a+=e;i.cache.drawDistribution.push(1)}this.drawDistribution=i.cache.drawDistribution}}}}let gt=1;class _t{constructor(e){this.m_babylonWipeStateBetweenScopes=!0,this.m_babylonDisableParallelShaderCompile=!1,this.m_currentFramePerformanceSummary=new k.b,this.m_textureManager=new R.c,this.m_glyphCachePreviouslyFailed=!1,this.m_verboseRenderLogging=!1,this.fixedMemoryLeakAmounts=new k.a,this.m_babylonWipeStateBetweenScopes=!!e.stateRestorer,this.m_babylonDisableParallelShaderCompile=1==e.babylonDisableParallelShaderCompile,this.m_stateRestorer=e.stateRestorer,this.m_morphPlayer=e.morphPlayer,this.m_debugStringProvider=e.debugStringProvider,this.m_perfSummary=new k.c,this.m_rendererId=""+gt++}getTextureManager(){return this.m_textureManager}hasMorphPlayer(){return!!this.m_morphPlayer}setMorphPlayer(e){this.m_morphPlayer=e}hasDebugStringProvider(){return!!this.m_debugStringProvider}setDebugStringProvider(e){this.m_debugStringProvider=e}initializeAsync(e){return Object(E.__awaiter)(this,void 0,void 0,(function*(){if(this.setWebGLContextOrBabylonEngine(e),!this.m_graphicsProcessor)throw m.a.Error(592328459,"Failed to initialize graphics processor.");yield this.m_graphicsProcessor.initializeProgramsAsync()}))}setBabylonEngine(e){this.setWebGLContextOrBabylonEngine(e)}setWebGLContext(e){this.setWebGLContextOrBabylonEngine(e)}setWebGLContextOrBabylonEngine(e){const t=e instanceof WebGLRenderingContext||e instanceof WebGL2RenderingContext?e:e._gl;this.m_graphicsProcessor&&!this.m_graphicsProcessor.isCurrentWebGLContext(t)&&this.onWebGLContextLost(),this.m_graphicsProcessor?this.m_graphicsProcessor.setWebGLContextOrBabylonEngine(e):this.m_graphicsProcessor=new dt(e,this.m_babylonWipeStateBetweenScopes,this.m_babylonDisableParallelShaderCompile,this.m_stateRestorer)}onWebGLContextLost(){if(this.m_scratchBuffers){for(let e of this.m_scratchBuffers)e.release();this.m_scratchBuffers=void 0}de(),this.m_graphicsProcessor&&(this.m_graphicsProcessor.onWebGLContextLost(),this.m_graphicsProcessor=void 0)}verifyGlyphCacheIntegrityAndTryRecover(){return!function(){let e=0,t=0,i=0,r=0,n=0,a=0;for(let s=0;s<oe.length;s++){let o=0,l=0;const d=ae&&s<ae.length?ae[s].texture:void 0,h=d?d.tryConvertToBufferRGBA():void 0;for(let n=0;n<oe[s].length;n++){const c=oe[s][n];if(c.ready){if(!d||!h)return m.a.Error(555782370,"Glyph ready but texture missing"),!0;{let n=0;for(let e=Math.ceil(c.bounds.top);e<c.bounds.bottom;e++){const t=d.size.y-1-e;for(let e=Math.ceil(c.bounds.left);e<c.bounds.right;e++)n+=h[4*(e+t*d.size.x)]}if(void 0===c.checksum){if(0==n&&c.path.figures.length>0){const t=Object(x.d)(c.path.figures);t&&t.isValid()&&!t.isEmpty()&&e++}}else o+=n,l+=c.checksum,n>c.checksum&&t++,n<c.checksum&&(0==n?i++:(m.a.Error(555782402,`Glyph was ready but got partially erased (-${100*(c.checksum-n)/c.checksum}%)`),r++));c.checksum=n}a++}}0==o&&l>0&&n++}return e>0&&m.a.Error(555782371,`Glyph(s) with figures look empty: glyphCount=${e}, totalGlyphCount=${a}`),t>0&&m.a.Error(555782400,`Glyph(s) ready but additional pixels rendered on top: glyphCount=${t}, totalGlyphCount=${a}`),(i>0||r>0)&&m.a.Error(555782401,`Glyph(s) ready but erased from cache: glyphCountErased=${i}, glyphCountPartiallyErased=${r}, totalGlyphCount=${a}, pageCountErased=${n}, totalPageCount=${oe.length}`),e>0||i>0||r>0}()||(this.m_glyphCachePreviouslyFailed?(m.a.Error(555782369,"GlyphCache failed for the second time: disable glyph cache"),Object(R.i)(!1)):this.m_glyphCachePreviouslyFailed=!0,de(),!1)}isValid(){return!!this.m_graphicsProcessor&&this.m_graphicsProcessor.isValid()}getGraphicsProcessor(){return this.m_graphicsProcessor}getBabylonEngine(){return this.m_graphicsProcessor?this.m_graphicsProcessor.getBabylonEngine():void 0}getPerformanceSummary(){const e=e=>{if(!e)return;const t=e;for(const e in t)e.endsWith("Ms")&&(t[e]=Ct(t[e]))};return this.m_perfSummary.averageFrameCost&&(this.m_perfSummary.averageFrameCost=Ct(this.m_perfSummary.averageFrameCost)),e(this.m_perfSummary.perfInfoCurrentFrame),e(this.m_perfSummary.perfInfoFirstFrame),e(this.m_perfSummary.perfInfoSumOfAllFrames),this.m_perfSummary}resetPerformanceSummary(){this.m_perfSummary=new k.c}getCurrentFramePerformanceSummary(){return this.m_currentFramePerformanceSummary}getDebugStringProvider(){return this.m_debugStringProvider}ensureScratchBuffers(){if(!this.m_scratchBuffers){this.m_scratchBuffers=[];for(let e=0;e<R.m;e++)this.m_scratchBuffers.push(new R.a("ScratchBuffer",this,new f.e(R.n,R.n),0))}return this.m_scratchBuffers}ensureRenderNode(e){let t=e.renderDataMap[this.m_rendererId];return t||(t=new ft(2==e.getType()),e.renderDataMap[this.m_rendererId]=t),t}ensurePathRenderData(e){let t=e.renderDataMap[this.m_rendererId];return t||(t=new Ce,e.renderDataMap[this.m_rendererId]=t),t}ensureImageRenderData(e){let t=e.renderDataMap[this.m_rendererId];return t||(t=new Pe,e.renderDataMap[this.m_rendererId]=t),t}ensureMorphKeyFrameRenderData(e){let t=e.renderDataMap[this.m_rendererId];return t||(t=new Ge,e.renderDataMap[this.m_rendererId]=t),t}ensureMorphElementRenderData(e){let t=e.renderDataMap[this.m_rendererId];return t||(t=new je,e.renderDataMap[this.m_rendererId]=t),t}attachTextureToImage(e,t){const i=this.ensureImageRenderData(e);e.changeTracker.replaceListener(i.texture,t),i.texture=t}attachLoaderToImage(e,t){const i=this.ensureImageRenderData(e);e.changeTracker.replaceListener(i.texture,t),i.loader=t}getTextureFromImage(e){if(!e)return;const t=this.ensureImageRenderData(e);return t.loader?(m.a.Error(520663959,"getTextureFromImage may return the wrong wrap mode for ImageTextureLoader"),t.loader.getTexture(4)):t.texture}getTextureFromImageBrush(e){var t;if(!e.image)return;const i=this.ensureImageRenderData(e.image);return i.loader?i.loader.getTexture(null!==(t=e.wrapMode)&&void 0!==t?t:4):i.texture}deleteAllTextures(e){e.releaseGeneratedResources()}tryGetImageDebugData(e){const t=this.ensureImageRenderData(e);return new Ie(t.state,t.texture)}getDebugGlyphCacheInfo(e){return function(e){const t=ne(e);if(t){const e=se[t];if(e)return e.page}}(e)}generateTextureMemoryReport(e,t){let i={externalImages:0,managedImages:0,scratchBuffers:this.hasHitTestTexture()?4:0,glyphPages:0,shapeDistanceFields:0,textDistanceFields:0,otherBrushes:0,effects:0,rasterizedItems:0,fadeMasks:0,morphTextures:0,totalTarget:0,totalTargetExpected:this.getTextureManager().textureMemoryAllocated};for(let e of this.m_scratchBuffers||[])i.scratchBuffers+=e.memoryUsage;for(let e of ae||[])i.glyphPages+=e.texture?e.texture.memoryUsage:0;for(let t of e)Tt(this,t,i);for(let e of t||[])wt(this,e,i);return i.totalTarget=i.scratchBuffers+i.glyphPages+i.shapeDistanceFields+i.textDistanceFields+i.otherBrushes+i.effects+i.rasterizedItems+i.fadeMasks+i.morphTextures,i}initOutOfTime(){return this.m_initDeadline&&this.m_initDeadline<performance.now()}updateSettingsBeforeRender(){const e=ie.a.readNumberOrDefault("debugMode",-1);-1!=e&&Object(a.B)(e);const t=ie.a.readBooleanOrDefault("debugTextLines",!1);t&&Object(a.h)(t);const i=ie.a.readNumberOrDefault("quality",0);0!=i&&Object(R.o)(i),ie.a.readBooleanOrDefault("disableGlyphTable",!1)&&Object(R.i)(!1);const r=ie.a.readNumberOrDefault("hitTestSlop",0);0!=r&&Object(a.F)(r);const n=ie.a.readNumberOrDefault("minLineWidth",0),s=ie.a.readNumberOrDefault("minLineWidthForArrowHead",0);0==n&&0==s||Object(a.I)(n||a.v,s||a.w);const o=ie.a.readNumberOrDefault("hitTestCache",0);0!=o&&Object(a.E)(o);const l=ie.a.readBooleanOrDefault("useLegacyBrightness",a.y);Object(a.K)(l);const d=ie.a.readBooleanOrDefault("useLegacyContrast",a.z);Object(a.L)(d);const h=ie.a.readBooleanOrDefault("useLegacySharpness",a.A);Object(a.M)(h);const c=ie.a.readNumberOrDefault("glyphCacheTextureResolution",0);0!=c&&Object(a.D)(c);const u=ie.a.readNumberOrDefault("glyphCacheMaxFactor",0);0!=u&&Object(a.C)(u)}fillRenderRectMap(e,t,i,r,n,a,o,l,d){const h=t.changeTracker.currentUniqueId+","+t.animationChangeTracker.currentUniqueId+","+a.index+(o?"+"+o:"")+(d?"*":""),c=t.instances?t.instances.length:1;for(let u=0;u<c;u++){const c=t.instances?t.instances[u].transform.toMatrix3().multiply(r):r,m=t.instances?h+","+u:h;if(t instanceof s.e||t.effects.hasEffects){let r=t.getBounds(!l,!0,!0,c);if(t instanceof s.e&&t.style.pictureOverflow&&t.style.pictureBrush){const e=t.fillBoundsOverride?t.fillBoundsOverride:Object(s.k)(t,!1),i=this.getTextureFromImageBrush(t.style.pictureBrush);if(e&&i){const n=t.animationTransform?f.b.FromTransforms(t.transform,c,t.animationTransform):f.b.FromTransforms(t.transform,c),a=$(e,t.style.pictureBrush,i,n);a&&(r=f.c.UnionRect(r,a))}}l&&(r=r?r.transformedBounds(l):r),r=r?r.transformedBounds(n):r,r=i?f.c.IntersectRect(i,r):r,r&&(e[m]=r)}if(t instanceof s.b){const r=(t.animationTransform||t.fade?t.animationChangeTracker.currentUniqueId:"")+":"+t.opacity+"/"+o,s=l||t.animationTransform;for(let o of t.items.elements)a.next(),this.fillRenderRectMap(e,o,i,t.transform.toMatrix3().multiply(c),n,a,r,s,d||t.isHidden)}}}calculateDirtyRect(e,t){let i,r=r=>{const n=e[r],a=t[r];Object(f.i)(n,a)||(i=f.c.UnionRect(i,n),i=f.c.UnionRect(i,a))};for(let t in e)r(t);for(let e in t)r(e);return i?i.inflate(2):void 0}getLastRenderRectMap(){return this.m_lastRenderRectMap}render(e,t,i,r){this.renderBatch([{item:e,eraseBackground:t,options:i}],r)}renderBatch(e,t){var i,r,n,a,o,l;if(!this.isValid())return void m.a.Message(512297154,"renderer context not valid in renderBatch");this.m_lastRenderRectMap=void 0,this.m_verboseRenderLogging&&m.a.Message(538208403,"RenderBatch begin");const d=null===(i=t)||void 0===i?void 0:i.enableDirtyRect,h=null===(r=t)||void 0===r?void 0:r.previousRenderRectMap;let c,u;const p=this.m_graphicsProcessor;if(!p)return void m.a.Error(592525091,"glContext must be provided");this.updateSettingsBeforeRender();const g=performance.now();if(d){c={};for(let t of e){const e=new mt;this.fillRenderRectMap(c,t.item,null===(n=t.options)||void 0===n?void 0:n.scissor,f.b.Identity,(null===(o=null===(a=t.options)||void 0===a?void 0:a.transform)||void 0===o?void 0:o.toMatrix3())||f.b.Identity,e,void 0,void 0,!1)}h&&(u=this.calculateDirtyRect(h,c))}if(this.m_verboseRenderLogging&&m.a.Message(525960788,"RenderBatch computed RenderRectMap"),!p.beginRenderScope())return;this.m_verboseRenderLogging&&m.a.Message(538208404,"RenderBatch entered render scope");const _=new k.b;_.glResetCostMs+=performance.now()-g,_.beginTime=(new Date).getTime(),this.m_currentFramePerformanceSummary=_,_.totalCostMs=-performance.now();for(let t of e)this.tryPrepareItemInWebGlScope(t.item,p,!0,void 0)||m.a.Error(592525120,"could not fully prepare scene");if(_.shapeRenderCostMs=-performance.now(),this.m_verboseRenderLogging&&m.a.Message(538208405,"RenderBatch Items prepared"),u||!d||!h)for(let t of e)this.renderItemInWebGLRenderScope(t.item,t.eraseBackground,t.options,u);this.m_verboseRenderLogging&&m.a.Message(538208406,"RenderBatch Items rendered");const v=e.length>0&&(null===(l=e[0].options)||void 0===l?void 0:l.target)instanceof R.a?e[0].options.target.size:p.getCurrentViewportSize();if(_.shapeRenderCostMs+=performance.now(),_.glRestoreCostMs=-performance.now(),u&&ie.a.readBooleanOrDefault("debugDirtyRects",!1)){const e=s.e.CreateRectangle(u,new y.k(new y.i(new y.b(Math.random(),Math.random(),Math.random(),.25))));this.renderItemInWebGLRenderScope(e,void 0)}if(p.endRenderScope(),_.glRestoreCostMs+=performance.now(),_.totalCostMs+=performance.now(),_.endTime=(new Date).getTime(),this.m_perfSummary.perfInfoCurrentFrame=_,this.m_perfSummary.perfInfoFirstFrame||(this.m_perfSummary.perfInfoFirstFrame=_),this.m_perfSummary.perfInfoSumOfAllFrames||(this.m_perfSummary.perfInfoSumOfAllFrames=new k.b),this.m_perfSummary.perfInfoSumOfAllFrames.add(_),this.m_perfSummary.frameCount++,this.m_perfSummary.averageFrameCost=this.m_perfSummary.perfInfoSumOfAllFrames.totalCostMs/this.m_perfSummary.frameCount,this.m_perfSummary.viewWidth=v.x,this.m_perfSummary.viewHeight=v.y,this.m_perfSummary.frameCount>1){const e=(this.m_perfSummary.perfInfoSumOfAllFrames.totalCostMs-this.m_perfSummary.perfInfoFirstFrame.totalCostMs)/(this.m_perfSummary.frameCount-1);this.m_perfSummary.estimatedFps=Math.floor(Math.min(1e3/e,60))}else this.m_perfSummary.estimatedFps=Math.floor(Math.min(1e3/this.m_perfSummary.perfInfoCurrentFrame.shapeRenderCostMs,60));this.m_currentFramePerformanceSummary=new k.b,Ye.OnRender(this,e),this.m_verboseRenderLogging&&m.a.Message(538208407,"RenderBatch finished"),this.m_lastRenderRectMap=c}renderItemInWebGLRenderScope(e,t,i,r){const n=this.m_graphicsProcessor;if(!n)return void m.a.Error(592525121,"glContext must be provided");n.updateViewportSize();const a=i?i.target:void 0,s=a?a.size:n.getCurrentViewportSize(),o=i?i.transform:void 0,l=(null==i?void 0:i.scissor)&&r?f.c.IntersectRect(null==i?void 0:i.scissor,r):(null==i?void 0:i.scissor)||r;if(((null==i?void 0:i.scissor)||r)&&!l)return;n.setScissorRect(null==l?void 0:l.inflateToInteger(),!0);const d=performance.now(),h=n.activateShaderProgram(1);if(this.isVerboseRenderLoggingEnabled()){const e=Ct(performance.now()-d);m.a.Message(529077967,`RenderBatch shapeRender shader activation cost ${e}ms`)}h.begin(a?a.tryGetBabylonTextureForRenderToTexture(n):void 0,t,!0),this.drawItem(31,h,e,s,f.b.Identity,void 0,o?o.toMatrix3():f.b.Identity,0,void 0,!1,i,l,void 0),h.end(),n.setScissorRect(void 0)}renderMorph(e,t,i,r,n){if(!this.m_morphPlayer)throw m.a.Error(591667344,"Morph not available for this renderer");this.m_morphPlayer.renderMorph(this,e,t,i,r,n)}tryPrepareMorph(e,t){if(!this.m_morphPlayer)throw m.a.Error(591667345,"Morph not available for this renderer");return this.m_morphPlayer.tryPrepareMorph(this,e,t)}tryGetImageDebugDataForMorphKeyFrame(e){const t=this.ensureMorphKeyFrameRenderData(e);return t.texture?new Ie(1,t.texture):void 0}renderLayers(e,t,i){const r=this.m_graphicsProcessor;if(!r)return void m.a.Error(592525125,"glContext must be provided");if(r&&!r.beginRenderScope())return;const n=this.m_targetTexture?this.m_targetTexture.size:r.getCurrentViewportSize(),a=r.activateShaderProgram(1);a.begin(this.m_targetTexture?this.m_targetTexture.tryGetBabylonTextureForRenderToTexture(r):void 0,t,!0);for(let t=0;t<e.length;t++)Z(r,e[t],a,n,i?i.toMatrix3():void 0,void 0);a.end(),r.endRenderScope()}retrieveHitTestResult(e,t,i,r){if(t==i.index){const t={itemHit:e,itemStack:[e],textHit:void 0};if(e instanceof s.e){const i=e.text;if(i){const n=r.transformPoint(f.b.FromTransforms(new f.d(e.transform.translation.negate()),i.frameToShape.toInverseMatrix3(),i.layoutToFrame.toInverseMatrix3()));t.textHit=i.hitTest(n)?i.getSelectionFromLayoutPosition(n):void 0}}return t}if(e instanceof s.b)for(const n of e.items.elements){i.next();const a=this.retrieveHitTestResult(n,t,i,r.transformPoint(e.transform.toInverseMatrix3()));if(null==a?void 0:a.itemStack)return a.itemStack.splice(0,0,e),a}}renderHitTestBuffer(e,t,i,r,n){const a=performance.now();this.m_hitTestCache=void 0;const s=this.m_graphicsProcessor;if(!s)return void m.a.Error(592525129,"glContext must be provided");if(!s.beginRenderScope())return;this.tryPrepareItemInWebGlScope(e,s,!0,void 0)||m.a.Error(592525131,"could not fully prepare"),this.m_hitTestTexture&&this.m_hitTestTexture.isValid(this)&&this.m_hitTestTexture.size.equals(i)||(this.m_hitTestTexture&&this.m_hitTestTexture.release(),this.m_hitTestTexture=new R.a("HitTestPixel",this,i,0));const o=new mt,l=s.activateShaderProgram(1);l.begin(this.m_hitTestTexture.tryGetBabylonTextureForRenderToTexture(s),y.b.Transparent,!0);const d=t.negate(),h=r?r.toMatrix3().multiply(f.b.Translation2D(d)):f.b.Translation2D(d);this.drawItem(0,l,e,this.m_hitTestTexture.size,f.b.Identity,void 0,h,7,o,!1,{filter:n},void 0,void 0),l.end(),this.m_hitTestTexture.renderCost=performance.now()-a;const c=this.m_hitTestTexture.tryUseBabylonTexture(s,void 0,"hitTest"),u=c?s.copyTexturePixelsToArray(c,new f.c(0,0,this.m_hitTestTexture.size.x,this.m_hitTestTexture.size.y),!0):void 0;s.endRenderScope(),u&&(this.m_hitTestCache={buffer:u,uniqueId:e.changeTracker.currentUniqueId,origin:t,renderTransform:r})}isHitTestBufferValid(e,t,i,r,n){if(n||0==a.s||!this.m_hitTestCache||this.m_hitTestCache.uniqueId!=e.changeTracker.currentUniqueId)return!1;if(!this.m_hitTestCache.renderTransform&&!r||this.m_hitTestCache.renderTransform&&r&&!this.m_hitTestCache.renderTransform.toMatrix3().equals(r.toMatrix3()))return!1;const s=this.m_hitTestCache.origin?new f.c(this.m_hitTestCache.origin.x,this.m_hitTestCache.origin.y,this.m_hitTestCache.origin.x+i.x-1,this.m_hitTestCache.origin.y+i.y-1):void 0;return!(!s||!s.isPointInRect(t))}hitTestScene(e,t,i,r){if(!this.isValid())return m.a.Message(512297153,"renderer context not valid in hitTestScene"),ct;const n=a.s&&!r?new f.e(a.s,a.s):f.e.One;if(!this.isHitTestBufferValid(e,t,n,i,r)){const a=t.floor().subtract(new f.e(Math.floor(n.x/2),Math.floor(n.y/2)));this.renderHitTestBuffer(e,a,n,i,r)}if(!this.m_hitTestCache)return ct;const s=t.subtract(this.m_hitTestCache.origin).floor(),o=4*(s.x+(n.y-1-s.y)*n.x);if(o<0||o+3>=this.m_hitTestCache.buffer.length||0==this.m_hitTestCache.buffer[o+3])return ct;const l=this.m_hitTestCache.buffer[o+0]+256*this.m_hitTestCache.buffer[o+1]+65536*this.m_hitTestCache.buffer[o+2],d=new mt,h=i instanceof f.b?i.tryGetTransform(f.e.Zero):i,c=h?h.toInverseMatrix3():void 0;return this.retrieveHitTestResult(e,l,d,c?t.transformPoint(c):t)||(ut++,ut<=100&&m.a.Error(592525132,"Unable to retrieve hit shape "+l),100==ut&&m.a.Error(520119570,"Hit test failed too many times, not reporting anymore"),ct)}hasHitTestTexture(){return null!=this.m_hitTestTexture}tryInitTextures(e,t,i,r,n){var a,o,l;if(t.isHidden)return!0;const d=this.ensureRenderNode(t);d.cache.beforeInitTextures(t,e);const h=new pt(r,t,d,n),c=t instanceof s.e&&void 0!==t.shape3D;if(t instanceof s.e){const r=t;if(r.incrementalPath&&(d.cache.initTextureStage=Oe.fromBegining),d.cache.initTextureStage<Oe.distanceFieldsReady){if(r.incrementalPath)d.cache.distanceFields&&1==d.cache.distanceFields.length||(d.cache.distanceFields=[new re("DistanceField/incremental",this,void 0,0,0,0,1,!1)]);else if(r.paths&&!d.cache.distanceFields&&!r.isSolidRect()){let e=-performance.now();if(d.cache.distanceFields=[],(null===(a=r.paths)||void 0===a?void 0:a.length)>0){let e=0,t=0,i=r.paths[0].fillMode;for(let n=0;n<r.paths.length;n++){const a=n==r.paths.length-1,s=a?0:r.paths[n+1].fillMode;(a||s!=i)&&(!r.style.hasLine||0==r.style.pen.headEnd.end&&0==r.style.pen.tailEnd.end?d.cache.distanceFields.push(new re("DistanceField/fillAndLine",this,v.j.FromFirstLast(e,t),i,r.mergeMode,0,1,!1)):(0!=i&&null!=r.style.fillBrush&&d.cache.distanceFields.push(new re("DistanceField/fillOnly",this,v.j.FromFirstLast(e,t),i,r.mergeMode,1,1,!1)),d.cache.distanceFields.push(new re("DistanceField/arrowAndLine",this,v.j.FromFirstLast(e,t),i,r.mergeMode,2,1,!1))),i=s,e=n+1),t=n+1}c&&d.cache.distanceFields.push(new re("DistanceField/displacement",this,void 0,i,r.mergeMode,0,1,!0))}if(e+=performance.now(),3==r.role?this.m_currentFramePerformanceSummary.distanceFieldForTextCostMs+=e:this.m_currentFramePerformanceSummary.distanceFieldForShapeCostMs+=e,this.initOutOfTime())return!1}for(const e of d.cache.distanceFields||[]){let t=-performance.now();const i=null!=r.incrementalPath;let n=e.refresh(this,r,i);if(!n&&i&&(n=e.refresh(this,r,!1)),n||m.a.Error(592525133,"error in distanceField refresh"),t+=performance.now(),3==r.role?this.m_currentFramePerformanceSummary.distanceFieldForTextCostMs+=t:this.m_currentFramePerformanceSummary.distanceFieldForShapeCostMs+=t,this.initOutOfTime())return!1}d.cache.initTextureStage=Oe.distanceFieldsReady}if(d.cache.initTextureStage<Oe.brushTexturesReady||r.instances){if(d.cache.initBrushTexture(this,t,0),this.initOutOfTime())return!1;if(d.cache.initBrushTexture(this,t,1),this.initOutOfTime())return!1;if(d.cache.initBrushTexture(this,t,2),this.initOutOfTime())return!1;d.cache.initTextureStage=Oe.brushTexturesReady}if(r.text&&r.text.cache)if(0==r.text.renderMode){let t=0;for(const n of r.text.cache.textShapes||[]){if(r.text.animationProps)if(n.textRange){const e=r.text.animationProps.getAt(n.textRange.start);n.fade=e.fade,n.animationTransform=e.animationTransform,n.isHidden=e.isHidden}else m.a.Error(592525134,"no range");else n.fade=void 0,n.animationTransform=f.b.Identity,n.isHidden=!1;if(!this.tryInitTextures(e,n,i,h,t))return!1;t++}for(const t of r.text.cache.selectionShapes||[])if(!this.tryInitTextures(e,t,i,h,0))return!1}else d.cache.initTextCutoutLayer(this,r.text.cache.cutoutLayerPaths,r)}else{if(!(t instanceof s.b))throw m.a.Error(592525135,"Unknown Item type");{d.cache.initTextureStage<Oe.brushTexturesReady&&(d.cache.initBrushTexture(this,t,0),d.cache.initTextureStage=Oe.brushTexturesReady);const r=t;for(let t=0;t<r.items.length;t++){const n=r.items.getAt(t);if(n&&!this.tryInitTextures(e,n,i,h,t))return!1;if(this.initOutOfTime())return!1}}}let u=-performance.now();if(d.cache.fade=h.fade,d.cache.initFadeTexture(this,t,h.fade),u+=performance.now(),t.fade&&(this.m_currentFramePerformanceSummary.fadeTextureCostMs+=u),this.initOutOfTime())return!1;if(i&&d.cache.initTextureStage<Oe.effectsReady){if(t.effects){if(t.effects.innerShadow&&t.effects.innerShadow.color.a>0&&!d.cache.innerShadowTexture&&(d.cache.innerShadowTexture=this.createTextureRasterizedItem("Effect/InnerShadow",t,0,d.cache.innerShadowTexture,y.b.Black,t.effects.innerShadow.radius,8,2,R.e,1),this.initOutOfTime()))return!1;if(t.effects.softEdges&&t.effects.softEdges.radius>0&&!d.cache.softEdgesTexture&&(d.cache.softEdgesTexture=this.createTextureRasterizedItem("Effect/SoftEdges",t,0,d.cache.softEdgesTexture,y.b.Black,t.effects.softEdges.radius,16,5,R.e,1),this.initOutOfTime()))return!1;if(t.effects.glow&&t.effects.glow.radius>0&&t.effects.glow.color.a>0&&!d.cache.glowTexture&&(d.cache.glowTexture=this.createTextureRasterizedItem("Effect/Glow",t,16,d.cache.glowTexture,t.effects.glow.color,t.effects.glow.radius?2*t.effects.glow.radius:0,1,t.effects.glow.isSharp?4:3,R.e,1),this.initOutOfTime()))return!1;if(t.effects.shadow&&t.effects.shadow.color.a>0&&!d.cache.shadowTexture&&(d.cache.shadowTexture=this.createTextureRasterizedItem("Effect/Shadow",t,17,d.cache.shadowTexture,t.effects.shadow.color,t.effects.shadow.radius?t.effects.shadow.radius:0,2,6,R.e,1),this.initOutOfTime()))return!1;if(t.effects.reflection&&!d.cache.reflectionTexture&&(d.cache.reflectionTexture=this.createTextureRasterizedItem("Effect/Reflection",t,27,d.cache.reflectionTexture,void 0,t.effects.reflection.radius,4,6,R.e,1),this.initOutOfTime()))return!1}d.cache.initTextureStage=Oe.effectsReady}if(i)if(c||t.fade&&13!=t.fade.preset||t instanceof s.b&&t.opacity<1){d.cache.spriteHitTest=c||void 0!==t.fade&&13!=t.fade.preset;const e=t.animationTransform?t.animationTransform.transformVector(f.e.One.scale(Math.sqrt(2)/2)).length():1,i=Math.max(.1,R.g*e);if((!d.cache.spriteTexture||d.cache.spriteTexture.tag!=t.changeTracker.currentUniqueId||d.cache.spriteQuality<i)&&(d.cache.spriteTexture&&(this.fixedMemoryLeakAmounts.recreatingSprites+=d.cache.spriteTexture.memoryUsage),null===(l=d.cache.spriteTexture)||void 0===l||l.release(),d.cache.spriteTexture=c?function(e,t,i,r){const n=e.getGraphicsProcessor();if(!n)return void m.a.Error(572867290,"failed to get graphicsProcessor");const a=e.ensureRenderNode(t),o=Object(s.j)(t,!0,31,31,t.transform.toInverseMatrix3().multiply(f.b.Scale2D(t.transform.scale))),l=yt(t),d=e.createTextureRasterizedItem("RasterizeFor3D/Item",t,24,a.cache.spriteTexture,void 0,0,0,1,r,1),h=a.cache.glowTexture||a.cache.shadowTexture||a.cache.reflectionTexture?e.createTextureRasterizedItem("RasterizeFor3D/Effects",t,31,a.cache.spriteTexture,void 0,0,0,8,r,1):void 0,c=a.cache.getBevelDistanceField();let u;if(o&&l&&d&&(null==c?void 0:c.texture)){const a=Math.min(r,R.f/o.size.x,R.f/o.size.y),p=new f.e(Math.min(R.f,Math.ceil(o.size.x*a)),Math.min(R.f,Math.ceil(o.size.y*a)));u=new R.a("rasterized3D",e,p,1),u.tag=t.changeTracker.currentUniqueId,u.contentLocation={logicalCenter:l.center.subtract(o.leftTop).scale(a),logicalSize:l.size.scale(a),physicalCenter:u.size.scale(.5),physicalSize:u.size,rotation:0,flipX:!1,flipY:!1};const g=u.tryGetBabylonTextureForRenderToTexture(n);if(g){let r,a=f.e.Zero;t instanceof s.e&&t.shape3D&&t.shape3D.topBevel&&(r=function(e,t,i,r){function n(e,t,i){for(let r=Math.floor(t.x);r<=Math.floor(i.x);r++)r>=0&&r<e.length&&(e[r]=Math.max(e[r],t.y+(r-t.x)*(i.y-t.y)/(i.x-t.x)))}const a=new Array(t);a.fill(0),i.forEachSegment((e,t,i)=>{if(t){const r=Math.max(8,i.x-e.x);for(let s=0;s<r;s++)n(a,f.e.InterpolateQuadratic(e,t,i,s/r),f.e.InterpolateQuadratic(e,t,i,(s+1)/r))}else n(a,e,i);return!0},f.b.Scale2D(r));const s=new Float32Array(768);for(let e=0;e<t;e++)s[3*e]=s[3*e+1]=s[3*e+2]=a[e];return R.b.CreateFromByteBuffer("PathProfile",e,new f.e(t,1),s,4,4,!0)}(e,256,t.shape3D.topBevel.profile,new f.e(255,1)),a=t.shape3D.topBevel.size);const o=n.activateShaderProgram(7);o.begin(g,y.b.Transparent,!0),h&&Mt(n,o,h,void 0,void 0,u.size,u.contentLocation.logicalSize,u.contentLocation.logicalCenter,f.e.Zero,0,void 0,void 0,y.b.Transparent,0),Mt(n,o,d,c,r,u.size,u.contentLocation.logicalSize,u.contentLocation.logicalCenter,a,t instanceof s.e?t.style.pen.lineWidth:0,i,t instanceof s.e&&t.shape3D?t.shape3D.material:void 0,t instanceof s.e&&t.shape3D&&t.shape3D.contourColor?t.shape3D.contourColor:y.b.Transparent,t instanceof s.e&&t.shape3D?t.shape3D.adjustedContourWidth:0),o.end(),r&&r.release()}else m.a.Error(572867291,"failed to get textureTarget")}else m.a.Error(572867292,"failed to get textures for 3D rendering");return d&&d.release(),h&&h.release(),u}(this,t,h.scene3D,i):this.createTextureRasterizedItem("SpriteCache",t,31,d.cache.spriteTexture,void 0,0,0,1,i,1),d.cache.spriteTexture&&(d.cache.spriteTexture.tag=t.changeTracker.currentUniqueId,d.cache.spriteQuality=i),this.initOutOfTime()))return!1}else null===(o=d.cache.spriteTexture)||void 0===o||o.release(),d.cache.spriteTexture=void 0,d.cache.spriteQuality=0,d.cache.spriteHitTest=!1;return!0}tryPreparePaths(e){for(const t of e)if(this.ensurePathRenderData(t).refreshCachedTapeBuffers(t),this.initOutOfTime())return!1;return!0}tryPrepareGeneratedShapes(e){const t=this;return Object(s.h)(e,e=>(Object(s.f)(e),!t.initOutOfTime()))}tryPrepareTapes(e){const t=this;return Object(s.h)(e,e=>{if(e.paths){if(!t.tryPreparePaths(e.paths))return!1;if(e.shapeBoundsCache&&e.shapeBoundsCache.geometryVersion==e.geometryTracker.version||(e.shapeBoundsCache={geometryVersion:e.geometryTracker.version}),e.shapeBoundsCache.pathsBounds||e.style.hasLine||(e.shapeBoundsCache.pathsBounds=Object(A.c)(e.paths)),t.initOutOfTime())return!1}return!0})}tryPrepareItemInWebGlScope(e,t,i,r){const n=performance.now();if(this.m_initDeadline=r?n+r:void 0,t&&!t.tryPrepareProgramResourcesInWebGlScope(this.m_initDeadline))return!1;if(!this.tryPrepareGeneratedShapes(e))return!1;if(!this.tryPrepareTapes(e))return!1;if(t){let r=!1;return function(e,t){if(!R.l)return;if(!e.getGraphicsProcessor())return;const i=performance.now();le!=a.r&&(de(),le=a.r);let r=ae;ae=void 0,r||(r=[]),Object(s.g)(t,e=>(function(e){const t=ne(e.glyphCacheId);if(!t||null!=se[t])return;const i=new x.c(e,f.d.Identity),r=Object(A.c)([i]);if(!r)return;if(a.q&&Math.max(r.width,r.height)>4096*a.q)return;0!=oe.length&&256!=oe[oe.length-1].length||oe.push([]);const n=oe.length-1,s=oe[n],o=r.size,l=ue()/Math.max(4096,Math.max(o.x,o.y)),d=new f.e(l,l),h=s.length,c=.5+h%16,u=.5+(h-c)/16,m=r.center.scale(-l).add(new f.e(c*ce(),u*ce())),p=f.d.fromScaleAndTranslation(d,m),g={page:n,scale:l,offset:m,bounds:r.multiply(d).translate(m).inflate(fe()),path:new x.c(i,p),ready:!1};s.push(g),se[t]=g}(e),!0));for(let t=0;t<oe.length;t++){let i=!0,n=t<r.length?r[t]:void 0;if(n)n.texture&&n.texture.isValid(e)||(m.a.Error(592525085,"invalid glyph table texture. recreating."),i=!1);else{for(;r.length<t+1;)r.push(new re("DistanceField/glyphPage",e,void 0,1,0,0,1,!1));n=r[t],n.contentBoundsOverride=new f.c(0,0,he(),he()),n.paddingOverride=8,n.qualityOverride=1,n.isGlyphCache=!0,i=!1}let a=!1;i&&(a=Te(e,t,n,!0)),a||Te(e,t,n,!1)}ae=r,e.getCurrentFramePerformanceSummary().distanceFieldForGlyphTableCostMs+=performance.now()-i}(this,e),this.initOutOfTime()||(r=this.tryInitTextures(t,e,i,void 0,0)),r}return!0}tryPrepareItem(e,t,i){if(!this.isValid())return m.a.Message(512297152,"renderer context not valid in tryPrepareItem"),!1;const r=this.m_graphicsProcessor;if(!r)return m.a.Error(592525136,"glContext must be provided"),!1;if(this.updateSettingsBeforeRender(),!r.beginRenderScope())return!1;const n=this.tryPrepareItemInWebGlScope(e,r,t,i);return r.endRenderScope(),n}drawItem(e,t,i,r,n,a,o,l,d,h,c,u,f){var p,g,_,v,y,b,S,T,w;const M=i.instances||s.c.DefaultArray;for(let C of M){let M=i;if(i instanceof s.b&&void 0!==C.groupIndex&&i.items.length>0){const e=C.groupIndex;e>=0&&e<i.items.length?M=i.items.getAt(e):(M=void 0,m.a.Error(509617671,`Instance index out of range: ${e}, count: ${i.items.length}`))}if(M){const i=null!==(p=C.transform.toMatrix3().multiply(n))&&void 0!==p?p:n,s={opacity:null!==(_=null!==(g=C.opacity)&&void 0!==g?g:null==f?void 0:f.opacity)&&void 0!==_?_:1,colorMatrix:null!==(y=null!==(v=C.colorMatrix)&&void 0!==v?v:null==f?void 0:f.colorMatrix)&&void 0!==y?y:void 0,colorOffset:null!==(S=null!==(b=C.colorOffset)&&void 0!==b?b:null==f?void 0:f.colorOffset)&&void 0!==S?S:void 0,colorize:null!==(w=null!==(T=C.colorize)&&void 0!==T?T:null==f?void 0:f.colorize)&&void 0!==w?w:void 0};this.drawItemOnce(e,t,M,r,i,a,o,l,d,h,c,u,s)}}}drawItemOnce(e,t,i,r,n,o,l,d,h,c,u,m,p){var g,_,v,y;const b=0==d||7==d,S=o||i.animationTransform,T=i instanceof s.e?3==i.role?"text":"shape":"group",w=b&&S?n.multiply(S.multiply(l)):n.multiply(l);if(!this.m_graphicsProcessor||i.isHidden||u&&u.filter&&!u.filter(i)||i instanceof s.b&&0==i.opacity)return;this.m_graphicsProcessor.setScissorRect(null==m?void 0:m.inflateToInteger(),!0);const M=this.ensureRenderNode(i);let C=null===(g=M.cache)||void 0===g?void 0:g.fade,I=null!==(v=null===(_=M.cache)||void 0===_?void 0:_.fadeMode)&&void 0!==v?v:0;const P=7==d?1:(null!==(y=null==p?void 0:p.opacity)&&void 0!==y?y:1)*(i instanceof s.b?i.opacity:1),E=yt(i);let x,A=!1;if(i instanceof s.e&&i.clipBounds&&E&&(x=i.getBounds(),x=x?x.transformedBounds(i.transform.toInverseMatrix3()):void 0,x=x?i.clipBounds.clip(x):void 0,x=x?x.translate(E.center.negate()).multiply(i.transform.scale):void 0,A=!x),b&&M.cache.spriteTexture&&(7!=d||M.cache.spriteHitTest)){if(E&&!A){const e=new W(M.cache.spriteTexture,Object(R.p)(E,i.transform));e.fadeInfo=b&&C?{fade:C,fadeTexture:M.cache.fadeTexture,fadeMode:I}:void 0,e.localClipRect=x,e.clientObject=M.cache,e.overallOpacity=P,e.colorMatrix=null==p?void 0:p.colorMatrix,e.colorOffset=null==p?void 0:p.colorOffset,e.colorize=null==p?void 0:p.colorize;const n=performance.now();Z(this.m_graphicsProcessor,e,t,r,w,h?h.color:void 0),this.onLayerRendered(T,"SpriteCache",n,e)}}else{if(0!=e&&i.effects&&(i.effects.glow||i.effects.shadow||i.effects.reflection)&&a.a==a.b&&7!=d&&(!u||!u.textRange)&&E&&!A){const n=E.center.transformPoint(i.transform);let a;if(4&e&&i.effects.reflection||2&e&&i.effects.shadow){const e=new f.d(n.negate(),f.e.One,i.effects.direction,n);a=i.effectsBoundsOverride?i.effectsBoundsOverride.transformedBounds(e):Object(s.j)(i,!1,0,1,e.toMatrix3())}const o=E?Object(R.p)(E,i.transform):void 0,l=o?new f.d(f.e.Zero,f.e.Flip(o.flipX,o.flipY),o.rotation+i.effects.direction,o.center):void 0,d=l?l.toInverseMatrix3():void 0;if(4&e&&i.effects.reflection&&M.cache.reflectionTexture&&a&&E&&o&&l&&d&&!A){let e=i.effects.reflection,n=a.bottom+e.distance/2;i instanceof s.e&&i.textEffectMetrics&&(n-=i.textEffectMetrics.descent);const c=f.b.Translation2D(new f.e(0,-n)).multiply(f.b.Scale2D(new f.e(1,-1))).multiply(f.b.Translation2D(new f.e(0,n)));let u=new f.e(a.center.x,n),m=new f.e(a.center.x,n+a.height);const g={opacity0:e.startAlpha,opacity1:e.endAlpha,pos0:f.e.InterpolateLinear(u,m,e.startPosition).transformPoint(d),pos1:f.e.InterpolateLinear(u,m,e.endPosition).transformPoint(d)},_=new W(M.cache.reflectionTexture,o);_.fadeInfo=b&&C?{fade:C,fadeTexture:M.cache.fadeTexture,fadeMode:I}:void 0,_.effectTransform=f.b.FromTransforms(l,c,d),_.localClipRect=x,_.reflectionGradient=g,_.clientObject=M.cache,_.overallOpacity=P,_.colorMatrix=null==p?void 0:p.colorMatrix,_.colorOffset=null==p?void 0:p.colorOffset,_.colorize=null==p?void 0:p.colorize;const v=performance.now();Z(this.m_graphicsProcessor,_,t,r,w,h?h.color:void 0),this.onLayerRendered(T,"Reflection",v,_)}if(2&e&&i.effects.shadow&&M.cache.shadowTexture&&a&&E&&o&&l&&d&&!A){const e=Object(s.i)(i.effects.shadow.alignment,a),n=Object(s.l)(i.effects.shadow.angle,i.effects.shadow.distance,i.effects.shadow.scale,i.effects.shadow.skew,e),c=new W(M.cache.shadowTexture,o);c.fadeInfo=b&&C?{fade:C,fadeTexture:M.cache.fadeTexture,fadeMode:I}:void 0,c.effectTransform=f.b.FromTransforms(l,n,d),c.localClipRect=x,c.clientObject=M.cache,c.overallOpacity=P,c.colorMatrix=null==p?void 0:p.colorMatrix,c.colorOffset=null==p?void 0:p.colorOffset,c.colorize=null==p?void 0:p.colorize;const u=performance.now();Z(this.m_graphicsProcessor,c,t,r,w,h?h.color:void 0),this.onLayerRendered(T,"Shadow",u,c)}if(1&e&&i.effects.glow&&M.cache.glowTexture&&E&&o&&l&&d&&!A){const e=new W(M.cache.glowTexture,o);e.fadeInfo=b&&C?{fade:C,fadeTexture:M.cache.fadeTexture,fadeMode:I}:void 0,e.localClipRect=x,e.clientObject=M.cache,e.overallOpacity=P,e.colorMatrix=null==p?void 0:p.colorMatrix,e.colorOffset=null==p?void 0:p.colorOffset,e.colorize=null==p?void 0:p.colorize;const i=performance.now();Z(this.m_graphicsProcessor,e,t,r,w,h?h.color:void 0),this.onLayerRendered(T,"Glow",i,e)}}if(8!=d)if(1==i.getType()){const s=i;if(!(u&&u.textRange||A))if(s.isSolidRect())Qe(this,M.cache,void 0,e,t,s,r,w,d,h?h.color:void 0,x,P,null==p?void 0:p.colorMatrix,null==p?void 0:p.colorOffset,null==p?void 0:p.colorize);else for(const i of M.cache.distanceFields||[])i.isDisplacementMap||Qe(this,M.cache,i,e,t,s,r,w,d,h?h.color:void 0,x,P,null==p?void 0:p.colorMatrix,null==p?void 0:p.colorOffset,null==p?void 0:p.colorize);if(s.text&&s.text.cache&&(!u||!u.noSubtree||u.textRange)){const e=new f.d(f.e.Zero,f.e.One,s.transform.rotation,s.transform.translation),i=a.u?e.toMatrix3().multiply(n):e.toMatrix3(),o=a.u&&!s.text.animationProps?S:void 0,g=a.u?l:s.text.hasAnimationProps()?n.multiply(l):w;if(h)for(const e of s.text.cache.hitTestLineShapes||[])(!u||!u.textRange||e.textRange&&u.textRange.includes(e.textRange.start))&&this.drawItem(31,t,e,r,i,o,g,d,h,c,void 0,m,p);else if(0==s.text.renderMode){for(const e of s.text.cache.textShapes||[])(!u||!u.textRange||e.textRange&&u.textRange.includes(e.textRange.start))&&this.drawItem(31,t,e,r,i,o,g,d,h,c,void 0,m,p);if(0==d)for(const e of s.text.cache.selectionShapes||[])this.drawItem(31,t,e,r,i,o,g,d,h,c,void 0,m,p)}}}else if(2==i.getType()&&(!u||!u.noSubtree&&!u.textRange)){const e=i;if(e)for(let i=0;i<e.items.length;i++){const s=e.items.getAt(i);{h&&h.next();const i=a.u?e.transform.toMatrix3().multiply(n):f.b.Identity,o=a.u?S:void 0,g=a.u?l:e.transform.toMatrix3().multiply(w);let _=m,v=!1;if(e.clipBounds){let t=m||new f.c(0,0,r.x,r.y);const n=o?f.b.FromTransforms(i,o,g):i.multiply(g),a=null==n?void 0:n.inverse(),s=a?t.transformedBounds(a):void 0,l=s?e.clipBounds.clip(s):void 0,d=null==l?void 0:l.transformedBounds(n);_=d?f.c.IntersectRect(d,t):void 0,v=null==_}v||this.drawItem(31,t,s,r,i,o,g,d,h,c,u,_,p)}}}}this.m_graphicsProcessor.setScissorRect(void 0)}renderToTexture(e,t,i,r,n,a,o,l,d){n&&n.size.equals(a)||(n=new R.a(e,this,a,d));const h=t.activateShaderProgram(1);h.begin(n.tryGetBabylonTextureForRenderToTexture(t),y.b.Transparent,!0);const c={noSubtree:(3==l||4==l)&&i instanceof s.e};return this.drawItemOnce(r,h,i,a,f.b.Identity,void 0,o.toMatrix3(),l,void 0,!1,c,void 0,void 0),h.end(),n}drawTextureToTexture(e,t,i,r){const n=this.m_graphicsProcessor;if(!n)throw m.a.Error(592525137,"No Graphics Processor");const a=0==i?5:5==i?8:6,s=n.isInRenderScope();if(!s&&!n.beginRenderScope())throw m.a.Error(591541203,"Failed to begin RenderScope");{const o=n.activateShaderProgram(a);o.begin(e.tryGetBabylonTextureForRenderToTexture(n),y.b.Transparent,!0),Object(R.h)(n,o,t,[new f.c(0,0,t.size.x,t.size.y)],[new f.c(0,0,e.size.x,e.size.y)],e.size,i,1,void 0,r),o.end(),s||n.endRenderScope()}}createTextureRasterizedItem(e,t,i,r,n,a,o,l,d,h){const c=this.m_graphicsProcessor;if(!c)throw m.a.Error(591541204,"No Graphics Processor");d<=0&&m.a.Error(509698625,"Quality is "+d);const u=performance.now(),p=4==l,g=!p&&a?d*Math.min(1,4/Math.sqrt(a)):d,_=!!(4&o),v=!!(24&o),b=!(2==t.getType()&&t.isDocumentShape),S=_||b&&!v;let T=Object(s.j)(t,S,i,31,t.transform.toInverseMatrix3().multiply(f.b.Scale2D(t.transform.scale)));if(!T)return;T=T.inflate(Math.max(2/g,a));const w=T.size,M=T.center.divide(t.transform.scale).transformPoint(t.transform);if(!w||!M)return;const C=Math.min(g,R.n/Math.max(w.x,w.y)),I=w.scale(C),P=a||n,E=new f.e(Object(f.g)(P?Object(f.k)(I.x):I.x,16,R.n),Object(f.g)(P?Object(f.k)(I.y):I.y,16,R.n)),x=Math.min(C,Math.min(E.x/w.x,E.y/w.y)),A=new f.d(M.negate(),new f.e(x,x),-t.transform.rotation,new f.e(E.x/2,E.y/2)),k=yt(t);if(!k)return;if(p){const s=this.renderToTexture(e,c,t,i,void 0,E,A,l,0);r=function(e,t,i,r,n,a){const s=i.size,o=new Array(32),l=new Array(32);for(let e=0;e<32;e++){const t=2*Math.PI*e/32,i=new f.e(Math.cos(t)*r,Math.sin(t)*r);o[e]=new f.c(0,0,s.x,s.y),l[e]=new f.c(0+i.x,i.y,s.x+i.x,s.y+i.y)}const d=new R.a("SharpGlow",e,s,a),h=t.activateShaderProgram(6);return h.begin(d.tryGetBabylonTextureForRenderToTexture(t),y.b.Transparent,!0),Object(R.h)(t,h,i,o,l,s,0,1,n),h.end(),d}(this,c,s,a*x,n||y.b.Black,h),s.release()}else r=this.renderToTexture(e,c,t,i,r,E,A,l,h),P&&(r.generateMipMap(),function(e,t,i,r,n,a){const s=e.getGraphicsProcessor();if(!s)return void m.a.Error(592525249,"No GraphicsProcessor");const o=e.ensureScratchBuffers(),l=o[0],d=o[1],h=1==r?.12*i:16==r?.47*i:i,c=1==r?.3*i:i,u=1==r?3:16==r?2:n?1:0,p=n?1:0,g=1!=r&&16!=r;B(s,d.size.divide(t.size),t,d,n?y.b.Black:void 0,h,u,new f.e(1,0),g,a),B(s,f.e.One,d,l,n?y.b.Black:void 0,h,u,new f.e(0,1),g,void 0),B(s,f.e.One,l,d,n?y.b.Black:void 0,c,p,new f.e(1,0),!0,void 0),B(s,t.size.divide(l.size),d,t,n,c,p,new f.e(0,1),!0,void 0)}(this,r,a*x,o,n,this.ensureRenderNode(t).cache));r.contentLocation={logicalCenter:k.center.transformPoint(t.transform).transformPoint(A),logicalSize:k.size.multiply(t.transform.scale).scale(x),physicalCenter:r.size.scale(.5),physicalSize:w.scale(x),rotation:0,flipX:!1,flipY:!1};const O=performance.now()-u;return 6==l||3==l||4==l||2==l||5==l?this.m_currentFramePerformanceSummary.effectsCostMs+=O:1==l&&(this.m_currentFramePerformanceSummary.cacheToSpriteCostMs+=O),r.renderCost=O,r}preCompileShaderAsync(e){this.m_graphicsProcessor?this.m_graphicsProcessor.preCompileShaderAsync(e):m.a.Error(592525138,"Graphics Processor not initialized")}preLinkShaderAsync(e){this.m_graphicsProcessor?this.m_graphicsProcessor.preLinkShaderAsync(e):m.a.Error(592525139,"Graphics Processor not initialized")}getDebugString(e){return this.m_debugStringProvider?e instanceof s.d?this.m_debugStringProvider.getDebugStringForItem(e,this):e instanceof _?this.m_debugStringProvider.getDebugStringForMorph(e,this):"unsupported object":"no debug string provider"}getTexturesUsedByObject(e,t){if(e instanceof R.b&&t.push(e),e instanceof s.d){const i=e.getBrushImages();t.push(...i.map(e=>this.ensureImageRenderData(e).texture)),this.getTexturesUsedItemCacheGL(e,t)}if(e instanceof _)for(let i of e.elements)for(let e of i.keyFrames)if(e){const i=this.ensureMorphKeyFrameRenderData(e);i.texture&&t.push(i.texture),i.textureDeltaWhite&&t.push(i.textureDeltaWhite),i.texturePicture&&t.push(i.texturePicture)}}getTexturesUsedItemCacheGL(e,t){const i=this.ensureRenderNode(e).cache;if(t.push(...i.getFulltextureList()),e instanceof s.b)for(let i of e.items.elements)this.getTexturesUsedItemCacheGL(i,t);if(e instanceof s.e&&e.text&&e.text.cache){for(const i of e.text.cache.getTextShapes())this.getTexturesUsedItemCacheGL(i,t);for(const i of e.text.cache.getSelectionShapes())this.getTexturesUsedItemCacheGL(i,t)}}getAllocatedTextures(e){const t=new Array;for(let i of e||[])this.getTexturesUsedByObject(i,t);return this.getTextureManager().allocatedTextures.filter(e=>!t.includes(e))}getAllocatedTexturesDebugTable(e,t){const i=this.getAllocatedTextures(t),r=[],n=[" Valid"," Empty"," Sneaky"," WrongR"," WrongC"],a=["Keep","Dispose","External"];for(let t of i){const i=t.lastUsage?performance.now()-t.lastUsage:void 0,s=t.lastRenderTime?performance.now()-t.lastRenderTime:void 0,o=t.scenario,l=n[t.getState(this)],d=a[t.releasePolicy],h=t.size.x,c=t.size.y,u=t.memoryUsage,f=t.renderCost;let m="[ ";if(t.usageRecord.length>0)for(let i=0;i<t.usageRecord.length;i++){const r=t.usageRecord[i];m+=0==i?"":", ",m+='{"id":"'+vt(r.clientObject,e)+'", "scenario":"'+r.lastScenario+'", "lastRead":'+(performance.now()-r.lastUsage)+"}"}m+="]",r.push({lastRead:i,lastWrite:s,scenario:o,state:l,policy:d,width:h,height:c,memory:u,cost:f,clients:m})}return r}enableVerboseRenderLogging(e){this.m_verboseRenderLogging=e}isVerboseRenderLoggingEnabled(){return this.m_verboseRenderLogging}onLayerRendered(e,t,i,r){const n=Math.ceil(r.contentSize.x)*Math.ceil(r.contentSize.y);if(this.getCurrentFramePerformanceSummary().pixelCountShapeRender+=n,"text"==e&&this.getCurrentFramePerformanceSummary().shapeLayerCountText++,this.isVerboseRenderLoggingEnabled()){const r=Ct(performance.now()-i);m.a.Message(529077968,`RenderBatch ${e} layer ${t} rendered ${n} pixels, cost ${r}ms`)}}testRenderFidelity(){const e=new s.e([x.c.CreateFromFigure(new x.a([0,10,1,10,0,1,10,10,1]))],new y.k(new y.i(y.b.Blue))),t=new s.e([x.c.CreateFromFigure(new x.a([0,0,1,0,10,1,10,10,1]))],new y.k(new y.i(y.b.Red))),i=new s.e([x.c.CreateFromFigure(new x.a([0,10,1,5,5,1,10,10,1]))],new y.k(new y.i(new y.b(1,1,0,.5)))),r=new s.b([e,t,i]),n=new R.a("RenderTest",this,new f.e(9,9),0);this.render(r,y.b.Green,{target:n});const a=n.tryConvertToBufferRGBA();n.release();let o=!0,l=[];if(a){const e=[{x:1,y:4,r:255,g:0,b:0,a:255,tolerence:1},{x:4,y:1,r:0,g:255,b:0,a:255,tolerence:1},{x:7,y:4,r:0,g:0,b:255,a:255,tolerence:1},{x:4,y:7,r:255,g:128,b:0,a:255,tolerence:2}];for(let t of e){const e=4*(t.x+9*(8-t.y));(Math.abs(a[e]-t.r)>t.tolerence||Math.abs(a[e+1]-t.g)>t.tolerence||Math.abs(a[e+2]-t.b)>t.tolerence||Math.abs(a[e+3]-t.a)>t.tolerence)&&(o=!1,l.push({expectedValues:t,actualValues:{r:a[e],g:a[e+1],b:a[e+2],a:a[e+3]}}))}}return{fSucceeded:o,triangleTestDifferences:l}}getWebGLState(){var e;return null===(e=this.m_graphicsProcessor)||void 0===e?void 0:e.getWebGLState()}}function vt(e,t){if(!e)return;const i=e&&e.constructor?e.constructor.name:void 0,r=t.split(".");let n=e;for(let e of r)n=n?n[e]:void 0;return(i||"")+(n?" "+n:"")}function yt(e){return 1==e.getType()?Object(s.k)(e,!1):Object(s.j)(e,!1,0,0,e.transform.toInverseMatrix3())}function bt(e){return e?e.memoryUsage:0}function St(e,t){e&&(e instanceof R.a&&e.tag?t.otherBrushes+=bt(e):2!=e.releasePolicy?t.managedImages+=bt(e):t.externalImages+=bt(e))}function Tt(e,t,i,r=!1){var n;const a=e.ensureRenderNode(t);if(a.cache){for(let e of a.cache.distanceFields||[])e.texture&&(r?i.textDistanceFields+=bt(e.texture):i.shapeDistanceFields+=bt(e.texture));St(a.cache.resolvedFillTexture,i),St(a.cache.resolvedLineTexture,i),St(a.cache.resolvedPictureTexture,i),i.effects+=bt(a.cache.innerShadowTexture),i.effects+=bt(a.cache.softEdgesTexture),i.effects+=bt(a.cache.glowTexture),i.effects+=bt(a.cache.shadowTexture),i.effects+=bt(a.cache.reflectionTexture),i.fadeMasks+=bt(a.cache.fadeTexture),i.rasterizedItems+=bt(a.cache.spriteTexture)}if(t instanceof s.e&&(null===(n=t.text)||void 0===n?void 0:n.cache)){const r=t.text.cache;r.textShapes.forEach(t=>{Tt(e,t,i,!0)}),r.hitTestLineShapes.forEach(t=>{Tt(e,t,i,!0)}),r.selectionShapes&&r.selectionShapes.forEach(t=>{Tt(e,t,i,!0)})}t instanceof s.b&&t.items.elements.forEach(t=>{Tt(e,t,i)})}function wt(e,t,i){for(let r of t.elements)for(let t of r.keyFrames)if(t){const r=e.ensureMorphKeyFrameRenderData(t);r.texture&&(i.morphTextures+=bt(r.texture))}}function Mt(e,t,i,r,n,a,s,o,l,d,h,c,u,m){const p=r?r.texture:void 0,g=f.b.ScaleTranslation2D(a,a.scale(.5).subtract(o)),_=g,v=f.b.Translation2D(o),b=g.multiply(N(i,s)),S=p?g.multiply(N(p,s)):f.b.Identity,T=t.getBabylonEffect();T.setMatrix3x3("u_0",_.m),T.setMatrix3x3("u_1",v.m),T.setMatrix3x3("u_2",b.m),T.setMatrix3x3("u_3",S.m),T.setVector2("u_4",a),T.setInt("ufrag_0",r?1:0),T.setVector2("ufrag_1",r?r.size.inverse().scale(r.contentQuality):f.e.Zero),T.setFloat("ufrag_2",r?2*r.distRangeSize:0),T.setFloat("ufrag_3",r?-r.distRangeSize+.5*d:0),T.setVector2("ufrag_4",l);const w=new Array(16);w.fill(0);const M=new Array(12);M.fill(0);const C=new Array(16);if(C.fill(0),h)for(let e=0;e<Math.min(h.lights.length,4);e++){const t=h.lights[e],i=Math.sqrt(t.direction.x*t.direction.x+t.direction.y*t.direction.y+t.direction.z*t.direction.z);w[4*e]=Math.abs(t.color.r),w[4*e+1]=Math.abs(t.color.g),w[4*e+2]=Math.abs(t.color.b),w[4*e+3]=Math.abs(t.color.a),M[3*e]=t.direction.x/i,M[3*e+1]=t.direction.y/i,M[3*e+2]=t.direction.z/i,C[4*e]=t.wrapScale,C[4*e+1]=t.wrapOffset,C[4*e+2]=t.diffuse,C[4*e+3]=t.specular}T.setDirectColor4("ufrag_5",h?h.ambientColor:y.b.Black),T.setArray4("ufrag_6",w),T.setArray3("ufrag_7",M),T.setArray4("ufrag_8",C),T.setDirectColor4("ufrag_9",c?c.diffuseColor:y.b.Black),T.setDirectColor4("ufrag_10",c?c.specularColor:y.b.Black),T.setDirectColor4("ufrag_11",c?c.ambientColor:y.b.Black),T.setDirectColor4("ufrag_12",c?c.emissiveColor:y.b.Black),c?T.setFloat4("ufrag_13",c.specularPower,c.useBlinnHighlight?1:0,c.diffuseFresnel,c.alphaFresnel):T.setFloat4("ufrag_13",0,0,0,0),T.setInt("ufrag_14",c?c.materialType:0),T.setFloat("ufrag_15",m),T.setDirectColor4("ufrag_16",u);const I=v?v.transformVector(f.e.One.scale(Math.sqrt(2)/2)).length():1;T.setFloat("ufrag_17",1/I),t.setTexture("t_0",i.tryUseBabylonTexture(e,void 0,"draw3D:T")),t.setTexture("t_1",p?p.tryUseBabylonTexture(e,void 0,"draw3D:D"):void 0),t.setTexture("t_2",n?n.tryUseBabylonTexture(e,void 0,"draw3D:P"):void 0),t.drawQuadInstances(1)}function Ct(e){return Math.round(1e3*(e+100*Number.EPSILON))/1e3}class It{getDebugStringForItem(e,t){return function e(t,i,r){let n="";const a=function(e,t,i){if(e instanceof s.e){const t=1==e.role?" background":2==e.role?" title Placeholder":3==e.role?" text":"";let r;if(e.isSolidRect())r=[" Solid rect"];else if(e.isSolidRectGeometry())r=[" Rect with line"];else if(r=[e.paths?""+Et(e.paths.length,"path"):" no paths!"],e.paths instanceof Array)for(let t of e.paths){let e=[" "," "," "," "];for(let i of t.figures)Pt(i,e,8);if(t.glyphCacheId&&i){const e=i.getDebugGlyphCacheInfo(t.glyphCacheId);r.push(" Font:"+t.glyphCacheId.fontId+", Glyph: "+t.glyphCacheId.glyphId+e==void 0?"Not cached":"Cached on page "+e)}r.push(...e)}const n=e.getBounds()?Bt(e.getBounds()||f.c.Zero):"undefined:",a=[(e.isHidden?" HIDDEN":"")+" Shape"+t+", Bounds: "+n+(e.textRange?", TextRange: "+Nt(e.textRange):""),...r," Transform: "+Dt(e.transform)," Style: "+Rt(e.style,i)];return(e.effects.glow||e.effects.shadow||e.effects.innerShadow||e.effects.reflection||e.effects.softEdges)&&a.push(" Effects: "+Ot(e.effects)),e.text&&a.push(...function(e,t){const i=[" Text "+Et(e.paragraphs.length,"paragraph")];i.push(" LayoutToFrame: "+Dt(e.layoutToFrame)),i.push(" FrameToShape:  "+Dt(e.frameToShape));for(let r=0;r<e.paragraphs.length;r++){const n=e.paragraphs[r];i.push("  Paragraph "+r+(n.bullet?" (with bullet)":" ")+"globalRange: "+Nt(n.globalRange)+", "+n.globalRange.length+" characters");const a=n.stylePerLocalRange.dataPerRange,s=n.effectsPerLocalRange.dataPerRange,o=n.strokesPerLocalRange.dataPerRange;if(a){let e="";for(let i=0;i<a.length;i++)e+=(0==i?"":", ")+Nt(a[i].range)+"("+Rt(a[i].data,t)+")";i.push("   Styles:  "+e)}if(s){let e="";for(let t=0;t<s.length;t++)e+=(0==t?"":", ")+Nt(s[t].range)+"("+Ot(s[t].data)+")";i.push("   Effects: "+e)}if(o){let e="";for(let t=0;t<o.length;t++)e+=(0==t?"":", ")+Nt(o[t].range)+"("+Ut(o[t].data)+")";i.push("   Stokes:  "+e)}for(let e=0;e<n.lines.length;e++){const t=n.lines[e];i.push("   Line "+e+" localRange:"+Nt(t.localRange)+", bounds:"+Bt(t.layoutBounds));let r="     Paths/Char: ";for(let e of t.characters)r+=e.textImage?"":e.paths instanceof x.c?"":e.paths?0==e.paths.length?"":e.paths.length>9?"+":e.paths.length:"";i.push(r),t.bender instanceof v.m?i.push("    Warping Source Bounds "+Bt(t.bender.sourceRect)):t.bender instanceof v.a&&i.push("    Pathing Source Bounds "+Bt(t.bender.lineRect))}}return i}(e.text,i)),a}if(e instanceof s.b){const t=e.getBounds()?Bt(e.getBounds()||f.c.Zero):"undefined:",r=[(e.isHidden?" HIDDEN":"")+" Group: "+Et(e.items.length,"item")+", Bounds: "+t," Transform: "+Dt(e.transform)];return(e.effects.glow||e.effects.shadow||e.effects.innerShadow||e.effects.reflection||e.effects.softEdges)&&r.push(" Effects: "+Ot(e.effects)),e.groupFillBrush&&r.push(" Group Fill: "+At(e.groupFillBrush,i)),r}return["Unknown"]}(t,0,r);for(let e=0;e<a.length;e++)n+=" ".repeat(i+(0==e?0:2))+a[e]+"\n";if(t instanceof s.b)for(const a of t.items.elements)n+=e(a,i+1,r);return n}(e,0,t)}getDebugStringForMorph(e,t){return function(e,t){let i="Morph "+Et(e.elements.length,"MorphElement")+":\n";for(let r=0;r<e.elements.length;r++){const n=e.elements[r];let a=[];for(let e of n.keyFrames)a.push(Wt(e,70,16,t));let s="-----"+"-".repeat(71).repeat(n.keyFrames.length);0==r&&(i+=s+"\n");for(let e=0;e<16;e++){i+="|",i+=3==e?r<10?" "+r+" ":r<100?" "+r:r<1e3?r:"1K+":5==e?null==n.rotateClockwise?"   ":n.rotateClockwise?"  ":"  ":"   ";for(let t=0;t<a.length;t++)i+="|"+a[t][e];i+="|\n"}i+=s+"\n"}return i}(e,t)}}function Pt(e,t,i){const r=new f.e(2*i,2*t.length),n=new Array(r.x*r.y).fill(!1),a=(e,t)=>{e[Object(f.g)(Math.floor(t.x),0,r.x-1)+Object(f.g)(Math.floor(t.y),0,r.y-1)*r.x]=!0},s=Object(x.d)([e]);s&&r.x>0&&e.forEachSegment((e,t,i)=>{for(let s=0;s<=1;s+=1/r.x)a(n,t?f.e.InterpolateQuadratic(e,t,i,s):f.e.InterpolateLinear(e,i,s));return!0},new f.d(s.leftTop.negate(),r.scale(1/Math.max(s.size.x,s.size.y))));for(let e=0;e<t.length;e++)for(let a=0;a<i;a++){const s=2*a+2*e*r.x;t[e]=t[e]+" "[(n[s]?1:0)+(n[s+1]?2:0)+(n[s+r.x]?4:0)+(n[s+1+r.x]?8:0)]+(a==i-1?"  ":"")}}function Et(e,t){return e+" "+(e>1?t+"s":t)}function xt(e){const t=Math.round(1e4*e)/1e4;return e!=t?t+"":t}function At(e,t){if(e instanceof y.i)return Vt(e.color);if(e instanceof y.c)return" "+["Linear","Radial","Rectangular","Path"][e.getType()-2]+" Gradient";if(e instanceof y.e){let i=" ImageBrush(";if(e.image){if(e.image.id&&(i+="id:"+e.image.id+" "),t){let r=t.tryGetImageDebugData(e.image);if(r){const e=r.getState(),t=r.getSize();i+=0==e?"uninitialized":2==e?"deleted":t?t.x+"x"+t.y:"no texture + bad state"}}}else i+="no image";return 1!=e.opacity&&(i+=", opacity="+e.opacity),i+")"}return e instanceof y.g?" Pattern":e instanceof y.j?8==e.getType()?"Background":9==e.getType()?"Group":" Unknown Custom":" Unknown Brush"}function kt(e){let t="(";return 0!=e.cap&&(t+=(1==e.cap?"square":"flat")+"cap"),t+=", "+function(e){switch(e){case 1:return"medium";case 0:return"narrow";case 2:return"wide"}}(e.width),t+=", "+function(e){switch(e){case 2:return"long";case 1:return"medium";case 0:return"short"}}(e.length),t+=")",t}function Rt(e,t){let i=(e.fillBrush?At(e.fillBrush,t):"No ")+" fill";return e.pictureBrush&&(i+=" + Picture "+At(e.pictureBrush,t)),e.lineBrush&&(i+=", "+At(e.lineBrush,t)+" line, width="+xt(e.pen.lineWidth),e.pen.lineHeight!=e.pen.lineWidth&&(i+=", height="+xt(e.pen.lineHeight)),1==e.pen.tipType?i+=",  Square Tip":0==e.pen.tipType&&(i+=",  Ball Tip"),0==e.pen.headEnd.end&&0==e.pen.tailEnd.end||(i+=", LineEnd ("+function(e,t){let i="";switch(e){case 5:i+="<";break;case 3:i+="";break;case 0:i+="";break;case 4:i+="";break;case 2:i+="";break;case 1:i+=""}switch(i+="",t){case 5:i+=">";break;case 3:i+="";break;case 0:i+="";break;case 4:i+="";break;case 2:i+="";break;case 1:i+=""}return i}(e.pen.headEnd.end,e.pen.tailEnd.end),0!=e.pen.headEnd.end&&(i+=" head "+kt(e.pen.headEnd)),0!=e.pen.tailEnd.end&&(i+=" tail "+kt(e.pen.tailEnd)),i+=")")),0!=e.blendingMode&&(i+=", blendingMode: "+(3==e.blendingMode?"cutout":1==e.blendingMode?"darken":2==e.blendingMode?"exclusion":" unknown")),i}function Ot(e){return(e.glow?"Glow ":"")+(e.shadow?"Shadow ":"")+(e.innerShadow?"InnerShadow ":"")+(e.reflection?"Reflection ":"")+(e.softEdges?"SoftEdges ":"")}function Lt(e){return"("+xt(e.x)+", "+xt(e.y)+")"}function Ft(e,t){const i=Math.round(10*e.x)/10,r=Math.round(10*(t?e.y:-e.y))/10;return(r<0?i<0?"":0==i?"":"":0==r?i<0?"":0==i?"":"":i<0?"":0==i?"":"")+Lt(e)}function Dt(e){let t="";return 0!=e.preTranslation.x&&0!=e.preTranslation.y&&(t+="PreTranslation "+Ft(e.preTranslation,!0)),1!=e.scale.x&&1!=e.scale.y&&(t+=", Scale x"+Lt(e.scale)),0!=e.rotation&&(t+=", Rotation "+(e.rotation>0?"":"")+Math.round(180*e.rotation/Math.PI)+""),t+", Translation "+Ft(e.translation,!0)}function Bt(e){return"[("+xt(e.left)+", "+xt(e.top)+"), ("+xt(e.right)+", "+xt(e.bottom)+")]"}function Nt(e){return 0==e.length?"]"+e.start+"[":1==e.length?"["+e.start+"]":e.length>1?"["+e.start+"-"+e.last+"]":"invalid(start="+e.start+", length="+e.length+")"}function Vt(e,t=!1){const i=e=>{const t=Math.floor(255*e);return t<16?"0"+t.toString(16):t.toString(16)};if(t)return"#"+i(e.r)+i(e.g)+i(e.b);const r="#"+i(e.r)+i(e.g)+i(e.b)+i(e.a);switch(r){case"#00000000":return"Transparent";case"#000000ff":return"Black";case"#ffffffff":return"White";case"#ff0000ff":return"Red";case"fffff00ff":return"Yellow";case"#00ff00ff":return"Green";case"#0000ffff":return"Blue"}return r}function Ut(e){let t="";if(e.elements)for(let i=0;i<e.elements.length;i++)switch(t+=0==i?"":", ",e.elements[i].type){case 0:t+="";break;case 1:t+="-";break;case 2:t+="=";break;default:t+="~"}return t}function Wt(e,t,i,r){let n=new Array(i);if(!e)return n.fill(" ".repeat(t)),n[Math.floor(i/2)]=" ".repeat(Math.floor((t-1)/2))+"",n[Math.floor(i/2)]+=" ".repeat(t-n[i/2].length),n;r?n=function(e,t,i,r){const n=new Array(i);if(n.fill(""),r){const a=r.tryGetImageDebugDataForMorphKeyFrame(e);if(a){const e=a.getSize();if(e){const r=a.tryConvertToBufferRGBA();if(r){const s=Math.max(e.x,e.y),o=Math.max(1,Math.floor(s/t)),l=Math.max(1,Math.floor(s/i)),d=1/(255*o*l);for(let a=0;a<i;a++)for(let i=0;i<t;i++)if(i*o<e.x&&a*l<e.y){let t=0,s=0,h=0,c=0;for(let n=0;n<l;n++)for(let u=0;u<o;u++){let f=4*(Math.min(i*o+u,e.x-1)+(e.y-1-Math.min(a*l+n,e.y-1))*e.x);t+=r[f]*d,s+=r[f+1]*d,h+=r[f+2]*d,c+=r[f+3]*d}const u=0==c?0:(.2126*t+.7152*s+.0722*h)/c,f=" ";n[a]+=c<.1?"":f[Math.max(0,Math.min(4,Math.floor(5*u)))]}else n[a]+=" ";const h=a.getLogicalCenter();if(h){const e=Math.floor(h.x/o),r=Math.floor(h.y/l);e>=0&&e<t&&r>=0&&r<i&&(n[r]=n[r].slice(0,e)+"X"+n[r].slice(e+1,n[r].length))}}else n[0]=" Failed to get bufffer"}else n[0]="No texture yet?"}for(let e=0;e<i;e++)n[e].length<t&&(n[e]+=" ".repeat(t-n[e].length)),n[e].length>t&&(n[e]=n[e].slice(0,t));return n}return n}(e,2*i,i,r):n.fill(" ".repeat(t));let a=[];if(0==e.contents.length)a.push(" KeyFrame has no content");else if(1==e.contents.length){const n=e.contents[0];if(n.item instanceof s.e){let e;if(n.textRange)a.push("TEXT Only: "+Nt(n.textRange)),n.item.text?e=new s.e(n.item.text.getTextPathsForRange(n.textRange)):a.push(" Shape has no text");else{a.push(n.includeSubtree?"SHAPE + Text":"SHAPE Only");const t=n.item.getBounds();a.push("Bounds:"+(t?Bt(t):" bad rect")),n.item.paths||a.push(" Shape has no path"),n.item.paths&&n.item.isSolidRectGeometry()?a.push("Rect Geometry"):e=n.item,a.push((n.item.style.fillBrush?At(n.item.style.fillBrush,r):"No ")+" fill"),n.item.style.pictureBrush&&a.push("+  picture"),n.item.style.lineBrush&&(a.push(At(n.item.style.lineBrush,r)+" line"),a.push("width = "+xt(n.item.style.pen.lineWidth)))}if(e){let r=[" "," "," "," "," "," "];const n=t-2*i-2;!function(e,t,i,r=f.b.Identity){const n=new f.e(2*i,2*t.length),a=new Array(n.x*n.y).fill(!1),o=(e,t)=>{e[Object(f.g)(Math.floor(t.x),0,n.x-1)+Object(f.g)(Math.floor(t.y),0,n.y-1)*n.x]=!0};let l=Object(s.k)(e,!1,r);if(l&&n.x>0)for(let t of e.paths||[])for(let e of t.figures)e.forEachSegment((e,t,i)=>{for(let r=0;r<=1;r+=1/n.x)o(a,t?f.e.InterpolateQuadratic(e,t,i,r):f.e.InterpolateLinear(e,i,r));return!0},f.b.FromTransforms(t.transform,r,new f.d(l.leftTop.negate(),n.scale(1/Math.max(l.size.x,l.size.y)))));for(let e=0;e<t.length;e++)for(let r=0;r<i;r++){const s=2*r+2*e*n.x;t[e]=t[e]+" "[(a[s]?1:0)+(a[s+1]?2:0)+(a[s+n.x]?4:0)+(a[s+1+n.x]?8:0)]+(r==i-1?"  ":"")}}(e,r,n,f.b.Scale2D(new f.e(2,n/r.length)));for(let e of r)a.push(e)}}else if(n.item instanceof s.b){a.push(n.textRange?" Group with TextRange ?!":n.includeSubtree?"Group + Subtree":"Group Effects Only"),a.push(function e(t){let i="";for(let r of t.items.elements)i+=r instanceof s.b?"G("+e(r)+")":r instanceof s.e?"S":"";return i}(n.item));const e=n.item.getBounds();a.push("Bounds:"+(e?Bt(e):" bad rect"))}}else{a.push(Et(e.contents.length,"content"));let t="";for(let i=0;i<e.contents.length;i++){const r=e.contents[i];r.item instanceof s.e?t+=r.textRange?"T"+Nt(r.textRange):r.includeSubtree?"S+":"S-":r.item instanceof s.b&&(t+=r.textRange?"GT":r.includeSubtree?"G+":"G-"),i!=e.contents.length-1&&(t+=",")}a.push(t)}a.push(""),a.push("Center: ("+Math.floor(e.location.center.x)+", "+Math.floor(e.location.center.y)+")"),a.push("Size: "+Math.floor(e.location.size.x)+" x "+Math.floor(e.location.size.y)),a.push("Rotation: "+Math.round(180*e.location.rotation/Math.PI)),a.push("Flip: "+(e.location.flipX||e.location.flipY?(e.location.flipX?"FlipX ":"")+(e.location.flipY?"FlipY":""):"none")),a.push("Grid: "+(e.morphingGrid?e.morphingGrid.size.x+"x"+e.morphingGrid.size.y:"none")),a.push("ZPos: "+e.zPosition);for(let e=0;e<i;e++)e<a.length&&(n[e]+=" "+a[e]),n[e].length<t&&(n[e]+=" ".repeat(t-n[e].length)),n[e].length>t&&(n[e]=n[e].slice(0,t));return n}class zt{static Record(e,t){zt.s_recorder.recordVeto(e,t)}static setRecorder(e){e&&(zt.s_recorder=e)}}zt.s_recorder={recordVeto:(e,t)=>{console.log("Veto",e,t)}};class Gt{constructor(){this.lastTransform=f.b.Identity,this.lastFadeProgress=1}detachSVG(){this.svgElement=void 0,this.svgElementContainer=void 0,this.customHtmlElementContainer=void 0,this.localRenderBounds=void 0,this.lastTransform=f.b.Identity,this.lastFadeProgress=1}releaseGeneratedResources(){this.detachSVG(),this.imgUri=void 0}onFinalization(){}}class jt{releaseGeneratedResources(){}onFinalization(){}}class Ht{constructor(e){this.m_nextId=1,this.canvas=e,this.m_rendererId="SVG"+Ht.s_nextSVGRendererId++}getImageUriFromShape(e){const t=Object(s.n)(e);if(t){const e=this.ensureImageRenderData(t);return e.uri||(qt("simple image has no uri"),m.a.Error(560989846,"simple image has no uri")),e.uri}}attachCustomHTMLToShape(e,t){this.ensureRenderNode(t).customHtmlElement=e}addOrUpdateShape(e,t,i){const r=this.ensureRenderNode(e),n=r.customHtmlElement;if(!r.svgElement&&!n){r.customHtmlElementContainer=void 0,r.imgUri&&r.versionCached==e.changeTracker.currentUniqueId||(r.imgUri=this.getImageUriFromShape(e),r.versionCached=e.changeTracker.currentUniqueId);const t=r.imgUri;if(r.imgUri){const i="SBSVG_image_"+this.m_nextId;r.svgElement=document.createElementNS("http://www.w3.org/2000/svg","image"),r.svgElement.setAttribute("id",i),r.svgElement.setAttributeNS("http://www.w3.org/1999/xlink","href",t||"");const n=Object(s.k)(e,!1);n?(r.svgElement.setAttribute("width",n.width.toString()),r.svgElement.setAttribute("height",n.height.toString()),r.svgElement.setAttribute("x",n.left.toString()),r.svgElement.setAttribute("y",n.top.toString()),r.localRenderBounds=n):(qt("simple image has no bounds"),m.a.Error(562042566,"simple image has no bounds"))}else{r.svgElement=function(e,t){if(e.style.pictureBrush)return qt("pictureBrush not SimpleImage"),void m.a.Error(562042571,'pictureBrush only supported for "SimpleImage"');if(e.style.fillBrush&&!(e.style.fillBrush instanceof y.i))return qt("fillBrush type "+e.style.fillBrush.getType()),void m.a.Error(562042572,"unsupported fillBrush type "+e.style.fillBrush.getType());if(e.style.lineBrush&&!(e.style.lineBrush instanceof y.i))return qt("lineBrush type "+e.style.lineBrush.getType()),void m.a.Error(562042573,"unsupported lineBrush type "+e.style.lineBrush.getType());if(e.effects.hasEffects||e.shape3D||e.scene3D)return qt("effects"),void m.a.Error(562042574,"unsupported effects");if(e.text)return qt("text"),void m.a.Error(562042575,"unsupported text");if(0!=e.style.pen.dashType||0!=e.style.pen.compoundType)return qt("dash/compound line"),void m.a.Error(562042576,"unsupported dash/compound line");if(0!=e.style.blendingMode)return qt("blending mode"),void m.a.Error(560989847,"unsupported blending mode "+e.style.blendingMode);let i="";for(let t of e.paths||[])for(let e of t.figures){let r=!0;e.forEachSegment((e,t,n)=>(r&&(i+=`M ${e.x} ${e.y} `,r=!1),i+=t?`Q ${t.x} ${t.y}, ${n.x} ${n.y} `:`L ${n.x} ${n.y} `,!0),t.transform),e.isClosed&&(i+="Z")}if(""==i)return qt("empty path"),void m.a.Error(562042577,"empty path");const r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("id",t),r.setAttribute("d",i),ie.a.readBooleanOrDefault("redPathSVG",!1)?(r.setAttribute("stroke","red"),r.setAttribute("stroke-width","4")):(e.style.fillBrush instanceof y.i&&(r.setAttribute("fill",Vt(e.style.fillBrush.color,!0)),r.setAttribute("fill-opacity",e.style.fillBrush.color.a.toString())),e.style.lineBrush instanceof y.i&&(r.setAttribute("stroke",Vt(e.style.lineBrush.color,!0)),r.setAttribute("stroke-opacity",e.style.lineBrush.color.a.toString())),r.setAttribute("stroke-width",e.style.lineBrush?e.style.pen.lineWidth.toString():"0")),r}(e,"SBSVG_path_"+this.m_nextId);const t=Object(s.k)(e,!0);r.localRenderBounds=t}if(!r.svgElement)return void m.a.Error(562042567,"Unsupported SVG scenario");{let e=document.createElementNS("http://www.w3.org/2000/svg","svg");const t=document.createElement("span");t.style.position="absolute",t.style.display="flex",t.appendChild(e),this.canvas.appendChild(t),r.svgElementContainer=t,r.localRenderBounds&&(e.setAttribute("width",r.localRenderBounds.width.toString()),e.setAttribute("height",r.localRenderBounds.height.toString()),r.svgElement.setAttribute("transform",`translate(${-r.localRenderBounds.left},${-r.localRenderBounds.top})`)),e.appendChild(r.svgElement)}this.m_nextId++}if(n&&!r.customHtmlElementContainer){const e=document.createElement("div");e.style.position="absolute",e.appendChild(n),this.canvas.appendChild(e),r.customHtmlElementContainer=e}const a=r.svgElementContainer&&r.localRenderBounds?f.b.Translation2D(r.localRenderBounds.size.scale(.5)):f.b.Identity,o=r.svgElementContainer&&r.localRenderBounds?f.b.Translation2D(r.localRenderBounds.size.scale(-.5)):f.b.Identity,l=f.b.FromTransforms(a,t,e.animationTransform||f.b.Identity,i&&i.transform?i.transform:f.b.Identity,o);if(!r.lastTransform.equals(l)){const e=r.customHtmlElementContainer||r.svgElementContainer;e?e.style.transform=`matrix(${l.m[0]},${l.m[1]},${l.m[3]},${l.m[4]},${l.m[6]},${l.m[7]})`:r.svgElement&&r.svgElement.setAttribute("transform",`matrix(${l.m[0]} ${l.m[1]} ${l.m[3]} ${l.m[4]} ${l.m[6]} ${l.m[7]})`)}const d=(e.fade?e.fade.progress:1)*(e.isHidden?0:1);r.lastFadeProgress!=d&&(r.customHtmlElementContainer&&(r.customHtmlElementContainer.style.opacity=d.toString()),r.svgElement&&r.svgElement.setAttribute("opacity",d.toString()))}buildTreeSvg(e,t,i){const r=e.transform.toMatrix3().multiply(t);if(e instanceof s.e)this.addOrUpdateShape(e,r,i);else if(e instanceof s.b)for(let t of e.items.elements)this.buildTreeSvg(t,r,i)}clearNodes(e){if(this.ensureRenderNode(e).detachSVG(),e instanceof s.b)for(let t of e.items.elements)this.clearNodes(t)}static clearElement(e){let t;for(;t=e.firstChild;)e.removeChild(t)}render(e,t,i){this.m_rootId!=e.changeTracker.currentUniqueId&&(Ht.clearElement(this.canvas),this.m_rootId=e.changeTracker.currentUniqueId,this.clearNodes(e)),t&&(this.canvas instanceof SVGElement?this.canvas.style.background=Vt(t,!0):this.canvas.style.backgroundColor=Vt(t,!0)),this.buildTreeSvg(e,f.b.Identity,i),Ye.OnRender(this,[{item:e,eraseBackground:t,options:i}])}renderMorph(e,t,i,r,n){throw m.a.Error(562042568,"Morph not supported in SVG mode")}hitTestScene(e,t,i,r){throw m.a.Error(562042569,"Hit Test not supported in SVG mode")}tryPrepareItem(e,t,i){return!0}tryPrepareMorph(e,t){throw m.a.Error(562042570,"Morph not supported in SVG mode")}getDebugString(e){return"NYI"}tryGetImageDebugData(e){}tryGetImageDebugDataForMorphKeyFrame(e){}getDebugGlyphCacheInfo(e){}attachUriToImage(e,t){this.ensureImageRenderData(e).uri=t}ensureRenderNode(e){let t=e.renderDataMap[this.m_rendererId];return t||(t=new Gt,e.renderDataMap[this.m_rendererId]=t),t}ensureImageRenderData(e){let t=e.renderDataMap[this.m_rendererId];return t||(t=new jt,e.renderDataMap[this.m_rendererId]=t),t}}function qt(e){zt.Record("ShapeNotRendered",[{Renderer:"SVGRenderer"},{Scenario:e}])}Ht.s_nextSVGRendererId=1;var $t=i(12),Zt=i(134),Xt=i(69);class Yt{constructor(e){this.m_env=e}init(e){this.m_env.setRenderingScenario(0)}setDefaults(){}restore(){}}class Jt{constructor(){this.supportsTransitions=!0,this.supportsGif=!0,this.isCanvasSizeSet=!1,this.devicePixelsToRenderedPixelsScale=1,this.m_tech="WebGL",this.m_isSBRendererReady=!1,this.onVisibilityChange=()=>{this.m_webGLContextLostStartTime&&"visible"===document.visibilityState&&(void 0===this.m_webGLContextRestoreStartTime||this.m_webGLContextLostStartTime>this.m_webGLContextRestoreStartTime)?this.m_webGLContextRestoredTimeout=window.setTimeout(()=>{o.a.sendTraceTag(561639887,l.a.msoulscat_Wac_PptSession,d.a.Error,"webglcontextrestored not raised after 3 seconds"),document.removeEventListener("visibilitychange",this.onVisibilityChange),this.viewController.events.emit("restoreWebGLContextFailed")},S.Settings.readNumberOrDefault("webGLContextRestoredTimeout",3e3)):"hidden"===document.visibilityState&&(o.a.sendTraceTag(509723856,l.a.msoulscat_Wac_PptSession,d.a.Info,"Clearing the restore WebGL timeout as visibility is lost"),clearTimeout(this.m_webGLContextRestoredTimeout),this.m_webGLContextRestoredTimeout=void 0)},o.a.sendTraceTag(561639874,l.a.msoulscat_Wac_PptSession,d.a.Info,"creating WebGLRendererEnvironment"),console.log("creating WebGLRendererEnvironment");let e=void 0;e=new Yt(this),S.Settings.readBooleanOrDefault("hackStateRestorerOn",!1)&&(e=new P(!1)),this.renderer=function(e={}){return new _t(e)}({stateRestorer:e,morphPlayer:new He,debugStringProvider:new It}),ai.createImageFromTexture=this.createImageFromTexture.bind(this)}get isGLContextValid(){return!!this.gl&&!this.gl.isContextLost()}get isSBValid(){return this.m_isSBRendererReady}get glContext(){return this.gl}get webGLRenderer(){return this.renderer}get tech(){return this.m_tech}get clientSize(){return this.viewController.getBounds.getClientSizeFromCanvas()}setRenderingScenario(e){if(e===this.m_renderingScenario)return;const t=this.renderer.getBabylonEngine();t&&t.wipeCaches(!0),this.m_renderingScenario=e}removeCanvas(e){this.releaseResources(),this.canvas&&e.contains(this.canvas)&&(e.removeChild(this.canvas),this.isCanvasSizeSet=!1,this.container=void 0)}releaseResources(){this.viewController.viewDataManager.imageDataMap=new Map,this.viewController.viewDataManager.memoryStats.gifTextures=0,this.viewController.viewDataManager.memoryStats.transitionTextures=0,this.viewController.viewDataManager.memoryStats.transitionsMemoryReport=new c.MemoryReport,this.viewController.viewDataManager.memoryStats.videoTextures=0,this.viewController.viewDataManager.memoryStats.cameoTextures=0;for(const e of this.viewController.viewDataManager.externalTexturesToRelease)e.texture.release();this.viewController.viewDataManager.externalTexturesToRelease=[];for(const e of this.viewControllerInternals.slideSceneView)e.scene&&this.viewControllerInternals.deleteScene(e),e.slideViewElement.shapeViewElements=[];this.gl=void 0,ai.gl=this.gl}setupCanvas(e){const t=oi.getElementFromCollection(e.children,"webgl-canvas");if(t)return this.canvas=t,void this.setupWebGLContext();if(this.viewControllerInternals.settings.isMultiSlideshowcoreEnabled&&this.container){const t=oi.getElementFromCollection(this.container.children,"webgl-canvas");if(t)return e.appendChild(t),void(this.container=e)}this.canvas=document.createElement("canvas"),this.canvas.id="webgl-canvas",this.canvas.style.pointerEvents="none",this.viewControllerInternals.settings.transparentCanvasForVideoEnabled&&(this.canvas.style.zIndex="1"),this.setupWebGLContext(),this.canvas.addEventListener("webglcontextlost",e=>this.lostContextHandler(e)),this.canvas.addEventListener("webglcontextrestored",()=>this.contextRestoredHandler()),e.appendChild(this.canvas),this.viewControllerInternals.settings.isMultiSlideshowcoreEnabled&&(this.container=e),this.isCanvasSizeSet=!1}setCanvasSize(e,t){this.devicePixelsToRenderedPixelsScale=t,this.canvas.style.width=e.x+"px",this.canvas.style.height=e.y+"px",this.canvas.width=Math.round(e.x*window.devicePixelRatio*t),this.canvas.height=Math.round(e.y*window.devicePixelRatio*t),this.gl&&this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.isCanvasSizeSet=!0}calculateRenderTransform(e){const t=this.getPixelScale(e),i=Math.min(t.x,t.y);return new f.d(new f.e(-e.x/2,-e.y/2),new f.e(i,i),void 0,new f.e(this.canvas.width/2,this.canvas.height/2))}calculateRenderTransformWithZoom(e,t,i){const r=this.getPixelScale(e);let n=t,a=i;return n&&a||(n=Math.min(r.x,r.y),a=new f.e(n*e.x/2,n*e.y/2)),new f.d(new f.e(-e.x/2,-e.y/2),new f.e(n,n),void 0,Object(Xt.c)(new f.e(this.clientSize.x/2,this.clientSize.y/2),a,e,n,window.devicePixelRatio*this.devicePixelsToRenderedPixelsScale))}async preloadShaders(e){try{e.getExtension("KHR_parallel_shader_compile");const t=oi.performanceNowTrimmed();this.m_isSBRendererReady=!1;const i=this.renderer.initializeAsync(e),r=this.renderer.getBabylonEngine();if(!r)throw o.a.sendTraceTag(538981318,l.a.msoulscat_Wac_PptSession,d.a.Error,"engine missing"),Error("no babylon engine");const n=Object(Zt.initializeAsync)(r);await Promise.all([i,n]),this.m_isSBRendererReady=!0;const a=oi.performanceNowTrimmed();o.a.sendTraceTag(561639875,l.a.msoulscat_Wac_PptSession,d.a.Info,`SB Shader Compilation finished in ${a-t}ms`)}catch(e){o.a.sendTraceTag(507884681,l.a.msoulscat_Wac_PptSession,d.a.Warning,"preloadShaders failed: "+e)}}flush(){this.gl&&this.gl.flush()}getPerformanceSummary(){return this.renderer.getPerformanceSummary()}generateTextureMemoryReport(e,t){return this.renderer.generateTextureMemoryReport(e,t)}verifyGlyphCacheIntegrityAndTryRecover(){return this.renderer.verifyGlyphCacheIntegrityAndTryRecover()}attachImage(e,t,i,r){if(!i.texture)throw o.a.sendTraceTag(561639876,l.a.msoulscat_Wac_PptSession,d.a.Error,"texture missing"),new Error("texture missing");const n=new R.b(e,this.renderer,i.texture,r,5,4,2);i.size.equals(r)||o.a.sendTraceTag(559269018,l.a.msoulscat_Wac_PptSession,d.a.Warning,`attachImage imageData.size:${JSON.stringify(i.size)} != size:${JSON.stringify(r)}`),t.id||o.a.sendTraceTag(561639877,l.a.msoulscat_Wac_PptSession,d.a.Error,"Missing imageContainer.id: "+t.id),this.viewController.viewDataManager.externalTexturesToRelease.push({imageId:t.id||"unknown",texture:n}),this.renderer.attachTextureToImage(t,n)}releaseImageData(e){e.texture&&this.gl&&this.gl.deleteTexture(e.texture)}saveImageData(e,t,i,r,n){const a=this.gl;if(!a)return o.a.sendTraceTag(561639878,l.a.msoulscat_Wac_PptSession,d.a.Error,"No webGL Context found"),{errorName:"CannotLoadTextureNoWebGLContext"};const s=a.createTexture();if(!s)return o.a.sendTraceTag(561639879,l.a.msoulscat_Wac_PptSession,d.a.Error,"Failed to create texture"),{errorName:"CreateTextureFailed"};if(S.Settings.readBooleanOrDefault("enableSVGAsWebGLTexture",!0)&&t.mimeType.startsWith("image/svg+xml")&&t.size.height>0&&t.size.width>0){const i=S.Settings.readNumberOrDefault("maxSvgTextureSize",2048),a=Math.max(t.size.width,t.size.height),s=n.x/r.x,h=n.y/r.y,c=a*Math.min(s,h)*(r.x/this.viewController.slideSizeEmus.x)*(window.devicePixelRatio||1);e.width=e.height=Math.min(Math.max(e.naturalHeight,e.naturalWidth,c),i),o.a.sendTraceTag(561639880,l.a.msoulscat_Wac_PptSession,d.a.Info,`loadImageTexture: SVG width = ${e.width}px, height = ${e.height}`)}a.bindTexture(a.TEXTURE_2D,s),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,1),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindTexture(a.TEXTURE_2D,null);const h=e.ID,c=this.viewController.viewDataManager.imageDataMap.get(h);return c&&(this.viewController.viewDataManager.memoryStats.externalTextureLeaks+=c.size.x*c.size.y*4,S.Settings.readBooleanOrDefault("releaseExistingExternalImages",!1)&&(this.releaseImageData(c),this.viewController.viewDataManager.onExternalTextureReleased(h))),this.viewController.viewDataManager.imageDataMap.set(h,{dataUri:e.src,texture:s,size:new f.e(e.naturalWidth,e.naturalHeight),loadedShapeIDs:[],loadedSlideIDs:[i]}),o.a.sendTraceTag(561639881,l.a.msoulscat_Wac_PptSession,d.a.Info,"loadImageTexture - loaded "+JSON.stringify({id:e.ID,slideId:i,size:new f.e(e.width,e.height),naturalSize:new f.e(e.naturalWidth,e.naturalHeight),byteCount:t.byteCount,mimeType:t.mimeType,urlType:t.urlType})),{}}async createTransition(e,t,i,r,n,a,s){const o={fSuccess:!1},l=e.type,d=e.dir,h=e.dur,u={};o.effectId=l;let m=s&&s.correlationId;const p={aspectRatio:n,direction:d,forward:r,gl:this.gl,engine:this.renderer.getBabylonEngine()};let g,_,v=!0,S=0;b.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(S=oi.performanceNowTrimmed());const T=this.viewController.getSlideViewElement(i),w=this.viewController.getSlideViewElement(t);b.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(u.getSlideViewElementMS=oi.performanceNowTrimmed()-S);let M=()=>{},C=()=>{};if(a&&T&&w&&e.morph&&(l===c.kTransitionIds.PPT_TRANSITION_MORPH||l===c.kTransitionIds.PPT_TRANSITION_PAN)){b.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(o.metadata||(o.metadata={}),u.morphTransitionFlow=!0);const e=this.viewController.viewDataManager.getSlideIndex(i),n=this.viewController.viewDataManager.getSlideIndex(t),a=this.slideIdsToMorphKey(i,t);if(a&&-1!==e&&-1!==n&&1===Math.abs(n-e)){let e=0;b.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(e=oi.performanceNowTrimmed());const n=await this.viewControllerInternals.morphCache.load(a,{meta_prevSlideId:r?i:t,meta_nextSlideId:r?t:i});if(b.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(u.generateMorphResource=oi.performanceNowTrimmed()-e),n.resource){_=n.resource,_.tryPrepareMorph();const e=this.morphKeyToSlideIds(a);_.isForwards=e.slideIdA.sid===i.sid&&e.slideIdA.cid===i.cid}}if(!_)return{fSuccess:!1};if(_.fallbackReasons.size>0)return{fSuccess:!1,metadata:{fallbackReasons:Array.from(_.fallbackReasons).join(", ")}};g=_,o.metadata=_.metadata}else{let e=[];if(!this.viewControllerInternals.transitionFactory.isTransitionDisabled(l,d)&&Object(c.isContentTransition)(l,d)){let r=0;b.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(r=oi.performanceNowTrimmed());const n={incomingSlideBackground:this.renderToTexture(t,{renderFilter:oi.createRenderBackgroundOrForegroundFilter(!0),correlationId:m,isContentTransition:!0}),outgoingSlideBackground:this.renderToTexture(i,{renderFilter:oi.createRenderBackgroundOrForegroundFilter(!0),correlationId:m,isContentTransition:!0}),incomingSlideForeground:this.renderToTexture(t,{renderFilter:oi.createRenderBackgroundOrForegroundFilter(!1),backgroundColor:y.b.Transparent,correlationId:m,isContentTransition:!0}),outgoingSlideForeground:this.renderToTexture(i,{renderFilter:oi.createRenderBackgroundOrForegroundFilter(!1),backgroundColor:y.b.Transparent,correlationId:m,isContentTransition:!0})};b.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(u.renderTransitionTextures=oi.performanceNowTrimmed()-r),p.incomingSlideBackground=n.incomingSlideBackground?n.incomingSlideBackground.tryGetWebGLTexture():void 0,p.outgoingSlideBackground=n.outgoingSlideBackground?n.outgoingSlideBackground.tryGetWebGLTexture():void 0,p.incomingSlideForeground=n.incomingSlideForeground?n.incomingSlideForeground.tryGetWebGLTexture():void 0,p.outgoingSlideForeground=n.outgoingSlideForeground?n.outgoingSlideForeground.tryGetWebGLTexture():void 0,e=Object.values(n)}else{let r=0;b.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(r=oi.performanceNowTrimmed());const n={incomingSlideBackground:this.renderToTexture(t,{correlationId:m}),outgoingSlideBackground:this.renderToTexture(i,{correlationId:m})};b.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(u.renderToTexture=oi.performanceNowTrimmed()-r),p.incomingSlideBackground=n.incomingSlideBackground?n.incomingSlideBackground.tryGetWebGLTexture():void 0,p.outgoingSlideBackground=n.outgoingSlideBackground?n.outgoingSlideBackground.tryGetWebGLTexture():void 0,e=Object.values(n)}const r=new f.e(this.canvas.width,this.canvas.height);this.setRenderingScenario(1);const n=new c.SlideTransitionInfo(p);let a=0;b.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(a=oi.performanceNowTrimmed());const s=await this.viewControllerInternals.transitionFactory.getTransition(l,d,n,this.viewController.viewDataManager.memoryStats.transitionsMemoryReport);if(b.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(u.transitionFactoryMS=oi.performanceNowTrimmed()-a),!s.transition)return o.isSupported=!1,o;v=s.isSupported,g=s.transition,M=()=>{const t=this.gl;if(t&&!t.isContextLost()){for(const t of e)t&&(this.viewController.viewDataManager.memoryStats.transitionTextures-=r.x*r.y*4,t.release());g.dispose()}},C=()=>{this.setRenderingScenario(1)}}return this.viewControllerInternals.transitionController=new ni(g,h,r,C,M),o.fSuccess=!0,o.isSupported=v,b.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(o.metadata||(o.metadata={}),o.metadata.rendererEnvironment=u),o}enableVerboseRenderLogging(e){this.renderer.enableVerboseRenderLogging(e)}getPixelScale(e){const t=this.clientSize.x/e.x,i=this.clientSize.y/e.y;return new f.e(t,i).scale(window.devicePixelRatio*this.devicePixelsToRenderedPixelsScale)}setupWebGLContext(){this.canvas.addEventListener("webglcontextcreationerror",e=>this.logContextCreationError(e));const e={failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!0},t={failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!0};let i=[{contextId:"webgl",options:e},{contextId:"experimental-webgl",options:e},{contextId:"webgl",options:t},{contextId:"experimental-webgl",options:t}];S.Settings.readBooleanOrDefault("webgl2Enabled",!1)&&(i=[{contextId:"webgl2",options:e},{contextId:"webgl",options:e},{contextId:"experimental-webgl",options:e},{contextId:"webgl2",options:t},{contextId:"webgl",options:t},{contextId:"experimental-webgl",options:t}]);for(const e of i)if(this.gl=this.canvas.getContext(e.contextId,e.options)||void 0,this.gl){const i="webgl2"===e.contextId?"WebGL2":"WebGL",r=e.options===t;oi.s_rendererTech=i;let n=!1;const a=this.gl.getExtension("WEBGL_debug_renderer_info");if(a){const e=this.gl.getParameter(a.UNMASKED_RENDERER_WEBGL).toLowerCase();n=S.Settings.readStringOrDefault("badGpuList","").toLowerCase().indexOf(e)>=0}oi.s_isBadGpu=n,o.a.sendTraceTag(561639882,l.a.msoulscat_Wac_PptSession,d.a.Info,"WebGL initialized "+JSON.stringify({rendererTech:i,isBadGpu:n,fPerfCaveat:r})),r&&(oi.s_gpuHardwareDisabled=!0,o.a.sendTraceTag(520897678,l.a.msoulscat_Wac_PptSession,d.a.Info,"WebGL initialized with gpu hardware disabled"));break}if(!this.gl)return o.a.sendTraceTag(561639883,l.a.msoulscat_Wac_PptSession,d.a.Error,"Unable to initialize WebGL"),void $t.VetoUtils.recordVeto("SetupWebGLContextFailed",{msg:"SetupWebGLContextFailed"});ai.gl=this.gl,this.gl.viewport(0,0,this.canvas.width,this.canvas.height)}logContextCreationError(e){o.a.sendTraceTag(555018370,l.a.msoulscat_Wac_PptSession,d.a.Error,"Unable to initialize WebGL - "+(e.statusMessage||"Unknown error"))}lostContextHandler(e){e.preventDefault(),o.a.sendTraceTag(561639884,l.a.msoulscat_Wac_PptSession,d.a.Warning,`WebGL context lost. CurrentSceneCount:${this.viewControllerInternals.currentSceneCount}, MaxSceneCount:${this.viewControllerInternals.forwardSceneCount+this.viewControllerInternals.backwardSceneCount+1},\n       CurrentRenderedSlideId:${JSON.stringify(this.viewControllerInternals.currentRenderedSlideId)}, SlideSize:${JSON.stringify(this.viewController.slideSizeEmus)},\n        CanvasWidth:${this.canvas.width}, CanvasHeight:${this.canvas.height}, \n        CanvasSizeWidth:${this.clientSize.x}, CanvasSizeHeight:${this.clientSize.y}, \n        DPI:${window.devicePixelRatio}, ImageTextureMapSize:${this.viewController.viewDataManager.imageDataMap.size},\n        MemoryStats:${JSON.stringify(this.viewController.viewDataManager.memoryStats)}`),this.viewController.viewDataManager.imageDataMap.forEach((e,t)=>{o.a.sendTraceTag(561639885,l.a.msoulscat_Wac_PptSession,d.a.Warning,`WebGL context lost. imageDataMap Key:${t} Size:${JSON.stringify(e.size)} SlideIds:${JSON.stringify(e.loadedSlideIDs)} Memory:${e.size.x*e.size.y*4}`)});const t=this.viewControllerInternals.slideSceneView.filter(e=>e.scene).map(e=>e.scene),i=this.viewControllerInternals.morphCache.getAllLoadResultsInCache().filter(e=>e.resource).map(e=>e.resource.morph);o.a.sendTraceTag(561639886,l.a.msoulscat_Wac_PptSession,d.a.Warning,"WebGL context lost. SB Scene Memory:"+JSON.stringify(this.generateTextureMemoryReport(t,i))),this.m_webGLContextLostStartTime=new Date,this.m_isSBRendererReady=!1,this.renderer.onWebGLContextLost(),this.releaseResources(),this.viewController.events.emit("webglcontextlost"),"visible"===document.visibilityState&&(void 0===this.m_webGLContextRestoreStartTime||this.m_webGLContextLostStartTime>this.m_webGLContextRestoreStartTime)&&(this.m_webGLContextRestoredTimeout=window.setTimeout(()=>{o.a.sendTraceTag(561639887,l.a.msoulscat_Wac_PptSession,d.a.Error,"webglcontextrestored not raised after 3 seconds"),document.removeEventListener("visibilitychange",this.onVisibilityChange),this.viewController.events.emit("restoreWebGLContextFailed")},S.Settings.readNumberOrDefault("webGLContextRestoredTimeout",3e3))),document.addEventListener("visibilitychange",this.onVisibilityChange)}renderToTexture(e,t){if(!this.gl)return;const i=new f.e(this.canvas.width,this.canvas.height);w.a.verifyTextureSize(this.viewController,"transition",i);const r=new R.a("Transition",this.renderer,i,0);if(!r.tryGetWebGLTexture())return;this.viewController.viewDataManager.memoryStats.transitionTextures+=this.canvas.width*this.canvas.height*4,o.a.sendTraceTag(561639888,l.a.msoulscat_Wac_PptSession,d.a.Info,"ViewController::renderToTexture - SlideId: "+e.sid);const n={zoomLevel:S.Settings.readNumberOrDefault("minimumZoom",1),canvasCenterSlidePointPercent:{x:.5,y:.5}},a=!S.Settings.readBooleanOrDefault("saveVerifyGlyphForTransition",!1);let s=this.viewController.renderSlideByIdExtended(e,!0,r,t&&t.renderFilter,t&&t.backgroundColor,a,!1,n);return o.a.sendTraceTag(507650462,l.a.msoulscat_Wac_PptSession,d.a.Warning,""+JSON.stringify({...s,correlationId:t&&t.correlationId,isContentTransition:t&&t.isContentTransition})),r}slideIdsToMorphKey(e,t){if(e.sid!==t.sid||e.cid!==t.cid)return e.sid<t.sid||e.sid===t.sid&&e.cid<t.cid?`${JSON.stringify(e)}_${JSON.stringify(t)}`:`${JSON.stringify(t)}_${JSON.stringify(e)}`}morphKeyToSlideIds(e){const t=e.split("_");return{slideIdA:JSON.parse(t[0]),slideIdB:JSON.parse(t[1])}}async contextRestoredHandler(){this.m_webGLContextRestoreStartTime=new Date;const e=this.m_webGLContextLostStartTime?this.m_webGLContextRestoreStartTime.getTime()-this.m_webGLContextLostStartTime.getTime():-1;if(o.a.sendTraceTag(561639889,l.a.msoulscat_Wac_PptSession,d.a.Info,`WebGL context restored in ${e}ms`),clearTimeout(this.m_webGLContextRestoredTimeout),this.m_webGLContextRestoredTimeout=void 0,document.removeEventListener("visibilitychange",this.onVisibilityChange),this.setupWebGLContext(),this.gl){if(await this.preloadShaders(this.gl),this.viewControllerInternals.currentRenderedSlideId){const e=this.viewControllerInternals.slideSceneView.find(e=>e.slideId.sid===this.viewControllerInternals.currentRenderedSlideId.sid);if(e){const t=await this.viewControllerInternals.createImageTextureMapData(e);t.hasOwnProperty("invalidImageIds")&&(o.a.sendTraceTag(561639890,l.a.msoulscat_Wac_PptSession,d.a.Error,"ViewController::contextRestoredHandler - "+JSON.stringify(t)),$t.VetoUtils.recordVeto("ACE",t));const i=await e.slideViewElement.ensure();(i.hasOwnProperty("invalidShapeIds")||i.hasOwnProperty("missingTextureIds")||i.hasOwnProperty("errorName"))&&(o.a.sendTraceTag(561639891,l.a.msoulscat_Wac_PptSession,d.a.Error,"ViewController::contextRestoredHandler - "+JSON.stringify(i)),$t.VetoUtils.recordVeto("ACE",i),i.hasOwnProperty("errorName")&&this.viewController.events.emit("restoreWebGLContextFailed"));const r={zoomLevel:S.Settings.readNumberOrDefault("minimumZoom",1),canvasCenterSlidePointPercent:{x:.5,y:.5}};this.viewController.renderSlideById(this.viewControllerInternals.currentRenderedSlideId,r)}}this.viewController.events.emit("webglcontextrestored")}}createImageFromTexture(e,t){const i=this.gl;if(!i||!this.isGLContextValid)return void console.log("createImageFromTexture: gl invalid");let r,n,a;e instanceof R.b?(r=e.tryGetWebGLTexture(),n=e.size.x,a=e.size.y):(r=e.texture,n=e.size.x,a=e.size.y);const s=i.createFramebuffer(),o=i.getParameter(i.FRAMEBUFFER_BINDING);i.bindFramebuffer(i.FRAMEBUFFER,s),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,r,0);const l=new Uint8Array(n*a*4);function d(){const e=document.createElement("canvas");e.width=n,e.height=a;const t=e.getContext("2d");return{canvas:e,context:t}}i.readPixels(0,0,n,a,i.RGBA,i.UNSIGNED_BYTE,l),i.bindFramebuffer(i.FRAMEBUFFER,o),i.deleteFramebuffer(s);const h=d(),{canvas:c,context:u}=d();if(!u||!h.context)return void console.log("createImageFromTexture: cannot create 2D context");const f=h.context.createImageData(n,a);f.data.set(l),h.context.putImageData(f,0,0),u.translate(0,a),u.scale(1,-1),u.drawImage(h.canvas,0,0);const m=c.toDataURL();if(t&&t.fNewWindow){const e=window.open();if(e){const t=new Image;t.src=m,e.document.write(t.outerHTML)}}return m}}class Kt{constructor(){this.supportsTransitions=!1,this.supportsGif=!1,this.isGLContextValid=!0,this.isSBValid=!0,this.glContext=void 0,this.webGLRenderer=void 0,this.isCanvasSizeSet=!1,this.devicePixelsToRenderedPixelsScale=1,o.a.sendTraceTag(561639892,l.a.msoulscat_Wac_PptSession,d.a.Info,"creating SVGRendererEnvironment"),console.log("creating SVGRendererEnvironment");const e=document.createElement("div");e.style.position="absolute",e.style.overflow="hidden",e.setAttribute("aria-hidden","true"),this.renderer=new Ht({canvas:e}.canvas),S.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&e.addEventListener("scroll",()=>{e.scrollLeft=0,e.scrollTop=0}),this.canvas=document.createElement("div"),this.canvas.appendChild(e),this.svgRoot=e,oi.s_rendererTech="SVG",oi.s_isBadGpu=!1}get clientSize(){return this.viewController.getBounds.getClientSizeFromCanvas()}removeCanvas(e){this.canvas&&e.contains(this.canvas)&&(e.removeChild(this.canvas),this.container=void 0,this.isCanvasSizeSet=!1)}setupCanvas(e){if(!oi.getElementFromCollection(e.children,"svg-canvas")){if(this.viewControllerInternals.settings.isMultiSlideshowcoreEnabled&&this.container){const t=oi.getElementFromCollection(this.container.children,"svg-canvas");if(t)return e.appendChild(t),void(this.container=e)}this.canvas.id="svg-canvas",this.canvas.style.pointerEvents="none",this.canvas.style.background="white",this.viewControllerInternals.settings.transparentCanvasForVideoEnabled&&(this.canvas.style.zIndex="1"),e.appendChild(this.canvas),this.viewControllerInternals.settings.isMultiSlideshowcoreEnabled&&(this.container=e),this.isCanvasSizeSet=!1}}setCanvasSize(e,t){this.canvas.style.width=e.x+"px",this.canvas.style.height=e.y+"px",this.canvas.style.minWidth=e.x+"px",this.canvas.style.minHeight=e.y+"px",this.svgRoot.style.width=e.x+"px",this.svgRoot.style.height=e.y+"px",this.isCanvasSizeSet=!0}calculateRenderTransform(e){const t=this.getPixelScale(e),i=Math.min(t.x,t.y);return new f.d(new f.e(-e.x/2,-e.y/2),new f.e(i,i),void 0,new f.e(this.clientSize.x/2,this.clientSize.y/2))}calculateRenderTransformWithZoom(e,t,i){const r=this.getPixelScale(e);let n=t,a=i;return n&&a||(n=Math.min(r.x,r.y),a=new f.e(n*e.x/2,n*e.y/2)),new f.d(new f.e(-e.x/2,-e.y/2),new f.e(n,n),void 0,Object(Xt.c)(new f.e(this.clientSize.x/2,this.clientSize.y/2),a,e,n,1))}async preloadShaders(e){}flush(){}getPerformanceSummary(){}generateTextureMemoryReport(e,t){}verifyGlyphCacheIntegrityAndTryRecover(){return!0}attachImage(e,t,i,r){if(!i.dataUri)throw o.a.sendTraceTag(561639893,l.a.msoulscat_Wac_PptSession,d.a.Error,"dataUrl missing"),new Error("dataUrl missing");this.renderer.attachUriToImage(t,i.dataUri)}releaseImageData(e){}saveImageData(e,t,i,r,n){if(S.Settings.readBooleanOrDefault("enableSVGAsWebGLTexture",!0)&&t.mimeType.startsWith("image/svg+xml")&&t.size.height>0&&t.size.width>0){const i=S.Settings.readNumberOrDefault("maxSvgTextureSize",2048),a=Math.max(t.size.width,t.size.height),s=n.x/r.x,h=n.y/r.y,c=a*Math.min(s,h)*(r.x/this.viewController.slideSizeEmus.x)*(window.devicePixelRatio||1);e.width=e.height=Math.min(i,c),o.a.sendTraceTag(561639894,l.a.msoulscat_Wac_PptSession,d.a.Info,`loadImageTexture: SVG width = ${e.width}px, height = ${e.height}`)}return this.viewController.viewDataManager.imageDataMap.set(e.ID,{dataUri:e.src,size:new f.e(e.naturalWidth,e.naturalHeight),loadedShapeIDs:[],loadedSlideIDs:[i]}),o.a.sendTraceTag(561639895,l.a.msoulscat_Wac_PptSession,d.a.Info,"loadImageTexture - loaded "+JSON.stringify({id:e.ID,slideId:i,width:e.naturalWidth,height:e.naturalHeight,byteCount:t.byteCount,mimeType:t.mimeType,urlType:t.urlType})),{}}async createTransition(e,t,i,r,n,a){return{fSuccess:!1}}enableVerboseRenderLogging(e){}getPixelScale(e){const t=this.clientSize.x/e.x,i=this.clientSize.y/e.y;return new f.e(t,i)}}var Qt=i(137),ei=i(44);class ti{constructor(e,t){this.m_lastClientSizeFromCanvas=f.e.Zero,this.m_lastClientSizeFromContainer=f.e.Zero,this.m_container=e,this.m_rendererEnvironment=t,S.Settings.readBooleanOrDefault("useCachedClientSize",!1)&&Object(ei.waitUntilTrueAsync)(()=>this.ensureCachedBounds())}ensureCachedBounds(){const e=this.m_rendererEnvironment.canvas;return this.m_lastBoundingClientRectFromContainer||(this.m_lastBoundingClientRectFromContainer=this.m_container.getBoundingClientRect()),!this.m_lastBoundingClientRectFromCanvas&&e&&(this.m_lastBoundingClientRectFromCanvas=e.getBoundingClientRect()),this.m_lastClientSizeFromContainer===f.e.Zero&&e&&(this.m_lastClientSizeFromContainer=new f.e(e.clientWidth,e.clientHeight)),this.m_lastClientSizeFromCanvas===f.e.Zero&&e&&(this.m_lastClientSizeFromCanvas=new f.e(e.clientWidth,e.clientHeight)),!(!this.m_lastBoundingClientRectFromContainer||!this.m_lastBoundingClientRectFromCanvas||this.m_lastClientSizeFromContainer===f.e.Zero||this.m_lastClientSizeFromCanvas===f.e.Zero)}getBoundingClientRectFromContainer(){if(S.Settings.readBooleanOrDefault("useCachedClientSize",!1)){const e=this.m_container.getBoundingClientRect();return 0===e.width||0===e.height?this.m_lastBoundingClientRectFromContainer?this.m_lastBoundingClientRectFromContainer:(o.a.sendTraceTag(512260235,l.a.msoulscat_Wac_PptSession,d.a.Error,"unable to getBoundingClientRect from canvas"),e):(this.m_lastBoundingClientRectFromContainer=e,e)}return this.m_container.getBoundingClientRect()}getBoundingClientRectFromCanvas(){if(S.Settings.readBooleanOrDefault("useCachedClientSize",!1)){const e=this.m_rendererEnvironment.canvas.getBoundingClientRect();return 0===e.width||0===e.height?this.m_lastBoundingClientRectFromCanvas?this.m_lastBoundingClientRectFromCanvas:(o.a.sendTraceTag(512260234,l.a.msoulscat_Wac_PptSession,d.a.Error,"unable to getBoundingClientRect from canvas"),e):(this.m_lastBoundingClientRectFromCanvas=e,e)}return this.m_rendererEnvironment.canvas.getBoundingClientRect()}getClientSizeFromCanvas(){const e=this.m_rendererEnvironment.canvas;if(S.Settings.readBooleanOrDefault("useCachedClientSize",!1)){const t=new f.e(e.clientWidth,e.clientHeight);return 0===t.x||0===t.y?(0!==this.m_lastClientSizeFromCanvas.x&&0!==this.m_lastClientSizeFromCanvas.y||o.a.sendTraceTag(512260233,l.a.msoulscat_Wac_PptSession,d.a.Error,"unable to get clientWidth or clientHeight from canvas"),this.m_lastClientSizeFromCanvas):(this.m_lastClientSizeFromCanvas=t,t)}return new f.e(e.clientWidth,e.clientHeight)}getClientSizeFromContainer(){if(S.Settings.readBooleanOrDefault("useCachedClientSize",!1)){const e=new f.e(this.m_container.clientWidth,this.m_container.clientHeight);return 0===e.x||0===e.y?this.m_lastClientSizeFromContainer?this.m_lastClientSizeFromContainer:(o.a.sendTraceTag(512233990,l.a.msoulscat_Wac_PptSession,d.a.Error,"unable to clientWidth or clientHeight from container"),e):(this.m_lastClientSizeFromContainer=e,e)}return new f.e(this.m_container.clientWidth,this.m_container.clientHeight)}}var ii,ri=i(259);!function(e){e[e.Start=1]="Start",e[e.Completed=2]="Completed",e[e.Failed=3]="Failed"}(ii||(ii={}));class ni{constructor(e,t,i,r,n){this.m_transition=e,this.m_duration=t,this.m_fForwards=i,this.m_onDraw=r,this.onDispose=n,this.m_clock=new h.d,this.m_clock.start(0)}get transition(){return this.m_transition}get duration(){return this.m_duration}get clock(){return this.m_clock}render(e){const t=Math.max(0,Math.min(1,e/this.m_duration)),i=this.m_fForwards?t:1-t;try{this.m_onDraw(),this.m_transition.draw(i)}catch(e){return o.a.sendTraceTag(576583007,l.a.msoulscat_Wac_PptSession,d.a.Error,"Unexpected exception in m_transition.draw: "+e),!1}return e<this.m_duration}}let ai={};function si(e){e.logger&&(o.a.setLogger(e.logger),Object(h.g)(e.logger),Object(a.H)(e.logger)),e.settings&&(S.Settings.load(e.settings?e.settings.slideshowcore:{}),Object(a.J)(e.settings?e.settings.shapebuilder:{})),e.disabledChangeGates&&b.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.svm=ai),Object(h.l)(e),S.Settings.readBooleanOrDefault("useShapeBuilderUlsLogger",!1)&&Object(a.H)(T.b.getInstance())}class oi{constructor(e,t,i,r,n,s,h,f){if(this.m_slideSceneView=new Array,this.m_transitionController=null,this.m_isGlobalMute=!1,this.m_fCheckGlyphCacheOnNextRender=!1,this.m_renderStateSnapshot={slideRendMap:{}},this.m_createImageTextureMapDataThrottler=new ei.ParallelCriticalAsyncFunctionThrottler(this.createImageTextureMapDataImpl.bind(this),ei.executeAllQueueHandler,e=>JSON.stringify(e.slideId)),this.isAnimating=!1,this.isTransitioning=!1,this.crossSlideMediaMap={},this.mediaCommandScope=0,this.events=new u.EventEmitter,si({logger:r,settings:n.settings,disabledChangeGates:n.disabledChangeGates||""}),this.settings=n,this.stringifyError=n.stringifyError,oi.ensureRendererEnvironment(),!oi.s_preloadedRendererEnvironment)throw o.a.sendTraceTag(555268167,l.a.msoulscat_Wac_PptSession,d.a.Error,"ViewController::constructor - s_preloadedRendererEnvironment is null");this.rendererEnvironment=oi.s_preloadedRendererEnvironment,this.getBounds=n.getBounds?n.getBounds:new ti(e,this.rendererEnvironment),ai.this=this,ai.getDebugString=this.rendererEnvironment.renderer.getDebugString.bind(this.rendererEnvironment.renderer),ai.getGpuMemory=this.getGpuMemory.bind(this),ai.checkForLeaks=this.checkForLeaks.bind(this),ai.getWebGLState=()=>this.rendererEnvironment.webGLRenderer&&this.rendererEnvironment.webGLRenderer.getWebGLState(),this.slideSizeEmus=t,this.viewDataManager=i,this.settings.morphEnabled=this.settings.morphEnabled&&this.rendererEnvironment.supportsTransitions,this.rendererEnvironment.viewController=this,h&&(oi.appLanguage=h),f&&(this.addinManager=f);const m=this;this.rendererEnvironment.viewControllerInternals={get slideSceneView(){return m.m_slideSceneView},get forwardSceneCount(){return m.m_forwardSceneCount},get backwardSceneCount(){return m.m_backwardSceneCount},get currentSceneCount(){return m.m_currentSceneCount},get transitionFactory(){return m.m_transitionFactory},get settings(){return m.settings},get currentRenderedSlideId(){return m.m_currentRenderedSlideId},get morphCache(){return m.m_morphCache},set transitionController(e){m.m_transitionController=e},deleteScene:this.deleteScene.bind(this),createImageTextureMapData:this.createImageTextureMapData.bind(this)},this.settings.isMultiSlideshowcoreEnabled&&(this.m_viewControllerInternals=this.rendererEnvironment.viewControllerInternals),this.m_forwardSceneCount=S.Settings.readNumberOrDefault("forwardSceneCount",2),this.m_backwardSceneCount=S.Settings.readNumberOrDefault("backwardSceneCount",2),this.m_currentSceneCount=0,this.m_cameoTextureManager=Qt.a.getInstance(this),this.m_morphCache=new C.b({load:this.morphLoader.bind(this)}),this.m_container=e,Object(a.G)(!0),this.rendererEnvironment.setupCanvas(this.m_container),this.m_transitionFactory=new c.BabylonTransitionFactory({customTransitionDataLoader:s,transitionDisabledList:S.Settings.readStringOrDefault("transitionDisabledList","")}),this.m_accessibilityLiveRegionContainer=document.createElement("div"),this.m_container.tabIndex=0,this.m_accessibilityLiveRegionContainer.id=oi.AccessibilityLiveRegionContainerDivId,this.m_accessibilityLiveRegionContainer.setAttribute("style","position: absolute; left: 0px; top: auto; width: 1px; height: 1px; overflow: hidden;"),this.m_accessibilityLiveRegionContainer.setAttribute("aria-live","assertive"),this.m_accessibilityLiveRegionContainer.setAttribute("aria-atomic","true"),this.m_accessibilityLiveRegionContainer.setAttribute("role","alert"),this.m_container.appendChild(this.m_accessibilityLiveRegionContainer),this.m_crossSlideAudioContainer=document.createElement("div"),this.m_crossSlideAudioContainer.style.position="absolute",this.m_crossSlideAudioContainer.style.pointerEvents="none",this.m_crossSlideAudioContainer.id=oi.CrossSlideAudioContainerDivId,this.m_slideLevelHtmlElementsParentContainer=document.createElement("div"),this.m_slideLevelHtmlElementsParentContainer.id=oi.SlideLevelHtmlElementsParentDivId,S.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&(this.m_slideLevelHtmlElementsParentContainer.style.position="absolute",this.m_slideLevelHtmlElementsParentContainer.style.overflow="hidden",this.m_slideLevelHtmlElementsParentContainer.style.pointerEvents="none",this.m_slideLevelHtmlElementsParentContainer.addEventListener("scroll",()=>{this.m_slideLevelHtmlElementsParentContainer.scrollLeft=0,this.m_slideLevelHtmlElementsParentContainer.scrollTop=0})),this.m_container.appendChild(this.m_slideLevelHtmlElementsParentContainer),this.m_notesPaneParagraphReaderContainer=document.createElement("div"),this.m_notesPaneParagraphReaderContainer.id=oi.NotesPaneParagraphReaderId,this.m_notesPaneParagraphReaderContainer.setAttribute("aria-live","assertive"),this.m_notesPaneParagraphReaderContainer.setAttribute("aria-atomic","true"),this.m_notesPaneParagraphReaderContainer.setAttribute("role","alert"),this.m_notesPaneParagraphReaderContainer.classList.add("show-accessibility-element"),this.m_notesPaneParagraphReaderContainer.style.display="",this.m_container.appendChild(this.m_notesPaneParagraphReaderContainer),this.m_clickTargetsReferenceDiv=document.createElement("div"),this.m_clickTargetsReferenceDiv.style.position="absolute",this.m_clickTargetsReferenceDiv.style.zIndex="-1",this.m_clickTargetsReferenceDiv.style.pointerEvents="none",this.m_clickTargetsReferenceDiv.id=oi.ClickTargetsReferenceDivId,this.m_container.appendChild(this.m_clickTargetsReferenceDiv),this.m_inScreenCoordsContainer=document.createElement("div"),this.m_inScreenCoordsContainer.id="in-screen-coords",this.m_inScreenCoordsContainer.style.position="absolute",this.m_inScreenCoordsContainer.style.pointerEvents="none",this.m_container.appendChild(this.m_inScreenCoordsContainer),this.m_preActivedAddinsContainer=document.createElement("div"),this.m_preActivedAddinsContainer.id=oi.PreactivedAddinsDivId,this.m_preActivedAddinsContainer.style.zIndex="-1",this.m_preActivedAddinsContainer.style.visibility="hidden",this.m_preActivedAddinsContainer.style.display="",this.m_container.appendChild(this.m_preActivedAddinsContainer)}static get s_isGlyphCacheDisabled(){return oi.s_glyphCacheFailedCount>1}async dispose(){o.a.sendTraceTag(555271248,l.a.msoulscat_Wac_PptSession,d.a.Info,"ViewController::dispose - Disposing rendererEnvironment and removing the elements from the dom tree"),oi.s_preloadedRendererEnvironment=void 0,this.m_container.removeChild(this.m_inScreenCoordsContainer),this.m_container.removeChild(this.m_accessibilityLiveRegionContainer),this.m_container.contains(this.m_crossSlideAudioContainer)&&this.m_container.removeChild(this.m_crossSlideAudioContainer),this.cleanUpAccessibilityContainer(),this.m_container.removeChild(this.m_slideLevelHtmlElementsParentContainer),this.m_clickTargetsReferenceDiv&&this.m_container.removeChild(this.m_clickTargetsReferenceDiv),this.m_notesPaneParagraphReaderContainer&&this.m_container.removeChild(this.m_notesPaneParagraphReaderContainer),this.m_preActivedAddinsContainer&&this.m_container.removeChild(this.m_preActivedAddinsContainer),this.rendererEnvironment.removeCanvas(this.m_container),ai={}}static ensureRendererEnvironment(){oi.s_preloadedRendererEnvironment||(oi.s_preloadedRendererEnvironment=S.Settings.readBooleanOrDefault("forceSvg",!1)?new Kt:new Jt)}async init(){this.rendererEnvironment.glContext&&await oi.preloadShaders(this.rendererEnvironment.glContext),this.isChromeFocusAccessibilityEnabled()&&this.m_container.addEventListener("focus",()=>this.updateAccessibilityTag())}isChromeFocusAccessibilityEnabled(){const e=navigator.userAgent.toLowerCase(),t=this.settings.uiHost&&this.settings.uiHost.toLowerCase().search("unified app")>=0;return!!(e.search("edg/")<0&&e.search("chrome/")>=0&&t)}slideIdsToMorphKey(e,t){if(e.sid!==t.sid||e.cid!==t.cid)return e.sid<t.sid||e.sid===t.sid&&e.cid<t.cid?`${JSON.stringify(e)}_${JSON.stringify(t)}`:`${JSON.stringify(t)}_${JSON.stringify(e)}`}async morphLoader(e,t){if(!t||!t.meta_prevSlideId||!t.meta_nextSlideId)return o.a.sendTraceTag(591984859,l.a.msoulscat_Wac_PptSession,d.a.Error,"morphLoader: options missing."),{resourceId:e,metadata:{errorName:"missingOptions"}};const i=(await this.viewDataManager.getSlideViewData(t.meta_nextSlideId)).resource;if(!i||!i.transData||!i.transData.morph)return o.a.sendTraceTag(591984860,l.a.msoulscat_Wac_PptSession,i?d.a.Info:d.a.Warning,`morphLoader: morph data missing. id:${e}, slideViewData exists:${!!i}, transdata exists:${i&&!!i.transData}`),{resourceId:e,metadata:{errorName:"missingSlideData"}};const r=this.getSlideViewElement(t.meta_prevSlideId),n=this.getSlideViewElement(t.meta_nextSlideId);return r&&n?{resourceId:e,resource:new M(this,i.transData.morph,i.transData.type,i.transData.dir,r,n),metadata:{}}:(o.a.sendTraceTag(591984861,l.a.msoulscat_Wac_PptSession,d.a.Error,`morphLoader: slidePrev exists:${!!r} slideNext exists:${!!n}.`),{resourceId:e,metadata:{errorName:"missingSlideViewElement"}})}async ensureSlideViewElement(e){o.a.sendTraceTag(595682653,l.a.msoulscat_Wac_PptSession,d.a.Info,"ViewController::ensureSlideViewElement - slideId:"+e.id.sid);const t={};t.getSlideViewData={start:oi.performanceNowTrimmed(),end:oi.performanceNowTrimmed()};const i=await this.viewDataManager.getSlideViewData(e.id);if(t.getSlideViewData.end=oi.performanceNowTrimmed(),!i.resource)return o.a.sendTraceTag(590104157,l.a.msoulscat_Wac_PptSession,d.a.Error,"ensureSlideViewElement: missing slideView data. id:"+e.id.sid),i.metadata.hasOwnProperty("errorName")&&(t.errorName=i.metadata.errorName),t;o.a.sendTraceTag(575193865,l.a.msoulscat_Wac_PptSession,d.a.Info,"ViewController::ensureSlideViewElement - slideSceneViews: "+JSON.stringify(this.m_slideSceneView.map(e=>e.slideId.sid)));let n=this.m_slideSceneView.find(t=>t.slideId.sid===e.id.sid);return n?(o.a.sendTraceTag(575193867,l.a.msoulscat_Wac_PptSession,d.a.Info,`ViewController::ensureSlideViewElement - slideSceneView already exists for slide ${e.id.sid} sceneExists:${!!n.scene}`),n.scene&&this.deleteScene(n),n.slideId=e.id,n.slideViewElement=new r.a(e,i.resource.slideSizePixels,this)):(n={slideId:e.id,slideViewElement:new r.a(e,i.resource.slideSizePixels,this),lastRenderedTimeMs:Number.NEGATIVE_INFINITY},this.m_slideSceneView.push(n),o.a.sendTraceTag(575193866,l.a.msoulscat_Wac_PptSession,d.a.Info,"ViewController::ensureSlideViewElement - Created new slideSceneView for slide "+e.id.sid)),this.viewDataManager.slideMetadataMap.set(e.id.sid,{slideId:e.id,isHidden:e.hidden}),o.a.sendTraceTag(575193868,l.a.msoulscat_Wac_PptSession,d.a.Info,"ViewController::ensureSlideViewElement - Current SlideMetadataMap:"+JSON.stringify(Array.from(this.viewDataManager.slideMetadataMap))),t}async ensureTextureLoaded(e,t){o.a.sendTraceTag(593835683,l.a.msoulscat_Wac_PptSession,d.a.Info,"ViewController::ensureTextureLoaded - slideId:"+e.sid);const i=this.m_slideSceneView.find(t=>t.slideId.sid===e.sid);if(!i)return o.a.sendTraceTag(593346771,l.a.msoulscat_Wac_PptSession,d.a.Warning,"ViewController::ensureTextureLoaded - missing scene view. slideId:"+e.sid),{errorName:"MissingSceneView"};if(i.slideViewElement.fImageTextureLoaded)return o.a.sendTraceTag(593831363,l.a.msoulscat_Wac_PptSession,d.a.Info,"ViewController::ensureTextureLoaded - Texture already loaded for slide:"+e.sid),{};const r={createTexture:{start:oi.performanceNowTrimmed(),end:oi.performanceNowTrimmed()}};try{i.slideViewElement.fImageTextureLoading=!0;const e=await this.createImageTextureMapData(i);r.createTexture.end=oi.performanceNowTrimmed();const n=await i.slideViewElement.ensure(t);return{...r,...e,...n}}catch(e){return o.a.sendTraceTag(576213770,l.a.msoulscat_Wac_PptSession,d.a.Error,"Unexpected exception in ensureTextureLoaded: "+e),{errorName:"TexturesNotLoaded"}}}getSlideViewElement(e){const t=this.m_slideSceneView.find(t=>t.slideId.sid===e.sid);return t?t.slideViewElement:null}onResize(){this.m_captionsRenderer&&this.m_captionsRenderer.onResize()}get getCaptionsRenderer(){return this.m_captionsRenderer||(this.m_captionsRenderer=new ri.a(this.m_container.id,this.m_inScreenCoordsContainer),this.m_captionsRenderer.setDefaultLang=oi.accessibilityLanguage),this.m_captionsRenderer}static performanceNowTrimmed(){return Math.round(performance.now())}static trimTo100th(e){return Math.round(1e3*e)/1e3}renderSlideAnimationFrameById(e,t){return this.renderSlideByIdExtended(e,!1,void 0,void 0,void 0,!1,!1,t)}renderSlideByIdCollectingPerfData(e,t,i){return this.renderSlideByIdExtended(e,!0,void 0,void 0,void 0,!0,!(!i||!i.isBoot)&&i.isBoot,t,i)}renderSlideById(e,t){return this.renderSlideByIdExtended(e,!1,void 0,void 0,void 0,!0,!1,t)}renderSlideByIdExtended(e,t,i,r,a,s,h,c,u){const f=this.rendererEnvironment.clientSize,m={CanvasWidth:f.x*window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale,CanvasHeight:f.y*window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale,DevicePixelRatio:window.devicePixelRatio,devicePixelsToRenderedPixelsScale:this.rendererEnvironment.devicePixelsToRenderedPixelsScale,render:{start:oi.performanceNowTrimmed(),end:oi.performanceNowTrimmed()}};s&&o.a.sendTraceTag(559992838,l.a.msoulscat_Wac_PptSession,d.a.Info,"renderSlideById slide:"+e.sid),h&&this.rendererEnvironment.glContext&&this.events.emit("renderingStageChanged","FlushingShaders");const p=oi.performanceNowTrimmed();m.shaders=oi.performanceNowTrimmed()-p,b.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&(m.additionalPerfMeta={});let g=oi.performanceNowTrimmed();const _=this.m_slideSceneView.find(t=>t.slideId.sid===e.sid);if(!_||!this.rendererEnvironment.isGLContextValid||!this.rendererEnvironment.isSBValid){const t=`ViewController::renderSlideById - Cannot render slide:${e.sid} SceneView:${!!_} WebGlContext:${this.rendererEnvironment.isGLContextValid} SBReady:${this.rendererEnvironment.isSBValid}`;return o.a.sendTraceTag(592328654,l.a.msoulscat_Wac_PptSession,d.a.Error,t),this.settings.stringifyError&&o.a.sendTraceTag(545404040,l.a.msoulscat_Wac_PptSession,d.a.Error,this.settings.stringifyError(new Error(t))),{...m,errorName:this.rendererEnvironment.isGLContextValid?this.rendererEnvironment.isSBValid?"FailedToRenderMissingSceneView":"FailedToRenderSBNotReady":"FailedToRenderContextLost"}}if(!_.slideViewElement.fImageTextureLoaded)return o.a.sendTraceTag(593830016,l.a.msoulscat_Wac_PptSession,d.a.Error,"ViewController::renderSlideById - tried to render a slide without loading textures:"+e.sid),{...m,errorName:"TexturesNotLoaded"};if(!_.scene){const e=S.Settings.readBooleanOrDefault("ignoreSceneBeingRendered",!1)?[_.slideId]:[];for(;this.m_currentSceneCount>=this.m_forwardSceneCount+this.m_backwardSceneCount+1&&this.deleteOldestScene(e););_.scene=this.createNewScene(),_.slideViewElement.fImageTextureLoading=!1,_.slideViewElement.addToScene(_.scene)}if(b.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&(m.additionalPerfMeta.sceneView=oi.performanceNowTrimmed()-g),m.fPrepared=_.slideViewElement.fPrepared,b.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&u&&u.id){this.m_renderStateSnapshot.preRendered=_.slideViewElement.fPrepared,this.m_renderStateSnapshot.prerenWindRange=u&&u.prefetchWindowRange,this.m_renderStateSnapshot.navSlideIndex=u&&u.slideIndex,this.m_renderStateSnapshot.id=u&&u.id,this.m_renderStateSnapshot.step=u&&u.step,this.m_renderStateSnapshot.navType=u&&u.navType,this.m_renderStateSnapshot.navInitTime=u&&u.navInitTimestamp;const e=oi.performanceNowTrimmed();this.logSlideRenderSnapshot(),o.a.sendTraceTag(507593430,l.a.msoulscat_Wac_PptSlideshow,d.a.Warning,"ViewController::renderSlideByIdExtended: Render Snapshot LogTime: "+(oi.performanceNowTrimmed()-e))}const v=_.slideViewElement.slideSizePixels;this.showUnderlaysAndOverlays(JSON.stringify(e)),this.showHideCrossSlideAudios(JSON.stringify(e)),_.slideViewElement.updateShapeViewElements(),_.lastRenderedTimeMs=Date.now();const y=f.x/v.x,w=f.y/v.y,M=Math.min(y,w),C=oi.performanceNowTrimmed();this.applyResizeTransform(this.m_slideLevelHtmlElementsParentContainer,M,v,!0,c,!0),b.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&(m.additionalPerfMeta.resizeTransformation=oi.performanceNowTrimmed()-C);const I=oi.performanceNowTrimmed();Object(T.g)(f,v,this.slideSizeEmus,this.stringifyError),b.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&(m.additionalPerfMeta.setShapeBuilderGlobals=oi.performanceNowTrimmed()-I);const P=S.Settings.readNumberOrDefault("bootRenderTimeoutMs",-1);if(this.rendererEnvironment.glContext&&h&&!_.slideViewElement.fPrepared&&P>0){this.events.emit("renderingStageChanged","PreparingSBItems");const e=_.slideViewElement.tryPrepareAllAtOnce(P);if(o.a.sendTraceTag(539767630,l.a.msoulscat_Wac_PptSession,e?d.a.Info:d.a.Error,JSON.stringify({prepareSucceeded:e})),!e&&S.Settings.readBooleanOrDefault("renderTimeoutReturnEarly",!1))return m.errorName="TryPrepareTimeout",m}h&&this.events.emit("renderingStageChanged","RenderingSlide"),(h||S.Settings.readBooleanOrDefault("hackEnableVerboseRenderLogging",!1))&&this.rendererEnvironment.enableVerboseRenderLogging(!0);const E=oi.performanceNowTrimmed();let x=this.rendererEnvironment.calculateRenderTransform(v);if(b.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&(m.additionalPerfMeta.renderTransform=oi.performanceNowTrimmed()-E),S.Settings.readBooleanOrDefault("enableOpticalZoom",!1)){const e=c.zoomLevel*x.scale.x,t=new n.b(c.canvasCenterSlidePointPercent.x*e*v.x,c.canvasCenterSlidePointPercent.y*e*v.y),i=oi.performanceNowTrimmed();x=this.rendererEnvironment.calculateRenderTransformWithZoom(new n.b(v.x,v.y),e,t),b.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&(m.additionalPerfMeta.renderTransformZoom=oi.performanceNowTrimmed()-i)}b.ChangeGate.isChangeGateEnabled("SVM.ResetDirtyRectOnOpticalZoomChange")&&(!this.m_lastRenderedOpticalZoomState||this.m_lastRenderedOpticalZoomState.zoomLevel===c.zoomLevel&&this.m_lastRenderedOpticalZoomState.canvasCenterSlidePointPercent.x===c.canvasCenterSlidePointPercent.x&&this.m_lastRenderedOpticalZoomState.canvasCenterSlidePointPercent.y===c.canvasCenterSlidePointPercent.y||(this.m_lastRenderRectMap=void 0),this.m_lastRenderedOpticalZoomState=c),this.m_currentRenderedSlideId=e;const A={filter:r,target:i,transform:x};T.b.s_isRenderingAnimationFrame=!s;const k=oi.performanceNowTrimmed();if(S.Settings.readBooleanOrDefault("enableDirtyRectTracking",!1)&&this.rendererEnvironment.glContext){const e={enableDirtyRect:!0,previousRenderRectMap:this.m_lastRenderRectMap};this.rendererEnvironment.renderer.render(_.scene,a,A,e),this.m_lastRenderRectMap=this.rendererEnvironment.renderer.getLastRenderRectMap()}else this.rendererEnvironment.renderer.render(_.scene,a,A);b.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&(m.additionalPerfMeta.shapeBuilderRender=oi.performanceNowTrimmed()-k),T.b.s_isRenderingAnimationFrame=!1,ai.lastRenderedScene=_.scene,this.rendererEnvironment.enableVerboseRenderLogging(!1);const R=this.viewDataManager.slideIdOrder.findIndex(t=>t.sid===e.sid&&t.cid===e.cid);let O=!1;this.isChromeFocusAccessibilityEnabled()&&(this.m_container.contains(document.activeElement)||(O=!0)),O||_.slideViewElement.updateAccessibilityTag(R,e,this.m_slideLevelHtmlElementsParentContainer);const L=oi.getElementFromCollection(this.m_inScreenCoordsContainer.children,oi.BlankSlideDivId);L&&this.m_inScreenCoordsContainer.removeChild(L),m.render.end=oi.performanceNowTrimmed();const F=S.Settings.readBooleanOrDefault("enableTriangleTest",!1);if(s||this.m_fCheckGlyphCacheOnNextRender){const t=this.m_fCheckGlyphCacheOnNextRender;this.m_fCheckGlyphCacheOnNextRender=!1;let i=oi.performanceNowTrimmed();this.settings.flights&&this.settings.flights.verifyGlyphAsynchronously?b.ChangeGate.isChangeGateEnabled("EnableAsyncVerifyGlyphInvocation")&&setTimeout(()=>{i=oi.performanceNowTrimmed(),this.rendererEnvironment.verifyGlyphCacheIntegrityAndTryRecover()?F&&setTimeout(()=>{this.runRenderFidelityTest(F,!1,t,e)},0):(m.render.end=oi.performanceNowTrimmed(),o.a.sendTraceTag(553788171,l.a.msoulscat_Wac_PptSession,d.a.Error,"GlyphCacheIntegrity failed"),this.runRenderFidelityTest(F,!0,t,e),oi.s_glyphCacheFailedCount+=1,this.m_fCheckGlyphCacheOnNextRender=!0,this.events.emit("glyphCacheFailed")),o.a.sendTraceTag(507605075,l.a.msoulscat_Wac_PptSession,d.a.Warning,"ViewController::renderSlideByIdExtended: verifyGlyphs: "+(oi.performanceNowTrimmed()-i))},0):(this.rendererEnvironment.verifyGlyphCacheIntegrityAndTryRecover()?F&&setTimeout(()=>{this.runRenderFidelityTest(F,!1,t,e)},0):(m.render.end=oi.performanceNowTrimmed(),o.a.sendTraceTag(553788171,l.a.msoulscat_Wac_PptSession,d.a.Error,"GlyphCacheIntegrity failed"),this.runRenderFidelityTest(F,!0,t,e),oi.s_glyphCacheFailedCount+=1,this.m_fCheckGlyphCacheOnNextRender=!0,this.events.emit("glyphCacheFailed")),m.verifyGlyphs=oi.performanceNowTrimmed()-i)}if(t){m.slideWidth=v.x,m.slideHeight=v.y;const t=this.rendererEnvironment.getPerformanceSummary(),i=t&&t.perfInfoCurrentFrame;i&&(S.Settings.readBooleanOrDefault("addSbToNavLogs",!0)?m.sbMs={total:i.totalCostMs,dfSp:i.distanceFieldForShapeCostMs,dfTxt:i.distanceFieldForTextCostMs,dfGph:i.distanceFieldForGlyphTableCostMs,rnd:i.shapeRenderCostMs,tp:i.drawTapeCostMs,spCnt:i.shapeLayerCount,spCntTxt:i.shapeLayerCountText,pCntDf:i.pixelCountDistanceField,pCntSp:i.pixelCountShapeRender,spr:i.cacheToSpriteCostMs,tx:oi.trimTo100th(i.fadeTextureCostMs+i.patternTextureCostMs+i.gradientTextureCostMs+i.pathGradientTextureCostMs),res:oi.trimTo100th(i.glResetCostMs+i.glRestoreCostMs)}:m.SBTotalCost=i.totalCostMs);const r={slideId:e.sid,isBoot:h,isBadGPU:oi.s_isBadGpu,SBCurrentFrameSummary:i,...m};o.a.sendTraceTag(590160843,l.a.msoulscat_Wac_PptSession,d.a.Info,JSON.stringify(r)),o.a.sendTraceTag(577885456,l.a.msoulscat_Wac_PptSession,d.a.Warning,JSON.stringify(this.getGpuMemory()));try{Object.fromEntries&&o.a.sendTraceTag(523342101,l.a.msoulscat_Wac_PptSession,d.a.Warning,"ViewController::renderSlideByIdExtended leaks: "+JSON.stringify(Object.fromEntries(this.checkForLeaksByScenario())))}catch(e){let t=e;e instanceof Error&&this.stringifyError&&(t=this.stringifyError(e)),o.a.sendTraceTag(522806804,l.a.msoulscat_Wac_PptSlideshow,d.a.Warning,"ViewController::renderSlideByIdExtended Exception calling fromEntries:"+t)}return m}}runRenderFidelityTest(e,t,i,r){const n=!!this.rendererEnvironment.isGLContextValid,a=e?this.rendererEnvironment.webGLRenderer&&this.rendererEnvironment.webGLRenderer.testRenderFidelity():void 0,s=t||i||a&&!a.fSucceeded,h=this.rendererEnvironment.webGLRenderer&&s?this.rendererEnvironment.webGLRenderer.getWebGLState():void 0;o.a.sendTraceTag(509387791,l.a.msoulscat_Wac_PptSession,d.a.Info,JSON.stringify({glyphCacheFailed:t,isAfterGlyphCacheRecovery:i,sid:r.sid,glValid:n,enableTriangleTest:e,results:a,webGLState:h}))}getRelativeSlideIndex(e,t){return e-t}logSlideRenderSnapshot(){let e=(({slideRendMap:e,...t})=>t)(this.m_renderStateSnapshot);e.relSlideRendMap={};const t=this.m_renderStateSnapshot.navSlideIndex;if(t)for(const i in this.m_renderStateSnapshot.slideRendMap)e.relSlideRendMap[this.getRelativeSlideIndex(parseInt(i),t)]=this.m_renderStateSnapshot.slideRendMap[i];o.a.sendTraceTag(507593429,l.a.msoulscat_Wac_PptSession,d.a.Warning,JSON.stringify(e))}calculateCanvasCenterSlidePointPercentAfterZoom(e,t,i,r){const a=this.m_slideSceneView.find(e=>e.slideId.sid===i.sid);if(!a)return o.a.sendTraceTag(521491842,l.a.msoulscat_Wac_PptSession,d.a.Warning,"ViewController::calculateCanvasCenterSlidePointPercentAfterZoom - missing scene view."),null;const s=new n.b(a.slideViewElement.slideSizePixels.x,a.slideViewElement.slideSizePixels.y),h=this.rendererEnvironment.clientSize,c=new n.b(r.canvasCenterSlidePointPercent.x,r.canvasCenterSlidePointPercent.y),u=this.rendererEnvironment.calculateRenderTransform(s).scale.x,f=r.zoomLevel*u,m=c.scale(f).multiply(s),p=t*u,g=Object(Xt.d)(e,p,m,s,h,f,S.Settings.readBooleanOrDefault("forceSvg",!1)?1:window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale);return Object(Xt.b)(h.scale(.5),g.translation,s,p,S.Settings.readBooleanOrDefault("forceSvg",!1)?1:window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale).divide(s.scale(p))}calculateCanvasCenterPointPercentAfterPan(e,t,i){const r=this.m_slideSceneView.find(e=>e.slideId.sid===t.sid);if(!r)return o.a.sendTraceTag(521491843,l.a.msoulscat_Wac_PptSession,d.a.Warning,"ViewController::calculateCanvasCenterPointPercentAfterPan - missing scene view."),null;const a=new n.b(r.slideViewElement.slideSizePixels.x,r.slideViewElement.slideSizePixels.y),s=this.rendererEnvironment.clientSize,h=new n.b(i.canvasCenterSlidePointPercent.x,i.canvasCenterSlidePointPercent.y),c=this.rendererEnvironment.calculateRenderTransform(a).scale.x,u=i.zoomLevel*c,f=h.scale(u).multiply(a),m=Object(Xt.a)(new n.b(e.x,e.y),f,a,s,u,S.Settings.readBooleanOrDefault("forceSvg",!1)?1:window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale);return Object(Xt.b)(s.scale(.5),m.translation,a,u,S.Settings.readBooleanOrDefault("forceSvg",!1)?1:window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale).divide(a.scale(u))}getGpuMemory(){const e=performance.now(),t=this.m_slideSceneView.filter(e=>e.scene).map(e=>e.scene),i=this.m_morphCache.getAllLoadResultsInCache().filter(e=>e.resource).map(e=>e.resource.morph),r=this.rendererEnvironment.generateTextureMemoryReport(t,i);let n=0;this.viewDataManager.imageDataMap.forEach((e,t)=>{n+=e.size.x*e.size.y*4});const a=(r?r.totalTargetExpected:0)+n+this.viewDataManager.memoryStats.cameoTextures+this.viewDataManager.memoryStats.gifTextures+this.viewDataManager.memoryStats.transitionTextures+this.viewDataManager.memoryStats.transitionsMemoryReport.buffers.count+this.viewDataManager.memoryStats.transitionsMemoryReport.textures.count+this.viewDataManager.memoryStats.videoTextures,s=this.rendererEnvironment.webGLRenderer?this.rendererEnvironment.webGLRenderer.fixedMemoryLeakAmounts:void 0;let o=0;for(const[e,t]of this.checkForLeaksByScenario())o+=t;return{gpuMemorySB:r,timeSpentCollecting:performance.now()-e,memoryStats:this.viewDataManager.memoryStats,images:n,total:a,leaksPrevented:s,leaks:o}}updateAccessibilityTag(){if(!this.m_currentRenderedSlideId||!this.m_slideSceneView)return void o.a.sendTraceTag(575955970,l.a.msoulscat_Wac_PptSession,d.a.Error,"ViewController::updateAccessibilityTag sceneView or slideId is null - slideId:"+this.m_currentRenderedSlideId);const e=this.m_currentRenderedSlideId,t=this.m_slideSceneView.find(t=>t.slideId.sid===e.sid);if(!t)return void o.a.sendTraceTag(575955971,l.a.msoulscat_Wac_PptSession,d.a.Error,"ViewController::updateAccessibilityTag scene view is null - slideId:"+e.sid);const i=this.viewDataManager.slideIdOrder.findIndex(t=>t.sid===e.sid&&t.cid===e.cid);t.slideViewElement.updateAccessibilityTag(i,e,this.m_slideLevelHtmlElementsParentContainer)}updateAccessibilityContainersLanguage(e){""===e?(this.m_accessibilityLiveRegionContainer.removeAttribute("lang"),this.m_slideLevelHtmlElementsParentContainer.removeAttribute("lang")):this.m_slideLevelHtmlElementsParentContainer.lang=e}updateAccessibilityLanguage(e){e!==oi.accessibilityLanguage&&(oi.accessibilityLanguage=e,this.cleanUpAccessibilityContainer(),this.updateAccessibilityContainersLanguage(e),this.m_captionsRenderer&&(this.m_captionsRenderer.setDefaultLang=e))}preRenderSlideById(e,t){o.a.sendTraceTag(595634143,l.a.msoulscat_Wac_PptSession,d.a.Info,"ViewController::preRenderSlideById - slideId:"+e.sid);const i=this.m_slideSceneView.find(t=>t.slideId.sid===e.sid);if(!i||!this.rendererEnvironment.isGLContextValid)return;if(i.scene)return void(i.slideViewElement.fImageTextureLoading=!1);for(;this.m_currentSceneCount>=this.m_forwardSceneCount+this.m_backwardSceneCount+1&&this.deleteOldestScene(););const r=()=>{Object(T.g)(this.rendererEnvironment.clientSize,i.slideViewElement.slideSizePixels,this.slideSizeEmus,this.stringifyError)};i.scene=this.createNewScene(),i.slideViewElement.fImageTextureLoading=!1,i.slideViewElement.addToScene(i.scene);const n=this.rendererEnvironment.glContext;if(S.Settings.readBooleanOrDefault("hackSkipPrerender",!1))return;let a,s;if(b.ChangeGate.isChangeGateEnabled("logRenderSnapshot")){s=this.viewDataManager.getSlideIndex(e);const t=this.m_renderStateSnapshot.slideRendMap,i=t[s]||(t[s]={});i.sTime=Date.now(),i.state=ii.Start,i.idx=s}this.tryPrepareUntilDoneAsync(()=>{if(!i.scene&&b.ChangeGate.isChangeGateEnabled("SSC.SkipPreparingEmptyScene"))return!0;if(r(),!b.ChangeGate.isChangeGateEnabled("logRenderSnapshot"))return i.slideViewElement.tryPrepare();s=this.viewDataManager.getSlideIndex(e);const t=this.m_renderStateSnapshot.slideRendMap,n=t[s]||(t[s]={});return a=i.slideViewElement.tryPrepare(),n.eTime=Date.now(),n.state=a?ii.Completed:ii.Failed,a},S.Settings.readNumberOrDefault("maxRetriesPreparingSlide",1e4)).then(async()=>{if(!t||!this.settings.morphEnabled||!n||n.isContextLost())return;const i=this.m_slideSceneView.find(e=>e.slideId.sid===t.sid),a=this.slideIdsToMorphKey(t,e);if(!i||!i.scene||!a)return;const s=await this.m_morphCache.load(a,{meta_prevSlideId:t,meta_nextSlideId:e});if(o.a.sendTraceTag(522806805,l.a.msoulscat_Wac_PptSession,d.a.Info,JSON.stringify({morphExists:!(!s||!s.resource),morphResourceId:a})),s&&s.resource){const t=s.resource;this.tryPrepareUntilDoneAsync(()=>(r(),t.tryPrepareMorph(5)),S.Settings.readNumberOrDefault("maxRetriesPreparingSlide",1e4)).then(()=>{o.a.sendTraceTag(591970573,l.a.msoulscat_Wac_PptSession,d.a.Info,"Done preparing morph - slideId:"+e.sid)})}})}sendFrameToCameo(e,t){this.m_cameoTextureManager.processFrameForCameo(e,t)}clearCameo(){this.m_cameoTextureManager.releaseTexture()}setCameoVideoElement(e){this.m_cameoTextureManager.setVideoElement(e)}updateCameoTextureFromVideoElement(){this.m_cameoTextureManager.updateTextureFromVideoElement()}cleanUpAccessibilityContainer(){for(;this.m_slideLevelHtmlElementsParentContainer&&this.m_slideLevelHtmlElementsParentContainer.firstChild;)this.m_slideLevelHtmlElementsParentContainer.removeChild(this.m_slideLevelHtmlElementsParentContainer.firstChild);r.a.s_lastAccessibilityTagHash=""}async tryPrepareUntilDoneAsync(e,t){let i=t;for(;;){if(!this.rendererEnvironment.isGLContextValid||i<=0)return;if(this.isAnimating||this.isTransitioning||!this.rendererEnvironment.isSBValid)await Object(ei.waitMsAsync)(10);else{if(e())return;i-=1,await Object(ei.waitMsAsync)(10)}}}setMaxSceneCount(e,t){this.m_forwardSceneCount!==e&&(this.m_forwardSceneCount=e),this.m_backwardSceneCount!==t&&(this.m_backwardSceneCount=t)}deleteOldestScene(e){let t=-1,i=Number.POSITIVE_INFINITY,r=-1,n=Number.POSITIVE_INFINITY;const a=[];for(let s=0;s<this.m_slideSceneView.length;s+=1)this.m_currentRenderedSlideId&&this.m_currentRenderedSlideId.sid===this.m_slideSceneView[s].slideId.sid||!this.m_slideSceneView[s].scene||e&&e.find(e=>e.sid===this.m_slideSceneView[s].slideId.sid)||(a.push({index:s,sid:this.m_slideSceneView[s].slideId.sid,lastRenderedTimeMs:this.m_slideSceneView[s].lastRenderedTimeMs}),this.m_slideSceneView[s].lastRenderedTimeMs<i&&(t=s,i=this.m_slideSceneView[s].lastRenderedTimeMs),!this.isAdjacentSlide(this.m_slideSceneView[s].slideId)&&this.m_slideSceneView[s].lastRenderedTimeMs<n&&(r=s,n=this.m_slideSceneView[s].lastRenderedTimeMs));const s=!S.Settings.readBooleanOrDefault("disallowDeletingOldAdjacentScenes",!1),h=-1===r&&s?t:r;return o.a.sendTraceTag(520681370,l.a.msoulscat_Wac_PptSession,d.a.Info,"deleteOldestScene "+JSON.stringify({allowDeletingOldAdjacentScenes:s,slideToDeleteIndex:h,sceneList:a,scenesToIgnore:e})),-1!==h&&(this.deleteScene(this.m_slideSceneView[h]),!0)}isAdjacentSlide(e){if(!this.m_currentRenderedSlideId)return!1;if(S.Settings.readBooleanOrDefault("fixIsAdjacentSlide",!1)){const t=this.viewDataManager.getVisibleSlideIndexDifference(this.m_currentRenderedSlideId,e);return void 0!==t&&Math.abs(t)<=(t>0?this.m_forwardSceneCount:this.m_backwardSceneCount)}const t=this.viewDataManager.getVisibleSlideIndex(this.m_currentRenderedSlideId),i=this.viewDataManager.getVisibleSlideIndex(e);return-1!==t&&-1!==i&&t!==i&&Math.abs(t-i)<=(i>t?this.m_forwardSceneCount:this.m_backwardSceneCount)}deleteScene(e){if(!e.scene)return void o.a.sendTraceTag(595621852,l.a.msoulscat_Wac_PptSession,d.a.Warning,"ViewController::deleteScene - slideSceneView doesn't contain a scene. SlideSID:"+e.slideId.sid);if(b.ChangeGate.isChangeGateEnabled("logRenderSnapshot")){let t=this.viewDataManager.getSlideIndex(e.slideId);this.m_renderStateSnapshot.slideRendMap[t]&&delete this.m_renderStateSnapshot.slideRendMap[t]}const t=new Set,i=this.m_slideSceneView.filter(e=>e.scene||e.slideViewElement.fImageTextureLoading).map(e=>e.slideId.sid),r=this.viewDataManager.imageDataMap.size;for(const[r,n]of this.viewDataManager.imageDataMap)if(S.Settings.readBooleanOrDefault("deleteMultiSlideTextures",!1)){if(!n.loadedSlideIDs.some(e=>i.some(t=>t===e.sid))){this.rendererEnvironment.releaseImageData(n),this.viewDataManager.imageDataMap.delete(r),t.add(r);for(const e of this.m_slideSceneView)n.loadedSlideIDs.some(t=>e.slideId.sid===t.sid)&&(e.slideViewElement.fImageTextureLoaded=!1)}}else 1===n.loadedSlideIDs.length&&n.loadedSlideIDs.find(t=>t.sid===e.slideId.sid)&&(this.rendererEnvironment.releaseImageData(n),this.viewDataManager.imageDataMap.delete(r),t.add(r));for(const e of t)this.viewDataManager.onExternalTextureReleased(e);const n=this.viewDataManager.imageDataMap.size;if(o.a.sendTraceTag(576247952,l.a.msoulscat_Wac_PptSession,d.a.Info,`ViewController::deleteScene - slideSceneViews: ${JSON.stringify(this.m_slideSceneView.map(e=>e.slideId.sid))} SlideSID:${e.slideId.sid} before: ${r} after:${n}`),o.a.sendTraceTag(575758488,l.a.msoulscat_Wac_PptSession,d.a.Info,`ViewController::deleteScene - SlideSID:${e.slideId.sid} keys deleted: [${[...t].join(",")}]`),e.slideViewElement.fImageTextureLoaded=!1,e.slideViewElement.removeFromScene(e.scene),e.scene.releaseGeneratedResources(),this.settings.morphEnabled){const t=this.m_morphCache.getAllLoadResultsInCache();for(const i of t)i.resourceId.indexOf(JSON.stringify(e.slideId))>0&&(i.resource&&(i.resource.dispose(),o.a.sendTraceTag(577885457,l.a.msoulscat_Wac_PptSession,d.a.Warning,`ViewController::deleteScene - cleared morph cache for resourceId:${i.resourceId} SlideSID:${e.slideId.sid}`)),this.m_morphCache.remove(i.resourceId))}e.slideViewElement.cleanUp(),e.slideViewElement.fPrepared=!1,e.scene=void 0,this.m_currentSceneCount-=1}calculateCanvasSize(e){const t=this.getBounds.getBoundingClientRectFromContainer(),i=t.width/(t.height?t.height:t.width);let r,a;return e.x/e.y<i?(a=Math.round(t.height),r=Math.round(a*e.x/e.y)):(r=Math.round(t.width),a=Math.round(r*e.y/e.x)),new n.b(r,a)}resizeViewContainer(e,t,i){this.m_container.style.display="flex",this.m_container.style.justifyContent="center",this.m_container.style.alignItems="center";const r=this.calculateCanvasSize(t),n=i&&i.canvasScale?i.canvasScale:1;this.rendererEnvironment.setCanvasSize(r,n);const a=this.rendererEnvironment.canvas,s=this.rendererEnvironment.clientSize,o=s.x/t.x,l=s.y/t.y,d=Math.min(o,l);this.applyResizeTransform(this.m_slideLevelHtmlElementsParentContainer,d,t,!0,e,!0),S.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&(this.m_slideLevelHtmlElementsParentContainer.style.width=a.style.width,this.m_slideLevelHtmlElementsParentContainer.style.height=a.style.height),this.m_clickTargetsReferenceDiv&&this.applyResizeTransform(this.m_clickTargetsReferenceDiv,d,t,!1,e),this.m_inScreenCoordsContainer.style.width=a.style.width,this.m_inScreenCoordsContainer.style.height=a.style.height}applyResizeTransform(e,t,i,r,a,s){const o=(e,r)=>{if(S.Settings.readBooleanOrDefault("resizeMediaOnSlideScaling",!1)&&e.id.indexOf(oi.SlideLevelHtmlElementsDivId)>-1)for(const e of this.m_slideSceneView)e.slideViewElement.onSlideScaled(t);if(S.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&e!==this.m_clickTargetsReferenceDiv){const r=S.Settings.readBooleanOrDefault("forceSvg",!1)?1:window.devicePixelRatio*this.rendererEnvironment.devicePixelsToRenderedPixelsScale,s=this.rendererEnvironment.clientSize.scale(.5),o=new n.b(i.x,i.y),l=new n.b(a.canvasCenterSlidePointPercent.x,a.canvasCenterSlidePointPercent.y),d=s.scale(1-a.zoomLevel),h=this.rendererEnvironment.calculateRenderTransform(o).scale.x*a.zoomLevel,c=o.scale(h),u=l.multiply(c),f=Object(Xt.c)(s,u,o,h,r).scale(1/r).subtract(s).add(d),m=t*a.zoomLevel;e.style.top="0",e.style.left="0",e.style.transform=`translateX(${f.x}px) translateY(${f.y}px) scale(${m},${m})`}else e.style.transform=`scale(${t},${t})`,e.style.top=this.rendererEnvironment.canvas.offsetTop+(this.rendererEnvironment.canvas.offsetWidth-this.rendererEnvironment.clientSize.x)/2+"px",e.style.left=this.rendererEnvironment.canvas.offsetLeft+(this.rendererEnvironment.canvas.offsetHeight-this.rendererEnvironment.clientSize.y)/2+"px";e.style.transformOrigin="top left",r||(e.style.width=i.x+"px",e.style.height=i.y+"px")};if(r){const t=e.childNodes;for(let e=0;e<t.length;e+=1){const i=t[e];s&&i.id.search(oi.ShapeAccessibilityElementId)>=0||o(i,!0)}}else o(e,!1)}static createRenderBackgroundOrForegroundFilter(e){return t=>void 0===Object(T.c)(t).isBackground||Object(T.c)(t).isBackground===e}async createTransition(e,t,i,r){let n=0,a=0;b.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(n=oi.performanceNowTrimmed());const s=await this.viewDataManager.getSlideViewData(i?e:t);b.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(a=oi.performanceNowTrimmed()-n),this.m_transitionController&&this.finishTransition();let o={fSuccess:!1},l=0,d=0;b.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(l=oi.performanceNowTrimmed());const h=s.resource;return h&&h.transData&&S.Settings.readBooleanOrDefault("hackTransitionsEnabled",!0)?o=await this.rendererEnvironment.createTransition(h.transData,e,t,i,h.slideSizePixels.x/h.slideSizePixels.y,!!this.settings.morphEnabled,r):o.metadata=s.metadata,b.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&(d=oi.performanceNowTrimmed()-l),this.hideUnderlaysAndOverlays(),o.metadata||(o.metadata={}),o.metadata.getSlideViewPerfInTransitionMS=a,o.metadata.rendererEnvironment||(o.metadata.rendererEnvironment={}),o.metadata.rendererEnvironment.TotalMS=d,o}renderBlankSlide(e,t,i){this.hideUnderlaysAndOverlays();const r=this.m_inScreenCoordsContainer,n=oi.getElementFromCollection(r.children,oi.BlankSlideDivId);n&&r.removeChild(n);const a=document.createElement("div");if(a.id=oi.BlankSlideDivId,a.style.background=e,a.style.width="100%",a.style.height="100%",a.style.position="absolute",a.style.pointerEvents="none",a.style.zIndex="3",t&&i){const e=document.createElement("div");e.style.textAlign="center",e.style.fontSize="120%",e.setAttribute("aria-live","assertive"),e.textContent=t,e.style.color=i,e.style.fontFamily="Segoe UI, sans-serif",a.appendChild(e)}return r.appendChild(a),a}static async preloadShaders(e){oi.ensureRendererEnvironment(),oi.s_preloadedRendererEnvironment?await oi.s_preloadedRendererEnvironment.preloadShaders(e):o.a.sendTraceTag(555246685,l.a.msoulscat_Wac_PptSession,d.a.Error,"ViewController::preloadShaders - s_preloadedRendererEnvironment is null")}finishTransition(){this.m_transitionController&&(this.m_transitionController.clock.stop(),this.m_transitionController.onDispose(),this.m_transitionController=null)}getTransitionController(){return this.m_transitionController}getSlideDimensions(){if(this.rendererEnvironment.canvas)return new n.b(parseInt(this.rendererEnvironment.canvas.style.width,10),parseInt(this.rendererEnvironment.canvas.style.height,10))}getSlideViewBounds(){const e=this.rendererEnvironment.canvas;if(!e)return;const t=this.getBounds.getBoundingClientRectFromCanvas(),i={top:t.top,bottom:t.bottom,left:t.left,right:t.right};return i.top+=e.clientTop,i.bottom-=e.clientTop,i.left+=e.clientLeft,i.right-=e.clientLeft,i}hideUnderlaysAndOverlays(){Array.from(this.m_slideLevelHtmlElementsParentContainer.childNodes).forEach(e=>{-1===e.id.search(oi.CrossSlideShapeId)&&this.m_slideLevelHtmlElementsParentContainer.removeChild(e)})}showHideCrossSlideAudios(e){this.m_slideLevelHtmlElementsParentContainer.childNodes.forEach(e=>{e&&e.id.search(oi.CrossSlideShapeId)>0&&e.firstChild&&(e.firstChild.style.visibility="hidden")});const t=this.crossSlideMediaMap[e];t&&t.forEach(e=>{const t=document.getElementById(e.mediaElement.id);t&&(t.style.visibility="",e.mediaProps.hideWhenStopped&&(t.style.visibility="hidden"))})}stopCrossSlideAudio(){this.m_slideLevelHtmlElementsParentContainer.childNodes.forEach(e=>{const t=e;t&&t.id.search(oi.CrossSlideShapeId)>0&&(t.currentTime=0,t.pause?t.pause():o.a.sendTraceTag(539874464,l.a.msoulscat_Wac_PptSession,d.a.Info,"Wrong HTML Audio tag "+t.tagName))})}showUnderlaysAndOverlays(e){Array.from(this.m_slideLevelHtmlElementsParentContainer.childNodes).forEach(t=>{const i=t;if(!(i.id.search(oi.CrossSlideShapeId)>0))try{let r=i.id.split(oi.SlideLevelHtmlElementsDivId+"-");const n=r&&r[1]?JSON.parse(r[1]):null;if(n&&n.slideId&&n.slideId.sid!==JSON.parse(e).sid&&this.m_slideLevelHtmlElementsParentContainer.removeChild(t),r=i.id.split(oi.ShapeAccessibilityElementId+"-"),r&&r[1]){const i=r[1].split("sid:"),n=i&&i[1]?i[1].split("-"):null;n&&n[0]&&parseInt(n[0],10)!==JSON.parse(e).sid&&this.m_slideLevelHtmlElementsParentContainer.removeChild(t)}}catch(e){o.a.sendTraceTag(558155866,l.a.msoulscat_Wac_PptSession,d.a.Error,"Unexpected exception in showUnderlaysAndOverlays: "+e)}})}createNewScene(){const e=new s.b;return this.m_currentSceneCount+=1,e}async createImageTextureMapData(e){return S.Settings.readBooleanOrDefault("asyncSafeCreateTextures",!0)?await this.m_createImageTextureMapDataThrottler.callAsync(e):await this.createImageTextureMapDataImpl(e)}async createImageTextureMapDataImpl(e){const t={};o.a.sendTraceTag(575758489,l.a.msoulscat_Wac_PptSession,d.a.Info,"ViewController::createImageTextureMapData - beginning"),b.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(t.textureMetadata={loadTexture:0,slidedata:0});let i=0;b.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(i=oi.performanceNowTrimmed());const r=await this.viewDataManager.getSlideViewData(e.slideId);if(b.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(t.textureMetadata.slidedata=oi.performanceNowTrimmed()-i),r.resource&&r.resource.resCat){const i=r.resource;let n=0;for(const e of i.resCat)if(this.viewDataManager.imageDataMap.has(e.id)){const t=this.viewDataManager.imageDataMap.get(e.id);t.loadedSlideIDs.find(e=>e.sid===i.slideId.sid)||t.loadedSlideIDs.push(i.slideId),o.a.sendTraceTag(575758491,l.a.msoulscat_Wac_PptSession,d.a.Info,"ViewController::createImageTextureMapData - already loaded "+e.id)}else{o.a.sendTraceTag(575758490,l.a.msoulscat_Wac_PptSession,d.a.Info,"ViewController::createImageTextureMapData - loading "+e.id),b.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(n=oi.performanceNowTrimmed());const r=await this.loadImageTexture(e,i.slideId,i.slideSizePixels);b.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(t.textureMetadata.loadTexture+=oi.performanceNowTrimmed()-n),r.hasOwnProperty("errorName")&&(t.hasOwnProperty("invalidImageIds")||(t.invalidImageIds=[]),t.invalidImageIds.push(e.id))}o.a.sendTraceTag(576247953,l.a.msoulscat_Wac_PptSession,d.a.Info,"ViewController::createImageTextureMapData - setting fImageTextureLoaded to true for SlideSID:"+e.slideId.sid),e.slideViewElement.fImageTextureLoaded=!0}return t}async loadImageTexture(e,t,i){return e.url&&this.rendererEnvironment.isGLContextValid?new Promise(r=>{const n=new Image;if(n.ID=e.id,n.onload=()=>{try{const a=this.getBounds.getBoundingClientRectFromContainer(),s=this.rendererEnvironment.saveImageData(n,e,t,i,{x:a.width,y:a.height});return r(s),s}catch(e){return o.a.sendTraceTag(545927755,l.a.msoulscat_Wac_PptSession,d.a.Error,`Exception in image.onload for id: ${n.ID} e: ${e}`),r({errorName:"CannotLoadImageTexture"}),{errorName:"CannotLoadImageTexture"}}},n.onerror=()=>(o.a.sendTraceTag(595646167,l.a.msoulscat_Wac_PptSession,d.a.Error,"Image Failed to load - "+n.ID),r({errorName:"CannotLoadImageTexture"}),{errorName:"CannotLoadImageTexture"}),n.name=e.name,e.mimeType.startsWith("image/svg+xml")&&0===e.urlType){const t=e.url.indexOf(",");if(b.ChangeGate.isChangeGateEnabled("FireFoxSVGFileRenderingFix")){const i=e.url.substring(0,t+1),r=e.url.substring(t+1),a=(new DOMParser).parseFromString(r,"image/svg+xml");this.ensureSVGWidthHeight(a.documentElement),n.src=i+encodeURIComponent(a.documentElement.outerHTML)}else n.src=e.url.substring(0,t+1)+encodeURIComponent(e.url.substring(t+1))}else n.src=e.url;return{}}):(o.a.sendTraceTag(561639896,l.a.msoulscat_Wac_PptSession,d.a.Error,"Image Failed to load - "+JSON.stringify({id:e.id,hasUrl:!!e.url,mimeType:e.mimeType,urlType:e.urlType,byteCount:e.byteCount,isGLContextValid:this.rendererEnvironment.isGLContextValid})),{})}ensureSVGWidthHeight(e){if(!e.getAttribute("width")||!e.getAttribute("height")){var t=e.getAttribute("viewBox");if(t){var i=t.match(/\w+ \w+ (\w+) (\w+)/);null!=i&&(e.setAttribute("width",i[1]),e.setAttribute("height",i[2]))}}}clearNavigationState(){for(const e of this.m_slideSceneView){for(const t of e.slideViewElement.animTimeline.getTimelineStates(!1)||[])e.slideViewElement.animTimeline.resetTimeline(t.timelineId),e.slideViewElement.fNeedsDummyClick&&e.slideViewElement.animTimeline.addTimelineClick(h.e.MainTimelineId);e.slideViewElement.animClock.stop()}}async refreshViewController(){if(this.settings.isMultiSlideshowcoreEnabled&&oi.s_preloadedRendererEnvironment){if(b.ChangeGate.isChangeGateEnabled("EnableTriggerAnimation")){document.querySelectorAll("#"+oi.SlideLevelHtmlElementsParentDivId).forEach(e=>{e.remove()});const e=document.createElement("div");e.id=oi.SlideLevelHtmlElementsParentDivId,this.m_container.appendChild(e),this.m_slideLevelHtmlElementsParentContainer=e}this.rendererEnvironment=oi.s_preloadedRendererEnvironment,this.getBounds=this.settings.getBounds?this.settings.getBounds:new ti(this.m_container,this.rendererEnvironment),this.rendererEnvironment.viewController=this,this.m_viewControllerInternals&&(this.rendererEnvironment.viewControllerInternals=this.m_viewControllerInternals),this.rendererEnvironment.setupCanvas(this.m_container)}}async updateViewDataManager(e,t,i){let r={};const n=!(!i||!i.fSkipRendering);for(const e of this.m_slideSceneView)!this.m_currentRenderedSlideId||e.slideId.sid!==this.m_currentRenderedSlideId.sid||n?(e.scene&&this.deleteScene(e),e.slideViewElement.shapeViewElements=[],this.m_slideSceneView=this.m_slideSceneView.filter(t=>t!==e)):e.slideViewElement.shapeViewElements=[];if(this.viewDataManager=e,this.m_currentRenderedSlideId&&!n){o.a.sendTraceTag(591927435,l.a.msoulscat_Wac_PptSession,d.a.Info,"Rerender the current slide with new ViewDataManager - sid:"+this.m_currentRenderedSlideId.sid);const e=this.m_slideSceneView.find(e=>e.slideId.sid===this.m_currentRenderedSlideId.sid),n=!oi.getElementFromCollection(this.m_inScreenCoordsContainer.children,oi.BlankSlideDivId)||b.ChangeGate.isChangeGateEnabled("SSC.shouldRenderOnBlankSlide");if(e&&n){let n=await e.slideViewElement.ensure({loadDataOptions:i});if(n.hasOwnProperty("errorName"))o.a.sendTraceTag(591927436,l.a.msoulscat_Wac_PptSession,d.a.Error,`ViewController::updateViewDataManager: invalid slideViewData. sid:${this.m_currentRenderedSlideId.sid}, ensureResult:${n.errorName}`);else{for(e.scene&&this.deleteScene(e);this.m_slideLevelHtmlElementsParentContainer.firstChild;)this.m_slideLevelHtmlElementsParentContainer.firstChild.remove();const a=await this.createImageTextureMapData(e);n=await e.slideViewElement.ensure({loadDataOptions:i}),this.viewDataManager.slideMetadataMap.set(this.m_currentRenderedSlideId.sid,{slideId:this.m_currentRenderedSlideId,isHidden:e.slideViewElement.isHidden}),this.renderSlideById(this.m_currentRenderedSlideId,t),r={...n,...a}}r={...r,...n}}}return r}static getElementFromCollection(e,t){for(let i=0;i<e.length;i+=1)if(e[i].id===t)return e[i]}static getElementFromCollectionByLocalName(e,t){for(let i=0;i<e.length;i+=1)if(e[i].localName===t)return e[i]}get isGlobalMute(){return this.m_isGlobalMute}updateGlobalMute(e){if(this.m_isGlobalMute!==e){for(const t of this.m_slideSceneView)t.slideViewElement.updateGlobalMute(e);this.m_isGlobalMute=e}}muteAllPlayingMedia(){o.a.sendTraceTag(523347020,l.a.msoulscat_Wac_PptSession,d.a.Info,"ViewController: Muting all playing media");for(const e of this.m_slideSceneView)e.slideViewElement.muteAllPlayingMedia()}checkForLeaksByScenario(){const e=this.checkForLeaks(),t=new Map;for(const i of e?e.table:[]){if("DistanceField/glyphPage"===i.scenario||"ScratchBuffer"===i.scenario)continue;i.scenario=i.scenario.split("-")[0];const e=t.get(i.scenario)||0;t.set(i.scenario,e+i.memory)}return t}checkForLeaks(e){const t=this.rendererEnvironment.webGLRenderer;if(!t)return void console.log("only supported for webGL");const i=[];for(const t of this.m_slideSceneView)t.scene&&(i.push(t.scene),e&&t.scene.releaseGeneratedResources());const r=this.m_morphCache.getAllLoadResultsInCache().filter(e=>e.resource).map(e=>e.resource);for(const t of r){e&&t.dispose(),i.push(t.morph);for(const e of t.createdItems)i.push(e)}for(const e of this.viewDataManager.externalTexturesToRelease)i.push(e.texture);return{textures:t.getAllocatedTextures(i),table:t.getAllocatedTexturesDebugTable("clientData.id",i)}}}oi.accessibilityLanguage="",oi.s_gpuHardwareDisabled=!1,oi.s_isBadGpu=!1,oi.s_glyphCacheFailedCount=0,oi.ClickTargetsReferenceDivId="click-targets-reference",oi.BlankSlideDivId="blank-slide",oi.CrossSlideAudioContainerDivId="cross-slide-audio",oi.AccessibilityLiveRegionContainerDivId="live-region-accessibility-element",oi.SlideLevelHtmlElementsParentDivId="slide-level-html-elements-parent",oi.SlideLevelHtmlElementsDivId="slide-level-html-elements-transform",oi.ShapeAccessibilityElementId="shape-accessibility-element",oi.AccessibilitySlideTitleId="accessibility-slide-title",oi.CrossSlideShapeId="cross-slide-shape",oi.NotesPaneParagraphReaderId="notes-pane-paragraph-reader",oi.PreactivedAddinsDivId="cross-slide-preactived-addins"},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return I}));var r,n=i(25),a=i(23),s=i(7),o=i(11),l=i(0),d=i(36),h=i(257),c=i(8),u=i(61),f=i(22),m=i(16),p=i(18);class g{constructor(e,t,i,r,n,a){this.color=e,this.direction=t,this.wrapScale=i,this.wrapOffset=r,this.diffuse=n,this.specular=a}}class _{constructor(e,t){this.ambientColor=e,this.lights=t}}class v{constructor(e,t){this.profile=e,this.size=t}}class y{constructor(e,t,i,r,n,a,s,o,l){this.materialType=e,this.diffuseColor=t,this.specularColor=i,this.ambientColor=r,this.emissiveColor=n,this.specularPower=a,this.useBlinnHighlight=s,this.diffuseFresnel=o,this.alphaFresnel=l}}class b{constructor(e,t,i,r,n,a,s,o){this.topBevel=e,this.bottomBevel=t,this.material=i,this.extrusionColor=r,this.extrusionHeight=n,this.contourColor=a,this.contourWidth=s,this.zPosition=o}get adjustedContourWidth(){return Math.max(p.v,this.contourWidth)}}!function(e){function t(t,n){if(!t)return l.d.Identity;const a=t.pt?i(t.pt).scale(n):void 0,s=t.s?r(t.s):new l.e(1,1),o=t.rSpecified?t.r*e.c_internalAngleToRadianFactor:void 0,d=t.t?i(t.t).scale(n):void 0;return new l.d(a,s,o,d)}function i(e){return new l.e(e.x,e.y)}function r(e,t=0){return new l.e(e.x||t,e.y||t)}function n(e){return new s.b(e[0]/255,e[1]/255,e[2]/255,e[3]/255)}function a(e,t=1){return new l.c(e.l*t,e.t*t,e.r*t,e.b*t)}function h(e){let t=[];for(let i of e){const e=i.pos,r=n(i.clr);t.push(new s.d(e,r))}return t.sort((e,t)=>e.position-t.position),t}function c(e,t){if(e.gradientStops=t,e.isGammaCorrected=!1,2==t.length||3==t.length){const i=t[0],r=t[t.length-1];if(0==Math.min(i.position,r.position)&&1==Math.max(i.position,r.position))if(2==t.length)e.isGammaCorrected=!0,e.blendBellShape=l.e.One;else if(3==t.length&&i.color.equals(r.color)){const r=t[1];e.gradientStops=[new s.d(0,i.color),new s.d(1,r.color)],e.isGammaCorrected=!0,e.blendBellShape=new l.e(r.position,1)}}}function p(t,i,r){switch(t.bt){case 0:return new s.i(s.b.Transparent);case 1:{let e=n(t.Item.clr);return new s.i(e)}case 2:{const i=t.Item;let r=new s.c(2);return r.isStretched=i.isStretched,r.rotateWithShape=i.rtSp,r.angle=i.ang*e.c_internalAngleToRadianFactor,i.ftrct&&(r.fillToRect=a(i.ftrct)),i.ffrct&&(r.fillFromRect=a(i.ffrct)),i.stops&&c(r,h(i.stops)),r}case 3:{const i=t.Item;let r=new s.c(3);return r.isStretched=i.isStretched,r.rotateWithShape=i.rtSp,r.angle=i.ang*e.c_internalAngleToRadianFactor,i.ftrct&&(r.fillToRect=a(i.ftrct)),i.ffrct&&(r.fillFromRect=a(i.ffrct)),i.stops&&c(r,h(i.stops)),r}case 4:{const i=t.Item;let r=new s.c(4);return r.isStretched=i.isStretched,r.rotateWithShape=i.rtSp,r.angle=i.ang*e.c_internalAngleToRadianFactor,i.ftrct&&(r.fillToRect=a(i.ftrct)),i.ffrct&&(r.fillFromRect=a(i.ffrct)),i.stops&&c(r,h(i.stops)),r}case 5:{const i=t.Item;let r=new s.c(5);return r.isStretched=i.isStretched,r.rotateWithShape=i.rtSp,r.angle=i.ang*e.c_internalAngleToRadianFactor,i.ftrct&&(r.fillToRect=a(i.ftrct)),i.ffrct&&(r.fillFromRect=a(i.ffrct)),i.stops&&c(r,h(i.stops)),r}case 7:{const e=t.Item;return new s.g(e.type,n(e.clrFg),n(e.clrBg))}case 6:return S(t.Item,i);case 8:case 9:r.Message(39084627,"unsupported Brush "+JSON.stringify(t))}return new s.i(s.b.Transparent)}function S(e,t){if(!e.id)return;let i=new s.f;i.id=e.id;let r=new s.e(i);return r.wrapMode=e.wrpmd,r.alignment=e.algn,r.isStretched=e.isStretched,r.offset=new l.e(e.off.x,e.off.y),r.scale=new l.e(e.scale.x,e.scale.y),r.opacity=e.opcty,r.rotateWithShape=e.rotWShp,r.isStretched||(r.scale=r.scale.divide(new l.e(e.dpi.x,e.dpi.y)).scale(t.fromInch),r.offset=r.offset.scale(t.fromHighPrecisionUnit)),r}function T(e){return{cap:e.capType,end:e.type,length:e.len,width:e.width,widthMin:e.widthMin}}function w(e,t,i){if(!e)return new s.k;let r,n;e.fillBrsh&&(r=p(e.fillBrsh,t,i)),e.outlnBrsh&&(n=p(e.outlnBrsh,t,i));const a=function(e,t,i,r){let n=new s.h(t*r);return n.lineHeight=i*r,e?(e.dtSpecified&&(n.dashType=e.dt),e.jtSpecified&&(n.lineJoin=e.jt),e.mlSpecified&&(n.miterLimit=e.ml),e.ctSpecified&&(n.compoundType=e.ct),e.atSpecified&&(n.alignment=e.at),e.doffSpecified&&(n.dashOffset=e.doff),e.dctSpecified&&(n.useRoundDash=1==e.dct),e.headEnd&&(n.headEnd=T(e.headEnd)),e.tailEnd&&(n.tailEnd=T(e.tailEnd)),e.tip&&(n.tipType=e.tip),n):n}(e.pen,e.lnWdth,e.lnHgth,t.fromHighPrecisionUnit);let o=new s.k(r,n,a);return e.pctBrush&&(o.pictureBrush=S(e.pctBrush,t)),e.blend&&(o.blendingMode=e.blend),o}function M(t,i,r){let a,s,o,d,h;if(t.glw){let e=t.glw.blrRd*i,r=n(t.glw.clr);a=new u.b(r,e)}if(t.otrSdw){let a=t.otrSdw;s=new u.e(n(a.clr),a.blrRd*i,a.ang*e.c_internalAngleToRadianFactor,a.dst*i,new l.e(a.sx*r,a.sy*r),new l.e(a.kx,a.ky)),s.alignment=a.algn,s.shadowType=a.tp}if(t.inrSdw){let r=t.inrSdw;o=new u.c(n(r.clr),r.blrRd*i,r.ang*e.c_internalAngleToRadianFactor,r.dst*i)}if(t.rflctn){let e=t.rflctn;d=new u.d(e.blrRd*i,e.sAlph,e.sPos,e.eAlph,e.ePos,e.dst*i)}return t.sftEdg&&(h=new u.f(t.sftEdg.blrRd*i)),new u.a(a,s,o,d,h)}function C(e,i,r){let n=e.pts;if(!n)return;const a=null==(s=e.f)?1:0==s?0:2==s?2:3==s?3:4==s?4:5==s?5:1;var s;let o;if(e.h>0){let t=JSON.parse("["+n+"]");o={figures:[new f.a(t,!1,e.h)]}}else o={figures:f.e(n)};return o.fillMode=a,o.lineEnabled=e.s,e.xfrm?o.transform=t(e.xfrm,r):o.transform=l.d.Identity,o.transform=o.transform.applyScaleAndTranslationBefore(new l.e(i,i),l.e.Zero),o.extrusionEnabled=e.e,o}function I(e,i,n){let a=[];const s=e.xfrm?t(e.xfrm,i.fromHighPrecisionUnit):l.d.Identity,o=e.fontInfo;for(const t of e.glyphInstance)if(t.glyph&&n){const e=n.getGlyph(o,t.glyph);if(!e)continue;if(!e.clientData){let i=C(e.p,1,1);i&&(i.lineEnabled=!0,i.fillMode=1,i.glyphCacheId={fontId:o,glyphId:t.glyph},e.clientData=new f.c(i))}if(!e.clientData)continue;let l=r(t.scale,1).scale(i.fromHighPrecisionUnit);l=l.scale(1/4096);let d=r(t.off).scale(i.fromHighPrecisionUnit);const h=new f.c(e.clientData,s.applyScaleAndTranslationBefore(l,d));a.push(h)}return a}function P(e){return new d.j(e.cp,e.len)}function E(e,t){const i=C(e,1,1);if(i){const e=i.figures.length?i.figures[0]:void 0;if(e){const i=e instanceof f.a?e:e.createFigure();if(1==t)return i;{const e=i.points.slice(0);for(let r=0;r<i.getPointCount();r++)e[r*i.pointDataSize]*=t,e[r*i.pointDataSize+1]*=t;return new f.a(e,i.isClosed,i.format)}}}}function x(e,t){if(!e)return 0;switch(e){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 7;case 8:return 8;case 9:return 9;case 10:return 10;case 11:return 11;case 12:return 12;case 13:return 13;case 14:return 14;case 15:return 15;case 16:return 16}return t.Error(595637021,"Incorrect ShapeBuilder.TextStrokeType"),1}function A(e,t,i){const r=new m.b;for(const n of e){const e=w(n.style,t,i);r.push(new d.l(x(n.type,i),n.verticalCenter*t.fromLowPrecisionUnit,n.thickness*t.fromLowPrecisionUnit,e))}return r}function k(e,t,i,r,n,a){const s=a.getGlyph(n,e);if(s){if(!s.clientData){let t=C(s.p,1,1);t&&(t.lineEnabled=!0,t.fillMode=1,t.glyphCacheId={fontId:n,glyphId:e},s.clientData=new f.c(t))}if(s.clientData)return new f.c(s.clientData,new l.d(l.e.Zero,t,r,i))}}function R(t,i,n,a,s,o){let d=[];const h=t.fi?t.fi.v:i;for(const i of t.gi||[])if(i.g&&s){const t=i.s?r(i.s,1).scale(a.fromHighPrecisionUnit/4096):n||l.e.Zero;t.equals(l.e.Zero)&&o.Error(0,"No glyph scale");const c=r(i.o).scale(a.fromHighPrecisionUnit),u=i.r?i.r.v*e.c_internalAngleToRadianFactor:0,f=k(i.g,t,c,u,h,s);f&&d.push(f)}return d}function O(e,t,i,r,n,s,o){let l=[];for(let a of e.g||[])l=l.concat(R(a,t,i,r,n,o));for(let t of e.p||[]){const e=C(t,r.fromHighPrecisionUnit,r.fromHighPrecisionUnit);e&&l.push(new f.c(e))}let h,c=a(e.lb,r.fromLowPrecisionUnit);if(e.i){const t=S(e.i.i,r),i=a(e.i.b,r.fromLowPrecisionUnit);(null==t?void 0:t.image)&&i&&(h=new d.f(t.image,i,s))}return new d.d(c,l,e.f?e.f.v:void 0,e.w?e.w.v:void 0,h)}function L(e,t,i,r,n,s,o){var h;let c=P(e.rng),u=a(e.lbnd,r.fromLowPrecisionUnit),f=new d.h(c,u),m=[];if(e.c)for(let a=0;a<e.c.length;a++){let l=O(e.c[a],t.getAt(f.localRange.start+a),i.getAt(f.localRange.start+a),r,n,s,o);l&&m.push(l)}else(null===(h=e.s)||void 0===h?void 0:h.v)&&(m=function(e,t,i,r,n,a,s,o){const h=[],c=e.split(";");for(let e=0;e<c.length;e++){const u=c[e].split(/([A-VXYZ])/),f=u.length>0?u[0]:void 0;let m,p;for(let e=1;e<u.length-1;e+=2){const t=u[e];"L"==t&&(m=u[e+1]),"R"==t&&(p=u[e+1])}if(f&&m&&p){const o=parseFloat(m)*s.fromLowPrecisionUnit,c=parseFloat(p)*s.fromLowPrecisionUnit,u="W"==f;let g;if(!u){const t=k(parseInt(f),n.getAt(a+e),new l.e(o,0),0,r.getAt(a+e),i);t&&(g=[t])}const _=new l.c(o,t.top,c,t.bottom);h.push(new d.d(_,g,!1,u))}else o.Error(0,"Wrong SimplifiedCharacterString: 0:"+f+", L:"+m+", R:"+p)}return h}(e.s.v,u,n,t,i,f.localRange.start,r,o));return f.characters=m,e.b&&(f.bender=function(e,t){return e.wenv?function(e,t){const i=E(e.tpp,t.fromLowPrecisionUnit),r=E(e.btp,t.fromLowPrecisionUnit);if(i&&r)return new d.m(a(e.rct,t.fromLowPrecisionUnit),i,r,e.vrt)}(e.wenv,t):e.plin?function(e,t){const i=E(e.pth,t.fromLowPrecisionUnit);if(i){const r=0==e.algn?0:2==e.algn?1:.5;return new d.a(a(e.rct,t.fromLowPrecisionUnit),i,r,e.s,e.pvt,e.vrt)}}(e.plin,t):void 0}(e.b,r)),e.o&&(f.offset=new l.e(e.o.x*r.fromLowPrecisionUnit,e.o.y*r.fromLowPrecisionUnit)),f.fillBounds=a(e.fb,r.fromLowPrecisionUnit),f.textEffectMetrics=new d.e(e.ea*r.fromLowPrecisionUnit,e.ed*r.fromLowPrecisionUnit,e.eh*r.fromLowPrecisionUnit),f}function F(e,t,i,n,a){let o=new d.i(P(e.gr),new s.k(new s.g(27,s.b.Blue,s.b.Yellow)));e.o&&(o.offset=new l.e(e.o.x*i.fromLowPrecisionUnit,e.o.y*i.fromLowPrecisionUnit));let h=new d.b("");for(let t of e.fipr||[])h.set(t.fontInfo,P(t.range));let c=new d.b(l.e.Zero);for(let t of e.gspr||[])c.set(r(t.s,1).scale(i.fromHighPrecisionUnit/4096),P(t.rng));e.blt&&(o.bullet=function(e,t,i,r,n,a){var s;if(!e.c)return;const o=O(e.c,t,void 0,i,r,n,a),l=w(e.style,i,a),h=e.fx?M(e.fx,i.fromHighPrecisionUnit,1):void 0,c=(null===(s=e.stks)||void 0===s?void 0:s.length)>0?A(e.stks,i,a):void 0;return new d.c(o,l,h,c)}(e.blt,e.blt.fi,i,t,n,a));const u=new Array;for(let r of e.l||[]){const e=L(r,h,c,i,t,n,a);e&&u.push(e)}for(let t of e.spr||[]){const e=w(t.style,i,a);o.stylePerLocalRange.set(e,P(t.range))}for(let t of e.stkspr||[]){const e=A(t.textStrokeList,i,a);e?o.strokesPerLocalRange.set(e,P(t.range)):a.Error(39084627,"Unable to convert stroke")}for(let t of e.lwrng||[])o.addLocalWordRange(P(t));for(let t of e.fxpr||[])o.effectsPerLocalRange.set(M(t.fx,i.fromHighPrecisionUnit,1),P(t.range));return o.lines=u,o}function D(e,t){return e?new l.a(e.l?e.l.v*t:void 0,e.t?e.t.v*t:void 0,e.r?e.r.v*t:void 0,e.b?e.b.v*t:void 0):void 0}e.c_internalAngleToRadianFactor=2*Math.PI/216e5,e.getPresWidthAndHeightJson=function(e){return new l.e(e.w,e.h)};const B=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0];function N(e){let t=B[e];if(t)return t;const i=new f.b;switch(i.moveTo(0,0),e){case 0:i.cubicBezierTo(0,.367,.124605,.82,.507899,1),i.cubicBezierTo(.724115,.737,.790455,.64,1,.64);break;case 1:i.cubicBezierTo(0,.55627,.44373,1,1,1);break;case 2:i.quadBezierTo(0,.125,.025,.25),i.lineTo(.125,.75),i.cubicBezierTo(.175,1,.25,1,.375,1),i.lineTo(.5,1),i.cubicBezierTo(.625,1,.7,1,.75,.75),i.lineTo(.875,.125),i.cubicBezierTo(.9,.01,.98,.01,1,.01);break;case 3:i.cubicBezierTo(0,.05563,.04437,.1,.1,.1),i.lineTo(.4,.1),i.cubicBezierTo(.45563,.1,.5,.14437,.5,.2),i.lineTo(.5,.9),i.cubicBezierTo(.5,.95563,.54437,1,.6,1);break;case 4:i.lineTo(1,1);break;case 5:i.cubicBezierTo(0,.4775,.0968736,1,.156301,1),i.cubicBezierTo(.264179,1,.376919,.33333,1,.33333);break;case 6:i.cubicBezierTo(0,.07082,.0297458,.1,.101416,.1),i.cubicBezierTo(.501416,.1,.9,.7,.901416,.899999),i.cubicBezierTo(.9,.97167,.93343,1,1,1);break;case 7:i.cubicBezierTo(0,.138122,0,.2,.271356,.775535),i.cubicBezierTo(.377654,1,.519455,1,.583589,1);break;case 8:i.cubicBezierTo(0,.236604,.119276,.607024,.263046,.760235),i.cubicBezierTo(.361098,.864726,.457934,.909567,.537806,.925082),i.cubicBezierTo(.559245,.929246,.567625,.89793,.542066,.845567),i.cubicBezierTo(.484073,.726757,.477103,.393693,.551651,.393693),i.lineTo(.899894,.393693),i.cubicBezierTo(.99148,.393693,.958466,.746659,.907348,.779629),i.lineTo(.879394,.797658),i.cubicBezierTo(.845545,.819489,.848775,.954172,.874334,.971627),i.quadBezierTo(.915883,1,1,1);break;case 9:i.cubicBezierTo(0,.238519,.132047,.500741,.357567,.731852),i.cubicBezierTo(.513167,.891311,.563798,.912593,.735905,.912593),i.lineTo(.873887,.912593),i.cubicBezierTo(.956973,.912593,.878338,1,1,1);break;case 10:i.quadBezierTo(0,.092437,.042353,.305322),i.lineTo(.170124,.947558),i.cubicBezierTo(.177203,.983142,.2,1,.268235,.998599),i.lineTo(.614118,.998599),i.cubicBezierTo(.647059,.998599,.656471,.987395,.663529,.969188),i.cubicBezierTo(.687006,.908633,.802353,.822129,1,.822129);break;case 11:i.cubicBezierTo(0,.184095,.149238,.333333,.333333,.333333),i.cubicBezierTo(.333333,.701523,.63181,1,1,1);break;default:i.lineTo(1,0)}return t=i.createFigure(),B[e]=t,t}function V(e,i,r,n,a){const s=new d.g,o=new l.d(n.translation.negate(),l.e.One,-n.rotation,l.e.Zero);return s.paragraphs=function(e,t,i,r,n){let a=[];for(let s of e||[])a.push(F(s,t,i,r,n));return a}(e.p,i,r,o,a),s.layoutToFrame=t(e.ltfxfrm,r.fromHighPrecisionUnit),s.frameToShape=t(e.ftsxfrm,r.fromHighPrecisionUnit),s.clipBounds=D(e.c,r.fromLowPrecisionUnit),s.applyEffectsPerCharacter=!!e.s&&e.s.v,s}function U(e,i,r,a,d){try{if(!e)return;let h=[];const c=t(e.xfrm,a.fromHighPrecisionUnit);let m=new Array;if(i)for(let e of i){if(!e)continue;let t=C(e,a.fromHighPrecisionUnit,a.fromHighPrecisionUnit);t&&m.push(new f.c(t))}e.tx&&function(e,{},i,r,n,a){var s;for(let l of e){if(!l.primitives)continue;let e=new Array;for(const t of l.primitives)if(null===(s=null==t?void 0:t.p)||void 0===s?void 0:s.pts.length){let i=C(t.p,r.fromHighPrecisionUnit,r.fromHighPrecisionUnit);if(!i)continue;i.lineEnabled=!0,i.fillMode=1,e.push(new f.c(i))}else if(t.r){const n=I(t.r,r,i);e.push(...n)}const d={fromLowPrecisionUnit:r.fromLowPrecisionUnit,fromHighPrecisionUnit:r.fromLowPrecisionUnit,fromInch:r.fromInch};let h=w(l.style,d,a);const c=t(l.xfrm,r.fromHighPrecisionUnit);let u=new o.e(e,h,void 0,c);u.overlapMode=1,u.mergeMode=l.union?1:0,u.role=3,n.push(u)}}(e.tx,c,r,a,h,d);let p=w(e.style,a,d);const g=e.fx?M(e.fx,a.fromHighPrecisionUnit,.01):void 0;if(e.tx){let t=g?new u.a(void 0,void 0,g.innerShadow,void 0,g.softEdges):void 0,i=g?new u.a(g.glow,g.shadow,void 0,g.reflection,void 0):void 0;const n=new o.e(m,p,t,c);return e.tl&&(n.text=V(e.tl,r,a,c,d)),new o.b([n,...h],i)}const _=new o.e(m,p,g,c);if(e.tl&&(_.text=V(e.tl,r,a,c,d)),void 0!==e.ioff){let t=[];for(const i of e.ioff){const e=new l.e(i.x*a.fromHighPrecisionUnit,i.y*a.fromHighPrecisionUnit);t.push(e)}t.length>0&&(_.instances=t.map(e=>new o.c(l.b.Translation2D(e))))}if(e.s3d){const t=e.s3d.tb?new v(N(e.s3d.tb.p),new l.e(e.s3d.tb.w*a.fromLowPrecisionUnit,e.s3d.tb.h*a.fromLowPrecisionUnit)):void 0,i=e.s3d.bb?new v(N(e.s3d.bb.p),new l.e(e.s3d.bb.w*a.fromLowPrecisionUnit,e.s3d.bb.h*a.fromLowPrecisionUnit)):void 0,r=function(e,t,i,r){let n=t,a=0,o=s.b.Black,l=s.b.Black,d=s.b.Black,h=0,c=!1,u=0,f=0;switch(e){case 0:l=t,c=!0;break;case 1:o=s.b.White,l=t,h=32,c=!0;break;case 2:const e=s.b.InterpolateLinear(t,s.b.Black,1/3);n=e,o=t,l=e,h=32,c=!0,a=2;break;case 3:a=1;break;case 4:l=t;break;case 5:o=s.b.Gray(.6),l=t,h=12;break;case 6:let i=s.b.InterpolateLinear(t,s.b.White,.2);i=s.b.InterpolateLinear(i,s.b.White,1.4),o=i,l=t,h=12,u=4,a=2;break;case 7:o=s.b.Gray(.3),l=t,h=8;break;case 8:{const e=new s.b(t.r,t.g,t.b,.7);n=e,o=s.b.Gray(.3),l=e,h=10,c=!0,u=2,f=-1;break}case 9:n=s.b.InterpolateLinear(t,s.b.White,.5),o=s.b.Gray(.3),l=s.b.InterpolateLinear(t,s.b.White,.5),h=10,c=!0,u=2;break;case 10:o=s.b.White,l=t,h=35,u=-2;break;case 11:o=s.b.White,l=t,h=35,u=4,f=-10;break;case 12:{const e=new s.b(t.r,t.g,t.b,.1);n=e,o=s.b.Gray(.6),l=e,h=20,u=-8,f=1;break}case 13:n=new s.b(0,0,0,t.a),o=s.b.Gray(.8),d=t,h=50,u=-4,f=1;break;case 14:n=s.b.InterpolateLinear(t,s.b.White,.5),l=t,h=8,a=2;break;default:o=s.b.White,l=t,h=40}return i||0!=e&&1!=e&&2!=e||(n=new s.b(0,0,0,t.a),o=s.b.Gray(.8),l=s.b.Black,d=t,h=50,c=!1,u=-4,f=0),new y(a,n,o,l,d,h,c,u,f)}(e.s3d.mt,s.b.White,p.fillBrush instanceof s.i&&p.lineBrush instanceof s.i),o=e.s3d.cc?n(e.s3d.cc.v):1==r.materialType?s.b.Black:void 0,d=e.s3d.cc?e.s3d.cw*a.fromLowPrecisionUnit:0,h=e.s3d.xc?n(e.s3d.xc.v):void 0,c=new b(t,i,r,h,e.s3d.h*a.fromLowPrecisionUnit,o,d,e.s3d.z*a.fromLowPrecisionUnit);_.shape3D=c}return _}catch(e){d.Error(595637020,"Unexpected exception parsing shape")}}function W(e){return e.clientData||(e.clientData={}),e.clientData}function z(e,t,i,r,a){var d;if(!e)return;const h=(null===(d=e.bapi)||void 0===d?void 0:d.v)||"";let c;if(e.Items){let n=[];for(const s of e.Items){const e=z(s,t,i,r,a);e&&n.push(e)}const s=e.fx?M(e.fx,i.fromHighPrecisionUnit,.01):void 0;c=new o.b(n,s)}else c=U(e,e.pthLst||[],t,i,r),c&&e.c&&(c=new o.b([c]),c.clipBounds=D(e.c,i.fromLowPrecisionUnit));return c&&(c.scene3D=e.scn?function(e){const t=[];for(let i of e.l||[])t.push(new g(new s.b(i.cr,i.cg,i.cb,1),new l.f(i.dx,i.dy,i.dz),i.ws,i.wo,i.d,i.s));return new _(n(e.a),t)}(e.scn):void 0,W(c).partId=h,W(c).renderDataId=e.id,(null==a?void 0:a.defaultClientData)&&function(e,t){const i=W(e);for(const e of Object.keys(t))i[e]=t[e]}(c,a.defaultClientData)),c}e.convertDocShapeOrGroup=function(e,t,i,r,n){if(!e)return;const a=12700*i;return z(e,t,{fromLowPrecisionUnit:e.lpu?e.lpu.v*a:1,fromHighPrecisionUnit:e.hpu?e.hpu.v*a:i,fromInch:914400*i},r,n)},e.convertShapeOrGroupRenderData=z}(r||(r={}));var S=i(4),T=i(2),w=i(3),M=i(40),C=i(1);class I{static initShapeItem(e,t,i,n,a,h){let u;if(i.shapeBuilderData){try{u=r.convertDocShapeOrGroup(i.shapeBuilderData,h.viewDataManager.glyphStore,n,M.a.getInstance(),{defaultClientData:{shapeId:a}})}catch(e){return void S.a.sendTraceTag(593356505,T.a.msoulscat_Wac_PptSession,w.a.Error,`ShapeViewElement::init: ParseJson.convertDocShapeOrGroup threw exception ${e}.`)}if(!u)return void S.a.sendTraceTag(593356506,T.a.msoulscat_Wac_PptSession,w.a.Error,"ShapeViewElement::init: invalid shapeItem after convertRenderData.");for(const i of e){const e=[];for(const t of i.parts){const i=I.toPositionSize(t.regionPos),r=Object(M.f)(u);let n;if(t.fText&&r&&r.text){let a;switch(t.splitBy){case 0:a=2;break;case 1:a=1;break;default:a=0}n=t.textRange?d.j.FromFirstLast(t.textRange.begin,t.textRange.begin+t.textRange.length-1):r.text.getFullRange();const s=r.text.getAnimatablePartRanges(a,n,!1);if(!s)continue;for(const n of s){let s;if(t.fShape||!C.Settings.readBooleanOrDefault("useShapeBuilderForClickTargetBounds",!1))s=i;else{const e=new l.d(c.b.Zero,c.b.One,r.transform.rotation,r.transform.translation),t=r.text.getBoundsOfRange(n,e);if(!t)continue;s={position:t.leftTop,size:t.size}}let o=n;0!==a||t.textRange||(o=void 0);const d={fShape:t.fShape,fText:t.fText,bigParts:t.bigParts,position:s.position,size:s.size,shapeId:t.shapeId,textRange:o};e.push(d)}continue}const a={fShape:t.fShape,fText:t.fText,bigParts:t.bigParts,position:i.position,size:i.size,shapeId:t.shapeId,textRange:n};e.push(a)}t.push({id:i.id,parts:e})}}else{const i=[];for(const r of e){const e=[];for(const t of r.parts){const r=I.toPositionSize(t.regionPos),n=new s.f;n.id=t.regionPos.region.imgID;const d=new s.e(n),h=o.e.CreateRectangle(l.c.FromSize(r.size),new s.k(d),void 0,new l.d(r.position));Object(M.c)(h).shapeId=a,Object(M.c)(h).partId=t.bigParts.length>0?t.bigParts[0]:"",i.push(h);const u={fShape:!0,fText:!0,bigParts:t.bigParts,position:new c.b(t.regionPos.pos.x,t.regionPos.pos.y),size:new c.b(t.regionPos.region.rect.right-t.regionPos.region.rect.left,t.regionPos.region.rect.bottom-t.regionPos.region.rect.top),shapeId:t.shapeId};e.push(u)}t.push({id:r.id,parts:e})}1===i.length?u=i[0]:(u=new o.b(i),Object(M.c)(u).shapeId=a)}return Object(M.c)(u).isBackground=i.isBackground,u}static attachTextures(e,t,i,r){const n={},a=e.viewDataManager.imageDataMap;if(!i.shapeBuilderData){const o=i.animatableContents;for(const l of o)for(const o of l.parts){const l=I.toPositionSize(o.regionPos);if(!a.has(o.regionPos.region.imgID))continue;const d=a.get(o.regionPos.region.imgID),h=d.size;if(!h)return n;const u=new c.b((o.regionPos.region.rect.right+o.regionPos.region.rect.left)/2,(o.regionPos.region.rect.bottom+o.regionPos.region.rect.top)/2);I.verifyTextureSize(e,"attachTextures_fallback",l.size);const f=new s.f;f.id=o.regionPos.region.imgID;const m=r&&r.shapeId&&C.Settings.readBooleanOrDefault("useDetailedTextureScenario",!0)?`FallbackShape-Slide:${r.shapeId.slideId.sid}-Shape:${r.shapeId.shapeId}-Image:${f.id}`:"FallbackShape";e.rendererEnvironment.attachImage(m,f,d,l.size),d.loadedShapeIDs.push(i.shapeId.shapeId);const p=new s.e(f);p.scale=h.divide(l.size),p.offset=h.scale(.5).subtract(u).divide(l.size);const g=I.findShapeWithImageId(t,o.regionPos.region.imgID);g&&(g.style=new s.k(p))}return n}for(const r of t.getBrushImages()){if(!r.id)continue;if(!a.has(r.id)){S.a.sendTraceTag(594641554,T.a.msoulscat_Wac_PptSession,w.a.Error,`ShapeViewElement::attachTextures: Missing texture. Id: ${r.id}, imageDataMap:${!!a.has(r.id)}`),n.hasOwnProperty("missingTextureIds")||(n.missingTextureIds=[]),n.missingTextureIds.push(r.id);continue}const t=a.get(r.id);I.verifyTextureSize(e,"attachTextures_nonfallback",t.size),e.rendererEnvironment.attachImage("Shape",r,t,t.size),t.loadedShapeIDs.push(i.shapeId.shapeId)}return n}static toPositionSize(e){return{position:e?new c.b(e.pos.x,e.pos.y):c.b.Zero,size:e?new c.b(e.region.rect.right-e.region.rect.left,e.region.rect.bottom-e.region.rect.top):c.b.One}}static removeFromScene(e,t){const i=e.items.elements.slice(0);i.splice(e.items.elements.indexOf(t),1),e.setItems(i)}static applyAnimationToShapeItemAndClickTarget(e,t,i){const r=e.Attributes,n=e.Shape,s=new c.b(n.position.x,n.position.y),o=new c.b(n.size.x,n.size.y),u={position:new c.b(a.b.getAnimAttributeValue(r,a.c.PosX,s.x),a.b.getAnimAttributeValue(r,a.c.PosY,s.y)),scale:new c.b(a.b.getAnimAttributeValue(r,a.c.ScaleW,1),a.b.getAnimAttributeValue(r,a.c.ScaleH,1)),fadeMaskInfo:a.b.getAnimAttributeValue(r,a.c.FadeMaskInfo,void 0),fadeMaskProgress:a.b.getAnimAttributeValue(r,a.c.FadeMaskProgress,0),angle:a.b.getAnimAttributeValue(r,a.c.Rotate,0),startingPosition:s,visible:a.b.getAnimAttributeValue(r,a.c.Visible,0)},f=new c.b(u.position.x-u.startingPosition.x,u.position.y-u.startingPosition.y),m=s.add(o.scale(.5)),p=new l.d(m.negate(),u.scale,u.angle,f.add(m)),g=!u.visible;let _;if(u.fadeMaskInfo){const e=!!(1&u.fadeMaskInfo.flags),t=!!(2&u.fadeMaskInfo.flags),i=!!(4&u.fadeMaskInfo.flags),r=!!(8&u.fadeMaskInfo.flags),n=!!(16&u.fadeMaskInfo.flags);_=new h.b(u.fadeMaskInfo.preset,u.fadeMaskInfo.param,i,r,e,t,n),_.progress=u.fadeMaskProgress}const v=Object(M.e)(t,n.bigParts)||[t];for(const e of v)if(n.fShape&&(e.animationTransform=p.toMatrix3(),e.isHidden=g,e.fade=_),n.fText){const t=Object(M.f)(e);if(t&&t.text&&n.textRange){const e=new d.k,i=n.textRange;e.animationTransform=p.toMatrix3(),e.fade=_,e.isHidden=g,t.text.animationProps||t.text.createAnimationProps(),t.text.animationProps&&t.text.animationProps.set(e,i)}}if(i.clickTargets)for(let t=0;t<i.clickTargets.length;t+=1){const r=i.clickTargets[t],n=document.getElementById(`sp-${JSON.stringify(i.shapeId)}-i-${t}`);if(!n)continue;if(I.getAnimatableContentIdFromClickTarget(r)!==(-1!==e.Id.indexOf("c")?e.Id.split("c")[0]:e.Id))continue;if(!u.visible){n.style.display="none";continue}const a=C.Settings.readBooleanOrDefault("useShapeBuilderForClickTargetBounds",!1)?l.c.FromSize(o):I.getAnimatableContentRegionFromClickTarget(r);a&&(I.setClickTargetRegion(n,a,u.position),n.style.display="block")}}static setClickTargetRegion(e,t,i){e.style.position="absolute",e.style.left=i.x+t.left+"px",e.style.top=i.y+t.top+"px";const r={left:i.x+t.left,top:i.y+t.top,right:i.x+t.right,bottom:i.y+t.bottom},a=document.getElementById(n.b.ClickTargetsReferenceDivId);if(a){const t={left:0,top:0,right:a.offsetWidth,bottom:a.offsetHeight},i=C.Settings.readBooleanOrDefault("hackClickTargets",!1)?r:I.findIntersectingRect(r,t);if(!i)return e.style.display="none",e.style.width="0px",void(e.style.height="0px");e.style.display="block",e.style.width=i.right-i.left+"px",e.style.height=i.bottom-i.top+"px"}}static findShapeWithImageId(e,t){if(!e)return;const i=e=>e.getBrushImages().findIndex(e=>e.id===t)>=0;if(1===e.getType()){const t=e;return i(t)?t:void 0}if(2!==e.getType())return;const r=e;for(const e of r.items.elements){if(1!==e.getType())return;const t=e;if(i(t))return t}}static getAnimatableContentIdFromClickTarget(e){return e.action?e.action.animatableContentId:e.animation?e.animation.animatableContentId:e.hyperlink?e.hyperlink.animatableContentId:void 0}static getAnimatableContentRegionFromClickTarget(e){return e.action?e.action.region:e.animation?e.animation.region:e.hyperlink?e.hyperlink.region:void 0}static findIntersectingRect(e,t){const i=Math.max(e.left,t.left),r=Math.min(e.right,t.right),n=Math.max(e.top,t.top),a=Math.min(e.bottom,t.bottom);if(r>=i&&a>=n)return{left:i,top:n,right:r,bottom:a}}static verifyTextureSize(e,t,i){!e.stringifyError||"number"==typeof i.x&&i.x>0&&"number"==typeof i.y&&i.y>0||S.a.sendTraceTag(545404041,T.a.msoulscat_Wac_PptSession,w.a.Error,e.stringifyError(new Error(`verifyTextureSize: invalid size. scenario: ${t}, x:${i.x}, y:${i.y}`)))}static ensureShapeViewElementParentDiv(e,t,i){const r=i?`${n.b.SlideLevelHtmlElementsDivId}-${JSON.stringify(e)}-${n.b.CrossSlideShapeId}`:`${n.b.SlideLevelHtmlElementsDivId}-${JSON.stringify(e)}`;let a=document.getElementById(r);if(a)return a;const s=document.getElementById(n.b.SlideLevelHtmlElementsParentDivId);return a=document.createElement("div"),a.style.position="absolute",a.id=r,a.style.zIndex=t,s&&s.appendChild(a),a}static ensureAccessibilityElement(e){const t=document.getElementById(n.b.SlideLevelHtmlElementsParentDivId);if(t){const i=this.generateShapeLevelAccessibilityElementId(e);if(document.getElementById(i))return;const r=document.createElement("div");r.id=i,r.style.display="none",t.appendChild(r)}}static ensureSlideTitleElement(){let e=document.getElementById(n.b.AccessibilitySlideTitleId);if(e)return e;const t=document.getElementById(n.b.SlideLevelHtmlElementsParentDivId);return e=document.createElement("span"),e.id=n.b.AccessibilitySlideTitleId,t&&t.firstChild?t.insertBefore(e,t.firstChild):t&&t.appendChild(e),e}static generateShapeLevelAccessibilityElementId(e){return`${n.b.ShapeAccessibilityElementId}-sid:${e.slideId.sid}-shapeId:${e.shapeId}`}static generateShapeIdString(e){return`sid:${e.slideId.sid}-shapeId:${e.shapeId}`}}},function(e,t,i){"use strict";i.r(t),i.d(t,"__extends",(function(){return n})),i.d(t,"__assign",(function(){return a})),i.d(t,"__rest",(function(){return s})),i.d(t,"__decorate",(function(){return o})),i.d(t,"__param",(function(){return l})),i.d(t,"__metadata",(function(){return d})),i.d(t,"__awaiter",(function(){return h})),i.d(t,"__generator",(function(){return c})),i.d(t,"__createBinding",(function(){return u})),i.d(t,"__exportStar",(function(){return f})),i.d(t,"__values",(function(){return m})),i.d(t,"__read",(function(){return p})),i.d(t,"__spread",(function(){return g})),i.d(t,"__spreadArrays",(function(){return _})),i.d(t,"__spreadArray",(function(){return v})),i.d(t,"__await",(function(){return y})),i.d(t,"__asyncGenerator",(function(){return b})),i.d(t,"__asyncDelegator",(function(){return S})),i.d(t,"__asyncValues",(function(){return T})),i.d(t,"__makeTemplateObject",(function(){return w})),i.d(t,"__importStar",(function(){return C})),i.d(t,"__importDefault",(function(){return I})),i.d(t,"__classPrivateFieldGet",(function(){return P})),i.d(t,"__classPrivateFieldSet",(function(){return E})),i.d(t,"__classPrivateFieldIn",(function(){return x}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var a=function(){return(a=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function s(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(i[r[n]]=e[r[n]])}return i}function o(e,t,i,r){var n,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(s=(a<3?n(s):a>3?n(t,i,s):n(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s}function l(e,t){return function(i,r){t(i,r,e)}}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,i,r){return new(i||(i=Promise))((function(n,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))}function c(e,t){var i,r,n,a,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&a[0]?r.return:a[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,a[1])).done)return n;switch(r=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){s.label=a[1];break}if(6===a[0]&&s.label<n[1]){s.label=n[1],n=a;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(a);break}n[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{i=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}}var u=Object.create?function(e,t,i,r){void 0===r&&(r=i);var n=Object.getOwnPropertyDescriptor(t,i);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,r,n)}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]};function f(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||u(t,e,i)}function m(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,a=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return s}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function _(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var r=Array(e),n=0;for(t=0;t<i;t++)for(var a=arguments[t],s=0,o=a.length;s<o;s++,n++)r[n]=a[s];return r}function v(e,t,i){if(i||2===arguments.length)for(var r,n=0,a=t.length;n<a;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function b(e,t,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,n=i.apply(e,t||[]),a=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){n[e]&&(r[e]=function(t){return new Promise((function(i,r){a.push([e,t,i,r])>1||o(e,t)}))})}function o(e,t){try{(i=n[e](t)).value instanceof y?Promise.resolve(i.value.v).then(l,d):h(a[0][2],i)}catch(e){h(a[0][3],e)}var i}function l(e){o("next",e)}function d(e){o("throw",e)}function h(e,t){e(t),a.shift(),a.length&&o(a[0][0],a[0][1])}}function S(e){var t,i;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,n){t[r]=e[r]?function(t){return(i=!i)?{value:y(e[r](t)),done:"return"===r}:n?n(t):t}:n}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=m(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=e[i]&&function(t){return new Promise((function(r,n){!function(e,t,i,r){Promise.resolve(r).then((function(t){e({value:t,done:i})}),t)}(r,n,(t=e[i](t)).done,t.value)}))}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var M=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&u(t,e,i);return M(t,e),t}function I(e){return e&&e.__esModule?e:{default:e}}function P(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)}function E(e,t,i,r,n){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?n.call(e,i):n?n.value=i:t.set(e,i),i}function x(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,i){var r=i(43),n=r.Buffer;function a(e,t){for(var i in e)t[i]=e[i]}function s(e,t,i){return n(e,t,i)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(a(r,t),t.Buffer=s),s.prototype=Object.create(n.prototype),a(n,s),s.from=function(e,t,i){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,i)},s.alloc=function(e,t,i){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=n(e);return void 0!==t?"string"==typeof i?r.fill(t,i):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,i){"use strict";var r,n;i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n})),function(e){e[e.Attendee=0]="Attendee",e[e.Presenter=1]="Presenter",e[e.PrivateViewing=2]="PrivateViewing"}(r||(r={})),function(e){e.Init="init",e.Next="next",e.Prev="prev",e.GoToFirst="gotoFirst",e.GoToLast="gotoLast",e.ClickTarget="clickTarget",e.GoTo="goto"}(n||(n={}))},function(e,t,i){"use strict";var r,n="object"==typeof Reflect?Reflect:null,a=n&&"function"==typeof n.apply?n.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};r=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(i,r){function n(i){e.removeListener(t,a),r(i)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",n),i([].slice.call(arguments))}_(e,t,a,{once:!0}),"error"!==t&&function(e,t,i){"function"==typeof e.on&&_(e,"error",t,{once:!0})}(e,n)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var l=10;function d(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function h(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function c(e,t,i,r){var n,a,s,o;if(d(i),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),a=e._events),s=a[t]),void 0===s)s=a[t]=i,++e._eventsCount;else if("function"==typeof s?s=a[t]=r?[i,s]:[s,i]:r?s.unshift(i):s.push(i),(n=h(e))>0&&s.length>n&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,o=l,console&&console.warn&&console.warn(o)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,i){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},n=u.bind(r);return n.listener=i,r.wrapFn=n,n}function m(e,t,i){var r=e._events;if(void 0===r)return[];var n=r[t];return void 0===n?[]:"function"==typeof n?i?[n.listener||n]:[n]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(n):g(n,n.length)}function p(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function g(e,t){for(var i=new Array(t),r=0;r<t;++r)i[r]=e[r];return i}function _(e,t,i,r){if("function"==typeof e.on)r.once?e.once(t,i):e.on(t,i);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function n(a){r.once&&e.removeEventListener(t,n),i(a)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return h(this)},o.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,n=this._events;if(void 0!==n)r=r&&void 0===n.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var l=n[e];if(void 0===l)return!1;if("function"==typeof l)a(l,this,t);else{var d=l.length,h=g(l,d);for(i=0;i<d;++i)a(h[i],this,t)}return!0},o.prototype.addListener=function(e,t){return c(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return c(this,e,t,!0)},o.prototype.once=function(e,t){return d(t),this.on(e,f(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return d(t),this.prependListener(e,f(this,e,t)),this},o.prototype.removeListener=function(e,t){var i,r,n,a,s;if(d(t),void 0===(r=this._events))return this;if(void 0===(i=r[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(n=-1,a=i.length-1;a>=0;a--)if(i[a]===t||i[a].listener===t){s=i[a].listener,n=a;break}if(n<0)return this;0===n?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,n),1===i.length&&(r[e]=i[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,i,r;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var n,a=Object.keys(i);for(r=0;r<a.length;++r)"removeListener"!==(n=a[r])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return m(this,e,!0)},o.prototype.rawListeners=function(e){return m(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(72),n=i(163);function a(e,t){return!!e&&e.toLowerCase().split(",").includes(t.toLowerCase())}t.logError=function(e){var t=(new Error).stack||"";n.ULS.sendTraceTag(592999624,n.LogCategory.msoulscat_Wac_PptSession,n.TraceLevel.Error,e+" "+t)},t.isContentTransition=function(e,t){switch(e){case r.kTransitionIds.PPT_TRANSITION_PRISM:return 4==(4&t);case r.kTransitionIds.PPT_TRANSITION_PAN:case r.kTransitionIds.PPT_TRANSITION_CONVEYOR:case r.kTransitionIds.PPT_TRANSITION_CROSSZOOM:case r.kTransitionIds.PPT_TRANSITION_FLYTHROUGH_CONTENT:case r.kTransitionIds.PPT_TRANSITION_DOORS_CONTENT:return!0}return!1},t.isTransitionDisabledUtil=a,t.isTransitionDisabled=function(e,t,i){if(t===r.kTransitionIds.PPT_TRANSITION_FADE)return!1;switch(t){case r.kTransitionIds.PPT_TRANSITION_CUT:return a(e,"Cut");case r.kTransitionIds.PPT_TRANSITION_BLINDS:return a(e,"Blinds");case r.kTransitionIds.PPT_TRANSITION_FADE_THROUGH_BLACK:return a(e,"FadeThroughBlack");case r.kTransitionIds.PPT_TRANSITION_PUSH:return a(e,"Push");case r.kTransitionIds.PPT_TRANSITION_PRISM:switch(!0){case i<4:return a(e,"Cube");case i<8:return a(e,"Rotate");case i<12:return a(e,"Box");case i<16:return a(e,"Orbit")}break;case r.kTransitionIds.PPT_TRANSITION_WIPE:case r.kTransitionIds.PPT_TRANSITION_STRIPS:return a(e,"Wipe");case r.kTransitionIds.PPT_TRANSITION_SPLIT:return a(e,"Split");case r.kTransitionIds.PPT_TRANSITION_ZOOM:case r.kTransitionIds.PPT_TRANSITION_DIAMOND:case r.kTransitionIds.PPT_TRANSITION_PLUS:case r.kTransitionIds.PPT_TRANSITION_CIRCLE:return a(e,"Shape");case r.kTransitionIds.PPT_TRANSITION_RANDOMBAR:return a(e,"RandomBars");case r.kTransitionIds.PPT_TRANSITION_COMB:return a(e,"Comb");case r.kTransitionIds.PPT_TRANSITION_DISSOLVE:return a(e,"Dissolve");case r.kTransitionIds.PPT_TRANSITION_RANDOM:return a(e,"Random");case r.kTransitionIds.PPT_TRANSITION_COVER:return a(e,"Cover");case r.kTransitionIds.PPT_TRANSITION_UNCOVER:return a(e,"Uncover");case r.kTransitionIds.PPT_TRANSITION_WHEEL:case r.kTransitionIds.PPT_TRANSITION_WHEELREVERSE:case r.kTransitionIds.PPT_TRANSITION_WEDGE:return a(e,"Wheel");case r.kTransitionIds.PPT_TRANSITION_RIPPLE:return a(e,"Ripple");case r.kTransitionIds.PPT_TRANSITION_DRAPE:return a(e,"Drape");case r.kTransitionIds.PPT_TRANSITION_CURTAINS:return a(e,"Curtains");case r.kTransitionIds.PPT_TRANSITION_WIND:return a(e,"Wind");case r.kTransitionIds.PPT_TRANSITION_PRESTIGE:return a(e,"Prestige");case r.kTransitionIds.PPT_TRANSITION_FRACTURE:return a(e,"Fracture");case r.kTransitionIds.PPT_TRANSITION_CRUSH:return a(e,"Crush");case r.kTransitionIds.PPT_TRANSITION_PEELOFF:return a(e,"PeelOff");case r.kTransitionIds.PPT_TRANSITION_PAGECURLSINGLE:case r.kTransitionIds.PPT_TRANSITION_PAGECURLDOUBLE:return a(e,"PageCurl");case r.kTransitionIds.PPT_TRANSITION_AIRPLANE:return a(e,"Airplane");case r.kTransitionIds.PPT_TRANSITION_ORIGAMI:return a(e,"Origami");case r.kTransitionIds.PPT_TRANSITION_CHECKER:return a(e,"Checker");case r.kTransitionIds.PPT_TRANSITION_VORTEX:return a(e,"Vortex");case r.kTransitionIds.PPT_TRANSITION_SWITCH:return a(e,"Switch");case r.kTransitionIds.PPT_TRANSITION_FALLOVER:return a(e,"FallOver");case r.kTransitionIds.PPT_TRANSITION_FLIP:return a(e,"Flip");case r.kTransitionIds.PPT_TRANSITION_GLITTER:return a(e,"Glitter");case r.kTransitionIds.PPT_TRANSITION_CROSSZOOM:return a(e,"RevealModern");case r.kTransitionIds.PPT_TRANSITION_PAN:return a(e,"Pan");case r.kTransitionIds.PPT_TRANSITION_GALLERY:return a(e,"GalleryIcon");case r.kTransitionIds.PPT_TRANSITION_CONVEYOR:return a(e,"Conveyor");case r.kTransitionIds.PPT_TRANSITION_FLYTHROUGH_CONTENT:return a(e,"Flythrough");case r.kTransitionIds.PPT_TRANSITION_FLYTHROUGH:case r.kTransitionIds.PPT_TRANSITION_ZOOM_WITH_SPIN:return a(e,"Zoom");case r.kTransitionIds.PPT_TRANSITION_DOORS:return a(e,"Doors");case r.kTransitionIds.PPT_TRANSITION_DOORS_CONTENT:return a(e,"Window")}return!0}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n}));let r={getBoolean:e=>!1,getNumber(e){},getString(e){}};function n(e){r=e}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{static load(e){r.m_settings=e}static readBooleanOrDefault(e,t){const i=void 0===r.m_settings?"":typeof r.m_settings[e];return"string"===i?"true"===r.m_settings[e].toLowerCase():"boolean"===i?r.m_settings[e]:t}static readNumberOrDefault(e,t){const i=void 0===r.m_settings?"":typeof r.m_settings[e];return"string"===i||"number"===i?Number(r.m_settings[e]):t}static readStringOrDefault(e,t){return void 0===r.m_settings||"string"!=typeof r.m_settings[e]?t:r.m_settings[e]}}},function(e,t,i){"use strict";i.r(t),i.d(t,"SlideShowRole",(function(){return n.b})),i.d(t,"NavigationType",(function(){return n.a})),i.d(t,"exposed",(function(){return a.b})),i.d(t,"setupGlobals_SlideShowCore",(function(){return a.c})),i.d(t,"SlideShowCore",(function(){return a.a})),i.d(t,"PrefetchAddon",(function(){return c})),i.d(t,"SlideAdvanceAddon",(function(){return u})),i.d(t,"PerfCheckerAddon",(function(){return f.a})),i.d(t,"InputsAddon",(function(){return m.a})),i.d(t,"AnimatedContentLogger",(function(){return p.a})),i.d(t,"SlideShowDataParser",(function(){return g.a})),i.d(t,"AnimationLoggerAddon",(function(){return _.a})),i.d(t,"TransitionLoggerAddon",(function(){return v.a})),i.d(t,"DefaultResourceProviders",(function(){return y.a})),i.d(t,"SlideShowInkAddon",(function(){return T})),i.d(t,"MediaAddon",(function(){return w.a})),i.d(t,"PrivateViewingAddon",(function(){return A})),i.d(t,"CameoWebcamAddon",(function(){return L}));var r,n=i(30),a=i(115),s=i(1),o=i(4),l=i(2),d=i(3),h=i(6);!function(e){e.Init="init",e.WebGLContextRestored="webglcontextrestored",e.PrefetchOnRefreshPodSession="prefetchOnRefreshPodSession",e.OnSlideLocationChanged="onSlideLocationChanged"}(r||(r={}));class c{constructor(e,t,i){if(this.m_isPrefetching=!1,this.m_slidesToPrefetch=[],this.m_forwardPrefetchCount=5,this.m_backwardPrefetchCount=5,this.m_forwardPrerenderCount=2,this.m_backwardPrerenderCount=2,this.m_symbol=Symbol("Init"),o.a.setLogger(t),this.m_slideshowCore=e,i&&(this.m_forwardPrefetchCount=i.forwardPrefechCount?i.forwardPrefechCount:this.m_forwardPrefetchCount,this.m_backwardPrefetchCount=i.backwardPrefechCount?i.backwardPrefechCount:this.m_backwardPrefetchCount,s.Settings.readBooleanOrDefault("prerenderWindowChange",!1)?(this.m_forwardPrerenderCount=s.Settings.readNumberOrDefault("forwardPrerenderCount",this.m_forwardPrerenderCount),this.m_backwardPrerenderCount=s.Settings.readNumberOrDefault("backwardPrerenderCount",this.m_backwardPrerenderCount)):(this.m_forwardPrerenderCount=i.forwardPrerenderCount?i.forwardPrerenderCount:this.m_forwardPrerenderCount,this.m_backwardPrerenderCount=i.backwardPrerenderCount?i.backwardPrerenderCount:this.m_backwardPrerenderCount)),s.Settings.readBooleanOrDefault("enablePrefetchOnInit",!1)?e.events.on("prefetchOnInit",e=>this.prefetchSlides(this.m_symbol,r.Init,e)):e.events.on("prefetchOnInit",()=>this.prefetchSlides(this.m_symbol,r.Init)),s.Settings.readBooleanOrDefault("enablePrefetchOnRefreshPodSession",!1)){const t=s.Settings.readNumberOrDefault("SSPrefetchOnRehydrateForwardCount",this.m_forwardPrefetchCount),i=s.Settings.readNumberOrDefault("SSPrefetchOnRehydrateBackwardCount",this.m_backwardPrefetchCount);e.events.on("prefetchOnRefreshPodSession",e=>this.prefetchSlides(this.m_symbol,r.PrefetchOnRefreshPodSession,e,t,i))}e.events.on("slideLocationChanged",()=>this.onSlideLocationChanged()),e.events.on("webglcontextrestored",()=>this.prefetchSlides(this.m_symbol,r.WebGLContextRestored))}onSlideLocationChanged(e){this.m_isPrefetching=!1,this.m_slidesToPrefetch=[],this.m_symbol=Symbol("Cancel"),this.prefetchSlides(this.m_symbol,r.OnSlideLocationChanged)}async prefetchSlides(e,t,i,n,a){this.m_slideshowCore.setMaxSceneCount(this.m_forwardPrerenderCount,this.m_backwardPrerenderCount);const c=i||this.m_slideshowCore.getSlideLocation();if(!c)return void o.a.sendTraceTag(592228697,l.a.msoulscat_Wac_PptSlideshow,d.a.Warning,"PrefetchAddon: undefined slide location in prefetchSlide.");const u=c.slideIndex;if(o.a.sendTraceTag(593827930,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,"PrefetchAddon::prefetchSlides - currentSlideIndex:"+u),-1===u)return;let f=n;h.ChangeGate.isChangeGateEnabled("SSPassPrefetchCountAsParam")&&null!=f||(f=h.ChangeGate.isChangeGateEnabled("PrefetchOnInitSlideAddition")&&t===r.Init?s.Settings.readNumberOrDefault("SSPrefetchOnInitForwardCount",this.m_forwardPrefetchCount):this.m_forwardPrefetchCount);for(let e=1;e<=f;e+=1)this.m_slidesToPrefetch.push({slideIndex:u+e});let m=a;h.ChangeGate.isChangeGateEnabled("SSPassPrefetchCountAsParam")&&null!=m||(m=this.m_backwardPrefetchCount);for(let e=1;e<=m;e+=1)u-e>=0&&this.m_slidesToPrefetch.push({slideIndex:u-e});if(h.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&this.m_slideshowCore.prefetchWindowRange&&(this.m_slideshowCore.prefetchWindowRange.last=u+this.m_forwardPrerenderCount,this.m_slideshowCore.prefetchWindowRange.first=Math.max(u-this.m_backwardPrerenderCount,0)),this.m_isPrefetching)return void o.a.sendTraceTag(508355611,l.a.msoulscat_Wac_PptSlideshow,d.a.Warning,"PrefetchAddon::prefetchSlides - return as already prefetch in progress. Current queue size :"+this.m_slidesToPrefetch.length);this.m_isPrefetching=!0;const p={source:t};for(;this.m_slidesToPrefetch.length>0&&e===this.m_symbol;){let e=!1;void 0!==this.m_slidesToPrefetch[0].slideIndex&&(this.m_slidesToPrefetch[0].slideIndex>u&&this.m_slidesToPrefetch[0].slideIndex-u<=this.m_forwardPrerenderCount||this.m_slidesToPrefetch[0].slideIndex<u&&u-this.m_slidesToPrefetch[0].slideIndex<=this.m_backwardPrerenderCount)&&(e=!0),await this.m_slideshowCore.prefetchSlide(this.m_slidesToPrefetch[0],e,p),this.m_slidesToPrefetch.shift()}this.m_isPrefetching=!1}}class u{constructor(e,t){this.c_noEventScheduled=-1,this.m_clickTimeEvents=[],this.m_slideLocationsAutoAdvanced=[],o.a.setLogger(t),this.m_slideshowCore=e,this.m_autoAdvanceEvent=this.c_noEventScheduled;for(let e=0;e<this.m_clickTimeEvents.length;e+=1)this.m_clickTimeEvents[e]=this.c_noEventScheduled;this.m_slideshowCore.events.on("slideLocationChanged",this.onSlideLocationChanged.bind(this)),this.m_slideshowCore.events.on("exitFromEndOfShow",()=>{o.a.sendTraceTag(590730571,l.a.msoulscat_Wac_PptSlideshow,d.a.Warning,"SlideAdvanceAddon:onAutoAdvanceTimer SlideLocations that used AutoAdvance:"+JSON.stringify(this.m_slideLocationsAutoAdvanced)),this.m_slideLocationsAutoAdvanced=[],this.m_autoAdvanceEvent=this.c_noEventScheduled;for(let e=0;e<this.m_clickTimeEvents.length;e+=1)this.m_clickTimeEvents[e]=this.c_noEventScheduled;this.m_prevSlideLocation=void 0,this.m_currentSlideLocation=void 0}),this.m_slideshowCore.events.on("stopAutoAdvance",()=>{this.cancelPendingAutoAdvance(),this.cancelPendingClickTimes()})}async onSlideLocationChanged(e){if(this.m_prevSlideLocation=this.m_currentSlideLocation,this.m_currentSlideLocation=this.m_slideshowCore.getSlideLocation(),!this.m_currentSlideLocation)return void o.a.sendTraceTag(590899074,l.a.msoulscat_Wac_PptSlideshow,d.a.Warning,"SlideAdvanceAddon: undefined slide location in onSlideLocationChanged.");if(this.cancelPendingAutoAdvance(),this.cancelPendingClickTimes(),this.m_prevSlideLocation&&this.m_currentSlideLocation.slideIndex<this.m_prevSlideLocation.slideIndex&&e.actionContext&&e.actionContext.navigationType!==n.a.GoTo&&e.actionContext.navigationType!==n.a.ClickTarget)return;const t=await this.m_slideshowCore.getSlideShowTimings(this.m_currentSlideLocation);if(t&&t.autoAdv){const e=1e3*t.autoAdvTime;this.scheduleAutoAdvance(e),t.clickTimes&&this.scheduleClickTimes(t.clickTimes)}}scheduleAutoAdvance(e){this.cancelPendingAutoAdvance(),this.m_autoAdvanceEvent=window.setTimeout(this.onAutoAdvanceTimer.bind(this),e)}scheduleClickTimes(e){this.cancelPendingClickTimes();let t=0;for(let i=0;i<e.length;i+=1)t+=e[i],this.m_clickTimeEvents[i]=window.setTimeout(this.onClickTimer.bind(this),t)}cancelPendingAutoAdvance(){this.m_autoAdvanceEvent!==this.c_noEventScheduled&&(window.clearTimeout(this.m_autoAdvanceEvent),this.m_autoAdvanceEvent=this.c_noEventScheduled)}cancelPendingClickTimes(){for(let e=0;e<this.m_clickTimeEvents.length;e+=1)this.m_clickTimeEvents[e]!==this.c_noEventScheduled&&(window.clearTimeout(this.m_clickTimeEvents[e]),this.m_clickTimeEvents[e]=this.c_noEventScheduled)}onAutoAdvanceTimer(){o.a.sendTraceTag(590899075,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,"SlideAdvanceAddon:onAutoAdvanceTimer Calling nextSlide from "+JSON.stringify(this.m_currentSlideLocation)),this.m_slideLocationsAutoAdvanced.push(this.m_currentSlideLocation),this.m_slideshowCore.nextSlide(!1)}onClickTimer(){this.m_slideshowCore.nextStep("0_anim",4)}}var f=i(125),m=i(168),p=i(80),g=i(85),_=i(169),v=i(170),y=i(165),b=i(124),S=i(142);class T{constructor(e,t,i,r,n){this.m_defaultLaserColor="#E3182D",this.inkAddonCore=new b.b(e,t,i,r,this.initInk.bind(this),this.slideChanged.bind(this),()=>!0);const a=e=>{"pen"===e.pointerType&&(window.removeEventListener("pointerover",a),this.inkAddonCore.m_inkCanvas||(this.inkAddonCore.metricHelper.boot("pen"),this.startDownloadingInkJs(this.inkAddonCore.onDownloadCompleted),o.a.sendTraceTag(593827279,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,"SlideShowInkAddon: Ink initialization triggered by pointerover.")))};n&&n.telemetryLogger&&(this.telemetryLogger=n.telemetryLogger),window.addEventListener("pointerover",a)}onInkManagerActivity(e){switch(e.item){case"Init":this.inkAddonCore.m_inkCanvas||(this.inkAddonCore.metricHelper.boot("menu"),this.startDownloadingInkJs(this.inkAddonCore.onDownloadCompleted),o.a.sendTraceTag(593827280,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,"SlideShowInkAddon: Ink initialization triggered by ink button."));break;case"Pen":this.selectPen(e.color);break;case"Highlighter":this.selectHighlighter(e.color);break;case"Eraser":this.inkAddonCore.selectEraser();break;case"None":this.inkAddonCore.selectNone();break;case"EraseAll":this.inkAddonCore.eraseAll();break;case"SetColor":this.setColor(e.color);break;case"Laser":this.selectLaser()}}setColor(e){this.inkAddonCore.m_inkCanvas&&(this.inkAddonCore.m_inkCanvas.setColor(e),o.a.sendTraceTag(593827281,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,"SlideShowInkAddon: setColor called with color: "+e))}selectPen(e){this.inkAddonCore.m_inkCanvas&&(this.inkAddonCore.m_inkCanvas.enableTouchMouse(),this.inkAddonCore.m_inkCanvas.setColor(e),this.inkAddonCore.m_inkCanvas.selectPen(),o.a.sendTraceTag(593827282,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,"SlideShowInkAddon: selectPen called with color: "+e))}selectHighlighter(e){this.inkAddonCore.m_inkCanvas&&(this.inkAddonCore.m_inkCanvas.enableTouchMouse(),this.inkAddonCore.m_inkCanvas.setColor(e),this.inkAddonCore.m_inkCanvas.selectHighlighter(),o.a.sendTraceTag(593827283,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,"SlideShowInkAddon: selectHighlighter called with color: "+e))}selectLaser(e=this.m_defaultLaserColor){this.inkAddonCore.m_inkCanvas&&(this.inkAddonCore.m_inkCanvas.enableTouchMouse(),this.inkAddonCore.m_inkCanvas.setLaserColor(e),this.inkAddonCore.m_inkCanvas.selectLaser(),o.a.sendTraceTag(520229444,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,"SlideShowInkAddon: selectLaser called"))}startDownloadingInkJs(e){if(null!=window.slideshowink)return o.a.sendTraceTag(593827286,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,"SlideShowInkAddon: slideshowink.js is loaded to the window, no download needed."),this.inkAddonCore.updateDimensions(),void this.initInk();this.inkAddonCore.isInkJsDownloading||(o.a.sendTraceTag(593827287,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,"SlideShowInkAddon: Start downloading slideshowink.js"),this.inkAddonCore.isInkJsDownloading=!0,this.inkAddonCore.loadInkJsCallback().then(()=>{e()}).catch(e=>{this.inkAddonCore.onDownloadFailed(e)}))}resetInkCanvas(){return this.inkAddonCore.resetInkCanvas()}initInk(){if(this.inkAddonCore.m_inkCanvas)return;try{slideshowink.inkCanvasFactoryGlobal.setLogger(new b.a),this.telemetryLogger&&slideshowink.inkCanvasFactoryGlobal.setActivityLogger(new S.a({telemetryLogger:this.telemetryLogger}));const e=slideshowink.inkCanvasFactoryGlobal.createSlideShowInkCanvasSmoothed(this.inkAddonCore.inkContainer,this.inkAddonCore.parent);this.inkAddonCore.isShowingBlankSlide||e.start(),this.inkAddonCore.m_inkCanvas=e}catch(e){o.a.sendTraceTag(593827290,l.a.msoulscat_Wac_PptSlideshow,d.a.Error,"SlideShowInkAddon: inkCanvas initialization error: "+JSON.stringify(e))}o.a.sendTraceTag(593827291,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,"SlideShowInkAddon: inkCanvas initialized."),this.inkAddonCore.registerAppEventListeners();const e=this.inkAddonCore.slideshowCore.getSlideLocation();e&&this.slideChanged(e),this.inkAddonCore.updateInkCanvasDimensions(),window.removeEventListener("pointerdown",this.inkAddonCore.onPointerDown),o.a.sendTraceTag(593827292,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,`SlideShowInkAddon: inkCanvas initialization from: ${this.inkAddonCore.metricHelper.getSource().toString()} in time: ${this.inkAddonCore.metricHelper.timeDiff()} with lost stroke count: ${this.inkAddonCore.metricHelper.getLostStrokeCount()}`)}slideChanged(e){this.inkAddonCore.m_inkCanvas&&this.inkAddonCore.m_inkCanvas.slideChanged(e.slideIndex)}}var w=i(122),M=i(141),C=i(19),I=i(41),P=i(20),E=i(164),x=i(54);class A{constructor(e,t,i,r,n,a,s,h,c,u,f){this.m_privateViewingEnabled=!1,this.m_isUserPrivatelyZooming=!1,o.a.setLogger(r),this.m_slideshowCore=e,this.m_slideShowAppEvents=t,this.m_slideshowRole=i,this.m_slideShowUIEvents=c,this.m_globalAppStateManager=u,a&&h||o.a.sendTraceTag(556017049,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,"PrivateViewingAddon - No initial slide location given"),this.m_localState=x.a.toSyncState({slideId:s,slideIndex:h},a),this.m_globalState=f||this.m_localState;const m={goToSyncState:this.goToSyncState.bind(this),isInPrivateViewingChanged:this.isInPrivateViewingChanged.bind(this,P.b.SyncStateManager),isInPrivateViewing:this.isInPrivateViewing.bind(this),hadPreviousUserInput:this.hadPreviousUserInput.bind(this),getGlobalState:this.getGlobalState.bind(this),areSyncStatesEqual:x.a.areSyncStatesEqual.bind(this)};this.m_clockSkewCalculator=n,this.m_privateViewingManager=new M.PrivateViewingManager,this.m_privateViewingManager.init({loggableFeatureName:"PPT_SSApp"},m,r),this.registerSlideShowUIEvents(),this.m_slideShowAppEvents.on("slideLocationChanged",()=>{this.localStateChanged("slideLocationChanged")}),this.m_slideShowAppEvents.on("animationStateChanged",()=>{this.localStateChanged("animationStateChanged")}),this.m_slideShowAppEvents.on("requestPrivateViewingChanged",e=>{this.m_privateViewingEnabled&&this.isInPrivateViewingChanged(e.source,e.isInPrivateViewing)}),this.m_slideShowAppEvents.on("globalStateChanged",async e=>{if(e){if(this.m_slideshowRole!==C.a.Presenter){const t=e[0],i=2===e.length?e[1]:void 0,r=x.a.toSyncState(t,i);this.m_globalState=r,this.m_privateViewingEnabled?(await this.m_privateViewingManager.globalStateChanged(this.m_globalState),this.m_slideShowUIEvents&&t.slideIndex&&this.m_slideShowUIEvents.emit("presenterSlideStateChanged",t.slideIndex)):o.a.sendTraceTag(537536651,l.a.msoulscat_Wac_PptSlideshow,d.a.Warning,"PrivateViewingAddon - private viewing is not enabled")}}else o.a.sendTraceTag(554958872,l.a.msoulscat_Wac_PptSlideshow,d.a.Error,"PrivateViewingAddon - globalStateChanged called but wasn't passed in any args")}),this.m_slideShowAppEvents.on("returnToPresenter",()=>{this.returnToPresenter()}),this.m_slideShowAppEvents.on("isUserPrivatelyZooming",e=>{this.m_isUserPrivatelyZooming=e})}getGlobalState(){return this.m_globalState}localStateChanged(e){const t=this.m_slideshowCore.getSlideLocation(),i=this.m_slideshowCore.getAnimationState(!0);if(!t)return void o.a.sendTraceTag(556102994,l.a.msoulscat_Wac_PptSlideshow,d.a.Warning,"PrivateViewingAddon - No slideLocation was returned from getSlideLocation but recieved event slideLocationChanged");i||o.a.sendTraceTag(555874514,l.a.msoulscat_Wac_PptSlideshow,d.a.Warning,"PrivateViewingAddon - No animationState was returned from getAnimationState but recieved event animationStateChanged");const r=x.a.toSyncState(t,i);this.m_slideshowRole===C.a.Presenter?this.m_globalState=r:(this.m_privateViewingEnabled||this.m_slideshowRole===C.a.PrivateViewing)&&(this.m_localState&&"slideLocationChanged"===e&&t.slideIndex===x.a.syncStateToSlideLocation(this.m_localState).slideIndex?o.a.sendTraceTag(554206281,l.a.msoulscat_Wac_PptSlideshow,d.a.Error,`PrivateViewingAddon - slideLocationChanged event fired even when slideIndex not changed; slideIndex: ${t.slideIndex};`):this.m_privateViewingManager.localStateChanged(r,e)),this.m_localState=r,this.saveLocalStateToAppStateManager()}returnToPresenter(){if(this.m_localState){if(I.a.trackTeamsPVMetrics({action:"returnToPresenter",slideIndex:x.a.syncStateToSlideLocation(this.m_globalState).slideIndex},this.m_clockSkewCalculator.sessionUTC),s.Settings.readBooleanOrDefault("allowUserToPrivatelyZoom",!1)&&!this.isInPrivateViewing()&&this.m_isUserPrivatelyZooming)return;this.m_privateViewingManager.returnToPresenter(this.m_localState)}else o.a.sendTraceTag(553784714,l.a.msoulscat_Wac_PptSlideshow,d.a.Error,"PrivateViewingAddon - returnToPresenter called with undefined m_localState.")}onPrivateViewingToggled(e){this.m_privateViewingEnabled!==e?(this.m_privateViewingEnabled=e,o.a.sendTraceTag(537536652,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,"PrivateViewingAddon - private viewing toggled to "+(e?"enabled":"disabled")),e||this.m_slideshowRole!==C.a.PrivateViewing||this.returnToPresenter()):o.a.sendTraceTag(545337759,l.a.msoulscat_Wac_PptSlideshow,d.a.Error,"PrivateViewingAddon - private viewing toggle value did not change. It is still "+(e?"enabled":"disabled"))}async goToSyncState(e){if(this.m_slideshowRole===C.a.Presenter)return void o.a.sendTraceTag(556102995,l.a.msoulscat_Wac_PptSlideshow,d.a.Warning,`PrivateViewingAddon - gotoSyncState was called by a presenter. SyncState = ${JSON.stringify(e)}.`);const t=x.a.syncStateToSlideLocation(e),i={animationState:x.a.syncStateToAnimationState(e),fForceRetry:!0},r=await this.m_slideshowCore.gotoSlide(t,i);r&&r.fSucceeded?(this.m_localState=e,this.syncMediaStates(t.slideId,t.slideIndex),o.a.sendTraceTag(554055433,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,`PrivateViewingAddon - gotoSlide succeeded. SyncState = ${JSON.stringify(e)}.`)):o.a.sendTraceTag(554771489,l.a.msoulscat_Wac_PptSlideshow,d.a.Error,`PrivateViewingAddon - gotoSlide failed with error ${r.error}. SyncState = ${JSON.stringify(e)}.`)}hadPreviousUserInput(e){let t=!0;return"slideLocationChanged"!==e&&"animationStateChanged"!==e||(t=I.a.hadPreviousUserInput(this.m_clockSkewCalculator.sessionUTC),o.a.sendTraceTag(554055434,l.a.msoulscat_Wac_PptSlideshow,d.a.Info,`PrivateViewingAddon - hadPreviousUserInput: ${t}.`)),t}isInPrivateViewing(){return this.m_slideshowRole===C.a.PrivateViewing}isPresenting(){return this.m_slideshowRole===C.a.Presenter}isInPrivateViewingChanged(e,t){let i=!1;const r=this.m_slideshowRole;if(this.m_slideshowRole===C.a.Attendee&&t)this.m_slideShowAppEvents.emit("roleChanged",C.a.PrivateViewing),this.m_slideShowAppEvents.emit("roleChangedOutbound",C.a.PrivateViewing),i=!0,I.a.trackTeamsPVMetrics({action:"enterPrivateViewing",source:e},this.m_clockSkewCalculator.sessionUTC);else if(this.m_slideshowRole===C.a.PrivateViewing&&!t){this.m_slideShowAppEvents.emit("roleChanged",C.a.Attendee),this.m_slideShowAppEvents.emit("roleChangedOutbound",C.a.Attendee);let e=this.m_slideshowCore.getSlideLocation();e&&e.slideId&&this.syncMediaStates(e.slideId,e.slideIndex),i=!0,I.a.trackTeamsPVMetrics({action:"leavePrivateViewing"},this.m_clockSkewCalculator.sessionUTC)}o.a.sendTraceTag(556910745,l.a.msoulscat_Wac_PptSlideshow,i?d.a.Info:d.a.Error,`PrivateViewingAddon - privateViewingChangedTo: ${t?"true":"false"}. Successful: ${i?"true":"false"}. Role before was: ${r}. Source: ${e}`)}syncMediaStates(e,t){this.m_slideShowAppEvents.emit("returnToPresenterUpdateAllMedia",{slideId:e,slideIndex:t})}registerSlideShowUIEvents(){this.m_slideShowUIEvents&&(this.m_slideShowUIEvents.on("setPrivateViewingToggle",e=>{this.onPrivateViewingToggled(e)}),this.m_slideShowUIEvents.on("privateViewingToggled",e=>{this.onPrivateViewingToggled(e)}),this.m_slideShowUIEvents.on("roleChanged",e=>{e===C.a.Presenter&&(this.m_privateViewingManager.resetPrivateViewingManager(),this.m_slideshowRole===C.a.PrivateViewing&&I.a.trackTeamsPVMetrics({action:"leavePrivateViewing"},this.m_clockSkewCalculator.sessionUTC)),this.m_slideshowRole=e,this.saveLocalStateToAppStateManager()}))}saveLocalStateToAppStateManager(){if(this.m_localState){const e={role:this.m_slideshowRole,currentSyncState:x.a.syncStateToSlideLocation(this.m_localState),currentAnimationState:x.a.syncStateToAnimationState(this.m_localState),globalSyncState:x.a.syncStateToSlideLocation(this.m_globalState),globalAnimationState:x.a.syncStateToAnimationState(this.m_globalState)};this.m_globalAppStateManager&&this.m_globalAppStateManager.updateGlobalState(E.a.PrivateViewingAddon,e)}}set slideShowUIEvents(e){e&&(this.m_slideShowUIEvents=e,this.registerSlideShowUIEvents())}get slideShowUIEvents(){return this.m_slideShowUIEvents}}var k=i(140),R=i(51);class O{async startMediaCaptureAsync(e){return this.mediaStream=await navigator.mediaDevices.getUserMedia({video:{deviceId:e.deviceId,width:e.width,height:e.height,frameRate:e.frameRate},audio:!1}),this.streamInitializationStatus()}stopMediaCapture(){if(this.mediaStream){for(const e of this.mediaStream.getTracks())e.stop();this.mediaStream=void 0}}get stream(){return this.mediaStream}pauseMediaCapture(){this.setMediaEnabled(!1)}resumeMediaCapture(){this.setMediaEnabled(!0)}setMediaEnabled(e){if(this.mediaStream)for(const t of this.mediaStream.getTracks())t.enabled=e}streamInitializationStatus(){return this.mediaStream?0===this.mediaStream.getVideoTracks().length?R.a.ErrorNoVideoTracks:R.a.ErrorNone:R.a.ErrorStreamStartFailure}}class L{constructor(e,t){this.m_toggledOn=!1,this.m_cameoDetectedNearby=!1,this.m_defaultCameraLabel="",this.m_slideshowCore=e,this.m_mediaStreamClientConfig={id:"cameo-webcam",source:new O,videoConstraints:{}},this.m_mediaStreamClient=new k.a(this.m_mediaStreamClientConfig),this.m_notificationCallback=t&&t.notificationCallback,this.registerCoreEventListeners()}get isActive(){return this.m_toggledOn&&this.m_cameoDetectedNearby}setCameraState(e){this.m_toggledOn=e,this.updateCameoState()}updateWebcamDevice(e,t){if(!e)return void o.a.sendTraceTag(509641865,l.a.msoulscat_Wac_PptSession,d.a.Error,"CameoWebcamAddon::updateWebcamDevice: Invalid deviceId");const i={exact:e};let r={deviceId:i};t&&t.facingMode&&("user"===t.facingMode||"environment"===t.facingMode)&&(r={deviceId:i,facingMode:{exact:t.facingMode}}),this.m_mediaStreamClient.isActive?this.startMediaCaptureAsync(r,!0):this.m_mediaStreamClient.updateConstraints(r,!0)}getDefaultCameraLabel(){return this.m_defaultCameraLabel}getActiveCameraLabel(){if(this.m_mediaStreamClient&&this.m_mediaStreamClient.isActive){const e=this.m_mediaStreamClient.VideoElement.srcObject.getVideoTracks()[0];if(e)return e.label}return""}registerCoreEventListeners(){this.m_slideshowCore.events.on("slideLocationChanged",this.onSlideLocationChanged.bind(this)),this.m_slideshowCore.events.on("logSessionEnd",this.onSlideShowSessionEnd.bind(this))}onSlideLocationChanged(){const e=this.isActive;this.isCameoDetectedNearbyAsync().then(t=>{this.m_cameoDetectedNearby=t,e!==this.isActive&&this.updateCameoState()})}onSlideShowSessionEnd(){this.m_cameoDetectedNearby=!1}updateCameoState(){this.m_slideshowCore.isCameoActive=this.isActive,o.a.sendTraceTag(509641864,l.a.msoulscat_Wac_PptSession,d.a.Info,`CameoWebcamAddon::updateCameoState: isActive=${this.isActive}, toggledOn=${this.m_toggledOn}, isCameoDetectedNearby=${this.m_cameoDetectedNearby}`),this.isActive?(o.a.sendTraceTag(508842192,l.a.msoulscat_Wac_PptSession,d.a.Info,"CameoWebcamAddon::updateCameoState: starting webcam capture"),this.startMediaCaptureAsync()):(this.clearCameo(),this.stopMediaCapture())}async isCameoDetectedNearbyAsync(){return!!this.m_slideshowCore&&this.m_slideshowCore.isCameoDetectedNearbyAsync()}clearCameo(){this.m_slideshowCore&&this.m_slideshowCore.clearCameo()}async startMediaCaptureAsync(e,t=!1){try{const i=await this.m_mediaStreamClient.startMediaCaptureAsync(e,t);i===R.a.ErrorNone?(this.setCameoVideoElement(this.m_mediaStreamClient.VideoElement),""===this.m_defaultCameraLabel&&(this.m_defaultCameraLabel=this.getActiveCameraLabel()),this.m_notificationCallback&&this.m_notificationCallback("CameraStarted","Streaming"),o.a.sendTraceTag(508180175,l.a.msoulscat_Wac_PptSession,d.a.Info,"CameoWebcamAddon::startMediaCaptureAsync: success")):(o.a.sendTraceTag(508684509,l.a.msoulscat_Wac_PptSession,d.a.Error,"CameoWebcamAddon::startMediaCapture : MediaStreamClient startMediaCapture failed with error="+i),this.m_notificationCallback&&this.m_notificationCallback(i,"Error"))}catch(e){if(o.a.sendTraceTag(509641863,l.a.msoulscat_Wac_PptSession,d.a.Error,"CameoWebcamAddon::startMediaCapture : MediaStreamClient startMediaCapture threw error="+e),this.m_toggledOn=!1,this.updateCameoState(),this.m_mediaStreamClient.resetToOriginalConstraints(),this.m_notificationCallback){const t=e.toString();t&&"string"==typeof t?this.m_notificationCallback(t,"Error"):this.m_notificationCallback("unknown","Error")}}}stopMediaCapture(){this.m_mediaStreamClient.stopMediaCapture()}setCameoVideoElement(e){e?this.m_slideshowCore&&this.m_slideshowCore.setCameoVideoElement(e):o.a.sendTraceTag(509641862,l.a.msoulscat_Wac_PptSession,d.a.Error,"CameoWebcamAddon::setCameoVideoElement : MediaStreamClient VideoElement is missing")}}},function(e,t,i){"use strict";i.d(t,"j",(function(){return d})),i.d(t,"b",(function(){return h})),i.d(t,"l",(function(){return u})),i.d(t,"k",(function(){return f})),i.d(t,"a",(function(){return p})),i.d(t,"m",(function(){return _})),i.d(t,"f",(function(){return v})),i.d(t,"d",(function(){return y})),i.d(t,"c",(function(){return b})),i.d(t,"e",(function(){return S})),i.d(t,"h",(function(){return T})),i.d(t,"i",(function(){return w})),i.d(t,"g",(function(){return M}));var r=i(0),n=i(5),a=i(61),s=(i(7),i(22)),o=i(16),l=i(14);class d{constructor(e,t){this.start=e,this.length=t}get last(){return this.start+this.length-1}equals(e){return this.start==e.start&&this.length==e.length}includes(e){return e>=this.start&&e<=this.last}intersects(e){return this.start<=e.last&&this.last>=e.start}contains(e){return this.start<=e.start&&e.last<=this.last}getIntersection(e){const t=d.FromFirstLast(Math.max(this.start,e.start),Math.min(this.last,e.last));return t.length>=0?t:void 0}move(e){return new d(this.start+e,this.length)}static FromFirstLast(e,t){return new d(e,t+1-e)}}class h{constructor(e){this.m_defaultData=e}onDataChange(){}onRangeChange(){}onDataRemoved(e){}onDataAdded(e){}get defaultData(){return this.m_defaultData}get ranges(){const e=[];for(let t of this.m_dataPerRange||[])e.push(t.range);return e}get allData(){const e=[this.m_defaultData];for(let t of this.m_dataPerRange||[])e.push(t.data);return e}get dataPerRange(){return this.m_dataPerRange||[]}set defaultData(e){this.m_defaultData=e}set(e,t){if(this.onDataChange(),t){for(let i of this.m_dataPerRange||[])if(i.range.start==t.start&&i.range.last==t.last)return this.onDataRemoved(i.data),i.data=e,void this.onDataAdded(i.data);for(let e of this.m_dataPerRange||[])this.onDataRemoved(e.data);this.onRangeChange();const i=[];let r=!1;for(let n of this.m_dataPerRange||[])n.range.start<t.start&&i.push({range:d.FromFirstLast(n.range.start,Math.min(n.range.last,t.start-1)),data:n.data}),t.last<n.range.last&&(r||(i.push({range:t,data:e}),r=!0),i.push({range:d.FromFirstLast(Math.max(n.range.start,t.last+1),n.range.last),data:n.data}));r||i.push({range:t,data:e}),this.m_dataPerRange=i;for(let e of this.m_dataPerRange||[])this.onDataAdded(e.data)}else{for(let e of this.m_dataPerRange||[])this.onDataRemoved(e.data);this.m_defaultData=e,this.m_dataPerRange=void 0}}getAt(e){for(let t of this.m_dataPerRange||[])if(t.range.start<=e&&e<=t.range.last)return t.data;return this.m_defaultData}shiftIndices(e,t){if(this.m_dataPerRange){const i=[],r=t-e.length;for(let n of this.m_dataPerRange)if(e.contains(n.range)&&e.start!=n.range.start)this.onDataRemoved(n.data);else if(n.range.includes(e.start)){const r=Math.min(e.length,n.range.last+1-e.start);i.push({range:new d(n.range.start,n.range.length+t-r),data:n.data})}else n.range.start<=e.last&&e.last<=n.range.last?i.push({range:d.FromFirstLast(e.start+t,n.range.last+r),data:n.data}):e.last<n.range.start?i.push({range:n.range.move(r),data:n.data}):i.push(n);this.m_dataPerRange=i}}}class c extends h{constructor(e){super(e),this.m_changeTracker=new o.a,this.m_rangeChangeTracker=new o.a,this.m_changeTracker.replaceListener(void 0,e)}get changeTracker(){return this.m_changeTracker}get rangeChangeTracker(){return this.m_rangeChangeTracker}onDataChange(){this.m_changeTracker.notifyChange()}onRangeChange(){this.rangeChangeTracker.notifyChange()}onDataRemoved(e){o.a.RemoveListener(e.changeTracker,this.m_changeTracker)}onDataAdded(e){o.a.AddListener(e.changeTracker,this.m_changeTracker)}}class u{constructor(e,t,i,r){this.m_changeTracker=new o.a,this.m_type=e,this.m_verticalCenter=t,this.m_thickness=i,this.style=r}clone(){return new u(this.m_type,this.m_verticalCenter,this.m_thickness,this.m_style?this.m_style.clone():void 0)}get type(){return this.m_type}get verticalCenter(){return this.m_verticalCenter}get thickness(){return this.m_thickness}get style(){return this.m_style}get changeTracker(){return this.m_changeTracker}set type(e){Object(l.a)(this.changeTracker,this.m_type,e),this.m_type=e}set verticalCenter(e){Object(l.a)(this.changeTracker,this.m_verticalCenter,e),this.m_verticalCenter=e}set thickness(e){Object(l.a)(this.changeTracker,this.m_thickness,e),this.m_thickness=e}set style(e){this.changeTracker.replaceListener(this.m_style,e),this.m_style=e}}class f{constructor(e,t,i=!1){this.m_changeTracker=new o.a,this.m_animationTransform=t,this.m_isHidden=i,this.fade=e}clone(){return new f(this.m_fade?this.m_fade.clone():void 0,this.m_animationTransform)}equals(e){return(this.m_fade==e.m_fade||null!=this.m_fade&&null!=e.m_fade&&this.m_fade.equals(e.m_fade))&&(this.m_animationTransform==e.m_animationTransform||null!=this.m_animationTransform&&null!=e.m_animationTransform&&this.m_animationTransform.equals(e.m_animationTransform))&&this.m_isHidden==e.m_isHidden}get fade(){return this.m_fade}get animationTransform(){return this.m_animationTransform}get isHidden(){return!!this.m_isHidden}get changeTracker(){return this.m_changeTracker}set fade(e){this.m_changeTracker.replaceListener(this.m_fade,e),this.m_fade=e}set animationTransform(e){Object(l.c)(this.m_changeTracker,this.m_animationTransform,e),this.m_animationTransform=e}set isHidden(e){e!=this.isHidden&&(this.m_changeTracker.notifyChange(),this.m_isHidden=e)}}const m=new r.b(0,-1,0,1,0,0,0,0,1);class p{constructor(e,t,i,r,n,a){this.lineRect=e,this.path=t,this.alignment=i,this.scale=r,this.pivot=n,this.isVerticalLayout=a,this.pathLength=t.measureLength(),this.equivalentWarpingEnvelope=this.calculateEquivalentWarpingEnvelope()}equals(e){return this.lineRect.equals(e.lineRect)&&this.path==e.path&&this.alignment==e.alignment&&this.scale==e.scale&&this.pivot==e.pivot&&this.isVerticalLayout==e.isVerticalLayout}getPathPosition(e){const t=this.isVerticalLayout?e.transformedBounds(m):e,i=this.isVerticalLayout?this.lineRect.transformedBounds(m):this.lineRect;if(!t||!i)return;const r=i.width;let n=0;if(r*this.scale<this.pathLength){const e=this.pathLength-r*this.scale;n=this.alignment*(e/this.pathLength)}const a=(t.left-i.left)*this.scale/this.pathLength+n;return(a+(a+t.width/this.pathLength*this.scale))/2}getTransform(e){const t=this.getPathPosition(e),i=this.isVerticalLayout?e.transformedBounds(m):e;if(!t||!i)return;const n=Object(r.g)(t,0,1)*this.pathLength,a=this.path.getPointFromDist(n),s=this.path.getTangentFromDist(n);if(!s)return;const o=(i.left+i.right)/2,l=i.top+i.height*this.pivot;let d=r.b.Translation2D(new r.e(-o,-l));d=d.multiply(r.b.Scale2D(new r.e(this.scale,this.scale)));const h=s.x,c=s.y;return d=d.multiply(new r.b(h,c,0,-c,h,0,0,0,1)),d=d.multiply(r.b.Translation2D(a)),this.isVerticalLayout&&(d=m.multiply(d)),d}calculateEquivalentWarpingEnvelope(){const e=new s.b,t=new s.b,i=this.isVerticalLayout?0:this.lineRect.height/2,n=this.isVerticalLayout?this.lineRect.top:this.lineRect.left,a=this.isVerticalLayout?this.lineRect.bottom:this.lineRect.right;let o=this.lineRect;for(let s=0;s<=1;s+=1/256){const l=n+(a-n)*s,d=this.isVerticalLayout?new r.c(this.lineRect.right,l-i,this.lineRect.left,l+i):new r.c(l-i,this.lineRect.top,l+i,this.lineRect.bottom),h=this.getPathPosition(d);if(null!=h&&h>=0&&h<=1){const n=l+(2*s-1)*i,a=this.getTransform(d);if(a){const i=a.transformPoint(this.isVerticalLayout?new r.e(d.left,n):new r.e(n,d.top)),s=a.transformPoint(this.isVerticalLayout?new r.e(d.right,n):new r.e(n,d.bottom));0==e.getPointCount()?(e.moveToPoint(i),t.moveToPoint(s),o=new r.c(this.isVerticalLayout?o.left:n,this.isVerticalLayout?n:o.top,o.right,o.bottom)):(e.lineToPoint(i),t.lineToPoint(s),o=new r.c(o.left,o.top,this.isVerticalLayout?o.right:n,this.isVerticalLayout?n:o.bottom))}}}return new _(o,e.createFigure(),t.createFigure(),this.isVerticalLayout)}}class g{constructor(e){this.currentX=0,this.currentY=0,this.m_samplesX=new Float32Array(257),this.m_samplesY=new Float32Array(257);const t=e.measureLength();for(let i=0;i<=256;i++){const r=e.getPointFromDist(t*i/256);this.m_samplesX[i]=r.x,this.m_samplesY[i]=r.y}}moveTo(e){const t=Math.floor(256*e),i=Math.min(t+1,256),r=256*e-t;this.currentX=this.m_samplesX[t]*(1-r)+this.m_samplesX[i]*r,this.currentY=this.m_samplesY[t]*(1-r)+this.m_samplesY[i]*r}equals(e){for(let t=0;t<=256;t++)if(this.m_samplesX[t]!=e.m_samplesX[t]||this.m_samplesY[t]!=e.m_samplesY[t])return!1;return!0}}class _{constructor(e,t,i,r=!1){this.sourceRect=e,this.topPath=t,this.bottomPath=i,this.isVerticalLayout=r,this.topCurve=new g(t),this.bottomCurve=new g(i)}equals(e){return this.sourceRect.equals(e.sourceRect)&&this.topCurve.equals(e.topCurve)&&this.bottomCurve.equals(e.bottomCurve)&&this.isVerticalLayout==e.isVerticalLayout}warpPoint(e){const t=Object(r.g)(this.isVerticalLayout?(e.y-this.sourceRect.top)/this.sourceRect.height:(e.x-this.sourceRect.left)/this.sourceRect.width,0,1),i=Object(r.g)(this.isVerticalLayout?1-(e.x-this.sourceRect.left)/this.sourceRect.width:(e.y-this.sourceRect.top)/this.sourceRect.height,0,1);return this.topCurve.moveTo(t),this.bottomCurve.moveTo(t),new r.e(Object(r.n)(this.topCurve.currentX,this.bottomCurve.currentX,i),Object(r.n)(this.topCurve.currentY,this.bottomCurve.currentY,i))}warpPath(e){const t=[],i=Math.max(this.sourceRect.width)/4,n=r.b.FromTransforms(e.transform);for(let a of e.figures)if(a.getPointCount()>0){const e=new s.b;e.moveToPoint(this.warpPoint(a.getPoint(0).transformPoint(n))),a.forEachSegment((t,a,s)=>{const o=a||r.e.InterpolateLinear(t,s,.5),l=i>0?Math.max(1,Math.ceil(Math.abs(s.x-t.x)/i)):1;for(let i=0;i<l;i++){const a=this.warpPoint(r.e.InterpolateQuadratic(t,o,s,i/l).transformPoint(n)),d=this.warpPoint(r.e.InterpolateQuadratic(t,o,s,(i+.5)/l).transformPoint(n)),h=this.warpPoint(r.e.InterpolateQuadratic(t,o,s,(i+1)/l).transformPoint(n)),c=d.add(d.subtract(r.e.InterpolateLinear(a,h,.5)));e.quadBezierToPoint(c,h)}return!0}),a.isClosed&&e.close(),t.push(e.createFigure())}return new s.c({figures:t,fillMode:e.fillMode,lineEnabled:e.lineEnabled,extrusionEnabled:e.extrusionEnabled,transform:void 0})}}class v{constructor(e,t,i,r){this.image=e,this.rect=t,this.transform=i,this.useLocalCordinates=!!r}equals(e){return this.image==e.image&&this.rect==e.rect}}class y{constructor(e,t,i,r,n,a){this.layoutBounds=e,this.paths=t instanceof Array?t.slice(0):t,this.outlinePath=a instanceof Array?a.slice(0):a,this.forceWarping=i,this.isWhiteSpace=r,this.textImage=n}equals(e){if(!this.layoutBounds.equals(e.layoutBounds))return!1;if(!this.paths&&!e.paths)return!0;if(this.paths instanceof s.c&&e.paths instanceof s.c)return this.paths.equals(e.paths);if(this.paths instanceof Array&&e.paths instanceof Array){if(this.paths.length!=e.paths.length)return!1;for(let t=0;t<this.paths.length;t++)if(!this.paths[t].equals(e.paths[t]))return!1;return!0}return!this.paths&&!e.paths}getTranslatedCopy(e){let t=void 0;if(this.paths instanceof s.c)t=new s.c(this.paths,this.paths.transform.applyTranslationAfter(e));else if(this.paths){t=new Array(this.paths.length);for(let i=0;i<this.paths.length;i++)t[i]=new s.c(this.paths[i],this.paths[i].transform.applyTranslationAfter(e))}return new y(this.layoutBounds.translate(e),t,this.forceWarping)}}class b{constructor(e,t,i,r){this.m_changeTracker=new o.a,this.m_character=e,this.style=t,this.effects=i,this.strokes=r}clone(){const e=new b(this.m_character,this.m_style?this.m_style.clone():void 0,this.m_effects?this.m_effects.clone():void 0);if(this.m_strokes){e.m_strokes=new o.b;for(let t of this.m_strokes.elements)e.m_strokes.push(t.clone())}return e}get character(){return this.m_character}get style(){return this.m_style}get effects(){return this.m_effects}get strokes(){return this.m_strokes}get changeTracker(){return this.m_changeTracker}set character(e){this.m_character.equals(e)||(this.m_changeTracker.notifyChange(),this.m_character=e)}set style(e){this.m_changeTracker.replaceListener(this.m_style,e),this.m_style=e}set effects(e){this.m_changeTracker.replaceListener(this.m_effects,e),this.m_effects=e}set strokes(e){this.m_changeTracker.replaceListener(this.m_strokes,e),this.m_strokes=e}equals(e){return!!this.m_character.equals(e.m_character)&&this.m_style==e.m_style&&this.m_effects==e.effects&&this.m_strokes==e.m_strokes}}class S{constructor(e,t,i){this.ascent=e,this.descent=t,this.fontHeightInPoints=i}equals(e){return this.ascent==e.ascent&&this.descent==e.descent&&this.fontHeightInPoints==e.fontHeightInPoints}}class T{constructor(e,t){this.m_changeTracker=new o.a,this.m_characters=[],this.m_localRange=e,this.m_layoutBounds=t,this.m_fillBounds=t,this.m_offset=r.e.Zero}clone(){const e=new T(this.m_localRange,this.m_layoutBounds);for(let t of this.m_characters)e.addCharacter(t);return e.m_offset=this.m_offset,e.m_fillBounds=this.m_fillBounds,e.m_textEffectMetrics=this.m_textEffectMetrics,e.bender=this.m_bender,e}get characters(){return this.m_characters}get localRange(){return this.m_localRange}get offset(){return this.m_offset}get layoutBounds(){return this.m_layoutBounds}get fillBounds(){return this.m_fillBounds}get textEffectMetrics(){return this.m_textEffectMetrics}get bender(){return this.m_bender}get changeTracker(){return this.m_changeTracker}get flowDirection(){return 0==this.m_characters.length?0:Math.sign(this.m_characters[this.m_characters.length-1].layoutBounds.left-this.m_characters[0].layoutBounds.left)}set localRange(e){Object(l.c)(this.m_changeTracker,this.m_localRange,e),this.m_localRange=e}set offset(e){Object(l.c)(this.m_changeTracker,this.m_offset,e),this.m_offset=e}set layoutBounds(e){Object(l.c)(this.m_changeTracker,this.m_layoutBounds,e),this.m_layoutBounds=e}set fillBounds(e){Object(l.c)(this.m_changeTracker,this.m_fillBounds,e),this.m_fillBounds=e}set textEffectMetrics(e){Object(l.c)(this.m_changeTracker,this.m_textEffectMetrics,e),this.m_textEffectMetrics=e}set bender(e){this.bender==e||this.bender instanceof p&&e instanceof p&&this.bender.equals(e)||this.bender instanceof _&&e instanceof _&&this.bender.equals(e)||(this.m_changeTracker.notifyChange(),this.m_bender=e)}set characters(e){Object(l.d)(this.m_changeTracker,this.m_characters,e),this.m_characters=e.slice(0)}removeAllCharacters(){this.characters=[]}addCharacter(e){this.m_changeTracker.notifyChange(),this.m_characters.push(e)}}class w{constructor(e,t){this.m_lines=[],this.m_localWordRanges=[],this.m_changeTracker=new o.a,this.m_globalRange=e,this.m_stylePerLocalRange=new c(t),this.m_effectsPerLocalRange=new c(new a.a),this.m_strokesPerLocalRange=new c(new o.b),this.m_changeTracker.replaceListener(void 0,this.m_stylePerLocalRange),this.m_offset=r.e.Zero}clone(){const e=new w(this.m_globalRange,this.m_stylePerLocalRange.defaultData);for(let t of this.m_lines)e.addLine(t.clone());e.m_offset=this.m_offset,e.bullet=this.m_bullet?this.m_bullet.clone():void 0;for(let t of this.m_stylePerLocalRange.ranges)e.m_stylePerLocalRange.set(this.m_stylePerLocalRange.getAt(t.start).clone(),t);e.m_effectsPerLocalRange.defaultData=this.m_effectsPerLocalRange.defaultData;for(let t of this.m_effectsPerLocalRange.ranges)e.m_effectsPerLocalRange.set(this.m_effectsPerLocalRange.getAt(t.start).clone(),t);e.m_strokesPerLocalRange.defaultData=this.m_strokesPerLocalRange.defaultData;for(let t of this.m_strokesPerLocalRange.ranges){const i=this.m_strokesPerLocalRange.getAt(t.start),r=new o.b;for(let e of i.elements)r.push(e.clone());e.m_strokesPerLocalRange.set(r,t)}return e.m_localWordRanges=this.m_localWordRanges.slice(0),e}get lines(){return this.m_lines}get stylePerLocalRange(){return this.m_stylePerLocalRange}get effectsPerLocalRange(){return this.m_effectsPerLocalRange}get strokesPerLocalRange(){return this.m_strokesPerLocalRange}get globalRange(){return this.m_globalRange}get offset(){return this.m_offset}get bullet(){return this.m_bullet}get localWordRanges(){return this.m_localWordRanges}get changeTracker(){return this.m_changeTracker}set stylePerLocalRange(e){this.m_changeTracker.replaceListener(this.m_stylePerLocalRange,e),this.m_stylePerLocalRange=e}set effectsPerLocalRange(e){this.m_changeTracker.replaceListener(this.m_effectsPerLocalRange,e),this.m_effectsPerLocalRange=e}set strokesPerLocalRange(e){this.m_changeTracker.replaceListener(this.m_strokesPerLocalRange,e),this.m_strokesPerLocalRange=e}set globalRange(e){this.m_globalRange.equals(e)||(this.m_changeTracker.notifyChange(),this.m_globalRange=e)}set offset(e){Object(l.c)(this.m_changeTracker,this.m_offset,e),this.m_offset=e}set bullet(e){this.m_changeTracker.replaceListener(this.m_bullet,e),this.m_bullet=e}set localWordRanges(e){Object(l.d)(this.m_changeTracker,this.m_localWordRanges,e),this.m_localWordRanges=e.slice(0)}removeAllLocalWordRanges(){this.localWordRanges=[]}addLocalWordRange(e){this.m_changeTracker.notifyChange(),this.m_localWordRanges.push(e)}set lines(e){this.removeAllLines();for(let t of e)this.addLine(t)}removeAllLines(){for(let e of this.m_lines)o.a.RemoveListener(e.changeTracker,this.m_changeTracker);this.m_lines=[]}addLine(e){o.a.AddListener(e.changeTracker,this.m_changeTracker),this.m_lines.push(e)}}class M{constructor(){this.m_paragraphs=[],this.m_changeTracker=new o.a,this.m_animationChangeTracker=new o.a,this.m_selectionChangeTracker=new o.a,this.m_layoutToFrame=r.d.Identity,this.m_frameToShape=r.d.Identity,this.m_renderMode=0}clone(){const e=new M;for(let t of this.m_paragraphs)e.addParagraph(t.clone());if(e.m_layoutToFrame=this.m_layoutToFrame,e.m_frameToShape=this.m_frameToShape,this.m_animationProps){e.m_animationProps=new c(new f),e.m_animationProps.defaultData=this.m_animationProps.defaultData;for(let t of this.m_animationProps.ranges)e.m_animationProps.set(this.m_animationProps.getAt(t.start).clone(),t)}if(this.m_selectionHighlights){e.m_selectionHighlights=[];for(let t of this.m_selectionHighlights)e.m_selectionHighlights.push(t.clone())}return e}createAnimationProps(){this.animationProps=new c(new f)}hasAnimationProps(){return!!this.animationProps}get paragraphs(){return this.m_paragraphs}get layoutToFrame(){return this.m_layoutToFrame}get frameToShape(){return this.m_frameToShape}get animationProps(){return this.m_animationProps}get selectionHighlights(){return this.m_selectionHighlights}get clipBounds(){return this.m_clipBounds}get applyEffectsPerCharacter(){return!!this.m_applyEffectsPerCharacter}get changeTracker(){return this.m_changeTracker}get animationChangeTracker(){return this.m_animationChangeTracker}get textVersion(){return this.m_changeTracker.version}get selectionVersion(){return this.m_selectionChangeTracker.version}get renderMode(){return this.m_renderMode}get linesCutoutMargin(){return this.m_linesCutoutMargin||r.e.Zero}get spreadFill(){return!!this.m_spreadFill}set layoutToFrame(e){Object(l.c)(this.m_changeTracker,this.m_layoutToFrame,e),this.m_layoutToFrame=e}set frameToShape(e){Object(l.c)(this.m_changeTracker,this.m_frameToShape,e),this.m_frameToShape=e}set selectionHighlights(e){Object(l.b)(this.m_selectionChangeTracker,this.m_selectionHighlights,e),this.m_selectionHighlights=e?e.slice(0):void 0}set clipBounds(e){Object(l.c)(this.m_changeTracker,this.m_clipBounds,e),this.m_clipBounds=e}set applyEffectsPerCharacter(e){Object(l.a)(this.m_changeTracker,!!this.m_applyEffectsPerCharacter,e),this.m_applyEffectsPerCharacter=e}set animationProps(e){this.m_animationProps!=e&&(this.m_animationProps&&(o.a.RemoveListener(this.m_animationProps.changeTracker,this.m_animationChangeTracker),o.a.RemoveListener(this.m_animationProps.rangeChangeTracker,this.m_changeTracker)),e&&(o.a.AddListener(e.changeTracker,this.m_animationChangeTracker),o.a.AddListener(e.rangeChangeTracker,this.m_changeTracker)),this.m_animationProps=e)}set paragraphs(e){if(this.m_paragraphs!=e){this.removeAllParagraphs();for(let t of e)this.addParagraph(t)}}set renderMode(e){Object(l.a)(this.m_changeTracker,this.m_renderMode,e),this.m_renderMode=e}set linesCutoutMargin(e){Object(l.c)(this.m_changeTracker,this.m_linesCutoutMargin,e),this.m_linesCutoutMargin=e}set spreadFill(e){Object(l.a)(this.m_changeTracker,!!this.m_spreadFill,e),this.m_spreadFill=e}forceSplit(e){(!this.m_explicitTextSplit||e>this.m_explicitTextSplit)&&(this.m_changeTracker.notifyChange(),this.m_explicitTextSplit=e)}removeAllParagraphs(){for(let e of this.m_paragraphs)o.a.RemoveListener(e.changeTracker,this.m_changeTracker);this.m_paragraphs=[]}addParagraph(e){o.a.AddListener(e.changeTracker,this.m_changeTracker),this.m_paragraphs.push(e)}removeParagraph(e){o.a.RemoveListener(this.m_paragraphs[e].changeTracker,this.m_changeTracker),this.m_paragraphs.splice(e)}getFullRange(){return this.paragraphs.length<1?void 0:d.FromFirstLast(this.paragraphs[0].globalRange.start,this.paragraphs[this.paragraphs.length-1].globalRange.last)}getRunRanges(){const e=this.getFullRange();if(e){let t=[];for(const e of this.paragraphs)if(2==this.m_explicitTextSplit||this.applyEffectsPerCharacter)for(let i=e.globalRange.start;i<=e.globalRange.last;i++)C(t,i);else{const i=e.globalRange.start;for(let r of e.lines)C(t,i+r.localRange.start),C(t,i+r.localRange.last+1);for(let r of e.stylePerLocalRange.ranges)C(t,i+r.start),C(t,i+r.last+1);for(let r of e.effectsPerLocalRange.ranges)C(t,i+r.start),C(t,i+r.last+1);for(let r of e.strokesPerLocalRange.ranges)C(t,i+r.start),C(t,i+r.last+1);if(1==this.m_explicitTextSplit)for(let r of e.localWordRanges)C(t,i+r.start),C(t,i+r.last+1)}if(this.animationProps)for(let e of this.animationProps.ranges)t.some(t=>t==e.start)||t.push(e.start),t.some(t=>t==e.last+1)||t.push(e.last+1);return I(t,e)}return[]}getAnimatablePartRanges(e,t,i){let r=t||this.getFullRange();if(!r||0==r.length)return;if(t&&i){if(t.start<0||t.start>=this.paragraphs.length||t.last<0||t.last>=this.paragraphs.length)return void n.a.Error(592525336,"bad paragraph range");r=d.FromFirstLast(this.paragraphs[t.start].globalRange.start,this.paragraphs[t.last].globalRange.last)}if(0==e)return r?[r]:void 0;let a=[];for(let t of this.paragraphs){const i=t.globalRange.start;for(let r of t.lines)if(C(a,i+r.localRange.start),C(a,i+r.localRange.last+1),2==e){const e=i+r.localRange.start;let t=!1;for(let i=0;i<r.characters.length;i++)t||C(a,e+i),t=1==r.characters[i].isWhiteSpace}if(1==e)for(let e of t.localWordRanges)C(a,i+e.start)}return I(a,r)}getTextPathsForCharacter(e,t,i,a){const o=[],l=a&&e.outlinePath?e.outlinePath:e.paths,d=l instanceof s.c?[l]:null!=l?l:[];for(let a of d)if(a.figures.length>0){const l=r.b.Translation2D(t).multiply(this.layoutToFrame.toMatrix3());let d=a.transform.toMatrix3().multiply(l).tryGetTransform(a.transform.preTranslation);if(!d)throw n.a.Error(592525337,"unexpected transform");{let t=new s.c(a,d),r=i instanceof _?i:void 0;if(i instanceof p){const n=e.layoutBounds.isEmpty()?void 0:e.layoutBounds.transformedBounds(l);if(e.forceWarping||!n)r=i.equivalentWarpingEnvelope;else{const e=i.getTransform(n);e&&(d=d.toMatrix3().multiply(e.toMatrix3()).tryGetTransform(a.transform.preTranslation),t=d?new s.c(a,d):void 0)}}r&&t&&(t=r.warpPath(t)),t&&o.push(t)}}return o}getTextPathsForRange(e,t){const i=[];for(let r of this.paragraphs)if(r.globalRange.intersects(e))for(let n of r.lines){const a=new d(0,n.characters.length).getIntersection(e.move(-r.globalRange.start-n.localRange.start));if(a)for(let e=a.start;e<=a.last;e++){const a=this.getTextPathsForCharacter(n.characters[e],n.offset.add(r.offset),n.bender,t);i.push(...a)}}return i}getLineAndParagraphAt(e){for(let t of this.paragraphs)if(t.globalRange.includes(e)){const i=e-t.globalRange.start;for(let e of t.lines)if(e.localRange.includes(i))return{line:e,paragraph:t}}}getStyleAt(e){for(let t of this.paragraphs)if(t.globalRange.includes(e))return t.stylePerLocalRange.getAt(e-t.globalRange.start)}getEffetcsAt(e){for(let t of this.paragraphs)if(t.globalRange.includes(e))return t.effectsPerLocalRange.getAt(e-t.globalRange.start)}getStrokesAt(e){for(let t of this.paragraphs)if(t.globalRange.includes(e))return t.strokesPerLocalRange.getAt(e-t.globalRange.start)}getPathFromLayoutRect(e,t,i){const n=r.b.Translation2D(i).multiply(this.layoutToFrame.toMatrix3()).tryGetTransform(r.e.Zero);if(n){let i=new s.c({figures:[s.a.CreateFromRect(e)],transform:n});const r=t.bender instanceof p?t.bender.equivalentWarpingEnvelope:t.bender;return r&&(i=r.warpPath(i)),i}}getSelectionRectPaths(e){let t=void 0;for(let i of this.paragraphs){const n=e?e.move(-i.globalRange.start):void 0;for(let e of i.lines){let a=void 0;if(!n||e.characters&&n.intersects(e.localRange))for(let t=0;t<e.characters.length;t++){const i=e.localRange.start+t;(!n||n.start<=i&&i<=n.last)&&(a=r.c.UnionRect(a,e.characters[t].layoutBounds))}if(a){const r=this.getPathFromLayoutRect(a,e,e.offset.add(i.offset));r&&(t||(t=[]),t.push(r))}}}return t}getCutoutLinePath(e,t){let i=void 0;const a=[];for(let i of this.paragraphs){const s=e?e.move(-i.globalRange.start):void 0;for(let e of i.lines){let o=void 0;if(!s||e.characters&&s.intersects(e.localRange))for(let t=0;t<e.characters.length;t++){const i=e.localRange.start+t;(!s||s.start<=i&&i<=s.last)&&(o=r.c.UnionRect(o,e.characters[t].layoutBounds))}if(o){const t=e.offset.add(i.offset),n=r.b.Translation2D(t).multiply(this.layoutToFrame.toMatrix3());o=o.transformedBounds(n)}e.bender&&n.a.Error(528320162,"LinesCutout currently not supported with Benders."),o&&a.push(new r.c(o.left-t.x,o.top-t.y,o.right+t.x,o.bottom+t.y))}}if(a.length>0){const e=new s.b;e.moveTo(a[0].left,a[0].top),e.lineTo(a[0].right,a[0].top);for(let t=0;t<a.length-1;t++){const i=a[t].right,r=a[t+1].right,n=i>r?a[t].bottom:a[t+1].top;e.lineTo(i,n),e.lineTo(r,n)}e.lineTo(a[a.length-1].right,a[a.length-1].bottom),e.lineTo(a[a.length-1].left,a[a.length-1].bottom);for(let t=a.length-1;t>0;t--){const i=a[t].left,r=a[t-1].left,n=i<r?a[t].top:a[t-1].bottom;e.lineTo(i,n),e.lineTo(r,n)}e.close(),i=[s.c.CreateFromFigure(e.createFigure())]}return i}getBoundsOfRange(e,t,i=!1){if(!i||!this.animationProps)return this.getBoundsOfRangeStatic(e,t);let n=this.getFullRange();if(!n)return;let a=[];for(let e of this.animationProps.ranges)C(a,e.start),C(a,e.last+1);const s=I(a,n);let o;for(let e of s){const i=this.animationProps.getAt(e.start).animationTransform,n=t&&i?t.toMatrix3().multiply(i):t||i;o=r.c.UnionRect(o,this.getBoundsOfRangeStatic(e,n))}return o}getBoundsOfRangeStatic(e,t){let i;const n=t?this.frameToShape.toMatrix3().multiply(t.toMatrix3()):this.frameToShape;let a=this.getSelectionRectPaths(e);for(let t of this.paragraphs)if(t.bullet&&t.lines.length>0&&(!e||e.includes(t.globalRange.start))){const e=this.getPathFromLayoutRect(t.bullet.character.layoutBounds,t.lines[0],t.offset);e&&(a=a?a.concat(e):[e])}for(let e of a||[])e.untransformedBounds&&(i=r.c.UnionRect(i,e.untransformedBounds.transformedBounds(e.transform.toMatrix3().multiply(n.toMatrix3()))));return i}getSelectionLayoutCaretPath(e,t,i){for(let a of this.paragraphs){const s=e-a.globalRange.start;for(let e of a.lines){e.localRange.length!=e.characters.length&&n.a.Error(592525338,"character count mismatch");const o=s-e.localRange.start;let l;if(0<=o&&o<e.characters.length){const i=e.characters[o].layoutBounds,n=e.flowDirection>0?i.left:i.right;l=new r.c(n-.5*t,i.top,n+.5*t,i.bottom)}else if(0==o&&0==e.characters.length){const i=e.flowDirection>0?e.layoutBounds.left:e.layoutBounds.right;l=new r.c(i-.5*t,e.layoutBounds.top,i+.5*t,e.layoutBounds.bottom)}else if(i&&s==e.localRange.last+1){const i=e.characters[e.characters.length-1].layoutBounds,n=e.flowDirection>0?i.right:i.left;l=new r.c(n-.5*t,i.top,n+.5*t,i.bottom)}if(l)return this.getPathFromLayoutRect(l,e,e.offset.add(a.offset))}}}getLineAndParagraphFromLayoutPosition(e){let t=void 0,i=void 0;for(let r of this.paragraphs)for(let n of r.lines){if(e.subtract(r.offset).subtract(n.offset).y<n.layoutBounds.bottom)return{paragraph:r,line:n};t=n,i=r}return{paragraph:i,line:t}}getSelectionFromLayoutPosition(e){const t=this.getLineAndParagraphFromLayoutPosition(e);if(!t.paragraph||!t.line||!t.line.characters)return;const i=e.subtract(t.paragraph.offset).subtract(t.line.offset);for(let e=0;e<t.line.characters.length;e++)if(i.x<(t.line.characters[e].layoutBounds.right+t.line.characters[e].layoutBounds.left)/2)return{characterIndex:t.paragraph.globalRange.start+t.line.localRange.start+e,isAnchoredToPrevious:!1};return{characterIndex:t.paragraph.globalRange.start+t.line.localRange.last+1,isAnchoredToPrevious:!0}}hitTest(e){for(let t of this.paragraphs)for(let i of t.lines||[]){const r=e.subtract(t.offset).subtract(i.offset);if(i.layoutBounds.isPointInRect(r))return!0}return!1}getBrushImages(){const e=[];for(let t of this.paragraphs){t.bullet&&t.bullet.style&&e.push(...t.bullet.style.getBrushImages()),t.stylePerLocalRange.allData.forEach(t=>{e.push(...t.getBrushImages())}),t.strokesPerLocalRange.allData.forEach(t=>{for(let i of t.elements)i.style&&e.push(...i.style.getBrushImages())});for(let i of t.lines)for(let t of i.characters)t.textImage&&e.push(t.textImage.image)}return e}}function C(e,t){e.some(e=>e==t)||e.push(t)}function I(e,t){C(e,t.start),C(e,t.last+1),e.sort((e,t)=>e-t);const i=[];for(let r=0;r<e.length-1;r++){const n=d.FromFirstLast(e[r],e[r+1]-1).getIntersection(t);n&&n.length>0&&i.push(n)}return i}},function(e,t,i){var r=i(377),n=i(378),a=n;a.v1=r,a.v4=n,e.exports=a},function(e,t,i){"use strict";var r=i(100);i.d(t,"SlideShowRole",(function(){return r.b})),i.d(t,"UIHostType",(function(){return r.c}));var n=i(256);i.d(t,"AppForOfficeManager",(function(){return n.a}));var a=i(133);i.d(t,"EditMode",(function(){return a.a})),i.d(t,"ErrorCodeManager",(function(){return a.b})),i(111);var s=i(228);i.o(s,"AppForOfficeLoader")&&i.d(t,"AppForOfficeLoader",(function(){return s.AppForOfficeLoader})),i.o(s,"AppForOfficeTheme")&&i.d(t,"AppForOfficeTheme",(function(){return s.AppForOfficeTheme}));var o=i(39);i.d(t,"AppForOfficeTheme",(function(){return o.a}));var l=i(229);i.d(t,"AppForOfficeLoader",(function(){return l.a}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"d",(function(){return n})),i.d(t,"e",(function(){return a})),i.d(t,"c",(function(){return s})),i.d(t,"b",(function(){return o}));class r{constructor(e,t,i){this.fIsEmpty=!0,this.colorScheme=e,this.fontScheme=t,this.backgroundColor=i,this.fIsEmpty=!e&&!t&&!i}}class n{}class a{}class s{constructor(e){this.red=0,this.green=0,this.blue=0,this.intColor=0,this.fValid=!1,this.INVALID=-1,null!=e&&3===e.length&&(this.red=e[2],this.green=e[1],this.blue=e[0],this.fValid=this.isColorValid(),this.intColor=this.convertToInteger())}convertToInteger(){return this.fValid?(this.intColor=this.blue,this.intColor+=this.green<<8,this.intColor+=this.red<<16):this.intColor=this.INVALID,this.intColor}isColorValid(){return!o.isNullOrUndefined(this.red)&&this.red>=0&&!o.isNullOrUndefined(this.green)&&this.green>=0&&!o.isNullOrUndefined(this.blue)&&this.blue>=0}}class o{static isNullOrUndefined(e){return null==e||void 0===e}static validateArgument(e){if(o.isNullOrUndefined(e))throw Error("");return e}}},function(e,t,i){"use strict";i.d(t,"c",(function(){return u})),i.d(t,"e",(function(){return f})),i.d(t,"d",(function(){return m})),i.d(t,"f",(function(){return p})),i.d(t,"a",(function(){return g})),i.d(t,"b",(function(){return _})),i.d(t,"g",(function(){return y}));var r=i(0),n=i(15),a=i(18),s=i(1),o=i(4),l=i(2),d=i(3);class h{constructor(e,t,i){this.m_pausedTimeMs=0,this.m_resumedTimeMs=0,this.m_maxTimeoutDurationMs=i?i.maxTimeoutDurationMs:void 0,this.m_callback=e,this.m_timeoutMs=t,this.m_startTimeMs=Date.now(),this.updateTimeout()}pause(){this.isPaused||(this.m_pausedTimeMs=Date.now(),this.updateTimeout())}resume(){this.isPaused&&(this.m_resumedTimeMs=Date.now(),this.m_timeoutMs+=this.m_resumedTimeMs-this.m_pausedTimeMs,this.updateTimeout())}setTime(e){this.isPaused&&(this.m_pausedTimeMs=Date.now()),this.m_timeoutMs=e+(Date.now()-this.m_startTimeMs),this.updateTimeout()}addTime(e){this.m_timeoutMs+=e,this.updateTimeout()}abort(){window.clearTimeout(this.m_timeoutId),this.m_callback=()=>{}}get isPaused(){return this.m_pausedTimeMs>this.m_resumedTimeMs}updateTimeout(){window.clearTimeout(this.m_timeoutId);const e=Math.min(this.m_maxTimeoutDurationMs||Number.POSITIVE_INFINITY,this.isPaused?Number.POSITIVE_INFINITY:this.m_timeoutMs);isFinite(e)&&(this.m_timeoutId=window.setTimeout(this.m_callback,e-(Date.now()-this.m_startTimeMs)))}}function c(e){const t="abcdefghijklmnopqrstuvwxyz0123456789";return e<=65535?e.toString():e>>24>=36?String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e):t.charAt(e>>24&63)+t.charAt(e>>18&63)+t.charAt(e>>12&63)+t.charAt(e>>6&63)+t.charAt(63&e)}function u(e){return e.clientData?e.clientData:e.clientData={}}function f(e,t){if(!t||0===t.length)return[e];const i=u(e).partId||"";for(const r of t)if(i===r)return[e];if(2!==e.getType())return null;let r=[];const n=e;for(const e of n.items.elements){const i=f(e,t);i&&(r=r.concat(i))}return 0===r.length?null:r}function m(e,t){if(!t)return e;if((u(e).partId||"")===t)return e;if(2!==e.getType())return null;const i=e;for(const e of i.items.elements){const i=m(e,t);if(i)return i}return null}function p(e){return 1===e.getType()?e:2===e.getType()&&1===e.items.getAt(0).getType()?e.items.getAt(0):void 0}class g{static getInstance(){return g.s_instance||(g.s_instance=new g)}Error(e,t){o.a.sendTraceTag(e,l.a.msoulscat_Wac_PptSession,d.a.Error,t)}Message(e,t){o.a.sendTraceTag(e,l.a.msoulscat_Wac_PptSession,d.a.Info,t)}}class _{constructor(){this.renderingLogCount=new Map}static getInstance(){return _.s_instance||(_.s_instance=new _)}sendTraceTag(e,t,i,r){if(_.s_isRenderingAnimationFrame){const i=s.Settings.readNumberOrDefault("maxLogsDuringAnimationByTagCooldownMs",1e3),r=s.Settings.readNumberOrDefault("maxLogsDuringAnimationByTag",100);this.resetRenderingLogCountTimeoutClock?this.resetRenderingLogCountTimeoutClock.setTime(i):this.resetRenderingLogCountTimeoutClock=new h(()=>{const e=[];for(const[t,i]of this.renderingLogCount)i>=r&&e.push(c(t));e.length>0&&o.a.sendTraceTag(509437461,t,d.a.Info,`log cooldown reached, reenabling tags:${e}}`),this.renderingLogCount.clear(),this.resetRenderingLogCountTimeoutClock=void 0},i);const n=this.renderingLogCount.get(e)||0;if(this.renderingLogCount.set(e,n+1),n>=r)return void(n===r&&o.a.sendTraceTag(509437460,t,d.a.Warning,`too many logs during animation, disabling tag:${c(e)}}`))}o.a.sendTraceTag(e,t,i,r)}shipAssertTag(e,t,i,r){o.a.shipAssertTag(e,t,i,r)}debugAssertTag(e,t,i,r){o.a.debugAssertTag(e,t,i,r)}}let v;function y(e,t,i,h){const c=window.devicePixelRatio||1,u=e.x/t.x,f=e.y/t.y;let m=Math.min(u,f)*c;const p=new r.e(e.x*c,e.y*c);m*=Math.min(1,Math.sqrt(Math.sqrt(2073600/(p.x*p.y)))),m*=s.Settings.readNumberOrDefault("hackShapeBuilderQualityScale",1);const g=t.x/i.x,_=t.x/p.x,y=25400*g,b=!!(e.x&&e.y&&m);if(b)Object(n.o)(m),Object(a.I)(_,y);else{const e="attempted to set invalid shapebuilder quality";o.a.sendTraceTag(545277320,l.a.msoulscat_Wac_PptSession,d.a.Warning,h?h(new Error(e)):e)}const S=JSON.stringify({quality:m,minLineWidth:_,minLineWidthForArrowHead:y,devicePixelRatio:c,clientWidth:e.x,clientHeight:e.y,slideSizePixels:t,isValid:b});S!==v&&o.a.sendTraceTag(546096137,l.a.msoulscat_Wac_PptSession,d.a.Info,S),v=S}_.s_isRenderingAnimationFrame=!1},function(e,t,i){"use strict";i.d(t,"b",(function(){return c})),i.d(t,"a",(function(){return u}));var r=i(4),n=i(2),a=i(3),s=i(12),o=i(1),l=i(35),d=i(20),h=i(21);class c{static isIC3Message(e){return Object.keys(e).some(e=>e.includes(d.a.ic3Local))}static isStateMessage(e){return Object.keys(e).some(e=>e.includes(d.a.stateLocal))}static isDuplicateEmitTime(e){let t=void 0;if(this.isStateMessage(e))t=this.m_previousStateComparisonReceivedMessageEmitTime;else{if(!this.isIC3Message(e))return r.a.sendTraceTag(542782361,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"StateServiceComparison:IsDuplicateEmitTime unknown source: "+JSON.stringify(e)),!1;t=this.m_previousTeamsComparisonReceivedMessageEmitTime}let i=0;for(const r in e)if(r.includes("SS_Emit"))return i=e[r],i===t;return!1}static logStateServiceComparisonTelemetry(e,t,i,s){try{const o={...e};if(o){o.attendee_ring=s||"";const e=o.skew_emitter||0,l=t;let h=0,u=d.c.Unknown;for(const t in o)(t.includes(d.a.teamsNotified)||t.includes(d.a.stateNotified)||t.includes(d.a.bootstrapperNotified))&&0!==e?o[t]+=e:(t.includes(d.a.teamsLocal)||t.includes(d.a.stateLocal)||t.includes(d.a.bootstrapperLocal))&&0!==i?(o[t]+=i,u=t.includes(d.a.stateLocal)?d.c.State:d.c.Teams,o.source=u):t.includes("SS_Emit")&&(h=o[t]);if(o[d.a.skewReceiver]=i,o.PPT_ModernSS_Complete_Nav=l,h>0){const e=l-h;o.totalElapsedMS=e;const t=`${o.slideIndex||-1}_${h}`;let i=Number.MIN_SAFE_INTEGER;u===d.c.State&&(this.m_stateReceivedNavs[t]=e,i=this.m_previousStateComparisonReceivedMessageEmitTime,this.m_previousStateComparisonReceivedMessageEmitTime=h),u===d.c.Teams&&(this.m_teamsReceivedNavs[t]=e,i=this.m_previousTeamsComparisonReceivedMessageEmitTime,this.m_previousTeamsComparisonReceivedMessageEmitTime=h);const s=h===i,f=h<i;!s&&e>2500&&(o.endToEndNavSlow=!0,e>3e4&&(o.endToEndNavSlow30=!0)),f?(r.a.sendTraceTag(556675078,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,`StateServiceComparison:Out Of Order nav messages received: source: ${u}; current: ${h}; previous: ${i};`),o.EarlierOrder="true"):s&&(o.SameOrder="true",r.a.sendTraceTag(556675079,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,`StateServiceComparison:Duplicate emit time nav messages received: source: ${u}; current: ${h}; previous: ${i};`)),c.logStateServiceCorrespondingComparisonTelemetry(u,t),r.a.sendTraceTag(556675080,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,"StateServiceComparison: "+JSON.stringify(o))}}}catch(e){r.a.sendTraceTag(556675081,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,"StateServiceComparison error: "+e)}}static logStateServiceCorrespondingComparisonTelemetry(e,t){const i=e===d.c.State?this.m_teamsReceivedNavs[t]:this.m_stateReceivedNavs[t],s=Object.keys(this.m_stateReceivedNavs).length,l=Object.keys(this.m_teamsReceivedNavs).length,h=s-l,c=o.Settings.readNumberOrDefault("syncPipelineDiscrepancyCount",10);let u="";if(h>c?u=d.c.Teams:h<-1*c&&(u=d.c.State),""!==u){const e={stateKeysCount:s,teamsKeysCount:l,keyCountDifferenceToLogVeto:c};r.a.sendTraceTag(509696076,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`SyncPipelineDiscrepancy_${u}: ${JSON.stringify(e)}`)}if(void 0===i)return;const f=this.m_stateReceivedNavs[t],m=this.m_teamsReceivedNavs[t],p={key:t,stateElapsed:f,teamsElapsed:m,stateFaster:f<m,difference:f-m,stateKeysCount:s,teamsKeysCount:l};r.a.sendTraceTag(557594177,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,"logStateServiceComparison "+JSON.stringify(p))}}c.m_stateReceivedNavs={},c.m_teamsReceivedNavs={},c.m_previousStateComparisonReceivedMessageEmitTime=Number.MIN_SAFE_INTEGER,c.m_previousTeamsComparisonReceivedMessageEmitTime=Number.MIN_SAFE_INTEGER;class u{static trackLastUserInputNavigation(e,t){this.m_lastUserInputTime=t,r.a.sendTraceTag(573382730,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,`trackTeamsPVMetrics::trackLastUserInputNavigation: navType: ${e.navType}; action: ${e.source}, time: ${t}`)}static initialize(e){e.teamsSharingEndToEndNavSlowMS&&(this.m_teamsSharingEndToEndNavSlowMS=e.teamsSharingEndToEndNavSlowMS),this.m_maxSlowPipelineMessagesCount=o.Settings.readNumberOrDefault("maxSlowPipelineMessagesCount",0),this.m_stateServicePipelineMessageSlowMS=o.Settings.readNumberOrDefault("stateServicePipelineMessageSlowMS",Number.MAX_SAFE_INTEGER)}static setSlowMediaSyncThreshold(e){this.m_slowMediaSyncQoSThresholdMs=e}static hadPreviousUserInput(e){return this.m_timeFromLastUserInputNav=-1,this.m_lastUserInputTime?(this.m_timeFromLastUserInputNav=e-this.m_lastUserInputTime,!0):(r.a.sendTraceTag(573089757,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"trackTeamsPVMetrics: Entering private viewing without prior user input."),!1)}static trackTeamsPVMetrics(e,t){try{r.a.sendTraceTag(579111062,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,`trackTeamsPVMetrics: action: ${JSON.stringify(e)}; time: ${t}, inPV: ${null!=this.m_currentTeamsPrivateViewingData}`);const i=e.action;switch(i){case"enterPrivateViewing":{const i=e.source||"";this.m_currentTeamsPrivateViewingData?r.a.sendTraceTag(579111063,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,`trackTeamsPVMetrics: EnterPrivateViewing on existing PV session. source: ${i}; data: ${JSON.stringify(e)}; existingPV:${JSON.stringify(this.m_currentTeamsPrivateViewingData)}`):(this.m_currentTeamsPrivateViewingData={enterPrivateViewing:t,returnToPresenter:0,sessionSlideUpdate:0,privateSlideUpdatePrev:0,privateSlideUpdateNext:0,leavePrivateViewing:-1,enterPrivateViewingSource:i,timeFromLastUserNav:this.m_timeFromLastUserInputNav,completed:!1},this.m_sessionTeamsPrivateViewingData.incompletePrivateViewingSessions+=1,i&&i!==d.b.SyncStateManager||this.hadPreviousUserInput(t)||s.VetoUtils.recordVeto("Slide_VetoedTeamsPrivateViewingUnintentional",{qosVeto:"SharingWrongSlideStateDisplayed",...this.m_currentTeamsPrivateViewingData}));break}case"leavePrivateViewing":this.m_currentTeamsPrivateViewingData&&(this.m_currentTeamsPrivateViewingData.leavePrivateViewing=t,this.m_currentTeamsPrivateViewingData.privateViewingDuration=t-this.m_currentTeamsPrivateViewingData.enterPrivateViewing,this.m_currentTeamsPrivateViewingData.completed=!0,this.logCurrentPrivateViewingTelemetry(),this.m_currentTeamsPrivateViewingData=void 0,this.m_sessionTeamsPrivateViewingData.incompletePrivateViewingSessions-=1,this.m_sessionTeamsPrivateViewingData.completePrivateViewingSessions+=1);break;case"returnToPresenter":case"sessionSlideUpdate":case"privateSlideUpdatePrev":case"privateSlideUpdateNext":this.m_currentTeamsPrivateViewingData?this.m_currentTeamsPrivateViewingData[i]+=1:"privateSlideUpdateNext"===i?this.trackLastUserInputNavigation({navType:l.NavigationType.Next,source:3},t):"privateSlideUpdatePrev"===i&&this.trackLastUserInputNavigation({navType:l.NavigationType.Prev,source:3},t);break;default:r.a.sendTraceTag(579111064,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`trackTeamsPVMetrics: unexpected action ${JSON.stringify(e)};`)}}catch(e){r.a.sendTraceTag(579110789,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,`trackTeamsPVMetrics: caught error: ${e};`)}}static areSkewValuesValid(e,t){return 0!==e&&0!==t&&Math.abs(e)<1e8&&Math.abs(t)<1e8}static logCurrentPrivateViewingTelemetry(){this.m_currentTeamsPrivateViewingData&&r.a.sendTraceTag(579111065,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,"trackTeamsPVMetrics: privateViewingSession. Data:"+JSON.stringify(this.m_currentTeamsPrivateViewingData))}static logSessionEndPrivateViewingTelemetry(){const e=this.m_sessionTeamsPrivateViewingData.incompletePrivateViewingSessions>0;e&&this.logCurrentPrivateViewingTelemetry(),r.a.sendTraceTag(579111066,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,`trackTeamsPVMetrics: sessionTeamsPrivateViewingData: ${JSON.stringify(this.m_sessionTeamsPrivateViewingData)}, hasIncompletePV: ${e}`)}static logNavigationPromiseCompletedMetadata(e,t,i,s){try{if(e){e.attendee_ring=s||"";const o=e.skew_emitter||0,l=e.isForceRetry||!1,h=t;let c=0,u=d.c.Unknown;for(const t in e)(t.includes(d.a.teamsNotified)||t.includes(d.a.stateNotified)||t.includes(d.a.bootstrapperNotified))&&0!==o?e[t]+=o:(t.includes(d.a.teamsLocal)||t.includes(d.a.stateLocal)||t.includes(d.a.bootstrapperLocal))&&0!==i?(e[t]+=i,t.includes(d.a.stateLocal)?u=d.c.State:t.includes(d.a.teamsLocal)&&(u=d.c.Teams),e.source=u):t.includes("SS_Emit")&&(c=e[t]);if(e[d.a.skewReceiver]=i,e.PPT_ModernSS_Complete_Nav=h,c>0){const t=h-c;e.totalElapsedMS=t;const i=c===this.m_previousTeamsReceivedNavMessageEmitTime,s=c<this.m_previousTeamsReceivedNavMessageEmitTime,d=e.navResultStatus;s?this.m_previousTeamsReceivedEmitterSkew!==o||l||(r.a.sendTraceTag(572057294,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`LogTeamsNavigation:Out Of Order nav messages received: current: ${c}; previous: ${this.m_previousTeamsReceivedNavMessageEmitTime}; source: ${u}`),e.EarlierOrder="true"):i?(e.SameOrder="true",r.a.sendTraceTag(572057295,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,`LogTeamsNavigation:Duplicate emit time nav messages received: current: ${c}; previous: ${this.m_previousTeamsReceivedNavMessageEmitTime};`)):"Success"===d?(this.m_previousTeamsReceivedNavMessageEmitTime=c,this.m_previousTeamsReceivedEmitterSkew=o,this.m_consecutiveSkippedRequests>0&&(r.a.sendTraceTag(572057296,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,`LogTeamsNavigation:ConsecutiveSkippedRequests: ${this.m_consecutiveSkippedRequests}; endToEndElapsedTime: ${t}; source: ${u}`),this.m_consecutiveSkippedRequests=0),t>0&&!l&&this.logEndToEndSyncNavigationVetoIfSlow(e,u)):"Skipped_Busy"===d||"Skipped_NewTarget"===d?this.m_consecutiveSkippedRequests+=1:"Failed"===d&&r.a.sendTraceTag(572014601,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,"LogTeamsNavigation:Navigation Failed; endToEndElapsedTime: "+t)}r.a.sendTraceTag(588084945,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,"NavigationComplete: "+JSON.stringify(e))}}catch(e){r.a.sendTraceTag(572057297,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,"logNavigationPromiseCompleted error: "+e)}}static logStateServicePipelineLatency(e,t,i,l){if(!i)return;let h=i[d.a.stateNotified]||0,c=i[d.a.stateLocal]||0;const u=i.skew_emitter||i[d.a.skewEmitter],f=i[d.a.senderId]||"",m=`logStateServicePipelineLatency type:${e}; subtype:${t}; senderId:${f}`;if(!f||f===d.a.senderIdSystem)return void r.a.sendTraceTag(523503259,n.a.msoulscat_Wac_PptSlideshow,a.a.Verbose,m+" not measuring message from excluded sender");if(0===h||0===c||!this.areSkewValuesValid(u,l))return void r.a.sendTraceTag(523503260,n.a.msoulscat_Wac_PptSlideshow,a.a.Verbose,m+" not measuring message with invalid numbers");h+=u,c+=l;const p=c-h;p>this.m_stateServicePipelineMessageSlowMS&&(this.m_currentSlowPipelineMessagesCount+=1,this.m_currentSlowPipelineMessagesCount>=this.m_maxSlowPipelineMessagesCount?this.m_currentSlowPipelineMessagesCount%5==0&&(r.a.sendTraceTag(523503261,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,`${m} slow ${p}; currentSlowPipelineMessagesCount: ${this.m_currentSlowPipelineMessagesCount} > maxSlowPipelineMessagesCount: ${this.m_maxSlowPipelineMessagesCount}`),o.Settings.readBooleanOrDefault("logCorrectVetoForStateServiceLatency",!0)?s.VetoUtils.recordVeto("SyncPipelineSlow_StateService",{qosVeto:"SyncPipelineSlow_StateService",errorName:e+"_SharingEndToEndSlow",vetoLimit:this.m_teamsSharingEndToEndNavSlowMS,totalElapsedMS:p}):s.VetoUtils.recordVeto("SyncPipelineSlow_StateService",{qosVeto:"SharingEndToEndNavSlow",vetoLimit:this.m_teamsSharingEndToEndNavSlowMS,totalElapsedMS:p})):r.a.sendTraceTag(523503262,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`${m} slow ${p}; currentSlowPipelineMessagesCount: ${this.m_currentSlowPipelineMessagesCount}`))}static logEndToEndSyncNavigationVetoIfSlow(e,t){try{const i=e[d.a.stateNotified]||0,s=e[d.a.bootstrapperNotified]||0,o=e[d.a.stateLocal]||0,l=e[d.a.bootstrapperLocal]||0,h=Math.max(i,s),c=Math.max(o,l),u=e.skew_emitter,f=e[d.a.skewReceiver];if(h>0&&c>0&&c-h>this.m_teamsSharingEndToEndNavSlowMS&&this.areSkewValuesValid(u,f)){const e={vetoLimit:this.m_teamsSharingEndToEndNavSlowMS,totalElapsedMS:c-h,source:t,skew_emitter:u,skew_receiver:f};r.a.sendTraceTag(509696075,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`TeamsSharingEndToEndNavSlowMS_${t}: ${JSON.stringify(e)}`)}}catch(e){r.a.sendTraceTag(542782362,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,"logEndToEndSyncNavigationVetoIfSlow error: "+e)}}static logAnnotationCompletedMetadata(e,t,i,s){try{const o=e[d.a.skewEmitter]||0,l=t;let h=0;for(const t in e)t.includes(d.a.stateNotified)&&0!==o?e[t]+=o:t.includes(d.a.stateLocal)&&0!==i?e[t]+=i:t.includes(d.a.annotationEventEmitted)&&(h=e[t]);if(e[d.a.skewReceiver]=i,e[d.a.annotationEventCompleted]=l,e.attendee_ring=s||"",h>0){const t=l-h;e.totalElapsedMS=t}r.a.sendTraceTag(557670919,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,"AnnotationComplete: "+JSON.stringify(e))}catch(e){r.a.sendTraceTag(557670920,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,"logAnnotationCompletedMetadata error: "+e)}}static logStateServicePipelineMetrics(e,t,i,s){if(void 0===i[d.a.stateNotified]||void 0===i[d.a.stateLocal]||void 0===i[d.a.skewEmitter]||!this.areSkewValuesValid(i[d.a.skewEmitter],s))return void r.a.sendTraceTag(508064520,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"LogStateServicePipelineMetrics: invalid syncMetricsDictionary: "+JSON.stringify(i));if(this.logStateServicePipelineLatency(e,t,i,s),void 0===i[d.a.syncEventEmitTime])return void r.a.sendTraceTag(508064519,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"LogStateServicePipelineMetrics: Invalid syncMetricsDictionary: "+JSON.stringify(i));const o=i[d.a.syncEventEmitTime];o===this.m_previousStateServiceMessageEmitTime?r.a.sendTraceTag(508064518,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`LogStateServicePipelineMetrics: Duplicate message received: current: ${o}; previous: ${this.m_previousStateServiceMessageEmitTime}; `):o<=this.m_previousStateServiceMessageEmitTime?r.a.sendTraceTag(508064517,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,`LogStateServicePipelineMetrics: Out of Order message received: current: ${o}; previous: ${this.m_previousStateServiceMessageEmitTime}`):this.m_previousStateServiceMessageEmitTime=o}static logMediaSyncCompletedMetadata(e,t,i){try{if(e){const o=e[d.a.skewEmitter]||0,l=t;let h=0,c=d.c.Unknown;for(const t in e)t.includes(d.a.teamsNotified)&&0!==o?e[t]+=o:t.includes(d.a.teamsLocal)&&0!==i?e[t]+=i:t.includes(d.a.mediaEventEmitted)?h=e[t]:(t.includes(d.a.teamsLocal)||t.includes(d.a.stateLocal))&&(c=t.includes(d.a.stateLocal)?d.c.State:d.c.Teams,e.source=c);if(e[d.a.skewReceiver]=i,e[d.a.mediaEventCompleted]=l,h>0){const t=l-h;e[d.a.elapsedTime]=t;const u=h===this.m_previousTeamsReceivedMediaMessageEmitTime,f=h<this.m_previousTeamsReceivedMediaMessageEmitTime;t>this.m_slowMediaSyncQoSThresholdMs&&!e.isFromStateServiceCache&&this.areSkewValuesValid(o,i)&&(r.a.sendTraceTag(559425483,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"LogTeamsMediaSync: End-to-end media sync time larger than slow sync threshold: "+JSON.stringify(e)),this.logSlowEndToEndMediaSyncVeto(e,c)),f&&this.shouldLogOutOfOrderEvent(e,c)?(r.a.sendTraceTag(562045130,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,`LogTeamsMediaSync: Out of order play/pause sync messages received: current: ${h}; previous: ${this.m_previousTeamsReceivedMediaMessageEmitTime};`),s.VetoUtils.recordVeto("MediaSyncOutOfOrderEvents",{qosVeto:"MediaSyncOutOfOrderEvents"}),e[d.a.mediaEventOutOfOrder]="true"):u?(r.a.sendTraceTag(562045131,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,`LogTeamsMediaSync: Duplicate emit time media sync messages received: current: ${h};`),e[d.a.mediaEventDuplicate]="true"):this.m_previousTeamsReceivedMediaMessageEmitTime=h}r.a.sendTraceTag(562045132,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,"LogTeamsMediaSync: "+JSON.stringify(e))}}catch(e){r.a.sendTraceTag(562045133,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,"LogTeamsMediaSync: error: "+e)}}static isDuplicateMediaSyncMessage(e,t){return e?(t?this.m_upstreamMediaSyncEvents.has(e):this.m_downstreamMediaSyncEvents.has(e))?(r.a.sendTraceTag(526713541,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,`isDuplicateMediaSyncMessage: Media Sync message (correlationId: ${e}) has already been ${t?"sent":"received"}`),!0):(t?this.m_upstreamMediaSyncEvents.add(e):this.m_downstreamMediaSyncEvents.add(e),this.m_upstreamMediaSyncEvents.size>3e3&&this.m_upstreamMediaSyncEvents.clear(),this.m_downstreamMediaSyncEvents.size>3e3&&this.m_downstreamMediaSyncEvents.clear(),!1):(r.a.sendTraceTag(526713540,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,"isDuplicateMediaSyncMessage: Undefined correlationId"),!1)}static shouldLogOutOfOrderEvent(e,t){if(t!==d.c.State)return!1;let i=!1,r=6,n="";const a=e[d.a.mediaSyncTimeLine];if(a&&a.length>0){r=e[d.a.mediaEventType];const t=a[0].MediaHostName;n=a[0].MediaPlayerName||"",i=t===h.a.Video&&""!==n&&n===this.m_previousPlayerName&&(1===r&&0===this.m_previousEventType||0===r&&1===this.m_previousEventType)}return this.m_previousPlayerName=n,this.m_previousEventType=r,i}static logSlowEndToEndMediaSyncVeto(e,t){const i=e[d.a.skewEmitter]||0,r=e[d.a.skewReceiver]||0,n=e[d.a.elapsedTime];s.VetoUtils.recordVeto("MediaSyncEndToEndSlow_"+t,{qosVeto:"MediaSyncEndToEndSlow",vetoLimit:this.m_slowMediaSyncQoSThresholdMs,totalElapsedMS:n,source:t,emitterSkew:i,receiverSkew:r})}}u.m_sessionTeamsPrivateViewingData={incompletePrivateViewingSessions:0,completePrivateViewingSessions:0},u.m_teamsSharingEndToEndNavSlowMS=Number.MAX_SAFE_INTEGER,u.m_previousTeamsReceivedNavMessageEmitTime=Number.MIN_SAFE_INTEGER,u.m_previousStateServiceMessageEmitTime=Number.MIN_SAFE_INTEGER,u.m_previousTeamsReceivedEmitterSkew=Number.MIN_SAFE_INTEGER,u.m_consecutiveSkippedRequests=0,u.m_maxSlowPipelineMessagesCount=0,u.m_stateServicePipelineMessageSlowMS=Number.MAX_SAFE_INTEGER,u.m_currentSlowPipelineMessagesCount=0,u.m_previousTeamsReceivedMediaMessageEmitTime=Number.MIN_SAFE_INTEGER,u.m_slowMediaSyncQoSThresholdMs=Number.MAX_SAFE_INTEGER,u.m_previousEventType=6,u.m_previousPlayerName="",u.m_upstreamMediaSyncEvents=new Set,u.m_downstreamMediaSyncEvents=new Set},function(e,t,i){"use strict";i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return f})),i.d(t,"c",(function(){return c}));var r,n,a=i(31),s=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e}();!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(r={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout"}(n||(n={})),function(){function e(){}e.tagIntToString=function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)},e.getLogMessage=function(t,i,r){return"tag_"+e.tagIntToString(t)+" ["+n[i]+"] "+r},e.prototype.sendTraceTag=function(t,i,n,a){var s=this.logMessage;switch(n){case r.Error:s=this.logError;break;case r.Warning:s=this.logWarning;break;case r.Info:s=this.logInfo;break;case r.Verbose:s=this.logVerbose;break;case r.Spam:default:s=this.logMessage}try{s(e.getLogMessage(t,i,a))}catch(e){var o="undefined"!=typeof navigator?navigator:void 0;if(o&&!/rv:11.0/i.test(o.userAgent))throw e}},e.prototype.shipAssertTag=function(t,i,r,n){console.assert(r,e.getLogMessage(t,i,n))},e.prototype.debugAssertTag=function(e,t,i,r){this.shipAssertTag(e,t,i,r)},e.prototype.logMessage=function(e){"log"in console&&console.log(e)},e.prototype.logError=function(e){"error"in console&&console.error(e)},e.prototype.logWarning=function(e){"warn"in console&&console.warn(e)},e.prototype.logInfo=function(e){"info"in console&&console.info(e)},e.prototype.logVerbose=function(e){"debug"in console&&console.debug(e)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789"}();var o,l=new(function(){function e(){this.externalLogger=new s}return e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,i,r){this.externalLogger.sendTraceTag(e,t,i,r)},e.prototype.debugAssertTag=function(e,t,i,r){this.externalLogger.debugAssertTag(e,t,i,r)},e.prototype.shipAssertTag=function(e,t,i,r){this.externalLogger.shipAssertTag(e,t,i,r)},e}());!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(o||(o={})),function(){function e(t,i){var r=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){r.triggerUpload(!1,!1)},this.flush=function(){r.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return r.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,i){window.clearTimeout(r.timeoutId),r.logCache.length>0&&(r.uploadId+=1,function(e,t,i){if(""!==t)if(navigator&&navigator.sendBeacon)navigator.sendBeacon(t,e);else{var r=new XMLHttpRequest;r.readyState!==XMLHttpRequest.UNSENT&&r.readyState!==XMLHttpRequest.DONE||(r.open("POST",t,i),r.send(e))}}(function(e,t,i,r){var n=e.map((function(e){return function(e,t){var i={};i.G=e.tag,i.T=e.timestamp-t,i.M=e.message,i.C=e.category;var r=1e3*e.type+e.level;return i.D=r,i}(e,r)})),a=function(e,t,i,r){var n={};return n.T=e,n.L=t,n.S=i,n.I=r,n.V=1,n}(r,n,t,i);return JSON.stringify(a)}(r.logCache,r.userSessionId,r.uploadId,r.timestampBase),r.remoteUrlEndpoint,i),r.logCache=[],r.timestampBase=Date.now()),t&&(r.timeoutId=window.setTimeout(r.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t,this.remoteUrlEndpoint=i+"?usid="+t,window.setTimeout((function(){return r.triggerUpload(!0,!0)}),0)}e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===r.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]"}(),r.Info;var d=i(28);!function(e){Object(d.__extends)((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(s);let h=void 0;function c(e){e.logger&&l.setLogger(e.logger),e.stringifyError&&(h=e.stringifyError)}class u{constructor(e,t){this.loadResults=[],this.events=new a.EventEmitter,this.ongoingLoads=new Map,this.loader=e,this.policy=t}async load(e,t){const i=this.getLoadResultInCache(e,t);if(i)return i;const a={resourceId:e,metadata:{errorName:"ErrorResourceNotFound"}};if(this.policy&&!this.policy.shouldLoad(this,t))return a.metadata.errorName="ErrorResourceNotAllowed",a;if(!this.loader)return a.metadata.errorName="ErrorResourceLoaderNotAvailable",a;const s=`${e}_${JSON.stringify(u.removeMetadata(t))}`;let o,d=this.ongoingLoads.get(s);d||(d=this.loader.load(e,t),this.ongoingLoads.set(s,d));try{o=await d}catch(e){l.sendTraceTag(595645708,n.msoulscat_Wac_PptLive,r.Warning,"unexpected error on load: "+(e instanceof Error&&h?h(e):e))}return this.ongoingLoads.delete(s),o?o.resource?(o.options=t,this.add(o)):o:(l.sendTraceTag(509161993,n.msoulscat_Wac_PptLive,r.Error,"PowerPointResourceProvider::load - failed to load resource. "+JSON.stringify({requestedLoadKey:s,resourceIdsInCache:JSON.stringify(this.getAllLoadResultsInCache().map(e=>e.resourceId))})),a)}add(e){const t=this.getLoadResultInCache(e.resourceId,e.options);if(t)return t;const i=u.removeMetadata(e.options);return e.options=i,e.metadata.created=e.metadata.created?e.metadata.created:new Date,e.metadata.lastAccessed=new Date,e.metadata.resourceUsers=[],e.metadata.optionsKey=JSON.stringify(i),this.loadResults.push(e),u.updateMetadata(e,e.options),e}remove(e,t){const i=this.getLoadResultInCache(e,t);if(!i)return!1;const r=this.loadResults.splice(this.loadResults.indexOf(i),1);return this.events.emit("removed",r),!0}getAllLoadResultsInCache(){return this.loadResults}getLoadResultsInCache(e){return this.loadResults.filter(t=>t.resourceId===e)}getLoadResultInCache(e,t){const i=JSON.stringify(u.removeMetadata(t)),r=this.loadResults.filter(t=>t.resourceId===e&&t.metadata.optionsKey===i)[0];if(r)return u.updateMetadata(r,t),r}static removeMetadata(e){if(void 0===e)return;const t=Object.keys(e).filter(e=>!e.startsWith("meta_"));if(0===t.length)return;const i={};return t.map(t=>{i[t]=e[t]}),i}static updateMetadata(e,t){t&&(e.metadata.lastAccessed=new Date,t.meta_user&&!e.metadata.resourceUsers.includes(t.meta_user)&&e.metadata.resourceUsers.push(t.meta_user))}}class f extends u{constructor(e,t,i){super(t,i),this.ongoingBatchLoads=new Map,this.m_batchLoader=e}async batchLoad(e){try{if(!e||e.length<=0)return l.sendTraceTag(574961730,n.msoulscat_Wac_PptLive,r.Error,"BatchResourceProvider::batchLoad - Invalid loadRequestList"),[];let t,i=[],a=[];for(let t=0;t<e.length;t+=1){let r=e[t];const n=this.getLoadResultInCache(r.resourceId,r.options);if(n)a.push(n);else{const e=`${r.resourceId}_${JSON.stringify(u.removeMetadata(r.options))}`;this.ongoingBatchLoads.get(e)||i.push(r)}}i.length>0&&(t=this.m_batchLoader.batchLoad(i),i.forEach(e=>{if(t){const i=`${e.resourceId}_${JSON.stringify(u.removeMetadata(e.options))}`;this.ongoingBatchLoads.set(i,t)}}));let s=[];return t&&(s=await t,i.forEach(e=>{const t=`${e.resourceId}_${JSON.stringify(u.removeMetadata(e.options))}`;this.ongoingBatchLoads.delete(t)})),s.forEach(e=>{this.add(e)}),a.concat(s)}catch(e){return l.sendTraceTag(574961731,n.msoulscat_Wac_PptLive,r.Error,"BatchResourceProvider::batchLoad - exception occured: "+e),[]}}}},function(e,t,i){"use strict";(function(e){var r=i(272),n=i(273),a=i(176);function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,i){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,i);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return d(this,e,t,i)}function d(e,t,i,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,i,r){if(t.byteLength,i<0||t.byteLength<i)throw new RangeError("'offset' is out of bounds");if(t.byteLength<i+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===i&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,i):new Uint8Array(t,i,r),l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=u(e,t),e}(e,t,i,r):"string"==typeof t?function(e,t,i){if("string"==typeof i&&""!==i||(i="utf8"),!l.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var r=0|m(t,i),n=(e=o(e,r)).write(t,i);return n!==r&&(e=e.slice(0,n)),e}(e,t,i):function(e,t){if(l.isBuffer(t)){var i=0|f(t.length);return 0===(e=o(e,i)).length||t.copy(e,0,0,i),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?o(e,0):u(e,t);if("Buffer"===t.type&&a(t.data))return u(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t){if(h(t),e=o(e,t<0?0:0|f(t)),!l.TYPED_ARRAY_SUPPORT)for(var i=0;i<t;++i)e[i]=0;return e}function u(e,t){var i=t.length<0?0:0|f(t.length);e=o(e,i);for(var r=0;r<i;r+=1)e[r]=255&t[r];return e}function f(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function m(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var i=e.length;if(0===i)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return W(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function p(e,t,i){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return x(this,t,i);case"utf8":case"utf-8":return I(this,t,i);case"ascii":return P(this,t,i);case"latin1":case"binary":return E(this,t,i);case"base64":return C(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,i);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,i){var r=e[t];e[t]=e[i],e[i]=r}function _(e,t,i,r,n){if(0===e.length)return-1;if("string"==typeof i?(r=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=n?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(n)return-1;i=e.length-1}else if(i<0){if(!n)return-1;i=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:v(e,t,i,r,n);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):v(e,[t],i,r,n);throw new TypeError("val must be string, number or Buffer")}function v(e,t,i,r,n){var a,s=1,o=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,o/=2,l/=2,i/=2}function d(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(n){var h=-1;for(a=i;a<o;a++)if(d(e,a)===d(t,-1===h?0:a-h)){if(-1===h&&(h=a),a-h+1===l)return h*s}else-1!==h&&(a-=a-h),h=-1}else for(i+l>o&&(i=o-l),a=i;a>=0;a--){for(var c=!0,u=0;u<l;u++)if(d(e,a+u)!==d(t,u)){c=!1;break}if(c)return a}return-1}function y(e,t,i,r){i=Number(i)||0;var n=e.length-i;r?(r=Number(r))>n&&(r=n):r=n;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var s=0;s<r;++s){var o=parseInt(t.substr(2*s,2),16);if(isNaN(o))return s;e[i+s]=o}return s}function b(e,t,i,r){return z(U(t,e.length-i),e,i,r)}function S(e,t,i,r){return z(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,r)}function T(e,t,i,r){return S(e,t,i,r)}function w(e,t,i,r){return z(W(t),e,i,r)}function M(e,t,i,r){return z(function(e,t){for(var i,r,n,a=[],s=0;s<e.length&&!((t-=2)<0);++s)r=(i=e.charCodeAt(s))>>8,n=i%256,a.push(n),a.push(r);return a}(t,e.length-i),e,i,r)}function C(e,t,i){return 0===t&&i===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,i))}function I(e,t,i){i=Math.min(e.length,i);for(var r=[],n=t;n<i;){var a,s,o,l,d=e[n],h=null,c=d>239?4:d>223?3:d>191?2:1;if(n+c<=i)switch(c){case 1:d<128&&(h=d);break;case 2:128==(192&(a=e[n+1]))&&(l=(31&d)<<6|63&a)>127&&(h=l);break;case 3:a=e[n+1],s=e[n+2],128==(192&a)&&128==(192&s)&&(l=(15&d)<<12|(63&a)<<6|63&s)>2047&&(l<55296||l>57343)&&(h=l);break;case 4:a=e[n+1],s=e[n+2],o=e[n+3],128==(192&a)&&128==(192&s)&&128==(192&o)&&(l=(15&d)<<18|(63&a)<<12|(63&s)<<6|63&o)>65535&&l<1114112&&(h=l)}null===h?(h=65533,c=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),n+=c}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var i="",r=0;r<t;)i+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return i}(r)}function P(e,t,i){var r="";i=Math.min(e.length,i);for(var n=t;n<i;++n)r+=String.fromCharCode(127&e[n]);return r}function E(e,t,i){var r="";i=Math.min(e.length,i);for(var n=t;n<i;++n)r+=String.fromCharCode(e[n]);return r}function x(e,t,i){var r=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>r)&&(i=r);for(var n="",a=t;a<i;++a)n+=V(e[a]);return n}function A(e,t,i){for(var r=e.slice(t,i),n="",a=0;a<r.length;a+=2)n+=String.fromCharCode(r[a]+256*r[a+1]);return n}function k(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,i,r,n,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<a)throw new RangeError('"value" argument is out of bounds');if(i+r>e.length)throw new RangeError("Index out of range")}function O(e,t,i,r){t<0&&(t=65535+t+1);for(var n=0,a=Math.min(e.length-i,2);n<a;++n)e[i+n]=(t&255<<8*(r?n:1-n))>>>8*(r?n:1-n)}function L(e,t,i,r){t<0&&(t=4294967295+t+1);for(var n=0,a=Math.min(e.length-i,4);n<a;++n)e[i+n]=t>>>8*(r?n:3-n)&255}function F(e,t,i,r,n,a){if(i+r>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function D(e,t,i,r,a){return a||F(e,0,i,4),n.write(e,t,i,r,23,4),i+4}function B(e,t,i,r,a){return a||F(e,0,i,8),n.write(e,t,i,r,52,8),i+8}t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,i){return d(null,e,t,i)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,i){return function(e,t,i,r){return h(t),t<=0?o(e,t):void 0!==i?"string"==typeof r?o(e,t).fill(i,r):o(e,t).fill(i):o(e,t)}(null,e,t,i)},l.allocUnsafe=function(e){return c(null,e)},l.allocUnsafeSlow=function(e){return c(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var i=e.length,r=t.length,n=0,a=Math.min(i,r);n<a;++n)if(e[n]!==t[n]){i=e[n],r=t[n];break}return i<r?-1:r<i?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var i;if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var r=l.allocUnsafe(t),n=0;for(i=0;i<e.length;++i){var s=e[i];if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,n),n+=s.length}return r},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?I(this,0,e):p.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",i=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,i,r,n){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===r&&(r=0),void 0===n&&(n=this.length),t<0||i>e.length||r<0||n>this.length)throw new RangeError("out of range index");if(r>=n&&t>=i)return 0;if(r>=n)return-1;if(t>=i)return 1;if(this===e)return 0;for(var a=(n>>>=0)-(r>>>=0),s=(i>>>=0)-(t>>>=0),o=Math.min(a,s),d=this.slice(r,n),h=e.slice(t,i),c=0;c<o;++c)if(d[c]!==h[c]){a=d[c],s=h[c];break}return a<s?-1:s<a?1:0},l.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},l.prototype.indexOf=function(e,t,i){return _(this,e,t,i,!0)},l.prototype.lastIndexOf=function(e,t,i){return _(this,e,t,i,!1)},l.prototype.write=function(e,t,i,r){if(void 0===t)r="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)r=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(i)?(i|=0,void 0===r&&(r="utf8")):(r=i,i=void 0)}var n=this.length-t;if((void 0===i||i>n)&&(i=n),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return y(this,e,t,i);case"utf8":case"utf-8":return b(this,e,t,i);case"ascii":return S(this,e,t,i);case"latin1":case"binary":return T(this,e,t,i);case"base64":return w(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,e,t,i);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},l.prototype.slice=function(e,t){var i,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(i=this.subarray(e,t)).__proto__=l.prototype;else{var n=t-e;i=new l(n,void 0);for(var a=0;a<n;++a)i[a]=this[a+e]}return i},l.prototype.readUIntLE=function(e,t,i){e|=0,t|=0,i||k(e,t,this.length);for(var r=this[e],n=1,a=0;++a<t&&(n*=256);)r+=this[e+a]*n;return r},l.prototype.readUIntBE=function(e,t,i){e|=0,t|=0,i||k(e,t,this.length);for(var r=this[e+--t],n=1;t>0&&(n*=256);)r+=this[e+--t]*n;return r},l.prototype.readUInt8=function(e,t){return t||k(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||k(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||k(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||k(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||k(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,i){e|=0,t|=0,i||k(e,t,this.length);for(var r=this[e],n=1,a=0;++a<t&&(n*=256);)r+=this[e+a]*n;return r>=(n*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,i){e|=0,t|=0,i||k(e,t,this.length);for(var r=t,n=1,a=this[e+--r];r>0&&(n*=256);)a+=this[e+--r]*n;return a>=(n*=128)&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return t||k(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||k(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt16BE=function(e,t){t||k(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt32LE=function(e,t){return t||k(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||k(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||k(e,4,this.length),n.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||k(e,4,this.length),n.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||k(e,8,this.length),n.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||k(e,8,this.length),n.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,i,r){e=+e,t|=0,i|=0,r||R(this,e,t,i,Math.pow(2,8*i)-1,0);var n=1,a=0;for(this[t]=255&e;++a<i&&(n*=256);)this[t+a]=e/n&255;return t+i},l.prototype.writeUIntBE=function(e,t,i,r){e=+e,t|=0,i|=0,r||R(this,e,t,i,Math.pow(2,8*i)-1,0);var n=i-1,a=1;for(this[t+n]=255&e;--n>=0&&(a*=256);)this[t+n]=e/a&255;return t+i},l.prototype.writeUInt8=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,i,r){if(e=+e,t|=0,!r){var n=Math.pow(2,8*i-1);R(this,e,t,i,n-1,-n)}var a=0,s=1,o=0;for(this[t]=255&e;++a<i&&(s*=256);)e<0&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+i},l.prototype.writeIntBE=function(e,t,i,r){if(e=+e,t|=0,!r){var n=Math.pow(2,8*i-1);R(this,e,t,i,n-1,-n)}var a=i-1,s=1,o=0;for(this[t+a]=255&e;--a>=0&&(s*=256);)e<0&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+i},l.prototype.writeInt8=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,i){return e=+e,t|=0,i||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,i){return D(this,e,t,!0,i)},l.prototype.writeFloatBE=function(e,t,i){return D(this,e,t,!1,i)},l.prototype.writeDoubleLE=function(e,t,i){return B(this,e,t,!0,i)},l.prototype.writeDoubleBE=function(e,t,i){return B(this,e,t,!1,i)},l.prototype.copy=function(e,t,i,r){if(i||(i=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<i&&(r=i),r===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-i&&(r=e.length-t+i);var n,a=r-i;if(this===e&&i<t&&t<r)for(n=a-1;n>=0;--n)e[n+t]=this[n+i];else if(a<1e3||!l.TYPED_ARRAY_SUPPORT)for(n=0;n<a;++n)e[n+t]=this[n+i];else Uint8Array.prototype.set.call(e,this.subarray(i,i+a),t);return a},l.prototype.fill=function(e,t,i,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;var a;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(a=t;a<i;++a)this[a]=e;else{var s=l.isBuffer(e)?e:U(new l(e,r).toString()),o=s.length;for(a=0;a<i-t;++a)this[a+t]=s[a%o]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function V(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var i;t=t||1/0;for(var r=e.length,n=null,a=[],s=0;s<r;++s){if((i=e.charCodeAt(s))>55295&&i<57344){if(!n){if(i>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&a.push(239,191,189);continue}n=i;continue}if(i<56320){(t-=3)>-1&&a.push(239,191,189),n=i;continue}i=65536+(n-55296<<10|i-56320)}else n&&(t-=3)>-1&&a.push(239,191,189);if(n=null,i<128){if((t-=1)<0)break;a.push(i)}else if(i<2048){if((t-=2)<0)break;a.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;a.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return a}function W(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(N,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function z(e,t,i,r){for(var n=0;n<r&&!(n+i>=t.length||n>=e.length);++n)t[n+i]=e[n];return n}}).call(this,i(55))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(28);r.__exportStar(i(251),t),r.__exportStar(i(402),t),r.__exportStar(i(403),t),r.__exportStar(i(404),t)},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(){function e(){}return e._AddLogEntry=function(t){e._LogCache=t+e._LogCache,e.OnNewCacheEntry&&e.OnNewCacheEntry(t)},e._FormatMessage=function(e){var t=function(e){return e<10?"0"+e:""+e},i=new Date;return"["+t(i.getHours())+":"+t(i.getMinutes())+":"+t(i.getSeconds())+"]: "+e},e._LogDisabled=function(e){},e._LogEnabled=function(t){var i=e._FormatMessage(t);console.log("BJS - "+i);var r="<div style='color:white'>"+i+"</div><br>";e._AddLogEntry(r)},e._WarnDisabled=function(e){},e._WarnEnabled=function(t){var i=e._FormatMessage(t);console.warn("BJS - "+i);var r="<div style='color:orange'>"+i+"</div><br>";e._AddLogEntry(r)},e._ErrorDisabled=function(e){},e._ErrorEnabled=function(t){e.errorsCount++;var i=e._FormatMessage(t);console.error("BJS - "+i);var r="<div style='color:red'>"+i+"</div><br>";e._AddLogEntry(r)},Object.defineProperty(e,"LogCache",{get:function(){return e._LogCache},enumerable:!1,configurable:!0}),e.ClearLogCache=function(){e._LogCache="",e.errorsCount=0},Object.defineProperty(e,"LogLevels",{set:function(t){(t&e.MessageLogLevel)===e.MessageLogLevel?e.Log=e._LogEnabled:e.Log=e._LogDisabled,(t&e.WarningLogLevel)===e.WarningLogLevel?e.Warn=e._WarnEnabled:e.Warn=e._WarnDisabled,(t&e.ErrorLogLevel)===e.ErrorLogLevel?e.Error=e._ErrorEnabled:e.Error=e._ErrorDisabled},enumerable:!1,configurable:!0}),e.NoneLogLevel=0,e.MessageLogLevel=1,e.WarningLogLevel=2,e.ErrorLogLevel=4,e.AllLogLevel=7,e._LogCache="",e.errorsCount=0,e.Log=e._LogEnabled,e.Warn=e._WarnEnabled,e.Error=e._ErrorEnabled,e}()},function(e,t,i){"use strict";i.r(t),i.d(t,"InternalTextureSource",(function(){return r})),i.d(t,"InternalTexture",(function(){return o}));var r,n=i(77),a=i(135),s=i(74);!function(e){e[e.Unknown=0]="Unknown",e[e.Url=1]="Url",e[e.Temp=2]="Temp",e[e.Raw=3]="Raw",e[e.Dynamic=4]="Dynamic",e[e.RenderTarget=5]="RenderTarget",e[e.MultiRenderTarget=6]="MultiRenderTarget",e[e.Cube=7]="Cube",e[e.CubeRaw=8]="CubeRaw",e[e.CubePrefiltered=9]="CubePrefiltered",e[e.Raw3D=10]="Raw3D",e[e.Raw2DArray=11]="Raw2DArray",e[e.Depth=12]="Depth",e[e.CubeRawRGBD=13]="CubeRawRGBD"}(r||(r={}));var o=function(){function e(e,t,i){void 0===i&&(i=!1),this.isReady=!1,this.isCube=!1,this.is3D=!1,this.is2DArray=!1,this.isMultiview=!1,this.url="",this.samplingMode=-1,this.generateMipMaps=!1,this.samples=0,this.type=-1,this.format=-1,this.onLoadedObservable=new n.a,this.width=0,this.height=0,this.depth=0,this.baseWidth=0,this.baseHeight=0,this.baseDepth=0,this.invertY=!1,this._invertVScale=!1,this._associatedChannel=-1,this._source=r.Unknown,this._buffer=null,this._bufferView=null,this._bufferViewArray=null,this._bufferViewArrayArray=null,this._size=0,this._extension="",this._files=null,this._workingCanvas=null,this._workingContext=null,this._framebuffer=null,this._depthStencilBuffer=null,this._MSAAFramebuffer=null,this._MSAARenderBuffer=null,this._attachments=null,this._textureArray=null,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._isDisabled=!1,this._compression=null,this._generateStencilBuffer=!1,this._generateDepthBuffer=!1,this._comparisonFunction=0,this._sphericalPolynomial=null,this._lodGenerationScale=0,this._lodGenerationOffset=0,this._colorTextureArray=null,this._depthStencilTextureArray=null,this._lodTextureHigh=null,this._lodTextureMid=null,this._lodTextureLow=null,this._isRGBD=!1,this._linearSpecularLOD=!1,this._irradianceTexture=null,this._webGLTexture=null,this._references=1,this._gammaSpace=null,this._engine=e,this._source=t,i||(this._webGLTexture=e._createTexture())}return e.prototype.getEngine=function(){return this._engine},Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),e.prototype.incrementReferences=function(){this._references++},e.prototype.updateSize=function(e,t,i){void 0===i&&(i=1),this.width=e,this.height=t,this.depth=i,this.baseWidth=e,this.baseHeight=t,this.baseDepth=i,this._size=e*t*i},e.prototype._rebuild=function(){var t,i,n=this;switch(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedAnisotropicFilteringLevel=null,this.source){case r.Temp:return;case r.Url:return void(i=this._engine.createTexture(null!==(t=this._originalUrl)&&void 0!==t?t:this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,(function(){i._swapAndDie(n),n.isReady=!0}),null,this._buffer,void 0,this.format));case r.Raw:return(i=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this),void(this.isReady=!0);case r.Raw3D:return(i=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this),void(this.isReady=!0);case r.Raw2DArray:return(i=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this),void(this.isReady=!0);case r.Dynamic:return(i=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode))._swapAndDie(this),void this._engine.updateDynamicTexture(this,this._engine.getRenderingCanvas(),this.invertY,void 0,void 0,!0);case r.RenderTarget:var s=new a.a;if(s.generateDepthBuffer=this._generateDepthBuffer,s.generateMipMaps=this.generateMipMaps,s.generateStencilBuffer=this._generateStencilBuffer,s.samplingMode=this.samplingMode,s.type=this.type,this.isCube)i=this._engine.createRenderTargetCubeTexture(this.width,s);else{var o={width:this.width,height:this.height,layers:this.is2DArray?this.depth:void 0};i=this._engine.createRenderTargetTexture(o,s)}return i._swapAndDie(this),void(this.isReady=!0);case r.Depth:var l={bilinearFiltering:2!==this.samplingMode,comparisonFunction:this._comparisonFunction,generateStencil:this._generateStencilBuffer,isCube:this.isCube},d={width:this.width,height:this.height,layers:this.is2DArray?this.depth:void 0};return(i=this._engine.createDepthStencilTexture(d,l))._swapAndDie(this),void(this.isReady=!0);case r.Cube:return void(i=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,(function(){i._swapAndDie(n),n.isReady=!0}),null,this.format,this._extension));case r.CubeRaw:return(i=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this),void(this.isReady=!0);case r.CubeRawRGBD:return i=this._engine.createRawCubeTexture(null,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression),void e._UpdateRGBDAsync(i,this._bufferViewArrayArray,this._sphericalPolynomial,this._lodGenerationScale,this._lodGenerationOffset).then((function(){i._swapAndDie(n),n.isReady=!0}));case r.CubePrefiltered:return void((i=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,(function(e){e&&e._swapAndDie(n),n.isReady=!0}),null,this.format,this._extension))._sphericalPolynomial=this._sphericalPolynomial)}},e.prototype._swapAndDie=function(e){e._webGLTexture=this._webGLTexture,e._isRGBD=this._isRGBD,this._framebuffer&&(e._framebuffer=this._framebuffer),this._depthStencilBuffer&&(e._depthStencilBuffer=this._depthStencilBuffer),e._depthStencilTexture=this._depthStencilTexture,this._lodTextureHigh&&(e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(e._lodTextureLow&&e._lodTextureLow.dispose(),e._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(e._irradianceTexture&&e._irradianceTexture.dispose(),e._irradianceTexture=this._irradianceTexture);var t,i=this._engine.getLoadedTexturesCache();-1!==(t=i.indexOf(this))&&i.splice(t,1),-1===(t=i.indexOf(e))&&i.push(e)},e.prototype.dispose=function(){this._webGLTexture&&(this._references--,0===this._references&&(this._engine._releaseTexture(this),this._webGLTexture=null))},e._UpdateRGBDAsync=function(e,t,i,r,n){throw s.a.WarnImport("environmentTextureTools")},e}()},function(e,t,i){"use strict";function r(e,t){Object.assign(e.style,t)}i.d(t,"a",(function(){return r}))},function(e,t){var i,r,n=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(i===setTimeout)return setTimeout(e,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(e){i=a}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var l,d=[],h=!1,c=-1;function u(){h&&l&&(h=!1,l.length?d=l.concat(d):c=-1,d.length&&f())}function f(){if(!h){var e=o(u);h=!0;for(var t=d.length;t;){for(l=d,d=[];++c<t;)l&&l[c].run();c=-1,t=d.length}l=null,h=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];d.push(new m(e,t)),1!==d.length||h||o(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t,i){"use strict";function r(e,t,i,r,n,a,s,o,l,d,h,c,u,f,m,p){var g=new Float32Array(16);return g[0]=e,g[1]=t,g[2]=i,g[3]=r,g[4]=n,g[5]=a,g[6]=s,g[7]=o,g[8]=l,g[9]=d,g[10]=h,g[11]=c,g[12]=u,g[13]=f,g[14]=m,g[15]=p,g}function n(){return r(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}Object.defineProperty(t,"__esModule",{value:!0}),t.mat16=r,t.mat16Identity=n,t.mat16Mul=function(e,t){for(var i=n(),r=0;r<4;r+=1)i[4*r+0]=e[4*r+0]*t[0]+e[4*r+1]*t[4]+e[4*r+2]*t[8]+e[4*r+3]*t[12],i[4*r+1]=e[4*r+0]*t[1]+e[4*r+1]*t[5]+e[4*r+2]*t[9]+e[4*r+3]*t[13],i[4*r+2]=e[4*r+0]*t[2]+e[4*r+1]*t[6]+e[4*r+2]*t[10]+e[4*r+3]*t[14],i[4*r+3]=e[4*r+0]*t[3]+e[4*r+1]*t[7]+e[4*r+2]*t[11]+e[4*r+3]*t[15];return i},t.mat16MulVec3=function(e,t,i,r){for(var n=[0,0,0,0],a=0;a<4;a+=1)n[a]=e[0+a]*t+e[4+a]*i+e[8+a]*r+e[12+a];return n},t.mat16Translate=function(e,t,i){var r=n();return r[12]=e,r[13]=t,r[14]=i,r},t.mat16TranslateColumn=function(e,t,i){var r=n();return r[3]=e,r[7]=t,r[11]=i,r},t.mat16Scale=function(e,t,i){var r=n();return r[0]=e,r[5]=t,r[10]=i,r},t.mat16RotateX=function(e){var t=Math.cos(e),i=Math.sin(e);return r(1,0,0,0,0,t,i,0,0,-i,t,0,0,0,0,1)},t.mat16RotateY=function(e){var t=Math.cos(e),i=Math.sin(e);return r(t,0,-i,0,0,1,0,0,i,0,t,0,0,0,0,1)},t.mat16RotateZ=function(e){var t=Math.cos(e),i=Math.sin(e);return r(t,i,0,0,-i,t,0,0,0,0,1,0,0,0,0,1)},t.mat16Prespective=function(){return r(1,0,0,0,0,1,0,0,1.5,1.5,1,3,0,0,0,1)},t.enableVertexAttribArray=function(e,t,i){var r=e.getAttribLocation(t,i);return e.enableVertexAttribArray(r),r},t.bindArrayBufferToVertexAttribPointer=function(e,t,i,r,n){e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(i,r,n,!1,0,0)},t.initTexture=function(e,t,i,r,n,a){e.bindTexture(e.TEXTURE_2D,t);var s=new Uint8Array(i);e.texImage2D(e.TEXTURE_2D,0,r,n,a,0,r,e.UNSIGNED_BYTE,s)},t.initReflectionMask=function(e,t,i,r){for(var n=new Uint8Array(4*i),a=0;a<i;a+=1){var s=a/i;n[4*a+0]=0,n[4*a+1]=0,n[4*a+2]=0,n[4*a+3]=230*Math.pow(s,r)}e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,i,0,e.RGBA,e.UNSIGNED_BYTE,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR)}},function(e,t,i){"use strict";function r(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0}),r(i(98)),r(i(57)),r(i(379)),r(i(161)),r(i(399)),r(i(72)),r(i(234)),r(i(53)),r(i(92)),r(i(238)),r(i(236)),r(i(240)),r(i(241)),r(i(237)),r(i(239)),r(i(242)),r(i(243)),r(i(244)),r(i(245)),r(i(401)),r(i(250)),r(i(32)),r(i(246)),r(i(248)),r(i(247)),r(i(249)),r(i(235)),r(i(162))},function(e,t,i){"use strict";var r;i.d(t,"a",(function(){return r})),function(e){e.ErrorNone="ErrorNone",e.ErrorInvalidStartInput="ErrorInvalidStartInput",e.ErrorStreamStartFailure="ErrorStreamStartFailure",e.ErrorNoVideoTracks="ErrorNoVideoTracks",e.ErrorWebView2NotAvailable="ErrorWebView2NotAvailable",e.ErrorVideoPlaybackFailed="ErrorVideoPlaybackFailed",e.ErrorUnknown="ErrorUnknown"}(r||(r={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(134),n=i(32);t.bindDrawInfo=function(e){return e.engine.enableEffect(e.shaderProgram),e.vertexArrayObject?e.engine.bindVertexArrayObject(e.vertexArrayObject,e.vertexIndexBuffer):e.engine.bindBuffers(e.vertexBuffers,e.vertexIndexBuffer,e.shaderProgram),e.shaderProgram},t.drawTriangles=function(e){e.engine.draw(!0,0,e.vertexIndexLength)},t.createDrawInfo=function(e,t,i,a,s,o,l){var d=r.activateShader(e,s);if(d){var h,c=t.createVertexBuffers(l),u=t.createIndexBuffer(o),f=o.length,m=e.wrapExternalTexture(i),p=e.wrapExternalTexture(a);return e.getCaps().vertexArrayObject&&(h=t.recordVertexArrayObject(c,u,d)),{engine:e,shaderProgram:d,vertexBuffers:c,vertexIndexBuffer:u,vertexIndexLength:f,incomingSlideTexture:m,outgoingSlideTexture:p,vertexArrayObject:h,autoClear:!0}}n.logError("Can not init shaders, initialization failed.")},t.setDepthBlendCulling=function(e,t,i,r){void 0===t&&(t=!1),void 0===i&&(i=!1),void 0===r&&(r=0),e.depthCullingState.depthTest=t,e.setTranstionBlend(i),0===r?e.depthCullingState.cull=!1:(e.depthCullingState.cull=!0,e.depthCullingState.cullFace=r)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(400),n=function(){function e(){}return e.prototype.init=function(e,t){this.gl=e.gl,this.gl&&(this.resourcesManager=new r.ResourcesManager(this.gl,t))},e.prototype.dispose=function(){if(this.resourcesManager&&(this.resourcesManager.dispose(),this.gl))for(var e=this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),t=0;t<e;t+=1)this.gl.disableVertexAttribArray(t)},e.prototype.createBuffer=function(){var e;return(null===(e=this.resourcesManager)||void 0===e?void 0:e.createBuffer())||null},e.prototype.createTexture=function(){var e;return(null===(e=this.resourcesManager)||void 0===e?void 0:e.createTexture())||null},e}();t.BaseTransition=n,t.isTransitionReadyForDraw=function(e){return null!=e&&!e.isContextLost()}},function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i(6),n=i(70),a=i.n(n),s=i(4),o=i(2),l=i(3),d=i(63);class h{static areSyncStatesEqual(e,t,i){if(void 0===e&&void 0===t)return!0;if(void 0===e||void 0===t)return!1;if(i){const i=h.syncStateToSlideLocation(e),r=h.syncStateToSlideLocation(t);return a()(i.slideId,r.slideId)||i.slideIndex===r.slideIndex}const r=h.syncStateToSlideLocation(e),n=h.syncStateToSlideLocation(t),s=h.syncStateToAnimationState(e),o=h.syncStateToAnimationState(t);return!(!a()(r.slideId,n.slideId)&&r.slideIndex!==n.slideIndex)&&a()(s,o)}static syncStateToSlideLocation(e){return{slideId:null!=e.slideId?e.slideId:void 0,slideIndex:null!=e.slideIndex?e.slideIndex:void 0}}static syncStateToAnimationState(e){return{timelineStates:e.timelineStates}}static toSyncState(e,t){let i={},n=[];return s.a.sendTraceTag(507790047,o.a.msoulscat_Wac_PptSlideshow,l.a.Info,`SyncUtil:: toSyncState slideLocation: ${JSON.stringify(e)} and animationState: ${JSON.stringify(t)}`),t&&(r.ChangeGate.isChangeGateEnabled("SSA.nullCheckTimelineStates")&&!t.timelineStates?s.a.sendTraceTag(507790046,o.a.msoulscat_Wac_PptSlideshow,l.a.Error,"SyncUtil:: Error "+Object(d.b)(new Error("Invalid timelineStates"))):(t.timelineStates.forEach(e=>{n.push({timelineId:e.timelineId,step:e.step})}),i.timelineStates=t?n:void 0)),i.slideId=null!=e.slideId?e.slideId:void 0,i.slideIndex=null!=e.slideIndex?e.slideIndex:void 0,i}}},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(232),n=i(49),a=i(32),s=[r.tp_0,r.tp_1,r.tp_2,r.tp_3,r.tp_4,r.tp_5,r.tp_6,r.tp_7,r.tp_8,r.tp_9],o=new Array(10);function l(e,t){try{if(t>=10)return;if(o[t]&&e.isProgram(o[t].program)||(o[t]={loadState:0}),o[t].loadState<1&&(o[t]=function(e,t,i,r,n){var s={};return s.v=h(e,t.v,e.VERTEX_SHADER),s.f=h(e,t.f,e.FRAGMENT_SHADER),s.v&&s.f?(s.program=e.createProgram(),null==s.program?(a.logError("Unable to initialize shader program"),null):(s.fUseTexcoord=!0,s.fSampler1=!0,s.fSampler2=!0,s.loadState=1,s)):null}(e,s[t]),!o[t]))throw new Error("Shader creation failed, about to crash ProgramId: "+t+" isContextLost: "+e.isContextLost())}catch(e){a.logError("Exception occured at preCompileShaderAsync in ShaderProgram "+t+" : "+e)}}function d(e,t){try{if(t>=10)return;o[t]||(o[t]={loadState:0}),o[t].loadState<2&&function(e,t){e.attachShader(t.program,t.v),e.attachShader(t.program,t.f),e.linkProgram(t.program),t.loadState=2}(e,o[t])}catch(e){a.logError("Exception occured at preLinkShaderAsync in ShaderProgram "+t+" : "+e)}}function h(e,t,i){var r=e.createShader(i);return r?(e.shaderSource(r,t),e.compileShader(r),r):(a.logError("Shader creation failed, about to crash Type: "+i+", isContextLost:"+e.isContextLost()),null)}t.preCompileShaderAsync=l,t.preLinkShaderAsync=d,t.activateShader=function(e,t){var i=null;try{if(t>=10||e.isContextLost())return null;if(o[t]||(o[t]={loadState:0}),o[t].loadState<1&&l(e,t),o[t].loadState<2&&d(e,t),3!==(i=o[t]).loadState){if(!e.getShaderParameter(i.v,e.COMPILE_STATUS))throw new Error("Shader "+t+"V compile failed:"+e.getShaderInfoLog(i.v));if(!e.getShaderParameter(i.f,e.COMPILE_STATUS))throw new Error("Shader "+t+"F compile failed:"+e.getShaderInfoLog(i.f));if(!e.getProgramParameter(i.program,e.LINK_STATUS))throw new Error("Shader "+t+" link failed:"+e.getProgramInfoLog(i.program));i.loadState=3}3===i.loadState&&function(e,t,i){switch(e||a.logError("shader program "+t+" object undefined"),t){case 2:e.vertexPositionAttribute=n.enableVertexAttribArray(i,e.program,"aPosition"),e.textureCoordAttribute=n.enableVertexAttribArray(i,e.program,"aTexcoord"),e.matrixUniform=i.getUniformLocation(e.program,"uModelViewProj"),e.sampler1Uniform=i.getUniformLocation(e.program,"uSampler1");break;case 1:e.vertexPositionAttribute=n.enableVertexAttribArray(i,e.program,"aPosition"),e.textureCoordAttribute=n.enableVertexAttribArray(i,e.program,"aTexcoord"),e.vertexDelayAttribute=n.enableVertexAttribArray(i,e.program,"aDelay"),e.vertexDirectionAttribute=n.enableVertexAttribArray(i,e.program,"aDirection"),e.matrixUniform=i.getUniformLocation(e.program,"uModelViewProj"),e.progressUniform=i.getUniformLocation(e.program,"uProgress"),e.factorUniform=i.getUniformLocation(e.program,"uFactor"),e.opacityUniform=i.getUniformLocation(e.program,"uOpacity"),e.sampler1Uniform=i.getUniformLocation(e.program,"uSampler1");break;case 3:e.vertexPositionAttribute=n.enableVertexAttribArray(i,e.program,"aPosition"),e.textureCoordAttribute=n.enableVertexAttribArray(i,e.program,"aTexcoord"),e.vertexCenterAttribute=n.enableVertexAttribArray(i,e.program,"aCenter"),e.vertexDelayAttribute=n.enableVertexAttribArray(i,e.program,"aDelay"),e.matrixUniform=i.getUniformLocation(e.program,"uModelViewProj"),e.progressUniform=i.getUniformLocation(e.program,"uProgress"),e.factorUniform=i.getUniformLocation(e.program,"uFactor"),e.zMovementUniform=i.getUniformLocation(e.program,"uZmovement"),e.directionUniform=i.getUniformLocation(e.program,"uDirection"),e.anglePlusUniform=i.getUniformLocation(e.program,"uAnglePlus"),e.maxAngleUniform=i.getUniformLocation(e.program,"uMaxAngle"),e.zCenterUniform=i.getUniformLocation(e.program,"uZCenter"),e.xAxisUniform=i.getUniformLocation(e.program,"uXAxis");break;case 0:e.vertexPositionAttribute=n.enableVertexAttribArray(i,e.program,"aPosition"),e.textureCoordAttribute=n.enableVertexAttribArray(i,e.program,"aTexcoord"),e.vertexDelayAttribute=n.enableVertexAttribArray(i,e.program,"aDelay"),e.matrixUniform=i.getUniformLocation(e.program,"uModelViewProj"),e.progressUniform=i.getUniformLocation(e.program,"uProgress"),e.factorUniform=i.getUniformLocation(e.program,"uFactor"),e.styleUniform=i.getUniformLocation(e.program,"uStyle"),e.sampler1Uniform=i.getUniformLocation(e.program,"uSampler1"),e.sampler2Uniform=i.getUniformLocation(e.program,"uSampler2");break;case 6:e.vertexPositionAttribute=n.enableVertexAttribArray(i,e.program,"aPosition"),e.vertexNormalAttribute=n.enableVertexAttribArray(i,e.program,"aNormal"),e.textureCoordAttribute=n.enableVertexAttribArray(i,e.program,"aTexCoord"),e.uModelToView=i.getUniformLocation(e.program,"uModelToView"),e.uModelToWorld=i.getUniformLocation(e.program,"uModelToWorld"),e.uModelToWorldIT=i.getUniformLocation(e.program,"uModelToWorldIT"),e.uLightPosition=i.getUniformLocation(e.program,"uLightPosition"),e.uAmbientColor=i.getUniformLocation(e.program,"uAmbientColor"),e.uDiffuseColor=i.getUniformLocation(e.program,"uDiffuseColor"),e.uIsNormalDirectionChangeReq=i.getUniformLocation(e.program,"uIsNormalDirectionChangeReq"),e.samplerUniform1=i.getUniformLocation(e.program,"uSampler");break;case 4:e.vertexPositionAttribute=n.enableVertexAttribArray(i,e.program,"aPosition"),e.textureCoordAttribute=n.enableVertexAttribArray(i,e.program,"aTexcoord"),e.vertexDistanceAttribute=n.enableVertexAttribArray(i,e.program,"aDistance"),e.matrixUniform=i.getUniformLocation(e.program,"uModelViewProj"),e.progressUniform=i.getUniformLocation(e.program,"uProgress"),e.sampler1Uniform=i.getUniformLocation(e.program,"uSampler1"),e.sampler2Uniform=i.getUniformLocation(e.program,"uSampler2");break;case 5:e.vertexPositionAttribute=n.enableVertexAttribArray(i,e.program,"aPosition"),e.textureCoordAttribute=n.enableVertexAttribArray(i,e.program,"aTexcoord"),e.vertexCenterAttribute=n.enableVertexAttribArray(i,e.program,"aCenter"),e.vertexDelayAttribute=n.enableVertexAttribArray(i,e.program,"aDelay"),e.matrixUniform=i.getUniformLocation(e.program,"uModelViewProj"),e.factorUniform=i.getUniformLocation(e.program,"uFactor"),e.zMovementUniform=i.getUniformLocation(e.program,"uZmovement"),e.directionUniform=i.getUniformLocation(e.program,"uDirection"),e.angleUniform=i.getUniformLocation(e.program,"uAngle"),e.xAxisUniform=i.getUniformLocation(e.program,"uXAxis"),e.backUniform=i.getUniformLocation(e.program,"uBack");break;case 9:e.vertexPositionAttribute=n.enableVertexAttribArray(i,e.program,"aPosition"),e.textureCoordAttribute=n.enableVertexAttribArray(i,e.program,"aTexcoord"),e.matrixUniform=i.getUniformLocation(e.program,"uModelViewProj"),e.offsetMatrix=i.getUniformLocation(e.program,"offsetMatrix"),e.dirMatrix=i.getUniformLocation(e.program,"dirMatrix"),e.opacityUniform=i.getUniformLocation(e.program,"opacity"),e.isInvX=i.getUniformLocation(e.program,"isInvX"),e.sampler1Uniform=i.getUniformLocation(e.program,"uSampler1"),e.sampler2Uniform=i.getUniformLocation(e.program,"uSampler2");break;case 7:e.vertexPositionAttribute=n.enableVertexAttribArray(i,e.program,"aPosition"),e.textureCoordAttribute=n.enableVertexAttribArray(i,e.program,"aTexcoord"),e.vertexCenterAttribute=n.enableVertexAttribArray(i,e.program,"aCenter"),e.matrixUniform=i.getUniformLocation(e.program,"uModelViewProj"),e.offsetMatrix=i.getUniformLocation(e.program,"offsetMatrix"),e.progressUniform=i.getUniformLocation(e.program,"uProgress"),e.opacityUniform=i.getUniformLocation(e.program,"opacity"),e.styleUniform=i.getUniformLocation(e.program,"style"),e.isX=i.getUniformLocation(e.program,"isX"),e.sampler1Uniform=i.getUniformLocation(e.program,"uSampler1"),e.sampler2Uniform=i.getUniformLocation(e.program,"uSampler2");break;case 8:e.vertexPositionAttribute=n.enableVertexAttribArray(i,e.program,"aPosition"),e.textureCoordAttribute=n.enableVertexAttribArray(i,e.program,"aTexcoord"),e.vertexCenterAttribute=n.enableVertexAttribArray(i,e.program,"aCenter"),e.vertexDelayAttribute=n.enableVertexAttribArray(i,e.program,"aDelay"),e.matrixUniform=i.getUniformLocation(e.program,"uModelViewProj"),e.timeUniform=i.getUniformLocation(e.program,"uTime"),e.spinFactorUniform=i.getUniformLocation(e.program,"uSpinFactor"),e.factorUniform=i.getUniformLocation(e.program,"uFactor"),e.reverseAngleUniform=i.getUniformLocation(e.program,"uReverseAngle"),e.growFactorUniform=i.getUniformLocation(e.program,"uGrowFactor"),e.opacitySpeedUniform=i.getUniformLocation(e.program,"uOpacitySpeed"),e.sampler1Uniform=i.getUniformLocation(e.program,"uSampler");break;default:a.logError("unknown shader id "+t)}}(i,t,e),e.useProgram(i.program)}catch(e){a.logError("Exception occured at activateShader in ShaderProgram "+t+" : "+e)}return i}},function(e,t,i){"use strict";i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return h}));var r=i(4),n=i(2),a=i(3),s=i(109);function o(e){if(!e)return e;let t=e;return t.startsWith("urn%3aspo%3")?t="":t.toLowerCase().startsWith("8:orgid:")&&(t=t.substring(8,t.length)),t}class l{static async init(e,t,i){const o=Date.now().valueOf();r.a.sendTraceTag(571221393,n.a.msoulscat_Wac_PptSession,a.a.Info,"HealthAdapter::init starting"),this.s_health||(this.s_health=await l.createSmallHealth(e,t),i&&l.addOrUpdatePartCDimensions(i),this.s_pillarAdditionsDuringInit.forEach(e=>{this.s_health.addQosPillar(e)}),this.s_additionalDimensionsAddedDuringInit.size>0&&l.addOrUpdatePartCDimensions(this.s_additionalDimensionsAddedDuringInit)),this.s_vetoListener||(this.s_vetoListener=(e,t)=>{l.onVetoRecorded(e,t)},s.a.registerVetoRecordedListener(this.s_vetoListener),s.a.getSessionVetos().forEach((e,t)=>{this.onVetoRecorded(t,e)}));const d=Date.now().valueOf()-o;r.a.sendTraceTag(571221394,n.a.msoulscat_Wac_PptSession,a.a.Info,"HealthAdapter::init ending. ElapsedMs: "+d)}static addToQosPillar(e){this.s_health?this.s_health.addQosPillar(e):this.s_pillarAdditionsDuringInit.push(e)}static addOrUpdatePartCDimensions(e){this.s_health?e.forEach((e,t)=>{r.a.sendTraceTag(526161419,n.a.msoulscat_Wac_PptSession,a.a.Info,`HealthAdapter::addOrUpdatePartCDimensions ${t}, ${e}`),this.s_health.addOrUpdatePartCDimension(t,e)}):e.forEach((e,t)=>{r.a.sendTraceTag(526161420,n.a.msoulscat_Wac_PptSession,a.a.Info,`HealthAdapter::addOrUpdatePartCDimensions deferring update until init ${t}, ${e}`),this.s_additionalDimensionsAddedDuringInit.set(t,e)})}static async createSmallHealth(e,t){if(!e.remoteTelemetryUrl)throw new Error("settings.remoteTelemetryUrl is not set");const r=await i.e(14).then(i.bind(null,465)),n={dimensions:t,isHealthEnabled:void 0===e.isHealthEnabled||e.isHealthEnabled,remoteTelemetryUrl:e.remoteTelemetryUrl,heartbeatIntervalMs:void 0!==e.heartbeatIntervalMs?e.heartbeatIntervalMs:this.s_defaultHearbeatIntervalMs,recordPillarToWarmPipelineIntervalMs:void 0!==e.recordQosPillarToWarmPipelineIntervalMs?e.recordQosPillarToWarmPipelineIntervalMs:this.s_defaultRecordQosPillarToWarmPipelineIntervalMs},a=r.HealthFactoryGlobal.getHealthInstance(n);if(!a)throw new Error("Unable to create health object");return a}static onVetoRecorded(e,t){if(this.s_health)try{let i=void 0!==t.errorName?t.errorName.trim():e.trim(),r=void 0!==t.qosVeto?t.qosVeto.trim():e.trim(),n=void 0!==t.isIntentional&&t.isIntentional,a=void 0===t.isInternal||t.isInternal,s=void 0===t.alertOnPillar||t.alertOnPillar,o=void 0!==t.isSessionEndingError&&t.isSessionEndingError,l={};for(const e in t)t.hasOwnProperty(e)&&"errorName"!==e&&"isIntentional"!==e&&"isInternal"!==e&&"alertOnPillar"!==e&&"isSessionEndingError"!==e&&"qosVeto"!==e&&(l[e]=t[e]);this.s_health&&this.s_health.recordQosError(i,[r],n,a,s,o,l)}catch(t){r.a.sendTraceTag(571221395,n.a.msoulscat_Wac_PptSession,a.a.Error,`HealthAdapter hit an exception recording veto: ${e}, ${t.message}`)}}static clear(){r.a.sendTraceTag(571221396,n.a.msoulscat_Wac_PptSession,a.a.Info,"HealthAdapter::clear called"),this.s_vetoListener&&(s.a.unregisterVetoRecordedListener(this.s_vetoListener),this.s_vetoListener=void 0),this.s_pillarAdditionsDuringInit.length>0&&(this.s_pillarAdditionsDuringInit=[]),this.s_additionalDimensionsAddedDuringInit.size>0&&(this.s_additionalDimensionsAddedDuringInit=new Map),this.s_health&&(this.s_health=void 0)}}l.s_health=void 0,l.s_pillarAdditionsDuringInit=[],l.s_additionalDimensionsAddedDuringInit=new Map,l.s_defaultHearbeatIntervalMs=3e5,l.s_defaultRecordQosPillarToWarmPipelineIntervalMs=864e5;var d=i(110);class h{static async init(e,t){if(r.a.sendTraceTag(571012805,n.a.msoulscat_Wac_PptSession,a.a.Info,"OTelJsWrapper::init starting"),!this.s_Telemetry){this.s_Telemetry=await i.e(13).then(i.bind(null,464));const s={alwaysOnMetadata:{name:t.application,platform:"Web",version:t.clientVersion,osVersion:t.osVersion,sessionId:t.session_id,serverDocId:t.serverDocId,audienceGroup:this.getAudienceGroupFromRing(t.ring),browserName:t.browser,browserVersion:t.browserVersion,host:t.host,applicationMode:t.applicationMode,applicationModeExtended:t.applicationModeExtended,ring:t.ring,loggableUserId:t.loggableUserId,loggableUserIdSpace:t.loggableUserIdSpace,uiHost:this.getOtelLoggableUiHost(t.uiHost),appLanguage:t.applicationLcid,datacenter:t.datacenter,omsTenantId:t.tenantId},ulsLogger:e.logger,sendToAria:!0,ariaEndpointTarget:e.ariaEndpointTarget};this.s_Telemetry.setEnabledState(!0),this.s_Telemetry.initializeEventProcessor(s),this.s_Telemetry.registerEventHandler(this.s_Telemetry.processEvent),window.addEventListener("unload",()=>{r.a.sendTraceTag(571012806,n.a.msoulscat_Wac_PptSession,a.a.Info,"Shutting down otel Telemetry"),this.s_Telemetry&&this.s_Telemetry.shutdown()})}this.s_actionListener||(this.s_actionListener=e=>{h.sendUserActionEvent(e)},d.a.registerUserActionListener(this.s_actionListener),d.a.getUserActions().forEach(e=>{h.sendUserActionEvent(e)})),r.a.sendTraceTag(571012807,n.a.msoulscat_Wac_PptSession,a.a.Info,"OTelJsWrapper::init completed")}static async sendOtelEvent(e){if(!this.s_Telemetry)throw new Error("OtelJsWrapper not initialized");try{this.s_Telemetry.sendTelemetryEvent(e)}catch(e){r.a.sendTraceTag(571012808,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,"Failed to sendTelemetryEvent. Ex: "+e)}}static sendUserActionEvent(e){if(!this.s_Telemetry)return;let t={name:"Office.PowerPoint.Online.UserAction."+e.actionName,dataFields:[{name:"UserAction.Name",string:e.actionName}]};e.durationMs&&t.dataFields.push({name:"Activity.DurationMs",int64:e.durationMs}),e.succeeded&&t.dataFields.push({name:"Activity.Succeeded",bool:e.succeeded}),this.sendOtelEvent(t)}static getOtelLoggableUiHost(e){switch(e){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":return"teams";default:return e}}static getAudienceGroupFromRing(e){if(!e)return"Automation";switch(e){case"1":return"Dogfood";case"2":return"Microsoft";case"3":case"5":case"6":return"Production";default:return"Automation"}}static reset(){this.s_Telemetry=void 0,this.s_actionListener&&(d.a.unregisterUserActionListener(this.s_actionListener),this.s_actionListener=void 0)}}h.s_Telemetry=void 0,h.s_actionListener=void 0},function(e,t,i){"use strict";var r,n,a;i.d(t,"g",(function(){return v})),i.d(t,"c",(function(){return y})),i.d(t,"e",(function(){return r})),i.d(t,"d",(function(){return s})),i.d(t,"f",(function(){return a})),i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return l})),function(e){e.getPresInfoAsync="getPresInfoAsync",e.getItemsPresInfoAndSlideInfoAsync="getItemsPresInfoAndSlideInfoAsync",e.getItemsSlideInfosAsync="getItemsSlideInfosAsync",e.getSlideInfosAsync="getSlideInfosAsync"}(r||(r={})),function(e){e.GetItemsCall="GetItemsCall",e.DownloadResponseStream="DownloadResponseStream",e.ParseMultipartResponse="ParseMultipartResponse"}(n||(n={}));class s{}s.unknown="unknown",s.ErrorCode="ErrorCode",s.ErrorCategory="ErrorCategory",s.errorCategory="errorCategory",s.errorCode="errorCode",s.IsIntentional="IsIntentional",s.isIntentional="isIntentional",s.XCorrelationId="X-CorrelationId",s.ContentType="Content-Type",s.ContentLength="Content-Length",s.ContenEncoding="Content-Encoding",s.TransferEncoding="Transfer-Encoding",s.XusedOutputCache="X-usedOutputCache",s.Xnewsnapurl="x-newsnapurl",s.ContentDisposition="Content-Disposition",s.CallerCorrelationId="CallerCorrelationId",s.action="action",s.parser="parser",s.server="server",s.callId="callId",s.dateHeader="x-ms-date",s.clientTimeoutHeader="x-ms-client-timeout",s.clientRequestIdHeader="x-ms-client-request-id",s.newSnapUrlHeader="x-newsnapurl",s.correlationId="correlationId",s.firstResponseCheck="firstResponseCheck",s.fetchBoundary="fetchBoundary",s.downloadResponse="downloadResponse",s.parserCallback="parserCallback",s.createResponse="createResponse",s.contentLength="contentLength",s.usedOutputCache="usedOutputCache",s.itemUsedOutputCacheMap="itemUsedOutputCacheMap",s.podsProxyCallSuceeded="podsProxyCallSuceeded",s.PriorityHint="PriorityHint",s.RequestInfo="RequestInfo",s.ResponseHeaders="ResponseHeaders",s.IsBootRequest="IsBootRequest",function(e){e[e.None=0]="None",e[e.All=1]="All",e[e.Partial=2]="Partial",e[e.Embed=3]="Embed"}(a||(a={}));class o{}o.PresInfoMetaData="presinfo/metadata",o.PresinfoslimSlideOrder="presinfo/slimSlideOrder",o.slideInfoIndex="pres/sldIdx",o.slideInfoSid="pres/sldSid",o.slideNotesIndex="pres/NotesSldIdx",o.slideNotesSid="pres/NotesSldSid",o.slideCommentsIndex="pres/CommentsSldIdx",o.slideCommentsSid="pres/CommentsSldSid",o.slideMetadataIndex="pres/SlideMetadatasldIdx",o.slideMetadataSid="pres/SlideMetadataSldSid",o.slideAccessibilityModelIndex="pres/SlideAccessibilityModelSldIdx",o.slideAccessibilityModelSid="pres/SlideAccessibilityModelSldSid";class l{}l.JsonType="application/json",l.ImagePng="image/png",l.ImageJpg="image/jpg",l.PlainTextType="text/plain";var d=i(172),h=i(6),c=i(88),u=i(81),f=i(82),m=i(31);class p{constructor(e,t,i,r){this.parsedResponse={slideOrder:[],slideAllInfo:[]},this.m_settings=e,this.m_responses=t,this.m_perfDictionary=i,this.m_parsedBasedResponse=r}parsePart(e){if(e&&e.Headers){this.m_perfDictionary[s.parserCallback]?(this.m_perfDictionary[s.parserCallback].callCounter=this.m_perfDictionary[s.parserCallback].callCounter+1,this.m_perfDictionary[s.parserCallback].lastCallStart=y.performanceNowTrimmed()):this.m_perfDictionary[s.parserCallback]={lastCallStart:y.performanceNowTrimmed(),lastCallEnd:y.performanceNowTrimmed(),callCounter:0,slidesHaveImages:[],slidesHaveImageResources:[]};const t=e.Headers.get(s.ContentDisposition),i=e.Headers.get(s.ContentType);this.m_parsedBasedResponse.usedOutputCache=e.Headers.get(s.XusedOutputCache),this.m_parsedBasedResponse.newSnapUrl=e.Headers.get(s.Xnewsnapurl);let r=e.Headers.get(s.ErrorCode)||"ErrorRESERVEDSuccess",n=e.Headers.get(s.ErrorCategory)||"ErrorRESERVEDSuccess",a=e.Headers.get(s.XusedOutputCache);if(t){let o;const l=t.indexOf("pres%2fSlideMetadatasldIdx")>0;try{o=decodeURIComponent(t.substring(t.indexOf("name=")+5).trim())}catch(e){c.a.sendTraceTag(595641600,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy::parseMultipartResponse - partResponse Error:"+e)}if(o){if(this.m_parsedBasedResponse.itemErrorCodeMap||(this.m_parsedBasedResponse.itemErrorCodeMap=new Map),this.m_parsedBasedResponse.itemErrorCategoryMap||(this.m_parsedBasedResponse.itemErrorCategoryMap=new Map),this.m_parsedBasedResponse.itemUsedOutputCacheMap||(this.m_parsedBasedResponse.itemUsedOutputCacheMap=new Map),this.m_parsedBasedResponse.itemErrorCodeMap.set(o,r),this.m_parsedBasedResponse.itemErrorCategoryMap.set(o,n),a&&this.m_parsedBasedResponse.itemUsedOutputCacheMap.set(o,a),r&&r.trim().toLowerCase()==="ErrorRESERVEDSuccess".toLowerCase())if(t.indexOf("presinfo%2fslimSlideOrder")>0){const t=JSON.parse(new TextDecoder("utf-8").decode(e.Body));for(const e of t)this.parsedResponse.slideOrder.push({sid:e,cid:0})}else if(t.indexOf("presinfo%2fmetadata")>0){const t=JSON.parse(new TextDecoder("utf-8").decode(e.Body));let i=[],r=[];for(const e of t.SidSlideOrder)i.push({sid:e,cid:0});if(t.SidHiddenSlides)for(const e of t.SidHiddenSlides)r.push({sid:e,cid:0});let n={Item:null};t.SlideShowProperties.Item||(n={Item:null}),t.SlideShowProperties.Item.s?n={Item:{sid:t.SlideShowProperties.Item.s}}:t.SlideShowProperties.Item.st&&(n={Item:{start:t.SlideShowProperties.Item.st,end:t.SlideShowProperties.Item.end}});const a={SlideOrder:i,HiddenSlideOrder:r,SlideEmuWidth:t.SlideEmuWidth,SlideEmuHeight:t.SlideEmuHeight,ViewScalingFactor:t.ViewScalingFactor,SlideShowProperties:n,Sections:t.Sections};this.parsedResponse.slideAllInfo.push(a)}else if((t.indexOf("pres%2fsldSid")>0||t.indexOf("pres%2fsldIdx")>0)&&i&&p.getSupportedImageType(i)){const r=p.getSlideKeyFromHeader(t,t.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx");let n="";for(let t=0;t<e.Body.length;t+=1)n+=String.fromCharCode(e.Body[t]);const a=`data:${p.getSupportedImageType(i)};base64, ${btoa(n)}`;this.m_perfDictionary[s.parserCallback].slidesHaveImages.push(r),this.m_responses[r]||(this.m_responses[r]={ID:{sid:r,cid:0}}),this.m_responses[r].SlideImageData=a}else if((t.indexOf("pres%2fsldSid")>0||t.indexOf("pres%2fsldIdx")>0)&&i&&-1!==i.indexOf("application/json")){const i=p.getSlideKeyFromHeader(t,t.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx");let r=JSON.parse(new TextDecoder("utf-8").decode(e.Body));h.ChangeGate.isChangeGateEnabled("PodsProxy.getItemsMediaResourceMapping")&&r.mediaUrls?(this.m_responses[i]||(this.m_responses[i]={ID:{sid:r.slideShowInfo.sld[0].id,cid:0}}),this.m_responses[i].SlideShowInfo=r.slideShowInfo,this.m_responses[i].MediaUrls=r.mediaUrls):(this.m_responses[i]||(this.m_responses[i]={ID:{sid:r.sld[0].id,cid:0}}),this.m_responses[i].SlideShowInfo=r)}else if(t.indexOf("pres%2fNotesSldSid")>0||t.indexOf("pres%2fNotesSldIdx")>0){const i=p.getSlideKeyFromHeader(t,t.indexOf("pres%2fNotesSldSid")>0?"NotesSldSid":"NotesSldIdx"),r=new TextDecoder("utf-8").decode(e.Body);this.m_responses[i]||(this.m_responses[i]={ID:{sid:i,cid:0}}),this.m_responses[i].NoteHtml=r}else if(t.indexOf("pres%2fCommentsSldSid")>0||t.indexOf("pres%2fCommentsSldIdx")>0){const i=p.getSlideKeyFromHeader(t,t.indexOf("pres%2fCommentsSldSid")>0?"CommentsSldSid":"CommentsSldIdx"),r=JSON.parse(new TextDecoder("utf-8").decode(e.Body));this.m_responses[i]||(this.m_responses[i]={ID:{sid:i,cid:0}}),this.m_responses[i].Comments=r}else if(t.indexOf("pres%2fSlideMetadataSldSid")>0||l){const i=p.getSlideKeyFromHeader(t,t.indexOf("pres%2fSlideMetadataSldSid")>0?"SlideMetadataSldSid":"SlideMetadatasldIdx"),r=JSON.parse(new TextDecoder("utf-8").decode(e.Body));this.m_responses[i]||(this.m_responses[i]={ID:r.ID}),this.m_responses[i].Title=r.Title,this.m_responses[i].HasAnimation=r.HasAnimation,this.m_responses[i].Hidden=r.Hidden,this.m_responses[i].HasTransition=r.HasTransition}else if(t.indexOf("pres%2fSlideAccessibilityModelSldSid")>0||t.indexOf("pres%2fSlideAccessibilityModelSldIdx")>0){const i=p.getSlideKeyFromHeader(t,t.indexOf("pres%2fSlideAccessibilityModelSldSid")>0?"SlideAccessibilityModelSldSid":"SlideAccessibilityModelSldIdx"),r=JSON.parse(new TextDecoder("utf-8").decode(e.Body));this.m_responses[i]||(this.m_responses[i]={ID:r.ID}),this.m_responses[i].AccessibilityModel=r.AccessibilityModel}else if(t.indexOf("Res%2fSldSid")>0&&i&&p.getSupportedImageType(i)){let r,n;if(r=p.extractStringInBetweenStrings(t,"Res%2fSldSid","%2f"),n=p.extractStringInBetweenStrings(t,"filename=","\r"),r&&n){let t={sid:+r,cid:0};const a=p.getSupportedImageType(i);let o,l;if(e.Body)if(this.m_settings.allowImagesAsBinary)o={Id:n,Base64:"",Binary:e.Body,MimeType:a,ByteCount:e.Body.length};else{let t="";for(let i=0;i<e.Body.length;i+=1)t+=String.fromCharCode(e.Body[i]);const i=`data:${a};base64,${btoa(t)}`;o={Id:n,Base64:i,MimeType:a,ByteCount:i.length}}else c.a.sendTraceTag(529331297,u.a.msoulscat_Wac_PptSession,f.a.Error,`PodsProxy::parseMultipartResponse - Body is undefined. slideId:${r}, resourceId:${n}`),o={Id:n,Base64:"",MimeType:a,ByteCount:0};this.m_perfDictionary[s.parserCallback].slidesHaveImageResources.push(t.sid);for(const[,e]of Object.entries(this.m_responses))e.ID&&e.ID.sid===t.sid&&(l=e);l?l.ResourceData?l.ResourceData.push(o):l.ResourceData=[o]:this.m_responses[t.sid]={ID:t,ResourceData:[o]}}else c.a.sendTraceTag(595628568,u.a.msoulscat_Wac_PptSession,f.a.Error,`PodsProxy::parseMultipartResponse - Cannot get slideId or resourceId from header. slideId:${r}, resourceId:${n}`),this.m_parsedBasedResponse.responseErrorCode="ErrorResponseNotValid"}}else this.m_parsedBasedResponse.responseErrorCode="ErrorItemNameNotValid"}else e.Headers.get("x-ms-content-id")&&(this.m_parsedBasedResponse.itemErrorCodeMap||(this.m_parsedBasedResponse.itemErrorCodeMap=new Map),this.m_parsedBasedResponse.itemErrorCategoryMap||(this.m_parsedBasedResponse.itemErrorCategoryMap=new Map),this.m_parsedBasedResponse.itemErrorCodeMap.set(e.Headers.get("x-ms-content-id"),r),this.m_parsedBasedResponse.itemErrorCategoryMap.set(e.Headers.get("x-ms-content-id"),n)),this.m_parsedBasedResponse.responseErrorCode="ErrorContentDispositionHeaderNotValid";this.m_perfDictionary[s.parserCallback].lastCallEnd=y.performanceNowTrimmed()}else this.m_parsedBasedResponse.responseErrorCode="ErrorResponseNotValid";e.Err&&(this.m_parsedBasedResponse.responseErrorCode="ErrorResponseNotValid",c.a.sendTraceTag(595687003,u.a.msoulscat_Wac_PptSession,f.a.Info,"PodsProxy::parseMultipartResponse - partResponse Error:"+e.Err))}static getSupportedImageType(e){return y.s_supportedImageType.find(t=>-1!==e.indexOf(t))||""}static getSlideKeyFromHeader(e,t){let i=new RegExp(`.*${t}(.*)`);if(!e)return c.a.sendTraceTag(529331298,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy::getSlideLocationFromHeader - header is null."),-1;let r=i.exec(e);return null!=r&&r.length>=2?+r[1]:(c.a.sendTraceTag(529331299,u.a.msoulscat_Wac_PptSession,f.a.Error,`PodsProxy::getSlideLocationFromHeader - regex result is null header:${e}, itemId: ${t}`),-1)}static extractStringInBetweenStrings(e,t,i){let r=e.indexOf(t)+t.length,n=i?e.indexOf(i,r):-1;return-1===n?e.substring(r):e.substring(r,n)}}var g=i(1);let _={};function v(e){e.logger&&c.a.setLogger(e.logger),e.settings&&g.Settings.load(e.settings?e.settings.podsproxy:{}),e.disabledChangeGates&&h.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.svm=_)}class y{constructor(e,t,i,r,n,a,s){if(this.events=new m.EventEmitter,this.m_requestHeaders=new Headers,this.m_itemsList=new Array,this.m_multipartParser=new d.a,c.a.setLogger(r),c.a.sendTraceTag(595686994,u.a.msoulscat_Wac_PptSession,e&&t&&t.DownloadUrl&&i&&t.DocID?f.a.Info:f.a.Warning,`PodsProxy::constructor - podsUrl:${e}, fileExtension:${i}, docId:${t.DocID}}`),c.a.sendTraceTag(508638473,u.a.msoulscat_Wac_PptSession,f.a.Info,`PodsProxy::constructor - presentUrl:${n}}`),this.m_podsUrl=e,this.m_presentUrl=n,this.m_settings=s||{timeout:3e4,throwHttpErrors:!0},h.ChangeGate.initSettings({disabledChangeGates:this.m_settings.disabledChangeGates||""}),a&&a.forEach((e,t)=>{this.m_requestHeaders.append(t,e)}),this.m_getPresInfoRequest={Source:t,FileExtension:i||"pptx"},this.m_getItemsRequest={Source:t,FileExtension:i||"pptx",Items:this.m_itemsList},this.m_imageInputProperties={ClientColorSettings:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientWidth:void 0,ClientHeight:void 0,MinClientWidth:void 0,MinClientHeight:void 0,MaxClientWidth:void 0,MaxClientHeight:void 0,TranslateLanguage:void 0},this.m_imageOptions={InputProperties:this.m_imageInputProperties},this.m_slideInfoInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0,LocaleName:void 0},this.m_slideInfoOptions={InputProperties:this.m_slideInfoInputProperties},this.m_slideResourceInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0,LocaleName:void 0},this.m_slideResourceOptions={InputProperties:this.m_slideResourceInputProperties,Filters:{EnableClustering:!1}},this.m_slideAccessibilityInputProperties={TranslateLanguage:void 0,LocaleName:void 0},this.m_slideAccessibilityOptions={InputProperties:this.m_slideAccessibilityInputProperties},this.m_presInfoFilters={RenderSlideShowProperties:!0,FilterHiddenSlideInfo:!1,IncludeSections:!1},this.m_presInfoInputProperties={IsHighContrast:!1,ClientColorSettings:""},this.m_presInfoOptions={Filters:this.m_presInfoFilters,InputProperties:this.m_presInfoInputProperties},this.m_errorMap=new Map,this.setErrorMap(),s&&s.perfTimingMonitorEnabled)try{new PerformanceObserver(e=>y.logPerformanceEntries(e)).observe({entryTypes:["resource"]})}catch(e){c.a.sendTraceTag(572379985,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy:PerformanceObserver failed with exception "+e)}}async getSlideOrderAsync(){const e=await this.getPresInfoAsync("getSlideOrderAsync");return{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",responseIsIntentional:!1,slideId:(await e.json()).SlideOrder}}async getSlideInfosAsync(e){e.RenderOptions&&(this.m_getPresInfoRequest.SlideRanges=[{IDs:e.SlideLocations.map(e=>e.slideId),RenderOptions:e.RenderOptions}]),this.m_getPresInfoRequest.ClientWidth=e.ClientWidth?e.ClientWidth:this.m_getPresInfoRequest.ClientWidth,this.m_getPresInfoRequest.ClientHeight=e.ClientHeight?e.ClientHeight:this.m_getPresInfoRequest.ClientHeight,this.m_getPresInfoRequest.DevicePixelRatio=e.DevicePixelRatio?e.DevicePixelRatio:this.m_getPresInfoRequest.DevicePixelRatio,this.m_getPresInfoRequest.IsHighContrast=e.IsHighContrast?e.IsHighContrast:this.m_getPresInfoRequest.IsHighContrast,this.m_getPresInfoRequest.ClientColorSettings=e.ClientColorSettings?e.ClientColorSettings:this.m_getPresInfoRequest.ClientColorSettings,this.m_getPresInfoRequest.MinClientWidth=e.MinClientWidth?e.MinClientWidth:this.m_getPresInfoRequest.MinClientWidth,this.m_getPresInfoRequest.MinClientHeight=e.MinClientHeight?e.MinClientHeight:this.m_getPresInfoRequest.MinClientHeight,this.m_getPresInfoRequest.MaxClientWidth=e.MaxClientWidth?e.MaxClientWidth:this.m_getPresInfoRequest.MaxClientWidth,this.m_getPresInfoRequest.MaxClientHeight=e.MaxClientHeight?e.MaxClientHeight:this.m_getPresInfoRequest.MaxClientHeight;const t=await this.getPresInfoAsync("getSlideInfosAsync");return{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",responseIsIntentional:!1,slideInfo:(await t.json()).Slides}}async getItemsSlideOrderAsync(){this.m_itemsList=new Array,this.m_itemsList.push({Id:o.PresinfoslimSlideOrder,AcceptTypes:[l.JsonType]}),this.m_getItemsRequest.Items=this.m_itemsList;const e=await this.getItemsAsync("getItemsSlideOrderAsync");return await this.createSlideIdResponse(this.parseMultipartResponseAsync(e,{}))}async getItemsPresInfoAsync(e){this.m_presInfoOptions.InputProperties.ClientHeight=e.ClientHeight?e.ClientHeight:this.m_presInfoInputProperties.ClientHeight,this.m_presInfoOptions.InputProperties.ClientWidth=e.ClientWidth?e.ClientWidth:this.m_presInfoInputProperties.ClientWidth,this.m_presInfoOptions.InputProperties.IsHighContrast=e.IsHighContrast?e.IsHighContrast:this.m_presInfoInputProperties.IsHighContrast,this.m_presInfoOptions.InputProperties.ClientColorSettings=e.ClientColorSettings?e.ClientColorSettings:this.m_presInfoInputProperties.ClientColorSettings,this.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==e.FilterHiddenSlideInfo?e.FilterHiddenSlideInfo:this.m_presInfoFilters.FilterHiddenSlideInfo,this.m_presInfoOptions.Filters.IncludeSections=void 0!==e.IncludeSections?e.IncludeSections:this.m_presInfoFilters.IncludeSections,this.m_itemsList=new Array,this.m_itemsList.push({Id:o.PresInfoMetaData,AcceptTypes:[l.JsonType],Options:JSON.stringify(this.m_presInfoOptions)}),this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(s.CallerCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(s.XCorrelationId,e.CorrelationId||"");let t={...e.RequestInfo,...this.m_settings.sessionInfo,CorrelationId:e.CorrelationId};this.m_requestHeaders.set(s.RequestInfo,JSON.stringify(t));const i=this.objectDictionaryToRequestIdString(t);this.m_requestHeaders.set(s.clientRequestIdHeader,i),this.m_requestHeaders.set(s.PriorityHint,e.PriorityHint?e.PriorityHint.toString():""),this.m_requestHeaders.set(s.IsBootRequest,e.IsBootRequest?e.IsBootRequest.toString():"");const r={action:"getItemsPresInfoAsync",correlationId:e.CorrelationId,server:{start:y.performanceNowTrimmed(),end:y.performanceNowTrimmed()}};y.logPerf(r);const n=await this.getItemsAsync("getItemsPresInfoAsync");r[s.server].end=y.performanceNowTrimmed(),n&&n.response&&n.response.headers&&(r[s.contentLength]=n.response.headers.get(s.ContentLength)),y.logPerf(r),r[s.parser]={start:y.performanceNowTrimmed(),end:y.performanceNowTrimmed()};const a=this.setTimeoutForParsingResponse(r),d=await this.createPresInfoResponse(this.parseMultipartResponseAsync(n,r));return clearTimeout(a),r[s.parser].end=y.performanceNowTrimmed(),r[s.usedOutputCache]=!!d.usedOutputCache&&"true"===d.usedOutputCache.trim().toLowerCase(),r[s.itemUsedOutputCacheMap]=!!d.itemUsedOutputCacheMap&&Array.from(d.itemUsedOutputCacheMap.entries()),y.logPerf(r),d.metadata=this.generateReportPerfDictionary(r),d}async getItemsPresInfoAndSlideInfosAsync(e,t,i){const a={action:"getItemsPresInfoAndSlideInfoAsync"};let d=null;try{this.m_presInfoOptions.InputProperties.ClientHeight=e.ClientHeight?e.ClientHeight:this.m_presInfoInputProperties.ClientHeight,this.m_presInfoOptions.InputProperties.ClientWidth=e.ClientWidth?e.ClientWidth:this.m_presInfoInputProperties.ClientWidth,this.m_presInfoOptions.InputProperties.IsHighContrast=e.IsHighContrast?e.IsHighContrast:this.m_presInfoInputProperties.IsHighContrast,this.m_presInfoOptions.InputProperties.ClientColorSettings=e.ClientColorSettings?e.ClientColorSettings:this.m_presInfoInputProperties.ClientColorSettings,this.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==e.FilterHiddenSlideInfo?e.FilterHiddenSlideInfo:this.m_presInfoFilters.FilterHiddenSlideInfo,this.m_presInfoOptions.Filters.IncludeSections=void 0!==e.IncludeSections?e.IncludeSections:this.m_presInfoFilters.IncludeSections,this.m_itemsList=new Array,this.m_itemsList.push({Id:o.PresInfoMetaData,AcceptTypes:[l.JsonType],Options:JSON.stringify(this.m_presInfoOptions)}),this.m_imageOptions.InputProperties.ClientWidth=t.ClientWidth?t.ClientWidth:this.m_imageInputProperties.ClientWidth,this.m_imageOptions.InputProperties.ClientHeight=t.ClientHeight?t.ClientHeight:this.m_imageInputProperties.ClientHeight,this.m_imageOptions.InputProperties.IsHighContrast=t.IsHighContrast?t.IsHighContrast:this.m_imageInputProperties.IsHighContrast,this.m_imageOptions.InputProperties.ClientColorSettings=t.ClientColorSettings?t.ClientColorSettings:this.m_imageInputProperties.ClientColorSettings,this.m_imageOptions.InputProperties.MinClientWidth=t.MinClientWidth?t.MinClientWidth:this.m_imageInputProperties.MinClientWidth,this.m_imageOptions.InputProperties.MinClientHeight=t.MinClientHeight?t.MinClientHeight:this.m_imageInputProperties.MinClientHeight,this.m_imageOptions.InputProperties.MaxClientWidth=t.MaxClientWidth?t.MaxClientWidth:this.m_imageInputProperties.MaxClientWidth,this.m_imageOptions.InputProperties.MaxClientHeight=t.MaxClientHeight?t.MaxClientHeight:this.m_imageInputProperties.MaxClientHeight,this.m_imageOptions.InputProperties.TranslateLanguage=null!=t.TranslateLanguage?t.TranslateLanguage:this.m_imageInputProperties.TranslateLanguage;for(let e=0;e<t.SlideLocations.length;e+=1)t.GetSlideImage?this.m_itemsList.push({Id:t.SlideLocations[e].slideId?o.slideInfoSid+t.SlideLocations[e].slideId.sid.toString():o.slideInfoIndex+t.SlideLocations[e].slideIndex.toString(),AcceptTypes:y.s_supportedImageType,Options:JSON.stringify(this.m_imageOptions)}):t.Filters&&(this.m_slideInfoOptions.InputProperties={ClientWidth:t.ClientWidth?t.ClientWidth:this.m_slideInfoInputProperties.ClientWidth,ClientHeight:t.ClientHeight?t.ClientHeight:this.m_slideInfoInputProperties.ClientHeight,IsHighContrast:t.IsHighContrast?t.IsHighContrast:this.m_slideInfoInputProperties.IsHighContrast,ColorMode:t.ColorMode?t.ColorMode:this.m_slideInfoInputProperties.ColorMode,ClientColorSettings:t.ClientColorSettings?t.ClientColorSettings:this.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=t.TranslateLanguage?t.TranslateLanguage:this.m_slideInfoInputProperties.TranslateLanguage,LocaleName:t.LocaleName?t.LocaleName:this.m_slideInfoInputProperties.LocaleName},this.m_slideInfoOptions.Filters=y.ensureISlideInfoFilters(t.Filters),this.m_itemsList.push({Id:t.SlideLocations[e].slideId?o.slideInfoSid+t.SlideLocations[e].slideId.sid.toString():o.slideInfoIndex+t.SlideLocations[e].slideIndex.toString(),AcceptTypes:[l.JsonType],Options:JSON.stringify(this.m_slideInfoOptions)})),this.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=t.TranslateLanguage?t.TranslateLanguage:this.m_slideAccessibilityInputProperties.TranslateLanguage,LocaleName:t.LocaleName?t.LocaleName:this.m_slideInfoInputProperties.LocaleName},void 0!==t.GetSlideAccessibilityModelData&&t.GetSlideAccessibilityModelData&&this.m_itemsList.push({Id:t.SlideLocations[e].slideId?o.slideAccessibilityModelSid+t.SlideLocations[e].slideId.sid.toString():o.slideAccessibilityModelIndex+t.SlideLocations[e].slideIndex.toString(),AcceptTypes:[l.JsonType],Options:JSON.stringify(this.m_slideAccessibilityOptions)}),t.GetSlideNotes&&this.m_itemsList.push({Id:t.SlideLocations[e].slideId?o.slideNotesSid+t.SlideLocations[e].slideId.sid.toString():o.slideCommentsIndex+t.SlideLocations[e].slideIndex.toString(),AcceptTypes:[l.PlainTextType],Options:JSON.stringify(this.m_slideInfoOptions)}),t.GetSlideComments&&this.m_itemsList.push({Id:t.SlideLocations[e].slideId?o.slideCommentsSid+t.SlideLocations[e].slideId.sid.toString():o.slideCommentsIndex+t.SlideLocations[e].slideIndex.toString(),AcceptTypes:[l.JsonType],Options:t.CommentOptions});this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(s.CallerCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(s.XCorrelationId,e.CorrelationId||"");let h={...e.RequestInfo,...this.m_settings.sessionInfo,CorrelationId:e.CorrelationId};this.m_requestHeaders.set(s.RequestInfo,JSON.stringify(h));const c=this.objectDictionaryToRequestIdString(h);this.m_requestHeaders.set(s.clientRequestIdHeader,c),this.m_requestHeaders.set(s.PriorityHint,e.PriorityHint?e.PriorityHint.toString():""),this.m_requestHeaders.set(s.IsBootRequest,e.IsBootRequest?e.IsBootRequest.toString():""),a.correlationId=e.CorrelationId,a[s.server]={start:y.performanceNowTrimmed(),end:y.performanceNowTrimmed()},y.logPerf(a),this.events.emit("requestStageChanged",{requestType:r.getItemsPresInfoAndSlideInfoAsync,stageInfo:n.GetItemsCall});const u=await this.getItemsAsync("getItemsPresInfoAndSlideInfoAsync",{overrideGetItemsTimeoutMs:i&&i.overrideGetItemsTimeoutMs});if(this.m_settings.shouldUpdateNewFileUrlFromSnap&&"ServerErrorFileDownloadResourceInconsistent"===u.errorCode)return{presInfo:void 0,slideInfo:[],responseErrorCode:"ServerErrorFileDownloadResourceInconsistent",responseErrorCategory:u.errorCategory,responseIsIntentional:u.isIntentional,itemErrorCodeMap:void 0};if(a[s.server].end=y.performanceNowTrimmed(),u&&u.response&&u.response.headers){a[s.contentLength]=u.response.headers.get(s.ContentLength),a[s.ContenEncoding]=u.response.headers.get(s.ContenEncoding),a[s.TransferEncoding]=u.response.headers.get(s.TransferEncoding);let e=u.response.headers.keys();if(e){let t=[];for(let i of e)t.push(i);a[s.ResponseHeaders]=t}}let f;if(y.logPerf(a),a[s.parser]={start:y.performanceNowTrimmed(),end:y.performanceNowTrimmed()},d=this.setTimeoutForParsingResponse(a),f=await this.parseMultipartResponseAsync(u,a,{shouldTimeoutResponseStreamDownload:i&&i.shouldTimeoutResponseStreamDownload,overrideDownloadTimeoutMs:i&&i.overrideDownloadTimeoutMs,requestType:r.getItemsPresInfoAndSlideInfoAsync}),f&&"ErrorDownloadResponseStreamTimeout"===f.responseErrorCode)return{presInfo:void 0,slideInfo:[],responseErrorCode:"ErrorDownloadResponseStreamTimeout",responseErrorCategory:"Transient",responseIsIntentional:!1,itemErrorCodeMap:void 0};const m=this.createPresInfoAndSlideInfoResponse(f,a);return null!==d&&(clearTimeout(d),d=null),a[s.parser].end=y.performanceNowTrimmed(),a[s.usedOutputCache]=!!m.usedOutputCache&&"true"===m.usedOutputCache.trim().toLowerCase(),a[s.itemUsedOutputCacheMap]=!!m.itemUsedOutputCacheMap&&Array.from(m.itemUsedOutputCacheMap.entries()),a[s.podsProxyCallSuceeded]=!0,y.logPerf(a),m.metadata=this.generateReportPerfDictionary(a),m}catch(e){return c.a.sendTraceTag(571548234,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy:getItemsPresInfoAndSlideInfosAsync - exception happened: "+e),a[s.podsProxyCallSuceeded]=!1,y.logPerf(a),null!==d&&(clearTimeout(d),d=null),{presInfo:void 0,slideInfo:[],responseErrorCode:"ErrorRESERVEDItemFailed",responseErrorCategory:"Transient",responseIsIntentional:!1,itemErrorCodeMap:void 0}}}async getItemsSlideInfosAsync(e){const t={action:"getItemsSlideInfosAsync"};try{this.m_imageOptions.InputProperties.ClientWidth=e.ClientWidth?e.ClientWidth:this.m_imageInputProperties.ClientWidth,this.m_imageOptions.InputProperties.ClientHeight=e.ClientHeight?e.ClientHeight:this.m_imageInputProperties.ClientHeight,this.m_imageOptions.InputProperties.IsHighContrast=null!=e.IsHighContrast?e.IsHighContrast:this.m_imageInputProperties.IsHighContrast,this.m_imageOptions.InputProperties.ColorMode=null!=e.ColorMode?e.ColorMode:this.m_imageInputProperties.ColorMode,this.m_imageOptions.InputProperties.ClientColorSettings=null!=e.ClientColorSettings?e.ClientColorSettings:this.m_imageInputProperties.ClientColorSettings,this.m_imageOptions.InputProperties.MinClientWidth=e.MinClientWidth?e.MinClientWidth:this.m_imageInputProperties.MinClientWidth,this.m_imageOptions.InputProperties.MinClientHeight=e.MinClientHeight?e.MinClientHeight:this.m_imageInputProperties.MinClientHeight,this.m_imageOptions.InputProperties.MaxClientWidth=e.MaxClientWidth?e.MaxClientWidth:this.m_imageInputProperties.MaxClientWidth,this.m_imageOptions.InputProperties.MaxClientHeight=e.MaxClientHeight?e.MaxClientHeight:this.m_imageInputProperties.MaxClientHeight,this.m_imageOptions.InputProperties.TranslateLanguage=null!=e.TranslateLanguage?e.TranslateLanguage:this.m_imageInputProperties.TranslateLanguage,this.m_itemsList=new Array;for(let t=0;t<e.SlideLocations.length;t+=1)e.GetSlideImage?this.m_itemsList.push({Id:e.SlideLocations[t].slideId?o.slideInfoSid+e.SlideLocations[t].slideId.sid.toString():o.slideInfoIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:y.s_supportedImageType,Options:JSON.stringify(this.m_imageOptions)}):e.Filters&&(this.m_slideInfoOptions.InputProperties={ClientWidth:e.ClientWidth?e.ClientWidth:this.m_slideInfoInputProperties.ClientWidth,ClientHeight:e.ClientHeight?e.ClientHeight:this.m_slideInfoInputProperties.ClientHeight,IsHighContrast:e.IsHighContrast?e.IsHighContrast:this.m_slideInfoInputProperties.IsHighContrast,ColorMode:e.ColorMode?e.ColorMode:this.m_slideInfoInputProperties.ColorMode,ClientColorSettings:e.ClientColorSettings?e.ClientColorSettings:this.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=e.TranslateLanguage?e.TranslateLanguage:this.m_slideInfoInputProperties.TranslateLanguage,LocaleName:null!=e.LocaleName?e.LocaleName:this.m_slideInfoInputProperties.LocaleName},this.m_slideInfoOptions.Filters=y.ensureISlideInfoFilters(e.Filters),e.SkipGetSlideInfo||this.m_itemsList.push({Id:e.SlideLocations[t].slideId?o.slideInfoSid+e.SlideLocations[t].slideId.sid.toString():o.slideInfoIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[l.JsonType],Options:JSON.stringify(this.m_slideInfoOptions)})),this.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=e.TranslateLanguage?e.TranslateLanguage:this.m_slideAccessibilityInputProperties.TranslateLanguage,LocaleName:e.LocaleName?e.LocaleName:this.m_slideInfoInputProperties.LocaleName},void 0!==e.GetSlideAccessibilityModelData&&e.GetSlideAccessibilityModelData&&this.m_itemsList.push({Id:e.SlideLocations[t].slideId?o.slideAccessibilityModelSid+e.SlideLocations[t].slideId.sid.toString():o.slideAccessibilityModelIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[l.JsonType],Options:JSON.stringify(this.m_slideAccessibilityOptions)}),e.GetSlideNotes&&this.m_itemsList.push({Id:e.SlideLocations[t].slideId?o.slideNotesSid+e.SlideLocations[t].slideId.sid.toString():o.slideCommentsIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[l.PlainTextType],Options:JSON.stringify(this.m_slideInfoOptions)}),e.GetSlideComments&&this.m_itemsList.push({Id:e.SlideLocations[t].slideId?o.slideCommentsSid+e.SlideLocations[t].slideId.sid.toString():o.slideCommentsIndex+e.SlideLocations[t].slideIndex.toString(),AcceptTypes:[l.JsonType],Options:e.CommentOptions});if(0===this.m_itemsList.length)return c.a.sendTraceTag(595076497,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy:getItemsSlideInfosAsync - invalid request item list"),{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:"ErrorRequestFailed",responseErrorCategory:"BadRequest",responseIsIntentional:!1,slideInfo:[]};this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(s.CallerCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(s.XCorrelationId,e.CorrelationId||"");let t={...e.RequestInfo,...this.m_settings.sessionInfo,CorrelationId:e.CorrelationId};this.m_requestHeaders.set(s.RequestInfo,JSON.stringify(t));const i=this.objectDictionaryToRequestIdString(t);this.m_requestHeaders.set(s.clientRequestIdHeader,i),this.m_requestHeaders.set(s.PriorityHint,e.PriorityHint?e.PriorityHint.toString():""),this.m_requestHeaders.set(s.IsBootRequest,e.IsBootRequest?e.IsBootRequest.toString():"");const r={action:"getItemsSlideInfosAsync",correlationId:e.CorrelationId,server:{start:y.performanceNowTrimmed(),end:y.performanceNowTrimmed()}};r.correlationId=e.CorrelationId,r[s.server]={start:y.performanceNowTrimmed(),end:y.performanceNowTrimmed()},y.logPerf(r);const n=await this.getItemsAsync("getItemsSlideInfosAsync");if(this.m_settings.shouldUpdateNewFileUrlFromSnap&&"ServerErrorFileDownloadResourceInconsistent"===n.errorCode)return{slideInfo:[],responseErrorCode:"ServerErrorFileDownloadResourceInconsistent",responseErrorCategory:n.errorCategory,responseIsIntentional:!!n.headers.get(s.IsIntentional)&&n.headers.get(s.IsIntentional),itemErrorCodeMap:void 0};r[s.server].end=y.performanceNowTrimmed(),n&&n.response&&n.response.headers&&(r[s.contentLength]=n.response.headers.get(s.ContentLength)),r[s.parser]={start:y.performanceNowTrimmed(),end:y.performanceNowTrimmed()},y.logPerf(r);const a=this.setTimeoutForParsingResponse(r),d=await this.createSlideInfoResponse(this.parseMultipartResponseAsync(n,r),r);return clearTimeout(a),r[s.parser].end=y.performanceNowTrimmed(),r[s.usedOutputCache]=!!d.usedOutputCache&&"true"===d.usedOutputCache.trim().toLowerCase(),r[s.itemUsedOutputCacheMap]=!!d.itemUsedOutputCacheMap&&Array.from(d.itemUsedOutputCacheMap.entries()),r[s.podsProxyCallSuceeded]=!0,y.logPerf(r),d.metadata=this.generateReportPerfDictionary(r),d}catch(e){return c.a.sendTraceTag(570950493,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy:getItemsSlideInfosAsync - exception happened: "+e),t[s.podsProxyCallSuceeded]=!1,y.logPerf(t),{slideInfo:[],responseErrorCode:"ErrorRESERVEDItemFailed",responseErrorCategory:"Transient",responseIsIntentional:!1,itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0}}}async getItemsResourceAsync(e){this.m_slideResourceOptions.InputProperties={ClientWidth:e.ClientWidth?e.ClientWidth:this.m_slideResourceInputProperties.ClientWidth,ClientHeight:e.ClientHeight?e.ClientHeight:this.m_slideResourceInputProperties.ClientHeight,IsHighContrast:e.IsHighContrast?e.IsHighContrast:this.m_slideResourceInputProperties.IsHighContrast,ColorMode:e.ColorMode?e.ColorMode:this.m_slideResourceInputProperties.ColorMode,ClientColorSettings:e.ClientColorSettings?e.ClientColorSettings:this.m_slideResourceInputProperties.ClientColorSettings,TranslateLanguage:null!=e.TranslateLanguage?e.TranslateLanguage:this.m_slideResourceInputProperties.TranslateLanguage,LocaleName:null!=e.LocaleName?e.LocaleName:this.m_slideResourceInputProperties.LocaleName},this.m_slideResourceOptions.Filters.EnableClustering=void 0!==e.EnableClustering&&e.EnableClustering,this.m_itemsList=new Array;for(let t of e.ResourceParams){this.m_slideResourceOptions.InputProperties.ResourceId=t.Id;let e="";switch(String(t.Name.match("[^.]+$"))){case"jpg":e=l.ImageJpg;break;case"png":e=l.ImagePng}this.m_itemsList.push({Id:t.Name,AcceptTypes:e?[e]:y.s_supportedImageType,Options:JSON.stringify(this.m_slideResourceOptions)})}this.m_getItemsRequest.Items=this.m_itemsList,this.m_requestHeaders.set(s.CallerCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(s.XCorrelationId,e.CorrelationId||""),this.m_requestHeaders.set(s.IsBootRequest,e.IsBootRequest?e.IsBootRequest.toString():"");const t={action:"getItemsResourceAsync",correlationId:e.CorrelationId,server:{start:y.performanceNowTrimmed(),end:y.performanceNowTrimmed()}};y.logPerf(t);const i=await this.getItemsAsync("getItemsResourceAsync");t[s.server].end=y.performanceNowTrimmed(),i&&i.response&&i.response.headers&&(t[s.contentLength]=i.response.headers.get(s.ContentLength)),t[s.parser]={start:y.performanceNowTrimmed(),end:y.performanceNowTrimmed()},y.logPerf(t);const r=this.setTimeoutForParsingResponse(t),n=await this.createSlideInfoResponse(this.parseMultipartResponseAsync(i,t),t);return clearTimeout(r),t[s.parser].end=y.performanceNowTrimmed(),t[s.usedOutputCache]=!!n.usedOutputCache&&"true"===n.usedOutputCache.trim().toLowerCase(),t[s.itemUsedOutputCacheMap]=!!n.itemUsedOutputCacheMap&&Array.from(n.itemUsedOutputCacheMap.entries()),y.logPerf(t),n.metadata=this.generateReportPerfDictionary(t),n}async getItemsSlideOrderAndSlidesInfoIndexAsync(e,t,i){this.m_getItemsRequest.Items.push({Id:o.PresinfoslimSlideOrder,AcceptTypes:[l.JsonType],Options:JSON.stringify(i)});let r=JSON.stringify(t);e&&e.forEach(e=>{this.m_getItemsRequest.Items.push({Id:`${o.slideInfoIndex}${e}`,AcceptTypes:[l.ImagePng,l.ImageJpg],Options:r})});const n={action:"getItemsSlideOrderAndSlidesInfoIndexAsync",server:{start:y.performanceNowTrimmed(),end:y.performanceNowTrimmed()}};y.logPerf(n);const a=await this.getItemsAsync("getItemsSlideOrderAndSlidesInfoIndexAsync");n[s.server].end=y.performanceNowTrimmed(),n[s.parser]={start:y.performanceNowTrimmed(),end:y.performanceNowTrimmed()},a&&a.response&&a.response.headers&&(n[s.contentLength]=a.response.headers.get(s.ContentLength)),y.logPerf(n);const d=this.setTimeoutForParsingResponse(n);let h=await this.createSlideOrderAndSlidesInfoIndexResponse(this.parseMultipartResponseAsync(a,n));return clearTimeout(d),n[s.parser].end=y.performanceNowTrimmed(),n[s.usedOutputCache]=!!h.usedOutputCache&&"true"===h.usedOutputCache.trim().toLowerCase(),n[s.itemUsedOutputCacheMap]=!!h.itemUsedOutputCacheMap&&Array.from(h.itemUsedOutputCacheMap.entries()),y.logPerf(n),h.metadata=this.generateReportPerfDictionary(n),h}async getPresInfoAsync(e){c.a.sendTraceTag(593896001,u.a.msoulscat_Wac_PptSession,f.a.Info,`PodsProxy::getPresInfoAsync - Function:${e}, requestCorrelation:${this.m_requestHeaders.get(s.CallerCorrelationId)}`);const t=new AbortController,i=setTimeout(()=>t.abort(),3e4),r=await fetch(this.m_podsUrl+"/presinfo.ashx",{headers:this.m_requestHeaders,method:"POST",body:JSON.stringify(this.m_getPresInfoRequest),signal:t.signal}).catch(async t=>{throw c.a.sendTraceTag(595686995,u.a.msoulscat_Wac_PptSession,f.a.Error,`PodsProxy:getPresInfo - Function: ${e}, Error: ${t}`),t});return clearTimeout(i),c.a.sendTraceTag(595686996,u.a.msoulscat_Wac_PptSession,r.ok?f.a.Info:f.a.Error,`PodsProxy::getPresInfo - Function: ${e}, Status:${r.status}, StatusText: ${r.statusText}, CorrelationId: ${r.headers.get(s.XCorrelationId)}`),r}static getFieldFromReponseHeader(e,t){return e.headers?e.headers.get(t):s.unknown}async getItemsAsync(e,t){const i=this.m_requestHeaders.get(s.CallerCorrelationId);c.a.sendTraceTag(593896002,u.a.msoulscat_Wac_PptSession,f.a.Info,`PodsProxy::getItemsAsync - Function:${e}, requestCorrelation:${i}`);const r={errorCode:"ErrorRESERVEDSuccess"};let n=r,a="getItemsPresInfoAndSlideInfoAsync"===e&&this.m_settings.shouldUseBootRequestTimeout&&this.m_settings.bootRequestTimeout?this.m_settings.bootRequestTimeout:this.m_settings.timeout;t&&t.overrideGetItemsTimeoutMs&&(a=t.overrideGetItemsTimeoutMs),this.m_requestHeaders.set(s.dateHeader,(new Date).toISOString()),this.m_requestHeaders.set(s.clientTimeoutHeader,a.toString()),this.m_requestHeaders.set(s.callId,this.m_settings.callId||"empty");let o=this.m_podsUrl+"/getitems.ashx";g.Settings.readBooleanOrDefault("enableUsePresentFrontdoor",!1)&&(this.m_presentUrl?o=this.m_presentUrl+"/items":c.a.sendTraceTag(508638343,u.a.msoulscat_Wac_PptSession,f.a.Warning,"PodsProxy::getItemsAsync enableUsePresentFrontdoor is true but presentUrl is null. Using podsUrl. }"));const l=this.m_getItemsRequest.Items.map(e=>e.Id);y.s_events.emit("networkCall",{url:o,itemIds:l});const d=new AbortController,h=setTimeout(()=>d.abort(),a);n=await fetch(o,{headers:this.m_requestHeaders,method:"POST",body:JSON.stringify(this.m_getItemsRequest),signal:d.signal}).catch(async t=>{const n=t.response&&t.response.headers?t.response.headers.get(s.XCorrelationId):s.unknown,a=t.response&&t.response.headers?t.response.headers.get(s.ErrorCode):s.unknown,o=t.response&&t.response.headers?t.response.headers.get(s.ErrorCategory):s.unknown,l=!(!t.response||!t.response.headers)&&t.response.headers.get(s.IsIntentional),d=t.response&&t.response.status?t.response.status:s.unknown;let h=t.toString();h.length>0&&("."===h.slice(-1)||""===h.slice(-1))&&(h=h.slice(0,-1));let m=this.getMappedError(h);return m?r.errorCode=m:"HTTPError"===t.name&&d!==s.unknown&&500!==d&&this.m_errorMap.has(d)?r.errorCode=this.m_errorMap.get(d):"TimeoutError"===t.name?r.errorCode="ErrorRequestTimeout":r.errorCode=y.convertServerError(a,this.m_settings.enableServerSpecificErrorCode),this.m_settings.shouldUpdateNewFileUrlFromSnap&&"ServerErrorFileDownloadResourceInconsistent"===r.errorCode&&(r.newSnapUrl=y.getFieldFromReponseHeader(t.response,s.newSnapUrlHeader)),r.errorCategory=o&&""!==o.trim()&&o!==s.unknown?o:"Transient",r.isIntentional=l!==s.unknown&&l,c.a.sendTraceTag(595687001,u.a.msoulscat_Wac_PptSession,f.a.Error,`PodsProxy:getItems - Function:${e}, Error:${t}, ErrorName:${t.name}, Status:${t.status}, HeaderCorrelationId:${n}, HeaderErrorCode:${a}, HeaderErrorCategory:${o}, result.isIntentional:${r.isIntentional}, result.errorCode:${r.errorCode}, requestCorrelation:${i}, status:${d}`),r}),clearTimeout(h),r.response=n;try{if(this.m_settings.shouldUpdateNewFileUrlFromSnap&&("ServerErrorFileDownloadResourceInconsistent"===r.errorCode||r.newSnapUrl)){if(c.a.sendTraceTag(541403227,u.a.msoulscat_Wac_PptSession,f.a.Info,"PodsProxy:getItems trigger shouldUpdateNewFileUrlFromSnap flow"),r.newSnapUrl)return"ErrorRESERVEDSuccess"===r.errorCode&&c.a.sendTraceTag(509875216,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy:got new snap url without errorcode"),c.a.sendTraceTag(541403228,u.a.msoulscat_Wac_PptSession,f.a.Info,"PodsProxy:getItems get valid new file url"),this.events.emit("downloadUrlChanged",r.newSnapUrl),r;c.a.sendTraceTag(541345432,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy:getItems no valid new file url in ServerErrorFileDownloadResourceInconsistent response")}}catch(e){c.a.sendTraceTag(541403229,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy:getItems exception trying to check ServerErrorFileDownloadResourceInconsistent")}200!==n.status&&"ErrorRESERVEDSuccess"===r.errorCode&&(n.headers&&n.headers.get(s.ErrorCode)?(r[s.errorCode]=y.convertServerError(n.headers.get(s.ErrorCode),this.m_settings.enableServerSpecificErrorCode),r[s.errorCategory]=n.headers.get(s.ErrorCategory)?n.headers.get(s.ErrorCategory):"BadRequest",r[s.IsIntentional]=!!n.headers.get(s.IsIntentional)&&n.headers.get(s.IsIntentional)):(n.status!==s.unknown&&this.m_errorMap.has(n.status)?r[s.errorCode]=this.m_errorMap.get(n.status):r[s.errorCode]="ErrorRequestFailed",r[s.errorCategory]="Transient",r[s.IsIntentional]=!1));const m={functionName:e,status:n.status,statusText:n.statusText,headerCorrelation:n.headers?n.headers.get(s.XCorrelationId):"",headerErrorCode:n.headers?n.headers.get(s.ErrorCode):"",headerErrorCategory:n.headers?n.headers.get(s.ErrorCategory):"",headerErrorIntentional:!!n.headers&&n.headers.get(s.IsIntentional),requestCorrelation:i,resultErrorCode:r.errorCode,resultErrorCategory:r.errorCategory,resultIsIntentional:r.IsIntentional};return c.a.sendTraceTag(595687002,u.a.msoulscat_Wac_PptSession,n.ok?f.a.Info:f.a.Error,JSON.stringify(m)),r}async getSessionUtcAsync(){let e=-1;const t=new AbortController,i=setTimeout(()=>t.abort(),2500),r=await fetch(this.m_podsUrl+"/podhandler.ashx?action=GetSessionUTC&format=jsms",{headers:new Headers,method:"GET",signal:t.signal}).catch(async e=>{c.a.sendTraceTag(587831243,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy:getSessionUtcAsync - Error: "+e)});clearTimeout(i);try{r?(e=parseInt(await r.text(),10),c.a.sendTraceTag(587831244,u.a.msoulscat_Wac_PptSession,f.a.Info,"PodsProxy::getSessionUtcAsync: "+e)):c.a.sendTraceTag(572613792,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy:getSessionUtcAsync - Null response.")}catch(e){c.a.sendTraceTag(587831245,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy::getSessionUtcAsync - error parsing response. "+e)}return e}updateDocSource(e){c.a.sendTraceTag(573855198,u.a.msoulscat_Wac_PptSession,f.a.Info,"PodsProxy - call updateDocSource."),this.m_getPresInfoRequest?this.m_getPresInfoRequest.Source=e:c.a.sendTraceTag(573855199,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy::updateDocSource - no valid m_getPresInfoRequest to update."),this.m_getItemsRequest?this.m_getItemsRequest.Source=e:c.a.sendTraceTag(573855200,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy::updateDocSource - no valid m_getItemsRequest to update.")}async generateSnapDownloadUrlAsync(e,t){try{c.a.sendTraceTag(573875969,u.a.msoulscat_Wac_PptSession,f.a.Info,`PodsProxy::generateSnapDownloadUrlAsync - snapDownloadUrlRequest.ID: ${e.ID}.`);const i=new Headers;i.append(s.ContentType,"application/json; charset=utf-8"),i.append(s.CallerCorrelationId,e.ID),t&&t.forEach((e,t)=>{i.append(t,e)});const r=this.m_podsUrl+"/SnapUrlHandler.ashx",n=new AbortController,a=setTimeout(()=>n.abort(),this.m_settings.timeout),o=await fetch(r,{headers:i,method:"POST",body:JSON.stringify(e),signal:n.signal}).catch(async e=>{c.a.sendTraceTag(573875971,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy:generateSnapDownloadUrlAsync - error when calling SnapUrlHandler : "+e)});clearTimeout(a);let l="";if(o){let e=await o.json();c.a.sendTraceTag(573875972,u.a.msoulscat_Wac_PptSession,f.a.Info,`PodsProxy:generateSnapDownloadUrlAsync - snapUrlResponse, FSuccess:${e.FSuccess}, ErrorCode:${e.ErrorCode}`),e.FSuccess?l=e.SnapUrl:c.a.sendTraceTag(573875973,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy:generateSnapDownloadUrlAsync - snap url failed with errorCode : "+e.ErrorCode)}return l}catch(e){return c.a.sendTraceTag(573875974,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy:generateSnapDownloadUrlAsync - exception: "+e),""}}setErrorMap(){let e=["cancelled","cancelado","","Abgebrochen","","","annul","","avbruten","","annullato","zrueno","poniteno","geannuleerd","","avbrutt","annulleret","",""," hu","Kumottu","dibatalkan","vazgeildi","anulat","anulowane","","visszavonva"];for(let t=0;t<e.length;t+=1)this.m_errorMap.set(e[t],"ErrorRequestCanceled");let t=["The network connection was lost","Could not connect to the server","connection was lost","The internet connection appears to be offline","La conexin de red se perdi","","La connexion rseau a t perdue","  ","","","   ","","Ntverksanslutningen frlorades","A conexo de rede foi perdida","A balants kesildi","Die Netzwerkverbindung wurde unterbrochen","La connessione  stata persa","A ligao  rede foi interrompida","Mistet nettverksforbindelsen","La conexin de red se ha perdido",""," mt kt ni mng","Kehilangan jaringan koneksi","   ","","  ","Verkkoyhteys katkesi","Netvrksforbindelsen gik tabt","Bylo ztraceno pipojen k sti","Poczenie sieciowe zostao utracone","A conexo  internet parece estar desativada","The Internet connection appears to be offline","La conexin a Internet parece estar desactivada","Could not connect to the server","De netwerkverbinding is verbroken","Conexiunea de reea a fost pierdut","","  ","NetworkError when attempting to fetch resource","","No se ha podido establecer conexin con el servidor","Tidak dapat terhubung ke server","","No se pudo establecer conexin con el servidor","A hlzati kapcsolat megszakadt"];for(let e=0;e<t.length;e+=1)this.m_errorMap.set(t[e],"ErrorConnectionLost");let i=["Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","No se pudo completar la operacin. El software caus la anulacin de la conexin","Khng th hon tt tc v. Phn mm  khin kt ni b hy b","  .       ","   .    ","The operation couldnt be completed. Software caused connection abort","Toimintoa ei voitu suorittaa. Ohjelmistosta johtuva yhteyden keskeytys","Lopration na pas pu sachever. Interruption de la connexion due au logiciel","Operasi tidak dapat diselesaikan. Perangkat lunak menyebabkan pemutusan koneksi","No se pudo completar la operacin. El software caus la anulacin de la conexin","A operao no pde ser concluda. O software provocou o cancelamento da conexo","No se ha podido completar la operacin. El software ha causado la anulacin de la conexin","Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","Der Vorgang konnte nicht abgeschlossen werden. Die Software hat einen Verbindungsabbruch verursacht","","",""," ","","Postupak se nije mogao dovriti. Softver je uzrokovao prekid veze","tgrden kunde inte slutfras. Program orsakade avbrott i anslutningen","lem tamamlanamad. Yazlm balantnn kesilmesine neden oldu","   .   "];for(let e=0;e<i.length;e+=1)this.m_errorMap.set(i[e],"ErrorSoftwareConnectionAbort");let r=["The request timed out","","La requte a expir","","Se agot el tiempo de espera","Esgotou-se o tempo limite da solicitao",""];for(let e=0;e<r.length;e+=1)this.m_errorMap.set(r[e],"ErrorRequestTimeout");let n=["cannot parse response","impossible danalyser la rponse",""];for(let e=0;e<n.length;e+=1)this.m_errorMap.set(n[e],"ErrorCannotParseResponse");this.m_errorMap.set("The operation was aborted","ErrorRequestAbort"),this.m_errorMap.set("Failed to fetch","ErrorFailedToFetch"),this.m_errorMap.set(404,"ErrorRequestFailedServerNotFound"),this.m_errorMap.set(502,"ErrorRequestFailedBadGateway"),this.m_errorMap.set(503,"ErrorRequestFailedServiceUnavailable"),this.m_errorMap.set(504,"ErrorRequestFailedGatewayTimeout")}getMappedError(e){let t=e;return t=y.trimErrorName(t,["TypeError:","Loading failed:"]),t.indexOf("Bylo ztraceno")>=0?"ErrorConnectionLost":t.indexOf("AbortError:")>=0?"ErrorRequestAbort":this.m_errorMap.get(t)}static trimErrorName(e,t){let i=e;for(let e=0;e<t.length;e+=1)i.lastIndexOf(t[e])>=0&&(i=i.substring(i.lastIndexOf(t[e])+t[e].length));return i?i.trim():""}static convertServerError(e,t){return t&&e&&""!==e.trim()&&e!==s.unknown?"Server"+e:"ErrorRequestFailed"}async parseMultipartResponseAsync(e,t,i){let a={},o={itemErrorCodeMap:new Map,itemErrorCategoryMap:new Map,itemUsedOutputCacheMap:new Map,responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",responseIsIntentional:!1,data:void 0},l={slideOrder:[],slideAllInfo:[]};if(t[s.firstResponseCheck]={start:y.performanceNowTrimmed(),end:y.performanceNowTrimmed()},e.response&&e.response.body&&e.response.headers&&e.response.headers.get(s.ContentType)){const d=e.response;let h="";try{t[s.fetchBoundary]={start:y.performanceNowTrimmed(),end:y.performanceNowTrimmed()},h=this.m_multipartParser.fetchBoundary(d.headers.get(s.ContentType)),t[s.fetchBoundary].end=y.performanceNowTrimmed()}catch(t){const i=d.headers.get(s.ErrorCode),r=d.headers.get(s.ErrorCategory),n=!!e[s.IsIntentional]&&e[s.IsIntentional],a=d.headers.get(s.XCorrelationId);return c.a.sendTraceTag(593253142,u.a.msoulscat_Wac_PptSession,f.a.Error,`PodsProxy::parseMultipartResponse - fetchBoundary Content-Type header: ${d.headers.get(s.ContentType)}, ErrorCode:${i}, ErrorCategory:${r}, IsIntentional:${n} , Correlation:${a}, Exception:${t}`),o.responseErrorCode=i||"ErrorRequestFailed",o.responseErrorCategory=r||"BadRequest",o}const m=y.performanceNowTrimmed();t[s.downloadResponse]={start:m,end:m},c.a.sendTraceTag(561640520,u.a.msoulscat_Wac_PptSession,f.a.Info,"PodsProxy::parseMultipartResponse - download response stream start: "+m),i&&i.requestType===r.getItemsPresInfoAndSlideInfoAsync&&this.events.emit("requestStageChanged",{requestType:i.requestType,stageInfo:n.DownloadResponseStream});let _,v=!1,b=void 0,S=null;const T=d.headers?d.headers.get(s.ContentLength):-1;let w=-1;if(c.a.sendTraceTag(545063708,u.a.msoulscat_Wac_PptSession,f.a.Info,"PodsProxy:shouldUseResponseStreamWhenReceivedTotalLength: "+this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength),this.m_settings.parsingWhileDownloadingEnabled){let e=!1,_=!1,b=a=>{e=!0,_=a;let o={receivedDataLength:w,responseContentLength:T,duration:y.performanceNowTrimmed()-m,downloadFailed:_};c.a.sendTraceTag(529331328,u.a.msoulscat_Wac_PptSession,f.a.Info,"PodsProxy - return from response stream reading. "+JSON.stringify(o));let l=y.performanceNowTrimmed();c.a.sendTraceTag(529331329,u.a.msoulscat_Wac_PptSession,f.a.Info,`PodsProxy::parseMultipartResponse - download response stream end: ${l}, duration: ${l-m}`),t[s.downloadResponse].end=l,t[s.downloadResponse].length=w,!v&&i&&i.requestType===r.getItemsPresInfoAndSlideInfoAsync&&this.events.emit("requestStageChanged",{requestType:i.requestType,stageInfo:n.ParseMultipartResponse})};w=0;const S=d.body,[M,C]=S.tee(),I=new Promise(async e=>{try{const t=g.Settings.readNumberOrDefault("hackMaxBytes",-1),i=M.getReader();for(;;){const{done:r,value:n}=await i.read();if(r){b(!1),e();break}if(n&&(w+=n.length,t>0&&w>t))throw"hackMaxBytes hit"}}catch(t){c.a.sendTraceTag(528766114,u.a.msoulscat_Wac_PptSession,f.a.Error,`PodsProxy::measuringDownloadPromise - exception ${t}.`),b(!0),e()}});let P;if(i&&i.shouldTimeoutResponseStreamDownload){const t=i&&i.overrideDownloadTimeoutMs?i.overrideDownloadTimeoutMs:this.m_settings.responseStreamDownloadTimeout?this.m_settings.responseStreamDownloadTimeout:3e4;P=window.setTimeout(()=>{e||(v=!0,c.a.sendTraceTag(529331330,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),c.a.sendTraceTag(529331331,u.a.msoulscat_Wac_PptSession,f.a.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),M.cancel(),C.cancel())},t)}const E=new p(this.m_settings,a,t,o),x=this.m_multipartParser.processMultipartBinaryResponse(C.getReader(),h,e=>{E.parsePart(e)});if(await Promise.all([I,x]),_)return g.Settings.readBooleanOrDefault("retryOnNetworkFailure",!1)&&(o.responseErrorCode="ErrorRequestFailed",o.responseErrorCategory="Transient"),o.data=void 0,o;if(i&&i.shouldTimeoutResponseStreamDownload&&(clearTimeout(P),c.a.sendTraceTag(529331332,u.a.msoulscat_Wac_PptSession,f.a.Info,"PodsProxy - response download check. "+JSON.stringify({hasTimeout:v,shouldUseResponseStreamWhenReceivedTotalLength:this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:w,responseContentLength:T}))),v){if(!(this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&T>0&&w>0&&T===w))return o.responseErrorCode="ErrorDownloadResponseStreamTimeout",o;c.a.sendTraceTag(529331333,u.a.msoulscat_Wac_PptSession,f.a.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens")}l=E.parsedResponse}else{if(i&&i.shouldTimeoutResponseStreamDownload){const e=i&&i.overrideDownloadTimeoutMs?i.overrideDownloadTimeoutMs:this.m_settings.responseStreamDownloadTimeout?this.m_settings.responseStreamDownloadTimeout:3e4,t="downloadResponseStreamTimeout";let r,n=new Promise(i=>{b=setTimeout(()=>{c.a.sendTraceTag(560347103,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),r&&(c.a.sendTraceTag(558465244,u.a.msoulscat_Wac_PptSession,f.a.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),r.cancel()),i(t)},e)});r=d.body.getReader(),S=this.readResponseStream(r,T),S.then(e=>{w=e&&e.length||-1;let t={receivedDataLength:w,responseContentLength:T,duration:y.performanceNowTrimmed()-m};c.a.sendTraceTag(558465177,u.a.msoulscat_Wac_PptSession,f.a.Info,"PodsProxy - return from response stream reading. "+JSON.stringify(t))}),_=await Promise.race([S,n]),_===t?v=!0:void 0!==b&&clearTimeout(b)}else{_=new Uint8Array(await d.arrayBuffer());const e=g.Settings.readNumberOrDefault("hackMaxBytes",-1);e>0&&_.length>e&&(_=_.slice(0,e))}if(i&&i.shouldTimeoutResponseStreamDownload&&c.a.sendTraceTag(543019648,u.a.msoulscat_Wac_PptSession,f.a.Info,"PodsProxy - response download check. "+JSON.stringify({hasTimeout:v,shouldUseResponseStreamWhenReceivedTotalLength:this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:w,responseContentLength:T})),v){if(!(this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&S&&T>0&&w>0&&T===w))return o.responseErrorCode="ErrorDownloadResponseStreamTimeout",o;c.a.sendTraceTag(558465245,u.a.msoulscat_Wac_PptSession,f.a.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens"),_=await S}const e=y.performanceNowTrimmed();c.a.sendTraceTag(561640521,u.a.msoulscat_Wac_PptSession,f.a.Info,`PodsProxy::parseMultipartResponse - download response stream end: ${e}, duration: ${e-m}`);let M=_;t[s.downloadResponse].end=e,M&&M.length&&(t[s.downloadResponse].length=M.length),i&&i.requestType===r.getItemsPresInfoAndSlideInfoAsync&&this.events.emit("requestStageChanged",{requestType:i.requestType,stageInfo:n.ParseMultipartResponse});const C=new p(this.m_settings,a,t,o);await this.m_multipartParser.processMultipartBinaryResponse(M,h,e=>{C.parsePart(e)},{forceNewCodePath:!0}),l=C.parsedResponse}}else{const t=e.hasOwnProperty(s.errorCode)&&"ErrorRESERVEDSuccess"!==e[s.errorCode]?e[s.errorCode]:"ErrorRequestFailed",i=e[s.errorCategory]?e[s.errorCategory]:"BadRequest",r=!!e[s.IsIntentional]&&e[s.IsIntentional];o.responseErrorCode=t,o.responseErrorCategory=i,c.a.sendTraceTag(593253143,u.a.msoulscat_Wac_PptSession,f.a.Error,`PodsProxy::parseMultipartResponse - responseErrorCode:${t}, responseErrorCategory:${i}, IsIntentional:${r}`)}t[s.firstResponseCheck].end=y.performanceNowTrimmed(),"ErrorRESERVEDSuccess"!==o.responseErrorCode&&"ErrorRESERVEDSuccess"===o.responseErrorCategory&&(o.responseErrorCategory="BadRequest",c.a.sendTraceTag(593253145,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy::parseMultipartResponse - parsedResponse contains errorCode but no errorCategory. responseErrorCode:"+o.responseErrorCode));for(let e in a)l.slideAllInfo.push({ID:a[e].ID,SlideImageData:a[e].SlideImageData,SlideShowInfo:a[e].SlideShowInfo,Title:a[e].Title,NoteHtml:a[e].NoteHtml,Comments:a[e].Comments,HasAnimation:a[e].HasAnimation,Hidden:a[e].Hidden,HasTransition:a[e].HasTransition,ResourceData:a[e].ResourceData,AccessibilityModel:a[e].AccessibilityModel,MediaUrls:a[e].MediaUrls});try{if(g.Settings.readBooleanOrDefault("shouldUpdateNewFileUrlFromSnapTrailerItem",!1)&&(o.itemErrorCodeMap&&Object.values(o.itemErrorCodeMap).includes("ServerErrorFileDownloadResourceInconsistent")||o.newSnapUrl)){if(o.newSnapUrl)return 0===o.itemErrorCodeMap.size&&c.a.sendTraceTag(509875215,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy:got new snap url without errorcode"),c.a.sendTraceTag(510251348,u.a.msoulscat_Wac_PptSession,f.a.Info,"PodsProxy:getItems get valid new file url"),this.events.emit("downloadUrlChanged",o.newSnapUrl),o;c.a.sendTraceTag(510251347,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy:getItems no valid new file url in ServerErrorFileDownloadResourceInconsistent response")}}catch(e){c.a.sendTraceTag(510251346,u.a.msoulscat_Wac_PptSession,f.a.Error,"PodsProxy:getItems exception trying to check ServerErrorFileDownloadResourceInconsistent")}return o.data=l,o}async readResponseStream(e,t){let i=new Uint8Array(0);try{let r=await e.read();for(;!r.done;){i=new Uint8Array([...i,...r.value]);const n=g.Settings.readNumberOrDefault("hackMaxBytes",-1);if(n>0&&i.length>n)throw i=i.slice(0,n),"hackMaxBytes hit";if(t>0&&i.length===t&&(c.a.sendTraceTag(545063709,u.a.msoulscat_Wac_PptSession,f.a.Info,"PodsProxy::readResponseStream - received length reached content length: "+t),this.m_settings.shouldUseResponseStreamWhenReceivedTotalLength))break;r=await e.read()}}catch(e){return c.a.sendTraceTag(558465246,u.a.msoulscat_Wac_PptSession,f.a.Error,`PodsProxy::readResponseStream - exception ${e}.`),new Uint8Array(0)}return i}generateReportPerfDictionary(e){let t={};return e[s.action]&&(t[s.action]=e[s.action]),e[s.correlationId]&&(t[s.correlationId]=e[s.correlationId]),e[s.server]&&(t[s.server]=e[s.server]),e[s.parser]&&(t[s.parser]=e[s.parser]),e[s.downloadResponse]&&(t[s.downloadResponse]=e[s.downloadResponse]),e[s.usedOutputCache]&&(t[s.usedOutputCache]=e[s.usedOutputCache]),e[s.contentLength]&&(t[s.contentLength]=e[s.contentLength]),t}createPresInfoAndSlideInfoResponse(e,t){let i={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",responseIsIntentional:!1,presInfo:void 0,slideInfo:[]};return t[s.createResponse]={start:y.performanceNowTrimmed(),end:y.performanceNowTrimmed()},i={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,presInfo:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0]:void 0,slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo.slice(1):[],usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap},t[s.createResponse].end=y.performanceNowTrimmed(),i}async createSlideInfoResponse(e,t){let i={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",responseIsIntentional:!1,slideInfo:[]};return t[s.createResponse]={start:y.performanceNowTrimmed(),end:y.performanceNowTrimmed()},await e.then(e=>{i={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}),t[s.createResponse].end=y.performanceNowTrimmed(),i}async createSlideIdResponse(e){let t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",responseIsIntentional:!1,slideId:[]};return await e.then(e=>{t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}),t}async createPresInfoResponse(e){let t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",responseIsIntentional:!1,presInfo:void 0};return await e.then(e=>{t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,presInfo:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0]:void 0,usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}),t}static logPerf(e){}static ensureISlideInfoFilters(e){return e&&void 0!==e.EnableClustering?e:{EnableClustering:!1,ExportAsImages:!1}}static performanceNowTrimmed(){return Math.round(performance.now())}async createSlideOrderAndSlidesInfoIndexResponse(e){let t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCategory:"ErrorRESERVEDSuccess",responseErrorCode:"ErrorRESERVEDSuccess",responseIsIntentional:!1,slideInfo:[],slideId:[]};return await e.then(e=>{t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap,metadata:e.metadata,usedOutputCache:e.usedOutputCache}}),t}static logPerformanceEntries(e){const t=e.getEntriesByType("resource"),i={};for(let e of t){const t=e;if("fetch"!==t.initiatorType)continue;let r=!1;if(r=h.ChangeGate.isChangeGateEnabled("PodsProxy.logAdditionalPerfTiming")?t.name.indexOf("getitems.ashx")>0||t.name.indexOf("getmedia.ashx")>0||t.name.indexOf("remoteuls.ashx")>0||t.name.indexOf("podhandler.ashx")>0||t.name.indexOf("remotetelemetry.ashx")>0:t.name.indexOf("getitems.ashx")>0,r){if(i.name=t.name,i.dateTime=performance.now(),h.ChangeGate.isChangeGateEnabled("PodsProxy.recordPerfTimingUrlParts")){const e=new URL(t.name);i.hostname=e.hostname,i.pathname=e.pathname}i.start=t.startTime,i.redirectStart=t.redirectStart,i.redirectEnd=t.redirectEnd,i.domainLookupStart=t.domainLookupStart,i.domainLookupEnd=t.domainLookupEnd,i.tcpHandshakeStart=t.connectStart,i.tcpHandshakeEnd=t.connectEnd,i.secureConnectionStart=t.secureConnectionStart,i.responseStart=t.responseStart,i.responseEnd=t.responseEnd,i.fetchStart=t.fetchStart,i.requestStart=t.requestStart,"decodedBodySize"in t&&(i.decodedBodySize=t.decodedBodySize),"encodedBodySize"in t&&(i.encodedBodySize=t.encodedBodySize),"transferSize"in t&&(i.transferSize=t.transferSize),Object.keys(i).length>0&&c.a.sendTraceTag(572379986,u.a.msoulscat_Wac_PptSession,f.a.Info,""+JSON.stringify(i))}}}setTimeoutForParsingResponse(e){return window.setTimeout(()=>{c.a.sendTraceTag(571342915,u.a.msoulscat_Wac_PptSession,f.a.Warning,"Parsing didn't finish in the time. "+JSON.stringify(e))},this.m_settings&&this.m_settings.parseResponseTimeout?this.m_settings.parseResponseTimeout:25e3)}objectDictionaryToRequestIdString(e){let t="";for(let i in e)e[i]&&(t=`${t}${i}=${e[i]};`);return t}}y.s_events=new m.EventEmitter,y.s_supportedImageType=[l.ImagePng,l.ImageJpg]},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.updateFlag=-1,this._data=new Float32Array(16)}return e.prototype.toArray=function(){return this._data},e.prototype.setValues=function(t,i,r,n,a,s,o,l,d,h,c,u,f,m,p,g){var _=this._data;return _[0]=t,_[1]=i,_[2]=r,_[3]=n,_[4]=a,_[5]=s,_[6]=o,_[7]=l,_[8]=d,_[9]=h,_[10]=c,_[11]=u,_[12]=f,_[13]=m,_[14]=p,_[15]=g,e._updateFlagSeed+=1,this.updateFlag=e._updateFlagSeed,this},e.prototype.getValueAt=function(e){return this._data[e]},e.prototype.setValueAt=function(t,i){return this._data[t]=i,e._updateFlagSeed+=1,this.updateFlag=e._updateFlagSeed,this},e.prototype.identity=function(){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},e.prototype.translationColumn=function(e,t,i){return this.setValues(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this},e.prototype.translation=function(e,t,i){return this.setValues(1,0,0,0,0,1,0,0,0,0,1,0,e,t,i,1),this},e.prototype.scaling=function(e,t,i){return this.setValues(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this},e.prototype.translationScaling=function(e,t,i,r,n,a){return this.setValues(r,0,0,0,0,n,0,0,0,0,a,0,e*r,t*n,i*a,1),this},e.prototype.rotationX=function(e){var t=Math.cos(e),i=Math.sin(e);return this.setValues(1,0,0,0,0,t,i,0,0,-i,t,0,0,0,0,1),this},e.prototype.rotationY=function(e){var t=Math.cos(e),i=Math.sin(e);return this.setValues(t,0,-i,0,0,1,0,0,i,0,t,0,0,0,0,1),this},e.prototype.rotationZ=function(e){var t=Math.cos(e),i=Math.sin(e);return this.setValues(t,i,0,0,-i,t,0,0,0,0,1,0,0,0,0,1),this},e.prototype.perspective=function(e){return void 0===e&&(e=1.5),this.setValues(1,0,0,0,0,1,0,0,e,e,1,2*e,0,0,0,1),this},e.prototype.multiply=function(e){return this.multiplyToRef(e,this)},e.prototype.multiplyToRef=function(e,t){var i=this._data,r=e._data,n=i[0],a=i[1],s=i[2],o=i[3],l=i[4],d=i[5],h=i[6],c=i[7],u=i[8],f=i[9],m=i[10],p=i[11],g=i[12],_=i[13],v=i[14],y=i[15],b=r[0],S=r[1],T=r[2],w=r[3],M=r[4],C=r[5],I=r[6],P=r[7],E=r[8],x=r[9],A=r[10],k=r[11],R=r[12],O=r[13],L=r[14],F=r[15],D=n*b+a*M+s*E+o*R,B=n*S+a*C+s*x+o*O,N=n*T+a*I+s*A+o*L,V=n*w+a*P+s*k+o*F,U=l*b+d*M+h*E+c*R,W=l*S+d*C+h*x+c*O,z=l*T+d*I+h*A+c*L,G=l*w+d*P+h*k+c*F,j=u*b+f*M+m*E+p*R,H=u*S+f*C+m*x+p*O,q=u*T+f*I+m*A+p*L,$=u*w+f*P+m*k+p*F,Z=g*b+_*M+v*E+y*R,X=g*S+_*C+v*x+y*O,Y=g*T+_*I+v*A+y*L,J=g*w+_*P+v*k+y*F;return t.setValues(D,B,N,V,U,W,z,G,j,H,q,$,Z,X,Y,J),t},e._updateFlagSeed=0,e}();function n(e,t,i,n,a,s){var o=new r;return o.translationScaling(e,t,i,n,a,s),o}function a(){return n(-.5,-.5,0,2,2,1)}function s(){var e=new r;return e.perspective(),e}t.ThinMatrix=r,t.identityMatrix=function(){var e=new r;return e.identity(),e},t.translateMatrix=function(e,t,i){var n=new r;return n.translation(e,t,i),n},t.scaleMatrix=function(e,t,i){var n=new r;return n.scaling(e,t,i),n},t.translateScaleMatrix=n,t.defaultViewModelMatrix=a,t.defaultViewModelProjectionMatrix=function(){var e=s(),t=a();return e.multiply(t)},t.perspectiveMatrix=s},function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"e",(function(){return l})),i.d(t,"c",(function(){return d})),i.d(t,"d",(function(){return h})),i.d(t,"f",(function(){return c})),i.d(t,"a",(function(){return u}));var r=i(7),n=i(0),a=i(16),s=i(14);class o{constructor(e=r.b.Transparent,t=0,i=!1){this.m_changeTracker=new a.a,this.m_color=e,this.m_radius=t,this.m_isSharp=i}get changeTracker(){return this.m_changeTracker}get color(){return this.m_color}get radius(){return this.m_radius}get isSharp(){return this.m_isSharp}set color(e){Object(s.c)(this.m_changeTracker,this.m_color,e),this.m_color=e}set radius(e){Object(s.a)(this.m_changeTracker,this.m_radius,e),this.m_radius=e}set isSharp(e){Object(s.a)(this.m_changeTracker,this.m_isSharp,e),this.m_isSharp=e}clone(){return new o(this.m_color,this.m_radius,this.m_isSharp)}}class l{constructor(e=r.b.Transparent,t=0,i=0,s=0,o=n.e.One,l=n.e.Zero,d=4,h=!1,c=0){this.m_changeTracker=new a.a,this.m_color=e,this.m_radius=t,this.m_angle=i,this.m_distance=s,this.m_scale=o,this.m_skew=l,this.m_alignment=d,this.m_rotateWithShape=h,this.m_shadowType=c}get changeTracker(){return this.m_changeTracker}get color(){return this.m_color}get radius(){return this.m_radius}get angle(){return this.m_angle}get distance(){return this.m_distance}get scale(){return this.m_scale}get skew(){return this.m_skew}get alignment(){return this.m_alignment}get rotateWithShape(){return this.m_rotateWithShape}get shadowType(){return this.m_shadowType}set color(e){Object(s.c)(this.m_changeTracker,this.m_color,e),this.m_color=e}set radius(e){Object(s.a)(this.m_changeTracker,this.m_radius,e),this.m_radius=e}set angle(e){Object(s.a)(this.m_changeTracker,this.m_angle,e),this.m_angle=e}set distance(e){Object(s.a)(this.m_changeTracker,this.m_distance,e),this.m_distance=e}set scale(e){Object(s.c)(this.m_changeTracker,this.m_scale,e),this.m_scale=e}set skew(e){Object(s.c)(this.m_changeTracker,this.m_skew,e),this.m_skew=e}set alignment(e){Object(s.a)(this.m_changeTracker,this.m_alignment,e),this.m_alignment=e}set rotateWithShape(e){Object(s.a)(this.m_changeTracker,this.m_rotateWithShape,e),this.m_rotateWithShape=e}set shadowType(e){Object(s.a)(this.m_changeTracker,this.m_shadowType,e),this.m_shadowType=e}clone(){return new l(this.m_color,this.m_radius,this.m_angle,this.m_distance,this.m_scale,this.m_skew,this.m_alignment,this.m_rotateWithShape,this.m_shadowType)}}class d{constructor(e=r.b.Transparent,t=0,i=0,n=0){this.m_changeTracker=new a.a,this.m_color=e,this.m_radius=t,this.m_angle=i,this.m_distance=n}get changeTracker(){return this.m_changeTracker}get color(){return this.m_color}get radius(){return this.m_radius}get angle(){return this.m_angle}get distance(){return this.m_distance}set color(e){Object(s.c)(this.m_changeTracker,this.m_color,e),this.m_color=e}set radius(e){Object(s.a)(this.m_changeTracker,this.m_radius,e),this.m_radius=e}set angle(e){Object(s.a)(this.m_changeTracker,this.m_angle,e),this.m_angle=e}set distance(e){Object(s.a)(this.m_changeTracker,this.m_distance,e),this.m_distance=e}clone(){return new d(this.m_color,this.m_radius,this.m_angle,this.m_distance)}}class h{constructor(e=0,t=1,i=0,r=0,n=1,s=0){this.m_changeTracker=new a.a,this.m_radius=e,this.m_startAlpha=t,this.m_startPosition=i,this.m_endAlpha=r,this.m_endPosition=n,this.m_distance=s}get changeTracker(){return this.m_changeTracker}get radius(){return this.m_radius}get startAlpha(){return this.m_startAlpha}get startPosition(){return this.m_startPosition}get endAlpha(){return this.m_endAlpha}get endPosition(){return this.m_endPosition}get distance(){return this.m_distance}set radius(e){Object(s.a)(this.m_changeTracker,this.m_radius,e),this.m_radius=e}set startAlpha(e){Object(s.a)(this.m_changeTracker,this.m_startAlpha,e),this.m_startAlpha=e}set startPosition(e){Object(s.a)(this.m_changeTracker,this.m_startPosition,e),this.m_startPosition=e}set endAlpha(e){Object(s.a)(this.m_changeTracker,this.m_endAlpha,e),this.m_endAlpha=e}set endPosition(e){Object(s.a)(this.m_changeTracker,this.m_endPosition,e),this.m_endPosition=e}set distance(e){Object(s.a)(this.m_changeTracker,this.m_distance,e),this.m_distance=e}clone(){return new h(this.m_radius,this.m_startAlpha,this.m_startPosition,this.m_endAlpha,this.m_endPosition,this.m_distance)}}class c{constructor(e=0){this.m_changeTracker=new a.a,this.m_radius=e}get changeTracker(){return this.m_changeTracker}notifyChange(){this.m_changeTracker.notifyChange()}get radius(){return this.m_radius}set radius(e){this.m_radius!=e&&(this.notifyChange(),this.m_radius=e)}clone(){return new c(this.m_radius)}}class u{constructor(e,t,i,r,n){this.m_changeTracker=new a.a,this.glow=e,this.shadow=t,this.innerShadow=i,this.reflection=r,this.softEdges=n}get changeTracker(){return this.m_changeTracker}notifyChange(){this.m_changeTracker.notifyChange()}get glow(){return this.m_glow}get shadow(){return this.m_shadow}get innerShadow(){return this.m_innerShadow}get reflection(){return this.m_reflection}get softEdges(){return this.m_softEdges}get direction(){return this.m_direction||0}get hasEffects(){return!!(this.m_glow||this.m_shadow||this.m_innerShadow||this.m_reflection||this.m_softEdges)}set glow(e){this.m_changeTracker.replaceListener(this.m_glow,e),this.m_glow=e}set shadow(e){this.m_changeTracker.replaceListener(this.m_shadow,e),this.m_shadow=e}set innerShadow(e){this.m_changeTracker.replaceListener(this.m_innerShadow,e),this.m_innerShadow=e}set reflection(e){this.m_changeTracker.replaceListener(this.m_reflection,e),this.m_reflection=e}set softEdges(e){this.m_changeTracker.replaceListener(this.m_softEdges,e),this.m_softEdges=e}set direction(e){Object(s.a)(this.m_changeTracker,this.m_direction,e),this.m_direction=e}clone(){return new u(this.m_glow?this.m_glow.clone():void 0,this.m_shadow?this.m_shadow.clone():void 0,this.m_innerShadow?this.m_innerShadow.clone():void 0,this.m_reflection?this.m_reflection.clone():void 0,this.m_softEdges?this.m_softEdges.clone():void 0)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.aPosition=function(e){return{name:"aPosition",data:e.getVertexPositions(),itemSize:3}},t.aTexcoord=function(e){return{name:"aTexcoord",data:e.getTextureCoords(),itemSize:2}},t.aDelay=function(e){return{name:"aDelay",data:e.getDelays(),itemSize:1}},t.aCenter=function(e){return{name:"aCenter",data:e.getCenter(),itemSize:2}},t.aDistance=function(e){return{name:"aDistance",data:e.getRippleDistance(),itemSize:1}},t.aDirection=function(e,t){return{name:"aDirection",data:e.getDirections(t),itemSize:2}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return f})),i.d(t,"c",(function(){return m}));var r=i(4),n=i(2),a=i(3),s=i(6),o=i(12),l=i(260),d=i.n(l);function h(){window.addEventListener("error",e=>{e.message.includes("ResizeObserver loop")||p(e.error||{message:e.message,name:""},e.filename,e.lineno,e.colno)}),window.addEventListener("unhandledrejection",e=>{r.a.sendTraceTag(574883276,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"unhandledrejection: Reason:"+e.reason),e.reason instanceof Error&&p(e.reason)})}function c(e){try{if(!e||!s.ChangeGate.isChangeGateEnabled("SSC.AllowLoggingStackFileNames"))return;const t=document.createElement("a");return t.href=e,t.pathname.substring(t.pathname.lastIndexOf("/")+1)}catch(e){return void r.a.sendTraceTag(574883277,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"sanitizeUrl exception")}}function u(e,t,i,s){let o="",l=[];try{e.stack&&(l=d.a.parse(e))}catch(e){r.a.sendTraceTag(545122112,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"errorStackParser.parse exception")}for(const e of l)e.fileName&&(e.fileName=c(e.fileName)),o&&(o+="\n"),o+=e.toString();return{msg:e.message,name:e.name,filename:c(t),lineno:i,colno:s,stack:o}}function f(e,t,i,r){return JSON.stringify(u(e,t,i,r))}function m(e){return e instanceof Error?f(e):""+e}function p(e,t,i,s){const l=u(e,t,i,s);r.a.sendTraceTag(574883278,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,JSON.stringify(l)),o.VetoUtils.recordVeto("Crash",l)}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return d})),i.d(t,"c",(function(){return h}));var r=i(0),n=i(5),a=i(22);function s(e,t){const i=new r.e(t*o(e.width,e.end),t*l(e.length,e.end));let s;if(1==e.end||5==e.end)s=new a.a([-.5*i.x,-1*i.y,1,0,0,1,.5*i.x,-1*i.y,1],1==e.end);else if(2==e.end)s=new a.a([-.5*i.x,-1*i.y,1,0,0,1,.5*i.x,-1*i.y,1,0,-.5*i.y,1],!0);else if(3==e.end)s=new a.a([0,.5*i.y,1,.5*i.x,0,1,0,-.5*i.y,1,-.5*i.x,0,1],!0);else if(4==e.end){const e=new a.b;e.moveTo(.5*i.x,0),e.arcTo(.5*i.x,.5*i.y,0,2*Math.PI),e.close(),s=e.createFigure()}return s||n.a.Error(572867280,"bad arrow head"),s}function o(e,t){return 0==e?5==t?2.5:2:1==e?5==t?3.5:3:2==e?5:(n.a.Error(572867281,"bad arrow head"),0)}function l(e,t){return 0==e?2:1==e?3:2==e?5==t?4.5:5:(n.a.Error(572867282,"bad arrow head"),0)}function d(e,t,i,n,a){const s=(3==i.end||4==i.end?.5:1)*l(i.length,i.end)*n,o=(t?e.getPoint(e.getPointCount()-1):e.getPoint(0)).transformPoint(a),d=e.getPointFromDist(s,a,t),h=o.subtract(d).normalized();if(!h)return;const c=new r.e(-h.y,h.x);return new r.b(c.x,c.y,0,h.x,h.y,0,0,0,1).multiply(r.b.Translation2D(o))}function h(e,t){return e?0==e.end||4==e.end||3==e.end?0:5==e.end||2==e.end?t*l(e.length,e.end)/o(e.width,e.end):2*t:0}},function(e,t){function i(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=i,i.equal=function(e,t,i){if(e!=t)throw new Error(i||"Assertion failed: "+e+" != "+t)}},function(e,t,i){"use strict";var r=t,n=i(84),a=i(65),s=i(214);r.assert=a,r.toArray=s.toArray,r.zero2=s.zero2,r.toHex=s.toHex,r.encode=s.encode,r.getNAF=function(e,t,i){var r=new Array(Math.max(e.bitLength(),i)+1);r.fill(0);for(var n=1<<t+1,a=e.clone(),s=0;s<r.length;s++){var o,l=a.andln(n-1);a.isOdd()?(o=l>(n>>1)-1?(n>>1)-l:l,a.isubn(o)):o=0,r[s]=o,a.iushrn(1)}return r},r.getJSF=function(e,t){var i=[[],[]];e=e.clone(),t=t.clone();for(var r=0,n=0;e.cmpn(-r)>0||t.cmpn(-n)>0;){var a,s,o,l=e.andln(3)+r&3,d=t.andln(3)+n&3;3===l&&(l=-1),3===d&&(d=-1),a=0==(1&l)?0:3!=(o=e.andln(7)+r&7)&&5!==o||2!==d?l:-l,i[0].push(a),s=0==(1&d)?0:3!=(o=t.andln(7)+n&7)&&5!==o||2!==l?d:-d,i[1].push(s),2*r===a+1&&(r=1-r),2*n===s+1&&(n=1-n),e.iushrn(1),t.iushrn(1)}return i},r.cachedProperty=function(e,t,i){var r="_"+t;e.prototype[t]=function(){return void 0!==this[r]?this[r]:this[r]=i.call(this)}},r.parseBytes=function(e){return"string"==typeof e?r.toArray(e,"hex"):e},r.intFromLE=function(e){return new n(e,"hex","le")}},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(132),s=i(52),o=i(62),l=i(60),d=i(32),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.initModel=function(e){e.hres=1,e.vres=1,e.meshType=0;var t=this.getDrawInfo(2,[o.aPosition,o.aTexcoord]);if(t){var i=l.defaultViewModelProjectionMatrix();return t.shaderProgram.setMatrix("uModelViewProj",i),this.modelDrawInfo=t,t}},t.prototype.drawTexture=function(e){var t=this.modelDrawInfo;return t?(s.bindDrawInfo(t),t.shaderProgram._bindTexture("uSampler1",e),s.drawTriangles(t),!0):(d.logError("Can not draw the smooth model, shader program and model is undefined."),!1)},t.prototype.internalDraw=function(e,t,i){return this.drawTexture(t.forward?i.incomingSlideTexture:i.outgoingSlideTexture)},t}(a.Transition);t.MeshTransition=h},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(53),s=i(49),o=i(57),l=i(98),d=i(32),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.model_mData=new l.Mesh,t.m_mData=new l.Mesh,t.glVertexPositionBuffer={buffer:null,itemSize:0},t.glVertexTextureCoordBuffer={buffer:null,itemSize:0},t.glVertexDelayBuffer={buffer:null,itemSize:0},t.glVertexIndexBuffer={buffer:null,itemSize:0,numItems:0},t.glVertexDirectionBuffer={buffer:null,itemSize:0},t.glVertexCenterBuffer={buffer:null,itemSize:0},t.glRippleDistanceBuffer={buffer:null,itemSize:0},t.glModel_vertexPositionBuffer={buffer:null,itemSize:0},t.glModel_vertexTextureCoordBuffer={buffer:null,itemSize:0},t.glModel_vertexIndexBuffer={buffer:null,itemSize:0,numItems:0},t.isForward=!1,t}return n(t,e),t.prototype.init=function(t,i){if(null!=t){e.prototype.init.call(this,t,i),this.meshInfo=new l.MeshInfo(t),this.m_mData.initialize(this.meshInfo),this.isForward=t.forward,this.incomingSlideTexture=t.incomingSlideBackground,this.outgoingSlideTexture=t.outgoingSlideBackground,t.hres=1,t.vres=1,t.meshType=0,this.model_mData.initialize(new l.MeshInfo(t));var r=this.gl;r?(r.disable(r.DEPTH_TEST),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.disable(r.CULL_FACE)):d.logError("WebGLRenderingContext undefined")}},t.prototype.initShaders=function(){var e=this.gl;e?this.model_shaderProgram=o.activateShader(e,2):d.logError("WebGLRenderingContext undefined")},t.prototype.drawTexture=function(e){var t=this.gl;if(t){o.activateShader(t,2),s.bindArrayBufferToVertexAttribPointer(t,this.glModel_vertexPositionBuffer.buffer,this.model_shaderProgram.vertexPositionAttribute,this.glModel_vertexPositionBuffer.itemSize,t.FLOAT),s.bindArrayBufferToVertexAttribPointer(t,this.glModel_vertexTextureCoordBuffer.buffer,this.model_shaderProgram.textureCoordAttribute,this.glModel_vertexTextureCoordBuffer.itemSize,t.FLOAT),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.glModel_vertexIndexBuffer.buffer),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e);var i=s.mat16Identity(),r=s.mat16Mul(s.mat16Translate(-.5,-.5,0),s.mat16Scale(2,2,1)),n=s.mat16Mul(i,r);t.uniformMatrix4fv(this.model_shaderProgram.matrixUniform,!1,n),t.drawElements(t.TRIANGLES,this.glModel_vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)}else d.logError("WebGLRenderingContext undefined")},t.prototype.draw=function(e){return this.drawTexture(this.isForward?this.incomingSlideTexture:this.outgoingSlideTexture),!0},t.prototype.bindModelBuffers=function(){this.bindGLModelVertexBuffer(),this.bindGLModelTextureCoordBuffer(),this.bindGLModelIndexBuffer()},t.prototype.bindGLModelVertexBuffer=function(){this.gl?(this.glModel_vertexPositionBuffer.buffer=this.bindFloat32ArrayBufferData(this.getModelVertexBuffer()),this.glModel_vertexPositionBuffer.itemSize=3):d.logError("WebGLRenderingContext undefined")},t.prototype.bindGLModelTextureCoordBuffer=function(){this.gl?(this.glModel_vertexTextureCoordBuffer.buffer=this.bindFloat32ArrayBufferData(this.getModelTextureCoordBuffer()),this.glModel_vertexTextureCoordBuffer.itemSize=2):d.logError("WebGLRenderingContext undefined")},t.prototype.bindGLModelIndexBuffer=function(){var e=this.gl;if(e){var t=this.getModelIndexBuffer();if(t){var i=t.length;this.glModel_vertexIndexBuffer.buffer=this.bindUint16ArrayBufferData(t,e.ELEMENT_ARRAY_BUFFER),this.glModel_vertexIndexBuffer.itemSize=1,this.glModel_vertexIndexBuffer.numItems=i}else d.logError("index buffer undefined")}else d.logError("WebGLRenderingContext undefined")},t.prototype.bindGLVertexBuffer=function(){this.gl?(this.glVertexPositionBuffer.buffer=this.bindFloat32ArrayBufferData(this.getVertexBuffer()),this.glVertexPositionBuffer.itemSize=3):d.logError("WebGLRenderingContext undefined")},t.prototype.bindGLTextureCoordBuffer=function(){this.gl?(this.glVertexTextureCoordBuffer.buffer=this.bindFloat32ArrayBufferData(this.getTextureCoordBuffer()),this.glVertexTextureCoordBuffer.itemSize=2):d.logError("WebGLRenderingContext undefined")},t.prototype.bindGLIndexBuffer=function(){var e=this.gl;if(e){var t=this.getIndexBuffer();if(t){var i=t.length;this.glVertexIndexBuffer.buffer=this.bindUint16ArrayBufferData(this.getIndexBuffer(),e.ELEMENT_ARRAY_BUFFER),this.glVertexIndexBuffer.itemSize=1,this.glVertexIndexBuffer.numItems=i}else d.logError("index buffer undefined")}else d.logError("WebGLRenderingContext undefined")},t.prototype.bindGLDelayBuffer=function(){this.gl?(this.glVertexDelayBuffer.buffer=this.bindFloat32ArrayBufferData(this.getDelayBuffer()),this.glVertexDelayBuffer.itemSize=1):d.logError("WebGLRenderingContext undefined")},t.prototype.bindGLDirectionBuffer=function(){this.gl?(this.glVertexDirectionBuffer.buffer=this.bindFloat32ArrayBufferData(this.getDirectionBuffer()),this.glVertexDirectionBuffer.itemSize=2):d.logError("WebGLRenderingContext undefined")},t.prototype.bindGLCenterBuffer=function(){this.gl?(this.glVertexCenterBuffer.buffer=this.bindFloat32ArrayBufferData(this.getCenterBuffer()),this.glVertexCenterBuffer.itemSize=2):d.logError("WebGLRenderingContext undefined")},t.prototype.bindGLRippleDistanceBuffer=function(){this.gl?(this.glRippleDistanceBuffer.buffer=this.bindFloat32ArrayBufferData(this.getRippleDistanceBuffer()),this.glRippleDistanceBuffer.itemSize=1):d.logError("WebGLRenderingContext undefined")},t.prototype.getGLModelVertexBuffer=function(){return this.glModel_vertexPositionBuffer},t.prototype.getGLModelTextureCoordBuffer=function(){return this.glModel_vertexTextureCoordBuffer},t.prototype.getGLModelIndexBuffer=function(){return this.glModel_vertexIndexBuffer},t.prototype.getGLVertexBuffer=function(){return this.glVertexPositionBuffer},t.prototype.getGLTextureCoordBuffer=function(){return this.glVertexTextureCoordBuffer},t.prototype.getGLIndexBuffer=function(){return this.glVertexIndexBuffer},t.prototype.getGLDelayBuffer=function(){return this.glVertexDelayBuffer},t.prototype.getGLDirectionBuffer=function(){return this.glVertexDirectionBuffer},t.prototype.getGLCenterBuffer=function(){return this.glVertexCenterBuffer},t.prototype.getGLDistanceBuffer=function(){return this.glRippleDistanceBuffer},t.prototype.getModelVertexBuffer=function(){return this.model_vertexPositionBuffer||(this.model_vertexPositionBuffer=this.model_mData.getVertexPositions()),this.model_vertexPositionBuffer},t.prototype.getModelTextureCoordBuffer=function(){return this.model_vertexTextureCoordBuffer||(this.model_vertexTextureCoordBuffer=this.model_mData.getTextureCoords()),this.model_vertexTextureCoordBuffer},t.prototype.getModelIndexBuffer=function(){return this.model_vertexIndexBuffer||(this.model_vertexIndexBuffer=this.model_mData.getVertexIndices()),this.model_vertexIndexBuffer},t.prototype.getVertexBuffer=function(){return this.vertexPositionBuffer||(this.vertexPositionBuffer=this.m_mData.getVertexPositions()),this.vertexPositionBuffer},t.prototype.getTextureCoordBuffer=function(){return this.vertexTextureCoordBuffer||(this.vertexTextureCoordBuffer=this.m_mData.getTextureCoords()),this.vertexTextureCoordBuffer},t.prototype.getIndexBuffer=function(){return this.vertexIndexBuffer||(this.vertexIndexBuffer=this.m_mData.getVertexIndices()),this.vertexIndexBuffer},t.prototype.getDelayBuffer=function(){return this.vertexDelayBuffer||(this.vertexDelayBuffer=this.m_mData.getDelays()),this.vertexDelayBuffer},t.prototype.getDirectionBuffer=function(){return!this.vertexDirectionBuffer&&this.meshInfo&&(this.vertexDirectionBuffer=this.m_mData.getDirections(this.meshInfo)),this.vertexDirectionBuffer},t.prototype.getCenterBuffer=function(){return this.vertexCenterBuffer||(this.vertexCenterBuffer=this.m_mData.getCenter()),this.vertexCenterBuffer},t.prototype.getRippleDistanceBuffer=function(){return this.rippleDistanceBuffer||(this.rippleDistanceBuffer=this.m_mData.getRippleDistance()),this.rippleDistanceBuffer},t.prototype.bindUint16ArrayBufferData=function(e,t){var i=this.gl,r=this.createBuffer();return i.bindBuffer(t,r),i.bufferData(t,new Uint16Array(e),i.STATIC_DRAW),r},t.prototype.bindFloat32ArrayBufferData=function(e){var t=this.gl,i=this.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),i},t}(a.BaseTransition);t.MeshTransitionBase=h},function(e,t,i){"use strict";i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return a})),i.d(t,"d",(function(){return s})),i.d(t,"a",(function(){return o}));var r=i(0);function n(e,t,i,r,n){return e.scale(n).add(i.scale(r/2)).subtract(t)}function a(e,t,i,r,n){return e.scale(n).add(i.scale(r/2)).subtract(t)}function s(e,t,i,r,s,o,d){const h=n(s.scale(.5),i,r,o,d);return l(n(e,a(e,h,r,o,d).scale(t/o),r,t,d),r,s,o,d,t)}function o(e,t,i,r,a,s){return l(n(r.scale(.5),t,i,a,s).add(e.scale(s)),i,r,a,s)}function l(e,t,i,n,a,s){let o=s,l=e.x,d=e.y;o||(o=n);const h=new r.e(t.x/2,t.y/2);return l=Math.min(l,h.x*o),l=Math.max(l,i.x*a-h.x*o),d=Math.min(d,h.y*o),d=Math.max(d,i.y*a-h.y*o),new r.d(h.scale(-1),new r.e(o,o),void 0,new r.e(l,d))}},function(e,t,i){(function(e,i){var r="[object Arguments]",n="[object Map]",a="[object Object]",s="[object Set]",o=/^\[object .+?Constructor\]$/,l=/^(?:0|[1-9]\d*)$/,d={};d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d[r]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object Boolean]"]=d["[object DataView]"]=d["[object Date]"]=d["[object Error]"]=d["[object Function]"]=d[n]=d["[object Number]"]=d[a]=d["[object RegExp]"]=d[s]=d["[object String]"]=d["[object WeakMap]"]=!1;var h="object"==typeof e&&e&&e.Object===Object&&e,c="object"==typeof self&&self&&self.Object===Object&&self,u=h||c||Function("return this")(),f=t&&!t.nodeType&&t,m=f&&"object"==typeof i&&i&&!i.nodeType&&i,p=m&&m.exports===f,g=p&&h.process,_=function(){try{return g&&g.binding&&g.binding("util")}catch(e){}}(),v=_&&_.isTypedArray;function y(e,t){for(var i=-1,r=null==e?0:e.length;++i<r;)if(t(e[i],i,e))return!0;return!1}function b(e){var t=-1,i=Array(e.size);return e.forEach((function(e,r){i[++t]=[r,e]})),i}function S(e){var t=-1,i=Array(e.size);return e.forEach((function(e){i[++t]=e})),i}var T,w,M,C=Array.prototype,I=Function.prototype,P=Object.prototype,E=u["__core-js_shared__"],x=I.toString,A=P.hasOwnProperty,k=(T=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+T:"",R=P.toString,O=RegExp("^"+x.call(A).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),L=p?u.Buffer:void 0,F=u.Symbol,D=u.Uint8Array,B=P.propertyIsEnumerable,N=C.splice,V=F?F.toStringTag:void 0,U=Object.getOwnPropertySymbols,W=L?L.isBuffer:void 0,z=(w=Object.keys,M=Object,function(e){return w(M(e))}),G=me(u,"DataView"),j=me(u,"Map"),H=me(u,"Promise"),q=me(u,"Set"),$=me(u,"WeakMap"),Z=me(Object,"create"),X=ve(G),Y=ve(j),J=ve(H),K=ve(q),Q=ve($),ee=F?F.prototype:void 0,te=ee?ee.valueOf:void 0;function ie(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function re(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function ne(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function ae(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new ne;++t<i;)this.add(e[t])}function se(e){var t=this.__data__=new re(e);this.size=t.size}function oe(e,t){for(var i=e.length;i--;)if(ye(e[i][0],t))return i;return-1}function le(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":V&&V in Object(e)?function(e){var t=A.call(e,V),i=e[V];try{e[V]=void 0;var r=!0}catch(e){}var n=R.call(e);return r&&(t?e[V]=i:delete e[V]),n}(e):function(e){return R.call(e)}(e)}function de(e){return Ie(e)&&le(e)==r}function he(e,t,i,o,l){return e===t||(null==e||null==t||!Ie(e)&&!Ie(t)?e!=e&&t!=t:function(e,t,i,o,l,d){var h=Se(e),c=Se(t),u=h?"[object Array]":ge(e),f=c?"[object Array]":ge(t),m=(u=u==r?a:u)==a,p=(f=f==r?a:f)==a,g=u==f;if(g&&Te(e)){if(!Te(t))return!1;h=!0,m=!1}if(g&&!m)return d||(d=new se),h||Pe(e)?ce(e,t,i,o,l,d):function(e,t,i,r,a,o,l){switch(i){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new D(e),new D(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ye(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case n:var d=b;case s:var h=1&r;if(d||(d=S),e.size!=t.size&&!h)return!1;var c=l.get(e);if(c)return c==t;r|=2,l.set(e,t);var u=ce(d(e),d(t),r,a,o,l);return l.delete(e),u;case"[object Symbol]":if(te)return te.call(e)==te.call(t)}return!1}(e,t,u,i,o,l,d);if(!(1&i)){var _=m&&A.call(e,"__wrapped__"),v=p&&A.call(t,"__wrapped__");if(_||v){var y=_?e.value():e,T=v?t.value():t;return d||(d=new se),l(y,T,i,o,d)}}return!!g&&(d||(d=new se),function(e,t,i,r,n,a){var s=1&i,o=ue(e),l=o.length;if(l!=ue(t).length&&!s)return!1;for(var d=l;d--;){var h=o[d];if(!(s?h in t:A.call(t,h)))return!1}var c=a.get(e);if(c&&a.get(t))return c==t;var u=!0;a.set(e,t),a.set(t,e);for(var f=s;++d<l;){var m=e[h=o[d]],p=t[h];if(r)var g=s?r(p,m,h,t,e,a):r(m,p,h,e,t,a);if(!(void 0===g?m===p||n(m,p,i,r,a):g)){u=!1;break}f||(f="constructor"==h)}if(u&&!f){var _=e.constructor,v=t.constructor;_==v||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof v&&v instanceof v||(u=!1)}return a.delete(e),a.delete(t),u}(e,t,i,o,l,d))}(e,t,i,o,he,l))}function ce(e,t,i,r,n,a){var s=1&i,o=e.length,l=t.length;if(o!=l&&!(s&&l>o))return!1;var d=a.get(e);if(d&&a.get(t))return d==t;var h=-1,c=!0,u=2&i?new ae:void 0;for(a.set(e,t),a.set(t,e);++h<o;){var f=e[h],m=t[h];if(r)var p=s?r(m,f,h,t,e,a):r(f,m,h,e,t,a);if(void 0!==p){if(p)continue;c=!1;break}if(u){if(!y(t,(function(e,t){if(s=t,!u.has(s)&&(f===e||n(f,e,i,r,a)))return u.push(t);var s}))){c=!1;break}}else if(f!==m&&!n(f,m,i,r,a)){c=!1;break}}return a.delete(e),a.delete(t),c}function ue(e){return function(e,t,i){var r=t(e);return Se(e)?r:function(e,t){for(var i=-1,r=t.length,n=e.length;++i<r;)e[n+i]=t[i];return e}(r,i(e))}(e,Ee,pe)}function fe(e,t){var i,r,n=e.__data__;return("string"==(r=typeof(i=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==i:null===i)?n["string"==typeof t?"string":"hash"]:n.map}function me(e,t){var i=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!Ce(e)||function(e){return!!k&&k in e}(e))&&(we(e)?O:o).test(ve(e))}(i)?i:void 0}ie.prototype.clear=function(){this.__data__=Z?Z(null):{},this.size=0},ie.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ie.prototype.get=function(e){var t=this.__data__;if(Z){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i}return A.call(t,e)?t[e]:void 0},ie.prototype.has=function(e){var t=this.__data__;return Z?void 0!==t[e]:A.call(t,e)},ie.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Z&&void 0===t?"__lodash_hash_undefined__":t,this},re.prototype.clear=function(){this.__data__=[],this.size=0},re.prototype.delete=function(e){var t=this.__data__,i=oe(t,e);return!(i<0||(i==t.length-1?t.pop():N.call(t,i,1),--this.size,0))},re.prototype.get=function(e){var t=this.__data__,i=oe(t,e);return i<0?void 0:t[i][1]},re.prototype.has=function(e){return oe(this.__data__,e)>-1},re.prototype.set=function(e,t){var i=this.__data__,r=oe(i,e);return r<0?(++this.size,i.push([e,t])):i[r][1]=t,this},ne.prototype.clear=function(){this.size=0,this.__data__={hash:new ie,map:new(j||re),string:new ie}},ne.prototype.delete=function(e){var t=fe(this,e).delete(e);return this.size-=t?1:0,t},ne.prototype.get=function(e){return fe(this,e).get(e)},ne.prototype.has=function(e){return fe(this,e).has(e)},ne.prototype.set=function(e,t){var i=fe(this,e),r=i.size;return i.set(e,t),this.size+=i.size==r?0:1,this},ae.prototype.add=ae.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},ae.prototype.has=function(e){return this.__data__.has(e)},se.prototype.clear=function(){this.__data__=new re,this.size=0},se.prototype.delete=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i},se.prototype.get=function(e){return this.__data__.get(e)},se.prototype.has=function(e){return this.__data__.has(e)},se.prototype.set=function(e,t){var i=this.__data__;if(i instanceof re){var r=i.__data__;if(!j||r.length<199)return r.push([e,t]),this.size=++i.size,this;i=this.__data__=new ne(r)}return i.set(e,t),this.size=i.size,this};var pe=U?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var i=-1,r=null==e?0:e.length,n=0,a=[];++i<r;){var s=e[i];t(s)&&(a[n++]=s)}return a}(U(e),(function(t){return B.call(e,t)})))}:function(){return[]},ge=le;function _e(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||l.test(e))&&e>-1&&e%1==0&&e<t}function ve(e){if(null!=e){try{return x.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ye(e,t){return e===t||e!=e&&t!=t}(G&&"[object DataView]"!=ge(new G(new ArrayBuffer(1)))||j&&ge(new j)!=n||H&&"[object Promise]"!=ge(H.resolve())||q&&ge(new q)!=s||$&&"[object WeakMap]"!=ge(new $))&&(ge=function(e){var t=le(e),i=t==a?e.constructor:void 0,r=i?ve(i):"";if(r)switch(r){case X:return"[object DataView]";case Y:return n;case J:return"[object Promise]";case K:return s;case Q:return"[object WeakMap]"}return t});var be=de(function(){return arguments}())?de:function(e){return Ie(e)&&A.call(e,"callee")&&!B.call(e,"callee")},Se=Array.isArray,Te=W||function(){return!1};function we(e){if(!Ce(e))return!1;var t=le(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Me(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Ce(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ie(e){return null!=e&&"object"==typeof e}var Pe=v?function(e){return function(t){return e(t)}}(v):function(e){return Ie(e)&&Me(e.length)&&!!d[le(e)]};function Ee(e){return null!=(t=e)&&Me(t.length)&&!we(t)?function(e,t){var i=Se(e),r=!i&&be(e),n=!i&&!r&&Te(e),a=!i&&!r&&!n&&Pe(e),s=i||r||n||a,o=s?function(e,t){for(var i=-1,r=Array(e);++i<e;)r[i]=t(i);return r}(e.length,String):[],l=o.length;for(var d in e)!t&&!A.call(e,d)||s&&("length"==d||n&&("offset"==d||"parent"==d)||a&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||_e(d,l))||o.push(d);return o}(e):function(e){if(i=(t=e)&&t.constructor,t!==("function"==typeof i&&i.prototype||P))return z(e);var t,i,r=[];for(var n in Object(e))A.call(e,n)&&"constructor"!=n&&r.push(n);return r}(e);var t}i.exports=function(e,t){return he(e,t)}}).call(this,i(55),i(83)(e))},,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kSlideA=0,t.kSlideB=1,t.kBackfaceVisibility="hidden",t.kTransformStyle="preserve-3d",t.kPerspective=4e3,t.kTransitionEffectOptions={Left:0,Top:1,Right:2,Bottom:3,TopLeft:4,TopRight:5,BottomLeft:6,BottomRight:7,HorizontalOut:0,HorizontalIn:1,VerticalOut:2,VerticalIn:3,Horizontal:0,Vertical:1,ZoomOut:0,ZoomIn:1,Anywhere:0,BlackFromLeft:1,BlackFromRight:3,GoIn:0,GoOut:1,InBounce:4,OutBounce:5},t.kTransitionIds={PPT_TRANSITION_CUT:0,PPT_TRANSITION_RANDOM:1,PPT_TRANSITION_FADE:23,PPT_TRANSITION_FADE_THROUGH_BLACK:6,PPT_TRANSITION_PUSH:20,PPT_TRANSITION_FLIP:43,PPT_TRANSITION_PRISM:44,PPT_TRANSITION_MORPH:60,PPT_TRANSITION_WIPE:10,PPT_TRANSITION_STRIPS:9,PPT_TRANSITION_SPLIT:13,PPT_TRANSITION_ZOOM:11,PPT_TRANSITION_DIAMOND:17,PPT_TRANSITION_PLUS:18,PPT_TRANSITION_CIRCLE:27,PPT_TRANSITION_RANDOMBAR:8,PPT_TRANSITION_COMB:21,PPT_TRANSITION_DISSOLVE:5,PPT_TRANSITION_COVER:4,PPT_TRANSITION_UNCOVER:7,PPT_TRANSITION_WHEEL:26,PPT_TRANSITION_WHEELREVERSE:47,PPT_TRANSITION_WEDGE:19,PPT_TRANSITION_RIPPLE:29,PPT_TRANSITION_BLINDS:2,PPT_TRANSITION_CHECKER:3,PPT_TRANSITION_VORTEX:28,PPT_TRANSITION_SWITCH:42,PPT_TRANSITION_FALLOVER:48,PPT_TRANSITION_DRAPE:49,PPT_TRANSITION_CURTAINS:50,PPT_TRANSITION_WIND:51,PPT_TRANSITION_PRESTIGE:52,PPT_TRANSITION_FRACTURE:53,PPT_TRANSITION_CRUSH:54,PPT_TRANSITION_PEELOFF:55,PPT_TRANSITION_PAGECURLSINGLE:56,PPT_TRANSITION_PAGECURLDOUBLE:57,PPT_TRANSITION_AIRPLANE:58,PPT_TRANSITION_ORIGAMI:59,PPT_TRANSITION_GLITTER:30,PPT_TRANSITION_GALLERY:38,PPT_TRANSITION_PAN:36,PPT_TRANSITION_CONVEYOR:37,PPT_TRANSITION_CROSSZOOM:39,PPT_TRANSITION_FLYTHROUGH:31,PPT_TRANSITION_FLYTHROUGH_CONTENT:32,PPT_TRANSITION_ZOOM_WITH_SPIN:22,PPT_TRANSITION_DOORS:33,PPT_TRANSITION_DOORS_CONTENT:34},t.kTransitionPattern={PatternDiamond:0,PatternHexagon:1}},function(e,t,i){"use strict";i.r(t),i.d(t,"ThinEngine",(function(){return S}));var r=function(){function e(){}return Object.defineProperty(e,"LastCreatedEngine",{get:function(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastCreatedScene",{get:function(){return this._LastCreatedScene},enumerable:!1,configurable:!0}),e.Instances=new Array,e._LastCreatedScene=null,e.UseFallbackTexture=!0,e.FallbackTexture="",e}(),n=i(86),a=i(74),s=i(77),o=function(){function e(){this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,this.reset()}return Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zOffset",{get:function(){return this._zOffset},set:function(e){this._zOffset!==e&&(this._zOffset=e,this._isZOffsetDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cullFace",{get:function(){return this._cullFace},set:function(e){this._cullFace!==e&&(this._cullFace=e,this._isCullFaceDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cull",{get:function(){return this._cull},set:function(e){this._cull!==e&&(this._cull=e,this._isCullDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthFunc",{get:function(){return this._depthFunc},set:function(e){this._depthFunc!==e&&(this._depthFunc=e,this._isDepthFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthMask",{get:function(){return this._depthMask},set:function(e){this._depthMask!==e&&(this._depthMask=e,this._isDepthMaskDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthTest",{get:function(){return this._depthTest},set:function(e){this._depthTest!==e&&(this._depthTest=e,this._isDepthTestDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frontFace",{get:function(){return this._frontFace},set:function(e){this._frontFace!==e&&(this._frontFace=e,this._isFrontFaceDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1},e.prototype.apply=function(e){this.isDirty&&(this._isCullDirty&&(this.cull?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(e.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(e.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(e.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset?(e.enable(e.POLYGON_OFFSET_FILL),e.polygonOffset(this.zOffset,0)):e.disable(e.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(e.frontFace(this.frontFace),this._isFrontFaceDirty=!1))},e}(),l=function(){function e(){this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.reset()}return Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilFunc",{get:function(){return this._stencilFunc},set:function(e){this._stencilFunc!==e&&(this._stencilFunc=e,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilFuncRef",{get:function(){return this._stencilFuncRef},set:function(e){this._stencilFuncRef!==e&&(this._stencilFuncRef=e,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilFuncMask",{get:function(){return this._stencilFuncMask},set:function(e){this._stencilFuncMask!==e&&(this._stencilFuncMask=e,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilOpStencilFail",{get:function(){return this._stencilOpStencilFail},set:function(e){this._stencilOpStencilFail!==e&&(this._stencilOpStencilFail=e,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilOpDepthFail",{get:function(){return this._stencilOpDepthFail},set:function(e){this._stencilOpDepthFail!==e&&(this._stencilOpDepthFail=e,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilOpStencilDepthPass",{get:function(){return this._stencilOpStencilDepthPass},set:function(e){this._stencilOpStencilDepthPass!==e&&(this._stencilOpStencilDepthPass=e,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilMask",{get:function(){return this._stencilMask},set:function(e){this._stencilMask!==e&&(this._stencilMask=e,this._isStencilMaskDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilTest",{get:function(){return this._stencilTest},set:function(e){this._stencilTest!==e&&(this._stencilTest=e,this._isStencilTestDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this._stencilTest=!1,this._stencilMask=255,this._stencilFunc=e.ALWAYS,this._stencilFuncRef=1,this._stencilFuncMask=255,this._stencilOpStencilFail=e.KEEP,this._stencilOpDepthFail=e.KEEP,this._stencilOpStencilDepthPass=e.REPLACE,this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0},e.prototype.apply=function(e){this.isDirty&&(this._isStencilTestDirty&&(this.stencilTest?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(e.stencilMask(this.stencilMask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(e.stencilFunc(this.stencilFunc,this.stencilFuncRef,this.stencilFuncMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(e.stencilOp(this.stencilOpStencilFail,this.stencilOpDepthFail,this.stencilOpStencilDepthPass),this._isStencilOpDirty=!1))},e.ALWAYS=519,e.KEEP=7680,e.REPLACE=7681,e}(),d=function(){function e(){this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._blendFunctionParameters=new Array(4),this._blendEquationParameters=new Array(2),this._blendConstants=new Array(4),this.reset()}return Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alphaBlend",{get:function(){return this._alphaBlend},set:function(e){this._alphaBlend!==e&&(this._alphaBlend=e,this._isAlphaBlendDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.setAlphaBlendConstants=function(e,t,i,r){this._blendConstants[0]===e&&this._blendConstants[1]===t&&this._blendConstants[2]===i&&this._blendConstants[3]===r||(this._blendConstants[0]=e,this._blendConstants[1]=t,this._blendConstants[2]=i,this._blendConstants[3]=r,this._isBlendConstantsDirty=!0)},e.prototype.setAlphaBlendFunctionParameters=function(e,t,i,r){this._blendFunctionParameters[0]===e&&this._blendFunctionParameters[1]===t&&this._blendFunctionParameters[2]===i&&this._blendFunctionParameters[3]===r||(this._blendFunctionParameters[0]=e,this._blendFunctionParameters[1]=t,this._blendFunctionParameters[2]=i,this._blendFunctionParameters[3]=r,this._isBlendFunctionParametersDirty=!0)},e.prototype.setAlphaEquationParameters=function(e,t){this._blendEquationParameters[0]===e&&this._blendEquationParameters[1]===t||(this._blendEquationParameters[0]=e,this._blendEquationParameters[1]=t,this._isBlendEquationParametersDirty=!0)},e.prototype.reset=function(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1},e.prototype.apply=function(e){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?e.enable(e.BLEND):e.disable(e.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(e.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(e.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(e.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))},e}(),h=i(46),c=i(45),u=i(87),f=function(){function e(){}return e.prototype.postProcessor=function(e,t,i,r){return r.getCaps().drawBuffersExtension||(e=e.replace(/#extension.+GL_EXT_draw_buffers.+(enable|require)/g,"")),e},e}(),m=function(){function e(){}return e.prototype.attributeProcessor=function(e){return e.replace("attribute","in")},e.prototype.varyingProcessor=function(e,t){return e.replace("varying",t?"in":"out")},e.prototype.postProcessor=function(e,t,i){var r=-1!==e.search(/#extension.+GL_EXT_draw_buffers.+require/);if(e=(e=e.replace(/#extension.+(GL_OVR_multiview2|GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g,"")).replace(/texture2D\s*\(/g,"texture("),i)e=(e=(e=(e=(e=(e=(e=e.replace(/texture2DLodEXT\s*\(/g,"textureLod(")).replace(/textureCubeLodEXT\s*\(/g,"textureLod(")).replace(/textureCube\s*\(/g,"texture(")).replace(/gl_FragDepthEXT/g,"gl_FragDepth")).replace(/gl_FragColor/g,"glFragColor")).replace(/gl_FragData/g,"glFragData")).replace(/void\s+?main\s*\(/g,(r?"":"out vec4 glFragColor;\n")+"void main(");else if(-1!==t.indexOf("#define MULTIVIEW"))return"#extension GL_OVR_multiview2 : require\nlayout (num_views = 2) in;\n"+e;return e},e}(),p=i(28),g=function(e){function t(t){var i=e.call(this)||this;return i._buffer=t,i}return Object(p.__extends)(t,e),Object.defineProperty(t.prototype,"underlyingResource",{get:function(){return this._buffer},enumerable:!1,configurable:!0}),t}(function(){function e(){this.references=0,this.capacity=0,this.is32Bits=!1}return Object.defineProperty(e.prototype,"underlyingResource",{get:function(){return null},enumerable:!1,configurable:!0}),e}()),_=function(){function e(){this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null}return Object.defineProperty(e.prototype,"isAsync",{get:function(){return this.isParallelCompiled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReady",{get:function(){return!!this.program&&(!this.isParallelCompiled||this.engine._isRenderingStateCompiled(this))},enumerable:!1,configurable:!0}),e.prototype._handlesSpectorRebuildCallback=function(e){e&&this.program&&e(this.program)},e.prototype._getVertexShaderCode=function(){return this.vertexShader?this.engine._getShaderSource(this.vertexShader):null},e.prototype._getFragmentShaderCode=function(){return this.fragmentShader?this.engine._getShaderSource(this.fragmentShader):null},e}(),v=function(){function e(){}return e.CreateCanvas=function(e,t){if("undefined"==typeof document)return new OffscreenCanvas(e,t);var i=document.createElement("canvas");return i.width=e,i.height=t,i},e}(),y=function(){function e(){}return e.SetMatrixPrecision=function(t){if(e.MatrixTrackPrecisionChange=!1,t&&!e.MatrixUse64Bits&&e.MatrixTrackedMatrices)for(var i=0;i<e.MatrixTrackedMatrices.length;++i){var r=e.MatrixTrackedMatrices[i],n=r._m;r._m=new Array(16);for(var a=0;a<16;++a)r._m[a]=n[a]}e.MatrixUse64Bits=t,e.MatrixCurrentType=e.MatrixUse64Bits?Array:Float32Array,e.MatrixTrackedMatrices=null},e.MatrixUse64Bits=!1,e.MatrixTrackPrecisionChange=!0,e.MatrixCurrentType=Float32Array,e.MatrixTrackedMatrices=[],e}(),b=function(){},S=function(){function e(t,i,r,n){var a=this;void 0===n&&(n=!1),this.forcePOTTextures=!1,this.isFullscreen=!1,this.cullBackFaces=!0,this.renderEvenInBackground=!0,this.preventCacheWipeBetweenFrames=!1,this.validateShaderPrograms=!1,this.useReverseDepthBuffer=!1,this.disableUniformBuffers=!1,this._uniformBuffers=new Array,this._webGLVersion=1,this._windowIsBackground=!1,this._highPrecisionShadersAllowed=!0,this._badOS=!1,this._badDesktopOS=!1,this._renderingQueueLaunched=!1,this._activeRenderLoops=new Array,this.onContextLostObservable=new s.a,this.onContextRestoredObservable=new s.a,this._contextWasLost=!1,this._doNotHandleContextLost=!1,this.disableVertexArrayObjects=!1,this._colorWrite=!0,this._colorWriteChanged=!0,this._depthCullingState=new o,this._stencilState=new l,this._alphaState=new d,this._alphaMode=1,this._alphaEquation=0,this._internalTexturesCache=new Array,this._activeChannel=0,this._currentTextureChannel=-1,this._boundTexturesCache={},this._compiledEffects={},this._vertexAttribArraysEnabled=[],this._uintIndicesCurrentlySet=!1,this._currentBoundBuffer=new Array,this._currentFramebuffer=null,this._dummyFramebuffer=null,this._currentBufferPointers=new Array,this._currentInstanceLocations=new Array,this._currentInstanceBuffers=new Array,this._vaoRecordInProgress=!1,this._mustWipeVertexAttributes=!1,this._nextFreeTextureSlots=new Array,this._maxSimultaneousTextures=0,this._activeRequests=new Array,this._transformTextureUrl=null,this.hostInformation={isMobile:!1},this.premultipliedAlpha=!0,this.onBeforeTextureInitObservable=new s.a,this._viewportCached={x:0,y:0,z:0,w:0},this._unpackFlipYCached=null,this.enableUnpackFlipYCached=!0,this._getDepthStencilBuffer=function(e,t,i,r,n,s){var o=a._gl,l=o.createRenderbuffer();return o.bindRenderbuffer(o.RENDERBUFFER,l),i>1&&o.renderbufferStorageMultisample?o.renderbufferStorageMultisample(o.RENDERBUFFER,i,n,e,t):o.renderbufferStorage(o.RENDERBUFFER,r,e,t),o.framebufferRenderbuffer(o.FRAMEBUFFER,s,o.RENDERBUFFER,l),o.bindRenderbuffer(o.RENDERBUFFER,null),l},this._boundUniforms={};var h=null;if(t){if(r=r||{},y.SetMatrixPrecision(!!r.useHighPrecisionMatrix),t.getContext){if(h=t,this._renderingCanvas=h,null!=i&&(r.antialias=i),void 0===r.deterministicLockstep&&(r.deterministicLockstep=!1),void 0===r.lockstepMaxSteps&&(r.lockstepMaxSteps=4),void 0===r.timeStep&&(r.timeStep=1/60),void 0===r.preserveDrawingBuffer&&(r.preserveDrawingBuffer=!1),void 0===r.audioEngine&&(r.audioEngine=!0),void 0===r.stencil&&(r.stencil=!0),!1===r.premultipliedAlpha&&(this.premultipliedAlpha=!1),void 0===r.xrCompatible&&(r.xrCompatible=!0),this._doNotHandleContextLost=!!r.doNotHandleContextLost,navigator&&navigator.userAgent){var p=navigator.userAgent;this.hostInformation.isMobile=-1!==p.indexOf("Mobile");for(var g=0,_=e.ExceptionList;g<_.length;g++){var v=_[g],S=v.key,T=v.targets;if(new RegExp(S).test(p)){if(v.capture&&v.captureConstraint){var w=v.capture,M=v.captureConstraint,C=new RegExp(w).exec(p);if(C&&C.length>0&&parseInt(C[C.length-1])>=M)continue}for(var I=0,P=T;I<P.length;I++)switch(P[I]){case"uniformBuffer":this.disableUniformBuffers=!0;break;case"vao":this.disableVertexArrayObjects=!0}}}}if(this._doNotHandleContextLost||(this._onContextLost=function(e){e.preventDefault(),a._contextWasLost=!0,c.a.Warn("WebGL context lost."),a.onContextLostObservable.notifyObservers(a)},this._onContextRestored=function(){setTimeout((function(){a._initGLContext(),a._rebuildEffects(),a._rebuildInternalTextures(),a._rebuildBuffers(),a.wipeCaches(!0),c.a.Warn("WebGL context successfully restored."),a.onContextRestoredObservable.notifyObservers(a),a._contextWasLost=!1}),0)},h.addEventListener("webglcontextlost",this._onContextLost,!1),h.addEventListener("webglcontextrestored",this._onContextRestored,!1),r.powerPreference="high-performance"),!r.disableWebGL2Support)try{this._gl=h.getContext("webgl2",r)||h.getContext("experimental-webgl2",r),this._gl&&(this._webGLVersion=2,this._gl.deleteQuery||(this._webGLVersion=1))}catch(e){}if(!this._gl){if(!h)throw new Error("The provided canvas is null or undefined.");try{this._gl=h.getContext("webgl",r)||h.getContext("experimental-webgl",r)}catch(e){throw new Error("WebGL not supported")}}if(!this._gl)throw new Error("WebGL not supported")}else{this._gl=t,this._renderingCanvas=this._gl.canvas,this._gl.renderbufferStorageMultisample&&(this._webGLVersion=2);var E=this._gl.getContextAttributes();E&&(r.stencil=E.stencil)}this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),void 0!==r.useHighPrecisionFloats&&(this._highPrecisionShadersAllowed=r.useHighPrecisionFloats);var x=u.a.IsWindowObjectExist()&&window.devicePixelRatio||1,A=r.limitDeviceRatio||x;this._hardwareScalingLevel=n?1/Math.min(A,x):1,this.resize(),this._isStencilEnable=!!r.stencil,this._initGLContext();for(var k=0;k<this._caps.maxVertexAttribs;k++)this._currentBufferPointers[k]=new b;this.webGLVersion>1?this._shaderProcessor=new m:this._shaderProcessor=new f,this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this._creationOptions=r,console.log("Babylon.js v"+e.Version+" - "+this.description)}}return Object.defineProperty(e,"NpmPackage",{get:function(){return"babylonjs@4.2.1"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Version",{get:function(){return"4.2.1"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){var e="WebGL"+this.webGLVersion;return this._caps.parallelShaderCompile&&(e+=" - Parallel shader compilation"),e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ShadersRepository",{get:function(){return n.Effect.ShadersRepository},set:function(e){n.Effect.ShadersRepository=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supportsUniformBuffers",{get:function(){return this.webGLVersion>1&&!this.disableUniformBuffers},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_shouldUseHighPrecisionShader",{get:function(){return!(!this._caps.highPrecisionShaderSupported||!this._highPrecisionShadersAllowed)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"needPOTTextures",{get:function(){return this._webGLVersion<2||this.forcePOTTextures},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doNotHandleContextLost",{get:function(){return this._doNotHandleContextLost},set:function(e){this._doNotHandleContextLost=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_supportsHardwareTextureRescaling",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"framebufferDimensionsObject",{set:function(e){this._framebufferDimensionsObject=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentViewport",{get:function(){return this._cachedViewport},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emptyTexture",{get:function(){return this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1)),this._emptyTexture},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emptyTexture3D",{get:function(){return this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture3D},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emptyTexture2DArray",{get:function(){return this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture2DArray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emptyCubeTexture",{get:function(){if(!this._emptyCubeTexture){var e=new Uint8Array(4),t=[e,e,e,e,e,e];this._emptyCubeTexture=this.createRawCubeTexture(t,1,5,0,!1,!1,1)}return this._emptyCubeTexture},enumerable:!1,configurable:!0}),e.prototype._rebuildInternalTextures=function(){for(var e=0,t=this._internalTexturesCache.slice();e<t.length;e++)t[e]._rebuild()},e.prototype._rebuildEffects=function(){for(var e in this._compiledEffects)this._compiledEffects[e]._prepareEffect();n.Effect.ResetCache()},e.prototype.areAllEffectsReady=function(){for(var e in this._compiledEffects)if(!this._compiledEffects[e].isReady())return!1;return!0},e.prototype._rebuildBuffers=function(){for(var e=0,t=this._uniformBuffers;e<t.length;e++)t[e]._rebuild()},e.prototype._initGLContext=function(){this._caps={maxTexturesImageUnits:this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),maxCombinedTexturesImageUnits:this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),maxVertexTextureImageUnits:this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),maxSamples:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_SAMPLES):1,maxCubemapTextureSize:this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),maxRenderTextureSize:this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),maxVertexAttribs:this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),maxVaryingVectors:this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),maxFragmentUniformVectors:this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),maxVertexUniformVectors:this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),parallelShaderCompile:this._gl.getExtension("KHR_parallel_shader_compile"),standardDerivatives:this._webGLVersion>1||null!==this._gl.getExtension("OES_standard_derivatives"),maxAnisotropy:1,astc:this._gl.getExtension("WEBGL_compressed_texture_astc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_astc"),bptc:this._gl.getExtension("EXT_texture_compression_bptc")||this._gl.getExtension("WEBKIT_EXT_texture_compression_bptc"),s3tc:this._gl.getExtension("WEBGL_compressed_texture_s3tc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),pvrtc:this._gl.getExtension("WEBGL_compressed_texture_pvrtc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:this._gl.getExtension("WEBGL_compressed_texture_etc1")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),etc2:this._gl.getExtension("WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBGL_compressed_texture_es3_0"),textureAnisotropicFilterExtension:this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),uintIndices:this._webGLVersion>1||null!==this._gl.getExtension("OES_element_index_uint"),fragmentDepthSupported:this._webGLVersion>1||null!==this._gl.getExtension("EXT_frag_depth"),highPrecisionShaderSupported:!1,timerQuery:this._gl.getExtension("EXT_disjoint_timer_query_webgl2")||this._gl.getExtension("EXT_disjoint_timer_query"),canUseTimestampForTimerQuery:!1,drawBuffersExtension:!1,maxMSAASamples:1,colorBufferFloat:this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_float"),textureFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_float")),textureHalfFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_half_float")),textureHalfFloatRender:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloatLinearFiltering:!1,vertexArrayObject:!1,instancedArrays:!1,textureLOD:!!(this._webGLVersion>1||this._gl.getExtension("EXT_shader_texture_lod")),blendMinMax:!1,multiview:this._gl.getExtension("OVR_multiview2"),oculusMultiview:this._gl.getExtension("OCULUS_multiview"),depthTextureExtension:!1},this._glVersion=this._gl.getParameter(this._gl.VERSION);var e=this._gl.getExtension("WEBGL_debug_renderer_info");if(null!=e&&(this._glRenderer=this._gl.getParameter(e.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(e.UNMASKED_VENDOR_WEBGL)),this._glVendor||(this._glVendor="Unknown vendor"),this._glRenderer||(this._glRenderer="Unknown renderer"),36193!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=36193),34842!==this._gl.RGBA16F&&(this._gl.RGBA16F=34842),34836!==this._gl.RGBA32F&&(this._gl.RGBA32F=34836),35056!==this._gl.DEPTH24_STENCIL8&&(this._gl.DEPTH24_STENCIL8=35056),this._caps.timerQuery&&(1===this._webGLVersion&&(this._gl.getQuery=this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery)),this._caps.canUseTimestampForTimerQuery=this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT,this._caps.timerQuery.QUERY_COUNTER_BITS_EXT)>0),this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._caps.textureFloatLinearFiltering=!(!this._caps.textureFloat||!this._gl.getExtension("OES_texture_float_linear")),this._caps.textureFloatRender=!(!this._caps.textureFloat||!this._canRenderToFloatFramebuffer()),this._caps.textureHalfFloatLinearFiltering=!!(this._webGLVersion>1||this._caps.textureHalfFloat&&this._gl.getExtension("OES_texture_half_float_linear")),this._webGLVersion>1&&5131!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=5131),this._caps.textureHalfFloatRender=this._caps.textureHalfFloat&&this._canRenderToHalfFloatFramebuffer(),this._webGLVersion>1)this._caps.drawBuffersExtension=!0,this._caps.maxMSAASamples=this._gl.getParameter(this._gl.MAX_SAMPLES);else{var t=this._gl.getExtension("WEBGL_draw_buffers");if(null!==t){this._caps.drawBuffersExtension=!0,this._gl.drawBuffers=t.drawBuffersWEBGL.bind(t),this._gl.DRAW_FRAMEBUFFER=this._gl.FRAMEBUFFER;for(var i=0;i<16;i++)this._gl["COLOR_ATTACHMENT"+i+"_WEBGL"]=t["COLOR_ATTACHMENT"+i+"_WEBGL"]}}if(this._webGLVersion>1)this._caps.depthTextureExtension=!0;else{var r=this._gl.getExtension("WEBGL_depth_texture");null!=r&&(this._caps.depthTextureExtension=!0,this._gl.UNSIGNED_INT_24_8=r.UNSIGNED_INT_24_8_WEBGL)}if(this.disableVertexArrayObjects)this._caps.vertexArrayObject=!1;else if(this._webGLVersion>1)this._caps.vertexArrayObject=!0;else{var n=this._gl.getExtension("OES_vertex_array_object");null!=n&&(this._caps.vertexArrayObject=!0,this._gl.createVertexArray=n.createVertexArrayOES.bind(n),this._gl.bindVertexArray=n.bindVertexArrayOES.bind(n),this._gl.deleteVertexArray=n.deleteVertexArrayOES.bind(n))}if(this._webGLVersion>1)this._caps.instancedArrays=!0;else{var a=this._gl.getExtension("ANGLE_instanced_arrays");null!=a?(this._caps.instancedArrays=!0,this._gl.drawArraysInstanced=a.drawArraysInstancedANGLE.bind(a),this._gl.drawElementsInstanced=a.drawElementsInstancedANGLE.bind(a),this._gl.vertexAttribDivisor=a.vertexAttribDivisorANGLE.bind(a)):this._caps.instancedArrays=!1}if(this._gl.getShaderPrecisionFormat){var s=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT),o=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT);s&&o&&(this._caps.highPrecisionShaderSupported=0!==s.precision&&0!==o.precision)}if(this._webGLVersion>1)this._caps.blendMinMax=!0;else{var l=this._gl.getExtension("EXT_blend_minmax");null!=l&&(this._caps.blendMinMax=!0,this._gl.MAX=l.MAX_EXT,this._gl.MIN=l.MIN_EXT)}this._depthCullingState.depthTest=!0,this._depthCullingState.depthFunc=this._gl.LEQUAL,this._depthCullingState.depthMask=!0,this._maxSimultaneousTextures=this._caps.maxCombinedTexturesImageUnits;for(var d=0;d<this._maxSimultaneousTextures;d++)this._nextFreeTextureSlots.push(d)},Object.defineProperty(e.prototype,"webGLVersion",{get:function(){return this._webGLVersion},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return"ThinEngine"},Object.defineProperty(e.prototype,"isStencilEnable",{get:function(){return this._isStencilEnable},enumerable:!1,configurable:!0}),e.prototype._prepareWorkingCanvas=function(){if(!this._workingCanvas){this._workingCanvas=v.CreateCanvas(1,1);var e=this._workingCanvas.getContext("2d");e&&(this._workingContext=e)}},e.prototype.resetTextureCache=function(){for(var e in this._boundTexturesCache)this._boundTexturesCache.hasOwnProperty(e)&&(this._boundTexturesCache[e]=null);this._currentTextureChannel=-1},e.prototype.getGlInfo=function(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}},e.prototype.setHardwareScalingLevel=function(e){this._hardwareScalingLevel=e,this.resize()},e.prototype.getHardwareScalingLevel=function(){return this._hardwareScalingLevel},e.prototype.getLoadedTexturesCache=function(){return this._internalTexturesCache},e.prototype.getCaps=function(){return this._caps},e.prototype.stopRenderLoop=function(e){if(e){var t=this._activeRenderLoops.indexOf(e);t>=0&&this._activeRenderLoops.splice(t,1)}else this._activeRenderLoops=[]},e.prototype._renderLoop=function(){if(!this._contextWasLost){var e=!0;if(!this.renderEvenInBackground&&this._windowIsBackground&&(e=!1),e){this.beginFrame();for(var t=0;t<this._activeRenderLoops.length;t++)(0,this._activeRenderLoops[t])();this.endFrame()}}this._activeRenderLoops.length>0?this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1},e.prototype.getRenderingCanvas=function(){return this._renderingCanvas},e.prototype.getHostWindow=function(){return u.a.IsWindowObjectExist()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null},e.prototype.getRenderWidth=function(e){return void 0===e&&(e=!1),!e&&this._currentRenderTarget?this._currentRenderTarget.width:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferWidth:this._gl.drawingBufferWidth},e.prototype.getRenderHeight=function(e){return void 0===e&&(e=!1),!e&&this._currentRenderTarget?this._currentRenderTarget.height:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferHeight:this._gl.drawingBufferHeight},e.prototype._queueNewFrame=function(t,i){return e.QueueNewFrame(t,i)},e.prototype.runRenderLoop=function(e){-1===this._activeRenderLoops.indexOf(e)&&(this._activeRenderLoops.push(e),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._boundRenderFunction=this._renderLoop.bind(this),this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))},e.prototype.clear=function(e,t,i,r){void 0===r&&(r=!1),this.applyStates();var n=0;t&&e&&(this._gl.clearColor(e.r,e.g,e.b,void 0!==e.a?e.a:1),n|=this._gl.COLOR_BUFFER_BIT),i&&(this.useReverseDepthBuffer?(this._depthCullingState.depthFunc=this._gl.GREATER,this._gl.clearDepth(0)):this._gl.clearDepth(1),n|=this._gl.DEPTH_BUFFER_BIT),r&&(this._gl.clearStencil(0),n|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(n)},e.prototype._viewport=function(e,t,i,r){e===this._viewportCached.x&&t===this._viewportCached.y&&i===this._viewportCached.z&&r===this._viewportCached.w||(this._viewportCached.x=e,this._viewportCached.y=t,this._viewportCached.z=i,this._viewportCached.w=r,this._gl.viewport(e,t,i,r))},e.prototype.setViewport=function(e,t,i){var r=t||this.getRenderWidth(),n=i||this.getRenderHeight(),a=e.x||0,s=e.y||0;this._cachedViewport=e,this._viewport(a*r,s*n,r*e.width,n*e.height)},e.prototype.beginFrame=function(){},e.prototype.endFrame=function(){this._badOS&&this.flushFramebuffer()},e.prototype.resize=function(){var e,t;u.a.IsWindowObjectExist()?(e=this._renderingCanvas?this._renderingCanvas.clientWidth||this._renderingCanvas.width:window.innerWidth,t=this._renderingCanvas?this._renderingCanvas.clientHeight||this._renderingCanvas.height:window.innerHeight):(e=this._renderingCanvas?this._renderingCanvas.width:100,t=this._renderingCanvas?this._renderingCanvas.height:100),this.setSize(e/this._hardwareScalingLevel,t/this._hardwareScalingLevel)},e.prototype.setSize=function(e,t){return!(!this._renderingCanvas||(e|=0,t|=0,this._renderingCanvas.width===e&&this._renderingCanvas.height===t||(this._renderingCanvas.width=e,this._renderingCanvas.height=t,0)))},e.prototype.bindFramebuffer=function(e,t,i,r,n,a,s){void 0===t&&(t=0),void 0===a&&(a=0),void 0===s&&(s=0),this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget),this._currentRenderTarget=e,this._bindUnboundFramebuffer(e._MSAAFramebuffer?e._MSAAFramebuffer:e._framebuffer);var o=this._gl;e.is2DArray?o.framebufferTextureLayer(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,e._webGLTexture,a,s):e.isCube&&o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_CUBE_MAP_POSITIVE_X+t,e._webGLTexture,a);var l=e._depthStencilTexture;if(l){var d=l._generateStencilBuffer?o.DEPTH_STENCIL_ATTACHMENT:o.DEPTH_ATTACHMENT;e.is2DArray?o.framebufferTextureLayer(o.FRAMEBUFFER,d,l._webGLTexture,a,s):e.isCube?o.framebufferTexture2D(o.FRAMEBUFFER,d,o.TEXTURE_CUBE_MAP_POSITIVE_X+t,l._webGLTexture,a):o.framebufferTexture2D(o.FRAMEBUFFER,d,o.TEXTURE_2D,l._webGLTexture,a)}this._cachedViewport&&!n?this.setViewport(this._cachedViewport,i,r):(i||(i=e.width,a&&(i/=Math.pow(2,a))),r||(r=e.height,a&&(r/=Math.pow(2,a))),this._viewport(0,0,i,r)),this.wipeCaches()},e.prototype._bindUnboundFramebuffer=function(e){this._currentFramebuffer!==e&&(this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,e),this._currentFramebuffer=e)},e.prototype.unBindFramebuffer=function(e,t,i){void 0===t&&(t=!1),this._currentRenderTarget=null;var r=this._gl;if(e._MSAAFramebuffer){if(e._textureArray)return void this.unBindMultiColorAttachmentFramebuffer(e._textureArray,t,i);r.bindFramebuffer(r.READ_FRAMEBUFFER,e._MSAAFramebuffer),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,e._framebuffer),r.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,r.COLOR_BUFFER_BIT,r.NEAREST)}!e.generateMipMaps||t||e.isCube||(this._bindTextureDirectly(r.TEXTURE_2D,e,!0),r.generateMipmap(r.TEXTURE_2D),this._bindTextureDirectly(r.TEXTURE_2D,null)),i&&(e._MSAAFramebuffer&&this._bindUnboundFramebuffer(e._framebuffer),i()),this._bindUnboundFramebuffer(null)},e.prototype.flushFramebuffer=function(){this._gl.flush()},e.prototype.restoreDefaultFramebuffer=function(){this._currentRenderTarget?this.unBindFramebuffer(this._currentRenderTarget):this._bindUnboundFramebuffer(null),this._cachedViewport&&this.setViewport(this._cachedViewport),this.wipeCaches()},e.prototype._resetVertexBufferBinding=function(){this.bindArrayBuffer(null),this._cachedVertexBuffers=null},e.prototype.createVertexBuffer=function(e){return this._createVertexBuffer(e,this._gl.STATIC_DRAW)},e.prototype._createVertexBuffer=function(e,t){var i=this._gl.createBuffer();if(!i)throw new Error("Unable to create vertex buffer");var r=new g(i);return this.bindArrayBuffer(r),e instanceof Array?this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(e),this._gl.STATIC_DRAW):this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STATIC_DRAW),this._resetVertexBufferBinding(),r.references=1,r},e.prototype.createDynamicVertexBuffer=function(e){return this._createVertexBuffer(e,this._gl.DYNAMIC_DRAW)},e.prototype._resetIndexBufferBinding=function(){this.bindIndexBuffer(null),this._cachedIndexBuffer=null},e.prototype.createIndexBuffer=function(e,t){var i=this._gl.createBuffer(),r=new g(i);if(!i)throw new Error("Unable to create index buffer");this.bindIndexBuffer(r);var n=this._normalizeIndexData(e);return this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,n,t?this._gl.DYNAMIC_DRAW:this._gl.STATIC_DRAW),this._resetIndexBufferBinding(),r.references=1,r.is32Bits=4===n.BYTES_PER_ELEMENT,r},e.prototype._normalizeIndexData=function(e){if(e instanceof Uint16Array)return e;if(this._caps.uintIndices){if(e instanceof Uint32Array)return e;for(var t=0;t<e.length;t++)if(e[t]>=65535)return new Uint32Array(e);return new Uint16Array(e)}return new Uint16Array(e)},e.prototype.bindArrayBuffer=function(e){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this.bindBuffer(e,this._gl.ARRAY_BUFFER)},e.prototype.bindUniformBlock=function(e,t,i){var r=e.program,n=this._gl.getUniformBlockIndex(r,t);this._gl.uniformBlockBinding(r,n,i)},e.prototype.bindIndexBuffer=function(e){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this.bindBuffer(e,this._gl.ELEMENT_ARRAY_BUFFER)},e.prototype.bindBuffer=function(e,t){(this._vaoRecordInProgress||this._currentBoundBuffer[t]!==e)&&(this._gl.bindBuffer(t,e?e.underlyingResource:null),this._currentBoundBuffer[t]=e)},e.prototype.updateArrayBuffer=function(e){this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,e)},e.prototype._vertexAttribPointer=function(e,t,i,r,n,a,s){var o=this._currentBufferPointers[t];if(o){var l=!1;o.active?(o.buffer!==e&&(o.buffer=e,l=!0),o.size!==i&&(o.size=i,l=!0),o.type!==r&&(o.type=r,l=!0),o.normalized!==n&&(o.normalized=n,l=!0),o.stride!==a&&(o.stride=a,l=!0),o.offset!==s&&(o.offset=s,l=!0)):(l=!0,o.active=!0,o.index=t,o.size=i,o.type=r,o.normalized=n,o.stride=a,o.offset=s,o.buffer=e),(l||this._vaoRecordInProgress)&&(this.bindArrayBuffer(e),this._gl.vertexAttribPointer(t,i,r,n,a,s))}},e.prototype._bindIndexBufferWithCache=function(e){null!=e&&this._cachedIndexBuffer!==e&&(this._cachedIndexBuffer=e,this.bindIndexBuffer(e),this._uintIndicesCurrentlySet=e.is32Bits)},e.prototype._bindVertexBuffersAttributes=function(e,t){var i=t.getAttributesNames();this._vaoRecordInProgress||this._unbindVertexArrayObject(),this.unbindAllAttributes();for(var r=0;r<i.length;r++){var n=t.getAttributeLocation(r);if(n>=0){var a=e[i[r]];if(!a)continue;this._gl.enableVertexAttribArray(n),this._vaoRecordInProgress||(this._vertexAttribArraysEnabled[n]=!0);var s=a.getBuffer();s&&(this._vertexAttribPointer(s,n,a.getSize(),a.type,a.normalized,a.byteStride,a.byteOffset),a.getIsInstanced()&&(this._gl.vertexAttribDivisor(n,a.getInstanceDivisor()),this._vaoRecordInProgress||(this._currentInstanceLocations.push(n),this._currentInstanceBuffers.push(s))))}}},e.prototype.recordVertexArrayObject=function(e,t,i){var r=this._gl.createVertexArray();return this._vaoRecordInProgress=!0,this._gl.bindVertexArray(r),this._mustWipeVertexAttributes=!0,this._bindVertexBuffersAttributes(e,i),this.bindIndexBuffer(t),this._vaoRecordInProgress=!1,this._gl.bindVertexArray(null),r},e.prototype.bindVertexArrayObject=function(e,t){this._cachedVertexArrayObject!==e&&(this._cachedVertexArrayObject=e,this._gl.bindVertexArray(e),this._cachedVertexBuffers=null,this._cachedIndexBuffer=null,this._uintIndicesCurrentlySet=null!=t&&t.is32Bits,this._mustWipeVertexAttributes=!0)},e.prototype.bindBuffersDirectly=function(e,t,i,r,n){if(this._cachedVertexBuffers!==e||this._cachedEffectForVertexBuffers!==n){this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=n;var a=n.getAttributesCount();this._unbindVertexArrayObject(),this.unbindAllAttributes();for(var s=0,o=0;o<a;o++)if(o<i.length){var l=n.getAttributeLocation(o);l>=0&&(this._gl.enableVertexAttribArray(l),this._vertexAttribArraysEnabled[l]=!0,this._vertexAttribPointer(e,l,i[o],this._gl.FLOAT,!1,r,s)),s+=4*i[o]}}this._bindIndexBufferWithCache(t)},e.prototype._unbindVertexArrayObject=function(){this._cachedVertexArrayObject&&(this._cachedVertexArrayObject=null,this._gl.bindVertexArray(null))},e.prototype.bindBuffers=function(e,t,i){this._cachedVertexBuffers===e&&this._cachedEffectForVertexBuffers===i||(this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=i,this._bindVertexBuffersAttributes(e,i)),this._bindIndexBufferWithCache(t)},e.prototype.unbindInstanceAttributes=function(){for(var e,t=0,i=this._currentInstanceLocations.length;t<i;t++){var r=this._currentInstanceBuffers[t];e!=r&&r.references&&(e=r,this.bindArrayBuffer(r));var n=this._currentInstanceLocations[t];this._gl.vertexAttribDivisor(n,0)}this._currentInstanceBuffers.length=0,this._currentInstanceLocations.length=0},e.prototype.releaseVertexArrayObject=function(e){this._gl.deleteVertexArray(e)},e.prototype._releaseBuffer=function(e){return e.references--,0===e.references&&(this._deleteBuffer(e),!0)},e.prototype._deleteBuffer=function(e){this._gl.deleteBuffer(e.underlyingResource)},e.prototype.updateAndBindInstancesBuffer=function(e,t,i){if(this.bindArrayBuffer(e),t&&this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t),void 0!==i[0].index)this.bindInstancesBuffer(e,i,!0);else for(var r=0;r<4;r++){var n=i[r];this._vertexAttribArraysEnabled[n]||(this._gl.enableVertexAttribArray(n),this._vertexAttribArraysEnabled[n]=!0),this._vertexAttribPointer(e,n,4,this._gl.FLOAT,!1,64,16*r),this._gl.vertexAttribDivisor(n,1),this._currentInstanceLocations.push(n),this._currentInstanceBuffers.push(e)}},e.prototype.bindInstancesBuffer=function(e,t,i){void 0===i&&(i=!0),this.bindArrayBuffer(e);var r=0;if(i)for(var n=0;n<t.length;n++)r+=4*(a=t[n]).attributeSize;for(n=0;n<t.length;n++){var a;void 0===(a=t[n]).index&&(a.index=this._currentEffect.getAttributeLocationByName(a.attributeName)),a.index<0||(this._vertexAttribArraysEnabled[a.index]||(this._gl.enableVertexAttribArray(a.index),this._vertexAttribArraysEnabled[a.index]=!0),this._vertexAttribPointer(e,a.index,a.attributeSize,a.attributeType||this._gl.FLOAT,a.normalized||!1,r,a.offset),this._gl.vertexAttribDivisor(a.index,void 0===a.divisor?1:a.divisor),this._currentInstanceLocations.push(a.index),this._currentInstanceBuffers.push(e))}},e.prototype.disableInstanceAttributeByName=function(e){if(this._currentEffect){var t=this._currentEffect.getAttributeLocationByName(e);this.disableInstanceAttribute(t)}},e.prototype.disableInstanceAttribute=function(e){for(var t,i=!1;-1!==(t=this._currentInstanceLocations.indexOf(e));)this._currentInstanceLocations.splice(t,1),this._currentInstanceBuffers.splice(t,1),i=!0,t=this._currentInstanceLocations.indexOf(e);i&&(this._gl.vertexAttribDivisor(e,0),this.disableAttributeByIndex(e))},e.prototype.disableAttributeByIndex=function(e){this._gl.disableVertexAttribArray(e),this._vertexAttribArraysEnabled[e]=!1,this._currentBufferPointers[e].active=!1},e.prototype.draw=function(e,t,i,r){this.drawElementsType(e?0:1,t,i,r)},e.prototype.drawPointClouds=function(e,t,i){this.drawArraysType(2,e,t,i)},e.prototype.drawUnIndexed=function(e,t,i,r){this.drawArraysType(e?0:1,t,i,r)},e.prototype.drawElementsType=function(e,t,i,r){this.applyStates(),this._reportDrawCall();var n=this._drawMode(e),a=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,s=this._uintIndicesCurrentlySet?4:2;r?this._gl.drawElementsInstanced(n,i,a,t*s,r):this._gl.drawElements(n,i,a,t*s)},e.prototype.drawArraysType=function(e,t,i,r){this.applyStates(),this._reportDrawCall();var n=this._drawMode(e);r?this._gl.drawArraysInstanced(n,t,i,r):this._gl.drawArrays(n,t,i)},e.prototype._drawMode=function(e){switch(e){case 0:return this._gl.TRIANGLES;case 2:return this._gl.POINTS;case 1:return this._gl.LINES;case 3:return this._gl.POINTS;case 4:return this._gl.LINES;case 5:return this._gl.LINE_LOOP;case 6:return this._gl.LINE_STRIP;case 7:return this._gl.TRIANGLE_STRIP;case 8:return this._gl.TRIANGLE_FAN;default:return this._gl.TRIANGLES}},e.prototype._reportDrawCall=function(){},e.prototype._releaseEffect=function(e){this._compiledEffects[e._key]&&(delete this._compiledEffects[e._key],this._deletePipelineContext(e.getPipelineContext()))},e.prototype._deletePipelineContext=function(e){var t=e;t&&t.program&&(t.program.__SPECTOR_rebuildProgram=null,this._gl.deleteProgram(t.program))},e.prototype.createEffect=function(e,t,i,r,a,s,o,l,d){var h=(e.vertexElement||e.vertex||e.vertexToken||e.vertexSource||e)+"+"+(e.fragmentElement||e.fragment||e.fragmentToken||e.fragmentSource||e)+"@"+(a||t.defines);if(this._compiledEffects[h]){var c=this._compiledEffects[h];return o&&c.isReady()&&o(c),c}var u=new n.Effect(e,t,i,r,this,a,s,o,l,d);return u._key=h,this._compiledEffects[h]=u,u},e._ConcatenateShader=function(e,t,i){return void 0===i&&(i=""),i+(t?t+"\n":"")+e},e.prototype._compileShader=function(t,i,r,n){return this._compileRawShader(e._ConcatenateShader(t,r,n),i)},e.prototype._compileRawShader=function(e,t){var i=this._gl,r=i.createShader("vertex"===t?i.VERTEX_SHADER:i.FRAGMENT_SHADER);if(!r)throw new Error("Something went wrong while compile the shader.");return i.shaderSource(r,e),i.compileShader(r),r},e.prototype._getShaderSource=function(e){return this._gl.getShaderSource(e)},e.prototype.createRawShaderProgram=function(e,t,i,r,n){void 0===n&&(n=null),r=r||this._gl;var a=this._compileRawShader(t,"vertex"),s=this._compileRawShader(i,"fragment");return this._createShaderProgram(e,a,s,r,n)},e.prototype.createShaderProgram=function(e,t,i,r,n,a){void 0===a&&(a=null),n=n||this._gl;var s=this._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"",o=this._compileShader(t,"vertex",r,s),l=this._compileShader(i,"fragment",r,s);return this._createShaderProgram(e,o,l,n,a)},e.prototype.createPipelineContext=function(){var e=new _;return e.engine=this,this._caps.parallelShaderCompile&&(e.isParallelCompiled=!0),e},e.prototype._createShaderProgram=function(e,t,i,r,n){void 0===n&&(n=null);var a=r.createProgram();if(e.program=a,!a)throw new Error("Unable to create program");return r.attachShader(a,t),r.attachShader(a,i),r.linkProgram(a),e.context=r,e.vertexShader=t,e.fragmentShader=i,e.isParallelCompiled||this._finalizePipelineContext(e),a},e.prototype._finalizePipelineContext=function(e){var t=e.context,i=e.vertexShader,r=e.fragmentShader,n=e.program;if(!t.getProgramParameter(n,t.LINK_STATUS)){var a,s;if(!this._gl.getShaderParameter(i,this._gl.COMPILE_STATUS)&&(a=this._gl.getShaderInfoLog(i)))throw e.vertexCompilationError=a,new Error("VERTEX SHADER "+a);if(!this._gl.getShaderParameter(r,this._gl.COMPILE_STATUS)&&(a=this._gl.getShaderInfoLog(r)))throw e.fragmentCompilationError=a,new Error("FRAGMENT SHADER "+a);if(s=t.getProgramInfoLog(n))throw e.programLinkError=s,new Error(s)}if(this.validateShaderPrograms&&(t.validateProgram(n),!t.getProgramParameter(n,t.VALIDATE_STATUS)&&(s=t.getProgramInfoLog(n))))throw e.programValidationError=s,new Error(s);t.deleteShader(i),t.deleteShader(r),e.vertexShader=void 0,e.fragmentShader=void 0,e.onCompiled&&(e.onCompiled(),e.onCompiled=void 0)},e.prototype._preparePipelineContext=function(e,t,i,r,n,a,s){var o=e;o.program=r?this.createRawShaderProgram(o,t,i,void 0,s):this.createShaderProgram(o,t,i,a,void 0,s),o.program.__SPECTOR_rebuildProgram=n},e.prototype._isRenderingStateCompiled=function(e){var t=e;return!!this._gl.getProgramParameter(t.program,this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)&&(this._finalizePipelineContext(t),!0)},e.prototype._executeWhenRenderingStateIsCompiled=function(e,t){var i=e;if(i.isParallelCompiled){var r=i.onCompiled;i.onCompiled=r?function(){r(),t()}:t}else t()},e.prototype.getUniforms=function(e,t){for(var i=new Array,r=e,n=0;n<t.length;n++)i.push(this._gl.getUniformLocation(r.program,t[n]));return i},e.prototype.getAttributes=function(e,t){for(var i=[],r=e,n=0;n<t.length;n++)try{i.push(this._gl.getAttribLocation(r.program,t[n]))}catch(e){i.push(-1)}return i},e.prototype.enableEffect=function(e){e&&e!==this._currentEffect&&(this.bindSamplers(e),this._currentEffect=e,e.onBind&&e.onBind(e),e._onBindObservable&&e._onBindObservable.notifyObservers(e))},e.prototype.setInt=function(e,t){return!!e&&(this._gl.uniform1i(e,t),!0)},e.prototype.setIntArray=function(e,t){return!!e&&(this._gl.uniform1iv(e,t),!0)},e.prototype.setIntArray2=function(e,t){return!(!e||t.length%2!=0||(this._gl.uniform2iv(e,t),0))},e.prototype.setIntArray3=function(e,t){return!(!e||t.length%3!=0||(this._gl.uniform3iv(e,t),0))},e.prototype.setIntArray4=function(e,t){return!(!e||t.length%4!=0||(this._gl.uniform4iv(e,t),0))},e.prototype.setArray=function(e,t){return!!e&&(this._gl.uniform1fv(e,t),!0)},e.prototype.setArray2=function(e,t){return!(!e||t.length%2!=0||(this._gl.uniform2fv(e,t),0))},e.prototype.setArray3=function(e,t){return!(!e||t.length%3!=0||(this._gl.uniform3fv(e,t),0))},e.prototype.setArray4=function(e,t){return!(!e||t.length%4!=0||(this._gl.uniform4fv(e,t),0))},e.prototype.setMatrices=function(e,t){return!!e&&(this._gl.uniformMatrix4fv(e,!1,t),!0)},e.prototype.setMatrix3x3=function(e,t){return!!e&&(this._gl.uniformMatrix3fv(e,!1,t),!0)},e.prototype.setMatrix2x2=function(e,t){return!!e&&(this._gl.uniformMatrix2fv(e,!1,t),!0)},e.prototype.setFloat=function(e,t){return!!e&&(this._gl.uniform1f(e,t),!0)},e.prototype.setFloat2=function(e,t,i){return!!e&&(this._gl.uniform2f(e,t,i),!0)},e.prototype.setFloat3=function(e,t,i,r){return!!e&&(this._gl.uniform3f(e,t,i,r),!0)},e.prototype.setFloat4=function(e,t,i,r,n){return!!e&&(this._gl.uniform4f(e,t,i,r,n),!0)},e.prototype.applyStates=function(){if(this._depthCullingState.apply(this._gl),this._stencilState.apply(this._gl),this._alphaState.apply(this._gl),this._colorWriteChanged){this._colorWriteChanged=!1;var e=this._colorWrite;this._gl.colorMask(e,e,e,e)}},e.prototype.setColorWrite=function(e){e!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=e)},e.prototype.getColorWrite=function(){return this._colorWrite},Object.defineProperty(e.prototype,"depthCullingState",{get:function(){return this._depthCullingState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alphaState",{get:function(){return this._alphaState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilState",{get:function(){return this._stencilState},enumerable:!1,configurable:!0}),e.prototype.clearInternalTexturesCache=function(){this._internalTexturesCache=[]},e.prototype.wipeCaches=function(e){this.preventCacheWipeBetweenFrames&&!e||(this._currentEffect=null,this._viewportCached.x=0,this._viewportCached.y=0,this._viewportCached.z=0,this._viewportCached.w=0,this._unbindVertexArrayObject(),e&&(this._currentProgram=null,this.resetTextureCache(),this._stencilState.reset(),this._depthCullingState.reset(),this._depthCullingState.depthFunc=this._gl.LEQUAL,this._alphaState.reset(),this._alphaMode=1,this._alphaEquation=0,this._colorWrite=!0,this._colorWriteChanged=!0,this._unpackFlipYCached=null,this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),this._mustWipeVertexAttributes=!0,this.unbindAllAttributes()),this._resetVertexBufferBinding(),this._cachedIndexBuffer=null,this._cachedEffectForVertexBuffers=null,this.bindIndexBuffer(null))},e.prototype._getSamplingParameters=function(e,t){var i=this._gl,r=i.NEAREST,n=i.NEAREST;switch(e){case 11:r=i.LINEAR,n=t?i.LINEAR_MIPMAP_NEAREST:i.LINEAR;break;case 3:r=i.LINEAR,n=t?i.LINEAR_MIPMAP_LINEAR:i.LINEAR;break;case 8:r=i.NEAREST,n=t?i.NEAREST_MIPMAP_LINEAR:i.NEAREST;break;case 4:r=i.NEAREST,n=t?i.NEAREST_MIPMAP_NEAREST:i.NEAREST;break;case 5:r=i.NEAREST,n=t?i.LINEAR_MIPMAP_NEAREST:i.LINEAR;break;case 6:r=i.NEAREST,n=t?i.LINEAR_MIPMAP_LINEAR:i.LINEAR;break;case 7:r=i.NEAREST,n=i.LINEAR;break;case 1:r=i.NEAREST,n=i.NEAREST;break;case 9:r=i.LINEAR,n=t?i.NEAREST_MIPMAP_NEAREST:i.NEAREST;break;case 10:r=i.LINEAR,n=t?i.NEAREST_MIPMAP_LINEAR:i.NEAREST;break;case 2:r=i.LINEAR,n=i.LINEAR;break;case 12:r=i.LINEAR,n=i.NEAREST}return{min:n,mag:r}},e.prototype._createTexture=function(){var e=this._gl.createTexture();if(!e)throw new Error("Unable to create texture");return e},e.prototype.createTexture=function(t,i,n,a,s,o,l,d,u,f,m,p,g){var _=this;void 0===s&&(s=3),void 0===o&&(o=null),void 0===l&&(l=null),void 0===d&&(d=null),void 0===u&&(u=null),void 0===f&&(f=null),void 0===m&&(m=null);var v="data:"===(t=t||"").substr(0,5),y="blob:"===t.substr(0,5),b=v&&-1!==t.indexOf(";base64,"),S=u||new h.InternalTexture(this,h.InternalTextureSource.Url),T=t;!this._transformTextureUrl||b||u||d||(t=this._transformTextureUrl(t)),T!==t&&(S._originalUrl=T);var w=t.lastIndexOf("."),M=m||(w>-1?t.substring(w).toLowerCase():""),C=null;M.indexOf("?")>-1&&(M=M.split("?")[0]);for(var I=0,P=e._TextureLoaders;I<P.length;I++){var E=P[I];if(E.canLoad(M,p)){C=E;break}}a&&a._addPendingData(S),S.url=t,S.generateMipMaps=!i,S.samplingMode=s,S.invertY=n,this._doNotHandleContextLost||(S._buffer=d);var x=null;o&&!u&&(x=S.onLoadedObservable.add(o)),u||this._internalTexturesCache.push(S);var A=function(e,n){a&&a._removePendingData(S),t===T?(x&&S.onLoadedObservable.remove(x),r.UseFallbackTexture&&_.createTexture(r.FallbackTexture,i,S.invertY,a,s,null,l,d,S),l&&l((e||"Unknown error")+(r.UseFallbackTexture?" - Fallback texture was used":""),n)):(c.a.Warn("Failed to load "+t+", falling back to "+T),_.createTexture(T,i,S.invertY,a,s,o,l,d,S,f,m,p,g))};if(C){var k=function(e){C.loadData(e,S,(function(e,t,i,r,n,o){o?A("TextureLoader failed to load data"):_._prepareWebGLTexture(S,a,e,t,S.invertY,!i,r,(function(){return n(),!1}),s)}),g)};d?d instanceof ArrayBuffer?k(new Uint8Array(d)):ArrayBuffer.isView(d)?k(d):l&&l("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(t,(function(e){return k(new Uint8Array(e))}),void 0,a?a.offlineProvider:void 0,!0,(function(e,t){A("Unable to load "+(e&&e.responseURL,t))}))}else{var R=function(e){y&&!_._doNotHandleContextLost&&(S._buffer=e),_._prepareWebGLTexture(S,a,e.width,e.height,S.invertY,i,!1,(function(t,i,r){var n=_._gl,s=e.width===t&&e.height===i,o=f?_._getInternalFormat(f):".jpg"===M?n.RGB:n.RGBA;if(s)return n.texImage2D(n.TEXTURE_2D,0,o,o,n.UNSIGNED_BYTE,e),!1;var l=_._caps.maxTextureSize;if(e.width>l||e.height>l||!_._supportsHardwareTextureRescaling)return _._prepareWorkingCanvas(),!(!_._workingCanvas||!_._workingContext||(_._workingCanvas.width=t,_._workingCanvas.height=i,_._workingContext.drawImage(e,0,0,e.width,e.height,0,0,t,i),n.texImage2D(n.TEXTURE_2D,0,o,o,n.UNSIGNED_BYTE,_._workingCanvas),S.width=t,S.height=i,1));var d=new h.InternalTexture(_,h.InternalTextureSource.Temp);return _._bindTextureDirectly(n.TEXTURE_2D,d,!0),n.texImage2D(n.TEXTURE_2D,0,o,o,n.UNSIGNED_BYTE,e),_._rescaleTexture(d,S,a,o,(function(){_._releaseTexture(d),_._bindTextureDirectly(n.TEXTURE_2D,S,!0),r()})),!0}),s)};!v||b?d&&(d.decoding||d.close)?R(d):e._FileToolsLoadImage(t,R,A,a?a.offlineProvider:null,p):"string"==typeof d||d instanceof ArrayBuffer||ArrayBuffer.isView(d)||d instanceof Blob?e._FileToolsLoadImage(d,R,A,a?a.offlineProvider:null,p):d&&R(d)}return S},e._FileToolsLoadImage=function(e,t,i,r,n){throw a.a.WarnImport("FileTools")},e.prototype._rescaleTexture=function(e,t,i,r,n){},e.prototype.createRawTexture=function(e,t,i,r,n,s,o,l,d){throw void 0===l&&(l=null),void 0===d&&(d=0),a.a.WarnImport("Engine.RawTexture")},e.prototype.createRawCubeTexture=function(e,t,i,r,n,s,o,l){throw void 0===l&&(l=null),a.a.WarnImport("Engine.RawTexture")},e.prototype.createRawTexture3D=function(e,t,i,r,n,s,o,l,d,h){throw void 0===d&&(d=null),void 0===h&&(h=0),a.a.WarnImport("Engine.RawTexture")},e.prototype.createRawTexture2DArray=function(e,t,i,r,n,s,o,l,d,h){throw void 0===d&&(d=null),void 0===h&&(h=0),a.a.WarnImport("Engine.RawTexture")},e.prototype._unpackFlipY=function(e){this._unpackFlipYCached!==e&&(this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,e?1:0),this.enableUnpackFlipYCached&&(this._unpackFlipYCached=e))},e.prototype._getUnpackAlignement=function(){return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT)},e.prototype._getTextureTarget=function(e){return e.isCube?this._gl.TEXTURE_CUBE_MAP:e.is3D?this._gl.TEXTURE_3D:e.is2DArray||e.isMultiview?this._gl.TEXTURE_2D_ARRAY:this._gl.TEXTURE_2D},e.prototype.updateTextureSamplingMode=function(e,t,i){void 0===i&&(i=!1);var r=this._getTextureTarget(t),n=this._getSamplingParameters(e,t.generateMipMaps||i);this._setTextureParameterInteger(r,this._gl.TEXTURE_MAG_FILTER,n.mag,t),this._setTextureParameterInteger(r,this._gl.TEXTURE_MIN_FILTER,n.min),i&&(t.generateMipMaps=!0,this._gl.generateMipmap(r)),this._bindTextureDirectly(r,null),t.samplingMode=e},e.prototype.updateTextureWrappingMode=function(e,t,i,r){void 0===i&&(i=null),void 0===r&&(r=null);var n=this._getTextureTarget(e);null!==t&&(this._setTextureParameterInteger(n,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t),e),e._cachedWrapU=t),null!==i&&(this._setTextureParameterInteger(n,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(i),e),e._cachedWrapV=i),(e.is2DArray||e.is3D)&&null!==r&&(this._setTextureParameterInteger(n,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(r),e),e._cachedWrapR=r),this._bindTextureDirectly(n,null)},e.prototype._setupDepthStencilTexture=function(e,t,i,r,n){var a=t.width||t,s=t.height||t,o=t.layers||0;e.baseWidth=a,e.baseHeight=s,e.width=a,e.height=s,e.is2DArray=o>0,e.depth=o,e.isReady=!0,e.samples=1,e.generateMipMaps=!1,e._generateDepthBuffer=!0,e._generateStencilBuffer=i,e.samplingMode=r?2:1,e.type=0,e._comparisonFunction=n;var l=this._gl,d=this._getTextureTarget(e),h=this._getSamplingParameters(e.samplingMode,!1);l.texParameteri(d,l.TEXTURE_MAG_FILTER,h.mag),l.texParameteri(d,l.TEXTURE_MIN_FILTER,h.min),l.texParameteri(d,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(d,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),0===n?(l.texParameteri(d,l.TEXTURE_COMPARE_FUNC,515),l.texParameteri(d,l.TEXTURE_COMPARE_MODE,l.NONE)):(l.texParameteri(d,l.TEXTURE_COMPARE_FUNC,n),l.texParameteri(d,l.TEXTURE_COMPARE_MODE,l.COMPARE_REF_TO_TEXTURE))},e.prototype._uploadCompressedDataToTextureDirectly=function(e,t,i,r,n,a,s){void 0===a&&(a=0),void 0===s&&(s=0);var o=this._gl,l=o.TEXTURE_2D;e.isCube&&(l=o.TEXTURE_CUBE_MAP_POSITIVE_X+a),this._gl.compressedTexImage2D(l,s,t,i,r,0,n)},e.prototype._uploadDataToTextureDirectly=function(e,t,i,r,n,a){void 0===i&&(i=0),void 0===r&&(r=0),void 0===a&&(a=!1);var s=this._gl,o=this._getWebGLTextureType(e.type),l=this._getInternalFormat(e.format),d=void 0===n?this._getRGBABufferInternalSizedFormat(e.type,e.format):this._getInternalFormat(n);this._unpackFlipY(e.invertY);var h=s.TEXTURE_2D;e.isCube&&(h=s.TEXTURE_CUBE_MAP_POSITIVE_X+i);var c=Math.round(Math.log(e.width)*Math.LOG2E),u=Math.round(Math.log(e.height)*Math.LOG2E),f=a?e.width:Math.pow(2,Math.max(c-r,0)),m=a?e.height:Math.pow(2,Math.max(u-r,0));s.texImage2D(h,r,d,f,m,0,l,o,t)},e.prototype.updateTextureData=function(e,t,i,r,n,a,s,o){void 0===s&&(s=0),void 0===o&&(o=0);var l=this._gl,d=this._getWebGLTextureType(e.type),h=this._getInternalFormat(e.format);this._unpackFlipY(e.invertY);var c=l.TEXTURE_2D;e.isCube&&(c=l.TEXTURE_CUBE_MAP_POSITIVE_X+s),l.texSubImage2D(c,o,i,r,n,a,h,d,t)},e.prototype._uploadArrayBufferViewToTexture=function(e,t,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=this._gl,a=e.isCube?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D;this._bindTextureDirectly(a,e,!0),this._uploadDataToTextureDirectly(e,t,i,r),this._bindTextureDirectly(a,null,!0)},e.prototype._prepareWebGLTextureContinuation=function(e,t,i,r,n){var a=this._gl;if(a){var s=this._getSamplingParameters(n,!i);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,s.mag),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,s.min),i||r||a.generateMipmap(a.TEXTURE_2D),this._bindTextureDirectly(a.TEXTURE_2D,null),t&&t._removePendingData(e),e.onLoadedObservable.notifyObservers(e),e.onLoadedObservable.clear()}},e.prototype._prepareWebGLTexture=function(t,i,r,n,a,s,o,l,d){var h=this;void 0===d&&(d=3);var c=this.getCaps().maxTextureSize,u=Math.min(c,this.needPOTTextures?e.GetExponentOfTwo(r,c):r),f=Math.min(c,this.needPOTTextures?e.GetExponentOfTwo(n,c):n),m=this._gl;m&&(t._webGLTexture?(this._bindTextureDirectly(m.TEXTURE_2D,t,!0),this._unpackFlipY(void 0===a||!!a),t.baseWidth=r,t.baseHeight=n,t.width=u,t.height=f,t.isReady=!0,l(u,f,(function(){h._prepareWebGLTextureContinuation(t,i,s,o,d)}))||this._prepareWebGLTextureContinuation(t,i,s,o,d)):i&&i._removePendingData(t))},e.prototype._setupFramebufferDepthAttachments=function(e,t,i,r,n){void 0===n&&(n=1);var a=this._gl;if(e&&t)return this._getDepthStencilBuffer(i,r,n,a.DEPTH_STENCIL,a.DEPTH24_STENCIL8,a.DEPTH_STENCIL_ATTACHMENT);if(t){var s=a.DEPTH_COMPONENT16;return this._webGLVersion>1&&(s=a.DEPTH_COMPONENT32F),this._getDepthStencilBuffer(i,r,n,s,s,a.DEPTH_ATTACHMENT)}return e?this._getDepthStencilBuffer(i,r,n,a.STENCIL_INDEX8,a.STENCIL_INDEX8,a.STENCIL_ATTACHMENT):null},e.prototype._releaseFramebufferObjects=function(e){var t=this._gl;e._framebuffer&&(t.deleteFramebuffer(e._framebuffer),e._framebuffer=null),e._depthStencilBuffer&&(t.deleteRenderbuffer(e._depthStencilBuffer),e._depthStencilBuffer=null),e._MSAAFramebuffer&&(t.deleteFramebuffer(e._MSAAFramebuffer),e._MSAAFramebuffer=null),e._MSAARenderBuffer&&(t.deleteRenderbuffer(e._MSAARenderBuffer),e._MSAARenderBuffer=null)},e.prototype._releaseTexture=function(e){this._releaseFramebufferObjects(e),this._deleteTexture(e._webGLTexture),this.unbindAllTextures();var t=this._internalTexturesCache.indexOf(e);-1!==t&&this._internalTexturesCache.splice(t,1),e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureLow&&e._lodTextureLow.dispose(),e._irradianceTexture&&e._irradianceTexture.dispose()},e.prototype._deleteTexture=function(e){this._gl.deleteTexture(e)},e.prototype._setProgram=function(e){this._currentProgram!==e&&(this._gl.useProgram(e),this._currentProgram=e)},e.prototype.bindSamplers=function(e){var t=e.getPipelineContext();this._setProgram(t.program);for(var i=e.getSamplers(),r=0;r<i.length;r++){var n=e.getUniform(i[r]);n&&(this._boundUniforms[r]=n)}this._currentEffect=null},e.prototype._activateCurrentTexture=function(){this._currentTextureChannel!==this._activeChannel&&(this._gl.activeTexture(this._gl.TEXTURE0+this._activeChannel),this._currentTextureChannel=this._activeChannel)},e.prototype._bindTextureDirectly=function(e,t,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1);var n=!1,a=t&&t._associatedChannel>-1;return i&&a&&(this._activeChannel=t._associatedChannel),this._boundTexturesCache[this._activeChannel]!==t||r?(this._activateCurrentTexture(),t&&t.isMultiview?this._gl.bindTexture(e,t?t._colorTextureArray:null):this._gl.bindTexture(e,t?t._webGLTexture:null),this._boundTexturesCache[this._activeChannel]=t,t&&(t._associatedChannel=this._activeChannel)):i&&(n=!0,this._activateCurrentTexture()),a&&!i&&this._bindSamplerUniformToChannel(t._associatedChannel,this._activeChannel),n},e.prototype._bindTexture=function(e,t){if(void 0!==e){t&&(t._associatedChannel=e),this._activeChannel=e;var i=t?this._getTextureTarget(t):this._gl.TEXTURE_2D;this._bindTextureDirectly(i,t)}},e.prototype.unbindAllTextures=function(){for(var e=0;e<this._maxSimultaneousTextures;e++)this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))},e.prototype.setTexture=function(e,t,i){void 0!==e&&(t&&(this._boundUniforms[e]=t),this._setTexture(e,i))},e.prototype._bindSamplerUniformToChannel=function(e,t){var i=this._boundUniforms[e];i&&i._currentState!==t&&(this._gl.uniform1i(i,t),i._currentState=t)},e.prototype._getTextureWrapMode=function(e){switch(e){case 1:return this._gl.REPEAT;case 0:return this._gl.CLAMP_TO_EDGE;case 2:return this._gl.MIRRORED_REPEAT}return this._gl.REPEAT},e.prototype._setTexture=function(e,t,i,r){if(void 0===i&&(i=!1),void 0===r&&(r=!1),!t)return null!=this._boundTexturesCache[e]&&(this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))),!1;if(t.video)this._activeChannel=e,t.update();else if(4===t.delayLoadState)return t.delayLoad(),!1;var n;n=r?t.depthStencilTexture:t.isReady()?t.getInternalTexture():t.isCube?this.emptyCubeTexture:t.is3D?this.emptyTexture3D:t.is2DArray?this.emptyTexture2DArray:this.emptyTexture,!i&&n&&(n._associatedChannel=e);var a=!0;this._boundTexturesCache[e]===n&&(i||this._bindSamplerUniformToChannel(n._associatedChannel,e),a=!1),this._activeChannel=e;var s=this._getTextureTarget(n);if(a&&this._bindTextureDirectly(s,n,i),n&&!n.isMultiview){if(n.isCube&&n._cachedCoordinatesMode!==t.coordinatesMode){n._cachedCoordinatesMode=t.coordinatesMode;var o=3!==t.coordinatesMode&&5!==t.coordinatesMode?1:0;t.wrapU=o,t.wrapV=o}n._cachedWrapU!==t.wrapU&&(n._cachedWrapU=t.wrapU,this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t.wrapU),n)),n._cachedWrapV!==t.wrapV&&(n._cachedWrapV=t.wrapV,this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(t.wrapV),n)),n.is3D&&n._cachedWrapR!==t.wrapR&&(n._cachedWrapR=t.wrapR,this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(t.wrapR),n)),this._setAnisotropicLevel(s,n,t.anisotropicFilteringLevel)}return!0},e.prototype.setTextureArray=function(e,t,i){if(void 0!==e&&t){this._textureUnits&&this._textureUnits.length===i.length||(this._textureUnits=new Int32Array(i.length));for(var r=0;r<i.length;r++){var n=i[r].getInternalTexture();n?(this._textureUnits[r]=e+r,n._associatedChannel=e+r):this._textureUnits[r]=-1}this._gl.uniform1iv(t,this._textureUnits);for(var a=0;a<i.length;a++)this._setTexture(this._textureUnits[a],i[a],!0)}},e.prototype._setAnisotropicLevel=function(e,t,i){var r=this._caps.textureAnisotropicFilterExtension;11!==t.samplingMode&&3!==t.samplingMode&&2!==t.samplingMode&&(i=1),r&&t._cachedAnisotropicFilteringLevel!==i&&(this._setTextureParameterFloat(e,r.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(i,this._caps.maxAnisotropy),t),t._cachedAnisotropicFilteringLevel=i)},e.prototype._setTextureParameterFloat=function(e,t,i,r){this._bindTextureDirectly(e,r,!0,!0),this._gl.texParameterf(e,t,i)},e.prototype._setTextureParameterInteger=function(e,t,i,r){r&&this._bindTextureDirectly(e,r,!0,!0),this._gl.texParameteri(e,t,i)},e.prototype.unbindAllAttributes=function(){if(this._mustWipeVertexAttributes){this._mustWipeVertexAttributes=!1;for(var e=0;e<this._caps.maxVertexAttribs;e++)this.disableAttributeByIndex(e)}else{e=0;for(var t=this._vertexAttribArraysEnabled.length;e<t;e++)e>=this._caps.maxVertexAttribs||!this._vertexAttribArraysEnabled[e]||this.disableAttributeByIndex(e)}},e.prototype.releaseEffects=function(){for(var e in this._compiledEffects){var t=this._compiledEffects[e].getPipelineContext();this._deletePipelineContext(t)}this._compiledEffects={}},e.prototype.dispose=function(){this.stopRenderLoop(),this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear(),this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null),this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null),this._dummyFramebuffer&&this._gl.deleteFramebuffer(this._dummyFramebuffer),this.releaseEffects(),this.unbindAllAttributes(),this._boundUniforms=[],u.a.IsWindowObjectExist()&&this._renderingCanvas&&(this._doNotHandleContextLost||(this._renderingCanvas.removeEventListener("webglcontextlost",this._onContextLost),this._renderingCanvas.removeEventListener("webglcontextrestored",this._onContextRestored))),this._workingCanvas=null,this._workingContext=null,this._currentBufferPointers=[],this._renderingCanvas=null,this._currentProgram=null,this._boundRenderFunction=null,n.Effect.ResetCache();for(var e=0,t=this._activeRequests;e<t.length;e++)t[e].abort()},e.prototype.attachContextLostEvent=function(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextlost",e,!1)},e.prototype.attachContextRestoredEvent=function(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextrestored",e,!1)},e.prototype.getError=function(){return this._gl.getError()},e.prototype._canRenderToFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(1)},e.prototype._canRenderToHalfFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(2)},e.prototype._canRenderToFramebuffer=function(e){for(var t=this._gl;t.getError()!==t.NO_ERROR;);var i=!0,r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,this._getRGBABufferInternalSizedFormat(e),1,1,0,t.RGBA,this._getWebGLTextureType(e),null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST);var n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var a=t.checkFramebufferStatus(t.FRAMEBUFFER);if((i=(i=i&&a===t.FRAMEBUFFER_COMPLETE)&&t.getError()===t.NO_ERROR)&&(t.clear(t.COLOR_BUFFER_BIT),i=i&&t.getError()===t.NO_ERROR),i){t.bindFramebuffer(t.FRAMEBUFFER,null);var s=t.RGBA,o=t.UNSIGNED_BYTE,l=new Uint8Array(4);t.readPixels(0,0,1,1,s,o,l),i=i&&t.getError()===t.NO_ERROR}for(t.deleteTexture(r),t.deleteFramebuffer(n),t.bindFramebuffer(t.FRAMEBUFFER,null);!i&&t.getError()!==t.NO_ERROR;);return i},e.prototype._getWebGLTextureType=function(e){if(1===this._webGLVersion){switch(e){case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT_OES;case 0:return this._gl.UNSIGNED_BYTE;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5}return this._gl.UNSIGNED_BYTE}switch(e){case 3:return this._gl.BYTE;case 0:return this._gl.UNSIGNED_BYTE;case 4:return this._gl.SHORT;case 5:return this._gl.UNSIGNED_SHORT;case 6:return this._gl.INT;case 7:return this._gl.UNSIGNED_INT;case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5;case 11:return this._gl.UNSIGNED_INT_2_10_10_10_REV;case 12:return this._gl.UNSIGNED_INT_24_8;case 13:return this._gl.UNSIGNED_INT_10F_11F_11F_REV;case 14:return this._gl.UNSIGNED_INT_5_9_9_9_REV;case 15:return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV}return this._gl.UNSIGNED_BYTE},e.prototype._getInternalFormat=function(e){var t=this._gl.RGBA;switch(e){case 0:t=this._gl.ALPHA;break;case 1:t=this._gl.LUMINANCE;break;case 2:t=this._gl.LUMINANCE_ALPHA;break;case 6:t=this._gl.RED;break;case 7:t=this._gl.RG;break;case 4:t=this._gl.RGB;break;case 5:t=this._gl.RGBA}if(this._webGLVersion>1)switch(e){case 8:t=this._gl.RED_INTEGER;break;case 9:t=this._gl.RG_INTEGER;break;case 10:t=this._gl.RGB_INTEGER;break;case 11:t=this._gl.RGBA_INTEGER}return t},e.prototype._getRGBABufferInternalSizedFormat=function(e,t){if(1===this._webGLVersion){if(void 0!==t)switch(t){case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;case 4:return this._gl.RGB}return this._gl.RGBA}switch(e){case 3:switch(t){case 6:return this._gl.R8_SNORM;case 7:return this._gl.RG8_SNORM;case 4:return this._gl.RGB8_SNORM;case 8:return this._gl.R8I;case 9:return this._gl.RG8I;case 10:return this._gl.RGB8I;case 11:return this._gl.RGBA8I;default:return this._gl.RGBA8_SNORM}case 0:switch(t){case 6:return this._gl.R8;case 7:return this._gl.RG8;case 4:return this._gl.RGB8;case 5:return this._gl.RGBA8;case 8:return this._gl.R8UI;case 9:return this._gl.RG8UI;case 10:return this._gl.RGB8UI;case 11:return this._gl.RGBA8UI;case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;default:return this._gl.RGBA8}case 4:switch(t){case 8:return this._gl.R16I;case 9:return this._gl.RG16I;case 10:return this._gl.RGB16I;case 11:default:return this._gl.RGBA16I}case 5:switch(t){case 8:return this._gl.R16UI;case 9:return this._gl.RG16UI;case 10:return this._gl.RGB16UI;case 11:default:return this._gl.RGBA16UI}case 6:switch(t){case 8:return this._gl.R32I;case 9:return this._gl.RG32I;case 10:return this._gl.RGB32I;case 11:default:return this._gl.RGBA32I}case 7:switch(t){case 8:return this._gl.R32UI;case 9:return this._gl.RG32UI;case 10:return this._gl.RGB32UI;case 11:default:return this._gl.RGBA32UI}case 1:switch(t){case 6:return this._gl.R32F;case 7:return this._gl.RG32F;case 4:return this._gl.RGB32F;case 5:default:return this._gl.RGBA32F}case 2:switch(t){case 6:return this._gl.R16F;case 7:return this._gl.RG16F;case 4:return this._gl.RGB16F;case 5:default:return this._gl.RGBA16F}case 10:return this._gl.RGB565;case 13:return this._gl.R11F_G11F_B10F;case 14:return this._gl.RGB9_E5;case 8:return this._gl.RGBA4;case 9:return this._gl.RGB5_A1;case 11:switch(t){case 5:return this._gl.RGB10_A2;case 11:return this._gl.RGB10_A2UI;default:return this._gl.RGB10_A2}}return this._gl.RGBA8},e.prototype._getRGBAMultiSampleBufferFormat=function(e){return 1===e?this._gl.RGBA32F:2===e?this._gl.RGBA16F:this._gl.RGBA8},e.prototype._loadFile=function(t,i,r,n,a,s){var o=this,l=e._FileToolsLoadFile(t,i,r,n,a,s);return this._activeRequests.push(l),l.onCompleteObservable.add((function(e){o._activeRequests.splice(o._activeRequests.indexOf(e),1)})),l},e._FileToolsLoadFile=function(e,t,i,r,n,s){throw a.a.WarnImport("FileTools")},e.prototype.readPixels=function(e,t,i,r,n){void 0===n&&(n=!0);var a=n?4:3,s=n?this._gl.RGBA:this._gl.RGB,o=new Uint8Array(r*i*a);return this._gl.readPixels(e,t,i,r,s,this._gl.UNSIGNED_BYTE,o),o},Object.defineProperty(e,"IsSupported",{get:function(){return this.isSupported()},enumerable:!1,configurable:!0}),e.isSupported=function(){if(null!==this._HasMajorPerformanceCaveat)return!this._HasMajorPerformanceCaveat;if(null===this._IsSupported)try{var e=v.CreateCanvas(1,1),t=e.getContext("webgl")||e.getContext("experimental-webgl");this._IsSupported=null!=t&&!!window.WebGLRenderingContext}catch(e){this._IsSupported=!1}return this._IsSupported},Object.defineProperty(e,"HasMajorPerformanceCaveat",{get:function(){if(null===this._HasMajorPerformanceCaveat)try{var e=v.CreateCanvas(1,1),t=e.getContext("webgl",{failIfMajorPerformanceCaveat:!0})||e.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0});this._HasMajorPerformanceCaveat=!t}catch(e){this._HasMajorPerformanceCaveat=!1}return this._HasMajorPerformanceCaveat},enumerable:!1,configurable:!0}),e.CeilingPOT=function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},e.FloorPOT=function(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)-(e>>1)},e.NearestPOT=function(t){var i=e.CeilingPOT(t),r=e.FloorPOT(t);return i-t>t-r?r:i},e.GetExponentOfTwo=function(t,i,r){var n;switch(void 0===r&&(r=2),r){case 1:n=e.FloorPOT(t);break;case 2:n=e.NearestPOT(t);break;case 3:default:n=e.CeilingPOT(t)}return Math.min(n,i)},e.QueueNewFrame=function(e,t){return u.a.IsWindowObjectExist()?(t||(t=window),t.requestPostAnimationFrame?t.requestPostAnimationFrame(e):t.requestAnimationFrame?t.requestAnimationFrame(e):t.msRequestAnimationFrame?t.msRequestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.mozRequestAnimationFrame?t.mozRequestAnimationFrame(e):t.oRequestAnimationFrame?t.oRequestAnimationFrame(e):window.setTimeout(e,16)):"undefined"!=typeof requestAnimationFrame?requestAnimationFrame(e):setTimeout(e,16)},e.prototype.getHostDocument=function(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:document},e.ExceptionList=[{key:"Chrome/63.0",capture:"63\\.0\\.3239\\.(\\d+)",captureConstraint:108,targets:["uniformBuffer"]},{key:"Firefox/58",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Firefox/59",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/72.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/73.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/74.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/71",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/72",capture:null,captureConstraint:null,targets:["vao"]}],e._TextureLoaders=[],e.CollisionsEpsilon=.001,e._IsSupported=null,e._HasMajorPerformanceCaveat=null,e}()},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.WarnImport=function(e){return e+" needs to be imported before as it contains a side-effect required by your code."},e}()},,function(e,t,i){"use strict";var r=i(65),n=i(26);function a(e,t){return 55296==(64512&e.charCodeAt(t))&&!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1))}function s(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function o(e){return 1===e.length?"0"+e:e}function l(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}t.inherits=n,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var i=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),n=0;n<e.length;n+=2)i.push(parseInt(e[n]+e[n+1],16))}else for(var r=0,n=0;n<e.length;n++){var s=e.charCodeAt(n);s<128?i[r++]=s:s<2048?(i[r++]=s>>6|192,i[r++]=63&s|128):a(e,n)?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++n)),i[r++]=s>>18|240,i[r++]=s>>12&63|128,i[r++]=s>>6&63|128,i[r++]=63&s|128):(i[r++]=s>>12|224,i[r++]=s>>6&63|128,i[r++]=63&s|128)}else for(n=0;n<e.length;n++)i[n]=0|e[n];return i},t.toHex=function(e){for(var t="",i=0;i<e.length;i++)t+=o(e[i].toString(16));return t},t.htonl=s,t.toHex32=function(e,t){for(var i="",r=0;r<e.length;r++){var n=e[r];"little"===t&&(n=s(n)),i+=l(n.toString(16))}return i},t.zero2=o,t.zero8=l,t.join32=function(e,t,i,n){var a=i-t;r(a%4==0);for(var s=new Array(a/4),o=0,l=t;o<s.length;o++,l+=4){var d;d="big"===n?e[l]<<24|e[l+1]<<16|e[l+2]<<8|e[l+3]:e[l+3]<<24|e[l+2]<<16|e[l+1]<<8|e[l],s[o]=d>>>0}return s},t.split32=function(e,t){for(var i=new Array(4*e.length),r=0,n=0;r<e.length;r++,n+=4){var a=e[r];"big"===t?(i[n]=a>>>24,i[n+1]=a>>>16&255,i[n+2]=a>>>8&255,i[n+3]=255&a):(i[n+3]=a>>>24,i[n+2]=a>>>16&255,i[n+1]=a>>>8&255,i[n]=255&a)}return i},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,i){return e+t+i>>>0},t.sum32_4=function(e,t,i,r){return e+t+i+r>>>0},t.sum32_5=function(e,t,i,r,n){return e+t+i+r+n>>>0},t.sum64=function(e,t,i,r){var n=e[t],a=r+e[t+1]>>>0,s=(a<r?1:0)+i+n;e[t]=s>>>0,e[t+1]=a},t.sum64_hi=function(e,t,i,r){return(t+r>>>0<t?1:0)+e+i>>>0},t.sum64_lo=function(e,t,i,r){return t+r>>>0},t.sum64_4_hi=function(e,t,i,r,n,a,s,o){var l=0,d=t;return l+=(d=d+r>>>0)<t?1:0,l+=(d=d+a>>>0)<a?1:0,e+i+n+s+(l+=(d=d+o>>>0)<o?1:0)>>>0},t.sum64_4_lo=function(e,t,i,r,n,a,s,o){return t+r+a+o>>>0},t.sum64_5_hi=function(e,t,i,r,n,a,s,o,l,d){var h=0,c=t;return h+=(c=c+r>>>0)<t?1:0,h+=(c=c+a>>>0)<a?1:0,h+=(c=c+o>>>0)<o?1:0,e+i+n+s+l+(h+=(c=c+d>>>0)<d?1:0)>>>0},t.sum64_5_lo=function(e,t,i,r,n,a,s,o,l,d){return t+r+a+o+d>>>0},t.rotr64_hi=function(e,t,i){return(t<<32-i|e>>>i)>>>0},t.rotr64_lo=function(e,t,i){return(e<<32-i|t>>>i)>>>0},t.shr64_hi=function(e,t,i){return e>>>i},t.shr64_lo=function(e,t,i){return(e<<32-i|t>>>i)>>>0}},function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=function(){function e(e,t,i,r){void 0===t&&(t=!1),this.initalize(e,t,i,r)}return e.prototype.initalize=function(e,t,i,r){return void 0===t&&(t=!1),this.mask=e,this.skipNextObservers=t,this.target=i,this.currentTarget=r,this},e}(),n=function(e,t,i){void 0===i&&(i=null),this.callback=e,this.mask=t,this.scope=i,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1},a=(function(){function e(){}e.prototype.dispose=function(){if(this._observers&&this._observables)for(var e=0;e<this._observers.length;e++)this._observables[e].remove(this._observers[e]);this._observers=null,this._observables=null},e.Watch=function(t,i,r,n){void 0===r&&(r=-1),void 0===n&&(n=null);var a=new e;a._observers=new Array,a._observables=t;for(var s=0,o=t;s<o.length;s++){var l=o[s].add(i,r,!1,n);l&&a._observers.push(l)}return a}}(),function(){function e(e){this._observers=new Array,this._eventState=new r(0),e&&(this._onObserverAdded=e)}return Object.defineProperty(e.prototype,"observers",{get:function(){return this._observers},enumerable:!1,configurable:!0}),e.prototype.add=function(e,t,i,r,a){if(void 0===t&&(t=-1),void 0===i&&(i=!1),void 0===r&&(r=null),void 0===a&&(a=!1),!e)return null;var s=new n(e,t,r);return s.unregisterOnNextCall=a,i?this._observers.unshift(s):this._observers.push(s),this._onObserverAdded&&this._onObserverAdded(s),s},e.prototype.addOnce=function(e){return this.add(e,void 0,void 0,void 0,!0)},e.prototype.remove=function(e){return!!e&&-1!==this._observers.indexOf(e)&&(this._deferUnregister(e),!0)},e.prototype.removeCallback=function(e,t){for(var i=0;i<this._observers.length;i++){var r=this._observers[i];if(!(r._willBeUnregistered||r.callback!==e||t&&t!==r.scope))return this._deferUnregister(r),!0}return!1},e.prototype._deferUnregister=function(e){var t=this;e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout((function(){t._remove(e)}),0)},e.prototype._remove=function(e){if(!e)return!1;var t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)},e.prototype.makeObserverTopPriority=function(e){this._remove(e),this._observers.unshift(e)},e.prototype.makeObserverBottomPriority=function(e){this._remove(e),this._observers.push(e)},e.prototype.notifyObservers=function(e,t,i,r,n){if(void 0===t&&(t=-1),!this._observers.length)return!0;var a=this._eventState;a.mask=t,a.target=i,a.currentTarget=r,a.skipNextObservers=!1,a.lastReturnValue=e,a.userInfo=n;for(var s=0,o=this._observers;s<o.length;s++){var l=o[s];if(!l._willBeUnregistered&&(l.mask&t&&(l.scope?a.lastReturnValue=l.callback.apply(l.scope,[e,a]):a.lastReturnValue=l.callback(e,a),l.unregisterOnNextCall&&this._deferUnregister(l)),a.skipNextObservers))return!1}return!0},e.prototype.notifyObserversWithPromise=function(e,t,i,r,n){var a=this;void 0===t&&(t=-1);var s=Promise.resolve(e);if(!this._observers.length)return s;var o=this._eventState;return o.mask=t,o.target=i,o.currentTarget=r,o.skipNextObservers=!1,o.userInfo=n,this._observers.forEach((function(i){o.skipNextObservers||i._willBeUnregistered||i.mask&t&&(s=i.scope?s.then((function(t){return o.lastReturnValue=t,i.callback.apply(i.scope,[e,o])})):s.then((function(t){return o.lastReturnValue=t,i.callback(e,o)})),i.unregisterOnNextCall&&a._deferUnregister(i))})),s.then((function(){return e}))},e.prototype.notifyObserver=function(e,t,i){void 0===i&&(i=-1);var r=this._eventState;r.mask=i,r.skipNextObservers=!1,e.callback(t,r)},e.prototype.hasObservers=function(){return this._observers.length>0},e.prototype.clear=function(){this._observers=new Array,this._onObserverAdded=null},e.prototype.clone=function(){var t=new e;return t._observers=this._observers.slice(0),t},e.prototype.hasSpecificMask=function(e){void 0===e&&(e=-1);for(var t=0,i=this._observers;t<i.length;t++){var r=i[t];if(r.mask&e||r.mask===e)return!0}return!1},e}())},function(e,t,i){"use strict";i.d(t,"d",(function(){return r})),i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return s}));const r=[0,1,2,0,3,4];class n{constructor(){this.totalCostMs=0,this.shapeRenderCostMs=0,this.distanceFieldForTextCostMs=0,this.distanceFieldForGlyphTableCostMs=0,this.distanceFieldForShapeCostMs=0,this.patternTextureCostMs=0,this.pathGradientTextureCostMs=0,this.gradientTextureCostMs=0,this.fadeTextureCostMs=0,this.effectsCostMs=0,this.cacheToSpriteCostMs=0,this.drawTapeCostMs=0,this.glResetCostMs=0,this.glRestoreCostMs=0,this.pathCount=0,this.glyphCount=0,this.glyphCountAddedToCache=0,this.glyphCountReadFromCache=0,this.glyphCountRenderedAsPath=0,this.glyphCountLargeText=0,this.glyphCountTextOutline=0,this.pixelCountDistanceField=0,this.pixelCountShapeRender=0,this.shapeLayerCount=0,this.shapeLayerCountText=0,this.dynamicTextureAlloc=0,this.beginTime=0,this.endTime=0}add(e){this.totalCostMs+=e.totalCostMs,this.shapeRenderCostMs+=e.shapeRenderCostMs,this.distanceFieldForTextCostMs+=e.distanceFieldForTextCostMs,this.distanceFieldForGlyphTableCostMs+=e.distanceFieldForGlyphTableCostMs,this.distanceFieldForShapeCostMs+=e.distanceFieldForShapeCostMs,this.patternTextureCostMs+=e.patternTextureCostMs,this.pathGradientTextureCostMs+=e.pathGradientTextureCostMs,this.gradientTextureCostMs+=e.gradientTextureCostMs,this.fadeTextureCostMs+=e.fadeTextureCostMs,this.effectsCostMs+=e.effectsCostMs,this.cacheToSpriteCostMs+=e.cacheToSpriteCostMs,this.drawTapeCostMs+=e.drawTapeCostMs,this.glResetCostMs+=e.glResetCostMs,this.glRestoreCostMs+=e.glRestoreCostMs,this.pathCount+=e.pathCount,this.glyphCount+=e.glyphCount,this.glyphCountAddedToCache+=e.glyphCountAddedToCache,this.glyphCountReadFromCache+=e.glyphCountReadFromCache,this.glyphCountRenderedAsPath+=e.glyphCountRenderedAsPath,this.glyphCountLargeText+=e.glyphCountLargeText,this.glyphCountTextOutline+=e.glyphCountTextOutline,this.pixelCountDistanceField+=e.pixelCountDistanceField,this.pixelCountShapeRender+=e.pixelCountShapeRender,this.shapeLayerCount+=e.shapeLayerCount,this.shapeLayerCountText+=e.shapeLayerCountText,this.dynamicTextureAlloc+=e.dynamicTextureAlloc,this.beginTime=0,this.endTime=0}}class a{constructor(){this.frameCount=0}}class s{constructor(){this.recreatingSprites=0,this.pictureCropBWTextures=0}}},function(e,t,i){"use strict";function r(){return window.matchMedia("screen and (forced-colors: active)").matches}function n(e,t,i){let r;try{r=JSON.stringify({value:t,expiration:i.toISOString()})}catch(e){return}window.localStorage.setItem(e,r)}function a(e){const t=localStorage.getItem(e);if(null===t)return null;let i;try{i=JSON.parse(t)}catch(t){return localStorage.removeItem(e),null}return!Number.isInteger(i.expiration)&&Number.isNaN(Date.parse(i.expiration))||new Date(i.expiration)<=new Date?(localStorage.removeItem(e),null):i.value}i.d(t,"b",(function(){return r})),i.d(t,"d",(function(){return n})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return o}));const s=["B","I","U"];function o(e,t){const i=new DOMParser;t.replaceChildren(i.parseFromString(e,"text/html").body),function e(t){for(const i of t.childNodes)if(i.nodeType===Node.ELEMENT_NODE){e(i);const t=i;s.indexOf(i.nodeName.toUpperCase())>=0?[...t.attributes].forEach(e=>t.removeAttribute(e.name)):t.replaceWith(...t.childNodes)}}(t)}},function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r=i(4),n=i(2),a=i(3),s=i(95),o=i(12),l=i(1);class d{constructor(e){this.m_frameData=[],this.m_metadata=e,this.m_metadata.dirtyRectTracking=l.Settings.readBooleanOrDefault("enableDirtyRectTracking",!1),this.m_metadata.hostContainer=l.Settings.readStringOrDefault("hostContainer","undefined"),this.m_percentiles=l.Settings.readStringOrDefault("animLogPercentiles","0, 25, 50, 75, 95, 99, 100").split(",").map(Number),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&(this.m_startTime=void 0)})}logFrameData(e,t){const i=Date.now();if("hidden"!==document.visibilityState){if(!this.m_startTime&&e)this.m_startTime=i,this.m_lastFrameTime=this.m_startTime,this.m_frameData=[];else if(this.m_startTime&&e&&this.m_lastFrameTime)this.m_frameData.push(i-this.m_lastFrameTime),this.m_lastFrameTime=i;else if(this.m_startTime&&!e){const e=i-this.m_startTime;if(this.m_startTime=void 0,0===e||e<=l.Settings.readNumberOrDefault("animLogMinDurationMs",700))return;const h=this.m_frameData.length+1,c=1e3*h/e;this.m_frameData.sort((e,t)=>e-t);let u={};for(let e of this.m_percentiles){const t=d.percentile(this.m_frameData,e);t&&(u[e.toString()]=t)}const f=this.m_frameData.splice(-l.Settings.readNumberOrDefault("animLogWorstFrameCount",5)),m={Metadata:{...this.m_metadata,...t?t.metadata:void 0},FrameRate:c.toFixed(2),Duration:e,RenderedFrames:h,Worst:f,Percentile:u};if(r.a.sendTraceTag(595653954,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,JSON.stringify(m)),e<=l.Settings.readNumberOrDefault("animLogVetoMinDurationMs",1e3))return void r.a.sendTraceTag(595641933,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,"AnimatedContentLogger::LogFrameData: Animation is too short, skip checking veto. duration:"+e);let p="SlideshowFPSSlow",g=l.Settings.readNumberOrDefault("animLogVetoMinFPS",24);if(s.ChangeGate.isChangeGateEnabled("SSC.SeparateSlowFPSVeto")&&t&&(t.qosVetoName&&(p=t.qosVetoName),t.vetoFps&&(g=t.vetoFps)),c<g&&!this.m_metadata.ignoreVeto&&o.VetoUtils.recordVeto("VetoedFPS"+(this.m_metadata.type||""),{Info:m||this.m_metadata,FPS:c.toFixed(2),vetoFps:g,qosVeto:p}),f&&f.length>0){const e=l.Settings.readNumberOrDefault("animLogVetoWorstFrameIndex",2),t=Math.min(Math.max(e,0),f.length-1),i=f[f.length-1-t];i>l.Settings.readNumberOrDefault("animLogVetoMaxFrameDurationMs",300)&&o.VetoUtils.recordVeto("VetoedFrameDuration"+(this.m_metadata.type||""),{Info:m||this.m_metadata,FrameDuration:i,qosVeto:p})}}}else this.m_startTime=void 0}get hasLogIntervalStarted(){return!!this.m_startTime}static percentile(e,t){if(0!==e.length)return 0===t?e[0]:e[Math.ceil(e.length*(t/100))-1];r.a.sendTraceTag(595653955,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,`AnimatedContentLogger::percentile: invalid frameData.length . frameData:${!!e}, percentile:${!!t}`)}}},function(e,t,i){"use strict";var r;i.d(t,"a",(function(){return r})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools"}(r||(r={}))},function(e,t,i){"use strict";var r;i.d(t,"a",(function(){return r})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(r={}))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,i){(function(e){!function(e,t){"use strict";function r(e,t){if(!e)throw new Error(t||"Assertion failed")}function n(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function a(e,t,i){if(a.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(i=t,t=10),this._init(e||0,t||10,i||"be"))}var s;"object"==typeof e?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;try{s=i(334).Buffer}catch(e){}function o(e,t,i){for(var r=0,n=Math.min(e.length,i),a=t;a<n;a++){var s=e.charCodeAt(a)-48;r<<=4,r|=s>=49&&s<=54?s-49+10:s>=17&&s<=22?s-17+10:15&s}return r}function l(e,t,i,r){for(var n=0,a=Math.min(e.length,i),s=t;s<a;s++){var o=e.charCodeAt(s)-48;n*=r,n+=o>=49?o-49+10:o>=17?o-17+10:o}return n}a.isBN=function(e){return e instanceof a||null!==e&&"object"==typeof e&&e.constructor.wordSize===a.wordSize&&Array.isArray(e.words)},a.max=function(e,t){return e.cmp(t)>0?e:t},a.min=function(e,t){return e.cmp(t)<0?e:t},a.prototype._init=function(e,t,i){if("number"==typeof e)return this._initNumber(e,t,i);if("object"==typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36);var n=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&n++,16===t?this._parseHex(e,n):this._parseBase(e,t,n),"-"===e[0]&&(this.negative=1),this.strip(),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(r(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initArray=function(e,t,i){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var a,s,o=0;if("be"===i)for(n=e.length-1,a=0;n>=0;n-=3)s=e[n]|e[n-1]<<8|e[n-2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);else if("le"===i)for(n=0,a=0;n<e.length;n+=3)s=e[n]|e[n+1]<<8|e[n+2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);return this.strip()},a.prototype._parseHex=function(e,t){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var r,n,a=0;for(i=e.length-6,r=0;i>=t;i-=6)n=o(e,i,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303,(a+=24)>=26&&(a-=26,r++);i+6!==t&&(n=o(e,t,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303),this.strip()},a.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var r=0,n=1;n<=67108863;n*=t)r++;r--,n=n/t|0;for(var a=e.length-i,s=a%r,o=Math.min(a,a-s)+i,d=0,h=i;h<o;h+=r)d=l(e,h,h+r,t),this.imuln(n),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d);if(0!==s){var c=1;for(d=l(e,h,e.length,t),h=0;h<s;h++)c*=t;this.imuln(c),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d)}},a.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},a.prototype.clone=function(){var e=new a(null);return this.copy(e),e},a.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},a.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],c=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function u(e,t,i){i.negative=t.negative^e.negative;var r=e.length+t.length|0;i.length=r,r=r-1|0;var n=0|e.words[0],a=0|t.words[0],s=n*a,o=67108863&s,l=s/67108864|0;i.words[0]=o;for(var d=1;d<r;d++){for(var h=l>>>26,c=67108863&l,u=Math.min(d,t.length-1),f=Math.max(0,d-e.length+1);f<=u;f++){var m=d-f|0;h+=(s=(n=0|e.words[m])*(a=0|t.words[f])+c)/67108864|0,c=67108863&s}i.words[d]=0|c,l=0|h}return 0!==l?i.words[d]=0|l:i.length--,i.strip()}a.prototype.toString=function(e,t){var i;if(t=0|t||1,16===(e=e||10)||"hex"===e){i="";for(var n=0,a=0,s=0;s<this.length;s++){var o=this.words[s],l=(16777215&(o<<n|a)).toString(16);i=0!=(a=o>>>24-n&16777215)||s!==this.length-1?d[6-l.length]+l+i:l+i,(n+=2)>=26&&(n-=26,s--)}for(0!==a&&(i=a.toString(16)+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var u=h[e],f=c[e];i="";var m=this.clone();for(m.negative=0;!m.isZero();){var p=m.modn(f).toString(e);i=(m=m.idivn(f)).isZero()?p+i:d[u-p.length]+p+i}for(this.isZero()&&(i="0"+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(e,t){return r(void 0!==s),this.toArrayLike(s,e,t)},a.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},a.prototype.toArrayLike=function(e,t,i){var n=this.byteLength(),a=i||Math.max(1,n);r(n<=a,"byte array longer than desired length"),r(a>0,"Requested array length <= 0"),this.strip();var s,o,l="le"===t,d=new e(a),h=this.clone();if(l){for(o=0;!h.isZero();o++)s=h.andln(255),h.iushrn(8),d[o]=s;for(;o<a;o++)d[o]=0}else{for(o=0;o<a-n;o++)d[o]=0;for(o=0;!h.isZero();o++)s=h.andln(255),h.iushrn(8),d[a-o-1]=s}return d},Math.clz32?a.prototype._countBits=function(e){return 32-Math.clz32(e)}:a.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},a.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return 0==(8191&t)&&(i+=13,t>>>=13),0==(127&t)&&(i+=7,t>>>=7),0==(15&t)&&(i+=4,t>>>=4),0==(3&t)&&(i+=2,t>>>=2),0==(1&t)&&i++,i},a.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},a.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return 0!==this.negative},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},a.prototype.ior=function(e){return r(0==(this.negative|e.negative)),this.iuor(e)},a.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},a.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},a.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this.strip()},a.prototype.iand=function(e){return r(0==(this.negative|e.negative)),this.iuand(e)},a.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},a.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},a.prototype.iuxor=function(e){var t,i;this.length>e.length?(t=this,i=e):(t=e,i=this);for(var r=0;r<i.length;r++)this.words[r]=t.words[r]^i.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this.strip()},a.prototype.ixor=function(e){return r(0==(this.negative|e.negative)),this.iuxor(e)},a.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},a.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},a.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var n=0;n<t;n++)this.words[n]=67108863&~this.words[n];return i>0&&(this.words[n]=~this.words[n]&67108863>>26-i),this.strip()},a.prototype.notn=function(e){return this.clone().inotn(e)},a.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var i=e/26|0,n=e%26;return this._expand(i+1),this.words[i]=t?this.words[i]|1<<n:this.words[i]&~(1<<n),this.strip()},a.prototype.iadd=function(e){var t,i,r;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,r=e):(i=e,r=this);for(var n=0,a=0;a<r.length;a++)t=(0|i.words[a])+(0|r.words[a])+n,this.words[a]=67108863&t,n=t>>>26;for(;0!==n&&a<i.length;a++)t=(0|i.words[a])+n,this.words[a]=67108863&t,n=t>>>26;if(this.length=i.length,0!==n)this.words[this.length]=n,this.length++;else if(i!==this)for(;a<i.length;a++)this.words[a]=i.words[a];return this},a.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},a.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var i,r,n=this.cmp(e);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(i=this,r=e):(i=e,r=this);for(var a=0,s=0;s<r.length;s++)a=(t=(0|i.words[s])-(0|r.words[s])+a)>>26,this.words[s]=67108863&t;for(;0!==a&&s<i.length;s++)a=(t=(0|i.words[s])+a)>>26,this.words[s]=67108863&t;if(0===a&&s<i.length&&i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this.length=Math.max(this.length,s),i!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(e){return this.clone().isub(e)};var f=function(e,t,i){var r,n,a,s=e.words,o=t.words,l=i.words,d=0,h=0|s[0],c=8191&h,u=h>>>13,f=0|s[1],m=8191&f,p=f>>>13,g=0|s[2],_=8191&g,v=g>>>13,y=0|s[3],b=8191&y,S=y>>>13,T=0|s[4],w=8191&T,M=T>>>13,C=0|s[5],I=8191&C,P=C>>>13,E=0|s[6],x=8191&E,A=E>>>13,k=0|s[7],R=8191&k,O=k>>>13,L=0|s[8],F=8191&L,D=L>>>13,B=0|s[9],N=8191&B,V=B>>>13,U=0|o[0],W=8191&U,z=U>>>13,G=0|o[1],j=8191&G,H=G>>>13,q=0|o[2],$=8191&q,Z=q>>>13,X=0|o[3],Y=8191&X,J=X>>>13,K=0|o[4],Q=8191&K,ee=K>>>13,te=0|o[5],ie=8191&te,re=te>>>13,ne=0|o[6],ae=8191&ne,se=ne>>>13,oe=0|o[7],le=8191&oe,de=oe>>>13,he=0|o[8],ce=8191&he,ue=he>>>13,fe=0|o[9],me=8191&fe,pe=fe>>>13;i.negative=e.negative^t.negative,i.length=19;var ge=(d+(r=Math.imul(c,W))|0)+((8191&(n=(n=Math.imul(c,z))+Math.imul(u,W)|0))<<13)|0;d=((a=Math.imul(u,z))+(n>>>13)|0)+(ge>>>26)|0,ge&=67108863,r=Math.imul(m,W),n=(n=Math.imul(m,z))+Math.imul(p,W)|0,a=Math.imul(p,z);var _e=(d+(r=r+Math.imul(c,j)|0)|0)+((8191&(n=(n=n+Math.imul(c,H)|0)+Math.imul(u,j)|0))<<13)|0;d=((a=a+Math.imul(u,H)|0)+(n>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(_,W),n=(n=Math.imul(_,z))+Math.imul(v,W)|0,a=Math.imul(v,z),r=r+Math.imul(m,j)|0,n=(n=n+Math.imul(m,H)|0)+Math.imul(p,j)|0,a=a+Math.imul(p,H)|0;var ve=(d+(r=r+Math.imul(c,$)|0)|0)+((8191&(n=(n=n+Math.imul(c,Z)|0)+Math.imul(u,$)|0))<<13)|0;d=((a=a+Math.imul(u,Z)|0)+(n>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(b,W),n=(n=Math.imul(b,z))+Math.imul(S,W)|0,a=Math.imul(S,z),r=r+Math.imul(_,j)|0,n=(n=n+Math.imul(_,H)|0)+Math.imul(v,j)|0,a=a+Math.imul(v,H)|0,r=r+Math.imul(m,$)|0,n=(n=n+Math.imul(m,Z)|0)+Math.imul(p,$)|0,a=a+Math.imul(p,Z)|0;var ye=(d+(r=r+Math.imul(c,Y)|0)|0)+((8191&(n=(n=n+Math.imul(c,J)|0)+Math.imul(u,Y)|0))<<13)|0;d=((a=a+Math.imul(u,J)|0)+(n>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(w,W),n=(n=Math.imul(w,z))+Math.imul(M,W)|0,a=Math.imul(M,z),r=r+Math.imul(b,j)|0,n=(n=n+Math.imul(b,H)|0)+Math.imul(S,j)|0,a=a+Math.imul(S,H)|0,r=r+Math.imul(_,$)|0,n=(n=n+Math.imul(_,Z)|0)+Math.imul(v,$)|0,a=a+Math.imul(v,Z)|0,r=r+Math.imul(m,Y)|0,n=(n=n+Math.imul(m,J)|0)+Math.imul(p,Y)|0,a=a+Math.imul(p,J)|0;var be=(d+(r=r+Math.imul(c,Q)|0)|0)+((8191&(n=(n=n+Math.imul(c,ee)|0)+Math.imul(u,Q)|0))<<13)|0;d=((a=a+Math.imul(u,ee)|0)+(n>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(I,W),n=(n=Math.imul(I,z))+Math.imul(P,W)|0,a=Math.imul(P,z),r=r+Math.imul(w,j)|0,n=(n=n+Math.imul(w,H)|0)+Math.imul(M,j)|0,a=a+Math.imul(M,H)|0,r=r+Math.imul(b,$)|0,n=(n=n+Math.imul(b,Z)|0)+Math.imul(S,$)|0,a=a+Math.imul(S,Z)|0,r=r+Math.imul(_,Y)|0,n=(n=n+Math.imul(_,J)|0)+Math.imul(v,Y)|0,a=a+Math.imul(v,J)|0,r=r+Math.imul(m,Q)|0,n=(n=n+Math.imul(m,ee)|0)+Math.imul(p,Q)|0,a=a+Math.imul(p,ee)|0;var Se=(d+(r=r+Math.imul(c,ie)|0)|0)+((8191&(n=(n=n+Math.imul(c,re)|0)+Math.imul(u,ie)|0))<<13)|0;d=((a=a+Math.imul(u,re)|0)+(n>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul(x,W),n=(n=Math.imul(x,z))+Math.imul(A,W)|0,a=Math.imul(A,z),r=r+Math.imul(I,j)|0,n=(n=n+Math.imul(I,H)|0)+Math.imul(P,j)|0,a=a+Math.imul(P,H)|0,r=r+Math.imul(w,$)|0,n=(n=n+Math.imul(w,Z)|0)+Math.imul(M,$)|0,a=a+Math.imul(M,Z)|0,r=r+Math.imul(b,Y)|0,n=(n=n+Math.imul(b,J)|0)+Math.imul(S,Y)|0,a=a+Math.imul(S,J)|0,r=r+Math.imul(_,Q)|0,n=(n=n+Math.imul(_,ee)|0)+Math.imul(v,Q)|0,a=a+Math.imul(v,ee)|0,r=r+Math.imul(m,ie)|0,n=(n=n+Math.imul(m,re)|0)+Math.imul(p,ie)|0,a=a+Math.imul(p,re)|0;var Te=(d+(r=r+Math.imul(c,ae)|0)|0)+((8191&(n=(n=n+Math.imul(c,se)|0)+Math.imul(u,ae)|0))<<13)|0;d=((a=a+Math.imul(u,se)|0)+(n>>>13)|0)+(Te>>>26)|0,Te&=67108863,r=Math.imul(R,W),n=(n=Math.imul(R,z))+Math.imul(O,W)|0,a=Math.imul(O,z),r=r+Math.imul(x,j)|0,n=(n=n+Math.imul(x,H)|0)+Math.imul(A,j)|0,a=a+Math.imul(A,H)|0,r=r+Math.imul(I,$)|0,n=(n=n+Math.imul(I,Z)|0)+Math.imul(P,$)|0,a=a+Math.imul(P,Z)|0,r=r+Math.imul(w,Y)|0,n=(n=n+Math.imul(w,J)|0)+Math.imul(M,Y)|0,a=a+Math.imul(M,J)|0,r=r+Math.imul(b,Q)|0,n=(n=n+Math.imul(b,ee)|0)+Math.imul(S,Q)|0,a=a+Math.imul(S,ee)|0,r=r+Math.imul(_,ie)|0,n=(n=n+Math.imul(_,re)|0)+Math.imul(v,ie)|0,a=a+Math.imul(v,re)|0,r=r+Math.imul(m,ae)|0,n=(n=n+Math.imul(m,se)|0)+Math.imul(p,ae)|0,a=a+Math.imul(p,se)|0;var we=(d+(r=r+Math.imul(c,le)|0)|0)+((8191&(n=(n=n+Math.imul(c,de)|0)+Math.imul(u,le)|0))<<13)|0;d=((a=a+Math.imul(u,de)|0)+(n>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(F,W),n=(n=Math.imul(F,z))+Math.imul(D,W)|0,a=Math.imul(D,z),r=r+Math.imul(R,j)|0,n=(n=n+Math.imul(R,H)|0)+Math.imul(O,j)|0,a=a+Math.imul(O,H)|0,r=r+Math.imul(x,$)|0,n=(n=n+Math.imul(x,Z)|0)+Math.imul(A,$)|0,a=a+Math.imul(A,Z)|0,r=r+Math.imul(I,Y)|0,n=(n=n+Math.imul(I,J)|0)+Math.imul(P,Y)|0,a=a+Math.imul(P,J)|0,r=r+Math.imul(w,Q)|0,n=(n=n+Math.imul(w,ee)|0)+Math.imul(M,Q)|0,a=a+Math.imul(M,ee)|0,r=r+Math.imul(b,ie)|0,n=(n=n+Math.imul(b,re)|0)+Math.imul(S,ie)|0,a=a+Math.imul(S,re)|0,r=r+Math.imul(_,ae)|0,n=(n=n+Math.imul(_,se)|0)+Math.imul(v,ae)|0,a=a+Math.imul(v,se)|0,r=r+Math.imul(m,le)|0,n=(n=n+Math.imul(m,de)|0)+Math.imul(p,le)|0,a=a+Math.imul(p,de)|0;var Me=(d+(r=r+Math.imul(c,ce)|0)|0)+((8191&(n=(n=n+Math.imul(c,ue)|0)+Math.imul(u,ce)|0))<<13)|0;d=((a=a+Math.imul(u,ue)|0)+(n>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul(N,W),n=(n=Math.imul(N,z))+Math.imul(V,W)|0,a=Math.imul(V,z),r=r+Math.imul(F,j)|0,n=(n=n+Math.imul(F,H)|0)+Math.imul(D,j)|0,a=a+Math.imul(D,H)|0,r=r+Math.imul(R,$)|0,n=(n=n+Math.imul(R,Z)|0)+Math.imul(O,$)|0,a=a+Math.imul(O,Z)|0,r=r+Math.imul(x,Y)|0,n=(n=n+Math.imul(x,J)|0)+Math.imul(A,Y)|0,a=a+Math.imul(A,J)|0,r=r+Math.imul(I,Q)|0,n=(n=n+Math.imul(I,ee)|0)+Math.imul(P,Q)|0,a=a+Math.imul(P,ee)|0,r=r+Math.imul(w,ie)|0,n=(n=n+Math.imul(w,re)|0)+Math.imul(M,ie)|0,a=a+Math.imul(M,re)|0,r=r+Math.imul(b,ae)|0,n=(n=n+Math.imul(b,se)|0)+Math.imul(S,ae)|0,a=a+Math.imul(S,se)|0,r=r+Math.imul(_,le)|0,n=(n=n+Math.imul(_,de)|0)+Math.imul(v,le)|0,a=a+Math.imul(v,de)|0,r=r+Math.imul(m,ce)|0,n=(n=n+Math.imul(m,ue)|0)+Math.imul(p,ce)|0,a=a+Math.imul(p,ue)|0;var Ce=(d+(r=r+Math.imul(c,me)|0)|0)+((8191&(n=(n=n+Math.imul(c,pe)|0)+Math.imul(u,me)|0))<<13)|0;d=((a=a+Math.imul(u,pe)|0)+(n>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,r=Math.imul(N,j),n=(n=Math.imul(N,H))+Math.imul(V,j)|0,a=Math.imul(V,H),r=r+Math.imul(F,$)|0,n=(n=n+Math.imul(F,Z)|0)+Math.imul(D,$)|0,a=a+Math.imul(D,Z)|0,r=r+Math.imul(R,Y)|0,n=(n=n+Math.imul(R,J)|0)+Math.imul(O,Y)|0,a=a+Math.imul(O,J)|0,r=r+Math.imul(x,Q)|0,n=(n=n+Math.imul(x,ee)|0)+Math.imul(A,Q)|0,a=a+Math.imul(A,ee)|0,r=r+Math.imul(I,ie)|0,n=(n=n+Math.imul(I,re)|0)+Math.imul(P,ie)|0,a=a+Math.imul(P,re)|0,r=r+Math.imul(w,ae)|0,n=(n=n+Math.imul(w,se)|0)+Math.imul(M,ae)|0,a=a+Math.imul(M,se)|0,r=r+Math.imul(b,le)|0,n=(n=n+Math.imul(b,de)|0)+Math.imul(S,le)|0,a=a+Math.imul(S,de)|0,r=r+Math.imul(_,ce)|0,n=(n=n+Math.imul(_,ue)|0)+Math.imul(v,ce)|0,a=a+Math.imul(v,ue)|0;var Ie=(d+(r=r+Math.imul(m,me)|0)|0)+((8191&(n=(n=n+Math.imul(m,pe)|0)+Math.imul(p,me)|0))<<13)|0;d=((a=a+Math.imul(p,pe)|0)+(n>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,r=Math.imul(N,$),n=(n=Math.imul(N,Z))+Math.imul(V,$)|0,a=Math.imul(V,Z),r=r+Math.imul(F,Y)|0,n=(n=n+Math.imul(F,J)|0)+Math.imul(D,Y)|0,a=a+Math.imul(D,J)|0,r=r+Math.imul(R,Q)|0,n=(n=n+Math.imul(R,ee)|0)+Math.imul(O,Q)|0,a=a+Math.imul(O,ee)|0,r=r+Math.imul(x,ie)|0,n=(n=n+Math.imul(x,re)|0)+Math.imul(A,ie)|0,a=a+Math.imul(A,re)|0,r=r+Math.imul(I,ae)|0,n=(n=n+Math.imul(I,se)|0)+Math.imul(P,ae)|0,a=a+Math.imul(P,se)|0,r=r+Math.imul(w,le)|0,n=(n=n+Math.imul(w,de)|0)+Math.imul(M,le)|0,a=a+Math.imul(M,de)|0,r=r+Math.imul(b,ce)|0,n=(n=n+Math.imul(b,ue)|0)+Math.imul(S,ce)|0,a=a+Math.imul(S,ue)|0;var Pe=(d+(r=r+Math.imul(_,me)|0)|0)+((8191&(n=(n=n+Math.imul(_,pe)|0)+Math.imul(v,me)|0))<<13)|0;d=((a=a+Math.imul(v,pe)|0)+(n>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,r=Math.imul(N,Y),n=(n=Math.imul(N,J))+Math.imul(V,Y)|0,a=Math.imul(V,J),r=r+Math.imul(F,Q)|0,n=(n=n+Math.imul(F,ee)|0)+Math.imul(D,Q)|0,a=a+Math.imul(D,ee)|0,r=r+Math.imul(R,ie)|0,n=(n=n+Math.imul(R,re)|0)+Math.imul(O,ie)|0,a=a+Math.imul(O,re)|0,r=r+Math.imul(x,ae)|0,n=(n=n+Math.imul(x,se)|0)+Math.imul(A,ae)|0,a=a+Math.imul(A,se)|0,r=r+Math.imul(I,le)|0,n=(n=n+Math.imul(I,de)|0)+Math.imul(P,le)|0,a=a+Math.imul(P,de)|0,r=r+Math.imul(w,ce)|0,n=(n=n+Math.imul(w,ue)|0)+Math.imul(M,ce)|0,a=a+Math.imul(M,ue)|0;var Ee=(d+(r=r+Math.imul(b,me)|0)|0)+((8191&(n=(n=n+Math.imul(b,pe)|0)+Math.imul(S,me)|0))<<13)|0;d=((a=a+Math.imul(S,pe)|0)+(n>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(N,Q),n=(n=Math.imul(N,ee))+Math.imul(V,Q)|0,a=Math.imul(V,ee),r=r+Math.imul(F,ie)|0,n=(n=n+Math.imul(F,re)|0)+Math.imul(D,ie)|0,a=a+Math.imul(D,re)|0,r=r+Math.imul(R,ae)|0,n=(n=n+Math.imul(R,se)|0)+Math.imul(O,ae)|0,a=a+Math.imul(O,se)|0,r=r+Math.imul(x,le)|0,n=(n=n+Math.imul(x,de)|0)+Math.imul(A,le)|0,a=a+Math.imul(A,de)|0,r=r+Math.imul(I,ce)|0,n=(n=n+Math.imul(I,ue)|0)+Math.imul(P,ce)|0,a=a+Math.imul(P,ue)|0;var xe=(d+(r=r+Math.imul(w,me)|0)|0)+((8191&(n=(n=n+Math.imul(w,pe)|0)+Math.imul(M,me)|0))<<13)|0;d=((a=a+Math.imul(M,pe)|0)+(n>>>13)|0)+(xe>>>26)|0,xe&=67108863,r=Math.imul(N,ie),n=(n=Math.imul(N,re))+Math.imul(V,ie)|0,a=Math.imul(V,re),r=r+Math.imul(F,ae)|0,n=(n=n+Math.imul(F,se)|0)+Math.imul(D,ae)|0,a=a+Math.imul(D,se)|0,r=r+Math.imul(R,le)|0,n=(n=n+Math.imul(R,de)|0)+Math.imul(O,le)|0,a=a+Math.imul(O,de)|0,r=r+Math.imul(x,ce)|0,n=(n=n+Math.imul(x,ue)|0)+Math.imul(A,ce)|0,a=a+Math.imul(A,ue)|0;var Ae=(d+(r=r+Math.imul(I,me)|0)|0)+((8191&(n=(n=n+Math.imul(I,pe)|0)+Math.imul(P,me)|0))<<13)|0;d=((a=a+Math.imul(P,pe)|0)+(n>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,r=Math.imul(N,ae),n=(n=Math.imul(N,se))+Math.imul(V,ae)|0,a=Math.imul(V,se),r=r+Math.imul(F,le)|0,n=(n=n+Math.imul(F,de)|0)+Math.imul(D,le)|0,a=a+Math.imul(D,de)|0,r=r+Math.imul(R,ce)|0,n=(n=n+Math.imul(R,ue)|0)+Math.imul(O,ce)|0,a=a+Math.imul(O,ue)|0;var ke=(d+(r=r+Math.imul(x,me)|0)|0)+((8191&(n=(n=n+Math.imul(x,pe)|0)+Math.imul(A,me)|0))<<13)|0;d=((a=a+Math.imul(A,pe)|0)+(n>>>13)|0)+(ke>>>26)|0,ke&=67108863,r=Math.imul(N,le),n=(n=Math.imul(N,de))+Math.imul(V,le)|0,a=Math.imul(V,de),r=r+Math.imul(F,ce)|0,n=(n=n+Math.imul(F,ue)|0)+Math.imul(D,ce)|0,a=a+Math.imul(D,ue)|0;var Re=(d+(r=r+Math.imul(R,me)|0)|0)+((8191&(n=(n=n+Math.imul(R,pe)|0)+Math.imul(O,me)|0))<<13)|0;d=((a=a+Math.imul(O,pe)|0)+(n>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul(N,ce),n=(n=Math.imul(N,ue))+Math.imul(V,ce)|0,a=Math.imul(V,ue);var Oe=(d+(r=r+Math.imul(F,me)|0)|0)+((8191&(n=(n=n+Math.imul(F,pe)|0)+Math.imul(D,me)|0))<<13)|0;d=((a=a+Math.imul(D,pe)|0)+(n>>>13)|0)+(Oe>>>26)|0,Oe&=67108863;var Le=(d+(r=Math.imul(N,me))|0)+((8191&(n=(n=Math.imul(N,pe))+Math.imul(V,me)|0))<<13)|0;return d=((a=Math.imul(V,pe))+(n>>>13)|0)+(Le>>>26)|0,Le&=67108863,l[0]=ge,l[1]=_e,l[2]=ve,l[3]=ye,l[4]=be,l[5]=Se,l[6]=Te,l[7]=we,l[8]=Me,l[9]=Ce,l[10]=Ie,l[11]=Pe,l[12]=Ee,l[13]=xe,l[14]=Ae,l[15]=ke,l[16]=Re,l[17]=Oe,l[18]=Le,0!==d&&(l[19]=d,i.length++),i};function m(e,t,i){return(new p).mulp(e,t,i)}function p(e,t){this.x=e,this.y=t}Math.imul||(f=u),a.prototype.mulTo=function(e,t){var i=this.length+e.length;return 10===this.length&&10===e.length?f(this,e,t):i<63?u(this,e,t):i<1024?function(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var r=0,n=0,a=0;a<i.length-1;a++){var s=n;n=0;for(var o=67108863&r,l=Math.min(a,t.length-1),d=Math.max(0,a-e.length+1);d<=l;d++){var h=a-d,c=(0|e.words[h])*(0|t.words[d]),u=67108863&c;o=67108863&(u=u+o|0),n+=(s=(s=s+(c/67108864|0)|0)+(u>>>26)|0)>>>26,s&=67108863}i.words[a]=o,r=s,s=n}return 0!==r?i.words[a]=r:i.length--,i.strip()}(this,e,t):m(this,e,t)},p.prototype.makeRBT=function(e){for(var t=new Array(e),i=a.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,i,e);return t},p.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var r=0,n=0;n<t;n++)r|=(1&e)<<t-n-1,e>>=1;return r},p.prototype.permute=function(e,t,i,r,n,a){for(var s=0;s<a;s++)r[s]=t[e[s]],n[s]=i[e[s]]},p.prototype.transform=function(e,t,i,r,n,a){this.permute(a,e,t,i,r,n);for(var s=1;s<n;s<<=1)for(var o=s<<1,l=Math.cos(2*Math.PI/o),d=Math.sin(2*Math.PI/o),h=0;h<n;h+=o)for(var c=l,u=d,f=0;f<s;f++){var m=i[h+f],p=r[h+f],g=i[h+f+s],_=r[h+f+s],v=c*g-u*_;_=c*_+u*g,g=v,i[h+f]=m+g,r[h+f]=p+_,i[h+f+s]=m-g,r[h+f+s]=p-_,f!==o&&(v=l*c-d*u,u=l*u+d*c,c=v)}},p.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),r=1&i,n=0;for(i=i/2|0;i;i>>>=1)n++;return 1<<n+1+r},p.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var r=0;r<i/2;r++){var n=e[r];e[r]=e[i-r-1],e[i-r-1]=n,n=t[r],t[r]=-t[i-r-1],t[i-r-1]=-n}},p.prototype.normalize13b=function(e,t){for(var i=0,r=0;r<t/2;r++){var n=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+i;e[r]=67108863&n,i=n<67108864?0:n/67108864|0}return e},p.prototype.convert13b=function(e,t,i,n){for(var a=0,s=0;s<t;s++)a+=0|e[s],i[2*s]=8191&a,a>>>=13,i[2*s+1]=8191&a,a>>>=13;for(s=2*t;s<n;++s)i[s]=0;r(0===a),r(0==(-8192&a))},p.prototype.stub=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0;return t},p.prototype.mulp=function(e,t,i){var r=2*this.guessLen13b(e.length,t.length),n=this.makeRBT(r),a=this.stub(r),s=new Array(r),o=new Array(r),l=new Array(r),d=new Array(r),h=new Array(r),c=new Array(r),u=i.words;u.length=r,this.convert13b(e.words,e.length,s,r),this.convert13b(t.words,t.length,d,r),this.transform(s,a,o,l,r,n),this.transform(d,a,h,c,r,n);for(var f=0;f<r;f++){var m=o[f]*h[f]-l[f]*c[f];l[f]=o[f]*c[f]+l[f]*h[f],o[f]=m}return this.conjugate(o,l,r),this.transform(o,l,u,a,r,n),this.conjugate(u,a,r),this.normalize13b(u,r),i.negative=e.negative^t.negative,i.length=e.length+t.length,i.strip()},a.prototype.mul=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},a.prototype.mulf=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),m(this,e,t)},a.prototype.imul=function(e){return this.clone().mulTo(e,this)},a.prototype.imuln=function(e){r("number"==typeof e),r(e<67108864);for(var t=0,i=0;i<this.length;i++){var n=(0|this.words[i])*e,a=(67108863&n)+(67108863&t);t>>=26,t+=n/67108864|0,t+=a>>>26,this.words[i]=67108863&a}return 0!==t&&(this.words[i]=t,this.length++),this},a.prototype.muln=function(e){return this.clone().imuln(e)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),i=0;i<t.length;i++){var r=i/26|0,n=i%26;t[i]=(e.words[r]&1<<n)>>>n}return t}(e);if(0===t.length)return new a(1);for(var i=this,r=0;r<t.length&&0===t[r];r++,i=i.sqr());if(++r<t.length)for(var n=i.sqr();r<t.length;r++,n=n.sqr())0!==t[r]&&(i=i.mul(n));return i},a.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,i=e%26,n=(e-i)/26,a=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(t=0;t<this.length;t++){var o=this.words[t]&a,l=(0|this.words[t])-o<<i;this.words[t]=l|s,s=o>>>26-i}s&&(this.words[t]=s,this.length++)}if(0!==n){for(t=this.length-1;t>=0;t--)this.words[t+n]=this.words[t];for(t=0;t<n;t++)this.words[t]=0;this.length+=n}return this.strip()},a.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},a.prototype.iushrn=function(e,t,i){var n;r("number"==typeof e&&e>=0),n=t?(t-t%26)/26:0;var a=e%26,s=Math.min((e-a)/26,this.length),o=67108863^67108863>>>a<<a,l=i;if(n-=s,n=Math.max(0,n),l){for(var d=0;d<s;d++)l.words[d]=this.words[d];l.length=s}if(0===s);else if(this.length>s)for(this.length-=s,d=0;d<this.length;d++)this.words[d]=this.words[d+s];else this.words[0]=0,this.length=1;var h=0;for(d=this.length-1;d>=0&&(0!==h||d>=n);d--){var c=0|this.words[d];this.words[d]=h<<26-a|c>>>a,h=c&o}return l&&0!==h&&(l.words[l.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(e,t,i){return r(0===this.negative),this.iushrn(e,t,i)},a.prototype.shln=function(e){return this.clone().ishln(e)},a.prototype.ushln=function(e){return this.clone().iushln(e)},a.prototype.shrn=function(e){return this.clone().ishrn(e)},a.prototype.ushrn=function(e){return this.clone().iushrn(e)},a.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26,n=1<<t;return!(this.length<=i||!(this.words[i]&n))},a.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==t&&i++,this.length=Math.min(i,this.length),0!==t){var n=67108863^67108863>>>t<<t;this.words[this.length-1]&=n}return this.strip()},a.prototype.maskn=function(e){return this.clone().imaskn(e)},a.prototype.iaddn=function(e){return r("number"==typeof e),r(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},a.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},a.prototype.isubn=function(e){if(r("number"==typeof e),r(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},a.prototype.addn=function(e){return this.clone().iaddn(e)},a.prototype.subn=function(e){return this.clone().isubn(e)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(e,t,i){var n,a,s=e.length+i;this._expand(s);var o=0;for(n=0;n<e.length;n++){a=(0|this.words[n+i])+o;var l=(0|e.words[n])*t;o=((a-=67108863&l)>>26)-(l/67108864|0),this.words[n+i]=67108863&a}for(;n<this.length-i;n++)o=(a=(0|this.words[n+i])+o)>>26,this.words[n+i]=67108863&a;if(0===o)return this.strip();for(r(-1===o),o=0,n=0;n<this.length;n++)o=(a=-(0|this.words[n])+o)>>26,this.words[n]=67108863&a;return this.negative=1,this.strip()},a.prototype._wordDiv=function(e,t){var i=(this.length,e.length),r=this.clone(),n=e,s=0|n.words[n.length-1];0!=(i=26-this._countBits(s))&&(n=n.ushln(i),r.iushln(i),s=0|n.words[n.length-1]);var o,l=r.length-n.length;if("mod"!==t){(o=new a(null)).length=l+1,o.words=new Array(o.length);for(var d=0;d<o.length;d++)o.words[d]=0}var h=r.clone()._ishlnsubmul(n,1,l);0===h.negative&&(r=h,o&&(o.words[l]=1));for(var c=l-1;c>=0;c--){var u=67108864*(0|r.words[n.length+c])+(0|r.words[n.length+c-1]);for(u=Math.min(u/s|0,67108863),r._ishlnsubmul(n,u,c);0!==r.negative;)u--,r.negative=0,r._ishlnsubmul(n,1,c),r.isZero()||(r.negative^=1);o&&(o.words[c]=u)}return o&&o.strip(),r.strip(),"div"!==t&&0!==i&&r.iushrn(i),{div:o||null,mod:r}},a.prototype.divmod=function(e,t,i){return r(!e.isZero()),this.isZero()?{div:new a(0),mod:new a(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(n=o.div.neg()),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.iadd(e)),{div:n,mod:s}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(n=o.div.neg()),{div:n,mod:o.mod}):0!=(this.negative&e.negative)?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.isub(e)),{div:o.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new a(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new a(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new a(this.modn(e.words[0]))}:this._wordDiv(e,t);var n,s,o},a.prototype.div=function(e){return this.divmod(e,"div",!1).div},a.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},a.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},a.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),n=e.andln(1),a=i.cmp(r);return a<0||1===n&&0===a?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},a.prototype.modn=function(e){r(e<=67108863);for(var t=(1<<26)%e,i=0,n=this.length-1;n>=0;n--)i=(t*i+(0|this.words[n]))%e;return i},a.prototype.idivn=function(e){r(e<=67108863);for(var t=0,i=this.length-1;i>=0;i--){var n=(0|this.words[i])+67108864*t;this.words[i]=n/e|0,t=n%e}return this.strip()},a.prototype.divn=function(e){return this.clone().idivn(e)},a.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n=new a(1),s=new a(0),o=new a(0),l=new a(1),d=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++d;for(var h=i.clone(),c=t.clone();!t.isZero();){for(var u=0,f=1;0==(t.words[0]&f)&&u<26;++u,f<<=1);if(u>0)for(t.iushrn(u);u-- >0;)(n.isOdd()||s.isOdd())&&(n.iadd(h),s.isub(c)),n.iushrn(1),s.iushrn(1);for(var m=0,p=1;0==(i.words[0]&p)&&m<26;++m,p<<=1);if(m>0)for(i.iushrn(m);m-- >0;)(o.isOdd()||l.isOdd())&&(o.iadd(h),l.isub(c)),o.iushrn(1),l.iushrn(1);t.cmp(i)>=0?(t.isub(i),n.isub(o),s.isub(l)):(i.isub(t),o.isub(n),l.isub(s))}return{a:o,b:l,gcd:i.iushln(d)}},a.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n,s=new a(1),o=new a(0),l=i.clone();t.cmpn(1)>0&&i.cmpn(1)>0;){for(var d=0,h=1;0==(t.words[0]&h)&&d<26;++d,h<<=1);if(d>0)for(t.iushrn(d);d-- >0;)s.isOdd()&&s.iadd(l),s.iushrn(1);for(var c=0,u=1;0==(i.words[0]&u)&&c<26;++c,u<<=1);if(c>0)for(i.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(l),o.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(o)):(i.isub(t),o.isub(s))}return(n=0===t.cmpn(1)?s:o).cmpn(0)<0&&n.iadd(e),n},a.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var r=0;t.isEven()&&i.isEven();r++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var n=t.cmp(i);if(n<0){var a=t;t=i,i=a}else if(0===n||0===i.cmpn(1))break;t.isub(i)}return i.iushln(r)},a.prototype.invm=function(e){return this.egcd(e).a.umod(e)},a.prototype.isEven=function(){return 0==(1&this.words[0])},a.prototype.isOdd=function(){return 1==(1&this.words[0])},a.prototype.andln=function(e){return this.words[0]&e},a.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,i=(e-t)/26,n=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=n,this;for(var a=n,s=i;0!==a&&s<this.length;s++){var o=0|this.words[s];a=(o+=a)>>>26,o&=67108863,this.words[s]=o}return 0!==a&&(this.words[s]=a,this.length++),this},a.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},a.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)t=1;else{i&&(e=-e),r(e<=67108863,"Number is too big");var n=0|this.words[0];t=n===e?0:n<e?-1:1}return 0!==this.negative?0|-t:t},a.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},a.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,i=this.length-1;i>=0;i--){var r=0|this.words[i],n=0|e.words[i];if(r!==n){r<n?t=-1:r>n&&(t=1);break}}return t},a.prototype.gtn=function(e){return 1===this.cmpn(e)},a.prototype.gt=function(e){return 1===this.cmp(e)},a.prototype.gten=function(e){return this.cmpn(e)>=0},a.prototype.gte=function(e){return this.cmp(e)>=0},a.prototype.ltn=function(e){return-1===this.cmpn(e)},a.prototype.lt=function(e){return-1===this.cmp(e)},a.prototype.lten=function(e){return this.cmpn(e)<=0},a.prototype.lte=function(e){return this.cmp(e)<=0},a.prototype.eqn=function(e){return 0===this.cmpn(e)},a.prototype.eq=function(e){return 0===this.cmp(e)},a.red=function(e){return new T(e)},a.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},a.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(e){return this.red=e,this},a.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},a.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},a.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},a.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},a.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},a.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},a.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},a.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},a.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function _(e,t){this.name=e,this.p=new a(t,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function y(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function b(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function S(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function T(e){if("string"==typeof e){var t=a._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function w(e){T.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var e=new a(null);return e.words=new Array(Math.ceil(this.n/13)),e},_.prototype.ireduce=function(e){var t,i=e;do{this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(t>this.n);var r=t<this.n?-1:i.ucmp(this.p);return 0===r?(i.words[0]=0,i.length=1):r>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},_.prototype.split=function(e,t){e.iushrn(this.n,0,t)},_.prototype.imulK=function(e){return e.imul(this.k)},n(v,_),v.prototype.split=function(e,t){for(var i=Math.min(e.length,9),r=0;r<i;r++)t.words[r]=e.words[r];if(t.length=i,e.length<=9)return e.words[0]=0,void(e.length=1);var n=e.words[9];for(t.words[t.length++]=4194303&n,r=10;r<e.length;r++){var a=0|e.words[r];e.words[r-10]=(4194303&a)<<4|n>>>22,n=a}n>>>=22,e.words[r-10]=n,0===n&&e.length>10?e.length-=10:e.length-=9},v.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var r=0|e.words[i];t+=977*r,e.words[i]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},n(y,_),n(b,_),n(S,_),S.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var r=19*(0|e.words[i])+t,n=67108863&r;r>>>=26,e.words[i]=n,t=r}return 0!==t&&(e.words[e.length++]=t),e},a._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new v;else if("p224"===e)t=new y;else if("p192"===e)t=new b;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new S}return g[e]=t,t},T.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},T.prototype._verify2=function(e,t){r(0==(e.negative|t.negative),"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},T.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},T.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},T.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},T.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},T.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},T.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i},T.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},T.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},T.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},T.prototype.isqr=function(e){return this.imul(e,e.clone())},T.prototype.sqr=function(e){return this.mul(e,e)},T.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var i=this.m.add(new a(1)).iushrn(2);return this.pow(e,i)}for(var n=this.m.subn(1),s=0;!n.isZero()&&0===n.andln(1);)s++,n.iushrn(1);r(!n.isZero());var o=new a(1).toRed(this),l=o.redNeg(),d=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new a(2*h*h).toRed(this);0!==this.pow(h,d).cmp(l);)h.redIAdd(l);for(var c=this.pow(h,n),u=this.pow(e,n.addn(1).iushrn(1)),f=this.pow(e,n),m=s;0!==f.cmp(o);){for(var p=f,g=0;0!==p.cmp(o);g++)p=p.redSqr();r(g<m);var _=this.pow(c,new a(1).iushln(m-g-1));u=u.redMul(_),c=_.redSqr(),f=f.redMul(c),m=g}return u},T.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},T.prototype.pow=function(e,t){if(t.isZero())return new a(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=new Array(16);i[0]=new a(1).toRed(this),i[1]=e;for(var r=2;r<i.length;r++)i[r]=this.mul(i[r-1],e);var n=i[0],s=0,o=0,l=t.bitLength()%26;for(0===l&&(l=26),r=t.length-1;r>=0;r--){for(var d=t.words[r],h=l-1;h>=0;h--){var c=d>>h&1;n!==i[0]&&(n=this.sqr(n)),0!==c||0!==s?(s<<=1,s|=c,(4==++o||0===r&&0===h)&&(n=this.mul(n,i[s]),o=0,s=0)):o=0}l=26}return n},T.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},T.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},a.mont=function(e){return new w(e)},n(w,T),w.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},w.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},w.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),a=n;return n.cmp(this.m)>=0?a=n.isub(this.m):n.cmpn(0)<0&&(a=n.iadd(this.m)),a._forceRed(this)},w.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new a(0)._forceRed(this);var i=e.mul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},w.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,i(83)(e))},function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(4),n=i(2),a=i(3),s=i(21),o=i(23),l=i(12),d=i(6),h=i(1),c=i(38),u=i(10),f=i(63);class m{static getDataFromSlideInfoAndImages(e,t,i){if(e.SlideShowInfo){const o=e.SlideShowInfo,p=o.sld[0];let g;if(p.bg.Item.hasOwnProperty("imgID")){let e=p.bg.Item;g={imageFill:{imgID:e.imgID,rect:{left:e.x,top:e.y,right:e.x+e.w,bottom:e.y+e.h}},solidFill:void 0}}else{let e=p.bg.Item;g={imageFill:void 0,solidFill:{r:e.clr[0],g:e.clr[1],b:e.clr[2],t:e.transp}}}let _=[],v=void 0,y=void 0;h.Settings.readBooleanOrDefault("enableAddinViewElement",!1)&&p.appLst&&p.appLst.length>0&&(p.appLst.forEach(e=>{const t=c.AppForOfficeLoader.createAppForOfficeByOsfExtensibleDataObject(e);t&&_.push(t)}),p.appThm&&(v=c.AppForOfficeLoader.readAppForOfficeTheme(p.appThm)),y=_.length>0);const b=[],S=(e,t)=>e.slideId.sid===t.slideId.sid&&e.shapeId===t.shapeId;if(h.Settings.readBooleanOrDefault("backfillMissingSpId",!1))for(const t of p.spLst){let i=651231861351;for(;p.spLst.some(e=>e.spId&&e.spId.spId===i);)i+=1;t.spId||(r.a.sendTraceTag(509117653,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"Backfilling missing spId for shape"),t.spId={sldId:e.ID.sid,spId:i})}const T=[];for(const e of p.spLst){const t={slideId:{sid:e.spId.sldId,cid:0},shapeId:e.spId.spId};T.some(e=>S(t,e))||T.push(t)}const w=T.map(e=>({id:e}));m.adjustMediaAnimations(p);let M=!1;for(const t of T){let i=null;if(p.sbLst){const e=p.sbLst.filter(e=>e.spId.sldId===t.slideId.sid&&e.spId.spId===t.shapeId);e.length>0&&(i=e[0].sb)}i||M||(l.VetoUtils.recordVeto("ContentFallback",{slideId:p.id,ShapeId:t.shapeId,errorName:"ShapeBuilderNotSupportedForShape",qosVeto:"ContentFallback",isIntentional:!0}),d.ChangeGate.isChangeGateEnabled("SSC.ReduceVetoVolumeForSB")&&(M=!0));const o=p.spLst?p.spLst.filter(e=>S(t,{slideId:{sid:e.spId.sldId,cid:0},shapeId:e.spId.spId})):[],c=[],u=[];let f,g,y,T,w=!1;for(const l of o){l.bgSp&&(w=!0);const o=[],d=(e,t)=>({region:{imgID:e.imgID,rect:{left:e.x,top:e.y,right:e.x+e.w,bottom:e.y+e.h}},pos:new s.b(t.x,t.y)}),_=l.bapis||[];if(i&&l.smlprts){const e=l.smlprts,i=2===e.by?0:1===e.by?1:2;let r,n=d(l.reg,l.pos);l.children&&(r=l.children.map(e=>d(e.reg,e.pos)));const a={begin:e.trBegin,length:e.trLength,type:1===e.trType?1:0};o.push({fShape:!!e.fSp,fText:!!e.fTx,bigParts:_,regionPos:n,childrenRegionPos:r,splitBy:i,textRange:a,shapeId:t})}else if(i)o.push({fShape:!0,fText:!0,bigParts:_,regionPos:d(l.reg,l.pos),splitBy:2,shapeId:t});else if(l.children)for(const[e,i]of l.children.entries())o.push({fShape:!0,fText:!0,bigParts:[`${l.id}c${e}`],regionPos:d(i.reg,i.pos),splitBy:2,shapeId:t});else o.push({fShape:!0,fText:!0,bigParts:[l.id.toString()],regionPos:d(l.reg,l.pos),splitBy:2,shapeId:t});const v=l.id.toString();if(c.push({id:v,parts:o}),l.clckTgts){const e=new Map;for(const t of l.clckTgts)if("CT_Hyperlink:#p"===t.__type){const i=JSON.stringify({tip:t.tip,url:t.url});e.has(i)?e.get(i).push(t):e.set(i,[t])}else if("CT_Action:#p"===t.__type)u.push({action:{region:{left:t.rct.l,right:t.rct.l+t.rct.w,top:t.rct.t,bottom:t.rct.t+t.rct.h},slideId:{sid:t.sldId,cid:0},animatableContentId:v}});else if("CT_InteractiveAnimUse:#p"===t.__type)u.push({animation:{region:{left:t.rct.l,right:t.rct.l+t.rct.w,top:t.rct.t,bottom:t.rct.t+t.rct.h},sequenceId:t.seqId,animatableContentId:v}});else if("CT_MediaCtrl:#p"===t.__type)u.push({mediaCtrl:{region:{left:t.rct.l,right:t.rct.l+t.rct.w,top:t.rct.t,bottom:t.rct.t+t.rct.h},elemId:t.elemId,animatableContentId:v}});else if(h.Settings.readBooleanOrDefault("enableSummaryZoom",!1)&&"CT_SlideSectionSummaryZoom:#p"===t.__type)if(r.a.sendTraceTag(522311768,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,"Summary Zoom detected in Parser"),0===t.zmType)for(let e of t.zmObj)u.push({zoom:{type:1,region:{left:e.rct.l,right:e.rct.l+e.rct.w,top:e.rct.t,bottom:e.rct.t+e.rct.h},sectionId:e.sctnId,transitionTime:e.transDur,returnToParent:e.rtn,animatableContentId:v}});else 2===t.zmType?u.push({zoom:{type:0,region:{left:t.zmObj[0].rct.l,right:t.zmObj[0].rct.l+t.zmObj[0].rct.w,top:t.zmObj[0].rct.t,bottom:t.zmObj[0].rct.t+t.zmObj[0].rct.h},slideId:{sid:t.zmObj[0].sldId,cid:0},transitionTime:t.zmObj[0].transDur,returnToParent:t.zmObj[0].rtn,animatableContentId:v}}):1===t.zmType&&u.push({zoom:{type:1,region:{left:t.zmObj[0].rct.l,right:t.zmObj[0].rct.l+t.zmObj[0].rct.w,top:t.zmObj[0].rct.t,bottom:t.zmObj[0].rct.t+t.zmObj[0].rct.h},sectionId:t.zmObj[0].sctnId,transitionTime:t.zmObj[0].transDur,returnToParent:t.zmObj[0].rtn,animatableContentId:v}});for(const t of e.values()){if(0===t.length)continue;let e={left:t[0].rct.l,right:t[0].rct.l+t[0].rct.w,top:t[0].rct.t,bottom:t[0].rct.t+t[0].rct.h};const i=[];for(const r of t){const t={left:r.rct.l,right:r.rct.l+r.rct.w,top:r.rct.t,bottom:r.rct.t+r.rct.h};i.push(t),e.left=Math.min(t.left,e.left),e.top=Math.min(t.top,e.top),e.right=Math.max(t.right,e.right),e.bottom=Math.max(t.bottom,e.bottom)}u.push({hyperlink:{region:e,subRegions:i,url:t[0].url,tip:t[0].tip,desc:t[0].desc,animatableContentId:v}})}}f||(f=m.readMedia(l.media,t,e.AccessibilityModel)),!g&&l.reg.isGif&&(g=m.readGif(e.MediaUrls,p.resCat,l.reg.imgID)),y||(y=m.readCameo(l.lf))}T||(T=_.find(e=>e.Shape.Id===t.shapeId));const C={shapeId:t,isBackground:w,animatableContents:c,shapeBuilderData:i,clickTargets:u,media:f,gif:g,cameo:y,appForOffice:T,appForOfficeTheme:v};b.push(C)}let C=m.parseResCat(p);C=C.map(e=>{const t=i.get(e.id);return!e.url&&t?t:e});try{const e=u.a.performanceNowTrimmed(),t=C.filter(e=>!m.isShapebuilderImage(e)),i=C.filter(e=>m.isShapebuilderImage(e)),s=h.Settings.readBooleanOrDefault("logPayloadBreakdownExpensiveChecks",!1),l={ExpensiveChecks:s,SlideInfoSize:s?JSON.stringify(o).length:0,SBDataSize:p.sbLst?JSON.stringify(p.sbLst).length:0,GlyphDataSize:p.glyps?JSON.stringify(p.glyps).length:0,FallbackImagesSize:t.reduce((e,t)=>e+t.byteCount,0),SBImageDataSize:i.reduce((e,t)=>e+t.byteCount,0)};r.a.sendTraceTag(528773919,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,`${JSON.stringify(l)}, TimeTaken: ${u.a.performanceNowTrimmed()-e}ms`)}catch(e){r.a.sendTraceTag(509130515,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"logPayload ex: "+Object(f.c)(e))}const I={x:o.viewSize.w,y:o.viewSize.h};let P=void 0;if(p.trans){let e=void 0;if(p.trans.morph){const t=p.trans.morph,i=e=>e/65536,r=e=>e?e*Math.PI/180:0,n=e=>{if(!e||!e.data||e.data.length<1)return;const t=new Float32Array(e.w*e.h*2);for(let r=0;r<e.h;r+=1){const n=r*e.w;for(let a=0;a<e.w;a+=1){const s=2*(a+r*e.w);t[s]=i(e.data[a+n].x),t[s+1]=i(e.data[a+n].y)}}return{size:new s.b(e.w,e.h),data:t}},a=e=>{let t=[];for(const i of e.spIdLst||[]){let e;i.txtRng&&(e={begin:i.txtRng.cp,length:i.txtRng.len,type:0});const r={shapeId:i.id?{slideId:{sid:i.id.sldId,cid:0},shapeId:i.id.spId}:void 0,bigPart:i.bapi?i.bapi.v:void 0,isSubtreeIncluded:i.incSub&&i.incSub.v,textRange:e,animatableContentId:i.spId,animatablePartIndicies:i.chdSpLst?i.chdSpLst.split(" ").map(e=>parseInt(e,10)):[]};t.push(r)}const a=e.imageID?{imgID:e.imageID,rect:{bottom:e.tb,left:e.tl,right:e.tr,top:e.tt}}:void 0;if(0!==t.length||a||e.isBg)return{parts:t,fallbackImage:a,angleRadians:r(i(-e.a2)),center:new s.b(e.cx,e.cy),flipX:e.flipX,flipY:e.flipY,isBg:e.isBg,size:new s.b(e.w,e.h),zIndex:i(e.z),grid:n(e.grid)}};let o=[];for(const e of t){const t=a(e.keyFrameA),n=a(e.keyFrameB);if(t&&n){const a=function(e,t){return(e%t+t)%t},l=function(e){return a(e,2*Math.PI)},d=l(t.angleRadians),h=l(r(i(-e.keyFrameA.am))),c=new s.b(Math.cos(d),Math.sin(d)),u=new s.b(Math.cos(h),Math.sin(h)),f=u.x*c.y-u.y*c.x>0;o.push({keyFrameA:t,keyFrameB:n,rotateClockwise:f})}else o.push({keyFrameA:t,keyFrameB:n})}e={elements:o,slideSizePixels:I}}P={morph:e,type:p.trans.type,dir:p.trans.dir,dur:p.trans.dur,stopSound:p.trans.stopSound}}const E=this.parseAccessibilityJSON(t,e.ID,e.Title,e.AccessibilityModel),x={slideId:e.ID,slideSizePixels:I,slideBackground:g,shapeGlyph:p.glyps,resCat:C,fHasAddinShape:y,transData:P,accessibilityModelPromise:E},A=[],k={AnimationList:[],SequenceId:"0_anim"};for(const e of p.animLst.anim||[])k.AnimationList.push(this.createAnimation(e));A.push(k);for(const e of p.animSeqs||[]){const t={AnimationList:[],SequenceId:e.id.toString()};for(const i of e.anim)t.AnimationList.push(this.createAnimation(i));A.push(t)}p.fontSubs&&m.logFontMissing(p.fontSubs);const R={id:x.slideId,spLst:w,hidden:p.hidden,animSeqs:A,ssTimes:this.readSlideAdvanceSettings(p.ssTimes),title:e.Title};return this.adjustAutoAdvanceTiming(R),{slide:R,slideViewData:x,shapeViewDatas:b}}}static isShapebuilderImage(e){return e.name.endsWith(".sb")||e.id.includes("_SB_")||/^[0-9]+_[0-9]+/.test(e.id)}static logFontMissing(e){let t=!1,i=!1,r=!1;for(const n of e)if(!n.e)switch(n.c){case 1:t=!0;break;case 2:i=!0;break;case 3:r=!0}!m.s_fLoggedFirstPartyFontMissing&&t&&(l.VetoUtils.recordVeto("SSFontMissingFirstParty",{qosVeto:"MissingFont"}),m.s_fLoggedFirstPartyFontMissing=!0),!m.s_fLoggedThirdPartyFontMissing&&i&&(l.VetoUtils.recordVeto("SSFontMissingThirdParty",{qosVeto:"MissingFont"}),m.s_fLoggedThirdPartyFontMissing=!0),!m.s_fLoggedCustomFontMissing&&r&&(l.VetoUtils.recordVeto("SSFontMissingCustom",{qosVeto:"MissingFont"}),m.s_fLoggedCustomFontMissing=!0)}static parseResCat(e){const t=[];if(e.resCat)for(let i of e.resCat){let e=t.findIndex(e=>e.id===i.id);if(-1===e)t.push({id:i.id,name:i.name,url:i.base64,byteCount:i.base64.length,urlType:0,mimeType:i.base64.substr(5).split(",")[0],size:{width:i.size?i.size.w:0,height:i.size?i.size.h:0}});else{if(""!==t[e].url)continue;const r=i.base64;t[e].url=r,t[e].mimeType=r.substr(5).split(",")[0],t[e].byteCount=r.length,t[e].urlType=0}}return t}static adjustMediaAnimations(e){if(!(e&&e.animLst&&e.animLst.anim))return;let t=!0;for(let i of e.animLst.anim)if(i.cmd&&""!==i.cmd&&0!==i.timing.st){if(e.spLst){const s=e.spLst.filter(e=>e.id-1===i.sp)[0];if(s)if(s.media){let o=s.media.Item;o?(o.autoPlay&&(t?(delete e.animLst.anim[e.animLst.anim.indexOf(i)],r.a.sendTraceTag(554009217,n.a.msoulscat_Wac_PptAnimation,a.a.Info,`Deleted AutoPlay media animation, sld.id: ${e.id}, shape.id: ${s.id}, media.name: ${s.media.name}, animation.cmd: ${i.cmd}, animation.timing.st: ${i.timing.st}`)):o.autoPlay=!1),i&&(i.timing.st=0)):r.a.sendTraceTag(554009218,n.a.msoulscat_Wac_PptAnimation,a.a.Info,`Unable to get mediaItem from shape.media.Item, sld.id: ${e.id}, shape.id: ${s.id}, media.name: ${s.media.name}`)}else r.a.sendTraceTag(554008658,n.a.msoulscat_Wac_PptAnimation,a.a.Info,`Shape.media was null, did we use the wrong shape id? sld.id: ${e.id}, shape.id: ${s.id}`)}}else t=!1;for(let t=e.animLst.anim.length-1;t>=0;t-=1)e.animLst.anim[t]||e.animLst.anim.splice(t,1)}static adjustAutoAdvanceTiming(e){if(!e.ssTimes||!e.ssTimes.autoAdv)return;const t=e.animSeqs.filter(e=>"0_anim"===e.SequenceId)[0].AnimationList;let i=0,r=0;for(let n=0;n<t.length;n+=1){let a=0;a="def"===t[n].animSpeed?1e3:"sld"===t[n].animSpeed||"clk"===t[n].animSpeed?0:Number.parseInt(t[n].animSpeed,10),t[n].autoReverse&&(a*=2),t[n].numRepeats>0&&(a*=t[n].numRepeats+1),a+=t[n].timeOffs,t[n].startTrig!==o.h.WithPrevious?(r+=i,i=a,t[n].startTrig!==o.h.OnClick||e.ssTimes.clickTimes||(t[n].startTrig=o.h.AfterPrevious)):i=Math.max(i,a)}r+=i,e.ssTimes.autoAdvTime=Math.ceil(Math.max(r,1e3*e.ssTimes.autoAdvTime)/1e3)}static readSlideAdvanceSettings(e){return{manualAdv:!e||e.manualAdv,autoAdv:!!e&&e.autoAdv,autoAdvTime:e?e.autoAdvTime/1e3:0,clickTimes:e&&e.clickTimes?e.clickTimes.split(";").map(e=>parseFloat(e)):void 0}}static async getTableText(e,t,i){if(e.hasOwnProperty("val"))return this.getImgElement(e.val,t);let r=document.createElement("table");const n=e.r,a=e.c,s=e.frhead,o=e.lrhead,l=e.fchead,d=e.lchead;let h=[];for(let e=0;e<n;e+=1){h[e]=[];for(let t=0;t<a;t+=1)h[e][t]=!0}let c=-1,u=-1,f=document.createElement("tr");for(let t of e.txt){if(!h[t.r][t.c])continue;t.r!==c&&(c=t.r,t.r>0&&r.appendChild(f),f=document.createElement("tr")),u=t.c;const e=0===c&&s||c===n-1&&o,m=0===u&&l||u===a-1&&d;let p=e||m?document.createElement("th"):document.createElement("td");if(t.txthtml){const e=await this.getDivForRichHtmlText(t.txthtml);p.appendChild(e)}else{let e=document.createElement("p");e.textContent=i,p.appendChild(e)}if(t.rs){p.setAttribute("rowspan",""+t.rs);for(let e=c+1;e<c+t.rs;e+=1)h[e][u]=!1}if(t.cs){p.setAttribute("colspan",""+t.cs);for(let e=u+1;e<u+t.cs;e+=1)if(h[c][e]=!1,t.rs)for(let i=c+1;i<c+t.rs;i+=1)h[i][e]=!1}e?p.setAttribute("scope","col"):m&&p.setAttribute("scope","row"),f.appendChild(p)}return r.appendChild(f),r}static getSpanForText(e,t){let i=document.createElement("span");return i.innerText=e,t&&(i.lang=t),i}static async getDivForRichHtmlText(e){let t=document.createElement("div");const r=(await i.e(11).then(i.t.bind(null,418,7))).sanitize(e);return t.innerHTML=r,t}static getImgElement(e,t){let i=document.createElement("img");return t&&i.setAttribute("aria-roledescription",t),e.replace(/(\r\n|\n|\r)/gm,". "),i.setAttribute("src","data:,"),i.setAttribute("alt",e),i}static async parseAccessibilityJSON(e,t,i,r){let n=document.createElement("div");n.id="InnerAccessibilityElement",n.setAttribute("style","position: absolute; left: 0px; top: auto; width: 1px; height: 1px; overflow: hidden;");const a=[];let s="";if(!r)return{accessibilityInnerDiv:n,slideTitleString:s,shapeAccessibilityDataList:a};const o=JSON.parse(r).shp;if(i)s=i;else for(const e of o)if("Title"===e.tp){s=e.val;break}const l=e.findIndex(e=>e.sid===t.sid),d=this.getLocalizedString();n.appendChild(this.getSpanForText(d.slideContentStr.replace("{0}",""+(l+1))));for(const e of o){let i={tp:e.tp,lang:e.lang,id:e.id,txthtml:e.txthtml,slideId:t,shapeId:e.id,val:this.getSpanForText(""+e.val)};if("Title"===e.tp);else if("Subtitle"===e.tp)n.appendChild(this.getImgElement(e.val,d.subtitleStr)),i.val=this.getImgElement(e.val,d.subtitleStr);else if("Text"===e.tp){const t=e.txthtml?await this.getDivForRichHtmlText(e.txthtml):this.getImgElement(e.val,d.shapeStr);n.appendChild(t),i.val=t}else"SmartArt"===e.tp?(n.appendChild(this.getImgElement(e.val,d.smartartStr)),i.val=this.getImgElement(e.val,d.smartartStr)):"Chart"===e.tp?(n.appendChild(this.getImgElement(e.val,d.chartStr)),i.val=this.getImgElement(e.val,d.chartStr)):"Table"===e.tp?(n.appendChild(await this.getTableText(e,d.tableStr,d.blankTableCellStr)),i.val=await this.getTableText(e,d.tableStr,d.blankTableCellStr)):"Group"===e.tp?(n.appendChild(this.getImgElement(e.val,d.groupStr)),i.val=this.getImgElement(e.val,d.groupStr)):"Picture"===e.tp&&(n.appendChild(this.getImgElement(e.val)),i.val=this.getImgElement(e.val));a.push(i)}return{accessibilityInnerDiv:n,slideTitleString:s,shapeAccessibilityDataList:a}}static getLocalizedString(){let e;return e="undefined"!=typeof PowerpointSlideshowStrings?{slideContentStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSlideContentStr,subtitleStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSubtitle,smartartStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSmartArt,chartStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelChart,tableStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelTable,groupStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelGroup,shapeStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelShape,blankTableCellStr:PowerpointSlideshowStrings.BlankTableCellLabel}:{slideContentStr:"Slide {0} Content:",subtitleStr:"Subtitle",smartartStr:"Smart Art",chartStr:"Chart",tableStr:"Table",groupStr:"Group",shapeStr:"Shape",blankTableCellStr:"Blank Cell"},e}static createAnimation(e){const t=m.readAnimationScale(e);return{after:m.readAnimAfterEffectType(e),animSpeed:e.timing.spd||"def",autoReverse:e.autoRev,childTimeInc:e.iter?e.iter.interval:-1,direction:e.dir,effectId:e.effectId,effectType:m.readAnimEffectCategory(e.effectType),motionPath:m.readMotionPath(e.mp),numRepeats:m.readRepeatSetting(e.repeat),animatedPropertyList:m.readAnimatedPropertyList(e.propLst),rewind:e.rewind,rotAngDegrees:e.rotAng/1e3,scaleByXPercent:t.x,scaleByYPercent:t.y,shapeId:e.sp.toString(),smoothEndFactor:e.smEnd/100,smoothStartFactor:e.smSt/100,startTrig:m.readAnimStartTrigType(e.timing.st),timeOffs:e.timing.off,transparencyAmountPercent:e.transp,rewindChildDelay:0,mediaCmd:e.cmd}}static readMotionPath(e){if(e){const t=[];for(let i=0;i<e.Items.length;i+=1){const r=m.readMotionPathCommand(e.Items[i]);r&&t.push(r)}return{commandList:t,fReversed:e.rev}}}static readMotionPathCommand(e){if("CT_MotionPathMoveCmd:#p"===e.__type){const t=e;return{type:o.k.MoveTo,end:{x:t.x,y:t.y}}}if("CT_MotionPathLineCmd:#p"===e.__type){const t=e;return{type:o.k.LineTo,end:{x:t.x,y:t.y}}}if("CT_MotionPathCurveCmd:#p"===e.__type){const t=e,i={x:t.x1,y:t.y1},r={x:t.x2,y:t.y2},n={x:t.x3,y:t.y3};return{type:o.k.CurveTo,control1:i,control2:r,end:n}}r.a.sendTraceTag(595638296,n.a.msoulscat_Wac_PptAnimation,a.a.Info,"readMotionPathCommand: : unrecognized command type, ignoring.")}static readAnimationScale(e){return e.scaleBy?new s.b(e.scaleBy.x/1e3,e.scaleBy.y/1e3):new s.b(100,100)}static readAnimAfterEffectType(e){return 1===e.hideAfter?o.a.HideImmediatelyAfter:2===e.hideAfter?o.a.HideOnNextClick:o.a.None}static readAnimEffectCategory(e){let t;switch(e){case 1:t=o.f.Exit;break;case 2:t=o.f.Emphasis;break;case 3:t=o.f.MotionPath;break;case 5:t=o.f.Media;break;default:t=o.f.Entrance}return t}static readRepeatSetting(e){if(e)switch(e.type){case 2:return-1;case 1:return-2;case 0:return e.count;default:return 0}return 0}static readAnimatedPropertyList(e){if(!e||0===e.length)return;const t=[];for(const i of e)t.push({name:i.name,times:i.times.split(";").map(e=>parseFloat(e)),values:i.values.split(";").map(e=>parseFloat(e))});return t}static readAnimStartTrigType(e){switch(e){case 1:return o.h.WithPrevious;case 2:return o.h.AfterPrevious;default:return o.h.OnClick}}static readMedia(e,t,i){if(!e)return;const s=e.Item;let o="";if(i){const e=JSON.parse(i),r=e&&e.shp;for(const e of r)if(e.id===t.shapeId){o=e.val;break}}if("CT_MediaLink:#p"===s.__type){const t=e.Item;return{isLocal:!1,src:t.src,contentType:t.ct,name:e.name,autoPlay:t.autoPlay,repeat:m.translateMediaRepeat(t.repeat),fullscreen:t.fullscreen,playAcrossSlides:t.playAcrossSlides,hideWhenStopped:t.hideWhenStopped,trimStartMs:t.trimStart,trimEndMs:t.trimEnd,volume:t.volume,ariaLabel:o,narration:t.narration}}if("CT_MediaLocal:#p"===s.__type){const t=e.Item;return{isLocal:!0,src:t.src,contentType:t.ct,name:e.name,autoPlay:t.autoPlay,repeat:m.translateMediaRepeat(t.repeat),fullscreen:t.fullscreen,playAcrossSlides:t.playAcrossSlides,hideWhenStopped:t.hideWhenStopped,trimStartMs:t.trimStart,trimEndMs:t.trimEnd,volume:t.volume,bmkLst:t.bmkLst?[...t.bmkLst]:[],ariaLabel:o,tracksInfo:t.tracksInfo,cropInfo:{left:t.cl,top:t.ctop,right:t.cr,bottom:t.cb},narration:t.narration}}if("CT_Error:#p"===s.__type){const i=e.Item;r.a.sendTraceTag(595637656,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,`readMedia: Found error with code ${i.id}.`);const s=t.slideId?t.slideId.sid:-1,o={errorCode:i.id,mediaName:`${s}s${t.shapeId}`};r.a.sendTraceTag(570750435,n.a.msoulscat_Wac_PptSession,a.a.Info,"NavigatingFrom "+JSON.stringify(o)),l.VetoUtils.recordVeto("MediaPlaybackFailed",{slideId:s,shapeId:t.shapeId,errorName:m.getMediaErrorName(o.errorCode),errorCode:o.errorCode,mediaName:o.mediaName,qosVeto:"MediaPlaybackFailed",isIntentional:!0})}}static getMediaErrorName(e){switch(e){case 48:return"UnsupportedMediaFormat";case 50:return"UnsupportedMediaLinkTarget";case 52:return"EmbeddedMediaExceedsMaxSize";case 54:return"MediaUnavailable";default:return"OtherMediaError"}}static translateMediaRepeat(e){return 4294967295===e?-1:e}static readGif(e,t,i){if(d.ChangeGate.isChangeGateEnabled("SSC.getItemsMediaResourceMapping")&&e&&e.length>0&&t){const r=t.filter(e=>e.id===i),n=e.filter(e=>e.Key===i);if(n.length>0){const e=r[0],t=n[0];let i,a;return t.Value.split(";").map(e=>{const t=decodeURIComponent(e);if(d.ChangeGate.isChangeGateEnabled("SSC.setMediaDownloadHandlerUrl")&&t.search("MediaDownloadHandler")>=0)i=t,a=t.concat("&transcode=videogif");else{const e=new RegExp(/(&|\?)mediaId=(\w+).(\w+).media/i).exec(t),r=e&&4===e.length?e[3].toLowerCase():void 0;r&&("gif"===r?i=t:a=t)}}),{name:t.Key,src:e.base64,imageUrl:i,videoUrl:a}}}else if(t&&t.length>0){const e=t.filter(e=>e.id===i);if(e.length>0){const t=e[0];let i,r;return t.name.split(";").map(e=>{const t=decodeURIComponent(e);if(d.ChangeGate.isChangeGateEnabled("SSC.setMediaDownloadHandlerUrl")&&t.search("MediaDownloadHandler")>=0)i=t,r=t.concat("&transcode=videogif");else{const e=new RegExp(/(&|\?)mediaId=(\w+).(\w+).media/i).exec(t),n=e&&4===e.length?e[3].toLowerCase():void 0;n&&("gif"===n?i=t:r=t)}}),{name:t.id,src:t.base64,imageUrl:i,videoUrl:r}}}}static readCameo(e){if(!e)return;let t=0;if(e.bgPr&&e.bgPr.Item)switch(e.bgPr.Item.__type){case"CT_BackgroundRemovedProperties:#p":t=1;break;case"CT_BackgroundBlurProperties:#p":t=2;break;case"CT_BackgroundCustomProperties:#p":t=3;break;default:t=0}return{backgroundProps:{backgroundType:t}}}}m.s_fLoggedFirstPartyFontMissing=!1,m.s_fLoggedThirdPartyFontMissing=!1,m.s_fLoggedCustomFontMissing=!1},function(e,t,i){"use strict";i.r(t),i.d(t,"Effect",(function(){return S}));var r=i(77),n=i(87),a=i(45),s=function(){function e(){}return e.EndsWith=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},e.StartsWith=function(e,t){return!!e&&0===e.indexOf(t)},e.Decode=function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",i=0;i<e.byteLength;i++)t+=String.fromCharCode(e[i]);return t},e.EncodeArrayBufferToBase64=function(e){for(var t,i,r,n,a,s,o,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d="",h=0,c=ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e);h<c.length;)n=(t=c[h++])>>2,a=(3&t)<<4|(i=h<c.length?c[h++]:Number.NaN)>>4,s=(15&i)<<2|(r=h<c.length?c[h++]:Number.NaN)>>6,o=63&r,isNaN(i)?s=o=64:isNaN(r)&&(o=64),d+=l.charAt(n)+l.charAt(a)+l.charAt(s)+l.charAt(o);return d},e.PadNumber=function(e,t){for(var i=String(e);i.length<t;)i="0"+i;return i},e}(),o=function(){function e(){this.children=[]}return e.prototype.isValid=function(e){return!0},e.prototype.process=function(e,t){var i="";if(this.line){var r=this.line,n=t.processor;n&&(n.lineProcessor&&(r=n.lineProcessor(r,t.isFragment)),n.attributeProcessor&&s.StartsWith(this.line,"attribute")?r=n.attributeProcessor(this.line):n.varyingProcessor&&s.StartsWith(this.line,"varying")?r=n.varyingProcessor(this.line,t.isFragment):(n.uniformProcessor||n.uniformBufferProcessor)&&s.StartsWith(this.line,"uniform")&&(/uniform (.+) (.+)/.test(this.line)?n.uniformProcessor&&(r=n.uniformProcessor(this.line,t.isFragment)):n.uniformBufferProcessor&&(r=n.uniformBufferProcessor(this.line,t.isFragment),t.lookForClosingBracketForUniformBuffer=!0)),n.endOfUniformBufferProcessor&&t.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(t.lookForClosingBracketForUniformBuffer=!1,r=n.endOfUniformBufferProcessor(this.line,t.isFragment))),i+=r+"\r\n"}return this.children.forEach((function(r){i+=r.process(e,t)})),this.additionalDefineKey&&(e[this.additionalDefineKey]=this.additionalDefineValue||"true"),i},e}(),l=function(){function e(){}return Object.defineProperty(e.prototype,"currentLine",{get:function(){return this._lines[this.lineIndex]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canRead",{get:function(){return this.lineIndex<this._lines.length-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lines",{set:function(e){this._lines=[];for(var t=0,i=e;t<i.length;t++){var r=i[t];if("#"!==r[0])for(var n=r.split(";"),a=0;a<n.length;a++){var s=n[a];(s=s.trim())&&this._lines.push(s+(a!==n.length-1?";":""))}else this._lines.push(r)}},enumerable:!1,configurable:!0}),e}(),d=i(28),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(d.__extends)(t,e),t.prototype.process=function(e,t){for(var i=0;i<this.children.length;i++){var r=this.children[i];if(r.isValid(e))return r.process(e,t)}return""},t}(o),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(d.__extends)(t,e),t.prototype.isValid=function(e){return this.testExpression.isTrue(e)},t}(o),u=function(){function e(){}return e.prototype.isTrue=function(e){return!0},e.postfixToInfix=function(t){for(var i=[],r=0,n=t;r<n.length;r++){var a=n[r];if(void 0===e._OperatorPriority[a])i.push(a);else{var s=i[i.length-1],o=i[i.length-2];i.length-=2,i.push("("+o+a+s+")")}}return i[i.length-1]},e.infixToPostfix=function(t){for(var i=[],r=-1,n=function(){""!==(d=d.trim())&&(i.push(d),d="")},a=function(t){r<e._Stack.length-1&&(e._Stack[++r]=t)},s=function(){return e._Stack[r]},o=function(){return-1===r?"!!INVALID EXPRESSION!!":e._Stack[r--]},l=0,d="";l<t.length;){var h=t.charAt(l),c=l<t.length-1?t.substr(l,2):"";if("("===h)d="",a(h);else if(")"===h){for(n();-1!==r&&"("!==s();)i.push(o());o()}else if(e._OperatorPriority[c]>1){for(n();-1!==r&&e._OperatorPriority[s()]>=e._OperatorPriority[c];)i.push(o());a(c),l++}else d+=h;l++}for(n();-1!==r;)"("===s()?o():i.push(o());return i},e._OperatorPriority={")":0,"(":1,"||":2,"&&":3},e._Stack=["","","","","","","","","","","","","","","","","","","",""],e}(),f=function(e){function t(t,i){void 0===i&&(i=!1);var r=e.call(this)||this;return r.define=t,r.not=i,r}return Object(d.__extends)(t,e),t.prototype.isTrue=function(e){var t=void 0!==e[this.define];return this.not&&(t=!t),t},t}(u),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(d.__extends)(t,e),t.prototype.isTrue=function(e){return this.leftOperand.isTrue(e)||this.rightOperand.isTrue(e)},t}(u),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(d.__extends)(t,e),t.prototype.isTrue=function(e){return this.leftOperand.isTrue(e)&&this.rightOperand.isTrue(e)},t}(u),g=function(e){function t(t,i,r){var n=e.call(this)||this;return n.define=t,n.operand=i,n.testValue=r,n}return Object(d.__extends)(t,e),t.prototype.isTrue=function(e){var t=e[this.define];void 0===t&&(t=this.define);var i=!1,r=parseInt(t),n=parseInt(this.testValue);switch(this.operand){case">":i=r>n;break;case"<":i=r<n;break;case"<=":i=r<=n;break;case">=":i=r>=n;break;case"==":i=r===n}return i},t}(u),_=i(74),v=/defined\s*?\((.+?)\)/g,y=/defined\s*?\[(.+?)\]/g,b=function(){function e(){}return e.Process=function(e,t,i,r){var n=this;this._ProcessIncludes(e,t,(function(e){var a=n._ProcessShaderConversion(e,t,r);i(a)}))},e._ProcessPrecision=function(e,t){var i=t.shouldUseHighPrecisionShader;return-1===e.indexOf("precision highp float")?e=i?"precision highp float;\n"+e:"precision mediump float;\n"+e:i||(e=e.replace("precision highp float","precision mediump float")),e},e._ExtractOperation=function(e){var t=/defined\((.+)\)/.exec(e);if(t&&t.length)return new f(t[1].trim(),"!"===e[0]);for(var i="",r=0,n=0,a=["==",">=","<=","<",">"];n<a.length&&(i=a[n],!((r=e.indexOf(i))>-1));n++);if(-1===r)return new f(e);var s=e.substring(0,r).trim(),o=e.substring(r+i.length).trim();return new g(s,i,o)},e._BuildSubExpression=function(e){e=e.replace(v,"defined[$1]");for(var t=[],i=0,r=u.infixToPostfix(e);i<r.length;i++){var n=r[i];if("||"!==n&&"&&"!==n)t.push(n);else if(t.length>=2){var a=t[t.length-1],s=t[t.length-2];t.length-=2;var o="&&"==n?new p:new m;"string"==typeof a&&(a=a.replace(y,"defined($1)")),"string"==typeof s&&(s=s.replace(y,"defined($1)")),o.leftOperand="string"==typeof s?this._ExtractOperation(s):s,o.rightOperand="string"==typeof a?this._ExtractOperation(a):a,t.push(o)}}var l=t[t.length-1];return"string"==typeof l&&(l=l.replace(y,"defined($1)")),"string"==typeof l?this._ExtractOperation(l):l},e._BuildExpression=function(e,t){var i=new c,r=e.substring(0,t),n=e.substring(t);return n=n.substring(0,(n.indexOf("//")+1||n.length+1)-1).trim(),i.testExpression="#ifdef"===r?new f(n):"#ifndef"===r?new f(n,!0):this._BuildSubExpression(n),i},e._MoveCursorWithinIf=function(e,t,i){for(var r=e.currentLine;this._MoveCursor(e,i);){var n=(r=e.currentLine).substring(0,5).toLowerCase();if("#else"===n){var a=new o;return t.children.push(a),void this._MoveCursor(e,a)}if("#elif"===n){var s=this._BuildExpression(r,5);t.children.push(s),i=s}}},e._MoveCursor=function(e,t){for(;e.canRead;){e.lineIndex++;var i=e.currentLine,r=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/.exec(i);if(r&&r.length)switch(r[0]){case"#ifdef":var n=new h;t.children.push(n);var a=this._BuildExpression(i,6);n.children.push(a),this._MoveCursorWithinIf(e,n,a);break;case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":n=new h,t.children.push(n),a=this._BuildExpression(i,7),n.children.push(a),this._MoveCursorWithinIf(e,n,a);break;case"#if":n=new h,a=this._BuildExpression(i,3),t.children.push(n),n.children.push(a),this._MoveCursorWithinIf(e,n,a)}else{var s=new o;if(s.line=i,t.children.push(s),"#"===i[0]&&"d"===i[1]){var l=i.replace(";","").split(" ");s.additionalDefineKey=l[1],3===l.length&&(s.additionalDefineValue=l[2])}}}return!1},e._EvaluatePreProcessors=function(e,t,i){var r=new o,n=new l;return n.lineIndex=-1,n.lines=e.split("\n"),this._MoveCursor(n,r),r.process(t,i)},e._PreparePreProcessors=function(e){for(var t={},i=0,r=e.defines;i<r.length;i++){var n=r[i].replace("#define","").replace(";","").trim().split(" ");t[n[0]]=n.length>1?n[1]:""}return t.GL_ES="true",t.__VERSION__=e.version,t[e.platformName]="true",t},e._ProcessShaderConversion=function(e,t,i){var r=this._ProcessPrecision(e,t);if(!t.processor)return r;if(-1!==r.indexOf("#version 3"))return r.replace("#version 300 es","");var n=t.defines,a=this._PreparePreProcessors(t);return t.processor.preProcessor&&(r=t.processor.preProcessor(r,n,t.isFragment)),r=this._EvaluatePreProcessors(r,a,t),t.processor.postProcessor&&(r=t.processor.postProcessor(r,n,t.isFragment,i)),r},e._ProcessIncludes=function(t,i,r){for(var n=this,a=/#include<(.+)>(\((.*)\))*(\[(.*)\])*/g,s=a.exec(t),o=new String(t),l=!1;null!=s;){var d=s[1];if(-1!==d.indexOf("__decl__")&&(d=d.replace(/__decl__/,""),i.supportsUniformBuffers&&(d=(d=d.replace(/Vertex/,"Ubo")).replace(/Fragment/,"Ubo")),d+="Declaration"),!i.includesShadersStore[d]){var h=i.shadersRepository+"ShadersInclude/"+d+".fx";return void e._FileToolsLoadFile(h,(function(e){i.includesShadersStore[d]=e,n._ProcessIncludes(o,i,r)}))}var c=i.includesShadersStore[d];if(s[2])for(var u=s[3].split(","),f=0;f<u.length;f+=2){var m=new RegExp(u[f],"g"),p=u[f+1];c=c.replace(m,p)}if(s[4]){var g=s[5];if(-1!==g.indexOf("..")){var _=g.split(".."),v=parseInt(_[0]),y=parseInt(_[1]),b=c.slice(0);c="",isNaN(y)&&(y=i.indexParameters[_[1]]);for(var S=v;S<y;S++)i.supportsUniformBuffers||(b=b.replace(/light\{X\}.(\w*)/g,(function(e,t){return t+"{X}"}))),c+=b.replace(/\{X\}/g,S.toString())+"\n"}else i.supportsUniformBuffers||(c=c.replace(/light\{X\}.(\w*)/g,(function(e,t){return t+"{X}"}))),c=c.replace(/\{X\}/g,g)}o=o.replace(s[0],c),l=l||c.indexOf("#include<")>=0,s=a.exec(t)}l?this._ProcessIncludes(o.toString(),i,r):r(o)},e._FileToolsLoadFile=function(e,t,i,r,n,a){throw _.a.WarnImport("FileTools")},e}(),S=function(){function e(t,i,a,s,o,l,d,h,c,u){var f,m=this;void 0===s&&(s=null),void 0===l&&(l=null),void 0===d&&(d=null),void 0===h&&(h=null),void 0===c&&(c=null),this.name=null,this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new r.a,this.onErrorObservable=new r.a,this._onBindObservable=null,this._wasPreviouslyReady=!1,this._bonesComputationForcedToCPU=!1,this._multiTarget=!1,this._uniformBuffersNames={},this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._pipelineContext=null,this._valueCache={},this.name=t;var p,g,_=null;if(i.attributes){var v=i;if(this._engine=a,this._attributesNames=v.attributes,this._uniformsNames=v.uniformsNames.concat(v.samplers),this._samplerList=v.samplers.slice(),this.defines=v.defines,this.onError=v.onError,this.onCompiled=v.onCompiled,this._fallbacks=v.fallbacks,this._indexParameters=v.indexParameters,this._transformFeedbackVaryings=v.transformFeedbackVaryings||null,this._multiTarget=!!v.multiTarget,v.uniformBuffersNames){this._uniformBuffersNamesList=v.uniformBuffersNames.slice();for(var y=0;y<v.uniformBuffersNames.length;y++)this._uniformBuffersNames[v.uniformBuffersNames[y]]=y}_=null!==(f=v.processFinalCode)&&void 0!==f?f:null}else this._engine=o,this.defines=null==l?"":l,this._uniformsNames=a.concat(s),this._samplerList=s?s.slice():[],this._attributesNames=i,this._uniformBuffersNamesList=[],this.onError=c,this.onCompiled=h,this._indexParameters=u,this._fallbacks=d;this._attributeLocationByName={},this.uniqueId=e._uniqueIdSeed++;var S=n.a.IsWindowObjectExist()?this._engine.getHostDocument():null;t.vertexSource?p="source:"+t.vertexSource:t.vertexElement?(p=S?S.getElementById(t.vertexElement):null)||(p=t.vertexElement):p=t.vertex||t,t.fragmentSource?g="source:"+t.fragmentSource:t.fragmentElement?(g=S?S.getElementById(t.fragmentElement):null)||(g=t.fragmentElement):g=t.fragment||t;var T={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:this._engine._shaderProcessor,supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:e.ShadersRepository,includesShadersStore:e.IncludesShadersStore,version:(100*this._engine.webGLVersion).toString(),platformName:this._engine.webGLVersion>=2?"WEBGL2":"WEBGL1"};this._loadShader(p,"Vertex","",(function(e){m._rawVertexSourceCode=e,m._loadShader(g,"Fragment","Pixel",(function(i){m._rawFragmentSourceCode=i,b.Process(e,T,(function(e){_&&(e=_("vertex",e)),T.isFragment=!0,b.Process(i,T,(function(i){_&&(i=_("fragment",i)),m._useFinalCode(e,i,t)}),m._engine)}),m._engine)}))}))}return Object.defineProperty(e.prototype,"onBindObservable",{get:function(){return this._onBindObservable||(this._onBindObservable=new r.a),this._onBindObservable},enumerable:!1,configurable:!0}),e.prototype._useFinalCode=function(e,t,i){if(i){var r=i.vertexElement||i.vertex||i.spectorName||i,n=i.fragmentElement||i.fragment||i.spectorName||i;this._vertexSourceCode="#define SHADER_NAME vertex:"+r+"\n"+e,this._fragmentSourceCode="#define SHADER_NAME fragment:"+n+"\n"+t}else this._vertexSourceCode=e,this._fragmentSourceCode=t;this._prepareEffect()},Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),e.prototype.isReady=function(){try{return this._isReadyInternal()}catch(e){return!1}},e.prototype._isReadyInternal=function(){return!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady},e.prototype.getEngine=function(){return this._engine},e.prototype.getPipelineContext=function(){return this._pipelineContext},e.prototype.getAttributesNames=function(){return this._attributesNames},e.prototype.getAttributeLocation=function(e){return this._attributes[e]},e.prototype.getAttributeLocationByName=function(e){return this._attributeLocationByName[e]},e.prototype.getAttributesCount=function(){return this._attributes.length},e.prototype.getUniformIndex=function(e){return this._uniformsNames.indexOf(e)},e.prototype.getUniform=function(e){return this._uniforms[e]},e.prototype.getSamplers=function(){return this._samplerList},e.prototype.getUniformNames=function(){return this._uniformsNames},e.prototype.getUniformBuffersNames=function(){return this._uniformBuffersNamesList},e.prototype.getIndexParameters=function(){return this._indexParameters},e.prototype.getCompilationError=function(){return this._compilationError},e.prototype.allFallbacksProcessed=function(){return this._allFallbacksProcessed},e.prototype.executeWhenCompiled=function(e){var t=this;this.isReady()?e(this):(this.onCompileObservable.add((function(t){e(t)})),this._pipelineContext&&!this._pipelineContext.isAsync||setTimeout((function(){t._checkIsReady(null)}),16))},e.prototype._checkIsReady=function(e){var t=this;try{if(this._isReadyInternal())return}catch(t){return void this._processCompilationErrors(t,e)}setTimeout((function(){t._checkIsReady(e)}),16)},e.prototype._loadShader=function(t,i,r,a){var s;"undefined"!=typeof HTMLElement&&t instanceof HTMLElement?a(n.a.GetDOMTextContent(t)):"source:"!==t.substr(0,7)?"base64:"!==t.substr(0,7)?e.ShadersStore[t+i+"Shader"]?a(e.ShadersStore[t+i+"Shader"]):r&&e.ShadersStore[t+r+"Shader"]?a(e.ShadersStore[t+r+"Shader"]):(s="."===t[0]||"/"===t[0]||t.indexOf("http")>-1?t:e.ShadersRepository+t,this._engine._loadFile(s+"."+i.toLowerCase()+".fx",a)):a(window.atob(t.substr(7))):a(t.substr(7))},Object.defineProperty(e.prototype,"vertexSourceCode",{get:function(){return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:this._vertexSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragmentSourceCode",{get:function(){return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:this._fragmentSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rawVertexSourceCode",{get:function(){return this._rawVertexSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rawFragmentSourceCode",{get:function(){return this._rawFragmentSourceCode},enumerable:!1,configurable:!0}),e.prototype._rebuildProgram=function(e,t,i,r){var n=this;this._isReady=!1,this._vertexSourceCodeOverride=e,this._fragmentSourceCodeOverride=t,this.onError=function(e,t){r&&r(t)},this.onCompiled=function(){var e=n.getEngine().scenes;if(e)for(var t=0;t<e.length;t++)e[t].markAllMaterialsAsDirty(63);n._pipelineContext._handlesSpectorRebuildCallback(i)},this._fallbacks=null,this._prepareEffect()},e.prototype._prepareEffect=function(){var e=this,t=this._attributesNames,i=this.defines;this._valueCache={};var r=this._pipelineContext;try{var n=this._engine;this._pipelineContext=n.createPipelineContext();var a=this._rebuildProgram.bind(this);this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?n._preparePipelineContext(this._pipelineContext,this._vertexSourceCodeOverride,this._fragmentSourceCodeOverride,!0,a,null,this._transformFeedbackVaryings):n._preparePipelineContext(this._pipelineContext,this._vertexSourceCode,this._fragmentSourceCode,!1,a,i,this._transformFeedbackVaryings),n._executeWhenRenderingStateIsCompiled(this._pipelineContext,(function(){if(n.supportsUniformBuffers)for(var i in e._uniformBuffersNames)e.bindUniformBlock(i,e._uniformBuffersNames[i]);var a;if(n.getUniforms(e._pipelineContext,e._uniformsNames).forEach((function(t,i){e._uniforms[e._uniformsNames[i]]=t})),e._attributes=n.getAttributes(e._pipelineContext,t),t)for(var s=0;s<t.length;s++){var o=t[s];e._attributeLocationByName[o]=e._attributes[s]}for(a=0;a<e._samplerList.length;a++)null==e.getUniform(e._samplerList[a])&&(e._samplerList.splice(a,1),a--);e._samplerList.forEach((function(t,i){e._samplers[t]=i})),n.bindSamplers(e),e._compilationError="",e._isReady=!0,e.onCompiled&&e.onCompiled(e),e.onCompileObservable.notifyObservers(e),e.onCompileObservable.clear(),e._fallbacks&&e._fallbacks.unBindMesh(),r&&e.getEngine()._deletePipelineContext(r)})),this._pipelineContext.isAsync&&this._checkIsReady(r)}catch(e){this._processCompilationErrors(e,r)}},e.prototype._getShaderCodeAndErrorLine=function(e,t,i){var r=i?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/,n=null;if(t&&e){var a=t.match(r);if(a&&2===a.length){var s=parseInt(a[1]),o=e.split("\n",-1);o.length>=s&&(n="Offending line ["+s+"] in "+(i?"fragment":"vertex")+" code: "+o[s-1])}}return[e,n]},e.prototype._processCompilationErrors=function(t,i){var r,n,s,o,l;void 0===i&&(i=null),this._compilationError=t.message;var d=this._attributesNames,h=this._fallbacks;if(a.a.Error("Unable to compile effect:"),a.a.Error("Uniforms: "+this._uniformsNames.map((function(e){return" "+e}))),a.a.Error("Attributes: "+d.map((function(e){return" "+e}))),a.a.Error("Defines:\r\n"+this.defines),e.LogShaderCodeOnCompilationError){var c=null,u=null,f=null;(null===(s=this._pipelineContext)||void 0===s?void 0:s._getVertexShaderCode())&&(f=(r=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1))[0],c=r[1],f&&(a.a.Error("Vertex code:"),a.a.Error(f))),(null===(o=this._pipelineContext)||void 0===o?void 0:o._getFragmentShaderCode())&&(f=(n=this._getShaderCodeAndErrorLine(null===(l=this._pipelineContext)||void 0===l?void 0:l._getFragmentShaderCode(),this._compilationError,!0))[0],u=n[1],f&&(a.a.Error("Fragment code:"),a.a.Error(f))),c&&a.a.Error(c),u&&a.a.Error(u)}a.a.Error("Error: "+this._compilationError),i&&(this._pipelineContext=i,this._isReady=!0,this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this)),h?(this._pipelineContext=null,h.hasMoreFallbacks?(this._allFallbacksProcessed=!1,a.a.Error("Trying next fallback."),this.defines=h.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):this._allFallbacksProcessed=!0},Object.defineProperty(e.prototype,"isSupported",{get:function(){return""===this._compilationError},enumerable:!1,configurable:!0}),e.prototype._bindTexture=function(e,t){this._engine._bindTexture(this._samplers[e],t)},e.prototype.setTexture=function(e,t){this._engine.setTexture(this._samplers[e],this._uniforms[e],t)},e.prototype.setDepthStencilTexture=function(e,t){this._engine.setDepthStencilTexture(this._samplers[e],this._uniforms[e],t)},e.prototype.setTextureArray=function(e,t){var i=e+"Ex";if(-1===this._samplerList.indexOf(i+"0")){for(var r=this._samplerList.indexOf(e),n=1;n<t.length;n++){var a=i+(n-1).toString();this._samplerList.splice(r+n,0,a)}for(var s=0,o=0,l=this._samplerList;o<l.length;o++){var d=l[o];this._samplers[d]=s,s+=1}}this._engine.setTextureArray(this._samplers[e],this._uniforms[e],t)},e.prototype.setTextureFromPostProcess=function(e,t){this._engine.setTextureFromPostProcess(this._samplers[e],t)},e.prototype.setTextureFromPostProcessOutput=function(e,t){this._engine.setTextureFromPostProcessOutput(this._samplers[e],t)},e.prototype._cacheMatrix=function(e,t){var i=this._valueCache[e],r=t.updateFlag;return(void 0===i||i!==r)&&(this._valueCache[e]=r,!0)},e.prototype._cacheFloat2=function(e,t,i){var r=this._valueCache[e];if(!r||2!==r.length)return r=[t,i],this._valueCache[e]=r,!0;var n=!1;return r[0]!==t&&(r[0]=t,n=!0),r[1]!==i&&(r[1]=i,n=!0),n},e.prototype._cacheFloat3=function(e,t,i,r){var n=this._valueCache[e];if(!n||3!==n.length)return n=[t,i,r],this._valueCache[e]=n,!0;var a=!1;return n[0]!==t&&(n[0]=t,a=!0),n[1]!==i&&(n[1]=i,a=!0),n[2]!==r&&(n[2]=r,a=!0),a},e.prototype._cacheFloat4=function(e,t,i,r,n){var a=this._valueCache[e];if(!a||4!==a.length)return a=[t,i,r,n],this._valueCache[e]=a,!0;var s=!1;return a[0]!==t&&(a[0]=t,s=!0),a[1]!==i&&(a[1]=i,s=!0),a[2]!==r&&(a[2]=r,s=!0),a[3]!==n&&(a[3]=n,s=!0),s},e.prototype.bindUniformBuffer=function(t,i){var r=this._uniformBuffersNames[i];void 0!==r&&e._baseCache[r]!==t&&(e._baseCache[r]=t,this._engine.bindUniformBufferBase(t,r))},e.prototype.bindUniformBlock=function(e,t){this._engine.bindUniformBlock(this._pipelineContext,e,t)},e.prototype.setInt=function(e,t){var i=this._valueCache[e];return void 0!==i&&i===t||this._engine.setInt(this._uniforms[e],t)&&(this._valueCache[e]=t),this},e.prototype.setIntArray=function(e,t){return this._valueCache[e]=null,this._engine.setIntArray(this._uniforms[e],t),this},e.prototype.setIntArray2=function(e,t){return this._valueCache[e]=null,this._engine.setIntArray2(this._uniforms[e],t),this},e.prototype.setIntArray3=function(e,t){return this._valueCache[e]=null,this._engine.setIntArray3(this._uniforms[e],t),this},e.prototype.setIntArray4=function(e,t){return this._valueCache[e]=null,this._engine.setIntArray4(this._uniforms[e],t),this},e.prototype.setFloatArray=function(e,t){return this._valueCache[e]=null,this._engine.setArray(this._uniforms[e],t),this},e.prototype.setFloatArray2=function(e,t){return this._valueCache[e]=null,this._engine.setArray2(this._uniforms[e],t),this},e.prototype.setFloatArray3=function(e,t){return this._valueCache[e]=null,this._engine.setArray3(this._uniforms[e],t),this},e.prototype.setFloatArray4=function(e,t){return this._valueCache[e]=null,this._engine.setArray4(this._uniforms[e],t),this},e.prototype.setArray=function(e,t){return this._valueCache[e]=null,this._engine.setArray(this._uniforms[e],t),this},e.prototype.setArray2=function(e,t){return this._valueCache[e]=null,this._engine.setArray2(this._uniforms[e],t),this},e.prototype.setArray3=function(e,t){return this._valueCache[e]=null,this._engine.setArray3(this._uniforms[e],t),this},e.prototype.setArray4=function(e,t){return this._valueCache[e]=null,this._engine.setArray4(this._uniforms[e],t),this},e.prototype.setMatrices=function(e,t){return t?(this._valueCache[e]=null,this._engine.setMatrices(this._uniforms[e],t),this):this},e.prototype.setMatrix=function(e,t){return this._cacheMatrix(e,t)&&(this._engine.setMatrices(this._uniforms[e],t.toArray())||(this._valueCache[e]=null)),this},e.prototype.setMatrix3x3=function(e,t){return this._valueCache[e]=null,this._engine.setMatrix3x3(this._uniforms[e],t),this},e.prototype.setMatrix2x2=function(e,t){return this._valueCache[e]=null,this._engine.setMatrix2x2(this._uniforms[e],t),this},e.prototype.setFloat=function(e,t){var i=this._valueCache[e];return void 0!==i&&i===t||this._engine.setFloat(this._uniforms[e],t)&&(this._valueCache[e]=t),this},e.prototype.setBool=function(e,t){var i=this._valueCache[e];return void 0!==i&&i===t||this._engine.setInt(this._uniforms[e],t?1:0)&&(this._valueCache[e]=t),this},e.prototype.setVector2=function(e,t){return this._cacheFloat2(e,t.x,t.y)&&(this._engine.setFloat2(this._uniforms[e],t.x,t.y)||(this._valueCache[e]=null)),this},e.prototype.setFloat2=function(e,t,i){return this._cacheFloat2(e,t,i)&&(this._engine.setFloat2(this._uniforms[e],t,i)||(this._valueCache[e]=null)),this},e.prototype.setVector3=function(e,t){return this._cacheFloat3(e,t.x,t.y,t.z)&&(this._engine.setFloat3(this._uniforms[e],t.x,t.y,t.z)||(this._valueCache[e]=null)),this},e.prototype.setFloat3=function(e,t,i,r){return this._cacheFloat3(e,t,i,r)&&(this._engine.setFloat3(this._uniforms[e],t,i,r)||(this._valueCache[e]=null)),this},e.prototype.setVector4=function(e,t){return this._cacheFloat4(e,t.x,t.y,t.z,t.w)&&(this._engine.setFloat4(this._uniforms[e],t.x,t.y,t.z,t.w)||(this._valueCache[e]=null)),this},e.prototype.setFloat4=function(e,t,i,r,n){return this._cacheFloat4(e,t,i,r,n)&&(this._engine.setFloat4(this._uniforms[e],t,i,r,n)||(this._valueCache[e]=null)),this},e.prototype.setColor3=function(e,t){return this._cacheFloat3(e,t.r,t.g,t.b)&&(this._engine.setFloat3(this._uniforms[e],t.r,t.g,t.b)||(this._valueCache[e]=null)),this},e.prototype.setColor4=function(e,t,i){return this._cacheFloat4(e,t.r,t.g,t.b,i)&&(this._engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,i)||(this._valueCache[e]=null)),this},e.prototype.setDirectColor4=function(e,t){return this._cacheFloat4(e,t.r,t.g,t.b,t.a)&&(this._engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,t.a)||(this._valueCache[e]=null)),this},e.prototype.dispose=function(){this._engine._releaseEffect(this)},e.RegisterShader=function(t,i,r){i&&(e.ShadersStore[t+"PixelShader"]=i),r&&(e.ShadersStore[t+"VertexShader"]=r)},e.ResetCache=function(){e._baseCache={}},e.ShadersRepository="src/Shaders/",e.LogShaderCodeOnCompilationError=!0,e._uniqueIdSeed=0,e._baseCache={},e.ShadersStore={},e.IncludesShadersStore={},e}()},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.IsWindowObjectExist=function(){return"undefined"!=typeof window},e.IsNavigatorAvailable=function(){return"undefined"!=typeof navigator},e.IsDocumentAvailable=function(){return"undefined"!=typeof document},e.GetDOMTextContent=function(e){for(var t="",i=e.firstChild;i;)3===i.nodeType&&(t+=i.textContent),i=i.nextSibling;return t},e}()},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e}(),n=new(function(){function e(){this.externalLogger=new r}return e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,i,r){this.externalLogger.sendTraceTag(e,t,i,r)},e.prototype.debugAssertTag=function(e,t,i,r){this.externalLogger.debugAssertTag(e,t,i,r)},e.prototype.shipAssertTag=function(e,t,i,r){this.externalLogger.shipAssertTag(e,t,i,r)},e}())},,function(e,t,i){var r=i(29).Buffer,n=i(287).Transform,a=i(96).StringDecoder;function s(e){n.call(this),this.hashMode="string"==typeof e,this.hashMode?this[e]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}i(26)(s,n),s.prototype.update=function(e,t,i){"string"==typeof e&&(e=r.from(e,t));var n=this._update(e);return this.hashMode?this:(i&&(n=this._toString(n,i)),n)},s.prototype.setAutoPadding=function(){},s.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},s.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},s.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},s.prototype._transform=function(e,t,i){var r;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(e){r=e}finally{i(r)}},s.prototype._flush=function(e){var t;try{this.push(this.__final())}catch(e){t=e}e(t)},s.prototype._finalOrDigest=function(e){var t=this.__final()||r.alloc(0);return e&&(t=this._toString(t,e,!0)),t},s.prototype._toString=function(e,t,i){if(this._decoder||(this._decoder=new a(t),this._encoding=t),this._encoding!==t)throw new Error("can't switch encodings");var r=this._decoder.write(e);return i&&(r+=this._decoder.end()),r},e.exports=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(49),n=function(){function e(){}return e.getScaledProgress=function(t,i,r,n){switch(void 0===r&&(r=0),void 0===n&&(n=0),t){case 1:return i;case 0:var a=4;return e.getPositionFromTime(i,a,0,.5,1,!0);case 2:return i*i;case 3:if(a=2,i>1-r){var s=(i-(1-r))/r;return 1+e.getBounce(s,a,r,n)}var o=i/(1-r);return e.getLocation(a,0,0,o);case 4:return i*i*i;default:return 0}},e.getLocation=function(e,t,i,r){return.5*e*r*r+t*r+i},e.getPositionFromTime=function(e,t,i,r,n,a){var s=0;if(e>i){var o=a?-t:0,l=r-i;s=e<=r?this.getLocation(t,0,0,e-i):e<n?this.getLocation(o,t*l,this.getLocation(t,0,0,l),e-r):this.getLocation(o,t*l,this.getLocation(t,0,0,l),n-r)}return s},e.getVelocityFromTime=function(e,t,i,r,n,a){var s=a?-t:0,o=r-i;return e<=r?t*(e-i):e<n?s*(e-r)+t*o:s*(n-r)+t*o},e.getBounce=function(e,t,i,r){var n=2*e*Math.PI;return 1/r*(1-e)*i*Math.sin(n)*t},e.doSwivel=function(e,t,i){var n,a,s=e,o=t,l=i.m_swivelTime/100,d=i.m_waitTime/100,h=-i.m_swivelAngle*Math.PI/180,c=i.m_swivelZoom/100;return s<l+d?(s>l&&(s=l),n=1-(l-s)/l,a=0):s<1-l?(n=1,a=(s-l)/(1-2*l)):(n=(1-s)/l,a=1),o=r.mat16Mul(o,r.mat16Translate(0,0,n*c)),{scaledProgress:a,offset:o=r.mat16Mul(o,r.mat16RotateY(n*h)),swivelPercent:n}},e}();t.MotionFilter=n},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(53),s=i(98),o=i(49),l=i(57),d=i(32),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isForward=!1,t.jitter=0,t.factor=0,t.delayDuration=0,t.style=0,t}return n(t,e),t.prototype.init=function(t,i){if(null!=t){e.prototype.init.call(this,t,i),this.isForward=t.forward,this.jitter=t.jitter,this.factor=t.factor;var r=new s.MeshInfo(t),n=new s.Mesh;n.initialize(r),this.delayDuration=0==r.delayFormula?0:1,this.style=1,this.incomingSlideTexture=t.incomingSlideBackground,this.outgoingSlideTexture=t.outgoingSlideBackground,this.initShaders(),this.initBuffers(n);var a=this.gl;if(a){a.disable(a.DEPTH_TEST),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.disable(a.CULL_FACE);var l=o.mat16Identity(),h=o.mat16Mul(o.mat16Translate(-.5,-.5,0),o.mat16Scale(2,2,1));this.modelViewProjectionMatrix=o.mat16Mul(l,h)}else d.logError("WebGLRenderingContext undefined")}},t.prototype.initShaders=function(){var e=this.gl;if(e){var t=l.activateShader(e,0);t.vertexPositionAttribute=e.getAttribLocation(t.program,"aPosition"),e.enableVertexAttribArray(t.vertexPositionAttribute),t.textureCoordAttribute=e.getAttribLocation(t.program,"aTexcoord"),e.enableVertexAttribArray(t.textureCoordAttribute),t.vertexDelayAttribute=e.getAttribLocation(t.program,"aDelay"),e.enableVertexAttribArray(t.vertexDelayAttribute),t.matrixUniform=e.getUniformLocation(t.program,"uModelViewProj"),t.progressUniform=e.getUniformLocation(t.program,"uProgress"),t.factorUniform=e.getUniformLocation(t.program,"uFactor"),t.styleUniform=e.getUniformLocation(t.program,"uStyle"),t.sampler1Uniform=e.getUniformLocation(t.program,"uSampler1"),t.sampler2Uniform=e.getUniformLocation(t.program,"uSampler2"),this.shaderProgram=t}else d.logError("WebGLRenderingContext undefined")},t.prototype.initBuffers=function(e){var t=this.gl,i={},r={},n={},a={};if(t){i.buffer=this.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,i.buffer);var s=e.getVertexPositions();t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),i.itemSize=3,r.buffer=this.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,r.buffer);var o=e.getTextureCoords();t.bufferData(t.ARRAY_BUFFER,new Float32Array(o),t.STATIC_DRAW),r.itemSize=2,n.buffer=this.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,n.buffer);var l=e.getDelays();t.bufferData(t.ARRAY_BUFFER,new Float32Array(l),t.STATIC_DRAW),n.itemSize=1,a.buffer=this.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a.buffer);var h=e.getVertexIndices();t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(h),t.STATIC_DRAW),a.itemSize=1,a.numItems=h.length,this.vertexPositionBuffer=i,this.vertexTextureCoordBuffer=r,this.vertexDelayBuffer=n,this.vertexIndexBuffer=a}else d.logError("WebGLRenderingContext undefined")},t.prototype.draw=function(e){if(!this.gl)return d.logError("WebGLRenderingContext undefined"),!1;if(!a.isTransitionReadyForDraw(this.gl))return!1;var t=this.gl,i=this.shaderProgram,r=this.vertexPositionBuffer,n=this.vertexTextureCoordBuffer,s=this.vertexDelayBuffer,o=this.vertexIndexBuffer,h=this.incomingSlideTexture,c=this.outgoingSlideTexture;l.activateShader(t,0),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.vertexAttribPointer(i.vertexPositionAttribute,r.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,n.buffer),t.vertexAttribPointer(i.textureCoordAttribute,n.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,s.buffer),t.vertexAttribPointer(i.vertexDelayAttribute,s.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,o.buffer);var u=e*(this.delayDuration+1/this.factor+this.jitter/100);return t.uniformMatrix4fv(i.matrixUniform,!1,this.modelViewProjectionMatrix),t.uniform1f(i.progressUniform,u),t.uniform1f(i.factorUniform,this.factor),t.uniform1f(i.styleUniform,this.style),t.uniform1i(i.sampler1Uniform,0),t.uniform1i(i.sampler2Uniform,1),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.isForward?c:h),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this.isForward?h:c),t.drawElements(t.TRIANGLES,o.numItems,t.UNSIGNED_SHORT,0),!0},t}(a.BaseTransition);t.AlphaTransition=h},function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return l}));var r=i(0),n=i(64);function a(e,t,i,n,a){if(0==i&&e.cachedBoundsContributor)return{points:e.cachedBoundsContributor.points,curves:e.cachedBoundsContributor.curves,transform:t};const s=0!=i,o={points:new Array,curves:new Array,transform:s?void 0:t},l=e.getPointCount();for(let d=0;d<l;d++){let l=e.getPoint(d-1),h=e.getPoint(d),c=e.getPoint(d+1);if(s&&(l=t.transformPoint(l),h=t.transformPoint(h),c=t.transformPoint(c)),2==e.getPointType(d))i?(o.curves.push([l.add(new r.e(-i,0)),h.add(new r.e(-i,0)),c.add(new r.e(-i,0))]),o.curves.push([l.add(new r.e(i,0)),h.add(new r.e(i,0)),c.add(new r.e(i,0))]),o.curves.push([l.add(new r.e(0,-i)),h.add(new r.e(0,-i)),c.add(new r.e(0,-i))]),o.curves.push([l.add(new r.e(0,i)),h.add(new r.e(0,i)),c.add(new r.e(0,i))])):o.curves.push([l,h,c]);else if(o.points.push(h),i)if(2==n)i?(o.points.push(h.add(new r.e(-i,0))),o.points.push(h.add(new r.e(i,0))),o.points.push(h.add(new r.e(0,-i))),o.points.push(h.add(new r.e(0,i)))):o.points.push(h);else{let e=h.subtract(l).normalized(),t=c.subtract(h).normalized();if(e&&t){e=e.scale(i),t=t.scale(i);let s=new r.e(-e.y,e.x),l=new r.e(-t.y,t.x);e.dot(l)<0&&(s=s.negate(),l=l.negate());const d=h.add(s),c=h.add(l);if(o.points.push(d),o.points.push(c),1==n||3==n){const s=r.e.CalculateLineIntersection(d,d.add(e),c,c.subtract(t));s&&(r.e.Distance(s,h)<a*i?o.points.push(s):1==n&&(o.points.push(d.add(e.scale(a))),o.points.push(c.subtract(t.scale(a)))))}}}}return 0!=i||e.cachedBoundsContributor||(e.cachedBoundsContributor={points:o.points,curves:o.curves,transform:void 0}),o}function s(e,t,i,r,s,o){for(const l of e){const e=l.transform.toMatrix3().multiply(r);for(const r of l.figures)if(o.push(a(r,e,t,s?1:i.pen.lineJoin,i.pen.miterLimit)),t&&!r.isClosed&&i.pen){if(i.pen.headEnd&&0!=i.pen.headEnd.end){const s=Object(n.a)(i.pen.headEnd,i.pen.adjustedLineWidthForArrowHead);if(s){const l=Object(n.b)(r,!1,i.pen.headEnd,2*t,e);l&&o.push(a(s,l,t,1,i.pen.miterLimit))}}if(i.pen.tailEnd&&0!=i.pen.tailEnd.end){const s=Object(n.a)(i.pen.tailEnd,i.pen.adjustedLineWidthForArrowHead);if(s){const l=Object(n.b)(r,!0,i.pen.tailEnd,2*t,e);l&&o.push(a(s,l,t,1,i.pen.miterLimit))}}}}}function o(e,t){let i=!0,n=0,a=0,s=0,o=0;const l=e.transform&&t?e.transform.multiply(t):t||e.transform,d=!l||l.isSimpleScaleTranslationOnly(),h=d?void 0:l,c=e.points,u=e.curves,f=c&&c.length>0?c[0]:u&&u.length>0?u[0][0]:void 0;if(f){let e=0,t=0,m=0,p=0,g=0,_=0;if(h&&(e=h.m[0],t=h.m[1],m=h.m[3],p=h.m[4],g=h.m[6],_=h.m[7]),i&&(n=h?f.x*e+f.y*m+g:f.x,s=h?f.x*t+f.y*p+_:f.y,a=n,o=s,i=!1),c&&c.length>0)for(let i=1;i<c.length;i++){const r=c[i],l=h?r.x*e+r.y*m+g:r.x,d=h?r.x*t+r.y*p+_:r.y;n=l<n?l:n,a=l>a?l:a,s=d<s?d:s,o=d>o?d:o}for(const i of u||[]){const r=i[0],l=i[1],d=i[2],c=h?r.x*e+r.y*m+g:r.x,u=h?r.x*t+r.y*p+_:r.y,f=h?l.x*e+l.y*m+g:l.x,v=h?l.x*t+l.y*p+_:l.y,y=h?d.x*e+d.y*m+g:d.x,b=h?d.x*t+d.y*p+_:d.y;n=c<n?c:n,a=c>a?c:a,s=u<s?u:s,o=u>o?u:o,n=y<n?y:n,a=y>a?y:a,s=b<s?b:s,o=b>o?b:o;const S=(c-f)/(c+y-2*f);if(0<S&&S<1){const e=S*S,t=c*(e-2*S+1)+y*e+2*f*(S-e),i=u*(e-2*S+1)+b*e+2*v*(S-e);n=t<n?t:n,a=t>a?t:a,s=i<s?i:s,o=i>o?i:o}const T=(u-v)/(u+b-2*v);if(0<T&&T<1){const e=T*T,t=c*(e-2*T+1)+y*e+2*f*(T-e),i=u*(e-2*T+1)+b*e+2*v*(T-e);n=t<n?t:n,a=t>a?t:a,s=i<s?i:s,o=i>o?i:o}}let v=new r.c(n,s,a,o);return d&&(v=l?v.multiply(l.getSimpleScale()).translate(l.getSimpleTranslation()):v),v}}function l(e){let t=void 0;for(const i of e){if(0!=i.transform.rotation)return;const e=i.untransformedBounds;e&&(t=r.c.UnionRect(t,e.transformedBounds(i.transform)))}return t}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));const r="undefined"!=typeof FinalizationRegistry?new FinalizationRegistry(e=>{const t=e;for(let e in t)t[e].onFinalization()}):void 0},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.initSettings=function(e){e.disabledChangeGates&&(this.m_disabledChangeGateList=e.disabledChangeGates.split(";"))},e.isChangeGateEnabled=function(e){return!!e&&(!this.m_disabledChangeGateList||this.m_disabledChangeGateList.indexOf(e)<0)},e.m_disabledChangeGateList=[""],e}();t.ChangeGate=r},function(e,t,i){"use strict";var r=i(278).Buffer,n=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===n||!n(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=d,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=h,this.end=c,t=3;break;default:return this.write=u,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function o(e){var t=this.lastTotal-this.lastNeed,i=function(e,t,i){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==i?i:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var i=e.toString("utf16le",t);if(i){var r=i.charCodeAt(i.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function d(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,i)}return t}function h(e,t){var i=(e.length-t)%3;return 0===i?e.toString("base64",t):(this.lastNeed=3-i,this.lastTotal=3,1===i?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-i))}function c(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function u(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.StringDecoder=a,a.prototype.write=function(e){if(0===e.length)return"";var t,i;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<e.length?t?t+this.text(e,i):this.text(e,i):t||""},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},a.prototype.text=function(e,t){var i=function(e,t,i){var r=t.length-1;if(r<i)return 0;var n=s(t[r]);return n>=0?(n>0&&(e.lastNeed=n-1),n):--r<i||-2===n?0:(n=s(t[r]))>=0?(n>0&&(e.lastNeed=n-2),n):--r<i||-2===n?0:(n=s(t[r]))>=0?(n>0&&(2===n?n=0:e.lastNeed=n-3),n):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=i;var r=e.length-(i-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,i){"use strict";var r=i(127),n=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t};e.exports=c;var a=Object.create(i(117));a.inherits=i(26);var s=i(186),o=i(150);a.inherits(c,s);for(var l=n(o.prototype),d=0;d<l.length;d++){var h=l[d];c.prototype[h]||(c.prototype[h]=o.prototype[h])}function c(e){if(!(this instanceof c))return new c(e);s.call(this,e),o.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",u)}function u(){this.allowHalfOpen||this._writableState.ended||r.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),c.prototype._destroy=function(e,t){this.push(null),this.end(),r.nextTick(t,e)}},function(e,t,i){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0});var a=i(32),s=function(e,t){this.x=e,this.y=t};t.Vector2=s;t.Vector3=function(e,t,i){this.x=e,this.y=t,this.z=i};t.MeshInfo=function(e,t){void 0===t&&(t=!1),this.meshType=e.meshType,this.hres=e.hres,this.vres=e.vres,this.delayFormula=e.delayFormula,this.directionFormula=e.directionFormula,this.aspectRatio=e.aspectRatio,this.invertDelay=e.invertDelay,this.forward=e.forward,this.isCenterBufferReq=!!e.isCenterBufferReq||t,this.rippleType=e.m_rippleType,this.randomCenters=e.randomCenters,this.jitter=e.jitter};var o=function(){function e(){this.vertexPositions=new Float32Array,this.vertexIndices=new Uint16Array,this.textureCoords=new Float32Array,this.vertexDelays=new Float32Array,this.rippleDistanceData=new Float32Array,this.center=new Float32Array,this.directionFormulaFunc=m[13],this.delayFormulaFunc=d[0]}return e.createPositionBufferList=function(e,t){for(var i=new Float32Array((e+1)*(t+1)*3),r=0;r<t+1;r+=1)for(var n=0;n<e+1;n+=1){var a=3*(n+r*(e+1));i[a]=n/e,i[a+1]=r/t,i[a+2]=0}return i},e.calculateSmoothRippleDistance=function(e,t,i){for(var r=e.length/2,n=new Float32Array(r),a=0;a<r;a+=1){var s=2*a;n[a]=this.calculateSmoothRippleDistanceUtil(t,e[s],e[s+1],i)}return n},e.calculateSmoothRippleDistanceUtil=function(e,t,i,r){var n,a=t,o=i;switch(e){case 7:o=1-o,n=new s(1,1);break;case 6:a=1-a,o=1-o,n=new s(1,1);break;case 5:n=new s(1,1);break;case 4:a=1-a,n=new s(1,1);break;case 29:default:a-=.5,o-=.5,n=new s(.5,.5)}return.70710678/h(n.x,n.y)*h(a*=r,o)*Math.PI},e.prototype.addPolygon=function(e,t,i,r,n,s,o,l,d,h,c,u){var m=this.meshInfo;if(m){for(var p,g,_,v=0;v<e.length;v+=1){var y=3*(l*e.length+v),b=(d+e[v].x)*o/c,S=(h+e[v].y)*o/u;t[y]=b,t[y+1]=S,t[y+2]=0;var T=2*(l*e.length+v);i[T]=b,i[T+1]=S,this.delayFormulaFunc&&(p||(p=f(d/c,h/u,m.aspectRatio,m.invertDelay,m.jitter,this.delayFormulaFunc)),r[y/3]=p),m.isCenterBufferReq&&(m.randomCenters?(g&&_||(g=this.calculateCenter(d/c,h/u,m.randomCenters).x,_=this.calculateCenter(d/c,h/u,m.randomCenters).y),n[y/3*2]=g,n[y/3*2+1]=_):(n[y/3*2]=this.calculateCenter(d/c,h/u,m.randomCenters).x,n[y/3*2+1]=this.calculateCenter(d/c,h/u,m.randomCenters).y))}for(var w=0;w<e.length-2;w+=1){var M=3*(l*(e.length-2)+w),C=l*e.length;s[M]=C,s[M+1]=C+w+1,s[M+2]=C+w+2}}else a.logError("MeshInfo undefined")},e.prototype.createSquare=function(e){var t,i=e.hres,r=e.vres,n=[{x:-.5,y:.5},{x:.5,y:.5},{x:.5,y:-.5},{x:-.5,y:-.5}],a=new Float32Array(i*r*3*n.length),s=new Float32Array(i*r*2*n.length),o=new Uint16Array(i*r*3*(n.length-2)),l=new Float32Array(a.length/3);e.isCenterBufferReq&&(t=new Array(2*a.length/3));for(var d=0,h=0;h<r;h+=1)for(var c=0;c<i;c+=1)this.addPolygon(n,a,s,l,t,o,1,d,c+.5,h+.5,i,r),d+=1;this.vertexPositions=a,this.vertexIndices=o,this.textureCoords=s,this.vertexDelays=l,this.center=t},e.prototype.createRadial=function(e){for(var t=4*(e.hres+1),i=new Array(t),r=new Float32Array(2*t*3),n=new Float32Array(2*t*2),a=new Uint16Array(3*t),o=new Float32Array(2*t),l=0,d=0;d<t/4;d+=1)i[l]=new s(d/(t/4),0),l+=1;for(var h=0;h<t/4;h+=1)i[l]=new s(1,h/(t/4)),l+=1;for(d=t/4;d>0;d-=1)i[l]=new s(d/(t/4),1),l+=1;for(h=t/4;h>0;h-=1)i[l]=new s(0,h/(t/4)),l+=1;var c=0,u=0,m=0;l=0;for(var p=0,g=i;p<g.length;p++){var _=g[p];m=f(_.x,_.y,e.aspectRatio,e.invertDelay,e.jitter,this.delayFormulaFunc),o[2*l]=m,o[2*l+1]=m,r[c]=_.x,r[c+1]=_.y,r[c+2]=0,r[c+3]=.5,r[c+4]=.5,r[c+5]=0,c+=6,n[u]=_.x,n[u+1]=_.y,n[u+2]=.5,n[u+3]=.5,u+=4,l+=1}for(c=0,l=0;l<t-1;l+=1)a[c]=2*l,a[c+1]=2*l+1,a[c+2]=2*l+2,c+=3;a[c]=2*l,a[c+1]=0,a[c+2]=1,c+=3,this.vertexPositions=r,this.textureCoords=n,this.vertexIndices=a,this.vertexDelays=o},e.prototype.createSmooth=function(t){this.vertexPositions=e.createPositionBufferList(t.hres,t.vres),this.vertexIndices=e.createIndexBuffer(t.hres,t.vres),this.textureCoords=e.createTextureCoordBuffer(t.hres,t.vres),this.vertexDelays=e.calculateDelays(this.textureCoords,t.aspectRatio,t.invertDelay,t.jitter,this.delayFormulaFunc),t.rippleType&&(this.rippleDistanceData=e.calculateSmoothRippleDistance(this.textureCoords,t.rippleType,t.aspectRatio))},e.prototype.createDiamond=function(e){var t,i=[{x:-.5,y:0},{x:0,y:.5},{x:.5,y:0},{x:0,y:-.5}],r=e.hres,n=e.vres,a=(r+1)*(n+1)*2,s=new Float32Array(3*a*i.length),o=new Float32Array(2*a*i.length),l=new Uint16Array(3*a*(i.length-2)),d=new Float32Array(s.length/3);e.isCenterBufferReq&&(t=new Array(2*s.length/3));for(var h=0,c=0;c<n+1;c+=1)for(var u=0;u<r+1;u+=1)this.addPolygon(i,s,o,d,t,l,1,h,u,c,r,n),h+=1,this.addPolygon(i,s,o,d,t,l,1,h,u+.5,c+.5,r,n),h+=1;this.vertexPositions=s,this.vertexIndices=l,this.textureCoords=o,this.vertexDelays=d,this.center=t},e.prototype.createHexagon=function(e){var t,i=[{x:-.5,y:.5/3},{x:0,y:1/3},{x:.5,y:.5/3},{x:.5,y:-.5/3},{x:0,y:-1/3},{x:-.5,y:-.5/3}],r=e.hres,n=e.vres,a=r*n*2+r+n+1,s=new Float32Array(3*a*i.length),o=new Float32Array(2*a*i.length),l=new Uint16Array(3*a*(i.length-2)),d=new Float32Array(s.length/3);e.isCenterBufferReq&&(t=new Array(2*s.length/3));for(var h=0,c=0;c<n;c+=1)for(var u=0;u<r;u+=1)this.addPolygon(i,s,o,d,t,l,1,h,u,c,r,n),h+=1,this.addPolygon(i,s,o,d,t,l,1,h,u+.5,c+.5,r,n),h+=1;for(c=0;c<n;c+=1)this.addPolygon(i,s,o,d,t,l,1,h,r,c,r,n),h+=1;for(u=0;u<r+1;u+=1)this.addPolygon(i,s,o,d,t,l,1,h,u,n,r,n),h+=1;this.vertexPositions=s,this.vertexIndices=l,this.textureCoords=o,this.vertexDelays=d,this.center=t},e.prototype.initialize=function(e){switch(this.meshInfo=e,this.delayFormulaFunc=function(e){return e in d?d[e]:d[0]}(e.delayFormula),this.directionFormulaFunc=function(e){return e in m?m[e]:m[13]}(e.directionFormula),e.meshType){case 0:this.createSmooth(e);break;case 1:this.createSquare(e);break;case 2:this.createDiamond(e);break;case 3:this.createHexagon(e);break;case 4:this.createRadial(e);break;case 5:throw new Error("MeshType.LinearExplosion is not implemented yet.");default:throw new Error("Could not get meshType.")}},e.prototype.getRippleDistance=function(){return this.rippleDistanceData},e.prototype.getVertexPositions=function(){return this.vertexPositions},e.prototype.getVertexIndices=function(){return this.vertexIndices},e.prototype.getTextureCoords=function(){return this.textureCoords},e.prototype.getDelays=function(){return this.vertexDelays},e.prototype.getCenter=function(){return this.center},e.prototype.calculateCenter=function(e,t,i){var r=e,n=t;return i&&(r=2*Math.random()-.5,n=2*Math.random()-.5),new s(r,n)},e.prototype.getDirections=function(e){for(var t,i,r,n,a=e.hres,s=e.vres,o=this.getTextureCoords().length,l=new Float32Array(o),d=0,h=0;h<s;h+=1)for(var c=0;c<a;c+=1)for(var u=(t=(c+.5)/a,i=(h+.5)/s,r=Math.floor(c+.5),n=Math.floor(h+.5),(0,this.directionFormulaFunc)(t,i,r,n)),f=0;f<4;f+=1)l[d]=u.x,l[d+1]=u.y,d+=2;return l},e.createTextureCoordBuffer=function(e,t){for(var i=new Float32Array((e+1)*(t+1)*2),r=0;r<t+1;r+=1)for(var n=0;n<e+1;n+=1){var a=2*(n+r*(e+1));i[a]=n/e,i[a+1]=r/t}return i},e.calculateDelays=function(e,t,i,r,n){for(var a=e.length/2,s=new Float32Array(a),o=0;o<a;o+=1){var l=2*o;s[o]=f(e[l],e[l+1],t,i,r,n)}return s},e.createIndexBuffer=function(e,t){for(var i=new Uint16Array(e*t*6),r=0;r<t;r+=1)for(var n=0;n<e;n+=1){var a=6*(n+r*e),s=n+r*(e+1);i[a]=s,i[a+1]=s+1,i[a+2]=s+1+(e+1),i[a+3]=s,i[a+4]=s+1+(e+1),i[a+5]=s+(e+1)}return i},e.CreateSquareTextureCoordBuffer=function(e,t){for(var i=new Float32Array(e*t*2),r=0;r<t;r+=1)for(var n=0;n<e;n+=1){var a=n+r*e*2;i[a]=n/e,i[a+1]=r/t}return i},e}();t.Mesh=o;var l={},d=((r={})[0]=function(e,t,i){return 0},r[1]=function(e,t,i){return e},r[2]=function(e,t,i){return 1-t},r[3]=function(e,t,i){return 2*Math.abs(e-.5)},r[4]=function(e,t,i){return(1-e+1-t)/2},r[5]=function(e,t,i){return 2*Math.abs(e-.5)},r[6]=function(e,t,i){return 2*Math.abs(t-.5)},r[7]=function(e,t,i){return Math.abs(e-.5)+Math.abs(t-.5)},r[8]=function(e,t,i){return e>t?t<1-e?1-t:e:t<1-e?1-e:t},r[9]=function(e,t,i){var r=(e-.5)*i,n=t-.5;return l.Distance(r,n)*(1/Math.sqrt(.25+i*i/4))},r[10]=function(e,t,i){var r=Math.abs(e-.5),n=Math.abs(t-.5);return 2*(r<n?r:n)},r[11]=function(e,t,i){return u(e,t)%1},r[12]=function(e,t,i){return 2*u(e,t)%1},r[13]=function(e,t,i){return 3*u(e,t)%1},r[14]=function(e,t,i){return 4*u(e,t)%1},r[15]=function(e,t,i){return 8*u(e,t)%1},r[16]=function(e,t,i){return c(e,t)},r[17]=function(e,t,i){return 4*c(e,t)%1},r[18]=function(e,t,i){return r=e,n=t,(Math.atan2(-1*Math.abs(r-.5),.5-n)+Math.PI)/Math.PI;var r,n},r[19]=function(e,t,i){return Math.random()},r[20]=function(e,t,i){return 1.41421*l.Distance(e-.5,t-.5)},r);function h(e,t){return Math.sqrt(e*e+t*t)}function c(e,t){return(Math.atan2(e-.4999,.5-t)+Math.PI)/(2*Math.PI)}function u(e,t){return(Math.atan2(.5-e,.5-t)+Math.PI)/(2*Math.PI)}function f(e,t,i,r,n,a){var s=a(e,t,i);return r&&(s=1-s),s+Math.random()*n/100}l.Distance=function(e,t){return h(e,t)};var m=((n={})[10]=function(e,t,i,r){return new s(1&r?-1:1,0)},n[11]=function(e,t,i,r){return new s(0,1&i?-1:1)},n[13]=function(e,t,i,r){var n=p(-1,1),a=p(-1,1);return new s(n,a)},n);function p(e,t){return Math.random()*(e-t)+t}},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=i(60),o=i(62),l=i(52),d=i(132),h=s.defaultViewModelMatrix(),c=function(e){function t(t){void 0===t&&(t=!0);var i=e.call(this)||this;return i.delayDuration=0,i.style=1,i.autoClear=t,i}return n(t,e),t.prototype.internalInit=function(e){var t=this.getDrawInfo(0,[o.aPosition,o.aTexcoord,o.aDelay]);if(t)return this.delayDuration=0==e.delayFormula?0:1,this.textureInfo={incomingSlideTexture:t.incomingSlideTexture,outgoingSlideTexture:t.outgoingSlideTexture},a(a({},t),{autoClear:this.autoClear})},t.prototype.internalDraw=function(e,t,i){this.autoClear&&l.setDepthBlendCulling(i.engine);var r=e*(this.delayDuration+1/t.factor+t.jitter/100),n=l.bindDrawInfo(i);n.setFloat("uStyle",this.style),n.setMatrix("uModelViewProj",h),n.setFloat("uProgress",r),n.setFloat("uFactor",t.factor);var a=i.incomingSlideTexture,s=i.outgoingSlideTexture;return n._bindTexture("uSampler1",t.forward?s:a),n._bindTexture("uSampler2",t.forward?a:s),l.drawTriangles(i),!0},t.prototype.getTextureInfo=function(){return this.textureInfo},t}(d.Transition);t.AlphaTransition=c},function(e,t,i){"use strict";var r,n,a;i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return a})),function(e){e[e.Undefined=-1]="Undefined",e[e.InContent=0]="InContent",e[e.TaskPane=1]="TaskPane",e[e.Contextual=2]="Contextual"}(r||(r={})),function(e){e[e.Attendee=0]="Attendee",e[e.Presenter=1]="Presenter",e[e.PrivateViewing=2]="PrivateViewing"}(n||(n={})),function(e){e[e.UnifiedApp=0]="UnifiedApp",e[e.MSTeams=1]="MSTeams",e[e.TeamsiOS=2]="TeamsiOS",e[e.TeamsAndroid=3]="TeamsAndroid",e[e.Unknown=4]="Unknown"}(a||(a={}))},,,function(e,t,i){"use strict";(function(t,r){var n=i(29).Buffer,a=t.crypto||t.msCrypto;a&&a.getRandomValues?e.exports=function(e,t){if(e>4294967295)throw new RangeError("requested too many random bytes");var i=n.allocUnsafe(e);if(e>0)if(e>65536)for(var s=0;s<e;s+=65536)a.getRandomValues(i.slice(s,s+65536));else a.getRandomValues(i);return"function"==typeof t?r.nextTick((function(){t(null,i)})):i}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this,i(55),i(48))},function(e,t,i){"use strict";var r={};function n(e,t,i){i||(i=Error);var n=function(e){var i,r;function n(i,r,n){return e.call(this,function(e,i,r){return"string"==typeof t?t:t(e,i,r)}(i,r,n))||this}return r=e,(i=n).prototype=Object.create(r.prototype),i.prototype.constructor=i,i.__proto__=r,n}(i);n.prototype.name=i.name,n.prototype.code=e,r[e]=n}function a(e,t){if(Array.isArray(e)){var i=e.length;return e=e.map((function(e){return String(e)})),i>2?"one of ".concat(t," ").concat(e.slice(0,i-1).join(", "),", or ")+e[i-1]:2===i?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}n("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),n("ERR_INVALID_ARG_TYPE",(function(e,t,i){var r,n,s;if("string"==typeof t&&(n="not ",t.substr(0,n.length)===n)?(r="must not be",t=t.replace(/^not /,"")):r="must be",function(e,t,i){return(void 0===i||i>e.length)&&(i=e.length),e.substring(i-t.length,i)===t}(e," argument"))s="The ".concat(e," ").concat(r," ").concat(a(t,"type"));else{var o=function(e,t,i){return"number"!=typeof i&&(i=0),!(i+".".length>e.length)&&-1!==e.indexOf(".",i)}(e)?"property":"argument";s='The "'.concat(e,'" ').concat(o," ").concat(r," ").concat(a(t,"type"))}return s+". Received type ".concat(typeof i)}),TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=r},function(e,t,i){"use strict";(function(t){var r=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t};e.exports=d;var n=i(178),a=i(182);i(26)(d,n);for(var s=r(a.prototype),o=0;o<s.length;o++){var l=s[o];d.prototype[l]||(d.prototype[l]=a.prototype[l])}function d(e){if(!(this instanceof d))return new d(e);n.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||t.nextTick(c,this)}function c(e){e.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(d.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,i(48))},function(e,t,i){var r=i(29).Buffer;function n(e,t){this._block=r.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}n.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=r.from(e,t));for(var i=this._block,n=this._blockSize,a=e.length,s=this._len,o=0;o<a;){for(var l=s%n,d=Math.min(a-o,n-l),h=0;h<d;h++)i[l+h]=e[o+h];o+=d,(s+=d)%n==0&&this._update(i)}return this._len+=a,this},n.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var i=8*this._len;if(i<=4294967295)this._block.writeUInt32BE(i,this._blockSize-4);else{var r=(4294967295&i)>>>0,n=(i-r)/4294967296;this._block.writeUInt32BE(n,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var a=this._hash();return e?a.toString(e):a},n.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=n},function(e,t,i){"use strict";var r={};function n(e,t,i){i||(i=Error);var n=function(e){var i,r;function n(i,r,n){return e.call(this,function(e,i,r){return"string"==typeof t?t:t(e,i,r)}(i,r,n))||this}return r=e,(i=n).prototype=Object.create(r.prototype),i.prototype.constructor=i,i.__proto__=r,n}(i);n.prototype.name=i.name,n.prototype.code=e,r[e]=n}function a(e,t){if(Array.isArray(e)){var i=e.length;return e=e.map((function(e){return String(e)})),i>2?"one of ".concat(t," ").concat(e.slice(0,i-1).join(", "),", or ")+e[i-1]:2===i?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}n("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),n("ERR_INVALID_ARG_TYPE",(function(e,t,i){var r,n,s;if("string"==typeof t&&(n="not ",t.substr(0,n.length)===n)?(r="must not be",t=t.replace(/^not /,"")):r="must be",function(e,t,i){return(void 0===i||i>e.length)&&(i=e.length),e.substring(i-t.length,i)===t}(e," argument"))s="The ".concat(e," ").concat(r," ").concat(a(t,"type"));else{var o=function(e,t,i){return"number"!=typeof i&&(i=0),!(i+".".length>e.length)&&-1!==e.indexOf(".",i)}(e)?"property":"argument";s='The "'.concat(e,'" ').concat(o," ").concat(r," ").concat(a(t,"type"))}return s+". Received type ".concat(typeof i)}),TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=r},function(e,t,i){"use strict";(function(t){var r=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t};e.exports=d;var n=i(208),a=i(212);i(26)(d,n);for(var s=r(a.prototype),o=0;o<s.length;o++){var l=s[o];d.prototype[l]||(d.prototype[l]=a.prototype[l])}function d(e){if(!(this instanceof d))return new d(e);n.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||t.nextTick(c,this)}function c(e){e.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(d.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,i(48))},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(4),n=i(2),a=i(3);class s{static setVetoUtil(e,t){s.m_sessionMetadata=e,r.a.setLogger(t)}static recordVeto(e,t){if(null==t)return;const i=s.m_vetos.has(e);if(!i){const i={AppMetadata:s.m_sessionMetadata,VetoSource:e,VetoDetail:t};r.a.sendTraceTag(595645889,n.a.msoulscat_Wac_PptSession,a.a.Error,JSON.stringify(i)),s.m_vetos.set(e,t)}this.m_listeners.forEach(r=>{r(e,t,i)})}static getSessionVetos(){return s.m_vetos}static clearState(){s.m_vetos=new Map,s.m_sessionMetadata={}}static registerVetoRecordedListener(e){this.m_listeners.push(e)}static unregisterVetoRecordedListener(e){this.m_listeners=this.m_listeners.filter(t=>t!==e)}}s.m_vetos=new Map,s.m_sessionMetadata={},s.m_listeners=[]},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(4),n=i(2),a=i(3);class s{static recordUserAction(e){null!=e&&null!=e.actionName&&(r.a.sendTraceTag(571012809,n.a.msoulscat_Wac_PptSession,a.a.Error,`User Action name:${e.actionName}, durationMs:${e.durationMs}, succeeded:${e.succeeded}`),this.m_actions.push(e),this.m_listeners.forEach(t=>{t(e)}))}static getUserActions(){return s.m_actions}static registerUserActionListener(e){this.m_listeners.push(e)}static unregisterUserActionListener(e){this.m_listeners=this.m_listeners.filter(t=>t!==e)}static clearState(){s.m_actions=[],s.m_listeners=[]}}s.m_actions=[],s.m_listeners=[]},function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){return a}));class r{constructor(e,t,i,r){this.m_id=e,this.m_version=t,this.m_store=i,this.m_storeType=r}get Id(){return this.m_id}get Version(){return this.m_version}get Store(){return this.m_store}get StoreType(){return this.m_storeType}}class n{constructor(e,t,i,r,n,a){this.m_osfControlType=e,this.m_id=t,this.m_top=i,this.m_left=r,this.m_width=n,this.m_height=a}get OsfControlType(){return this.m_osfControlType}get Id(){return this.m_id}get Top(){return this.m_top}get Left(){return this.m_left}get Width(){return this.m_width}get Height(){return this.m_height}}class a{constructor(e,t,i,r){this.m_appForOfficeRef=e,this.m_instanceId=t,this.m_shape=i,this.m_settings=r}get AppForOfficeRef(){return this.m_appForOfficeRef}get InstanceId(){return this.m_instanceId}get Shape(){return this.m_shape}get Settings(){return this.m_settings}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return lt}));var r=i(4),n=i(2),a=i(3),s=i(25),o=i(27),l=i(1);class d{constructor(e,t,i,r,n,a){this.shapeType=0,this.fPrepared=!1,this.animatableContentViewElements=[],this.id=e.id,this.m_emuToPixelScale=i,this.m_shapeViewData=t,this.m_slideEvents=r,this.m_environment=n,this.m_shapeItem=a&&a.item||void 0}ensure(){return this.m_shapeItem||this.init(),this.m_shapeItem?o.a.attachTextures(this.m_environment,this.m_shapeItem,this.m_shapeViewData,{shapeId:this.id}):(r.a.sendTraceTag(595621973,n.a.msoulscat_Wac_PptSession,a.a.Error,"ShapeViewElement::ensureTexture: invalid shapeItem."),{invalidShape:!0})}init(){this.animatableContentViewElements=[],this.m_shapeItem=o.a.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment)}getAnimatableContentIdFromClickTarget(e){return e.action?e.action.animatableContentId:e.animation?e.animation.animatableContentId:e.hyperlink?e.hyperlink.animatableContentId:e.zoom?e.zoom.animatableContentId:void 0}getAllZoomsOnShape(){const e=[];if(this.m_shapeViewData&&this.m_shapeViewData.clickTargets)for(const[t,i]of this.m_shapeViewData.clickTargets.entries())i.zoom&&e.push(i.zoom);return e}ensureClickTarget(){if(this.m_shapeViewData.clickTargets&&!document.getElementById(`${s.b.SlideLevelHtmlElementsDivId}-${JSON.stringify(this.id)}`))for(const[e,t]of this.m_shapeViewData.clickTargets.entries()){const i=this.getAnimatableContentIdFromClickTarget(t),r=this.m_shapeViewData.animatableContents.find(e=>e.id===i);if(!r)return;const n=r.parts[0].regionPos.pos;if(t.action){const i=t.action,r=this.ensureClickTargetDiv(),a=document.createElement("a");a.tabIndex=0,a.onkeydown=e=>{e&&e.key&&"enter"===e.key.toLowerCase()&&(this.m_slideEvents.emit("clickTarget-gotoSlide",i.slideId),e.stopImmediatePropagation())},a.style.pointerEvents="auto",a.style.background="none",a.style.border="none",a.style.padding="0",a.style.cursor="pointer",a.title="",a.id=`sp-${JSON.stringify(this.id)}-i-${e}`,a.onclick=()=>{this.m_slideEvents.emit("clickTarget-gotoSlide",i.slideId)},l.Settings.readBooleanOrDefault("hackClickTargets",!1)&&(a.style.backgroundColor="rgba(0,0,0,0.5)"),r.appendChild(a),o.a.setClickTargetRegion(a,i.region,n)}if(t.hyperlink){const i=t.hyperlink;if(!d.hasValidProtocol(i.url))continue;const r=this.ensureClickTargetDiv(),a="http://www.w3.org/2000/svg",s=document.createElementNS(a,"a");s.style.pointerEvents="auto",s.setAttributeNS(null,"href",i.url),s.setAttributeNS(null,"rel","noreferrer"),s.setAttributeNS(null,"target","_blank");const h=i.tip?i.tip:i.url;s.setAttributeNS(null,"title",h),s.textContent=i.desc?i.desc:i.url,s.style.color="rgba(0,0,0,0)",l.Settings.readBooleanOrDefault("stopPropagationForKeyDown",!0)&&(s.onkeydown=e=>{e&&e.key&&"enter"===e.key.toLowerCase()&&e.stopImmediatePropagation()});const c=document.createElementNS(a,"title");c.textContent=h,s.appendChild(c);for(const e of i.subRegions){const t=document.createElementNS(a,"rect");t.setAttributeNS(null,"x",(e.left-i.region.left).toString()),t.setAttributeNS(null,"y",(e.top-i.region.top).toString()),t.setAttributeNS(null,"height",(e.bottom-e.top).toString()),t.setAttributeNS(null,"width",(e.right-e.left).toString()),t.setAttributeNS(null,"fill-opacity","0"),s.appendChild(t)}const u=document.createElementNS(a,"svg");u.id=`sp-${JSON.stringify(this.id)}-i-${e}`,u.setAttribute("role","presentation"),u.classList.add("svm-interactive-element-focus-class"),u.setAttributeNS(null,"viewbox",`${i.region.left} ${i.region.top} ${(i.region.right-i.region.left).toString()} ${(i.region.bottom-i.region.top).toString()}`),l.Settings.readBooleanOrDefault("hackClickTargets",!1)&&(u.style.backgroundColor="rgba(0,0,0,0.5)"),u.appendChild(s),r.appendChild(u),o.a.setClickTargetRegion(u,i.region,n)}if(t.zoom){const i=t.zoom,r=this.ensureClickTargetDiv(),a=document.createElement("a");a.tabIndex=0,a.onkeydown=e=>{if(e&&e.key&&"enter"===e.key.toLowerCase()){if(0===i.type){const e={slideId:i.slideId,returnToParent:i.returnToParent};this.m_slideEvents.emit("clickTarget-gotoZoomSlide",e)}else if(1===i.type){const e={sectionId:i.sectionId,returnToParent:i.returnToParent};this.m_slideEvents.emit("clickTarget-gotoZoomSection",e)}e.stopImmediatePropagation()}},a.style.pointerEvents="auto",a.style.background="none",a.style.border="none",a.style.padding="0",a.style.cursor="pointer",a.title="",a.id=`sp-${JSON.stringify(this.id)}-i-${e}`,a.onclick=()=>{const e={slideId:i.slideId,returnToParent:i.returnToParent};if(0===i.type)this.m_slideEvents.emit("clickTarget-gotoZoomSlide",e);else if(1===i.type){const e={sectionId:i.sectionId,returnToParent:i.returnToParent};this.m_slideEvents.emit("clickTarget-gotoZoomSection",e)}},l.Settings.readBooleanOrDefault("hackClickTargets",!1)&&(a.style.backgroundColor="rgba(0,0,0,0.5)"),r.appendChild(a),o.a.setClickTargetRegion(a,i.region,n)}if(t.animation){const i=t.animation,r=this.ensureClickTargetDiv(),a=document.createElement("a");a.tabIndex=0,a.onkeydown=e=>{e&&e.key&&"enter"===e.key.toLowerCase()&&(this.m_slideEvents.emit("clickTarget-interactiveAnimation",i.sequenceId),e.stopImmediatePropagation())},a.style.pointerEvents="auto",a.style.background="none",a.style.border="none",a.style.padding="0",a.style.cursor="pointer",a.title="",a.id=`sp-${JSON.stringify(this.id)}-i-${e}`,a.onclick=()=>{this.m_slideEvents.emit("clickTarget-interactiveAnimation",i.sequenceId)},l.Settings.readBooleanOrDefault("hackClickTargets",!1)&&(a.style.backgroundColor="rgba(0,0,0,0.5)"),r.appendChild(a),o.a.setClickTargetRegion(a,i.region,n)}}}ensureClickTargetDiv(){const e=o.a.ensureShapeViewElementParentDiv(this.id,"2");return e.style.pointerEvents="none",e}update(){this.ensureClickTarget(),o.a.ensureAccessibilityElement(this.id)}applyAnimation(e){this.m_shapeItem&&o.a.applyAnimationToShapeItemAndClickTarget(e,this.m_shapeItem,this.m_shapeViewData)}tryPrepare(e){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,e),this.m_environment.rendererEnvironment.flush()),this.fPrepared}addToScene(e){this.m_shapeItem&&e.items.push(this.m_shapeItem)}removeFromScene(e){if(this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)){const t=e.items.elements.slice(0);t.splice(e.items.elements.indexOf(this.m_shapeItem),1),e.setItems(t)}}cleanUp(){}get shapeItem(){return this.m_shapeItem}static hasValidProtocol(e){try{return["http:","https:","mailto:","ftp:","file:","news:","tel:","onenote:","notes:","mms:","mssv:","bookmark:"].includes(new URL(e).protocol)}catch(e){}return!1}}var h=i(0),c=i(7),u=i(11),f=i(23),m=i(31),p=i(8),g=i(12),_=i(137);class v{constructor(e,t,i,s){if(this.shapeType=4,this.fPrepared=!1,this.animatableContentViewElements=[],this.m_supportedFormats=["RGBA","BGRA","NV12"],this.onCameoSharedTextureUpdated=e=>{this.m_frameSize&&this.m_frameSize.equals(e)||(this.m_frameSize=e,this.maintainAspectRatio()),this.attachSharedTextureToShapeImage(),this.restoreLineBrushIfNeeded()},this.onCameoSharedTextureReleased=()=>{this.clearLineBrush()},this.id=e.id,this.m_emuToPixelScale=i,this.m_shapeViewData=t,this.m_environment=s,this.m_cameoTextureManager=_.a.getInstance(this.m_environment),!t.cameo)throw r.a.sendTraceTag(544024275,n.a.msoulscat_Wac_PptSession,a.a.Error,`CameoViewElement:: Invalid shapeViewData. cameo:${!!t.cameo}.`),g.VetoUtils.recordVeto("CameoNotRendering",{errorName:"ShapeViewDataMissing",qosVeto:"CameoNotRendering"}),new Error("Invalid cameo");this.m_backgroundProps=t.cameo.backgroundProps;const o=this.m_environment.settings.uiHost;this.m_fTeams=null!=o&&-1!==o.toLowerCase().indexOf("teams");const d=this.m_shapeViewData.animatableContents[0].parts[0].regionPos;this.m_size=new p.b(d.region.rect.right-d.region.rect.left,d.region.rect.bottom-d.region.rect.top),!l.Settings.readBooleanOrDefault("forceSvg",!1)&&this.m_environment.rendererEnvironment.glContext||r.a.sendTraceTag(529078227,n.a.msoulscat_Wac_PptSession,a.a.Warning,"CameoViewElement::ctor: in SVG fallback"),r.a.sendTraceTag(544024276,n.a.msoulscat_Wac_PptSession,a.a.Info,"CameoViewElement ctor: "+JSON.stringify(this.getCameoDataLog("CameoViewElement::ctor")))}ensure(){this.m_shapeItem||this.init();const e={};return this.m_shapeItem?{...e}:(r.a.sendTraceTag(544024277,n.a.msoulscat_Wac_PptSession,a.a.Error,"CameoViewElement::ensure: invalid shapeItem."),g.VetoUtils.recordVeto("CameoNotRendering",{errorName:"FailedShapeItemInit",qosVeto:"CameoNotRendering"}),e.invalidShape=!0,e)}ensureCameoTextureAttached(){this.attachSharedTextureToShapeImage()}init(){if(this.animatableContentViewElements=[],this.m_shapeItem=o.a.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment),this.isFallbackCameoBrush()&&(r.a.sendTraceTag(527447241,n.a.msoulscat_Wac_PptSession,a.a.Warning,"CameoViewElement::init: Cameo in FillBrush fallback"),g.VetoUtils.recordVeto("CameoRenderedWithIssues",{errorName:"CameoFillBrushFallback",qosVeto:"CameoRenderedWithIssues"})),this.m_originalLineBrush=this.getLineBrush(),this.clearLineBrush(),this.m_originalScale&&this.m_originalOffset||(this.m_originalScale=this.getImageBrushScale(),this.m_originalOffset=this.getImageBrushOffset(),r.a.sendTraceTag(527246537,n.a.msoulscat_Wac_PptSession,a.a.Info,`CameoViewElement::init: originalBrushScale=${this.getFormattedVectorString(this.m_originalScale)}, originalBrushOffset=${this.getFormattedVectorString(this.m_originalOffset)}`)),this.setAlphaInvariant(),this.m_shapeItem){let e;if(this.m_shapeItem.transform&&0!==this.m_shapeItem.transform.rotation){const t=this.m_shapeItem.transform.toInverseMatrix3().tryGetTransform(this.m_shapeItem.transform.preTranslation);t||(r.a.sendTraceTag(526952522,n.a.msoulscat_Wac_PptSession,a.a.Warning,"CameoViewElement::init: element is rotated but failed to grab inverse transform. Aspect ratio adjustment may be incorrect!"),g.VetoUtils.recordVeto("CameoRenderedWithIssues",{errorName:"AspectRatioForRotatedCameo",qosVeto:"CameoRenderedWithIssues"})),e=this.m_shapeItem.getBounds(!1,!1,!1,t)}else e=this.m_shapeItem.getBounds(!1,!1,!1);if(e){const t=e.width,i=e.height;this.isCropped()&&this.m_originalScale?this.m_size=new p.b(t*this.m_originalScale.x,i*this.m_originalScale.y):this.m_size=new p.b(t,i)}}this.ensureCameoTextureAttached()}update(){}applyAnimation(e){this.m_shapeItem&&o.a.applyAnimationToShapeItemAndClickTarget(e,this.m_shapeItem,this.m_shapeViewData)}addToScene(e){this.m_shapeItem&&e.items.push(this.m_shapeItem),this.m_cameoTextureManager.events.on("cameoSharedTextureUpdated",this.onCameoSharedTextureUpdated),this.m_cameoTextureManager.events.on("cameoSharedTextureReleased",this.onCameoSharedTextureReleased),this.m_cameoTextureManager.subscribeToSharedTexture()}removeFromScene(e){this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)&&o.a.removeFromScene(e,this.m_shapeItem),this.m_cameoTextureManager.events.off("cameoSharedTextureUpdated",this.onCameoSharedTextureUpdated),this.m_cameoTextureManager.events.off("cameoSharedTextureReleased",this.onCameoSharedTextureReleased),this.m_cameoTextureManager.unsubscribeFromSharedTexture(),this.clearLineBrush()}tryPrepare(){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,5),this.m_environment.rendererEnvironment.flush()),this.fPrepared}cleanUp(){}get shapeItem(){return this.m_shapeItem}getCameoInfo(){return{m_cameoId:o.a.generateShapeIdString(this.id),m_heightInPixels:this.m_size.y,m_widthInPixels:this.m_size.x,m_formats:this.m_supportedFormats,m_backgroundType:this.m_backgroundProps.backgroundType}}attachSharedTextureToShapeImage(){if(this.m_shapeItem&&this.m_cameoTextureManager.cameoSharedTexture)for(const e of this.m_shapeItem.getBrushImages())e.id&&(this.m_environment.rendererEnvironment.renderer.attachTextureToImage(e,this.m_cameoTextureManager.cameoSharedTexture),this.m_cameoTextureManager.cameoSharedTexture.changeTracker.notifyChange());else r.a.sendTraceTag(526987918,n.a.msoulscat_Wac_PptSession,a.a.Error,`CameoViewElement::attachSharedTextureToShapeImage: Unexpectedly ShapeItem:${!!this.m_shapeItem} or CameoSharedTexture:${!!this.m_cameoTextureManager.cameoSharedTexture} is undefined`)}getCameoDataLog(e){return{id:JSON.stringify(this.id),fTeams:this.m_fTeams,backgroundType:this.m_backgroundProps.backgroundType,msg:e}}isFallbackCameoBrush(){if(this.m_shapeItem&&this.m_shapeItem instanceof u.e){const e=this.m_shapeItem;if(e.style&&e.style.fillBrush&&e.style.fillBrush instanceof c.e&&!e.style.pictureBrush)return!0}return!1}isCropped(){return!(!this.m_originalScale||!this.m_originalOffset||1===this.m_originalScale.x&&1===this.m_originalScale.y&&0===this.m_originalOffset.x&&0===this.m_originalOffset.y)}setAlphaInvariant(){if(1===this.m_backgroundProps.backgroundType)return;const e=this.getImageBrush();e&&(e.isAlphaInvariant=!0,r.a.sendTraceTag(527251170,n.a.msoulscat_Wac_PptSession,a.a.Info,"CameoViewElement::setAlphaInvariant: Successfully set isAlphaInvariant"))}getImageBrush(){if(this.m_shapeItem&&this.m_shapeItem instanceof u.e){const e=this.m_shapeItem;if(e.style&&e.style.pictureBrush&&e.style.pictureBrush instanceof c.e)return e.style.pictureBrush}r.a.sendTraceTag(527246538,n.a.msoulscat_Wac_PptSession,a.a.Warning,"CameoViewElement::getImageBrush: failed to grab ImageBrush (picture)")}getImageBrushOffset(){const e=this.getImageBrush();return e&&e.offset?new p.b(e.offset.x,e.offset.y):new p.b(0,0)}getImageBrushScale(){const e=this.getImageBrush();return e&&e.scale?new p.b(e.scale.x,e.scale.y):new p.b(1,1)}getLineBrush(){if(this.m_shapeItem&&this.m_shapeItem instanceof u.e){const e=this.m_shapeItem;if(e.style&&e.style.lineBrush)return e.style.lineBrush}}clearLineBrush(){if(this.m_shapeItem&&this.m_shapeItem instanceof u.e){const e=this.m_shapeItem;e.style&&e.style.lineBrush&&(e.style.lineBrush=void 0)}}restoreLineBrushIfNeeded(){if(this.m_shapeItem&&this.m_shapeItem instanceof u.e){const e=this.m_shapeItem;this.m_originalLineBrush&&e.style&&!e.style.lineBrush&&(e.style.lineBrush=this.m_originalLineBrush)}}getFormattedVectorString(e){return e?`[x:${e.x.toFixed(4)}, y:${e.y.toFixed(4)}]`:"undefined"}maintainAspectRatio(){if(this.m_size&&this.m_frameSize){const e=this.m_frameSize.x,t=this.m_frameSize.y,i=this.m_size.x,s=this.m_size.y,o=this.getImageBrush();if(r.a.sendTraceTag(526770845,n.a.msoulscat_Wac_PptSession,a.a.Info,`CameoViewElement::maintainAspectRatio: Frame Size(WxH)=${e}x${t}.`),o&&o.scale&&o.offset&&0!==s&&0!==i&&0!==t&&0!==e){const l=i/s,d=e/t;if(l===d)return;r.a.sendTraceTag(527246539,n.a.msoulscat_Wac_PptSession,a.a.Info,`CameoViewElement::maintainAspectRatio: Started aspect ratio adjustment - frameAspectRatio=[${d.toFixed(6)}], shapeAspectRatio=[${l.toFixed(6)}], scale=${this.getFormattedVectorString(o.scale)}, offset=${this.getFormattedVectorString(o.offset)}`),o.alignment=4;let h=0,c=0;if(l>d?(c=i,h=t/e*i):(h=s,c=e/t*s),this.isCropped()){r.a.sendTraceTag(527246540,n.a.msoulscat_Wac_PptSession,a.a.Info,"CameoViewElement::maintainAspectRatio: crop detected - new offset will be calculated"),o.alignment=0;const e=(c-i)/2,t=(h-s)/2;if(this.m_originalOffset&&this.m_originalScale){const r=e*this.m_originalScale.x/i,n=t*this.m_originalScale.y/s,a=new p.b(this.m_originalOffset.x-r,this.m_originalOffset.y-n);o.offset=a}}const u=c/i,f=h/s;if(this.m_originalScale){const e=new p.b(this.m_originalScale.x*u,this.m_originalScale.y*f);o.scale=e}r.a.sendTraceTag(528767181,n.a.msoulscat_Wac_PptSession,a.a.Info,`CameoViewElement::maintainAspectRatio: Completed aspect ratio adjustment - scale=${this.getFormattedVectorString(o.scale)}, offset=${this.getFormattedVectorString(o.offset)}`)}}}}var y,b=i(15),S=new Uint8Array(16);function T(){if(!y&&!(y="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return y(S)}for(var w=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,M=function(e){return"string"==typeof e&&w.test(e)},C=[],I=0;I<256;++I)C.push((I+256).toString(16).substr(1));var P=function(e,t,i){var r=(e=e||{}).random||(e.rng||T)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){i=i||0;for(var n=0;n<16;++n)t[i+n]=r[n];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(C[e[t+0]]+C[e[t+1]]+C[e[t+2]]+C[e[t+3]]+"-"+C[e[t+4]]+C[e[t+5]]+"-"+C[e[t+6]]+C[e[t+7]]+"-"+C[e[t+8]]+C[e[t+9]]+"-"+C[e[t+10]]+C[e[t+11]]+C[e[t+12]]+C[e[t+13]]+C[e[t+14]]+C[e[t+15]]).toLowerCase();if(!M(i))throw TypeError("Stringified UUID is invalid");return i}(r)},E=i(9);class x{constructor(e,t){this.totalPlayingTime=0,this.providerName="Other",this.correlationId=P(),this.isPlaying=!1,this.isFirstReady=!0,this.slowPlayVetoThreshold=11500,this.notYetPlayedVetoThreshold=11500,this.creationTime=Date.now(),this.appSettings=e,this.onVetoCallback=t,void 0!==this.appSettings.SlowPlayVetoThreshold&&(this.slowPlayVetoThreshold=this.appSettings.SlowPlayVetoThreshold),void 0!==this.appSettings.NotYetPlayedVetoThreshold&&(this.notYetPlayedVetoThreshold=this.appSettings.NotYetPlayedVetoThreshold)}onReady(){this.logEvent("ready"),this.isFirstReady&&(this.isFirstReady=!1,this.timeToInteractivity=Date.now(),this.timeToFirstPlay=void 0,this.timeToFirstPlaying=void 0)}onPlay(){this.logEvent("play"),this.lastPlayTime=Date.now(),void 0===this.timeToFirstPlay&&(this.timeToFirstPlay=Date.now()),this.lastPlayingTime=void 0}onPlaying(){if(this.logEvent("playing"),void 0===this.timeToFirstPlaying&&(this.timeToFirstPlaying=Date.now(),void 0!==this.timeToFirstPlayIntent)){this.clearVideoNotPlayedTimeout();const e=this.timeToFirstPlaying-this.timeToFirstPlayIntent;e>this.slowPlayVetoThreshold&&this.onSlowPerfError("VideoPlayedSlow",`Video played after ${e} ms`)}this.isPlaying=!0,this.setTimeSincePlay(),this.calculateBufferingTime(),this.lastPlayTime=void 0,void 0===this.lastPlayingTime&&(this.lastPlayingTime=Date.now())}onPause(){this.logEvent("pause"),this.isPlaying=!1,this.setTimeSincePlay(),this.lastPlayTime=void 0,this.calculatePlayingTime()}onEnded(){this.logEvent("ended"),this.isPlaying=!1,this.playedUntilEnd=!0,this.calculatePlayingTime()}onSeeking(){this.logEvent("seeking"),this.setTimeSinceSeek(),this.lastSeekTime=Date.now()}onSeeked(){this.logEvent("seeked"),this.setTimeSinceSeek(),this.lastSeekTime=void 0}onVolumeChanged(e){this.logEvent("volumeChanged"),this.volume=e}onMuteChanged(e){this.logEvent("muteChanged"),this.isMuted=e}onBuffering(){this.logEvent("buffering"),this.isPlaying=!1,this.calculatePlayingTime(),void 0===this.lastBufferTime&&(this.lastBufferTime=Date.now())}onInit(){void 0===this.timeToInit&&(this.timeToInit=Date.now())}onHubbleTokenSet(){void 0===this.timeToHubbleToken&&(this.timeToHubbleToken=Date.now())}onOEmbedResponse(){void 0===this.timeToOEmbedResponse&&(this.timeToOEmbedResponse=Date.now())}onNavigatedToEmbedPage(){void 0===this.timeToNavigatedToEmbedPage&&(this.timeToNavigatedToEmbedPage=Date.now())}onPostMessagingInitialized(){void 0===this.timeToPostMessagingInitialized&&(this.timeToPostMessagingInitialized=Date.now())}onODSPVideoLoad(e){void 0===this.timeToODSPVideoLoadStart&&(this.timeToODSPVideoLoadStart=Date.now()-e)}onError(e,t=!1){this.logEvent("error");const i="Stream2"===this.providerName?"Stream2":"Online";let r=i+"VideoError";this.isPlaying?r=i+"VideoErrorWhilePlaying":void 0!==this.timeToFirstPlaying?r=i+"VideoErrorAfterPlaying":"Stream2"===this.providerName&&(e.indexOf("status: 403")>-1?r="Stream2VideoAuthenticationError":(e.indexOf("status: 429")>-1||e.indexOf("status: 408")>-1||e.indexOf("status: 503")>-1)&&(r="Stream2VideoRedemptionStormError"));const n=e.replace(/(?:https?|ftp):\/\/[\S]+/g,"[URL]");E.a.error(508843611,"Online video raised error: "+JSON.stringify({isCritical:t,app:this.appSettings.App,hostView:this.appSettings.hostView,name:r,message:n,provider:this.providerName,correlationId:this.correlationId}));const a=t?1:3;(void 0===this.error||a<=this.error.severity)&&(this.error={severity:a,name:r,message:n,timestamp:Date.now()}),t&&(this.clearVideoNotPlayedTimeout(),void 0===this.timeToFirstPlayIntent&&void 0===this.timeToInteractivity||this.sendVeto(i+"MediaPlaybackFailure",this.error.name,this.error.message))}onPlayCommand(){if(void 0===this.timeToFirstPlaying&&void 0===this.timeToFirstPlayIntent){if(this.timeToFirstPlayIntent=Date.now(),void 0!==this.error&&1===this.error.severity){const e="Stream2"===this.providerName?"Stream2":"Online";return void this.sendVeto(e+"MediaPlaybackFailure",this.error.name,this.error.message)}if("Other"===this.providerName||"Ted"===this.providerName||"SlideShare"===this.providerName)return;this.videoNotYetPlayedTimeout=window.setTimeout(()=>{this.videoNotYetPlayedTimeout=void 0,void 0===this.timeToFirstPlaying&&this.onSlowPerfError("VideoNotYetPlayed",`Video hasn't played after ${this.notYetPlayedVetoThreshold} ms`)},this.notYetPlayedVetoThreshold)}}onPauseCommand(){void 0===this.timeToFirstPlaying&&void 0!==this.timeToFirstPlayIntent&&(this.timeToFirstPlayIntent=void 0,this.clearVideoNotPlayedTimeout())}onStopCommand(){void 0===this.timeToFirstPlaying&&void 0!==this.timeToFirstPlayIntent&&(this.timeToFirstPlayIntent=void 0,this.clearVideoNotPlayedTimeout())}setCreationTime(){this.creationTime=Date.now()}setProviderName(e){this.providerName=e}setDuration(e){this.duration=e}setVolume(e){this.volume=e}setMute(e){this.isMuted=e}cleanup(){this.timeToInit=void 0,this.timeToHubbleToken=void 0,this.timeToOEmbedResponse=void 0,this.timeToNavigatedToEmbedPage=void 0,this.timeToPostMessagingInitialized=void 0,this.timeToODSPVideoLoadStart=void 0,this.timeToInteractivity=void 0,this.timeToFirstPlayIntent=void 0,this.timeToFirstPlay=void 0,this.timeToFirstPlaying=void 0,this.lastBufferTime=void 0,this.lastSeekTime=void 0,this.lastPlayTime=void 0,this.lastPlayingTime=void 0,this.totalPlayingTime=0,this.totalBufferingTime=void 0,this.maxTimeSincePlay=void 0,this.maxTimeSinceSeek=void 0,this.playedUntilEnd=void 0,this.volume=void 0,this.isMuted=void 0,this.isPlaying=!1,this.isFirstReady=!0,this.error=void 0,this.wasVetoLogged=void 0,this.correlationId=P(),this.clearVideoNotPlayedTimeout()}getCorrelationId(){return this.correlationId}getPerfData(){var e,t,i;return this.calculatePlayingTime(),this.calculateBufferingTime(),{correlationId:this.correlationId,creationTime:this.creationTime,providerName:this.providerName,timeToInit:this.timeToInit,timeToHubbleToken:this.timeToHubbleToken,timeToOEmbedResponse:this.timeToOEmbedResponse,timeToNavigatedToEmbedPage:this.timeToNavigatedToEmbedPage,timeToPostMessagingInitialized:this.timeToPostMessagingInitialized,timeToODSPVideoLoadStart:this.timeToODSPVideoLoadStart,timeToInteractivity:this.timeToInteractivity,timeToFirstPlayIntent:this.timeToFirstPlayIntent,timeToFirstPlay:this.timeToFirstPlay,timeToFirstPlaying:this.timeToFirstPlaying,timeToError:null===(e=this.error)||void 0===e?void 0:e.timestamp,lastBufferTime:this.lastBufferTime,lastSeekTime:this.lastSeekTime,lastPlayTime:this.lastPlayTime,lastPlayingTime:this.lastPlayingTime,totalPlayingTime:this.totalPlayingTime,totalBufferingTime:this.totalBufferingTime,maxTimeSincePlay:this.maxTimeSincePlay,maxTimeSinceSeek:this.maxTimeSinceSeek,currentTimeSincePlay:this.setTimeSincePlay(),currentTimeSinceSeek:this.setTimeSinceSeek(),duration:this.duration,wasPlayedUntilEnd:this.playedUntilEnd,lastVolume:this.volume,lastMuteState:this.isMuted,isPlaying:this.isPlaying,errorName:null===(t=this.error)||void 0===t?void 0:t.name,errorMessage:null===(i=this.error)||void 0===i?void 0:i.message,wasVetoLogged:this.wasVetoLogged}}onSlowPerfError(e,t){const i="Stream2"===this.providerName?"Stream2":"Online",r=i+e;E.a.error(508699337,"Online video slow perf: "+JSON.stringify({name:r,message:t,app:this.appSettings.App,hostView:this.appSettings.hostView,provider:this.providerName,correlationId:this.correlationId})),(void 0===this.error||2<=this.error.severity)&&(this.error={name:r,severity:2,message:t,timestamp:Date.now()}),this.sendVeto(i+"MediaPerfSlow",r,t)}clearVideoNotPlayedTimeout(){void 0!==this.videoNotYetPlayedTimeout&&(window.clearTimeout(this.videoNotYetPlayedTimeout),this.videoNotYetPlayedTimeout=void 0)}setTimeSincePlay(){if(void 0===this.lastPlayTime)return;const e=Date.now()-this.lastPlayTime;return this.maxTimeSincePlay=void 0!==this.maxTimeSincePlay?Math.max(this.maxTimeSincePlay,e):e,e}setTimeSinceSeek(){if(void 0===this.lastSeekTime)return;const e=Date.now()-this.lastSeekTime;return this.maxTimeSinceSeek=void 0!==this.maxTimeSinceSeek?Math.max(this.maxTimeSinceSeek,e):e,e}calculateBufferingTime(){if(void 0!==this.lastBufferTime){const e=Date.now()-this.lastBufferTime;void 0===this.totalBufferingTime&&(this.totalBufferingTime=0),this.totalBufferingTime+=e,this.lastBufferTime=void 0}}calculatePlayingTime(){if(void 0!==this.lastPlayingTime){const e=Date.now()-this.lastPlayingTime;this.totalPlayingTime+=e,this.lastPlayingTime=void 0}}sendVeto(e,t,i){this.wasVetoLogged=!0,void 0!==this.onVetoCallback&&this.onVetoCallback(e,t,i,this.correlationId)}logEvent(e){E.a.info(527983830,"Online video emitted event: "+JSON.stringify({event:e,provider:this.providerName,correlationId:this.correlationId}))}}var A=i(28),k=i(13);class R extends Error{constructor(e,t){super(t),this.statusCode=e}}function O(e){for(const[t,i]of Object.entries(k.y))for(const r of i)if(new RegExp(r).test(e))return t;E.a.error(512271065,"Error getting provider name from URL (scheme not found in ONLINE_PROVIDER_URL_SCHEMES)")}var L=i(47);function F(e){Object(L.a)(e,{zIndex:""+k.J,pointerEvents:"all",position:"absolute",objectFit:"fill",height:"100%",width:"100%"})}class D{constructor(e,t,i,r){var n,a;this.url=e,this.iFrame=document.createElement("iframe"),this.perfTracker=i,this.playbackTracker=r,this.iFrame.src=e,this.iFrame.setAttribute("frameBorder","0"),this.iFrame.setAttribute("allow","autoplay"),F(this.iFrame),null===(n=this.perfTracker)||void 0===n||n.onInit(),null===(a=this.playbackTracker)||void 0===a||a.onSourceSet(),this.iFrame.addEventListener("load",()=>{null!==this.iFrame.contentWindow&&this.iFrame.contentWindow.focus()}),t.appendChild(this.iFrame)}play(){""===this.iFrame.src&&(this.iFrame.src=this.url),this.setFocus()}pause(){}stop(){this.iFrame.src=""}togglePause(){}setVisible(){this.iFrame.style.visibility="visible"}setHidden(){this.iFrame.style.visibility="hidden"}getPlayer(){return this.iFrame}getCurrentTime(){}getDuration(){}getPerfData(){return void 0!==this.perfTracker?this.perfTracker.getPerfData():void 0}getPlaybackData(){return void 0!==this.playbackTracker?this.playbackTracker.getPlaybackData():void 0}seekTo(e){}ensureMediaClient(){var e,t,i,r;null===(e=this.perfTracker)||void 0===e||e.cleanup(),null===(t=this.playbackTracker)||void 0===t||t.cleanup(),null===(i=this.perfTracker)||void 0===i||i.onInit(),null===(r=this.playbackTracker)||void 0===r||r.onSourceSet()}cleanUpMediaClient(){var e,t;null===(e=this.perfTracker)||void 0===e||e.cleanup(),null===(t=this.playbackTracker)||void 0===t||t.cleanup()}setFocus(){null!==this.iFrame.contentWindow&&this.iFrame.contentWindow.focus()}}class B{constructor(e,t,i,r,n,a){this.paused=!0,this.currentTime=0,this.isFirstReady=!0,this.onMessage=e=>{e.origin===this.url.origin&&void 0!==this.flipIFrame&&this.flipIFrame.contentWindow===e.source&&(this.handlePlayerEvent(e),void 0!==this.perfTracker&&this.capturePlayerPerf(e),void 0!==this.playbackTracker&&this.capturePlaybackTelemetry(e))},this.url=new URL(e),this.parent=t,this.perfTracker=i,this.playbackTracker=r,this.onReadyCallback=n,this.onMediaEventCallback=a,this.url.searchParams.set("options","messaging");try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Flip video client: "+e.message,!0)}}play(){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-play",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}}pause(){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-pause",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}}stop(){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-stop",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}}togglePause(){this.paused?this.play():this.pause()}setVisible(){void 0!==this.flipIFrame&&(this.flipIFrame.style.visibility="visible")}setHidden(){void 0!==this.flipIFrame&&(this.flipIFrame.style.visibility="hidden")}getPlayer(){return this.flipIFrame}getCurrentTime(){return this.currentTime}getDuration(){return this.duration}seekTo(e){if(void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const t=this.getMessage("fg-wvp-seek",{time:e});this.flipIFrame.contentWindow.postMessage(t,this.url.origin)}}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}isPaused(){return this.paused}cleanUpMediaClient(){void 0!==this.flipIFrame&&this.flipIFrame.remove(),this.paused=!0,this.currentTime=0,this.isFirstReady=!0,this.flipIFrame=void 0,window.removeEventListener("message",this.onMessage),void 0!==this.perfTracker&&this.perfTracker.cleanup(),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}getPerfData(){if(void 0!==this.perfTracker)return this.perfTracker.getPerfData()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}init(){var e,t;null===(e=this.perfTracker)||void 0===e||e.onInit(),null===(t=this.playbackTracker)||void 0===t||t.onSourceSet(),this.flipIFrame=document.createElement("iframe"),this.flipIFrame.src=this.url.toString(),this.setProperties(this.flipIFrame),this.parent.append(this.flipIFrame),window.addEventListener("message",this.onMessage)}setProperties(e){null!==e&&(e.setAttribute("allow","autoplay"),F(e),e.style.border="0px",this.setVisible())}handlePlayerEvent(e){switch(e.data.name){case"fg-wvp-onReady":case"fg-wvp-onInitialReady":if(this.isFirstReady){if(this.isFirstReady=!1,void 0===this.duration&&void 0!==this.flipIFrame&&null!==this.flipIFrame.contentWindow){const e=this.getMessage("fg-wvp-getDuration",{});this.flipIFrame.contentWindow.postMessage(e,this.url.origin)}void 0!==this.onReadyCallback&&this.onReadyCallback()}break;case"fg-wvp-onPlay":this.paused=!1,void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(1);break;case"fg-wvp-onPause":this.paused=!0,(void 0===this.duration||this.currentTime<this.duration)&&void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(0);break;case"fg-wvp-onSeek":void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(3);break;case"fg-wvp-onTimeUpdate":this.currentTime=e.data.data.currentTime;break;case"fg-wvp-onBuffering":break;case"fg-wvp-onEnded":this.paused=!0,void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(6);break;case"fg-wvp-onError":E.a.error(508895832,"Flipgrid player entered error state "+e.data.data.error);break;case"fg-wvp-getDurationResult":this.duration=e.data.data.duration;break;case"fg-wvp-getCurrentTimeResult":this.currentTime=e.data.data.currentTime}}capturePlayerPerf(e){const t=e.data.name;if(void 0!==this.perfTracker)switch(t){case"fg-wvp-onReady":this.perfTracker.onReady(),void 0!==this.duration&&this.perfTracker.setDuration(this.duration);break;case"fg-wvp-onPlay":this.perfTracker.onPlaying();break;case"fg-wvp-onPause":this.perfTracker.onPause();break;case"fg-wvp-onSeek":this.perfTracker.onSeeked();break;case"fg-wvp-onEnded":this.perfTracker.onEnded();break;case"fg-wvp-onError":const t="Flipgrid player entered error state "+e.data.data.error;this.perfTracker.onError(t,!0)}}capturePlaybackTelemetry(e){const t=e.data.name;if(void 0!==this.playbackTracker)switch(t){case"fg-wvp-onReady":this.playbackTracker.onCanPlay(),void 0!==this.duration&&this.playbackTracker.setDuration(this.duration);break;case"fg-wvp-onPlay":this.playbackTracker.onPlaying();break;case"fg-wvp-onPause":this.playbackTracker.onPause();break;case"fg-wvp-onSeek":break;case"fg-wvp-onEnded":this.playbackTracker.onEnded();break;case"fg-wvp-onError":const t="Flipgrid player entered error state "+e.data.data.error;this.playbackTracker.onError(t,!0)}}getMessage(e,t){return{name:e,data:t}}}class N{constructor(e,t,i,r,n,a,s,o){this.paused=!0,this.currentTime=0,this.streamAuthFailed=!1,this.onMessage=e=>{var t,i,r,n,a,s;if(this.url.origin===e.origin&&void 0!==this.streamIFrame&&this.streamIFrame.contentWindow===e.source)switch(e.data.name){case"initializestreamconnection":E.a.info(508895829,"StreamAuth: Received handshake request");let o=!1;if(void 0!==this.streamIFrame){const t=this.streamIFrame.contentWindow;if(null!==t){const i=e.data;i.result=!0,t.postMessage(i,e.origin),o=!0}}o||E.a.info(508895828,"StreamAuth: Received handshake request, but unable to reply");break;case"getstreamtoken":this.handleTokenRequest(e);break;case"signinevent":this.streamAuthFailed||"signinfailed"===(null===(t=e.data.eventData)||void 0===t?void 0:t.eventname)&&(null===(i=this.perfTracker)||void 0===i||i.onError("Authentication Error - User failed to authenticate",!0),null===(r=this.playbackTracker)||void 0===r||r.onError("Authentication Error - User failed to authenticate",!0),this.streamAuthFailed=!0);break;case"loaddata":const l=null===(n=e.data.eventData)||void 0===n?void 0:n.responsecode;"200"!==l&&(null===(a=this.perfTracker)||void 0===a||a.onError("Load Error - Video responded with status code "+l,!0),null===(s=this.playbackTracker)||void 0===s||s.onError("Load Error - Video responded with status code "+l,!0));break;case"playerevent":this.handlePlayerEvent(e),this.trackPlayerPerf(e),this.trackPlaybackTelemetry(e)}},this.url=new URL(e),this.parent=t,this.perfTracker=r,this.playbackTracker=n,this.onReadyCallback=a,this.onMediaEventCallback=s,this.onTokenRequestCallback=o,void 0!==i.App&&this.url.searchParams.set("app",i.App),void 0!==i.AppPlatform&&this.url.searchParams.set("appPlatform",i.AppPlatform),void 0!==i.AppCorrelation&&this.url.searchParams.set("appCorrelation",i.AppCorrelation),this.url.searchParams.set("thinEmbed","true");try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Stream Classic video client: "+e.message,!0)}}play(){const e=this.getMessage("playerfunction","play");this.sendMessage(e)}pause(){const e=this.getMessage("playerfunction","pause");this.sendMessage(e)}stop(){this.pause(),this.seekTo(0)}togglePause(){this.paused?this.play():this.pause()}getPlayer(){return this.streamIFrame}isPaused(){return this.paused}getCurrentTime(){return this.currentTime}getDuration(){}seekTo(e){const t=this.getMessage("playerfunction","setplaytime",e.toString());this.sendMessage(t)}setVisible(){void 0!==this.streamIFrame&&(this.streamIFrame.style.visibility="visible")}setHidden(){void 0!==this.streamIFrame&&(this.streamIFrame.style.visibility="hidden")}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}cleanUpMediaClient(){void 0!==this.streamIFrame&&this.streamIFrame.remove(),this.paused=!0,this.currentTime=0,this.streamIFrame=void 0,this.streamAuthFailed=!1,window.removeEventListener("message",this.onMessage),void 0!==this.perfTracker&&this.perfTracker.cleanup(),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}getPerfData(){if(void 0!==this.perfTracker)return this.perfTracker.getPerfData()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}postAuthToken(e){if(void 0!==this.streamIFrame){const t=this.streamIFrame.contentWindow;null!==t&&void 0!==this.streamAuthContext?(void 0===this.streamAuthContext.messageObj.eventData&&(this.streamAuthContext.messageObj.eventData={}),this.streamAuthContext.messageObj.eventData.token=e,this.streamAuthContext.messageObj.result=!0,t.postMessage(this.streamAuthContext.messageObj,this.streamAuthContext.origin),E.a.info(508895831,"StreamAuth: Posted Aad Token back to Stream Player")):E.a.error(508895830,"StreamAuth: Got a Stream iframe but unable to get ContentWindow or cached Context")}}init(){var e,t;null===(e=this.perfTracker)||void 0===e||e.onInit(),null===(t=this.playbackTracker)||void 0===t||t.onSourceSet(),this.streamIFrame=document.createElement("iframe"),this.streamIFrame.src=this.url.toString(),this.setProperties(this.streamIFrame),this.parent.append(this.streamIFrame),window.addEventListener("message",this.onMessage)}setProperties(e){null!==e&&(e.setAttribute("allow","autoplay"),F(e),e.style.border="0px",this.setVisible())}handleTokenRequest(e){var t,i,r;if(this.streamAuthFailed)return;if(void 0===this.onTokenRequestCallback)return this.streamAuthFailed=!0,null===(t=this.perfTracker)||void 0===t||t.onError("Authentication Error - onTokenRequestCallback is undefined",!0),void(null===(i=this.playbackTracker)||void 0===i||i.onError("Authentication Error - onTokenRequestCallback is undefined",!0));E.a.info(508895827,"StreamAuth: Requesting AAD token from Host");const n=e.data,a=e.origin;this.streamAuthContext={messageObj:n,origin:a},this.onTokenRequestCallback(null===(r=n.eventData)||void 0===r?void 0:r.resourceId)}handlePlayerEvent(e){var t,i,r,n;const a=null===(t=e.data.eventData)||void 0===t?void 0:t.eventname;if(void 0!==this.onMediaEventCallback){switch(a){case"play":this.onMediaEventCallback(1);break;case"playing":this.paused=!1,this.onMediaEventCallback(1);break;case"pause":this.paused=!0,this.onMediaEventCallback(0);break;case"ready":void 0!==this.onReadyCallback&&this.onReadyCallback();break;case"timeupdate":{const t=this.currentTime;this.currentTime=null===(i=e.data.eventData)||void 0===i?void 0:i.time,void 0!==this.currentTime&&Math.abs(this.currentTime-t)>=1&&this.onMediaEventCallback(3);break}case"error":E.a.error(538039177,`Stream media error: ${null===(r=e.data.eventData)||void 0===r?void 0:r.errorcode}, message: ${null===(n=e.data.eventData)||void 0===n?void 0:n.message}`)}E.a.info(508895824,"Stream Media Event: "+a)}}trackPlayerPerf(e){var t,i;if(void 0!==this.perfTracker){const r=null===(t=e.data.eventData)||void 0===t?void 0:t.eventname,n=null===(i=e.data.eventData)||void 0===i?void 0:i.message;switch(r){case"play":this.perfTracker.onPlay();break;case"playing":this.perfTracker.onPlaying();break;case"pause":this.perfTracker.onPause();break;case"ready":this.perfTracker.onReady();break;case"error":void 0!==n&&this.perfTracker.onError(n,!0)}}}trackPlaybackTelemetry(e){var t,i;if(void 0!==this.playbackTracker){const r=null===(t=e.data.eventData)||void 0===t?void 0:t.eventname,n=null===(i=e.data.eventData)||void 0===i?void 0:i.message;switch(r){case"play":this.playbackTracker.onPlay();break;case"playing":this.playbackTracker.onPlaying();break;case"pause":this.playbackTracker.onPause();break;case"ready":this.playbackTracker.onCanPlay();break;case"error":void 0!==n&&this.playbackTracker.onError(n,!0)}}}getMessage(e,t,i){return void 0!==i?{name:e,methodData:{methodname:t,data:i},eventData:{}}:{name:e,methodData:{methodname:t},eventData:{}}}sendMessage(e){void 0!==this.streamIFrame&&null!==this.streamIFrame.contentWindow&&(E.a.info(528623694,`sendMessage: Calling postMessage with: msg = ${JSON.stringify(e)}, target = ${this.streamIFrame.src}`),this.streamIFrame.contentWindow.postMessage(e,this.streamIFrame.src))}}class V{constructor(e,t){this._name=e,this._guid=t}get name(){return this._name}get guid(){return this._guid}}V.graph=new V("Graph","00000003-0000-0000-c000-000000000000"),V.hubble=new V("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d"),V.all=[V.graph,V.hubble];class U{constructor(){this.cache=new Map,this.timeValid=33e5}get timeout(){return this.timeValid}updateSettings(e){void 0!==e.TokenCacheTimeout?this.timeValid=e.TokenCacheTimeout:this.timeValid=33e5}update(e,t){0!==t.length?this.cache.set(e,[Date.now(),t]):E.a.error(509167387,"Error: Empty token")}find(e){if(!this.cache.has(e))return;const[t,i]=this.cache.get(e);return Date.now()>t+this.timeValid?void 0:i}}class W{constructor(){this.clients=new Map}add(e,t){const i=this.clients.get(e);void 0!==i?i.has(t)?E.a.error(509171084,"Error: Client already exists"):i.add(t):this.clients.set(e,new Set([t]))}has(e,t){const i=this.clients.get(e);return void 0!==i&&i.has(t)}remove(e,t){const i=this.clients.get(e);return void 0===i?(E.a.error(509171083,"Error: AppId does not exist"),!1):i.delete(t)?0===i.size:(E.a.error(509171082,"Error: Client does not exist"),!1)}getClients(e){const t=this.clients.get(e);if(void 0===t)return E.a.error(509171081,"Error: AppId does not exist"),[];if(0===t.size)return E.a.error(509171080,"Error: Clients do not exist"),[];const i=Array.from(t);return t.clear(),i}getPendingAppId(){for(const[e,t]of this.clients)if(0!==t.size)return e}}class z{constructor(){this.waitBeforeRetry=3e3,this.maxRetries=3,this.startTime=0,this.retries=0}get timeout(){return this.waitBeforeRetry}get maxRetryCount(){return this.maxRetries}get elapsedTime(){return Date.now()-this.startTime}get numberOfRetries(){return this.retries}get willRetry(){return this.numberOfRetries<=this.maxRetryCount}get currentAppId(){return this.appId}get isPending(){return void 0!==this.tokenRequestTimeout}updateSettings(e,t){void 0!==e.MaxAADTokenWaitingTime?this.waitBeforeRetry=e.MaxAADTokenWaitingTime:this.waitBeforeRetry=3e3,void 0!==e.MaxAADTokenRequestRetries?this.maxRetries=e.MaxAADTokenRequestRetries:this.maxRetries=3,void 0!==t?this.tokenRequestCallback=t:E.a.error(509166869,"Error: No token request callback")}start(e){void 0!==this.tokenRequestCallback?void 0===this.currentAppId?this.isPending?E.a.error(509171090,"Error: Request is already pending"):(this.startTime=Date.now(),this.retries=0,this.appId=e,this.tryRequest()):E.a.error(509166861,"Error: AppId already set"):E.a.error(509166818,"Error: No token request callback")}completeOrCancel(e){if(void 0===this.currentAppId)return void E.a.error(509166860,"Error: AppId is not set");if(!this.isPending)return void E.a.error(509171089,"Error: Request is not pending");clearTimeout(this.tokenRequestTimeout),this.tokenRequestTimeout=void 0;const t={tokenLength:e,isCompleted:void 0!==e,tokenType:this.currentAppId.name,elapsedTime:this.elapsedTime,numberOfRetries:this.numberOfRetries};E.a.info(509194645,JSON.stringify(t)),this.appId=void 0}tryRequest(){if(void 0===this.tokenRequestCallback)return void E.a.error(509171088,"Error: No token request callback");if(void 0===this.currentAppId)return void E.a.error(509171087,"Error: AppId is not set");if(this.isPending)return void E.a.error(509171086,"Error: Request is already pending");if(!this.willRetry)return void E.a.error(508700001,"Error: Request will not be retried");const e={tokenType:this.currentAppId.name,elapsedTime:this.elapsedTime,numberOfRetries:this.numberOfRetries};E.a.info(509166817,JSON.stringify(e)),this.tokenRequestTimeout=window.setTimeout(()=>{this.tokenRequestTimeout=void 0,this.retries+=1,this.tryRequest()},this.timeout),this.tokenRequestCallback(this.currentAppId.guid)}}var G=i(33);class j{constructor(e,t,i,r,n,a,s,o){this.paused=!0,this.currentTime=0,this.oEmbedRequestRetried=!1,this.navigatedToEmbedUrl=!1,this.initPostMessageCommunication=e=>{var t,i,r,n;const a=(null===(t=this.embedURL)||void 0===t?void 0:t.origin)===e.origin,s=this.channelId===e.data.channelId;if(a&&s&&"initialize"===e.data.type)try{e.data.replyTo.onmessage=e=>this.onMessage(e),e.data.replyTo.postMessage({type:"activate"}),this.messagePort=e.data.replyTo,null===(r=this.playerPerf)||void 0===r||r.onPostMessagingInitialized(),null===(n=this.playbackTracker)||void 0===n||n.onPostMessagingInitialized()}catch(e){void 0!==this.playerPerf&&this.playerPerf.onError(`Post Messaging Error - Error initializing communication channel (${e.message})`,!0),void 0!==this.playbackTracker&&this.playbackTracker.onError(`Post Messaging Error - Error initializing communication channel (${e.message})`,!0)}else E.a.warn(508371414,"Message failed source verification: "+JSON.stringify({isOriginMatching:a,isChannelMatching:s,messageType:e.data.type,correlationId:null===(i=this.playerPerf)||void 0===i?void 0:i.getCorrelationId()}))},this.videoUrl=e,this.appSettings=i,this.parentElement=t,this.playerPerf=r,this.playbackTracker=n,this.onReadyCallback=a,this.onMediaEventCallback=s,j.tokenRequestor.updateSettings(i,o);try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Stream 2.0 video client: "+e.message,!0)}}static setAADTokenForWaitingClients(e){j.tokenRequestor.setAADToken(e)}play(){this.postMessage({command:"one-player-play"})}pause(){this.postMessage({command:"one-player-pause"})}stop(){this.postMessage({command:"one-player-stop"})}seekTo(e){this.postMessage({command:"one-player-seek",position:e})}togglePause(){this.paused?this.play():this.pause()}setMute(){!0!==this.muted&&this.postMessage({command:"one-player-mute"})}setUnMute(){!1!==this.muted&&this.postMessage({command:"one-player-unmute"})}setVolume(e){const t=Math.min(Math.max(e,0),1);this.postMessage({command:"one-player-set-volume",volumeLevel:t})}getVolume(){return this.volume}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}cleanUpMediaClient(){j.tokenRequestor.cancelAllIfPending(this),void 0!==this.oEmbedRequestRetryTimeout&&window.clearTimeout(this.oEmbedRequestRetryTimeout),void 0!==this.stream2iFrame&&this.stream2iFrame.remove(),void 0!==this.errorMessageDiv&&this.errorMessageDiv.remove(),this.paused=!0,this.currentTime=0,this.muted=void 0,this.volume=void 0,this.lastNonZeroVolume=void 0,this.messagePort=void 0,this.stream2iFrame=void 0,this.oEmbedResponseTimeStamp=void 0,this.oEmbedRequestRetried=!1,this.oEmbedRequestRetryTimeout=void 0,this.channelId=void 0,this.navigatedToEmbedUrl=!1,this.embedURL=void 0,this.errorMessageDiv=void 0,window.removeEventListener("message",this.initPostMessageCommunication),void 0!==this.playerPerf&&this.playerPerf.cleanup(),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}isPaused(){return this.paused}isMuted(){return this.muted}getCurrentTime(){return this.currentTime}getDuration(){return this.duration}setVisible(){void 0!==this.stream2iFrame&&(this.stream2iFrame.style.visibility="visible"),void 0!==this.errorMessageDiv&&(this.errorMessageDiv.style.visibility="visible")}setHidden(){void 0!==this.stream2iFrame&&(this.stream2iFrame.style.visibility="hidden"),void 0!==this.errorMessageDiv&&(this.errorMessageDiv.style.visibility="hidden")}getPlayer(){return this.stream2iFrame}getPerfData(){if(void 0!==this.playerPerf)return this.playerPerf.getPerfData()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}onTokenSet(e,t){switch(e){case V.hubble:this.onHubbleTokenSet(t);break;default:E.a.error(509194507,"Unknown appId: "+e.name)}}showErrorMessage(e){this.errorMessageDiv=document.createElement("div"),this.errorMessageDiv.style.backgroundColor="black",this.errorMessageDiv.style.justifyContent="center",this.errorMessageDiv.style.alignItems="center",this.errorMessageDiv.style.color="white",this.errorMessageDiv.style.fontSize="10",this.errorMessageDiv.style.borderRadius="5",this.errorMessageDiv.style.display="flex",this.errorMessageDiv.style.textAlign="center",this.errorMessageDiv.textContent=e,F(this.errorMessageDiv),this.parentElement.append(this.errorMessageDiv)}onHubbleTokenSet(e){var t,i;null===(t=this.playerPerf)||void 0===t||t.onHubbleTokenSet(),null===(i=this.playbackTracker)||void 0===i||i.onHubbleTokenSet(),this.initOnePlayer(e)}postMessage(e){var t;null===(t=this.messagePort)||void 0===t||t.postMessage({type:"command",id:0,data:e})}onMessage(e){const t=e.data.type;"notification"===t?this.handleNotificationMessage(e.data):"result"===t?this.handleResultMessage(e.data):"command"===t?this.handleCommandMessage(e.data):"acknowledge"===t||E.a.warn(509219079,`Received unrecognized postmessage (type: ${t})`)}handleCommandMessage(e){if("getToken"===e.data.command){E.a.warn(508924038,`Received unexpected getToken request from OnePlayer (type: ${e.data.tokenType})`);const t={type:"result",id:e.id,data:{result:"error",isExpected:!0,error:{code:"",message:"Token request not supported"}}};void 0!==this.messagePort&&this.messagePort.postMessage(t)}}handleResultMessage(e){if("error"!==e.data.result)void 0!==e.data.durationInSeconds?(this.duration=e.data.durationInSeconds,void 0!==this.playerPerf&&this.playerPerf.setDuration(this.duration),void 0!==this.playbackTracker&&this.playbackTracker.setDuration(this.duration)):void 0!==e.data.volume?(this.volume=e.data.volume,0!==this.volume&&(this.lastNonZeroVolume=this.volume),void 0!==this.playerPerf&&this.playerPerf.setVolume(this.volume),void 0!==this.playbackTracker&&this.playbackTracker.setVolume(this.volume)):void 0!==e.data.isMute?(this.muted=e.data.isMute,void 0!==this.playerPerf&&this.playerPerf.setMute(this.muted),void 0!==this.playbackTracker&&this.playbackTracker.setIsMuted(this.muted)):E.a.warn(509215635,`Unrecognized result type received (type: ${e.data.result})`);else{const t=e.data;E.a.error(509437569,`OnePlayer Error - Result: ${t.error.code} (${t.error.message})`)}}handleNotificationMessage(e){var t,i;switch(e.data.notification){case"one-player-player-ready":e.data.isReady&&this.onReady(e.data.ttlMs);break;case"one-player-play-state":const r=e.data.playState;this.onPlayStateChanged(r);break;case"one-player-current-time":const n=this.currentTime;this.currentTime=e.data.currentTime,Math.abs(this.currentTime-n)>2&&(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(3),void 0!==this.playerPerf&&this.playerPerf.onSeeked());break;case"one-player-muted":if(this.muted=e.data.isMuted,!this.muted){const e=void 0!==this.lastNonZeroVolume?this.lastNonZeroVolume:0;this.setVolume(Math.max(e,.022))}void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(4),void 0!==this.playerPerf&&this.playerPerf.onMuteChanged(this.muted),void 0!==this.playbackTracker&&this.playbackTracker.onMuteChanged(this.muted);break;case"one-player-volume":this.volume=e.data.volume,0===this.volume?this.setMute():this.lastNonZeroVolume=this.volume,void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(4),void 0!==this.playerPerf&&this.playerPerf.onVolumeChanged(this.volume),void 0!==this.playbackTracker&&this.playbackTracker.onVolumeChanged(this.volume);break;case"error":case"one-player-fatal-playback-error":null===(t=this.playerPerf)||void 0===t||t.onError("OnePlayer Error - Notification: "+JSON.stringify(e.data),!0),null===(i=this.playbackTracker)||void 0===i||i.onError("OnePlayer Error - Notification: "+JSON.stringify(e.data),!0);break;default:E.a.warn(509437568,`Unrecognized notification type received (type: ${e.data.notification})`)}}onReady(e){this.postMessage({command:"one-player-get-duration"}),this.postMessage({command:"one-player-get-volume"}),this.postMessage({command:"one-player-get-mute"}),void 0!==this.playerPerf&&void 0!==e&&this.playerPerf.onODSPVideoLoad(e),void 0!==this.playbackTracker&&void 0!==e&&this.playbackTracker.onODSPVideoLoad(e),void 0!==this.playerPerf&&this.playerPerf.onReady(),void 0!==this.playbackTracker&&this.playbackTracker.onCanPlay(),void 0!==this.onReadyCallback&&this.onReadyCallback()}onPlayStateChanged(e){this.paused="Playing"!==e,"Playing"===e?(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(1),void 0!==this.playerPerf&&this.playerPerf.onPlaying(),void 0!==this.playbackTracker&&this.playbackTracker.onPlaying()):"Paused"===e?(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(0),void 0!==this.playerPerf&&this.playerPerf.onPause(),void 0!==this.playbackTracker&&this.playbackTracker.onPause()):"Ended"===e&&(void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(6),void 0!==this.playerPerf&&this.playerPerf.onEnded(),void 0!==this.playbackTracker&&this.playbackTracker.onEnded())}init(){var e,t;this.stream2iFrame=document.createElement("iframe"),this.setProperties(this.stream2iFrame),null===(e=this.playerPerf)||void 0===e||e.onInit(),null===(t=this.playbackTracker)||void 0===t||t.onSourceSet(),j.tokenRequestor.request(V.hubble,this)}initOnePlayer(e){this.initOEmbedIFrame(e).then(()=>{void 0!==this.messagePort&&E.a.info(508432459,"Cross-window communication channel is already initialized")}).catch(e=>{void 0!==this.playerPerf&&this.playerPerf.onError(`Init iFrame Error - Error creating iFrame from OEmbed response (${e.message})`),void 0!==this.playbackTracker&&this.playbackTracker.onError(`Init iFrame Error - Error creating iFrame from OEmbed response (${e.message})`)})}initOEmbedIFrame(e){var t,i,r,n;return Object(A.__awaiter)(this,void 0,void 0,(function*(){let a;try{a=yield function(e,t){return Object(A.__awaiter)(this,void 0,void 0,(function*(){const i=function(e,t){if(void 0===e.apiBaseUrl)throw new Error("Hubble API base URL is undefined");const i=new URL(e.apiBaseUrl);if(i.pathname=t,void 0!==e.app){const t=function(e){if(void 0!==e)switch(e){case"Word":return"0";case"Excel":return"1";case"Teams":case"PowerPoint":return"3";case"Outlook":return"5";case"OneNote":return"8";case"Publisher":return"10";case"Visio":return"12";case"SharePoint":return"1001";default:return}}(e.app);void 0!==t&&i.searchParams.set("app",t)}return void 0!==e.appPlatform&&i.searchParams.set("platform",e.appPlatform),i}(t,k.v),r=function(e){const t=new Headers;return void 0!==e.correlationId&&t.set(k.p,e.correlationId),void 0!==e.acceptLanguage&&t.set(k.m,e.acceptLanguage),void 0!==e.aadToken&&t.set(k.n,e.aadToken),t.set(k.o,"application/json; charset=utf-8"),t}(t);i.searchParams.set("url",e);const n=yield fetch(i.toString(),{method:"GET",headers:r}),a=yield n.json();if(!n.ok){let e="status: "+n.status;throw void 0!==a.Error&&void 0!==a.Error.Message&&(e+=", message: "+a.Error.Message),new R(n.status,e)}return a}))}(this.videoUrl,{aadToken:e,apiBaseUrl:this.appSettings.HubbleVideoEndpoint,app:this.appSettings.App,appPlatform:this.appSettings.AppPlatform,correlationId:void 0!==this.playerPerf?this.playerPerf.getCorrelationId():this.appSettings.AppCorrelation,acceptLanguage:this.appSettings.AcceptLanguage})}catch(a){if(G.a.getBoolean("retryOEmbedRequestIf429")&&!this.oEmbedRequestRetried){const r=a.message;if(r.indexOf("status: 429")>-1){const n=r.match(/Retry-After:\s*(\d+)/),a=null!==n&&2===n.length?parseFloat(n[1]):void 0;let s=11.5;if(void 0!==G.a.getNumber("retryOEmbedRequestIf429Threshold")&&(s=G.a.getNumber("retryOEmbedRequestIf429Threshold")),void 0!==a&&a<=s)return this.oEmbedRequestRetried=!0,this.oEmbedRequestRetryTimeout=window.setTimeout(()=>this.initOnePlayer(e),1e3*a),null===(t=this.playerPerf)||void 0===t||t.onError(`OEmbed Request Error - status: 429 (will retry request in ${a}s)`),void(null===(i=this.playbackTracker)||void 0===i||i.onError(`OEmbed Request Error - status: 429 (will retry request in ${a}s)`))}}let s=k.s;return void 0!==this.appSettings.LocalizedHubble404ErrorMessage&&(s=this.appSettings.LocalizedHubble404ErrorMessage),a instanceof R&&(s=this.getErrorMessage(a.statusCode)),this.showErrorMessage(s),null===(r=this.playerPerf)||void 0===r||r.onError("OEmbed Request Error - "+a.message,!0),void(null===(n=this.playbackTracker)||void 0===n||n.onError("OEmbed Request Error - "+a.message,!0))}void 0!==this.playerPerf&&this.playerPerf.onOEmbedResponse(),void 0!==this.playbackTracker&&this.playbackTracker.onOEmbedResponse(),this.setOEmbedURL(a)}))}setOEmbedURL(e){if(void 0===e.embed_url)return void 0!==this.playerPerf&&this.playerPerf.onError("OEmbed Request Error - Received OEmbed response without embed_url field",!0),void 0!==this.playbackTracker&&this.playbackTracker.onError("OEmbed Request Error - Received OEmbed response without embed_url field",!0),void this.showErrorMessage(k.s);this.oEmbedResponseTimeStamp=Date.now(),this.embedURL=new URL(e.embed_url);const t=this.embedURL.searchParams.get("access_token");if(void 0!==this.stream2iFrame&&null!==t){this.embedURL.searchParams.delete("access_token"),this.embedURL.searchParams.set("auth","readwrite");const e="PowerPointLive"===this.appSettings.hostView;e&&this.embedURL.searchParams.set("forceMeta","1"),this.channelId=P(),this.embedURL.searchParams.set("origin",new URL(location.href).origin),this.embedURL.searchParams.set("channelId",this.channelId),this.embedURL.searchParams.set("embed",JSON.stringify({hp:"Web",hv:this.appSettings.hostView,hc:this.appSettings.hostComponent,ha:this.appSettings.App,hsi:void 0!==this.playerPerf?this.playerPerf.getCorrelationId():this.appSettings.AppCorrelation,af:!1,disableHybrid:e,ol:this.appSettings.AcceptLanguage}));const i=new URL(this.videoUrl).searchParams.get("nav");null!==i&&this.embedURL.searchParams.set("nav",i),this.stream2iFrame.setAttribute("allow","autoplay "+this.embedURL.origin),this.stream2iFrame.addEventListener("load",()=>this.onStream2iFrameLoad(t)),this.parentElement.append(this.stream2iFrame)}}onStream2iFrameLoad(e){var t,i,r;if(G.a.getBoolean("navigateToEmbedIfIFrameIsBlank")){if(!this.stream2iFrame||"about:blank"!==(null===(t=this.stream2iFrame.contentDocument)||void 0===t?void 0:t.location.href))return}else if(this.navigatedToEmbedUrl)return;void 0===this.oEmbedResponseTimeStamp||Date.now()-this.oEmbedResponseTimeStamp>=24e4?this.ensureMediaClient():void 0!==this.embedURL&&void 0!==this.stream2iFrame&&null!==this.stream2iFrame.contentWindow&&(window.addEventListener("message",this.initPostMessageCommunication),this.navigateToEmbedUrl(this.stream2iFrame.contentWindow,this.embedURL,e),this.navigatedToEmbedUrl=!0,null===(i=this.playerPerf)||void 0===i||i.onNavigatedToEmbedPage(),null===(r=this.playbackTracker)||void 0===r||r.onNavigatedToEmbedPage())}getErrorMessage(e){return 400===e?void 0!==this.appSettings.LocalizedHubble400ErrorMessage?this.appSettings.LocalizedHubble400ErrorMessage:k.q:404===e?void 0!==this.appSettings.LocalizedHubble404ErrorMessage?this.appSettings.LocalizedHubble404ErrorMessage:k.s:403===e?void 0!==this.appSettings.LocalizedHubble403ErrorMessage?this.appSettings.LocalizedHubble403ErrorMessage:k.r:500===e||503===e||429===e?void 0!==this.appSettings.LocalizedHubble500ErrorMessage?this.appSettings.LocalizedHubble500ErrorMessage:k.t:void 0!==this.appSettings.LocalizedHubble404ErrorMessage?this.appSettings.LocalizedHubble404ErrorMessage:k.s}navigateToEmbedUrl(e,t,i){const r=e.document.createElement("form");r.setAttribute("action",t.toString()),r.setAttribute("method","POST");const n=e.document.createElement("input");n.setAttribute("type","hidden"),n.setAttribute("name","access_token"),n.setAttribute("value",i),r.appendChild(n),e.document.body.appendChild(r),r.submit()}setProperties(e){e.setAttribute("sandbox","allow-scripts allow-same-origin allow-popups allow-forms allow-top-navigation-by-user-activation allow-downloads"),F(e),e.style.border="0px",this.setVisible()}}j.tokenRequestor=new class{constructor(){this.cache=new U,this.clients=new W,this.requestWithRetry=new z}updateSettings(e,t){this.cache.updateSettings(e),this.requestWithRetry.updateSettings(e,t)}request(e,t){const i=this.cache.find(e);void 0===i?(this.clients.add(e,t),this.requestWithRetry.isPending||this.requestWithRetry.start(e)):t.onTokenSet(e,i)}cancelAllIfPending(e){for(const t of V.all)this.cancelIfPending(t,e);this.requestWithRetry.isPending||this.startPendingRequest()}setAADToken(e){const t=this.requestWithRetry.currentAppId;if(void 0===t)return void E.a.error(509166815,"Error: AppId is not set");if(0===e.length)return void E.a.error(509171016,"Error: Got empty token");this.cache.update(t,e),this.requestWithRetry.completeOrCancel(e.length);const i=this.clients.getClients(t);for(const r of i)r.onTokenSet(t,e);this.startPendingRequest()}startPendingRequest(){const e=this.clients.getPendingAppId();void 0!==e&&this.requestWithRetry.start(e)}cancelIfPending(e,t){this.clients.has(e,t)&&this.clients.remove(e,t)&&e===this.requestWithRetry.currentAppId&&this.requestWithRetry.completeOrCancel(void 0)}};var H,q,$,Z=i(258);class X{constructor(e,t,i,r,n,a){this.url=e,this.parent=t,this.perfTracker=i,this.playbackTracker=r,this.onReadyCallback=n,this.onMediaEventCallback=a;try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating Vimeo video client: "+e.message,!0)}}play(){void 0!==this.player&&this.player.play().catch(e=>{E.a.error(508572036,`Vimeo error while playing video (error: ${e.message})`)})}pause(){void 0!==this.player&&this.player.pause().catch(e=>{E.a.error(508572035,`Vimeo error while pausing video (error: ${e.message})`)})}stop(){void 0!==this.player&&(this.pause(),this.seekTo(0))}togglePause(){void 0!==this.player&&void 0!==this.paused&&(this.paused?this.play():this.pause())}setVisible(){void 0!==this.vimeoIframe&&(this.vimeoIframe.style.visibility="visible"),void 0!==this.backDrop&&(this.backDrop.style.visibility="visible")}setHidden(){void 0!==this.vimeoIframe&&(this.vimeoIframe.style.visibility="hidden"),void 0!==this.backDrop&&(this.backDrop.style.visibility="hidden")}getPlayer(){return this.vimeoIframe}getCurrentTime(){return this.currentTime}getDuration(){return this.duration}isPaused(){return this.paused}seekTo(e){void 0!==this.player&&this.player.setCurrentTime(e).catch(e=>{E.a.error(508572034,`Vimeo error while setting current time (error: ${e.message})`)})}setVolume(e){void 0!==this.player&&this.player.setVolume(e).catch(e=>{E.a.error(508572033,`Vimeo error while setting video volume (error: ${e.message})`)})}setMute(){void 0!==this.player&&this.player.setMuted(!0).catch(e=>{E.a.error(508572032,`Vimeo error while setting muted true (error: ${e.message})`)})}setUnMute(){if(void 0!==this.player){if(0===this.volume){const e=void 0!==this.lastNonZeroVolume?this.lastNonZeroVolume:0;this.setVolume(Math.max(e,.25))}this.player.setMuted(!1).catch(e=>{E.a.error(508572003,`Vimeo error while setting muted false (error: ${e.message})`)})}}getVolume(){return this.volume}isMuted(){return this.muted}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}cleanUpMediaClient(){void 0!==this.vimeoIframe&&this.vimeoIframe.remove(),void 0!==this.backDrop&&this.backDrop.remove(),this.paused=void 0,this.player=void 0,this.currentTime=void 0,this.volume=void 0,this.lastNonZeroVolume=void 0,this.muted=void 0,this.vimeoIframe=void 0,this.backDrop=void 0,void 0!==this.perfTracker&&this.perfTracker.cleanup(),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}getPerfData(){if(void 0!==this.perfTracker)return this.perfTracker.getPerfData()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}init(){var e,t;null===(e=this.perfTracker)||void 0===e||e.onInit(),null===(t=this.playbackTracker)||void 0===t||t.onSourceSet(),this.backDrop=document.createElement("div"),this.backDrop.style.backgroundColor="black",this.setProperties(this.backDrop),this.parent.append(this.backDrop),this.vimeoIframe=document.createElement("iframe"),this.vimeoIframe.src=this.url,this.vimeoIframe.setAttribute("allow","autoplay"),this.setProperties(this.vimeoIframe),this.parent.append(this.vimeoIframe),this.player=new Z.a(this.vimeoIframe,{controls:!0,responsive:!1}),this.player.ready().then(()=>Object(A.__awaiter)(this,void 0,void 0,(function*(){if(void 0!==this.player){this.registerOnStateChange();try{this.paused=yield this.player.getPaused(),this.currentTime=yield this.player.getCurrentTime(),this.duration=yield this.player.getDuration(),this.volume=yield this.player.getVolume(),this.muted=yield this.player.getMuted()}catch(e){E.a.error(509354830,`Vimeo error while getting video info on player ready (error: ${e.message})`)}this.paused=!0,0!==this.volume&&(this.lastNonZeroVolume=this.volume),void 0!==this.perfTracker&&(this.perfTracker.onReady(),void 0!==this.volume&&this.perfTracker.setVolume(this.volume),void 0!==this.muted&&this.perfTracker.setMute(this.muted),void 0!==this.duration&&this.perfTracker.setDuration(this.duration)),void 0!==this.playbackTracker&&(this.playbackTracker.onCanPlay(),void 0!==this.volume&&this.playbackTracker.setVolume(this.volume),void 0!==this.muted&&this.playbackTracker.setIsMuted(this.muted),void 0!==this.duration&&this.playbackTracker.setDuration(this.duration)),void 0!==this.onReadyCallback&&this.onReadyCallback(),void 0!==this.player.setAutopause&&this.player.setAutopause(!1).catch(e=>{E.a.error(508572002,`Vimeo error while setting video autopause (error: ${e.message})`)})}}))).catch(e=>{void 0!==this.perfTracker&&this.perfTracker.onError(`Error loading Vimeo player (error: ${e.message})`,!0),void 0!==this.playbackTracker&&this.playbackTracker.onError(`Error loading Vimeo player (error: ${e.message})`,!0)})}registerOnStateChange(){void 0!==this.player&&(this.player.on("play",e=>{this.paused=!1,this.onStateChange(1,e.seconds),void 0!==this.perfTracker&&this.perfTracker.onPlay(),void 0!==this.playbackTracker&&this.playbackTracker.onPlay()}),this.player.on("pause",e=>{this.paused=!0,Math.abs(e.seconds-e.duration)>.1&&this.onStateChange(0,e.seconds),void 0!==this.perfTracker&&this.perfTracker.onPause(),void 0!==this.playbackTracker&&this.playbackTracker.onPause()}),this.player.on("seeked",e=>{this.onStateChange(3,e.seconds),void 0!==this.perfTracker&&this.perfTracker.onSeeked()}),this.player.on("volumechange",e=>Object(A.__awaiter)(this,void 0,void 0,(function*(){const t=this.volume,i=this.muted;this.volume=e.volume,void 0!==this.player&&(this.muted=yield this.player.getMuted()),0!==this.volume&&(this.lastNonZeroVolume=this.volume);const r=t!==this.volume,n=i!==this.muted;(r||n)&&this.onStateChange(4),r&&void 0!==this.perfTracker&&this.perfTracker.onVolumeChanged(this.volume),r&&void 0!==this.playbackTracker&&this.playbackTracker.onVolumeChanged(this.volume),n&&void 0!==this.perfTracker&&void 0!==this.muted&&this.perfTracker.onMuteChanged(this.muted),n&&void 0!==this.playbackTracker&&void 0!==this.muted&&this.playbackTracker.onMuteChanged(this.muted)}))),this.player.on("playing",()=>{void 0!==this.perfTracker&&this.perfTracker.onPlaying(),void 0!==this.playbackTracker&&this.playbackTracker.onPlaying()}),this.player.on("seeking",()=>{void 0!==this.perfTracker&&this.perfTracker.onSeeking()}),this.player.on("ended",e=>{this.paused=!0,this.onStateChange(6,e.seconds),void 0!==this.perfTracker&&this.perfTracker.onEnded(),void 0!==this.playbackTracker&&this.playbackTracker.onEnded()}),this.player.on("error",e=>{if(void 0!==this.perfTracker){const t=`${e.name} error raised by Vimeo player's "${e.method}" method: (${e.message})`;this.perfTracker.onError(t)}if(void 0!==this.playbackTracker){const t=`${e.name} error raised by Vimeo player's "${e.method}" method: (${e.message})`;this.playbackTracker.onError(t)}}),this.player.on("timeupdate",e=>{this.currentTime=e.seconds}))}onStateChange(e,t){void 0!==t&&(this.currentTime=t),void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(e)}setProperties(e){null!==e&&(F(e),e.style.border="0px",this.setVisible())}}function Y(){return!!document.head.querySelector(`script[src="${k.L}"]`)}function J(){const e=document.createElement("script");e.setAttribute("type","text/javascript"),e.src="https://www.youtube.com/iframe_api",document.head.appendChild(e)}class K{constructor(e,t,i,r,n,a,s,o){this.paused=!0,this.url=new URL(e),this.parent=t,this.perfTracker=i,this.playbackTracker=r,this.mediaSizeInfo=n,this.onReadyCallback=a,this.onMediaEventCallback=s,this.appSettings=null!=o?o:{};try{this.init()}catch(e){void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating YouTube video client: "+e.message,!0)}}play(){void 0!==this.player&&void 0!==this.player.playVideo&&this.player.playVideo()}getVolume(){if(void 0!==this.player&&void 0!==this.player.getVolume)return this.player.getVolume()}pause(){void 0!==this.player&&void 0!==this.player.pauseVideo&&this.player.pauseVideo()}getPlayer(){return this.youTubeIFrame}stop(){void 0!==this.player&&void 0!==this.player.stopVideo&&this.player.stopVideo()}togglePause(){void 0!==this.player&&(this.paused?this.play():this.pause())}setVisible(){void 0!==this.youTubeIFrame&&(this.youTubeIFrame.style.visibility="visible")}setHidden(){void 0!==this.youTubeIFrame&&(this.youTubeIFrame.style.visibility="hidden")}getCurrentTime(){if(void 0!==this.player&&void 0!==this.player.getCurrentTime)return this.player.getCurrentTime();E.a.warn(508895497,`Attempted to getCurrentTime ${k.K} but undefined player`)}getDuration(){if(void 0!==this.player&&void 0!==this.player.getDuration)return this.player.getDuration()}seekTo(e){void 0!==this.player?this.shouldSeekOnlineMedia(e)&&void 0!==this.player.seekTo&&this.player.seekTo(e,!0):E.a.warn(508895496,`Attempted to seek ${k.K} but undefined player`)}setMute(){void 0!==this.player&&void 0!==this.player.mute&&this.player.mute()}setUnMute(){void 0!==this.player&&void 0!==this.player.unMute&&this.player.unMute()}isMuted(){if(void 0!==this.player&&void 0!==this.player.isMuted)return this.player.isMuted()}setVolume(e){void 0!==this.player&&void 0!==this.player.setVolume&&this.player.setVolume(e)}isPaused(){return this.paused}ensureMediaClient(){this.cleanUpMediaClient(),this.init()}cleanUpMediaClient(){void 0!==this.youTubeIFrame&&this.youTubeIFrame.remove(),void 0!==this.pollPlayerVol&&clearInterval(this.pollPlayerVol),this.paused=!0,this.player=void 0,this.muted=void 0,this.volume=void 0,this.youTubeIFrame=void 0,this.pollPlayerVol=void 0,void 0!==this.perfTracker&&this.perfTracker.cleanup(),void 0!==this.playbackTracker&&this.playbackTracker.cleanup()}getPerfData(){if(void 0!==this.perfTracker)return this.perfTracker.getPerfData()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}init(){var e,t,i;null===(e=this.perfTracker)||void 0===e||e.onInit(),null===(t=this.playbackTracker)||void 0===t||t.onSourceSet(),this.url.searchParams.set("enablejsapi","1"),this.youTubeIFrame=document.createElement("iframe"),this.youTubeIFrame.src=this.url.toString(),this.youTubeIFrame.id="gfx-video-youtube-"+P(),this.setProperties(this.youTubeIFrame),this.parent.append(this.youTubeIFrame),void 0!==this.mediaSizeInfo&&this.mediaSizeInfo.fEnableCropping&&this.handlePartiallyOffSlideLinkedMedia(this.mediaSizeInfo),!0===this.appSettings.fixAutoPlayEnabled?(E.a.warn(507576588,`YouTube script loaded: ${Y()} IFrameAPI Ready: ${null!==(i=window.isYouTubeIFrameAPIReady)&&void 0!==i&&i}`),Y()&&!0===window.isYouTubeIFrameAPIReady?this.initYouTubePlayer():(E.a.warn(509437570,"YouTube iFrame API isn't ready yet, caching this client and waiting..."),K.clientsWaitingForIFrameAPI.push(this),window.onYouTubeIframeAPIReady=()=>{window.isYouTubeIFrameAPIReady=!0;for(const e of K.clientsWaitingForIFrameAPI)e.initYouTubePlayer();K.clientsWaitingForIFrameAPI=[]},Y()||J())):(Y()||(window.onYouTubeIframeAPIReady=()=>{K.isYouTubeIFrameAPIReady=!0;for(const e of K.clientsWaitingForIFrameAPI)e.initYouTubePlayer();K.clientsWaitingForIFrameAPI=[]},J()),K.isYouTubeIFrameAPIReady?this.initYouTubePlayer():(E.a.info(509437570,"YouTube iFrame API isn't ready yet, caching this client and waiting..."),K.clientsWaitingForIFrameAPI.push(this)))}initYouTubePlayer(){void 0!==this.youTubeIFrame&&(document.body.contains(this.youTubeIFrame)?this.player=new YT.Player(this.youTubeIFrame.id,{events:{onReady:e=>{this.onPlayerReady(e)},onError:e=>{void 0!==this.perfTracker&&this.perfTracker.onError("YouTube player entered error state "+e.data,!0),void 0!==this.playbackTracker&&this.playbackTracker.onError("YouTube player entered error state "+e.data,!0)}}}):this.youTubeIFrame.onload=()=>{this.initYouTubePlayer()})}shouldSeekOnlineMedia(e){if(void 0!==this.player){const t=this.getCurrentTime();if(void 0!==t&&Math.abs(e-t)>=1)return!0}return!1}handlePartiallyOffSlideLinkedMedia(e){let t=0,i=0;e.mediaPosition.x<0&&(t=e.mediaPosition.x,this.parent.style.left="0px",this.parent.style.width=e.mediaSize.x+e.mediaPosition.x+"px"),e.mediaPosition.y<0&&(i=e.mediaPosition.y,this.parent.style.top="0px",this.parent.style.height=e.mediaSize.y+e.mediaPosition.y+"px"),e.mediaPosition.x+e.mediaSize.x>e.slideSize.x&&(e.mediaPosition.x<=0?this.parent.style.width=e.slideSize.x+"px":this.parent.style.width=e.slideSize.x-e.mediaPosition.x+"px"),e.mediaPosition.y+e.mediaSize.y>e.slideSize.y&&(e.mediaPosition.y<=0?this.parent.style.height=e.slideSize.y+"px":this.parent.style.height=e.slideSize.y-e.mediaPosition.y+"px"),this.parent.style.overflow="hidden",void 0!==this.youTubeIFrame?(this.youTubeIFrame.style.width=e.mediaSize.x+"px",this.youTubeIFrame.style.height=e.mediaSize.y+"px",this.youTubeIFrame.style.position="relative",this.youTubeIFrame.style.left=t+"px",this.youTubeIFrame.style.top=i+"px"):E.a.warn(541881949,"Attempted to adjust iframe bounds but iframe is null")}onPlayerReady(e){this.onVolumeChangeHandler(),this.pollPlayerVol=setInterval(()=>this.onVolumeChangeHandler(),500),void 0!==this.player&&void 0!==this.perfTracker&&(this.perfTracker.onReady(),this.perfTracker.setVolume(this.player.getVolume()),this.perfTracker.setMute(this.player.isMuted()),this.perfTracker.setDuration(this.player.getDuration())),void 0!==this.player&&void 0!==this.playbackTracker&&(this.playbackTracker.onCanPlay(),this.playbackTracker.setVolume(this.player.getVolume()),this.playbackTracker.setIsMuted(this.player.isMuted()),this.playbackTracker.setDuration(this.player.getDuration())),e.target.addEventListener("onStateChange",e=>{this.onStateChange(e),this.capturePlayerPerf(e),this.capturePlaybackTelemetry(e)}),void 0!==this.onReadyCallback&&this.onReadyCallback()}onVolumeChangeHandler(){if(void 0===this.player)return;const e=this.player.isMuted(),t=this.player.getVolume(),i=void 0===this.muted||void 0===this.volume,r=this.muted!==e,n=this.volume!==t;this.muted=e,this.volume=t,i||((r||n)&&this.sendMediaEvent(4),n&&void 0!==this.perfTracker&&this.perfTracker.onVolumeChanged(this.volume),r&&void 0!==this.perfTracker&&void 0!==this.muted&&this.perfTracker.onMuteChanged(this.muted),n&&void 0!==this.playbackTracker&&this.playbackTracker.onVolumeChanged(this.volume),r&&void 0!==this.playbackTracker&&void 0!==this.muted&&this.playbackTracker.onMuteChanged(this.muted))}onStateChange(e){switch(e.data){case-1:break;case 0:this.paused=!0,this.sendMediaEvent(6);break;case 1:this.paused=!1,this.sendMediaEvent(1);break;case 2:this.paused=!0,this.sendMediaEvent(0);break;case 3:this.sendMediaEvent(3);break;case 5:break;default:E.a.info(508895495,"Unexpected Youtube Media Event: "+e.data)}}capturePlayerPerf(e){if(void 0!==this.perfTracker)switch(e.data){case 0:this.perfTracker.onEnded();break;case 1:this.perfTracker.onPlaying();break;case 2:this.perfTracker.onPause();break;case 3:this.perfTracker.onBuffering()}}capturePlaybackTelemetry(e){if(void 0!==this.playbackTracker)switch(e.data){case 0:this.playbackTracker.onEnded();break;case 1:this.playbackTracker.onPlaying();break;case 2:this.playbackTracker.onPause();break;case 3:this.playbackTracker.onBuffering()}}sendMediaEvent(e){void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(e)}setProperties(e){e.style.zIndex=""+k.J,e.style.width="100%",e.style.height="100%",e.style.pointerEvents="all",e.style.position="absolute",e.style.objectFit="fill",e.style.border="0px",e.setAttribute("allow","autoplay"),this.setVisible()}}function Q(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function ee(e){const t=Q("svg");t.setAttribute("viewBox","-1 -1 2 2"),t.setAttribute("role","button"),t.setAttribute(k.d,null!=e?e:"Play"),Object(L.a)(t,{height:k.B+"px",width:k.B+"px",position:"absolute",zIndex:""+k.J,top:`calc(50% - ${k.B/2}px)`,left:`calc(50% - ${k.B/2}px)`,cursor:"pointer",pointerEvents:"all"});const i=Q("circle");i.setAttribute("cx","0"),i.setAttribute("cy","0"),i.setAttribute("r","1"),i.setAttribute("fill","#404040");const r=Q("path");return r.setAttribute("d","M.5 0 L-.25 -.5 L-.25 .5 Z"),r.setAttribute("fill","none"),r.setAttribute("stroke","white"),r.setAttribute("stroke-width",".05"),r.setAttribute("opacity",".5"),t.appendChild(i),t.appendChild(r),t}K.isYouTubeIFrameAPIReady=Y(),K.clientsWaitingForIFrameAPI=[];class te{constructor(e,t,i,r){this.poster=document.createElement("img"),this.poster.src=e,this.poster.tabIndex=-1,this.poster.style.position="absolute",this.poster.style.width="100%",this.poster.style.height="100%",this.poster.style.zIndex=""+(k.J+1),this.playButton=ee(r),this.poster.tabIndex=-1,this.playButton.style.zIndex=""+(k.J+2),this.playButton.addEventListener("click",()=>{i()}),t.addEventListener("mousedown",e=>{e.preventDefault()}),t.addEventListener("keydown",e=>{!this.isVisible||"Enter"!==e.key&&" "!==e.key||(e.stopImmediatePropagation(),i())}),t.appendChild(this.poster),t.appendChild(this.playButton)}get isVisible(){return"none"!==this.poster.style.display&&"none"!==this.playButton.style.display}hide(){this.poster.style.display="none",this.playButton.style.display="none"}show(){this.poster.style.display="inline",this.playButton.style.display="inline"}}class ie{constructor(e,t,i){this.isReady=!1,this.pendingPlay=!1,this.client=e,this.perfTracker=t,this.playbackTracker=i}play(){this.logCommand("play"),this.isReady?this.client.play():this.pendingPlay=!0,this.perfTracker.onPlayCommand(),this.playbackTracker&&this.playbackTracker.onPlayCommand()}pause(){this.logCommand("pause"),this.pendingPlay=!1,this.isReady&&this.client.pause(),this.perfTracker.onPauseCommand(),this.playbackTracker&&this.playbackTracker.onPauseCommand()}stop(){this.logCommand("stop"),this.pendingPlay=!1,this.isReady&&this.client.stop(),this.perfTracker.onStopCommand(),this.playbackTracker&&this.playbackTracker.onStopCommand()}seekTo(e){this.logCommand(`seek to ${e}s`),this.isReady?this.client.seekTo(e):this.pendingSeekTime=e}togglePlayPause(){this.logCommand("togglePlayPause"),this.isReady?void 0===this.client.isPaused||void 0===this.client.isPaused()||!0===this.client.isPaused()?this.play():this.pause():this.pendingPlay?this.pause():this.play()}onReady(){this.isReady=!0,void 0!==this.pendingSeekTime&&(this.client.seekTo(this.pendingSeekTime),this.pendingSeekTime=void 0),this.pendingPlay&&(this.client.play(),this.pendingPlay=!1)}cleanup(){this.isReady=!1,this.pendingPlay=!1,this.pendingSeekTime=void 0}logCommand(e){E.a.info(508870985,"OnlineVideoController recieved command: "+JSON.stringify({command:e,isReady:this.isReady,pendingPlay:this.pendingPlay,pedingSeekTime:this.pendingSeekTime,correlationId:this.perfTracker.getCorrelationId()}))}}class re{constructor(e,t,i,r,n){this.providerName="",this.mediaId="",this.vetoLogged=!1,this.slowPlayVetoThreshold=11500,this.notYetPlayedVetoThreshold=11500,this.appSettings=e,this.correlationId=t,void 0!==i&&(this.providerName=i),void 0!==r&&(this.mediaId=r),this.onVetoCallback=n,void 0!==e.SlowPlayVetoThreshold&&(this.slowPlayVetoThreshold=e.SlowPlayVetoThreshold),void 0!==e.NotYetPlayedVetoThreshold&&(this.notYetPlayedVetoThreshold=e.NotYetPlayedVetoThreshold)}get wasVetoLogged(){return this.vetoLogged}getError(){return this.error}setError(e){this.error=e}setProviderName(e){this.providerName=e}setLoggableId(e){this.mediaId=e}onError(e,t,i,r,n,a){const s=this.getPrefix();let o=s+"VideoError";i?o=s+"VideoErrorWhilePlaying":void 0!==r?o=s+"VideoErrorAfterPlaying":"Stream2"===this.providerName&&(e.indexOf("status: 403")>-1?o="Stream2VideoAuthenticationError":(e.indexOf("status: 429")>-1||e.indexOf("status: 408")>-1||e.indexOf("status: 503")>-1)&&(o="Stream2VideoRedemptionStormError"));const l=e.replace(/(?:https?|ftp):\/\/[\S]+/g,"[URL]");E.a.error(508671629,"Media raised error: "+JSON.stringify({isCritical:t,app:this.appSettings.App,hostView:this.appSettings.hostView,name:o,message:l,provider:this.providerName,correlationId:this.correlationId}));const d=t?1:3;(void 0===this.error||d<=this.error.severity)&&(this.error={severity:d,name:o,message:l,timestamp:Date.now()}),t&&(this.clearVideoNotPlayedTimeout(),void 0===n&&void 0===a||this.sendVeto(s+"MediaPlaybackFailure",this.error.name,this.error.message))}hasCriticalError(){return void 0!==this.error&&1===this.error.severity}logPlaybackFailure(){if(void 0!==this.error&&1===this.error.severity){const e=this.getPrefix();this.sendVeto(e+"MediaPlaybackFailure",this.error.name,this.error.message)}}logIfSlowPlaybackStart(e){this.clearVideoNotPlayedTimeout(),e>this.slowPlayVetoThreshold&&this.onSlowPerfError("VideoPlayedSlow",`Video played after ${e} ms`)}setVideoNotPlayedTimeout(e){this.videoNotYetPlayedTimeout=window.setTimeout(()=>{this.videoNotYetPlayedTimeout=void 0,void 0===e()&&this.onSlowPerfError("VideoNotYetPlayed",`Video hasn't played after ${this.notYetPlayedVetoThreshold} ms`)},this.notYetPlayedVetoThreshold)}clearVideoNotPlayedTimeout(){void 0!==this.videoNotYetPlayedTimeout&&(window.clearTimeout(this.videoNotYetPlayedTimeout),this.videoNotYetPlayedTimeout=void 0)}cleanup(){this.clearVideoNotPlayedTimeout(),this.error=void 0,this.vetoLogged=!1}onSlowPerfError(e,t){const i=this.getPrefix(),r=i+e;E.a.error(508671628,"Media slow perf: "+JSON.stringify({name:r,message:t,app:this.appSettings.App,hostView:this.appSettings.hostView,provider:this.providerName,correlationId:this.correlationId})),(void 0===this.error||2<=this.error.severity)&&(this.error={name:r,severity:2,message:t,timestamp:Date.now()}),this.sendVeto(i+"MediaPerfSlow",r,t)}getPrefix(){return"Local"===this.providerName?"Local":"Stream2"===this.providerName?"Stream2":"Online"}sendVeto(e,t,i){this.vetoLogged=!0,void 0!==this.onVetoCallback&&this.onVetoCallback({vetoName:e,errorName:t,details:i,correlationId:this.correlationId,mediaId:this.mediaId,providerName:this.providerName})}}class ne{constructor(e,t,i,r,n){this.isPlaying=!1;const a=P();this.baseData={requestGuid:a,providerName:t,loggableMediaId:i,mediaType:r},this.vetoHandler=new re(e,a,t,i,n)}setLoggableId(e){this.baseData.loggableMediaId=e,this.vetoHandler.setLoggableId(e)}setProviderName(e){this.baseData.providerName=e,this.vetoHandler.setProviderName(e)}setMediaType(e){this.baseData.mediaType=e}setTimeOfCreation(){this.baseData.timeOfCreation=Date.now()}setUiHostType(e){this.baseData.uiHostType=e}setFlights(e){this.baseData.flights=e}onLoadStart(){void 0===this.baseData.timeOfLoadStart&&(this.baseData.timeOfLoadStart=Date.now())}onCanPlay(){this.logEvent("canplay"),void 0===this.baseData.timeOfCanPlay&&(this.baseData.timeOfCanPlay=Date.now(),this.baseData.timeOfPlay=void 0,this.baseData.timeOfPlaying=void 0)}onSourceSet(){void 0===this.baseData.timeOfSourceSet&&(this.baseData.timeOfSourceSet=Date.now())}onPlayRequested(){void 0===this.baseData.timeOfPlayRequest&&(this.baseData.timeOfPlayRequest=Date.now())}onPlay(){this.logEvent("play"),void 0===this.baseData.timeOfPlay&&(this.baseData.timeOfPlay=Date.now(),this.baseData.timeOfPlaying=void 0),this.lastPlayingTime=void 0}onPlaying(){this.logEvent("playing"),void 0===this.baseData.timeOfPlaying&&(this.baseData.timeOfPlaying=Date.now(),void 0!==this.baseData.timeOfPlayRequest&&this.vetoHandler.logIfSlowPlaybackStart(this.baseData.timeOfPlaying-this.baseData.timeOfPlayRequest)),this.isPlaying=!0,this.calculateBufferingTime(),void 0===this.lastPlayingTime&&(this.lastPlayingTime=Date.now())}onPlayCommand(e=!0){if(void 0===this.baseData.timeOfPlaying&&void 0===this.baseData.timeOfPlayRequest){if(this.baseData.timeOfPlayRequest=Date.now(),this.vetoHandler.hasCriticalError())return void this.vetoHandler.logPlaybackFailure();if(e){const e=()=>this.baseData.timeOfPlaying;this.vetoHandler.setVideoNotPlayedTimeout(e)}}}onStopCommand(){void 0===this.baseData.timeOfPlaying&&void 0!==this.baseData.timeOfPlayRequest&&(this.baseData.timeOfPlayRequest=void 0,this.vetoHandler.clearVideoNotPlayedTimeout())}onPause(){this.logEvent("pause"),this.isPlaying=!1,this.calculatePlayingTime()}onEnded(){this.logEvent("ended"),this.isPlaying=!1,this.baseData.wasPlayedUntilEnd=!0,this.calculatePlayingTime()}onVolumeChanged(e){this.logEvent("volumeChanged"),this.baseData.lastVolume=e}onMuteChanged(e){this.logEvent("muteChanged"),this.baseData.lastMuteState=e}onBuffering(){this.logEvent("buffering"),this.isPlaying=!1,this.calculatePlayingTime(),void 0===this.lastBufferTime&&(this.lastBufferTime=Date.now())}onError(e,t=!1){this.logEvent("error"),this.vetoHandler.onError(e,t,this.isPlaying,this.baseData.timeOfPlaying,this.baseData.timeOfPlayRequest,this.baseData.timeOfCanPlay)}cleanup(){this.baseData.timeOfCreation=void 0,this.baseData.timeOfSourceSet=void 0,this.baseData.timeOfLoadStart=void 0,this.baseData.timeOfCanPlay=void 0,this.baseData.timeOfPlayRequest=void 0,this.baseData.timeOfPlay=void 0,this.baseData.timeOfPlaying=void 0,this.baseData.timeOfError=void 0,this.baseData.totalPlayingTime=0,this.baseData.totalBufferingTime=0,this.baseData.lastVolume=void 0,this.baseData.lastMuteState=void 0,this.baseData.wasPlayedUntilEnd=void 0,this.baseData.errorName=void 0,this.baseData.errorMessage=void 0,this.baseData.wasVetoLogged=void 0,this.isPlaying=!1,this.lastBufferTime=void 0,this.lastPlayingTime=void 0,this.vetoHandler.cleanup(),this.baseData.requestGuid=P()}getPlaybackData(){const e=this.vetoHandler.getError();return this.baseData.errorName=null==e?void 0:e.name,this.baseData.errorMessage=null==e?void 0:e.message,this.baseData.timeOfError=null==e?void 0:e.timestamp,this.baseData.wasVetoLogged=this.vetoHandler.wasVetoLogged,this.calculatePlayingTime(),this.calculateBufferingTime(),this.baseData}setViewDimensions(e,t){this.baseData.viewWidth=e,this.baseData.viewHeight=t}setMediaId(e){this.baseData.loggableMediaId=e}setDuration(e){this.baseData.duration=e}setVolume(e){this.baseData.lastVolume=e}setIsMuted(e){this.baseData.lastMuteState=e}logEvent(e){E.a.info(508704415,"Media emitted event: "+JSON.stringify({event:e,provider:this.baseData.providerName,requestGuid:this.baseData.requestGuid}))}calculateBufferingTime(){if(void 0!==this.lastBufferTime){const e=Date.now()-this.lastBufferTime;void 0===this.baseData.totalBufferingTime&&(this.baseData.totalBufferingTime=0),this.baseData.totalBufferingTime+=e,this.lastBufferTime=void 0}}calculatePlayingTime(){if(void 0!==this.lastPlayingTime){const e=Date.now()-this.lastPlayingTime;void 0===this.baseData.totalPlayingTime&&(this.baseData.totalPlayingTime=0),this.baseData.totalPlayingTime+=e,this.lastPlayingTime=void 0}}}class ae extends ne{constructor(e,t,i,r){super(e,t,i,t,r),this.onlineData={}}getPlaybackData(){return Object.assign(Object.assign({},super.getPlaybackData()),this.onlineData)}onHubbleTokenSet(){void 0===this.onlineData.timeOfHubbleToken&&(this.onlineData.timeOfHubbleToken=Date.now())}onOEmbedResponse(){void 0===this.onlineData.timeOfOEmbedResponse&&(this.onlineData.timeOfOEmbedResponse=Date.now())}onNavigatedToEmbedPage(){void 0===this.onlineData.timeOfNavigatedToEmbedPage&&(this.onlineData.timeOfNavigatedToEmbedPage=Date.now())}onPostMessagingInitialized(){void 0===this.onlineData.timeOfPostMessagingInitialized&&(this.onlineData.timeOfPostMessagingInitialized=Date.now())}onODSPVideoLoad(e){void 0===this.baseData.timeOfLoadStart&&(this.baseData.timeOfLoadStart=Date.now()-e)}onVideoElementStopPlaying(){const e=this.baseData.lastVolume,t=this.baseData.lastMuteState,i=this.vetoHandler.getError();this.cleanup(),void 0!==e&&this.setVolume(e),void 0!==t&&this.setIsMuted(t),void 0!==i&&this.vetoHandler.setError(i)}onPlayCommand(){const e="Other"!==this.baseData.providerName&&"Ted"!==this.baseData.providerName&&"SlideShare"!==this.baseData.providerName;super.onPlayCommand(e)}onPauseCommand(){void 0===this.baseData.timeOfPlaying&&void 0!==this.baseData.timeOfPlayRequest&&(this.baseData.timeOfPlayRequest=void 0,this.vetoHandler.clearVideoNotPlayedTimeout())}cleanup(){this.onlineData.timeOfHubbleToken=void 0,this.onlineData.timeOfOEmbedResponse=void 0,this.onlineData.timeOfPostMessagingInitialized=void 0,super.cleanup()}}class se{constructor(e,t,i,r,n,a,s,o,l,d,h,c,u){var f;this.url=e,this.parent=t,this.appSettings=i,this.mediaSizeInfo=r,this.perfTracker=new x(this.appSettings,l),G.a.getBoolean("enableNewOnlineTelemetry")&&(this.playbackTracker=new ae(i,void 0,c,h)),this.onReadyCallback=a,this.onMediaEventCallback=s,this.onTokenRequestCallback=o,void 0!==n&&(this.poster=new te(n,t,()=>{this.playMedia(),void 0!==d&&d()},u)),this.onReadyCallback=()=>{var e;null===(e=this.controller)||void 0===e||e.onReady(),void 0!==a&&a()};try{this.client=function(e,t,i,r,n,a,s,o,l){if(!function(e){try{return void 0!==new URL(e)}catch(e){return!1}}(e))throw new Error("Attempted to create an online video client with an invalid URL");if("https:"!==new URL(e).protocol)throw new Error("Attempted to create an online video client with an unsafe URL");null==n||n.setCreationTime(),null==a||a.setTimeOfCreation();let d=O(e);return!0===i.IsStream2Enabled&&void 0===d&&(d="Stream2"),void 0!==n&&void 0!==d&&n.setProviderName(d),void 0!==a&&void 0!==d&&a.setProviderName(d),"YouTube"===d?new K(e,t,n,a,r,s,o):"Vimeo"===d?new X(e,t,n,a,s,o):"Flip"===d?new B(e,t,n,a,s,o):"StreamClassic"===d?new N(e,t,i,n,a,s,o,l):"Ted"===d||"SlideShare"===d?new D(e,t,n,a):"Stream2"===d?new j(e,t,i,n,a,s,o,l):(E.a.warn(512271066,"Creating Default client for unidentified provider URL"),new D(e,t,n,a))}(this.url,this.parent,this.appSettings,this.mediaSizeInfo,this.perfTracker,this.playbackTracker,this.onReadyCallback,this.onMediaEventCallback,this.onTokenRequestCallback),void 0!==this.poster&&this.poster.isVisible&&(null===(f=this.client)||void 0===f||f.setHidden()),this.controller=new ie(this.client,this.perfTracker,this.playbackTracker)}catch(e){this.perfTracker.onError("Error creating online video client: "+e.message,!0),void 0!==this.playbackTracker&&this.playbackTracker.onError("Error creating online video client: "+e.message,!0)}}static setAADToken(e){j.setAADTokenForWaitingClients(e)}playMedia(){var e;void 0!==this.poster&&this.poster.isVisible&&this.hidePoster(),null===(e=this.controller)||void 0===e||e.play()}pauseMedia(){var e;null===(e=this.controller)||void 0===e||e.pause()}seekMedia(e){var t;null===(t=this.controller)||void 0===t||t.seekTo(e)}stopMedia(){var e;null===(e=this.controller)||void 0===e||e.stop()}togglePauseMedia(){var e;null===(e=this.controller)||void 0===e||e.togglePlayPause()}isPaused(){if(void 0!==this.client&&void 0!==this.client.isPaused)return this.client.isPaused()}setMute(){void 0!==this.client&&void 0!==this.client.setMute&&this.client.setMute()}setUnMute(){void 0!==this.client&&void 0!==this.client.setUnMute&&this.client.setUnMute()}isMuted(){if(void 0!==this.client&&void 0!==this.client.isMuted)return this.client.isMuted()}setVolume(e){void 0!==this.client&&void 0!==this.client.setVolume&&this.client.setVolume(e)}getVolume(){if(void 0!==this.client&&void 0!==this.client.getVolume)return this.client.getVolume()}getPerfData(){if(void 0!==this.client&&void 0!==this.client.getPerfData)return this.client.getPerfData()}getPlaybackData(){if(void 0!==this.client&&void 0!==this.client.getPlaybackData)return this.client.getPlaybackData()}getCurrentTime(){if(void 0!==this.client&&void 0!==this.client.getCurrentTime)return this.client.getCurrentTime()}getDuration(){if(void 0!==this.client&&void 0!==this.client.getDuration)return this.client.getDuration()}ensure(){void 0!==this.client&&void 0!==this.client.ensureMediaClient&&this.client.ensureMediaClient(),this.showPoster()}postAuthToken(e){void 0!==this.client&&void 0!==this.client.postAuthToken&&this.client.postAuthToken(e)}cleanup(){var e;this.hidePoster(),void 0!==this.client&&void 0!==this.client.cleanUpMediaClient&&this.client.cleanUpMediaClient(),null===(e=this.controller)||void 0===e||e.cleanup()}showPoster(){var e;void 0!==this.poster&&(E.a.info(508691866,`Showing poster frame (correlationId: ${this.perfTracker.getCorrelationId()})`),this.poster.show(),null===(e=this.client)||void 0===e||e.setHidden())}hidePoster(){var e;void 0!==this.poster&&(E.a.info(508691865,`Hiding poster frame (correlationId: ${this.perfTracker.getCorrelationId()})`),this.poster.hide(),null===(e=this.client)||void 0===e||e.setVisible())}setUiHostType(e){var t;null===(t=this.playbackTracker)||void 0===t||t.setUiHostType(e)}setFlights(e){var t;null===(t=this.playbackTracker)||void 0===t||t.setFlights(e)}}function oe(e){return e.settings&&e.settings.uiHost?e.settings.uiHost.toLowerCase().indexOf("msteams")>-1?q.MSTeams:e.settings.uiHost.toLowerCase().indexOf("teamsandroid")>-1?q.TeamsAndroid:e.settings.uiHost.toLowerCase().indexOf("teamsios")>-1?q.TeamsiOS:e.settings.uiHost.toLowerCase().indexOf("unified app")>-1?q.UnifiedApp:e.settings.uiHost.toLowerCase().indexOf("bluechicken")>-1?q.BlueChicken:e.settings.uiHost.toLowerCase().indexOf("ssctestapp")>-1?q.SSCTestApp:(r.a.sendTraceTag(543454660,n.a.msoulscat_Wac_PptSession,a.a.Warning,"MediaHelper::getUIHostType Host type does not match known hosts. uiHost: "+e.settings.uiHost),q.Unknown):(r.a.sendTraceTag(543454659,n.a.msoulscat_Wac_PptSession,a.a.Warning,"MediaHelper::getUIHostType Unknown host type due to null settings or uiHost"),q.Unknown)}function le(e){return!(!e.settings||!e.settings.uiHost)&&-1!==e.settings.uiHost.toLowerCase().indexOf("teams")}function de(e){return!!le(e)&&(me(e)?ce():-1===window.navigator.userAgent.indexOf("Electron"))}function he(e){return oe(e)===q.UnifiedApp||oe(e)===q.BlueChicken||oe(e)===q.SSCTestApp}function ce(){const e=window.navigator.userAgent||window.navigator.vendor;return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substring(0,4)))}function ue(e){return!!l.Settings.readBooleanOrDefault("iOSHostOverride",!1)||e===q.TeamsiOS}function fe(e){return!!l.Settings.readBooleanOrDefault("iOSHostOverride",!1)||ue(oe(e))}function me(e){return fe(e)||oe(e)===q.TeamsAndroid||ce()}!function(e){e[e.None=0]="None",e[e.Image=1]="Image",e[e.Hlink=2]="Hlink",e[e.Silverlight=3]="Silverlight",e[e.HTML5=4]="HTML5",e[e.FlashObject=5]="FlashObject"}(H||(H={})),function(e){e[e.UnifiedApp=0]="UnifiedApp",e[e.MSTeams=1]="MSTeams",e[e.TeamsiOS=2]="TeamsiOS",e[e.TeamsAndroid=3]="TeamsAndroid",e[e.BlueChicken=4]="BlueChicken",e[e.SSCTestApp=5]="SSCTestApp",e[e.Unknown=6]="Unknown"}(q||(q={})),function(e){e[e.Low=0]="Low",e[e.Med=1]="Med",e[e.High=2]="High",e[e.Raw=3]="Raw"}($||($={}));class pe{static getCanPlayType(e){let t;if(-1!==e.indexOf("video"))t=document.createElement("video");else{if(-1===e.indexOf("audio"))return r.a.sendTraceTag(595637718,n.a.msoulscat_Wac_PptSession,a.a.Error,`MediaHelper::getCanPlayType(): Unexpected contentType ${e}.`),"";t=document.createElement("audio")}if(!t)return"";let i="";try{i=t.canPlayType(e)}catch(e){r.a.sendTraceTag(595637719,n.a.msoulscat_Wac_PptSession,a.a.Warning,`MediaHelper::getCanPlayType() throws exception: ${e}.`)}return i}static getMediaRenderAs(e){if("application/x-shockwave-flash"===e)return H.FlashObject;const t=pe.getCanPlayType(e);return"probably"===t||"maybe"===t||"video/quicktime"===e.toLowerCase()?H.HTML5:H.None}static getTranscodeMediaQuality(e,t,i,s){let o=$.Raw,d=$.Raw;l.Settings.readBooleanOrDefault("useNetworkForTranscodedMediaQuality",!0)&&e&&(d=e>=5?$.High:e>=2.5?$.Med:$.Low);let h=$.Low;const c=t.y*i.y;t&&(h=c>=900?$.High:c>=600?$.Med:$.Low);const u=me(s),f=u?$.Low:$.High;return o=Math.min(d,h,f),r.a.sendTraceTag(527028749,n.a.msoulscat_Wac_PptSession,a.a.Info,JSON.stringify({connectionSpeedInMbps:e,mediaSize:c,isMobile:u,networkBasedQuality:d,sizeBasedQuality:h,deviceBasedQuality:f,selectedMediaQuality:o})),o}static isStreamURL(e){try{return new URL(e).hostname.toLowerCase().endsWith("microsoftstream.com")}catch{return!1}}static convertYouTubeFlashUrlToIFrameUrl(e){let t=e;const i=t.indexOf("?");i>=0&&(t=t.substring(0,i));const r="youtube.com/v/".length,n=t.toLowerCase().indexOf("youtube.com/v/");return n>=0?(t=t.substring(0,n)+"youtube.com/embed/"+t.substring(n+r,t.length),t):e}static fIsSafeHyperlink(e){const t=document.createElement("a");t.href=e;try{return pe.isLinkable(t.href)}catch(e){return!1}}static stripIgnoredLinkChars(e){let t=0,i=e.length;for(;i>t&&-1!=="#%&*{}:<>?+.;(),!']\"".indexOf(e.charAt(i-1));)i-=1;for(;t<i&&-1!=="(['\"".indexOf(e.charAt(t));)t+=1;return e.substr(t,i-t)}static isLinkable(e){const t=["http://","https://","file://","file:\\\\","ftp://","mailto:","news:","\\\\","www.","onenote:"];let i=e.toLowerCase();i=pe.stripIgnoredLinkChars(i);const r=t.length;for(let i=0;i<r;i+=1)if(e.startsWith(t[i]))return!0;return!1}static controlVersion(){let e,t;try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),e=t.GetVariable("$version")}catch(e){}if(!e)try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),e="WIN 6,0,21,0",t.AllowScriptAccess="always",e=t.GetVariable("$version")}catch(e){}if(!e)try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3"),e=t.GetVariable("$version")}catch(e){}if(!e)try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3"),e="WIN 3,0,18,0"}catch(e){}if(!e)try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),e="WIN 2,0,0,11"}catch(t){e=-1}return e}static getSwfVer(){const e=-1!==navigator.appVersion.indexOf("MSIE"),t=-1!==navigator.appVersion.toLowerCase().indexOf("win"),i=-1!==navigator.userAgent.indexOf("Opera");let r="-1";if(null!=navigator.plugins&&navigator.plugins.length>0){if("object"==typeof navigator.plugins.namedItem("Shockwave Flash 2.0")||"object"==typeof navigator.plugins.namedItem("Shockwave Flash")){const e="object"==typeof navigator.plugins.namedItem("Shockwave Flash 2.0")?" 2.0":"",t=navigator.plugins.namedItem("Shockwave Flash"+e).description.split(" "),i=t[2].split("."),n=i[0],a=i[1];let s=t[3];""===s&&(s=t[4]),"d"===s[0]?s=s.substring(1):"r"===s[0]&&(s=s.substring(1),s.indexOf("d")>0&&(s=s.substring(0,s.indexOf("d")))),r=`${n}.${a}.${s}`}}else-1!==navigator.userAgent.toLowerCase().indexOf("webtv/2.6")?r="4":-1!==navigator.userAgent.toLowerCase().indexOf("webtv/2.5")?r="3":-1!==navigator.userAgent.toLowerCase().indexOf("webtv")?r="2":e&&t&&!i&&(r=pe.controlVersion());return r}static get fFlashInstalled(){let e;const t=pe.getSwfVer();if("-1"===t)return!1;if("0"!==t){e=-1!==t.indexOf("WIN")?t.split(" ")[1].split(","):t.split(".");const i=e[0],r=e[1],n=e[2];if(parseFloat(i)>10)return!0;if(10===parseFloat(i)){if(parseFloat(r)>1)return!0;if(1===parseFloat(r)&&parseFloat(n)>=0)return!0}return!1}return!1}static parseSeekTimeFromMediaCommandString(e,t){if(!e)return-1;const i=e.toLowerCase();if(i.length<=0)return-1;const r=i.indexOf("(");if(r<=0)return-1;const n=i.substring(0,r);if(n.length<=0)return-1;const a=i.indexOf(")");if("playfrom"===n){const e=i.substring(r+1,a),t=parseFloat(e);return isNaN(t)?-1:t}if("playfrombookmark"===n){const e=i.substring(r+1,a),n=t.find(t=>e.indexOf(t.name.toLowerCase())>=0);return n?n.time/1e3:-1}return-1}static getMediaTypeFromContentType(e){const t=e.indexOf("/");if(t>0)switch(e.substring(0,t)){case"video":return"Video";case"audio":return"Audio";default:return""}return""}static isBrowserSafari(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}class ge{static setNewStreamPlayer(e){void 0!==e?ge.newStreamPlayer=e:r.a.sendTraceTag(543994250,n.a.msoulscat_Wac_PptSession,a.a.Error,"StreamAuth: Trying to set newStreamPlayer when newStreamPlayer is undefined")}static postAadTokenToStream(e){se.setAADToken(e),void 0===this.newStreamPlayer||this.newStreamPlayer.postAuthToken(e)}}function _e(e,t,i){if(!i.metadata||!i.metadata.mediaSyncTimeLine)return void r.a.sendTraceTag(525103627,n.a.msoulscat_Wac_PptLive,a.a.Info,t+"::updateMediaSyncMetadataAndLog: Message doesn't contain metadata or mediaSyncTimeLine.");const s=`${t}: ${e}`;i.metadata.mediaSyncTimeLine.push(s),r.a.sendTraceTag(542955610,n.a.msoulscat_Wac_PptLive,a.a.Info,JSON.stringify({fileName:t,mediaSyncState:i}))}function ve(e){g.VetoUtils.recordVeto("CustomControlFailure",{errorName:e,qosVeto:"CustomControlFailure",isIntentional:!0})}ge.newStreamPlayer=void 0;class ye{constructor(e){this.presenterToPresenterWaitTimeMs=e}shouldSendMediaUpdate(){if(void 0!==this.lastRecievedEvent){const e=Date.now(),t=e-this.lastRecievedEvent,i=t<this.presenterToPresenterWaitTimeMs;if(r.a.sendTraceTag(520181122,n.a.msoulscat_Wac_PptSession,a.a.Info,`shouldSendMediaUpdate: Date.now(): ${e}, lastReceivedEvent: ${this.lastRecievedEvent}, timeElapsed: ${t},\n        presenterToPresenterWaitTimeMs: ${this.presenterToPresenterWaitTimeMs}, fSuppressUpdate: ${i}`),i)return!1}else r.a.sendTraceTag(520181121,n.a.msoulscat_Wac_PptSession,a.a.Info,"shouldSendMediaUpdate: lastReceivedEvent is undefined");return!0}updateLastTimeRecievedEvent(){this.lastRecievedEvent=Date.now()}}var be,Se,Te,we,Me,Ce,Ie,Pe,Ee,xe,Ae,ke,Re,Oe,Le=i(139),Fe=i(6),De=i(138);class Be{constructor(){this.totalBufferingTime=0,this.totalPlayingTime=0}}class Ne{constructor(e,t,i,r,n,a,s,o,d,h,c,u,f){this.isOnSlide=!1,this.isPlaying=!1,this.isStalled=!1,this.isFirstLoadStart=!0,this.isFirstLoadedMetadata=!0,this.isFirstCanPlay=!0,this.isFirstCanPlayThrough=!0,this.isFirstPlay=!0,this.isFirstPlaying=!0,this.wasNavigatingFrom=!1,this.player=e,this.creationTime=Date.now(),this.minTimeAfterAction=l.Settings.readNumberOrDefault("minTimeAfterActionForVideoVeto",5e3),this.summary=new Be,this.summary.uiHostType=q[r];const m={hlsJsFirst:l.Settings.readBooleanOrDefault("initializeHLSJsFirst",!1),useLoadedMetadata:l.Settings.readBooleanOrDefault("useLoadedMetadataAsInteractivityEvent",!0),iOSPreload:l.Settings.readBooleanOrDefault("iOSHlsPreload",!0),cleanupHlsJs:l.Settings.readBooleanOrDefault("cleanupHlsJsOnNavigatedFrom",!0),cleanupNativeHls:l.Settings.readBooleanOrDefault("cleanupNativeHlsOnNavigatedFrom",!0)};this.summary.flights=JSON.stringify(m),n&&(this.summary.mediaType=a===p.a.Video?"Video":"Audio",n.autoPlay&&(this.summary.isAutoPlay=!0),n.fullscreen&&(this.summary.fullscreen=!0),n.hideWhenStopped&&(this.summary.hideWhenStopped=!0),n.narration&&(this.summary.isNarration=!0),n.playAcrossSlides>0&&(this.summary.playAcrossSlides=n.playAcrossSlides),n.trimStartMs>0&&(this.summary.trimStartMs=n.trimStartMs),n.trimEndMs>0&&(this.summary.trimEndMs=n.trimEndMs),n.volume>0&&(this.summary.volume=n.volume),void 0!==n.repeat&&0!==n.repeat&&(this.summary.repeat=n.repeat),n.contentType&&(this.summary.contentType=n.contentType)),h&&(this.summary.mediaType="GIF",this.summary.isGif=!0,this.summary.isAutoPlay=!0,this.summary.repeat=-1),this.summary.slideNumber=s,this.summary.startFromTime=o,this.summary.initTime=d,this.summary.initialRetryCount=c,u&&(this.summary.isPrefetch=!0),this.pixelScale=t,this.addPlayerEventListeners(r),this.addSlideEventListeners(i),f&&(this.summary.teamsCallId=f)}static useLoadedMetadataAsInteractivityEvent(e){return ue(e)&&l.Settings.readBooleanOrDefault("useLoadedMetadataAsInteractivityEvent",!0)}static logEvent(e,t){r.a.sendTraceTag(542770816,n.a.msoulscat_Wac_PptSession,a.a.Info,`LocalMediaPlaybackPerf event tracking: Received ${e} event on media: ${t}`)}addPlayerEventListeners(e){this.player.addEventListener("loadstart",()=>{Ne.logEvent("loadstart",this.summary.mediaName),this.isFirstLoadStart&&(this.isFirstLoadStart=!1,this.summary.timeToLoadStartMs=Date.now()-this.creationTime,this.summary.timeToLoadedMetadataMs=void 0,this.summary.timeToInteractivityMs=void 0,this.summary.timeToCanPlayThroughMs=void 0,this.summary.timeToPlayMs=void 0,this.summary.timeToPlayingMs=void 0)}),this.player.addEventListener("loadedmetadata",()=>{Ne.logEvent("loadedmetadata",this.summary.mediaName),this.isFirstLoadedMetadata&&(this.isFirstLoadedMetadata=!1,this.summary.timeToLoadedMetadataMs=Date.now()-this.creationTime,Ne.useLoadedMetadataAsInteractivityEvent(e)?this.summary.timeToInteractivityMs=this.summary.timeToLoadedMetadataMs:this.summary.timeToInteractivityMs=void 0,this.summary.timeToPlayMs=void 0,this.summary.timeToPlayingMs=void 0,this.summary.durationMs=Math.round(1e3*this.player.duration),"Video"!==this.summary.mediaType&&"Audio"===this.summary.mediaType||(this.summary.sourceVideoWidth=this.player.videoWidth,this.summary.sourceVideoHeight=this.player.videoHeight,this.summary.width=Math.round(this.player.width*this.pixelScale.x),this.summary.height=Math.round(this.player.height*this.pixelScale.y)))}),this.player.addEventListener("canplay",()=>{Ne.logEvent("canplay",this.summary.mediaName),this.isFirstCanPlay&&this.isFirstCanPlayThrough&&(Ne.useLoadedMetadataAsInteractivityEvent(e)||(this.summary.timeToInteractivityMs=Date.now()-this.creationTime,this.summary.timeToPlayMs=void 0,this.summary.timeToPlayingMs=void 0)),this.isFirstCanPlay&&(this.isFirstCanPlay=!1,this.isFirstCanPlayThrough||r.a.sendTraceTag(540137693,n.a.msoulscat_Wac_PptSession,a.a.Error,"The 'canplaythrough' event was triggered before triggering the 'canplay' event on media: "+this.summary.mediaName))}),this.player.addEventListener("canplaythrough",()=>{Ne.logEvent("canplaythrough",this.summary.mediaName),this.isFirstCanPlay&&this.isFirstCanPlayThrough&&(Ne.useLoadedMetadataAsInteractivityEvent(e)||(this.summary.timeToInteractivityMs=Date.now()-this.creationTime,this.summary.timeToPlayMs=void 0,this.summary.timeToPlayingMs=void 0)),this.isFirstCanPlayThrough&&(this.isFirstCanPlayThrough=!1,this.summary.timeToCanPlayThroughMs=Date.now()-this.creationTime,this.isFirstCanPlay&&r.a.sendTraceTag(540137694,n.a.msoulscat_Wac_PptSession,a.a.Error,"No 'canplay' event was triggered before triggering the 'canplaythrough' event on media: "+this.summary.mediaName))}),this.player.addEventListener("play",()=>{this.checkPlayerNotReady("play"),Ne.logEvent("play",this.summary.mediaName),this.lastPlayTime=Date.now(),this.isFirstPlay&&(this.isFirstPlay=!1,this.summary.timeToPlayMs=this.lastPlayTime-this.creationTime,this.summary.timeToPlayingMs=void 0,this.isFirstCanPlay&&r.a.sendTraceTag(537773265,n.a.msoulscat_Wac_PptSession,a.a.Error,"No 'canplay' event was triggered before triggering the 'play' event on media: "+this.summary.mediaName))}),this.player.addEventListener("playing",()=>{Ne.logEvent("playing",this.summary.mediaName),this.isPlaying=!0,this.setTimeSincePlay(),this.isFirstPlaying&&void 0!==this.lastPlayTime&&(this.isFirstPlaying=!1,this.summary.timeToPlayingMs=Date.now()-this.lastPlayTime,this.isFirstPlay&&r.a.sendTraceTag(537773266,n.a.msoulscat_Wac_PptSession,a.a.Error,"No 'play' event was triggered before triggering the 'playing' event on media: "+this.summary.mediaName)),this.lastPlayTime=void 0,this.calculateBufferingTime(),void 0===this.lastPlayingTime&&(this.lastPlayingTime=Date.now())}),this.player.addEventListener("pause",()=>{this.checkPlayerNotReady("pause"),Ne.logEvent("pause",this.summary.mediaName),this.isPlaying=!1,this.isStalled=!1,this.setTimeSincePlay(),this.lastPlayTime=void 0,this.calculatePlayingTime()}),this.player.addEventListener("ended",()=>{this.checkPlayerNotReady("ended"),Ne.logEvent("ended",this.summary.mediaName),this.summary.wasPlayedUntilEnd=!0}),this.player.addEventListener("seeking",()=>{Ne.logEvent("seeking",this.summary.mediaName),this.setTimeSinceSeek(),this.lastSeekTime=Date.now()}),this.player.addEventListener("seeked",()=>{this.checkPlayerNotReady("seeked"),Ne.logEvent("seeked",this.summary.mediaName),this.setTimeSinceSeek(),this.lastSeekTime=void 0}),this.player.addEventListener("volumechange",()=>{this.checkPlayerNotReady("volumechange"),Ne.logEvent("volumechange",this.summary.mediaName)}),this.player.addEventListener("progress",()=>{Ne.logEvent("progress",this.summary.mediaName),this.isStalled=!1}),this.player.addEventListener("stalled",()=>{Ne.logEvent("stalled",this.summary.mediaName),this.isPlaying&&(this.isStalled=!0,void 0===this.summary.numberOfStalls?this.summary.numberOfStalls=1:this.summary.numberOfStalls+=1),this.calculatePlayingTime(),void 0===this.lastBufferTime&&(this.lastBufferTime=Date.now())}),this.player.addEventListener("error",()=>{Ne.logEvent("error",this.summary.mediaName);const e=null!==this.player.error?this.player.error.code:-1;void 0===this.summary.errorCode&&(this.summary.errorCode=e),this.isPlaying&&(this.playError=e)}),this.player.addEventListener("abort",()=>{Ne.logEvent("abort",this.summary.mediaName),this.calculatePlayingTime(),this.calculateBufferingTime()}),this.player.addEventListener("emptied",()=>{Ne.logEvent("emptied",this.summary.mediaName)}),this.player.addEventListener("loadeddata",()=>{Ne.logEvent("loadeddata",this.summary.mediaName)}),this.player.addEventListener("waiting",()=>{Ne.logEvent("waiting",this.summary.mediaName),this.calculatePlayingTime(),void 0===this.lastBufferTime&&(this.lastBufferTime=Date.now())}),this.player.addEventListener("suspend",()=>{Ne.logEvent("suspend",this.summary.mediaName)})}isAutoPlay(){return!!this.summary.isAutoPlay}onSourceSet(e){this.cleanup(),this.summary.timeToSourceSet=Date.now()-this.creationTime;const t=new URL(e);e.includes("MediaDownloadHandler")&&(this.summary.isMediaSnap=!0);const i=t.searchParams.get("mediaName");null!==i&&(this.summary.mediaName=i);const s=t.searchParams.get("ext");if(null!==s)this.summary.mediaExtension=s;else{const e=t.searchParams.get("mediaId");if(null!==e){const t=/^.+\.([^\.]+)\.media$/.exec(e);null!==t&&2===t.length&&(this.summary.mediaExtension=t[1])}}const o=t.searchParams.get("mediaLength");null!==o&&(this.summary.mediaLength=parseInt(o,10));const l=t.searchParams.get("retries");null!==l&&(this.summary.retriesLeft=parseInt(l,10));const d=t.searchParams.get("requestGuid");null!==d&&(this.summary.requestGuid=d),this.summary.isEnabledTranscodingFlight=null===t.searchParams.get("disableTranscode");const h=t.searchParams.get("docId");null!==h&&Fe.ChangeGate.isChangeGateEnabled("SVM.LogDocIdHash")&&(this.summary.docIdHash=Object(De.createHash)("sha256").update(h,"utf8").digest("hex")),r.a.sendTraceTag(508364564,n.a.msoulscat_Wac_PptSession,a.a.Info,"SourceSet "+JSON.stringify(this.summary))}setInClickSequence(){this.summary.isInClickSequence=!0,r.a.sendTraceTag(508364563,n.a.msoulscat_Wac_PptSession,a.a.Info,"Video playback started through animation.")}setMediaQuality(e){void 0===this.summary.initialQuality&&(this.summary.initialQuality=e),this.summary.finalQuality=e,this.summary.initialQuality!==$.Raw&&e===$.Raw&&void 0===this.summary.fallbackTime&&(this.summary.fallbackTime=Date.now(),this.summary.fallbackRetryCount=this.summary.retriesLeft)}setHls(e){e?this.summary.isHls=!0:this.summary.isHls&&void 0===this.summary.hlsFallbackTime&&(this.summary.hlsFallbackTime=Date.now(),this.summary.hlsFallbackRetryCount=this.summary.retriesLeft)}setHlsAndTranscoding(e,t){e&&t&&void 0===this.summary.hlsTranscodingTime?this.summary.hlsTranscodingTime=Date.now():e&&!t&&void 0===this.summary.hlsRawTime?this.summary.hlsRawTime=Date.now():e||t||void 0!==this.summary.progressiveRawTime||(this.summary.progressiveRawTime=Date.now())}setPlayRequestTime(){void 0===this.summary.playRequestTime&&(this.summary.playRequestTime=Date.now())}setPlaybackControlsFlag(){this.summary.isUsingPlaybackControls=!0}onNavigatingTo(){this.wasNavigatingFrom&&(this.wasNavigatingFrom=!1)}setWhenClickedOn(){this.summary.isWhenClickedOn=!0,r.a.sendTraceTag(508364562,n.a.msoulscat_Wac_PptSession,a.a.Info,"Video playback started by clicking on custom play button.")}addSlideEventListeners(e){e.on("navigatedTo",()=>{this.isOnSlide?r.a.sendTraceTag(556048642,n.a.msoulscat_Wac_PptSession,a.a.Error,"Already on this slide"):(this.isOnSlide=!0,this.summary.timeToNavigatedTo=Date.now()-this.creationTime,this.summary.timeToNavigatingFrom=void 0,this.summary.isInClickSequence=void 0,this.summary.isWhenClickedOn=void 0,Ne.sendNavigatedTo&&(Ne.sendNavigatedTo=!1,r.a.sendTraceTag(559453667,n.a.msoulscat_Wac_PptSession,a.a.Info,"Navigated to a slide with a local "+this.summary.mediaType)))}),e.on("navigatingFrom",()=>{this.isOnSlide?(this.isOnSlide=!1,this.summary.timeToNavigatingFrom=Date.now()-this.creationTime,void 0===this.summary.numberOfStalls&&void 0===this.summary.errorCode&&!this.isStalled&&void 0===this.playError&&void 0===this.lastPlayTime&&void 0===this.timeSincePlay&&void 0===this.lastSeekTime&&void 0===this.timeSinceSeek&&this.isFirstLoadStart&&this.isFirstLoadedMetadata&&this.isFirstCanPlay&&this.isFirstPlay&&this.isFirstPlaying||(void 0!==this.summary.timeToPlayingMs&&(this.summary.lastVolume=Math.round(100*this.player.volume),this.summary.lastIsMuted=this.player.muted),l.Settings.readBooleanOrDefault("forceSvg",!1)&&(this.summary.isSVG=!0),this.calculatePlayingTime(),this.calculateBufferingTime(),void 0===this.summary.navigationCount&&(this.summary.navigationCount=0),r.a.sendTraceTag(570750435,n.a.msoulscat_Wac_PptSession,a.a.Info,"NavigatingFrom "+JSON.stringify(this.summary)),this.summary.hlsBandwidthEstimate=void 0,this.summary.hlsTranscodingTime=void 0,this.summary.hlsRawTime=void 0,this.summary.progressiveRawTime=void 0,this.summary.playRequestTime=void 0,this.summary.wasVetoLogged=void 0,this.summary.navigationCount+=1,this.cleanup(),this.playError=void 0,this.wasNavigatingFrom=!0)):r.a.sendTraceTag(556048643,n.a.msoulscat_Wac_PptSession,a.a.Error,"Not on this slide yet")})}cleanup(){this.summary.wasPlayedUntilEnd=void 0,this.summary.numberOfStalls=void 0,this.summary.errorCode=void 0,this.isPlaying=!1,this.isStalled=!1,this.lastPlayTime=void 0,this.timeSincePlay=void 0,this.lastSeekTime=void 0,this.timeSinceSeek=void 0,this.isFirstLoadStart=!0,this.isFirstLoadedMetadata=!0,this.isFirstCanPlay=!0,this.isFirstCanPlayThrough=!0,this.isFirstPlay=!0,this.isFirstPlaying=!0,this.lastBufferTime=void 0,this.lastPlayingTime=void 0,this.summary.totalBufferingTime=0,this.summary.totalPlayingTime=0}setTimeSincePlay(){if(void 0===this.lastPlayTime)return 0;const e=Date.now()-this.lastPlayTime;return e<this.minTimeAfterAction?0:(this.timeSincePlay=void 0!==this.timeSincePlay?Math.max(this.timeSincePlay,e):e,e)}setTimeSinceSeek(){if(void 0===this.lastSeekTime)return 0;const e=Date.now()-this.lastSeekTime;return e<this.minTimeAfterAction?0:(this.timeSinceSeek=void 0!==this.timeSinceSeek?Math.max(this.timeSinceSeek,e):e,e)}checkPlayerNotReady(e){void 0===this.summary.timeToInteractivityMs&&r.a.sendTraceTag(529332098,n.a.msoulscat_Wac_PptSession,a.a.Info,`${this.summary.mediaType} ${this.summary.mediaName} emitted ${e} event before being interactive.`)}calculateBufferingTime(){if(void 0!==this.lastBufferTime){const e=Date.now()-this.lastBufferTime;this.summary.totalBufferingTime+=e,this.lastBufferTime=void 0}}calculatePlayingTime(){if(void 0!==this.lastPlayingTime){const e=Date.now()-this.lastPlayingTime;this.summary.totalPlayingTime+=e,this.lastPlayingTime=void 0}}setHlsBandwidthEstimate(e){this.summary.hlsBandwidthEstimate=e}vetoLogged(){this.summary.wasVetoLogged=!0}}Ne.sendNavigatedTo=!0,function(e){e.MediaPlaybackFailed="MediaPlaybackFailed",e.MediaPlaybackInterrupted="MediaPlaybackInterrupted",e.MediaPerfSlow="MediaPerfSlow"}(be||(be={})),function(e){e.VideoNotPlayedWithSeek="VideoNotPlayedWithSeek",e.VideoNotPlayed="VideoNotPlayed",e.VideoNotPlayedWithSeekOnLastRetry="VideoNotPlayedWithSeekOnLastRetry",e.VideoNotPlayedOnLastRetry="VideoNotPlayedOnLastRetry"}(Se||(Se={})),function(e){e.VideoNotPlayedWithSeekSubsequent="VideoNotPlayedWithSeekSubsequent",e.VideoNotPlayedSubsequent="VideoNotPlayedSubsequent",e.VideoNotResumed="VideoNotResumed",e.VideoErrorAfterPlaying="VideoErrorAfterPlaying",e.VideoNotSeeked="VideoNotSeeked"}(Te||(Te={})),function(e){e.VideoStalledExcessively="VideoStalledExcessively",e.VideoNotPlayedWaiting="VideoNotPlayedWaiting",e.VideoPlayedSlow="VideoPlayedSlow",e.VideoResumedSlow="VideoResumedSlow",e.VideoSeekedSlow="VideoSeekedSlow"}(we||(we={}));class Ve{constructor(e,t,i,s,o,d,h,c,u){this.isSeekInProgress=!1,this.isReady=!1,this.numberOfStalls=0,this.hlsErrorTypes=new Set,this.hlsErrorDetails=new Set,this.player=e,this.mediaName=t,this.mediaType=i===p.a.Video?"Video":"Audio",this.isTeams=d,this.isTeamsWeb=h,this.isMobileDevice=o,this.isReadyOnLoadedMetadata=s,this.onQualityImpactErrorCallback=c,this.onNotAllowedError=u,r.a.sendTraceTag(528599055,n.a.msoulscat_Wac_PptSession,a.a.Info,"Creating controller "+this.state),this.seekPrecision=l.Settings.readNumberOrDefault("videoSeekPrecision",.1),this.slowToPlayingTime=l.Settings.readNumberOrDefault("minTimeForSlowToPlayingVeto",1e4),this.notPlayingTime=l.Settings.readNumberOrDefault("minTimeForNotPlayingVeto",1e4),this.slowToSeekedTime=l.Settings.readNumberOrDefault("minTimeForSlowToSeekedVeto",1e4),this.notSeekedTime=l.Settings.readNumberOrDefault("minTimeForNotSeekedVeto",1e4),this.slowToResumedTime=l.Settings.readNumberOrDefault("minTimeForSlowToResumedVeto",1e4),this.notResumedTime=l.Settings.readNumberOrDefault("minTimeForNotResumedVeto",1e4),this.mediaMaxNotPlayingTime=l.Settings.readNumberOrDefault("maxTimeForVideoNotPlayedVeto",1e4),this.notPlayingAfterErrorTime=l.Settings.readNumberOrDefault("minTimeForNotPlayingAfterErrorVeto",1e3),this.minStallCount=l.Settings.readNumberOrDefault("stalledCountForGoodStalledVeto",3),e.addEventListener("loadedmetadata",()=>this.onLoadedMetadata()),e.addEventListener("canplay",()=>this.onCanPlay()),e.addEventListener("play",()=>this.onPlay()),e.addEventListener("playing",()=>this.onPlaying()),e.addEventListener("seeking",()=>this.onSeeking()),e.addEventListener("seeked",()=>this.onSeeked()),e.addEventListener("pause",()=>this.onPause()),e.addEventListener("ended",()=>this.onEnded()),e.addEventListener("error",()=>this.onError()),e.addEventListener("stalled",()=>this.onStalled()),this.isMobileDevice&&document.addEventListener("visibilitychange",()=>this.onVisibilityChange())}onSourceSet(e,t,i,s,o,l){this.requestGuid=e,this.retriesLeft=t,this.mediaLength=i,this.isTranscoding=s,this.isHls=o,this.navigationCount=l,this.isSeekInProgress=!1,this.isReady=!1,this.numberOfStalls=0,r.a.sendTraceTag(528599056,n.a.msoulscat_Wac_PptSession,a.a.Info,"Setting source "+this.state)}onNavigatingTo(){r.a.sendTraceTag(528599057,n.a.msoulscat_Wac_PptSession,a.a.Info,"Navigating to "+this.state),this.isPlayOrPausePending=void 0,this.pendingSeekTime=void 0,this.clearTimeoutHelper(),this.playTime=void 0,this.seekTime=void 0,this.clearStallTracking()}onNavigatingFrom(){if(r.a.sendTraceTag(528599058,n.a.msoulscat_Wac_PptSession,a.a.Info,"Navigating from "+this.state),this.clearTimeoutHelper(),void 0!==this.playTime&&void 0!==this.seekTime){const e=this.timeElapsedWhileVisibleFrom(this.playTime);e>=this.notPlayingTime&&this.onQualityImpactError(this.wasPlaying?be.MediaPlaybackInterrupted:be.MediaPlaybackFailed,this.wasPlaying?Te.VideoNotPlayedWithSeekSubsequent:Se.VideoNotPlayedWithSeek,`${this.mediaType} is not playing with seek ${this.wasPlaying?"during subsequent playback ":""}after: ${e}`),this.playTime=void 0,this.seekTime=void 0}if(void 0!==this.playTime){const e=this.timeElapsedWhileVisibleFrom(this.playTime);e>=this.notPlayingTime&&this.onQualityImpactError(this.wasPlaying?be.MediaPlaybackInterrupted:be.MediaPlaybackFailed,this.wasPlaying?Te.VideoNotPlayedSubsequent:Se.VideoNotPlayed,`${this.mediaType} is not playing ${this.wasPlaying?"during subsequent playback ":""}after: ${e}`),this.playTime=void 0}if(void 0!==this.seekTime){const e=this.timeElapsedWhileVisibleFrom(this.seekTime);e>=this.notSeekedTime&&this.onQualityImpactError(be.MediaPlaybackInterrupted,Te.VideoNotSeeked,`${this.mediaType} is not seeked after: ${e}`),this.seekTime=void 0}if(void 0!==this.stallTime){const e=this.timeElapsedWhileVisibleFrom(this.stallTime);if(Fe.ChangeGate.isChangeGateEnabled("SVM.FixVideoNotResumedVeto")){const t=(e,t)=>{if(void 0!==e&&void 0!==t)return e-t},i=e=>{if(void 0!==e)return Math.abs(e)},s=t(this.player.currentTime,this.playerTimeAtStall),o=i(t(s,e/1e3));r.a.sendTraceTag(512567435,n.a.msoulscat_Wac_PptSession,a.a.Info,`Stall tracking. timeSinceStall: ${e}, playerTimeElapsedSinceStallSec: ${s}, diffPlayedTimeStallTimeSec: ${o}, ${this.state}`),e>=this.notResumedTime&&(!o||o>this.seekPrecision)&&this.onQualityImpactError(be.MediaPlaybackInterrupted,Te.VideoNotResumed,`${this.mediaType} is not resumed after: ${e}`)}else e>=this.notResumedTime&&this.onQualityImpactError(be.MediaPlaybackInterrupted,Te.VideoNotResumed,`${this.mediaType} is not resumed after: ${e}`);this.clearStallTracking()}0!==this.numberOfStalls&&(this.numberOfStalls>=this.minStallCount&&this.onQualityImpactError(be.MediaPerfSlow,we.VideoStalledExcessively,`${this.mediaType} was stalled excessively: ${this.numberOfStalls}`),this.numberOfStalls=0),l.Settings.readBooleanOrDefault("cleanupLocalPlayerOnNavigatedFrom",!0)&&(this.isSeekInProgress=!1,this.isReady=!1,this.firstPlayingTime=void 0)}playOrPause(e){e&&void 0===this.m_maxWaitingMediaNotPlayingTimeout&&(this.m_maxWaitingMediaNotPlayingTimeout=window.setTimeout(()=>{this.mediaPlayingWaitingTimeout()},this.mediaMaxNotPlayingTime)),e&&void 0===this.playTime&&(this.playTime=Date.now()),this.isReady?this.doPlayOrPause(e):(e?r.a.sendTraceTag(528599059,n.a.msoulscat_Wac_PptSession,a.a.Info,"Delaying playing "+this.state):r.a.sendTraceTag(528599060,n.a.msoulscat_Wac_PptSession,a.a.Info,"Delaying pausing "+this.state),this.isPlayOrPausePending=e)}seek(e){void 0===this.seekTime&&(this.seekTime=Date.now()),this.isReady?this.doSeek(e):(r.a.sendTraceTag(528599061,n.a.msoulscat_Wac_PptSession,a.a.Info,`Delaying seeking ${this.state} to: ${e}`),this.pendingSeekTime=e)}setHls(e){this.isHls=e}setIsTranscoding(e){this.isTranscoding=e}isSeeking(){return!!this.isSeekInProgress&&!(this.player.paused&&this.player.currentTime<=this.seekPrecision)}onLoadedMetadata(){r.a.sendTraceTag(528599062,n.a.msoulscat_Wac_PptSession,a.a.Info,"LoadedMetadata event "+this.state),this.isReadyOnLoadedMetadata&&this.onReady()}onCanPlay(){r.a.sendTraceTag(528599063,n.a.msoulscat_Wac_PptSession,a.a.Info,"CanPlay event "+this.state),this.onReady()}onPlay(){r.a.sendTraceTag(528599064,n.a.msoulscat_Wac_PptSession,a.a.Info,"Play event "+this.state),this.isReady=!1}mediaPlayingWaitingTimeout(){if(void 0!==this.playTime){const e=Date.now()-this.playTime;this.onQualityImpactError(be.MediaPerfSlow,we.VideoNotPlayedWaiting,`${this.mediaType} is still not playing after: ${e}`)}}clearTimeoutHelper(){window.clearTimeout(this.m_maxWaitingMediaNotPlayingTimeout),this.m_maxWaitingMediaNotPlayingTimeout=void 0,window.clearTimeout(this.mediaNotResumedAfterErrorTimeout),this.mediaNotResumedAfterErrorTimeout=void 0}onPlaying(){if(r.a.sendTraceTag(528599065,n.a.msoulscat_Wac_PptSession,a.a.Info,"Playing event "+this.state),this.clearTimeoutHelper(),this.firstPlayingTime=Date.now(),void 0!==this.playTime){const e=this.timeElapsedWhileVisibleFrom(this.playTime);e>=this.slowToPlayingTime&&this.onQualityImpactError(be.MediaPerfSlow,we.VideoPlayedSlow,`${this.mediaType} was playing after: ${e}`),this.playTime=void 0}if(void 0!==this.stallTime){const e=this.timeElapsedWhileVisibleFrom(this.stallTime);e>=this.slowToResumedTime&&this.onQualityImpactError(be.MediaPerfSlow,we.VideoResumedSlow,`${this.mediaType} was resumed after: ${e}`),this.clearStallTracking()}this.onReady()}onSeeking(){r.a.sendTraceTag(528599104,n.a.msoulscat_Wac_PptSession,a.a.Info,"Seeking event "+this.state),this.isSeekInProgress=!0,this.isReady=!1}onSeeked(){if(r.a.sendTraceTag(528599105,n.a.msoulscat_Wac_PptSession,a.a.Info,"Seeked event "+this.state),void 0!==this.seekTime){const e=Date.now()-this.seekTime;e>=this.slowToSeekedTime&&this.onQualityImpactError(be.MediaPerfSlow,we.VideoSeekedSlow,`${this.mediaType} was seeked after: ${e}`),this.seekTime=void 0}this.isSeekInProgress=!1,this.onReady()}onPause(){r.a.sendTraceTag(528599106,n.a.msoulscat_Wac_PptSession,a.a.Info,"Pause event "+this.state),this.clearTimeoutHelper(),this.playTime=void 0,this.clearStallTracking(),this.onReady()}onEnded(){r.a.sendTraceTag(528599107,n.a.msoulscat_Wac_PptSession,a.a.Info,"Ended event "+this.state),this.clearStallTracking()}setVetoTimerForPlaybackInterruptionAfterError(e){window.clearTimeout(this.mediaNotResumedAfterErrorTimeout),this.mediaNotResumedAfterErrorTimeout=window.setTimeout((e,t)=>{this.onQualityImpactError(be.MediaPlaybackInterrupted,Te.VideoErrorAfterPlaying,`${this.mediaType} error, not resumed after playing with error code ${e} after: ${this.timeElapsedWhileVisibleFrom(t)}`)},this.notPlayingAfterErrorTime,e,this.firstPlayingTime)}getLastErrorCode(){return null!==this.player.error?this.player.error.code:-1}onError(){const e=this.getLastErrorCode();if(r.a.sendTraceTag(528599108,n.a.msoulscat_Wac_PptSession,a.a.Info,`Error event ${this.state} errorCode: ${e}`),0===this.retriesLeft&&!this.wasPlaying){if(void 0!==this.playTime&&void 0!==this.seekTime){const t=Date.now()-this.playTime;t>=this.notPlayingTime&&this.onQualityImpactError(be.MediaPlaybackFailed,Se.VideoNotPlayedWithSeekOnLastRetry,`${this.mediaType} is not playing with seek on last retry with error code ${e} after: ${t}`),this.playTime=void 0,this.seekTime=void 0}if(void 0!==this.playTime){const t=Date.now()-this.playTime;t>=this.notPlayingTime&&this.onQualityImpactError(be.MediaPlaybackFailed,Se.VideoNotPlayedOnLastRetry,`${this.mediaType} is not playing on last retry with error code ${e} after: ${t}`),this.playTime=void 0}}void 0!==this.firstPlayingTime&&(r.a.sendTraceTag(520161375,n.a.msoulscat_Wac_PptSession,a.a.Error,`${this.mediaType} playback interrupted after playing with error code: ${e} for mediaName: ${this.mediaName}`),void 0===this.mediaNotResumedAfterErrorTimeout&&this.setVetoTimerForPlaybackInterruptionAfterError(e)),this.isSeekInProgress=!1,this.isReady=!1}get wasPlaying(){return void 0!==this.firstPlayingTime}doPlayOrPause(e){if(this.isPlayOrPausePending=void 0,r.a.sendTraceTag(520410972,n.a.msoulscat_Wac_PptSession,a.a.Info,`LocalMediaPlaybackController.doPlayOrPause: isPlay: ${e}, this.player.paused: ${this.player.paused}, this.state: ${this.state}`),e===this.player.paused){let t=!1;return e?(r.a.sendTraceTag(528599109,n.a.msoulscat_Wac_PptSession,a.a.Info,"Playing "+this.state),this.player.play().catch(e=>{r.a.sendTraceTag(528599110,n.a.msoulscat_Wac_PptSession,a.a.Error,`Play promise failed ${this.state} error: ${e.name} muted: ${this.player.muted} isTeams: ${this.isTeams} isTeamsWeb: ${this.isTeamsWeb} message: ${e.message}`),"NotAllowedError"===e.name&&!this.player.muted&&this.isTeamsWeb?(this.player.muted=!0,this.doPlayOrPause(!0)):(r.a.sendTraceTag(520161373,n.a.msoulscat_Wac_PptSession,a.a.Error,`Play promise failed unexepectedly ${this.state} error: ${e.name} muted: ${this.player.muted} isTeams: ${this.isTeams} isTeamsWeb: ${this.isTeamsWeb} message: ${e.message} isCloseToEndOfMediaResource: ${this.isCloseToEndOfMediaResource()}`),Fe.ChangeGate.isChangeGateEnabled("SVM.ShowPlayButtonOnNotAllowedError")&&"NotAllowedError"===e.name&&"Video"===this.mediaType&&(t=!0,this.isReady=!0,this.clearTimeoutHelper(),this.playTime=void 0,this.onNotAllowedError()))})):(r.a.sendTraceTag(528599111,n.a.msoulscat_Wac_PptSession,a.a.Info,"Pausing "+this.state),this.clearTimeoutHelper(),this.playTime=void 0,this.clearStallTracking(),this.player.pause()),void(t||(this.isReady=!1))}e?r.a.sendTraceTag(527241492,n.a.msoulscat_Wac_PptSession,a.a.Info,"Skipping playing "+this.state):r.a.sendTraceTag(527241493,n.a.msoulscat_Wac_PptSession,a.a.Info,"Skipping pausing "+this.state),this.clearTimeoutHelper(),this.playTime=void 0}doSeek(e){return this.pendingSeekTime=void 0,e<0||e>this.player.duration?(r.a.sendTraceTag(526984739,n.a.msoulscat_Wac_PptSession,a.a.Info,`Skipping out-of-bounds seeking ${this.state} to: ${e}`),this.seekTime=void 0,!1):Math.abs(e-this.player.currentTime)>this.seekPrecision?(r.a.sendTraceTag(528599112,n.a.msoulscat_Wac_PptSession,a.a.Info,`Seeking ${this.state} to: ${e}`),this.clearStallTracking(),this.isSeekInProgress=!0,this.isReady=!1,this.player.currentTime=e,!0):(r.a.sendTraceTag(527241494,n.a.msoulscat_Wac_PptSession,a.a.Info,`Skipping seeking ${this.state} to: ${e}`),this.seekTime=void 0,!1)}onStalled(){void 0!==this.playTime||void 0!==this.seekTime||void 0!==this.stallTime||this.isSeekInProgress||this.player.paused?r.a.sendTraceTag(526161288,n.a.msoulscat_Wac_PptSession,a.a.Info,"Skipped stalled event "+this.state):(this.stallTime=Date.now(),this.playerTimeAtStall=this.player.currentTime,this.numberOfStalls+=1,r.a.sendTraceTag(527193424,n.a.msoulscat_Wac_PptSession,a.a.Info,"Stalled event "+this.state))}onReady(){this.isReady=!0,void 0!==this.pendingSeekTime&&this.doSeek(this.pendingSeekTime)||void 0===this.isPlayOrPausePending||this.isSeekInProgress||this.doPlayOrPause(this.isPlayOrPausePending)}get state(){return`mediaName: ${this.mediaName}\n      requestGuid: ${this.requestGuid}\n      networkState: ${this.player.networkState}\n      readyState: ${this.player.readyState}\n      isReadyOnLoadedMetadata: ${this.isReadyOnLoadedMetadata}\n      currentTime: ${this.player.currentTime}\n      visibility: ${document.visibilityState}`}onQualityImpactError(e,t,i){if(r.a.sendTraceTag(526934468,n.a.msoulscat_Wac_PptSession,a.a.Info,`${i} ${this.state}`),!this.isMobileDevice||"hidden"!==document.visibilityState){this.localMediaPlaybackPerf&&this.localMediaPlaybackPerf.vetoLogged();const r={impactType:e,errorName:t,details:i,mediaName:this.mediaName,mediaType:this.mediaType,requestGuid:this.requestGuid,networkState:this.player.networkState,readyState:this.player.readyState,isReadyOnLoadedMetadata:this.isReadyOnLoadedMetadata,currentTime:this.player.currentTime,paused:this.player.paused,muted:this.player.muted,mediaLength:this.mediaLength,visibility:document.visibilityState,retriesLeft:this.retriesLeft,isTeams:this.isTeams,isTeamsWeb:this.isTeamsWeb,isTranscoding:this.isTranscoding,isHls:this.isHls,navigationCount:this.navigationCount,hlsErrorTypes:Array.from(this.hlsErrorTypes),hlsErrorDetails:Array.from(this.hlsErrorDetails),hlsBandwidthEstimate:this.hlsBandwidthEstimate};this.onQualityImpactErrorCallback(r),l.Settings.readBooleanOrDefault("alertMediaVeto",!1)&&window.alert(`MediaQualityImpactInfo: ${e}-${t}, ${i} ${this.state}`),this.clearHlsErrors()}}isCloseToEndOfMediaResource(){return!isNaN(this.player.duration)&&this.player.currentTime>this.player.duration-this.seekPrecision}addHlsError(e,t){this.hlsErrorTypes.add(e),this.hlsErrorDetails.add(t)}clearHlsErrors(){this.hlsErrorTypes.clear(),this.hlsErrorDetails.clear()}setHlsBandwidthEstimate(e){this.hlsBandwidthEstimate=e}clearStallTracking(){this.stallTime=void 0,this.playerTimeAtStall=void 0}onVisibilityChange(){"visible"===document.visibilityState?this.lastBecameVisibleTime=Date.now():"hidden"===document.visibilityState&&(this.lastHideTime=Date.now())}timeElapsedWhileVisibleFrom(e){const t=Date.now();if(void 0===this.lastBecameVisibleTime&&void 0===this.lastHideTime)return t-e;const i=void 0===this.lastHideTime?0:Math.max(0,this.lastHideTime-e);return void 0!==this.lastBecameVisibleTime?i+(void 0!==this.lastHideTime&&this.lastHideTime>this.lastBecameVisibleTime?0:t-Math.max(this.lastBecameVisibleTime,e)):i}setLocalMediaPlaybackPerf(e){this.localMediaPlaybackPerf=e}}!function(e){e[e.DisabledNotVideo=0]="DisabledNotVideo",e[e.DisabledNotMediaSnap=1]="DisabledNotMediaSnap",e[e.DisabledUrlParameter=2]="DisabledUrlParameter",e[e.EnabledOriginalNotPlayable=3]="EnabledOriginalNotPlayable",e[e.DisabledOnlyPlayableBrs=4]="DisabledOnlyPlayableBrs",e[e.DisabledNoMp4Brs=5]="DisabledNoMp4Brs",e[e.DisabledTooSmallForDesktopBrs=6]="DisabledTooSmallForDesktopBrs",e[e.Enabled=7]="Enabled",e[e.DisabledNoHls=8]="DisabledNoHls"}(Me||(Me={})),function(e){e[e.DisabledNotVideo=0]="DisabledNotVideo",e[e.DisabledNotMediaSnap=1]="DisabledNotMediaSnap",e[e.DisabledUrlParameter=2]="DisabledUrlParameter",e[e.DisabledNotMp4AndNotTranscoding=3]="DisabledNotMp4AndNotTranscoding",e[e.Enabled=4]="Enabled"}(Ce||(Ce={})),function(e){e[e.Raw=0]="Raw",e[e.LowNoMultivariantMobileBrs=1]="LowNoMultivariantMobileBrs",e[e.All=2]="All"}(Ie||(Ie={})),function(e){e[e.DisabledNoHls=0]="DisabledNoHls",e[e.EnabledProbably=1]="EnabledProbably",e[e.EnabledMaybe=2]="EnabledMaybe",e[e.DisabledNotSupported=3]="DisabledNotSupported"}(Pe||(Pe={})),function(e){e[e.DisabledNoHls=0]="DisabledNoHls",e[e.DisabledOriginalNotPlayable=1]="DisabledOriginalNotPlayable",e[e.DisabledNotMp4=2]="DisabledNotMp4",e[e.Enabled=3]="Enabled"}(Ee||(Ee={})),function(e){e[e.Unplayable=0]="Unplayable",e[e.HLSTranscoding=1]="HLSTranscoding",e[e.HLSRaw=2]="HLSRaw",e[e.ProgressiveRaw=3]="ProgressiveRaw"}(xe||(xe={})),function(e){e[e.Unplayable=0]="Unplayable",e[e.Progressive=1]="Progressive",e[e.HLSjs=2]="HLSjs",e[e.NativeHLS=3]="NativeHLS",e[e.ProgressiveNoHLS=4]="ProgressiveNoHLS"}(Ae||(Ae={})),function(e){e[e.Unplayable=0]="Unplayable",e[e.Raw=1]="Raw",e[e.RawNoHLS=2]="RawNoHLS",e[e.Transcoding=3]="Transcoding"}(ke||(ke={})),function(e){e[e.Raw=0]="Raw",e[e.Low=1]="Low",e[e.All=2]="All"}(Re||(Re={})),function(e){e[e.StoppedRetrying=0]="StoppedRetrying",e[e.Unloaded=1]="Unloaded",e[e.NotYetStarted=2]="NotYetStarted",e[e.Retrying=3]="Retrying",e[e.SourceSet=4]="SourceSet",e[e.LoadStart=5]="LoadStart",e[e.LoadedMetadata=6]="LoadedMetadata",e[e.CanPlay=7]="CanPlay"}(Oe||(Oe={}));class Ue{constructor(e,t,i,s,o,l,d,h,c,u,f,m,p,g,_,v,y){this.m_playbackOptions=[],this.m_navigationCount=0,this.m_loadingState=Oe.NotYetStarted,this.m_hlsJsManifestLoaded=!1,this.m_hlsJsAutoRecoverRetryCount=0,this.m_playbackOption=xe.Unplayable,this.m_hlsOption=Ae.Unplayable,this.m_transcodingOption=ke.Unplayable,this.m_transcodingUrlParam=Re.Raw,this.m_element=e,this.m_url=t,this.m_mediaName=i,this.m_isMediaSnap=s,this.m_originalMediaLength=o,this.m_isOriginalPlayable=l,this.m_isVideo=d,this.m_isMP4=h,this.m_isMobileDevice=c,this.m_uiHostType=u,this.m_requestGuid=p,this.m_localMediaPlaybackPerf=g,this.m_localMediaPlaybackController=_,this.m_localMediaPlaybackTelemetry=y,this.m_onFatalError=v,this.m_transcodingState=this.getTranscodingState(),this.m_hlsState=this.getHlsState(),this.m_transcodingState=this.isHlsEnabled()?this.m_transcodingState:Me.DisabledNoHls,this.m_transcodingQuality=this.getTranscodingQuality(),this.m_nativeHlsState=this.getNativeHlsState(),this.m_hlsRawState=this.getHlsRawState(),this.m_initialRetryCount=this.getInitialRetryCount(f),this.m_initialRetryDelayMs=this.getInitialRetryDelay();const b=[];this.isHlsTranscodingEnabled()&&(this.m_playbackOptions.push(xe.HLSTranscoding),b.push(xe[xe.HLSTranscoding])),this.isHlsRawEnabled()&&(this.m_playbackOptions.push(xe.HLSRaw),b.push(xe[xe.HLSRaw])),this.m_isOriginalPlayable&&(this.m_playbackOptions.push(xe.ProgressiveRaw),b.push(xe[xe.ProgressiveRaw]));const S={mediaName:i,isMediaSnap:s,originalMediaLength:o,isOriginalPlayable:l,isVideo:d,isMP4:h,isMobileDevice:c,uiHostType:q[u],requestGuid:p,transcodingState:Me[this.m_transcodingState],transcodingQuality:Ie[this.m_transcodingQuality],hlsState:Ce[this.m_hlsState],nativeHlsState:Pe[this.m_nativeHlsState],hlsRawState:Ee[this.m_hlsRawState],initialRetryCount:this.m_initialRetryCount,initialRetryDelayMs:this.m_initialRetryDelayMs,playbackOptions:b.toString()};r.a.sendTraceTag(512271880,n.a.msoulscat_Wac_PptSession,a.a.Info,JSON.stringify(S)),this.m_retriesRemaining=this.m_initialRetryCount,this.m_retryDelayMs=this.m_initialRetryDelayMs,this.m_url.hostname=this.m_url.hostname.toLowerCase().replace(".pods.",".media."),this.m_url.searchParams.set("usid",m),this.m_url.searchParams.set("requestGuid",this.m_requestGuid),this.m_element.addEventListener("loadstart",()=>{this.m_loadingState=Oe.LoadStart}),this.m_element.addEventListener("loadedmetadata",()=>{this.m_loadingState=Oe.LoadedMetadata}),this.m_element.addEventListener("canplay",()=>{this.m_loadingState!==Oe.CanPlay&&(this.m_loadingState=Oe.CanPlay,this.onCanPlay())}),this.m_element.addEventListener("error",()=>{this.onError()})}isUnplayable(){return 0===this.m_playbackOptions.length}shouldSkipCleanup(){return!l.Settings.readBooleanOrDefault("cleanupLocalPlayerOnNavigatedFrom",!0)||!(l.Settings.readBooleanOrDefault("cleanupLocalPlayerOnNavigatedFromForAutoPlayedVideos",!0)||!this.m_localMediaPlaybackPerf.isAutoPlay())||!l.Settings.readBooleanOrDefault("cleanupHlsJsOnNavigatedFrom",!0)&&this.m_hlsOption===Ae.HLSjs||!l.Settings.readBooleanOrDefault("cleanupNativeHlsOnNavigatedFrom",!0)&&this.m_hlsOption===Ae.NativeHLS}cleanupPlayerOnNavigatedFrom(){this.m_navigationCount+=1,this.shouldSkipCleanup()||(r.a.sendTraceTag(512271879,n.a.msoulscat_Wac_PptSession,a.a.Info,"cleanupPlayerOnNavigatedFrom mediaName: "+this.m_mediaName),this.m_loadingState=Oe.Unloaded,this.cancelRetryTimeout(),this.destroyHlsJsInstance(),this.m_element.src&&(this.m_element.removeAttribute("src"),this.m_element.load()))}resetPlayerOnNavigatingTo(){this.m_loadingState>=Oe.Retrying||(r.a.sendTraceTag(512271878,n.a.msoulscat_Wac_PptSession,a.a.Info,"resetPlayerOnNavigatingTo mediaName: "+this.m_mediaName),this.setSource())}setSource(){this.m_loadingState!==Oe.NotYetStarted&&this.m_loadingState!==Oe.StoppedRetrying&&r.a.sendTraceTag(509436766,n.a.msoulscat_Wac_PptSession,a.a.Error,"Unexpected loadingState in setSourceAsync"),this.m_retriesRemaining=this.m_initialRetryCount,this.m_retryDelayMs=this.m_initialRetryDelayMs,this.m_loadingState=Oe.NotYetStarted,this.cancelRetryTimeout(),this.setSourceAsync()}async setSourceAsync(){if(this.isUnplayable())return r.a.sendTraceTag(512271877,n.a.msoulscat_Wac_PptSession,a.a.Error,"Unexpected setSourceAsync with isUnplayable"),void this.stopRetrying();this.destroyHlsJsInstance(),this.m_hlsJsManifestLoaded=!1,this.m_hlsJsAutoRecoverRetryCount=0,await this.importHlsJsIfNecessaryAsync(),this.m_playbackOption=this.getPlaybackOption(),this.m_hlsOption=this.getHlsOption(),this.m_transcodingOption=this.getTranscodingOption(),this.m_transcodingUrlParam=this.getTranscodingUrlParam();const e=this.isHlsSelected(),t=this.isTranscodingSelected(),i=!t&&!this.m_isOriginalPlayable,s={mediaName:this.m_mediaName,requestGuid:this.m_requestGuid,navigationCount:this.m_navigationCount,retryCount:this.getRetryCount(),playbackOption:xe[this.m_playbackOption],hlsOption:Ae[this.m_hlsOption],transcodingOption:ke[this.m_transcodingOption],transcodingUrlParam:Re[this.m_transcodingUrlParam],isHls:e,isTranscoding:t,isUnplayable:i},o=i?a.a.Error:a.a.Info;if(r.a.sendTraceTag(512271876,n.a.msoulscat_Wac_PptSession,o,JSON.stringify(s)),i)return void this.stopRetrying();this.updateUrlParams(),this.m_localMediaPlaybackPerf.onSourceSet(this.m_url.toString()),this.m_localMediaPlaybackPerf.setHlsAndTranscoding(e,t),this.m_localMediaPlaybackTelemetry&&(this.m_localMediaPlaybackTelemetry.onSourceSet(this.m_url.toString()),this.m_localMediaPlaybackTelemetry.setHlsAndTranscoding(e,t)),this.m_localMediaPlaybackController.onSourceSet(this.m_requestGuid,this.m_retriesRemaining,this.m_originalMediaLength,t,e,this.m_navigationCount),this.m_loadingState=Oe.SourceSet;const l=this.addPreloadParam(this.getUrlWithSlashes());this.m_hlsOption===Ae.HLSjs&&this.m_hls?(this.m_hls.loadSource(l),this.m_hls.attachMedia(this.m_element)):this.m_element.src=l}updateUrlParams(){this.m_url.searchParams.set("retries",this.m_retriesRemaining.toString()),this.m_url.searchParams.set("transcode",Re[this.m_transcodingUrlParam])}getUrlWithSlashes(){const e=this.m_url.toString();return this.isHlsSelected()?e.replace(/[?&]/g,"/")+"/index.m3u8":e}addPreloadParam(e){return ue(this.m_uiHostType)&&l.Settings.readBooleanOrDefault("iOSHlsPreload",!0)?e+"#t=0.1":e}getHlsOption(){if(this.isUnplayable())return Ae.Unplayable;if(!this.isHls())return Ae.Progressive;if(l.Settings.readBooleanOrDefault("initializeHLSJsFirst",!1)){if(this.tryInitializeHlsJsInstance())return Ae.HLSjs;if(this.isNativeHlsEnabled())return Ae.NativeHLS}else{if(this.isNativeHlsEnabled())return Ae.NativeHLS;if(this.tryInitializeHlsJsInstance())return Ae.HLSjs}return Ae.ProgressiveNoHLS}isHlsSelected(){return this.m_hlsOption===Ae.HLSjs||this.m_hlsOption===Ae.NativeHLS}getTranscodingOption(){return this.isUnplayable()?ke.Unplayable:this.isHlsTranscoding()?this.isHlsSelected()?ke.Transcoding:ke.RawNoHLS:ke.Raw}isTranscodingSelected(){return this.m_transcodingOption===ke.Transcoding}getTranscodingUrlParam(){if(!this.isTranscodingSelected())return Re.Raw;switch(this.m_transcodingQuality){case Ie.All:return Re.All;case Ie.LowNoMultivariantMobileBrs:return Re.Low;default:return Re.Raw}}async importHlsJsIfNecessaryAsync(){if(!this.isHls())return;if(Ue.s_hlsJs)return;if(!self.MediaSource&&!self.WebKitMediaSource)return;const e=Date.now();try{Ue.s_hlsJs=await i.e(12).then(i.t.bind(null,461,7)),r.a.sendTraceTag(509436765,n.a.msoulscat_Wac_PptSession,a.a.Info,`HLS.js successfully loaded in ${Date.now()-e} ms`)}catch(t){r.a.sendTraceTag(509436764,n.a.msoulscat_Wac_PptSession,a.a.Error,`HLS.js failed to load in ${Date.now()-e} ms exception: ${t} mediaName: ${this.m_mediaName}`)}}tryInitializeHlsJsInstance(){if(this.m_hls)return!0;if(!Ue.s_hlsJs)return!1;if(!Ue.s_hlsJs.default.isSupported())return r.a.sendTraceTag(512271874,n.a.msoulscat_Wac_PptSession,a.a.Error,"HLS.js is not supported mediaName: "+this.m_mediaName),!1;const e=!Fe.ChangeGate.isChangeGateEnabled("SVM.DisableHLSProgressiveStream"),t=this.m_isMobileDevice?l.Settings.readNumberOrDefault("hlsBackBufferLengthMobile",1/0):l.Settings.readNumberOrDefault("hlsBackBufferLength",1/0);return this.m_hls=new Ue.s_hlsJs.default({progressive:e,backBufferLength:t}),this.m_hls.on(Ue.s_hlsJs.default.Events.MANIFEST_LOADED,e=>{this.m_hlsJsManifestLoaded=!0}),this.m_hls.on(Ue.s_hlsJs.default.Events.FRAG_BUFFERED,e=>{if(this.m_hls){const e=this.m_hls.bandwidthEstimate;this.m_localMediaPlaybackPerf.setHlsBandwidthEstimate(e),this.m_localMediaPlaybackController.setHlsBandwidthEstimate(e),this.m_localMediaPlaybackTelemetry&&this.m_localMediaPlaybackTelemetry.setHlsBandwidthEstimate(e)}}),this.m_hls.on(Ue.s_hlsJs.default.Events.ERROR,(e,t)=>{this.onHlsJsError(t)}),!0}destroyHlsJsInstance(){this.m_hls&&(this.m_hls.destroy(),this.m_hls=void 0)}onHlsJsError(e){const t=this.m_hlsJsManifestLoaded&&this.m_hlsJsAutoRecoverRetryCount<=l.Settings.readNumberOrDefault("maxHlsAutoRecoverRetryCount",2),i={mediaName:this.m_mediaName,requestGuid:this.m_requestGuid,navigationCount:this.m_navigationCount,retryCount:this.getRetryCount(),playbackOption:xe[this.m_playbackOption],hlsOption:Ae[this.m_hlsOption],transcodingOption:ke[this.m_transcodingOption],transcodingUrlParam:Re[this.m_transcodingUrlParam],isHls:this.isHlsSelected(),isTranscoding:this.isTranscodingSelected(),isFatal:e.fatal,errorType:e.type,errorReason:e.reason,errorDetails:e.details,loadingState:Oe[this.m_loadingState],wasManifestLoaded:this.m_hlsJsManifestLoaded,isAutorecoveryEnabled:t,autorecoveryRetryCount:this.m_hlsJsAutoRecoverRetryCount},s=e.fatal?a.a.Error:a.a.Warning;if(r.a.sendTraceTag(512271873,n.a.msoulscat_Wac_PptSession,s,JSON.stringify(i)),e.fatal){if(this.m_localMediaPlaybackController.addHlsError(e.type,e.details),t&&Ue.s_hlsJs&&this.m_hls)switch(e.type){case Ue.s_hlsJs.default.ErrorTypes.NETWORK_ERROR:return this.m_hls.startLoad(),void(this.m_hlsJsAutoRecoverRetryCount+=1);case Ue.s_hlsJs.default.ErrorTypes.MEDIA_ERROR:return this.m_hls.recoverMediaError(),void(this.m_hlsJsAutoRecoverRetryCount+=1)}this.retryLoading()}}onError(){const e=this.m_element.error?this.m_element.error.code:-1,t=this.m_element.error?this.m_element.error.message:"",i={mediaName:this.m_mediaName,requestGuid:this.m_requestGuid,navigationCount:this.m_navigationCount,retryCount:this.getRetryCount(),playbackOption:xe[this.m_playbackOption],hlsOption:Ae[this.m_hlsOption],transcodingOption:ke[this.m_transcodingOption],transcodingUrlParam:Re[this.m_transcodingUrlParam],isHls:this.isHlsSelected(),isTranscoding:this.isTranscodingSelected(),isFatal:!0,errorCode:e,errorMessage:t,loadingState:Oe[this.m_loadingState]};r.a.sendTraceTag(512271872,n.a.msoulscat_Wac_PptSession,a.a.Error,JSON.stringify(i)),this.m_loadingState<Oe.LoadStart?r.a.sendTraceTag(509436763,n.a.msoulscat_Wac_PptSession,a.a.Error,"Unexpected error before loadstart"):this.retryLoading()}onCanPlay(){const e={mediaName:this.m_mediaName,requestGuid:this.m_requestGuid,navigationCount:this.m_navigationCount,retryCount:this.getRetryCount(),playbackOption:xe[this.m_playbackOption],hlsOption:Ae[this.m_hlsOption],transcodingOption:ke[this.m_transcodingOption],transcodingUrlParam:Re[this.m_transcodingUrlParam],isHls:this.isHlsSelected(),isTranscoding:this.isTranscodingSelected(),loadingState:Oe[this.m_loadingState]};r.a.sendTraceTag(509380167,n.a.msoulscat_Wac_PptSession,a.a.Info,JSON.stringify(e))}stopRetrying(){this.m_loadingState=Oe.StoppedRetrying,this.cancelRetryTimeout(),this.m_onFatalError()}retryLoading(){this.m_retriesRemaining<=0?this.stopRetrying():(this.m_retriesRemaining-=1,this.m_loadingState=Oe.Retrying,this.cancelRetryTimeout(),this.m_retryTimeoutId=window.setTimeout(()=>{this.setSourceAsync()},this.getRetryDelay()))}cancelRetryTimeout(){void 0!==this.m_retryTimeoutId&&(window.clearTimeout(this.m_retryTimeoutId),this.m_retryTimeoutId=void 0)}getRetryDelay(){if(this.getRetryCount()<this.m_playbackOptions.length)return 1;const e=l.Settings.readNumberOrDefault("mediaRetryMultiplier",Ue.RETRY_DELAY_MULTIPLIER);return this.m_retryDelayMs*=e,this.m_retryDelayMs}getInitialRetryCount(e){let t=e;return this.isHlsTranscodingEnabled()&&(t+=1),this.isHlsRawEnabled()&&(t+=1),t}getInitialRetryDelay(){return l.Settings.readNumberOrDefault("mediaRetryInitialDelayMs",Ue.RETRY_INITIAL_DELAY_MS)}getTranscodingState(){return this.m_isVideo?this.m_isMediaSnap?null!==this.m_url.searchParams.get("disableTranscode")?Me.DisabledUrlParameter:this.m_isOriginalPlayable?l.Settings.readBooleanOrDefault("onlyTranscodeUnplayableVideos",!1)?Me.DisabledOnlyPlayableBrs:l.Settings.readBooleanOrDefault("noMP4Transcoding",!1)&&this.m_isMP4?Me.DisabledNoMp4Brs:this.m_originalMediaLength>0&&this.m_originalMediaLength<l.Settings.readNumberOrDefault("minVideoSizeToTranscodeForDesktopBytes",1e7)&&!this.m_isMobileDevice?Me.DisabledTooSmallForDesktopBrs:Me.Enabled:Me.EnabledOriginalNotPlayable:Me.DisabledNotMediaSnap:Me.DisabledNotVideo}getHlsState(){return this.m_isVideo?this.m_isMediaSnap?null!==this.m_url.searchParams.get("disableHLS")?Ce.DisabledUrlParameter:this.m_isMP4||this.isTranscodingEnabled()?Ce.Enabled:Ce.DisabledNotMp4AndNotTranscoding:Ce.DisabledNotMediaSnap:Ce.DisabledNotVideo}getTranscodingQuality(){return this.isTranscodingEnabled()?!l.Settings.readBooleanOrDefault("multivariantPlaylistEnabledOnMobile",!1)&&this.m_isMobileDevice?Ie.LowNoMultivariantMobileBrs:Ie.All:Ie.Raw}getNativeHlsState(){if(!this.isHlsEnabled())return Pe.DisabledNoHls;const e=this.m_element.canPlayType("application/vnd.apple.mpegurl");return"probably"===e?Pe.EnabledProbably:"maybe"===e?Pe.EnabledMaybe:Pe.DisabledNotSupported}getHlsRawState(){return this.isHlsEnabled()?this.m_isOriginalPlayable?this.m_isMP4?Ee.Enabled:Ee.DisabledNotMp4:Ee.DisabledOriginalNotPlayable:Ee.DisabledNoHls}isTranscodingEnabled(){return this.m_transcodingState===Me.EnabledOriginalNotPlayable||this.m_transcodingState===Me.Enabled}isHlsEnabled(){return this.m_hlsState===Ce.Enabled}isNativeHlsEnabled(){return this.m_nativeHlsState===Pe.EnabledProbably||this.m_nativeHlsState===Pe.EnabledMaybe}isHlsRawEnabled(){return this.m_hlsRawState===Ee.Enabled}isHlsTranscodingEnabled(){return this.isHlsEnabled()&&this.isTranscodingEnabled()}getRetryCount(){return this.m_initialRetryCount-this.m_retriesRemaining}getPlaybackOption(){return this.isUnplayable()?xe.Unplayable:this.m_playbackOptions[Math.min(this.getRetryCount(),this.m_playbackOptions.length-1)]}isHlsTranscoding(){return this.getPlaybackOption()===xe.HLSTranscoding}isHlsRaw(){return this.getPlaybackOption()===xe.HLSRaw}isHls(){return this.isHlsTranscoding()||this.isHlsRaw()}}Ue.RETRY_INITIAL_DELAY_MS=600,Ue.RETRY_DELAY_MULTIPLIER=2;var We=i(38);class ze{constructor(e,t,i,r,n,a){this.isOnSlide=!1,this.pixelScale=n,this.summary={mediaName:e.name,mediaType:p.a[t],slideNumber:i.viewDataManager.getSlideIndex(r),isAutoPlay:e.autoPlay||void 0,isTeams:le(i)||void 0,isTeamsWeb:de(i)||void 0,teamsCallId:i.settings.teamsCallId,isMobile:me(i)||void 0,width:Math.round(a.x*this.pixelScale.x),height:Math.round(a.y*this.pixelScale.y),navigationCount:0,uiHostType:We.UIHostType[oe(i)]}}onNavigatedTo(){this.isOnSlide?r.a.sendTraceTag(508350612,n.a.msoulscat_Wac_PptSession,a.a.Error,`Already on slide with online video (name: ${this.summary.mediaName})`):(this.isOnSlide=!0,this.timeToNavigatedTo=Date.now(),this.timeToNavigatingFrom=void 0,ze.sendNavigatedTo&&(ze.sendNavigatedTo=!1,r.a.sendTraceTag(520685077,n.a.msoulscat_Wac_PptSession,a.a.Info,`Navigated to a slide with an online video (name: ${this.summary.mediaName})`)))}onNavigatingFrom(e){this.isOnSlide?e?(this.isOnSlide=!1,this.timeToNavigatingFrom=Date.now(),this.summary.timeToInit=e.timeToInit,this.summary.timeToHubbleToken=e.timeToHubbleToken,this.summary.timeToOEmbedResponse=e.timeToOEmbedResponse,this.summary.timeToNavigatedToEmbedPage=e.timeToNavigatedToEmbedPage,this.summary.timeToPostMessagingInitialized=e.timeToPostMessagingInitialized,this.summary.timeToODSPVideoLoadStart=e.timeToODSPVideoLoadStart,this.summary.timeToInteractivity=e.timeToInteractivity,this.summary.timeToFirstPlayIntent=e.timeToFirstPlayIntent,this.summary.timeToFirstPlay=e.timeToFirstPlay,this.summary.timeToFirstPlaying=e.timeToFirstPlaying,this.summary.timeToError=e.timeToError,this.summary.timeToNavigatedTo=this.timeToNavigatedTo,this.summary.timeToNavigatingFrom=this.timeToNavigatingFrom,this.summary.wasPlayedUntilEnd=e.wasPlayedUntilEnd,this.summary.duration=e.duration,this.summary.lastVolume=e.lastVolume,this.summary.lastIsMuted=e.lastMuteState,this.summary.errorName=e.errorName,this.summary.errorMessage=e.errorMessage,this.summary.wasVetoLogged=e.wasVetoLogged,this.summary.totalBufferingTime=e.totalBufferingTime,this.summary.totalPlayingTime=e.totalPlayingTime,this.summary.creationTime=e.creationTime,this.summary.correlationId=e.correlationId,r.a.sendTraceTag(520685074,n.a.msoulscat_Wac_PptSession,a.a.Info,"NavigatingFrom "+JSON.stringify(this.summary)),this.summary.navigationCount+=1,this.summary.isInClickSequence=void 0,this.summary.wasMediaSyncedOnReady=void 0):r.a.sendTraceTag(508350609,n.a.msoulscat_Wac_PptSession,a.a.Error,`No online video performance data was collected (name: ${this.summary.mediaName})`):r.a.sendTraceTag(508350610,n.a.msoulscat_Wac_PptSession,a.a.Error,`Not on slide with online video (name: ${this.summary.mediaName}) yet`)}setInClickSequence(){this.summary.isInClickSequence=!0,r.a.sendTraceTag(508350607,n.a.msoulscat_Wac_PptSession,a.a.Info,`Online video playback started through animation (name: ${this.summary.mediaName})`)}setMediaSyncedOnReady(){this.summary.wasMediaSyncedOnReady=!0,r.a.sendTraceTag(508350606,n.a.msoulscat_Wac_PptSession,a.a.Info,`Online video synced to Media Sync state on ready (name: ${this.summary.mediaName})`)}}ze.sendNavigatedTo=!0;var Ge,je=i(37);class He{constructor(e,t){this.m_mediaPlayButton=e,t?this.setPlayButtonVisible():this.setPlayButtonHidden()}setPlayButtonVisible(){this.m_mediaPlayButton.style.display="block",this.m_mediaPlayButton.style.pointerEvents="visible"}setPlayButtonHidden(){this.m_mediaPlayButton.style.display="none"}isPlayButtonVisible(){return"none"!==this.m_mediaPlayButton.style.display}}function qe(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}class $e{constructor(e){this.m_mediaRetryButton=e}setRetryButtonVisible(){this.m_mediaRetryButton.style.display="block",this.m_mediaRetryButton.style.pointerEvents="visible"}setRetryButtonHidden(){this.m_mediaRetryButton.style.display="none"}}class Ze{constructor(e,t){this.m_startTime=0,this.m_lastMediaTime=0,this.m_videoFrameCount=0,this.m_isActive=!1,this.m_renderFrameCount=0,this.videoFrameCallback=(e,t)=>{Math.abs(t.mediaTime-this.m_lastMediaTime)>0&&(this.m_videoFrameCount+=1,this.m_lastMediaTime=t.mediaTime),this.m_isActive&&this.m_videoEl.requestVideoFrameCallback(this.videoFrameCallback)},this.m_videoEl=e,this.m_metadata=t,this.m_metadata.dirtyRectTracking=l.Settings.readBooleanOrDefault("enableDirtyRectTracking",!1),this.m_metadata.hostContainer=l.Settings.readStringOrDefault("hostContainer","undefined")}start(){this.m_startTime=performance.now(),this.m_renderFrameCount=0,this.m_videoFrameCount=0,this.m_isActive=!0,"requestVideoFrameCallback"in HTMLVideoElement.prototype&&(this.m_lastMediaTime=0,this.m_videoEl.requestVideoFrameCallback(this.videoFrameCallback))}stop(e){const t=performance.now()-this.m_startTime;if(t>0){const i=1e3*this.m_renderFrameCount/t,s=1e3*this.m_videoFrameCount/t,o={Metadata:{...this.m_metadata,...e},VideoFrameCount:this.m_videoFrameCount,VideoFrameRate:s.toFixed(2),RenderedFrameCount:this.m_renderFrameCount,RenderFrameRate:i.toFixed(2),Duration:t.toFixed(0),Length:this.m_videoEl.duration};r.a.sendTraceTag(512279298,n.a.msoulscat_Wac_PptSession,a.a.Info,JSON.stringify(o))}this.m_isActive=!1}updateRenderFrameCount(){this.m_renderFrameCount+=1}get isActive(){return this.m_isActive}}class Xe{constructor(e,t){this.m_mediaSyncEmitter=e,this.m_mediaActionEmitter=t}onPlayClick(){this.emitEventAndAction(1,1)}onPauseClick(){this.emitEventAndAction(0,0)}onVolumeClick(){this.emitEvent(4,4)}onVolumeChanged(){this.emitEvent(4,5)}onSeeked(){this.emitEventAndAction(3,3)}emitEvent(e,t){this.m_mediaSyncEmitter&&this.m_mediaSyncEmitter(e,t)}emitEventAndAction(e,t){this.m_mediaSyncEmitter&&this.m_mediaSyncEmitter(e,t),this.m_mediaActionEmitter&&this.m_mediaActionEmitter(t)}}class Ye{static getPosition(e){const t=e.bottom-this.s_videoControlsHeight,i=e.left;return new p.b(i,t)}static getMediaControlInfo(e,t,i){return{position:this.getPosition(t),size:{x:t.width,y:this.s_videoControlsHeight},zIndex:2,trimInfo:{trimStartMs:e.props.trimStartMs,trimEndMs:e.props.trimEndMs},cssUrl:this.getCssPath(i),screenReaderInfo:this.getLocalizedStrings(),controlHidingEnabled:l.Settings.readBooleanOrDefault("playbackControlHidingEnabled",!1),widthThresholdForHidingControls:l.Settings.readNumberOrDefault("thresholdForHidingPlaybackControls",275)}}static getLocalizedStrings(){return"undefined"!=typeof PowerpointSlideshowStrings?{progressBarStr:PowerpointSlideshowStrings.CustomControlAccessibilityLabelProgressBar,playButtonStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelPlayButton,pauseButtonStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelPauseButton,muteButtonStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelMuteButton,unmuteButtonStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelUnmuteButton,volumeSliderStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelVolumeSlider,localizedLabelsStr:[PowerpointSlideshowStrings.CustomControlsAccessibilityLabelHour,PowerpointSlideshowStrings.CustomControlsAccessibilityLabelHours,PowerpointSlideshowStrings.CustomControlsAccessibilityLabelMinute,PowerpointSlideshowStrings.CustomControlsAccessibilityLabelMinutes,PowerpointSlideshowStrings.CustomControlsAccessibilityLabelSecond,PowerpointSlideshowStrings.CustomControlsAccessibilityLabelSeconds],localizedTimeStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelVideoTime,progressStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelVideoProgress,captionsButtonStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelClosedCaptionsButton,speedButtonStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelPlaybackSpeedButton,fullScreenButtonStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelFullScreenButton,captionsMenuStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelClosedCaptionsMenu,captionsMenuOffOptionStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelClosedCaptionsMenuOffOption,speedMenuOptionStr:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelPlaybackSpeedMenuOption}:{progressBarStr:"Video Progress Bar",playButtonStr:"Video Play",pauseButtonStr:"Video Pause",muteButtonStr:"Video Mute",unmuteButtonStr:"Video Unmute",volumeSliderStr:"Volume Level Slider",localizedLabelsStr:["hour","hours","minute","minutes","second","seconds"],localizedTimeStr:"{0} {1} {2} {3} {4} {5}",progressStr:"{0} of {1}",captionsButtonStr:"Video Closed Captions",speedButtonStr:"Video Playback Speed",fullScreenButtonStr:"Video Full Screen",captionsMenuStr:"Video Closed Captions Menu",captionsMenuOffOptionStr:"Off",speedMenuOptionStr:"{0}x"}}static getTooltipMap(){return Fe.ChangeGate.isChangeGateEnabled("SVM.useLocalizedTooltipStrings")&&"undefined"!=typeof PowerpointSlideshowStrings?new Map([["Play",new Le.b(PowerpointSlideshowStrings.CustomControlsTooltipLabelPlayPresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelPlayAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelPlay)],["Pause",new Le.b(PowerpointSlideshowStrings.CustomControlsTooltipLabelPausePresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelPauseAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelPause)],["Mute",new Le.b(PowerpointSlideshowStrings.CustomControlsTooltipLabelMutePresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelMuteAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelMute)],["Unmute",new Le.b(PowerpointSlideshowStrings.CustomControlsTooltipLabelUnmutePresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelUnmuteAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelUnmute)],["Captions",new Le.b(PowerpointSlideshowStrings.CustomControlsTooltipLabelCaptionsPresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelCaptionsAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelCaptions)],["Captions disabled",new Le.b(PowerpointSlideshowStrings.CustomControlsTooltipLabelCaptionsDisabledPresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelCaptionsDisabledAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelCaptionsDisabled)],["Seek",new Le.b(PowerpointSlideshowStrings.CustomControlsTooltipLabelSeekPresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelSeekAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelSeek)],["Playback speed",new Le.b(PowerpointSlideshowStrings.CustomControlsTooltipLabelSpeedPresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelSpeedAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelSpeed)],["Volume slider",new Le.b(PowerpointSlideshowStrings.CustomControlsTooltipLabelVolumeSliderPresenter,PowerpointSlideshowStrings.CustomControlsTooltipLabelVolumeSliderAttendee,PowerpointSlideshowStrings.CustomControlsTooltipLabelVolumeSlider)],["Full screen",new Le.b(PowerpointSlideshowStrings.CustomControlsTooltipLabelFullScreen,PowerpointSlideshowStrings.CustomControlsTooltipLabelFullScreen,PowerpointSlideshowStrings.CustomControlsTooltipLabelFullScreen)]]):new Map([["Play",new Le.b("Play for everyone","Play for me only","Play")],["Pause",new Le.b("Pause for everyone","Pause for me only","Pause")],["Mute",new Le.b("Mute for everyone","Mute for me only","Mute")],["Unmute",new Le.b("Unmute for everyone","Unmute for me only","Unmute")],["Captions",new Le.b("Show closed captions for me only","Show closed captions for me only","Show closed captions")],["Captions disabled",new Le.b("Video does not contain closed captions","Video does not contain closed captions","Video does not contain closed captions")],["Seek",new Le.b("Play from here for everyone","Play from here for me only","Play from here")],["Playback speed",new Le.b("Set playback speed for me only","Set playback speed for me only","Set playback speed")],["Volume slider",new Le.b("Adjust volume for me only","Adjust volume for me only","Adjust volume")],["Full screen",new Le.b("Full screen","Full screen","Full screen")]])}static getCssPath(e){return oe(e)===q.SSCTestApp?"PlaybackControls.css":e.settings.jsScriptsBasePath&&e.settings.applicationLcid?Fe.ChangeGate.isChangeGateEnabled("SVM.lowercaseUrl")?e.settings.jsScriptsBasePath.replace("pptscripts/ssapp/",`pptresources/${e.settings.applicationLcid}/PlaybackControls.css`):e.settings.jsScriptsBasePath.replace("pptscripts/ssapp/",`PptResources/${e.settings.applicationLcid}/PlaybackControls.css`):(r.a.sendTraceTag(509646339,n.a.msoulscat_Wac_PptSession,a.a.Warning,"PlaybackControls: Custom controls css path is empty"),g.VetoUtils.recordVeto("CustomControlFailure",{errorName:"NoCssPath",qosVeto:"CustomControlFailure",isIntentional:!0}),"")}}Ye.s_videoControlsHeight=50,function(e){e[e.Audio=0]="Audio",e[e.Video=1]="Video",e[e.GIF=2]="GIF",e[e.StreamClassic=3]="StreamClassic",e[e.YouTube=4]="YouTube",e[e.Vimeo=5]="Vimeo",e[e.Flip=6]="Flip",e[e.Ted=7]="Ted",e[e.Stream2=8]="Stream2",e[e.SlideShare=9]="SlideShare",e[e.Other=10]="Other"}(Ge||(Ge={}));class Je extends ne{constructor(e,t,i,r){super(e,"Local",t,i,r),this.isFirstCanPlay=!0,this.isFirstCanPlayThrough=!0,this.isFirstPlay=!0,this.useLoadedMetadataAsInteractivityEvent=!1,this.localData={},this.useLoadedMetadataAsInteractivityEvent=G.a.getBoolean("useLoadedMetadataAsInteractivityEvent")}onLoadStart(){this.localData.timeOfLoadedMetadata=void 0,this.localData.timeOfCanPlayThrough=void 0,super.onLoadStart()}onLoadedMetadata(){void 0===this.localData.timeOfLoadedMetadata&&(this.localData.timeOfLoadedMetadata=Date.now(),this.useLoadedMetadataAsInteractivityEvent?this.baseData.timeOfCanPlay=this.localData.timeOfLoadedMetadata:this.baseData.timeOfCanPlay=void 0,this.baseData.timeOfPlay=void 0,this.baseData.timeOfPlaying=void 0)}onCanPlay(){this.isFirstCanPlay&&this.isFirstCanPlayThrough&&(this.useLoadedMetadataAsInteractivityEvent||super.onCanPlay(),this.isFirstCanPlay&&(this.isFirstCanPlay=!1,this.isFirstCanPlayThrough||E.a.error(508695704,"The 'canplaythrough' event was triggered before triggering the 'canplay' event on media: "+this.baseData.loggableMediaId)),super.onCanPlay())}onCanPlayThrough(){this.isFirstCanPlayThrough&&(this.isFirstCanPlayThrough=!1,this.localData.timeOfCanPlayThrough=Date.now(),this.isFirstCanPlay&&E.a.error(508704418,"No 'canplay' event was triggered before triggering the 'canplaythrough' event on media: "+this.baseData.loggableMediaId))}onPlay(){super.onPlay(),this.isFirstPlay&&(this.isFirstPlay=!1,this.isFirstCanPlay&&E.a.error(508704417,"No 'canplay' event was triggered before triggering the 'play' event on media: "+this.baseData.loggableMediaId))}onStalled(){this.isPlaying&&(void 0===this.localData.numberOfStalls?this.localData.numberOfStalls=1:this.localData.numberOfStalls+=1)}cleanup(){this.isFirstCanPlay=!0,this.isFirstCanPlayThrough=!0,this.isFirstPlay=!0,super.cleanup()}getPlaybackData(){return Object.assign(Object.assign({},super.getPlaybackData()),this.localData)}setSrcDimensions(e,t){this.localData.sourceVideoWidth=e,this.localData.sourceVideoHeight=t}setMediaExtension(e){this.localData.mediaExtension=e}setContentType(e){this.localData.contentType=e}setMediaLength(e){this.localData.mediaLength=e}setRetriesLeft(e){this.localData.retriesLeft=e}setIsUsingPlaybackControls(){this.localData.isUsingPlaybackControls=!0}}function Ke(e,t){for(const[i,r]of Object.entries(t))e.setAttribute(i,r)}class Qe{constructor(e,t,i,r){this.player=e,this.playbackTracker=i,this.onMediaEventCallback=r,this.playbackTracker.setIsMuted(this.player.muted),this.playbackTracker.setVolume(this.player.volume),this.registerEventListeners(t)}registerEventListeners(e){this.player.addEventListener("loadstart",()=>{this.playbackTracker.onLoadStart(),this.sendEvent(0)}),this.player.addEventListener("loadedmetadata",()=>{this.playbackTracker.onLoadedMetadata(),this.playbackTracker.setDuration(Math.round(1e3*this.player.duration)),this.player instanceof HTMLVideoElement&&this.playbackTracker.setSrcDimensions(this.player.videoWidth,this.player.videoHeight),this.sendEvent(1)}),this.player.addEventListener("loadeddata",()=>{this.sendEvent(2)}),this.player.addEventListener("canplay",()=>{this.playbackTracker.onCanPlay(),this.sendEvent(3)}),this.player.addEventListener("canplaythrough",()=>{this.playbackTracker.onCanPlayThrough()}),this.player.addEventListener("play",()=>{this.playbackTracker.onPlay(),this.sendEvent(4)}),this.player.addEventListener("playing",()=>{this.playbackTracker.onPlaying(),this.sendEvent(5)}),this.player.addEventListener("pause",()=>{this.playbackTracker.onPause(),this.sendEvent(6)}),this.player.addEventListener("seeked",()=>{this.sendEvent(7)}),this.player.addEventListener("seeking",()=>{this.sendEvent(8)}),e&&this.player.addEventListener("timeupdate",()=>{this.sendEvent(9)}),this.player.addEventListener("volumechange",()=>{this.playbackTracker.onVolumeChanged(this.player.volume),this.playbackTracker.setIsMuted(this.player.muted),this.sendEvent(10)}),this.player.addEventListener("stalled",()=>{this.playbackTracker.onStalled(),this.sendEvent(8)}),this.player.addEventListener("ended",()=>{this.playbackTracker.onEnded(),this.sendEvent(11)}),this.player.addEventListener("error",()=>{const e="Local media error."+(this.player.error?` Code: ${this.player.error.code}, message: ${this.player.error.message}`:"");this.playbackTracker.onError(e),this.sendEvent(12)})}getPlaybackData(){return this.playbackTracker.getPlaybackData()}cleanup(){this.playbackTracker.cleanup()}sendEvent(e){void 0!==this.onMediaEventCallback&&this.onMediaEventCallback(e)}}class et{constructor(e,t,i,r,n,a,s,o,l){this.isDesignerElement=i,this.mediaProperties=r,this.player=this.createLocalPlayer(e,t,i,r.mediaType,n,a,l),void 0!==s?(this.eventHandler=new Qe(this.player,this.mediaProperties.trimEndSec>0,s,o),s.setTimeOfCreation()):E.a.info(507573786,"Local: playbackTracker is undefined")}play(){return Object(A.__awaiter)(this,void 0,void 0,(function*(){try{yield this.player.play()}catch(e){E.a.error(541882e3,"Error local video play")}E.a.info(520378572,"Local.play: this.player.paused: "+this.player.paused)}))}pause(){this.player.pause()}setVisible(){this.isDesignerElement&&(this.player.loop=!0),this.player.style.visibility="visible",this.setFocus()}setHidden(){this.isDesignerElement&&(this.player.loop=!1,this.player.autoplay=!1),this.player.style.pointerEvents="none",this.player.style.visibility="hidden"}stop(){this.player.pause(),this.player.currentTime=0}togglePause(){return Object(A.__awaiter)(this,void 0,void 0,(function*(){if(E.a.info(520378573,"Local.togglePause: Before toggle, this.player.paused: "+this.player.paused),this.player.paused)try{yield this.play()}catch(e){E.a.info(541882001,"Error local video play while toggle pause")}else this.pause();E.a.info(520378574,"Local.togglePause: After toggle, this.player.paused: "+this.player.paused)}))}isPaused(){return this.player.paused}getPlayer(){return this.player}setSource(e){this.player.src=e}getCurrentTime(){return this.player.currentTime}getDuration(){return this.player.duration}seekTo(e){this.player.currentTime=e}ensureMediaClient(){}cleanUpMediaClient(){void 0!==this.eventHandler&&void 0!==this.eventHandler.cleanup&&this.eventHandler.cleanup()}setMute(){this.player.muted=!0}setUnMute(){this.player.muted=!1}isMuted(){return this.player.muted}setVolume(e){this.player.volume=e}getVolume(){return this.player.volume}getPlaybackData(){if(void 0!==this.eventHandler&&void 0!==this.eventHandler.getPlaybackData)return this.eventHandler.getPlaybackData()}setFocus(){void 0!==this.player&&this.player.focus()}seekToTrimStartIfNeeded(){void 0!==this.player&&void 0!==this.mediaProperties.trimmedEndTimeSec&&(this.player.currentTime<this.mediaProperties.trimStartSec||this.player.currentTime>=this.mediaProperties.trimmedEndTimeSec)&&(this.player.currentTime=this.mediaProperties.trimStartSec)}onTimeUpdate(){void 0!==this.player&&void 0!==this.mediaProperties.trimmedEndTimeSec&&this.player.currentTime>=this.mediaProperties.trimmedEndTimeSec&&this.player.pause()}isTrimValid(){return void 0!==this.mediaProperties.durationSec&&this.mediaProperties.trimStartSec<=this.mediaProperties.durationSec&&this.mediaProperties.trimEndSec<=this.mediaProperties.durationSec&&this.mediaProperties.trimStartSec+this.mediaProperties.trimEndSec<this.mediaProperties.durationSec}setTrim(e){void 0===e||isNaN(e.duration)||(this.mediaProperties.durationSec=e.duration,this.mediaProperties.trimmedEndTimeSec=this.mediaProperties.durationSec-this.mediaProperties.trimEndSec,this.isTrimValid()?(e.addEventListener("timeupdate",()=>{this.onTimeUpdate()}),e.addEventListener("play",()=>{this.seekToTrimStartIfNeeded()})):(this.mediaProperties.trimStartSec=0,this.mediaProperties.trimEndSec=0,this.mediaProperties.trimmedEndTimeSec=this.mediaProperties.durationSec))}createLocalPlayer(e,t,i,r,n,a,s){const o=r===Ge.Audio?document.createElement("audio"):document.createElement("video");return void 0!==e&&e.appendChild(o),o.style.visibility=i||n||a?"hidden":"visible",o.style.pointerEvents=n||a?"none":"all",this.setProperties(o),void 0!==this.mediaProperties.attributes?Ke(o,this.mediaProperties.attributes):Ke(o,{disablePictureInPicture:"true",controlsList:"nodownload nofullscreen noremoteplayback"}),void 0!==this.mediaProperties.styles?Object(L.a)(o,this.mediaProperties.styles):F(o),i?(o.loop=!0,o.muted=!0,o.addEventListener("canplay",()=>{o.style.visibility="visible"},{once:!0})):this.setFocus(),(this.mediaProperties.trimStartSec>0||this.mediaProperties.trimEndSec>0)&&o.addEventListener("loadedmetadata",()=>{this.setTrim(o)},{once:!0}),null!=s&&s.forEach(e=>{const t=document.createElement("track"),i=e.lang&&""!==e.lang?e.lang:"unknown";t.setAttribute("kind","captions"),t.setAttribute("label",e.label),t.setAttribute("src",decodeURIComponent(e.src)),t.setAttribute("srclang",i),o.appendChild(t)}),o.src=t,o}setProperties(e){e.autoplay=void 0===this.mediaProperties.autoPlay||this.mediaProperties.autoPlay,e.controls=void 0===this.mediaProperties.controls||this.mediaProperties.controls,void 0!==this.mediaProperties.elementId&&(e.id=this.mediaProperties.elementId),void 0!==this.mediaProperties.crossOrigin&&(e.crossOrigin=this.mediaProperties.crossOrigin),void 0!==this.mediaProperties.zIndex&&(e.style.zIndex=this.mediaProperties.zIndex),void 0!==this.mediaProperties.preload&&(e.preload=this.mediaProperties.preload),e instanceof HTMLVideoElement&&(void 0!==this.mediaProperties.playsInline&&(e.playsInline=this.mediaProperties.playsInline),void 0!==this.mediaProperties.width&&(e.width=this.mediaProperties.width),void 0!==this.mediaProperties.height&&(e.height=this.mediaProperties.height))}}class tt{constructor(e,t,i,r,n,a,s,o){const l=void 0!==n.loggableId?n.loggableId:"",d=void 0!==n.mediaType?Ge[n.mediaType]:"Unknown";this.playbackTracker=new Je(r,l,d,s);try{this.client=function(e,t,i,r,n,a,s){return new et(t,e,i,r,!1,!1,n,a,s)}(e,t,i,n,this.playbackTracker,a,o)}catch(e){E.a.info(508650255,"Error creating local video client: "+e.message)}void 0!==n.contentType&&this.playbackTracker.setContentType(n.contentType),!0===n.useCustomControls&&this.playbackTracker.setIsUsingPlaybackControls()}playMedia(){void 0!==this.client&&this.client.play()}pauseMedia(){void 0!==this.client&&this.client.pause()}seekMedia(e){if(void 0!==this.client)if(G.a.getBoolean("sanitizeLocalInputs")){const t=Math.max(e,0);this.client.seekTo(t)}else this.client.seekTo(e)}stopMedia(){void 0!==this.client&&this.client.stop()}togglePauseMedia(){void 0!==this.client&&this.client.togglePause()}isPaused(){if(void 0!==this.client&&void 0!==this.client.isPaused)return this.client.isPaused()}setMute(){void 0!==this.client&&void 0!==this.client.setMute&&this.client.setMute()}setUnMute(){void 0!==this.client&&void 0!==this.client.setUnMute&&this.client.setUnMute()}isMuted(){if(void 0!==this.client&&void 0!==this.client.isMuted)return this.client.isMuted()}setVolume(e){if(void 0!==this.client&&void 0!==this.client.setVolume)if(G.a.getBoolean("sanitizeLocalInputs")){const t=Math.min(Math.max(e,0),1);this.client.setVolume(t)}else this.client.setVolume(e)}getVolume(){if(void 0!==this.client&&void 0!==this.client.getVolume)return this.client.getVolume()}setCrossOrigin(e){const t=this.getMediaElement();void 0!==t&&(t.crossOrigin=e)}setSource(e){void 0!==this.client&&void 0!==this.client.setSource&&this.client.setSource(e),this.onSourceSet()}onSourceSet(){void 0!==this.playbackTracker&&this.playbackTracker.onSourceSet()}setMediaExtension(e){void 0!==this.playbackTracker&&this.playbackTracker.setMediaExtension(e)}setMediaLength(e){void 0!==this.playbackTracker&&this.playbackTracker.setMediaLength(e)}setRetriesLeft(e){void 0!==this.playbackTracker&&this.playbackTracker.setRetriesLeft(e)}setUiHostType(e){var t;null===(t=this.playbackTracker)||void 0===t||t.setUiHostType(e)}setFlights(e){var t;null===(t=this.playbackTracker)||void 0===t||t.setFlights(e)}setPlayRequestTime(){var e;null===(e=this.playbackTracker)||void 0===e||e.onPlayRequested()}getMediaElement(){if(void 0!==this.client)return this.client.getPlayer()}getPlaybackData(){if(void 0!==this.playbackTracker)return this.playbackTracker.getPlaybackData()}getCurrentTime(){if(void 0!==this.client&&void 0!==this.client.getCurrentTime)return this.client.getCurrentTime()}getDuration(){if(void 0!==this.client&&void 0!==this.client.getDuration)return this.client.getDuration()}cleanup(){void 0!==this.client&&void 0!==this.client.cleanUpMediaClient&&this.client.cleanUpMediaClient()}}class it{constructor(e,t,i,r,n,a){this.isOnSlide=!1,this.mediaName=e.name,this.m_onSetSource=r,this.summary={isAutoPlay:e.autoPlay||void 0,slideNumber:t.viewDataManager.getSlideIndex(i),startFromTime:t.settings.startFromTime,fullscreen:e.fullscreen,hideWhenStopped:e.hideWhenStopped,playAcrossSlides:e.playAcrossSlides,isSVG:l.Settings.readBooleanOrDefault("forceSvg",!1),isPrefetch:n,isNarration:e.narration,navigationCount:0,isTeams:le(t),isTeamsWeb:de(t),teamsCallId:t.settings.teamsCallId,isWebGL:a}}onNavigatedTo(){this.isOnSlide?r.a.sendTraceTag(508355586,n.a.msoulscat_Wac_PptSession,a.a.Error,`Already on slide with local media (name: ${this.mediaName})`):(this.isOnSlide=!0,this.summary.timeOfNavigatedTo=Date.now(),this.summary.timeOfNavigatingFrom=void 0,it.sendNavigatedTo&&(it.sendNavigatedTo=!1,r.a.sendTraceTag(508355585,n.a.msoulscat_Wac_PptSession,a.a.Info,`Navigated to a slide with local media (name: ${this.mediaName})`)))}onNavigatingFrom(e){this.isOnSlide?e?(this.isOnSlide=!1,this.summary.timeOfNavigatingFrom=Date.now(),r.a.sendTraceTag(508355554,n.a.msoulscat_Wac_PptSession,a.a.Info,"NavigatingFrom "+JSON.stringify({...this.summary,...e})),this.summary.navigationCount+=1,this.summary.isInClickSequence=void 0):r.a.sendTraceTag(508355555,n.a.msoulscat_Wac_PptSession,a.a.Error,`No local video playback data was collected for local media (name: ${this.mediaName})`):r.a.sendTraceTag(508355584,n.a.msoulscat_Wac_PptSession,a.a.Error,`Not on slide with local media (name: ${this.mediaName}) yet`)}onSourceSet(e){const t=new URL(e).searchParams.get("docId");null!==t&&Fe.ChangeGate.isChangeGateEnabled("SVM.LogDocIdHash")&&(this.summary.docIdHash=Object(De.createHash)("sha256").update(t,"utf8").digest("hex")),this.m_onSetSource(e)}setInClickSequence(){this.summary.isInClickSequence=!0,r.a.sendTraceTag(508355553,n.a.msoulscat_Wac_PptSession,a.a.Info,`Playback started through animation for local media (name: ${this.mediaName})`)}setDocIdHash(e){this.summary.docIdHash=e}setHlsBandwidthEstimate(e){this.summary.hlsBandwidthEstimate=e}setHlsAndTranscoding(e,t){e&&t&&void 0===this.summary.timeOfHlsTranscoding?this.summary.timeOfHlsTranscoding=Date.now():e&&!t&&void 0===this.summary.timeOfHlsRaw?this.summary.timeOfHlsRaw=Date.now():e||t||void 0!==this.summary.timeOfProgressiveRaw||(this.summary.timeOfProgressiveRaw=Date.now())}}it.sendNavigatedTo=!0;class rt{constructor(e,t,i){this.isOnSlide=!1,this.mediaName=e.name,this.summary={slideNumber:t.viewDataManager.getSlideIndex(i),isAutoPlay:e.autoPlay||void 0,isTeams:le(t)||void 0,isTeamsWeb:de(t)||void 0,teamsCallId:t.settings.teamsCallId,navigationCount:0}}onNavigatedTo(){this.isOnSlide?r.a.sendTraceTag(508348034,n.a.msoulscat_Wac_PptSession,a.a.Error,`Already on slide with online video (name: ${this.mediaName})`):(this.isOnSlide=!0,this.summary.timeOfNavigatedTo=Date.now(),this.summary.timeOfNavigatingFrom=void 0,rt.sendNavigatedTo&&(rt.sendNavigatedTo=!1,r.a.sendTraceTag(508348033,n.a.msoulscat_Wac_PptSession,a.a.Info,`Navigated to a slide with an online video (name: ${this.mediaName})`)))}onNavigatingFrom(e){this.isOnSlide?e?(this.isOnSlide=!1,this.summary.timeOfNavigatingFrom=Date.now(),r.a.sendTraceTag(508348002,n.a.msoulscat_Wac_PptSession,a.a.Info,"NavigatingFrom "+JSON.stringify({...this.summary,...e})),this.summary.navigationCount+=1,this.summary.isInClickSequence=void 0,this.summary.wasMediaSyncedOnReady=void 0):r.a.sendTraceTag(508348003,n.a.msoulscat_Wac_PptSession,a.a.Error,`No online video performance data was collected (name: ${this.mediaName})`):r.a.sendTraceTag(508348032,n.a.msoulscat_Wac_PptSession,a.a.Error,`Not on slide with online video (name: ${this.mediaName}) yet`)}setInClickSequence(){this.summary.isInClickSequence=!0,r.a.sendTraceTag(508348001,n.a.msoulscat_Wac_PptSession,a.a.Info,`Online video playback started through animation (name: ${this.mediaName})`)}setMediaSyncedOnReady(){this.summary.wasMediaSyncedOnReady=!0,r.a.sendTraceTag(508348e3,n.a.msoulscat_Wac_PptSession,a.a.Info,`Online video synced to Media Sync state on ready (name: ${this.mediaName})`)}}rt.sendNavigatedTo=!0;class nt{constructor(e,t,i,o,d,h,c){if(this.shapeType=1,this.fPrepared=!1,this.animatableContentViewElements=[],this.m_fChangingSlide=!1,this.m_lastAnimTimeMS=0,this.m_fHasMediaBeenSynced=!1,this.m_fHasCustomPlayButtonBeenSynced=!1,this.m_fHasOnlineVideoPlayButtonBeenClicked=!1,this.m_fIsPlayerReady=!1,this.m_fSuppressMediaSyncEvents=!0,this.m_fIsGloballyUnmuting=!1,this.m_shouldRenderToCanvas=!1,this.m_hasPendingRender=!1,this.m_fLogCanvasRenderError=!0,this.m_logCanvasInfo=!0,this.m_fCropForCanvasRender=!1,this.m_firstPlayAnimation=!0,this.m_fOnSlide=!1,this.m_isNotAllowedError=!1,this.m_fMuteSyncDisabled=!1,this.m_fPreviouslyMuted=!1,this.m_fMutingOtherMedia=!1,this.m_fIsFirstNavigation=!0,this.m_requestGuid=Object(je.v4)(),this.m_slideScale=1,this.m_hlsError=!1,this.m_hlsJsManifestLoaded=!1,this.m_hlsErrorCount=0,this.m_hlsAutoRecoverRetryCount=0,this.m_wasLoadStarted=!1,this.m_wasMetadataLoaded=!1,this.m_pixelScale=new p.b(1,1),this.m_wasTranscodingRequested=!1,this.id=e.id,this.m_slideId=this.id.slideId,this.m_emuToPixelScale=i,this.m_slideSizePixels=d,this.m_shapeViewData=t,this.m_slideEvents=h,this.m_isLoopingBackgroundVideo=void 0,this.m_fCropInSVG=void 0,this.m_presenterToPresenterMediaCycleLockMs=l.Settings.readNumberOrDefault("presenterToPresenterMediaCycleLockMs",1e3),le(o)&&(this.m_mediaSyncLock=new ye(this.m_presenterToPresenterMediaCycleLockMs)),this.m_slideEvents.on("navigatingFrom",()=>{if(this.m_transparentShapeItem&&(this.m_transparentShapeItem.isHidden=!0),this.m_fSuppressMediaSyncEvents=!0,this.m_localMediaPlaybackController&&!this.m_media.playAcrossSlides&&this.m_localMediaPlaybackController.onNavigatingFrom(),this.m_localMediaInfo&&this.m_localMediaInfo.el){if(this.m_media.playAcrossSlides&&this.m_mediaType===p.a.Audio)return;this.shouldCleanupLocalPlayerOnNavigatedFrom()||(this.resetCurrentTime(this.m_localMediaInfo),this.m_localMediaInfo.el.muted=!0,this.pauseMedia())}this.stopVideoFrameTracker("navigatingFrom"),this.isCaptionsEnabled()&&this.m_environment.rendererEnvironment.viewController.getCaptionsRenderer.onNavigatingFrom(),this.m_onlineVideoPlayer&&this.m_onlineVideoPlaybackPerf&&this.m_onlineVideoPlaybackPerf.onNavigatingFrom(this.m_onlineVideoPlayer.getPerfData()),this.m_onlineVideoPlayer&&this.m_onlineVideoPlaybackTelemetry&&this.m_onlineVideoPlaybackTelemetry.onNavigatingFrom(this.m_onlineVideoPlayer.getPlaybackData()),this.m_localMediaPlayer&&this.m_localMediaPlaybackTelemetry&&this.m_localMediaPlaybackTelemetry.onNavigatingFrom(this.m_localMediaPlayer.getPlaybackData())}),this.m_slideEvents.on("navigatedFrom",()=>{this.m_fOnSlide=!1,this.m_fHasMediaBeenSynced=!1,this.m_fIsPlayerReady=!1,this.m_fHasCustomPlayButtonBeenSynced=!1,this.m_fHasOnlineVideoPlayButtonBeenClicked=!1,this.m_fLinkedMediaReachedEnd&&(this.m_fLinkedMediaReachedEnd=!1),this.m_localMediaInfo&&(this.m_localMediaInfo.fReachedEnd=!1),this.cleanupLocalPlayerOnNavigatedFrom(),this.cleanupOnlinePlayerOnNavigatedFrom()}),this.m_slideEvents.on("navigatingTo",()=>{this.m_isPrefetch=!1,this.m_localMediaPlaybackController&&!this.m_media.playAcrossSlides&&this.m_localMediaPlaybackController.onNavigatingTo(),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.onNavigatingTo(),this.m_transparentShapeItem&&(this.m_transparentShapeItem.isHidden=!0),this.resetLocalPlayerOnNavigatingTo()}),this.m_slideEvents.on("navigatedTo",()=>{if(this.m_fOnSlide=!0,this.m_onlineVideoPlayer&&(this.m_onlineVideoPlaybackPerf&&this.m_onlineVideoPlaybackPerf.onNavigatedTo(),this.m_onlineVideoPlaybackTelemetry&&this.m_onlineVideoPlaybackTelemetry.onNavigatedTo(),this.m_fIsFirstNavigation||this.m_onlineVideoPlayer.ensure(),(this.m_mediaType===p.a.YouTube||this.m_mediaType===p.a.Vimeo)&&this.isVideoPartiallyOffSlide())){const e=this.ensureLinkedMediaElementDiv(),t=s.b.getElementFromCollection(e.children,nt.LinkedMediaContainerName);this.handlePartiallyOffSlideLinkedMedia(t),r.a.sendTraceTag(559244870,n.a.msoulscat_Wac_PptSession,a.a.Info,`Linked media with type:${this.m_mediaType} is partially off slide.`)}this.m_localMediaPlaybackTelemetry&&this.m_localMediaPlaybackTelemetry.onNavigatedTo(),this.m_media.autoPlay&&(r.a.sendTraceTag(508630853,n.a.msoulscat_Wac_PptSession,a.a.Info,`Calling playMedia on autoplay media ${this.m_media.name} upon arrival to slide`),this.playMedia()),this.m_fChangingSlide=!1,this.m_firstPlayAnimation=!0,this.m_isPrefetch=!1,this.m_fIsFirstNavigation=!1}),this.m_slideEvents.on("beforeFirstRenderAfterNavigation",()=>this.beforeFirstRender()),!t.media)throw r.a.sendTraceTag(594909142,n.a.msoulscat_Wac_PptSession,a.a.Error,`MediaViewElement:: Invalid shapeViewData. media:${!!t.media}, animatableContents.length:${this.m_shapeViewData.animatableContents.length}, parts.length:${this.m_shapeViewData.animatableContents.length>0?this.m_shapeViewData.animatableContents[0].parts.length:0}.`),new Error("Invalid media");const u=this.m_shapeViewData.animatableContents[0].parts[0].regionPos;this.m_mediaSize=new p.b(u.region.rect.right-u.region.rect.left,u.region.rect.bottom-u.region.rect.top),this.m_mediaPosition=new p.b(u.pos.x,u.pos.y),this.m_media=t.media,this.m_mediaType=nt.getMediaType(this.m_media),this.m_isPrefetch=c||!1,this.m_environment=o,this.ShapeMediaTargetId="media-element-"+JSON.stringify(this.id),this.m_fLogCanvasRenderError=!0,this.updatePixelScale(),this.m_useTranscodedVideos=this.m_mediaType===p.a.Video&&(!l.Settings.readBooleanOrDefault("useTranscodingForMobileOnly",!1)||me(this.m_environment))&&this.isMediaDownloadHandlerEnabled(this.m_media.src),this.m_isTranscoded=this.m_useTranscodedVideos,this.m_initialRetryCount=this.getTotalRetryCount(),s.c.updateMediaSource=e=>{this.m_localMediaInfo&&this.m_localMediaInfo.el&&(this.m_localMediaInfo.el.src=e),this.playLocalMedia()},s.c.updateMediaSourceHLS=e=>{this.m_localMediaInfo&&this.m_localMediaInfo.el&&this.setHlsSourceAsync(e,this.m_localMediaInfo.el),this.playLocalMedia()},this.m_gfxVideoSettings=this.createGfxVideoAppSettings(),Object(G.b)({getBoolean:e=>{const t=this.m_gfxVideoSettings[e];return"boolean"==typeof t?t:l.Settings.readBooleanOrDefault(e,!1)},getNumber:e=>{const t=this.m_gfxVideoSettings[e];return"number"==typeof t?t:l.Settings.readNumberOrDefault(e,0)},getString:e=>{const t=this.m_gfxVideoSettings[e];return"string"==typeof t?t:l.Settings.readStringOrDefault(e,"")}})}beforeFirstRender(){if(this.m_transparentShapeItem&&(this.m_transparentShapeItem.isHidden=!1),this.m_fChangingSlide=!0,this.m_localMediaInfo&&this.m_localMediaInfo.el){const e=this.m_localMediaInfo.el;this.m_localMediaInfo.fMutedInFile||(e.muted=!1),this.addCaptionTracks(this.m_localMediaInfo.el),r.a.sendTraceTag(540919814,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement: Local video muted: "+e.muted);const t=this.useLoadedMetadataAsInteractivityEvent();this.verifyPlatfromSpecificReadyState(this.m_localMediaInfo)?this.onPlayerReadyCallBack():e.addEventListener(t?"loadedmetadata":"canplay",()=>{this.onPlayerReadyCallBack()},{once:!0}),this.shouldRenderToCanvas&&(this.m_localMediaInfo.el.style.opacity="0",this.m_localMediaInfo.el.controls=!1),this.usePlaybackControls()&&(this.m_localMediaInfo.el.controls=!1,this.isCaptionsEnabled()&&this.m_environment.rendererEnvironment.viewController.getCaptionsRenderer.stopCaptionTrack())}}shouldCleanupLocalPlayerOnNavigatedFrom(){return!(!l.Settings.readBooleanOrDefault("cleanupLocalPlayerOnNavigatedFromForAutoPlayedVideos",!0)&&this.m_media.autoPlay)&&l.Settings.readBooleanOrDefault("cleanupLocalPlayerOnNavigatedFrom",!0)}cleanupLocalPlayerOnNavigatedFrom(){this.m_localMediaPlayer&&this.m_localMediaPlayer.cleanup(),this.m_localMediaPlaybackSource?this.m_media.playAcrossSlides||this.m_localMediaPlaybackSource.cleanupPlayerOnNavigatedFrom():this.shouldCleanupLocalPlayerOnNavigatedFrom()&&!this.m_media.playAcrossSlides&&this.m_localMediaInfo&&this.m_localMediaInfo.el&&this.m_localMediaInfo.mediaUrl&&(this.m_localMediaInfo.el.src&&r.a.sendTraceTag(540587273,n.a.msoulscat_Wac_PptSession,a.a.Info,"Cancelling media request requestGuid: "+this.m_requestGuid),Fe.ChangeGate.isChangeGateEnabled("SVM.DestroyHLSBeforeRemove")||(this.m_localMediaInfo.el.removeAttribute("src"),this.m_localMediaInfo.el.load()),this.m_hls&&(this.m_hls.destroy(),this.m_hls=void 0),this.m_hlsError=!1,this.m_hlsJsManifestLoaded=!1,this.m_hlsErrorCount=0,this.m_hlsAutoRecoverRetryCount=0,this.m_wasLoadStarted=!1,this.m_wasMetadataLoaded=!1,this.m_wasTranscodingRequested=!1,Fe.ChangeGate.isChangeGateEnabled("SVM.DestroyHLSBeforeRemove")&&(this.m_localMediaInfo.el.removeAttribute("src"),this.m_localMediaInfo.el.load()),r.a.sendTraceTag(558965442,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement::cleanupLocalPlayerOnNavigatedFrom"))}cleanupOnlinePlayerOnNavigatedFrom(){this.m_localMediaInfo&&this.m_localMediaInfo.el||this.m_onlineVideoPlayer&&this.shouldUseOnlineVideoPlayer()&&(r.a.sendTraceTag(557176144,n.a.msoulscat_Wac_PptSession,a.a.Info,`MediaViewElement::cleanupOnlinePlayerOnNavigatedFrom: ${this.m_media.name}.`),this.m_onlineVideoPlayer.cleanup())}resetLocalPlayerOnNavigatingTo(){this.m_localMediaPlaybackSource?this.m_media.playAcrossSlides||this.m_localMediaPlaybackSource.resetPlayerOnNavigatingTo():this.shouldCleanupLocalPlayerOnNavigatedFrom()&&this.m_localMediaInfo&&this.m_localMediaInfo.el&&this.m_localMediaInfo.mediaUrl&&!this.m_localMediaInfo.el.src&&(this.m_localMediaInfo.retriesRemaining=this.m_initialRetryCount,Fe.ChangeGate.isChangeGateEnabled("SVM.ResetRetryTimeout")&&(this.m_localMediaInfo.retryTimeoutMs=l.Settings.readNumberOrDefault("mediaRetryInitialDelayMs",nt.BD_HTML5_MEDIA_RETRY_INITIALDELAYMS)),this.setSourceAsync(this.m_localMediaInfo.el,this.m_localMediaInfo),r.a.sendTraceTag(558965443,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement::resetLocalPlayerOnNavigatingTo"))}ensure(){this.m_shapeItem||this.init();const e={name:this.m_media.name,type:p.a[this.m_mediaType],contentType:this.m_media.contentType,fPlayable:this.isMediaPlayable(this.m_media.contentType),fAutoPlay:this.m_media.autoPlay,playAcrossSlides:this.m_media.playAcrossSlides,fullBleed:this.m_mediaType!==p.a.Video&&this.m_mediaType!==p.a.Audio?"NA":this.m_localMediaInfo?String(this.m_localMediaInfo.fFullBleed):"undefined",looping:this.m_mediaType!==p.a.Video&&this.m_mediaType!==p.a.Audio?"NA":this.m_localMediaInfo?String(this.m_localMediaInfo.fLooping):"undefined",muted:this.m_mediaType!==p.a.Video&&this.m_mediaType!==p.a.Audio?"NA":this.m_localMediaInfo?String(this.m_localMediaInfo.fMutedInFile):"undefined"};this.shouldRenderToCanvas||!this.m_environment.settings.transparentCanvasForVideoEnabled||this.m_transparentShapeItem||(e.fTransparentCanvas=this.initTransparentShape());const t={mediaInfo:e};if(!this.m_shapeItem)return r.a.sendTraceTag(594909143,n.a.msoulscat_Wac_PptSession,a.a.Error,"MediaViewElement::ensure: invalid shapeItem."),t.invalidShape=!0,t;const i=o.a.attachTextures(this.m_environment,this.m_shapeItem,this.m_shapeViewData);return{...t,...i}}init(){if(this.animatableContentViewElements=[],this.m_shapeItem=o.a.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment),Object(E.b)({info:(e,t)=>{r.a.sendTraceTag(e,n.a.msoulscat_Wac_PptSession,a.a.Info,t)},warn:(e,t)=>{r.a.sendTraceTag(e,n.a.msoulscat_Wac_PptSession,a.a.Warning,t)},error:(e,t)=>{r.a.sendTraceTag(e,n.a.msoulscat_Wac_PptSession,a.a.Error,t)}}),this.m_mediaType!==p.a.Audio&&this.m_mediaType!==p.a.Video||!this.m_shapeItem)this.initLinkedMediaInfo();else if(this.initLocalMediaInfo(),this.m_localMediaInfo&&l.Settings.readBooleanOrDefault("forceSvg",!1)){const e=this.m_environment.rendererEnvironment.renderer;2===this.m_shapeItem.getType()?e.attachCustomHTMLToShape(this.m_localMediaInfo.el,this.m_shapeItem.items.getAt(0)):e.attachCustomHTMLToShape(this.m_localMediaInfo.el,this.m_shapeItem)}}initTransparentShape(){return!!this.isUnderlayElements()&&!!this.isMediaPlayable(this.m_media.contentType)&&(this.m_transparentShapeItem=u.e.CreateRectangle(new h.c(this.m_mediaPosition.x,this.m_mediaPosition.y,this.m_mediaPosition.x+this.m_mediaSize.x,this.m_mediaPosition.y+this.m_mediaSize.y),new c.k(new c.i(c.b.White),void 0,void 0,3)),!0)}setAlphaInvariant(){if(this.m_shapeItem&&this.m_shapeItem instanceof u.e){const e=this.m_shapeItem;e.style.pictureBrush&&(e.style.pictureBrush.isAlphaInvariant=!0,r.a.sendTraceTag(523870277,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement::setAlphaInvariant: Successfully set isAlphaInvariant"))}}isUnderlayElements(){return this.m_mediaType===p.a.Video&&!this.shouldRenderToCanvas||this.m_mediaType===p.a.YouTube||this.m_mediaType===p.a.StreamClassic||this.m_mediaType===p.a.Vimeo||this.m_mediaType===p.a.Flip||this.m_mediaType===p.a.Ted||this.m_mediaType===p.a.Stream2}get shouldRenderToCanvas(){return this.m_shouldRenderToCanvas}isPlaybackControlsEnabled(){return!(!le(this.m_environment)&&!de(this.m_environment))||l.Settings.readBooleanOrDefault("usePlaybackControls",!1)}usePlaybackControls(){return this.m_mediaType===p.a.Video&&(this.isPlaybackControlsEnabled()||this.m_shouldRenderToCanvas)&&""!==Ye.getCssPath(this.m_environment)}static isVideoCroppedToShape(e){return!(!e.paths||0===e.paths.length||1===e.paths.length&&e.paths[0].isUntransformedRect)}isVideoCropped(e){if(!e.style.pictureBrush)return!1;if(1!==e.style.pictureBrush.scale.x||1!==e.style.pictureBrush.scale.y||0!==e.style.pictureBrush.offset.x||0!==e.style.pictureBrush.offset.y)return!0;const t=this.m_shapeViewData.shapeBuilderData.style.pctBrush;return!!(t.cs&&1!==t.cs.x&&0!==t.cs.x||t.cs&&1!==t.cs.y&&0!==t.cs.y||t.co&&0!==t.co.x||t.co&&0!==t.co.y)&&(this.m_fCropForCanvasRender=!0,!0)}static isVideoRotated(e){return!(!e.transform||!e.transform.rotation||0===e.transform.rotation)}shouldRenderLocalVideoToCanvas(e){if(!e)return!1;const t=!he(this.m_environment)||l.Settings.readBooleanOrDefault("renderLocalVideoToCanvas",!1);if(e instanceof u.e){const i=e,s=this.isVideoCropped(i),o=nt.isVideoCroppedToShape(i),l=nt.isVideoRotated(i);if(r.a.sendTraceTag(509752475,n.a.msoulscat_Wac_PptSession,a.a.Info,`Media:${this.m_media.name} has crop:${s}, crop-to-shape:${o}, outline:${i.style.lineBrush}, rotation:${l}, effects:${i.effects.hasEffects}. Rendering canvas: ${this.m_environment.rendererEnvironment}.`),i.effects.hasEffects&&r.a.sendTraceTag(509752474,n.a.msoulscat_Wac_PptSession,a.a.Info,`Media has effects applied. Glow:${void 0!==i.effects.glow}, Shadow:${i.effects.shadow}, InnerShadow:${void 0!==i.effects.innerShadow}, Reflection:${i.effects.reflection}, SoftEdges:${i.effects.softEdges}. Rendering canvas: ${this.m_environment.rendererEnvironment}.`),t&&(s||o||i.style.lineBrush||l))return!this.shouldRenderEffects()&&i.effects.hasEffects&&this.removeEffects(i),!0}return this.shouldRenderEffects()&&e.effects.hasEffects}shouldRenderEffects(){return!!le(this.m_environment)||l.Settings.readBooleanOrDefault("renderVideoWithEffectsToCanvas",!1)}removeEffects(e){e.effects.hasEffects&&(e.effects.shadow=void 0,e.effects.innerShadow=void 0,e.effects.reflection=void 0,e.effects.softEdges=void 0,e.effects.glow=void 0,this.isVideoCropped(e)||nt.isVideoCroppedToShape(e)||(e.paths=void 0,e.clearPathCache()),r.a.sendTraceTag(520618384,n.a.msoulscat_Wac_PptSession,a.a.Info,`removeEffects: media = ${this.m_media.name}. shouldRenderToCanvas = ${this.m_shouldRenderToCanvas}`))}isPlaying(){const e=this.getMediaCurrentState();return void 0===e&&r.a.sendTraceTag(512234247,n.a.msoulscat_Wac_PptSession,a.a.Info,"isPlaying: mediaState is undefined"),void 0!==e&&1===e.playerState}shouldUpdateMediaOnCanvas(){return this.shouldRenderToCanvas&&(this.isPlaying()||this.m_hasPendingRender)}update(){this.m_mediaType===p.a.Audio||this.m_mediaType===p.a.Video?this.updateLocalMediaElement():this.updateLinkedMediaElement(),this.shouldUpdateMediaOnCanvas()&&this.renderFrame()}getCanvasLoggingInfo(){let e={};if(this.m_localMediaInfo&&this.m_localMediaInfo.el){const t=new URL(this.m_localMediaInfo.el.src),i=new URL(window.origin);e={mediaName:this.m_media.name,crossOrigin:this.m_localMediaInfo.el.crossOrigin,windowHost:i.host,windowProtocol:i.protocol,mediaHost:t.host,mediaProtocol:t.protocol}}return e}renderFrame(){if(!this.m_fIsPlayerReady)return void r.a.sendTraceTag(512234246,n.a.msoulscat_Wac_PptSession,a.a.Info,"renderFrame called while m_fIsPlayerReady = "+this.m_fIsPlayerReady);this.m_hasPendingRender=!1;const e=this.m_environment.rendererEnvironment.glContext;if(!this.m_localMediaInfo||!this.m_localMediaInfo.el||!e||e.isContextLost())return void(this.m_fLogCanvasRenderError&&(r.a.sendTraceTag(545378765,n.a.msoulscat_Wac_PptSession,a.a.Error,`MediaViewElement::renderFrame: Unable to draw video frame. m_localMediaInfo: ${!!this.m_localMediaInfo}.\n          m_localMediaInfo.el: ${this.m_localMediaInfo?!!this.m_localMediaInfo.el:""}.\n          gl: ${!!e}.\n          isContextLost: ${e?e.isContextLost():""}`),g.VetoUtils.recordVeto("RenderToCanvasFailure",{errorName:"RenderingContextLost",qosVeto:"RenderToCanvasFailure",isIntentional:!0}),this.m_fLogCanvasRenderError=!1));try{this.m_videoTexture=b.b.CreateOrUpdateFromHTMLElement("video",this.m_videoTexture,this.m_environment.rendererEnvironment.renderer,this.m_localMediaInfo.el),this.m_logCanvasInfo&&(r.a.sendTraceTag(509096201,n.a.msoulscat_Wac_PptSession,a.a.Info,"CreateOrUpdateFromHTMLElement succeeded: "+JSON.stringify(this.getCanvasLoggingInfo())),this.m_logCanvasInfo=!1)}catch(e){return void(this.m_fLogCanvasRenderError&&(r.a.sendTraceTag(542935119,n.a.msoulscat_Wac_PptSession,a.a.Error,`MediaViewElement::renderFrame: Unable to draw video frame. CreateOrUpdateFromHTMLElement threw an exception: ${e}. ${JSON.stringify(this.getCanvasLoggingInfo())}`),g.VetoUtils.recordVeto("RenderToCanvasFailure",{errorName:"CreateOrUpdateFromHTMLElementException",qosVeto:"RenderToCanvasFailure",isIntentional:!0}),this.m_fLogCanvasRenderError=!1))}if(!this.m_shapeItem)return void(this.m_fLogCanvasRenderError&&(r.a.sendTraceTag(545378768,n.a.msoulscat_Wac_PptSession,a.a.Error,"MediaViewElement::renderFrame: Unable to draw video frame. ShapeItem:"+!!this.m_shapeItem),g.VetoUtils.recordVeto("RenderToCanvasFailure",{errorName:"MissingShapeItem",qosVeto:"RenderToCanvasFailure",isIntentional:!0}),this.m_fLogCanvasRenderError=!1));const t=this.m_shapeItem;if(t.style.pictureBrush&&this.m_fCropForCanvasRender){const e=this.m_shapeViewData.shapeBuilderData.style.pctBrush;t.style.pictureBrush.scale=new p.b(e.cs.x,e.cs.y),t.style.pictureBrush.offset=new p.b(e.co.x,e.co.y)}for(const e of this.m_shapeItem.getBrushImages())e.id&&(this.m_environment.rendererEnvironment.renderer.attachTextureToImage(e,this.m_videoTexture),this.m_videoTexture.changeTracker.notifyChange());this.m_frameTracker&&this.m_frameTracker.updateRenderFrameCount()}applyAnimation(e,t){if(this.m_shapeItem){if(this.m_mediaType!==p.a.Audio||Fe.ChangeGate.isChangeGateEnabled("disableAnimationsOnAudio"))for(const t of e.Attributes)if(t.AttrId!==f.c.Visible&&t.AttrId!==f.c.MediaPlaybackCmd)return;if(!this.m_fChangingSlide){const i=f.b.getAnimAttributeValue(e.Attributes,f.c.MediaPlaybackCmd,null);if(null!=i){const e=l.Settings.readNumberOrDefault("minMediaAnimationSpacing",200),s=Date.now()-this.m_lastAnimTimeMS;if(s<e)r.a.sendTraceTag(557417807,n.a.msoulscat_Wac_PptSession,a.a.Info,`Skipping animation command as it's been less than minMediaAnimationSpacing: ${e}(ms), actual: ${s}(ms), mediaCmd: ${i.mediaCmd}`);else{this.m_lastAnimTimeMS=Date.now();const e=!(this.m_localMediaInfo&&this.m_localMediaInfo.el||!this.m_onlineVideoPlayer||!this.shouldUseOnlineVideoPlayer());if(r.a.sendTraceTag(556316491,n.a.msoulscat_Wac_PptSession,a.a.Info,`Animation media cmd: ${i.mediaCmd}; Online: ${e}`),-1!==i.mediaCmd.toLowerCase().indexOf("play")){let e=pe.parseSeekTimeFromMediaCommandString(i.mediaCmd,this.m_media.bmkLst?this.m_media.bmkLst:[]);if(-1===e)this.m_lastAnimTimeMS=0,r.a.sendTraceTag(571236834,n.a.msoulscat_Wac_PptSession,a.a.Warning,`Not able to parse time from media cmd : ${i.mediaCmd}.`);else{if(this.shouldSkipAnimation(t))return;this.m_firstPlayAnimation=!1,this.m_media.trimStartMs>0&&(e+=this.m_media.trimStartMs/1e3),this.seekMedia(e),this.playMedia(),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setInClickSequence(),this.m_onlineVideoPlaybackPerf&&this.m_onlineVideoPlaybackPerf.setInClickSequence(),this.m_localMediaPlaybackTelemetry&&this.m_localMediaPlaybackTelemetry.setInClickSequence(),this.m_onlineVideoPlaybackTelemetry&&this.m_onlineVideoPlaybackTelemetry.setInClickSequence()}}else-1!==i.mediaCmd.toLowerCase().indexOf("togglepause")?this.togglePauseMedia():-1!==i.mediaCmd.toLowerCase().indexOf("stop")?this.stopMedia():(this.m_lastAnimTimeMS=0,r.a.sendTraceTag(561639819,n.a.msoulscat_Wac_PptSession,a.a.Warning,`Unsupported animation media command : ${i.mediaCmd}.`))}}}o.a.applyAnimationToShapeItemAndClickTarget(e,this.m_shapeItem,this.m_shapeViewData),this.m_mediaType===p.a.Audio&&this.m_media&&this.m_media.hideWhenStopped&&this.shapeItem&&(this.shapeItem.isHidden=!0)}}addToScene(e){this.m_shapeItem&&e.items.push(this.m_shapeItem),this.m_transparentShapeItem&&e.items.push(this.m_transparentShapeItem)}removeFromScene(e){this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)&&o.a.removeFromScene(e,this.m_shapeItem),this.m_transparentShapeItem&&-1!==e.items.elements.indexOf(this.m_transparentShapeItem)&&o.a.removeFromScene(e,this.m_transparentShapeItem)}playMedia(){this.restorePreviousMuteState(),this.muteAllPlayingMediaiOS(),this.m_localMediaInfo&&this.m_localMediaInfo.el?(r.a.sendTraceTag(588002453,n.a.msoulscat_Wac_PptSession,a.a.Info,`Playing media for received event, from host. media: ${this.m_media.name}.`),this.playLocalMedia()):this.m_onlineVideoPlayer&&this.shouldUseOnlineVideoPlayer()&&(r.a.sendTraceTag(578609472,n.a.msoulscat_Wac_PptSession,a.a.Info,`Playing online media for received event, from host. media: ${this.m_media.name}.`),this.m_onlineVideoPlayer.playMedia())}playLocalMedia(){if(!this.m_localMediaInfo||!this.m_localMediaInfo.el)return;if(!l.Settings.readBooleanOrDefault("mutedPlaybackOnNotAllowedError",!0))return void this.playHelper(this.m_localMediaInfo);const e=this.playHelper(this.m_localMediaInfo);void 0!==e&&e.then(()=>{r.a.sendTraceTag(538722767,n.a.msoulscat_Wac_PptSession,a.a.Info,`Local media playback started for media: ${this.m_media.name}.`)}).catch(e=>{r.a.sendTraceTag(538722768,n.a.msoulscat_Wac_PptSession,a.a.Error,`Local media playback failed to start for media: ${this.m_media.name}, error: ${e.name}, isTeams: ${le(this.m_environment)}, isTeamsWeb: ${de(this.m_environment)}.`),"NotAllowedError"===e.name&&de(this.m_environment)?this.playLocalMediaMuted():g.VetoUtils.recordVeto("MediaPlaybackFailure",{qosVeto:"MediaPlaybackFailure",errorName:"MediaPlayPromiseFailed_"+e.name,media:this.m_media.name,msg:e.message})})}playLocalMediaMuted(){this.m_localMediaInfo&&this.m_localMediaInfo.el&&(r.a.sendTraceTag(538722769,n.a.msoulscat_Wac_PptSession,a.a.Info,`Starting local media playback muted: ${this.m_media.name}.`),this.m_localMediaInfo.el.muted=!0,this.playHelper(this.m_localMediaInfo))}pauseMedia(){this.restorePreviousMuteState(),this.m_localMediaInfo&&this.m_localMediaInfo.el?(r.a.sendTraceTag(588002454,n.a.msoulscat_Wac_PptSession,a.a.Info,`Pausing media for received event, from host. media: ${this.m_media.name}.`),this.pauseHelper(this.m_localMediaInfo)):this.m_onlineVideoPlayer&&this.shouldUseOnlineVideoPlayer()&&(r.a.sendTraceTag(578609433,n.a.msoulscat_Wac_PptSession,a.a.Info,`Pausing online media for received event, from host. media: ${this.m_media.name}.`),this.m_onlineVideoPlayer.pauseMedia())}togglePauseMedia(){this.restorePreviousMuteState(),this.m_localMediaInfo&&this.m_localMediaInfo.el?(r.a.sendTraceTag(571236864,n.a.msoulscat_Wac_PptSession,a.a.Info,`Toggle pausing media. media: ${this.m_media.name}.`),this.m_localMediaInfo.el.paused?(this.muteAllPlayingMediaiOS(),this.playHelper(this.m_localMediaInfo)):this.pauseHelper(this.m_localMediaInfo)):this.m_onlineVideoPlayer&&this.shouldUseOnlineVideoPlayer()&&(r.a.sendTraceTag(571236835,n.a.msoulscat_Wac_PptSession,a.a.Info,`Toggle pause online media. media: ${this.m_media.name}.`),this.m_onlineVideoPlayer.isPaused()&&this.muteAllPlayingMediaiOS(),this.m_onlineVideoPlayer.togglePauseMedia())}syncOnlineVideoPoster(e){(e.origin.isFromLocalCache||e.origin.isFromRoleChange)&&(e.origin.isInitial?0===e.state.playerState&&this.m_onlineVideoPlayer&&this.m_onlineVideoPlayer.showPoster():this.m_onlineVideoPlayer&&this.m_onlineVideoPlayer.hidePoster())}updateMediaState(e){if(this.m_fHasOnlineVideoPlayButtonBeenClicked&&(!this.m_fIsPlayerReady||e.origin.isFromLocalCache))return void _e("Blocking - Preserving pending play command for online video is executed before syncing state to presenter","MediaViewElement",e);if(this.m_fIsPlayerReady&&(this.m_fHasMediaBeenSynced=!0),this.m_mediaSyncLock&&this.m_mediaSyncLock.updateLastTimeRecievedEvent(),this.m_fIsPlayerReady&&(this.m_onlineVideoPlayer?this.syncOnlineVideoPoster(e):l.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.m_mediaType===p.a.Video&&this.m_localMediaInfo&&this.m_localMediaInfo.el&&(e.origin.isFromLocalCache||e.origin.isFromRoleChange)&&(e.origin.isInitial?0===e.state.playerState&&(this.setCustomPlayButtonVisible(),this.usePlaybackControls()||this.m_media.autoPlay||this.m_localMediaInfo.fLooping||(this.m_localMediaInfo.el.controls=!1)):(this.m_fHasCustomPlayButtonBeenSynced=!0,this.setCustomPlayButtonHidden(),this.usePlaybackControls()||this.m_media.autoPlay||this.m_localMediaInfo.fLooping||(this.m_localMediaInfo.el.controls=!0)))),!this.shouldSyncMediaEnded(e))return void _e("Blocking - Media Sync Message Originated from MediaEnded Event","MediaViewElement",e);if(this.shouldSyncMediaVolumeChanged(e)){const t=l.Settings.readBooleanOrDefault("enableGlobalMute",!1)&&this.m_environment.isGlobalMute;if(t||this.m_fMuteSyncDisabled||(void 0!==e.state.volume&&this.setMediaVolume(e.state.volume),void 0!==e.state.muted&&this.setMediaMute(e.state.muted)),!e.origin.isFromLocalCache&&!e.origin.isFromRoleChange&&!e.origin.isFromStateServiceCache)return void _e(`Only Attempted to Sync Mute/Volume State (globalMuteOverride: ${t}, fMuteSyncDisabled: ${this.m_fMuteSyncDisabled})`,"MediaViewElement",e)}const t=.001*e.state.playerPositionSkew;void 0!==e.state.position&&this.seekMedia(e.state.position+t),this.syncPlayerState(e.state.playerState),_e("Media Sync Attempt Finished","MediaViewElement",e)}updateVideoPlayButtonVisibility(e){if(l.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&l.Settings.readBooleanOrDefault("enableRoleBasedVideoPlayUX",!1)&&(this.m_environment.settings.showCustomPlayButtonForVideo=e,this.m_mediaType===p.a.Video&&!this.m_media.autoPlay&&this.m_localMediaInfo&&this.m_localMediaInfo.el)){const t=this.isCustomPlayButtonVisible();!e&&t?this.setCustomPlayButtonHidden():!e||t||this.isPlaying()||(this.setCustomPlayButtonVisible(),this.m_localMediaInfo.el.controls=!1)}}syncPlayerState(e){if(void 0!==e)switch(e){case 1:this.playMedia();break;case 0:this.pauseMedia();break;case 6:break;default:r.a.sendTraceTag(556398351,n.a.msoulscat_Wac_PptSession,a.a.Info,`Unexpected player state when updating media state ${this.m_media.name}, ${this.m_mediaType}, ${e}.`)}}initAfterSlideContentChanged(){if(!l.Settings.readBooleanOrDefault("initMediaAfterSlideContentChanged",!0))return;const e=this.m_environment.settings.transparentCanvasForVideoEnabled&&this.isUnderlayElements()?"0":"2",t=o.a.ensureShapeViewElementParentDiv(this.id,e,this.m_media&&this.m_media.playAcrossSlides>0);if(this.m_localMediaInfo&&this.m_localMediaInfo.el){if((this.usePlaybackControls()||this.shouldRenderToCanvas)&&this.ensureVideoEventsDiv(t),l.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&l.Settings.readBooleanOrDefault("forceSVG",!1)&&this.m_mediaType===p.a.Video&&!this.m_playButtonHandler){const e=this.getBounds(),i=this.createCustomPlayButton(t,e);this.m_playButtonHandler=new He(i,this.m_isNotAllowedError),this.m_media.autoPlay||!1===this.m_environment.settings.showCustomPlayButtonForVideo||this.isPlaying()?this.setCustomPlayButtonHidden():this.setCustomPlayButtonVisible()}this.beforeFirstRender()}}seekMedia(e){this.m_localMediaInfo&&this.m_localMediaInfo.el?(r.a.sendTraceTag(588002455,n.a.msoulscat_Wac_PptSession,a.a.Info,`Seek media for received event, from host. media: ${this.m_media.name} at position: ${e}.`),this.setCurrentTime(this.m_localMediaInfo,e)):this.m_onlineVideoPlayer&&this.shouldUseOnlineVideoPlayer()&&(this.m_onlineVideoPlayer.seekMedia(e),r.a.sendTraceTag(575545991,n.a.msoulscat_Wac_PptSession,a.a.Info,`Seek online media for received event, from host. media: ${this.m_media.name} at position: ${e}.`))}async setSourceAsync(e,t){if(this.m_localMediaPlaybackSource)return void r.a.sendTraceTag(512271843,n.a.msoulscat_Wac_PptSession,a.a.Error,"Unexpected setSourceAsync with LocalMediaPlaybackSource");const i=this.generateMediaSrcUrl(t.mediaUrl,t.retriesRemaining);if(this.isMediaPlayable(this.m_media.contentType)){try{this.m_localMediaPlaybackTelemetry&&this.m_localMediaPlaybackTelemetry.onSourceSet(i),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.onSourceSet(i)}catch(e){r.a.sendTraceTag(556048640,n.a.msoulscat_Wac_PptSession,a.a.Error,"Exception in LocalVideoPlaybackSummary.onSourceSet: "+e)}if(r.a.sendTraceTag(540587274,n.a.msoulscat_Wac_PptSession,a.a.Info,`Creating media request requestGuid: ${this.m_requestGuid}, retriesRemaining: ${t.retriesRemaining}`),this.m_localMediaPlaybackController){const e=new URL(i);this.m_localMediaPlaybackController.onSourceSet(this.m_requestGuid,t.retriesRemaining,nt.getMediaLengthFromMediaUrl(e),this.m_isTranscoded)}if(!await this.setHlsSourceAsync(i,e)){this.m_hlsError=!1,this.m_wasLoadStarted=!1;const s=new URL(i);if(Fe.ChangeGate.isChangeGateEnabled("SVM.DisableProgressiveTranscoding")&&this.m_isTranscoded){if(!this.isPlayable())return r.a.sendTraceTag(512336969,n.a.msoulscat_Wac_PptSession,a.a.Info,`MediaViewElement::setSourceAsync setHlsSource failed for unplayable media, mediaName: ${this.m_media.name}, retrying.`),this.m_hlsError=!0,void this.onMediaError(t);s.searchParams.delete("transcode"),this.m_isTranscoded=!1,this.m_localMediaPlaybackController&&this.m_localMediaPlaybackController.setIsTranscoding(!1),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setMediaQuality($.Raw)}e.src=s.toString()}}}async setHlsSourceAsync(e,t){this.m_hlsError=!1,this.m_hlsJsManifestLoaded=!1,this.m_hlsAutoRecoverRetryCount=0,this.setHlsBandwidthEstimatesForTelemetry(void 0),this.setIsHlsForTelemetry(!1);const i=!Fe.ChangeGate.isChangeGateEnabled("SVM.UnplayableUsesHLS")||this.isPlayable(),s=this.m_hlsErrorCount>=this.getHLSRetryCount();if(i&&s)return!1;if(this.m_mediaType!==p.a.Video)return!1;if(!this.isMediaDownloadHandlerEnabled(e))return!1;if(-1!==e.indexOf("disableHLS"))return r.a.sendTraceTag(520153309,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement::generateMediaSrcUrl disable HLS for mediaName: "+this.m_media.name),!1;if(!this.isMP4()&&!this.m_isTranscoded)return r.a.sendTraceTag(512336968,n.a.msoulscat_Wac_PptSession,a.a.Error,"MediaViewElement::setHlsSourceAsync Tried using HLS+Raw for non-MP4 file, mediaName: "+this.m_media.name),!1;let o=e;if(this.m_isTranscoded&&!me(this.m_environment)){const e=new URL(o);e.searchParams.set("transcode","All"),o=e.toString()}if(l.Settings.readBooleanOrDefault("initializeHLSJsFirst",!1)){if(await this.tryImportHLSJsInstance()&&(this.tryInitializeHLSJs(),r.a.sendTraceTag(509655110,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement::setHlsSourceAsync() HLS js initialized successfully")),void 0===this.m_hls&&this.setNativeHlsSource(o,t))return r.a.sendTraceTag(509655109,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement::setHlsSourceAsync() Native HLS set successfully"),!0}else{if(this.setNativeHlsSource(o,t))return!0;await this.tryImportHLSJsInstance()&&this.tryInitializeHLSJs()}const d=q[oe(this.m_environment)];return this.m_hls?(r.a.sendTraceTag(524817115,n.a.msoulscat_Wac_PptSession,a.a.Info,`HLS mediaName: ${this.m_media.name} requestGuid: ${this.m_requestGuid} uiHostType: ${d}`),this.m_wasLoadStarted=!1,this.m_hls.loadSource(this.getHLSUrlWithSlashes(o)),this.m_hls.attachMedia(t),this.setIsHlsForTelemetry(!0),!0):(r.a.sendTraceTag(524898944,n.a.msoulscat_Wac_PptSession,a.a.Info,"HLS is not supported: "+d),!1)}isMP4(){return"video/mp4"===this.m_media.contentType}isPlayable(){return this.getMediaRenderAs(this.m_media.contentType)!==H.None}getHLSRetryCount(){return this.isMP4()&&this.m_wasTranscodingRequested?2:1}async tryImportHLSJsInstance(){try{nt.m_hlsJs=await i.e(12).then(i.t.bind(null,461,7))}catch(e){r.a.sendTraceTag(523031559,n.a.msoulscat_Wac_PptSession,a.a.Error,"Exception importing hls.js: "+e)}return!!nt.m_hlsJs}tryInitializeHLSJs(){if(nt.m_hlsJs&&r.a.sendTraceTag(509655108,n.a.msoulscat_Wac_PptSession,a.a.Info,`MediaViewElement::tryInitializeHLSJs(): HLS.js supported for uiHostType ${q[oe(this.m_environment)]}: ${nt.m_hlsJs.default.isSupported()}`),nt.m_hlsJs&&!this.m_hls&&nt.m_hlsJs.default.isSupported()){const e=me(this.m_environment)?l.Settings.readNumberOrDefault("hlsBackBufferLengthMobile",1/0):l.Settings.readNumberOrDefault("hlsBackBufferLength",1/0),t=!Fe.ChangeGate.isChangeGateEnabled("SVM.DisableHLSProgressiveStream");this.m_hls=new nt.m_hlsJs.default({progressive:t,backBufferLength:e}),this.m_hls.on(nt.m_hlsJs.default.Events.MANIFEST_LOADED,e=>{this.m_hlsJsManifestLoaded=!0}),this.m_hls.on(nt.m_hlsJs.default.Events.FRAG_BUFFERED,e=>{this.m_hls&&this.setHlsBandwidthEstimatesForTelemetry(this.m_hls.bandwidthEstimate)}),this.m_hls.on(nt.m_hlsJs.default.Events.ERROR,(e,t)=>{const i=t.type,s=t.fatal;if(r.a.sendTraceTag(524341858,n.a.msoulscat_Wac_PptSession,a.a.Error,`HLS error: mediaName: ${this.m_media.name}, errorFatal: ${s}, errorType: ${i}, errorMessage: ${t.reason}, errorDetail: ${t.details}, uiHostType: ${q[oe(this.m_environment)]}.`),this.m_localMediaPlaybackController&&this.m_localMediaPlaybackController.addHlsError(t.type,t.details),s){if(this.m_hlsJsManifestLoaded&&nt.m_hlsJs&&this.m_hls&&this.m_hlsAutoRecoverRetryCount<=l.Settings.readNumberOrDefault("maxHlsAutoRecoverRetryCount",2))switch(t.type){case nt.m_hlsJs.default.ErrorTypes.NETWORK_ERROR:return r.a.sendTraceTag(520128163,n.a.msoulscat_Wac_PptSession,a.a.Info,`HLS network error: mediaName: ${this.m_media.name}, autoRecoverRetryCount: ${this.m_hlsAutoRecoverRetryCount}.`),this.m_hls.startLoad(),void(this.m_hlsAutoRecoverRetryCount+=1);case nt.m_hlsJs.default.ErrorTypes.MEDIA_ERROR:return r.a.sendTraceTag(520128162,n.a.msoulscat_Wac_PptSession,a.a.Info,`HLS media error: mediaName: ${this.m_media.name}, autoRecoverRetryCount: ${this.m_hlsAutoRecoverRetryCount}.`),this.m_hls.recoverMediaError(),void(this.m_hlsAutoRecoverRetryCount+=1)}this.m_wasMetadataLoaded||(this.m_hlsError=!0,this.m_hlsErrorCount+=1),this.m_localMediaInfo&&this.onMediaError(this.m_localMediaInfo)}})}}setNativeHlsSource(e,t){if(t.canPlayType("application/vnd.apple.mpegurl"))try{let i=this.getHLSUrlWithSlashes(e);return fe(this.m_environment)&&(i+="#t=0.1"),r.a.sendTraceTag(521208256,n.a.msoulscat_Wac_PptSession,a.a.Info,`Native HLS mediaName: ${this.m_media.name} requestGuid: ${this.m_requestGuid}`),this.m_wasLoadStarted=!1,t.src=i,this.setIsHlsForTelemetry(!0),!0}catch(e){r.a.sendTraceTag(521208227,n.a.msoulscat_Wac_PptSession,a.a.Error,`Exception in setting native hls video source: ${e}.`),this.m_hlsError=!0,this.m_hlsErrorCount=1/0}return!1}getHLSUrlWithSlashes(e){return e.replace(/[?&]/g,"/")+"/index.m3u8"}isMediaDownloadHandlerEnabled(e){return e.includes("MediaDownloadHandler")}resetCurrentTime(e){this.setCurrentTime(e,e.props.trimStartMs/1e3)}setCurrentTime(e,t){try{if(this.m_localMediaPlaybackController)return void this.m_localMediaPlaybackController.seek(t);e.el&&(r.a.sendTraceTag(537720079,n.a.msoulscat_Wac_PptSession,a.a.Info,`Changed the current position on media:${e.props.name} from ${e.el.currentTime} to ${t}`),e.el.currentTime=t)}catch(e){r.a.sendTraceTag(556048641,n.a.msoulscat_Wac_PptSession,a.a.Error,"Exception in setCurrentTime: "+e)}}stopMedia(){this.m_localMediaInfo&&this.m_localMediaInfo.el?(r.a.sendTraceTag(571236866,n.a.msoulscat_Wac_PptSession,a.a.Info,`Stop local media. media: ${this.m_media.name}.`),this.resetCurrentTime(this.m_localMediaInfo),this.pauseHelper(this.m_localMediaInfo)):this.m_onlineVideoPlayer&&this.shouldUseOnlineVideoPlayer()&&(r.a.sendTraceTag(571236865,n.a.msoulscat_Wac_PptSession,a.a.Info,`Stop online media. media: ${this.m_media.name}.`),this.m_onlineVideoPlayer.stopMedia())}setMediaVolume(e){this.enableVolumeSync()&&!this.m_fMuteSyncDisabled&&(e<0||(this.m_localMediaInfo&&this.m_localMediaInfo.el?(this.m_localMediaInfo.el.volume=e,r.a.sendTraceTag(557176146,n.a.msoulscat_Wac_PptSession,a.a.Info,`Set volume local media. media: ${this.m_media.name}. Volume: ${e}`)):this.m_onlineVideoPlayer&&this.shouldUseOnlineVideoPlayer()&&(this.m_onlineVideoPlayer.setVolume(e),r.a.sendTraceTag(557176145,n.a.msoulscat_Wac_PptSession,a.a.Info,`Set volume online media. media: ${this.m_media.name}. Volume: ${e}`))))}setMediaMute(e){this.m_fMuteSyncDisabled||(this.m_localMediaInfo&&this.m_localMediaInfo.el?(this.m_localMediaInfo.el.muted=e,e?r.a.sendTraceTag(557176148,n.a.msoulscat_Wac_PptSession,a.a.Info,`Mute local media. media: ${this.m_media.name}.`):r.a.sendTraceTag(557176150,n.a.msoulscat_Wac_PptSession,a.a.Info,`Unmute local media. media: ${this.m_media.name}.`)):this.m_onlineVideoPlayer&&this.shouldUseOnlineVideoPlayer()&&(e?(this.m_onlineVideoPlayer.setMute(),r.a.sendTraceTag(557176147,n.a.msoulscat_Wac_PptSession,a.a.Info,`Mute volume online media. media: ${this.m_media.name}.`)):(this.m_onlineVideoPlayer.setUnMute(),r.a.sendTraceTag(557176149,n.a.msoulscat_Wac_PptSession,a.a.Info,`Unmute volume online media. media: ${this.m_media.name}.`))))}getMediaName(){return this.m_media.name}getMediaInfo(){return{name:this.m_media.name,type:this.m_mediaType,isLoopingBackgroundVideo:void 0!==this.m_localMediaInfo&&this.isLoopingBackgroundVideo(this.m_localMediaInfo),isRenderedToCanvas:this.shouldRenderToCanvas,duration:this.getMediaDuration()}}getMediaDuration(){let e;return this.m_localMediaInfo&&this.m_localMediaInfo.el&&!isNaN(this.m_localMediaInfo.el.duration)?e=this.m_localMediaInfo.el.duration:this.m_onlineVideoPlayer&&(e=this.m_onlineVideoPlayer.getDuration()),e||r.a.sendTraceTag(521175494,n.a.msoulscat_Wac_PptSession,a.a.Info,"getMediaDuration: Unable to get duration for "+this.m_media.name),e}cleanUp(){const e=this.m_environment.rendererEnvironment.glContext;e&&!e.isContextLost()&&this.m_videoTexture&&(this.m_videoTexture.release(),this.m_environment.viewDataManager.memoryStats.videoTextures-=this.m_mediaSize.x*this.m_mediaSize.y*4),this.m_videoTexture=void 0;const t=this.m_shapeItem;if(this.m_fCropForCanvasRender&&t.style.pictureBrush&&(t.style.pictureBrush.scale=new p.b(1,1),t.style.pictureBrush.offset=new p.b(0,0)),l.Settings.readBooleanOrDefault("resizeMediaOnSlideScaling",!1))this.m_localMediaEventsDiv&&this.m_localMediaEventsDiv.remove();else{const e=document.querySelector("#video-events-"+this.m_media.name);e&&e.remove()}this.m_controls=void 0}tryPrepare(){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,5),this.m_environment.settings.transparentCanvasForVideoEnabled&&this.m_transparentShapeItem&&(this.fPrepared=this.fPrepared&&this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_transparentShapeItem,!1,5)),this.m_environment.rendererEnvironment.flush()),this.fPrepared}getMediaRenderAs(e){return void 0===this.m_renderAs&&(this.m_renderAs=pe.getMediaRenderAs(e)),this.m_renderAs}isMediaPlayable(e){if(!this.m_localMediaPlaybackSource&&this.m_isTranscoded)return!0;if(void 0!==this.m_fMediaPlayable)return this.m_fMediaPlayable;let t=H.None;if(t=this.m_localMediaPlaybackSource?this.m_localMediaPlaybackSource.isUnplayable()?H.None:H.HTML5:this.getMediaRenderAs(e),t===H.None){this.m_fMediaPlayable=!1,r.a.sendTraceTag(593356511,n.a.msoulscat_Wac_PptSession,a.a.Error,`Slide ${this.m_slideId.sid} shape ${this.id.shapeId} has media with unplayable contentType ${e}.`);const t={errorCode:0,mediaName:`${this.m_slideId.sid}s${this.id.shapeId}`,contentType:e,mediaType:pe.getMediaTypeFromContentType(e)};r.a.sendTraceTag(570750435,n.a.msoulscat_Wac_PptSession,a.a.Info,"NavigatingFrom "+JSON.stringify(t)),g.VetoUtils.recordVeto("MediaPlaybackFailed",{slideId:this.m_slideId.sid,shapeId:this.id.shapeId,contentType:e,mediaType:pe.getMediaTypeFromContentType(e),errorName:"UnplayableContentType",mediaName:t.mediaName,qosVeto:"MediaPlaybackFailed",isIntentional:!0})}else this.m_fMediaPlayable=!0,r.a.sendTraceTag(593356512,n.a.msoulscat_Wac_PptSession,a.a.Info,`Slide ${this.m_slideId.sid} shape ${this.id.shapeId} has media with contentType ${e}, will play back via ${H[t]}.`);return this.m_fMediaPlayable}isLoopingBackgroundVideo(e){return void 0!==this.m_isLoopingBackgroundVideo?this.m_isLoopingBackgroundVideo:!!e.el&&!isNaN(e.el.duration)&&(r.a.sendTraceTag(577632458,n.a.msoulscat_Wac_PptSession,a.a.Info,"Video duration: "+e.el.duration),this.m_mediaType===p.a.Video&&e.autoPlay&&e.fLooping&&e.fMutedInFile&&e.el.duration<15?(r.a.sendTraceTag(588002456,n.a.msoulscat_Wac_PptSession,a.a.Info,"Media is Looping Background Video: "+this.m_media.name),this.m_isLoopingBackgroundVideo=!0):this.m_isLoopingBackgroundVideo=!1,this.m_isLoopingBackgroundVideo)}isVideoPartiallyOffSlide(){return this.m_mediaPosition.x<0&&this.m_mediaPosition.x+this.m_mediaSize.x>0||this.m_mediaPosition.y<0&&this.m_mediaPosition.y+this.m_mediaSize.y>0||this.m_mediaPosition.x<this.m_slideSizePixels.x&&this.m_mediaPosition.x+this.m_mediaSize.x>this.m_slideSizePixels.x||this.m_mediaPosition.y<this.m_slideSizePixels.y&&this.m_mediaPosition.y+this.m_mediaSize.y>this.m_slideSizePixels.y}isFullSizeVideo(){return this.m_mediaType===p.a.Video&&(this.m_mediaSize.x>.95*this.m_slideSizePixels.x&&this.m_mediaSize.x<1.05*this.m_slideSizePixels.x&&this.m_mediaSize.y>.95*this.m_slideSizePixels.y&&this.m_mediaSize.y<1.05*this.m_slideSizePixels.y)}static getLocalizedString(){let e;return e="undefined"!=typeof PowerpointSlideshowStrings?{audioStr:PowerpointSlideshowStrings.AudioMediaElementLabel,videoStr:PowerpointSlideshowStrings.VideoMediaElementLabel}:{audioStr:"Audio",videoStr:"Video"},e}getAdjustedBounds(){const e=this.getBounds();let t=e.left,i=e.right,r=e.top,n=e.bottom;return Fe.ChangeGate.isChangeGateEnabled("SVM.AdjustPlaybackControlBounds")&&(e.left<0&&e.right>0&&(t=0),e.top<0&&e.bottom>0&&(r=0),e.right>this.m_slideSizePixels.x&&e.left<this.m_slideSizePixels.x&&(i=this.m_slideSizePixels.x),e.bottom>this.m_slideSizePixels.y&&e.top<this.m_slideSizePixels.y&&(n=this.m_slideSizePixels.y)),new h.c(t,r,i,n)}onGfxControlsPlay(){this.playMedia(),!this.m_playbackControlCallbacks||Fe.ChangeGate.isChangeGateEnabled("SVM.disableLoopingCallbacks")&&this.m_isLoopingBackgroundVideo||this.m_playbackControlCallbacks.onPlayClick()}onGfxControlsPause(){this.pauseMedia(),!this.m_playbackControlCallbacks||Fe.ChangeGate.isChangeGateEnabled("SVM.disableLoopingCallbacks")&&this.m_isLoopingBackgroundVideo||this.m_playbackControlCallbacks.onPauseClick()}onGfxControlsSeek(e){this.seekMedia(e),this.m_playbackControlCallbacks&&this.m_playbackControlCallbacks.onSeeked()}onGfxControlsVolumeChange(){this.m_playbackControlCallbacks&&this.m_playbackControlCallbacks.onVolumeChanged()}onGfxControlsVolumeClick(){this.m_playbackControlCallbacks&&this.m_playbackControlCallbacks.onVolumeClick()}isPresenter(){if(0!==this.m_environment.rendererEnvironment.viewController.mediaCommandScope)return 2===this.m_environment.rendererEnvironment.viewController.mediaCommandScope}initPlaybackControls(e){if(this.m_playbackControlCallbacks||(this.m_playbackControlCallbacks=new Xe((e,t)=>this.sendMediaSyncEvent(e,t),e=>this.sendUserMediaActionEvent(e))),!this.m_controls){const t={playMediaCallback:()=>this.onGfxControlsPlay(),pauseMediaCallback:()=>this.onGfxControlsPause(),seekMediaCallback:e=>this.onGfxControlsSeek(e),muteUnmuteCallback:()=>this.onGfxControlsVolumeClick(),volumeChangedCallback:()=>this.onGfxControlsVolumeChange(),logVetoCallback:e=>ve(e),isPresenterCallback:()=>this.isPresenter()},i=this.m_localMediaInfo,r=Ye.getMediaControlInfo(i,this.getAdjustedBounds(),this.m_environment);r.captionsEnabled=this.isCaptionsEnabled(),this.isCaptionsEnabled()&&(r.captionsRenderer=this.m_environment.rendererEnvironment.viewController.getCaptionsRenderer),r.volumeSliderEnabled=this.isVolumeSliderEnabled(),r.speedEnabled=this.isSpeedEnabled(),r.fullscreenEnabled=this.isFullscreenEnabled(),r.nestedTabbingEnabled=this.isNestedTabbingEnabled(),this.isTooltipsEnabled()&&(r.tooltipMap=Ye.getTooltipMap()),l.Settings.readBooleanOrDefault("enableLoopingVideoControls",!0)&&void 0!==this.m_localMediaInfo&&(r.playPauseOnly=this.isLoopingBackgroundVideo(this.m_localMediaInfo)),r.captionsPositioningStrategy=l.Settings.readNumberOrDefault("captionsPositioningStrategy",0),r.transferCaptionsFullScreen=Fe.ChangeGate.isChangeGateEnabled("SVM.transferCaptionsFullScreen"),this.m_controls=new Le.a(e,r,t),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setPlaybackControlsFlag()}}sendUserMediaActionEvent(e){r.a.sendTraceTag(520161045,n.a.msoulscat_Wac_PptSession,a.a.Info,`MediaViewElement: Emitting User Media Action Event (actionType: ${e}, mediaName: ${this.m_media.name})`),this.m_slideEvents.emit("userMediaAction",{actionType:e,mediaName:this.m_media.name})}sendMediaSyncEvent(e,t){if(void 0!==t&&Fe.ChangeGate.isChangeGateEnabled("SVM.dontSendMediaSyncEventsFromUserMediaActions"))return;if(this.shouldSuppressMediaSyncEvent(e,this.m_localMediaInfo))return void r.a.sendTraceTag(528570271,n.a.msoulscat_Wac_PptSession,a.a.Info,`Media Sync event ${nt.getEventName(e)} for ${this.m_media.name} suppressed.`);let i,s,o;this.m_localMediaInfo&&this.m_localMediaInfo.el?(i=this.m_localMediaInfo.el.currentTime,s=this.m_localMediaInfo.el.volume,o=this.m_localMediaInfo.el.muted):this.m_onlineVideoPlayer&&(i=this.m_onlineVideoPlayer.getCurrentTime(),s=this.m_onlineVideoPlayer.getVolume(),o=this.m_onlineVideoPlayer.isMuted()),l.Settings.readBooleanOrDefault("enableGlobalMute",!1)&&this.m_environment.isGlobalMute&&(o=void 0);const d={mediaName:this.m_media.name,event:{eventType:e,position:i||0,volume:s,muted:o},origin:{hostName:p.a[this.m_mediaType],actionType:t},correlationId:Object(je.v4)()};nt.logMediaSyncEmission(d),this.m_slideEvents.emit(nt.getEventName(e),d)}isCropInSVGSupported(){return!!l.Settings.readBooleanOrDefault("forceSvg",!1)&&(!(!le(this.m_environment)&&!de(this.m_environment))||l.Settings.readBooleanOrDefault("cropSupportInSVG",!1))}isCropInSVGEnabled(){return void 0!==this.m_fCropInSVG||(this.m_media.cropInfo&&this.isCropInSVGSupported()&&(0!==this.m_media.cropInfo.top||0!==this.m_media.cropInfo.left||1!==this.m_media.cropInfo.bottom||1!==this.m_media.cropInfo.right)?(this.m_fCropInSVG=!0,r.a.sendTraceTag(509614208,n.a.msoulscat_Wac_PptSession,a.a.Info,"Cropped media is rendered in SVG.")):this.m_fCropInSVG=!1),this.m_fCropInSVG}localMediaEventHandler(e){0===e?this.m_wasLoadStarted=!0:2===e&&this.m_localMediaInfo?this.onLoadedData(this.m_localMediaInfo):1===e&&this.m_localMediaInfo?fe(this.m_environment)&&this.onLoadedMetaData(this.m_localMediaInfo):3===e&&this.m_localMediaInfo?fe(this.m_environment)||this.onLoadedMetaData(this.m_localMediaInfo):4===e&&this.m_localMediaInfo?this.onPlay(this.m_localMediaInfo):5===e?this.onPlaying():6===e&&this.m_localMediaInfo?this.onPause(this.m_localMediaInfo):7===e&&this.m_localMediaInfo?this.onSeeked(this.m_localMediaInfo):9===e&&this.m_localMediaInfo?this.onTimeUpdate(this.m_localMediaInfo):11===e&&this.m_localMediaInfo?this.onEnded(this.m_localMediaInfo):10===e&&this.m_localMediaInfo?this.onVolumeChange(this.m_localMediaInfo):12===e&&this.m_localMediaInfo&&this.onMediaError(this.m_localMediaInfo)}createMediaElement(){let e;return this.m_mediaType===p.a.Audio?e=document.createElement("audio"):(l.Settings.readBooleanOrDefault("dontCreateNewMediaElement",!0)?(e=document.getElementById(this.ShapeMediaTargetId),e||(e=document.createElement("video"))):e=document.createElement("video"),e.crossOrigin="anonymous"),e}initLocalMediaTelemetry(){this.m_localMediaPlaybackTelemetry=new it(this.m_media,this.m_environment,this.m_slideId,e=>{if(this.m_localMediaPlayer){const t=new URL(e),i=t.searchParams.get("ext");if(null!==i)this.m_localMediaPlayer.setMediaExtension(i);else{const e=t.searchParams.get("mediaId");if(null!==e){const t=/^.+\.([^\.]+)\.media$/.exec(e);null!==t&&2===t.length&&this.m_localMediaPlayer.setMediaExtension(t[1])}}const r=t.searchParams.get("mediaLength");null!==r&&this.m_localMediaPlayer.setMediaLength(parseInt(r,10));const n=t.searchParams.get("retries");null!==n&&this.m_localMediaPlayer.setRetriesLeft(parseInt(n,10)),this.m_localMediaPlayer.onSourceSet()}},this.m_isPrefetch,this.shouldRenderToCanvas)}initLocalMediaInfo(){if(r.a.sendTraceTag(541329225,n.a.msoulscat_Wac_PptSession,a.a.Info,"Local video type: "+this.m_media.contentType),!this.isMediaPlayable(this.m_media.contentType))return;if(l.Settings.readBooleanOrDefault("disableOffSlideVideoInSVG",!1)&&this.isVideoPartiallyOffSlide()&&l.Settings.readBooleanOrDefault("forceSvg",!1)){const e={errorCode:-1,mediaName:`${this.m_slideId.sid}s${this.id.shapeId}`};return r.a.sendTraceTag(509638094,n.a.msoulscat_Wac_PptSession,a.a.Error,`Unable to render media on slide ${this.m_slideId.sid} shape ${this.id.shapeId}: off-slide media is rendered as image in SVG.`),r.a.sendTraceTag(570750435,n.a.msoulscat_Wac_PptSession,a.a.Info,"NavigatingFrom "+JSON.stringify(e)),void g.VetoUtils.recordVeto("MediaPlaybackFailed",{slideId:this.m_slideId.sid,shapeId:this.id.shapeId,mediaName:e.mediaName,errorName:"MediaRenderedAsImage",qosVeto:"MediaPlaybackFailed",isIntentional:!0})}let e=`${this.m_environment.settings.serverUrl}${this.m_media.src.substring(1)}`;this.isMediaDownloadHandlerEnabled(this.m_media.src)&&(e=""+this.m_media.src);const t={elID:this.ShapeMediaTargetId,autoPlay:this.m_media.autoPlay,nativeWidth:this.m_mediaSize.x,nativeHeight:this.m_mediaSize.y,retriesRemaining:this.m_initialRetryCount,retryTimeoutMs:l.Settings.readNumberOrDefault("mediaRetryInitialDelayMs",nt.BD_HTML5_MEDIA_RETRY_INITIALDELAYMS),numRepeatsRemaining:this.m_media.repeat,numRepeatsOriginal:this.m_media.repeat,fFullBleed:0===this.m_mediaPosition.x&&0===this.m_mediaPosition.y&&this.m_mediaSize.x===this.m_slideSizePixels.x&&this.m_mediaSize.y===this.m_slideSizePixels.y,fLooping:-1===this.m_media.repeat||this.m_media.repeat>1,fMutedInFile:0===this.m_media.volume,fReachedEnd:!1,fPositionInitialized:!1,fPendingPlay:!1,fPendingPause:!1,props:this.m_media,el:void 0,mediaUrl:decodeURIComponent(e)};let i;if(this.m_mediaType!==p.a.Audio&&this.m_mediaType!==p.a.Video)return void r.a.sendTraceTag(593356507,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement::initLocalMediaInfo: It is not local media, skipping...");if(l.Settings.readBooleanOrDefault("useLocalMediaPlayer",!0)){t.props.ariaLabel=this.m_mediaType===p.a.Video?nt.getLocalizedString().videoStr:nt.getLocalizedString().audioStr;const e={mediaInfo:t,id:this.id,type:this.m_mediaType,size:this.getMediaSize(),position:this.m_mediaPosition,settings:this.m_environment.settings,isTeams:le(this.m_environment),uiHostType:q[oe(this.m_environment)],cropInfo:this.m_media.cropInfo,shouldRenderToCanvas:this.shouldRenderToCanvas,usePlaybackControls:this.usePlaybackControls(),isCropInSVGEnabled:this.isCropInSVGEnabled(),isHostIOS:fe(this.m_environment),onMediaEventCallbacks:e=>this.localMediaEventHandler(e)};if(this.m_localMediaPlayer=function(e){const t=function(e){const t=e.isTeams;return{App:t?"Teams":"PowerPoint",AppPlatform:t?"Previewer":"WAC",AppCorrelation:e.settings.sessionId,AcceptLanguage:e.settings.acceptLanguage,SlowPlayVetoThreshold:l.Settings.readNumberOrDefault("slowPlayVetoThreshold",1e4),NotYetPlayedVetoThreshold:l.Settings.readNumberOrDefault("notYetPlayedVetoThreshold",3e4),hostComponent:t?"SlideshowApp":"Unified",hostView:t?"PowerPointLive":"Present"}}(e),i=function(e){const t=e.mediaInfo.props;let i={trimStartSec:t.trimStartMs/1e3,trimEndSec:t.trimEndMs/1e3,volume:t.volume,mute:e.mediaInfo.fMutedInFile,repeat:e.mediaInfo.fLooping,rewind:!1,playAcrossSlides:t.playAcrossSlides>0,hideDuringShow:!1,startOption:"",trimmedEndTimeSec:void 0,durationSec:void 0,loggableId:t.name,elementId:e.mediaInfo.elID,mediaType:e.type,contentType:t.contentType,autoPlay:!1,crossOrigin:"anonymous",controls:!e.shouldRenderToCanvas&&!e.usePlaybackControls,useCustomControls:e.usePlaybackControls,handleTimeUpdate:t.trimEndMs>0,playsInline:!(e.type!==p.a.Video||!e.isHostIOS)||void 0,zIndex:e.settings.transparentCanvasForVideoEnabled&&e.type===p.a.Video&&!e.shouldRenderToCanvas?"0":"2",height:e.size.y,width:e.size.x,preload:e.isHostIOS?"metadata":"auto",styles:{pointerEvents:"auto",position:"absolute",objectFit:"fill",opacity:e.shouldRenderToCanvas?"0":void 0},attributes:{"aria-label":e.mediaInfo.props.ariaLabel,controlsList:"nodownload",disablePictureInPicture:"true"}};if(e.settings.transparentCanvasForVideoEnabled||l.Settings.readBooleanOrDefault("forceSvg",!1)||(i.zIndex="4"),i.styles){if(e.type===p.a.Video&&e.isCropInSVGEnabled&&t.cropInfo){i.styles.clipPath=`inset(${100*t.cropInfo.top}% ${100*(1-t.cropInfo.right)}% ${100*(1-t.cropInfo.bottom)}% ${100*t.cropInfo.left}%)`;const e=1/(t.cropInfo.right-t.cropInfo.left),r=1/(t.cropInfo.bottom-t.cropInfo.top);i.styles.transform=`translate(${(1-t.cropInfo.right-t.cropInfo.left)*e*100/2}%, ${(1-t.cropInfo.bottom-t.cropInfo.top)*r*100/2}%) scale(${e}, ${r})`}l.Settings.readBooleanOrDefault("forceSvg",!1)||(i.styles.left=e.position.x+"px",i.styles.top=e.position.y+"px"),e.type==p.a.Audio&&(i.styles.visibility=t.hideWhenStopped?"hidden":"visible",i.styles.width=e.size.x+"px",i.styles.height=e.size.y+"px",e.settings.editAudioEnabled&&(e.size.x<240&&(i.styles.width="240px"),e.size.y<30&&(i.styles.height="30px")))}return i.attributes&&e.type===p.a.Audio&&(i.attributes.role="link",i.attributes["aria-role"]="link"),i}(e);let s=new tt(e.mediaInfo.mediaUrl,void 0,!1,t,i,e.onMediaEventCallbacks,t=>{r.a.sendTraceTag(508380035,n.a.msoulscat_Wac_PptSession,a.a.Error,"Local media sent veto: "+JSON.stringify({vetoName:t.vetoName,errorName:t.errorName,details:t.details,correlationId:t.correlationId,mediaType:p.a[e.type],mediaName:e.mediaInfo.props.name,uiHostType:e.uiHostType,teamsCallId:e.settings.teamsCallId}))});if(s){r.a.sendTraceTag(508372962,n.a.msoulscat_Wac_PptSession,a.a.Info,"Created LocalMediaPlayer.  Media name: "+e.mediaInfo.props.name);const t={hlsJsFirst:l.Settings.readBooleanOrDefault("initializeHLSJsFirst",!1),useLoadedMetadata:l.Settings.readBooleanOrDefault("useLoadedMetadataAsInteractivityEvent",!0),iOSPreload:l.Settings.readBooleanOrDefault("iOSHlsPreload",!0),cleanupHlsJs:l.Settings.readBooleanOrDefault("cleanupHlsJsOnNavigatedFrom",!0),cleanupNativeHls:l.Settings.readBooleanOrDefault("cleanupNativeHlsOnNavigatedFrom",!0)};s.setFlights(JSON.stringify(t)),s.setUiHostType(e.uiHostType),0===e.mediaInfo.props.volume?s.setMute():(!Fe.ChangeGate.isChangeGateEnabled("SVM.disableSetIOSVolumeMax")&&e.isHostIOS&&(e.mediaInfo.props.volume=1),s.setVolume(e.mediaInfo.props.volume))}else r.a.sendTraceTag(508372961,n.a.msoulscat_Wac_PptSession,a.a.Error,"Failed to create LocalMediaPlayer. Media name: "+e.mediaInfo.props.name);return s}(e),!this.m_localMediaPlayer||!this.m_localMediaPlayer.getMediaElement())return void r.a.sendTraceTag(508380034,n.a.msoulscat_Wac_PptSession,a.a.Error,`Failed to create LocalMediaPlayer for ${p.a[this.m_mediaType]} element:  ${this.m_media.name}`);i=this.m_localMediaPlayer.getMediaElement(),l.Settings.readBooleanOrDefault("UseNewLocalMediaTelemetry",!0)&&this.initLocalMediaTelemetry()}else i=this.createMediaElement();if(this.m_mediaType===p.a.Video&&!this.isCropInSVGEnabled()){const e=this.getVideoPosterFrameUri();e?i.poster=e:r.a.sendTraceTag(509154584,n.a.msoulscat_Wac_PptSession,a.a.Error,"Failed to find local video poster frame")}if(void 0===this.m_localMediaPlaybackPerf&&(Fe.ChangeGate.isChangeGateEnabled("SVM.playAcrossSlidesWithController")||!this.m_media.playAcrossSlides))try{const e=me(this.m_environment),r=()=>{this.m_isNotAllowedError=!0,this.setCustomPlayButtonVisible()};this.m_localMediaPlaybackController=new Ve(i,this.m_media.name,this.m_mediaType,fe(this.m_environment),e,le(this.m_environment),de(this.m_environment),this.onLocalPlaybackQualityImpactError,r),this.m_localMediaPlaybackPerf=new Ne(i,this.m_pixelScale,this.m_slideEvents,oe(this.m_environment),this.m_media,this.m_mediaType,this.m_environment.viewDataManager.getSlideIndex(this.m_slideId),this.m_environment.settings.startFromTime,this.m_environment.settings.initTime,void 0,this.m_initialRetryCount,this.m_isPrefetch,this.m_environment.settings.teamsCallId),Fe.ChangeGate.isChangeGateEnabled("SVM.AddWasVetoLogged")&&this.m_localMediaPlaybackController.setLocalMediaPlaybackPerf(this.m_localMediaPlaybackPerf);const n=new URL(t.mediaUrl),a=nt.getMediaLengthFromMediaUrl(n),s=()=>{this.isRetryUxEnabledForMedia()&&(this.setCustomPlayButtonHidden(),this.setRetryButtonVisible())};this.m_localMediaPlaybackSource=new Ue(i,n,this.m_media.name,this.isMediaDownloadHandlerEnabled(this.m_media.src),void 0===a?0:a,this.isPlayable(),this.m_mediaType===p.a.Video,"video/mp4"===this.m_media.contentType,e,oe(this.m_environment),this.getTotalRetryCount(),this.m_environment.settings.sessionId,this.m_requestGuid,this.m_localMediaPlaybackPerf,this.m_localMediaPlaybackController,s,this.m_localMediaPlaybackTelemetry)}catch(e){r.a.sendTraceTag(570716893,n.a.msoulscat_Wac_PptSession,a.a.Error,"MediaViewElement::initLocalMediaInfo Failed to construct LocalMediaPlaybackPerf "+e)}if(this.m_localMediaPlaybackSource?this.isMediaPlayable(this.m_media.contentType)&&this.m_localMediaPlaybackSource.setSource():this.setSourceAsync(i,t),!l.Settings.readBooleanOrDefault("useLocalMediaPlayer",!0)){if(this.m_mediaType===p.a.Video){const e=i;if(this.m_mediaSize=this.getMediaSize(),e.width=this.m_mediaSize.x,e.height=this.m_mediaSize.y,this.isCropInSVGEnabled()&&this.m_media.cropInfo){e.style.clipPath=`inset(${100*this.m_media.cropInfo.top}% ${100*(1-this.m_media.cropInfo.right)}% ${100*(1-this.m_media.cropInfo.bottom)}% ${100*this.m_media.cropInfo.left}%)`;const t=1/(this.m_media.cropInfo.right-this.m_media.cropInfo.left),i=1/(this.m_media.cropInfo.bottom-this.m_media.cropInfo.top);e.style.transform=`translate(${(1-this.m_media.cropInfo.right-this.m_media.cropInfo.left)*t*100/2}%, ${(1-this.m_media.cropInfo.bottom-this.m_media.cropInfo.top)*i*100/2}%) scale(${t}, ${i})`}fe(this.m_environment)&&(e.playsInline=!0,r.a.sendTraceTag(545645912,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement::initLocalMediaInfo: Set playsInline flag to true"))}else i.style.width=this.m_mediaSize.x+"px",i.style.height=this.m_mediaSize.y+"px";if(fe(this.m_environment)?i.preload="metadata":i.preload="auto",0===this.m_media.volume?i.muted=!0:(!Fe.ChangeGate.isChangeGateEnabled("SVM.disableSetIOSVolumeMax")&&fe(this.m_environment)&&(this.m_media.volume=1),i.volume=this.m_media.volume),i.id=t.elID,l.Settings.readBooleanOrDefault("forceSvg",!1)||(i.style.left=this.m_mediaPosition.x+"px",i.style.top=this.m_mediaPosition.y+"px"),this.m_mediaType===p.a.Audio&&(i.style.visibility=t.props.hideWhenStopped?"hidden":"visible"),i.style.position="absolute",this.m_environment.settings.transparentCanvasForVideoEnabled||l.Settings.readBooleanOrDefault("forceSvg",!1)||(i.style.zIndex="4"),this.m_mediaType===p.a.Audio&&(i.setAttribute("role","link"),i.setAttribute("aria-role","link"),i.setAttribute("aria-label",this.m_media.ariaLabel||nt.getLocalizedString().audioStr)),i.addEventListener("error",()=>{this.m_localMediaPlaybackSource||(t&&t.el&&t.el.src.endsWith("m3u8")&&(this.m_wasMetadataLoaded||(this.m_hlsError=!0,this.m_hlsErrorCount+=1)),this.onMediaError(t))}),i.addEventListener("ended",()=>this.onEnded(t)),i.addEventListener("loadeddata",()=>this.onLoadedData(t)),fe(this.m_environment)?i.addEventListener("loadedmetadata",()=>this.onLoadedMetaData(t)):i.addEventListener("canplay",()=>this.onLoadedMetaData(t)),this.m_media.trimEndMs>0&&i.addEventListener("timeupdate",()=>this.onTimeUpdate(t)),i.addEventListener("play",()=>this.onPlay(t)),i.addEventListener("playing",()=>this.onPlaying()),i.addEventListener("pause",()=>this.onPause(t)),i.addEventListener("seeked",()=>this.onSeeked(t)),i.addEventListener("volumechange",()=>this.onVolumeChange(t)),this.m_mediaType!==p.a.Audio&&this.m_mediaType!==p.a.Video||i.setAttribute("controlsList","nodownload"),this.m_mediaType===p.a.Audio&&this.m_environment.settings.editAudioEnabled){this.m_mediaSize.x<nt.MIN_AUDIO_PLAYBACK_BAR_WIDTH&&(i.style.width=nt.MIN_AUDIO_PLAYBACK_BAR_WIDTH+"px"),this.m_mediaSize.y<nt.MIN_AUDIO_PLAYBACK_BAR_HEIGHT&&(i.style.height=nt.MIN_AUDIO_PLAYBACK_BAR_HEIGHT+"px"),nt.showMediaElement(i,!1);let e=!1;i.addEventListener("mouseover",()=>{nt.showMediaElement(i,!0)}),i.addEventListener("focus",()=>{nt.showMediaElement(i,!0),e=!0}),i.addEventListener("mouseout",()=>{e||nt.showMediaElement(i,!1)}),i.addEventListener("blur",()=>{nt.showMediaElement(i,!1),e=!1})}i.addEventListener("loadstart",()=>{this.m_wasLoadStarted=!0}),i.addEventListener("loadedmetadata",()=>{this.m_wasMetadataLoaded=!0}),i.addEventListener("click",e=>{nt.ignoreClick(e)},!1),this.m_mediaType!==p.a.Video||this.usePlaybackControls()||(i.addEventListener("mouseover",()=>{(l.Settings.readBooleanOrDefault("enableRoleBasedVideoPlayUX",!1)&&this.m_localMediaInfo&&!this.isLoopingBackgroundVideo(this.m_localMediaInfo)&&!this.isCustomPlayButtonVisible()||this.m_localMediaInfo&&this.m_localMediaInfo.fLooping&&!this.m_localMediaInfo.autoPlay&&!this.isCustomPlayButtonVisible())&&(i.controls=!0)}),i.addEventListener("mouseout",()=>{(l.Settings.readBooleanOrDefault("enableRoleBasedVideoPlayUX",!1)&&this.m_localMediaInfo&&!this.isLoopingBackgroundVideo(this.m_localMediaInfo)&&!this.isCustomPlayButtonVisible()||this.m_localMediaInfo&&this.m_localMediaInfo.fLooping&&!this.m_localMediaInfo.autoPlay&&!this.isCustomPlayButtonVisible())&&(i.controls=!1)}))}if(this.m_media.playAcrossSlides){const e=(this.m_environment.crossSlideMediaMap?this.m_environment.crossSlideMediaMap[JSON.stringify(this.m_slideId)]:null)||[];e.push({mediaElement:i,mediaProps:this.m_media}),this.m_environment.crossSlideMediaMap[JSON.stringify(this.m_slideId)]=e}this.m_mediaType===p.a.Video&&this.isVideoPartiallyOffSlide()&&!l.Settings.readBooleanOrDefault("forceSvg",!1)&&(this.handlePartiallyOffSlideLocalVideo(i),r.a.sendTraceTag(559256072,n.a.msoulscat_Wac_PptSession,a.a.Info,"Local media is partially off slide.")),this.isFullSizeVideo()&&r.a.sendTraceTag(541405761,n.a.msoulscat_Wac_PptSession,a.a.Info,"Embedded video is full screen size"),t.el=i,this.m_shouldRenderToCanvas=!l.Settings.readBooleanOrDefault("forceSvg",!1)&&this.m_mediaType===p.a.Video&&(!!l.Settings.readBooleanOrDefault("renderLocalVideoToCanvasMobile",!1)||!me(this.m_environment))&&this.shouldRenderLocalVideoToCanvas(this.m_shapeItem);const s=this.m_shapeItem;Fe.ChangeGate.isChangeGateEnabled("SVM.removeEffectsIfNotRenderingToCanvas")&&!this.m_shouldRenderToCanvas&&s.effects.hasEffects&&this.removeEffects(s),r.a.sendTraceTag(524870793,n.a.msoulscat_Wac_PptSession,a.a.Info,`Media ${this.m_media.name} shouldRenderToCanvas: ${this.m_shouldRenderToCanvas}`),this.m_shouldRenderToCanvas&&this.setAlphaInvariant(),t.el.tabIndex=0,l.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&(t.el.onkeydown=e=>{"Enter"===e.key||" "===e.key?this.isCustomPlayButtonVisible()?(e.stopImmediatePropagation(),this.customPlayButtonAction(!0)):this.usePlaybackControls()&&this.m_localMediaInfo&&(!this.isLoopingBackgroundVideo(this.m_localMediaInfo)||l.Settings.readBooleanOrDefault("enableLoopingVideoControls",!0))&&(e.stopImmediatePropagation(),this.sendUserMediaActionEvent(7),this.togglePauseMedia()):"j"!==e.key&&""!==e.key||!e.altKey||this.m_controls&&(e.stopImmediatePropagation(),this.isCustomPlayButtonVisible()&&this.customPlayButtonAction(!1),this.m_controls.toggleCaptionsMenu("Keyboard"))}),this.isVideoFrameTrackerEnabled()&&this.m_mediaType===p.a.Video&&!this.m_frameTracker&&(this.m_frameTracker=new Ze(t.el,{mediaName:this.m_media.name})),this.m_localMediaInfo=t}isVideoFrameTrackerEnabled(){return!!le(this.m_environment)||l.Settings.readBooleanOrDefault("enableVideoFrameTracker",!1)}getVideoPosterFrameUri(){if(void 0!==this.m_shapeItem){const e=this.m_shapeItem.getBrushImages();for(const t of e)if(t.id){const e=this.m_environment.viewDataManager.imageDataMap.get(t.id);if(e&&e.dataUri)return e.dataUri}}}isVolumeSliderEnabled(){return!fe(this.m_environment)||!l.Settings.readBooleanOrDefault("disableVolumeSliderIOS",!0)}isNestedTabbingEnabled(){return!(!this.usePlaybackControls()||me(this.m_environment))}isCaptionsEnabled(){return!!this.usePlaybackControls()&&(fe(this.m_environment)?l.Settings.readBooleanOrDefault("enableMediaCaptionsIOS",!0):l.Settings.readBooleanOrDefault("enableMediaCaptionsTeams",!0))}isTooltipsEnabled(){return!!this.usePlaybackControls()&&l.Settings.readBooleanOrDefault("enablePlaybackControlTooltips",!1)}addCaptionTracks(e){if(!this.isCaptionsEnabled()||!e||!this.m_media)return;const t=e;if(!t||!this.m_media.tracksInfo||!this.m_media.tracksInfo.trackLst)return;let i=!1;for(const e of t.children)if("captions"===e.getAttribute("kind")){i=!0;break}if(i){if(!Fe.ChangeGate.isChangeGateEnabled("SVM.RebuildCaptionTracks"))return;if(0===e.textTracks.length||e.textTracks[0].cues&&e.textTracks[0].cues.length>0)return;for(let e=t.children.length-1;e>=0;e-=1)"captions"===t.children[e].getAttribute("kind")&&t.children[e].remove()}this.m_media.tracksInfo.trackLst.forEach((e,i)=>{const s=document.createElement("track"),o=e.lang&&""!==e.lang?e.lang:"unknown";s.setAttribute("mode","hidden"),s.setAttribute("kind","captions"),s.setAttribute("label",e.label),s.setAttribute("src",decodeURIComponent(e.src)),s.setAttribute("srclang",o),r.a.sendTraceTag(520652546,n.a.msoulscat_Wac_PptSession,a.a.Info,`MediaViewElement.addCaptionTracks: Adding caption track. Media name: ${this.m_media.name}, index: ${i}, language: ${o}`),t.appendChild(s)})}isSpeedEnabled(){return!!this.usePlaybackControls()&&he(this.m_environment)}isFullscreenEnabled(){return!this.shouldRenderToCanvas&&he(this.m_environment)&&this.usePlaybackControls()&&!pe.isBrowserSafari()}handlePartiallyOffSlideLocalVideo(e){let t=0,i=0,r=this.m_mediaPosition.x,n=this.m_mediaPosition.y;this.m_mediaPosition.x<0&&(t=this.m_mediaPosition.x,r=0),this.m_mediaPosition.y<0&&(i=this.m_mediaPosition.y,n=0),this.m_mediaPosition.x+this.m_mediaSize.x>this.m_slideSizePixels.x&&(t=this.m_mediaSize.x+this.m_mediaPosition.x-this.m_slideSizePixels.x,r=this.m_slideSizePixels.x-this.m_mediaSize.x),this.m_mediaPosition.y+this.m_mediaSize.y>this.m_slideSizePixels.y&&(i=this.m_mediaSize.y+this.m_mediaPosition.y-this.m_slideSizePixels.y,n=this.m_slideSizePixels.y-this.m_mediaSize.y);const a=e;a.style.objectFit="fill",a.style.objectPosition=`${t}px ${i}px`,e.style.left=r+"px",e.style.top=n+"px"}updateLocalMediaElement(){if(!this.m_localMediaInfo||!this.m_localMediaInfo.el)return;let e=document.getElementById(this.ShapeMediaTargetId);if(!e){const t=this.m_environment.settings.transparentCanvasForVideoEnabled&&this.isUnderlayElements()?"0":"2",i=o.a.ensureShapeViewElementParentDiv(this.id,t,this.m_media&&this.m_media.playAcrossSlides>0),d=s.b.SlideLevelHtmlElementsParentDivId;if(!i)return void r.a.sendTraceTag(594909146,n.a.msoulscat_Wac_PptSession,a.a.Error,`MediaViewElement::updateLocalMediaElement: couldn't find ${d}.`);if(e=l.Settings.readBooleanOrDefault("forceSvg",!1)?this.m_localMediaInfo.el:i.appendChild(this.m_localMediaInfo.el),l.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.m_mediaType===p.a.Video){const t=this.getBounds(),r=this.createCustomPlayButton(i,t);if(this.m_playButtonHandler=new He(r,this.m_isNotAllowedError),this.m_fHasCustomPlayButtonBeenSynced||(this.m_media.autoPlay||!1===this.m_environment.settings.showCustomPlayButtonForVideo?this.setCustomPlayButtonHidden():this.setCustomPlayButtonVisible(),e.controls=!1),l.Settings.readBooleanOrDefault("enableVideoRetryButton",!1)){const e=this.createRetryButton(i,t);this.m_retryButtonHandler=new $e(e)}}if(!this.usePlaybackControls()||this.isLoopingBackgroundVideo(this.m_localMediaInfo)&&!l.Settings.readBooleanOrDefault("enableLoopingVideoControls",!0))this.shouldRenderToCanvas&&this.ensureVideoEventsDiv(i);else{const e=this.ensureVideoEventsDiv(i);e&&this.m_controls&&this.m_controls.setParent(e)}}if(this.m_mediaType===p.a.Video){const t=e;t.setAttribute("aria-label",this.m_media.ariaLabel||nt.getLocalizedString().videoStr),this.isVideoPartiallyOffSlide()&&!l.Settings.readBooleanOrDefault("forceSvg",!1)?(this.handlePartiallyOffSlideLocalVideo(e),r.a.sendTraceTag(557074123,n.a.msoulscat_Wac_PptSession,a.a.Info,"Local media is partially off slide.")):(this.isFullscreenEnabled()&&this.m_controls&&this.m_controls.isFullScreen()?t.style.objectFit="contain":t.style.objectFit="fill",l.Settings.readBooleanOrDefault("forceSvg",!1)||(e.style.left=this.m_mediaPosition.x+"px",e.style.top=this.m_mediaPosition.y+"px"))}else l.Settings.readBooleanOrDefault("forceSvg",!1)||(e.style.top=this.m_mediaPosition.y+"px",e.style.left=this.m_mediaPosition.x+"px");if(this.m_mediaType===p.a.Audio){const t=Math.max(this.m_mediaSize.x,nt.MIN_AUDIO_PLAYBACK_BAR_WIDTH),i=Math.max(this.m_mediaSize.y,nt.MIN_AUDIO_PLAYBACK_BAR_HEIGHT);if(e.style.width=t+"px",e.style.height=i+"px",this.m_mediaPosition.x<0)e.style.left="0px";else if(this.m_mediaPosition.x+t>this.m_slideSizePixels.x){const i=this.m_mediaPosition.x+t-this.m_slideSizePixels.x;this.m_mediaPosition.x-i>=0&&(e.style.left=this.m_mediaPosition.x-i+"px",e.style.width=t-1+"px")}if(this.m_mediaPosition.y<0)e.style.top="0px";else if(this.m_mediaPosition.y+i>this.m_slideSizePixels.y){const t=this.m_mediaPosition.y+i-this.m_slideSizePixels.y;this.m_mediaPosition.y-t>=0&&(e.style.top=this.m_mediaPosition.y-t+"px")}}}ensureVideoEventsDiv(e){let t=document.querySelector("#video-events-"+this.m_media.name);return t||(t=this.createEventHandlerDiv(),l.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&(t.style.pointerEvents="auto"),t.setAttribute("lang",s.b.appLanguage),e.appendChild(t)),this.m_localMediaEventsDiv=t,t}getBounds(){if(this.m_shapeItem){const e=this.m_shapeItem.getBounds(!1,!1,!1);if(e)return new h.c(e.left,e.top,e.right,e.bottom);if(this.m_mediaType===p.a.Video&&this.m_localMediaInfo&&this.m_localMediaInfo.el){const e=this.m_localMediaInfo.el;if(e)return new h.c(this.m_mediaPosition.x,this.m_mediaPosition.y,this.m_mediaPosition.x+e.width,this.m_mediaPosition.y+e.height)}}return r.a.sendTraceTag(541184912,n.a.msoulscat_Wac_PptSession,a.a.Warning,"MediaViewElement::getBounds: Not able to get bounds from shapebuilder."),ve("IncorrectPosition"),new h.c(this.m_mediaPosition.x,this.m_mediaPosition.y,this.m_mediaSize.x,this.m_mediaSize.y)}createEventHandlerDiv(){const e=document.createElement("div");e.id="video-events-"+this.m_media.name,e.style.position="absolute",l.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.isCustomPlayButtonVisible()?e.tabIndex=-1:e.tabIndex=0,e.setAttribute("aria-label",this.m_media.ariaLabel||nt.getLocalizedString().videoStr),e.setAttribute("role","undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.SlideShowAccessibilityLabelGroup:"group");const t=this.getAdjustedBounds();return e.style.left=t.left+"px",e.style.top=t.top+"px",e.style.width=t.width+"px",e.style.height=t.height+"px",l.Settings.readBooleanOrDefault("resizeMediaOnSlideScaling",!1)&&(this.setSizeAndScale(e,new p.b(t.width,t.height)),this.addListenersForMediaFocus(e)),e.addEventListener("mouseenter",()=>{this.m_controls&&!this.isCustomPlayButtonVisible()&&this.m_controls.show()}),e.addEventListener("mouseleave",()=>{this.m_controls&&this.m_controls.hide()}),e.addEventListener("focusin",()=>{if(!l.Settings.readBooleanOrDefault("resizeMediaOnSlideScaling",!1)){const t=this.getBounds(),i=l.Settings.readNumberOrDefault("mediaFocusIndicatorWidth",4);e.style.top=t.top-i+"px",e.style.left=t.left-i+"px",this.addFocusBorder(e)}this.m_controls&&!this.isCustomPlayButtonVisible()&&this.m_controls.show()}),e.addEventListener("focusout",()=>{if(!l.Settings.readBooleanOrDefault("resizeMediaOnSlideScaling",!1)){const t=this.getBounds();e.style.top=t.top+"px",e.style.left=t.left+"px",this.removeFocusBorder(e)}this.m_controls&&this.m_controls.hide()}),Fe.ChangeGate.isChangeGateEnabled("SVM.PlayPauseVideoWithMouseClick")&&e.addEventListener("click",()=>{this.usePlaybackControls()&&this.m_localMediaInfo&&!this.isLoopingBackgroundVideo(this.m_localMediaInfo)&&(this.sendUserMediaActionEvent(7),this.togglePauseMedia())}),e.addEventListener("keydown",e=>{"Enter"===e.key||" "===e.key?l.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.isCustomPlayButtonVisible()?(e.stopImmediatePropagation(),this.customPlayButtonAction(!0)):this.usePlaybackControls()&&this.m_localMediaInfo&&!this.isLoopingBackgroundVideo(this.m_localMediaInfo)&&(e.stopImmediatePropagation(),this.sendUserMediaActionEvent(7),this.togglePauseMedia()):"ArrowLeft"===e.key||"ArrowRight"===e.key?!this.m_controls||!this.isNestedTabbingEnabled()||l.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.isCustomPlayButtonVisible()||this.m_controls.onKeyDown(e):"j"!==e.key&&""!==e.key||!e.altKey||!this.m_controls||l.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.isCustomPlayButtonVisible()||this.m_controls.toggleCaptionsMenu("Keyboard")}),e}isRetryUxEnabledForMedia(){return!(!l.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)||!l.Settings.readBooleanOrDefault("enableVideoRetryButton",!1)||this.m_mediaType!==p.a.Video||this.m_media.autoPlay&&(-1===this.m_media.repeat||this.m_media.repeat>1)&&0===this.m_media.volume)}getTotalRetryCount(){let e=l.Settings.readNumberOrDefault("mediaRetryCount",nt.BD_HTML5_MEDIA_RETRY_COUNT);return e>5&&this.isRetryUxEnabledForMedia()&&(e-=3),this.m_localMediaPlaybackSource||this.m_useTranscodedVideos&&(e+=l.Settings.readNumberOrDefault("transcodingRetryCount",nt.BD_HTML5_TRANSCODED_MEDIA_RETRY_COUNT)),e}generateMediaSrcUrl(e,t){try{const i=new URL(e);return i.searchParams.set("usid",this.m_environment.settings.sessionId),i.searchParams.set("retries",t.toString()),i.searchParams.set("requestGuid",this.m_requestGuid),i.hostname=i.hostname.toLowerCase().replace(".pods.",".media."),this.m_useTranscodedVideos&&(-1===e.indexOf("disableTranscode")?this.generateTranscodedMediaSrcUrl(t,i):r.a.sendTraceTag(520153308,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement::generateMediaSrcUrl disable transcoding for mediaName: "+this.m_media.name)),r.a.sendTraceTag(538489932,n.a.msoulscat_Wac_PptSession,a.a.Info,"Media URL includes media domain: "+i.hostname.includes(".media.")),i.toString()}catch(e){r.a.sendTraceTag(570716894,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement::generateMediaSrcUrl Invalid URL "+e)}return-1===e.indexOf("?")?`${e}?retries=${t}`:`${e}&retries=${t}`}generateTranscodedMediaSrcUrl(e,t){let i=!1;const s=nt.getMediaLengthFromMediaUrl(t);void 0!==s&&(i=s<l.Settings.readNumberOrDefault("minVideoSizeToTranscodeForDesktopBytes",1e7)&&!me(this.m_environment));const o=!this.isPlayable(),d=!Fe.ChangeGate.isChangeGateEnabled("SVM.TryTranscodingOnce")||!this.m_wasTranscodingRequested,h=!l.Settings.readBooleanOrDefault("noMP4Transcoding",!1)||!this.isMP4(),c=!l.Settings.readBooleanOrDefault("onlyTranscodeUnplayableVideos",!1)||o,u=e>=this.m_initialRetryCount-l.Settings.readNumberOrDefault("transcodingRetryCount",nt.BD_HTML5_TRANSCODED_MEDIA_RETRY_COUNT),f=!Fe.ChangeGate.isChangeGateEnabled("SVM.DisableTranscodedVideosPrefetch")&&!this.m_fOnSlide;this.m_isTranscoded=o||d&&h&&c&&!i&&(u||f),this.m_wasTranscodingRequested=this.m_wasTranscodingRequested||this.m_isTranscoded,this.updatePixelScale();const m=this.m_environment.rendererEnvironment.isCanvasSizeSet||!Fe.ChangeGate.isChangeGateEnabled("SVM.CheckIfCanvasIsSet")?this.m_pixelScale:new p.b(1,1);let g=this.m_isTranscoded?$.Low:$.Raw;!l.Settings.readBooleanOrDefault("onlyLowTranscoding",!1)&&this.m_isTranscoded&&(g=pe.getTranscodeMediaQuality(nt.getNetworkBandwidthInMbps(),this.m_mediaSize,m,this.m_environment)),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setMediaQuality(g),t.searchParams.set("transcode",$[g]),r.a.sendTraceTag(526956306,n.a.msoulscat_Wac_PptSession,a.a.Info,""+JSON.stringify({requestTranscodedMedia:this.m_isTranscoded,retryCount:e,selMediaQuality:$[g],onSlide:this.m_fOnSlide}))}static getNetworkBandwidthInMbps(){const e=null!=window.navigator?window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection:null;let t=void 0;return e?t=e.downlink:r.a.sendTraceTag(527217103,n.a.msoulscat_Wac_PptSession,a.a.Warning,`MediaViewElement::getNetworkBandwidthInMbps: Could not find network connection as connection is ${e} `),t}onMediaError(e){e.el&&e.props&&(this.m_wasLoadStarted||this.m_hlsError)&&(e.el.error&&r.a.sendTraceTag(593356508,n.a.msoulscat_Wac_PptSession,a.a.Warning,`MediaViewElement::onMediaError {errorCode: ${e.el.error.code}, errorMessage: ${e.el.error.message}}`),e.retriesRemaining>0?window.setTimeout(()=>{this.retryMediaDownload(e)},Fe.ChangeGate.isChangeGateEnabled("SVM.NoWaitHLSRetry")&&this.m_hlsError&&this.m_hlsErrorCount<=this.getHLSRetryCount()?1:e.retryTimeoutMs):(r.a.sendTraceTag(520161372,n.a.msoulscat_Wac_PptSession,a.a.Error,`MediaViewElement::onMediaError No retries left mediaName: ${this.m_media.name}.`),this.isRetryUxEnabledForMedia()&&(this.setCustomPlayButtonHidden(),this.setRetryButtonVisible())))}onEnded(e){e.el&&e.props&&(this.sendMediaSyncEvent(6),-1===e.numRepeatsRemaining||e.numRepeatsRemaining>1?(this.resetCurrentTime(e),e.numRepeatsRemaining>1&&(e.numRepeatsRemaining-=1),this.playHelper(e)):(e.fReachedEnd=!0,this.stopVideoFrameTracker("onEnded"),this.pauseHelper(e),e.numRepeatsRemaining=e.numRepeatsOriginal))}onLoadedData(e){if(r.a.sendTraceTag(544317722,n.a.msoulscat_Wac_PptSession,a.a.Info,`MediaViewElement::onLoadedData: Media name: ${e.props.name}, content type: ${e.props.contentType}`),l.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.m_mediaType===p.a.Video){if(!e.el)return;if(this.usePlaybackControls())return;l.Settings.readBooleanOrDefault("enableRoleBasedVideoPlayUX",!1)&&this.m_media.autoPlay&&this.m_environment.settings.showCustomPlayButtonForVideo&&!this.isLoopingBackgroundVideo(e)?e.el.controls=!0:!this.m_media.autoPlay&&!1!==this.m_environment.settings.showCustomPlayButtonForVideo||this.isLoopingBackgroundVideo(e)||(e.el.controls=!0)}}onLoadedMetaData(e){r.a.sendTraceTag(544317723,n.a.msoulscat_Wac_PptSession,a.a.Info,`MediaViewElement::onLoadedMetaData: Media name: ${e.props.name}, content type: ${e.props.contentType}`);const t=e.el;if(!t)return;const i=this.isLoopingBackgroundVideo(e);if((this.m_environment.settings.transparentCanvasForVideoEnabled||l.Settings.readBooleanOrDefault("forceSvg",!1))&&i)t.style.pointerEvents="none",t.controls=!1;else{if(t.style.pointerEvents="auto",this.usePlaybackControls())return;l.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.m_mediaType!==p.a.Audio&&(i||!this.m_media.autoPlay||l.Settings.readBooleanOrDefault("enableRoleBasedVideoPlayUX",!1)&&!this.m_environment.settings.showCustomPlayButtonForVideo)||(t.controls=!0)}}retryMediaDownload(e){if(!e.el)return;if(!e.props)return;if(!e.el.src&&!this.m_hlsError)return;this.m_hls&&(this.m_hls.destroy(),this.m_hls=void 0),r.a.sendTraceTag(593356510,n.a.msoulscat_Wac_PptSession,a.a.Warning,`MediaViewElement::retryMediaDownload: retrying media with id= ${e.elID}, retriesRemaining=${e.retriesRemaining}`),e.retriesRemaining-=1,this.setSourceAsync(e.el,e);const t=l.Settings.readNumberOrDefault("mediaRetryMultiplier",nt.BD_HTML5_MEDIA_RETRY_MULTIPLIER);e.retryTimeoutMs*=t}onTimeUpdate(e){if(!e.el)return;if(!e.props)return;const t=e.el.duration-e.props.trimEndMs/1e3;e.el.currentTime>=t&&!e.fReachedEnd&&this.onEnded(e)}onPlay(e){if(!e.el)return;if(!e.props)return;if(l.Settings.readBooleanOrDefault("enableCustomPlayButton",!1)&&this.m_mediaType===p.a.Video){if(this.setCustomPlayButtonHidden(),Fe.ChangeGate.isChangeGateEnabled("SVM.SingleTabForMedia"))if(l.Settings.readBooleanOrDefault("resizeMediaOnSlideScaling",!1))this.m_localMediaEventsDiv&&(this.m_localMediaEventsDiv.tabIndex=0);else{const e=document.querySelector("#video-events-"+this.m_media.name);e&&(e.tabIndex=0)}this.usePlaybackControls()||this.m_media.autoPlay||e.fLooping||(e.el.controls=!0)}const t=e.el.duration-e.props.trimEndMs/1e3,i=e.props.trimStartMs/1e3;e.el.currentTime<i&&this.resetCurrentTime(e),e.el.currentTime>=t&&e.fReachedEnd&&this.resetCurrentTime(e),e.fReachedEnd=!1,this.sendMediaSyncEvent(1)}onPlaying(){this.m_frameTracker&&!this.m_frameTracker.isActive&&(r.a.sendTraceTag(512234245,n.a.msoulscat_Wac_PptSession,a.a.Info,"Starting VideoFrameTracker for media "+this.m_media.name),this.m_frameTracker.start())}setAccessibleNameForLocalMedia(e){if(Fe.ChangeGate.isChangeGateEnabled("SVM.UpdateVideoNameWithPlayPauseState")&&this.m_localMediaInfo&&this.m_localMediaInfo.el){let t=(this.m_media.ariaLabel||nt.getLocalizedString().videoStr)+" ";if(t+="undefined"!=typeof PowerpointSlideshowStrings?e?PowerpointSlideshowStrings.CustomControlsAccessibilityLabelPlayButton:PowerpointSlideshowStrings.CustomControlsAccessibilityLabelPauseButton:e?"Video Play":"Video Pause",this.m_localMediaInfo.el.setAttribute("aria-label",t),l.Settings.readBooleanOrDefault("resizeMediaOnSlideScaling",!1))this.m_localMediaEventsDiv&&this.m_localMediaEventsDiv.setAttribute("aria-label",t);else{const e=document.querySelector("#video-events-"+this.m_media.name);e&&e.setAttribute("aria-label",t)}}}playHelper(e){return e.el?(this.setAccessibleNameForLocalMedia(!0),this.m_localMediaPlaybackController?(this.m_localMediaPlaybackController.playOrPause(!0),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setPlayRequestTime(),this.m_localMediaPlayer&&this.m_localMediaPlayer.setPlayRequestTime(),Promise.resolve(void 0)):(r.a.sendTraceTag(537773278,n.a.msoulscat_Wac_PptSession,a.a.Info,`Calling play() media: ${this.m_media.name} Ready state:${e.el.readyState}.`),this.verifyPlatfromSpecificReadyState(e)||r.a.sendTraceTag(537773279,n.a.msoulscat_Wac_PptSession,a.a.Error,`Player haven't reached to ready state and started playing media: ${this.m_media.name}.`),e.el.play())):(r.a.sendTraceTag(537773277,n.a.msoulscat_Wac_PptSession,a.a.Error,"mediaInfo is null/undefined"),Promise.resolve(void 0))}pauseHelper(e){e.el?(this.setAccessibleNameForLocalMedia(!1),this.m_localMediaPlaybackController?this.m_localMediaPlaybackController.playOrPause(!1):(r.a.sendTraceTag(537773281,n.a.msoulscat_Wac_PptSession,a.a.Info,`Calling pause() media: ${this.m_media.name} Ready state:${e.el.readyState}.`),e.el.pause())):r.a.sendTraceTag(537773280,n.a.msoulscat_Wac_PptSession,a.a.Error,"mediaInfo is null/undefined")}verifyPlatfromSpecificReadyState(e){if(!e.el)return r.a.sendTraceTag(537773282,n.a.msoulscat_Wac_PptSession,a.a.Error,"mediaInfo is null/undefined"),!1;const t=this.useLoadedMetadataAsInteractivityEvent();return e.el.readyState>=(t?HTMLMediaElement.HAVE_METADATA:HTMLMediaElement.HAVE_FUTURE_DATA)}useLoadedMetadataAsInteractivityEvent(){return fe(this.m_environment)&&l.Settings.readBooleanOrDefault("useLoadedMetadataAsInteractivityEvent",!0)}onPause(e){if(e.el){const t=e.el.duration-(e.props?e.props.trimEndMs/1e3:0);if(e.el.currentTime>=t)return;this.stopVideoFrameTracker("onPause"),this.sendMediaSyncEvent(0),r.a.sendTraceTag(509366741,n.a.msoulscat_Wac_PptSession,a.a.Info,`MediaViewElement::onPause - currentTime: ${e.el.currentTime} (seconds), media: ${this.m_media.name}, isNarration: ${this.m_media.narration}`)}}stopVideoFrameTracker(e){if(this.m_frameTracker&&this.m_frameTracker.isActive){let t={};if(this.m_shapeItem instanceof u.e){const i=this.m_shapeItem;t={renderToCanvas:this.shouldRenderToCanvas,cropped:this.isVideoCropped(i),croppedToShape:nt.isVideoCroppedToShape(i),rotated:nt.isVideoRotated(i),effects:i.effects.hasEffects,outline:void 0!==i.style.lineBrush,trackingStopped:e}}this.m_frameTracker.stop(t)}}onSeeked(e){e.el&&(e.el.currentTime<e.el.duration&&(e.fReachedEnd=!1),this.shouldRenderToCanvas&&e.el.paused&&(this.m_hasPendingRender=!0),this.sendMediaSyncEvent(3))}onVolumeChange(e){e.el&&this.sendMediaSyncEvent(4)}static ignoreClick(e){e||(e=window.event),e&&(e.cancelBubble=!0),e&&e.stopPropagation&&e.stopPropagation()}static showMediaElement(e,t){e&&(e.style.opacity=t?"1":"0")}getPlayButtonTooltip(){return void 0===this.isPresenter()?"undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.CustomControlsTooltipLabelPlay:"Play":this.isPresenter()?"undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.CustomControlsTooltipLabelPlayPresenter:"Play for everyone":"undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.CustomControlsTooltipLabelPlayAttendee:"Play for me only"}initLinkedMediaInfo(){const e=this.m_shapeViewData.media;if(!e||document.getElementById("media-element-"+JSON.stringify(this.id)))return;if(!this.isMediaPlayable(e.contentType))return;const t=pe.getMediaRenderAs(e.contentType);if(t!==H.FlashObject)return void(this.m_transparentShapeItem=void 0);let i;try{i=new URL(e.src)}catch{return void r.a.sendTraceTag(512263779,n.a.msoulscat_Wac_PptSession,a.a.Error,"Media src URL is invalid")}this.isFullScreenByDefault()&&(i.searchParams.set("playsinline","true"),r.a.sendTraceTag(512263778,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement::initLinkedMediaInfo: Set playsinline flag to true"));const s=document.createElement("div");if(s.id="LinkedMedia-Container",s.style.visibility="visible",s.style.position="absolute",s.style.pointerEvents="auto",s.style.left=this.m_mediaPosition.x+"px",s.style.top=this.m_mediaPosition.y+"px",l.Settings.readBooleanOrDefault("resizeMediaOnSlideScaling",!1)){const e=this.getAdjustedBounds();this.setSizeAndScale(s,new p.b(e.width,e.height))}else s.style.width=this.m_mediaSize.x+"px",s.style.height=this.m_mediaSize.y+"px";if(s.tabIndex=0,this.addListenersForMediaFocus(s),this.m_environment.settings.transparentCanvasForVideoEnabled||l.Settings.readBooleanOrDefault("forceSvg",!1)||(s.style.zIndex="3"),t===H.FlashObject){const e=this.isVideoPartiallyOffSlide(),t={mediaPosition:this.m_mediaPosition,mediaSize:this.m_mediaSize,slideSize:this.m_slideSizePixels,fEnableCropping:e},o=(e,t,i,s)=>{r.a.sendTraceTag(508698823,n.a.msoulscat_Wac_PptSession,a.a.Error,"Online video sent veto: "+JSON.stringify({vetoName:e,errorName:t,details:i,correlationId:s,mediaType:p.a[this.m_mediaType],mediaName:this.m_media.name,uiHostType:q[oe(this.m_environment)],teamsCallId:this.m_environment.settings.teamsCallId})),g.VetoUtils.recordVeto(e,{qosVeto:e,errorName:t,errorDetails:i,mediaName:this.m_media.name,mediaType:p.a[this.m_mediaType]})};let d;le(this.m_environment)&&!this.m_media.autoPlay&&(d=this.getVideoPosterFrameUri(),void 0===d&&r.a.sendTraceTag(509094100,n.a.msoulscat_Wac_PptSession,a.a.Info,"Failed to find online video poster frame"));const h=e=>{r.a.sendTraceTag(508347999,n.a.msoulscat_Wac_PptSession,a.a.Error,"Online media sent veto: "+JSON.stringify({veto:e.vetoName,error:e.errorName,details:e.details,correlationId:e.correlationId,mediaType:p.a[this.m_mediaType],mediaName:this.m_media.name,uiHostType:q[oe(this.m_environment)],teamsCallId:this.m_environment.settings.teamsCallId}))};this.m_onlineVideoPlayer=new se(i.toString(),s,this.m_gfxVideoSettings,t,d,()=>this.onPlayerReadyCallBack(),e=>this.onlineVideoEventEmitter(e),e=>this.onlineVideoAuthEventEmitter(e),o,()=>this.m_fHasOnlineVideoPlayButtonBeenClicked=!0,h,this.m_media.name,this.getPlayButtonTooltip()),void 0!==this.m_onlineVideoPlaybackPerf||this.m_media.playAcrossSlides||(this.m_onlineVideoPlaybackPerf=new ze(this.m_media,this.m_mediaType,this.m_environment,this.m_slideId,this.m_pixelScale,this.m_mediaSize)),l.Settings.readBooleanOrDefault("enableNewOnlineTelemetry",!0)&&(this.m_onlineVideoPlaybackTelemetry=new rt(this.m_media,this.m_environment,this.m_slideId)),null!==this.m_onlineVideoPlayer&&(r.a.sendTraceTag(512263777,n.a.msoulscat_Wac_PptSession,a.a.Info,`Successful creation of OnlineVideoPlayer of type ${p.a[this.m_mediaType]}.`),l.Settings.readBooleanOrDefault("enableNewOnlineTelemetry",!0)&&this.m_onlineVideoPlayer.setUiHostType(q[oe(this.m_environment)]))}else r.a.sendTraceTag(512263776,n.a.msoulscat_Wac_PptSession,a.a.Info,`Unable to play media: unknown RenderAs type ignored: ${t}.`);this.isVideoPartiallyOffSlide()&&(this.handlePartiallyOffSlideLinkedMedia(s),r.a.sendTraceTag(512263775,n.a.msoulscat_Wac_PptSession,a.a.Info,`Linked media with type:${this.m_mediaType} is partially off slide.`)),this.m_linkedMediaEl=s}isFullScreenByDefault(){if(fe(this.m_environment))switch(this.m_mediaType){case p.a.Flip:case p.a.StreamClassic:case p.a.Ted:case p.a.Vimeo:case p.a.YouTube:case p.a.Stream2:return!0}return!1}setCustomPlayButtonHidden(){this.m_playButtonHandler&&!this.m_isNotAllowedError&&this.m_playButtonHandler.setPlayButtonHidden()}setCustomPlayButtonVisible(){this.m_playButtonHandler&&this.m_playButtonHandler.setPlayButtonVisible()}isCustomPlayButtonVisible(){return!!this.m_playButtonHandler&&this.m_playButtonHandler.isPlayButtonVisible()}customPlayButtonOnClick(e){e&&(e.stopImmediatePropagation(),e.preventDefault()),this.customPlayButtonAction(!0)}customPlayButtonAction(e){this.m_isNotAllowedError=!1,this.setCustomPlayButtonHidden(),e&&(this.playMedia(),this.m_fIsPlayerReady&&this.sendMediaSyncEvent(1,6),this.sendUserMediaActionEvent(6),this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setWhenClickedOn()),this.m_localMediaInfo&&this.m_localMediaInfo.el&&!this.m_media.autoPlay&&this.m_fIsPlayerReady&&!this.usePlaybackControls()&&(this.m_localMediaInfo.el.controls=!0)}createCustomPlayButton(e,t){const i=ee(this.getPlayButtonTooltip());return i.style.top=t.top+t.height/2-k.B/2+"px",i.style.left=t.left+t.width/2-k.B/2+"px",i.addEventListener("click",e=>this.customPlayButtonOnClick(e),!1),e.appendChild(i),i}setRetryButtonHidden(){this.m_retryButtonHandler&&(this.m_retryButtonHandler.setRetryButtonHidden(),r.a.sendTraceTag(526952099,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement::setRetryButtonHidden: Retry button hidden for media: "+this.m_media.name))}setRetryButtonVisible(){this.m_retryButtonHandler&&(this.m_retryButtonHandler.setRetryButtonVisible(),r.a.sendTraceTag(526952128,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement::setRetryButtonVisible: Retry button shown for media: "+this.m_media.name))}retryButtonOnClick(e){e&&(e.stopImmediatePropagation(),e.preventDefault()),this.setRetryButtonHidden(),this.m_localMediaPlaybackSource?this.isMediaPlayable(this.m_media.contentType)&&this.m_localMediaPlaybackSource.setSource():this.m_localMediaInfo&&this.retryMediaDownload(this.m_localMediaInfo)}createRetryButton(e,t){const i=function(){const e=qe("svg");e.style.height=k.B.toString()+"px",e.style.width=k.B.toString()+"px",e.setAttribute("viewBox","0 0 57 58"),e.style.position="absolute",e.style.zIndex="99",e.style.top=`calc(50% - ${(k.B/2).toString()}px)`,e.style.left=`calc(50% - ${(k.B/2).toString()}px)`,e.style.cursor="pointer",e.style.pointerEvents="all";const t=qe("path");t.setAttribute("d","M52.977 15.15C60.7919 28.6857 56.1542 45.9937 42.6185 53.8085C29.0828 61.6234 11.7748 56.9857 3.95999 43.45C-3.85483 29.9143 0.782832 12.6063 14.3185 4.79151C27.8542 -3.02332 45.1622 1.61434 52.977 15.15Z"),t.setAttribute("fill","#404040");const i=qe("path");return i.setAttribute("d","M40.2575 18.4817L41.7287 18.8673L39.7805 25.7953L32.7936 24.0261L33.2082 22.5516L37.6683 23.6987L37.4485 23.318C36.965 22.4806 36.3926 21.7395 35.7314 21.0949C35.0566 20.4467 34.3244 19.8995 33.5349 19.453C32.7366 19.0115 31.897 18.6786 31.0159 18.4541C30.1262 18.2346 29.2241 18.1239 28.3095 18.1217C27.3863 18.1246 26.4691 18.2481 25.558 18.4922C24.6333 18.7328 23.7418 19.1009 22.8834 19.5965C22.025 20.0921 21.2647 20.6776 20.6027 21.3531C19.9271 22.0252 19.3572 22.7602 18.8931 23.5583C18.429 24.3564 18.0739 25.193 17.8278 26.0683C17.5816 26.9435 17.4501 27.8372 17.4333 28.7492C17.4165 29.6612 17.5244 30.569 17.757 31.4724C17.976 32.3723 18.3272 33.241 18.8108 34.0785C19.2943 34.916 19.8734 35.6588 20.5482 36.3069C21.2094 36.9515 21.9391 37.4946 22.7374 37.9361C23.5356 38.3775 24.3753 38.7105 25.2563 38.935C26.1374 39.1594 27.0395 39.2702 27.9627 39.2673C28.8859 39.2644 29.8099 39.1427 30.7346 38.9021C31.6457 38.658 32.5305 38.2882 33.3889 37.7926C34.386 37.2169 35.2481 36.5274 35.9751 35.7242C36.7021 34.9209 37.2982 34.041 37.7633 33.0845L38.6497 34.6198C38.1196 35.5237 37.4787 36.3561 36.7273 37.1171C35.971 37.8696 35.1072 38.5262 34.1361 39.0868C33.1563 39.6525 32.1404 40.0755 31.0883 40.3558C30.0314 40.6277 28.979 40.7672 27.9311 40.7744C26.8832 40.7816 25.851 40.6557 24.8344 40.3967C23.8178 40.1377 22.8575 39.756 21.9535 39.2515C21.0495 38.747 20.2178 38.1275 19.4584 37.3929C18.6854 36.6548 18.023 35.8079 17.4711 34.852C16.9192 33.8961 16.5194 32.9031 16.2716 31.8732C16.0102 30.8398 15.8871 29.8055 15.9022 28.7704C15.9173 27.7353 16.0668 26.7127 16.3508 25.7028C16.6348 24.6929 17.0419 23.736 17.5721 22.8321C18.1023 21.9282 18.7518 21.0908 19.5206 20.3199C20.2845 19.5405 21.1563 18.8679 22.1361 18.3022C23.1159 17.7365 24.1343 17.3178 25.1912 17.0459C26.2346 16.7706 27.2803 16.6294 28.3281 16.6221C29.376 16.6149 30.4083 16.7408 31.4249 16.9998C32.4415 17.2588 33.4018 17.6406 34.3058 18.1451C35.2098 18.6495 36.0482 19.2708 36.8212 20.0089C37.5806 20.7434 38.2362 21.5887 38.7881 22.5446L39.0079 22.9253L40.2575 18.4817Z"),i.setAttribute("fill","white"),i.setAttribute("opacity",".5"),e.appendChild(t),e.appendChild(i),e}();return i.style.top=t.top+t.height/2-k.B/2+"px",i.style.left=t.left+t.width/2-k.B/2+"px",i.style.display="none",i.addEventListener("click",e=>this.retryButtonOnClick(e),!1),e.appendChild(i),i}onPlayerReadyCallBack(){if(!this.m_fIsPlayerReady){if(this.m_fIsPlayerReady=!0,this.m_fSuppressMediaSyncEvents=!1,this.isSupportedMediaPlayer()&&!this.m_fHasMediaBeenSynced){if(this.m_localMediaInfo&&this.m_localMediaInfo.el&&this.m_mediaType===p.a.Video){const e=this.m_localMediaInfo.el;let t;!this.usePlaybackControls()||this.isLoopingBackgroundVideo(this.m_localMediaInfo)&&!l.Settings.readBooleanOrDefault("enableLoopingVideoControls",!0)?this.shouldRenderToCanvas&&e.parentElement&&this.ensureVideoEventsDiv(e.parentElement):(this.initPlaybackControls(e),t=e.parentElement?this.ensureVideoEventsDiv(e.parentElement):void 0,t&&this.m_controls&&this.m_controls.setParent(t))}this.emitMediaInitState()}this.m_fHasMediaBeenSynced&&this.m_onlineVideoPlaybackPerf&&this.m_onlineVideoPlaybackPerf.setMediaSyncedOnReady(),this.m_fHasMediaBeenSynced&&this.m_onlineVideoPlaybackTelemetry&&this.m_onlineVideoPlaybackTelemetry.setMediaSyncedOnReady(),!this.m_onlineVideoPlayer||this.m_mediaType!==p.a.YouTube&&this.m_mediaType!==p.a.Vimeo||this.m_fHasMediaBeenSynced||(r.a.sendTraceTag(520135564,n.a.msoulscat_Wac_PptSession,a.a.Info,`Setting ${p.a[this.m_mediaType]} video to be unmuted by default: ${this.m_media.name}`),this.m_onlineVideoPlayer.setUnMute()),this.m_localMediaInfo&&!this.m_fHasMediaBeenSynced&&(r.a.sendTraceTag(528601347,n.a.msoulscat_Wac_PptSession,a.a.Info,`Seeking media ${this.m_media.name} to start at initial position ${this.m_localMediaInfo.props.trimStartMs/1e3}s`),this.resetCurrentTime(this.m_localMediaInfo)),l.Settings.readBooleanOrDefault("enableGlobalMute",!1)&&this.m_environment.isGlobalMute&&(r.a.sendTraceTag(520984198,n.a.msoulscat_Wac_PptSession,a.a.Info,"Setting global mute on media: "+this.m_media.name),this.m_localMediaInfo&&this.m_localMediaInfo.el?this.m_localMediaInfo.el.muted=!0:this.m_onlineVideoPlayer&&this.m_onlineVideoPlayer.setMute())}}isSupportedMediaPlayer(){return this.m_mediaType!==p.a.Other}emitMediaInitState(){const e={mediaName:this.m_media.name,slideId:this.m_slideId};let t;if(this.m_localMediaInfo&&this.m_localMediaInfo.el){if(this.isLoopingBackgroundVideo(this.m_localMediaInfo))return;t={playerState:!this.m_localMediaInfo.el.paused||this.m_media.autoPlay?1:0,volume:this.m_localMediaInfo.el.volume,muted:this.m_localMediaInfo.el.muted,position:this.m_localMediaInfo.props.trimStartMs/1e3,mediaName:this.m_media.name,playerPositionSkew:-1}}else if(this.m_onlineVideoPlayer){let e=this.m_onlineVideoPlayer.isMuted();this.m_mediaType!==p.a.YouTube&&this.m_mediaType!==p.a.Vimeo||(e=!1),t={playerState:!this.m_onlineVideoPlayer.isPaused()||this.m_media.autoPlay?1:0,volume:this.m_onlineVideoPlayer.getVolume(),muted:e,position:this.m_onlineVideoPlayer.getCurrentTime(),mediaName:this.m_media.name,playerPositionSkew:-1}}if(t){const i={mediaName:this.m_media.name,state:t,origin:{isInitial:!0,hostName:p.a[this.m_mediaType]},correlationId:Object(je.v4)()};nt.logMediaSyncEmission(i,!0),this.m_slideEvents.emit("mediaInitState",{mediaSlideInfo:e,mediaSyncInitState:i})}}onlineVideoEventEmitter(e){6===e?this.m_fLinkedMediaReachedEnd=!0:4!==e&&(this.m_fLinkedMediaReachedEnd=!1),this.sendMediaSyncEvent(e)}onlineVideoAuthEventEmitter(e){ge.setNewStreamPlayer(this.m_onlineVideoPlayer),r.a.sendTraceTag(509346826,n.a.msoulscat_Wac_PptSession,a.a.Info,`Emitting AADTokenRequest for media (name: ${this.m_media.name}, type: ${p.a[this.m_mediaType]})`),this.m_slideEvents.emit("aadTokenRequest",e)}static getEventName(e){switch(e){case 1:return"mediaPlayed";case 0:return"mediaPaused";case 3:return"mediaSeeked";case 4:return"mediaVolumeChanged";case 6:return"mediaEnded";default:return""}}shouldUseOnlineVideoPlayer(){return!!le(this.m_environment)||!!this.m_environment.settings.useOnlineVideoPlayer}createGfxVideoAppSettings(){const e=le(this.m_environment);return{App:e?"Teams":"PowerPoint",AppPlatform:e?"Previewer":"WAC",AppCorrelation:this.m_environment.settings.sessionId,HubbleVideoEndpoint:this.m_environment.settings.hubbleVideoEndpoint||l.Settings.readStringOrDefault("PPTLiveHubbleEndpoint","https://hubble.officeapps.live.com"),IsStream2Enabled:this.m_environment.settings.isStream2Enabled||l.Settings.readBooleanOrDefault("PPTLiveStream2Enabled",!0),AcceptLanguage:this.m_environment.settings.acceptLanguage,MaxAADTokenWaitingTime:l.Settings.readNumberOrDefault("MaxAADTokenWaitingTime",3e3),TokenCacheTimeout:l.Settings.readNumberOrDefault("tokenCacheTimeout",3e4),SlowPlayVetoThreshold:l.Settings.readNumberOrDefault("slowPlayVetoThreshold",1e4),NotYetPlayedVetoThreshold:l.Settings.readNumberOrDefault("notYetPlayedVetoThreshold",3e4),hostComponent:e?"SlideshowApp":"Unified",hostView:e?"PowerPointLive":"Present",LocalizedHubble400ErrorMessage:"undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.Hubble400Error:"400",LocalizedHubble404ErrorMessage:"undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.Hubble404Error:"404",LocalizedHubble500ErrorMessage:"undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.Hubble500Error:"500",LocalizedHubble403ErrorMessage:"undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.Hubble403Error:"403"}}ensureLinkedMediaElementDiv(){let e=document.getElementById(this.ShapeMediaTargetId);if(e)return e;e=document.createElement("div"),e.id=this.ShapeMediaTargetId;const t=this.m_environment.settings.transparentCanvasForVideoEnabled&&this.isUnderlayElements()?"0":"2";return o.a.ensureShapeViewElementParentDiv(this.id,t).appendChild(e),e}handlePartiallyOffSlideLinkedMedia(e){let t=0,i=0;const r=s.b.getElementFromCollectionByLocalName(e.children,"iframe");if(!r)return;this.m_mediaPosition.x<0&&(t=this.m_mediaPosition.x,e.style.left="0px",e.style.width=this.m_mediaSize.x+this.m_mediaPosition.x+"px"),this.m_mediaPosition.y<0&&(i=this.m_mediaPosition.y,e.style.top="0px",e.style.height=this.m_mediaSize.y+this.m_mediaPosition.y+"px"),this.m_mediaPosition.x+this.m_mediaSize.x>this.m_slideSizePixels.x&&(this.m_mediaPosition.x<=0?e.style.width=this.m_slideSizePixels.x+"px":e.style.width=this.m_slideSizePixels.x-this.m_mediaPosition.x+"px"),this.m_mediaPosition.y+this.m_mediaSize.y>this.m_slideSizePixels.y&&(this.m_mediaPosition.y<=0?e.style.height=this.m_slideSizePixels.y+"px":e.style.height=this.m_slideSizePixels.y-this.m_mediaPosition.y+"px"),e.style.overflow="hidden";const n=r;n.style.width=this.m_mediaSize.x+"px",n.style.height=this.m_mediaSize.y+"px",n.style.position="relative",n.style.left=t+"px",n.style.top=i+"px"}updateLinkedMediaElement(){if(!this.m_linkedMediaEl)return;const e=this.ensureLinkedMediaElementDiv();let t=s.b.getElementFromCollection(e.children,nt.LinkedMediaContainerName);t||(t=e.appendChild(this.m_linkedMediaEl));const i=t;if(i.style.left=this.m_mediaPosition.x+"px",i.style.top=this.m_mediaPosition.y+"px",l.Settings.readBooleanOrDefault("resizeMediaOnSlideScaling",!1)){const e=this.getAdjustedBounds();this.setSizeAndScale(i,new p.b(e.width,e.height))}else i.style.width=this.m_mediaSize.x+"px",i.style.height=this.m_mediaSize.y+"px";if(this.isVideoPartiallyOffSlide())this.handlePartiallyOffSlideLinkedMedia(i),r.a.sendTraceTag(557672065,n.a.msoulscat_Wac_PptSession,a.a.Info,`Linked media with type:${this.m_mediaType} is partially off slide.`);else{const e=s.b.getElementFromCollection(i.children,nt.LinkedMediaIFramename);if(!e)return;const t=e;t.style.width=this.m_mediaSize.x+"px",t.style.height=this.m_mediaSize.y+"px",t.setAttribute("aria-label",this.m_media.ariaLabel||nt.getLocalizedString().videoStr)}}addListenersForMediaFocus(e){const t=l.Settings.readNumberOrDefault("mediaFocusIndicatorWidth",4);e.onfocus=()=>{const i=e.getBoundingClientRect();e.style.width=i.width-2*t+"px",e.style.height=i.height-2*t+"px",this.addFocusBorder(e)},e.onblur=()=>{const t=this.getAdjustedBounds();this.setSizeAndScale(e,new p.b(t.width,t.height)),this.removeFocusBorder(e)}}addFocusBorder(e){const t=l.Settings.readNumberOrDefault("mediaFocusStyleOutlineWidth",2),i=l.Settings.readNumberOrDefault("mediaFocusStyleOutlineOffset",-4),r=l.Settings.readNumberOrDefault("mediaFocusStyleBorderWidth",4);this.addStyleToHTMLElement(e,{outline:`solid ${t}px white`,outlineOffset:i+"px",border:`solid ${r}px black`})}removeFocusBorder(e){this.addStyleToHTMLElement(e,{outlineWidth:"0px",borderWidth:"0px"})}getMediaSize(){const e=this.getBounds();return new p.b(e.width,e.height)}setSizeAndScale(e,t){const i=this.m_slideScale;this.addStyleToHTMLElement(e,{transform:`scale(${1/i}, ${1/i})`,transformOrigin:"top left",width:t.x*i+"px",height:t.y*i+"px"})}addStyleToHTMLElement(e,t){for(const i in t)e.style[i]=t[i]}static getMediaType(e){if(e.isLocal)return 0===e.contentType.toLowerCase().indexOf("audio/")?p.a.Audio:p.a.Video;const t=O(e.src);return"YouTube"===t?p.a.YouTube:"Vimeo"===t?p.a.Vimeo:"StreamClassic"===t?p.a.StreamClassic:"Flip"===t?p.a.Flip:"Ted"===t?p.a.Ted:"SlideShare"===t?p.a.SlideShare:p.a.Stream2}get shapeItem(){return this.m_shapeItem}enableVolumeSync(){return!fe(this.m_environment)&&l.Settings.readBooleanOrDefault("mediaVolumeSync",!1)}getMediaCurrentState(){if(this.m_fIsPlayerReady){if(this.m_localMediaInfo&&this.m_localMediaInfo.el){let e=this.m_localMediaInfo.fReachedEnd?6:void 0;return e||(e=this.m_localMediaInfo.el.paused?0:1),{mediaName:this.m_media.name,playerState:e,position:this.m_localMediaInfo.el.currentTime,volume:this.m_localMediaInfo.el.volume,muted:this.m_localMediaInfo.el.muted,playerPositionSkew:0}}if(this.m_onlineVideoPlayer){let e=this.m_fLinkedMediaReachedEnd?6:void 0;return e||(e=this.m_onlineVideoPlayer.isPaused()?0:1),{mediaName:this.m_media.name,playerState:e,position:this.m_onlineVideoPlayer.getCurrentTime(),volume:this.m_onlineVideoPlayer.getVolume(),muted:this.m_onlineVideoPlayer.isMuted(),playerPositionSkew:0}}}}shouldSyncMediaVolumeChanged(e){return e.origin.isFromLocalCache||e.origin.isFromRoleChange||e.origin.isFromStateServiceCache||4===e.origin.eventTrigger}shouldSyncMediaEnded(e){return e.origin.isFromLocalCache||e.origin.isFromRoleChange||e.origin.isFromStateServiceCache||6!==e.origin.eventTrigger}shouldSuppressMediaSyncEvent(e,t){return!((4!==e||!this.shouldSuppressVolumeChangedEvents())&&(!t||!this.isLoopingBackgroundVideo(t))&&(!this.m_mediaSyncLock||this.m_mediaSyncLock.shouldSendMediaUpdate())&&!this.m_fSuppressMediaSyncEvents)}shouldSuppressVolumeChangedEvents(){const e=l.Settings.readBooleanOrDefault("enableGlobalMute",!1);return r.a.sendTraceTag(520123267,n.a.msoulscat_Wac_PptSession,a.a.Info,"shouldSuppressVolumeChangedEvents: "+JSON.stringify({mediaName:this.m_media.name,globalMuteEnabled:e,isGlobalMute:this.m_environment.isGlobalMute,globallyUnmuting:this.m_fIsGloballyUnmuting})),!(!e||!this.m_environment.isGlobalMute&&!this.m_fIsGloballyUnmuting||(this.m_fIsGloballyUnmuting=!1,0))}updateGlobalMute(e){if(!l.Settings.readBooleanOrDefault("enableGlobalMute",!1))return;let t=!1;this.m_localMediaInfo&&this.m_localMediaInfo.el?(t=this.m_localMediaInfo.el.muted&&!e,this.m_localMediaInfo.el.muted=e):this.m_linkedMediaEl&&this.m_onlineVideoPlayer&&(t=!e&&this.m_fOnSlide&&!0===this.m_onlineVideoPlayer.isMuted(),e?this.m_onlineVideoPlayer.setMute():this.m_onlineVideoPlayer.setUnMute()),this.m_fIsGloballyUnmuting=t,r.a.sendTraceTag(520123266,n.a.msoulscat_Wac_PptSession,a.a.Info,`Updated global mute state for media ${this.m_media.name} (isGlobalMute: ${this.m_environment.isGlobalMute}, muted: ${e}, isGloballyUnmuting: ${this.m_fIsGloballyUnmuting})`)}resizeToScale(e){if(this.m_slideScale===e)return;let t;if(this.m_slideScale=e,this.m_localMediaEventsDiv&&(t=this.m_localMediaEventsDiv),this.m_linkedMediaEl&&(t=this.m_linkedMediaEl),t){const e=this.getAdjustedBounds();this.setSizeAndScale(t,new p.b(e.width,e.height))}}mutePlayingMedia(){if(!this.m_fMutingOtherMedia&&this.isPlaying())if(r.a.sendTraceTag(523347022,n.a.msoulscat_Wac_PptSession,a.a.Info,`MediaViewElement.mutePlayingMedia: Muting media name: ${this.m_media.name}}`),this.m_fMuteSyncDisabled=!0,this.m_localMediaInfo&&this.m_localMediaInfo.el)this.m_fPreviouslyMuted=this.m_localMediaInfo.el.muted,this.m_localMediaInfo.el.muted=!0;else if(this.m_onlineVideoPlayer){const e=this.m_onlineVideoPlayer.isMuted();void 0!==e&&(this.m_fPreviouslyMuted=e),this.m_onlineVideoPlayer.setMute()}}muteAllPlayingMediaiOS(){const e=this.m_localMediaPlaybackController&&this.m_localMediaPlaybackController.isSeeking();this.isMuteMultipleMediaiOSEnabled()&&fe(this.m_environment)&&!e&&(r.a.sendTraceTag(523347021,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement: Muting all playing media (iOS only)"),this.m_fMutingOtherMedia=!0,this.m_environment.muteAllPlayingMedia(),this.m_fMutingOtherMedia=!1)}restorePreviousMuteState(){this.m_fMuteSyncDisabled&&(r.a.sendTraceTag(521422149,n.a.msoulscat_Wac_PptSession,a.a.Info,`MediaViewElement.restorePreviousMuteState: Previously muted: ${this.m_fPreviouslyMuted}, media name: ${this.m_media.name}}`),this.m_fPreviouslyMuted?this.m_localMediaInfo&&this.m_localMediaInfo.el?this.m_localMediaInfo.el.muted=!0:this.m_onlineVideoPlayer&&this.m_onlineVideoPlayer.setMute():this.m_localMediaInfo&&this.m_localMediaInfo.el?this.m_localMediaInfo.el.muted=!1:this.m_onlineVideoPlayer&&this.m_onlineVideoPlayer.setUnMute(),this.m_fMuteSyncDisabled=!1)}isMuteMultipleMediaiOSEnabled(){return l.Settings.readBooleanOrDefault("enableMuteMultipleMediaiOS",!0)}static logMediaSyncEmission(e,t){r.a.sendTraceTag(527262535,n.a.msoulscat_Wac_PptSession,a.a.Info,`MediaViewElement: Emitting Media Sync ${t?"Initial State":"Event"}: ${JSON.stringify(e)}`)}updatePixelScale(){this.m_pixelScale=this.m_environment.rendererEnvironment.getPixelScale(this.m_slideSizePixels),this.m_localMediaPlaybackPerf&&(this.m_localMediaPlaybackPerf.pixelScale=this.m_pixelScale)}static getMediaLengthFromMediaUrl(e){let t;const i=e.searchParams.get("mediaLength");return null!==i&&(t=Number(i)),Number.isNaN(t)?void 0:t}setIsHlsForTelemetry(e){this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setHls(e),this.m_localMediaPlaybackController&&this.m_localMediaPlaybackController.setHls(e)}setHlsBandwidthEstimatesForTelemetry(e){this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.setHlsBandwidthEstimate(e),this.m_localMediaPlaybackController&&this.m_localMediaPlaybackController.setHlsBandwidthEstimate(e)}shouldSkipAnimation(e){if(!Fe.ChangeGate.isChangeGateEnabled("SVM.SkipAnimationIfPlayed")||!this.m_firstPlayAnimation||1!==e)return!1;const t=this.getMediaCurrentState(),i=t&&t.playerState&&(1===t.playerState||6===t.playerState),s=this.getMediaCurrentState(),o=s&&s.position?s.position:0;let d=!1;if(d=Fe.ChangeGate.isChangeGateEnabled("SVM.checkTrimStartTime")?Math.abs(o-this.m_media.trimStartMs/1e3)>.1:0!==o,!i&&!d)return!1;if(r.a.sendTraceTag(526989073,n.a.msoulscat_Wac_PptSession,a.a.Info,""+JSON.stringify({Description:"MediaViewElement.shouldSkipAnimation - Skipping play animation since the video has already played",playerPlayed:i,playerNotAtStart:d,position:o,trimStartMs:this.m_media.trimStartMs,playerState:t?t.playerState:"undefined"})),Fe.ChangeGate.isChangeGateEnabled("SVM.suppressMediaNextStep")&&!this.isPresenter())return r.a.sendTraceTag(509689889,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaViewElement.shouldSkipAnimation - Skipping mediaAnimation-nextStep since we're an attendee"),!0;this.m_firstPlayAnimation=!1;const h=l.Settings.readNumberOrDefault("mediaNextStepDelay",100);return window.setTimeout(()=>this.m_slideEvents.emit("mediaAnimation-nextStep"),h),!0}onLocalPlaybackQualityImpactError(e){const t=e;t.qosVeto=e.impactType,g.VetoUtils.recordVeto(t.qosVeto,t)}}nt.BD_HTML5_MEDIA_RETRY_COUNT=6,nt.BD_HTML5_TRANSCODED_MEDIA_RETRY_COUNT=1,nt.BD_HTML5_MEDIA_RETRY_INITIALDELAYMS=600,nt.BD_HTML5_MEDIA_RETRY_MULTIPLIER=2,nt.MIN_AUDIO_PLAYBACK_BAR_WIDTH=240,nt.MIN_AUDIO_PLAYBACK_BAR_HEIGHT=30,nt.LinkedMediaContainerName="LinkedMedia-Container",nt.LinkedMediaIFramename="LinkedMedia-IFrame";class at{constructor(e,t,i,s,o,l){if(this.shapeType=2,this.fPrepared=!1,this.animatableContentViewElements=[],this.m_fLoadedPoster=!1,this.m_fInSlideTransition=!1,this.m_videoRequestGuid=Object(je.v4)(),this.m_imageRequestGuid=Object(je.v4)(),this.id=e.id,this.m_slideId=this.id.slideId,this.m_emuToPixelScale=i,this.m_shapeViewData=t,this.m_environment=o,this.m_pixelScale=o.rendererEnvironment.clientSize.scale(window.devicePixelRatio).divide(l),!t.gif)throw r.a.sendTraceTag(592531609,n.a.msoulscat_Wac_PptSession,a.a.Error,`GifViewElement:: Invalid shapeViewData. gif:${!!t.gif},\n        animatableContents.length:${this.m_shapeViewData.animatableContents.length},\n        parts.length:${this.m_shapeViewData.animatableContents.length>0?this.m_shapeViewData.animatableContents[0].parts.length:0}.`),new Error("Invalid gif");const d=this.m_shapeViewData.animatableContents[0].parts[0].regionPos;this.m_gifInfo={elID:"gif-element-"+JSON.stringify(this.id),size:new p.b(d.region.rect.right-d.region.rect.left,d.region.rect.bottom-d.region.rect.top),position:new p.b(d.pos.x,d.pos.y),retriesRemaining:at.s_downloadMaxRetryCount,retryTimeoutMs:at.s_downloadInitialRetryDelayMs,mode:0,props:t.gif};let h=decodeURIComponent(o.settings.serverUrl);"/"===h.slice(-1)&&(h=h.slice(0,-1)),this.m_gifInfo.props.imageUrl&&(this.m_gifInfo.mode=0,this.m_gifInfo.props.imageUrl.includes("MediaDownloadHandler")||(this.m_gifInfo.props.imageUrl=`${h}${this.m_gifInfo.props.imageUrl.substring(1)}`)),this.m_gifInfo.props.videoUrl&&(this.m_gifInfo.mode=2,this.m_gifInfo.props.videoUrl.includes("MediaDownloadHandler")||(this.m_gifInfo.props.videoUrl=`${h}${this.m_gifInfo.props.videoUrl.substring(1)}`)),this.m_slideEvents=s,this.m_slideEvents.on("navigatingTo",()=>this.onNavigatingTo()),this.m_slideEvents.on("navigatingFrom",()=>this.onNavigatingFrom()),this.m_slideEvents.on("beforeFirstRenderAfterNavigation",()=>this.onBeforeFirstRenderAfterNavigation()),this.loadPoster(!1),r.a.sendTraceTag(578863264,n.a.msoulscat_Wac_PptSession,a.a.Info,"GifViewElement ctor: "+JSON.stringify(at.getGifInfoLog(this.m_gifInfo,"GifViewElement::ctor")))}ensure(){this.m_shapeItem||this.init();const e={};if(!this.m_shapeItem)return r.a.sendTraceTag(592531610,n.a.msoulscat_Wac_PptSession,a.a.Error,"GifViewElement::ensure: invalid shapeItem."),e.invalidShape=!0,e;const t=o.a.attachTextures(this.m_environment,this.m_shapeItem,this.m_shapeViewData);return{...e,...t}}init(){this.animatableContentViewElements=[],this.m_shapeItem=o.a.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment),this.m_gifInfo?0===this.m_gifInfo.mode?(this.initImageEl(this.m_gifInfo),this.m_gifInfo.imageEl.addEventListener("load",()=>this.onMediaLoaded())):(this.initVideoEl(this.m_gifInfo),this.m_gifInfo.videoEl.addEventListener("load",()=>this.onMediaLoaded())):r.a.sendTraceTag(578863265,n.a.msoulscat_Wac_PptSession,a.a.Error,"GifViewElement::init: invalid gifInfo.")}initImageEl(e){const t=document.createElement("img");t.id=e.elID,t.width=e.size.x,t.height=e.size.y,t.style.left=e.position.x+"px",t.style.top=e.position.y+"px",t.style.position="absolute",t.style.pointerEvents="none",t.style.zIndex="4",e.props.imageUrl?(t.addEventListener("error",()=>this.onImageError(e)),t.src=this.getRetryUrl(e.props.imageUrl,e.retriesRemaining,!1)):t.src=e.props.src,e.imageEl=t}initVideoEl(e){const t=document.createElement("video");t.id=e.elID,t.width=e.size.x,t.height=e.size.y,t.style.left=e.position.x+"px",t.style.top=e.position.y+"px",t.style.position="absolute",t.style.pointerEvents="none",t.style.zIndex="4",t.crossOrigin="anonymous",t.autoplay=!0,t.controls=!1,t.loop=!0,t.muted=!0,t.playsInline=!0,r.a.sendTraceTag(545645913,n.a.msoulscat_Wac_PptSession,a.a.Info,"GifViewElement::initVideoEl: Set playsInline flag to true"),e.props.videoUrl?(t.addEventListener("error",()=>this.onVideoError(e)),t.src=this.getRetryUrl(e.props.videoUrl,e.retriesRemaining,!0)):t.src=e.props.src,e.videoEl=t,this.initLocalMediaPlaybackPerf()}initLocalMediaPlaybackPerf(){if(!this.m_localMediaPlaybackPerf&&this.m_gifInfo&&this.m_gifInfo.videoEl)try{this.m_localMediaPlaybackPerf=new Ne(this.m_gifInfo.videoEl,this.m_pixelScale,this.m_slideEvents,oe(this.m_environment),null,null,this.m_environment.viewDataManager.getSlideIndex(this.m_slideId),this.m_environment.settings.startFromTime,this.m_environment.settings.initTime,this.m_gifInfo,at.s_downloadMaxRetryCount,!1,this.m_environment.settings.teamsCallId)}catch(e){r.a.sendTraceTag(526989327,n.a.msoulscat_Wac_PptSession,a.a.Error,"GifViewElement::initVideoEl Failed to construct LocalVideoPlaybackPerf "+e)}if(this.m_localMediaPlaybackPerf&&this.m_gifInfo&&this.m_gifInfo.videoEl)try{this.m_localMediaPlaybackPerf.onSourceSet(this.m_gifInfo.videoEl.src)}catch(e){r.a.sendTraceTag(526989328,n.a.msoulscat_Wac_PptSession,a.a.Error,"Exception in LocalVideoPlaybackSummary.onSourceSet: "+e)}}update(){if(!this.m_gifInfo)return;const e=this.m_gifInfo.mode;let t=!1;if(this.m_gifInfo.videoEl&&(1===e||2===e)){t=at.isVideoLoaded(this.m_gifInfo.videoEl);const i=at.ensureDOMElement(this.m_gifInfo.elID,this.m_gifInfo.videoEl,this.id,t);i&&t&&(i.style.left=this.m_gifInfo.position.x+"px",i.style.top=this.m_gifInfo.position.y+"px",i.width=this.m_gifInfo.size.x,i.height=this.m_gifInfo.size.y,i.hidden=2===e,i.paused&&i.play(),i.hidden?this.drawFrame(this.m_gifInfo.videoEl):this.m_fInSlideTransition||this.unloadPoster(),this.m_gifInfo.imageEl=void 0)}if(this.m_gifInfo.imageEl&&(0===e||!t)){t=at.isImageLoaded(this.m_gifInfo.imageEl);const e=at.ensureDOMElement(this.m_gifInfo.elID,this.m_gifInfo.imageEl,this.id,t);e&&t&&(e.style.left=this.m_gifInfo.position.x+"px",e.style.top=this.m_gifInfo.position.y+"px",e.width=this.m_gifInfo.size.x,e.height=this.m_gifInfo.size.y,this.m_fInSlideTransition||this.unloadPoster())}t||this.m_fLoadedPoster||this.loadPoster(!0),o.a.ensureAccessibilityElement(this.id)}loadPoster(e){this.m_posterImage&&this.m_posterImage.src?e&&at.isImageLoaded(this.m_posterImage)&&(this.drawFrame(this.m_posterImage),this.m_fLoadedPoster=!0):this.m_gifInfo&&this.m_gifInfo.props.src.startsWith("data")&&(this.m_posterImage=new Image,e&&(this.m_posterImage.onload=()=>{this.drawFrame(this.m_posterImage),this.m_fLoadedPoster=!0}),this.m_posterImage.src=this.m_gifInfo.props.src)}unloadPoster(){if(this.m_shapeItem)for(const e of this.m_shapeItem.getBrushImages())e.id&&(e.releaseGeneratedResources(),this.m_fLoadedPoster=!1)}drawFrame(e){const t=this.m_environment.rendererEnvironment.glContext;if(!t||t.isContextLost())return void r.a.sendTraceTag(590976991,n.a.msoulscat_Wac_PptSession,a.a.Error,"GifViewElement::drawFrame: missing glContext.");let i=this.m_gifTexture?this.m_gifTexture.tryGetWebGLTexture():void 0;if(!this.m_gifTexture||!i){this.m_gifTexture&&this.cleanUp();const e=new p.b(this.m_gifInfo.size.x,this.m_gifInfo.size.y);o.a.verifyTextureSize(this.m_environment,"gif",e);const t=new b.a("Gif",this.m_environment.rendererEnvironment.renderer,e,0);if(i=t.tryGetWebGLTexture(),this.m_environment.viewDataManager.memoryStats.gifTextures+=this.m_gifInfo.size.x*this.m_gifInfo.size.y*4,!i)return void r.a.sendTraceTag(590976993,n.a.msoulscat_Wac_PptSession,a.a.Error,"GifViewElement::drawFrame: failed to create gif target texture.");this.m_gifTexture=t}if(this.m_shapeItem){t.bindTexture(t.TEXTURE_2D,i),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.bindTexture(t.TEXTURE_2D,null);for(const e of this.m_shapeItem.getBrushImages())e.id&&(this.m_environment.rendererEnvironment.renderer.attachTextureToImage(e,this.m_gifTexture),this.m_gifTexture.changeTracker.notifyChange())}else r.a.sendTraceTag(590976994,n.a.msoulscat_Wac_PptSession,a.a.Error,"GifViewElement::drawFrame: ShapeItem:"+!!this.m_shapeItem)}applyAnimation(e){this.m_shapeItem&&o.a.applyAnimationToShapeItemAndClickTarget(e,this.m_shapeItem,this.m_shapeViewData)}addToScene(e){this.m_shapeItem&&e.items.push(this.m_shapeItem)}removeFromScene(e){this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)&&o.a.removeFromScene(e,this.m_shapeItem)}tryPrepare(){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,5),this.m_environment.rendererEnvironment.flush()),this.fPrepared}cleanUp(){const e=this.m_environment.rendererEnvironment.glContext;e&&!e.isContextLost()&&this.m_gifTexture&&(this.m_gifTexture.release(),this.m_environment.viewDataManager.memoryStats.gifTextures-=this.m_gifInfo.size.x*this.m_gifInfo.size.y*4),this.m_gifTexture=void 0}get shapeItem(){return this.m_shapeItem}onNavigatingTo(){this.m_localMediaPlaybackPerf&&this.m_localMediaPlaybackPerf.onNavigatingTo(),this.m_fInSlideTransition=!0,this.m_gifInfo&&(2===this.m_gifInfo.mode&&at.isVideoLoaded(this.m_gifInfo.videoEl)||this.loadPoster(!0),at.isVideoLoaded(this.m_gifInfo.videoEl)&&(this.m_gifInfo.videoEl.currentTime=0))}onNavigatingFrom(){this.m_fInSlideTransition=!0,this.m_gifInfo&&(2===this.m_gifInfo.mode&&at.isVideoLoaded(this.m_gifInfo.videoEl)||this.loadPoster(!0))}onBeforeFirstRenderAfterNavigation(){this.m_fInSlideTransition=!1}onMediaLoaded(){this.m_gifInfo&&(2!==this.m_gifInfo.mode&&this.update(),r.a.sendTraceTag(543474187,n.a.msoulscat_Wac_PptSession,a.a.Info,"MediaLoaded: "+JSON.stringify(at.getGifInfoLog(this.m_gifInfo,"GifViewElement::onMediaLoaded"))))}onImageError(e){const t=e.imageEl;t?e.retriesRemaining<=0?g.VetoUtils.recordVeto("GIFFailure",{errorName:"GIFAsImageRetryFailed",qosVeto:"GIFFailure",mediaType:"GIF",mediaName:`${this.id.slideId.sid}s${this.id.shapeId}`,requestGuid:this.m_imageRequestGuid,...at.getGifInfoLog(e,"GIFAsImageRetryFailed")}):window.setTimeout(()=>{!at.isImageLoaded(t)&&e.props.imageUrl&&(0===e.mode&&(e.retriesRemaining-=1,e.retryTimeoutMs*=2),t.src=this.getRetryUrl(e.props.imageUrl,e.retriesRemaining,!1))},e.retryTimeoutMs):r.a.sendTraceTag(575160839,n.a.msoulscat_Wac_PptSession,a.a.Error,"GifViewElement::onImageError: "+JSON.stringify(at.getGifInfoLog(e,"Invalid gif element.")))}onVideoError(e){const t=e.videoEl;if(!t)return void r.a.sendTraceTag(575160840,n.a.msoulscat_Wac_PptSession,a.a.Error,"GifViewElement::onVideoError: "+JSON.stringify(at.getGifInfoLog(e,"Invalid gif element")));const i=at.getGifInfoLog(e,"GIFAsVideoRetryFailed"),s={errCode:t.error?t.error.code:"unknown",errMessage:t.error?t.error.message:"unknown",canPlayType:t.canPlayType(i.type),fallbackLoaded:at.isImageLoaded(e.imageEl)};if(i.err=s,r.a.sendTraceTag(590977024,n.a.msoulscat_Wac_PptSession,a.a.Warning,"GifViewElement::onVideoError: "+JSON.stringify(i)),e.retriesRemaining<=0)s.fallbackLoaded?g.VetoUtils.recordVeto("GIFFallbackToImage",{qosVeto:"ContentFallback"}):g.VetoUtils.recordVeto("GIFFailure",{errorName:"GIFAsVideoRetryFailed",qosVeto:"GIFFailure",mediaType:"GIF",mediaName:`${this.id.slideId.sid}s${this.id.shapeId}`,requestGuid:this.m_videoRequestGuid,...i});else{if(!s.canPlayType)return e.mode=0,void this.initImageEl(e);e.retriesRemaining!==at.s_downloadGifFallbackInRetry||s.fallbackLoaded||this.initImageEl(e),window.setTimeout(()=>{!at.isVideoLoaded(e.videoEl)&&e.props.videoUrl&&(e.retriesRemaining-=1,e.retryTimeoutMs*=2,e.videoEl.src=this.getRetryUrl(e.props.videoUrl,e.retriesRemaining,!0),this.m_localMediaPlaybackPerf&&e.videoEl&&e.videoEl.src&&this.m_localMediaPlaybackPerf.onSourceSet(e.videoEl.src))},e.retryTimeoutMs)}}static ensureDOMElement(e,t,i,l){let d=document.getElementById(e);if(!d||d!==t){if(!document.getElementById(s.b.SlideLevelHtmlElementsParentDivId))return r.a.sendTraceTag(592531611,n.a.msoulscat_Wac_PptSession,a.a.Error,`GifViewElement::ensureDOMElement: couldn't find ${s.b.SlideLevelHtmlElementsParentDivId}.`),null;const e=o.a.ensureShapeViewElementParentDiv(i,"2");l&&(d=d?e.replaceChild(t,d):e.appendChild(t))}return d}static isImageLoaded(e){return!!e&&e.complete&&0!==e.naturalWidth&&0!==e.naturalHeight}static isVideoLoaded(e){return!!e&&e.readyState>=3}getRetryUrl(e,t,i){const r=new URL(e);r.searchParams.append("retries",t.toString());const n=`${this.id.slideId.sid}s${this.id.shapeId}`;return r.searchParams.append("mediaName",n),r.searchParams.set("usid",this.m_environment.settings.sessionId),r.searchParams.append("requestGuid",i?this.m_videoRequestGuid:this.m_imageRequestGuid),r.toString()}static getGifInfoLog(e,t){let i=["",""];try{const t=0===e.mode?e.props.imageUrl:e.props.videoUrl,r=new URL(t||"").searchParams.get("mediaId")||"",n=new RegExp(/^(\w+).(\w+).media$/i).exec(r);if(n&&3===n.length){const t=0===e.mode?"image":"video";i=[n[1],`${t}/${n[2]}`.toLowerCase()]}}catch{i=["err","err"]}return{elId:e.elID,mediaId:i[0],type:i[1],mode:e.mode,src:e.props.src.split(";",1)[0],retry:e.retriesRemaining,msg:t}}}at.s_downloadMaxRetryCount=5,at.s_downloadGifFallbackInRetry=3,at.s_downloadInitialRetryDelayMs=800;class st{constructor(e,t,i,s){if(this.shapeType=3,this.fPrepared=!1,this.animatableContentViewElements=[],this.id=e.id,this.m_slideId=this.id.slideId,this.m_emuToPixelScale=i,this.m_shapeViewData=t,this.m_environment=s,!t.appForOffice)throw r.a.sendTraceTag(554260320,n.a.msoulscat_Wac_PptSession,a.a.Error,`AddinViewElement:: Invalid shapeViewData. Addin:${!!t.appForOffice}, animatableContents.length:${this.m_shapeViewData.animatableContents.length}, parts.length:${this.m_shapeViewData.animatableContents.length>0?this.m_shapeViewData.animatableContents[0].parts.length:0}.`),new Error("Invalid Addin");this.m_appForOffice=t.appForOffice,this.m_appForOfficeTheme=t.appForOfficeTheme,this.ShapeAddinTargetId="addin-element-"+JSON.stringify(this.id)}ensure(){let e={addinInfo:{instanceId:this.m_appForOffice.InstanceId,solutionId:this.m_appForOffice.AppForOfficeRef.Id,storeId:this.m_appForOffice.AppForOfficeRef.Store,storeType:this.m_appForOffice.AppForOfficeRef.StoreType}};if(!this.m_shapeItem){const t=this.init();e={...e,...t}}if(!this.m_shapeItem)return r.a.sendTraceTag(554260321,n.a.msoulscat_Wac_PptSession,a.a.Error,"AddinViewElement::ensure: invalid shapeItem."),e.invalidShape=!0,e;const t=o.a.attachTextures(this.m_environment,this.m_shapeItem,this.m_shapeViewData);return{...e,...t}}init(){const e={showAppForOffice:{start:s.b.performanceNowTrimmed(),end:s.b.performanceNowTrimmed()}};if(this.animatableContentViewElements=[],this.m_shapeItem=o.a.initShapeItem(this.m_shapeViewData.animatableContents,this.animatableContentViewElements,this.m_shapeViewData,this.m_emuToPixelScale,this.id,this.m_environment),this.m_environment.addinManager){this.m_addinElement=this.ensureAddinElementDiv();const t=this.m_environment.addinManager.showAppForOffice(this.m_addinElement,this.m_slideId,this.m_appForOffice,this.m_appForOfficeTheme);e.showAppForOffice=t}return e}update(){this.m_environment.addinManager&&this.m_addinElement&&(o.a.ensureShapeViewElementParentDiv(this.id,"2").appendChild(this.m_addinElement),this.m_environment.addinManager.updateAppForOfficeLayout(this.m_addinElement,this.m_appForOffice),this.shapeItem&&(this.shapeItem.isHidden=!0)),o.a.ensureAccessibilityElement(this.id)}ensureAddinElementDiv(){let e=document.getElementById(this.ShapeAddinTargetId);if(e)return e;e=document.createElement("div"),e.id=this.ShapeAddinTargetId;const t=document.getElementById(s.b.PreactivedAddinsDivId);return t&&t.appendChild(e),e}applyAnimation(e){}addToScene(e){this.m_shapeItem&&e.items.push(this.m_shapeItem)}removeFromScene(e){this.m_shapeItem&&-1!==e.items.elements.indexOf(this.m_shapeItem)&&o.a.removeFromScene(e,this.m_shapeItem)}tryPrepare(){return this.m_shapeItem&&!this.fPrepared&&(this.fPrepared=this.m_environment.rendererEnvironment.renderer.tryPrepareItem(this.m_shapeItem,!1,10),this.m_environment.rendererEnvironment.flush()),this.fPrepared}cleanUp(){}get shapeItem(){return this.m_shapeItem}}var ot=i(40);class lt{constructor(e,t,i){this.shapeViewElements=[],this.events=new m.EventEmitter,this.fImageTextureLoaded=!1,this.fImageTextureLoading=!1,this.fOnMouseClickAdvance=!0,this.fHasContinuouslyAnimatedContent=!1,this.fNeedsDummyClick=!1,this.isHidden=!1,this.fHasAddin=!1,this.slideContentTelemetry=[],this.m_animObjects=[],this.m_fPrepared=!1,this.m_timeoutMs=5,this.slideId=e.id,this.m_slide=e,this.animTimeline=new f.i,this.animClock=new f.d,this.m_environment=i,this.m_slideSizePixels=new h.e(t.x,t.y),this.isHidden=e.hidden,this.m_slide.ssTimes&&(this.fOnMouseClickAdvance=this.m_slide.ssTimes.manualAdv)}async ensure(e){const t={sid:this.slideId.sid,ensureSlideViewData:{start:s.b.performanceNowTrimmed(),end:s.b.performanceNowTrimmed()}},i=await this.m_environment.viewDataManager.getSlideViewData(this.slideId,e?e.loadDataOptions:void 0);if(t.ensureSlideViewData.end=s.b.performanceNowTrimmed(),!i.resource)return r.a.sendTraceTag(591927437,n.a.msoulscat_Wac_PptSession,a.a.Warning,`SlideViewElement::ensure: missing slideViewData. sid:${this.slideId.sid}, correlation:${e?e.loadDataOptions?e.loadDataOptions.meta_correlationId:"":void 0}, errorName:${i.metadata.errorName}`),i.metadata.hasOwnProperty("errorName")&&(t.errorName=i.metadata.errorName),t;const o=i.resource;this.m_slideSizePixels=new h.e(o.slideSizePixels.x,o.slideSizePixels.y);let l={};if(0===this.shapeViewElements.length)o.fHasAddinShape&&o.fHasAddinShape&&this.m_environment.addinManager&&!this.m_environment.addinManager.fOsfruntimeLoaded()&&(t.loadOsfRuntime=await this.m_environment.addinManager.loadOsfRuntime()),l=await this.init(o,e);else for(const e of this.shapeViewElements){const i=e.ensure();lt.processEnsureShapeResult(t,i,e.id.shapeId)}return{...t,...l}}async init(e,t){const i={initSlideVE_bg:{start:s.b.performanceNowTrimmed(),end:s.b.performanceNowTrimmed()}},o={slideId:this.slideId,shapeId:-1},m=this.m_slideSizePixels.x/this.m_environment.slideSizeEmus.x;let p;const g={shapeId:o,isBackground:!0,shapeBuilderData:{},animatableContents:[]};if(e.slideBackground&&e.slideBackground.solidFill){const t=e.slideBackground.solidFill.t/100,i=new c.b(Math.floor(255*t+(1-t)*e.slideBackground.solidFill.r)/255,Math.floor(255*t+(1-t)*e.slideBackground.solidFill.g)/255,Math.floor(255*t+(1-t)*e.slideBackground.solidFill.b)/255,1);p=u.e.CreateRectangle(new h.c(0,0,this.m_slideSizePixels.x,this.m_slideSizePixels.y),new c.k(new c.i(i)))}else if(e.slideBackground&&e.slideBackground.imageFill){const t=new c.f;t.id=e.slideBackground.imageFill.imgID;const i=new c.e(t);p=u.e.CreateRectangle(h.c.FromSize(new h.e(this.m_slideSizePixels.x,this.m_slideSizePixels.y)),new c.k(i))}if(p){Object(ot.c)(p).isBackground=!0;const e=new d({id:g.shapeId},g,m,this.events,this.m_environment,{item:p});e.ensure(),this.shapeViewElements.push(e)}else r.a.sendTraceTag(559269019,n.a.msoulscat_Wac_PptSession,a.a.Error,"failed to create background");if(i.initSlideVE_bg.end=s.b.performanceNowTrimmed(),!this.m_slide.spLst)return i;i.initSlideVE_shapeViewData={start:s.b.performanceNowTrimmed(),end:s.b.performanceNowTrimmed()};const _=await this.getShapeViewDataInSlideAsync();i.initSlideVE_shapeViewData.end=s.b.performanceNowTrimmed(),i.initSlideVE_ensureShapeVE={start:s.b.performanceNowTrimmed(),end:s.b.performanceNowTrimmed()};const y={Media:0,Media_canvas:0,Gif:0,Addin:0,Cameo:0,Shape:0};for(let e=0;e<this.m_slide.spLst.length;e+=1){const s=_[e];if(s)if(s.media){const o=nt.getMediaType(s.media);r.a.sendTraceTag(555792223,n.a.msoulscat_Wac_PptSession,a.a.Info,`SlideViewElement::init: MediaType:${o}, glContext:${this.m_environment.rendererEnvironment.glContext}`);const d=new nt(this.m_slide.spLst[e],s,m,this.m_environment,this.m_slideSizePixels,this.events,!!t&&t.isPrefetch),h=d.ensure();i.hasOwnProperty("metadata")?i.metadata.push(h):i.metadata=[h],lt.processEnsureShapeResult(i,h,s.shapeId.shapeId),this.shapeViewElements.push(d),this.fHasContinuouslyAnimatedContent||l.Settings.readBooleanOrDefault("useIsMediaPlaying",!0)||(this.fHasContinuouslyAnimatedContent=d.shouldRenderToCanvas),d.shouldRenderToCanvas?y.Media_canvas+=1:y.Media+=1}else if(s.gif&&this.m_environment.rendererEnvironment.supportsGif){const t=new at(this.m_slide.spLst[e],s,m,this.events,this.m_environment,this.m_slideSizePixels),r=t.ensure();r.hasOwnProperty("mediaType")&&(i.hasOwnProperty("metadata")?i.metadata.includes(r.mediaType)||i.metadata.push(r.mediaType):i.metadata=[r.mediaType]),lt.processEnsureShapeResult(i,r,s.shapeId.shapeId),this.shapeViewElements.push(t),this.fHasContinuouslyAnimatedContent=!0,y.Gif+=1}else if(s.appForOffice){const t=new st(this.m_slide.spLst[e],s,m,this.m_environment),o=t.ensure();lt.processEnsureShapeResult(i,o,s.shapeId.shapeId),r.a.sendTraceTag(541673088,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,"initSlideVE::ensureAddinVE::"+JSON.stringify(o)),this.shapeViewElements.push(t),y.Addin+=1}else if(s.cameo){const t=new v(this.m_slide.spLst[e],s,m,this.m_environment),r=t.ensure();lt.processEnsureShapeResult(i,r,s.shapeId.shapeId),this.shapeViewElements.push(t),y.Cameo+=1}else{const t=new d(this.m_slide.spLst[e],s,m,this.events,this.m_environment),r=t.ensure();lt.processEnsureShapeResult(i,r,t.id.shapeId),this.shapeViewElements.push(t),y.Shape+=1}else r.a.sendTraceTag(595657629,n.a.msoulscat_Wac_PptSession,a.a.Error,"SlideViewElement::init: Invalid shapeViewData. Continue...")}i.initSlideVE_ensureShapeVE.end=s.b.performanceNowTrimmed(),this.slideContentTelemetry.contentCounts=y;const b=[].concat(...this.shapeViewElements.map(e=>e.animatableContentViewElements));l.Settings.readBooleanOrDefault("hackAnimationsEnabled",!0)||(this.m_slide.animSeqs=[{AnimationList:[],SequenceId:"0_anim"}]);const{animObjectList:S,needsDummyClick:T}=new f.j(this.animTimeline).createAnimObjectListForSlide(this.m_slide.animSeqs,b,this.m_slideSizePixels);this.fNeedsDummyClick=T,this.m_animObjects=S;const w=this.m_slide.animSeqs.map(e=>e.SequenceId),M=new Map;for(const e of w)M.set(e,{ClickNum:T&&e===f.e.MainTimelineId?1:0,Offs:0});return this.animTimeline.initTimeline(this.m_animObjects,w,M,0),i}async getShapeViewDataInSlideAsync(){return await Promise.all(this.m_slide.spLst.map(e=>this.m_environment.viewDataManager.getShapeViewData(this.m_slide.id,e.id))||[])}static processEnsureShapeResult(e,t,i){t.hasOwnProperty("missingTextureIds")&&(e.hasOwnProperty("missingTextureIds")||(e.missingTextureIds=[]),e.missingTextureIds.push(...t.missingTextureIds)),t.hasOwnProperty("invalidShape")&&t.invalidShape&&(e.hasOwnProperty("invalidShapeIds")||(e.invalidShapeIds=[]),e.invalidShapeIds.push(i)),t.hasOwnProperty("showAppForOffice")&&t.showAppForOffice&&(e.hasOwnProperty("initSlideVE_ensureAddinVEs")||(e.initSlideVE_ensureAddinVEs=[]),e.initSlideVE_ensureAddinVEs.push(t.showAppForOffice))}get slideSizePixels(){return this.m_slideSizePixels}get fPrepared(){return this.m_fPrepared}set fPrepared(e){if(e!==this.m_fPrepared){this.m_fPrepared=e;for(const e of this.shapeViewElements)e.fPrepared=this.m_fPrepared}}tryPrepare(){for(const e of this.shapeViewElements)if(!e.fPrepared){try{e.tryPrepare(this.m_timeoutMs)?this.m_timeoutMs=5:this.m_timeoutMs=2*this.m_timeoutMs}catch(e){let t=e;e instanceof Error&&this.m_environment.stringifyError&&(t=this.m_environment.stringifyError(e)),r.a.sendTraceTag(592328460,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,"SlideViewElement::preRender Exception while in tryPrepare:"+t)}return!1}return this.m_fPrepared=!0,r.a.sendTraceTag(595634144,n.a.msoulscat_Wac_PptSession,a.a.Info,"SlideViewElement::preRender Done preRendering - slideId:"+this.slideId.sid),!0}tryPrepareAllAtOnce(e){const t=performance.now();for(const i of this.shapeViewElements){const s=e-(performance.now()-t);if(!i.fPrepared)try{if(!i.tryPrepare(s))return!1}catch(e){let t=e;e instanceof Error&&this.m_environment.stringifyError&&(t=this.m_environment.stringifyError(e)),r.a.sendTraceTag(539767631,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,"SlideViewElement::preRender Exception while in tryPrepare:"+t)}}return this.m_fPrepared=!0,!0}async updateAccessibilityTag(e,t,i){if(!i)return;const l=await this.m_environment.viewDataManager.getSlideViewData(t);if(l.resource&&l.resource.accessibilityModelPromise){const i=await l.resource.accessibilityModelPromise,r=this.animTimeline.getEndTime(f.e.MainTimelineId),n=r?r.ClickNum:0;let a=this.animTimeline.getNumTimelineClicks(f.e.MainTimelineId);a=a>n?n:a;const s=JSON.stringify({slideIndex:e,sldId:t,animationIndex:a});if(lt.s_lastAccessibilityTagHash===s)return;lt.s_lastAccessibilityTagHash=s,await this.updateAccessibilityLiveRegion(e,i,a,n);const d=lt.getLocalizedString();if(i&&i.shapeAccessibilityDataList){i.shapeAccessibilityDataList.forEach(e=>{const t={slideId:e.slideId,shapeId:parseInt(e.shapeId?e.shapeId:"",10)},i=o.a.generateShapeLevelAccessibilityElementId(t),r=document.getElementById(i);r&&(r.appendChild(e.val),r.classList.add("show-accessibility-element"),r.style.display="")});const t=o.a.ensureSlideTitleElement();t&&(t.innerText=this.getSlideTitleElementStr(d.slideTitleElementStr,e,i.slideTitleString),t.classList.add("show-accessibility-element"),t.style.display="")}}else{const e=document.getElementById(s.b.AccessibilitySlideTitleId);e&&(e.style.display="none"),r.a.sendTraceTag(591927438,n.a.msoulscat_Wac_PptSession,a.a.Error,"SlideViewElement::updateAccessibilityTag - missing slideViewData. sid:"+this.slideId.sid)}}async updateAccessibilityLiveRegion(e,t,i,r){const n=lt.getLocalizedString();let a=document.getElementById(s.b.AccessibilityLiveRegionContainerDivId);a&&(""!==s.b.accessibilityLanguage&&s.b.appLanguage&&!s.b.appLanguage.includes(s.b.accessibilityLanguage)?a=this.addLangAttributeToLiveRegion(a):(""===s.b.accessibilityLanguage||s.b.appLanguage&&s.b.appLanguage.includes(s.b.accessibilityLanguage))&&a.removeAttribute("lang"),a.innerText=this.getSlideTitleElementStr(n.slideTitleElementStr,e,t.slideTitleString));let o=i,l=r;if(this.fNeedsDummyClick&&(o-=1,l-=1),o<=0){if(l>0){let i=1===r?n.animTotalSingularStr:n.animTotalPluralStr;i&&a&&(i=i.replace("{0}",""+l),a.innerText=n.accessibilityLiveRegionAnimStepStr.replace("{0}",""+(e+1)).replace("{1}",t.slideTitleString).replace("{2}",i))}}else{const i=t.slideTitleString?n.slideNameWithTooltipStr:n.slideNameWithoutTooltipStr,r=n.slideStr,s=n.animNumStr;if(i&&s&&r){const n=i.replace("{0}",""+r).replace("{1}",""+(e+1)).replace("{2}",""+t.slideTitleString),d=s.replace("{0}",""+o).replace("{1}",""+l).replace("{2}",""+n);a&&(a.innerText=d)}}}addLangAttributeToLiveRegion(e){const t=document.createElement("div");t.id=s.b.AccessibilityLiveRegionContainerDivId,t.setAttribute("style","position: absolute; left: 0px; top: auto; width: 1px; height: 1px; overflow: hidden;"),t.setAttribute("aria-live","assertive"),t.setAttribute("aria-atomic","true"),t.setAttribute("role","alert"),t.setAttribute("lang",s.b.accessibilityLanguage);const i=document.getElementsByClassName("slide-container-class");return i.length>0&&i[0]&&i[0].replaceChild(t,e),t}getSlideTitleElementStr(e,t,i){return e.replace("{0}",""+(t+1)).replace("{1}",i)}static getLocalizedString(){let e;return e="undefined"!=typeof PowerpointSlideshowStrings?{slideTitleElementStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSlideIndexAndSlideTitle,animTotalSingularStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelAnimTotalSingular,animTotalPluralStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelAnimTotalPlural,accessibilityLiveRegionAnimStepStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelForLiveRegionAnimationStepReadout,slideNameWithTooltipStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSldNameWithTooltip,slideNameWithoutTooltipStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSldNameWithoutTooltip,slideStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelSlideStr,animNumStr:PowerpointSlideshowStrings.SlideShowAccessibilityLabelAnimationNumber}:{slideTitleElementStr:"Slide {0}:{1}. ",animTotalSingularStr:"Has 1 animation",animTotalPluralStr:"Has {0} animations",accessibilityLiveRegionAnimStepStr:"Slide {0}:{1}, {2}",slideNameWithTooltipStr:"{0} {1} - {2}",slideNameWithoutTooltipStr:"{0} {1}",slideStr:"Slide",animNumStr:"Animation {0} of {1} on {2}"},e}updateShapeViewElements(){for(const e of this.shapeViewElements)-1!==e.id.shapeId&&e.update();for(const e of this.m_animObjects){const t=e.Shape.shapeId,i=this.shapeViewElements.find(e=>e.id.shapeId===t.shapeId&&e.id.slideId.sid===t.slideId.sid);if(i){const t=this.animTimeline.getEndTime(f.e.MainTimelineId),r=t?t.ClickNum:0;i.applyAnimation(e,r)}}}updateMediaViewElement(e,t,i){for(const r of this.shapeViewElements)if(1===r.shapeType&&r.getMediaName()===e)switch(t){case 1:r.playMedia();break;case 0:r.pauseMedia();break;case 3:r.seekMedia(i||0)}}updateMediaState(e){for(const t of this.shapeViewElements)if(1===t.shapeType&&t.getMediaName()===e.mediaName)return _e("Passing to MediaViewElement","SlideViewElement",e),void t.updateMediaState(e);_e("Blocking - MediaViewElement of media wasn't found","SlideViewElement",e)}initMediaAfterSlideContentChanged(){for(const e of this.shapeViewElements)1===e.shapeType&&e.initAfterSlideContentChanged()}updateVideoPlayButtonVisibility(e){for(const t of this.shapeViewElements)1===t.shapeType&&t.updateVideoPlayButtonVisibility(e)}setAadToken(e){ge.postAadTokenToStream(e)}static setStream2AadToken(e){se.setAADToken(e)}getMediaNamesOnSlide(){const e=[];for(const t of this.shapeViewElements)1===t.shapeType&&e.push(t.getMediaName());return e}async isMediaPresentInSlideAsync(){const e=await this.getShapeViewDataInSlideAsync();for(const t of e)if(t&&void 0!==t.media)return!0;return!1}getAllZoomsOnSlide(){const e=[];for(const t of this.shapeViewElements)if(0===t.shapeType)for(const i of t.getAllZoomsOnShape())e.push(i);return e}async isCameoPresentInSlideAsync(){const e=await this.getShapeViewDataInSlideAsync();for(const t of e)if(t&&void 0!==t.cameo)return!0;return!1}getCameoInfoInSlide(){const e=[];for(const t of this.shapeViewElements)4===t.shapeType&&e.push(t.getCameoInfo());return e}addToScene(e){for(let t=0;t<this.shapeViewElements.length;t+=1)this.shapeViewElements[t].addToScene(e)}removeFromScene(e){for(let t=0;t<this.shapeViewElements.length;t+=1)4===this.shapeViewElements[t].shapeType&&this.shapeViewElements[t].removeFromScene(e)}cleanUp(){for(let e=0;e<this.shapeViewElements.length;e+=1)this.shapeViewElements[e].cleanUp()}getMediaCurrentState(e){for(const t of this.shapeViewElements)if(1===t.shapeType&&t.getMediaName()===e)return t.getMediaCurrentState()}updateGlobalMute(e){for(const t of this.shapeViewElements)1===t.shapeType&&t.updateGlobalMute(e)}onSlideScaled(e){for(const t of this.shapeViewElements)1===t.shapeType&&t.resizeToScale(e)}muteAllPlayingMedia(){for(const e of this.shapeViewElements)1===e.shapeType&&e.mutePlayingMedia()}getMediaInfo(e){for(const t of this.shapeViewElements)if(1===t.shapeType&&t.getMediaName()===e)return t.getMediaInfo()}isMediaPlayingOnSlideCanvas(){for(const e of this.shapeViewElements)if(1===e.shapeType&&e.shouldUpdateMediaOnCanvas())return!0;return!1}}lt.s_lastAccessibilityTagHash=""},,function(e,t,i){(t=e.exports=function(e){e=e.toLowerCase();var i=t[e];if(!i)throw new Error(e+" is not supported (we accept pull requests)");return new i}).sha=i(283),t.sha1=i(284),t.sha224=i(285),t.sha256=i(184),t.sha384=i(286),t.sha512=i(185)},function(e,t,i){"use strict";i.d(t,"b",(function(){return X})),i.d(t,"c",(function(){return Y})),i.d(t,"a",(function(){return J}));var r,n,a=i(30),s=i(21),o=i(31),l=i(42),d=i(4),h=i(2),c=i(3),u=i(23),f=i(12),m=i(10),p=i(171),g=i(50),_=i(17),v=i(58),y=i(6),b=i(1);!function(e){e.Init="init",e.Goto="goto",e.Prefetch="prefetch",e.Prerender="prerender",e.CheckHidden="CheckHidden",e.UpdateResourceProviders="UpdateResourceProviders",e.ChangeRenderingModeToSVG="ChangeRenderingModeToSVG"}(r||(r={})),function(e){e.EnsureSlideView="ensureSlideView",e.ResizeViewContainer="resizeViewContainer",e.RenderTransition="renderTransition",e.RenderSlide="renderSlide",e.ReloadTexture="reloadTexture"}(n||(n={}));class S{constructor(){this.m_navigationData={},this.m_maxGotoSlideMs=0,this.m_startFromTime=0,this.m_userActionTimestamp=0,this.m_initInfo={}}init(e){this.m_settings=e}recordInitData(e){if(!e.hasOwnProperty(r.Init)||!this.m_settings)return;const t={sessionId:this.m_settings.appSettings.userSessionId,InitInfo:e,initDurFromEndUser:e[r.Init].end-this.m_settings.appSettings.initTime,initDur:e[r.Init].end-e[r.Init].start,Config:m.a.getSessionConfig()};0===Object.keys(this.m_initInfo).length&&(this.m_initInfo=t.InitInfo);let i={initDur:t.initDur,initDurFromEndUser:t.initDurFromEndUser};this.m_settings.appSettings.useSnapDownloadUrl&&(t[S.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl,i[S.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl),m.a.recordSessionStats(i),d.a.sendTraceTag(592483858,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,S.getLogString("SSCoreInit",t))}recordNavData(e,t,i,n){if(!i||0===Object.keys(i).length||!i.hasOwnProperty("sid")||!this.m_settings)return;let s=!1,o=!1,l=!1;const u=i.sid.toString();if(n&&n.bootMetrics){if(0===this.m_startFromTime&&(s=!0,this.m_navigationData.hasOwnProperty(u))){let e=this.m_navigationData[u];e.hasOwnProperty(r.Prerender)&&(o=!0),e.hasOwnProperty(r.Prefetch)&&(l=!0)}this.m_startFromTime=n.startFromTime?n.startFromTime:0,this.m_maxGotoSlideMs=0,this.m_navigationData={},n.startFromTime||d.a.sendTraceTag(588804161,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,"NavigationLogger::recordNavData Boot metrics object was present, but there was no startFromTime.")}if(this.m_navigationData.hasOwnProperty(u)||(this.m_navigationData[u]={}),y.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(i.hasOwnProperty(S.TextureMetadata)&&(i[S.TextureMetadata]=void 0),i.hasOwnProperty("createTransition")&&i.createTransition.hasOwnProperty("rendererEnvironment")&&(i.createTransition.rendererEnvironment.hasOwnProperty(S.RenderTransitionTextures)&&(i.createTransition.rendererEnvironment[S.RenderTransitionTextures]=void 0),i.createTransition.rendererEnvironment.hasOwnProperty(S.GenerateMorphResource)&&(i.createTransition.rendererEnvironment[S.GenerateMorphResource]=void 0),i.createTransition.rendererEnvironment.hasOwnProperty(S.RenderToTexture)&&(i.createTransition.rendererEnvironment[S.RenderToTexture]=void 0))),y.ChangeGate.isChangeGateEnabled("FixNavLogTrimmingMissingTextures")&&i.hasOwnProperty("missingTextureIds")){const e={id:i&&i.id,sr:i&&i.sr,missingTextureIds:i.missingTextureIds};d.a.sendTraceTag(507598877,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,S.getLogString("addOnTrimmedDataTextureIds",e)),i.missingTextureIds=void 0,i.hasMissingTextureIds=!0}const p=this.m_navigationData[u];if(i.hasOwnProperty(S.Metadata)){p.hasOwnProperty(S.Metadata)||(p[S.Metadata]=[]),p[S.Metadata]=p[S.Metadata].concat(i[S.Metadata].filter(e=>!p[S.Metadata].includes(e)));let e=!1;for(let t in i[S.Metadata])if(i[S.Metadata][t].hasOwnProperty(S.MediaInfo)){e=!0;break}e&&!m.a.getSessionStats("hasMedia")&&m.a.recordSessionStats({hasMedia:!0}),y.ChangeGate.isChangeGateEnabled("ssc.HasMediaPartCDimension")&&e&&v.a.addOrUpdatePartCDimensions(new Map([["NavigatedToSlideWithMedia","true"]]))}if(y.ChangeGate.isChangeGateEnabled("FixNavLogTrimmingMetadata")&&i.hasOwnProperty(S.Metadata)){const e={id:i&&i.id,sr:i&&i.sr,metadata:i[S.Metadata]};d.a.sendTraceTag(507597592,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,S.getLogString("addOnTrimmedDataMetadata",e)),i[S.Metadata]=void 0,i.hasMetadata=!0}let g,_=0;if(n&&n.navMetrics&&n.navMetrics.checkHiddenSlideResult&&(_=S.getDuration(n.navMetrics.checkHiddenSlideResult)),!(t===r.Goto&&p.hasOwnProperty(r.Goto)&&i.hasOwnProperty(r.Goto)&&S.getDuration(p[r.Goto])+S.getDuration(p[r.CheckHidden])>=S.getDuration(i[r.Goto])+_||t===r.Prefetch&&p.hasOwnProperty(r.Prefetch))){for(const t in i)if(t===r.Goto)if(p[r.CheckHidden]=_,n&&n.bootMetrics){const r={sessionId:this.m_settings.appSettings.userSessionId,startFromTime:n?n.startFromTime:void 0,bootMetrics:n?n.bootMetrics:void 0,Config:m.a.getSessionConfig(),EUPL:n.startFromTime&&0!==n.startFromTime?i[t].end-n.startFromTime:void 0,firstStartMetrics:{firstStart:s}};if(y.ChangeGate.isChangeGateEnabled("SSLaunchRefactoredLaunchLogs")&&n&&n.id&&(r.id=n.id),i.hasOwnProperty("pptSpinnerStartTime")&&r.bootMetrics&&(r.bootMetrics.pptSpinnerStartTime=i.pptSpinnerStartTime),i.hasOwnProperty("errorName")&&(r.errors=i.errorName),this.m_settings.appSettings.useSnapDownloadUrl&&(r[S.UseSnapDownloadUrlString]=this.m_settings.appSettings.useSnapDownloadUrl),i.hasOwnProperty(S.Metadata)){const e=this.getMetadataSummary(i[S.Metadata]);e.length>0&&(r[S.Metadata]=e),r.NavigationInfo=Object.keys(i).reduce((e,t)=>(t!==S.Metadata&&(e[t]=i[t]),e),{})}else r.NavigationInfo=i;r.slideIndex=e.getVisibleSlideIndex({sid:i.sid,cid:0}),y.ChangeGate.isChangeGateEnabled("AddNavigationSource")&&(this.m_slideIndexFromBoot=r.slideIndex),s&&(r.firstStartMetrics.prefetched=l,r.firstStartMetrics.prerendered=o),0!==Object.keys(this.m_initInfo).length&&(r.initMetrics=this.m_initInfo),r.EUPL>b.Settings.readNumberOrDefault("vetoBootDurationMs",2e3)&&f.VetoUtils.recordVeto("VetoedSlideShowBootTimeMs",{qosVeto:"PerceivedOpenSlow",...r}),i.hasOwnProperty(S.GetItemsResult)&&void 0!==i[S.GetItemsResult]&&(r[S.GetItemsResult]=i[S.GetItemsResult]),y.ChangeGate.isChangeGateEnabled("AddSlideDuration")&&(this.m_bootLaunchId=n&&n.id),d.a.sendTraceTag(594650330,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,S.getLogString("boot",r))}else n&&!n.bootMetrics&&(i.hasOwnProperty("errorName")||(p[t]=i[t],i.hasOwnProperty("SBCurrentFrameSummary")&&i.SBCurrentFrameSummary.hasOwnProperty("totalCostMs")&&(p[S.RenderCost]=i.SBCurrentFrameSummary.totalCostMs),i.hasOwnProperty(S.NavigationStep)&&0!==i[S.NavigationStep]&&1!==i[S.NavigationStep]&&(p[S.NavigationStep]=i[S.NavigationStep]),n&&n.navigationType&&n.navigationType!==a.a.Init&&n.navigationType!==a.a.Next&&n.navigationType!==a.a.Prev&&(p.navigation=n.navigationType),i.hasOwnProperty(S.CachedInServer)&&(p[S.CachedInServer]=i[S.CachedInServer]),i.hasOwnProperty(S.RequestInfo)&&(p[S.RequestInfo]=i[S.RequestInfo]),i.hasOwnProperty(S.PlayTransitionMs)||(this.m_maxGotoSlideMs=Math.max(this.m_maxGotoSlideMs,S.getDuration(p[t])),S.getDuration(i[t])+_>b.Settings.readNumberOrDefault("vetoNavigationDurationMs",1250)&&0!==this.m_startFromTime&&f.VetoUtils.recordVeto("VetoedSlideShowNavTimeMs",{qosVeto:"SlideShowNavSlow",...this.m_navigationData[u.toString()]}))));else t===r.Prefetch&&(i.hasOwnProperty("errorName")?p.hasOwnProperty("errorCount")?p.errorCount+=1:p.errorCount=1:p[t]=i[t],i.hasOwnProperty(r.Prerender)&&(p[r.Prerender]=i[r.Prerender]),i.hasOwnProperty(S.CachedInServer)&&(p[S.CachedInServer]=i[S.CachedInServer]),i.hasOwnProperty(S.RequestInfo)&&(p[S.RequestInfo]=i[S.RequestInfo]));if(i.sessionId=this.m_settings.appSettings.userSessionId,i.action=t,i.startFromTime=this.m_startFromTime,d.a.sendTraceTag(594650332,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,S.getLogString("navigation",i)),y.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&(g=e.getVisibleSlideIndex({sid:i.sid,cid:0})),y.ChangeGate.isChangeGateEnabled("AddNavigationSource")&&t===r.Goto){const e={id:i&&i.id,navType:n&&n.navigationType,sIdx:void 0!==this.m_slideIndexFromBoot?this.m_slideIndexFromBoot:void 0,timestamp:Date.now()};if(y.ChangeGate.isChangeGateEnabled("AddSlideDuration"))if(y.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&(e.sr=i.sr,e.playTransitionMs=i.playTransitionMs,e.slideDistanceFromLaunch=void 0!==this.m_slideIndexFromBoot&&void 0!==g?g-this.m_slideIndexFromBoot:void 0,e.loadSlide=i.LoadSlide,e.fPrepared=i.fPrepared),e.bootLaunchId=this.m_bootLaunchId,n&&n.navigationType===a.a.Init)this.m_userActionTimestamp=m.a.performanceNowTrimmed();else if(n&&(n.navigationType===a.a.Next||n.navigationType===a.a.Prev||n.navigationType===a.a.GoTo)){const t=m.a.performanceNowTrimmed();e.timeSpentOnPrevSlide=t-this.m_userActionTimestamp,this.m_userActionTimestamp=t,e.navType=n.navigationType}d.a.sendTraceTag(507787460,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,S.getLogString("addOnnavigation",e))}}}logPerfData(){if(0===Object.keys(this.m_navigationData).length||!this.m_settings)return;let e=[];const t=Object.keys(this.m_navigationData).map(t=>{const i=this.m_navigationData[t],n={};return n.id=t,Object.keys(i).forEach(t=>{if(t===r.Goto||t===r.Prefetch||t===r.Prerender)n[t]=S.getDuration(i[t]);else if(t===S.Metadata){for(let t of i[S.Metadata])t.hasOwnProperty(S.MediaInfo)&&e.push(t[S.MediaInfo]);let t=this.getMetadataSummary(i[S.Metadata]);t.length>0&&(n[S.Metadata]=t)}else n[t]=i[t]}),n}),i={startFromTime:this.m_startFromTime,sessionId:this.m_settings.appSettings.userSessionId,maxNav:this.m_maxGotoSlideMs,navList:t,Config:m.a.getSessionConfig()};m.a.recordSessionStats({maxNav:this.m_maxGotoSlideMs}),d.a.sendTraceTag(594650331,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,S.getLogString("navSummary",i));const n={startFromTime:this.m_startFromTime,sessionId:this.m_settings.appSettings.userSessionId,mediaInfoObjects:e,Config:m.a.getSessionConfig()};Object.keys(e).length>0&&d.a.sendTraceTag(591165197,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,S.getLogString("mediaSummary",n))}getMetadataSummary(e){const t=[];for(let i in e)if(e[i].hasOwnProperty(S.MediaInfo)){const r=e[i][S.MediaInfo];t.includes(r.type)||t.push(r.type)}else t.includes(e[i])||t.push(e[i]);return t}static getDuration(e){return e.end-e.start}static getLogString(e,t){if(!t)return"";const i=JSON.stringify(t),r=i.length;return r>3e3&&d.a.sendTraceTag(572289234,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,`log size is too long! size:${r}, source:${e}`),i}}S.RenderCost="render",S.Metadata="metadata",S.NavigationStep="step",S.CachedInServer="cached",S.PlayTransitionMs="playTransitionMs",S.GetItemsResult="getItemsResult",S.UseSnapDownloadUrlString="useSnap",S.MediaInfo="mediaInfo",S.RequestInfo="requestInfo",S.TextureMetadata="textureMetadata",S.RenderTransitionTextures="renderTransitionTextures",S.GenerateMorphResource="generateMorphResource",S.RenderToTexture="renderToTexture";var T=i(37);class w{constructor(e){const t=document.createElement("style");t.setAttribute("type","text/css"),t.textContent="\n     #scc_loading_ui{width:100%;height:100%;position:absolute;text-align:center;display:none;}\n     #scc_loading_centerer{position:absolute;left:50%;right:0;bottom:50%;}\n     #scc_loading_spinner {\n         position: absolute;\n         display: block;\n         border: 2px solid #d9d9d9;\n         border-top: 2px solid #b7472a;\n         border-radius: 95%;\n         top: 7px;\n         left: 6px;\n         width: 48px;\n         height: 48px;\n         margin-left: -25px;\n         margin-top: -25px;\n         z-index: 1051;\n         -moz-animation: scc_fastbootspin 1.4s ease infinite;\n         -webkit-animation: scc_fastbootspin 1.4s ease infinite;\n         animation: scc_fastbootspin 1.4s ease infinite;\n     }\n     @-moz-keyframes scc_fastbootspin {\n         100% {\n             -moz-transform: rotate(360deg);\n         }\n     }\n     @-webkit-keyframes scc_fastbootspin {\n         100% {\n             -webkit-transform: rotate(360deg);\n         }\n     }\n     @keyframes scc_fastbootspin {\n         100% {\n             -webkit-transform: rotate(360deg);\n             transform: rotate(360deg);\n         }\n     }",document.getElementsByTagName("head")[0].appendChild(t),this.m_loadingDiv=document.createElement("div"),this.m_loadingDiv.id="scc_loading_ui",e.appendChild(this.m_loadingDiv);const i=document.createElement("div");i.id="scc_loading_centerer",this.m_loadingDiv.appendChild(i);const r=document.createElement("span");r.id="scc_loading_spinner",i.appendChild(r)}show(){this.m_loadingDiv.style.display="block"}hide(){this.m_loadingDiv.style.display="none"}get isVisible(){return"block"===this.m_loadingDiv.style.display}}class M{constructor(e,t){this.m_showLoadingUITimeoutId=-1,this.m_events=new o.EventEmitter,this.m_isBoot=!0,this.m_telemetry={},this.m_state=e,this.m_loadingUI=t,this.m_progressIndicatorWaitTimeMs=b.Settings.readNumberOrDefault("progressIndicatorWaitTimeMs",1250)}get state(){return this.m_state}getTelemetry(){return this.m_telemetry}setState(e){if(e!==this.m_state){switch(this.m_state=e,e){case 0:window.clearTimeout(this.m_showLoadingUITimeoutId),this.m_isBoot=!1,this.m_loadingUI.hide();break;case 1:window.clearTimeout(this.m_showLoadingUITimeoutId),this.m_showLoadingUITimeoutId=window.setTimeout(()=>{this.m_loadingUI.show(),this.m_isBoot&&(this.m_telemetry.pptSpinnerStartTime=m.a.performanceNowTrimmed()),d.a.sendTraceTag(574743133,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,`SlideShowCoreStateManager: Showing Loading Spinner. isBoot: ${this.m_isBoot}.`)},this.m_progressIndicatorWaitTimeMs)}this.m_events.emit("stateChanged")}}}function C(e,t){for(let i of t)if(i.id.toString()===e)return i;return null}function I(e,t){let i=C(e,t);return i&&i.sldIds.length>0?(i.sldIds[0].cid=0,i.sldIds[0]):null}function P(e,t){let i=C(e,t);return i&&i.sldIds.length>0?i.sldIds[i.sldIds.length-1]:null}class E{constructor(e,t,i,r,n,a){this.m_returningEntry=!1,this.m_targetSlide=e,this.m_lastSlide=t,this.m_section=i,this.m_originSlide=n,this.m_returnToParent=r,this.m_returningEntry=a}get targetSlide(){return this.m_targetSlide}get returnToParent(){return this.m_returnToParent}get originSlide(){return this.m_originSlide}get lastSlide(){return this.m_lastSlide}}class x{constructor(e){this.m_zoomStack=[],this.m_zoomCollection=[],this.m_viewDataManager=e}clear(){this.m_zoomStack=[],this.m_zoomCollection=[]}addSlide(e,t,i){const r=new E(e,e,"",i,t,!1);this.m_zoomStack.push(r),this.m_zoomCollection.push(r)}addSection(e,t,i){const r=I(e,this.m_viewDataManager.sections),n=P(e,this.m_viewDataManager.sections);if(!r||!n)return;let a=new E(r,n,e,i,t,!1);this.m_zoomStack.push(a),this.m_zoomCollection.push(a)}needsToReturnOnNext(e){return this.m_zoomStack.length>0&&e.sid===this.m_zoomStack[this.m_zoomStack.length-1].lastSlide.sid&&this.m_zoomStack[this.m_zoomStack.length-1].returnToParent}nextReturnToParentId(e){if(this.m_zoomCollection.length>0&&e.sid===this.m_zoomStack[this.m_zoomStack.length-1].lastSlide.sid&&this.m_zoomStack[this.m_zoomStack.length-1].returnToParent){let e=this.m_zoomStack[this.m_zoomStack.length-1];return this.m_zoomStack.pop(),e=new E(e.targetSlide,e.lastSlide,e.m_section,e.returnToParent,e.originSlide,!0),this.m_zoomCollection.push(e),e?e.originSlide:null}return null}needsToJumpOnNext(e){return!(this.m_zoomCollection.length<=0)&&(!this.m_zoomStack[this.m_zoomStack.length-1]||this.m_zoomStack[this.m_zoomStack.length-1].lastSlide.sid===e.sid)&&e.sid===this.m_zoomCollection[this.m_zoomCollection.length-1].originSlide.sid&&this.m_zoomCollection[this.m_zoomCollection.length-1].m_returningEntry}slideWhereZoomLeftOff(e){let t=e;return e.sid===this.m_zoomCollection[this.m_zoomCollection.length-1].originSlide.sid&&this.m_zoomCollection[this.m_zoomCollection.length-1].m_returningEntry&&(t=this.m_zoomCollection[this.m_zoomCollection.length-1].lastSlide),t.cid=0,t}zoomOnCurrentSlide(e,t,i){for(let r of t){let t,n;if(r.slideId&&(t=r.slideId,n=r.slideId),r.sectionId&&(t=I(r.sectionId,this.m_viewDataManager.sections),n=P(r.sectionId,this.m_viewDataManager.sections)),t&&n&&t.sid===e.sid)return r.slideId&&this.addSlide(t,i,r.returnToParent),r.sectionId&&this.addSection(r.sectionId,i,r.returnToParent),!0}return!1}checkZoomGoBack(e){if(this.m_zoomCollection.length>0){let t;const i=this.m_zoomCollection[this.m_zoomCollection.length-1];return t=i.m_returningEntry?i.originSlide:i.targetSlide,e.sid===t.sid}return!1}zoomGoBack(e){if(this.m_zoomCollection.length>0){let t,i;const r=this.m_zoomCollection[this.m_zoomCollection.length-1];return r.m_returningEntry?(t=r.originSlide,i=r.lastSlide):(t=r.targetSlide,i=r.originSlide),e.sid===t.sid&&(this.m_zoomCollection.pop(),r.m_returningEntry?(r.m_returningEntry=!1,this.m_zoomStack.push(r)):this.m_zoomStack.pop()),i.cid=0,i}return null}}class A{static convertToSlideShowError(e){switch(e){case"ErrorRESERVEDItemFailed":case"ErrorContentDispositionHeaderNotValid":case"ErrorItemNameNotValid":case"ErrorResponseNotValid":return"GetItemsFailedInvalidResponse";case"ErrorRequestTimeout":return"GetItemsTimeout";case"ErrorFailedToFetch":case"ErrorRequestCanceled":case"ErrorConnectionLost":case"ErrorRequestFailed":return"GetItemsRequestFailed";case"ServerErrorFileDownloadStatusCodeNotFound":return"GetItemsFailedDownloadFile";case"ErrorFailedToLoadPresInfo":case"ErrorMissingClientWidthOrHeight":case"ErrorFailedToLoadSlide":case"ErrorFailedToParseSlideInfo":case"ErrorFailedToLoadSlideViewData":case"ErrorFailedToLoadShapeViewData":case"ErrorFailedToLoadResourceEntry":case"ErrorMissingEntriesInOptions":case"ErrorFailedToLoadSlideInfo":case"ErrorMissingSlideId":return"LoadFailed";case"ErrorResourceNotFound":case"ErrorResourceNotAllowed":case"ErrorResourceLoaderNotAvailable":return"ResourceLoaderFailed";case"FailedToRenderContextLost":case"FailedToRenderSBNotReady":case"FailedToRenderMissingSceneView":case"TexturesNotLoaded":case"MissingSceneView":case"TryPrepareTimeout":return"SlideVisualizationFailed";case"InvalidHiddenSlideInfo":return"EnsureSlideFailed"}return e}}class k{constructor(){k.getMemoryUsage()&&window.setInterval(k.logMemoryUsage,6e4)}static getMemoryUsage(){const e=window.performance;if(!e||!e.memory)return void d.a.sendTraceTag(587560398,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"performance.memory not supported");let t={heapLimit:e.memory.jsHeapSizeLimit,totalHeapSize:e.memory.totalJSHeapSize,usedHeapSize:e.memory.usedJSHeapSize};return navigator.deviceMemory&&(t.availableRAMInGB=navigator.deviceMemory),t}static logMemoryUsage(){const e=k.getMemoryUsage();e&&d.a.sendTraceTag(587560399,h.a.msoulscat_Wac_PptSlideshow,e.usedHeapSize/e.heapLimit>.8?c.a.Warning:c.a.Info,JSON.stringify(e))}}var R=i(70),O=i.n(R),L=i(63),F=i(38);class D{constructor(e){this.m_slideshowCore=e}injectInterface(e){}getEditMode(){return F.EditMode.None}getThemeBySlideId(e){return new F.AppForOfficeTheme}getDocumentUrl(){return""}async goToByIndex(e){if(null==this.m_slideshowCore||0===e.length)return F.ErrorCodeManager.errorCodes.ooeInternalError;let t=this.m_slideshowCore.getSlideLocation(),i=void 0;switch(e){case"previous":if(await this.m_slideshowCore.prevSlide(!1),i=this.m_slideshowCore.getSlideLocation(),t&&i&&t.slideIndex===i.slideIndex)return F.ErrorCodeManager.errorCodes.ooeNavOutOfBound;break;case"next":if(await this.m_slideshowCore.nextSlide(!1),i=this.m_slideshowCore.getSlideLocation(),t&&i&&t.slideIndex===i.slideIndex)return F.ErrorCodeManager.errorCodes.ooeNavOutOfBound;break;case"first":await this.m_slideshowCore.gotoFirstSlide(!0);break;case"last":await this.m_slideshowCore.gotoLastSlide(!0);break;default:let r=Number.parseInt(e,10)-1;if(Number.isNaN(r))return F.ErrorCodeManager.errorCodes.ooeInternalError;if(r<0||r>=this.m_slideshowCore.getSlideCount())return F.ErrorCodeManager.errorCodes.ooeNavOutOfBound;await this.m_slideshowCore.gotoSlide({slideIndex:r})}return F.ErrorCodeManager.errorCodes.ooeSuccess}async goToBySlide(e){let t=Number.parseInt(e,10);return null==this.m_slideshowCore||Number.isNaN(t)?F.ErrorCodeManager.errorCodes.ooeInternalError:t<0?F.ErrorCodeManager.errorCodes.ooeNavOutOfBound:(await this.m_slideshowCore.gotoSlide({slideId:{sid:t,cid:0}}),F.ErrorCodeManager.errorCodes.ooeSuccess)}async getSelectedSlides(){let e=void 0;if(!this.m_slideshowCore||!(e=this.m_slideshowCore.getSlideLocation()))return"";let t=e.slideIndex,i=e.slideId.sid;t+=1;let r=await this.m_slideshowCore.getSlideTitle(),n=[[i.toString(),r,t.toString()]];return JSON.stringify(n)}async setAddinSyncState(e){return this.m_slideshowCore.events.emit("slideAddinSyncStateEvent",e),F.ErrorCodeManager.errorCodes.ooeSuccess}async getAddinSyncState(e){}get requiredInterfaces(){return[]}}var B=i(44);class N{constructor(e){this.events=new o.EventEmitter,this.m_shouldPing=!1,this.m_pingLoopActive=!1,this.m_isPingHealthy=!0,this.m_isHealthy=!0,this.m_pingUrl=e,window.addEventListener("online",()=>{this.updateNetworkHealth()}),window.addEventListener("offline",()=>{this.updateNetworkHealth()})}get isHealthy(){return this.m_isHealthy}startPinging(){this.m_shouldPing&&this.m_pingLoopActive||(this.m_shouldPing=!0,this.runPingLoopAsync())}stopPinging(){this.m_shouldPing=!1}async runPingLoopAsync(){for(this.m_pingLoopActive=!0;this.m_shouldPing;){let e=!1,t=!1;const i=setTimeout(()=>{this.m_isPingHealthy=!1,t=!0},b.Settings.readNumberOrDefault("pingTimeoutMs",1e4));let r,n;try{r=await fetch(this.m_pingUrl,{cache:"no-cache"})}catch(t){e=!0}clearTimeout(i),this.m_isPingHealthy=!!r&&200===r.status&&!t&&!e,this.updateNetworkHealth(),n=this.m_isPingHealthy?b.Settings.readNumberOrDefault("pingIntervalMs",2e3):t?0:b.Settings.readNumberOrDefault("pingIntervalAfterFailureMs",200),await Object(B.waitMsAsync)(n)}this.m_pingLoopActive=!1}updateNetworkHealth(){const e=navigator.onLine&&this.m_isPingHealthy;e!==this.m_isHealthy&&(this.m_isHealthy=e,this.events.emit("isHealthyChanged",e),d.a.sendTraceTag(526399696,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,JSON.stringify({isHealthy:e,onLine:navigator.onLine,isPingHealthy:this.m_isPingHealthy})))}}var V=i(122);class U{constructor(e){this.m_isZooming=!1,this.m_zoomAnimClock=null,this.m_slideShowCore=e,this.resolvePromise=void 0,this.m_zoomSource=null;const t={zoomLevel:1,canvasCenterSlidePointPercent:{x:.5,y:.5}};this.m_startOpticalZoomState=t,this.m_targetOpticalZoomState=t}get zoomSource(){return this.m_zoomSource}get isZooming(){return this.m_isZooming}async animateZoomAsync(e,t,i,r,n){return new Promise(a=>{this.m_zoomAnimClock=new u.d;const s=this.m_slideShowCore.opticalZoomStateInfo.currentState.zoomLevel;this.m_isZooming=!0,this.resolvePromise=a,this.m_zoomSource=n||null,this.m_zoomAnimClock.events.on("tick",o=>{const l=this.m_slideShowCore.getSlideLocation();if(!i)return d.a.sendTraceTag(521491746,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,"OpticalZoomAnimationController::animateZoomAsync - viewController undefined."),void a();if(!l)return d.a.sendTraceTag(521491747,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,"OpticalZoomAnimationController::animateZoomAsync - current slide location undefined."),void a();try{const u=i.getBounds.getClientSizeFromCanvas(),f=Math.min(1,o/t),m=s+(e-s)*(.5-.5*Math.cos(2*Math.PI*(1-1/(f+1)))),p=r||u.scale(.5);let g=i.calculateCanvasCenterSlidePointPercentAfterZoom(p,m,l.slideId,this.m_slideShowCore.opticalZoomStateInfo.currentState);if(!g)return void a();if(isNaN(g.x)||isNaN(g.y))return this.finishZoomAnimation(),void d.a.sendTraceTag(520978770,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"OpticalZoomAnimationController::animateZoomAsync - Finishing zoom animation due to NaN");const _={zoomLevel:m,canvasCenterSlidePointPercent:g};if(this.m_slideShowCore.setOpticalZoomState({currentState:_,metadata:n?{source:n}:void 0}),b.Settings.readBooleanOrDefault("enableInkOpticalZoom",!1)){const e=i.getBounds.getBoundingClientRectFromCanvas(),t={width:e.width*m,height:e.height*m,zoomPositionX:p.x,zoomPositionY:p.y,containerSizeChanged:!1};this.m_slideShowCore.events.emit("updateCanvasZoom",t)}f>=1&&(this.stopZoomAnimation(),a())}catch(e){d.a.sendTraceTag(521414423,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,"OpticalZoomAnimationController::animateZoomAsync - "+e),this.stopZoomAnimation(),a()}}),this.m_zoomAnimClock.start()})}async animateZoomWithAnimationProgressEventsAsync(e,t,i,r){return new Promise(n=>{this.m_zoomAnimClock=new u.d,this.m_isZooming=!0,this.resolvePromise=n,this.m_zoomSource=r&&r.source?r.source:null,this.m_startOpticalZoomState=this.m_slideShowCore.opticalZoomStateInfo.currentState;let a=i.getBounds.getClientSizeFromCanvas(),s=r&&r.canvasZoomPositionInPixels?r.canvasZoomPositionInPixels:a.scale(.5);const o=this.calculateOpticalZoomStateAtTime(1,i,s);if(this.m_targetOpticalZoomState={zoomLevel:e,canvasCenterSlidePointPercent:{x:.5,y:.5}},o&&(this.m_targetOpticalZoomState=o),this.m_slideShowCore.setOpticalZoomState({currentState:this.m_slideShowCore.opticalZoomStateInfo.currentState,animationData:{startOpticalZoomState:this.m_startOpticalZoomState,targetOpticalZoomState:this.m_targetOpticalZoomState},metadata:r&&r.source?{source:r.source}:void 0}),o){if(window.matchMedia("(prefers-reduced-motion: no-preference)").matches)this.m_zoomAnimClock.events.on("tick",e=>{this.calculateNextZoomFrame(e,t,i,r&&r.canvasZoomPositionInPixels)}),this.m_zoomAnimClock.start();else if(this.finishZoomAnimation(),b.Settings.readBooleanOrDefault("enableInkOpticalZoom",!1)&&!b.Settings.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)){const e=i.getBounds.getBoundingClientRectFromCanvas(),t={width:e.width*o.zoomLevel,height:e.height*o.zoomLevel,zoomPositionX:s.x,zoomPositionY:s.y,containerSizeChanged:!1};this.m_slideShowCore.events.emit("updateCanvasZoom",t)}}else this.finishZoomAnimation()})}calculateNextZoomFrame(e,t,i,r){try{const n=Math.min(1,e/t),a=i.getBounds.getClientSizeFromCanvas(),s=r||a.scale(.5),o=this.calculateOpticalZoomStateAtTime(n,i,s);if(!o)return void this.finishZoomAnimation();if(this.m_slideShowCore.setOpticalZoomState({currentState:o,animationData:{startOpticalZoomState:this.m_startOpticalZoomState,targetOpticalZoomState:this.m_targetOpticalZoomState},metadata:this.m_zoomSource?{source:this.m_zoomSource}:void 0}),b.Settings.readBooleanOrDefault("enableInkOpticalZoom",!1)&&!b.Settings.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)){const e=i.getBounds.getBoundingClientRectFromCanvas(),t={width:e.width*o.zoomLevel,height:e.height*o.zoomLevel,zoomPositionX:s.x,zoomPositionY:s.y,containerSizeChanged:!1};this.m_slideShowCore.events.emit("updateCanvasZoom",t)}n>=1&&this.stopZoomAnimation()}catch(e){d.a.sendTraceTag(509093531,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,"OpticalZoomAnimationController::animateZoomAsync - "+e),this.stopZoomAnimation()}}calculateOpticalZoomStateAtTime(e,t,i){const r=this.m_slideShowCore.getSlideLocation();if(!t)return d.a.sendTraceTag(509093534,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,"OpticalZoomAnimationController::animateZoomAsync - viewController undefined."),null;if(!r)return d.a.sendTraceTag(509093533,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,"OpticalZoomAnimationController::animateZoomAsync - current slide location undefined."),null;const n=this.m_startOpticalZoomState.zoomLevel,a=n+(this.m_targetOpticalZoomState.zoomLevel-n)*(.5-.5*Math.cos(2*Math.PI*(1-1/(e+1))));let s=t.calculateCanvasCenterSlidePointPercentAfterZoom(i,a,r.slideId,this.m_slideShowCore.opticalZoomStateInfo.currentState);return s?isNaN(s.x)||isNaN(s.y)?(d.a.sendTraceTag(509093532,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"OpticalZoomAnimationController::animateZoomAsync - Finishing zoom animation due to NaN"),null):{zoomLevel:a,canvasCenterSlidePointPercent:s}:null}stopZoomAnimation(){return this.m_isZooming=!1,!!this.m_zoomAnimClock&&(this.m_zoomAnimClock.stop(),this.resolvePromise&&this.resolvePromise(),this.resolvePromise=void 0,this.m_zoomAnimClock=null,!0)}finishZoomAnimation(){return!!this.stopZoomAnimation()&&(b.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)?this.m_slideShowCore.setOpticalZoomState({currentState:{zoomLevel:this.m_targetOpticalZoomState.zoomLevel,canvasCenterSlidePointPercent:this.m_targetOpticalZoomState.canvasCenterSlidePointPercent},animationData:{startOpticalZoomState:this.m_startOpticalZoomState,targetOpticalZoomState:this.m_targetOpticalZoomState},metadata:this.m_zoomSource?{source:this.m_zoomSource}:void 0}):this.m_slideShowCore.zoomToAsync(1),!0)}}class W{constructor(e,t,i){this.m_pausedTimeMs=0,this.m_resumedTimeMs=0,this.m_maxTimeoutDurationMs=i?i.maxTimeoutDurationMs:void 0,this.m_callback=e,this.m_timeoutMs=t,this.m_startTimeMs=Date.now(),this.updateTimeout()}pause(){this.isPaused||(this.m_pausedTimeMs=Date.now(),this.updateTimeout())}resume(){this.isPaused&&(this.m_resumedTimeMs=Date.now(),this.m_timeoutMs+=this.m_resumedTimeMs-this.m_pausedTimeMs,this.updateTimeout())}setTime(e){this.isPaused&&(this.m_pausedTimeMs=Date.now()),this.m_timeoutMs=e+(Date.now()-this.m_startTimeMs),this.updateTimeout()}addTime(e){this.m_timeoutMs+=e,this.updateTimeout()}abort(){window.clearTimeout(this.m_timeoutId),this.m_callback=()=>{}}get isPaused(){return this.m_pausedTimeMs>this.m_resumedTimeMs}updateTimeout(){window.clearTimeout(this.m_timeoutId);const e=Math.min(this.m_maxTimeoutDurationMs||Number.POSITIVE_INFINITY,this.isPaused?Number.POSITIVE_INFINITY:this.m_timeoutMs);isFinite(e)&&(this.m_timeoutId=window.setTimeout(this.m_callback,e-(Date.now()-this.m_startTimeMs)))}}var z,G=i(112);class j{static recordInput(e){j.s_queuedRenderEvents.push({source:e,startTime:performance.now()})}static recordRender(){if(0===j.s_queuedRenderEvents.length)return;const e=performance.now(),t=b.Settings.readNumberOrDefault("actionToRenderTimeoutUntilLogMs",1e3);for(const i of j.s_queuedRenderEvents){const r=Math.round(e-i.startTime),n=j.s_sourceToAvgTimePerRenderMap.get(i.source);n?(n.timeToLog.setTime(t),n.inputToRenderTimesMs.push(r)):j.s_sourceToAvgTimePerRenderMap.set(i.source,{inputToRenderTimesMs:[r],timeToLog:new W(()=>{j.logInputToRenderTime(i.source)},t)})}j.s_queuedRenderEvents=[]}static logInputToRenderTime(e){const t=j.s_sourceToAvgTimePerRenderMap.get(e);t&&(d.a.sendTraceTag(509441479,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,JSON.stringify({source:e,actionToRenderTimes:t.inputToRenderTimesMs})),j.s_sourceToAvgTimePerRenderMap.delete(e))}}function H(e,t){e&&(t.meta_clientWidth=b.Settings.readNumberOrDefault("hackClientWidth",e.x),t.meta_clientHeight=b.Settings.readNumberOrDefault("hackClientHeight",e.y))}function q(e,t){if(!e||!e[0])return;let i=e[0];const r=e=>t.x>t.y?e.x:e.y,n=(e,t)=>Math.abs(r(e)-r(t));let a=n(i,t);for(let r of e)n(r,t)<a&&(a=n(r,t),i=r);return i}j.s_queuedRenderEvents=[],j.s_sourceToAvgTimePerRenderMap=new Map,function(e){e.InitPresInfo="initPresInfo",e.GotoSlideEnsureSlide="gotoSlideEnsureSlide",e.GotoSlideRenderSlide="gotoSlideRenderSlide",e.UpdateResourceProvidersPresInfo="updateResourceProvidersPresInfo",e.UpdateViewDataManager="updateViewDataManager",e.PrefetchEnsureSlide="prefetchEnsureSlide",e.GotoSlideRenderTransition="GotoSlideRenderTransition",e.CheckHidden="checkHidden"}(z||(z={}));let $,Z=!1;const X={};function Y(e){if(e.logger&&(d.a.setLogger(e.logger),J.logger=e.logger,!Z)){d.a.sendTraceTag(523531085,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore Version: 5.2.32, SVM Version: 9.19.68, SB Version: 1.7.33"),Object(L.a)();const t=e.logger;$=()=>{"flushOnClose"in t&&t.flushOnClose()},window.addEventListener("beforeunload",$),Z=!0}e.logger&&e.vetoSessionId&&f.VetoUtils.setVetoUtil({SessionId:e.vetoSessionId},e.logger),e.settings&&b.Settings.load(e.settings?e.settings.slideshowcore:{}),e.disabledChangeGates&&y.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.ssc=X),Object(s.e)(e),Object(l.c)({logger:e.logger,stringifyError:L.b})}class J{constructor(e,t,r,n,a){this.events=new o.EventEmitter,this.enableOpticalZoom=!1,this.prefetchWindowRange={first:-1,last:-1},this.m_isHandlingResourceInconsistent=!1,this.m_slideIdOrder=[],this.m_hiddenSlideIdOrder=[],this.m_currentTimelineStates=null,this.m_isAnimating=!1,this.m_isTransitioning=!1,this.m_blankSlideState="Hidden",this.m_contextIsLoaded=!1,this.m_cameoDetectedInPresentation=!1,this.m_cameoPresenceCache={},this.m_isCameoActive=!1,this.m_fMediaDetectedInPresentation=!1,this.m_slideRefreshNeeded=!1,this.m_networkHealthChangedEvents=[],this.m_source=1,this.m_updateResourceProvidersThrottler=new B.CriticalAsyncFunctionThrottler(this.updateResourceProvidersAsyncImplAsync.bind(this),J.updateResourceProvidersQueueHandler),this.m_ensureSlideViewElementThrottler=new B.ParallelCriticalAsyncFunctionThrottler(this.ensureSlideViewElementImplAsync.bind(this),B.executeAllQueueHandler,e=>JSON.stringify(e)),this.m_logger=r,window.exposed instanceof Object||(window.exposed={}),Y({logger:r,settings:n.slideShowCoreSettings.settings,disabledChangeGates:n.slideShowCoreSettings.disabledChangeGates,vetoSessionId:n.appSettings.userSessionId,exposed:window.exposed}),X.this=this,X.appVersion="5.2.32",X.svmVersion="9.19.68",X.sbVersion="1.7.33",X.settings=n.slideShowCoreSettings.settings,X.sessionId=n.appSettings.userSessionId,d.a.sendTraceTag(576021338,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,JSON.stringify({uintTest:b.Settings.readNumberOrDefault("uintTest",0),boolTest:b.Settings.readBooleanOrDefault("boolTest",!1),strTest:b.Settings.readStringOrDefault("strTest","")})),this.m_sessionSettings=n,m.a.init(n,"5.2.32","9.19.68","1.7.33"),m.a.logSessionStart(0),y.ChangeGate.isChangeGateEnabled("EnableNonStaticNavigationLogger")?(this.m_navigationLoggerNew=new S,this.m_navigationLoggerNew.init(n)):_.c.init(n),this.m_transitionResourceLoader=new g.TransitionResourceLoader(this.m_sessionSettings.slideShowCoreSettings.transitionResourceCDNPath,!0),this.m_sessionSettings.appSettings.jsScriptsBasePath&&""!==this.m_sessionSettings.appSettings.jsScriptsBasePath&&(i.p=this.m_sessionSettings.appSettings.jsScriptsBasePath),this.m_viewDataManager=new s.d(this.addClientSizeToLoader(t.slideViewData),this.addClientSizeToLoader(t.shapeViewData),t.localizedString),b.Settings.readBooleanOrDefault("enableSummaryZoom",!1)&&(this.m_zoomManager=new x(this.m_viewDataManager)),b.Settings.readBooleanOrDefault("enableAddinViewElement",!1)&&this.ensureAppForOfficeManager();const l=this.m_sessionSettings.bootMetrics&&this.m_sessionSettings.bootMetrics.startFromTime?this.m_sessionSettings.bootMetrics.startFromTime:0;this.m_viewControllerSettings={sessionId:this.m_sessionSettings.appSettings.userSessionId,editAudioEnabled:this.m_sessionSettings.slideShowCoreSettings.editAudioEnabled,transparentCanvasForVideoEnabled:b.Settings.readBooleanOrDefault("transparentCanvasForVideoEnabled",!0)&&!b.Settings.readBooleanOrDefault("forceSvg",!1)||!1,flipgridVideoEnabled:this.m_sessionSettings.slideShowCoreSettings.flipgridVideoEnabled||!1,tedVideoEnabled:this.m_sessionSettings.slideShowCoreSettings.tedVideoEnabled||!1,serverUrl:this.m_sessionSettings.appSettings.serverUrl,uiHost:this.m_sessionSettings.appSettings.uiHost||"",morphEnabled:b.Settings.readBooleanOrDefault("morphEnabled",!0),disabledChangeGates:this.m_sessionSettings.slideShowCoreSettings.disabledChangeGates||"",showCustomPlayButtonForVideo:this.m_sessionSettings.slideShowCoreSettings.showCustomPlayButtonForVideo,useNewYoutubePlayer:this.m_sessionSettings.slideShowCoreSettings.useNewYoutubePlayer||!1,useNewVimeoPlayer:this.m_sessionSettings.slideShowCoreSettings.useNewVimeoPlayer||!1,useOnlineVideoPlayer:this.m_sessionSettings.slideShowCoreSettings.useOnlineVideoPlayer||!1,stringifyError:L.b,settings:this.m_sessionSettings.slideShowCoreSettings.settings,jsScriptsBasePath:this.m_sessionSettings.appSettings.jsScriptsBasePath||"",applicationLcid:this.m_sessionSettings.appSettings.applicationLcid||"",startFromTime:l,initTime:this.m_sessionSettings.appSettings.initTime||0,hubbleVideoEndpoint:this.m_sessionSettings.appSettings.hubbleVideoEndpoint,acceptLanguage:this.m_sessionSettings.appSettings.acceptLanguage,isStream2Enabled:this.m_sessionSettings.slideShowCoreSettings.isStream2Enabled,teamsCallId:this.m_sessionSettings.appSettings.teamsCallId,isMultiSlideshowcoreEnabled:this.m_sessionSettings.slideShowCoreSettings.isMultiSlideshowcoreEnabled||!1,flights:this.m_sessionSettings.flights||{}},e.style.outline="none",this.m_container=e,y.ChangeGate.isChangeGateEnabled("EnableNonStaticNavigationLogger")&&a&&(this.m_source=a);const u="undefined"!=typeof PowerpointSlideshowStrings?PowerpointSlideshowStrings.SlideShowAccessibilityLabelCurrentSlidePane:"Current Slide Pane";if(this.m_container.setAttribute("aria-label",u),this.m_stateManager=new M(0,new w(e)),this.m_providers=t,this.m_lastRequestedSlideState={},window.addEventListener("beforeunload",()=>{this.flushSessionEndLogs()}),$&&window.removeEventListener("beforeunload",$),new k,b.Settings.readBooleanOrDefault("pingEnabled",!1)){if(b.Settings.readBooleanOrDefault("overrideAllTimeoutsForBoot",!1)){const e=b.Settings.readNumberOrDefault("AddedTimeoutTimeMs",13e4);e?setTimeout(()=>this.events.emit("networkHealthChanged",{isHealthy:!0,addTimeoutTimeMs:e}),0):setTimeout(async()=>{this.events.emit("networkHealthChanged",{isHealthy:!1,addTimeoutTimeMs:13e4}),await Object(B.waitMsAsync)(100),this.events.emit("networkHealthChanged",{isHealthy:!0,addTimeoutTimeMs:13e4})},0)}const e=`${this.m_sessionSettings.appSettings.serverUrl}/resources/${this.m_sessionSettings.appSettings.applicationLcid}/progress.gif`;this.m_networkHealthManager=new N(e),this.m_networkHealthManager.startPinging();const t=this.m_networkHealthManager;this.m_networkHealthManager.events.on("isHealthyChanged",()=>{0===this.m_networkHealthChangedEvents.length&&d.a.sendTraceTag(526237827,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,JSON.stringify({datetime:Date.now(),perf:performance.now()})),this.m_networkHealthChangedEvents.push({time:performance.now(),isHealthy:t.isHealthy});const e=t.isHealthy?0:b.Settings.readNumberOrDefault("AddedTimeoutTimeIfBadNetworkMs",13e4);b.Settings.readBooleanOrDefault("networkHealthChangedEventEnabled",!1)&&this.events.emit("networkHealthChanged",{isHealthy:t.isHealthy,addedTimeoutTimeIfBadNetworkMs:e})}),setTimeout(()=>{const e=[];let t=!0,i=0;for(let r of this.m_networkHealthChangedEvents)r.isHealthy!==t&&(r.isHealthy?(e.push({start:i,length:r.time-i}),i=0):i=r.time,t=r.isHealthy);i>0&&e.push({start:i,length:performance.now()-i}),d.a.sendTraceTag(526713538,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,JSON.stringify(JSON.stringify(e)))},5e4-performance.now())}this.m_opticalZoomStateInfo={currentState:{zoomLevel:b.Settings.readNumberOrDefault("minimumZoom",1),canvasCenterSlidePointPercent:new s.b(.5,.5)}},this.m_zoomAnimationController=new U(this)}addClientSizeToLoader(e){return{load:(t,i)=>{const r=this.addCommonResourceMetadata(i||{});return e.load(t,r)}}}endSession(e){this.setBlankSlideState("Black"),this.m_viewController&&(this.m_viewController.stopCrossSlideAudio(),this.m_viewController.cleanUpAccessibilityContainer()),this.m_cameoPresenceCache={},this.flushSessionEndLogs(e),this.events.emit("sessionEnded")}async init(){const e=Object(T.v4)(),t={correlationId:e};t[_.a.Init]={start:m.a.performanceNowTrimmed(),end:m.a.performanceNowTrimmed()},this.m_sessionSettings.bootMetrics&&(this.m_sessionSettings.bootMetrics.initSlideShowCoreTime=t[_.a.Init].start),t.getPresInfo={start:m.a.performanceNowTrimmed(),end:m.a.performanceNowTrimmed()},this.m_stateManager.setState(1);const i={slideLocation:this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation,isBootRequest:!0},r=await this.getPresInfoItem(e,_.a.Init,i);if(!r||!r.resource){const t=r&&r.metadata&&r.metadata.hasOwnProperty("errorName")?r.metadata.errorName:"ErrorFailedToLoadPresInfo";return"ServerErrorFileDownloadResourceInconsistent"===t?void d.a.sendTraceTag(541403220,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,"SlideShowCore::init - Failed to get PresInfo due to handling resource incosistent status"):(this.handleErrors({errorName:t},z.InitPresInfo),void d.a.sendTraceTag(593827929,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,`SlideShowCore::init - Failed to get PresInfo. correlation:${e}, ErrorName:${t}`))}let n,o;if(d.a.sendTraceTag(571332639,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::init - Got PresInfo. correlation:"+e),this.events.emit("bootStageChanged","InitViewController"),r&&r.metadata&&r.metadata.hasOwnProperty(_.c.GetItemsResult)&&(t[_.c.GetItemsResult]=r.metadata[_.c.GetItemsResult]),t.getPresInfo.end=m.a.performanceNowTrimmed(),this.m_viewController=new s.c(this.m_container,new s.b(r.resource.SlideEmuWidth,r.resource.SlideEmuHeight),this.m_viewDataManager,this.m_logger,this.m_viewControllerSettings,this.m_transitionResourceLoader,this.m_sessionSettings.appSettings.applicationLocaleName?this.m_sessionSettings.appSettings.applicationLocaleName:this.m_sessionSettings.appSettings.applicationLcid,this.m_appForOfficeManager),this.m_viewController.rendererEnvironment.glContext||b.Settings.readBooleanOrDefault("forceSvg",!1)||(d.a.sendTraceTag(555229313,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::SetupWebGLContextFailed - Switching renderingMode from webGL to SVG on boot"),b.Settings.addOrUpdateSetting(this.m_sessionSettings.slideShowCoreSettings.settings,"slideshowcore","forceSvg","true"),Y({logger:this.m_logger,settings:this.m_sessionSettings.slideShowCoreSettings.settings,disabledChangeGates:this.m_sessionSettings.slideShowCoreSettings.disabledChangeGates}),this.m_viewControllerSettings.transparentCanvasForVideoEnabled=b.Settings.readBooleanOrDefault("transparentCanvasForVideoEnabled",!0)&&!b.Settings.readBooleanOrDefault("forceSvg",!1)||!1,await this.updateResourceProviders(this.m_providers,{shouldResetProviders:!0}),this.m_viewController&&this.m_viewController.dispose(),this.m_viewController=new s.c(this.m_container,new s.b(r.resource.SlideEmuWidth,r.resource.SlideEmuHeight),this.m_viewDataManager,this.m_logger,this.m_viewControllerSettings,this.m_transitionResourceLoader,this.m_sessionSettings.appSettings.applicationLocaleName?this.m_sessionSettings.appSettings.applicationLocaleName:this.m_sessionSettings.appSettings.applicationLcid,this.m_appForOfficeManager)),await this.m_viewController.init(),y.ChangeGate.isChangeGateEnabled("SSC.SetMediaCommandScope")&&(this.m_sessionSettings.appSettings.initialSlideShowRole?this.m_viewController.mediaCommandScope=this.m_sessionSettings.appSettings.initialSlideShowRole===a.b.Presenter?2:1:this.m_viewController.mediaCommandScope=0),d.a.sendTraceTag(571332640,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::init - ViewController Initialized. "),this.m_contextIsLoaded=!0,this.m_viewController.rendererEnvironment.glContext&&this.m_viewController.events.on("renderingStageChanged",e=>this.events.emit("bootStageChanged",e)),this.m_viewController.events.on("webglcontextlost",()=>{if(this.m_contextIsLoaded=!1,!this.m_currentSlideLocation||!this.m_viewController)return void d.a.sendTraceTag(571332641,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`SlideShowCore::init - Raised event WebGLContext lost currentSlideLocation: ${!!this.m_currentSlideLocation}, viewController: ${!!this.m_viewController}. `);const e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);e&&e.animClock.pause(),this.pauseTransition()}),this.m_viewController.events.on("webglcontextrestored",()=>{if(this.m_contextIsLoaded=!0,!this.m_currentSlideLocation||!this.m_viewController)return void d.a.sendTraceTag(571332642,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`SlideShowCore::init - Raised event webglcontextrestored currentSlideLocation: ${!!this.m_currentSlideLocation}, viewController: ${!!this.m_viewController}. `);const e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);e&&e.animClock.resume(),this.resumeTransition(),this.setOpticalZoomState({currentState:J.s_defaultOpticalZoomState,metadata:{source:"webglcontextrestored"}}),this.events.emit("webglcontextrestored")}),this.m_viewController.events.on("restoreWebGLContextFailed",async()=>{await this.changeRenderingModeToSVG(),d.a.sendTraceTag(555229314,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::restoreWebGLContextFailed - Switching renderingMode from webGL to SVG midsession")}),this.m_viewController.events.on("glyphCacheFailed",()=>{this.m_slideRefreshNeeded=!0}),b.Settings.readBooleanOrDefault("avoidResizeObserverPolyfill",!1))try{n=new ResizeObserver(this.onResizeObservedAsync.bind(this))}catch(e){d.a.sendTraceTag(521164243,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"ResizeObserver not supported")}n||(n=new p.a(this.onResizeObservedAsync.bind(this))),n.observe(this.m_container),this.m_stateManager.setState(0);let l=void 0;if(b.Settings.readBooleanOrDefault("enableNoFirstVisibleSlideCallDuringInit",!1)){if(this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation&&(d.a.sendTraceTag(556847945,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::init - try to get targetSlideLocation from setting's startingSlideLocation."),o=this.resolvePartialSlideLocation(this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation)),!o){if(d.a.sendTraceTag(556847946,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,"SlideShowCore::init - no valid SlideLocation from setting, try to get first visible slide."),l=await this.getFirstVisibleSlideIndex(),l.hasOwnProperty("errorName"))return void d.a.sendTraceTag(556847947,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,`SlideShowCore::init - getFirstVisibleSlideResult return with error: ${l.errorName}, return from init.`);l[_.a.CheckHidden]&&(t[_.a.CheckHidden]=l[_.a.CheckHidden]),o=this.resolvePartialSlideLocation({slideId:l.slideId})}}else{if(l=await this.getFirstVisibleSlideIndex(),l.hasOwnProperty("errorName"))return void(y.ChangeGate.isChangeGateEnabled("TelemetryForBlackScreenIssue")&&d.a.sendTraceTag(507909345,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,`SlideShowCore::init - getFirstVisibleSlideResult return with error: ${l.errorName}.`));l[_.a.CheckHidden]&&(t[_.a.CheckHidden]=l[_.a.CheckHidden]),this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation&&(o=this.resolvePartialSlideLocation(this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation)||this.resolvePartialSlideLocation({slideId:l.slideId}))}if(this.m_lastRequestedSlideState={slideLocation:o,options:{animationState:this.m_sessionSettings.slideShowCoreSettings.startingAnimationState}},d.a.sendTraceTag(571332643,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::init - Begin GoToSlide. "),this.events.emit("bootStageChanged","GotoTargetSlide"),o){d.a.sendTraceTag(556847948,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`SlideShowCore::init - call gotoSlide with targetSlideLocation: ${JSON.stringify(o)}. `),t[_.a.Goto]={start:m.a.performanceNowTrimmed(),end:m.a.performanceNowTrimmed()};let e=this.m_sessionSettings.bootMetrics&&this.m_sessionSettings.bootMetrics.startFromTime?this.m_sessionSettings.bootMetrics.startFromTime:0;await this.gotoSlide(o,{animationState:this.m_sessionSettings.slideShowCoreSettings.startingAnimationState,actionContext:{navigationType:a.a.Init,startFromTime:e,bootMetrics:this.m_sessionSettings.bootMetrics}}),t[_.a.Goto].end=m.a.performanceNowTrimmed()}else{if(d.a.sendTraceTag(556847949,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::init - continue init without targetSlideLocation and try to use getFirstVisibleSlideResult."),!l)return void d.a.sendTraceTag(556847950,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,"SlideShowCore::init - getFirstVisibleSlideResult not valid.");const e=this.resolvePartialSlideLocation({slideId:l.slideId});if(e){const t=Object(T.v4)(),i=this.addCommonResourceMetadata({meta_correlationId:t,meta_isInit:!0});this.m_viewDataManager.getSlideViewData(e.slideId,i).then(i=>{i.resource&&this.m_viewController&&i.resource.slideSizePixels?(this.m_viewController.resizeViewContainer(this.m_opticalZoomStateInfo.currentState,i.resource.slideSizePixels),this.prefetchSlide(e,!0),this.events.emit("prefetchOnInit",e)):d.a.sendTraceTag(591734977,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,`SlideShowCore::init - Failed to get slideViewData. sid:${e.slideId.sid}, errorName:${i.metadata.errorName}, correlation:${t}`)})}}d.a.sendTraceTag(571332672,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::init - End GoToSlide. "),t[_.a.Init].end=m.a.performanceNowTrimmed(),y.ChangeGate.isChangeGateEnabled("EnableNonStaticNavigationLogger")?this.m_navigationLoggerNew&&this.m_navigationLoggerNew.recordInitData({correlationId:e,...t}):_.c.recordInitData({correlationId:e,...t})}async onResizeObservedAsync(e){for(const t of e)t.target.id===this.m_container.id&&await this.resizeAsync(0)}async resizeAsync(e){if(this.m_viewController&&(b.Settings.readBooleanOrDefault("forceSvg",!1)||this.m_contextIsLoaded)&&this.m_container.offsetParent){if(this.m_viewController.onResize(),this.m_currentSlideLocation){const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(t&&(this.m_viewController.resizeViewContainer(this.m_opticalZoomStateInfo.currentState,t.slideSizePixels),"Hidden"===this.m_blankSlideState)){t.fImageTextureLoaded||(d.a.sendTraceTag(520945794,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"ResizeObserver textures not loaded for current slide, reloading"),await this.m_viewController.ensureTextureLoaded(this.m_currentSlideLocation.slideId));const i=this.m_viewController.rendererEnvironment.canvas,r=this.m_viewController.getBounds.getClientSizeFromContainer(),n=this.m_viewController.getBounds.getClientSizeFromCanvas();d.a.sendTraceTag(575776400,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"ResizeObserver "+JSON.stringify({reRenderingSlideId:this.m_currentSlideLocation.slideId,containerSize:`${this.m_container.clientWidth}x${this.m_container.clientHeight}`,canvasSize:`${i.clientWidth}x${i.clientHeight}`,containerSizeCached:`${r.x}x${r.y}`,canvasSizeCached:`${n.x}x${n.y}`,isTiny:Math.min(n.x,n.y)<b.Settings.readNumberOrDefault("tinySizeForContainer",50)})),b.Settings.readBooleanOrDefault("useDirtyFlagForResize",!1)?(this.m_slideRefreshNeeded=!0,this.events.once("animatedContentStateChanged",()=>{this.onRenderAfterResize(e)})):(this.m_viewController.renderSlideById(this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState),this.onRenderAfterResize(e))}}this.events.emit("slideDimensionsChanged")}else d.a.sendTraceTag(575017310,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"Resize returning early, "+JSON.stringify({viewController:!!this.m_viewController,contextIsLoaded:this.m_contextIsLoaded,forceSVG:b.Settings.readBooleanOrDefault("forceSvg",!1),offsetParent:!!this.m_container.offsetParent}))}onRenderAfterResize(e){if(!this.m_viewController)return;const t=this.m_viewController.rendererEnvironment.canvas,i=this.m_viewController.getBounds.getClientSizeFromContainer(),r=this.m_viewController.getBounds.getClientSizeFromCanvas(),n=Math.min(r.x,r.y)<b.Settings.readNumberOrDefault("tinySizeForContainer",50);if(d.a.sendTraceTag(521164242,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"First render after resize "+JSON.stringify({containerSize:`${this.m_container.clientWidth}x${this.m_container.clientHeight}`,canvasSize:`${t.clientWidth}x${t.clientHeight}`,containerSizeCached:`${i.x}x${i.y}`,canvasSizeCached:`${r.x}x${r.y}`,isTiny:n})),0===e&&this.m_resizeAfterTinyCanvasTC&&(this.m_resizeAfterTinyCanvasTC.abort(),this.m_resizeAfterTinyCanvasTC=void 0),n){const t=b.Settings.readNumberOrDefault("maxRetriesForTinySize",0);e<t&&(this.m_resizeAfterTinyCanvasTC=new W(()=>{this.resizeAsync(e+1)},b.Settings.readNumberOrDefault("retryTimeoutForTinySizeMs",1e3)))}if(n){const t=b.Settings.readNumberOrDefault("tinySizeTimeout",4e3);this.m_tinyCanvasTooLongTC&&0===e?this.m_tinyCanvasTooLongTC.setTime(t):this.m_tinyCanvasTooLongTC=new W(()=>{d.a.sendTraceTag(520945793,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,`Canvas still tiny ${t}ms after last resize`)},t)}!n&&this.m_tinyCanvasTooLongTC&&(this.m_tinyCanvasTooLongTC.abort(),this.m_tinyCanvasTooLongTC=void 0)}async changeRenderingModeToSVG(e){d.a.sendTraceTag(555229315,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::changeRenderingModeToSVG - Switching renderingMode from webGL to SVG");const t=Date.now();b.Settings.addOrUpdateSetting(this.m_sessionSettings.slideShowCoreSettings.settings,"slideshowcore","forceSvg","true"),Y({settings:this.m_sessionSettings.slideShowCoreSettings.settings}),this.m_viewControllerSettings.transparentCanvasForVideoEnabled=b.Settings.readBooleanOrDefault("transparentCanvasForVideoEnabled",!0)&&!b.Settings.readBooleanOrDefault("forceSvg",!1)||!1,await this.updateResourceProviders(this.m_providers,{shouldResetProviders:!0,switchToSvg:!0});const i=e&&e.location?e.location:this.m_currentSlideLocation;i&&(this.m_viewDataManager.imageDataMap=new Map,await this.gotoSlide(i,{actionContext:{navigationType:a.a.Init},animationState:this.getAnimationState(!0),fForceRetry:!0,fForceNavigate:!0,fSkipTransition:!0,fSuppressNavigatedFromEvent:b.Settings.readBooleanOrDefault("enableSuppressingNavigatedFromEvent",!1)})),d.a.sendTraceTag(555229316,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`SlideShowCore::changeRenderingModeToSVG - Switched renderingMode from webGL to SVG in ${Date.now()-t} ms`),this.events.emit("renderingModeChangedToSVG")}ensureAppForOfficeManager(){if(this.m_appForOfficeManager||(this.m_appForOfficeManager=new F.AppForOfficeManager,this.m_appForOfficeManager.ApiFacade=new D(this),this.m_appForOfficeManager.events.on("frameTrustCheck",()=>{this.events.emit("frameTrustCheck")})),this.m_appForOfficeManager&&!this.m_appForOfficeManager.fInitialized()){const e={IsRtl:void 0!==this.m_sessionSettings.appSettings.isRtl&&this.m_sessionSettings.appSettings.isRtl,AppForOfficeAllowExternalMarketplace:b.Settings.readBooleanOrDefault("appForOfficeAllowExternalMarketplace",!0),AppLcid:this.m_sessionSettings.appSettings.applicationLcid&&this.m_sessionSettings.appSettings.applicationLcid.length>0?this.m_sessionSettings.appSettings.applicationLcid:"1033",AppUILocale:this.m_sessionSettings.appSettings.applicationLocaleName&&this.m_sessionSettings.appSettings.applicationLocaleName.length>0?this.m_sessionSettings.appSettings.applicationLocaleName:"en-US",AppForOfficeOmexBaseUrl:b.Settings.readStringOrDefault("appForOfficeOmexBaseUrl","https://store.office.com"),ServerUrl:this.m_sessionSettings.appSettings.serverUrl,AppForOfficeTrustUXIsEnabledForPowerPoint:b.Settings.readBooleanOrDefault("appForOfficeTrustUXIsEnabledForPowerPoint",!0),AppsForOfficePrivateCatalogEnabled:b.Settings.readBooleanOrDefault("appsForOfficePrivateCatalogEnabled",!0),UploadFileDevCatalogIsDisabled:b.Settings.readBooleanOrDefault("uploadFileDevCatalogIsDisabled",!1),AreThirdPartyAddInsAllowed:this.m_sessionSettings.appSettings.areThirdPartyAddInsAllowed||b.Settings.readBooleanOrDefault("areThirdPartyAddInsAllowed",!1),JsScriptsBasePath:this.m_sessionSettings.appSettings.jsScriptsBasePath,UiHost:this.m_sessionSettings.appSettings.uiHost,SlideShowRole:this.m_sessionSettings.appSettings.initialSlideShowRole,TeamsCallId:this.m_sessionSettings.appSettings.teamsCallId,TheWsaClient:this.m_sessionSettings.appSettings.theWsaClient,ExtLogger:this.m_logger,AppForOfficeContextActivationParameters:this.m_sessionSettings.appSettings.appForOfficeContextActivationParameters,CoreSettings:this.m_sessionSettings.slideShowCoreSettings.settings,AppsForOfficeAuthFactory:this.m_sessionSettings.appSettings.appForOfficeAuthFactory};this.m_appForOfficeManager.initialize(null,e)}}async getPresInfoItem(e,t,i){let r;const n={meta_correlationId:e,meta_requestInfo:{ActionType:t}};if(n.meta_filterHiddenSlideInfo=i&&i.isBootRequest,n.meta_includeSections=b.Settings.readBooleanOrDefault("enableSectionsData",!1),n.meta_isInit=t===_.a.Init,i?this.m_sessionSettings&&this.m_sessionSettings.slideShowCoreSettings&&this.m_sessionSettings.slideShowCoreSettings.usePresInfoFromClient&&i.isPresInfoFromClient?r=await this.m_providers.presInfo.load("",this.addCommonResourceMetadata(n)):(d.a.sendTraceTag(577065923,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`SlideShowCore::getPresInfoItem - slidelocation:${JSON.stringify(i.slideLocation)}, correlation:${e}`),r=await this.m_providers.presInfoAndSlideInfo.load(i.slideLocation?JSON.stringify(i.slideLocation):JSON.stringify({slideIndex:0}),this.addCommonResourceMetadata(n))):r=await this.m_providers.presInfo.load("",this.addCommonResourceMetadata(n)),!r||!r.resource)return r;if(r.resource.Sections&&(this.m_viewDataManager.sections=r.resource.Sections),r.resource.SlideShowProperties.Item){if(r.resource.SlideShowProperties.Item.start){const e=r.resource.SlideShowProperties.Item;this.m_slideIdOrder=r.resource.SlideOrder.slice(0,e.end-e.start)}else if(r.resource.SlideShowProperties.Item.sid){const e=r.resource.SlideShowProperties.Item;for(let t=0;t<e.sid.length;t+=1)this.m_slideIdOrder.push({sid:e.sid[t],cid:0})}}else this.m_slideIdOrder=r.resource.SlideOrder;return this.m_hiddenSlideIdOrder=r.resource.HiddenSlideOrder,i&&i.isBootRequest?this.m_viewDataManager.setSlideIdOrder(this.m_slideIdOrder):this.m_viewDataManager.setSlideIdOrderWithHidden(this.m_slideIdOrder,this.m_hiddenSlideIdOrder),m.a.recordSessionStats({SlideCount:this.m_slideIdOrder.length}),r}flushSessionEndLogs(e){y.ChangeGate.isChangeGateEnabled("EnableNonStaticNavigationLogger")?this.m_navigationLoggerNew&&this.m_navigationLoggerNew.logPerfData():_.c.logPerfData(),this.events.emit("logSessionEnd");const t=k.getMemoryUsage();if(t&&m.a.recordSessionStats(t),this.m_viewController){const e=this.m_viewController.getGpuMemory();m.a.recordSessionStats({gpuMemoryTotal:e.total,gpuMemoryImages:e.images,leaksPrevented:e.leaksPrevented})}m.a.logSessionEnd(e),"flushOnClose"in this.m_logger&&this.m_logger.flushOnClose()}addCommonResourceMetadata(e){let t=[],i=[],r=[];if(b.Settings.readBooleanOrDefault("enableSlideSizeAdjustToAvailableSize",!1))try{t=JSON.parse(b.Settings.readStringOrDefault("availableRenderSlideSizes","[]")),i=JSON.parse(b.Settings.readStringOrDefault("availableRenderSlideSizesLowConfigClient","[]")),r=JSON.parse(b.Settings.readStringOrDefault("availableRenderSlideSizesSlowNetworkClient","[]"))}catch(e){d.a.sendTraceTag(541868835,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,"addCommonResourceMetadata failed to parse availableRenderSlideSizes: "+e)}const n=e.meta_isInit;let a="FixedSize";this.m_sessionSettings.slideShowCoreSettings.enableSlideSizeAdjust?a="FlexibleSizeWithMinMax":b.Settings.readBooleanOrDefault("enableSlideSizeAdjustToAvailableSize",!1)&&(a="BucketedSize");const o=JSON.parse(b.Settings.readStringOrDefault("slideSizeDefault",'{"x":1504,"y":849}')),l=JSON.parse(b.Settings.readStringOrDefault("slideSizeMax",'{"x":1504,"y":849}')),u=JSON.parse(b.Settings.readStringOrDefault("slideSizeMin",'{"x":348,"y":261}'));return function(e,t,i,r,n,a,o,l,u,f,m,p,g){const _=b.Settings.readBooleanOrDefault("maxDPRForGetItemsEnabled",!1)?b.Settings.readNumberOrDefault("maxDPRForGetItems",5):5,v=Math.min(window.devicePixelRatio||1,_);let y=new s.b(t.x*v,t.y*v),S=!1;if(r){const e=function(){try{let e=null!=window.navigator?window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection:null;if(e){const t=null!=e.downlink?e.downlink:void 0;return d.a.sendTraceTag(538784080,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`SlideShowCore::getNetworkDownlink client network info - downlinkSpeed: ${t}Mbps`),t}}catch(e){d.a.sendTraceTag(538784081,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,"SlideShowCore::getNetworkDownlink network information API not supported by the browser")}}();S=!!e&&e/8<b.Settings.readNumberOrDefault("downlinkSpeedCutoffForSlowClientsMBps",.77)}const T=q(g,y);T&&(e.meta_clientWidthReduced=T.x,e.meta_clientHeightReduced=T.y);const w=q(g,{x:0,y:0});w&&r&&(e.meta_clientWidthMin=w.x,e.meta_clientHeightMin=w.y);let M=b.Settings.readNumberOrDefault("overrideDownloadTimeoutIfBadNetworkMs",0);switch(M>0&&r&&(e.meta_overrideDownloadTimeoutIfBadNetworkMs=M),i){case"FixedSize":H(u,e);break;case"FlexibleSizeWithMinMax":0!==y.x&&0!==y.y||!u?l&&o&&H({x:Math.min(Math.max(y.x,l.x),o.x),y:Math.min(Math.max(y.y,l.y),o.y)},e):H(u,e);break;case"BucketedSize":let t=f;r&&d.a.sendTraceTag(527485004,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,JSON.stringify({useSmallResolutionSizeForSlowNetworkClient:b.Settings.readBooleanOrDefault("useSmallResolutionSizeForSlowNetworkClient",!1),uiHost:n,DPR:window.devicePixelRatio,cappedDPR:v,useSmallResolutionSize:a,isSlowNetworkClient:S,specifiedSlideSize:y})),a&&(!b.Settings.readBooleanOrDefault("useSmallResolutionSizeForBootOnly",!1)||r)||S&&r&&b.Settings.readBooleanOrDefault("useSmallResolutionSizeForSlowNetworkClient",!1)?t=g:m&&(t=p),function(e,t,i,r){let n=q(e,i);n&&(H(n,t),r&&d.a.sendTraceTag(541868834,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,JSON.stringify({assignedWidth:n.x,assignedHeight:n.y,slideWidth:i.x,slideHeight:i.y})))}(t,e,y,r)}e.meta_clientWidth&&e.meta_clientHeight||H(y,e)}(e,this.m_viewController?this.m_viewController.getBounds.getClientSizeFromContainer():new s.b(this.m_container.clientWidth,this.m_container.clientHeight),a,n,this.m_sessionSettings.appSettings.uiHost,this.m_sessionSettings.slideShowCoreSettings.useSmallResolutionSize,l,u,o,t,b.Settings.readBooleanOrDefault("isLowConfigClient",!1),i,r),this.m_sessionSettings.slideShowCoreSettings.isHighContrast&&(e.meta_isHighContrast=!0),this.m_sessionSettings.slideShowCoreSettings.colorMode&&(e.meta_colorMode=this.m_sessionSettings.slideShowCoreSettings.colorMode),e.meta_translateLanguage=this.m_sessionSettings.slideShowCoreSettings.translateLanguage?this.m_sessionSettings.slideShowCoreSettings.translateLanguage:"",this.m_sessionSettings.slideShowCoreSettings.clientColorSettings&&(e.meta_clientColorSettings=this.m_sessionSettings.slideShowCoreSettings.clientColorSettings),b.Settings.readBooleanOrDefault("morphEnabled",!0)&&(e.meta_enableMorph=!0),e.meta_imageAppendOption=this.m_sessionSettings.slideShowCoreSettings.imageSettings?this.m_sessionSettings.slideShowCoreSettings.imageSettings.imageAppendOption:"embed",e.meta_enableClustering=!!this.m_sessionSettings.slideShowCoreSettings.imageSettings&&this.m_sessionSettings.slideShowCoreSettings.imageSettings.enableClustering,e.meta_enableSVGAsWebGLTexture=b.Settings.readBooleanOrDefault("enableSVGAsWebGLTexture",!0),e.meta_convertGifToVideo=!0===this.m_sessionSettings.slideShowCoreSettings.convertGifToVideo,b.Settings.readBooleanOrDefault("enableKnownGlyphsOptimization",!0)&&(e.meta_knownGlyphs=this.m_viewDataManager.glyphStore.knownGlyphsString),b.Settings.readBooleanOrDefault("enableRegionalFormattingOnBoot",!1)&&(e.meta_localeName=this.m_sessionSettings.appSettings.applicationLocaleName),e}updateLastRequestedSlideState(e){this.m_lastRequestedSlideState=e}async gotoSlideImpl(e,t){const i=t?t.actionContext:void 0;d.a.sendTraceTag(576979914,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`SlideShowCore::gotoSlide: currentSlideLocation:${JSON.stringify(this.m_currentSlideLocation)}, \n      slideState:${JSON.stringify(e)},\n      animationState:${JSON.stringify(t?t.animationState:"")},\n      skipTansition:${t?t.fSkipTransition:""},\n      fForceRetry:${t?t.fForceRetry:""},\n      fForceNavigate:${t?t.fForceNavigate:""},\n      fSuppressNavigatedFromEvent:${t?t.fSuppressNavigatedFromEvent:""},\n      fClearNavigationState:${t?t.fClearNavigationState:""}`),y.ChangeGate.isChangeGateEnabled("BundleGotoClearNavigation")&&t&&t.fClearNavigationState&&this.clearNavigationState(),i&&i.startFromTime&&(m.a.logSessionStart(i.startFromTime),f.VetoUtils.setVetoUtil({SessionId:this.m_sessionSettings.appSettings.userSessionId,StartFromTime:i.startFromTime},this.m_logger));let r=Object(T.v4)();const n={renderTransition:{},renderSlide:{},createTexture:{},id:r};if(b.Settings.readBooleanOrDefault("fixForLaunchFromCurrentSlideAfterRehydrate",!1)&&this.m_presInfoPromise&&(d.a.sendTraceTag(507855134,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,"SlideShowCore::gotoSlide: : m_presInfoPromise is not resolved yet."),await this.m_presInfoPromise),!this.m_viewController||1===this.m_stateManager.state||this.m_zoomAnimationController.isZooming||this.isTransitioning&&this.cancelTransition())return d.a.sendTraceTag(592483859,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,`SlideShowCore::gotoSlide returns early. m_viewController:${!!this.m_viewController}, \n          this.m_stateManager.state:${this.m_stateManager.state},\n          isInitialized:${!!m.a.getSessionStats("initDur")}, \n          bootMetrics:${!(!i||!i.bootMetrics)}, \n          navMetrics:${!(!i||!i.navMetrics)}, \n          isZooming:${this.m_zoomAnimationController.isZooming} due to ${this.m_zoomAnimationController.zoomSource},\n          this.isTransitioning:${this.isTransitioning}\n          navigationType:${i?i.navigationType:""}`),{fSucceeded:!1,error:"Skipped_Busy"};let o={};o[_.a.Goto]={start:m.a.performanceNowTrimmed()},o[_.b.EnsureSlideView]={start:m.a.performanceNowTrimmed()};const l=this.resolvePartialSlideLocation(e),u=!O()(l,this.m_currentSlideLocation),p=!(!i||i.navigationType!==a.a.Init),g=!(!t||!t.fForceNavigate)&&t.fForceNavigate,v=!(!t||!t.fSuppressNavigatedFromEvent)&&t.fSuppressNavigatedFromEvent,w=u||p||g,M=u||g;if(p&&(this.m_cameoPresenceCache={}),d.a.sendTraceTag(545886353,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::gotoSlide: "+JSON.stringify({shouldNavigate:w,targetSlideHasNewContent:M,isDifferentSlide:u,isInit:p,isForceNavigate:g,suppressNavigatedFromEvent:v})),l&&w){b.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&u&&(t&&t.fSkipTransition?(this.m_zoomAnimationController.stopZoomAnimation(),this.setOpticalZoomState({currentState:J.s_defaultOpticalZoomState,metadata:{source:"slideLocationChanged"}})):await this.zoomToAsync(1,void 0,{fAnimate:!0,source:"slideLocationChanged"})),M&&(this.m_currentSlideLocation&&this.onNavigatingFrom(this.m_currentSlideLocation.slideId),this.onNavigatingTo(l.slideId));const e=Object(T.v4)();o={...o,sid:l.slideId.sid,correlationId:e,step:this.m_currentSlideLocation?l.slideIndex-this.m_currentSlideLocation.slideIndex:0};let a=m.a.performanceNowTrimmed();this.m_stateManager.setState(1);const g=setTimeout(()=>{0!==m.a.startFrom&&i&&!i.bootMetrics&&f.VetoUtils.recordVeto("VetoedSlideShowNavTimeMs",{...o,reportTime:m.a.performanceNowTrimmed(),qosVeto:"SlideShowNavSlow"})},b.Settings.readNumberOrDefault("vetoNavigationDurationMs",1250)),w=await this.ensureSlideViewElementAsync(l.slideId,!0,e,_.a.Goto,p,i);if(clearTimeout(g),i&&i.navMetrics&&(o.navMetrics=i.navMetrics),y.ChangeGate.isChangeGateEnabled("SSLaunchRefactoredLaunchLogs")&&i&&i.additionalMetrics){const e=!i.additionalMetrics.isUpdateResourceProviderCalled&&i.additionalMetrics.isSlideCached;d.a.sendTraceTag(508067914,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,JSON.stringify({isSlideCached:e,isSlideCachedRaw:!!i.additionalMetrics.isSlideCached,isUpdateResourceProviderCalled:!!i.additionalMetrics.isUpdateResourceProviderCalled,id:i.id}))}this.handleErrors(w,z.GotoSlideEnsureSlide);const C=this.m_viewController.getSlideViewElement(l.slideId);if(this.m_isHandlingResourceInconsistent)d.a.sendTraceTag(541180366,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::gotoSlide: skip rendering due to handling resource incosistent status");else{if(!C)return d.a.sendTraceTag(593860625,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,`SlideShowCore::gotoSlide slideViewElement of targetSlideLocation is missing. Reverting to previous slide.\n          bootMetrics:${!(!i||!i.bootMetrics)},\n          navMetrics:${!(!i||!i.navMetrics)}`),this.m_stateManager.setState(0),this.m_currentSlideLocation&&M&&(this.onNavigatedFrom(this.m_currentSlideLocation.slideId),this.onNavigatedTo(this.m_currentSlideLocation.slideId)),{fSucceeded:!1,error:"Failed"};o[_.b.EnsureSlideView].end=m.a.performanceNowTrimmed(),o[_.b.ResizeViewContainer]={start:m.a.performanceNowTrimmed()},this.m_viewController.resizeViewContainer(this.m_opticalZoomStateInfo.currentState,C.slideSizePixels),o[_.b.ResizeViewContainer].end=m.a.performanceNowTrimmed(),this.setBlankSlideState("Hidden"),o[_.b.RenderTransition]={start:m.a.performanceNowTrimmed()};const u=this.m_container.contains(document.activeElement);let f,g;t&&t.fSkipTransition||!this.m_currentSlideLocation||(p&&this.events.emit("bootStageChanged","RenderingTransition"),f=await this.renderTransition(l,this.m_currentSlideLocation,{correlationId:e}),f&&this.handleErrors(f,z.GotoSlideRenderTransition)),this.m_stateManager.setState(0),o.spinnerDisplayTime=m.a.performanceNowTrimmed()-a,o[_.b.RenderTransition].end=m.a.performanceNowTrimmed(),o[_.b.RenderSlide]={start:m.a.performanceNowTrimmed()};let v=0;y.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(v=s.c.performanceNowTrimmed()),this.onBeforeFirstRenderAfterNavigation(C.slideId),y.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(n.renderSlide.preRenderEventDuration=s.c.performanceNowTrimmed()-v),d.a.sendTraceTag(575776401,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::gotoSlideImpl - Rendering SlideId: "+l.slideId.sid);let T=0;if(y.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(T=s.c.performanceNowTrimmed()),g=y.ChangeGate.isChangeGateEnabled("logRenderSnapshot")?this.m_viewController.renderSlideByIdCollectingPerfData(l.slideId,this.m_opticalZoomStateInfo.currentState,{isBoot:p,slideIndex:l.slideIndex,id:r,prefetchWindowRange:this.prefetchWindowRange,navType:i&&i.navigationType,step:this.m_currentSlideLocation?l.slideIndex-this.m_currentSlideLocation.slideIndex:0,navInitTimestamp:t&&t.navInitTimestamp}):this.m_viewController.renderSlideByIdCollectingPerfData(l.slideId,this.m_opticalZoomStateInfo.currentState,{isBoot:p}),y.ChangeGate.isChangeGateEnabled("AdditionalRenderingPerf")&&g&&g.hasOwnProperty("additionalPerfMeta")&&(g.additionalPerfMeta=void 0),y.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(n.renderSlide.renderSlideById=s.c.performanceNowTrimmed()-T),g&&g.hasOwnProperty("errorName")){if("TryPrepareTimeout"===g.errorName){p&&this.events.emit("bootStageChanged","SwitchingToSVG");let e=0;return y.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(e=s.c.performanceNowTrimmed()),window.setTimeout(()=>this.changeRenderingModeToSVG({location:l}),0),y.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(n.renderSlide.switchSVG=s.c.performanceNowTrimmed()-e),{fSucceeded:!1,error:"Failed"}}if("TexturesNotLoaded"===g.errorName){d.a.sendTraceTag(575193410,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`SlideShowCore::gotoSlideImpl - Before Reloading textures for SlideId: ${l.slideId.sid} RenderResult: ${JSON.stringify(g)}`),o[_.b.ReloadTexture]={start:m.a.performanceNowTrimmed()},p&&this.events.emit("bootStageChanged","ReEnsureTextureLoaded");let e=0;y.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(e=s.c.performanceNowTrimmed());const a=await this.m_viewController.ensureTextureLoaded(l.slideId);y.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(n.renderSlide.ensureTexture=s.c.performanceNowTrimmed()-e),o[_.b.ReloadTexture].end=m.a.performanceNowTrimmed();let u=0;y.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(u=s.c.performanceNowTrimmed()),g=y.ChangeGate.isChangeGateEnabled("logRenderSnapshot")?this.m_viewController.renderSlideByIdCollectingPerfData(l.slideId,this.m_opticalZoomStateInfo.currentState,{isBoot:p,slideIndex:l.slideIndex,id:r,prefetchWindowRange:this.prefetchWindowRange,navType:i&&i.navigationType,step:this.m_currentSlideLocation?l.slideIndex-this.m_currentSlideLocation.slideIndex:0,navInitTimestamp:t&&t.navInitTimestamp}):this.m_viewController.renderSlideByIdCollectingPerfData(l.slideId,this.m_opticalZoomStateInfo.currentState,{isBoot:p}),y.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(n.renderSlide.renderSlideById2=s.c.performanceNowTrimmed()-u),d.a.sendTraceTag(575193411,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`SlideShowCore::gotoSlideImpl - After Reloading textures for SlideId: ${l.slideId.sid} TextureLoadResult:${JSON.stringify(a)} RenderResult: ${JSON.stringify(g)}`)}}g&&g.hasOwnProperty("errorName")&&this.handleErrors(g,z.GotoSlideRenderSlide),u&&!b.Settings.readBooleanOrDefault("disableFocusCallAfterGoToSlide",!1)&&this.m_container.focus(),o[_.b.RenderSlide].end=m.a.performanceNowTrimmed(),o[_.a.Goto].end=m.a.performanceNowTrimmed(),y.ChangeGate.isChangeGateEnabled("SSEUPLBugTelemetry")&&i&&i.bootMetrics&&i.startFromTime&&0!==i.startFromTime&&d.a.sendTraceTag(508355610,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,"SlideShowCore::gotoSlide: New EUPL: "+(o[_.a.Goto].end-i.startFromTime));let I=[];w.hasOwnProperty("errorName")&&I.push(w.errorName),f&&f.hasOwnProperty("errorName")&&I.push(f.errorName),g&&g.hasOwnProperty("errorName")&&I.push(g.errorName);let P=I.length?{errorName:I}:{};y.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")&&(f&&f.hasOwnProperty("createTransition")&&f.createTransition.hasOwnProperty("rendererEnvironment")&&(f.createTransition.rendererEnvironment.hasOwnProperty(S.RenderTransitionTextures)&&(n.renderTransition.renderTransitionTextures=f.createTransition.rendererEnvironment[S.RenderTransitionTextures]),f.createTransition.rendererEnvironment.hasOwnProperty(S.GenerateMorphResource)&&(n.renderTransition.generateMorphResource=f.createTransition.rendererEnvironment[S.GenerateMorphResource]),f.createTransition.rendererEnvironment.hasOwnProperty(S.RenderToTexture)&&(n.renderTransition.renderToTexture=f.createTransition.rendererEnvironment[S.RenderToTexture])),w&&w.hasOwnProperty(S.TextureMetadata)&&(n.createTexture=w[S.TextureMetadata]),d.a.sendTraceTag(507834826,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,JSON.stringify(n))),y.ChangeGate.isChangeGateEnabled("EnableNonStaticNavigationLogger")?this.m_navigationLoggerNew&&this.m_navigationLoggerNew.recordNavData(this.m_viewController.viewDataManager,_.a.Goto,{sr:this.m_source,...y.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")?{id:n.id}:null,...this.m_stateManager.getTelemetry(),...w,...f,...g,...o,...P},i):_.c.recordNavData(this.m_viewController.viewDataManager,_.a.Goto,{sr:this.m_source,...y.ChangeGate.isChangeGateEnabled("SSCreatePerfTelemetry")?{id:n.id}:{},...this.m_stateManager.getTelemetry(),...w,...f,...g,...o,...P},i)}!M&&y.ChangeGate.isChangeGateEnabled("PreventNavEventForNoChangeInSlide")||(this.m_currentSlideLocation&&!v&&this.onNavigatedFrom(this.m_currentSlideLocation.slideId),this.onNavigatedTo(l.slideId)),this.m_currentTimelineStates=[],C&&(this.m_currentTimelineStates=C.animTimeline.getTimelineStates(!1)),d.a.sendTraceTag(577245973,h.a.msoulscat_Wac_PptSlideshow,l?c.a.Info:c.a.Error,`SlideShowCore::gotoSlide: reset global animationTimeline targetSlideLocation:${JSON.stringify(l)} currentSlideLocation:${JSON.stringify(this.m_currentSlideLocation)}, target SlideViewElement is null:${!C}`),this.m_currentSlideLocation=l,this.events.emit("slideLocationChanged",{actionContext:i})}else d.a.sendTraceTag(592229825,h.a.msoulscat_Wac_PptSlideshow,l?c.a.Info:c.a.Error,`SlideShowCore::gotoSlide: targetSlideLocation:${JSON.stringify(l)} currentSlideLocation:${JSON.stringify(this.m_currentSlideLocation)} slideState:${JSON.stringify(e)}`);return t&&t.animationState&&(this.gotoAnimationState(t.animationState),this.setBlankSlideState("Hidden")),d.a.sendTraceTag(540058966,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`SlideShowCore::gotoSlide: Sucessfully navigated to targetSlideLocation:${JSON.stringify(l)} currentSlideLocation:${JSON.stringify(this.m_currentSlideLocation)} slideState:${JSON.stringify(e)}`),{fSucceeded:!0}}async gotoSlide(e,t){const i=await this.gotoSlideImpl(e,t);let r=t&&t.fClearNavigationState;d.a.sendTraceTag(508078273,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,`SlideShowCore::gotoSlide:result:${i.fSucceeded},Navigation Type:${t&&t.actionContext?t.actionContext.navigationType:""}`);const n={slideLocation:e,options:t};if(this.m_networkHealthManager&&this.m_networkHealthManager.stopPinging(),i.error&&"Skipped_Busy"===i.error&&t&&t.fForceRetry){if(!this.fAreSlideStatesEqual(n,this.m_lastRequestedSlideState,r))return this.m_lastRequestedSlideStateResolveFunction&&(this.m_lastRequestedSlideStateResolveFunction({fSucceeded:!1,error:"Skipped_NewTarget"}),this.m_lastRequestedSlideStateResolveFunction=void 0),b.Settings.readBooleanOrDefault("updateLastRequestedSlideState",!0)||(this.m_lastRequestedSlideState={slideLocation:e,options:t}),await new Promise(async e=>{this.m_lastRequestedSlideStateResolveFunction=e})}else if(i.fSucceeded&&n&&this.m_lastRequestedSlideState&&n.slideLocation&&this.m_lastRequestedSlideState.slideLocation)if(this.fAreSlideStatesEqual(n,this.m_lastRequestedSlideState,r))this.m_lastRequestedSlideState={},this.m_lastRequestedSlideStateResolveFunction&&(this.m_lastRequestedSlideStateResolveFunction({fSucceeded:!0}),this.m_lastRequestedSlideStateResolveFunction=void 0);else try{d.a.sendTraceTag(577573152,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`goToSlide: Just went to ${n.slideLocation.slideIndex}, `+JSON.stringify(n.options?n.options.animationState:"")+". "+`Try to go to this.m_lastRequestedSlide: ${JSON.stringify(this.m_lastRequestedSlideState.slideLocation)}, `+JSON.stringify(this.m_lastRequestedSlideState.options?this.m_lastRequestedSlideState.options.animationState:"")),this.m_lastRequestedSlideState.options&&this.m_lastRequestedSlideState.options.actionContext&&this.m_lastRequestedSlideState.options.actionContext.navMetrics&&(this.m_lastRequestedSlideState.options.actionContext.navMetrics.isForceRetry=!0),this.gotoSlide(this.m_lastRequestedSlideState.slideLocation,this.m_lastRequestedSlideState.options)}catch(e){d.a.sendTraceTag(572057293,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,"goToSlide retry caught exception: "+e)}return i}fAreSlideStatesEqual(e,t,i){if(y.ChangeGate.isChangeGateEnabled("BundleGotoClearNavigation")&&i)return!1;if(!e.slideLocation&&!t.slideLocation)return!0;if(e.slideLocation&&t.slideLocation&&e.slideLocation.slideIndex===t.slideLocation.slideIndex&&e.slideLocation.slideId===t.slideLocation.slideId){if(!e.options&&!t.options)return!0;if(e.options&&t.options&&O()(e.options.animationState,t.options.animationState))return!0}return!1}handleErrors(e,t){const i=[];if(this.m_isHandlingResourceInconsistent){const i=e.hasOwnProperty("errorName")?e.errorName:"";d.a.sendTraceTag(541403222,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,`SlideShowCore::handleErrors - not triggering slideshow error due to handling resource inconsistent status. action:${t}, error:${i} `)}else{if(e.hasOwnProperty("errorName")){const r=e.errorName;let n=A.convertToSlideShowError(r);""===r&&(n=t+"EmptyError",e.errorName=n),"SlideVisualizationFailed"!==n&&("GetItemsFailedDownloadFile"===n?(this.events.emit("slideshowError",n),m.a.recordSessionStats({downloadFileFailed:"handleErrors-"+t})):(0!==m.a.startFrom&&t!==z.PrefetchEnsureSlide||t===z.InitPresInfo||t===z.CheckHidden)&&this.events.emit("slideshowError",n)),i.push({errorName:r,errorInfo:n})}if(e.hasOwnProperty("imgErrorName")){const t=e.imgErrorName;e.hasOwnProperty("errorName")||(e.errorName="IMG"+t),i.push({errorName:t,errorInfo:A.convertToSlideShowError(e.imgErrorName)})}if(e.hasOwnProperty("invalidImageIds")&&(d.a.sendTraceTag(556045641,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,`SlideShowCore::handleErrors. action:${t}, startFrom:${m.a.startFrom}, ${JSON.stringify(e)}`),i.push({errorName:"InvalidImages",errorInfo:e.invalidImageIds}),e.hasOwnProperty("errorName")||(e.errorName="InvalidImage"),e.invalidImageIds=""),e.hasOwnProperty("missingTextureIds")&&(d.a.sendTraceTag(556045642,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,`SlideShowCore::handleErrors. action:${t}, startFrom:${m.a.startFrom}, ${JSON.stringify(e)}`),i.push({errorName:"missingTextureIds",errorInfo:""}),e.hasOwnProperty("errorName")||(e.errorName="MissingTexture"),e.missingTextureIds=""),e.hasOwnProperty("invalidShapeIds")&&(d.a.sendTraceTag(556045643,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,`SlideShowCore::handleErrors. action:${t}, startFrom:${m.a.startFrom}, ${JSON.stringify(e)}`),i.push({errorName:"invalidShapeIds",errorInfo:""}),e.hasOwnProperty("errorName")||(e.errorName="InvalidShape"),e.invalidShapeIds=""),e.hasOwnProperty("axError")){const t=e.axError;i.push({errorName:"missingAccessabilityModel",errorInfo:t}),e.hasOwnProperty("errorName")||(e.errorName="AX"+t)}0!==m.a.startFrom&&i.length>0&&t!==z.PrefetchEnsureSlide&&(i.find(e=>"GetItemsFailedDownloadFile"===e.errorInfo)?f.VetoUtils.recordVeto("NavigationInterruption",{...e,qosVeto:"ContentRenderFailed"}):(e.hasOwnProperty("errorName")||(e.errorName=t+"EmptyError"),f.VetoUtils.recordVeto("ACE",{...e,action:t,qosVeto:"ContentRenderFailed"}))),i.length>0&&d.a.sendTraceTag(593757456,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,`SlideShowCore::handleErrors. action:${t}, startFrom:${m.a.startFrom}, ${JSON.stringify(i)}`),i.length>0&&i.find(e=>"GetItemsFailedDownloadFile"===e.errorInfo)||!m.a.getSessionStats("downloadFileFailed")||m.a.recordSessionStats({downloadFileFailed:"EnsureSlideViewElementSucceeded"})}}async updateSlideResources(e,t,i){const r={loadImagesGetSlideViewData:{start:m.a.performanceNowTrimmed(),end:m.a.performanceNowTrimmed()}},n=await this.m_viewDataManager.getSlideViewData(e.id);if(r.loadImagesGetSlideViewData.end=m.a.performanceNowTrimmed(),!n.resource||!this.m_viewController)return d.a.sendTraceTag(591734978,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,`SlideShowCore::updateSlideResources. missing slideViewData. slideViewData:${!!n.resource}, viewController:${!!this.m_viewController}, currentSlideLocation:${this.m_currentSlideLocation?this.m_currentSlideLocation.slideId.sid:""}`),n.metadata.hasOwnProperty("errorName")&&(r.errorName=n.metadata.errorName),r;const a=n.resource,s=a.resCat.filter(e=>""===e.url&&!e.name.startsWith("./getmedia.ashx"));if(!s||0===s.length)return r;let o=[],l=this.m_sessionSettings.slideShowCoreSettings.imageSettings&&this.m_sessionSettings.slideShowCoreSettings.imageSettings.maxImageCountPerRequest&&this.m_sessionSettings.slideShowCoreSettings.imageSettings.maxImageCountPerRequest>0?this.m_sessionSettings.slideShowCoreSettings.imageSettings.maxImageCountPerRequest:10;if(l=b.Settings.readNumberOrDefault("maxImageCountPerRequest",l),l<=0||l>=s.length)o.push(s);else{let e=s.slice(0);for(;e.length>0;)o.push(e.splice(0,l))}const u=[];for(const r of o){const n={meta_slideId:e.id,meta_resourceEntries:r,meta_correlationId:t,meta_isInit:i};this.addCommonResourceMetadata(n);for(const e of r)u.push(this.m_providers.imageData.load(e.id,n))}r.loadImages={start:m.a.performanceNowTrimmed(),end:m.a.performanceNowTrimmed()};const f=await Promise.all(u);r.loadImages.end=m.a.performanceNowTrimmed();const p=a.resCat.find(e=>""===e.url);if(p){r.missingResourceId=p.id;const e=new Set;f.forEach(t=>{t.metadata&&t.metadata.hasOwnProperty("errorName")&&e.add(t.metadata.errorName)}),0===e.size&&e.add("LoadFailed"),r.imgErrorName=Array.from(e),d.a.sendTraceTag(593847575,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,JSON.stringify(r))}return r}async renderTransition(e,t,i){if(e.slideId.cid===t.slideId.cid&&e.slideId.sid===t.slideId.sid)return;const r=this.m_viewController;if(!r)return;const n=e.slideIndex>=t.slideIndex,a={createTransition:{start:m.a.performanceNowTrimmed(),end:m.a.performanceNowTrimmed()}},s=await r.createTransition(e.slideId,t.slideId,n,i);return this.m_stateManager.setState(0),a.createTransition.end=m.a.performanceNowTrimmed(),y.ChangeGate.isChangeGateEnabled("SSCreateTransitionTelemetry")&&s.metadata&&(s.metadata.getSlideViewPerfInTransitionMS&&(a.createTransition.slideVInT=s.metadata.getSlideViewPerfInTransitionMS),s.metadata.rendererEnvironment&&(a.createTransition.rendererEnvironment=s.metadata.rendererEnvironment)),s.fSuccess?(s.effectId&&void 0!==s.isSupported&&m.a.recordSessionTransitionStats(s),a.metadata=["transition-"+s.effectId],a[_.c.PlayTransitionMs]={start:m.a.performanceNowTrimmed(),end:m.a.performanceNowTrimmed()},this.setTransitionState(!0,s),new Promise(e=>{const t=r.getTransitionController();if(!t)return this.setTransitionState(!1,s),void e(a);let i=-1;const n=()=>{"hidden"===document.visibilityState&&this.isTransitioning?i=window.setTimeout(()=>{r.finishTransition(),i=-1},t.duration-t.clock.currentTimeMs):window.clearTimeout(i)};t.clock.events.on("tick",async i=>(document.addEventListener("visibilitychange",n),this.setTransitionState(t.render(i),s),this.isTransitioning||(r.finishTransition(),e(a)),a)),t.clock.events.on("notRunning",async()=>{document.removeEventListener("visibilitychange",n),this.setTransitionState(!1,s),a[_.c.PlayTransitionMs].end=m.a.performanceNowTrimmed(),e(a)})})):(s.metadata&&s.metadata.hasOwnProperty("errorName")&&d.a.sendTraceTag(591734979,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,`SlideShowCore::renderTransition: create transition failed. from:${t.slideId.sid}, to:${e.slideId.sid}, effectId:${s.effectId}, isSupported:${s.isSupported}, errorName:${s.metadata?s.metadata.errorName:""}`),a)}isHiddenFromHiddenList(e){return this.m_hiddenSlideIdOrder.some(t=>t.sid===this.m_slideIdOrder[e].sid&&t.cid===this.m_slideIdOrder[e].cid)}async isHidden(e){let t=!1;if(b.Settings.readBooleanOrDefault("fixForSSLaunchAfterRehydrate",!1)&&this.m_presInfoPromise){d.a.sendTraceTag(507855133,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,"SlideShowCore::isHidden: : m_presInfoPromise is not resolved yet.");let e=await this.m_presInfoPromise;y.ChangeGate.isChangeGateEnabled("TelemetryForBlackScreenIssue")&&(t=!e||!e.resource)}const i=this.m_slideIdOrder[e];let r=this.m_viewDataManager.slideMetadataMap.get(i.sid);if(!r||void 0===r.isHidden){const e=await this.ensureSlideViewElementAsync(i,!1,Object(T.v4)(),_.a.CheckHidden,!1);r=this.m_viewDataManager.slideMetadataMap.get(i.sid),r&&void 0!==r.isHidden||(e.hasOwnProperty("errorName")||(e.errorName="InvalidHiddenSlideInfo"),d.a.sendTraceTag(576264263,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,`SlideShowCore::isHidden: invalid slideMetadata or undefined isHidden property after ensure SlideViewElement. slideMetadata:${!!r}, Sid:${i.sid}, presInfoFailed:${t}`)),this.handleErrors(e,z.CheckHidden)}return r?r.isHidden:void 0}getSlideLocation(){return this.m_currentSlideLocation||d.a.sendTraceTag(592229826,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,"SlideShowCore::getSlideLocation: Undefined m_currentSlideLocation"),this.m_currentSlideLocation}async nextSlide(e){if(!this.m_viewController||!this.m_currentSlideLocation||this.handleBlankSlideNavigation(!0)||1===this.m_stateManager.state||this.isTransitioning&&this.cancelTransition())return;let t;y.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&(t=Date.now());const i=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(!e||i&&i.animTimeline.hasTimelineFinished(u.e.MainTimelineId)){const e={};if(e[_.a.CheckHidden]={start:m.a.performanceNowTrimmed(),end:m.a.performanceNowTrimmed()},b.Settings.readBooleanOrDefault("enableSummaryZoom",!1))if(this.m_zoomManager&&this.m_zoomManager.needsToReturnOnNext(this.m_currentSlideLocation.slideId)){d.a.sendTraceTag(522311769,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::nextSlide - Zoom returning to parent");const e=this.m_zoomManager.nextReturnToParentId(this.m_currentSlideLocation.slideId);e&&await this.gotoSlide({slideId:e},{actionContext:{navigationType:a.a.Next},navInitTimestamp:t})}else{let r=this.m_currentSlideLocation,n=!1;if(this.m_zoomManager){let e;if(n=this.m_zoomManager.needsToJumpOnNext(this.m_currentSlideLocation.slideId),n){d.a.sendTraceTag(522311770,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::nextSlide - Zoom Jumping Slides");let t=this.m_zoomManager.slideWhereZoomLeftOff(this.m_currentSlideLocation.slideId);e=this.resolvePartialSlideLocation({slideId:t})}r=e||r}for(let s=r.slideIndex+1;s<this.m_slideIdOrder.length;s+=1){const r=await this.isHidden(s);if(void 0===r)return;if(!r){e[_.a.CheckHidden].end=m.a.performanceNowTrimmed();const r=this.resolvePartialSlideLocation({slideIndex:s});if(i&&this.m_zoomManager&&r){const e=i.getAllZoomsOnSlide();!this.m_zoomManager.zoomOnCurrentSlide(r.slideId,e,this.m_currentSlideLocation.slideId)&&n&&(d.a.sendTraceTag(522311771,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::nextSlide - matching zoom not detected on slide"),this.m_zoomManager.addSlide(r.slideId,this.m_currentSlideLocation.slideId,!1))}return void await this.gotoSlide({slideIndex:s},{actionContext:{navigationType:a.a.Next,navMetrics:e},navInitTimestamp:t})}}this.m_sessionSettings.slideShowCoreSettings.shouldDisableEndOfShow||this.setBlankSlideState("EndOfShow")}else{for(let i=this.m_currentSlideLocation.slideIndex+1;i<this.m_slideIdOrder.length;i+=1){const r=await this.isHidden(i);if(void 0===r)return;if(!r)return e[_.a.CheckHidden].end=m.a.performanceNowTrimmed(),void await this.gotoSlide({slideIndex:i},{actionContext:{navigationType:a.a.Next,navMetrics:e},navInitTimestamp:t})}this.m_sessionSettings.slideShowCoreSettings.shouldDisableEndOfShow||this.setBlankSlideState("EndOfShow")}}else if(i){const e=i.animTimeline.getTimelineStates(!1);if(!e)return;const t=e.filter(e=>e.timelineId===u.e.MainTimelineId)[0],r=i.animTimeline.getEndTime(u.e.MainTimelineId);if(!r)return;t.step=r.ClickNum+1,this.gotoAnimationState({timelineStates:[t]})}}async prevSlide(e){if(!this.m_currentSlideLocation||this.handleBlankSlideNavigation(!1)||1===this.m_stateManager.state||this.isTransitioning&&this.cancelTransition()||!this.m_viewController)return;let t;if(y.ChangeGate.isChangeGateEnabled("logRenderSnapshot")&&(t=Date.now()),b.Settings.readBooleanOrDefault("enableSummaryZoom",!1)&&this.m_zoomManager&&this.m_zoomManager.checkZoomGoBack(this.m_currentSlideLocation.slideId)){d.a.sendTraceTag(522311772,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::prevSlide - Zoom: different previous slide");const e=this.m_zoomManager.zoomGoBack(this.m_currentSlideLocation.slideId);e&&await this.gotoSlide({slideId:e},{actionContext:{navigationType:a.a.Prev},navInitTimestamp:t})}else{const i=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(!e||i&&0===i.animTimeline.getNumTimelineClicks(u.e.MainTimelineId)){const e={};e[_.a.CheckHidden]={start:m.a.performanceNowTrimmed(),end:m.a.performanceNowTrimmed()};for(let i=this.m_currentSlideLocation.slideIndex-1;i>=0;i-=1){const r=await this.isHidden(i);if(void 0===r)return;if(!r){await this.gotoSlide({slideIndex:i},{actionContext:{navigationType:a.a.Prev,navMetrics:e},navInitTimestamp:t});break}}}else i&&(i.animTimeline.resetTimeline(u.e.MainTimelineId),this.checkForAnimationStateChanges())}}async getFirstVisibleSlideIndex(){d.a.sendTraceTag(556847951,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore - call getFirstVisibleSlideIndex");const e={};e[_.a.CheckHidden]={start:m.a.performanceNowTrimmed(),end:m.a.performanceNowTrimmed()},e.slideId=this.m_slideIdOrder[0];for(let t=0;t<this.m_slideIdOrder.length;t+=1){const i=await this.isHidden(t);if(void 0===i)return e.errorName="invalidHiddenSlideInfo",e;if(!i){e.slideId=this.m_slideIdOrder[t];break}}return e[_.a.CheckHidden].end=m.a.performanceNowTrimmed(),e}async getLastVisibleSlideIndex(){const e={};e[_.a.CheckHidden]={start:m.a.performanceNowTrimmed(),end:m.a.performanceNowTrimmed()},e.slideId=this.m_slideIdOrder[this.m_slideIdOrder.length-1];for(let t=this.m_slideIdOrder.length-1;t>=0;t-=1){const i=await this.isHidden(t);if(void 0===i)return e.errorName="invalidHiddenSlideInfo",e;if(!i){e.slideId=this.m_slideIdOrder[t];break}}return e[_.a.CheckHidden].end=m.a.performanceNowTrimmed(),e}async gotoFirstSlideOptions(e,t){return await this.gotoFirstSlide(e,void 0,t)}async gotoFirstSlide(e,t,i){let r=i&&i.actionContext||t||{};r.navigationType||(r.navigationType=a.a.GoToFirst);let n,s={slideIndex:0};if(e){const e=await this.getFirstVisibleSlideIndex();if(e.hasOwnProperty("errorName"))return y.ChangeGate.isChangeGateEnabled("TelemetryForBlackScreenIssue")&&d.a.sendTraceTag(507909343,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,`SlideShowCore::gotoFirstSlide - getFirstVisibleSlideResult return with error: ${e.errorName}.`),{fSucceeded:!1,error:e.errorName};r.navMetrics=e[_.a.CheckHidden],s={slideId:e.slideId}}if(y.ChangeGate.isChangeGateEnabled("BundleGotoClearNavigation")){let e=i&&i.fClearNavigationState;n=await this.gotoSlide(s,{actionContext:r,fSkipTransition:!0,fClearNavigationState:e})}else n=await this.gotoSlide(s,{actionContext:r,fSkipTransition:!0});return n}async gotoLastSlide(e){let t={slideIndex:this.m_slideIdOrder.length-1};if(e){const e=await this.getLastVisibleSlideIndex();if(e.hasOwnProperty("errorName"))return;t={slideId:e.slideId}}await this.gotoSlide(t,{actionContext:{navigationType:a.a.GoToLast},fSkipTransition:!0})}getSlideCount(){return this.m_slideIdOrder.length}async refreshViewControllerSSC(){this.m_sessionSettings.slideShowCoreSettings.isMultiSlideshowcoreEnabled&&this.m_viewController&&(y.ChangeGate.isChangeGateEnabled("EnableTransitionStateReset")&&this.setTransitionState(!1),await this.m_viewController.refreshViewController())}clearNavigationState(){this.m_viewController&&this.m_viewController.clearNavigationState(),this.setBlankSlideState("Black");const e=b.Settings.readBooleanOrDefault("preventRenderingOldSlide",!1);this.m_viewController&&this.m_currentSlideLocation&&!e&&this.m_viewController.renderSlideById(this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState)}async invalidateProviderCacheBySlideID(e,t){if(t){const i={},r=this.addCommonResourceMetadata(i);let n=JSON.parse(t),a={sid:n.Sid,cid:n.Cid};return await e.invalidateSlideAsync(a,r)}}async updateResourceProviders(e,t){return await this.m_updateResourceProvidersThrottler.callAsync(e,t)}static updateResourceProvidersQueueHandler(e){return{nextArg:e.map(e=>e.args).reduce((e,t)=>{const i=[];i[0]=t[0];const r=e[1],n=t[1];return i[1]={shouldResetProviders:n&&n.shouldResetProviders,shouldRerenderSlide:r&&r.shouldRerenderSlide||n&&n.shouldRerenderSlide,switchToSvg:r&&r.switchToSvg||n&&n.switchToSvg},i}),handledRequests:e,remainingRequests:[]}}async updateResourceProvidersAsyncImplAsync(e,t){const i=t&&t.switchToSvg;t&&t.shouldResetProviders&&e.resetProviders(),t&&t.isCacheRetentionEnabled&&t.updateSlideShowCoreAfterLaunch||this.m_stateManager.setState(1),this.m_providers=e,this.m_viewDataManager=new s.d(this.addClientSizeToLoader(e.slideViewData),this.addClientSizeToLoader(e.shapeViewData),e.localizedString),b.Settings.readBooleanOrDefault("enableSummaryZoom",!1)&&(this.m_zoomManager=new x(this.m_viewDataManager));const r=Object(T.v4)(),n={slideLocation:b.Settings.readBooleanOrDefault("enableFetchSlideInfoForCurrentSlide",!1)&&t&&t.startSlideIndex?{slideIndex:t.startSlideIndex}:this.m_currentSlideLocation?this.m_currentSlideLocation:this.m_sessionSettings.slideShowCoreSettings.startingSlideLocation,isBootRequest:!1,isPresInfoFromClient:t&&t.isPresInfoFromClient},a=i?_.a.ChangeRenderingModeToSVG:_.a.UpdateResourceProviders;let o;if(b.Settings.readBooleanOrDefault("fixForSSLaunchAfterRehydrate",!1)?(this.m_presInfoPromise=this.getPresInfoItem(r,a,n),o=await this.m_presInfoPromise,this.m_presInfoPromise=void 0):o=await this.getPresInfoItem(r,a,n),b.Settings.readBooleanOrDefault("fixForLaunchFromCurrentSlideAfterRehydrate",!1)&&this.m_stateManager.setState(0),!o||!o.resource)return d.a.sendTraceTag(591734980,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,`SlideShowCore::updateResourceProviders - getPresInfo. correlation:${r}, errorName:${o.metadata.errorName}, actionType:${a}`),void this.handleErrors(o.metadata,i?z.InitPresInfo:z.UpdateResourceProvidersPresInfo);if(i&&(this.m_viewController&&this.m_viewController.dispose(),this.m_viewController=new s.c(this.m_container,new s.b(o.resource.SlideEmuWidth,o.resource.SlideEmuHeight),this.m_viewDataManager,this.m_logger,this.m_viewControllerSettings,this.m_transitionResourceLoader,this.m_sessionSettings.appSettings.applicationLocaleName?this.m_sessionSettings.appSettings.applicationLocaleName:this.m_sessionSettings.appSettings.applicationLcid),await this.m_viewController.init()),this.m_viewController){const e=this.m_sessionSettings.slideShowCoreSettings.translateLanguage;if(void 0!==e&&this.m_viewController.updateAccessibilityLanguage(e),t&&t.shouldRerenderSlide&&!t.fSetBlankSlideToBlack&&this.m_currentSlideLocation){const e=Object(T.v4)(),t=await this.ensureSlideViewElementAsync(this.m_currentSlideLocation.slideId,!0,e,_.a.UpdateResourceProviders,!1);let i;d.a.sendTraceTag(541180367,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`SlideShowCore::updateResourceProviders - ensureSlideViewElement. Correlation:${e}, ErrorName:${t&&t.hasOwnProperty("errorName")?t.errorName:""}`),i=this.m_viewController.renderSlideByIdCollectingPerfData(this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState),i&&i.hasOwnProperty("errorName")&&d.a.sendTraceTag(541180368,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,`SlideShowCore::updateResourceProviders - renderSlide return with error:${i.errorName}, sid:${i.hasOwnProperty("sid")?i.sid:""}`)}t&&t.fSetBlankSlideToBlack&&this.setBlankSlideState("Black");const i=Object(T.v4)(),r=this.addCommonResourceMetadata({meta_correlationId:i,fSkipRendering:t&&t.fSetBlankSlideToBlack}),n=await this.m_viewController.updateViewDataManager(this.m_viewDataManager,this.m_opticalZoomStateInfo.currentState,r);d.a.sendTraceTag(591734981,h.a.msoulscat_Wac_PptSlideshow,n.hasOwnProperty("errorName")?c.a.Error:c.a.Info,`SlideShowCore::updateResourceProviders - updateViewDataManager. Correlation:${i}, errorName:${n.errorName}, sid:${n.hasOwnProperty("sid")?n.sid:""}`),this.handleErrors(n,z.UpdateViewDataManager),n.hasOwnProperty("errorName")||(m.a.getSessionStats("downloadFileFailed")?m.a.recordSessionStats({downloadFileFailed:"UpdateResourceProvidersSucceeded"}):m.a.recordSessionStats({resourceProvidersUpdated:!0}))}if(b.Settings.readBooleanOrDefault("fixForLaunchFromCurrentSlideAfterRehydrate",!1)||this.m_stateManager.setState(0),!this.m_currentSlideLocation||t&&t.skipPrefetchSlides||(this.prefetchSlide({slideIndex:this.m_currentSlideLocation.slideIndex+1},!0),this.prefetchSlide({slideIndex:this.m_currentSlideLocation.slideIndex+2},!0),this.prefetchSlide({slideIndex:this.m_currentSlideLocation.slideIndex-1},!0),this.prefetchSlide({slideIndex:this.m_currentSlideLocation.slideIndex-2},!0)),this.m_viewController&&this.m_currentSlideLocation){const e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);e&&e.initMediaAfterSlideContentChanged()}}setBlankSlideState(e){if(this.m_blankSlideState===e||!this.m_viewController||!this.m_currentSlideLocation)return;switch(this.cancelTransition(),e){case"Black":if("EndOfShow"===this.m_blankSlideState)return;this.m_viewController.renderBlankSlide("black");break;case"White":if("EndOfShow"===this.m_blankSlideState)return;this.m_viewController.renderBlankSlide("white");break;case"EndOfShow":if(!this.m_sessionSettings.slideShowCoreSettings.endOfShowText)return;this.setOpticalZoomState({currentState:J.s_defaultOpticalZoomState,metadata:{source:"endOfShow"}}),this.m_viewController.renderBlankSlide("black",this.m_sessionSettings.slideShowCoreSettings.endOfShowText,"white"),this.m_viewController.stopCrossSlideAudio(),this.m_viewController.cleanUpAccessibilityContainer();break;default:d.a.sendTraceTag(575776402,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::setBlankSlideState - Rendering SlideId: "+this.m_currentSlideLocation.slideId),this.m_viewController.renderSlideById(this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState)}const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);t&&("Hidden"===e?t.animClock.resume():t.animClock.pause()),this.m_blankSlideState=e,this.events.emit("blankSlideStateChanged",e)}showLoadingSpinner(){this.m_viewController&&this.m_stateManager&&(d.a.sendTraceTag(508923985,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::showLoadingSpinner"),this.m_stateManager.setState(1))}hideLoadingSpinner(){this.m_viewController&&this.m_stateManager&&this.m_stateManager.setState(0)}async prefetchOnPodSessionRefresh(){if(b.Settings.readBooleanOrDefault("enablePrefetchOnRefreshPodSession",!1)){let e=await this.getFirstVisibleSlideIndex();if(e.hasOwnProperty("errorName"))return void(y.ChangeGate.isChangeGateEnabled("TelemetryForBlackScreenIssue")&&d.a.sendTraceTag(507909342,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,`SlideShowCore::prefetchOnPodSessionRefresh - getFirstVisibleSlideResult return with error: ${e.errorName}.`));let t=this.resolvePartialSlideLocation({slideId:e.slideId})||{slideIndex:0};this.events.emit("prefetchOnRefreshPodSession",t)}}handleBlankSlideNavigation(e){return"EndOfShow"===this.m_blankSlideState&&(e?this.events.emit("exitFromEndOfShow"):this.setBlankSlideState("Hidden"),!0)}gotoAnimationState(e){if(!this.m_currentSlideLocation||!this.m_viewController||1===this.m_stateManager.state)return;this.setBlankSlideState("Hidden");const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);t&&(t.animTimeline.setTimelineStates(e.timelineStates),null!=e.startTimeOffset&&t.animClock.start(e.startTimeOffset),this.checkForAnimationStateChanges())}getAnimationState(e){if(!this.m_currentSlideLocation||!this.m_viewController)return{timelineStates:[]};const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(!t)return{timelineStates:[]};const i=t.animTimeline.getTimelineStates(e)||[];return e?{timelineStates:i,startTimeOffset:t.animClock.currentTimeMs}:{timelineStates:i}}async nextStep(e,t){if(d.a.sendTraceTag(576979915,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`SlideShowCore::nextStep: CurrentSlideLocation:${JSON.stringify(this.m_currentSlideLocation)},\n       timelineId:${e}; source: ${t}`),!this.m_currentSlideLocation||!this.m_viewController||this.handleBlankSlideNavigation(!0)||this.isTransitioning&&this.cancelTransition()||1===this.m_stateManager.state)return void d.a.sendTraceTag(576979916,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,`SlideShowCore::nextStep returns early. m_viewController:${!!this.m_viewController}, \n          this.m_stateManager.state:${this.m_stateManager.state}, \n          this.isTransitioning:${this.isTransitioning}`);const i=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);i&&(e===u.e.MainTimelineId&&i.animTimeline.hasTimelineFinished(e)&&(1!==t||i.fOnMouseClickAdvance)?await this.nextSlide(J.c_preferFullyBuilt):e!==u.e.MainTimelineId&&i.animTimeline.hasTimelineFinished(e)?(i.animTimeline.resetTimeline(e),i.animTimeline.addTimelineClick(e),this.checkForAnimationStateChanges(),4!==t&&this.events.emit("stopAutoAdvance")):(i.animTimeline.addTimelineClick(e),this.checkForAnimationStateChanges(),4!==t&&this.events.emit("stopAutoAdvance")))}async prevStep(e,t){if(d.a.sendTraceTag(576979917,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`SlideShowCore::prevStep: CurrentSlideLocation:${JSON.stringify(this.m_currentSlideLocation)},\n       timelineId:${e}; source: ${void 0!==t?t:"None"}`),!this.m_currentSlideLocation||!this.m_viewController||this.handleBlankSlideNavigation(!1)||this.isTransitioning&&this.cancelTransition()||1===this.m_stateManager.state)return void d.a.sendTraceTag(576979918,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,`SlideShowCore::prevStep returns early. m_viewController:${!!this.m_viewController}, \n          this.m_stateManager.state:${this.m_stateManager.state}, \n          this.isTransitioning:${this.isTransitioning}`);const i=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);i&&(e===u.e.MainTimelineId&&0===i.animTimeline.getNumTimelineClicks(e)?await this.prevSlide(J.c_preferFullyBuilt):(i.animTimeline.removeTimelineClick(e),this.checkForAnimationStateChanges()))}playMedia(e){if(!this.m_viewController||!this.m_currentSlideLocation)return;const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);t&&t.updateMediaViewElement(e,1)}pauseMedia(e){if(!this.m_viewController||!this.m_currentSlideLocation)return;const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);t&&t.updateMediaViewElement(e,0)}seekMedia(e,t){if(!this.m_viewController||!this.m_currentSlideLocation)return;const i=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);i&&i.updateMediaViewElement(e,3,t)}getMediaNamesBySlideIndex(e){if(!this.m_viewController||this.m_slideIdOrder.length<=e)return;const t=this.m_viewController.getSlideViewElement(this.m_slideIdOrder[e]);return t?t.getMediaNamesOnSlide():void 0}async isMediaPresentInSlide(e){if(!this.m_viewController||this.m_slideIdOrder.length<=e)return;const t=this.m_viewController.getSlideViewElement(this.m_slideIdOrder[e]);return t?await t.isMediaPresentInSlideAsync():void 0}getMediaInfo(e){if(!this.m_viewController||!this.m_currentSlideLocation)return;const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);return t?t.getMediaInfo(e):void 0}updateMediaState(e,t){let i=`Blocking - ${this.m_viewController?"m_currentSlideLocation":"m_viewController"} undefined`;if(this.m_viewController&&this.m_currentSlideLocation){const r=void 0!==t?t.slideId:this.m_currentSlideLocation.slideId,n=this.m_viewController.getSlideViewElement(r);if(i=n?"Passing to SlideViewElement":"Blocking - SlideViewElement undefined",n)return V.a.updateMediaSyncMetadataAndLog(i,"SlideShowCore",e),void n.updateMediaState(e)}V.a.updateMediaSyncMetadataAndLog(i,"SlideShowCore",e)}setAddinSyncState(e){this.m_appForOfficeManager?this.m_appForOfficeManager.updateAddinSyncState(e):d.a.sendTraceTag(520426954,h.a.msoulscat_Wac_PptSlideshow,c.a.Error,"SlideShowCore::setAddinSyncState: recieving addin sync state before AppForOfficeManager initialized.")}setVideoPlayButtonVisibility(e){if(!this.m_viewController||!this.m_currentSlideLocation)return;const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);t&&t.updateVideoPlayButtonVisibility(e)}setMediaCommandScope(e){this.m_viewController&&(this.m_viewController.mediaCommandScope=e)}restoreFocus(){this.m_container.focus()}static preloadShaders(){const e=document.createElement("canvas"),t=b.Settings.readBooleanOrDefault("webgl2Enabled",!1)&&e.getContext("webgl2")||e.getContext("webgl")||e.getContext("experimental-webgl");return!!t&&(s.c.preloadShaders(t),!0)}getCurrentSlideDimensions(){return this.m_viewController?this.m_viewController.getSlideDimensions():void 0}getCurrentSlideViewBounds(){return this.m_viewController?this.m_viewController.getSlideViewBounds():void 0}async prefetchSlide(e,t=!1,i){const r=this.resolvePartialSlideLocation(e);if(!r||!this.m_viewController)return;const n=Object(T.v4)(),a={};a[_.a.Prefetch]={start:m.a.performanceNowTrimmed(),end:m.a.performanceNowTrimmed()};const s=await this.ensureSlideViewElementAsync(r.slideId,!1,n,_.a.Prefetch,!1);this.handleErrors(s,z.PrefetchEnsureSlide);const o=i&&i.source?i.source:"unknown";y.ChangeGate.isChangeGateEnabled("TelemetryForPrefetchFailure")&&s.hasOwnProperty("errorName")&&d.a.sendTraceTag(507779139,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,`SlideShowCore::prefetchSlide - ensureSlideResult return with error: ${s.errorName} at SlideLocation:${r} during prefetch at:${o}.`);let l={};if(t&&!this.isHiddenFromHiddenList(r.slideIndex)&&!s.hasOwnProperty("errorName")){a[_.a.Prerender]={start:m.a.performanceNowTrimmed(),end:m.a.performanceNowTrimmed()},l=await this.m_viewController.ensureTextureLoaded(r.slideId,{isPrefetch:!0});const e=this.resolvePartialSlideLocation({slideIndex:r.slideIndex-1});await this.m_viewController.preRenderSlideById(r.slideId,e?e.slideId:void 0),a[_.a.Prerender].end=m.a.performanceNowTrimmed()}this.emitIfCameoDetected(r.slideIndex),await this.emitIfMediaDetected(r.slideIndex),a[_.a.Prefetch].end=m.a.performanceNowTrimmed(),y.ChangeGate.isChangeGateEnabled("EnableNonStaticNavigationLogger")?this.m_navigationLoggerNew&&this.m_navigationLoggerNew.recordNavData(this.m_viewController.viewDataManager,_.a.Prefetch,{sid:r.slideId.sid,correlationId:n,sr:this.m_source,...s,...l,...a}):_.c.recordNavData(this.m_viewController.viewDataManager,_.a.Prefetch,{sr:this.m_source,sid:r.slideId.sid,correlationId:n,...s,...l,...a})}async getSlideShowTimings(e){const t=this.addCommonResourceMetadata({meta_correlationId:Object(T.v4)()}),i=(await this.m_providers.slide.load(JSON.stringify(e.slideId),t)).resource;return i?i.ssTimes:void 0}async getSlideTitle(){let e="";if(this.m_currentSlideLocation){const t=await this.m_viewDataManager.getSlideViewData(this.m_currentSlideLocation.slideId);t.resource&&t.resource.accessibilityModelPromise&&(e=(await t.resource.accessibilityModelPromise).slideTitleString)}return e}get isAnimating(){return this.m_isAnimating}setIsAnimating(e){e!==this.m_isAnimating&&(this.m_isAnimating=e,this.m_viewController&&(this.m_viewController.isAnimating=this.m_isAnimating)),this.events.emit("animationStateChanging",{isAnimating:this.m_isAnimating,metadata:{isGpuHardwareDisabled:s.c.s_gpuHardwareDisabled,rendererTech:s.c.s_rendererTech,isBadGPU:s.c.s_isBadGpu,isSvg:b.Settings.readBooleanOrDefault("forceSvg",!1),isGlyphCacheDisabled:s.c.s_isGlyphCacheDisabled,scale:J.getScaleForAnimations(),hostExperience:this.m_sessionSettings.appSettings.hostExperience}})}get isCameoActive(){return this.m_isCameoActive}set isCameoActive(e){e!==this.m_isCameoActive&&(this.m_isCameoActive=e,e||(this.m_slideRefreshNeeded=!0))}isMediaPlaying(){if(!this.m_viewController||!this.m_currentSlideLocation)return!1;const e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);return null!==e&&e.isMediaPlayingOnSlideCanvas()}setTransitionState(e,t){e!==this.m_isTransitioning&&(this.m_isTransitioning=e,this.m_viewController&&(this.m_viewController.isTransitioning=this.m_isTransitioning));const i=t||{};i.isGpuHardwareDisabled=s.c.s_gpuHardwareDisabled,i.rendererTech=s.c.s_rendererTech,i.isBadGPU=s.c.s_isBadGpu,i.isGlyphCacheDisabled=s.c.s_isGlyphCacheDisabled,i.isSvg=b.Settings.readBooleanOrDefault("forceSvg",!1),i.hostExperience=this.m_sessionSettings.appSettings.hostExperience,this.events.emit("slideLocationChanging",{isTransitioning:this.m_isTransitioning,metadata:i})}get isTransitioning(){return this.m_isTransitioning}async ensureSlideViewElementAsync(e,t,i,r,n,a){return await this.m_ensureSlideViewElementThrottler.callAsync(e,t,i,r,n,r===_.a.Prefetch,a)}registerMediaEventHandlers(e){e.on("mediaPlayed",e=>{this.events.emit("slideMediaEvent",e)}),e.on("mediaPaused",e=>{this.events.emit("slideMediaEvent",e)}),e.on("mediaSeeked",e=>{this.events.emit("slideMediaEvent",e)}),e.on("mediaVolumeChanged",e=>{this.events.emit("slideMediaEvent",e)}),e.on("mediaEnded",e=>{this.events.emit("slideMediaEvent",e)}),e.on("aadTokenRequest",e=>{this.events.emit("aadTokenRequest",e)}),e.on("mediaInitState",e=>{this.events.emit("mediaInitState",e)}),e.on("userMediaAction",e=>{this.events.emit("userMediaAction",e)})}async ensureSlideViewElementImplAsync(e,t,i,r,n,o,l){if(!this.m_viewController)return{};let f,p=this.m_viewController.getSlideViewElement(e);if(p&&r!==_.a.UpdateResourceProviders){t&&!p.fImageTextureLoaded&&(f=await this.m_viewController.ensureTextureLoaded(e,{isPrefetch:o}));const r={slideId:e.sid,correlation:i},n=this.m_providers.slide.getLoadResultInCache(JSON.stringify(e));return n&&n.resource?(r[_.c.CachedInServer]=!(!n.hasOwnProperty("metadata")||!n.metadata.hasOwnProperty(_.c.CachedInServer))&&n.metadata[_.c.CachedInServer],r[_.c.RequestInfo]=n.hasOwnProperty("metadata")&&n.metadata.hasOwnProperty(_.c.RequestInfo)?n.metadata[_.c.RequestInfo]:void 0,r[_.c.GetItemsResult]=n.hasOwnProperty("metadata")&&n.metadata.hasOwnProperty(_.c.GetItemsResult)?n.metadata[_.c.GetItemsResult]:void 0,d.a.sendTraceTag(574919713,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`SlideShowCore::ensureSlideViewElement: slideViewElement exists, fLoadTexture:${t}, fImageTextureLoaded:${p.fImageTextureLoaded}.`),y.ChangeGate.isChangeGateEnabled("SSLaunchRefactoredLaunchLogs")&&l&&l.additionalMetrics&&(l.additionalMetrics.isSlideCached=!0),{...r,...f}):(n&&n.metadata&&n.metadata.hasOwnProperty("errorName")&&(r.errorName=n.metadata.errorName),d.a.sendTraceTag(540587299,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,JSON.stringify(r)),{...r,...f})}const g={loadSlide:{start:m.a.performanceNowTrimmed(),end:m.a.performanceNowTrimmed()},slideId:e.sid,correlation:i},v={meta_correlationId:i};r===_.a.Prefetch&&b.Settings.readBooleanOrDefault("enableSequentialGetItems",!1)&&(v.meta_priorityHint=1),v.meta_requestInfo={ActionType:r},v.meta_isInit=n;const S=this.addCommonResourceMetadata(v);y.ChangeGate.isChangeGateEnabled("SSLaunchRefactoredLaunchLogs")&&l&&l.additionalMetrics&&(l.additionalMetrics.isSlideCached=this.m_providers.isSlideCached(JSON.stringify(e)));const T=await this.m_providers.slide.load(JSON.stringify(e),S);if(g.loadSlide.end=m.a.performanceNowTrimmed(),!T||!T.resource)return T&&T.metadata&&T.metadata.hasOwnProperty("errorName")&&(g.errorName=T.metadata.errorName),d.a.sendTraceTag(593847576,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,JSON.stringify(g)),g;T.metadata.axErrorName&&(g.axError=T.metadata.axErrorName),g[_.c.CachedInServer]=!(!T.hasOwnProperty("metadata")||!T.metadata.hasOwnProperty(_.c.CachedInServer))&&T.metadata[_.c.CachedInServer],g[_.c.RequestInfo]=T.hasOwnProperty("metadata")&&T.metadata.hasOwnProperty(_.c.RequestInfo)?T.metadata[_.c.RequestInfo]:void 0,g[_.c.GetItemsResult]=T.hasOwnProperty("metadata")&&T.metadata.hasOwnProperty(_.c.GetItemsResult)?T.metadata[_.c.GetItemsResult]:void 0,g.loadSlideViewData={start:m.a.performanceNowTrimmed(),end:m.a.performanceNowTrimmed()};const w=await this.m_viewDataManager.getSlideViewData(T.resource.id);if(!w.resource)return w.metadata.hasOwnProperty("errorName")&&(g.errorName=w.metadata.errorName),d.a.sendTraceTag(589910426,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,JSON.stringify(g)),{...g,...w};let M=w.resource;M&&M.transData&&this.m_transitionResourceLoader.load(M.transData.type),g.loadSlideViewData.end=m.a.performanceNowTrimmed();let C={};if(b.Settings.readBooleanOrDefault("enableUpdateSlideResources",!0)&&(C=await this.updateSlideResources(T.resource,i,n)),p=this.m_viewController.getSlideViewElement(T.resource.id),p&&r!==_.a.UpdateResourceProviders)return!t&&p.fImageTextureLoaded||(f=await this.m_viewController.ensureTextureLoaded(T.resource.id,{isPrefetch:o})),{...g,...C,...f};const P=await this.m_viewController.ensureSlideViewElement(T.resource);if(P.hasOwnProperty("errorName"))return g.errorName=P.metadata.errorName,d.a.sendTraceTag(589910427,h.a.msoulscat_Wac_PptSlideshow,c.a.Warning,JSON.stringify(g)),{...g,...C,...P};t&&(f=await this.m_viewController.ensureTextureLoaded(T.resource.id,{isPrefetch:o})),p=this.m_viewController.getSlideViewElement(T.resource.id);let E=0;return p&&(p.animClock.events.on("tick",async e=>{if(!p||!this.m_viewController||!this.m_currentSlideLocation||this.m_currentSlideLocation.slideId.sid!==p.slideId.sid)return;const t=performance.now();b.Settings.readBooleanOrDefault("hackLogAnimationFrameTime",!1)&&console.log("Time between Frames: "+(t-E));const i=this.isAnimating,r=p.animTimeline.setTimeAndCalculate(e),n=p.fHasContinuouslyAnimatedContent&&this.m_sessionSettings.slideShowCoreSettings.convertGifToVideo,a=b.Settings.readBooleanOrDefault("useIsMediaPlaying",!0)&&this.isMediaPlaying(),o=y.ChangeGate.isChangeGateEnabled("SSC.CameoSlidePresenceCheck")?this.isCameoActive&&await this.isCameoDetectedOnCurrentSlideAsync():this.isCameoActive,l=b.Settings.readBooleanOrDefault("lowResAnimsEnabled",!1);if(l||this.setIsAnimating(r),(l?i:r)||n||o||a||this.m_slideRefreshNeeded||this.m_zoomAnimationController.isZooming&&!b.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)){let e=1;if(l&&(e=r?J.getScaleForAnimations():1,this.m_viewController.resizeViewContainer(this.m_opticalZoomStateInfo.currentState,p.slideSizePixels,{canvasScale:e})),(b.Settings.readBooleanOrDefault("enableCameoInPPTOSlideShow",!1)||b.Settings.readBooleanOrDefault("enableCameoInT2",!1))&&o&&this.m_viewController.updateCameoTextureFromVideoElement(),this.m_viewController.renderSlideAnimationFrameById(this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState),this.events.emit("animatedContentStateChanged",{hasContinuouslyAnimatedContent:n||o||a,metadata:{isGpuHardwareDisabled:s.c.s_gpuHardwareDisabled,rendererTech:s.c.s_rendererTech,isBadGPU:s.c.s_isBadGpu,isGlyphCacheDisabled:s.c.s_isGlyphCacheDisabled,isSvg:b.Settings.readBooleanOrDefault("forceSvg",!1),scale:e,hostExperience:this.m_sessionSettings.appSettings.hostExperience}}),b.Settings.readBooleanOrDefault("enableOpticalZoomActionToRenderTelemetry",!1))j.recordRender();else if(this.m_slideRefreshNeeded&&this.m_opticalZoomRenderPerfStartTime){const e=performance.now();d.a.sendTraceTag(512278924,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`Optical Zoom time from zoom invocation to render: ${e-this.m_opticalZoomRenderPerfStartTime}ms`),this.m_opticalZoomRenderPerfStartTime=void 0}this.m_slideRefreshNeeded=!1}if(l&&this.setIsAnimating(r),b.Settings.readBooleanOrDefault("hackLogAnimationFrameTime",!1)){const e=performance.now();console.log("Frame Duration: "+(e-t)),E=e}}),p.animClock.events.on("notRunning",()=>{this.setIsAnimating(!1)}),p.events.on("clickTarget-interactiveAnimation",e=>{this.nextStep(e,1)}),p.events.on("mediaAnimation-nextStep",()=>{this.nextStep(u.e.MainTimelineId,3)}),p.events.on("clickTarget-gotoSlide",e=>{this.gotoSlide({slideId:e},{actionContext:{navigationType:a.a.ClickTarget}})}),p.events.on("clickTarget-gotoZoomSlide",e=>{this.m_currentSlideLocation&&e.slideId&&this.m_zoomManager&&this.m_zoomManager.addSlide(e.slideId,this.m_currentSlideLocation.slideId,e.returnToParent),this.gotoSlide({slideId:e.slideId},{actionContext:{navigationType:a.a.ClickTarget}})}),p.events.on("clickTarget-gotoZoomSection",e=>{if(this.m_currentSlideLocation&&e.sectionId&&this.m_zoomManager){const t=I(e.sectionId,this.m_viewDataManager.sections);this.m_zoomManager.addSection(e.sectionId,this.m_currentSlideLocation.slideId,e.returnToParent),t&&this.gotoSlide({slideId:t},{actionContext:{navigationType:a.a.ClickTarget}})}}),this.registerMediaEventHandlers(p.events)),{...g,...C,...f}}static getScaleForAnimations(){const e=b.Settings.readNumberOrDefault("maxDprForAnimations",1);return b.Settings.readBooleanOrDefault("lowResAnimsEnabled",!1)&&window.devicePixelRatio>e?e/window.devicePixelRatio:1}onNavigatingFrom(e){if(!this.m_viewController)return;const t=this.m_viewController.getSlideViewElement(e);t&&(t.animClock.pause(),t.events.emit("navigatingFrom"))}onNavigatedTo(e){if(!this.m_viewController)return;const t=this.m_viewController.getSlideViewElement(e);t&&(t.animClock.resume(),t.events.emit("navigatedTo"))}onNavigatedFrom(e){if(!this.m_viewController)return;const t=this.m_viewController.getSlideViewElement(e);t&&t.events.emit("navigatedFrom")}onNavigatingTo(e){if(!this.m_viewController)return;const t=this.m_viewController.getSlideViewElement(e);t&&t.events.emit("navigatingTo")}onBeforeFirstRenderAfterNavigation(e){if(!this.m_viewController)return;const t=this.m_viewController.getSlideViewElement(e);t&&t.events.emit("beforeFirstRenderAfterNavigation")}resolvePartialSlideLocation(e){let t=this.m_slideIdOrder.map((e,t)=>({slideId:e,index:t}));if(void 0!==e.slideId){if(t=t.filter(t=>t.slideId.cid===e.slideId.cid&&t.slideId.sid===e.slideId.sid),t.length>1&&void 0!==e.slideIndex){const i=t.filter(t=>t.index===e.slideIndex);0!==i.length&&(t=i)}}else void 0!==e.slideIndex&&(t=t.filter(t=>t.index===e.slideIndex));if(0!==t.length&&(void 0!==e.slideId||void 0!==e.slideIndex))return{slideId:t[0].slideId,slideIndex:t[0].index}}checkForAnimationStateChanges(){if(!this.m_currentSlideLocation||!this.m_viewController)return;const e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(!e)return;const t=e.animTimeline.getTimelineStates(!1);JSON.stringify(this.m_currentTimelineStates)!==JSON.stringify(t)&&(this.m_currentTimelineStates=t,this.events.emit("animationStateChanged"))}getTransitionController(){return this.m_viewController?this.m_viewController.getTransitionController():null}cancelTransition(){if(this.isTransitioning){const e=this.getTransitionController();return e&&e.clock.stop(),!0}return!1}pauseTransition(){if(this.isTransitioning){const e=this.getTransitionController();return e&&e.clock.pause(),!0}return!1}resumeTransition(){if(!this.isTransitioning){const e=this.getTransitionController();return e&&e.clock.resume(),!0}return!1}async isCameoDetectedOnCurrentSlideAsync(){if(!this.m_currentSlideLocation)return!1;const e=this.m_currentSlideLocation.slideIndex;return await this.isCameoDetectedAtSlideIndexAsync(e)}recordSessionStats(e){m.a.recordSessionStats(e)}setMaxSceneCount(e,t){this.m_viewController&&this.m_viewController.setMaxSceneCount(e,t)}setAadToken(e){if(this.m_viewController&&this.m_currentSlideLocation){const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(t)return void t.setAadToken(e)}y.ChangeGate.isChangeGateEnabled("SSC.Stream2AadToken")&&G.a.setStream2AadToken(e)}setFrameTrustStatus(e){this.m_appForOfficeManager&&this.m_appForOfficeManager.setFrameTrustStatus(e)}async isCameoDetectedAtSlideIndexAsync(e){if(!this.m_viewController||e<0||e>=this.m_slideIdOrder.length)return!1;const t=this.m_slideIdOrder[e];if(!t)return!1;if(!(e in this.m_cameoPresenceCache)){const i=this.m_viewController.getSlideViewElement(t);if(!i)return!1;this.m_cameoPresenceCache[e]=await i.isCameoPresentInSlideAsync()}return this.m_cameoPresenceCache[e]}async isCameoDetectedNearbyAsync(){if(!this.m_currentSlideLocation)return!1;const e=this.m_currentSlideLocation.slideIndex;return await this.isCameoDetectedAtSlideIndexAsync(e)||await this.isCameoDetectedAtSlideIndexAsync(e-1)||await this.isCameoDetectedAtSlideIndexAsync(e+1)}emitIfCameoDetected(e){this.isCameoDetectedAtSlideIndexAsync(e).then(e=>{!this.m_cameoDetectedInPresentation&&e&&(this.m_cameoDetectedInPresentation=!0,d.a.sendTraceTag(541180369,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::emitIfCameoDetected - Cameo detected in Presentation"),this.events.emit("cameoDetectedInPresentation",{cameoDetected:!0}))})}getCameoInfoFromActiveSlide(){if(!this.m_viewController||!this.m_currentSlideLocation)return;const e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);if(!e)return;const t=e.getCameoInfoInSlide();return d.a.sendTraceTag(541180370,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,`SlideShowCore::getCameoInfoFromActiveSlide - Cameo details - ${JSON.stringify(t)} in slide ${JSON.stringify(this.m_currentSlideLocation)}}`),t}setCameoVideoElement(e){this.m_viewController&&this.m_viewController.setCameoVideoElement(e)}videoFrameToPptForCameo(e,t){this.m_viewController&&this.m_viewController.sendFrameToCameo(e,t)}clearCameo(){this.m_viewController&&this.m_viewController.clearCameo()}async emitIfMediaDetected(e){this.m_fMediaDetectedInPresentation||await this.isMediaPresentInSlide(e)&&(this.m_fMediaDetectedInPresentation=!0,d.a.sendTraceTag(509641879,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::emitIfMediaDetected - Media detected in Presentation"),this.events.emit("mediaDetectedInPresentation"))}getContentInfoFromActiveSlide(){if(!this.m_viewController||!this.m_currentSlideLocation)return{};const e=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);return e?e.slideContentTelemetry:{}}getMediaCurrentState(e){if(!this.m_viewController)return;if(!this.m_currentSlideLocation)return;const t=this.m_viewController.getSlideViewElement(this.m_currentSlideLocation.slideId);return null!==t?t.getMediaCurrentState(e):void 0}set isHandlingResourceInconsistent(e){this.m_isHandlingResourceInconsistent=e}get isHandlingResourceInconsistent(){return this.m_isHandlingResourceInconsistent}setGlobalMute(e){this.m_viewController&&this.m_viewController.updateGlobalMute(e)}get opticalZoomStateInfo(){return this.m_opticalZoomStateInfo}getGlobalMute(){return this.m_viewController?this.m_viewController.isGlobalMute:void 0}setOpticalZoomState(e,t){const i=b.Settings.readNumberOrDefault("minimumZoom",1),r=b.Settings.readNumberOrDefault("maximumZoom",2);if(e.currentState.canvasCenterSlidePointPercent.x<0||e.currentState.canvasCenterSlidePointPercent.x>1||e.currentState.canvasCenterSlidePointPercent.y<0||e.currentState.canvasCenterSlidePointPercent.y>1)return;const n=Math.min(r,Math.max(i,e.currentState.zoomLevel)),a=n===this.m_opticalZoomStateInfo.currentState.zoomLevel,s=e.currentState.canvasCenterSlidePointPercent.x===this.m_opticalZoomStateInfo.currentState.canvasCenterSlidePointPercent.x&&e.currentState.canvasCenterSlidePointPercent.y===this.m_opticalZoomStateInfo.currentState.canvasCenterSlidePointPercent.y,o=O()(this.m_opticalZoomStateInfo.animationData,e.animationData);if(b.Settings.readBooleanOrDefault("enableOpticalZoomGrabbyHand",!1)&&!a&&(n>i?(this.m_container.style.cursor="-moz-grab",this.m_container.style.cursor="-webkit-grab",this.m_container.style.cursor="grab"):this.m_container.style.cursor="auto"),b.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)){if(a&&s&&o)return}else if(a&&s)return;b.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)&&t&&t.fEndZoomAnimation&&this.m_zoomAnimationController.finishZoomAnimation(),this.m_opticalZoomStateInfo.currentState={zoomLevel:n,canvasCenterSlidePointPercent:e.currentState.canvasCenterSlidePointPercent},b.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)&&(this.m_opticalZoomStateInfo.animationData=e.animationData,this.m_slideRefreshNeeded=!0),this.events.emit("opticalZoomStateChanged",e)}async zoomToAsync(e,t,i){const r="Hidden"!==this.m_blankSlideState||this.m_isTransitioning||this.m_zoomAnimationController.isZooming;if(!this.enableOpticalZoom||!this.m_viewController||!this.m_currentSlideLocation||r)return;const n=b.Settings.readNumberOrDefault("maximumZoom",2),a=b.Settings.readNumberOrDefault("minimumZoom",1),o=this.m_opticalZoomStateInfo.currentState.zoomLevel;if(o<=a&&e<=o||o>=n&&e>=o||e===o)return;b.Settings.readBooleanOrDefault("enableOpticalZoomActionToRenderTelemetry",!1)&&i&&!i.fAnimate&&i.source?j.recordInput(i.source):i&&i.source&&("keyboardPlus"===i.source||"keyboardMinus"===i.source||"uiPlus"===i.source||"uiMinus"===i.source)&&(this.m_opticalZoomRenderPerfStartTime=performance.now());const l=Math.max(a,Math.min(n,e)),u=this.m_viewController.getBounds.getBoundingClientRectFromCanvas(),f=this.m_viewController.getBounds.getClientSizeFromCanvas(),m=t?new s.b(t.x-u.left,t.y-u.top):f.scale(.5);if(b.Settings.readBooleanOrDefault("enableOpticalZoomAnimation",!1)&&i&&i.fAnimate){let e=!0;if(y.ChangeGate.isChangeGateEnabled("SSC.ZoomOutBasedOnOSSetting")&&(e=window.matchMedia("(prefers-reduced-motion: no-preference)").matches||b.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)),e){const e=i.fAnimationDurationInMs&&i.fAnimationDurationInMs>0?i.fAnimationDurationInMs:b.Settings.readNumberOrDefault("zoomAnimationDurationMs",250);return b.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)?void await this.m_zoomAnimationController.animateZoomWithAnimationProgressEventsAsync(l,e,this.m_viewController,{canvasZoomPositionInPixels:m,source:i?i.source:void 0}):(await this.m_zoomAnimationController.animateZoomAsync(l,e,this.m_viewController,m,i?i.source:void 0),void(this.m_slideRefreshNeeded=!0))}}let p=this.m_viewController.calculateCanvasCenterSlidePointPercentAfterZoom(m,l,this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState);if(!p)return;(isNaN(p.x)||isNaN(p.y))&&(p=new s.b(.5,.5),d.a.sendTraceTag(520978769,h.a.msoulscat_Wac_PptSlideshow,c.a.Info,"SlideShowCore::zoomToAsync - Defaulting canvasCenterSlidePointPercent due to NaN"));const g={currentState:{zoomLevel:l,canvasCenterSlidePointPercent:p},metadata:i&&i.source?{source:i.source}:void 0};if(this.setOpticalZoomState(g),b.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)||(this.m_slideRefreshNeeded=!0),b.Settings.readBooleanOrDefault("enableInkOpticalZoom",!1)&&!b.Settings.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)){const e={width:u.width*l,height:u.height*l,zoomPositionX:m.x,zoomPositionY:m.y,containerSizeChanged:!1};this.events.emit("updateCanvasZoom",e)}}panByAmount(e,t){const i="Hidden"!==this.m_blankSlideState||this.m_isTransitioning||this.m_zoomAnimationController.isZooming;if(!this.enableOpticalZoom||!this.m_viewController||!this.m_currentSlideLocation||i)return;if(y.ChangeGate.isChangeGateEnabled("SSC.PreventPanIfZoomAtMinimum")&&this.m_opticalZoomStateInfo.currentState.zoomLevel===b.Settings.readNumberOrDefault("minimumZoom",1))return;const r=this.m_viewController.calculateCanvasCenterPointPercentAfterPan(new s.b(e.x,e.y),this.m_currentSlideLocation.slideId,this.m_opticalZoomStateInfo.currentState);if(!r)return;const n=this.m_opticalZoomStateInfo.currentState.canvasCenterSlidePointPercent;if(n.x===r.x&&n.y===r.y)return;b.Settings.readBooleanOrDefault("enableOpticalZoomActionToRenderTelemetry",!1)&&t&&t.source&&j.recordInput(t.source);const a={zoomLevel:this.m_opticalZoomStateInfo.currentState.zoomLevel,canvasCenterSlidePointPercent:r};this.setOpticalZoomState({currentState:a,metadata:t&&t.source?{source:t.source}:void 0}),b.Settings.readBooleanOrDefault("isZoomSyncEnabled",!1)||(this.m_slideRefreshNeeded=!0),b.Settings.readBooleanOrDefault("enableInkOpticalZoom",!1)&&!b.Settings.readBooleanOrDefault("enableInkOpticalZoomSyncWithSlideOpticalZoomState",!1)&&this.events.emit("updateCanvasPan",{x:e.x,y:e.y})}}J.c_preferFullyBuilt=!0,J.s_defaultOpticalZoomState={zoomLevel:1,canvasCenterSlidePointPercent:{x:.5,y:.5}}},function(e,t,i){"use strict";var r=i(26),n=i(144),a=i(147),s=i(114),o=i(90);function l(e){o.call(this,"digest"),this._hash=e}r(l,o),l.prototype._update=function(e){this._hash.update(e)},l.prototype._final=function(){return this._hash.digest()},e.exports=function(e){return"md5"===(e=e.toLowerCase())?new n:"rmd160"===e||"ripemd160"===e?new a:new l(s(e))}},function(e,t,i){(function(e){function i(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===i(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===i(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===i(e)},t.isError=function(e){return"[object Error]"===i(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(this,i(43).Buffer)},function(e,t,i){(function(t){e.exports=function(e,i){for(var r=Math.min(e.length,i.length),n=new t(r),a=0;a<r;++a)n[a]=e[a]^i[a];return n}}).call(this,i(43).Buffer)},function(e,t,i){"use strict";var r=i(76),n=i(65);function a(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=a,a.prototype.update=function(e,t){if(e=r.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var i=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-i,e.length),0===this.pending.length&&(this.pending=null),e=r.join32(e,0,e.length-i,this.endian);for(var n=0;n<e.length;n+=this._delta32)this._update(e,n,n+this._delta32)}return this},a.prototype.digest=function(e){return this.update(this._pad()),n(null===this.pending),this._digest(e)},a.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,i=t-(e+this.padLength)%t,r=new Array(i+this.padLength);r[0]=128;for(var n=1;n<i;n++)r[n]=0;if(e<<=3,"big"===this.endian){for(var a=8;a<this.padLength;a++)r[n++]=0;r[n++]=0,r[n++]=0,r[n++]=0,r[n++]=0,r[n++]=e>>>24&255,r[n++]=e>>>16&255,r[n++]=e>>>8&255,r[n++]=255&e}else for(r[n++]=255&e,r[n++]=e>>>8&255,r[n++]=e>>>16&255,r[n++]=e>>>24&255,r[n++]=0,r[n++]=0,r[n++]=0,r[n++]=0,a=8;a<this.padLength;a++)r[n++]=0;return r}},function(e,t,i){var r=t;r.bignum=i(354),r.define=i(356).define,r.base=i(121),r.constants=i(221),r.decoders=i(361),r.encoders=i(363)},function(e,t,i){var r=t;r.Reporter=i(358).Reporter,r.DecoderBuffer=i(220).DecoderBuffer,r.EncoderBuffer=i(220).EncoderBuffer,r.Node=i(359)},function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(21),n=i(4),a=i(2),s=i(3),o=i(20),l=i(19),d=i(37),h=i(12);class c{constructor(e,t,i,r,a){this.m_slideShowCore=e,this.m_mediaStateMap=new Map,n.a.setLogger(t),this.m_slideShowAppEvents=i,this.m_sourceIdentifier=o.b.Media,this.m_slideShowRole=r,this.m_slideShowUIEvents=a,this.registerAppEventListeners()}updateMediaStateCache(e){const t=this.m_mediaStateMap.has(e.mediaName)?"Updated MediaStateCache With Received State":"Set New MediaStateCache With Received State";let i=0;e.metadata&&e.metadata.timeStamps&&(i=e.metadata.timeStamps.Total_Elapsed_MS),this.m_mediaStateMap.set(e.mediaName,{mediaSyncState:e,lastCacheUpdateTimestampMs:Date.now(),latencyTimeMs:i}),c.updateMediaSyncMetadataAndLog(t,"MediaAddon",e)}shouldSendMediaSyncMessage(e,t){const i=this.m_slideShowRole===l.a.Presenter?"Passing":"Blocking";return n.a.sendTraceTag(527257823,a.a.msoulscat_Wac_PptSession,s.a.Info,`MediaAddon: ${i} Media Sync ${t?"Initial State":"Event"}: ${JSON.stringify(e)}`),this.m_slideShowRole===l.a.Presenter}isInPrivateViewing(){return this.m_slideShowRole===l.a.PrivateViewing}registerAppEventListeners(){this.m_slideShowCore.events.on("mediaInitState",e=>{this.onMediaInitState(e.mediaSlideInfo,e.mediaSyncInitState)}),this.m_slideShowAppEvents.on("cleanupMediaStateCache",e=>this.cleanupMediaStateCache(e.isNavTriggerSSInBoundMessage,e.mediaNamesBySlideId)),this.m_slideShowAppEvents.on("returnToPresenterUpdateAllMedia",e=>this.returnToPresenterUpdateAllMedia(e.slideId,e.slideIndex)),this.registerSlideShowUIEvents()}returnToPresenterUpdateAllMedia(e,t){if(t){let e=this.m_slideShowCore.getMediaNamesBySlideIndex(t);this.cleanupMediaStateCache(!0,e)}this.m_mediaStateMap.forEach((t,i)=>{if(e){let r={slideId:e,mediaName:i};this.sendUpdatedMediaState(t,r)}else this.sendUpdatedMediaState(t)})}onMediaInitState(e,t){n.a.sendTraceTag(544285633,a.a.msoulscat_Wac_PptSession,s.a.Info,`MediaAddon::onMediaInitState: Received mediaInitState event from media in slide: ${JSON.stringify(e)}, initState: ${JSON.stringify(t)}`);const i=t.mediaName;this.m_mediaStateMap.get(i)?(n.a.sendTraceTag(523776394,a.a.msoulscat_Wac_PptSession,s.a.Info,`MediaAddon::onMediaInitState: Discard local mediaInitState ${JSON.stringify(t)} and update media with state cached ${JSON.stringify(this.m_mediaStateMap.get(i))}`),this.updateMediaState(e)):this.shouldSendMediaSyncMessage(t,!0)&&this.m_slideShowAppEvents.emit("mediaInitState",t)}updateMediaState(e){if(this.m_slideShowRole===l.a.PrivateViewing)return;let t=e.mediaName,i=this.m_mediaStateMap.get(t);this.sendUpdatedMediaState(i,e,!0)}sendUpdatedMediaState(e,t,i){if(void 0===e)return;this.addTimeToPlayerPositionSkew(e),e.mediaSyncState.origin.isFromLocalCache=!0;let r="Passing Media State to SlideShowCore on "+(i?"Player Ready":"Sync Back To Presenter");c.updateMediaSyncMetadataAndLog(r,"MediaAddon",e.mediaSyncState),n.a.sendTraceTag(556372385,a.a.msoulscat_Wac_PptSlideshow,s.a.Info,`MediaAddOn: Retrieving cached Media Sync state (${JSON.stringify(e.mediaSyncState)})`),this.m_slideShowCore.updateMediaState(e.mediaSyncState,t)}addTimeToPlayerPositionSkew(e){const t=e.mediaSyncState;1===t.state.playerState&&(t.state.playerPositionSkew=e.latencyTimeMs+Date.now()-e.lastCacheUpdateTimestampMs)}cleanupMediaStateCache(e,t){if(e||this.m_slideShowRole===l.a.Presenter){if(!t)return void(this.m_slideShowRole===l.a.Presenter&&this.m_mediaStateMap.clear());for(let e of this.m_mediaStateMap.keys())t.includes(e)||this.m_mediaStateMap.delete(e)}}static updateMediaSyncMetadataAndLog(e,t,i){if(!i.metadata||!i.metadata.mediaSyncTimeLine)return void n.a.sendTraceTag(524853466,a.a.msoulscat_Wac_PptLive,s.a.Info,t+"::updateMediaSyncMetadataAndLog: Message doesn't contain metadata or mediaSyncTimeLine.");const r=`${t}: ${e}`;i.metadata.mediaSyncTimeLine.push(r),n.a.sendTraceTag(524853467,a.a.msoulscat_Wac_PptLive,s.a.Info,JSON.stringify({fileName:t,mediaSyncState:i}))}registerSlideShowUIEvents(){this.m_slideShowUIEvents&&this.m_slideShowUIEvents.on("roleChanged",e=>{const t=this.m_slideShowRole;this.m_slideShowRole=e,e===l.a.Presenter&&t!==l.a.Presenter&&this.emitStateOfMediaInSlide();let i=e===l.a.Presenter;this.updateVideoPlayButtonVisibility(i),this.updateMediaCommandScope()})}emitStateOfMediaInSlide(){const e=this.m_slideShowCore.getSlideLocation();if(void 0===e)return;const t=this.m_slideShowCore.getMediaNamesBySlideIndex(e.slideIndex);if(t)for(const e of t){const t=this.m_slideShowCore.getMediaCurrentState(e);if(!t)continue;const i=this.m_slideShowCore.getMediaInfo(e);if(i&&i.isLoopingBackgroundVideo)continue;const n={mediaName:e,state:t,origin:{hostName:i?r.a[i.type]:"undefined",isInitial:!1,isFromRoleChange:!0},correlationId:Object(d.v4)()};this.m_slideShowCore.getGlobalMute()&&(n.state.muted=void 0),this.shouldSendMediaSyncMessage(n,!0)&&this.m_slideShowAppEvents.emit("mediaInitState",n)}}set slideShowUIEvents(e){e&&(this.m_slideShowUIEvents=e,this.registerSlideShowUIEvents())}get slideShowUIEvents(){return this.m_slideShowUIEvents}onUserMediaAction(e){if(this.m_slideShowRole!==l.a.Attendee)return;let t;switch(e.actionType){case 0:case 1:case 3:case 6:case 7:t=!0;break;default:t=!1}let i=!0,r=!0;const o=e.mediaName,d=this.m_slideShowCore.getSlideLocation();if(d){const e=this.m_slideShowCore.getMediaNamesBySlideIndex(d.slideIndex);e&&-1!==e.indexOf(o)||(i=!1,r=!1)}else n.a.sendTraceTag(520148322,a.a.msoulscat_Wac_PptSession,s.a.Warning,`MediaAddon::onUserMediaAction: Couldn't check if media ${e.mediaName} is in the current slide`);this.m_slideShowCore.getMediaCurrentState(e.mediaName)||(r=!1),i?r||6===e.actionType||n.a.sendTraceTag(520148320,a.a.msoulscat_Wac_PptSession,s.a.Error,`MediaAddon::onUserMediaAction: Received userMediaAction event from media that isn't ready \n          (actionInfo: ${JSON.stringify(e)})`):n.a.sendTraceTag(520148321,a.a.msoulscat_Wac_PptSession,s.a.Error,`MediaAddon::onUserMediaAction: Received userMediaAction event from media that isn't in the current slide \n          (actionInfo: ${JSON.stringify(e)})`),t&&(n.a.sendTraceTag(520148319,a.a.msoulscat_Wac_PptSession,s.a.Info,`MediaAddon::onUserMediaAction: Entering Private Viewing mode (actionInfo: ${JSON.stringify(e)})`),this.m_slideShowAppEvents.emit("requestPrivateViewingChanged",{isInPrivateViewing:!0,source:this.m_sourceIdentifier}),i&&(r||6===e.actionType)||h.VetoUtils.recordVeto("Media_VetoedTeamsPrivateViewingUnintentional",{qosVeto:"SharingWrongSlideStateDisplayed",isMediaOnCurrentSlide:i,isMediaReady:r,actionInfo:e}))}updateVideoPlayButtonVisibility(e){this.m_slideShowCore.setVideoPlayButtonVisibility(e)}updateMediaCommandScope(){this.m_slideShowCore.setMediaCommandScope(this.m_slideShowRole===l.a.Presenter?2:1)}}},function(e,t,i){var r;!function(n,a){"use strict";var s="model",o="name",l="type",d="vendor",h="version",c="mobile",u="tablet",f="smarttv",m=function(e){for(var t={},i=0;i<e.length;i++)t[e[i].toUpperCase()]=e[i];return t},p=function(e,t){return"string"==typeof e&&-1!==g(t).indexOf(g(e))},g=function(e){return e.toLowerCase()},_=function(e,t){if("string"==typeof e)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),void 0===t?e:e.substring(0,255)},v=function(e,t){for(var i,r,n,a,s,o,l=0;l<t.length&&!s;){var d=t[l],h=t[l+1];for(i=r=0;i<d.length&&!s;)if(s=d[i++].exec(e))for(n=0;n<h.length;n++)o=s[++r],"object"==typeof(a=h[n])&&a.length>0?2===a.length?"function"==typeof a[1]?this[a[0]]=a[1].call(this,o):this[a[0]]=a[1]:3===a.length?"function"!=typeof a[1]||a[1].exec&&a[1].test?this[a[0]]=o?o.replace(a[1],a[2]):void 0:this[a[0]]=o?a[1].call(this,o,a[2]):void 0:4===a.length&&(this[a[0]]=o?a[3].call(this,o.replace(a[1],a[2])):void 0):this[a]=o||void 0;l+=2}},y=function(e,t){for(var i in t)if("object"==typeof t[i]&&t[i].length>0){for(var r=0;r<t[i].length;r++)if(p(t[i][r],e))return"?"===i?void 0:i}else if(p(t[i],e))return"?"===i?void 0:i;return e},b={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},S={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[h,[o,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[h,[o,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[o,h],[/opios[\/ ]+([\w\.]+)/i],[h,[o,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[h,[o,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[o,h],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[h,[o,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[h,[o,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[h,[o,"WeChat"]],[/konqueror\/([\w\.]+)/i],[h,[o,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[h,[o,"IE"]],[/yabrowser\/([\w\.]+)/i],[h,[o,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[o,/(.+)/,"$1 Secure Browser"],h],[/\bfocus\/([\w\.]+)/i],[h,[o,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[h,[o,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[h,[o,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[h,[o,"Dolphin"]],[/coast\/([\w\.]+)/i],[h,[o,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[h,[o,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[h,[o,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[o,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[o,/(.+)/,"$1 Browser"],h],[/(comodo_dragon)\/([\w\.]+)/i],[[o,/_/g," "],h],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[o,h],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[o],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[o,"Facebook"],h],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[o,h],[/\bgsa\/([\w\.]+) .*safari\//i],[h,[o,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[h,[o,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[o,"Chrome WebView"],h],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[h,[o,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[o,h],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[h,[o,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[h,o],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[o,[h,y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[o,h],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[o,"Netscape"],h],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[h,[o,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[o,h]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",g]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows (ce|mobile); ppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[["architecture",/ower/,"",g]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",g]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[s,[d,"Samsung"],[l,u]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[s,[d,"Samsung"],[l,c]],[/\((ip(?:hone|od)[\w ]*);/i],[s,[d,"Apple"],[l,c]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[s,[d,"Apple"],[l,u]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[s,[d,"Huawei"],[l,u]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[s,[d,"Huawei"],[l,c]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[s,/_/g," "],[d,"Xiaomi"],[l,c]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[s,/_/g," "],[d,"Xiaomi"],[l,u]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[s,[d,"OPPO"],[l,c]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[s,[d,"Vivo"],[l,c]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[s,[d,"Realme"],[l,c]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[s,[d,"Motorola"],[l,c]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[s,[d,"Motorola"],[l,u]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[s,[d,"LG"],[l,u]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[s,[d,"LG"],[l,c]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[s,[d,"Lenovo"],[l,u]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[s,/_/g," "],[d,"Nokia"],[l,c]],[/(pixel c)\b/i],[s,[d,"Google"],[l,u]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[s,[d,"Google"],[l,c]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[s,[d,"Sony"],[l,c]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[s,"Xperia Tablet"],[d,"Sony"],[l,u]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[s,[d,"OnePlus"],[l,c]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[s,[d,"Amazon"],[l,u]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[s,/(.+)/g,"Fire Phone $1"],[d,"Amazon"],[l,c]],[/(playbook);[-\w\),; ]+(rim)/i],[s,d,[l,u]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[s,[d,"BlackBerry"],[l,c]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[s,[d,"ASUS"],[l,u]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[s,[d,"ASUS"],[l,c]],[/(nexus 9)/i],[s,[d,"HTC"],[l,u]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[d,[s,/_/g," "],[l,c]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[s,[d,"Acer"],[l,u]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[s,[d,"Meizu"],[l,c]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[s,[d,"Sharp"],[l,c]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[d,s,[l,c]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[d,s,[l,u]],[/(surface duo)/i],[s,[d,"Microsoft"],[l,u]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[s,[d,"Fairphone"],[l,c]],[/(u304aa)/i],[s,[d,"AT&T"],[l,c]],[/\bsie-(\w*)/i],[s,[d,"Siemens"],[l,c]],[/\b(rct\w+) b/i],[s,[d,"RCA"],[l,u]],[/\b(venue[\d ]{2,7}) b/i],[s,[d,"Dell"],[l,u]],[/\b(q(?:mv|ta)\w+) b/i],[s,[d,"Verizon"],[l,u]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[s,[d,"Barnes & Noble"],[l,u]],[/\b(tm\d{3}\w+) b/i],[s,[d,"NuVision"],[l,u]],[/\b(k88) b/i],[s,[d,"ZTE"],[l,u]],[/\b(nx\d{3}j) b/i],[s,[d,"ZTE"],[l,c]],[/\b(gen\d{3}) b.+49h/i],[s,[d,"Swiss"],[l,c]],[/\b(zur\d{3}) b/i],[s,[d,"Swiss"],[l,u]],[/\b((zeki)?tb.*\b) b/i],[s,[d,"Zeki"],[l,u]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[d,"Dragon Touch"],s,[l,u]],[/\b(ns-?\w{0,9}) b/i],[s,[d,"Insignia"],[l,u]],[/\b((nxa|next)-?\w{0,9}) b/i],[s,[d,"NextBook"],[l,u]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[d,"Voice"],s,[l,c]],[/\b(lvtel\-)?(v1[12]) b/i],[[d,"LvTel"],s,[l,c]],[/\b(ph-1) /i],[s,[d,"Essential"],[l,c]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[s,[d,"Envizen"],[l,u]],[/\b(trio[-\w\. ]+) b/i],[s,[d,"MachSpeed"],[l,u]],[/\btu_(1491) b/i],[s,[d,"Rotor"],[l,u]],[/(shield[\w ]+) b/i],[s,[d,"Nvidia"],[l,u]],[/(sprint) (\w+)/i],[d,s,[l,c]],[/(kin\.[onetw]{3})/i],[[s,/\./g," "],[d,"Microsoft"],[l,c]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[s,[d,"Zebra"],[l,u]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[s,[d,"Zebra"],[l,c]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[d,s,[l,"console"]],[/droid.+; (shield) bui/i],[s,[d,"Nvidia"],[l,"console"]],[/(playstation [345portablevi]+)/i],[s,[d,"Sony"],[l,"console"]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[s,[d,"Microsoft"],[l,"console"]],[/smart-tv.+(samsung)/i],[d,[l,f]],[/hbbtv.+maple;(\d+)/i],[[s,/^/,"SmartTV"],[d,"Samsung"],[l,f]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[d,"LG"],[l,f]],[/(apple) ?tv/i],[d,[s,"Apple TV"],[l,f]],[/crkey/i],[[s,"Chromecast"],[d,"Google"],[l,f]],[/droid.+aft(\w)( bui|\))/i],[s,[d,"Amazon"],[l,f]],[/\(dtv[\);].+(aquos)/i],[s,[d,"Sharp"],[l,f]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[d,_],[s,_],[l,f]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[l,f]],[/((pebble))app/i],[d,s,[l,"wearable"]],[/droid.+; (glass) \d/i],[s,[d,"Google"],[l,"wearable"]],[/droid.+; (wt63?0{2,3})\)/i],[s,[d,"Zebra"],[l,"wearable"]],[/(quest( 2)?)/i],[s,[d,"Facebook"],[l,"wearable"]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[d,[l,"embedded"]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[s,[l,c]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[s,[l,u]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[l,u]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[l,c]],[/(android[-\w\. ]{0,9});.+buil/i],[s,[d,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[h,[o,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[h,[o,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[o,h],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[h,o]],os:[[/microsoft (windows) (vista|xp)/i],[o,h],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[o,[h,y,b]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[o,"Windows"],[h,y,b]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[h,/_/g,"."],[o,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[o,"Mac OS"],[h,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[h,o],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[o,h],[/\(bb(10);/i],[h,[o,"BlackBerry"]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[h,[o,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[h,[o,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[h,[o,"webOS"]],[/crkey\/([\d\.]+)/i],[h,[o,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[o,"Chromium OS"],h],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[o,h],[/(sunos) ?([\w\.\d]*)/i],[[o,"Solaris"],h],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[o,h]]},T=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof T))return new T(e,t).getResult();var i=e||(void 0!==n&&n.navigator&&n.navigator.userAgent?n.navigator.userAgent:""),r=t?function(e,t){var i={};for(var r in e)t[r]&&t[r].length%2==0?i[r]=t[r].concat(e[r]):i[r]=e[r];return i}(S,t):S;return this.getBrowser=function(){var e,t={name:void 0,version:void 0};return v.call(t,i,r.browser),t.major="string"==typeof(e=t.version)?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0,t},this.getCPU=function(){var e={architecture:void 0};return v.call(e,i,r.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return v.call(e,i,r.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return v.call(e,i,r.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return v.call(e,i,r.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i="string"==typeof e&&e.length>255?_(e,255):e,this},this.setUA(i),this};T.VERSION="0.7.31",T.BROWSER=m([o,h,"major"]),T.CPU=m(["architecture"]),T.DEVICE=m([s,d,l,"console",c,f,u,"wearable","embedded"]),T.ENGINE=T.OS=m([o,h]),void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=T),t.UAParser=T):i(405)?void 0===(r=function(){return T}.call(t,i,t,e))||(e.exports=r):void 0!==n&&(n.UAParser=T);var w=void 0!==n&&(n.jQuery||n.Zepto);if(w&&!w.ua){var M=new T;w.ua=M.getResult(),w.ua.get=function(){return M.getUA()},w.ua.set=function(e){M.setUA(e);var t=M.getResult();for(var i in t)w.ua[i]=t[i]}}}("object"==typeof window?window:this)},function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return l}));var r=i(4),n=i(2),a=i(3);class s{constructor(){this.m_bootStartTimestamp=-1,this.m_bootSource="none",this.m_lostStrokeCount=0}boot(e){this.m_bootSource=e,this.m_bootStartTimestamp=Date.now()}timeDiff(){return Date.now()-this.m_bootStartTimestamp}getSource(){return this.m_bootSource}countLostStroke(){this.m_lostStrokeCount+=1}getLostStrokeCount(){return this.m_lostStrokeCount}}class o{info(e){r.a.sendTraceTag(545629707,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,e)}error(e){r.a.sendTraceTag(545629708,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,e)}}class l{constructor(e,t,i,n,a,o,l){this.m_slideIndex=-1,this.f_isInkJsDownloading=!1,this.f_isShowingBlankSlide=!1,this.f_isTransitioning=!1,this.m_metricHelper=new s,this.c_endOfShowLocation={slideIndex:-2,slideId:{sid:-2,cid:-2}},r.a.setLogger(t),this.m_slideshowCore=e,this.m_loadInkJsCallback=n,this.m_parent=i,this.m_inkContainer=function(){const e=document.createElement("div");return e.className="SlideShowCoreInkCanvasContainer",e.style.position="absolute",e.style.pointerEvents="none",e.style.zIndex="10",e.style.overflow="hidden",e}(),this.updateDimensions(),this.m_parent.appendChild(this.m_inkContainer),this.onDownloadCompleted=this.onDownloadCompleted.bind(this),this.onDownloadFailed=this.onDownloadFailed.bind(this),this.onPositionChanged=this.onPositionChanged.bind(this),this.onBlankSlideStateChanged=this.onBlankSlideStateChanged.bind(this),this.onSlideLocationChanging=this.onSlideLocationChanging.bind(this),this.updateDimensions=this.updateDimensions.bind(this),this.m_initInk=a,this.m_slideChanged=o,this.m_allowInkStart=l,this.onPointerDown=this.onPointerDown.bind(this),window.addEventListener("pointerdown",this.onPointerDown)}get slideshowCore(){return this.m_slideshowCore}get loadInkJsCallback(){return this.m_loadInkJsCallback}get parent(){return this.m_parent}get inkContainer(){return this.m_inkContainer}get isInkJsDownloading(){return this.f_isInkJsDownloading}get isShowingBlankSlide(){return this.f_isShowingBlankSlide}get metricHelper(){return this.m_metricHelper}set isInkJsDownloading(e){this.f_isInkJsDownloading=e}onPointerDown(e){"pen"===e.pointerType&&this.m_metricHelper.countLostStroke()}selectEraser(){this.m_inkCanvas&&(this.m_inkCanvas.enableTouchMouse(),this.m_inkCanvas.selectEraser(),r.a.sendTraceTag(545629709,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,"SlideShowInkAddon: selectEraser called"))}selectNone(){this.m_inkCanvas&&this.m_inkCanvas.disableTouchMouse()}eraseAll(){this.m_inkCanvas&&(this.m_inkCanvas.eraseAll(),r.a.sendTraceTag(545629710,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,"SlideShowInkAddon: eraseAll called"))}onDownloadCompleted(){this.f_isInkJsDownloading=!1,r.a.sendTraceTag(545629711,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,"SlideShowInkAddon: slideshowink.js downloaded"),this.updateDimensions(),this.m_initInk()}onDownloadFailed(e){this.f_isInkJsDownloading=!1,r.a.sendTraceTag(545629712,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,"SlideShowInkAddon: slideshowink.js download error: "+e.message)}updateDimensions(){const e=this.m_slideshowCore.getCurrentSlideDimensions();e&&(this.m_inkContainer.style.width=e.x+"px",this.m_inkContainer.style.height=e.y+"px",this.updateInkCanvasDimensions())}updateInkCanvasDimensions(){if(!this.m_inkCanvas)return;const e=this.slideshowCore.getCurrentSlideDimensions();e&&"function"==typeof this.m_inkCanvas.updateCanvasDimensions&&this.m_inkCanvas.updateCanvasDimensions(e.x,e.y)}resetInkCanvas(){if(this.m_inkCanvas){for(this.m_metricHelper.boot("reset"),this.m_inkCanvas.stop(),this.unregisterAppEventListeners(),this.m_inkCanvas=void 0;this.m_inkContainer.firstChild;)this.m_inkContainer.removeChild(this.m_inkContainer.firstChild);this.m_initInk(),r.a.sendTraceTag(545629713,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,"SlideShowInkAddon: Ink initialization triggered by reset.")}}registerAppEventListeners(){this.m_slideshowCore.events.on("slideLocationChanged",this.onPositionChanged),this.m_slideshowCore.events.on("blankSlideStateChanged",this.onBlankSlideStateChanged),this.m_slideshowCore.events.on("slideLocationChanging",this.onSlideLocationChanging),this.m_slideshowCore.events.on("slideDimensionsChanged",this.updateDimensions)}unregisterAppEventListeners(){this.m_slideshowCore.events.off("slideLocationChanged",this.onPositionChanged),this.m_slideshowCore.events.off("blankSlideStateChanged",this.onBlankSlideStateChanged),this.m_slideshowCore.events.off("slideLocationChanging",this.onSlideLocationChanging),this.m_slideshowCore.events.off("slideDimensionsChanged",this.updateDimensions)}onPositionChanged(){const e=this.m_slideshowCore.getSlideLocation();if(!e)return void r.a.sendTraceTag(545629714,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,"SlideShowInkAddon: undefined slide location in onPositionChanged.");const t=e.slideIndex;this.m_slideIndex!==t&&(this.m_slideIndex=t,this.m_slideChanged(e))}onBlankSlideStateChanged(e){if("Hidden"===e){this.f_isShowingBlankSlide=!1;const e=this.m_slideshowCore.getSlideLocation();e&&this.m_slideChanged(e),this.m_inkContainer.style.visibility="inherit",this.m_inkCanvas&&this.m_allowInkStart()&&this.m_inkCanvas.start()}else this.f_isShowingBlankSlide=!0,this.m_inkCanvas&&this.m_inkCanvas.stop(),this.m_inkContainer.style.visibility="hidden",this.m_slideChanged(this.c_endOfShowLocation)}onSlideLocationChanging(e){!this.f_isTransitioning&&e.isTransitioning?(this.f_isTransitioning=e.isTransitioning,this.m_inkCanvas&&this.m_inkCanvas.stop(),this.m_inkContainer.style.visibility="hidden"):this.f_isTransitioning&&!e.isTransitioning&&(this.f_isTransitioning=e.isTransitioning,this.m_inkContainer.style.visibility="inherit",this.m_inkCanvas&&this.m_allowInkStart()&&this.m_inkCanvas.start())}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i(4),n=i(2),a=i(3),s=i(1),o=i(80),l=i(6),d=i(44);class h{constructor(e,t,i){this.m_startedTests=!1,this.m_isAnimating=!1,this.m_runTestsTimeoutId=0,this.m_slideshowCore=e;const n=t.slideShowCoreSettings.settings;s.Settings.load(n?n.slideshowcore:{}),r.a.setLogger(i),l.ChangeGate.initSettings({disabledChangeGates:t.slideShowCoreSettings.disabledChangeGates||""}),this.m_settings=t,e.events.on("slideLocationChanged",this.onSlideLocationChanged.bind(this)),e.events.on("animationStateChanging",this.logFrameData.bind(this)),l.ChangeGate.isChangeGateEnabled("SSC.bootPayloadTest")&&this.bootPayloadTest()}logFrameData(e){this.m_isAnimating=e.isAnimating}onSlideLocationChanged(e){this.m_startedTests||(window.clearTimeout(this.m_runTestsTimeoutId),window.setTimeout(this.runTestsAsync.bind(this),1e3*s.Settings.readNumberOrDefault("perfCheckerDelaySec",60)))}async runTestsAsync(){if(this.m_startedTests||this.m_isAnimating)return;this.m_startedTests=!0;const e=navigator.connection;e&&(h.logNetworkInformation(e,!1),e.addEventListener("change",()=>h.logNetworkInformation(e,!0))),s.Settings.readBooleanOrDefault("cpuSpeedTestEnabled",!0)&&r.a.sendTraceTag(545378498,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"PerfCheckerAddon CPU Speed: "+JSON.stringify(h.calculatePI(10))),!s.Settings.readBooleanOrDefault("networkBandwidthTestEnabled",!1)||e&&e.saveData&&s.Settings.readBooleanOrDefault("respectSaveDataForTesting",!1)||await this.runNetworkBandwidthTestAsync(),s.Settings.readBooleanOrDefault("networkRttTestEnabled",!1)&&await h.runNetworkRttTestAsync(this.m_settings.appSettings.serverUrl+"/podhandler.ashx?action=GetSessionUTC&format=jsms"),s.Settings.readBooleanOrDefault("longRunningFramesTestEnabled",!0)&&await this.longRunningFramesTestAsync()}bootPayloadTest(){try{const e=this.m_settings.bootMetrics&&void 0!==this.m_settings.bootMetrics.aspxTime?this.m_settings.bootMetrics.aspxTime:this.m_settings.appSettings.initTime,t=[];let i=0,s=0,o=0,l=0;for(const d of performance.getEntriesByType("resource")){const c=h.sanitizeUrl(d.name),u=h.getJsonFromPerformanceEntry(d),f=u?u.encodedBodySize:0,m=c.toLowerCase();if("slideshowcore.js"===m||"slideshowcore.min.js"===m||"slideshowapp.js"===m)return i+=f,void r.a.sendTraceTag(545052236,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"PerfCheckerAddon Boot Payload: "+JSON.stringify({totalSize:i,bootJsSize:f,jsSize:s,cssSize:o,otherSize:l,timings:t}));if(d.startTime>e){const e={name:c,encodedSize:f,startTime:d.startTime,duration:d.duration};t.push(e),i+=e.encodedSize,c.endsWith(".js")?s+=e.encodedSize:c.endsWith(".css")?o+=e.encodedSize:l+=e.encodedSize}}}catch(e){r.a.sendTraceTag(545051671,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"PerfCheckerAddon::bootPayloadTest exception: "+e)}}static sanitizeUrl(e){try{if(!e)return"";const t=document.createElement("a");return t.href=e,t.pathname.substring(t.pathname.lastIndexOf("/")+1)}catch(e){return""}}static logNetworkInformation(e,t){const i={isOnNetworkChanged:t,downlink:e.downlink,effectiveType:e.effectiveType,rtt:e.rtt,saveData:e.saveData};r.a.sendTraceTag(545122069,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"PerfCheckerAddon NetworkInformation: "+JSON.stringify(i))}static calculatePI(e){let t=0,i=0,r=performance.now(),n=1;for(;i%100||performance.now()-r<e;)t+=4/n,n+=2,t-=4/n,n+=2,i+=1;return{numIterations:i,timeLimitMs:e,pi:t}}async runNetworkBandwidthTestAsync(e=0,t=0){const i=1e3*s.Settings.readNumberOrDefault("networkEmptyWaitTimeForTestsSec",30);for(const r of performance.getEntriesByType("resource"))if(r.name.indexOf("getitems.ashx")>=0&&performance.now()-r.responseEnd<i)return void(e<100&&(await Object(d.waitMsAsync)(i),await this.runNetworkBandwidthTestAsync(e+1,t)));const o=performance.now(),l="https://cdn.hubblecontent.osi.office.net/getty/publish/transitions/curtainsdata.json?r="+Date.now(),c=new AbortController,u=()=>c.abort();let f,m;this.m_slideshowCore.events.on("slideLocationChanged",u);try{f=await fetch(l,{signal:c.signal})}catch(e){"AbortError"!==e.name&&r.a.sendTraceTag(545122070,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,"PerfCheckerAddon Network Bandwidth: unexpected fetch exception: "+e)}f&&(m=await h.waitForPerformanceEntryAsync(l)),this.m_slideshowCore.events.off("slideLocationChanged",u);const p=performance.now();if(!f||!m||200!==f.status)return void(t<3&&(await Object(d.waitMsAsync)(i),await this.runNetworkBandwidthTestAsync(e,t+1)));let g=!1,_=Number(f.headers.get("content-length"));_||(_=814493,g=!0);const v=8*_/1048576,y=(m.responseEnd-m.responseStart)/1e3;r.a.sendTraceTag(545122072,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"PerfCheckerAddon Network Bandwidth: "+JSON.stringify({estimatedMbps:v/y,actualTimeMs:Math.round(p-o),guessedContentLength:g,requestData:m}))}static waitForPerformanceEntryAsync(e){return new Promise(t=>{for(const i of performance.getEntriesByType("resource"))if(i.name===e)return void t(h.getJsonFromPerformanceEntry(i));const i=new PerformanceObserver(r=>{const n=r.getEntriesByType("resource");for(const r of n)if(r.name===e)return t(h.getJsonFromPerformanceEntry(r)),void i.disconnect()});i.observe({entryTypes:["resource"]})})}static getJsonFromPerformanceEntry(e){const t=e.toJSON();for(const e in t)"number"==typeof t[e]&&(t[e]=Math.round(t[e])),t.name=void 0;return t}static async runNetworkRttTestAsync(e){let t=0,i=0;for(let r=0;r<5;r+=1){const r=performance.now();200===(await fetch(e)).status&&(t=performance.now()-r,i+=1)}r.a.sendTraceTag(545122073,n.a.msoulscat_Wac_PptSlideshow,a.a.Warning,"PerfCheckerAddon Network Rtt: "+JSON.stringify({rttMs:Math.round(t/i),numSuccess:i,numAttempts:5}))}async longRunningFramesTestAsync(e=0){if(this.m_isAnimating&&e<100)return await Object(d.waitMsAsync)(3e4),void await this.longRunningFramesTestAsync(e+1);const t=performance.now(),i=new o.a({type:"LongRunningFramesTest",ignoreVeto:!0});await this.startMeasuringFramesAsync(t,i,e)}startMeasuringFramesAsync(e,t,i){return new Promise(r=>{requestAnimationFrame(()=>this.measureFrameAsync(e,t,i,r))})}async measureFrameAsync(e,t,i,r){return this.m_isAnimating?(await this.longRunningFramesTestAsync(i),void r()):performance.now()-e>s.Settings.readNumberOrDefault("longRunningFramesTestTimeLimitMs",1e4)?(t.logFrameData(!1),void r()):(t.logFrameData(!0),void requestAnimationFrame(()=>this.measureFrameAsync(e,t,i,r)))}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(10);class n{static stopInkActivityTimer(){if(""!==n.m_currentInkActivity&&0!==n.m_currentInkActivityStart){const e=n.m_sessionTelemetry[n.m_currentInkActivity];n.m_sessionTelemetry[n.m_currentInkActivity]=void 0===e?Date.now()-n.m_currentInkActivityStart:e+Date.now()-n.m_currentInkActivityStart,r.a.recordSessionStats({AnnotationStats:n.m_sessionTelemetry})}}static logInkActivity(e){switch(e){case"InitInk":if(""===n.m_currentInkActivity){const e=Date.now();n.m_sessionTelemetry.InkStart=e,n.m_currentInkActivity="None",n.m_currentInkActivityStart=e,r.a.recordSessionStats({AnnotationStats:n.m_sessionTelemetry})}break;case"SessionEnd":""!==this.m_currentInkActivity&&(n.stopInkActivityTimer(),n.m_sessionTelemetry.InkEnd=Date.now(),r.a.recordSessionStats({AnnotationStats:n.m_sessionTelemetry}),n.m_currentInkActivityStart=0,n.m_currentInkActivity="",n.m_sessionTelemetry={});break;case"ToAttendee":n.stopInkActivityTimer(),n.m_currentInkActivityStart=0;break;case"ToPresenter":""!==n.m_currentInkActivity&&(n.m_currentInkActivityStart=Date.now());break;case"Pen":case"Highlighter":case"Eraser":case"Laser":case"Select":case"None":const t=Date.now();""===n.m_currentInkActivity?(n.m_sessionTelemetry.InkStart=t,n.m_currentInkActivity=e,n.m_currentInkActivityStart=t,r.a.recordSessionStats({AnnotationStats:n.m_sessionTelemetry})):n.m_currentInkActivity!==e&&(n.stopInkActivityTimer(),n.m_currentInkActivity=e,n.m_currentInkActivityStart=Date.now())}}}n.m_currentInkActivity="",n.m_currentInkActivityStart=0,n.m_sessionTelemetry={}},function(e,t,i){"use strict";(function(t){void 0===t||!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,i,r,n){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var a,s,o=arguments.length;switch(o){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,i)}));case 3:return t.nextTick((function(){e.call(null,i,r)}));case 4:return t.nextTick((function(){e.call(null,i,r,n)}));default:for(a=new Array(o-1),s=0;s<a.length;)a[s++]=arguments[s];return t.nextTick((function(){e.apply(null,a)}))}}}:e.exports=t}).call(this,i(48))},function(e,t,i){var r=i(29).Buffer;function n(e){r.isBuffer(e)||(e=r.from(e));for(var t=e.length/4|0,i=new Array(t),n=0;n<t;n++)i[n]=e.readUInt32BE(4*n);return i}function a(e){for(;0<e.length;e++)e[0]=0}function s(e,t,i,r,n){for(var a,s,o,l,d=i[0],h=i[1],c=i[2],u=i[3],f=e[0]^t[0],m=e[1]^t[1],p=e[2]^t[2],g=e[3]^t[3],_=4,v=1;v<n;v++)a=d[f>>>24]^h[m>>>16&255]^c[p>>>8&255]^u[255&g]^t[_++],s=d[m>>>24]^h[p>>>16&255]^c[g>>>8&255]^u[255&f]^t[_++],o=d[p>>>24]^h[g>>>16&255]^c[f>>>8&255]^u[255&m]^t[_++],l=d[g>>>24]^h[f>>>16&255]^c[m>>>8&255]^u[255&p]^t[_++],f=a,m=s,p=o,g=l;return a=(r[f>>>24]<<24|r[m>>>16&255]<<16|r[p>>>8&255]<<8|r[255&g])^t[_++],s=(r[m>>>24]<<24|r[p>>>16&255]<<16|r[g>>>8&255]<<8|r[255&f])^t[_++],o=(r[p>>>24]<<24|r[g>>>16&255]<<16|r[f>>>8&255]<<8|r[255&m])^t[_++],l=(r[g>>>24]<<24|r[f>>>16&255]<<16|r[m>>>8&255]<<8|r[255&p])^t[_++],[a>>>=0,s>>>=0,o>>>=0,l>>>=0]}var o=[0,1,2,4,8,16,32,64,128,27,54],l=function(){for(var e=new Array(256),t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;for(var i=[],r=[],n=[[],[],[],[]],a=[[],[],[],[]],s=0,o=0,l=0;l<256;++l){var d=o^o<<1^o<<2^o<<3^o<<4;d=d>>>8^255&d^99,i[s]=d,r[d]=s;var h=e[s],c=e[h],u=e[c],f=257*e[d]^16843008*d;n[0][s]=f<<24|f>>>8,n[1][s]=f<<16|f>>>16,n[2][s]=f<<8|f>>>24,n[3][s]=f,f=16843009*u^65537*c^257*h^16843008*s,a[0][d]=f<<24|f>>>8,a[1][d]=f<<16|f>>>16,a[2][d]=f<<8|f>>>24,a[3][d]=f,0===s?s=o=1:(s=h^e[e[e[u^h]]],o^=e[e[o]])}return{SBOX:i,INV_SBOX:r,SUB_MIX:n,INV_SUB_MIX:a}}();function d(e){this._key=n(e),this._reset()}d.blockSize=16,d.keySize=32,d.prototype.blockSize=d.blockSize,d.prototype.keySize=d.keySize,d.prototype._reset=function(){for(var e=this._key,t=e.length,i=t+6,r=4*(i+1),n=[],a=0;a<t;a++)n[a]=e[a];for(a=t;a<r;a++){var s=n[a-1];a%t==0?(s=s<<8|s>>>24,s=l.SBOX[s>>>24]<<24|l.SBOX[s>>>16&255]<<16|l.SBOX[s>>>8&255]<<8|l.SBOX[255&s],s^=o[a/t|0]<<24):t>6&&a%t==4&&(s=l.SBOX[s>>>24]<<24|l.SBOX[s>>>16&255]<<16|l.SBOX[s>>>8&255]<<8|l.SBOX[255&s]),n[a]=n[a-t]^s}for(var d=[],h=0;h<r;h++){var c=r-h,u=n[c-(h%4?0:4)];d[h]=h<4||c<=4?u:l.INV_SUB_MIX[0][l.SBOX[u>>>24]]^l.INV_SUB_MIX[1][l.SBOX[u>>>16&255]]^l.INV_SUB_MIX[2][l.SBOX[u>>>8&255]]^l.INV_SUB_MIX[3][l.SBOX[255&u]]}this._nRounds=i,this._keySchedule=n,this._invKeySchedule=d},d.prototype.encryptBlockRaw=function(e){return s(e=n(e),this._keySchedule,l.SUB_MIX,l.SBOX,this._nRounds)},d.prototype.encryptBlock=function(e){var t=this.encryptBlockRaw(e),i=r.allocUnsafe(16);return i.writeUInt32BE(t[0],0),i.writeUInt32BE(t[1],4),i.writeUInt32BE(t[2],8),i.writeUInt32BE(t[3],12),i},d.prototype.decryptBlock=function(e){var t=(e=n(e))[1];e[1]=e[3],e[3]=t;var i=s(e,this._invKeySchedule,l.INV_SUB_MIX,l.INV_SBOX,this._nRounds),a=r.allocUnsafe(16);return a.writeUInt32BE(i[0],0),a.writeUInt32BE(i[3],4),a.writeUInt32BE(i[2],8),a.writeUInt32BE(i[1],12),a},d.prototype.scrub=function(){a(this._keySchedule),a(this._invKeySchedule),a(this._key)},e.exports.AES=d},function(e,t,i){var r=i(29).Buffer,n=i(144);e.exports=function(e,t,i,a){if(r.isBuffer(e)||(e=r.from(e,"binary")),t&&(r.isBuffer(t)||(t=r.from(t,"binary")),8!==t.length))throw new RangeError("salt should be Buffer with 8 byte length");for(var s=i/8,o=r.alloc(s),l=r.alloc(a||0),d=r.alloc(0);s>0||a>0;){var h=new n;h.update(d),h.update(e),t&&h.update(t),d=h.digest();var c=0;if(s>0){var u=o.length-s;c=Math.min(s,d.length),d.copy(o,u,0,c),s-=c}if(c<d.length&&a>0){var f=l.length-a,m=Math.min(a,d.length-c);d.copy(l,f,c,c+m),a-=m}}return d.fill(0),{key:o,iv:l}}},function(e,t,i){"use strict";var r=i(84),n=i(66),a=n.getNAF,s=n.getJSF,o=n.assert;function l(e,t){this.type=e,this.p=new r(t.p,16),this.red=t.prime?r.red(t.prime):r.mont(this.p),this.zero=new r(0).toRed(this.red),this.one=new r(1).toRed(this.red),this.two=new r(2).toRed(this.red),this.n=t.n&&new r(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var i=this.n&&this.p.div(this.n);!i||i.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function d(e,t){this.curve=e,this.type=t,this.precomputed=null}e.exports=l,l.prototype.point=function(){throw new Error("Not implemented")},l.prototype.validate=function(){throw new Error("Not implemented")},l.prototype._fixedNafMul=function(e,t){o(e.precomputed);var i=e._getDoubles(),r=a(t,1,this._bitLength),n=(1<<i.step+1)-(i.step%2==0?2:1);n/=3;for(var s=[],l=0;l<r.length;l+=i.step){var d=0;for(t=l+i.step-1;t>=l;t--)d=(d<<1)+r[t];s.push(d)}for(var h=this.jpoint(null,null,null),c=this.jpoint(null,null,null),u=n;u>0;u--){for(l=0;l<s.length;l++)(d=s[l])===u?c=c.mixedAdd(i.points[l]):d===-u&&(c=c.mixedAdd(i.points[l].neg()));h=h.add(c)}return h.toP()},l.prototype._wnafMul=function(e,t){var i=4,r=e._getNAFPoints(i);i=r.wnd;for(var n=r.points,s=a(t,i,this._bitLength),l=this.jpoint(null,null,null),d=s.length-1;d>=0;d--){for(t=0;d>=0&&0===s[d];d--)t++;if(d>=0&&t++,l=l.dblp(t),d<0)break;var h=s[d];o(0!==h),l="affine"===e.type?h>0?l.mixedAdd(n[h-1>>1]):l.mixedAdd(n[-h-1>>1].neg()):h>0?l.add(n[h-1>>1]):l.add(n[-h-1>>1].neg())}return"affine"===e.type?l.toP():l},l.prototype._wnafMulAdd=function(e,t,i,r,n){for(var o=this._wnafT1,l=this._wnafT2,d=this._wnafT3,h=0,c=0;c<r;c++){var u=(C=t[c])._getNAFPoints(e);o[c]=u.wnd,l[c]=u.points}for(c=r-1;c>=1;c-=2){var f=c-1,m=c;if(1===o[f]&&1===o[m]){var p=[t[f],null,null,t[m]];0===t[f].y.cmp(t[m].y)?(p[1]=t[f].add(t[m]),p[2]=t[f].toJ().mixedAdd(t[m].neg())):0===t[f].y.cmp(t[m].y.redNeg())?(p[1]=t[f].toJ().mixedAdd(t[m]),p[2]=t[f].add(t[m].neg())):(p[1]=t[f].toJ().mixedAdd(t[m]),p[2]=t[f].toJ().mixedAdd(t[m].neg()));var g=[-3,-1,-5,-7,0,7,5,1,3],_=s(i[f],i[m]);h=Math.max(_[0].length,h),d[f]=new Array(h),d[m]=new Array(h);for(var v=0;v<h;v++){var y=0|_[0][v],b=0|_[1][v];d[f][v]=g[3*(y+1)+(b+1)],d[m][v]=0,l[f]=p}}else d[f]=a(i[f],o[f],this._bitLength),d[m]=a(i[m],o[m],this._bitLength),h=Math.max(d[f].length,h),h=Math.max(d[m].length,h)}var S=this.jpoint(null,null,null),T=this._wnafT4;for(c=h;c>=0;c--){for(var w=0;c>=0;){var M=!0;for(v=0;v<r;v++)T[v]=0|d[v][c],0!==T[v]&&(M=!1);if(!M)break;w++,c--}if(c>=0&&w++,S=S.dblp(w),c<0)break;for(v=0;v<r;v++){var C,I=T[v];0!==I&&(I>0?C=l[v][I-1>>1]:I<0&&(C=l[v][-I-1>>1].neg()),S="affine"===C.type?S.mixedAdd(C):S.add(C))}}for(c=0;c<r;c++)l[c]=null;return n?S:S.toP()},l.BasePoint=d,d.prototype.eq=function(){throw new Error("Not implemented")},d.prototype.validate=function(){return this.curve.validate(this)},l.prototype.decodePoint=function(e,t){e=n.toArray(e,t);var i=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*i)return 6===e[0]?o(e[e.length-1]%2==0):7===e[0]&&o(e[e.length-1]%2==1),this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));if((2===e[0]||3===e[0])&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),3===e[0]);throw new Error("Unknown point format")},d.prototype.encodeCompressed=function(e){return this.encode(e,!0)},d.prototype._encode=function(e){var t=this.curve.p.byteLength(),i=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",t))},d.prototype.encode=function(e,t){return n.encode(this._encode(t),e)},d.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},d.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},d.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],r=this,n=0;n<t;n+=e){for(var a=0;a<e;a++)r=r.dbl();i.push(r)}return{step:e,points:i}},d.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],i=(1<<e)-1,r=1===i?null:this.dbl(),n=1;n<i;n++)t[n]=t[n-1].add(r);return{wnd:e,points:t}},d.prototype._getBeta=function(){return null},d.prototype.dblp=function(e){for(var t=this,i=0;i<e;i++)t=t.dbl();return t}},function(e,t,i){var r=i(353),n=i(366),a=i(367),s=i(152),o=i(193),l=i(29).Buffer;function d(e){var t;"object"!=typeof e||l.isBuffer(e)||(t=e.passphrase,e=e.key),"string"==typeof e&&(e=l.from(e));var i,d,h=a(e,t),c=h.tag,u=h.data;switch(c){case"CERTIFICATE":d=r.certificate.decode(u,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(d||(d=r.PublicKey.decode(u,"der")),i=d.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return r.RSAPublicKey.decode(d.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return d.subjectPrivateKey=d.subjectPublicKey,{type:"ec",data:d};case"1.2.840.10040.4.1":return d.algorithm.params.pub_key=r.DSAparam.decode(d.subjectPublicKey.data,"der"),{type:"dsa",data:d.algorithm.params};default:throw new Error("unknown key id "+i)}throw new Error("unknown key type "+c);case"ENCRYPTED PRIVATE KEY":u=function(e,t){var i=e.algorithm.decrypt.kde.kdeparams.salt,r=parseInt(e.algorithm.decrypt.kde.kdeparams.iters.toString(),10),a=n[e.algorithm.decrypt.cipher.algo.join(".")],d=e.algorithm.decrypt.cipher.iv,h=e.subjectPrivateKey,c=parseInt(a.split("-")[1],10)/8,u=o.pbkdf2Sync(t,i,r,c,"sha1"),f=s.createDecipheriv(a,u,d),m=[];return m.push(f.update(h)),m.push(f.final()),l.concat(m)}(u=r.EncryptedPrivateKey.decode(u,"der"),t);case"PRIVATE KEY":switch(i=(d=r.PrivateKey.decode(u,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return r.RSAPrivateKey.decode(d.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:d.algorithm.curve,privateKey:r.ECPrivateKey.decode(d.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return d.algorithm.params.priv_key=r.DSAparam.decode(d.subjectPrivateKey,"der"),{type:"dsa",params:d.algorithm.params};default:throw new Error("unknown key id "+i)}throw new Error("unknown key type "+c);case"RSA PUBLIC KEY":return r.RSAPublicKey.decode(u,"der");case"RSA PRIVATE KEY":return r.RSAPrivateKey.decode(u,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:r.DSAPrivateKey.decode(u,"der")};case"EC PRIVATE KEY":return{curve:(u=r.ECPrivateKey.decode(u,"der")).parameters.value,privateKey:u.privateKey};default:throw new Error("unknown key type "+c)}}e.exports=d,d.signature=r.signature},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(380),n=i(52),a=i(382),s=i(32),o=i(98),l=function(){function e(){}return e.prototype.init=function(e,t){e?e.engine?(a.applyEngineExtensions(),this.drawInfo&&this.dispose(),this.props=e,this.engine=e.engine,this.resourcesManager=new r.ResourcesManager(this.engine,t),this.drawInfo=this.internalInit(e,this.resourcesManager,t),this.drawInfo||(this.dispose(),s.logError("Can not init shaders, or draw info, initialization failed."))):s.logError("No engine has been provided for the transition"):s.logError("No Props have been provided for the transition")},e.prototype.draw=function(e){var t=this.drawInfo;return t&&this.props?t.engine.isContextLost()?(s.logError("Context has been lost"),!1):(t.autoClear&&(t.engine.resetViewport(),t.engine.clearToBlack()),this.internalDraw(e,this.props,t)):(s.logError("Transition has not been initialized"),!1)},e.prototype.getDrawInfo=function(e,t,i){if(void 0===i&&(i=!1),this.engine&&this.resourcesManager&&this.props){var r=new o.MeshInfo(this.props,i),a=new o.Mesh;a.initialize(r);for(var l=new Array(t.length),d=0;d<t.length;d+=1)l[d]=t[d](a,r);return n.createDrawInfo(this.engine,this.resourcesManager,this.props.incomingSlideBackground,this.props.outgoingSlideBackground,e,a.getVertexIndices(),l)}s.logError("Transition has not been initialized")},e.prototype.dispose=function(){this.resourcesManager&&this.resourcesManager.dispose()},e}();t.Transition=l},function(e,t,i){"use strict";var r,n;i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a})),function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.ConvertAndEdit=2]="ConvertAndEdit",e[e.CopyAndEdit=3]="CopyAndEdit",e[e.ContinueEditing=4]="ContinueEditing"}(n||(n={}));class a{}a.errorCodes=((r=class{}).ooeSuccess=0,r.ooeCoercionTypeNotSupported=1e3,r.ooeInternalError=5001,r.ooeDocumentReadOnly=5002,r.ooeInvalidApiCallInContext=5004,r.ooeUnsupportedEnumeration=5007,r.ooeCannotNavTo=7001,r.ooeSpecifiedIdNotExist=7002,r.ooeNavOutOfBound=7004,r)},function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var i,r,n,a,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&a[0]?r.return:a[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,a[1])).done)return n;switch(r=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){s.label=a[1];break}if(6===a[0]&&s.label<n[1]){s.label=n[1],n=a;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(a);break}n[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{i=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(86),s=i(232),o=i(32),l=[{code:s.tp_0,a:["aPosition","aTexcoord","aDelay"],u:["uModelViewProj","uProgress","uFactor","uStyle"],s:["uSampler1","uSampler2"]},{code:s.tp_1,a:["aPosition","aTexcoord","aDelay","aDirection"],u:["uModelViewProj","uProgress","uFactor","uOpacity"],s:["uSampler1"]},{code:s.tp_2,a:["aPosition","aTexcoord"],u:["uModelViewProj"],s:["uSampler1"]},{code:s.tp_3,a:["aPosition","aTexcoord","aDelay","aCenter"],u:["uModelViewProj","uProgress","uFactor","uZmovement","uDirection","uAnglePlus","uMaxAngle","uZCenter","uXAxis"],s:["uSampler1"]},{code:s.tp_4,a:["aPosition","aTexcoord","aDistance"],u:["uModelViewProj","uProgress"],s:["uSampler1","uSampler2"]},{code:s.tp_5,a:["aPosition","aTexcoord","aDelay","aCenter"],u:["uModelViewProj","uFactor","uZmovement","uDirection","uAngle","uXAxis","uBack"],s:["uSampler1"]},{code:s.tp_6,a:["aPosition","aNormal","aTexCoord"],u:["uModelToView","uModelToWorld","uModelToWorldIT","uLightPosition","uAmbientColor","uDiffuseColor","uIsNormalDirectionChangeReq"],s:["uSampler"]},{code:s.tp_7,a:["aPosition","aTexcoord","aCenter"],u:["uModelViewProj","offsetMatrix","uProgress","opacity","style","isX"],s:["uSampler1","uSampler2"]},{code:s.tp_8,a:["aPosition","aTexcoord","aCenter","aDelay"],u:["uModelViewProj","uTime","uSpinFactor","uFactor","uReverseAngle","uGrowFactor","uOpacitySpeed"],s:["uSampler"]},{code:s.tp_9,a:["aPosition","aTexcoord"],u:["uModelViewProj","offsetMatrix","dirMatrix","opacity","isInvX"],s:["uSampler1","uSampler2"]}],d=0,h=[];function c(e){return void 0===e.transitionId&&(d+=1,e.transitionId=d),h[d]}function u(e){return r(this,void 0,void 0,(function(){var t,i;return n(this,(function(r){for(t=[],c(e)||(h[e.transitionId]=new Array(10)),i=0;i<10;i++)t.push(f(e,i));return[2,Promise.all(t)]}))}))}function f(e,t){return r(this,void 0,void 0,(function(){var i;return n(this,(function(r){if(!(i=c(e)))throw o.logError("Shader Programs should be defined.");return i[t]||(i[t]=function(e,t){var i=l[t];return new a.Effect({vertexSource:i.code.v,fragmentSource:i.code.f,spectorName:t},i.a,i.u,i.s,e,void 0,void 0,void 0,(function(e,i){!function(e,t,i){if(i){var r="Program "+e+" ",n=t.getPipelineContext();n.vertexCompilationError&&o.logError(r+" V compile failed: "+n.vertexCompilationError),n.fragmentCompilationError&&o.logError(r+" F compile failed: "+n.fragmentCompilationError),n.programLinkError&&o.logError(r+" link failed: "+n.programLinkError),n.programValidationError&&o.logError(r+" validation failed: "+n.programValidationError),o.logError(r+" preparation failed: "+i)}}(t,e,i)}))}(e,t)),[2,new Promise((function(e,r){var n,a,s;(null===(n=i[t])||void 0===n?void 0:n.isReady())?e():(null===(a=i[t])||void 0===a||a.onCompileObservable.add((function(){return e()})),null===(s=i[t])||void 0===s||s.onErrorObservable.add(r))}))]}))}))}t.activateShader=function(e,t){var i=c(e);if(i){var r=i[t];if(r){if(r.isReady())return e.enableEffect(r),r;o.logError("Can not activate shader, program is not ready yet (please await initialization).")}else o.logError("Can not activate shader, program has not been found.")}else o.logError("Can not activate shader, ShaderProgram has not been initialiazed (please await initialization).")},t.initializeAsync=function(e){return r(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:if(!e)throw o.logError("Engine should be defined.");return c(e)?[2]:[4,u(e)];case 1:return t.sent(),[2]}}))}))},t.disposePrograms=function(e){if(!e)throw o.logError("Engine should be defined.");var t=c(e);if(t)for(var i=0;i<10;i++){var r=t[i];r&&r.dispose(),t[i]=void 0}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r=function(){}},function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(0),n=i(22),a=i(36),s=i(5),o=i(11),l=i(61),d=i(7),h=i(18);class c{constructor(){this.textShapes=[],this.hitTestLineShapes=[]}clearCache(){for(let e of this.textShapes)e.clearCache();for(let e of this.hitTestLineShapes)e.clearCache();for(let e of this.selectionShapes||[])e.clearCache()}getTextShapes(){return this.textShapes}getSelectionShapes(){return this.selectionShapes||[]}initShapeEffectsAndBoundsOverrides(e,t,i,n,s,o){if(t.effects=function(e,t,i){if(!e)return;const r=t?t.fontHeightInPoints:0,n=e.clone(),a=0==r?1:r/C;return n.glow&&(n.glow.radius=p(n.glow.radius,r,g,_,v)/2),n.shadow&&(n.shadow.radius=p(n.shadow.radius,r,y,b,S),n.shadow.distance=p(n.shadow.distance,r,y,b,S)),n.innerShadow&&(n.innerShadow.radius=p(n.innerShadow.radius,r,T,w,M),n.innerShadow.distance=p(n.innerShadow.distance,r,T,w,M)),n.reflection&&(n.reflection.radius*=a,t&&(n.reflection.distance*=0!=t.ascent&&0!=t.descent?r*t.descent/t.ascent/I:a)),n.softEdges&&(n.softEdges.radius*=a),n.direction=i,n}(e.getEffetcsAt(s),i?i.textEffectMetrics:void 0,-e.frameToShape.rotation)||new l.a,!i.bender){if(e.applyEffectsPerCharacter||o){const i=e.getBoundsOfRange(new a.j(s,1));t.effectsBoundsOverride=i,o&&t.style.fillBrush instanceof d.e||(t.fillBoundsOverride=i)}else{const a=i.fillBounds.translate(n).transformedBounds(r.b.FromTransforms(e.layoutToFrame,e.frameToShape));t.effectsBoundsOverride=a,t.fillBoundsOverride=e.spreadFill?e.getBoundsOfRange(void 0):a}t.textEffectMetrics=i.textEffectMetrics}}getTextShape(e,t){const i=e.getStyleAt(t.start),r=e.getTextPathsForRange(t,null==i?void 0:i.hasLine),n=new o.e(r,i),a=e.getLineAndParagraphAt(t.start);return a&&this.initShapeEffectsAndBoundsOverrides(e,n,a.line,a.line.offset.add(a.paragraph.offset),t.start,!1),n.role=3,n.textRange=t,n.overlapMode=1,n.transform=e.frameToShape,n}getStrokeShape(e,t,i){const r=new o.e(this.getStrokePaths(e,t,i),i.style?i.style:e.getStyleAt(t.start)),n=e.getLineAndParagraphAt(t.start);return n&&this.initShapeEffectsAndBoundsOverrides(e,r,n.line,n.line.offset.add(n.paragraph.offset),t.start,!1),r.role=3,r.textRange=t,r.overlapMode=1,r.transform=e.frameToShape,r}getSelectionHighlightShapes(e){if(!e.selectionHighlights)return;const t=[];for(let i of e.selectionHighlights)if(i.range.length>0){let r=e.getSelectionRectPaths(i.range);r&&t.push(new o.e(r,i.style))}else{let r=e.getSelectionLayoutCaretPath(i.range.start,i.caretWidth,i.isAnchoredToPrevious);r&&t.push(new o.e([r],i.style))}return t}update(e){if(e.textVersion!=this.lastKnownTextVersion){this.lastKnownTextVersion=e.textVersion,this.clearCache(),this.textShapes=[],this.hitTestLineShapes=[];const t=[],i=[];0!=e.renderMode&&(this.cutoutLayerPaths=void 0);for(let r of e.paragraphs)if(r.bullet){const n=e.getLineAndParagraphAt(r.globalRange.start);if(n){const s=new a.j(r.globalRange.start,0);for(let n of r.bullet.strokes?r.bullet.strokes.elements:[])0==n.type?t.push(this.getStrokeShape(e,s,n)):i.push(this.getStrokeShape(e,s,n));const l=e.getTextPathsForCharacter(r.bullet.character,r.offset,r.lines.length>0?r.lines[0].bender:void 0),d=new o.e(l,r.bullet.style?r.bullet.style:e.getStyleAt(s.start));this.initShapeEffectsAndBoundsOverrides(e,d,n.line,n.paragraph.offset,s.start,!0),d.role=3,d.textRange=new a.j(r.globalRange.start,0),d.transform=e.frameToShape,i.push(d)}}const s=e.getSelectionRectPaths(void 0);for(let t of s||[]){const i=new o.e([t],new d.k(new d.i(d.b.Black)));i.transform=e.frameToShape,this.hitTestLineShapes.push(i)}const l=e.getRunRanges(),c=[];for(let t of l){const i=e.getBoundsOfRange(t);if(i&&i.width>2048){const e=Math.ceil(i.width/2048);for(let i=0;i<e;i++){const r=Math.floor(t.start+i*t.length/e),n=i==e-1?t.last+1:Math.floor(t.start+(i+1)*t.length/e);r<n&&c.push(a.j.FromFirstLast(r,n-1))}}else c.push(t)}for(let t of c)i.push(this.getTextShape(e,t));for(let r of c){const n=e.getStrokesAt(r.start);for(let a of n?n.elements:[])0==a.type?t.push(this.getStrokeShape(e,r,a)):i.push(this.getStrokeShape(e,r,a))}for(let t of e.paragraphs)for(let s of t.lines)for(let l=0;l<s.characters.length;l++){const h=s.characters[l];if(h.textImage){let c=n.a.CreateFromRect(h.textImage.rect);h.textImage.useLocalCordinates&&(c=c.transform(r.b.FromTransforms(h.textImage.transform,r.b.Translation2D(s.offset.add(t.offset)),e.layoutToFrame)));const u=new o.e([new n.c({figures:[c]})],new d.k(new d.e(h.textImage.image)));u.role=h.textImage.useLocalCordinates?3:4,u.textRange=new a.j(l+s.localRange.start+t.globalRange.start,1),u.transform=h.textImage.useLocalCordinates?e.frameToShape:h.textImage.transform,i.push(u)}}if(h.x){for(let t of e.paragraphs)for(let r of t.lines)if(r.bender instanceof a.m){const a=new o.e([n.c.CreateFromFigure(r.bender.topPath)],new d.k(void 0,new d.i(d.b.Cyan),new d.h(1))),s=new o.e([n.c.CreateFromFigure(r.bender.bottomPath)],new d.k(void 0,new d.i(d.b.Magenta),new d.h(1)));a.textRange=s.textRange=r.localRange.move(t.globalRange.start),a.transform=e.frameToShape,s.transform=e.frameToShape,i.push(a),i.push(s)}else if(r.bender instanceof a.a){const a=new o.e([n.c.CreateFromFigure(r.bender.path)],new d.k(void 0,new d.i(d.b.Yellow),new d.h(1)));a.textRange=r.localRange.move(t.globalRange.start),a.transform=e.frameToShape,i.push(a)}const t=e.getAnimatablePartRanges(2,void 0,!0);for(let r of t||[]){const t=e.getBoundsOfRange(r);if(t){const e=new o.e([n.c.CreateFromRect(t)],new d.k(void 0,new d.i(d.b.Blue),new d.h(1)));e.textRange=r,i.push(e)}}for(let t of e.paragraphs)for(let a of t.lines){const s=a.fillBounds.translate(a.offset.add(t.offset)).transformedBounds(r.b.FromTransforms(e.layoutToFrame,e.frameToShape));if(s&&a.textEffectMetrics){const e=new r.c(s.left,s.top,s.right,s.top+a.textEffectMetrics.ascent),l=new r.c(s.left,s.bottom-a.textEffectMetrics.descent,s.right,s.bottom),h=new o.e([n.c.CreateFromRect(e)],new d.k(void 0,new d.i(d.b.Red),new d.h(1))),c=new o.e([n.c.CreateFromRect(l)],new d.k(void 0,new d.i(d.b.Green),new d.h(1)));h.textRange=a.localRange.move(t.globalRange.start),c.textRange=a.localRange.move(t.globalRange.start),i.push(h),i.push(c)}}}this.textShapes.push(...t),this.textShapes.push(...i);for(let t of this.textShapes)if(4==t.role){if(e.clipBounds){const i=t.getBounds(!1,!1,!0),n=null==i?void 0:i.transformedBounds(e.frameToShape.toInverseMatrix3()),a=n?e.clipBounds.clip(n):void 0,s=null==a?void 0:a.transformedBounds(e.frameToShape.toMatrix3().multiply(t.transform.toInverseMatrix3()));t.clipBounds=s?r.a.CreateFromRect(s):void 0,s||(t.paths=[])}}else t.clipBounds=e.clipBounds;if(0!=e.renderMode){if(this.cutoutLayerPaths=[],3==e.renderMode){const t=e.getCutoutLinePath(void 0,e.linesCutoutMargin);for(let e of t||[])this.cutoutLayerPaths.push(e)}for(let e of t)this.cutoutLayerPaths.push(...e.paths||[]);for(let e of i)this.cutoutLayerPaths.push(...e.paths||[])}}if(e.selectionVersion!=this.lastKnownSelectionVersion){this.lastKnownSelectionVersion=e.selectionVersion;const t=this.getSelectionHighlightShapes(e);if(t){if(this.selectionShapes=[],new d.k(new d.i(d.b.White)).blendingMode=2,t){this.selectionShapes.push(...t);for(let t of this.selectionShapes)t.transform=e.frameToShape}}else{for(let e of this.selectionShapes||[])e.clearCache();this.selectionShapes=void 0}}}getStrokePaths(e,t,i){const s=[];for(let o of e.paragraphs)if(o.globalRange.intersects(t))for(let l of o.lines){let d,h;const c=new a.j(0,l.characters.length).getIntersection(t.move(-o.globalRange.start-l.localRange.start));if(c)for(let e=c.start;e<=c.last;e++){const t=l.characters[e].layoutBounds;t.isEmpty()||(d=null==d?t.left:Math.min(d,t.left),h=null==h?t.right:Math.max(h,t.right))}if(null!=d&&null!=h&&d<h){const t=r.b.Translation2D(l.offset.add(o.offset)).multiply(e.layoutToFrame.toMatrix3()).tryGetTransform(r.e.Zero);if(t){let e=new n.c({figures:m(i,d,h),transform:t});const r=l.bender instanceof a.a?l.bender.equivalentWarpingEnvelope:l.bender;r&&(e=r.warpPath(e)),s.push(e)}}}return s}}function u(e,t,i){const r=t.y-i,a=Math.ceil(t.x/(2*r));let s=e.x;const o=new n.b;o.moveTo(s,e.y),o.lineTo(s,e.y+i);for(let n=0;n<a;n++)s+=r,o.lineTo(s,e.y+t.y),s+=r,o.lineTo(s,e.y+i);o.lineTo(s,e.y);for(let n=0;n<a;n++)s-=r,o.lineTo(s,e.y+t.y-i),s-=r,o.lineTo(s,e.y);return o.close(),o.createFigure()}function f(e,t,i,a,s,o){const l=[];let d=e.x;const h=t.y,c=t.y*i,u=t.y*a,f=o?e.y-t.y:e.y,m=o?e.y+t.y/2:e.y+t.y;let p=0;for(;d<e.x+t.x;){const i=s&&p%(s+1)!=0?h:c,a=Math.min(d+i,t.x+e.x);l.push(n.a.CreateFromRect(new r.c(d,f,a,m))),d+=u+i,p++}return l}function m(e,t,i){const a=new r.e(t,e.verticalCenter-.5*e.thickness),o=new r.e(i-t,e.thickness),l=[],d=3==e.type||5==e.type||7==e.type||9==e.type||11==e.type||13==e.type||15==e.type;switch(e.type){case 3:case 1:case 0:d?l.push(n.a.CreateFromRect(new r.c(a.x,a.y-o.y,a.x+o.x,a.y+Math.ceil(o.y/2)))):l.push(n.a.CreateFromRect(new r.c(a.x,a.y,a.x+o.x,a.y+o.y)));break;case 2:{const e=!1;l.push(...function(e,t,i){const a=[];return i?(a.push(n.a.CreateFromRect(new r.c(e.x,e.y,e.x+t.x,e.y+t.y/2))),a.push(n.a.CreateFromRect(new r.c(e.x,e.y+t.y,e.x+t.x,e.y+3*t.y/2)))):(a.push(n.a.CreateFromRect(new r.c(e.x,e.y-t.y,e.x+t.x,e.y-t.y/2))),a.push(n.a.CreateFromRect(new r.c(e.x,e.y+t.y/2,e.x+t.x,e.y+t.y)))),a}(a,o,e));break}case 5:case 4:l.push(...f(a,o,1,1,1,d));break;case 7:case 6:l.push(...f(a,o,3,2,0,d));break;case 9:case 8:l.push(...f(a,o,7,4,0,d));break;case 10:case 11:l.push(...f(a,o,3,2,1,d));break;case 12:case 13:l.push(...f(a,o,3,2,2,d));break;case 14:case 15:{let t=2*o.y,i=1;15==e.type&&(t=Math.floor(Math.max(3,2*o.y)),i=Math.max(2,Math.floor(o.y/2))),l.push(u(new r.e(a.x,a.y-Math.ceil(o.y/2)),new r.e(o.x,t),i))}break;case 16:{const e=1,t=Math.max(2,o.y),i=a.y-t;l.push(u(new r.e(a.x,i),new r.e(o.x,t),e)),l.push(u(a,new r.e(o.x,t),e))}break;default:s.a.Error(591525085,"Unknown stroke type")}return l}function p(e,t,i,r,n){return 0!=t&&n<e?(e-n)*Math.pow(t,r)/Math.pow(i,r)+n:0==t?e:0}const g=72,_=.7,v=1,y=72,b=.7,S=.4,T=108,w=1,M=.001,C=72,I=4},function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(4),n=i(2),a=i(3),s=i(1),o=i(12),l=i(15),d=i(8),h=i(31),c=i(6);class u{constructor(e){this.events=new h.EventEmitter,this.m_subscriberCount=0,this.m_fGLContextLostErrorLogged=!0,this.m_fSVGFallbackMode=!1,this.m_fSVGFallbackModeErrorLogged=!1,this.m_supportedFormats=["RGBA","BGRA","NV12"],this.m_lastGoodTextureUpdateTime=void 0,this.m_environment=e}static getInstance(e){return this.m_instance||(this.m_instance=new this(e)),this.m_instance}get cameoSharedTexture(){if(!this.m_cameoSharedTexture)try{if(this.m_environment.rendererEnvironment.glContext&&this.m_environment.rendererEnvironment.isGLContextValid){const e=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);this.m_cameoSharedTexture=l.b.CreateFromByteBuffer("Cameo",this.m_environment.rendererEnvironment.renderer,new d.b(2,2),new Uint8Array(e),-2,4,!0,!0),this.m_environment.viewDataManager.memoryStats.cameoTextures+=16,r.a.sendTraceTag(525124629,n.a.msoulscat_Wac_PptSession,a.a.Info,"CameoTextureManager::get_cameoSharedTexture Blank Texture initialized")}else o.VetoUtils.recordVeto("CameoRenderedWithIssues",{errorName:"MorphBlankTextureInitFailed",qosVeto:"CameoRenderedWithIssues"}),r.a.sendTraceTag(526770847,n.a.msoulscat_Wac_PptSession,a.a.Warning,"CameoTextureManager::get_cameoSharedTexture glContext unavailable. Morph (if any) may not work as expected.")}catch(e){o.VetoUtils.recordVeto("CameoRenderedWithIssues",{errorName:"MorphBlankTextureInitFailed",qosVeto:"CameoRenderedWithIssues"}),r.a.sendTraceTag(526942348,n.a.msoulscat_Wac_PptSession,a.a.Warning,`CameoTextureManager::get_cameoSharedTexture: Morph may not work as expected due to exception creating blank texture=${e}.`)}return this.m_cameoSharedTexture}subscribeToSharedTexture(){this.m_subscriberCount+=1,r.a.sendTraceTag(526951687,n.a.msoulscat_Wac_PptSession,a.a.Info,`CameoTextureManager::subscribeToSharedTexture: subscribersCount=${this.m_subscriberCount}.`)}unsubscribeFromSharedTexture(){this.m_subscriberCount>0&&(this.m_subscriberCount-=1,r.a.sendTraceTag(526951688,n.a.msoulscat_Wac_PptSession,a.a.Info,`CameoTextureManager::unsubscribeFromSharedTexture: subscribersCount=${this.m_subscriberCount}.`),0===this.m_subscriberCount&&this.releaseTexture())}processFrameForCameo(e,t){if(s.Settings.readBooleanOrDefault("forceSvg",!1))this.m_fSVGFallbackMode||(this.m_fSVGFallbackMode=!0,r.a.sendTraceTag(526987925,n.a.msoulscat_Wac_PptSession,a.a.Error,"CameoTextureManager::processFrameForCameo: Modern SS has fallen back to SVG mode"),o.VetoUtils.recordVeto("CameoInSVG",{errorName:"WebGLNotAvailable",qosVeto:"CameoInSVG",isIntentional:!0}));else{if(this.m_fSVGFallbackMode&&!this.m_fSVGFallbackModeErrorLogged&&(r.a.sendTraceTag(525123978,n.a.msoulscat_Wac_PptSession,a.a.Warning,"CameoTextureManager::processFrameForCameo: Modern SS seems to have unexpectedly recovered from SVG mode."),this.m_fSVGFallbackModeErrorLogged=!0),!t||!e)return r.a.sendTraceTag(526987920,n.a.msoulscat_Wac_PptSession,a.a.Error,"CameoTextureManager::processFrameForCameo: invalid input buffer or buffer metadata not provided."),this.logVetoIfCameoNotRendering(Date.now(),"EmptyBufferOrMetadata"),void this.releaseTexture();if(this.m_subscriberCount>0){const i=this.parseArrayBufferMetadata(e);i&&this.updateTextureFromArrayBuffer(t,i)}}}releaseTexture(){if(this.m_cameoSharedTexture){const e=this.m_cameoSharedTexture.size;this.m_cameoSharedTexture.release(),this.m_environment.viewDataManager.memoryStats.cameoTextures-=e.x*e.y*4,this.m_cameoSharedTexture=void 0,this.events.emit("cameoSharedTextureReleased"),r.a.sendTraceTag(526951689,n.a.msoulscat_Wac_PptSession,a.a.Info,`CameoTextureManager::releaseTexture: subscribersCount=${this.m_subscriberCount}.`)}}setVideoElement(e){this.m_videoElement=e}updateTextureFromVideoElement(){try{if(!this.m_videoElement||this.m_subscriberCount<=0)return;if(s.Settings.readBooleanOrDefault("forceSvg",!1))return void(this.m_fSVGFallbackMode||(this.m_fSVGFallbackMode=!0,r.a.sendTraceTag(508339653,n.a.msoulscat_Wac_PptSession,a.a.Error,"CameoTextureManager::updateTextureFromVideoElement: In SVG mode thus unable to render"),o.VetoUtils.recordVeto("CameoInSVG",{errorName:"WebGLNotAvailable",qosVeto:"CameoInSVG",isIntentional:!0})));const e=this.m_environment.rendererEnvironment.glContext;if(!e||e.isContextLost())return this.m_fGLContextLostErrorLogged||(r.a.sendTraceTag(509745359,n.a.msoulscat_Wac_PptSession,a.a.Error,"CameoTextureManager::updateTextureFromVideoElement: Unable to update frame due to missing gl context"),this.m_fGLContextLostErrorLogged=!0),this.logVetoIfCameoNotRendering(Date.now(),"RenderingContextLost"),void this.releaseTexture();if(!this.isVideoReadyForTextureExtraction(this.m_videoElement))return this.logVetoIfCameoNotRendering(Date.now(),"VideoElementError"),void this.releaseTexture();c.ChangeGate.isChangeGateEnabled("SVM.enableResizeSupportForMediaStreamCameo")&&this.updateVideoElementDimensions();const t=this.m_frameSize?this.m_frameSize.x*this.m_frameSize.y*4:0;this.m_frameSize=new d.b(this.m_videoElement.width,this.m_videoElement.height),this.m_cameoSharedTexture=l.b.CreateOrUpdateFromHTMLElement("Cameo",this.m_cameoSharedTexture,this.m_environment.rendererEnvironment.renderer,this.m_videoElement),this.m_lastGoodTextureUpdateTime=Date.now(),this.events.emit("cameoSharedTextureUpdated",this.m_frameSize);const i=this.m_frameSize.x*this.m_frameSize.y*4;i!==t&&(this.m_environment.viewDataManager.memoryStats.cameoTextures+=i-t)}catch(e){r.a.sendTraceTag(509745358,n.a.msoulscat_Wac_PptSession,a.a.Error,`CameoTextureManager::updateTextureFromVideoElement: exception ${e}.`),this.logVetoIfCameoNotRendering(Date.now(),"TextureCreateOrUpdateException"),this.releaseTexture()}}isVideoReadyForTextureExtraction(e){return!(!e||e.paused||e.ended||e.error||!e.srcObject||!e.srcObject.active||!this.isVideoLoaded(e))}isVideoLoaded(e){return!!e&&e.readyState>=3}updateVideoElementDimensions(){if(this.m_videoElement&&(this.m_videoTrack||(this.m_videoTrack=this.getVideoTrackFromElement(this.m_videoElement)),this.m_videoTrack)){const e=this.m_videoTrack.getSettings();e.width&&e.height&&(e.width!==this.m_videoElement.width||e.height!==this.m_videoElement.height)&&(this.m_videoElement.width=e.width,this.m_videoElement.height=e.height,r.a.sendTraceTag(508408082,n.a.msoulscat_Wac_PptSession,a.a.Info,`CameoTextureManager::updateVideoElementDimensions: detected resolution change to width=${e.width}, height=${e.height}`))}}getVideoTrackFromElement(e){if(!e||!e.srcObject)return;const t=e.srcObject;if(!t)return;const i=t.getVideoTracks();return i&&i.length>0?i[0]:void 0}parseArrayBufferMetadata(e){try{const t=JSON.parse(e),i=t.width,s=t.height;return i&&s?"number"==typeof i&&i>0&&"number"==typeof s&&s>0?{width:i,height:s,format:this.getTextureFormatFromString(t.format)}:(r.a.sendTraceTag(526987923,n.a.msoulscat_Wac_PptSession,a.a.Error,`CameoTextureManager::parseArrayBufferMetadata: invalid frame size, x:${i}, y:${s}`),this.logVetoIfCameoNotRendering(Date.now(),"InvalidFrameSize"),void this.releaseTexture()):(0===i&&0===s?this.m_cameoSharedTexture&&r.a.sendTraceTag(526987921,n.a.msoulscat_Wac_PptSession,a.a.Info,"CameoTextureManager::parseArrayBufferMetadata: Received 0x0 frame from MSTeams. Cleared texture."):(r.a.sendTraceTag(526987922,n.a.msoulscat_Wac_PptSession,a.a.Error,"CameoTextureManager::parseArrayBufferMetadata: unable to parse valid frame metadata."),this.logVetoIfCameoNotRendering(Date.now(),"FrameDimensionsMissing")),void this.releaseTexture())}catch(e){return r.a.sendTraceTag(526987924,n.a.msoulscat_Wac_PptSession,a.a.Error,`CameoTextureManager::parseArrayBufferMetadata: exception ${e}.`),this.logVetoIfCameoNotRendering(Date.now(),"FrameMetadataParseFailure"),void this.releaseTexture()}}updateTextureFromArrayBuffer(e,t){try{const i=this.m_environment.rendererEnvironment.glContext;if(!i||i.isContextLost())return this.m_fGLContextLostErrorLogged||(r.a.sendTraceTag(526987926,n.a.msoulscat_Wac_PptSession,a.a.Error,"CameoTextureManager::updateTextureFromArrayBuffer: Unable to update frame due to missing gl context"),this.m_fGLContextLostErrorLogged=!0),this.logVetoIfCameoNotRendering(Date.now(),"RenderingContextLost"),void this.releaseTexture();const s=this.m_frameSize?this.m_frameSize.x*this.m_frameSize.y*4:0;this.m_frameSize=new d.b(t.width,t.height),this.m_cameoSharedTexture=l.b.CreateOrUpdateFromByteBuffer("Cameo",this.m_cameoSharedTexture,this.m_environment.rendererEnvironment.renderer,this.m_frameSize,new Uint8Array(e),t.format,4,!0,!0,void 0,!0),this.m_lastGoodTextureUpdateTime=Date.now(),this.events.emit("cameoSharedTextureUpdated",this.m_frameSize);const o=this.m_frameSize.x*this.m_frameSize.y*4;o!==s&&(this.m_environment.viewDataManager.memoryStats.cameoTextures+=o-s)}catch(e){r.a.sendTraceTag(526987927,n.a.msoulscat_Wac_PptSession,a.a.Error,`CameoTextureManager::updateTextureFromArrayBuffer: exception ${e}.`),this.logVetoIfCameoNotRendering(Date.now(),"TextureCreateOrUpdateException"),this.releaseTexture()}}getTextureFormatFromString(e){if(e){const t=e.toUpperCase();if(this.m_supportedFormats.includes(t)){if("BGRA"===t)return-2;if("NV12"===t)return-3}}return 5}logVetoIfCameoNotRendering(e,t){if(!this.m_lastGoodTextureUpdateTime)return;const i=e-this.m_lastGoodTextureUpdateTime;i>=s.Settings.readNumberOrDefault("cameoNotRenderingThresholdMs",5e3)&&(r.a.sendTraceTag(525124630,n.a.msoulscat_Wac_PptSession,a.a.Error,`CameoTextureManager::logVetoIfCameoNotRendering: No successful texture update in ${i/1e3} seconds, latest error: ${t}`),o.VetoUtils.recordVeto("CameoNotRendering",{qosVeto:"CameoNotRendering",errorName:t,textureUpdateDelay:i}),this.m_lastGoodTextureUpdateTime=void 0)}}},function(e,t,i){"use strict";t.randomBytes=t.rng=t.pseudoRandomBytes=t.prng=i(103),t.createHash=t.Hash=i(116),t.createHmac=t.Hmac=i(190);var r=i(297),n=Object.keys(r),a=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(n);t.getHashes=function(){return a};var s=i(193);t.pbkdf2=s.pbkdf2,t.pbkdf2Sync=s.pbkdf2Sync;var o=i(299);t.Cipher=o.Cipher,t.createCipher=o.createCipher,t.Cipheriv=o.Cipheriv,t.createCipheriv=o.createCipheriv,t.Decipher=o.Decipher,t.createDecipher=o.createDecipher,t.Decipheriv=o.Decipheriv,t.createDecipheriv=o.createDecipheriv,t.getCiphers=o.getCiphers,t.listCiphers=o.listCiphers;var l=i(314);t.DiffieHellmanGroup=l.DiffieHellmanGroup,t.createDiffieHellmanGroup=l.createDiffieHellmanGroup,t.getDiffieHellman=l.getDiffieHellman,t.createDiffieHellman=l.createDiffieHellman,t.DiffieHellman=l.DiffieHellman;var d=i(321);t.createSign=d.createSign,t.Sign=d.Sign,t.createVerify=d.createVerify,t.Verify=d.Verify,t.createECDH=i(369);var h=i(372);t.publicEncrypt=h.publicEncrypt,t.privateEncrypt=h.privateEncrypt,t.publicDecrypt=h.publicDecrypt,t.privateDecrypt=h.privateDecrypt;var c=i(376);t.randomFill=c.randomFill,t.randomFillSync=c.randomFillSync,t.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))},t.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},function(e,t,i){"use strict";i.d(t,"b",(function(){return k})),i.d(t,"d",(function(){return L})),i.d(t,"c",(function(){return F})),i.d(t,"a",(function(){return D}));var r=i(28),n=i(13);const a='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">',s='<path d="M12.4014 13.2403C13.222 12.83 14.2039 12.9967 14.8536 13.6464C15.0488 13.8417 15.0488 14.1583 14.8535 14.3536C14.6583 14.5488 14.3417 14.5488 14.1464 14.3535C13.7961 14.0032 13.278 13.92 12.8486 14.1347C12.4366 14.3407 12 14.8852 12 16C12 17.1148 12.4366 17.6593 12.8486 17.8653C13.278 18.08 13.7961 17.9967 14.1464 17.6464C14.3417 17.4512 14.6583 17.4512 14.8536 17.6464C15.0488 17.8417 15.0488 18.1583 14.8536 18.3535C14.2039 19.0032 13.222 19.17 12.4014 18.7597C11.5634 18.3407 11 17.3852 11 16C11 14.6149 11.5634 13.6593 12.4014 13.2403ZM20.3536 13.6465C19.7039 12.9968 18.722 12.83 17.9014 13.2403C17.0634 13.6593 16.5 14.6149 16.5 16C16.5 17.3852 17.0634 18.3407 17.9014 18.7597C18.722 19.17 19.7039 19.0033 20.3536 18.3536C20.5488 18.1583 20.5488 17.8417 20.3536 17.6465C20.1583 17.4512 19.8417 17.4512 19.6464 17.6465C19.2961 17.9968 18.778 18.08 18.3486 17.8653C17.9366 17.6593 17.5 17.1148 17.5 16C17.5 14.8852 17.9366 14.3408 18.3486 14.1347C18.778 13.9201 19.2961 14.0033 19.6464 14.3536C19.8417 14.5488 20.1583 14.5488 20.3535 14.3536C20.5488 14.1583 20.5488 13.8417 20.3536 13.6465ZM8 13C8 11.3431 9.34315 10 11 10H21C22.6569 10 24 11.3431 24 13V19C24 20.6569 22.6569 22 21 22H11C9.34315 22 8 20.6569 8 19V13ZM11 11C9.89543 11 9 11.8954 9 13V19C9 20.1046 9.89543 21 11 21H21C22.1046 21 23 20.1046 23 19V13C23 11.8954 22.1046 11 21 11H11Z" fill="white"/>',o=`${a}${s}</svg>`,l=`${a}${s}<rect y="31.885" width="2" height="32" transform="rotate(-90 0 31.885)" fill="white"/></svg>`;function d(e){let t="";switch(e){case"play-pause-gfxicon":t='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path id="play-gfxicon" class="invisible" fill="#FFFFFF" fill-opacity="1.000" d="M24.1059 15.0879C25.1413 15.6575 25.1413 17.1443 24.1059 17.7139L14.1089 23.2129C13.1092 23.7628 11.8855 23.0402 11.8855 21.9L11.8855 10.9018C11.8855 9.76156 13.1092 9.03893 14.1089 9.58883L24.1059 15.0879ZM23.6236 16.8385C23.9688 16.6487 23.9688 16.1531 23.6236 15.9632L13.6266 10.4641C13.2934 10.2808 12.8855 10.5217 12.8855 10.9018L12.8855 21.9C12.8855 22.28 13.2934 22.5209 13.6266 22.3376L23.6236 16.8385Z"/><path  id="pause-gfxicon" fill="#FFFFFF" fill-opacity="1.000" d="M11.8855 8.77393C10.7809 8.77393 9.8855 9.66936 9.8855 10.7739V22.7739C9.8855 23.8785 10.7809 24.7739 11.8855 24.7739H13.8855C14.9901 24.7739 15.8855 23.8785 15.8855 22.7739V10.7739C15.8855 9.66936 14.9901 8.77393 13.8855 8.77393H11.8855ZM10.8855 10.7739C10.8855 10.2216 11.3332 9.77393 11.8855 9.77393H13.8855C14.4378 9.77393 14.8855 10.2216 14.8855 10.7739V22.7739C14.8855 23.3262 14.4378 23.7739 13.8855 23.7739H11.8855C11.3332 23.7739 10.8855 23.3262 10.8855 22.7739V10.7739ZM19.8855 8.77393C18.7809 8.77393 17.8855 9.66936 17.8855 10.7739V22.7739C17.8855 23.8785 18.7809 24.7739 19.8855 24.7739H21.8855C22.9901 24.7739 23.8855 23.8785 23.8855 22.7739V10.7739C23.8855 9.66936 22.9901 8.77393 21.8855 8.77393H19.8855ZM18.8855 10.7739C18.8855 10.2216 19.3332 9.77393 19.8855 9.77393H21.8855C22.4378 9.77393 22.8855 10.2216 22.8855 10.7739V22.7739C22.8855 23.3262 22.4378 23.7739 21.8855 23.7739H19.8855C19.3332 23.7739 18.8855 23.3262 18.8855 22.7739V10.7739Z"/></svg>';break;case"volume-gfxicon":t='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path id="volume-low-gfxicon" class="invisible" fill="#FFFFFF" fill-opacity="1.000" d="M17.9971 9.00613C17.9971 8.13311 16.9568 7.67928 16.3168 8.27313L12.4447 11.8665C12.3522 11.9523 12.2307 12 12.1046 12H9.49707C8.66864 12 7.99707 12.6716 7.99707 13.5V18.5C7.99707 19.3284 8.66864 20 9.49707 20H12.1046C12.2307 20 12.3522 20.0477 12.4447 20.1335L16.3168 23.7269C16.9568 24.3207 17.9971 23.8669 17.9971 22.9939V9.00613ZM13.1249 12.5995L16.9971 9.00613V22.9939L13.1249 19.4005C12.8475 19.1431 12.483 19 12.1046 19H9.49707C9.22093 19 8.99707 18.7761 8.99707 18.5V13.5C8.99707 13.2239 9.22093 13 9.49707 13H12.1046C12.483 13 12.8475 12.8569 13.1249 12.5995Z"/><path id="volume-medium-gfxicon" class="invisible" fill="#FFFFFF" fill-opacity="1.000" d="M17.9971 9.00613C17.9971 8.13311 16.9568 7.67928 16.3168 8.27313L12.4447 11.8665C12.3522 11.9523 12.2307 12 12.1046 12H9.49707C8.66864 12 7.99707 12.6716 7.99707 13.5V18.5C7.99707 19.3284 8.66864 20 9.49707 20H12.1046C12.2307 20 12.3522 20.0477 12.4447 20.1335L16.3168 23.7269C16.9568 24.3207 17.9971 23.8669 17.9971 22.9939V9.00613ZM13.1249 12.5995L16.9971 9.00613V22.9939L13.1249 19.4005C12.8475 19.1431 12.483 19 12.1046 19H9.49707C9.22093 19 8.99707 18.7761 8.99707 18.5V13.5C8.99707 13.2239 9.22093 13 9.49707 13H12.1046C12.483 13 12.8475 12.8569 13.1249 12.5995ZM20.0814 18.9332C19.8421 18.7954 19.7599 18.4897 19.8977 18.2504C20.6739 16.9028 20.7294 15.1916 19.897 13.7499C19.759 13.5108 19.8409 13.205 20.08 13.0669C20.3192 12.9288 20.625 13.0108 20.7631 13.2499C21.7811 15.0132 21.7112 17.1054 20.7642 18.7495C20.6264 18.9888 20.3207 19.0711 20.0814 18.9332Z"/><path id="volume-high-gfxicon" class="invisible" fill="#FFFFFF" fill-opacity="1.000" d="M17.9971 9.00613C17.9971 8.13311 16.9568 7.67928 16.3168 8.27313L12.4447 11.8665C12.3522 11.9523 12.2307 12 12.1046 12H9.49707C8.66864 12 7.99707 12.6716 7.99707 13.5V18.5C7.99707 19.3284 8.66864 20 9.49707 20H12.1046C12.2307 20 12.3522 20.0477 12.4447 20.1335L16.3168 23.7269C16.9568 24.3207 17.9971 23.8669 17.9971 22.9939V9.00613ZM13.1249 12.5995L16.9971 9.00613V22.9939L13.1249 19.4005C12.8475 19.1431 12.483 19 12.1046 19H9.49707C9.22093 19 8.99707 18.7761 8.99707 18.5V13.5C8.99707 13.2239 9.22093 13 9.49707 13H12.1046C12.483 13 12.8475 12.8569 13.1249 12.5995ZM22.1422 10.7746C22.3478 10.5903 22.6639 10.6076 22.8482 10.8133C25.5644 13.8449 25.5645 18.449 22.8483 21.4806C22.664 21.6863 22.3479 21.7036 22.1422 21.5194C21.9365 21.3351 21.9192 21.019 22.1035 20.8133C24.4794 18.1615 24.4794 14.1324 22.1034 11.4806C21.9192 11.2749 21.9365 10.9588 22.1422 10.7746ZM20.0814 18.9332C19.8421 18.7954 19.7599 18.4897 19.8977 18.2504C20.6739 16.9028 20.7294 15.1916 19.897 13.7499C19.759 13.5108 19.8409 13.205 20.08 13.0669C20.3192 12.9288 20.625 13.0108 20.7631 13.2499C21.7811 15.0132 21.7112 17.1054 20.7642 18.7495C20.6264 18.9888 20.3207 19.0711 20.0814 18.9332Z"/><path id="volume-muted-gfxicon" class="invisible" fill="#FFFFFF" fill-opacity="1.000" d="M17.9971 9.00613C17.9971 8.13311 16.9568 7.67928 16.3168 8.27313L12.4447 11.8665C12.3522 11.9523 12.2307 12 12.1046 12H9.49707C8.66864 12 7.99707 12.6716 7.99707 13.5V18.5C7.99707 19.3284 8.66864 20 9.49707 20H12.1046C12.2307 20 12.3522 20.0477 12.4447 20.1335L16.3168 23.7269C16.9568 24.3207 17.9971 23.8669 17.9971 22.9939V9.00613ZM13.1249 12.5995L16.9971 9.00613V22.9939L13.1249 19.4005C12.8475 19.1431 12.483 19 12.1046 19H9.49707C9.22093 19 8.99707 18.7761 8.99707 18.5V13.5C8.99707 13.2239 9.22093 13 9.49707 13H12.1046C12.483 13 12.8475 12.8569 13.1249 12.5995ZM20.029 14.1665C20.2243 13.9712 20.5409 13.9712 20.7361 14.1665L22.3826 15.8129L24.029 14.1665C24.2243 13.9712 24.5409 13.9712 24.7361 14.1665C24.9314 14.3617 24.9314 14.6783 24.7361 14.8736L23.0897 16.52L24.7361 18.1665C24.9314 18.3617 24.9314 18.6783 24.7361 18.8736C24.5409 19.0688 24.2243 19.0688 24.029 18.8736L22.3826 17.2271L20.7361 18.8736C20.5409 19.0688 20.2243 19.0688 20.029 18.8736C19.8338 18.6783 19.8338 18.3617 20.029 18.1665L21.6755 16.52L20.029 14.8736C19.8338 14.6783 19.8338 14.3617 20.029 14.1665Z"/></svg>';break;case"captions-gfxicon":t=o;break;case"captions-active-gfxicon":t=l;break;case"checkmark-gfxicon":t='<svg width="14" height="10" viewBox="0 0 14 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.3516 1.35156L5 9.71094L0.648438 5.35156L1.35156 4.64844L5 8.28906L12.6484 0.648438L13.3516 1.35156Z" fill="white"/></svg>';break;case"fullscreen-gfxicon":t='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path id="fullscreen-enter-gfxicon" d="M9.8855 11.8931C9.8855 10.7885 10.7809 9.89307 11.8855 9.89307H13.8855C14.1616 9.89307 14.3855 10.1169 14.3855 10.3931C14.3855 10.6692 14.1616 10.8931 13.8855 10.8931H11.8855C11.3332 10.8931 10.8855 11.3408 10.8855 11.8931V13.8931C10.8855 14.1692 10.6616 14.3931 10.3855 14.3931C10.1094 14.3931 9.8855 14.1692 9.8855 13.8931V11.8931ZM19.3855 10.3931C19.3855 10.1169 19.6094 9.89307 19.8855 9.89307H21.8855C22.9901 9.89307 23.8855 10.7885 23.8855 11.8931V13.8931C23.8855 14.1692 23.6616 14.3931 23.3855 14.3931C23.1094 14.3931 22.8855 14.1692 22.8855 13.8931V11.8931C22.8855 11.3408 22.4378 10.8931 21.8855 10.8931H19.8855C19.6094 10.8931 19.3855 10.6692 19.3855 10.3931ZM10.3855 19.3931C10.6616 19.3931 10.8855 19.6169 10.8855 19.8931V21.8931C10.8855 22.4454 11.3332 22.8931 11.8855 22.8931H13.8855C14.1616 22.8931 14.3855 23.1169 14.3855 23.3931C14.3855 23.6692 14.1616 23.8931 13.8855 23.8931H11.8855C10.7809 23.8931 9.8855 22.9976 9.8855 21.8931V19.8931C9.8855 19.6169 10.1094 19.3931 10.3855 19.3931ZM23.3855 19.3931C23.6616 19.3931 23.8855 19.6169 23.8855 19.8931V21.8931C23.8855 22.9976 22.9901 23.8931 21.8855 23.8931H19.8855C19.6094 23.8931 19.3855 23.6692 19.3855 23.3931C19.3855 23.1169 19.6094 22.8931 19.8855 22.8931H21.8855C22.4378 22.8931 22.8855 22.4454 22.8855 21.8931V19.8931C22.8855 19.6169 23.1094 19.3931 23.3855 19.3931Z" fill="white"/><path id="fullscreen-exit-gfxicon" d="M20.8855 11.2661C20.8855 11.8184 21.3332 12.2661 21.8855 12.2661L23.8855 12.2661C24.1616 12.2661 24.3855 12.49 24.3855 12.7661C24.3855 13.0423 24.1616 13.2661 23.8855 13.2661H21.8855C20.7809 13.2661 19.8855 12.3707 19.8855 11.2661V9.26611C19.8855 8.98997 20.1094 8.76611 20.3855 8.76611C20.6616 8.76611 20.8855 8.98997 20.8855 9.26611V11.2661ZM12.8855 21.2661C12.8855 20.7138 12.4378 20.2661 11.8855 20.2661H9.8855C9.60936 20.2661 9.3855 20.0423 9.3855 19.7661C9.3855 19.49 9.60936 19.2661 9.8855 19.2661H11.8855C12.9901 19.2661 13.8855 20.1615 13.8855 21.2661V23.2661C13.8855 23.5423 13.6616 23.7661 13.3855 23.7661C13.1094 23.7661 12.8855 23.5423 12.8855 23.2661V21.2661ZM20.8855 21.2661C20.8855 20.7138 21.3332 20.2661 21.8855 20.2661H23.8855C24.1616 20.2661 24.3855 20.0423 24.3855 19.7661C24.3855 19.49 24.1616 19.2661 23.8855 19.2661H21.8855C20.7809 19.2661 19.8855 20.1615 19.8855 21.2661V23.2661C19.8855 23.5423 20.1094 23.7661 20.3855 23.7661C20.6616 23.7661 20.8855 23.5423 20.8855 23.2661V21.2661ZM11.8855 12.2661C12.4378 12.2661 12.8855 11.8184 12.8855 11.2661L12.8855 9.26611C12.8855 8.98997 13.1094 8.76611 13.3855 8.76611C13.6616 8.76611 13.8855 8.98997 13.8855 9.26611V11.2661C13.8855 12.3707 12.9901 13.2661 11.8855 13.2661H9.8855C9.60936 13.2661 9.3855 13.0423 9.3855 12.7661C9.3855 12.49 9.60936 12.2661 9.8855 12.2661L11.8855 12.2661Z" fill="white"/></svg>'}const i=(new DOMParser).parseFromString(t,"image/svg+xml"),r=document.importNode(i.documentElement,!0);return r.classList.add(e),r.setAttribute("aria-hidden","true"),r}var h=i(9);const c=new Map([["ar",""],["ar-sa",""],["bn",""],["bn-bd",""],["bn-in",""],["cs","esky"],["cs-cz","esky"],["da","Dansk"],["da-dk","Dansk"],["de","Deutsch"],["de-at","Deutsch"],["de-ch","Deutsch"],["de-de","Deutsch"],["el",""],["el-gr",""],["en","English"],["en-au","English"],["en-ca","English"],["en-gb","English"],["en-ie","English"],["en-in","English"],["en-nz","English"],["en-us","English"],["en-za","English"],["es","Espaol"],["es-ar","Espaol"],["es-cl","Espaol"],["es-co","Espaol"],["es-es","Espaol"],["es-mx","Espaol"],["es-us","Espaol"],["fi","Suomi"],["fi-fi","Suomi"],["fr","Franais"],["fr-be","Franais"],["fr-ca","Franais"],["fr-ch","Franais"],["fr-fr","Franais"],["he",""],["he-il",""],["hi",""],["hi-in",""],["hu","Magyar"],["hu-hu","Magyar"],["id","Bahasa Indonesia"],["id-id","Bahasa Indonesia"],["it","Italiano"],["it-ch","Italiano"],["it-it","Italiano"],["ja",""],["jp",""],["jp-jp",""],["ko",""],["ko-kr",""],["nl","Nederlands"],["nl-be","Nederlands"],["nl-nl","Nederlands"],["no","Norsk (bokml / riksml)"],["no-no","Norsk (bokml / riksml)"],["pl","Polski"],["pl-pl","Polski"],["pt","Portugus"],["pt-br","Portugus"],["pt-pt","Portugus"],["ro","Romn"],["ro-ro","Romn"],["ru",""],["ru-ru",""],["sk","Slovenina"],["sk-sk","Slovenina"],["sv","Svenska"],["sv-se","Svenska"],["ta",""],["ta-in",""],["ta-lk",""],["th"," / Phasa Thai"],["th-yh"," / Phasa Thai"],["tr","Trke"],["tr-tr","Trke"],["zh",""],["zh-cn"," ()"],["zh-hans"," ()"],["zh-hant"," ()"],["zh-hk"," ()"],["zh-tw"," ()"],["unknown","Unknown"]]);function u(e){const t=c.get(e.toLowerCase());return void 0===t?e:t}function f(e,t){return null!==e&&null!==t&&e.toLowerCase().startsWith(t.toLowerCase())&&e.length>t.length&&"-"===e.charAt(t.length)}var m=i(79),p=i(259),g=i(47);function _(e){return e/1e3}function v(e){const t=Math.floor(e/3600),i=Math.floor((e-3600*t)/60);return[t,i,Math.floor(e-3600*t-60*i)]}function y(e){const[t,i,r]=v(e);return t>0?`${t}:${i<10?"0":""}${i}:${i<10?"0":""}${r}`:`${i}:${r<10?"0":""}${r}`}function b(e,t){const[i,r,n]=v(e);return t.localizedTimeStr.replace("{0}",""+(i>0?i.toFixed(0):"")).replace("{1}",""+(i>0?(o=i,1===o?t.localizedLabelsStr[0]:t.localizedLabelsStr[1]):"")).replace("{2}",""+(r>0?r.toFixed(0):"")).replace("{3}",""+(r>0?(s=r,1===s?t.localizedLabelsStr[2]:t.localizedLabelsStr[3]):"")).replace("{4}",(a=n,0===e?"0":a>0?a.toFixed(0):"")).replace("{5}",(i=>e>0&&0===i?"":1===i?t.localizedLabelsStr[4]:t.localizedLabelsStr[5])(n));var a,s,o}function S(e){e.classList.add("visible")}function T(e){e.classList.remove("visible")}function w(e){return e.classList.contains("invisible")}function M(e){e.classList.add("invisible")}function C(e){e.classList.remove("invisible")}function I(e){e.classList.toggle("invisible")}var P=i(33);function E(e,t){void 0!==e&&(e.style.display=t)}function x(e,t){void 0!==t&&e.appendChild(t)}class A{constructor(e,t,i,r,n,a,s,o,l){this.leftControls=e,this.rightControls=t,this.progressBar=i,this.timeContainer=r,this.volumeContainer=n,this.volumeSliderContainer=a,this.speedButton=s,this.captionsButton=o,this.fullscreenButton=l;let d=0;for(const e of[this.speedButton,this.captionsButton,this.fullscreenButton])void 0!==e&&(d+=32);const h=166+d;this.breakPoints=[h],this.breakPoints.push(h-86);for(const e of[this.speedButton,this.captionsButton,this.fullscreenButton])void 0!==e&&this.breakPoints.push(this.breakPoints[this.breakPoints.length-1]-32)}onHeightChanged(e){if(void 0===this.volumeSliderContainer)return;const t=e>=165;this.volumeSliderFitsInVideoRect!==t&&(t?this.volumeContainer.appendChild(this.volumeSliderContainer):this.volumeSliderContainer.remove(),this.volumeSliderFitsInVideoRect=t)}onWidthChanged(e){if(0===e)return;let t=0;for(;t<this.breakPoints.length&&!(e>=this.breakPoints[t]);)t++;if(this.breakPointsIdx===t)return;let i=!0,r=!0,n=!0,a=void 0!==this.captionsButton,s=void 0!==this.speedButton,o=void 0!==this.fullscreenButton,l=!1;switch(t){case this.breakPoints.length:case 5:i=!1,r=!1,n=!1,a=!1,s=!1,o=!1,l=!0;break;case 4:i=!1,n=!1,a=!1,s=!1,o=!1,l=!0;break;case 3:i=!1,n=!1;for(let e=0;e<2;e+=1)s?s=!1:o?o=!1:a&&(a=!1);l=!0;break;case 2:i=!1,n=!1,s?s=!1:o?o=!1:a&&(a=!1),l=!0;break;case 1:i=!1,n=!1}this.organize(i,n,r,s,a,o,l),this.breakPointsIdx=t}organize(e,t,i,r,n,a,s){E(this.progressBar,e?"":"none"),E(this.timeContainer,t?"":"none"),E(this.volumeContainer,i?"":"none"),E(this.speedButton,r?"":"none"),E(this.captionsButton,n?"":"none"),E(this.fullscreenButton,a?"":"none"),s?(x(this.leftControls,this.speedButton),x(this.leftControls,this.captionsButton),x(this.leftControls,this.fullscreenButton),this.leftControls.style.width="100%",this.leftControls.style.justifyContent="space-between"):(x(this.rightControls,this.speedButton),x(this.rightControls,this.captionsButton),x(this.rightControls,this.fullscreenButton),this.leftControls.style.width="",this.leftControls.style.justifyContent="")}}class k{constructor(e,t,i){this.presenter=e,this.attendee=t,this.noRole=i}}function R(e,t,i){e.style.background=Object(m.b)()?`linear-gradient(to right, ${n.D} ${t}%, ${n.F} ${t}% ${i}%, ${n.H} ${i}% 100%`:`linear-gradient(to right, ${n.C} ${t}%, ${n.E} ${t}% ${i}%, ${n.G} ${i}% 100%`}function O(e,t){e.style.background=Object(m.b)()?`linear-gradient(to right, ${n.D} ${t}%, ${n.H} ${t}% 100%`:`linear-gradient(to right, ${n.C} ${t}%, ${n.G} ${t}% 100%`}function L(e){return Number(e.replace(/px$/,""))}function F(e,t){const i=document.createElement(e);return i.classList.add(t),i}class D{constructor(e,t,i){this.captionsMinUIDelay=250,this.captionsButtonVisible=!1,this.captionsButtonEnabled=!1,this.captionsPlaybackInPlayer=!1,this.captionsMenuShown=!1,this.captionsScaleFactor=1,this.positioningStrategy=0,this.volumeSliderEnabled=!0,this.speedButtonEnabled=!1,this.fullscreenButtonEnabled=!1,this.nestedTabbingEnabled=!1,this.textTracks=[],this.captionSelection=0,this.captionFocus=0,this.speedSelection=0,this.speedFocus=0,this.lastToggleTime=0,this.defaultCaptionsTrackSet=!1,this.defaultSpeedSet=!1,this.isFullscreenMode=!1,this.lastScrollTime=Date.now(),this.refreshControls=()=>{this.mediaInfo=this.getMediaInfo(),this.progressBar.max=""+this.mediaInfo.max,this.setProgressForScreenReader();const e=_(this.mediaInfo.trimStartMs);R(this.progressBar,(this.progressBar.valueAsNumber-e)/(this.mediaInfo.max-e)*100,(this.getBufferedSec()-e)/(this.mediaInfo.max-e)*100),this.updateTimeControl()},this.dispose=()=>{void 0!==this.videoElement&&null!==this.videoElement&&(this.videoElement.removeEventListener("fullscreenchange",this.onFullScreenChange),this.videoElement.removeEventListener("play",this.onPlay),this.videoElement.removeEventListener("timeupdate",this.onTimeUpdate),this.videoElement.removeEventListener("loadedmetadata",this.refreshControls),this.videoElement.removeEventListener("canplay",this.refreshControls),null!==this.videoElement.textTracks&&void 0!==this.videoElement.textTracks&&this.videoElement.textTracks.removeEventListener("change",this.hideCaptionsInPlayer),this.videoElement.removeEventListener("play",this.togglePlayPauseIcon),this.videoElement.removeEventListener("pause",this.togglePlayPauseIcon),this.videoElement.removeEventListener("keydown",this.onVideoKeyDown),this.videoElement.removeEventListener("volumechange",this.onVideoVolumeChange)),void 0!==this.container&&null!==this.container&&this.container.remove()},this.togglePlayPauseIcon=()=>{this.setPlayPauseIcon(!this.videoElement.paused)},this.onVideoKeyDown=e=>{this.handleCaptionsKeyboardEvent(e)},this.onVideoVolumeChange=()=>{const e=this.videoElement.muted?0:this.videoElement.volume;this.setVolumeIcon(e,this.videoElement.muted||0===this.videoElement.volume),this.volumeSliderEnabled&&(this.volumeSlider.value=""+100*e,O(this.volumeSlider,this.volumeSlider.valueAsNumber))},this.onTimeUpdate=()=>{this.videoElement.currentTime<=this.mediaInfo.max?P.a.getBoolean("CorrectTrimmedVideoTimeControlDuration")&&this.mediaInfo.trimStartMs>0?this.currentTime.innerText=y(Math.max(0,this.videoElement.currentTime-_(this.mediaInfo.trimStartMs))):this.currentTime.innerText=y(this.videoElement.currentTime):(P.a.getBoolean("CorrectTrimmedVideoTimeControlDuration")&&this.mediaInfo.max>0&&this.currentTime.innerText!==this.formattedEndTime&&(this.currentTime.innerText=this.formattedEndTime),this.setPlayPauseIcon(!1));const e=_(this.mediaInfo.trimStartMs);this.progressBar.value=""+this.videoElement.currentTime,R(this.progressBar,(this.progressBar.valueAsNumber-e)/(this.mediaInfo.max-e)*100,(this.getBufferedSec()-e)/(this.mediaInfo.max-e)*100)},this.onPlay=()=>{this.setDefaultCaptionTrack()},this.hideCaptionsInPlayer=()=>{if(!this.captionsPlaybackInPlayer)for(const e of this.videoElement.textTracks)"showing"===e.mode&&(e.mode="hidden")},this.onFullScreenChange=()=>{if(!this.captionsButtonEnabled||void 0!==this.mediaControlInfo.transferCaptionsFullScreen&&!this.mediaControlInfo.transferCaptionsFullScreen)return;const e=document.fullscreenElement===this.videoElement;this.videoElement.controls=e,e?this.transferCaptionsToPlayer():(this.transferCaptionsToRenderer(),this.setPlaybackSpeedFromElement())},this.videoElement=e,this.mediaControlInfo=t,this.mediaCallbacks=i,this.zIndex=t.zIndex,this.mediaInfo=this.getMediaInfo(),void 0!==t.playPauseOnly&&t.playPauseOnly?(h.a.info(509109908,"PlaybackControls: Creating only play and pause controls"),this.createControlsPlayPause()):this.createControls(),this.focusableElements=[this.progressBar,this.playButton,this.volumeButton,this.volumeSlider,this.captionsButton,this.speedButton,this.fullscreenButton],isNaN(this.videoElement.duration)&&(h.a.warn(541882010,"PlaybackControls: Video duration not set."),void 0!==this.mediaCallbacks&&this.mediaCallbacks.logVetoCallback("IncorrectProgressAndTiming"))}get getCaptionSelection(){return this.captionSelection}get getPositioningStrategy(){return this.positioningStrategy}get getBounds(){return this.container.getBoundingClientRect()}isFullScreen(){return this.isFullscreenMode}isVisible(){return"flex"===this.container.style.display}getCaptionsScalingFactor(){return this.captionsScaleFactor}show(){this.container.style.display="flex",this.fixCaptionsOverlap(this.getBounds)}hide(){this.updatePopOuts(),this.container.style.display="none",this.resetCaptionsOverlap()}onKeyDown(e){if(this.nestedTabbingEnabled&&void 0!==e){if("ArrowRight"===e.key&&("none"===this.progressBar.style.display?this.playButton.focus():this.progressBar.focus()),"ArrowLeft"===e.key)for(let e=this.focusableElements.length-1;e>=0;e--){const t=this.focusableElements[e];if((t!==this.captionsButton||this.captionsButtonEnabled)&&(t!==this.volumeButton||"none"!==this.volumeContainer.style.display)&&void 0!==t&&"none"!==t.style.display&&this.container.contains(t)){t.focus();break}}e.stopPropagation()}}setParent(e){try{null===e.shadowRoot?this.root=e.attachShadow({mode:"open"}):this.root=e.shadowRoot,this.root.appendChild(this.container),this.addCssRef(this.root),this.setPlayPauseIcon(!this.videoElement.paused),void 0!==this.captionsRenderer&&(this.captionsRenderer.updateContainer(this.zIndex-1),this.defaultCaptionsTrackSet=!1,this.setDefaultCaptionTrack()),void 0!==this.currentTimeContainer&&(this.controlsOrganizer=new A(this.leftControls,this.rightControls,this.progressBar,this.currentTimeContainer,this.volumeContainer,this.volumeSliderContainer,this.speedButton,this.captionsButton,this.fullscreenButton),this.resizeObserver=new ResizeObserver(e=>{var t,i;for(const r of e){const e=r.contentRect;null===(t=this.controlsOrganizer)||void 0===t||t.onWidthChanged(e.width),null===(i=this.controlsOrganizer)||void 0===i||i.onHeightChanged(e.height)}}),P.a.getBoolean("setControlsContainerPointerEventsStyle")||(this.container.style.pointerEvents="auto"),this.container.style.justifyContent="flex-end",this.resizeObserver.observe(e))}catch(e){h.a.error(526485603,"Exception in setParent: "+e.message)}}enableCaptionTrack(e,t){void 0!==this.captionsRenderer&&(e<0||void 0===this.captionsMenu||e>=this.captionsMenu.children.length-1||(this.captionSelection=e,this.captionsMenu.children[e].setAttribute(n.a,"true"),0===e?(this.hideCaptionsUnderlineIcon(),this.captionsPlaybackInPlayer?t&&this.disableCaptionsInPlayer():this.captionsRenderer.stopCaptionTrack()):("hidden"!==this.videoElement.textTracks[e-1].mode&&(this.videoElement.textTracks[e-1].mode="hidden"),this.showCaptionsUnderlineIcon(),this.captionsPlaybackInPlayer?(this.videoElement.textTracks[e-1].mode="showing",this.captionsPlaybackInPlayer=!1):(this.captionsRenderer.renderCaptionTrack(this.videoElement,this,e-1),2!==this.positioningStrategy&&3!==this.positioningStrategy||!this.isVisible()||this.fixCaptionsOverlap(this.getBounds)))))}disableCaptionsInPlayer(){this.captionsPlaybackInPlayer=!1;for(let e=0;e<this.videoElement.textTracks.length;e+=1)if("showing"===this.videoElement.textTracks[e].mode)return this.videoElement.textTracks[e].mode="hidden",e}getZIndex(){return this.zIndex}focusPlayButton(){this.isVisible()||this.show(),this.playButton.focus()}toggleCaptionsMenu(e){this.isVisible()||this.show(),this.captionsButtonEnabled?this.toggleCaptionsMenuInternal(e):this.focusPlayButton()}onProgressSliderInput(){if(this.videoElement.currentTime!==this.progressBar.valueAsNumber){void 0!==this.mediaCallbacks?this.mediaCallbacks.seekMediaCallback(this.progressBar.valueAsNumber):this.videoElement.currentTime=this.progressBar.valueAsNumber,this.progressBar.value=""+this.videoElement.currentTime,this.setProgressForScreenReader();const e=_(this.mediaInfo.trimStartMs);R(this.progressBar,(this.progressBar.valueAsNumber-e)/(this.mediaInfo.max-e)*100,(this.getBufferedSec()-e)/(this.mediaInfo.max-e)*100)}}onVolumeSliderInput(){this.videoElement.volume=this.volumeSlider.valueAsNumber/100,this.videoElement.volume>0&&this.videoElement.muted&&(this.videoElement.muted=!1),O(this.volumeSlider,this.volumeSlider.valueAsNumber),void 0!==this.mediaCallbacks&&this.mediaCallbacks.volumeChangedCallback()}onVolumeClick(){this.videoElement.muted=!this.videoElement.muted;const e=this.videoElement.muted,t=e?0:this.videoElement.volume;this.setVolumeIcon(t,e),this.volumeSliderEnabled&&(this.volumeSlider.value=""+100*t,O(this.volumeSlider,this.volumeSlider.valueAsNumber)),void 0!==this.mediaCallbacks&&this.mediaCallbacks.muteUnmuteCallback()}onPlayPauseClick(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.updatePopOuts(),this.videoElement.paused?void 0!==this.mediaCallbacks?this.mediaCallbacks.playMediaCallback():yield this.videoElement.play():void 0!==this.mediaCallbacks?this.mediaCallbacks.pauseMediaCallback():this.videoElement.pause()}))}onPlaybackSpeedClick(){this.setDefaultPlaybackSpeed(),w(this.speedMenuDiv)?(this.hideCaptionsMenu("Programmatic"),this.ensureMenuPosition(1),this.speedButton.setAttribute(n.b,"true")):this.speedButton.setAttribute(n.b,"false"),I(this.speedMenuDiv),I(this.speedCheckmark),w(this.speedMenuDiv)?2!==this.positioningStrategy&&3!==this.positioningStrategy&&this.resetCaptionsOverlap():this.fixCaptionsOverlap(this.speedMenuDiv.getBoundingClientRect())}hidePlaybackSpeedMenu(e){this.speedButtonEnabled&&(w(this.speedMenuDiv)||(M(this.speedMenuDiv),M(this.speedCheckmark),this.speedButton.setAttribute(n.b,"false"),"Programmatic"!==e&&this.speedButton.focus(),2!==this.positioningStrategy&&3!==this.positioningStrategy&&this.resetCaptionsOverlap()))}setDefaultPlaybackSpeed(){this.defaultSpeedSet||(this.defaultSpeedSet=!0,this.speedSelection=n.z.indexOf(this.mediaInfo.playbackSpeed),-1===this.speedSelection?h.a.warn(509670626,"PlaybackControls.setDefaultPlaybackSpeed: default video speed not in list of playback speed options"):this.setPlaybackSpeed(this.speedSelection))}setPlaybackSpeedFromElement(){const e=n.z.indexOf(this.videoElement.playbackRate);e!==this.speedSelection&&this.setPlaybackSpeed(e)}setPlaybackSpeed(e){this.speedMenu.children[this.speedSelection].setAttribute(n.a,"false"),this.speedSelection=e,this.mediaInfo.playbackSpeed=n.z[e],this.videoElement.playbackRate=this.mediaInfo.playbackSpeed,this.speedButton.innerText=this.mediaInfo.playbackSpeed.toString()+n.A,this.speedMenu.children[this.speedSelection].setAttribute(n.a,"true"),this.speedCheckmark.style.top=this.speedMenu.children[e].offsetTop+14+"px",M(this.speedMenuDiv),M(this.speedCheckmark),this.speedButton.setAttribute(n.b,"false")}onFullscreenClick(){this.isFullscreenMode?this.isFullscreenMode=!1:(this.isFullscreenMode=!0,this.videoElement.requestFullscreen().catch(e=>{h.a.warn(509346562,"PlayerControls.onFullscreenClick: unable to fullscreen video - "+e.message),this.isFullscreenMode=!1}))}getMediaInfo(){const e=isNaN(this.mediaControlInfo.trimInfo.trimEndMs)?0:this.mediaControlInfo.trimInfo.trimEndMs,t=isNaN(this.videoElement.duration)?0:1e3*this.videoElement.duration-e;return{trimStartMs:isNaN(this.mediaControlInfo.trimInfo.trimStartMs)?0:this.mediaControlInfo.trimInfo.trimStartMs,trimEndMs:e,max:_(t),autoplay:this.videoElement.autoplay,playbackSpeed:this.videoElement.playbackRate,screenReaderInfo:this.mediaControlInfo.screenReaderInfo}}addCssRef(e){if(null==e||e.styleSheets.length>0)return;const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",this.mediaControlInfo.cssUrl),t.addEventListener("error",()=>{h.a.error(508864334,"PlaybackControls.css failed to load")}),e.appendChild(t)}getBufferedSec(){let e=_(this.mediaInfo.trimStartMs);if(this.videoElement.buffered.length>0)try{e=this.videoElement.buffered.end(0)}catch(e){}return e}createControls(){this.setControlFlags(),this.createContainer(!0),this.createTopControls(this.container),this.createBottomControls(this.container),this.speedButtonEnabled&&this.createPlaybackSpeedMenu(this.container),this.videoElement.addEventListener("fullscreenchange",this.onFullScreenChange),this.videoElement.addEventListener("play",this.onPlay),this.videoElement.addEventListener("timeupdate",this.onTimeUpdate),this.videoElement.addEventListener("loadedmetadata",this.refreshControls),this.videoElement.addEventListener("canplay",this.refreshControls),null!==this.videoElement.textTracks&&void 0!==this.videoElement.textTracks&&(this.hideCaptionsInPlayer(),this.videoElement.textTracks.addEventListener("change",this.hideCaptionsInPlayer)),this.nestedTabbingEnabled?this.initTabIndex():this.setTabOrder(),this.setVolumeIcon(this.videoElement.volume,this.videoElement.muted),this.fullscreenButtonEnabled&&this.setFullscreenIcon(this.isFullscreenMode),this.textTracks=Object(p.b)(this.videoElement.textTracks),this.setDefaultCaptionTrack()}setControlFlags(){if(this.captionsButtonVisible=void 0!==this.mediaControlInfo.captionsEnabled&&this.mediaControlInfo.captionsEnabled,this.captionsButtonVisible&&this.videoElement.textTracks.length>0&&(this.captionsButtonEnabled=!0),void 0!==this.mediaControlInfo.captionsPositioningStrategy&&(this.positioningStrategy=this.mediaControlInfo.captionsPositioningStrategy),h.a.info(509163655,JSON.stringify({Description:"PlaybackControls - Captions settings",captionsButtonVisible:this.captionsButtonVisible,captionsButtonEnabled:this.captionsButtonEnabled,textTracks:this.videoElement.textTracks.length,children:this.videoElement.children.length})),this.captionsRenderer=this.mediaControlInfo.captionsRenderer,this.volumeSliderEnabled=void 0===this.mediaControlInfo.volumeSliderEnabled||this.mediaControlInfo.volumeSliderEnabled,this.speedButtonEnabled=void 0!==this.mediaControlInfo.speedEnabled&&this.mediaControlInfo.speedEnabled,this.fullscreenButtonEnabled=void 0!==this.mediaControlInfo.fullscreenEnabled&&this.mediaControlInfo.fullscreenEnabled,this.nestedTabbingEnabled=void 0!==this.mediaControlInfo.nestedTabbingEnabled&&this.mediaControlInfo.nestedTabbingEnabled,!this.volumeSliderEnabled){const e=P.a.getNumber("captionsScaleFactor");this.captionsScaleFactor=void 0===e||0===e?.6:e}}setNextArrowFocus(e,t){let i=e;switch(e){case this.progressBar:i=this.playButton;break;case this.playButton:i=this.volumeButton;break;case this.volumeButton:this.volumeSliderEnabled?(S(this.volumeSliderContainer),i=this.volumeSlider):this.captionsButtonEnabled?i=this.captionsButton:this.speedButtonEnabled?i=this.speedButton:this.fullscreenButtonEnabled&&(i=this.fullscreenButton);break;case this.volumeSlider:this.captionsButtonEnabled?i=this.captionsButton:this.speedButtonEnabled?i=this.speedButton:this.fullscreenButtonEnabled&&(i=this.fullscreenButton);break;case this.captionsButton:this.speedButtonEnabled?i=this.speedButton:this.fullscreenButtonEnabled&&(i=this.fullscreenButton);break;case this.speedButton:this.fullscreenButtonEnabled&&(i=this.fullscreenButton);break;default:if(!P.a.getBoolean("showHideControlsOnResize"))return}if(P.a.getBoolean("showHideControlsOnResize")){if(i===e)return void t.stopImmediatePropagation();if("none"===i.style.display||!this.container.contains(i))return void this.setNextArrowFocus(i,t)}t.stopImmediatePropagation(),i.focus()}setPreviousArrowFocus(e,t){let i=e;switch(e){case this.playButton:i=this.progressBar;break;case this.volumeButton:i=this.playButton;break;case this.volumeSlider:i=this.volumeButton;break;case this.captionsButton:this.volumeSliderEnabled?(S(this.volumeSliderContainer),i=this.volumeSlider):i=this.volumeButton;break;case this.speedButton:this.captionsButtonEnabled?i=this.captionsButton:this.volumeSliderEnabled?(S(this.volumeSliderContainer),i=this.volumeSlider):i=this.volumeButton;break;case this.fullscreenButton:this.speedButtonEnabled?i=this.speedButton:this.captionsButtonEnabled?i=this.captionsButton:this.volumeSliderEnabled?(S(this.volumeSliderContainer),i=this.volumeSlider):i=this.volumeButton;break;default:if(!P.a.getBoolean("showHideControlsOnResize"))return}if(P.a.getBoolean("showHideControlsOnResize")){if(i===e)return void t.stopImmediatePropagation();if("none"===i.style.display||!this.container.contains(i))return void this.setPreviousArrowFocus(i,t)}t.stopImmediatePropagation(),i.focus()}createControlsPlayPause(){this.createContainer(!1),this.setContainerStyle();const e=F("div","controls-left");Object(g.a)(e,{left:this.container.style.left}),this.createPlayButton(e),this.container.appendChild(e)}setContainerStyle(){const e=this.mediaControlInfo;P.a.getBoolean("resizeMediaOnSlideScaling")?Object(g.a)(this.container,{bottom:"0px",width:"100%",height:e.size.y+"px",zIndex:""+e.zIndex,direction:"ltr",display:"none"}):Object(g.a)(this.container,{left:e.position.x+"px",top:e.position.y+"px",width:e.size.x+"px",minHeight:e.size.y+"px",zIndex:""+e.zIndex,direction:"ltr",display:"none"})}createContainer(e){const t=F("div",e?"control-container":"control-container-no-background");t.id="video-controls-container",this.container=t,this.setContainerStyle(),void 0!==this.mediaControlInfo.cssPositionOverride&&(t.style.position=this.mediaControlInfo.cssPositionOverride),t.addEventListener("mousedown",()=>{t.classList.add("no-outline")}),t.addEventListener("click",e=>{e.stopPropagation(),1===e.button&&this.updatePopOuts()}),t.addEventListener("keydown",e=>{this.updatePopOuts(e),t.classList.remove("no-outline")})}createTopControls(e){const t=F("div","controls-top");this.createProgressBar(t),e.appendChild(t)}createBottomControls(e){const t=F("div","controls-bottom");this.createLeftControls(t),this.createRightControls(t),e.appendChild(t)}createLeftControls(e){this.leftControls=F("div","controls-left"),this.createPlayButton(this.leftControls),this.createVolumeControls(this.leftControls),this.createTimeControl(this.leftControls),e.appendChild(this.leftControls)}createRightControls(e){this.rightControls=F("div","controls-right"),this.createCaptionsControls(this.rightControls),this.speedButtonEnabled&&this.createPlaybackSpeedControl(this.rightControls),this.fullscreenButtonEnabled&&this.createFullscreenControl(this.rightControls),e.appendChild(this.rightControls)}initTabIndex(){if(this.progressBar.tabIndex=-1,this.playButton.tabIndex=-1,this.volumeButton.tabIndex=-1,this.volumeSliderEnabled&&(this.volumeSlider.tabIndex=-1),this.captionsButtonVisible&&(this.captionsButton.tabIndex=-1,this.captionsButtonEnabled))for(const e of this.captionsMenu.children)e.tabIndex=-1;if(this.speedButtonEnabled){this.speedButton.tabIndex=-1;for(const e of this.speedMenu.children)e.tabIndex=-1}this.fullscreenButtonEnabled&&(this.fullscreenButton.tabIndex=-1)}setTabOrder(){this.progressBar.tabIndex=1,this.playButton.tabIndex=2,this.volumeButton.tabIndex=3;let e=this.volumeButton.tabIndex+1;if(this.volumeSliderEnabled&&(this.volumeSlider.tabIndex=e,e+=1),this.captionsButtonVisible&&(this.captionsButton.tabIndex=e,e+=1),this.captionsButtonEnabled)for(const t of this.captionsMenu.children)t instanceof SVGSVGElement||(t.tabIndex=e,e+=1);if(this.speedButtonEnabled){this.speedButton.tabIndex=e,e+=1;for(const t of this.speedMenu.children)t.tabIndex=e,e+=1}this.fullscreenButtonEnabled&&(this.fullscreenButton.tabIndex=e,e+=1)}updatePopOuts(e){(this.nestedTabbingEnabled||void 0===e||"Tab"!==e.key&&"Shift"!==e.key)&&(void 0!==e&&e.getModifierState(e.key)||this.handleCaptionsKeyboardEvent(e)||(this.captionsButtonEnabled&&this.isCaptionsMenuVisible()&&this.hideCaptionsMenu(void 0===e?"Programmatic":"Keyboard"),this.handleSpeedKeyboardEvent(e)||this.speedButtonEnabled&&void 0!==this.speedMenuDiv&&!w(this.speedMenuDiv)&&this.hidePlaybackSpeedMenu(void 0===e?"Programmatic":"Keyboard")))}handleCaptionsKeyboardEvent(e){if(!this.captionsButtonEnabled||void 0===e)return!1;if(("j"===e.key||""===e.key)&&e.altKey)return this.toggleCaptionsMenuInternal("Shortcut"),e.stopPropagation(),!0;if(this.isCaptionsMenuVisible())switch(e.key){case"ArrowUp":case"PageUp":e.preventDefault(),this.captionFocus>0&&(this.captionFocus-=1,this.captionsMenu.children[this.captionFocus].focus());break;case"ArrowDown":case"PageDown":e.preventDefault(),this.captionFocus>=0&&this.captionFocus<this.captionsMenu.children.length-2&&(this.captionFocus+=1,this.captionsMenu.children[this.captionFocus].focus());break;case"ArrowLeft":case"ArrowRight":break;case"Escape":this.hideCaptionsMenu("Keyboard");break;default:return!1}else switch(e.key){case"c":"none"===this.container.style.display&&this.show(),this.toggleCaptionsMenuInternal("Shortcut"),this.showOptionFocus(this.captionsMenu.children[this.captionSelection],0);break;default:return!1}return e.stopPropagation(),!0}handleSpeedKeyboardEvent(e){if(!this.speedButtonEnabled||void 0===e)return!1;if(!w(this.speedMenuDiv)){switch(e.key){case"ArrowUp":case"PageUp":e.preventDefault(),this.speedFocus>0&&(this.speedFocus-=1,this.speedMenu.children[this.speedFocus].focus());break;case"ArrowDown":case"PageDown":e.preventDefault(),this.speedFocus>=0&&this.speedFocus<this.speedMenu.children.length-1&&(this.speedFocus+=1,this.speedMenu.children[this.speedFocus].focus());break;case"ArrowLeft":case"ArrowRight":break;case"Escape":this.hidePlaybackSpeedMenu("Keyboard");break;default:return!1}return e.stopPropagation(),!0}return!1}getProgressStep(){const e=this.mediaInfo.max-_(this.mediaInfo.trimStartMs);return Math.max(e/100,.01)}createProgressBar(e){const t=document.createElement("input");this.progressBar=t,t.type="range",t.classList.add("progress-slider"),t.min=""+_(this.mediaInfo.trimStartMs),t.max=""+this.mediaInfo.max,t.value=t.min,t.step=""+this.getProgressStep(),t.addEventListener("input",()=>this.onProgressSliderInput()),void 0!==this.mediaInfo.screenReaderInfo&&t.setAttribute(n.d,this.mediaInfo.screenReaderInfo.progressBarStr),t.addEventListener("focus",()=>this.setProgressForScreenReader()),t.addEventListener("click",()=>this.updatePopOuts()),!0===this.mediaControlInfo.stopPropagateMouseDownOnSlider&&t.addEventListener("mousedown",e=>{e.stopPropagation()}),t.addEventListener("keydown",e=>{this.updatePopOuts(e),this.nestedTabbingEnabled?"ArrowRight"===e.key?(e.preventDefault(),this.setNextArrowFocus(t,e)):"ArrowLeft"===e.key?(e.preventDefault(),e.stopImmediatePropagation()):"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation():"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowUp"!==e.key&&"ArrowRight"!==e.key&&"PageDown"!==e.key&&"PageUp"!==e.key||e.stopPropagation()}),void 0!==this.mediaControlInfo.tooltipMap&&t.addEventListener("mouseenter",()=>{t.title=this.getTooltip("Seek")});const i=_(this.mediaInfo.trimStartMs);R(this.progressBar,(this.progressBar.valueAsNumber-i)/(this.mediaInfo.max-i)*100,(this.getBufferedSec()-i)/(this.mediaInfo.max-i)*100),e.appendChild(t)}createPlayButton(e){const t=F("button","playpause");this.playButton=t,t.type="button";const i=d("play-pause-gfxicon");t.appendChild(i),void 0!==this.mediaInfo.screenReaderInfo&&t.setAttribute(n.d,this.videoElement.paused?this.mediaInfo.screenReaderInfo.playButtonStr:this.mediaInfo.screenReaderInfo.pauseButtonStr),this.videoElement.addEventListener("play",this.togglePlayPauseIcon),this.videoElement.addEventListener("pause",this.togglePlayPauseIcon),this.videoElement.addEventListener("keydown",this.onVideoKeyDown),t.addEventListener("click",()=>{this.onPlayPauseClick().catch(e=>h.a.warn(508413404,"PlayerControls.onPlayPauseClick: unable to play/pause video - "+e.message))}),t.addEventListener("keydown",e=>{if(this.updatePopOuts(e),void 0!==e.key)switch(e.key){case"Enter":case" ":e.preventDefault(),e.stopPropagation(),this.onPlayPauseClick().catch(e=>h.a.warn(526952129,"PlayerControls.onPlayPauseClick: unable to play/pause video - "+e.message));break;case"ArrowRight":this.nestedTabbingEnabled&&this.setNextArrowFocus(t,e);break;case"ArrowLeft":this.nestedTabbingEnabled&&this.setPreviousArrowFocus(t,e);break;case"ArrowUp":case"ArrowDown":this.nestedTabbingEnabled&&e.stopImmediatePropagation()}}),e.appendChild(t)}setPlayPauseIcon(e){const t=this.playButton.querySelector("#play-gfxicon"),i=this.playButton.querySelector("#pause-gfxicon");null!==t&&null!==i?e?(C(i),M(t),void 0!==this.mediaInfo.screenReaderInfo&&this.playButton.setAttribute(n.d,this.mediaInfo.screenReaderInfo.pauseButtonStr),void 0!==this.mediaControlInfo.tooltipMap&&(this.playButton.title=this.getTooltip("Pause"))):(C(t),M(i),void 0!==this.mediaInfo.screenReaderInfo&&this.playButton.setAttribute(n.d,this.mediaInfo.screenReaderInfo.playButtonStr),void 0!==this.mediaControlInfo.tooltipMap&&(this.playButton.title=this.getTooltip("Play"))):(h.a.warn(541882011,"PlayerControls.setPlayPauseIcon: querySelector returned null."),void 0!==this.mediaCallbacks&&this.mediaCallbacks.logVetoCallback("IncorrectPlayPauseIcon"))}createVolumeControls(e){this.volumeContainer=F("div","volume-container"),this.createVolumeButton(this.volumeContainer),this.volumeSliderEnabled&&(this.createVolumeSlider(this.volumeContainer),this.volumeContainer.addEventListener("focusin",()=>{S(this.volumeSliderContainer)}),this.volumeContainer.addEventListener("mouseleave",()=>{T(this.volumeSliderContainer)})),this.volumeContainer.addEventListener("click",()=>this.updatePopOuts()),this.volumeContainer.addEventListener("keydown",e=>this.updatePopOuts(e)),e.appendChild(this.volumeContainer)}createVolumeButton(e){const t=F("button","volume");this.volumeButton=t,t.type="button";const i=d("volume-gfxicon");t.appendChild(i),this.videoElement.addEventListener("volumechange",this.onVideoVolumeChange),void 0!==this.mediaInfo.screenReaderInfo&&(t.setAttribute(n.d,this.videoElement.muted?this.mediaInfo.screenReaderInfo.unmuteButtonStr:this.mediaInfo.screenReaderInfo.muteButtonStr),t.addEventListener("keydown",e=>{if(this.updatePopOuts(e),void 0!==e.key)switch(e.key){case"Enter":case" ":e.preventDefault(),e.stopPropagation(),this.onVolumeClick()}})),t.addEventListener("click",()=>{this.updatePopOuts(),this.onVolumeClick()}),t.addEventListener("keydown",e=>{this.updatePopOuts(e),this.nestedTabbingEnabled&&("ArrowLeft"===e.key?this.setPreviousArrowFocus(t,e):"ArrowRight"===e.key?this.setNextArrowFocus(t,e):"ArrowUp"!==e.key&&"ArrowDown"!==e.key||e.stopImmediatePropagation())}),this.volumeSliderEnabled&&t.addEventListener("mouseenter",()=>{S(this.volumeSliderContainer)}),e.appendChild(t)}createVolumeSlider(e){this.volumeSlider=F("input","volume-slider"),this.volumeSlider.type="range",this.volumeSlider.min="0",this.volumeSlider.max="100",this.volumeSlider.value=this.videoElement.muted?"0":""+100*this.videoElement.volume,void 0!==this.mediaInfo.screenReaderInfo&&this.volumeSlider.setAttribute(n.d,this.mediaInfo.screenReaderInfo.volumeSliderStr),O(this.volumeSlider,this.volumeSlider.valueAsNumber),this.volumeSlider.addEventListener("input",()=>this.onVolumeSliderInput()),!0===this.mediaControlInfo.stopPropagateMouseDownOnSlider&&this.volumeSlider.addEventListener("mousedown",e=>{e.stopPropagation()}),this.volumeSlider.addEventListener("click",()=>this.updatePopOuts()),this.volumeSlider.addEventListener("keydown",e=>{this.updatePopOuts(e),this.nestedTabbingEnabled?"ArrowLeft"===e.key?(e.preventDefault(),this.setPreviousArrowFocus(this.volumeSlider,e)):"ArrowRight"===e.key?(e.preventDefault(),this.setNextArrowFocus(this.volumeSlider,e)):"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation():"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowUp"!==e.key&&"ArrowRight"!==e.key&&"PageDown"!==e.key&&"PageUp"!==e.key||e.stopPropagation()}),this.volumeSlider.addEventListener("focusout",e=>{T(this.volumeSlider),e.stopPropagation()}),this.volumeSlider.style.display="block",this.volumeSlider.style.margin="auto",this.volumeSlider.style.width="75%",this.volumeSliderContainer=F("div","volume-slider-container"),this.volumeSliderContainer.appendChild(this.volumeSlider),e.style.position="relative",e.appendChild(this.volumeSliderContainer),O(this.volumeSlider,this.volumeSlider.valueAsNumber)}setVolumeIcon(e,t){const i=this.volumeButton.querySelector("#volume-low-gfxicon"),r=this.volumeButton.querySelector("#volume-medium-gfxicon"),a=this.volumeButton.querySelector("#volume-high-gfxicon"),s=this.volumeButton.querySelector("#volume-muted-gfxicon");if(null===i||null===r||null===a||null===s)return h.a.warn(541882012,"PlayerControls.setVolumeIcon: querySelector returned null, unable to set volume button icon"),void(void 0!==this.mediaCallbacks&&this.mediaCallbacks.logVetoCallback("IncorrectVolumeIndicator"));M(s),M(i),M(r),M(a),void 0!==this.mediaControlInfo.tooltipMap&&(this.volumeButton.title=t?this.getTooltip("Unmute"):this.getTooltip("Mute")),C(t?s:e<.33?i:e<.67?r:a),void 0!==this.mediaInfo.screenReaderInfo&&this.volumeButton.setAttribute(n.d,t?this.mediaInfo.screenReaderInfo.unmuteButtonStr:this.mediaInfo.screenReaderInfo.muteButtonStr)}getTextTracks(){return this.textTracks}findMatchingCaptionTrack(e,t){if(null===e&&null===t)return-1;if(0===(null==e?void 0:e.length)&&0===(null==t?void 0:t.length))return 0;const i=this.getTextTracks();let r=-1,n=-1;for(let a=0;a<i.length;a+=1){let s=i[a].language.toLowerCase();"unknown"===s&&(s="");const o=0!==(null==e?void 0:e.length)&&s===(null==e?void 0:e.toLowerCase()),l=0!==(null==t?void 0:t.length)&&i[a].label.toLowerCase()===(null==t?void 0:t.toLowerCase());if(n<0&&l&&(n=a+1),o){if(l)return a+1;r=a+1}r<0&&(f(i[a].language,e)||f(e,i[a].language))&&(r=a+1)}return r>0?r:n>0?n:-1}getLastSelectedCaptionTrack(){return[Object(m.c)(n.i),Object(m.c)(n.h)]}setLastSelectedCaptionTrack(e){const t=this.getTextTracks().length;if(e<0||e>t)return;let i="",r="";if(e>0){const t=this.getTextTracks()[e-1];i="unknown"===t.language.toLowerCase()?"":t.language,r=t.label}const a=new Date((new Date).setFullYear((new Date).getFullYear()+1));Object(m.d)(n.i,i,a),Object(m.d)(n.h,r,a)}setDefaultCaptionTrack(){if(!this.captionsButtonEnabled)return;if(this.getTextTracks().length<=0)return;if(this.captionSelection>0)return this.enableCaptionTrack(this.captionSelection,!1),void(this.defaultCaptionsTrackSet=!0);if(this.defaultCaptionsTrackSet)return;this.defaultCaptionsTrackSet=!0;let e=null,t=null;[e,t]=this.getLastSelectedCaptionTrack();const i=this.findMatchingCaptionTrack(e,t);if(i>=0)this.enableCaptionTrack(i,!1);else{if(void 0!==this.captionsRenderer&&""!==this.captionsRenderer.getDefaultLang)for(let e=0;e<this.getTextTracks().length;e+=1)if(this.getTextTracks()[e].language.toLowerCase()===this.captionsRenderer.getDefaultLang)return void this.enableCaptionTrack(e+1,!1);null===e&&null===t?this.captionsMenu.children[0].setAttribute(n.a,"true"):this.enableCaptionTrack(1,!1)}}disableCaptionTrack(e){var t;e<0||(this.captionsMenu.children[e].setAttribute(n.a,"false"),0!==e&&(void 0!==this.captionsRenderer?null===(t=this.captionsRenderer)||void 0===t||t.stopCaptionTrack():(this.videoElement.textTracks[e-1].mode="hidden",this.captionsPlaybackInPlayer=!1)))}updateCaptionTrack(e){h.a.info(512550666,`PlaybackControls - Captions: Updating selected caption track new selection: ${e}, previous selection: ${this.captionSelection}`),this.setLastSelectedCaptionTrack(e),e!==this.captionSelection&&(this.disableCaptionTrack(this.captionSelection),this.enableCaptionTrack(e,!1))}showCaptionsUnderlineIcon(){C(this.captionsButton.children[1]),this.captionsButton.children[1].style.position="",M(this.captionsButton.children[0]),this.captionsButton.children[0].style.position="absolute"}hideCaptionsUnderlineIcon(){C(this.captionsButton.children[0]),this.captionsButton.children[0].style.position="",M(this.captionsButton.children[1]),this.captionsButton.children[1].style.position="absolute"}isCaptionsMenuVisible(){return!w(this.captionsMenu)}showCaptionsMenu(e){try{if(!this.captionsButtonEnabled)return;this.setDefaultCaptionTrack(),h.a.info(512521174,JSON.stringify({Description:"PlaybackControls - Showing captions menu",Source:e})),this.hidePlaybackSpeedMenu("Programmatic");const t=14*(1===this.captionsScaleFactor?1:this.captionsScaleFactor/2);if(this.ensureMenuPosition(0),C(this.captionsMenu),this.captionsCheckmark.style.top=this.captionsMenu.children[this.captionSelection].offsetTop+t+"px",this.captionsCheckmark.style.display="block",this.captionsButton.setAttribute(n.b,"true"),!this.volumeSliderEnabled&&0===this.captionsMenu.offsetWidth){const e="75px",t="50px";h.a.info(508867395,JSON.stringify({Description:"PlaybackControls - Captions menu has no dimensions, setting minimums",PreviousWidth:this.captionsMenu.style.width,PreviousHeight:this.captionsMenu.style.height,NewWidth:e,NewHeight:t})),this.captionsMenu.style.width=e,this.captionsMenu.style.height=t}this.captionsMenuShown||(this.captionsMenuShown=!0,this.logCaptionsMenuInfo()),"Keyboard"===e||"Shortcut"===e?this.showOptionFocus(this.captionsMenu.children[this.captionSelection],0):"Click"===e&&this.captionsMenu.children[this.captionSelection].focus(),this.fixCaptionsOverlap(this.captionsMenu.getBoundingClientRect())}catch(e){throw h.a.error(509130720,"PlaybackControls.showCaptionsMenu - Exception caught: "+e.message),e}}logCaptionsMenuInfo(){const e=this.captionsMenu.getBoundingClientRect(),t=this.container.getBoundingClientRect();h.a.info(508942554,JSON.stringify({MenuClassList:this.captionsMenu.classList,MenuDisplay:this.captionsMenu.style.display,MenuHidden:this.captionsMenu.hidden,MenuOpacity:this.captionsMenu.style.opacity,MenuVisibility:this.captionsMenu.style.visibility,MenuTop:e.top,MenuBottom:e.bottom,MenuLeft:e.left,MenuRight:e.right,MenuWidth:this.captionsMenu.style.width,MenuHeight:this.captionsMenu.style.height,MenuOffsetHeight:this.captionsMenu.offsetHeight,MenuOffsetTop:this.captionsMenu.offsetTop,MenuOffsetLeft:this.captionsMenu.offsetLeft,MenuOffsetWidth:this.captionsMenu.offsetWidth,ContainerTop:t.top,ContainerBottom:t.bottom,ContainerLeft:t.left,ContainerRight:t.right}));for(const e of this.captionsMenu.children)this.logOptionInfo("Showing menu - option info",e)}fixCaptionsOverlap(e){0!==this.captionSelection&&void 0!==this.captionsRenderer&&0!==this.positioningStrategy&&this.captionsRenderer.boxIntersects(e)&&(1===this.positioningStrategy&&(this.captionsRenderer.setHorizontalPosition(this.getMenuBoxRect()),this.captionsRenderer.setVerticalPosition(!1)),2===this.positioningStrategy&&this.transferCaptionsToPlayer(),3===this.positioningStrategy&&this.captionsRenderer.reduceOpacity())}getMenuBoxRect(){return void 0!==this.captionsMenu&&this.isCaptionsMenuVisible()?this.captionsMenu.getBoundingClientRect():void 0===this.speedMenuDiv||w(this.speedMenuDiv)?void 0:this.speedMenuDiv.getBoundingClientRect()}resetCaptionsOverlap(){void 0!==this.captionsRenderer&&0!==this.positioningStrategy&&(2===this.positioningStrategy&&this.transferCaptionsToRenderer(),0!==this.captionSelection&&(1===this.positioningStrategy&&(this.captionsRenderer.resetHorizontalPosition(),this.captionsRenderer.setVerticalPosition(!0)),3===this.positioningStrategy&&this.captionsRenderer.resetOpacity()))}hideCaptionsMenu(e){this.captionsButtonEnabled&&(h.a.info(512521173,JSON.stringify({Description:"PlaybackControls - Hiding captions menu",Source:e})),this.captionsCheckmark.style.display="none",M(this.captionsMenu),this.captionsButton.setAttribute(n.b,"false"),"Programmatic"!==e&&this.captionsButton.focus(),2!==this.positioningStrategy&&3!==this.positioningStrategy&&this.resetCaptionsOverlap())}toggleCaptionsMenuInternal(e){if(!this.captionsButtonEnabled)return void h.a.info(509162691,JSON.stringify({Description:"PlaybackControls - Captions button is not enabled, skipping menu toggle",Source:e}));this.isVisible()||this.show();const t=Date.now()-this.lastToggleTime;t<=this.captionsMinUIDelay?h.a.info(509162690,JSON.stringify({Description:"PlaybackControls - Suppressing duplicate captions menu toggle",Source:e,LastClickDelay:t,MinDelay:this.captionsMinUIDelay})):(h.a.info(512521172,JSON.stringify({Description:"PlaybackControls - Toggling captions menu",Source:e})),this.lastToggleTime=Date.now(),this.isCaptionsMenuVisible()?this.hideCaptionsMenu(e):this.showCaptionsMenu(e))}showOptionFocus(e,t){switch(e.style.backgroundColor="#000000",e.style.background="solid",e.focus(),e.scrollIntoView({behavior:"smooth",block:"nearest"}),t){case 0:this.captionFocus=parseInt(e.id,10);break;case 1:this.speedFocus=parseInt(e.id,10)}}hideOptionFocus(e){e.style.background="none"}createCaptionsControls(e){this.captionsButtonVisible&&void 0===this.captionsButton&&(this.captionsButtonEnabled&&(h.a.info(512550661,"PlaybackControls - Captions: Creating captions menu"),this.createCaptionsMenu()),this.createCaptionsButton(),e.appendChild(this.captionsButton),this.captionsButtonEnabled&&this.hideCaptionsMenu("Programmatic"))}createCaptionsMenu(){this.captionsMenu=F("div","closed-captions-menu"),this.captionsMenu.setAttribute(n.d,this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.captionsMenuStr:"Closed captions menu"),this.captionsMenu.setAttribute("role","menu"),Object(g.a)(this.captionsMenu,{display:"block",opacity:".8",position:"absolute",right:"0px",borderRadius:"2px"}),this.container.appendChild(this.captionsMenu);const e=this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.captionsMenuOffOptionStr:"Off";if(this.captionsMenu.appendChild(this.createOptionElement(0,"",e)),this.captionsButtonEnabled)for(let e=0;e<this.videoElement.textTracks.length;e+=1){const t=this.videoElement.textTracks[e];h.a.info(512550665,`PlaybackControls - Captions: Adding track index: ${e}, language: ${t.language}`);const i=u(t.language);let r;i===t.language&&h.a.info(512550664,"PlaybackControls - Captions: Unknown language code: "+t.language),r="Unknown"!==i?""!==t.label&&t.label.toLowerCase()!==i.toLowerCase()?`${t.label} - ${i}`:i:""!==t.label?t.label:"Track "+(e+1),this.captionsMenu.addEventListener("focusout",e=>{e.stopImmediatePropagation()}),this.captionsMenu.addEventListener("wheel",e=>{e.preventDefault();const t=Date.now();this.lastScrollTime+n.x<t&&(this.captionsMenu.scrollTop+=e.deltaY>0?Math.min(e.deltaY,n.w):Math.max(e.deltaY,-n.w),this.lastScrollTime=t)});const a=this.createOptionElement(e+1,t.language,r);this.captionsMenu.appendChild(a),this.logOptionInfo("Finished adding option to menu",a)}this.createMenuCheckmark(0),this.captionsMenu.appendChild(this.captionsCheckmark)}logOptionInfo(e,t){h.a.info(508905682,JSON.stringify({Description:"PlaybackControls - Captions: "+e,Index:t.id,Font:t.style.font,FontFamily:t.style.fontFamily,FontSize:t.style.fontSize,FillOpacity:t.style.fillOpacity,Opacity:t.style.opacity,OptionOffsetHeight:t.offsetHeight,OptionOffsetTop:t.offsetTop,OptionOffsetLeft:t.offsetLeft,OptionOffsetWidth:t.offsetWidth}))}createOptionElement(e,t,i){h.a.info(512550663,"PlaybackControls - Captions: Creating option index: "+e);const r=F("div","closed-captions-menu-item");return t.length>0&&(r.lang=t),r.innerText=i,r.textContent=i,r.id=""+e,r.setAttribute(n.d,i),r.setAttribute("role","menuitemradio"),r.setAttribute(n.a,"false"),this.setOptionStyle(r),r.addEventListener("click",t=>{0===t.button&&(this.logOptionActivation(r,"Click"),this.updateCaptionTrack(e),this.hideCaptionsMenu("Click"),t.stopImmediatePropagation())}),r.addEventListener("touchend",()=>{this.logOptionActivation(r,"Touch")}),r.addEventListener("keydown",t=>{"Spacebar"!==t.key&&" "!==t.key&&"Enter"!==t.key||(this.logOptionActivation(r,"Keyboard"),this.updateCaptionTrack(e),this.hideCaptionsMenu("Keyboard"),this.captionsButton.focus(),t.preventDefault(),t.stopImmediatePropagation())}),r.addEventListener("mouseenter",()=>{this.showOptionFocus(r,0)}),r.addEventListener("focusin",()=>{this.showOptionFocus(r,0)}),r.addEventListener("mouseleave",()=>{this.hideOptionFocus(r)}),r.addEventListener("focusout",()=>{this.hideOptionFocus(r)}),r}logOptionActivation(e,t){h.a.info(509162655,JSON.stringify({Description:"PlaybackControls - Captions option activation",Source:t,Index:e.id,InnerText:e.innerText,TextContent:e.textContent}))}setOptionStyle(e){const t=8*this.captionsScaleFactor+"px";Object(g.a)(e,{paddingTop:t,paddingBottom:t,paddingLeft:32*this.captionsScaleFactor+"px",paddingRight:40*this.captionsScaleFactor+"px",color:"#F3F2F1",fontFamily:'"Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontSize:14*this.captionsScaleFactor+"px",textAlign:"left",fillOpacity:".8",background:"none"})}createCaptionsButton(){h.a.info(512550662,"PlaybackControls - Captions: Creating captions button");const e=this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.captionsButtonStr:"Closed captions",t=F("button","closed-captions-button");this.captionsButton=t,t.type="button",t.name=e,t.setAttribute(n.d,e),t.setAttribute(n.c,"menu"),t.disabled=!1,this.addCaptionbuttonIcons(),this.captionsButtonEnabled?(t.addEventListener("click",e=>{this.logCaptionsButtonEvent("Click"),this.toggleCaptionsMenuInternal("Click"),e.stopImmediatePropagation()}),t.addEventListener("touchend",()=>{this.logCaptionsButtonEvent("Touch")}),t.addEventListener("keydown",e=>{"Spacebar"===e.key||" "===e.key||"Enter"===e.key?(this.logCaptionsButtonEvent("Keyboard"),this.toggleCaptionsMenuInternal("Keyboard"),e.preventDefault(),e.stopImmediatePropagation()):this.nestedTabbingEnabled&&("ArrowLeft"===e.key?this.setPreviousArrowFocus(this.captionsButton,e):"ArrowRight"===e.key?this.setNextArrowFocus(this.captionsButton,e):"ArrowUp"!==e.key&&"ArrowDown"!==e.key||e.stopImmediatePropagation())}),void 0!==this.mediaControlInfo.tooltipMap&&t.addEventListener("mouseenter",()=>{t.title=this.getTooltip("Captions")})):void 0!==this.mediaControlInfo.tooltipMap&&(t.title=this.getTooltip("Captions disabled"))}logCaptionsButtonEvent(e){h.a.info(509163653,JSON.stringify({Description:"PlaybackControls - Captions button event received",Source:e}))}addCaptionbuttonIcons(){const e=d("captions-gfxicon");this.captionsButtonEnabled||(e.style.opacity=".40"),this.captionsButton.appendChild(e);const t=d("captions-active-gfxicon");M(t),this.captionsButton.appendChild(t)}ensureMenuPosition(e){if(null!==this.progressBar.offsetParent){const t=this.progressBar.offsetParent;if(null!==t)switch(e){case 0:this.ensureMenuDivPosition(t,this.captionsMenu.offsetHeight,this.captionsMenu.offsetWidth,this.captionsMenu);break;case 1:this.ensureMenuDivPosition(t,this.speedMenu.offsetHeight,this.speedMenu.offsetWidth,this.speedMenuDiv)}}}ensureMenuDivPosition(e,t,i,r){const n=null!==this.root&&void 0!==this.root&&null!==this.root.host&&void 0!==this.root.host&&this.root.host.offsetHeight>0?this.root.host.offsetHeight:this.videoElement.offsetHeight,a=Math.min(t,n-e.offsetHeight-2);Object(g.a)(r,{bottom:e.offsetHeight-2+"px",width:i+"px",height:a+"px"})}createMenuCheckmark(e){const t=d("checkmark-gfxicon");switch(e){case 0:this.captionsCheckmark=t,this.captionsCheckmark.style.scale=""+this.captionsScaleFactor;break;case 1:this.speedCheckmark=t,this.speedCheckmark.style.display="block"}const i=10*(1===this.captionsScaleFactor?1:this.captionsScaleFactor/2.5);Object(g.a)(t,{position:"absolute",left:i+"px",zIndex:"5"})}createTimeControl(e){this.currentTime=document.createElement("span"),this.currentTime.classList.add("text-formatting"),this.currentTime.style.marginLeft="4px",this.currentTime.innerText="0:00";const t=document.createElement("span");t.classList.add("text-formatting"),t.textContent=" / ",this.endTime=document.createElement("span"),this.endTime.classList.add("text-formatting"),this.endTime.id="video-end-time",this.updateTimeControl(),this.currentTime.style.alignSelf="center",t.style.alignSelf="center",this.endTime.style.alignSelf="center",this.shouldHideTimeControls()&&(this.currentTime.style.display="none",t.style.display="none",this.endTime.style.display="none"),P.a.getBoolean("showHideControlsOnResize")?(this.currentTimeContainer=F("div","current-time-container"),this.currentTime.style.marginLeft="",this.shouldHideTimeControls()&&(this.currentTimeContainer.style.display="none"),this.currentTimeContainer.appendChild(this.currentTime),this.currentTimeContainer.appendChild(t),this.currentTimeContainer.appendChild(this.endTime),e.appendChild(this.currentTimeContainer)):(e.appendChild(this.currentTime),e.appendChild(t),e.appendChild(this.endTime))}updateTimeControl(){let e=new Date(1e3*this.mediaInfo.max).toISOString();P.a.getBoolean("CorrectTrimmedVideoTimeControlDuration")&&this.mediaInfo.max>0&&(e=new Date(1e3*this.mediaInfo.max-this.mediaInfo.trimStartMs).toISOString());const t="00"===e.substring(11,13)?e.substring(14,19):e.substring(11,19);this.endTime.innerText=t,this.formattedEndTime=t}transferCaptionsToPlayer(){this.captionsPlaybackInPlayer||(this.captionsPlaybackInPlayer=!0,this.captionSelection<1||void 0===this.videoElement.textTracks[this.captionSelection-1]||(this.videoElement.textTracks[this.captionSelection-1].mode="showing",this.disableCaptionTrack(this.captionSelection)))}transferCaptionsToRenderer(){if(!this.captionsPlaybackInPlayer)return;const e=this.disableCaptionsInPlayer();void 0!==e&&this.enableCaptionTrack(e+1,!1)}createPlaybackSpeedControl(e){const t=F("button","speed");this.speedButton=t,t.type="button",t.classList.add("text-formatting"),t.innerText=this.mediaInfo.playbackSpeed.toString()+n.A,t.setAttribute(n.d,this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.speedButtonStr:"Playback speed"),t.setAttribute(n.c,"menu"),t.setAttribute(n.b,"false"),t.addEventListener("click",e=>{this.onPlaybackSpeedClick(),e.stopImmediatePropagation(),w(this.speedMenuDiv)||this.speedMenu.children[this.speedSelection].focus()}),t.addEventListener("keydown",e=>{"Spacebar"===e.key||" "===e.key||"Enter"===e.key?(this.onPlaybackSpeedClick(),e.preventDefault(),e.stopImmediatePropagation(),w(this.speedMenuDiv)||this.showOptionFocus(this.speedMenu.children[this.speedSelection],1)):this.nestedTabbingEnabled&&("ArrowLeft"===e.key?this.setPreviousArrowFocus(this.speedButton,e):"ArrowRight"===e.key?this.setNextArrowFocus(this.speedButton,e):"ArrowUp"!==e.key&&"ArrowDown"!==e.key||e.stopImmediatePropagation())}),e.appendChild(this.speedButton)}createPlaybackSpeedMenu(e){this.speedMenuDiv=F("div","speed-menu-div"),this.speedMenuDiv.classList.add("text-formatting","invisible"),this.speedMenuDiv.style.display="block",this.speedMenu=F("div","speed-menu"),this.speedMenu.style.display="block",this.speedMenu.setAttribute("role","menu");for(let e=0;e<n.z.length;e+=1){const t=F("div","speed-menu-option");t.classList.add("text-formatting");let i="";i=this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.speedMenuOptionStr.replace("{0}",n.z[e].toString()):n.z[e].toString()+n.A,t.innerText=i,t.id=""+e,t.setAttribute(n.d,i),t.setAttribute("role","menuitemradio"),t.setAttribute(n.a,"false"),t.addEventListener("click",t=>{this.setPlaybackSpeed(e),t.stopImmediatePropagation(),2!==this.positioningStrategy&&3!==this.positioningStrategy&&this.resetCaptionsOverlap(),this.speedButton.focus()}),t.addEventListener("keydown",t=>{"Spacebar"!==t.key&&" "!==t.key&&"Enter"!==t.key||(this.setPlaybackSpeed(e),this.speedButton.focus(),t.preventDefault(),t.stopImmediatePropagation())}),t.addEventListener("mouseenter",()=>{this.showOptionFocus(t,1)}),t.addEventListener("focusin",()=>{this.showOptionFocus(t,1)}),t.addEventListener("mouseleave",()=>{this.hideOptionFocus(t)}),t.addEventListener("focusout",e=>{this.hideOptionFocus(t),e.stopImmediatePropagation()}),this.speedMenu.appendChild(t)}this.speedMenu.addEventListener("focusout",e=>{e.stopImmediatePropagation()}),this.speedMenuDiv.addEventListener("wheel",e=>{e.preventDefault();const t=Date.now();this.lastScrollTime+n.x<t&&(this.speedMenuDiv.scrollTop+=e.deltaY>0?Math.min(e.deltaY,n.w):Math.max(e.deltaY,-n.w),this.lastScrollTime=t)}),e.appendChild(this.speedMenuDiv),this.speedMenuDiv.appendChild(this.speedMenu),this.createMenuCheckmark(1),M(this.speedCheckmark),this.speedMenu.appendChild(this.speedCheckmark)}createFullscreenControl(e){this.fullscreenButton=F("button","fullscreen"),this.fullscreenButton.type="button",this.fullscreenButton.setAttribute(n.d,this.mediaInfo.screenReaderInfo?this.mediaInfo.screenReaderInfo.fullScreenButtonStr:"Full screen");const t=d("fullscreen-gfxicon");this.fullscreenButton.appendChild(t),this.fullscreenButton.addEventListener("click",()=>this.onFullscreenClick()),this.fullscreenButton.addEventListener("keydown",e=>{"Spacebar"===e.key||" "===e.key||"Enter"===e.key?this.onFullscreenClick():this.nestedTabbingEnabled&&("ArrowLeft"===e.key?this.setPreviousArrowFocus(this.fullscreenButton,e):"ArrowRight"!==e.key&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key||e.stopImmediatePropagation())}),e.appendChild(this.fullscreenButton)}setFullscreenIcon(e){const t=this.fullscreenButton.querySelector("#fullscreen-enter-gfxicon"),i=this.fullscreenButton.querySelector("#fullscreen-exit-gfxicon");null!==t&&null!==i?e?(C(i),M(t)):(C(t),M(i)):(h.a.warn(509346561,"PlayerControls.setFullscreenIcon: querySelector returned null."),void 0!==this.mediaCallbacks&&this.mediaCallbacks.logVetoCallback("IncorrectFullscreenIcon"))}getTooltip(e){if(void 0===this.mediaControlInfo.tooltipMap)return e.toString();const t=this.mediaControlInfo.tooltipMap.get(e);if(void 0===t||void 0===this.mediaCallbacks)return e.toString();const i=this.mediaCallbacks.isPresenterCallback();return void 0===i?t.noRole:i?t.presenter:t.attendee}setProgressForScreenReader(){if(void 0!==this.mediaInfo.screenReaderInfo){const e=b(this.videoElement.currentTime,this.mediaInfo.screenReaderInfo),t=b(this.videoElement.duration,this.mediaInfo.screenReaderInfo),i=this.mediaInfo.screenReaderInfo.progressStr.replace("{0}",e).replace("{1}",t);this.progressBar.setAttribute(n.e,i)}}shouldHideTimeControls(){if(void 0===this.mediaControlInfo.controlHidingEnabled||!this.mediaControlInfo.controlHidingEnabled||void 0===this.mediaControlInfo.widthThresholdForHidingControls)return!1;let e=!1;return this.volumeSliderEnabled&&(e=this.mediaControlInfo.size.x<this.mediaControlInfo.widthThresholdForHidingControls-(this.speedButtonEnabled?0:n.f)-(this.captionsButtonVisible?0:n.f)),e}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r=i(51),n=i(21),a=i(4),s=i(2),o=i(3);class l{}l.defaultVideoHeight=480,l.defaultVideoWidth=640,l.defaultFrameRate=30;class d{constructor(e){this.mediaStreamSource=e.source,this.videoConstraints=e.videoConstraints?e.videoConstraints:{},this.originalVideoConstraints=this.videoConstraints;const t=document.createElement("video");t.id=e.id,this.videoElement=t}async startMediaCaptureAsync(e,t=!1){e&&this.updateConstraints(e,t),this.mediaStreamSource.stream&&this.mediaStreamSource.stopMediaCapture();const i=await this.mediaStreamSource.startMediaCaptureAsync(this.videoConstraints);if(i!==r.a.ErrorNone)return i;if(!this.mediaStreamSource.stream)return r.a.ErrorUnknown;const n=this.getMediaStreamResolution(this.mediaStreamSource.stream);this.videoElement.width=n.x,this.videoElement.height=n.y,this.videoElement.srcObject=this.mediaStreamSource.stream;try{await this.videoElement.play()}catch(e){return r.a.ErrorVideoPlaybackFailed}return r.a.ErrorNone}stopMediaCapture(){this.videoElement.pause(),this.videoElement.srcObject=null,this.mediaStreamSource.stopMediaCapture()}get VideoElement(){return this.videoElement}get DeviceId(){if(this.videoConstraints.deviceId)return"string"==typeof this.videoConstraints.deviceId?this.videoConstraints.deviceId:JSON.stringify(this.videoConstraints.deviceId)}get isActive(){return!(!this.mediaStreamSource||!this.mediaStreamSource.stream)&&this.mediaStreamSource.stream.active}resetToOriginalConstraints(){this.videoConstraints=this.originalVideoConstraints}updateConstraints(e,t){const i=t?{deviceId:void 0,width:void 0,height:void 0,frameRate:void 0,facingMode:void 0}:this.videoConstraints,r=i;e.deviceId&&e.deviceId!==i.deviceId&&(r.deviceId=e.deviceId),e.width&&e.width!==i.width&&(r.width=e.width),e.height&&e.height!==i.height&&(r.height=e.height),e.frameRate&&e.frameRate!==i.frameRate&&(r.frameRate=e.frameRate),e.facingMode&&e.facingMode!==i.facingMode&&(r.facingMode=e.facingMode),this.videoConstraints=r}getMediaStreamResolution(e){if(e){const t=e.getVideoTracks();if(t&&t.length>0){const e=t[0].getSettings();if(e.width&&e.height)return a.a.sendTraceTag(508700307,s.a.msoulscat_Wac_PptSession,o.a.Info,`MediaStreamClient::getMediaStreamResolution : extracted resolution from MediaStream video track. width=${e.width}, height=${e.height}`),new n.b(e.width,e.height)}}return a.a.sendTraceTag(509745350,s.a.msoulscat_Wac_PptSession,o.a.Error,"MediaStreamClient::getMediaStreamResolution : Unable to get resolution from MediaStream track. Falling back to default dimensions."),new n.b(l.defaultVideoWidth,l.defaultVideoHeight)}}},function(e,t,i){"use strict";var r=i(252);i.o(r,"PresenterSyncStateManager")&&i.d(t,"PresenterSyncStateManager",(function(){return r.PresenterSyncStateManager})),i.o(r,"PrivateViewingManager")&&i.d(t,"PrivateViewingManager",(function(){return r.PrivateViewingManager}));var n=i(253);i.o(n,"PresenterSyncStateManager")&&i.d(t,"PresenterSyncStateManager",(function(){return n.PresenterSyncStateManager})),i.o(n,"PrivateViewingManager")&&i.d(t,"PrivateViewingManager",(function(){return n.PrivateViewingManager}));var a=i(254);i.d(t,"PrivateViewingManager",(function(){return a.a}));var s=i(255);i.d(t,"PresenterSyncStateManager",(function(){return s.a}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r=i(4),n=i(2),a=i(3),s=i(58);class o{constructor(e){e&&e.telemetryLogger&&(this.telemetryLogger=e.telemetryLogger)}logActivity(e,t,i,r){this.sendPenOrInkMinutesEvent(e,i,r)}sendPenOrInkMinutesEvent(e,t,i){const r=[];for(let e=0;e<t.length;e+=1)t[e]&&i[e]&&r.push({name:t[e],string:i[e]});const n={name:"Office.PowerPoint.Online.Data.Activity."+e,dataFields:r};this.sendTelemetryEvent(n)}sendTelemetryEvent(e){try{this.telemetryLogger?this.telemetryLogger.sendTelemetryEvent(e):s.b.sendOtelEvent(e)}catch(e){r.a.sendTraceTag(527230946,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,"Failed to send PenOrInkMinutes TelemetryEvent. Ex: "+e)}}}},,function(e,t,i){"use strict";var r=i(26),n=i(177),a=i(29).Buffer,s=new Array(16);function o(){n.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function l(e,t){return e<<t|e>>>32-t}function d(e,t,i,r,n,a,s){return l(e+(t&i|~t&r)+n+a|0,s)+t|0}function h(e,t,i,r,n,a,s){return l(e+(t&r|i&~r)+n+a|0,s)+t|0}function c(e,t,i,r,n,a,s){return l(e+(t^i^r)+n+a|0,s)+t|0}function u(e,t,i,r,n,a,s){return l(e+(i^(t|~r))+n+a|0,s)+t|0}r(o,n),o.prototype._update=function(){for(var e=s,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);var i=this._a,r=this._b,n=this._c,a=this._d;i=d(i,r,n,a,e[0],3614090360,7),a=d(a,i,r,n,e[1],3905402710,12),n=d(n,a,i,r,e[2],606105819,17),r=d(r,n,a,i,e[3],3250441966,22),i=d(i,r,n,a,e[4],4118548399,7),a=d(a,i,r,n,e[5],1200080426,12),n=d(n,a,i,r,e[6],2821735955,17),r=d(r,n,a,i,e[7],4249261313,22),i=d(i,r,n,a,e[8],1770035416,7),a=d(a,i,r,n,e[9],2336552879,12),n=d(n,a,i,r,e[10],4294925233,17),r=d(r,n,a,i,e[11],2304563134,22),i=d(i,r,n,a,e[12],1804603682,7),a=d(a,i,r,n,e[13],4254626195,12),n=d(n,a,i,r,e[14],2792965006,17),i=h(i,r=d(r,n,a,i,e[15],1236535329,22),n,a,e[1],4129170786,5),a=h(a,i,r,n,e[6],3225465664,9),n=h(n,a,i,r,e[11],643717713,14),r=h(r,n,a,i,e[0],3921069994,20),i=h(i,r,n,a,e[5],3593408605,5),a=h(a,i,r,n,e[10],38016083,9),n=h(n,a,i,r,e[15],3634488961,14),r=h(r,n,a,i,e[4],3889429448,20),i=h(i,r,n,a,e[9],568446438,5),a=h(a,i,r,n,e[14],3275163606,9),n=h(n,a,i,r,e[3],4107603335,14),r=h(r,n,a,i,e[8],1163531501,20),i=h(i,r,n,a,e[13],2850285829,5),a=h(a,i,r,n,e[2],4243563512,9),n=h(n,a,i,r,e[7],1735328473,14),i=c(i,r=h(r,n,a,i,e[12],2368359562,20),n,a,e[5],4294588738,4),a=c(a,i,r,n,e[8],2272392833,11),n=c(n,a,i,r,e[11],1839030562,16),r=c(r,n,a,i,e[14],4259657740,23),i=c(i,r,n,a,e[1],2763975236,4),a=c(a,i,r,n,e[4],1272893353,11),n=c(n,a,i,r,e[7],4139469664,16),r=c(r,n,a,i,e[10],3200236656,23),i=c(i,r,n,a,e[13],681279174,4),a=c(a,i,r,n,e[0],3936430074,11),n=c(n,a,i,r,e[3],3572445317,16),r=c(r,n,a,i,e[6],76029189,23),i=c(i,r,n,a,e[9],3654602809,4),a=c(a,i,r,n,e[12],3873151461,11),n=c(n,a,i,r,e[15],530742520,16),i=u(i,r=c(r,n,a,i,e[2],3299628645,23),n,a,e[0],4096336452,6),a=u(a,i,r,n,e[7],1126891415,10),n=u(n,a,i,r,e[14],2878612391,15),r=u(r,n,a,i,e[5],4237533241,21),i=u(i,r,n,a,e[12],1700485571,6),a=u(a,i,r,n,e[3],2399980690,10),n=u(n,a,i,r,e[10],4293915773,15),r=u(r,n,a,i,e[1],2240044497,21),i=u(i,r,n,a,e[8],1873313359,6),a=u(a,i,r,n,e[15],4264355552,10),n=u(n,a,i,r,e[6],2734768916,15),r=u(r,n,a,i,e[13],1309151649,21),i=u(i,r,n,a,e[4],4149444226,6),a=u(a,i,r,n,e[11],3174756917,10),n=u(n,a,i,r,e[2],718787259,15),r=u(r,n,a,i,e[9],3951481745,21),this._a=this._a+i|0,this._b=this._b+r|0,this._c=this._c+n|0,this._d=this._d+a|0},o.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=a.allocUnsafe(16);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e},e.exports=o},function(e,t,i){(function(t){function i(e){try{if(!t.localStorage)return!1}catch(e){return!1}var i=t.localStorage[e];return null!=i&&"true"===String(i).toLowerCase()}e.exports=function(e,t){if(i("noDeprecation"))return e;var r=!1;return function(){if(!r){if(i("throwDeprecation"))throw new Error(t);i("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}}).call(this,i(55))},function(e,t,i){"use strict";var r=i(104).codes.ERR_STREAM_PREMATURE_CLOSE;function n(){}e.exports=function e(t,i,a){if("function"==typeof i)return e(t,null,i);i||(i={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];e.apply(this,r)}}}(a||n);var s=i.readable||!1!==i.readable&&t.readable,o=i.writable||!1!==i.writable&&t.writable,l=function(){t.writable||h()},d=t._writableState&&t._writableState.finished,h=function(){o=!1,d=!0,s||a.call(t)},c=t._readableState&&t._readableState.endEmitted,u=function(){s=!1,c=!0,o||a.call(t)},f=function(e){a.call(t,e)},m=function(){var e;return s&&!c?(t._readableState&&t._readableState.ended||(e=new r),a.call(t,e)):o&&!d?(t._writableState&&t._writableState.ended||(e=new r),a.call(t,e)):void 0},p=function(){t.req.on("finish",h)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",h),t.on("abort",m),t.req?p():t.on("request",p)):o&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",u),t.on("finish",h),!1!==i.error&&t.on("error",f),t.on("close",m),function(){t.removeListener("complete",h),t.removeListener("abort",m),t.removeListener("request",p),t.req&&t.req.removeListener("finish",h),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",h),t.removeListener("end",u),t.removeListener("error",f),t.removeListener("close",m)}}},function(e,t,i){"use strict";var r=i(43).Buffer,n=i(26),a=i(177),s=new Array(16),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],l=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],d=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],h=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],c=[0,1518500249,1859775393,2400959708,2840853838],u=[1352829926,1548603684,1836072691,2053994217,0];function f(){a.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function m(e,t){return e<<t|e>>>32-t}function p(e,t,i,r,n,a,s,o){return m(e+(t^i^r)+a+s|0,o)+n|0}function g(e,t,i,r,n,a,s,o){return m(e+(t&i|~t&r)+a+s|0,o)+n|0}function _(e,t,i,r,n,a,s,o){return m(e+((t|~i)^r)+a+s|0,o)+n|0}function v(e,t,i,r,n,a,s,o){return m(e+(t&r|i&~r)+a+s|0,o)+n|0}function y(e,t,i,r,n,a,s,o){return m(e+(t^(i|~r))+a+s|0,o)+n|0}n(f,a),f.prototype._update=function(){for(var e=s,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);for(var i=0|this._a,r=0|this._b,n=0|this._c,a=0|this._d,f=0|this._e,b=0|this._a,S=0|this._b,T=0|this._c,w=0|this._d,M=0|this._e,C=0;C<80;C+=1){var I,P;C<16?(I=p(i,r,n,a,f,e[o[C]],c[0],d[C]),P=y(b,S,T,w,M,e[l[C]],u[0],h[C])):C<32?(I=g(i,r,n,a,f,e[o[C]],c[1],d[C]),P=v(b,S,T,w,M,e[l[C]],u[1],h[C])):C<48?(I=_(i,r,n,a,f,e[o[C]],c[2],d[C]),P=_(b,S,T,w,M,e[l[C]],u[2],h[C])):C<64?(I=v(i,r,n,a,f,e[o[C]],c[3],d[C]),P=g(b,S,T,w,M,e[l[C]],u[3],h[C])):(I=y(i,r,n,a,f,e[o[C]],c[4],d[C]),P=p(b,S,T,w,M,e[l[C]],u[4],h[C])),i=f,f=a,a=m(n,10),n=r,r=I,b=M,M=w,w=m(T,10),T=S,S=P}var E=this._b+n+w|0;this._b=this._c+a+M|0,this._c=this._d+f+b|0,this._d=this._e+i+S|0,this._e=this._a+r+T|0,this._a=E},f.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=r.alloc?r.alloc(20):new r(20);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e.writeInt32LE(this._e,16),e},e.exports=f},function(e,t,i){(t=e.exports=i(186)).Stream=t,t.Readable=t,t.Writable=i(150),t.Duplex=i(97),t.Transform=i(189),t.PassThrough=i(291)},function(e,t,i){var r=i(43),n=r.Buffer;function a(e,t){for(var i in e)t[i]=e[i]}function s(e,t,i){return n(e,t,i)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(a(r,t),t.Buffer=s),a(n,s),s.from=function(e,t,i){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,i)},s.alloc=function(e,t,i){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=n(e);return void 0!==t?"string"==typeof i?r.fill(t,i):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,i){"use strict";(function(t,r,n){var a=i(127);function s(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,i){var r=e.entry;for(e.entry=null;r;){var n=r.callback;t.pendingcb--,n(void 0),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=v;var o,l=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?r:a.nextTick;v.WritableState=_;var d=Object.create(i(117));d.inherits=i(26);var h,c={deprecate:i(145)},u=i(187),f=i(149).Buffer,m=n.Uint8Array||function(){},p=i(188);function g(){}function _(e,t){o=o||i(97),e=e||{};var r=t instanceof o;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,d=e.writableHighWaterMark,h=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r&&(d||0===d)?d:h,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var c=!1===e.decodeStrings;this.decodeStrings=!c,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var i=e._writableState,r=i.sync,n=i.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(i),t)!function(e,t,i,r,n){--t.pendingcb,i?(a.nextTick(n,r),a.nextTick(M,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(n(r),e._writableState.errorEmitted=!0,e.emit("error",r),M(e,t))}(e,i,r,t,n);else{var s=T(i);s||i.corked||i.bufferProcessing||!i.bufferedRequest||S(e,i),r?l(b,e,i,s,n):b(e,i,s,n)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function v(e){if(o=o||i(97),!(h.call(v,this)||this instanceof o))return new v(e);this._writableState=new _(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),u.call(this)}function y(e,t,i,r,n,a,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,i?e._writev(n,t.onwrite):e._write(n,a,t.onwrite),t.sync=!1}function b(e,t,i,r){i||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),M(e,t)}function S(e,t){t.bufferProcessing=!0;var i=t.bufferedRequest;if(e._writev&&i&&i.next){var r=t.bufferedRequestCount,n=new Array(r),a=t.corkedRequestsFree;a.entry=i;for(var o=0,l=!0;i;)n[o]=i,i.isBuf||(l=!1),i=i.next,o+=1;n.allBuffers=l,y(e,t,!0,t.length,n,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new s(t),t.bufferedRequestCount=0}else{for(;i;){var d=i.chunk,h=i.encoding,c=i.callback;if(y(e,t,!1,t.objectMode?1:d.length,d,h,c),i=i.next,t.bufferedRequestCount--,t.writing)break}null===i&&(t.lastBufferedRequest=null)}t.bufferedRequest=i,t.bufferProcessing=!1}function T(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function w(e,t){e._final((function(i){t.pendingcb--,i&&e.emit("error",i),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var i=T(t);return i&&(function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,a.nextTick(w,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),i}d.inherits(v,u),_.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(_.prototype,"buffer",{get:c.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(e){return!!h.call(this,e)||this===v&&e&&e._writableState instanceof _}})):h=function(e){return e instanceof this},v.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},v.prototype.write=function(e,t,i){var r,n=this._writableState,s=!1,o=!n.objectMode&&(r=e,f.isBuffer(r)||r instanceof m);return o&&!f.isBuffer(e)&&(e=function(e){return f.from(e)}(e)),"function"==typeof t&&(i=t,t=null),o?t="buffer":t||(t=n.defaultEncoding),"function"!=typeof i&&(i=g),n.ended?function(e,t){var i=new Error("write after end");e.emit("error",i),a.nextTick(t,i)}(this,i):(o||function(e,t,i,r){var n=!0,s=!1;return null===i?s=new TypeError("May not write null values to stream"):"string"==typeof i||void 0===i||t.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(e.emit("error",s),a.nextTick(r,s),n=!1),n}(this,n,e,i))&&(n.pendingcb++,s=function(e,t,i,r,n,a){if(!i){var s=function(e,t,i){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=f.from(t,i)),t}(t,r,n);r!==s&&(i=!0,n="buffer",r=s)}var o=t.objectMode?1:r.length;t.length+=o;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var d=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:n,isBuf:i,callback:a,next:null},d?d.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else y(e,t,!1,o,r,n,a);return l}(this,n,o,e,t,i)),s},v.prototype.cork=function(){this._writableState.corked++},v.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||S(this,e))},v.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),v.prototype._write=function(e,t,i){i(new Error("_write() is not implemented"))},v.prototype._writev=null,v.prototype.end=function(e,t,i){var r=this._writableState;"function"==typeof e?(i=e,e=null,t=null):"function"==typeof t&&(i=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,i){t.ending=!0,M(e,t),i&&(t.finished?a.nextTick(i):e.once("finish",i)),t.ended=!0,e.writable=!1}(this,r,i)},Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),v.prototype.destroy=p.destroy,v.prototype._undestroy=p.undestroy,v.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,i(48),i(175).setImmediate,i(55))},function(e,t,i){"use strict";var r=i(65);function n(e){this.options=e,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}e.exports=n,n.prototype._init=function(){},n.prototype.update=function(e){return 0===e.length?[]:"decrypt"===this.type?this._updateDecrypt(e):this._updateEncrypt(e)},n.prototype._buffer=function(e,t){for(var i=Math.min(this.buffer.length-this.bufferOff,e.length-t),r=0;r<i;r++)this.buffer[this.bufferOff+r]=e[t+r];return this.bufferOff+=i,i},n.prototype._flushBuffer=function(e,t){return this._update(this.buffer,0,e,t),this.bufferOff=0,this.blockSize},n.prototype._updateEncrypt=function(e){var t=0,i=0,r=(this.bufferOff+e.length)/this.blockSize|0,n=new Array(r*this.blockSize);0!==this.bufferOff&&(t+=this._buffer(e,t),this.bufferOff===this.buffer.length&&(i+=this._flushBuffer(n,i)));for(var a=e.length-(e.length-t)%this.blockSize;t<a;t+=this.blockSize)this._update(e,t,n,i),i+=this.blockSize;for(;t<e.length;t++,this.bufferOff++)this.buffer[this.bufferOff]=e[t];return n},n.prototype._updateDecrypt=function(e){for(var t=0,i=0,r=Math.ceil((this.bufferOff+e.length)/this.blockSize)-1,n=new Array(r*this.blockSize);r>0;r--)t+=this._buffer(e,t),i+=this._flushBuffer(n,i);return t+=this._buffer(e,t),n},n.prototype.final=function(e){var t,i;return e&&(t=this.update(e)),i="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),t?t.concat(i):i},n.prototype._pad=function(e,t){if(0===t)return!1;for(;t<e.length;)e[t++]=0;return!0},n.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var e=new Array(this.blockSize);return this._update(this.buffer,0,e,0),e},n.prototype._unpad=function(e){return e},n.prototype._finalDecrypt=function(){r.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var e=new Array(this.blockSize);return this._flushBuffer(e,0),this._unpad(e)}},function(e,t,i){var r=i(304),n=i(312),a=i(202);t.createCipher=t.Cipher=r.createCipher,t.createCipheriv=t.Cipheriv=r.createCipheriv,t.createDecipher=t.Decipher=n.createDecipher,t.createDecipheriv=t.Decipheriv=n.createDecipheriv,t.listCiphers=t.getCiphers=function(){return Object.keys(a)}},function(e,t,i){var r={ECB:i(305),CBC:i(306),CFB:i(307),CFB8:i(308),CFB1:i(309),OFB:i(310),CTR:i(200),GCM:i(200)},n=i(202);for(var a in n)n[a].module=r[n[a].mode];e.exports=n},function(e,t,i){var r;function n(e){this.rand=e}if(e.exports=function(e){return r||(r=new n(null)),r.generate(e)},e.exports.Rand=n,n.prototype.generate=function(e){return this._rand(e)},n.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),i=0;i<t.length;i++)t[i]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?n.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?n.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(n.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var a=i(318);if("function"!=typeof a.randomBytes)throw new Error("Not supported");n.prototype._rand=function(e){return a.randomBytes(e)}}catch(e){}},function(e,t,i){"use strict";var r=i(107).codes.ERR_STREAM_PREMATURE_CLOSE;function n(){}e.exports=function e(t,i,a){if("function"==typeof i)return e(t,null,i);i||(i={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];e.apply(this,r)}}}(a||n);var s=i.readable||!1!==i.readable&&t.readable,o=i.writable||!1!==i.writable&&t.writable,l=function(){t.writable||h()},d=t._writableState&&t._writableState.finished,h=function(){o=!1,d=!0,s||a.call(t)},c=t._readableState&&t._readableState.endEmitted,u=function(){s=!1,c=!0,o||a.call(t)},f=function(e){a.call(t,e)},m=function(){var e;return s&&!c?(t._readableState&&t._readableState.ended||(e=new r),a.call(t,e)):o&&!d?(t._writableState&&t._writableState.ended||(e=new r),a.call(t,e)):void 0},p=function(){t.req.on("finish",h)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",h),t.on("abort",m),t.req?p():t.on("request",p)):o&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",u),t.on("finish",h),!1!==i.error&&t.on("error",f),t.on("close",m),function(){t.removeListener("complete",h),t.removeListener("abort",m),t.removeListener("request",p),t.req&&t.req.removeListener("finish",h),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",h),t.removeListener("end",u),t.removeListener("error",f),t.removeListener("close",m)}}},function(e,t,i){(function(t){var r=i(331),n=i(103);function a(e,i){var n=function(e){var t=s(e);return{blinder:t.toRed(r.mont(e.modulus)).redPow(new r(e.publicExponent)).fromRed(),unblinder:t.invm(e.modulus)}}(i),a=i.modulus.byteLength(),o=(r.mont(i.modulus),new r(e).mul(n.blinder).umod(i.modulus)),l=o.toRed(r.mont(i.prime1)),d=o.toRed(r.mont(i.prime2)),h=i.coefficient,c=i.prime1,u=i.prime2,f=l.redPow(i.exponent1),m=d.redPow(i.exponent2);f=f.fromRed(),m=m.fromRed();var p=f.isub(m).imul(h).umod(c);return p.imul(u),m.iadd(p),new t(m.imul(n.unblinder).umod(i.modulus).toArray(!1,a))}function s(e){for(var t=e.modulus.byteLength(),i=new r(n(t));i.cmp(e.modulus)>=0||!i.umod(e.prime1)||!i.umod(e.prime2);)i=new r(n(t));return i}e.exports=a,a.getr=s}).call(this,i(43).Buffer)},function(e,t,i){"use strict";var r=t;r.version=i(333).version,r.utils=i(66),r.rand=i(154),r.curve=i(215),r.curves=i(158),r.ec=i(345),r.eddsa=i(349)},function(e,t,i){"use strict";var r,n=t,a=i(159),s=i(215),o=i(66).assert;function l(e){"short"===e.type?this.curve=new s.short(e):"edwards"===e.type?this.curve=new s.edwards(e):this.curve=new s.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,o(this.g.validate(),"Invalid curve"),o(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function d(e,t){Object.defineProperty(n,e,{configurable:!0,enumerable:!0,get:function(){var i=new l(t);return Object.defineProperty(n,e,{configurable:!0,enumerable:!0,value:i}),i}})}n.PresetCurve=l,d("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:a.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),d("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:a.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),d("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:a.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),d("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:a.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),d("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:a.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),d("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:a.sha256,gRed:!1,g:["9"]}),d("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:a.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{r=i(344)}catch(e){r=void 0}d("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:a.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",r]})},function(e,t,i){var r=t;r.utils=i(76),r.common=i(119),r.sha=i(338),r.ripemd=i(342),r.hmac=i(343),r.sha1=r.sha.sha1,r.sha256=r.sha.sha256,r.sha224=r.sha.sha224,r.sha384=r.sha.sha384,r.sha512=r.sha.sha512,r.ripemd160=r.ripemd.ripemd160},function(e,t,i){(function(e){!function(e,t){"use strict";function r(e,t){if(!e)throw new Error(t||"Assertion failed")}function n(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function a(e,t,i){if(a.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(i=t,t=10),this._init(e||0,t||10,i||"be"))}var s;"object"==typeof e?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;try{s=i(374).Buffer}catch(e){}function o(e,t,i){for(var r=0,n=Math.min(e.length,i),a=t;a<n;a++){var s=e.charCodeAt(a)-48;r<<=4,r|=s>=49&&s<=54?s-49+10:s>=17&&s<=22?s-17+10:15&s}return r}function l(e,t,i,r){for(var n=0,a=Math.min(e.length,i),s=t;s<a;s++){var o=e.charCodeAt(s)-48;n*=r,n+=o>=49?o-49+10:o>=17?o-17+10:o}return n}a.isBN=function(e){return e instanceof a||null!==e&&"object"==typeof e&&e.constructor.wordSize===a.wordSize&&Array.isArray(e.words)},a.max=function(e,t){return e.cmp(t)>0?e:t},a.min=function(e,t){return e.cmp(t)<0?e:t},a.prototype._init=function(e,t,i){if("number"==typeof e)return this._initNumber(e,t,i);if("object"==typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36);var n=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&n++,16===t?this._parseHex(e,n):this._parseBase(e,t,n),"-"===e[0]&&(this.negative=1),this.strip(),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(r(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initArray=function(e,t,i){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var a,s,o=0;if("be"===i)for(n=e.length-1,a=0;n>=0;n-=3)s=e[n]|e[n-1]<<8|e[n-2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);else if("le"===i)for(n=0,a=0;n<e.length;n+=3)s=e[n]|e[n+1]<<8|e[n+2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);return this.strip()},a.prototype._parseHex=function(e,t){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var r,n,a=0;for(i=e.length-6,r=0;i>=t;i-=6)n=o(e,i,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303,(a+=24)>=26&&(a-=26,r++);i+6!==t&&(n=o(e,t,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303),this.strip()},a.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var r=0,n=1;n<=67108863;n*=t)r++;r--,n=n/t|0;for(var a=e.length-i,s=a%r,o=Math.min(a,a-s)+i,d=0,h=i;h<o;h+=r)d=l(e,h,h+r,t),this.imuln(n),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d);if(0!==s){var c=1;for(d=l(e,h,e.length,t),h=0;h<s;h++)c*=t;this.imuln(c),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d)}},a.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},a.prototype.clone=function(){var e=new a(null);return this.copy(e),e},a.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},a.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],c=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function u(e,t,i){i.negative=t.negative^e.negative;var r=e.length+t.length|0;i.length=r,r=r-1|0;var n=0|e.words[0],a=0|t.words[0],s=n*a,o=67108863&s,l=s/67108864|0;i.words[0]=o;for(var d=1;d<r;d++){for(var h=l>>>26,c=67108863&l,u=Math.min(d,t.length-1),f=Math.max(0,d-e.length+1);f<=u;f++){var m=d-f|0;h+=(s=(n=0|e.words[m])*(a=0|t.words[f])+c)/67108864|0,c=67108863&s}i.words[d]=0|c,l=0|h}return 0!==l?i.words[d]=0|l:i.length--,i.strip()}a.prototype.toString=function(e,t){var i;if(t=0|t||1,16===(e=e||10)||"hex"===e){i="";for(var n=0,a=0,s=0;s<this.length;s++){var o=this.words[s],l=(16777215&(o<<n|a)).toString(16);i=0!=(a=o>>>24-n&16777215)||s!==this.length-1?d[6-l.length]+l+i:l+i,(n+=2)>=26&&(n-=26,s--)}for(0!==a&&(i=a.toString(16)+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var u=h[e],f=c[e];i="";var m=this.clone();for(m.negative=0;!m.isZero();){var p=m.modn(f).toString(e);i=(m=m.idivn(f)).isZero()?p+i:d[u-p.length]+p+i}for(this.isZero()&&(i="0"+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(e,t){return r(void 0!==s),this.toArrayLike(s,e,t)},a.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},a.prototype.toArrayLike=function(e,t,i){var n=this.byteLength(),a=i||Math.max(1,n);r(n<=a,"byte array longer than desired length"),r(a>0,"Requested array length <= 0"),this.strip();var s,o,l="le"===t,d=new e(a),h=this.clone();if(l){for(o=0;!h.isZero();o++)s=h.andln(255),h.iushrn(8),d[o]=s;for(;o<a;o++)d[o]=0}else{for(o=0;o<a-n;o++)d[o]=0;for(o=0;!h.isZero();o++)s=h.andln(255),h.iushrn(8),d[a-o-1]=s}return d},Math.clz32?a.prototype._countBits=function(e){return 32-Math.clz32(e)}:a.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},a.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return 0==(8191&t)&&(i+=13,t>>>=13),0==(127&t)&&(i+=7,t>>>=7),0==(15&t)&&(i+=4,t>>>=4),0==(3&t)&&(i+=2,t>>>=2),0==(1&t)&&i++,i},a.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},a.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return 0!==this.negative},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},a.prototype.ior=function(e){return r(0==(this.negative|e.negative)),this.iuor(e)},a.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},a.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},a.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this.strip()},a.prototype.iand=function(e){return r(0==(this.negative|e.negative)),this.iuand(e)},a.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},a.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},a.prototype.iuxor=function(e){var t,i;this.length>e.length?(t=this,i=e):(t=e,i=this);for(var r=0;r<i.length;r++)this.words[r]=t.words[r]^i.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this.strip()},a.prototype.ixor=function(e){return r(0==(this.negative|e.negative)),this.iuxor(e)},a.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},a.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},a.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var n=0;n<t;n++)this.words[n]=67108863&~this.words[n];return i>0&&(this.words[n]=~this.words[n]&67108863>>26-i),this.strip()},a.prototype.notn=function(e){return this.clone().inotn(e)},a.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var i=e/26|0,n=e%26;return this._expand(i+1),this.words[i]=t?this.words[i]|1<<n:this.words[i]&~(1<<n),this.strip()},a.prototype.iadd=function(e){var t,i,r;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,r=e):(i=e,r=this);for(var n=0,a=0;a<r.length;a++)t=(0|i.words[a])+(0|r.words[a])+n,this.words[a]=67108863&t,n=t>>>26;for(;0!==n&&a<i.length;a++)t=(0|i.words[a])+n,this.words[a]=67108863&t,n=t>>>26;if(this.length=i.length,0!==n)this.words[this.length]=n,this.length++;else if(i!==this)for(;a<i.length;a++)this.words[a]=i.words[a];return this},a.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},a.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var i,r,n=this.cmp(e);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(i=this,r=e):(i=e,r=this);for(var a=0,s=0;s<r.length;s++)a=(t=(0|i.words[s])-(0|r.words[s])+a)>>26,this.words[s]=67108863&t;for(;0!==a&&s<i.length;s++)a=(t=(0|i.words[s])+a)>>26,this.words[s]=67108863&t;if(0===a&&s<i.length&&i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this.length=Math.max(this.length,s),i!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(e){return this.clone().isub(e)};var f=function(e,t,i){var r,n,a,s=e.words,o=t.words,l=i.words,d=0,h=0|s[0],c=8191&h,u=h>>>13,f=0|s[1],m=8191&f,p=f>>>13,g=0|s[2],_=8191&g,v=g>>>13,y=0|s[3],b=8191&y,S=y>>>13,T=0|s[4],w=8191&T,M=T>>>13,C=0|s[5],I=8191&C,P=C>>>13,E=0|s[6],x=8191&E,A=E>>>13,k=0|s[7],R=8191&k,O=k>>>13,L=0|s[8],F=8191&L,D=L>>>13,B=0|s[9],N=8191&B,V=B>>>13,U=0|o[0],W=8191&U,z=U>>>13,G=0|o[1],j=8191&G,H=G>>>13,q=0|o[2],$=8191&q,Z=q>>>13,X=0|o[3],Y=8191&X,J=X>>>13,K=0|o[4],Q=8191&K,ee=K>>>13,te=0|o[5],ie=8191&te,re=te>>>13,ne=0|o[6],ae=8191&ne,se=ne>>>13,oe=0|o[7],le=8191&oe,de=oe>>>13,he=0|o[8],ce=8191&he,ue=he>>>13,fe=0|o[9],me=8191&fe,pe=fe>>>13;i.negative=e.negative^t.negative,i.length=19;var ge=(d+(r=Math.imul(c,W))|0)+((8191&(n=(n=Math.imul(c,z))+Math.imul(u,W)|0))<<13)|0;d=((a=Math.imul(u,z))+(n>>>13)|0)+(ge>>>26)|0,ge&=67108863,r=Math.imul(m,W),n=(n=Math.imul(m,z))+Math.imul(p,W)|0,a=Math.imul(p,z);var _e=(d+(r=r+Math.imul(c,j)|0)|0)+((8191&(n=(n=n+Math.imul(c,H)|0)+Math.imul(u,j)|0))<<13)|0;d=((a=a+Math.imul(u,H)|0)+(n>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(_,W),n=(n=Math.imul(_,z))+Math.imul(v,W)|0,a=Math.imul(v,z),r=r+Math.imul(m,j)|0,n=(n=n+Math.imul(m,H)|0)+Math.imul(p,j)|0,a=a+Math.imul(p,H)|0;var ve=(d+(r=r+Math.imul(c,$)|0)|0)+((8191&(n=(n=n+Math.imul(c,Z)|0)+Math.imul(u,$)|0))<<13)|0;d=((a=a+Math.imul(u,Z)|0)+(n>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(b,W),n=(n=Math.imul(b,z))+Math.imul(S,W)|0,a=Math.imul(S,z),r=r+Math.imul(_,j)|0,n=(n=n+Math.imul(_,H)|0)+Math.imul(v,j)|0,a=a+Math.imul(v,H)|0,r=r+Math.imul(m,$)|0,n=(n=n+Math.imul(m,Z)|0)+Math.imul(p,$)|0,a=a+Math.imul(p,Z)|0;var ye=(d+(r=r+Math.imul(c,Y)|0)|0)+((8191&(n=(n=n+Math.imul(c,J)|0)+Math.imul(u,Y)|0))<<13)|0;d=((a=a+Math.imul(u,J)|0)+(n>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(w,W),n=(n=Math.imul(w,z))+Math.imul(M,W)|0,a=Math.imul(M,z),r=r+Math.imul(b,j)|0,n=(n=n+Math.imul(b,H)|0)+Math.imul(S,j)|0,a=a+Math.imul(S,H)|0,r=r+Math.imul(_,$)|0,n=(n=n+Math.imul(_,Z)|0)+Math.imul(v,$)|0,a=a+Math.imul(v,Z)|0,r=r+Math.imul(m,Y)|0,n=(n=n+Math.imul(m,J)|0)+Math.imul(p,Y)|0,a=a+Math.imul(p,J)|0;var be=(d+(r=r+Math.imul(c,Q)|0)|0)+((8191&(n=(n=n+Math.imul(c,ee)|0)+Math.imul(u,Q)|0))<<13)|0;d=((a=a+Math.imul(u,ee)|0)+(n>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(I,W),n=(n=Math.imul(I,z))+Math.imul(P,W)|0,a=Math.imul(P,z),r=r+Math.imul(w,j)|0,n=(n=n+Math.imul(w,H)|0)+Math.imul(M,j)|0,a=a+Math.imul(M,H)|0,r=r+Math.imul(b,$)|0,n=(n=n+Math.imul(b,Z)|0)+Math.imul(S,$)|0,a=a+Math.imul(S,Z)|0,r=r+Math.imul(_,Y)|0,n=(n=n+Math.imul(_,J)|0)+Math.imul(v,Y)|0,a=a+Math.imul(v,J)|0,r=r+Math.imul(m,Q)|0,n=(n=n+Math.imul(m,ee)|0)+Math.imul(p,Q)|0,a=a+Math.imul(p,ee)|0;var Se=(d+(r=r+Math.imul(c,ie)|0)|0)+((8191&(n=(n=n+Math.imul(c,re)|0)+Math.imul(u,ie)|0))<<13)|0;d=((a=a+Math.imul(u,re)|0)+(n>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul(x,W),n=(n=Math.imul(x,z))+Math.imul(A,W)|0,a=Math.imul(A,z),r=r+Math.imul(I,j)|0,n=(n=n+Math.imul(I,H)|0)+Math.imul(P,j)|0,a=a+Math.imul(P,H)|0,r=r+Math.imul(w,$)|0,n=(n=n+Math.imul(w,Z)|0)+Math.imul(M,$)|0,a=a+Math.imul(M,Z)|0,r=r+Math.imul(b,Y)|0,n=(n=n+Math.imul(b,J)|0)+Math.imul(S,Y)|0,a=a+Math.imul(S,J)|0,r=r+Math.imul(_,Q)|0,n=(n=n+Math.imul(_,ee)|0)+Math.imul(v,Q)|0,a=a+Math.imul(v,ee)|0,r=r+Math.imul(m,ie)|0,n=(n=n+Math.imul(m,re)|0)+Math.imul(p,ie)|0,a=a+Math.imul(p,re)|0;var Te=(d+(r=r+Math.imul(c,ae)|0)|0)+((8191&(n=(n=n+Math.imul(c,se)|0)+Math.imul(u,ae)|0))<<13)|0;d=((a=a+Math.imul(u,se)|0)+(n>>>13)|0)+(Te>>>26)|0,Te&=67108863,r=Math.imul(R,W),n=(n=Math.imul(R,z))+Math.imul(O,W)|0,a=Math.imul(O,z),r=r+Math.imul(x,j)|0,n=(n=n+Math.imul(x,H)|0)+Math.imul(A,j)|0,a=a+Math.imul(A,H)|0,r=r+Math.imul(I,$)|0,n=(n=n+Math.imul(I,Z)|0)+Math.imul(P,$)|0,a=a+Math.imul(P,Z)|0,r=r+Math.imul(w,Y)|0,n=(n=n+Math.imul(w,J)|0)+Math.imul(M,Y)|0,a=a+Math.imul(M,J)|0,r=r+Math.imul(b,Q)|0,n=(n=n+Math.imul(b,ee)|0)+Math.imul(S,Q)|0,a=a+Math.imul(S,ee)|0,r=r+Math.imul(_,ie)|0,n=(n=n+Math.imul(_,re)|0)+Math.imul(v,ie)|0,a=a+Math.imul(v,re)|0,r=r+Math.imul(m,ae)|0,n=(n=n+Math.imul(m,se)|0)+Math.imul(p,ae)|0,a=a+Math.imul(p,se)|0;var we=(d+(r=r+Math.imul(c,le)|0)|0)+((8191&(n=(n=n+Math.imul(c,de)|0)+Math.imul(u,le)|0))<<13)|0;d=((a=a+Math.imul(u,de)|0)+(n>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(F,W),n=(n=Math.imul(F,z))+Math.imul(D,W)|0,a=Math.imul(D,z),r=r+Math.imul(R,j)|0,n=(n=n+Math.imul(R,H)|0)+Math.imul(O,j)|0,a=a+Math.imul(O,H)|0,r=r+Math.imul(x,$)|0,n=(n=n+Math.imul(x,Z)|0)+Math.imul(A,$)|0,a=a+Math.imul(A,Z)|0,r=r+Math.imul(I,Y)|0,n=(n=n+Math.imul(I,J)|0)+Math.imul(P,Y)|0,a=a+Math.imul(P,J)|0,r=r+Math.imul(w,Q)|0,n=(n=n+Math.imul(w,ee)|0)+Math.imul(M,Q)|0,a=a+Math.imul(M,ee)|0,r=r+Math.imul(b,ie)|0,n=(n=n+Math.imul(b,re)|0)+Math.imul(S,ie)|0,a=a+Math.imul(S,re)|0,r=r+Math.imul(_,ae)|0,n=(n=n+Math.imul(_,se)|0)+Math.imul(v,ae)|0,a=a+Math.imul(v,se)|0,r=r+Math.imul(m,le)|0,n=(n=n+Math.imul(m,de)|0)+Math.imul(p,le)|0,a=a+Math.imul(p,de)|0;var Me=(d+(r=r+Math.imul(c,ce)|0)|0)+((8191&(n=(n=n+Math.imul(c,ue)|0)+Math.imul(u,ce)|0))<<13)|0;d=((a=a+Math.imul(u,ue)|0)+(n>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul(N,W),n=(n=Math.imul(N,z))+Math.imul(V,W)|0,a=Math.imul(V,z),r=r+Math.imul(F,j)|0,n=(n=n+Math.imul(F,H)|0)+Math.imul(D,j)|0,a=a+Math.imul(D,H)|0,r=r+Math.imul(R,$)|0,n=(n=n+Math.imul(R,Z)|0)+Math.imul(O,$)|0,a=a+Math.imul(O,Z)|0,r=r+Math.imul(x,Y)|0,n=(n=n+Math.imul(x,J)|0)+Math.imul(A,Y)|0,a=a+Math.imul(A,J)|0,r=r+Math.imul(I,Q)|0,n=(n=n+Math.imul(I,ee)|0)+Math.imul(P,Q)|0,a=a+Math.imul(P,ee)|0,r=r+Math.imul(w,ie)|0,n=(n=n+Math.imul(w,re)|0)+Math.imul(M,ie)|0,a=a+Math.imul(M,re)|0,r=r+Math.imul(b,ae)|0,n=(n=n+Math.imul(b,se)|0)+Math.imul(S,ae)|0,a=a+Math.imul(S,se)|0,r=r+Math.imul(_,le)|0,n=(n=n+Math.imul(_,de)|0)+Math.imul(v,le)|0,a=a+Math.imul(v,de)|0,r=r+Math.imul(m,ce)|0,n=(n=n+Math.imul(m,ue)|0)+Math.imul(p,ce)|0,a=a+Math.imul(p,ue)|0;var Ce=(d+(r=r+Math.imul(c,me)|0)|0)+((8191&(n=(n=n+Math.imul(c,pe)|0)+Math.imul(u,me)|0))<<13)|0;d=((a=a+Math.imul(u,pe)|0)+(n>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,r=Math.imul(N,j),n=(n=Math.imul(N,H))+Math.imul(V,j)|0,a=Math.imul(V,H),r=r+Math.imul(F,$)|0,n=(n=n+Math.imul(F,Z)|0)+Math.imul(D,$)|0,a=a+Math.imul(D,Z)|0,r=r+Math.imul(R,Y)|0,n=(n=n+Math.imul(R,J)|0)+Math.imul(O,Y)|0,a=a+Math.imul(O,J)|0,r=r+Math.imul(x,Q)|0,n=(n=n+Math.imul(x,ee)|0)+Math.imul(A,Q)|0,a=a+Math.imul(A,ee)|0,r=r+Math.imul(I,ie)|0,n=(n=n+Math.imul(I,re)|0)+Math.imul(P,ie)|0,a=a+Math.imul(P,re)|0,r=r+Math.imul(w,ae)|0,n=(n=n+Math.imul(w,se)|0)+Math.imul(M,ae)|0,a=a+Math.imul(M,se)|0,r=r+Math.imul(b,le)|0,n=(n=n+Math.imul(b,de)|0)+Math.imul(S,le)|0,a=a+Math.imul(S,de)|0,r=r+Math.imul(_,ce)|0,n=(n=n+Math.imul(_,ue)|0)+Math.imul(v,ce)|0,a=a+Math.imul(v,ue)|0;var Ie=(d+(r=r+Math.imul(m,me)|0)|0)+((8191&(n=(n=n+Math.imul(m,pe)|0)+Math.imul(p,me)|0))<<13)|0;d=((a=a+Math.imul(p,pe)|0)+(n>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,r=Math.imul(N,$),n=(n=Math.imul(N,Z))+Math.imul(V,$)|0,a=Math.imul(V,Z),r=r+Math.imul(F,Y)|0,n=(n=n+Math.imul(F,J)|0)+Math.imul(D,Y)|0,a=a+Math.imul(D,J)|0,r=r+Math.imul(R,Q)|0,n=(n=n+Math.imul(R,ee)|0)+Math.imul(O,Q)|0,a=a+Math.imul(O,ee)|0,r=r+Math.imul(x,ie)|0,n=(n=n+Math.imul(x,re)|0)+Math.imul(A,ie)|0,a=a+Math.imul(A,re)|0,r=r+Math.imul(I,ae)|0,n=(n=n+Math.imul(I,se)|0)+Math.imul(P,ae)|0,a=a+Math.imul(P,se)|0,r=r+Math.imul(w,le)|0,n=(n=n+Math.imul(w,de)|0)+Math.imul(M,le)|0,a=a+Math.imul(M,de)|0,r=r+Math.imul(b,ce)|0,n=(n=n+Math.imul(b,ue)|0)+Math.imul(S,ce)|0,a=a+Math.imul(S,ue)|0;var Pe=(d+(r=r+Math.imul(_,me)|0)|0)+((8191&(n=(n=n+Math.imul(_,pe)|0)+Math.imul(v,me)|0))<<13)|0;d=((a=a+Math.imul(v,pe)|0)+(n>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,r=Math.imul(N,Y),n=(n=Math.imul(N,J))+Math.imul(V,Y)|0,a=Math.imul(V,J),r=r+Math.imul(F,Q)|0,n=(n=n+Math.imul(F,ee)|0)+Math.imul(D,Q)|0,a=a+Math.imul(D,ee)|0,r=r+Math.imul(R,ie)|0,n=(n=n+Math.imul(R,re)|0)+Math.imul(O,ie)|0,a=a+Math.imul(O,re)|0,r=r+Math.imul(x,ae)|0,n=(n=n+Math.imul(x,se)|0)+Math.imul(A,ae)|0,a=a+Math.imul(A,se)|0,r=r+Math.imul(I,le)|0,n=(n=n+Math.imul(I,de)|0)+Math.imul(P,le)|0,a=a+Math.imul(P,de)|0,r=r+Math.imul(w,ce)|0,n=(n=n+Math.imul(w,ue)|0)+Math.imul(M,ce)|0,a=a+Math.imul(M,ue)|0;var Ee=(d+(r=r+Math.imul(b,me)|0)|0)+((8191&(n=(n=n+Math.imul(b,pe)|0)+Math.imul(S,me)|0))<<13)|0;d=((a=a+Math.imul(S,pe)|0)+(n>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(N,Q),n=(n=Math.imul(N,ee))+Math.imul(V,Q)|0,a=Math.imul(V,ee),r=r+Math.imul(F,ie)|0,n=(n=n+Math.imul(F,re)|0)+Math.imul(D,ie)|0,a=a+Math.imul(D,re)|0,r=r+Math.imul(R,ae)|0,n=(n=n+Math.imul(R,se)|0)+Math.imul(O,ae)|0,a=a+Math.imul(O,se)|0,r=r+Math.imul(x,le)|0,n=(n=n+Math.imul(x,de)|0)+Math.imul(A,le)|0,a=a+Math.imul(A,de)|0,r=r+Math.imul(I,ce)|0,n=(n=n+Math.imul(I,ue)|0)+Math.imul(P,ce)|0,a=a+Math.imul(P,ue)|0;var xe=(d+(r=r+Math.imul(w,me)|0)|0)+((8191&(n=(n=n+Math.imul(w,pe)|0)+Math.imul(M,me)|0))<<13)|0;d=((a=a+Math.imul(M,pe)|0)+(n>>>13)|0)+(xe>>>26)|0,xe&=67108863,r=Math.imul(N,ie),n=(n=Math.imul(N,re))+Math.imul(V,ie)|0,a=Math.imul(V,re),r=r+Math.imul(F,ae)|0,n=(n=n+Math.imul(F,se)|0)+Math.imul(D,ae)|0,a=a+Math.imul(D,se)|0,r=r+Math.imul(R,le)|0,n=(n=n+Math.imul(R,de)|0)+Math.imul(O,le)|0,a=a+Math.imul(O,de)|0,r=r+Math.imul(x,ce)|0,n=(n=n+Math.imul(x,ue)|0)+Math.imul(A,ce)|0,a=a+Math.imul(A,ue)|0;var Ae=(d+(r=r+Math.imul(I,me)|0)|0)+((8191&(n=(n=n+Math.imul(I,pe)|0)+Math.imul(P,me)|0))<<13)|0;d=((a=a+Math.imul(P,pe)|0)+(n>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,r=Math.imul(N,ae),n=(n=Math.imul(N,se))+Math.imul(V,ae)|0,a=Math.imul(V,se),r=r+Math.imul(F,le)|0,n=(n=n+Math.imul(F,de)|0)+Math.imul(D,le)|0,a=a+Math.imul(D,de)|0,r=r+Math.imul(R,ce)|0,n=(n=n+Math.imul(R,ue)|0)+Math.imul(O,ce)|0,a=a+Math.imul(O,ue)|0;var ke=(d+(r=r+Math.imul(x,me)|0)|0)+((8191&(n=(n=n+Math.imul(x,pe)|0)+Math.imul(A,me)|0))<<13)|0;d=((a=a+Math.imul(A,pe)|0)+(n>>>13)|0)+(ke>>>26)|0,ke&=67108863,r=Math.imul(N,le),n=(n=Math.imul(N,de))+Math.imul(V,le)|0,a=Math.imul(V,de),r=r+Math.imul(F,ce)|0,n=(n=n+Math.imul(F,ue)|0)+Math.imul(D,ce)|0,a=a+Math.imul(D,ue)|0;var Re=(d+(r=r+Math.imul(R,me)|0)|0)+((8191&(n=(n=n+Math.imul(R,pe)|0)+Math.imul(O,me)|0))<<13)|0;d=((a=a+Math.imul(O,pe)|0)+(n>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul(N,ce),n=(n=Math.imul(N,ue))+Math.imul(V,ce)|0,a=Math.imul(V,ue);var Oe=(d+(r=r+Math.imul(F,me)|0)|0)+((8191&(n=(n=n+Math.imul(F,pe)|0)+Math.imul(D,me)|0))<<13)|0;d=((a=a+Math.imul(D,pe)|0)+(n>>>13)|0)+(Oe>>>26)|0,Oe&=67108863;var Le=(d+(r=Math.imul(N,me))|0)+((8191&(n=(n=Math.imul(N,pe))+Math.imul(V,me)|0))<<13)|0;return d=((a=Math.imul(V,pe))+(n>>>13)|0)+(Le>>>26)|0,Le&=67108863,l[0]=ge,l[1]=_e,l[2]=ve,l[3]=ye,l[4]=be,l[5]=Se,l[6]=Te,l[7]=we,l[8]=Me,l[9]=Ce,l[10]=Ie,l[11]=Pe,l[12]=Ee,l[13]=xe,l[14]=Ae,l[15]=ke,l[16]=Re,l[17]=Oe,l[18]=Le,0!==d&&(l[19]=d,i.length++),i};function m(e,t,i){return(new p).mulp(e,t,i)}function p(e,t){this.x=e,this.y=t}Math.imul||(f=u),a.prototype.mulTo=function(e,t){var i=this.length+e.length;return 10===this.length&&10===e.length?f(this,e,t):i<63?u(this,e,t):i<1024?function(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var r=0,n=0,a=0;a<i.length-1;a++){var s=n;n=0;for(var o=67108863&r,l=Math.min(a,t.length-1),d=Math.max(0,a-e.length+1);d<=l;d++){var h=a-d,c=(0|e.words[h])*(0|t.words[d]),u=67108863&c;o=67108863&(u=u+o|0),n+=(s=(s=s+(c/67108864|0)|0)+(u>>>26)|0)>>>26,s&=67108863}i.words[a]=o,r=s,s=n}return 0!==r?i.words[a]=r:i.length--,i.strip()}(this,e,t):m(this,e,t)},p.prototype.makeRBT=function(e){for(var t=new Array(e),i=a.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,i,e);return t},p.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var r=0,n=0;n<t;n++)r|=(1&e)<<t-n-1,e>>=1;return r},p.prototype.permute=function(e,t,i,r,n,a){for(var s=0;s<a;s++)r[s]=t[e[s]],n[s]=i[e[s]]},p.prototype.transform=function(e,t,i,r,n,a){this.permute(a,e,t,i,r,n);for(var s=1;s<n;s<<=1)for(var o=s<<1,l=Math.cos(2*Math.PI/o),d=Math.sin(2*Math.PI/o),h=0;h<n;h+=o)for(var c=l,u=d,f=0;f<s;f++){var m=i[h+f],p=r[h+f],g=i[h+f+s],_=r[h+f+s],v=c*g-u*_;_=c*_+u*g,g=v,i[h+f]=m+g,r[h+f]=p+_,i[h+f+s]=m-g,r[h+f+s]=p-_,f!==o&&(v=l*c-d*u,u=l*u+d*c,c=v)}},p.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),r=1&i,n=0;for(i=i/2|0;i;i>>>=1)n++;return 1<<n+1+r},p.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var r=0;r<i/2;r++){var n=e[r];e[r]=e[i-r-1],e[i-r-1]=n,n=t[r],t[r]=-t[i-r-1],t[i-r-1]=-n}},p.prototype.normalize13b=function(e,t){for(var i=0,r=0;r<t/2;r++){var n=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+i;e[r]=67108863&n,i=n<67108864?0:n/67108864|0}return e},p.prototype.convert13b=function(e,t,i,n){for(var a=0,s=0;s<t;s++)a+=0|e[s],i[2*s]=8191&a,a>>>=13,i[2*s+1]=8191&a,a>>>=13;for(s=2*t;s<n;++s)i[s]=0;r(0===a),r(0==(-8192&a))},p.prototype.stub=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0;return t},p.prototype.mulp=function(e,t,i){var r=2*this.guessLen13b(e.length,t.length),n=this.makeRBT(r),a=this.stub(r),s=new Array(r),o=new Array(r),l=new Array(r),d=new Array(r),h=new Array(r),c=new Array(r),u=i.words;u.length=r,this.convert13b(e.words,e.length,s,r),this.convert13b(t.words,t.length,d,r),this.transform(s,a,o,l,r,n),this.transform(d,a,h,c,r,n);for(var f=0;f<r;f++){var m=o[f]*h[f]-l[f]*c[f];l[f]=o[f]*c[f]+l[f]*h[f],o[f]=m}return this.conjugate(o,l,r),this.transform(o,l,u,a,r,n),this.conjugate(u,a,r),this.normalize13b(u,r),i.negative=e.negative^t.negative,i.length=e.length+t.length,i.strip()},a.prototype.mul=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},a.prototype.mulf=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),m(this,e,t)},a.prototype.imul=function(e){return this.clone().mulTo(e,this)},a.prototype.imuln=function(e){r("number"==typeof e),r(e<67108864);for(var t=0,i=0;i<this.length;i++){var n=(0|this.words[i])*e,a=(67108863&n)+(67108863&t);t>>=26,t+=n/67108864|0,t+=a>>>26,this.words[i]=67108863&a}return 0!==t&&(this.words[i]=t,this.length++),this},a.prototype.muln=function(e){return this.clone().imuln(e)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),i=0;i<t.length;i++){var r=i/26|0,n=i%26;t[i]=(e.words[r]&1<<n)>>>n}return t}(e);if(0===t.length)return new a(1);for(var i=this,r=0;r<t.length&&0===t[r];r++,i=i.sqr());if(++r<t.length)for(var n=i.sqr();r<t.length;r++,n=n.sqr())0!==t[r]&&(i=i.mul(n));return i},a.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,i=e%26,n=(e-i)/26,a=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(t=0;t<this.length;t++){var o=this.words[t]&a,l=(0|this.words[t])-o<<i;this.words[t]=l|s,s=o>>>26-i}s&&(this.words[t]=s,this.length++)}if(0!==n){for(t=this.length-1;t>=0;t--)this.words[t+n]=this.words[t];for(t=0;t<n;t++)this.words[t]=0;this.length+=n}return this.strip()},a.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},a.prototype.iushrn=function(e,t,i){var n;r("number"==typeof e&&e>=0),n=t?(t-t%26)/26:0;var a=e%26,s=Math.min((e-a)/26,this.length),o=67108863^67108863>>>a<<a,l=i;if(n-=s,n=Math.max(0,n),l){for(var d=0;d<s;d++)l.words[d]=this.words[d];l.length=s}if(0===s);else if(this.length>s)for(this.length-=s,d=0;d<this.length;d++)this.words[d]=this.words[d+s];else this.words[0]=0,this.length=1;var h=0;for(d=this.length-1;d>=0&&(0!==h||d>=n);d--){var c=0|this.words[d];this.words[d]=h<<26-a|c>>>a,h=c&o}return l&&0!==h&&(l.words[l.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(e,t,i){return r(0===this.negative),this.iushrn(e,t,i)},a.prototype.shln=function(e){return this.clone().ishln(e)},a.prototype.ushln=function(e){return this.clone().iushln(e)},a.prototype.shrn=function(e){return this.clone().ishrn(e)},a.prototype.ushrn=function(e){return this.clone().iushrn(e)},a.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26,n=1<<t;return!(this.length<=i||!(this.words[i]&n))},a.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==t&&i++,this.length=Math.min(i,this.length),0!==t){var n=67108863^67108863>>>t<<t;this.words[this.length-1]&=n}return this.strip()},a.prototype.maskn=function(e){return this.clone().imaskn(e)},a.prototype.iaddn=function(e){return r("number"==typeof e),r(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},a.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},a.prototype.isubn=function(e){if(r("number"==typeof e),r(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},a.prototype.addn=function(e){return this.clone().iaddn(e)},a.prototype.subn=function(e){return this.clone().isubn(e)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(e,t,i){var n,a,s=e.length+i;this._expand(s);var o=0;for(n=0;n<e.length;n++){a=(0|this.words[n+i])+o;var l=(0|e.words[n])*t;o=((a-=67108863&l)>>26)-(l/67108864|0),this.words[n+i]=67108863&a}for(;n<this.length-i;n++)o=(a=(0|this.words[n+i])+o)>>26,this.words[n+i]=67108863&a;if(0===o)return this.strip();for(r(-1===o),o=0,n=0;n<this.length;n++)o=(a=-(0|this.words[n])+o)>>26,this.words[n]=67108863&a;return this.negative=1,this.strip()},a.prototype._wordDiv=function(e,t){var i=(this.length,e.length),r=this.clone(),n=e,s=0|n.words[n.length-1];0!=(i=26-this._countBits(s))&&(n=n.ushln(i),r.iushln(i),s=0|n.words[n.length-1]);var o,l=r.length-n.length;if("mod"!==t){(o=new a(null)).length=l+1,o.words=new Array(o.length);for(var d=0;d<o.length;d++)o.words[d]=0}var h=r.clone()._ishlnsubmul(n,1,l);0===h.negative&&(r=h,o&&(o.words[l]=1));for(var c=l-1;c>=0;c--){var u=67108864*(0|r.words[n.length+c])+(0|r.words[n.length+c-1]);for(u=Math.min(u/s|0,67108863),r._ishlnsubmul(n,u,c);0!==r.negative;)u--,r.negative=0,r._ishlnsubmul(n,1,c),r.isZero()||(r.negative^=1);o&&(o.words[c]=u)}return o&&o.strip(),r.strip(),"div"!==t&&0!==i&&r.iushrn(i),{div:o||null,mod:r}},a.prototype.divmod=function(e,t,i){return r(!e.isZero()),this.isZero()?{div:new a(0),mod:new a(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(n=o.div.neg()),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.iadd(e)),{div:n,mod:s}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(n=o.div.neg()),{div:n,mod:o.mod}):0!=(this.negative&e.negative)?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.isub(e)),{div:o.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new a(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new a(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new a(this.modn(e.words[0]))}:this._wordDiv(e,t);var n,s,o},a.prototype.div=function(e){return this.divmod(e,"div",!1).div},a.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},a.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},a.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),n=e.andln(1),a=i.cmp(r);return a<0||1===n&&0===a?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},a.prototype.modn=function(e){r(e<=67108863);for(var t=(1<<26)%e,i=0,n=this.length-1;n>=0;n--)i=(t*i+(0|this.words[n]))%e;return i},a.prototype.idivn=function(e){r(e<=67108863);for(var t=0,i=this.length-1;i>=0;i--){var n=(0|this.words[i])+67108864*t;this.words[i]=n/e|0,t=n%e}return this.strip()},a.prototype.divn=function(e){return this.clone().idivn(e)},a.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n=new a(1),s=new a(0),o=new a(0),l=new a(1),d=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++d;for(var h=i.clone(),c=t.clone();!t.isZero();){for(var u=0,f=1;0==(t.words[0]&f)&&u<26;++u,f<<=1);if(u>0)for(t.iushrn(u);u-- >0;)(n.isOdd()||s.isOdd())&&(n.iadd(h),s.isub(c)),n.iushrn(1),s.iushrn(1);for(var m=0,p=1;0==(i.words[0]&p)&&m<26;++m,p<<=1);if(m>0)for(i.iushrn(m);m-- >0;)(o.isOdd()||l.isOdd())&&(o.iadd(h),l.isub(c)),o.iushrn(1),l.iushrn(1);t.cmp(i)>=0?(t.isub(i),n.isub(o),s.isub(l)):(i.isub(t),o.isub(n),l.isub(s))}return{a:o,b:l,gcd:i.iushln(d)}},a.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n,s=new a(1),o=new a(0),l=i.clone();t.cmpn(1)>0&&i.cmpn(1)>0;){for(var d=0,h=1;0==(t.words[0]&h)&&d<26;++d,h<<=1);if(d>0)for(t.iushrn(d);d-- >0;)s.isOdd()&&s.iadd(l),s.iushrn(1);for(var c=0,u=1;0==(i.words[0]&u)&&c<26;++c,u<<=1);if(c>0)for(i.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(l),o.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(o)):(i.isub(t),o.isub(s))}return(n=0===t.cmpn(1)?s:o).cmpn(0)<0&&n.iadd(e),n},a.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var r=0;t.isEven()&&i.isEven();r++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var n=t.cmp(i);if(n<0){var a=t;t=i,i=a}else if(0===n||0===i.cmpn(1))break;t.isub(i)}return i.iushln(r)},a.prototype.invm=function(e){return this.egcd(e).a.umod(e)},a.prototype.isEven=function(){return 0==(1&this.words[0])},a.prototype.isOdd=function(){return 1==(1&this.words[0])},a.prototype.andln=function(e){return this.words[0]&e},a.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,i=(e-t)/26,n=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=n,this;for(var a=n,s=i;0!==a&&s<this.length;s++){var o=0|this.words[s];a=(o+=a)>>>26,o&=67108863,this.words[s]=o}return 0!==a&&(this.words[s]=a,this.length++),this},a.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},a.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)t=1;else{i&&(e=-e),r(e<=67108863,"Number is too big");var n=0|this.words[0];t=n===e?0:n<e?-1:1}return 0!==this.negative?0|-t:t},a.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},a.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,i=this.length-1;i>=0;i--){var r=0|this.words[i],n=0|e.words[i];if(r!==n){r<n?t=-1:r>n&&(t=1);break}}return t},a.prototype.gtn=function(e){return 1===this.cmpn(e)},a.prototype.gt=function(e){return 1===this.cmp(e)},a.prototype.gten=function(e){return this.cmpn(e)>=0},a.prototype.gte=function(e){return this.cmp(e)>=0},a.prototype.ltn=function(e){return-1===this.cmpn(e)},a.prototype.lt=function(e){return-1===this.cmp(e)},a.prototype.lten=function(e){return this.cmpn(e)<=0},a.prototype.lte=function(e){return this.cmp(e)<=0},a.prototype.eqn=function(e){return 0===this.cmpn(e)},a.prototype.eq=function(e){return 0===this.cmp(e)},a.red=function(e){return new T(e)},a.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},a.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(e){return this.red=e,this},a.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},a.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},a.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},a.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},a.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},a.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},a.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},a.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},a.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function _(e,t){this.name=e,this.p=new a(t,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function y(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function b(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function S(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function T(e){if("string"==typeof e){var t=a._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function w(e){T.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var e=new a(null);return e.words=new Array(Math.ceil(this.n/13)),e},_.prototype.ireduce=function(e){var t,i=e;do{this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(t>this.n);var r=t<this.n?-1:i.ucmp(this.p);return 0===r?(i.words[0]=0,i.length=1):r>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},_.prototype.split=function(e,t){e.iushrn(this.n,0,t)},_.prototype.imulK=function(e){return e.imul(this.k)},n(v,_),v.prototype.split=function(e,t){for(var i=Math.min(e.length,9),r=0;r<i;r++)t.words[r]=e.words[r];if(t.length=i,e.length<=9)return e.words[0]=0,void(e.length=1);var n=e.words[9];for(t.words[t.length++]=4194303&n,r=10;r<e.length;r++){var a=0|e.words[r];e.words[r-10]=(4194303&a)<<4|n>>>22,n=a}n>>>=22,e.words[r-10]=n,0===n&&e.length>10?e.length-=10:e.length-=9},v.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var r=0|e.words[i];t+=977*r,e.words[i]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},n(y,_),n(b,_),n(S,_),S.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var r=19*(0|e.words[i])+t,n=67108863&r;r>>>=26,e.words[i]=n,t=r}return 0!==t&&(e.words[e.length++]=t),e},a._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new v;else if("p224"===e)t=new y;else if("p192"===e)t=new b;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new S}return g[e]=t,t},T.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},T.prototype._verify2=function(e,t){r(0==(e.negative|t.negative),"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},T.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},T.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},T.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},T.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},T.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},T.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i},T.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},T.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},T.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},T.prototype.isqr=function(e){return this.imul(e,e.clone())},T.prototype.sqr=function(e){return this.mul(e,e)},T.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var i=this.m.add(new a(1)).iushrn(2);return this.pow(e,i)}for(var n=this.m.subn(1),s=0;!n.isZero()&&0===n.andln(1);)s++,n.iushrn(1);r(!n.isZero());var o=new a(1).toRed(this),l=o.redNeg(),d=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new a(2*h*h).toRed(this);0!==this.pow(h,d).cmp(l);)h.redIAdd(l);for(var c=this.pow(h,n),u=this.pow(e,n.addn(1).iushrn(1)),f=this.pow(e,n),m=s;0!==f.cmp(o);){for(var p=f,g=0;0!==p.cmp(o);g++)p=p.redSqr();r(g<m);var _=this.pow(c,new a(1).iushln(m-g-1));u=u.redMul(_),c=_.redSqr(),f=f.redMul(c),m=g}return u},T.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},T.prototype.pow=function(e,t){if(t.isZero())return new a(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=new Array(16);i[0]=new a(1).toRed(this),i[1]=e;for(var r=2;r<i.length;r++)i[r]=this.mul(i[r-1],e);var n=i[0],s=0,o=0,l=t.bitLength()%26;for(0===l&&(l=26),r=t.length-1;r>=0;r--){for(var d=t.words[r],h=l-1;h>=0;h--){var c=d>>h&1;n!==i[0]&&(n=this.sqr(n)),0!==c||0!==s?(s<<=1,s|=c,(4==++o||0===r&&0===h)&&(n=this.mul(n,i[s]),o=0,s=0)):o=0}l=26}return n},T.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},T.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},a.mont=function(e){return new w(e)},n(w,T),w.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},w.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},w.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),a=n;return n.cmp(this.m)>=0?a=n.isub(this.m):n.cmpn(0)<0&&(a=n.iadd(this.m)),a._forceRed(this)},w.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new a(0)._forceRed(this);var i=e.mul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},w.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,i(83)(e))},function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var i,r,n,a,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&a[0]?r.return:a[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,a[1])).done)return n;switch(r=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){s.label=a[1];break}if(6===a[0]&&s.label<n[1]){s.label=n[1],n=a;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(a);break}n[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{i=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(12),s=i(72),o=i(234),l=i(32),d=i(163),h=i(162),c=i(235),u=function(){function e(e){this.transPropertyFactory=new o.TransitionPropertyFactory(e.customTransitionDataLoader),this.transitionDisabledList=e.transitionDisabledList||""}return e.prototype.isTransitionDisabled=function(e,t){return l.isTransitionDisabled(this.transitionDisabledList,e,t)},e.prototype.getTransition=function(e,t,i,o){return void 0===o&&(o=new h.MemoryReport),r(this,void 0,void 0,(function(){var r,h,u,f;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,26,,27]),l.isTransitionDisabled(this.transitionDisabledList,e,t)?(a.VetoUtils.recordVeto("TransitionFallback",{EffectId:e,qosVeto:"TransitionFallback",isIntentional:!0}),[4,this.getTransition(s.kTransitionIds.PPT_TRANSITION_FADE,t,i,o)]):[3,2];case 1:return[2,{transition:n.sent().transition,isSupported:!1}];case 2:switch(r=void 0,h=!0,e){case s.kTransitionIds.PPT_TRANSITION_WIPE:case s.kTransitionIds.PPT_TRANSITION_STRIPS:case s.kTransitionIds.PPT_TRANSITION_SPLIT:case s.kTransitionIds.PPT_TRANSITION_ZOOM:case s.kTransitionIds.PPT_TRANSITION_DIAMOND:case s.kTransitionIds.PPT_TRANSITION_PLUS:case s.kTransitionIds.PPT_TRANSITION_CIRCLE:case s.kTransitionIds.PPT_TRANSITION_RANDOMBAR:case s.kTransitionIds.PPT_TRANSITION_FADE:case s.kTransitionIds.PPT_TRANSITION_DISSOLVE:case s.kTransitionIds.PPT_TRANSITION_WHEEL:case s.kTransitionIds.PPT_TRANSITION_WHEELREVERSE:case s.kTransitionIds.PPT_TRANSITION_WEDGE:return[3,3];case s.kTransitionIds.PPT_TRANSITION_FADE_THROUGH_BLACK:return[3,4];case s.kTransitionIds.PPT_TRANSITION_PUSH:case s.kTransitionIds.PPT_TRANSITION_PAN:return[3,5];case s.kTransitionIds.PPT_TRANSITION_COMB:return[3,6];case s.kTransitionIds.PPT_TRANSITION_CUT:return[3,7];case s.kTransitionIds.PPT_TRANSITION_RANDOM:return[3,8];case s.kTransitionIds.PPT_TRANSITION_COVER:return[3,10];case s.kTransitionIds.PPT_TRANSITION_UNCOVER:return[3,11];case s.kTransitionIds.PPT_TRANSITION_BLINDS:case s.kTransitionIds.PPT_TRANSITION_PRISM:return[3,12];case s.kTransitionIds.PPT_TRANSITION_RIPPLE:return[3,13];case s.kTransitionIds.PPT_TRANSITION_VORTEX:case s.kTransitionIds.PPT_TRANSITION_CHECKER:case s.kTransitionIds.PPT_TRANSITION_GLITTER:return[3,14];case s.kTransitionIds.PPT_TRANSITION_ZOOM_WITH_SPIN:return[3,15];case s.kTransitionIds.PPT_TRANSITION_FLIP:case s.kTransitionIds.PPT_TRANSITION_SWITCH:case s.kTransitionIds.PPT_TRANSITION_FALLOVER:case s.kTransitionIds.PPT_TRANSITION_DRAPE:case s.kTransitionIds.PPT_TRANSITION_CURTAINS:case s.kTransitionIds.PPT_TRANSITION_WIND:case s.kTransitionIds.PPT_TRANSITION_PRESTIGE:case s.kTransitionIds.PPT_TRANSITION_FRACTURE:case s.kTransitionIds.PPT_TRANSITION_CRUSH:case s.kTransitionIds.PPT_TRANSITION_PEELOFF:case s.kTransitionIds.PPT_TRANSITION_PAGECURLSINGLE:case s.kTransitionIds.PPT_TRANSITION_PAGECURLDOUBLE:case s.kTransitionIds.PPT_TRANSITION_AIRPLANE:case s.kTransitionIds.PPT_TRANSITION_ORIGAMI:return[3,16];case s.kTransitionIds.PPT_TRANSITION_GALLERY:case s.kTransitionIds.PPT_TRANSITION_CONVEYOR:return[3,17];case s.kTransitionIds.PPT_TRANSITION_CROSSZOOM:return[3,18];case s.kTransitionIds.PPT_TRANSITION_FLYTHROUGH_CONTENT:case s.kTransitionIds.PPT_TRANSITION_FLYTHROUGH:return[3,19];case s.kTransitionIds.PPT_TRANSITION_DOORS_CONTENT:case s.kTransitionIds.PPT_TRANSITION_DOORS:return[3,20]}return[3,21];case 3:return r=this.transactionConstructors.AlphaTransition(),[3,22];case 4:return r=this.transactionConstructors.FadeThroughBlackTransition(),[3,22];case 5:return r=this.transactionConstructors.PushTransition(),[3,22];case 6:return r=this.transactionConstructors.WeaveTransition(),[3,22];case 7:return r=this.transactionConstructors.CutTransition(),t!==s.kTransitionEffectOptions.Top&&(a.VetoUtils.recordVeto("TransitionFallback",{EffectId:e,qosVeto:"TransitionFallback",isIntentional:!0}),h=!1),[3,22];case 8:return[4,this.createRandomTransition(i)];case 9:return[2,n.sent()];case 10:case 11:return r=this.transactionConstructors.CoverTransition(),[3,22];case 12:return r=this.transactionConstructors.PrismTransition(),[3,22];case 13:return r=this.transactionConstructors.RippleTransition(),[3,22];case 14:return r=this.transactionConstructors.BlindsTransition(),[3,22];case 15:return r=this.transactionConstructors.ZoomWithSpinTransition(),[3,22];case 16:return r=this.transactionConstructors.CustomTransition(),[3,22];case 17:return r=this.transactionConstructors.GalleryTransition(),[3,22];case 18:return r=this.transactionConstructors.CrossZoomTransition(),[3,22];case 19:return r=this.transactionConstructors.FlyThroughTransition(),[3,22];case 20:return r=this.transactionConstructors.DoorsTransition(),[3,22];case 21:h=!1,r=this.transactionConstructors.AlphaTransition(),a.VetoUtils.recordVeto("TransitionFallback",{EffectId:e,qosVeto:"TransitionFallback",isIntentional:!0}),n.label=22;case 22:return[4,this.transPropertyFactory.getTransitionProperty(e,t,i)];case 23:return null!=(u=n.sent())?[3,25]:(a.VetoUtils.recordVeto("TransitionFallback",{EffectId:e,qosVeto:"TransitionFallback",isIntentional:!0}),[4,this.getTransition(s.kTransitionIds.PPT_TRANSITION_FADE,t,i)]);case 24:return[2,{transition:n.sent().transition,isSupported:!1}];case 25:return r.init(u,o),d.ULS.sendTraceTag(541857879,d.LogCategory.msoulscat_Wac_PptSession,d.TraceLevel.Info,"TransitionFactory::getTransition: Transition effectId:"+e+", isSupported:"+h),[2,{transition:new c.TransitionWrapper(r),isSupported:h}];case 26:return f=n.sent(),l.logError("Exception at getTransition : "+f),a.VetoUtils.recordVeto("TransitionFallback",{EffectId:e,qosVeto:"TransitionFallback",isIntentional:!1}),[3,27];case 27:return[2,{transition:void 0,isSupported:!1}]}}))}))},e.prototype.createRandomTransition=function(e,t){return r(this,void 0,void 0,(function(){var i;return n(this,(function(r){switch(r.label){case 0:return i=this.getRandomEffectData(),[4,this.getTransition(i.effectId,i.direction,e,t)];case 1:return[2,r.sent()]}}))}))},e.prototype.getRandomEffectData=function(){for(var e=[{effectId:s.kTransitionIds.PPT_TRANSITION_ZOOM,direction:2},{effectId:s.kTransitionIds.PPT_TRANSITION_WIPE,direction:4},{effectId:s.kTransitionIds.PPT_TRANSITION_STRIPS,direction:4},{effectId:s.kTransitionIds.PPT_TRANSITION_RANDOMBAR,direction:2},{effectId:s.kTransitionIds.PPT_TRANSITION_SPLIT,direction:4},{effectId:s.kTransitionIds.PPT_TRANSITION_FADE,direction:1},{effectId:s.kTransitionIds.PPT_TRANSITION_CUT,direction:3},{effectId:s.kTransitionIds.PPT_TRANSITION_DISSOLVE,direction:1},{effectId:s.kTransitionIds.PPT_TRANSITION_COVER,direction:8},{effectId:s.kTransitionIds.PPT_TRANSITION_WHEEL,direction:4},{effectId:s.kTransitionIds.PPT_TRANSITION_CHECKER,direction:2}],t=0,i=0,r=e;i<r.length;i++)t+=r[i].direction;var n,a=Math.floor(Math.random()*t);for(n=0;a>=e[n].direction;n+=1)a-=e[n].direction;return{effectId:e[n].effectId,direction:a}},e}();t.BaseTransitionFactory=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MemoryReport=function(){this.textures={count:0},this.buffers={count:0},this.vaos={count:0}}},function(e,t,i){"use strict";i.r(t),i.d(t,"UlsLoggerWrapper",(function(){return s})),i.d(t,"ULS",(function(){return o})),i.d(t,"initializeLogger",(function(){return l})),i.d(t,"RemoteUlsLogger",(function(){return f})),i.d(t,"getUlsLogger",(function(){return m})),i.d(t,"getUlsLoggerDeprecated",(function(){return p})),i.d(t,"formatForUpload",(function(){return h})),i.d(t,"uploadLogs",(function(){return d})),i.d(t,"LogCategory",(function(){return c})),i.d(t,"LogType",(function(){return r})),i.d(t,"TraceLevel",(function(){return n})),i.d(t,"UnitTestLogger",(function(){return v})),i.d(t,"ConsoleLogger",(function(){return y}));var r,n,a=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e.prototype.setCorrelationId=function(){},e}(),s=function(){function e(){this.externalLogger=new a}return e.prototype.setCorrelationId=function(e){this.externalLogger.setCorrelationId(e)},e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,i,r){this.externalLogger.sendTraceTag(e,t,i,r)},e.prototype.debugAssertTag=function(e,t,i,r){this.externalLogger.debugAssertTag(e,t,i,r)},e.prototype.shipAssertTag=function(e,t,i,r){this.externalLogger.shipAssertTag(e,t,i,r)},e}(),o=new s;function l(e){if(!e)throw new Error("The 'logger' argument is missing");o.setLogger(e)}function d(e,t,i){if(t){var r=window.navigator;if(r&&r.sendBeacon)try{return void r.sendBeacon(t,e)}catch(e){}!function(e,t,i){var r=new XMLHttpRequest;r.readyState!==XMLHttpRequest.UNSENT&&r.readyState!==XMLHttpRequest.DONE||(r.open("POST",t,i),r.send(e))}(e,t,i)}}function h(e,t,i,r){var n=[],a=e.map((function(e){return function(e,t,i){var r={};if(r.G=e.tag,r.T=e.timestamp-t,r.M=e.message,r.C=e.category,e.correlationId){var n=i.findIndex((function(t){return t===e.correlationId}));n<0&&(n=i.push(e.correlationId)-1),r.I=n}var a=1e3*e.type+e.level;return r.D=a,r}(e,r,n)})),s=function(e,t,i,r,n){var a={};return a.T=e,a.L=t,a.S=i,a.I=r,n&&n.length>0&&(a.W=n),a.V=1,a}(r,a,t,i,n);return JSON.stringify(s)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(r||(r={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(n||(n={}));var c,u=function(){function e(t,i){var r=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){r.triggerUpload(!1,!1)},this.flush=function(){r.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return r.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,i){window.clearTimeout(r.timeoutId),r.logCache.length>0&&(r.uploadId+=1,d(h(r.logCache,r.userSessionId,r.uploadId,r.timestampBase),r.remoteUrlEndpoint,i),r.logCache=[],r.timestampBase=Date.now()),t&&(r.timeoutId=window.setTimeout(r.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t,this.remoteUrlEndpoint=i+"?usid="+t,window.setTimeout((function(){return r.triggerUpload(!0,!0)}),0)}return e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===n.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]",e}(),f=function(){function e(e,t){this.correlationId="",this.cache=new u(e,t)}return e.prototype.setCorrelationId=function(e){this.correlationId=e},e.prototype.sendTraceTag=function(e,t,i,r){g(this.cache,e,t,i,r,this.correlationId)},e.prototype.debugAssertTag=function(e,t,i,r){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},e.prototype.shipAssertTag=function(e,t,i,r){i&&g(this.cache,e,t,n.Error,r,this.correlationId)},e.prototype.flush=function(){this.cache.flush()},e.prototype.flushOnClose=function(){this.cache.flushOnClose},e}();function m(e,t){return new f(e,t)}function p(e,t){var i=new u(e,t);return{sendTraceTag:function(e,t,r,n){return g(i,e,t,r,n,"")},shipAssertTag:function(e,t,r,a){r&&g(i,e,t,n.Error,a,"")},debugAssertTag:function(){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:i.flush,flushOnClose:i.flushOnClose,setCorrelationId:function(){}}}function g(e,t,i,a,s,o){if(!(a>n.Info)){var l={timestamp:Date.now(),category:i,tag:t,level:a,type:r.Trace,message:s,correlationId:o};e.handleTrace(l)}}!function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime"}(c||(c={}));var _=i(28),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(_.__extends)(t,e),t}(a),y=function(){function e(){this.correlationId=""}return e.tagIntToString=function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)},e.prototype.getLogMessage=function(t,i,r){var n="tag_".concat(e.tagIntToString(t)," [").concat(c[i],"] ").concat(r);return this.correlationId&&""!==this.correlationId&&(n+="\t\t".concat(this.correlationId)),n},e.prototype.sendTraceTag=function(e,t,i,r){var a=this.logMessage;switch(i){case n.Error:a=this.logError;break;case n.Warning:a=this.logWarning;break;case n.Info:a=this.logInfo;break;case n.Verbose:a=this.logVerbose;break;case n.Spam:default:a=this.logMessage}try{a(this.getLogMessage(e,t,r))}catch(e){var s="undefined"!=typeof navigator?navigator:void 0;if(s&&!/rv:11.0/i.test(s.userAgent))throw e}},e.prototype.shipAssertTag=function(e,t,i,r){console.assert(i,this.getLogMessage(e,t,r))},e.prototype.debugAssertTag=function(e,t,i,r){this.shipAssertTag(e,t,i,r)},e.prototype.setCorrelationId=function(e){this.correlationId=e},e.prototype.logMessage=function(e){"log"in console&&console.log(e)},e.prototype.logError=function(e){"error"in console&&console.error(e)},e.prototype.logWarning=function(e){"warn"in console&&console.warn(e)},e.prototype.logInfo=function(e){"info"in console&&console.info(e)},e.prototype.logVerbose=function(e){"debug"in console&&console.debug(e)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789",e}()},function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return h}));var r,n,a=i(4),s=i(2),o=i(3),l=i(114);!function(e){e.PPTSharingResumeSlideShow="PPTSharingResumeSlideShowObject",e.PPTLiveGlobalAppState="PPTLiveGlobalAppStateObject"}(r||(r={}));class d{constructor(e){this.m_logger=e}static getCurrentInstance(e){return this.m_localStorageHelper||(this.m_localStorageHelper=new d(e)),this.m_localStorageHelper}clearEntryFromLocalStorage(e){try{localStorage.getItem(e)&&localStorage.removeItem(e)}catch(e){this.m_logger.sendTraceTag(538023879,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"LocalStorageHelper:clearEntryFromLocalStorage - error while trying to clear previous call state: "+e)}}writeToLocalStorage(e,t){try{this.m_logger.sendTraceTag(538023880,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"LocalStorageHelper: Writing to localStorage for localStorageCaller: "+e),localStorage.setItem(e,JSON.stringify(t)),this.m_logger.sendTraceTag(538023881,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"LocalStorageHelper:Saved to local storage for : "+e)}catch(e){this.m_logger.sendTraceTag(538023882,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"LocalStorageHelper: Error when saving State: "+e)}}readFromLocalStorage(e){try{const t=localStorage.getItem(e);if(t)return t}catch(e){this.m_logger.sendTraceTag(538023883,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"LocalStorageHelper: Error when reading from local storage: "+e)}return""}}!function(e){e.PrivateViewingAddon="PrivateViewingAddon",e.GridView="GridView",e.SlideShowToolbar="SlideShowToolbar",e.SlideShowInkingToolbar="SlideShowInkingToolbar"}(n||(n={}));class h{constructor(e,t,i){this.m_logger=i,this.sanitizeAndHashUrl(t),this.m_sessionKey="sharing_"+e,this.m_localStorageHelper=d.getCurrentInstance(this.m_logger)}updateGlobalState(e,t){let i=this.fetchGlobalState();switch(a.a.sendTraceTag(537989189,s.a.msoulscat_Wac_PptLive,o.a.Error,"PPTLiveGlobalStateManager: update GlobalState for "+e),i&&i.SessionKey!==this.m_sessionKey&&(this.m_localStorageHelper.clearEntryFromLocalStorage(r.PPTLiveGlobalAppState),a.a.sendTraceTag(537989190,s.a.msoulscat_Wac_PptLive,o.a.Error,"PPTLiveGlobalStateManager: Current SessionKey is different from SessionKey in localStorage, clearing entry."),i=void 0),i||(i={SessionKey:this.m_sessionKey,LocalAppState:{}}),e){case n.PrivateViewingAddon:i.LocalAppState.role=t.role,i.LocalAppState.currentSlideLocation=t.currentSyncState,i.LocalAppState.currentAnimationState=t.currentAnimationState,i.LocalAppState.globalSyncState=t.globalSyncState,i.LocalAppState.globalAnimationState=t.globalAnimationState;break;default:a.a.sendTraceTag(537989191,s.a.msoulscat_Wac_PptLive,o.a.Error,`PPTLiveGlobalStateManager: ${e} not in in PPTLiveAppComponent list.`),i.LocalAppState.CallerNotDefined=t}this.m_localStorageHelper.writeToLocalStorage(r.PPTLiveGlobalAppState,i)}fetchGlobalState(){try{const e=JSON.parse(this.m_localStorageHelper.readFromLocalStorage(r.PPTLiveGlobalAppState));if(e&&e.LocalAppState)return e}catch(e){this.m_logger.sendTraceTag(537989192,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"PPTLiveGlobalStateManager: Error when reading from local storage: "+e)}}fetchGlobalStateForCurrentSharingSession(){const e=this.fetchGlobalState();if(e&&e.LocalAppState&&e.SessionKey===this.m_sessionKey)return e}sanitizeAndHashUrl(e){if(e){let t=e.split("tempauth=");if(t&&t.length>=1){let e=t[0];if(e)return this.calculateHash(e)}}return a.a.sendTraceTag(537989193,s.a.msoulscat_Wac_PptLive,o.a.Error,"PPTLiveGlobalStateManager: Failed to get document Url."),""}calculateHash(e){return e?""+(new l.sha256).update(e).digest("hex"):""}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var r=i(59),n=i(42),a=i(85),s=i(12),o=i(2),l=i(37),d=i(6),h=i(115),c=i(1),u=i(44),f=i(63);class m{constructor(e,t,i){this.m_isNetworkHealthSpotty=!1,this.m_isNetworkHealthy=!0,this.presInfoLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorFailedToLoadPresInfo"}};if(null==t.meta_clientWidth||null==t.meta_clientHeight)return this.m_logger.sendTraceTag(595178197,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"missing clientWidth or clientHeight"),i.metadata.errorName="ErrorMissingClientWidthOrHeight",i;const n={ClientWidth:t.meta_clientWidth,ClientHeight:t.meta_clientHeight,CorrelationId:t.meta_correlationId||"",FilterHiddenSlideInfo:t.meta_filterHiddenSlideInfo,RequestInfo:t.meta_requestInfo,PriorityHint:t.meta_priorityHint,IsBootRequest:t.meta_isInit,IncludeSections:t.meta_includeSections};let a={presInfo:void 0,responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",responseIsIntentional:!1,itemErrorCodeMap:void 0},d=0;for(;d<this.m_settings.retryCount&&(a=await this.m_podProxy.getItemsPresInfoAsync(n),d+=1,!a.presInfo)&&this.shouldRetry(a);){const i=t.meta_correlationId;t.meta_correlationId=Object(l.v4)(),n.CorrelationId=t.meta_correlationId,this.m_logger.sendTraceTag(577250645,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,`presInfoLoader: Generating new correlationId for retrying request - resourceId:${e}, old correlation:${i}, new correlation:${t.meta_correlationId}, attempts:${d},\n            responseErrorCode:${a.responseErrorCode.toString()}, errorCodeMap:${a.itemErrorCodeMap?JSON.stringify([...a.itemErrorCodeMap]):""}`)}return a.presInfo?(this.m_logger.sendTraceTag(579470407,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,`presInfoLoader: Got presInfo - resourceId:${e}, correlation:${t.meta_correlationId}, attempts:${d}`),i.resource=a.presInfo,i.metadata={created:new Date,lastAccessed:new Date,cached:a.usedOutputCache&&"true"===a.usedOutputCache.toString().toLowerCase().trim(),requestInfo:t.meta_requestInfo},a.metadata&&(i.metadata.getItemsResult=a.metadata),i):(i.metadata.errorName=this.getErrorFromResponse(a,{responseType:"presInfo",resourceId:e,cid:t.meta_correlationId,attempts:d},r.a.PresInfoMetaData),i)}},this.slideLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorFailedToLoadSlide"}};try{const r=JSON.parse(e).sid;if(!r)return this.m_logger.sendTraceTag(594587729,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"slideLoader: invalid resourceId "+e),i.metadata.errorName="ErrorMissingSlideId",i;let n;t.meta_correlationId||this.m_logger.sendTraceTag(591734944,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"missing correlation in slideLoader. resourceId:"+e);try{if(n=await this.slideInfo.load(JSON.stringify({sid:r,cid:0}),t),!n.resource)return this.m_logger.sendTraceTag(593498711,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"slideLoader: failed to load slideInfo."),i.metadata.errorName="ErrorFailedToLoadSlideInfo",n.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=n.metadata.errorName),n.metadata.hasOwnProperty("getItemsResult")&&n.metadata.getItemsResult&&(i.metadata.getItemsResult=n.metadata.getItemsResult),i}catch(e){return this.m_logger.sendTraceTag(593498712,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"slideLoader: failed to load slideInfo. Exception:"+Object(f.c)(e)),i.metadata.errorName="ErrorFailedToLoadSlideInfo",i}const l=await this.presInfo.load("",t);if(!l||!l.resource)return i.metadata.errorName="ErrorFailedToLoadPresInfo",l&&!l.resource&&l.metadata&&l.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=l.metadata.errorName),i;const d=new Map(this.imageData.getAllLoadResultsInCache().map(e=>[e.resourceId,e.resource]));let h;try{if(h=a.a.getDataFromSlideInfoAndImages(n.resource,l.resource.SlideOrder,d),!h)return i.metadata.errorName="ErrorFailedToParseSlideInfo",i}catch(e){return this.m_logger.sendTraceTag(509161995,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"slideLoader: failed to parse data from slideInfo. Exception:"+Object(f.c)(e)),i.metadata.errorName="ErrorFailedToParseSlideInfo",i}i.resource=h.slide,i.metadata={created:new Date,lastAccessed:new Date,cached:n.metadata.hasOwnProperty("cached")&&n.metadata.cached&&"true"===n.metadata.cached.toString().toLowerCase().trim()},n.metadata.hasOwnProperty("requestInfo")&&n.metadata.requestInfo&&(i.metadata.requestInfo=n.metadata.requestInfo),n.metadata.hasOwnProperty("getItemsResult")&&n.metadata.getItemsResult&&(i.metadata.getItemsResult=n.metadata.getItemsResult),n.metadata.hasOwnProperty("axErrorName")&&(i.metadata.axErrorName=n.metadata.axErrorName);for(let e=0;e<h.shapeViewDatas.length;e+=1){const r={resourceId:`${JSON.stringify(h.slideViewData.slideId)}_${JSON.stringify(h.shapeViewDatas[e].shapeId)}`,resource:h.shapeViewDatas[e],metadata:i.metadata,options:t};this.shapeViewData.add(r)}const c={resourceId:e,resource:h.slideViewData,metadata:i.metadata,options:t};return this.slideViewData.add(c),this.m_logger.sendTraceTag(593498713,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"slideLoader: slide loaded. sid:"+r),i}catch(e){return this.m_logger.sendTraceTag(509161994,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"slideLoader: failed to load slide. Exception:"+Object(f.c)(e)),i}}},this.slideViewDataLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorFailedToLoadSlideViewData"}},r=JSON.parse(e).sid;if(!r)return this.m_logger.sendTraceTag(594587730,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"slideViewDataLoader: invalid resourceId "+e),i.metadata.errorName="ErrorMissingSlideId",i;const n=await this.slideInfo.load(JSON.stringify({sid:r,cid:0}),t);if(!n.resource)return i.metadata.errorName="ErrorFailedToLoadSlideInfo",n.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=n.metadata.errorName),this.m_logger.sendTraceTag(591734945,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,`slideViewDataLoader: failed to load slideInfo. errorName:${i.metadata.errorName}, resourceId:${e}, correlation:${t.meta_correlationId}`),i;const l=await this.presInfo.load("",t);if(!l||!l.resource)return i.metadata.errorName="ErrorFailedToLoadPresInfo",l&&!l.resource&&l.metadata&&l.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=l.metadata.errorName),i;const d=new Map(this.imageData.getAllLoadResultsInCache().map(e=>[e.resourceId,e.resource])),h=a.a.getDataFromSlideInfoAndImages(n.resource,l.resource.SlideOrder,d);if(!h)return i.metadata.errorName="ErrorFailedToParseSlideInfo",i;i.resource=h.slideViewData,i.metadata={created:new Date,lastAccessed:new Date,cached:n.metadata.hasOwnProperty("cached")&&n.metadata.cached&&"true"===n.metadata.cached.toString().toLowerCase().trim()},n.metadata.hasOwnProperty("requestInfo")&&n.metadata.requestInfo&&(i.metadata.requestInfo=n.metadata.requestInfo),n.metadata.hasOwnProperty("getItemsResult")&&n.metadata.getItemsResult&&(i.metadata.getItemsResult=n.metadata.getItemsResult);for(let e=0;e<h.shapeViewDatas.length;e+=1){const r={resourceId:`${JSON.stringify(h.slideViewData.slideId)}_${JSON.stringify(h.shapeViewDatas[e].shapeId)}`,resource:h.shapeViewDatas[e],metadata:i.metadata,options:t};this.shapeViewData.add(r)}const c={resourceId:e,resource:h.slide,metadata:i.metadata,options:t};return this.slide.add(c),i}},this.shapeViewDataLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorFailedToLoadShapeViewData"}},r=e.split("_")[0],n=JSON.parse(r).sid;if(!n)return this.m_logger.sendTraceTag(594587731,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"shapeViewDataLoader: invalid slideIdString "+r),i.metadata.errorName="ErrorMissingSlideId",i;const l=await this.slideInfo.load(JSON.stringify({sid:n,cid:0}),t);if(!l||!l.resource)return i.metadata.errorName="ErrorFailedToLoadSlideInfo",l&&!l.resource&&l.metadata&&l.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=l.metadata.errorName),i;const d=await this.presInfo.load("",t);if(!d||!d.resource)return i.metadata.errorName="ErrorFailedToLoadPresInfo",d&&!d.resource&&d.metadata&&d.metadata.hasOwnProperty("errorName")&&(i.metadata.errorName=d.metadata.errorName),i;const h=new Map(this.imageData.getAllLoadResultsInCache().map(e=>[e.resourceId,e.resource])),c=a.a.getDataFromSlideInfoAndImages(l.resource,d.resource.SlideOrder,h);if(!c)return i.metadata.errorName="ErrorFailedToParseSlideInfo",i;i.resource=c.shapeViewDatas.filter(t=>JSON.stringify(t.shapeId)===e.split("_")[1])[0],i.metadata={created:new Date,lastAccessed:new Date,cached:l.metadata.hasOwnProperty("cached")&&l.metadata.cached&&"true"===l.metadata.cached.toString().toLowerCase().trim()},l.metadata.hasOwnProperty("requestInfo")&&l.metadata.requestInfo&&(i.metadata.requestInfo=l.metadata.requestInfo),l.metadata.hasOwnProperty("getItemsResult")&&l.metadata.getItemsResult&&(i.metadata.getItemsResult=l.metadata.getItemsResult);const u={resourceId:JSON.stringify(c.slide.id),resource:c.slide,metadata:i.metadata,options:t};this.slide.add(u);const f={resourceId:JSON.stringify(c.slideViewData.slideId),resource:c.slideViewData,metadata:i.metadata,options:t};return this.slideViewData.add(f),i}},this.resourceIdToImageLoadPromise={},this.imageLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorFailedToLoadResourceEntry"}};if(!t||null==t.meta_clientWidth||null==t.meta_clientHeight||!t.meta_resourceEntries)return this.m_logger.sendTraceTag(595178198,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"missing clientWidth or clientHeight or resourceEntries"),i.metadata.errorName="ErrorMissingClientWidthOrHeight",i;if(e in this.resourceIdToImageLoadPromise){await this.resourceIdToImageLoadPromise[e];const i=this.imageData.getLoadResultInCache(e,t);if(i)return i}const r=t.meta_resourceEntries;if(!r)return i.metadata.errorName="ErrorMissingEntriesInOptions",i;let n=[];n=r.map(e=>({Id:e.id,Name:e.name}));const a=new Promise(async a=>{const d={ClientWidth:t.meta_clientWidth,ClientHeight:t.meta_clientHeight,ResourceParams:n,EnableClustering:!0===t.meta_enableClustering,IsHighContrast:t.meta_isHighContrast,ColorMode:t.meta_colorMode,ClientColorSettings:t.meta_clientColorSettings,CorrelationId:t.meta_correlationId||"",RequestInfo:t.meta_requestInfo,PriorityHint:t.meta_priorityHint,IsBootRequest:t.meta_isInit,LocaleName:t.meta_localeName};let h={slideInfo:[],responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",responseIsIntentional:!1,itemErrorCodeMap:void 0},c=0;for(;c<this.m_settings.retryCount&&(c>=1&&m.shouldReduceResolution(h)&&this.adjustRequestParamsForRetry(d,t),h=await this.m_podProxy.getItemsResourceAsync(d),c+=1,!(h.slideInfo&&h.slideInfo.length>0))&&this.shouldRetry(h);){const i=t.meta_correlationId;t.meta_correlationId=Object(l.v4)(),d.CorrelationId=t.meta_correlationId,this.m_logger.sendTraceTag(577250646,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,`imageLoader: Generating new correlationId for retrying request - resourceId:${e}, old correlation:${i}, new correlation:${t.meta_correlationId}, attempts:${c}, responseErrorCode:${h.responseErrorCode.toString()}, errorCodeMap:${h.itemErrorCodeMap?JSON.stringify([...h.itemErrorCodeMap]):""}`)}if(0===h.slideInfo.length||!h.slideInfo[0].ResourceData)return i.metadata.errorName=this.getErrorFromResponse(h,{responseType:"slideInfo_image",resourceId:e,cid:t.meta_correlationId,hasSlideInfo:!!h.slideInfo,slideInfoLen:h.slideInfo?h.slideInfo.length:0,hasRes:!!(h.slideInfo&&h.slideInfo.length>0)&&!!h.slideInfo[0].ResourceData,attempts:c},""),a(),i;this.m_logger.sendTraceTag(579470408,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,`imageLoader: Got slideInfoResponse - resourceId:${e}, correlation:${t.meta_correlationId}, attempts:${c}`);const u=h.slideInfo[0].ResourceData,f=!(!h.usedOutputCache||"true"!==h.usedOutputCache.toString().toLowerCase().trim());return this.addImages(r,u,t,f),i.metadata={created:new Date,lastAccessed:new Date,cached:h.usedOutputCache&&"true"===h.usedOutputCache.toString().toLowerCase().trim(),requestInfo:t.meta_requestInfo},a(),i});for(const e of n)this.resourceIdToImageLoadPromise[e.Id]=a;await a;for(const e of n)delete this.resourceIdToImageLoadPromise[e.Id];return this.imageData.getLoadResultInCache(e,t)||i}},this.slideInfoLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorFailedToLoadSlideInfo"}};if(null==t.meta_clientWidth||null==t.meta_clientHeight)return this.m_logger.sendTraceTag(595178199,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"missing clientWidth or clientHeight"),i.metadata.errorName="ErrorMissingClientWidthOrHeight",i;const r=JSON.parse(e).sid;if(!r)return this.m_logger.sendTraceTag(594587732,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"slideInfoLoader: invalid resourceId "+e),i.metadata.errorName="ErrorMissingSlideId",i;t.meta_correlationId||this.m_logger.sendTraceTag(591734947,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"missing correlationId in slideInfoLoader. resourceId:"+e);const n={SlideLocations:[{slideId:{sid:r,cid:0}}],GetSlideImage:!1,ClientWidth:t.meta_clientWidth,ClientHeight:t.meta_clientHeight,DevicePixelRatio:window.devicePixelRatio||1,RenderOptions:{RenderSlides:!0,RenderThumbs:!1},GetSlideAccessibilityModelData:!0,IsHighContrast:t.meta_isHighContrast,ColorMode:t.meta_colorMode,ClientColorSettings:t.meta_clientColorSettings,TranslateLanguage:t.meta_translateLanguage,CorrelationId:t.meta_correlationId||"",RequestInfo:t.meta_requestInfo,PriorityHint:t.meta_priorityHint,IsBootRequest:t.meta_isInit,LocaleName:t.meta_localeName};let h={ExportAsImages:c.Settings.readBooleanOrDefault("forceSvg",!1)};h.Settings=this.m_getItemsSettings,h.ImageAppendOption=m.getImageAppendOption(t.meta_imageAppendOption),h.EnableClustering=!0===t.meta_enableClustering,h.UseAnimatableParts=!0,h.ExportShapeBuilderSVG=t.meta_enableSVGAsWebGLTexture,h.ConvertGifToVideo=t.meta_convertGifToVideo,t.meta_knownGlyphs&&(h.KnownGlyphs=t.meta_knownGlyphs),n.Filters=h;let u={slideInfo:[],responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",responseIsIntentional:!1,itemErrorCodeMap:void 0},f=0;for(;f<this.m_settings.retryCount&&(f>=1&&m.shouldReduceResolution(u)&&this.adjustRequestParamsForRetry(n,t),u=await this.m_podProxy.getItemsSlideInfosAsync(n),f+=1,!this.isValidSlideInfo(u)||d.ChangeGate.isChangeGateEnabled("DefaultResourceProviders.RetryOnAXError")&&!this.isValidSlideAXInfo(u,n))&&this.shouldRetry(u);)t.meta_correlationId=Object(l.v4)(),n.CorrelationId=t.meta_correlationId;let p="";if(this.isValidSlideInfo(u)&&this.isValidSlideAXInfo(u,n)||(p=this.getErrorFromResponse(u,{responseType:"slideInfo",resourceId:e,cid:t.meta_correlationId,hasSlideInfo:!!u.slideInfo,slideInfoLen:u.slideInfo?u.slideInfo.length:0,hasSlideshowInfo:!!(u.slideInfo&&u.slideInfo.length>0)&&!!u.slideInfo[0].SlideShowInfo,getAX:n.GetSlideAccessibilityModelData,hasAX:!!(u.slideInfo&&u.slideInfo.length>0)&&!!u.slideInfo[0].AccessibilityModel,attempts:f},"")),!this.isValidSlideInfo(u))return i.metadata.errorName=p,i;this.m_logger.sendTraceTag(579470409,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,`slideInfoLoader: Got slideInfo - resourceId:${e}, correlation:${t.meta_correlationId}, attempts:${f}, responseError:${p}, SlideShowInfo is not empty:${!!u.slideInfo&&u.slideInfo.length>0&&!!u.slideInfo[0].SlideShowInfo}`);const g=u.slideInfo;this.m_logger.sendTraceTag(557973763,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,`slideInfoLoader: Got slideInfo - resourceId:${e}, correlation:${t.meta_correlationId}, attempts:${f}, enableKnownGlyphsOptimization:${!!t.meta_knownGlyphs}, SlideShowInfo length:${JSON.stringify(g).length}`),i.resource=g[0],i.metadata={created:new Date,lastAccessed:new Date,cached:u.usedOutputCache&&"true"===u.usedOutputCache.toString().toLowerCase().trim(),requestInfo:t.meta_requestInfo},!this.isValidSlideAXInfo(u,n)&&p&&(i.metadata.axErrorName=p),u.metadata&&(i.metadata.getItemsResult=u.metadata);const _=u.slideInfo[0].ResourceData;let v;u.slideInfo[0].SlideShowInfo&&(v=a.a.parseResCat(u.slideInfo[0].SlideShowInfo.sld[0]).filter(e=>""===e.url));const y=!(!u.usedOutputCache||"true"!==u.usedOutputCache.toString().toLowerCase().trim());return this.addImages(v,_,t,y),i}},this.localizedStringLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorLocalizedStringNotFound"}};return this.m_settings&&this.m_settings.localizedStrings&&this.m_settings.localizedStrings[e]?(i.resource=this.m_settings.localizedStrings[e],i.metadata={created:new Date,lastAccessed:new Date},i):i}},this.presInfoAndSlideInfoLoader={load:async(e,t)=>{const i={resourceId:e,metadata:{errorName:"ErrorFailedToLoadPresInfo"}};try{if(null==t.meta_clientWidth||null==t.meta_clientHeight)return this.m_logger.sendTraceTag(577250648,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"missing clientWidth or clientHeight"),i.metadata.errorName="ErrorMissingClientWidthOrHeight",i;const r=JSON.parse(e);if(!(r.slideId&&r.slideId.sid||void 0!==r.slideIndex))return this.m_logger.sendTraceTag(577250649,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,"presInfoAndSlideInfoLoader: invalid resourceId "+e),i.metadata.errorName="ErrorMissingSlideId",i;const n={ClientWidth:t.meta_clientWidth,ClientHeight:t.meta_clientHeight,CorrelationId:t.meta_correlationId||"",FilterHiddenSlideInfo:t.meta_filterHiddenSlideInfo,RequestInfo:t.meta_requestInfo,PriorityHint:t.meta_priorityHint,IsBootRequest:t.meta_isInit,IncludeSections:t.meta_includeSections};t.meta_correlationId||this.m_logger.sendTraceTag(577250650,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"missing correlationId in presInfoAndSlideInfoLoader. resourceId:"+e);const h={SlideLocations:[r],GetSlideImage:!1,ClientWidth:t.meta_clientWidth,ClientHeight:t.meta_clientHeight,DevicePixelRatio:window.devicePixelRatio||1,RenderOptions:{RenderSlides:!0,RenderThumbs:!1},GetSlideAccessibilityModelData:!0,IsHighContrast:t.meta_isHighContrast,ColorMode:t.meta_colorMode,ClientColorSettings:t.meta_clientColorSettings,TranslateLanguage:t.meta_translateLanguage,CorrelationId:t.meta_correlationId||"",RequestInfo:t.meta_requestInfo,PriorityHint:t.meta_priorityHint,IsBootRequest:t.meta_isInit,LocaleName:t.meta_localeName};let f={ExportAsImages:c.Settings.readBooleanOrDefault("forceSvg",!1)};f.Settings=this.m_getItemsSettings,f.ImageAppendOption=m.getImageAppendOption(t.meta_imageAppendOption),f.EnableClustering=!0===t.meta_enableClustering,f.UseAnimatableParts=!0,f.ExportShapeBuilderSVG=t.meta_enableSVGAsWebGLTexture,f.ConvertGifToVideo=t.meta_convertGifToVideo,h.Filters=f;let p={presInfo:void 0,slideInfo:[],responseErrorCode:"ErrorRESERVEDSuccess",responseErrorCategory:"ErrorRESERVEDSuccess",responseIsIntentional:!1,itemErrorCodeMap:void 0},g=0,_=!1,v=this.m_settings.retryCount;for(;g<v;){try{_&&(h.GetSlideAccessibilityModelData=!1);let i=this.shouldTimeoutResponseStreamDownload(g);g>=1&&(m.shouldReduceResolution(p)&&this.adjustRequestParamsForRetry(h,t),c.Settings.readBooleanOrDefault("retryWhenGoodNetworkForBoot",!1)&&await Object(u.waitUntilTrueAsync)(()=>this.m_isNetworkHealthy));let r,a=t.meta_overrideDownloadTimeoutIfBadNetworkMs&&this.m_isNetworkHealthSpotty?t.meta_overrideDownloadTimeoutIfBadNetworkMs:void 0;if((c.Settings.readBooleanOrDefault("overrideAllTimeoutsForBoot",!1)||c.Settings.readBooleanOrDefault("overrideAllTimeoutsForBootIfBadNetwork",!1)&&this.m_isNetworkHealthSpotty)&&(a=c.Settings.readNumberOrDefault("overrideDownloadTimeoutForBootMs",0)||a,r=c.Settings.readNumberOrDefault(`overrideGetItemsTimeoutForBootAttempt${g+1}Ms`,0)||r),p=await this.m_podProxy.getItemsPresInfoAndSlideInfosAsync(n,h,{shouldTimeoutResponseStreamDownload:i,overrideDownloadTimeoutMs:a,overrideGetItemsTimeoutMs:r}),g+=1,p.presInfo&&this.isValidSlideInfo(p)&&(!d.ChangeGate.isChangeGateEnabled("DefaultResourceProviders.RetryOnAXError")||this.isValidSlideAXInfo(p,h)))break;if("ErrorDownloadResponseStreamTimeout"!==p.responseErrorCode||_){if(this.shouldRetry(p)){const i=t.meta_correlationId;t.meta_correlationId=Object(l.v4)(),n.CorrelationId=t.meta_correlationId,this.m_logger.sendTraceTag(577250651,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,`presInfoAndSlideInfoResponse: Generating new correlationId for retrying request - resourceId:${e}, old correlation:${i}, new correlation:${t.meta_correlationId}, \n                attempts:${g}, responseErrorCode:${p.responseErrorCode.toString()}, errorCodeMap:${p.itemErrorCodeMap?JSON.stringify([...p.itemErrorCodeMap]):""}`);continue}break}this.m_logger.sendTraceTag(560317845,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"presInfoAndSlideInfoLoader - switch to use fallback request as ErrorDownloadResponseStreamTimeout error received."),_=!0,g-=1}catch(e){this.m_logger.sendTraceTag(571524049,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,`presInfoAndSlideInfoLoader - exception during call m_podProxy.getItemsPresInfoAndSlideInfosAsync, attempts:${g}, info: ${e}. `)}this.m_isNetworkHealthSpotty&&c.Settings.readBooleanOrDefault("overrideRetryCountForBootIfBadNetwork",!1)&&(v=c.Settings.readNumberOrDefault("overrideRetryCount",v))}let y="";if(p.presInfo&&this.isValidSlideInfo(p)&&this.isValidSlideAXInfo(p,h)||(y=this.getErrorFromResponse(p,{responseType:"presInfoAndSlideInfo",resourceId:e,cid:t.meta_correlationId,hasSlideInfo:!!p.slideInfo,slideInfoLen:p.slideInfo?p.slideInfo.length:0,hasSlideshowInfo:!!(p.slideInfo&&p.slideInfo.length>0)&&!!p.slideInfo[0].SlideShowInfo,getAX:h.GetSlideAccessibilityModelData,hasAX:!!(p.slideInfo&&p.slideInfo.length>0)&&!!p.slideInfo[0].AccessibilityModel,attempts:g},"")),!p.presInfo)return i.metadata.errorName=y,i.metadata.isIntentional=p.responseIsIntentional,i;this.m_logger.sendTraceTag(577250653,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,`presInfoAndSlideInfoResponse: Got presInfoAndSlideInfo - resourceId:${e}, correlation:${t.meta_correlationId}, attempts:${g}`),i.metadata={created:new Date,lastAccessed:new Date,cached:p.usedOutputCache&&"true"===p.usedOutputCache.toString().toLowerCase().trim(),requestInfo:t.meta_requestInfo},p.metadata&&(i.metadata.getItemsResult=p.metadata);const b={resourceId:"",resource:p.presInfo,metadata:i.metadata,options:t};if(this.presInfo.add(b),!this.isValidSlideInfo(p))return i.resource=p.presInfo,this.m_logger.sendTraceTag(577065922,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,`presInfoAndSlideInfoResponse: failed to get slideInfo in presInfoAndSlideInfo. errorName:${y}, resourceId:${e}, correlation:${t.meta_correlationId}, attempts:${g}`),b;{i.resource={...p.presInfo,...p.slideInfo[0]},this.isValidSlideAXInfo(p,h)||(i.metadata.axErrorName=y);const e={resourceId:JSON.stringify({sid:p.slideInfo[0].ID.sid,cid:0}),resource:p.slideInfo[0],metadata:i.metadata,options:t};this.slideInfo.add(e);const r=p.slideInfo[0].ResourceData;let n;p.slideInfo[0].SlideShowInfo&&(n=a.a.parseResCat(p.slideInfo[0].SlideShowInfo.sld[0]).filter(e=>""===e.url));const s=!(!p.usedOutputCache||"true"!==p.usedOutputCache.toString().toLowerCase().trim());this.addImages(n,r,t,s)}return i}catch(e){return this.m_logger.sendTraceTag(571524050,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Error,`presInfoAndSlideInfoLoader - exception during call load: ${e}. `),i}}},this.m_podProxy=e,this.m_logger=t,this.m_settings=i||{retryCount:3};let p={};if(i&&i.settings){c.Settings.addOrUpdateSetting(i.settings,"getitemsmanaged","supportsSlideInfoResult",c.Settings.readStringOrDefault("enableSlideInfoResult","false"));for(let e in i.settings){if(-1===e.toLowerCase().indexOf("getitems"))continue;const t=i.settings[e];let r={};for(let e in t)r[e]=t[e].toString();p[e]=r}}this.m_getItemsSettings=p,Object(h.c)({logger:this.m_logger,settings:i?i.settings:void 0,disabledChangeGates:this.m_settings.disabledChangeGates}),this.presInfoAndSlideInfo=new n.b(this.presInfoAndSlideInfoLoader),this.presInfo=new n.b(this.presInfoLoader),this.slide=new n.b(this.slideLoader),this.slideViewData=new n.b(this.slideViewDataLoader),this.imageData=new n.b(this.imageLoader),this.imageData.events.on("removed",e=>this.disposeImage(e)),this.shapeViewData=new n.b(this.shapeViewDataLoader),this.slideInfo=new n.b(this.slideInfoLoader),this.localizedString=new n.b(this.localizedStringLoader)}disposeImage(e){e.resource&&1===e.resource.urlType&&URL.revokeObjectURL(e.resource.url)}dispose(){for(let e of this.imageData.getAllLoadResultsInCache())this.imageData.remove(e.resourceId,e.options)}updatePodsProxy(e){this.m_podProxy=e}isSlideCached(e){return!!this.slideInfo.getLoadResultInCache(e)}async invalidateSlideAsync(e,t){const i=e.sid,r=e.cid;if(!this.slideInfo.getLoadResultsInCache(JSON.stringify({sid:i,cid:0})))return;const n=await this.slideInfo.load(JSON.stringify({sid:i,cid:0}),t),s=await this.presInfo.load("",t);if(!n.resource||!s.resource)return;const o=new Map(this.imageData.getAllLoadResultsInCache().map(e=>[e.resourceId,e.resource])),l=a.a.getDataFromSlideInfoAndImages(n.resource,s.resource.SlideOrder,o);if(!l)return;for(let e=0;e<l.shapeViewDatas.length;e+=1){const t=`${JSON.stringify(l.slideViewData.slideId)}_${JSON.stringify(l.shapeViewDatas[e].shapeId)}`;this.shapeViewData.remove(t)}const d=l.slideViewData.resCat;if(d&&0!==d.length){for(const e of d)this.imageData.remove(e.id);this.slideViewData.remove(JSON.stringify({sid:i,cid:0})),this.slide.remove(JSON.stringify({sid:i,cid:0})),this.slideInfo.remove(JSON.stringify({sid:i,cid:0})),this.slideViewData.remove(JSON.stringify(l.slideViewData.slideId)),this.slide.remove(JSON.stringify(l.slide.id)),this.slideInfo.remove(JSON.stringify({sid:i,cid:r})),this.presInfo.remove(""),this.presInfoAndSlideInfo.remove(JSON.stringify({slideIndex:0}))}}resetProviders(){this.dispose(),this.presInfoAndSlideInfo=new n.b(this.presInfoAndSlideInfoLoader),this.presInfo=new n.b(this.presInfoLoader),this.slide=new n.b(this.slideLoader),this.slideViewData=new n.b(this.slideViewDataLoader),this.imageData=new n.b(this.imageLoader),this.imageData.events.on("removed",e=>this.disposeImage(e)),this.shapeViewData=new n.b(this.shapeViewDataLoader),this.slideInfo=new n.b(this.slideInfoLoader),this.localizedString=new n.b(this.localizedStringLoader)}shouldTimeoutResponseStreamDownload(e){if(e>=this.m_settings.retryCount-1)return this.m_logger.sendTraceTag(560317846,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"shouldTimeoutResponseStream - last retry attemp, so should not timeout. "),!1;let t=!1;try{let e=null!=window.navigator?window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection:null;if(e){const i=null!=e.downlink?e.downlink:void 0,r=null!=e.rtt?e.rtt:void 0;i>=c.Settings.readNumberOrDefault("fallbackRequestMinNetworkSpeed",1)&&r<=c.Settings.readNumberOrDefault("fallbackRequestMaxRTT",1e3)&&(t=!0),this.m_logger.sendTraceTag(560317847,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,`DefaultResourceProviders::Client network info - downlinkSpeed: ${i}Mbps, rtt: ${r}ms, shouldTimeoutResponseStream:${t}`)}else this.m_logger.sendTraceTag(560317848,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"DefaultResourceProviders::network information API not supported by the browser")}catch(e){this.m_logger.sendTraceTag(560317849,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"DefaultResourceProviders::shouldTimeoutResponseStreamDownload exception: "+e)}return t}static getImageAppendOption(e){switch(e){case"none":return r.f.None;case"all":return r.f.All;case"partial":return r.f.Partial;case"embed":default:return r.f.Embed}}shouldRetry(e){return e.itemErrorCategoryMap&&Array.from(e.itemErrorCategoryMap.values()).some(e=>this.m_settings.retryOnCategories&&this.m_settings.retryOnCategories.indexOf(e.trim())>=0)||e.itemErrorCodeMap&&Array.from(e.itemErrorCodeMap.values()).some(e=>this.m_settings.retryOnCategories&&this.m_settings.retryOnCategories.indexOf(e.trim())>=0)||this.m_settings.retryOnCategories&&this.m_settings.retryOnCategories.includes(e.responseErrorCategory.toString())||!this.m_settings.retryOnCategories}getErrorFromResponse(e,t,i){let r="",n="";if("ErrorRESERVEDSuccess"!==e.responseErrorCode.toString())r=e.responseErrorCode.toString();else if(e.itemErrorCodeMap){if(""!==i)r=e.itemErrorCodeMap.get(i)||"";else{const t=Array.from(e.itemErrorCodeMap.values()).filter(e=>"ErrorRESERVEDSuccess"!==e.trim());t.length>0&&(r=t[0])}n=JSON.stringify([...e.itemErrorCodeMap])}return r&&!r.startsWith("Server")&&(this.m_logger.sendTraceTag(509732750,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Info,"Prefixing Server to errorName:"+r),r="Server"+r),r}isValidSlideInfo(e){return!!e.slideInfo&&e.slideInfo.length>0&&(!d.ChangeGate.isChangeGateEnabled("DefaultResourceProviders.checkSlideShowInfo")||!!e.slideInfo[0].SlideShowInfo)}isValidSlideAXInfo(e,t){return!!e.slideInfo&&e.slideInfo.length>0&&(!t.GetSlideAccessibilityModelData||!!e.slideInfo[0].AccessibilityModel)}addImages(e,t,i,r){if(t)for(const n of t){const t=e?e.find(e=>e.id===n.Id):void 0;if(t&&!this.imageData.getLoadResultInCache(t.id,i)){t.byteCount=n.ByteCount,t.mimeType=n.MimeType,n.Binary?(t.url=URL.createObjectURL(new Blob([n.Binary],{type:t.mimeType})),t.urlType=1):(t.url=n.Base64,t.urlType=0),t.url||this.m_logger.sendTraceTag(540849759,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"imageLoader: Got empty url - "+JSON.stringify({resourceId:n.Id,correlation:i.meta_correlationId,res:t}));const e={resourceId:t.id,resource:t,metadata:{created:Date.now(),lastAccessed:Date.now(),cached:r,requestInfo:i.meta_requestInfo},options:i};this.imageData.add(e)}n.Binary&&(n.Binary=void 0)}}adjustRequestParamsForRetry(e,t){let i=t.meta_clientHeightReduced,r=t.meta_clientWidthReduced;(c.Settings.readBooleanOrDefault("loadMinResolutionOnRetry",!1)||c.Settings.readBooleanOrDefault("loadMinResolutionIfBadNetwork",!0)&&this.m_isNetworkHealthSpotty)&&t.meta_clientHeightMin&&t.meta_clientWidthMin&&(i=t.meta_clientHeightMin,r=t.meta_clientWidthMin),i&&r&&(d.ChangeGate.isChangeGateEnabled("SSC.logAdjustRequestParamClientResolution")&&this.m_logger.sendTraceTag(527242946,o.a.msoulscat_Wac_PptSlideshow,s.TraceLevel.Warning,"DefaultResourceProvider: adjusted request param client resolution - "+JSON.stringify({oldClientHeight:e.ClientHeight,oldClientWidth:e.ClientWidth,newClientHeight:i,newClientWidth:r})),e.ClientWidth=r,e.ClientHeight=i)}static shouldReduceResolution(e){const t=c.Settings.readStringOrDefault("errorsToReduceResolutionOnRetry","");return e.itemErrorCategoryMap&&Array.from(e.itemErrorCategoryMap.values()).some(e=>t.indexOf(e.trim())>=0)||e.itemErrorCodeMap&&Array.from(e.itemErrorCodeMap.values()).some(e=>t.indexOf(e.trim())>=0)||t.includes(e.responseErrorCategory.toString())}setNetworkHealth(e){e||(this.m_isNetworkHealthSpotty=!0),this.m_isNetworkHealthy=e}}},,,function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i(6),n=i(31),a=i(4),s=i(2),o=i(3),l=(i(407),i(21)),d=i(1);class h{constructor(e,t,i,r){this.events=new n.EventEmitter,this.m_preventClickEvent=!1,this.m_lastScaling=0,this.m_lastPosition=l.b.Zero,this.m_touchInputEnabled=!1,this.m_mouseInputEnabled=!1,this.m_opticalZoomTouchInputsEnabled=!1,this.m_opticalZoomMouseInputsEnabled=!1,this.m_opticalZoomKeyboardInputsEnabled=!1,this.m_slideshowCore=e,this.m_isRtl=i,this.m_container=t,this.m_hammerManager=new Hammer.Manager(t),d.Settings.readBooleanOrDefault("enableOpticalZoom",!1)?(this.m_hammerManager.add(new Hammer.Pan),this.m_hammerManager.add((new Hammer.Swipe).recognizeWith(this.m_hammerManager.get("pan"))),this.m_hammerManager.add((new Hammer.Pinch).recognizeWith(this.m_hammerManager.get("pan")))):this.m_hammerManager.add(new Hammer.Swipe),this.m_boundOnClick=this.onClick.bind(this),this.m_boundOnWheel=this.onWheel.bind(this),this.m_boundOnKeyDown=this.onKeyDown.bind(this),this.m_boundOnKeyDownForOpticalZoom=this.onKeyDownForOpticalZoom.bind(this),this.m_boundOnSwipeEvent=this.onSwipeEvent.bind(this),this.m_boundOnMousePanEvent=this.onMousePan.bind(this),this.m_boundOnTouchPanEvent=this.onTouchPan.bind(this),this.m_boundOnPinchEvent=this.onPinch.bind(this),this.enableMouseInput(),this.enableKeyboardInput(),this.enableTouchInput(),this.m_inputLoggingCallback=r}enableMouseInput(){d.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&this.m_mouseInputEnabled||(this.m_container.addEventListener("click",this.m_boundOnClick),this.m_mouseInputEnabled=!0,a.a.sendTraceTag(540153436,s.a.msoulscat_Wac_PptLive,o.a.Info,`InputsAddon: enableMouseInput, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}disableMouseInput(){d.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&!this.m_mouseInputEnabled||(this.m_container.removeEventListener("click",this.m_boundOnClick),this.m_mouseInputEnabled=!1,a.a.sendTraceTag(540153437,s.a.msoulscat_Wac_PptLive,o.a.Info,`InputsAddon: disableMouseInput, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}enableKeyboardInput(){this.m_container.addEventListener("keydown",this.m_boundOnKeyDown),a.a.sendTraceTag(540153438,s.a.msoulscat_Wac_PptLive,o.a.Info,`InputsAddon: enableKeyboardInput, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `)}disableKeyboardInput(){this.m_container.removeEventListener("keydown",this.m_boundOnKeyDown),a.a.sendTraceTag(540153439,s.a.msoulscat_Wac_PptLive,o.a.Info,`InputsAddon: disableKeyboardInput, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `)}enableTouchInput(){if(d.Settings.readBooleanOrDefault("enableOpticalZoom",!1)){if(this.m_touchInputEnabled)return}else r.ChangeGate.isChangeGateEnabled("SlideShowCore.offSwipeBeforeOnSwipe")&&(this.m_hammerManager.off("swipeleft swiperight",this.m_boundOnSwipeEvent),a.a.sendTraceTag(540153440,s.a.msoulscat_Wac_PptLive,o.a.Info,"InputsAddon: offSwipeBeforeOnSwipe"));this.m_hammerManager.on("swipeleft swiperight",this.m_boundOnSwipeEvent),this.m_touchInputEnabled=!0,a.a.sendTraceTag(540153441,s.a.msoulscat_Wac_PptLive,o.a.Info,`InputsAddon: enableTouchInput, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `)}disableTouchInput(){d.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&!this.m_touchInputEnabled||(this.m_hammerManager.off("swipeleft swiperight",this.m_boundOnSwipeEvent),this.m_touchInputEnabled=!1,a.a.sendTraceTag(540153442,s.a.msoulscat_Wac_PptLive,o.a.Info,`InputsAddon: disableTouchInput, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}enableOpticalZoomTouchInputs(){this.m_opticalZoomTouchInputsEnabled||(this.m_hammerManager.on("panstart panmove panend",this.m_boundOnTouchPanEvent),this.m_hammerManager.on("pinchstart pinchmove pinchend",this.m_boundOnPinchEvent),this.m_opticalZoomTouchInputsEnabled=!0,a.a.sendTraceTag(521491776,s.a.msoulscat_Wac_PptLive,o.a.Info,`InputsAddon: enableOpticalZoomTouchInputs, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}disableOpticalZoomTouchInputs(){this.m_opticalZoomTouchInputsEnabled&&(this.m_hammerManager.off("panstart panmove panend",this.m_boundOnTouchPanEvent),this.m_hammerManager.off("pinchstart pinchmove pinchend",this.m_boundOnPinchEvent),this.m_opticalZoomTouchInputsEnabled=!1,a.a.sendTraceTag(521491777,s.a.msoulscat_Wac_PptLive,o.a.Info,`InputsAddon: disableOpticalZoomTouchInputs, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}enableOpticalZoomMouseInputs(){this.m_opticalZoomMouseInputsEnabled||(this.m_container.addEventListener("wheel",this.m_boundOnWheel),this.m_hammerManager.on("panstart panmove panend",this.m_boundOnMousePanEvent),this.m_opticalZoomMouseInputsEnabled=!0,a.a.sendTraceTag(521491778,s.a.msoulscat_Wac_PptLive,o.a.Info,`InputsAddon: enableOpticalZoomMouseInputs, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}disableOpticalZoomMouseInputs(){this.m_opticalZoomMouseInputsEnabled&&(this.m_container.removeEventListener("wheel",this.m_boundOnWheel),this.m_hammerManager.off("panstart panmove panend",this.m_boundOnMousePanEvent),this.m_opticalZoomMouseInputsEnabled=!1,a.a.sendTraceTag(521491779,s.a.msoulscat_Wac_PptLive,o.a.Info,`InputsAddon: disableOpticalZoomMouseInputs, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}enableOpticalZoomKeyboardInputs(){this.m_opticalZoomKeyboardInputsEnabled||(this.m_container.addEventListener("keydown",this.m_boundOnKeyDownForOpticalZoom),this.m_opticalZoomKeyboardInputsEnabled=!0,a.a.sendTraceTag(512550726,s.a.msoulscat_Wac_PptLive,o.a.Info,`InputsAddon: enableOpticalZoomKeyboardInputs, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}disableOpticalZoomKeyboardInputs(){this.m_opticalZoomKeyboardInputsEnabled&&(this.m_container.removeEventListener("keydown",this.m_boundOnKeyDownForOpticalZoom),this.m_opticalZoomKeyboardInputsEnabled=!1,a.a.sendTraceTag(512550725,s.a.msoulscat_Wac_PptLive,o.a.Info,`InputsAddon: disableOpticalZoomKeyboardInputs, containerClassList: ${this.m_container?this.m_container.classList:""}, containerId: ${this.m_container?this.m_container.id:""} `))}onSwipeEvent(e){d.Settings.readBooleanOrDefault("enableOpticalZoom",!1)&&this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel>d.Settings.readNumberOrDefault("minimumZoom",1)||r.ChangeGate.isChangeGateEnabled("SlideShowCore.skipSwipeFromNonSlideContainer")&&e.target!==this.m_container||(this.m_inputLoggingCallback&&this.m_inputLoggingCallback(""),"swipeleft"===e.type?(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("next",this.m_container),this.m_slideshowCore.nextStep("0_anim",0)):"swiperight"===e.type&&(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("prev",this.m_container),this.m_slideshowCore.prevStep("0_anim",0)),this.m_preventClickEvent=!0,window.setTimeout(()=>{this.m_preventClickEvent=!1},0))}onMousePan(e){if("mouse"===e.pointerType&&this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel>d.Settings.readNumberOrDefault("minimumZoom",1)){if("panstart"===e.type&&(this.m_lastPosition=l.b.Zero,d.Settings.readBooleanOrDefault("enableOpticalZoomGrabbyHand",!1)&&(this.m_container.style.cursor="-moz-grabbing",this.m_container.style.cursor="-webkit-grabbing",this.m_container.style.cursor="grabbing"),d.Settings.readBooleanOrDefault("allowOpticalZoomActionsPastSlideBounds",!1)&&e.srcEvent instanceof PointerEvent))try{this.m_container.setPointerCapture(e.srcEvent.pointerId)}catch(e){a.a.sendTraceTag(509658721,s.a.msoulscat_Wac_PptLive,o.a.Info,"InputsAddon::onMousePan - Could not capture pointer: "+e)}"panend"===e.type&&d.Settings.readBooleanOrDefault("enableOpticalZoomGrabbyHand",!1)&&(this.m_container.style.cursor="-moz-grab",this.m_container.style.cursor="-webkit-grab",this.m_container.style.cursor="grab"),this.m_slideshowCore.panByAmount(new l.b(e.deltaX-this.m_lastPosition.x,e.deltaY-this.m_lastPosition.y),{source:"mouse"}),this.m_lastPosition=new l.b(e.deltaX,e.deltaY),this.m_preventClickEvent=!0,window.setTimeout(()=>this.m_preventClickEvent=!1)}}onTouchPan(e){if("mouse"!==e.pointerType&&this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel>d.Settings.readNumberOrDefault("minimumZoom",1)){if("panstart"===e.type){if(this.m_lastPosition=new l.b(e.deltaX,e.deltaY),d.Settings.readBooleanOrDefault("allowOpticalZoomActionsPastSlideBounds",!1)&&e.srcEvent instanceof PointerEvent)try{this.m_container.setPointerCapture(e.srcEvent.pointerId)}catch(e){a.a.sendTraceTag(509658720,s.a.msoulscat_Wac_PptLive,o.a.Info,"InputsAddon::onTouchPan - Could not capture pointer: "+e)}return}this.m_slideshowCore.panByAmount(new l.b(e.deltaX-this.m_lastPosition.x,e.deltaY-this.m_lastPosition.y),{source:"touch"}),this.m_lastPosition=new l.b(e.deltaX,e.deltaY)}}onPinch(e){if("pinchstart"!==e.type){if(d.Settings.readBooleanOrDefault("allowOpticalZoomActionsPastSlideBounds",!1)&&e.srcEvent instanceof PointerEvent&&!this.m_container.hasPointerCapture(e.srcEvent.pointerId))try{this.m_container.setPointerCapture(e.srcEvent.pointerId)}catch(e){a.a.sendTraceTag(509658718,s.a.msoulscat_Wac_PptLive,o.a.Info,"InputsAddon::onPinch - Could not capture pointer: "+e)}this.m_slideshowCore.zoomToAsync(this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel*e.scale/this.m_lastScaling,new l.b(e.center.x,e.center.y),{source:"pinch"}),this.m_slideshowCore.panByAmount(new l.b(e.deltaX-this.m_lastPosition.x,e.deltaY-this.m_lastPosition.y),{source:"pinch"}),this.m_lastPosition=new l.b(e.deltaX,e.deltaY),this.m_lastScaling=e.scale}else if(this.m_lastScaling=e.scale,this.m_lastPosition=new l.b(e.deltaX,e.deltaY),d.Settings.readBooleanOrDefault("allowOpticalZoomActionsPastSlideBounds",!1)&&e.srcEvent instanceof PointerEvent)try{this.m_container.setPointerCapture(e.srcEvent.pointerId)}catch(e){a.a.sendTraceTag(509658719,s.a.msoulscat_Wac_PptLive,o.a.Info,"InputsAddon::onPinch - Could not capture pointer: "+e)}}onClick(e){e.target!==this.m_container||this.m_preventClickEvent||(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("next",this.m_container),this.m_slideshowCore.nextStep("0_anim",1))}onWheel(e){if(e.preventDefault(),e.ctrlKey||e.metaKey){const t=.001,i=this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel*(e.deltaY<0?1-t*e.deltaY:1/(1+t*e.deltaY));this.m_slideshowCore.zoomToAsync(i,new l.b(e.clientX,e.clientY),{source:"ctrlWheel"})}else this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel>d.Settings.readNumberOrDefault("minimumZoom",1)&&this.m_slideshowCore.panByAmount(new l.b(-e.deltaX,-e.deltaY),{source:"scroll"})}onKeyDownForOpticalZoom(e){switch(e.key){case"Escape":this.m_slideshowCore.zoomToAsync(d.Settings.readNumberOrDefault("minimumZoom",1),void 0,{fAnimate:!0,source:"keyboardEscape"});break;case"=":case"+":this.m_slideshowCore.zoomToAsync(1.15*this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel,void 0,{source:"keyboardPlus"});break;case"_":case"-":this.m_slideshowCore.zoomToAsync(1/1.15*this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel,void 0,{source:"keyboardMinus"})}switch(e.key){case"ArrowUp":return void this.m_slideshowCore.panByAmount(new l.b(0,10),{source:"keyboardArrowUp"});case"ArrowDown":return void this.m_slideshowCore.panByAmount(new l.b(0,-10),{source:"keyboardArrowDown"});case"ArrowLeft":return void this.m_slideshowCore.panByAmount(new l.b(10,0),{source:"keyboardArrowLeft"});case"ArrowRight":return void this.m_slideshowCore.panByAmount(new l.b(-10,0),{source:"keyboardArrowRight"})}}onKeyDown(e){if(e.isComposing||229===e.keyCode)this.events.emit("keydown",e);else if("n"===e.key.toLowerCase()?(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("next",this.m_container),this.m_slideshowCore.nextStep("0_anim",2)):"p"===e.key.toLowerCase()&&(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("prev",this.m_container),this.m_slideshowCore.prevStep("0_anim",2)),this.m_container!==document.querySelector("#slideshow-app-thumbnail-strip")){if(this.m_slideshowCore.opticalZoomStateInfo.currentState.zoomLevel>d.Settings.readNumberOrDefault("minimumZoom",1))return;switch(e.key){case"PageDown":case" ":case"Enter":case"ArrowDown":this.m_inputLoggingCallback&&this.m_inputLoggingCallback("next",this.m_container),this.m_slideshowCore.nextStep("0_anim",2);break;case"PageUp":case"Backspace":case"ArrowUp":this.m_inputLoggingCallback&&this.m_inputLoggingCallback("prev",this.m_container),this.m_slideshowCore.prevStep("0_anim",2);break;case"ArrowLeft":case"ArrowRight":"ArrowRight"===e.key&&!this.m_isRtl||"ArrowLeft"===e.key&&this.m_isRtl?(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("next",this.m_container),this.m_slideshowCore.nextStep("0_anim",2)):(this.m_inputLoggingCallback&&this.m_inputLoggingCallback("prev",this.m_container),this.m_slideshowCore.prevStep("0_anim",2));break;default:this.events.emit("keydown",e)}}}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(80),n=i(4);class a{constructor(e,t,i,a){this.m_sharingLayoutMode=void 0,n.a.setLogger(i),this.m_animatedContentLogger=new r.a({type:"Animation"}),e.events.on("animationStateChanging",this.logFrameData.bind(this)),a&&(a.appEvents&&a.appEvents.on("sharingLayoutModeChanged",e=>{this.m_sharingLayoutMode=e}),a.sharingLayoutMode&&(this.m_sharingLayoutMode=a.sharingLayoutMode))}logFrameData(e){const t={...e.metadata,sharingLayoutMode:this.m_sharingLayoutMode||"undefined"};this.m_animatedContentLogger.logFrameData(e.isAnimating,{metadata:t})}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(80),n=i(4);class a{constructor(e,t,i,a){this.m_sharingLayoutMode=void 0,n.a.setLogger(i),this.m_transitionContentLogger=new r.a({type:"Transition"}),e.events.on("slideLocationChanging",this.logFrameData.bind(this)),a&&(a.appEvents&&a.appEvents.on("sharingLayoutModeChanged",e=>{this.m_sharingLayoutMode=e}),a.sharingLayoutMode&&(this.m_sharingLayoutMode=a.sharingLayoutMode))}logFrameData(e){const t={...e.metadata,sharingLayoutMode:this.m_sharingLayoutMode||"undefined"};this.m_transitionContentLogger.logFrameData(e.isTransitioning,{metadata:t})}}},function(e,t,i){"use strict";(function(e){var i=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var i=-1;return e.some((function(e,r){return e[0]===t&&(i=r,!0)})),i}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var i=e(this.__entries__,t),r=this.__entries__[i];return r&&r[1]},t.prototype.set=function(t,i){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=i:this.__entries__.push([t,i])},t.prototype.delete=function(t){var i=this.__entries__,r=e(i,t);~r&&i.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var i=0,r=this.__entries__;i<r.length;i++){var n=r[i];e.call(t,n[1],n[0])}},t}()}(),r="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,n=void 0!==e&&e.Math===Math?e:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),a="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(n):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)},s=["top","right","bottom","left","width","height","size","weight"],o="undefined"!=typeof MutationObserver,l=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var i=!1,r=!1,n=0;function s(){i&&(i=!1,e()),r&&l()}function o(){a(s)}function l(){var e=Date.now();if(i){if(e-n<2)return;r=!0}else i=!0,r=!1,setTimeout(o,20);n=e}return l}(this.refresh.bind(this))}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,i=t.indexOf(e);~i&&t.splice(i,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){r&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),o?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){r&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,i=void 0===t?"":t;s.some((function(e){return!!~i.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),d=function(e,t){for(var i=0,r=Object.keys(t);i<r.length;i++){var n=r[i];Object.defineProperty(e,n,{value:t[n],enumerable:!1,writable:!1,configurable:!0})}return e},h=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||n},c=g(0,0,0,0);function u(e){return parseFloat(e)||0}function f(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return t.reduce((function(t,i){return t+u(e["border-"+i+"-width"])}),0)}var m="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof h(e).SVGGraphicsElement}:function(e){return e instanceof h(e).SVGElement&&"function"==typeof e.getBBox};function p(e){return r?m(e)?function(e){var t=e.getBBox();return g(0,0,t.width,t.height)}(e):function(e){var t=e.clientWidth,i=e.clientHeight;if(!t&&!i)return c;var r=h(e).getComputedStyle(e),n=function(e){for(var t={},i=0,r=["top","right","bottom","left"];i<r.length;i++){var n=r[i],a=e["padding-"+n];t[n]=u(a)}return t}(r),a=n.left+n.right,s=n.top+n.bottom,o=u(r.width),l=u(r.height);if("border-box"===r.boxSizing&&(Math.round(o+a)!==t&&(o-=f(r,"left","right")+a),Math.round(l+s)!==i&&(l-=f(r,"top","bottom")+s)),!function(e){return e===h(e).document.documentElement}(e)){var d=Math.round(o+a)-t,m=Math.round(l+s)-i;1!==Math.abs(d)&&(o-=d),1!==Math.abs(m)&&(l-=m)}return g(n.left,n.top,o,l)}(e):c}function g(e,t,i,r){return{x:e,y:t,width:i,height:r}}var _=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=g(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=p(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),v=function(e,t){var i,r,n,a,s,o,l,h=(r=(i=t).x,n=i.y,a=i.width,s=i.height,o="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(o.prototype),d(l,{x:r,y:n,width:a,height:s,top:n,right:r+a,bottom:s+n,left:r}),l);d(this,{target:e,contentRect:h})},y=function(){function e(e,t,r){if(this.activeObservations_=[],this.observations_=new i,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=r}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof h(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new _(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof h(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new v(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),b="undefined"!=typeof WeakMap?new WeakMap:new i,S=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var i=l.getInstance(),r=new y(t,i,this);b.set(this,r)};["observe","unobserve","disconnect"].forEach((function(e){S.prototype[e]=function(){var t;return(t=b.get(this))[e].apply(t,arguments)}}));var T=void 0!==n.ResizeObserver?n.ResizeObserver:S;t.a=T}).call(this,i(55))},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{async processMultipartResponse(e,t,i){if(null==e)throw"multipartContentBuffer is empty";try{const r=new TextDecoder("utf-8").decode(e);this.parseMultipart(r,t).forEach(e=>{const t=this.parseResponsePart(e);i(t)})}catch(e){const t={Err:new Error(e)};i(t)}}fetchBoundary(e){let t=e.split("boundary=");if(2===t.length)return t[1];throw"No Boundary"}async processMultipartBinaryResponse(e,t,i,r){return r&&r.forceNewCodePath||!(e instanceof Uint8Array)?await this.processMultipartBinaryResponseImpl(e,t,i):await this.processMultipartBinaryResponseOldImpl(e,t,i)}async processMultipartBinaryResponseOldImpl(e,t,i){if(null==e)throw"multipartContentBuffer is empty";let r,n="",a=void 0,s=0,o=[];try{for(r=0;r<e.length;r+=1){const l=e[r],d=r>0?e[r-1]:null,h=10===l||13===l,c=10===l&&13===d,u=10===d&&13===l;if(o.push(l),h||(n+=String.fromCharCode(l)),0===s&&c)"--"+t===n&&(s=1,n="",o=[]);else if(1===s&&u)a=new Uint8Array(o),s=2,n="",o=[];else if(2===s&&c)s=3,n="",o=[];else if(3===s){if(n.length>t.length+4&&(n=""),"--"+t===n){let e=o.length-n.length,t=o.slice(0,e-1);s=1,i({Headers:this.processHeader(a),Body:new Uint8Array(t)}),n="",a=void 0,o=[]}c&&(n="")}}}catch(e){i({Err:new Error(e)})}}async processMultipartBinaryResponseImpl(e,t,i){if(!e)throw"multipartContentBufferOrStream is empty";let r,n="",a=void 0,s=0,o=[],l=null;const d=e instanceof Uint8Array;try{for(;;){if(d)r=e;else{const{done:t,value:i}=await e.read();if(t)break;r=i}for(const e of r){const r=10===e||13===e,d=10===e&&13===l,h=10===l&&13===e;if(o.push(e),r||(n+=String.fromCharCode(e)),0===s&&d)"--"+t===n&&(s=1,n="",o=[]);else if(1===s&&h)a=new Uint8Array(o),s=2,n="",o=[];else if(2===s&&d)s=3,n="",o=[];else if(3===s){if(n.length>t.length+4&&(n=""),"--"+t===n){let e=o.length-n.length,t=o.slice(0,e-1);s=1,i({Headers:this.processHeader(a),Body:new Uint8Array(t)}),n="",a=void 0,o=[]}d&&(n="")}l=e}if(d)break}}catch(e){i({Err:new Error(e)})}}parseMultipart(e,t){const i="--"+t;return e.split(i).map(e=>e.trim()).filter(e=>""!==e&&"--"!==e)}parseResponsePart(e){const t=this.parseResponseHeaderFromPart(e).split("\n"),i=new Map;t.forEach(e=>{const t=e.split(": ");2===t.length&&i.set(t[0],t[1])});const r=this.parseResponseBodyFromPart(e),n=(new TextEncoder).encode(r);return{Headers:i,Body:n}}parseResponseBodyFromPart(e){const t=e.split("\n\r\n");if(2===t.length)return t[1];throw"No response Body"}parseResponseHeaderFromPart(e){const t=e.split("\n\r\n");if(2===t.length)return t[0];throw"No response Headers"}processHeader(e){let t=new Map;if(e){let i="";for(let t=0;t<e.byteLength;t+=1)i+=String.fromCharCode(e[t]);i.split("\n").forEach(e=>{let i=e.split(": ");2===i.length&&t.set(i[0],i[1])})}return t}}},,,function(e,t,i){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(n.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new a(n.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},i(271),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,i(55))},function(e,t){var i={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},function(e,t,i){"use strict";var r=i(29).Buffer,n=i(274).Transform;function a(e){n.call(this),this._block=r.allocUnsafe(e),this._blockSize=e,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}i(26)(a,n),a.prototype._transform=function(e,t,i){var r=null;try{this.update(e,t)}catch(e){r=e}i(r)},a.prototype._flush=function(e){var t=null;try{this.push(this.digest())}catch(e){t=e}e(t)},a.prototype.update=function(e,t){if(function(e,t){if(!r.isBuffer(e)&&"string"!=typeof e)throw new TypeError("Data must be a string or a buffer")}(e),this._finalized)throw new Error("Digest already called");r.isBuffer(e)||(e=r.from(e,t));for(var i=this._block,n=0;this._blockOffset+e.length-n>=this._blockSize;){for(var a=this._blockOffset;a<this._blockSize;)i[a++]=e[n++];this._update(),this._blockOffset=0}for(;n<e.length;)i[this._blockOffset++]=e[n++];for(var s=0,o=8*e.length;o>0;++s)this._length[s]+=o,(o=this._length[s]/4294967296|0)>0&&(this._length[s]-=4294967296*o);return this},a.prototype._update=function(){throw new Error("_update is not implemented")},a.prototype.digest=function(e){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var t=this._digest();void 0!==e&&(t=t.toString(e)),this._block.fill(0),this._blockOffset=0;for(var i=0;i<4;++i)this._length[i]=0;return t},a.prototype._digest=function(){throw new Error("_digest is not implemented")},e.exports=a},function(e,t,i){"use strict";(function(t,r){var n;e.exports=C,C.ReadableState=M,i(31).EventEmitter;var a,s=function(e,t){return e.listeners(t).length},o=i(179),l=i(43).Buffer,d=t.Uint8Array||function(){},h=i(275);a=h&&h.debuglog?h.debuglog("stream"):function(){};var c,u,f,m=i(276),p=i(180),g=i(181).getHighWaterMark,_=i(104).codes,v=_.ERR_INVALID_ARG_TYPE,y=_.ERR_STREAM_PUSH_AFTER_EOF,b=_.ERR_METHOD_NOT_IMPLEMENTED,S=_.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;i(26)(C,o);var T=p.errorOrDestroy,w=["error","close","destroy","pause","resume"];function M(e,t,r){n=n||i(105),e=e||{},"boolean"!=typeof r&&(r=t instanceof n),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",r),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(c||(c=i(96).StringDecoder),this.decoder=new c(e.encoding),this.encoding=e.encoding)}function C(e){if(n=n||i(105),!(this instanceof C))return new C(e);var t=this instanceof n;this._readableState=new M(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function I(e,t,i,r,n){a("readableAddChunk",t);var s,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(a("onEofChunk"),!t.ended){if(t.decoder){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,t.sync?x(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,A(e)))}}(e,o);else if(n||(s=function(e,t){var i,r;return r=t,l.isBuffer(r)||r instanceof d||"string"==typeof t||void 0===t||e.objectMode||(i=new v("chunk",["string","Buffer","Uint8Array"],t)),i}(o,t)),s)T(e,s);else if(o.objectMode||t&&t.length>0)if("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),r)o.endEmitted?T(e,new S):P(e,o,t,!0);else if(o.ended)T(e,new y);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!i?(t=o.decoder.write(t),o.objectMode||0!==t.length?P(e,o,t,!1):k(e,o)):P(e,o,t,!1)}else r||(o.reading=!1,k(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function P(e,t,i,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",i)):(t.length+=t.objectMode?1:i.length,r?t.buffer.unshift(i):t.buffer.push(i),t.needReadable&&x(e)),k(e,t)}function E(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=1073741824?e=1073741824:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function x(e){var t=e._readableState;a("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(a("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(A,e))}function A(e){var t=e._readableState;a("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,D(e)}function k(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(R,e,t))}function R(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var i=t.length;if(a("maybeReadMore read 0"),e.read(0),i===t.length)break}t.readingMore=!1}function O(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function L(e){a("readable nexttick read 0"),e.read(0)}function F(e,t){a("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),D(e),t.flowing&&!t.reading&&e.read(0)}function D(e){var t=e._readableState;for(a("flow",t.flowing);t.flowing&&null!==e.read(););}function B(e,t){return 0===t.length?null:(t.objectMode?i=t.buffer.shift():!e||e>=t.length?(i=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):i=t.buffer.consume(e,t.decoder),i);var i}function N(e){var t=e._readableState;a("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(V,t,e))}function V(e,t){if(a("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var i=t._writableState;(!i||i.autoDestroy&&i.finished)&&t.destroy()}}function U(e,t){for(var i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1}Object.defineProperty(C.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),C.prototype.destroy=p.destroy,C.prototype._undestroy=p.undestroy,C.prototype._destroy=function(e,t){t(e)},C.prototype.push=function(e,t){var i,r=this._readableState;return r.objectMode?i=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=l.from(e,t),t=""),i=!0),I(this,e,t,!1,i)},C.prototype.unshift=function(e){return I(this,e,null,!0,!1)},C.prototype.isPaused=function(){return!1===this._readableState.flowing},C.prototype.setEncoding=function(e){c||(c=i(96).StringDecoder);var t=new c(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";null!==r;)n+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==n&&this._readableState.buffer.push(n),this._readableState.length=n.length,this},C.prototype.read=function(e){a("read",e),e=parseInt(e,10);var t=this._readableState,i=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return a("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?N(this):x(this),null;if(0===(e=E(e,t))&&t.ended)return 0===t.length&&N(this),null;var r,n=t.needReadable;return a("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&a("length less than watermark",n=!0),t.ended||t.reading?a("reading or ended",n=!1):n&&(a("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=E(i,t))),null===(r=e>0?B(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),i!==e&&t.ended&&N(this)),null!==r&&this.emit("data",r),r},C.prototype._read=function(e){T(this,new b("_read()"))},C.prototype.pipe=function(e,t){var i=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,a("pipe count=%d opts=%j",n.pipesCount,t);var o=t&&!1===t.end||e===r.stdout||e===r.stderr?p:l;function l(){a("onend"),e.end()}n.endEmitted?r.nextTick(o):i.once("end",o),e.on("unpipe",(function t(r,s){a("onunpipe"),r===i&&s&&!1===s.hasUnpiped&&(s.hasUnpiped=!0,a("cleanup"),e.removeListener("close",f),e.removeListener("finish",m),e.removeListener("drain",d),e.removeListener("error",u),e.removeListener("unpipe",t),i.removeListener("end",l),i.removeListener("end",p),i.removeListener("data",c),h=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}));var d=function(e){return function(){var t=e._readableState;a("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,D(e))}}(i);e.on("drain",d);var h=!1;function c(t){a("ondata");var r=e.write(t);a("dest.write",r),!1===r&&((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==U(n.pipes,e))&&!h&&(a("false write response, pause",n.awaitDrain),n.awaitDrain++),i.pause())}function u(t){a("onerror",t),p(),e.removeListener("error",u),0===s(e,"error")&&T(e,t)}function f(){e.removeListener("finish",m),p()}function m(){a("onfinish"),e.removeListener("close",f),p()}function p(){a("unpipe"),i.unpipe(e)}return i.on("data",c),function(e,t,i){if("function"==typeof e.prependListener)return e.prependListener(t,i);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(i):e._events[t]=[i,e._events[t]]:e.on(t,i)}(e,"error",u),e.once("close",f),e.once("finish",m),e.emit("pipe",i),n.flowing||(a("pipe resume"),i.resume()),e},C.prototype.unpipe=function(e){var t=this._readableState,i={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,i)),this;if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<n;a++)r[a].emit("unpipe",this,{hasUnpiped:!1});return this}var s=U(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,i)),this},C.prototype.on=function(e,t){var i=o.prototype.on.call(this,e,t),n=this._readableState;return"data"===e?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"===e&&(n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,a("on readable",n.length,n.reading),n.length?x(this):n.reading||r.nextTick(L,this))),i},C.prototype.addListener=C.prototype.on,C.prototype.removeListener=function(e,t){var i=o.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(O,this),i},C.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||r.nextTick(O,this),t},C.prototype.resume=function(){var e=this._readableState;return e.flowing||(a("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(F,e,t))}(this,e)),e.paused=!1,this},C.prototype.pause=function(){return a("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(a("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},C.prototype.wrap=function(e){var t=this,i=this._readableState,r=!1;for(var n in e.on("end",(function(){if(a("wrapped end"),i.decoder&&!i.ended){var e=i.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(n){a("wrapped data"),i.decoder&&(n=i.decoder.write(n)),i.objectMode&&null==n||(i.objectMode||n&&n.length)&&(t.push(n)||(r=!0,e.pause()))})),e)void 0===this[n]&&"function"==typeof e[n]&&(this[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n));for(var s=0;s<w.length;s++)e.on(w[s],this.emit.bind(this,w[s]));return this._read=function(t){a("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(C.prototype[Symbol.asyncIterator]=function(){return void 0===u&&(u=i(279)),u(this)}),Object.defineProperty(C.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(C.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(C.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),C._fromList=B,Object.defineProperty(C.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(C.from=function(e,t){return void 0===f&&(f=i(280)),f(C,e,t)})}).call(this,i(55),i(48))},function(e,t,i){e.exports=i(31).EventEmitter},function(e,t,i){"use strict";(function(t){function i(e,t){n(e,t),r(e)}function r(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function n(e,t){e.emit("error",t)}e.exports={destroy:function(e,a){var s=this,o=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return o||l?(a?a(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(n,this,e)):t.nextTick(n,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!a&&e?s._writableState?s._writableState.errorEmitted?t.nextTick(r,s):(s._writableState.errorEmitted=!0,t.nextTick(i,s,e)):t.nextTick(i,s,e):a?(t.nextTick(r,s),a(e)):t.nextTick(r,s)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var i=e._readableState,r=e._writableState;i&&i.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this,i(48))},function(e,t,i){"use strict";var r=i(104).codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,i,n){var a=function(e,t,i){return null!=e.highWaterMark?e.highWaterMark:t?e[i]:null}(t,n,i);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new r(n?i:"highWaterMark",a);return Math.floor(a)}return e.objectMode?16:16384}}},function(e,t,i){"use strict";(function(t,r){function n(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,i){var r=e.entry;for(e.entry=null;r;){var n=r.callback;t.pendingcb--,n(void 0),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}var a;e.exports=C,C.WritableState=M;var s,o={deprecate:i(145)},l=i(179),d=i(43).Buffer,h=t.Uint8Array||function(){},c=i(180),u=i(181).getHighWaterMark,f=i(104).codes,m=f.ERR_INVALID_ARG_TYPE,p=f.ERR_METHOD_NOT_IMPLEMENTED,g=f.ERR_MULTIPLE_CALLBACK,_=f.ERR_STREAM_CANNOT_PIPE,v=f.ERR_STREAM_DESTROYED,y=f.ERR_STREAM_NULL_VALUES,b=f.ERR_STREAM_WRITE_AFTER_END,S=f.ERR_UNKNOWN_ENCODING,T=c.errorOrDestroy;function w(){}function M(e,t,s){a=a||i(105),e=e||{},"boolean"!=typeof s&&(s=t instanceof a),this.objectMode=!!e.objectMode,s&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=u(this,e,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var i=e._writableState,n=i.sync,a=i.writecb;if("function"!=typeof a)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(i),t)!function(e,t,i,n,a){--t.pendingcb,i?(r.nextTick(a,n),r.nextTick(k,e,t),e._writableState.errorEmitted=!0,T(e,n)):(a(n),e._writableState.errorEmitted=!0,T(e,n),k(e,t))}(e,i,n,t,a);else{var s=x(i)||e.destroyed;s||i.corked||i.bufferProcessing||!i.bufferedRequest||E(e,i),n?r.nextTick(P,e,i,s,a):P(e,i,s,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}function C(e){var t=this instanceof(a=a||i(105));if(!t&&!s.call(C,this))return new C(e);this._writableState=new M(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),l.call(this)}function I(e,t,i,r,n,a,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):i?e._writev(n,t.onwrite):e._write(n,a,t.onwrite),t.sync=!1}function P(e,t,i,r){i||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),k(e,t)}function E(e,t){t.bufferProcessing=!0;var i=t.bufferedRequest;if(e._writev&&i&&i.next){var r=t.bufferedRequestCount,a=new Array(r),s=t.corkedRequestsFree;s.entry=i;for(var o=0,l=!0;i;)a[o]=i,i.isBuf||(l=!1),i=i.next,o+=1;a.allBuffers=l,I(e,t,!0,t.length,a,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new n(t),t.bufferedRequestCount=0}else{for(;i;){var d=i.chunk,h=i.encoding,c=i.callback;if(I(e,t,!1,t.objectMode?1:d.length,d,h,c),i=i.next,t.bufferedRequestCount--,t.writing)break}null===i&&(t.lastBufferedRequest=null)}t.bufferedRequest=i,t.bufferProcessing=!1}function x(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function A(e,t){e._final((function(i){t.pendingcb--,i&&T(e,i),t.prefinished=!0,e.emit("prefinish"),k(e,t)}))}function k(e,t){var i=x(t);if(i&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,r.nextTick(A,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var n=e._readableState;(!n||n.autoDestroy&&n.endEmitted)&&e.destroy()}return i}i(26)(C,l),M.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(M.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(s=Function.prototype[Symbol.hasInstance],Object.defineProperty(C,Symbol.hasInstance,{value:function(e){return!!s.call(this,e)||this===C&&e&&e._writableState instanceof M}})):s=function(e){return e instanceof this},C.prototype.pipe=function(){T(this,new _)},C.prototype.write=function(e,t,i){var n,a=this._writableState,s=!1,o=!a.objectMode&&(n=e,d.isBuffer(n)||n instanceof h);return o&&!d.isBuffer(e)&&(e=function(e){return d.from(e)}(e)),"function"==typeof t&&(i=t,t=null),o?t="buffer":t||(t=a.defaultEncoding),"function"!=typeof i&&(i=w),a.ending?function(e,t){var i=new b;T(e,i),r.nextTick(t,i)}(this,i):(o||function(e,t,i,n){var a;return null===i?a=new y:"string"==typeof i||t.objectMode||(a=new m("chunk",["string","Buffer"],i)),!a||(T(e,a),r.nextTick(n,a),!1)}(this,a,e,i))&&(a.pendingcb++,s=function(e,t,i,r,n,a){if(!i){var s=function(e,t,i){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=d.from(t,i)),t}(t,r,n);r!==s&&(i=!0,n="buffer",r=s)}var o=t.objectMode?1:r.length;t.length+=o;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var h=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:n,isBuf:i,callback:a,next:null},h?h.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else I(e,t,!1,o,r,n,a);return l}(this,a,o,e,t,i)),s},C.prototype.cork=function(){this._writableState.corked++},C.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||E(this,e))},C.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new S(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(C.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(C.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),C.prototype._write=function(e,t,i){i(new p("_write()"))},C.prototype._writev=null,C.prototype.end=function(e,t,i){var n=this._writableState;return"function"==typeof e?(i=e,e=null,t=null):"function"==typeof t&&(i=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||function(e,t,i){t.ending=!0,k(e,t),i&&(t.finished?r.nextTick(i):e.once("finish",i)),t.ended=!0,e.writable=!1}(this,n,i),this},Object.defineProperty(C.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(C.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),C.prototype.destroy=c.destroy,C.prototype._undestroy=c.undestroy,C.prototype._destroy=function(e,t){t(e)}}).call(this,i(55),i(48))},function(e,t,i){"use strict";e.exports=h;var r=i(104).codes,n=r.ERR_METHOD_NOT_IMPLEMENTED,a=r.ERR_MULTIPLE_CALLBACK,s=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=r.ERR_TRANSFORM_WITH_LENGTH_0,l=i(105);function d(e,t){var i=this._transformState;i.transforming=!1;var r=i.writecb;if(null===r)return this.emit("error",new a);i.writechunk=null,i.writecb=null,null!=t&&this.push(t),r(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function h(e){if(!(this instanceof h))return new h(e);l.call(this,e),this._transformState={afterTransform:d.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",c)}function c(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?u(this,null,null):this._flush((function(t,i){u(e,t,i)}))}function u(e,t,i){if(t)return e.emit("error",t);if(null!=i&&e.push(i),e._writableState.length)throw new o;if(e._transformState.transforming)throw new s;return e.push(null)}i(26)(h,l),h.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},h.prototype._transform=function(e,t,i){i(new n("_transform()"))},h.prototype._write=function(e,t,i){var r=this._transformState;if(r.writecb=i,r.writechunk=e,r.writeencoding=t,!r.transforming){var n=this._readableState;(r.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},h.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},h.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))}},function(e,t,i){var r=i(26),n=i(106),a=i(29).Buffer,s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=new Array(64);function l(){this.init(),this._w=o,n.call(this,64,56)}function d(e,t,i){return i^e&(t^i)}function h(e,t,i){return e&t|i&(e|t)}function c(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function u(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function f(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}r(l,n),l.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},l.prototype._update=function(e){for(var t,i=this._w,r=0|this._a,n=0|this._b,a=0|this._c,o=0|this._d,l=0|this._e,m=0|this._f,p=0|this._g,g=0|this._h,_=0;_<16;++_)i[_]=e.readInt32BE(4*_);for(;_<64;++_)i[_]=0|(((t=i[_-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+i[_-7]+f(i[_-15])+i[_-16];for(var v=0;v<64;++v){var y=g+u(l)+d(l,m,p)+s[v]+i[v]|0,b=c(r)+h(r,n,a)|0;g=p,p=m,m=l,l=o+y|0,o=a,a=n,n=r,r=y+b|0}this._a=r+this._a|0,this._b=n+this._b|0,this._c=a+this._c|0,this._d=o+this._d|0,this._e=l+this._e|0,this._f=m+this._f|0,this._g=p+this._g|0,this._h=g+this._h|0},l.prototype._hash=function(){var e=a.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=l},function(e,t,i){var r=i(26),n=i(106),a=i(29).Buffer,s=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],o=new Array(160);function l(){this.init(),this._w=o,n.call(this,128,112)}function d(e,t,i){return i^e&(t^i)}function h(e,t,i){return e&t|i&(e|t)}function c(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function u(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function f(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function m(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function p(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function g(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function _(e,t){return e>>>0<t>>>0?1:0}r(l,n),l.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},l.prototype._update=function(e){for(var t=this._w,i=0|this._ah,r=0|this._bh,n=0|this._ch,a=0|this._dh,o=0|this._eh,l=0|this._fh,v=0|this._gh,y=0|this._hh,b=0|this._al,S=0|this._bl,T=0|this._cl,w=0|this._dl,M=0|this._el,C=0|this._fl,I=0|this._gl,P=0|this._hl,E=0;E<32;E+=2)t[E]=e.readInt32BE(4*E),t[E+1]=e.readInt32BE(4*E+4);for(;E<160;E+=2){var x=t[E-30],A=t[E-30+1],k=f(x,A),R=m(A,x),O=p(x=t[E-4],A=t[E-4+1]),L=g(A,x),F=t[E-14],D=t[E-14+1],B=t[E-32],N=t[E-32+1],V=R+D|0,U=k+F+_(V,R)|0;U=(U=U+O+_(V=V+L|0,L)|0)+B+_(V=V+N|0,N)|0,t[E]=U,t[E+1]=V}for(var W=0;W<160;W+=2){U=t[W],V=t[W+1];var z=h(i,r,n),G=h(b,S,T),j=c(i,b),H=c(b,i),q=u(o,M),$=u(M,o),Z=s[W],X=s[W+1],Y=d(o,l,v),J=d(M,C,I),K=P+$|0,Q=y+q+_(K,P)|0;Q=(Q=(Q=Q+Y+_(K=K+J|0,J)|0)+Z+_(K=K+X|0,X)|0)+U+_(K=K+V|0,V)|0;var ee=H+G|0,te=j+z+_(ee,H)|0;y=v,P=I,v=l,I=C,l=o,C=M,o=a+Q+_(M=w+K|0,w)|0,a=n,w=T,n=r,T=S,r=i,S=b,i=Q+te+_(b=K+ee|0,K)|0}this._al=this._al+b|0,this._bl=this._bl+S|0,this._cl=this._cl+T|0,this._dl=this._dl+w|0,this._el=this._el+M|0,this._fl=this._fl+C|0,this._gl=this._gl+I|0,this._hl=this._hl+P|0,this._ah=this._ah+i+_(this._al,b)|0,this._bh=this._bh+r+_(this._bl,S)|0,this._ch=this._ch+n+_(this._cl,T)|0,this._dh=this._dh+a+_(this._dl,w)|0,this._eh=this._eh+o+_(this._el,M)|0,this._fh=this._fh+l+_(this._fl,C)|0,this._gh=this._gh+v+_(this._gl,I)|0,this._hh=this._hh+y+_(this._hl,P)|0},l.prototype._hash=function(){var e=a.allocUnsafe(64);function t(t,i,r){e.writeInt32BE(t,r),e.writeInt32BE(i,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},e.exports=l},function(e,t,i){"use strict";(function(t,r){var n=i(127);e.exports=y;var a,s=i(176);y.ReadableState=v,i(31).EventEmitter;var o=function(e,t){return e.listeners(t).length},l=i(187),d=i(149).Buffer,h=t.Uint8Array||function(){},c=Object.create(i(117));c.inherits=i(26);var u=i(288),f=void 0;f=u&&u.debuglog?u.debuglog("stream"):function(){};var m,p=i(289),g=i(188);c.inherits(y,l);var _=["error","close","destroy","pause","resume"];function v(e,t){e=e||{};var r=t instanceof(a=a||i(97));this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,s=e.readableHighWaterMark,o=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r&&(s||0===s)?s:o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(m||(m=i(96).StringDecoder),this.decoder=new m(e.encoding),this.encoding=e.encoding)}function y(e){if(a=a||i(97),!(this instanceof y))return new y(e);this._readableState=new v(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),l.call(this)}function b(e,t,i,r,n){var a,s=e._readableState;return null===t?(s.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,w(e)}}(e,s)):(n||(a=function(e,t){var i,r;return r=t,d.isBuffer(r)||r instanceof h||"string"==typeof t||void 0===t||e.objectMode||(i=new TypeError("Invalid non-string/buffer chunk")),i}(s,t)),a?e.emit("error",a):s.objectMode||t&&t.length>0?("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===d.prototype||(t=function(e){return d.from(e)}(t)),r?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):S(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!i?(t=s.decoder.write(t),s.objectMode||0!==t.length?S(e,s,t,!1):C(e,s)):S(e,s,t,!1))):r||(s.reading=!1)),function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(s)}function S(e,t,i,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",i),e.read(0)):(t.length+=t.objectMode?1:i.length,r?t.buffer.unshift(i):t.buffer.push(i),t.needReadable&&w(e)),C(e,t)}function T(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=8388608?e=8388608:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function w(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?n.nextTick(M,e):M(e))}function M(e){f("emit readable"),e.emit("readable"),x(e)}function C(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(I,e,t))}function I(e,t){for(var i=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),i!==t.length);)i=t.length;t.readingMore=!1}function P(e){f("readable nexttick read 0"),e.read(0)}function E(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),x(e),t.flowing&&!t.reading&&e.read(0)}function x(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function A(e,t){return 0===t.length?null:(t.objectMode?i=t.buffer.shift():!e||e>=t.length?(i=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):i=function(e,t,i){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():i?function(e,t){var i=t.head,r=1,n=i.data;for(e-=n.length;i=i.next;){var a=i.data,s=e>a.length?a.length:e;if(s===a.length?n+=a:n+=a.slice(0,e),0==(e-=s)){s===a.length?(++r,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=a.slice(s));break}++r}return t.length-=r,n}(e,t):function(e,t){var i=d.allocUnsafe(e),r=t.head,n=1;for(r.data.copy(i),e-=r.data.length;r=r.next;){var a=r.data,s=e>a.length?a.length:e;if(a.copy(i,i.length-e,0,s),0==(e-=s)){s===a.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=a.slice(s));break}++n}return t.length-=n,i}(e,t),r}(e,t.buffer,t.decoder),i);var i}function k(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,n.nextTick(R,t,e))}function R(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function O(e,t){for(var i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1}Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),y.prototype.destroy=g.destroy,y.prototype._undestroy=g.undestroy,y.prototype._destroy=function(e,t){this.push(null),t(e)},y.prototype.push=function(e,t){var i,r=this._readableState;return r.objectMode?i=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=d.from(e,t),t=""),i=!0),b(this,e,t,!1,i)},y.prototype.unshift=function(e){return b(this,e,null,!0,!1)},y.prototype.isPaused=function(){return!1===this._readableState.flowing},y.prototype.setEncoding=function(e){return m||(m=i(96).StringDecoder),this._readableState.decoder=new m(e),this._readableState.encoding=e,this},y.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,i=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?k(this):w(this),null;if(0===(e=T(e,t))&&t.ended)return 0===t.length&&k(this),null;var r,n=t.needReadable;return f("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",n=!0),t.ended||t.reading?f("reading or ended",n=!1):n&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=T(i,t))),null===(r=e>0?A(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),i!==e&&t.ended&&k(this)),null!==r&&this.emit("data",r),r},y.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},y.prototype.pipe=function(e,t){var i=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,f("pipe count=%d opts=%j",a.pipesCount,t);var l=t&&!1===t.end||e===r.stdout||e===r.stderr?v:d;function d(){f("onend"),e.end()}a.endEmitted?n.nextTick(l):i.once("end",l),e.on("unpipe",(function t(r,n){f("onunpipe"),r===i&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,f("cleanup"),e.removeListener("close",g),e.removeListener("finish",_),e.removeListener("drain",h),e.removeListener("error",p),e.removeListener("unpipe",t),i.removeListener("end",d),i.removeListener("end",v),i.removeListener("data",m),c=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||h())}));var h=function(e){return function(){var t=e._readableState;f("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,x(e))}}(i);e.on("drain",h);var c=!1,u=!1;function m(t){f("ondata"),u=!1,!1!==e.write(t)||u||((1===a.pipesCount&&a.pipes===e||a.pipesCount>1&&-1!==O(a.pipes,e))&&!c&&(f("false write response, pause",i._readableState.awaitDrain),i._readableState.awaitDrain++,u=!0),i.pause())}function p(t){f("onerror",t),v(),e.removeListener("error",p),0===o(e,"error")&&e.emit("error",t)}function g(){e.removeListener("finish",_),v()}function _(){f("onfinish"),e.removeListener("close",g),v()}function v(){f("unpipe"),i.unpipe(e)}return i.on("data",m),function(e,t,i){if("function"==typeof e.prependListener)return e.prependListener(t,i);e._events&&e._events[t]?s(e._events[t])?e._events[t].unshift(i):e._events[t]=[i,e._events[t]]:e.on(t,i)}(e,"error",p),e.once("close",g),e.once("finish",_),e.emit("pipe",i),a.flowing||(f("pipe resume"),i.resume()),e},y.prototype.unpipe=function(e){var t=this._readableState,i={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,i)),this;if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<n;a++)r[a].emit("unpipe",this,i);return this}var s=O(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,i)),this},y.prototype.on=function(e,t){var i=l.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&w(this):n.nextTick(P,this))}return i},y.prototype.addListener=y.prototype.on,y.prototype.resume=function(){var e=this._readableState;return e.flowing||(f("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(E,e,t))}(this,e)),this},y.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},y.prototype.wrap=function(e){var t=this,i=this._readableState,r=!1;for(var n in e.on("end",(function(){if(f("wrapped end"),i.decoder&&!i.ended){var e=i.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(n){f("wrapped data"),i.decoder&&(n=i.decoder.write(n)),i.objectMode&&null==n||(i.objectMode||n&&n.length)&&(t.push(n)||(r=!0,e.pause()))})),e)void 0===this[n]&&"function"==typeof e[n]&&(this[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n));for(var a=0;a<_.length;a++)e.on(_[a],this.emit.bind(this,_[a]));return this._read=function(t){f("wrapped _read",t),r&&(r=!1,e.resume())},this},Object.defineProperty(y.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),y._fromList=A}).call(this,i(55),i(48))},function(e,t,i){e.exports=i(31).EventEmitter},function(e,t,i){"use strict";var r=i(127);function n(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var i=this,a=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return a||s?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||r.nextTick(n,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(r.nextTick(n,i,e),i._writableState&&(i._writableState.errorEmitted=!0)):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,i){"use strict";e.exports=s;var r=i(97),n=Object.create(i(117));function a(e,t){var i=this._transformState;i.transforming=!1;var r=i.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,i.writecb=null,null!=t&&this.push(t),r(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function s(e){if(!(this instanceof s))return new s(e);r.call(this,e),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",o)}function o(){var e=this;"function"==typeof this._flush?this._flush((function(t,i){l(e,t,i)})):l(this,null,null)}function l(e,t,i){if(t)return e.emit("error",t);if(null!=i&&e.push(i),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}n.inherits=i(26),n.inherits(s,r),s.prototype.push=function(e,t){return this._transformState.needTransform=!1,r.prototype.push.call(this,e,t)},s.prototype._transform=function(e,t,i){throw new Error("_transform() is not implemented")},s.prototype._write=function(e,t,i){var r=this._transformState;if(r.writecb=i,r.writechunk=e,r.writeencoding=t,!r.transforming){var n=this._readableState;(r.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},s.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},s.prototype._destroy=function(e,t){var i=this;r.prototype._destroy.call(this,e,(function(e){t(e),i.emit("close")}))}},function(e,t,i){"use strict";var r=i(26),n=i(296),a=i(90),s=i(29).Buffer,o=i(191),l=i(147),d=i(114),h=s.alloc(128);function c(e,t){a.call(this,"digest"),"string"==typeof t&&(t=s.from(t));var i="sha512"===e||"sha384"===e?128:64;this._alg=e,this._key=t,t.length>i?t=("rmd160"===e?new l:d(e)).update(t).digest():t.length<i&&(t=s.concat([t,h],i));for(var r=this._ipad=s.allocUnsafe(i),n=this._opad=s.allocUnsafe(i),o=0;o<i;o++)r[o]=54^t[o],n[o]=92^t[o];this._hash="rmd160"===e?new l:d(e),this._hash.update(r)}r(c,a),c.prototype._update=function(e){this._hash.update(e)},c.prototype._final=function(){var e=this._hash.digest();return("rmd160"===this._alg?new l:d(this._alg)).update(this._opad).update(e).digest()},e.exports=function(e,t){return"rmd160"===(e=e.toLowerCase())||"ripemd160"===e?new c("rmd160",t):"md5"===e?new n(o,t):new c(e,t)}},function(e,t,i){var r=i(144);e.exports=function(e){return(new r).update(e).digest()}},function(e){e.exports=JSON.parse('{"sha224WithRSAEncryption":{"sign":"rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"RSA-SHA224":{"sign":"ecdsa/rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"sha256WithRSAEncryption":{"sign":"rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"RSA-SHA256":{"sign":"ecdsa/rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"sha384WithRSAEncryption":{"sign":"rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"RSA-SHA384":{"sign":"ecdsa/rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"sha512WithRSAEncryption":{"sign":"rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA512":{"sign":"ecdsa/rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA1":{"sign":"rsa","hash":"sha1","id":"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{"sign":"ecdsa","hash":"sha1","id":""},"sha256":{"sign":"ecdsa","hash":"sha256","id":""},"sha224":{"sign":"ecdsa","hash":"sha224","id":""},"sha384":{"sign":"ecdsa","hash":"sha384","id":""},"sha512":{"sign":"ecdsa","hash":"sha512","id":""},"DSA-SHA":{"sign":"dsa","hash":"sha1","id":""},"DSA-SHA1":{"sign":"dsa","hash":"sha1","id":""},"DSA":{"sign":"dsa","hash":"sha1","id":""},"DSA-WITH-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-WITH-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-WITH-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-WITH-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-RIPEMD160":{"sign":"dsa","hash":"rmd160","id":""},"ripemd160WithRSA":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"RSA-RIPEMD160":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"md5WithRSAEncryption":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"},"RSA-MD5":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"}}')},function(e,t,i){t.pbkdf2=i(298),t.pbkdf2Sync=i(196)},function(e,t){var i=Math.pow(2,30)-1;e.exports=function(e,t){if("number"!=typeof e)throw new TypeError("Iterations not a number");if(e<0)throw new TypeError("Bad iterations");if("number"!=typeof t)throw new TypeError("Key length not a number");if(t<0||t>i||t!=t)throw new TypeError("Bad key length")}},function(e,t,i){(function(t){var i;i=t.browser?"utf-8":t.version?parseInt(t.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":"utf-8",e.exports=i}).call(this,i(48))},function(e,t,i){var r=i(191),n=i(147),a=i(114),s=i(29).Buffer,o=i(194),l=i(195),d=i(197),h=s.alloc(128),c={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function u(e,t,i){var o=function(e){return"rmd160"===e||"ripemd160"===e?function(e){return(new n).update(e).digest()}:"md5"===e?r:function(t){return a(e).update(t).digest()}}(e),l="sha512"===e||"sha384"===e?128:64;t.length>l?t=o(t):t.length<l&&(t=s.concat([t,h],l));for(var d=s.allocUnsafe(l+c[e]),u=s.allocUnsafe(l+c[e]),f=0;f<l;f++)d[f]=54^t[f],u[f]=92^t[f];var m=s.allocUnsafe(l+i+4);d.copy(m,0,0,l),this.ipad1=m,this.ipad2=d,this.opad=u,this.alg=e,this.blocksize=l,this.hash=o,this.size=c[e]}u.prototype.run=function(e,t){return e.copy(t,this.blocksize),this.hash(t).copy(this.opad,this.blocksize),this.hash(this.opad)},e.exports=function(e,t,i,r,n){o(i,r);var a=new u(n=n||"sha1",e=d(e,l,"Password"),(t=d(t,l,"Salt")).length),h=s.allocUnsafe(r),f=s.allocUnsafe(t.length+4);t.copy(f,0,0,t.length);for(var m=0,p=c[n],g=Math.ceil(r/p),_=1;_<=g;_++){f.writeUInt32BE(_,t.length);for(var v=a.run(f,a.ipad1),y=v,b=1;b<i;b++){y=a.run(y,a.ipad2);for(var S=0;S<p;S++)v[S]^=y[S]}v.copy(h,m),m+=p}return h}},function(e,t,i){var r=i(29).Buffer;e.exports=function(e,t,i){if(r.isBuffer(e))return e;if("string"==typeof e)return r.from(e,t);if(ArrayBuffer.isView(e))return r.from(e.buffer);throw new TypeError(i+" must be a string, a Buffer, a typed array or a DataView")}},function(e,t,i){"use strict";t.readUInt32BE=function(e,t){return(e[0+t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t])>>>0},t.writeUInt32BE=function(e,t,i){e[0+i]=t>>>24,e[1+i]=t>>>16&255,e[2+i]=t>>>8&255,e[3+i]=255&t},t.ip=function(e,t,i,r){for(var n=0,a=0,s=6;s>=0;s-=2){for(var o=0;o<=24;o+=8)n<<=1,n|=t>>>o+s&1;for(o=0;o<=24;o+=8)n<<=1,n|=e>>>o+s&1}for(s=6;s>=0;s-=2){for(o=1;o<=25;o+=8)a<<=1,a|=t>>>o+s&1;for(o=1;o<=25;o+=8)a<<=1,a|=e>>>o+s&1}i[r+0]=n>>>0,i[r+1]=a>>>0},t.rip=function(e,t,i,r){for(var n=0,a=0,s=0;s<4;s++)for(var o=24;o>=0;o-=8)n<<=1,n|=t>>>o+s&1,n<<=1,n|=e>>>o+s&1;for(s=4;s<8;s++)for(o=24;o>=0;o-=8)a<<=1,a|=t>>>o+s&1,a<<=1,a|=e>>>o+s&1;i[r+0]=n>>>0,i[r+1]=a>>>0},t.pc1=function(e,t,i,r){for(var n=0,a=0,s=7;s>=5;s--){for(var o=0;o<=24;o+=8)n<<=1,n|=t>>o+s&1;for(o=0;o<=24;o+=8)n<<=1,n|=e>>o+s&1}for(o=0;o<=24;o+=8)n<<=1,n|=t>>o+s&1;for(s=1;s<=3;s++){for(o=0;o<=24;o+=8)a<<=1,a|=t>>o+s&1;for(o=0;o<=24;o+=8)a<<=1,a|=e>>o+s&1}for(o=0;o<=24;o+=8)a<<=1,a|=e>>o+s&1;i[r+0]=n>>>0,i[r+1]=a>>>0},t.r28shl=function(e,t){return e<<t&268435455|e>>>28-t};var r=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];t.pc2=function(e,t,i,n){for(var a=0,s=0,o=r.length>>>1,l=0;l<o;l++)a<<=1,a|=e>>>r[l]&1;for(l=o;l<r.length;l++)s<<=1,s|=t>>>r[l]&1;i[n+0]=a>>>0,i[n+1]=s>>>0},t.expand=function(e,t,i){var r=0,n=0;r=(1&e)<<5|e>>>27;for(var a=23;a>=15;a-=4)r<<=6,r|=e>>>a&63;for(a=11;a>=3;a-=4)n|=e>>>a&63,n<<=6;n|=(31&e)<<1|e>>>31,t[i+0]=r>>>0,t[i+1]=n>>>0};var n=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];t.substitute=function(e,t){for(var i=0,r=0;r<4;r++)i<<=4,i|=n[64*r+(e>>>18-6*r&63)];for(r=0;r<4;r++)i<<=4,i|=n[256+64*r+(t>>>18-6*r&63)];return i>>>0};var a=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];t.permute=function(e){for(var t=0,i=0;i<a.length;i++)t<<=1,t|=e>>>a[i]&1;return t>>>0},t.padSplit=function(e,t,i){for(var r=e.toString(2);r.length<t;)r="0"+r;for(var n=[],a=0;a<t;a+=i)n.push(r.slice(a,a+i));return n.join(" ")}},function(e,t,i){"use strict";var r=i(65),n=i(26),a=i(198),s=i(151);function o(){this.tmp=new Array(2),this.keys=null}function l(e){s.call(this,e);var t=new o;this._desState=t,this.deriveKeys(t,e.key)}n(l,s),e.exports=l,l.create=function(e){return new l(e)};var d=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];l.prototype.deriveKeys=function(e,t){e.keys=new Array(32),r.equal(t.length,this.blockSize,"Invalid key length");var i=a.readUInt32BE(t,0),n=a.readUInt32BE(t,4);a.pc1(i,n,e.tmp,0),i=e.tmp[0],n=e.tmp[1];for(var s=0;s<e.keys.length;s+=2){var o=d[s>>>1];i=a.r28shl(i,o),n=a.r28shl(n,o),a.pc2(i,n,e.keys,s)}},l.prototype._update=function(e,t,i,r){var n=this._desState,s=a.readUInt32BE(e,t),o=a.readUInt32BE(e,t+4);a.ip(s,o,n.tmp,0),s=n.tmp[0],o=n.tmp[1],"encrypt"===this.type?this._encrypt(n,s,o,n.tmp,0):this._decrypt(n,s,o,n.tmp,0),s=n.tmp[0],o=n.tmp[1],a.writeUInt32BE(i,s,r),a.writeUInt32BE(i,o,r+4)},l.prototype._pad=function(e,t){for(var i=e.length-t,r=t;r<e.length;r++)e[r]=i;return!0},l.prototype._unpad=function(e){for(var t=e[e.length-1],i=e.length-t;i<e.length;i++)r.equal(e[i],t);return e.slice(0,e.length-t)},l.prototype._encrypt=function(e,t,i,r,n){for(var s=t,o=i,l=0;l<e.keys.length;l+=2){var d=e.keys[l],h=e.keys[l+1];a.expand(o,e.tmp,0),d^=e.tmp[0],h^=e.tmp[1];var c=a.substitute(d,h),u=o;o=(s^a.permute(c))>>>0,s=u}a.rip(o,s,r,n)},l.prototype._decrypt=function(e,t,i,r,n){for(var s=i,o=t,l=e.keys.length-2;l>=0;l-=2){var d=e.keys[l],h=e.keys[l+1];a.expand(s,e.tmp,0),d^=e.tmp[0],h^=e.tmp[1];var c=a.substitute(d,h),u=s;s=(o^a.permute(c))>>>0,o=u}a.rip(s,o,r,n)}},function(e,t,i){var r=i(118),n=i(29).Buffer,a=i(201);function s(e){var t=e._cipher.encryptBlockRaw(e._prev);return a(e._prev),t}t.encrypt=function(e,t){var i=Math.ceil(t.length/16),a=e._cache.length;e._cache=n.concat([e._cache,n.allocUnsafe(16*i)]);for(var o=0;o<i;o++){var l=s(e),d=a+16*o;e._cache.writeUInt32BE(l[0],d+0),e._cache.writeUInt32BE(l[1],d+4),e._cache.writeUInt32BE(l[2],d+8),e._cache.writeUInt32BE(l[3],d+12)}var h=e._cache.slice(0,t.length);return e._cache=e._cache.slice(t.length),r(t,h)}},function(e,t){e.exports=function(e){for(var t,i=e.length;i--;){if(255!==(t=e.readUInt8(i))){t++,e.writeUInt8(t,i);break}e.writeUInt8(0,i)}}},function(e){e.exports=JSON.parse('{"aes-128-ecb":{"cipher":"AES","key":128,"iv":0,"mode":"ECB","type":"block"},"aes-192-ecb":{"cipher":"AES","key":192,"iv":0,"mode":"ECB","type":"block"},"aes-256-ecb":{"cipher":"AES","key":256,"iv":0,"mode":"ECB","type":"block"},"aes-128-cbc":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes-192-cbc":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes-256-cbc":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes128":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes192":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes256":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes-128-cfb":{"cipher":"AES","key":128,"iv":16,"mode":"CFB","type":"stream"},"aes-192-cfb":{"cipher":"AES","key":192,"iv":16,"mode":"CFB","type":"stream"},"aes-256-cfb":{"cipher":"AES","key":256,"iv":16,"mode":"CFB","type":"stream"},"aes-128-cfb8":{"cipher":"AES","key":128,"iv":16,"mode":"CFB8","type":"stream"},"aes-192-cfb8":{"cipher":"AES","key":192,"iv":16,"mode":"CFB8","type":"stream"},"aes-256-cfb8":{"cipher":"AES","key":256,"iv":16,"mode":"CFB8","type":"stream"},"aes-128-cfb1":{"cipher":"AES","key":128,"iv":16,"mode":"CFB1","type":"stream"},"aes-192-cfb1":{"cipher":"AES","key":192,"iv":16,"mode":"CFB1","type":"stream"},"aes-256-cfb1":{"cipher":"AES","key":256,"iv":16,"mode":"CFB1","type":"stream"},"aes-128-ofb":{"cipher":"AES","key":128,"iv":16,"mode":"OFB","type":"stream"},"aes-192-ofb":{"cipher":"AES","key":192,"iv":16,"mode":"OFB","type":"stream"},"aes-256-ofb":{"cipher":"AES","key":256,"iv":16,"mode":"OFB","type":"stream"},"aes-128-ctr":{"cipher":"AES","key":128,"iv":16,"mode":"CTR","type":"stream"},"aes-192-ctr":{"cipher":"AES","key":192,"iv":16,"mode":"CTR","type":"stream"},"aes-256-ctr":{"cipher":"AES","key":256,"iv":16,"mode":"CTR","type":"stream"},"aes-128-gcm":{"cipher":"AES","key":128,"iv":12,"mode":"GCM","type":"auth"},"aes-192-gcm":{"cipher":"AES","key":192,"iv":12,"mode":"GCM","type":"auth"},"aes-256-gcm":{"cipher":"AES","key":256,"iv":12,"mode":"GCM","type":"auth"}}')},function(e,t,i){var r=i(128),n=i(29).Buffer,a=i(90),s=i(26),o=i(311),l=i(118),d=i(201);function h(e,t,i,s){a.call(this);var l=n.alloc(4,0);this._cipher=new r.AES(t);var h=this._cipher.encryptBlock(l);this._ghash=new o(h),i=function(e,t,i){if(12===t.length)return e._finID=n.concat([t,n.from([0,0,0,1])]),n.concat([t,n.from([0,0,0,2])]);var r=new o(i),a=t.length,s=a%16;r.update(t),s&&(s=16-s,r.update(n.alloc(s,0))),r.update(n.alloc(8,0));var l=8*a,h=n.alloc(8);h.writeUIntBE(l,0,8),r.update(h),e._finID=r.state;var c=n.from(e._finID);return d(c),c}(this,i,h),this._prev=n.from(i),this._cache=n.allocUnsafe(0),this._secCache=n.allocUnsafe(0),this._decrypt=s,this._alen=0,this._len=0,this._mode=e,this._authTag=null,this._called=!1}s(h,a),h.prototype._update=function(e){if(!this._called&&this._alen){var t=16-this._alen%16;t<16&&(t=n.alloc(t,0),this._ghash.update(t))}this._called=!0;var i=this._mode.encrypt(this,e);return this._decrypt?this._ghash.update(e):this._ghash.update(i),this._len+=e.length,i},h.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var e=l(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(e,t){var i=0;e.length!==t.length&&i++;for(var r=Math.min(e.length,t.length),n=0;n<r;++n)i+=e[n]^t[n];return i}(e,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=e,this._cipher.scrub()},h.prototype.getAuthTag=function(){if(this._decrypt||!n.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},h.prototype.setAuthTag=function(e){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=e},h.prototype.setAAD=function(e){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(e),this._alen+=e.length},e.exports=h},function(e,t,i){var r=i(128),n=i(29).Buffer,a=i(90);function s(e,t,i,s){a.call(this),this._cipher=new r.AES(t),this._prev=n.from(i),this._cache=n.allocUnsafe(0),this._secCache=n.allocUnsafe(0),this._decrypt=s,this._mode=e}i(26)(s,a),s.prototype._update=function(e){return this._mode.encrypt(this,e,this._decrypt)},s.prototype._final=function(){this._cipher.scrub()},e.exports=s},function(e,t,i){var r=i(103);e.exports=_,_.simpleSieve=p,_.fermatTest=g;var n=i(206),a=new n(24),s=new(i(207)),o=new n(1),l=new n(2),d=new n(5),h=(new n(16),new n(8),new n(10)),c=new n(3),u=(new n(7),new n(11)),f=new n(4),m=(new n(12),null);function p(e){for(var t=function(){if(null!==m)return m;var e=[];e[0]=2;for(var t=1,i=3;i<1048576;i+=2){for(var r=Math.ceil(Math.sqrt(i)),n=0;n<t&&e[n]<=r&&i%e[n]!=0;n++);t!==n&&e[n]<=r||(e[t++]=i)}return m=e,e}(),i=0;i<t.length;i++)if(0===e.modn(t[i]))return 0===e.cmpn(t[i]);return!0}function g(e){var t=n.mont(e);return 0===l.toRed(t).redPow(e.subn(1)).fromRed().cmpn(1)}function _(e,t){if(e<16)return new n(2===t||5===t?[140,123]:[140,39]);var i,m;for(t=new n(t);;){for(i=new n(r(Math.ceil(e/8)));i.bitLength()>e;)i.ishrn(1);if(i.isEven()&&i.iadd(o),i.testn(1)||i.iadd(l),t.cmp(l)){if(!t.cmp(d))for(;i.mod(h).cmp(c);)i.iadd(f)}else for(;i.mod(a).cmp(u);)i.iadd(f);if(p(m=i.shrn(1))&&p(i)&&g(m)&&g(i)&&s.test(m)&&s.test(i))return i}}},function(e,t,i){(function(e){!function(e,t){"use strict";function r(e,t){if(!e)throw new Error(t||"Assertion failed")}function n(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function a(e,t,i){if(a.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(i=t,t=10),this._init(e||0,t||10,i||"be"))}var s;"object"==typeof e?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;try{s=i(315).Buffer}catch(e){}function o(e,t,i){for(var r=0,n=Math.min(e.length,i),a=t;a<n;a++){var s=e.charCodeAt(a)-48;r<<=4,r|=s>=49&&s<=54?s-49+10:s>=17&&s<=22?s-17+10:15&s}return r}function l(e,t,i,r){for(var n=0,a=Math.min(e.length,i),s=t;s<a;s++){var o=e.charCodeAt(s)-48;n*=r,n+=o>=49?o-49+10:o>=17?o-17+10:o}return n}a.isBN=function(e){return e instanceof a||null!==e&&"object"==typeof e&&e.constructor.wordSize===a.wordSize&&Array.isArray(e.words)},a.max=function(e,t){return e.cmp(t)>0?e:t},a.min=function(e,t){return e.cmp(t)<0?e:t},a.prototype._init=function(e,t,i){if("number"==typeof e)return this._initNumber(e,t,i);if("object"==typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36);var n=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&n++,16===t?this._parseHex(e,n):this._parseBase(e,t,n),"-"===e[0]&&(this.negative=1),this.strip(),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(r(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initArray=function(e,t,i){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var a,s,o=0;if("be"===i)for(n=e.length-1,a=0;n>=0;n-=3)s=e[n]|e[n-1]<<8|e[n-2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);else if("le"===i)for(n=0,a=0;n<e.length;n+=3)s=e[n]|e[n+1]<<8|e[n+2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);return this.strip()},a.prototype._parseHex=function(e,t){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var r,n,a=0;for(i=e.length-6,r=0;i>=t;i-=6)n=o(e,i,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303,(a+=24)>=26&&(a-=26,r++);i+6!==t&&(n=o(e,t,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303),this.strip()},a.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var r=0,n=1;n<=67108863;n*=t)r++;r--,n=n/t|0;for(var a=e.length-i,s=a%r,o=Math.min(a,a-s)+i,d=0,h=i;h<o;h+=r)d=l(e,h,h+r,t),this.imuln(n),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d);if(0!==s){var c=1;for(d=l(e,h,e.length,t),h=0;h<s;h++)c*=t;this.imuln(c),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d)}},a.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},a.prototype.clone=function(){var e=new a(null);return this.copy(e),e},a.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},a.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],c=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function u(e,t,i){i.negative=t.negative^e.negative;var r=e.length+t.length|0;i.length=r,r=r-1|0;var n=0|e.words[0],a=0|t.words[0],s=n*a,o=67108863&s,l=s/67108864|0;i.words[0]=o;for(var d=1;d<r;d++){for(var h=l>>>26,c=67108863&l,u=Math.min(d,t.length-1),f=Math.max(0,d-e.length+1);f<=u;f++){var m=d-f|0;h+=(s=(n=0|e.words[m])*(a=0|t.words[f])+c)/67108864|0,c=67108863&s}i.words[d]=0|c,l=0|h}return 0!==l?i.words[d]=0|l:i.length--,i.strip()}a.prototype.toString=function(e,t){var i;if(t=0|t||1,16===(e=e||10)||"hex"===e){i="";for(var n=0,a=0,s=0;s<this.length;s++){var o=this.words[s],l=(16777215&(o<<n|a)).toString(16);i=0!=(a=o>>>24-n&16777215)||s!==this.length-1?d[6-l.length]+l+i:l+i,(n+=2)>=26&&(n-=26,s--)}for(0!==a&&(i=a.toString(16)+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var u=h[e],f=c[e];i="";var m=this.clone();for(m.negative=0;!m.isZero();){var p=m.modn(f).toString(e);i=(m=m.idivn(f)).isZero()?p+i:d[u-p.length]+p+i}for(this.isZero()&&(i="0"+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(e,t){return r(void 0!==s),this.toArrayLike(s,e,t)},a.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},a.prototype.toArrayLike=function(e,t,i){var n=this.byteLength(),a=i||Math.max(1,n);r(n<=a,"byte array longer than desired length"),r(a>0,"Requested array length <= 0"),this.strip();var s,o,l="le"===t,d=new e(a),h=this.clone();if(l){for(o=0;!h.isZero();o++)s=h.andln(255),h.iushrn(8),d[o]=s;for(;o<a;o++)d[o]=0}else{for(o=0;o<a-n;o++)d[o]=0;for(o=0;!h.isZero();o++)s=h.andln(255),h.iushrn(8),d[a-o-1]=s}return d},Math.clz32?a.prototype._countBits=function(e){return 32-Math.clz32(e)}:a.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},a.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return 0==(8191&t)&&(i+=13,t>>>=13),0==(127&t)&&(i+=7,t>>>=7),0==(15&t)&&(i+=4,t>>>=4),0==(3&t)&&(i+=2,t>>>=2),0==(1&t)&&i++,i},a.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},a.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return 0!==this.negative},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},a.prototype.ior=function(e){return r(0==(this.negative|e.negative)),this.iuor(e)},a.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},a.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},a.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this.strip()},a.prototype.iand=function(e){return r(0==(this.negative|e.negative)),this.iuand(e)},a.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},a.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},a.prototype.iuxor=function(e){var t,i;this.length>e.length?(t=this,i=e):(t=e,i=this);for(var r=0;r<i.length;r++)this.words[r]=t.words[r]^i.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this.strip()},a.prototype.ixor=function(e){return r(0==(this.negative|e.negative)),this.iuxor(e)},a.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},a.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},a.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var n=0;n<t;n++)this.words[n]=67108863&~this.words[n];return i>0&&(this.words[n]=~this.words[n]&67108863>>26-i),this.strip()},a.prototype.notn=function(e){return this.clone().inotn(e)},a.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var i=e/26|0,n=e%26;return this._expand(i+1),this.words[i]=t?this.words[i]|1<<n:this.words[i]&~(1<<n),this.strip()},a.prototype.iadd=function(e){var t,i,r;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,r=e):(i=e,r=this);for(var n=0,a=0;a<r.length;a++)t=(0|i.words[a])+(0|r.words[a])+n,this.words[a]=67108863&t,n=t>>>26;for(;0!==n&&a<i.length;a++)t=(0|i.words[a])+n,this.words[a]=67108863&t,n=t>>>26;if(this.length=i.length,0!==n)this.words[this.length]=n,this.length++;else if(i!==this)for(;a<i.length;a++)this.words[a]=i.words[a];return this},a.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},a.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var i,r,n=this.cmp(e);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(i=this,r=e):(i=e,r=this);for(var a=0,s=0;s<r.length;s++)a=(t=(0|i.words[s])-(0|r.words[s])+a)>>26,this.words[s]=67108863&t;for(;0!==a&&s<i.length;s++)a=(t=(0|i.words[s])+a)>>26,this.words[s]=67108863&t;if(0===a&&s<i.length&&i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this.length=Math.max(this.length,s),i!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(e){return this.clone().isub(e)};var f=function(e,t,i){var r,n,a,s=e.words,o=t.words,l=i.words,d=0,h=0|s[0],c=8191&h,u=h>>>13,f=0|s[1],m=8191&f,p=f>>>13,g=0|s[2],_=8191&g,v=g>>>13,y=0|s[3],b=8191&y,S=y>>>13,T=0|s[4],w=8191&T,M=T>>>13,C=0|s[5],I=8191&C,P=C>>>13,E=0|s[6],x=8191&E,A=E>>>13,k=0|s[7],R=8191&k,O=k>>>13,L=0|s[8],F=8191&L,D=L>>>13,B=0|s[9],N=8191&B,V=B>>>13,U=0|o[0],W=8191&U,z=U>>>13,G=0|o[1],j=8191&G,H=G>>>13,q=0|o[2],$=8191&q,Z=q>>>13,X=0|o[3],Y=8191&X,J=X>>>13,K=0|o[4],Q=8191&K,ee=K>>>13,te=0|o[5],ie=8191&te,re=te>>>13,ne=0|o[6],ae=8191&ne,se=ne>>>13,oe=0|o[7],le=8191&oe,de=oe>>>13,he=0|o[8],ce=8191&he,ue=he>>>13,fe=0|o[9],me=8191&fe,pe=fe>>>13;i.negative=e.negative^t.negative,i.length=19;var ge=(d+(r=Math.imul(c,W))|0)+((8191&(n=(n=Math.imul(c,z))+Math.imul(u,W)|0))<<13)|0;d=((a=Math.imul(u,z))+(n>>>13)|0)+(ge>>>26)|0,ge&=67108863,r=Math.imul(m,W),n=(n=Math.imul(m,z))+Math.imul(p,W)|0,a=Math.imul(p,z);var _e=(d+(r=r+Math.imul(c,j)|0)|0)+((8191&(n=(n=n+Math.imul(c,H)|0)+Math.imul(u,j)|0))<<13)|0;d=((a=a+Math.imul(u,H)|0)+(n>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(_,W),n=(n=Math.imul(_,z))+Math.imul(v,W)|0,a=Math.imul(v,z),r=r+Math.imul(m,j)|0,n=(n=n+Math.imul(m,H)|0)+Math.imul(p,j)|0,a=a+Math.imul(p,H)|0;var ve=(d+(r=r+Math.imul(c,$)|0)|0)+((8191&(n=(n=n+Math.imul(c,Z)|0)+Math.imul(u,$)|0))<<13)|0;d=((a=a+Math.imul(u,Z)|0)+(n>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(b,W),n=(n=Math.imul(b,z))+Math.imul(S,W)|0,a=Math.imul(S,z),r=r+Math.imul(_,j)|0,n=(n=n+Math.imul(_,H)|0)+Math.imul(v,j)|0,a=a+Math.imul(v,H)|0,r=r+Math.imul(m,$)|0,n=(n=n+Math.imul(m,Z)|0)+Math.imul(p,$)|0,a=a+Math.imul(p,Z)|0;var ye=(d+(r=r+Math.imul(c,Y)|0)|0)+((8191&(n=(n=n+Math.imul(c,J)|0)+Math.imul(u,Y)|0))<<13)|0;d=((a=a+Math.imul(u,J)|0)+(n>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(w,W),n=(n=Math.imul(w,z))+Math.imul(M,W)|0,a=Math.imul(M,z),r=r+Math.imul(b,j)|0,n=(n=n+Math.imul(b,H)|0)+Math.imul(S,j)|0,a=a+Math.imul(S,H)|0,r=r+Math.imul(_,$)|0,n=(n=n+Math.imul(_,Z)|0)+Math.imul(v,$)|0,a=a+Math.imul(v,Z)|0,r=r+Math.imul(m,Y)|0,n=(n=n+Math.imul(m,J)|0)+Math.imul(p,Y)|0,a=a+Math.imul(p,J)|0;var be=(d+(r=r+Math.imul(c,Q)|0)|0)+((8191&(n=(n=n+Math.imul(c,ee)|0)+Math.imul(u,Q)|0))<<13)|0;d=((a=a+Math.imul(u,ee)|0)+(n>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(I,W),n=(n=Math.imul(I,z))+Math.imul(P,W)|0,a=Math.imul(P,z),r=r+Math.imul(w,j)|0,n=(n=n+Math.imul(w,H)|0)+Math.imul(M,j)|0,a=a+Math.imul(M,H)|0,r=r+Math.imul(b,$)|0,n=(n=n+Math.imul(b,Z)|0)+Math.imul(S,$)|0,a=a+Math.imul(S,Z)|0,r=r+Math.imul(_,Y)|0,n=(n=n+Math.imul(_,J)|0)+Math.imul(v,Y)|0,a=a+Math.imul(v,J)|0,r=r+Math.imul(m,Q)|0,n=(n=n+Math.imul(m,ee)|0)+Math.imul(p,Q)|0,a=a+Math.imul(p,ee)|0;var Se=(d+(r=r+Math.imul(c,ie)|0)|0)+((8191&(n=(n=n+Math.imul(c,re)|0)+Math.imul(u,ie)|0))<<13)|0;d=((a=a+Math.imul(u,re)|0)+(n>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul(x,W),n=(n=Math.imul(x,z))+Math.imul(A,W)|0,a=Math.imul(A,z),r=r+Math.imul(I,j)|0,n=(n=n+Math.imul(I,H)|0)+Math.imul(P,j)|0,a=a+Math.imul(P,H)|0,r=r+Math.imul(w,$)|0,n=(n=n+Math.imul(w,Z)|0)+Math.imul(M,$)|0,a=a+Math.imul(M,Z)|0,r=r+Math.imul(b,Y)|0,n=(n=n+Math.imul(b,J)|0)+Math.imul(S,Y)|0,a=a+Math.imul(S,J)|0,r=r+Math.imul(_,Q)|0,n=(n=n+Math.imul(_,ee)|0)+Math.imul(v,Q)|0,a=a+Math.imul(v,ee)|0,r=r+Math.imul(m,ie)|0,n=(n=n+Math.imul(m,re)|0)+Math.imul(p,ie)|0,a=a+Math.imul(p,re)|0;var Te=(d+(r=r+Math.imul(c,ae)|0)|0)+((8191&(n=(n=n+Math.imul(c,se)|0)+Math.imul(u,ae)|0))<<13)|0;d=((a=a+Math.imul(u,se)|0)+(n>>>13)|0)+(Te>>>26)|0,Te&=67108863,r=Math.imul(R,W),n=(n=Math.imul(R,z))+Math.imul(O,W)|0,a=Math.imul(O,z),r=r+Math.imul(x,j)|0,n=(n=n+Math.imul(x,H)|0)+Math.imul(A,j)|0,a=a+Math.imul(A,H)|0,r=r+Math.imul(I,$)|0,n=(n=n+Math.imul(I,Z)|0)+Math.imul(P,$)|0,a=a+Math.imul(P,Z)|0,r=r+Math.imul(w,Y)|0,n=(n=n+Math.imul(w,J)|0)+Math.imul(M,Y)|0,a=a+Math.imul(M,J)|0,r=r+Math.imul(b,Q)|0,n=(n=n+Math.imul(b,ee)|0)+Math.imul(S,Q)|0,a=a+Math.imul(S,ee)|0,r=r+Math.imul(_,ie)|0,n=(n=n+Math.imul(_,re)|0)+Math.imul(v,ie)|0,a=a+Math.imul(v,re)|0,r=r+Math.imul(m,ae)|0,n=(n=n+Math.imul(m,se)|0)+Math.imul(p,ae)|0,a=a+Math.imul(p,se)|0;var we=(d+(r=r+Math.imul(c,le)|0)|0)+((8191&(n=(n=n+Math.imul(c,de)|0)+Math.imul(u,le)|0))<<13)|0;d=((a=a+Math.imul(u,de)|0)+(n>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(F,W),n=(n=Math.imul(F,z))+Math.imul(D,W)|0,a=Math.imul(D,z),r=r+Math.imul(R,j)|0,n=(n=n+Math.imul(R,H)|0)+Math.imul(O,j)|0,a=a+Math.imul(O,H)|0,r=r+Math.imul(x,$)|0,n=(n=n+Math.imul(x,Z)|0)+Math.imul(A,$)|0,a=a+Math.imul(A,Z)|0,r=r+Math.imul(I,Y)|0,n=(n=n+Math.imul(I,J)|0)+Math.imul(P,Y)|0,a=a+Math.imul(P,J)|0,r=r+Math.imul(w,Q)|0,n=(n=n+Math.imul(w,ee)|0)+Math.imul(M,Q)|0,a=a+Math.imul(M,ee)|0,r=r+Math.imul(b,ie)|0,n=(n=n+Math.imul(b,re)|0)+Math.imul(S,ie)|0,a=a+Math.imul(S,re)|0,r=r+Math.imul(_,ae)|0,n=(n=n+Math.imul(_,se)|0)+Math.imul(v,ae)|0,a=a+Math.imul(v,se)|0,r=r+Math.imul(m,le)|0,n=(n=n+Math.imul(m,de)|0)+Math.imul(p,le)|0,a=a+Math.imul(p,de)|0;var Me=(d+(r=r+Math.imul(c,ce)|0)|0)+((8191&(n=(n=n+Math.imul(c,ue)|0)+Math.imul(u,ce)|0))<<13)|0;d=((a=a+Math.imul(u,ue)|0)+(n>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul(N,W),n=(n=Math.imul(N,z))+Math.imul(V,W)|0,a=Math.imul(V,z),r=r+Math.imul(F,j)|0,n=(n=n+Math.imul(F,H)|0)+Math.imul(D,j)|0,a=a+Math.imul(D,H)|0,r=r+Math.imul(R,$)|0,n=(n=n+Math.imul(R,Z)|0)+Math.imul(O,$)|0,a=a+Math.imul(O,Z)|0,r=r+Math.imul(x,Y)|0,n=(n=n+Math.imul(x,J)|0)+Math.imul(A,Y)|0,a=a+Math.imul(A,J)|0,r=r+Math.imul(I,Q)|0,n=(n=n+Math.imul(I,ee)|0)+Math.imul(P,Q)|0,a=a+Math.imul(P,ee)|0,r=r+Math.imul(w,ie)|0,n=(n=n+Math.imul(w,re)|0)+Math.imul(M,ie)|0,a=a+Math.imul(M,re)|0,r=r+Math.imul(b,ae)|0,n=(n=n+Math.imul(b,se)|0)+Math.imul(S,ae)|0,a=a+Math.imul(S,se)|0,r=r+Math.imul(_,le)|0,n=(n=n+Math.imul(_,de)|0)+Math.imul(v,le)|0,a=a+Math.imul(v,de)|0,r=r+Math.imul(m,ce)|0,n=(n=n+Math.imul(m,ue)|0)+Math.imul(p,ce)|0,a=a+Math.imul(p,ue)|0;var Ce=(d+(r=r+Math.imul(c,me)|0)|0)+((8191&(n=(n=n+Math.imul(c,pe)|0)+Math.imul(u,me)|0))<<13)|0;d=((a=a+Math.imul(u,pe)|0)+(n>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,r=Math.imul(N,j),n=(n=Math.imul(N,H))+Math.imul(V,j)|0,a=Math.imul(V,H),r=r+Math.imul(F,$)|0,n=(n=n+Math.imul(F,Z)|0)+Math.imul(D,$)|0,a=a+Math.imul(D,Z)|0,r=r+Math.imul(R,Y)|0,n=(n=n+Math.imul(R,J)|0)+Math.imul(O,Y)|0,a=a+Math.imul(O,J)|0,r=r+Math.imul(x,Q)|0,n=(n=n+Math.imul(x,ee)|0)+Math.imul(A,Q)|0,a=a+Math.imul(A,ee)|0,r=r+Math.imul(I,ie)|0,n=(n=n+Math.imul(I,re)|0)+Math.imul(P,ie)|0,a=a+Math.imul(P,re)|0,r=r+Math.imul(w,ae)|0,n=(n=n+Math.imul(w,se)|0)+Math.imul(M,ae)|0,a=a+Math.imul(M,se)|0,r=r+Math.imul(b,le)|0,n=(n=n+Math.imul(b,de)|0)+Math.imul(S,le)|0,a=a+Math.imul(S,de)|0,r=r+Math.imul(_,ce)|0,n=(n=n+Math.imul(_,ue)|0)+Math.imul(v,ce)|0,a=a+Math.imul(v,ue)|0;var Ie=(d+(r=r+Math.imul(m,me)|0)|0)+((8191&(n=(n=n+Math.imul(m,pe)|0)+Math.imul(p,me)|0))<<13)|0;d=((a=a+Math.imul(p,pe)|0)+(n>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,r=Math.imul(N,$),n=(n=Math.imul(N,Z))+Math.imul(V,$)|0,a=Math.imul(V,Z),r=r+Math.imul(F,Y)|0,n=(n=n+Math.imul(F,J)|0)+Math.imul(D,Y)|0,a=a+Math.imul(D,J)|0,r=r+Math.imul(R,Q)|0,n=(n=n+Math.imul(R,ee)|0)+Math.imul(O,Q)|0,a=a+Math.imul(O,ee)|0,r=r+Math.imul(x,ie)|0,n=(n=n+Math.imul(x,re)|0)+Math.imul(A,ie)|0,a=a+Math.imul(A,re)|0,r=r+Math.imul(I,ae)|0,n=(n=n+Math.imul(I,se)|0)+Math.imul(P,ae)|0,a=a+Math.imul(P,se)|0,r=r+Math.imul(w,le)|0,n=(n=n+Math.imul(w,de)|0)+Math.imul(M,le)|0,a=a+Math.imul(M,de)|0,r=r+Math.imul(b,ce)|0,n=(n=n+Math.imul(b,ue)|0)+Math.imul(S,ce)|0,a=a+Math.imul(S,ue)|0;var Pe=(d+(r=r+Math.imul(_,me)|0)|0)+((8191&(n=(n=n+Math.imul(_,pe)|0)+Math.imul(v,me)|0))<<13)|0;d=((a=a+Math.imul(v,pe)|0)+(n>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,r=Math.imul(N,Y),n=(n=Math.imul(N,J))+Math.imul(V,Y)|0,a=Math.imul(V,J),r=r+Math.imul(F,Q)|0,n=(n=n+Math.imul(F,ee)|0)+Math.imul(D,Q)|0,a=a+Math.imul(D,ee)|0,r=r+Math.imul(R,ie)|0,n=(n=n+Math.imul(R,re)|0)+Math.imul(O,ie)|0,a=a+Math.imul(O,re)|0,r=r+Math.imul(x,ae)|0,n=(n=n+Math.imul(x,se)|0)+Math.imul(A,ae)|0,a=a+Math.imul(A,se)|0,r=r+Math.imul(I,le)|0,n=(n=n+Math.imul(I,de)|0)+Math.imul(P,le)|0,a=a+Math.imul(P,de)|0,r=r+Math.imul(w,ce)|0,n=(n=n+Math.imul(w,ue)|0)+Math.imul(M,ce)|0,a=a+Math.imul(M,ue)|0;var Ee=(d+(r=r+Math.imul(b,me)|0)|0)+((8191&(n=(n=n+Math.imul(b,pe)|0)+Math.imul(S,me)|0))<<13)|0;d=((a=a+Math.imul(S,pe)|0)+(n>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(N,Q),n=(n=Math.imul(N,ee))+Math.imul(V,Q)|0,a=Math.imul(V,ee),r=r+Math.imul(F,ie)|0,n=(n=n+Math.imul(F,re)|0)+Math.imul(D,ie)|0,a=a+Math.imul(D,re)|0,r=r+Math.imul(R,ae)|0,n=(n=n+Math.imul(R,se)|0)+Math.imul(O,ae)|0,a=a+Math.imul(O,se)|0,r=r+Math.imul(x,le)|0,n=(n=n+Math.imul(x,de)|0)+Math.imul(A,le)|0,a=a+Math.imul(A,de)|0,r=r+Math.imul(I,ce)|0,n=(n=n+Math.imul(I,ue)|0)+Math.imul(P,ce)|0,a=a+Math.imul(P,ue)|0;var xe=(d+(r=r+Math.imul(w,me)|0)|0)+((8191&(n=(n=n+Math.imul(w,pe)|0)+Math.imul(M,me)|0))<<13)|0;d=((a=a+Math.imul(M,pe)|0)+(n>>>13)|0)+(xe>>>26)|0,xe&=67108863,r=Math.imul(N,ie),n=(n=Math.imul(N,re))+Math.imul(V,ie)|0,a=Math.imul(V,re),r=r+Math.imul(F,ae)|0,n=(n=n+Math.imul(F,se)|0)+Math.imul(D,ae)|0,a=a+Math.imul(D,se)|0,r=r+Math.imul(R,le)|0,n=(n=n+Math.imul(R,de)|0)+Math.imul(O,le)|0,a=a+Math.imul(O,de)|0,r=r+Math.imul(x,ce)|0,n=(n=n+Math.imul(x,ue)|0)+Math.imul(A,ce)|0,a=a+Math.imul(A,ue)|0;var Ae=(d+(r=r+Math.imul(I,me)|0)|0)+((8191&(n=(n=n+Math.imul(I,pe)|0)+Math.imul(P,me)|0))<<13)|0;d=((a=a+Math.imul(P,pe)|0)+(n>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,r=Math.imul(N,ae),n=(n=Math.imul(N,se))+Math.imul(V,ae)|0,a=Math.imul(V,se),r=r+Math.imul(F,le)|0,n=(n=n+Math.imul(F,de)|0)+Math.imul(D,le)|0,a=a+Math.imul(D,de)|0,r=r+Math.imul(R,ce)|0,n=(n=n+Math.imul(R,ue)|0)+Math.imul(O,ce)|0,a=a+Math.imul(O,ue)|0;var ke=(d+(r=r+Math.imul(x,me)|0)|0)+((8191&(n=(n=n+Math.imul(x,pe)|0)+Math.imul(A,me)|0))<<13)|0;d=((a=a+Math.imul(A,pe)|0)+(n>>>13)|0)+(ke>>>26)|0,ke&=67108863,r=Math.imul(N,le),n=(n=Math.imul(N,de))+Math.imul(V,le)|0,a=Math.imul(V,de),r=r+Math.imul(F,ce)|0,n=(n=n+Math.imul(F,ue)|0)+Math.imul(D,ce)|0,a=a+Math.imul(D,ue)|0;var Re=(d+(r=r+Math.imul(R,me)|0)|0)+((8191&(n=(n=n+Math.imul(R,pe)|0)+Math.imul(O,me)|0))<<13)|0;d=((a=a+Math.imul(O,pe)|0)+(n>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul(N,ce),n=(n=Math.imul(N,ue))+Math.imul(V,ce)|0,a=Math.imul(V,ue);var Oe=(d+(r=r+Math.imul(F,me)|0)|0)+((8191&(n=(n=n+Math.imul(F,pe)|0)+Math.imul(D,me)|0))<<13)|0;d=((a=a+Math.imul(D,pe)|0)+(n>>>13)|0)+(Oe>>>26)|0,Oe&=67108863;var Le=(d+(r=Math.imul(N,me))|0)+((8191&(n=(n=Math.imul(N,pe))+Math.imul(V,me)|0))<<13)|0;return d=((a=Math.imul(V,pe))+(n>>>13)|0)+(Le>>>26)|0,Le&=67108863,l[0]=ge,l[1]=_e,l[2]=ve,l[3]=ye,l[4]=be,l[5]=Se,l[6]=Te,l[7]=we,l[8]=Me,l[9]=Ce,l[10]=Ie,l[11]=Pe,l[12]=Ee,l[13]=xe,l[14]=Ae,l[15]=ke,l[16]=Re,l[17]=Oe,l[18]=Le,0!==d&&(l[19]=d,i.length++),i};function m(e,t,i){return(new p).mulp(e,t,i)}function p(e,t){this.x=e,this.y=t}Math.imul||(f=u),a.prototype.mulTo=function(e,t){var i=this.length+e.length;return 10===this.length&&10===e.length?f(this,e,t):i<63?u(this,e,t):i<1024?function(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var r=0,n=0,a=0;a<i.length-1;a++){var s=n;n=0;for(var o=67108863&r,l=Math.min(a,t.length-1),d=Math.max(0,a-e.length+1);d<=l;d++){var h=a-d,c=(0|e.words[h])*(0|t.words[d]),u=67108863&c;o=67108863&(u=u+o|0),n+=(s=(s=s+(c/67108864|0)|0)+(u>>>26)|0)>>>26,s&=67108863}i.words[a]=o,r=s,s=n}return 0!==r?i.words[a]=r:i.length--,i.strip()}(this,e,t):m(this,e,t)},p.prototype.makeRBT=function(e){for(var t=new Array(e),i=a.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,i,e);return t},p.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var r=0,n=0;n<t;n++)r|=(1&e)<<t-n-1,e>>=1;return r},p.prototype.permute=function(e,t,i,r,n,a){for(var s=0;s<a;s++)r[s]=t[e[s]],n[s]=i[e[s]]},p.prototype.transform=function(e,t,i,r,n,a){this.permute(a,e,t,i,r,n);for(var s=1;s<n;s<<=1)for(var o=s<<1,l=Math.cos(2*Math.PI/o),d=Math.sin(2*Math.PI/o),h=0;h<n;h+=o)for(var c=l,u=d,f=0;f<s;f++){var m=i[h+f],p=r[h+f],g=i[h+f+s],_=r[h+f+s],v=c*g-u*_;_=c*_+u*g,g=v,i[h+f]=m+g,r[h+f]=p+_,i[h+f+s]=m-g,r[h+f+s]=p-_,f!==o&&(v=l*c-d*u,u=l*u+d*c,c=v)}},p.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),r=1&i,n=0;for(i=i/2|0;i;i>>>=1)n++;return 1<<n+1+r},p.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var r=0;r<i/2;r++){var n=e[r];e[r]=e[i-r-1],e[i-r-1]=n,n=t[r],t[r]=-t[i-r-1],t[i-r-1]=-n}},p.prototype.normalize13b=function(e,t){for(var i=0,r=0;r<t/2;r++){var n=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+i;e[r]=67108863&n,i=n<67108864?0:n/67108864|0}return e},p.prototype.convert13b=function(e,t,i,n){for(var a=0,s=0;s<t;s++)a+=0|e[s],i[2*s]=8191&a,a>>>=13,i[2*s+1]=8191&a,a>>>=13;for(s=2*t;s<n;++s)i[s]=0;r(0===a),r(0==(-8192&a))},p.prototype.stub=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0;return t},p.prototype.mulp=function(e,t,i){var r=2*this.guessLen13b(e.length,t.length),n=this.makeRBT(r),a=this.stub(r),s=new Array(r),o=new Array(r),l=new Array(r),d=new Array(r),h=new Array(r),c=new Array(r),u=i.words;u.length=r,this.convert13b(e.words,e.length,s,r),this.convert13b(t.words,t.length,d,r),this.transform(s,a,o,l,r,n),this.transform(d,a,h,c,r,n);for(var f=0;f<r;f++){var m=o[f]*h[f]-l[f]*c[f];l[f]=o[f]*c[f]+l[f]*h[f],o[f]=m}return this.conjugate(o,l,r),this.transform(o,l,u,a,r,n),this.conjugate(u,a,r),this.normalize13b(u,r),i.negative=e.negative^t.negative,i.length=e.length+t.length,i.strip()},a.prototype.mul=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},a.prototype.mulf=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),m(this,e,t)},a.prototype.imul=function(e){return this.clone().mulTo(e,this)},a.prototype.imuln=function(e){r("number"==typeof e),r(e<67108864);for(var t=0,i=0;i<this.length;i++){var n=(0|this.words[i])*e,a=(67108863&n)+(67108863&t);t>>=26,t+=n/67108864|0,t+=a>>>26,this.words[i]=67108863&a}return 0!==t&&(this.words[i]=t,this.length++),this},a.prototype.muln=function(e){return this.clone().imuln(e)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),i=0;i<t.length;i++){var r=i/26|0,n=i%26;t[i]=(e.words[r]&1<<n)>>>n}return t}(e);if(0===t.length)return new a(1);for(var i=this,r=0;r<t.length&&0===t[r];r++,i=i.sqr());if(++r<t.length)for(var n=i.sqr();r<t.length;r++,n=n.sqr())0!==t[r]&&(i=i.mul(n));return i},a.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,i=e%26,n=(e-i)/26,a=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(t=0;t<this.length;t++){var o=this.words[t]&a,l=(0|this.words[t])-o<<i;this.words[t]=l|s,s=o>>>26-i}s&&(this.words[t]=s,this.length++)}if(0!==n){for(t=this.length-1;t>=0;t--)this.words[t+n]=this.words[t];for(t=0;t<n;t++)this.words[t]=0;this.length+=n}return this.strip()},a.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},a.prototype.iushrn=function(e,t,i){var n;r("number"==typeof e&&e>=0),n=t?(t-t%26)/26:0;var a=e%26,s=Math.min((e-a)/26,this.length),o=67108863^67108863>>>a<<a,l=i;if(n-=s,n=Math.max(0,n),l){for(var d=0;d<s;d++)l.words[d]=this.words[d];l.length=s}if(0===s);else if(this.length>s)for(this.length-=s,d=0;d<this.length;d++)this.words[d]=this.words[d+s];else this.words[0]=0,this.length=1;var h=0;for(d=this.length-1;d>=0&&(0!==h||d>=n);d--){var c=0|this.words[d];this.words[d]=h<<26-a|c>>>a,h=c&o}return l&&0!==h&&(l.words[l.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(e,t,i){return r(0===this.negative),this.iushrn(e,t,i)},a.prototype.shln=function(e){return this.clone().ishln(e)},a.prototype.ushln=function(e){return this.clone().iushln(e)},a.prototype.shrn=function(e){return this.clone().ishrn(e)},a.prototype.ushrn=function(e){return this.clone().iushrn(e)},a.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26,n=1<<t;return!(this.length<=i||!(this.words[i]&n))},a.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==t&&i++,this.length=Math.min(i,this.length),0!==t){var n=67108863^67108863>>>t<<t;this.words[this.length-1]&=n}return this.strip()},a.prototype.maskn=function(e){return this.clone().imaskn(e)},a.prototype.iaddn=function(e){return r("number"==typeof e),r(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},a.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},a.prototype.isubn=function(e){if(r("number"==typeof e),r(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},a.prototype.addn=function(e){return this.clone().iaddn(e)},a.prototype.subn=function(e){return this.clone().isubn(e)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(e,t,i){var n,a,s=e.length+i;this._expand(s);var o=0;for(n=0;n<e.length;n++){a=(0|this.words[n+i])+o;var l=(0|e.words[n])*t;o=((a-=67108863&l)>>26)-(l/67108864|0),this.words[n+i]=67108863&a}for(;n<this.length-i;n++)o=(a=(0|this.words[n+i])+o)>>26,this.words[n+i]=67108863&a;if(0===o)return this.strip();for(r(-1===o),o=0,n=0;n<this.length;n++)o=(a=-(0|this.words[n])+o)>>26,this.words[n]=67108863&a;return this.negative=1,this.strip()},a.prototype._wordDiv=function(e,t){var i=(this.length,e.length),r=this.clone(),n=e,s=0|n.words[n.length-1];0!=(i=26-this._countBits(s))&&(n=n.ushln(i),r.iushln(i),s=0|n.words[n.length-1]);var o,l=r.length-n.length;if("mod"!==t){(o=new a(null)).length=l+1,o.words=new Array(o.length);for(var d=0;d<o.length;d++)o.words[d]=0}var h=r.clone()._ishlnsubmul(n,1,l);0===h.negative&&(r=h,o&&(o.words[l]=1));for(var c=l-1;c>=0;c--){var u=67108864*(0|r.words[n.length+c])+(0|r.words[n.length+c-1]);for(u=Math.min(u/s|0,67108863),r._ishlnsubmul(n,u,c);0!==r.negative;)u--,r.negative=0,r._ishlnsubmul(n,1,c),r.isZero()||(r.negative^=1);o&&(o.words[c]=u)}return o&&o.strip(),r.strip(),"div"!==t&&0!==i&&r.iushrn(i),{div:o||null,mod:r}},a.prototype.divmod=function(e,t,i){return r(!e.isZero()),this.isZero()?{div:new a(0),mod:new a(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(n=o.div.neg()),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.iadd(e)),{div:n,mod:s}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(n=o.div.neg()),{div:n,mod:o.mod}):0!=(this.negative&e.negative)?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.isub(e)),{div:o.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new a(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new a(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new a(this.modn(e.words[0]))}:this._wordDiv(e,t);var n,s,o},a.prototype.div=function(e){return this.divmod(e,"div",!1).div},a.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},a.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},a.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),n=e.andln(1),a=i.cmp(r);return a<0||1===n&&0===a?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},a.prototype.modn=function(e){r(e<=67108863);for(var t=(1<<26)%e,i=0,n=this.length-1;n>=0;n--)i=(t*i+(0|this.words[n]))%e;return i},a.prototype.idivn=function(e){r(e<=67108863);for(var t=0,i=this.length-1;i>=0;i--){var n=(0|this.words[i])+67108864*t;this.words[i]=n/e|0,t=n%e}return this.strip()},a.prototype.divn=function(e){return this.clone().idivn(e)},a.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n=new a(1),s=new a(0),o=new a(0),l=new a(1),d=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++d;for(var h=i.clone(),c=t.clone();!t.isZero();){for(var u=0,f=1;0==(t.words[0]&f)&&u<26;++u,f<<=1);if(u>0)for(t.iushrn(u);u-- >0;)(n.isOdd()||s.isOdd())&&(n.iadd(h),s.isub(c)),n.iushrn(1),s.iushrn(1);for(var m=0,p=1;0==(i.words[0]&p)&&m<26;++m,p<<=1);if(m>0)for(i.iushrn(m);m-- >0;)(o.isOdd()||l.isOdd())&&(o.iadd(h),l.isub(c)),o.iushrn(1),l.iushrn(1);t.cmp(i)>=0?(t.isub(i),n.isub(o),s.isub(l)):(i.isub(t),o.isub(n),l.isub(s))}return{a:o,b:l,gcd:i.iushln(d)}},a.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n,s=new a(1),o=new a(0),l=i.clone();t.cmpn(1)>0&&i.cmpn(1)>0;){for(var d=0,h=1;0==(t.words[0]&h)&&d<26;++d,h<<=1);if(d>0)for(t.iushrn(d);d-- >0;)s.isOdd()&&s.iadd(l),s.iushrn(1);for(var c=0,u=1;0==(i.words[0]&u)&&c<26;++c,u<<=1);if(c>0)for(i.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(l),o.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(o)):(i.isub(t),o.isub(s))}return(n=0===t.cmpn(1)?s:o).cmpn(0)<0&&n.iadd(e),n},a.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var r=0;t.isEven()&&i.isEven();r++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var n=t.cmp(i);if(n<0){var a=t;t=i,i=a}else if(0===n||0===i.cmpn(1))break;t.isub(i)}return i.iushln(r)},a.prototype.invm=function(e){return this.egcd(e).a.umod(e)},a.prototype.isEven=function(){return 0==(1&this.words[0])},a.prototype.isOdd=function(){return 1==(1&this.words[0])},a.prototype.andln=function(e){return this.words[0]&e},a.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,i=(e-t)/26,n=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=n,this;for(var a=n,s=i;0!==a&&s<this.length;s++){var o=0|this.words[s];a=(o+=a)>>>26,o&=67108863,this.words[s]=o}return 0!==a&&(this.words[s]=a,this.length++),this},a.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},a.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)t=1;else{i&&(e=-e),r(e<=67108863,"Number is too big");var n=0|this.words[0];t=n===e?0:n<e?-1:1}return 0!==this.negative?0|-t:t},a.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},a.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,i=this.length-1;i>=0;i--){var r=0|this.words[i],n=0|e.words[i];if(r!==n){r<n?t=-1:r>n&&(t=1);break}}return t},a.prototype.gtn=function(e){return 1===this.cmpn(e)},a.prototype.gt=function(e){return 1===this.cmp(e)},a.prototype.gten=function(e){return this.cmpn(e)>=0},a.prototype.gte=function(e){return this.cmp(e)>=0},a.prototype.ltn=function(e){return-1===this.cmpn(e)},a.prototype.lt=function(e){return-1===this.cmp(e)},a.prototype.lten=function(e){return this.cmpn(e)<=0},a.prototype.lte=function(e){return this.cmp(e)<=0},a.prototype.eqn=function(e){return 0===this.cmpn(e)},a.prototype.eq=function(e){return 0===this.cmp(e)},a.red=function(e){return new T(e)},a.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},a.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(e){return this.red=e,this},a.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},a.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},a.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},a.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},a.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},a.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},a.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},a.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},a.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function _(e,t){this.name=e,this.p=new a(t,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function y(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function b(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function S(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function T(e){if("string"==typeof e){var t=a._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function w(e){T.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var e=new a(null);return e.words=new Array(Math.ceil(this.n/13)),e},_.prototype.ireduce=function(e){var t,i=e;do{this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(t>this.n);var r=t<this.n?-1:i.ucmp(this.p);return 0===r?(i.words[0]=0,i.length=1):r>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},_.prototype.split=function(e,t){e.iushrn(this.n,0,t)},_.prototype.imulK=function(e){return e.imul(this.k)},n(v,_),v.prototype.split=function(e,t){for(var i=Math.min(e.length,9),r=0;r<i;r++)t.words[r]=e.words[r];if(t.length=i,e.length<=9)return e.words[0]=0,void(e.length=1);var n=e.words[9];for(t.words[t.length++]=4194303&n,r=10;r<e.length;r++){var a=0|e.words[r];e.words[r-10]=(4194303&a)<<4|n>>>22,n=a}n>>>=22,e.words[r-10]=n,0===n&&e.length>10?e.length-=10:e.length-=9},v.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var r=0|e.words[i];t+=977*r,e.words[i]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},n(y,_),n(b,_),n(S,_),S.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var r=19*(0|e.words[i])+t,n=67108863&r;r>>>=26,e.words[i]=n,t=r}return 0!==t&&(e.words[e.length++]=t),e},a._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new v;else if("p224"===e)t=new y;else if("p192"===e)t=new b;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new S}return g[e]=t,t},T.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},T.prototype._verify2=function(e,t){r(0==(e.negative|t.negative),"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},T.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},T.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},T.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},T.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},T.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},T.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i},T.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},T.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},T.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},T.prototype.isqr=function(e){return this.imul(e,e.clone())},T.prototype.sqr=function(e){return this.mul(e,e)},T.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var i=this.m.add(new a(1)).iushrn(2);return this.pow(e,i)}for(var n=this.m.subn(1),s=0;!n.isZero()&&0===n.andln(1);)s++,n.iushrn(1);r(!n.isZero());var o=new a(1).toRed(this),l=o.redNeg(),d=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new a(2*h*h).toRed(this);0!==this.pow(h,d).cmp(l);)h.redIAdd(l);for(var c=this.pow(h,n),u=this.pow(e,n.addn(1).iushrn(1)),f=this.pow(e,n),m=s;0!==f.cmp(o);){for(var p=f,g=0;0!==p.cmp(o);g++)p=p.redSqr();r(g<m);var _=this.pow(c,new a(1).iushln(m-g-1));u=u.redMul(_),c=_.redSqr(),f=f.redMul(c),m=g}return u},T.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},T.prototype.pow=function(e,t){if(t.isZero())return new a(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=new Array(16);i[0]=new a(1).toRed(this),i[1]=e;for(var r=2;r<i.length;r++)i[r]=this.mul(i[r-1],e);var n=i[0],s=0,o=0,l=t.bitLength()%26;for(0===l&&(l=26),r=t.length-1;r>=0;r--){for(var d=t.words[r],h=l-1;h>=0;h--){var c=d>>h&1;n!==i[0]&&(n=this.sqr(n)),0!==c||0!==s?(s<<=1,s|=c,(4==++o||0===r&&0===h)&&(n=this.mul(n,i[s]),o=0,s=0)):o=0}l=26}return n},T.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},T.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},a.mont=function(e){return new w(e)},n(w,T),w.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},w.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},w.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),a=n;return n.cmp(this.m)>=0?a=n.isub(this.m):n.cmpn(0)<0&&(a=n.iadd(this.m)),a._forceRed(this)},w.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new a(0)._forceRed(this);var i=e.mul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},w.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,i(83)(e))},function(e,t,i){var r=i(316),n=i(154);function a(e){this.rand=e||new n.Rand}e.exports=a,a.create=function(e){return new a(e)},a.prototype._randbelow=function(e){var t=e.bitLength(),i=Math.ceil(t/8);do{var n=new r(this.rand.generate(i))}while(n.cmp(e)>=0);return n},a.prototype._randrange=function(e,t){var i=t.sub(e);return e.add(this._randbelow(i))},a.prototype.test=function(e,t,i){var n=e.bitLength(),a=r.mont(e),s=new r(1).toRed(a);t||(t=Math.max(1,n/48|0));for(var o=e.subn(1),l=0;!o.testn(l);l++);for(var d=e.shrn(l),h=o.toRed(a);t>0;t--){var c=this._randrange(new r(2),o);i&&i(c);var u=c.toRed(a).redPow(d);if(0!==u.cmp(s)&&0!==u.cmp(h)){for(var f=1;f<l;f++){if(0===(u=u.redSqr()).cmp(s))return!1;if(0===u.cmp(h))break}if(f===l)return!1}}return!0},a.prototype.getDivisor=function(e,t){var i=e.bitLength(),n=r.mont(e),a=new r(1).toRed(n);t||(t=Math.max(1,i/48|0));for(var s=e.subn(1),o=0;!s.testn(o);o++);for(var l=e.shrn(o),d=s.toRed(n);t>0;t--){var h=this._randrange(new r(2),s),c=e.gcd(h);if(0!==c.cmpn(1))return c;var u=h.toRed(n).redPow(l);if(0!==u.cmp(a)&&0!==u.cmp(d)){for(var f=1;f<o;f++){if(0===(u=u.redSqr()).cmp(a))return u.fromRed().subn(1).gcd(e);if(0===u.cmp(d))break}if(f===o)return(u=u.redSqr()).fromRed().subn(1).gcd(e)}}return!1}},function(e,t,i){"use strict";(function(t,r){var n;e.exports=C,C.ReadableState=M,i(31).EventEmitter;var a,s=function(e,t){return e.listeners(t).length},o=i(209),l=i(43).Buffer,d=t.Uint8Array||function(){},h=i(323);a=h&&h.debuglog?h.debuglog("stream"):function(){};var c,u,f,m=i(324),p=i(210),g=i(211).getHighWaterMark,_=i(107).codes,v=_.ERR_INVALID_ARG_TYPE,y=_.ERR_STREAM_PUSH_AFTER_EOF,b=_.ERR_METHOD_NOT_IMPLEMENTED,S=_.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;i(26)(C,o);var T=p.errorOrDestroy,w=["error","close","destroy","pause","resume"];function M(e,t,r){n=n||i(108),e=e||{},"boolean"!=typeof r&&(r=t instanceof n),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",r),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(c||(c=i(96).StringDecoder),this.decoder=new c(e.encoding),this.encoding=e.encoding)}function C(e){if(n=n||i(108),!(this instanceof C))return new C(e);var t=this instanceof n;this._readableState=new M(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function I(e,t,i,r,n){a("readableAddChunk",t);var s,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(a("onEofChunk"),!t.ended){if(t.decoder){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,t.sync?x(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,A(e)))}}(e,o);else if(n||(s=function(e,t){var i,r;return r=t,l.isBuffer(r)||r instanceof d||"string"==typeof t||void 0===t||e.objectMode||(i=new v("chunk",["string","Buffer","Uint8Array"],t)),i}(o,t)),s)T(e,s);else if(o.objectMode||t&&t.length>0)if("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),r)o.endEmitted?T(e,new S):P(e,o,t,!0);else if(o.ended)T(e,new y);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!i?(t=o.decoder.write(t),o.objectMode||0!==t.length?P(e,o,t,!1):k(e,o)):P(e,o,t,!1)}else r||(o.reading=!1,k(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function P(e,t,i,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",i)):(t.length+=t.objectMode?1:i.length,r?t.buffer.unshift(i):t.buffer.push(i),t.needReadable&&x(e)),k(e,t)}function E(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=1073741824?e=1073741824:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function x(e){var t=e._readableState;a("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(a("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(A,e))}function A(e){var t=e._readableState;a("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,D(e)}function k(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(R,e,t))}function R(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var i=t.length;if(a("maybeReadMore read 0"),e.read(0),i===t.length)break}t.readingMore=!1}function O(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function L(e){a("readable nexttick read 0"),e.read(0)}function F(e,t){a("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),D(e),t.flowing&&!t.reading&&e.read(0)}function D(e){var t=e._readableState;for(a("flow",t.flowing);t.flowing&&null!==e.read(););}function B(e,t){return 0===t.length?null:(t.objectMode?i=t.buffer.shift():!e||e>=t.length?(i=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):i=t.buffer.consume(e,t.decoder),i);var i}function N(e){var t=e._readableState;a("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(V,t,e))}function V(e,t){if(a("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var i=t._writableState;(!i||i.autoDestroy&&i.finished)&&t.destroy()}}function U(e,t){for(var i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1}Object.defineProperty(C.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),C.prototype.destroy=p.destroy,C.prototype._undestroy=p.undestroy,C.prototype._destroy=function(e,t){t(e)},C.prototype.push=function(e,t){var i,r=this._readableState;return r.objectMode?i=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=l.from(e,t),t=""),i=!0),I(this,e,t,!1,i)},C.prototype.unshift=function(e){return I(this,e,null,!0,!1)},C.prototype.isPaused=function(){return!1===this._readableState.flowing},C.prototype.setEncoding=function(e){c||(c=i(96).StringDecoder);var t=new c(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";null!==r;)n+=t.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==n&&this._readableState.buffer.push(n),this._readableState.length=n.length,this},C.prototype.read=function(e){a("read",e),e=parseInt(e,10);var t=this._readableState,i=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return a("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?N(this):x(this),null;if(0===(e=E(e,t))&&t.ended)return 0===t.length&&N(this),null;var r,n=t.needReadable;return a("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&a("length less than watermark",n=!0),t.ended||t.reading?a("reading or ended",n=!1):n&&(a("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=E(i,t))),null===(r=e>0?B(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),i!==e&&t.ended&&N(this)),null!==r&&this.emit("data",r),r},C.prototype._read=function(e){T(this,new b("_read()"))},C.prototype.pipe=function(e,t){var i=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,a("pipe count=%d opts=%j",n.pipesCount,t);var o=t&&!1===t.end||e===r.stdout||e===r.stderr?p:l;function l(){a("onend"),e.end()}n.endEmitted?r.nextTick(o):i.once("end",o),e.on("unpipe",(function t(r,s){a("onunpipe"),r===i&&s&&!1===s.hasUnpiped&&(s.hasUnpiped=!0,a("cleanup"),e.removeListener("close",f),e.removeListener("finish",m),e.removeListener("drain",d),e.removeListener("error",u),e.removeListener("unpipe",t),i.removeListener("end",l),i.removeListener("end",p),i.removeListener("data",c),h=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}));var d=function(e){return function(){var t=e._readableState;a("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,D(e))}}(i);e.on("drain",d);var h=!1;function c(t){a("ondata");var r=e.write(t);a("dest.write",r),!1===r&&((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==U(n.pipes,e))&&!h&&(a("false write response, pause",n.awaitDrain),n.awaitDrain++),i.pause())}function u(t){a("onerror",t),p(),e.removeListener("error",u),0===s(e,"error")&&T(e,t)}function f(){e.removeListener("finish",m),p()}function m(){a("onfinish"),e.removeListener("close",f),p()}function p(){a("unpipe"),i.unpipe(e)}return i.on("data",c),function(e,t,i){if("function"==typeof e.prependListener)return e.prependListener(t,i);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(i):e._events[t]=[i,e._events[t]]:e.on(t,i)}(e,"error",u),e.once("close",f),e.once("finish",m),e.emit("pipe",i),n.flowing||(a("pipe resume"),i.resume()),e},C.prototype.unpipe=function(e){var t=this._readableState,i={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,i)),this;if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<n;a++)r[a].emit("unpipe",this,{hasUnpiped:!1});return this}var s=U(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,i)),this},C.prototype.on=function(e,t){var i=o.prototype.on.call(this,e,t),n=this._readableState;return"data"===e?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"===e&&(n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,a("on readable",n.length,n.reading),n.length?x(this):n.reading||r.nextTick(L,this))),i},C.prototype.addListener=C.prototype.on,C.prototype.removeListener=function(e,t){var i=o.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(O,this),i},C.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||r.nextTick(O,this),t},C.prototype.resume=function(){var e=this._readableState;return e.flowing||(a("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(F,e,t))}(this,e)),e.paused=!1,this},C.prototype.pause=function(){return a("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(a("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},C.prototype.wrap=function(e){var t=this,i=this._readableState,r=!1;for(var n in e.on("end",(function(){if(a("wrapped end"),i.decoder&&!i.ended){var e=i.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(n){a("wrapped data"),i.decoder&&(n=i.decoder.write(n)),i.objectMode&&null==n||(i.objectMode||n&&n.length)&&(t.push(n)||(r=!0,e.pause()))})),e)void 0===this[n]&&"function"==typeof e[n]&&(this[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n));for(var s=0;s<w.length;s++)e.on(w[s],this.emit.bind(this,w[s]));return this._read=function(t){a("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(C.prototype[Symbol.asyncIterator]=function(){return void 0===u&&(u=i(326)),u(this)}),Object.defineProperty(C.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(C.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(C.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),C._fromList=B,Object.defineProperty(C.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(C.from=function(e,t){return void 0===f&&(f=i(327)),f(C,e,t)})}).call(this,i(55),i(48))},function(e,t,i){e.exports=i(31).EventEmitter},function(e,t,i){"use strict";(function(t){function i(e,t){n(e,t),r(e)}function r(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function n(e,t){e.emit("error",t)}e.exports={destroy:function(e,a){var s=this,o=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return o||l?(a?a(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(n,this,e)):t.nextTick(n,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!a&&e?s._writableState?s._writableState.errorEmitted?t.nextTick(r,s):(s._writableState.errorEmitted=!0,t.nextTick(i,s,e)):t.nextTick(i,s,e):a?(t.nextTick(r,s),a(e)):t.nextTick(r,s)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var i=e._readableState,r=e._writableState;i&&i.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this,i(48))},function(e,t,i){"use strict";var r=i(107).codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,i,n){var a=function(e,t,i){return null!=e.highWaterMark?e.highWaterMark:t?e[i]:null}(t,n,i);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new r(n?i:"highWaterMark",a);return Math.floor(a)}return e.objectMode?16:16384}}},function(e,t,i){"use strict";(function(t,r){function n(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,i){var r=e.entry;for(e.entry=null;r;){var n=r.callback;t.pendingcb--,n(void 0),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}var a;e.exports=C,C.WritableState=M;var s,o={deprecate:i(145)},l=i(209),d=i(43).Buffer,h=t.Uint8Array||function(){},c=i(210),u=i(211).getHighWaterMark,f=i(107).codes,m=f.ERR_INVALID_ARG_TYPE,p=f.ERR_METHOD_NOT_IMPLEMENTED,g=f.ERR_MULTIPLE_CALLBACK,_=f.ERR_STREAM_CANNOT_PIPE,v=f.ERR_STREAM_DESTROYED,y=f.ERR_STREAM_NULL_VALUES,b=f.ERR_STREAM_WRITE_AFTER_END,S=f.ERR_UNKNOWN_ENCODING,T=c.errorOrDestroy;function w(){}function M(e,t,s){a=a||i(108),e=e||{},"boolean"!=typeof s&&(s=t instanceof a),this.objectMode=!!e.objectMode,s&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=u(this,e,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var i=e._writableState,n=i.sync,a=i.writecb;if("function"!=typeof a)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(i),t)!function(e,t,i,n,a){--t.pendingcb,i?(r.nextTick(a,n),r.nextTick(k,e,t),e._writableState.errorEmitted=!0,T(e,n)):(a(n),e._writableState.errorEmitted=!0,T(e,n),k(e,t))}(e,i,n,t,a);else{var s=x(i)||e.destroyed;s||i.corked||i.bufferProcessing||!i.bufferedRequest||E(e,i),n?r.nextTick(P,e,i,s,a):P(e,i,s,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}function C(e){var t=this instanceof(a=a||i(108));if(!t&&!s.call(C,this))return new C(e);this._writableState=new M(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),l.call(this)}function I(e,t,i,r,n,a,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):i?e._writev(n,t.onwrite):e._write(n,a,t.onwrite),t.sync=!1}function P(e,t,i,r){i||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),k(e,t)}function E(e,t){t.bufferProcessing=!0;var i=t.bufferedRequest;if(e._writev&&i&&i.next){var r=t.bufferedRequestCount,a=new Array(r),s=t.corkedRequestsFree;s.entry=i;for(var o=0,l=!0;i;)a[o]=i,i.isBuf||(l=!1),i=i.next,o+=1;a.allBuffers=l,I(e,t,!0,t.length,a,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new n(t),t.bufferedRequestCount=0}else{for(;i;){var d=i.chunk,h=i.encoding,c=i.callback;if(I(e,t,!1,t.objectMode?1:d.length,d,h,c),i=i.next,t.bufferedRequestCount--,t.writing)break}null===i&&(t.lastBufferedRequest=null)}t.bufferedRequest=i,t.bufferProcessing=!1}function x(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function A(e,t){e._final((function(i){t.pendingcb--,i&&T(e,i),t.prefinished=!0,e.emit("prefinish"),k(e,t)}))}function k(e,t){var i=x(t);if(i&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,r.nextTick(A,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var n=e._readableState;(!n||n.autoDestroy&&n.endEmitted)&&e.destroy()}return i}i(26)(C,l),M.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(M.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(s=Function.prototype[Symbol.hasInstance],Object.defineProperty(C,Symbol.hasInstance,{value:function(e){return!!s.call(this,e)||this===C&&e&&e._writableState instanceof M}})):s=function(e){return e instanceof this},C.prototype.pipe=function(){T(this,new _)},C.prototype.write=function(e,t,i){var n,a=this._writableState,s=!1,o=!a.objectMode&&(n=e,d.isBuffer(n)||n instanceof h);return o&&!d.isBuffer(e)&&(e=function(e){return d.from(e)}(e)),"function"==typeof t&&(i=t,t=null),o?t="buffer":t||(t=a.defaultEncoding),"function"!=typeof i&&(i=w),a.ending?function(e,t){var i=new b;T(e,i),r.nextTick(t,i)}(this,i):(o||function(e,t,i,n){var a;return null===i?a=new y:"string"==typeof i||t.objectMode||(a=new m("chunk",["string","Buffer"],i)),!a||(T(e,a),r.nextTick(n,a),!1)}(this,a,e,i))&&(a.pendingcb++,s=function(e,t,i,r,n,a){if(!i){var s=function(e,t,i){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=d.from(t,i)),t}(t,r,n);r!==s&&(i=!0,n="buffer",r=s)}var o=t.objectMode?1:r.length;t.length+=o;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var h=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:n,isBuf:i,callback:a,next:null},h?h.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else I(e,t,!1,o,r,n,a);return l}(this,a,o,e,t,i)),s},C.prototype.cork=function(){this._writableState.corked++},C.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||E(this,e))},C.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new S(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(C.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(C.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),C.prototype._write=function(e,t,i){i(new p("_write()"))},C.prototype._writev=null,C.prototype.end=function(e,t,i){var n=this._writableState;return"function"==typeof e?(i=e,e=null,t=null):"function"==typeof t&&(i=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||function(e,t,i){t.ending=!0,k(e,t),i&&(t.finished?r.nextTick(i):e.once("finish",i)),t.ended=!0,e.writable=!1}(this,n,i),this},Object.defineProperty(C.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(C.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),C.prototype.destroy=c.destroy,C.prototype._undestroy=c.undestroy,C.prototype._destroy=function(e,t){t(e)}}).call(this,i(55),i(48))},function(e,t,i){"use strict";e.exports=h;var r=i(107).codes,n=r.ERR_METHOD_NOT_IMPLEMENTED,a=r.ERR_MULTIPLE_CALLBACK,s=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=r.ERR_TRANSFORM_WITH_LENGTH_0,l=i(108);function d(e,t){var i=this._transformState;i.transforming=!1;var r=i.writecb;if(null===r)return this.emit("error",new a);i.writechunk=null,i.writecb=null,null!=t&&this.push(t),r(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function h(e){if(!(this instanceof h))return new h(e);l.call(this,e),this._transformState={afterTransform:d.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",c)}function c(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?u(this,null,null):this._flush((function(t,i){u(e,t,i)}))}function u(e,t,i){if(t)return e.emit("error",t);if(null!=i&&e.push(i),e._writableState.length)throw new o;if(e._transformState.transforming)throw new s;return e.push(null)}i(26)(h,l),h.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},h.prototype._transform=function(e,t,i){i(new n("_transform()"))},h.prototype._write=function(e,t,i){var r=this._transformState;if(r.writecb=i,r.writechunk=e,r.writeencoding=t,!r.transforming){var n=this._readableState;(r.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},h.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},h.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))}},function(e,t,i){"use strict";var r=t;function n(e){return 1===e.length?"0"+e:e}function a(e){for(var t="",i=0;i<e.length;i++)t+=n(e[i].toString(16));return t}r.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var i=[];if("string"!=typeof e){for(var r=0;r<e.length;r++)i[r]=0|e[r];return i}if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),r=0;r<e.length;r+=2)i.push(parseInt(e[r]+e[r+1],16));else for(r=0;r<e.length;r++){var n=e.charCodeAt(r),a=n>>8,s=255&n;a?i.push(a,s):i.push(s)}return i},r.zero2=n,r.toHex=a,r.encode=function(e,t){return"hex"===t?a(e):e}},function(e,t,i){"use strict";var r=t;r.base=i(130),r.short=i(335),r.mont=i(336),r.edwards=i(337)},function(e,t,i){"use strict";var r=i(76).rotr32;function n(e,t,i){return e&t^~e&i}function a(e,t,i){return e&t^e&i^t&i}function s(e,t,i){return e^t^i}t.ft_1=function(e,t,i,r){return 0===e?n(t,i,r):1===e||3===e?s(t,i,r):2===e?a(t,i,r):void 0},t.ch32=n,t.maj32=a,t.p32=s,t.s0_256=function(e){return r(e,2)^r(e,13)^r(e,22)},t.s1_256=function(e){return r(e,6)^r(e,11)^r(e,25)},t.g0_256=function(e){return r(e,7)^r(e,18)^e>>>3},t.g1_256=function(e){return r(e,17)^r(e,19)^e>>>10}},function(e,t,i){"use strict";var r=i(76),n=i(119),a=i(216),s=i(65),o=r.sum32,l=r.sum32_4,d=r.sum32_5,h=a.ch32,c=a.maj32,u=a.s0_256,f=a.s1_256,m=a.g0_256,p=a.g1_256,g=n.BlockHash,_=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function v(){if(!(this instanceof v))return new v;g.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=_,this.W=new Array(64)}r.inherits(v,g),e.exports=v,v.blockSize=512,v.outSize=256,v.hmacStrength=192,v.padLength=64,v.prototype._update=function(e,t){for(var i=this.W,r=0;r<16;r++)i[r]=e[t+r];for(;r<i.length;r++)i[r]=l(p(i[r-2]),i[r-7],m(i[r-15]),i[r-16]);var n=this.h[0],a=this.h[1],g=this.h[2],_=this.h[3],v=this.h[4],y=this.h[5],b=this.h[6],S=this.h[7];for(s(this.k.length===i.length),r=0;r<i.length;r++){var T=d(S,f(v),h(v,y,b),this.k[r],i[r]),w=o(u(n),c(n,a,g));S=b,b=y,y=v,v=o(_,T),_=g,g=a,a=n,n=o(T,w)}this.h[0]=o(this.h[0],n),this.h[1]=o(this.h[1],a),this.h[2]=o(this.h[2],g),this.h[3]=o(this.h[3],_),this.h[4]=o(this.h[4],v),this.h[5]=o(this.h[5],y),this.h[6]=o(this.h[6],b),this.h[7]=o(this.h[7],S)},v.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},function(e,t,i){"use strict";var r=i(76),n=i(119),a=i(65),s=r.rotr64_hi,o=r.rotr64_lo,l=r.shr64_hi,d=r.shr64_lo,h=r.sum64,c=r.sum64_hi,u=r.sum64_lo,f=r.sum64_4_hi,m=r.sum64_4_lo,p=r.sum64_5_hi,g=r.sum64_5_lo,_=n.BlockHash,v=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function y(){if(!(this instanceof y))return new y;_.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=v,this.W=new Array(160)}function b(e,t,i,r,n){var a=e&i^~e&n;return a<0&&(a+=4294967296),a}function S(e,t,i,r,n,a){var s=t&r^~t&a;return s<0&&(s+=4294967296),s}function T(e,t,i,r,n){var a=e&i^e&n^i&n;return a<0&&(a+=4294967296),a}function w(e,t,i,r,n,a){var s=t&r^t&a^r&a;return s<0&&(s+=4294967296),s}function M(e,t){var i=s(e,t,28)^s(t,e,2)^s(t,e,7);return i<0&&(i+=4294967296),i}function C(e,t){var i=o(e,t,28)^o(t,e,2)^o(t,e,7);return i<0&&(i+=4294967296),i}function I(e,t){var i=s(e,t,14)^s(e,t,18)^s(t,e,9);return i<0&&(i+=4294967296),i}function P(e,t){var i=o(e,t,14)^o(e,t,18)^o(t,e,9);return i<0&&(i+=4294967296),i}function E(e,t){var i=s(e,t,1)^s(e,t,8)^l(e,t,7);return i<0&&(i+=4294967296),i}function x(e,t){var i=o(e,t,1)^o(e,t,8)^d(e,t,7);return i<0&&(i+=4294967296),i}function A(e,t){var i=s(e,t,19)^s(t,e,29)^l(e,t,6);return i<0&&(i+=4294967296),i}function k(e,t){var i=o(e,t,19)^o(t,e,29)^d(e,t,6);return i<0&&(i+=4294967296),i}r.inherits(y,_),e.exports=y,y.blockSize=1024,y.outSize=512,y.hmacStrength=192,y.padLength=128,y.prototype._prepareBlock=function(e,t){for(var i=this.W,r=0;r<32;r++)i[r]=e[t+r];for(;r<i.length;r+=2){var n=A(i[r-4],i[r-3]),a=k(i[r-4],i[r-3]),s=i[r-14],o=i[r-13],l=E(i[r-30],i[r-29]),d=x(i[r-30],i[r-29]),h=i[r-32],c=i[r-31];i[r]=f(n,a,s,o,l,d,h,c),i[r+1]=m(n,a,s,o,l,d,h,c)}},y.prototype._update=function(e,t){this._prepareBlock(e,t);var i=this.W,r=this.h[0],n=this.h[1],s=this.h[2],o=this.h[3],l=this.h[4],d=this.h[5],f=this.h[6],m=this.h[7],_=this.h[8],v=this.h[9],y=this.h[10],E=this.h[11],x=this.h[12],A=this.h[13],k=this.h[14],R=this.h[15];a(this.k.length===i.length);for(var O=0;O<i.length;O+=2){var L=k,F=R,D=I(_,v),B=P(_,v),N=b(_,0,y,0,x),V=S(0,v,0,E,0,A),U=this.k[O],W=this.k[O+1],z=i[O],G=i[O+1],j=p(L,F,D,B,N,V,U,W,z,G),H=g(L,F,D,B,N,V,U,W,z,G);L=M(r,n),F=C(r,n),D=T(r,0,s,0,l),B=w(0,n,0,o,0,d);var q=c(L,F,D,B),$=u(L,F,D,B);k=x,R=A,x=y,A=E,y=_,E=v,_=c(f,m,j,H),v=u(m,m,j,H),f=l,m=d,l=s,d=o,s=r,o=n,r=c(j,H,q,$),n=u(j,H,q,$)}h(this.h,0,r,n),h(this.h,2,s,o),h(this.h,4,l,d),h(this.h,6,f,m),h(this.h,8,_,v),h(this.h,10,y,E),h(this.h,12,x,A),h(this.h,14,k,R)},y.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},function(e,t,i){(function(e){!function(e,t){"use strict";function r(e,t){if(!e)throw new Error(t||"Assertion failed")}function n(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function a(e,t,i){if(a.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(i=t,t=10),this._init(e||0,t||10,i||"be"))}var s;"object"==typeof e?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;try{s=i(352).Buffer}catch(e){}function o(e,t,i){for(var n=0,a=Math.min(e.length,i),s=0,o=t;o<a;o++){var l,d=e.charCodeAt(o)-48;n<<=4,n|=l=d>=49&&d<=54?d-49+10:d>=17&&d<=22?d-17+10:d,s|=l}return r(!(240&s),"Invalid character in "+e),n}function l(e,t,i,n){for(var a=0,s=0,o=Math.min(e.length,i),l=t;l<o;l++){var d=e.charCodeAt(l)-48;a*=n,s=d>=49?d-49+10:d>=17?d-17+10:d,r(d>=0&&s<n,"Invalid character"),a+=s}return a}function d(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}function h(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}a.isBN=function(e){return e instanceof a||null!==e&&"object"==typeof e&&e.constructor.wordSize===a.wordSize&&Array.isArray(e.words)},a.max=function(e,t){return e.cmp(t)>0?e:t},a.min=function(e,t){return e.cmp(t)<0?e:t},a.prototype._init=function(e,t,i){if("number"==typeof e)return this._initNumber(e,t,i);if("object"==typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36);var n=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&n++,16===t?this._parseHex(e,n):this._parseBase(e,t,n),"-"===e[0]&&(this.negative=1),this._strip(),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(r(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initArray=function(e,t,i){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var a,s,o=0;if("be"===i)for(n=e.length-1,a=0;n>=0;n-=3)s=e[n]|e[n-1]<<8|e[n-2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);else if("le"===i)for(n=0,a=0;n<e.length;n+=3)s=e[n]|e[n+1]<<8|e[n+2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);return this._strip()},a.prototype._parseHex=function(e,t){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var r,n,a=0;for(i=e.length-6,r=0;i>=t;i-=6)n=o(e,i,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303,(a+=24)>=26&&(a-=26,r++);i+6!==t&&(n=o(e,t,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303),this._strip()},a.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var r=0,n=1;n<=67108863;n*=t)r++;r--,n=n/t|0;for(var a=e.length-i,s=a%r,o=Math.min(a,a-s)+i,d=0,h=i;h<o;h+=r)d=l(e,h,h+r,t),this.imuln(n),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d);if(0!==s){var c=1;for(d=l(e,h,e.length,t),h=0;h<s;h++)c*=t;this.imuln(c),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d)}},a.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},a.prototype._move=function(e){d(e,this)},a.prototype.clone=function(){var e=new a(null);return this.copy(e),e},a.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},a.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},a.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for?a.prototype[Symbol.for("nodejs.util.inspect.custom")]=h:a.prototype.inspect=h;var c=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],u=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function m(e,t,i){i.negative=t.negative^e.negative;var r=e.length+t.length|0;i.length=r,r=r-1|0;var n=0|e.words[0],a=0|t.words[0],s=n*a,o=67108863&s,l=s/67108864|0;i.words[0]=o;for(var d=1;d<r;d++){for(var h=l>>>26,c=67108863&l,u=Math.min(d,t.length-1),f=Math.max(0,d-e.length+1);f<=u;f++){var m=d-f|0;h+=(s=(n=0|e.words[m])*(a=0|t.words[f])+c)/67108864|0,c=67108863&s}i.words[d]=0|c,l=0|h}return 0!==l?i.words[d]=0|l:i.length--,i._strip()}a.prototype.toString=function(e,t){var i;if(t=0|t||1,16===(e=e||10)||"hex"===e){i="";for(var n=0,a=0,s=0;s<this.length;s++){var o=this.words[s],l=(16777215&(o<<n|a)).toString(16);i=0!=(a=o>>>24-n&16777215)||s!==this.length-1?c[6-l.length]+l+i:l+i,(n+=2)>=26&&(n-=26,s--)}for(0!==a&&(i=a.toString(16)+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var d=u[e],h=f[e];i="";var m=this.clone();for(m.negative=0;!m.isZero();){var p=m.modrn(h).toString(e);i=(m=m.idivn(h)).isZero()?p+i:c[d-p.length]+p+i}for(this.isZero()&&(i="0"+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},a.prototype.toJSON=function(){return this.toString(16,2)},s&&(a.prototype.toBuffer=function(e,t){return this.toArrayLike(s,e,t)}),a.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},a.prototype.toArrayLike=function(e,t,i){this._strip();var n=this.byteLength(),a=i||Math.max(1,n);r(n<=a,"byte array longer than desired length"),r(a>0,"Requested array length <= 0");var s=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,a);return this["_toArrayLike"+("le"===t?"LE":"BE")](s,n),s},a.prototype._toArrayLikeLE=function(e,t){for(var i=0,r=0,n=0,a=0;n<this.length;n++){var s=this.words[n]<<a|r;e[i++]=255&s,i<e.length&&(e[i++]=s>>8&255),i<e.length&&(e[i++]=s>>16&255),6===a?(i<e.length&&(e[i++]=s>>24&255),r=0,a=0):(r=s>>>24,a+=2)}if(i<e.length)for(e[i++]=r;i<e.length;)e[i++]=0},a.prototype._toArrayLikeBE=function(e,t){for(var i=e.length-1,r=0,n=0,a=0;n<this.length;n++){var s=this.words[n]<<a|r;e[i--]=255&s,i>=0&&(e[i--]=s>>8&255),i>=0&&(e[i--]=s>>16&255),6===a?(i>=0&&(e[i--]=s>>24&255),r=0,a=0):(r=s>>>24,a+=2)}if(i>=0)for(e[i--]=r;i>=0;)e[i--]=0},Math.clz32?a.prototype._countBits=function(e){return 32-Math.clz32(e)}:a.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},a.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return 0==(8191&t)&&(i+=13,t>>>=13),0==(127&t)&&(i+=7,t>>>=7),0==(15&t)&&(i+=4,t>>>=4),0==(3&t)&&(i+=2,t>>>=2),0==(1&t)&&i++,i},a.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},a.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return 0!==this.negative},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},a.prototype.ior=function(e){return r(0==(this.negative|e.negative)),this.iuor(e)},a.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},a.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},a.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this._strip()},a.prototype.iand=function(e){return r(0==(this.negative|e.negative)),this.iuand(e)},a.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},a.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},a.prototype.iuxor=function(e){var t,i;this.length>e.length?(t=this,i=e):(t=e,i=this);for(var r=0;r<i.length;r++)this.words[r]=t.words[r]^i.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this._strip()},a.prototype.ixor=function(e){return r(0==(this.negative|e.negative)),this.iuxor(e)},a.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},a.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},a.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var n=0;n<t;n++)this.words[n]=67108863&~this.words[n];return i>0&&(this.words[n]=~this.words[n]&67108863>>26-i),this._strip()},a.prototype.notn=function(e){return this.clone().inotn(e)},a.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var i=e/26|0,n=e%26;return this._expand(i+1),this.words[i]=t?this.words[i]|1<<n:this.words[i]&~(1<<n),this._strip()},a.prototype.iadd=function(e){var t,i,r;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,r=e):(i=e,r=this);for(var n=0,a=0;a<r.length;a++)t=(0|i.words[a])+(0|r.words[a])+n,this.words[a]=67108863&t,n=t>>>26;for(;0!==n&&a<i.length;a++)t=(0|i.words[a])+n,this.words[a]=67108863&t,n=t>>>26;if(this.length=i.length,0!==n)this.words[this.length]=n,this.length++;else if(i!==this)for(;a<i.length;a++)this.words[a]=i.words[a];return this},a.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},a.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var i,r,n=this.cmp(e);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(i=this,r=e):(i=e,r=this);for(var a=0,s=0;s<r.length;s++)a=(t=(0|i.words[s])-(0|r.words[s])+a)>>26,this.words[s]=67108863&t;for(;0!==a&&s<i.length;s++)a=(t=(0|i.words[s])+a)>>26,this.words[s]=67108863&t;if(0===a&&s<i.length&&i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this.length=Math.max(this.length,s),i!==this&&(this.negative=1),this._strip()},a.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,i){var r,n,a,s=e.words,o=t.words,l=i.words,d=0,h=0|s[0],c=8191&h,u=h>>>13,f=0|s[1],m=8191&f,p=f>>>13,g=0|s[2],_=8191&g,v=g>>>13,y=0|s[3],b=8191&y,S=y>>>13,T=0|s[4],w=8191&T,M=T>>>13,C=0|s[5],I=8191&C,P=C>>>13,E=0|s[6],x=8191&E,A=E>>>13,k=0|s[7],R=8191&k,O=k>>>13,L=0|s[8],F=8191&L,D=L>>>13,B=0|s[9],N=8191&B,V=B>>>13,U=0|o[0],W=8191&U,z=U>>>13,G=0|o[1],j=8191&G,H=G>>>13,q=0|o[2],$=8191&q,Z=q>>>13,X=0|o[3],Y=8191&X,J=X>>>13,K=0|o[4],Q=8191&K,ee=K>>>13,te=0|o[5],ie=8191&te,re=te>>>13,ne=0|o[6],ae=8191&ne,se=ne>>>13,oe=0|o[7],le=8191&oe,de=oe>>>13,he=0|o[8],ce=8191&he,ue=he>>>13,fe=0|o[9],me=8191&fe,pe=fe>>>13;i.negative=e.negative^t.negative,i.length=19;var ge=(d+(r=Math.imul(c,W))|0)+((8191&(n=(n=Math.imul(c,z))+Math.imul(u,W)|0))<<13)|0;d=((a=Math.imul(u,z))+(n>>>13)|0)+(ge>>>26)|0,ge&=67108863,r=Math.imul(m,W),n=(n=Math.imul(m,z))+Math.imul(p,W)|0,a=Math.imul(p,z);var _e=(d+(r=r+Math.imul(c,j)|0)|0)+((8191&(n=(n=n+Math.imul(c,H)|0)+Math.imul(u,j)|0))<<13)|0;d=((a=a+Math.imul(u,H)|0)+(n>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(_,W),n=(n=Math.imul(_,z))+Math.imul(v,W)|0,a=Math.imul(v,z),r=r+Math.imul(m,j)|0,n=(n=n+Math.imul(m,H)|0)+Math.imul(p,j)|0,a=a+Math.imul(p,H)|0;var ve=(d+(r=r+Math.imul(c,$)|0)|0)+((8191&(n=(n=n+Math.imul(c,Z)|0)+Math.imul(u,$)|0))<<13)|0;d=((a=a+Math.imul(u,Z)|0)+(n>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(b,W),n=(n=Math.imul(b,z))+Math.imul(S,W)|0,a=Math.imul(S,z),r=r+Math.imul(_,j)|0,n=(n=n+Math.imul(_,H)|0)+Math.imul(v,j)|0,a=a+Math.imul(v,H)|0,r=r+Math.imul(m,$)|0,n=(n=n+Math.imul(m,Z)|0)+Math.imul(p,$)|0,a=a+Math.imul(p,Z)|0;var ye=(d+(r=r+Math.imul(c,Y)|0)|0)+((8191&(n=(n=n+Math.imul(c,J)|0)+Math.imul(u,Y)|0))<<13)|0;d=((a=a+Math.imul(u,J)|0)+(n>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(w,W),n=(n=Math.imul(w,z))+Math.imul(M,W)|0,a=Math.imul(M,z),r=r+Math.imul(b,j)|0,n=(n=n+Math.imul(b,H)|0)+Math.imul(S,j)|0,a=a+Math.imul(S,H)|0,r=r+Math.imul(_,$)|0,n=(n=n+Math.imul(_,Z)|0)+Math.imul(v,$)|0,a=a+Math.imul(v,Z)|0,r=r+Math.imul(m,Y)|0,n=(n=n+Math.imul(m,J)|0)+Math.imul(p,Y)|0,a=a+Math.imul(p,J)|0;var be=(d+(r=r+Math.imul(c,Q)|0)|0)+((8191&(n=(n=n+Math.imul(c,ee)|0)+Math.imul(u,Q)|0))<<13)|0;d=((a=a+Math.imul(u,ee)|0)+(n>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(I,W),n=(n=Math.imul(I,z))+Math.imul(P,W)|0,a=Math.imul(P,z),r=r+Math.imul(w,j)|0,n=(n=n+Math.imul(w,H)|0)+Math.imul(M,j)|0,a=a+Math.imul(M,H)|0,r=r+Math.imul(b,$)|0,n=(n=n+Math.imul(b,Z)|0)+Math.imul(S,$)|0,a=a+Math.imul(S,Z)|0,r=r+Math.imul(_,Y)|0,n=(n=n+Math.imul(_,J)|0)+Math.imul(v,Y)|0,a=a+Math.imul(v,J)|0,r=r+Math.imul(m,Q)|0,n=(n=n+Math.imul(m,ee)|0)+Math.imul(p,Q)|0,a=a+Math.imul(p,ee)|0;var Se=(d+(r=r+Math.imul(c,ie)|0)|0)+((8191&(n=(n=n+Math.imul(c,re)|0)+Math.imul(u,ie)|0))<<13)|0;d=((a=a+Math.imul(u,re)|0)+(n>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul(x,W),n=(n=Math.imul(x,z))+Math.imul(A,W)|0,a=Math.imul(A,z),r=r+Math.imul(I,j)|0,n=(n=n+Math.imul(I,H)|0)+Math.imul(P,j)|0,a=a+Math.imul(P,H)|0,r=r+Math.imul(w,$)|0,n=(n=n+Math.imul(w,Z)|0)+Math.imul(M,$)|0,a=a+Math.imul(M,Z)|0,r=r+Math.imul(b,Y)|0,n=(n=n+Math.imul(b,J)|0)+Math.imul(S,Y)|0,a=a+Math.imul(S,J)|0,r=r+Math.imul(_,Q)|0,n=(n=n+Math.imul(_,ee)|0)+Math.imul(v,Q)|0,a=a+Math.imul(v,ee)|0,r=r+Math.imul(m,ie)|0,n=(n=n+Math.imul(m,re)|0)+Math.imul(p,ie)|0,a=a+Math.imul(p,re)|0;var Te=(d+(r=r+Math.imul(c,ae)|0)|0)+((8191&(n=(n=n+Math.imul(c,se)|0)+Math.imul(u,ae)|0))<<13)|0;d=((a=a+Math.imul(u,se)|0)+(n>>>13)|0)+(Te>>>26)|0,Te&=67108863,r=Math.imul(R,W),n=(n=Math.imul(R,z))+Math.imul(O,W)|0,a=Math.imul(O,z),r=r+Math.imul(x,j)|0,n=(n=n+Math.imul(x,H)|0)+Math.imul(A,j)|0,a=a+Math.imul(A,H)|0,r=r+Math.imul(I,$)|0,n=(n=n+Math.imul(I,Z)|0)+Math.imul(P,$)|0,a=a+Math.imul(P,Z)|0,r=r+Math.imul(w,Y)|0,n=(n=n+Math.imul(w,J)|0)+Math.imul(M,Y)|0,a=a+Math.imul(M,J)|0,r=r+Math.imul(b,Q)|0,n=(n=n+Math.imul(b,ee)|0)+Math.imul(S,Q)|0,a=a+Math.imul(S,ee)|0,r=r+Math.imul(_,ie)|0,n=(n=n+Math.imul(_,re)|0)+Math.imul(v,ie)|0,a=a+Math.imul(v,re)|0,r=r+Math.imul(m,ae)|0,n=(n=n+Math.imul(m,se)|0)+Math.imul(p,ae)|0,a=a+Math.imul(p,se)|0;var we=(d+(r=r+Math.imul(c,le)|0)|0)+((8191&(n=(n=n+Math.imul(c,de)|0)+Math.imul(u,le)|0))<<13)|0;d=((a=a+Math.imul(u,de)|0)+(n>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(F,W),n=(n=Math.imul(F,z))+Math.imul(D,W)|0,a=Math.imul(D,z),r=r+Math.imul(R,j)|0,n=(n=n+Math.imul(R,H)|0)+Math.imul(O,j)|0,a=a+Math.imul(O,H)|0,r=r+Math.imul(x,$)|0,n=(n=n+Math.imul(x,Z)|0)+Math.imul(A,$)|0,a=a+Math.imul(A,Z)|0,r=r+Math.imul(I,Y)|0,n=(n=n+Math.imul(I,J)|0)+Math.imul(P,Y)|0,a=a+Math.imul(P,J)|0,r=r+Math.imul(w,Q)|0,n=(n=n+Math.imul(w,ee)|0)+Math.imul(M,Q)|0,a=a+Math.imul(M,ee)|0,r=r+Math.imul(b,ie)|0,n=(n=n+Math.imul(b,re)|0)+Math.imul(S,ie)|0,a=a+Math.imul(S,re)|0,r=r+Math.imul(_,ae)|0,n=(n=n+Math.imul(_,se)|0)+Math.imul(v,ae)|0,a=a+Math.imul(v,se)|0,r=r+Math.imul(m,le)|0,n=(n=n+Math.imul(m,de)|0)+Math.imul(p,le)|0,a=a+Math.imul(p,de)|0;var Me=(d+(r=r+Math.imul(c,ce)|0)|0)+((8191&(n=(n=n+Math.imul(c,ue)|0)+Math.imul(u,ce)|0))<<13)|0;d=((a=a+Math.imul(u,ue)|0)+(n>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul(N,W),n=(n=Math.imul(N,z))+Math.imul(V,W)|0,a=Math.imul(V,z),r=r+Math.imul(F,j)|0,n=(n=n+Math.imul(F,H)|0)+Math.imul(D,j)|0,a=a+Math.imul(D,H)|0,r=r+Math.imul(R,$)|0,n=(n=n+Math.imul(R,Z)|0)+Math.imul(O,$)|0,a=a+Math.imul(O,Z)|0,r=r+Math.imul(x,Y)|0,n=(n=n+Math.imul(x,J)|0)+Math.imul(A,Y)|0,a=a+Math.imul(A,J)|0,r=r+Math.imul(I,Q)|0,n=(n=n+Math.imul(I,ee)|0)+Math.imul(P,Q)|0,a=a+Math.imul(P,ee)|0,r=r+Math.imul(w,ie)|0,n=(n=n+Math.imul(w,re)|0)+Math.imul(M,ie)|0,a=a+Math.imul(M,re)|0,r=r+Math.imul(b,ae)|0,n=(n=n+Math.imul(b,se)|0)+Math.imul(S,ae)|0,a=a+Math.imul(S,se)|0,r=r+Math.imul(_,le)|0,n=(n=n+Math.imul(_,de)|0)+Math.imul(v,le)|0,a=a+Math.imul(v,de)|0,r=r+Math.imul(m,ce)|0,n=(n=n+Math.imul(m,ue)|0)+Math.imul(p,ce)|0,a=a+Math.imul(p,ue)|0;var Ce=(d+(r=r+Math.imul(c,me)|0)|0)+((8191&(n=(n=n+Math.imul(c,pe)|0)+Math.imul(u,me)|0))<<13)|0;d=((a=a+Math.imul(u,pe)|0)+(n>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,r=Math.imul(N,j),n=(n=Math.imul(N,H))+Math.imul(V,j)|0,a=Math.imul(V,H),r=r+Math.imul(F,$)|0,n=(n=n+Math.imul(F,Z)|0)+Math.imul(D,$)|0,a=a+Math.imul(D,Z)|0,r=r+Math.imul(R,Y)|0,n=(n=n+Math.imul(R,J)|0)+Math.imul(O,Y)|0,a=a+Math.imul(O,J)|0,r=r+Math.imul(x,Q)|0,n=(n=n+Math.imul(x,ee)|0)+Math.imul(A,Q)|0,a=a+Math.imul(A,ee)|0,r=r+Math.imul(I,ie)|0,n=(n=n+Math.imul(I,re)|0)+Math.imul(P,ie)|0,a=a+Math.imul(P,re)|0,r=r+Math.imul(w,ae)|0,n=(n=n+Math.imul(w,se)|0)+Math.imul(M,ae)|0,a=a+Math.imul(M,se)|0,r=r+Math.imul(b,le)|0,n=(n=n+Math.imul(b,de)|0)+Math.imul(S,le)|0,a=a+Math.imul(S,de)|0,r=r+Math.imul(_,ce)|0,n=(n=n+Math.imul(_,ue)|0)+Math.imul(v,ce)|0,a=a+Math.imul(v,ue)|0;var Ie=(d+(r=r+Math.imul(m,me)|0)|0)+((8191&(n=(n=n+Math.imul(m,pe)|0)+Math.imul(p,me)|0))<<13)|0;d=((a=a+Math.imul(p,pe)|0)+(n>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,r=Math.imul(N,$),n=(n=Math.imul(N,Z))+Math.imul(V,$)|0,a=Math.imul(V,Z),r=r+Math.imul(F,Y)|0,n=(n=n+Math.imul(F,J)|0)+Math.imul(D,Y)|0,a=a+Math.imul(D,J)|0,r=r+Math.imul(R,Q)|0,n=(n=n+Math.imul(R,ee)|0)+Math.imul(O,Q)|0,a=a+Math.imul(O,ee)|0,r=r+Math.imul(x,ie)|0,n=(n=n+Math.imul(x,re)|0)+Math.imul(A,ie)|0,a=a+Math.imul(A,re)|0,r=r+Math.imul(I,ae)|0,n=(n=n+Math.imul(I,se)|0)+Math.imul(P,ae)|0,a=a+Math.imul(P,se)|0,r=r+Math.imul(w,le)|0,n=(n=n+Math.imul(w,de)|0)+Math.imul(M,le)|0,a=a+Math.imul(M,de)|0,r=r+Math.imul(b,ce)|0,n=(n=n+Math.imul(b,ue)|0)+Math.imul(S,ce)|0,a=a+Math.imul(S,ue)|0;var Pe=(d+(r=r+Math.imul(_,me)|0)|0)+((8191&(n=(n=n+Math.imul(_,pe)|0)+Math.imul(v,me)|0))<<13)|0;d=((a=a+Math.imul(v,pe)|0)+(n>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,r=Math.imul(N,Y),n=(n=Math.imul(N,J))+Math.imul(V,Y)|0,a=Math.imul(V,J),r=r+Math.imul(F,Q)|0,n=(n=n+Math.imul(F,ee)|0)+Math.imul(D,Q)|0,a=a+Math.imul(D,ee)|0,r=r+Math.imul(R,ie)|0,n=(n=n+Math.imul(R,re)|0)+Math.imul(O,ie)|0,a=a+Math.imul(O,re)|0,r=r+Math.imul(x,ae)|0,n=(n=n+Math.imul(x,se)|0)+Math.imul(A,ae)|0,a=a+Math.imul(A,se)|0,r=r+Math.imul(I,le)|0,n=(n=n+Math.imul(I,de)|0)+Math.imul(P,le)|0,a=a+Math.imul(P,de)|0,r=r+Math.imul(w,ce)|0,n=(n=n+Math.imul(w,ue)|0)+Math.imul(M,ce)|0,a=a+Math.imul(M,ue)|0;var Ee=(d+(r=r+Math.imul(b,me)|0)|0)+((8191&(n=(n=n+Math.imul(b,pe)|0)+Math.imul(S,me)|0))<<13)|0;d=((a=a+Math.imul(S,pe)|0)+(n>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(N,Q),n=(n=Math.imul(N,ee))+Math.imul(V,Q)|0,a=Math.imul(V,ee),r=r+Math.imul(F,ie)|0,n=(n=n+Math.imul(F,re)|0)+Math.imul(D,ie)|0,a=a+Math.imul(D,re)|0,r=r+Math.imul(R,ae)|0,n=(n=n+Math.imul(R,se)|0)+Math.imul(O,ae)|0,a=a+Math.imul(O,se)|0,r=r+Math.imul(x,le)|0,n=(n=n+Math.imul(x,de)|0)+Math.imul(A,le)|0,a=a+Math.imul(A,de)|0,r=r+Math.imul(I,ce)|0,n=(n=n+Math.imul(I,ue)|0)+Math.imul(P,ce)|0,a=a+Math.imul(P,ue)|0;var xe=(d+(r=r+Math.imul(w,me)|0)|0)+((8191&(n=(n=n+Math.imul(w,pe)|0)+Math.imul(M,me)|0))<<13)|0;d=((a=a+Math.imul(M,pe)|0)+(n>>>13)|0)+(xe>>>26)|0,xe&=67108863,r=Math.imul(N,ie),n=(n=Math.imul(N,re))+Math.imul(V,ie)|0,a=Math.imul(V,re),r=r+Math.imul(F,ae)|0,n=(n=n+Math.imul(F,se)|0)+Math.imul(D,ae)|0,a=a+Math.imul(D,se)|0,r=r+Math.imul(R,le)|0,n=(n=n+Math.imul(R,de)|0)+Math.imul(O,le)|0,a=a+Math.imul(O,de)|0,r=r+Math.imul(x,ce)|0,n=(n=n+Math.imul(x,ue)|0)+Math.imul(A,ce)|0,a=a+Math.imul(A,ue)|0;var Ae=(d+(r=r+Math.imul(I,me)|0)|0)+((8191&(n=(n=n+Math.imul(I,pe)|0)+Math.imul(P,me)|0))<<13)|0;d=((a=a+Math.imul(P,pe)|0)+(n>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,r=Math.imul(N,ae),n=(n=Math.imul(N,se))+Math.imul(V,ae)|0,a=Math.imul(V,se),r=r+Math.imul(F,le)|0,n=(n=n+Math.imul(F,de)|0)+Math.imul(D,le)|0,a=a+Math.imul(D,de)|0,r=r+Math.imul(R,ce)|0,n=(n=n+Math.imul(R,ue)|0)+Math.imul(O,ce)|0,a=a+Math.imul(O,ue)|0;var ke=(d+(r=r+Math.imul(x,me)|0)|0)+((8191&(n=(n=n+Math.imul(x,pe)|0)+Math.imul(A,me)|0))<<13)|0;d=((a=a+Math.imul(A,pe)|0)+(n>>>13)|0)+(ke>>>26)|0,ke&=67108863,r=Math.imul(N,le),n=(n=Math.imul(N,de))+Math.imul(V,le)|0,a=Math.imul(V,de),r=r+Math.imul(F,ce)|0,n=(n=n+Math.imul(F,ue)|0)+Math.imul(D,ce)|0,a=a+Math.imul(D,ue)|0;var Re=(d+(r=r+Math.imul(R,me)|0)|0)+((8191&(n=(n=n+Math.imul(R,pe)|0)+Math.imul(O,me)|0))<<13)|0;d=((a=a+Math.imul(O,pe)|0)+(n>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul(N,ce),n=(n=Math.imul(N,ue))+Math.imul(V,ce)|0,a=Math.imul(V,ue);var Oe=(d+(r=r+Math.imul(F,me)|0)|0)+((8191&(n=(n=n+Math.imul(F,pe)|0)+Math.imul(D,me)|0))<<13)|0;d=((a=a+Math.imul(D,pe)|0)+(n>>>13)|0)+(Oe>>>26)|0,Oe&=67108863;var Le=(d+(r=Math.imul(N,me))|0)+((8191&(n=(n=Math.imul(N,pe))+Math.imul(V,me)|0))<<13)|0;return d=((a=Math.imul(V,pe))+(n>>>13)|0)+(Le>>>26)|0,Le&=67108863,l[0]=ge,l[1]=_e,l[2]=ve,l[3]=ye,l[4]=be,l[5]=Se,l[6]=Te,l[7]=we,l[8]=Me,l[9]=Ce,l[10]=Ie,l[11]=Pe,l[12]=Ee,l[13]=xe,l[14]=Ae,l[15]=ke,l[16]=Re,l[17]=Oe,l[18]=Le,0!==d&&(l[19]=d,i.length++),i};function g(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var r=0,n=0,a=0;a<i.length-1;a++){var s=n;n=0;for(var o=67108863&r,l=Math.min(a,t.length-1),d=Math.max(0,a-e.length+1);d<=l;d++){var h=a-d,c=(0|e.words[h])*(0|t.words[d]),u=67108863&c;o=67108863&(u=u+o|0),n+=(s=(s=s+(c/67108864|0)|0)+(u>>>26)|0)>>>26,s&=67108863}i.words[a]=o,r=s,s=n}return 0!==r?i.words[a]=r:i.length--,i._strip()}function _(e,t,i){return g(e,t,i)}function v(e,t){this.x=e,this.y=t}Math.imul||(p=m),a.prototype.mulTo=function(e,t){var i=this.length+e.length;return 10===this.length&&10===e.length?p(this,e,t):i<63?m(this,e,t):i<1024?g(this,e,t):_(this,e,t)},v.prototype.makeRBT=function(e){for(var t=new Array(e),i=a.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,i,e);return t},v.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var r=0,n=0;n<t;n++)r|=(1&e)<<t-n-1,e>>=1;return r},v.prototype.permute=function(e,t,i,r,n,a){for(var s=0;s<a;s++)r[s]=t[e[s]],n[s]=i[e[s]]},v.prototype.transform=function(e,t,i,r,n,a){this.permute(a,e,t,i,r,n);for(var s=1;s<n;s<<=1)for(var o=s<<1,l=Math.cos(2*Math.PI/o),d=Math.sin(2*Math.PI/o),h=0;h<n;h+=o)for(var c=l,u=d,f=0;f<s;f++){var m=i[h+f],p=r[h+f],g=i[h+f+s],_=r[h+f+s],v=c*g-u*_;_=c*_+u*g,g=v,i[h+f]=m+g,r[h+f]=p+_,i[h+f+s]=m-g,r[h+f+s]=p-_,f!==o&&(v=l*c-d*u,u=l*u+d*c,c=v)}},v.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),r=1&i,n=0;for(i=i/2|0;i;i>>>=1)n++;return 1<<n+1+r},v.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var r=0;r<i/2;r++){var n=e[r];e[r]=e[i-r-1],e[i-r-1]=n,n=t[r],t[r]=-t[i-r-1],t[i-r-1]=-n}},v.prototype.normalize13b=function(e,t){for(var i=0,r=0;r<t/2;r++){var n=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+i;e[r]=67108863&n,i=n<67108864?0:n/67108864|0}return e},v.prototype.convert13b=function(e,t,i,n){for(var a=0,s=0;s<t;s++)a+=0|e[s],i[2*s]=8191&a,a>>>=13,i[2*s+1]=8191&a,a>>>=13;for(s=2*t;s<n;++s)i[s]=0;r(0===a),r(0==(-8192&a))},v.prototype.stub=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0;return t},v.prototype.mulp=function(e,t,i){var r=2*this.guessLen13b(e.length,t.length),n=this.makeRBT(r),a=this.stub(r),s=new Array(r),o=new Array(r),l=new Array(r),d=new Array(r),h=new Array(r),c=new Array(r),u=i.words;u.length=r,this.convert13b(e.words,e.length,s,r),this.convert13b(t.words,t.length,d,r),this.transform(s,a,o,l,r,n),this.transform(d,a,h,c,r,n);for(var f=0;f<r;f++){var m=o[f]*h[f]-l[f]*c[f];l[f]=o[f]*c[f]+l[f]*h[f],o[f]=m}return this.conjugate(o,l,r),this.transform(o,l,u,a,r,n),this.conjugate(u,a,r),this.normalize13b(u,r),i.negative=e.negative^t.negative,i.length=e.length+t.length,i._strip()},a.prototype.mul=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},a.prototype.mulf=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),_(this,e,t)},a.prototype.imul=function(e){return this.clone().mulTo(e,this)},a.prototype.imuln=function(e){var t=e<0;t&&(e=-e),r("number"==typeof e),r(e<67108864);for(var i=0,n=0;n<this.length;n++){var a=(0|this.words[n])*e,s=(67108863&a)+(67108863&i);i>>=26,i+=a/67108864|0,i+=s>>>26,this.words[n]=67108863&s}return 0!==i&&(this.words[n]=i,this.length++),t?this.ineg():this},a.prototype.muln=function(e){return this.clone().imuln(e)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),i=0;i<t.length;i++){var r=i/26|0,n=i%26;t[i]=e.words[r]>>>n&1}return t}(e);if(0===t.length)return new a(1);for(var i=this,r=0;r<t.length&&0===t[r];r++,i=i.sqr());if(++r<t.length)for(var n=i.sqr();r<t.length;r++,n=n.sqr())0!==t[r]&&(i=i.mul(n));return i},a.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,i=e%26,n=(e-i)/26,a=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(t=0;t<this.length;t++){var o=this.words[t]&a,l=(0|this.words[t])-o<<i;this.words[t]=l|s,s=o>>>26-i}s&&(this.words[t]=s,this.length++)}if(0!==n){for(t=this.length-1;t>=0;t--)this.words[t+n]=this.words[t];for(t=0;t<n;t++)this.words[t]=0;this.length+=n}return this._strip()},a.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},a.prototype.iushrn=function(e,t,i){var n;r("number"==typeof e&&e>=0),n=t?(t-t%26)/26:0;var a=e%26,s=Math.min((e-a)/26,this.length),o=67108863^67108863>>>a<<a,l=i;if(n-=s,n=Math.max(0,n),l){for(var d=0;d<s;d++)l.words[d]=this.words[d];l.length=s}if(0===s);else if(this.length>s)for(this.length-=s,d=0;d<this.length;d++)this.words[d]=this.words[d+s];else this.words[0]=0,this.length=1;var h=0;for(d=this.length-1;d>=0&&(0!==h||d>=n);d--){var c=0|this.words[d];this.words[d]=h<<26-a|c>>>a,h=c&o}return l&&0!==h&&(l.words[l.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},a.prototype.ishrn=function(e,t,i){return r(0===this.negative),this.iushrn(e,t,i)},a.prototype.shln=function(e){return this.clone().ishln(e)},a.prototype.ushln=function(e){return this.clone().iushln(e)},a.prototype.shrn=function(e){return this.clone().ishrn(e)},a.prototype.ushrn=function(e){return this.clone().iushrn(e)},a.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26,n=1<<t;return!(this.length<=i||!(this.words[i]&n))},a.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==t&&i++,this.length=Math.min(i,this.length),0!==t){var n=67108863^67108863>>>t<<t;this.words[this.length-1]&=n}return this._strip()},a.prototype.maskn=function(e){return this.clone().imaskn(e)},a.prototype.iaddn=function(e){return r("number"==typeof e),r(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},a.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},a.prototype.isubn=function(e){if(r("number"==typeof e),r(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},a.prototype.addn=function(e){return this.clone().iaddn(e)},a.prototype.subn=function(e){return this.clone().isubn(e)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(e,t,i){var n,a,s=e.length+i;this._expand(s);var o=0;for(n=0;n<e.length;n++){a=(0|this.words[n+i])+o;var l=(0|e.words[n])*t;o=((a-=67108863&l)>>26)-(l/67108864|0),this.words[n+i]=67108863&a}for(;n<this.length-i;n++)o=(a=(0|this.words[n+i])+o)>>26,this.words[n+i]=67108863&a;if(0===o)return this._strip();for(r(-1===o),o=0,n=0;n<this.length;n++)o=(a=-(0|this.words[n])+o)>>26,this.words[n]=67108863&a;return this.negative=1,this._strip()},a.prototype._wordDiv=function(e,t){var i=(this.length,e.length),r=this.clone(),n=e,s=0|n.words[n.length-1];0!=(i=26-this._countBits(s))&&(n=n.ushln(i),r.iushln(i),s=0|n.words[n.length-1]);var o,l=r.length-n.length;if("mod"!==t){(o=new a(null)).length=l+1,o.words=new Array(o.length);for(var d=0;d<o.length;d++)o.words[d]=0}var h=r.clone()._ishlnsubmul(n,1,l);0===h.negative&&(r=h,o&&(o.words[l]=1));for(var c=l-1;c>=0;c--){var u=67108864*(0|r.words[n.length+c])+(0|r.words[n.length+c-1]);for(u=Math.min(u/s|0,67108863),r._ishlnsubmul(n,u,c);0!==r.negative;)u--,r.negative=0,r._ishlnsubmul(n,1,c),r.isZero()||(r.negative^=1);o&&(o.words[c]=u)}return o&&o._strip(),r._strip(),"div"!==t&&0!==i&&r.iushrn(i),{div:o||null,mod:r}},a.prototype.divmod=function(e,t,i){return r(!e.isZero()),this.isZero()?{div:new a(0),mod:new a(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(n=o.div.neg()),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.iadd(e)),{div:n,mod:s}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(n=o.div.neg()),{div:n,mod:o.mod}):0!=(this.negative&e.negative)?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.isub(e)),{div:o.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new a(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new a(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new a(this.modrn(e.words[0]))}:this._wordDiv(e,t);var n,s,o},a.prototype.div=function(e){return this.divmod(e,"div",!1).div},a.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},a.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},a.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),n=e.andln(1),a=i.cmp(r);return a<0||1===n&&0===a?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},a.prototype.modrn=function(e){var t=e<0;t&&(e=-e),r(e<=67108863);for(var i=(1<<26)%e,n=0,a=this.length-1;a>=0;a--)n=(i*n+(0|this.words[a]))%e;return t?-n:n},a.prototype.modn=function(e){return this.modrn(e)},a.prototype.idivn=function(e){var t=e<0;t&&(e=-e),r(e<=67108863);for(var i=0,n=this.length-1;n>=0;n--){var a=(0|this.words[n])+67108864*i;this.words[n]=a/e|0,i=a%e}return this._strip(),t?this.ineg():this},a.prototype.divn=function(e){return this.clone().idivn(e)},a.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n=new a(1),s=new a(0),o=new a(0),l=new a(1),d=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++d;for(var h=i.clone(),c=t.clone();!t.isZero();){for(var u=0,f=1;0==(t.words[0]&f)&&u<26;++u,f<<=1);if(u>0)for(t.iushrn(u);u-- >0;)(n.isOdd()||s.isOdd())&&(n.iadd(h),s.isub(c)),n.iushrn(1),s.iushrn(1);for(var m=0,p=1;0==(i.words[0]&p)&&m<26;++m,p<<=1);if(m>0)for(i.iushrn(m);m-- >0;)(o.isOdd()||l.isOdd())&&(o.iadd(h),l.isub(c)),o.iushrn(1),l.iushrn(1);t.cmp(i)>=0?(t.isub(i),n.isub(o),s.isub(l)):(i.isub(t),o.isub(n),l.isub(s))}return{a:o,b:l,gcd:i.iushln(d)}},a.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n,s=new a(1),o=new a(0),l=i.clone();t.cmpn(1)>0&&i.cmpn(1)>0;){for(var d=0,h=1;0==(t.words[0]&h)&&d<26;++d,h<<=1);if(d>0)for(t.iushrn(d);d-- >0;)s.isOdd()&&s.iadd(l),s.iushrn(1);for(var c=0,u=1;0==(i.words[0]&u)&&c<26;++c,u<<=1);if(c>0)for(i.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(l),o.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(o)):(i.isub(t),o.isub(s))}return(n=0===t.cmpn(1)?s:o).cmpn(0)<0&&n.iadd(e),n},a.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var r=0;t.isEven()&&i.isEven();r++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var n=t.cmp(i);if(n<0){var a=t;t=i,i=a}else if(0===n||0===i.cmpn(1))break;t.isub(i)}return i.iushln(r)},a.prototype.invm=function(e){return this.egcd(e).a.umod(e)},a.prototype.isEven=function(){return 0==(1&this.words[0])},a.prototype.isOdd=function(){return 1==(1&this.words[0])},a.prototype.andln=function(e){return this.words[0]&e},a.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,i=(e-t)/26,n=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=n,this;for(var a=n,s=i;0!==a&&s<this.length;s++){var o=0|this.words[s];a=(o+=a)>>>26,o&=67108863,this.words[s]=o}return 0!==a&&(this.words[s]=a,this.length++),this},a.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},a.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this._strip(),this.length>1)t=1;else{i&&(e=-e),r(e<=67108863,"Number is too big");var n=0|this.words[0];t=n===e?0:n<e?-1:1}return 0!==this.negative?0|-t:t},a.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},a.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,i=this.length-1;i>=0;i--){var r=0|this.words[i],n=0|e.words[i];if(r!==n){r<n?t=-1:r>n&&(t=1);break}}return t},a.prototype.gtn=function(e){return 1===this.cmpn(e)},a.prototype.gt=function(e){return 1===this.cmp(e)},a.prototype.gten=function(e){return this.cmpn(e)>=0},a.prototype.gte=function(e){return this.cmp(e)>=0},a.prototype.ltn=function(e){return-1===this.cmpn(e)},a.prototype.lt=function(e){return-1===this.cmp(e)},a.prototype.lten=function(e){return this.cmpn(e)<=0},a.prototype.lte=function(e){return this.cmp(e)<=0},a.prototype.eqn=function(e){return 0===this.cmpn(e)},a.prototype.eq=function(e){return 0===this.cmp(e)},a.red=function(e){return new C(e)},a.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},a.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(e){return this.red=e,this},a.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},a.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},a.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},a.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},a.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},a.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},a.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},a.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},a.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var y={k256:null,p224:null,p192:null,p25519:null};function b(e,t){this.name=e,this.p=new a(t,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function S(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function T(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function w(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function M(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function C(e){if("string"==typeof e){var t=a._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function I(e){C.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}b.prototype._tmp=function(){var e=new a(null);return e.words=new Array(Math.ceil(this.n/13)),e},b.prototype.ireduce=function(e){var t,i=e;do{this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(t>this.n);var r=t<this.n?-1:i.ucmp(this.p);return 0===r?(i.words[0]=0,i.length=1):r>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},b.prototype.split=function(e,t){e.iushrn(this.n,0,t)},b.prototype.imulK=function(e){return e.imul(this.k)},n(S,b),S.prototype.split=function(e,t){for(var i=Math.min(e.length,9),r=0;r<i;r++)t.words[r]=e.words[r];if(t.length=i,e.length<=9)return e.words[0]=0,void(e.length=1);var n=e.words[9];for(t.words[t.length++]=4194303&n,r=10;r<e.length;r++){var a=0|e.words[r];e.words[r-10]=(4194303&a)<<4|n>>>22,n=a}n>>>=22,e.words[r-10]=n,0===n&&e.length>10?e.length-=10:e.length-=9},S.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var r=0|e.words[i];t+=977*r,e.words[i]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},n(T,b),n(w,b),n(M,b),M.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var r=19*(0|e.words[i])+t,n=67108863&r;r>>>=26,e.words[i]=n,t=r}return 0!==t&&(e.words[e.length++]=t),e},a._prime=function(e){if(y[e])return y[e];var t;if("k256"===e)t=new S;else if("p224"===e)t=new T;else if("p192"===e)t=new w;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new M}return y[e]=t,t},C.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},C.prototype._verify2=function(e,t){r(0==(e.negative|t.negative),"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},C.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(d(e,e.umod(this.m)._forceRed(this)),e)},C.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},C.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},C.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},C.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},C.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i},C.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},C.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},C.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},C.prototype.isqr=function(e){return this.imul(e,e.clone())},C.prototype.sqr=function(e){return this.mul(e,e)},C.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var i=this.m.add(new a(1)).iushrn(2);return this.pow(e,i)}for(var n=this.m.subn(1),s=0;!n.isZero()&&0===n.andln(1);)s++,n.iushrn(1);r(!n.isZero());var o=new a(1).toRed(this),l=o.redNeg(),d=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new a(2*h*h).toRed(this);0!==this.pow(h,d).cmp(l);)h.redIAdd(l);for(var c=this.pow(h,n),u=this.pow(e,n.addn(1).iushrn(1)),f=this.pow(e,n),m=s;0!==f.cmp(o);){for(var p=f,g=0;0!==p.cmp(o);g++)p=p.redSqr();r(g<m);var _=this.pow(c,new a(1).iushln(m-g-1));u=u.redMul(_),c=_.redSqr(),f=f.redMul(c),m=g}return u},C.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},C.prototype.pow=function(e,t){if(t.isZero())return new a(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=new Array(16);i[0]=new a(1).toRed(this),i[1]=e;for(var r=2;r<i.length;r++)i[r]=this.mul(i[r-1],e);var n=i[0],s=0,o=0,l=t.bitLength()%26;for(0===l&&(l=26),r=t.length-1;r>=0;r--){for(var d=t.words[r],h=l-1;h>=0;h--){var c=d>>h&1;n!==i[0]&&(n=this.sqr(n)),0!==c||0!==s?(s<<=1,s|=c,(4==++o||0===r&&0===h)&&(n=this.mul(n,i[s]),o=0,s=0)):o=0}l=26}return n},C.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},C.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},a.mont=function(e){return new I(e)},n(I,C),I.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},I.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},I.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),a=n;return n.cmp(this.m)>=0?a=n.isub(this.m):n.cmpn(0)<0&&(a=n.iadd(this.m)),a._forceRed(this)},I.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new a(0)._forceRed(this);var i=e.mul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},I.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,i(83)(e))},function(e,t,i){var r=i(26),n=i(121).Reporter,a=i(43).Buffer;function s(e,t){n.call(this,t),a.isBuffer(e)?(this.base=e,this.offset=0,this.length=e.length):this.error("Input not Buffer")}function o(e,t){if(Array.isArray(e))this.length=0,this.value=e.map((function(e){return e instanceof o||(e=new o(e,t)),this.length+=e.length,e}),this);else if("number"==typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"==typeof e)this.value=e,this.length=a.byteLength(e);else{if(!a.isBuffer(e))return t.error("Unsupported type: "+typeof e);this.value=e,this.length=e.length}}r(s,n),t.DecoderBuffer=s,s.prototype.save=function(){return{offset:this.offset,reporter:n.prototype.save.call(this)}},s.prototype.restore=function(e){var t=new s(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,n.prototype.restore.call(this,e.reporter),t},s.prototype.isEmpty=function(){return this.offset===this.length},s.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},s.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");var i=new s(this.base);return i._reporterState=this._reporterState,i.offset=this.offset,i.length=this.offset+e,this.offset+=e,i},s.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},t.EncoderBuffer=o,o.prototype.join=function(e,t){return e||(e=new a(this.length)),t||(t=0),0===this.length||(Array.isArray(this.value)?this.value.forEach((function(i){i.join(e,t),t+=i.length})):("number"==typeof this.value?e[t]=this.value:"string"==typeof this.value?e.write(this.value,t):a.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length)),e}},function(e,t,i){var r=t;r._reverse=function(e){var t={};return Object.keys(e).forEach((function(i){(0|i)==i&&(i|=0);var r=e[i];t[r]=i})),t},r.der=i(360)},function(e,t,i){var r=i(26),n=i(120),a=n.base,s=n.bignum,o=n.constants.der;function l(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new d,this.tree._init(e.body)}function d(e){a.Node.call(this,"der",e)}function h(e,t){var i=e.readUInt8(t);if(e.isError(i))return i;var r=o.tagClass[i>>6],n=0==(32&i);if(31==(31&i)){var a=i;for(i=0;128==(128&a);){if(a=e.readUInt8(t),e.isError(a))return a;i<<=7,i|=127&a}}else i&=31;return{cls:r,primitive:n,tag:i,tagStr:o.tag[i]}}function c(e,t,i){var r=e.readUInt8(i);if(e.isError(r))return r;if(!t&&128===r)return null;if(0==(128&r))return r;var n=127&r;if(n>4)return e.error("length octect is too long");r=0;for(var a=0;a<n;a++){r<<=8;var s=e.readUInt8(i);if(e.isError(s))return s;r|=s}return r}e.exports=l,l.prototype.decode=function(e,t){return e instanceof a.DecoderBuffer||(e=new a.DecoderBuffer(e,t)),this.tree._decode(e,t)},r(d,a.Node),d.prototype._peekTag=function(e,t,i){if(e.isEmpty())return!1;var r=e.save(),n=h(e,'Failed to peek tag: "'+t+'"');return e.isError(n)?n:(e.restore(r),n.tag===t||n.tagStr===t||n.tagStr+"of"===t||i)},d.prototype._decodeTag=function(e,t,i){var r=h(e,'Failed to decode tag of "'+t+'"');if(e.isError(r))return r;var n=c(e,r.primitive,'Failed to get length of "'+t+'"');if(e.isError(n))return n;if(!i&&r.tag!==t&&r.tagStr!==t&&r.tagStr+"of"!==t)return e.error('Failed to match tag: "'+t+'"');if(r.primitive||null!==n)return e.skip(n,'Failed to match body of: "'+t+'"');var a=e.save(),s=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(s)?s:(n=e.offset-a.offset,e.restore(a),e.skip(n,'Failed to match body of: "'+t+'"'))},d.prototype._skipUntilEnd=function(e,t){for(;;){var i=h(e,t);if(e.isError(i))return i;var r,n=c(e,i.primitive,t);if(e.isError(n))return n;if(r=i.primitive||null!==n?e.skip(n):this._skipUntilEnd(e,t),e.isError(r))return r;if("end"===i.tagStr)break}},d.prototype._decodeList=function(e,t,i,r){for(var n=[];!e.isEmpty();){var a=this._peekTag(e,"end");if(e.isError(a))return a;var s=i.decode(e,"der",r);if(e.isError(s)&&a)break;n.push(s)}return n},d.prototype._decodeStr=function(e,t){if("bitstr"===t){var i=e.readUInt8();return e.isError(i)?i:{unused:i,data:e.raw()}}if("bmpstr"===t){var r=e.raw();if(r.length%2==1)return e.error("Decoding of string type: bmpstr length mismatch");for(var n="",a=0;a<r.length/2;a++)n+=String.fromCharCode(r.readUInt16BE(2*a));return n}if("numstr"===t){var s=e.raw().toString("ascii");return this._isNumstr(s)?s:e.error("Decoding of string type: numstr unsupported characters")}if("octstr"===t)return e.raw();if("objDesc"===t)return e.raw();if("printstr"===t){var o=e.raw().toString("ascii");return this._isPrintstr(o)?o:e.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(t)?e.raw().toString():e.error("Decoding of string type: "+t+" unsupported")},d.prototype._decodeObjid=function(e,t,i){for(var r,n=[],a=0;!e.isEmpty();){var s=e.readUInt8();a<<=7,a|=127&s,0==(128&s)&&(n.push(a),a=0)}128&s&&n.push(a);var o=n[0]/40|0,l=n[0]%40;if(r=i?n:[o,l].concat(n.slice(1)),t){var d=t[r.join(" ")];void 0===d&&(d=t[r.join(".")]),void 0!==d&&(r=d)}return r},d.prototype._decodeTime=function(e,t){var i=e.raw().toString();if("gentime"===t)var r=0|i.slice(0,4),n=0|i.slice(4,6),a=0|i.slice(6,8),s=0|i.slice(8,10),o=0|i.slice(10,12),l=0|i.slice(12,14);else{if("utctime"!==t)return e.error("Decoding "+t+" time is not supported yet");r=0|i.slice(0,2),n=0|i.slice(2,4),a=0|i.slice(4,6),s=0|i.slice(6,8),o=0|i.slice(8,10),l=0|i.slice(10,12),r=r<70?2e3+r:1900+r}return Date.UTC(r,n-1,a,s,o,l,0)},d.prototype._decodeNull=function(e){return null},d.prototype._decodeBool=function(e){var t=e.readUInt8();return e.isError(t)?t:0!==t},d.prototype._decodeInt=function(e,t){var i=e.raw(),r=new s(i);return t&&(r=t[r.toString(10)]||r),r},d.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getDecoder("der").tree}},function(e,t,i){var r=i(26),n=i(43).Buffer,a=i(120),s=a.base,o=a.constants.der;function l(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new d,this.tree._init(e.body)}function d(e){s.Node.call(this,"der",e)}function h(e){return e<10?"0"+e:e}e.exports=l,l.prototype.encode=function(e,t){return this.tree._encode(e,t).join()},r(d,s.Node),d.prototype._encodeComposite=function(e,t,i,r){var a,s=function(e,t,i,r){var n;if("seqof"===e?e="seq":"setof"===e&&(e="set"),o.tagByName.hasOwnProperty(e))n=o.tagByName[e];else{if("number"!=typeof e||(0|e)!==e)return r.error("Unknown tag: "+e);n=e}return n>=31?r.error("Multi-octet tag encoding unsupported"):(t||(n|=32),n|o.tagClassByName[i||"universal"]<<6)}(e,t,i,this.reporter);if(r.length<128)return(a=new n(2))[0]=s,a[1]=r.length,this._createEncoderBuffer([a,r]);for(var l=1,d=r.length;d>=256;d>>=8)l++;(a=new n(2+l))[0]=s,a[1]=128|l,d=1+l;for(var h=r.length;h>0;d--,h>>=8)a[d]=255&h;return this._createEncoderBuffer([a,r])},d.prototype._encodeStr=function(e,t){if("bitstr"===t)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===t){for(var i=new n(2*e.length),r=0;r<e.length;r++)i.writeUInt16BE(e.charCodeAt(r),2*r);return this._createEncoderBuffer(i)}return"numstr"===t?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===t?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(t)||"objDesc"===t?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+t+" unsupported")},d.prototype._encodeObjid=function(e,t,i){if("string"==typeof e){if(!t)return this.reporter.error("string objid given, but no values map found");if(!t.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=t[e].split(/[\s\.]+/g);for(var r=0;r<e.length;r++)e[r]|=0}else if(Array.isArray(e))for(e=e.slice(),r=0;r<e.length;r++)e[r]|=0;if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!i){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}var a=0;for(r=0;r<e.length;r++){var s=e[r];for(a++;s>=128;s>>=7)a++}var o=new n(a),l=o.length-1;for(r=e.length-1;r>=0;r--)for(s=e[r],o[l--]=127&s;(s>>=7)>0;)o[l--]=128|127&s;return this._createEncoderBuffer(o)},d.prototype._encodeTime=function(e,t){var i,r=new Date(e);return"gentime"===t?i=[h(r.getFullYear()),h(r.getUTCMonth()+1),h(r.getUTCDate()),h(r.getUTCHours()),h(r.getUTCMinutes()),h(r.getUTCSeconds()),"Z"].join(""):"utctime"===t?i=[h(r.getFullYear()%100),h(r.getUTCMonth()+1),h(r.getUTCDate()),h(r.getUTCHours()),h(r.getUTCMinutes()),h(r.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+t+" time is not supported yet"),this._encodeStr(i,"octstr")},d.prototype._encodeNull=function(){return this._createEncoderBuffer("")},d.prototype._encodeInt=function(e,t){if("string"==typeof e){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!t.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=t[e]}if("number"!=typeof e&&!n.isBuffer(e)){var i=e.toArray();!e.sign&&128&i[0]&&i.unshift(0),e=new n(i)}if(n.isBuffer(e)){var r=e.length;0===e.length&&r++;var a=new n(r);return e.copy(a),0===e.length&&(a[0]=0),this._createEncoderBuffer(a)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);r=1;for(var s=e;s>=256;s>>=8)r++;for(s=(a=new Array(r)).length-1;s>=0;s--)a[s]=255&e,e>>=8;return 128&a[0]&&a.unshift(0),this._createEncoderBuffer(new n(a))},d.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},d.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getEncoder("der").tree},d.prototype._skipDefault=function(e,t,i){var r,n=this._baseState;if(null===n.default)return!1;var a=e.join();if(void 0===n.defaultBuffer&&(n.defaultBuffer=this._encodeValue(n.default,t,i).join()),a.length!==n.defaultBuffer.length)return!1;for(r=0;r<a.length;r++)if(a[r]!==n.defaultBuffer[r])return!1;return!0}},function(e){e.exports=JSON.parse('{"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}')},function(e,t,i){var r=i(116),n=i(29).Buffer;function a(e){var t=n.allocUnsafe(4);return t.writeUInt32BE(e,0),t}e.exports=function(e,t){for(var i,s=n.alloc(0),o=0;s.length<t;)i=a(o++),s=n.concat([s,r("sha1").update(e).update(i).digest()]);return s.slice(0,t)}},function(e,t){e.exports=function(e,t){for(var i=e.length,r=-1;++r<i;)e[r]^=t[r];return e}},function(e,t,i){var r=i(160),n=i(29).Buffer;e.exports=function(e,t){return n.from(e.toRed(r.mont(t.modulus)).redPow(new r(t.publicExponent)).fromRed().toArray())}},function(e,t){},function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i(88),n=i(81),a=i(82),s=i(100),o=i(1),l=i(111),d=i(39);class h{static onCompleted(){this.s_fIsJsDownloadInitiated=!1,this.s_fIsDownloadCompleted=!0,r.a.sendTraceTag(554725910,n.a.msoulscat_Wac_PptSlideshow,a.a.Info,`AppForOfficeLoader: ${this.s_osfRunTimeJSFileName} downloaded.`)}static onFailure(e){this.s_fIsJsDownloadInitiated=!1,this.s_fIsDownloadCompleted=!1,this.s_scriptElement&&document.body.removeChild(this.s_scriptElement),r.a.sendTraceTag(554725911,n.a.msoulscat_Wac_PptSlideshow,a.a.Error,`Failed to delay load ${this.s_osfRunTimeJSFileName} error:${e.message}`)}static createScriptElement(e){return new Promise((t,i)=>{this.s_scriptElement=document.createElement("script"),this.s_scriptElement.addEventListener("error",i),this.s_scriptElement.addEventListener("load",t),null!=e&&-1===e.indexOf("null")?this.s_scriptElement.src=e:this.s_scriptElement.src=o.Settings.readStringOrDefault("osfRunTimeJSFileName",this.s_osfRunTimeJSFileName),o.Settings.readBooleanOrDefault("UseCrossOriginStaticScripts",!0)&&this.s_scriptElement.setAttribute("crossdomain","anonymous"),document.body.appendChild(this.s_scriptElement)})}static async load(e){if(void 0!==window[this.s_OsfRunTimeFunctionName]||this.s_fIsDownloadCompleted)this.onCompleted();else if(!this.s_fIsJsDownloadInitiated){this.s_fIsJsDownloadInitiated=!0;try{await this.createScriptElement(e),this.onCompleted()}catch(e){this.onFailure(e)}}}static get FIsDownloadInitiated(){return this.s_fIsJsDownloadInitiated}static get FIsDownloadCompleted(){return this.s_fIsDownloadCompleted}static createAppForOfficeByOsfExtensibleDataObject(e){if(null===e)return null;let t;switch(e.appReference.storeType){case 0:t="SPCatalog";break;case 2:t="OMEX";break;case 1:t="Filesystem";break;case 3:t="SPApp";break;case 4:t="Registry";break;case 6:t="UploadFileDevCatalog";break;case 7:t="excatalog";break;default:return null}let i=new l.b(e.appReference.id,e.appReference.version,e.appReference.store,t),r=new l.c(s.a.InContent,e.appInstance.appShape.id,e.appInstance.appShape.pos.y,e.appInstance.appShape.pos.x,e.appInstance.appShape.extent.w,e.appInstance.appShape.extent.h);return new l.a(i,e.appInstance.id,r,this.readAppForOfficeSettings(e.appInstance.appSettings))}static readAppForOfficeSettings(e){let t={};return void 0!==e&&e.forEach(e=>{t[e.name]=e.value}),t}static readAppForOfficeTheme(e){return null===e?new d.a:new d.a(h.readThemeColorScheme(e.clrSchm),h.readThemeFontScheme(e.ftSchm),h.readBackgroundColor(e.bgClr))}static readThemeColorScheme(e){if(void 0===e)return;let t=new d.d;return t.Accent1=new d.c(e.accent1),t.Accent2=new d.c(e.accent2),t.Accent3=new d.c(e.accent3),t.Accent4=new d.c(e.accent4),t.Accent5=new d.c(e.accent5),t.Accent6=new d.c(e.accent6),t.Background1=new d.c(e.dk1),t.Background2=new d.c(e.dk2),t.Text1=new d.c(e.lt1),t.Text2=new d.c(e.lt2),t.Hyperlink=new d.c(e.hlink),t.FollowedHyperlink=new d.c(e.folHlink),t}static readThemeFontScheme(e){if(void 0===e)return;let t=new d.e;return t.HeaderEastAsian=e.hdEAFt,t.HeaderLatin=e.hdLtnFt,t.HeaderScript=e.hdSptFt,t.HeaderLocalized=e.hdLclFt,t.BodyEastAsian=e.bdEAFt,t.BodyLatin=e.bdLtnFt,t.BodyScript=e.bdSptFt,t.BodyLocalized=e.bdLclFt,t}static readBackgroundColor(e){if(void 0!==e)return new d.c(e.Item)}}h.s_fIsJsDownloadInitiated=!1,h.s_fIsDownloadCompleted=!1,h.s_osfRunTimeJSFileName="osfruntimePPTWAC.js",h.s_OsfRunTimeFunctionName="OfficeExt"},function(e,t){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var r=new Uint8Array(16);e.exports=function(){return i(r),r}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}},function(e,t){for(var i=[],r=0;r<256;++r)i[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,n=i;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tp_0={v:"uniform mat4 uModelViewProj;uniform float uProgress;uniform float uFactor;attribute vec2 aPosition;attribute vec2 aTexcoord;attribute float aDelay;varying vec4 c;varying vec2 d;void main(void){float PI=3.14159265358979323846264;float f=clamp(uFactor*(uProgress-aDelay),0.0,1.0);f=1.0-0.5*(1.0+cos(f*PI));gl_Position=uModelViewProj*vec4(aPosition,0.0,1.0);d=aTexcoord;c=vec4(f);}",f:"precision mediump float;uniform float uStyle;varying vec4 c;varying vec2 d;uniform sampler2D uSampler1;uniform sampler2D uSampler2;float e(float x,float y){return 1.0-abs(sign(x-y));}void main(void){gl_FragColor=e(uStyle,1.0)*mix(texture2D(uSampler1,d),texture2D(uSampler2,d),c.a)+e(uStyle,2.0)*(texture2D(uSampler1,d)*c.a);}"},t.tp_5={v:"uniform mat4 uModelViewProj;uniform float uFactor;uniform float uZmovement;uniform float uDirection;uniform float uAngle;uniform float uXAxis;uniform float uBack;attribute vec4 aPosition;attribute vec2 aTexcoord;attribute vec2 aCenter;attribute float aDelay;varying vec4 e;varying vec4 c;varying vec2 d;vec3 f(float h,float i,vec3 j){return vec3(j.x,i*j.y-h*j.z,h*j.y+i*j.z);}vec3 k(float h,float i,vec3 j){return vec3(i*j.x+h*j.z,j.y,-h*j.x+i*j.z);}void main(){float PI=3.14159265358979323846264;float l=clamp(uFactor*(uAngle-aDelay),0.0,PI);l+=uBack;float m=sin(l*uDirection);float n=cos(l*uDirection);vec4 o;o.xy=aPosition.xy-aCenter;o.z=0.0;o.xyz=(uXAxis > 0.0)? f(m,n,o.xyz): k(m,n,o.xyz);o.xyz+=vec3(0,0,m*uZmovement)+vec3(aCenter.x,aCenter.y,0.0);o.w=1.0;gl_Position=uModelViewProj*o;d=aTexcoord;float p=max(0.0,n);c.rgb=vec3(clamp(p+0.3,0.0,1.0));c.a=1.0;}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler1;void main(void){gl_FragColor=texture2D(uSampler1,d)*c;}"},t.tp_6={v:"attribute vec3 aPosition;attribute vec3 aNormal;attribute vec2 aTexCoord;uniform mat4 uModelToView;uniform mat4 uModelToWorld;uniform mat4 uModelToWorldIT;uniform vec3 uLightPosition;uniform vec3 uEyePosition;uniform vec3 uAmbientColor;uniform vec4 uDiffuseColor;uniform bool uIsNormalDirectionChangeReq;varying vec4 c;varying vec2 d;void main(void){gl_Position=uModelToView*vec4(aPosition,1.0);d=aTexCoord;vec3 e=(uModelToWorld*vec4(aPosition,1.0)).xyz;vec3 f=normalize(uLightPosition-e);vec3 h=(uIsNormalDirectionChangeReq && aNormal.z < 0.0)? aNormal*vec3(-1,-1,-1): aNormal;vec3 i=normalize(uModelToWorldIT*vec4(h,0.0)).xyz;float j=max(0.0,dot(i,f));c.rgb=j*uDiffuseColor.rgb+uAmbientColor;c.a=uDiffuseColor.a;}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler;void main(void){gl_FragColor=texture2D(uSampler,vec2(1.0,1.0)-d)*c;}"},t.tp_7={v:"attribute vec2 aPosition;attribute vec3 aCenter;attribute vec2 aTexcoord;uniform mat4 uModelViewProj;uniform mat4 offsetMatrix;uniform float uProgress;uniform float opacity;uniform float style;uniform bool isX;varying vec4 c;varying vec2 d;varying vec2 e;vec3 f(float h,float i,vec3 j){return vec3(j.x,i*j.y-h*j.z,h*j.y+i*j.z);}vec3 k(float h,float i,vec3 j){return vec3(i*j.x+h*j.z,j.y,-h*j.x+i*j.z);}vec3 f(float h,float i,vec2 j){return vec3(j.x,i*j.y,h*j.y);}vec3 k(float h,float i,vec2 j){return vec3(i*j.x,j.y,-h*j.x);}void main(void){highp vec4 l=vec4(aPosition,0.0,1.0);if(style==1.0){mediump float m=uProgress;mediump float n,o;l.xyz=l.xyz-aCenter;l.w=1.0;if(! isX){if(aCenter.x < 0.5)m=-m;n=sin(m);o=cos(m);l.xyz=k(n,o,l.xy)+aCenter;l.z=l.z-uProgress/6.0;l.x=l.x+m/2.0;}else{if(aCenter.y > 0.5)m=-m;n=sin(m);o=cos(m);l.xyz=f(n,o,l.xy)+aCenter;l.z=l.z-uProgress/4.0;l.y=l.y-m/1.5;}}else if(style==2.0){mediump float p=uProgress;if(aCenter.z < 0.0)p=-p;l.z+=p;}l=l*offsetMatrix;gl_Position=uModelViewProj*l;d=aTexcoord;e=vec2(aTexcoord.y);c=vec4(opacity);}",f:"precision mediump float;varying vec4 c;varying vec2 d;varying vec2 e;uniform sampler2D uSampler1;uniform sampler2D uSampler2;void main(void){gl_FragColor=texture2D(uSampler1,d)*c*texture2D(uSampler2,e).a;}"},t.tp_9={v:"attribute vec2 aPosition;attribute vec2 aTexcoord;uniform mat4 uModelViewProj;uniform mat4 offsetMatrix;uniform mat4 dirMatrix;uniform float opacity;uniform bool isInvX;varying vec4 c;varying vec2 d;varying vec2 e;void main(void){highp vec4 f=vec4(aPosition,0.0,1.0);f=f*dirMatrix;f.y=f.y-0.5;f=f*offsetMatrix;gl_Position=uModelViewProj*f;d=vec2(isInvX ? 1.0-aTexcoord.x : aTexcoord.x,aTexcoord.y);e=vec2(aTexcoord.y);c=vec4(opacity);}",f:"precision mediump float;varying vec4 c;varying vec2 d;varying vec2 e;uniform sampler2D uSampler1;uniform sampler2D uSampler2;void main(void){gl_FragColor=texture2D(uSampler1,d)*c*texture2D(uSampler2,e).a;}"},t.tp_2={v:"uniform mat4 uModelViewProj;attribute vec2 aPosition;attribute vec2 aTexcoord;varying vec2 c;void main(void){gl_Position=uModelViewProj*vec4(aPosition,0.0,1.0);c=aTexcoord;}",f:"precision mediump float;varying vec2 c;uniform sampler2D uSampler1;void main(void){gl_FragColor=texture2D(uSampler1,c);}"},t.tp_3={v:"uniform mat4 uModelViewProj;uniform float uProgress;uniform float uFactor;uniform float uZmovement;uniform float uDirection;uniform float uAnglePlus;uniform float uMaxAngle;uniform float uZCenter;uniform float uXAxis;attribute vec4 aPosition;attribute vec2 aTexcoord;attribute vec2 aCenter;attribute float aDelay;varying vec4 e;varying vec4 c;varying vec2 d;vec3 f(float h,float i,vec3 j){return vec3(j.x,i*j.y-h*j.z,h*j.y+i*j.z);}vec3 k(float h,float i,vec3 j){return vec3(i*j.x+h*j.z,j.y,-h*j.x+i*j.z);}void main(){float PI=3.14159265358979323846264;float l=clamp(uFactor*(uProgress-aDelay),0.0,uMaxAngle);l=(1.0-cos(l*PI/uMaxAngle))/2.0*uMaxAngle;float m=(sin((PI-uMaxAngle)/2.0+l)-sin((PI-uMaxAngle)/2.0))*uZmovement;l+=uAnglePlus;float n=sin(l*uDirection);float o=cos(l*uDirection);vec3 p=vec3(aCenter.x,aCenter.y,uZCenter);vec4 q;q.xyz=aPosition.xyz-p;q.xyz=(uXAxis > 0.0)? f(n,o,q.xyz): k(n,o,q.xyz);q.xyz+=vec3(0,0,m)+p;q.w=1.0;gl_Position=uModelViewProj*q;d=aTexcoord;float s=max(0.0,o);c.rgb=vec3(clamp(s+0.3,0.0,1.0));c.a=1.0;}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler1;void main(void){gl_FragColor=texture2D(uSampler1,d)*c;}"},t.tp_4={v:"uniform mat4 uModelViewProj;uniform vec2 uProgress;attribute vec2 aPosition;attribute vec2 aTexcoord;attribute float aDistance;varying vec4 c;varying vec2 d;void main(void){float PI=3.14159265358979323846264;float e=6.0;float f=0.025;float h=0.3;float i=0.7;float j=(1.0-uProgress.y);float k=(aDistance-uProgress.x)*e+PI/2.0;vec4 l=vec4(aPosition,0.0,1.0);l.z=j*sin(k)*f;if(aDistance > uProgress.x){l.z=0.0;}l=uModelViewProj*l;float m=j*cos(k)*h;if(aDistance > uProgress.x)m=0.0;float n=max(0.0,m);gl_Position=l;d=aTexcoord;float o=clamp((uProgress.x-aDistance)/i,0.0,1.0);float rgb=1.0-n;c=vec4(rgb,rgb,rgb,o);}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler1;uniform sampler2D uSampler2;void main(void){gl_FragColor=mix(texture2D(uSampler1,d),texture2D(uSampler2,d),c.a);gl_FragColor.rgb*=c.rgb;}"},t.tp_1={v:"uniform mat4 uModelViewProj;uniform float uProgress;uniform float uFactor;uniform float uOpacity;attribute vec2 aPosition;attribute vec2 aTexcoord;attribute vec2 aDirection;attribute float aDelay;varying vec4 c;varying vec2 d;void main(void){vec4 e;float f=uProgress-aDelay;if(f < 0.0){f=0.0;}else{f*=uFactor;f*=f/2.0;}e.xy=aPosition.xy+f*aDirection;e.z=0.0;e.w=1.0;gl_Position=uModelViewProj*e;d=aTexcoord;c=vec4(uOpacity);}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler1;void main(void){gl_FragColor=texture2D(uSampler1,d)*c;}"},t.tp_8={v:"attribute vec4 aPosition;attribute vec2 aTexcoord;attribute vec2 aCenter;attribute float aDelay;uniform mat4 uModelViewProj;uniform float uTime;uniform float uSpinFactor;uniform float uFactor;uniform float uReverseAngle;uniform float uGrowFactor;uniform float uOpacitySpeed;varying vec4 c;varying vec2 d;vec3 e(float f,float h,vec3 i){return vec3(h*i.x-f*i.y*9.0/16.0,f*i.x*16.0/9.0+h*i.y,i.z);}void main(){float j=clamp(uTime-aDelay,0.0,1.0);mediump float k=uSpinFactor*j*uFactor*uReverseAngle;float l,m;l=sin(k);m=cos(k);highp vec4 n;n.xy=aPosition.xy-aCenter;n.xy*=1.0+j*uGrowFactor;n.z=0.0;n.y=n.y;n.xyz=e(l,m,n.xyz)+vec3(aCenter,0.0);n.w=1.0;gl_Position=uModelViewProj*n;d=aTexcoord;if(uOpacitySpeed==0.0)c=vec4(1.0);else c=vec4(1.0-pow(j,uOpacitySpeed));}",f:"precision mediump float;varying vec4 c;varying vec2 d;uniform sampler2D uSampler;void main(void){gl_FragColor=texture2D(uSampler,d)*c;}"}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getReflectionData=function(e,t){for(var i=new Uint8Array(4*e),r=0;r<e;r+=1){var n=r/e;i[4*r+0]=0,i[4*r+1]=0,i[4*r+2]=0,i[4*r+3]=230*Math.pow(n,t)}return i}},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var i,r,n,a,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&a[0]?r.return:a[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,a[1])).done)return n;switch(r=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){s.label=a[1];break}if(6===a[0]&&s.label<n[1]){s.label=n[1],n=a;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(a);break}n[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{i=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(72),l=function(){function e(e){this.m_customTransitionDataLoader=e}return e.prototype.getTransitionProperty=function(e,t,i){return a(this,void 0,void 0,(function(){var r,n;return s(this,(function(a){switch(a.label){case 0:switch(r=null,e){case o.kTransitionIds.PPT_TRANSITION_COMB:return[3,1];case o.kTransitionIds.PPT_TRANSITION_PUSH:return[3,2];case o.kTransitionIds.PPT_TRANSITION_PAN:return[3,3];case o.kTransitionIds.PPT_TRANSITION_STRIPS:case o.kTransitionIds.PPT_TRANSITION_WIPE:return[3,4];case o.kTransitionIds.PPT_TRANSITION_SPLIT:return[3,5];case o.kTransitionIds.PPT_TRANSITION_ZOOM:return[3,6];case o.kTransitionIds.PPT_TRANSITION_DIAMOND:case o.kTransitionIds.PPT_TRANSITION_PLUS:case o.kTransitionIds.PPT_TRANSITION_CIRCLE:return[3,7];case o.kTransitionIds.PPT_TRANSITION_RANDOMBAR:return[3,8];case o.kTransitionIds.PPT_TRANSITION_FADE:case o.kTransitionIds.PPT_TRANSITION_FADE_THROUGH_BLACK:return[3,9];case o.kTransitionIds.PPT_TRANSITION_CUT:return[3,10];case o.kTransitionIds.PPT_TRANSITION_DISSOLVE:return[3,11];case o.kTransitionIds.PPT_TRANSITION_COVER:return[3,12];case o.kTransitionIds.PPT_TRANSITION_UNCOVER:return[3,13];case o.kTransitionIds.PPT_TRANSITION_WHEEL:case o.kTransitionIds.PPT_TRANSITION_WHEELREVERSE:return[3,14];case o.kTransitionIds.PPT_TRANSITION_WEDGE:return[3,15];case o.kTransitionIds.PPT_TRANSITION_PRISM:return[3,16];case o.kTransitionIds.PPT_TRANSITION_BLINDS:return[3,17];case o.kTransitionIds.PPT_TRANSITION_RIPPLE:return[3,18];case o.kTransitionIds.PPT_TRANSITION_VORTEX:return[3,19];case o.kTransitionIds.PPT_TRANSITION_CHECKER:return[3,20];case o.kTransitionIds.PPT_TRANSITION_FLIP:case o.kTransitionIds.PPT_TRANSITION_SWITCH:case o.kTransitionIds.PPT_TRANSITION_FALLOVER:case o.kTransitionIds.PPT_TRANSITION_DRAPE:case o.kTransitionIds.PPT_TRANSITION_CURTAINS:case o.kTransitionIds.PPT_TRANSITION_WIND:case o.kTransitionIds.PPT_TRANSITION_PRESTIGE:case o.kTransitionIds.PPT_TRANSITION_FRACTURE:case o.kTransitionIds.PPT_TRANSITION_CRUSH:case o.kTransitionIds.PPT_TRANSITION_PEELOFF:case o.kTransitionIds.PPT_TRANSITION_PAGECURLSINGLE:case o.kTransitionIds.PPT_TRANSITION_PAGECURLDOUBLE:case o.kTransitionIds.PPT_TRANSITION_AIRPLANE:case o.kTransitionIds.PPT_TRANSITION_ORIGAMI:return[3,21];case o.kTransitionIds.PPT_TRANSITION_GLITTER:return[3,23];case o.kTransitionIds.PPT_TRANSITION_GALLERY:return[3,24];case o.kTransitionIds.PPT_TRANSITION_CONVEYOR:return[3,25];case o.kTransitionIds.PPT_TRANSITION_CROSSZOOM:return[3,26];case o.kTransitionIds.PPT_TRANSITION_FLYTHROUGH:return[3,27];case o.kTransitionIds.PPT_TRANSITION_FLYTHROUGH_CONTENT:return[3,28];case o.kTransitionIds.PPT_TRANSITION_ZOOM_WITH_SPIN:return[3,29];case o.kTransitionIds.PPT_TRANSITION_DOORS_CONTENT:return[3,30];case o.kTransitionIds.PPT_TRANSITION_DOORS:return[3,31]}return[3,32];case 1:return r=this.createCombProperty(i),[3,33];case 2:return r=this.createPushProperty(i),[3,33];case 3:return r=this.createPanProperty(i),[3,33];case 4:return r=this.createWipeProperty(i),[3,33];case 5:return r=this.createSplitProperty(i),[3,33];case 6:return r=this.createZoomProperty(i),[3,33];case 7:return r=this.createShapeProperty(i,e),[3,33];case 8:return r=this.createRandombarProperty(i),[3,33];case 9:return r=this.createFadeSmoothlyProperty(i),[3,33];case 10:return t===o.kTransitionEffectOptions.Top&&(r=this.createCutThroughBlackProperty(i)),[3,33];case 11:return r=new _(i),[3,33];case 12:return r=this.createCoverProperty(i),[3,33];case 13:return r=this.createUncoverProperty(i),[3,33];case 14:return r=this.createWheelTransitionProperty(i,e===o.kTransitionIds.PPT_TRANSITION_WHEEL),[3,33];case 15:return r=this.createWedgeTransitionProperty(i),[3,33];case 16:return r=this.createPrismProperty(i),[3,33];case 17:return r=new y(i),[3,33];case 18:return r=new S(i),[3,33];case 19:return r=new I(i),[3,33];case 20:return r=new M(i),[3,33];case 21:return[4,this.m_customTransitionDataLoader.load(e)];case 22:return n=a.sent(),r=this.createCustomProperty(e,i,n),[3,33];case 23:return r=new C(i),[3,33];case 24:return r=new T(i),[3,33];case 25:return r=new w(i),[3,33];case 26:return r=new E(i),[3,33];case 27:return r=new c(i),[3,33];case 28:return r=new h(i),[3,33];case 29:return r=new b(i),[3,33];case 30:return r=new u(i,!0),[3,33];case 31:return r=new u(i,!1),[3,33];case 32:r=this.createFadeSmoothlyProperty(i),a.label=33;case 33:return[2,r]}}))}))},e.prototype.isInvalidCustomProperty=function(e,t){if(!(t&&t.IndexBuffer&&t.PositionBufferList&&t.TextureCoordBuffer))return!0;switch(e){case o.kTransitionIds.PPT_TRANSITION_FLIP:case o.kTransitionIds.PPT_TRANSITION_SWITCH:case o.kTransitionIds.PPT_TRANSITION_PAGECURLDOUBLE:if(!t.IndexBufferBack||!t.PositionBufferListBack||!t.TextureCoordBufferBack)return!0}return!1},e.prototype.createCustomProperty=function(e,t,i){var r;if(this.isInvalidCustomProperty(e,i))return null;switch(e){case o.kTransitionIds.PPT_TRANSITION_FALLOVER:(r=new x(t,i,e)).ambient=.5;break;case o.kTransitionIds.PPT_TRANSITION_DRAPE:(r=new x(t,i,e)).ambient=.4;break;case o.kTransitionIds.PPT_TRANSITION_CURTAINS:(r=new x(t,i,e)).ambient=.8;break;case o.kTransitionIds.PPT_TRANSITION_WIND:(r=new x(t,i,e)).ambient=.9;break;case o.kTransitionIds.PPT_TRANSITION_PRESTIGE:(r=new x(t,i,e)).ambient=.8;break;case o.kTransitionIds.PPT_TRANSITION_FRACTURE:(r=new x(t,i,e)).ambient=.7;break;case o.kTransitionIds.PPT_TRANSITION_CRUSH:(r=new x(t,i,e)).ambient=.9;break;case o.kTransitionIds.PPT_TRANSITION_PEELOFF:(r=new x(t,i,e)).ambient=.65;break;case o.kTransitionIds.PPT_TRANSITION_PAGECURLSINGLE:(r=new x(t,i,e)).ambient=.8;break;case o.kTransitionIds.PPT_TRANSITION_AIRPLANE:(r=new x(t,i,e)).ambient=.6;break;case o.kTransitionIds.PPT_TRANSITION_ORIGAMI:(r=new x(t,i,e)).ambient=.8;break;case o.kTransitionIds.PPT_TRANSITION_PAGECURLDOUBLE:(r=new A(t,i,e)).ambient=.9;break;case o.kTransitionIds.PPT_TRANSITION_FLIP:case o.kTransitionIds.PPT_TRANSITION_SWITCH:(r=new A(t,i,e)).ambient=.8}return r},e.prototype.createPushProperty=function(e){var t=new p(e);return!t.forward&&t.direction>=o.kTransitionEffectOptions.Left&&t.direction<=o.kTransitionEffectOptions.Bottom&&(t.direction=(t.direction+2)%4),t.hres=1,t.vres=1,t},e.prototype.createPanProperty=function(e){var t=this.createPushProperty(e);return t.useContent=!0,t},e.prototype.createCombProperty=function(e){var t=new g(e);switch(t.factor=1,t.invertDelay=!0,t.meshType=1,e.direction){case o.kTransitionEffectOptions.Horizontal:t.hres=1,t.vres=7,t.directionFormula=10;break;case o.kTransitionEffectOptions.Vertical:t.hres=7,t.vres=1,t.directionFormula=11}return t},e.prototype.createWipeProperty=function(e){var t=new d(e);switch(t.hres=50,t.vres=50,e.direction){case o.kTransitionEffectOptions.Top:case o.kTransitionEffectOptions.Bottom:t.delayFormula=2,t.hres=1,t.invertDelay=e.direction===o.kTransitionEffectOptions.Top;break;case o.kTransitionEffectOptions.Left:case o.kTransitionEffectOptions.Right:t.delayFormula=1,t.vres=1,t.invertDelay=e.direction===o.kTransitionEffectOptions.Left;break;case o.kTransitionEffectOptions.TopLeft:case o.kTransitionEffectOptions.BottomRight:t.delayFormula=3,t.invertDelay=e.direction===o.kTransitionEffectOptions.TopLeft;break;case o.kTransitionEffectOptions.TopRight:case o.kTransitionEffectOptions.BottomLeft:t.delayFormula=4,t.invertDelay=e.direction===o.kTransitionEffectOptions.TopRight}return t},e.prototype.createSplitProperty=function(e){var t=new d(e);switch(t.hres=50,t.vres=50,e.direction){case o.kTransitionEffectOptions.HorizontalOut:case o.kTransitionEffectOptions.HorizontalIn:t.delayFormula=6,t.hres=1,t.invertDelay=e.direction===o.kTransitionEffectOptions.HorizontalIn;break;case o.kTransitionEffectOptions.VerticalOut:case o.kTransitionEffectOptions.VerticalIn:t.delayFormula=5,t.vres=1,t.invertDelay=e.direction===o.kTransitionEffectOptions.VerticalIn}return t},e.prototype.createZoomProperty=function(e){var t=new d(e);return t.hres=100,t.vres=100,t.factor=30,t.delayFormula=8,t.invertDelay=e.direction===o.kTransitionEffectOptions.ZoomIn,t},e.prototype.createShapeProperty=function(e,t){var i=new d(e);switch(i.hres=100,i.vres=100,i.factor=3,i.invertDelay=e.direction!==o.kTransitionEffectOptions.Anywhere,t){case o.kTransitionIds.PPT_TRANSITION_DIAMOND:i.delayFormula=7;break;case o.kTransitionIds.PPT_TRANSITION_PLUS:i.delayFormula=10;break;case o.kTransitionIds.PPT_TRANSITION_CIRCLE:i.delayFormula=9}return i},e.prototype.createRandombarProperty=function(e){var t=new d(e);return e.direction===o.kTransitionEffectOptions.Vertical?(t.hres=100,t.vres=1):(t.hres=1,t.vres=100),t.delayFormula=19,t},e.prototype.createFadeSmoothlyProperty=function(e){var t=new d(e);return t.hres=1,t.vres=1,t.factor=1,t.jitter=0,t.delayFormula=0,t},e.prototype.createCutThroughBlackProperty=function(e){var t=new f(e);return t.hres=1,t.vres=1,t.m_fThroughBlack=!0,t},e.prototype.createCoverProperty=function(e){var t=new m(e);return t.hres=1,t.vres=1,t.isCover=!0,t},e.prototype.createUncoverProperty=function(e){var t=this.createCoverProperty(e);return t.isCover=!1,t},e.prototype.createWheelTransitionProperty=function(e,t){var i=new v(e);if(t)switch(e.direction){case 0:case 1:i.delayFormula=11;break;case 2:i.delayFormula=12;break;case 3:i.delayFormula=13;break;case 4:case 5:case 6:case 7:i.delayFormula=14;break;case 8:default:i.delayFormula=15}else switch(e.direction){case 4:i.delayFormula=17;break;default:i.delayFormula=16}return i},e.prototype.createWedgeTransitionProperty=function(e){var t=new v(e);return t.factor=3,t.delayFormula=18,t},e.prototype.createPrismProperty=function(e){return new P(e)},e}();t.TransitionPropertyFactory=l;t.SlideTransitionInfo=function(e){this.gl=e.gl,this.engine=e.engine,this.forward=e.forward,this.direction=e.direction,this.aspectRatio=e.aspectRatio,this.incomingSlideBackground=e.incomingSlideBackground,this.outgoingSlideBackground=e.outgoingSlideBackground,this.incomingSlideForeground=e.incomingSlideForeground,this.outgoingSlideForeground=e.outgoingSlideForeground};var d=function(e){this.invertDelay=!1,this.delayFormula=0,this.meshType=0,this.hres=50,this.vres=50,this.factor=2,this.jitter=10,this.gl=e.gl,this.engine=e.engine,this.forward=e.forward,this.direction=e.direction,this.aspectRatio=e.aspectRatio,this.incomingSlideBackground=e.incomingSlideBackground,this.outgoingSlideBackground=e.outgoingSlideBackground};t.BaseTransitionProperty=d;var h=function(e){function t(t){var i=e.call(this,t)||this;switch(i.incomingSlideForeground=t.incomingSlideForeground,i.outgoingSlideForeground=t.outgoingSlideForeground,i.jitter=0,i.m_length=18,i.m_endType=0,i.m_doorType=0,i.m_fFade=!0,i.m_reflectionType=0,i.m_motionBlurFrames=2,i.m_motionBlurWidth=18,i.m_fOut=t.direction===o.kTransitionEffectOptions.GoOut||t.direction===o.kTransitionEffectOptions.OutBounce,i.hres=4,i.vres=4,i.meshType=1,i.factor=1,i.delayFormula=19,i.m_fUseContent=!0,i.m_bounceTime=15,i.m_bounceDampening=13,t.direction){case o.kTransitionEffectOptions.GoIn:case o.kTransitionEffectOptions.GoOut:i.m_endType=0;break;case o.kTransitionEffectOptions.InBounce:case o.kTransitionEffectOptions.OutBounce:i.m_endType=3}return i.m_slidingDoorSpeed=20,i}return n(t,e),t}(d);t.FlyThroughTransitionProperty=h;var c=function(e){function t(t){var i=e.call(this,t)||this;return i.isCenterBufferReq=!0,i.jitter=0,i.m_length=15,i.m_endType=0,i.m_doorType=0,i.m_fFade=!0,i.m_reflectionType=0,i.m_motionBlurFrames=2,i.m_motionBlurWidth=18,i.m_fOut=t.direction===o.kTransitionEffectOptions.GoOut,i.m_fUseContent=!1,i.m_bounceTime=7,i.m_bounceDampening=13,i.m_slidingDoorSpeed=20,i.hres=4,i.vres=4,i.meshType=1,i.factor=1,i.delayFormula=19,i}return n(t,e),t}(d);t.ZoomFlyThroughTransitionProperty=c;var u=function(e){function t(t,i){var r=e.call(this,t)||this;switch(r.incomingSlideForeground=t.incomingSlideForeground,r.outgoingSlideForeground=t.outgoingSlideForeground,r.isCenterBufferReq=!0,r.jitter=0,r.m_length=18,r.m_endType=2,t.direction){case o.kTransitionEffectOptions.Horizontal:r.m_doorType=1,r.m_isX=!0;break;case o.kTransitionEffectOptions.Vertical:r.m_doorType=2,r.m_isX=!1;break;default:throw new Error("direction should not be greater than 1")}return r.m_fFade=!1,r.m_motionBlurFrames=2,r.m_motionBlurWidth=18,r.m_fUseContent=i,r.m_slidingDoorSpeed=20,i||(r.m_length=15,r.m_reflectionType=1,r.m_slidingDoorSpeed=12),r.m_fOut=!0,r.m_bounceTime=7,r.m_bounceDampening=13,r.m_reflectionType=0,r.hres=2,r.vres=2,r.meshType=1,r.factor=1,r.delayFormula=19,r}return n(t,e),t}(d);t.DoorsTransitionProperty=u;var f=function(e){function t(t){var i=e.call(this,t)||this;return i.m_fThroughBlack=!1,i}return n(t,e),t}(d);t.CutTransitionProperty=f;var m=function(e){function t(t){var i=e.call(this,t)||this;return i.isCover=!1,i}return n(t,e),t}(d);t.CoverTransitionProperty=m;var p=function(e){function t(t){var i=e.call(this,t)||this;return i.jitter=0,i.incomingSlideForeground=t.incomingSlideForeground,i.outgoingSlideForeground=t.outgoingSlideForeground,i.useContent=!1,i}return n(t,e),t}(d);t.PushTransitionProperty=p;var g=function(e){function t(t){var i=e.call(this,t)||this;return i.direction=t.direction,i.directionFormula=10,i.delayFormula=2,i}return n(t,e),t}(d);t.CombTransitionProperty=g;var _=function(e){function t(t){var i=e.call(this,t)||this;return i.jitter=0,i.hres=54,i.vres=42,i.factor=7,i.meshType=1,i.delayFormula=19,i}return n(t,e),t}(d);t.DissolveTransitionProperty=_;var v=function(e){function t(t){var i=e.call(this,t)||this;return i.jitter=0,i.hres=127,i.vres=8,i.factor=9,i.invertDelay=!1,i.meshType=4,i.delayFormula=11,i}return n(t,e),t}(d);t.WheelTransitionProperty=v;var y=function(e){function t(t){var i=e.call(this,t)||this;return i.randomCenters=!1,i.zMovement=10,i.extraDistance=0,i.factor=2,i.jitter=0,i.delayFormula=20,i.sides=3,i.inverse=!1,i.useContent=!1,i.invertDirection=!1,i.meshType=1,i.invertDelay=!i.forward,t.direction!==o.kTransitionEffectOptions.Vertical?(i.hres=18,i.vres=1,i.xAxis=!1):(i.hres=1,i.vres=14,i.xAxis=!0),i}return n(t,e),t}(d);t.BlindsTransitionProperty=y;var b=function(e){function t(t){var i=e.call(this,t)||this;return i.factor=2,i.jitter=0,i.delayFormula=20,i.meshType=1,i.hres=1,i.vres=1,i}return n(t,e),t}(d);t.ZoomWithSpinTransitionProperty=b;var S=function(e){function t(t){var i=e.call(this,t)||this;return i.m_rippleType=t.direction,i.invertDelay=!1,i.jitter=0,i.hres=80,i.vres=80,i.factor=1,i}return n(t,e),t}(d);t.RippleTransitionProperty=S;var T=function(e){function t(t){var i=e.call(this,t)||this;return i.invertDelay=!1,i.jitter=0,i.hres=1,i.vres=1,i.factor=1,i.m_isInvX=!t.direction,i.motionType=0,i.m_fUseContent=!1,i.m_fSwivel=!0,i.m_swivelTime=22,i.m_waitTime=0,i.m_swivelZoom=100,i.m_distance=0,i.m_fReflection=!0,i.m_fFadeReflection=!1,i.m_reflectionDistance=1,i.m_swivelAngle=-10,i.meshType=1,i}return n(t,e),t}(d);t.GalleryTransitionProperty=T;var w=function(e){function t(t){var i=e.call(this,t)||this;return i.incomingSlideForeground=t.incomingSlideForeground,i.outgoingSlideForeground=t.outgoingSlideForeground,i.m_fReflection=!1,i.m_fUseContent=!0,i}return n(t,e),t}(T);t.ConveyorTransitionProperty=w;var M=function(e){function t(t){var i=e.call(this,t)||this;return i.hres=7,i.vres=5,i.factor=4,i.jitter=52,i.zMovement=0,i.xAxis=!1,i.invertDelay=!1,t.direction===o.kTransitionEffectOptions.Horizontal?(i.delayFormula=1,i.xAxis=!1):(i.delayFormula=2,i.xAxis=!0),i}return n(t,e),t}(y);t.CheckersTransitionProperty=M;var C=function(e){function t(t){var i=e.call(this,t)||this;i.factor=4,i.jitter=45,i.zMovement=0,i.xAxis=!1,i.invertDelay=!1;var r=Math.floor(t.direction/4);switch(t.direction%4){case o.kTransitionEffectOptions.Right:i.delayFormula=1,i.invertDelay=!0;break;case o.kTransitionEffectOptions.Bottom:i.delayFormula=2,i.invertDelay=!0;break;case o.kTransitionEffectOptions.Left:i.delayFormula=1;break;case o.kTransitionEffectOptions.Top:i.delayFormula=2}switch(r){case o.kTransitionPattern.PatternDiamond:i.meshType=2,i.hres=30,i.vres=15;break;case o.kTransitionPattern.PatternHexagon:i.meshType=3,i.hres=35,i.vres=16}return i}return n(t,e),t}(y);t.GlitterTransitionProperty=C;var I=function(e){function t(t){var i=e.call(this,t)||this;switch(i.hres=128,i.vres=100,i.factor=1,i.jitter=25,i.zMovement=5,i.xAxis=!1,i.invertDelay=!1,t.direction){case o.kTransitionEffectOptions.Right:i.delayFormula=1;break;case o.kTransitionEffectOptions.Bottom:i.delayFormula=2,i.xAxis=!0;break;case o.kTransitionEffectOptions.Left:i.delayFormula=1,i.invertDelay=!0;break;case o.kTransitionEffectOptions.Top:i.delayFormula=2,i.invertDelay=!0,i.xAxis=!0}return i.randomCenters=!0,i}return n(t,e),t}(y);t.VortexTransitionProperty=I;var P=function(e){function t(t){var i=this,r=t.direction%4,n=4==(4&t.direction),a=8==(8&t.direction);!t.forward&&t.direction<8&&(r=(r+2)%4),(i=e.call(this,t)||this).hres=1,i.vres=1,i.factor=1,i.sides=10,i.zMovement=10,i.invertDelay=!1,i.inverse=a,i.useContent=n,i.delayFormula=0,i.xAxis=r===o.kTransitionEffectOptions.Top||r===o.kTransitionEffectOptions.Bottom;var s=r===o.kTransitionEffectOptions.Bottom||r===o.kTransitionEffectOptions.Right;return i.invertDirection=a||!a&&!i.forward?!s:s,a&&(i.zMovement=r===o.kTransitionEffectOptions.Left||r===o.kTransitionEffectOptions.Right?-30:-22,i.extraDistance=7),i.incomingSlideForeground=t.incomingSlideForeground,i.outgoingSlideForeground=t.outgoingSlideForeground,i}return n(t,e),t}(y);t.PrismTransitionProperty=P;var E=function(e){function t(t){var i=e.call(this,t)||this;switch(i.jitter=0,i.hres=101,i.vres=101,i.factor=1,i.m_dx=3,i.m_dy=0,i.m_dz=6,i.m_deadTime=9,i.m_fInvertXZoomOut=!0,i.m_fTransitionWhite=!0,i.invertDelay=!1,i.useContent=!0,i.meshType=0,i.delayFormula=1,i.incomingSlideForeground=t.incomingSlideForeground,i.outgoingSlideForeground=t.outgoingSlideForeground,t.direction){case o.kTransitionEffectOptions.Left:i.m_fTransitionWhite=!0;break;case o.kTransitionEffectOptions.BlackFromLeft:i.invertDelay=!0,i.m_fTransitionWhite=!1;break;case o.kTransitionEffectOptions.Right:i.m_fTransitionWhite=!0;break;case o.kTransitionEffectOptions.BlackFromRight:i.invertDelay=!1,i.m_fTransitionWhite=!1}return i}return n(t,e),t}(d);t.CrossZoomTransitionProperty=E;var x=function(e){function t(t,i,r){var n=e.call(this,t)||this;return n.isInvX=!t.direction,n.indexBuffer=i.IndexBuffer,n.positionBufferList=i.PositionBufferList,n.textureCoordBuffer=i.TextureCoordBuffer,n.effectID=r,n.ambient=0,n}return n(t,e),t}(d);t.CustomTransitionProperty=x;var A=function(e){function t(t,i,r){var n=e.call(this,t,i,r)||this;return n.indexBufferBack=i.IndexBufferBack,n.positionBufferListBack=i.PositionBufferListBack,n.textureCoordBufferBack=i.TextureCoordBufferBack,n}return n(t,e),t}(x);t.CustomTransitionPropertyWithBackBuffer=A},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(162),n=i(32),a=function(){function e(e){this.transition=e}return e.prototype.init=function(e,t){void 0===t&&(t=new r.MemoryReport);try{this.transition.init(e,t)}catch(e){n.logError("Exception at Transition init : "+e)}},e.prototype.draw=function(e){try{return this.transition.draw(e)}catch(e){n.logError("Exception at Transition draw : "+e)}return!1},e.prototype.dispose=function(){try{this.transition.dispose()}catch(e){n.logError("Exception at Transition dispose : "+e)}},e}();t.TransitionWrapper=a},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(53),s=i(68),o=i(49),l=i(57),d=i(32),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.factor=0,t}return n(t,e),t.prototype.init=function(t,i){null!=t&&(e.prototype.init.call(this,t,i),this.isForward=t.forward,this.factor=t.factor,this.initShaders(),this.initBuffers())},t.prototype.initShaders=function(){var t=this.gl;t?(e.prototype.initShaders.call(this),this.shaderProgram=l.activateShader(t,1)):d.logError("WebGLRenderingContext undefined")},t.prototype.initBuffers=function(){this.gl?(this.bindModelBuffers(),this.bindGLVertexBuffer(),this.bindGLTextureCoordBuffer(),this.bindGLIndexBuffer(),this.bindGLDelayBuffer(),this.bindGLDirectionBuffer()):d.logError("WebGLRenderingContext undefined")},t.prototype.draw=function(t){var i=this.gl;if(!i)return d.logError("WebGLRenderingContext undefined"),!1;if(!a.isTransitionReadyForDraw(i))return!1;e.prototype.draw.call(this,t);var r=this.shaderProgram;l.activateShader(i,1),i.viewport(0,0,i.canvas.width,i.canvas.height),o.bindArrayBufferToVertexAttribPointer(i,this.getGLVertexBuffer().buffer,r.vertexPositionAttribute,this.getGLVertexBuffer().itemSize,i.FLOAT),o.bindArrayBufferToVertexAttribPointer(i,this.getGLTextureCoordBuffer().buffer,r.textureCoordAttribute,this.getGLTextureCoordBuffer().itemSize,i.FLOAT),o.bindArrayBufferToVertexAttribPointer(i,this.getGLDelayBuffer().buffer,r.vertexDelayAttribute,this.getGLDelayBuffer().itemSize,i.FLOAT),o.bindArrayBufferToVertexAttribPointer(i,this.getGLDirectionBuffer().buffer,r.vertexDirectionAttribute,this.getGLDirectionBuffer().itemSize,i.FLOAT),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.getGLIndexBuffer().buffer),i.uniform1f(r.factorUniform,this.factor),i.uniform1f(r.progressUniform,3*t),i.uniform1f(r.opacityUniform,1),i.uniform1i(r.sampler1Uniform,0),i.uniform1i(r.sampler2Uniform,1),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.isForward?this.outgoingSlideTexture:this.incomingSlideTexture);var n=o.mat16Identity(),s=o.mat16Mul(o.mat16Translate(-.5,-.5,0),o.mat16Scale(2,2,1)),h=o.mat16Mul(n,s);return i.uniformMatrix4fv(r.matrixUniform,!1,h),i.drawElements(i.TRIANGLES,this.getGLIndexBuffer().numItems,i.UNSIGNED_SHORT,0),!0},t.prototype.dispose=function(){e.prototype.dispose.call(this)},t}(s.MeshTransitionBase);t.WeaveTransition=h},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(53),s=i(49),o=i(57),l=i(68),d=i(32),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.jitter=0,t.factor=0,t.delayDuration=0,t.style=0,t}return n(t,e),t.prototype.init=function(t,i){if(null!=t){e.prototype.init.call(this,t,i),this.jitter=t.jitter,this.factor=t.factor,this.delayDuration=0==t.delayFormula?0:1,this.style=1,this.initShaders(),this.initBuffers(),this.blackTexture=this.createBlackTexture();var r=s.mat16Identity(),n=s.mat16Mul(s.mat16Translate(-.5,-.5,0),s.mat16Scale(2,2,1));this.modelViewProjectionMatrix=s.mat16Mul(r,n)}},t.prototype.initShaders=function(){var e=this.gl;e?this.shaderProgram=o.activateShader(e,0):d.logError("WebGLRenderingContext undefined")},t.prototype.initBuffers=function(){this.bindGLVertexBuffer(),this.bindGLTextureCoordBuffer(),this.bindGLIndexBuffer(),this.bindGLDelayBuffer()},t.prototype.draw=function(e){if(!this.gl)return d.logError("WebGLRenderingContext undefined"),!1;if(!this.blackTexture)return d.logError("Black Texture is null"),!1;if(!a.isTransitionReadyForDraw(this.gl))return!1;var t,i=this.gl,r=this.shaderProgram,n=this.incomingSlideTexture,l=this.outgoingSlideTexture;return o.activateShader(i,0),i.viewport(0,0,i.canvas.width,i.canvas.height),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),s.bindArrayBufferToVertexAttribPointer(i,this.getGLVertexBuffer().buffer,r.vertexPositionAttribute,this.getGLVertexBuffer().itemSize,i.FLOAT),s.bindArrayBufferToVertexAttribPointer(i,this.getGLTextureCoordBuffer().buffer,r.textureCoordAttribute,this.getGLTextureCoordBuffer().itemSize,i.FLOAT),s.bindArrayBufferToVertexAttribPointer(i,this.getGLDelayBuffer().buffer,r.vertexDelayAttribute,this.getGLDelayBuffer().itemSize,i.FLOAT),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.getGLIndexBuffer().buffer),t=e<=.5?2*e*(this.delayDuration+1/this.factor+this.jitter/100):2*(e-.5)*(this.delayDuration+1/this.factor+this.jitter/100),i.uniformMatrix4fv(r.matrixUniform,!1,this.modelViewProjectionMatrix),i.uniform1f(r.progressUniform,t),i.uniform1f(r.factorUniform,this.factor),i.uniform1f(r.styleUniform,this.style),i.uniform1i(r.sampler1Uniform,0),i.uniform1i(r.sampler2Uniform,1),e<=.5?(i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.isForward?l:n),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,this.blackTexture)):(i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.blackTexture),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,this.isForward?n:l)),i.drawElements(i.TRIANGLES,this.getGLIndexBuffer().numItems,i.UNSIGNED_SHORT,0),!0},t.prototype.createBlackTexture=function(){if(!this.blackTexture){var e=this.gl;if(!e)return void d.logError("WebGLRenderingContext undefined");this.blackTexture=this.createTexture(),s.initTexture(e,this.blackTexture,[0,0,0,255],e.RGBA,1,1)}return this.blackTexture},t}(l.MeshTransitionBase);t.FadeThroughBlackTransition=h},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var s=i(53),o=i(98),l=i(49),d=i(57),h=i(72),c=a(i(91)),u=i(92),f=i(32),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isForward=!1,t.useContent=!1,t}return n(t,e),t.prototype.init=function(t,i){if(null!=t){e.prototype.init.call(this,t,i),t.useContent&&(this.alphaTransition=new u.AlphaTransition,this.alphaTransition.init(t,i),t.incomingSlideBackground=t.incomingSlideForeground,t.outgoingSlideBackground=t.outgoingSlideForeground);var r=new o.MeshInfo(t),n=new o.Mesh;switch(n.initialize(r),this.isForward=t.forward,this.useContent=t.useContent,this.incomingSlideTexture=t.incomingSlideBackground,this.outgoingSlideTexture=t.outgoingSlideBackground,this.direction={x:0,y:0},t.direction){case h.kTransitionEffectOptions.Top:this.direction.y=1;break;case h.kTransitionEffectOptions.Bottom:this.direction.y=-1;break;case h.kTransitionEffectOptions.Right:this.direction.x=1;break;case h.kTransitionEffectOptions.Left:default:this.direction.x=-1}this.isForward||(this.direction.x*=-1,this.direction.y*=-1),this.initShaders(),this.initBuffers(n)}},t.prototype.initShaders=function(){var e=this.gl;if(e){var t=d.activateShader(e,0);t.vertexPositionAttribute=e.getAttribLocation(t.program,"aPosition"),e.enableVertexAttribArray(t.vertexPositionAttribute),t.textureCoordAttribute=e.getAttribLocation(t.program,"aTexcoord"),e.enableVertexAttribArray(t.textureCoordAttribute),t.vertexDelayAttribute=e.getAttribLocation(t.program,"aDelay"),e.enableVertexAttribArray(t.vertexDelayAttribute),t.matrixUniform=e.getUniformLocation(t.program,"uModelViewProj"),t.progressUniform=e.getUniformLocation(t.program,"uProgress"),t.factorUniform=e.getUniformLocation(t.program,"uFactor"),t.styleUniform=e.getUniformLocation(t.program,"uStyle"),t.sampler1Uniform=e.getUniformLocation(t.program,"uSampler1"),t.sampler2Uniform=e.getUniformLocation(t.program,"uSampler2"),this.shaderProgram=t}else f.logError("WebGLRenderingContext undefined")},t.prototype.initBuffers=function(e){var t=this.gl,i={},r={},n={},a={};if(t){i.buffer=this.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,i.buffer);var s=e.getVertexPositions();t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),i.itemSize=3,r.buffer=this.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,r.buffer);var o=e.getTextureCoords();t.bufferData(t.ARRAY_BUFFER,new Float32Array(o),t.STATIC_DRAW),r.itemSize=2,n.buffer=this.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,n.buffer);var l=e.getDelays();t.bufferData(t.ARRAY_BUFFER,new Float32Array(l),t.STATIC_DRAW),n.itemSize=1,a.buffer=this.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,a.buffer);var d=e.getVertexIndices();t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),t.STATIC_DRAW),a.itemSize=1,a.numItems=d.length,this.vertexPositionBuffer=i,this.vertexTextureCoordBuffer=r,this.vertexDelayBuffer=n,this.vertexIndexBuffer=a}else f.logError("WebGLRenderingContext undefined")},t.prototype.draw=function(e){if(!this.gl)return f.logError("WebGLRenderingContext undefined"),!1;if(!s.isTransitionReadyForDraw(this.gl))return!1;var t=this.gl;t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.gl.disable(this.gl.DEPTH_TEST),this.gl.disable(this.gl.CULL_FACE),this.useContent&&(t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),this.alphaTransition.draw(e));var i=this.shaderProgram,r=this.vertexPositionBuffer,n=this.vertexTextureCoordBuffer,a=this.vertexDelayBuffer,o=this.vertexIndexBuffer,h=this.incomingSlideTexture,u=this.outgoingSlideTexture;d.activateShader(t,0),t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.vertexAttribPointer(i.vertexPositionAttribute,r.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,n.buffer),t.vertexAttribPointer(i.textureCoordAttribute,n.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,a.buffer),t.vertexAttribPointer(i.vertexDelayAttribute,a.itemSize,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,o.buffer),t.uniform1f(i.factorUniform,1),t.uniform1f(i.styleUniform,1),t.uniform1i(i.sampler1Uniform,0),t.uniform1i(i.sampler2Uniform,1),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.isForward?u:h),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this.isForward?h:u);var m=c.MotionFilter.getScaledProgress(0,e);if(!this.direction)return f.logError("Direction undefined"),!1;var p={x:m*this.direction.x-.5,y:m*this.direction.y-.5},g={x:(1-m)*-this.direction.x-.5,y:(1-m)*-this.direction.y-.5},_=l.mat16Identity(),v=l.mat16Mul(l.mat16Translate(p.x,p.y,0),l.mat16Scale(2,2,1)),y=l.mat16Mul(_,v);return t.uniformMatrix4fv(i.matrixUniform,!1,y),t.uniform1f(i.progressUniform,0),t.drawElements(t.TRIANGLES,o.numItems,t.UNSIGNED_SHORT,0),v=l.mat16Mul(l.mat16Translate(g.x,g.y,0),l.mat16Scale(2,2,1)),y=l.mat16Mul(_,v),t.uniformMatrix4fv(i.matrixUniform,!1,y),t.uniform1f(i.progressUniform,1),t.drawElements(t.TRIANGLES,o.numItems,t.UNSIGNED_SHORT,0),this.useContent&&t.disable(t.BLEND),!0},t.prototype.dispose=function(){this.alphaTransition&&this.alphaTransition.dispose(),e.prototype.dispose.call(this)},t}(s.BaseTransition);t.PushTransition=m},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var s=i(53),o=i(68),l=i(49),d=i(57),h=i(72),c=a(i(91)),u=i(32),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.init=function(t,i){if(null!=t){switch(e.prototype.init.call(this,t,i),this.isCover=t.isCover,this.direction={x:0,y:0},t.direction){case h.kTransitionEffectOptions.Top:this.direction.y=1;break;case h.kTransitionEffectOptions.Bottom:this.direction.y=-1;break;case h.kTransitionEffectOptions.Left:this.direction.x=-1;break;case h.kTransitionEffectOptions.TopLeft:this.direction.y=1,this.direction.x=-1;break;case h.kTransitionEffectOptions.BottomLeft:this.direction.y=-1,this.direction.x=-1;break;case h.kTransitionEffectOptions.TopRight:this.direction.y=1,this.direction.x=1;break;case h.kTransitionEffectOptions.BottomRight:this.direction.y=-1,this.direction.x=1;break;case h.kTransitionEffectOptions.Right:default:this.direction.x=1}this.isCover||(this.direction.x*=-1,this.direction.y*=-1),this.initShaders(),this.initBuffers()}},t.prototype.initShaders=function(){this.gl?this.shaderProgram=d.activateShader(this.gl,0):u.logError("WebGLRenderingContext undefined")},t.prototype.initBuffers=function(){this.bindGLVertexBuffer(),this.bindGLTextureCoordBuffer(),this.bindGLIndexBuffer(),this.bindGLDelayBuffer()},t.prototype.draw=function(e){var t=e;if(!this.gl)return u.logError("WebGLRenderingContext undefined"),!1;if(!s.isTransitionReadyForDraw(this.gl))return!1;this.isCover||(t=1-t);var i=this.gl;d.activateShader(i,0),i.viewport(0,0,i.canvas.width,i.canvas.height),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),l.bindArrayBufferToVertexAttribPointer(i,this.getGLVertexBuffer().buffer,this.shaderProgram.vertexPositionAttribute,this.getGLVertexBuffer().itemSize,i.FLOAT),l.bindArrayBufferToVertexAttribPointer(i,this.getGLTextureCoordBuffer().buffer,this.shaderProgram.textureCoordAttribute,this.getGLTextureCoordBuffer().itemSize,i.FLOAT),l.bindArrayBufferToVertexAttribPointer(i,this.getGLDelayBuffer().buffer,this.shaderProgram.vertexDelayAttribute,this.getGLDelayBuffer().itemSize,i.FLOAT),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.getGLIndexBuffer().buffer),i.uniform1f(this.shaderProgram.factorUniform,1),i.uniform1f(this.shaderProgram.styleUniform,1),i.uniform1i(this.shaderProgram.sampler1Uniform,0),i.uniform1i(this.shaderProgram.sampler2Uniform,1),this.isCover?(i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.isForward?this.outgoingSlideTexture:this.incomingSlideTexture),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,this.isForward?this.incomingSlideTexture:this.outgoingSlideTexture)):(i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.isForward?this.incomingSlideTexture:this.outgoingSlideTexture),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,this.isForward?this.outgoingSlideTexture:this.incomingSlideTexture));var r=c.MotionFilter.getScaledProgress(0,t);if(!this.direction)return u.logError("Direction undefined"),!1;var n=-.5,a=-.5,o={x:(1-r)*-this.direction.x-.5,y:(1-r)*-this.direction.y-.5},h=l.mat16Identity(),f=l.mat16Mul(l.mat16Translate(n,a,0),l.mat16Scale(2,2,1)),m=l.mat16Mul(h,f);return i.uniformMatrix4fv(this.shaderProgram.matrixUniform,!1,m),i.uniform1f(this.shaderProgram.progressUniform,0),i.drawElements(i.TRIANGLES,this.getGLIndexBuffer().numItems,i.UNSIGNED_SHORT,0),f=l.mat16Mul(l.mat16Translate(o.x,o.y,0),l.mat16Scale(2,2,1)),m=l.mat16Mul(h,f),i.uniformMatrix4fv(this.shaderProgram.matrixUniform,!1,m),i.uniform1f(this.shaderProgram.progressUniform,1),i.drawElements(i.TRIANGLES,this.getGLIndexBuffer().numItems,i.UNSIGNED_SHORT,0),!0},t}(o.MeshTransitionBase);t.CoverTransition=f},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(53),s=i(68),o=i(49),l=i(57),d=i(92),h=i(32),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.factor=0,t.inverse=!1,t.useContent=!1,t.invertDirection=!1,t.zMovement=0,t.extraDistance=0,t.sides=0,t.xAxis=!1,t.delayFormula=0,t.jitter=0,t.hres=1,t.vres=1,t}return n(t,e),t.prototype.init=function(t,i){if(null!=t){t.useContent&&(this.alphaTransition=new d.AlphaTransition,this.alphaTransition.init(t,i),t.incomingSlideBackground=t.incomingSlideForeground,t.outgoingSlideBackground=t.outgoingSlideForeground),t.isCenterBufferReq=!0,this.hres=t.hres,this.vres=t.vres,e.prototype.init.call(this,t,i),this.delayFormula=t.delayFormula,this.sides=t.sides,this.xAxis=t.xAxis,this.isForward=t.forward,this.factor=t.factor,this.inverse=t.inverse,this.useContent=t.useContent,this.invertDirection=t.invertDirection,this.zMovement=null!=t.zMovement?t.zMovement:10,this.extraDistance=null!=t.extraDistance?t.extraDistance:0,this.jitter=t.jitter;var r=this.gl;r?(r.clearColor(0,0,0,1),r.enable(r.DEPTH_TEST),this.shaderProgram=l.activateShader(r,3),this.bindGLVertexBuffer(),this.bindGLTextureCoordBuffer(),this.bindGLIndexBuffer(),this.bindGLDelayBuffer(),this.bindGLCenterBuffer(),r.enable(r.CULL_FACE),r.cullFace(r.FRONT)):h.logError("WebGLRenderingContext undefined")}},t.prototype.draw=function(e){var t=this.gl;if(!t)return h.logError("WebGLRenderingContext undefined"),!1;if(!a.isTransitionReadyForDraw(t))return!1;t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.useContent&&(t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),this.alphaTransition.draw(e));var i=this.shaderProgram;l.activateShader(t,3),o.bindArrayBufferToVertexAttribPointer(t,this.getGLVertexBuffer().buffer,i.vertexPositionAttribute,this.getGLVertexBuffer().itemSize,t.FLOAT),o.bindArrayBufferToVertexAttribPointer(t,this.getGLTextureCoordBuffer().buffer,i.textureCoordAttribute,this.getGLTextureCoordBuffer().itemSize,t.FLOAT),o.bindArrayBufferToVertexAttribPointer(t,this.getGLDelayBuffer().buffer,i.vertexDelayAttribute,this.getGLDelayBuffer().itemSize,t.FLOAT),o.bindArrayBufferToVertexAttribPointer(t,this.getGLCenterBuffer().buffer,i.vertexCenterAttribute,this.getGLCenterBuffer().itemSize,t.FLOAT),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.getGLIndexBuffer().buffer);var r=3.141592653589793,n=2*r/this.sides,s=this.xAxis?1/this.vres:1/this.hres,d=e*((0===this.delayFormula?0:1)+n/this.factor+this.jitter/100),c=s/2*Math.tan((r-n)/2);c*=1+this.extraDistance/100,this.inverse&&(c=-c);var u=this.zMovement/10*c/Math.sin((r-n)/2);t.uniform1f(i.factorUniform,this.factor),t.uniform1f(i.progressUniform,d),t.uniform1f(i.directionUniform,this.invertDirection?-1:1),t.uniform1f(i.anglePlusUniform,0),t.uniform1f(i.maxAngleUniform,n),t.uniform1f(i.zCenterUniform,c),t.uniform1f(i.zMovementUniform,u),t.uniform1f(i.xAxisUniform,this.xAxis?1:0);var f=o.mat16Prespective(),m=o.mat16Mul(o.mat16Translate(-.5,-.5,-.5),o.mat16Scale(2,2,1)),p=o.mat16Mul(f,m);return t.uniformMatrix4fv(i.matrixUniform,!1,p),t.uniform1i(i.sampler1Uniform,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.isForward?this.outgoingSlideTexture:this.incomingSlideTexture),t.drawElements(t.TRIANGLES,this.getGLIndexBuffer().numItems,t.UNSIGNED_SHORT,0),t.uniform1f(i.anglePlusUniform,-n),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.isForward?this.incomingSlideTexture:this.outgoingSlideTexture),t.drawElements(t.TRIANGLES,this.getGLIndexBuffer().numItems,t.UNSIGNED_SHORT,0),this.useContent&&t.disable(t.BLEND),!0},t.prototype.dispose=function(){this.alphaTransition&&this.alphaTransition.dispose(),e.prototype.dispose.call(this)},t}(s.MeshTransitionBase);t.PrismTransition=c},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(53),s=i(68),o=i(49),l=i(32),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_fThroughBlack=!1,t}return n(t,e),t.prototype.init=function(t,i){if(null!=t&&(e.prototype.init.call(this,t,i),this.initShaders(),this.bindModelBuffers(),this.m_fThroughBlack=t.m_fThroughBlack,this.m_fThroughBlack&&!this.blackTexture)){var r=this.gl;if(!r)return l.logError("WebGLRenderingContext undefined"),!1;this.blackTexture=this.createTexture(),o.initTexture(r,this.blackTexture,[0,0,0,255],r.RGBA,1,1),this.blackTexture||l.logError("Black Texture is null")}},t.prototype.draw=function(e){var t=this.gl;return t?!!a.isTransitionReadyForDraw(t)&&(1===e?this.drawTexture(this.isForward?this.incomingSlideTexture:this.outgoingSlideTexture):this.m_fThroughBlack&&e>.5?this.blackTexture&&this.drawTexture(this.blackTexture):this.drawTexture(this.isForward?this.outgoingSlideTexture:this.incomingSlideTexture),!0):(l.logError("WebGLRenderingContext undefined"),!1)},t}(s.MeshTransitionBase);t.CutTransition=d},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(53),s=i(68),o=i(49),l=i(57),d=i(32),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cfPI=3.14159265359,t}return n(t,e),t.prototype.init=function(t,i){null!=t&&(t.m_rippleType=t.m_rippleType||29,e.prototype.init.call(this,t,i),this.isForward=t.forward,this.initShaders(),this.initBuffers(),this.blackTexture=this.createBlackTexture())},t.prototype.initShaders=function(){var t=this.gl;t?(e.prototype.initShaders.call(this),this.shaderProgram=l.activateShader(t,4)):d.logError("WebGLRenderingContext undefined")},t.prototype.initBuffers=function(){this.gl?(this.bindModelBuffers(),this.bindGLVertexBuffer(),this.bindGLTextureCoordBuffer(),this.bindGLRippleDistanceBuffer(),this.bindGLIndexBuffer()):d.logError("WebGLRenderingContext undefined")},t.prototype.draw=function(e){var t=this.gl;if(!t)return d.logError("WebGLRenderingContext undefined"),!1;if(!a.isTransitionReadyForDraw(t))return!1;this.blackTexture&&this.drawTexture(this.blackTexture);var i=this.shaderProgram;l.activateShader(t,4),t.viewport(0,0,t.canvas.width,t.canvas.height),o.bindArrayBufferToVertexAttribPointer(t,this.getGLVertexBuffer().buffer,i.vertexPositionAttribute,this.getGLVertexBuffer().itemSize,t.FLOAT),o.bindArrayBufferToVertexAttribPointer(t,this.getGLTextureCoordBuffer().buffer,i.textureCoordAttribute,this.getGLTextureCoordBuffer().itemSize,t.FLOAT),o.bindArrayBufferToVertexAttribPointer(t,this.getGLDistanceBuffer().buffer,i.vertexDistanceAttribute,this.getGLDistanceBuffer().itemSize,t.FLOAT),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.getGLIndexBuffer().buffer),t.uniform1i(i.sampler1Uniform,0),t.uniform1i(i.sampler2Uniform,1),t.uniform2f(i.progressUniform,e*this.cfPI,e),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.isForward?this.outgoingSlideTexture:this.incomingSlideTexture),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this.isForward?this.incomingSlideTexture:this.outgoingSlideTexture);var r=o.mat16Prespective(),n=o.mat16Mul(o.mat16Translate(-.5,-.5,0),o.mat16Scale(2,2,1)),s=o.mat16Mul(r,n);return t.uniformMatrix4fv(i.matrixUniform,!1,s),t.drawElements(t.TRIANGLES,this.getGLIndexBuffer().numItems,t.UNSIGNED_SHORT,0),!0},t.prototype.createBlackTexture=function(){if(!this.blackTexture){var e=this.gl;if(!e)return void d.logError("WebGLRenderingContext undefined");this.blackTexture=this.createTexture(),o.initTexture(e,this.blackTexture,[0,0,0,255],e.RGBA,1,1)}return this.blackTexture},t}(s.MeshTransitionBase);t.RippleTransition=h},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(53),s=i(49),o=i(57),l=i(72),d=i(32),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pMatrix=new Float32Array(16),t.isStaticBackground=!0,t.backgroundProgress=0,t}return n(t,e),t.prototype.init=function(t,i){null!=t&&(e.prototype.init.call(this,t,i),this.aspectRatio=16/9,this.outgoingSlideTexture=t.outgoingSlideBackground,this.incomingSlideTexture=t.incomingSlideBackground,this.isInvX=t.isInvX,this.transitionEffectID=t.effectID,this.ambient=t.ambient,this.diffuse=1-this.ambient,this.indexBuffer=t.indexBuffer,this.textureCoordBuffer=t.textureCoordBuffer,this.vertexPositionBufferAllFrames=t.positionBufferList,this.vertexPositionBufferAllFramesBack=t.positionBufferListBack,this.indexBufferBack=t.indexBufferBack,this.textureCoordBufferBack=t.textureCoordBufferBack,this.transitionEffectID===l.kTransitionIds.PPT_TRANSITION_DRAPE?(this.backgroundProgress=1,this.swapIncomingOutgoingTexture()):this.backgroundProgress=0,t.forward||this.swapIncomingOutgoingTexture(),this.initShaders(),this.initIndexBuffer(),this.initVertexBuffer(),this.setTransitionProperties())},t.prototype.swapIncomingOutgoingTexture=function(){var e=this.outgoingSlideTexture;this.outgoingSlideTexture=this.incomingSlideTexture,this.incomingSlideTexture=e},t.prototype.initShaders=function(){var e=this.gl;if(e){var t=o.activateShader(e,6);this.shaderProgram=t}else d.logError("WebGLRenderingContext undefined")},t.prototype.initIndexBuffer=function(){var e=this.gl,t={},i={};e?(this.indexBufferBack&&(i.buffer=this.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i.buffer),i.bufferData=this.indexBufferBack,e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(i.bufferData),e.STATIC_DRAW),i.itemSize=1,i.numItems=i.bufferData.length,this.vertexIndexBufferBack=i),t.buffer=this.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.buffer),t.bufferData=this.indexBuffer,e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(t.bufferData),e.STATIC_DRAW),t.itemSize=1,t.numItems=t.bufferData.length,this.vertexIndexBuffer=t):d.logError("WebGLRenderingContext undefined")},t.prototype.initVertexBuffer=function(){var e=this.gl;if(e){var t=new Float32Array(this.textureCoordBuffer);if(this.isInvX)for(var i=0;i<t.length/2;i+=1)t[2*i]=1-t[2*i];var r={};if(r.buffer=this.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,r.buffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),r.itemSize=2,this.vertexTextureCoordBuffer=r,this.textureCoordBufferBack){var n=new Float32Array(this.textureCoordBufferBack);if(this.isInvX)for(i=0;i<n.length/2;i+=1)n[2*i]=1-n[2*i];var a={};a.buffer=this.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,a.buffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW),a.itemSize=2,this.vertexTextureCoordBufferBack=a}this.vertexPositionBufferFrame={},this.vertexPositionBufferFrame.buffer=this.createBuffer(),this.vertexNormalBufferFrame={},this.vertexNormalBufferFrame.buffer=this.createBuffer()}else d.logError("WebGLRenderingContext undefined")},t.prototype.setUniforms=function(e,t,i){var r=this.gl;if(r){this.mvMatrix=s.mat16Scale(1.031,1.031/this.aspectRatio,.5),this.mvMatrix=s.mat16Mul(s.mat16RotateY(Math.PI),this.mvMatrix),this.mvMatrix=s.mat16Mul(s.mat16Translate(0,0,2.8),this.mvMatrix),e&&this.isStaticBackground?this.perspectiveMat(45,this.aspectRatio,.01,100,this.pMatrix):this.perspectiveMat(45,this.aspectRatio,.1,100,this.pMatrix);var n=s.mat16Mul(this.mvMatrix,this.pMatrix);r.uniformMatrix4fv(this.shaderProgram.uModelToView,!1,n),r.uniformMatrix4fv(this.shaderProgram.uModelToWorld,!1,this.mvMatrix),r.uniformMatrix4fv(this.shaderProgram.uModelToWorldIT,!1,this.mvMatrix),r.uniform3f(this.shaderProgram.uLightPosition,0,0,-10),r.uniform3f(this.shaderProgram.uAmbientColor,t,t,t),r.uniform4f(this.shaderProgram.uDiffuseColor,i,i,i,1),this.transitionEffectID===l.kTransitionIds.PPT_TRANSITION_FALLOVER?r.uniform1f(this.shaderProgram.uIsNormalDirectionChangeReq,0):r.uniform1f(this.shaderProgram.uIsNormalDirectionChangeReq,1)}else d.logError("setMatrixUniform gl null")},t.prototype.draw=function(e){var t=this.gl;if(!t)return d.logError("gl null draw"),!1;if(t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),o.activateShader(t,6),this.transitionEffectID===l.kTransitionIds.PPT_TRANSITION_FLIP||this.transitionEffectID===l.kTransitionIds.PPT_TRANSITION_SWITCH){var i=this.isStaticBackground;this.isStaticBackground=!0,this.drawUtil(0,this.vertexPositionBufferAllFrames,this.vertexTextureCoordBuffer,this.vertexIndexBuffer,!0,0,0),this.isStaticBackground=i}return this.vertexPositionBufferAllFramesBack?this.drawUtil(e,this.vertexPositionBufferAllFramesBack,this.vertexTextureCoordBufferBack,this.vertexIndexBufferBack,!0,this.ambient,this.diffuse):this.drawUtil(this.backgroundProgress,this.vertexPositionBufferAllFrames,this.vertexTextureCoordBuffer,this.vertexIndexBuffer,!0,this.ambient,this.diffuse),this.drawUtil(e,this.vertexPositionBufferAllFrames,this.vertexTextureCoordBuffer,this.vertexIndexBuffer,!1,this.ambient,this.diffuse)},t.prototype.setTransitionProperties=function(){var e=this.gl;if(e){switch(this.transitionEffectID){case l.kTransitionIds.PPT_TRANSITION_FLIP:case l.kTransitionIds.PPT_TRANSITION_SWITCH:case l.kTransitionIds.PPT_TRANSITION_PAGECURLDOUBLE:this.isStaticBackground=!1,e.enable(e.CULL_FACE),this.isInvX?e.cullFace(e.BACK):e.cullFace(e.FRONT);break;case l.kTransitionIds.PPT_TRANSITION_AIRPLANE:case l.kTransitionIds.PPT_TRANSITION_CRUSH:case l.kTransitionIds.PPT_TRANSITION_CURTAINS:case l.kTransitionIds.PPT_TRANSITION_FRACTURE:case l.kTransitionIds.PPT_TRANSITION_ORIGAMI:case l.kTransitionIds.PPT_TRANSITION_PEELOFF:case l.kTransitionIds.PPT_TRANSITION_PRESTIGE:case l.kTransitionIds.PPT_TRANSITION_WIND:case l.kTransitionIds.PPT_TRANSITION_FALLOVER:case l.kTransitionIds.PPT_TRANSITION_DRAPE:case l.kTransitionIds.PPT_TRANSITION_PAGECURLSINGLE:e.disable(e.CULL_FACE),this.isStaticBackground=!0}e.enable(e.DEPTH_TEST)}else d.logError("gl null draw")},t.prototype.drawUtil=function(e,t,i,r,n,a,s){var o=this.gl;if(!o)return d.logError("gl null draw"),!1;var l=e*(t.length-1),h=Math.floor(l),c=h+1,u=l-h,f=t[h],m=t[c],p=new Float32Array(f.length);if(null==m)for(var g=0;g<f.length;g+=1)p[g]=f[g];else for(g=0;g<f.length;g+=1)p[g]=f[g]*(1-u)+m[g]*u;if(this.isInvX)for(g=0;g<f.length/3;g+=1)p[3*g]=-p[3*g];var _=this.getNormalBuffer(p);return o.bindBuffer(o.ARRAY_BUFFER,this.vertexPositionBufferFrame.buffer),o.bufferData(o.ARRAY_BUFFER,p,o.STATIC_DRAW),this.vertexPositionBufferFrame.itemSize=3,this.vertexPositionBufferFrame.numItems=p.length,o.bindBuffer(o.ARRAY_BUFFER,this.vertexPositionBufferFrame.buffer),o.vertexAttribPointer(this.shaderProgram.vertexPositionAttribute,this.vertexPositionBufferFrame.itemSize,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,_.buffer),o.vertexAttribPointer(this.shaderProgram.vertexNormalAttribute,_.itemSize,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,i.buffer),o.vertexAttribPointer(this.shaderProgram.textureCoordAttribute,i.itemSize,o.FLOAT,!1,0,0),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,r.buffer),this.setUniforms(n,a,s),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,n?this.incomingSlideTexture:this.outgoingSlideTexture),o.drawElements(o.TRIANGLES,r.numItems,o.UNSIGNED_SHORT,0),!0},t.prototype.getNormalBuffer=function(e){var t=this.gl;if(t&&e){for(var i=new Float32Array(e.length),r=0;r<e.length;r+=1)i[r]=0;for(var n=0;n<this.vertexIndexBuffer.bufferData.length/3;n+=1){var a=this.vertexIndexBuffer.bufferData[3*n],s=this.vertexIndexBuffer.bufferData[3*n+1],o=this.vertexIndexBuffer.bufferData[3*n+2],d=e[3*a],h=e[3*a+1],c=e[3*a+2],u=e[3*s]-d,f=e[3*s+1]-h,m=e[3*s+2]-c,p=e[3*o]-d,g=e[3*o+1]-h,_=e[3*o+2]-c,v=g*m-f*_,y=_*u-m*p,b=p*f-u*g;this.transitionEffectID!==l.kTransitionIds.PPT_TRANSITION_FALLOVER||this.isInvX||(v=-v,y=-y,b=-b),i[3*a]+=v,i[3*a+1]+=y,i[3*a+2]+=b,i[3*s]+=v,i[3*s+1]+=y,i[3*s+2]+=b,i[3*o]+=v,i[3*o+1]+=y,i[3*o+2]+=b}return t.bindBuffer(t.ARRAY_BUFFER,this.vertexNormalBufferFrame.buffer),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW),this.vertexNormalBufferFrame.itemSize=3,this.vertexNormalBufferFrame.numItems=i.length,this.vertexNormalBufferFrame}},t.prototype.perspectiveMat=function(e,t,i,r,n){var a=i*Math.tan(e*Math.PI/360),s=a*t;return this.frustum(-s,s,-a,a,i,r,n)},t.prototype.frustum=function(e,t,i,r,n,a,s){var o=t-e,l=r-i,d=a-n,h=s;return s||(h=new Float32Array(16)),h[0]=2*n/o,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=2*n/l,h[6]=0,h[7]=0,h[8]=(t+e)/o,h[9]=(r+i)/l,h[10]=-(a+n)/d,h[11]=-1,h[12]=0,h[13]=0,h[14]=-a*n*2/d,h[15]=0,h},t}(a.BaseTransition);t.CustomTransition=h},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(53),s=i(68),o=i(49),l=i(57),d=i(32),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.factor=0,t.zMovement=0,t.xAxis=!1,t.delayFormula=0,t.jitter=0,t.hres=1,t.vres=1,t.randomCenters=!1,t}return n(t,e),t.prototype.init=function(t,i){if(null!=t){t.isCenterBufferReq=!0,this.hres=t.hres,this.vres=t.vres,e.prototype.init.call(this,t,i),this.delayFormula=t.delayFormula,this.xAxis=t.xAxis,this.isForward=t.forward,this.factor=t.factor,this.zMovement=null!=t.zMovement?t.zMovement:10,this.jitter=t.jitter,this.randomCenters=t.randomCenters;var r=this.gl;r?(r.clearColor(0,0,0,1),r.enable(r.DEPTH_TEST),this.shaderProgram=l.activateShader(r,5),this.bindGLVertexBuffer(),this.bindGLTextureCoordBuffer(),this.bindGLIndexBuffer(),this.bindGLDelayBuffer(),this.bindGLCenterBuffer(),r.enable(r.CULL_FACE),r.cullFace(r.FRONT)):d.logError("WebGLRenderingContext undefined")}},t.prototype.draw=function(e){var t=this.gl;if(!t)return d.logError("WebGLRenderingContext undefined"),!1;if(!a.isTransitionReadyForDraw(t))return!1;var i=this.shaderProgram;l.activateShader(t,5),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),o.bindArrayBufferToVertexAttribPointer(t,this.getGLVertexBuffer().buffer,i.vertexPositionAttribute,this.getGLVertexBuffer().itemSize,t.FLOAT),o.bindArrayBufferToVertexAttribPointer(t,this.getGLTextureCoordBuffer().buffer,i.textureCoordAttribute,this.getGLTextureCoordBuffer().itemSize,t.FLOAT),o.bindArrayBufferToVertexAttribPointer(t,this.getGLDelayBuffer().buffer,i.vertexDelayAttribute,this.getGLDelayBuffer().itemSize,t.FLOAT),o.bindArrayBufferToVertexAttribPointer(t,this.getGLCenterBuffer().buffer,i.vertexCenterAttribute,this.getGLCenterBuffer().itemSize,t.FLOAT),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.getGLIndexBuffer().buffer);var r=Math.PI,n=this.zMovement/10;n/=this.xAxis?this.vres:this.hres;var s=e*((0===this.delayFormula?0:1)+r/this.factor+this.jitter/100),h=0,c=-1;t.uniform1f(i.factorUniform,this.factor),t.uniform1f(i.zMovementUniform,n),t.uniform1f(i.directionUniform,c),t.uniform1f(i.angleUniform,s),t.uniform1f(i.xAxisUniform,this.xAxis?1:0),t.uniform1f(i.backUniform,h);var u=o.mat16Prespective(),f=o.mat16Mul(o.mat16Translate(-.5,-.5,0),o.mat16Scale(2,2,1)),m=o.mat16Mul(u,f);return t.uniformMatrix4fv(i.matrixUniform,!1,m),t.uniform1i(i.sampler1Uniform,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.isForward?this.outgoingSlideTexture:this.incomingSlideTexture),t.drawElements(t.TRIANGLES,this.getGLIndexBuffer().numItems,t.UNSIGNED_SHORT,0),this.randomCenters?(s=(1-e)*(1+r/this.factor+this.jitter/100),h=0,c=1):(h=r,c=-1),t.uniform1f(i.directionUniform,c),t.uniform1f(i.angleUniform,s),t.uniform1f(i.backUniform,h),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.isForward?this.incomingSlideTexture:this.outgoingSlideTexture),t.drawElements(t.TRIANGLES,this.getGLIndexBuffer().numItems,t.UNSIGNED_SHORT,0),!0},t}(s.MeshTransitionBase);t.BlindsTransition=h},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(53),s=i(68),o=i(49),l=i(57),d=i(92),h=i(32),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.init=function(t,i){if(!t)return h.logError("property undefined"),!1;e.prototype.init.call(this,t,i),this.m_props=t,this.incomingSlideTextureForeGround=t.incomingSlideForeground,this.outgoingSlideTextureForeGround=t.outgoingSlideForeground;var r=this.gl;if(!r)return h.logError("WebGLRenderingContext undefined"),!1;this.m_solidTexture=this.createTexture(),t.m_fTransitionWhite?o.initTexture(r,this.m_solidTexture,[255,255,255,255],r.RGBA,1,1):o.initTexture(r,this.m_solidTexture,[0,0,0,255],r.RGBA,1,1),this.m_solidTexture||h.logError("Black Texture is null"),r.clearColor(0,0,0,1),this.alphaTransition=new d.AlphaTransition,t.delayFormula=0,this.alphaTransition.init(t,i),this.initBuffers(),this.initShaders();var n=o.mat16Prespective(),a=o.mat16Mul(o.mat16Translate(-.5,-.5,0),o.mat16Scale(2,2,1));this.m_modelViewProjectionMatrix=o.mat16Mul(n,a)},t.prototype.initShaders=function(){var e=this.gl;e?this.m_shaderProgram=l.activateShader(e,0):h.logError("WebGLRenderingContext undefined")},t.prototype.initBuffers=function(){this.bindGLVertexBuffer(),this.bindGLTextureCoordBuffer(),this.bindGLIndexBuffer(),this.bindGLDelayBuffer()},t.prototype.draw=function(e){var t=this.gl,i=e;if(!t)return h.logError("WebGLRenderingContext undefined"),!1;if(!a.isTransitionReadyForDraw(t))return!1;if(!this.m_modelViewProjectionMatrix)return h.logError("m_modelViewProjectionMatrix undefined"),!1;if(t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.m_props.m_fTransitionWhite){if(t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),!this.alphaTransition)return h.logError("alphaTransition undefined"),!1;this.alphaTransition.draw(i)}else if(this.m_props.m_deadTime>0){var r=this.m_props.m_deadTime/100;i<.5?i*=1-r:i=(1-r)*(i-.5)+.5+r/2}var n=this.m_shaderProgram;l.activateShader(t,0);var s=this.isForward?this.incomingSlideTexture:this.outgoingSlideTexture,d=this.isForward?this.outgoingSlideTexture:this.incomingSlideTexture;if(!this.incomingSlideTextureForeGround||!this.outgoingSlideTextureForeGround)return h.logError("Either incomingSlideTextureForeGround or outgoingSlideTextureForeGround is undefined"),!1;var c=this.isForward?this.incomingSlideTextureForeGround:this.outgoingSlideTextureForeGround,u=this.isForward?this.outgoingSlideTextureForeGround:this.incomingSlideTextureForeGround;o.bindArrayBufferToVertexAttribPointer(t,this.getGLVertexBuffer().buffer,n.vertexPositionAttribute,this.getGLVertexBuffer().itemSize,t.FLOAT),o.bindArrayBufferToVertexAttribPointer(t,this.getGLTextureCoordBuffer().buffer,n.textureCoordAttribute,this.getGLTextureCoordBuffer().itemSize,t.FLOAT),o.bindArrayBufferToVertexAttribPointer(t,this.getGLDelayBuffer().buffer,n.vertexDelayAttribute,this.getGLDelayBuffer().itemSize,t.FLOAT),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.getGLIndexBuffer().buffer),t.uniform1i(n.sampler1Uniform,0),t.uniform1i(n.sampler2Uniform,1);var f=i,m=(f*=2)<1;m||(f=2-f);var p=this.m_props.factor/4,g=1+1/p+this.m_props.jitter/100;this.m_props.m_fTransitionWhite?(t.uniform1f(n.factorUniform,p),t.uniform1f(n.progressUniform,(1-f)*g)):(t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.uniform1f(n.progressUniform,g),t.uniform1f(n.factorUniform,1),t.uniformMatrix4fv(n.matrixUniform,!1,this.m_modelViewProjectionMatrix),t.uniform1f(n.styleUniform,2),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,m?d:s),t.drawElements(t.TRIANGLES,this.getGLIndexBuffer().numItems,t.UNSIGNED_SHORT,0));var _=this.calculateEyePosition(i);return t.uniformMatrix4fv(n.matrixUniform,!1,_),t.uniform1f(n.styleUniform,2),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,m?u:c),t.drawElements(t.TRIANGLES,this.getGLIndexBuffer().numItems,t.UNSIGNED_SHORT,0),this.m_props.m_fTransitionWhite||(t.uniformMatrix4fv(n.matrixUniform,!1,this.m_modelViewProjectionMatrix),t.uniform1f(n.factorUniform,p),t.uniform1f(n.progressUniform,f*g),t.uniform1f(n.styleUniform,2),t.activeTexture(t.TEXTURE0),this.m_solidTexture&&t.bindTexture(t.TEXTURE_2D,this.m_solidTexture),t.drawElements(t.TRIANGLES,this.getGLIndexBuffer().numItems,t.UNSIGNED_SHORT,0)),t.disable(t.BLEND),!0},t.prototype.calculateEyePosition=function(e){var t=this.m_props.m_dx/100,i=this.m_props.m_dy/100,r=this.m_props.m_dz/100,n=2*e;n>1&&(n=2-n,this.m_props.m_fInvertXZoomOut&&(t*=-1));var a={x:0,y:0,z:-1.5};a.x+=t*n,a.y+=i*n,a.z+=r*n;var s=o.mat16Mul(o.mat16Translate(-.5,-.5,0),o.mat16Scale(2,2,1)),l=-1.5/a.z,d=o.mat16Mul(o.mat16Scale(l,l,1),o.mat16Translate(-a.x,-a.y,0));return o.mat16Mul(s,d)},t.prototype.dispose=function(){this.alphaTransition&&this.alphaTransition.dispose(),e.prototype.dispose.call(this)},t}(s.MeshTransitionBase);t.CrossZoomTransition=c},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(53),s=i(68),o=i(49),l=i(57),d=i(91),h=i(92),c=i(32),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.useContent=!1,t}return n(t,e),t.prototype.init=function(t,i){t&&(t.m_fUseContent&&(this.alphaTransition=new h.AlphaTransition,this.alphaTransition.init(t,i),t.incomingSlideBackground=t.incomingSlideForeground,t.outgoingSlideBackground=t.outgoingSlideForeground),this.property=t,e.prototype.init.call(this,t,i),this.isForward=t.forward,this.initShaders(),this.initBuffers(),this.useContent=t.m_fUseContent,this.reflectionRequired=t.m_fReflection,this.reflectionDistance=t.m_reflectionDistance,this.blackTexture=this.createBlackTexture())},t.prototype.initShaders=function(){this.gl?(e.prototype.initShaders.call(this),this.shaderProgram=l.activateShader(this.gl,9)):c.logError("WebGLRenderingContext undefined")},t.prototype.initBuffers=function(){this.gl?(this.bindModelBuffers(),this.bindGLVertexBuffer(),this.bindGLTextureCoordBuffer(),this.bindGLIndexBuffer(),this.reflectionMask=this.createTexture(),o.initReflectionMask(this.gl,this.reflectionMask,512,12)):c.logError("WebGLRenderingContext undefined")},t.prototype.draw=function(e){if(!this.gl)return c.logError("WebGLRenderingContext undefined"),!1;if(!a.isTransitionReadyForDraw(this.gl))return!1;this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),this.useContent?this.alphaTransition.draw(e):this.blackTexture&&this.drawTexture(this.blackTexture);var t=this.shaderProgram;l.activateShader(this.gl,9),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);var i=o.mat16Identity(),r=this.calculateLocation(!1,e,i);i=r.offset||o.mat16Identity();var n=r.dirMatrix||o.mat16Identity(),s=r.swivelProgress;return s/=10,this.worldViewMatrix=o.mat16Mul(o.mat16Translate(-.5,0,0),o.mat16Scale(this.property.m_isInvX?-2:2,2,1)),this.worldViewMatrix[15]=s+1,this.worldViewMatrix[12]=this.worldViewMatrix[12]+(this.property.m_isInvX?s:-s),this.gl.uniform1f(t.isInvX,this.property.m_isInvX),o.bindArrayBufferToVertexAttribPointer(this.gl,this.getGLVertexBuffer().buffer,t.vertexPositionAttribute,this.getGLVertexBuffer().itemSize,this.gl.FLOAT),o.bindArrayBufferToVertexAttribPointer(this.gl,this.getGLTextureCoordBuffer().buffer,t.textureCoordAttribute,this.getGLTextureCoordBuffer().itemSize,this.gl.FLOAT),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.getGLIndexBuffer().buffer),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.isForward?this.incomingSlideTexture:this.outgoingSlideTexture),this.gl.uniform1i(this.shaderProgram.sampler1Uniform,0),this.gl.uniform1i(this.shaderProgram.sampler2Uniform,1),this.gl.uniformMatrix4fv(t.offsetMatrix,!1,i),this.gl.uniformMatrix4fv(t.dirMatrix,!1,n),this.gl.uniform1f(t.opacityUniform,1),this.gl.uniform1f(t.style,this.property.style),this.gl.uniformMatrix4fv(t.matrixUniform,!1,this.worldViewMatrix),this.gl.uniform1f(t.progressUniform,e),this.gl.drawElements(this.gl.TRIANGLES,this.getGLIndexBuffer().numItems,this.gl.UNSIGNED_SHORT,0),this.drawReflection(!this.isForward,e,i,n),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.isForward?this.outgoingSlideTexture:this.incomingSlideTexture),i=o.mat16Identity(),i=(r=this.calculateLocation(!0,e,i)).offset||o.mat16Identity(),n=r.dirMatrix||o.mat16Identity(),this.gl.uniformMatrix4fv(t.dirMatrix,!1,n),this.gl.uniformMatrix4fv(t.offsetMatrix,!1,i),this.gl.uniform1f(t.opacityUniform,1),this.gl.uniform1f(t.style,this.property.style),this.gl.uniformMatrix4fv(t.matrixUniform,!1,this.worldViewMatrix),this.gl.uniform1f(t.progressUniform,e),this.gl.drawElements(this.gl.TRIANGLES,this.getGLIndexBuffer().numItems,this.gl.UNSIGNED_SHORT,0),this.drawReflection(this.isForward,e,i,n),this.gl.disable(this.gl.BLEND),!0},t.prototype.drawReflection=function(e,t,i,r){if(this.reflectionRequired){var n=this.shaderProgram;if(this.gl){var a=o.mat16Identity();a=o.mat16Mul(a,o.mat16RotateX(-Math.PI)),a=o.mat16Mul(a,o.mat16TranslateColumn(0,this.reflectionDistance/100,0)),a=o.mat16Mul(a,i),a=o.mat16Mul(a,o.mat16TranslateColumn(0,1,0)),this.setReflectionMask(this.gl,!0),this.gl.uniformMatrix4fv(n.offsetMatrix,!1,a),this.gl.uniformMatrix4fv(n.dirMatrix,!1,r),this.gl.uniform1f(n.opacityUniform,1-(this.property.m_fFadeReflection?t:0)),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e?this.outgoingSlideTexture:this.incomingSlideTexture),this.gl.drawElements(this.gl.TRIANGLES,this.getGLIndexBuffer().numItems,this.gl.UNSIGNED_SHORT,0),this.setReflectionMask(this.gl,!1)}else c.logError("WebGLRenderingContext undefined")}},t.prototype.setReflectionMask=function(e,t){t?(e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this.reflectionMask)):(e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this.blackTexture))},t.prototype.createBlackTexture=function(){if(!this.blackTexture){if(!this.gl)return void c.logError("WebGLRenderingContext undefined");this.blackTexture=this.createTexture(),o.initTexture(this.gl,this.blackTexture,[0,0,0,255],this.gl.RGBA,1,1)}return this.blackTexture},t.prototype.calculateLocation=function(e,t,i){var r=t,n=i,a=0;if(this.property.m_fSwivel){var s=d.MotionFilter.doSwivel(r,n,this.property);r=s.scaledProgress,n=s.offset,a=s.swivelPercent}r=d.MotionFilter.getScaledProgress(this.property.motionType,r,this.property.bounceTime/100,this.property.bounceDampen);var l=16*(this.property.m_distance/100+.65)/9;return l*=e?r:-(1-r),1!==a&&0!==a&&(l+=Math.abs(.5-Math.abs(a-.5))/70),{offset:n,dirMatrix:o.mat16TranslateColumn(l,0,0),swivelProgress:a}},t.prototype.dispose=function(){this.alphaTransition&&this.alphaTransition.dispose(),e.prototype.dispose.call(this)},t}(s.MeshTransitionBase);t.GalleryTransition=u},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(53),s=i(68),o=i(49),l=i(57),d=i(92),h=i(98),c=i(91),u=i(32),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_blackTexture=null,t.m_reflectionMask=null,t.m_zEyeDest=0,t.m_zMoveMin=0,t.m_zMoveMax=0,t.m_zMoveDecel=0,t.m_defaultEye=new h.Vector3(0,0,-1.5),t}return n(t,e),t.prototype.init=function(t,i){if(!t)return u.logError("property undefined"),!1;this.m_props=t,this.m_props.m_fUseContent&&(this.alphaTransition=new d.AlphaTransition,t.delayFormula=0,this.alphaTransition.init(t,i),t.incomingSlideBackground=t.incomingSlideForeground,t.outgoingSlideBackground=t.outgoingSlideForeground),e.prototype.init.call(this,t,i);var r=this.gl;if(!r)return u.logError("WebGLRenderingContext undefined"),!1;r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.clearColor(0,0,0,1),this.initBuffers(),this.initShaders(),this.m_reflectionMask=this.createTexture(),o.initReflectionMask(r,this.m_reflectionMask,512,12),this.m_blackTexture=this.createBlackTexture(),this.incomingSlideTexture=this.isForward?t.incomingSlideBackground:t.outgoingSlideBackground,this.outgoingSlideTexture=this.isForward?t.outgoingSlideBackground:t.incomingSlideBackground,this.m_zMoveMin=0,this.m_zMoveMax=1,this.m_zMoveDecel=.5},t.prototype.initShaders=function(){var e=this.gl;e?this.m_shaderProgram=l.activateShader(e,7):u.logError("WebGLRenderingContext undefined")},t.prototype.initBuffers=function(){this.bindGLVertexBuffer(),this.bindGLTextureCoordBuffer(),this.bindGLIndexBuffer(),this.bindGLCenterBuffer()},t.prototype.draw=function(e){var t=this.gl;if(!t)return u.logError("WebGLRenderingContext undefined"),!1;if(!a.isTransitionReadyForDraw(t))return!1;t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT);var i=this.m_props.m_length/10;if(this.m_zEyeDest=i+this.m_defaultEye.z,t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),this.m_props.m_fUseContent){if(!this.alphaTransition)return u.logError("alphaTransition undefined"),!1;this.alphaTransition.draw(e)}else this.drawSlide(e,2);return this.m_shaderProgram=l.activateShader(t,7),t.viewport(0,0,t.canvas.width,t.canvas.height),this.drawSlide(e,1),this.drawSlide(e,0),t.disable(t.BLEND),!0},t.prototype.drawSlide=function(e,t){var i=e;this.m_props.m_fOut&&(i=1-i);var r=this.gl,n=this.m_shaderProgram;if(r){var a=this.getPosition(i),s=a.z;1===t&&(a.z-=this.m_props.m_length/10),this.m_props.m_fOut&&(a.z=this.m_defaultEye.z-(a.z-this.m_defaultEye.z));var l=o.mat16Prespective(),d=o.mat16Mul(o.mat16Translate(-.5-a.x,-.5-a.y,0),o.mat16Scale(2,2,1)),h=o.mat16Mul(l,d),c=o.mat16Identity();if(r.uniformMatrix4fv(n.offsetMatrix,!1,c),o.bindArrayBufferToVertexAttribPointer(r,this.getGLVertexBuffer().buffer,n.vertexPositionAttribute,this.getGLVertexBuffer().itemSize,r.FLOAT),o.bindArrayBufferToVertexAttribPointer(r,this.getGLTextureCoordBuffer().buffer,n.textureCoordAttribute,this.getGLTextureCoordBuffer().itemSize,r.FLOAT),o.bindArrayBufferToVertexAttribPointer(r,this.getGLCenterBuffer().buffer,n.vertexCenterAttribute,this.getGLCenterBuffer().itemSize,r.FLOAT),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.getGLIndexBuffer().buffer),r.uniform1i(n.sampler1Uniform,0),r.uniform1i(n.sampler2Uniform,1),this.m_props.m_fUseContent||(r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,this.isForward?this.incomingSlideTexture:this.outgoingSlideTexture)),r.uniform1f(n.styleUniform,2),2!==t){if(0===t){if(s>0)return;i=3===this.m_props.m_doorType||4===this.m_props.m_doorType?Math.abs(s-this.m_defaultEye.z)*this.m_props.m_slidingDoorSpeed/25:Math.abs(s-this.m_defaultEye.z);var f=this.m_props.m_fFade?Math.abs(s/this.m_defaultEye.z):1,m=this.m_props.m_fOut?this.getScaledReverseProgress(i):i;r.uniformMatrix4fv(n.matrixUniform,!1,h),r.uniform1f(n.progressUniform,m),r.uniform1f(n.opacityUniform,f),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.m_props.m_fOut?this.incomingSlideTexture:this.outgoingSlideTexture)}else f=this.m_props.m_fOut||this.m_props.m_fUseContent?i:1,m=i,this.m_props.m_fUseContent&&(m=this.m_props.m_fOut?i:Math.abs(s-this.m_defaultEye.z)/1.8),h=o.mat16Mul(h,o.mat16Scale(4,4,1)),r.uniformMatrix4fv(n.matrixUniform,!1,h),r.uniform1f(n.progressUniform,m),r.uniform1f(n.opacityUniform,f),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.m_props.m_fOut?this.outgoingSlideTexture:this.incomingSlideTexture);r.drawElements(r.TRIANGLES,this.getGLIndexBuffer().numItems,r.UNSIGNED_SHORT,0)}else this.drawReflection(i,Math.abs(this.m_zEyeDest-a.z))}else u.logError("WebGLRenderingContext undefined")},t.prototype.getScaledReverseProgress=function(e){switch(this.m_props.m_endType){case 0:return e;case 3:var t=this.m_props.m_bounceTime/100,i=e/1.5;if(i<t){var r=t/2;return i<r?i:r-(i-r)}return(i-t)/(1-t);default:return-1e4}},t.prototype.getPosition=function(e){var t;switch(this.m_props.m_endType){case 0:t=this.m_defaultEye.z+c.MotionFilter.getPositionFromTime(e,this.m_props.m_length/10*4,this.m_zMoveMin,this.m_zMoveMin+this.m_zMoveDecel,this.m_zMoveMax,!0);break;case 1:t=this.m_defaultEye.z+e*this.m_props.m_length/10;break;case 2:(t=this.m_defaultEye.z+c.MotionFilter.getPositionFromTime(e,this.m_props.m_length/10*4,this.m_zMoveMin,this.m_zMoveMax,this.m_zMoveMax,!1))>this.m_zEyeDest&&(t=this.m_zEyeDest);break;case 3:var i=this.m_props.m_bounceTime/100,r=this.m_props.m_length/10*2/this.sqr(1-i),n=this.m_zMoveMax-i;if(e>n){var a=this.getVelocity(e),s=this.getBounce(e,a);t=this.m_defaultEye.z+this.m_props.m_length/10+s.z}else t=this.m_defaultEye.z+c.MotionFilter.getPositionFromTime(e,r,this.m_zMoveMin,n,n,!1);break;default:t=-100}return{x:0,y:0,z:t}},t.prototype.sqr=function(e){return e*e},t.prototype.getVelocity=function(e){var t;switch(this.m_props.m_endType){case 0:t=c.MotionFilter.getVelocityFromTime(e,this.m_props.m_length/10*4,this.m_zMoveMin,this.m_zMoveMin+this.m_zMoveDecel,this.m_zMoveMax,!0);break;case 1:t=this.m_props.m_length/10;break;case 2:t=c.MotionFilter.getVelocityFromTime(e,this.m_props.m_length/10*4,this.m_zMoveMin,this.m_zMoveMax,this.m_zMoveMax,!1);break;case 3:var i=this.m_zMoveMax-this.m_props.m_bounceTime/100;t=c.MotionFilter.getVelocityFromTime(e,this.m_props.m_length/10*4,this.m_zMoveMin,i,i,!1);break;default:t=-1e4}return{x:0,y:0,z:t}},t.prototype.getBounce=function(e,t){var i=this.m_props.m_bounceTime/100,r=(e-(this.m_zMoveMax-i))/i,n=2*r*Math.PI;return{x:0,y:0,z:1/this.m_props.m_bounceDampening*(1-r)*i*Math.sin(n)*t.z}},t.prototype.drawReflection=function(e,t){var i=this.m_shaderProgram,r=this.gl;if(r){var n=this.m_props.m_reflectionType;if(0!==n){var a={x:this.m_props.aspectRatio,y:1},s=o.mat16Mul(o.mat16Identity(),o.mat16Translate(0,a.y/2,0));3===n&&(s=o.mat16Mul(s,o.mat16Scale(1,2*t/3,1)));var l=1===n?-Math.PI:-Math.PI/2;s=o.mat16Mul(s,o.mat16RotateX(l)),s=o.mat16Mul(s,o.mat16Translate(0,-a.y/2,0)),this.setReflectionMask(i,!0),r.uniformMatrix4fv(i.offsetMatrix,!1,s);var d=3===n?1.5/t:1;r.uniform1f(i.opacityUniform,d*(1-e)),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.incomingSlideTexture),r.drawElements(r.TRIANGLES,this.getGLIndexBuffer().numItems,r.UNSIGNED_SHORT,0),this.setReflectionMask(i,!1)}}else u.logError("WebGLRenderingContext undefined")},t.prototype.setReflectionMask=function(e,t){t?(e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this.m_reflectionMask)):(e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this.m_blackTexture))},t.prototype.createBlackTexture=function(){if(!this.m_blackTexture){if(!this.gl)return u.logError("WebGLRenderingContext undefined"),null;this.m_blackTexture=this.createTexture(),o.initTexture(this.gl,this.m_blackTexture,[0,0,0,255],this.gl.RGBA,1,1)}return this.m_blackTexture},t.prototype.dispose=function(){this.alphaTransition&&this.alphaTransition.dispose(),e.prototype.dispose.call(this)},t}(s.MeshTransitionBase);t.FlyThroughTransition=f},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(53),s=i(68),o=i(49),l=i(57),d=i(32),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.init=function(t,i){if(null!=t){t.isCenterBufferReq=!0,e.prototype.init.call(this,t,i),this.isForward=t.forward;var r=this.gl;if(r){this.shaderProgram=l.activateShader(r,8),this.bindGLVertexBuffer(),this.bindGLTextureCoordBuffer(),this.bindGLIndexBuffer(),this.bindGLDelayBuffer(),this.bindGLCenterBuffer();var n=o.mat16Prespective(),a=o.mat16Mul(o.mat16Translate(-.5,-.5,0),o.mat16Scale(2,2,1)),s=o.mat16Mul(n,a);r.uniformMatrix4fv(this.shaderProgram.matrixUniform,!1,s),r.uniform1i(this.shaderProgram.sampler1Uniform,0)}else d.logError("WebGLRenderingContext undefined")}},t.prototype.draw=function(e){var t=this.gl;if(!t)return d.logError("WebGLRenderingContext undefined"),!1;if(!a.isTransitionReadyForDraw(t))return!1;var i=this.shaderProgram;return l.activateShader(t,8),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),o.bindArrayBufferToVertexAttribPointer(t,this.getGLVertexBuffer().buffer,i.vertexPositionAttribute,this.getGLVertexBuffer().itemSize,t.FLOAT),o.bindArrayBufferToVertexAttribPointer(t,this.getGLTextureCoordBuffer().buffer,i.textureCoordAttribute,this.getGLTextureCoordBuffer().itemSize,t.FLOAT),o.bindArrayBufferToVertexAttribPointer(t,this.getGLDelayBuffer().buffer,i.vertexDelayAttribute,this.getGLDelayBuffer().itemSize,t.FLOAT),o.bindArrayBufferToVertexAttribPointer(t,this.getGLCenterBuffer().buffer,i.vertexCenterAttribute,this.getGLCenterBuffer().itemSize,t.FLOAT),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.getGLIndexBuffer().buffer),t.uniform1f(i.factorUniform,1),t.uniform1f(i.reverseAngleUniform,-1),t.uniform1f(i.growFactorUniform,0),t.uniform1f(i.opacitySpeedUniform,0),t.uniform1f(i.spinFactorUniform,0),t.uniform1f(i.timeUniform,1),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.isForward?this.outgoingSlideTexture:this.incomingSlideTexture),t.drawElements(t.TRIANGLES,this.getGLIndexBuffer().numItems,t.UNSIGNED_SHORT,0),t.uniform1f(i.opacitySpeedUniform,3),t.uniform1f(i.timeUniform,1-e),t.uniform1f(i.spinFactorUniform,7),t.uniform1f(i.growFactorUniform,-1),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.isForward?this.incomingSlideTexture:this.outgoingSlideTexture),t.drawElements(t.TRIANGLES,this.getGLIndexBuffer().numItems,t.UNSIGNED_SHORT,0),t.disable(t.BLEND),!0},t}(s.MeshTransitionBase);t.ZoomWithSpinTransition=h},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(53),s=i(68),o=i(49),l=i(57),d=i(92),h=i(32),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.init=function(t,i){if(!t)return h.logError("property undefined"),!1;this.m_props=t,this.m_props.m_fUseContent&&(this.alphaTransition=new d.AlphaTransition,t.delayFormula=0,this.alphaTransition.init(t,i),t.incomingSlideBackground=t.incomingSlideForeground,t.outgoingSlideBackground=t.outgoingSlideForeground),e.prototype.init.call(this,t,i);var r=this.gl;if(!r)return h.logError("WebGLRenderingContext undefined"),!1;r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.clearColor(0,0,0,1),this.initBuffers(),this.initShaders(),this.incomingSlideTexture=this.isForward?t.incomingSlideBackground:t.outgoingSlideBackground,this.outgoingSlideTexture=this.isForward?t.outgoingSlideBackground:t.incomingSlideBackground},t.prototype.initShaders=function(){var e=this.gl;e?this.m_shaderProgram=l.activateShader(e,7):h.logError("WebGLRenderingContext undefined")},t.prototype.initBuffers=function(){this.bindGLVertexBuffer(),this.bindGLTextureCoordBuffer(),this.bindGLIndexBuffer(),this.bindGLCenterBuffer()},t.prototype.draw=function(e){var t=this.gl;if(!t)return h.logError("WebGLRenderingContext undefined"),!1;if(!a.isTransitionReadyForDraw(t))return!1;if(t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),this.m_props.m_fUseContent){if(!this.alphaTransition)return h.logError("alphaTransition undefined"),!1;this.alphaTransition.draw(e)}return this.m_shaderProgram=l.activateShader(t,7),t.viewport(0,0,t.canvas.width,t.canvas.height),this.drawSlide(e,!0),this.drawSlide(e,!1),t.disable(t.BLEND),!0},t.prototype.drawSlide=function(e,t){var i=e;t&&(i=1-i);var r=this.gl,n=this.m_shaderProgram;if(r){var a=o.mat16Prespective(),s=o.mat16Mul(o.mat16Translate(-.5,-.5,0),o.mat16Scale(2,2,1)),l=o.mat16Mul(a,s),d=o.mat16Identity();r.uniformMatrix4fv(n.offsetMatrix,!1,d),o.bindArrayBufferToVertexAttribPointer(r,this.getGLVertexBuffer().buffer,n.vertexPositionAttribute,this.getGLVertexBuffer().itemSize,r.FLOAT),o.bindArrayBufferToVertexAttribPointer(r,this.getGLTextureCoordBuffer().buffer,n.textureCoordAttribute,this.getGLTextureCoordBuffer().itemSize,r.FLOAT),o.bindArrayBufferToVertexAttribPointer(r,this.getGLCenterBuffer().buffer,n.vertexCenterAttribute,this.getGLCenterBuffer().itemSize,r.FLOAT),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,this.getGLIndexBuffer().buffer),r.uniform1i(n.sampler1Uniform,0),r.uniform1i(n.sampler2Uniform,1),this.m_props.m_fUseContent||(r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,t?this.outgoingSlideTexture:this.incomingSlideTexture)),t?r.uniform1f(n.styleUniform,2):r.uniform1f(n.styleUniform,1);var c=!this.m_props.m_fUseContent&&t?1:1-i,u=i;t&&(u=i/4),r.uniformMatrix4fv(n.matrixUniform,!1,l),r.uniform1f(n.progressUniform,u),r.uniform1f(n.opacityUniform,c),r.uniform1f(n.isX,this.m_props.m_isX),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,t?this.incomingSlideTexture:this.outgoingSlideTexture),r.drawElements(r.TRIANGLES,this.getGLIndexBuffer().numItems,r.UNSIGNED_SHORT,0)}else h.logError("WebGLRenderingContext undefined")},t.prototype.dispose=function(){this.alphaTransition&&this.alphaTransition.dispose(),e.prototype.dispose.call(this)},t}(s.MeshTransitionBase);t.DoorsTransition=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(72);t.getTransitionResourceId=function(e){var t;switch(e){case r.kTransitionIds.PPT_TRANSITION_AIRPLANE:t="airplanedata.json";break;case r.kTransitionIds.PPT_TRANSITION_FLIP:t="flipdata.json";break;case r.kTransitionIds.PPT_TRANSITION_SWITCH:t="switchdata.json";break;case r.kTransitionIds.PPT_TRANSITION_FALLOVER:t="falloverdata.json";break;case r.kTransitionIds.PPT_TRANSITION_DRAPE:t="drapedata.json";break;case r.kTransitionIds.PPT_TRANSITION_CURTAINS:t="curtainsdata.json";break;case r.kTransitionIds.PPT_TRANSITION_WIND:t="winddata.json";break;case r.kTransitionIds.PPT_TRANSITION_PRESTIGE:t="prestigedata.json";break;case r.kTransitionIds.PPT_TRANSITION_FRACTURE:t="fracturedata.json";break;case r.kTransitionIds.PPT_TRANSITION_CRUSH:t="crushdata.json";break;case r.kTransitionIds.PPT_TRANSITION_PEELOFF:t="peeloffdata.json";break;case r.kTransitionIds.PPT_TRANSITION_PAGECURLSINGLE:t="pagecurlsingledata.json";break;case r.kTransitionIds.PPT_TRANSITION_PAGECURLDOUBLE:t="pagecurldoubledata.json";break;case r.kTransitionIds.PPT_TRANSITION_ORIGAMI:t="origamidata.json";break;default:return null}return t}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CriticalAsyncFunctionThrottler=void 0;var r=i(28),n=function(){function e(e,t){this.m_loopRunning=!1,this.m_requests=[],this.m_functionToThrottle=e,this.m_queueHandler=t}return e.prototype.callAsync=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return new Promise((function(i,r){e.m_requests.push({resolve:i,reject:r,args:t}),e.m_loopRunning||e.loopAsync()}))},e.prototype.loopAsync=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,i,n,a,s,o,l,d,h;return r.__generator(this,(function(r){switch(r.label){case 0:this.m_loopRunning=!0,r.label=1;case 1:if(!(this.m_requests.length>0))return[3,6];e=this.m_queueHandler(Array.from(this.m_requests)),t=e.nextArg,i=e.handledRequests,n=e.remainingRequests,this.m_requests=n,r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this.m_functionToThrottle.apply(this,t)];case 3:for(a=r.sent(),s=0,o=i;s<o.length;s++)o[s].resolve(a);return[3,5];case 4:for(l=r.sent(),d=0,h=i;d<h.length;d++)h[d].reject(l);return[3,5];case 5:return[3,1];case 6:return this.m_loopRunning=!1,[2]}}))}))},e}();t.CriticalAsyncFunctionThrottler=n},function(e,t){},function(e,t){},function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(4),n=i(2),a=i(3),s=i(31),o=i(6);class l{constructor(){this.m_events=new s.EventEmitter,this.m_pendingSyncStateChangeRequests=[]}on(e,t){return this.m_events.on(e,t),this}init(e,t,i){this.m_loggableFeatureName=e.loggableFeatureName||"",this.m_syncStateManager=t,this.m_logger=i,this.m_attemptingToExitPrivateViewing=!1,r.a.setLogger(this.m_logger),r.a.sendTraceTag(557117466,n.a.msoulscat_Wac_PptLive,a.a.Info,`PrivateViewingManager: initialized for feature:${this.m_loggableFeatureName}.`)}localStateChanged(e,t){const i=this.m_syncStateManager.getGlobalState();this.m_syncStateManager.isInPrivateViewing()&&this.m_attemptingToExitPrivateViewing?this.m_syncStateManager.areSyncStatesEqual(e,i,!0)?(r.a.sendTraceTag(554055697,n.a.msoulscat_Wac_PptLive,a.a.Info,`PrivateViewingManager: localStateChanged exit private viewing. newState: ${JSON.stringify(e)}. globalState: ${JSON.stringify(i)}`),this.m_attemptingToExitPrivateViewing=!1,this.m_syncStateManager.isInPrivateViewingChanged(!1)):r.a.sendTraceTag(545134807,n.a.msoulscat_Wac_PptLive,a.a.Warning,`PrivateViewingManager: trying to exit private viewing to the wrong syncState. newState: ${JSON.stringify(e)}. globalState: ${JSON.stringify(i)}`):this.m_pendingSyncStateChangeRequests.some(t=>this.m_syncStateManager.areSyncStatesEqual(t,e,!0))?(this.m_pendingSyncStateChangeRequests.splice(0,this.m_pendingSyncStateChangeRequests.findIndex(t=>this.m_syncStateManager.areSyncStatesEqual(t,e,!0))+1),r.a.sendTraceTag(554055698,n.a.msoulscat_Wac_PptLive,a.a.Info,`PrivateViewingManager: localStateChanged found request in array. newState: ${JSON.stringify(e)}. globalState: ${JSON.stringify(i)}`)):this.m_syncStateManager.isInPrivateViewing()||this.m_syncStateManager.areSyncStatesEqual(i,e)||this.m_attemptingToExitPrivateViewing||(this.m_syncStateManager.hadPreviousUserInput(t)?(r.a.sendTraceTag(554055699,n.a.msoulscat_Wac_PptLive,a.a.Info,`PrivateViewingManager: localStateChanged enter private viewing. newState: ${JSON.stringify(e)}. globalState: ${JSON.stringify(i)}`),this.m_syncStateManager.isInPrivateViewingChanged(!0)):(r.a.sendTraceTag(554055700,n.a.msoulscat_Wac_PptLive,a.a.Info,`PrivateViewingManager: localStateChanged unintentional private viewing. Trying to put user back in sync. newState: ${JSON.stringify(e)}. globalState: ${JSON.stringify(i)}`),this.m_syncStateManager.goToSyncState(i)))}async globalStateChanged(e){this.m_pendingSyncStateChangeRequests.push(e),o.ChangeGate.isChangeGateEnabled("PrivateViewing.ReturnToNewSyncState")&&this.m_syncStateManager.isInPrivateViewing()&&this.m_attemptingToExitPrivateViewing&&(r.a.sendTraceTag(544081545,n.a.msoulscat_Wac_PptLive,a.a.Info,"PrivateViewingManager: globalStateChanged while user is in private viewing and trying to exit private viewing. NewSyncState: "+JSON.stringify(e)),await this.m_syncStateManager.goToSyncState(e)),r.a.sendTraceTag(554055701,n.a.msoulscat_Wac_PptLive,a.a.Info,`PrivateViewingManager: globalStateChanged. NewSyncState: ${JSON.stringify(e)}. State requests: ${JSON.stringify(this.m_pendingSyncStateChangeRequests)}`)}resetPrivateViewingManager(){this.m_attemptingToExitPrivateViewing=!1,this.m_pendingSyncStateChangeRequests=[],r.a.sendTraceTag(554055702,n.a.msoulscat_Wac_PptLive,a.a.Info,"PrivateViewingManager: reset PrivateViewingManager")}async returnToPresenter(e){if(!this.m_syncStateManager.isInPrivateViewing())return void r.a.sendTraceTag(556102996,n.a.msoulscat_Wac_PptLive,a.a.Error,"PrivateViewingManager: tried to returnToPresenter but is not in private viewing");this.m_attemptingToExitPrivateViewing=!0;const t=this.m_syncStateManager.getGlobalState();this.m_syncStateManager.areSyncStatesEqual(e,t)?(r.a.sendTraceTag(553927694,n.a.msoulscat_Wac_PptLive,a.a.Info,"PrivateViewingManager: returnToPresenter localState == globalState, so exit private viewing."),this.m_attemptingToExitPrivateViewing=!1,this.m_syncStateManager.isInPrivateViewingChanged(!1)):(r.a.sendTraceTag(554055703,n.a.msoulscat_Wac_PptLive,a.a.Info,"PrivateViewingManager: returnToPresenter navigating to "+JSON.stringify(t)),await this.m_syncStateManager.goToSyncState(t))}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(4),n=i(2),a=i(3);class s{constructor(e,t,i){this.m_pendingSyncStateChangeRequests=[],this.m_logger=i,this.m_loggableFeatureName=e.loggableFeatureName||"",this.m_syncStateManager=t,r.a.setLogger(this.m_logger),r.a.sendTraceTag(512234658,n.a.msoulscat_Wac_PptLive,a.a.Info,`PresenterSyncStateManager: initialized for feature:${this.m_loggableFeatureName}.`)}recordInboundSyncEvent(e){this.m_pendingSyncStateChangeRequests.push(e),r.a.sendTraceTag(512234657,n.a.msoulscat_Wac_PptLive,a.a.Info,`PresenterSyncStateManager: recordInboundSyncEvent. NewSyncState: ${JSON.stringify(e)}. State requests: ${JSON.stringify(this.m_pendingSyncStateChangeRequests)}`)}shouldBroadcastOutboundSyncEvent(e){return this.m_pendingSyncStateChangeRequests.some(t=>this.m_syncStateManager.areSyncStatesEqual(t,e,!0))?(this.m_pendingSyncStateChangeRequests.splice(0,this.m_pendingSyncStateChangeRequests.findIndex(t=>this.m_syncStateManager.areSyncStatesEqual(t,e,!0))+1),r.a.sendTraceTag(512234656,n.a.msoulscat_Wac_PptLive,a.a.Info,`PresenterSyncStateManager: shouldBroadcastOutboundSyncEvent FALSE. newSyncState: ${JSON.stringify(e)}. State requests: ${JSON.stringify(this.m_pendingSyncStateChangeRequests)}`),!1):(r.a.sendTraceTag(512234655,n.a.msoulscat_Wac_PptLive,a.a.Info,`PresenterSyncStateManager: shouldBroadcastOutboundSyncEvent TRUE. newSyncState: ${JSON.stringify(e)}. State requests: ${JSON.stringify(this.m_pendingSyncStateChangeRequests)}`),!0)}resetPendingSyncEvents(){this.m_pendingSyncStateChangeRequests=[]}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return N}));var r,n=i(100),a=i(88),s=i(81),o=i(82);class l{}l.s_AppForOfficeContainerClassName="AppForOfficeContainer",l.s_AppForOfficeContainerHiddenClassName="AppForOfficeContainer AppForOfficeHidden";class d{constructor(e,t,i,r){this.m_activatedAppForOfficeViewElements=[],this.m_preactivatedAppForOfficeViewElements=[],this.m_isRightToLeft=!1,this.m_appForOfficeManager=e,this.m_parentElement=t,this.m_viewId=i,this.m_isRightToLeft=r,this.m_activatedAppForOfficeViewElements=[],this.m_preactivatedAppForOfficeViewElements=[]}dispose(){this.removeAppsForOffice()}removeAppsForOffice(){if(void 0!==this.m_activatedAppForOfficeViewElements){for(let e of this.m_activatedAppForOfficeViewElements)e.dispose();this.m_activatedAppForOfficeViewElements=[]}if(void 0!==this.m_preactivatedAppForOfficeViewElements){for(let e of this.m_preactivatedAppForOfficeViewElements)e.dispose();this.m_preactivatedAppForOfficeViewElements=[]}}getContainedAppsForOffice(){let e=[];if(void 0!==this.m_activatedAppForOfficeViewElements)for(let t of this.m_activatedAppForOfficeViewElements)e.push(t.AppForOffice);if(void 0!==this.m_preactivatedAppForOfficeViewElements)for(let t of this.m_preactivatedAppForOfficeViewElements)e.push(t.AppForOffice);return e}findPreactivatedAppForOfficeViewElement(e){if(void 0!==this.m_preactivatedAppForOfficeViewElements)for(let t of this.m_preactivatedAppForOfficeViewElements)if(e.InstanceId===t.AppForOffice.InstanceId)return t}findActivatedAppForOfficeViewElement(e){if(void 0!==this.m_activatedAppForOfficeViewElements)for(let t of this.m_activatedAppForOfficeViewElements)if(e.InstanceId===t.AppForOffice.InstanceId)return t}findActivatedViewElementSiblingByInstanceId(e,t){if(void 0!==this.m_activatedAppForOfficeViewElements)for(let i=0;i<this.m_activatedAppForOfficeViewElements.length;i+=1)if(e===this.m_activatedAppForOfficeViewElements[i].AppForOffice.InstanceId){if(t&&i+1<this.m_activatedAppForOfficeViewElements.length)return this.m_activatedAppForOfficeViewElements[i+1];if(!t&&i-1>=0)return this.m_activatedAppForOfficeViewElements[i-1]}}activateAppsForOffice(e,t,i){if(void 0!==e&&0!==e.length&&void 0!==t){void 0===this.m_activatedAppForOfficeViewElements&&(this.m_activatedAppForOfficeViewElements=[]);for(let r of e){let e=this.findActivatedAppForOfficeViewElement(r);void 0===e?(e=this.findPreactivatedAppForOfficeViewElement(r),void 0!==e&&(e.AppForOffice=r),e=this.findPreactivatedAppForOfficeViewElement(r),void 0===e?(e=new h(r,this.m_parentElement,this.m_appForOfficeManager,this.m_isRightToLeft),e.activateAppForOffice(t,i)):(e.showAppForOffice(),"function"==typeof t.setActivationCompletedStatus&&t.setActivationCompletedStatus(e.AppForOffice.InstanceId,!0),this.m_appForOfficeManager.raiseEventToAppForOffice(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent.toString(),e.AppForOffice.InstanceId)),this.m_activatedAppForOfficeViewElements.push(e)):e.AppForOffice=r}}}preactivateAppsForOffice(e,t,i){if(void 0===this.m_preactivatedAppForOfficeViewElements&&(this.m_preactivatedAppForOfficeViewElements=[]),void 0===this.findPreactivatedAppForOfficeViewElement(e)&&void 0===this.findActivatedAppForOfficeViewElement(e)){let r=new h(e,this.m_parentElement,this.m_appForOfficeManager,this.m_isRightToLeft);r.preactivateAppForOffice(e,t,i),this.m_preactivatedAppForOfficeViewElements.push(r)}else void 0!==i&&i()}hasAppForOfficeBeenPrepared(e){return void 0!==this.findPreactivatedAppForOfficeViewElement(e)}showAppsForOffice(){if(void 0!==this.m_activatedAppForOfficeViewElements)for(let e of this.m_activatedAppForOfficeViewElements)e.showAppForOffice()}hideAppsForOffice(){if(void 0!==this.m_activatedAppForOfficeViewElements)for(let e of this.m_activatedAppForOfficeViewElements)e.hideAppForOffice()}insertAppForOffice(e){throw new Error("not implement yet")}updateLayout(){if(void 0!==this.m_activatedAppForOfficeViewElements)for(let e of this.m_activatedAppForOfficeViewElements)e.updatePositionAndSize()}get Id(){return this.m_viewId}get ParentElement(){return this.m_parentElement}set ParentElement(e){this.m_parentElement=e}}class h{constructor(e,t,i,r){if(void 0===i)throw new Error("manager");this.m_appForOffice=e,this.m_appForOfficeManager=i,this.m_isRightToLeft=r,this.m_appForOfficeHtmlElement=document.createElement("div"),this.m_appForOfficeHtmlElement.className=l.s_AppForOfficeContainerHiddenClassName,this.m_appForOfficeHtmlElement.style.visibility="hidden",this.m_appForOfficeHtmlElement.id="AppForOffice_"+e.InstanceId,this.m_appForOfficeHtmlElement.style.position="absolute",this.m_appForOfficeHtmlElement.style.pointerEvents="auto",t.appendChild(this.m_appForOfficeHtmlElement)}dispose(){this.removeAppForOfficeHtml()}removeAppForOfficeHtml(){void 0!==this.m_appForOfficeHtmlElement&&null!=this.m_appForOfficeHtmlElement.parentNode&&this.m_appForOfficeHtmlElement.parentNode.removeChild(this.m_appForOfficeHtmlElement)}clearElementHtml(e){e.textContent=""}activateAppForOffice(e,t){if(this.clearElementHtml(this.m_appForOfficeHtmlElement),void 0===this.m_appForOffice||void 0===e)return;t?(this.m_appForOfficeHtmlElement.className=l.s_AppForOfficeContainerClassName,this.m_appForOfficeHtmlElement.style.visibility="visible"):(this.m_appForOfficeHtmlElement.className=l.s_AppForOfficeContainerHiddenClassName,this.m_appForOfficeHtmlElement.style.visibility="hidden");let i=new Object;i.div=this.m_appForOfficeHtmlElement,i.id=this.m_appForOffice.InstanceId,i.solutionId=this.m_appForOffice.AppForOfficeRef.Id,i.version=this.m_appForOffice.AppForOfficeRef.Version,i.storeId=this.m_appForOffice.AppForOfficeRef.Store,i.storeType=this.m_appForOffice.AppForOfficeRef.StoreType,i.settings=this.m_appForOffice.Settings,i.reason=Microsoft.Office.WebExtension.InitializationReason.DocumentOpened,i.osfControlType=OSF.OsfControlTarget.InContent,this.m_appForOfficeManager.AreThirdPartyAddInsAllowed||OSF.OsfControl.isFirstPartyStoreString(i.storeType)||(a.a.sendTraceTag(544589006,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"Content web add-in disabled by doc IRM"),i.hostInfoFlags|=OSF.HostInfoFlags.ProtectedDocDisable),e.insertOsfControl(i),"function"==typeof e.setActivationCompletedStatus&&e.setActivationCompletedStatus(this.AppForOffice.InstanceId,!0)}preactivateAppForOffice(e,t,i){if(this.clearElementHtml(this.m_appForOfficeHtmlElement),void 0===this.m_appForOffice||void 0===t||null==e)return;this.m_appForOfficeHtmlElement.className=l.s_AppForOfficeContainerHiddenClassName,this.m_appForOfficeHtmlElement.style.visibility="hidden";let r=new Object;r.div=this.m_appForOfficeHtmlElement,r.id=this.m_appForOffice.InstanceId,r.solutionId=this.m_appForOffice.AppForOfficeRef.Id,r.version=this.m_appForOffice.AppForOfficeRef.Version,r.storeId=this.m_appForOffice.AppForOfficeRef.Store,r.storeType=this.m_appForOffice.AppForOfficeRef.StoreType,r.settings=this.m_appForOffice.Settings,r.reason=Microsoft.Office.WebExtension.InitializationReason.DocumentOpened,r.osfControlType=OSF.OsfControlTarget.InContent,r.snapshotUrl="",r.preactivationCallback=i,this.m_appForOfficeManager.AreThirdPartyAddInsAllowed||OSF.OsfControl.isFirstPartyStoreString(r.storeType)||(a.a.sendTraceTag(544589007,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"Content web add-in blocked for preactivate by doc IRM"),r.hostInfoFlags|=OSF.HostInfoFlags.ProtectedDocDisable),t.insertOsfControl(r),"function"==typeof t.setActivationCompletedStatus&&t.setActivationCompletedStatus(this.AppForOffice.InstanceId,!0)}updatePositionAndSize(){let e=this.m_appForOffice.Shape.Left,t=this.m_appForOffice.Shape.Top,i=this.m_appForOffice.Shape.Width,r=this.m_appForOffice.Shape.Height;this.m_appForOfficeHtmlElement.style.left=e-(this.m_isRightToLeft?i:0)+"px",this.m_appForOfficeHtmlElement.style.top=t+"px",this.m_appForOfficeHtmlElement.style.width=i+"px",this.m_appForOfficeHtmlElement.style.height=r+"px"}showAppForOffice(){this.m_appForOfficeHtmlElement.className=l.s_AppForOfficeContainerClassName,this.m_appForOfficeHtmlElement.style.visibility="visible"}hideAppForOffice(){this.m_appForOfficeHtmlElement.className=l.s_AppForOfficeContainerHiddenClassName,this.m_appForOfficeHtmlElement.style.visibility="hidden"}get AppForOffice(){return this.m_appForOffice}set AppForOffice(e){this.m_appForOffice=e}get Element(){return this.m_appForOfficeHtmlElement}}!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.NotImplemented=1]="NotImplemented",e[e.NotReady=2]="NotReady",e[e.Exempted=3]="Exempted",e[e.NotTrusted=4]="NotTrusted",e[e.Trusted=5]="Trusted"}(r||(r={}));class c{constructor(e,t){this.m_methodFactory=e,this.m_eventStore=t,this.m_eventStore}InvokeDdaMethod(e,t,i){let r=e.DdaMethod.DispatchId,n=this.m_methodFactory.getApiMethod(r);null!=n?(n.Parameters=e,n.Callback=t,n.AdditionalParameters=i,n.AppId=e.DdaMethod.ControlId,n.go()):(a.a.sendTraceTag(557335687,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,`API Call for method ID ${r} does not exist.`),this.callbackWithInternalFailure(t))}RegisterDdaEventAsync(e,t,i,r,n){let l=this.m_eventStore.getApiEvent(e);null!=l?l.addHandler(t,r,n,i):(a.a.sendTraceTag(557335688,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,`Event for dispatch ID ${e} does not exist.`),this.callbackWithInternalFailure(n))}UnregisterDdaEventAsync(e,t,i,r,n){let l=this.m_eventStore.getApiEvent(e);null!=l?l.removeHandler(t,r,n,i):(a.a.sendTraceTag(557335689,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,`Event for dispatch ID ${e}  does not exist:`),this.callbackWithInternalFailure(n))}callbackWithInternalFailure(e){if(null==e)return;let t={};t[u.c_Error]=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,e(t)}}class u{}u.c_Error="Error";var f=i(39),m=i(133);class p{constructor(e,t,i){this._errorCode=0,this._result={},this._apiFacade=null,this._parameters=e,this._callback=t,this._additionalParameters=i}get Parameters(){return this._parameters}set Parameters(e){this._parameters=e}get AdditionalParameters(){return this._additionalParameters}set AdditionalParameters(e){this._additionalParameters=e}get Callback(){return this._callback}set Callback(e){this._callback=e}get AppId(){return this._appId}set AppId(e){this._appId=e}get Description(){return this._description}set Description(e){this._description=e}get AppForOfficeManager(){return this._appForOfficeManager}set AppForOfficeManager(e){this._appForOfficeManager=e,null!=this._appForOfficeManager?this._apiFacade=this._appForOfficeManager.ApiFacade:this._apiFacade=null}go(){this._result,this.executeAsync().then(()=>{this.sendResponse()})}sendResponse(){this._result[u.c_Error]=this._errorCode,this.Callback(this._result)}getAppById(){return this.AppId&&this._appForOfficeManager?this._appForOfficeManager.getAppByInstanceId(this.AppId):null}}class g extends p{async executeAsync(){let e=this.getAppById();if(null!=e){let t={};t.Settings=this.formatSetting(e.Settings),this._result[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=t,this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else{let e="AppForOffice instance could not be found for ID "+this.AppId;a.a.sendTraceTag(557335690,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,e),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}get Description(){return"Loads/Refreshes Settings object for an app"}formatSetting(e){let t={},i=0;for(let r in e){let n=r,a=e[r];t[i.toString()]={key:n,value:a},i+=1}return t}}class _ extends p{async executeAsync(){this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeDocumentReadOnly}get Description(){return"(Not implemented) Saves settings to document."}}class v extends p{async executeAsync(){let e=null;if(null!=this._apiFacade)switch(this._apiFacade.getEditMode()){case m.a.ContinueEditing:e=Microsoft.Office.WebExtension.ActiveView.Edit;break;default:e=Microsoft.Office.WebExtension.ActiveView.Read}null!=e?(this._result[Microsoft.Office.WebExtension.Parameters.Data]=e,this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get Description(){return"Returns the ActiveView value for current mode."}}class y extends p{async executeAsync(){if(this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null!=this._apiFacade)try{let e=this.Parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],t=e[OSF.DDA.Marshaling.NavigationKeys.GoToType],i=e[OSF.DDA.Marshaling.NavigationKeys.Id].toString();t===OSF.DDA.Marshaling.GoToType.Index?this._errorCode=await this._apiFacade.goToByIndex(i):t===OSF.DDA.Marshaling.GoToType.Slide?this._errorCode=await this._apiFacade.goToBySlide(i):this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration}catch(e){return}}get Description(){return"Go to the slide specified by user."}}class b extends p{async executeAsync(){if(this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null!=this._apiFacade)try{if(this.Parameters[OSF.DDA.WAC.UniqueArguments.GetData].CoerceType.toString()===Microsoft.Office.WebExtension.CoercionType.SlideRange){let e=void 0;this._apiFacade&&!f.b.isNullOrUndefined(e=await this._apiFacade.getSelectedSlides())&&(this._result[OSF.DDA.WAC.UniqueArguments.Data]=e,this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}catch(e){return}}get Description(){return"Get selected data from slide."}}class S extends p{async executeAsync(){this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;let e=void 0;if(null==this._apiFacade||f.b.isNullOrUndefined(e=this._apiFacade.getDocumentUrl()))return;let t={};t[""+OSF.DDA.Marshaling.FilePropertiesKeys.Url]=e,this._result[""+OSF.DDA.Marshaling.FilePropertiesKeys.Properties]=t,this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}get Description(){return"Returns the file properties. Now it only returns the URL."}}class T extends p{async executeAsync(){if(this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null==this._appForOfficeManager||null==this._apiFacade)return;let e=this._appForOfficeManager.getSlideIdByInstanceId(this.AppId);if(null==e)return;let t=this._appForOfficeManager.getAppForOfficeThemeBySlide(e);if(null==t||t.fIsEmpty)return void a.a.sendTraceTag(556614112,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"Error while fetching theming for Slide: slide theme returned as null.");let i=T.updateObjectWithDocumentThemeMapping({},t);this._result[""+OSF.DDA.Marshaling.ThemingKeys.DocumentTheme]=i,this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}static updateObjectWithDocumentThemeMapping(e,t){if(null==e||null==t||t.fIsEmpty)return e;let i=e;const r=t.colorScheme;null!=r&&(i[OSF.DDA.Marshaling.ThemingKeys.Accent1]=T.extractColorValue(r.Accent1),i[OSF.DDA.Marshaling.ThemingKeys.Accent2]=T.extractColorValue(r.Accent2),i[OSF.DDA.Marshaling.ThemingKeys.Accent3]=T.extractColorValue(r.Accent3),i[OSF.DDA.Marshaling.ThemingKeys.Accent4]=T.extractColorValue(r.Accent4),i[OSF.DDA.Marshaling.ThemingKeys.Accent5]=T.extractColorValue(r.Accent5),i[OSF.DDA.Marshaling.ThemingKeys.Accent6]=T.extractColorValue(r.Accent6),i[OSF.DDA.Marshaling.ThemingKeys.Background1]=T.extractColorValue(r.Background1),i[OSF.DDA.Marshaling.ThemingKeys.Background2]=T.extractColorValue(r.Background2),i[OSF.DDA.Marshaling.ThemingKeys.Text1]=T.extractColorValue(r.Text1),i[OSF.DDA.Marshaling.ThemingKeys.Text2]=T.extractColorValue(r.Text2),i[OSF.DDA.Marshaling.ThemingKeys.Hyperlink]=T.extractColorValue(r.Hyperlink),i[OSF.DDA.Marshaling.ThemingKeys.FollowedHyperlink]=T.extractColorValue(r.FollowedHyperlink));const n=t.fontScheme;return null!=n&&(i[OSF.DDA.Marshaling.ThemingKeys.HdEastAsian]=n.HeaderEastAsian,i[OSF.DDA.Marshaling.ThemingKeys.HdLatin]=n.HeaderLatin,i[OSF.DDA.Marshaling.ThemingKeys.HdLocalized]=n.HeaderLocalized,i[OSF.DDA.Marshaling.ThemingKeys.HdScript]=n.HeaderScript,i[OSF.DDA.Marshaling.ThemingKeys.BdEastAsian]=n.BodyEastAsian,i[OSF.DDA.Marshaling.ThemingKeys.BdLatin]=n.BodyLatin,i[OSF.DDA.Marshaling.ThemingKeys.BdLocalized]=n.BodyLocalized,i[OSF.DDA.Marshaling.ThemingKeys.BdScript]=n.BodyScript),i[OSF.DDA.Marshaling.ThemingKeys.BackgroundColor]=T.extractColorValue(t.backgroundColor),i}static extractColorValue(e){if(e&&!(e.intColor<0))return e.intColor}get Description(){return"Returns the DocumentTheme (equivalent to AppForOfficeTheme) value for slide."}}class w extends p{async executeAsync(){this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext}get Description(){return"(Not implemented) Returns OfficeTheme properties."}}class M extends p{async executeAsync(){if(this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null==this.AppForOfficeManager)return;const e=await this.AppForOfficeManager.getAccessTokenAsync(this.AppId,this.Parameters);e&&(this._errorCode=e.errorCode,0===e.errorCode&&(this._result[""+OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=e.accessToken))}get Description(){return"Returns an access token for the add-in."}}class C extends p{async executeAsync(){if(this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null!=this._apiFacade&&void 0!==this.AppId)try{const e=JSON.stringify(this.Parameters[OSF.DDA.WAC.UniqueArguments.Data]);e&&(this._errorCode=await this._apiFacade.setAddinSyncState({instanceId:this.AppId,liveShareState:e}))}catch(e){return}}get Description(){return"Set addin sync state."}}class I extends p{async executeAsync(){if(this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,null!=this._apiFacade&&void 0!==this.AppId)try{const e=await this._apiFacade.getAddinSyncState(this.AppId);e&&(this._result[OSF.DDA.WAC.UniqueArguments.Data]=JSON.parse(e),this._errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(e){return}}get Description(){return"Get addin sync state."}}class P extends class{constructor(e){this.m_methodList=null,this.m_appForOfficeManager=e}getApiMethod(e){if(null==this.m_methodList&&this.populateMethodList(),null==e||null==this.m_methodList[e])return null;let t=this.m_methodList[e]();return null!=t&&(t.AppForOfficeManager=this.m_appForOfficeManager),t}set(e,t){this.m_methodList[e]=t}}{constructor(e){super(e)}populateMethodList(){this.m_methodList={},this.set(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,()=>new g),this.set(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,()=>new _),this.set(OSF.DDA.MethodDispId.dispidGetActiveViewMethod,()=>new v),this.set(OSF.DDA.MethodDispId.dispidNavigateToMethod,()=>new y),this.set(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,()=>new b),this.set(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,()=>new S),this.set(OSF.DDA.MethodDispId.dispidGetDocumentThemeMethod,()=>new T),this.set(OSF.DDA.MethodDispId.dispidGetOfficeThemeMethod,()=>new w),this.set(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,()=>new M),this.set(OSF.DDA.MethodDispId.dispidSetLiveShareStateMethod,()=>new C),this.set(OSF.DDA.MethodDispId.dispidGetLiveShareStateMethod,()=>new I)}}class E{constructor(){this.m_handlers={}}apiEvent(){this.m_handlers}get AppForOfficeManager(){return this.m_appForOfficeManager}set AppForOfficeManager(e){this.m_appForOfficeManager=e}raiseEvent(e,t){let i=this.getProcessedEventArgs(e),r=void 0;if(t&&(r=this.m_handlers[t]))r(i);else for(let e in this.m_handlers)r=this.m_handlers[e],r&&r(i)}addHandler(e,t,i,r){this.m_handlers[e]=t,i&&this.callbackWithSuccess(i)}removeHandler(e,t,i,r){delete this.m_handlers[e],i&&this.callbackWithSuccess(i)}callbackWithSuccess(e){this.callbackWithErrorCode(e,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}callbackWithErrorCode(e,t){if(null==e)return;let i={};i[u.c_Error]=t,e(i)}}class x extends E{getProcessedEventArgs(e){return e}static get Instance(){return null==this.m_instance&&(this.m_instance=new x),this.m_instance}}class A extends E{getProcessedEventArgs(e){return"view"}static get Instance(){return null==this.m_instance&&(this.m_instance=new A),this.m_instance}}class k extends E{getProcessedEventArgs(e){return e}static get Instance(){return null==this.m_instance&&(this.m_instance=new k),this.m_instance}}class R extends E{getProcessedEventArgs(e){return null}addHandler(e,t,i){i&&this.callbackWithErrorCode(i,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}removeHandler(e,t,i){i&&this.callbackWithErrorCode(i,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}static get Instance(){return null==this.m_instance&&(this.m_instance=new R),this.m_instance}}class O extends E{getProcessedEventArgs(e){return null}addHandler(e,t,i){i&&this.callbackWithErrorCode(i,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}removeHandler(e,t,i){i&&this.callbackWithErrorCode(i,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}static get Instance(){return null==this.m_instance&&(this.m_instance=new O),this.m_instance}}class L extends E{getProcessedEventArgs(e){let t={};try{const i=e;i&&(t[OSF.DDA.WAC.UniqueArguments.Data]=JSON.parse(i.liveShareState),t[u.c_Error]=OSF.DDA.ErrorCodeManager.ooeSuccess)}catch(e){t[u.c_Error]=OSF.DDA.ErrorCodeManager.ooeInternalError}return t}static get Instance(){return null==this.m_instance&&(this.m_instance=new L),this.m_instance}}class F extends class{constructor(e){this.m_eventList=null,this.m_appForOfficeManager=e}getApiEvent(e){if(null==this.m_eventList&&this.populateEventList(),null==e||null==this.m_eventList||null==this.m_eventList[e])return null;let t=this.m_eventList[e];return t.AppForOfficeManager=this.m_appForOfficeManager,t}clearHandlersForApp(e){for(let t in this.m_eventList)this.m_eventList[t].removeHandler(e)}set(e,t){null!=this.m_eventList&&(this.m_eventList[e]=t)}}{constructor(e){super(e)}populateEventList(){this.m_eventList={},this.set(OSF.DDA.EventDispId.dispidSettingsChangedEvent,x.Instance),this.set(OSF.DDA.EventDispId.dispidActiveViewChangedEvent,A.Instance),this.set(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent,k.Instance),this.set(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent,R.Instance),this.set(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,O.Instance),this.set(OSF.DDA.EventDispId.dispidLiveShareStateChangedEvent,L.Instance)}}var D=i(1),B=i(31);class N{constructor(){this.events=new B.EventEmitter,this.m_appForOfficeViewQueue=[],this.m_slideIdToAppForOfficeViewMap=new Map,this.m_slideIdToAppForOfficeThemeMap=new Map,this.m_appForOfficeToAppForOfficeViewMap=new Map,this.m_panelParentElement=null,this.m_instanceIdToAppMapping=new Map,this.m_instanceIdToSlideIdMapping=new Map,this.m_fInitialized=!1,this.m_frameTrustState=r.NotInitialized,this.m_osfruntimeloaded=!1,this.c_NumberOfMostRecentlyUsedAppForOfficeView=1,this.c_OsfRuntimeScriptId="OsfRuntimeScriptId",this.c_OsfRuntimeJSFileName="osfruntimepptwac.js",this.c_OsfRunTimeFunctionName="OfficeExt",this.c_UiHostUnifiedAppName="unified app",this.c_TimerInterval=20,this.m_fInitialized=!1,this.m_managerSettings={AppsForOfficePrivateCatalogEnabled:!0,AppForOfficeAllowExternalMarketplace:!0,AppForOfficeOmexBaseUrl:"https://store.office.com",AppForOfficeTrustUXIsEnabledForPowerPoint:!0,AppLcid:"1033",AppUILocale:"en-US",AreThirdPartyAddInsAllowed:!0,IsRtl:!1,ServerUrl:"",UploadFileDevCatalogIsDisabled:!1}}initialize(e,t){this.m_managerSettings=t,this.updateManagerSettings(),this.m_panelParentElement=e,this.m_appForOfficeViewQueue=[],this.m_methodFactory=new P(this),this.m_eventStore=new F(this),this.m_fInitialized=!0}updateManagerSettings(){let e=this.m_managerSettings.JsScriptsBasePath;e&&(this.m_managerSettings.JsScriptsBasePath=e.replace("/ssapp/",""))}fInitialized(){return this.m_fInitialized}fOsfruntimeLoaded(){return this.m_osfruntimeloaded}async prepareAppsForOfficeList(e,t,i){if(this.fInitialized()&&null!=t&&0!==t.length){for(let i of t)this.prepareAppForOffice(e,i,()=>{});i&&this.m_slideIdToAppForOfficeThemeMap.set(e,i)}}async showAppsForOfficeForSlide(e,t,i){if(!this.fInitialized())return;if(this.m_currentSlideId=e,null==t||0===t.length)return void this.hideAppForOfficeViewsExcludeCurrentSlide();this.setInstanceIdToAppMapForSlide(t),this.setInstanceIdToSlideIdMapForSlide(e,t),i&&this.m_slideIdToAppForOfficeThemeMap.set(e,i);let r=this.getAppForOfficeViewBySlide(this.m_currentSlideId);if(null==r){if(r=this.m_slideIdToAppForOfficeViewMap.get(this.m_currentSlideId),null==r?r=new d(this,this.m_panelParentElement,this.m_currentSlideId,this.m_managerSettings.IsRtl):this.m_slideIdToAppForOfficeViewMap.delete(this.m_currentSlideId),this.m_appForOfficeViewQueue.push(r),this.m_appForOfficeViewQueue.length>this.c_NumberOfMostRecentlyUsedAppForOfficeView){let e=this.m_appForOfficeViewQueue[0];this.m_appForOfficeViewQueue.splice(0,1),this.disposeAppForOfficeView(e)}r.activateAppsForOffice(t,this.contextActivationManager(),!0),r.updateLayout(),a.a.sendTraceTag(557335680,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`Apps For Office on the slide ${this.m_currentSlideId} are activated.`)}else r.activateAppsForOffice(t,this.contextActivationManager(),!0),r.showAppsForOffice(),r.updateLayout(),a.a.sendTraceTag(557335681,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`Apps For Office on the slide ${this.m_currentSlideId} are showing.`);this.hideAppForOfficeViewsExcludeCurrentSlide()}async loadOsfRuntime(){let e={start:N.performanceNowTrimmed(),end:N.performanceNowTrimmed()};return this.m_managerSettings.UiHost&&this.m_managerSettings.UiHost.toLocaleLowerCase()===this.c_UiHostUnifiedAppName?(this.m_osfruntimeloaded=void 0!==window[this.c_OsfRunTimeFunctionName]&&void 0!==OfficeExt.CatalogFactory&&void 0!==OfficeExt.CatalogFactory.resolve(OSF.StoreType.OMEX),this.m_osfruntimeloaded||(e=await this.ensureOsfRuntimeLoaded())):this.m_osfruntimeloaded||(e=await this.createScriptElement()),e}setFrameTrustStatus(e){this.m_frameTrustState=e?r.Trusted:r.NotTrusted,N.m_appForOfficeContextActivivationManager&&N.m_appForOfficeContextActivivationManager.hostCheckReadyHandler(this,this.m_frameTrustState)}async ensureOsfRuntimeLoaded(){return new Promise((e,t)=>{try{if(this.fInitialized()&&!this.m_osfruntimeloaded){const i={start:N.performanceNowTrimmed(),end:N.performanceNowTrimmed()};let r=D.Settings.readNumberOrDefault("ensureOsfRuntimeTimeout",1e4),n=setInterval(()=>{r-=this.c_TimerInterval,r<1&&(clearInterval(n),t({status:!1,message:"AppForOfficeManager::ensureOsfRuntimeLoaded:Failed to ensure OsfRuntime."})),void 0!==window[this.c_OsfRunTimeFunctionName]&&void 0!==OfficeExt.CatalogFactory&&void 0!==OfficeExt.CatalogFactory.resolve(OSF.StoreType.OMEX)&&(clearInterval(n),this.m_osfruntimeloaded=!0,i.end=N.performanceNowTrimmed(),e(i))},this.c_TimerInterval)}}catch(e){t({status:!1,message:"AppForOfficeManager::ensureOsfRuntimeLoaded:Failed to ensure OsfRuntime "+e})}})}async createScriptElement(){return new Promise((e,t)=>{try{if(this.fInitialized()&&!this.m_osfruntimeloaded&&!document.getElementById(this.c_OsfRuntimeScriptId)){const i={start:N.performanceNowTrimmed(),end:N.performanceNowTrimmed()};let r=document.createElement("script");r.id=this.c_OsfRuntimeScriptId,D.Settings.readBooleanOrDefault("UseCrossOriginStaticScripts",!0)&&r.setAttribute("crossdomain","anonymous"),r.type="text/javascript",r.async=!0;const n=this.m_managerSettings.JsScriptsBasePath;n&&n.length>0?r.src=`${n}/${this.c_OsfRuntimeJSFileName}`:r.src=D.Settings.readStringOrDefault("osfRunTimeJSFileName",this.c_OsfRuntimeJSFileName),r.onload=()=>{this.m_osfruntimeloaded=!0,i.end=N.performanceNowTrimmed(),e(i)},r.onerror=()=>{t({status:!1,message:"AppForOfficeManager::createScriptElement:Failed to load the script "+r.src})},document.body.appendChild(r)}}catch(e){t({status:!1,message:"AppForOfficeManager::createScriptElement:Failed to load the script "+e})}})}showAppForOffice(e,t,i,r){const n={start:N.performanceNowTrimmed(),end:N.performanceNowTrimmed()};if(!i||!e||!t)return a.a.sendTraceTag(554562499,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"AppForOfficeManager::showAppForOffice invalid input paramters."),n;if(!this.fInitialized()||!this.m_osfruntimeloaded)return n;let l=this.m_appForOfficeToAppForOfficeViewMap.get(i);return l&&(this.disposeAppForOfficeView(l),this.m_appForOfficeToAppForOfficeViewMap.delete(i)),this.setInstanceIdToAppMap(i.InstanceId,i),this.setInstanceIdToSlideIdMap(i.InstanceId,t),r&&this.m_slideIdToAppForOfficeThemeMap.set(t,r),l=new d(this,e,t,this.m_managerSettings.IsRtl),this.m_appForOfficeToAppForOfficeViewMap.set(i,l),l.activateAppsForOffice([i],this.contextActivationManager(),!1),n.end=N.performanceNowTrimmed(),a.a.sendTraceTag(554725912,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`Apps For Office on the slide ${this.m_currentSlideId} are activated.`),n}getAppForOfficeViewByAppForOffice(e){if(e&&this.m_appForOfficeToAppForOfficeViewMap.has(e))return this.m_appForOfficeToAppForOfficeViewMap.get(e)}getAppByInstanceId(e){return f.b.validateArgument(e),this.m_instanceIdToAppMapping.get(e)}setInstanceIdToAppMap(e,t){null!=t&&null!=e&&this.m_instanceIdToAppMapping.set(e,t)}setInstanceIdToAppMapForSlide(e){for(let t of e)this.setInstanceIdToAppMap(t.InstanceId,t)}getAppForOfficeViewBySlide(e){for(let t of this.m_appForOfficeViewQueue)if(t.Id===e)return t;return null}getAppForOfficeThemeBySlide(e){return this.m_slideIdToAppForOfficeThemeMap.get(e)}hideAppForOfficeViewsExcludeCurrentSlide(){if(null!=this.m_currentSlideId)for(let e of this.m_appForOfficeViewQueue)e.Id!==this.m_currentSlideId&&e.hideAppsForOffice()}hideAppForOfficeOnSlide(e){if(this.fInitialized()&&(null==e||this.m_currentSlideId===e)&&null!=this.m_currentSlideId)for(let e of this.m_appForOfficeViewQueue)e.Id===this.m_currentSlideId&&e.hideAppsForOffice()}async updateAddinSyncState(e){this.raiseEventToAppForOffice(OSF.DDA.EventDispId.dispidLiveShareStateChangedEvent.toString(),e.instanceId,e.liveShareState)}notifyHostCallback(e,t){if(a.a.sendTraceTag(557335682,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`AppForOfficeManager::notifyHostCallback contextId:${e} actionId:${t}`),t===OSF.AgaveHostAction.TabExit||t===OSF.AgaveHostAction.TabExitShift)try{let i=t===OSF.AgaveHostAction.TabExit?OSF.AgaveHostAction.TabIn:OSF.AgaveHostAction.TabInShift,r=void 0;if(null!=this.m_currentSlideId){let i=this.getAppForOfficeViewBySlide(this.m_currentSlideId);if(i){let n=t===OSF.AgaveHostAction.TabExit;r=i.findActivatedViewElementSiblingByInstanceId(e,n)}}if(null!=r)a.a.sendTraceTag(557335683,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"AppForOfficeManager::NotifyHostCallback Switching focus to another Agave for TabExit/TabExitShift. ContextID of newly focused Agave: "+r.AppForOffice.InstanceId),N.m_appForOfficeContextActivivationManager.notifyAgave(r.AppForOffice.InstanceId,i);else{a.a.sendTraceTag(557335684,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,"AppForOfficeManager::NotifyHostCallback Switching focus to slide pane for TabExit/TabExitShift.");const t=this.getAppByInstanceId(e);if(t){const e=this.getAppForOfficeViewByAppForOffice(t);e&&e.ParentElement&&e.ParentElement.focus()}}}catch(e){a.a.sendTraceTag(557335685,s.a.msoulscat_Wac_PptSlideshow,o.a.Error,"AppForOfficeManager::NotifyHostCallback Switching focus threw an exception: "+e)}}contextActivationManager(){if(null==N.m_appForOfficeContextActivivationManager){let e;if(this.m_managerSettings.AppForOfficeContextActivationParameters)e=this.m_managerSettings.AppForOfficeContextActivationParameters,null!=e.isHostFrameTrusted&&(this.m_frameTrustState=e.isHostFrameTrusted);else{e=new Object,e.appVersion="16",e.appUILocale=this.m_managerSettings.AppUILocale,e.dataLocale=this.m_managerSettings.AppUILocale,e.osfOmexBaseUrl=this.m_managerSettings.AppForOfficeOmexBaseUrl,e.docUrl="",e.pageBaseUrl=this.m_managerSettings.ServerUrl,e.lcid=this.m_managerSettings.AppLcid,e.allowExternalMarketplace=this.m_managerSettings.AppForOfficeAllowExternalMarketplace;let t=this.m_managerSettings.ServerUrl+"/pptscripts/",i=this.m_managerSettings.ServerUrl+"/pptresources/";this.m_managerSettings.JsScriptsBasePath&&(t=this.m_managerSettings.JsScriptsBasePath,i=this.m_managerSettings.JsScriptsBasePath.replace("_pptscripts","_pptresources")),e.localizedScriptsUrl=`${t}/${this.m_managerSettings.AppLcid}/`,e.localizedImagesUrl=`${i}/${this.m_managerSettings.AppLcid}/`,e.localizedStylesUrl=`${i}/${this.m_managerSettings.AppLcid}/`,e.trustAgaves=this.m_managerSettings.AppForOfficeTrustUXIsEnabledForPowerPoint,e.enablePrivateCatalog=this.m_managerSettings.AppsForOfficePrivateCatalogEnabled,e.enableUploadFileDevCatalog=!this.m_managerSettings.UploadFileDevCatalogIsDisabled,e.appSettings={},e.hostFeatureGateFlag=0,e.isHostFrameTrustCheckEnabledForAddIns=!0,e.hostAllowedSdxEmbedding=!0,this.m_frameTrustState===r.NotInitialized&&window.self===window.top&&(this.m_frameTrustState=r.Trusted),e.isHostFrameTrusted=this.m_frameTrustState}e.appName=OSF.AppName.PowerpointWebApp,e.clientMode=OSF.ClientMode.ReadOnly,e.formFactor=OSF.FormFactor.Default,e.notifyHost=this.notifyHostCallback.bind(this),e.hostControl=new c(this.m_methodFactory,this.m_eventStore),e.externalLogger=this.m_managerSettings.ExtLogger,e.appSettings&&(e.appSettings.PowerPointModernSlideShowEnabled=!0,e.appSettings.PowerPointModernSlideShowUiHost=this.m_managerSettings.UiHost||n.c.Unknown,e.appSettings.PowerPointModernSlideShowCurrentRole=this.m_managerSettings.SlideShowRole||n.b.Presenter,e.appSettings.PowerPointModernSlideShowTeamsCallId=this.m_managerSettings.TeamsCallId||"");let t=new OSF.ContextActivationManager(e);t.setWSA(this.m_managerSettings.TheWsaClient),N.m_appForOfficeContextActivivationManager=t,this.m_frameTrustState!==r.NotInitialized&&this.m_frameTrustState!==r.NotReady||this.events.emit("frameTrustCheck")}return N.m_appForOfficeContextActivivationManager}updateAppForOfficeLayout(e,t){if(!this.fInitialized()||!e||!t)return;const i=this.getAppForOfficeViewByAppForOffice(t);if(i){i.hideAppsForOffice(),i.ParentElement=e;const r=i.findActivatedAppForOfficeViewElement(t);r&&i.ParentElement.appendChild(r.Element),i.updateLayout(),i.showAppsForOffice()}}updateLayout(e){if(!this.fInitialized())return;if(null!=e&&this.m_currentSlideId!==e)return;let t=this.getAppForOfficeViewBySlide(this.m_currentSlideId);null!=t&&t.updateLayout()}hasAppForOfficeBeenPrepared(e,t){return e===this.m_currentSlideId||!(null==this.m_slideIdToAppForOfficeViewMap||!this.m_slideIdToAppForOfficeViewMap.has(e))&&this.m_slideIdToAppForOfficeViewMap.get(e).hasAppForOfficeBeenPrepared(t)}async prepareAppForOffice(e,t,i){let r=this.m_slideIdToAppForOfficeViewMap?this.m_slideIdToAppForOfficeViewMap.get(e):null;this.setInstanceIdToSlideIdMap(t.InstanceId,e),null==r&&(r=new d(this,this.m_panelParentElement,e,this.m_managerSettings.IsRtl),this.m_slideIdToAppForOfficeViewMap.set(e,r)),r.preactivateAppsForOffice(t,this.contextActivationManager(),i),a.a.sendTraceTag(557335686,s.a.msoulscat_Wac_PptSlideshow,o.a.Info,`Apps For Office on the slide ${e} are showing.`)}raiseEventToAppForOffice(e,t,i=!0){if(this.m_eventStore){let r=this.m_eventStore.getApiEvent(e);r&&r.raiseEvent(i,t)}}disposeAppForOfficeView(e){e.getContainedAppsForOffice().forEach(e=>{this.m_eventStore&&this.m_eventStore.clearHandlersForApp(e.InstanceId),N.m_appForOfficeContextActivivationManager.purgeOsfControl(e.InstanceId,!1)}),e.dispose(),e&&N.m_appForOfficeContextActivivationManager}setInstanceIdToSlideIdMap(e,t){null!=e&&null!=t&&this.m_instanceIdToSlideIdMapping.set(e,t)}setInstanceIdToSlideIdMapForSlide(e,t){for(let i of t)this.setInstanceIdToSlideIdMap(i.InstanceId,e)}getSlideIdByInstanceId(e){return null==e?null:this.m_instanceIdToSlideIdMapping.get(e)}async getAccessTokenAsync(e,t){try{if(null==this.m_appsForOfficeAuthProvider){if(null==this.m_managerSettings.AppsForOfficeAuthFactory)return;this.m_appsForOfficeAuthProvider=this.m_managerSettings.AppsForOfficeAuthFactory.createAuthProviderAsync(this.contextActivationManager())}const i=await this.m_appsForOfficeAuthProvider;return await i.getAccessTokenAsync(e,t)}catch{return}}get ApiFacade(){return this.m_apiHelper}set ApiFacade(e){this.m_apiHelper=e}get AreThirdPartyAddInsAllowed(){return this.m_managerSettings.AreThirdPartyAddInsAllowed}static performanceNowTrimmed(){return Math.round(performance.now())}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return o}));var r=i(16),n=i(0),a=i(14);class s{constructor(e,t){this.mode=e,this.order=t}clone(){return new s(this.mode,this.order)}equals(e){return this.mode==e.mode&&this.order==e.order}}s.Default=new s(1,1);class o{constructor(e=0,t=0,i=!1,n=!1,a=!1,s=!1,o=!1){this.m_changeTracker=new r.a,this.m_presetChangeTracker=new r.a,this.m_preset=e,this.m_param=t,this.m_flipX=i,this.m_flipY=n,this.m_transposeXY=a,this.m_reverse=s,this.m_isDistributedByLength=o,this.m_progress=0}clone(){const e=new o(this.m_preset,this.m_param,this.m_flipX,this.m_flipY,this.m_transposeXY,this.m_reverse,this.m_isDistributedByLength);return e.m_drawFadeOptions=this.m_drawFadeOptions,e.m_progress=this.m_progress,e}equals(e){return this.m_progress==e.m_progress&&this.m_preset==e.m_preset&&this.m_param==e.m_param&&this.m_flipX==e.m_flipX&&this.m_flipY==e.m_flipY&&this.m_transposeXY==e.m_transposeXY&&this.m_reverse==e.m_reverse&&this.m_isDistributedByLength==e.m_isDistributedByLength&&this.m_drawFadeOptions==e.m_drawFadeOptions}get changeTracker(){return this.m_changeTracker}get presetChangeTracker(){return this.m_presetChangeTracker}get progress(){return this.m_progress}get preset(){return this.m_preset}get param(){return this.m_param}get flipX(){return this.m_flipX}get flipY(){return this.m_flipY}get transposeXY(){return this.m_transposeXY}get reverse(){return this.m_reverse}get isDistributedByLength(){return this.m_isDistributedByLength}get drawFadeOptions(){return this.m_drawFadeOptions}set progress(e){Object(a.a)(this.m_changeTracker,this.m_progress,e),this.m_progress=e}set preset(e){Object(a.a)(this.m_changeTracker,this.m_preset,e),Object(a.a)(this.m_presetChangeTracker,this.m_preset,e),this.m_preset=e}set param(e){Object(a.a)(this.m_changeTracker,this.m_param,e),this.m_param=e}set flipX(e){Object(a.a)(this.m_changeTracker,this.m_flipX,e),this.m_flipX=e}set flipY(e){Object(a.a)(this.m_changeTracker,this.m_flipY,e),this.m_flipY=e}set transposeXY(e){Object(a.a)(this.m_changeTracker,this.m_transposeXY,e),this.m_transposeXY=e}set reverse(e){Object(a.a)(this.m_changeTracker,this.m_reverse,e),this.m_reverse=e}set isDistributedByLength(e){Object(a.a)(this.m_changeTracker,this.m_isDistributedByLength,e),this.m_isDistributedByLength=e}set drawFadeOptions(e){Object(a.c)(this.m_changeTracker,this.m_drawFadeOptions,e),this.m_drawFadeOptions=e}getFadeTransform(){const e=n.e.Flip(this.flipX,this.flipY);return new n.b(this.transposeXY?0:e.x,this.transposeXY?e.x:0,0,this.transposeXY?e.y:0,this.transposeXY?0:e.y,0,0,0,1)}}},function(e,t,i){"use strict";(function(e,i){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=void 0!==e&&"[object global]"==={}.toString.call(e);function s(e,t){return 0===e.indexOf(t.toLowerCase())?e:"".concat(t.toLowerCase()).concat(e.substr(0,1).toUpperCase()).concat(e.substr(1))}function o(e){return Boolean(e&&1===e.nodeType&&"nodeName"in e&&e.ownerDocument&&e.ownerDocument.defaultView)}function l(e){return!isNaN(parseFloat(e))&&isFinite(e)&&Math.floor(e)==e}function d(e){return/^(https?:)?\/\/((player|www)\.)?vimeo\.com(?=$|\/)/.test(e)}function h(e){return/^https:\/\/player\.vimeo\.com\/video\/\d+/.test(e)}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.id,i=e.url,r=t||i;if(!r)throw new Error("An id or url must be passed, either in an options object or as a data-vimeo-id or data-vimeo-url attribute.");if(l(r))return"https://vimeo.com/".concat(r);if(d(r))return r.replace("http:","https:");if(t)throw new TypeError("".concat(t," is not a valid video id."));throw new TypeError("".concat(r," is not a vimeo.com url."))}var u=void 0!==Array.prototype.indexOf,f="undefined"!=typeof window&&void 0!==window.postMessage;if(!(a||u&&f))throw new Error("Sorry, the Vimeo Player API is not available in this browser.");var m="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};!function(e){if(!e.WeakMap){var t=Object.prototype.hasOwnProperty,i=Object.defineProperty&&function(){try{return 1===Object.defineProperty({},"x",{value:1}).x}catch(e){}}(),r=function(e,t,r){i?Object.defineProperty(e,t,{configurable:!0,writable:!0,value:r}):e[t]=r};e.WeakMap=function(){function e(){if(void 0===this)throw new TypeError("Constructor WeakMap requires 'new'");if(r(this,"_id",a("_WeakMap")),arguments.length>0)throw new TypeError("WeakMap iterable is not supported")}function i(e,i){if(!n(e)||!t.call(e,"_id"))throw new TypeError(i+" method called on incompatible receiver "+typeof e)}function a(e){return e+"_"+s()+"."+s()}function s(){return Math.random().toString().substring(2)}return r(e.prototype,"delete",(function(e){if(i(this,"delete"),!n(e))return!1;var t=e[this._id];return!(!t||t[0]!==e||(delete e[this._id],0))})),r(e.prototype,"get",(function(e){if(i(this,"get"),n(e)){var t=e[this._id];return t&&t[0]===e?t[1]:void 0}})),r(e.prototype,"has",(function(e){if(i(this,"has"),!n(e))return!1;var t=e[this._id];return!(!t||t[0]!==e)})),r(e.prototype,"set",(function(e,t){if(i(this,"set"),!n(e))throw new TypeError("Invalid value used as weak map key");var a=e[this._id];return a&&a[0]===e?(a[1]=t,this):(r(e,this._id,[e,t]),this)})),r(e,"_polyfill",!0),e}()}function n(e){return Object(e)===e}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:m);var p=function(e,t){return function(e){var t,r,n;n=function(){var e,t,r,n=Object.prototype.toString,a=void 0!==i?function(e){return i(e)}:setTimeout;try{Object.defineProperty({},"x",{}),e=function(e,t,i,r){return Object.defineProperty(e,t,{value:i,writable:!0,configurable:!1!==r})}}catch(t){e=function(e,t,i){return e[t]=i,e}}function s(e,i){r.add(e,i),t||(t=a(r.drain))}function o(e){var t,i=typeof e;return null==e||"object"!=i&&"function"!=i||(t=e.then),"function"==typeof t&&t}function l(){for(var e=0;e<this.chain.length;e++)d(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function d(e,t,i){var r,n;try{!1===t?i.reject(e.msg):(r=!0===t?e.msg:t.call(void 0,e.msg))===i.promise?i.reject(TypeError("Promise-chain cycle")):(n=o(r))?n.call(r,i.resolve,i.reject):i.resolve(r)}catch(e){i.reject(e)}}function h(e){var t,i=this;if(!i.triggered){i.triggered=!0,i.def&&(i=i.def);try{(t=o(e))?s((function(){var r=new f(i);try{t.call(e,(function(){h.apply(r,arguments)}),(function(){c.apply(r,arguments)}))}catch(e){c.call(r,e)}})):(i.msg=e,i.state=1,i.chain.length>0&&s(l,i))}catch(e){c.call(new f(i),e)}}}function c(e){var t=this;t.triggered||(t.triggered=!0,t.def&&(t=t.def),t.msg=e,t.state=2,t.chain.length>0&&s(l,t))}function u(e,t,i,r){for(var n=0;n<t.length;n++)!function(n){e.resolve(t[n]).then((function(e){i(n,e)}),r)}(n)}function f(e){this.def=e,this.triggered=!1}function m(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function p(e){if("function"!=typeof e)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var t=new m(this);this.then=function(e,i){var r={success:"function"!=typeof e||e,failure:"function"==typeof i&&i};return r.promise=new this.constructor((function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");r.resolve=e,r.reject=t})),t.chain.push(r),0!==t.state&&s(l,t),r.promise},this.catch=function(e){return this.then(void 0,e)};try{e.call(void 0,(function(e){h.call(t,e)}),(function(e){c.call(t,e)}))}catch(e){c.call(t,e)}}r=function(){var e,i,r;function n(e,t){this.fn=e,this.self=t,this.next=void 0}return{add:function(t,a){r=new n(t,a),i?i.next=r:e=r,i=r,r=void 0},drain:function(){var r=e;for(e=i=t=void 0;r;)r.fn.call(r.self),r=r.next}}}();var g=e({},"constructor",p,!1);return p.prototype=g,e(g,"__NPO__",0,!1),e(p,"resolve",(function(e){return e&&"object"==typeof e&&1===e.__NPO__?e:new this((function(t,i){if("function"!=typeof t||"function"!=typeof i)throw TypeError("Not a function");t(e)}))})),e(p,"reject",(function(e){return new this((function(t,i){if("function"!=typeof t||"function"!=typeof i)throw TypeError("Not a function");i(e)}))})),e(p,"all",(function(e){var t=this;return"[object Array]"!=n.call(e)?t.reject(TypeError("Not an array")):0===e.length?t.resolve([]):new t((function(i,r){if("function"!=typeof i||"function"!=typeof r)throw TypeError("Not a function");var n=e.length,a=Array(n),s=0;u(t,e,(function(e,t){a[e]=t,++s===n&&i(a)}),r)}))})),e(p,"race",(function(e){var t=this;return"[object Array]"!=n.call(e)?t.reject(TypeError("Not an array")):new t((function(i,r){if("function"!=typeof i||"function"!=typeof r)throw TypeError("Not a function");u(t,e,(function(e,t){i(t)}),r)}))})),p},(r=m)[t="Promise"]=r[t]||n(),e.exports&&(e.exports=r[t])}(t={exports:{}}),t.exports}(),g=new WeakMap;function _(e,t,i){var r=g.get(e.element)||{};t in r||(r[t]=[]),r[t].push(i),g.set(e.element,r)}function v(e,t){return(g.get(e.element)||{})[t]||[]}function y(e,t,i){var r=g.get(e.element)||{};if(!r[t])return!0;if(!i)return r[t]=[],g.set(e.element,r),!0;var n=r[t].indexOf(i);return-1!==n&&r[t].splice(n,1),g.set(e.element,r),r[t]&&0===r[t].length}function b(e,t){var i=g.get(e);g.set(t,i),g.delete(e)}function S(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){return console.warn(e),{}}return e}function T(e,t,i){if(e.element.contentWindow&&e.element.contentWindow.postMessage){var r={method:t};void 0!==i&&(r.value=i);var n=parseFloat(navigator.userAgent.toLowerCase().replace(/^.*msie (\d+).*$/,"$1"));n>=8&&n<10&&(r=JSON.stringify(r)),e.element.contentWindow.postMessage(r,e.origin)}}function w(e,t){var i,r=[];if((t=S(t)).event)"error"===t.event&&v(e,t.data.method).forEach((function(i){var r=new Error(t.data.message);r.name=t.data.name,i.reject(r),y(e,t.data.method,i)})),r=v(e,"event:".concat(t.event)),i=t.data;else if(t.method){var n=function(e,t){var i=v(e,t);if(i.length<1)return!1;var r=i.shift();return y(e,t,r),r}(e,t.method);n&&(r.push(n),i=t.value)}r.forEach((function(t){try{if("function"==typeof t)return void t.call(e,i);t.resolve(i)}catch(e){}}))}var M=["autopause","autoplay","background","byline","color","controls","dnt","height","id","interactive_params","keyboard","loop","maxheight","maxwidth","muted","playsinline","portrait","responsive","speed","texttrack","title","transparent","url","width"];function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return M.reduce((function(t,i){var r=e.getAttribute("data-vimeo-".concat(i));return(r||""===r)&&(t[i]=""===r?1:r),t}),t)}function I(e,t){var i=e.html;if(!t)throw new TypeError("An element must be provided");if(null!==t.getAttribute("data-vimeo-initialized"))return t.querySelector("iframe");var r=document.createElement("div");return r.innerHTML=i,t.appendChild(r.firstChild),t.setAttribute("data-vimeo-initialized","true"),t.querySelector("iframe")}function P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;return new Promise((function(r,n){if(!d(e))throw new TypeError("".concat(e," is not a vimeo.com url."));var a="https://vimeo.com/api/oembed.json?url=".concat(encodeURIComponent(e));for(var s in t)t.hasOwnProperty(s)&&(a+="&".concat(s,"=").concat(encodeURIComponent(t[s])));var o="XDomainRequest"in window?new XDomainRequest:new XMLHttpRequest;o.open("GET",a,!0),o.onload=function(){if(404!==o.status)if(403!==o.status)try{var t=JSON.parse(o.responseText);if(403===t.domain_status_code)return I(t,i),void n(new Error("".concat(e," is not embeddable.")));r(t)}catch(e){n(e)}else n(new Error("".concat(e," is not embeddable.")));else n(new Error("".concat(e," was not found.")))},o.onerror=function(){var e=o.status?" (".concat(o.status,")"):"";n(new Error("There was an error fetching the embed code from Vimeo".concat(e,".")))},o.send()}))}var E=new WeakMap,x=new WeakMap,A={},k=function(){function e(t){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r(this,e),window.jQuery&&t instanceof jQuery&&(t.length>1&&window.console&&console.warn&&console.warn("A jQuery object with multiple elements was passed, using the first element."),t=t[0]),"undefined"!=typeof document&&"string"==typeof t&&(t=document.getElementById(t)),!o(t))throw new TypeError("You must pass either a valid element or a valid id.");if("IFRAME"!==t.nodeName){var a=t.querySelector("iframe");a&&(t=a)}if("IFRAME"===t.nodeName&&!d(t.getAttribute("src")||""))throw new Error("The player element passed isnt a Vimeo embed.");if(E.has(t))return E.get(t);this._window=t.ownerDocument.defaultView,this.element=t,this.origin="*";var s=new p((function(e,r){if(i._onMessage=function(t){if(d(t.origin)&&i.element.contentWindow===t.source){"*"===i.origin&&(i.origin=t.origin);var n=S(t.data);if(n&&"error"===n.event&&n.data&&"ready"===n.data.method){var a=new Error(n.data.message);return a.name=n.data.name,void r(a)}var s=n&&"ready"===n.event,o=n&&"ping"===n.method;if(s||o)return i.element.setAttribute("data-ready","true"),void e();w(i,n)}},i._window.addEventListener("message",i._onMessage),"IFRAME"!==i.element.nodeName){var a=C(t,n);P(c(a),a,t).then((function(e){var r=I(e,t);return i.element=r,i._originalElement=t,b(t,r),E.set(i.element,i),e})).catch(r)}}));if(x.set(this,s),E.set(this.element,this),"IFRAME"===this.element.nodeName&&T(this,"ping"),A.isEnabled){var l=function(){return A.exit()};this.fullscreenchangeHandler=function(){A.isFullscreen?_(i,"event:exitFullscreen",l):y(i,"event:exitFullscreen",l),i.ready().then((function(){T(i,"fullscreenchange",A.isFullscreen)}))},A.on("fullscreenchange",this.fullscreenchangeHandler)}return this}var t,i;return t=e,(i=[{key:"callMethod",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new p((function(r,n){return t.ready().then((function(){_(t,e,{resolve:r,reject:n}),T(t,e,i)})).catch(n)}))}},{key:"get",value:function(e){var t=this;return new p((function(i,r){return e=s(e,"get"),t.ready().then((function(){_(t,e,{resolve:i,reject:r}),T(t,e)})).catch(r)}))}},{key:"set",value:function(e,t){var i=this;return new p((function(r,n){if(e=s(e,"set"),null==t)throw new TypeError("There must be a value to set.");return i.ready().then((function(){_(i,e,{resolve:r,reject:n}),T(i,e,t)})).catch(n)}))}},{key:"on",value:function(e,t){if(!e)throw new TypeError("You must pass an event name.");if(!t)throw new TypeError("You must pass a callback function.");if("function"!=typeof t)throw new TypeError("The callback must be a function.");0===v(this,"event:".concat(e)).length&&this.callMethod("addEventListener",e).catch((function(){})),_(this,"event:".concat(e),t)}},{key:"off",value:function(e,t){if(!e)throw new TypeError("You must pass an event name.");if(t&&"function"!=typeof t)throw new TypeError("The callback must be a function.");y(this,"event:".concat(e),t)&&this.callMethod("removeEventListener",e).catch((function(e){}))}},{key:"loadVideo",value:function(e){return this.callMethod("loadVideo",e)}},{key:"ready",value:function(){var e=x.get(this)||new p((function(e,t){t(new Error("Unknown player. Probably unloaded."))}));return p.resolve(e)}},{key:"addCuePoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.callMethod("addCuePoint",{time:e,data:t})}},{key:"removeCuePoint",value:function(e){return this.callMethod("removeCuePoint",e)}},{key:"enableTextTrack",value:function(e,t){if(!e)throw new TypeError("You must pass a language.");return this.callMethod("enableTextTrack",{language:e,kind:t})}},{key:"disableTextTrack",value:function(){return this.callMethod("disableTextTrack")}},{key:"pause",value:function(){return this.callMethod("pause")}},{key:"play",value:function(){return this.callMethod("play")}},{key:"requestFullscreen",value:function(){return A.isEnabled?A.request(this.element):this.callMethod("requestFullscreen")}},{key:"exitFullscreen",value:function(){return A.isEnabled?A.exit():this.callMethod("exitFullscreen")}},{key:"getFullscreen",value:function(){return A.isEnabled?p.resolve(A.isFullscreen):this.get("fullscreen")}},{key:"requestPictureInPicture",value:function(){return this.callMethod("requestPictureInPicture")}},{key:"exitPictureInPicture",value:function(){return this.callMethod("exitPictureInPicture")}},{key:"getPictureInPicture",value:function(){return this.get("pictureInPicture")}},{key:"unload",value:function(){return this.callMethod("unload")}},{key:"destroy",value:function(){var e=this;return new p((function(t){if(x.delete(e),E.delete(e.element),e._originalElement&&(E.delete(e._originalElement),e._originalElement.removeAttribute("data-vimeo-initialized")),e.element&&"IFRAME"===e.element.nodeName&&e.element.parentNode&&(e.element.parentNode.parentNode&&e._originalElement&&e._originalElement!==e.element.parentNode?e.element.parentNode.parentNode.removeChild(e.element.parentNode):e.element.parentNode.removeChild(e.element)),e.element&&"DIV"===e.element.nodeName&&e.element.parentNode){e.element.removeAttribute("data-vimeo-initialized");var i=e.element.querySelector("iframe");i&&i.parentNode&&(i.parentNode.parentNode&&e._originalElement&&e._originalElement!==i.parentNode?i.parentNode.parentNode.removeChild(i.parentNode):i.parentNode.removeChild(i))}e._window.removeEventListener("message",e._onMessage),A.isEnabled&&A.off("fullscreenchange",e.fullscreenchangeHandler),t()}))}},{key:"getAutopause",value:function(){return this.get("autopause")}},{key:"setAutopause",value:function(e){return this.set("autopause",e)}},{key:"getBuffered",value:function(){return this.get("buffered")}},{key:"getCameraProps",value:function(){return this.get("cameraProps")}},{key:"setCameraProps",value:function(e){return this.set("cameraProps",e)}},{key:"getChapters",value:function(){return this.get("chapters")}},{key:"getCurrentChapter",value:function(){return this.get("currentChapter")}},{key:"getColor",value:function(){return this.get("color")}},{key:"setColor",value:function(e){return this.set("color",e)}},{key:"getCuePoints",value:function(){return this.get("cuePoints")}},{key:"getCurrentTime",value:function(){return this.get("currentTime")}},{key:"setCurrentTime",value:function(e){return this.set("currentTime",e)}},{key:"getDuration",value:function(){return this.get("duration")}},{key:"getEnded",value:function(){return this.get("ended")}},{key:"getLoop",value:function(){return this.get("loop")}},{key:"setLoop",value:function(e){return this.set("loop",e)}},{key:"setMuted",value:function(e){return this.set("muted",e)}},{key:"getMuted",value:function(){return this.get("muted")}},{key:"getPaused",value:function(){return this.get("paused")}},{key:"getPlaybackRate",value:function(){return this.get("playbackRate")}},{key:"setPlaybackRate",value:function(e){return this.set("playbackRate",e)}},{key:"getPlayed",value:function(){return this.get("played")}},{key:"getQualities",value:function(){return this.get("qualities")}},{key:"getQuality",value:function(){return this.get("quality")}},{key:"setQuality",value:function(e){return this.set("quality",e)}},{key:"getSeekable",value:function(){return this.get("seekable")}},{key:"getSeeking",value:function(){return this.get("seeking")}},{key:"getTextTracks",value:function(){return this.get("textTracks")}},{key:"getVideoEmbedCode",value:function(){return this.get("videoEmbedCode")}},{key:"getVideoId",value:function(){return this.get("videoId")}},{key:"getVideoTitle",value:function(){return this.get("videoTitle")}},{key:"getVideoWidth",value:function(){return this.get("videoWidth")}},{key:"getVideoHeight",value:function(){return this.get("videoHeight")}},{key:"getVideoUrl",value:function(){return this.get("videoUrl")}},{key:"getVolume",value:function(){return this.get("volume")}},{key:"setVolume",value:function(e){return this.set("volume",e)}}])&&n(t.prototype,i),e}();a||(A=function(){var e=function(){for(var e,t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,r=t.length,n={};i<r;i++)if((e=t[i])&&e[1]in document){for(i=0;i<e.length;i++)n[t[0][i]]=e[i];return n}return!1}(),t={fullscreenchange:e.fullscreenchange,fullscreenerror:e.fullscreenerror},i={request:function(t){return new Promise((function(r,n){var a=function e(){i.off("fullscreenchange",e),r()};i.on("fullscreenchange",a);var s=(t=t||document.documentElement)[e.requestFullscreen]();s instanceof Promise&&s.then(a).catch(n)}))},exit:function(){return new Promise((function(t,r){if(i.isFullscreen){var n=function e(){i.off("fullscreenchange",e),t()};i.on("fullscreenchange",n);var a=document[e.exitFullscreen]();a instanceof Promise&&a.then(n).catch(r)}else t()}))},on:function(e,i){var r=t[e];r&&document.addEventListener(r,i)},off:function(e,i){var r=t[e];r&&document.removeEventListener(r,i)}};return Object.defineProperties(i,{isFullscreen:{get:function(){return Boolean(document[e.fullscreenElement])}},element:{enumerable:!0,get:function(){return document[e.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(document[e.fullscreenEnabled])}}}),i}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=[].slice.call(e.querySelectorAll("[data-vimeo-id], [data-vimeo-url]")),i=function(e){"console"in window&&console.error&&console.error("There was an error creating an embed: ".concat(e))};t.forEach((function(e){try{if(null!==e.getAttribute("data-vimeo-defer"))return;var t=C(e);P(c(t),t,e).then((function(t){return I(t,e)})).catch(i)}catch(e){i(e)}}))}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(!window.VimeoPlayerResizeEmbeds_){window.VimeoPlayerResizeEmbeds_=!0;var t=function(t){if(d(t.origin)&&t.data&&"spacechange"===t.data.event)for(var i=e.querySelectorAll("iframe"),r=0;r<i.length;r++)if(i[r].contentWindow===t.source){i[r].parentElement.style.paddingBottom="".concat(t.data.data[0].bottom,"px");break}};window.addEventListener("message",t)}}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(!window.VimeoSeoMetadataAppended){window.VimeoSeoMetadataAppended=!0;var t=function(t){if(d(t.origin)){var i=S(t.data);if(i&&"ready"===i.event)for(var r=e.querySelectorAll("iframe"),n=0;n<r.length;n++){var a=r[n],s=a.contentWindow===t.source;h(a.src)&&s&&new k(a).callMethod("appendVideoMetadata",window.location.href)}}};window.addEventListener("message",t)}}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(!window.VimeoCheckedUrlTimeParam){window.VimeoCheckedUrlTimeParam=!0;var t=function(e){"console"in window&&console.error&&console.error("There was an error getting video Id: ".concat(e))},i=function(i){if(d(i.origin)){var r=S(i.data);if(r&&"ready"===r.event)for(var n=e.querySelectorAll("iframe"),a=0;a<n.length;a++){var s=n[a],o=s.contentWindow===i.source;h(s.src)&&o&&function(){var e=new k(s);e.getVideoId().then((function(t){var i=new RegExp("[?&]vimeo_t_".concat(t,"=([^&#]*)")).exec(window.location.href);if(i&&i[1]){var r=decodeURI(i[1]);e.setCurrentTime(r)}})).catch(t)}()}}};window.addEventListener("message",i)}}()),t.a=k}).call(this,i(55),i(175).setImmediate)},function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return d}));var r=i(139),n=i(9),a=i(47),s=i(13),o=i(79);class l{constructor(e,t){this.visibleOpacity=".8",this.reducedOpacity=".1",this.updateDelay=.1,this.minCueMargin=.5,this.textTimeout=5,this.boxHeight=94,this.maxCharacterWidth=400,this.fontSize=24,this.lastUpdate=0,this.activeTextTrackIndex=0,this.activeCueIndex=0,this.currentOpacity=this.visibleOpacity,this.defaultLang="",this.activeCues=[],this.onResize=()=>{var e;setTimeout(()=>{this.setHorizontalPosition(void 0),this.setVerticalPosition(!0)},0),1===(null===(e=this.activeControls)||void 0===e?void 0:e.getPositioningStrategy)&&this.resetHorizontalPosition()},this.onPlay=()=>{},this.onSeeked=()=>{this.setInitialCue()},this.onTimeUpdate=()=>{if(0===this.activeCues.length&&this.cloneCues(),void 0!==this.activeControls&&this.updateContainer(this.activeControls.getZIndex()-1),void 0===this.activeVideoEl||this.activeVideoEl.paused||this.visible()||this.show(),-2===this.activeCueIndex||!this.visible()||0===this.activeCues.length||void 0===this.activeVideoEl||this.activeVideoEl.paused)return;if(this.activeVideoEl.currentTime-this.lastUpdate<this.updateDelay)return;this.lastUpdate=this.activeVideoEl.currentTime;const e=this.activeCueIndex+1>=this.activeCues.length;this.activeCueIndex>=0&&(this.activeCues[this.activeCueIndex].endTime<=this.activeVideoEl.currentTime||this.activeVideoEl.currentTime-this.activeCues[this.activeCueIndex].startTime>=this.textTimeout)&&(this.clearText(),e&&(this.activeCueIndex=-2)),e||this.activeCues[this.activeCueIndex+1].startTime<=this.activeVideoEl.currentTime&&(this.activeCueIndex+=1,this.setTextById(this.activeCueIndex))},this.container=Object(r.c)("div","captions-render-container"),this.container.id=s.I,this.hide(),Object(a.a)(this.container,{alignSelf:"center",background:"solid",backgroundColor:"#292827",borderRadius:"2px",fontFamily:'"Segoe UI", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontSize:this.fontSize+"px",color:"#F3F2F1",padding:"6px",pointerEvents:"none",position:"absolute",opacity:"0",overflow:"hidden",overflowWrap:"break-word",textAlign:"center",webkitLineClamp:"3",fontSizeAdjust:"100%"}),this.screenCoords=t,this.screenCoordsProvided=null!=t,this.parentName=e,""===this.parentName&&n.a.warn(509726802,"CaptionsRenderer constructor: parentName is empty")}get getDefaultLang(){return this.defaultLang}set setDefaultLang(e){this.defaultLang=e}show(){this.container.style.display="block"}hide(){this.container.style.display="none"}visible(){return"block"===this.container.style.display}onNavigatingFrom(){this.stopCaptionTrack()}setScreenCoords(e){this.screenCoords=e,this.screenCoordsProvided=null!=e}renderCaptionTrack(e,t,i){Object(a.a)(this.container,{fontSize:this.fontSize*t.getCaptionsScalingFactor()+"px"}),void 0!==this.activeVideoEl&&void 0!==this.activeControls&&this.activeVideoEl.id!==e.id&&(this.activeControls.disableCaptionsInPlayer(),this.stopRendering(),this.screenCoordsProvided||(this.screenCoords=e)),this.activeVideoEl=e,this.activeControls=t,this.activeTextTrackIndex=i,this.activeCues=[],this.cloneCues(),this.activeVideoEl.addEventListener("timeupdate",this.onTimeUpdate),this.activeVideoEl.addEventListener("seeked",this.onSeeked),this.activeVideoEl.addEventListener("play",this.onPlay),n.a.info(508155723,JSON.stringify({Description:"CaptionsRenderer.renderCaptionTrack: Info",Font:this.container.style.font,FontOpticalSizing:this.container.style.fontOpticalSizing,FontSize:this.container.style.fontSize,FontSizeAdjust:this.container.style.fontSizeAdjust,FontStretch:this.container.style.fontStretch,Height:this.container.style.height,Scale:this.container.style.scale})),this.startRendering()}stopCaptionTrack(){var e;0!==(null===(e=this.activeControls)||void 0===e?void 0:e.getCaptionSelection)&&(void 0!==this.activeVideoEl&&(this.activeVideoEl.removeEventListener("timeupdate",this.onTimeUpdate),this.activeVideoEl.removeEventListener("seeked",this.onSeeked),this.activeVideoEl.removeEventListener("play",this.onPlay)),this.stopRendering())}updateContainer(e){null===this.container.parentElement&&this.setParent(),this.setZIndex(e)}reduceOpacity(){this.currentOpacity=this.reducedOpacity,this.container.style.opacity=this.currentOpacity}resetOpacity(){this.currentOpacity=this.visibleOpacity,this.container.style.opacity=this.currentOpacity}setHorizontalPosition(e){if(null===this.container.parentElement)return void n.a.warn(508954693,"CaptionsRenderer.setHorizontalPosition: Parent element is null");if(null===this.screenCoords.parentElement)return void n.a.warn(508954692,"CaptionsRenderer.setHorizontalPosition: screenCoords parent element is null");const t=this.screenCoords.getBoundingClientRect().width,i=Math.min(t*s.j,this.maxCharacterWidth),r=.5*(this.container.parentElement.getBoundingClientRect().width-i);if(this.container.style.left=r+"px",this.container.style.right=r+"px",void 0!==e&&void 0!==this.activeControls&&this.activeControls.isVisible()&&void 0!==e&&this.boxIntersects(e)){const i=t/2<(e.left+e.right)/2;this.container.style.transform=i?`translateX(-${this.maxCharacterWidth}px)`:`translateX(${this.maxCharacterWidth}px)`,n.a.info(508954691,"CaptionsRenderer.setHorizontalPosition: Box overlaps controls, adjusting position: "+(i?"left":"right"))}}resetHorizontalPosition(){var e;1===(null===(e=this.activeControls)||void 0===e?void 0:e.getPositioningStrategy)&&(this.container.style.transform="")}setVerticalPosition(e){if(null===this.container.parentElement)return void n.a.warn(510252311,"CaptionsRenderer.setVerticalPosition: Parent element is null");if(null===this.screenCoords.parentElement)return void n.a.warn(509691528,"CaptionsRenderer.setVerticalPosition: screenCoords parent element is null");if(void 0===this.activeControls)return;if(!e&&1===this.activeControls.getPositioningStrategy&&!this.activeControls.isVisible())return;const t=Object(r.d)(this.screenCoords.style.width)*s.j;this.container.style.maxWidth=Math.min(t,this.maxCharacterWidth)+"px",this.container.style.maxHeight=this.boxHeight+"px";const i=this.screenCoords.getBoundingClientRect(),a=i.height,o=a*s.g,l=this.container.parentElement.getBoundingClientRect().bottom,d=l-i.bottom+o,h=l-this.activeControls.getBounds.top+o;n.a.info(510252309,`CaptionsRenderer.setVerticalPosition: Current bottom: ${this.container.style.bottom}, new bottom: ${d}, pageHeight: ${a}, boxHeight: ${this.boxHeight}, bottomOffset: ${o}, maxBoxWidth: ${t}, maxCharacterWidth: ${this.maxCharacterWidth}`),this.container.style.bottom=d+"px",2!==this.activeControls.getPositioningStrategy&&3!==this.activeControls.getPositioningStrategy&&this.boxIntersects(this.activeControls.getBounds)&&(this.container.style.bottom=h+"px",n.a.info(509691529,`CaptionsRenderer.setVerticalPosition: Box overlaps main controls, adjusting position upwards - old bottom: ${this.container.style.bottom}, new bottom: ${this.container.style.bottom} controls top: ${this.activeControls.getBounds.top}`))}boxIntersects(e){if(void 0===this.activeControls)return!1;const t=this.container.getBoundingClientRect(),i=t.right-t.left,n=Object(r.d)(this.container.style.maxWidth)/2-i/2,a=t.left-n,s=t.right+n,o=t.bottom,l=o-this.boxHeight;return!(e.right<a||e.left>s||e.bottom<l||e.top>o)}cloneCues(){var e;const t=null===(e=this.activeVideoEl)||void 0===e?void 0:e.textTracks[this.activeTextTrackIndex].cues;if(null!=t){const e=[];for(const i of t)e.push(new VTTCue(i.startTime,i.endTime,i.text));this.activeCues=e,this.setInitialCue()}}setParent(){const e=document.getElementById(this.parentName);null!==e?(this.container.addEventListener("resize",this.onResize),e.appendChild(this.container)):n.a.warn(510252312,"CaptionsRenderer.setParent: Parent was null, parentName: "+this.parentName)}setZIndex(e){this.container.style.zIndex=""+e}setInitialCue(){if(0!==this.activeCues.length){this.lastUpdate=0,this.clearText();for(let e=0;e<this.activeCues.length;e+=1){const t=this.activeCues[e];if(void 0===this.activeVideoEl)return;if(t.startTime>this.activeVideoEl.currentTime)return void(e>0?this.setTextById(e-1):this.activeCueIndex=-1);if(this.activeCueIndex=e,this.activeVideoEl.currentTime-t.startTime<=this.minCueMargin)return void this.setText(t.text)}}else this.activeCueIndex=0}startRendering(){this.visible()||void 0===this.activeVideoEl||this.activeVideoEl.paused||this.show(),this.setHorizontalPosition(void 0),this.setVerticalPosition(!0),0!==this.activeCues.length?this.setInitialCue():n.a.warn(509670627,"CaptionsRenderer.startRendering: activeCues is empty")}stopRendering(){this.visible()&&this.hide(),this.clearText()}clearText(){this.container.style.opacity="0",this.container.textContent=""}setText(e){this.container.style.opacity=this.currentOpacity,Object(o.a)(e,this.container)}setTextById(e){if(0===this.activeCues.length)return void(this.container.textContent="");const t=this.activeCues[e];void 0!==t?(this.container.style.opacity=this.currentOpacity,Object(o.a)(t.text,this.container)):this.container.textContent=""}}function d(e){const t=[];for(const i of e)t.push({language:i.language,label:i.label,cues:[]});return t}},function(e,t,i){var r,n,a;!function(s,o){"use strict";n=[i(406)],void 0===(a="function"==typeof(r=function(e){var t=/(^|@)\S+:\d+/,i=/^\s*at .*(\S+:\d+|\(native\))/m,r=/^(eval@)?(\[native code])?$/;return{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(i))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(t){return t.stack.split("\n").filter((function(e){return!!e.match(i)}),this).map((function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));var i=t.replace(/^\s+/,"").replace(/\(eval code/g,"("),r=i.match(/ (\((.+):(\d+):(\d+)\)$)/),n=(i=r?i.replace(r[0],""):i).split(/\s+/).slice(1),a=this.extractLocation(r?r[1]:n.pop()),s=n.join(" ")||void 0,o=["eval","<anonymous>"].indexOf(a[0])>-1?void 0:a[0];return new e({functionName:s,fileName:o,lineNumber:a[1],columnNumber:a[2],source:t})}),this)},parseFFOrSafari:function(t){return t.stack.split("\n").filter((function(e){return!e.match(r)}),this).map((function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===t.indexOf("@")&&-1===t.indexOf(":"))return new e({functionName:t});var i=/((.*".+"[^@]*)?[^@]*)(?:@)/,r=t.match(i),n=r&&r[1]?r[1]:void 0,a=this.extractLocation(t.replace(i,""));return new e({functionName:n,fileName:a[0],lineNumber:a[1],columnNumber:a[2],source:t})}),this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(t){for(var i=/Line (\d+).*script (?:in )?(\S+)/i,r=t.message.split("\n"),n=[],a=2,s=r.length;a<s;a+=2){var o=i.exec(r[a]);o&&n.push(new e({fileName:o[2],lineNumber:o[1],source:r[a]}))}return n},parseOpera10:function(t){for(var i=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=t.stacktrace.split("\n"),n=[],a=0,s=r.length;a<s;a+=2){var o=i.exec(r[a]);o&&n.push(new e({functionName:o[3]||void 0,fileName:o[2],lineNumber:o[1],source:r[a]}))}return n},parseOpera11:function(i){return i.stack.split("\n").filter((function(e){return!!e.match(t)&&!e.match(/^Error created at/)}),this).map((function(t){var i,r=t.split("@"),n=this.extractLocation(r.pop()),a=r.shift()||"",s=a.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;a.match(/\(([^)]*)\)/)&&(i=a.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var o=void 0===i||"[arguments not available]"===i?void 0:i.split(",");return new e({functionName:s,args:o,fileName:n[0],lineNumber:n[1],columnNumber:n[2],source:t})}),this)}}})?r.apply(t,n):r)||(e.exports=a)}()},,,,,,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Settings=void 0;var r=function(){function e(){}return e.load=function(t){for(var i in t)e.m_settings[i]=t[i]},e.readBooleanOrDefault=function(t,i){var r=void 0===e.m_settings?"":typeof e.m_settings[t];return"string"===r?"true"===e.m_settings[t].toLowerCase():"boolean"===r?e.m_settings[t]:i},e.readNumberOrDefault=function(t,i){var r=void 0===e.m_settings?"":typeof e.m_settings[t];return"string"===r||"number"===r?Number(e.m_settings[t]):i},e.readStringOrDefault=function(t,i){return void 0===e.m_settings||"string"!=typeof e.m_settings[t]?i:e.m_settings[t]},e.addOrUpdateSettingsFromUrl=function(t,i){var r=i.get("wdset");if(!r)return t;for(var n=0,a=r.split(",");n<a.length;n++){var s=a[n].split(":"),o=s[0].split("."),l=o[0],d=o[1],h=s[1];d&&h&&e.addOrUpdateSetting(t,l,d,h)}return t},e.addOrUpdateSetting=function(e,t,i,r){"__proto__"!==t&&(e[t]||(e[t]={}),e[t][i]=r)},e.m_settings={},e}();t.Settings=r},function(e,t,i){(function(e,t){!function(e,i){"use strict";if(!e.setImmediate){var r,n,a,s,o,l=1,d={},h=!1,c=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){m(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,i=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=i,t}}()?(s="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&m(+t.data.slice(s.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),r=function(t){e.postMessage(s+t,"*")}):e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){m(e.data)},r=function(e){a.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,r=function(e){var t=c.createElement("script");t.onreadystatechange=function(){m(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):r=function(e){setTimeout(m,0,e)},u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),i=0;i<t.length;i++)t[i]=arguments[i+1];var n={callback:e,args:t};return d[l]=n,r(l),l++},u.clearImmediate=f}function f(e){delete d[e]}function m(e){if(h)setTimeout(m,0,e);else{var t=d[e];if(t){h=!0;try{!function(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(void 0,i)}}(t)}finally{f(e),h=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,i(55),i(48))},function(e,t,i){"use strict";t.byteLength=function(e){var t=d(e),i=t[0],r=t[1];return 3*(i+r)/4-r},t.toByteArray=function(e){var t,i,r=d(e),s=r[0],o=r[1],l=new a(function(e,t,i){return 3*(t+i)/4-i}(0,s,o)),h=0,c=o>0?s-4:s;for(i=0;i<c;i+=4)t=n[e.charCodeAt(i)]<<18|n[e.charCodeAt(i+1)]<<12|n[e.charCodeAt(i+2)]<<6|n[e.charCodeAt(i+3)],l[h++]=t>>16&255,l[h++]=t>>8&255,l[h++]=255&t;return 2===o&&(t=n[e.charCodeAt(i)]<<2|n[e.charCodeAt(i+1)]>>4,l[h++]=255&t),1===o&&(t=n[e.charCodeAt(i)]<<10|n[e.charCodeAt(i+1)]<<4|n[e.charCodeAt(i+2)]>>2,l[h++]=t>>8&255,l[h++]=255&t),l},t.fromByteArray=function(e){for(var t,i=e.length,n=i%3,a=[],s=0,o=i-n;s<o;s+=16383)a.push(h(e,s,s+16383>o?o:s+16383));return 1===n?(t=e[i-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===n&&(t=(e[i-2]<<8)+e[i-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),a.join("")};for(var r=[],n=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=s.length;o<l;++o)r[o]=s[o],n[s.charCodeAt(o)]=o;function d(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function h(e,t,i){for(var n,a,s=[],o=t;o<i;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(r[(a=n)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,i,r,n){var a,s,o=8*n-r-1,l=(1<<o)-1,d=l>>1,h=-7,c=i?n-1:0,u=i?-1:1,f=e[t+c];for(c+=u,a=f&(1<<-h)-1,f>>=-h,h+=o;h>0;a=256*a+e[t+c],c+=u,h-=8);for(s=a&(1<<-h)-1,a>>=-h,h+=r;h>0;s=256*s+e[t+c],c+=u,h-=8);if(0===a)a=1-d;else{if(a===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),a-=d}return(f?-1:1)*s*Math.pow(2,a-r)},t.write=function(e,t,i,r,n,a){var s,o,l,d=8*a-n-1,h=(1<<d)-1,c=h>>1,u=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:a-1,m=r?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=h):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+c>=1?u/l:u*Math.pow(2,1-c))*l>=2&&(s++,l/=2),s+c>=h?(o=0,s=h):s+c>=1?(o=(t*l-1)*Math.pow(2,n),s+=c):(o=t*Math.pow(2,c-1)*Math.pow(2,n),s=0));n>=8;e[i+f]=255&o,f+=m,o/=256,n-=8);for(s=s<<n|o,d+=n;d>0;e[i+f]=255&s,f+=m,s/=256,d-=8);e[i+f-m]|=128*p}},function(e,t,i){(t=e.exports=i(178)).Stream=t,t.Readable=t,t.Writable=i(182),t.Duplex=i(105),t.Transform=i(183),t.PassThrough=i(281),t.finished=i(146),t.pipeline=i(282)},function(e,t){},function(e,t,i){"use strict";function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=i(43).Buffer,o=i(277).inspect,l=o&&o.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,i;return t=e,(i=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,i=""+t.data;t=t.next;)i+=e+t.data;return i}},{key:"concat",value:function(e){if(0===this.length)return s.alloc(0);for(var t,i,r,n=s.allocUnsafe(e>>>0),a=this.head,o=0;a;)t=a.data,i=n,r=o,s.prototype.copy.call(t,i,r),o+=a.data.length,a=a.next;return n}},{key:"consume",value:function(e,t){var i;return e<this.head.data.length?(i=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):i=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,i=1,r=t.data;for(e-=r.length;t=t.next;){var n=t.data,a=e>n.length?n.length:e;if(a===n.length?r+=n:r+=n.slice(0,e),0==(e-=a)){a===n.length?(++i,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=n.slice(a));break}++i}return this.length-=i,r}},{key:"_getBuffer",value:function(e){var t=s.allocUnsafe(e),i=this.head,r=1;for(i.data.copy(t),e-=i.data.length;i=i.next;){var n=i.data,a=e>n.length?n.length:e;if(n.copy(t,t.length-e,0,a),0==(e-=a)){a===n.length?(++r,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=n.slice(a));break}++r}return this.length-=r,t}},{key:l,value:function(e,t){return o(this,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}])&&a(t.prototype,i),e}()},function(e,t){},function(e,t,i){var r=i(43),n=r.Buffer;function a(e,t){for(var i in e)t[i]=e[i]}function s(e,t,i){return n(e,t,i)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=r:(a(r,t),t.Buffer=s),a(n,s),s.from=function(e,t,i){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,i)},s.alloc=function(e,t,i){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=n(e);return void 0!==t?"string"==typeof i?r.fill(t,i):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,i){"use strict";(function(t){var r;function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var a=i(146),s=Symbol("lastResolve"),o=Symbol("lastReject"),l=Symbol("error"),d=Symbol("ended"),h=Symbol("lastPromise"),c=Symbol("handlePromise"),u=Symbol("stream");function f(e,t){return{value:e,done:t}}function m(e){var t=e[s];if(null!==t){var i=e[u].read();null!==i&&(e[h]=null,e[s]=null,e[o]=null,t(f(i,!1)))}}function p(e){t.nextTick(m,e)}var g=Object.getPrototypeOf((function(){})),_=Object.setPrototypeOf((n(r={get stream(){return this[u]},next:function(){var e=this,i=this[l];if(null!==i)return Promise.reject(i);if(this[d])return Promise.resolve(f(void 0,!0));if(this[u].destroyed)return new Promise((function(i,r){t.nextTick((function(){e[l]?r(e[l]):i(f(void 0,!0))}))}));var r,n=this[h];if(n)r=new Promise(function(e,t){return function(i,r){e.then((function(){t[d]?i(f(void 0,!0)):t[c](i,r)}),r)}}(n,this));else{var a=this[u].read();if(null!==a)return Promise.resolve(f(a,!1));r=new Promise(this[c])}return this[h]=r,r}},Symbol.asyncIterator,(function(){return this})),n(r,"return",(function(){var e=this;return new Promise((function(t,i){e[u].destroy(null,(function(e){e?i(e):t(f(void 0,!0))}))}))})),r),g);e.exports=function(e){var t,i=Object.create(_,(n(t={},u,{value:e,writable:!0}),n(t,s,{value:null,writable:!0}),n(t,o,{value:null,writable:!0}),n(t,l,{value:null,writable:!0}),n(t,d,{value:e._readableState.endEmitted,writable:!0}),n(t,c,{value:function(e,t){var r=i[u].read();r?(i[h]=null,i[s]=null,i[o]=null,e(f(r,!1))):(i[s]=e,i[o]=t)},writable:!0}),t));return i[h]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=i[o];return null!==t&&(i[h]=null,i[s]=null,i[o]=null,t(e)),void(i[l]=e)}var r=i[s];null!==r&&(i[h]=null,i[s]=null,i[o]=null,r(f(void 0,!0))),i[d]=!0})),e.on("readable",p.bind(null,i)),i}}).call(this,i(48))},function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},function(e,t,i){"use strict";e.exports=n;var r=i(183);function n(e){if(!(this instanceof n))return new n(e);r.call(this,e)}i(26)(n,r),n.prototype._transform=function(e,t,i){i(null,e)}},function(e,t,i){"use strict";var r,n=i(104).codes,a=n.ERR_MISSING_ARGS,s=n.ERR_STREAM_DESTROYED;function o(e){if(e)throw e}function l(e,t,n,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(a);var o=!1;e.on("close",(function(){o=!0})),void 0===r&&(r=i(146)),r(e,{readable:t,writable:n},(function(e){if(e)return a(e);o=!0,a()}));var l=!1;return function(t){if(!o&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void a(t||new s("pipe"))}}function d(e){e()}function h(e,t){return e.pipe(t)}function c(e){return e.length?"function"!=typeof e[e.length-1]?o:e.pop():o}e.exports=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var r,n=c(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var s=t.map((function(e,i){var a=i<t.length-1;return l(e,a,i>0,(function(e){r||(r=e),e&&s.forEach(d),a||(s.forEach(d),n(r))}))}));return t.reduce(h)}},function(e,t,i){var r=i(26),n=i(106),a=i(29).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function l(){this.init(),this._w=o,n.call(this,64,56)}function d(e){return e<<30|e>>>2}function h(e,t,i,r){return 0===e?t&i|~t&r:2===e?t&i|t&r|i&r:t^i^r}r(l,n),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,i=this._w,r=0|this._a,n=0|this._b,a=0|this._c,o=0|this._d,l=0|this._e,c=0;c<16;++c)i[c]=e.readInt32BE(4*c);for(;c<80;++c)i[c]=i[c-3]^i[c-8]^i[c-14]^i[c-16];for(var u=0;u<80;++u){var f=~~(u/20),m=0|((t=r)<<5|t>>>27)+h(f,n,a,o)+l+i[u]+s[f];l=o,o=a,a=d(n),n=r,r=m}this._a=r+this._a|0,this._b=n+this._b|0,this._c=a+this._c|0,this._d=o+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=a.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},function(e,t,i){var r=i(26),n=i(106),a=i(29).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function l(){this.init(),this._w=o,n.call(this,64,56)}function d(e){return e<<5|e>>>27}function h(e){return e<<30|e>>>2}function c(e,t,i,r){return 0===e?t&i|~t&r:2===e?t&i|t&r|i&r:t^i^r}r(l,n),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,i=this._w,r=0|this._a,n=0|this._b,a=0|this._c,o=0|this._d,l=0|this._e,u=0;u<16;++u)i[u]=e.readInt32BE(4*u);for(;u<80;++u)i[u]=(t=i[u-3]^i[u-8]^i[u-14]^i[u-16])<<1|t>>>31;for(var f=0;f<80;++f){var m=~~(f/20),p=d(r)+c(m,n,a,o)+l+i[f]+s[m]|0;l=o,o=a,a=h(n),n=r,r=p}this._a=r+this._a|0,this._b=n+this._b|0,this._c=a+this._c|0,this._d=o+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=a.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},function(e,t,i){var r=i(26),n=i(184),a=i(106),s=i(29).Buffer,o=new Array(64);function l(){this.init(),this._w=o,a.call(this,64,56)}r(l,n),l.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},l.prototype._hash=function(){var e=s.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=l},function(e,t,i){var r=i(26),n=i(185),a=i(106),s=i(29).Buffer,o=new Array(160);function l(){this.init(),this._w=o,a.call(this,128,112)}r(l,n),l.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},l.prototype._hash=function(){var e=s.allocUnsafe(48);function t(t,i,r){e.writeInt32BE(t,r),e.writeInt32BE(i,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},e.exports=l},function(e,t,i){e.exports=n;var r=i(31).EventEmitter;function n(){r.call(this)}i(26)(n,r),n.Readable=i(148),n.Writable=i(292),n.Duplex=i(293),n.Transform=i(294),n.PassThrough=i(295),n.Stream=n,n.prototype.pipe=function(e,t){var i=this;function n(t){e.writable&&!1===e.write(t)&&i.pause&&i.pause()}function a(){i.readable&&i.resume&&i.resume()}i.on("data",n),e.on("drain",a),e._isStdio||t&&!1===t.end||(i.on("end",o),i.on("close",l));var s=!1;function o(){s||(s=!0,e.end())}function l(){s||(s=!0,"function"==typeof e.destroy&&e.destroy())}function d(e){if(h(),0===r.listenerCount(this,"error"))throw e}function h(){i.removeListener("data",n),e.removeListener("drain",a),i.removeListener("end",o),i.removeListener("close",l),i.removeListener("error",d),e.removeListener("error",d),i.removeListener("end",h),i.removeListener("close",h),e.removeListener("close",h)}return i.on("error",d),e.on("error",d),i.on("end",h),i.on("close",h),e.on("close",h),e.emit("pipe",i),e}},function(e,t){},function(e,t,i){"use strict";var r=i(149).Buffer,n=i(290);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,i=""+t.data;t=t.next;)i+=e+t.data;return i},e.prototype.concat=function(e){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var t,i,n=r.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=n,i=s,a.data.copy(t,i),s+=a.data.length,a=a.next;return n},e}(),n&&n.inspect&&n.inspect.custom&&(e.exports.prototype[n.inspect.custom]=function(){var e=n.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,i){"use strict";e.exports=a;var r=i(189),n=Object.create(i(117));function a(e){if(!(this instanceof a))return new a(e);r.call(this,e)}n.inherits=i(26),n.inherits(a,r),a.prototype._transform=function(e,t,i){i(null,e)}},function(e,t,i){e.exports=i(150)},function(e,t,i){e.exports=i(97)},function(e,t,i){e.exports=i(148).Transform},function(e,t,i){e.exports=i(148).PassThrough},function(e,t,i){"use strict";var r=i(26),n=i(29).Buffer,a=i(90),s=n.alloc(128);function o(e,t){a.call(this,"digest"),"string"==typeof t&&(t=n.from(t)),this._alg=e,this._key=t,t.length>64?t=e(t):t.length<64&&(t=n.concat([t,s],64));for(var i=this._ipad=n.allocUnsafe(64),r=this._opad=n.allocUnsafe(64),o=0;o<64;o++)i[o]=54^t[o],r[o]=92^t[o];this._hash=[i]}r(o,a),o.prototype._update=function(e){this._hash.push(e)},o.prototype._final=function(){var e=this._alg(n.concat(this._hash));return this._alg(n.concat([this._opad,e]))},e.exports=o},function(e,t,i){e.exports=i(192)},function(e,t,i){(function(t,r){var n,a=i(29).Buffer,s=i(194),o=i(195),l=i(196),d=i(197),h=t.crypto&&t.crypto.subtle,c={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},u=[];function f(e,t,i,r,n){return h.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]).then((function(e){return h.deriveBits({name:"PBKDF2",salt:t,iterations:i,hash:{name:n}},e,r<<3)})).then((function(e){return a.from(e)}))}e.exports=function(e,i,m,p,g,_){"function"==typeof g&&(_=g,g=void 0);var v=c[(g=g||"sha1").toLowerCase()];if(!v||"function"!=typeof t.Promise)return r.nextTick((function(){var t;try{t=l(e,i,m,p,g)}catch(e){return _(e)}_(null,t)}));if(s(m,p),e=d(e,o,"Password"),i=d(i,o,"Salt"),"function"!=typeof _)throw new Error("No callback provided to pbkdf2");!function(e,t){e.then((function(e){r.nextTick((function(){t(null,e)}))}),(function(e){r.nextTick((function(){t(e)}))}))}(function(e){if(t.process&&!t.process.browser)return Promise.resolve(!1);if(!h||!h.importKey||!h.deriveBits)return Promise.resolve(!1);if(void 0!==u[e])return u[e];var i=f(n=n||a.alloc(8),n,10,128,e).then((function(){return!0})).catch((function(){return!1}));return u[e]=i,i}(v).then((function(t){return t?f(e,i,m,p,v):l(e,i,m,p,g)})),_)}}).call(this,i(55),i(48))},function(e,t,i){var r=i(300),n=i(152),a=i(153),s=i(313),o=i(129);function l(e,t,i){if(e=e.toLowerCase(),a[e])return n.createCipheriv(e,t,i);if(s[e])return new r({key:t,iv:i,mode:e});throw new TypeError("invalid suite type")}function d(e,t,i){if(e=e.toLowerCase(),a[e])return n.createDecipheriv(e,t,i);if(s[e])return new r({key:t,iv:i,mode:e,decrypt:!0});throw new TypeError("invalid suite type")}t.createCipher=t.Cipher=function(e,t){var i,r;if(e=e.toLowerCase(),a[e])i=a[e].key,r=a[e].iv;else{if(!s[e])throw new TypeError("invalid suite type");i=8*s[e].key,r=s[e].iv}var n=o(t,!1,i,r);return l(e,n.key,n.iv)},t.createCipheriv=t.Cipheriv=l,t.createDecipher=t.Decipher=function(e,t){var i,r;if(e=e.toLowerCase(),a[e])i=a[e].key,r=a[e].iv;else{if(!s[e])throw new TypeError("invalid suite type");i=8*s[e].key,r=s[e].iv}var n=o(t,!1,i,r);return d(e,n.key,n.iv)},t.createDecipheriv=t.Decipheriv=d,t.listCiphers=t.getCiphers=function(){return Object.keys(s).concat(n.getCiphers())}},function(e,t,i){var r=i(90),n=i(301),a=i(26),s=i(29).Buffer,o={"des-ede3-cbc":n.CBC.instantiate(n.EDE),"des-ede3":n.EDE,"des-ede-cbc":n.CBC.instantiate(n.EDE),"des-ede":n.EDE,"des-cbc":n.CBC.instantiate(n.DES),"des-ecb":n.DES};function l(e){r.call(this);var t,i=e.mode.toLowerCase(),n=o[i];t=e.decrypt?"decrypt":"encrypt";var a=e.key;s.isBuffer(a)||(a=s.from(a)),"des-ede"!==i&&"des-ede-cbc"!==i||(a=s.concat([a,a.slice(0,8)]));var l=e.iv;s.isBuffer(l)||(l=s.from(l)),this._des=n.create({key:a,iv:l,type:t})}o.des=o["des-cbc"],o.des3=o["des-ede3-cbc"],e.exports=l,a(l,r),l.prototype._update=function(e){return s.from(this._des.update(e))},l.prototype._final=function(){return s.from(this._des.final())}},function(e,t,i){"use strict";t.utils=i(198),t.Cipher=i(151),t.DES=i(199),t.CBC=i(302),t.EDE=i(303)},function(e,t,i){"use strict";var r=i(65),n=i(26),a={};function s(e){r.equal(e.length,8,"Invalid IV length"),this.iv=new Array(8);for(var t=0;t<this.iv.length;t++)this.iv[t]=e[t]}t.instantiate=function(e){function t(t){e.call(this,t),this._cbcInit()}n(t,e);for(var i=Object.keys(a),r=0;r<i.length;r++){var s=i[r];t.prototype[s]=a[s]}return t.create=function(e){return new t(e)},t},a._cbcInit=function(){var e=new s(this.options.iv);this._cbcState=e},a._update=function(e,t,i,r){var n=this._cbcState,a=this.constructor.super_.prototype,s=n.iv;if("encrypt"===this.type){for(var o=0;o<this.blockSize;o++)s[o]^=e[t+o];for(a._update.call(this,s,0,i,r),o=0;o<this.blockSize;o++)s[o]=i[r+o]}else{for(a._update.call(this,e,t,i,r),o=0;o<this.blockSize;o++)i[r+o]^=s[o];for(o=0;o<this.blockSize;o++)s[o]=e[t+o]}}},function(e,t,i){"use strict";var r=i(65),n=i(26),a=i(151),s=i(199);function o(e,t){r.equal(t.length,24,"Invalid key length");var i=t.slice(0,8),n=t.slice(8,16),a=t.slice(16,24);this.ciphers="encrypt"===e?[s.create({type:"encrypt",key:i}),s.create({type:"decrypt",key:n}),s.create({type:"encrypt",key:a})]:[s.create({type:"decrypt",key:a}),s.create({type:"encrypt",key:n}),s.create({type:"decrypt",key:i})]}function l(e){a.call(this,e);var t=new o(this.type,this.options.key);this._edeState=t}n(l,a),e.exports=l,l.create=function(e){return new l(e)},l.prototype._update=function(e,t,i,r){var n=this._edeState;n.ciphers[0]._update(e,t,i,r),n.ciphers[1]._update(i,r,i,r),n.ciphers[2]._update(i,r,i,r)},l.prototype._pad=s.prototype._pad,l.prototype._unpad=s.prototype._unpad},function(e,t,i){var r=i(153),n=i(203),a=i(29).Buffer,s=i(204),o=i(90),l=i(128),d=i(129);function h(e,t,i){o.call(this),this._cache=new u,this._cipher=new l.AES(t),this._prev=a.from(i),this._mode=e,this._autopadding=!0}i(26)(h,o),h.prototype._update=function(e){var t,i;this._cache.add(e);for(var r=[];t=this._cache.get();)i=this._mode.encrypt(this,t),r.push(i);return a.concat(r)};var c=a.alloc(16,16);function u(){this.cache=a.allocUnsafe(0)}function f(e,t,i){var o=r[e.toLowerCase()];if(!o)throw new TypeError("invalid suite type");if("string"==typeof t&&(t=a.from(t)),t.length!==o.key/8)throw new TypeError("invalid key length "+t.length);if("string"==typeof i&&(i=a.from(i)),"GCM"!==o.mode&&i.length!==o.iv)throw new TypeError("invalid iv length "+i.length);return"stream"===o.type?new s(o.module,t,i):"auth"===o.type?new n(o.module,t,i):new h(o.module,t,i)}h.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return e=this._mode.encrypt(this,e),this._cipher.scrub(),e;if(!e.equals(c))throw this._cipher.scrub(),new Error("data not multiple of block length")},h.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},u.prototype.add=function(e){this.cache=a.concat([this.cache,e])},u.prototype.get=function(){if(this.cache.length>15){var e=this.cache.slice(0,16);return this.cache=this.cache.slice(16),e}return null},u.prototype.flush=function(){for(var e=16-this.cache.length,t=a.allocUnsafe(e),i=-1;++i<e;)t.writeUInt8(e,i);return a.concat([this.cache,t])},t.createCipheriv=f,t.createCipher=function(e,t){var i=r[e.toLowerCase()];if(!i)throw new TypeError("invalid suite type");var n=d(t,!1,i.key,i.iv);return f(e,n.key,n.iv)}},function(e,t){t.encrypt=function(e,t){return e._cipher.encryptBlock(t)},t.decrypt=function(e,t){return e._cipher.decryptBlock(t)}},function(e,t,i){var r=i(118);t.encrypt=function(e,t){var i=r(t,e._prev);return e._prev=e._cipher.encryptBlock(i),e._prev},t.decrypt=function(e,t){var i=e._prev;e._prev=t;var n=e._cipher.decryptBlock(t);return r(n,i)}},function(e,t,i){var r=i(29).Buffer,n=i(118);function a(e,t,i){var a=t.length,s=n(t,e._cache);return e._cache=e._cache.slice(a),e._prev=r.concat([e._prev,i?t:s]),s}t.encrypt=function(e,t,i){for(var n,s=r.allocUnsafe(0);t.length;){if(0===e._cache.length&&(e._cache=e._cipher.encryptBlock(e._prev),e._prev=r.allocUnsafe(0)),!(e._cache.length<=t.length)){s=r.concat([s,a(e,t,i)]);break}n=e._cache.length,s=r.concat([s,a(e,t.slice(0,n),i)]),t=t.slice(n)}return s}},function(e,t,i){var r=i(29).Buffer;function n(e,t,i){var n=e._cipher.encryptBlock(e._prev)[0]^t;return e._prev=r.concat([e._prev.slice(1),r.from([i?t:n])]),n}t.encrypt=function(e,t,i){for(var a=t.length,s=r.allocUnsafe(a),o=-1;++o<a;)s[o]=n(e,t[o],i);return s}},function(e,t,i){var r=i(29).Buffer;function n(e,t,i){for(var r,n,s=-1,o=0;++s<8;)r=t&1<<7-s?128:0,o+=(128&(n=e._cipher.encryptBlock(e._prev)[0]^r))>>s%8,e._prev=a(e._prev,i?r:n);return o}function a(e,t){var i=e.length,n=-1,a=r.allocUnsafe(e.length);for(e=r.concat([e,r.from([t])]);++n<i;)a[n]=e[n]<<1|e[n+1]>>7;return a}t.encrypt=function(e,t,i){for(var a=t.length,s=r.allocUnsafe(a),o=-1;++o<a;)s[o]=n(e,t[o],i);return s}},function(e,t,i){(function(e){var r=i(118);function n(e){return e._prev=e._cipher.encryptBlock(e._prev),e._prev}t.encrypt=function(t,i){for(;t._cache.length<i.length;)t._cache=e.concat([t._cache,n(t)]);var a=t._cache.slice(0,i.length);return t._cache=t._cache.slice(i.length),r(i,a)}}).call(this,i(43).Buffer)},function(e,t,i){var r=i(29).Buffer,n=r.alloc(16,0);function a(e){var t=r.allocUnsafe(16);return t.writeUInt32BE(e[0]>>>0,0),t.writeUInt32BE(e[1]>>>0,4),t.writeUInt32BE(e[2]>>>0,8),t.writeUInt32BE(e[3]>>>0,12),t}function s(e){this.h=e,this.state=r.alloc(16,0),this.cache=r.allocUnsafe(0)}s.prototype.ghash=function(e){for(var t=-1;++t<e.length;)this.state[t]^=e[t];this._multiply()},s.prototype._multiply=function(){for(var e,t,i,r=[(e=this.h).readUInt32BE(0),e.readUInt32BE(4),e.readUInt32BE(8),e.readUInt32BE(12)],n=[0,0,0,0],s=-1;++s<128;){for(0!=(this.state[~~(s/8)]&1<<7-s%8)&&(n[0]^=r[0],n[1]^=r[1],n[2]^=r[2],n[3]^=r[3]),i=0!=(1&r[3]),t=3;t>0;t--)r[t]=r[t]>>>1|(1&r[t-1])<<31;r[0]=r[0]>>>1,i&&(r[0]=r[0]^225<<24)}this.state=a(n)},s.prototype.update=function(e){var t;for(this.cache=r.concat([this.cache,e]);this.cache.length>=16;)t=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(t)},s.prototype.final=function(e,t){return this.cache.length&&this.ghash(r.concat([this.cache,n],16)),this.ghash(a([0,e,0,t])),this.state},e.exports=s},function(e,t,i){var r=i(203),n=i(29).Buffer,a=i(153),s=i(204),o=i(90),l=i(128),d=i(129);function h(e,t,i){o.call(this),this._cache=new c,this._last=void 0,this._cipher=new l.AES(t),this._prev=n.from(i),this._mode=e,this._autopadding=!0}function c(){this.cache=n.allocUnsafe(0)}function u(e,t,i){var o=a[e.toLowerCase()];if(!o)throw new TypeError("invalid suite type");if("string"==typeof i&&(i=n.from(i)),"GCM"!==o.mode&&i.length!==o.iv)throw new TypeError("invalid iv length "+i.length);if("string"==typeof t&&(t=n.from(t)),t.length!==o.key/8)throw new TypeError("invalid key length "+t.length);return"stream"===o.type?new s(o.module,t,i,!0):"auth"===o.type?new r(o.module,t,i,!0):new h(o.module,t,i)}i(26)(h,o),h.prototype._update=function(e){var t,i;this._cache.add(e);for(var r=[];t=this._cache.get(this._autopadding);)i=this._mode.decrypt(this,t),r.push(i);return n.concat(r)},h.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return function(e){var t=e[15];if(t<1||t>16)throw new Error("unable to decrypt data");for(var i=-1;++i<t;)if(e[i+(16-t)]!==t)throw new Error("unable to decrypt data");if(16!==t)return e.slice(0,16-t)}(this._mode.decrypt(this,e));if(e)throw new Error("data not multiple of block length")},h.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},c.prototype.add=function(e){this.cache=n.concat([this.cache,e])},c.prototype.get=function(e){var t;if(e){if(this.cache.length>16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t}else if(this.cache.length>=16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t;return null},c.prototype.flush=function(){if(this.cache.length)return this.cache},t.createDecipher=function(e,t){var i=a[e.toLowerCase()];if(!i)throw new TypeError("invalid suite type");var r=d(t,!1,i.key,i.iv);return u(e,r.key,r.iv)},t.createDecipheriv=u},function(e,t){t["des-ecb"]={key:8,iv:0},t["des-cbc"]=t.des={key:8,iv:8},t["des-ede3-cbc"]=t.des3={key:24,iv:8},t["des-ede3"]={key:24,iv:0},t["des-ede-cbc"]={key:16,iv:8},t["des-ede"]={key:16,iv:0}},function(e,t,i){(function(e){var r=i(205),n=i(319),a=i(320),s={binary:!0,hex:!0,base64:!0};t.DiffieHellmanGroup=t.createDiffieHellmanGroup=t.getDiffieHellman=function(t){var i=new e(n[t].prime,"hex"),r=new e(n[t].gen,"hex");return new a(i,r)},t.createDiffieHellman=t.DiffieHellman=function t(i,n,o,l){return e.isBuffer(n)||void 0===s[n]?t(i,"binary",n,o):(n=n||"binary",l=l||"binary",o=o||new e([2]),e.isBuffer(o)||(o=new e(o,l)),"number"==typeof i?new a(r(i,o),o,!0):(e.isBuffer(i)||(i=new e(i,n)),new a(i,o,!0)))}}).call(this,i(43).Buffer)},function(e,t){},function(e,t,i){(function(e){!function(e,t){"use strict";function r(e,t){if(!e)throw new Error(t||"Assertion failed")}function n(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function a(e,t,i){if(a.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(i=t,t=10),this._init(e||0,t||10,i||"be"))}var s;"object"==typeof e?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;try{s=i(317).Buffer}catch(e){}function o(e,t,i){for(var r=0,n=Math.min(e.length,i),a=t;a<n;a++){var s=e.charCodeAt(a)-48;r<<=4,r|=s>=49&&s<=54?s-49+10:s>=17&&s<=22?s-17+10:15&s}return r}function l(e,t,i,r){for(var n=0,a=Math.min(e.length,i),s=t;s<a;s++){var o=e.charCodeAt(s)-48;n*=r,n+=o>=49?o-49+10:o>=17?o-17+10:o}return n}a.isBN=function(e){return e instanceof a||null!==e&&"object"==typeof e&&e.constructor.wordSize===a.wordSize&&Array.isArray(e.words)},a.max=function(e,t){return e.cmp(t)>0?e:t},a.min=function(e,t){return e.cmp(t)<0?e:t},a.prototype._init=function(e,t,i){if("number"==typeof e)return this._initNumber(e,t,i);if("object"==typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36);var n=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&n++,16===t?this._parseHex(e,n):this._parseBase(e,t,n),"-"===e[0]&&(this.negative=1),this.strip(),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(r(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initArray=function(e,t,i){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var a,s,o=0;if("be"===i)for(n=e.length-1,a=0;n>=0;n-=3)s=e[n]|e[n-1]<<8|e[n-2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);else if("le"===i)for(n=0,a=0;n<e.length;n+=3)s=e[n]|e[n+1]<<8|e[n+2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);return this.strip()},a.prototype._parseHex=function(e,t){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var r,n,a=0;for(i=e.length-6,r=0;i>=t;i-=6)n=o(e,i,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303,(a+=24)>=26&&(a-=26,r++);i+6!==t&&(n=o(e,t,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303),this.strip()},a.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var r=0,n=1;n<=67108863;n*=t)r++;r--,n=n/t|0;for(var a=e.length-i,s=a%r,o=Math.min(a,a-s)+i,d=0,h=i;h<o;h+=r)d=l(e,h,h+r,t),this.imuln(n),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d);if(0!==s){var c=1;for(d=l(e,h,e.length,t),h=0;h<s;h++)c*=t;this.imuln(c),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d)}},a.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},a.prototype.clone=function(){var e=new a(null);return this.copy(e),e},a.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},a.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],c=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function u(e,t,i){i.negative=t.negative^e.negative;var r=e.length+t.length|0;i.length=r,r=r-1|0;var n=0|e.words[0],a=0|t.words[0],s=n*a,o=67108863&s,l=s/67108864|0;i.words[0]=o;for(var d=1;d<r;d++){for(var h=l>>>26,c=67108863&l,u=Math.min(d,t.length-1),f=Math.max(0,d-e.length+1);f<=u;f++){var m=d-f|0;h+=(s=(n=0|e.words[m])*(a=0|t.words[f])+c)/67108864|0,c=67108863&s}i.words[d]=0|c,l=0|h}return 0!==l?i.words[d]=0|l:i.length--,i.strip()}a.prototype.toString=function(e,t){var i;if(t=0|t||1,16===(e=e||10)||"hex"===e){i="";for(var n=0,a=0,s=0;s<this.length;s++){var o=this.words[s],l=(16777215&(o<<n|a)).toString(16);i=0!=(a=o>>>24-n&16777215)||s!==this.length-1?d[6-l.length]+l+i:l+i,(n+=2)>=26&&(n-=26,s--)}for(0!==a&&(i=a.toString(16)+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var u=h[e],f=c[e];i="";var m=this.clone();for(m.negative=0;!m.isZero();){var p=m.modn(f).toString(e);i=(m=m.idivn(f)).isZero()?p+i:d[u-p.length]+p+i}for(this.isZero()&&(i="0"+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(e,t){return r(void 0!==s),this.toArrayLike(s,e,t)},a.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},a.prototype.toArrayLike=function(e,t,i){var n=this.byteLength(),a=i||Math.max(1,n);r(n<=a,"byte array longer than desired length"),r(a>0,"Requested array length <= 0"),this.strip();var s,o,l="le"===t,d=new e(a),h=this.clone();if(l){for(o=0;!h.isZero();o++)s=h.andln(255),h.iushrn(8),d[o]=s;for(;o<a;o++)d[o]=0}else{for(o=0;o<a-n;o++)d[o]=0;for(o=0;!h.isZero();o++)s=h.andln(255),h.iushrn(8),d[a-o-1]=s}return d},Math.clz32?a.prototype._countBits=function(e){return 32-Math.clz32(e)}:a.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},a.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return 0==(8191&t)&&(i+=13,t>>>=13),0==(127&t)&&(i+=7,t>>>=7),0==(15&t)&&(i+=4,t>>>=4),0==(3&t)&&(i+=2,t>>>=2),0==(1&t)&&i++,i},a.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},a.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return 0!==this.negative},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},a.prototype.ior=function(e){return r(0==(this.negative|e.negative)),this.iuor(e)},a.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},a.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},a.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this.strip()},a.prototype.iand=function(e){return r(0==(this.negative|e.negative)),this.iuand(e)},a.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},a.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},a.prototype.iuxor=function(e){var t,i;this.length>e.length?(t=this,i=e):(t=e,i=this);for(var r=0;r<i.length;r++)this.words[r]=t.words[r]^i.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this.strip()},a.prototype.ixor=function(e){return r(0==(this.negative|e.negative)),this.iuxor(e)},a.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},a.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},a.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var n=0;n<t;n++)this.words[n]=67108863&~this.words[n];return i>0&&(this.words[n]=~this.words[n]&67108863>>26-i),this.strip()},a.prototype.notn=function(e){return this.clone().inotn(e)},a.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var i=e/26|0,n=e%26;return this._expand(i+1),this.words[i]=t?this.words[i]|1<<n:this.words[i]&~(1<<n),this.strip()},a.prototype.iadd=function(e){var t,i,r;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,r=e):(i=e,r=this);for(var n=0,a=0;a<r.length;a++)t=(0|i.words[a])+(0|r.words[a])+n,this.words[a]=67108863&t,n=t>>>26;for(;0!==n&&a<i.length;a++)t=(0|i.words[a])+n,this.words[a]=67108863&t,n=t>>>26;if(this.length=i.length,0!==n)this.words[this.length]=n,this.length++;else if(i!==this)for(;a<i.length;a++)this.words[a]=i.words[a];return this},a.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},a.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var i,r,n=this.cmp(e);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(i=this,r=e):(i=e,r=this);for(var a=0,s=0;s<r.length;s++)a=(t=(0|i.words[s])-(0|r.words[s])+a)>>26,this.words[s]=67108863&t;for(;0!==a&&s<i.length;s++)a=(t=(0|i.words[s])+a)>>26,this.words[s]=67108863&t;if(0===a&&s<i.length&&i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this.length=Math.max(this.length,s),i!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(e){return this.clone().isub(e)};var f=function(e,t,i){var r,n,a,s=e.words,o=t.words,l=i.words,d=0,h=0|s[0],c=8191&h,u=h>>>13,f=0|s[1],m=8191&f,p=f>>>13,g=0|s[2],_=8191&g,v=g>>>13,y=0|s[3],b=8191&y,S=y>>>13,T=0|s[4],w=8191&T,M=T>>>13,C=0|s[5],I=8191&C,P=C>>>13,E=0|s[6],x=8191&E,A=E>>>13,k=0|s[7],R=8191&k,O=k>>>13,L=0|s[8],F=8191&L,D=L>>>13,B=0|s[9],N=8191&B,V=B>>>13,U=0|o[0],W=8191&U,z=U>>>13,G=0|o[1],j=8191&G,H=G>>>13,q=0|o[2],$=8191&q,Z=q>>>13,X=0|o[3],Y=8191&X,J=X>>>13,K=0|o[4],Q=8191&K,ee=K>>>13,te=0|o[5],ie=8191&te,re=te>>>13,ne=0|o[6],ae=8191&ne,se=ne>>>13,oe=0|o[7],le=8191&oe,de=oe>>>13,he=0|o[8],ce=8191&he,ue=he>>>13,fe=0|o[9],me=8191&fe,pe=fe>>>13;i.negative=e.negative^t.negative,i.length=19;var ge=(d+(r=Math.imul(c,W))|0)+((8191&(n=(n=Math.imul(c,z))+Math.imul(u,W)|0))<<13)|0;d=((a=Math.imul(u,z))+(n>>>13)|0)+(ge>>>26)|0,ge&=67108863,r=Math.imul(m,W),n=(n=Math.imul(m,z))+Math.imul(p,W)|0,a=Math.imul(p,z);var _e=(d+(r=r+Math.imul(c,j)|0)|0)+((8191&(n=(n=n+Math.imul(c,H)|0)+Math.imul(u,j)|0))<<13)|0;d=((a=a+Math.imul(u,H)|0)+(n>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(_,W),n=(n=Math.imul(_,z))+Math.imul(v,W)|0,a=Math.imul(v,z),r=r+Math.imul(m,j)|0,n=(n=n+Math.imul(m,H)|0)+Math.imul(p,j)|0,a=a+Math.imul(p,H)|0;var ve=(d+(r=r+Math.imul(c,$)|0)|0)+((8191&(n=(n=n+Math.imul(c,Z)|0)+Math.imul(u,$)|0))<<13)|0;d=((a=a+Math.imul(u,Z)|0)+(n>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(b,W),n=(n=Math.imul(b,z))+Math.imul(S,W)|0,a=Math.imul(S,z),r=r+Math.imul(_,j)|0,n=(n=n+Math.imul(_,H)|0)+Math.imul(v,j)|0,a=a+Math.imul(v,H)|0,r=r+Math.imul(m,$)|0,n=(n=n+Math.imul(m,Z)|0)+Math.imul(p,$)|0,a=a+Math.imul(p,Z)|0;var ye=(d+(r=r+Math.imul(c,Y)|0)|0)+((8191&(n=(n=n+Math.imul(c,J)|0)+Math.imul(u,Y)|0))<<13)|0;d=((a=a+Math.imul(u,J)|0)+(n>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(w,W),n=(n=Math.imul(w,z))+Math.imul(M,W)|0,a=Math.imul(M,z),r=r+Math.imul(b,j)|0,n=(n=n+Math.imul(b,H)|0)+Math.imul(S,j)|0,a=a+Math.imul(S,H)|0,r=r+Math.imul(_,$)|0,n=(n=n+Math.imul(_,Z)|0)+Math.imul(v,$)|0,a=a+Math.imul(v,Z)|0,r=r+Math.imul(m,Y)|0,n=(n=n+Math.imul(m,J)|0)+Math.imul(p,Y)|0,a=a+Math.imul(p,J)|0;var be=(d+(r=r+Math.imul(c,Q)|0)|0)+((8191&(n=(n=n+Math.imul(c,ee)|0)+Math.imul(u,Q)|0))<<13)|0;d=((a=a+Math.imul(u,ee)|0)+(n>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(I,W),n=(n=Math.imul(I,z))+Math.imul(P,W)|0,a=Math.imul(P,z),r=r+Math.imul(w,j)|0,n=(n=n+Math.imul(w,H)|0)+Math.imul(M,j)|0,a=a+Math.imul(M,H)|0,r=r+Math.imul(b,$)|0,n=(n=n+Math.imul(b,Z)|0)+Math.imul(S,$)|0,a=a+Math.imul(S,Z)|0,r=r+Math.imul(_,Y)|0,n=(n=n+Math.imul(_,J)|0)+Math.imul(v,Y)|0,a=a+Math.imul(v,J)|0,r=r+Math.imul(m,Q)|0,n=(n=n+Math.imul(m,ee)|0)+Math.imul(p,Q)|0,a=a+Math.imul(p,ee)|0;var Se=(d+(r=r+Math.imul(c,ie)|0)|0)+((8191&(n=(n=n+Math.imul(c,re)|0)+Math.imul(u,ie)|0))<<13)|0;d=((a=a+Math.imul(u,re)|0)+(n>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul(x,W),n=(n=Math.imul(x,z))+Math.imul(A,W)|0,a=Math.imul(A,z),r=r+Math.imul(I,j)|0,n=(n=n+Math.imul(I,H)|0)+Math.imul(P,j)|0,a=a+Math.imul(P,H)|0,r=r+Math.imul(w,$)|0,n=(n=n+Math.imul(w,Z)|0)+Math.imul(M,$)|0,a=a+Math.imul(M,Z)|0,r=r+Math.imul(b,Y)|0,n=(n=n+Math.imul(b,J)|0)+Math.imul(S,Y)|0,a=a+Math.imul(S,J)|0,r=r+Math.imul(_,Q)|0,n=(n=n+Math.imul(_,ee)|0)+Math.imul(v,Q)|0,a=a+Math.imul(v,ee)|0,r=r+Math.imul(m,ie)|0,n=(n=n+Math.imul(m,re)|0)+Math.imul(p,ie)|0,a=a+Math.imul(p,re)|0;var Te=(d+(r=r+Math.imul(c,ae)|0)|0)+((8191&(n=(n=n+Math.imul(c,se)|0)+Math.imul(u,ae)|0))<<13)|0;d=((a=a+Math.imul(u,se)|0)+(n>>>13)|0)+(Te>>>26)|0,Te&=67108863,r=Math.imul(R,W),n=(n=Math.imul(R,z))+Math.imul(O,W)|0,a=Math.imul(O,z),r=r+Math.imul(x,j)|0,n=(n=n+Math.imul(x,H)|0)+Math.imul(A,j)|0,a=a+Math.imul(A,H)|0,r=r+Math.imul(I,$)|0,n=(n=n+Math.imul(I,Z)|0)+Math.imul(P,$)|0,a=a+Math.imul(P,Z)|0,r=r+Math.imul(w,Y)|0,n=(n=n+Math.imul(w,J)|0)+Math.imul(M,Y)|0,a=a+Math.imul(M,J)|0,r=r+Math.imul(b,Q)|0,n=(n=n+Math.imul(b,ee)|0)+Math.imul(S,Q)|0,a=a+Math.imul(S,ee)|0,r=r+Math.imul(_,ie)|0,n=(n=n+Math.imul(_,re)|0)+Math.imul(v,ie)|0,a=a+Math.imul(v,re)|0,r=r+Math.imul(m,ae)|0,n=(n=n+Math.imul(m,se)|0)+Math.imul(p,ae)|0,a=a+Math.imul(p,se)|0;var we=(d+(r=r+Math.imul(c,le)|0)|0)+((8191&(n=(n=n+Math.imul(c,de)|0)+Math.imul(u,le)|0))<<13)|0;d=((a=a+Math.imul(u,de)|0)+(n>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(F,W),n=(n=Math.imul(F,z))+Math.imul(D,W)|0,a=Math.imul(D,z),r=r+Math.imul(R,j)|0,n=(n=n+Math.imul(R,H)|0)+Math.imul(O,j)|0,a=a+Math.imul(O,H)|0,r=r+Math.imul(x,$)|0,n=(n=n+Math.imul(x,Z)|0)+Math.imul(A,$)|0,a=a+Math.imul(A,Z)|0,r=r+Math.imul(I,Y)|0,n=(n=n+Math.imul(I,J)|0)+Math.imul(P,Y)|0,a=a+Math.imul(P,J)|0,r=r+Math.imul(w,Q)|0,n=(n=n+Math.imul(w,ee)|0)+Math.imul(M,Q)|0,a=a+Math.imul(M,ee)|0,r=r+Math.imul(b,ie)|0,n=(n=n+Math.imul(b,re)|0)+Math.imul(S,ie)|0,a=a+Math.imul(S,re)|0,r=r+Math.imul(_,ae)|0,n=(n=n+Math.imul(_,se)|0)+Math.imul(v,ae)|0,a=a+Math.imul(v,se)|0,r=r+Math.imul(m,le)|0,n=(n=n+Math.imul(m,de)|0)+Math.imul(p,le)|0,a=a+Math.imul(p,de)|0;var Me=(d+(r=r+Math.imul(c,ce)|0)|0)+((8191&(n=(n=n+Math.imul(c,ue)|0)+Math.imul(u,ce)|0))<<13)|0;d=((a=a+Math.imul(u,ue)|0)+(n>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul(N,W),n=(n=Math.imul(N,z))+Math.imul(V,W)|0,a=Math.imul(V,z),r=r+Math.imul(F,j)|0,n=(n=n+Math.imul(F,H)|0)+Math.imul(D,j)|0,a=a+Math.imul(D,H)|0,r=r+Math.imul(R,$)|0,n=(n=n+Math.imul(R,Z)|0)+Math.imul(O,$)|0,a=a+Math.imul(O,Z)|0,r=r+Math.imul(x,Y)|0,n=(n=n+Math.imul(x,J)|0)+Math.imul(A,Y)|0,a=a+Math.imul(A,J)|0,r=r+Math.imul(I,Q)|0,n=(n=n+Math.imul(I,ee)|0)+Math.imul(P,Q)|0,a=a+Math.imul(P,ee)|0,r=r+Math.imul(w,ie)|0,n=(n=n+Math.imul(w,re)|0)+Math.imul(M,ie)|0,a=a+Math.imul(M,re)|0,r=r+Math.imul(b,ae)|0,n=(n=n+Math.imul(b,se)|0)+Math.imul(S,ae)|0,a=a+Math.imul(S,se)|0,r=r+Math.imul(_,le)|0,n=(n=n+Math.imul(_,de)|0)+Math.imul(v,le)|0,a=a+Math.imul(v,de)|0,r=r+Math.imul(m,ce)|0,n=(n=n+Math.imul(m,ue)|0)+Math.imul(p,ce)|0,a=a+Math.imul(p,ue)|0;var Ce=(d+(r=r+Math.imul(c,me)|0)|0)+((8191&(n=(n=n+Math.imul(c,pe)|0)+Math.imul(u,me)|0))<<13)|0;d=((a=a+Math.imul(u,pe)|0)+(n>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,r=Math.imul(N,j),n=(n=Math.imul(N,H))+Math.imul(V,j)|0,a=Math.imul(V,H),r=r+Math.imul(F,$)|0,n=(n=n+Math.imul(F,Z)|0)+Math.imul(D,$)|0,a=a+Math.imul(D,Z)|0,r=r+Math.imul(R,Y)|0,n=(n=n+Math.imul(R,J)|0)+Math.imul(O,Y)|0,a=a+Math.imul(O,J)|0,r=r+Math.imul(x,Q)|0,n=(n=n+Math.imul(x,ee)|0)+Math.imul(A,Q)|0,a=a+Math.imul(A,ee)|0,r=r+Math.imul(I,ie)|0,n=(n=n+Math.imul(I,re)|0)+Math.imul(P,ie)|0,a=a+Math.imul(P,re)|0,r=r+Math.imul(w,ae)|0,n=(n=n+Math.imul(w,se)|0)+Math.imul(M,ae)|0,a=a+Math.imul(M,se)|0,r=r+Math.imul(b,le)|0,n=(n=n+Math.imul(b,de)|0)+Math.imul(S,le)|0,a=a+Math.imul(S,de)|0,r=r+Math.imul(_,ce)|0,n=(n=n+Math.imul(_,ue)|0)+Math.imul(v,ce)|0,a=a+Math.imul(v,ue)|0;var Ie=(d+(r=r+Math.imul(m,me)|0)|0)+((8191&(n=(n=n+Math.imul(m,pe)|0)+Math.imul(p,me)|0))<<13)|0;d=((a=a+Math.imul(p,pe)|0)+(n>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,r=Math.imul(N,$),n=(n=Math.imul(N,Z))+Math.imul(V,$)|0,a=Math.imul(V,Z),r=r+Math.imul(F,Y)|0,n=(n=n+Math.imul(F,J)|0)+Math.imul(D,Y)|0,a=a+Math.imul(D,J)|0,r=r+Math.imul(R,Q)|0,n=(n=n+Math.imul(R,ee)|0)+Math.imul(O,Q)|0,a=a+Math.imul(O,ee)|0,r=r+Math.imul(x,ie)|0,n=(n=n+Math.imul(x,re)|0)+Math.imul(A,ie)|0,a=a+Math.imul(A,re)|0,r=r+Math.imul(I,ae)|0,n=(n=n+Math.imul(I,se)|0)+Math.imul(P,ae)|0,a=a+Math.imul(P,se)|0,r=r+Math.imul(w,le)|0,n=(n=n+Math.imul(w,de)|0)+Math.imul(M,le)|0,a=a+Math.imul(M,de)|0,r=r+Math.imul(b,ce)|0,n=(n=n+Math.imul(b,ue)|0)+Math.imul(S,ce)|0,a=a+Math.imul(S,ue)|0;var Pe=(d+(r=r+Math.imul(_,me)|0)|0)+((8191&(n=(n=n+Math.imul(_,pe)|0)+Math.imul(v,me)|0))<<13)|0;d=((a=a+Math.imul(v,pe)|0)+(n>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,r=Math.imul(N,Y),n=(n=Math.imul(N,J))+Math.imul(V,Y)|0,a=Math.imul(V,J),r=r+Math.imul(F,Q)|0,n=(n=n+Math.imul(F,ee)|0)+Math.imul(D,Q)|0,a=a+Math.imul(D,ee)|0,r=r+Math.imul(R,ie)|0,n=(n=n+Math.imul(R,re)|0)+Math.imul(O,ie)|0,a=a+Math.imul(O,re)|0,r=r+Math.imul(x,ae)|0,n=(n=n+Math.imul(x,se)|0)+Math.imul(A,ae)|0,a=a+Math.imul(A,se)|0,r=r+Math.imul(I,le)|0,n=(n=n+Math.imul(I,de)|0)+Math.imul(P,le)|0,a=a+Math.imul(P,de)|0,r=r+Math.imul(w,ce)|0,n=(n=n+Math.imul(w,ue)|0)+Math.imul(M,ce)|0,a=a+Math.imul(M,ue)|0;var Ee=(d+(r=r+Math.imul(b,me)|0)|0)+((8191&(n=(n=n+Math.imul(b,pe)|0)+Math.imul(S,me)|0))<<13)|0;d=((a=a+Math.imul(S,pe)|0)+(n>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(N,Q),n=(n=Math.imul(N,ee))+Math.imul(V,Q)|0,a=Math.imul(V,ee),r=r+Math.imul(F,ie)|0,n=(n=n+Math.imul(F,re)|0)+Math.imul(D,ie)|0,a=a+Math.imul(D,re)|0,r=r+Math.imul(R,ae)|0,n=(n=n+Math.imul(R,se)|0)+Math.imul(O,ae)|0,a=a+Math.imul(O,se)|0,r=r+Math.imul(x,le)|0,n=(n=n+Math.imul(x,de)|0)+Math.imul(A,le)|0,a=a+Math.imul(A,de)|0,r=r+Math.imul(I,ce)|0,n=(n=n+Math.imul(I,ue)|0)+Math.imul(P,ce)|0,a=a+Math.imul(P,ue)|0;var xe=(d+(r=r+Math.imul(w,me)|0)|0)+((8191&(n=(n=n+Math.imul(w,pe)|0)+Math.imul(M,me)|0))<<13)|0;d=((a=a+Math.imul(M,pe)|0)+(n>>>13)|0)+(xe>>>26)|0,xe&=67108863,r=Math.imul(N,ie),n=(n=Math.imul(N,re))+Math.imul(V,ie)|0,a=Math.imul(V,re),r=r+Math.imul(F,ae)|0,n=(n=n+Math.imul(F,se)|0)+Math.imul(D,ae)|0,a=a+Math.imul(D,se)|0,r=r+Math.imul(R,le)|0,n=(n=n+Math.imul(R,de)|0)+Math.imul(O,le)|0,a=a+Math.imul(O,de)|0,r=r+Math.imul(x,ce)|0,n=(n=n+Math.imul(x,ue)|0)+Math.imul(A,ce)|0,a=a+Math.imul(A,ue)|0;var Ae=(d+(r=r+Math.imul(I,me)|0)|0)+((8191&(n=(n=n+Math.imul(I,pe)|0)+Math.imul(P,me)|0))<<13)|0;d=((a=a+Math.imul(P,pe)|0)+(n>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,r=Math.imul(N,ae),n=(n=Math.imul(N,se))+Math.imul(V,ae)|0,a=Math.imul(V,se),r=r+Math.imul(F,le)|0,n=(n=n+Math.imul(F,de)|0)+Math.imul(D,le)|0,a=a+Math.imul(D,de)|0,r=r+Math.imul(R,ce)|0,n=(n=n+Math.imul(R,ue)|0)+Math.imul(O,ce)|0,a=a+Math.imul(O,ue)|0;var ke=(d+(r=r+Math.imul(x,me)|0)|0)+((8191&(n=(n=n+Math.imul(x,pe)|0)+Math.imul(A,me)|0))<<13)|0;d=((a=a+Math.imul(A,pe)|0)+(n>>>13)|0)+(ke>>>26)|0,ke&=67108863,r=Math.imul(N,le),n=(n=Math.imul(N,de))+Math.imul(V,le)|0,a=Math.imul(V,de),r=r+Math.imul(F,ce)|0,n=(n=n+Math.imul(F,ue)|0)+Math.imul(D,ce)|0,a=a+Math.imul(D,ue)|0;var Re=(d+(r=r+Math.imul(R,me)|0)|0)+((8191&(n=(n=n+Math.imul(R,pe)|0)+Math.imul(O,me)|0))<<13)|0;d=((a=a+Math.imul(O,pe)|0)+(n>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul(N,ce),n=(n=Math.imul(N,ue))+Math.imul(V,ce)|0,a=Math.imul(V,ue);var Oe=(d+(r=r+Math.imul(F,me)|0)|0)+((8191&(n=(n=n+Math.imul(F,pe)|0)+Math.imul(D,me)|0))<<13)|0;d=((a=a+Math.imul(D,pe)|0)+(n>>>13)|0)+(Oe>>>26)|0,Oe&=67108863;var Le=(d+(r=Math.imul(N,me))|0)+((8191&(n=(n=Math.imul(N,pe))+Math.imul(V,me)|0))<<13)|0;return d=((a=Math.imul(V,pe))+(n>>>13)|0)+(Le>>>26)|0,Le&=67108863,l[0]=ge,l[1]=_e,l[2]=ve,l[3]=ye,l[4]=be,l[5]=Se,l[6]=Te,l[7]=we,l[8]=Me,l[9]=Ce,l[10]=Ie,l[11]=Pe,l[12]=Ee,l[13]=xe,l[14]=Ae,l[15]=ke,l[16]=Re,l[17]=Oe,l[18]=Le,0!==d&&(l[19]=d,i.length++),i};function m(e,t,i){return(new p).mulp(e,t,i)}function p(e,t){this.x=e,this.y=t}Math.imul||(f=u),a.prototype.mulTo=function(e,t){var i=this.length+e.length;return 10===this.length&&10===e.length?f(this,e,t):i<63?u(this,e,t):i<1024?function(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var r=0,n=0,a=0;a<i.length-1;a++){var s=n;n=0;for(var o=67108863&r,l=Math.min(a,t.length-1),d=Math.max(0,a-e.length+1);d<=l;d++){var h=a-d,c=(0|e.words[h])*(0|t.words[d]),u=67108863&c;o=67108863&(u=u+o|0),n+=(s=(s=s+(c/67108864|0)|0)+(u>>>26)|0)>>>26,s&=67108863}i.words[a]=o,r=s,s=n}return 0!==r?i.words[a]=r:i.length--,i.strip()}(this,e,t):m(this,e,t)},p.prototype.makeRBT=function(e){for(var t=new Array(e),i=a.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,i,e);return t},p.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var r=0,n=0;n<t;n++)r|=(1&e)<<t-n-1,e>>=1;return r},p.prototype.permute=function(e,t,i,r,n,a){for(var s=0;s<a;s++)r[s]=t[e[s]],n[s]=i[e[s]]},p.prototype.transform=function(e,t,i,r,n,a){this.permute(a,e,t,i,r,n);for(var s=1;s<n;s<<=1)for(var o=s<<1,l=Math.cos(2*Math.PI/o),d=Math.sin(2*Math.PI/o),h=0;h<n;h+=o)for(var c=l,u=d,f=0;f<s;f++){var m=i[h+f],p=r[h+f],g=i[h+f+s],_=r[h+f+s],v=c*g-u*_;_=c*_+u*g,g=v,i[h+f]=m+g,r[h+f]=p+_,i[h+f+s]=m-g,r[h+f+s]=p-_,f!==o&&(v=l*c-d*u,u=l*u+d*c,c=v)}},p.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),r=1&i,n=0;for(i=i/2|0;i;i>>>=1)n++;return 1<<n+1+r},p.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var r=0;r<i/2;r++){var n=e[r];e[r]=e[i-r-1],e[i-r-1]=n,n=t[r],t[r]=-t[i-r-1],t[i-r-1]=-n}},p.prototype.normalize13b=function(e,t){for(var i=0,r=0;r<t/2;r++){var n=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+i;e[r]=67108863&n,i=n<67108864?0:n/67108864|0}return e},p.prototype.convert13b=function(e,t,i,n){for(var a=0,s=0;s<t;s++)a+=0|e[s],i[2*s]=8191&a,a>>>=13,i[2*s+1]=8191&a,a>>>=13;for(s=2*t;s<n;++s)i[s]=0;r(0===a),r(0==(-8192&a))},p.prototype.stub=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0;return t},p.prototype.mulp=function(e,t,i){var r=2*this.guessLen13b(e.length,t.length),n=this.makeRBT(r),a=this.stub(r),s=new Array(r),o=new Array(r),l=new Array(r),d=new Array(r),h=new Array(r),c=new Array(r),u=i.words;u.length=r,this.convert13b(e.words,e.length,s,r),this.convert13b(t.words,t.length,d,r),this.transform(s,a,o,l,r,n),this.transform(d,a,h,c,r,n);for(var f=0;f<r;f++){var m=o[f]*h[f]-l[f]*c[f];l[f]=o[f]*c[f]+l[f]*h[f],o[f]=m}return this.conjugate(o,l,r),this.transform(o,l,u,a,r,n),this.conjugate(u,a,r),this.normalize13b(u,r),i.negative=e.negative^t.negative,i.length=e.length+t.length,i.strip()},a.prototype.mul=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},a.prototype.mulf=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),m(this,e,t)},a.prototype.imul=function(e){return this.clone().mulTo(e,this)},a.prototype.imuln=function(e){r("number"==typeof e),r(e<67108864);for(var t=0,i=0;i<this.length;i++){var n=(0|this.words[i])*e,a=(67108863&n)+(67108863&t);t>>=26,t+=n/67108864|0,t+=a>>>26,this.words[i]=67108863&a}return 0!==t&&(this.words[i]=t,this.length++),this},a.prototype.muln=function(e){return this.clone().imuln(e)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),i=0;i<t.length;i++){var r=i/26|0,n=i%26;t[i]=(e.words[r]&1<<n)>>>n}return t}(e);if(0===t.length)return new a(1);for(var i=this,r=0;r<t.length&&0===t[r];r++,i=i.sqr());if(++r<t.length)for(var n=i.sqr();r<t.length;r++,n=n.sqr())0!==t[r]&&(i=i.mul(n));return i},a.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,i=e%26,n=(e-i)/26,a=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(t=0;t<this.length;t++){var o=this.words[t]&a,l=(0|this.words[t])-o<<i;this.words[t]=l|s,s=o>>>26-i}s&&(this.words[t]=s,this.length++)}if(0!==n){for(t=this.length-1;t>=0;t--)this.words[t+n]=this.words[t];for(t=0;t<n;t++)this.words[t]=0;this.length+=n}return this.strip()},a.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},a.prototype.iushrn=function(e,t,i){var n;r("number"==typeof e&&e>=0),n=t?(t-t%26)/26:0;var a=e%26,s=Math.min((e-a)/26,this.length),o=67108863^67108863>>>a<<a,l=i;if(n-=s,n=Math.max(0,n),l){for(var d=0;d<s;d++)l.words[d]=this.words[d];l.length=s}if(0===s);else if(this.length>s)for(this.length-=s,d=0;d<this.length;d++)this.words[d]=this.words[d+s];else this.words[0]=0,this.length=1;var h=0;for(d=this.length-1;d>=0&&(0!==h||d>=n);d--){var c=0|this.words[d];this.words[d]=h<<26-a|c>>>a,h=c&o}return l&&0!==h&&(l.words[l.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(e,t,i){return r(0===this.negative),this.iushrn(e,t,i)},a.prototype.shln=function(e){return this.clone().ishln(e)},a.prototype.ushln=function(e){return this.clone().iushln(e)},a.prototype.shrn=function(e){return this.clone().ishrn(e)},a.prototype.ushrn=function(e){return this.clone().iushrn(e)},a.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26,n=1<<t;return!(this.length<=i||!(this.words[i]&n))},a.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==t&&i++,this.length=Math.min(i,this.length),0!==t){var n=67108863^67108863>>>t<<t;this.words[this.length-1]&=n}return this.strip()},a.prototype.maskn=function(e){return this.clone().imaskn(e)},a.prototype.iaddn=function(e){return r("number"==typeof e),r(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},a.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},a.prototype.isubn=function(e){if(r("number"==typeof e),r(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},a.prototype.addn=function(e){return this.clone().iaddn(e)},a.prototype.subn=function(e){return this.clone().isubn(e)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(e,t,i){var n,a,s=e.length+i;this._expand(s);var o=0;for(n=0;n<e.length;n++){a=(0|this.words[n+i])+o;var l=(0|e.words[n])*t;o=((a-=67108863&l)>>26)-(l/67108864|0),this.words[n+i]=67108863&a}for(;n<this.length-i;n++)o=(a=(0|this.words[n+i])+o)>>26,this.words[n+i]=67108863&a;if(0===o)return this.strip();for(r(-1===o),o=0,n=0;n<this.length;n++)o=(a=-(0|this.words[n])+o)>>26,this.words[n]=67108863&a;return this.negative=1,this.strip()},a.prototype._wordDiv=function(e,t){var i=(this.length,e.length),r=this.clone(),n=e,s=0|n.words[n.length-1];0!=(i=26-this._countBits(s))&&(n=n.ushln(i),r.iushln(i),s=0|n.words[n.length-1]);var o,l=r.length-n.length;if("mod"!==t){(o=new a(null)).length=l+1,o.words=new Array(o.length);for(var d=0;d<o.length;d++)o.words[d]=0}var h=r.clone()._ishlnsubmul(n,1,l);0===h.negative&&(r=h,o&&(o.words[l]=1));for(var c=l-1;c>=0;c--){var u=67108864*(0|r.words[n.length+c])+(0|r.words[n.length+c-1]);for(u=Math.min(u/s|0,67108863),r._ishlnsubmul(n,u,c);0!==r.negative;)u--,r.negative=0,r._ishlnsubmul(n,1,c),r.isZero()||(r.negative^=1);o&&(o.words[c]=u)}return o&&o.strip(),r.strip(),"div"!==t&&0!==i&&r.iushrn(i),{div:o||null,mod:r}},a.prototype.divmod=function(e,t,i){return r(!e.isZero()),this.isZero()?{div:new a(0),mod:new a(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(n=o.div.neg()),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.iadd(e)),{div:n,mod:s}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(n=o.div.neg()),{div:n,mod:o.mod}):0!=(this.negative&e.negative)?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.isub(e)),{div:o.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new a(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new a(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new a(this.modn(e.words[0]))}:this._wordDiv(e,t);var n,s,o},a.prototype.div=function(e){return this.divmod(e,"div",!1).div},a.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},a.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},a.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),n=e.andln(1),a=i.cmp(r);return a<0||1===n&&0===a?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},a.prototype.modn=function(e){r(e<=67108863);for(var t=(1<<26)%e,i=0,n=this.length-1;n>=0;n--)i=(t*i+(0|this.words[n]))%e;return i},a.prototype.idivn=function(e){r(e<=67108863);for(var t=0,i=this.length-1;i>=0;i--){var n=(0|this.words[i])+67108864*t;this.words[i]=n/e|0,t=n%e}return this.strip()},a.prototype.divn=function(e){return this.clone().idivn(e)},a.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n=new a(1),s=new a(0),o=new a(0),l=new a(1),d=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++d;for(var h=i.clone(),c=t.clone();!t.isZero();){for(var u=0,f=1;0==(t.words[0]&f)&&u<26;++u,f<<=1);if(u>0)for(t.iushrn(u);u-- >0;)(n.isOdd()||s.isOdd())&&(n.iadd(h),s.isub(c)),n.iushrn(1),s.iushrn(1);for(var m=0,p=1;0==(i.words[0]&p)&&m<26;++m,p<<=1);if(m>0)for(i.iushrn(m);m-- >0;)(o.isOdd()||l.isOdd())&&(o.iadd(h),l.isub(c)),o.iushrn(1),l.iushrn(1);t.cmp(i)>=0?(t.isub(i),n.isub(o),s.isub(l)):(i.isub(t),o.isub(n),l.isub(s))}return{a:o,b:l,gcd:i.iushln(d)}},a.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n,s=new a(1),o=new a(0),l=i.clone();t.cmpn(1)>0&&i.cmpn(1)>0;){for(var d=0,h=1;0==(t.words[0]&h)&&d<26;++d,h<<=1);if(d>0)for(t.iushrn(d);d-- >0;)s.isOdd()&&s.iadd(l),s.iushrn(1);for(var c=0,u=1;0==(i.words[0]&u)&&c<26;++c,u<<=1);if(c>0)for(i.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(l),o.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(o)):(i.isub(t),o.isub(s))}return(n=0===t.cmpn(1)?s:o).cmpn(0)<0&&n.iadd(e),n},a.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var r=0;t.isEven()&&i.isEven();r++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var n=t.cmp(i);if(n<0){var a=t;t=i,i=a}else if(0===n||0===i.cmpn(1))break;t.isub(i)}return i.iushln(r)},a.prototype.invm=function(e){return this.egcd(e).a.umod(e)},a.prototype.isEven=function(){return 0==(1&this.words[0])},a.prototype.isOdd=function(){return 1==(1&this.words[0])},a.prototype.andln=function(e){return this.words[0]&e},a.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,i=(e-t)/26,n=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=n,this;for(var a=n,s=i;0!==a&&s<this.length;s++){var o=0|this.words[s];a=(o+=a)>>>26,o&=67108863,this.words[s]=o}return 0!==a&&(this.words[s]=a,this.length++),this},a.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},a.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)t=1;else{i&&(e=-e),r(e<=67108863,"Number is too big");var n=0|this.words[0];t=n===e?0:n<e?-1:1}return 0!==this.negative?0|-t:t},a.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},a.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,i=this.length-1;i>=0;i--){var r=0|this.words[i],n=0|e.words[i];if(r!==n){r<n?t=-1:r>n&&(t=1);break}}return t},a.prototype.gtn=function(e){return 1===this.cmpn(e)},a.prototype.gt=function(e){return 1===this.cmp(e)},a.prototype.gten=function(e){return this.cmpn(e)>=0},a.prototype.gte=function(e){return this.cmp(e)>=0},a.prototype.ltn=function(e){return-1===this.cmpn(e)},a.prototype.lt=function(e){return-1===this.cmp(e)},a.prototype.lten=function(e){return this.cmpn(e)<=0},a.prototype.lte=function(e){return this.cmp(e)<=0},a.prototype.eqn=function(e){return 0===this.cmpn(e)},a.prototype.eq=function(e){return 0===this.cmp(e)},a.red=function(e){return new T(e)},a.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},a.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(e){return this.red=e,this},a.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},a.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},a.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},a.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},a.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},a.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},a.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},a.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},a.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function _(e,t){this.name=e,this.p=new a(t,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function y(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function b(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function S(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function T(e){if("string"==typeof e){var t=a._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function w(e){T.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var e=new a(null);return e.words=new Array(Math.ceil(this.n/13)),e},_.prototype.ireduce=function(e){var t,i=e;do{this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(t>this.n);var r=t<this.n?-1:i.ucmp(this.p);return 0===r?(i.words[0]=0,i.length=1):r>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},_.prototype.split=function(e,t){e.iushrn(this.n,0,t)},_.prototype.imulK=function(e){return e.imul(this.k)},n(v,_),v.prototype.split=function(e,t){for(var i=Math.min(e.length,9),r=0;r<i;r++)t.words[r]=e.words[r];if(t.length=i,e.length<=9)return e.words[0]=0,void(e.length=1);var n=e.words[9];for(t.words[t.length++]=4194303&n,r=10;r<e.length;r++){var a=0|e.words[r];e.words[r-10]=(4194303&a)<<4|n>>>22,n=a}n>>>=22,e.words[r-10]=n,0===n&&e.length>10?e.length-=10:e.length-=9},v.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var r=0|e.words[i];t+=977*r,e.words[i]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},n(y,_),n(b,_),n(S,_),S.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var r=19*(0|e.words[i])+t,n=67108863&r;r>>>=26,e.words[i]=n,t=r}return 0!==t&&(e.words[e.length++]=t),e},a._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new v;else if("p224"===e)t=new y;else if("p192"===e)t=new b;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new S}return g[e]=t,t},T.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},T.prototype._verify2=function(e,t){r(0==(e.negative|t.negative),"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},T.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},T.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},T.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},T.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},T.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},T.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i},T.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},T.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},T.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},T.prototype.isqr=function(e){return this.imul(e,e.clone())},T.prototype.sqr=function(e){return this.mul(e,e)},T.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var i=this.m.add(new a(1)).iushrn(2);return this.pow(e,i)}for(var n=this.m.subn(1),s=0;!n.isZero()&&0===n.andln(1);)s++,n.iushrn(1);r(!n.isZero());var o=new a(1).toRed(this),l=o.redNeg(),d=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new a(2*h*h).toRed(this);0!==this.pow(h,d).cmp(l);)h.redIAdd(l);for(var c=this.pow(h,n),u=this.pow(e,n.addn(1).iushrn(1)),f=this.pow(e,n),m=s;0!==f.cmp(o);){for(var p=f,g=0;0!==p.cmp(o);g++)p=p.redSqr();r(g<m);var _=this.pow(c,new a(1).iushln(m-g-1));u=u.redMul(_),c=_.redSqr(),f=f.redMul(c),m=g}return u},T.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},T.prototype.pow=function(e,t){if(t.isZero())return new a(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=new Array(16);i[0]=new a(1).toRed(this),i[1]=e;for(var r=2;r<i.length;r++)i[r]=this.mul(i[r-1],e);var n=i[0],s=0,o=0,l=t.bitLength()%26;for(0===l&&(l=26),r=t.length-1;r>=0;r--){for(var d=t.words[r],h=l-1;h>=0;h--){var c=d>>h&1;n!==i[0]&&(n=this.sqr(n)),0!==c||0!==s?(s<<=1,s|=c,(4==++o||0===r&&0===h)&&(n=this.mul(n,i[s]),o=0,s=0)):o=0}l=26}return n},T.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},T.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},a.mont=function(e){return new w(e)},n(w,T),w.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},w.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},w.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),a=n;return n.cmp(this.m)>=0?a=n.isub(this.m):n.cmpn(0)<0&&(a=n.iadd(this.m)),a._forceRed(this)},w.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new a(0)._forceRed(this);var i=e.mul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},w.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,i(83)(e))},function(e,t){},function(e,t){},function(e){e.exports=JSON.parse('{"modp1":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},"modp2":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},"modp5":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},"modp14":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},"modp15":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},"modp16":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},"modp17":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},"modp18":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}')},function(e,t,i){(function(t){var r=i(206),n=new(i(207)),a=new r(24),s=new r(11),o=new r(10),l=new r(3),d=new r(7),h=i(205),c=i(103);function u(e,i){return i=i||"utf8",t.isBuffer(e)||(e=new t(e,i)),this._pub=new r(e),this}function f(e,i){return i=i||"utf8",t.isBuffer(e)||(e=new t(e,i)),this._priv=new r(e),this}e.exports=p;var m={};function p(e,t,i){this.setGenerator(t),this.__prime=new r(e),this._prime=r.mont(this.__prime),this._primeLen=e.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,i?(this.setPublicKey=u,this.setPrivateKey=f):this._primeCode=8}function g(e,i){var r=new t(e.toArray());return i?r.toString(i):r}Object.defineProperty(p.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=function(e,t){var i=t.toString("hex"),r=[i,e.toString(16)].join("_");if(r in m)return m[r];var c,u=0;if(e.isEven()||!h.simpleSieve||!h.fermatTest(e)||!n.test(e))return u+=1,u+="02"===i||"05"===i?8:4,m[r]=u,u;switch(n.test(e.shrn(1))||(u+=2),i){case"02":e.mod(a).cmp(s)&&(u+=8);break;case"05":(c=e.mod(o)).cmp(l)&&c.cmp(d)&&(u+=8);break;default:u+=4}return m[r]=u,u}(this.__prime,this.__gen)),this._primeCode}}),p.prototype.generateKeys=function(){return this._priv||(this._priv=new r(c(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},p.prototype.computeSecret=function(e){var i=(e=(e=new r(e)).toRed(this._prime)).redPow(this._priv).fromRed(),n=new t(i.toArray()),a=this.getPrime();if(n.length<a.length){var s=new t(a.length-n.length);s.fill(0),n=t.concat([s,n])}return n},p.prototype.getPublicKey=function(e){return g(this._pub,e)},p.prototype.getPrivateKey=function(e){return g(this._priv,e)},p.prototype.getPrime=function(e){return g(this.__prime,e)},p.prototype.getGenerator=function(e){return g(this._gen,e)},p.prototype.setGenerator=function(e,i){return i=i||"utf8",t.isBuffer(e)||(e=new t(e,i)),this.__gen=e,this._gen=new r(e),this}}).call(this,i(43).Buffer)},function(e,t,i){var r=i(29).Buffer,n=i(116),a=i(322),s=i(26),o=i(330),l=i(368),d=i(192);function h(e){a.Writable.call(this);var t=d[e];if(!t)throw new Error("Unknown message digest");this._hashType=t.hash,this._hash=n(t.hash),this._tag=t.id,this._signType=t.sign}function c(e){a.Writable.call(this);var t=d[e];if(!t)throw new Error("Unknown message digest");this._hash=n(t.hash),this._tag=t.id,this._signType=t.sign}function u(e){return new h(e)}function f(e){return new c(e)}Object.keys(d).forEach((function(e){d[e].id=r.from(d[e].id,"hex"),d[e.toLowerCase()]=d[e]})),s(h,a.Writable),h.prototype._write=function(e,t,i){this._hash.update(e),i()},h.prototype.update=function(e,t){return"string"==typeof e&&(e=r.from(e,t)),this._hash.update(e),this},h.prototype.sign=function(e,t){this.end();var i=this._hash.digest(),r=o(i,e,this._hashType,this._signType,this._tag);return t?r.toString(t):r},s(c,a.Writable),c.prototype._write=function(e,t,i){this._hash.update(e),i()},c.prototype.update=function(e,t){return"string"==typeof e&&(e=r.from(e,t)),this._hash.update(e),this},c.prototype.verify=function(e,t,i){"string"==typeof t&&(t=r.from(t,i)),this.end();var n=this._hash.digest();return l(t,n,e,this._signType,this._tag)},e.exports={Sign:u,Verify:f,createSign:u,createVerify:f}},function(e,t,i){(t=e.exports=i(208)).Stream=t,t.Readable=t,t.Writable=i(212),t.Duplex=i(108),t.Transform=i(213),t.PassThrough=i(328),t.finished=i(155),t.pipeline=i(329)},function(e,t){},function(e,t,i){"use strict";function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=i(43).Buffer,o=i(325).inspect,l=o&&o.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,i;return t=e,(i=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,i=""+t.data;t=t.next;)i+=e+t.data;return i}},{key:"concat",value:function(e){if(0===this.length)return s.alloc(0);for(var t,i,r,n=s.allocUnsafe(e>>>0),a=this.head,o=0;a;)t=a.data,i=n,r=o,s.prototype.copy.call(t,i,r),o+=a.data.length,a=a.next;return n}},{key:"consume",value:function(e,t){var i;return e<this.head.data.length?(i=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):i=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,i=1,r=t.data;for(e-=r.length;t=t.next;){var n=t.data,a=e>n.length?n.length:e;if(a===n.length?r+=n:r+=n.slice(0,e),0==(e-=a)){a===n.length?(++i,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=n.slice(a));break}++i}return this.length-=i,r}},{key:"_getBuffer",value:function(e){var t=s.allocUnsafe(e),i=this.head,r=1;for(i.data.copy(t),e-=i.data.length;i=i.next;){var n=i.data,a=e>n.length?n.length:e;if(n.copy(t,t.length-e,0,a),0==(e-=a)){a===n.length?(++r,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=n.slice(a));break}++r}return this.length-=r,t}},{key:l,value:function(e,t){return o(this,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}])&&a(t.prototype,i),e}()},function(e,t){},function(e,t,i){"use strict";(function(t){var r;function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var a=i(155),s=Symbol("lastResolve"),o=Symbol("lastReject"),l=Symbol("error"),d=Symbol("ended"),h=Symbol("lastPromise"),c=Symbol("handlePromise"),u=Symbol("stream");function f(e,t){return{value:e,done:t}}function m(e){var t=e[s];if(null!==t){var i=e[u].read();null!==i&&(e[h]=null,e[s]=null,e[o]=null,t(f(i,!1)))}}function p(e){t.nextTick(m,e)}var g=Object.getPrototypeOf((function(){})),_=Object.setPrototypeOf((n(r={get stream(){return this[u]},next:function(){var e=this,i=this[l];if(null!==i)return Promise.reject(i);if(this[d])return Promise.resolve(f(void 0,!0));if(this[u].destroyed)return new Promise((function(i,r){t.nextTick((function(){e[l]?r(e[l]):i(f(void 0,!0))}))}));var r,n=this[h];if(n)r=new Promise(function(e,t){return function(i,r){e.then((function(){t[d]?i(f(void 0,!0)):t[c](i,r)}),r)}}(n,this));else{var a=this[u].read();if(null!==a)return Promise.resolve(f(a,!1));r=new Promise(this[c])}return this[h]=r,r}},Symbol.asyncIterator,(function(){return this})),n(r,"return",(function(){var e=this;return new Promise((function(t,i){e[u].destroy(null,(function(e){e?i(e):t(f(void 0,!0))}))}))})),r),g);e.exports=function(e){var t,i=Object.create(_,(n(t={},u,{value:e,writable:!0}),n(t,s,{value:null,writable:!0}),n(t,o,{value:null,writable:!0}),n(t,l,{value:null,writable:!0}),n(t,d,{value:e._readableState.endEmitted,writable:!0}),n(t,c,{value:function(e,t){var r=i[u].read();r?(i[h]=null,i[s]=null,i[o]=null,e(f(r,!1))):(i[s]=e,i[o]=t)},writable:!0}),t));return i[h]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=i[o];return null!==t&&(i[h]=null,i[s]=null,i[o]=null,t(e)),void(i[l]=e)}var r=i[s];null!==r&&(i[h]=null,i[s]=null,i[o]=null,r(f(void 0,!0))),i[d]=!0})),e.on("readable",p.bind(null,i)),i}}).call(this,i(48))},function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},function(e,t,i){"use strict";e.exports=n;var r=i(213);function n(e){if(!(this instanceof n))return new n(e);r.call(this,e)}i(26)(n,r),n.prototype._transform=function(e,t,i){i(null,e)}},function(e,t,i){"use strict";var r,n=i(107).codes,a=n.ERR_MISSING_ARGS,s=n.ERR_STREAM_DESTROYED;function o(e){if(e)throw e}function l(e,t,n,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(a);var o=!1;e.on("close",(function(){o=!0})),void 0===r&&(r=i(155)),r(e,{readable:t,writable:n},(function(e){if(e)return a(e);o=!0,a()}));var l=!1;return function(t){if(!o&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void a(t||new s("pipe"))}}function d(e){e()}function h(e,t){return e.pipe(t)}function c(e){return e.length?"function"!=typeof e[e.length-1]?o:e.pop():o}e.exports=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var r,n=c(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var s=t.map((function(e,i){var a=i<t.length-1;return l(e,a,i>0,(function(e){r||(r=e),e&&s.forEach(d),a||(s.forEach(d),n(r))}))}));return t.reduce(h)}},function(e,t,i){var r=i(29).Buffer,n=i(190),a=i(156),s=i(157).ec,o=i(219),l=i(131),d=i(224);function h(e,t,i,a){if((e=r.from(e.toArray())).length<t.byteLength()){var s=r.alloc(t.byteLength()-e.length);e=r.concat([s,e])}var o=i.length,l=function(e,t){e=(e=c(e,t)).mod(t);var i=r.from(e.toArray());if(i.length<t.byteLength()){var n=r.alloc(t.byteLength()-i.length);i=r.concat([n,i])}return i}(i,t),d=r.alloc(o);d.fill(1);var h=r.alloc(o);return h=n(a,h).update(d).update(r.from([0])).update(e).update(l).digest(),d=n(a,h).update(d).digest(),{k:h=n(a,h).update(d).update(r.from([1])).update(e).update(l).digest(),v:d=n(a,h).update(d).digest()}}function c(e,t){var i=new o(e),r=(e.length<<3)-t.bitLength();return r>0&&i.ishrn(r),i}function u(e,t,i){var a,s;do{for(a=r.alloc(0);8*a.length<e.bitLength();)t.v=n(i,t.k).update(t.v).digest(),a=r.concat([a,t.v]);s=c(a,e),t.k=n(i,t.k).update(t.v).update(r.from([0])).digest(),t.v=n(i,t.k).update(t.v).digest()}while(-1!==s.cmp(e));return s}function f(e,t,i,r){return e.toRed(o.mont(i)).redPow(t).fromRed().mod(r)}e.exports=function(e,t,i,n,m){var p=l(t);if(p.curve){if("ecdsa"!==n&&"ecdsa/rsa"!==n)throw new Error("wrong private key type");return function(e,t){var i=d[t.curve.join(".")];if(!i)throw new Error("unknown curve "+t.curve.join("."));var n=new s(i).keyFromPrivate(t.privateKey).sign(e);return r.from(n.toDER())}(e,p)}if("dsa"===p.type){if("dsa"!==n)throw new Error("wrong private key type");return function(e,t,i){for(var n,a=t.params.priv_key,s=t.params.p,l=t.params.q,d=t.params.g,m=new o(0),p=c(e,l).mod(l),g=!1,_=h(a,l,e,i);!1===g;)m=f(d,n=u(l,_,i),s,l),0===(g=n.invm(l).imul(p.add(a.mul(m))).mod(l)).cmpn(0)&&(g=!1,m=new o(0));return function(e,t){e=e.toArray(),t=t.toArray(),128&e[0]&&(e=[0].concat(e)),128&t[0]&&(t=[0].concat(t));var i=[48,e.length+t.length+4,2,e.length];return i=i.concat(e,[2,t.length],t),r.from(i)}(m,g)}(e,p,i)}if("rsa"!==n&&"ecdsa/rsa"!==n)throw new Error("wrong private key type");e=r.concat([m,e]);for(var g=p.modulus.byteLength(),_=[0,1];e.length+_.length+1<g;)_.push(255);_.push(0);for(var v=-1;++v<e.length;)_.push(e[v]);return a(_,p)},e.exports.getKey=h,e.exports.makeKey=u},function(e,t,i){(function(e){!function(e,t){"use strict";function r(e,t){if(!e)throw new Error(t||"Assertion failed")}function n(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function a(e,t,i){if(a.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(i=t,t=10),this._init(e||0,t||10,i||"be"))}var s;"object"==typeof e?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;try{s=i(332).Buffer}catch(e){}function o(e,t,i){for(var r=0,n=Math.min(e.length,i),a=t;a<n;a++){var s=e.charCodeAt(a)-48;r<<=4,r|=s>=49&&s<=54?s-49+10:s>=17&&s<=22?s-17+10:15&s}return r}function l(e,t,i,r){for(var n=0,a=Math.min(e.length,i),s=t;s<a;s++){var o=e.charCodeAt(s)-48;n*=r,n+=o>=49?o-49+10:o>=17?o-17+10:o}return n}a.isBN=function(e){return e instanceof a||null!==e&&"object"==typeof e&&e.constructor.wordSize===a.wordSize&&Array.isArray(e.words)},a.max=function(e,t){return e.cmp(t)>0?e:t},a.min=function(e,t){return e.cmp(t)<0?e:t},a.prototype._init=function(e,t,i){if("number"==typeof e)return this._initNumber(e,t,i);if("object"==typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36);var n=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&n++,16===t?this._parseHex(e,n):this._parseBase(e,t,n),"-"===e[0]&&(this.negative=1),this.strip(),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(r(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initArray=function(e,t,i){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var a,s,o=0;if("be"===i)for(n=e.length-1,a=0;n>=0;n-=3)s=e[n]|e[n-1]<<8|e[n-2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);else if("le"===i)for(n=0,a=0;n<e.length;n+=3)s=e[n]|e[n+1]<<8|e[n+2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);return this.strip()},a.prototype._parseHex=function(e,t){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var r,n,a=0;for(i=e.length-6,r=0;i>=t;i-=6)n=o(e,i,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303,(a+=24)>=26&&(a-=26,r++);i+6!==t&&(n=o(e,t,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303),this.strip()},a.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var r=0,n=1;n<=67108863;n*=t)r++;r--,n=n/t|0;for(var a=e.length-i,s=a%r,o=Math.min(a,a-s)+i,d=0,h=i;h<o;h+=r)d=l(e,h,h+r,t),this.imuln(n),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d);if(0!==s){var c=1;for(d=l(e,h,e.length,t),h=0;h<s;h++)c*=t;this.imuln(c),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d)}},a.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},a.prototype.clone=function(){var e=new a(null);return this.copy(e),e},a.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},a.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],c=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function u(e,t,i){i.negative=t.negative^e.negative;var r=e.length+t.length|0;i.length=r,r=r-1|0;var n=0|e.words[0],a=0|t.words[0],s=n*a,o=67108863&s,l=s/67108864|0;i.words[0]=o;for(var d=1;d<r;d++){for(var h=l>>>26,c=67108863&l,u=Math.min(d,t.length-1),f=Math.max(0,d-e.length+1);f<=u;f++){var m=d-f|0;h+=(s=(n=0|e.words[m])*(a=0|t.words[f])+c)/67108864|0,c=67108863&s}i.words[d]=0|c,l=0|h}return 0!==l?i.words[d]=0|l:i.length--,i.strip()}a.prototype.toString=function(e,t){var i;if(t=0|t||1,16===(e=e||10)||"hex"===e){i="";for(var n=0,a=0,s=0;s<this.length;s++){var o=this.words[s],l=(16777215&(o<<n|a)).toString(16);i=0!=(a=o>>>24-n&16777215)||s!==this.length-1?d[6-l.length]+l+i:l+i,(n+=2)>=26&&(n-=26,s--)}for(0!==a&&(i=a.toString(16)+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var u=h[e],f=c[e];i="";var m=this.clone();for(m.negative=0;!m.isZero();){var p=m.modn(f).toString(e);i=(m=m.idivn(f)).isZero()?p+i:d[u-p.length]+p+i}for(this.isZero()&&(i="0"+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(e,t){return r(void 0!==s),this.toArrayLike(s,e,t)},a.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},a.prototype.toArrayLike=function(e,t,i){var n=this.byteLength(),a=i||Math.max(1,n);r(n<=a,"byte array longer than desired length"),r(a>0,"Requested array length <= 0"),this.strip();var s,o,l="le"===t,d=new e(a),h=this.clone();if(l){for(o=0;!h.isZero();o++)s=h.andln(255),h.iushrn(8),d[o]=s;for(;o<a;o++)d[o]=0}else{for(o=0;o<a-n;o++)d[o]=0;for(o=0;!h.isZero();o++)s=h.andln(255),h.iushrn(8),d[a-o-1]=s}return d},Math.clz32?a.prototype._countBits=function(e){return 32-Math.clz32(e)}:a.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},a.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return 0==(8191&t)&&(i+=13,t>>>=13),0==(127&t)&&(i+=7,t>>>=7),0==(15&t)&&(i+=4,t>>>=4),0==(3&t)&&(i+=2,t>>>=2),0==(1&t)&&i++,i},a.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},a.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return 0!==this.negative},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},a.prototype.ior=function(e){return r(0==(this.negative|e.negative)),this.iuor(e)},a.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},a.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},a.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this.strip()},a.prototype.iand=function(e){return r(0==(this.negative|e.negative)),this.iuand(e)},a.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},a.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},a.prototype.iuxor=function(e){var t,i;this.length>e.length?(t=this,i=e):(t=e,i=this);for(var r=0;r<i.length;r++)this.words[r]=t.words[r]^i.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this.strip()},a.prototype.ixor=function(e){return r(0==(this.negative|e.negative)),this.iuxor(e)},a.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},a.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},a.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var n=0;n<t;n++)this.words[n]=67108863&~this.words[n];return i>0&&(this.words[n]=~this.words[n]&67108863>>26-i),this.strip()},a.prototype.notn=function(e){return this.clone().inotn(e)},a.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var i=e/26|0,n=e%26;return this._expand(i+1),this.words[i]=t?this.words[i]|1<<n:this.words[i]&~(1<<n),this.strip()},a.prototype.iadd=function(e){var t,i,r;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,r=e):(i=e,r=this);for(var n=0,a=0;a<r.length;a++)t=(0|i.words[a])+(0|r.words[a])+n,this.words[a]=67108863&t,n=t>>>26;for(;0!==n&&a<i.length;a++)t=(0|i.words[a])+n,this.words[a]=67108863&t,n=t>>>26;if(this.length=i.length,0!==n)this.words[this.length]=n,this.length++;else if(i!==this)for(;a<i.length;a++)this.words[a]=i.words[a];return this},a.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},a.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var i,r,n=this.cmp(e);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(i=this,r=e):(i=e,r=this);for(var a=0,s=0;s<r.length;s++)a=(t=(0|i.words[s])-(0|r.words[s])+a)>>26,this.words[s]=67108863&t;for(;0!==a&&s<i.length;s++)a=(t=(0|i.words[s])+a)>>26,this.words[s]=67108863&t;if(0===a&&s<i.length&&i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this.length=Math.max(this.length,s),i!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(e){return this.clone().isub(e)};var f=function(e,t,i){var r,n,a,s=e.words,o=t.words,l=i.words,d=0,h=0|s[0],c=8191&h,u=h>>>13,f=0|s[1],m=8191&f,p=f>>>13,g=0|s[2],_=8191&g,v=g>>>13,y=0|s[3],b=8191&y,S=y>>>13,T=0|s[4],w=8191&T,M=T>>>13,C=0|s[5],I=8191&C,P=C>>>13,E=0|s[6],x=8191&E,A=E>>>13,k=0|s[7],R=8191&k,O=k>>>13,L=0|s[8],F=8191&L,D=L>>>13,B=0|s[9],N=8191&B,V=B>>>13,U=0|o[0],W=8191&U,z=U>>>13,G=0|o[1],j=8191&G,H=G>>>13,q=0|o[2],$=8191&q,Z=q>>>13,X=0|o[3],Y=8191&X,J=X>>>13,K=0|o[4],Q=8191&K,ee=K>>>13,te=0|o[5],ie=8191&te,re=te>>>13,ne=0|o[6],ae=8191&ne,se=ne>>>13,oe=0|o[7],le=8191&oe,de=oe>>>13,he=0|o[8],ce=8191&he,ue=he>>>13,fe=0|o[9],me=8191&fe,pe=fe>>>13;i.negative=e.negative^t.negative,i.length=19;var ge=(d+(r=Math.imul(c,W))|0)+((8191&(n=(n=Math.imul(c,z))+Math.imul(u,W)|0))<<13)|0;d=((a=Math.imul(u,z))+(n>>>13)|0)+(ge>>>26)|0,ge&=67108863,r=Math.imul(m,W),n=(n=Math.imul(m,z))+Math.imul(p,W)|0,a=Math.imul(p,z);var _e=(d+(r=r+Math.imul(c,j)|0)|0)+((8191&(n=(n=n+Math.imul(c,H)|0)+Math.imul(u,j)|0))<<13)|0;d=((a=a+Math.imul(u,H)|0)+(n>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(_,W),n=(n=Math.imul(_,z))+Math.imul(v,W)|0,a=Math.imul(v,z),r=r+Math.imul(m,j)|0,n=(n=n+Math.imul(m,H)|0)+Math.imul(p,j)|0,a=a+Math.imul(p,H)|0;var ve=(d+(r=r+Math.imul(c,$)|0)|0)+((8191&(n=(n=n+Math.imul(c,Z)|0)+Math.imul(u,$)|0))<<13)|0;d=((a=a+Math.imul(u,Z)|0)+(n>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(b,W),n=(n=Math.imul(b,z))+Math.imul(S,W)|0,a=Math.imul(S,z),r=r+Math.imul(_,j)|0,n=(n=n+Math.imul(_,H)|0)+Math.imul(v,j)|0,a=a+Math.imul(v,H)|0,r=r+Math.imul(m,$)|0,n=(n=n+Math.imul(m,Z)|0)+Math.imul(p,$)|0,a=a+Math.imul(p,Z)|0;var ye=(d+(r=r+Math.imul(c,Y)|0)|0)+((8191&(n=(n=n+Math.imul(c,J)|0)+Math.imul(u,Y)|0))<<13)|0;d=((a=a+Math.imul(u,J)|0)+(n>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(w,W),n=(n=Math.imul(w,z))+Math.imul(M,W)|0,a=Math.imul(M,z),r=r+Math.imul(b,j)|0,n=(n=n+Math.imul(b,H)|0)+Math.imul(S,j)|0,a=a+Math.imul(S,H)|0,r=r+Math.imul(_,$)|0,n=(n=n+Math.imul(_,Z)|0)+Math.imul(v,$)|0,a=a+Math.imul(v,Z)|0,r=r+Math.imul(m,Y)|0,n=(n=n+Math.imul(m,J)|0)+Math.imul(p,Y)|0,a=a+Math.imul(p,J)|0;var be=(d+(r=r+Math.imul(c,Q)|0)|0)+((8191&(n=(n=n+Math.imul(c,ee)|0)+Math.imul(u,Q)|0))<<13)|0;d=((a=a+Math.imul(u,ee)|0)+(n>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(I,W),n=(n=Math.imul(I,z))+Math.imul(P,W)|0,a=Math.imul(P,z),r=r+Math.imul(w,j)|0,n=(n=n+Math.imul(w,H)|0)+Math.imul(M,j)|0,a=a+Math.imul(M,H)|0,r=r+Math.imul(b,$)|0,n=(n=n+Math.imul(b,Z)|0)+Math.imul(S,$)|0,a=a+Math.imul(S,Z)|0,r=r+Math.imul(_,Y)|0,n=(n=n+Math.imul(_,J)|0)+Math.imul(v,Y)|0,a=a+Math.imul(v,J)|0,r=r+Math.imul(m,Q)|0,n=(n=n+Math.imul(m,ee)|0)+Math.imul(p,Q)|0,a=a+Math.imul(p,ee)|0;var Se=(d+(r=r+Math.imul(c,ie)|0)|0)+((8191&(n=(n=n+Math.imul(c,re)|0)+Math.imul(u,ie)|0))<<13)|0;d=((a=a+Math.imul(u,re)|0)+(n>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul(x,W),n=(n=Math.imul(x,z))+Math.imul(A,W)|0,a=Math.imul(A,z),r=r+Math.imul(I,j)|0,n=(n=n+Math.imul(I,H)|0)+Math.imul(P,j)|0,a=a+Math.imul(P,H)|0,r=r+Math.imul(w,$)|0,n=(n=n+Math.imul(w,Z)|0)+Math.imul(M,$)|0,a=a+Math.imul(M,Z)|0,r=r+Math.imul(b,Y)|0,n=(n=n+Math.imul(b,J)|0)+Math.imul(S,Y)|0,a=a+Math.imul(S,J)|0,r=r+Math.imul(_,Q)|0,n=(n=n+Math.imul(_,ee)|0)+Math.imul(v,Q)|0,a=a+Math.imul(v,ee)|0,r=r+Math.imul(m,ie)|0,n=(n=n+Math.imul(m,re)|0)+Math.imul(p,ie)|0,a=a+Math.imul(p,re)|0;var Te=(d+(r=r+Math.imul(c,ae)|0)|0)+((8191&(n=(n=n+Math.imul(c,se)|0)+Math.imul(u,ae)|0))<<13)|0;d=((a=a+Math.imul(u,se)|0)+(n>>>13)|0)+(Te>>>26)|0,Te&=67108863,r=Math.imul(R,W),n=(n=Math.imul(R,z))+Math.imul(O,W)|0,a=Math.imul(O,z),r=r+Math.imul(x,j)|0,n=(n=n+Math.imul(x,H)|0)+Math.imul(A,j)|0,a=a+Math.imul(A,H)|0,r=r+Math.imul(I,$)|0,n=(n=n+Math.imul(I,Z)|0)+Math.imul(P,$)|0,a=a+Math.imul(P,Z)|0,r=r+Math.imul(w,Y)|0,n=(n=n+Math.imul(w,J)|0)+Math.imul(M,Y)|0,a=a+Math.imul(M,J)|0,r=r+Math.imul(b,Q)|0,n=(n=n+Math.imul(b,ee)|0)+Math.imul(S,Q)|0,a=a+Math.imul(S,ee)|0,r=r+Math.imul(_,ie)|0,n=(n=n+Math.imul(_,re)|0)+Math.imul(v,ie)|0,a=a+Math.imul(v,re)|0,r=r+Math.imul(m,ae)|0,n=(n=n+Math.imul(m,se)|0)+Math.imul(p,ae)|0,a=a+Math.imul(p,se)|0;var we=(d+(r=r+Math.imul(c,le)|0)|0)+((8191&(n=(n=n+Math.imul(c,de)|0)+Math.imul(u,le)|0))<<13)|0;d=((a=a+Math.imul(u,de)|0)+(n>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(F,W),n=(n=Math.imul(F,z))+Math.imul(D,W)|0,a=Math.imul(D,z),r=r+Math.imul(R,j)|0,n=(n=n+Math.imul(R,H)|0)+Math.imul(O,j)|0,a=a+Math.imul(O,H)|0,r=r+Math.imul(x,$)|0,n=(n=n+Math.imul(x,Z)|0)+Math.imul(A,$)|0,a=a+Math.imul(A,Z)|0,r=r+Math.imul(I,Y)|0,n=(n=n+Math.imul(I,J)|0)+Math.imul(P,Y)|0,a=a+Math.imul(P,J)|0,r=r+Math.imul(w,Q)|0,n=(n=n+Math.imul(w,ee)|0)+Math.imul(M,Q)|0,a=a+Math.imul(M,ee)|0,r=r+Math.imul(b,ie)|0,n=(n=n+Math.imul(b,re)|0)+Math.imul(S,ie)|0,a=a+Math.imul(S,re)|0,r=r+Math.imul(_,ae)|0,n=(n=n+Math.imul(_,se)|0)+Math.imul(v,ae)|0,a=a+Math.imul(v,se)|0,r=r+Math.imul(m,le)|0,n=(n=n+Math.imul(m,de)|0)+Math.imul(p,le)|0,a=a+Math.imul(p,de)|0;var Me=(d+(r=r+Math.imul(c,ce)|0)|0)+((8191&(n=(n=n+Math.imul(c,ue)|0)+Math.imul(u,ce)|0))<<13)|0;d=((a=a+Math.imul(u,ue)|0)+(n>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul(N,W),n=(n=Math.imul(N,z))+Math.imul(V,W)|0,a=Math.imul(V,z),r=r+Math.imul(F,j)|0,n=(n=n+Math.imul(F,H)|0)+Math.imul(D,j)|0,a=a+Math.imul(D,H)|0,r=r+Math.imul(R,$)|0,n=(n=n+Math.imul(R,Z)|0)+Math.imul(O,$)|0,a=a+Math.imul(O,Z)|0,r=r+Math.imul(x,Y)|0,n=(n=n+Math.imul(x,J)|0)+Math.imul(A,Y)|0,a=a+Math.imul(A,J)|0,r=r+Math.imul(I,Q)|0,n=(n=n+Math.imul(I,ee)|0)+Math.imul(P,Q)|0,a=a+Math.imul(P,ee)|0,r=r+Math.imul(w,ie)|0,n=(n=n+Math.imul(w,re)|0)+Math.imul(M,ie)|0,a=a+Math.imul(M,re)|0,r=r+Math.imul(b,ae)|0,n=(n=n+Math.imul(b,se)|0)+Math.imul(S,ae)|0,a=a+Math.imul(S,se)|0,r=r+Math.imul(_,le)|0,n=(n=n+Math.imul(_,de)|0)+Math.imul(v,le)|0,a=a+Math.imul(v,de)|0,r=r+Math.imul(m,ce)|0,n=(n=n+Math.imul(m,ue)|0)+Math.imul(p,ce)|0,a=a+Math.imul(p,ue)|0;var Ce=(d+(r=r+Math.imul(c,me)|0)|0)+((8191&(n=(n=n+Math.imul(c,pe)|0)+Math.imul(u,me)|0))<<13)|0;d=((a=a+Math.imul(u,pe)|0)+(n>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,r=Math.imul(N,j),n=(n=Math.imul(N,H))+Math.imul(V,j)|0,a=Math.imul(V,H),r=r+Math.imul(F,$)|0,n=(n=n+Math.imul(F,Z)|0)+Math.imul(D,$)|0,a=a+Math.imul(D,Z)|0,r=r+Math.imul(R,Y)|0,n=(n=n+Math.imul(R,J)|0)+Math.imul(O,Y)|0,a=a+Math.imul(O,J)|0,r=r+Math.imul(x,Q)|0,n=(n=n+Math.imul(x,ee)|0)+Math.imul(A,Q)|0,a=a+Math.imul(A,ee)|0,r=r+Math.imul(I,ie)|0,n=(n=n+Math.imul(I,re)|0)+Math.imul(P,ie)|0,a=a+Math.imul(P,re)|0,r=r+Math.imul(w,ae)|0,n=(n=n+Math.imul(w,se)|0)+Math.imul(M,ae)|0,a=a+Math.imul(M,se)|0,r=r+Math.imul(b,le)|0,n=(n=n+Math.imul(b,de)|0)+Math.imul(S,le)|0,a=a+Math.imul(S,de)|0,r=r+Math.imul(_,ce)|0,n=(n=n+Math.imul(_,ue)|0)+Math.imul(v,ce)|0,a=a+Math.imul(v,ue)|0;var Ie=(d+(r=r+Math.imul(m,me)|0)|0)+((8191&(n=(n=n+Math.imul(m,pe)|0)+Math.imul(p,me)|0))<<13)|0;d=((a=a+Math.imul(p,pe)|0)+(n>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,r=Math.imul(N,$),n=(n=Math.imul(N,Z))+Math.imul(V,$)|0,a=Math.imul(V,Z),r=r+Math.imul(F,Y)|0,n=(n=n+Math.imul(F,J)|0)+Math.imul(D,Y)|0,a=a+Math.imul(D,J)|0,r=r+Math.imul(R,Q)|0,n=(n=n+Math.imul(R,ee)|0)+Math.imul(O,Q)|0,a=a+Math.imul(O,ee)|0,r=r+Math.imul(x,ie)|0,n=(n=n+Math.imul(x,re)|0)+Math.imul(A,ie)|0,a=a+Math.imul(A,re)|0,r=r+Math.imul(I,ae)|0,n=(n=n+Math.imul(I,se)|0)+Math.imul(P,ae)|0,a=a+Math.imul(P,se)|0,r=r+Math.imul(w,le)|0,n=(n=n+Math.imul(w,de)|0)+Math.imul(M,le)|0,a=a+Math.imul(M,de)|0,r=r+Math.imul(b,ce)|0,n=(n=n+Math.imul(b,ue)|0)+Math.imul(S,ce)|0,a=a+Math.imul(S,ue)|0;var Pe=(d+(r=r+Math.imul(_,me)|0)|0)+((8191&(n=(n=n+Math.imul(_,pe)|0)+Math.imul(v,me)|0))<<13)|0;d=((a=a+Math.imul(v,pe)|0)+(n>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,r=Math.imul(N,Y),n=(n=Math.imul(N,J))+Math.imul(V,Y)|0,a=Math.imul(V,J),r=r+Math.imul(F,Q)|0,n=(n=n+Math.imul(F,ee)|0)+Math.imul(D,Q)|0,a=a+Math.imul(D,ee)|0,r=r+Math.imul(R,ie)|0,n=(n=n+Math.imul(R,re)|0)+Math.imul(O,ie)|0,a=a+Math.imul(O,re)|0,r=r+Math.imul(x,ae)|0,n=(n=n+Math.imul(x,se)|0)+Math.imul(A,ae)|0,a=a+Math.imul(A,se)|0,r=r+Math.imul(I,le)|0,n=(n=n+Math.imul(I,de)|0)+Math.imul(P,le)|0,a=a+Math.imul(P,de)|0,r=r+Math.imul(w,ce)|0,n=(n=n+Math.imul(w,ue)|0)+Math.imul(M,ce)|0,a=a+Math.imul(M,ue)|0;var Ee=(d+(r=r+Math.imul(b,me)|0)|0)+((8191&(n=(n=n+Math.imul(b,pe)|0)+Math.imul(S,me)|0))<<13)|0;d=((a=a+Math.imul(S,pe)|0)+(n>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(N,Q),n=(n=Math.imul(N,ee))+Math.imul(V,Q)|0,a=Math.imul(V,ee),r=r+Math.imul(F,ie)|0,n=(n=n+Math.imul(F,re)|0)+Math.imul(D,ie)|0,a=a+Math.imul(D,re)|0,r=r+Math.imul(R,ae)|0,n=(n=n+Math.imul(R,se)|0)+Math.imul(O,ae)|0,a=a+Math.imul(O,se)|0,r=r+Math.imul(x,le)|0,n=(n=n+Math.imul(x,de)|0)+Math.imul(A,le)|0,a=a+Math.imul(A,de)|0,r=r+Math.imul(I,ce)|0,n=(n=n+Math.imul(I,ue)|0)+Math.imul(P,ce)|0,a=a+Math.imul(P,ue)|0;var xe=(d+(r=r+Math.imul(w,me)|0)|0)+((8191&(n=(n=n+Math.imul(w,pe)|0)+Math.imul(M,me)|0))<<13)|0;d=((a=a+Math.imul(M,pe)|0)+(n>>>13)|0)+(xe>>>26)|0,xe&=67108863,r=Math.imul(N,ie),n=(n=Math.imul(N,re))+Math.imul(V,ie)|0,a=Math.imul(V,re),r=r+Math.imul(F,ae)|0,n=(n=n+Math.imul(F,se)|0)+Math.imul(D,ae)|0,a=a+Math.imul(D,se)|0,r=r+Math.imul(R,le)|0,n=(n=n+Math.imul(R,de)|0)+Math.imul(O,le)|0,a=a+Math.imul(O,de)|0,r=r+Math.imul(x,ce)|0,n=(n=n+Math.imul(x,ue)|0)+Math.imul(A,ce)|0,a=a+Math.imul(A,ue)|0;var Ae=(d+(r=r+Math.imul(I,me)|0)|0)+((8191&(n=(n=n+Math.imul(I,pe)|0)+Math.imul(P,me)|0))<<13)|0;d=((a=a+Math.imul(P,pe)|0)+(n>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,r=Math.imul(N,ae),n=(n=Math.imul(N,se))+Math.imul(V,ae)|0,a=Math.imul(V,se),r=r+Math.imul(F,le)|0,n=(n=n+Math.imul(F,de)|0)+Math.imul(D,le)|0,a=a+Math.imul(D,de)|0,r=r+Math.imul(R,ce)|0,n=(n=n+Math.imul(R,ue)|0)+Math.imul(O,ce)|0,a=a+Math.imul(O,ue)|0;var ke=(d+(r=r+Math.imul(x,me)|0)|0)+((8191&(n=(n=n+Math.imul(x,pe)|0)+Math.imul(A,me)|0))<<13)|0;d=((a=a+Math.imul(A,pe)|0)+(n>>>13)|0)+(ke>>>26)|0,ke&=67108863,r=Math.imul(N,le),n=(n=Math.imul(N,de))+Math.imul(V,le)|0,a=Math.imul(V,de),r=r+Math.imul(F,ce)|0,n=(n=n+Math.imul(F,ue)|0)+Math.imul(D,ce)|0,a=a+Math.imul(D,ue)|0;var Re=(d+(r=r+Math.imul(R,me)|0)|0)+((8191&(n=(n=n+Math.imul(R,pe)|0)+Math.imul(O,me)|0))<<13)|0;d=((a=a+Math.imul(O,pe)|0)+(n>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul(N,ce),n=(n=Math.imul(N,ue))+Math.imul(V,ce)|0,a=Math.imul(V,ue);var Oe=(d+(r=r+Math.imul(F,me)|0)|0)+((8191&(n=(n=n+Math.imul(F,pe)|0)+Math.imul(D,me)|0))<<13)|0;d=((a=a+Math.imul(D,pe)|0)+(n>>>13)|0)+(Oe>>>26)|0,Oe&=67108863;var Le=(d+(r=Math.imul(N,me))|0)+((8191&(n=(n=Math.imul(N,pe))+Math.imul(V,me)|0))<<13)|0;return d=((a=Math.imul(V,pe))+(n>>>13)|0)+(Le>>>26)|0,Le&=67108863,l[0]=ge,l[1]=_e,l[2]=ve,l[3]=ye,l[4]=be,l[5]=Se,l[6]=Te,l[7]=we,l[8]=Me,l[9]=Ce,l[10]=Ie,l[11]=Pe,l[12]=Ee,l[13]=xe,l[14]=Ae,l[15]=ke,l[16]=Re,l[17]=Oe,l[18]=Le,0!==d&&(l[19]=d,i.length++),i};function m(e,t,i){return(new p).mulp(e,t,i)}function p(e,t){this.x=e,this.y=t}Math.imul||(f=u),a.prototype.mulTo=function(e,t){var i=this.length+e.length;return 10===this.length&&10===e.length?f(this,e,t):i<63?u(this,e,t):i<1024?function(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var r=0,n=0,a=0;a<i.length-1;a++){var s=n;n=0;for(var o=67108863&r,l=Math.min(a,t.length-1),d=Math.max(0,a-e.length+1);d<=l;d++){var h=a-d,c=(0|e.words[h])*(0|t.words[d]),u=67108863&c;o=67108863&(u=u+o|0),n+=(s=(s=s+(c/67108864|0)|0)+(u>>>26)|0)>>>26,s&=67108863}i.words[a]=o,r=s,s=n}return 0!==r?i.words[a]=r:i.length--,i.strip()}(this,e,t):m(this,e,t)},p.prototype.makeRBT=function(e){for(var t=new Array(e),i=a.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,i,e);return t},p.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var r=0,n=0;n<t;n++)r|=(1&e)<<t-n-1,e>>=1;return r},p.prototype.permute=function(e,t,i,r,n,a){for(var s=0;s<a;s++)r[s]=t[e[s]],n[s]=i[e[s]]},p.prototype.transform=function(e,t,i,r,n,a){this.permute(a,e,t,i,r,n);for(var s=1;s<n;s<<=1)for(var o=s<<1,l=Math.cos(2*Math.PI/o),d=Math.sin(2*Math.PI/o),h=0;h<n;h+=o)for(var c=l,u=d,f=0;f<s;f++){var m=i[h+f],p=r[h+f],g=i[h+f+s],_=r[h+f+s],v=c*g-u*_;_=c*_+u*g,g=v,i[h+f]=m+g,r[h+f]=p+_,i[h+f+s]=m-g,r[h+f+s]=p-_,f!==o&&(v=l*c-d*u,u=l*u+d*c,c=v)}},p.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),r=1&i,n=0;for(i=i/2|0;i;i>>>=1)n++;return 1<<n+1+r},p.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var r=0;r<i/2;r++){var n=e[r];e[r]=e[i-r-1],e[i-r-1]=n,n=t[r],t[r]=-t[i-r-1],t[i-r-1]=-n}},p.prototype.normalize13b=function(e,t){for(var i=0,r=0;r<t/2;r++){var n=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+i;e[r]=67108863&n,i=n<67108864?0:n/67108864|0}return e},p.prototype.convert13b=function(e,t,i,n){for(var a=0,s=0;s<t;s++)a+=0|e[s],i[2*s]=8191&a,a>>>=13,i[2*s+1]=8191&a,a>>>=13;for(s=2*t;s<n;++s)i[s]=0;r(0===a),r(0==(-8192&a))},p.prototype.stub=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0;return t},p.prototype.mulp=function(e,t,i){var r=2*this.guessLen13b(e.length,t.length),n=this.makeRBT(r),a=this.stub(r),s=new Array(r),o=new Array(r),l=new Array(r),d=new Array(r),h=new Array(r),c=new Array(r),u=i.words;u.length=r,this.convert13b(e.words,e.length,s,r),this.convert13b(t.words,t.length,d,r),this.transform(s,a,o,l,r,n),this.transform(d,a,h,c,r,n);for(var f=0;f<r;f++){var m=o[f]*h[f]-l[f]*c[f];l[f]=o[f]*c[f]+l[f]*h[f],o[f]=m}return this.conjugate(o,l,r),this.transform(o,l,u,a,r,n),this.conjugate(u,a,r),this.normalize13b(u,r),i.negative=e.negative^t.negative,i.length=e.length+t.length,i.strip()},a.prototype.mul=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},a.prototype.mulf=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),m(this,e,t)},a.prototype.imul=function(e){return this.clone().mulTo(e,this)},a.prototype.imuln=function(e){r("number"==typeof e),r(e<67108864);for(var t=0,i=0;i<this.length;i++){var n=(0|this.words[i])*e,a=(67108863&n)+(67108863&t);t>>=26,t+=n/67108864|0,t+=a>>>26,this.words[i]=67108863&a}return 0!==t&&(this.words[i]=t,this.length++),this},a.prototype.muln=function(e){return this.clone().imuln(e)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),i=0;i<t.length;i++){var r=i/26|0,n=i%26;t[i]=(e.words[r]&1<<n)>>>n}return t}(e);if(0===t.length)return new a(1);for(var i=this,r=0;r<t.length&&0===t[r];r++,i=i.sqr());if(++r<t.length)for(var n=i.sqr();r<t.length;r++,n=n.sqr())0!==t[r]&&(i=i.mul(n));return i},a.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,i=e%26,n=(e-i)/26,a=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(t=0;t<this.length;t++){var o=this.words[t]&a,l=(0|this.words[t])-o<<i;this.words[t]=l|s,s=o>>>26-i}s&&(this.words[t]=s,this.length++)}if(0!==n){for(t=this.length-1;t>=0;t--)this.words[t+n]=this.words[t];for(t=0;t<n;t++)this.words[t]=0;this.length+=n}return this.strip()},a.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},a.prototype.iushrn=function(e,t,i){var n;r("number"==typeof e&&e>=0),n=t?(t-t%26)/26:0;var a=e%26,s=Math.min((e-a)/26,this.length),o=67108863^67108863>>>a<<a,l=i;if(n-=s,n=Math.max(0,n),l){for(var d=0;d<s;d++)l.words[d]=this.words[d];l.length=s}if(0===s);else if(this.length>s)for(this.length-=s,d=0;d<this.length;d++)this.words[d]=this.words[d+s];else this.words[0]=0,this.length=1;var h=0;for(d=this.length-1;d>=0&&(0!==h||d>=n);d--){var c=0|this.words[d];this.words[d]=h<<26-a|c>>>a,h=c&o}return l&&0!==h&&(l.words[l.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(e,t,i){return r(0===this.negative),this.iushrn(e,t,i)},a.prototype.shln=function(e){return this.clone().ishln(e)},a.prototype.ushln=function(e){return this.clone().iushln(e)},a.prototype.shrn=function(e){return this.clone().ishrn(e)},a.prototype.ushrn=function(e){return this.clone().iushrn(e)},a.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26,n=1<<t;return!(this.length<=i||!(this.words[i]&n))},a.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==t&&i++,this.length=Math.min(i,this.length),0!==t){var n=67108863^67108863>>>t<<t;this.words[this.length-1]&=n}return this.strip()},a.prototype.maskn=function(e){return this.clone().imaskn(e)},a.prototype.iaddn=function(e){return r("number"==typeof e),r(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},a.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},a.prototype.isubn=function(e){if(r("number"==typeof e),r(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},a.prototype.addn=function(e){return this.clone().iaddn(e)},a.prototype.subn=function(e){return this.clone().isubn(e)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(e,t,i){var n,a,s=e.length+i;this._expand(s);var o=0;for(n=0;n<e.length;n++){a=(0|this.words[n+i])+o;var l=(0|e.words[n])*t;o=((a-=67108863&l)>>26)-(l/67108864|0),this.words[n+i]=67108863&a}for(;n<this.length-i;n++)o=(a=(0|this.words[n+i])+o)>>26,this.words[n+i]=67108863&a;if(0===o)return this.strip();for(r(-1===o),o=0,n=0;n<this.length;n++)o=(a=-(0|this.words[n])+o)>>26,this.words[n]=67108863&a;return this.negative=1,this.strip()},a.prototype._wordDiv=function(e,t){var i=(this.length,e.length),r=this.clone(),n=e,s=0|n.words[n.length-1];0!=(i=26-this._countBits(s))&&(n=n.ushln(i),r.iushln(i),s=0|n.words[n.length-1]);var o,l=r.length-n.length;if("mod"!==t){(o=new a(null)).length=l+1,o.words=new Array(o.length);for(var d=0;d<o.length;d++)o.words[d]=0}var h=r.clone()._ishlnsubmul(n,1,l);0===h.negative&&(r=h,o&&(o.words[l]=1));for(var c=l-1;c>=0;c--){var u=67108864*(0|r.words[n.length+c])+(0|r.words[n.length+c-1]);for(u=Math.min(u/s|0,67108863),r._ishlnsubmul(n,u,c);0!==r.negative;)u--,r.negative=0,r._ishlnsubmul(n,1,c),r.isZero()||(r.negative^=1);o&&(o.words[c]=u)}return o&&o.strip(),r.strip(),"div"!==t&&0!==i&&r.iushrn(i),{div:o||null,mod:r}},a.prototype.divmod=function(e,t,i){return r(!e.isZero()),this.isZero()?{div:new a(0),mod:new a(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(n=o.div.neg()),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.iadd(e)),{div:n,mod:s}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(n=o.div.neg()),{div:n,mod:o.mod}):0!=(this.negative&e.negative)?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.isub(e)),{div:o.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new a(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new a(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new a(this.modn(e.words[0]))}:this._wordDiv(e,t);var n,s,o},a.prototype.div=function(e){return this.divmod(e,"div",!1).div},a.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},a.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},a.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),n=e.andln(1),a=i.cmp(r);return a<0||1===n&&0===a?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},a.prototype.modn=function(e){r(e<=67108863);for(var t=(1<<26)%e,i=0,n=this.length-1;n>=0;n--)i=(t*i+(0|this.words[n]))%e;return i},a.prototype.idivn=function(e){r(e<=67108863);for(var t=0,i=this.length-1;i>=0;i--){var n=(0|this.words[i])+67108864*t;this.words[i]=n/e|0,t=n%e}return this.strip()},a.prototype.divn=function(e){return this.clone().idivn(e)},a.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n=new a(1),s=new a(0),o=new a(0),l=new a(1),d=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++d;for(var h=i.clone(),c=t.clone();!t.isZero();){for(var u=0,f=1;0==(t.words[0]&f)&&u<26;++u,f<<=1);if(u>0)for(t.iushrn(u);u-- >0;)(n.isOdd()||s.isOdd())&&(n.iadd(h),s.isub(c)),n.iushrn(1),s.iushrn(1);for(var m=0,p=1;0==(i.words[0]&p)&&m<26;++m,p<<=1);if(m>0)for(i.iushrn(m);m-- >0;)(o.isOdd()||l.isOdd())&&(o.iadd(h),l.isub(c)),o.iushrn(1),l.iushrn(1);t.cmp(i)>=0?(t.isub(i),n.isub(o),s.isub(l)):(i.isub(t),o.isub(n),l.isub(s))}return{a:o,b:l,gcd:i.iushln(d)}},a.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n,s=new a(1),o=new a(0),l=i.clone();t.cmpn(1)>0&&i.cmpn(1)>0;){for(var d=0,h=1;0==(t.words[0]&h)&&d<26;++d,h<<=1);if(d>0)for(t.iushrn(d);d-- >0;)s.isOdd()&&s.iadd(l),s.iushrn(1);for(var c=0,u=1;0==(i.words[0]&u)&&c<26;++c,u<<=1);if(c>0)for(i.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(l),o.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(o)):(i.isub(t),o.isub(s))}return(n=0===t.cmpn(1)?s:o).cmpn(0)<0&&n.iadd(e),n},a.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var r=0;t.isEven()&&i.isEven();r++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var n=t.cmp(i);if(n<0){var a=t;t=i,i=a}else if(0===n||0===i.cmpn(1))break;t.isub(i)}return i.iushln(r)},a.prototype.invm=function(e){return this.egcd(e).a.umod(e)},a.prototype.isEven=function(){return 0==(1&this.words[0])},a.prototype.isOdd=function(){return 1==(1&this.words[0])},a.prototype.andln=function(e){return this.words[0]&e},a.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,i=(e-t)/26,n=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=n,this;for(var a=n,s=i;0!==a&&s<this.length;s++){var o=0|this.words[s];a=(o+=a)>>>26,o&=67108863,this.words[s]=o}return 0!==a&&(this.words[s]=a,this.length++),this},a.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},a.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)t=1;else{i&&(e=-e),r(e<=67108863,"Number is too big");var n=0|this.words[0];t=n===e?0:n<e?-1:1}return 0!==this.negative?0|-t:t},a.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},a.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,i=this.length-1;i>=0;i--){var r=0|this.words[i],n=0|e.words[i];if(r!==n){r<n?t=-1:r>n&&(t=1);break}}return t},a.prototype.gtn=function(e){return 1===this.cmpn(e)},a.prototype.gt=function(e){return 1===this.cmp(e)},a.prototype.gten=function(e){return this.cmpn(e)>=0},a.prototype.gte=function(e){return this.cmp(e)>=0},a.prototype.ltn=function(e){return-1===this.cmpn(e)},a.prototype.lt=function(e){return-1===this.cmp(e)},a.prototype.lten=function(e){return this.cmpn(e)<=0},a.prototype.lte=function(e){return this.cmp(e)<=0},a.prototype.eqn=function(e){return 0===this.cmpn(e)},a.prototype.eq=function(e){return 0===this.cmp(e)},a.red=function(e){return new T(e)},a.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},a.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(e){return this.red=e,this},a.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},a.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},a.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},a.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},a.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},a.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},a.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},a.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},a.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function _(e,t){this.name=e,this.p=new a(t,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function y(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function b(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function S(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function T(e){if("string"==typeof e){var t=a._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function w(e){T.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var e=new a(null);return e.words=new Array(Math.ceil(this.n/13)),e},_.prototype.ireduce=function(e){var t,i=e;do{this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(t>this.n);var r=t<this.n?-1:i.ucmp(this.p);return 0===r?(i.words[0]=0,i.length=1):r>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},_.prototype.split=function(e,t){e.iushrn(this.n,0,t)},_.prototype.imulK=function(e){return e.imul(this.k)},n(v,_),v.prototype.split=function(e,t){for(var i=Math.min(e.length,9),r=0;r<i;r++)t.words[r]=e.words[r];if(t.length=i,e.length<=9)return e.words[0]=0,void(e.length=1);var n=e.words[9];for(t.words[t.length++]=4194303&n,r=10;r<e.length;r++){var a=0|e.words[r];e.words[r-10]=(4194303&a)<<4|n>>>22,n=a}n>>>=22,e.words[r-10]=n,0===n&&e.length>10?e.length-=10:e.length-=9},v.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var r=0|e.words[i];t+=977*r,e.words[i]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},n(y,_),n(b,_),n(S,_),S.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var r=19*(0|e.words[i])+t,n=67108863&r;r>>>=26,e.words[i]=n,t=r}return 0!==t&&(e.words[e.length++]=t),e},a._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new v;else if("p224"===e)t=new y;else if("p192"===e)t=new b;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new S}return g[e]=t,t},T.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},T.prototype._verify2=function(e,t){r(0==(e.negative|t.negative),"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},T.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},T.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},T.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},T.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},T.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},T.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i},T.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},T.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},T.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},T.prototype.isqr=function(e){return this.imul(e,e.clone())},T.prototype.sqr=function(e){return this.mul(e,e)},T.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var i=this.m.add(new a(1)).iushrn(2);return this.pow(e,i)}for(var n=this.m.subn(1),s=0;!n.isZero()&&0===n.andln(1);)s++,n.iushrn(1);r(!n.isZero());var o=new a(1).toRed(this),l=o.redNeg(),d=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new a(2*h*h).toRed(this);0!==this.pow(h,d).cmp(l);)h.redIAdd(l);for(var c=this.pow(h,n),u=this.pow(e,n.addn(1).iushrn(1)),f=this.pow(e,n),m=s;0!==f.cmp(o);){for(var p=f,g=0;0!==p.cmp(o);g++)p=p.redSqr();r(g<m);var _=this.pow(c,new a(1).iushln(m-g-1));u=u.redMul(_),c=_.redSqr(),f=f.redMul(c),m=g}return u},T.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},T.prototype.pow=function(e,t){if(t.isZero())return new a(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=new Array(16);i[0]=new a(1).toRed(this),i[1]=e;for(var r=2;r<i.length;r++)i[r]=this.mul(i[r-1],e);var n=i[0],s=0,o=0,l=t.bitLength()%26;for(0===l&&(l=26),r=t.length-1;r>=0;r--){for(var d=t.words[r],h=l-1;h>=0;h--){var c=d>>h&1;n!==i[0]&&(n=this.sqr(n)),0!==c||0!==s?(s<<=1,s|=c,(4==++o||0===r&&0===h)&&(n=this.mul(n,i[s]),o=0,s=0)):o=0}l=26}return n},T.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},T.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},a.mont=function(e){return new w(e)},n(w,T),w.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},w.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},w.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),a=n;return n.cmp(this.m)>=0?a=n.isub(this.m):n.cmpn(0)<0&&(a=n.iadd(this.m)),a._forceRed(this)},w.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new a(0)._forceRed(this);var i=e.mul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},w.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,i(83)(e))},function(e,t){},function(e){e.exports=JSON.parse('{"name":"elliptic","version":"6.5.3","description":"EC cryptography","main":"lib/elliptic.js","files":["lib"],"scripts":{"jscs":"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js","jshint":"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js","lint":"npm run jscs && npm run jshint","unit":"istanbul test _mocha --reporter=spec test/index.js","test":"npm run lint && npm run unit","version":"grunt dist && git add dist/"},"repository":{"type":"git","url":"git@github.com:indutny/elliptic"},"keywords":["EC","Elliptic","curve","Cryptography"],"author":"Fedor Indutny <fedor@indutny.com>","license":"MIT","bugs":{"url":"https://github.com/indutny/elliptic/issues"},"homepage":"https://github.com/indutny/elliptic","devDependencies":{"brfs":"^1.4.3","coveralls":"^3.0.8","grunt":"^1.0.4","grunt-browserify":"^5.0.0","grunt-cli":"^1.2.0","grunt-contrib-connect":"^1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.1","grunt-mocha-istanbul":"^3.0.1","grunt-saucelabs":"^9.0.1","istanbul":"^0.4.2","jscs":"^3.0.7","jshint":"^2.10.3","mocha":"^6.2.2"},"dependencies":{"bn.js":"^4.4.0","brorand":"^1.0.1","hash.js":"^1.0.0","hmac-drbg":"^1.0.0","inherits":"^2.0.1","minimalistic-assert":"^1.0.0","minimalistic-crypto-utils":"^1.0.0"}}')},function(e,t){},function(e,t,i){"use strict";var r=i(66),n=i(84),a=i(26),s=i(130),o=r.assert;function l(e){s.call(this,"short",e),this.a=new n(e.a,16).toRed(this.red),this.b=new n(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function d(e,t,i,r){s.BasePoint.call(this,e,"affine"),null===t&&null===i?(this.x=null,this.y=null,this.inf=!0):(this.x=new n(t,16),this.y=new n(i,16),r&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function h(e,t,i,r){s.BasePoint.call(this,e,"jacobian"),null===t&&null===i&&null===r?(this.x=this.curve.one,this.y=this.curve.one,this.z=new n(0)):(this.x=new n(t,16),this.y=new n(i,16),this.z=new n(r,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}a(l,s),e.exports=l,l.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,i;if(e.beta)t=new n(e.beta,16).toRed(this.red);else{var r=this._getEndoRoots(this.p);t=(t=r[0].cmp(r[1])<0?r[0]:r[1]).toRed(this.red)}if(e.lambda)i=new n(e.lambda,16);else{var a=this._getEndoRoots(this.n);0===this.g.mul(a[0]).x.cmp(this.g.x.redMul(t))?i=a[0]:(i=a[1],o(0===this.g.mul(i).x.cmp(this.g.x.redMul(t))))}return{beta:t,lambda:i,basis:e.basis?e.basis.map((function(e){return{a:new n(e.a,16),b:new n(e.b,16)}})):this._getEndoBasis(i)}}},l.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:n.mont(e),i=new n(2).toRed(t).redInvm(),r=i.redNeg(),a=new n(3).toRed(t).redNeg().redSqrt().redMul(i);return[r.redAdd(a).fromRed(),r.redSub(a).fromRed()]},l.prototype._getEndoBasis=function(e){for(var t,i,r,a,s,o,l,d,h,c=this.n.ushrn(Math.floor(this.n.bitLength()/2)),u=e,f=this.n.clone(),m=new n(1),p=new n(0),g=new n(0),_=new n(1),v=0;0!==u.cmpn(0);){var y=f.div(u);d=f.sub(y.mul(u)),h=g.sub(y.mul(m));var b=_.sub(y.mul(p));if(!r&&d.cmp(c)<0)t=l.neg(),i=m,r=d.neg(),a=h;else if(r&&2==++v)break;l=d,f=u,u=d,g=m,m=h,_=p,p=b}s=d.neg(),o=h;var S=r.sqr().add(a.sqr());return s.sqr().add(o.sqr()).cmp(S)>=0&&(s=t,o=i),r.negative&&(r=r.neg(),a=a.neg()),s.negative&&(s=s.neg(),o=o.neg()),[{a:r,b:a},{a:s,b:o}]},l.prototype._endoSplit=function(e){var t=this.endo.basis,i=t[0],r=t[1],n=r.b.mul(e).divRound(this.n),a=i.b.neg().mul(e).divRound(this.n),s=n.mul(i.a),o=a.mul(r.a),l=n.mul(i.b),d=a.mul(r.b);return{k1:e.sub(s).sub(o),k2:l.add(d).neg()}},l.prototype.pointFromX=function(e,t){(e=new n(e,16)).red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),r=i.redSqrt();if(0!==r.redSqr().redSub(i).cmp(this.zero))throw new Error("invalid point");var a=r.fromRed().isOdd();return(t&&!a||!t&&a)&&(r=r.redNeg()),this.point(e,r)},l.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,i=e.y,r=this.a.redMul(t),n=t.redSqr().redMul(t).redIAdd(r).redIAdd(this.b);return 0===i.redSqr().redISub(n).cmpn(0)},l.prototype._endoWnafMulAdd=function(e,t,i){for(var r=this._endoWnafT1,n=this._endoWnafT2,a=0;a<e.length;a++){var s=this._endoSplit(t[a]),o=e[a],l=o._getBeta();s.k1.negative&&(s.k1.ineg(),o=o.neg(!0)),s.k2.negative&&(s.k2.ineg(),l=l.neg(!0)),r[2*a]=o,r[2*a+1]=l,n[2*a]=s.k1,n[2*a+1]=s.k2}for(var d=this._wnafMulAdd(1,r,n,2*a,i),h=0;h<2*a;h++)r[h]=null,n[h]=null;return d},a(d,s.BasePoint),l.prototype.point=function(e,t,i){return new d(this,e,t,i)},l.prototype.pointFromJSON=function(e,t){return d.fromJSON(this,e,t)},d.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,r=function(e){return i.point(e.x.redMul(i.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(r)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(r)}}}return t}},d.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},d.fromJSON=function(e,t,i){"string"==typeof t&&(t=JSON.parse(t));var r=e.point(t[0],t[1],i);if(!t[2])return r;function n(t){return e.point(t[0],t[1],i)}var a=t[2];return r.precomputed={beta:null,doubles:a.doubles&&{step:a.doubles.step,points:[r].concat(a.doubles.points.map(n))},naf:a.naf&&{wnd:a.naf.wnd,points:[r].concat(a.naf.points.map(n))}},r},d.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},d.prototype.isInfinity=function(){return this.inf},d.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var i=t.redSqr().redISub(this.x).redISub(e.x),r=t.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,r)},d.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,i=this.x.redSqr(),r=e.redInvm(),n=i.redAdd(i).redIAdd(i).redIAdd(t).redMul(r),a=n.redSqr().redISub(this.x.redAdd(this.x)),s=n.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,s)},d.prototype.getX=function(){return this.x.fromRed()},d.prototype.getY=function(){return this.y.fromRed()},d.prototype.mul=function(e){return e=new n(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},d.prototype.mulAdd=function(e,t,i){var r=[this,t],n=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(r,n):this.curve._wnafMulAdd(1,r,n,2)},d.prototype.jmulAdd=function(e,t,i){var r=[this,t],n=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(r,n,!0):this.curve._wnafMulAdd(1,r,n,2,!0)},d.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},d.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,r=function(e){return e.neg()};t.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(r)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(r)}}}return t},d.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},a(h,s.BasePoint),l.prototype.jpoint=function(e,t,i){return new h(this,e,t,i)},h.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),i=this.x.redMul(t),r=this.y.redMul(t).redMul(e);return this.curve.point(i,r)},h.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},h.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),i=this.z.redSqr(),r=this.x.redMul(t),n=e.x.redMul(i),a=this.y.redMul(t.redMul(e.z)),s=e.y.redMul(i.redMul(this.z)),o=r.redSub(n),l=a.redSub(s);if(0===o.cmpn(0))return 0!==l.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var d=o.redSqr(),h=d.redMul(o),c=r.redMul(d),u=l.redSqr().redIAdd(h).redISub(c).redISub(c),f=l.redMul(c.redISub(u)).redISub(a.redMul(h)),m=this.z.redMul(e.z).redMul(o);return this.curve.jpoint(u,f,m)},h.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),i=this.x,r=e.x.redMul(t),n=this.y,a=e.y.redMul(t).redMul(this.z),s=i.redSub(r),o=n.redSub(a);if(0===s.cmpn(0))return 0!==o.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var l=s.redSqr(),d=l.redMul(s),h=i.redMul(l),c=o.redSqr().redIAdd(d).redISub(h).redISub(h),u=o.redMul(h.redISub(c)).redISub(n.redMul(d)),f=this.z.redMul(s);return this.curve.jpoint(c,u,f)},h.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var t=this,i=0;i<e;i++)t=t.dbl();return t}var r=this.curve.a,n=this.curve.tinv,a=this.x,s=this.y,o=this.z,l=o.redSqr().redSqr(),d=s.redAdd(s);for(i=0;i<e;i++){var h=a.redSqr(),c=d.redSqr(),u=c.redSqr(),f=h.redAdd(h).redIAdd(h).redIAdd(r.redMul(l)),m=a.redMul(c),p=f.redSqr().redISub(m.redAdd(m)),g=m.redISub(p),_=f.redMul(g);_=_.redIAdd(_).redISub(u);var v=d.redMul(o);i+1<e&&(l=l.redMul(u)),a=p,o=v,d=_}return this.curve.jpoint(a,d.redMul(n),o)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},h.prototype._zeroDbl=function(){var e,t,i;if(this.zOne){var r=this.x.redSqr(),n=this.y.redSqr(),a=n.redSqr(),s=this.x.redAdd(n).redSqr().redISub(r).redISub(a);s=s.redIAdd(s);var o=r.redAdd(r).redIAdd(r),l=o.redSqr().redISub(s).redISub(s),d=a.redIAdd(a);d=(d=d.redIAdd(d)).redIAdd(d),e=l,t=o.redMul(s.redISub(l)).redISub(d),i=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),c=this.y.redSqr(),u=c.redSqr(),f=this.x.redAdd(c).redSqr().redISub(h).redISub(u);f=f.redIAdd(f);var m=h.redAdd(h).redIAdd(h),p=m.redSqr(),g=u.redIAdd(u);g=(g=g.redIAdd(g)).redIAdd(g),e=p.redISub(f).redISub(f),t=m.redMul(f.redISub(e)).redISub(g),i=(i=this.y.redMul(this.z)).redIAdd(i)}return this.curve.jpoint(e,t,i)},h.prototype._threeDbl=function(){var e,t,i;if(this.zOne){var r=this.x.redSqr(),n=this.y.redSqr(),a=n.redSqr(),s=this.x.redAdd(n).redSqr().redISub(r).redISub(a);s=s.redIAdd(s);var o=r.redAdd(r).redIAdd(r).redIAdd(this.curve.a),l=o.redSqr().redISub(s).redISub(s);e=l;var d=a.redIAdd(a);d=(d=d.redIAdd(d)).redIAdd(d),t=o.redMul(s.redISub(l)).redISub(d),i=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),c=this.y.redSqr(),u=this.x.redMul(c),f=this.x.redSub(h).redMul(this.x.redAdd(h));f=f.redAdd(f).redIAdd(f);var m=u.redIAdd(u),p=(m=m.redIAdd(m)).redAdd(m);e=f.redSqr().redISub(p),i=this.y.redAdd(this.z).redSqr().redISub(c).redISub(h);var g=c.redSqr();g=(g=(g=g.redIAdd(g)).redIAdd(g)).redIAdd(g),t=f.redMul(m.redISub(e)).redISub(g)}return this.curve.jpoint(e,t,i)},h.prototype._dbl=function(){var e=this.curve.a,t=this.x,i=this.y,r=this.z,n=r.redSqr().redSqr(),a=t.redSqr(),s=i.redSqr(),o=a.redAdd(a).redIAdd(a).redIAdd(e.redMul(n)),l=t.redAdd(t),d=(l=l.redIAdd(l)).redMul(s),h=o.redSqr().redISub(d.redAdd(d)),c=d.redISub(h),u=s.redSqr();u=(u=(u=u.redIAdd(u)).redIAdd(u)).redIAdd(u);var f=o.redMul(c).redISub(u),m=i.redAdd(i).redMul(r);return this.curve.jpoint(h,f,m)},h.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr(),r=t.redSqr(),n=e.redAdd(e).redIAdd(e),a=n.redSqr(),s=this.x.redAdd(t).redSqr().redISub(e).redISub(r),o=(s=(s=(s=s.redIAdd(s)).redAdd(s).redIAdd(s)).redISub(a)).redSqr(),l=r.redIAdd(r);l=(l=(l=l.redIAdd(l)).redIAdd(l)).redIAdd(l);var d=n.redIAdd(s).redSqr().redISub(a).redISub(o).redISub(l),h=t.redMul(d);h=(h=h.redIAdd(h)).redIAdd(h);var c=this.x.redMul(o).redISub(h);c=(c=c.redIAdd(c)).redIAdd(c);var u=this.y.redMul(d.redMul(l.redISub(d)).redISub(s.redMul(o)));u=(u=(u=u.redIAdd(u)).redIAdd(u)).redIAdd(u);var f=this.z.redAdd(s).redSqr().redISub(i).redISub(o);return this.curve.jpoint(c,u,f)},h.prototype.mul=function(e,t){return e=new n(e,t),this.curve._wnafMul(this,e)},h.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),i=e.z.redSqr();if(0!==this.x.redMul(i).redISub(e.x.redMul(t)).cmpn(0))return!1;var r=t.redMul(this.z),n=i.redMul(e.z);return 0===this.y.redMul(n).redISub(e.y.redMul(r)).cmpn(0)},h.prototype.eqXToP=function(e){var t=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(i))return!0;for(var r=e.clone(),n=this.curve.redN.redMul(t);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(n),0===this.x.cmp(i))return!0}},h.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},h.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},function(e,t,i){"use strict";var r=i(84),n=i(26),a=i(130),s=i(66);function o(e){a.call(this,"mont",e),this.a=new r(e.a,16).toRed(this.red),this.b=new r(e.b,16).toRed(this.red),this.i4=new r(4).toRed(this.red).redInvm(),this.two=new r(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function l(e,t,i){a.BasePoint.call(this,e,"projective"),null===t&&null===i?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new r(t,16),this.z=new r(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}n(o,a),e.exports=o,o.prototype.validate=function(e){var t=e.normalize().x,i=t.redSqr(),r=i.redMul(t).redAdd(i.redMul(this.a)).redAdd(t);return 0===r.redSqrt().redSqr().cmp(r)},n(l,a.BasePoint),o.prototype.decodePoint=function(e,t){return this.point(s.toArray(e,t),1)},o.prototype.point=function(e,t){return new l(this,e,t)},o.prototype.pointFromJSON=function(e){return l.fromJSON(this,e)},l.prototype.precompute=function(){},l.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},l.fromJSON=function(e,t){return new l(e,t[0],t[1]||e.one)},l.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},l.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},l.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),i=e.redSub(t),r=e.redMul(t),n=i.redMul(t.redAdd(this.curve.a24.redMul(i)));return this.curve.point(r,n)},l.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},l.prototype.diffAdd=function(e,t){var i=this.x.redAdd(this.z),r=this.x.redSub(this.z),n=e.x.redAdd(e.z),a=e.x.redSub(e.z).redMul(i),s=n.redMul(r),o=t.z.redMul(a.redAdd(s).redSqr()),l=t.x.redMul(a.redISub(s).redSqr());return this.curve.point(o,l)},l.prototype.mul=function(e){for(var t=e.clone(),i=this,r=this.curve.point(null,null),n=[];0!==t.cmpn(0);t.iushrn(1))n.push(t.andln(1));for(var a=n.length-1;a>=0;a--)0===n[a]?(i=i.diffAdd(r,this),r=r.dbl()):(r=i.diffAdd(r,this),i=i.dbl());return r},l.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},l.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},l.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},l.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},l.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},function(e,t,i){"use strict";var r=i(66),n=i(84),a=i(26),s=i(130),o=r.assert;function l(e){this.twisted=1!=(0|e.a),this.mOneA=this.twisted&&-1==(0|e.a),this.extended=this.mOneA,s.call(this,"edwards",e),this.a=new n(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new n(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new n(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),o(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|e.c)}function d(e,t,i,r,a){s.BasePoint.call(this,e,"projective"),null===t&&null===i&&null===r?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new n(t,16),this.y=new n(i,16),this.z=r?new n(r,16):this.curve.one,this.t=a&&new n(a,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}a(l,s),e.exports=l,l.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},l.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},l.prototype.jpoint=function(e,t,i,r){return this.point(e,t,i,r)},l.prototype.pointFromX=function(e,t){(e=new n(e,16)).red||(e=e.toRed(this.red));var i=e.redSqr(),r=this.c2.redSub(this.a.redMul(i)),a=this.one.redSub(this.c2.redMul(this.d).redMul(i)),s=r.redMul(a.redInvm()),o=s.redSqrt();if(0!==o.redSqr().redSub(s).cmp(this.zero))throw new Error("invalid point");var l=o.fromRed().isOdd();return(t&&!l||!t&&l)&&(o=o.redNeg()),this.point(e,o)},l.prototype.pointFromY=function(e,t){(e=new n(e,16)).red||(e=e.toRed(this.red));var i=e.redSqr(),r=i.redSub(this.c2),a=i.redMul(this.d).redMul(this.c2).redSub(this.a),s=r.redMul(a.redInvm());if(0===s.cmp(this.zero)){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var o=s.redSqrt();if(0!==o.redSqr().redSub(s).cmp(this.zero))throw new Error("invalid point");return o.fromRed().isOdd()!==t&&(o=o.redNeg()),this.point(o,e)},l.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),i=e.y.redSqr(),r=t.redMul(this.a).redAdd(i),n=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(i)));return 0===r.cmp(n)},a(d,s.BasePoint),l.prototype.pointFromJSON=function(e){return d.fromJSON(this,e)},l.prototype.point=function(e,t,i,r){return new d(this,e,t,i,r)},d.fromJSON=function(e,t){return new d(e,t[0],t[1],t[2])},d.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},d.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},d.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var r=this.curve._mulA(e),n=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),a=r.redAdd(t),s=a.redSub(i),o=r.redSub(t),l=n.redMul(s),d=a.redMul(o),h=n.redMul(o),c=s.redMul(a);return this.curve.point(l,d,c,h)},d.prototype._projDbl=function(){var e,t,i,r=this.x.redAdd(this.y).redSqr(),n=this.x.redSqr(),a=this.y.redSqr();if(this.curve.twisted){var s=(d=this.curve._mulA(n)).redAdd(a);if(this.zOne)e=r.redSub(n).redSub(a).redMul(s.redSub(this.curve.two)),t=s.redMul(d.redSub(a)),i=s.redSqr().redSub(s).redSub(s);else{var o=this.z.redSqr(),l=s.redSub(o).redISub(o);e=r.redSub(n).redISub(a).redMul(l),t=s.redMul(d.redSub(a)),i=s.redMul(l)}}else{var d=n.redAdd(a);o=this.curve._mulC(this.z).redSqr(),l=d.redSub(o).redSub(o),e=this.curve._mulC(r.redISub(d)).redMul(l),t=this.curve._mulC(d).redMul(n.redISub(a)),i=d.redMul(l)}return this.curve.point(e,t,i)},d.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},d.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),r=this.t.redMul(this.curve.dd).redMul(e.t),n=this.z.redMul(e.z.redAdd(e.z)),a=i.redSub(t),s=n.redSub(r),o=n.redAdd(r),l=i.redAdd(t),d=a.redMul(s),h=o.redMul(l),c=a.redMul(l),u=s.redMul(o);return this.curve.point(d,h,u,c)},d.prototype._projAdd=function(e){var t,i,r=this.z.redMul(e.z),n=r.redSqr(),a=this.x.redMul(e.x),s=this.y.redMul(e.y),o=this.curve.d.redMul(a).redMul(s),l=n.redSub(o),d=n.redAdd(o),h=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(a).redISub(s),c=r.redMul(l).redMul(h);return this.curve.twisted?(t=r.redMul(d).redMul(s.redSub(this.curve._mulA(a))),i=l.redMul(d)):(t=r.redMul(d).redMul(s.redSub(a)),i=this.curve._mulC(l).redMul(d)),this.curve.point(c,t,i)},d.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},d.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},d.prototype.mulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!1)},d.prototype.jmulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!0)},d.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},d.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},d.prototype.getX=function(){return this.normalize(),this.x.fromRed()},d.prototype.getY=function(){return this.normalize(),this.y.fromRed()},d.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},d.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var i=e.clone(),r=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(r),0===this.x.cmp(t))return!0}},d.prototype.toP=d.prototype.normalize,d.prototype.mixedAdd=d.prototype.add},function(e,t,i){"use strict";t.sha1=i(339),t.sha224=i(340),t.sha256=i(217),t.sha384=i(341),t.sha512=i(218)},function(e,t,i){"use strict";var r=i(76),n=i(119),a=i(216),s=r.rotl32,o=r.sum32,l=r.sum32_5,d=a.ft_1,h=n.BlockHash,c=[1518500249,1859775393,2400959708,3395469782];function u(){if(!(this instanceof u))return new u;h.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}r.inherits(u,h),e.exports=u,u.blockSize=512,u.outSize=160,u.hmacStrength=80,u.padLength=64,u.prototype._update=function(e,t){for(var i=this.W,r=0;r<16;r++)i[r]=e[t+r];for(;r<i.length;r++)i[r]=s(i[r-3]^i[r-8]^i[r-14]^i[r-16],1);var n=this.h[0],a=this.h[1],h=this.h[2],u=this.h[3],f=this.h[4];for(r=0;r<i.length;r++){var m=~~(r/20),p=l(s(n,5),d(m,a,h,u),f,i[r],c[m]);f=u,u=h,h=s(a,30),a=n,n=p}this.h[0]=o(this.h[0],n),this.h[1]=o(this.h[1],a),this.h[2]=o(this.h[2],h),this.h[3]=o(this.h[3],u),this.h[4]=o(this.h[4],f)},u.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},function(e,t,i){"use strict";var r=i(76),n=i(217);function a(){if(!(this instanceof a))return new a;n.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}r.inherits(a,n),e.exports=a,a.blockSize=512,a.outSize=224,a.hmacStrength=192,a.padLength=64,a.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h.slice(0,7),"big"):r.split32(this.h.slice(0,7),"big")}},function(e,t,i){"use strict";var r=i(76),n=i(218);function a(){if(!(this instanceof a))return new a;n.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}r.inherits(a,n),e.exports=a,a.blockSize=1024,a.outSize=384,a.hmacStrength=192,a.padLength=128,a.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h.slice(0,12),"big"):r.split32(this.h.slice(0,12),"big")}},function(e,t,i){"use strict";var r=i(76),n=i(119),a=r.rotl32,s=r.sum32,o=r.sum32_3,l=r.sum32_4,d=n.BlockHash;function h(){if(!(this instanceof h))return new h;d.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function c(e,t,i,r){return e<=15?t^i^r:e<=31?t&i|~t&r:e<=47?(t|~i)^r:e<=63?t&r|i&~r:t^(i|~r)}function u(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function f(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}r.inherits(h,d),t.ripemd160=h,h.blockSize=512,h.outSize=160,h.hmacStrength=192,h.padLength=64,h.prototype._update=function(e,t){for(var i=this.h[0],r=this.h[1],n=this.h[2],d=this.h[3],h=this.h[4],v=i,y=r,b=n,S=d,T=h,w=0;w<80;w++){var M=s(a(l(i,c(w,r,n,d),e[m[w]+t],u(w)),g[w]),h);i=h,h=d,d=a(n,10),n=r,r=M,M=s(a(l(v,c(79-w,y,b,S),e[p[w]+t],f(w)),_[w]),T),v=T,T=S,S=a(b,10),b=y,y=M}M=o(this.h[1],n,S),this.h[1]=o(this.h[2],d,T),this.h[2]=o(this.h[3],h,v),this.h[3]=o(this.h[4],i,y),this.h[4]=o(this.h[0],r,b),this.h[0]=M},h.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"little"):r.split32(this.h,"little")};var m=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],g=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],_=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},function(e,t,i){"use strict";var r=i(76),n=i(65);function a(e,t,i){if(!(this instanceof a))return new a(e,t,i);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(r.toArray(t,i))}e.exports=a,a.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),n(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},a.prototype.update=function(e,t){return this.inner.update(e,t),this},a.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},function(e,t){e.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},function(e,t,i){"use strict";var r=i(84),n=i(346),a=i(66),s=i(158),o=i(154),l=a.assert,d=i(347),h=i(348);function c(e){if(!(this instanceof c))return new c(e);"string"==typeof e&&(l(s.hasOwnProperty(e),"Unknown curve "+e),e=s[e]),e instanceof s.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}e.exports=c,c.prototype.keyPair=function(e){return new d(this,e)},c.prototype.keyFromPrivate=function(e,t){return d.fromPrivate(this,e,t)},c.prototype.keyFromPublic=function(e,t){return d.fromPublic(this,e,t)},c.prototype.genKeyPair=function(e){e||(e={});for(var t=new n({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||o(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),a=this.n.sub(new r(2));;){var s=new r(t.generate(i));if(!(s.cmp(a)>0))return s.iaddn(1),this.keyFromPrivate(s)}},c.prototype._truncateToN=function(e,t){var i=8*e.byteLength()-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},c.prototype.sign=function(e,t,i,a){"object"==typeof i&&(a=i,i=null),a||(a={}),t=this.keyFromPrivate(t,i),e=this._truncateToN(new r(e,16));for(var s=this.n.byteLength(),o=t.getPrivate().toArray("be",s),l=e.toArray("be",s),d=new n({hash:this.hash,entropy:o,nonce:l,pers:a.pers,persEnc:a.persEnc||"utf8"}),c=this.n.sub(new r(1)),u=0;;u++){var f=a.k?a.k(u):new r(d.generate(this.n.byteLength()));if(!((f=this._truncateToN(f,!0)).cmpn(1)<=0||f.cmp(c)>=0)){var m=this.g.mul(f);if(!m.isInfinity()){var p=m.getX(),g=p.umod(this.n);if(0!==g.cmpn(0)){var _=f.invm(this.n).mul(g.mul(t.getPrivate()).iadd(e));if(0!==(_=_.umod(this.n)).cmpn(0)){var v=(m.getY().isOdd()?1:0)|(0!==p.cmp(g)?2:0);return a.canonical&&_.cmp(this.nh)>0&&(_=this.n.sub(_),v^=1),new h({r:g,s:_,recoveryParam:v})}}}}}},c.prototype.verify=function(e,t,i,n){e=this._truncateToN(new r(e,16)),i=this.keyFromPublic(i,n);var a=(t=new h(t,"hex")).r,s=t.s;if(a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;var o,l=s.invm(this.n),d=l.mul(e).umod(this.n),c=l.mul(a).umod(this.n);return this.curve._maxwellTrick?!(o=this.g.jmulAdd(d,i.getPublic(),c)).isInfinity()&&o.eqXToP(a):!(o=this.g.mulAdd(d,i.getPublic(),c)).isInfinity()&&0===o.getX().umod(this.n).cmp(a)},c.prototype.recoverPubKey=function(e,t,i,n){l((3&i)===i,"The recovery param is more than two bits"),t=new h(t,n);var a=this.n,s=new r(e),o=t.r,d=t.s,c=1&i,u=i>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");o=u?this.curve.pointFromX(o.add(this.curve.n),c):this.curve.pointFromX(o,c);var f=t.r.invm(a),m=a.sub(s).mul(f).umod(a),p=d.mul(f).umod(a);return this.g.mulAdd(m,o,p)},c.prototype.getKeyRecoveryParam=function(e,t,i,r){if(null!==(t=new h(t,r)).recoveryParam)return t.recoveryParam;for(var n=0;n<4;n++){var a;try{a=this.recoverPubKey(e,t,n)}catch(e){continue}if(a.eq(i))return n}throw new Error("Unable to find valid recovery factor")}},function(e,t,i){"use strict";var r=i(159),n=i(214),a=i(65);function s(e){if(!(this instanceof s))return new s(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=n.toArray(e.entropy,e.entropyEnc||"hex"),i=n.toArray(e.nonce,e.nonceEnc||"hex"),r=n.toArray(e.pers,e.persEnc||"hex");a(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,i,r)}e.exports=s,s.prototype._init=function(e,t,i){var r=e.concat(t).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var n=0;n<this.V.length;n++)this.K[n]=0,this.V[n]=1;this._update(r),this._reseed=1,this.reseedInterval=281474976710656},s.prototype._hmac=function(){return new r.hmac(this.hash,this.K)},s.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},s.prototype.reseed=function(e,t,i,r){"string"!=typeof t&&(r=i,i=t,t=null),e=n.toArray(e,t),i=n.toArray(i,r),a(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1},s.prototype.generate=function(e,t,i,r){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof t&&(r=i,i=t,t=null),i&&(i=n.toArray(i,r||"hex"),this._update(i));for(var a=[];a.length<e;)this.V=this._hmac().update(this.V).digest(),a=a.concat(this.V);var s=a.slice(0,e);return this._update(i),this._reseed++,n.encode(s,t)}},function(e,t,i){"use strict";var r=i(84),n=i(66).assert;function a(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}e.exports=a,a.fromPublic=function(e,t,i){return t instanceof a?t:new a(e,{pub:t,pubEnc:i})},a.fromPrivate=function(e,t,i){return t instanceof a?t:new a(e,{priv:t,privEnc:i})},a.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},a.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},a.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},a.prototype._importPrivate=function(e,t){this.priv=new r(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},a.prototype._importPublic=function(e,t){if(e.x||e.y)return"mont"===this.ec.curve.type?n(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||n(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},a.prototype.derive=function(e){return e.mul(this.priv).getX()},a.prototype.sign=function(e,t,i){return this.ec.sign(e,this,t,i)},a.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},a.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},function(e,t,i){"use strict";var r=i(84),n=i(66),a=n.assert;function s(e,t){if(e instanceof s)return e;this._importDER(e,t)||(a(e.r&&e.s,"Signature without r or s"),this.r=new r(e.r,16),this.s=new r(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function o(){this.place=0}function l(e,t){var i=e[t.place++];if(!(128&i))return i;var r=15&i;if(0===r||r>4)return!1;for(var n=0,a=0,s=t.place;a<r;a++,s++)n<<=8,n|=e[s],n>>>=0;return!(n<=127)&&(t.place=s,n)}function d(e){for(var t=0,i=e.length-1;!e[t]&&!(128&e[t+1])&&t<i;)t++;return 0===t?e:e.slice(t)}function h(e,t){if(t<128)e.push(t);else{var i=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|i);--i;)e.push(t>>>(i<<3)&255);e.push(t)}}e.exports=s,s.prototype._importDER=function(e,t){e=n.toArray(e,t);var i=new o;if(48!==e[i.place++])return!1;var a=l(e,i);if(!1===a)return!1;if(a+i.place!==e.length)return!1;if(2!==e[i.place++])return!1;var s=l(e,i);if(!1===s)return!1;var d=e.slice(i.place,s+i.place);if(i.place+=s,2!==e[i.place++])return!1;var h=l(e,i);if(!1===h)return!1;if(e.length!==h+i.place)return!1;var c=e.slice(i.place,h+i.place);if(0===d[0]){if(!(128&d[1]))return!1;d=d.slice(1)}if(0===c[0]){if(!(128&c[1]))return!1;c=c.slice(1)}return this.r=new r(d),this.s=new r(c),this.recoveryParam=null,!0},s.prototype.toDER=function(e){var t=this.r.toArray(),i=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&i[0]&&(i=[0].concat(i)),t=d(t),i=d(i);!(i[0]||128&i[1]);)i=i.slice(1);var r=[2];h(r,t.length),(r=r.concat(t)).push(2),h(r,i.length);var a=r.concat(i),s=[48];return h(s,a.length),s=s.concat(a),n.encode(s,e)}},function(e,t,i){"use strict";var r=i(159),n=i(158),a=i(66),s=a.assert,o=a.parseBytes,l=i(350),d=i(351);function h(e){if(s("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof h))return new h(e);e=n[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=r.sha512}e.exports=h,h.prototype.sign=function(e,t){e=o(e);var i=this.keyFromSecret(t),r=this.hashInt(i.messagePrefix(),e),n=this.g.mul(r),a=this.encodePoint(n),s=this.hashInt(a,i.pubBytes(),e).mul(i.priv()),l=r.add(s).umod(this.curve.n);return this.makeSignature({R:n,S:l,Rencoded:a})},h.prototype.verify=function(e,t,i){e=o(e),t=this.makeSignature(t);var r=this.keyFromPublic(i),n=this.hashInt(t.Rencoded(),r.pubBytes(),e),a=this.g.mul(t.S());return t.R().add(r.pub().mul(n)).eq(a)},h.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return a.intFromLE(e.digest()).umod(this.curve.n)},h.prototype.keyFromPublic=function(e){return l.fromPublic(this,e)},h.prototype.keyFromSecret=function(e){return l.fromSecret(this,e)},h.prototype.makeSignature=function(e){return e instanceof d?e:new d(this,e)},h.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},h.prototype.decodePoint=function(e){var t=(e=a.parseBytes(e)).length-1,i=e.slice(0,t).concat(-129&e[t]),r=0!=(128&e[t]),n=a.intFromLE(i);return this.curve.pointFromY(n,r)},h.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},h.prototype.decodeInt=function(e){return a.intFromLE(e)},h.prototype.isPoint=function(e){return e instanceof this.pointClass}},function(e,t,i){"use strict";var r=i(66),n=r.assert,a=r.parseBytes,s=r.cachedProperty;function o(e,t){this.eddsa=e,this._secret=a(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=a(t.pub)}o.fromPublic=function(e,t){return t instanceof o?t:new o(e,{pub:t})},o.fromSecret=function(e,t){return t instanceof o?t:new o(e,{secret:t})},o.prototype.secret=function(){return this._secret},s(o,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),s(o,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),s(o,"privBytes",(function(){var e=this.eddsa,t=this.hash(),i=e.encodingLength-1,r=t.slice(0,e.encodingLength);return r[0]&=248,r[i]&=127,r[i]|=64,r})),s(o,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),s(o,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),s(o,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),o.prototype.sign=function(e){return n(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},o.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},o.prototype.getSecret=function(e){return n(this._secret,"KeyPair is public only"),r.encode(this.secret(),e)},o.prototype.getPublic=function(e){return r.encode(this.pubBytes(),e)},e.exports=o},function(e,t,i){"use strict";var r=i(84),n=i(66),a=n.assert,s=n.cachedProperty,o=n.parseBytes;function l(e,t){this.eddsa=e,"object"!=typeof t&&(t=o(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),a(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof r&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}s(l,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),s(l,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),s(l,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),s(l,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),l.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},l.prototype.toHex=function(){return n.encode(this.toBytes(),"hex").toUpperCase()},e.exports=l},function(e,t){},function(e,t,i){"use strict";var r=i(120);t.certificate=i(365);var n=r.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}));t.RSAPrivateKey=n;var a=r.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}));t.RSAPublicKey=a;var s=r.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(o),this.key("subjectPublicKey").bitstr())}));t.PublicKey=s;var o=r.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())})),l=r.define("PrivateKeyInfo",(function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(o),this.key("subjectPrivateKey").octstr())}));t.PrivateKey=l;var d=r.define("EncryptedPrivateKeyInfo",(function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())}));t.EncryptedPrivateKey=d;var h=r.define("DSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())}));t.DSAPrivateKey=h,t.DSAparam=r.define("DSAparam",(function(){this.int()}));var c=r.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(u),this.key("publicKey").optional().explicit(1).bitstr())}));t.ECPrivateKey=c;var u=r.define("ECParameters",(function(){this.choice({namedCurve:this.objid()})}));t.signature=r.define("signature",(function(){this.seq().obj(this.key("r").int(),this.key("s").int())}))},function(e,t,i){(function(e){!function(e,t){"use strict";function r(e,t){if(!e)throw new Error(t||"Assertion failed")}function n(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function a(e,t,i){if(a.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(i=t,t=10),this._init(e||0,t||10,i||"be"))}var s;"object"==typeof e?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;try{s=i(355).Buffer}catch(e){}function o(e,t,i){for(var r=0,n=Math.min(e.length,i),a=t;a<n;a++){var s=e.charCodeAt(a)-48;r<<=4,r|=s>=49&&s<=54?s-49+10:s>=17&&s<=22?s-17+10:15&s}return r}function l(e,t,i,r){for(var n=0,a=Math.min(e.length,i),s=t;s<a;s++){var o=e.charCodeAt(s)-48;n*=r,n+=o>=49?o-49+10:o>=17?o-17+10:o}return n}a.isBN=function(e){return e instanceof a||null!==e&&"object"==typeof e&&e.constructor.wordSize===a.wordSize&&Array.isArray(e.words)},a.max=function(e,t){return e.cmp(t)>0?e:t},a.min=function(e,t){return e.cmp(t)<0?e:t},a.prototype._init=function(e,t,i){if("number"==typeof e)return this._initNumber(e,t,i);if("object"==typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36);var n=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&n++,16===t?this._parseHex(e,n):this._parseBase(e,t,n),"-"===e[0]&&(this.negative=1),this.strip(),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(r(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initArray=function(e,t,i){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var a,s,o=0;if("be"===i)for(n=e.length-1,a=0;n>=0;n-=3)s=e[n]|e[n-1]<<8|e[n-2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);else if("le"===i)for(n=0,a=0;n<e.length;n+=3)s=e[n]|e[n+1]<<8|e[n+2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);return this.strip()},a.prototype._parseHex=function(e,t){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var r,n,a=0;for(i=e.length-6,r=0;i>=t;i-=6)n=o(e,i,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303,(a+=24)>=26&&(a-=26,r++);i+6!==t&&(n=o(e,t,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303),this.strip()},a.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var r=0,n=1;n<=67108863;n*=t)r++;r--,n=n/t|0;for(var a=e.length-i,s=a%r,o=Math.min(a,a-s)+i,d=0,h=i;h<o;h+=r)d=l(e,h,h+r,t),this.imuln(n),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d);if(0!==s){var c=1;for(d=l(e,h,e.length,t),h=0;h<s;h++)c*=t;this.imuln(c),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d)}},a.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},a.prototype.clone=function(){var e=new a(null);return this.copy(e),e},a.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},a.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],c=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function u(e,t,i){i.negative=t.negative^e.negative;var r=e.length+t.length|0;i.length=r,r=r-1|0;var n=0|e.words[0],a=0|t.words[0],s=n*a,o=67108863&s,l=s/67108864|0;i.words[0]=o;for(var d=1;d<r;d++){for(var h=l>>>26,c=67108863&l,u=Math.min(d,t.length-1),f=Math.max(0,d-e.length+1);f<=u;f++){var m=d-f|0;h+=(s=(n=0|e.words[m])*(a=0|t.words[f])+c)/67108864|0,c=67108863&s}i.words[d]=0|c,l=0|h}return 0!==l?i.words[d]=0|l:i.length--,i.strip()}a.prototype.toString=function(e,t){var i;if(t=0|t||1,16===(e=e||10)||"hex"===e){i="";for(var n=0,a=0,s=0;s<this.length;s++){var o=this.words[s],l=(16777215&(o<<n|a)).toString(16);i=0!=(a=o>>>24-n&16777215)||s!==this.length-1?d[6-l.length]+l+i:l+i,(n+=2)>=26&&(n-=26,s--)}for(0!==a&&(i=a.toString(16)+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var u=h[e],f=c[e];i="";var m=this.clone();for(m.negative=0;!m.isZero();){var p=m.modn(f).toString(e);i=(m=m.idivn(f)).isZero()?p+i:d[u-p.length]+p+i}for(this.isZero()&&(i="0"+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(e,t){return r(void 0!==s),this.toArrayLike(s,e,t)},a.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},a.prototype.toArrayLike=function(e,t,i){var n=this.byteLength(),a=i||Math.max(1,n);r(n<=a,"byte array longer than desired length"),r(a>0,"Requested array length <= 0"),this.strip();var s,o,l="le"===t,d=new e(a),h=this.clone();if(l){for(o=0;!h.isZero();o++)s=h.andln(255),h.iushrn(8),d[o]=s;for(;o<a;o++)d[o]=0}else{for(o=0;o<a-n;o++)d[o]=0;for(o=0;!h.isZero();o++)s=h.andln(255),h.iushrn(8),d[a-o-1]=s}return d},Math.clz32?a.prototype._countBits=function(e){return 32-Math.clz32(e)}:a.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},a.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return 0==(8191&t)&&(i+=13,t>>>=13),0==(127&t)&&(i+=7,t>>>=7),0==(15&t)&&(i+=4,t>>>=4),0==(3&t)&&(i+=2,t>>>=2),0==(1&t)&&i++,i},a.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},a.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return 0!==this.negative},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},a.prototype.ior=function(e){return r(0==(this.negative|e.negative)),this.iuor(e)},a.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},a.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},a.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this.strip()},a.prototype.iand=function(e){return r(0==(this.negative|e.negative)),this.iuand(e)},a.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},a.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},a.prototype.iuxor=function(e){var t,i;this.length>e.length?(t=this,i=e):(t=e,i=this);for(var r=0;r<i.length;r++)this.words[r]=t.words[r]^i.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this.strip()},a.prototype.ixor=function(e){return r(0==(this.negative|e.negative)),this.iuxor(e)},a.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},a.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},a.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var n=0;n<t;n++)this.words[n]=67108863&~this.words[n];return i>0&&(this.words[n]=~this.words[n]&67108863>>26-i),this.strip()},a.prototype.notn=function(e){return this.clone().inotn(e)},a.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var i=e/26|0,n=e%26;return this._expand(i+1),this.words[i]=t?this.words[i]|1<<n:this.words[i]&~(1<<n),this.strip()},a.prototype.iadd=function(e){var t,i,r;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,r=e):(i=e,r=this);for(var n=0,a=0;a<r.length;a++)t=(0|i.words[a])+(0|r.words[a])+n,this.words[a]=67108863&t,n=t>>>26;for(;0!==n&&a<i.length;a++)t=(0|i.words[a])+n,this.words[a]=67108863&t,n=t>>>26;if(this.length=i.length,0!==n)this.words[this.length]=n,this.length++;else if(i!==this)for(;a<i.length;a++)this.words[a]=i.words[a];return this},a.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},a.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var i,r,n=this.cmp(e);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(i=this,r=e):(i=e,r=this);for(var a=0,s=0;s<r.length;s++)a=(t=(0|i.words[s])-(0|r.words[s])+a)>>26,this.words[s]=67108863&t;for(;0!==a&&s<i.length;s++)a=(t=(0|i.words[s])+a)>>26,this.words[s]=67108863&t;if(0===a&&s<i.length&&i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this.length=Math.max(this.length,s),i!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(e){return this.clone().isub(e)};var f=function(e,t,i){var r,n,a,s=e.words,o=t.words,l=i.words,d=0,h=0|s[0],c=8191&h,u=h>>>13,f=0|s[1],m=8191&f,p=f>>>13,g=0|s[2],_=8191&g,v=g>>>13,y=0|s[3],b=8191&y,S=y>>>13,T=0|s[4],w=8191&T,M=T>>>13,C=0|s[5],I=8191&C,P=C>>>13,E=0|s[6],x=8191&E,A=E>>>13,k=0|s[7],R=8191&k,O=k>>>13,L=0|s[8],F=8191&L,D=L>>>13,B=0|s[9],N=8191&B,V=B>>>13,U=0|o[0],W=8191&U,z=U>>>13,G=0|o[1],j=8191&G,H=G>>>13,q=0|o[2],$=8191&q,Z=q>>>13,X=0|o[3],Y=8191&X,J=X>>>13,K=0|o[4],Q=8191&K,ee=K>>>13,te=0|o[5],ie=8191&te,re=te>>>13,ne=0|o[6],ae=8191&ne,se=ne>>>13,oe=0|o[7],le=8191&oe,de=oe>>>13,he=0|o[8],ce=8191&he,ue=he>>>13,fe=0|o[9],me=8191&fe,pe=fe>>>13;i.negative=e.negative^t.negative,i.length=19;var ge=(d+(r=Math.imul(c,W))|0)+((8191&(n=(n=Math.imul(c,z))+Math.imul(u,W)|0))<<13)|0;d=((a=Math.imul(u,z))+(n>>>13)|0)+(ge>>>26)|0,ge&=67108863,r=Math.imul(m,W),n=(n=Math.imul(m,z))+Math.imul(p,W)|0,a=Math.imul(p,z);var _e=(d+(r=r+Math.imul(c,j)|0)|0)+((8191&(n=(n=n+Math.imul(c,H)|0)+Math.imul(u,j)|0))<<13)|0;d=((a=a+Math.imul(u,H)|0)+(n>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(_,W),n=(n=Math.imul(_,z))+Math.imul(v,W)|0,a=Math.imul(v,z),r=r+Math.imul(m,j)|0,n=(n=n+Math.imul(m,H)|0)+Math.imul(p,j)|0,a=a+Math.imul(p,H)|0;var ve=(d+(r=r+Math.imul(c,$)|0)|0)+((8191&(n=(n=n+Math.imul(c,Z)|0)+Math.imul(u,$)|0))<<13)|0;d=((a=a+Math.imul(u,Z)|0)+(n>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(b,W),n=(n=Math.imul(b,z))+Math.imul(S,W)|0,a=Math.imul(S,z),r=r+Math.imul(_,j)|0,n=(n=n+Math.imul(_,H)|0)+Math.imul(v,j)|0,a=a+Math.imul(v,H)|0,r=r+Math.imul(m,$)|0,n=(n=n+Math.imul(m,Z)|0)+Math.imul(p,$)|0,a=a+Math.imul(p,Z)|0;var ye=(d+(r=r+Math.imul(c,Y)|0)|0)+((8191&(n=(n=n+Math.imul(c,J)|0)+Math.imul(u,Y)|0))<<13)|0;d=((a=a+Math.imul(u,J)|0)+(n>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(w,W),n=(n=Math.imul(w,z))+Math.imul(M,W)|0,a=Math.imul(M,z),r=r+Math.imul(b,j)|0,n=(n=n+Math.imul(b,H)|0)+Math.imul(S,j)|0,a=a+Math.imul(S,H)|0,r=r+Math.imul(_,$)|0,n=(n=n+Math.imul(_,Z)|0)+Math.imul(v,$)|0,a=a+Math.imul(v,Z)|0,r=r+Math.imul(m,Y)|0,n=(n=n+Math.imul(m,J)|0)+Math.imul(p,Y)|0,a=a+Math.imul(p,J)|0;var be=(d+(r=r+Math.imul(c,Q)|0)|0)+((8191&(n=(n=n+Math.imul(c,ee)|0)+Math.imul(u,Q)|0))<<13)|0;d=((a=a+Math.imul(u,ee)|0)+(n>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(I,W),n=(n=Math.imul(I,z))+Math.imul(P,W)|0,a=Math.imul(P,z),r=r+Math.imul(w,j)|0,n=(n=n+Math.imul(w,H)|0)+Math.imul(M,j)|0,a=a+Math.imul(M,H)|0,r=r+Math.imul(b,$)|0,n=(n=n+Math.imul(b,Z)|0)+Math.imul(S,$)|0,a=a+Math.imul(S,Z)|0,r=r+Math.imul(_,Y)|0,n=(n=n+Math.imul(_,J)|0)+Math.imul(v,Y)|0,a=a+Math.imul(v,J)|0,r=r+Math.imul(m,Q)|0,n=(n=n+Math.imul(m,ee)|0)+Math.imul(p,Q)|0,a=a+Math.imul(p,ee)|0;var Se=(d+(r=r+Math.imul(c,ie)|0)|0)+((8191&(n=(n=n+Math.imul(c,re)|0)+Math.imul(u,ie)|0))<<13)|0;d=((a=a+Math.imul(u,re)|0)+(n>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul(x,W),n=(n=Math.imul(x,z))+Math.imul(A,W)|0,a=Math.imul(A,z),r=r+Math.imul(I,j)|0,n=(n=n+Math.imul(I,H)|0)+Math.imul(P,j)|0,a=a+Math.imul(P,H)|0,r=r+Math.imul(w,$)|0,n=(n=n+Math.imul(w,Z)|0)+Math.imul(M,$)|0,a=a+Math.imul(M,Z)|0,r=r+Math.imul(b,Y)|0,n=(n=n+Math.imul(b,J)|0)+Math.imul(S,Y)|0,a=a+Math.imul(S,J)|0,r=r+Math.imul(_,Q)|0,n=(n=n+Math.imul(_,ee)|0)+Math.imul(v,Q)|0,a=a+Math.imul(v,ee)|0,r=r+Math.imul(m,ie)|0,n=(n=n+Math.imul(m,re)|0)+Math.imul(p,ie)|0,a=a+Math.imul(p,re)|0;var Te=(d+(r=r+Math.imul(c,ae)|0)|0)+((8191&(n=(n=n+Math.imul(c,se)|0)+Math.imul(u,ae)|0))<<13)|0;d=((a=a+Math.imul(u,se)|0)+(n>>>13)|0)+(Te>>>26)|0,Te&=67108863,r=Math.imul(R,W),n=(n=Math.imul(R,z))+Math.imul(O,W)|0,a=Math.imul(O,z),r=r+Math.imul(x,j)|0,n=(n=n+Math.imul(x,H)|0)+Math.imul(A,j)|0,a=a+Math.imul(A,H)|0,r=r+Math.imul(I,$)|0,n=(n=n+Math.imul(I,Z)|0)+Math.imul(P,$)|0,a=a+Math.imul(P,Z)|0,r=r+Math.imul(w,Y)|0,n=(n=n+Math.imul(w,J)|0)+Math.imul(M,Y)|0,a=a+Math.imul(M,J)|0,r=r+Math.imul(b,Q)|0,n=(n=n+Math.imul(b,ee)|0)+Math.imul(S,Q)|0,a=a+Math.imul(S,ee)|0,r=r+Math.imul(_,ie)|0,n=(n=n+Math.imul(_,re)|0)+Math.imul(v,ie)|0,a=a+Math.imul(v,re)|0,r=r+Math.imul(m,ae)|0,n=(n=n+Math.imul(m,se)|0)+Math.imul(p,ae)|0,a=a+Math.imul(p,se)|0;var we=(d+(r=r+Math.imul(c,le)|0)|0)+((8191&(n=(n=n+Math.imul(c,de)|0)+Math.imul(u,le)|0))<<13)|0;d=((a=a+Math.imul(u,de)|0)+(n>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(F,W),n=(n=Math.imul(F,z))+Math.imul(D,W)|0,a=Math.imul(D,z),r=r+Math.imul(R,j)|0,n=(n=n+Math.imul(R,H)|0)+Math.imul(O,j)|0,a=a+Math.imul(O,H)|0,r=r+Math.imul(x,$)|0,n=(n=n+Math.imul(x,Z)|0)+Math.imul(A,$)|0,a=a+Math.imul(A,Z)|0,r=r+Math.imul(I,Y)|0,n=(n=n+Math.imul(I,J)|0)+Math.imul(P,Y)|0,a=a+Math.imul(P,J)|0,r=r+Math.imul(w,Q)|0,n=(n=n+Math.imul(w,ee)|0)+Math.imul(M,Q)|0,a=a+Math.imul(M,ee)|0,r=r+Math.imul(b,ie)|0,n=(n=n+Math.imul(b,re)|0)+Math.imul(S,ie)|0,a=a+Math.imul(S,re)|0,r=r+Math.imul(_,ae)|0,n=(n=n+Math.imul(_,se)|0)+Math.imul(v,ae)|0,a=a+Math.imul(v,se)|0,r=r+Math.imul(m,le)|0,n=(n=n+Math.imul(m,de)|0)+Math.imul(p,le)|0,a=a+Math.imul(p,de)|0;var Me=(d+(r=r+Math.imul(c,ce)|0)|0)+((8191&(n=(n=n+Math.imul(c,ue)|0)+Math.imul(u,ce)|0))<<13)|0;d=((a=a+Math.imul(u,ue)|0)+(n>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul(N,W),n=(n=Math.imul(N,z))+Math.imul(V,W)|0,a=Math.imul(V,z),r=r+Math.imul(F,j)|0,n=(n=n+Math.imul(F,H)|0)+Math.imul(D,j)|0,a=a+Math.imul(D,H)|0,r=r+Math.imul(R,$)|0,n=(n=n+Math.imul(R,Z)|0)+Math.imul(O,$)|0,a=a+Math.imul(O,Z)|0,r=r+Math.imul(x,Y)|0,n=(n=n+Math.imul(x,J)|0)+Math.imul(A,Y)|0,a=a+Math.imul(A,J)|0,r=r+Math.imul(I,Q)|0,n=(n=n+Math.imul(I,ee)|0)+Math.imul(P,Q)|0,a=a+Math.imul(P,ee)|0,r=r+Math.imul(w,ie)|0,n=(n=n+Math.imul(w,re)|0)+Math.imul(M,ie)|0,a=a+Math.imul(M,re)|0,r=r+Math.imul(b,ae)|0,n=(n=n+Math.imul(b,se)|0)+Math.imul(S,ae)|0,a=a+Math.imul(S,se)|0,r=r+Math.imul(_,le)|0,n=(n=n+Math.imul(_,de)|0)+Math.imul(v,le)|0,a=a+Math.imul(v,de)|0,r=r+Math.imul(m,ce)|0,n=(n=n+Math.imul(m,ue)|0)+Math.imul(p,ce)|0,a=a+Math.imul(p,ue)|0;var Ce=(d+(r=r+Math.imul(c,me)|0)|0)+((8191&(n=(n=n+Math.imul(c,pe)|0)+Math.imul(u,me)|0))<<13)|0;d=((a=a+Math.imul(u,pe)|0)+(n>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,r=Math.imul(N,j),n=(n=Math.imul(N,H))+Math.imul(V,j)|0,a=Math.imul(V,H),r=r+Math.imul(F,$)|0,n=(n=n+Math.imul(F,Z)|0)+Math.imul(D,$)|0,a=a+Math.imul(D,Z)|0,r=r+Math.imul(R,Y)|0,n=(n=n+Math.imul(R,J)|0)+Math.imul(O,Y)|0,a=a+Math.imul(O,J)|0,r=r+Math.imul(x,Q)|0,n=(n=n+Math.imul(x,ee)|0)+Math.imul(A,Q)|0,a=a+Math.imul(A,ee)|0,r=r+Math.imul(I,ie)|0,n=(n=n+Math.imul(I,re)|0)+Math.imul(P,ie)|0,a=a+Math.imul(P,re)|0,r=r+Math.imul(w,ae)|0,n=(n=n+Math.imul(w,se)|0)+Math.imul(M,ae)|0,a=a+Math.imul(M,se)|0,r=r+Math.imul(b,le)|0,n=(n=n+Math.imul(b,de)|0)+Math.imul(S,le)|0,a=a+Math.imul(S,de)|0,r=r+Math.imul(_,ce)|0,n=(n=n+Math.imul(_,ue)|0)+Math.imul(v,ce)|0,a=a+Math.imul(v,ue)|0;var Ie=(d+(r=r+Math.imul(m,me)|0)|0)+((8191&(n=(n=n+Math.imul(m,pe)|0)+Math.imul(p,me)|0))<<13)|0;d=((a=a+Math.imul(p,pe)|0)+(n>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,r=Math.imul(N,$),n=(n=Math.imul(N,Z))+Math.imul(V,$)|0,a=Math.imul(V,Z),r=r+Math.imul(F,Y)|0,n=(n=n+Math.imul(F,J)|0)+Math.imul(D,Y)|0,a=a+Math.imul(D,J)|0,r=r+Math.imul(R,Q)|0,n=(n=n+Math.imul(R,ee)|0)+Math.imul(O,Q)|0,a=a+Math.imul(O,ee)|0,r=r+Math.imul(x,ie)|0,n=(n=n+Math.imul(x,re)|0)+Math.imul(A,ie)|0,a=a+Math.imul(A,re)|0,r=r+Math.imul(I,ae)|0,n=(n=n+Math.imul(I,se)|0)+Math.imul(P,ae)|0,a=a+Math.imul(P,se)|0,r=r+Math.imul(w,le)|0,n=(n=n+Math.imul(w,de)|0)+Math.imul(M,le)|0,a=a+Math.imul(M,de)|0,r=r+Math.imul(b,ce)|0,n=(n=n+Math.imul(b,ue)|0)+Math.imul(S,ce)|0,a=a+Math.imul(S,ue)|0;var Pe=(d+(r=r+Math.imul(_,me)|0)|0)+((8191&(n=(n=n+Math.imul(_,pe)|0)+Math.imul(v,me)|0))<<13)|0;d=((a=a+Math.imul(v,pe)|0)+(n>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,r=Math.imul(N,Y),n=(n=Math.imul(N,J))+Math.imul(V,Y)|0,a=Math.imul(V,J),r=r+Math.imul(F,Q)|0,n=(n=n+Math.imul(F,ee)|0)+Math.imul(D,Q)|0,a=a+Math.imul(D,ee)|0,r=r+Math.imul(R,ie)|0,n=(n=n+Math.imul(R,re)|0)+Math.imul(O,ie)|0,a=a+Math.imul(O,re)|0,r=r+Math.imul(x,ae)|0,n=(n=n+Math.imul(x,se)|0)+Math.imul(A,ae)|0,a=a+Math.imul(A,se)|0,r=r+Math.imul(I,le)|0,n=(n=n+Math.imul(I,de)|0)+Math.imul(P,le)|0,a=a+Math.imul(P,de)|0,r=r+Math.imul(w,ce)|0,n=(n=n+Math.imul(w,ue)|0)+Math.imul(M,ce)|0,a=a+Math.imul(M,ue)|0;var Ee=(d+(r=r+Math.imul(b,me)|0)|0)+((8191&(n=(n=n+Math.imul(b,pe)|0)+Math.imul(S,me)|0))<<13)|0;d=((a=a+Math.imul(S,pe)|0)+(n>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(N,Q),n=(n=Math.imul(N,ee))+Math.imul(V,Q)|0,a=Math.imul(V,ee),r=r+Math.imul(F,ie)|0,n=(n=n+Math.imul(F,re)|0)+Math.imul(D,ie)|0,a=a+Math.imul(D,re)|0,r=r+Math.imul(R,ae)|0,n=(n=n+Math.imul(R,se)|0)+Math.imul(O,ae)|0,a=a+Math.imul(O,se)|0,r=r+Math.imul(x,le)|0,n=(n=n+Math.imul(x,de)|0)+Math.imul(A,le)|0,a=a+Math.imul(A,de)|0,r=r+Math.imul(I,ce)|0,n=(n=n+Math.imul(I,ue)|0)+Math.imul(P,ce)|0,a=a+Math.imul(P,ue)|0;var xe=(d+(r=r+Math.imul(w,me)|0)|0)+((8191&(n=(n=n+Math.imul(w,pe)|0)+Math.imul(M,me)|0))<<13)|0;d=((a=a+Math.imul(M,pe)|0)+(n>>>13)|0)+(xe>>>26)|0,xe&=67108863,r=Math.imul(N,ie),n=(n=Math.imul(N,re))+Math.imul(V,ie)|0,a=Math.imul(V,re),r=r+Math.imul(F,ae)|0,n=(n=n+Math.imul(F,se)|0)+Math.imul(D,ae)|0,a=a+Math.imul(D,se)|0,r=r+Math.imul(R,le)|0,n=(n=n+Math.imul(R,de)|0)+Math.imul(O,le)|0,a=a+Math.imul(O,de)|0,r=r+Math.imul(x,ce)|0,n=(n=n+Math.imul(x,ue)|0)+Math.imul(A,ce)|0,a=a+Math.imul(A,ue)|0;var Ae=(d+(r=r+Math.imul(I,me)|0)|0)+((8191&(n=(n=n+Math.imul(I,pe)|0)+Math.imul(P,me)|0))<<13)|0;d=((a=a+Math.imul(P,pe)|0)+(n>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,r=Math.imul(N,ae),n=(n=Math.imul(N,se))+Math.imul(V,ae)|0,a=Math.imul(V,se),r=r+Math.imul(F,le)|0,n=(n=n+Math.imul(F,de)|0)+Math.imul(D,le)|0,a=a+Math.imul(D,de)|0,r=r+Math.imul(R,ce)|0,n=(n=n+Math.imul(R,ue)|0)+Math.imul(O,ce)|0,a=a+Math.imul(O,ue)|0;var ke=(d+(r=r+Math.imul(x,me)|0)|0)+((8191&(n=(n=n+Math.imul(x,pe)|0)+Math.imul(A,me)|0))<<13)|0;d=((a=a+Math.imul(A,pe)|0)+(n>>>13)|0)+(ke>>>26)|0,ke&=67108863,r=Math.imul(N,le),n=(n=Math.imul(N,de))+Math.imul(V,le)|0,a=Math.imul(V,de),r=r+Math.imul(F,ce)|0,n=(n=n+Math.imul(F,ue)|0)+Math.imul(D,ce)|0,a=a+Math.imul(D,ue)|0;var Re=(d+(r=r+Math.imul(R,me)|0)|0)+((8191&(n=(n=n+Math.imul(R,pe)|0)+Math.imul(O,me)|0))<<13)|0;d=((a=a+Math.imul(O,pe)|0)+(n>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul(N,ce),n=(n=Math.imul(N,ue))+Math.imul(V,ce)|0,a=Math.imul(V,ue);var Oe=(d+(r=r+Math.imul(F,me)|0)|0)+((8191&(n=(n=n+Math.imul(F,pe)|0)+Math.imul(D,me)|0))<<13)|0;d=((a=a+Math.imul(D,pe)|0)+(n>>>13)|0)+(Oe>>>26)|0,Oe&=67108863;var Le=(d+(r=Math.imul(N,me))|0)+((8191&(n=(n=Math.imul(N,pe))+Math.imul(V,me)|0))<<13)|0;return d=((a=Math.imul(V,pe))+(n>>>13)|0)+(Le>>>26)|0,Le&=67108863,l[0]=ge,l[1]=_e,l[2]=ve,l[3]=ye,l[4]=be,l[5]=Se,l[6]=Te,l[7]=we,l[8]=Me,l[9]=Ce,l[10]=Ie,l[11]=Pe,l[12]=Ee,l[13]=xe,l[14]=Ae,l[15]=ke,l[16]=Re,l[17]=Oe,l[18]=Le,0!==d&&(l[19]=d,i.length++),i};function m(e,t,i){return(new p).mulp(e,t,i)}function p(e,t){this.x=e,this.y=t}Math.imul||(f=u),a.prototype.mulTo=function(e,t){var i=this.length+e.length;return 10===this.length&&10===e.length?f(this,e,t):i<63?u(this,e,t):i<1024?function(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var r=0,n=0,a=0;a<i.length-1;a++){var s=n;n=0;for(var o=67108863&r,l=Math.min(a,t.length-1),d=Math.max(0,a-e.length+1);d<=l;d++){var h=a-d,c=(0|e.words[h])*(0|t.words[d]),u=67108863&c;o=67108863&(u=u+o|0),n+=(s=(s=s+(c/67108864|0)|0)+(u>>>26)|0)>>>26,s&=67108863}i.words[a]=o,r=s,s=n}return 0!==r?i.words[a]=r:i.length--,i.strip()}(this,e,t):m(this,e,t)},p.prototype.makeRBT=function(e){for(var t=new Array(e),i=a.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,i,e);return t},p.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var r=0,n=0;n<t;n++)r|=(1&e)<<t-n-1,e>>=1;return r},p.prototype.permute=function(e,t,i,r,n,a){for(var s=0;s<a;s++)r[s]=t[e[s]],n[s]=i[e[s]]},p.prototype.transform=function(e,t,i,r,n,a){this.permute(a,e,t,i,r,n);for(var s=1;s<n;s<<=1)for(var o=s<<1,l=Math.cos(2*Math.PI/o),d=Math.sin(2*Math.PI/o),h=0;h<n;h+=o)for(var c=l,u=d,f=0;f<s;f++){var m=i[h+f],p=r[h+f],g=i[h+f+s],_=r[h+f+s],v=c*g-u*_;_=c*_+u*g,g=v,i[h+f]=m+g,r[h+f]=p+_,i[h+f+s]=m-g,r[h+f+s]=p-_,f!==o&&(v=l*c-d*u,u=l*u+d*c,c=v)}},p.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),r=1&i,n=0;for(i=i/2|0;i;i>>>=1)n++;return 1<<n+1+r},p.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var r=0;r<i/2;r++){var n=e[r];e[r]=e[i-r-1],e[i-r-1]=n,n=t[r],t[r]=-t[i-r-1],t[i-r-1]=-n}},p.prototype.normalize13b=function(e,t){for(var i=0,r=0;r<t/2;r++){var n=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+i;e[r]=67108863&n,i=n<67108864?0:n/67108864|0}return e},p.prototype.convert13b=function(e,t,i,n){for(var a=0,s=0;s<t;s++)a+=0|e[s],i[2*s]=8191&a,a>>>=13,i[2*s+1]=8191&a,a>>>=13;for(s=2*t;s<n;++s)i[s]=0;r(0===a),r(0==(-8192&a))},p.prototype.stub=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0;return t},p.prototype.mulp=function(e,t,i){var r=2*this.guessLen13b(e.length,t.length),n=this.makeRBT(r),a=this.stub(r),s=new Array(r),o=new Array(r),l=new Array(r),d=new Array(r),h=new Array(r),c=new Array(r),u=i.words;u.length=r,this.convert13b(e.words,e.length,s,r),this.convert13b(t.words,t.length,d,r),this.transform(s,a,o,l,r,n),this.transform(d,a,h,c,r,n);for(var f=0;f<r;f++){var m=o[f]*h[f]-l[f]*c[f];l[f]=o[f]*c[f]+l[f]*h[f],o[f]=m}return this.conjugate(o,l,r),this.transform(o,l,u,a,r,n),this.conjugate(u,a,r),this.normalize13b(u,r),i.negative=e.negative^t.negative,i.length=e.length+t.length,i.strip()},a.prototype.mul=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},a.prototype.mulf=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),m(this,e,t)},a.prototype.imul=function(e){return this.clone().mulTo(e,this)},a.prototype.imuln=function(e){r("number"==typeof e),r(e<67108864);for(var t=0,i=0;i<this.length;i++){var n=(0|this.words[i])*e,a=(67108863&n)+(67108863&t);t>>=26,t+=n/67108864|0,t+=a>>>26,this.words[i]=67108863&a}return 0!==t&&(this.words[i]=t,this.length++),this},a.prototype.muln=function(e){return this.clone().imuln(e)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),i=0;i<t.length;i++){var r=i/26|0,n=i%26;t[i]=(e.words[r]&1<<n)>>>n}return t}(e);if(0===t.length)return new a(1);for(var i=this,r=0;r<t.length&&0===t[r];r++,i=i.sqr());if(++r<t.length)for(var n=i.sqr();r<t.length;r++,n=n.sqr())0!==t[r]&&(i=i.mul(n));return i},a.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,i=e%26,n=(e-i)/26,a=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(t=0;t<this.length;t++){var o=this.words[t]&a,l=(0|this.words[t])-o<<i;this.words[t]=l|s,s=o>>>26-i}s&&(this.words[t]=s,this.length++)}if(0!==n){for(t=this.length-1;t>=0;t--)this.words[t+n]=this.words[t];for(t=0;t<n;t++)this.words[t]=0;this.length+=n}return this.strip()},a.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},a.prototype.iushrn=function(e,t,i){var n;r("number"==typeof e&&e>=0),n=t?(t-t%26)/26:0;var a=e%26,s=Math.min((e-a)/26,this.length),o=67108863^67108863>>>a<<a,l=i;if(n-=s,n=Math.max(0,n),l){for(var d=0;d<s;d++)l.words[d]=this.words[d];l.length=s}if(0===s);else if(this.length>s)for(this.length-=s,d=0;d<this.length;d++)this.words[d]=this.words[d+s];else this.words[0]=0,this.length=1;var h=0;for(d=this.length-1;d>=0&&(0!==h||d>=n);d--){var c=0|this.words[d];this.words[d]=h<<26-a|c>>>a,h=c&o}return l&&0!==h&&(l.words[l.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(e,t,i){return r(0===this.negative),this.iushrn(e,t,i)},a.prototype.shln=function(e){return this.clone().ishln(e)},a.prototype.ushln=function(e){return this.clone().iushln(e)},a.prototype.shrn=function(e){return this.clone().ishrn(e)},a.prototype.ushrn=function(e){return this.clone().iushrn(e)},a.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26,n=1<<t;return!(this.length<=i||!(this.words[i]&n))},a.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==t&&i++,this.length=Math.min(i,this.length),0!==t){var n=67108863^67108863>>>t<<t;this.words[this.length-1]&=n}return this.strip()},a.prototype.maskn=function(e){return this.clone().imaskn(e)},a.prototype.iaddn=function(e){return r("number"==typeof e),r(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},a.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},a.prototype.isubn=function(e){if(r("number"==typeof e),r(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},a.prototype.addn=function(e){return this.clone().iaddn(e)},a.prototype.subn=function(e){return this.clone().isubn(e)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(e,t,i){var n,a,s=e.length+i;this._expand(s);var o=0;for(n=0;n<e.length;n++){a=(0|this.words[n+i])+o;var l=(0|e.words[n])*t;o=((a-=67108863&l)>>26)-(l/67108864|0),this.words[n+i]=67108863&a}for(;n<this.length-i;n++)o=(a=(0|this.words[n+i])+o)>>26,this.words[n+i]=67108863&a;if(0===o)return this.strip();for(r(-1===o),o=0,n=0;n<this.length;n++)o=(a=-(0|this.words[n])+o)>>26,this.words[n]=67108863&a;return this.negative=1,this.strip()},a.prototype._wordDiv=function(e,t){var i=(this.length,e.length),r=this.clone(),n=e,s=0|n.words[n.length-1];0!=(i=26-this._countBits(s))&&(n=n.ushln(i),r.iushln(i),s=0|n.words[n.length-1]);var o,l=r.length-n.length;if("mod"!==t){(o=new a(null)).length=l+1,o.words=new Array(o.length);for(var d=0;d<o.length;d++)o.words[d]=0}var h=r.clone()._ishlnsubmul(n,1,l);0===h.negative&&(r=h,o&&(o.words[l]=1));for(var c=l-1;c>=0;c--){var u=67108864*(0|r.words[n.length+c])+(0|r.words[n.length+c-1]);for(u=Math.min(u/s|0,67108863),r._ishlnsubmul(n,u,c);0!==r.negative;)u--,r.negative=0,r._ishlnsubmul(n,1,c),r.isZero()||(r.negative^=1);o&&(o.words[c]=u)}return o&&o.strip(),r.strip(),"div"!==t&&0!==i&&r.iushrn(i),{div:o||null,mod:r}},a.prototype.divmod=function(e,t,i){return r(!e.isZero()),this.isZero()?{div:new a(0),mod:new a(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(n=o.div.neg()),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.iadd(e)),{div:n,mod:s}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(n=o.div.neg()),{div:n,mod:o.mod}):0!=(this.negative&e.negative)?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.isub(e)),{div:o.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new a(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new a(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new a(this.modn(e.words[0]))}:this._wordDiv(e,t);var n,s,o},a.prototype.div=function(e){return this.divmod(e,"div",!1).div},a.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},a.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},a.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),n=e.andln(1),a=i.cmp(r);return a<0||1===n&&0===a?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},a.prototype.modn=function(e){r(e<=67108863);for(var t=(1<<26)%e,i=0,n=this.length-1;n>=0;n--)i=(t*i+(0|this.words[n]))%e;return i},a.prototype.idivn=function(e){r(e<=67108863);for(var t=0,i=this.length-1;i>=0;i--){var n=(0|this.words[i])+67108864*t;this.words[i]=n/e|0,t=n%e}return this.strip()},a.prototype.divn=function(e){return this.clone().idivn(e)},a.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n=new a(1),s=new a(0),o=new a(0),l=new a(1),d=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++d;for(var h=i.clone(),c=t.clone();!t.isZero();){for(var u=0,f=1;0==(t.words[0]&f)&&u<26;++u,f<<=1);if(u>0)for(t.iushrn(u);u-- >0;)(n.isOdd()||s.isOdd())&&(n.iadd(h),s.isub(c)),n.iushrn(1),s.iushrn(1);for(var m=0,p=1;0==(i.words[0]&p)&&m<26;++m,p<<=1);if(m>0)for(i.iushrn(m);m-- >0;)(o.isOdd()||l.isOdd())&&(o.iadd(h),l.isub(c)),o.iushrn(1),l.iushrn(1);t.cmp(i)>=0?(t.isub(i),n.isub(o),s.isub(l)):(i.isub(t),o.isub(n),l.isub(s))}return{a:o,b:l,gcd:i.iushln(d)}},a.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n,s=new a(1),o=new a(0),l=i.clone();t.cmpn(1)>0&&i.cmpn(1)>0;){for(var d=0,h=1;0==(t.words[0]&h)&&d<26;++d,h<<=1);if(d>0)for(t.iushrn(d);d-- >0;)s.isOdd()&&s.iadd(l),s.iushrn(1);for(var c=0,u=1;0==(i.words[0]&u)&&c<26;++c,u<<=1);if(c>0)for(i.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(l),o.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(o)):(i.isub(t),o.isub(s))}return(n=0===t.cmpn(1)?s:o).cmpn(0)<0&&n.iadd(e),n},a.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var r=0;t.isEven()&&i.isEven();r++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var n=t.cmp(i);if(n<0){var a=t;t=i,i=a}else if(0===n||0===i.cmpn(1))break;t.isub(i)}return i.iushln(r)},a.prototype.invm=function(e){return this.egcd(e).a.umod(e)},a.prototype.isEven=function(){return 0==(1&this.words[0])},a.prototype.isOdd=function(){return 1==(1&this.words[0])},a.prototype.andln=function(e){return this.words[0]&e},a.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,i=(e-t)/26,n=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=n,this;for(var a=n,s=i;0!==a&&s<this.length;s++){var o=0|this.words[s];a=(o+=a)>>>26,o&=67108863,this.words[s]=o}return 0!==a&&(this.words[s]=a,this.length++),this},a.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},a.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)t=1;else{i&&(e=-e),r(e<=67108863,"Number is too big");var n=0|this.words[0];t=n===e?0:n<e?-1:1}return 0!==this.negative?0|-t:t},a.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},a.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,i=this.length-1;i>=0;i--){var r=0|this.words[i],n=0|e.words[i];if(r!==n){r<n?t=-1:r>n&&(t=1);break}}return t},a.prototype.gtn=function(e){return 1===this.cmpn(e)},a.prototype.gt=function(e){return 1===this.cmp(e)},a.prototype.gten=function(e){return this.cmpn(e)>=0},a.prototype.gte=function(e){return this.cmp(e)>=0},a.prototype.ltn=function(e){return-1===this.cmpn(e)},a.prototype.lt=function(e){return-1===this.cmp(e)},a.prototype.lten=function(e){return this.cmpn(e)<=0},a.prototype.lte=function(e){return this.cmp(e)<=0},a.prototype.eqn=function(e){return 0===this.cmpn(e)},a.prototype.eq=function(e){return 0===this.cmp(e)},a.red=function(e){return new T(e)},a.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},a.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(e){return this.red=e,this},a.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},a.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},a.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},a.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},a.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},a.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},a.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},a.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},a.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function _(e,t){this.name=e,this.p=new a(t,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function y(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function b(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function S(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function T(e){if("string"==typeof e){var t=a._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function w(e){T.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var e=new a(null);return e.words=new Array(Math.ceil(this.n/13)),e},_.prototype.ireduce=function(e){var t,i=e;do{this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(t>this.n);var r=t<this.n?-1:i.ucmp(this.p);return 0===r?(i.words[0]=0,i.length=1):r>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},_.prototype.split=function(e,t){e.iushrn(this.n,0,t)},_.prototype.imulK=function(e){return e.imul(this.k)},n(v,_),v.prototype.split=function(e,t){for(var i=Math.min(e.length,9),r=0;r<i;r++)t.words[r]=e.words[r];if(t.length=i,e.length<=9)return e.words[0]=0,void(e.length=1);var n=e.words[9];for(t.words[t.length++]=4194303&n,r=10;r<e.length;r++){var a=0|e.words[r];e.words[r-10]=(4194303&a)<<4|n>>>22,n=a}n>>>=22,e.words[r-10]=n,0===n&&e.length>10?e.length-=10:e.length-=9},v.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var r=0|e.words[i];t+=977*r,e.words[i]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},n(y,_),n(b,_),n(S,_),S.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var r=19*(0|e.words[i])+t,n=67108863&r;r>>>=26,e.words[i]=n,t=r}return 0!==t&&(e.words[e.length++]=t),e},a._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new v;else if("p224"===e)t=new y;else if("p192"===e)t=new b;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new S}return g[e]=t,t},T.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},T.prototype._verify2=function(e,t){r(0==(e.negative|t.negative),"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},T.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},T.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},T.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},T.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},T.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},T.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i},T.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},T.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},T.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},T.prototype.isqr=function(e){return this.imul(e,e.clone())},T.prototype.sqr=function(e){return this.mul(e,e)},T.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var i=this.m.add(new a(1)).iushrn(2);return this.pow(e,i)}for(var n=this.m.subn(1),s=0;!n.isZero()&&0===n.andln(1);)s++,n.iushrn(1);r(!n.isZero());var o=new a(1).toRed(this),l=o.redNeg(),d=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new a(2*h*h).toRed(this);0!==this.pow(h,d).cmp(l);)h.redIAdd(l);for(var c=this.pow(h,n),u=this.pow(e,n.addn(1).iushrn(1)),f=this.pow(e,n),m=s;0!==f.cmp(o);){for(var p=f,g=0;0!==p.cmp(o);g++)p=p.redSqr();r(g<m);var _=this.pow(c,new a(1).iushln(m-g-1));u=u.redMul(_),c=_.redSqr(),f=f.redMul(c),m=g}return u},T.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},T.prototype.pow=function(e,t){if(t.isZero())return new a(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=new Array(16);i[0]=new a(1).toRed(this),i[1]=e;for(var r=2;r<i.length;r++)i[r]=this.mul(i[r-1],e);var n=i[0],s=0,o=0,l=t.bitLength()%26;for(0===l&&(l=26),r=t.length-1;r>=0;r--){for(var d=t.words[r],h=l-1;h>=0;h--){var c=d>>h&1;n!==i[0]&&(n=this.sqr(n)),0!==c||0!==s?(s<<=1,s|=c,(4==++o||0===r&&0===h)&&(n=this.mul(n,i[s]),o=0,s=0)):o=0}l=26}return n},T.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},T.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},a.mont=function(e){return new w(e)},n(w,T),w.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},w.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},w.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),a=n;return n.cmp(this.m)>=0?a=n.isub(this.m):n.cmpn(0)<0&&(a=n.iadd(this.m)),a._forceRed(this)},w.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new a(0)._forceRed(this);var i=e.mul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},w.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,i(83)(e))},function(e,t){},function(e,t,i){var r=i(120),n=i(26);function a(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}t.define=function(e,t){return new a(e,t)},a.prototype._createNamed=function(e){var t;try{t=i(357).runInThisContext("(function "+this.name+"(entity) {\n  this._initNamed(entity);\n})")}catch(e){t=function(e){this._initNamed(e)}}return n(t,e),t.prototype._initNamed=function(t){e.call(this,t)},new t(this)},a.prototype._getDecoder=function(e){return e=e||"der",this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(r.decoders[e])),this.decoders[e]},a.prototype.decode=function(e,t,i){return this._getDecoder(t).decode(e,i)},a.prototype._getEncoder=function(e){return e=e||"der",this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(r.encoders[e])),this.encoders[e]},a.prototype.encode=function(e,t,i){return this._getEncoder(t).encode(e,i)}},function(module,exports){var indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var i=0;i<e.length;i++)if(e[i]===t)return i;return-1},Object_keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var i in e)t.push(i);return t},forEach=function(e,t){if(e.forEach)return e.forEach(t);for(var i=0;i<e.length;i++)t(e[i],i,e)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(e,t,i){Object.defineProperty(e,t,{writable:!0,enumerable:!1,configurable:!0,value:i})}}catch(e){return function(e,t,i){e[t]=i}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(e){if(!(this instanceof Script))return new Script(e);this.code=e};Script.prototype.runInContext=function(e){if(!(e instanceof Context))throw new TypeError("needs a 'context' argument.");var t=document.createElement("iframe");t.style||(t.style={}),t.style.display="none",document.body.appendChild(t);var i=t.contentWindow,r=i.eval,n=i.execScript;!r&&n&&(n.call(i,"null"),r=i.eval),forEach(Object_keys(e),(function(t){i[t]=e[t]})),forEach(globals,(function(t){e[t]&&(i[t]=e[t])}));var a=Object_keys(i),s=r.call(i,this.code);return forEach(Object_keys(i),(function(t){(t in e||-1===indexOf(a,t))&&(e[t]=i[t])})),forEach(globals,(function(t){t in e||defineProp(e,t,i[t])})),document.body.removeChild(t),s},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(e){var t=Script.createContext(e),i=this.runInContext(t);return e&&forEach(Object_keys(t),(function(i){e[i]=t[i]})),i},forEach(Object_keys(Script.prototype),(function(e){exports[e]=Script[e]=function(t){var i=Script(t);return i[e].apply(i,[].slice.call(arguments,1))}})),exports.isContext=function(e){return e instanceof Context},exports.createScript=function(e){return exports.Script(e)},exports.createContext=Script.createContext=function(e){var t=new Context;return"object"==typeof e&&forEach(Object_keys(e),(function(i){t[i]=e[i]})),t}},function(e,t,i){var r=i(26);function n(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}function a(e,t){this.path=e,this.rethrow(t)}t.Reporter=n,n.prototype.isError=function(e){return e instanceof a},n.prototype.save=function(){var e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}},n.prototype.restore=function(e){var t=this._reporterState;t.obj=e.obj,t.path=t.path.slice(0,e.pathLen)},n.prototype.enterKey=function(e){return this._reporterState.path.push(e)},n.prototype.exitKey=function(e){var t=this._reporterState;t.path=t.path.slice(0,e-1)},n.prototype.leaveKey=function(e,t,i){var r=this._reporterState;this.exitKey(e),null!==r.obj&&(r.obj[t]=i)},n.prototype.path=function(){return this._reporterState.path.join("/")},n.prototype.enterObject=function(){var e=this._reporterState,t=e.obj;return e.obj={},t},n.prototype.leaveObject=function(e){var t=this._reporterState,i=t.obj;return t.obj=e,i},n.prototype.error=function(e){var t,i=this._reporterState,r=e instanceof a;if(t=r?e:new a(i.path.map((function(e){return"["+JSON.stringify(e)+"]"})).join(""),e.message||e,e.stack),!i.options.partial)throw t;return r||i.errors.push(t),t},n.prototype.wrapResult=function(e){var t=this._reporterState;return t.options.partial?{result:this.isError(e)?null:e,errors:t.errors}:e},r(a,Error),a.prototype.rethrow=function(e){if(this.message=e+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,a),!this.stack)try{throw new Error(this.message)}catch(e){this.stack=e.stack}return this}},function(e,t,i){var r=i(121).Reporter,n=i(121).EncoderBuffer,a=i(121).DecoderBuffer,s=i(65),o=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],l=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(o);function d(e,t){var i={};this._baseState=i,i.enc=e,i.parent=t||null,i.children=null,i.tag=null,i.args=null,i.reverseArgs=null,i.choice=null,i.optional=!1,i.any=!1,i.obj=!1,i.use=null,i.useDecoder=null,i.key=null,i.default=null,i.explicit=null,i.implicit=null,i.contains=null,i.parent||(i.children=[],this._wrap())}e.exports=d;var h=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];d.prototype.clone=function(){var e=this._baseState,t={};h.forEach((function(i){t[i]=e[i]}));var i=new this.constructor(t.parent);return i._baseState=t,i},d.prototype._wrap=function(){var e=this._baseState;l.forEach((function(t){this[t]=function(){var i=new this.constructor(this);return e.children.push(i),i[t].apply(i,arguments)}}),this)},d.prototype._init=function(e){var t=this._baseState;s(null===t.parent),e.call(this),t.children=t.children.filter((function(e){return e._baseState.parent===this}),this),s.equal(t.children.length,1,"Root node can have only one child")},d.prototype._useArgs=function(e){var t=this._baseState,i=e.filter((function(e){return e instanceof this.constructor}),this);e=e.filter((function(e){return!(e instanceof this.constructor)}),this),0!==i.length&&(s(null===t.children),t.children=i,i.forEach((function(e){e._baseState.parent=this}),this)),0!==e.length&&(s(null===t.args),t.args=e,t.reverseArgs=e.map((function(e){if("object"!=typeof e||e.constructor!==Object)return e;var t={};return Object.keys(e).forEach((function(i){i==(0|i)&&(i|=0);var r=e[i];t[r]=i})),t})))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach((function(e){d.prototype[e]=function(){var t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}})),o.forEach((function(e){d.prototype[e]=function(){var t=this._baseState,i=Array.prototype.slice.call(arguments);return s(null===t.tag),t.tag=e,this._useArgs(i),this}})),d.prototype.use=function(e){s(e);var t=this._baseState;return s(null===t.use),t.use=e,this},d.prototype.optional=function(){return this._baseState.optional=!0,this},d.prototype.def=function(e){var t=this._baseState;return s(null===t.default),t.default=e,t.optional=!0,this},d.prototype.explicit=function(e){var t=this._baseState;return s(null===t.explicit&&null===t.implicit),t.explicit=e,this},d.prototype.implicit=function(e){var t=this._baseState;return s(null===t.explicit&&null===t.implicit),t.implicit=e,this},d.prototype.obj=function(){var e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},d.prototype.key=function(e){var t=this._baseState;return s(null===t.key),t.key=e,this},d.prototype.any=function(){return this._baseState.any=!0,this},d.prototype.choice=function(e){var t=this._baseState;return s(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map((function(t){return e[t]}))),this},d.prototype.contains=function(e){var t=this._baseState;return s(null===t.use),t.contains=e,this},d.prototype._decode=function(e,t){var i=this._baseState;if(null===i.parent)return e.wrapResult(i.children[0]._decode(e,t));var r,n=i.default,s=!0,o=null;if(null!==i.key&&(o=e.enterKey(i.key)),i.optional){var l=null;if(null!==i.explicit?l=i.explicit:null!==i.implicit?l=i.implicit:null!==i.tag&&(l=i.tag),null!==l||i.any){if(s=this._peekTag(e,l,i.any),e.isError(s))return s}else{var d=e.save();try{null===i.choice?this._decodeGeneric(i.tag,e,t):this._decodeChoice(e,t),s=!0}catch(e){s=!1}e.restore(d)}}if(i.obj&&s&&(r=e.enterObject()),s){if(null!==i.explicit){var h=this._decodeTag(e,i.explicit);if(e.isError(h))return h;e=h}var c=e.offset;if(null===i.use&&null===i.choice){i.any&&(d=e.save());var u=this._decodeTag(e,null!==i.implicit?i.implicit:i.tag,i.any);if(e.isError(u))return u;i.any?n=e.raw(d):e=u}if(t&&t.track&&null!==i.tag&&t.track(e.path(),c,e.length,"tagged"),t&&t.track&&null!==i.tag&&t.track(e.path(),e.offset,e.length,"content"),n=i.any?n:null===i.choice?this._decodeGeneric(i.tag,e,t):this._decodeChoice(e,t),e.isError(n))return n;if(i.any||null!==i.choice||null===i.children||i.children.forEach((function(i){i._decode(e,t)})),i.contains&&("octstr"===i.tag||"bitstr"===i.tag)){var f=new a(n);n=this._getUse(i.contains,e._reporterState.obj)._decode(f,t)}}return i.obj&&s&&(n=e.leaveObject(r)),null===i.key||null===n&&!0!==s?null!==o&&e.exitKey(o):e.leaveKey(o,i.key,n),n},d.prototype._decodeGeneric=function(e,t,i){var r=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,r.args[0],i):/str$/.test(e)?this._decodeStr(t,e,i):"objid"===e&&r.args?this._decodeObjid(t,r.args[0],r.args[1],i):"objid"===e?this._decodeObjid(t,null,null,i):"gentime"===e||"utctime"===e?this._decodeTime(t,e,i):"null_"===e?this._decodeNull(t,i):"bool"===e?this._decodeBool(t,i):"objDesc"===e?this._decodeStr(t,e,i):"int"===e||"enum"===e?this._decodeInt(t,r.args&&r.args[0],i):null!==r.use?this._getUse(r.use,t._reporterState.obj)._decode(t,i):t.error("unknown tag: "+e)},d.prototype._getUse=function(e,t){var i=this._baseState;return i.useDecoder=this._use(e,t),s(null===i.useDecoder._baseState.parent),i.useDecoder=i.useDecoder._baseState.children[0],i.implicit!==i.useDecoder._baseState.implicit&&(i.useDecoder=i.useDecoder.clone(),i.useDecoder._baseState.implicit=i.implicit),i.useDecoder},d.prototype._decodeChoice=function(e,t){var i=this._baseState,r=null,n=!1;return Object.keys(i.choice).some((function(a){var s=e.save(),o=i.choice[a];try{var l=o._decode(e,t);if(e.isError(l))return!1;r={type:a,value:l},n=!0}catch(t){return e.restore(s),!1}return!0}),this),n?r:e.error("Choice not matched")},d.prototype._createEncoderBuffer=function(e){return new n(e,this.reporter)},d.prototype._encode=function(e,t,i){var r=this._baseState;if(null===r.default||r.default!==e){var n=this._encodeValue(e,t,i);if(void 0!==n&&!this._skipDefault(n,t,i))return n}},d.prototype._encodeValue=function(e,t,i){var n=this._baseState;if(null===n.parent)return n.children[0]._encode(e,t||new r);var a=null;if(this.reporter=t,n.optional&&void 0===e){if(null===n.default)return;e=n.default}var s=null,o=!1;if(n.any)a=this._createEncoderBuffer(e);else if(n.choice)a=this._encodeChoice(e,t);else if(n.contains)s=this._getUse(n.contains,i)._encode(e,t),o=!0;else if(n.children)s=n.children.map((function(i){if("null_"===i._baseState.tag)return i._encode(null,t,e);if(null===i._baseState.key)return t.error("Child should have a key");var r=t.enterKey(i._baseState.key);if("object"!=typeof e)return t.error("Child expected, but input is not object");var n=i._encode(e[i._baseState.key],t,e);return t.leaveKey(r),n}),this).filter((function(e){return e})),s=this._createEncoderBuffer(s);else if("seqof"===n.tag||"setof"===n.tag){if(!n.args||1!==n.args.length)return t.error("Too many args for : "+n.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");var l=this.clone();l._baseState.implicit=null,s=this._createEncoderBuffer(e.map((function(i){var r=this._baseState;return this._getUse(r.args[0],e)._encode(i,t)}),l))}else null!==n.use?a=this._getUse(n.use,i)._encode(e,t):(s=this._encodePrimitive(n.tag,e),o=!0);if(!n.any&&null===n.choice){var d=null!==n.implicit?n.implicit:n.tag,h=null===n.implicit?"universal":"context";null===d?null===n.use&&t.error("Tag could be omitted only for .use()"):null===n.use&&(a=this._encodeComposite(d,o,h,s))}return null!==n.explicit&&(a=this._encodeComposite(n.explicit,!1,"context",a)),a},d.prototype._encodeChoice=function(e,t){var i=this._baseState,r=i.choice[e.type];return r||s(!1,e.type+" not found in "+JSON.stringify(Object.keys(i.choice))),r._encode(e.value,t)},d.prototype._encodePrimitive=function(e,t){var i=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&i.args)return this._encodeObjid(t,i.reverseArgs[0],i.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,i.args&&i.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw new Error("Unsupported tag: "+e)},d.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},d.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(e)}},function(e,t,i){var r=i(221);t.tagClass={0:"universal",1:"application",2:"context",3:"private"},t.tagClassByName=r._reverse(t.tagClass),t.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},t.tagByName=r._reverse(t.tag)},function(e,t,i){var r=t;r.der=i(222),r.pem=i(362)},function(e,t,i){var r=i(26),n=i(43).Buffer,a=i(222);function s(e){a.call(this,e),this.enc="pem"}r(s,a),e.exports=s,s.prototype.decode=function(e,t){for(var i=e.toString().split(/[\r\n]+/g),r=t.label.toUpperCase(),s=/^-----(BEGIN|END) ([^-]+)-----$/,o=-1,l=-1,d=0;d<i.length;d++){var h=i[d].match(s);if(null!==h&&h[2]===r){if(-1!==o){if("END"!==h[1])break;l=d;break}if("BEGIN"!==h[1])break;o=d}}if(-1===o||-1===l)throw new Error("PEM section not found for: "+r);var c=i.slice(o+1,l).join("");c.replace(/[^a-z0-9\+\/=]+/gi,"");var u=new n(c,"base64");return a.prototype.decode.call(this,u,t)}},function(e,t,i){var r=t;r.der=i(223),r.pem=i(364)},function(e,t,i){var r=i(26),n=i(223);function a(e){n.call(this,e),this.enc="pem"}r(a,n),e.exports=a,a.prototype.encode=function(e,t){for(var i=n.prototype.encode.call(this,e).toString("base64"),r=["-----BEGIN "+t.label+"-----"],a=0;a<i.length;a+=64)r.push(i.slice(a,a+64));return r.push("-----END "+t.label+"-----"),r.join("\n")}},function(e,t,i){"use strict";var r=i(120),n=r.define("Time",(function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})})),a=r.define("AttributeTypeValue",(function(){this.seq().obj(this.key("type").objid(),this.key("value").any())})),s=r.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())})),o=r.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(s),this.key("subjectPublicKey").bitstr())})),l=r.define("RelativeDistinguishedName",(function(){this.setof(a)})),d=r.define("RDNSequence",(function(){this.seqof(l)})),h=r.define("Name",(function(){this.choice({rdnSequence:this.use(d)})})),c=r.define("Validity",(function(){this.seq().obj(this.key("notBefore").use(n),this.key("notAfter").use(n))})),u=r.define("Extension",(function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())})),f=r.define("TBSCertificate",(function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(s),this.key("issuer").use(h),this.key("validity").use(c),this.key("subject").use(h),this.key("subjectPublicKeyInfo").use(o),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(u).optional())})),m=r.define("X509Certificate",(function(){this.seq().obj(this.key("tbsCertificate").use(f),this.key("signatureAlgorithm").use(s),this.key("signatureValue").bitstr())}));e.exports=m},function(e){e.exports=JSON.parse('{"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}')},function(e,t,i){var r=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r\+\/\=]+)[\n\r]+/m,n=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,a=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r\+\/\=]+)-----END \1-----$/m,s=i(129),o=i(152),l=i(29).Buffer;e.exports=function(e,t){var i,d=e.toString(),h=d.match(r);if(h){var c="aes"+h[1],u=l.from(h[2],"hex"),f=l.from(h[3].replace(/[\r\n]/g,""),"base64"),m=s(t,u.slice(0,8),parseInt(h[1],10)).key,p=[],g=o.createDecipheriv(c,m,u);p.push(g.update(f)),p.push(g.final()),i=l.concat(p)}else{var _=d.match(a);i=new l(_[2].replace(/[\r\n]/g,""),"base64")}return{tag:d.match(n)[1],data:i}}},function(e,t,i){var r=i(29).Buffer,n=i(219),a=i(157).ec,s=i(131),o=i(224);function l(e,t){if(e.cmpn(0)<=0)throw new Error("invalid sig");if(e.cmp(t)>=t)throw new Error("invalid sig")}e.exports=function(e,t,i,d,h){var c=s(i);if("ec"===c.type){if("ecdsa"!==d&&"ecdsa/rsa"!==d)throw new Error("wrong public key type");return function(e,t,i){var r=o[i.data.algorithm.curve.join(".")];if(!r)throw new Error("unknown curve "+i.data.algorithm.curve.join("."));var n=new a(r),s=i.data.subjectPrivateKey.data;return n.verify(t,e,s)}(e,t,c)}if("dsa"===c.type){if("dsa"!==d)throw new Error("wrong public key type");return function(e,t,i){var r=i.data.p,a=i.data.q,o=i.data.g,d=i.data.pub_key,h=s.signature.decode(e,"der"),c=h.s,u=h.r;l(c,a),l(u,a);var f=n.mont(r),m=c.invm(a);return 0===o.toRed(f).redPow(new n(t).mul(m).mod(a)).fromRed().mul(d.toRed(f).redPow(u.mul(m).mod(a)).fromRed()).mod(r).mod(a).cmp(u)}(e,t,c)}if("rsa"!==d&&"ecdsa/rsa"!==d)throw new Error("wrong public key type");t=r.concat([h,t]);for(var u=c.modulus.byteLength(),f=[1],m=0;t.length+f.length+2<u;)f.push(255),m++;f.push(0);for(var p=-1;++p<t.length;)f.push(t[p]);f=r.from(f);var g=n.mont(c.modulus);e=(e=new n(e).toRed(g)).redPow(new n(c.publicExponent)),e=r.from(e.fromRed().toArray());var _=m<8?1:0;for(u=Math.min(e.length,f.length),e.length!==f.length&&(_=1),p=-1;++p<u;)_|=e[p]^f[p];return 0===_}},function(e,t,i){(function(t){var r=i(157),n=i(370);e.exports=function(e){return new s(e)};var a={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function s(e){this.curveType=a[e],this.curveType||(this.curveType={name:e}),this.curve=new r.ec(this.curveType.name),this.keys=void 0}function o(e,i,r){Array.isArray(e)||(e=e.toArray());var n=new t(e);if(r&&n.length<r){var a=new t(r-n.length);a.fill(0),n=t.concat([a,n])}return i?n.toString(i):n}a.p224=a.secp224r1,a.p256=a.secp256r1=a.prime256v1,a.p192=a.secp192r1=a.prime192v1,a.p384=a.secp384r1,a.p521=a.secp521r1,s.prototype.generateKeys=function(e,t){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,t)},s.prototype.computeSecret=function(e,i,r){return i=i||"utf8",t.isBuffer(e)||(e=new t(e,i)),o(this.curve.keyFromPublic(e).getPublic().mul(this.keys.getPrivate()).getX(),r,this.curveType.byteLength)},s.prototype.getPublicKey=function(e,t){var i=this.keys.getPublic("compressed"===t,!0);return"hybrid"===t&&(i[i.length-1]%2?i[0]=7:i[0]=6),o(i,e)},s.prototype.getPrivateKey=function(e){return o(this.keys.getPrivate(),e)},s.prototype.setPublicKey=function(e,i){return i=i||"utf8",t.isBuffer(e)||(e=new t(e,i)),this.keys._importPublic(e),this},s.prototype.setPrivateKey=function(e,i){i=i||"utf8",t.isBuffer(e)||(e=new t(e,i));var r=new n(e);return r=r.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(r),this}}).call(this,i(43).Buffer)},function(e,t,i){(function(e){!function(e,t){"use strict";function r(e,t){if(!e)throw new Error(t||"Assertion failed")}function n(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function a(e,t,i){if(a.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(i=t,t=10),this._init(e||0,t||10,i||"be"))}var s;"object"==typeof e?e.exports=a:t.BN=a,a.BN=a,a.wordSize=26;try{s=i(371).Buffer}catch(e){}function o(e,t,i){for(var r=0,n=Math.min(e.length,i),a=t;a<n;a++){var s=e.charCodeAt(a)-48;r<<=4,r|=s>=49&&s<=54?s-49+10:s>=17&&s<=22?s-17+10:15&s}return r}function l(e,t,i,r){for(var n=0,a=Math.min(e.length,i),s=t;s<a;s++){var o=e.charCodeAt(s)-48;n*=r,n+=o>=49?o-49+10:o>=17?o-17+10:o}return n}a.isBN=function(e){return e instanceof a||null!==e&&"object"==typeof e&&e.constructor.wordSize===a.wordSize&&Array.isArray(e.words)},a.max=function(e,t){return e.cmp(t)>0?e:t},a.min=function(e,t){return e.cmp(t)<0?e:t},a.prototype._init=function(e,t,i){if("number"==typeof e)return this._initNumber(e,t,i);if("object"==typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36);var n=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&n++,16===t?this._parseHex(e,n):this._parseBase(e,t,n),"-"===e[0]&&(this.negative=1),this.strip(),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(r(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},a.prototype._initArray=function(e,t,i){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var a,s,o=0;if("be"===i)for(n=e.length-1,a=0;n>=0;n-=3)s=e[n]|e[n-1]<<8|e[n-2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);else if("le"===i)for(n=0,a=0;n<e.length;n+=3)s=e[n]|e[n+1]<<8|e[n+2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);return this.strip()},a.prototype._parseHex=function(e,t){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var r,n,a=0;for(i=e.length-6,r=0;i>=t;i-=6)n=o(e,i,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303,(a+=24)>=26&&(a-=26,r++);i+6!==t&&(n=o(e,t,i+6),this.words[r]|=n<<a&67108863,this.words[r+1]|=n>>>26-a&4194303),this.strip()},a.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var r=0,n=1;n<=67108863;n*=t)r++;r--,n=n/t|0;for(var a=e.length-i,s=a%r,o=Math.min(a,a-s)+i,d=0,h=i;h<o;h+=r)d=l(e,h,h+r,t),this.imuln(n),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d);if(0!==s){var c=1;for(d=l(e,h,e.length,t),h=0;h<s;h++)c*=t;this.imuln(c),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d)}},a.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},a.prototype.clone=function(){var e=new a(null);return this.copy(e),e},a.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},a.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],c=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function u(e,t,i){i.negative=t.negative^e.negative;var r=e.length+t.length|0;i.length=r,r=r-1|0;var n=0|e.words[0],a=0|t.words[0],s=n*a,o=67108863&s,l=s/67108864|0;i.words[0]=o;for(var d=1;d<r;d++){for(var h=l>>>26,c=67108863&l,u=Math.min(d,t.length-1),f=Math.max(0,d-e.length+1);f<=u;f++){var m=d-f|0;h+=(s=(n=0|e.words[m])*(a=0|t.words[f])+c)/67108864|0,c=67108863&s}i.words[d]=0|c,l=0|h}return 0!==l?i.words[d]=0|l:i.length--,i.strip()}a.prototype.toString=function(e,t){var i;if(t=0|t||1,16===(e=e||10)||"hex"===e){i="";for(var n=0,a=0,s=0;s<this.length;s++){var o=this.words[s],l=(16777215&(o<<n|a)).toString(16);i=0!=(a=o>>>24-n&16777215)||s!==this.length-1?d[6-l.length]+l+i:l+i,(n+=2)>=26&&(n-=26,s--)}for(0!==a&&(i=a.toString(16)+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var u=h[e],f=c[e];i="";var m=this.clone();for(m.negative=0;!m.isZero();){var p=m.modn(f).toString(e);i=(m=m.idivn(f)).isZero()?p+i:d[u-p.length]+p+i}for(this.isZero()&&(i="0"+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(e,t){return r(void 0!==s),this.toArrayLike(s,e,t)},a.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},a.prototype.toArrayLike=function(e,t,i){var n=this.byteLength(),a=i||Math.max(1,n);r(n<=a,"byte array longer than desired length"),r(a>0,"Requested array length <= 0"),this.strip();var s,o,l="le"===t,d=new e(a),h=this.clone();if(l){for(o=0;!h.isZero();o++)s=h.andln(255),h.iushrn(8),d[o]=s;for(;o<a;o++)d[o]=0}else{for(o=0;o<a-n;o++)d[o]=0;for(o=0;!h.isZero();o++)s=h.andln(255),h.iushrn(8),d[a-o-1]=s}return d},Math.clz32?a.prototype._countBits=function(e){return 32-Math.clz32(e)}:a.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},a.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return 0==(8191&t)&&(i+=13,t>>>=13),0==(127&t)&&(i+=7,t>>>=7),0==(15&t)&&(i+=4,t>>>=4),0==(3&t)&&(i+=2,t>>>=2),0==(1&t)&&i++,i},a.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},a.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return 0!==this.negative},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},a.prototype.ior=function(e){return r(0==(this.negative|e.negative)),this.iuor(e)},a.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},a.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},a.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this.strip()},a.prototype.iand=function(e){return r(0==(this.negative|e.negative)),this.iuand(e)},a.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},a.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},a.prototype.iuxor=function(e){var t,i;this.length>e.length?(t=this,i=e):(t=e,i=this);for(var r=0;r<i.length;r++)this.words[r]=t.words[r]^i.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this.strip()},a.prototype.ixor=function(e){return r(0==(this.negative|e.negative)),this.iuxor(e)},a.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},a.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},a.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var n=0;n<t;n++)this.words[n]=67108863&~this.words[n];return i>0&&(this.words[n]=~this.words[n]&67108863>>26-i),this.strip()},a.prototype.notn=function(e){return this.clone().inotn(e)},a.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var i=e/26|0,n=e%26;return this._expand(i+1),this.words[i]=t?this.words[i]|1<<n:this.words[i]&~(1<<n),this.strip()},a.prototype.iadd=function(e){var t,i,r;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,r=e):(i=e,r=this);for(var n=0,a=0;a<r.length;a++)t=(0|i.words[a])+(0|r.words[a])+n,this.words[a]=67108863&t,n=t>>>26;for(;0!==n&&a<i.length;a++)t=(0|i.words[a])+n,this.words[a]=67108863&t,n=t>>>26;if(this.length=i.length,0!==n)this.words[this.length]=n,this.length++;else if(i!==this)for(;a<i.length;a++)this.words[a]=i.words[a];return this},a.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},a.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var i,r,n=this.cmp(e);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(i=this,r=e):(i=e,r=this);for(var a=0,s=0;s<r.length;s++)a=(t=(0|i.words[s])-(0|r.words[s])+a)>>26,this.words[s]=67108863&t;for(;0!==a&&s<i.length;s++)a=(t=(0|i.words[s])+a)>>26,this.words[s]=67108863&t;if(0===a&&s<i.length&&i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this.length=Math.max(this.length,s),i!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(e){return this.clone().isub(e)};var f=function(e,t,i){var r,n,a,s=e.words,o=t.words,l=i.words,d=0,h=0|s[0],c=8191&h,u=h>>>13,f=0|s[1],m=8191&f,p=f>>>13,g=0|s[2],_=8191&g,v=g>>>13,y=0|s[3],b=8191&y,S=y>>>13,T=0|s[4],w=8191&T,M=T>>>13,C=0|s[5],I=8191&C,P=C>>>13,E=0|s[6],x=8191&E,A=E>>>13,k=0|s[7],R=8191&k,O=k>>>13,L=0|s[8],F=8191&L,D=L>>>13,B=0|s[9],N=8191&B,V=B>>>13,U=0|o[0],W=8191&U,z=U>>>13,G=0|o[1],j=8191&G,H=G>>>13,q=0|o[2],$=8191&q,Z=q>>>13,X=0|o[3],Y=8191&X,J=X>>>13,K=0|o[4],Q=8191&K,ee=K>>>13,te=0|o[5],ie=8191&te,re=te>>>13,ne=0|o[6],ae=8191&ne,se=ne>>>13,oe=0|o[7],le=8191&oe,de=oe>>>13,he=0|o[8],ce=8191&he,ue=he>>>13,fe=0|o[9],me=8191&fe,pe=fe>>>13;i.negative=e.negative^t.negative,i.length=19;var ge=(d+(r=Math.imul(c,W))|0)+((8191&(n=(n=Math.imul(c,z))+Math.imul(u,W)|0))<<13)|0;d=((a=Math.imul(u,z))+(n>>>13)|0)+(ge>>>26)|0,ge&=67108863,r=Math.imul(m,W),n=(n=Math.imul(m,z))+Math.imul(p,W)|0,a=Math.imul(p,z);var _e=(d+(r=r+Math.imul(c,j)|0)|0)+((8191&(n=(n=n+Math.imul(c,H)|0)+Math.imul(u,j)|0))<<13)|0;d=((a=a+Math.imul(u,H)|0)+(n>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(_,W),n=(n=Math.imul(_,z))+Math.imul(v,W)|0,a=Math.imul(v,z),r=r+Math.imul(m,j)|0,n=(n=n+Math.imul(m,H)|0)+Math.imul(p,j)|0,a=a+Math.imul(p,H)|0;var ve=(d+(r=r+Math.imul(c,$)|0)|0)+((8191&(n=(n=n+Math.imul(c,Z)|0)+Math.imul(u,$)|0))<<13)|0;d=((a=a+Math.imul(u,Z)|0)+(n>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(b,W),n=(n=Math.imul(b,z))+Math.imul(S,W)|0,a=Math.imul(S,z),r=r+Math.imul(_,j)|0,n=(n=n+Math.imul(_,H)|0)+Math.imul(v,j)|0,a=a+Math.imul(v,H)|0,r=r+Math.imul(m,$)|0,n=(n=n+Math.imul(m,Z)|0)+Math.imul(p,$)|0,a=a+Math.imul(p,Z)|0;var ye=(d+(r=r+Math.imul(c,Y)|0)|0)+((8191&(n=(n=n+Math.imul(c,J)|0)+Math.imul(u,Y)|0))<<13)|0;d=((a=a+Math.imul(u,J)|0)+(n>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(w,W),n=(n=Math.imul(w,z))+Math.imul(M,W)|0,a=Math.imul(M,z),r=r+Math.imul(b,j)|0,n=(n=n+Math.imul(b,H)|0)+Math.imul(S,j)|0,a=a+Math.imul(S,H)|0,r=r+Math.imul(_,$)|0,n=(n=n+Math.imul(_,Z)|0)+Math.imul(v,$)|0,a=a+Math.imul(v,Z)|0,r=r+Math.imul(m,Y)|0,n=(n=n+Math.imul(m,J)|0)+Math.imul(p,Y)|0,a=a+Math.imul(p,J)|0;var be=(d+(r=r+Math.imul(c,Q)|0)|0)+((8191&(n=(n=n+Math.imul(c,ee)|0)+Math.imul(u,Q)|0))<<13)|0;d=((a=a+Math.imul(u,ee)|0)+(n>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(I,W),n=(n=Math.imul(I,z))+Math.imul(P,W)|0,a=Math.imul(P,z),r=r+Math.imul(w,j)|0,n=(n=n+Math.imul(w,H)|0)+Math.imul(M,j)|0,a=a+Math.imul(M,H)|0,r=r+Math.imul(b,$)|0,n=(n=n+Math.imul(b,Z)|0)+Math.imul(S,$)|0,a=a+Math.imul(S,Z)|0,r=r+Math.imul(_,Y)|0,n=(n=n+Math.imul(_,J)|0)+Math.imul(v,Y)|0,a=a+Math.imul(v,J)|0,r=r+Math.imul(m,Q)|0,n=(n=n+Math.imul(m,ee)|0)+Math.imul(p,Q)|0,a=a+Math.imul(p,ee)|0;var Se=(d+(r=r+Math.imul(c,ie)|0)|0)+((8191&(n=(n=n+Math.imul(c,re)|0)+Math.imul(u,ie)|0))<<13)|0;d=((a=a+Math.imul(u,re)|0)+(n>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul(x,W),n=(n=Math.imul(x,z))+Math.imul(A,W)|0,a=Math.imul(A,z),r=r+Math.imul(I,j)|0,n=(n=n+Math.imul(I,H)|0)+Math.imul(P,j)|0,a=a+Math.imul(P,H)|0,r=r+Math.imul(w,$)|0,n=(n=n+Math.imul(w,Z)|0)+Math.imul(M,$)|0,a=a+Math.imul(M,Z)|0,r=r+Math.imul(b,Y)|0,n=(n=n+Math.imul(b,J)|0)+Math.imul(S,Y)|0,a=a+Math.imul(S,J)|0,r=r+Math.imul(_,Q)|0,n=(n=n+Math.imul(_,ee)|0)+Math.imul(v,Q)|0,a=a+Math.imul(v,ee)|0,r=r+Math.imul(m,ie)|0,n=(n=n+Math.imul(m,re)|0)+Math.imul(p,ie)|0,a=a+Math.imul(p,re)|0;var Te=(d+(r=r+Math.imul(c,ae)|0)|0)+((8191&(n=(n=n+Math.imul(c,se)|0)+Math.imul(u,ae)|0))<<13)|0;d=((a=a+Math.imul(u,se)|0)+(n>>>13)|0)+(Te>>>26)|0,Te&=67108863,r=Math.imul(R,W),n=(n=Math.imul(R,z))+Math.imul(O,W)|0,a=Math.imul(O,z),r=r+Math.imul(x,j)|0,n=(n=n+Math.imul(x,H)|0)+Math.imul(A,j)|0,a=a+Math.imul(A,H)|0,r=r+Math.imul(I,$)|0,n=(n=n+Math.imul(I,Z)|0)+Math.imul(P,$)|0,a=a+Math.imul(P,Z)|0,r=r+Math.imul(w,Y)|0,n=(n=n+Math.imul(w,J)|0)+Math.imul(M,Y)|0,a=a+Math.imul(M,J)|0,r=r+Math.imul(b,Q)|0,n=(n=n+Math.imul(b,ee)|0)+Math.imul(S,Q)|0,a=a+Math.imul(S,ee)|0,r=r+Math.imul(_,ie)|0,n=(n=n+Math.imul(_,re)|0)+Math.imul(v,ie)|0,a=a+Math.imul(v,re)|0,r=r+Math.imul(m,ae)|0,n=(n=n+Math.imul(m,se)|0)+Math.imul(p,ae)|0,a=a+Math.imul(p,se)|0;var we=(d+(r=r+Math.imul(c,le)|0)|0)+((8191&(n=(n=n+Math.imul(c,de)|0)+Math.imul(u,le)|0))<<13)|0;d=((a=a+Math.imul(u,de)|0)+(n>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(F,W),n=(n=Math.imul(F,z))+Math.imul(D,W)|0,a=Math.imul(D,z),r=r+Math.imul(R,j)|0,n=(n=n+Math.imul(R,H)|0)+Math.imul(O,j)|0,a=a+Math.imul(O,H)|0,r=r+Math.imul(x,$)|0,n=(n=n+Math.imul(x,Z)|0)+Math.imul(A,$)|0,a=a+Math.imul(A,Z)|0,r=r+Math.imul(I,Y)|0,n=(n=n+Math.imul(I,J)|0)+Math.imul(P,Y)|0,a=a+Math.imul(P,J)|0,r=r+Math.imul(w,Q)|0,n=(n=n+Math.imul(w,ee)|0)+Math.imul(M,Q)|0,a=a+Math.imul(M,ee)|0,r=r+Math.imul(b,ie)|0,n=(n=n+Math.imul(b,re)|0)+Math.imul(S,ie)|0,a=a+Math.imul(S,re)|0,r=r+Math.imul(_,ae)|0,n=(n=n+Math.imul(_,se)|0)+Math.imul(v,ae)|0,a=a+Math.imul(v,se)|0,r=r+Math.imul(m,le)|0,n=(n=n+Math.imul(m,de)|0)+Math.imul(p,le)|0,a=a+Math.imul(p,de)|0;var Me=(d+(r=r+Math.imul(c,ce)|0)|0)+((8191&(n=(n=n+Math.imul(c,ue)|0)+Math.imul(u,ce)|0))<<13)|0;d=((a=a+Math.imul(u,ue)|0)+(n>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul(N,W),n=(n=Math.imul(N,z))+Math.imul(V,W)|0,a=Math.imul(V,z),r=r+Math.imul(F,j)|0,n=(n=n+Math.imul(F,H)|0)+Math.imul(D,j)|0,a=a+Math.imul(D,H)|0,r=r+Math.imul(R,$)|0,n=(n=n+Math.imul(R,Z)|0)+Math.imul(O,$)|0,a=a+Math.imul(O,Z)|0,r=r+Math.imul(x,Y)|0,n=(n=n+Math.imul(x,J)|0)+Math.imul(A,Y)|0,a=a+Math.imul(A,J)|0,r=r+Math.imul(I,Q)|0,n=(n=n+Math.imul(I,ee)|0)+Math.imul(P,Q)|0,a=a+Math.imul(P,ee)|0,r=r+Math.imul(w,ie)|0,n=(n=n+Math.imul(w,re)|0)+Math.imul(M,ie)|0,a=a+Math.imul(M,re)|0,r=r+Math.imul(b,ae)|0,n=(n=n+Math.imul(b,se)|0)+Math.imul(S,ae)|0,a=a+Math.imul(S,se)|0,r=r+Math.imul(_,le)|0,n=(n=n+Math.imul(_,de)|0)+Math.imul(v,le)|0,a=a+Math.imul(v,de)|0,r=r+Math.imul(m,ce)|0,n=(n=n+Math.imul(m,ue)|0)+Math.imul(p,ce)|0,a=a+Math.imul(p,ue)|0;var Ce=(d+(r=r+Math.imul(c,me)|0)|0)+((8191&(n=(n=n+Math.imul(c,pe)|0)+Math.imul(u,me)|0))<<13)|0;d=((a=a+Math.imul(u,pe)|0)+(n>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,r=Math.imul(N,j),n=(n=Math.imul(N,H))+Math.imul(V,j)|0,a=Math.imul(V,H),r=r+Math.imul(F,$)|0,n=(n=n+Math.imul(F,Z)|0)+Math.imul(D,$)|0,a=a+Math.imul(D,Z)|0,r=r+Math.imul(R,Y)|0,n=(n=n+Math.imul(R,J)|0)+Math.imul(O,Y)|0,a=a+Math.imul(O,J)|0,r=r+Math.imul(x,Q)|0,n=(n=n+Math.imul(x,ee)|0)+Math.imul(A,Q)|0,a=a+Math.imul(A,ee)|0,r=r+Math.imul(I,ie)|0,n=(n=n+Math.imul(I,re)|0)+Math.imul(P,ie)|0,a=a+Math.imul(P,re)|0,r=r+Math.imul(w,ae)|0,n=(n=n+Math.imul(w,se)|0)+Math.imul(M,ae)|0,a=a+Math.imul(M,se)|0,r=r+Math.imul(b,le)|0,n=(n=n+Math.imul(b,de)|0)+Math.imul(S,le)|0,a=a+Math.imul(S,de)|0,r=r+Math.imul(_,ce)|0,n=(n=n+Math.imul(_,ue)|0)+Math.imul(v,ce)|0,a=a+Math.imul(v,ue)|0;var Ie=(d+(r=r+Math.imul(m,me)|0)|0)+((8191&(n=(n=n+Math.imul(m,pe)|0)+Math.imul(p,me)|0))<<13)|0;d=((a=a+Math.imul(p,pe)|0)+(n>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,r=Math.imul(N,$),n=(n=Math.imul(N,Z))+Math.imul(V,$)|0,a=Math.imul(V,Z),r=r+Math.imul(F,Y)|0,n=(n=n+Math.imul(F,J)|0)+Math.imul(D,Y)|0,a=a+Math.imul(D,J)|0,r=r+Math.imul(R,Q)|0,n=(n=n+Math.imul(R,ee)|0)+Math.imul(O,Q)|0,a=a+Math.imul(O,ee)|0,r=r+Math.imul(x,ie)|0,n=(n=n+Math.imul(x,re)|0)+Math.imul(A,ie)|0,a=a+Math.imul(A,re)|0,r=r+Math.imul(I,ae)|0,n=(n=n+Math.imul(I,se)|0)+Math.imul(P,ae)|0,a=a+Math.imul(P,se)|0,r=r+Math.imul(w,le)|0,n=(n=n+Math.imul(w,de)|0)+Math.imul(M,le)|0,a=a+Math.imul(M,de)|0,r=r+Math.imul(b,ce)|0,n=(n=n+Math.imul(b,ue)|0)+Math.imul(S,ce)|0,a=a+Math.imul(S,ue)|0;var Pe=(d+(r=r+Math.imul(_,me)|0)|0)+((8191&(n=(n=n+Math.imul(_,pe)|0)+Math.imul(v,me)|0))<<13)|0;d=((a=a+Math.imul(v,pe)|0)+(n>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,r=Math.imul(N,Y),n=(n=Math.imul(N,J))+Math.imul(V,Y)|0,a=Math.imul(V,J),r=r+Math.imul(F,Q)|0,n=(n=n+Math.imul(F,ee)|0)+Math.imul(D,Q)|0,a=a+Math.imul(D,ee)|0,r=r+Math.imul(R,ie)|0,n=(n=n+Math.imul(R,re)|0)+Math.imul(O,ie)|0,a=a+Math.imul(O,re)|0,r=r+Math.imul(x,ae)|0,n=(n=n+Math.imul(x,se)|0)+Math.imul(A,ae)|0,a=a+Math.imul(A,se)|0,r=r+Math.imul(I,le)|0,n=(n=n+Math.imul(I,de)|0)+Math.imul(P,le)|0,a=a+Math.imul(P,de)|0,r=r+Math.imul(w,ce)|0,n=(n=n+Math.imul(w,ue)|0)+Math.imul(M,ce)|0,a=a+Math.imul(M,ue)|0;var Ee=(d+(r=r+Math.imul(b,me)|0)|0)+((8191&(n=(n=n+Math.imul(b,pe)|0)+Math.imul(S,me)|0))<<13)|0;d=((a=a+Math.imul(S,pe)|0)+(n>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(N,Q),n=(n=Math.imul(N,ee))+Math.imul(V,Q)|0,a=Math.imul(V,ee),r=r+Math.imul(F,ie)|0,n=(n=n+Math.imul(F,re)|0)+Math.imul(D,ie)|0,a=a+Math.imul(D,re)|0,r=r+Math.imul(R,ae)|0,n=(n=n+Math.imul(R,se)|0)+Math.imul(O,ae)|0,a=a+Math.imul(O,se)|0,r=r+Math.imul(x,le)|0,n=(n=n+Math.imul(x,de)|0)+Math.imul(A,le)|0,a=a+Math.imul(A,de)|0,r=r+Math.imul(I,ce)|0,n=(n=n+Math.imul(I,ue)|0)+Math.imul(P,ce)|0,a=a+Math.imul(P,ue)|0;var xe=(d+(r=r+Math.imul(w,me)|0)|0)+((8191&(n=(n=n+Math.imul(w,pe)|0)+Math.imul(M,me)|0))<<13)|0;d=((a=a+Math.imul(M,pe)|0)+(n>>>13)|0)+(xe>>>26)|0,xe&=67108863,r=Math.imul(N,ie),n=(n=Math.imul(N,re))+Math.imul(V,ie)|0,a=Math.imul(V,re),r=r+Math.imul(F,ae)|0,n=(n=n+Math.imul(F,se)|0)+Math.imul(D,ae)|0,a=a+Math.imul(D,se)|0,r=r+Math.imul(R,le)|0,n=(n=n+Math.imul(R,de)|0)+Math.imul(O,le)|0,a=a+Math.imul(O,de)|0,r=r+Math.imul(x,ce)|0,n=(n=n+Math.imul(x,ue)|0)+Math.imul(A,ce)|0,a=a+Math.imul(A,ue)|0;var Ae=(d+(r=r+Math.imul(I,me)|0)|0)+((8191&(n=(n=n+Math.imul(I,pe)|0)+Math.imul(P,me)|0))<<13)|0;d=((a=a+Math.imul(P,pe)|0)+(n>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,r=Math.imul(N,ae),n=(n=Math.imul(N,se))+Math.imul(V,ae)|0,a=Math.imul(V,se),r=r+Math.imul(F,le)|0,n=(n=n+Math.imul(F,de)|0)+Math.imul(D,le)|0,a=a+Math.imul(D,de)|0,r=r+Math.imul(R,ce)|0,n=(n=n+Math.imul(R,ue)|0)+Math.imul(O,ce)|0,a=a+Math.imul(O,ue)|0;var ke=(d+(r=r+Math.imul(x,me)|0)|0)+((8191&(n=(n=n+Math.imul(x,pe)|0)+Math.imul(A,me)|0))<<13)|0;d=((a=a+Math.imul(A,pe)|0)+(n>>>13)|0)+(ke>>>26)|0,ke&=67108863,r=Math.imul(N,le),n=(n=Math.imul(N,de))+Math.imul(V,le)|0,a=Math.imul(V,de),r=r+Math.imul(F,ce)|0,n=(n=n+Math.imul(F,ue)|0)+Math.imul(D,ce)|0,a=a+Math.imul(D,ue)|0;var Re=(d+(r=r+Math.imul(R,me)|0)|0)+((8191&(n=(n=n+Math.imul(R,pe)|0)+Math.imul(O,me)|0))<<13)|0;d=((a=a+Math.imul(O,pe)|0)+(n>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul(N,ce),n=(n=Math.imul(N,ue))+Math.imul(V,ce)|0,a=Math.imul(V,ue);var Oe=(d+(r=r+Math.imul(F,me)|0)|0)+((8191&(n=(n=n+Math.imul(F,pe)|0)+Math.imul(D,me)|0))<<13)|0;d=((a=a+Math.imul(D,pe)|0)+(n>>>13)|0)+(Oe>>>26)|0,Oe&=67108863;var Le=(d+(r=Math.imul(N,me))|0)+((8191&(n=(n=Math.imul(N,pe))+Math.imul(V,me)|0))<<13)|0;return d=((a=Math.imul(V,pe))+(n>>>13)|0)+(Le>>>26)|0,Le&=67108863,l[0]=ge,l[1]=_e,l[2]=ve,l[3]=ye,l[4]=be,l[5]=Se,l[6]=Te,l[7]=we,l[8]=Me,l[9]=Ce,l[10]=Ie,l[11]=Pe,l[12]=Ee,l[13]=xe,l[14]=Ae,l[15]=ke,l[16]=Re,l[17]=Oe,l[18]=Le,0!==d&&(l[19]=d,i.length++),i};function m(e,t,i){return(new p).mulp(e,t,i)}function p(e,t){this.x=e,this.y=t}Math.imul||(f=u),a.prototype.mulTo=function(e,t){var i=this.length+e.length;return 10===this.length&&10===e.length?f(this,e,t):i<63?u(this,e,t):i<1024?function(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var r=0,n=0,a=0;a<i.length-1;a++){var s=n;n=0;for(var o=67108863&r,l=Math.min(a,t.length-1),d=Math.max(0,a-e.length+1);d<=l;d++){var h=a-d,c=(0|e.words[h])*(0|t.words[d]),u=67108863&c;o=67108863&(u=u+o|0),n+=(s=(s=s+(c/67108864|0)|0)+(u>>>26)|0)>>>26,s&=67108863}i.words[a]=o,r=s,s=n}return 0!==r?i.words[a]=r:i.length--,i.strip()}(this,e,t):m(this,e,t)},p.prototype.makeRBT=function(e){for(var t=new Array(e),i=a.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,i,e);return t},p.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var r=0,n=0;n<t;n++)r|=(1&e)<<t-n-1,e>>=1;return r},p.prototype.permute=function(e,t,i,r,n,a){for(var s=0;s<a;s++)r[s]=t[e[s]],n[s]=i[e[s]]},p.prototype.transform=function(e,t,i,r,n,a){this.permute(a,e,t,i,r,n);for(var s=1;s<n;s<<=1)for(var o=s<<1,l=Math.cos(2*Math.PI/o),d=Math.sin(2*Math.PI/o),h=0;h<n;h+=o)for(var c=l,u=d,f=0;f<s;f++){var m=i[h+f],p=r[h+f],g=i[h+f+s],_=r[h+f+s],v=c*g-u*_;_=c*_+u*g,g=v,i[h+f]=m+g,r[h+f]=p+_,i[h+f+s]=m-g,r[h+f+s]=p-_,f!==o&&(v=l*c-d*u,u=l*u+d*c,c=v)}},p.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),r=1&i,n=0;for(i=i/2|0;i;i>>>=1)n++;return 1<<n+1+r},p.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var r=0;r<i/2;r++){var n=e[r];e[r]=e[i-r-1],e[i-r-1]=n,n=t[r],t[r]=-t[i-r-1],t[i-r-1]=-n}},p.prototype.normalize13b=function(e,t){for(var i=0,r=0;r<t/2;r++){var n=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+i;e[r]=67108863&n,i=n<67108864?0:n/67108864|0}return e},p.prototype.convert13b=function(e,t,i,n){for(var a=0,s=0;s<t;s++)a+=0|e[s],i[2*s]=8191&a,a>>>=13,i[2*s+1]=8191&a,a>>>=13;for(s=2*t;s<n;++s)i[s]=0;r(0===a),r(0==(-8192&a))},p.prototype.stub=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0;return t},p.prototype.mulp=function(e,t,i){var r=2*this.guessLen13b(e.length,t.length),n=this.makeRBT(r),a=this.stub(r),s=new Array(r),o=new Array(r),l=new Array(r),d=new Array(r),h=new Array(r),c=new Array(r),u=i.words;u.length=r,this.convert13b(e.words,e.length,s,r),this.convert13b(t.words,t.length,d,r),this.transform(s,a,o,l,r,n),this.transform(d,a,h,c,r,n);for(var f=0;f<r;f++){var m=o[f]*h[f]-l[f]*c[f];l[f]=o[f]*c[f]+l[f]*h[f],o[f]=m}return this.conjugate(o,l,r),this.transform(o,l,u,a,r,n),this.conjugate(u,a,r),this.normalize13b(u,r),i.negative=e.negative^t.negative,i.length=e.length+t.length,i.strip()},a.prototype.mul=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},a.prototype.mulf=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),m(this,e,t)},a.prototype.imul=function(e){return this.clone().mulTo(e,this)},a.prototype.imuln=function(e){r("number"==typeof e),r(e<67108864);for(var t=0,i=0;i<this.length;i++){var n=(0|this.words[i])*e,a=(67108863&n)+(67108863&t);t>>=26,t+=n/67108864|0,t+=a>>>26,this.words[i]=67108863&a}return 0!==t&&(this.words[i]=t,this.length++),this},a.prototype.muln=function(e){return this.clone().imuln(e)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),i=0;i<t.length;i++){var r=i/26|0,n=i%26;t[i]=(e.words[r]&1<<n)>>>n}return t}(e);if(0===t.length)return new a(1);for(var i=this,r=0;r<t.length&&0===t[r];r++,i=i.sqr());if(++r<t.length)for(var n=i.sqr();r<t.length;r++,n=n.sqr())0!==t[r]&&(i=i.mul(n));return i},a.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,i=e%26,n=(e-i)/26,a=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(t=0;t<this.length;t++){var o=this.words[t]&a,l=(0|this.words[t])-o<<i;this.words[t]=l|s,s=o>>>26-i}s&&(this.words[t]=s,this.length++)}if(0!==n){for(t=this.length-1;t>=0;t--)this.words[t+n]=this.words[t];for(t=0;t<n;t++)this.words[t]=0;this.length+=n}return this.strip()},a.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},a.prototype.iushrn=function(e,t,i){var n;r("number"==typeof e&&e>=0),n=t?(t-t%26)/26:0;var a=e%26,s=Math.min((e-a)/26,this.length),o=67108863^67108863>>>a<<a,l=i;if(n-=s,n=Math.max(0,n),l){for(var d=0;d<s;d++)l.words[d]=this.words[d];l.length=s}if(0===s);else if(this.length>s)for(this.length-=s,d=0;d<this.length;d++)this.words[d]=this.words[d+s];else this.words[0]=0,this.length=1;var h=0;for(d=this.length-1;d>=0&&(0!==h||d>=n);d--){var c=0|this.words[d];this.words[d]=h<<26-a|c>>>a,h=c&o}return l&&0!==h&&(l.words[l.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(e,t,i){return r(0===this.negative),this.iushrn(e,t,i)},a.prototype.shln=function(e){return this.clone().ishln(e)},a.prototype.ushln=function(e){return this.clone().iushln(e)},a.prototype.shrn=function(e){return this.clone().ishrn(e)},a.prototype.ushrn=function(e){return this.clone().iushrn(e)},a.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26,n=1<<t;return!(this.length<=i||!(this.words[i]&n))},a.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==t&&i++,this.length=Math.min(i,this.length),0!==t){var n=67108863^67108863>>>t<<t;this.words[this.length-1]&=n}return this.strip()},a.prototype.maskn=function(e){return this.clone().imaskn(e)},a.prototype.iaddn=function(e){return r("number"==typeof e),r(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},a.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},a.prototype.isubn=function(e){if(r("number"==typeof e),r(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},a.prototype.addn=function(e){return this.clone().iaddn(e)},a.prototype.subn=function(e){return this.clone().isubn(e)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(e,t,i){var n,a,s=e.length+i;this._expand(s);var o=0;for(n=0;n<e.length;n++){a=(0|this.words[n+i])+o;var l=(0|e.words[n])*t;o=((a-=67108863&l)>>26)-(l/67108864|0),this.words[n+i]=67108863&a}for(;n<this.length-i;n++)o=(a=(0|this.words[n+i])+o)>>26,this.words[n+i]=67108863&a;if(0===o)return this.strip();for(r(-1===o),o=0,n=0;n<this.length;n++)o=(a=-(0|this.words[n])+o)>>26,this.words[n]=67108863&a;return this.negative=1,this.strip()},a.prototype._wordDiv=function(e,t){var i=(this.length,e.length),r=this.clone(),n=e,s=0|n.words[n.length-1];0!=(i=26-this._countBits(s))&&(n=n.ushln(i),r.iushln(i),s=0|n.words[n.length-1]);var o,l=r.length-n.length;if("mod"!==t){(o=new a(null)).length=l+1,o.words=new Array(o.length);for(var d=0;d<o.length;d++)o.words[d]=0}var h=r.clone()._ishlnsubmul(n,1,l);0===h.negative&&(r=h,o&&(o.words[l]=1));for(var c=l-1;c>=0;c--){var u=67108864*(0|r.words[n.length+c])+(0|r.words[n.length+c-1]);for(u=Math.min(u/s|0,67108863),r._ishlnsubmul(n,u,c);0!==r.negative;)u--,r.negative=0,r._ishlnsubmul(n,1,c),r.isZero()||(r.negative^=1);o&&(o.words[c]=u)}return o&&o.strip(),r.strip(),"div"!==t&&0!==i&&r.iushrn(i),{div:o||null,mod:r}},a.prototype.divmod=function(e,t,i){return r(!e.isZero()),this.isZero()?{div:new a(0),mod:new a(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(n=o.div.neg()),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.iadd(e)),{div:n,mod:s}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(n=o.div.neg()),{div:n,mod:o.mod}):0!=(this.negative&e.negative)?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(s=o.mod.neg(),i&&0!==s.negative&&s.isub(e)),{div:o.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new a(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new a(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new a(this.modn(e.words[0]))}:this._wordDiv(e,t);var n,s,o},a.prototype.div=function(e){return this.divmod(e,"div",!1).div},a.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},a.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},a.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),n=e.andln(1),a=i.cmp(r);return a<0||1===n&&0===a?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},a.prototype.modn=function(e){r(e<=67108863);for(var t=(1<<26)%e,i=0,n=this.length-1;n>=0;n--)i=(t*i+(0|this.words[n]))%e;return i},a.prototype.idivn=function(e){r(e<=67108863);for(var t=0,i=this.length-1;i>=0;i--){var n=(0|this.words[i])+67108864*t;this.words[i]=n/e|0,t=n%e}return this.strip()},a.prototype.divn=function(e){return this.clone().idivn(e)},a.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n=new a(1),s=new a(0),o=new a(0),l=new a(1),d=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++d;for(var h=i.clone(),c=t.clone();!t.isZero();){for(var u=0,f=1;0==(t.words[0]&f)&&u<26;++u,f<<=1);if(u>0)for(t.iushrn(u);u-- >0;)(n.isOdd()||s.isOdd())&&(n.iadd(h),s.isub(c)),n.iushrn(1),s.iushrn(1);for(var m=0,p=1;0==(i.words[0]&p)&&m<26;++m,p<<=1);if(m>0)for(i.iushrn(m);m-- >0;)(o.isOdd()||l.isOdd())&&(o.iadd(h),l.isub(c)),o.iushrn(1),l.iushrn(1);t.cmp(i)>=0?(t.isub(i),n.isub(o),s.isub(l)):(i.isub(t),o.isub(n),l.isub(s))}return{a:o,b:l,gcd:i.iushln(d)}},a.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n,s=new a(1),o=new a(0),l=i.clone();t.cmpn(1)>0&&i.cmpn(1)>0;){for(var d=0,h=1;0==(t.words[0]&h)&&d<26;++d,h<<=1);if(d>0)for(t.iushrn(d);d-- >0;)s.isOdd()&&s.iadd(l),s.iushrn(1);for(var c=0,u=1;0==(i.words[0]&u)&&c<26;++c,u<<=1);if(c>0)for(i.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(l),o.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(o)):(i.isub(t),o.isub(s))}return(n=0===t.cmpn(1)?s:o).cmpn(0)<0&&n.iadd(e),n},a.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var r=0;t.isEven()&&i.isEven();r++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var n=t.cmp(i);if(n<0){var a=t;t=i,i=a}else if(0===n||0===i.cmpn(1))break;t.isub(i)}return i.iushln(r)},a.prototype.invm=function(e){return this.egcd(e).a.umod(e)},a.prototype.isEven=function(){return 0==(1&this.words[0])},a.prototype.isOdd=function(){return 1==(1&this.words[0])},a.prototype.andln=function(e){return this.words[0]&e},a.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,i=(e-t)/26,n=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=n,this;for(var a=n,s=i;0!==a&&s<this.length;s++){var o=0|this.words[s];a=(o+=a)>>>26,o&=67108863,this.words[s]=o}return 0!==a&&(this.words[s]=a,this.length++),this},a.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},a.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)t=1;else{i&&(e=-e),r(e<=67108863,"Number is too big");var n=0|this.words[0];t=n===e?0:n<e?-1:1}return 0!==this.negative?0|-t:t},a.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},a.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,i=this.length-1;i>=0;i--){var r=0|this.words[i],n=0|e.words[i];if(r!==n){r<n?t=-1:r>n&&(t=1);break}}return t},a.prototype.gtn=function(e){return 1===this.cmpn(e)},a.prototype.gt=function(e){return 1===this.cmp(e)},a.prototype.gten=function(e){return this.cmpn(e)>=0},a.prototype.gte=function(e){return this.cmp(e)>=0},a.prototype.ltn=function(e){return-1===this.cmpn(e)},a.prototype.lt=function(e){return-1===this.cmp(e)},a.prototype.lten=function(e){return this.cmpn(e)<=0},a.prototype.lte=function(e){return this.cmp(e)<=0},a.prototype.eqn=function(e){return 0===this.cmpn(e)},a.prototype.eq=function(e){return 0===this.cmp(e)},a.red=function(e){return new T(e)},a.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},a.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(e){return this.red=e,this},a.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},a.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},a.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},a.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},a.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},a.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},a.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},a.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},a.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function _(e,t){this.name=e,this.p=new a(t,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function y(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function b(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function S(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function T(e){if("string"==typeof e){var t=a._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function w(e){T.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var e=new a(null);return e.words=new Array(Math.ceil(this.n/13)),e},_.prototype.ireduce=function(e){var t,i=e;do{this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(t>this.n);var r=t<this.n?-1:i.ucmp(this.p);return 0===r?(i.words[0]=0,i.length=1):r>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},_.prototype.split=function(e,t){e.iushrn(this.n,0,t)},_.prototype.imulK=function(e){return e.imul(this.k)},n(v,_),v.prototype.split=function(e,t){for(var i=Math.min(e.length,9),r=0;r<i;r++)t.words[r]=e.words[r];if(t.length=i,e.length<=9)return e.words[0]=0,void(e.length=1);var n=e.words[9];for(t.words[t.length++]=4194303&n,r=10;r<e.length;r++){var a=0|e.words[r];e.words[r-10]=(4194303&a)<<4|n>>>22,n=a}n>>>=22,e.words[r-10]=n,0===n&&e.length>10?e.length-=10:e.length-=9},v.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var r=0|e.words[i];t+=977*r,e.words[i]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},n(y,_),n(b,_),n(S,_),S.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var r=19*(0|e.words[i])+t,n=67108863&r;r>>>=26,e.words[i]=n,t=r}return 0!==t&&(e.words[e.length++]=t),e},a._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new v;else if("p224"===e)t=new y;else if("p192"===e)t=new b;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new S}return g[e]=t,t},T.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},T.prototype._verify2=function(e,t){r(0==(e.negative|t.negative),"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},T.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},T.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},T.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},T.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},T.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},T.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i},T.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},T.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},T.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},T.prototype.isqr=function(e){return this.imul(e,e.clone())},T.prototype.sqr=function(e){return this.mul(e,e)},T.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var i=this.m.add(new a(1)).iushrn(2);return this.pow(e,i)}for(var n=this.m.subn(1),s=0;!n.isZero()&&0===n.andln(1);)s++,n.iushrn(1);r(!n.isZero());var o=new a(1).toRed(this),l=o.redNeg(),d=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new a(2*h*h).toRed(this);0!==this.pow(h,d).cmp(l);)h.redIAdd(l);for(var c=this.pow(h,n),u=this.pow(e,n.addn(1).iushrn(1)),f=this.pow(e,n),m=s;0!==f.cmp(o);){for(var p=f,g=0;0!==p.cmp(o);g++)p=p.redSqr();r(g<m);var _=this.pow(c,new a(1).iushln(m-g-1));u=u.redMul(_),c=_.redSqr(),f=f.redMul(c),m=g}return u},T.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},T.prototype.pow=function(e,t){if(t.isZero())return new a(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=new Array(16);i[0]=new a(1).toRed(this),i[1]=e;for(var r=2;r<i.length;r++)i[r]=this.mul(i[r-1],e);var n=i[0],s=0,o=0,l=t.bitLength()%26;for(0===l&&(l=26),r=t.length-1;r>=0;r--){for(var d=t.words[r],h=l-1;h>=0;h--){var c=d>>h&1;n!==i[0]&&(n=this.sqr(n)),0!==c||0!==s?(s<<=1,s|=c,(4==++o||0===r&&0===h)&&(n=this.mul(n,i[s]),o=0,s=0)):o=0}l=26}return n},T.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},T.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},a.mont=function(e){return new w(e)},n(w,T),w.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},w.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},w.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),a=n;return n.cmp(this.m)>=0?a=n.isub(this.m):n.cmpn(0)<0&&(a=n.iadd(this.m)),a._forceRed(this)},w.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new a(0)._forceRed(this);var i=e.mul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},w.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,i(83)(e))},function(e,t){},function(e,t,i){t.publicEncrypt=i(373),t.privateDecrypt=i(375),t.privateEncrypt=function(e,i){return t.publicEncrypt(e,i,!0)},t.publicDecrypt=function(e,i){return t.privateDecrypt(e,i,!0)}},function(e,t,i){var r=i(131),n=i(103),a=i(116),s=i(225),o=i(226),l=i(160),d=i(227),h=i(156),c=i(29).Buffer;e.exports=function(e,t,i){var u;u=e.padding?e.padding:i?1:4;var f,m=r(e);if(4===u)f=function(e,t){var i=e.modulus.byteLength(),r=t.length,d=a("sha1").update(c.alloc(0)).digest(),h=d.length,u=2*h;if(r>i-u-2)throw new Error("message too long");var f=c.alloc(i-r-u-2),m=i-h-1,p=n(h),g=o(c.concat([d,f,c.alloc(1,1),t],m),s(p,m)),_=o(p,s(g,h));return new l(c.concat([c.alloc(1),_,g],i))}(m,t);else if(1===u)f=function(e,t,i){var r,a=t.length,s=e.modulus.byteLength();if(a>s-11)throw new Error("message too long");return r=i?c.alloc(s-a-3,255):function(e){for(var t,i=c.allocUnsafe(e),r=0,a=n(2*e),s=0;r<e;)s===a.length&&(a=n(2*e),s=0),(t=a[s++])&&(i[r++]=t);return i}(s-a-3),new l(c.concat([c.from([0,i?1:2]),r,c.alloc(1),t],s))}(m,t,i);else{if(3!==u)throw new Error("unknown padding");if((f=new l(t)).cmp(m.modulus)>=0)throw new Error("data too long for modulus")}return i?h(f,m):d(f,m)}},function(e,t){},function(e,t,i){var r=i(131),n=i(225),a=i(226),s=i(160),o=i(156),l=i(116),d=i(227),h=i(29).Buffer;e.exports=function(e,t,i){var c;c=e.padding?e.padding:i?1:4;var u,f=r(e),m=f.modulus.byteLength();if(t.length>m||new s(t).cmp(f.modulus)>=0)throw new Error("decryption error");u=i?d(new s(t),f):o(t,f);var p=h.alloc(m-u.length);if(u=h.concat([p,u],m),4===c)return function(e,t){var i=e.modulus.byteLength(),r=l("sha1").update(h.alloc(0)).digest(),s=r.length;if(0!==t[0])throw new Error("decryption error");var o=t.slice(1,s+1),d=t.slice(s+1),c=a(o,n(d,s)),u=a(d,n(c,i-s-1));if(function(e,t){e=h.from(e),t=h.from(t);var i=0,r=e.length;e.length!==t.length&&(i++,r=Math.min(e.length,t.length));for(var n=-1;++n<r;)i+=e[n]^t[n];return i}(r,u.slice(0,s)))throw new Error("decryption error");for(var f=s;0===u[f];)f++;if(1!==u[f++])throw new Error("decryption error");return u.slice(f)}(f,u);if(1===c)return function(e,t,i){for(var r=t.slice(0,2),n=2,a=0;0!==t[n++];)if(n>=t.length){a++;break}var s=t.slice(2,n-1);if(("0002"!==r.toString("hex")&&!i||"0001"!==r.toString("hex")&&i)&&a++,s.length<8&&a++,a)throw new Error("decryption error");return t.slice(n)}(0,u,i);if(3===c)return u;throw new Error("unknown padding")}},function(e,t,i){"use strict";(function(e,r){function n(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}var a=i(29),s=i(103),o=a.Buffer,l=a.kMaxLength,d=e.crypto||e.msCrypto,h=Math.pow(2,32)-1;function c(e,t){if("number"!=typeof e||e!=e)throw new TypeError("offset must be a number");if(e>h||e<0)throw new TypeError("offset must be a uint32");if(e>l||e>t)throw new RangeError("offset out of range")}function u(e,t,i){if("number"!=typeof e||e!=e)throw new TypeError("size must be a number");if(e>h||e<0)throw new TypeError("size must be a uint32");if(e+t>i||e>l)throw new RangeError("buffer too small")}function f(e,t,i,n){if(r.browser){var a=e.buffer,o=new Uint8Array(a,t,i);return d.getRandomValues(o),n?void r.nextTick((function(){n(null,e)})):e}if(!n)return s(i).copy(e,t),e;s(i,(function(i,r){if(i)return n(i);r.copy(e,t),n(null,e)}))}d&&d.getRandomValues||!r.browser?(t.randomFill=function(t,i,r,n){if(!(o.isBuffer(t)||t instanceof e.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if("function"==typeof i)n=i,i=0,r=t.length;else if("function"==typeof r)n=r,r=t.length-i;else if("function"!=typeof n)throw new TypeError('"cb" argument must be a function');return c(i,t.length),u(r,i,t.length),f(t,i,r,n)},t.randomFillSync=function(t,i,r){if(void 0===i&&(i=0),!(o.isBuffer(t)||t instanceof e.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return c(i,t.length),void 0===r&&(r=t.length-i),u(r,i,t.length),f(t,i,r)}):(t.randomFill=n,t.randomFillSync=n)}).call(this,i(55),i(48))},function(e,t,i){var r,n,a=i(230),s=i(231),o=0,l=0;e.exports=function(e,t,i){var d=t&&i||0,h=t||[],c=(e=e||{}).node||r,u=void 0!==e.clockseq?e.clockseq:n;if(null==c||null==u){var f=a();null==c&&(c=r=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==u&&(u=n=16383&(f[6]<<8|f[7]))}var m=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:l+1,g=m-o+(p-l)/1e4;if(g<0&&void 0===e.clockseq&&(u=u+1&16383),(g<0||m>o)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=m,l=p,n=u;var _=(1e4*(268435455&(m+=122192928e5))+p)%4294967296;h[d++]=_>>>24&255,h[d++]=_>>>16&255,h[d++]=_>>>8&255,h[d++]=255&_;var v=m/4294967296*1e4&268435455;h[d++]=v>>>8&255,h[d++]=255&v,h[d++]=v>>>24&15|16,h[d++]=v>>>16&255,h[d++]=u>>>8|128,h[d++]=255&u;for(var y=0;y<6;++y)h[d+y]=c[y];return t||s(h)}},function(e,t,i){var r=i(230),n=i(231);e.exports=function(e,t,i){var a=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var o=0;o<16;++o)t[a+o]=s[o];return t||n(s)}},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(99),s=i(384),o=i(385),l=i(386),d=i(387),h=i(389),c=i(390),u=i(391),f=i(392),m=i(393),p=i(394),g=i(395),_=i(396),v=i(397),y=i(398),b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transactionConstructors={AlphaTransition:function(){return new a.AlphaTransition},FadeThroughBlackTransition:function(){return new u.FadeThroughBlackTransition},PushTransition:function(){return new g.PushTransition},WeaveTransition:function(){return new v.WeaveTransition},CutTransition:function(){return new h.CutTransition},CoverTransition:function(){return new o.CoverTransition},PrismTransition:function(){return new p.PrismTransition},RippleTransition:function(){return new _.RippleTransition},ZoomWithSpinTransition:function(){return new y.ZoomWithSpinTransition},BlindsTransition:function(){return new s.BlindsTransition},CustomTransition:function(){return new d.CustomTransition},GalleryTransition:function(){return new m.GalleryTransition},CrossZoomTransition:function(){return new l.CrossZoomTransition},FlyThroughTransition:function(){return new f.FlyThroughTransition},DoorsTransition:function(){return new c.DoorsTransition}},t}return n(t,e),t}(i(161).BaseTransitionFactory);t.BabylonTransitionFactory=b},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(46),n=i(381),a=function(){function e(e,t){this.engine=e,this.memoryReport=t,this.indexBuffers=[],this.vertexBuffers=[],this.textures=[],this.vaos=[]}return e.prototype.createIndexBuffer=function(e){var t=this.engine.createIndexBuffer(e);return this.indexBuffers.push(t),this.memoryReport.buffers.count+=1,t},e.prototype.createVertexBuffers=function(e){for(var t={},i=0,r=e;i<r.length;i++){var a=r[i],s=new n.VertexBuffer(this.engine,a.data,a.name,!0,!1,a.itemSize);t[a.name]=s,this.vertexBuffers.push(s),this.memoryReport.buffers.count+=1}return t},e.prototype.recordVertexArrayObject=function(e,t,i){var r=this.engine.recordVertexArrayObject(e,t,i);return this.vaos.push(r),this.memoryReport.vaos.count+=1,r},e.prototype.createMonochromeTexture=function(e,t,i,r){var n=new Uint8Array([e,t,i,r]);return this.createTexture(n,1,1)},e.prototype.createTexture=function(e,t,i){var n=new r.InternalTexture(this.engine,r.InternalTextureSource.Unknown);return n.baseWidth=t,n.baseHeight=i,n.width=t,n.height=i,n.format=5,n.generateMipMaps=!1,n.samplingMode=2,n.invertY=!0,n.type=0,this.engine._bindTextureDirectly(3553,n,!0),this.engine._uploadDataToTextureDirectly(n,e,0,0,void 0,!0),this.engine.updateTextureSamplingMode(n.samplingMode,n,!1),this.engine.updateTextureWrappingMode(n,33071,33071),n.isReady=!0,this.textures.push(n),this.memoryReport.textures.count+=1,n},e.prototype.dispose=function(){for(var e=0,t=this.indexBuffers;e<t.length;e++){var i=t[e];this.engine._releaseBuffer(i),this.memoryReport.buffers.count-=1}for(var r=0,n=this.vertexBuffers;r<n.length;r++)n[r].dispose(),this.memoryReport.buffers.count-=1;for(var a=0,s=this.vaos;a<s.length;a++){var o=s[a];this.engine.releaseVertexArrayObject(o),this.memoryReport.vaos.count-=1}for(var l=0,d=this.textures;l<d.length;l++)d[l].dispose(),this.memoryReport.textures.count-=1;this.indexBuffers.length=0,this.vertexBuffers.length=0,this.vaos.length=0},e}();t.ResourcesManager=a},function(e,t,i){"use strict";i.r(t),i.d(t,"Buffer",(function(){return r})),i.d(t,"VertexBuffer",(function(){return n}));var r=function(){function e(e,t,i,r,n,a,s,o){void 0===r&&(r=0),void 0===n&&(n=!1),void 0===a&&(a=!1),void 0===s&&(s=!1),this._isAlreadyOwned=!1,e.getScene?this._engine=e.getScene().getEngine():this._engine=e,this._updatable=i,this._instanced=a,this._divisor=o||1,this._data=t,this.byteStride=s?r:r*Float32Array.BYTES_PER_ELEMENT,n||this.create()}return e.prototype.createVertexBuffer=function(e,t,i,r,a,s,o){void 0===s&&(s=!1);var l=s?t:t*Float32Array.BYTES_PER_ELEMENT,d=r?s?r:r*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new n(this._engine,this,e,this._updatable,!0,d,void 0===a?this._instanced:a,l,i,void 0,void 0,!0,this._divisor||o)},e.prototype.isUpdatable=function(){return this._updatable},e.prototype.getData=function(){return this._data},e.prototype.getBuffer=function(){return this._buffer},e.prototype.getStrideSize=function(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT},e.prototype.create=function(e){void 0===e&&(e=null),!e&&this._buffer||(e=e||this._data)&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e),this._data=e):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(e),this._data=e):this._buffer=this._engine.createVertexBuffer(e))},e.prototype._rebuild=function(){this._buffer=null,this.create(this._data)},e.prototype.update=function(e){this.create(e)},e.prototype.updateDirectly=function(e,t,i,r){void 0===r&&(r=!1),this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e,r?t:t*Float32Array.BYTES_PER_ELEMENT,i?i*this.byteStride:void 0),this._data=null)},e.prototype._increaseReferences=function(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=!0)},e.prototype.dispose=function(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)},e}(),n=function(){function e(t,i,n,a,s,o,l,d,h,c,u,f,m,p){if(void 0===u&&(u=!1),void 0===f&&(f=!1),void 0===m&&(m=1),void 0===p&&(p=!1),i instanceof r?(this._buffer=i,this._ownsBuffer=p,p&&this._buffer._increaseReferences()):(this._buffer=new r(t,i,a,o,s,l,f),this._ownsBuffer=!0),this._kind=n,null==c){var g=this.getData();this.type=e.FLOAT,g instanceof Int8Array?this.type=e.BYTE:g instanceof Uint8Array?this.type=e.UNSIGNED_BYTE:g instanceof Int16Array?this.type=e.SHORT:g instanceof Uint16Array?this.type=e.UNSIGNED_SHORT:g instanceof Int32Array?this.type=e.INT:g instanceof Uint32Array&&(this.type=e.UNSIGNED_INT)}else this.type=c;var _=e.GetTypeByteLength(this.type);f?(this._size=h||(o?o/_:e.DeduceStride(n)),this.byteStride=o||this._buffer.byteStride||this._size*_,this.byteOffset=d||0):(this._size=h||o||e.DeduceStride(n),this.byteStride=o?o*_:this._buffer.byteStride||this._size*_,this.byteOffset=(d||0)*_),this.normalized=u,this._instanced=void 0!==l&&l,this._instanceDivisor=l?m:0}return Object.defineProperty(e.prototype,"instanceDivisor",{get:function(){return this._instanceDivisor},set:function(e){this._instanceDivisor=e,this._instanced=0!=e},enumerable:!1,configurable:!0}),e.prototype._rebuild=function(){this._buffer&&this._buffer._rebuild()},e.prototype.getKind=function(){return this._kind},e.prototype.isUpdatable=function(){return this._buffer.isUpdatable()},e.prototype.getData=function(){return this._buffer.getData()},e.prototype.getBuffer=function(){return this._buffer.getBuffer()},e.prototype.getStrideSize=function(){return this.byteStride/e.GetTypeByteLength(this.type)},e.prototype.getOffset=function(){return this.byteOffset/e.GetTypeByteLength(this.type)},e.prototype.getSize=function(){return this._size},e.prototype.getIsInstanced=function(){return this._instanced},e.prototype.getInstanceDivisor=function(){return this._instanceDivisor},e.prototype.create=function(e){this._buffer.create(e)},e.prototype.update=function(e){this._buffer.update(e)},e.prototype.updateDirectly=function(e,t,i){void 0===i&&(i=!1),this._buffer.updateDirectly(e,t,void 0,i)},e.prototype.dispose=function(){this._ownsBuffer&&this._buffer.dispose()},e.prototype.forEach=function(t,i){e.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,t,this.normalized,i)},e.DeduceStride=function(t){switch(t){case e.UVKind:case e.UV2Kind:case e.UV3Kind:case e.UV4Kind:case e.UV5Kind:case e.UV6Kind:return 2;case e.NormalKind:case e.PositionKind:return 3;case e.ColorKind:case e.MatricesIndicesKind:case e.MatricesIndicesExtraKind:case e.MatricesWeightsKind:case e.MatricesWeightsExtraKind:case e.TangentKind:return 4;default:throw new Error("Invalid kind '"+t+"'")}},e.GetTypeByteLength=function(t){switch(t){case e.BYTE:case e.UNSIGNED_BYTE:return 1;case e.SHORT:case e.UNSIGNED_SHORT:return 2;case e.INT:case e.UNSIGNED_INT:case e.FLOAT:return 4;default:throw new Error("Invalid type '"+t+"'")}},e.ForEach=function(t,i,r,n,a,s,o,l){if(t instanceof Array)for(var d=i/4,h=r/4,c=0;c<s;c+=n){for(var u=0;u<n;u++)l(t[d+u],c+u);d+=h}else{var f=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),m=e.GetTypeByteLength(a);for(c=0;c<s;c+=n){var p=i;for(u=0;u<n;u++)l(e._GetFloatValue(f,a,p,o),c+u),p+=m;i+=r}}},e._GetFloatValue=function(t,i,r,n){switch(i){case e.BYTE:var a=t.getInt8(r);return n&&(a=Math.max(a/127,-1)),a;case e.UNSIGNED_BYTE:return a=t.getUint8(r),n&&(a/=255),a;case e.SHORT:return a=t.getInt16(r,!0),n&&(a=Math.max(a/32767,-1)),a;case e.UNSIGNED_SHORT:return a=t.getUint16(r,!0),n&&(a/=65535),a;case e.INT:return t.getInt32(r,!0);case e.UNSIGNED_INT:return t.getUint32(r,!0);case e.FLOAT:return t.getFloat32(r,!0);default:throw new Error("Invalid component type "+i)}},e.BYTE=5120,e.UNSIGNED_BYTE=5121,e.SHORT=5122,e.UNSIGNED_SHORT=5123,e.INT=5124,e.UNSIGNED_INT=5125,e.FLOAT=5126,e.PositionKind="position",e.NormalKind="normal",e.TangentKind="tangent",e.UVKind="uv",e.UV2Kind="uv2",e.UV3Kind="uv3",e.UV4Kind="uv4",e.UV5Kind="uv5",e.UV6Kind="uv6",e.ColorKind="color",e.MatricesIndicesKind="matricesIndices",e.MatricesWeightsKind="matricesWeights",e.MatricesIndicesExtraKind="matricesIndicesExtra",e.MatricesWeightsExtraKind="matricesWeightsExtra",e}()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(73),n=i(46),a=new(i(383).Viewport)(0,0,1,1),s={r:0,g:0,b:0,a:1};t.applyEngineExtensions=function(){void 0===r.ThinEngine.prototype.clearToBlack&&(r.ThinEngine.prototype.isContextLost=function(){return this._gl.isContextLost()},r.ThinEngine.prototype.clearToBlack=function(){this.clear(s,!0,!0)},r.ThinEngine.prototype.resetViewport=function(){var e=this._gl.canvas.width,t=this._gl.canvas.height;this.setSize(e,t),this.setViewport(a)},r.ThinEngine.prototype.wrapExternalTexture=function(e){var t=new n.InternalTexture(this,0,!0);return t._webGLTexture=e,t.type=0,t},r.ThinEngine.prototype.setTranstionBlend=function(e){e?(this.alphaState.alphaBlend=!0,this.alphaState.setAlphaBlendFunctionParameters(1,771,1,771),this.alphaState.setAlphaEquationParameters(32774,32774)):this.alphaState.alphaBlend=!1})}},function(e,t,i){"use strict";i.r(t),i.d(t,"Viewport",(function(){return r}));var r=function(){function e(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r}return e.prototype.toGlobal=function(t,i){return new e(this.x*t,this.y*i,this.width*t,this.height*i)},e.prototype.toGlobalToRef=function(e,t,i){return i.x=this.x*e,i.y=this.y*t,i.width=this.width*e,i.height=this.height*t,this},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e}()},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(67),s=i(62),o=i(52),l=i(60),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.zMovement=0,t.vres=0,t.hres=0,t}return n(t,e),t.prototype.internalInit=function(e){this.zMovement=null!=e.zMovement?e.zMovement:10,this.vres=e.vres,this.hres=e.hres;var t=this.getDrawInfo(5,[s.aPosition,s.aTexcoord,s.aDelay,s.aCenter],!0);if(t){var i=l.defaultViewModelProjectionMatrix();return t.shaderProgram.setMatrix("uModelViewProj",i),t.shaderProgram.setFloat("uFactor",e.factor),t.shaderProgram.setFloat("uXAxis",e.xAxis?1:0),t}},t.prototype.internalDraw=function(e,t,i){o.setDepthBlendCulling(i.engine,!0,!0,1028);var r=Math.PI,n=0===t.delayFormula?0:1,a=this.zMovement/10;a/=t.xAxis?this.vres:this.hres;var s=e*(n+r/t.factor+t.jitter/100),l=0,d=-1,h=o.bindDrawInfo(i);return h.setFloat("uZmovement",a),h.setFloat("uDirection",d),h.setFloat("uAngle",s),h.setFloat("uBack",l),h._bindTexture("uSampler1",t.forward?i.outgoingSlideTexture:i.incomingSlideTexture),o.drawTriangles(i),t.randomCenters?(s=(1-e)*(1+r/t.factor+t.jitter/100),l=0,d=1):(l=r,d=-1),h.setFloat("uDirection",d),h.setFloat("uAngle",s),h.setFloat("uBack",l),h._bindTexture("uSampler1",t.forward?i.incomingSlideTexture:i.outgoingSlideTexture),o.drawTriangles(i),!0},t}(a.MeshTransition);t.BlindsTransition=d},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=i(67),l=i(62),d=i(52),h=i(60),c=s(i(91)),u=i(72),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.modelViewProjectionMatrix=new h.ThinMatrix,t.center={x:-.5,y:-.5},t.positionSlide0={x:0,y:0},t.positionSlide1={x:0,y:0},t}return n(t,e),t.prototype.internalInit=function(e){var t={x:0,y:0};switch(e.direction){case u.kTransitionEffectOptions.Top:t.y=1;break;case u.kTransitionEffectOptions.Bottom:t.y=-1;break;case u.kTransitionEffectOptions.Left:t.x=-1;break;case u.kTransitionEffectOptions.TopLeft:t.y=1,t.x=-1;break;case u.kTransitionEffectOptions.BottomLeft:t.y=-1,t.x=-1;break;case u.kTransitionEffectOptions.TopRight:t.y=1,t.x=1;break;case u.kTransitionEffectOptions.BottomRight:t.y=-1,t.x=1;break;case u.kTransitionEffectOptions.Right:default:t.x=1}e.isCover||(t.x*=-1,t.y*=-1);var i=this.getDrawInfo(0,[l.aPosition,l.aTexcoord,l.aDelay]);if(i)return a(a({},i),{direction:t})},t.prototype.internalDraw=function(e,t,i){var r=e;t.isCover||(r=1-r);var n=d.bindDrawInfo(i);n.setFloat("uFactor",1),n.setFloat("uStyle",1),t.isCover?(n._bindTexture("uSampler1",t.forward?i.outgoingSlideTexture:i.incomingSlideTexture),n._bindTexture("uSampler2",t.forward?i.incomingSlideTexture:i.outgoingSlideTexture)):(n._bindTexture("uSampler1",t.forward?i.incomingSlideTexture:i.outgoingSlideTexture),n._bindTexture("uSampler2",t.forward?i.outgoingSlideTexture:i.incomingSlideTexture));var a=c.MotionFilter.getScaledProgress(0,r);return this.positionSlide0.x=this.center.x,this.positionSlide0.y=this.center.y,this.positionSlide1.x=this.center.x+(1-a)*-i.direction.x,this.positionSlide1.y=this.center.y+(1-a)*-i.direction.y,this.modelViewProjectionMatrix.translationScaling(this.positionSlide0.x,this.positionSlide0.y,0,2,2,1),n.setMatrix("uModelViewProj",this.modelViewProjectionMatrix),n.setFloat("uProgress",0),d.drawTriangles(i),this.modelViewProjectionMatrix.translationScaling(this.positionSlide1.x,this.positionSlide1.y,0,2,2,1),n.setMatrix("uModelViewProj",this.modelViewProjectionMatrix),n.setFloat("uProgress",1),d.drawTriangles(i),!0},t}(o.MeshTransition);t.CoverTransition=f},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=i(99),o=i(60),l=i(52),d=i(62),h=i(67),c=i(32),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.crossZoomMatrix=new o.ThinMatrix,t.eyePositionMatrix=new o.ThinMatrix,t.alphaTransition=new s.AlphaTransition(!1),t}return n(t,e),t.prototype.internalInit=function(e,t,i){if(e.incomingSlideForeground&&e.outgoingSlideForeground){var r=this.getDrawInfo(0,[d.aPosition,d.aTexcoord,d.aDelay]);if(r){var n;n=e.m_fTransitionWhite?t.createMonochromeTexture(255,255,255,255):t.createMonochromeTexture(0,0,0,255),e.delayFormula=0,this.alphaTransition.init(e,i);var s=o.defaultViewModelMatrix(),l=o.perspectiveMatrix();l.multiply(s);var h=r.engine.wrapExternalTexture(e.incomingSlideForeground),u=r.engine.wrapExternalTexture(e.outgoingSlideForeground);return a(a({},r),{solidTexture:n,modelViewMatrix:s,modelViewProjectionMatrix:l,incomingSlideTextureForeGround:h,outgoingSlideTextureForeGround:u})}}else c.logError("Either incomingSlideTextureForeGround or outgoingSlideTextureForeGround is undefined")},t.prototype.internalDraw=function(e,t,i){l.setDepthBlendCulling(i.engine,!1,t.m_fTransitionWhite);var r=e;if(t.m_fTransitionWhite)this.alphaTransition.draw(r);else if(t.m_deadTime>0){var n=t.m_deadTime/100;r<.5?r*=1-n:r=(1-n)*(r-.5)+.5+n/2}var a=t.forward?i.incomingSlideTexture:i.outgoingSlideTexture,s=t.forward?i.outgoingSlideTexture:i.incomingSlideTexture,o=t.forward?i.incomingSlideTextureForeGround:i.outgoingSlideTextureForeGround,d=t.forward?i.outgoingSlideTextureForeGround:i.incomingSlideTextureForeGround,h=r,c=(h*=2)<1;c||(h=2-h);var u=t.factor/4,f=1+1/u+t.jitter/100,m=l.bindDrawInfo(i);return t.m_fTransitionWhite?(m.setFloat("uFactor",u),m.setFloat("uProgress",(1-h)*f)):(m.setFloat("uProgress",f),m.setFloat("uFactor",1),m.setMatrix("uModelViewProj",i.modelViewProjectionMatrix),m.setFloat("uStyle",2),m._bindTexture("uSampler1",c?s:a),l.drawTriangles(i)),this.calculateEyePosition(r,t,i.modelViewMatrix),m.setMatrix("uModelViewProj",this.crossZoomMatrix),m.setFloat("uStyle",2),m._bindTexture("uSampler1",c?d:o),l.drawTriangles(i),t.m_fTransitionWhite||(m.setMatrix("uModelViewProj",i.modelViewProjectionMatrix),m.setFloat("uFactor",u),m.setFloat("uProgress",h*f),m.setFloat("uStyle",2),m._bindTexture("uSampler1",i.solidTexture),l.drawTriangles(i)),!0},t.prototype.calculateEyePosition=function(e,t,i){var r=t.m_dx/100,n=t.m_dy/100,a=t.m_dz/100,s=2*e;s>1&&(s=2-s,t.m_fInvertXZoomOut&&(r*=-1));var o=r*s,l=n*s,d=-1.5/(a*s-1.5);this.crossZoomMatrix.scaling(d,d,1),this.eyePositionMatrix.translation(-o,-l,0),this.crossZoomMatrix.multiply(this.eyePositionMatrix),i.multiplyToRef(this.crossZoomMatrix,this.crossZoomMatrix)},t.prototype.dispose=function(){this.alphaTransition.dispose(),e.prototype.dispose.call(this)},t}(h.MeshTransition);t.CrossZoomTransition=u},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),i(388);var a=i(132),s=i(60),o=i(134),l=i(52),d=i(32),h=i(72),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.aspectRatio=0,t.diffuse=0,t.backgroundProgress=0,t.isStaticBackground=!0,t}return n(t,e),t.prototype.internalInit=function(e,t){this.aspectRatio=16/9,this.diffuse=1-e.ambient;var i=!1;e.effectID===h.kTransitionIds.PPT_TRANSITION_DRAPE?(this.backgroundProgress=1,i=!i):this.backgroundProgress=0,e.forward||(i=!i);var r=e.engine;if(r){var n=r.wrapExternalTexture(i?e.outgoingSlideBackground:e.incomingSlideBackground),a=r.wrapExternalTexture(i?e.incomingSlideBackground:e.outgoingSlideBackground),l=o.activateShader(r,6);if(l){var c=e.indexBuffer,u=t.createIndexBuffer(e.indexBuffer),f=e.indexBuffer.length,m=new Float32Array(e.textureCoordBuffer);if(e.isInvX)for(var p=0;p<m.length/2;p+=1)m[2*p]=1-m[2*p];var g,_=m.length/2*3,v=new Float32Array(_),y=new Float32Array(_),b=t.createVertexBuffers([{name:"aTexCoord",data:m,itemSize:2},{name:"aPosition",data:v,itemSize:3},{name:"aNormal",data:y,itemSize:3}]);r.getCaps().vertexArrayObject&&(g=t.recordVertexArrayObject(b,u,l));var S=new s.ThinMatrix,T=new s.ThinMatrix,w=new s.ThinMatrix,M=new s.ThinMatrix,C=new s.ThinMatrix,I=new s.ThinMatrix;S.scaling(1.031,1.031/this.aspectRatio,.5),T.rotationY(Math.PI),w.translation(0,0,2.8),T.multiplyToRef(S,M),w.multiplyToRef(M,M),this.perspectiveMat(45,this.aspectRatio,.01,100,I),M.multiplyToRef(I,I),this.perspectiveMat(45,this.aspectRatio,.1,100,C),M.multiplyToRef(C,C),l.setMatrix("uModelToWorld",M),l.setMatrix("uModelToWorldIT",M),l.setFloat3("uLightPosition",0,0,-10),e.effectID===h.kTransitionIds.PPT_TRANSITION_FALLOVER?l.setFloat("uIsNormalDirectionChangeReq",0):l.setFloat("uIsNormalDirectionChangeReq",1);var P={engine:r,shaderProgram:l,incomingSlideTexture:n,outgoingSlideTexture:a,perspectiveMatrix:C,perspectiveBackgroundMatrix:I,vertexBuffers:b,vertexIndexBuffer:u,vertexIndexLength:f,tempVertexDataArray:v,tempVertexNormalDataArray:y,vertexIndexData:c,positionBufferList:e.positionBufferList,vertexArrayObject:g,autoClear:!0};if(e.textureCoordBufferBack&&e.indexBufferBack&&e.positionBufferListBack){var E=e.indexBufferBack,x=t.createIndexBuffer(e.indexBufferBack),A=e.indexBufferBack.length,k=new Float32Array(e.textureCoordBufferBack);if(e.isInvX)for(p=0;p<k.length/2;p+=1)k[2*p]=1-k[2*p];var R=m.length/2*3,O=new Float32Array(R),L=new Float32Array(R),F=t.createVertexBuffers([{name:"aTexCoord",data:k,itemSize:2},{name:"aPosition",data:O,itemSize:3},{name:"aNormal",data:L,itemSize:3}]),D=void 0;r.getCaps().vertexArrayObject&&(D=t.recordVertexArrayObject(F,x,l)),P.back={vertexBuffers:F,vertexIndexBuffer:x,vertexIndexLength:A,vertexIndexData:E,tempVertexDataArray:O,tempVertexNormalDataArray:L,positionBufferList:e.positionBufferListBack,vertexArrayObject:D}}return P}d.logError("Can not init shaders, shader program is undefined.")}},t.prototype.internalDraw=function(e,t,i){var r=i.engine;this.setTransitionProperties(r,t.effectID,t.isInvX);var n=i.shaderProgram;if(r.enableEffect(n),t.effectID===h.kTransitionIds.PPT_TRANSITION_FLIP||t.effectID===h.kTransitionIds.PPT_TRANSITION_SWITCH){var a=this.isStaticBackground;this.isStaticBackground=!0,this.drawUtil(i,0,i,!0,0,0,t.isInvX,t.effectID),this.isStaticBackground=a}return i.back&&t.positionBufferListBack?this.drawUtil(i,e,i.back,!0,t.ambient,this.diffuse,t.isInvX,t.effectID):this.drawUtil(i,this.backgroundProgress,i,!0,t.ambient,this.diffuse,t.isInvX,t.effectID),this.drawUtil(i,e,i,!1,t.ambient,this.diffuse,t.isInvX,t.effectID),!0},t.prototype.setUniforms=function(e,t,i,r){var n;n=t&&this.isStaticBackground?e.perspectiveBackgroundMatrix:e.perspectiveMatrix,e.shaderProgram.setMatrix("uModelToView",n),e.shaderProgram.setFloat3("uAmbientColor",i,i,i),e.shaderProgram.setFloat4("uDiffuseColor",r,r,r,1)},t.prototype.setTransitionProperties=function(e,t,i){switch(e.setTranstionBlend(!1),e.depthCullingState.depthTest=!0,t){case h.kTransitionIds.PPT_TRANSITION_FLIP:case h.kTransitionIds.PPT_TRANSITION_SWITCH:case h.kTransitionIds.PPT_TRANSITION_PAGECURLDOUBLE:this.isStaticBackground=!1,e.depthCullingState.cull=!0,e.depthCullingState.cullFace=i?1029:1028;break;case h.kTransitionIds.PPT_TRANSITION_AIRPLANE:case h.kTransitionIds.PPT_TRANSITION_CRUSH:case h.kTransitionIds.PPT_TRANSITION_CURTAINS:case h.kTransitionIds.PPT_TRANSITION_FRACTURE:case h.kTransitionIds.PPT_TRANSITION_ORIGAMI:case h.kTransitionIds.PPT_TRANSITION_PEELOFF:case h.kTransitionIds.PPT_TRANSITION_PRESTIGE:case h.kTransitionIds.PPT_TRANSITION_WIND:case h.kTransitionIds.PPT_TRANSITION_FALLOVER:case h.kTransitionIds.PPT_TRANSITION_DRAPE:case h.kTransitionIds.PPT_TRANSITION_PAGECURLSINGLE:e.depthCullingState.cull=!1,this.isStaticBackground=!0}},t.prototype.drawUtil=function(e,t,i,r,n,a,s,o){var d=i.vertexIndexData,h=i.tempVertexDataArray,c=i.tempVertexNormalDataArray,u=i.vertexBuffers,f=i.vertexIndexBuffer,m=i.vertexIndexLength,p=i.positionBufferList,g=i.vertexArrayObject,_=t*(p.length-1),v=Math.floor(_),y=v+1,b=_-v,S=p[v],T=p[y];if(null==T)for(var w=0;w<S.length;w+=1)h[w]=S[w];else for(w=0;w<S.length;w+=1)h[w]=S[w]*(1-b)+T[w]*b;if(s)for(w=0;w<S.length/3;w+=1)h[3*w]=-h[3*w];u.aPosition.update(h),this.getNormalBufferInPlace(h,c,d,m,s,o),u.aNormal.update(c),g?e.engine.bindVertexArrayObject(g,f):e.engine.bindBuffers(u,f,e.shaderProgram),this.setUniforms(e,r,n,a),e.shaderProgram._bindTexture("uSampler",r?e.incomingSlideTexture:e.outgoingSlideTexture),l.drawTriangles(e)},t.prototype.getNormalBufferInPlace=function(e,t,i,r,n,a){for(var s=0;s<e.length;s+=1)t[s]=0;for(var o=0;o<r/3;o+=1){var l=i[3*o],d=i[3*o+1],c=i[3*o+2],u=e[3*l],f=e[3*l+1],m=e[3*l+2],p=e[3*d]-u,g=e[3*d+1]-f,_=e[3*d+2]-m,v=e[3*c]-u,y=e[3*c+1]-f,b=e[3*c+2]-m,S=y*_-g*b,T=b*p-_*v,w=v*g-p*y;a!==h.kTransitionIds.PPT_TRANSITION_FALLOVER||n||(S=-S,T=-T,w=-w),t[3*l]+=S,t[3*l+1]+=T,t[3*l+2]+=w,t[3*d]+=S,t[3*d+1]+=T,t[3*d+2]+=w,t[3*c]+=S,t[3*c+1]+=T,t[3*c+2]+=w}},t.prototype.perspectiveMat=function(e,t,i,r,n){var a=i*Math.tan(e*Math.PI/360),s=a*t;this.frustum(-s,s,-a,a,i,r,n)},t.prototype.frustum=function(e,t,i,r,n,a,s){var o=t-e,l=r-i,d=a-n;s.setValues(2*n/o,0,0,0,0,2*n/l,0,0,(t+e)/o,(r+i)/l,-(a+n)/d,-1,0,0,-a*n*2/d,0)},t}(a.Transition);t.CustomTransition=c},function(e,t,i){"use strict";i.r(t);var r=i(73);r.ThinEngine.prototype.updateDynamicIndexBuffer=function(e,t,i){var r;void 0===i&&(i=0),this._currentBoundBuffer[this._gl.ELEMENT_ARRAY_BUFFER]=null,this.bindIndexBuffer(e),r=t instanceof Uint16Array||t instanceof Uint32Array?t:e.is32Bits?new Uint32Array(t):new Uint16Array(t),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,r,this._gl.DYNAMIC_DRAW),this._resetIndexBufferBinding()},r.ThinEngine.prototype.updateDynamicVertexBuffer=function(e,t,i,r){this.bindArrayBuffer(e),void 0===i&&(i=0);var n=t.length||t.byteLength;void 0===r||r>=n&&0===i?t instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,i,new Float32Array(t)):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,i,t):t instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,new Float32Array(t).subarray(i,i+r)):(t=t instanceof ArrayBuffer?new Uint8Array(t,i,r):new Uint8Array(t.buffer,t.byteOffset+i,r),this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t)),this._resetVertexBufferBinding()}},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(67),s=i(52),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.internalInit=function(e){var t=this.initModel(e);if(t)return t},t.prototype.internalDraw=function(e,t,i){return s.setDepthBlendCulling(i.engine),1===e?this.drawTexture(t.forward?i.incomingSlideTexture:i.outgoingSlideTexture):t.m_fThroughBlack&&e>.5?i.engine.clearToBlack():this.drawTexture(t.forward?i.outgoingSlideTexture:i.incomingSlideTexture),!0},t}(a.MeshTransition);t.CutTransition=o},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(99),s=i(67),o=i(60),l=i(52),d=i(62),h=i(32),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.internalInit=function(e,t,i){if(e.m_fUseContent){if(!e.incomingSlideForeground||!e.outgoingSlideForeground)return void h.logError("Outgoing textures have not been defined");e.delayFormula=0,this.alphaTransition=new a.AlphaTransition(!1),this.alphaTransition.init(e,i),this.alphaTransitionTextures=this.alphaTransition.getTextureInfo(),e.incomingSlideBackground=e.incomingSlideForeground,e.outgoingSlideBackground=e.outgoingSlideForeground}var r=this.getDrawInfo(7,[d.aPosition,d.aTexcoord,d.aCenter],!0);if(r){if(!e.forward){var n=r.incomingSlideTexture,s=r.outgoingSlideTexture;r.incomingSlideTexture=s,r.outgoingSlideTexture=n}var l=o.defaultViewModelProjectionMatrix(),c=o.identityMatrix();return r.shaderProgram.setMatrix("uModelViewProj",l),r.shaderProgram.setMatrix("offsetMatrix",c),r}},t.prototype.internalDraw=function(e,t,i){l.setDepthBlendCulling(i.engine,!1,!0),this.alphaTransition&&this.alphaTransition.draw(e);var r=l.bindDrawInfo(i),n=this.alphaTransitionTextures;return n&&r._bindTexture("uSampler2",t.forward?n.incomingSlideTexture:n.outgoingSlideTexture),this.drawSlide(t,i,e,!0),this.drawSlide(t,i,e,!1),!0},t.prototype.drawSlide=function(e,t,i,r){var n=t.shaderProgram,a=i;r&&(a=1-a),n._bindTexture("uSampler1",r?t.incomingSlideTexture:t.outgoingSlideTexture),this.alphaTransitionTextures||n._bindTexture("uSampler2",r?t.outgoingSlideTexture:t.incomingSlideTexture),r?n.setFloat("style",2):n.setFloat("style",1);var s=!e.m_fUseContent&&r?1:1-a,o=a;r&&(o=a/4),n.setFloat("uProgress",o),n.setFloat("opacity",s),n.setFloat("isX",e.m_isX?1:0),l.drawTriangles(t)},t.prototype.dispose=function(){this.alphaTransition&&this.alphaTransition.dispose(),e.prototype.dispose.call(this)},t}(s.MeshTransition);t.DoorsTransition=c},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=i(67),o=i(60),l=i(62),d=i(52),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delayDuration=0,t.style=1,t}return n(t,e),t.prototype.internalInit=function(e,t){var i=this.getDrawInfo(0,[l.aPosition,l.aTexcoord,l.aDelay]);if(i){this.delayDuration=0==e.delayFormula?0:1;var r=o.defaultViewModelProjectionMatrix();i.shaderProgram.setMatrix("uModelViewProj",r);var n=t.createMonochromeTexture(0,0,0,255);return a(a({},i),{blackTexture:n})}},t.prototype.internalDraw=function(e,t,i){var r;d.setDepthBlendCulling(i.engine),r=e<=.5?2*e*(this.delayDuration+1/t.factor+t.jitter/100):2*(e-.5)*(this.delayDuration+1/t.factor+t.jitter/100);var n=d.bindDrawInfo(i);n.setFloat("uProgress",r),n.setFloat("uFactor",t.factor),n.setFloat("uStyle",this.style);var a=i.incomingSlideTexture,s=i.outgoingSlideTexture;return e<=.5?(n._bindTexture("uSampler1",t.forward?s:a),n._bindTexture("uSampler2",i.blackTexture)):(n._bindTexture("uSampler1",i.blackTexture),n._bindTexture("uSampler2",t.forward?a:s)),d.drawTriangles(i),!0},t}(s.MeshTransition);t.FadeThroughBlackTransition=h},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=i(99),o=i(67),l=i(233),d=i(60),h=i(62),c=i(52),u=i(32),f=i(91),m=i(98),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_zEyeDest=0,t.m_zMoveMin=0,t.m_zMoveMax=0,t.m_zMoveDecel=0,t.m_defaultEye=new m.Vector3(0,0,-1.5),t.projectionMatrix=d.perspectiveMatrix(),t.modelViewMatrix=new d.ThinMatrix,t.modelViewProjectionMatrix=new d.ThinMatrix,t.defaultOffsetMatrix=d.identityMatrix(),t.scale4Matrix=d.scaleMatrix(4,4,1),t.newWorldMatrix=new d.ThinMatrix,t.newWorldMatrixTransform=new d.ThinMatrix,t.eyePosition={x:0,y:0,z:0},t}return n(t,e),t.prototype.internalInit=function(e,t,i){if(this.m_zMoveMin=0,this.m_zMoveMax=1,this.m_zMoveDecel=.5,e.m_fUseContent){if(!e.incomingSlideForeground||!e.outgoingSlideForeground)return void u.logError("Outgoing textures have not been defined");e.delayFormula=0,this.alphaTransition=new s.AlphaTransition(!1),this.alphaTransition.init(e,i),this.alphaTransitionTextures=this.alphaTransition.getTextureInfo(),e.incomingSlideBackground=e.incomingSlideForeground,e.outgoingSlideBackground=e.outgoingSlideForeground}var r=this.getDrawInfo(7,[h.aPosition,h.aTexcoord,h.aCenter],!0);if(r){var n=l.getReflectionData(512,12),o=t.createTexture(n,1,512),d=t.createMonochromeTexture(0,0,0,255),c=r.incomingSlideTexture,f=r.outgoingSlideTexture;return a(a({},r),{incomingSlideTexture:e.forward?c:f,outgoingSlideTexture:e.forward?f:c,reflectionMask:o,blackTexture:d})}},t.prototype.internalDraw=function(e,t,i){c.setDepthBlendCulling(i.engine,!1,!0);var r=t.m_length/10;if(this.m_zEyeDest=r+this.m_defaultEye.z,this.alphaTransition){this.alphaTransition.draw(e);var n=c.bindDrawInfo(i);if(this.alphaTransitionTextures){var a=this.alphaTransitionTextures,s=a.incomingSlideTexture,o=a.outgoingSlideTexture;n._bindTexture("uSampler1",t.forward?o:s),n._bindTexture("uSampler2",t.forward?s:o)}}else this.drawSlide(t,i,e,2),c.bindDrawInfo(i);return this.drawSlide(t,i,e,1),this.drawSlide(t,i,e,0),!0},t.prototype.drawSlide=function(e,t,i,r){var n=i;e.m_fOut&&(n=1-n),this.computeEyePosition(e,n);var a=this.eyePosition,s=a.z;1===r&&(a.z-=e.m_length/10),e.m_fOut&&(a.z=this.m_defaultEye.z-(a.z-this.m_defaultEye.z)),this.modelViewMatrix.translationScaling(-.5-a.x,-.5-a.y,0,2,2,1),this.projectionMatrix.multiplyToRef(this.modelViewMatrix,this.modelViewProjectionMatrix);var o=t.shaderProgram;if(o.setMatrix("offsetMatrix",this.defaultOffsetMatrix),e.m_fUseContent||o._bindTexture("uSampler2",e.forward?t.incomingSlideTexture:t.outgoingSlideTexture),o.setFloat("style",2),2!==r){if(0===r){if(s>0)return;n=3===e.m_doorType||4===e.m_doorType?Math.abs(s-this.m_defaultEye.z)*e.m_slidingDoorSpeed/25:Math.abs(s-this.m_defaultEye.z);var l=e.m_fFade?Math.abs(s/this.m_defaultEye.z):1,d=e.m_fOut?this.getScaledReverseProgress(e,n):n;o.setMatrix("uModelViewProj",this.modelViewProjectionMatrix),o.setFloat("uProgress",d),o.setFloat("opacity",l),o._bindTexture("uSampler1",e.m_fOut?t.incomingSlideTexture:t.outgoingSlideTexture)}else l=e.m_fOut||e.m_fUseContent?n:1,d=n,e.m_fUseContent&&(d=e.m_fOut?n:Math.abs(s-this.m_defaultEye.z)/1.8),this.modelViewProjectionMatrix.multiply(this.scale4Matrix),o.setMatrix("uModelViewProj",this.modelViewProjectionMatrix),o.setFloat("uProgress",d),o.setFloat("opacity",l),o._bindTexture("uSampler1",e.m_fOut?t.outgoingSlideTexture:t.incomingSlideTexture);c.drawTriangles(t)}else this.drawReflection(e,t,n,Math.abs(this.m_zEyeDest-a.z))},t.prototype.getScaledReverseProgress=function(e,t){switch(e.m_endType){case 0:return t;case 3:var i=e.m_bounceTime/100,r=t/1.5;if(r<i){var n=i/2;return r<n?r:n-(r-n)}return(r-i)/(1-i);default:return-1e4}},t.prototype.computeEyePosition=function(e,t){var i;switch(e.m_endType){case 0:i=this.m_defaultEye.z+f.MotionFilter.getPositionFromTime(t,e.m_length/10*4,this.m_zMoveMin,this.m_zMoveMin+this.m_zMoveDecel,this.m_zMoveMax,!0);break;case 1:i=this.m_defaultEye.z+t*e.m_length/10;break;case 2:(i=this.m_defaultEye.z+f.MotionFilter.getPositionFromTime(t,e.m_length/10*4,this.m_zMoveMin,this.m_zMoveMax,this.m_zMoveMax,!1))>this.m_zEyeDest&&(i=this.m_zEyeDest);break;case 3:var r=e.m_bounceTime/100,n=e.m_length/10*2/this.sqr(1-r),a=this.m_zMoveMax-r;if(t>a){var s=this.getVelocity(e,t),o=this.getBounce(e,t,s);i=this.m_defaultEye.z+e.m_length/10+o}else i=this.m_defaultEye.z+f.MotionFilter.getPositionFromTime(t,n,this.m_zMoveMin,a,a,!1);break;default:i=-100}this.eyePosition.z=i},t.prototype.sqr=function(e){return e*e},t.prototype.getVelocity=function(e,t){var i;switch(e.m_endType){case 0:i=f.MotionFilter.getVelocityFromTime(t,e.m_length/10*4,this.m_zMoveMin,this.m_zMoveMin+this.m_zMoveDecel,this.m_zMoveMax,!0);break;case 1:i=e.m_length/10;break;case 2:i=f.MotionFilter.getVelocityFromTime(t,e.m_length/10*4,this.m_zMoveMin,this.m_zMoveMax,this.m_zMoveMax,!1);break;case 3:var r=this.m_zMoveMax-e.m_bounceTime/100;i=f.MotionFilter.getVelocityFromTime(t,e.m_length/10*4,this.m_zMoveMin,r,r,!1);break;default:i=-1e4}return i},t.prototype.getBounce=function(e,t,i){var r=e.m_bounceTime/100,n=(t-(this.m_zMoveMax-r))/r,a=2*n*Math.PI;return 1/e.m_bounceDampening*(1-n)*r*Math.sin(a)*i},t.prototype.drawReflection=function(e,t,i,r){var n=t.shaderProgram,a=e.m_reflectionType;if(0!==a){this.newWorldMatrix.translation(0,.5,0),3===a&&(this.newWorldMatrixTransform.scaling(1,2*r/3,1),this.newWorldMatrix.multiply(this.newWorldMatrixTransform));var s=1===a?-Math.PI:-Math.PI/2;this.newWorldMatrixTransform.rotationX(s),this.newWorldMatrix.multiply(this.newWorldMatrixTransform),this.newWorldMatrixTransform.translation(0,-.5,0),this.newWorldMatrix.multiply(this.newWorldMatrixTransform),this.setReflectionMask(t,n,!0),n.setMatrix("offsetMatrix",this.newWorldMatrix);var o=3===a?1.5/r:1;n.setFloat("opacity",o*(1-i)),n._bindTexture("uSampler1",t.incomingSlideTexture),c.drawTriangles(t),this.setReflectionMask(t,n,!1)}},t.prototype.setReflectionMask=function(e,t,i){i?t._bindTexture("uSampler2",e.reflectionMask):t._bindTexture("uSampler2",e.blackTexture)},t.prototype.dispose=function(){this.alphaTransition&&this.alphaTransition.dispose(),e.prototype.dispose.call(this)},t}(o.MeshTransition);t.FlyThroughTransition=p},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=i(99),o=i(67),l=i(233),d=i(60),h=i(62),c=i(52),u=i(32),f=i(91),m=new d.ThinMatrix,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.worldViewMatrix=new d.ThinMatrix,t.reflectionWorldViewMatrix=new d.ThinMatrix,t.dirMatrix=new d.ThinMatrix,t.offsetMatrix=new d.ThinMatrix,t.reflectionPreTranslationMatrix=new d.ThinMatrix,t.reflectionPostTranslationMatrix=new d.ThinMatrix,t.swivel={scaledProgress:0,swivelPercent:0},t}return n(t,e),t.prototype.internalInit=function(e,t,i){if(e.m_fUseContent){if(!e.incomingSlideForeground||!e.outgoingSlideForeground)return void u.logError("Outgoing textures have not been defined");this.alphaTransition=new s.AlphaTransition(!1),this.alphaTransition.init(e,i),this.alphaTransitionTextures=this.alphaTransition.getTextureInfo(),e.incomingSlideBackground=e.incomingSlideForeground,e.outgoingSlideBackground=e.outgoingSlideForeground}var r=this.getDrawInfo(9,[h.aPosition,h.aTexcoord]);if(r&&this.initModel(e)){this.reflectionPreTranslationMatrix.translationColumn(0,e.m_reflectionDistance/100,0),this.reflectionPostTranslationMatrix.translationColumn(0,1,0);var n=l.getReflectionData(512,12),o=t.createTexture(n,1,512),d=t.createMonochromeTexture(0,0,0,255);return a(a({},r),{reflectionMask:o,blackTexture:d})}},t.prototype.internalDraw=function(e,t,i){c.setDepthBlendCulling(i.engine,!1,!0),this.alphaTransition&&this.alphaTransition.draw(e);var r=c.bindDrawInfo(i),n=this.alphaTransitionTextures;n&&r._bindTexture("uSampler2",t.forward?n.incomingSlideTexture:n.outgoingSlideTexture),this.offsetMatrix.identity();var a=0;t.m_fSwivel&&(this.doSwivel(t,e),a=this.swivel.swivelPercent/10),this.calculateDirection(t,!1,e),this.worldViewMatrix.translationScaling(-.5,0,0,t.m_isInvX?-2:2,2,1),this.worldViewMatrix.setValueAt(15,a+1);var s=this.worldViewMatrix.getValueAt(12)+(t.m_isInvX?a:-a);return this.worldViewMatrix.setValueAt(12,s),r.setFloat("isInvX",t.m_isInvX?1:0),r.setFloat("opacity",1),r.setMatrix("offsetMatrix",this.offsetMatrix),r.setMatrix("dirMatrix",this.dirMatrix),r.setMatrix("uModelViewProj",this.worldViewMatrix),r._bindTexture("uSampler1",t.forward?i.incomingSlideTexture:i.outgoingSlideTexture),c.drawTriangles(i),this.drawReflection(i,t,!t.forward,e),this.calculateDirection(t,!0,e),r.setFloat("opacity",1),r.setMatrix("offsetMatrix",this.offsetMatrix),r.setMatrix("dirMatrix",this.dirMatrix),r.setMatrix("uModelViewProj",this.worldViewMatrix),r._bindTexture("uSampler1",t.forward?i.outgoingSlideTexture:i.incomingSlideTexture),c.drawTriangles(i),this.drawReflection(i,t,t.forward,e),!0},t.prototype.drawReflection=function(e,t,i,r){if(t.m_fReflection){var n=e.shaderProgram;this.reflectionWorldViewMatrix.rotationX(-Math.PI),this.reflectionWorldViewMatrix.multiply(this.reflectionPreTranslationMatrix),this.reflectionWorldViewMatrix.multiply(this.offsetMatrix),this.reflectionWorldViewMatrix.multiply(this.reflectionPostTranslationMatrix),n.setFloat("opacity",1-(t.m_fFadeReflection?r:0)),n.setMatrix("offsetMatrix",this.reflectionWorldViewMatrix),n._bindTexture("uSampler1",i?e.outgoingSlideTexture:e.incomingSlideTexture),n._bindTexture("uSampler2",e.reflectionMask),c.drawTriangles(e),n._bindTexture("uSampler2",e.blackTexture)}},t.prototype.calculateDirection=function(e,t,i){var r=i,n=0;e.m_fSwivel&&(r=this.swivel.scaledProgress,n=this.swivel.swivelPercent),r=f.MotionFilter.getScaledProgress(e.motionType,r);var a=16*(e.m_distance/100+.65)/9;a*=t?r:-(1-r),1!==n&&0!==n&&(a+=Math.abs(.5-Math.abs(n-.5))/70),this.dirMatrix.translationColumn(a,0,0)},t.prototype.doSwivel=function(e,t){var i,r,n=t,a=e.m_swivelTime/100,s=e.m_waitTime/100,o=-e.m_swivelAngle*Math.PI/180,l=e.m_swivelZoom/100;n<a+s?(n>a&&(n=a),i=1-(a-n)/a,r=0):n<1-a?(i=1,r=(n-a)/(1-2*a)):(i=(1-n)/a,r=1),this.offsetMatrix.multiply(m.translation(0,0,i*l)),this.offsetMatrix.multiply(m.rotationY(i*o)),this.swivel.scaledProgress=r,this.swivel.swivelPercent=i},t.prototype.dispose=function(){this.alphaTransition&&this.alphaTransition.dispose(),e.prototype.dispose.call(this)},t}(o.MeshTransition);t.GalleryTransition=p},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(99),s=i(67),o=i(60),l=i(62),d=i(52),h=i(32),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.zMovement=0,t.extraDistance=0,t.vRes=0,t.hRes=0,t}return n(t,e),t.prototype.internalInit=function(e,t,i){if(e.useContent){if(!e.incomingSlideForeground||!e.outgoingSlideForeground)return void h.logError("Outgoing textures have not been defined");this.alphaTransition=new a.AlphaTransition(!1),this.alphaTransition.init(e,i),e.incomingSlideBackground=e.incomingSlideForeground,e.outgoingSlideBackground=e.outgoingSlideForeground}this.vRes=e.vres,this.hRes=e.hres,this.zMovement=null!=e.zMovement?e.zMovement:10,this.extraDistance=null!=e.extraDistance?e.extraDistance:0;var r=this.getDrawInfo(3,[l.aPosition,l.aTexcoord,l.aDelay,l.aCenter],!0);if(r){var n=o.perspectiveMatrix(),s=o.translateScaleMatrix(-.5,-.5,-.5,2,2,1);return n.multiply(s),r.shaderProgram.setMatrix("uModelViewProj",n),r}},t.prototype.internalDraw=function(e,t,i){if(d.setDepthBlendCulling(i.engine,!0,t.useContent,1028),t.useContent){if(!this.alphaTransition)return h.logError("AlphaTransition has not been initialized."),!1;this.alphaTransition.draw(e)}var r=d.bindDrawInfo(i),n=3.141592653589793,a=2*n/t.sides,s=t.xAxis?1/this.vRes:1/this.hRes,o=e*((0===t.delayFormula?0:1)+a/t.factor+t.jitter/100),l=s/2*Math.tan((n-a)/2);l*=1+this.extraDistance/100,t.inverse&&(l=-l);var c=this.zMovement/10*l/Math.sin((n-a)/2);return r.setFloat("uFactor",t.factor),r.setFloat("uProgress",o),r.setFloat("uDirection",t.invertDirection?-1:1),r.setFloat("uAnglePlus",0),r.setFloat("uMaxAngle",a),r.setFloat("uZCenter",l),r.setFloat("uZmovement",c),r.setFloat("uXAxis",t.xAxis?1:0),r._bindTexture("uSampler1",t.forward?i.outgoingSlideTexture:i.incomingSlideTexture),d.drawTriangles(i),r.setFloat("uAnglePlus",-a),r._bindTexture("uSampler1",t.forward?i.incomingSlideTexture:i.outgoingSlideTexture),d.drawTriangles(i),!0},t.prototype.dispose=function(){this.alphaTransition&&this.alphaTransition.dispose(),e.prototype.dispose.call(this)},t}(s.MeshTransition);t.PrismTransition=c},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=i(99),l=i(132),d=i(60),h=i(62),c=i(52),u=i(32),f=i(72),m=s(i(91)),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.direction={x:0,y:0},t.modelViewMatrix=new d.ThinMatrix,t}return n(t,e),t.prototype.internalInit=function(e,t,i){e.useContent&&e.incomingSlideForeground&&e.outgoingSlideForeground&&(this.alphaTransition=new o.AlphaTransition(!1),this.alphaTransition.init(e,i),e.incomingSlideBackground=e.incomingSlideForeground,e.outgoingSlideBackground=e.outgoingSlideForeground);var r=this.getDrawInfo(0,[h.aPosition,h.aTexcoord,h.aDelay]);if(r){var n=r.engine.wrapExternalTexture(e.incomingSlideBackground),s=r.engine.wrapExternalTexture(e.outgoingSlideBackground);switch(this.direction={x:0,y:0},e.direction){case f.kTransitionEffectOptions.Top:this.direction.y=1;break;case f.kTransitionEffectOptions.Bottom:this.direction.y=-1;break;case f.kTransitionEffectOptions.Right:this.direction.x=1;break;case f.kTransitionEffectOptions.Left:default:this.direction.x=-1}return e.forward||(this.direction.x*=-1,this.direction.y*=-1),a(a({},r),{incomingSlideTexture:n,outgoingSlideTexture:s})}},t.prototype.internalDraw=function(e,t,i){c.setDepthBlendCulling(i.engine,!1,t.useContent),this.alphaTransition&&this.alphaTransition.draw(e);var r=c.bindDrawInfo(i);r.setFloat("uFactor",1),r.setFloat("uStyle",1);var n=i.incomingSlideTexture,a=i.outgoingSlideTexture;r._bindTexture("uSampler1",t.forward?a:n),r._bindTexture("uSampler2",t.forward?n:a);var s=m.MotionFilter.getScaledProgress(0,e);if(!this.direction)return u.logError("Direction undefined"),!1;var o=s*this.direction.x-.5,l=s*this.direction.y-.5,d=(1-s)*-this.direction.x-.5,h=(1-s)*-this.direction.y-.5;return this.modelViewMatrix.translationScaling(o,l,0,2,2,1),r.setMatrix("uModelViewProj",this.modelViewMatrix),r.setFloat("uProgress",0),c.drawTriangles(i),this.modelViewMatrix.translationScaling(d,h,0,2,2,1),r.setMatrix("uModelViewProj",this.modelViewMatrix),r.setFloat("uProgress",1),c.drawTriangles(i),!0},t.prototype.dispose=function(){this.alphaTransition&&this.alphaTransition.dispose(),e.prototype.dispose.call(this)},t}(l.Transition);t.PushTransition=p},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(67),s=i(60),o=i(62),l=i(52),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.internalInit=function(e){e.m_rippleType=e.m_rippleType||29;var t=this.getDrawInfo(4,[o.aPosition,o.aTexcoord,o.aDistance],!0);if(t){var i=s.defaultViewModelProjectionMatrix();return t.shaderProgram.setMatrix("uModelViewProj",i),t}},t.prototype.internalDraw=function(e,t,i){l.setDepthBlendCulling(i.engine);var r=l.bindDrawInfo(i);return r.setFloat2("uProgress",3.14159265359*e,e),r._bindTexture("uSampler1",t.forward?i.outgoingSlideTexture:i.incomingSlideTexture),r._bindTexture("uSampler2",t.forward?i.incomingSlideTexture:i.outgoingSlideTexture),l.drawTriangles(i),!0},t}(a.MeshTransition);t.RippleTransition=d},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(67),s=i(60),o=i(52),l=i(62),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.internalInit=function(e){var t=this.getDrawInfo(1,[l.aPosition,l.aTexcoord,l.aDelay,l.aDirection]);if(t){var i=s.defaultViewModelProjectionMatrix();if(t.shaderProgram.setMatrix("uModelViewProj",i),this.initModel(e))return t}},t.prototype.internalDraw=function(t,i,r){o.setDepthBlendCulling(r.engine),e.prototype.internalDraw.call(this,t,i,r);var n=o.bindDrawInfo(r);return n.setFloat("uFactor",i.factor),n.setFloat("uProgress",3*t),n.setFloat("uOpacity",1),n._bindTexture("uSampler1",i.forward?r.outgoingSlideTexture:r.incomingSlideTexture),o.drawTriangles(r),!0},t.prototype.dispose=function(){e.prototype.dispose.call(this)},t}(a.MeshTransition);t.WeaveTransition=d},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(67),s=i(60),o=i(52),l=i(62),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.internalInit=function(){var e=this.getDrawInfo(8,[l.aPosition,l.aTexcoord,l.aDelay,l.aCenter],!0);if(e){var t=s.defaultViewModelProjectionMatrix();return e.shaderProgram.setMatrix("uModelViewProj",t),e}},t.prototype.internalDraw=function(e,t,i){o.setDepthBlendCulling(i.engine,!1,!0);var r=o.bindDrawInfo(i);return r.setFloat("uFactor",1),r.setFloat("uReverseAngle",-1),r.setFloat("uGrowFactor",0),r.setFloat("uOpacitySpeed",0),r.setFloat("uSpinFactor",0),r.setFloat("uTime",1),r._bindTexture("uSampler",t.forward?i.outgoingSlideTexture:i.incomingSlideTexture),o.drawTriangles(i),r.setFloat("uOpacitySpeed",3),r.setFloat("uTime",1-e),r.setFloat("uSpinFactor",7),r.setFloat("uGrowFactor",-1),r._bindTexture("uSampler",t.forward?i.incomingSlideTexture:i.outgoingSlideTexture),o.drawTriangles(i),!0},t}(a.MeshTransition);t.ZoomWithSpinTransition=d},function(e,t,i){"use strict";var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(236),s=i(92),o=i(237),l=i(238),d=i(239),h=i(240),c=i(241),u=i(242),f=i(243),m=i(244),p=i(245),g=i(246),_=i(247),v=i(248),y=i(249),b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transactionConstructors={AlphaTransition:function(){return new s.AlphaTransition},FadeThroughBlackTransition:function(){return new o.FadeThroughBlackTransition},PushTransition:function(){return new l.PushTransition},WeaveTransition:function(){return new a.WeaveTransition},CutTransition:function(){return new c.CutTransition},CoverTransition:function(){return new d.CoverTransition},PrismTransition:function(){return new h.PrismTransition},RippleTransition:function(){return new u.RippleTransition},ZoomWithSpinTransition:function(){return new v.ZoomWithSpinTransition},BlindsTransition:function(){return new m.BlindsTransition},CustomTransition:function(){return new f.CustomTransition},GalleryTransition:function(){return new g.GalleryTransition},CrossZoomTransition:function(){return new p.CrossZoomTransition},FlyThroughTransition:function(){return new _.FlyThroughTransition},DoorsTransition:function(){return new y.DoorsTransition}},t}return n(t,e),t}(i(161).BaseTransitionFactory);t.TransitionFactory=b},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.gl=e,this.memoryReport=t,this.buffers=[],this.textures=[]}return e.prototype.createBuffer=function(){var e=this.gl.createBuffer();return this.buffers.push(e),this.memoryReport.buffers.count+=1,e},e.prototype.createTexture=function(){var e=this.gl.createTexture();return this.textures.push(e),this.memoryReport.textures.count+=1,e},e.prototype.dispose=function(){for(var e=0,t=this.buffers;e<t.length;e++){var i=t[e];this.gl.deleteBuffer(i),this.memoryReport.buffers.count-=1}for(var r=0,n=this.textures;r<n.length;r++){var a=n[r];this.gl.deleteTexture(a),this.memoryReport.textures.count-=1}this.buffers.length=0,this.textures.length=0},e}();t.ResourcesManager=r},function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var i,r,n,a,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&a[0]?r.return:a[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,a[1])).done)return n;switch(r=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){s.label=a[1];break}if(6===a[0]&&s.label<n[1]){s.label=n[1],n=a;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(a);break}n[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{i=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(250),s=i(163),o=i(32),l=function(){function e(e,t){this.m_resourceCache={},this.isCacheEnabled=t||!1,this.wacCDNPath=e}return e.prototype.load=function(e){return r(this,void 0,void 0,(function(){return n(this,(function(t){return this.wacCDNPath?[2,this.prefetchTransitionResource(e)]:[2,null]}))}))},e.prototype.enableResourceCache=function(e){this.isCacheEnabled=e,e||(this.m_resourceCache={})},e.prototype.prefetchTransitionResource=function(e){return r(this,void 0,void 0,(function(){var t,i,r,l,d,h;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),this.isCacheEnabled&&this.m_resourceCache[e]?[2,this.m_resourceCache[e]]:(t=a.getTransitionResourceId(e))?(i=performance.now(),r=this.wacCDNPath+t,[4,fetch(r)]):[2,null];case 1:return[4,n.sent().json()];case 2:return l=n.sent(),this.isCacheEnabled&&(this.m_resourceCache[e]=l),d=performance.now(),s.ULS.sendTraceTag(594834526,s.LogCategory.msoulscat_Wac_PptSession,s.TraceLevel.Info,"TransitionResourceLoader::prefetchTransitionResource transitionID:"+e+", resourceLoadTime:"+(d-i)),[2,l];case 3:return h=n.sent(),o.logError("Exception at prefetchTransitionResource : "+h+" for transitionID:"+e),[3,4];case 4:return[2]}}))}))},e}();t.TransitionResourceLoader=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParallelCriticalAsyncFunctionThrottler=void 0;var r=i(28),n=i(251),a=function(){function e(e,t,i){this.m_throttlers=new Map,this.m_functionToThrottle=e,this.m_queueHandler=t,this.m_parallelSplitter=i}return e.prototype.callAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(this,void 0,void 0,(function(){var t,i;return r.__generator(this,(function(r){switch(r.label){case 0:return t=this.m_parallelSplitter.apply(this,e),(i=this.m_throttlers.get(t))||(i=new n.CriticalAsyncFunctionThrottler(this.m_functionToThrottle,this.m_queueHandler),this.m_throttlers.set(t,i)),[4,i.callAsync.apply(i,e)];case 1:return[2,r.sent()]}}))}))},e}();t.ParallelCriticalAsyncFunctionThrottler=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.executeAllQueueHandler=t.executeMostRecentOnlyQueueHandler=t.executeFirstOnlyQueueHandler=void 0,t.executeFirstOnlyQueueHandler=function(e){return{nextArg:e[0].args,handledRequests:e,remainingRequests:[]}},t.executeMostRecentOnlyQueueHandler=function(e){return{nextArg:e[e.length-1].args,handledRequests:e,remainingRequests:[]}},t.executeAllQueueHandler=function(e){return{nextArg:e[0].args,handledRequests:[e[0]],remainingRequests:e.splice(1)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.waitUntilTrueAsync=t.waitMsAsync=void 0;var r=i(28);function n(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){return[2,new Promise((function(t){window.setTimeout(t,e)}))]}))}))}t.waitMsAsync=n,t.waitUntilTrueAsync=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i=this;return r.__generator(this,(function(a){return[2,new Promise((function(a){return r.__awaiter(i,void 0,void 0,(function(){var i,s,o;return r.__generator(this,(function(r){switch(r.label){case 0:i=t&&t.checkIntervalMs?t.checkIntervalMs:50,s=t&&t.timeoutMs?t.timeoutMs:0,o=performance.now(),r.label=1;case 1:return e()?(a(!0),[2]):s&&performance.now()-o>s?(a(!1),[2]):[4,n(i)];case 2:return r.sent(),[3,1];case 3:return[2]}}))}))}))]}))}))}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,i){var r,n,a;!function(i,s){"use strict";n=[],void 0===(a="function"==typeof(r=function(){function e(e){return e.charAt(0).toUpperCase()+e.substring(1)}function t(e){return function(){return this[e]}}var i=["isConstructor","isEval","isNative","isToplevel"],r=["columnNumber","lineNumber"],n=["fileName","functionName","source"],a=i.concat(r,n,["args"],["evalOrigin"]);function s(t){if(t)for(var i=0;i<a.length;i++)void 0!==t[a[i]]&&this["set"+e(a[i])](t[a[i]])}s.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof s)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new s(e)}},toString:function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",i=this.getColumnNumber()||"",r=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+i+")":"[eval]:"+t+":"+i:r?r+" ("+e+":"+t+":"+i+")":e+":"+t+":"+i}},s.fromString=function(e){var t=e.indexOf("("),i=e.lastIndexOf(")"),r=e.substring(0,t),n=e.substring(t+1,i).split(","),a=e.substring(i+1);if(0===a.indexOf("@"))var o=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(a,""),l=o[1],d=o[2],h=o[3];return new s({functionName:r,args:n||void 0,fileName:l,lineNumber:d||void 0,columnNumber:h||void 0})};for(var o=0;o<i.length;o++)s.prototype["get"+e(i[o])]=t(i[o]),s.prototype["set"+e(i[o])]=function(e){return function(t){this[e]=Boolean(t)}}(i[o]);for(var l=0;l<r.length;l++)s.prototype["get"+e(r[l])]=t(r[l]),s.prototype["set"+e(r[l])]=function(e){return function(t){if(i=t,isNaN(parseFloat(i))||!isFinite(i))throw new TypeError(e+" must be a Number");var i;this[e]=Number(t)}}(r[l]);for(var d=0;d<n.length;d++)s.prototype["get"+e(n[d])]=t(n[d]),s.prototype["set"+e(n[d])]=function(e){return function(t){this[e]=String(t)}}(n[d]);return s})?r.apply(t,n):r)||(e.exports=a)}()},function(e,t,i){var r;!function(n,a,s,o){"use strict";var l,d=["","webkit","Moz","MS","ms","o"],h=a.createElement("div"),c=Math.round,u=Math.abs,f=Date.now;function m(e,t,i){return setTimeout(S(e,i),t)}function p(e,t,i){return!!Array.isArray(e)&&(g(e,i[t],i),!0)}function g(e,t,i){var r;if(e)if(e.forEach)e.forEach(t,i);else if(void 0!==e.length)for(r=0;r<e.length;)t.call(i,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(i,e[r],r,e)}function _(e,t,i){var r="DEPRECATED METHOD: "+t+"\n"+i+" AT \n";return function(){var t=new Error("get-stack-trace"),i=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=n.console&&(n.console.warn||n.console.log);return a&&a.call(n.console,r,i),e.apply(this,arguments)}}l="function"!=typeof Object.assign?function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])}return t}:Object.assign;var v=_((function(e,t,i){for(var r=Object.keys(t),n=0;n<r.length;)(!i||i&&void 0===e[r[n]])&&(e[r[n]]=t[r[n]]),n++;return e}),"extend","Use `assign`."),y=_((function(e,t){return v(e,t,!0)}),"merge","Use `assign`.");function b(e,t,i){var r,n=t.prototype;(r=e.prototype=Object.create(n)).constructor=e,r._super=n,i&&l(r,i)}function S(e,t){return function(){return e.apply(t,arguments)}}function T(e,t){return"function"==typeof e?e.apply(t&&t[0]||void 0,t):e}function w(e,t){return void 0===e?t:e}function M(e,t,i){g(E(t),(function(t){e.addEventListener(t,i,!1)}))}function C(e,t,i){g(E(t),(function(t){e.removeEventListener(t,i,!1)}))}function I(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function P(e,t){return e.indexOf(t)>-1}function E(e){return e.trim().split(/\s+/g)}function x(e,t,i){if(e.indexOf&&!i)return e.indexOf(t);for(var r=0;r<e.length;){if(i&&e[r][i]==t||!i&&e[r]===t)return r;r++}return-1}function A(e){return Array.prototype.slice.call(e,0)}function k(e,t,i){for(var r=[],n=[],a=0;a<e.length;){var s=t?e[a][t]:e[a];x(n,s)<0&&r.push(e[a]),n[a]=s,a++}return i&&(r=t?r.sort((function(e,i){return e[t]>i[t]})):r.sort()),r}function R(e,t){for(var i,r,n=t[0].toUpperCase()+t.slice(1),a=0;a<d.length;){if((r=(i=d[a])?i+n:t)in e)return r;a++}}var O=1;function L(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||n}var F="ontouchstart"in n,D=void 0!==R(n,"PointerEvent"),B=F&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),N=["x","y"],V=["clientX","clientY"];function U(e,t){var i=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){T(e.options.enable,[e])&&i.handler(t)},this.init()}function W(e,t,i){var r=i.pointers.length,n=i.changedPointers.length,a=1&t&&r-n==0,s=12&t&&r-n==0;i.isFirst=!!a,i.isFinal=!!s,a&&(e.session={}),i.eventType=t,function(e,t){var i=e.session,r=t.pointers,n=r.length;i.firstInput||(i.firstInput=z(t)),n>1&&!i.firstMultiple?i.firstMultiple=z(t):1===n&&(i.firstMultiple=!1);var a=i.firstInput,s=i.firstMultiple,o=s?s.center:a.center,l=t.center=G(r);t.timeStamp=f(),t.deltaTime=t.timeStamp-a.timeStamp,t.angle=$(o,l),t.distance=q(o,l),function(e,t){var i=t.center,r=e.offsetDelta||{},n=e.prevDelta||{},a=e.prevInput||{};1!==t.eventType&&4!==a.eventType||(n=e.prevDelta={x:a.deltaX||0,y:a.deltaY||0},r=e.offsetDelta={x:i.x,y:i.y}),t.deltaX=n.x+(i.x-r.x),t.deltaY=n.y+(i.y-r.y)}(i,t),t.offsetDirection=H(t.deltaX,t.deltaY);var d,h,c=j(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=u(c.x)>u(c.y)?c.x:c.y,t.scale=s?(d=s.pointers,q((h=r)[0],h[1],V)/q(d[0],d[1],V)):1,t.rotation=s?function(e,t){return $(t[1],t[0],V)+$(e[1],e[0],V)}(s.pointers,r):0,t.maxPointers=i.prevInput?t.pointers.length>i.prevInput.maxPointers?t.pointers.length:i.prevInput.maxPointers:t.pointers.length,function(e,t){var i,r,n,a,s=e.lastInterval||t,o=t.timeStamp-s.timeStamp;if(8!=t.eventType&&(o>25||void 0===s.velocity)){var l=t.deltaX-s.deltaX,d=t.deltaY-s.deltaY,h=j(o,l,d);r=h.x,n=h.y,i=u(h.x)>u(h.y)?h.x:h.y,a=H(l,d),e.lastInterval=t}else i=s.velocity,r=s.velocityX,n=s.velocityY,a=s.direction;t.velocity=i,t.velocityX=r,t.velocityY=n,t.direction=a}(i,t);var m=e.element;I(t.srcEvent.target,m)&&(m=t.srcEvent.target),t.target=m}(e,i),e.emit("hammer.input",i),e.recognize(i),e.session.prevInput=i}function z(e){for(var t=[],i=0;i<e.pointers.length;)t[i]={clientX:c(e.pointers[i].clientX),clientY:c(e.pointers[i].clientY)},i++;return{timeStamp:f(),pointers:t,center:G(t),deltaX:e.deltaX,deltaY:e.deltaY}}function G(e){var t=e.length;if(1===t)return{x:c(e[0].clientX),y:c(e[0].clientY)};for(var i=0,r=0,n=0;n<t;)i+=e[n].clientX,r+=e[n].clientY,n++;return{x:c(i/t),y:c(r/t)}}function j(e,t,i){return{x:t/e||0,y:i/e||0}}function H(e,t){return e===t?1:u(e)>=u(t)?e<0?2:4:t<0?8:16}function q(e,t,i){i||(i=N);var r=t[i[0]]-e[i[0]],n=t[i[1]]-e[i[1]];return Math.sqrt(r*r+n*n)}function $(e,t,i){i||(i=N);var r=t[i[0]]-e[i[0]],n=t[i[1]]-e[i[1]];return 180*Math.atan2(n,r)/Math.PI}U.prototype={handler:function(){},init:function(){this.evEl&&M(this.element,this.evEl,this.domHandler),this.evTarget&&M(this.target,this.evTarget,this.domHandler),this.evWin&&M(L(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(L(this.element),this.evWin,this.domHandler)}};var Z={mousedown:1,mousemove:2,mouseup:4};function X(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,U.apply(this,arguments)}b(X,U,{handler:function(e){var t=Z[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var Y={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},J={2:"touch",3:"pen",4:"mouse",5:"kinect"},K="pointerdown",Q="pointermove pointerup pointercancel";function ee(){this.evEl=K,this.evWin=Q,U.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}n.MSPointerEvent&&!n.PointerEvent&&(K="MSPointerDown",Q="MSPointerMove MSPointerUp MSPointerCancel"),b(ee,U,{handler:function(e){var t=this.store,i=!1,r=e.type.toLowerCase().replace("ms",""),n=Y[r],a=J[e.pointerType]||e.pointerType,s="touch"==a,o=x(t,e.pointerId,"pointerId");1&n&&(0===e.button||s)?o<0&&(t.push(e),o=t.length-1):12&n&&(i=!0),o<0||(t[o]=e,this.callback(this.manager,n,{pointers:t,changedPointers:[e],pointerType:a,srcEvent:e}),i&&t.splice(o,1))}});var te={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ie(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,U.apply(this,arguments)}function re(e,t){var i=A(e.touches),r=A(e.changedTouches);return 12&t&&(i=k(i.concat(r),"identifier",!0)),[i,r]}b(ie,U,{handler:function(e){var t=te[e.type];if(1===t&&(this.started=!0),this.started){var i=re.call(this,e,t);12&t&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:e})}}});var ne={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ae(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},U.apply(this,arguments)}function se(e,t){var i=A(e.touches),r=this.targetIds;if(3&t&&1===i.length)return r[i[0].identifier]=!0,[i,i];var n,a,s=A(e.changedTouches),o=[],l=this.target;if(a=i.filter((function(e){return I(e.target,l)})),1===t)for(n=0;n<a.length;)r[a[n].identifier]=!0,n++;for(n=0;n<s.length;)r[s[n].identifier]&&o.push(s[n]),12&t&&delete r[s[n].identifier],n++;return o.length?[k(a.concat(o),"identifier",!0),o]:void 0}function oe(){U.apply(this,arguments);var e=S(this.handler,this);this.touch=new ae(this.manager,e),this.mouse=new X(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function le(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,de.call(this,t)):12&e&&de.call(this,t)}function de(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var i={x:t.clientX,y:t.clientY};this.lastTouches.push(i);var r=this.lastTouches;setTimeout((function(){var e=r.indexOf(i);e>-1&&r.splice(e,1)}),2500)}}function he(e){for(var t=e.srcEvent.clientX,i=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var n=this.lastTouches[r],a=Math.abs(t-n.x),s=Math.abs(i-n.y);if(a<=25&&s<=25)return!0}return!1}b(ae,U,{handler:function(e){var t=ne[e.type],i=se.call(this,e,t);i&&this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:e})}}),b(oe,U,{handler:function(e,t,i){var r="touch"==i.pointerType,n="mouse"==i.pointerType;if(!(n&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(r)le.call(this,t,i);else if(n&&he.call(this,i))return;this.callback(e,t,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ce=R(h.style,"touchAction"),ue=void 0!==ce,fe=function(){if(!ue)return!1;var e={},t=n.CSS&&n.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(i){e[i]=!t||n.CSS.supports("touch-action",i)})),e}();function me(e,t){this.manager=e,this.set(t)}function pe(e){this.options=l({},this.defaults,e||{}),this.id=O++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function ge(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function _e(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function ve(e,t){var i=t.manager;return i?i.get(e):e}function ye(){pe.apply(this,arguments)}function be(){ye.apply(this,arguments),this.pX=null,this.pY=null}function Se(){ye.apply(this,arguments)}function Te(){pe.apply(this,arguments),this._timer=null,this._input=null}function we(){ye.apply(this,arguments)}function Me(){ye.apply(this,arguments)}function Ce(){pe.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ie(e,t){return(t=t||{}).recognizers=w(t.recognizers,Ie.defaults.preset),new Pe(e,t)}function Pe(e,t){var i;this.options=l({},Ie.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((i=this).options.inputClass||(D?ee:B?ae:F?oe:X))(i,W),this.touchAction=new me(this,this.options.touchAction),Ee(this,!0),g(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function Ee(e,t){var i,r=e.element;r.style&&(g(e.options.cssProps,(function(n,a){i=R(r.style,a),t?(e.oldCssProps[i]=r.style[i],r.style[i]=n):r.style[i]=e.oldCssProps[i]||""})),t||(e.oldCssProps={}))}me.prototype={set:function(e){"compute"==e&&(e=this.compute()),ue&&this.manager.element.style&&fe[e]&&(this.manager.element.style[ce]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return g(this.manager.recognizers,(function(t){T(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(P(e,"none"))return"none";var t=P(e,"pan-x"),i=P(e,"pan-y");return t&&i?"none":t||i?t?"pan-x":"pan-y":P(e,"manipulation")?"manipulation":"auto"}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,i=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var r=this.actions,n=P(r,"none")&&!fe.none,a=P(r,"pan-y")&&!fe["pan-y"],s=P(r,"pan-x")&&!fe["pan-x"];if(n){var o=1===e.pointers.length,l=e.distance<2,d=e.deltaTime<250;if(o&&l&&d)return}if(!s||!a)return n||a&&6&i||s&&24&i?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}},pe.prototype={defaults:{},set:function(e){return l(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(p(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=ve(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return p(e,"dropRecognizeWith",this)||(e=ve(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(p(e,"requireFailure",this))return this;var t=this.requireFail;return-1===x(t,e=ve(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(p(e,"dropRequireFailure",this))return this;e=ve(e,this);var t=x(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,i=this.state;function r(i){t.manager.emit(i,e)}i<8&&r(t.options.event+ge(i)),r(t.options.event),e.additionalEvent&&r(e.additionalEvent),i>=8&&r(t.options.event+ge(i))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=l({},e);if(!T(this.options.enable,[this,t]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},b(ye,pe,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,i=e.eventType,r=6&t,n=this.attrTest(e);return r&&(8&i||!n)?16|t:r||n?4&i?8|t:2&t?4|t:2:32}}),b(be,ye,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push("pan-y"),24&e&&t.push("pan-x"),t},directionTest:function(e){var t=this.options,i=!0,r=e.distance,n=e.direction,a=e.deltaX,s=e.deltaY;return n&t.direction||(6&t.direction?(n=0===a?1:a<0?2:4,i=a!=this.pX,r=Math.abs(e.deltaX)):(n=0===s?1:s<0?8:16,i=s!=this.pY,r=Math.abs(e.deltaY))),e.direction=n,i&&r>t.threshold&&n&t.direction},attrTest:function(e){return ye.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=_e(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),b(Se,ye,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),b(Te,pe,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,r=e.distance<t.threshold,n=e.deltaTime>t.time;if(this._input=e,!r||!i||12&e.eventType&&!n)this.reset();else if(1&e.eventType)this.reset(),this._timer=m((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),b(we,ye,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),b(Me,ye,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return be.prototype.getTouchAction.call(this)},attrTest:function(e){var t,i=this.options.direction;return 30&i?t=e.overallVelocity:6&i?t=e.overallVelocityX:24&i&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&i&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&u(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=_e(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),b(Ce,pe,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,r=e.distance<t.threshold,n=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(r&&n&&i){if(4!=e.eventType)return this.failTimeout();var a=!this.pTime||e.timeStamp-this.pTime<t.interval,s=!this.pCenter||q(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,s&&a?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=m((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return 32},failTimeout:function(){return this._timer=m((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ie.VERSION="2.0.7",Ie.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[we,{enable:!1}],[Se,{enable:!1},["rotate"]],[Me,{direction:6}],[be,{direction:6},["swipe"]],[Ce],[Ce,{event:"doubletap",taps:2},["tap"]],[Te]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Pe.prototype={set:function(e){return l(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var i;this.touchAction.preventDefaults(e);var r=this.recognizers,n=t.curRecognizer;(!n||n&&8&n.state)&&(n=t.curRecognizer=null);for(var a=0;a<r.length;)i=r[a],2===t.stopped||n&&i!=n&&!i.canRecognizeWith(n)?i.reset():i.recognize(e),!n&&14&i.state&&(n=t.curRecognizer=i),a++}},get:function(e){if(e instanceof pe)return e;for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i];return null},add:function(e){if(p(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(p(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,i=x(t,e);-1!==i&&(t.splice(i,1),this.touchAction.update())}return this},on:function(e,t){if(void 0!==e&&void 0!==t){var i=this.handlers;return g(E(e),(function(e){i[e]=i[e]||[],i[e].push(t)})),this}},off:function(e,t){if(void 0!==e){var i=this.handlers;return g(E(e),(function(e){t?i[e]&&i[e].splice(x(i[e],t),1):delete i[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var i=a.createEvent("Event");i.initEvent(e,!0,!0),i.gesture=t,t.target.dispatchEvent(i)}(e,t);var i=this.handlers[e]&&this.handlers[e].slice();if(i&&i.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var r=0;r<i.length;)i[r](t),r++}},destroy:function(){this.element&&Ee(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(Ie,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Pe,Input:U,TouchAction:me,TouchInput:ae,MouseInput:X,PointerEventInput:ee,TouchMouseInput:oe,SingleTouchInput:ie,Recognizer:pe,AttrRecognizer:ye,Tap:Ce,Pan:be,Swipe:Me,Pinch:Se,Rotate:we,Press:Te,on:M,off:C,each:g,merge:y,extend:v,assign:l,inherit:b,bindFn:S,prefixed:R}),(void 0!==n?n:"undefined"!=typeof self?self:{}).Hammer=Ie,void 0===(r=function(){return Ie}.call(t,i,t,e))||(e.exports=r)}(window,document)}])}));
//# sourceMappingURL=SlideShowCore.js.map